[{"tags": ["c", "arrays", "pointers", "sizeof"], "comments": [{"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 1, "creation_date": 1504740226, "post_id": 46085637, "comment_id": 79133368, "body": "Is this C or C++? If it\u2019s C++, then I don\u2019t think it\u2019s possible and you should use <code>std::vector</code>. If it\u2019s C, then I don\u2019t know the answer because VLAs are weird. Either way, please only tag one."}, {"owner": {"reputation": 27279, "user_id": 857132, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4fd51ed5980999c7c6ce3729d6cb2184?s=128&d=identicon&r=PG", "display_name": "John3136", "link": "https://stackoverflow.com/users/857132/john3136"}, "edited": false, "score": 8, "creation_date": 1504740332, "post_id": 46085637, "comment_id": 79133395, "body": "There is no 2D array here. Just 2 1D arrays of ints and a 1D array of pointers."}, {"owner": {"reputation": 17, "user_id": 4172075, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/292351e7534670c2bb3d025e8baf57c7?s=128&d=identicon&r=PG&f=1", "display_name": "zionlion", "link": "https://stackoverflow.com/users/4172075/zionlion"}, "edited": false, "score": 0, "creation_date": 1504740703, "post_id": 46085637, "comment_id": 79133492, "body": "you are right John3136, I have first a 1D array of ints that I place inside a pointer. but how do I get the size of the array of ints from the pointer?"}, {"owner": {"reputation": 2756, "user_id": 5114342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/725caa4188def46b8c6cf9b09eff7e85?s=128&d=identicon&r=PG&f=1", "display_name": "Aziuth", "link": "https://stackoverflow.com/users/5114342/aziuth"}, "edited": false, "score": 1, "creation_date": 1504740949, "post_id": 46085637, "comment_id": 79133544, "body": "<code>*array3[i]</code> is of type int. It&#39;s not an array. Problem is, you degenerate the arrays into pointers, which cannot possibly carry any such information. You need to store the data elsewhere (or do something like null termination, which is ugly). Or you switch to C++ if possible."}, {"owner": {"reputation": 17408, "user_id": 2881849, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5a2fd0122f50f7582be15be3062c5b71?s=128&d=identicon&r=PG&f=1", "display_name": "MikeMB", "link": "https://stackoverflow.com/users/2881849/mikemb"}, "edited": false, "score": 0, "creation_date": 1504740995, "post_id": 46085637, "comment_id": 79133559, "body": "You don&#39;t. Because those are pointers to int and not to int arrays (even if they were, they would have to have the same length"}, {"owner": {"reputation": 27279, "user_id": 857132, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4fd51ed5980999c7c6ce3729d6cb2184?s=128&d=identicon&r=PG", "display_name": "John3136", "link": "https://stackoverflow.com/users/857132/john3136"}, "edited": false, "score": 0, "creation_date": 1504741141, "post_id": 46085637, "comment_id": 79133591, "body": "@zionlion. There is no easy way to do it with plain arrays. Either a sentinel value at the end of the array so you can search for it, or use your knowledge of how the array was built - you can figure out the lengths of array1 and array2."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1504741155, "post_id": 46085637, "comment_id": 79133593, "body": "Have you learned about structures yet?  If so, <code>struct Array { size_t n_elems; int *data; } array3[] = { { sizeof(array1)&#47;sizeof(array1[0]), array1 }, { sizeof(array2)&#47;sizeof(array2[0]), array2 } };</code> stores the size information, and you could use <code>array3[0].n_elems</code> to get the number of elements, and <code>array3[0].data[i]</code> to get the i&#39;th element of the array."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1504746006, "post_id": 46085637, "comment_id": 79134590, "body": "Just use 2D arrays. The rest ist straight forward."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1504773790, "post_id": 46085637, "comment_id": 79145171, "body": "A container pointing at two arrays of different size is not a 2D array. For the same reason as why a mathematical matrix must be square-shaped."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1504830782, "post_id": 46085637, "comment_id": 79176799, "body": "@Lundin: Actually a mathematica matric need not be square, but is rectangular. But you are right about the code in the question. Not sure if OP really knows what he wants/needs."}], "answers": [{"comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 2, "creation_date": 1504746368, "post_id": 46085793, "comment_id": 79134678, "body": "Talking someone into C++ is not a good idea. Answer C questions with C, not C++. They are different languages, not just dialects."}, {"owner": {"reputation": 2756, "user_id": 5114342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/725caa4188def46b8c6cf9b09eff7e85?s=128&d=identicon&r=PG&f=1", "display_name": "Aziuth", "link": "https://stackoverflow.com/users/5114342/aziuth"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1504788500, "post_id": 46085793, "comment_id": 79155253, "body": "@Olaf Where exactly do I talk somebody in C++? I&#39;m talking about <i>imitating</i> C++ here."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1504790188, "post_id": 46085793, "comment_id": 79156566, "body": "Your other posts do and this one also refers to some C++ construct. Emulating C++ is often not a good approach. It is unnecessary for this problem. If you don&#39;t know C, why do you answer a C question?"}, {"owner": {"reputation": 2756, "user_id": 5114342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/725caa4188def46b8c6cf9b09eff7e85?s=128&d=identicon&r=PG&f=1", "display_name": "Aziuth", "link": "https://stackoverflow.com/users/5114342/aziuth"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1504823311, "post_id": 46085793, "comment_id": 79175005, "body": "@Olaf What do you mean by &quot;If you don&#39;t know C, why do you answer a C question?&quot;? I mean, my answer is actually an answer to the actual problem at hand. The most important part of my answer is explaining the difference between pointers and arrays, which is crucial in understanding here. And I also provide functional advice how to solve the problem. In C. You make it sound like as if my answer is the same as &quot;Switch to C++!&quot;. You advice me to &quot;Answer C questions with C&quot;, which I did. I consider my answer to be an answer in the true meaning of that word and am a little puzzled that you don&#39;t."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1504824565, "post_id": 46085793, "comment_id": 79175371, "body": "The idenomatic way to allocate a 2D array is to use a 2D array. Not some other construct, or emulate a C++ vector. It is as traight-forward as it can be."}, {"owner": {"reputation": 2756, "user_id": 5114342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/725caa4188def46b8c6cf9b09eff7e85?s=128&d=identicon&r=PG&f=1", "display_name": "Aziuth", "link": "https://stackoverflow.com/users/5114342/aziuth"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1504827357, "post_id": 46085793, "comment_id": 79176080, "body": "@Olaf Aren&#39;t 2D arrays always rectangular? The example from the question is not. His intention might easily be &quot;How many entries do I have in total?&quot;. With a 2D array, the size is rows * columns, which is not the amount of entries if the array is supposed to be ragged. Which is another thing I addressed in my answer, mentioning that the context is crucial for the approach. Also, he might not know bounds at compile time. We have the typical application of reading in an image, usually represented by something like <code>Color** image_data</code>. Might also be that he knows only the first dimension."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1504827804, "post_id": 46085793, "comment_id": 79176197, "body": "Yes, they are. And that&#39;s what OP is asking about in the first place. But from the latest comments, I noticed, he seems to not be meaning 2D arrays at all. So that makes the question unclear, because it lacks more information. A good C book would be a good investment for him."}], "tags": [], "owner": {"reputation": 2756, "user_id": 5114342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/725caa4188def46b8c6cf9b09eff7e85?s=128&d=identicon&r=PG&f=1", "display_name": "Aziuth", "link": "https://stackoverflow.com/users/5114342/aziuth"}, "is_accepted": false, "score": 0, "last_activity_date": 1504741372, "creation_date": 1504741372, "answer_id": 46085793, "question_id": 46085637, "link": "https://stackoverflow.com/questions/46085637/c-programming-get-the-size-of-a-two-dimensional-pointer-to-arrays/46085793#46085793", "title": "C programming: get the size of a two-dimensional pointer to arrays", "body": "<p>There is this idea of arrays being pointers. They're not. Arrays can <em>degenerate</em> into pointers. The idea here is that arrays are stored contiguous in memory, so if we have a pointer to the first element, we can use pointer arithmetics to get the rest. But understand that this is a pointer to the first element, not an array.</p>\n\n<p>By typing <code>int* array3[2] = {array1,array2};</code>, you create an array that consists of two pointer to first elements of arrays. Those pointers do not carry any information about the length of the arrays. Ever seen a function that takes such a pointer as argument? Those tend to also get the size as another argument. (except for the null-terminated arrays of char)</p>\n\n<p>As a result, you have to store the information in some other way. Being used to C++, my approach would be to use a structure that imitates a class. Essentially imitating the C++ <code>std::vector</code>. That said, I'm not that used to C, no idea if this is the standard approach here.</p>\n\n<p>Edit: An important thing here is your application. The best approach of course needs to know what you want to do. If for example you'd want to store 2D grid data, I'd simply go with a 1D array of size n*m. If you want to store jagged data, you could simply accompany it with an array that stores the sub-arrays sizes.</p>\n"}, {"tags": [], "owner": {"reputation": 5773, "user_id": 3525545, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Rge03.jpg?s=128&g=1", "display_name": "Mahonri Moriancumer", "link": "https://stackoverflow.com/users/3525545/mahonri-moriancumer"}, "is_accepted": false, "score": 0, "last_activity_date": 1504743926, "last_edit_date": 1504743926, "creation_date": 1504743472, "answer_id": 46086056, "question_id": 46085637, "link": "https://stackoverflow.com/questions/46085637/c-programming-get-the-size-of-a-two-dimensional-pointer-to-arrays/46086056#46086056", "title": "C programming: get the size of a two-dimensional pointer to arrays", "body": "<p>Perhaps this might work:</p>\n\n<p>If you can turn the arrays into zero-terminated arrays:</p>\n\n<pre><code>int  array1[]  = {1,2,3,4,5,6,7,8,9,10,0};\nint  array2[]  = {11,12,13,14,15,0};\nint* array3[2] = {array1,array2};\n</code></pre>\n\n<p>Then you can use a function like this to get the length of each:</p>\n\n<pre><code>/********************************************************************\n** Get the length of a zero-terminated int array.\n*/\nsize_t LengthOfIntArray(int *array)\n   {\n   int *index = array;\n\n   while(*index)\n      ++index;\n\n   return((size_t)(index - array));\n   }\n</code></pre>\n\n<p>And you can print the length of each array like this:</p>\n\n<pre><code>/********************************************************************\n** Program start\n*/\nint main(void)\n   {\n   int i;\n   int array3_x = sizeof(array3)/sizeof(*array3);    // array3_x = 2\n\n   printf(\"Height of array3: %d\\n\", array3_x);\n\n   for(i = 0; i &lt; array3_x; ++i)\n      printf(\"Length of array3[%d]: %zd\\n\", i, LengthOfIntArray(array3[i]));\n\n   return(0);\n   }\n</code></pre>\n\n<p>The output will be:</p>\n\n<pre><code>Height of array3: 2\nLength of array3[0]: 10\nLength of array3[1]: 5\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1504755832, "post_id": 46087164, "comment_id": 79136792, "body": "Why use type <code>unsigned long</code> with <code>unsigned long int c1, c2, c3</code> vs. <code>size_t</code> or <code>unsigned</code> or even <code>int</code>? As the return type of <code>sizeof</code> matches <code>size_t</code>, that would seem to be an initial choice."}], "tags": [], "owner": {"reputation": 2060, "user_id": 3808573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/CmqrY.png?s=128&g=1", "display_name": "ssd", "link": "https://stackoverflow.com/users/3808573/ssd"}, "is_accepted": false, "score": 0, "last_activity_date": 1504754065, "last_edit_date": 1504754065, "creation_date": 1504753315, "answer_id": 46087164, "question_id": 46085637, "link": "https://stackoverflow.com/questions/46085637/c-programming-get-the-size-of-a-two-dimensional-pointer-to-arrays/46087164#46087164", "title": "C programming: get the size of a two-dimensional pointer to arrays", "body": "<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main() {\n    int array1[] = {0, 1, 2, 3, 4, 5, 6, 7, 8, 9};\n    int array2[] = {10, 11, 12, 13, 14};\n    int *array3[] = {array1, array2};\n    unsigned long int c1, c2, c3;\n\n    c1 = sizeof(array1) / sizeof(*array1);\n    c2 = sizeof(array2) / sizeof(*array2);\n    c3 = sizeof(array3) / sizeof(*array3);\n\n    printf(\"size of array1 : %2lu\\n\", c1);\n    printf(\"size of array2 : %2lu\\n\", c2);\n    printf(\"size of array3 : %2lu\\n\", c3);\n\n    /* so far, so good ...\n       however, the following \"printf\"s will fail\n       to give assumed results\n    */\n\n    c1 = sizeof(array3[0]) / sizeof(*array3[0]);\n    c2 = sizeof(array3[1]) / sizeof(*array3[1]);\n\n    printf(\"size of array1 : %2lu\\n\", c1);\n    printf(\"size of array2 : %2lu\\n\", c2);\n\n    return 0;\n}\n</code></pre>\n\n<p>In your code, on line <code>array3_y[i] = sizeof(array3[i])/sizeof(*array3[i]);</code> in the <code>for</code> loop, <code>array3[i]</code> does <em>no more</em> point to an array --the compiler has no information about the length of the variable that it's pointing at, whether it is an array, a single <code>char</code> or an <code>int</code> or something else-- but it is just a plain pointer (presumably a pointer pointing to a default <code>int</code>).</p>\n\n<p>I think your current system is using 32 bits for addressing (<code>sizeof(unsigned int) / sizeof(int)</code>); my system, using 64 bits, spits \"2\" as a result (i.e. <code>sizeof(unsigned long int) / sizeof(int)</code>).</p>\n"}, {"tags": [], "owner": {"reputation": 7, "user_id": 4180887, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Rg3h9fjtkRQ/AAAAAAAAAAI/AAAAAAAAFC0/UcpvfG39QSk/photo.jpg?sz=128", "display_name": "Chriz Chow", "link": "https://stackoverflow.com/users/4180887/chriz-chow"}, "is_accepted": false, "score": 0, "last_activity_date": 1504756974, "creation_date": 1504756974, "answer_id": 46087587, "question_id": 46085637, "link": "https://stackoverflow.com/questions/46085637/c-programming-get-the-size-of-a-two-dimensional-pointer-to-arrays/46087587#46087587", "title": "C programming: get the size of a two-dimensional pointer to arrays", "body": "<p>No. You can't. The compiler never knows the array size your pointer is pointing to.</p>\n\n<p>Ref: <a href=\"https://stackoverflow.com/questions/492384/how-to-find-the-sizeof-a-pointer-pointing-to-an-array\">How to find the &#39;sizeof&#39; (a pointer pointing to an array)?</a></p>\n"}], "owner": {"reputation": 17, "user_id": 4172075, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/292351e7534670c2bb3d025e8baf57c7?s=128&d=identicon&r=PG&f=1", "display_name": "zionlion", "link": "https://stackoverflow.com/users/4172075/zionlion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1618, "favorite_count": 1, "answer_count": 4, "score": 0, "last_activity_date": 1504756974, "creation_date": 1504739927, "last_edit_date": 1504740572, "question_id": 46085637, "link": "https://stackoverflow.com/questions/46085637/c-programming-get-the-size-of-a-two-dimensional-pointer-to-arrays", "title": "C programming: get the size of a two-dimensional pointer to arrays", "body": "<p>I am creating a two-dimensional array in C as follows:</p>\n\n<pre><code>int array1[] = {1,2,3,4,5,6,7,8,9,10};\nint array2[] = {11,12,13,14,15};\nint* array3[2] = {array1,array2};\n</code></pre>\n\n<p>and now I want to get the size of both dimensions. For the first dimension I get the correct result of 2 if I use the following code:</p>\n\n<pre><code>int array3_x = sizeof(array3)/sizeof(*array3);    // array3_x = 2\n</code></pre>\n\n<p>but I am not able to get the size of the other dimension. So far I have tried the following:</p>\n\n<pre><code>for (int i = 0; i &lt; array3_x; ++i) {\n  array3_y[i] = sizeof(array3[i])/sizeof(*array3[i]);\n}\n</code></pre>\n\n<p>I always get a result of 1. Is there a way to get the correct sizes of 10 and 5? </p>\n"}, {"tags": ["c", "opengl", "xlib", "egl"], "comments": [{"owner": {"reputation": 47449, "user_id": 44729, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tyWaU.png?s=128&g=1", "display_name": "genpfault", "link": "https://stackoverflow.com/users/44729/genpfault"}, "edited": false, "score": 0, "creation_date": 1504752228, "post_id": 46085610, "comment_id": 79136094, "body": "Did you verify that <code>eglCreatePixmapSurface()</code> isn&#39;t returning <code>EGL_NO_SURFACE</code>?  &#39;Cuz that&#39;s what it&#39;s returning on my Debian Stable machine."}, {"owner": {"reputation": 47449, "user_id": 44729, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tyWaU.png?s=128&g=1", "display_name": "genpfault", "link": "https://stackoverflow.com/users/44729/genpfault"}, "edited": false, "score": 0, "creation_date": 1504752681, "post_id": 46085610, "comment_id": 79136183, "body": "None of the <code>attrib_list</code> attributes are valid for <code>eglCreatePixmapSurface()</code> according to <a href=\"https://www.khronos.org/registry/EGL/sdk/docs/man/html/eglCreatePixmapSurface.xhtml\" rel=\"nofollow noreferrer\">the docs</a>."}, {"owner": {"reputation": 47449, "user_id": 44729, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tyWaU.png?s=128&g=1", "display_name": "genpfault", "link": "https://stackoverflow.com/users/44729/genpfault"}, "edited": false, "score": 0, "creation_date": 1504753483, "post_id": 46085610, "comment_id": 79136326, "body": "<a href=\"https://github.com/i-rinat/freshplayerplugin/blob/master/tests/util_egl_pixmap.c\" rel=\"nofollow noreferrer\">This</a> works on my system."}, {"owner": {"reputation": 895, "user_id": 4626533, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh6.googleusercontent.com/-YD0ktWjS7j0/AAAAAAAAAAI/AAAAAAAACyU/T7UotNQswJ4/photo.jpg?sz=128", "display_name": "Nolan", "link": "https://stackoverflow.com/users/4626533/nolan"}, "reply_to_user": {"reputation": 47449, "user_id": 44729, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tyWaU.png?s=128&g=1", "display_name": "genpfault", "link": "https://stackoverflow.com/users/44729/genpfault"}, "edited": false, "score": 0, "creation_date": 1504771041, "post_id": 46085610, "comment_id": 79143440, "body": "@genpfault it did return EGL_NO_SURFACE. Changing attrib_list to NULL didn&#39;t solve problem though. And your code doesn&#39;t work on my system that  makes me think the issue in the library and not in my code."}, {"owner": {"reputation": 895, "user_id": 4626533, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh6.googleusercontent.com/-YD0ktWjS7j0/AAAAAAAAAAI/AAAAAAAACyU/T7UotNQswJ4/photo.jpg?sz=128", "display_name": "Nolan", "link": "https://stackoverflow.com/users/4626533/nolan"}, "reply_to_user": {"reputation": 47449, "user_id": 44729, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tyWaU.png?s=128&g=1", "display_name": "genpfault", "link": "https://stackoverflow.com/users/44729/genpfault"}, "edited": false, "score": 0, "creation_date": 1504773721, "post_id": 46085610, "comment_id": 79145115, "body": "@genpfault I added error checks. They showed <code>eglCopyBuffers</code> fails. I updated the question with the details."}, {"owner": {"reputation": 47449, "user_id": 44729, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tyWaU.png?s=128&g=1", "display_name": "genpfault", "link": "https://stackoverflow.com/users/44729/genpfault"}, "edited": false, "score": 0, "creation_date": 1504796916, "post_id": 46085610, "comment_id": 79161799, "body": "What are you trying to run this on?  Regular Linux (Debian/Ubuntu/CentOS/etc.)?  Something funky like a Raspberry Pi?  Wonky embedded...thing?  Video card and driver?  What does <a href=\"https://packages.debian.org/stretch/mesa-utils-extra\" rel=\"nofollow noreferrer\"><code>es2_info</code></a> give you?"}, {"owner": {"reputation": 895, "user_id": 4626533, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh6.googleusercontent.com/-YD0ktWjS7j0/AAAAAAAAAAI/AAAAAAAACyU/T7UotNQswJ4/photo.jpg?sz=128", "display_name": "Nolan", "link": "https://stackoverflow.com/users/4626533/nolan"}, "reply_to_user": {"reputation": 47449, "user_id": 44729, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tyWaU.png?s=128&g=1", "display_name": "genpfault", "link": "https://stackoverflow.com/users/44729/genpfault"}, "edited": false, "score": 0, "creation_date": 1504811159, "post_id": 46085610, "comment_id": 79169724, "body": "@genpfault question updated"}], "answers": [{"tags": [], "owner": {"reputation": 895, "user_id": 4626533, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh6.googleusercontent.com/-YD0ktWjS7j0/AAAAAAAAAAI/AAAAAAAACyU/T7UotNQswJ4/photo.jpg?sz=128", "display_name": "Nolan", "link": "https://stackoverflow.com/users/4626533/nolan"}, "is_accepted": false, "score": 0, "last_activity_date": 1514665944, "creation_date": 1514665944, "answer_id": 48037650, "question_id": 46085610, "link": "https://stackoverflow.com/questions/46085610/why-egl-pixmap-surface-works-with-opengl-es-but-not-with-opengl/48037650#48037650", "title": "Why egl pixmap surface works with opengl es but not with opengl?", "body": "<p>Turns out <code>eglBindApi(EGL_OPENGL_API)</code> is source of the issue. When you delete one you get blue square as expected. </p>\n\n<p>By default EGL uses OpenGL ES as rendering API and It simply doesn't work with OpenGL rendering API . I couldn't find single example of code that uses EGL with OpenGL rendering API but I found <a href=\"https://stackoverflow.com/a/7017489/4626533\">this</a> answer. This makes me think EGL isn't supposed to work with OpenGL even though <code>eglBindApi(EGL_OPENGL_API)</code> doesn't return <code>EGL_BAD_PARAMETER</code> which must be returned accroding to <a href=\"https://www.khronos.org/registry/EGL/sdk/docs/man/html/eglBindAPI.xhtml\" rel=\"nofollow noreferrer\">docs</a> \"if the specified client API is not supported by the EGL implementation\". </p>\n\n<p>So I don't accept this as an answer because actual reason why setting OpenGL as rendering API breaks the code is still unknown.</p>\n"}], "owner": {"reputation": 895, "user_id": 4626533, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh6.googleusercontent.com/-YD0ktWjS7j0/AAAAAAAAAAI/AAAAAAAACyU/T7UotNQswJ4/photo.jpg?sz=128", "display_name": "Nolan", "link": "https://stackoverflow.com/users/4626533/nolan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 782, "favorite_count": 0, "answer_count": 1, "score": 5, "last_activity_date": 1602334704, "creation_date": 1504739743, "last_edit_date": 1602334704, "question_id": 46085610, "link": "https://stackoverflow.com/questions/46085610/why-egl-pixmap-surface-works-with-opengl-es-but-not-with-opengl", "title": "Why egl pixmap surface works with opengl es but not with opengl?", "body": "<p>I use EGL with Xlib and OpenGL. While I was drawing straight on the window everything was fine. Now I'm trying to use pixmaps as EGL surface but OpenGL doesn't change it at all.</p>\n<p>I clean the background with the blue color using OpenGL. Here's what I get instead:</p>\n<p><a href=\"https://i.stack.imgur.com/HJGqZl.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/HJGqZm.png\" alt=\"Trash\" /></a></p>\n<p>Here's minimal example demonstaiting the problem(drawing this trash).</p>\n<p>UPDATE: I added error checks and find out that <code>eglCopyBuffers</code> produces <code>EGL_BAD_NATIVE_PIXMAP</code>. <a href=\"https://www.khronos.org/registry/EGL/sdk/docs/man/html/eglCopyBuffers.xhtml\" rel=\"nofollow noreferrer\">Docs</a> tell this can happen in two cases: if implementation doesn't support native pixmaps or if native pixmap argument is not valid. They both seem unlikely. If I can create pixmap surface without error I believe implementation supports native pixmaps. if I can draw on the pixmap using native methods like <code>XFillRectangle</code> I believe pixmap is valid.</p>\n<p>UPDATE: I'm running this on a laptop with Ubuntu Gnome. It has two video cards: Intel HD Graphics 5500(driver=i915) and Nvidia GeForce 920m(driver=nvidia). Main lines from es2_info output(<a href=\"https://docs.google.com/document/d/1DpB43yKgS06UeS7Q34B04d9-89VRMUaXU6FZnSAVHJc/edit?usp=sharing\" rel=\"nofollow noreferrer\">full version</a>):</p>\n<pre><code>EGL_VERSION: 1.4\nEGL_VENDOR: NVIDIA\nEGL_CLIENT_APIS: OpenGL_ES OpenGL\nGL_VERSION: OpenGL ES 3.2 NVIDIA 375.66\nGL_RENDERER: GeForce 920M/PCIe/SSE2\n</code></pre>\n<p>Code:</p>\n<pre class=\"lang-c prettyprint-override\"><code>// main.c\n// cc main.c -lX11 -lEGL -lGL\n#include &lt;stdio.h&gt;\n#include &lt;stdarg.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;GL/gl.h&gt;\n#include &lt;EGL/egl.h&gt;\n#include &lt;X11/Xlib.h&gt;\n\nvoid\ndie(const char * errstr, ...) {\n    va_list ap;\n    va_start(ap, errstr);\n    vfprintf(stderr, errstr, ap);\n    va_end(ap);\n    exit(1);\n}\n\nint main() {\n    Display * display = XOpenDisplay(NULL);\n    if (!display) die(&quot;Can't create xlib display.\\n&quot;);\n    int screen = XDefaultScreen(display);\n    GC gc = XDefaultGC(display, screen);\n    Window root_window = XRootWindow(display, screen);\n    unsigned long black_pixel = XBlackPixel(display, screen);\n    unsigned long white_pixel = XWhitePixel(display, screen);\n    Window window = XCreateSimpleWindow(display, root_window, 0, 0, 640, 480,\n        0, black_pixel, white_pixel);\n    if (!window) die(&quot;Can't create window.\\n&quot;);\n    int res = XSelectInput(display, window, ExposureMask);\n    if (!res) die(&quot;XSelectInput failed.\\n&quot;);\n    Pixmap pixmap = XCreatePixmap(display, window, 400, 400, 24);\n    if (!pixmap) die(&quot;Can't create pixmap.\\n&quot;);\n    EGLDisplay egldisplay = eglGetDisplay(display);\n    if (EGL_NO_DISPLAY == egldisplay) die(&quot;Can't cate egl display.\\n&quot;);\n    res = eglInitialize(egldisplay, NULL, NULL);\n    if (!res) die(&quot;eglInitialize failed.\\n&quot;);\n    EGLConfig config;\n    int num_configs;\n    static int attrib_list[] = {\n        EGL_RED_SIZE,           8,\n        EGL_GREEN_SIZE,         8,\n        EGL_BLUE_SIZE,          8,\n        EGL_ALPHA_SIZE,         0,\n        EGL_RENDERABLE_TYPE,    EGL_OPENGL_BIT,\n        EGL_SURFACE_TYPE,       EGL_PIXMAP_BIT,\n        EGL_NONE\n    };\n    res = eglChooseConfig(egldisplay, attrib_list, &amp;config, 1, &amp;num_configs);\n    if (!res) die(&quot;eglChooseConfig failed.\\n&quot;);\n    if (0 == num_configs) die(&quot;No appropriate egl config found.\\n&quot;);\n    EGLSurface surface =\n        eglCreatePixmapSurface(egldisplay, config, pixmap, NULL);\n    if (EGL_NO_SURFACE == surface) die(&quot;Can't create egl pixmap surface.\\n&quot;);\n    res = eglBindAPI(EGL_OPENGL_API);\n    if (!res) die(&quot;eglBindApi failed.\\n&quot;);\n    EGLContext context =\n        eglCreateContext(egldisplay, config, EGL_NO_CONTEXT, NULL);\n    if (EGL_NO_CONTEXT == config) die(&quot;Can't create egl context.\\n&quot;);\n    res = eglMakeCurrent(egldisplay, surface, surface, context);\n    if (!res) die(&quot;eglMakeCurrent failed.\\n&quot;);\n    res = XMapWindow(display, window);\n    if (!res) die(&quot;XMapWindow failed.\\n&quot;);\n    while (1) {\n        XEvent event;\n        res = XNextEvent(display, &amp;event);\n        if (Expose != event.type) continue;\n        glClearColor(0, 0, 1, 1);\n        glClear(GL_COLOR_BUFFER_BIT);\n        glFinish();\n        res = eglWaitGL();\n        if (!res) die(&quot;eglWaitGL failed.\\n&quot;);\n        res = XCopyArea(display, pixmap, window, gc, 0, 0, 400, 400, 0, 0);\n        if (!res) die(&quot;XCopyArea failed.\\n&quot;);\n    }\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 4, "creation_date": 1504738221, "post_id": 46085393, "comment_id": 79132876, "body": "<a href=\"https://linux.die.net/man/3/sleep\" rel=\"nofollow noreferrer\"><code>sleep</code></a> accepts an <code>unsigned int</code> as a parameter. Regardless of your environment, 25*60 = 1500 should easily fit in an <code>unsigned int</code>. Your system will be fine with this."}, {"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "edited": false, "score": 3, "creation_date": 1504738245, "post_id": 46085393, "comment_id": 79132882, "body": "There&#39;s existing utilities for doing this. On Unix there&#39;s <a href=\"https://en.wikipedia.org/wiki/At_(Unix)\" rel=\"nofollow noreferrer\"><code>at</code></a>. On Windows there is <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa383614(v=vs.85).aspx\" rel=\"nofollow noreferrer\">Task Scheduler</a>. I&#39;d suggest using that instead if this is a practical exercise. Otherwise there&#39;s no problem sleeping for that long, but it will not survive a restart or that process getting killed."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1504738302, "post_id": 46085393, "comment_id": 79132895, "body": "Sleeping processes use no CPU resource while asleep.  It is simple.  The main risk is being swapped out and a delay of a few seconds after the sleep ends.  You&#39;ll have to measure whether that is a real problem these days."}, {"owner": {"reputation": 57, "user_id": 8372111, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a089581a2501d4cd3f489c53c29079c2?s=128&d=identicon&r=PG&f=1", "display_name": "BareWithImANoob", "link": "https://stackoverflow.com/users/8372111/barewithimanoob"}, "reply_to_user": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "edited": false, "score": 0, "creation_date": 1504738511, "post_id": 46085393, "comment_id": 79132949, "body": "@Schwern okay great I&#39;ll check it out."}, {"owner": {"reputation": 57, "user_id": 8372111, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a089581a2501d4cd3f489c53c29079c2?s=128&d=identicon&r=PG&f=1", "display_name": "BareWithImANoob", "link": "https://stackoverflow.com/users/8372111/barewithimanoob"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1504738618, "post_id": 46085393, "comment_id": 79132971, "body": "@JonathanLeffler I don&#39;t mind if it&#39;s delayed for a couple of seconds. I may be wrong about this but I&#39;ve read something about it maybe not executing at all. If it&#39;s true could you explain why."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1504739375, "post_id": 46085393, "comment_id": 79133188, "body": "<code>size_t sessions; ...     scanf(&quot;%u&quot; , &amp;sessions);</code> --&gt; wrong specifier/type and implies compiler warnings not fully enabled."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1504739690, "post_id": 46085393, "comment_id": 79133257, "body": "Consider a helper function that loops: sleeps 1/2 the needed time and then 1/4, 1/8. 1/16 , etc. After waking each time, it notices the true wall time via <code>time()</code> and recalculates the remaining sleep time needed.  Other non-standard functions provide a more robust solution."}, {"owner": {"reputation": 57, "user_id": 8372111, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a089581a2501d4cd3f489c53c29079c2?s=128&d=identicon&r=PG&f=1", "display_name": "BareWithImANoob", "link": "https://stackoverflow.com/users/8372111/barewithimanoob"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1504740626, "post_id": 46085393, "comment_id": 79133472, "body": "@chux (<a href=\"https://stackoverflow.com/questions/2125845/platform-independent-size-t-format-specifiers-in-c\" title=\"platform independent size t format specifiers in c\">stackoverflow.com/questions/2125845/&hellip;</a>) I tried using <code>zu</code> and <code>zd</code> as mentioned in the link but the for loop would loop for more than expected."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1504740710, "post_id": 46085393, "comment_id": 79133494, "body": "Since you&#39;ve not given a link to where you read &quot;something about it maybe not executing at all&quot;, it is hard to know whether you misinterpreted what some site said or the site was wrong.  While the process is asleep for 25 minutes, it is not doing anything else.  It is asleep, and it stays asleep, and the kernel ensure that it stays asleep and is only woken after the 25 minutes have elapsed.  Sleeping processes are the most economical ones (apart from those that are dead); they consume the least CPU, and the only cost is the cost of skipping over the entry in the process lists in the kernel."}, {"owner": {"reputation": 57, "user_id": 8372111, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a089581a2501d4cd3f489c53c29079c2?s=128&d=identicon&r=PG&f=1", "display_name": "BareWithImANoob", "link": "https://stackoverflow.com/users/8372111/barewithimanoob"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1504740725, "post_id": 46085393, "comment_id": 79133498, "body": "Thanks a lot @chux I think I&#39;ll actually implement your solution :)"}, {"owner": {"reputation": 57, "user_id": 8372111, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a089581a2501d4cd3f489c53c29079c2?s=128&d=identicon&r=PG&f=1", "display_name": "BareWithImANoob", "link": "https://stackoverflow.com/users/8372111/barewithimanoob"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1504741142, "post_id": 46085393, "comment_id": 79133592, "body": "@JonathanLeffler I guess I have misinterpreted it, thanks for the clear explanation!"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 2, "creation_date": 1504743144, "post_id": 46085393, "comment_id": 79134008, "body": "After the 25 minutes, (with a dither of a few tens ms), is up, your sleepy thread will become ready to run.  If there is a free core available, or if it can preempt another running thread of lower priority, then it will be set running  &#39;immediately&#39;.   If the box is overloaded with more higher-priority ready/running threads than cores, then it will have to wait until a core becomes available for some reason or another.  Certainly, with a Windows box that is not grossly overloaded, a thread sleeping for an hour wakes up after 3600 seconds &#39;exactly&#39; if timed with a manual stopwatch:)"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1504773992, "post_id": 46085393, "comment_id": 79145329, "body": "The system does matter. <code>sleep()</code> in Unix uses seconds, <code>Sleep()</code>  in Windows uses milliseconds. This is not a standard function. You need to include the non-standard library where the function is located, such as <code>#include &lt;unistd.h&gt;</code>."}], "answers": [{"tags": [], "owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "is_accepted": false, "score": 1, "last_activity_date": 1504750200, "creation_date": 1504750200, "answer_id": 46086818, "question_id": 46085393, "link": "https://stackoverflow.com/questions/46085393/i-want-to-make-a-timer-in-c/46086818#46086818", "title": "I want to make a timer in C", "body": "<p>No, there is no problem with sleeping for 25 minutes.<br>\nIn fact, using <code>sleep</code> is about the <em>most</em> efficient way to wait for 25 minutes.</p>\n"}], "owner": {"reputation": 57, "user_id": 8372111, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a089581a2501d4cd3f489c53c29079c2?s=128&d=identicon&r=PG&f=1", "display_name": "BareWithImANoob", "link": "https://stackoverflow.com/users/8372111/barewithimanoob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1504750200, "creation_date": 1504738068, "question_id": 46085393, "link": "https://stackoverflow.com/questions/46085393/i-want-to-make-a-timer-in-c", "title": "I want to make a timer in C", "body": "<p>So what I wanted to make is a timer that won't do anything for 25 minutes and then play an mp3 file as an alarm. Only solution I've come across is using the sleep() function, but I don't know if it'll cause any problems due to running for 25 minutes (I see it being used for 3 seconds not 25 * 60). I don't if using it for this long is too taxing on the system or inefficient.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;time.h&gt;\n\nint main(void)\n{\n    size_t sessions;\n    puts(\"Enter number of sessions to work: \");\n    scanf(\"%u\" , &amp;sessions);\n\n    int work_time  = 25*60; //25 minutes to seconds\n    int break_time = 5 *60; //5  minutes to seconds\n\n    for(int i = 1 ; i &lt;= sessions ; i++)\n    {\n        sleep(work_time);\n        printf(\"Have a 5 minute break...You deserve it :)\\n\");\n\n        sleep(break_time);\n        puts(\"Break is over, let's get shit done\\n\\n\");\n    }\n\n    //next line isn't probably the best way to do it but it works for now\n    system(\"start wmplayer C:\\\\Users\\\\me\\\\Desktop\\\\myuser\\\\english\\\\fartingnoise.mp3\");\n\n    return 0;\n}\n</code></pre>\n\n<p>Here's my code so far, my main question is about the sleep function but any criticism of my code is welcome.</p>\n"}, {"tags": ["c", "char", "c-strings"], "comments": [{"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 7, "creation_date": 1504736945, "post_id": 46085187, "comment_id": 79132503, "body": "<code>int count;</code> --&gt; <code>int count = 0;</code>"}, {"owner": {"reputation": 15, "user_id": 8242571, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3018c8e81f2919c4077e5ab72b4957e2?s=128&d=identicon&r=PG&f=1", "display_name": "user24741", "link": "https://stackoverflow.com/users/8242571/user24741"}, "reply_to_user": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1504737172, "post_id": 46085187, "comment_id": 79132566, "body": "Thank You, I just compiled it and it gave me the correct answer."}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 2, "creation_date": 1504737242, "post_id": 46085187, "comment_id": 79132595, "body": "use of an uninitialized variable is undefined behavior"}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1504737826, "post_id": 46085187, "comment_id": 79132769, "body": "@user24741  It is better to use standard C function strchr instead of a loop. Take into account that the first parameter should be specified like const char* mystring"}], "answers": [{"comments": [{"owner": {"reputation": 168655, "user_id": 582, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ev49G.png?s=128&g=1", "display_name": "Lily Ballard", "link": "https://stackoverflow.com/users/582/lily-ballard"}, "edited": false, "score": 1, "creation_date": 1504739685, "post_id": 46085480, "comment_id": 79133256, "body": "2 is wrong. A string does not &quot;contain&quot; the NUL character. The fact that a NUL is used to implement a C string does not mean it contains the NUL. If it helps to think about this, the number of characters contained by a string is given by <code>strlen()</code>, and <code>strlen()</code> does not include the NUL in its count. <code>numTimesAppears(anyString, &#39;\\0&#39;)</code> should always return <code>0</code>."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 168655, "user_id": 582, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ev49G.png?s=128&g=1", "display_name": "Lily Ballard", "link": "https://stackoverflow.com/users/582/lily-ballard"}, "edited": false, "score": 0, "creation_date": 1504740261, "post_id": 46085480, "comment_id": 79133375, "body": "@KevinBallard Concerning <a href=\"https://stackoverflow.com/questions/46085187/counting-the-number-of-times-a-character-appears-in-a-string-in-c-programming/46085480?noredirect=1#comment79133256_46085480\">&quot;A string does not &quot;contain&quot; the NUL character&quot;</a>, the C spec defines <i>string</i> as &quot;A <i>string</i> is a contiguous sequence of characters terminated by and <b>including the first null character</b>.&quot;  Perhaps C spec is amiss? A number of standard lib functions explicitly don&#39;t count the <i>null character</i>, &amp; others explicitly do. IAC,I think we agree the function should be documented per this case."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1504740853, "post_id": 46085480, "comment_id": 79133528, "body": "4. is a bit dicey. It&#39;s width is implementation defined (6.5.3.4), and is not recommended to have a conversion rank greater than <i>signed long int</i> (7.1.9) and is only guaranteed to be larger than <code>65535</code> (7.20.3) -- though any compiler I&#39;ve seen at least provides a range over the positive values of <code>int</code>, and Gnu does provide a range over the positive values of <code>long int</code>. So it is another wonderful bit of implementation defined soup...."}, {"owner": {"reputation": 168655, "user_id": 582, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ev49G.png?s=128&g=1", "display_name": "Lily Ballard", "link": "https://stackoverflow.com/users/582/lily-ballard"}, "edited": false, "score": 0, "creation_date": 1504742967, "post_id": 46085480, "comment_id": 79133970, "body": "@chux You&#39;re confusing implementation details with semantics. A C string&#39;s implementation is such that the in-memory representation contains a NUL. A C string&#39;s semantics are such that a C string can never contain a NUL (because attempting to put one in the C string instead just truncates the string)."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 168655, "user_id": 582, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ev49G.png?s=128&g=1", "display_name": "Lily Ballard", "link": "https://stackoverflow.com/users/582/lily-ballard"}, "edited": false, "score": 0, "creation_date": 1504751269, "post_id": 46085480, "comment_id": 79135892, "body": "@KevinBallard No confusion on my part.  A C <i>string</i> contains the <i>null character</i> - that is the implementation details and semantics specified by C standard library. That is the reference I am using.  Your assertion that <i>string</i> does not contain a <i>null character</i> is not yet backed by a reference.   In the end - it is clear we both  understand C <i>string</i>, yet use a different way of describing them.  My rational for <code>numTimesAppears(s, &#39;\\0&#39;) </code> matches <code>strchr(s, &#39;\\0&#39;)</code> which &quot;... terminating null character is considered to be part of the string.&quot;"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1504751850, "post_id": 46085480, "comment_id": 79136022, "body": "@DavidC.Rankin The range of <code>size_t</code> and <code>int</code> are <i>both</i> implementation defined.  The range of <code>size_t</code> matches the range of possible array indexes  of <code>mystring[i]</code> and the range of possible results of  <code>numTimesAppears()</code>.  <code>int</code> matches neither.   BTW 7.1.9 appears to be C11 &#167;7.19 4"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1504760550, "post_id": 46085480, "comment_id": 79137975, "body": "@chux agreed, the 7.1.9 -&gt; 7.19.4 (fat fingers...)"}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 2, "last_activity_date": 1504752480, "last_edit_date": 1504752480, "creation_date": 1504738728, "answer_id": 46085480, "question_id": 46085187, "link": "https://stackoverflow.com/questions/46085187/counting-the-number-of-times-a-character-appears-in-a-string-in-c-programming/46085480#46085480", "title": "Counting the number of times a character appears in a string in c programming?", "body": "<blockquote>\n  <p>I get 15 for the number of times u appears in the string, which is wrong.</p>\n</blockquote>\n\n<ol>\n<li><p>Key issue: Code needs to initialize the value of <code>count</code>. <a href=\"https://stackoverflow.com/questions/46085187/counting-the-number-of-times-a-character-appears-in-a-string-in-c-programming#comment79132503_46085187\">@BLUEPIXY</a></p>\n\n<pre><code>// int count;\nint count = 0;\n</code></pre></li>\n<li><p>Corner case: As the <em>null character</em> is in the string, a result of 1 \"for number of times a character appears in a string\" would be expected for any <code>numTimesAppears(some_string, '\\0')</code>.  A <code>do</code> loop fixes that.  A similar standard library function is <code>strchr()</code>, which looks for the first match and considers the <em>null character</em> part of the search-able <em>string</em>:  \"... terminating null character is considered to be part of the string.\"  As with all corner cases, various results could be inferred - best to document the coding goal in this case.</p>\n\n<pre><code>i = 0;\ndo {\n  if (mystring[i] == ch) {\n    count++;\n  }\n} while (mystring[i++]);\n</code></pre></li>\n<li><p>As the function does not modify the inspected string, making it <code>const</code> increases the function's applicability and perhaps performance. <a href=\"https://stackoverflow.com/questions/46085187/counting-the-number-of-times-a-character-appears-in-a-string-in-c-programming/46085480#comment79132769_46085187\">@Vlad from Moscow</a></p></li>\n<li><p>Array indexing best uses <code>size_t</code> rather than <code>int</code>.  <code>int</code> may be too narrow.</p>\n\n<pre><code>size_t numTimesAppears(const char* mystring, char ch) {\n  size_t count = 0;\n  size_t i = 0;\n  do {\n    if (mystring[i] == ch) {\n      count++;\n    }\n  } while (mystring[i++]);\n  return count;\n}\n</code></pre></li>\n</ol>\n"}], "owner": {"reputation": 15, "user_id": 8242571, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3018c8e81f2919c4077e5ab72b4957e2?s=128&d=identicon&r=PG&f=1", "display_name": "user24741", "link": "https://stackoverflow.com/users/8242571/user24741"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1726, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1504752480, "creation_date": 1504736840, "last_edit_date": 1504736897, "question_id": 46085187, "link": "https://stackoverflow.com/questions/46085187/counting-the-number-of-times-a-character-appears-in-a-string-in-c-programming", "title": "Counting the number of times a character appears in a string in c programming?", "body": "<p>The for loop below continues until the end of the string, while the if branch checks to see how many times the character 'u' appears in the string, \"yuzuf Oztuk\", which is 3 times. Meanwhile, the variable count counts the number of u's in the string. When i compile the code, I get 15 for the number of times u appears in the string, which is wrong. </p>\n\n<pre><code>int numTimesAppears(char* mystring, char ch)\n{\n    int i;\n    int count;\n    for(i = 0; mystring[i] != '\\0' ; ++i)\n    {\n        if (mystring[i] == ch)\n        {\n            count++;\n        }\n    }\n    return count;\n}\n</code></pre>\n"}, {"tags": ["c", "string", "constants"], "comments": [{"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 2, "creation_date": 1504740462, "post_id": 46085150, "comment_id": 79133432, "body": "Avoid strncpy() like the plague. Better use <code>snprintf()</code> And check the return value."}], "answers": [{"tags": [], "owner": {"reputation": 53, "user_id": 8554058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sxKtB.jpg?s=128&g=1", "display_name": "Virgilio K", "link": "https://stackoverflow.com/users/8554058/virgilio-k"}, "is_accepted": false, "score": 1, "last_activity_date": 1504793279, "creation_date": 1504793279, "answer_id": 46098518, "question_id": 46085150, "link": "https://stackoverflow.com/questions/46085150/how-to-define-a-txt-constant-for-a-file-extension-in-c/46098518#46098518", "title": "How to define a &quot;.txt&quot; constant for a file extension in C?", "body": "<p>If I correctly understood the question, I would simply add the constant after I ask for the name of the file. Something like this works:</p>\n\n<pre><code>#define _GNU_SOURCE\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n\n#define TXT \".txt\"\n\nint main(void)\n{\n    char name[30];\n\n    printf(\"Please enter file name: \");\n    if (scanf(\"%25s\", name) != 1) /* must leave space for \".txt\" and \\0. */\n        exit(-1);\n\n    *((char *)mempcpy(name + strlen(name), TXT, 4)) = \"\\0\"; \n\n    printf(\"%s\\n\", name);\n    exit(0); \n}\n</code></pre>\n\n<p>It may seem a bit odd to concatenate strings that way with mempcpy, but actually it's the safest way I know. I hope that helps.</p>\n"}], "owner": {"reputation": 61, "user_id": 6398129, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/10153719209276985/picture?type=large", "display_name": "Hern&#225;n Casillas", "link": "https://stackoverflow.com/users/6398129/hern%c3%a1n-casillas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1504793279, "creation_date": 1504736475, "question_id": 46085150, "link": "https://stackoverflow.com/questions/46085150/how-to-define-a-txt-constant-for-a-file-extension-in-c", "title": "How to define a &quot;.txt&quot; constant for a file extension in C?", "body": "<p>I have this code where I use this function <code>fopen()</code>, I have a string <code>name</code> and it has \"test\" on it. How can I define like a constant for the file extension like \".txt\" just to have the name in my <code>name</code> var and not its extension? I thought about: <code>#define TXT \".txt\"</code> but what can I do to use it in the function? Like <code>fopen(name TXT, \"r\");</code> or should I add the constant when I ask for the name of the file in the <code>scanf()</code> part?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "edited": false, "score": 0, "creation_date": 1504735103, "post_id": 46084911, "comment_id": 79131955, "body": "Have you tried to run this code &quot;by hand&quot;, tracking manually every recursive call and the call stack state?"}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 2, "creation_date": 1504735152, "post_id": 46084911, "comment_id": 79131969, "body": "I don&#39;t suppose the <i>author</i> has anything to say about this?"}, {"owner": {"reputation": 47, "user_id": 7737064, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-84PV7s-i3pc/AAAAAAAAAAI/AAAAAAAAABA/foe0jIFyjTA/photo.jpg?sz=128", "display_name": "Zubair Noor", "link": "https://stackoverflow.com/users/7737064/zubair-noor"}, "reply_to_user": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "edited": false, "score": 0, "creation_date": 1504735486, "post_id": 46084911, "comment_id": 79132081, "body": "i tried i found this code on net , and when i calculated this in a paper i was getting different values, by the logic of recursion which i have with me @MatteoItalia"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1504736128, "post_id": 46084911, "comment_id": 79132268, "body": "@ZubairNoor please post the link to where you found it - there may be more info there to help us."}, {"owner": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "edited": false, "score": 1, "creation_date": 1504736316, "post_id": 46084911, "comment_id": 79132327, "body": "If you already tried it on paper and didn&#39;t get the same results, next try it with a debugger to see exactly where it does something you didn&#39;t."}, {"owner": {"reputation": 47, "user_id": 7737064, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-84PV7s-i3pc/AAAAAAAAAAI/AAAAAAAAABA/foe0jIFyjTA/photo.jpg?sz=128", "display_name": "Zubair Noor", "link": "https://stackoverflow.com/users/7737064/zubair-noor"}, "reply_to_user": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "edited": false, "score": 0, "creation_date": 1504736466, "post_id": 46084911, "comment_id": 79132370, "body": "i tried that , but i need someone to explain to me more lightly then debugger ! @aschepler"}, {"owner": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "edited": false, "score": 0, "creation_date": 1504736546, "post_id": 46084911, "comment_id": 79132395, "body": "What do you mean by &quot;working rule&quot;? In some cases it&#39;s possible to simplify things, but here the expressions involved seem pretty arbitrary so it may not be possible."}, {"owner": {"reputation": 2912, "user_id": 3081206, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YaKOY.jpg?s=128&g=1", "display_name": "takendarkk", "link": "https://stackoverflow.com/users/3081206/takendarkk"}, "edited": false, "score": 0, "creation_date": 1504736550, "post_id": 46084911, "comment_id": 79132399, "body": "A debugger is designed to go through code line by line and show you exactly what is happening at each and every step. How could that not provide the information you are looking for?"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1504736952, "post_id": 46084911, "comment_id": 79132504, "body": "@ZubairNoor &#39;i tried that&#39; OK, so what exactly did you try with your debugger and what did you find out at each step?"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1504737193, "post_id": 46084911, "comment_id": 79132574, "body": "@ZubairNoor you see, the thing is, we get a great many posters who copy code from homework, the net, or other students, and just dump it here for us to explain how it works so they can hand it in as an assignment without doing any real work themselves at all.  I&#39;m sure that you are not one of those users, so please link the net page where you got the code so we can see what explanation/s there are there, and tell us what you found out with your debugger."}, {"owner": {"reputation": 47, "user_id": 7737064, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-84PV7s-i3pc/AAAAAAAAAAI/AAAAAAAAABA/foe0jIFyjTA/photo.jpg?sz=128", "display_name": "Zubair Noor", "link": "https://stackoverflow.com/users/7737064/zubair-noor"}, "reply_to_user": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1504737512, "post_id": 46084911, "comment_id": 79132676, "body": "@MartinJames for the assignment , i don&#39;t post such a small code , look down to the answers of that two users , i just want to need such that answer how they break it out all those code in small portions for good understanding. if u can so please explain it like that. and yes i got the answer."}], "answers": [{"tags": [], "owner": {"reputation": 1669, "user_id": 7508077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b4193888717f50e77805498af1435b9?s=128&d=identicon&r=PG&f=1", "display_name": "EsmaeelE", "link": "https://stackoverflow.com/users/7508077/esmaeele"}, "is_accepted": true, "score": 0, "last_activity_date": 1504738162, "last_edit_date": 1504738162, "creation_date": 1504735853, "answer_id": 46085056, "question_id": 46084911, "link": "https://stackoverflow.com/questions/46084911/what-is-the-working-rule-of-this-program-explanation/46085056#46085056", "title": "what is the working rule of this program, Explanation?", "body": "<p>Consider on <code>for</code></p>\n\n<pre><code>for(i=0;i&lt;6;i++)\n{\n    printf(\"%2d\\n\",F(i));\n}\n</code></pre>\n\n<p><strong>Short answer:</strong></p>\n\n<p><code>F(0) =&gt; 1;</code></p>\n\n<p><code>F(1)=&gt; 1 - M(F(0))</code></p>\n\n<pre><code>when  F(0):1 then F(1) = 1 - M(1)\ngo to calculate M(1), but we start from 0, M(0)= 0;\nM(1) = 1- F(M(0)) = 1- F(0) = 1-1=0;\nlast we have M(1) = 0; and as F(1) = 1-M(1) = 1-0=1\nlast we have: F(1)=1\n</code></pre>\n\n<p><strong>More complete:</strong></p>\n\n<p>Let see <code>F()</code> way of working.\nthe last command in <code>F()</code>, \n  <code>return(n==0)?1:n-M(F(n-1));</code></p>\n\n<p>expanded to </p>\n\n<pre><code>if (n==0){\n return 1;\n}else{\n   return n-M(F(n-1));\n}\n</code></pre>\n\n<p>In first for iteration <code>i:0</code>, we want <code>F(0)</code> as n is zero, (<code>n:0</code>), the <code>if (n==0)</code> is true , <code>return 1;</code> is executed and value of<code>F(0)</code> have to be 1.</p>\n\n<p>for second iteration we want <code>F(1)</code>, for that <code>if (n==0)</code> is false and else block is execute.</p>\n\n<p>as now the <code>n:1</code>, <code>F(1) = 1 - M (F(0))</code>.</p>\n\n<p>In previous iteration we have <code>F(0)=1</code>, OK now we can rewire or equation: <code>F(1) = 1 - M(1)</code>, it obvious that if we have value of <code>M(1)</code> simply , put it on to the last formula , <code>F(1)</code> have been solved. </p>\n\n<p>for this we must expand <code>M()</code> function.</p>\n\n<p>Similarly we can write for  <code>M()</code>.   </p>\n\n<pre><code>if (n==0){\n return 0;\n}else{\n   return n-F(M(n-1));\n}\n</code></pre>\n\n<p><code>M(0) = 0;</code></p>\n\n<p><code>M(1)= 1- F(M(0))= 1- F(0) = 1 - 1=0;</code></p>\n\n<p>now we have <code>M(1) = 0;</code> by putting it on the <code>F(1) = 1 - M(1)</code> \nwe achieve to <code>F(1) = 1</code>.</p>\n\n<p>Now the first two pair of <code>1</code> in output of your code is calculated by hand.</p>\n\n<p>for others, do this way over and over. </p>\n"}, {"tags": [], "owner": {"reputation": 33685, "user_id": 3434970, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/cWyFQ.png?s=128&g=1", "display_name": "Shady Aziza", "link": "https://stackoverflow.com/users/3434970/shady-aziza"}, "is_accepted": false, "score": 0, "last_activity_date": 1504736998, "creation_date": 1504736998, "answer_id": 46085214, "question_id": 46084911, "link": "https://stackoverflow.com/questions/46084911/what-is-the-working-rule-of-this-program-explanation/46085214#46085214", "title": "what is the working rule of this program, Explanation?", "body": "<p>As suggested in the comments try to trace the code by hand, I will go through the first two iterations with you so you get the idea</p>\n\n<p>When your program starts it calls your <code>main</code> function, and starts executing the for loop as follows:</p>\n\n<pre><code>i=0 =&gt; calls F(n=0) =&gt; is n==0 true? Yes =&gt; return 1 =&gt; print 1\n\ni=1 =&gt; calls F(n=1) =&gt; is n==0 true? No =&gt; then 1-M(F(0)) =&gt; F(0) calculated from the previous iteration to return a value of 1 =&gt; call M(n=1) =&gt; is n==0 true? No =&gt; then 1-F(M(0)) =&gt; M(0) returns 0 since n==0 is true =&gt; then 1-F(M(0)) is equal to 1-F(0) =&gt; we calculated F(0) to return 1 =&gt; so 1-F(0) return 0 from M =&gt; take the return back to 1-M(F(0)) =&gt; 1-0 = 1 =&gt; print 1\n</code></pre>\n\n<p>Do not be frustrated because what you are asking would be actually much easier to understand with some patient. I extremely recommend that you hold down a pen and paper and start tracing yourself.</p>\n\n<ol>\n<li>Go iteration by iteration as I did.</li>\n<li>Call each function according to the correct flow of the if conditions.</li>\n<li>When you call a function, mark where you have left in the code to jump to said function, such that once it returns a value, you know exactly where to place the returned value.</li>\n</ol>\n\n<p>Peace of paper, patience, and trace.</p>\n"}], "owner": {"reputation": 47, "user_id": 7737064, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-84PV7s-i3pc/AAAAAAAAAAI/AAAAAAAAABA/foe0jIFyjTA/photo.jpg?sz=128", "display_name": "Zubair Noor", "link": "https://stackoverflow.com/users/7737064/zubair-noor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 2, "accepted_answer_id": 46085056, "answer_count": 2, "score": -2, "last_activity_date": 1504738162, "creation_date": 1504734916, "last_edit_date": 1504735428, "question_id": 46084911, "link": "https://stackoverflow.com/questions/46084911/what-is-the-working-rule-of-this-program-explanation", "title": "what is the working rule of this program, Explanation?", "body": "<p>i am little confuse in this program i want if anyone could explain to me the functionality of this code and the output, i am getting the output of this program as such </p>\n\n<pre><code>1\n1\n2\n2\n3\n3\n</code></pre>\n\n<p>All i want to know the working rule of that two functions how they calculating the values?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n\nint M(const int n);\nint F(const int n)\n{\n    return(n==0)?1:n-M(F(n-1));\n}\nint M(const int n)\n{\n    return (n==0)?0:n-F(M(n-1));\n}\n\nint main()\n{\n    int i;\n    for(i=0;i&lt;6;i++)\n    {\n        printf(\"%2d\\n\",F(i));\n    }\n    printf(\"\\n\");\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "opengl", "glut", "freeglut"], "comments": [{"owner": {"reputation": 333, "user_id": 5759957, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-ODcQup1gcTk/AAAAAAAAAAI/AAAAAAAAAHY/-CQ1LQlurN0/photo.jpg?sz=128", "display_name": "Andreas bleYel", "link": "https://stackoverflow.com/users/5759957/andreas-bleyel"}, "edited": false, "score": 0, "creation_date": 1504735260, "post_id": 46084716, "comment_id": 79132002, "body": "found the solution. A parameter (-lGLU) was missing in the compile statement gcc main.c -lGL -lglut -lGLU -o exfilename"}], "answers": [{"tags": [], "owner": {"reputation": 47449, "user_id": 44729, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tyWaU.png?s=128&g=1", "display_name": "genpfault", "link": "https://stackoverflow.com/users/44729/genpfault"}, "is_accepted": false, "score": 1, "last_activity_date": 1504734236, "creation_date": 1504734236, "answer_id": 46084791, "question_id": 46084716, "link": "https://stackoverflow.com/questions/46084716/glutbitmapcharacter-doesnt-display-anything/46084791#46084791", "title": "glutBitmapCharacter() doesn&#39;t display anything?", "body": "<p><code>glRasterPos2f()</code> takes the current matrix stack into account, either switch to <code>glWindowPos()</code> (which works directly in window coordinates, bypassing the matrix stacks and viewport transform) or change your modelview/projection matrices to make a transform where <code>(200, 200)</code> isn't off-screen.</p>\n"}], "owner": {"reputation": 333, "user_id": 5759957, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-ODcQup1gcTk/AAAAAAAAAAI/AAAAAAAAAHY/-CQ1LQlurN0/photo.jpg?sz=128", "display_name": "Andreas bleYel", "link": "https://stackoverflow.com/users/5759957/andreas-bleyel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 612, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1504734236, "creation_date": 1504733825, "last_edit_date": 1504734070, "question_id": 46084716, "link": "https://stackoverflow.com/questions/46084716/glutbitmapcharacter-doesnt-display-anything", "title": "glutBitmapCharacter() doesn&#39;t display anything?", "body": "<p>I am trying to make a simple text output with OpenGL, FreeGlut using <code>glutBitmapCharacter()</code>. My problem is, that i do not get any text shown. The triangle works fine. I guess the problem is not the <code>displayText()</code> function itself but maybe i call it at the wrong place or redraw/clear the text? I compile with <code>gcc main.c -lGL -lglut -o filename</code></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;GL/freeglut.h&gt;\n\n\nint WindowHeight = 500;\nint WindowWidth = 500;\n\nvoid displayText(float x, float y, int r, int g, int b, const char *string) {\n\n    int j = strlen(string);\n    glColor3f(r, g, b);\n    glRasterPos2f(x, y);\n    for (int i = 0; i &lt; j; i++) {\n        glutBitmapCharacter(GLUT_BITMAP_HELVETICA_18, string[i]);\n    }\n    printf(\"Lange: %i - Raster: %f %f\", j, x, y);\n\n}\n\nvoid keyboard(unsigned char key, int x, int y) {\n    if (key == 27)\n        exit(0);\n    else\n        printf(\"Sie haben %c gedruckt.\\n\", key);\n}\n\nvoid display(void) {\n\n\n    glClearColor(1.0, 1.0, 1.0, 0);\n    glClear(GL_COLOR_BUFFER_BIT);\n\n    glLoadIdentity();\n\n    glBegin(GL_LINE_LOOP);\n    glVertex3f(-0.3, -0.3, 0);\n    glVertex3f(0, 0.3, 0);\n    glVertex3f(0.3, -0.3, 0);\n    glEnd();\n\n    displayText(200, 200, 0, 0, 255, \"test\");\n\n    glFlush();\n}\n\nint main(int argc, char **argv) {\n\n\n    glutInit(&amp;argc, argv);\n    glutInitWindowSize(WindowWidth, WindowHeight);\n    glutInitWindowPosition(0, 0);\n    glutCreateWindow(\"Test\");\n\n    glutDisplayFunc(display);\n    glutKeyboardFunc(keyboard);\n\n    glutMainLoop();\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "mutex"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1504732647, "post_id": 46084313, "comment_id": 79130952, "body": "The mutex type is opaque; you are not expected to look at (let alone understand) its contents.  That some field doesn&#39;t contain the value expect does not necessarily mean that the mutex is not locked.  It may just mean you don&#39;t understand what the mutex structure contains.  Since you&#39;ve not identified which platform you&#39;re working on, it is hard to be definitive about your misunderstanding."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1504732915, "post_id": 46084313, "comment_id": 79131070, "body": "A MCVE showing the mutex initialized would have given more confidence in your assertion but, neverheless, what @JonathanLeffler says applies."}, {"owner": {"reputation": 155, "user_id": 4127602, "user_type": "registered", "profile_image": "https://graph.facebook.com/844853216/picture?type=large", "display_name": "Phl3tch", "link": "https://stackoverflow.com/users/4127602/phl3tch"}, "edited": false, "score": 0, "creation_date": 1504740318, "post_id": 46084313, "comment_id": 79133387, "body": "Well, it still seemed like the threads weren&#39;t getting the lock. Turns out the main thread was destroying the mutex without checking whether there were still any other threads running. Thanks for the info though."}, {"owner": {"reputation": 9530, "user_id": 1755108, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/IkECk.jpg?s=128&g=1", "display_name": "brokenfoot", "link": "https://stackoverflow.com/users/1755108/brokenfoot"}, "edited": false, "score": 0, "creation_date": 1510503395, "post_id": 46084313, "comment_id": 81452221, "body": "<code>info threads</code> on gdb will tell you what other threads are doing, if any."}], "owner": {"reputation": 155, "user_id": 4127602, "user_type": "registered", "profile_image": "https://graph.facebook.com/844853216/picture?type=large", "display_name": "Phl3tch", "link": "https://stackoverflow.com/users/4127602/phl3tch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 93, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1510503302, "creation_date": 1504731860, "last_edit_date": 1510503302, "question_id": 46084313, "link": "https://stackoverflow.com/questions/46084313/thread-not-acquiring-available-mutex", "title": "Thread not acquiring available mutex", "body": "<p>The following is a bit of output from gdb. It seems to me that the thread running here is not actually acquiring the lock.</p>\n\n<pre><code>120     pthread_mutex_lock(&amp;queue_p-&gt;lock);\n(gdb) p queue_p-&gt;lock-&gt;__data-&gt;__owner\n$45 = 0 //This makes sense; the instruction hasn't run yet.\n(gdb) n\n121     if (queue_p-&gt;back == NULL) {\n(gdb) p queue_p-&gt;lock-&gt;__data-&gt;__owner\n$46 = 0 // What?\n</code></pre>\n\n<p>There are no other threads running when this happens. It's just a single line of code, but it's not operating the way I expect. Which probably means my expectations are wrong. Can anyone un-befuddle me?</p>\n\n<p>EDIT: Hoping this may be of use to others. What I missed is that the main thread continues execution after it creates threads. This is obvious to me now, but at the time I posted this question, I was under the influence of a lifetime spent writing single-threaded procedural code. </p>\n\n<p>So my code created threads, each of which attempted to acquire this mutex. But before they could, the main thread had run its course, which included destroying the mutex. I was focussed on the code shown and didn't fully comprehend that it wasn't the only code running.</p>\n"}, {"tags": ["c", "memory-management", "memory-leaks"], "comments": [{"owner": {"reputation": 491, "user_id": 8509272, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/487ff5fe4697aeb326fa5092ef38f116?s=128&d=identicon&r=PG&f=1", "display_name": "savram", "link": "https://stackoverflow.com/users/8509272/savram"}, "edited": false, "score": 0, "creation_date": 1504732103, "post_id": 46084268, "comment_id": 79130725, "body": "Are you familiar with debugging? The easiest way is to simply print relevant information after each line of code, or just after the ones you think is the root of your problem. This will help you trace your problem."}, {"owner": {"reputation": 21, "user_id": 7287448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/566f46933d4724db374237db078e9d90?s=128&d=identicon&r=PG&f=1", "display_name": "Suiseiseki", "link": "https://stackoverflow.com/users/7287448/suiseiseki"}, "reply_to_user": {"reputation": 491, "user_id": 8509272, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/487ff5fe4697aeb326fa5092ef38f116?s=128&d=identicon&r=PG&f=1", "display_name": "savram", "link": "https://stackoverflow.com/users/8509272/savram"}, "edited": false, "score": 0, "creation_date": 1504732330, "post_id": 46084268, "comment_id": 79130815, "body": "@savram Yes, I know the basics of gdb. I don&#39;t know (and my sources do not tell of) how to examine the memory allocated at a point in the program. How could I do this?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1504732501, "post_id": 46084268, "comment_id": 79130897, "body": "Are you sure you have a memory leak? Have you used <code>valgrind</code> to determine it?"}, {"owner": {"reputation": 21, "user_id": 7287448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/566f46933d4724db374237db078e9d90?s=128&d=identicon&r=PG&f=1", "display_name": "Suiseiseki", "link": "https://stackoverflow.com/users/7287448/suiseiseki"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1504732923, "post_id": 46084268, "comment_id": 79131076, "body": "@Barmar Yes, I am sure. I tried this with 5 million generations - the program was taking nearly 9GB of RAM by the time it finished. I&#39;ve not heard of valgrind.. I shall look into that."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1504735027, "post_id": 46084268, "comment_id": 79131938, "body": "BTW:the program could be much simpler if you omitted dynamic allocation and just perturbed some static arrays.(the number of elements is constant)"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1507158018, "post_id": 46084268, "comment_id": 80104345, "body": "Did you ever figure this out?"}], "owner": {"reputation": 21, "user_id": 7287448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/566f46933d4724db374237db078e9d90?s=128&d=identicon&r=PG&f=1", "display_name": "Suiseiseki", "link": "https://stackoverflow.com/users/7287448/suiseiseki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 109, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1504743354, "creation_date": 1504731651, "question_id": 46084268, "link": "https://stackoverflow.com/questions/46084268/memory-leak-when-freeing-and-reassigning-pointers-in-an-array", "title": "Memory leak when freeing and reassigning pointers in an array", "body": "<p>I'm attempting to implement a genetic algorithm to solve sudoku puzzles. I have an array of pointers to specimen solutions (int*'s), so I choose one to replace with a newly bred specimen - that is, free the memory pointed at, then make it point to the new specimen. My code at the moment has a memory leak, but I don't know why. Here's my main:</p>\n\n<pre><code>int main(){\n\n    //somewhere... is a memory leak.\n\n    srand(time(NULL));\n\n    int puzzle[] = {6,4,0,0,0,0,0,0,0,   \n                    9,0,0,0,7,1,2,0,6,   \n                    1,8,2,5,0,0,0,0,9,   \n                    7,0,0,6,4,5,8,1,0,   \n                    0,0,0,0,0,0,0,0,0,   \n                    0,1,8,3,2,9,0,0,5,   \n                    2,0,0,0,0,7,9,4,8,   \n                    3,0,1,8,5,0,0,0,7,   \n                    0,0,0,0,0,0,0,5,3};  \n\n    int** population = generate_population();\n\n    //ensure each specimen contains the puzzle-defined cells.\n    for (int i=0; i&lt;POP_SIZE; ++i){\n        for (int j=0; j&lt;81; ++j){\n            if (puzzle[j] &amp;&amp; population[i][j] != puzzle[j]){\n            population[i][j] = puzzle[j];\n            }\n        }\n    }\n\n    //Create array of fitnesses for original population.\n    int fitness[81];\n    for (int i=0; i&lt;POP_SIZE; ++i){\n         fitness[i] = calculate_fitness(population[i]);\n    }\n\n    int average_fitness = 0;\n    for (int i=0; i&lt;POP_SIZE; ++i){\n        printf(\"Specimen %i: Fitness: %i\\n\", i, fitness[i]);\n        average_fitness += fitness[i];\n    }\n    printf(\"Average fitness: %f\\n\\n\", (double)average_fitness/POP_SIZE);\n\n\n    int* mother = NULL;\n    int* father = NULL;\n    int* child = NULL;\n\n    int mother_index = 0;\n    int father_index = 0;\n    int exiled_index = 0;\n\n    //Do some evolving\n    for (int i=0; i&lt;GENERATIONS; ++i){\n\n        //choose parents.\n        mother_index = choose_parent(fitness);\n        father_index = choose_parent(fitness);\n\n        if (mother_index == -1 || father_index == -1){\n            //problems\n            printf(\"CHOOSE_PARENT RETURNED -1!\\n\");\n            exit(1);\n        }\n\n        mother = population[mother_index];\n        father = population[father_index];\n\n        //Breed mother and father, and mutate ensuring child conforms to puzzle definition.\n        child = mutate(crossover(mother, father), puzzle);\n\n        //Choose specimen to be removed, free the memory it takes up, and reallocate\n        //the pointer with the new specimen.\n        exiled_index = choose_exiled(fitness);\n        free(population[exiled_index]);\n        population[exiled_index] = child;\n\n        //Update fitness array with new specimen's fitness.\n        fitness[exiled_index] = calculate_fitness(population[exiled_index]);\n    }\n\n\n    //After evolution\n    average_fitness = 0;\n    for (int i=0; i&lt;POP_SIZE; ++i){\n        printf(\"Specimen %i: Fitness: %i\\n\", i, fitness[i]);\n        average_fitness += fitness[i];\n    }\n    printf(\"Average fitness: %f\\n\\n\", (double)average_fitness/POP_SIZE);\n\n    return EXIT_SUCCESS;\n}\n</code></pre>\n\n<p>Within the evolution for-loop, crossover creates a new array of 81 ints (which is mutated then stored in child), and later we free whatever is stored in population[exiled_index], and reassign that pointer to the new child. So surely, this loop should maintain the same amount of memory in use? Well, it doesn't! I've got no idea where memory is going. </p>\n\n<p>Here are the crossover and mutate functions:</p>\n\n<pre><code>int* crossover(int* const mother, int* const father){\n    int* child = malloc(sizeof(int)*81);\n    for (int i=0; i&lt;81; ++i){\n        if (rand()%2){\n            child[i] = mother[i];\n        }\n        else {\n            child[i] = father[i];\n        }\n    }\n    return child;\n}\n\nint* mutate(int* const child, int* puzzle){\n    for (int i=0; i&lt;81; ++i){\n        if (child[i] == puzzle[i]){\n            continue;\n        }\n        else if ((double)rand()/RAND_MAX &lt; 0.125){\n            child[i] = 1+rand()%9;\n        }\n    }\n    return child;\n}\n</code></pre>\n\n<p>I can provide more code if it's wanted, but I don't think the rest will be needed to explain the leak.</p>\n\n<p>Thanks in advance. </p>\n"}, {"tags": ["c++", "c", "qt", "cmake"], "comments": [{"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1504732051, "post_id": 46084259, "comment_id": 79130701, "body": "Probably, the project needs newer QT, or older one. In any case, we can only guess. Have you read documentation about building/installing the project?"}, {"owner": {"reputation": 520, "user_id": 1565259, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/d6y8A.jpg?s=128&g=1", "display_name": "guyts", "link": "https://stackoverflow.com/users/1565259/guyts"}, "reply_to_user": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1504791840, "post_id": 46084259, "comment_id": 79157853, "body": "@Tsyvarev yes I have. Following it exactly as specified. Nothing about QT is mentioned anywhere."}, {"owner": {"reputation": 520, "user_id": 1565259, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/d6y8A.jpg?s=128&g=1", "display_name": "guyts", "link": "https://stackoverflow.com/users/1565259/guyts"}, "reply_to_user": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "edited": false, "score": 0, "creation_date": 1504791871, "post_id": 46084259, "comment_id": 79157885, "body": "@arrowd I&#39;m not sure I understand the context. Should I try it regardless of building the project in cmd?"}, {"owner": {"reputation": 3860, "user_id": 5251059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93c9c608467b21bce1d709b56bf6d39d?s=128&d=identicon&r=PG&f=1", "display_name": "vre", "link": "https://stackoverflow.com/users/5251059/vre"}, "edited": false, "score": 0, "creation_date": 1505044798, "post_id": 46084259, "comment_id": 79242560, "body": "This sounds like CMake found the Qt binaries that are provided with an installed Anaconda2. Try to Remove Anaconda 2 directory from the path."}, {"owner": {"reputation": 520, "user_id": 1565259, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/d6y8A.jpg?s=128&g=1", "display_name": "guyts", "link": "https://stackoverflow.com/users/1565259/guyts"}, "edited": false, "score": 0, "creation_date": 1505151552, "post_id": 46084259, "comment_id": 79284887, "body": "How do I do that? My code sits within the Anaconda directory"}], "owner": {"reputation": 520, "user_id": 1565259, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/d6y8A.jpg?s=128&g=1", "display_name": "guyts", "link": "https://stackoverflow.com/users/1565259/guyts"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 664, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1504731601, "creation_date": 1504731601, "question_id": 46084259, "link": "https://stackoverflow.com/questions/46084259/cmake-error-unsuitable-qt-version", "title": "Cmake error: unsuitable Qt version", "body": "<p>I'm trying to run cmake via cmd (Windows) on a project I downloaded from GitHub, using <code>cmake</code>.</p>\n\n<p>However, I'm getting the following error:</p>\n\n<pre><code>-- Found unsuitable Qt version \"5.6.2\" from C:/Anaconda2/Library/bin/qmake.exe\nCMake Error at 3rdParty/FindMatlab-rwp.cmake:50 (MESSAGE):\n  Generator not compatible: MinGW Makefiles\nCall Stack (most recent call first):\n  CMakeLists.txt:427 (find_package)\n</code></pre>\n\n<p>Any ideas what might be wrong? I tried to find info about the Qt mentioned, but I came up with nothing.</p>\n"}, {"tags": ["c", "uuid", "ext2", "superblock"], "comments": [{"owner": {"reputation": 1669, "user_id": 7508077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b4193888717f50e77805498af1435b9?s=128&d=identicon&r=PG&f=1", "display_name": "EsmaeelE", "link": "https://stackoverflow.com/users/7508077/esmaeele"}, "edited": false, "score": 0, "creation_date": 1504731653, "post_id": 46084021, "comment_id": 79130527, "body": "Show codes and your try.."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 8571211, "user_type": "registered", "profile_image": "https://graph.facebook.com/115425172508805/picture?type=large", "display_name": "xiekuan", "link": "https://stackoverflow.com/users/8571211/xiekuan"}, "edited": false, "score": 0, "creation_date": 1504786079, "post_id": 46086050, "comment_id": 79153541, "body": "Thank you. I search this for a long while and did not get useful information. Would you mind to share me with the document&#39;s link ? Thanks a lot."}], "tags": [], "owner": {"reputation": 16, "user_id": 4764648, "user_type": "registered", "profile_image": "https://graph.facebook.com/10200641733721290/picture?type=large", "display_name": "Bart Bartel", "link": "https://stackoverflow.com/users/4764648/bart-bartel"}, "is_accepted": true, "score": 0, "last_activity_date": 1504743448, "creation_date": 1504743448, "answer_id": 46086050, "question_id": 46084021, "link": "https://stackoverflow.com/questions/46084021/how-to-print-the-s-uuid-of-ext2-superblock-in-c/46086050#46086050", "title": "how to print the s_uuid of ext2 superblock in C", "body": "<p>The s_uuid is defined in the superblock as:\nu8 s_uuid[16];</p>\n\n<p>In order to print this to the console in the above format:</p>\n\n<pre><code>uint8_t s_uuid[16] = {0xf3, 0x58, 0x6b, 0xaf, 0xb5, 0xaa, 0x49, 0xb5, \n                      0x8d, 0x6c, 0x05, 0x69, 0x28, 0x4c, 0x63, 0x9f};\n\nprintf(\"%02x%02x%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\\n\",\n    s_uuid[0], s_uuid[1], s_uuid[2], s_uuid[3], s_uuid[4], s_uuid[5], s_uuid[6], s_uuid[7], \n    s_uuid[8], s_uuid[9], s_uuid[10], s_uuid[11], s_uuid[12], s_uuid[13], s_uuid[14], s_uuid[15]);\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 8571211, "user_type": "registered", "profile_image": "https://graph.facebook.com/115425172508805/picture?type=large", "display_name": "xiekuan", "link": "https://stackoverflow.com/users/8571211/xiekuan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 129, "favorite_count": 0, "accepted_answer_id": 46086050, "answer_count": 1, "score": 0, "last_activity_date": 1504743448, "creation_date": 1504730539, "question_id": 46084021, "link": "https://stackoverflow.com/questions/46084021/how-to-print-the-s-uuid-of-ext2-superblock-in-c", "title": "how to print the s_uuid of ext2 superblock in C", "body": "<p>I create a variable to store the value of superblock's s_uuid. But I get trouble into how to print this variable like xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx in this form. I tried to use printf in %x and %s to print my variable, but it doesn't work.</p>\n\n<p>I want to know how the UUID stores in file system and how I can print it in console instead of wrong encoding.</p>\n"}, {"tags": ["c", "terminal", "rss", "fork"], "answers": [{"comments": [{"owner": {"reputation": 189, "user_id": 5221310, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2838fa0055eb15c38ba2dd372c6ae68d?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron Parisi", "link": "https://stackoverflow.com/users/5221310/aaron-parisi"}, "edited": false, "score": 0, "creation_date": 1504729703, "post_id": 46083774, "comment_id": 79129576, "body": "Having trouble with that, it says wait takes an int* not an int?"}, {"owner": {"reputation": 336, "user_id": 1307730, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c97a0d7ab8eb6034a735e9788ecc8af9?s=128&d=identicon&r=PG", "display_name": "Glenn Willen", "link": "https://stackoverflow.com/users/1307730/glenn-willen"}, "reply_to_user": {"reputation": 189, "user_id": 5221310, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2838fa0055eb15c38ba2dd372c6ae68d?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron Parisi", "link": "https://stackoverflow.com/users/5221310/aaron-parisi"}, "edited": false, "score": 0, "creation_date": 1504729780, "post_id": 46083774, "comment_id": 79129615, "body": "@A.Pizzle See my expanded answer for how to use the wait function. When I say &quot;wait(2)&quot;, that&#39;s a standard way of saying &quot;the function wait(), which is documented in section 2 of the manpages.&quot; I&#39;m not sure whether that specific jargon is considered standard on SO or not, sorry for the confusion.  Specifically, the int* argument is a pointer to an int where wait() will put the exit status of the child that has exited (and the pid of the child will be returned by wait().)"}, {"owner": {"reputation": 336, "user_id": 1307730, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c97a0d7ab8eb6034a735e9788ecc8af9?s=128&d=identicon&r=PG", "display_name": "Glenn Willen", "link": "https://stackoverflow.com/users/1307730/glenn-willen"}, "reply_to_user": {"reputation": 189, "user_id": 5221310, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2838fa0055eb15c38ba2dd372c6ae68d?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron Parisi", "link": "https://stackoverflow.com/users/5221310/aaron-parisi"}, "edited": false, "score": 0, "creation_date": 1504730029, "post_id": 46083774, "comment_id": 79129757, "body": "You&#39;re welcome! Please click &#39;accept&#39; on my answer so the site knows it was the right one! :-)"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1504730203, "post_id": 46083774, "comment_id": 79129843, "body": "<code>wait()</code> is the simplest of the operations; you could also use <code>waitpid()</code> or <code>waitid()</code>, though the latter is not implemented everywhere (e.g. no <code>waitid()</code> in macOS Sierra 10.12.6)."}], "tags": [], "owner": {"reputation": 336, "user_id": 1307730, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c97a0d7ab8eb6034a735e9788ecc8af9?s=128&d=identicon&r=PG", "display_name": "Glenn Willen", "link": "https://stackoverflow.com/users/1307730/glenn-willen"}, "is_accepted": true, "score": 2, "last_activity_date": 1504729709, "last_edit_date": 1504729709, "creation_date": 1504729470, "answer_id": 46083774, "question_id": 46083717, "link": "https://stackoverflow.com/questions/46083717/my-program-doesnt-seem-to-terminate-why/46083774#46083774", "title": "My program doesn&#39;t seem to terminate; why?", "body": "<p>Your program has already terminated, but it's hard to see that because the forked child processes are continuing to produce output afterwards. </p>\n\n<p>Look at the middle of your transcript:</p>\n\n<pre><code>running a child process now\naarons-MacBook-Pro:ch9 aaronparisi$ U.S. general in Afghanistan apologizes for highly offensive leaflets\n</code></pre>\n\n<p>You can see that your shell has displayed a prompt in the middle of your output, at the point when the original program finished, but while the child processes are still running.</p>\n\n<p>If you just hit [ENTER] after all the output is finished, you will see that your shell is in fact listening and you will get another shell prompt immediately.</p>\n\n<p>If you would prefer that your program not exit until after all the child processes are done, you will need to use wait(2) to wait for them to finish: <a href=\"http://man7.org/linux/man-pages/man2/waitpid.2.html\" rel=\"nofollow noreferrer\">http://man7.org/linux/man-pages/man2/waitpid.2.html</a></p>\n\n<p>Since wait returns -1 if your process has no children, you can just call it in a loop until it does so:</p>\n\n<pre><code>int status = 0;\nwhile ((wpid = wait(&amp;status)) &gt; 0);\n</code></pre>\n\n<p>(I got that specific formula from <a href=\"https://stackoverflow.com/questions/19461744/make-parent-wait-for-all-child-processes\">Make parent wait for all child processes</a> .)</p>\n"}], "owner": {"reputation": 189, "user_id": 5221310, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2838fa0055eb15c38ba2dd372c6ae68d?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron Parisi", "link": "https://stackoverflow.com/users/5221310/aaron-parisi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "accepted_answer_id": 46083774, "answer_count": 1, "score": 1, "last_activity_date": 1504740341, "creation_date": 1504729207, "last_edit_date": 1504740341, "question_id": 46083717, "link": "https://stackoverflow.com/questions/46083717/my-program-doesnt-seem-to-terminate-why", "title": "My program doesn&#39;t seem to terminate; why?", "body": "<p>I am using something called <code>rssgossip.py</code> to search for a phrase in rss feeds of my choosing. </p>\n\n<p>Basically, I am iterating through an array of rss feeds I want to search, and each time I'm forking the process and calling <code>execle()</code> on the child process.  I do get the appropriate output, but it looks weird and then my terminal just sits there waiting after everything is printed.</p>\n\n<p><strong>Code</strong></p>\n\n<pre><code>    #include &lt;stdio.h&gt;\n    #include &lt;errno.h&gt;\n    #include &lt;unistd.h&gt;\n    #include &lt;string.h&gt;\n\n    int main(int argc, char *argv[]) {\n        char *feeds[] = {\"http://feeds.washingtonpost.com/rss/lifestyle\",\n                     \"http://feeds.washingtonpost.com/rss/world\",\n                     \"http://feeds.washingtonpost.com/rss/opinions\"};\n\n        int num_feeds = 3;\n        if(argc &lt; 2) {\n            fprintf(stderr, \"You need to tell me a search phrase.\\n\");\n            return 1;\n        }\n        char *phrase = argv[1];  // this will be the phrase you to search for in the rss feed, passed as an argument\n    printf(\"we are going to search for \\\"%s\\\"\\n\", phrase);\n    int i;\n    for(i = 0; i &lt; num_feeds; i ++) {\n        char var[255];\n        sprintf(var, \"RSS_FEED=%s\", feeds[i]);\n        printf(\"we are going to search this feed: %s\\n\", var);\n        char *my_env[] = {var, NULL};\n        // I believe that once we call execle, the while loop stops because we've totally replaced the process! (we need fork...)\n        pid_t pid = fork();\n        printf(\"pid: %d\\n\", pid);\n        if(pid == -1) {  // -1 indicates that fork() had a problem cloning the process\n            fprintf(stderr, \"Can't fork process: %s\\n\", strerror(errno));\n            return 1;\n        }\n        if(pid == 0) {  // isn't a non-zero number for the parent process?? NO, this is like pid==0, i.e. child process\n            printf(\"running a child process now\\n\");\n            if(execle(\"/usr/bin/python\", \"/usr/bin/python\",\n                    \"./rssgossip/rssgossip.py\", phrase, NULL, my_env) == -1) {\n                fprintf(stderr, \"Can't run script: %s\\n\", strerror(errno));\n                return 1;\n            }\n        }\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p><strong>Output</strong></p>\n\n<pre><code>aarons-MacBook-Pro:ch9 aaronparisi$ ./news hi\nwe are going to search for \"hi\"\nwe are going to search this feed: RSS_FEED=http://feeds.washingtonpost.com/rss/lifestyle\npid: 68853\nwe are going to search this feed: RSS_FEED=http://feeds.washingtonpost.com/rss/world\npid: 68854\nwe are going to search this feed: RSS_FEED=http://feeds.washingtonpost.com/rss/opinions\npid: 0\nrunning a child process now\npid: 0\nrunning a child process now\npid: 68855\npid: 0\nrunning a child process now\naarons-MacBook-Pro:ch9 aaronparisi$ U.S. general in Afghanistan apologizes for highly offensive leaflets\nHow Burma's Rohingya crisis went from bad to worse\nSir Richard Branson is riding out Hurricane Irma in the wine cellar on his private island\nBritains royal family announces third pregnancy for Duke and Duchess of Cambridge\nFashion is finally figuring out diversity  in ways that actually matter\nThe Salt Line is an instant hit, with superb seafood and a view to match\nThe 2017 Washington Post Travel photo contest winners and finalists\nAsk Amy: New hire struggles with workplace racism\nHints From Heloise: Kitchen creativity\nMiss Manners: Helping a young child deflect questions\nA laughing matter\nHistory shows us how calamitous the North Korea crisis could become\nThese Washington players didnt just stick to their college major\nThe only thing less fair than the electoral college is the scoring in tennis\nWith DACA, Jeff Sessions bent Trump to his will - again\nWashington Post's Scott Wilson is out as national editor\nWho first said, 'The best government is that which governs least'? Not Thoreau.\n</code></pre>\n\n<p>As you can see, there is no command prompt at the end, and my terminal is just sitting there waiting.  Why?  It also seems odd that the command prompt shows up before printing any of the matching articles, not sure why that's happening either.</p>\n"}, {"tags": ["c", "eclipse", "embedded", "stm32", "qemu"], "comments": [{"owner": {"reputation": 3612, "user_id": 1813336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1zONI.jpg?s=128&g=1", "display_name": "cleblanc", "link": "https://stackoverflow.com/users/1813336/cleblanc"}, "edited": false, "score": 1, "creation_date": 1504730894, "post_id": 46083692, "comment_id": 79130195, "body": "Why <code>&amp;ram_vector + 1</code> and why <code>&amp;multiply - 1</code>  why not just ram_vector and multiply?"}, {"owner": {"reputation": 2345, "user_id": 5140756, "user_type": "registered", "accept_rate": 16, "profile_image": "https://i.stack.imgur.com/oMwxR.jpg?s=128&g=1", "display_name": "Augusto", "link": "https://stackoverflow.com/users/5140756/augusto"}, "reply_to_user": {"reputation": 3612, "user_id": 1813336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1zONI.jpg?s=128&g=1", "display_name": "cleblanc", "link": "https://stackoverflow.com/users/1813336/cleblanc"}, "edited": false, "score": 0, "creation_date": 1504731255, "post_id": 46083692, "comment_id": 79130357, "body": "because the processor is ARM"}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1504733470, "post_id": 46083692, "comment_id": 79131336, "body": "arm does not require a + 1, that is a bug in a number of ways, orred with 1, sure for safety but that just means you are using the tools incorrectly.  the cortex-ms have a vector table not an entry point you just start executing, if you want to run in ram and not use the address 0x00000000 vector table then use a different bootstrap for ram...copy from rom and jump."}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1504733509, "post_id": 46083692, "comment_id": 79131357, "body": "what is your qemu line?  what machine/target are you using in qemu?  and where is this ram you want to execute a program in?"}, {"owner": {"reputation": 2345, "user_id": 5140756, "user_type": "registered", "accept_rate": 16, "profile_image": "https://i.stack.imgur.com/oMwxR.jpg?s=128&g=1", "display_name": "Augusto", "link": "https://stackoverflow.com/users/5140756/augusto"}, "edited": false, "score": 0, "creation_date": 1504733663, "post_id": 46083692, "comment_id": 79131414, "body": "STM32F407VG, I don&#39;t know where are the RAM, I think that is in the MCU."}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1504733907, "post_id": 46083692, "comment_id": 79131503, "body": "I dont see anything stm32 in qemu.  How is qemu related to this?  Are you running on real hardware?"}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1504734021, "post_id": 46083692, "comment_id": 79131543, "body": "yeah the + 1 is definitely a problem for starters, you are misunderstanding things by doing that, what does your disassembly show related to that line of code?"}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1504734079, "post_id": 46083692, "comment_id": 79131570, "body": "what &quot;function&quot; are you trying to copy to ram?"}, {"owner": {"reputation": 2345, "user_id": 5140756, "user_type": "registered", "accept_rate": 16, "profile_image": "https://i.stack.imgur.com/oMwxR.jpg?s=128&g=1", "display_name": "Augusto", "link": "https://stackoverflow.com/users/5140756/augusto"}, "edited": false, "score": 0, "creation_date": 1504734149, "post_id": 46083692, "comment_id": 79131590, "body": "<a href=\"https://ibb.co/m6Gvya\" rel=\"nofollow noreferrer\">ibb.co/m6Gvya</a>, this is what I see."}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1504734313, "post_id": 46083692, "comment_id": 79131661, "body": "you have an stm32f4 discovery board, what does qemu have to do with this?"}, {"owner": {"reputation": 2345, "user_id": 5140756, "user_type": "registered", "accept_rate": 16, "profile_image": "https://i.stack.imgur.com/oMwxR.jpg?s=128&g=1", "display_name": "Augusto", "link": "https://stackoverflow.com/users/5140756/augusto"}, "reply_to_user": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1504734334, "post_id": 46083692, "comment_id": 79131671, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/153815/discussion-between-augusto-and-old-timer\">continue this discussion in chat</a>."}, {"owner": {"reputation": 2345, "user_id": 5140756, "user_type": "registered", "accept_rate": 16, "profile_image": "https://i.stack.imgur.com/oMwxR.jpg?s=128&g=1", "display_name": "Augusto", "link": "https://stackoverflow.com/users/5140756/augusto"}, "edited": false, "score": 0, "creation_date": 1504882885, "post_id": 46083692, "comment_id": 79201328, "body": "why you delete your post? He was complete and very good."}], "answers": [{"comments": [{"owner": {"reputation": 2345, "user_id": 5140756, "user_type": "registered", "accept_rate": 16, "profile_image": "https://i.stack.imgur.com/oMwxR.jpg?s=128&g=1", "display_name": "Augusto", "link": "https://stackoverflow.com/users/5140756/augusto"}, "edited": false, "score": 0, "creation_date": 1504731311, "post_id": 46084174, "comment_id": 79130385, "body": "The size I check on memory map generated by debug"}, {"owner": {"reputation": 3612, "user_id": 1813336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1zONI.jpg?s=128&g=1", "display_name": "cleblanc", "link": "https://stackoverflow.com/users/1813336/cleblanc"}, "reply_to_user": {"reputation": 2345, "user_id": 5140756, "user_type": "registered", "accept_rate": 16, "profile_image": "https://i.stack.imgur.com/oMwxR.jpg?s=128&g=1", "display_name": "Augusto", "link": "https://stackoverflow.com/users/5140756/augusto"}, "edited": false, "score": 0, "creation_date": 1504731356, "post_id": 46084174, "comment_id": 79130405, "body": "When I tested this on my x86 I got rid of the +1 -1 and copy 4*size bytes and it works."}, {"owner": {"reputation": 2345, "user_id": 5140756, "user_type": "registered", "accept_rate": 16, "profile_image": "https://i.stack.imgur.com/oMwxR.jpg?s=128&g=1", "display_name": "Augusto", "link": "https://stackoverflow.com/users/5140756/augusto"}, "edited": false, "score": 0, "creation_date": 1504731792, "post_id": 46084174, "comment_id": 79130598, "body": "I rid +1 and -1, and change size do 24. Keeping not working"}], "tags": [], "owner": {"reputation": 3612, "user_id": 1813336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1zONI.jpg?s=128&g=1", "display_name": "cleblanc", "link": "https://stackoverflow.com/users/1813336/cleblanc"}, "is_accepted": false, "score": 0, "last_activity_date": 1504731253, "creation_date": 1504731253, "answer_id": 46084174, "question_id": 46083692, "link": "https://stackoverflow.com/questions/46083692/how-to-execute-a-function-from-ram-memory-on-stm32-qemu-debugger-eclipse-in-c/46084174#46084174", "title": "How to execute a function from RAM memory on STM32 QEMU debugger eclipse in C?", "body": "<p>You're not copying enough bytes.  Your memorycopy function only copys 6 bytes and you want 6 integers don't you?</p>\n"}], "owner": {"reputation": 2345, "user_id": 5140756, "user_type": "registered", "accept_rate": 16, "profile_image": "https://i.stack.imgur.com/oMwxR.jpg?s=128&g=1", "display_name": "Augusto", "link": "https://stackoverflow.com/users/5140756/augusto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 588, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1504783735, "creation_date": 1504729093, "question_id": 46083692, "link": "https://stackoverflow.com/questions/46083692/how-to-execute-a-function-from-ram-memory-on-stm32-qemu-debugger-eclipse-in-c", "title": "How to execute a function from RAM memory on STM32 QEMU debugger eclipse in C?", "body": "<p>I'am using the STM32 QEMU debugger to test the code. I'm erase the while(1) because I just test the function.</p>\n\n<pre><code>typedef int(*fnc_t) (int);\n\nint multiply(int data) {\n    return (data * 5);\n}\n\nvoid memorycopy( unsigned char *src, unsigned char *dst, int size ) {\n    int j;\n    for( j=0; j &lt; size; j++ ) {\n        dst[j] = src[j];\n    }\n}\n\nint main(int argc, char* argv[])\n{\n    int i = 0;\n    unsigned int ram_vector[6];\n    fnc_t fnc_ram;\n\n    printf(\"1\\n\");\n    fnc_ram = (fnc_t) ( (int) &amp;ram_vector + 1);\n    printf(\"2\\n\");\n\n    volatile int z = (int)( &amp;multiply - 1);\n\n    memorycopy( (unsigned char*) z, (unsigned char*) fnc_ram, 6);\n\n    printf(\"3\\n\");\n    i = fnc_ram(3);\n    printf(\"4\\n\");\n    printf(\"Novo i: %d\\n\",i);\n    printf(\"5\\n\");\n}\n</code></pre>\n\n<p>But when I call the function i = fnc_ram(3); the follow error occurs:\n<a href=\"https://i.stack.imgur.com/WMP2I.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/WMP2I.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["c", "gcc", "cross-compiling", "x86-16", "fpu"], "comments": [{"owner": {"reputation": 310760, "user_id": 12711, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c330bdee507c95c603a93ca91d9145a9?s=128&d=identicon&r=PG", "display_name": "Michael Burr", "link": "https://stackoverflow.com/users/12711/michael-burr"}, "edited": false, "score": 0, "creation_date": 1506820846, "post_id": 46083682, "comment_id": 79971130, "body": "My recollection of FPU emulation back in the DOS days was that when the software routine was called it would check if the 8087 coprocessor was installed, and if so it would patch the call site to be native 8087 opcodes. Then it would return to the patched opcodes to do the work (and of course any subsequent execution of that code wouldn&#39;t even make a call to the software routine).  I don&#39;t know if the GCC FPU emulation library does the same thing, but it might be worth checking."}, {"owner": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "edited": false, "score": 0, "creation_date": 1506824020, "post_id": 46083682, "comment_id": 79971553, "body": "BTW I&#39;ve seen OpenWacom being used to compile MS-DOS executables in various projects; it may not be as updated and standard-compliant as gcc, but Wacom has been a production-strenght compiler for DOS for quite some time, while I don&#39;t think gcc ever really was."}, {"owner": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "reply_to_user": {"reputation": 310760, "user_id": 12711, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c330bdee507c95c603a93ca91d9145a9?s=128&d=identicon&r=PG", "display_name": "Michael Burr", "link": "https://stackoverflow.com/users/12711/michael-burr"}, "edited": false, "score": 0, "creation_date": 1506824334, "post_id": 46083682, "comment_id": 79971598, "body": "@MichaelBurr: IIRC all x87 opcodes were emitted with a special mangled first byte that would trap; the interrupt routine would then check if the coprocessor was available, if so it would patch the opcode and resume, otherwise it would do the calculation in software. But from this kind of linker errors (directly in the relevant function and not in some support library), I think that gcc is just trying to perform all the calculations in software."}, {"owner": {"user_type": "does_not_exist", "display_name": "user246672"}, "edited": false, "score": 0, "creation_date": 1506826824, "post_id": 46083682, "comment_id": 79971900, "body": "The &quot;8087&quot; had multiple versions and wasn&#39;t really even fully IEEE 754. The 80{1,2,3}87 were more standardized. Unfortunately, the ia16-elf toolchain appears to only support the 387, which is a strict superset of the 287 (adding <code>FP{,A}TAN</code> wider bounds, <code>SIN</code> and <code>COS</code>)."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user246672"}, "is_accepted": false, "score": 1, "last_activity_date": 1506828205, "last_edit_date": 1506828205, "creation_date": 1506819642, "answer_id": 46508343, "question_id": 46083682, "link": "https://stackoverflow.com/questions/46083682/how-to-generate-fpu-code-not-emulated-with-ia16-elf-g-compiler/46508343#46508343", "title": "How to generate fpu code (not emulated) with ia16-elf-g++ compiler?", "body": "<p>Docs are at <code>path/to/share/doc/sourceryg++-ia16-elf/man/man1/ia16-elf-g++.1</code></p>\n\n<p>If the target emulator or device isn't a 80{{,1}8{6,8},286} : <code>-mfpmath=80387</code></p>\n\n<p>Note that <code>ia16-elf-g{++,cc}</code> produce tiny model .COM files by default.</p>\n\n<p>You can also try <code>-march=i8086+8087</code>, but this might only work with <code>as</code>.</p>\n"}], "owner": {"reputation": 3062, "user_id": 185881, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/031d349e27a3c04ea878413e9af1e62f?s=128&d=identicon&r=PG", "display_name": "ern0", "link": "https://stackoverflow.com/users/185881/ern0"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 239, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1506828205, "creation_date": 1504729051, "question_id": 46083682, "link": "https://stackoverflow.com/questions/46083682/how-to-generate-fpu-code-not-emulated-with-ia16-elf-g-compiler", "title": "How to generate fpu code (not emulated) with ia16-elf-g++ compiler?", "body": "<p>I've downloaded Sourcery <a href=\"https://blogs.mentor.com/embedded/blog/2017/04/01/announcing-sourcery-codebench-lite-for-ia16/\" rel=\"nofollow noreferrer\">IA16 compiler</a>, which is a GNU C++ compiler for 16-bit targets, and it works (although, it does not support far pointers, and have some glitches with inline asm register allocation, whatever).</p>\n\n<p>But when I declare a <code>float</code> variable in C, the compiler says:</p>\n\n<pre><code>/tmp/ccBB3kEN.o: In function `foo()':\n(.text+0x38): undefined reference to `__floatsisf'\n/tmp/ccBB3kEN.o: In function `foo()':\n(.text+0x44): undefined reference to `__mulsf3'\n/tmp/ccBB3kEN.o: In function `foo()':\n(.text+0x4c): undefined reference to `__fixsfsi'\n</code></pre>\n\n<p>As figure shows, by default, it wants to use soft-fpu, so I tought, I should add some compiler options to generate native FPU code. But I've failed. </p>\n\n<p>Now I'm using compiler option <code>-march=i80186</code>, and the help says that I should add some postfix to it:</p>\n\n<pre><code>-march=CPU[,+EXTENSION...]\n  Igenerate code for CPU and EXTENSION, CPU is one of:\n  generic32, generic64, i386, i486, i586, i686,\n  pentium, pentiumpro, pentiumii, pentiumiii, pentium4,\n  prescott, nocona, core, core2, corei7, l1om, k1om,\n  iamcu, k6, k6_2, athlon, opteron, k8, amdfam10,\n  bdver1, bdver2, bdver3, bdver4, znver1, btver1,\n  btver2\nEXTENSION is combination of:\n  8087, 287, 387, no87, mmx, nommx, sse, sse2, sse3,\n  (etc.)\n</code></pre>\n\n<p>It looks like help text is not for IA16, as it does not contains 16-bit CPUs (but contains 32/64-bit ones), and also extensions do not work, I've been tried with <code>-march=i8086,8087</code>:</p>\n\n<pre><code>ia16-elf-g++: error: unrecognized command line option '-march=i8086,8087\n</code></pre>\n\n<p>Other options, like <code>-mhard-float</code> also does not work.</p>\n\n<pre><code>ia16-elf-g++: error: unrecognized command line option '-mhard-float'\n</code></pre>\n\n<p>My question is: how can I set 8086 + 8087 target for this compiler? If it does not support it, is there any other C/C++ compiler which can produce MS-DOS .com output with FPU code (on Linux or MacOS platforms)?</p>\n"}, {"tags": ["c", "printf", "gnu", "c89", "size-t"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1504729416, "post_id": 46083560, "comment_id": 79129438, "body": "With pre C99, <code>long&#47;unsigned long</code> is the widest standard type - little can be lost casting to the widest integer type there.  Of course could use <code>rintf (&quot;size = %.0f\\n&quot;, 1.0*  sizeof array);</code>"}, {"owner": {"reputation": 1325, "user_id": 8055063, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/fUn28.png?s=128&g=1", "display_name": "Bite Bytes", "link": "https://stackoverflow.com/users/8055063/bite-bytes"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1504729506, "post_id": 46083560, "comment_id": 79129475, "body": "@chux but is that code compliant to the standard?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1504729542, "post_id": 46083560, "comment_id": 79129492, "body": "It is compliant (Aside from maybe overflow in <code>pointer2 - pointer1</code>).  The issue remains will it print the expected result?  (Did it truncated?)"}, {"owner": {"reputation": 1325, "user_id": 8055063, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/fUn28.png?s=128&g=1", "display_name": "Bite Bytes", "link": "https://stackoverflow.com/users/8055063/bite-bytes"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1504729612, "post_id": 46083560, "comment_id": 79129526, "body": "@chux so it&#39;s not gonna work in all cases, just in most cases."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1504729795, "post_id": 46083560, "comment_id": 79129624, "body": "It is roughly &quot;In C90, if anything standard is going to work, it is this&quot;.  It isn&#39;t guaranteed to work in all scenarios, but it would work in most of them.  And there wasn&#39;t an alternative specified by the standard that would work better.  Since C99, you should use the <code>z</code> (for <code>size_t</code>) and <code>t</code> (for <code>ptrdiff_t</code>) size modifiers: <code>&quot;%zu; %td\\n&quot;</code>."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1504729994, "post_id": 46083560, "comment_id": 79129742, "body": "Curious, do you need to print the size in a GNU systems that is pre-C99 compliant?"}, {"owner": {"reputation": 1325, "user_id": 8055063, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/fUn28.png?s=128&g=1", "display_name": "Bite Bytes", "link": "https://stackoverflow.com/users/8055063/bite-bytes"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1504730234, "post_id": 46083560, "comment_id": 79129867, "body": "@chux No, I just wanted to make sure that the standard, as far as I know, doesn&#39;t really allow that code to work in all cases."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1504730604, "post_id": 46083560, "comment_id": 79130047, "body": "This should work in all cases <code>void print_size(size_t sz) {   if (sz &gt;= 10) {     print_size(sz&#47;10);   }   printf(&quot;%u&quot;, (unsigned) (sz%10)); }</code>"}], "answers": [{"comments": [{"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 2, "creation_date": 1504730167, "post_id": 46083895, "comment_id": 79129822, "body": "No, the standard doesn&#39;t guarantee that <code>%zd</code> will work for a <code>ptrdiff_t</code> argument -- but it doesn&#39;t need to, since the correct format for a <code>ptrdiff_t</code> argument is <code>%td&#39;</code>. (<code>%zd</code> is for the signed type corresponding to the unsigned type <code>size_t</code>. There is no portable name for that type -- even POSIX doesn&#39;t guarantee that <code>ssize_t</code> qualifies.)"}, {"owner": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "reply_to_user": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1504730211, "post_id": 46083895, "comment_id": 79129849, "body": "@KeithThompson: Feel free to edit the answer, I was unable to find documentation for Visual Studio."}, {"owner": {"reputation": 1325, "user_id": 8055063, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/fUn28.png?s=128&g=1", "display_name": "Bite Bytes", "link": "https://stackoverflow.com/users/8055063/bite-bytes"}, "edited": false, "score": 0, "creation_date": 1504730521, "post_id": 46083895, "comment_id": 79129999, "body": "Actually I don&#39;t intend to fully follow these rules, I read other conventions, and I&#39;m reading this, only, to see if I can find something that I missed in the others, or something I like."}], "tags": [], "owner": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "is_accepted": true, "score": 3, "last_activity_date": 1504730353, "last_edit_date": 1504730353, "creation_date": 1504730029, "answer_id": 46083895, "question_id": 46083560, "link": "https://stackoverflow.com/questions/46083560/printing-size-t-using-printf-in-gnu-systems/46083895#46083895", "title": "Printing size_t using printf in GNU systems", "body": "<p>The question as asked:</p>\n\n<blockquote>\n  <p>Does really the 1989 Standard C allow that code?</p>\n</blockquote>\n\n<p>Yes, if by \"allow\" we mean \"this will compile and run, doing something reasonable and not triggering undefined behavior\" (and not \"this will do what I want\"). The two cases are slightly different.</p>\n\n<p>For <code>size_t</code>, the result will be truncated if it is too large.  For <code>ptrdiff_t</code>, the result will be implementation-defined if it is too large.</p>\n\n<p>However, recent versions of Visual Studio (<code>_MSC_VER &gt;= 1800</code>) support the <code>z</code> and <code>t</code> conversions (necessary for C++11 support anyway), so you can use:</p>\n\n<pre><code>size_t size;\nprintf(\"size = %zu\\n\", size);\nptrdiff_t diff;\nprintf(\"diff = %td\\n\", diff);\n</code></pre>\n\n<p>This will also work on other systems (GNU, BSD, Darwin). For older versions of Visual Studio there are alternatives, but it would require using a different format string on different platforms.</p>\n\n<h2>A note on GNU coding standards</h2>\n\n<p>The GNU coding standards are for the GNU organization, which has some very specific goals and does not care much about supporting Windows. I would take their coding standards with a grain of salt, unless you have a specific reason to follow them (for example, you want your project to become a GNU project in the future).</p>\n"}], "owner": {"reputation": 1325, "user_id": 8055063, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/fUn28.png?s=128&g=1", "display_name": "Bite Bytes", "link": "https://stackoverflow.com/users/8055063/bite-bytes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 191, "favorite_count": 0, "accepted_answer_id": 46083895, "answer_count": 1, "score": 3, "last_activity_date": 1504730353, "creation_date": 1504728554, "last_edit_date": 1504729058, "question_id": 46083560, "link": "https://stackoverflow.com/questions/46083560/printing-size-t-using-printf-in-gnu-systems", "title": "Printing size_t using printf in GNU systems", "body": "<p>While I was reading this <a href=\"https://www.gnu.org/prep/standards/html_node/CPU-Portability.html#CPU-Portability\" rel=\"nofollow noreferrer\">article</a>, I came across this paragraph:</p>\n\n<blockquote>\n  <p>Similarly, don\u2019t make any effort to cater to the possibility that long will be smaller than predefined types like size_t. For example, the following code is ok:</p>\n</blockquote>\n\n<pre><code>printf (\"size = %lu\\n\", (unsigned long) sizeof array);\nprintf (\"diff = %ld\\n\", (long) (pointer2 - pointer1));\n</code></pre>\n\n<blockquote>\n  <p>1989 Standard C requires this to work, and we know of only one counterexample: 64-bit programs on Microsoft Windows. We will leave it\n  to those who want to port GNU programs to that environment to figure\n  out how to do it.</p>\n</blockquote>\n\n<p>Does really the 1989 Standard C allow that code?</p>\n"}, {"tags": ["c", "eclipse", "keyboard", "mingw", "scanf"], "comments": [{"owner": {"reputation": 796419, "user_id": 34397, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/7deca8ec973c3c0875e9a36e1e3e2c44?s=128&d=identicon&r=PG", "display_name": "SLaks", "link": "https://stackoverflow.com/users/34397/slaks"}, "edited": false, "score": 0, "creation_date": 1504727042, "post_id": 46083170, "comment_id": 79128261, "body": "How are you running the code?"}, {"owner": {"reputation": 880, "user_id": 3661738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acddd9c3372908d0903c4611aea1a9b7?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler", "link": "https://stackoverflow.com/users/3661738/tyler"}, "edited": false, "score": 1, "creation_date": 1504727107, "post_id": 46083170, "comment_id": 79128289, "body": "It works as intended when I run your code"}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1504727219, "post_id": 46083170, "comment_id": 79128340, "body": "The program as shown is correct ISO C (up to a point: <code>scanf</code> is broken-as-specified, and should never be used in production -- but for this kind of learning exercise it&#39;s fine) and should work as intended.  <i>Exactly</i> what compiler, debugger, console, operating system, etc. are you using? Leave nothing out."}, {"owner": {"reputation": 1, "user_id": 7428120, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154288485866452/picture?type=large", "display_name": "John Michael Angle", "link": "https://stackoverflow.com/users/7428120/john-michael-angle"}, "edited": false, "score": 0, "creation_date": 1504727689, "post_id": 46083170, "comment_id": 79128580, "body": "I&#39;m using MinGW GCC compiler in Eclipse, Windows 7."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 1, "creation_date": 1504728423, "post_id": 46083170, "comment_id": 79128944, "body": "scanf() returns a value - you should check it."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1504732451, "post_id": 46083170, "comment_id": 79130873, "body": "Did you try typing a number even if there is no blinking cursor?"}, {"owner": {"reputation": 3725, "user_id": 8471208, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-zX6iRd9pmRI/AAAAAAAAAAI/AAAAAAAAAgE/F3-J9H4ZCno/photo.jpg?sz=128", "display_name": "Kevin Boone", "link": "https://stackoverflow.com/users/8471208/kevin-boone"}, "edited": false, "score": 0, "creation_date": 1504789084, "post_id": 46083170, "comment_id": 79155746, "body": "I guess this would be regarded as a console-mode program, and you need a console to run it in. I don&#39;t know much about Eclipse -- are you generating a .exe file and then running it in a DOS Box? Or relying on Eclipse to run the code when it&#39;s built? If Eclipse runs it, does it pop up a console of some sort? The MINGW gcc will build console-mode programs for Windows, but you do actually need the console."}], "answers": [{"comments": [{"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1504969180, "post_id": 46121884, "comment_id": 79226181, "body": "That must be a quirk of Eclipse, MinGW, and/or Windows &quot;consoles&quot; -- going by only the C specification, applying <code>setvbuf</code> to <code>stdout</code> should not have any effect on a call to <code>scanf</code> (which works only with <code>stdin</code>).  I cannot help you any further than that."}], "tags": [], "owner": {"reputation": 1, "user_id": 7428120, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154288485866452/picture?type=large", "display_name": "John Michael Angle", "link": "https://stackoverflow.com/users/7428120/john-michael-angle"}, "is_accepted": false, "score": 0, "last_activity_date": 1504892285, "creation_date": 1504892285, "answer_id": 46121884, "question_id": 46083170, "link": "https://stackoverflow.com/questions/46083170/where-is-scanf-reading-input-from-if-not-from-the-keyboard/46121884#46121884", "title": "Where is scanf() reading input from, if not from the keyboard?", "body": "<p>So I've gotten a line of code from my professor which takes care of this bug -- whether it's a necessary solution particular to Eclipse and/or MinGW I'm not sure. In any case, here's the code with the additional line:</p>\n\n<pre><code>int main(void) {\n    int userBookSelection;\n    setvbuf (stdout, NULL, _IONBF, 0);//&lt;---The magic line\n\n    scanf(\"%i\", &amp;userBookSelection);\n    printf(\"Printing userBookSelection: %i\", userBookSelection);\n\n    return EXIT_SUCCESS;\n}\n</code></pre>\n\n<p>I'd appreciate any additional wisdom on what's going on, what setvbuf() is doing and how scanf() works more fundamentally. </p>\n"}], "owner": {"reputation": 1, "user_id": 7428120, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154288485866452/picture?type=large", "display_name": "John Michael Angle", "link": "https://stackoverflow.com/users/7428120/john-michael-angle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 235, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1504892285, "creation_date": 1504726958, "last_edit_date": 1504736810, "question_id": 46083170, "link": "https://stackoverflow.com/questions/46083170/where-is-scanf-reading-input-from-if-not-from-the-keyboard", "title": "Where is scanf() reading input from, if not from the keyboard?", "body": "<p>I'm a novice programmer getting introduced to C and I'm missing something fundamental about the way my scanf() works. I want to read a single int from the keyboard with code like this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main(void) {\n    int userBookSelection;\n    scanf(\"%i\", &amp;userBookSelection);\n    printf(\"Printing userBookSelection: %i\", userBookSelection);\n\n    return EXIT_SUCCESS;\n}\n</code></pre>\n\n<p>When I run the code, the console stays black until I stop debugging. There is never a cursor waiting for keyboard input. When I stop debug I can see this output in the console, same every time:</p>\n\n<p>Printing userBookSelection: 2130567168</p>\n\n<p>I'm debugging in Eclipse with MinGW GCC compiler on Windows. The code syntax seems to be correct -- is it possible there's something wrong in my build path to make this happen? I need to know why scanf() isn't reading for keyboard input.</p>\n"}, {"tags": ["python", "c", "python-3.x", "user-interface", "python-c-api"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1504726759, "post_id": 46083079, "comment_id": 79128107, "body": "Why not use Python for all? And the rest is C basics and can be implemented different ways. So what is your <b>specific</b> problem you did not find in your beginner&#39;s C book and the Python docs?"}, {"owner": {"reputation": 169, "user_id": 3532367, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3ff5bd296341f3a6ad61dc8ccad8371?s=128&d=identicon&r=PG&f=1", "display_name": "Mariusz", "link": "https://stackoverflow.com/users/3532367/mariusz"}, "edited": false, "score": 1, "creation_date": 1504729870, "post_id": 46083079, "comment_id": 79129673, "body": "What you want is creating python wrapper for C function. You can read about wrappers here : <a href=\"http://intermediate-and-advanced-software-carpentry.readthedocs.io/en/latest/c++-wrapping.html\" rel=\"nofollow noreferrer\">intermediate-and-advanced-software-carpentry.readthedocs.io/&zwnj;&#8203;en/&hellip;</a>"}, {"owner": {"reputation": 8884, "user_id": 8372104, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/72UbV.png?s=128&g=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/8372104/simon"}, "reply_to_user": {"reputation": 169, "user_id": 3532367, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3ff5bd296341f3a6ad61dc8ccad8371?s=128&d=identicon&r=PG&f=1", "display_name": "Mariusz", "link": "https://stackoverflow.com/users/3532367/mariusz"}, "edited": false, "score": 0, "creation_date": 1504731492, "post_id": 46083079, "comment_id": 79130459, "body": "@Mariusz I&#39;ll take look."}, {"owner": {"reputation": 8884, "user_id": 8372104, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/72UbV.png?s=128&g=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/8372104/simon"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1504739735, "post_id": 46083079, "comment_id": 79133266, "body": "@Olaf take a look at line 19 in GUI.py there is my <b>specific problem</b> or read the second last line in my question."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1504740069, "post_id": 46083079, "comment_id": 79133343, "body": "@Simon: Read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> and follow the advice. I will not count lines, etc. As I already wrote, it does not make any sense to call a C program just to play a sound. You are making your life much hard than necessary and your code much less maintainable."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1504740305, "post_id": 46083079, "comment_id": 79133386, "body": "Oh, and I forgot: C is not a scripting language and for Python it depends on the usage."}, {"owner": {"reputation": 8884, "user_id": 8372104, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/72UbV.png?s=128&g=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/8372104/simon"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1504741781, "post_id": 46083079, "comment_id": 79133730, "body": "@Olaf Point taken about the counting lines however I have mentioned it in two other places in the question.  Also my script above is an overkill just to play sound however it is a <a href=\"https://stackoverflow.com/help/mcve\">minimal</a>  example for the question I am asking.  I don&#39;t get the comment on the scripting language.  Also thanks for the advice to help improve my questions and posts."}], "answers": [{"tags": [], "owner": {"reputation": 196, "user_id": 7913622, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e0ae8182aff6a61f70302d772e50dbe?s=128&d=identicon&r=PG&f=1", "display_name": "JJAACCEeEKK", "link": "https://stackoverflow.com/users/7913622/jjaacceeekk"}, "is_accepted": true, "score": 2, "last_activity_date": 1504727080, "creation_date": 1504727080, "answer_id": 46083209, "question_id": 46083079, "link": "https://stackoverflow.com/questions/46083079/using-c-application-with-a-python-gui/46083209#46083209", "title": "Using C application with a Python GUI", "body": "<p>Compile main_file.c and run it as a executable using: <code>os.system(r'PATH_TO_EXE')</code></p>\n"}], "owner": {"reputation": 8884, "user_id": 8372104, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/72UbV.png?s=128&g=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/8372104/simon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 849, "favorite_count": 0, "accepted_answer_id": 46083209, "answer_count": 1, "score": 0, "last_activity_date": 1549213697, "creation_date": 1504726611, "last_edit_date": 1516977487, "question_id": 46083079, "link": "https://stackoverflow.com/questions/46083079/using-c-application-with-a-python-gui", "title": "Using C application with a Python GUI", "body": "<p>I have built a simple application in C and I want it to have a GUI.  I want the GUI to be in Python (since it's easier) but am not sure how I would get the user response from Python to C or even if it's possible.</p>\n\n<p>What I want is a tkinter window to open asking if the user wants to play a file and if they click on yes then for the file get played.</p>\n\n<p>This is my C script (main_file.c):</p>\n\n<pre><code>#include &lt;window.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;conio.h&gt;\n#include &lt;python.h&gt;\n\nint Play()\n{\n    PlaySound(\"Sound1.wav\", NULL, SND_ASYNC);\n\n    while(1)\n    {\n        continue;\n    }\n    return 0;\n}\n\nint main()\n{\n    char filename[] = \"GUI.py\";\n    FILE* fp;\n\n    Py_Initialize();\n\n    fp = _Py_fopen(filename, \"r\");\n    PyRun_SimpleFile(fp, filename);\n\n    Py_Finalize();\n    return 0;\n}\n</code></pre>\n\n<p>and my GUI.py file:</p>\n\n<pre><code>import tkinter as tk\n\nclass App(tk.Frame):\n    def __init__(self, master=None):\n        super().__init__(master)\n        self.pack()\n        self.option()\n\n    def option(self):\n        self.opt = tk.Button(self)\n        self.opt[\"text\"] = \"Do You Want To Play File\"\n        self.opt[\"command\"] = self.play\n        self.opt.pack(side=\"top\")\n\n        self.quit = tk.Button(self, text=\"QUIT\", fg=\"red\", command=root.destroy)\n        self.quit.pack(side=\"bottom\")\n\n    def play(self):\n        #This part needs to tell C to use Play() function\n\nroot = tk.Tk()\napp = App(master=root)\napp.mainloop()\n</code></pre>\n\n<p>The problem is that I don't know how to make Python tell C to use the Play() function.</p>\n\n<p>I'm using MinGW on Windows 10.   </p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 5, "creation_date": 1504719659, "post_id": 46081271, "comment_id": 79124310, "body": "21% is not that far from 25%, ie. 100% of the one core you can use."}, {"owner": {"reputation": 86, "user_id": 6517623, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YIxwo.png?s=128&g=1", "display_name": "Hedron", "link": "https://stackoverflow.com/users/6517623/hedron"}, "edited": false, "score": 2, "creation_date": 1504719739, "post_id": 46081271, "comment_id": 79124361, "body": "If the question is why it&#39;s taking so long it&#39;s because it has to calculate each previous number."}, {"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 5, "creation_date": 1504719799, "post_id": 46081271, "comment_id": 79124393, "body": "It takes a long time because this is approach, although simple, is arguably the least efficient approach (double recursion) to doing fibonacci sequence calculations. It amount of recursion increases exponentially with the size of the number, and it recalculates values multi-fold."}, {"owner": {"reputation": 61, "user_id": 8550384, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-czVd8uQVcqw/AAAAAAAAAAI/AAAAAAAADN8/q7UjCZ9gL5c/photo.jpg?sz=128", "display_name": "Adam Goodsell", "link": "https://stackoverflow.com/users/8550384/adam-goodsell"}, "edited": false, "score": 0, "creation_date": 1504720995, "post_id": 46081271, "comment_id": 79125100, "body": "thanks guys.  I understand that this approach isn&#39;t efficient; I was just curious why it wasn&#39;t using all cores.  I guess now I&#39;ll have to look into how to assign new threads in c."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1504723789, "post_id": 46081271, "comment_id": 79126558, "body": "That code is obviously sub-optimal and not how fib(n) is typically calculated (or defined, iirc). Maybe you should do at least some basic research."}, {"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 3, "creation_date": 1504727590, "post_id": 46081271, "comment_id": 79128511, "body": "Actually, just look up memoizing.  Good programming trumps faster hardware."}], "answers": [{"tags": [], "owner": {"reputation": 490, "user_id": 8179718, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/064yN.jpg?s=128&g=1", "display_name": "E&#228;rendil Baggins", "link": "https://stackoverflow.com/users/8179718/e%c3%a4rendil-baggins"}, "is_accepted": false, "score": 1, "last_activity_date": 1504720001, "creation_date": 1504720001, "answer_id": 46081423, "question_id": 46081271, "link": "https://stackoverflow.com/questions/46081271/why-is-recursion-taking-so-long/46081423#46081423", "title": "Why is recursion taking so long?", "body": "<p>You won't exploit a quad core system if you have a single-threaded program.</p>\n\n<p>It will run on one core only, so the 21/25% CPU usage is realistic.</p>\n\n<p>A way to use it all would be, first of all not using recursion as it makes it annoying to do, and when you have a for/while loop split it into 4 while loops and put each of them in a new thread. Then you'll have to manage synchronization in order to print the message properly, but it's not even that hard. You could store all the results in an array and then print it when all the threads are done.</p>\n"}, {"tags": [], "owner": {"reputation": 1619, "user_id": 3342206, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/92d5672ff3c806eb71d84d7298d5be43?s=128&d=identicon&r=PG&f=1", "display_name": "8bittree", "link": "https://stackoverflow.com/users/3342206/8bittree"}, "is_accepted": false, "score": 4, "last_activity_date": 1504731404, "creation_date": 1504731404, "answer_id": 46084213, "question_id": 46081271, "link": "https://stackoverflow.com/questions/46081271/why-is-recursion-taking-so-long/46084213#46084213", "title": "Why is recursion taking so long?", "body": "<blockquote>\n  <p>the number of calls being made to the recursive function is something of 2^n, or exponential complexity. Understood.</p>\n</blockquote>\n\n<p>I'm not sure you do entirely understand this, since you seem surprised about how slow it becomes around n=40, and n=47.</p>\n\n<p>With a complexity of 2^n, and an <em>n</em> of 40, that would be 2<sup>40</sup>, or 1,099,511,627,776, or about 1 <em>trillion</em> operations. If your computer can run about one of these operations per nanosecond, i.e. 1 billion operations per second, it would take 1000 seconds to finish.</p>\n\n<p>Consider if <em>n</em> was only 30. 2<sup>30</sup> is 1,073,741,824, which would take only about 1 second to do on that same computer.</p>\n\n<p>As has been mentioned, you're only using one core. You could parallelize, but that won't help much. Use four cores instead of one, and my n=40 example will still take 250 seconds. Go up to n=42 and you're back to 1000 seconds, because parallelizing <em>at best</em> multiplies your performance, but an algorithm like this grows exponentially.</p>\n"}, {"comments": [{"owner": {"reputation": 6681, "user_id": 6024122, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-uiRWa4coXLs/AAAAAAAAAAI/AAAAAAAAJUs/5BxfhSS1bUY/photo.jpg?sz=128", "display_name": "Patrick Trentin", "link": "https://stackoverflow.com/users/6024122/patrick-trentin"}, "edited": false, "score": 0, "creation_date": 1504857363, "post_id": 46087365, "comment_id": 79185188, "body": "The <i>overflow</i> certainly hinders correctness, but from the point of view of complexity I don&#39;t see how it makes the computation any slower. Anyway, +1"}], "tags": [], "owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "is_accepted": false, "score": 2, "last_activity_date": 1504756247, "last_edit_date": 1504756247, "creation_date": 1504755033, "answer_id": 46087365, "question_id": 46081271, "link": "https://stackoverflow.com/questions/46081271/why-is-recursion-taking-so-long/46087365#46087365", "title": "Why is recursion taking so long?", "body": "<ol>\n<li>the posted code contains some extreme over complexity.  </li>\n<li>even a <code>long long unsigned int</code> cannot contain a Fibonacci value\nnumber 100 (or even close to it) </li>\n</ol>\n\n<p>Suggest using a very simple program to start, one that calculates the Fibonacci sequence.  Then use that program to determine how to display the results.</p>\n\n<p>The following program calculates the numbers, is very fast, but still has the problem of overflow of a <code>long long unsigned int</code></p>\n\n<pre><code>#include &lt;stdio.h&gt;  // printf()\n\n\nint main( void )\n{\n    long long unsigned currentNum = 1;\n    long long unsigned priorNum = 1;\n\n    printf( \"1\\n1\\n\" );\n\n    for (size_t i = 2;  i &lt; 100; i++ )\n    {\n        long long unsigned newNum = currentNum+priorNum;\n        printf( \"%llu\\n\", newNum );\n        priorNum = currentNum;\n        currentNum = newNum;\n    }\n}\n</code></pre>\n\n<p>On my linux 86-64 computer, here are the last few lines of the output, showing the overflow problem.</p>\n\n<pre><code>99194853094755497\n160500643816367088\n259695496911122585\n420196140727489673\n679891637638612258\n1100087778366101931\n1779979416004714189\n2880067194370816120\n4660046610375530309\n7540113804746346429\n12200160415121876738\n1293530146158671551\n13493690561280548289\n14787220707439219840\n9834167195010216513\n6174643828739884737\n16008811023750101250\n3736710778780434371\n</code></pre>\n\n<p>So, why is recursion taking so long?</p>\n\n<p>because of the huge number of recursions and the handling of the overflows</p>\n\n<p>The above suggested code eliminates the recursions, but not the overflows and it takes less than a second (on my computer) to run.</p>\n"}, {"comments": [{"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1504899239, "post_id": 46111319, "comment_id": 79209519, "body": "Thanks for the example for using the gmp library"}], "tags": [], "owner": {"reputation": 6681, "user_id": 6024122, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-uiRWa4coXLs/AAAAAAAAAAI/AAAAAAAAJUs/5BxfhSS1bUY/photo.jpg?sz=128", "display_name": "Patrick Trentin", "link": "https://stackoverflow.com/users/6024122/patrick-trentin"}, "is_accepted": false, "score": 0, "last_activity_date": 1504884044, "last_edit_date": 1504884044, "creation_date": 1504856955, "answer_id": 46111319, "question_id": 46081271, "link": "https://stackoverflow.com/questions/46081271/why-is-recursion-taking-so-long/46111319#46111319", "title": "Why is recursion taking so long?", "body": "<p>Building on the answer made by @<a href=\"https://stackoverflow.com/users/3629249/user3629249\">user3629249</a>, you can get rid of the <em>overflows</em> he mentioned by using the <em>infinite precision arithmetic library</em> provided by <a href=\"https://gmplib.org/\" rel=\"nofollow noreferrer\">GMP</a>.</p>\n\n<p><strong>e.g.</strong></p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdio.h&gt;  // printf\n#include &lt;stdlib.h&gt; // free\n#include &lt;gmp.h&gt;    // mpz_t\n\nint main( void )\n{\n    mpz_t prevNum, currNum, tempNum, counter;\n\n    mpz_init_set_si(prevNum, 0);\n    mpz_init_set_si(currNum, 1);\n    mpz_init_set_si(tempNum, 1);\n    mpz_init_set_si(counter, 1);\n\n    printf( \"0: 0\\n\" );\n\n    while (1) {\n        char *tempNumRepr = mpz_get_str(NULL, 10, tempNum);\n        char *counterRepr = mpz_get_str(NULL, 10, counter);\n\n        printf(\"%s: %s\\n\", counterRepr, tempNumRepr);\n\n        free(tempNumRepr);\n        free(counterRepr);\n\n        mpz_add(tempNum, currNum, prevNum); // tempNum = currNum + prevNum;\n        mpz_add_ui(counter, counter, 1);    // counter = counter + 1;\n        mpz_set(prevNum, currNum);          // prevNum = currNum;\n        mpz_set(currNum, tempNum);          // currNum = tempNum;\n    }\n\n    mpz_clear(prevNum);\n    mpz_clear(currNum);\n    mpz_clear(tempNum);\n    mpz_clear(counter);\n\n    return EXIT_SUCCESS;\n};\n</code></pre>\n\n<p>To compile it, ensure that you have <em>libgmp</em> installed, type:</p>\n\n<pre><code>~$ gcc fib.c -lgmp\n</code></pre>\n\n<p>You get massive <em>fibonacci</em> values pretty fast:</p>\n\n<pre><code>~$ ./a.out\n0: 0\n1: 1\n2: 1\n3: 2\n4: 3\n5: 5\n6: 8\n7: 13\n8: 21\n9: 34\n...\n90: 2880067194370816120\n91: 4660046610375530309\n92: 7540113804746346429\n93: 12200160415121876738\n94: 19740274219868223167\n95: 31940434634990099905\n96: 51680708854858323072\n97: 83621143489848422977\n98: 135301852344706746049\n99: 218922995834555169026\n100: 354224848179261915075\n...\n142: 212207101440105399533740733471\n143: 343358302784187294870275058337\n144: 555565404224292694404015791808\n145: 898923707008479989274290850145\n146: 1454489111232772683678306641953\n147: 2353412818241252672952597492098\n148: 3807901929474025356630904134051\n149: 6161314747715278029583501626149\n150: 9969216677189303386214405760200\n...\n10456: 6687771891046976665010914682715972428661740561209776353485935351631179302708216108795962659308263419533746676628535531789045787219342206829688433844719175383255599341828410480942962469553971997586487609675800755252584139702413749597015823849849046700521430415467867019518212926720410106893075072562394664597041033593563521410003073230903292197734713471051090595503533547412747118747787351929732433449493727418908972479566909080954709569018619548197645271462668017096925677064951824250666293199593131718849011440475925874263429880250725807157443918222920142864819346465587051597207982477956741428300547495546275347374411309127960079792636429623948756731669388275421014167909883947268371246535572766045766175917299574719971717954980856956555916099403979976768699108922030154574061373884317374443228652666763423361895311742060974910298682465051864682016439317005971937944787596597197162234588349001773183227535867183191706435572614767923270023480287832648770215573899455920695896713514952891911913499762717737021116746179317675622780792638129991728650763618970292905899648572351513919065201266611540504973510404007895858009291738402611754822294670524761118059571137973416151185102238975390542996959456114838498320921216851752236455715812273599551395186676228882752252829522673168259864505917922994675966393982705428427387550834530918600733123354437191268657802903434440996622861582962869292133202292740984119730918997492224957849300327645752441866958526558379656521799598935096546592129670888574358354955519855060127168291877171959996776081517513455753528959306416265886428706197994064431298142841481516239689015446304286858347321708226391039390175388745315544138793021359869227432464706950061238138314080606377506673283324908921190615421862717588664540813607678946107283312579595718137450873566434040358736923152893920579043838335105796035360841757227288861017982575677839192583578548045589322945\n...\n</code></pre>\n\n<p>Use <em>CTRL+C</em> to stop the program.</p>\n"}], "owner": {"reputation": 61, "user_id": 8550384, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-czVd8uQVcqw/AAAAAAAAAAI/AAAAAAAADN8/q7UjCZ9gL5c/photo.jpg?sz=128", "display_name": "Adam Goodsell", "link": "https://stackoverflow.com/users/8550384/adam-goodsell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 840, "favorite_count": 0, "answer_count": 4, "score": 2, "last_activity_date": 1504884044, "creation_date": 1504719435, "last_edit_date": 1504719529, "question_id": 46081271, "link": "https://stackoverflow.com/questions/46081271/why-is-recursion-taking-so-long", "title": "Why is recursion taking so long?", "body": "<p>In using recursion to calculate the  nth number of the fibonacci sequence, I have written this simple program:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;limits.h&gt;\n\nunsigned int long long fibonacci(unsigned int number);\n\n//game of craps\nint main(int argc, char** argv)\n{\n\n    for(int n = 1; n &lt;= 100; n++)\n    {\n        printf(\"%llu\\n\", fibonacci(n));\n    }\n\n    return (EXIT_SUCCESS);\n}\n\n\nunsigned long long int fibonacci(unsigned int number)\n{\n    if (number == 0 || number == 1)\n    {\n        return number;\n    }\n    else\n    {\n        return fibonacci(number - 2) + fibonacci(number - 1);      \n    }\n}\n</code></pre>\n\n<p>where each call to the n+1 number in the sequence doubles the number of function calls the program has to run.  Therefore the number of calls being made to the recursive function is something of 2^n, or exponential complexity.   Understood.  But where is all of the computing power going? once the nth number in the sequence starts to hit 40, the computer starts taking noticeable time to compute the result where at n = 47 its take 30+ seconds.  However my computer shows that I'm only using 21 percent of cpu power.  I'm using NetBeans IDE to run the program. It's a quad core system.  </p>\n"}, {"tags": ["c", "ascii", "implicit-conversion"], "comments": [{"owner": {"reputation": 6681, "user_id": 6024122, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-uiRWa4coXLs/AAAAAAAAAAI/AAAAAAAAJUs/5BxfhSS1bUY/photo.jpg?sz=128", "display_name": "Patrick Trentin", "link": "https://stackoverflow.com/users/6024122/patrick-trentin"}, "edited": false, "score": 6, "creation_date": 1504718839, "post_id": 46081097, "comment_id": 79123867, "body": "<b>hint:</b> what are the first <code>26</code> (0-25) characters of the <a href=\"https://simple.wikipedia.org/wiki/ASCII\" rel=\"nofollow noreferrer\">ASCII table</a>?"}, {"owner": {"reputation": 36141, "user_id": 4354477, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/SuxtS.gif?s=128&g=1", "display_name": "ForceBru", "link": "https://stackoverflow.com/users/4354477/forcebru"}, "edited": false, "score": 3, "creation_date": 1504718908, "post_id": 46081097, "comment_id": 79123904, "body": "That you <i>cannot see</i> what&#39;s being printed doesn&#39;t necessarily mean nothing is being printed."}, {"owner": {"reputation": 4376, "user_id": 2850543, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2bb15c1da6de8180d9adc99954f167f7?s=128&d=identicon&r=PG&f=1", "display_name": "Millie Smith", "link": "https://stackoverflow.com/users/2850543/millie-smith"}, "edited": false, "score": 0, "creation_date": 1504718975, "post_id": 46081097, "comment_id": 79123936, "body": "What ForceBru said. Generally you can get better information in cases like this if you surround your format specifier with text. <code>printf(&quot;f%cf&quot;, ...);</code> (just to convince you something is being printed)"}, {"owner": {"reputation": 21, "user_id": 7458825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/512eda53ca3c9b623c4f9d43fc66e225?s=128&d=identicon&r=PG&f=1", "display_name": "NaHCO3", "link": "https://stackoverflow.com/users/7458825/nahco3"}, "edited": false, "score": 0, "creation_date": 1504719036, "post_id": 46081097, "comment_id": 79123964, "body": "Not visible characters. . .  I`ll double check that line. ."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 4, "creation_date": 1504719331, "post_id": 46081097, "comment_id": 79124123, "body": "OT: &quot;<i>the <code>string</code> datatype (<code>char *</code>)</i>&quot; there is no &quot;string&quot; data type in C. <code>char*</code> is a pointer to a variable of data type <code>char</code>."}, {"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 2, "creation_date": 1504719401, "post_id": 46081097, "comment_id": 79124154, "body": "Looks like you just want something like <code>&#39;a&#39; + ((plaintext[i] + keyword[(count % keywordLength)]) % 26)</code> to bring it back into the <code>&#39;a&#39;</code> to <code>&#39;z&#39;</code> range."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 7, "creation_date": 1504719416, "post_id": 46081097, "comment_id": 79124163, "body": "<code>char*</code> is not &quot;the <code>string</code> datatype&quot;. In fact there is no <code>string</code> data type in C. A <i>string</i> is by definition &quot;a contiguous sequence of characters terminated by and including the first null character.&quot; A <code>char*</code> may or may not be a <i>pointer to a string</i>. See <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf\" rel=\"nofollow noreferrer\">N1570</a> 7.1.1, paragraph 1."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1504721179, "post_id": 46081097, "comment_id": 79125199, "body": "I&#39;m pretty sure this question should be tagged with <a href=\"https://stackoverflow.com/questions/tagged/cs50\">cs50</a> because one of the sins CS50 commits is using <code>typedef char *string;</code> in its header <code>&lt;cs50.h&gt;</code>, and this looks like Vigenere Cipher work, which is the topic of one of the PSets in CS50.  It is mildly debatable whether <a href=\"https://stackoverflow.com/questions/tagged/vigenere\">vigenere</a> should be added; I favour not doing so at the moment."}, {"owner": {"reputation": 21, "user_id": 7458825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/512eda53ca3c9b623c4f9d43fc66e225?s=128&d=identicon&r=PG&f=1", "display_name": "NaHCO3", "link": "https://stackoverflow.com/users/7458825/nahco3"}, "edited": false, "score": 0, "creation_date": 1504728002, "post_id": 46081097, "comment_id": 79128738, "body": "Yeah it is. I wanted to lean CS so I`m using Wayback machine to look at old CS50 stuff."}], "answers": [{"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 2, "last_activity_date": 1504721590, "creation_date": 1504721590, "answer_id": 46081824, "question_id": 46081097, "link": "https://stackoverflow.com/questions/46081097/c-not-implicitly-converting-int-to-char/46081824#46081824", "title": "C not implicitly converting int to char", "body": "<p>Code is printing control characters with:</p>\n\n<pre><code>printf(\"%c\", (plaintext[i] + keyword[(count % keywordLength)]) % 26);\n</code></pre>\n\n<p>Code relies on <code>printf(\"%c\", 0);</code> printing a letter, when it certainly prints a control character - which may not be visible.</p>\n\n<p>Subtle note: Code is relying on <code>plaintext[i], keyword[]</code> to only contain non-negative values.  Should the sum of <code>plaintext[i] + keyword[(count % keywordLength)]</code> be less than 0, that <code>sum % 26</code> will also be negative.</p>\n\n<p>To print an ASCII value in the [A-Z], add <code>'A'</code> or  <code>'a'</code> <a href=\"https://stackoverflow.com/questions/46081097/c-not-implicitly-converting-int-to-char/46081824#comment79124154_46081097\">@lurker</a>.</p>\n\n<pre><code>int sum = plaintext[i] + keyword[(count % keywordLength)];\nprintf(\"%c\", (sum % 26) + 'A');\n</code></pre>\n\n<p>To pedantically handle negative <code>sum</code> and to be highly portable:</p>\n\n<pre><code>int sum = plaintext[i] + keyword[(count % keywordLength)];\n// mod math, even for negative values\nsum = ((sum % 26) + 26) % 26;\n// Print letter, even when encoding is not ASCII\nprintf(\"%c\", \"ABCDEFGHIJKLMNOPQRSTUVWXYZ\"[sum]);\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 7458825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/512eda53ca3c9b623c4f9d43fc66e225?s=128&d=identicon&r=PG&f=1", "display_name": "NaHCO3", "link": "https://stackoverflow.com/users/7458825/nahco3"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 133, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1504721590, "creation_date": 1504718720, "last_edit_date": 1504719398, "question_id": 46081097, "link": "https://stackoverflow.com/questions/46081097/c-not-implicitly-converting-int-to-char", "title": "C not implicitly converting int to char", "body": "<pre><code>printf(\"%c\", (plaintext[i] + keyword[(count % keywordLength)]) % 26;);\n</code></pre>\n\n<p>Where <code>plaintext</code> and <code>keyword</code> are of the <code>string</code> datatype (<code>char *</code>), <code>count</code> is an int, and <code>keywordLength</code> is the returned value of <code>strlen(keyword)</code>. When I use the integer format specifier, the integers print. However, I want it to print as letters, but it prints nothing when I use the character format specifier. I`m not sure why.</p>\n\n<p>For my example, the following are true:</p>\n\n<pre><code>char * plaintext = \"hello\";\nchar * keyword = \"abc\";\n</code></pre>\n"}, {"tags": ["c", "strcmp", "strncmp"], "comments": [{"owner": {"reputation": 6254, "user_id": 2261424, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a0beda634f65f29aace865be9504e5e6?s=128&d=identicon&r=PG", "display_name": "AntonH", "link": "https://stackoverflow.com/users/2261424/antonh"}, "edited": false, "score": 4, "creation_date": 1504716089, "post_id": 46080417, "comment_id": 79122323, "body": "<code>strcmp</code> compares the whole string, so it will only return true if the string you&#39;re passing is &quot;/&quot;. You can look at <code>strncmp</code> instead, or compare only one character (<code>if (str[0] == &#39;&#47;&#39;)</code>), instead of a string."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "reply_to_user": {"reputation": 6254, "user_id": 2261424, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a0beda634f65f29aace865be9504e5e6?s=128&d=identicon&r=PG", "display_name": "AntonH", "link": "https://stackoverflow.com/users/2261424/antonh"}, "edited": false, "score": 0, "creation_date": 1504716324, "post_id": 46080417, "comment_id": 79122460, "body": "@AntonH: Why not place this as an answer?"}, {"owner": {"reputation": 6254, "user_id": 2261424, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a0beda634f65f29aace865be9504e5e6?s=128&d=identicon&r=PG", "display_name": "AntonH", "link": "https://stackoverflow.com/users/2261424/antonh"}, "reply_to_user": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1504716405, "post_id": 46080417, "comment_id": 79122517, "body": "@alk I was only going to comment why it wasn&#39;t working, but edited a solution in after. Put it as an answer now ..."}, {"owner": {"reputation": 146, "user_id": 6322434, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a7b25644eb273fcb960a37cb7f20b5ce?s=128&d=identicon&r=PG&f=1", "display_name": "CodySig", "link": "https://stackoverflow.com/users/6322434/codysig"}, "edited": false, "score": 0, "creation_date": 1504717166, "post_id": 46080417, "comment_id": 79122934, "body": "Ah wow ok thank you. I had tried this as well but I was using &quot;/&quot; instead of &#39;/&#39;. Thank you. Not sure why when I use &quot;/&quot; it tries to compare str[0] as a pointer and &quot;/&quot; as an int?"}], "answers": [{"comments": [{"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 2, "creation_date": 1504716485, "post_id": 46080491, "comment_id": 79122572, "body": "You might want to use <code>const char * str</code>."}, {"owner": {"reputation": 12213, "user_id": 671703, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/96ac349a9c65277e304401ea92a62ff4?s=128&d=identicon&r=PG", "display_name": "pat", "link": "https://stackoverflow.com/users/671703/pat"}, "edited": false, "score": 0, "creation_date": 1504716680, "post_id": 46080491, "comment_id": 79122667, "body": "Don&#39;t know what OS/shell you&#39;re using, but <code>cd &#47;..&#47;</code> leaves me in the root directory, not in the parent of the cwd."}], "tags": [], "owner": {"reputation": 1329, "user_id": 4341902, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/GA0Ju.jpg?s=128&g=1", "display_name": "Billy Ferguson", "link": "https://stackoverflow.com/users/4341902/billy-ferguson"}, "is_accepted": true, "score": 6, "last_activity_date": 1504716749, "last_edit_date": 1504716749, "creation_date": 1504716316, "answer_id": 46080491, "question_id": 46080417, "link": "https://stackoverflow.com/questions/46080417/checking-the-first-letter-of-a-string-in-c/46080491#46080491", "title": "Checking the first letter of a string in c", "body": "<p>Don't have access to a compiler, but I think this will work because C-style strings are just arrays with a termination character:</p>\n\n<pre><code>int isAbsolute(const char *str){\n    return (str[0] == '/');\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 12213, "user_id": 671703, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/96ac349a9c65277e304401ea92a62ff4?s=128&d=identicon&r=PG", "display_name": "pat", "link": "https://stackoverflow.com/users/671703/pat"}, "is_accepted": false, "score": 3, "last_activity_date": 1504716454, "creation_date": 1504716454, "answer_id": 46080525, "question_id": 46080417, "link": "https://stackoverflow.com/questions/46080417/checking-the-first-letter-of-a-string-in-c/46080525#46080525", "title": "Checking the first letter of a string in c", "body": "<p>As was pointed out, <code>strcmp</code> only matches if the strings being compared are of the same length.</p>\n\n<p>To compare a single character at the front of the string, you can just do:</p>\n\n<pre><code>int isAbsolute(const char *str) {\n  return (str[0] == '/');\n}\n</code></pre>\n\n<p>If the prefix you are looking for is longer than one character, then <a href=\"https://stackoverflow.com/questions/4770985/how-to-check-if-a-string-starts-with-another-string-in-c\">this</a> might help.  I like Fred Foo's answer better than the one that got accepted (as did a majority of voters).</p>\n"}, {"tags": [], "owner": {"reputation": 6254, "user_id": 2261424, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a0beda634f65f29aace865be9504e5e6?s=128&d=identicon&r=PG", "display_name": "AntonH", "link": "https://stackoverflow.com/users/2261424/antonh"}, "is_accepted": false, "score": 2, "last_activity_date": 1505160748, "last_edit_date": 1505160748, "creation_date": 1504716496, "answer_id": 46080535, "question_id": 46080417, "link": "https://stackoverflow.com/questions/46080417/checking-the-first-letter-of-a-string-in-c/46080535#46080535", "title": "Checking the first letter of a string in c", "body": "<p><code>strcmp</code> compares the whole string, so your function will only return <code>true</code> if the string you're passing is \"/\".</p>\n\n<p>You can look at strncmp instead:</p>\n\n<pre><code>if(strncmp(str,\"/\", 1)) ...\n</code></pre>\n\n<p>or compare only one character:</p>\n\n<pre><code>(if (str[0] == '/')) ...\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1936, "user_id": 342544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e4b36cb0cd601592a4679a0f24c9477?s=128&d=identicon&r=PG", "display_name": "Henno Brandsma", "link": "https://stackoverflow.com/users/342544/henno-brandsma"}, "is_accepted": false, "score": 1, "last_activity_date": 1504757703, "last_edit_date": 1504757703, "creation_date": 1504720891, "answer_id": 46081640, "question_id": 46080417, "link": "https://stackoverflow.com/questions/46080417/checking-the-first-letter-of-a-string-in-c/46081640#46081640", "title": "Checking the first letter of a string in c", "body": "<p>Similarly to <code>strncmp</code> you can use <code>memcmp</code> which has the number of bytes to compare as an argument:</p>\n\n<pre><code>int isAbsolute(const char *str){\n    if (0 == memcmp(str, \"/\", 1){\n         return 1;\n    } else {\n         return 0;\n    }\n}\n</code></pre>\n\n<p>Don't forget that return value $0$ means equality. In your code you return 0 in that case which is probably not as you intended. </p>\n"}, {"tags": [], "owner": {"reputation": 39, "user_id": 8569331, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/b01a79900add2548de36163b52ec2c8f?s=128&d=identicon&r=PG&f=1", "display_name": "rohit", "link": "https://stackoverflow.com/users/8569331/rohit"}, "is_accepted": false, "score": 0, "last_activity_date": 1504726395, "creation_date": 1504726395, "answer_id": 46083035, "question_id": 46080417, "link": "https://stackoverflow.com/questions/46080417/checking-the-first-letter-of-a-string-in-c/46083035#46083035", "title": "Checking the first letter of a string in c", "body": "<p>Strcmp return value is zero on success case ,that's why it is not going to true</p>\n"}], "owner": {"reputation": 146, "user_id": 6322434, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a7b25644eb273fcb960a37cb7f20b5ce?s=128&d=identicon&r=PG&f=1", "display_name": "CodySig", "link": "https://stackoverflow.com/users/6322434/codysig"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6158, "favorite_count": 0, "accepted_answer_id": 46080491, "answer_count": 5, "score": 2, "last_activity_date": 1505160748, "creation_date": 1504716027, "question_id": 46080417, "link": "https://stackoverflow.com/questions/46080417/checking-the-first-letter-of-a-string-in-c", "title": "Checking the first letter of a string in c", "body": "<p>I am writing a very simple function in C to check if a string is an absolute path or relative path. No matter what I try it is always returning false.</p>\n\n<p>Here is what I have tried:</p>\n\n<pre><code>int isAbsolute(char *str){\n    if(strcmp(str,\"/\")){\n        return 1;\n    }\n    return 0;\n}\n</code></pre>\n\n<p>and I call it like:</p>\n\n<pre><code>printf(\"%d\\n\", isAbsolute(\"/\"));\n</code></pre>\n\n<p>which is returning false every time. Clearly I am missing something obvious but I haven't been able to figure it out...</p>\n"}, {"tags": ["c", "gcc", "fortran", "gfortran", "compiler-options"], "answers": [{"comments": [{"owner": {"reputation": 551, "user_id": 2718450, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YrBcW.png?s=128&g=1", "display_name": "Kevin Powell", "link": "https://stackoverflow.com/users/2718450/kevin-powell"}, "edited": false, "score": 0, "creation_date": 1504791382, "post_id": 46082635, "comment_id": 79157489, "body": "Sorry for the confusion, by <code>gcc</code> I really mean GCC (questions already updated). It is great that the compiler will give warning if a wrong flag option is used. However, for those options that do not complain, some does not work !!! For example, both <code>-fsanitize=bounds</code> and <code>-fsanitize=integer-divide-by-zero</code> do not work for <code>gfortran</code>. So I guess one can still use non-language-specific flag options from GCC when invoking, say <code>gfortran</code>, compiler, but should not rely on those flag options. Only those compiler options documented for a specific compiler will guarantee to work."}, {"owner": {"reputation": 32261, "user_id": 75652, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/303ee8d24a8776dcf67b30c1d4e8b064?s=128&d=identicon&r=PG", "display_name": "janneb", "link": "https://stackoverflow.com/users/75652/janneb"}, "edited": false, "score": 2, "creation_date": 1504807844, "post_id": 46082635, "comment_id": 79168096, "body": "The options mentioned in the GFortran manual are implemented in the GFortran frontend and are thus specific for Fortran. The GCC manual contains options that are specific to C, C++, options that are generic, and options that are valid for a specific target (backend) only. Some of these options may work perfectly fine with GFortran, others might not."}], "tags": [], "owner": {"reputation": 49888, "user_id": 721644, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/KSRQT.jpg?s=128&g=1", "display_name": "Vladimir F", "link": "https://stackoverflow.com/users/721644/vladimir-f"}, "is_accepted": true, "score": 5, "last_activity_date": 1504724801, "creation_date": 1504724801, "answer_id": 46082635, "question_id": 46080068, "link": "https://stackoverflow.com/questions/46080068/what-gcc-compiler-options-can-i-use-for-gfortran/46082635#46082635", "title": "what gcc compiler options can I use for gfortran", "body": "<p>There is the GCC - <a href=\"https://gcc.gnu.org/\" rel=\"noreferrer\">GNU Compiler Collection</a>. It shares the common backend and middleend and has frontends for different languages. For example frontends for C, C++ and Fortran which are usually invoked by commands <code>gcc</code>, <code>g++</code> and <code>gfortran</code>.</p>\n\n<p>It is actually more complicated, you can call <code>gcc</code> on a Fortran source and <code>gfortran</code> on a C source and it will work almost the same with the exceptions of libraries being linked (there are some other fine points). The appropriate frontend will be called based on the file extension or the language requested.</p>\n\n<p>You can look almost all GCC (not just <code>gcc</code>) flags for all of the mentioned frontends. There are certain flags which are language specific. Normally you will get a warning like </p>\n\n<pre><code>gfortran -fcheck=all source.c\ncc1: warning: command line option \u2018-fcheck=all\u2019 is valid for Fortran but not for C\n</code></pre>\n\n<p>but the file will compile fine, the option is just ignored and you will get a warning about that. Notice it is a C file and it is compiled by the <code>gfortran</code> command just fine.</p>\n\n<p>The sanitization options are AFAIK not that language specific and work for multiple languages implemented in GCC, maybe with some exceptions for some obviously language specific checks. Especially <code>-fsanitize=signed-integer-overflow</code> which you ask about works perfectly fine for both C and C++. Signed integer overwlow is undefined behaviour in C and C++ and it is not allowed by the Fortran standard (which effectively means the same, Fortran just uses different words).</p>\n"}, {"comments": [{"owner": {"reputation": 551, "user_id": 2718450, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YrBcW.png?s=128&g=1", "display_name": "Kevin Powell", "link": "https://stackoverflow.com/users/2718450/kevin-powell"}, "edited": false, "score": 0, "creation_date": 1504791622, "post_id": 46084625, "comment_id": 79157676, "body": "Thanks for the in-depth explanation! Well, the bad thing is that when invoking a specific language compiler ,  <code>gfortran</code> for example, using certain GCC flag options, the compiler does not give warning and the flag options do NOT work."}], "tags": [], "owner": {"reputation": 10781, "user_id": 375147, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/514f1ad54850fe2533132fb56fe87536?s=128&d=identicon&r=PG", "display_name": "Norman Gray", "link": "https://stackoverflow.com/users/375147/norman-gray"}, "is_accepted": false, "score": 3, "last_activity_date": 1504875629, "last_edit_date": 1504875629, "creation_date": 1504733424, "answer_id": 46084625, "question_id": 46080068, "link": "https://stackoverflow.com/questions/46080068/what-gcc-compiler-options-can-i-use-for-gfortran/46084625#46084625", "title": "what gcc compiler options can I use for gfortran", "body": "<p>This isn't a terribly precise answer to your question, but an aha! moment, when learning about compilers, is learning that gcc (the GNU Compiler <em>Collection</em>), like llvm, is an example of a <a href=\"https://en.wikipedia.org/wiki/Compiler#Three-stage_compiler_structure\" rel=\"nofollow noreferrer\">three-stage compiler</a>.</p>\n\n<ul>\n<li>The \u2018front end\u2019 parses the syntax of whichever language you're interested, and spits out an Abstract Syntax Tree (AST), which represents your program in a language-independent way.</li>\n<li>Then the \u2018middle end\u2019 (terrible name, but \u2018the clever bit\u2019) reorganises that AST into another AST which is semantically equivalent but easier to turn into machine code.</li>\n<li>Then the \u2018back end\u2019 turns that reorganised AST into assembler for one-or-other processor, possibly doing platform-specific micro-optimisations along the way.</li>\n</ul>\n\n<p>That's why the (huge number of) gcc/llvm options are unexpectedly common to (apparently wildly) different languages.  A few of the options are specific to C, or Fortran, or Objective-C, or whatever, but the majority of them (probably) are concerned with the middle and last bits, and so are common to all of the languages that gcc/llvm supports.</p>\n\n<p>Thus the various options are specific to stage 1, 2 or 3, but may not be conveniently labelled as such; with this in mind, however, you might reasonably intuit what is and isn't relevant to the particular language you're interested in.</p>\n\n<hr>\n\n<p>(It's for this sort of reason that I will dogmatically claim that CC++FortranJavaPerlPython is essentially a single language, with only trivial syntactical and library minutiae to distinguish between dialects).</p>\n"}], "owner": {"reputation": 551, "user_id": 2718450, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YrBcW.png?s=128&g=1", "display_name": "Kevin Powell", "link": "https://stackoverflow.com/users/2718450/kevin-powell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 645, "favorite_count": 1, "accepted_answer_id": 46082635, "answer_count": 2, "score": 3, "last_activity_date": 1504875629, "creation_date": 1504714769, "last_edit_date": 1504731251, "question_id": 46080068, "link": "https://stackoverflow.com/questions/46080068/what-gcc-compiler-options-can-i-use-for-gfortran", "title": "what gcc compiler options can I use for gfortran", "body": "<p>I studied <a href=\"https://gcc.gnu.org/onlinedocs/gcc-5.2.0/gfortran/Option-Summary.html#Option-Summary\" rel=\"nofollow noreferrer\">Option Summary for <code>gfortran</code></a> but found no compiler option to detect integer overflow. Then I found the GCC (GNU Compiler Collection) flag option <code>-fsanitize=signed-integer-overflow</code> <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Instrumentation-Options.html#Instrumentation-Options\" rel=\"nofollow noreferrer\">here</a> and used it when invoking <code>gfortran</code>. It works--integer overflow can be detected at run time!</p>\n\n<p>So what does <code>-fsanitize=signed-integer-overflow</code> do here? Just adding to the machine code generated by <code>gfortran</code> some machine-level pieces that check integer overflow?</p>\n\n<p>What is the relation between  <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Option-Summary.html#Option-Summary\" rel=\"nofollow noreferrer\">GCC (GNU Compiler Collection) flag options</a> and <a href=\"https://gcc.gnu.org/onlinedocs/gcc-5.2.0/gfortran/Option-Summary.html#Option-Summary\" rel=\"nofollow noreferrer\">gfortran compiler options</a>  ? What gcc compiler options can I use for <code>gfortran, g++</code> etc ?</p>\n"}, {"tags": ["c", "algorithm", "performance"], "comments": [{"owner": {"reputation": 1015, "user_id": 7691497, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-46wzsjmiSDg/AAAAAAAAAAI/AAAAAAAAAAk/qjgRQMlHINA/photo.jpg?sz=128", "display_name": "Ben Steffan", "link": "https://stackoverflow.com/users/7691497/ben-steffan"}, "edited": false, "score": 1, "creation_date": 1504713320, "post_id": 46079575, "comment_id": 79120615, "body": "Why do you think it is faster? Did you measure? If yes, please provide your measurements. Also, please consider looking at the assembly output."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1504713478, "post_id": 46079575, "comment_id": 79120701, "body": "Try looking at the generated assembly. Also, don&#39;t discount the optimization abilities of the compiler, modern top-compilers are very good at optimization, using <code>if</code> might be more effective with optimizations."}, {"owner": {"reputation": 786, "user_id": 5923666, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pfpru.jpg?s=128&g=1", "display_name": "Raz Luvaton", "link": "https://stackoverflow.com/users/5923666/raz-luvaton"}, "reply_to_user": {"reputation": 1015, "user_id": 7691497, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-46wzsjmiSDg/AAAAAAAAAAI/AAAAAAAAAAk/qjgRQMlHINA/photo.jpg?sz=128", "display_name": "Ben Steffan", "link": "https://stackoverflow.com/users/7691497/ben-steffan"}, "edited": false, "score": 0, "creation_date": 1504713501, "post_id": 46079575, "comment_id": 79120720, "body": "@BenSteffan Where Can I Find The Assembly Output?"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1504713660, "post_id": 46079575, "comment_id": 79120839, "body": "Don&#39;t Write Sentences With Initial Caps As It&#39;s Cumbersome To Read."}, {"owner": {"reputation": 35869, "user_id": 7512, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d064a7aca29011d3246302b27c41f4d9?s=128&d=identicon&r=PG", "display_name": "slim", "link": "https://stackoverflow.com/users/7512/slim"}, "edited": false, "score": 6, "creation_date": 1504713722, "post_id": 46079575, "comment_id": 79120870, "body": "I&#39;d be astonished if anything was significantly faster than <code>(a &gt;= b) ? a : b</code>, and I&#39;d be astonished if the equivalent written with <code>if</code> was slower."}, {"owner": {"reputation": 2503, "user_id": 3700563, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1f0a11869957330c6018b71ec9310138?s=128&d=identicon&r=PG&f=1", "display_name": "JJF", "link": "https://stackoverflow.com/users/3700563/jjf"}, "edited": false, "score": 0, "creation_date": 1504714132, "post_id": 46079575, "comment_id": 79121125, "body": "Why would anyone teach that conditionals ruin efficiency? What is the value in that?  I guess it follows that you shouldn&#39;t ever write any code because it&#39;s always going to run slower than no code at all."}, {"owner": {"reputation": 35869, "user_id": 7512, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d064a7aca29011d3246302b27c41f4d9?s=128&d=identicon&r=PG", "display_name": "slim", "link": "https://stackoverflow.com/users/7512/slim"}, "edited": false, "score": 2, "creation_date": 1504714176, "post_id": 46079575, "comment_id": 79121146, "body": "Either OP has misunderstood the teacher, or the teacher is not to be trusted."}, {"owner": {"reputation": 3203, "user_id": 2763915, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b53d3b3f8b36383de69ab29d9633251?s=128&d=identicon&r=PG&f=1", "display_name": "atru", "link": "https://stackoverflow.com/users/2763915/atru"}, "edited": false, "score": 0, "creation_date": 1504714203, "post_id": 46079575, "comment_id": 79121165, "body": "It&#39;s possible that on the processor level (num1-num2) is evaluated only once and stored in a single register, basically reused for the second part of <code>big = (num1 - num2) - ...</code>. On the other hand this should also be true for <code>num1</code> which i.e. their behavior could be the same. Maybe measure the time when using something else for the first part of the first expression? Like <code>big = (num1 + num2) - ...</code>."}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 3, "creation_date": 1504714245, "post_id": 46079575, "comment_id": 79121197, "body": "the compiler is smarter than you thought. Just use <code>max = a &gt; b ? a : b</code> and it&#39;ll use branchless code if necessary. And there may be more efficient non-branch solutions like <a href=\"https://graphics.stanford.edu/~seander/bithacks.html#IntegerMinOrMax\" rel=\"nofollow noreferrer\">this</a>"}, {"owner": {"reputation": 3203, "user_id": 2763915, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b53d3b3f8b36383de69ab29d9633251?s=128&d=identicon&r=PG&f=1", "display_name": "atru", "link": "https://stackoverflow.com/users/2763915/atru"}, "edited": false, "score": 0, "creation_date": 1504714364, "post_id": 46079575, "comment_id": 79121269, "body": "Also, <code>if</code>s in general affect performance. They branch the program execution and cause stalls in pipelining. But yes, they&#39;re also heavily optimized on both the compiler and instruction level. So in principle a simple <code>if</code> should be like there was no <code>if</code> at all."}, {"owner": {"reputation": 35869, "user_id": 7512, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d064a7aca29011d3246302b27c41f4d9?s=128&d=identicon&r=PG", "display_name": "slim", "link": "https://stackoverflow.com/users/7512/slim"}, "reply_to_user": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1504714382, "post_id": 46079575, "comment_id": 79121286, "body": "@L\u01b0uV\u0129nhPh&#250;c &quot;On some <b>rare machines</b> where branching is very expensive and no condition move instructions exist, the above expression might be faster than the obvious approach&quot;"}, {"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 2, "creation_date": 1504716600, "post_id": 46079575, "comment_id": 79122627, "body": "<code>long num1=555527778658567767676735;</code>?? Are you running on a 128-bit CPU? That&#39;s bigger than 2^63-1."}, {"owner": {"reputation": 786, "user_id": 5923666, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pfpru.jpg?s=128&g=1", "display_name": "Raz Luvaton", "link": "https://stackoverflow.com/users/5923666/raz-luvaton"}, "reply_to_user": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 0, "creation_date": 1504716659, "post_id": 46079575, "comment_id": 79122658, "body": "I want to test with the worst case @lurker"}, {"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 1, "creation_date": 1504716708, "post_id": 46079575, "comment_id": 79122686, "body": "Sure, but that&#39;s not even a valid <code>long</code> value on a 64-bit machine. It doesn&#39;t fit. How did you come up with <code>555527778658567767676735</code>? That&#39;s something like 79 bits."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1504718456, "post_id": 46079575, "comment_id": 79123672, "body": "You typically generate the assembly code with the <code>-S</code> option to the compiler and look for the assembler output from compiling <code>source.c</code> in the file <code>source.s</code> (unless you use <code>-o somename</code>, in which case look in <code>somename</code>)."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1504720180, "post_id": 46079575, "comment_id": 79124620, "body": "Does the first calculation reliably produce the bigger number?  In my testing, I got <code>0</code> when <code>num1</code> is bigger than <code>num2</code> and negative numbers when <code>num1</code> is smaller than <code>num2</code>.  I&#39;m not clear if this is what is meant by the shouted comment &quot;I know this is not solving the problem&quot;."}, {"owner": {"reputation": 786, "user_id": 5923666, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pfpru.jpg?s=128&g=1", "display_name": "Raz Luvaton", "link": "https://stackoverflow.com/users/5923666/raz-luvaton"}, "edited": false, "score": 0, "creation_date": 1504720915, "post_id": 46079575, "comment_id": 79125057, "body": "I mean that ignore what the code does and focus on why it&#39;s slower when the second line is less thing to do"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1504725352, "post_id": 46079575, "comment_id": 79127369, "body": "@RazLuvaton <code>num1 - num2</code> may overflow and signed integer overflow is <i>undefined behavior</i> (UB).  Do you care if the the result is wrong for some combinations of <code>long</code>?  What is the greatest and least value <code>long</code> may have on you platform?"}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 1, "creation_date": 1504750739, "post_id": 46079575, "comment_id": 79135766, "body": "that random number is not the worst case, it&#39;s the worst test ever"}, {"owner": {"reputation": 786, "user_id": 5923666, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pfpru.jpg?s=128&g=1", "display_name": "Raz Luvaton", "link": "https://stackoverflow.com/users/5923666/raz-luvaton"}, "reply_to_user": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1504777280, "post_id": 46079575, "comment_id": 79147574, "body": "Why? @L\u01b0uV\u0129nhPh&#250;c"}], "answers": [{"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1504725208, "post_id": 46079979, "comment_id": 79127317, "body": "<code>num1 - num2</code> may overflow and signed integer overflow is <i>undefined behavior</i> (UB).  Perhaps OP does not care if a fast solution only works for select <code>long</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user3458"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1504725628, "post_id": 46079979, "comment_id": 79127529, "body": "@chux OP says that he knows that the code he wrote does not do the right thing. He is just puzzled why the seemingly more complex code is faster."}, {"owner": {"reputation": 1101, "user_id": 7870957, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/jG6LK.jpg?s=128&g=1", "display_name": "Shivansh Jagga", "link": "https://stackoverflow.com/users/7870957/shivansh-jagga"}, "edited": false, "score": 0, "creation_date": 1504896441, "post_id": 46079979, "comment_id": 79208255, "body": "The compiler does not do what you said it does. It can&#39;t make such  decisions. It infact boils down to how compiler does optimization and then number of calculations to print final result."}, {"owner": {"user_type": "does_not_exist", "display_name": "user3458"}, "edited": false, "score": 0, "creation_date": 1504907190, "post_id": 46079979, "comment_id": 79212574, "body": "Well, the computer certainly simplified the expression as part of the optimization, even if not exactly the way I suggested."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user3458"}, "is_accepted": false, "score": 3, "last_activity_date": 1504907470, "last_edit_date": 1504907470, "creation_date": 1504714476, "answer_id": 46079979, "question_id": 46079575, "link": "https://stackoverflow.com/questions/46079575/why-this-is-slower-find-max-between-2-numbers-without-if/46079979#46079979", "title": "Why This is Slower - Find Max Between 2 Numbers without if", "body": "<p>Here is my guess:</p>\n\n<p>The compiler simplifies the expression:</p>\n\n<pre><code>(num1 - num2) - (num1 &gt; num2) * (num1 - num2)\n\n(1 - (num1 &gt; num2)) * (num1 - num2)\n</code></pre>\n\n<p>finally</p>\n\n<pre><code>(num1 &lt;= num2) * (num1 - num2)\n</code></pre>\n\n<p>Which would indeed be faster than </p>\n\n<pre><code>num1 - (num2 &gt; num1) * (num1 - num2)\n</code></pre>\n\n<p>Thanks to @SirGuy, here is the assembly from clang:</p>\n\n<pre><code>max2(long, long):                              # @max2(long, long)\n        xor     eax, eax\n        sub     rdi, rsi\n        cmovg   rax, rdi\n        sub     rdi, rax\n        mov     rax, rdi\n        ret\n</code></pre>\n\n<p>This seems to mean: take diff of num1 and num2, keep it in rdi. If it's > 0, put diff into rax, else leave rax as 0. The return value is rdi - rax, which would be 0 or the diff, depending on what was moved to rax. So, pretty close to <code>(num1 &lt;= num2) * (num1 - num2)</code> - just done with subtraction rather than multiplication :)</p>\n"}, {"tags": [], "owner": {"reputation": 1101, "user_id": 7870957, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/jG6LK.jpg?s=128&g=1", "display_name": "Shivansh Jagga", "link": "https://stackoverflow.com/users/7870957/shivansh-jagga"}, "is_accepted": true, "score": 1, "last_activity_date": 1504814974, "last_edit_date": 1504814974, "creation_date": 1504812822, "answer_id": 46103842, "question_id": 46079575, "link": "https://stackoverflow.com/questions/46079575/why-this-is-slower-find-max-between-2-numbers-without-if/46103842#46103842", "title": "Why This is Slower - Find Max Between 2 Numbers without if", "body": "<p>It is due to the compiler. The process happens in stage 2.\nBasically compiler for optimization sets <code>a=num1-num2</code> and stores it in its memory.\nSo now it has calculated a, only once and simply puts it in the statement.</p>\n\n<pre><code>big = a - (n1&gt;n2)*a;\n</code></pre>\n\n<p>This is either <code>big = a</code> or <code>big = 0</code>, performs 3 calculations in total . One for num1-num2, other for n1>n2 and third for (a-1*a) or (a - 0*a)</p>\n\n<p>The other one:</p>\n\n<pre><code>big = n1 - (n1&gt;n2)*(n1-n2)\n</code></pre>\n\n<p>has the following :</p>\n\n<ol>\n<li>n1>n2 =a</li>\n<li>n1 - n2 =b</li>\n<li>a*b =c</li>\n<li>n1 - c</li>\n</ol>\n\n<p>The previous one had 3 calculations and this one has 4.\nThe time will be better in the 1st one especially since large numbers are being dealt with, otherwise the time difference should be negligible.\nAlso, note if you run the time tests again and again even for one of the two calculations mentioned by you, you'll see variations in the time taken. So please note that your observation of time difference is not completely absolute, however the first one will be faster than the second one nonetheless.</p>\n\n<p>Edit 1: Also, note in first statement <code>if (n1&gt;n2)</code> is false,i.e, 0, then it simply becomes <code>big = a - 0*a</code> ,here, compiler doesn't perform multiplication also, since it sees a 0 in the statement and muliplication operand. After which doesn't it doesn't perform the subtraction also and is simply written in memory as <code>big=a</code> which would give a faster result as well\n<code>if (n1&gt;n2)</code> is true , the same holds as it becomes, <code>big=a-1*a</code> where the compiler sees the <code>1</code> and eliminates it in the multiplicand operand and simply writes then doesn't need to perform multiplication and simply writes it as <code>a -a</code>. The <strong>main</strong> portion , when it does <code>a-a</code> it gets converted into bits first then finally after subtraction, gives , 00000, now these bits do no be converted back to the decimal 0 again by the compiler and can simply be written as 0. <em>However</em> for n1- ()*(n1-n2)` , this number will turn out to be something negative, basically after getting the final result in bits, conversion to decimal will also take place.</p>\n"}], "owner": {"reputation": 786, "user_id": 5923666, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pfpru.jpg?s=128&g=1", "display_name": "Raz Luvaton", "link": "https://stackoverflow.com/users/5923666/raz-luvaton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 141, "favorite_count": 0, "accepted_answer_id": 46103842, "answer_count": 2, "score": -4, "last_activity_date": 1504907470, "creation_date": 1504713169, "last_edit_date": 1504718710, "question_id": 46079575, "link": "https://stackoverflow.com/questions/46079575/why-this-is-slower-find-max-between-2-numbers-without-if", "title": "Why This is Slower - Find Max Between 2 Numbers without if", "body": "<p>An assignment - find the maximum of two numbers <strong>without <code>if</code></strong> and with the <strong>highest efficiency</strong>. (My instructor says that <code>if</code> ruins  efficiency and makes the program slower.)</p>\n\n<p>So I did this:</p>\n\n<pre><code>long num1=555527778658567767676735; // Random Number\nlong num2=34277745575656835; // Another Random Number\nlong big; // The Biggest Number\n\n// I KNOW THIS IS NOT SOLVING THE PROBLEM\nbig = (num1 - num2) - (num1 &gt; num2) * (num1 - num2); // The Code That Is Faster - 2.791 seconds for 10B Times\n\nbig = num1 - (num2 &gt; num1) * (num1 - num2); // The Slower Line Of Code - 3.069 second for 10B Times\n</code></pre>\n\n<p>My question is why this - <code>big = (num1 - num2) - (num1 &gt; num2) * (num1 - num2);</code> is faster than this - <code>big = num1 - (num2 &gt; num1) * (num1 - num2);</code></p>\n\n<p>When in the second line I don't do this subtracting <code>(num1 - num2)</code> and instead I do this <code>num1</code> only; isn't it supposed to be faster without another \"thing\" to calculate?</p>\n"}, {"tags": ["c", "list"], "comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 2, "creation_date": 1504712980, "post_id": 46079459, "comment_id": 79120387, "body": "<code>c - &#39;0&#39;</code> - whoever told you that was the index to use lied.  you should use simply <code>c</code>. Your current index makes the statement <i>&quot;...where the index number corresponds to the ASCII value...&quot;</i> untrue."}, {"owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "edited": false, "score": 1, "creation_date": 1504713004, "post_id": 46079459, "comment_id": 79120411, "body": "Why is <code>MAXLEN</code> set to 1000?  Why are you subtracting <code>&#39;0&#39;</code> from <code>c</code>?"}, {"owner": {"reputation": 44000, "user_id": 535275, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/Ft2Mw.jpg?s=128&g=1", "display_name": "Scott Hunter", "link": "https://stackoverflow.com/users/535275/scott-hunter"}, "edited": false, "score": 1, "creation_date": 1504713087, "post_id": 46079459, "comment_id": 79120459, "body": "What makes you conclude it isn&#39;t incrementing, rather than incrementing the wrong thing(s)?  What <i>should</i> the output be?"}, {"owner": {"reputation": 4031, "user_id": 7640269, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/szGUJ.png?s=128&g=1", "display_name": "danglingpointer", "link": "https://stackoverflow.com/users/7640269/danglingpointer"}, "edited": false, "score": 0, "creation_date": 1504713585, "post_id": 46079459, "comment_id": 79120789, "body": "Your just setting chartype[1000]=0 in for loop. Instead just initialize with {0} or {&quot;&quot;}.  Your code is not incrementing. What are you doing here c-&#39;0&#39; ? What&#39;s your intention?"}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 1, "creation_date": 1504713781, "post_id": 46079459, "comment_id": 79120905, "body": "&quot;<i>Count how many of each character appears in C</i>&quot; One? ;-)"}, {"owner": {"reputation": 18759, "user_id": 2226988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c6fbec3a71b2e95e4a6e41478deb379?s=128&d=identicon&r=PG", "display_name": "Tom Blodget", "link": "https://stackoverflow.com/users/2226988/tom-blodget"}, "edited": false, "score": 0, "creation_date": 1504714009, "post_id": 46079459, "comment_id": 79121058, "body": "You should be able to use CHAR_MIN and CHAR_MAX to come up with an appropriate range for the array. Be careful to index it considering that <code>char</code> might be negative. You shouldn&#39;t need to depend on <code>char</code> being an ASCII codepoint\u2014it hardly ever is. (Of course, you can require it to be for your program but I&#39;m just saying that&#39;s not common or what users expect.)"}, {"owner": {"reputation": 3, "user_id": 3349325, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac721233e6c152f2edbe354248cb0a46?s=128&d=identicon&r=PG", "display_name": "user146929", "link": "https://stackoverflow.com/users/3349325/user146929"}, "edited": false, "score": 0, "creation_date": 1504720024, "post_id": 46079459, "comment_id": 79124548, "body": "The c-&#39;0&#39; was a misguided, this is commonly used to make a character digit into an int. The reason I think it&#39;s not incrementing is because if I enter 5 unique characters, it prints only a seemingly random one of those."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 18759, "user_id": 2226988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c6fbec3a71b2e95e4a6e41478deb379?s=128&d=identicon&r=PG", "display_name": "Tom Blodget", "link": "https://stackoverflow.com/users/2226988/tom-blodget"}, "edited": false, "score": 1, "creation_date": 1504720711, "post_id": 46079459, "comment_id": 79124939, "body": "@TomBlodget With <code>while((c = getchar()) != EOF){         ++chartype[c - &#39;0&#39;];     }</code>, <code>c</code> is not negative inside the loop.  <code>getchar()</code> returns a value in the range of <code>unsigned char</code> and <code>EOF</code>.  Using <code>UCHAR_MAX+1</code> for the array size makes more sense.  Note that there is no <code>char</code> in the OP&#39;s code."}], "answers": [{"tags": [], "owner": {"reputation": 178, "user_id": 2803947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad6d46f2cf26b0d4e8f8736ed8c933b8?s=128&d=identicon&r=PG&f=1", "display_name": "Alexandre Pinho", "link": "https://stackoverflow.com/users/2803947/alexandre-pinho"}, "is_accepted": false, "score": 0, "last_activity_date": 1504713991, "creation_date": 1504713991, "answer_id": 46079839, "question_id": 46079459, "link": "https://stackoverflow.com/questions/46079459/count-how-many-of-each-character-appears-in-c/46079839#46079839", "title": "Count how many of each character appears in C", "body": "<p>The problem here is that <code>c - '0'</code> inside the square brackets.</p>\n\n<p>When you type 'A', it should increment the integer with index 65, so that when you print the character with the value 65 it gives you 'A'.</p>\n\n<p>Instead, you're incrementing the integer in index position <code>c - '0'</code>, which is <code>c - 48</code>. Here, when you type 'A', it's incrementing integer number 17 (65 - 48), which is some special character.</p>\n\n<p>By putting just <code>++chartype[c];</code>, you increment the correct position in the array and fix the problem.</p>\n\n<p>Two asides:</p>\n\n<ul>\n<li><p><code>c - '0'</code> is only used when your input is a string of digits, and you want to count the number of times '0' in the 0-th position of the array, etc.</p></li>\n<li><p>You don't need to allocate such a big array for simple chars. There are 256 possible values for <code>c</code>, so a <code>MAXLEN</code> of 256 should suffice.</p></li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 3349325, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac721233e6c152f2edbe354248cb0a46?s=128&d=identicon&r=PG", "display_name": "user146929", "link": "https://stackoverflow.com/users/3349325/user146929"}, "edited": false, "score": 0, "creation_date": 1504719633, "post_id": 46079876, "comment_id": 79124293, "body": "Thank you for the reply, problem with not only your code but other&#39;s here is that it only return to be a list of characters, certain numbers,  and spaces, not letters. Is this a compiler issue? I&#39;m using mingw on Windows"}], "tags": [], "owner": {"reputation": 748, "user_id": 7801892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9f87eb8937bf17dd8dee0658a4695d2?s=128&d=identicon&r=PG&f=1", "display_name": "Phil Kiener", "link": "https://stackoverflow.com/users/7801892/phil-kiener"}, "is_accepted": false, "score": 0, "last_activity_date": 1504721045, "last_edit_date": 1504721045, "creation_date": 1504714123, "answer_id": 46079876, "question_id": 46079459, "link": "https://stackoverflow.com/questions/46079459/count-how-many-of-each-character-appears-in-c/46079876#46079876", "title": "Count how many of each character appears in C", "body": "<p>You probably got something mixed up in your code. </p>\n\n<pre><code>int chartype[MAXLEN];\n</code></pre>\n\n<p>You want to store how often a character appears in an array, where each index corresponds to a character. But there are not 1000 characters, only 256.</p>\n\n<pre><code>++chartype[c - '0'];\n</code></pre>\n\n<p>The \"idiom\" <code>c - '0'</code> is often used to quickly get a numeric value from a digit (<code>'9'</code> becomes <code>9</code>); you don't want to do this here.</p>\n\n<p>To actually count how often the characters appear, do as follows:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main()\n{\n    int c, i;\n    int chartype[256] = { 0 }; // maximum value for an unsigned char\n\n    while((c = getchar()) != EOF) {\n        ++chartype[c]; // no need to subtract '0'\n    }\n\n\n    for(i = 0; i &lt; 256; ++i) {\n        if(chartype[i] &gt; 0) {\n            printf(\"%c, %d\\n\", i, chartype[i]);\n        }\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p><code>getchar()</code> returns an <code>unsigned char</code>, casted to an <code>int</code> to accomodate for <code>EOF</code>, so an array of length 256 is enough to capture all characters.</p>\n\n<p><code>int chartype[256] = { 0 };</code> initializes all values in that array to <code>0</code>, so you don't need that first loop.</p>\n\n<p>(Also, <code>chartype</code> is a poor name. <code>char_frequency</code> or something the like would be better in terms of readability.)</p>\n"}, {"tags": [], "owner": {"reputation": 3637, "user_id": 1766548, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/290a3791bcf7b98fd924a9f1593dfef9?s=128&d=identicon&r=PG", "display_name": "John Demetriou", "link": "https://stackoverflow.com/users/1766548/john-demetriou"}, "is_accepted": false, "score": 0, "last_activity_date": 1504714578, "creation_date": 1504714578, "answer_id": 46080007, "question_id": 46079459, "link": "https://stackoverflow.com/questions/46079459/count-how-many-of-each-character-appears-in-c/46080007#46080007", "title": "Count how many of each character appears in C", "body": "<p>The problem here is your index. You could be having lower case letters, upper case letters and digits (ignoring symbols I assume). Since upper case letters start at 65 in ascii, digits at 48 and lower case letters at 97, I would suggest three tables for counting each and utilizing isupper and isdigit methods provided by string.h. if this is a university exercise where string.h is forbidden then I would suggest the following pseudocode</p>\n\n<pre><code>If character larger or equal to a\nRemove 97, increment position in lowercase letters array\nElse if larger or equal to A\nRemove 65, increment position in uppercase letters array\nElse\nRemove 48, increment position in digits array\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 0, "last_activity_date": 1504716809, "last_edit_date": 1504716809, "creation_date": 1504715836, "answer_id": 46080361, "question_id": 46079459, "link": "https://stackoverflow.com/questions/46079459/count-how-many-of-each-character-appears-in-c/46080361#46080361", "title": "Count how many of each character appears in C", "body": "<p><code>++chartype[c - '0'];</code> can easily write below the bound of [0...MAXLEN).   </p>\n\n<p>Example <code>' ' - '0'</code> may be 32 - 48 or -16.  Better to offset based on zero.</p>\n\n<ol>\n<li><p>Make <code>chartype[];</code> big enough to use any <code>unsigned char</code> as an index.  There are <code>UCHAR_MAX + 1</code> possible <code>unsigned char</code>.  <code>fgetc()</code> returns a value in the range of <code>unsigned char</code> or <code>EOF</code>.</p>\n\n<pre><code>#include &lt;limits.h&gt;\n... \n// int chartype[MAXLEN]; // not right sized\nint chartype[UCHAR_MAX + 1];\n</code></pre></li>\n<li><p>Easy enough to <em>initialize</em>  <code>chartype[]</code> elements to zero.</p>\n\n<pre><code>int chartype[UCHAR_MAX + 1] = {0};\n</code></pre></li>\n<li><p>Increment and print based on a zero offset, not the <em>character</em> <code>'0'</code>.</p>\n\n<pre><code>while((c = getchar()) != EOF){\n  // chartype[c - '0']\n  ++chartype[c];\n}\n\nfor (int i = 0; i &lt;= UCHAR_MAX; i++) {\n  if(chartype[i]&gt;0) {\n    printf(\"%c, %d\\n\", i, chartype[i]);\n  } \n}\n</code></pre></li>\n</ol>\n\n<p>Note: Different code needed for rare platforms where the range of <code>unsigned char</code> meets/exceeds the range of <code>int</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1504718271, "post_id": 46080626, "comment_id": 79123553, "body": "<code>&amp;&amp; i!= &#39;\\n&#39;</code> would be more self-explanatory and more portable than <code>&amp;&amp; i!=10</code>"}, {"owner": {"reputation": 3, "user_id": 3349325, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac721233e6c152f2edbe354248cb0a46?s=128&d=identicon&r=PG", "display_name": "user146929", "link": "https://stackoverflow.com/users/3349325/user146929"}, "edited": false, "score": 0, "creation_date": 1504719085, "post_id": 46080626, "comment_id": 79123988, "body": "Is int chartype[256] = { 0 }; a simpler version of int chartype[256] = { 0 };`? And thank you for the response!"}], "tags": [], "owner": {"reputation": 46, "user_id": 7982132, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-SYgMlZFt_iA/AAAAAAAAAAI/AAAAAAAAAzs/zRrEdbT6dTM/photo.jpg?sz=128", "display_name": "Shivang Keshari", "link": "https://stackoverflow.com/users/7982132/shivang-keshari"}, "is_accepted": true, "score": 3, "last_activity_date": 1504981553, "last_edit_date": 1504981553, "creation_date": 1504716865, "answer_id": 46080626, "question_id": 46079459, "link": "https://stackoverflow.com/questions/46079459/count-how-many-of-each-character-appears-in-c/46080626#46080626", "title": "Count how many of each character appears in C", "body": "<p>The problem here is that <code>c - '0'</code> in the second loop.</p>\n\n<p>When you type 'A', you're incrementing the integer in index position c - '0', which is c - 48. So for 'A', it's incrementing integer number 17 (65-48), which is some special character.</p>\n\n<p>By just typing <code>++chartype[c]</code>, you increment the position of the character in the array and fix the problem.</p>\n\n<p>Also getchar() will take the input when you press the Enter key on input console or on encountering end of line in the input file. It will increment the value at index 10 every time Enter key is pressed or end of line is encountered. So simply add a condition in the last loop to avoid printing that. Or you can refer to some other sources to check how getchar() can avoid enter key or end of line.</p>\n\n<p>I have also used the suggestions given by Phil Kiener.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main()\n{\n    int c, i;\n    int chartype[256] = { 0 }; // maximum value for an unsigned char\n\n    while((c = getchar()) != EOF) {\n        ++chartype[c]; // no need to subtract '0'\n    }\n\n    for(i = 0; i &lt; 255; ++i) {\n        if(chartype[i] &gt; 0 &amp;&amp; i!='\\n') { //avoiding printing value present at index 10\n            printf(\"%c, %d\\n\", i, chartype[i]);\n        }\n    }\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 3349325, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac721233e6c152f2edbe354248cb0a46?s=128&d=identicon&r=PG", "display_name": "user146929", "link": "https://stackoverflow.com/users/3349325/user146929"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 46080626, "answer_count": 5, "score": -1, "last_activity_date": 1504981553, "creation_date": 1504712769, "last_edit_date": 1504713099, "question_id": 46079459, "link": "https://stackoverflow.com/questions/46079459/count-how-many-of-each-character-appears-in-c", "title": "Count how many of each character appears in C", "body": "<p>I'm trying to do exercise 1-14 from the C programming language book by Brian Kernighan.</p>\n\n<p>I'm using a list a list where the index number corresponds to the ASCII value, so list[65] should print out the number of times 'A' has appeared in my input.</p>\n\n<p>Unfortunately my program just seems not to increment. Any help would be appreciated!</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#define MAXLEN 1000\n\nint main()\n{\n    int c, i;\n    int chartype[MAXLEN];\n\n    for(i = 0; i &lt; MAXLEN; ++i)\n        chartype[i] = 0;\n\n    while((c = getchar()) != EOF){\n        ++chartype[c - '0'];\n    }\n\n\n    for(i = 0; i &lt; MAXLEN; ++i){\n        if(chartype[i]&gt;0)\n            printf(\"%c, %d\\n\", i, chartype[i]);\n    }\n    return 0;\n}\n</code></pre>\n\n<p>output: 53, ? 56, ?</p>\n"}, {"tags": ["c", "fork"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1504707494, "post_id": 46077441, "comment_id": 79116475, "body": "Your child processes do the same thing as the parent processes, so you get behaviour you don&#39;t intend.  Test the value in <code>new_process</code> and do different things if it is zero (child) or not (parent).  Note that <code>getpid()</code> returns the current process&#39;s PID."}, {"owner": {"reputation": 186, "user_id": 5143144, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f73795e51f93d9a6c5d7feffbf3e8aaf?s=128&d=identicon&r=PG&f=1", "display_name": "Zameer  Haque", "link": "https://stackoverflow.com/users/5143144/zameer-haque"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1504707798, "post_id": 46077441, "comment_id": 79116689, "body": "Yeah I thought about the same thing. Since memory is shared that&#39;s why that structure stores 5 elements for each process and then each process runs the loop 5 times. But how can I get such PID&#39;s without facing this issue and still having only the given no. of processes such that once process is created and I get its pid I can finish its execution. Is there any way to do that? In this case however I would have to figure out how to store the pid since both child and parent process are using different structures. is that possible?"}, {"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 2, "creation_date": 1504707897, "post_id": 46077441, "comment_id": 79116769, "body": "@ZameerHaque memory isn&#39;t shared between processes - they are totally separate."}, {"owner": {"reputation": 186, "user_id": 5143144, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f73795e51f93d9a6c5d7feffbf3e8aaf?s=128&d=identicon&r=PG&f=1", "display_name": "Zameer  Haque", "link": "https://stackoverflow.com/users/5143144/zameer-haque"}, "reply_to_user": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1504708106, "post_id": 46077441, "comment_id": 79116937, "body": "@ChrisTurner Thanks. That&#39;s what I was actually trying to say. So how would I have both processes share that same structure so that only 2 process are created and stored in the structure for no_of_process = 2."}, {"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1504708162, "post_id": 46077441, "comment_id": 79116982, "body": "@ZameerHaque you check the return value of <code>fork</code> as per the many answers below and in the parent process store the PIDs in the structure."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1504708444, "post_id": 46077441, "comment_id": 79117209, "body": "@ZameerHaque: What about the documentation of <code>fork</code> is not clear?"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1504805741, "post_id": 46077441, "comment_id": 79166999, "body": "The function: <code>fork()</code> has three kinds of return values: ==0 means in child process.  &gt;0 means in parent process  &lt;0 means <code>fork()</code> failed.    The code needs to check for all three conditions"}], "answers": [{"comments": [{"owner": {"reputation": 186, "user_id": 5143144, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f73795e51f93d9a6c5d7feffbf3e8aaf?s=128&d=identicon&r=PG&f=1", "display_name": "Zameer  Haque", "link": "https://stackoverflow.com/users/5143144/zameer-haque"}, "edited": false, "score": 0, "creation_date": 1504707988, "post_id": 46077676, "comment_id": 79116849, "body": "In this case the pid remains same for all the processes. Why ? I guess since the last process finished executing already ? How to generate a unique pid each time."}, {"owner": {"reputation": 4073, "user_id": 152, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oXFHS.jpg?s=128&g=1", "display_name": "Jonesinator", "link": "https://stackoverflow.com/users/152/jonesinator"}, "reply_to_user": {"reputation": 186, "user_id": 5143144, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f73795e51f93d9a6c5d7feffbf3e8aaf?s=128&d=identicon&r=PG&f=1", "display_name": "Zameer  Haque", "link": "https://stackoverflow.com/users/5143144/zameer-haque"}, "edited": false, "score": 1, "creation_date": 1504708099, "post_id": 46077676, "comment_id": 79116930, "body": "Running this exact code I get a different pid every time. Did you make sure to update the line from <code>p[i].pid = getpid();</code> to <code>p[i].pid = new_process;</code>?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1504708284, "post_id": 46077676, "comment_id": 79117084, "body": "Using a busy wait works, but calling <code>pause()</code> is often better.  It never returns normally; it only returns after a signal is handled (so with SIGKILL, it will never return), but it doesn&#39;t run and use any CPU resources while it is paused."}, {"owner": {"reputation": 186, "user_id": 5143144, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f73795e51f93d9a6c5d7feffbf3e8aaf?s=128&d=identicon&r=PG&f=1", "display_name": "Zameer  Haque", "link": "https://stackoverflow.com/users/5143144/zameer-haque"}, "edited": false, "score": 0, "creation_date": 1504708355, "post_id": 46077676, "comment_id": 79117132, "body": "oh I see. Thanks. But why is it different that getpid(). getpid is supposed to give the current process id ? Oh. Since process already finished execution so I am using parents process id everytime I use getpid() ?"}, {"owner": {"reputation": 4073, "user_id": 152, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oXFHS.jpg?s=128&g=1", "display_name": "Jonesinator", "link": "https://stackoverflow.com/users/152/jonesinator"}, "edited": false, "score": 1, "creation_date": 1504708544, "post_id": 46077676, "comment_id": 79117283, "body": "In this case the child process never calls <code>getpid();</code> only the parent process calls it, so it will return the same answer every time. The return value of <code>fork()</code> is how the child&#39;s pid is communicated to the parent."}], "tags": [], "owner": {"reputation": 4073, "user_id": 152, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oXFHS.jpg?s=128&g=1", "display_name": "Jonesinator", "link": "https://stackoverflow.com/users/152/jonesinator"}, "is_accepted": true, "score": 3, "last_activity_date": 1504707629, "creation_date": 1504707629, "answer_id": 46077676, "question_id": 46077441, "link": "https://stackoverflow.com/questions/46077441/how-to-terminate-only-the-child-process/46077676#46077676", "title": "How to terminate only the child process?", "body": "<p>You'll need to pay attention to the return value of <a href=\"http://man7.org/linux/man-pages/man2/fork.2.html\" rel=\"nofollow noreferrer\">fork</a>. This small modification to your code probably does what you're looking for.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n#include&lt;unistd.h&gt;\n#include&lt;signal.h&gt;\n\nstruct process{\n    int pid;\n    int bt;\n};\n\nint main()\n{   \n    int no_of_process,i,new_process;\n    printf(\"Enter the number of process\\n\");\n    scanf(\"%d\",&amp;no_of_process);\n    struct process p[no_of_process];\n    for(i=0;i&lt;no_of_process;i++){\n        new_process=fork();\n        if (new_process == 0) {\n            // This is a child process. Just spin until killed.\n            while(true);\n        }\n        p[i].pid = new_process;\n        p[i].bt = rand()%10;\n        kill(new_process,SIGKILL);\n    }\n    for(i=0;i&lt;no_of_process;i++){\n        printf(\"process %d and bt %d\\n\",p[i].pid,p[i].bt);\n    }\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13866, "user_id": 54200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6261c8ab215b8069e8290516c80445d8?s=128&d=identicon&r=PG", "display_name": "KevinDTimm", "link": "https://stackoverflow.com/users/54200/kevindtimm"}, "is_accepted": false, "score": 2, "last_activity_date": 1504707647, "creation_date": 1504707647, "answer_id": 46077680, "question_id": 46077441, "link": "https://stackoverflow.com/questions/46077441/how-to-terminate-only-the-child-process/46077680#46077680", "title": "How to terminate only the child process?", "body": "<p>In your code, <code>new_process</code> is either 0 (so it's the child) or it's the pid of the child - no need to call <code>getpid</code> (ignoring -1 for failure)</p>\n\n<p>so, in the parent (0 return value) call <code>fork</code> <code>no_of_processes</code> times</p>\n"}, {"comments": [{"owner": {"reputation": 186, "user_id": 5143144, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f73795e51f93d9a6c5d7feffbf3e8aaf?s=128&d=identicon&r=PG&f=1", "display_name": "Zameer  Haque", "link": "https://stackoverflow.com/users/5143144/zameer-haque"}, "edited": false, "score": 0, "creation_date": 1504708216, "post_id": 46077749, "comment_id": 79117028, "body": "Yes. Tried the above answer <a href=\"https://stackoverflow.com/a/46077676/5143144\">stackoverflow.com/a/46077676/5143144</a>, however the pid remains same now and does not change at all. The process should have unique pid."}, {"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "reply_to_user": {"reputation": 186, "user_id": 5143144, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f73795e51f93d9a6c5d7feffbf3e8aaf?s=128&d=identicon&r=PG&f=1", "display_name": "Zameer  Haque", "link": "https://stackoverflow.com/users/5143144/zameer-haque"}, "edited": false, "score": 2, "creation_date": 1504708364, "post_id": 46077749, "comment_id": 79117133, "body": "the value of <code>new_process</code> will contain the unique PID for each child - you put that into your structure"}], "tags": [], "owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "is_accepted": false, "score": 7, "last_activity_date": 1504708312, "last_edit_date": 1504708312, "creation_date": 1504707806, "answer_id": 46077749, "question_id": 46077441, "link": "https://stackoverflow.com/questions/46077441/how-to-terminate-only-the-child-process/46077749#46077749", "title": "How to terminate only the child process?", "body": "<p>You aren't using <code>fork</code> correctly at all. When you call it, the child process continues executing the same code as the parent, but gets a different return value (0) to indicate that it is the child process. So in your code currently, the child processes are all spawning their own children.</p>\n\n<p>The usual way use <code>fork</code> is to do something akin to</p>\n\n<pre><code>new_process=fork();\nif(new_process==0)\n  {\n  // I am the child\n  }\nelse if(new_process==-1)\n  {\n  // Something bad happened\n  }\nelse\n  {\n  // I am the parent\n  }\n</code></pre>\n"}], "owner": {"reputation": 186, "user_id": 5143144, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f73795e51f93d9a6c5d7feffbf3e8aaf?s=128&d=identicon&r=PG&f=1", "display_name": "Zameer  Haque", "link": "https://stackoverflow.com/users/5143144/zameer-haque"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5546, "favorite_count": 1, "accepted_answer_id": 46077676, "answer_count": 3, "score": 0, "last_activity_date": 1504708312, "creation_date": 1504706946, "last_edit_date": 1504707213, "question_id": 46077441, "link": "https://stackoverflow.com/questions/46077441/how-to-terminate-only-the-child-process", "title": "How to terminate only the child process?", "body": "<p>I want print an array of processes with their <code>pid</code> and <code>burst time</code>. For this, I generate the <code>pid</code> using <code>fork()</code> and then get it <code>pid</code> using <code>getpid()</code>. However, since fork creates a child process that runs in isolation from the parent process, I am not getting the expected behavior. What the program should do is generate process for given <code>number_of_process</code> and then store <code>pid</code> and random<code>burst time</code> value inside the specific structure element. Here is my code:-</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n#include&lt;unistd.h&gt;\n#include&lt;signal.h&gt;\n\nstruct process{\n    int pid;\n    int bt;\n};\n\nint main()\n{   \n    int no_of_process,i,new_process;\n    printf(\"Enter the number of process\\n\");\n    scanf(\"%d\",&amp;no_of_process);\n    struct process p[no_of_process];\n    for(i=0;i&lt;no_of_process;i++){\n        new_process=fork();\n        p[i].pid = getpid();\n        p[i].bt = rand()%10;\n        //kill(getpid(),SIGKILL);\n    }\n    for(i=0;i&lt;no_of_process;i++){\n        printf(\"process %d and bt %d\\n\",p[i].pid,p[i].bt);\n    }\n    return 0;\n}\n</code></pre>\n\n<p>I tried to kill the child process but that stops the whole program.\nThe output for number of process = 2</p>\n\n<pre><code>process 6373 and bt 3\nprocess 6373 and bt 6\nprocess 6374 and bt 3                                                           \nprocess 6376 and bt 6\nprocess 6373 and bt 3\nprocess 6375 and bt 6\nprocess 6374 and bt 3\nprocess 6374 and bt 6\n</code></pre>\n\n<p>Expected should have been just 2 processes with pid and bt(burst time).</p>\n\n<blockquote>\n  <ul>\n  <li>How to kill the child process just after it stores pid and bt(burst time) or it cannot be done ? </li>\n  </ul>\n</blockquote>\n"}, {"tags": ["c", "linux", "tcp"], "comments": [{"owner": {"reputation": 4328, "user_id": 920069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd39f0db1f22e1314746491df063602a?s=128&d=identicon&r=PG", "display_name": "Retired Ninja", "link": "https://stackoverflow.com/users/920069/retired-ninja"}, "edited": false, "score": 1, "creation_date": 1504703874, "post_id": 46076212, "comment_id": 79113694, "body": "<a href=\"https://stackoverflow.com/questions/15108122/recv-with-non-blocking-socket\" title=\"recv with non blocking socket\">stackoverflow.com/questions/15108122/&hellip;</a>"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 3, "creation_date": 1504704044, "post_id": 46076212, "comment_id": 79113835, "body": "Put the socket in non-blocking mode, and / or use <code>select()</code>, <code>poll()</code>, or similar to determine whether there is data available before you try to read from the socket."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 2, "creation_date": 1504704460, "post_id": 46076212, "comment_id": 79114172, "body": "Cargo-cult programming : <code>memset(buf1, 0, strlen(buf1));</code> This is dangerous nonsense, IMHO"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "reply_to_user": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1504706409, "post_id": 46076212, "comment_id": 79115651, "body": "^^^ what @wildplasser says.  At best, such &#39;clear the buffer&#39; operations are a waste of cycles, at worst, disastrous.  If strlen() is involved anywhere, then the scales tip heavily towards the dark side:("}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 1, "creation_date": 1504706466, "post_id": 46076212, "comment_id": 79115694, "body": "Thread off the recv() loop?"}, {"owner": {"reputation": 7087, "user_id": 1389898, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00f2a3f2624a47edc48464d4929a7508?s=128&d=identicon&r=PG", "display_name": "dlmeetei", "link": "https://stackoverflow.com/users/1389898/dlmeetei"}, "edited": false, "score": 0, "creation_date": 1504711537, "post_id": 46076212, "comment_id": 79119524, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/15108122/recv-with-non-blocking-socket\">recv with non-blocking socket</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8095763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd3fcbbe6c3a824f55a73bc28df71b1b?s=128&d=identicon&r=PG&f=1", "display_name": "Sanket", "link": "https://stackoverflow.com/users/8095763/sanket"}, "edited": false, "score": 0, "creation_date": 1504765365, "post_id": 46076515, "comment_id": 79139932, "body": "Yes using above able to do other operation simultaneously but if data is available to recieve. &quot; buf1&quot; is showing empty."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 2, "last_activity_date": 1504711914, "last_edit_date": 1504711914, "creation_date": 1504704300, "answer_id": 46076515, "question_id": 46076212, "link": "https://stackoverflow.com/questions/46076212/tcp-function-recv-does-not-works-in-loop/46076515#46076515", "title": "TCP function recv() does not works in loop", "body": "<p>You need to set up the socket as a non-blocking socket.  In doing so, if you call <code>recv</code> and there is nothing to be received, the function call will return -1 to indicate an error with <code>EAGAIN</code> as the error code.</p>\n\n<p>You can set the non-blocking flag as follows</p>\n\n<pre><code>int fdflag;\nif ((fdflag = fcntl(sockfd, F_GETFL)) == -1) {\n    perror(\"Error getting socket descriptor flags\");\n    exit(1);\n}\nfdflag |= O_NONBLOCK;\nif (fcntl(sockfd, F_SETFL, fdflag) == -1) {\n    perror(\"Error setting non-blocking option\");\n    exit(1);\n}\n</code></pre>\n\n<p>Then you can change your <code>recv</code> call as follows:</p>\n\n<pre><code>     if((numbytes=recv(sockfd, buf1, wGetLen, 0)) != -1)\n     {\n         printf(\"%s %d\\n\",buf1,numbytes);\n         memset(buf1, 0, sizeof(buf1));                                \n     }\n     else if (errno == EAGAIN)\n     {\n         printf(\"no data to receive\\n\");\n     }\n     else\n     {\n         perror(\"error on recv\");\n     }    \n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8095763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd3fcbbe6c3a824f55a73bc28df71b1b?s=128&d=identicon&r=PG&f=1", "display_name": "Sanket", "link": "https://stackoverflow.com/users/8095763/sanket"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1504863921, "creation_date": 1504703469, "last_edit_date": 1504711447, "question_id": 46076212, "link": "https://stackoverflow.com/questions/46076212/tcp-function-recv-does-not-works-in-loop", "title": "TCP function recv() does not works in loop", "body": "<p>I am using infinite while loop to receive data from TCP server\nI need to perform other task in loop simultaneously having higher priority\nBut control holds to <code>recv()</code> function every time it waits for TCP data.</p>\n\n<pre><code>while(1)\n{\n        rdlen = read(fd1, buf, (sizeof(buf) - 1));\n        if (rdlen &gt; 0) \n        {\n            buf[rdlen] = 0;\n            printf(\"%s\",buf);\n            memset(buf, 0, strlen(buf));\n        }\n        if((numbytes=recv(sockfd, buf1, wGetLen, 0)) != -1)\n        {\n            printf(\"%s %d\\n\", buf1, numbytes);\n            memset(buf1, 0, strlen(buf1));                                \n        }\n}\n</code></pre>\n\n<p>How can I perform above operation without waiting for TCP to receive data?</p>\n"}, {"tags": ["c", "pipe", "fork", "file-descriptor"], "comments": [{"owner": {"reputation": 523, "user_id": 2413844, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ZKPJF.png?s=128&g=1", "display_name": "dwn", "link": "https://stackoverflow.com/users/2413844/dwn"}, "edited": false, "score": 2, "creation_date": 1504702932, "post_id": 46075956, "comment_id": 79112913, "body": "did you try an fflush(stdout) ?"}, {"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "edited": false, "score": 0, "creation_date": 1504703392, "post_id": 46075956, "comment_id": 79113272, "body": "Using newline (<code>printf(&quot;%s\\n&quot;, argv[1]);</code>) would work as well."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 1, "creation_date": 1504703429, "post_id": 46075956, "comment_id": 79113309, "body": "Even if <code>fflush(stdout)</code> has been called, the <code>xargs</code> process is probably waiting for more input."}], "owner": {"reputation": 2429, "user_id": 2760980, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KVwFb.jpg?s=128&g=1", "display_name": "Theja", "link": "https://stackoverflow.com/users/2760980/theja"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "closed_date": 1504703416, "answer_count": 0, "score": 0, "last_activity_date": 1504708530, "creation_date": 1504702839, "last_edit_date": 1504708530, "question_id": 46075956, "link": "https://stackoverflow.com/questions/46075956/what-am-i-missing-stdout-isnt-working-as-expected-or-does-exec-have-something", "closed_reason": "Duplicate", "title": "What am I missing? stdout isn&#39;t working as expected. Or does exec have something to do with it", "body": "<p>EDIT: Using fflush(stdout) does not seem work.</p>\n\n<p>The program takes a command line argument when run and gives the man page of the argument in a new Xterm window.</p>\n\n<blockquote>\n  <p>eg: <strong>./a.out ls</strong> should give a new window displaying the man page of\n  ls.</p>\n</blockquote>\n\n<p><em>NOTE: The only difference between the two programs is line #11.</em></p>\n\n<p>The code sample given below works as expected.</p>\n\n<pre><code>int main(int argc, char* argv[])\n{\n    int fd[2];\n    pipe(fd);\n\n    pid_t pid = fork();\n    if(pid &gt; 0)\n    {\n        dup2(fd[1], 1);\n        close(fd[0]);\n        execlp(\"echo\", \"echo\", argv[1], NULL);\n        wait(NULL);\n    }\n    else\n    {\n        dup2(fd[0], 0);\n        close(fd[1]);\n        execlp(\"xargs\", \"xargs\", \"xterm\", \"-hold\", \"-e\", \"man\", NULL);\n        exit(0);\n    }\n    return 0;\n}\n</code></pre>\n\n<p>But the code below doesn't work the same:</p>\n\n<pre><code>int main(int argc, char* argv[])\n{\n    int fd[2];\n    pipe(fd);\n\n    pid_t pid = fork();\n    if(pid &gt; 0)\n    {\n        dup2(fd[1], 1);\n        close(fd[0]);\n        printf(\"%s\", argv[1]);\n        fflush(stdout);\n        wait(NULL);\n    }\n    else\n    {\n        dup2(fd[0], 0);\n        close(fd[1]);\n        execlp(\"xargs\", \"xargs\", \"xterm\", \"-hold\", \"-e\", \"man\", NULL);\n        exit(0);\n    }\n    return 0;\n}\n</code></pre>\n\n<p>The <strong>PARENT</strong> process pipes the command line argument and the <strong>CHILD</strong> process takes stdin from the pipe which exec command uses to run.</p>\n\n<p>Shouldn't printf() also give output onto stdout?</p>\n"}, {"tags": ["c", "pointers", "multidimensional-array"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 3, "creation_date": 1504699730, "post_id": 46074743, "comment_id": 79110389, "body": "I suggest you draw it all out on paper, first the <code>uuboard</code> arrays (but not as a matrix but as sequential and contiguous values), then <code>uboard</code> and draw arrows to where the pointers are pointing, and lastly <code>board</code> with an arrow where it is pointing. And remember that e.g. <code>uuboard[2]+2</code> is equal to <code>&amp;uuboard[2][2]</code>, and <code>uboard+2</code> is equal to <code>&amp;uboard[2]</code>."}, {"owner": {"reputation": 504, "user_id": 5282337, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/J5BT7.jpg?s=128&g=1", "display_name": "Fred", "link": "https://stackoverflow.com/users/5282337/fred"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1504709761, "post_id": 46074743, "comment_id": 79118210, "body": "Thanks for the comment. Long-hand drawing is always helpful."}], "answers": [{"comments": [{"owner": {"reputation": 504, "user_id": 5282337, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/J5BT7.jpg?s=128&g=1", "display_name": "Fred", "link": "https://stackoverflow.com/users/5282337/fred"}, "edited": false, "score": 0, "creation_date": 1504703744, "post_id": 46074993, "comment_id": 79113574, "body": "uuboard[0]+2 was too cryptic for me, &amp;uuboard[0][2] is better. Putting in the ampersand and the two indices helped me a lot. Many thanks"}, {"owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "reply_to_user": {"reputation": 504, "user_id": 5282337, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/J5BT7.jpg?s=128&g=1", "display_name": "Fred", "link": "https://stackoverflow.com/users/5282337/fred"}, "edited": false, "score": 0, "creation_date": 1504703836, "post_id": 46074993, "comment_id": 79113653, "body": "@Fishsticks; I am glad it helped you."}], "tags": [], "owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "is_accepted": true, "score": 0, "last_activity_date": 1504700142, "creation_date": 1504700142, "answer_id": 46074993, "question_id": 46074743, "link": "https://stackoverflow.com/questions/46074743/c-pointers-in-a-2-d-array-context/46074993#46074993", "title": "C pointers in a 2-D array context", "body": "<p>The line  </p>\n\n<pre><code>unsigned char *uboard[8]={uuboard[0]+2, uuboard[1]+2, uuboard[2]+2, uuboard[3]+2, uuboard[4]+2, uuboard[5]+2, uuboard[6]+2, uuboard[7]+2};  \n</code></pre>\n\n<p>is equivalent to  </p>\n\n<pre><code>unsigned char *uboard[8]={&amp;uuboard[0][2], &amp;uuboard[1][2], &amp;uuboard[2][2], &amp;uuboard[3][2], &amp;uuboard[4][2], &amp;uuboard[5][2], &amp;uuboard[6][2], &amp;uuboard[7][2]};  \n</code></pre>\n\n<p>and   </p>\n\n<pre><code>unsigned char **board=uboard+2;  \n</code></pre>\n\n<p>is equivalent to  </p>\n\n<pre><code>unsigned char **board = &amp;uboard[0]+2; \n// or \nunsigned char **board = &amp;uboard[2];\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 399, "user_id": 8555361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3bb69a4dca8191a0b26ab901d306020c?s=128&d=identicon&r=PG&f=1", "display_name": "Ganeshdip", "link": "https://stackoverflow.com/users/8555361/ganeshdip"}, "is_accepted": false, "score": 0, "last_activity_date": 1504700564, "creation_date": 1504700564, "answer_id": 46075145, "question_id": 46074743, "link": "https://stackoverflow.com/questions/46074743/c-pointers-in-a-2-d-array-context/46075145#46075145", "title": "C pointers in a 2-D array context", "body": "<p>Here unsigned char *uboard[8] is array of pointer which can store 8 pointers to unsigned characters.\nNow uboard[0] = uuboard[0]+2.</p>\n\n<ul>\n<li>uuboard[0] is a pointer to array of 8 characters --> {1,1,1,1,1,1,1,1} i.e. first array in uuboard[8][8].</li>\n<li>uboard[0] + 2 means --> uboard[0] + memory of next 2 arrays of 8 characters (As the type of pointer is char (*)[8]--> pointer to array of 8 characters.)\nHence uboard[0]+2 = uboard[2].  </li>\n</ul>\n"}], "owner": {"reputation": 504, "user_id": 5282337, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/J5BT7.jpg?s=128&g=1", "display_name": "Fred", "link": "https://stackoverflow.com/users/5282337/fred"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "accepted_answer_id": 46074993, "answer_count": 2, "score": 0, "last_activity_date": 1504700564, "creation_date": 1504699409, "last_edit_date": 1504699633, "question_id": 46074743, "link": "https://stackoverflow.com/questions/46074743/c-pointers-in-a-2-d-array-context", "title": "C pointers in a 2-D array context", "body": "<p>Here is working program that has an 8 by 8 array representing a mini chessboard. The actual chessboard is 4 by 4 and filled with zeros in the array.</p>\n\n<pre><code>// Chessboard representation\n//\n#include &lt;stdio.h&gt;\n\nunsigned char uuboard[8][8]={\n{1,1,1,1,1,1,1,1}, {1,1,1,1,1,1,1,1},\n{1,1,0,0,0,0,1,1}, {1,1,0,0,0,0,1,1},   \n{1,1,0,0,0,0,1,1}, {1,1,0,0,0,0,1,1},   \n{1,1,1,1,1,1,1,1}, {1,1,1,1,1,1,1,1} };     \n\nunsigned char *uboard[8]={uuboard[0]+2, uuboard[1]+2, uuboard[2]+2, uuboard[3]+2,\n                          uuboard[4]+2, uuboard[5]+2, uuboard[6]+2, uuboard[7]+2};\nunsigned char **board=uboard+2;\n\nint main(void) {\n    // Make a change to the board directly, using 2-D array\n    uuboard[3][3] = 8;\n    printf(\"Print the board by accessing the 2-D array directly\\n\");\n    for (int i=0;i&lt;8;i++) {\n        for (int j=0;j&lt;8;j++) {\n            printf(\"%d\", uuboard[i][j]);\n        }\n        printf(\"\\n\");\n    }\n    printf(\"Print again using pointers\\n\");\n    for (int i=0; i&lt;4; i++, printf(\"\\n\")) {\n      for (int j=0; j&lt;4; j++) {\n          printf(\"%d\", board[i][j]);\n      }\n    }\n    printf(\"\\n\");   \n    return 0;\n}\n</code></pre>\n\n<p>The original programmer appears to use pointers so he/she gets to the actual chessboard squares by starting the index at 0, not 2. This is puzzling. How does <code>*uboard[8]</code> and <code>**board</code> do the job? Most grateful for any answers or references to answers.</p>\n"}, {"tags": ["c", "windows", "windows-services"], "comments": [{"owner": {"reputation": 337, "user_id": 2563058, "user_type": "registered", "accept_rate": 90, "profile_image": "https://graph.facebook.com/1513172627/picture?type=large", "display_name": "qwn", "link": "https://stackoverflow.com/users/2563058/qwn"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1504702285, "post_id": 46074598, "comment_id": 79112394, "body": "@RbMm The service should remain on all the time and return serial number whenever a new USB is plugged in. When a new USB is plugged in to the computer the driver gets the vendor ID and the product ID and sends them to the service which executes the command and then returns the corresponding serial number, that is why i need the service to stay in loop and check for any input from the driver."}, {"owner": {"reputation": 33265, "user_id": 886887, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1616c7e4fab23f6e014ee11d75408bba?s=128&d=identicon&r=PG", "display_name": "Harry Johnston", "link": "https://stackoverflow.com/users/886887/harry-johnston"}, "edited": false, "score": 0, "creation_date": 1504739359, "post_id": 46074598, "comment_id": 79133183, "body": "You need to add error checking, so that you can find where exactly the code is failing.  Also, if you put a modest Sleep() in main() before it calls StartServiceCtrlDispatcher you can attach a debugger."}], "answers": [{"tags": [], "owner": {"reputation": 337, "user_id": 2563058, "user_type": "registered", "accept_rate": 90, "profile_image": "https://graph.facebook.com/1513172627/picture?type=large", "display_name": "qwn", "link": "https://stackoverflow.com/users/2563058/qwn"}, "is_accepted": false, "score": 0, "last_activity_date": 1504843157, "last_edit_date": 1504843157, "creation_date": 1504770698, "answer_id": 46090869, "question_id": 46074598, "link": "https://stackoverflow.com/questions/46074598/windows-service-runs-as-console-app-but-shuts-down-automatically-as-a-service/46090869#46090869", "title": "Windows Service runs as console app but shuts down automatically as a service", "body": "<p>Ok i got it, it was a bunch of mistakes.</p>\n\n<p>I had set the timer for FltSendMessage too long (100 seconds) on top of that I did not initialize the OVERLAPPED structure in FilterGetMessage which meant that the Service was put into wait state until any input from the driver.</p>\n\n<p>Its all sorted out now. Thanks for all the help.</p>\n\n<p>Edit:\nAlso I screwed up string matching which disconnected the service</p>\n"}], "owner": {"reputation": 337, "user_id": 2563058, "user_type": "registered", "accept_rate": 90, "profile_image": "https://graph.facebook.com/1513172627/picture?type=large", "display_name": "qwn", "link": "https://stackoverflow.com/users/2563058/qwn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 73, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1504843157, "creation_date": 1504699007, "question_id": 46074598, "link": "https://stackoverflow.com/questions/46074598/windows-service-runs-as-console-app-but-shuts-down-automatically-as-a-service", "title": "Windows Service runs as console app but shuts down automatically as a service", "body": "<p>So i have created a windows service which works in windows 10 as a service and on windows 7 as console application but when run in windows 7 as a service it stops automatically.</p>\n\n<p>I have followed the tutorial here <a href=\"http://www.devx.com/cplus/Article/9857/0/page/2\" rel=\"nofollow noreferrer\">DevX windows service steps</a></p>\n\n<p>The service talks to my driver and provides the serialnumber for specific devices by executing cmd <code>wmic diskdrive get pnpdeviceid</code>.</p>\n\n<p>Finally here is the main function and the serviceMain function </p>\n\n<pre><code> VOID\n WINAPI ServiceMain(\n     DWORD argc,\n     LPTSTR *argv\n )\n /*\n  Description:\n    Service Entry Point of the service.\n */\n {\nstatusHandle = RegisterServiceCtrlHandler(SERVICE_NAME,  ServiceCtrlHandler);\n\nif (statusHandle == NULL)\n    return;\n\n// Tell the service controller we are starting\nRtlZeroMemory(&amp;serviceStatus, sizeof(serviceStatus));\nserviceStatus.dwServiceType = SERVICE_WIN32_OWN_PROCESS;\nserviceStatus.dwControlsAccepted = 0;\nserviceStatus.dwCurrentState = SERVICE_START_PENDING;\nserviceStatus.dwWin32ExitCode = 0;\nserviceStatus.dwServiceSpecificExitCode = 0;\nserviceStatus.dwCheckPoint = 0;\n\nHRESULT result = ConnectToPort(&amp;port);\n\nserviceStatus.dwCurrentState = SERVICE_RUNNING;\nSetServiceStatus(statusHandle, &amp;serviceStatus);\n\nwhile (serviceStatus.dwCurrentState == SERVICE_RUNNING) {\n    result = GetInformationAndSendSerialNumber(&amp;port);\n    if(SUCCEEDED(result)) Sleep(5000);\n}\n\nserviceStatus.dwControlsAccepted = 0;\nserviceStatus.dwCurrentState = SERVICE_STOPPED;\nserviceStatus.dwWin32ExitCode = 0;\nserviceStatus.dwCheckPoint = 3;\nSetServiceStatus(statusHandle, &amp;serviceStatus);\n}\n\nINT \nmain(\nINT argc,\nPCHAR *argv\n)\n{\nSERVICE_TABLE_ENTRY serviceTableEntry[] = \n{\n    { SERVICE_NAME, (LPSERVICE_MAIN_FUNCTION)ServiceMain},\n    {NULL, NULL}\n};\nStartServiceCtrlDispatcher(serviceTableEntry);\nreturn 0;\n}\n</code></pre>\n\n<p>`</p>\n\n<p>This is how i install the service</p>\n\n<p><code>sc create Test binpath= C:\\Test.exe\nsc config Test start= auto\n</code></p>\n"}, {"tags": ["c", "linux", "file"], "comments": [{"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1504728032, "post_id": 46074200, "comment_id": 79128756, "body": "This isn&#39;t your actual problem, but you might want to be using <code>open(&quot;foo.hex&quot;, O_RDWR|O_CREAT|O_EXCL, 0666)</code> in the writer."}, {"owner": {"reputation": 488, "user_id": 3736779, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/86dde332793c807b4f418b91a7252643?s=128&d=identicon&r=PG&f=1", "display_name": "Frode Akselsen", "link": "https://stackoverflow.com/users/3736779/frode-akselsen"}, "reply_to_user": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1504737710, "post_id": 46074200, "comment_id": 79132728, "body": "@zwol right, I actually open it with O_CREAT, 0666 but that doesn&#39;t change the problem with the race condition."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1504740073, "post_id": 46074200, "comment_id": 79133344, "body": "Remember: <code>flock()</code> locking is advisory, not mandatory, so even after you&#39;ve applied the lock in one process, the other process can go ahead and do what it will if it ignores the lock."}, {"owner": {"reputation": 488, "user_id": 3736779, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/86dde332793c807b4f418b91a7252643?s=128&d=identicon&r=PG&f=1", "display_name": "Frode Akselsen", "link": "https://stackoverflow.com/users/3736779/frode-akselsen"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1504781137, "post_id": 46074200, "comment_id": 79150215, "body": "@JonathanLeffler thanks for this hint, that&#39;s actually where I screwed up on the reader side. Initially I thought I only have to protect the file during creation/initialisation but I will now implement a more general solution based on John&#39;s approach."}], "answers": [{"comments": [{"owner": {"reputation": 488, "user_id": 3736779, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/86dde332793c807b4f418b91a7252643?s=128&d=identicon&r=PG&f=1", "display_name": "Frode Akselsen", "link": "https://stackoverflow.com/users/3736779/frode-akselsen"}, "edited": false, "score": 0, "creation_date": 1504699338, "post_id": 46074258, "comment_id": 79110109, "body": "I was considering that, but wasn&#39;t sure if this is how it&#39;s done or if it&#39;s more a hack."}, {"owner": {"reputation": 205167, "user_id": 4323, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/qqgFU.png?s=128&g=1", "display_name": "John Zwinck", "link": "https://stackoverflow.com/users/4323/john-zwinck"}, "reply_to_user": {"reputation": 488, "user_id": 3736779, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/86dde332793c807b4f418b91a7252643?s=128&d=identicon&r=PG&f=1", "display_name": "Frode Akselsen", "link": "https://stackoverflow.com/users/3736779/frode-akselsen"}, "edited": false, "score": 1, "creation_date": 1504699660, "post_id": 46074258, "comment_id": 79110346, "body": "This is how it&#39;s done.  Renaming files to protect them while writing is super common.  Web browsers do it while downloading files to make sure you don&#39;t try to open half of a file, for example.  File locking is fraught with peril, and should be avoided when possible."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1504712527, "post_id": 46074258, "comment_id": 79120129, "body": "About renaming.  Assume &quot;foo.hex&quot; exists before programs start, and the writer makes &quot;foo.hex.init&quot;.  To rename, does not &quot;foo.hex&quot; need to be deleted (or renamed to &quot;some_tmp_name&quot;) before  &quot;foo.hex.init&quot; is renamed to  &quot;foo.hex&quot;?  If this is so, does that leave a window where no &quot;foo.hex&quot; exists - which may cause trouble for the reader?"}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 3, "creation_date": 1504727866, "post_id": 46074258, "comment_id": 79128664, "body": "@chux On a POSIX-compliant system, <code>rename(&quot;foo.hex.init&quot;, &quot;foo.hex&quot;) </code> is required to atomically replace <code>foo.hex</code> -- there will be no point at which <code>foo.hex</code> can be observed not to exist or to have the wrong contents.  However, on Windows, the old file must be deleted first, and there is indeed an unavoidable race window where <code>foo.hex</code> can be observed not to exist.  If I was writing a program where this mattered, I would simply have the reader spin a few times before giving up."}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 3, "creation_date": 1504739777, "post_id": 46074258, "comment_id": 79133281, "body": "Code that requires the atomic replacement logic, typically uses the POSIX <a href=\"http://man7.org/linux/man-pages/man2/link.2.html\" rel=\"nofollow noreferrer\"><code>link()</code></a> (rather than <code>rename()</code>)."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 0, "creation_date": 1504777573, "post_id": 46074258, "comment_id": 79147797, "body": "@NominalAnimal <code>link()</code> can&#39;t be used on directories, though. And are you sure POSIX <code>rename()</code> isn&#39;t atomic?  The POSIX standard states <i>If the link named by the <code>new</code> argument exists, it shall be removed and <code>old</code> renamed to <code>new</code>. In this case, a link named <code>new</code> shall remain visible to other threads throughout the renaming operation and refer either to the file referred to by <code>new</code> or <code>old</code> before the operation began.</i> with the added benefit of <i>If the <code>rename()</code> function fails for any reason other than <code>EIO</code>, any file named by <code>new</code> shall be unaffected.</i>"}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1504787775, "post_id": 46074258, "comment_id": 79154699, "body": "@AndrewHenle: No, I didn&#39;t mean to imply <a href=\"http://man7.org/linux/man-pages/man2/rename.2.html\" rel=\"nofollow noreferrer\"><code>rename()</code></a> is not atomic on POSIXy systems; just that you usually see code using <code>link()</code> (rather than <code>rename()</code>). There are both historical and use-case reasons. The main use case reason is that <code>link()</code> does not rename the new file, it only makes the old file name refer to the inode of the new file. The historical use case is related to NFS file locking (not relying on NLM, i.e. <code>fcntl()</code> record locks) and creating lockfiles; see e.g. <a href=\"https://lwn.net/Articles/251004/\" rel=\"nofollow noreferrer\">this LWN article</a>."}], "tags": [], "owner": {"reputation": 205167, "user_id": 4323, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/qqgFU.png?s=128&g=1", "display_name": "John Zwinck", "link": "https://stackoverflow.com/users/4323/john-zwinck"}, "is_accepted": true, "score": 6, "last_activity_date": 1504698050, "creation_date": 1504698050, "answer_id": 46074258, "question_id": 46074200, "link": "https://stackoverflow.com/questions/46074200/atomically-open-and-lock-file/46074258#46074258", "title": "Atomically open and lock file", "body": "<p>Make the writer create a file called \"foo.hex.init\" instead, and initialize that before renaming it to \"foo.hex\".  This way, the reader can never see the uninitialized file contents.</p>\n"}, {"tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": false, "score": 0, "last_activity_date": 1504698572, "creation_date": 1504698572, "answer_id": 46074454, "question_id": 46074200, "link": "https://stackoverflow.com/questions/46074200/atomically-open-and-lock-file/46074454#46074454", "title": "Atomically open and lock file", "body": "<p>There are many ways of <a href=\"https://en.wikipedia.org/wiki/Inter-process_communication\" rel=\"nofollow noreferrer\">inter-process communications</a>.</p>\n\n<p>Perhaps use a named semaphore that the writing process locks before opening and initializing the file? Then the reading process could attempt to lock the semaphore as well, and if it succeeds and the file doesn't exist it unlocks the semaphore and wait a little while and retry.</p>\n\n<p>The simplest way though, especially if the file will be recreated by the writing process every time, is already in <a href=\"https://stackoverflow.com/a/46074258/440558\">the answer by John Zwinck</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "is_accepted": false, "score": 1, "last_activity_date": 1504728347, "creation_date": 1504728347, "answer_id": 46083504, "question_id": 46074200, "link": "https://stackoverflow.com/questions/46074200/atomically-open-and-lock-file/46083504#46083504", "title": "Atomically open and lock file", "body": "<p>An alternative approach is for the reader process to sleep a little and retry upon finding that the file doesn't yet exist, or is empty.</p>\n\n<pre><code>int open_for_read(const char *fname)\n{\n    int retries = 0;\n\n    for (;;) {\n        int fd = open(fname, O_RDONLY);\n        if (fd == -1) {\n            if (errno != ENOENT) return -1;\n            goto retry;\n        } \n        if (flock(fd, LOCK_SH)) {\n            close(fd);\n            return -1;\n        }\n\n        struct stat st;\n        if (fstat(fd, &amp;st)) {\n            close(fd);\n            return -1;\n        }\n        if (st.st_size == 0) {\n            close(fd);\n            goto retry;\n        }\n        return fd;\n\n    retry:\n        if (++retries &gt; MAX_RETRIES) return -1;\n        sleep(1);\n    }\n    /* not reached */\n}\n</code></pre>\n\n<p>You need similar code on the write side, so that if the writer loses the race it doesn't have to be restarted.</p>\n"}, {"tags": [], "owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "is_accepted": false, "score": 2, "last_activity_date": 1504778592, "creation_date": 1504778592, "answer_id": 46093546, "question_id": 46074200, "link": "https://stackoverflow.com/questions/46074200/atomically-open-and-lock-file/46093546#46093546", "title": "Atomically open and lock file", "body": "<p>Another approach could be to remove the existing file, recreate it without permissions for any process to access it, then change the file permissions after it's written:</p>\n\n<pre><code>unlink(\"foo.hex\");\nfd = open(\"foo.hex\", O_RDWR|O_CREAT|O_EXCL, 0);\n\ninit_structures(fd);\n\nfchmod(fd, 0666);\n</code></pre>\n\n<p>That likely won't work if you're running as root.  (Which you shouldn't be doing anyway...)</p>\n\n<p>This would prevent any process from using old data once the <code>unlink()</code> call is made.  Depending on your requirements, that may or may not be worth the extra reader code necessary to deal with the file not existing or being accessible while the new file is being initialized.</p>\n\n<p>Personally, I'd use the <code>rename( \"foo.hex.init\", \"foo.hex\" )</code> solution unless <code>init_structures()</code> takes <em>significant</em> time, and there's a real, hard requirement to not use old data once new data is available.  But sometimes important people aren't comfortable with using old data while any portion of new data is available, and they don't really understand, \"If the reader process started two milliseconds earlier it would use the old data anyway\".</p>\n"}], "owner": {"reputation": 488, "user_id": 3736779, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/86dde332793c807b4f418b91a7252643?s=128&d=identicon&r=PG&f=1", "display_name": "Frode Akselsen", "link": "https://stackoverflow.com/users/3736779/frode-akselsen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 491, "favorite_count": 0, "accepted_answer_id": 46074258, "answer_count": 4, "score": 3, "last_activity_date": 1504778592, "creation_date": 1504697836, "last_edit_date": 1504737731, "question_id": 46074200, "link": "https://stackoverflow.com/questions/46074200/atomically-open-and-lock-file", "title": "Atomically open and lock file", "body": "<p>I have a file <code>foo.hex</code> that is accessed by two processes. One process has <code>O_RDONLY</code> access and the other has <code>O_RDWR</code> access.</p>\n\n<p>When starting the system for the very first time, the reading process should not access the file before the writing process has initialized it.</p>\n\n<p>Thus, I wrote something like this to initialize the file.</p>\n\n<pre><code>fd = open(\"foo.hex\", O_RDWR|O_CREAT, 0666);\nflock(fd, LOCK_EX);\n\ninit_structures(fd);\n\nflock(fd, LOCK_UN);\n</code></pre>\n\n<p>Which still leaves the possibility to the reader process to access the file before it is initialized.</p>\n\n<p>I couldn't find a way to <code>open()</code> and <code>flock()</code> in an atomic fashion. Besides mutexes what other possibilities are there to achieve my goal in an elegant way with as little overhead as possible (since it's only used once, the very first time the system is started)?</p>\n"}, {"tags": ["c", "stack"], "comments": [{"owner": {"reputation": 4251, "user_id": 4605105, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh4.googleusercontent.com/-_cFfGx1khYs/AAAAAAAAAAI/AAAAAAAAGt0/vfQ_28nwAEE/photo.jpg?sz=128", "display_name": "&#212;rel", "link": "https://stackoverflow.com/users/4605105/%c3%94rel"}, "edited": false, "score": 1, "creation_date": 1504697007, "post_id": 46073904, "comment_id": 79108495, "body": "you have to store your <i>word</i>, here you put all your word into your <code>char word[20]</code> you need to allocate memory for each word"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 1, "creation_date": 1504697036, "post_id": 46073904, "comment_id": 79108516, "body": "You are pushing the same buffer."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1504697095, "post_id": 46073904, "comment_id": 79108556, "body": "Your stack stores the addresses of the stings, it should store the strings itself."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1504697267, "post_id": 46073904, "comment_id": 79108681, "body": "Try <code>char word[20];</code> --&gt; <code>char word[MAX][20];</code>, <code>scanf(&quot;%s&quot;, word);         push(ps, word);</code> --&gt; <code>scanf(&quot;%19s&quot;, word[i]); \t\tpush(ps, word[i]);</code>"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1504697319, "post_id": 46073904, "comment_id": 79108714, "body": "..someting that would be obvious from your debugger."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8199368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acaac3eb0bdd889e9d68a85bc085c150?s=128&d=identicon&r=PG&f=1", "display_name": "nishchayp", "link": "https://stackoverflow.com/users/8199368/nishchayp"}, "edited": false, "score": 0, "creation_date": 1504700265, "post_id": 46074309, "comment_id": 79110836, "body": "Thank you for the clear and concise explanation about why the error was occurring. Helped me in understanding a new concept."}], "tags": [], "owner": {"reputation": 399, "user_id": 8555361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3bb69a4dca8191a0b26ab901d306020c?s=128&d=identicon&r=PG&f=1", "display_name": "Ganeshdip", "link": "https://stackoverflow.com/users/8555361/ganeshdip"}, "is_accepted": true, "score": 0, "last_activity_date": 1504703883, "last_edit_date": 1504703883, "creation_date": 1504698196, "answer_id": 46074309, "question_id": 46073904, "link": "https://stackoverflow.com/questions/46073904/why-does-push-function-inside-for-loop-gets-called-multiple-time-in-each-iterati/46074309#46074309", "title": "Why does push function inside for loop gets called multiple time in each iteration instead of just once for every iteration?", "body": "<p>Stack data type is defined as -</p>\n\n<pre><code>typedef struct\n{\n    int top;\n    char* s[MAX];\n} stack;\n</code></pre>\n\n<p>char* s[MAX] - It is array of pointer. You are not assigning memory here and just creating a pointer array which can hold address of character in each element.\nAnd in push function you are just assigning value to this pointer as address of word. After last execution of for loop,value of word is \"third\". Now you are printing value at the address pointed by s[0],s[1],s[2]. These are all currently pointing to word.</p>\n\n<ol>\n<li>Either create stack with array of string\nOR</li>\n<li>Store the word in different variables.</li>\n</ol>\n\n<p>Here point 1 makes sense as we are implementing stack which will hold data values.</p>\n"}], "owner": {"reputation": 1, "user_id": 8199368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acaac3eb0bdd889e9d68a85bc085c150?s=128&d=identicon&r=PG&f=1", "display_name": "nishchayp", "link": "https://stackoverflow.com/users/8199368/nishchayp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 46074309, "answer_count": 1, "score": -1, "last_activity_date": 1504703883, "creation_date": 1504696863, "question_id": 46073904, "link": "https://stackoverflow.com/questions/46073904/why-does-push-function-inside-for-loop-gets-called-multiple-time-in-each-iterati", "title": "Why does push function inside for loop gets called multiple time in each iteration instead of just once for every iteration?", "body": "<p>I wish to reverse a sentence word by word using a stack. \n<br> \n<br>Input: first second third\n<br>Expected output: third second first \n<br>Actual output: third third third\n<br>\n<br>I am getting the desired result by using push outside for loop but not inside for loop.\n<br>\n<br>Code:-</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#define MAX 50\ntypedef int bool;\n#define true 1\n#define false 0\n\ntypedef struct\n{\n    int top;\n    char* s[MAX];\n} stack;\n\nbool isFull(stack *ps)\n{\n    if(ps-&gt;top == MAX - 1)\n        return true;\n    else\n        return false;\n}\n\nvoid push(stack *ps, char* x)\n{\n    if(!isFull(ps))\n        ps-&gt;s[++(ps-&gt;top)] = x;\n    else\n        printf(\"Error: overflow\\n\");\n}\n\nvoid display(stack *ps)\n{\n    int i;\n    for(i = ps-&gt;top; i &gt; -1; i--)\n        printf(\"%s \", ps-&gt;s[i]);\n}\n\nint main()\n{\n    stack sentence;\n    stack* ps = &amp;sentence;\n    sentence.top = -1;\n    int n, i;\n    char word[20];\n    printf(\"No. of words: \");\n    scanf(\"%d\", &amp;n);\n    for(i = 0; i &lt; n; i++)\n    {\n        scanf(\"%s\", word);\n        push(ps, word);\n    }\n    display(ps);\n    printf(\"\\n\");\n}\n</code></pre>\n"}, {"tags": ["c", "command", "clib"], "answers": [{"tags": [], "owner": {"reputation": 3725, "user_id": 8471208, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-zX6iRd9pmRI/AAAAAAAAAAI/AAAAAAAAAgE/F3-J9H4ZCno/photo.jpg?sz=128", "display_name": "Kevin Boone", "link": "https://stackoverflow.com/users/8471208/kevin-boone"}, "is_accepted": false, "score": 0, "last_activity_date": 1504777294, "creation_date": 1504777294, "answer_id": 46093030, "question_id": 46073720, "link": "https://stackoverflow.com/questions/46073720/how-to-run-minimad-c-in-libmadwhat-is-command-and-params/46093030#46093030", "title": "How to run minimad.c in libmad(what is command and params)?", "body": "<p>minimad.c is a simple demo program for the libmad library. If you build libmad according to the instructions, then you should be able to build the minimad binary just by running \"make minimad\" at the prompt. The parameters argv, etc., are passed from the command line when you run invoke the program -- this point is pretty well described in most textbooks on C programming. </p>\n\n<p>If what you're really asking is how to use libmad in a program of your own, then that's a different matter. You can use the minimad.c source code as a guide to doing this, but it's non-trivial.</p>\n"}], "owner": {"reputation": 322, "user_id": 8568641, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GnR4U.jpg?s=128&g=1", "display_name": "Guseyn Ismayylov", "link": "https://stackoverflow.com/users/8568641/guseyn-ismayylov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 115, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1504777294, "creation_date": 1504696294, "question_id": 46073720, "link": "https://stackoverflow.com/questions/46073720/how-to-run-minimad-c-in-libmadwhat-is-command-and-params", "title": "How to run minimad.c in libmad(what is command and params)?", "body": "<p>Could please some explain how to run minimad.c in libmad(<a href=\"http://www.underbit.com/products/mad/\" rel=\"nofollow noreferrer\">http://www.underbit.com/products/mad/</a>)? I followed instructions in INSTALL file. But I am not good in C and I don't know what parameters need to be passed in main function. I don't understand what parameters in argv is using there(in main()). </p>\n"}, {"tags": ["c", "xdr"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1504696072, "post_id": 46073563, "comment_id": 79107830, "body": "What is the problem you&#39;re having? What is the question? Is it only about the <code>malloc</code> thing? Something else? Something more?"}, {"owner": {"reputation": 13, "user_id": 8497213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a78eadeb9d1cc69cbd16cb6e606086b6?s=128&d=identicon&r=PG&f=1", "display_name": "JoannaM", "link": "https://stackoverflow.com/users/8497213/joannam"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1504696522, "post_id": 46073563, "comment_id": 79108169, "body": "@Someprogrammerdude Hello, it&#39;s really about how to fill the response mesage. How to put the data:  something[0]=data and something[1]=data, but I dont know to do that. As I said in the post, I only know how to do it with one, not 2."}, {"owner": {"reputation": 4827, "user_id": 8051589, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8VNG6.png?s=128&g=1", "display_name": "Andre Kampling", "link": "https://stackoverflow.com/users/8051589/andre-kampling"}, "reply_to_user": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 1, "creation_date": 1504698071, "post_id": 46073563, "comment_id": 79109259, "body": "@wildplasser: No, but it&#39;s the language that rpcgen needs to generate the filter functions (<code>xdr_typename()</code>) for the usage of XDR as the OP cleary said. For more information about <a href=\"https://stackoverflow.com/a/26625494/8051589\">the .x file see here on SO</a>."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "reply_to_user": {"reputation": 4827, "user_id": 8051589, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8VNG6.png?s=128&g=1", "display_name": "Andre Kampling", "link": "https://stackoverflow.com/users/8051589/andre-kampling"}, "edited": false, "score": 0, "creation_date": 1504699209, "post_id": 46073563, "comment_id": 79110035, "body": "@AndreKampling Sorry, I missed that."}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1504700545, "post_id": 46073563, "comment_id": 79111088, "body": "You can&#39;t design an XDR format for a file of unknown length. You will just have to keep sending <code>xdr_arrays</code> of <code>char</code>, probably ending with one of zero length."}, {"owner": {"reputation": 4827, "user_id": 8051589, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8VNG6.png?s=128&g=1", "display_name": "Andre Kampling", "link": "https://stackoverflow.com/users/8051589/andre-kampling"}, "reply_to_user": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1504703490, "post_id": 46073563, "comment_id": 79113376, "body": "@EJP: May I get you wrong but sure the OP can and already does it: <code>opaque contents&lt;&gt;;</code>. His generated filter functions will handle that."}], "answers": [{"comments": [{"owner": {"reputation": 4827, "user_id": 8051589, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8VNG6.png?s=128&g=1", "display_name": "Andre Kampling", "link": "https://stackoverflow.com/users/8051589/andre-kampling"}, "edited": false, "score": 0, "creation_date": 1504771782, "post_id": 46075480, "comment_id": 79143915, "body": "@JoannaM: Does this answer helped you? Do you have more questions?"}, {"owner": {"reputation": 13, "user_id": 8497213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a78eadeb9d1cc69cbd16cb6e606086b6?s=128&d=identicon&r=PG&f=1", "display_name": "JoannaM", "link": "https://stackoverflow.com/users/8497213/joannam"}, "edited": false, "score": 0, "creation_date": 1504800329, "post_id": 46075480, "comment_id": 79164145, "body": "Yes, it did!. Thank you. I appreciate you taking your time. I really needed to check as, you said, the .h generated file and also read a little bit more about  xdr. The post you suggested also helped a lot."}, {"owner": {"reputation": 4827, "user_id": 8051589, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8VNG6.png?s=128&g=1", "display_name": "Andre Kampling", "link": "https://stackoverflow.com/users/8051589/andre-kampling"}, "reply_to_user": {"reputation": 13, "user_id": 8497213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a78eadeb9d1cc69cbd16cb6e606086b6?s=128&d=identicon&r=PG&f=1", "display_name": "JoannaM", "link": "https://stackoverflow.com/users/8497213/joannam"}, "edited": false, "score": 0, "creation_date": 1504854552, "post_id": 46075480, "comment_id": 79183611, "body": "@JoannaM: I&#39;ve added a link to a book in my answer that I think is good for diving into XDR: <a href=\"https://rads.stackoverflow.com/amzn/click/com/0937175773\" rel=\"nofollow noreferrer\" rel=\"nofollow noreferrer\">Power Programming with RPC by John Bloomer</a>."}], "tags": [], "owner": {"reputation": 4827, "user_id": 8051589, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8VNG6.png?s=128&g=1", "display_name": "Andre Kampling", "link": "https://stackoverflow.com/users/8051589/andre-kampling"}, "is_accepted": true, "score": 0, "last_activity_date": 1504854486, "last_edit_date": 1504854486, "creation_date": 1504701481, "answer_id": 46075480, "question_id": 46073563, "link": "https://stackoverflow.com/questions/46073563/how-to-use-generated-xdr-structures-from-x-file-memory-allocation/46075480#46075480", "title": "How to use generated XDR structures from .x file (memory allocation)", "body": "<p>To answer this question it is easier to take a look at the types: <code>tagtype</code>, <code>file</code>, <code>filename</code> and <code>message</code> that rpcgen generates from your .x file. They are located in your <code>xdr_types.h</code> which you didn't include in your question so I used rpcgen with your .x file. The important ones are <code>file</code> and <code>message</code>:</p>\n\n<pre><code>...\n\nstruct file {\n   struct {\n      u_int contents_len;\n      char *contents_val;\n   } contents;\n   u_int last_mod_time;\n};\ntypedef struct file file;\n\ntypedef char *filename;\n\nstruct message {\n   tagtype tag;\n   union {\n      struct {\n         u_int filenamedata_len;\n         filename *filenamedata_val;\n      } filenamedata;\n      struct {\n         u_int fdata_len;\n         struct file *fdata_val;\n      } fdata;\n   } message_u;\n};\ntypedef struct message message;\n\n...\n</code></pre>\n\n<p>To answer your 2 questions:</p>\n\n<blockquote>\n  <p>If I had to only send one file in a message, I would do:</p>\n\n<pre><code>response.message_u.fdata.last_mod_time         = last_modification;\nresponse.message_u.fdata.contents.contents_len = file_size;\nresponse.message_u.fdata.contents.contents_val = buffer;\n</code></pre>\n  \n  <p>With buffer being:</p>\n\n<pre><code>buffer = malloc(file_size * sizeof(char));\n</code></pre>\n</blockquote>\n\n<p>and </p>\n\n<blockquote>\n  <p>And the other question how to I refer to each file structure:</p>\n\n<pre><code>response.message_u.fdata[0]                        //?\nresponse.message_u.fdata.last_mod_time[0]          //?\nresponse.message_u.fdata[0].last_mod_time          //?\nresponse.message_u.fdata.contents.contents_len[0]  //?\nresponse.message_u.fdata.contents.contents_val[0]  //?\n</code></pre>\n</blockquote>\n\n<p>No, the part after <code>response.message_u.fdata.</code> is wrong. It can either be:</p>\n\n<pre><code>response.message_u.fdata.fdata_len\n</code></pre>\n\n<p>or</p>\n\n<pre><code>response.message_u.fdata.fdata_val\n</code></pre>\n\n<p>and you mean the 2nd variant which is <code>struct file *fdata_val;</code>. And for that part you have to allocate memory.</p>\n\n<p>The following example is for 2 files which will also answer your question about how to refer to the data:</p>\n\n<pre><code>// Set variables and allocate space for 2 file structures\nmessage response;\nu_int no_files      = 2;\nu_int file_size     = 1024;\nu_int last_mod_time = 42;\nresponse.message_u.fdata.fdata_len = no_files;\nresponse.message_u.fdata.fdata_val = malloc(no_files * sizeof(struct file));\n\n// Access 1st file and allocate space for file content\nresponse.message_u.fdata.fdata_val[0].last_mod_time         = last_modification;\nresponse.message_u.fdata.fdata_val[0].contents.contents_len = file_size;\nresponse.message_u.fdata.fdata_val[0].contents.contents_val = malloc(file_size * sizeof(char));\n\n// Access 2nd file and allocate space for file content\nresponse.message_u.fdata.fdata_val[1].last_mod_time         = last_modification;\nresponse.message_u.fdata.fdata_val[1].contents.contents_len = file_size;\nresponse.message_u.fdata.fdata_val[1].contents.contents_val = malloc(file_size * sizeof(char));\n</code></pre>\n\n<hr>\n\n<p>To learn more about the relationship between the XDR specification language and the generated C output this answer on SO: <a href=\"https://stackoverflow.com/a/26625494/8051589\">Understanding XDR specification to create a *.x file</a> is helpful.</p>\n\n<p>Further there is a nice book <a href=\"https://rads.stackoverflow.com/amzn/click/com/0937175773\" rel=\"nofollow noreferrer\" rel=\"nofollow noreferrer\"><em>Power Programming with RPC by John Bloomer</em></a>, it's quite old (1991) but the Remote Procedure Call protocol is it too. This book is about the RPC protocol that uses the XDR for sending/receiving data. The XDR language (using rpcgen, filter functions, etc.) is very well described in that book.</p>\n\n<blockquote>\n  <p>Below are some XDR specifications:</p>\n  \n  <p><img src=\"https://i.stack.imgur.com/u2Zmy.png\" alt=\"xdr specification language taken from link provided above\"></p>\n</blockquote>\n"}], "owner": {"reputation": 13, "user_id": 8497213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a78eadeb9d1cc69cbd16cb6e606086b6?s=128&d=identicon&r=PG&f=1", "display_name": "JoannaM", "link": "https://stackoverflow.com/users/8497213/joannam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 385, "favorite_count": 0, "accepted_answer_id": 46075480, "answer_count": 1, "score": 0, "last_activity_date": 1504854486, "creation_date": 1504695836, "last_edit_date": 1504771749, "question_id": 46073563, "link": "https://stackoverflow.com/questions/46073563/how-to-use-generated-xdr-structures-from-x-file-memory-allocation", "title": "How to use generated XDR structures from .x file (memory allocation)", "body": "<p>I would please like some help with this case.</p>\n\n<p>I need to send <em>one XDR message</em>, that it's composed by <em>2 files</em> (<strong>switch case == OK</strong>).</p>\n\n<p>Assuming I have in my code a <code>message</code> object called <code>response</code>:</p>\n\n<pre><code>message response;\n</code></pre>\n\n<p>If I had to only send one file in a message, I would do:</p>\n\n<pre><code>response.message_u.fdata.last_mod_time         = last_modification;\nresponse.message_u.fdata.contents.contents_len = file_size;\nresponse.message_u.fdata.contents.contents_val = buffer;\n</code></pre>\n\n<p>With buffer being:</p>\n\n<pre><code>buffer = malloc(file_size * sizeof(char));\n</code></pre>\n\n<p>Now, I understand that <code>struct file fdata&lt;2&gt;;</code> it's a variable size array (2 is the max length) and that I would have them index as <code>something[0]</code> and <code>something[1]</code>. </p>\n\n<p>Also I know I need to allocate memory, but I do not know how to do this in this case with multiple files.</p>\n\n<p>Do I need to do one single malloc for everything I need to send? Something like this:</p>\n\n<pre><code>response.message_u.fdata.fdata_val = malloc ( (file_size1 * sizeof(char)) + (file_size2 * sizeof(char)) + (2 * sizeof(uint32_t)));   \n</code></pre>\n\n<p><code>(2 * sizeof(uint32_t))</code>: one <em>last_mod_time</em> for each file to send</p>\n\n<p>And the other question how to I refer to each file structure:</p>\n\n<pre><code>response.message_u.fdata[0]                        //?\nresponse.message_u.fdata.last_mod_time[0]          //?\nresponse.message_u.fdata[0].last_mod_time          //?\nresponse.message_u.fdata.contents.contents_len[0]  //?\nresponse.message_u.fdata.contents.contents_val[0]  //?\n</code></pre>\n\n<p>The .x file:</p>\n\n<pre><code>enum tagtype {\n    GET  = 0,\n    OK   = 1,\n    QUIT = 2,\n    ERR  = 3\n};\n\nstruct file {\n    opaque contents&lt;&gt;;\n    unsigned int last_mod_time;\n};\n\ntypedef string filename&lt;256&gt;;\n\nunion message switch (tagtype tag) {\n    case GET:\n        filename filenamedata&lt;2&gt;;\n    case OK:\n        struct file fdata&lt;2&gt;;\n    case QUIT:\n        void;\n    case ERR:\n        void;\n};\n</code></pre>\n\n<p>The types.c (generated with rpcgen):    </p>\n\n<pre><code>#include \"xdr_types.h\"\n\nbool_t\nxdr_tagtype (XDR *xdrs, tagtype *objp)\n{\n    register int32_t *buf;\n\n    if (!xdr_enum (xdrs, (enum_t *) objp))\n         return FALSE;\n    return TRUE;\n}\n\nbool_t\nxdr_file (XDR *xdrs, file *objp)\n{\n    register int32_t *buf;\n\n    if (!xdr_bytes (xdrs, (char **)&amp;objp-&gt;contents.contents_val, (u_int *) &amp;objp-&gt;contents.contents_len, ~0))\n        return FALSE;\n    if (!xdr_u_int (xdrs, &amp;objp-&gt;last_mod_time))\n        return FALSE;\n    return TRUE;\n}\n\n\nbool_t\nxdr_filename (XDR *xdrs, filename *objp)\n{\n    register int32_t *buf;\n\n    if (!xdr_string (xdrs, objp, 256))\n         return FALSE;\n    return TRUE;\n}\n\nbool_t\nxdr_message (XDR *xdrs, message *objp)\n{\n     register int32_t *buf;\n\n     if (!xdr_tagtype (xdrs, &amp;objp-&gt;tag))\n         return FALSE;\n\n    switch (objp-&gt;tag) {\n        case GET:\n            if (!xdr_array (xdrs, (char **)&amp;objp-&gt;message_u.filenamedata.filenamedata_val, (u_int *) &amp;objp-&gt;message_u.filenamedata.filenamedata_len, 10,\n            sizeof (filename), (xdrproc_t) xdr_filename))\n            return FALSE;\n            break;\n        case OK:\n            if (!xdr_array (xdrs, (char **)&amp;objp-&gt;message_u.fdata.fdata_val, (u_int *) &amp;objp-&gt;message_u.fdata.fdata_len, 10, sizeof (file), (xdrproc_t) xdr_file))\n             return FALSE;\n            break;\n        case QUIT:\n            break;\n        case ERR:\n            break;\n        default:\n            return FALSE;\n    }\n    return TRUE;\n}\n</code></pre>\n\n<p>Thank you for reading this, and trying to understand this. I really appreciate it.</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["c", "type-conversion", "implicit-conversion"], "comments": [{"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 3, "creation_date": 1504701679, "post_id": 46073295, "comment_id": 79111940, "body": "I suggest documenting the assumptions for the examples, e.g. example 3 assumes that <code>short</code> is narrower than <code>int</code> (or in other words, it assumes that <code>int</code> can represent all the values of <code>unsigned short</code>)."}, {"owner": {"reputation": 491, "user_id": 8509272, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/487ff5fe4697aeb326fa5092ef38f116?s=128&d=identicon&r=PG&f=1", "display_name": "savram", "link": "https://stackoverflow.com/users/8509272/savram"}, "edited": false, "score": 0, "creation_date": 1504710919, "post_id": 46073295, "comment_id": 79119113, "body": "Wait a sec the OP is the same guy who answered the question? It says Lundin asked, best answer is Lundin&#39;s as well lol"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 491, "user_id": 8509272, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/487ff5fe4697aeb326fa5092ef38f116?s=128&d=identicon&r=PG&f=1", "display_name": "savram", "link": "https://stackoverflow.com/users/8509272/savram"}, "edited": false, "score": 3, "creation_date": 1504765909, "post_id": 46073295, "comment_id": 79140258, "body": "@savram Yes, the intention is to write a FAQ entry. Sharing knowledge this way is fine for SO - next time you post a question note the checkbox &quot;answer your own question&quot;. But of course the question is still treated like any other question and others can post answers too. (And you don&#39;t earn any rep from accepting your own answer)"}, {"owner": {"reputation": 4827, "user_id": 8051589, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8VNG6.png?s=128&g=1", "display_name": "Andre Kampling", "link": "https://stackoverflow.com/users/8051589/andre-kampling"}, "reply_to_user": {"reputation": 491, "user_id": 8509272, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/487ff5fe4697aeb326fa5092ef38f116?s=128&d=identicon&r=PG&f=1", "display_name": "savram", "link": "https://stackoverflow.com/users/8509272/savram"}, "edited": false, "score": 0, "creation_date": 1504786016, "post_id": 46073295, "comment_id": 79153510, "body": "@savram: It is absolutely fine to share knowledge this way. See <a href=\"https://stackoverflow.com/help/self-answer\">here: self answer</a>."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1566337532, "post_id": 46073295, "comment_id": 101623205, "body": "Neither answer so far mentions the fact that <code>printf(&quot;%u\\n&quot;, x - y);</code> causes undefined behaviour"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1566370092, "post_id": 46073295, "comment_id": 101629690, "body": "@M.M I changed it to <code>%d</code>, happy now? Also, I&#39;d rather not drag the odd &quot;default argument promotions&quot; into this post, they are left out on purpose, not to confuse the reader with language rules of peripheral interest."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1566428242, "post_id": 46073295, "comment_id": 101657390, "body": "@Lundin No, not happy now. The first code snippet after your edit will print <code>-1</code> on most implementations yet you ask &quot;Why does this give a strange, large integer number and not 255?&quot;  This is relevant to the topic because it&#39;s a catch-22 of sorts: you can&#39;t know what format specifier to use until you understand the promotion rules."}, {"owner": {"reputation": 3561, "user_id": 2511795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30c869f55cbcf82a7bc4536d563daa0a?s=128&d=identicon&r=PG", "display_name": "0andriy", "link": "https://stackoverflow.com/users/2511795/0andriy"}, "edited": false, "score": 1, "creation_date": 1582641502, "post_id": 46073295, "comment_id": 106842291, "body": "Nice example is <code>~((u8)(1 &lt;&lt; 7))</code> to the list."}], "answers": [{"comments": [{"owner": {"reputation": 343905, "user_id": 4279, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/d92ce60d3a4cbe03598e27c2e8dee69d?s=128&d=identicon&r=PG", "display_name": "jfs", "link": "https://stackoverflow.com/users/4279/jfs"}, "edited": false, "score": 0, "creation_date": 1510918290, "post_id": 46073296, "comment_id": 81651178, "body": "<i>&quot;Whenever a small integer type is used in an expression, it is implicitly converted to int which is always signed.&quot;</i> Could you point to the exact place in the standard that says that it <i>should</i> happen? The C11 6.3.1.1 quote says <i>how</i> it happens (if it happens) but it doesn&#39;t say that it <i>must</i> happen e.g., why <code>x - y</code> in the question behaves as <code>(unsigned)(int)((int)x - (int)y)</code> instead of <code>(unsigned)(int)((Uchar)((Uchar)x - (Uchar)y))</code> goo.gl/nCvJy5 . Where does the standard says that if <code>x</code> is char then <code>+x</code> is <code>int</code> (or unsigned)? In c++ it is &#167;5.3.1.7 goo.gl/FkEakX"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 343905, "user_id": 4279, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/d92ce60d3a4cbe03598e27c2e8dee69d?s=128&d=identicon&r=PG", "display_name": "jfs", "link": "https://stackoverflow.com/users/4279/jfs"}, "edited": false, "score": 0, "creation_date": 1510921633, "post_id": 46073296, "comment_id": 81653226, "body": "@jfs For binary operators where the usual arithmetic conversions apply, the &quot;should&quot; part is included as part of those rules, quoted above. For other operators, they are promoted if the specific operator (chap 6.5) requires it. Take for example the unary <code>-</code> operator, 6.5.3.3: &quot;The result of the unary - operator is the negative of its (promoted) operand. The integer promotions are performed on the operand, and the result has the promoted type.&quot;. Another example (special case) is the prefix <code>++</code>, which does not mention integer promotion, and therefore its operand is not promoted."}, {"owner": {"reputation": 343905, "user_id": 4279, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/d92ce60d3a4cbe03598e27c2e8dee69d?s=128&d=identicon&r=PG", "display_name": "jfs", "link": "https://stackoverflow.com/users/4279/jfs"}, "edited": false, "score": 0, "creation_date": 1510923633, "post_id": 46073296, "comment_id": 81654435, "body": "@Lundin <i>&#171;the &quot;should&quot; part is included as part of those rules&#187;</i> I don&#39;t see it. Could you provide a specific quote from the standard that says that operands of the <b>same</b> small integer type are promoted while performing a binary operation such as <code>x-y</code>? (in other words that there is no <code>(char)-(char)</code> operator only <code>(int)-(int)</code> or wider \u2014 It is true as far as I know). c11  6.5.6/4 points to 6.3.1.8/1 which says &quot;the purpose  is to determine common real type&quot; but if operands are already of  the <i>same</i> type, it is not explicit that any conversation <i>should</i> be performed."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 343905, "user_id": 4279, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/d92ce60d3a4cbe03598e27c2e8dee69d?s=128&d=identicon&r=PG", "display_name": "jfs", "link": "https://stackoverflow.com/users/4279/jfs"}, "edited": false, "score": 0, "creation_date": 1510928068, "post_id": 46073296, "comment_id": 81657360, "body": "@jfs &quot;Otherwise, ...&quot; (if neither operand is float type) &quot;...the integer promotions are performed on both operands.&quot; . And then afterwards &quot;If both operands have the same type, then no further conversion is needed.&quot;"}, {"owner": {"reputation": 343905, "user_id": 4279, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/d92ce60d3a4cbe03598e27c2e8dee69d?s=128&d=identicon&r=PG", "display_name": "jfs", "link": "https://stackoverflow.com/users/4279/jfs"}, "edited": false, "score": 0, "creation_date": 1510928528, "post_id": 46073296, "comment_id": 81657679, "body": "@Lundin yes, I&#39;ve seen it and I interpret it the same way but I hoped there is something more explicit: it is clear that <b>if</b> the usual arithmetic conversions are performed then the operands such as x,y are <i>promoted</i> but it is not very explicit whether the conversions <i>must</i> be performed if the operands have the <i>same</i> type already."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 343905, "user_id": 4279, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/d92ce60d3a4cbe03598e27c2e8dee69d?s=128&d=identicon&r=PG", "display_name": "jfs", "link": "https://stackoverflow.com/users/4279/jfs"}, "edited": false, "score": 0, "creation_date": 1510929201, "post_id": 46073296, "comment_id": 81658135, "body": "@jfs It is perfectly clear to me. 6.5.6/4 explicitly says, black on white in normative text, that the usual arithmetic conversions have to be performed: &quot;If both operands have arithmetic type, the usual arithmetic conversions are performed on them.&quot;"}, {"owner": {"reputation": 343905, "user_id": 4279, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/d92ce60d3a4cbe03598e27c2e8dee69d?s=128&d=identicon&r=PG", "display_name": "jfs", "link": "https://stackoverflow.com/users/4279/jfs"}, "edited": false, "score": 0, "creation_date": 1510929842, "post_id": 46073296, "comment_id": 81658531, "body": "@Lundin yes, I explicitly mentioned it above. The unclear part: &quot;the purpose is to determine the <i>common real type</i>&quot; i.e., if the operands <i>already</i> have the <i>same</i> type then it might be interpreted  that the conversions are a no-op \u2014 I know that it is not actually so e.g., <code>(char)+(char)</code> is always promoted to <code>(int)+(int)</code> (or unsigned)."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 343905, "user_id": 4279, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/d92ce60d3a4cbe03598e27c2e8dee69d?s=128&d=identicon&r=PG", "display_name": "jfs", "link": "https://stackoverflow.com/users/4279/jfs"}, "edited": false, "score": 0, "creation_date": 1510929964, "post_id": 46073296, "comment_id": 81658615, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/159241/discussion-between-lundin-and-jfs\">continue this discussion in chat</a>."}, {"owner": {"reputation": 11225, "user_id": 471129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cec5a6cce700294c7c564becb11fa3c1?s=128&d=identicon&r=PG", "display_name": "Erik Eidt", "link": "https://stackoverflow.com/users/471129/erik-eidt"}, "edited": false, "score": 1, "creation_date": 1546626726, "post_id": 46073296, "comment_id": 94924146, "body": "&quot;Example 1 could be fixed by casting one or both operands to type unsigned int.&quot;  The suggested cast(s) won&#39;t yield 255 as the OP expected.  The proper fix is to cast the result of the subtraction back to the <code>(unsigned char)</code> that the operands started from, as in <code>(unsigned char) (x-y)</code>: this will give the OP the expected 255.  People often fail to appreciate casting to a smaller size, however, this is the proper way to accomplish truncation (which will be followed by implicit/automatic signed or zero extension to ~int size)."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 11225, "user_id": 471129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cec5a6cce700294c7c564becb11fa3c1?s=128&d=identicon&r=PG", "display_name": "Erik Eidt", "link": "https://stackoverflow.com/users/471129/erik-eidt"}, "edited": false, "score": 0, "creation_date": 1546847351, "post_id": 46073296, "comment_id": 94973492, "body": "@ErikEidt Yes it would, as you get unsigned int wrap-around and then an implicit conversion back to unsigned char. The danger with casting after the operation is that the bug could already have struck. Suppose for example that you have <code>x &lt;&lt; y</code> instead. Undefined behavior of shifting beyond the size of <code>x</code> could occur and then no cast afterwards will save the program. The pedantic version (MISRA-C compliance etc) will cast both before the operation and afterwards, so that no implicit conversions occur at all."}, {"owner": {"reputation": 759, "user_id": 5798750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c14e106219286951ff4d1dff364b5813?s=128&d=identicon&r=PG", "display_name": "Student", "link": "https://stackoverflow.com/users/5798750/student"}, "edited": false, "score": 0, "creation_date": 1551017876, "post_id": 46073296, "comment_id": 96477257, "body": "1) The standard quote says <i>&quot;The rank of any standard integer type shall be <b>greater than</b> the rank of any extended integer type with the same width.&quot;</i>. Then <i>&quot;For example, <code>int32_t</code> has the <b>same rank</b> as <code>int</code> on a 32-bit system.&quot;</i>. 2) <i>&quot;Example 1 could be fixed by casting <b>one or both operands</b> to type <b><code>unsigned int</code></b>.&quot;</i> this won&#39;t work."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 759, "user_id": 5798750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c14e106219286951ff4d1dff364b5813?s=128&d=identicon&r=PG", "display_name": "Student", "link": "https://stackoverflow.com/users/5798750/student"}, "edited": false, "score": 0, "creation_date": 1551026908, "post_id": 46073296, "comment_id": 96479843, "body": "@Student 1) The stdint.h aren&#39;t the &quot;extended integer types&quot;, but rather typedefs corresponding to the standard integer types. &quot;Extended integer types&quot; refers to the case where an implementation (compiler) decides to invent its own integer types - which is allowed. 2) Sure it will, what makes you think otherwise?"}, {"owner": {"reputation": 759, "user_id": 5798750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c14e106219286951ff4d1dff364b5813?s=128&d=identicon&r=PG", "display_name": "Student", "link": "https://stackoverflow.com/users/5798750/student"}, "edited": false, "score": 0, "creation_date": 1551032771, "post_id": 46073296, "comment_id": 96481661, "body": "1) While reading the <i>Integer types and conversion rank</i> section, after some search I stumbled upon this post [<a href=\"https://stackoverflow.com/questions/48011642/]\">stackoverflow.com/questions/48011642/]</a> where the OP mentioned <i>&quot;[...]So the rank of <code>int32_t</code> is lower than that of <code>int</code>.&quot;</i>. That made me puzzle. 2) I was testing the examples here: <a href=\"https://rextester.com/BUNN55540\" rel=\"nofollow noreferrer\">rextester.com/BUNN55540</a>"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 759, "user_id": 5798750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c14e106219286951ff4d1dff364b5813?s=128&d=identicon&r=PG", "display_name": "Student", "link": "https://stackoverflow.com/users/5798750/student"}, "edited": false, "score": 1, "creation_date": 1551080549, "post_id": 46073296, "comment_id": 96493578, "body": "@Student Ah now I get it, the explanation&#39;s expectation doesn&#39;t match the proposed solution indeed. Updated, thanks."}, {"owner": {"reputation": 5335, "user_id": 1951907, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/G33Xj.jpg?s=128&g=1", "display_name": "Boris Dalstein", "link": "https://stackoverflow.com/users/1951907/boris-dalstein"}, "edited": false, "score": 0, "creation_date": 1578950385, "post_id": 46073296, "comment_id": 105599080, "body": "@Lundin Thank you for this excellent piece of knowledge! Do you happen to know whether C++ applies the same rules?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 5335, "user_id": 1951907, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/G33Xj.jpg?s=128&g=1", "display_name": "Boris Dalstein", "link": "https://stackoverflow.com/users/1951907/boris-dalstein"}, "edited": false, "score": 0, "creation_date": 1578987210, "post_id": 46073296, "comment_id": 105607928, "body": "@BorisDalstein C++ is pretty much identical."}, {"owner": {"reputation": 5335, "user_id": 1951907, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/G33Xj.jpg?s=128&g=1", "display_name": "Boris Dalstein", "link": "https://stackoverflow.com/users/1951907/boris-dalstein"}, "edited": false, "score": 0, "creation_date": 1579015543, "post_id": 46073296, "comment_id": 105622379, "body": "@Lundin Thank you!"}, {"owner": {"reputation": 36931, "user_id": 225757, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/e7140b12949e4652885f6bb02b435f42?s=128&d=identicon&r=PG", "display_name": "Roland Illig", "link": "https://stackoverflow.com/users/225757/roland-illig"}, "edited": false, "score": 0, "creation_date": 1591968775, "post_id": 46073296, "comment_id": 110263377, "body": "The &quot;whenever&quot; below the heading &quot;usual arithmetic conversions&quot; does not apply to the binary shift operators."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 36931, "user_id": 225757, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/e7140b12949e4652885f6bb02b435f42?s=128&d=identicon&r=PG", "display_name": "Roland Illig", "link": "https://stackoverflow.com/users/225757/roland-illig"}, "edited": false, "score": 0, "creation_date": 1591969202, "post_id": 46073296, "comment_id": 110263579, "body": "@RolandIllig The detailed story is that each and every operator chapter in the standard tells explicitly which promotions it uses. The shift ones are indeed among the special cases, that only integer promote the left operand and use the promoted type as the result of the expression."}], "tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": true, "score": 109, "last_activity_date": 1566857943, "last_edit_date": 1566857943, "creation_date": 1504695025, "answer_id": 46073296, "question_id": 46073295, "link": "https://stackoverflow.com/questions/46073295/implicit-type-promotion-rules/46073296#46073296", "title": "Implicit type promotion rules", "body": "<p>C was designed to implicitly and silently change the integer types of the operands used in expressions. There exist several cases where the language forces the compiler to either change the operands to a larger type, or to change their signedness. </p>\n\n<p>The rationale behind this is to prevent accidental overflows during arithmetic, but also to allow operands with different signedness to co-exist in the same expression.</p>\n\n<p>Unfortunately, the rules for implicit type promotion cause much more harm than good, to the point where they might be one of the biggest flaws in the C language. These rules are often not even known by the average C programmer and therefore causing all manner of very subtle bugs. </p>\n\n<p>Typically you see scenarios where the programmer says \"just cast to type x and it works\" - but they don't know why. Or such bugs manifest themselves as rare, intermittent phenomenon striking from within seemingly simple and straight-forward code. Implicit promotion is particularly troublesome in code doing bit manipulations, since most bit-wise operators in C come with poorly-defined behavior when given a signed operand.</p>\n\n<hr>\n\n<h2><strong>Integer types and conversion rank</strong></h2>\n\n<p>The integer types in C are <code>char</code>, <code>short</code>, <code>int</code>, <code>long</code>, <code>long long</code> and <code>enum</code>.<br>\n<code>_Bool</code>/<code>bool</code> is also treated as an integer type when it comes to type promotions. </p>\n\n<p>All integers have a specified <em>conversion rank</em>. C11 6.3.1.1, emphasis mine on the most important parts:</p>\n\n<blockquote>\n  <p>Every integer type has an integer conversion rank defined as follows:<br>\n  \u2014 No two signed integer types shall have the same rank, even if they have the same representation.<br>\n  \u2014 The rank of a signed integer type shall be greater than the rank of any signed integer type with less precision.<br>\n  <strong>\u2014 The rank of <code>long long int</code> shall be greater than the rank of <code>long int</code>, which shall be greater than the rank of <code>int</code>, which shall be greater than the rank of <code>short int</code>, which shall be greater than the rank of <code>signed char</code>.<br>\n  \u2014 The rank of any unsigned integer type shall equal the rank of the corresponding signed integer type, if any.</strong><br>\n  \u2014 The rank of any standard integer type shall be greater than the rank of any extended integer type with the same width.<br>\n  \u2014 The rank of char shall equal the rank of signed char and unsigned char.<br>\n  \u2014 The rank of _Bool shall be less than the rank of all other standard integer types.<br>\n  \u2014 The rank of any enumerated type shall equal the rank of the compatible integer type (see 6.7.2.2).  </p>\n</blockquote>\n\n<p>The types from <code>stdint.h</code> sort in here too, with the same rank as whatever type they happen to correspond to on the given system. For example, <code>int32_t</code> has the same rank as <code>int</code> on a 32 bit system.</p>\n\n<p>Further, C11 6.3.1.1 specifies which types that are regarded as the <em>small integer types</em> (not a formal term):</p>\n\n<blockquote>\n  <p>The following may be used in an expression wherever an <code>int</code> or <code>unsigned int</code> may\n  be used:  </p>\n  \n  <p>\u2014 An object or expression with an integer type (other than <code>int</code> or <code>unsigned int</code>) whose integer conversion rank is less than or equal to the rank of <code>int</code> and <code>unsigned int</code>.</p>\n</blockquote>\n\n<p>What this somewhat cryptic text means in practice, is that <code>_Bool</code>, <code>char</code> and <code>short</code> (and also <code>int8_t</code>, <code>uint8_t</code> etc) are the \"small integer types\". These are treated in special ways and subject to implicit promotion, as explained below.</p>\n\n<hr>\n\n<h2><strong>The integer promotions</strong></h2>\n\n<p>Whenever a small integer type is used in an expression, it is implicitly converted to <code>int</code> which is always signed. This is known as the <em>integer promotions</em> or <em>the integer promotion rule</em>.</p>\n\n<p>Formally, the rule says (C11 6.3.1.1):</p>\n\n<blockquote>\n  <p>If an <code>int</code> can represent all values of the original type (as restricted by the width, for a bit-field), the value is converted to an <code>int</code>; otherwise, it is converted to an <code>unsigned int</code>. These are called the <em>integer promotions</em>. </p>\n</blockquote>\n\n<p>This means that all small integer types, no matter signedness, get implicitly converted to (signed) <code>int</code> when used in most expressions.</p>\n\n<p>This text is often misunderstood as: \"all small, signed integer types are converted to signed int and all small, unsigned integer types are converted to unsigned int\". This is incorrect. The unsigned part here only means that if we have for example an <code>unsigned short</code> operand, and <code>int</code> happens to have the same size as <code>short</code> on the given system, then the <code>unsigned short</code> operand is converted to <code>unsigned int</code>. As in, nothing of note really happens. But in case <code>short</code> is a smaller type than <code>int</code>, it is always converted to (signed) <code>int</code>, <em>regardless of it the short was signed or unsigned</em>!</p>\n\n<p>The harsh reality caused by the integer promotions means that almost no operation in C can be carried out on small types like <code>char</code> or <code>short</code>. Operations are always carried out on <code>int</code> or larger types. </p>\n\n<p>This might sound like nonsense, but luckily the compiler is allowed to optimize the code. For example, an expression containing two <code>unsigned char</code> operands would get the operands promoted to <code>int</code> and the operation carried out as <code>int</code>. But the compiler is allowed to optimize the expression to actually get carried out as an 8 bit operation, as would be expected. However, here comes the problem: the compiler is <em>not</em> allowed to optimize out the implicit change of signedness caused by the integer promotion. Because there is no way for the compiler to tell if the programmer is purposely relying on implicit promotion to happen, or if it is unintentional.</p>\n\n<p>This is why example 1 in the question fails. Both unsigned char operands are promoted to type <code>int</code>, the operation is carried out on type <code>int</code>, and the result of <code>x - y</code> is of type <code>int</code>. Meaning that we get <code>-1</code> instead of <code>255</code> which might have been expected. The compiler may generate machine code that executes the code with 8 bit instructions instead of <code>int</code>, but it may not optimize out the change of signedness. Meaning that we end up with a negative result, that in turn results in a weird number when <code>printf(\"%u</code> is invoked. Example 1 could be fixed by casting the result of the operation back to type <code>unsigned char</code>.</p>\n\n<p>With the exception of a few special cases like <code>++</code> and <code>sizeof</code> operators, the integer promotions apply to almost all operations in C, no matter if unary, binary (or ternary) operators are used. </p>\n\n<hr>\n\n<h2><strong>The usual arithmetic conversions</strong></h2>\n\n<p>Whenever a binary operation (an operation with 2 operands) is done in C, both operands of the operator have to be of the same type. Therefore, in case the operands are of different types, C enforces an implicit conversion of one operand to the type of the other operand. The rules for how this is done are named <em>the usual artihmetic conversions</em> (sometimes informally referred to as \"balancing\"). These are specified in C11 6.3.18:</p>\n\n<p>(Think of this rule as a long, nested <code>if-else if</code> statement and it might be easier to read :) )</p>\n\n<blockquote>\n  <p>6.3.1.8 Usual arithmetic conversions</p>\n  \n  <p>Many operators that expect operands of arithmetic type cause conversions and yield result\n  types in a similar way. The purpose is to determine a common real type for the operands\n  and result. For the specified operands, each operand is converted, without change of type\n  domain, to a type whose corresponding real type is the common real type. Unless\n  explicitly stated otherwise, the common real type is also the corresponding real type of\n  the result, whose type domain is the type domain of the operands if they are the same,\n  and complex otherwise. This pattern is called <em>the usual arithmetic conversions</em>:</p>\n  \n  <ul>\n  <li>First, if the corresponding real type of either operand is <code>long double</code>, the other operand is converted, without change of type domain, to a type whose corresponding real type is <code>long double</code>.</li>\n  <li>Otherwise, if the corresponding real type of either operand is <code>double</code>, the other operand is converted, without change of type domain, to a type whose corresponding real type is <code>double</code>.</li>\n  <li>Otherwise, if the corresponding real type of either operand is <code>float</code>, the other operand is converted, without change of type domain, to a type whose corresponding real type is float.</li>\n  <li><p>Otherwise, the integer promotions are performed on both operands. Then the\n  following rules are applied to the promoted operands:</p>\n  \n  <ul>\n  <li>If both operands have the same type, then no further conversion is needed.</li>\n  <li>Otherwise, if both operands have signed integer types or both have unsigned\n  integer types, the operand with the type of lesser integer conversion rank is\n  converted to the type of the operand with greater rank.</li>\n  <li>Otherwise, if the operand that has unsigned integer type has rank greater or\n  equal to the rank of the type of the other operand, then the operand with\n  signed integer type is converted to the type of the operand with unsigned\n  integer type.</li>\n  <li>Otherwise, if the type of the operand with signed integer type can represent\n  all of the values of the type of the operand with unsigned integer type, then\n  the operand with unsigned integer type is converted to the type of the\n  operand with signed integer type.</li>\n  <li>Otherwise, both operands are converted to the unsigned integer type\n  corresponding to the type of the operand with signed integer type.</li>\n  </ul></li>\n  </ul>\n</blockquote>\n\n<p>Notable here is that the usual arithmetic conversions apply to both floating point and integer variables. In case of integers, we can also note that the integer promotions are invoked from within the usual arithmetic conversions. And after that, when both operands have at least the rank of <code>int</code>, the operators are balanced to the same type, with the same signedness.</p>\n\n<p>This is the reason why <code>a + b</code> in example 2 gives a strange result. Both operands are integers and they are at least of rank <code>int</code>, so the integer promotions do not apply. The operands are not of the same type - <code>a</code> is <code>unsigned int</code> and <code>b</code> is <code>signed int</code>. Therefore the operator <code>b</code> is temporarily converted to type <code>unsigned int</code>. During this conversion it loses the sign information and ends up as a large value.</p>\n\n<p>The reason why changing type to <code>short</code> in example 3 fixes the problem, is because <code>short</code> is a small integer type. Meaning that both operands are integer promoted to type <code>int</code> which is signed. After integer promotion, both operands have the same type (<code>int</code>), no further conversion is needed. And then the operation can be carried out on a signed type as expected.</p>\n"}, {"comments": [{"owner": {"reputation": 521, "user_id": 514514, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bae5143216d0c560304a06da1a31739?s=128&d=identicon&r=PG", "display_name": "Cheshar", "link": "https://stackoverflow.com/users/514514/cheshar"}, "edited": false, "score": 1, "creation_date": 1559750579, "post_id": 51086974, "comment_id": 99519902, "body": "Your fix to Example 2 <code>signed int c = a+b;</code> above invokes UB. The resultant type of a+b is unsigned, and the computed value is out of range of a signed integer."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 521, "user_id": 514514, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bae5143216d0c560304a06da1a31739?s=128&d=identicon&r=PG", "display_name": "Cheshar", "link": "https://stackoverflow.com/users/514514/cheshar"}, "edited": false, "score": 1, "creation_date": 1566337413, "post_id": 51086974, "comment_id": 101623181, "body": "@Cheshar out-of-range assignment is not UB"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1566337641, "post_id": 51086974, "comment_id": 101623230, "body": "many of the examples in this answer cause UB by using the wrong format specifier, and also it makes an unwarranted assumption about the size of an <code>int</code>"}, {"owner": {"reputation": 521, "user_id": 514514, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bae5143216d0c560304a06da1a31739?s=128&d=identicon&r=PG", "display_name": "Cheshar", "link": "https://stackoverflow.com/users/514514/cheshar"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1566494910, "post_id": 51086974, "comment_id": 101683796, "body": "@M.M My bad! Agree, it should have been &quot;<i>implementation-defined or an implementation-defined signal raised</i>&quot;. Signed overflow is UB though. It&#39;s easier to lose track of UB/IB."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 521, "user_id": 514514, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bae5143216d0c560304a06da1a31739?s=128&d=identicon&r=PG", "display_name": "Cheshar", "link": "https://stackoverflow.com/users/514514/cheshar"}, "edited": false, "score": 0, "creation_date": 1567895441, "post_id": 51086974, "comment_id": 102103955, "body": "@Cheshar: Contrary to myth spread by some compiler maintainers, the Standard&#39;s term for actions which should be processed identically by 99.9% of implementations, but which need not be processed meaningfully by implementations where that would be impractical, is &quot;Undefined Behavior&quot;.  The term IDB is only used for actions which <i>all</i> implementations are supposed to process meaningfully."}], "tags": [], "owner": {"reputation": 119, "user_id": 7232719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/086b91dd41edc94c4ef5f7c205db6522?s=128&d=identicon&r=PG&f=1", "display_name": "Lusha Li", "link": "https://stackoverflow.com/users/7232719/lusha-li"}, "is_accepted": false, "score": 5, "last_activity_date": 1530200810, "creation_date": 1530200810, "answer_id": 51086974, "question_id": 46073295, "link": "https://stackoverflow.com/questions/46073295/implicit-type-promotion-rules/51086974#51086974", "title": "Implicit type promotion rules", "body": "<p>According to the previous post, I want to give more information about each example.</p>\n\n<p><strong>Example 1)</strong></p>\n\n<pre><code>int main(){\n    unsigned char x = 0;\n    unsigned char y = 1;\n    printf(\"%u\\n\", x - y); \n    printf(\"%d\\n\", x - y);\n}\n</code></pre>\n\n<p>Since unsigned char is smaller than int, we apply the integer promotion on them, then we have (int)x-(int)y = (int)(-1) and unsigned int (-1) = 4294967295.</p>\n\n<p>The output from the above code:(same as what we expected)</p>\n\n<pre><code>4294967295\n-1\n</code></pre>\n\n<p><strong>How to fix it?</strong></p>\n\n<p>I tried what the previous post recommanded, but it doesn't really work.\nHere is the code based on the previous post:</p>\n\n<p><strong>change one of them to unsigned int</strong></p>\n\n<pre><code>int main(){\n    unsigned int x = 0;\n    unsigned char y = 1;\n    printf(\"%u\\n\", x - y); \n    printf(\"%d\\n\", x - y);\n}\n</code></pre>\n\n<p>Since x is already an unsigned integer, we only apply the integer promotion to y.  Then we get (unsigned int)x-(int)y.  Since they still don't have the same type, we apply the usual arithmetic converions, we get (unsigned int)x-(unsigned int)y = 4294967295.</p>\n\n<p>The output from the above code:(same as what we expected):</p>\n\n<pre><code>4294967295\n-1\n</code></pre>\n\n<p>Similarly, the following code gets the same result:</p>\n\n<pre><code>int main(){\n    unsigned char x = 0;\n    unsigned int y = 1;\n    printf(\"%u\\n\", x - y); \n    printf(\"%d\\n\", x - y);\n}\n</code></pre>\n\n<p><strong>change both of them to unsigned int</strong></p>\n\n<pre><code>int main(){\n    unsigned int x = 0;\n    unsigned int y = 1;\n    printf(\"%u\\n\", x - y); \n    printf(\"%d\\n\", x - y);\n}\n</code></pre>\n\n<p>Since both of them are unsigned int, no integer promotion is needed.  By the usual arithmetic converison(have the same type), (unsigned int)x-(unsigned int)y = 4294967295.</p>\n\n<p>The output from the above code:(same as what we expected):</p>\n\n<pre><code>4294967295\n-1\n</code></pre>\n\n<p><strong>One of possible ways to fix the code:(add a type cast in the end)</strong></p>\n\n<pre><code>int main(){\n    unsigned char x = 0;\n    unsigned char y = 1;\n    printf(\"%u\\n\", x - y); \n    printf(\"%d\\n\", x - y);\n    unsigned char z = x-y;\n    printf(\"%u\\n\", z);\n}\n</code></pre>\n\n<p>The output from the above code:</p>\n\n<pre><code>4294967295\n-1\n255\n</code></pre>\n\n<p><strong>Example 2)</strong></p>\n\n<pre><code>int main(){\n    unsigned int a = 1;\n    signed int b = -2;\n    if(a + b &gt; 0)\n        puts(\"-1 is larger than 0\");\n        printf(\"%u\\n\", a+b);\n}\n</code></pre>\n\n<p>Since both of them are integers, no integer promotion is needed.  By the usual arithmetic conversion, we get (unsigned int)a+(unsigned int)b = 1+4294967294 = 4294967295.</p>\n\n<p>The output from the above code:(same as what we expected)</p>\n\n<pre><code>-1 is larger than 0\n4294967295\n</code></pre>\n\n<p><strong>How to fix it?</strong></p>\n\n<pre><code>int main(){\n    unsigned int a = 1;\n    signed int b = -2;\n    signed int c = a+b;\n    if(c &lt; 0)\n        puts(\"-1 is smaller than 0\");\n        printf(\"%d\\n\", c);\n}\n</code></pre>\n\n<p>The output from the above code:</p>\n\n<pre><code>-1 is smaller than 0\n-1\n</code></pre>\n\n<p><strong>Example 3)</strong></p>\n\n<pre><code>int main(){\n    unsigned short a = 1;\n    signed short b = -2;\n    if(a + b &lt; 0)\n        puts(\"-1 is smaller than 0\");\n        printf(\"%d\\n\", a+b);\n}\n</code></pre>\n\n<p>The last example fixed the problem since a and b both converted to int due to the integer promotion.</p>\n\n<p>The output from the above code:</p>\n\n<pre><code>-1 is smaller than 0\n-1\n</code></pre>\n\n<p>If I got some concepts mixed up, please let me know.  Thanks~</p>\n"}], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 17522, "favorite_count": 59, "accepted_answer_id": 46073296, "answer_count": 2, "score": 79, "last_activity_date": 1566964155, "creation_date": 1504695025, "last_edit_date": 1566964155, "question_id": 46073295, "link": "https://stackoverflow.com/questions/46073295/implicit-type-promotion-rules", "title": "Implicit type promotion rules", "body": "<p><em>This post is meant to be used as a FAQ regarding implicit integer promotion in C, particularly implicit promotion caused by the usual arithmetic conversions and/or the integer promotions.</em></p>\n\n<p>Example 1)<br>\nWhy does this give a strange, large integer number and not 255?</p>\n\n<pre><code>unsigned char x = 0;\nunsigned char y = 1;\nprintf(\"%u\\n\", x - y); \n</code></pre>\n\n<p>Example 2)<br>\nWhy does this give \"-1 is larger than 0\"?</p>\n\n<pre><code>unsigned int a = 1;\nsigned int b = -2;\nif(a + b &gt; 0)\n  puts(\"-1 is larger than 0\");\n</code></pre>\n\n<p>Example 3)<br>\nWhy does changing the type in the above example to <code>short</code> fix the problem?</p>\n\n<pre><code>unsigned short a = 1;\nsigned short b = -2;\nif(a + b &gt; 0)\n  puts(\"-1 is larger than 0\"); // will not print\n</code></pre>\n\n<p>(These examples were intended for a 32 or 64 bit computer with 16 bit short.)</p>\n"}, {"tags": ["c", "database", "sqlite"], "comments": [{"owner": {"reputation": 3698, "user_id": 1848585, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9JLaK.png?s=128&g=1", "display_name": "Brian Tiffin", "link": "https://stackoverflow.com/users/1848585/brian-tiffin"}, "edited": false, "score": 0, "creation_date": 1504695010, "post_id": 46073011, "comment_id": 79107119, "body": "Creating a database if not found is design intent for <code>sqlite3_open</code>.  Take a look at <code>sqlite3_open_v2</code> which accepts flags and will return an error code if the database file does not exist."}], "answers": [{"tags": [], "owner": {"reputation": 151, "user_id": 8560999, "user_type": "registered", "profile_image": "https://graph.facebook.com/1954785021467637/picture?type=large", "display_name": "Joshua Newhouse", "link": "https://stackoverflow.com/users/8560999/joshua-newhouse"}, "is_accepted": true, "score": 2, "last_activity_date": 1504709299, "last_edit_date": 1592644375, "creation_date": 1504709299, "answer_id": 46078302, "question_id": 46073011, "link": "https://stackoverflow.com/questions/46073011/sqlite3-open-does-not-return-error-if-trying-to-open-a-file-that-does-not-exsist/46078302#46078302", "title": "sqlite3_open does not return error if trying to open a file that does not exsist", "body": "<p>From the SQLite documentation on opening a database found here:\n<a href=\"https://sqlite.org/c3ref/open.html\" rel=\"nofollow noreferrer\">https://sqlite.org/c3ref/open.html</a></p>\n<blockquote>\n<p>The <strong>sqlite3_open_v2()</strong> interface works like <strong>sqlite3_open()</strong> except that\nit accepts two additional parameters for additional control over the\nnew database connection. The flags parameter to sqlite3_open_v2() can\ntake one of the following three values, optionally combined with the\nSQLITE_OPEN_NOMUTEX, SQLITE_OPEN_FULLMUTEX, SQLITE_OPEN_SHAREDCACHE,\nSQLITE_OPEN_PRIVATECACHE, and/or SQLITE_OPEN_URI flags:</p>\n<p>SQLITE_OPEN_READONLY The database is opened in read-only mode. If the\ndatabase does not already exist, an error is returned.</p>\n<p>SQLITE_OPEN_READWRITE The database is opened for reading and writing\nif possible, or reading only if the file is write protected by the\noperating system. In either case the database must already exist,\notherwise an error is returned.</p>\n<p>SQLITE_OPEN_READWRITE | SQLITE_OPEN_CREATE The database is opened for\nreading and writing, and is created if it does not already exist.\n<strong>This is the behavior that is always used for sqlite3_open() and sqlite3_open16().</strong></p>\n</blockquote>\n<p>So you need to use sqlite3_open_v2() without the SQLITE_OPEN_CREATE flag instead of sqlite3_open()</p>\n"}], "owner": {"reputation": 117, "user_id": 7110923, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206490801023331/picture?type=large", "display_name": "Lars Karlsen", "link": "https://stackoverflow.com/users/7110923/lars-karlsen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1268, "favorite_count": 0, "accepted_answer_id": 46078302, "answer_count": 1, "score": 3, "last_activity_date": 1504709299, "creation_date": 1504694011, "last_edit_date": 1504703255, "question_id": 46073011, "link": "https://stackoverflow.com/questions/46073011/sqlite3-open-does-not-return-error-if-trying-to-open-a-file-that-does-not-exsist", "title": "sqlite3_open does not return error if trying to open a file that does not exsist", "body": "<pre><code>int main(int argc,char **argv){ \n int rc\n sqlite3 *db;\n\n rc = sqlite3_open(argv[1], &amp;db);\n\n printf(\"rc = %d\\n\", rc);\n if(rc){\n    printf(\"Not Valid Database\\n\");\n    sqlite3_close(db);\n    exit(1);\n}\n</code></pre>\n\n<p>If I run this with <code>./test exsisting_database.sqlite3</code> it returns <code>0</code> as expected. But with <code>./test not_exsisting_database.sqlite3</code> it still returns <code>0</code> and creates the file <code>not_exsisting_database.sqlite3</code></p>\n"}, {"tags": ["c++", "c", "windows", "dynamic", "char"], "comments": [{"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 1, "creation_date": 1504693982, "post_id": 46072952, "comment_id": 79106430, "body": "The <code>_chdir</code>didn&#39;t damage your path, you&#39;re overwriting a buffer somewhere. Also you absolutely <b>must</b> provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>, a short example that reproduces the problem, including the <code>main</code> function and the <i>included</i> headers."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1504693997, "post_id": 46072952, "comment_id": 79106440, "body": "This code doesn&#39;t compile because <code>&#47;fixPathSlash</code>"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1504694070, "post_id": 46072952, "comment_id": 79106506, "body": "Also your code is <b>C++</b>, not C, because a) you&#39;re compiling with C++ compiler, b) you&#39;re using <code>new</code>."}, {"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 2, "creation_date": 1504694778, "post_id": 46072952, "comment_id": 79106981, "body": "And since your code is C++ you need to write C++ code, instead of spaghetti C. Proper, modern C++ code does not use <code>malloc</code>, <code>free</code>, and other error-prone functions inherited from C. Proper, modern C++ code uses containers that handle their own memory management, greatly reducing the opportunity for corrupting the heap as a result of mistakes in manually managing memory allocations. You need to rewrite your code in modern C++."}, {"owner": {"reputation": 42446, "user_id": 902497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff13ece6277497484bfa2911c6183a30?s=128&d=identicon&r=PG", "display_name": "Raymond Chen", "link": "https://stackoverflow.com/users/902497/raymond-chen"}, "edited": false, "score": 1, "creation_date": 1504706858, "post_id": 46072952, "comment_id": 79115987, "body": "You allocate <code>size</code> bytes with <code>malloc(size)</code> and then write to <code>size+1</code> bytes with <code>wcstomb_s</code>. There is also a bug with your calculation of the size of the temp buffer. There are cases where the size of the <code>char</code> buffer is more than half the size of the corresponding <code>wchar_t</code> buffer. (Later you try to <code>strcat_s</code> into that buffer, which is another corruption.) I think you have some more basic misunderstanding of how dynamic memory works. Maybe practice with something simpler first."}, {"owner": {"reputation": 11, "user_id": 8568384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1eddf2db503701fdf226cc85cfe72ff9?s=128&d=identicon&r=PG&f=1", "display_name": "A. Andreotti", "link": "https://stackoverflow.com/users/8568384/a-andreotti"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1504715038, "post_id": 46072952, "comment_id": 79121683, "body": "@AnttiHaapala single slash on comment was just i missclick"}, {"owner": {"reputation": 11, "user_id": 8568384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1eddf2db503701fdf226cc85cfe72ff9?s=128&d=identicon&r=PG&f=1", "display_name": "A. Andreotti", "link": "https://stackoverflow.com/users/8568384/a-andreotti"}, "reply_to_user": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 0, "creation_date": 1504715055, "post_id": 46072952, "comment_id": 79121695, "body": "@SamVarshavchik i don&#39;t know what you mean for spaghetti C, what i wrote is just simple C, since i don&#39;t know nothing of c++, i&#39;ve studied Java, but i wanted to use some of windows lib."}, {"owner": {"reputation": 11, "user_id": 8568384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1eddf2db503701fdf226cc85cfe72ff9?s=128&d=identicon&r=PG&f=1", "display_name": "A. Andreotti", "link": "https://stackoverflow.com/users/8568384/a-andreotti"}, "reply_to_user": {"reputation": 42446, "user_id": 902497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff13ece6277497484bfa2911c6183a30?s=128&d=identicon&r=PG", "display_name": "Raymond Chen", "link": "https://stackoverflow.com/users/902497/raymond-chen"}, "edited": false, "score": 0, "creation_date": 1504715066, "post_id": 46072952, "comment_id": 79121701, "body": "@RaymondChen yes i know i did some stupid things XD size+1 in wcstomb was an error i made will testing for a solution."}, {"owner": {"reputation": 11, "user_id": 8568384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1eddf2db503701fdf226cc85cfe72ff9?s=128&d=identicon&r=PG&f=1", "display_name": "A. Andreotti", "link": "https://stackoverflow.com/users/8568384/a-andreotti"}, "edited": false, "score": 0, "creation_date": 1504715071, "post_id": 46072952, "comment_id": 79121703, "body": "Anyway for now i&#39;ve resolved not using allocated variable. one day when i will need it, i&#39;ll study better and i&#39;ll fix"}], "answers": [{"comments": [{"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1504719853, "post_id": 46080053, "comment_id": 79124425, "body": "You are still doing it wrong.  Never, <i>never</i> lie, you have no idea that temp has DEFAULT_BUFLEN elements.  Lies produce corrupted heaps.  If you don&#39;t want to allocate it (correctly, like Raymond said) so you can accept any string then at least pass the buffer length as an argument."}, {"owner": {"reputation": 11, "user_id": 8568384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1eddf2db503701fdf226cc85cfe72ff9?s=128&d=identicon&r=PG&f=1", "display_name": "A. Andreotti", "link": "https://stackoverflow.com/users/8568384/a-andreotti"}, "reply_to_user": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1504727682, "post_id": 46080053, "comment_id": 79128577, "body": "@HansPassant i actually have initialize it as &quot;char temp[DEFAULT_BUFLEN]. It&#39;s just a quick fix to make things till i learn how to properly allocate at run time. What do you mean saying &quot;never lie&quot;?"}], "tags": [], "owner": {"reputation": 11, "user_id": 8568384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1eddf2db503701fdf226cc85cfe72ff9?s=128&d=identicon&r=PG&f=1", "display_name": "A. Andreotti", "link": "https://stackoverflow.com/users/8568384/a-andreotti"}, "is_accepted": false, "score": 0, "last_activity_date": 1504714706, "creation_date": 1504714706, "answer_id": 46080053, "question_id": 46072952, "link": "https://stackoverflow.com/questions/46072952/damaged-heap-while-working-with-dynamically-allocated-variables-and-chdir-windo/46080053#46080053", "title": "Damaged heap while working with dynamically allocated variables and _chdir windows function", "body": "<p>Ok i managed to solve the problem, as i thoght the problem was the allocation.\nSince i need to solve this fast for now i've used the method i listed above, anyway i will study how to work with allocated variable and modify it to improve it.</p>\n\n<pre><code>void getCartellaCorrente(char* temp) {\n    size_t size;\n    LPWSTR dirCorrente = new TCHAR[DEFAULT_BUFLEN];\n    GetCurrentDirectory(DEFAULT_BUFLEN, dirCorrente);\n    size = wcslen(dirCorrente);\n    wcstombs_s(NULL, temp, DEFAULT_BUFLEN, dirCorrente, size);\n}\n\nvoid setCartellaCorrente(char* relative, char* dirCorrente) {\n\n    if (strlen(relative)&gt;=5 &amp;&amp; relative[4] == ':') {\n        strcpy_s(dirCorrente, DEFAULT_BUFLEN, &amp;relative[3]);\n    }\n    else {\n        getCartellaCorrente(dirCorrente);\n        relative[2] = '\\\\';\n        strcat_s(dirCorrente, DEFAULT_BUFLEN, &amp;relative[2]);\n    }\n    int i = _chdir(dirCorrente);\n    return getCartellaCorrente(dirCorrente);\n}\n</code></pre>\n\n<p>The path variable is now allocated into the main with static size, the functions does not return the correct value, instead they change it directly.</p>\n"}], "owner": {"reputation": 11, "user_id": 8568384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1eddf2db503701fdf226cc85cfe72ff9?s=128&d=identicon&r=PG&f=1", "display_name": "A. Andreotti", "link": "https://stackoverflow.com/users/8568384/a-andreotti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 97, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1504714706, "creation_date": 1504693888, "last_edit_date": 1504697703, "question_id": 46072952, "link": "https://stackoverflow.com/questions/46072952/damaged-heap-while-working-with-dynamically-allocated-variables-and-chdir-windo", "title": "Damaged heap while working with dynamically allocated variables and _chdir windows function", "body": "<p>while working with those function i'm getting stuck with an error.\nThe debbuger says \"damged heap\" on <code>_chdir(dirCorrente);</code> line.</p>\n\n<p>The main calls those function as follow:\n - char* temp = getCartellaCorrente();\n - some other stuff not relative to these function...\n - temp = setCartellaCorrente(\"cd test\")</p>\n\n<p>when the execution stops the setCartellaCorrente's dirCorrente value is '\"C:\\Users\\Luca\\Desktop\\remote-control-project\\FirstService\\Debug\\test\"'</p>\n\n<p>I think i'm doing something wrong with dynamically allocated variables.</p>\n\n<p>I'm working on this problem since 48 hours now, i've serached on the internet but nothing. I guess that i don't know something important about allocated variable or _chdir function.</p>\n\n<p>I will be really gratefull if you can explain me what i miss.</p>\n\n<pre><code>char* getCartellaCorrente() {\n    char* temp;\n    size_t size;\n    LPWSTR dirCorrente = new TCHAR[DEFAULT_BUFLEN];\n    GetCurrentDirectory(DEFAULT_BUFLEN, dirCorrente);\n    size = wcslen(dirCorrente);\n    temp = (char *)malloc(size);\n    wcstombs_s(NULL, temp, size+1, dirCorrente, size);\n    return temp;\n}\n\nchar* setCartellaCorrente(char* relative) {\n    char *dirCorrente;\n\n    if (strlen(relative)&gt;=5 &amp;&amp; relative[4] == ':') {\n        dirCorrente = (char *)malloc(DEFAULT_BUFLEN);\n        strcpy_s(dirCorrente, DEFAULT_BUFLEN, &amp;relative[3]);\n    }\n    else {\n        dirCorrente = getCartellaCorrente();\n        relative[2] = '\\\\';\n        strcat_s(dirCorrente, DEFAULT_BUFLEN, &amp;relative[2]);\n        printf(\"goode %s \\n\", dirCorrente);\n    }\n    //fixPathSlash(dirCorrente);\n    printf(\"\\n2: %s\\n\", dirCorrente);\n    int i = _chdir(dirCorrente); //HERE IT STOPS\n    printf(\"wtf: %d\\n\", i);\n    free(dirCorrente);\n    printf(\"boh\\n\");\n    return getCartellaCorrente();\n}\n</code></pre>\n\n<p>It's my first question. Sorry if i missed some important information, i'll edit fast.</p>\n"}, {"tags": ["c", "recursion"], "comments": [{"owner": {"reputation": 144, "user_id": 2982586, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56dea6792e3195dcbaff4e46505f4dae?s=128&d=identicon&r=PG&f=1", "display_name": "Math Lover", "link": "https://stackoverflow.com/users/2982586/math-lover"}, "edited": false, "score": 0, "creation_date": 1504691797, "post_id": 46072099, "comment_id": 79104914, "body": "I don&#39;t think you will receive many answers if you don&#39;t put an effort to explain more in particular what you didn&#39;t understand....."}, {"owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "edited": false, "score": 3, "creation_date": 1504691847, "post_id": 46072099, "comment_id": 79104947, "body": "The string is not reversed, it&#39;s merely <i>printed</i> in reverse. Big difference."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1504691855, "post_id": 46072099, "comment_id": 79104954, "body": "The string is not reversed.It is <b>printed</b> in reverse."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1504691986, "post_id": 46072099, "comment_id": 79105057, "body": "Notice that no printing is done until the end of the string has been found, and then ask yourself &quot;what is the printing sequence?&quot;"}, {"owner": {"reputation": 303, "user_id": 5092746, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c1439c44e78de6b46535a9c23b01eb6?s=128&d=identicon&r=PG&f=1", "display_name": "Moe", "link": "https://stackoverflow.com/users/5092746/moe"}, "reply_to_user": {"reputation": 144, "user_id": 2982586, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56dea6792e3195dcbaff4e46505f4dae?s=128&d=identicon&r=PG&f=1", "display_name": "Math Lover", "link": "https://stackoverflow.com/users/2982586/math-lover"}, "edited": false, "score": 0, "creation_date": 1504692437, "post_id": 46072099, "comment_id": 79105368, "body": "@Val_MagicStar I&#39;ve edited the question, I&#39;m not lazy about asking, It&#39;s all about that I just don&#39;t know what goes in the code. how it works? how it print the string reversely?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1504692561, "post_id": 46072099, "comment_id": 79105454, "body": "Work with a shorter string, say 2 characters, draw a little diagram of it, and work it through with pencil and paper."}, {"owner": {"reputation": 303, "user_id": 5092746, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c1439c44e78de6b46535a9c23b01eb6?s=128&d=identicon&r=PG&f=1", "display_name": "Moe", "link": "https://stackoverflow.com/users/5092746/moe"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1504692647, "post_id": 46072099, "comment_id": 79105515, "body": "@WeatherVane your comment makes sense to me. I think you pointed to something I wasn&#39;t able to see, thanks, i will do this"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1504698331, "post_id": 46072099, "comment_id": 79109429, "body": "Next time, copy the full explanation as well as the code:I"}], "answers": [{"tags": [], "owner": {"reputation": 868, "user_id": 4402433, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9bce35bd631fc9215f7885d6d0c84366?s=128&d=identicon&r=PG&f=1", "display_name": "Sathiya", "link": "https://stackoverflow.com/users/4402433/sathiya"}, "is_accepted": false, "score": -1, "last_activity_date": 1504693273, "last_edit_date": 1504693273, "creation_date": 1504692817, "answer_id": 46072579, "question_id": 46072099, "link": "https://stackoverflow.com/questions/46072099/how-does-this-recursion-line-implemented-to-print-the-string-reversed/46072579#46072579", "title": "How does this recursion line implemented to print the string reversed?", "body": "<p>As you have mentioned, it is a recursive function. So the execution goes like this</p>\n\n<p>From main(), rec() is called. The control now enters the rec() function. Where a condition check is made to detect the end of string. Until the end of string is detected, else part gets executed.</p>\n\n<p>Now let us see what happens in else part. </p>\n\n<p><code>else</code> calls <code>rec()</code> again. Where the <code>rec()</code> is called again until the end of string is met. </p>\n\n<p>so the call sequence goes like this-> </p>\n\n<pre><code>main()-&gt; rec()-&gt;rec(rec(rec(... until \\0..) putchar()) putchar())putchar())\n</code></pre>\n\n<p>So on end of the control from last <code>rec()</code> function last <code>putchar()</code> will be executed. Then on the last before on and goes on till the first <code>rec()</code> called from <code>main()</code>. </p>\n\n<p><code>main()</code>-> <code>rec(H)</code> as it is not null -> it again calls <code>rec(e)</code> </p>\n\n<p>Here the control has not came out of the first call to <code>rec()</code>. So <code>rec(H)</code> looks like</p>\n\n<pre><code>rec(H)\n{\nrec(e);\nputchar(H);\n}\n</code></pre>\n\n<p>it goes on like this</p>\n"}, {"tags": [], "owner": {"reputation": 399, "user_id": 8555361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3bb69a4dca8191a0b26ab901d306020c?s=128&d=identicon&r=PG&f=1", "display_name": "Ganeshdip", "link": "https://stackoverflow.com/users/8555361/ganeshdip"}, "is_accepted": false, "score": 0, "last_activity_date": 1504692918, "creation_date": 1504692918, "answer_id": 46072619, "question_id": 46072099, "link": "https://stackoverflow.com/questions/46072099/how-does-this-recursion-line-implemented-to-print-the-string-reversed/46072619#46072619", "title": "How does this recursion line implemented to print the string reversed?", "body": "<p>Actually this recursive function is not reversing the input string. It is just printing it in reversed order.\nThe logic is simple-\nSuppose I am having string str[4] = \"ABC\" which is null terminated string in C.</p>\n\n<ul>\n<li>For first call to rev(str) - \nstr[0] is 'A' which is not null --> call rev(str[1]) and print str[0] = 'A'</li>\n<li>For second call to rev()\nstr[0] is 'B' which is not null --> call rev(str[1]) and print str[0] = 'B'</li>\n<li>And so on till '\\0' is found.</li>\n</ul>\n\n<p>Now before returning from each function call it is printing str[0]-</p>\n\n<ul>\n<li>So for '\\0' - It will simply return without printing anything.</li>\n<li>For 'C', it will print 'C'</li>\n<li>For 'B', it will print 'B'\nAnd so on.</li>\n</ul>\n\n<p>So the string will be printed in reverse order.  </p>\n"}, {"tags": [], "owner": {"reputation": 278, "user_id": 5805903, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2db74c52f16a0625ed6e5f09ce7d6d9f?s=128&d=identicon&r=PG&f=1", "display_name": "Eswaran Pandi", "link": "https://stackoverflow.com/users/5805903/eswaran-pandi"}, "is_accepted": false, "score": 0, "last_activity_date": 1504693307, "creation_date": 1504693307, "answer_id": 46072750, "question_id": 46072099, "link": "https://stackoverflow.com/questions/46072099/how-does-this-recursion-line-implemented-to-print-the-string-reversed/46072750#46072750", "title": "How does this recursion line implemented to print the string reversed?", "body": "<p>As per your program, ** H e y  t h e r e ** ,In rev function, </p>\n\n<ol>\n<li><strong>c[0] = H</strong> is checked as NULL or not  ==> NO</li>\n<li>Passing address <strong>&amp;c[1] = \"ey there\"</strong> which starts from <strong>e</strong> to again to rev function. </li>\n<li><strong>c[0] = e</strong> is checked as NULL or not  ==> NO</li>\n<li>Passing address <strong>&amp;c[1] = \"y there\"</strong> which starts from <strong>y</strong> to again to rev function.</li>\n<li>this logic continues till end.</li>\n<li><strong>c[0] = e</strong> is checked as NULL or not  ==> NO</li>\n<li>Passing address <strong>&amp;c[1] = \\0</strong> which is NULL character to be passed to rev function. </li>\n<li>once identified <strong>\\0</strong>, rev function starts returning.</li>\n<li>after rev function, we have <strong>putchar(c[0])</strong> which prints latest value of c[0] as 'e' [as per point 6].</li>\n<li>the print continues <strong>e r e h T  y e H</strong></li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 303, "user_id": 5092746, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c1439c44e78de6b46535a9c23b01eb6?s=128&d=identicon&r=PG&f=1", "display_name": "Moe", "link": "https://stackoverflow.com/users/5092746/moe"}, "edited": false, "score": 0, "creation_date": 1504693822, "post_id": 46072752, "comment_id": 79106332, "body": "It&#39;s more clear right now, but the only thing i cant understand is how the fumction itterates through the string? what line do move the pointer to the next char?"}, {"owner": {"reputation": 44043, "user_id": 1565698, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/7dace33805b9dcdec5aa63308daf88dc?s=128&d=identicon&r=PG", "display_name": "Sylwester", "link": "https://stackoverflow.com/users/1565698/sylwester"}, "reply_to_user": {"reputation": 303, "user_id": 5092746, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c1439c44e78de6b46535a9c23b01eb6?s=128&d=identicon&r=PG&f=1", "display_name": "Moe", "link": "https://stackoverflow.com/users/5092746/moe"}, "edited": false, "score": 0, "creation_date": 1504694072, "post_id": 46072752, "comment_id": 79106508, "body": "That is C pointer magic.. <code>&amp;c[1]</code> This gets the address of the second element of <code>c</code>. Thus for a *char <code>&quot;on\\n&quot;</code> with <code>c</code> being the memory address 0, <code>&amp;c[1]</code> will point to memory address 1 representing <code>&quot;n\\n&quot;</code>. If the array was integers <code>&amp;intArr[1]</code> would be <code>&amp;intArr+8</code> (for 64 bits integers)"}], "tags": [], "owner": {"reputation": 44043, "user_id": 1565698, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/7dace33805b9dcdec5aa63308daf88dc?s=128&d=identicon&r=PG", "display_name": "Sylwester", "link": "https://stackoverflow.com/users/1565698/sylwester"}, "is_accepted": true, "score": 1, "last_activity_date": 1504693640, "last_edit_date": 1504693640, "creation_date": 1504693309, "answer_id": 46072752, "question_id": 46072099, "link": "https://stackoverflow.com/questions/46072099/how-does-this-recursion-line-implemented-to-print-the-string-reversed/46072752#46072752", "title": "How does this recursion line implemented to print the string reversed?", "body": "<p>The reason is that the code dictate it to do the rest of the string before processing outputting the current char. Imagine the string \"on\\0\"</p>\n\n<pre><code>rev(\"on\\0\");\n  -&gt;rev(\"n\\0\");\n    -&gt;rev(\"\\0\");  \n      &lt;-return;   // hits base case\n    putchar('n'); // resumes after recursive call\n    &lt;-return;     // invisible return at end of function\n  putchar('o');   // resumes after recursive call\n  &lt;-return;       // invisible return at end of function\n</code></pre>\n\n<p>Every identation here represents a nested call. Thus at the base case you have 3 calls to <code>rev</code> going at the same time, each with different <code>c</code>.</p>\n\n<p>Its important to know that <code>c</code> is unique for <em>each invocation</em> so that when a call to <code>rev</code> returns to a previous <code>rev</code> <code>c</code> has <em>not changed</em> in the callee. That makes it nothing special so in fact it works the same way as calling a different function each time that does the same. It resumes after the previous call has returned. </p>\n"}, {"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 0, "last_activity_date": 1504693867, "last_edit_date": 1504693867, "creation_date": 1504693516, "answer_id": 46072817, "question_id": 46072099, "link": "https://stackoverflow.com/questions/46072099/how-does-this-recursion-line-implemented-to-print-the-string-reversed/46072817#46072817", "title": "How does this recursion line implemented to print the string reversed?", "body": "<p>To make the action of the function more clear rewrite it the following way</p>\n\n<pre><code>void rev( const char * const s )\n{\n    if ( s[0] != '\\0' )\n    {\n        char c = s[0];\n        rev( s + 1 );\n        putchar( c );\n    }\n}\n</code></pre>\n\n<p>So for the first call of the function the function stores the first character of the string in the variable <code>c</code>.</p>\n\n<p>Then the function is called the second time moving the pointer to the second character. Again the function stores this character in its own (local) variable <code>c</code>.</p>\n\n<p>And so on until the terminating zero is encountered.</p>\n\n<p>Then each function invocation before passing the control to the calling invocation prints its character stored in the variable <code>c</code> and you get the reverse order of the characters of the string.</p>\n"}], "owner": {"reputation": 303, "user_id": 5092746, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c1439c44e78de6b46535a9c23b01eb6?s=128&d=identicon&r=PG&f=1", "display_name": "Moe", "link": "https://stackoverflow.com/users/5092746/moe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "accepted_answer_id": 46072752, "answer_count": 5, "score": 0, "last_activity_date": 1504693867, "creation_date": 1504691542, "last_edit_date": 1504692372, "question_id": 46072099, "link": "https://stackoverflow.com/questions/46072099/how-does-this-recursion-line-implemented-to-print-the-string-reversed", "title": "How does this recursion line implemented to print the string reversed?", "body": "<p>Shortly, I need to know how this function works? What's go inside? How is the passed string reversed?</p>\n\n<p>Here is the code and thanks in advance.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nvoid rev (const char* const);\n\nint main()\n{\n    char str [] = \"Hey There\";\n    rev(str);\n\n    return 0;\n}\n\nvoid rev(const char* const c)\n{\n    if(c[0]=='\\0')\n        return ;\n    else\n    {\n        rev( &amp;c[1]);\n        putchar(c[0]);\n    }\n}\n</code></pre>\n\n<p><strong>EDIT:</strong> As the commenters advised, I will explain what I'm not understanding more. The string is not reversed, but printed reversely, Ok fine. What is the mechanism used to do this? what is the execution sequence?</p>\n"}, {"tags": ["c", "linux-kernel", "network-programming", "mmap", "ethernet"], "answers": [{"comments": [{"owner": {"reputation": 113, "user_id": 5946284, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e33e8de9ac5e188f872db3c44a17c847?s=128&d=identicon&r=PG&f=1", "display_name": "Mass", "link": "https://stackoverflow.com/users/5946284/mass"}, "edited": false, "score": 0, "creation_date": 1505725412, "post_id": 46202524, "comment_id": 79513412, "body": "Thanks for the response. I came to the same conclusion that there is no way to get the destination MAC address for free from kernel while using packet socket. As for the raw socket, not really. I wanted to use kernel bypass method that comes free with Linux kernel in order to get higher throughput than usual socket."}], "tags": [], "owner": {"reputation": 10901, "user_id": 1076479, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/eLQUX.jpg?s=128&g=1", "display_name": "Gil Hamilton", "link": "https://stackoverflow.com/users/1076479/gil-hamilton"}, "is_accepted": true, "score": 0, "last_activity_date": 1505319896, "creation_date": 1505319896, "answer_id": 46202524, "question_id": 46071266, "link": "https://stackoverflow.com/questions/46071266/how-to-send-sock-dgram-packet-using-packet-mmap-without-being-concerned-about-ma/46202524#46202524", "title": "How to send SOCK_DGRAM packet using packet_mmap without being concerned about MAC address?", "body": "<p>No. When you use a packet socket in <code>SOCK_DGRAM</code> mode,  you needn't construct the L2 header, but you must still provide the L2 address and then the system will construct the header for you. (So that would have the benefit of actually building the L2 portion of the packet for you and you wouldn't need to specify the source MAC address but you still need to specify the interface from which you want the packet sent and the target MAC address.)</p>\n\n<p>How would the system know where to send the packet otherwise? I believe you were <em>hoping</em> that the system would look at the IP header you've already constructed in the packet buffer, and then do an interface selection and ARP lookup on your behalf, but by using a packet socket, you're bypassing that part of the network stack. (Also, if the IP address is not on the local LAN, there would be a routing step needed -- usually just finding the default gateway and ARPing for <em>its</em> MAC address.)</p>\n\n<p>Now you <em>can</em> get most of what (I think) you want with a <code>raw</code> socket (<a href=\"http://man7.org/linux/man-pages/man7/raw.7.html\" rel=\"nofollow noreferrer\">http://man7.org/linux/man-pages/man7/raw.7.html</a>). In this case, you're telling the kernel that you're using IP but not relying on it for any of the higher layers (> L3). And you can also construct your own IP header in this case and have the routing decision based on it using the <code>IP_HDRINCL</code> option.</p>\n"}], "owner": {"reputation": 113, "user_id": 5946284, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e33e8de9ac5e188f872db3c44a17c847?s=128&d=identicon&r=PG&f=1", "display_name": "Mass", "link": "https://stackoverflow.com/users/5946284/mass"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 376, "favorite_count": 0, "accepted_answer_id": 46202524, "answer_count": 1, "score": 2, "last_activity_date": 1505319896, "creation_date": 1504689287, "last_edit_date": 1504767594, "question_id": 46071266, "link": "https://stackoverflow.com/questions/46071266/how-to-send-sock-dgram-packet-using-packet-mmap-without-being-concerned-about-ma", "title": "How to send SOCK_DGRAM packet using packet_mmap without being concerned about MAC address?", "body": "<p>I want to send packets using packet_mmap for getting high packet transmission rate. I managed to send packets using packet socket in raw mode, which for that purpose I created L2, L3, and etc in buffer and send it using</p>\n\n<pre><code>sendto(fd_socket, NULL, 0, 0, NULL, sizeof(struct sockaddr_ll));\n</code></pre>\n\n<p>However, I don't want to bother with destination mac address. So I turned into using Dgram instead. If I want to employ sendto there is an argument for destination MAC Address. Even though this is not what I wished for in terms of not being concerned with arp cache and specifying destination's MAC address:</p>\n\n<pre><code>sendto(fd_socket, NULL, 0, 0, (struct sockaddr *) ps_sockaddr, sizeof(struct sockaddr_ll));\n</code></pre>\n\n<p>However I found that send is also allowed to be used with packet socket.\n<a href=\"http://man7.org/linux/man-pages/man7/packet.7.html\" rel=\"nofollow noreferrer\">http://man7.org/linux/man-pages/man7/packet.7.html</a>\nTherefore, I filled the buffer with ip header and so on. In this case send returns zero as nothing is found to be sent, which I expect to be something other than zero, if there is an error with transmission of packet.</p>\n\n<p>Is there a way to use packet_mmap without being concerned about L2 address? </p>\n"}, {"tags": ["c", "visual-studio-2008", "casting"], "comments": [{"owner": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 4, "creation_date": 1504687746, "post_id": 46070582, "comment_id": 79101901, "body": "<code>malloc</code> returns a <code>void *</code>, which is a generic pointer. But your function returns a <code>void **</code>, which is not a generic pointer, so you have to cast it."}, {"owner": {"reputation": 1800, "user_id": 4769313, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/gFISt.png?s=128&g=1", "display_name": "Sir Jo Black", "link": "https://stackoverflow.com/users/4769313/sir-jo-black"}, "edited": false, "score": 0, "creation_date": 1504687802, "post_id": 46070582, "comment_id": 79101938, "body": "Why do you use a pointer of pointer? You may allocate a 2d array using a pointer and simple math computation! How have you written the alloc_2d function? (post it could be intersting to solve your problem)."}, {"owner": {"reputation": 1800, "user_id": 4769313, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/gFISt.png?s=128&g=1", "display_name": "Sir Jo Black", "link": "https://stackoverflow.com/users/4769313/sir-jo-black"}, "edited": false, "score": 0, "creation_date": 1504687903, "post_id": 46070582, "comment_id": 79101990, "body": "I think that it&#39;s better to avoid pointers of pointer if they&#39;re not strictly usefull."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "is_accepted": false, "score": 3, "last_activity_date": 1504696075, "last_edit_date": 1504696075, "creation_date": 1504691982, "answer_id": 46072251, "question_id": 46070582, "link": "https://stackoverflow.com/questions/46070582/should-i-cast-void-return-in-visual-studio/46072251#46072251", "title": "Should I cast void** return in Visual Studio", "body": "<p>From the signature, I assume your function is implemented roughly like this (plus error checking I'm leaving out here for brevity):</p>\n\n<pre><code>void **alloc_2d(int w, int h, size_t type_size)\n{\n    void **pointers = malloc(h * sizeof *pointers);\n    for (size_t i = 0; i &lt; h; ++i)\n    {\n        pointers[i] = malloc(w * type_size);\n    }\n    return pointers;\n}\n</code></pre>\n\n<p>Some remarks on this:</p>\n\n<ul>\n<li>The result of this function is <strong>not</strong> a <em>2d array</em>, but an array of pointers to arrays. It can be used somewhat similar to a real 2d array, but comes with some overhead. A real 2d array would be <strong>one</strong> contiguous block of size <code>w * h * type_size</code>.</li>\n<li>This code is in fact unsafe and could invoke undefined behavior when you cast the <code>void **</code> returned from it to <code>float **</code>. This is because there's no guarantee that pointers to different types have the same representation -- they could even have different sizes. See also <a href=\"https://stackoverflow.com/q/916051/2371524\">Are there any platforms where pointers to different types have different sizes?</a>. By casting <code>void **</code> to <code>float **</code>, you're treating an array of <code>void *</code> <em>as if it was</em> and array of <code>float *</code>. Although probably fine on your typical modern PC platform, this <em>can go completely wrong</em>.</li>\n</ul>\n\n<p>That said, you could avoid the cast by simply having your function return <code>void *</code> instead of <code>void **</code>, but this would only hide the problem: <code>void *</code> is <strong>the</strong> generic pointer type and the compiler will allow implicit conversion to any other pointer type, but you'd still access your <code>void *</code> array using the wrong pointer type that way.</p>\n\n<hr>\n\n<p>I suggest allocating a flat array instead and calculate the offsets manually, like this:</p>\n\n<pre><code>size_t rows = 100;\nsize_t cols = 100;\nfloat *data = malloc(cols * rows * sizeof *data);\n\ndata[cols*5 + 3] = 1.41;\n// ...\n\nfree(data);\n</code></pre>\n\n<hr>\n\n<p>As an alternative, you can use variable-length arrays (obligatory in C99, optional but almost always supported in C11 -- <em>maybe not supported by Microsoft</em> ....) to dynamically allocate a real <em>2d array</em>:</p>\n\n<pre><code>size_t rows = 100;\nsize_t cols = 100;\nfloat (*data)[cols] = malloc(rows * sizeof *data);\n\ndata[5][3] = 1.41;\n// ...\nfree(data);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1504698571, "post_id": 46074439, "comment_id": 79109586, "body": "(Note that you might have to switch to a standard-compliant C compiler for this to work.)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1504701529, "post_id": 46074439, "comment_id": 79111838, "body": "Fully agreed on using just one array if possible, but for the VLA you suggest, &quot;<i>standard compliant</i>&quot; isn&#39;t enough. MSVC is at least compliant to C89, but even if you strictly require compliance with the <i>latest</i> standard, VLAs are still <i>optional</i>. Therefore it&#39;s good to know how to achieve the same without them."}], "tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": true, "score": 2, "last_activity_date": 1504698916, "last_edit_date": 1504698916, "creation_date": 1504698526, "answer_id": 46074439, "question_id": 46070582, "link": "https://stackoverflow.com/questions/46070582/should-i-cast-void-return-in-visual-studio/46074439#46074439", "title": "Should I cast void** return in Visual Studio", "body": "<p>The generic pointer type in C is <code>void*</code>. That does <em>not</em> mean that <code>void**</code> is also a generic pointer type, the rule does not apply recursively. </p>\n\n<p>Rather, a conversion from <code>void**</code> to <code>float**</code> or the other way around is an invalid pointer conversion. They are not compatible types - the compiler must issue a diagnostic message. Ignoring the warning might result in misaligned data or strict aliasing issues - in either case bugs.</p>\n\n<hr>\n\n<blockquote>\n  <p>What should I do?</p>\n</blockquote>\n\n<p>Fix the code so that it doesn't contain forbidden pointer conversions.</p>\n\n<hr>\n\n<blockquote>\n  <p>Are newer/other compilers aware of this kind of cast?</p>\n</blockquote>\n\n<p>This particular rule has not changed since the first standardization of C.</p>\n\n<hr>\n\n<p>As for how you should fix your code... you shouldn't. You should rewrite it from scratch so that it allocates <em>arrays</em> and not \"pointer-based look-up tables\". There is no obvious reason why you would benefit from such a look-up-table here, but many reasons why you should avoid it. </p>\n\n<p>In addition, your code would be much more readable if you use pointers to VLA.</p>\n\n<p>See <a href=\"https://stackoverflow.com/questions/42094465/correctly-allocating-multi-dimensional-arrays\">Correctly allocating multi-dimensional arrays</a> for examples of how to do this proper (code example at the very bottom of the answer).</p>\n"}], "owner": {"reputation": 6899, "user_id": 1212012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gmBY7.png?s=128&g=1", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1212012/mathieu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 210, "favorite_count": 0, "accepted_answer_id": 46074439, "answer_count": 2, "score": 2, "last_activity_date": 1504698916, "creation_date": 1504687371, "last_edit_date": 1504693997, "question_id": 46070582, "link": "https://stackoverflow.com/questions/46070582/should-i-cast-void-return-in-visual-studio", "title": "Should I cast void** return in Visual Studio", "body": "<p>I compile some code with visual studio 9.0 (2008).</p>\n\n<p>The behave as expected, but when I allocate some 2D array with some hand made\nfunctions, Visual-Studio generates some C4133 warning:</p>\n\n<pre><code>void ** alloc_2d(int w, int h, size_t type_size);\nvoid free_d2(void ** mem);\n\nint main (void)\n{        \n    float ** data;\n\n    /* Here is generated a C4133 warning:\n       \"incompatible type from void ** to float **\" */\n    data = alloc_2d(100, 100, sizeof **data);\n\n    /* do things with data */\n\n    /* free data */\n    free_2d(data);\n\n    return 0;\n}\n</code></pre>\n\n<p>I understand why this warning is generated, but I wonder what I should do to make it quiet.</p>\n\n<p>What should I do?</p>\n\n<ul>\n<li>Live with the warning?</li>\n<li>Disable the warning (dangerous I think)?</li>\n<li>Disable the warning around the <code>alloc_2d</code> calls (with some macros specific to \nvisual studio)?</li>\n<li>cast the function return (But [<a href=\"https://stackoverflow.com/q/605845/1212012]\">Do I cast the result of malloc?</a>)</li>\n</ul>\n\n<p>Second question:</p>\n\n<ul>\n<li>Are newer/other compilers aware of this kind of cast?</li>\n</ul>\n\n<hr>\n\n<p>Behind the <code>void**</code> are hidden two arrays: one big to store all data I need to be contiguous, and one other to browse through differents lines.</p>\n\n<p>The implementation looks like (I removed the error checking)</p>\n\n<pre><code>void **alloc_2D_array(int w, int h, size_t size)\n{\n    void ** mem = malloc(w * sizeof *mem);\n    *mem = malloc(w*h*size);\n    for (i = 1; i &lt; w; ++i)\n    {\n        mem[i] = (void*)((char*)mem[0] + i*w*size);\n    }\n    return mem;\n}\n</code></pre>\n"}, {"tags": ["c", "string"], "comments": [{"owner": {"reputation": 21326, "user_id": 1679849, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpvxY.png?s=128&g=1", "display_name": "r3mainer", "link": "https://stackoverflow.com/users/1679849/r3mainer"}, "edited": false, "score": 0, "creation_date": 1504686849, "post_id": 46070363, "comment_id": 79101331, "body": "<code>if (nth_ptr==NULL) break; else nth_ptr++;</code>"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1504686876, "post_id": 46070363, "comment_id": 79101344, "body": "What does <a href=\"http://en.cppreference.com/w/c/string/byte/strchr\" rel=\"nofollow noreferrer\"><code>strchr</code></a> return? A pointer to the character it found in the string (or <code>NULL</code> if not found). Now think a little how you could use that to get to the next character in the string."}], "answers": [{"tags": [], "owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "is_accepted": false, "score": 1, "last_activity_date": 1504686873, "creation_date": 1504686873, "answer_id": 46070434, "question_id": 46070363, "link": "https://stackoverflow.com/questions/46070363/how-to-use-strchr-multiple-times-to-find-the-nth-occurrence/46070434#46070434", "title": "How to use strchr() multiple times to find the nth occurrence", "body": "<p>The obvious (?) way is of course to use the return value of <code>strchr()</code> as the new string, after adding 1 to step past the occurrence known to be there, yes.</p>\n\n<p>Something like:</p>\n\n<pre><code>const char * nth_strchr(const char *s, int c, int n)\n{\n  for (;;)\n  {\n    if (n &lt;= 0)\n      return NULL;\n    const char *h = strchr(s, c);\n    if(h == NULL)\n      return NULL;\n    if (--n == 0)\n      return h;\n    s = h + 1;\n  }\n  return NULL;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 852, "user_id": 3227496, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/874115077/picture?type=large", "display_name": "Hans Petter Taugb&#248;l Kragset", "link": "https://stackoverflow.com/users/3227496/hans-petter-taugb%c3%b8l-kragset"}, "is_accepted": false, "score": 1, "last_activity_date": 1504686884, "creation_date": 1504686884, "answer_id": 46070438, "question_id": 46070363, "link": "https://stackoverflow.com/questions/46070363/how-to-use-strchr-multiple-times-to-find-the-nth-occurrence/46070438#46070438", "title": "How to use strchr() multiple times to find the nth occurrence", "body": "<p>Assuming you are after the <code>n</code>th occurrence of <code>c</code> in the string <code>s</code>, and not the <code>n</code>th char as your comment says, then this line</p>\n\n<pre><code>s = nth_ptr + 1;\n</code></pre>\n\n<p>at the end of your loop will advance your <code>s</code> pointer to the char after the <code>c_count</code>th occurence of <code>c</code> in <code>s</code>.</p>\n\n<p>Remember to also check the return value from <code>strchr</code> as mentioned in the comments above.</p>\n"}, {"comments": [{"owner": {"reputation": 852, "user_id": 3227496, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/874115077/picture?type=large", "display_name": "Hans Petter Taugb&#248;l Kragset", "link": "https://stackoverflow.com/users/3227496/hans-petter-taugb%c3%b8l-kragset"}, "edited": false, "score": 0, "creation_date": 1504690005, "post_id": 46070740, "comment_id": 79103606, "body": "Although this code is neat, it reduces readability. Using fancy functions of a programming language to reduce lines of code is not necessarily a good thing."}, {"owner": {"reputation": 473, "user_id": 4028638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d3666e4dc1f9952bc22d1d77484497f?s=128&d=identicon&r=PG&f=1", "display_name": "vadim_hr", "link": "https://stackoverflow.com/users/4028638/vadim-hr"}, "reply_to_user": {"reputation": 852, "user_id": 3227496, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/874115077/picture?type=large", "display_name": "Hans Petter Taugb&#248;l Kragset", "link": "https://stackoverflow.com/users/3227496/hans-petter-taugb%c3%b8l-kragset"}, "edited": false, "score": 0, "creation_date": 1504698536, "post_id": 46070740, "comment_id": 79109554, "body": "@HansPetterTaugb&#248;lKragset I have seen such code style in the sources of Linux and MS Visual Studio. As for me this code style is ok. if I will edit project with another code style, I will use another code style (style accepted by the project). but here is a just extension of common library function, so imho here such style is acceptable."}, {"owner": {"reputation": 852, "user_id": 3227496, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/874115077/picture?type=large", "display_name": "Hans Petter Taugb&#248;l Kragset", "link": "https://stackoverflow.com/users/3227496/hans-petter-taugb%c3%b8l-kragset"}, "edited": false, "score": 0, "creation_date": 1504786449, "post_id": 46070740, "comment_id": 79153780, "body": "I understand what you are saying, but I disagree. In this context the reader is probably someone new to C that wants to learn, and the code you present is not necessarily the best at teaching. Sure it is correct but it is unnecessarily complex imho."}], "tags": [], "owner": {"reputation": 473, "user_id": 4028638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d3666e4dc1f9952bc22d1d77484497f?s=128&d=identicon&r=PG&f=1", "display_name": "vadim_hr", "link": "https://stackoverflow.com/users/4028638/vadim-hr"}, "is_accepted": false, "score": 2, "last_activity_date": 1504722944, "last_edit_date": 1504722944, "creation_date": 1504687943, "answer_id": 46070740, "question_id": 46070363, "link": "https://stackoverflow.com/questions/46070363/how-to-use-strchr-multiple-times-to-find-the-nth-occurrence/46070740#46070740", "title": "How to use strchr() multiple times to find the nth occurrence", "body": "<pre><code>const char* nth_strchr(const char* s, int c, int n)\n{\n    int c_count;\n    char* nth_ptr;\n\n    for (c_count=1,nth_ptr=strchr(s,c); \n         nth_ptr != NULL &amp;&amp; c_count &lt; n &amp;&amp; c!=0; \n         c_count++) \n    {\n         nth_ptr = strchr(nth_ptr+1, c);\n    }\n\n    return nth_ptr;\n}\n</code></pre>\n\n<p>This code has been tested.</p>\n"}, {"tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": false, "score": 1, "last_activity_date": 1504714129, "creation_date": 1504714129, "answer_id": 46079879, "question_id": 46070363, "link": "https://stackoverflow.com/questions/46070363/how-to-use-strchr-multiple-times-to-find-the-nth-occurrence/46079879#46079879", "title": "How to use strchr() multiple times to find the nth occurrence", "body": "<p>I think the code could be as simple as this, using a counted (<code>for</code>) loop with an early escape if there aren't <code>n</code> occurrences of the character <code>c</code> in the string <code>s</code>:</p>\n\n<pre><code>const char *nth_strchr(const char *s, int c, int n) \n{\n    const char *nth = s;\n    assert(c != '\\0');\n\n    for (int i = 0; i &lt; n; i++)\n    {\n        if ((nth = strchr(nth, c)) == 0)\n            break;\n        nth++;\n    }\n\n    return nth;\n}\n</code></pre>\n\n<p>The <code>break;</code> could be replaced by <code>return 0;</code> or <code>return NULL;</code>.  The condition could be <code>== NULL</code> instead of <code>== 0</code>.  I've assumed at least C99; if you don't have that available, then you need to define <code>i</code> outside the loop.</p>\n\n<p>The assertion is the utmost pedantry.  You can't go incrementing the pointer beyond the first null without detailed knowledge of how the code will be used, and without a context that makes it a sane option.</p>\n\n<p>Other answers have a similar net effect, but IMO the code isn't as clearly written (which is why I've added an answer this much later).  Spreading the controls of a loop over three lines and using multiple assignments in the setup makes it harder to read than it need be.  Using an infinite loop when a counted loop is called for seems like obfuscation.</p>\n"}, {"comments": [{"owner": {"reputation": 1136, "user_id": 3826556, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/06756f01e7ed7d3a33545a34794c40f5?s=128&d=identicon&r=PG&f=1", "display_name": "ihmpall", "link": "https://stackoverflow.com/users/3826556/ihmpall"}, "edited": false, "score": 0, "creation_date": 1543856863, "post_id": 46080357, "comment_id": 94059534, "body": "you forgot closing braces."}], "tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": false, "score": 1, "last_activity_date": 1543907353, "last_edit_date": 1543907353, "creation_date": 1504715812, "answer_id": 46080357, "question_id": 46070363, "link": "https://stackoverflow.com/questions/46070363/how-to-use-strchr-multiple-times-to-find-the-nth-occurrence/46080357#46080357", "title": "How to use strchr() multiple times to find the nth occurrence", "body": "<p>In your code, you keep locating the first occurrence of <code>c</code>, you should add <code>s = nth_ptr + 1;</code> if <code>nth_ptr</code> is not <code>NULL</code>, but you should make special cases for <code>n == 0</code> and/or <code>c == '\\0'</code>.</p>\n\n<p>Here is a simpler version:</p>\n\n<pre><code>const char *nth_strchr(const char *s, int c, int n) {\n    if (c == '\\0' &amp;&amp; n &gt; 1)  /* special case the null terminator */\n        return NULL;\n    if (n &gt; 0) {\n        while ((s = strchr(s, c)) != NULL &amp;&amp; --n &gt; 0) {\n            s++;\n        }\n    }\n    return s;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 20930, "user_id": 6881240, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/dc1e27d7e9a3de2ca8e257cb7c72ff4a?s=128&d=identicon&r=PG&f=1", "display_name": "kabanus", "link": "https://stackoverflow.com/users/6881240/kabanus"}, "edited": false, "score": 1, "creation_date": 1533471764, "post_id": 51694230, "comment_id": 90349850, "body": "Perhaps add an explanation as to what you improved?"}], "tags": [], "owner": {"reputation": 1, "user_id": 10182747, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/4b8bd3f84dcfac90c1b6b6d0391867bc?s=128&d=identicon&r=PG", "display_name": "ram", "link": "https://stackoverflow.com/users/10182747/ram"}, "is_accepted": false, "score": -1, "last_activity_date": 1533471473, "creation_date": 1533471473, "answer_id": 51694230, "question_id": 46070363, "link": "https://stackoverflow.com/questions/46070363/how-to-use-strchr-multiple-times-to-find-the-nth-occurrence/51694230#51694230", "title": "How to use strchr() multiple times to find the nth occurrence", "body": "<p>//Try This program</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;string.h&gt;\nint main()\n{\nchar *q,arr[]=\"This is strchr i program\";\nint i=0;\nwhile((q=strchr(arr+i,'i'))!=NULL){\n    printf(\"%s\\n\",q);\n    i=(char *)q-(char *)arr;\n    i=i+1;\n}\nreturn 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 121, "user_id": 6670200, "user_type": "registered", "accept_rate": 10, "profile_image": "https://www.gravatar.com/avatar/8036b31cf81af5a04160e104fdcea7c6?s=128&d=identicon&r=PG&f=1", "display_name": "Robert Hemingway", "link": "https://stackoverflow.com/users/6670200/robert-hemingway"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2282, "favorite_count": 0, "answer_count": 6, "score": 2, "last_activity_date": 1549555990, "creation_date": 1504686648, "last_edit_date": 1504788681, "question_id": 46070363, "link": "https://stackoverflow.com/questions/46070363/how-to-use-strchr-multiple-times-to-find-the-nth-occurrence", "title": "How to use strchr() multiple times to find the nth occurrence", "body": "<p>I am trying to figure out a way to make this work:</p>\n\n<pre><code>//Returns a pointer to the nth char in a string\nconst char *nth_strchr(const char *s, int c, int n) {\n    int c_count = 0;\n    char *nth_ptr;\n\n    while (c_count++ != n) {\n        nth_ptr = strchr(s, c);\n        //need a line here to skip past the previous found occurrence.\n    }\n    return nth_ptr;\n}\n</code></pre>\n\n<p>I am not too sure how I can make it so each iteration of the <code>while</code> loop can acknowledge the occurrence/position of the char found in the previous loop. Since I have the pointer to that first occurrence... I was thinking of using the memory address to increment the next loop so that I could give the next <code>strchr()</code> call the string starting at the <code>c + 1</code> position? \nIs that possible at all?</p>\n"}, {"tags": ["c", "contiki", "coap"], "comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1504686459, "post_id": 46070117, "comment_id": 79101098, "body": "<i>Why</i> do you need floating point? It is far from obvious with the given code. Do you need to do trigonometry calculations or similar? I don&#39;t believe the MCU on the specified board has a FPU, so floating point will result in horrible performance."}, {"owner": {"reputation": 2299, "user_id": 4851126, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/02d0041271b0178482aee8a36237e09e?s=128&d=identicon&r=PG", "display_name": "Shan-Desai", "link": "https://stackoverflow.com/users/4851126/shan-desai"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1504687692, "post_id": 46070117, "comment_id": 79101874, "body": "One reason being the sub GHz availability. Other being the Application will be used in a boat where higher precision of Accelerometer is of utmost importance."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1504688265, "post_id": 46070117, "comment_id": 79102233, "body": "What does sub GHz radio have to do with floating point? And how exactly does floating point calculations give <i>higher</i> precision? Because they are rather known to reduce precision. And you don&#39;t have 64 bit resolution on your accelerometer anyway, more likely it is 12 bits or so. So you won&#39;t get any better resolution than that no matter what you do in your software."}, {"owner": {"reputation": 2299, "user_id": 4851126, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/02d0041271b0178482aee8a36237e09e?s=128&d=identicon&r=PG", "display_name": "Shan-Desai", "link": "https://stackoverflow.com/users/4851126/shan-desai"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1504688846, "post_id": 46070117, "comment_id": 79102701, "body": "I understand. Thanks. The Sub GHz point was faulty. Apologies. I meant the board is the only one that provides Sub GHz and 2.4 GHz wireless devices on the same board."}, {"owner": {"reputation": 1230, "user_id": 3323777, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9b57e9b0115e6d0356bd4d7502d5cbb9?s=128&d=identicon&r=PG&f=1", "display_name": "eugene-nikolaev", "link": "https://stackoverflow.com/users/3323777/eugene-nikolaev"}, "edited": false, "score": 0, "creation_date": 1504696178, "post_id": 46070117, "comment_id": 79107906, "body": "Sorry if I got it all wrong, but why do you need sprintf at all? Why just not send float value as bytes as they are?"}, {"owner": {"reputation": 2299, "user_id": 4851126, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/02d0041271b0178482aee8a36237e09e?s=128&d=identicon&r=PG", "display_name": "Shan-Desai", "link": "https://stackoverflow.com/users/4851126/shan-desai"}, "reply_to_user": {"reputation": 1230, "user_id": 3323777, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9b57e9b0115e6d0356bd4d7502d5cbb9?s=128&d=identicon&r=PG&f=1", "display_name": "eugene-nikolaev", "link": "https://stackoverflow.com/users/3323777/eugene-nikolaev"}, "edited": false, "score": 0, "creation_date": 1504696590, "post_id": 46070117, "comment_id": 79108211, "body": "@eugene-nikolaev I am just playing by the examples available. I am not sure what you mean but I think <code>set_payload_response()</code> function might not take the values of <code>double</code>. If you can give me a hint as to how to proceed I can try it out."}], "answers": [{"comments": [{"owner": {"reputation": 2299, "user_id": 4851126, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/02d0041271b0178482aee8a36237e09e?s=128&d=identicon&r=PG", "display_name": "Shan-Desai", "link": "https://stackoverflow.com/users/4851126/shan-desai"}, "edited": false, "score": 0, "creation_date": 1504699452, "post_id": 46074138, "comment_id": 79110177, "body": "+1 for CBOR. I think JSON is a good data representation format for the sensor values so I can poll the server using a CoAP Client and collect information at the client for some analyses. Apart from that I am open to any way of data format."}], "tags": [], "owner": {"reputation": 1230, "user_id": 3323777, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9b57e9b0115e6d0356bd4d7502d5cbb9?s=128&d=identicon&r=PG&f=1", "display_name": "eugene-nikolaev", "link": "https://stackoverflow.com/users/3323777/eugene-nikolaev"}, "is_accepted": true, "score": 1, "last_activity_date": 1504704625, "last_edit_date": 1504704625, "creation_date": 1504697644, "answer_id": 46074138, "question_id": 46070117, "link": "https://stackoverflow.com/questions/46070117/using-floating-point-in-cc2538-based-re-mote-board-for-coap-server-with-contiki/46074138#46074138", "title": "using floating point in CC2538 based RE-Mote board for CoAP Server with Contiki OS", "body": "<blockquote>\n  <p>@eugene-nikolaev I am just playing by the examples available. I am not sure what you mean but I think set_payload_response() function might not take the values of double. If you can give me a hint as to how to proceed I can try it out. </p>\n</blockquote>\n\n<p>I am not very experienced in C so I cannot' show you a good snippet. But you're casting your buffer to (uint8_t) and for sure set_payload_response acquires binary payload.</p>\n\n<p>It would be like (I note again - it could be not too correct):</p>\n\n<pre><code>REST.set_response_payload(response, (uint8_t *) &amp;euler_data, sizeof(adafruit_bno055_vector_t));\n</code></pre>\n\n<p>But it will work only for your <code>else</code> branch. </p>\n\n<p>In a classical meaning of CoAP I am used to send a binary payload or CBOR-encoded payload, and parse it on the other side in the similar cases. It all depends on what are your CoAP peers and what do you want to achieve.</p>\n\n<p>UPD: Regarding the plaintext/json branches - I'd advise you to check which range/precision of values your module provides. Maybe there is no big point to use double as @Lundin said.</p>\n\n<p>Also, do you really need plain-text and json format?</p>\n"}], "owner": {"reputation": 2299, "user_id": 4851126, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/02d0041271b0178482aee8a36237e09e?s=128&d=identicon&r=PG", "display_name": "Shan-Desai", "link": "https://stackoverflow.com/users/4851126/shan-desai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "accepted_answer_id": 46074138, "answer_count": 1, "score": 0, "last_activity_date": 1504704625, "creation_date": 1504685880, "question_id": 46070117, "link": "https://stackoverflow.com/questions/46070117/using-floating-point-in-cc2538-based-re-mote-board-for-coap-server-with-contiki", "title": "using floating point in CC2538 based RE-Mote board for CoAP Server with Contiki OS", "body": "<p>I am using <a href=\"https://github.com/Zolertia/Resources/wiki/RE-Mote\" rel=\"nofollow noreferrer\">RE-Mote Development Board</a> along with <a href=\"https://github.com/contiki-os/contiki\" rel=\"nofollow noreferrer\">Contiki-OS</a>. I am interfacing it with <strong>Adafruit BNO055 Absolute Orientation Sensor</strong>. </p>\n\n<p>I want particularly:</p>\n\n<ol>\n<li>the <strong>Accelerometer Data</strong> in floating point precision.</li>\n<li>the <strong>Euler Angles</strong> in floating point precision.</li>\n</ol>\n\n<p>I did some digging in and found out that the <code>printf</code> in Contiki is Board dependent and <em>not many boards have floating point printing implementation</em>. <sup><a href=\"https://github.com/contiki-os/contiki/wiki/Input-and-output\" rel=\"nofollow noreferrer\">source</a></sup></p>\n\n<p>However this might become critical for creating a <strong>CoAP Resource</strong> because when returning data the code uses <code>snprintf</code>. </p>\n\n<p>The snippet:</p>\n\n<pre><code>/*GET Method*/\n\nRESOURCE(res_bno055,\n    \"title=\\\"BNO055 Euler\\\";rt=\\\"bno055\\\"\",\n    res_get_handler,\n    NULL,\n    NULL,\n    NULL);\n\nstatic void res_get_handler(void *request, void *response, uint8_t *buffer,\nuint16_t preferred_size, int32_t *offset) {\n\n   adafruit_bno055_vector_t euler_data = getVector(VECTOR_EULER);\n   double eu_x = euler_data.x;\n   double eu_y = euler_data.y;\n   double eu_z = euler_data.z;\n\n   unsigned int accept = -1;\n\n   REST.get_header_accept(request, &amp;accept);\n\n   if(accept == -1 || accept == REST.type.TEXT_PLAIN) {\n        /*PLAIN TEXT Response*/\n        REST.set_header_content_type(response, REST.type.TEXT_PLAIN);\n        // &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;will snprintf create a problem? &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;\n        snprintf((char *)buffer, REST_MAX_CHUNK_SIZE, \"%lf, %lf, %lf\",eu_x,eu_y, eu_z,);\n        REST.set_response_payload(response, (uint8_t *)buffer, strlen((char *)buffer));\n   } else if (accept == REST.type.APPLICATION_JSON) {\n        /*Return JSON REPONSE*/\n        REST.set_header_content_type(response, REST.type.APPLICATION_JSON);\n        // &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;same question here.. &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;\n        snprintf((char *)buffer, REST_MAX_CHUNK_SIZE, \"{'bno055_eu':{ 'X':%f, 'Y':%f, 'Z':%f}}\",\n        eu_x,  eu_y, eu_z);\n        REST.set_response_payload(response, buffer, strlen((char *)buffer));\n   } else {\n        REST.set_response_status(response, REST.status.NOT_ACCEPTABLE);\n        const char *msg = \"Only text/plain and application/json\";\n        REST.set_response_payload(response, msg, strlen(msg));\n   }\n}\n</code></pre>\n\n<p>I have tried the above mentioned <strong>Resource Code</strong> and setup a <strong>CoAP Server</strong> but I get</p>\n\n<p><em>plain-text response</em>:</p>\n\n<pre><code>, , ,\n</code></pre>\n\n<p><em>json response</em>:</p>\n\n<pre><code>{'bno055_eu: { 'X': , 'Y': , 'Z': }}\n</code></pre>\n\n<p>the <code>struct</code>:</p>\n\n<pre><code>typedef struct {\n    double x;\n    double y;\n    double z;\n}adafruit_bno055_vector_t\n</code></pre>\n\n<p>What would be an optimal way to create a <strong>GET CoAP Resource</strong> with floating point response?</p>\n"}, {"tags": ["c", "pointers", "compiler-errors", "embedded", "msp432"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 3, "creation_date": 1504684931, "post_id": 46069797, "comment_id": 79100192, "body": "It&#39;s very likely that your compiler isn&#39;t up-to-date to the C99 standard, which added features like being able to declare variables anywhere. Put all variable declarations at the top of the functions, before any other statements (like e.g. your assignment to <code>WDT_A-&gt;CTL</code>)."}, {"owner": {"reputation": 15221, "user_id": 1023911, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Wln26.jpg?s=128&g=1", "display_name": "Werner Henze", "link": "https://stackoverflow.com/users/1023911/werner-henze"}, "edited": false, "score": 0, "creation_date": 1504685621, "post_id": 46069797, "comment_id": 79100576, "body": "Where is the declaration/definition for <code>WDT_A</code>? I don&#39;t see it anywhere. Do you expect it to be in <code>msp.h</code>? Is it really there?"}, {"owner": {"reputation": 13, "user_id": 8195189, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41680c295b68dca740a40a02ac560c96?s=128&d=identicon&r=PG&f=1", "display_name": "SomeUser", "link": "https://stackoverflow.com/users/8195189/someuser"}, "edited": false, "score": 0, "creation_date": 1504694173, "post_id": 46069797, "comment_id": 79106588, "body": "Thanks for the help! However I tried declaring my variable at the beginning, at still received the same error."}, {"owner": {"reputation": 13, "user_id": 8195189, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41680c295b68dca740a40a02ac560c96?s=128&d=identicon&r=PG&f=1", "display_name": "SomeUser", "link": "https://stackoverflow.com/users/8195189/someuser"}, "edited": false, "score": 0, "creation_date": 1504694259, "post_id": 46069797, "comment_id": 79106645, "body": "The WDT_A line in included in the msp.h, and it just turns the watchdog timer off on my board."}, {"owner": {"reputation": 13, "user_id": 8195189, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41680c295b68dca740a40a02ac560c96?s=128&d=identicon&r=PG&f=1", "display_name": "SomeUser", "link": "https://stackoverflow.com/users/8195189/someuser"}, "edited": false, "score": 1, "creation_date": 1504694612, "post_id": 46069797, "comment_id": 79106865, "body": "I figured it out, for some reason my variable names weren&#39;t working, and when I changed the variable names it compiled!"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 3, "creation_date": 1504697791, "post_id": 46069797, "comment_id": 79109026, "body": "So likely there were already defined by the compiler in some register map header. Btw, those pointers must be <code>volatile</code> qualified or the code might decide to bug out."}, {"owner": {"reputation": 1447, "user_id": 6746897, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1eb640fcdc6847c55c189ceddb6afca5?s=128&d=identicon&r=PG&f=1", "display_name": "Julien", "link": "https://stackoverflow.com/users/6746897/julien"}, "edited": false, "score": 0, "creation_date": 1504765508, "post_id": 46069797, "comment_id": 79140012, "body": "You should definitely add the <code>volatile</code> keyword and <code>const</code> may be helpful too as the address of the register doesn&#39;t change (see  <a href=\"https://stackoverflow.com/questions/9734326/volatile-unsigned-int-const\" title=\"volatile unsigned int const\">stackoverflow.com/questions/9734326/volatile-unsigned-int-co&zwnj;&#8203;nst</a>)"}], "owner": {"reputation": 13, "user_id": 8195189, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41680c295b68dca740a40a02ac560c96?s=128&d=identicon&r=PG&f=1", "display_name": "SomeUser", "link": "https://stackoverflow.com/users/8195189/someuser"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 828, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1504685433, "creation_date": 1504684850, "last_edit_date": 1504685433, "question_id": 46069797, "link": "https://stackoverflow.com/questions/46069797/declaring-pointer-error-message-expected-an-identifier", "title": "Declaring Pointer Error Message: &quot;expected an identifier&quot;", "body": "<p>I am trying to define some pointers to the port registers on my board MSP432, however, in the following code when I attempt to declare my pointers, I keep receiving the following error:</p>\n\n<blockquote>\n<pre><code>\"../main.c\", line 11: error #41: expected an identifier\n\"../main.c\", line 11: error #80: expected a type specifier\n</code></pre>\n</blockquote>\n\n<p>I have tried several different alternations, but keep receiving the same error and am not sure how to fix it. Any help would be greatly appreciated! </p>\n\n<pre><code>#include \"msp.h\"\n#include &lt;stdint.h&gt;\n\nvoid main()\n{\n    unsigned int count = 0;\n    unsigned int i = 0;\n\n    WDT_A-&gt;CTL = WDT_A_CTL_PW | WDT_A_CTL_HOLD;\n\n    uint8_t * P1IN = (uint8_t *)0x40004C00;\n    uint8_t * P1SEL0 = (uint8_t *)0x40004C0A;\n    uint8_t * P1SEL1 = (uint8_t *)0x40004C0C;\n    uint8_t * P1OUT = (uint8_t *)0x40004C02;\n    uint8_t * PDIR = (uint8_t *)0x40004C04;\n\n.....\n</code></pre>\n"}, {"tags": ["c", "c++14"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 3, "creation_date": 1504683944, "post_id": 46069492, "comment_id": 79099608, "body": "&quot;<i>I was able to understand the concept of header file</i>&quot; -- If you really understood, you&#39;d never ask this question. Basically, just put your API declarations in a file and name it <code>.h</code> (or <code>.hpp</code>)."}, {"owner": {"reputation": 6398, "user_id": 4284627, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/2e017633cda5465e6683c74992cdec5e?s=128&d=identicon&r=PG", "display_name": "Donald Duck", "link": "https://stackoverflow.com/users/4284627/donald-duck"}, "edited": false, "score": 0, "creation_date": 1504785110, "post_id": 46069492, "comment_id": 79152931, "body": "What do you mean exactly? How to create the file? What should go in there? Please be more specific."}], "answers": [{"comments": [{"owner": {"reputation": 4827, "user_id": 8051589, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8VNG6.png?s=128&g=1", "display_name": "Andre Kampling", "link": "https://stackoverflow.com/users/8051589/andre-kampling"}, "edited": false, "score": 1, "creation_date": 1504684661, "post_id": 46069546, "comment_id": 79100030, "body": "For completeness you should mention <a href=\"https://en.wikipedia.org/wiki/Include_guard\" rel=\"nofollow noreferrer\">include guards</a>."}, {"owner": {"reputation": 11, "user_id": 8425036, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d99075d243ed563f72bc91ae18868ad4?s=128&d=identicon&r=PG&f=1", "display_name": "Sunil", "link": "https://stackoverflow.com/users/8425036/sunil"}, "edited": false, "score": 0, "creation_date": 1504799345, "post_id": 46069546, "comment_id": 79163463, "body": "thank you for spending your valuable time ,"}], "tags": [], "owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "is_accepted": false, "score": 1, "last_activity_date": 1504684781, "last_edit_date": 1504684781, "creation_date": 1504683947, "answer_id": 46069546, "question_id": 46069492, "link": "https://stackoverflow.com/questions/46069492/how-to-create-an-user-defined-header-file-hope-i-would-get-that-either-in-c/46069546#46069546", "title": "How to create an user-defined header file ? Hope , I would get that either in C/C++", "body": "<p>A header is just a C source file that generally only contains:</p>\n\n<ul>\n<li>Preprocessor <code>#define</code>s</li>\n<li>Type declarations</li>\n<li>Function declarations</li>\n<li>Comments :)</li>\n</ul>\n\n<p>There's nothing magical to it.</p>\n\n<p>This could be a fully valid entire header:</p>\n\n<pre><code>// Save this as \"adding.h\"\nint add_numbers(int a, int b);\n</code></pre>\n\n<p>It would be used like this:</p>\n\n<p>In the file <code>main.c</code>:</p>\n\n<pre><code>#include \"adding.h\"\n\nint main(void)\n{\n  const int x = 12;\n  const int y = 27;\n  printf(\"the sum of %d and %d is %d\\n\", x, y, add_numbers(x, y));\n  return 0;\n}\n</code></pre>\n\n<p>Then you'd of course also have <code>adding.c</code>:</p>\n\n<pre><code>#include \"adding.h\"\nint add_numbers(int a, int b)\n{\n  return a + b;\n}\n</code></pre>\n\n<p>--</p>\n\n<p>Sometimes, in real projects, headers <code>#include</code> other headers, and that can create problems with repeated definitions (and also costs compilation time). To protect against that, include guards are often added. It would look like this:</p>\n\n<pre><code>// In \"adding.h\".\n#if !defined ADDING_H_\n#define ADDING_H_\nint add_numbers(int a, int b);\n#endif  // ADDING_H_\n</code></pre>\n\n<p>The contents of the header is just wrapped in an <code>#if defined</code> block, with a <code>#define</code> of the checked-for symbol inside it. This makes sure that multiple inclusions during the compilation of a single C file are harmless.</p>\n"}], "owner": {"reputation": 11, "user_id": 8425036, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d99075d243ed563f72bc91ae18868ad4?s=128&d=identicon&r=PG&f=1", "display_name": "Sunil", "link": "https://stackoverflow.com/users/8425036/sunil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 239, "favorite_count": 0, "closed_date": 1504799954, "answer_count": 1, "score": -5, "last_activity_date": 1504684781, "creation_date": 1504683769, "question_id": 46069492, "link": "https://stackoverflow.com/questions/46069492/how-to-create-an-user-defined-header-file-hope-i-would-get-that-either-in-c", "closed_reason": "Duplicate", "title": "How to create an user-defined header file ? Hope , I would get that either in C/C++", "body": "<p>I am an beginner in C++ language. I was able to understand the concept of header file , but facing the problem when i wanted to deal with them. I want to create a user-defined header files ?\nExpecting someone to show me a sample of it!</p>\n\n<p>Thanks in advance,</p>\n"}, {"tags": ["c", "function", "reference", "static", "static-variables"], "comments": [{"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 2, "creation_date": 1504683581, "post_id": 46069411, "comment_id": 79099401, "body": "<code>printf(&quot;%d&quot;, &amp;multiple);</code> Remove <code>&amp;</code> --&gt; <code>printf(&quot;%d\\n&quot;, multiple);</code>"}, {"owner": {"reputation": 4031, "user_id": 7640269, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/szGUJ.png?s=128&g=1", "display_name": "danglingpointer", "link": "https://stackoverflow.com/users/7640269/danglingpointer"}, "edited": false, "score": 1, "creation_date": 1504683616, "post_id": 46069411, "comment_id": 79099422, "body": "You can use -g flag in gcc in order to debug why your getting big number. Debugging your program will help you to know what&#39;s causing the problem..by the way you don&#39;t use &amp; printf for static int type."}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1504698576, "post_id": 46069411, "comment_id": 79109592, "body": "Start with <code>gcc -Wall -Wextra</code> - that will help diagnose the mistake."}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 6833800, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/529b390228c452559c41e8d8d6011926?s=128&d=identicon&r=PG&f=1", "display_name": "andy kim", "link": "https://stackoverflow.com/users/6833800/andy-kim"}, "edited": false, "score": 0, "creation_date": 1504684110, "post_id": 46069483, "comment_id": 79099709, "body": "i have removed &amp; but it is still giving me the same number. is my while statement wrong?"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "reply_to_user": {"reputation": 33, "user_id": 6833800, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/529b390228c452559c41e8d8d6011926?s=128&d=identicon&r=PG&f=1", "display_name": "andy kim", "link": "https://stackoverflow.com/users/6833800/andy-kim"}, "edited": false, "score": 1, "creation_date": 1504684664, "post_id": 46069483, "comment_id": 79100032, "body": "@andykim Have you re-built after change?"}], "tags": [], "owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "is_accepted": false, "score": 2, "last_activity_date": 1504683757, "creation_date": 1504683757, "answer_id": 46069483, "question_id": 46069411, "link": "https://stackoverflow.com/questions/46069411/c-finding-multiples-of-a-number-using-static-variables/46069483#46069483", "title": "c finding multiples of a number using static variables?", "body": "<p>Remove the <code>&amp;</code> from your print.</p>\n\n<p>Change this:</p>\n\n<pre><code>printf(\"%d\", &amp;multiple);\n</code></pre>\n\n<p>to this:</p>\n\n<pre><code>printf(\"%d\", multiple);\n</code></pre>\n\n<hr>\n\n<p>PS: <a href=\"https://stackoverflow.com/questions/204476/what-should-main-return-in-c-and-c\">What should main() return in C and C++?</a></p>\n"}, {"tags": [], "owner": {"reputation": 868, "user_id": 4402433, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9bce35bd631fc9215f7885d6d0c84366?s=128&d=identicon&r=PG&f=1", "display_name": "Sathiya", "link": "https://stackoverflow.com/users/4402433/sathiya"}, "is_accepted": false, "score": 3, "last_activity_date": 1504740247, "last_edit_date": 1504740247, "creation_date": 1504683771, "answer_id": 46069494, "question_id": 46069411, "link": "https://stackoverflow.com/questions/46069411/c-finding-multiples-of-a-number-using-static-variables/46069494#46069494", "title": "c finding multiples of a number using static variables?", "body": "<p>In the <code>printf()</code>, the address of <code>multiple</code> is printed. Change the <code>printf(\"%d\", &amp;multiple);</code> to <code>printf(\"%d\\n\", multiple);</code>.</p>\n"}], "owner": {"reputation": 33, "user_id": 6833800, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/529b390228c452559c41e8d8d6011926?s=128&d=identicon&r=PG&f=1", "display_name": "andy kim", "link": "https://stackoverflow.com/users/6833800/andy-kim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1504740247, "creation_date": 1504683491, "last_edit_date": 1504683963, "question_id": 46069411, "link": "https://stackoverflow.com/questions/46069411/c-finding-multiples-of-a-number-using-static-variables", "title": "c finding multiples of a number using static variables?", "body": "<pre><code>#include&lt;stdio.h&gt;\n\nvoid function(void);\n\n\nvoid main (void)\n{\n    int number;\n    printf(\"call? yes(1) no(-1)\");\n    scanf(\"%d\", &amp;number);\n    while(number&gt;=0)\n    {\n        function();\n        printf(\"call? yes (1) no (-1)\");\n        scanf(\"%d\", &amp;number);\n\n    }\n}\n\n\nvoid function(void)\n{\n    static int multiple = 2;\n    printf(\"%d\", &amp;multiple);\n    multiple = multiple*2;\n\n}\n</code></pre>\n\n<p>hi this is my code for finding 2 multiplied by a number . i wanted it to print out 2,4,8,16 etc. however im getting some big number when i run this code. i just started learning c so any comment is appreciated </p>\n"}, {"tags": ["c", "string", "language-lawyer", "compiler-warnings", "string-literals"], "comments": [{"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1504682592, "post_id": 46068937, "comment_id": 79098792, "body": "It&#39;s not on by default because sadly there is still heaps of legacy code written in non-const correct fashion. Some even predates the addition of <code>const</code> to C."}, {"owner": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "edited": false, "score": 1, "creation_date": 1504683054, "post_id": 46068937, "comment_id": 79099068, "body": "Enabling such a warning by default would lead to alarm fatigue. It would be nice to have compilers warn for this but there is just too much old code that would trip over this while still being correct code."}], "answers": [{"comments": [{"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1504683669, "post_id": 46069089, "comment_id": 79099450, "body": "<i>&quot;and in rare cases invalid code to be accepted silently.&quot;</i> How would that happen? If <code>-Wwrite-strings</code> makes error checking more strict, this should not be possible."}, {"owner": {"user_type": "does_not_exist", "display_name": "user743382"}, "reply_to_user": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 4, "creation_date": 1504683937, "post_id": 46069089, "comment_id": 79099603, "body": "@user694733 Code which assigns the address of a string literal to a <code>const char (*)[]</code> variable will be accepted silently (unless it&#39;s been changed since I last checked), but in standard C, there is no implicit conversion from <code>char (*)[]</code> to <code>const char (*)[]</code>, so this requires a diagnostic."}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1504684652, "post_id": 46069089, "comment_id": 79100022, "body": "Not sure why anyone would take address of string literal, but I guess you are correct. I still think that warning about normal case <code>char * a = &quot;x&quot;;</code>, outweights that possible problem."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user743382"}, "is_accepted": false, "score": 14, "last_activity_date": 1504682632, "last_edit_date": 1504682632, "creation_date": 1504682296, "answer_id": 46069089, "question_id": 46068937, "link": "https://stackoverflow.com/questions/46068937/why-dont-c-compilers-warn-about-incompatible-types-with-literal-strings/46069089#46069089", "title": "Why don&#39;t C compilers warn about incompatible types with literal strings?", "body": "<p>There is an option for this: <code>-Wwrite-strings</code>. It works by changing the type of string literals from <code>char[N]</code> to <code>const char[N]</code>. This change is not compatible with standard C and will cause valid code to be rejected, and in rare cases invalid code to be accepted silently. It's not enabled by default.</p>\n\n<p>Unfortunately, due to the way string literals are defined in C, providing good warnings for this <em>without</em> changing the language is very difficult.</p>\n"}, {"comments": [{"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1504683895, "post_id": 46069135, "comment_id": 79099579, "body": "<i>&quot;Otherwise, it is just a nuisance.&quot;</i> It sounds like whoever wrote the manual is trying to make excuses for his own code :P."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1504684126, "post_id": 46069135, "comment_id": 79099717, "body": "umm...maybe not? const-to non-const is neither allowed nor implicit and warrants a diagnostic. making one side forcefully const qualified may break some valid code, you know?"}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 1, "creation_date": 1504684490, "post_id": 46069135, "comment_id": 79099915, "body": "Yes, you cannot use this option with legacy code. But any new code should strive to be const-correct. I just found it funny that manual sounds overly defensive."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1505153274, "post_id": 46069135, "comment_id": 79285765, "body": "That sentence was written more than 20 years ago. Back then, we were a lot less sanguine about the possibility of getting C programmers to tignten up their sloppy code. If I were revising this manual now I would say something more positive, perhaps &quot;If you are writing a new program from scratch, we recommend you use this option. However, enabling it for existing programs will be a great deal of work and is not likely to find very many bugs.&quot;"}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": true, "score": 16, "last_activity_date": 1504684500, "last_edit_date": 1504684500, "creation_date": 1504682422, "answer_id": 46069135, "question_id": 46068937, "link": "https://stackoverflow.com/questions/46068937/why-dont-c-compilers-warn-about-incompatible-types-with-literal-strings/46069135#46069135", "title": "Why don&#39;t C compilers warn about incompatible types with literal strings?", "body": "<p><strong>TL;DR</strong> C compilers do not warn, because they do not \"see\" a problem there. By definition, C string literals are null terminated <code>char</code> arrays. It's only stated that,</p>\n\n<blockquote>\n  <p>[...] If the program attempts to modify such an array, the behavior is\n  undefined.</p>\n</blockquote>\n\n<p>So, in the compilation process, it is not known to the compiler that a <code>char</code> array should behave as a <em>string literal</em> or <em>string</em>. Only the attempt to modification is <strong><em>prohibited</em></strong>.</p>\n\n<p><sub><b><em>Related read: For anybody interested, see <a href=\"https://softwareengineering.stackexchange.com/q/294748/110624\">Why are C string literals read-only?</a></em></sub></b></p>\n\n<p>That said, I am not very sure whether this is a <em>good</em> option, but <code>gcc</code> has <code>-Wwrite-strings</code> option.</p>\n\n<p>Quoting the <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Warning-Options.html#Warning-Options\" rel=\"noreferrer\">online manual</a>,</p>\n\n<blockquote>\n  <p><code>-Wwrite-strings</code></p>\n  \n  <p>When compiling C, give string constants the type <code>const char[length]</code> so that copying the address of one into a non-<code>const char *</code> pointer produces a warning. These warnings help you find at compile time code that can try to write into a string constant, but only if you have been very careful about using const in declarations and prototypes. Otherwise, it is just a nuisance. This is why we did not make <code>-Wall</code> request these warnings.</p>\n</blockquote>\n\n<p>So, it produces a warning using the <em>backdoor</em> way. </p>\n\n<p>By definition, C <em>string literals</em> (i.e., character string literals) are <code>char</code> arrays with null terminator. The standard does not mandate them to be <code>const</code> qualified. </p>\n\n<p>Ref: <code>C11</code>, chapter</p>\n\n<blockquote>\n  <p>In translation phase 7, a byte or code of value zero is appended to each multibyte\n  character sequence that results from a string literal or literals. The multibyte character\n  sequence is then used to initialize an array of static storage duration and length just\n  sufficient to contain the sequence. For character string literals, the array elements have\n  type <code>char</code>, and are initialized with the individual bytes of the multibyte character\n  sequence. [....]</p>\n</blockquote>\n\n<p>Using the aforesaid option makes the <em>string literals</em> <code>const</code> qualified so using a string literal as the RHS of assignment to a non-const type pointer triggers a warning.</p>\n\n<p>This is done with reference to <code>C11</code>, chapter \u00a76.7.3</p>\n\n<blockquote>\n  <p>If an attempt is made to modify an object defined with a const-qualified type through use\n  of an lvalue with non-const-qualified type, the behavior is undefined. [...]</p>\n</blockquote>\n\n<p>So, here the compiler produces a warning for the assignment of <code>const</code> qualified type to a non-<code>const</code>-qualified type.</p>\n\n<p>Related to why using <code>-Wall -Wextra -pedantic -std=c11</code> does not produce this warning, is, quoting the quote once again</p>\n\n<blockquote>\n  <p><em>[...] These warnings help you find at compile time code that can try to write into a string constant, but only if you have been very careful about using const in declarations and prototypes. Otherwise, it is just a nuisance. This is why we did not make <code>-Wall</code> request these warnings.</em></p>\n</blockquote>\n"}], "owner": {"reputation": 6600, "user_id": 1173674, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/364e5d67e6deec7330fdd25dc205e945?s=128&d=identicon&r=PG", "display_name": "anol", "link": "https://stackoverflow.com/users/1173674/anol"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 470, "favorite_count": 1, "closed_date": 1504687034, "accepted_answer_id": 46069135, "answer_count": 2, "score": 18, "last_activity_date": 1504684500, "creation_date": 1504681815, "last_edit_date": 1504684471, "question_id": 46068937, "link": "https://stackoverflow.com/questions/46068937/why-dont-c-compilers-warn-about-incompatible-types-with-literal-strings", "closed_reason": "Duplicate", "title": "Why don&#39;t C compilers warn about incompatible types with literal strings?", "body": "<p>The following program provokes systematic segmentation fault due to undefined behavior (trying to modify a string literal):</p>\n\n<pre><code>int main() {\n  char *s = \"immutable\";\n  s[0] = 'a';\n  return 0;\n}\n</code></pre>\n\n<p>Still, there seems to be absolutely no way to tell GCC/Clang to emit even the slightest warning about it (<code>-Wall -Wextra -pedantic -std=c11</code> don't do anything).</p>\n\n<p>Especially for beginners, this kind of situation would be useful to inform about. Even for non-beginners, in some slightly less obvious situations it could be helpful:</p>\n\n<pre><code>void f(char *s) {\n  s[0] = '0';\n}\n\nint main() {\n  char *s = \"immutable\";\n  f(\"literal\"); // oops\n  f(s); // oops\n  return 0;\n}\n</code></pre>\n\n<p>Besides, this would help enforce some <code>const</code>-culture in C programming.</p>\n\n<p>Why are such cases deliberately ignored? Does the standard actively prohibit diagnostics from being emitted in such cases, or is it mostly for backwards-compatibility (trying to enforce them now would generate too many warnings)?</p>\n"}, {"tags": ["c", "linux", "linux-kernel", "ftrace"], "comments": [{"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1504682660, "post_id": 46068776, "comment_id": 79098838, "body": "The linux oops message prints out the current PID and the threadinfo pointer. Perhaps you can check how that is implemented."}], "owner": {"reputation": 62800, "user_id": 391161, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/fb76d8bcc69144a3ee4c893ece7fc588?s=128&d=identicon&r=PG&f=1", "display_name": "merlin2011", "link": "https://stackoverflow.com/users/391161/merlin2011"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1504681189, "creation_date": 1504681189, "question_id": 46068776, "link": "https://stackoverflow.com/questions/46068776/is-there-a-way-to-access-the-most-recent-user-instruction-pointer-from-the-kerne", "title": "Is there a way to access the most recent user instruction pointer from the kernel?", "body": "<p>I am attempting to modify the Linux kernel's <code>user_exit</code> event tracepoint to give information about the code in user space that triggered it.</p>\n\n<p>Unfortunately, the state of the user program is not passed into the function <code>context_tracking_user_enter</code> in <code>kernel/context_tracking.c</code>.</p>\n\n<p><strong>Is there a way to extract the (ideally virtual) address of the last userspace instruction which ran on the current core?</strong></p>\n"}, {"tags": ["c", "unit-testing", "testing", "makefile", "stm32"], "answers": [{"tags": [], "owner": {"reputation": 101, "user_id": 8160896, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f511f3d8be563ab744c388b00d91c90d?s=128&d=identicon&r=PG&f=1", "display_name": "K0ertis", "link": "https://stackoverflow.com/users/8160896/k0ertis"}, "is_accepted": true, "score": 1, "last_activity_date": 1549444568, "creation_date": 1549444568, "answer_id": 54550075, "question_id": 46068192, "link": "https://stackoverflow.com/questions/46068192/ceedling-project-file-does-not-recognize-paths-and-libraries/54550075#54550075", "title": "Ceedling project file does not recognize paths and libraries", "body": "<p>for future readers, I switched to cppUTest. Its easy to use, and you have the power of cpp and the mocking is fantastic.</p>\n"}], "owner": {"reputation": 101, "user_id": 8160896, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f511f3d8be563ab744c388b00d91c90d?s=128&d=identicon&r=PG&f=1", "display_name": "K0ertis", "link": "https://stackoverflow.com/users/8160896/k0ertis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1069, "favorite_count": 0, "accepted_answer_id": 54550075, "answer_count": 1, "score": 1, "last_activity_date": 1549444568, "creation_date": 1504679037, "last_edit_date": 1592644375, "question_id": 46068192, "link": "https://stackoverflow.com/questions/46068192/ceedling-project-file-does-not-recognize-paths-and-libraries", "title": "Ceedling project file does not recognize paths and libraries", "body": "<p>I wanted to use ceedling for unit testing C Code for STM32 family.\nI installed it as shown on their page on <a href=\"https://github.com/ThrowTheSwitch/Ceedling\" rel=\"nofollow noreferrer\">GitHub Ceedling</a> and run successfully the example tests.</p>\n<p>The <strong>project.yml</strong> file I have modified the paths because I have a different path for header files (path: include) as the source files (path: src):</p>\n<pre><code>:paths:\n  :test:\n    - +:test/**\n    - -:test/support\n  :source:\n    - build/STM32F2xx_StdPeriph_Driver/include/**\n    - build/STM32F2xx_StdPeriph_Driver/src/**\n    - include/**\n    - src/**\n  :support:\n    - test/support\n\n\n  :defines:\n    :commmon: &amp;common_defines\n      #Define for header files\n      - STM32F2XX\n\n\n:libraries:\n  :placement: :end\n  :flag: &quot;${1}&quot;  # or &quot;-L ${1}&quot; for example\n  :common: &amp;common_libraries []\n  :test:\n    - *common_libraries\n      #toolchain of STM32F2\n    - build/STM32F2xx_StdPeriph_Driver/include/**\n    - build/STM32F2xx_StdPeriph_Driver/src/**\n    - build/STM32F2xx/include/\n</code></pre>\n<p>But somehow the path and libraries does not get recognized and I get error for unknown variables.</p>\n<p>Is my <strong>.yml</strong> file wrong?</p>\n"}, {"tags": ["python", "c", "swig", "ctypes", "typemaps"], "comments": [{"owner": {"reputation": 3868, "user_id": 2386026, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b480a437c4c0af43ae3866177c79e142?s=128&d=identicon&r=PG&f=1", "display_name": "Jens Munk", "link": "https://stackoverflow.com/users/2386026/jens-munk"}, "edited": false, "score": 1, "creation_date": 1504679268, "post_id": 46067853, "comment_id": 79096745, "body": "The types from <code>ctypes</code> are not compatible with <code>SWIG</code> like you try to use them. They are different types. I suggest that you include <code>%include &quot;carrays.i&quot; and %array_class(unsigner char, uint8ArrayClass)</code> to your <code>SWIG</code> interface file and use the generated <code>uint8ArrayClass(4)</code> to generate a wrapped C array for input for e.g. a length 4 array."}, {"owner": {"reputation": 19, "user_id": 7985344, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98d46c10371083e42f8207dfed0545c0?s=128&d=identicon&r=PG&f=1", "display_name": "lance huang", "link": "https://stackoverflow.com/users/7985344/lance-huang"}, "reply_to_user": {"reputation": 3868, "user_id": 2386026, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b480a437c4c0af43ae3866177c79e142?s=128&d=identicon&r=PG&f=1", "display_name": "Jens Munk", "link": "https://stackoverflow.com/users/2386026/jens-munk"}, "edited": false, "score": 0, "creation_date": 1504681702, "post_id": 46067853, "comment_id": 79098201, "body": "hi  thank u\uff0c could u show me a simple text\uff1f"}, {"owner": {"reputation": 3868, "user_id": 2386026, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b480a437c4c0af43ae3866177c79e142?s=128&d=identicon&r=PG&f=1", "display_name": "Jens Munk", "link": "https://stackoverflow.com/users/2386026/jens-munk"}, "edited": false, "score": 0, "creation_date": 1504681783, "post_id": 46067853, "comment_id": 79098258, "body": "Look in the swig manual search for the keywords I have provided"}], "answers": [{"tags": [], "owner": {"reputation": 3868, "user_id": 2386026, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b480a437c4c0af43ae3866177c79e142?s=128&d=identicon&r=PG&f=1", "display_name": "Jens Munk", "link": "https://stackoverflow.com/users/2386026/jens-munk"}, "is_accepted": false, "score": 1, "last_activity_date": 1504813481, "creation_date": 1504813481, "answer_id": 46103977, "question_id": 46067853, "link": "https://stackoverflow.com/questions/46067853/swig-c-library-and-ctypes-uint8-invalid-type/46103977#46103977", "title": "swig c library and ctypes uint8 invalid type", "body": "<p>I think this is fully described in the documentation, but here goes</p>\n\n<p>test.h</p>\n\n<pre><code>#pragma once\n#include &lt;cstdlib&gt;\n#include &lt;cstdint&gt;\nint func(uint8_t* a, const size_t len);\n</code></pre>\n\n<p>test.cpp</p>\n\n<pre><code>#include \"test.h\"\n\n#include &lt;iostream&gt;\n\nint func(uint8_t* a, const size_t len) {\n  int result = 0;\n  for (size_t i = 0 ; i &lt; len ; i++) {\n    result += int(a[i]);\n  }\n  return result;\n}\n</code></pre>\n\n<p>test.i</p>\n\n<pre><code>%module example\n%{\n  #include \"test.h\"\n%}\n\n%include \"carrays.i\"\n%include \"stdint.i\"\n%array_functions(uint8_t, uint8Array);\n\n%include \"test.h\"\n</code></pre>\n\n<p>setup.py</p>\n\n<pre><code>from distutils.core import setup, Extension\n\nsetup(name=\"example\",\n      py_modules=['example'],\n      ext_modules=[Extension(\"_example\",\n                     [\"test.i\",\"test.cpp\"],\n                     swig_opts=['-c++'],\n    extra_compile_args=['--std=c++11']\n                  )]\n\n)\n</code></pre>\n\n<p>Build using <code>python setup.py build_ext --inplace</code> and test using</p>\n\n<pre><code>import example\ng = example.new_uint8Array(3)\nexample.func(g,3)\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 7985344, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98d46c10371083e42f8207dfed0545c0?s=128&d=identicon&r=PG&f=1", "display_name": "lance huang", "link": "https://stackoverflow.com/users/7985344/lance-huang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 647, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1504813481, "creation_date": 1504677686, "last_edit_date": 1504813379, "question_id": 46067853, "link": "https://stackoverflow.com/questions/46067853/swig-c-library-and-ctypes-uint8-invalid-type", "title": "swig c library and ctypes uint8 invalid type", "body": "<p>I'm using swig to generate my C library, for example:</p>\n\n<p>mylib.py and _mylib.pyd</p>\n\n<pre><code>int func(uint8_t* a)\n{\n    return *a;\n}\n</code></pre>\n\n<p>in python:</p>\n\n<pre><code>import mylib\nimport ctypes\na = (ctypes.c_uint8 * 8)()\nmylib.func(a)\n</code></pre>\n\n<p>But running the Python gives me an error: <code>TypeError: in method 'func', argument 1 of type 'uint8 *'</code></p>\n\n<p>I search the typemaps, and I add it to my .i module file, like this:</p>\n\n<pre><code>%module mylib\n%include \"typemaps.i\"\nextern int func(uint8_t* INPUT);\n</code></pre>\n\n<p>python error to be.</p>\n\n<p>I print ctypes.c_uint8 and print mylib uint8, and I found  mylib uint8 is swig object. How to do this work?</p>\n"}, {"tags": ["c", "arrays", "char", "parameter-passing"], "comments": [{"owner": {"reputation": 852, "user_id": 1917004, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e12a0abb82fac3b2293597967a7ec90d?s=128&d=identicon&r=PG", "display_name": "ctrl-shift-esc", "link": "https://stackoverflow.com/users/1917004/ctrl-shift-esc"}, "edited": false, "score": 0, "creation_date": 1504677280, "post_id": 46067731, "comment_id": 79095790, "body": "What do you mean by <code>get console shutdown every time</code> ?"}, {"owner": {"reputation": 8376, "user_id": 5346095, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/45ae60b0c535116b89c74f42242c3e81?s=128&d=identicon&r=PG&f=1", "display_name": "JS dev", "link": "https://stackoverflow.com/users/5346095/js-dev"}, "edited": false, "score": 0, "creation_date": 1504677406, "post_id": 46067731, "comment_id": 79095840, "body": "Whats the error you are getting/ line num?"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 3, "creation_date": 1504677419, "post_id": 46067731, "comment_id": 79095847, "body": "Why are you passing <code>&amp;searchChars</code>?, just pass <code>searchChars</code> and change the prototype to <code>void get_lower_case(char *str)</code> (and adjust the references within). No need to <code>strncpy</code> anything."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1504677461, "post_id": 46067731, "comment_id": 79095868, "body": "There&#39;s no reason why you need to allocate and free memory; you can change each character in situ."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 1, "creation_date": 1504677560, "post_id": 46067731, "comment_id": 79095913, "body": "note that <code>temp</code>(and <code>str</code>) has changed since the while-loop."}, {"owner": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 0, "creation_date": 1504677832, "post_id": 46067731, "comment_id": 79096031, "body": "Are you on Windows, using Visual Studio?"}, {"owner": {"reputation": 3, "user_id": 8567101, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6f1d1b35484a1434cb1ad7e86588776?s=128&d=identicon&r=PG&f=1", "display_name": "Mathilda Hsu", "link": "https://stackoverflow.com/users/8567101/mathilda-hsu"}, "edited": false, "score": 0, "creation_date": 1504679466, "post_id": 46067731, "comment_id": 79096860, "body": "get console shutdown every time =&gt; means crush when i run it. I use dev-c++ 5.11 . thank you"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1504681385, "post_id": 46067731, "comment_id": 79098014, "body": "<a href=\"https://ideone.com/DLJwQx\" rel=\"nofollow noreferrer\">fix your approach</a>"}, {"owner": {"reputation": 3, "user_id": 8567101, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6f1d1b35484a1434cb1ad7e86588776?s=128&d=identicon&r=PG&f=1", "display_name": "Mathilda Hsu", "link": "https://stackoverflow.com/users/8567101/mathilda-hsu"}, "reply_to_user": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1504686023, "post_id": 46067731, "comment_id": 79100816, "body": "@BLUEPIXY thank you , I got it ! you are so kind."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1504755423, "post_id": 46067731, "comment_id": 79136706, "body": "regarding: <code>char *temp = (char *)malloc(str_len);</code>  1) the returned type from any of the heap allocation functions (malloc, calloc, realloc) is <code>void*</code> which can be assigned to any pointer.  Casting just clutters the code and is error prone when performing debug or maintenance.  2) always check (!=NULL) the returned value to assure the operation was successful.  3) the function: <code>strlen()</code> returns the index to the trailing NUL byte, and indexes start with 0 so have to add 1 to the call to <code>malloc()</code> to have enough room for the source string."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1504755817, "post_id": 46067731, "comment_id": 79136787, "body": "this loop: <code>while (**str)     {         *temp =lower(**str);         temp++;         *str++;     }</code> is a very bad idea.  Strongly suggest: <code>for( int i=0; (*str)[i]; i++ ) { temp[i] = lower( (*str)[i] );</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1504756062, "post_id": 46067731, "comment_id": 79136838, "body": "rather than writing a function: <code>lower()</code>,  much better to use: <code>#include &lt;ctype.h&gt; ...  temp[i] = tolower( (*str)[i] );</code>"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 8567101, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6f1d1b35484a1434cb1ad7e86588776?s=128&d=identicon&r=PG&f=1", "display_name": "Mathilda Hsu", "link": "https://stackoverflow.com/users/8567101/mathilda-hsu"}, "edited": false, "score": 0, "creation_date": 1504681722, "post_id": 46067908, "comment_id": 79098211, "body": "why when I use char* it wasn&#39;t worked?       search_str_in_file((char*)&quot;test.txt&quot;, (char*)&quot;FindTag&quot;);void search_str_in_file(char <i>fname, char</i> sub){get_lower_case(sub);}"}], "tags": [], "owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "is_accepted": true, "score": 1, "last_activity_date": 1504677955, "creation_date": 1504677955, "answer_id": 46067908, "question_id": 46067731, "link": "https://stackoverflow.com/questions/46067731/assign-a-char-array-to-the-other-which-is-also-a-argument-of-function-in-c/46067908#46067908", "title": "assign a char array to the other which is also a argument of function in c", "body": "<p>Continuing from the comments, there is no need to pass a <em>pointer to pointer to char</em> to <code>get_lower_case</code>. You have a modifiable string in <code>searchChars</code>, so simply pass the string and operate on the characters within it. You will greatly simply your conversion to lower case.</p>\n\n<p>Also, don't use magic numbers in your code, e.g. <code>(a &gt;= 0x41) &amp;&amp; (a &lt;= 0x5A)</code>, <code>(a &gt;= 'A') &amp;&amp; (a &lt;= 'Z')</code> is much easier to read. You can keep <code>0x20</code> as <code>32</code>.</p>\n\n<p>Putting the pieces together,  you could do something like the following:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint lower(int a) \n{\n    if ((a &gt;= 'A') &amp;&amp; (a &lt;= 'Z'))\n        a |= 0x20;\n    return a;  \n}\n\nvoid get_lower_case (char *str)\n{\n    while (*str) {\n        *str = lower(*str);\n        str++;\n    }\n}\n\nint main (void)\n{\n    char searchChars[] = \"FINDstring\";\n    get_lower_case(searchChars);\n    printf (\"%s\\n\", searchChars);\n\n    return (0);\n}\n</code></pre>\n\n<p><strong>Example Use/Output</strong></p>\n\n<pre><code>$ ./bin/tolower\nfindstring\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 8567101, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6f1d1b35484a1434cb1ad7e86588776?s=128&d=identicon&r=PG&f=1", "display_name": "Mathilda Hsu", "link": "https://stackoverflow.com/users/8567101/mathilda-hsu"}, "edited": false, "score": 0, "creation_date": 1504685873, "post_id": 46068596, "comment_id": 79100731, "body": "thank you for completely explaining about how pointer works while loop move on. I learned a lot."}], "tags": [], "owner": {"reputation": 539, "user_id": 2805824, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tBgwo.gif?s=128&g=1", "display_name": "Gaurav Pathak", "link": "https://stackoverflow.com/users/2805824/gaurav-pathak"}, "is_accepted": false, "score": 0, "last_activity_date": 1504680593, "creation_date": 1504680593, "answer_id": 46068596, "question_id": 46067731, "link": "https://stackoverflow.com/questions/46067731/assign-a-char-array-to-the-other-which-is-also-a-argument-of-function-in-c/46068596#46068596", "title": "assign a char array to the other which is also a argument of function in c", "body": "<p>The issue is in the <code>while</code> loop and the logic that is written to copy the string from source to destination.</p>\n\n<pre><code>while (**str)\n{\n    *temp =lower(**str);\n    temp++; //pointer is moved to next location of memory\n    *str++; //pointer is moved to next location of memory\n}\nstrncpy( *str, temp, str_len); //at this point both pointers are pointing to the end of the string\nfree(temp); //pointer is pointing to the end of the memory\n</code></pre>\n\n<p>In the <code>while</code> loop both the pointers are incremented to next location of memory and at the end of that loop both will point to the end of the string, the next statement is <code>strncpy()</code> and <code>free()</code> which is obviously going to fail as <code>strncpy</code> will copy garbage value to <code>str</code> and <code>temp</code> has moved to end so call to <code>free</code> will also fail.</p>\n\n<p>The best solution is the above one that @David C. Rankin has suggested or an alternative is, you can take two more pointers to point to <code>temp</code> and <code>str</code> at the beginning of the function <code>get_lower_case()</code> and use those two pointers to copy the string.</p>\n"}], "owner": {"reputation": 3, "user_id": 8567101, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6f1d1b35484a1434cb1ad7e86588776?s=128&d=identicon&r=PG&f=1", "display_name": "Mathilda Hsu", "link": "https://stackoverflow.com/users/8567101/mathilda-hsu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 46067908, "answer_count": 2, "score": 0, "last_activity_date": 1504680593, "creation_date": 1504677201, "question_id": 46067731, "link": "https://stackoverflow.com/questions/46067731/assign-a-char-array-to-the-other-which-is-also-a-argument-of-function-in-c", "title": "assign a char array to the other which is also a argument of function in c", "body": "<p>I run this code and get console shutdown every time.</p>\n\n<p>could you help me? thank you</p>\n\n<pre><code>int lower(int a) \n{\n    if ((a &gt;= 0x41) &amp;&amp; (a &lt;= 0x5A))\n        a |= 0x20; \n    return a;  \n}\nvoid get_lower_case(char** str)\n{\n    int str_len = strlen(*str);\n    char *temp = (char *)malloc(str_len);\n\n    while (**str)\n    {\n        *temp =lower(**str);\n        temp++;\n        *str++;\n    }\n    strncpy( *str, temp, str_len);\n    free(temp);\n}\nint main()\n{\nchar searchChars[] = \"findstring\";\nget_lower_case(&amp;searchChars);\n\nreturn (0);\n}\n</code></pre>\n\n<p>or there is any other way that I can change char array as argument?</p>\n"}, {"tags": ["c", "gcc"], "comments": [{"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 1, "creation_date": 1504673304, "post_id": 46066859, "comment_id": 79094423, "body": "I recommend to always use <a href=\"http://man7.org/linux/man-pages/man3/snprintf.3.html\" rel=\"nofollow noreferrer\">snprintf(3)</a> so code instead <code>snprintf(wtim, sizeof(wtim), &quot;%04d&#47;%02d&#47;%02d %02d:%02d:%02d&quot;</code> ... <code>)</code>"}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1504673376, "post_id": 46066859, "comment_id": 79094440, "body": "And in your case better use <a href=\"http://man7.org/linux/man-pages/man3/strftime.3.html\" rel=\"nofollow noreferrer\">strftime</a>"}], "answers": [{"comments": [{"owner": {"reputation": 157, "user_id": 6026774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/445902b8a133d244351b12a172544db3?s=128&d=identicon&r=PG&f=1", "display_name": "TJJ", "link": "https://stackoverflow.com/users/6026774/tjj"}, "edited": false, "score": 0, "creation_date": 1560016763, "post_id": 46066926, "comment_id": 99604848, "body": "What to do against it?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 157, "user_id": 6026774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/445902b8a133d244351b12a172544db3?s=128&d=identicon&r=PG&f=1", "display_name": "TJJ", "link": "https://stackoverflow.com/users/6026774/tjj"}, "edited": false, "score": 1, "creation_date": 1560023044, "post_id": 46066926, "comment_id": 99606154, "body": "@TJJ Increase the buffer size to be big enough to fit all character, including the terminator. Or use <code>snprintf</code> to not overwrite the buffer."}, {"owner": {"reputation": 157, "user_id": 6026774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/445902b8a133d244351b12a172544db3?s=128&d=identicon&r=PG&f=1", "display_name": "TJJ", "link": "https://stackoverflow.com/users/6026774/tjj"}, "edited": false, "score": 0, "creation_date": 1560083656, "post_id": 46066926, "comment_id": 99615141, "body": "I know from what I feed into sprintf that <code>%02d</code> cannot be bigger than two digits. But the warning also occurs with <code>snprintf</code>. I don&#39;t want to make the buffer bigger, because I want to save every bit of RAM possible. Is there a solution to get rid of the warning? Maybe even to ignore it?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 157, "user_id": 6026774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/445902b8a133d244351b12a172544db3?s=128&d=identicon&r=PG&f=1", "display_name": "TJJ", "link": "https://stackoverflow.com/users/6026774/tjj"}, "edited": false, "score": 0, "creation_date": 1560095764, "post_id": 46066926, "comment_id": 99617752, "body": "@TJJ <a href=\"https://ideone.com/PwTD0o\" rel=\"nofollow noreferrer\">Incorrect</a>. For integers the precision is minimum justification, not max number of digits to show."}, {"owner": {"reputation": 157, "user_id": 6026774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/445902b8a133d244351b12a172544db3?s=128&d=identicon&r=PG&f=1", "display_name": "TJJ", "link": "https://stackoverflow.com/users/6026774/tjj"}, "edited": false, "score": 1, "creation_date": 1560111674, "post_id": 46066926, "comment_id": 99621410, "body": "No, not in my case. That&#39;s why I specified &quot;from what I feed into <code>sprintf</code>&quot;. I do <code>iNum = iNum % 100</code> beforehand. Should have clarified that my int-variable cannot be bigger than 2 digits. Also, the numbers are always positive. So it&#39;s max. 2 digits, but I still get the warning. I think to get rid of the warning I need to check the return-value of <code>snprintf</code>."}], "tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": true, "score": 9, "last_activity_date": 1504674891, "last_edit_date": 1504674891, "creation_date": 1504673002, "answer_id": 46066926, "question_id": 46066859, "link": "https://stackoverflow.com/questions/46066859/how-to-evaluate-gcc-format-overflow-checking-size-72/46066926#46066926", "title": "How to evaluate gcc format-overflow checking size 72", "body": "<p>The <code>\"%d\"</code> format is for <code>int</code>, which is usually a 32-bit signed integer type. That means it can have up to 11 characters when printed (10 digits plus a possible minus for negative numbers). You have six of those meaning that's up to 66 character.</p>\n\n<p>Then you have five other characters (two each of <code>'/'</code> and <code>':'</code>, and a space).</p>\n\n<p>Plus terminator.</p>\n\n<p>That's 72.</p>\n\n<p>And remember that the <code>\"04\"</code> part of <code>\"%04d\"</code> means it will print four digits left-padded with zeros, but if there's more digits then it will print all of them. It's not an absolute limit.</p>\n\n<p>Therefore at least 20 characters, but up to 72.</p>\n"}, {"tags": [], "owner": {"reputation": 708, "user_id": 6149445, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e1a80f20cf9771af16b2b47dc3439517?s=128&d=identicon&r=PG", "display_name": "Mikael", "link": "https://stackoverflow.com/users/6149445/mikael"}, "is_accepted": false, "score": 2, "last_activity_date": 1504673636, "last_edit_date": 1504673636, "creation_date": 1504673011, "answer_id": 46066930, "question_id": 46066859, "link": "https://stackoverflow.com/questions/46066859/how-to-evaluate-gcc-format-overflow-checking-size-72/46066930#46066930", "title": "How to evaluate gcc format-overflow checking size 72", "body": "<p>Every string in C must have a null terminator, in order to know where the string ends, but I guess you already know that from your reputation.</p>\n\n<p>The error message says the string can have any number between 20 and 72 bytes, that is between 19 and 71 characters plus the null terminator. </p>\n\n<p>19 characters is found by finding the minimum possible string, which contains 19 characters because of the leading zeroes at each value. This formatted string can also contain up to 71 characters because of the limits of <code>int</code> (a number that can go up to 10 digits), so summing 11 in each <code>%d</code> occurrence (worst-case scenario with a leading negative sign) plus the other characters gives us 71).</p>\n\n<p>By having only 19 bytes to store the string, it is impossible to fit it all plus the null terminator, hence the error. So if you increase the size of your char array to 20 it is possible that it works because it is within the limits, but it is not guaranteed since the numbers can exceed this size.</p>\n"}], "owner": {"reputation": 11839, "user_id": 730346, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/86187a52f1e2f64890194d0451748ce5?s=128&d=identicon&r=PG", "display_name": "Daniel YC Lin", "link": "https://stackoverflow.com/users/730346/daniel-yc-lin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3586, "favorite_count": 0, "accepted_answer_id": 46066926, "answer_count": 2, "score": 2, "last_activity_date": 1504677876, "creation_date": 1504672600, "last_edit_date": 1504677876, "question_id": 46066859, "link": "https://stackoverflow.com/questions/46066859/how-to-evaluate-gcc-format-overflow-checking-size-72", "title": "How to evaluate gcc format-overflow checking size 72", "body": "<p>My sample code (t.c)</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;time.h&gt;\nint main() {\n        /* 12345678901234567890\n         * 2017/09/06 12:28:30  */\n        char wtime[19];\n        time_t t=time(NULL);\n        struct tm *pt = localtime(&amp;t);\n        sprintf(wtime, \"%04d/%02d/%02d %02d:%02d:%02d\", pt-&gt;tm_year+1900,\n            pt-&gt;tm_mon+1, pt-&gt;tm_mday, pt-&gt;tm_hour, pt-&gt;tm_min, pt-&gt;tm_sec);\n        printf(\"%s %ld\\n\", wtime, sizeof(int));\n        return 0;\n}\n</code></pre>\n\n<p>Warning message by <code>gcc -Wall -Wformat=2 -m64 t.c</code> (gcc 7.1.1)</p>\n\n<pre><code>t.c:9:47: warning: \u2018sprintf\u2019 writing a terminating nul past the end of the destination [-Wformat-overflow=]\n  sprintf(wtime, \"%04d/%02d/%02d %02d:%02d:%02d\", pt-&gt;tm_year+1900,\n                                               ^\nt.c:9:2: note: \u2018sprintf\u2019 output between 20 and 72 bytes into a destination of size 19\n  sprintf(wtime, \"%04d/%02d/%02d %02d:%02d:%02d\", pt-&gt;tm_year+1900,\n  ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n      pt-&gt;tm_mon+1, pt-&gt;tm_mday, pt-&gt;tm_hour, pt-&gt;tm_min, pt-&gt;tm_sec);\n      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n</code></pre>\n\n<p>The number 20 in the message is 19 and one terminator ('\\0').\nI am wonder, why there is a number 72? How to evaluate it.  It is not necessary to increase wtime as size 72 in this sample.</p>\n"}, {"tags": ["c", "visual-studio"], "comments": [{"owner": {"reputation": 4328, "user_id": 920069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd39f0db1f22e1314746491df063602a?s=128&d=identicon&r=PG", "display_name": "Retired Ninja", "link": "https://stackoverflow.com/users/920069/retired-ninja"}, "edited": false, "score": 2, "creation_date": 1504674115, "post_id": 46066782, "comment_id": 79094654, "body": "Pay attention to the output window when you compile. It will tell you if the build succeeds or fails, and if it fails it will tell you why."}, {"owner": {"reputation": 335, "user_id": 5327161, "user_type": "registered", "accept_rate": 73, "profile_image": "https://lh4.googleusercontent.com/-IxjuDTVEuws/AAAAAAAAAAI/AAAAAAAACeo/OtRCDRMxzEE/photo.jpg?sz=128", "display_name": "Vineet Patel", "link": "https://stackoverflow.com/users/5327161/vineet-patel"}, "reply_to_user": {"reputation": 4328, "user_id": 920069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd39f0db1f22e1314746491df063602a?s=128&d=identicon&r=PG", "display_name": "Retired Ninja", "link": "https://stackoverflow.com/users/920069/retired-ninja"}, "edited": false, "score": 0, "creation_date": 1504718163, "post_id": 46066782, "comment_id": 79123488, "body": "Thanks! I looked and apparently I can&#39;t have multiple main() functions in a single project or something?"}], "answers": [{"comments": [{"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 1, "creation_date": 1504674161, "post_id": 46066807, "comment_id": 79094668, "body": "But <code>#include &quot;stdio.h&quot;</code>  with a single ending double-quote should also work"}, {"owner": {"reputation": 6004, "user_id": 6471538, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Robert Columbia", "link": "https://stackoverflow.com/users/6471538/robert-columbia"}, "reply_to_user": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1504674408, "post_id": 46066807, "comment_id": 79094739, "body": "@BasileStarynkevitch perhaps, but that would be introducing an unnecessary difference in the two programs. Especially when learning, one should change one thing at a time."}, {"owner": {"reputation": 335, "user_id": 5327161, "user_type": "registered", "accept_rate": 73, "profile_image": "https://lh4.googleusercontent.com/-IxjuDTVEuws/AAAAAAAAAAI/AAAAAAAACeo/OtRCDRMxzEE/photo.jpg?sz=128", "display_name": "Vineet Patel", "link": "https://stackoverflow.com/users/5327161/vineet-patel"}, "edited": false, "score": 0, "creation_date": 1504717959, "post_id": 46066807, "comment_id": 79123372, "body": "My bad, I changed it originally to  see if that would fix the error. The same error still occurs"}], "tags": [], "owner": {"reputation": 6004, "user_id": 6471538, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Robert Columbia", "link": "https://stackoverflow.com/users/6471538/robert-columbia"}, "is_accepted": false, "score": 1, "last_activity_date": 1504676175, "last_edit_date": 1504676175, "creation_date": 1504672191, "answer_id": 46066807, "question_id": 46066782, "link": "https://stackoverflow.com/questions/46066782/unable-to-start-program-system-cannot-find-the-file-specified-error-in-visua/46066807#46066807", "title": "&quot;Unable to start program...system cannot find the file specified&quot; error in Visual Studio when writing C", "body": "<p>You are using <code>#include</code> incorrectly. The compiler is telling you that it could not find the file you wished to include.</p>\n\n<p>When you say</p>\n\n<pre><code>#include \"stdio.h\"\"\n</code></pre>\n\n<p>You should say instead</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n</code></pre>\n"}], "owner": {"reputation": 335, "user_id": 5327161, "user_type": "registered", "accept_rate": 73, "profile_image": "https://lh4.googleusercontent.com/-IxjuDTVEuws/AAAAAAAAAAI/AAAAAAAACeo/OtRCDRMxzEE/photo.jpg?sz=128", "display_name": "Vineet Patel", "link": "https://stackoverflow.com/users/5327161/vineet-patel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1056, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1520568807, "creation_date": 1504672044, "last_edit_date": 1520568807, "question_id": 46066782, "link": "https://stackoverflow.com/questions/46066782/unable-to-start-program-system-cannot-find-the-file-specified-error-in-visua", "title": "&quot;Unable to start program...system cannot find the file specified&quot; error in Visual Studio when writing C", "body": "<p>I am new to C, so I was writing really basic code on Visual Studio. The first program (Hello World) worked out perfectly, but when I added a second program (a loop), I get</p>\n\n<blockquote>\n  <p>unable to start program, System could cannot find the file specified</p>\n</blockquote>\n\n<p>Exact error (I added the 3 dots in the file path for privacy reasons)</p>\n\n<pre><code>-----\nMicrosoft Visual Studio\n---------------------------\nUnable to start program 'C:\\Users ... Learning Projects\\Learning\\Debug\\Learning.exe'.\n\nThe system cannot find the file specified.\n</code></pre>\n\n<p>First program:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n//links the program with the standard input output file\n//contains functions like printf \n\n//main function  \nint main() {\n\n    printf(\"hello World \\n\");\n    return (0);\n}\n</code></pre>\n\n<p>Second program:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n\nint main() {\n\n    int ch; \n    for (ch = 75; ch &lt;= 100; ch++) {\n        printf(\"ASCII value = %d, Character = %c\\n\", ch, ch); \n    }\n\n    return (0); \n}\n</code></pre>\n\n<p>This may be a stupid problem, but I am unable to figure out what is causing it. </p>\n"}, {"tags": ["c", "pointers", "null"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 3, "creation_date": 1504669784, "post_id": 46066466, "comment_id": 79093539, "body": "C or C++? They are two different languages, and it&#39;s especially important in cases like this where one language has a feature what will help directly, while the other language is missing that feature."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1504669869, "post_id": 46066466, "comment_id": 79093560, "body": "However, since the code itself is really plain C, and that&#39;s what you mention explicitly in the title, you should search for and do some research about <i>emulating pass by reference in C</i>."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1504670067, "post_id": 46066466, "comment_id": 79093624, "body": "The code you show doesn&#39;t compile \u2013 that makes it hard to deconstruct usefully to explain what&#39;s going wrong."}, {"owner": {"reputation": 708, "user_id": 6149445, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e1a80f20cf9771af16b2b47dc3439517?s=128&d=identicon&r=PG", "display_name": "Mikael", "link": "https://stackoverflow.com/users/6149445/mikael"}, "edited": false, "score": 0, "creation_date": 1504670167, "post_id": 46066466, "comment_id": 79093652, "body": "When you say &quot;the variable num remains at 0&quot;, you mean num_results, right? Since that&#39;s what you are printing."}], "answers": [{"comments": [{"owner": {"reputation": 708, "user_id": 6149445, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e1a80f20cf9771af16b2b47dc3439517?s=128&d=identicon&r=PG", "display_name": "Mikael", "link": "https://stackoverflow.com/users/6149445/mikael"}, "edited": false, "score": 3, "creation_date": 1504670122, "post_id": 46066544, "comment_id": 79093640, "body": "Simply finding a way to make the code work doesn&#39;t help the OP to understand what he did wrong."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 3, "creation_date": 1504670149, "post_id": 46066544, "comment_id": 79093645, "body": "You&#39;re right that the original code won&#39;t compile.  It isn&#39;t clear why this is an improvement, or how your design decisions (ignoring <code>results</code> parameter to <code>set()</code>, for example) are justified."}, {"owner": {"reputation": 401, "user_id": 7926640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15aaf0885ac6a86de3d42c23139abdb2?s=128&d=identicon&r=PG&f=1", "display_name": "stensal", "link": "https://stackoverflow.com/users/7926640/stensal"}, "edited": false, "score": 0, "creation_date": 1504670223, "post_id": 46066544, "comment_id": 79093665, "body": "completely agree with you."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1504672495, "post_id": 46066544, "comment_id": 79094195, "body": "Please note that you are expected to disclose your affiliation when you are promoting a site by showing it at work in answers.  You can add the information to your profile, and you should probably note it in each answer.  Please check the help centre for information (for example, <a href=\"https://stackoverflow.com/help/promotion\">Promotion \u2014 How to not be a spammer</a>)."}, {"owner": {"reputation": 401, "user_id": 7926640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15aaf0885ac6a86de3d42c23139abdb2?s=128&d=identicon&r=PG&f=1", "display_name": "stensal", "link": "https://stackoverflow.com/users/7926640/stensal"}, "edited": false, "score": 0, "creation_date": 1504676740, "post_id": 46066544, "comment_id": 79095550, "body": "Yes, it&#39;s my website and just released today.   I saw many people kept asking why my code cause seg-fault, and these causes apparently can be reported automatically.  Any feedback is highly appreciated.  Profile updated."}, {"owner": {"reputation": 881859, "user_id": 100297, "user_type": "moderator", "profile_image": "https://www.gravatar.com/avatar/24780fb6df85a943c7aea0402c843737?s=128&d=identicon&r=PG", "display_name": "Martijn Pieters", "link": "https://stackoverflow.com/users/100297/martijn-pieters"}, "edited": false, "score": 0, "creation_date": 1504684485, "post_id": 46066544, "comment_id": 79099911, "body": "Do include the disclaimer in your posts where you use the URL, it makes things all round clearer. Don&#39;t go seeking out posts explicitly to post links to your tool however; the guidelines <a href=\"https://meta.stackexchange.com/questions/229085/how-to-offer-personal-open-source-libraries\">in this post</a> apply here too."}], "tags": [], "owner": {"reputation": 401, "user_id": 7926640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15aaf0885ac6a86de3d42c23139abdb2?s=128&d=identicon&r=PG&f=1", "display_name": "stensal", "link": "https://stackoverflow.com/users/7926640/stensal"}, "is_accepted": false, "score": 0, "last_activity_date": 1549759220, "last_edit_date": 1549759220, "creation_date": 1504670028, "answer_id": 46066544, "question_id": 46066466, "link": "https://stackoverflow.com/questions/46066466/passing-null-pointer-in-function/46066544#46066544", "title": "Passing Null Pointer in Function", "body": "<p>Your code won't compile. Compiler error messages will tell you how to fix them. Here is a fixed one. </p>\n\n<pre><code>#include&lt;stdlib.h&gt;\n#include&lt;stdio.h&gt;\n\nint * num_results = NULL;\n\nvoid set(int * results, int num){\n    num_results = malloc(sizeof(int));\n    *num_results = num;\n}\n\nint main(void) {\n    int num = 4;\n    set(num_results, num);\n    printf(\"%d\\n\", *num_results);\n    return 0;\n}\n</code></pre>\n\n<p>For the sake of learning it, you can look at the compilation error messages here and try to fix it by yourself:<a href=\"https://segfault.stensal.com/a/XWfv8rxCJHVtAuRQ\" rel=\"nofollow noreferrer\">https://segfault.stensal.com/a/XWfv8rxCJHVtAuRQ</a></p>\n\n<p>Disclaimer: I built stensal.io as a tool to catch memory issues.</p>\n"}, {"tags": [], "owner": {"reputation": 3794, "user_id": 7256714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adeb98b0e8995d8576ad5f66c0f982e5?s=128&d=identicon&r=PG&f=1", "display_name": "Pras", "link": "https://stackoverflow.com/users/7256714/pras"}, "is_accepted": false, "score": 1, "last_activity_date": 1504671586, "last_edit_date": 1504671586, "creation_date": 1504671025, "answer_id": 46066658, "question_id": 46066466, "link": "https://stackoverflow.com/questions/46066466/passing-null-pointer-in-function/46066658#46066658", "title": "Passing Null Pointer in Function", "body": "<pre><code>set(num_results, num);\n</code></pre>\n\n<p>Here NULL is getting passed to <code>results</code> variable in <code>set()</code>, when you allocate memory to <code>results</code>, NULL is getting replaced by valid memory address, but you need to understand it will be held in <code>results</code> variable only as its a local variable to <code>set()</code></p>\n\n<p>You should either pass address of <code>num_results</code> to <code>set()</code> so that memory allocated in <code>set()</code> is retained in <code>main()</code>, or just allocate memory to <code>num_results</code> in main function then pass it to <code>set()</code> as done below:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint main() {\n    int *num_results = NULL;\n    int num = 4;\n    num_results = malloc(sizeof(int));\n    set(num_results, num);\n    printf(\"%d\\n\", *num_results);\n    return 0;\n}\n\nvoid set(int *results,int num){\n    *results = num;\n}\n</code></pre>\n\n<p>Another example would be:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\nvoid set(int **r, int num);\nint main() {\n    int *num_results = NULL;\n    int num = 4;\n    /*num_results = malloc(sizeof(int));*/\n    set(&amp;num_results, num);\n    printf(\"%d\\n\", *num_results);\n    return 0;\n}\n\nvoid set(int **results,int num){\n    *results = malloc(sizeof(int));\n    *(*results) = num;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 93, "user_id": 6077989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5b6fbe2a6fd82a0c980d29bf2ca1734?s=128&d=identicon&r=PG", "display_name": "Ameida", "link": "https://stackoverflow.com/users/6077989/ameida"}, "is_accepted": false, "score": 0, "last_activity_date": 1504671168, "creation_date": 1504671168, "answer_id": 46066674, "question_id": 46066466, "link": "https://stackoverflow.com/questions/46066466/passing-null-pointer-in-function/46066674#46066674", "title": "Passing Null Pointer in Function", "body": "<p>In your helper function you should refer to the first parameter name results instead of num_results. Your helper function should be like:</p>\n\n<pre><code>void set(int * results, int num){\n    results = malloc(sizeof(int));\n    *results = num;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 708, "user_id": 6149445, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e1a80f20cf9771af16b2b47dc3439517?s=128&d=identicon&r=PG", "display_name": "Mikael", "link": "https://stackoverflow.com/users/6149445/mikael"}, "edited": false, "score": 0, "creation_date": 1504671623, "post_id": 46066717, "comment_id": 79093992, "body": "I&#39;m also assuming OP really wants to allocate memory inside the set function."}], "tags": [], "owner": {"reputation": 708, "user_id": 6149445, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e1a80f20cf9771af16b2b47dc3439517?s=128&d=identicon&r=PG", "display_name": "Mikael", "link": "https://stackoverflow.com/users/6149445/mikael"}, "is_accepted": false, "score": 6, "last_activity_date": 1504671523, "creation_date": 1504671523, "answer_id": 46066717, "question_id": 46066466, "link": "https://stackoverflow.com/questions/46066466/passing-null-pointer-in-function/46066717#46066717", "title": "Passing Null Pointer in Function", "body": "<p>I'm going to guess what you really mean with your question and try to give a decent answer.</p>\n\n<p>I guess you want to change <code>num_results</code> to be equal to <code>num</code> by passing it to the function <code>set</code> as a pointer, and I can see a few mistakes you've made:</p>\n\n<ol>\n<li>You probably have this in your full code, but don't forget to <code>#include &lt;stdio.h&gt;</code> to use <code>printf()</code> and to <code>#include &lt;stdlib.h&gt;</code> to use <code>malloc()</code></li>\n<li>Your function <code>set()</code> should be declared before <code>main()</code>, you can do this by declaring a <a href=\"https://www.quora.com/What-is-meant-by-prototype-in-C\" rel=\"noreferrer\">prototype</a> before <code>main()</code> or simply defining the <code>set()</code> function before <code>main()</code>.</li>\n</ol>\n\n<p>Now let's go to your solution: you want to pass the <code>num_results</code> as a parameter to a function, allocate some memory and assign the address to <code>num_results</code> and then update the value to the one in <code>num</code>.</p>\n\n<p>When you pass an <code>int *</code> as a parameter, I guess you already know that by passing <code>int</code> you are simply giving a copy of what is inside an <code>int</code> variable. This works the same way with an <code>int *</code>, you are not passing a reference to <code>num_results</code> so that you can update the address of the pointer, you are passing a <strong>copy</strong> of the current address, <code>NULL</code>, which will not be modified. What <em>could</em> be modified is what is inside of the current address, but the current address is <code>NULL</code>, so not can really be modified.</p>\n\n<p>Since you want to allocate memory and assign its address to <code>num_results</code>, you must pass <strong>a pointer to a pointer</strong>, so you are passing the address of where your <code>int*</code> variable is being kept and where you can <strong>actually</strong> change it.</p>\n\n<p>This way, your function should look like <code>void set(int ** results, int num)</code> and you should call it with <code>set(&amp;num_results, num)</code>, so you are passing a reference to num_results, where you can change the address it points to, currently <code>NULL</code> and then the address returned by <code>malloc()</code>. </p>\n\n<p>You'd also have to change the body of your function, because you're now using an <code>int **</code>, you want to assign the new address to <code>*results</code>, because <code>results == &amp;num_results</code>, and assign num to <code>**results</code>, because <code>*results = num_results</code>.</p>\n\n<p>I hope my explanation is not very confusing and hopefully someone can explain it better with another answer or by editing mine. Final code: </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nvoid set(int ** results, int num){\n    *results = malloc(sizeof(int));\n    **results = num;\n}\n\nint main(void) {\n    int * num_results = NULL;\n    int num = 4;\n    set(&amp;num_results, num);\n    printf(\"%d\\n\", *num_results);\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 1, "last_activity_date": 1504671915, "creation_date": 1504671915, "answer_id": 46066756, "question_id": 46066466, "link": "https://stackoverflow.com/questions/46066466/passing-null-pointer-in-function/46066756#46066756", "title": "Passing Null Pointer in Function", "body": "<blockquote>\n  <p>How do I adjust the content of the helper function to update num correctly?</p>\n</blockquote>\n\n<p>That seems the wrong question, as your <code>set()</code> function seems intended to copy the value of <code>num</code> elsewhere, not to update <code>num</code> itself.</p>\n\n<p>One of your problems is <em>where</em> to copy it.  Presently, you allocate some memory for that dynamically, and copy it there.  That's fine as far as it goes, but the pointer to the allocated memory is not conveyed back to the caller.  This is because all C functions pass arguments <em>by value</em>, and in particular, your <code>main()</code> passes the first argument of <code>set()</code> by value (a value of type <code>int *</code>).  Modifying the function's copy does not affect its caller's copy -- that's what pass-by-value is all about.</p>\n\n<p>You may be overlooking a simple fact: dynamic allocation is not the only way to obtain a valid pointer value, nor even the the most important or common.  When you see a pointer, you should not automatically go looking for <code>malloc()</code>.  You can very easily get a pointer from an array, but perhaps even more importantly, you can get a pointer value by applying the address-of operator (<code>&amp;</code>).</p>\n\n<p>For your <code>set()</code> function to do work that its caller can see without resorting to global variables or changing its signature, the caller must pass as the first parameter a valid pointer to an object that the caller can access, such as one of its own local variables.  The pointer is passed by value so the function gets a copy, but it's a <em>copy</em>: it points to the same object that the caller's pointer did.  The <code>set()</code> function can therefore modify the pointed-to object via its copy of the pointer to it.</p>\n\n<p>So suppose your <code>main()</code> declared its own local variable <code>result</code>, an <code>int</code>.  What do you suppose it could do with <code>&amp;result</code>?</p>\n"}], "owner": {"reputation": 31, "user_id": 8566749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a13c3b2d10a0b5d4b7bf11420f127737?s=128&d=identicon&r=PG&f=1", "display_name": "Margaret Smith", "link": "https://stackoverflow.com/users/8566749/margaret-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7760, "favorite_count": 0, "answer_count": 5, "score": 3, "last_activity_date": 1549759220, "creation_date": 1504669587, "last_edit_date": 1504672661, "question_id": 46066466, "link": "https://stackoverflow.com/questions/46066466/passing-null-pointer-in-function", "title": "Passing Null Pointer in Function", "body": "<p>This variable num remains at 0. I suspect this is because I am passing in a NULL pointer, but I am constrained to the main (and parameters) as is. How do I adjust the content of the helper function to update num correctly?</p>\n\n<pre><code>int main(void) {\n    int * num_results = NULL;\n    int num = 4;\n    set(num_results, num);\n    printf(\u201c%d\\n\u201d, *num_results);\n    return 0;\n}\n\nvoid set(int * results,num){\n    num_results = malloc(sizeof(int));\n    *num_results = num;\n}\n</code></pre>\n"}, {"tags": ["c", "linux", "pointers", "gcc", "openssl"], "comments": [{"owner": {"reputation": 13419, "user_id": 1405588, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/01a91a47db3526000ffa9247f95fff62?s=128&d=identicon&r=PG", "display_name": "o11c", "link": "https://stackoverflow.com/users/1405588/o11c"}, "edited": false, "score": 0, "creation_date": 1504670626, "post_id": 46066337, "comment_id": 79093746, "body": "Remember that segmentation faults happen for pointers to <i>any</i> unmapped page, not just NULL."}, {"owner": {"reputation": 343, "user_id": 5148356, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0f122901fd2691edb617f0447fd4f22a?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan Wang", "link": "https://stackoverflow.com/users/5148356/ryan-wang"}, "reply_to_user": {"reputation": 13419, "user_id": 1405588, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/01a91a47db3526000ffa9247f95fff62?s=128&d=identicon&r=PG", "display_name": "o11c", "link": "https://stackoverflow.com/users/1405588/o11c"}, "edited": false, "score": 0, "creation_date": 1504670714, "post_id": 46066337, "comment_id": 79093764, "body": "@o11c Correct, but when I print the pointer value it says (nil), what might cause this?"}, {"owner": {"reputation": 3794, "user_id": 7256714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adeb98b0e8995d8576ad5f66c0f982e5?s=128&d=identicon&r=PG&f=1", "display_name": "Pras", "link": "https://stackoverflow.com/users/7256714/pras"}, "edited": false, "score": 0, "creation_date": 1504672123, "post_id": 46066337, "comment_id": 79094122, "body": "OPENSSL_malloc appears to fail, have you checked EVP_MD_size returns non zero value that you are passing to OPENSSL_malloc"}, {"owner": {"reputation": 5562, "user_id": 1946679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed74e2cdc59d058b76a76c90dd3c3bdc?s=128&d=identicon&r=PG", "display_name": "Matt Caswell", "link": "https://stackoverflow.com/users/1946679/matt-caswell"}, "edited": false, "score": 0, "creation_date": 1504681868, "post_id": 46066337, "comment_id": 79098306, "body": "<code>*vlen</code> should be initialised to the amount of data that you have malloc&#39;d (i.e. <code>EVP_MD_size(EVP_sha256())</code>, <i>before</i> you call EVP_DigestSignFinal"}, {"owner": {"reputation": 343, "user_id": 5148356, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0f122901fd2691edb617f0447fd4f22a?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan Wang", "link": "https://stackoverflow.com/users/5148356/ryan-wang"}, "reply_to_user": {"reputation": 3794, "user_id": 7256714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adeb98b0e8995d8576ad5f66c0f982e5?s=128&d=identicon&r=PG&f=1", "display_name": "Pras", "link": "https://stackoverflow.com/users/7256714/pras"}, "edited": false, "score": 0, "creation_date": 1504719155, "post_id": 46066337, "comment_id": 79124027, "body": "@Pras Yes I just did a check and the output seems fine(see the edit), by the way the first print for the pointer value proves that the pointer has got successfully allocated because I pass the pointer val to the function by calling like <code>unsigned char * ptr = NULL; hmac_message(..., &amp;ptr, ...);</code>"}, {"owner": {"reputation": 343, "user_id": 5148356, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0f122901fd2691edb617f0447fd4f22a?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan Wang", "link": "https://stackoverflow.com/users/5148356/ryan-wang"}, "reply_to_user": {"reputation": 5562, "user_id": 1946679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed74e2cdc59d058b76a76c90dd3c3bdc?s=128&d=identicon&r=PG", "display_name": "Matt Caswell", "link": "https://stackoverflow.com/users/1946679/matt-caswell"}, "edited": false, "score": 0, "creation_date": 1504719189, "post_id": 46066337, "comment_id": 79124051, "body": "@MattCaswell Isn&#39;t <code>OPENSSL_malloc</code> doing this for me?"}, {"owner": {"reputation": 5562, "user_id": 1946679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed74e2cdc59d058b76a76c90dd3c3bdc?s=128&d=identicon&r=PG", "display_name": "Matt Caswell", "link": "https://stackoverflow.com/users/1946679/matt-caswell"}, "edited": false, "score": 0, "creation_date": 1504735460, "post_id": 46066337, "comment_id": 79132068, "body": "The first time you use <code>vlen</code> in your code is in the EVP_DigestSignFinal() call, so how could OPENSSL_malloc() have set it for you?"}, {"owner": {"reputation": 343, "user_id": 5148356, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0f122901fd2691edb617f0447fd4f22a?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan Wang", "link": "https://stackoverflow.com/users/5148356/ryan-wang"}, "reply_to_user": {"reputation": 5562, "user_id": 1946679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed74e2cdc59d058b76a76c90dd3c3bdc?s=128&d=identicon&r=PG", "display_name": "Matt Caswell", "link": "https://stackoverflow.com/users/1946679/matt-caswell"}, "edited": false, "score": 0, "creation_date": 1504741440, "post_id": 46066337, "comment_id": 79133659, "body": "@MattCaswell Sorry I mistook it for <code>val</code>, yes I added a line setting the <code>*vlen</code> to <code>EVP_MD_size(EVP_sha256())</code> and I still got the same result."}, {"owner": {"reputation": 343, "user_id": 5148356, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0f122901fd2691edb617f0447fd4f22a?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan Wang", "link": "https://stackoverflow.com/users/5148356/ryan-wang"}, "reply_to_user": {"reputation": 13419, "user_id": 1405588, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/01a91a47db3526000ffa9247f95fff62?s=128&d=identicon&r=PG", "display_name": "o11c", "link": "https://stackoverflow.com/users/1405588/o11c"}, "edited": false, "score": 0, "creation_date": 1504808812, "post_id": 46066337, "comment_id": 79168585, "body": "@o11c @Pras @MattCaswell Guys, I tried editing the code to declare a local pointer variable and do all the stuff above, and set the local variable value to <code>*val</code> then everything works well. This is super weird, why this happens under gcc/linux remains a mystery."}], "owner": {"reputation": 343, "user_id": 5148356, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0f122901fd2691edb617f0447fd4f22a?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan Wang", "link": "https://stackoverflow.com/users/5148356/ryan-wang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 301, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1505859027, "creation_date": 1504668618, "last_edit_date": 1505859027, "question_id": 46066337, "link": "https://stackoverflow.com/questions/46066337/openssl-evp-digestsignfinal-makes-the-pointer-null-in-gcc-linux", "title": "OpenSSL EVP_DigestSignFinal makes the pointer NULL in gcc/linux", "body": "<p>I'm writing an OpenSSL program which contains the following code for generating HMAC value</p>\n\n<pre><code>void hmac_message(unsigned char* msg, size_t mlen, unsigned char** val, size_t* vlen, unsigned char *key)\n{\n  EVP_MD_CTX* mdctx = NULL;\n  const EVP_MD* md = NULL;\n  EVP_PKEY *pkey = NULL;\n\n  if(!(mdctx = EVP_MD_CTX_create()))\n    handleErrors();\n\n  if(!(md = EVP_get_digestbyname(\"SHA256\")))\n    handleErrors();\n\n  if(!(pkey = EVP_PKEY_new_mac_key(EVP_PKEY_HMAC, NULL, key, EVP_MD_size(EVP_sha256()))))\n    handleErrors();\n\n  if(1 != EVP_DigestSignInit(mdctx, NULL, md, NULL, pkey))\n    handleErrors();\n\n  /* Call update with the message */\n  int md_len = 0;\n  if(1 != EVP_DigestSignUpdate(mdctx, msg, mlen))\n    handleErrors();\n\n  if(((*val) = (unsigned char *)OPENSSL_malloc(EVP_MD_size(EVP_sha256()))) == NULL)\n    handleErrors();\n  printf(\"msg %s\\n\", msg);\n\n  if(*val == NULL) {\n    printf(\"Null Pointer error!\\n\");\n  }\n  printf(\"1: %p\\n\", *val);\n  if(1 != EVP_DigestSignFinal(mdctx, *val, vlen))\n    handleErrors();\n  printf(\"2: %p\\n\", *val);\n  BIO_dump_fp(stdout, *val, 32);\n\n  EVP_PKEY_free(pkey);\n  EVP_MD_CTX_destroy(mdctx);\n\n  return;\n}\n</code></pre>\n\n<p>And I use travis CI to test it, however I always get this result:</p>\n\n<blockquote>\n  <p>msg www.google.com</p>\n  \n  <p>1: 0x1fd7a20</p>\n  \n  <p>2: (nil)</p>\n  \n  <p>/home/travis/.travis/job_stages: line 57:  3821 Segmentation fault    </p>\n</blockquote>\n\n<p>Which means the *val pointer is set to NULL, that shouldn't be happening.</p>\n\n<p>The code works perfectly on my mac and on gcc/OSX, clang/OSX, clang/linux on travis, only fails on gcc/linux. I tried different version of gcc like 4.9/5/6 they all get the same result.</p>\n\n<p><strong>EDIT</strong>:\nI tried adding output for MD_SIZE and the result is </p>\n\n<blockquote>\n  <p>MD SIZE: 32 </p>\n  \n  <p>msg www.google.com </p>\n  \n  <p>1: 0xbb7a20  </p>\n  \n  <p>2: (nil)</p>\n  \n  <p>/home/travis/.travis/job_stages: line 57:  3860 Segmentation fault</p>\n</blockquote>\n\n<p>This is really weird.</p>\n\n<p><strong>EDIT on 9/7/2017</strong></p>\n\n<p>I tried editing the code to declare a local pointer variable and do all the stuff above, and set the local variable value to <code>*val</code> then everything works well. This is super weird, why this happens under gcc/linux remains a mystery. If anyone has some ideas about the reason, please post an answer.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 13419, "user_id": 1405588, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/01a91a47db3526000ffa9247f95fff62?s=128&d=identicon&r=PG", "display_name": "o11c", "link": "https://stackoverflow.com/users/1405588/o11c"}, "edited": false, "score": 0, "creation_date": 1504670450, "post_id": 46066294, "comment_id": 79093717, "body": "Please, <i>please</i> learn to use <code>const</code>."}, {"owner": {"reputation": 13419, "user_id": 1405588, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/01a91a47db3526000ffa9247f95fff62?s=128&d=identicon&r=PG", "display_name": "o11c", "link": "https://stackoverflow.com/users/1405588/o11c"}, "edited": false, "score": 0, "creation_date": 1504670548, "post_id": 46066294, "comment_id": 79093735, "body": "There is a tiny performance difference in PIC, in that the first requires a relocation, but that is really not what you should be worried about."}], "answers": [{"tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": true, "score": 5, "last_activity_date": 1504669225, "creation_date": 1504669225, "answer_id": 46066415, "question_id": 46066294, "link": "https://stackoverflow.com/questions/46066294/which-is-the-efficient-method-to-initialize-a-char-to-nothing-in-c-from-the-gi/46066415#46066415", "title": "Which is the efficient method to initialize a char * to nothing in C from the given ones?", "body": "<p>The two versions with the cast are non-standard; the cast is not necessary in either case (though there is more justification for it in the second of them).</p>\n\n<p>The initializations do two different jobs \u2014 both are good jobs, but they are different.</p>\n\n<pre><code>static char *name = \"\";\n</code></pre>\n\n<p>Here, <code>name</code> is a valid pointer to an empty string.  It can be passed to functions that expect a valid pointer but where an empty string is sensible.</p>\n\n<pre><code>static char *name = NULL;\nstatic char *name = 0;\n</code></pre>\n\n<p>In both these cases, <code>name</code> is a null pointer \u2014 it doesn't point to anywhere valid.  Dereferencing <code>name</code> after either of these initializations leads to undefined behaviour, which means your program typically (but not necessarily) crashes.  You need to make the variable point at something valid before dereferencing it.</p>\n"}], "owner": {"reputation": 1180, "user_id": 4233968, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/34a8a28a578ed988cb3b7800cc79a867?s=128&d=identicon&r=PG&f=1", "display_name": "achoora", "link": "https://stackoverflow.com/users/4233968/achoora"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 46066415, "answer_count": 1, "score": 0, "last_activity_date": 1504669225, "creation_date": 1504668311, "last_edit_date": 1504668971, "question_id": 46066294, "link": "https://stackoverflow.com/questions/46066294/which-is-the-efficient-method-to-initialize-a-char-to-nothing-in-c-from-the-gi", "title": "Which is the efficient method to initialize a char * to nothing in C from the given ones?", "body": "<p>The question may seem elementary but it's about a choice.\nI have seen these in same code base and got a little confused over the approach.</p>\n\n<p>We do an empty string initialisation so we don't get dereference error (I think).</p>\n\n<pre><code>static char *name=(char *)\"\";\n</code></pre>\n\n<p>and majority cases I have seen this</p>\n\n<pre><code>static char *name=NULL;\n</code></pre>\n\n<p>and on rare occasions have seen this too.</p>\n\n<pre><code>static char *name=(char *) 0;\n</code></pre>\n\n<p>Can we call any of these practices as standard and is universally recommended? If yes on what logic?</p>\n"}, {"tags": ["c", "file", "file-handling"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1504669990, "post_id": 46066273, "comment_id": 79093595, "body": "Under what circumstances should the code add 2 to the line \u2014 you don&#39;t show any value other than 1 being added.  You almost certainly need to read whole lines using <code>fgets()</code> and then parse the lines using <code>sscanf()</code>.  If the row that started with 717 started with 777 instead, what would be the expected output?  It could easily be <code>717 339 1333 1341 1337 1</code> or <code>717 339 1333 1</code>, or it could be some other value.  At the moment, you&#39;ve not fully specified the problem."}, {"owner": {"reputation": 23, "user_id": 7859892, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/08961d27608192e378add6638793fd71?s=128&d=identicon&r=PG&f=1", "display_name": "prasath", "link": "https://stackoverflow.com/users/7859892/prasath"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1504670601, "post_id": 46066273, "comment_id": 79093742, "body": "thanks for your reply, the expected output is 717 339 1333 1341 1337 1. the valve 1 should add at the end of the line."}, {"owner": {"reputation": 23, "user_id": 7859892, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/08961d27608192e378add6638793fd71?s=128&d=identicon&r=PG&f=1", "display_name": "prasath", "link": "https://stackoverflow.com/users/7859892/prasath"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1504671269, "post_id": 46066273, "comment_id": 79093912, "body": "at the end of line we can add any number (1 or 2 or etc). but the number should be same for every line"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 7859892, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/08961d27608192e378add6638793fd71?s=128&d=identicon&r=PG&f=1", "display_name": "prasath", "link": "https://stackoverflow.com/users/7859892/prasath"}, "edited": false, "score": 0, "creation_date": 1504675403, "post_id": 46067068, "comment_id": 79095059, "body": "Thanks a lot its working... but i cant able to understand completely. can you please explain."}, {"owner": {"reputation": 4703, "user_id": 5375464, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3292ca87ff6c766b75dbe4b2ea0831da?s=128&d=identicon&r=PG&f=1", "display_name": "J...S", "link": "https://stackoverflow.com/users/5375464/j-s"}, "reply_to_user": {"reputation": 23, "user_id": 7859892, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/08961d27608192e378add6638793fd71?s=128&d=identicon&r=PG&f=1", "display_name": "prasath", "link": "https://stackoverflow.com/users/7859892/prasath"}, "edited": false, "score": 0, "creation_date": 1504675668, "post_id": 46067068, "comment_id": 79095138, "body": "@prasath Can you be specific? Which part?"}, {"owner": {"reputation": 23, "user_id": 7859892, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/08961d27608192e378add6638793fd71?s=128&d=identicon&r=PG&f=1", "display_name": "prasath", "link": "https://stackoverflow.com/users/7859892/prasath"}, "edited": false, "score": 0, "creation_date": 1504676563, "post_id": 46067068, "comment_id": 79095476, "body": "I Dont understand, deleted second column.                                        fscanf(file1, &quot;%d&quot;, &amp;word);             fgets(line, sizeof(line), file1);             line[strlen(line)-1]=&#39;\\0&#39;;            fprintf(out1, &quot;%s 1\\n&quot;, line);"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1504676984, "post_id": 46067068, "comment_id": 79095650, "body": "He is just reading it and doing nothing with it to &quot;consume&quot; the second column (move the <i>file position indicator</i> beyond the second column so the 2nd <code>fgets</code> starts reading with the 3rd column."}], "tags": [], "owner": {"reputation": 4703, "user_id": 5375464, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3292ca87ff6c766b75dbe4b2ea0831da?s=128&d=identicon&r=PG&f=1", "display_name": "J...S", "link": "https://stackoverflow.com/users/5375464/j-s"}, "is_accepted": false, "score": 1, "last_activity_date": 1504676329, "last_edit_date": 1504676329, "creation_date": 1504673902, "answer_id": 46067068, "question_id": 46066273, "link": "https://stackoverflow.com/questions/46066273/delete-second-column-for-selected-rows-from-the-input-file-in-c-program/46067068#46067068", "title": "Delete second column for selected rows from the input file in C program", "body": "<p>You've given the values of <code>START</code> &amp; <code>STOP</code> as <code>To_Find_node</code> &amp; <code>To_Element_set_list</code> respectively to the function <code>Extract_SOLID_value()</code> so use the new names inside that function otherwise you would be getting error as <code>START</code> &amp; <code>STOP</code> are not in the scope of that function.</p>\n\n<p>You checked if the input file was created inside <code>OpenInputFile()</code> so why check again before the loop in <code>Extract_SOLID_value()</code> when nothing has changed?</p>\n\n<p>You need to keep scanning the input file and write data to output file when the first value in a line is within the desired range.\nA single <code>fgets()</code> won't do you got to depend on the loop like</p>\n\n<pre><code>int Extract_SOLID_value( int To_Find_node, int To_Element_set_list)\n{\n    char line[256];\n    int word;\n    int fword;\n\n    while (fscanf(file1,\"%d\",&amp;fword)==1){\n        if (fword &gt;= To_Find_node &amp;&amp; fword &lt;=To_Element_set_list ){\n            fprintf(out1, \"%d \", fword);\n            fprintf(stdout, \"%d \", fword);\n            fscanf(file1, \"%d\", &amp;word);\n            fgets(line, sizeof(line), file1);\n            line[strlen(line)-1]='\\0';\n            fprintf(out1, \"%s 1\\n\", line);\n            fprintf(stdout, \"%s 1\\n\", line);\n        }\n        else\n        {\n            fgets(line, sizeof(line), file1);\n        }\n    }\n    return 0;\n}\n</code></pre>\n\n<p><a href=\"https://www.tutorialspoint.com/c_standard_library/c_function_fscanf.htm\" rel=\"nofollow noreferrer\"><code>fscanf()</code></a> will return the number values that were successfully assigned to variables.\nAs long as a value has been assigned to <code>fword</code> in the beginning of each iteration, the loop will go on.\nHence the condition inside the <code>while</code> loop.</p>\n\n<p>We first read the first number in each line and if it is within the desired range, that number is written to output file along with the rest of the line which is obtained with <code>fgets()</code>. \nIf the number is not within the desired range, we just used <code>fgets()</code> to skip that line but you can also use something like <code>fseek()</code> for the same.</p>\n\n<p><code>fgets()</code> will store the trailing new-line (<code>\\n</code>) as part of the string that was read into.\nSo we removed it by overwriting the <code>\\n</code> with the <code>\\0</code> to mark end of string.</p>\n\n<p>You may skip the lines with <code>fprintf(stdout....)</code>. It's equivalent to a <code>printf()</code>, I just did it to print what would be written to the file to the monitor as well.</p>\n\n<p>And remember that the format specifier for an integer is <code>%d</code> and <i>not</i> <code>%s</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 7859892, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/08961d27608192e378add6638793fd71?s=128&d=identicon&r=PG&f=1", "display_name": "prasath", "link": "https://stackoverflow.com/users/7859892/prasath"}, "edited": false, "score": 0, "creation_date": 1504677881, "post_id": 46067539, "comment_id": 79096061, "body": "Thanks for your answers, i will ask if i have any question in this code."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 23, "user_id": 7859892, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/08961d27608192e378add6638793fd71?s=128&d=identicon&r=PG&f=1", "display_name": "prasath", "link": "https://stackoverflow.com/users/7859892/prasath"}, "edited": false, "score": 0, "creation_date": 1504678112, "post_id": 46067539, "comment_id": 79096187, "body": "Sure, like I said, there are <i>many</i> ways to do this. As long as you validate to catch any errors, how you do it, is largely left up to you <code>:)</code>"}, {"owner": {"reputation": 23, "user_id": 7859892, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/08961d27608192e378add6638793fd71?s=128&d=identicon&r=PG&f=1", "display_name": "prasath", "link": "https://stackoverflow.com/users/7859892/prasath"}, "edited": false, "score": 0, "creation_date": 1504678704, "post_id": 46067539, "comment_id": 79096462, "body": "this operation is one of three various types of operation to perform in input file. how can i use this code in FUNCTION."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 23, "user_id": 7859892, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/08961d27608192e378add6638793fd71?s=128&d=identicon&r=PG&f=1", "display_name": "prasath", "link": "https://stackoverflow.com/users/7859892/prasath"}, "edited": false, "score": 0, "creation_date": 1504679148, "post_id": 46067539, "comment_id": 79096676, "body": "<code>main()</code> itself is nothing but a function. If you wanted to rewrite <code>main()</code> as a separate function, you would open the file before calling the function, and then just pass a <code>FILE*</code> parameter to it. Say I wanted to call the function <code>parsecolumns (FILE *fp)</code>, all you would need to do is the delete the line <code>FILE *fp = argc &gt; 1 ? fopen (argv[1], &quot;r&quot;) : stdin;</code>. Simple. And change <code>return 1;</code> to <code>exit (EXIT_FAILURE);</code>"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 23, "user_id": 7859892, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/08961d27608192e378add6638793fd71?s=128&d=identicon&r=PG&f=1", "display_name": "prasath", "link": "https://stackoverflow.com/users/7859892/prasath"}, "edited": false, "score": 0, "creation_date": 1504680644, "post_id": 46067539, "comment_id": 79097556, "body": "@prasath - I added an implementation as a function as an example."}, {"owner": {"reputation": 23, "user_id": 7859892, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/08961d27608192e378add6638793fd71?s=128&d=identicon&r=PG&f=1", "display_name": "prasath", "link": "https://stackoverflow.com/users/7859892/prasath"}, "edited": false, "score": 0, "creation_date": 1504755948, "post_id": 46067539, "comment_id": 79136815, "body": "@ David C. Rankin. how to delete data in the file after reading and print it in another file"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 23, "user_id": 7859892, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/08961d27608192e378add6638793fd71?s=128&d=identicon&r=PG&f=1", "display_name": "prasath", "link": "https://stackoverflow.com/users/7859892/prasath"}, "edited": false, "score": 0, "creation_date": 1504764463, "post_id": 46067539, "comment_id": 79139490, "body": "You want to delete to whole input file? <code>unlink (filename);</code> (in <code>unistd.h</code>) or just truncate the file in place? (after you <code>fclose</code> the original stream) <code>fp = fopen (filename, &quot;w&quot;); fclose (fp);</code>"}], "tags": [], "owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "is_accepted": true, "score": 0, "last_activity_date": 1504680616, "last_edit_date": 1504680616, "creation_date": 1504676292, "answer_id": 46067539, "question_id": 46066273, "link": "https://stackoverflow.com/questions/46066273/delete-second-column-for-selected-rows-from-the-input-file-in-c-program/46067539#46067539", "title": "Delete second column for selected rows from the input file in C program", "body": "<p>There are a large number of ways to approach this exercise. The primary goals, beyond basic file handling, are to recognize that you need to handle the column values both as <em>integers</em> and as <em>strings</em>. (the 1st column is the only one you need an <em>integer</em> value for).</p>\n\n<p>Recognizing that your comparison will require an <em>integer</em> value, you can read the entire line, and either use <code>sscanf</code> to convert the first column to <code>int</code>, or begin <em>tokenizing</em> each column into strings immediately and convert the first to <code>int</code> using <code>strtol</code>. (either way is fine).</p>\n\n<p>The larger issue is <em>tokenizing</em> the line. (the typical choice is <code>strtok</code> -- aptly named). You can also simply use a pair of pointers and \"inch-worm\" from the start to the end of the line, picking out columns as you go. However, for simply space or tab separated columns, <code>strtok</code> makes it easy. It is a convenient way to separate an unknown number of columns in a line, where formatted input functions would fail.</p>\n\n<p>(note: there is also a <code>strsep</code> function you can use if you need to preserve columns with NULL values -- such as in a .csv file where you may have <code>col1,col2,,col4</code>)</p>\n\n<p>An Implementation using <code>strtok</code> and <code>strtol</code> to perform the conversion to <code>int</code> may look something like the following:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;errno.h&gt;\n\n/* constants for max chars, start &amp; stop values */\nenum { BASE = 10, MAXC = 512, START = 770, STOP = 791 };\n\nint main (int argc, char **argv) {\n\n    char buf[MAXC] = \"\";        /* line buffer */\n    /* open file (or read from stdin -- default) */\n    FILE *fp = argc &gt; 1 ? fopen (argv[1], \"r\") : stdin;\n\n    if (!fp) {  /* validate file open for reading */\n        fprintf (stderr, \"error: file open failed '%s'.\\n\", argv[1]);\n        return 1;\n    }\n\n    while (fgets (buf, MAXC, fp)) {     /* read each line */\n        int val;                        /* 1st col value */\n        size_t len = strlen (buf);      /* get buf len for validation */\n        char *p, *delim = \" \\t\\n\";      /* pointer &amp; delimiters */\n\n        if (len &amp;&amp; buf[len - 1] != '\\n') { /* validate complete line */\n            fprintf (stderr, \"error: line exceeds %d chars.\\n\", MAXC);\n            return 1;\n        }\n\n        p = strtok (buf, delim);        /* parse 1st column (as string) */\n        if (p == NULL) {                /* handle 1st col error */\n            fprintf (stderr, \"error: parse of first column failed.\\n\");\n            return 1;\n        }\n\n        errno = 0;\n        val = (int)strtol (p, NULL, BASE);  /* convert to long/int */\n        if (errno) {\n            fprintf (stderr, \"error: strtol() conversion failed.\\n\");\n            return 1;\n        }\n\n        /* for each line between START &amp; STOP (inclusive) */\n        if (START &lt;= val &amp;&amp; val &lt;= STOP) {\n\n            printf (\"%d\", val);             /* output 1st col */\n\n            /* tokenize line, remove 2nd column, append 1 at end */\n            p = strtok (NULL, delim);       /* parse/discard 2nd column */\n            if (!p) { /* handle failure to parse 2nd column */ }\n\n            p = strtok (NULL, delim);       /* parse 3rd column */\n            if (!p) { /* handle failure to parse 3rd column */ }\n\n            while (p) {                     /* while token read */\n                printf (\" %-8s\", p);        /* print token */\n                p = strtok (NULL, delim);   /* parse next token/column */\n            }\n            printf (\"1\\n\");                 /* print final 1 at end */\n        }\n    }\n\n    if (fp != stdin) fclose (fp);       /* close file if not stdin */\n\n    return 0;\n}\n</code></pre>\n\n<p><strong>Example Use/Output</strong></p>\n\n<pre><code>$ ./bin/parsecol &lt;dat/columns.txt\n770 1372     1373    1\n771 1373     1374    1\n772 1375     1376    1\n773 1376     1377    1\n774 1377     1378    1\n775 1378     1379    1\n776 1379     1380    1\n777 1380     1381    1\n778 1381     1382    1\n779 1382     1383    1\n780 1383     1384    1\n781 1384     1385    1\n782 1386     1387    1\n783 1387     1388    1\n784 1388     1389    1\n785 1389     1390    1\n786 1390     1391    1\n787 1391     1392    1\n788 1392     1393    1\n789 1393     1394    1\n790 1394     1395    1\n791 1395     1396    1\n</code></pre>\n\n<p>A second, similar implementation using <code>sscanf</code> to convert the first column to integer (and simply re-reading the first column as a string) could look like the following:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\n/* constants for max chars, start &amp; stop values */\nenum { MAXC = 512, START = 770, STOP = 791 };\n\nint main (int argc, char **argv) {\n\n    char buf[MAXC] = \"\";        /* line buffer */\n    /* open file (or read from stdin -- default) */\n    FILE *fp = argc &gt; 1 ? fopen (argv[1], \"r\") : stdin;\n\n    if (!fp) {  /* validate file open for reading */\n        fprintf (stderr, \"error: file open failed '%s'.\\n\", argv[1]);\n        return 1;\n    }\n\n    while (fgets (buf, MAXC, fp)) {     /* read each line */\n        int val;                        /* 1st col value */\n        size_t len = strlen (buf);      /* get buf len for validation */\n        char *p, *delim = \" \\t\\n\";      /* pointer &amp; delimiters */\n\n        if (len &amp;&amp; buf[len - 1] != '\\n') { /* validate complete line */\n            fprintf (stderr, \"error: line exceeds %d chars.\\n\", MAXC);\n            return 1;\n        }\n\n        if (sscanf (buf, \"%d\", &amp;val) != 1) { /* convert 1st col to int */\n            fprintf (stderr, \"error: conversion failure column 1.\\n\");\n            return 1;\n        }\n\n        /* for each line between START &amp; STOP (inclusive) */\n        if (START &lt;= val &amp;&amp; val &lt;= STOP) {\n\n            /* tokenize line, remove 2nd column, append 1 at end */\n            p = strtok (buf, delim);        /* parse 1st column */\n            if (p == NULL) {                /* handle 1st col error */\n                fprintf (stderr, \"error: parse of first column failed.\\n\");\n                return 1;\n            }\n            printf (\"%s\", p);               /* print column 1 */\n\n            p = strtok (NULL, delim);       /* parse/discard 2nd column */\n            if (!p) { /* handle failure to parse 2nd column */ }\n\n            p = strtok (NULL, delim);       /* parse 3rd column */\n            if (!p) { /* handle failure to parse 3rd column */ }\n\n            while (p) {                     /* while token read */\n                printf (\" %-8s\", p);        /* print token */\n                p = strtok (NULL, delim);   /* parse next token/column */\n            }\n            printf (\"1\\n\");                 /* print final 1 at end */\n        }\n    }\n\n    if (fp != stdin) fclose (fp);       /* close file if not stdin */\n\n    return 0;\n}\n</code></pre>\n\n<p>(<strong>note:</strong> the output is the same)</p>\n\n<p>Arguably, the first is a bit more elegant, where in the second, you let <code>sscanf</code> handle the conversion and internal-validation.</p>\n\n<p>Look over all the answers and let me know if you have further questions.</p>\n\n<hr>\n\n<p><strong>Implementation as a Function</strong></p>\n\n<p>In response to your last comment, as <code>main()</code> itself is just a function, converting the code to a standalone function is relatively straight-forward. Traditionally, you would open/validate your file in the calling function (the one that calls the <code>parsecolumns</code> function -- <code>main()</code> in this case), and then simply pass an open <code>FILE*</code> file stream as a parameter to your function.</p>\n\n<p>A quick implementation is shown below (with reasonable validation on the user input <code>filename</code>). Always, always validate all user input, and always check for <code>EOF</code> in case the user cancels input by generating a manual <code>EOF</code> with <kbd>CTRL+D</kbd> or <kbd>CTRL+Z</kbd> (on windoze).</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;errno.h&gt;\n\n/* constants for max chars, start &amp; stop values */\nenum { BASE = 10, MAXC = 512, START = 770, STOP = 791 };\n\nint parsecolumns (FILE *fp);\n\nint main (void) {\n\n    char filename[MAXC] = \"\";\n    FILE *fp = NULL;\n\n    for (;;) {      /* loop until good filename provided (or canceled) */\n        int rtn;    /* always capture and validate scanf return */\n        printf (\"enter filename: \");\n        if ((rtn = scanf (\"%s\", filename)) != 1) {\n            if (rtn == EOF) {\n                fprintf (stderr, \"  user canceled input.\\n\");\n                return 1;\n            }\n        }\n        else {\n            fp = fopen (filename, \"r\");\n            if (!fp)    /* validate file open for reading */\n                fprintf (stderr, \"error: file open failed. '%s'.\\n\", filename);\n            else\n                break;\n        }\n    }\n\n    if (parsecolumns (fp)) {    /* parse columns in file */\n        fprintf (stderr, \"error: failure in parsecolumns()\\n\");\n    }\n\n    if (fp != stdin) fclose (fp);       /* close file if not stdin */\n\n    return 0;\n}\n\nint parsecolumns (FILE *fp)\n{\n    char buf[MAXC] = \"\";        /* line buffer */\n\n    if (!fp) {  /* validate file open for reading */\n        fprintf (stderr, \"error: invalid file parameter 'fp'.\\n\");\n        return 1;\n    }\n\n    while (fgets (buf, MAXC, fp)) {     /* read each line */\n        int val;                        /* 1st col value */\n        size_t len = strlen (buf);      /* get buf len for validation */\n        char *p, *delim = \" \\t\\n\";      /* pointer &amp; delimiters */\n\n        if (len &amp;&amp; buf[len - 1] != '\\n') { /* validate complete line */\n            fprintf (stderr, \"error: line exceeds %d chars.\\n\", MAXC);\n            return 1;\n        }\n\n        p = strtok (buf, delim);        /* parse 1st column (as string) */\n        if (p == NULL) {                /* handle 1st col error */\n            fprintf (stderr, \"error: parse of first column failed.\\n\");\n            return 1;\n        }\n\n        errno = 0;\n        val = (int)strtol (p, NULL, BASE);  /* convert to long/int */\n        if (errno) {\n            fprintf (stderr, \"error: strtol() conversion failed.\\n\");\n            return 1;\n        }\n\n        /* for each line between START &amp; STOP (inclusive) */\n        if (START &lt;= val &amp;&amp; val &lt;= STOP) {\n\n            printf (\"%d\", val);             /* output 1st col */\n\n            /* tokenize line, remove 2nd column, append 1 at end */\n            p = strtok (NULL, delim);       /* parse/discard 2nd column */\n            if (!p) { /* handle failure to parse 2nd column */ }\n\n            p = strtok (NULL, delim);       /* parse 3rd column */\n            if (!p) { /* handle failure to parse 3rd column */ }\n\n            while (p) {                     /* while token read */\n                printf (\" %-8s\", p);        /* print token */\n                p = strtok (NULL, delim);   /* parse next token/column */\n            }\n            printf (\"1\\n\");                 /* print final 1 at end */\n        }\n    }\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 7859892, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/08961d27608192e378add6638793fd71?s=128&d=identicon&r=PG&f=1", "display_name": "prasath", "link": "https://stackoverflow.com/users/7859892/prasath"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 46067539, "answer_count": 2, "score": 1, "last_activity_date": 1504680616, "creation_date": 1504668184, "last_edit_date": 1504671115, "question_id": 46066273, "link": "https://stackoverflow.com/questions/46066273/delete-second-column-for-selected-rows-from-the-input-file-in-c-program", "title": "Delete second column for selected rows from the input file in C program", "body": "<p>Main objective of this program:  </p>\n\n<ol>\n<li><p>Print the lines where the number in the first column lies between the start and stop values, which depend on user input. But the start and stop number should compare every first word of each line.</p>\n\n<p>For example,  </p>\n\n<pre><code>start = 770  \nstop  = 791   \n</code></pre>\n\n<p>It should just compare first integer of each line.</p></li>\n<li><p>Delete second column of each line and add (1 or any number) at the end of each line, like example output format.</p></li>\n</ol>\n\n<p>Please give me some instructions to perform this operation.  </p>\n\n<p>I tried to write C code, but I wasn't able to do so.  I am attaching that for your kind perusal.</p>\n\n<h3>input file format</h3>\n\n<pre><code>766 102 1368 1369   \n767 102 1369 1370   \n768 102 1370 1371   \n769 102 1371 1372   \n770 102 1372 1373   \n771 102 1373 1374  \n772 102 1375 1376   \n773 102 1376 1377   \n774 102 1377 1378     \n775 102 1378 1379   \n776 102 1379 1380  \n777 102 1380 1381   \n778 102 1381 1382   \n779 102 1382 1383  \n780 102 1383 1384  \n781 102 1384 1385  \n782 102 1386 1387  \n783 102 1387 1388  \n784 102 1388 1389  \n785 102 1389 1390  \n786 102 1390 1391  \n787 102 1391 1392  \n788 102 1392 1393  \n789 102 1393 1394  \n790 102 1394 1395  \n791 102 1395 1396  \n717 204 339 1333 1341 1337  \n718 204 1337 1341 1342 1338  \n719 204 1338 1342 1335 355  \n720 204 1333 1334 1343 1341  \n721 204 1341 1343 1344 1342  \n722 204 1342 1344 1336 1335  \n</code></pre>\n\n<h3>output format</h3>\n\n<pre><code>770 1372    1373    1  \n771 1373    1374    1  \n772 1375    1376    1  \n773 1376    1377    1  \n774 1377    1378    1  \n775 1378    1379    1  \n776 1379    1380    1  \n777 1380    1381    1  \n778 1381    1382    1   \n779 1382    1383    1   \n780 1383    1384    1  \n781 1384    1385    1    \n782 1386    1387    1   \n783 1387    1388    1  \n784 1388    1389    1  \n785 1389    1390    1  \n786 1390    1391    1  \n787 1391    1392    1  \n788 1392    1393    1   \n789 1393    1394    1  \n790 1394    1395    1   \n791 1395    1396    1  \n</code></pre>\n\n<h3>code</h3>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nFILE *file1;\nFILE *out1;\n\n///Function declaration\nvoid OpenInputFile();\nint Extract_SOLID_value( int To_Find_node, int To_Element_set_list);\n\nint main()\n{\n    int result;\n    OpenInputFile();\n    int ELEMENT_SOLID;\n    int STOP;\n    START = 10;\n    STOP = 100;\n\n    ///Open txt file to write\n    out1 = fopen(\"output.txt\", \"w\");\n    if (out1 == NULL)\n    {\n        perror(\"fopen\");\n        exit(EXIT_FAILURE);\n    }\n\n    result = Extract_SOLID_value(START, STOP);\n    printf(\"%s\", result);\n    fclose(file1);\n    fclose(out1);\n    return 0;\n}/// end main\n\nint Extract_SOLID_value( int To_Find_node, int To_Element_set_list)\n{\n    char line[256];\n    int word;\n    if (!file1) {\n        perror(\"fopen\");\n        exit(EXIT_FAILURE);\n    }\n\n    while (fscanf(file1,\"%s%*[^\\n]\",word)){\n        if (word == START ){\n            fgets(line, sizeof (line),file1);\n            if (word == STOP){\n                return;\n            }\n            printf(\"%s \\n\", line);\n            fprintf(out1, \"%s \\n\", line);\n        }\n    }\n    return 0;\n}\n\nvoid OpenInputFile(){\n\n    file1 = fopen(\"simple_CSDexample.dat\", \"r\");\n\n    // check if file exists\n    if (!file1){\n        perror(\"fopen\");\n        exit(EXIT_FAILURE);\n    }\n    return;\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "pointers", "classification"], "comments": [{"owner": {"reputation": 85822, "user_id": 597607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jCzJi.png?s=128&g=1", "display_name": "Bo Persson", "link": "https://stackoverflow.com/users/597607/bo-persson"}, "edited": false, "score": 1, "creation_date": 1504686882, "post_id": 46066103, "comment_id": 79101347, "body": "When you create the classification map you use <code>[i]</code> on some arrays that have less than 10 elements."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1504807460, "post_id": 46066103, "comment_id": 79167893, "body": "the posted code, in several places, is accessing beyond the upper bound of some arrays,  This is undefined behavior and can lead to a seg fault event."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1504807787, "post_id": 46066103, "comment_id": 79168052, "body": "regarding this kind of expression <code>ceil(rawData[rowIndex][columnIndex] * 1000.0) &#47; 1000.0</code>   This does NOT round the number.   Rather it gets the next whole number, then multiplies that whole number by 1   (1000. /1000. = 1)"}], "owner": {"reputation": 53, "user_id": 8329146, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9b1c3b26976b7a285d86303bae1edf46?s=128&d=identicon&r=PG&f=1", "display_name": "NeemzCr7", "link": "https://stackoverflow.com/users/8329146/neemzcr7"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 68, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1504668228, "creation_date": 1504666796, "question_id": 46066103, "link": "https://stackoverflow.com/questions/46066103/arrays-and-pointers-how", "title": "arrays and pointers HOW?", "body": "<p>So i have been writing a code which it reads a [20][20] data to the computer and then it rounds the data UP to 3 decimal places. later on, it takes average of the data based on the ranges from 0 to 2.5. everything works fine until when i want to write a code which can create a classification map where it can display values from 1 to 10 and it shows if a value in the data is within the ranges and if it is greater than or smaller than the average it shows the desired number. i think by an example it makes more sense to anyone here.\nfor example in my [20][20] data, the first number is 0.211, it is between 0.0 and 0.5; then the average for the values between 0.0 and 0.5 is 0.241, then in my classification map i want to show the number 1 for this value showing that the number was in between the range 0 and 0.5 and it was also smaller that the average for the range which was calculated to be 0.241. For the next number if everything is the same except that the number is greater than the average 0.241, then it shows the number 2 in the classification map. if my next number is to be 0.611 then it is between ranges 0.5 to 1.0 and if it is smaller than the average calculated for this range which is calculated to be 0.727 then is shows 3 in the classification map. </p>\n\n<p>my code is:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;math.h&gt;\n\n// Declare constants\n// Data size\n#define MAX_ROWS 20\n#define MAX_COLUMNS 20\n#define LOW_ERROR 0.0\n#define HIGH_ERROR 2.5\n#define MAX_RANGE 6\n#define MAX_DISPLAY_VALUE 10\n\n// Main entry point for the program\nint main(void) \n{\n// Decalred variables\nint rowIndex = 0;\nint columnIndex = 0;\n\n//Stores the  data and maps\ndouble rawData[MAX_ROWS][MAX_COLUMNS]; // 2-dimensional array to store our raw data\ndouble roundedValue[MAX_ROWS][MAX_COLUMNS]; // 2-dimensional array to store our rounded data\nint classificationMap[MAX_ROWS][MAX_COLUMNS]; // 2-dimensional array to store our classification map\nint displayValue[MAX_DISPLAY_VALUE] = { 1,2,3,4,5,6,7,8,9,10 };\n\n//Stores the range data\nfloat rangeValue[MAX_RANGE] = { 0.0,0.5,1.0,1.5,2.0,2.5 }; // Set up the range bounds\nint i, num = 0;\nfloat total[MAX_RANGE] = { 0 }, average[MAX_RANGE] = { 0 };\n\n// Print out the rawdata array\nprintf(\" --- RAW DATA ---\\n\");\nfor (rowIndex = 0; rowIndex &lt; MAX_ROWS; rowIndex++) \n{\n    // Read up until the last value\n    for (columnIndex = 0; columnIndex &lt; MAX_COLUMNS; columnIndex++) \n    {\n        printf(\"%.9lf \", rawData[rowIndex][columnIndex]);\n    }\n    printf(\"\\n\");\n}\n\n// Print out the roundup data array\nprintf(\" --- ROUNDED DATA ---\\n\");\nfor (rowIndex = 0; rowIndex &lt; MAX_ROWS; rowIndex++)\n{\n    // Read up until the last value\n    for (columnIndex = 0; columnIndex &lt; MAX_COLUMNS; columnIndex++)\n    {\n        if (rawData[rowIndex][columnIndex] &lt; LOW_ERROR)\n        {\n            roundedValue[rowIndex][columnIndex] = LOW_ERROR;\n            printf(\"%.3f \", LOW_ERROR);\n        }\n        else if (rawData[rowIndex][columnIndex] &gt; HIGH_ERROR)\n        {\n            roundedValue[rowIndex][columnIndex] = HIGH_ERROR;\n            printf(\"%.3f \", HIGH_ERROR);\n        }\n        else\n        {\n            roundedValue[rowIndex][columnIndex] = ceil(rawData[rowIndex][columnIndex] * 1000.0) / 1000.0;\n            printf(\"%.3f \", ceil(rawData[rowIndex][columnIndex] * 1000.0) / 1000.0);\n        }\n    }\n    printf(\"\\n\");\n}\n//Calculate and store the averages for each range\nprintf(\" --- RANGE TABLE ---\\n\");\nfor (i = 0; i &lt; 5; i++)\n{\n    for (rowIndex = 0; rowIndex &lt; MAX_ROWS; rowIndex++)\n    {\n        for (columnIndex = 0; columnIndex &lt; MAX_COLUMNS; columnIndex++)\n            if (roundedValue[rowIndex][columnIndex] &gt; rangeValue[i] &amp;&amp; roundedValue[rowIndex][columnIndex] &lt;= rangeValue[i + 1])\n            {\n                total[i] = total[i] + roundedValue[rowIndex][columnIndex];\n                num++;\n            }\n\n    }\n\n    average[i] = total[i] / num;\n    printf(\"%.3f \\n\", average[i]);\n    total[i] = 0;\n    average[i] = 0;\n    num = 0;\n}\n\n//Create the classification map\nfor (i = 0; i &lt; 10; i++)\n    for (rowIndex = 0; rowIndex &lt; MAX_ROWS; rowIndex++)\n    {\n        for (columnIndex = 0; columnIndex &lt; MAX_COLUMNS; columnIndex++)\n            if (roundedValue[rowIndex][columnIndex] &gt; rangeValue[i] &amp;&amp; roundedValue[rowIndex][columnIndex] &lt;= rangeValue[i + 1] &amp;&amp; roundedValue[rowIndex][columnIndex] &lt;= average[i])\n            {\n                classificationMap[rowIndex][columnIndex] = displayValue[i];\n            }\n            else if (roundedValue[rowIndex][columnIndex] &gt; rangeValue[i] &amp;&amp; roundedValue[rowIndex][columnIndex] &lt;= rangeValue[i + 1] &amp;&amp; roundedValue[rowIndex][columnIndex] &gt; average[i])\n            {\n            classificationMap[rowIndex][columnIndex] = displayValue[i + 1];\n            }\n\n    }\nprintf(\"--- CLASSIFICATION MAP ---\\n\");\nfor (rowIndex = 0; rowIndex &lt; MAX_ROWS; rowIndex++)\n{\n    //Read up until the last value\n    for (columnIndex = 0; columnIndex &lt; MAX_COLUMNS; columnIndex++)\n    {\n        printf(\"%d \", classificationMap[rowIndex][columnIndex]);\n    }\n    printf(\"\\n\");\n}\n\n\n\n// Exit\nreturn 0;\n}\n</code></pre>\n\n<p>My problem is that i have two arrays one is for displayVlaues and the other one is for rangeVlaues. when i print my code for the classification map i get my numbers up to only 5.\nAny idea why? i am a C beginner and this might be a silly question so i am sorry!  </p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 2, "creation_date": 1504666264, "post_id": 46066016, "comment_id": 79092764, "body": "<a href=\"http://coliru.stacked-crooked.com/a/0bc795872e7fc761\" rel=\"nofollow noreferrer\">Segfaults for me</a>, but still, this is <i>undefined behavior</i>, it doesn&#39;t <i>have to</i> segfault."}, {"owner": {"reputation": 31371, "user_id": 281108, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/b160d50a7ecfe6018348629cb8677538?s=128&d=identicon&r=PG", "display_name": "Ismail Badawi", "link": "https://stackoverflow.com/users/281108/ismail-badawi"}, "edited": false, "score": 3, "creation_date": 1504666327, "post_id": 46066016, "comment_id": 79092777, "body": "Segmentation fault is a runtime behavior. You won&#39;t see it when compiling."}, {"owner": {"reputation": 441, "user_id": 5260053, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh4.googleusercontent.com/-PB4V5H2o0t8/AAAAAAAAAAI/AAAAAAAAACA/d_G7amrFCfo/photo.jpg?sz=128", "display_name": "march_seven", "link": "https://stackoverflow.com/users/5260053/march-seven"}, "edited": false, "score": 0, "creation_date": 1504666674, "post_id": 46066016, "comment_id": 79092847, "body": "segmentation fault  is happen when running the program. but compile is OK"}], "answers": [{"comments": [{"owner": {"reputation": 441, "user_id": 5260053, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh4.googleusercontent.com/-PB4V5H2o0t8/AAAAAAAAAAI/AAAAAAAAACA/d_G7amrFCfo/photo.jpg?sz=128", "display_name": "march_seven", "link": "https://stackoverflow.com/users/5260053/march-seven"}, "edited": false, "score": 0, "creation_date": 1504676417, "post_id": 46066039, "comment_id": 79095432, "body": "it make me confuse that  int *p = 0  is going set the pointer address as 0 not set value\uff0c and then *p=17 is going to set pointer value as 17 not set address ~~~~ although they are same format   \u201c *pointer = value \u201d \uff1b"}], "tags": [], "owner": {"reputation": 3794, "user_id": 7256714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adeb98b0e8995d8576ad5f66c0f982e5?s=128&d=identicon&r=PG&f=1", "display_name": "Pras", "link": "https://stackoverflow.com/users/7256714/pras"}, "is_accepted": false, "score": 0, "last_activity_date": 1504666364, "creation_date": 1504666364, "answer_id": 46066039, "question_id": 46066016, "link": "https://stackoverflow.com/questions/46066016/is-that-really-caused-segmentation-fault-expert-c-programming-7-7/46066039#46066039", "title": "is that really caused segmentation fault \uff08Expert C Programming 7.7\uff09", "body": "<pre><code>*p=17;\n</code></pre>\n\n<p>p points to invaid memory and you are are storing a value there.</p>\n\n<p>Its leading to undefined behaviour when you write to invalid memory, you are probably lucky program did not error in segment fault.</p>\n"}, {"tags": [], "owner": {"reputation": 11342, "user_id": 1144157, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d05077a347e63679d43bfbdaf5e7b9ab?s=128&d=identicon&r=PG", "display_name": "Steephen", "link": "https://stackoverflow.com/users/1144157/steephen"}, "is_accepted": false, "score": 0, "last_activity_date": 1504666365, "creation_date": 1504666365, "answer_id": 46066040, "question_id": 46066016, "link": "https://stackoverflow.com/questions/46066016/is-that-really-caused-segmentation-fault-expert-c-programming-7-7/46066040#46066040", "title": "is that really caused segmentation fault \uff08Expert C Programming 7.7\uff09", "body": "<p>I add one more line in your program. It is core dumped. It will core dump, when you try to access the pointer variable, since you didn't allocate the memory for pointer variable p.</p>\n\n<pre><code>    #include &lt;stdio.h&gt;\n    int main()\n    {\n            int *p =0;\n            *p = 17;\n            printf(\"%d\",*p);\n            return 0;\n    }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 491, "user_id": 8509272, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/487ff5fe4697aeb326fa5092ef38f116?s=128&d=identicon&r=PG&f=1", "display_name": "savram", "link": "https://stackoverflow.com/users/8509272/savram"}, "is_accepted": false, "score": 0, "last_activity_date": 1504666829, "creation_date": 1504666829, "answer_id": 46066106, "question_id": 46066016, "link": "https://stackoverflow.com/questions/46066016/is-that-really-caused-segmentation-fault-expert-c-programming-7-7/46066106#46066106", "title": "is that really caused segmentation fault \uff08Expert C Programming 7.7\uff09", "body": "<p>p is supposed to store the address of an integer, however, it's storing 0. Then, you are accessing address 0 and storing 17 there. 0 is likely not even a valid address so the behavior is undefined. Segfault is one of the possible outcomes.</p>\n"}], "owner": {"reputation": 441, "user_id": 5260053, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh4.googleusercontent.com/-PB4V5H2o0t8/AAAAAAAAAAI/AAAAAAAAACA/d_G7amrFCfo/photo.jpg?sz=128", "display_name": "march_seven", "link": "https://stackoverflow.com/users/5260053/march-seven"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "closed_date": 1504668108, "answer_count": 3, "score": 0, "last_activity_date": 1504687300, "creation_date": 1504666147, "question_id": 46066016, "link": "https://stackoverflow.com/questions/46066016/is-that-really-caused-segmentation-fault-expert-c-programming-7-7", "closed_reason": "Duplicate", "title": "is that really caused segmentation fault \uff08Expert C Programming 7.7\uff09", "body": "<p>Hi  there is a example in the section 7.7 of Expert C Programming which would caused segmentation fault \u3002</p>\n\n<pre><code>  int *p =0\uff1b\n  *p =17; /*caused segmentation fault */\n</code></pre>\n\n<p>but i have test it as  below:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint main()\n{\n        int *p =0;\n        *p = 17;\n        return 0;\n}\n</code></pre>\n\n<p>when i doing gcc -c test.c it is OK and there is nothing error about segmentation fault ?\nwhy ?</p>\n"}, {"tags": ["c", "segmentation-fault", "readfile"], "comments": [{"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 2, "creation_date": 1504666204, "post_id": 46065993, "comment_id": 79092746, "body": "Show us command line (and arguments) and  the file contents. And Read <a href=\"http://en.cppreference.com/w/c/io/fscanf\" rel=\"nofollow noreferrer\">fscanf</a> and Check return value of <code>fopen</code> and <code>fscanf</code>."}, {"owner": {"reputation": 3, "user_id": 7729282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a971d1b0e943abba1bc27e78c701ab7b?s=128&d=identicon&r=PG&f=1", "display_name": "user7729282", "link": "https://stackoverflow.com/users/7729282/user7729282"}, "reply_to_user": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1504666326, "post_id": 46065993, "comment_id": 79092776, "body": "The text file is not shown to me. It could be any, all I know is that it is full of whole numbers"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 1, "creation_date": 1504666436, "post_id": 46065993, "comment_id": 79092799, "body": "The size is first read from the file, but when it is too large to reserve on the stack, it becomes one cause of the seg fault."}, {"owner": {"reputation": 3, "user_id": 7729282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a971d1b0e943abba1bc27e78c701ab7b?s=128&d=identicon&r=PG&f=1", "display_name": "user7729282", "link": "https://stackoverflow.com/users/7729282/user7729282"}, "reply_to_user": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1504666480, "post_id": 46065993, "comment_id": 79092809, "body": "Is there a way to fix that when we do not know the size?"}, {"owner": {"reputation": 491, "user_id": 8509272, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/487ff5fe4697aeb326fa5092ef38f116?s=128&d=identicon&r=PG&f=1", "display_name": "savram", "link": "https://stackoverflow.com/users/8509272/savram"}, "edited": false, "score": 0, "creation_date": 1504666532, "post_id": 46065993, "comment_id": 79092818, "body": "Maybe if there are no spaces between the numbers it tries to read everything as the size and allocate the array? That would definitely seg fault"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1504666566, "post_id": 46065993, "comment_id": 79092825, "body": "If all you need to do is echo all the file&#39;s contents then why do you need an array at all?  Just print each number immediately after you read it."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 1, "creation_date": 1504666643, "post_id": 46065993, "comment_id": 79092840, "body": "@user7729282 If you are assuming a large size for the time being, use <code>malloc</code> instead of VLA."}, {"owner": {"reputation": 3, "user_id": 7729282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a971d1b0e943abba1bc27e78c701ab7b?s=128&d=identicon&r=PG&f=1", "display_name": "user7729282", "link": "https://stackoverflow.com/users/7729282/user7729282"}, "edited": false, "score": 0, "creation_date": 1504666686, "post_id": 46065993, "comment_id": 79092849, "body": "There are white spaces between the numbers"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 2, "creation_date": 1504666713, "post_id": 46065993, "comment_id": 79092854, "body": "Also, <code>fscanf()</code>&#39;s return value is <i>not</i> ordinarily one of the values it scanned -- it is the number of values it successfully scanned.  As such, it is unlikely that assigning that return value to <code>a[i]</code> is what you really want to do."}, {"owner": {"reputation": 3, "user_id": 7729282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a971d1b0e943abba1bc27e78c701ab7b?s=128&d=identicon&r=PG&f=1", "display_name": "user7729282", "link": "https://stackoverflow.com/users/7729282/user7729282"}, "edited": false, "score": 0, "creation_date": 1504667197, "post_id": 46065993, "comment_id": 79092952, "body": "I have never used malloc. Do I incorporate like this:                                        char <i>argv[] = (char</i>)malloc(size);"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1504667500, "post_id": 46065993, "comment_id": 79093016, "body": "E.g <code>int *a = malloc(size * sizeof(*a));</code> instead of <code>int a[size];</code>."}, {"owner": {"reputation": 3, "user_id": 7729282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a971d1b0e943abba1bc27e78c701ab7b?s=128&d=identicon&r=PG&f=1", "display_name": "user7729282", "link": "https://stackoverflow.com/users/7729282/user7729282"}, "edited": false, "score": 0, "creation_date": 1504667770, "post_id": 46065993, "comment_id": 79093060, "body": "I have added that and the segmentation fault still continues"}, {"owner": {"reputation": 3633, "user_id": 675154, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/23da6806cab4830b5d1b15ef2a410541?s=128&d=identicon&r=PG", "display_name": "delta", "link": "https://stackoverflow.com/users/675154/delta"}, "edited": false, "score": 0, "creation_date": 1504668022, "post_id": 46065993, "comment_id": 79093099, "body": "can you add an example of the file you are reading?"}, {"owner": {"reputation": 3, "user_id": 7729282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a971d1b0e943abba1bc27e78c701ab7b?s=128&d=identicon&r=PG&f=1", "display_name": "user7729282", "link": "https://stackoverflow.com/users/7729282/user7729282"}, "edited": false, "score": 0, "creation_date": 1504668415, "post_id": 46065993, "comment_id": 79093186, "body": "An exmaple is: 1332 324 7 9 6382 937 849 -12"}, {"owner": {"reputation": 3, "user_id": 7729282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a971d1b0e943abba1bc27e78c701ab7b?s=128&d=identicon&r=PG&f=1", "display_name": "user7729282", "link": "https://stackoverflow.com/users/7729282/user7729282"}, "edited": false, "score": 0, "creation_date": 1504668436, "post_id": 46065993, "comment_id": 79093192, "body": "But it can be many more ints"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 1, "creation_date": 1504668539, "post_id": 46065993, "comment_id": 79093215, "body": "first, Are you giving command arguments? If no command line argument is given Access to <code>argv[1]</code> is one cause of a seg fault."}, {"owner": {"reputation": 3, "user_id": 7729282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a971d1b0e943abba1bc27e78c701ab7b?s=128&d=identicon&r=PG&f=1", "display_name": "user7729282", "link": "https://stackoverflow.com/users/7729282/user7729282"}, "edited": false, "score": 0, "creation_date": 1504668821, "post_id": 46065993, "comment_id": 79093290, "body": "Yes I am giving command line arguments"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1504668903, "post_id": 46065993, "comment_id": 79093310, "body": "Also <code>1332</code>  is not that big."}, {"owner": {"reputation": 3, "user_id": 7729282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a971d1b0e943abba1bc27e78c701ab7b?s=128&d=identicon&r=PG&f=1", "display_name": "user7729282", "link": "https://stackoverflow.com/users/7729282/user7729282"}, "edited": false, "score": 0, "creation_date": 1504668949, "post_id": 46065993, "comment_id": 79093326, "body": "The test file is just an example."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1504669025, "post_id": 46065993, "comment_id": 79093347, "body": "Please check <code>p</code> before <code>fscanf</code>.  like <code>if(p == NULL){ perror(&quot;fopen&quot;); return -1;}</code>"}, {"owner": {"reputation": 3, "user_id": 7729282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a971d1b0e943abba1bc27e78c701ab7b?s=128&d=identicon&r=PG&f=1", "display_name": "user7729282", "link": "https://stackoverflow.com/users/7729282/user7729282"}, "edited": false, "score": 0, "creation_date": 1504669184, "post_id": 46065993, "comment_id": 79093396, "body": "I will add the verification of the file, but it is certain that there is a file named that for my task."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 1, "creation_date": 1504669371, "post_id": 46065993, "comment_id": 79093438, "body": "So far, We can not ascertain anything you say. Please provide <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}], "answers": [{"comments": [{"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 1, "creation_date": 1504671182, "post_id": 46066639, "comment_id": 79093887, "body": "You should also validate fscsnf return values. For example size might remain uninitialized when you test it with invalid file here."}, {"owner": {"reputation": 31, "user_id": 2144544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f375c8eda573e89a4b5ecab1a659dc48?s=128&d=identicon&r=PG", "display_name": "Aref", "link": "https://stackoverflow.com/users/2144544/aref"}, "reply_to_user": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 0, "creation_date": 1504679738, "post_id": 46066639, "comment_id": 79097025, "body": "@hyde Thanks for your comment."}], "tags": [], "owner": {"reputation": 31, "user_id": 2144544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f375c8eda573e89a4b5ecab1a659dc48?s=128&d=identicon&r=PG", "display_name": "Aref", "link": "https://stackoverflow.com/users/2144544/aref"}, "is_accepted": true, "score": 0, "last_activity_date": 1504679697, "last_edit_date": 1504679697, "creation_date": 1504670875, "answer_id": 46066639, "question_id": 46065993, "link": "https://stackoverflow.com/questions/46065993/segmentation-fault-in-c-when-reading-a-file-full-of-ints/46066639#46066639", "title": "Segmentation Fault in C when reading a file full of ints", "body": "<p>The code looks fine, however you can add some validation to it to make sure your input is correct.</p>\n\n<pre><code>int main (int argc, char *argv[])\n{\n   int size=0;\n   int i=0;\n   int ret=0;\n\n   // make sure arcv[1] exists:\n   if (argc &lt; 2)\n   {\n       printf(\"not enough arguments provided\");\n       return -1;\n   }\n\n   FILE* p = fopen(argv[1], \"r\");\n\n   // make sure file exists\n   if (p == 0) // or p == NULL\n   {\n       printf(\"file does not exists\");\n       return -1;\n   }\n\n   ret = fscanf(p, \"%d\", &amp;size);\n   // make sure the size is a valid number\n   if (ret == EOF || ret &lt;= 0 || size &lt;= 0)\n   {\n       printf(\"invalid file\");\n       return -1;\n   }\n   int a[size];\n\n   for(i=0; i&lt;size; i++)\n   {\n      fscanf(p,\"%d\",a+i);\n   }\n\n   for(i=0;i&lt;size;i++)\n   {\n      printf(\"%d\", a[i]);\n   }\n\n}\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 7729282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a971d1b0e943abba1bc27e78c701ab7b?s=128&d=identicon&r=PG&f=1", "display_name": "user7729282", "link": "https://stackoverflow.com/users/7729282/user7729282"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 177, "favorite_count": 0, "closed_date": 1504674123, "accepted_answer_id": 46066639, "answer_count": 1, "score": -4, "last_activity_date": 1504679697, "creation_date": 1504665924, "question_id": 46065993, "link": "https://stackoverflow.com/questions/46065993/segmentation-fault-in-c-when-reading-a-file-full-of-ints", "closed_reason": "Not suitable for this site", "title": "Segmentation Fault in C when reading a file full of ints", "body": "<p>I am simply trying to open a file and read the ints and print the array. However, a segmentation fault shows up. I am not sure what I am doing wrong. </p>\n\n<pre><code>int main (int argc, char *argv[])\n{\n   int size;\n   int i;\n   FILE* p = fopen(argv[1], \"r\");\n   fscanf(p, \"%d\", &amp;size);\n   int a[size];\n\n   for(i=0; i&lt;size; i++)\n   {\n      a[i] = fscanf(p,\"%d\",&amp;a[i]);\n\n   }\n\n   for(i=0;i&lt;size;i++)\n  {\n      printf(\"%d\", a[i]);\n  }\n\n}\n</code></pre>\n\n<p>Any help will be appreciated. Thanks. </p>\n"}, {"tags": ["c++", "c", "linux", "sockets"], "comments": [{"owner": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 0, "creation_date": 1504662531, "post_id": 46065596, "comment_id": 79091908, "body": "&quot;Does 0 mean no data was sent or the connection was not established?&quot; <a href=\"http://man7.org/linux/man-pages/man2/connect.2.html\" rel=\"nofollow noreferrer\">man7.org/linux/man-pages/man2/connect.2.html</a> &quot;Why does it execute the connect error line of code even though 0 = 0 not less than 0?&quot; Only because your first connect returns 0 doesn&#39;t mean your second connect returns 0 aswell"}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 2, "creation_date": 1504663061, "post_id": 46065596, "comment_id": 79092027, "body": "When you get an error from a system call, <code>puts()</code> of your own message is not sufficient. You must show the actual error, via <code>errno</code> or <code>strerror()</code> or <code>perror()</code>. If you had done that, you would have seen immediately that the socket was already connected."}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1504665088, "post_id": 46065596, "comment_id": 79092510, "body": "Also you are leaking sockets if the connect fails."}], "answers": [{"tags": [], "owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "is_accepted": false, "score": 8, "last_activity_date": 1504662545, "creation_date": 1504662545, "answer_id": 46065628, "question_id": 46065596, "link": "https://stackoverflow.com/questions/46065596/connect-returns-0-linux-socket-programming-c-c/46065628#46065628", "title": "Connect() Returns 0 Linux Socket programming (c/c++)", "body": "<p>The return value of 0 from <code>connect()</code> means that the connection succeeded.</p>\n\n<p>But immediately after you print the return value from <code>connect()</code> -- directly into <code>std::cout</code> using the <code>&lt;&lt;</code> operator -- the shown code calls <code>connect()</code> a second time with the same socket.</p>\n\n<p>That is an error, because the socket is already connected, and that's why your <code>if()</code> statement reports an error. You called <code>connect()</code> twice. That's your bug.</p>\n"}, {"tags": [], "owner": {"reputation": 73, "user_id": 6435014, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4a231697235d1d14ac82f18c45ab2e75?s=128&d=identicon&r=PG&f=1", "display_name": "K. Ms", "link": "https://stackoverflow.com/users/6435014/k-ms"}, "is_accepted": false, "score": 1, "last_activity_date": 1504664734, "creation_date": 1504664734, "answer_id": 46065860, "question_id": 46065596, "link": "https://stackoverflow.com/questions/46065596/connect-returns-0-linux-socket-programming-c-c/46065860#46065860", "title": "Connect() Returns 0 Linux Socket programming (c/c++)", "body": "<p>this :</p>\n\n<pre><code> //Connect to remote server\nstd::cout &lt;&lt; (connect(socket_desc , (struct sockaddr *)&amp;server , sizeof(server)));\nif (connect(socket_desc , (struct sockaddr *)&amp;server , sizeof(server)) &lt; 0)    \n{\n    puts(\"connect error\");\n    return 1;\n}\n</code></pre>\n\n<p>to :</p>\n\n<pre><code>//Connect to remote server\nresult = connect(socket_desc , (struct sockaddr *)&amp;server , sizeof(server));\nstd::cout &lt;&lt; \"connect result : \" &lt;&lt; result &lt;&lt; std::endl;\nif (result &lt; 0)    \n{\n    puts(\"connect error\");\n    return 1;\n}\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 8022706, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c86981d1dd1104cdef9c2ff1452bbd63?s=128&d=identicon&r=PG&f=1", "display_name": "user344336", "link": "https://stackoverflow.com/users/8022706/user344336"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 614, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1504664734, "creation_date": 1504662302, "question_id": 46065596, "link": "https://stackoverflow.com/questions/46065596/connect-returns-0-linux-socket-programming-c-c", "title": "Connect() Returns 0 Linux Socket programming (c/c++)", "body": "<p>So I am trying to write a simple c++ socket program (Ubuntu) where all it does is connect to google and tells me it did so (Through port 80). I decide to print out the results of the <code>connect()</code> and <code>socket</code> commands. Here is the code:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;sys/socket.h&gt;\n#include&lt;arpa/inet.h&gt; //inet_addr\n#include&lt;iostream&gt; \nint main(int argc , char *argv[])\n{\n    int socket_desc;\n    struct sockaddr_in server;\n\n    //Create socket\n    socket_desc = socket(AF_INET , SOCK_STREAM , 0);\n    std::cout &lt;&lt; socket_desc;\n    if (socket_desc == -1)\n    {\n        printf(\"Could not create socket\");\n    }\n\n    server.sin_addr.s_addr = inet_addr(\"172.217.12.46\");\n    server.sin_family = AF_INET;\n    server.sin_port = htons( 80 );\n\n    //Connect to remote server\n    std::cout &lt;&lt; (connect(socket_desc , (struct sockaddr *)&amp;server , sizeof(server)));\n    if (connect(socket_desc , (struct sockaddr *)&amp;server , sizeof(server)) &lt; 0)    \n    {\n        puts(\"connect error\");\n        return 1;\n    }\n\n    puts(\"Connected\");\n    return 0;\n}\n</code></pre>\n\n<p>Output of code:</p>\n\n<pre><code>30connect error\n</code></pre>\n\n<p>(It was late at night and I was too lazy to do line breaks)</p>\n\n<p>So my question is: Does 0 mean no data was sent or the connection was not established? Why does it execute the connect error line of code even though 0 = 0 not less than 0? </p>\n\n<p>Any Help is appreciated!</p>\n"}, {"tags": ["c", "arrays", "data-structures"], "comments": [{"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 1, "creation_date": 1504657954, "post_id": 46064907, "comment_id": 79090921, "body": "<code>int ary[][3]</code> doesn&#39;t match to <code>int **</code>. E.g <code>int ary[][3]</code> (aka <code>int (*ary)[3]</code>) point to <code>[int[3]][int[3]]...</code>.  <code>int **ary</code> point to <code>[int *][int *]...</code>."}, {"owner": {"reputation": 91778, "user_id": 354577, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/dI6cA.jpg?s=128&g=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/354577/chris"}, "edited": false, "score": 1, "creation_date": 1504666176, "post_id": 46064907, "comment_id": 79092740, "body": "Please don&#39;t add junk text to get past the &quot;mostly code&quot; filter."}, {"owner": {"reputation": 9, "user_id": 8566120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/003ed313cb80ad8e698375fc77ecc734?s=128&d=identicon&r=PG&f=1", "display_name": "0rdinary", "link": "https://stackoverflow.com/users/8566120/0rdinary"}, "edited": false, "score": 0, "creation_date": 1504678407, "post_id": 46064907, "comment_id": 79096328, "body": "I`m sorry if you felt bad. Today, I encounter Stack Overflow at first and the phrase made me embarrassed."}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1504698977, "post_id": 46064907, "comment_id": 79109876, "body": "Welcome to Stack Overflow! Please read and understand <a href=\"/q/605845\">the question on why not to cast the return value of <code>malloc()</code> and family in C</a>."}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 8566120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/003ed313cb80ad8e698375fc77ecc734?s=128&d=identicon&r=PG&f=1", "display_name": "0rdinary", "link": "https://stackoverflow.com/users/8566120/0rdinary"}, "edited": false, "score": 0, "creation_date": 1504678581, "post_id": 46065887, "comment_id": 79096404, "body": "Thx. Your explanation was very helpful in understanding what I curious about!!"}, {"owner": {"reputation": 491, "user_id": 8509272, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/487ff5fe4697aeb326fa5092ef38f116?s=128&d=identicon&r=PG&f=1", "display_name": "savram", "link": "https://stackoverflow.com/users/8509272/savram"}, "reply_to_user": {"reputation": 9, "user_id": 8566120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/003ed313cb80ad8e698375fc77ecc734?s=128&d=identicon&r=PG&f=1", "display_name": "0rdinary", "link": "https://stackoverflow.com/users/8566120/0rdinary"}, "edited": false, "score": 0, "creation_date": 1504709944, "post_id": 46065887, "comment_id": 79118354, "body": "Nope. Don&#39;t forget to like the answers you find useful, it encourages people to help."}], "tags": [], "owner": {"reputation": 491, "user_id": 8509272, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/487ff5fe4697aeb326fa5092ef38f116?s=128&d=identicon&r=PG&f=1", "display_name": "savram", "link": "https://stackoverflow.com/users/8509272/savram"}, "is_accepted": false, "score": 0, "last_activity_date": 1504665469, "last_edit_date": 1504665469, "creation_date": 1504664960, "answer_id": 46065887, "question_id": 46064907, "link": "https://stackoverflow.com/questions/46064907/why-can-we-not-use-dynamic-arrays-as-parameters-of-functions-that-use-static-arr/46065887#46065887", "title": "Why can we not use dynamic arrays as parameters of functions that use static array parameters?", "body": "<pre><code> // why we can`t function like this?\n // printf(\"sumAry2D_f1~3() %d\\n\", sumAry2D_f1(ary, 2, 3));\n</code></pre>\n\n<p>Your function specifically expects a pointer to an integer pointer that points to a sequence of 3 integers, or an array of 3-element integer arrays, not just any pointer to integer pointer. <code>ary</code> is just a pointer to integer pointer. Although you made your <code>int **</code> have the same structure as your <code>int [][3]</code>, it could have been different and the compiler can't tell because the memory allocation occurs at run-time, hence if you uncomment the code it probably won't compile, and even if it does the behavior will be undefined.</p>\n\n<p>Unfortunately, you would need 2 functions to do what you want:</p>\n\n<pre><code>int sumAry2D_f1(int ary[][3], int rows, int cols);\n</code></pre>\n\n<p>and</p>\n\n<pre><code>int sumAry2D_f12(int** ary, int rows, int cols);\n</code></pre>\n\n<p>The code inside each function would be the same.</p>\n"}], "owner": {"reputation": 9, "user_id": 8566120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/003ed313cb80ad8e698375fc77ecc734?s=128&d=identicon&r=PG&f=1", "display_name": "0rdinary", "link": "https://stackoverflow.com/users/8566120/0rdinary"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 72, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1504666176, "creation_date": 1504656184, "last_edit_date": 1504666176, "question_id": 46064907, "link": "https://stackoverflow.com/questions/46064907/why-can-we-not-use-dynamic-arrays-as-parameters-of-functions-that-use-static-arr", "title": "Why can we not use dynamic arrays as parameters of functions that use static array parameters?", "body": "<p>I'm studying the C language and data structures. I wish to get some detailed explanation about why we cannot use dynamic arrays as parameters of functions that use static array parameters.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint sumAry2D_f1(int ary[][3], int rows, int cols);\nvoid freeAry2D(int **ary, int rows);\n\nint main(void)\n{\n    int ary2D[][3] = { {1, 2, 3}, {4, 5, 6} }; // static array\n\n    int r, c;\n    int **ary = (int**)malloc(sizeof(int*) * 2); // dynamic array\n    for (r = 0; r &lt; 2; r++)\n    ary[r] = (int*)malloc(sizeof(int)*3);\n\n    for (r = 0; r &lt; 2; r++)\n        for (c = 0; c &lt; 3; c++)\n            ary[r][c] = r + c; // 0, 1, 2, 1, 2, 3\n\n    printf(\"sumAry2D_f1() %d\\n\", sumAry2D_f1(ary2D, 2, 3));\n\n    // why we can`t function like this?\n    // printf(\"sumAry2D_f1~3() %d\\n\", sumAry2D_f1(ary, 2, 3));\n\n    freeAry2D(ary, 2); // free function of dynamic array\n\n    return 0;\n}\n\nint sumAry2D_f1(int ary[][3], int rows, int cols)\n{\n    int i, j, sum = 0;\n\n    for (i = 0; i &lt; rows; i++)\n        for (j = 0; j &lt; cols; j++)\n            sum += ary[i][j];\n\n    return sum;\n}\n\nvoid freeAry2D(int **ary, int rows)\n{\n    int i;\n\n    for (i = 0; i &lt; rows; i++)\n    free(ary[i]);\n    free(ary);\n}\n</code></pre>\n"}, {"tags": ["c", "judy-array"], "comments": [{"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 0, "creation_date": 1504756975, "post_id": 46064893, "comment_id": 79137038, "body": "I\u2019m not familiar with the API here and the documentation is pretty painful, but it seems like if you\u2019re writing with <code>*PValue = &quot;HELLO...&quot;</code> you should be reading via <code>%s</code> with <code>*PValue</code> and not <code>&amp;PValue</code>."}], "answers": [{"tags": [], "owner": {"reputation": 401, "user_id": 7926640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15aaf0885ac6a86de3d42c23139abdb2?s=128&d=identicon&r=PG&f=1", "display_name": "stensal", "link": "https://stackoverflow.com/users/7926640/stensal"}, "is_accepted": false, "score": 0, "last_activity_date": 1504682332, "creation_date": 1504682332, "answer_id": 46069096, "question_id": 46064893, "link": "https://stackoverflow.com/questions/46064893/c-how-to-insert-and-read-a-string-to-from-a-judy-hash/46069096#46069096", "title": "C: How to insert and read a string to/from a Judy Hash", "body": "<p>I ran your code thru my tool and it shows the code has a buffer overrun issue.  This is the error msg:</p>\n\n<pre><code>DTS_MSG: Stensal DTS detected a runtime program error. Abort execution!\nDTS_MSG: Reading 1 bytes at 0xbfffdba0 violates type safety.\nDTS_MSG: Diagnostic information:\n\n- The object to-be-read (start:0xbfffdb9c, size:4 bytes) is allocated at\n-     file:/tmp/a.c::9, 19 \n-  0xbfffdb9c               0xbfffdb9f\n-  +------------------------+\n-  | the object  to-be-read |......\n-  +------------------------+\n-                            ^~~~~~~~~~\n-        the read starts at 0xbfffdba0 that is right after the object end.\n- Stack trace (most recent call first):\n-[1]  file:/src/string/memchr.c::25, 9 \n-[2]  file:/src/stdio/vfprintf.c::602, 8 \n-[3]  file:/src/stdio/vfprintf.c::678, 8 \n-[4]  file:/src/stdio/printf.c::9, 8 \n-[5]  file:/tmp/a.c::16, 9 \n-[6]  file:/src/env/__libc_start_main.c::149, 11 \n</code></pre>\n\n<p>Basically, &amp;PValue takes the address of Pvalue and printf treats it as the address of a JudySL array of 4 bytes.  If you change </p>\n\n<pre><code> printf(\"%s\\n\", &amp;PValue);\n</code></pre>\n\n<p>to</p>\n\n<pre><code> printf(\"%s\\n\", PValue);\n</code></pre>\n\n<p>It will print out \"P{WHAT\" for me. I'm not familiar with Judy hash, so you need to verify if it's the intended result. </p>\n"}], "owner": {"reputation": 3305, "user_id": 3355076, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/7e4d588409a85426aabe6a1a94a5789e?s=128&d=identicon&r=PG", "display_name": "Christopher Reid", "link": "https://stackoverflow.com/users/3355076/christopher-reid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 162, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1504682332, "creation_date": 1504656042, "last_edit_date": 1504657397, "question_id": 46064893, "link": "https://stackoverflow.com/questions/46064893/c-how-to-insert-and-read-a-string-to-from-a-judy-hash", "title": "C: How to insert and read a string to/from a Judy Hash", "body": "<p>I've been searching around for a while to get an answer but I am still very unclear on what I am supposed to do. </p>\n\n<p>In all the official examples all the Values and indexes and pointers to them are of the type Word_t or PWord_t, which as far as I can tell is just an int of some kind. My confusion is trying to understand how this can refer to a char* or buffer (char[]) or raw string (\"string\")</p>\n\n<p>Here's something I've tried, but the output is unintelligible (like what you see when you print a binary)</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;Judy.h&gt;\n\n\nint main()\n{\n\n        Pvoid_t   PJArray = (PWord_t)NULL;  // Judy array.\n        PWord_t   PValue;                   // Judy array element.\n        Word_t    Bytes;                    // size of JudySL array.\n\n        JSLI(PValue, PJArray, \"WHAT\");\n        *PValue = \"HELLO...\";\n\n        JSLG(PValue, PJArray, \"WHAT\");\n        printf(\"%s\\n\", &amp;PValue);\n\n        return 0;\n} \n</code></pre>\n\n<p>output is:</p>\n\n<pre><code>`(@\ufffd\ufffd\n</code></pre>\n"}, {"tags": ["c", "dev-c++"], "comments": [{"owner": {"reputation": 2283, "user_id": 4526030, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-s05ILbxi6YA/AAAAAAAAAAI/AAAAAAAAACc/yAd6W8jNSBI/photo.jpg?sz=128", "display_name": "John Perry", "link": "https://stackoverflow.com/users/4526030/john-perry"}, "edited": false, "score": 0, "creation_date": 1504655938, "post_id": 46064842, "comment_id": 79090549, "body": "In what line of your code does that error appear?"}, {"owner": {"reputation": 2283, "user_id": 4526030, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-s05ILbxi6YA/AAAAAAAAAAI/AAAAAAAAACc/yAd6W8jNSBI/photo.jpg?sz=128", "display_name": "John Perry", "link": "https://stackoverflow.com/users/4526030/john-perry"}, "edited": false, "score": 0, "creation_date": 1504656017, "post_id": 46064842, "comment_id": 79090562, "body": "Also, does it appear once you&#39;ve added the definition of <code>struct ffblk</code> in header.c?"}, {"owner": {"reputation": 89, "user_id": 5474240, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/8a8313c2296a67a51345c25289734585?s=128&d=identicon&r=PG&f=1", "display_name": "Sandra G.", "link": "https://stackoverflow.com/users/5474240/sandra-g"}, "reply_to_user": {"reputation": 2283, "user_id": 4526030, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-s05ILbxi6YA/AAAAAAAAAAI/AAAAAAAAACc/yAd6W8jNSBI/photo.jpg?sz=128", "display_name": "John Perry", "link": "https://stackoverflow.com/users/4526030/john-perry"}, "edited": false, "score": 0, "creation_date": 1504656911, "post_id": 46064842, "comment_id": 79090746, "body": "Initially the code was just the main.c but i get multiple errors, and seeing the examples i created the header.h and header.c  The laste error remaining appears at the main.c at the declaration of struct ffblk ffblk."}, {"owner": {"reputation": 2283, "user_id": 4526030, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-s05ILbxi6YA/AAAAAAAAAAI/AAAAAAAAACc/yAd6W8jNSBI/photo.jpg?sz=128", "display_name": "John Perry", "link": "https://stackoverflow.com/users/4526030/john-perry"}, "edited": false, "score": 0, "creation_date": 1504659902, "post_id": 46064842, "comment_id": 79091316, "body": "I just noticed you&#39;re using some Windows-specific file, so I probably can&#39;t help you too much, but your new error usually means that findfirst and findnext need to be defined, included, or linked. Do you know what file they&#39;re supposed to come from? If you include the dos library (<code>#include &lt;dos.h&gt;</code>) then do you also have to link to the dos library (<code>-ldos</code> from the command line, not sure what to do in Dev-Cpp)."}, {"owner": {"reputation": 729, "user_id": 8346796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50837d0931654f2bccfabe97d49afc8?s=128&d=identicon&r=PG&f=1", "display_name": "LAS", "link": "https://stackoverflow.com/users/8346796/las"}, "edited": false, "score": 0, "creation_date": 1504660204, "post_id": 46064842, "comment_id": 79091387, "body": "It&#39;s been many years since I worked in c but doesn&#39;t main.c need a main routine as in int main() { &lt;your code&gt; }?"}, {"owner": {"reputation": 89, "user_id": 5474240, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/8a8313c2296a67a51345c25289734585?s=128&d=identicon&r=PG&f=1", "display_name": "Sandra G.", "link": "https://stackoverflow.com/users/5474240/sandra-g"}, "edited": false, "score": 0, "creation_date": 1504660984, "post_id": 46064842, "comment_id": 79091547, "body": "I tried to define them with: #define findfirst(n,a,b) (_dos_findfirst((n),(b),(a)))  #define findnext(b) (_dos_findnext(b)) . But shows errors: C:\\Users\\1\\AppData\\Local\\Temp\\ccilDOws.o:Untitled6.c:(.text+&zwnj;&#8203;0xa6): undefined reference to <code>_dos_findfirst&#39; C:\\Users\\1\\AppData\\Local\\Temp\\ccilDOws.o:Untitled6.c:(.text+&zwnj;&#8203;0x1cd): undefined reference to </code>_dos_findnext&#39;"}, {"owner": {"reputation": 2283, "user_id": 4526030, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-s05ILbxi6YA/AAAAAAAAAAI/AAAAAAAAACc/yAd6W8jNSBI/photo.jpg?sz=128", "display_name": "John Perry", "link": "https://stackoverflow.com/users/4526030/john-perry"}, "edited": false, "score": 0, "creation_date": 1504722739, "post_id": 46064842, "comment_id": 79125995, "body": "@SandraG. I think you will have to define them as C functions, unless <code>_dos_findfirst</code> and <code>_dos_findnext</code> appear somewhere in the DOS library (in which case you&#39;d need to link to them)."}, {"owner": {"reputation": 2283, "user_id": 4526030, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-s05ILbxi6YA/AAAAAAAAAAI/AAAAAAAAACc/yAd6W8jNSBI/photo.jpg?sz=128", "display_name": "John Perry", "link": "https://stackoverflow.com/users/4526030/john-perry"}, "reply_to_user": {"reputation": 729, "user_id": 8346796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50837d0931654f2bccfabe97d49afc8?s=128&d=identicon&r=PG&f=1", "display_name": "LAS", "link": "https://stackoverflow.com/users/8346796/las"}, "edited": false, "score": 0, "creation_date": 1504722802, "post_id": 46064842, "comment_id": 79126023, "body": "@LAS her <code>main.c</code> file does in fact have a function declared as <code>int main(void) { ... }</code>"}, {"owner": {"reputation": 2283, "user_id": 4526030, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-s05ILbxi6YA/AAAAAAAAAAI/AAAAAAAAACc/yAd6W8jNSBI/photo.jpg?sz=128", "display_name": "John Perry", "link": "https://stackoverflow.com/users/4526030/john-perry"}, "edited": false, "score": 0, "creation_date": 1504723218, "post_id": 46064842, "comment_id": 79126265, "body": "@SandraG. By &quot;define them&quot; I mean that you need to write a loop that goes through the file, finds the first instance of the <code>ffblk</code> you&#39;re trying to find. Seems to me there&#39;s no need to write two separate functions for <code>findfirst</code> and <code>findnext</code>; just write one function <code>findnext</code> and use that for both cases.  I don&#39;t <b>know</b> that that&#39;s the case, but it&#39;s all I can think of at the moment, because I&#39;m not familiar with the Window dos library."}], "answers": [{"tags": [], "owner": {"reputation": 89, "user_id": 5474240, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/8a8313c2296a67a51345c25289734585?s=128&d=identicon&r=PG&f=1", "display_name": "Sandra G.", "link": "https://stackoverflow.com/users/5474240/sandra-g"}, "is_accepted": true, "score": 0, "last_activity_date": 1505964045, "creation_date": 1505964045, "answer_id": 46334943, "question_id": 46064842, "link": "https://stackoverflow.com/questions/46064842/c-error-not-defined-and-storage-unknown/46334943#46334943", "title": "C - ERROR not defined and storage unknown", "body": "<p>At the end, the problem was always the functions findfirst(a,b,c) and findnext(a,b,c). I had to change the functions and use their version with 2 parameters and not 3.  I put all the code in one file with the includes, typedef struct and the code below.</p>\n"}], "owner": {"reputation": 89, "user_id": 5474240, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/8a8313c2296a67a51345c25289734585?s=128&d=identicon&r=PG&f=1", "display_name": "Sandra G.", "link": "https://stackoverflow.com/users/5474240/sandra-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 280, "favorite_count": 0, "accepted_answer_id": 46334943, "answer_count": 1, "score": -1, "last_activity_date": 1505964045, "creation_date": 1504655681, "last_edit_date": 1504657063, "question_id": 46064842, "link": "https://stackoverflow.com/questions/46064842/c-error-not-defined-and-storage-unknown", "title": "C - ERROR not defined and storage unknown", "body": "<p>I have this code for deleting directories. I have <code>header1.h</code>, <code>header1.c</code>, <code>main.c</code>.\nI get some errors, but the one is more difficult to me to understand is the errors: \n(1) storage size of <code>ffblk</code> isn't known.\nAlso, i have the doubt of how to define the attributes of <code>ffblk</code>, which are ff_name and <code>ff_attrib</code>\nThis example is from various code examples from the internet(even other from here), all of them do the same code, just in my case it does not work.\nAm i missing the definition of the struct? or maybe i have added code where it should not be any code?\nCould you please help me? I dont usually program in C. and i am using <strong>Dev-Cpp</strong>.</p>\n\n<p>header1.h:</p>\n\n<pre><code>#ifndef HEADER1_H_INCLUDED\n#define HEADER1_H_INCLUDED\n\ntypedef struct ffblk ffblk;\n\n#endif\n</code></pre>\n\n<p>header.c:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include \"header1.h\"\nstruct ffblk\n{\n    char ff_attrib[20];  //this line i added just so dont show error of unknown\n    char ff_name[20];  //this line i added just so dont show error of unknown\n};\n</code></pre>\n\n<p>main.c:</p>\n\n<pre><code>#ifndef FA_RDONLY\n  #define FA_RDONLY _A_RDONLY\n #endif\n\n#ifndef FA_HIDDEN\n  #define FA_HIDDEN _A_HIDDEN\n #endif\n\n #ifndef FA_SYSTEM\n  #define FA_SYSTEM _A_SYSTEM\n #endif\n\n #ifndef FA_DIREC\n  #define FA_DIREC _A_SUBDIR\n #endif\n\n #ifndef FA_ARCH\n  #define FA_ARCH _A_ARCH\n #endif\n\n\n# include &lt;stdio.h&gt;\n# include &lt;dos.h&gt;\n# include &lt;dir.h&gt;\n# include &lt;io.h&gt;\n# include &lt;conio.h&gt;\n#include \"header1.h\"\n\n    typedef struct ffblk ffblk;\n\nint BorrarArchivo(char *nombarch)\n{\n   printf(\"Borrando Archivo %s \\n\",nombarch);\n\n   remove(nombarch);\n\n   return 0;\n}\n\nint EliminarAtributo(char *nombarch,int atributo)\n{\n   printf(\"Elimina Atributo %s   %d\\n\",nombarch,atributo);\n\n   chmod(nombarch,atributo);\n\n   return 0;\n}\n\nint BorrarArbol(void)\n{  \n   struct ffblk ffblk;\n   int done,err;\n\n   err=0;\n   done=findfirst(\"*.*\",&amp;ffblk,FA_RDONLY|FA_HIDDEN|FA_DIREC|FA_ARCH|FA_SYSTEM);\n\n   while (!done)\n   {\n     if (FA_HIDDEN &amp; ffblk.ff_attrib)\n         EliminarAtributo(ffblk.ff_name,FA_HIDDEN);\n\n     if (FA_SYSTEM &amp; ffblk.ff_attrib)\n         EliminarAtributo(ffblk.ff_name,FA_SYSTEM);\n\n     if (FA_RDONLY &amp; ffblk.ff_attrib)\n         EliminarAtributo(ffblk.ff_name,FA_RDONLY);\n\n     if (FA_ARCH &amp; ffblk.ff_attrib)\n         err=BorrarArchivo(ffblk.ff_name);\n     else if (FA_DIREC &amp; ffblk.ff_attrib)\n     {\n        if (ffblk.ff_name[0]!='.')\n        { \n            chdir(ffblk.ff_name);\n\n            err=BorrarArbol();\n\n            chdir(\"..\");\n\n            if (!err)  \n                printf(\"Removiendo %s\\n\",ffblk.ff_name);\n\n            rmdir(ffblk.ff_name);\n        }\n     }\n     else\n        err=BorrarArchivo(ffblk.ff_name);\n\n     if (err)\n     {  \n        printf(\"Error en el borrado ... !\"); return err;\n     }\n\n     done=findnext(&amp;ffblk);\n    }\n\n   return 0;\n}\n\nint main (void)\n{ int err=0;\n  char c;\n    printf(\"Esta seguro  [ Si -&gt; S , No -&gt;otra tecla ] =&gt;\");\n    c=getchar();\n    if (!(c=='S' || c=='s')) return 0;\n    err=BorrarArbol();\n    if (err) printf(\"Error en el borrado ... !\");\n    return err;\n}\n</code></pre>\n\n<p>EDIT:\nI found a definition of struct and paste it in header.h</p>\n\n<pre><code>typedef struct ffblk {\n      char lfn_magic[6];        /* LFN: the magic \"LFN32\" signature */\n      short lfn_handle;     /* LFN: the handle used by findfirst/findnext */\n      unsigned short lfn_ctime; /* LFN: file creation time */\n      unsigned short lfn_cdate; /* LFN: file creation date */\n      unsigned short lfn_atime; /* LFN: file last access time (usually 0) */\n      unsigned short lfn_adate; /* LFN: file last access date */\n      char ff_reserved[5];      /* used to hold the state of the search */\n      unsigned char ff_attrib;  /* actual attributes of the file found */\n      unsigned short ff_ftime;  /* hours:5, minutes:6, (seconds/2):5 */\n      unsigned short ff_fdate;  /* (year-1980):7, month:4, day:5 */\n      unsigned long ff_fsize;   /* size of file */\n      char ff_name[260];        /* name of file as ASCIIZ string */\n    }ffblk;\n</code></pre>\n\n<p>now it shows error:</p>\n\n<pre><code>C:\\Users\\1\\AppData\\Local\\Temp\\cc89P309.o:Untitled3.c:(.text+0x8e): undefined reference to `findfirst'\nC:\\Users\\1\\AppData\\Local\\Temp\\cc89P309.o:Untitled3.c:(.text+0x1d8): undefined reference to `findnext'\n</code></pre>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 2, "creation_date": 1504655646, "post_id": 46064829, "comment_id": 79090490, "body": "You cannot dereference  (i.e. apply operator <code>*</code> or operator <code>-&gt;</code> to) a void pointer."}, {"owner": {"reputation": 56117, "user_id": 845092, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=128&d=identicon&r=PG", "display_name": "Mooing Duck", "link": "https://stackoverflow.com/users/845092/mooing-duck"}, "edited": false, "score": 2, "creation_date": 1504655684, "post_id": 46064829, "comment_id": 79090502, "body": "Do you think that <code>check = ((test *) check);</code> changes the <i>type</i> of <code>check</code>?"}, {"owner": {"reputation": 5, "user_id": 6205998, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/10156756991120065/picture?type=large", "display_name": "Kumar", "link": "https://stackoverflow.com/users/6205998/kumar"}, "reply_to_user": {"reputation": 56117, "user_id": 845092, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=128&d=identicon&r=PG", "display_name": "Mooing Duck", "link": "https://stackoverflow.com/users/845092/mooing-duck"}, "edited": false, "score": 0, "creation_date": 1504656155, "post_id": 46064829, "comment_id": 79090592, "body": "@MooingDuck Why would that not change the type of check?"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 2, "creation_date": 1504656429, "post_id": 46064829, "comment_id": 79090644, "body": "Because the type of an object is determined by its declaration, not by any value that might be assigned to it later. This: <code>check = ((test *) check);</code> explicitly converts the value of <code>check</code> from <code>void*</code> to <code>test*</code>, and then implicitly, via the assignment, converts the result right back to <code>void*</code>. Similarly, <code>int n; n = 2.5;</code> doesn&#39;t result in <code>n</code> being able to hold fractional values; it&#39;s still an <code>int</code>."}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1504656717, "post_id": 46064829, "comment_id": 79090705, "body": "<code>check = ((test *) check);</code> does nothing. Your compiler probably will optimize it away"}, {"owner": {"reputation": 32078, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 0, "creation_date": 1504680513, "post_id": 46064829, "comment_id": 79097466, "body": "Changing types is not possible at all."}], "answers": [{"tags": [], "owner": {"reputation": 273, "user_id": 2724047, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XwYrD.png?s=128&g=1", "display_name": "Reuben Crimp", "link": "https://stackoverflow.com/users/2724047/reuben-crimp"}, "is_accepted": false, "score": 0, "last_activity_date": 1504682161, "last_edit_date": 1504682161, "creation_date": 1504680547, "answer_id": 46068575, "question_id": 46064829, "link": "https://stackoverflow.com/questions/46064829/casting-void-pointer-in-the-same-variable-leads-to-compilation-error/46068575#46068575", "title": "casting void pointer in the same variable leads to compilation error", "body": "<p>Casting a pointer is just lying to your compiler</p>\n\n<pre><code>void * ptr = malloc(sizeof(test));\n((test *)ptr)-&gt;a = 5;\n</code></pre>\n\n<p>In the second line, we are telling the compiler <em>\"I know I declared ptr as a (void *), but I'm smarter than you, and trust me, it's actually a (test *)\"</em>. Nothing has changed, ptr is still just a pointer, an address of a memory location, but the compiler assumes it's pointing to something specific. </p>\n\n<pre><code>  check-&gt;a = 2; //this raises an error (dereferencing void pointer) when compiling\n</code></pre>\n\n<p>You <strong>must</strong> cast your variables every single time you want the compiler to treat it as something different from what you declared it to be.</p>\n\n<p>A more interesting scenario to explain what you can do with casting pointers...</p>\n\n<pre><code>// struct with two ints, a and b\ntypedew struct testAB {\n  int a;\n  int b;\n} testAB;\n\n// struct with two ints, named in reverse order\ntypedef struct testBA {\n  int b;\n  int a;\n} testBA;\n\nint main(void) {\n  // construct a testAB struct\n  void *ptr = malloc(sizeof(testAB));\n  ((testAB *)ptr)-&gt;a = 0\n  ((testAB *)ptr)-&gt;b = 1\n\n  // treat ptr as a testBA struct\n  if ( ((testBA *)ptr)-&gt;a == 1) {\n    printf(\"this shouldn't happen, 'a' was set to 0\");\n  }\n}\n</code></pre>\n\n<p>if you run the above code, you will find that the printf statement will be executed. Even though we set 'a' to be 0, and the if statement checks that a == 1.</p>\n\n<p>This is because structs are stupidly simple. In the above example the struct(s) is just two int's packed next to eachother. Much like an array of two ints, like this:</p>\n\n<pre><code>int array[2] = {0, 1};\nvoid *ptr = &amp;array; \n</code></pre>\n\n<p>Even with this representation, we can lie to the compiler, we can force the compiler to treat this 'array' as one of our structs.</p>\n\n<pre><code>if ( ((testAB *)array)-&gt;a == 0 )\n  printf(\"a is 0\");\n</code></pre>\n\n<p>This is because, under the hood, the compiler treats named variables in a struct as just offests from where the struct is. </p>\n\n<pre><code>// the following two lines have the same affect\n((testAB *)array)-&gt;a = 0;\narray[0] = 0;\n\n// the following two lines have the same affect\n((testAB *)array)-&gt;b = 2;\narray[1] = 2;\n</code></pre>\n\n<p>if we tell the compiler that it's a (testAB *), then 'a' means the first int, and 'b' means the second. If we tell the compiler that it's a (testBA *), then 'a' is the second, and 'b' is the first.</p>\n\n<p>In compiled code <strong>ALL</strong> variable names are lost. The compiler reduces the struct assignment, down to \"set the second int of the struct to 2\". Or more specifically, if we are dealing with 32-bit ints, set bytes 5, 6, 7 and 8 of the struct to 0000, 0000 0000 0010 (in binary. (or perhaps in reverse order, if we are compiling for a little endian CPU)</p>\n"}], "owner": {"reputation": 5, "user_id": 6205998, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/10156756991120065/picture?type=large", "display_name": "Kumar", "link": "https://stackoverflow.com/users/6205998/kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 106, "favorite_count": 0, "answer_count": 1, "score": -5, "last_activity_date": 1504682161, "creation_date": 1504655551, "last_edit_date": 1504655654, "question_id": 46064829, "link": "https://stackoverflow.com/questions/46064829/casting-void-pointer-in-the-same-variable-leads-to-compilation-error", "title": "casting void pointer in the same variable leads to compilation error", "body": "<p>I'm testing an issue that I'm having when casting void pointers to a different type within the same variable. The issue seems to be when trying to use the same variable for the casted pointer. Below I have a section of code that tests this. Would someone be able to tell me why the program fails to compile for that case?</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n\ntypedef struct test {\n\n  int a;\n\n}test;\n\nint main() {\n\n  void * check;\n  test * check2;\n  check =  malloc(sizeof(test));\n\n  check = ((test *) check);\n  check2 = (test *)check;\n\n\n  check-&gt;a = 2; //this raises an error (dereferencing void pointer) when compiling\n  check2-&gt;a = 2; //this works\n  ((test *)check)-&gt;a = 2; //this also works\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "winapi", "memory-management"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 2, "creation_date": 1504655050, "post_id": 46064722, "comment_id": 79090371, "body": "Any memory allocation scheme that didn&#39;t use a pool would be broken."}, {"owner": {"reputation": 4398, "user_id": 2012715, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/0a04a0851dba37de648917cf0abea9b8?s=128&d=identicon&r=PG", "display_name": "Dmitry", "link": "https://stackoverflow.com/users/2012715/dmitry"}, "edited": false, "score": 0, "creation_date": 1504655068, "post_id": 46064722, "comment_id": 79090377, "body": "you mean needlessly slow, right?"}, {"owner": {"reputation": 42446, "user_id": 902497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff13ece6277497484bfa2911c6183a30?s=128&d=identicon&r=PG", "display_name": "Raymond Chen", "link": "https://stackoverflow.com/users/902497/raymond-chen"}, "edited": false, "score": 8, "creation_date": 1504655651, "post_id": 46064722, "comment_id": 79090491, "body": "HeapSize behavior is <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa366706(v=vs.85).aspx\" rel=\"nofollow noreferrer\">undefined</a> if you pass something that was not return by a previous call to HeapAlloc. It&#39;s possible that malloc etc allocate memory from the heap, but do not return the pointer directly. They might return an interior pointer. (Indeed, <code>new[]</code> frequently returns an interior pointer. And <code>BSTR</code> is in fact required to return an interior pointer due to the placement of the string size ahead of the first character.)"}, {"owner": {"reputation": 4398, "user_id": 2012715, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/0a04a0851dba37de648917cf0abea9b8?s=128&d=identicon&r=PG", "display_name": "Dmitry", "link": "https://stackoverflow.com/users/2012715/dmitry"}, "edited": false, "score": 0, "creation_date": 1504655927, "post_id": 46064722, "comment_id": 79090545, "body": "i am asking on this particular system. It can&#39;t be undefined if it predictably returns the same value as that returned by blocks created with new. They must be allocated using the global heap, otherwise HeapSize would not succeed. If HeapSize failed, it would indicate it wasn&#39;t created using the specified heap(obtained from GetProcessHeap)."}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1504657716, "post_id": 46064722, "comment_id": 79090873, "body": "It doesn&#39;t fail. &#39;If the <code>lpMem</code> parameter refers to a heap allocation that is not in the heap specified by the <code>hHeap</code> parameter, the behavior of the <code>HeapSize</code> function is <i>undefined.</i>&#39; Emphasis added."}, {"owner": {"reputation": 4398, "user_id": 2012715, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/0a04a0851dba37de648917cf0abea9b8?s=128&d=identicon&r=PG", "display_name": "Dmitry", "link": "https://stackoverflow.com/users/2012715/dmitry"}, "edited": false, "score": 0, "creation_date": 1504658218, "post_id": 46064722, "comment_id": 79090981, "body": "Wait... that&#39;s the legendary Reymond Chen O.o. Anyway, Ill post the sample I referred to at beginning of my post. The BSTR created from SysCreateString passed to HeapSize returned 0, so it wasn&#39;t using the process heap, doesn&#39;t that make it external?"}, {"owner": {"reputation": 4398, "user_id": 2012715, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/0a04a0851dba37de648917cf0abea9b8?s=128&d=identicon&r=PG", "display_name": "Dmitry", "link": "https://stackoverflow.com/users/2012715/dmitry"}, "edited": false, "score": 0, "creation_date": 1504658601, "post_id": 46064722, "comment_id": 79091067, "body": "Oh by interior pointer, you mean that it&#39;s a pointer inside an allocated region(eg it&#39;s shifted by 4 bytes of the actual allocation). I thought you meant internal as in in GetProcessHeap, and external if elsewhere."}, {"owner": {"reputation": 33265, "user_id": 886887, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1616c7e4fab23f6e014ee11d75408bba?s=128&d=identicon&r=PG", "display_name": "Harry Johnston", "link": "https://stackoverflow.com/users/886887/harry-johnston"}, "edited": false, "score": 1, "creation_date": 1504660200, "post_id": 46064722, "comment_id": 79091384, "body": "Note that it isn&#39;t a question of what the behaviour is &quot;on your system&quot;, malloc, calloc and new are all part of the C runtime, so it depends on which compiler you&#39;re using.  Also, typically, on whether you&#39;ve built in debug or release mode.  You may well have access to the source code, in which case there&#39;s no need to guess."}, {"owner": {"reputation": 4398, "user_id": 2012715, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/0a04a0851dba37de648917cf0abea9b8?s=128&d=identicon&r=PG", "display_name": "Dmitry", "link": "https://stackoverflow.com/users/2012715/dmitry"}, "edited": false, "score": 0, "creation_date": 1504667457, "post_id": 46064722, "comment_id": 79093008, "body": "you&#39;re right, if I understand correctly, malloc, calloc, new are all part of the C runtime which can vary in implementation between visual studio&#39;s default, and mingw&#39;s default, among others, whereas HeapAlloc is the system dependant part.  That said, I was asking whether given the observation, it is safe to assume that the C standard library I link to is using a pool, or if I am missing something. I was having doubts whether it&#39;s a safe conclusion or not."}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1504679325, "post_id": 46064722, "comment_id": 79096774, "body": "sizeof(L&quot;Hello, World!&quot;) is the size of a pointer so you have buffer overrun. That said, your question seems pointless."}, {"owner": {"reputation": 4398, "user_id": 2012715, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/0a04a0851dba37de648917cf0abea9b8?s=128&d=identicon&r=PG", "display_name": "Dmitry", "link": "https://stackoverflow.com/users/2012715/dmitry"}, "edited": false, "score": 0, "creation_date": 1504679401, "post_id": 46064722, "comment_id": 79096826, "body": "no, string literals are always counted as byte arrays. test it yourself. sizeof a string literal or a array will give a correct length, including the null terminator. try a simple program: <code>int main(int argc, char **argv){return sizeof(L&quot;Hi&quot;);}</code> it will return 6."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1504680740, "post_id": 46064722, "comment_id": 79097624, "body": "<code>wcsncpy(w, L&quot;Hello, World!&quot;, sizeof(L&quot;Hello, World!&quot;));</code> is serious error and buffer overflow. must be <code>wcsncpy(w, L&quot;Hello, World!&quot;, sizeof(L&quot;Hello, World!&quot;)&#47;sizeof(WCHAR));</code>"}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1504680955, "post_id": 46064722, "comment_id": 79097746, "body": "Fair enough. I&#39;ve  still no idea what your problem is. What even is your question?"}, {"owner": {"reputation": 4398, "user_id": 2012715, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/0a04a0851dba37de648917cf0abea9b8?s=128&d=identicon&r=PG", "display_name": "Dmitry", "link": "https://stackoverflow.com/users/2012715/dmitry"}, "edited": false, "score": 0, "creation_date": 1504680957, "post_id": 46064722, "comment_id": 79097748, "body": "My bad, I assumed that the length argument of wcsncpy was byte based. Fortunately wcsncpy stops at null terminator, so it should still work, but yeah that was an erroneous assumption, I&#39;ll fix the code."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1504681164, "post_id": 46064722, "comment_id": 79097874, "body": "also call <code>HeapSize</code> for <code>SysAllocString</code> is error and must be break under debugger because pointer returned by <code>SysAllocString</code> not at begin of allocated memory block"}, {"owner": {"reputation": 4398, "user_id": 2012715, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/0a04a0851dba37de648917cf0abea9b8?s=128&d=identicon&r=PG", "display_name": "Dmitry", "link": "https://stackoverflow.com/users/2012715/dmitry"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1504681298, "post_id": 46064722, "comment_id": 79097949, "body": "@RbMm I am not sure what you mean. It is at beginning of the allocated block, w is the same pointer i got from HeapAlloc, which is  the beginning of the allocated block."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 1, "creation_date": 1504681387, "post_id": 46064722, "comment_id": 79098017, "body": "<code>Fortunately wcsncpy stops at null terminator,</code> - no it not stop and was buffer overflow. <i>If count is greater than the length of strSource, the destination string is padded with null characters up to length count</i>"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1504681774, "post_id": 46064722, "comment_id": 79098250, "body": "@Dmitry - the <code>SysAllocString</code> return not pointer to allocated block - and if call <code>HeapSize</code> with this pointer - will be exception if process debugged"}, {"owner": {"reputation": 4398, "user_id": 2012715, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/0a04a0851dba37de648917cf0abea9b8?s=128&d=identicon&r=PG", "display_name": "Dmitry", "link": "https://stackoverflow.com/users/2012715/dmitry"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1504681778, "post_id": 46064722, "comment_id": 79098252, "body": "@RbMm that&#39;s embarassing, that&#39;s actually horrible, I tested it and it actually pads with zeroes. Thanks for letting me know. Oh, I see what you&#39;re saying; that&#39;s a part of what I was checking, what would happen if I gave a pointer to this block to HeapSize, to me it returned 0, but I did it in mingw so it didn&#39;t crash, I assumed this is because the pointer is not contained in the process heap."}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1504682724, "post_id": 46064722, "comment_id": 79098882, "body": "Why are you intentionally passing invalid values to HeapSize? Do you have an actual problem?"}, {"owner": {"reputation": 4398, "user_id": 2012715, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/0a04a0851dba37de648917cf0abea9b8?s=128&d=identicon&r=PG", "display_name": "Dmitry", "link": "https://stackoverflow.com/users/2012715/dmitry"}, "reply_to_user": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1504682993, "post_id": 46064722, "comment_id": 79099030, "body": "@David Heffernan in my original test, I was curious how SysAllocString behaved(whether it was allocated on the process heap or elsewhere) so I decided to try out HeapSize which seemed to answer that question. In this question I&#39;m asking whether this is a reasonable way to check whether the current system runtime is allocating memory from a pool on the process heap, or somewhere else, as I was having doubts."}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1504683246, "post_id": 46064722, "comment_id": 79099212, "body": "The only thing you can pass to HeapSize is something allocated by HeapAlloc and friends. Surely the documentation says so. Why are you persisting?"}, {"owner": {"reputation": 4398, "user_id": 2012715, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/0a04a0851dba37de648917cf0abea9b8?s=128&d=identicon&r=PG", "display_name": "Dmitry", "link": "https://stackoverflow.com/users/2012715/dmitry"}, "edited": false, "score": 0, "creation_date": 1504683358, "post_id": 46064722, "comment_id": 79099266, "body": "I&#39;m not persisting, I only called it once on each friend, and it failed on the pointer returned by SysAllocString, which told me it wasn&#39;t on the process heap."}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1504683689, "post_id": 46064722, "comment_id": 79099462, "body": "It&#39;s likely that calls to <code>malloc</code> will use the process heap, but won&#39;t return you the base pointer returned by the internal call to <code>HeapAlloc</code>. Instead they store meta data there, and return you a pointer at an offset. Basically, your code proves nothing at all."}, {"owner": {"reputation": 4398, "user_id": 2012715, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/0a04a0851dba37de648917cf0abea9b8?s=128&d=identicon&r=PG", "display_name": "Dmitry", "link": "https://stackoverflow.com/users/2012715/dmitry"}, "edited": false, "score": 0, "creation_date": 1504683873, "post_id": 46064722, "comment_id": 79099566, "body": "I wasnt trying to prove anything about sysallocstring(it&#39;s too naive), I&#39;m trying to prove for the new, malloc, calloc, and whether they use internal pool or use HeapAlloc directly, or perhaps not use Heap at all."}], "answers": [{"comments": [{"owner": {"reputation": 4398, "user_id": 2012715, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/0a04a0851dba37de648917cf0abea9b8?s=128&d=identicon&r=PG", "display_name": "Dmitry", "link": "https://stackoverflow.com/users/2012715/dmitry"}, "edited": false, "score": 0, "creation_date": 1504685899, "post_id": 46070056, "comment_id": 79100752, "body": "oh! since SysAllocString returns an internal pointer, HeapSize gets confused because it&#39;s not at the start of the block. My question wasn&#39;t concerning this(that was a side test), but im curious if it will work on the pointer - sizeof(LONG_PTR). And it does!"}, {"owner": {"reputation": 4398, "user_id": 2012715, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/0a04a0851dba37de648917cf0abea9b8?s=128&d=identicon&r=PG", "display_name": "Dmitry", "link": "https://stackoverflow.com/users/2012715/dmitry"}, "edited": false, "score": 0, "creation_date": 1504686481, "post_id": 46070056, "comment_id": 79101110, "body": "I modified my original code so it doesn&#39;t have the naive misuse of HeapSize(since that test proved nothing; I didn&#39;t realize that internal pointers also fail with HeapSize). Anyway, Ill accept the answer since i think all points were answered in the comment section or here."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "reply_to_user": {"reputation": 4398, "user_id": 2012715, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/0a04a0851dba37de648917cf0abea9b8?s=128&d=identicon&r=PG", "display_name": "Dmitry", "link": "https://stackoverflow.com/users/2012715/dmitry"}, "edited": false, "score": 1, "creation_date": 1504687168, "post_id": 46070056, "comment_id": 79101542, "body": "@Dmitry - this is already internal implementation of SysAllocString - how many bytes he reserved (for string len) before string data <code>(LPVOID)((LONG_PTR)b - sizeof(LONG_PTR)</code> - now yes, faster <code>sizeof (SIZE_T)</code> which is 4 or 8"}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1504696174, "post_id": 46070056, "comment_id": 79107901, "body": "@RbMm: Independent of system bitness, the <a href=\"https://stackoverflow.com/q/23098728/1889329\">size prefix of a <code>BSTR</code> is <i>always</i> 4 bytes</a>. This is <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms221069.aspx\" rel=\"nofollow noreferrer\">documented</a> as well."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "reply_to_user": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1504696279, "post_id": 46070056, "comment_id": 79107983, "body": "@IInspectable - try test it yoursel on x64 system. i got exactly 8 byte. how minimum i test on win 10 x64"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "reply_to_user": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1504696604, "post_id": 46070056, "comment_id": 79108226, "body": "@IInspectable - on win7 x64 - also prefix is 8 byte len. think this is <code>sizeof(SIZE_T)</code> exactly. anyway this is internal implementation"}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1504697139, "post_id": 46070056, "comment_id": 79108583, "body": "I just did. The size prefix is 4 bytes, running 64-bit code on 64-bit Windows 10.0.15063, compiled with Visual Studio 2017 15.3.3. It <i>may</i> be possible for the size prefix to get additional padding towards lower addresses, to satisfy alignment constraints, but that padding isn&#39;t part of the size prefix, and would be an implementation detail."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "reply_to_user": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1504697323, "post_id": 46070056, "comment_id": 79108718, "body": "@IInspectable - how you test this ? all my test and looking dissasembly for <code>SysAllocString</code> show 8 bytes prefix (from allocated block) exactly"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "reply_to_user": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1504697743, "post_id": 46070056, "comment_id": 79108991, "body": "@IInspectable - for test you can use and my code which i paste here. or simplest test <code>HeapSize(GetProcessHeap(),0, (PBYTE)b - 8);</code> - return to you correct value when <code>HeapSize(GetProcessHeap(),0, (PBYTE)b - 4);</code> break under debugger. and asm code - <a href=\"https://prnt.sc/ghrgw5\" rel=\"nofollow noreferrer\">prnt.sc/ghrgw5</a>"}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1504700028, "post_id": 46070056, "comment_id": 79110627, "body": "I&#39;m not arguing, that the system wouldn&#39;t allocate more memory than the 4-byte size prefix. The 4-byte size prefix, however, is not an implementation detail. It&#39;s part of the published contract of the <code>BSTR</code> type."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "reply_to_user": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1504701261, "post_id": 46070056, "comment_id": 79111650, "body": "@IInspectable - ok, understand what you mean. yes. the 4 bytes prefix used before string data. but i all time say and mean about offset pointer returned by <code>SysAllocString</code> string from allocated memory block begin."}], "tags": [], "owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "is_accepted": true, "score": 3, "last_activity_date": 1504685681, "creation_date": 1504685681, "answer_id": 46070056, "question_id": 46064722, "link": "https://stackoverflow.com/questions/46064722/does-this-test-prove-that-malloc-calloc-new-manage-their-own-memory-pool-on-my/46070056#46070056", "title": "Does this test prove that malloc, calloc, new manage their own memory pool on my system?", "body": "<p>for call <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa366706(v=vs.85).aspx\" rel=\"nofollow noreferrer\"><code>HeapSize</code></a> for some memory pointer we must at first know the handle to the heap in which the memory block resides, and at second we must be sure that this memory pointer was exactly at begin of allocated block - otherwise <code>HeapSize</code> generate exception, if we under debugger, and not return correct value.</p>\n\n<p>but however possible by given pointer determinate - are it belong to some heap (in process can be several heaps) and not only block size, but offset from block begin (say <code>SysAllocString</code> return not pointer to allocated block, but with offset 8 from block begin). this can be done with help of <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa366571(v=vs.85).aspx\" rel=\"nofollow noreferrer\"><code>GetProcessHeaps</code></a> and <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa366710(v=vs.85).aspx\" rel=\"nofollow noreferrer\"><code>HeapWalk</code></a> (inside <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa366702(v=vs.85).aspx\" rel=\"nofollow noreferrer\">HeapLock</a> and <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa366707(v=vs.85).aspx\" rel=\"nofollow noreferrer\"><code>HeapUnlock</code></a>)</p>\n\n<pre><code>void TestHeapPointer(PVOID pv)\n{\n    static volatile UCHAR guz;\n\n    ULONG NumberOfHeaps = 0, n = 8;\n\n    union {\n        PVOID buf;\n        PHANDLE ProcessHeaps;\n    };\n\n    PVOID stack = alloca(guz);\n\n    BOOL bFound = FALSE;\n\n    do \n    {\n        NumberOfHeaps = RtlPointerToOffset(buf = alloca((n - NumberOfHeaps) * sizeof(HANDLE)), stack) / sizeof(HANDLE);\n\n        if (NumberOfHeaps &gt;= (n = GetProcessHeaps(NumberOfHeaps, ProcessHeaps)))\n        {\n            do \n            {\n                HANDLE hHeap = *ProcessHeaps++;\n\n                if (HeapLock(hHeap))\n                {\n                    PROCESS_HEAP_ENTRY phe = {};\n\n                    while (HeapWalk(hHeap, &amp;phe))\n                    {\n                        if (phe.wFlags &amp; PROCESS_HEAP_ENTRY_BUSY)\n                        {\n                            ULONG_PTR ofs = (ULONG_PTR)pv - (ULONG_PTR)phe.lpData;\n                            if (ofs &lt; phe.cbData)\n                            {\n                                DbgPrint(\"%p in %p block %x size ofs=%x\\n\", pv, phe.lpData, phe.cbData, ofs);\n                                bFound = TRUE;\n                                break;\n                            }\n                        }\n                    }\n                    HeapUnlock(hHeap);\n                }\n\n            } while (!bFound &amp;&amp; --NumberOfHeaps);\n\n            break;\n        }\n    } while (NumberOfHeaps &lt; n);\n\n    if (!bFound) DbgPrint(\"%p not in heaps\", pv);\n}\n</code></pre>\n\n<p>and test like</p>\n\n<pre><code>static const WCHAR cstr[] =  L\"Hello, World!\";\n\nif (PVOID pv = malloc(sizeof(cstr)))\n{\n    TestHeapPointer(pv);\n    free(pv);\n}\n\nif (BSTR b = SysAllocString(cstr))\n{\n    TestHeapPointer(b);\n    SysFreeString(b);\n}\n</code></pre>\n"}], "owner": {"reputation": 4398, "user_id": 2012715, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/0a04a0851dba37de648917cf0abea9b8?s=128&d=identicon&r=PG", "display_name": "Dmitry", "link": "https://stackoverflow.com/users/2012715/dmitry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 284, "favorite_count": 0, "accepted_answer_id": 46070056, "answer_count": 1, "score": -2, "last_activity_date": 1504686365, "creation_date": 1504654769, "last_edit_date": 1504686365, "question_id": 46064722, "link": "https://stackoverflow.com/questions/46064722/does-this-test-prove-that-malloc-calloc-new-manage-their-own-memory-pool-on-my", "title": "Does this test prove that malloc, calloc, new manage their own memory pool on my system?", "body": "<p>I was writing a test program to see how BSTR works compared to a LPWSTR created using <code>malloc</code>. </p>\n\n<p>I decided to call HeapSize on BSTR and LPWSTR to see whether they were on  the process heap or not.</p>\n\n<p>The BSTR was not on the process heap, but I found that the LPWSTR had a HeapSize far larger than the Hello World string I copied into it. The value was very large and <code>GetLastError</code> returned 0 indicating no error. It seemed to give the same large for each LPWSTR i created with <code>malloc</code> so I made a test to see if it was just allocated from the same c runtime heap.</p>\n\n<p>Here is the code for the above:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;Windows.h&gt;\n#include &lt;Windowsx.h&gt;\n\nint main(int argc, char **argv)\n{\n    void *testalloc1;\n    void *testalloc2;\n    LPWSTR w;\n    BSTR b;\n\n    testalloc1 = malloc(1024);\n    testalloc2 = calloc(512, 2);\n    w = (LPWSTR)HeapAlloc(GetProcessHeap(), 0, sizeof(L\"Hello, World!\"));\n    wcsncpy(w, L\"Hello, World!\", sizeof(L\"Hello, World!\") / sizeof(WCHAR));\n    b = SysAllocString(w);\n\n    _putws(w);\n    printf(\"%d.\\n\", *(DWORD *)(((LONG_PTR)b) - 4));\n    _putws(b);\n\n    printf(\"w -&gt; %d.\\n\", HeapSize(GetProcessHeap(), 0, w));\n    printf(\"GetLastError -&gt; 0x%d.\\n\", GetLastError());\n    printf(\"testalloc1 -&gt; %d.\\n\", HeapSize(GetProcessHeap(), 0, testalloc1));\n    printf(\"GetLastError -&gt; 0x%d.\\n\", GetLastError());\n    printf(\"testalloc2 -&gt; %d.\\n\", HeapSize(GetProcessHeap(), 0, testalloc2));\n    printf(\"GetLastError -&gt; 0x%d.\\n\", GetLastError());\n    printf(\"b -&gt; %d.\\n\", HeapSize(\n        GetProcessHeap(), \n        0, \n        (LPVOID)((LONG_PTR)b - sizeof(LONG_PTR))\n    ));\n    printf(\"GetLastError -&gt; 0x%d.\\n\", GetLastError());\n\n    return 0;\n}\n</code></pre>\n\n<p>resulting in:</p>\n\n<pre><code>Hello, World!\n26.\nHello, World!\nw -&gt; 28.\nGetLastError -&gt; 0x0.\ntestalloc1 -&gt; 47120.\nGetLastError -&gt; 0x0.\ntestalloc2 -&gt; 47120.\nGetLastError -&gt; 0x0.\nb -&gt; 32.\nGetLastError -&gt; 0x0.\n</code></pre>\n\n<p>I wrote another test to try understanding what's happening; I allocated multiple memory blocks using different heap-like allocation functions(HeapAlloc, malloc, calloc) and got this output:</p>\n\n<pre><code>malloc(1024) -&gt; 215432.\ncalloc(512, 2) -&gt; 215432\ncalloc(2, 512) -&gt; 215432\nnew BYTE[1024] -&gt; 215432\nnew BYTE[large] -&gt; 1024.\nmalloc(large) -&gt; 1024.\nHeapAlloc(1024) -&gt; 1024.\n</code></pre>\n\n<p>This is the code for the output above:</p>\n\n<pre><code>#include &lt;Windows.h&gt;\n#include &lt;stdio.h&gt;\n\nint main(int argc, char **argv)\n{\n    HANDLE heap;\n    void *mem[7];\n    LONG_PTR limit;\n\n    heap = GetProcessHeap();    \n\n    mem[0] = malloc(1024);\n    mem[1] = calloc(512, 2);\n    mem[2] = calloc(2, 512);\n    mem[3] = (void *)new BYTE[1024];\n\n    limit = HeapSize(heap, 0, mem[0]);\n\n    mem[4] = (void *)new BYTE[limit];\n    mem[5] = malloc(limit);\n    mem[6] = HeapAlloc(heap, 0, 1024);\n\n    printf(\"malloc(1024) -&gt; %d.\\n\", HeapSize(heap, 0, mem[0]));\n    printf(\"calloc(512, 2) -&gt; %d.\\n\", HeapSize(heap, 0, mem[1]));\n    printf(\"calloc(2, 512) -&gt; %d.\\n\", HeapSize(heap, 0, mem[2]));    \n    printf(\"new BYTE[1024] -&gt; %d.\\n\", HeapSize(heap, 0, mem[3]));\n    printf(\"new BYTE[large] -&gt; %d.\\n\", HeapSize(heap, 0, mem[4]));\n    printf(\"malloc(large) -&gt; %d.\\n\", HeapSize(heap, 0, mem[5]));\n    printf(\"HeapAlloc(1024) -&gt; %d.\\n\", HeapSize(heap, 0, mem[6]));\n\n    return 0;\n}\n</code></pre>\n\n<p>Does this code reasonably prove that malloc, calloc, new all use memory pools as first choice for allocation, and HeapAlloc otherwise(on my system), or am I missing something?</p>\n"}, {"tags": ["c", "pointers", "struct", "constants"], "comments": [{"owner": {"reputation": 15898, "user_id": 1155000, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b8213d9cd920e864ce8ff1fdeefe4db5?s=128&d=identicon&r=PG", "display_name": "Daniel Kamil Kozar", "link": "https://stackoverflow.com/users/1155000/daniel-kamil-kozar"}, "edited": false, "score": 5, "creation_date": 1504653401, "post_id": 46064521, "comment_id": 79089991, "body": "Wait. Why would you make all the members <code>const</code> and then violate their constness?"}, {"owner": {"reputation": 461, "user_id": 6033214, "user_type": "registered", "accept_rate": 79, "profile_image": "https://lh6.googleusercontent.com/-seiY7T8JbPU/AAAAAAAAAAI/AAAAAAAAEKs/9FN4GAM9HPo/photo.jpg?sz=128", "display_name": "Stefan B", "link": "https://stackoverflow.com/users/6033214/stefan-b"}, "reply_to_user": {"reputation": 15898, "user_id": 1155000, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b8213d9cd920e864ce8ff1fdeefe4db5?s=128&d=identicon&r=PG", "display_name": "Daniel Kamil Kozar", "link": "https://stackoverflow.com/users/1155000/daniel-kamil-kozar"}, "edited": false, "score": 0, "creation_date": 1504653465, "post_id": 46064521, "comment_id": 79090009, "body": "@Daniel Kamil Kozar I only violate it when I create the string. after it is created, it should not be changed (hence the consts)"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 7, "creation_date": 1504653792, "post_id": 46064521, "comment_id": 79090074, "body": "Why not make the type opaque, so that users cannot delve inside the structure, and hence cannot modify it except using the access functions you provide.  When you add that many <code>const</code> qualifiers, you make the structure unmodifiable, with the dire consequences that you have to ask questions on SO.  What you&#39;re doing is not good; the fact that you&#39;re abusing casts to make it work is an indication that what you&#39;re doing is not good."}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 3, "creation_date": 1504653976, "post_id": 46064521, "comment_id": 79090113, "body": "You can initialize your struct with <code>struct string myString = { &quot;this is my string&quot;, strlen(&quot;this is my string&quot;) };</code> Then you won&#39;t be able to modify it, which is the whole point of <code>const</code>..."}, {"owner": {"reputation": 461, "user_id": 6033214, "user_type": "registered", "accept_rate": 79, "profile_image": "https://lh6.googleusercontent.com/-seiY7T8JbPU/AAAAAAAAAAI/AAAAAAAAEKs/9FN4GAM9HPo/photo.jpg?sz=128", "display_name": "Stefan B", "link": "https://stackoverflow.com/users/6033214/stefan-b"}, "reply_to_user": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1504654147, "post_id": 46064521, "comment_id": 79090147, "body": "@yano yes this did it thanks."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 15898, "user_id": 1155000, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b8213d9cd920e864ce8ff1fdeefe4db5?s=128&d=identicon&r=PG", "display_name": "Daniel Kamil Kozar", "link": "https://stackoverflow.com/users/1155000/daniel-kamil-kozar"}, "edited": false, "score": 0, "creation_date": 1504654194, "post_id": 46064521, "comment_id": 79090156, "body": "@DanielKamilKozar: Inside a function, an automatically allocated structure can be initialized with function calls.  Outside a function (file scope), or inside a function with <code>static</code> duration, you can&#39;t use a function call to initialize the variable.  You can&#39;t initialize dynamically allocated memory; you have to assign to it."}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "reply_to_user": {"reputation": 15898, "user_id": 1155000, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b8213d9cd920e864ce8ff1fdeefe4db5?s=128&d=identicon&r=PG", "display_name": "Daniel Kamil Kozar", "link": "https://stackoverflow.com/users/1155000/daniel-kamil-kozar"}, "edited": false, "score": 0, "creation_date": 1504654203, "post_id": 46064521, "comment_id": 79090159, "body": "@DanielKamilKozar That was meant to be more pseudo-code,, but it does compile and print correctly for me. I assume the compiler must be optimizing <code>strlen</code> into a constant. But since that field is meant to be a constant anyway, some kind of <code>#define</code> or magic number could work."}, {"owner": {"reputation": 15898, "user_id": 1155000, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b8213d9cd920e864ce8ff1fdeefe4db5?s=128&d=identicon&r=PG", "display_name": "Daniel Kamil Kozar", "link": "https://stackoverflow.com/users/1155000/daniel-kamil-kozar"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1504654338, "post_id": 46064521, "comment_id": 79090187, "body": "@JonathanLeffler : I was thinking about file scope, hence the comment, but then realised what you&#39;re saying and removed it before you had a chance to reply. Thanks!"}, {"owner": {"reputation": 15898, "user_id": 1155000, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b8213d9cd920e864ce8ff1fdeefe4db5?s=128&d=identicon&r=PG", "display_name": "Daniel Kamil Kozar", "link": "https://stackoverflow.com/users/1155000/daniel-kamil-kozar"}, "edited": false, "score": 0, "creation_date": 1504654408, "post_id": 46064521, "comment_id": 79090205, "body": "@StefanB : Have a look into opaque types per Jonathan&#39;s suggestion, which - I believe - are the actual solution to what you want to achieve. If just using initialisers this way works for you, then great, but be aware of the limitations that they have."}, {"owner": {"reputation": 27279, "user_id": 857132, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4fd51ed5980999c7c6ce3729d6cb2184?s=128&d=identicon&r=PG", "display_name": "John3136", "link": "https://stackoverflow.com/users/857132/john3136"}, "edited": false, "score": 5, "creation_date": 1504654455, "post_id": 46064521, "comment_id": 79090219, "body": "<code>*(int *) &amp;result.length = &#47;&#47; a int</code> That isn&#39;t a &quot;trick&quot; it is an abomination"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 3, "creation_date": 1504654467, "post_id": 46064521, "comment_id": 79090223, "body": "Given that <code>*(int *) &amp;result.length = 14;</code> &quot;works&quot;, so should <code>*(char **)&amp;result.data = &quot;Do not do this&quot;;</code>.  It is irredeemably nasty, but it should work."}, {"owner": {"reputation": 963, "user_id": 805796, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/351bc6b115265f0a9fbcb328c4532ced?s=128&d=identicon&r=PG", "display_name": "MCG", "link": "https://stackoverflow.com/users/805796/mcg"}, "reply_to_user": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1504657506, "post_id": 46064521, "comment_id": 79090836, "body": "@yano You can write an answer."}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "reply_to_user": {"reputation": 963, "user_id": 805796, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/351bc6b115265f0a9fbcb328c4532ced?s=128&d=identicon&r=PG", "display_name": "MCG", "link": "https://stackoverflow.com/users/805796/mcg"}, "edited": false, "score": 0, "creation_date": 1504674955, "post_id": 46064521, "comment_id": 79094910, "body": "@MCG well I was away for a few hours there and chux beat me to it. That&#39;s a better answer anyway, although I think the <i>real</i> answer here is to switch to <code>c++</code> and write a <code>std::string</code> class."}], "answers": [{"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": true, "score": 1, "last_activity_date": 1504669244, "last_edit_date": 1504669244, "creation_date": 1504668544, "answer_id": 46066330, "question_id": 46064521, "link": "https://stackoverflow.com/questions/46064521/write-to-double-const-pointer/46066330#46066330", "title": "Write to double const pointer", "body": "<p>Form the <code>struct string</code> at its declaration and <em>initialize</em> it.</p>\n\n<p>Also recommend to store the <em>size</em> and not the <em>length</em> and use <code>size_t</code>.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nstruct string {\n  const char * const data;\n  const size_t size;\n};\n\nstruct string string_copy(const char *src) {\n  size_t size = strlen(src) + 1;\n  char *copy = malloc(size);\n  if (copy) {\n    memcpy(copy, src, size);\n  } else {\n    size = 0;\n  }\n\n  struct string retval = {copy, size}; // ****\n  return retval;\n\n  // or return a compound literal (C99)\n  return (struct string){ copy, size};\n}\n\nvoid string_free(struct string s) {\n  free((void*)s.data);\n}\n\nint main(void) {\n  struct string a = string_copy(\"Hello\");\n  printf(\"%zu &lt;%s&gt;\\n\", a.size, a.data);\n  string_free(a); \n  // do not use `a` subsequently\n  return 0;\n}\n</code></pre>\n\n<p>I do not recommend to initialize with a <em>string literal</em> like <code>struct string retval = {\"World\", 6};</code> as that limits the usefulness of <code>struct string</code>.</p>\n\n<p>Using a opaque <code>struct</code> has many advantages <a href=\"https://stackoverflow.com/questions/46064521/write-to-double-const-pointer/46066330#comment79090074_46064521\">@Jonathan Leffler</a> that exceed this approach - mainly to keep other code from messing with the <code>struct string</code>.</p>\n"}], "owner": {"reputation": 461, "user_id": 6033214, "user_type": "registered", "accept_rate": 79, "profile_image": "https://lh6.googleusercontent.com/-seiY7T8JbPU/AAAAAAAAAAI/AAAAAAAAEKs/9FN4GAM9HPo/photo.jpg?sz=128", "display_name": "Stefan B", "link": "https://stackoverflow.com/users/6033214/stefan-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "accepted_answer_id": 46066330, "answer_count": 1, "score": 1, "last_activity_date": 1504684203, "creation_date": 1504652942, "last_edit_date": 1504684203, "question_id": 46064521, "link": "https://stackoverflow.com/questions/46064521/write-to-double-const-pointer", "title": "Write to double const pointer", "body": "<p>I want to implement my own string implementation for education. For that I defined a struct named string as follows:</p>\n\n<pre><code>struct string {\n    const char *const data;\n    const int length;\n};\n</code></pre>\n\n<p>I use functions to create these string structs and then I assign them to variables.</p>\n\n<p>In order to override the <code>const int length</code> I use the following trick:</p>\n\n<pre><code>*(int *) &amp;result.length = // a int\n</code></pre>\n\n<p>Now I also want to write to the <code>const char *const data</code>.\nAs far as I know the first <code>const</code> makes sure that you cant edit the items at which the pointer points, and the  second <code>const</code> is that you can't point the pointer to a different memory location. These are properties of an immutable string. So my question is: How can I assign something to the <code>const char *const data</code> like I did to the <code>const int length</code>?</p>\n\n<p>Edit: <code>result</code> as shown above is an instance of the struct <code>string</code></p>\n"}, {"tags": ["c", "pointers", "dll"], "answers": [{"comments": [{"owner": {"reputation": 8208, "user_id": 1971598, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/2dadb39a8fbedbdb2c473a162c251b2a?s=128&d=identicon&r=PG", "display_name": "Edgar Aroutiounian", "link": "https://stackoverflow.com/users/1971598/edgar-aroutiounian"}, "edited": false, "score": 0, "creation_date": 1504667802, "post_id": 46065129, "comment_id": 79093072, "body": "Hmm, doing this is giving me a seg fault."}, {"owner": {"reputation": 126, "user_id": 7364491, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-0ybqrtl9Tvo/AAAAAAAAAAI/AAAAAAAArm0/astpIRYiZLE/photo.jpg?sz=128", "display_name": "Joey Pabalinas", "link": "https://stackoverflow.com/users/7364491/joey-pabalinas"}, "reply_to_user": {"reputation": 8208, "user_id": 1971598, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/2dadb39a8fbedbdb2c473a162c251b2a?s=128&d=identicon&r=PG", "display_name": "Edgar Aroutiounian", "link": "https://stackoverflow.com/users/1971598/edgar-aroutiounian"}, "edited": false, "score": 0, "creation_date": 1504668189, "post_id": 46065129, "comment_id": 79093136, "body": "Are you 100% certain the function you are replacing provides all the same functionalities? You can&#39;t just replace a library  function with your own, and just because the signature matches expect it to be dandy."}, {"owner": {"reputation": 8208, "user_id": 1971598, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/2dadb39a8fbedbdb2c473a162c251b2a?s=128&d=identicon&r=PG", "display_name": "Edgar Aroutiounian", "link": "https://stackoverflow.com/users/1971598/edgar-aroutiounian"}, "edited": false, "score": 0, "creation_date": 1504668302, "post_id": 46065129, "comment_id": 79093158, "body": "The signature is correct, what could be wrong, where can I start to find clues or look. AFAIK Things are correct on my end."}, {"owner": {"reputation": 126, "user_id": 7364491, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-0ybqrtl9Tvo/AAAAAAAAAAI/AAAAAAAArm0/astpIRYiZLE/photo.jpg?sz=128", "display_name": "Joey Pabalinas", "link": "https://stackoverflow.com/users/7364491/joey-pabalinas"}, "reply_to_user": {"reputation": 8208, "user_id": 1971598, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/2dadb39a8fbedbdb2c473a162c251b2a?s=128&d=identicon&r=PG", "display_name": "Edgar Aroutiounian", "link": "https://stackoverflow.com/users/1971598/edgar-aroutiounian"}, "edited": false, "score": 0, "creation_date": 1504668329, "post_id": 46065129, "comment_id": 79093162, "body": "Ah apologies, I had forgotten a &amp;, so try with my edited code."}, {"owner": {"reputation": 8208, "user_id": 1971598, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/2dadb39a8fbedbdb2c473a162c251b2a?s=128&d=identicon&r=PG", "display_name": "Edgar Aroutiounian", "link": "https://stackoverflow.com/users/1971598/edgar-aroutiounian"}, "edited": false, "score": 0, "creation_date": 1504668579, "post_id": 46065129, "comment_id": 79093229, "body": "Unfortunately still a seg fault, I am doing this on Android so also looking for way to look up lldb to app on command line."}, {"owner": {"reputation": 126, "user_id": 7364491, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-0ybqrtl9Tvo/AAAAAAAAAAI/AAAAAAAArm0/astpIRYiZLE/photo.jpg?sz=128", "display_name": "Joey Pabalinas", "link": "https://stackoverflow.com/users/7364491/joey-pabalinas"}, "reply_to_user": {"reputation": 8208, "user_id": 1971598, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/2dadb39a8fbedbdb2c473a162c251b2a?s=128&d=identicon&r=PG", "display_name": "Edgar Aroutiounian", "link": "https://stackoverflow.com/users/1971598/edgar-aroutiounian"}, "edited": false, "score": 0, "creation_date": 1504668722, "post_id": 46065129, "comment_id": 79093266, "body": "Does assigning it directly work? If <code>(*G)-&gt;RegisterBaz = function</code> doesn&#39;t work, then this way won&#39;t either."}, {"owner": {"reputation": 8208, "user_id": 1971598, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/2dadb39a8fbedbdb2c473a162c251b2a?s=128&d=identicon&r=PG", "display_name": "Edgar Aroutiounian", "link": "https://stackoverflow.com/users/1971598/edgar-aroutiounian"}, "edited": false, "score": 0, "creation_date": 1504668943, "post_id": 46065129, "comment_id": 79093322, "body": "Doing that kind of direct assignment gives compiler error of &#39;read-only variable cannot be assigned&#39;"}, {"owner": {"reputation": 126, "user_id": 7364491, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-0ybqrtl9Tvo/AAAAAAAAAAI/AAAAAAAArm0/astpIRYiZLE/photo.jpg?sz=128", "display_name": "Joey Pabalinas", "link": "https://stackoverflow.com/users/7364491/joey-pabalinas"}, "reply_to_user": {"reputation": 8208, "user_id": 1971598, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/2dadb39a8fbedbdb2c473a162c251b2a?s=128&d=identicon&r=PG", "display_name": "Edgar Aroutiounian", "link": "https://stackoverflow.com/users/1971598/edgar-aroutiounian"}, "edited": false, "score": 0, "creation_date": 1504669038, "post_id": 46065129, "comment_id": 79093352, "body": "Seems I misunderstood what you had tried; if that is the case then <code>RegisterBaz</code> is a const function pointer and cannot be changed."}, {"owner": {"reputation": 8208, "user_id": 1971598, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/2dadb39a8fbedbdb2c473a162c251b2a?s=128&d=identicon&r=PG", "display_name": "Edgar Aroutiounian", "link": "https://stackoverflow.com/users/1971598/edgar-aroutiounian"}, "edited": false, "score": 0, "creation_date": 1504669085, "post_id": 46065129, "comment_id": 79093363, "body": "Isn&#39;t there a way to cast it away? Or force it like this indirect way?"}, {"owner": {"reputation": 126, "user_id": 7364491, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-0ybqrtl9Tvo/AAAAAAAAAAI/AAAAAAAArm0/astpIRYiZLE/photo.jpg?sz=128", "display_name": "Joey Pabalinas", "link": "https://stackoverflow.com/users/7364491/joey-pabalinas"}, "reply_to_user": {"reputation": 8208, "user_id": 1971598, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/2dadb39a8fbedbdb2c473a162c251b2a?s=128&d=identicon&r=PG", "display_name": "Edgar Aroutiounian", "link": "https://stackoverflow.com/users/1971598/edgar-aroutiounian"}, "edited": false, "score": 0, "creation_date": 1504669150, "post_id": 46065129, "comment_id": 79093384, "body": "You COULD try casting it if you really want to force this, though I can&#39;t guarantee what will happen with that. It may work or it may completely break everything."}, {"owner": {"reputation": 8208, "user_id": 1971598, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/2dadb39a8fbedbdb2c473a162c251b2a?s=128&d=identicon&r=PG", "display_name": "Edgar Aroutiounian", "link": "https://stackoverflow.com/users/1971598/edgar-aroutiounian"}, "edited": false, "score": 0, "creation_date": 1504669183, "post_id": 46065129, "comment_id": 79093395, "body": "But where would I put the cast, can you edit with that as &#39;experimental&#39; answer =P"}, {"owner": {"reputation": 8208, "user_id": 1971598, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/2dadb39a8fbedbdb2c473a162c251b2a?s=128&d=identicon&r=PG", "display_name": "Edgar Aroutiounian", "link": "https://stackoverflow.com/users/1971598/edgar-aroutiounian"}, "edited": false, "score": 0, "creation_date": 1504675979, "post_id": 46065129, "comment_id": 79095260, "body": "Its crashing because of &#39;SIGSEGV, address access protected&#39;"}], "tags": [], "owner": {"reputation": 126, "user_id": 7364491, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-0ybqrtl9Tvo/AAAAAAAAAAI/AAAAAAAArm0/astpIRYiZLE/photo.jpg?sz=128", "display_name": "Joey Pabalinas", "link": "https://stackoverflow.com/users/7364491/joey-pabalinas"}, "is_accepted": true, "score": 2, "last_activity_date": 1504669839, "last_edit_date": 1504669839, "creation_date": 1504658308, "answer_id": 46065129, "question_id": 46064468, "link": "https://stackoverflow.com/questions/46064468/overwriting-an-implementation-of-function-pointer-and-use-for-shared-library/46065129#46065129", "title": "Overwriting an implementation of function pointer and use for shared library", "body": "<p>So when you did the direct assignment, you were probably trying to assign a function to a const function pointer; this obviously is not something you can do.</p>\n\n<p>Also, in the code:</p>\n\n<pre><code>void *f_ptr = (*G)-&gt;RegisterBaz;\n*&amp;f_ptr = r_n;\n</code></pre>\n\n<p>in actuality, <code>f_ptr</code> is pointing to the same thing <code>(*G)-&gt;RegisterBaz</code> is pointing at, so when you change <code>f_ptr</code> with <code>*&amp;</code> (basically a no-op) you aren't modifying <code>(*G)-&gt;RegisterBaz</code> at all.</p>\n\n<p>In addition, you can't assign function pointers to object pointers; something of <code>void *</code> type is only guaranteed to be able to hold object pointers. <em>(INCITS-ISO-IEC 9899-2011 <a href=\"http://www.iso-9899.info/n1570.html#6.3.2.3p7\" rel=\"nofollow noreferrer\">6.3.2.3p7</a>)</em></p>\n\n<p>So if for whatever reason you are dead set on changing <code>(*G)-&gt;RegisterBaz</code> directly you can do something like:</p>\n\n<pre><code>void (**f_ptr)(void) = (void (**)(void))&amp;((*G)-&gt;RegisterBaz);\n*f_ptr = r_n;\n</code></pre>\n\n<p>BUT since you are going to be calling through <code>(*G)-&gt;RegisterBaz</code> you need to make sure the replacement function signature matches the function signature of what <code>(*G)-&gt;RegisterBaz</code> happens to be pointing at.</p>\n\n<p>You will also get a warning unless <code>f_ptr</code> is of type <strong>pointer to pointer to <code>\"insert signature of called function here\"</code></strong>.</p>\n\n<p>I need to reiterate this is NOT something you usually want to be doing, and so I can make no guarantees this will work. But if you are dead set on it this is how you would do it (basically you are aliasing the const function pointer to a non-const one.)</p>\n"}], "owner": {"reputation": 8208, "user_id": 1971598, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/2dadb39a8fbedbdb2c473a162c251b2a?s=128&d=identicon&r=PG", "display_name": "Edgar Aroutiounian", "link": "https://stackoverflow.com/users/1971598/edgar-aroutiounian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 353, "favorite_count": 0, "accepted_answer_id": 46065129, "answer_count": 1, "score": 1, "last_activity_date": 1504669839, "creation_date": 1504652568, "last_edit_date": 1504655290, "question_id": 46064468, "link": "https://stackoverflow.com/questions/46064468/overwriting-an-implementation-of-function-pointer-and-use-for-shared-library", "title": "Overwriting an implementation of function pointer and use for shared library", "body": "<p>This is a unique situation in <code>C</code>. </p>\n\n<p>Say we a library called <code>libfoo.so</code> and <code>libbar.so</code> and in both we the same function name, <code>Get_A</code>, assume <code>Get_A</code> is called by the system. </p>\n\n<p>Say <code>libbar</code> is loaded and then its <code>Get_A</code> is called with parameter <code>G</code>. <code>G</code> is a struct with some function pointers, with one of interest: </p>\n\n<p><code>(*G)-&gt;RegisterBaz</code></p>\n\n<p>So in <code>libbar</code>'s invocation of <code>Get_A</code>, we want to mutate the pointer to that RegisterBaz function and then call <code>libfoo</code>'s version of <code>Get_A</code> by means of dlopen + dlsym. </p>\n\n<p>One thing I tried was directly assigning but then I got a compiler error of that READ ONLY variables are unassignable, so I tried going through pointers:</p>\n\n<pre><code>// not void * but actually some function signature typedefed.\nvoid *f_ptr = (*G)-&gt;RegisterBaz;\n*&amp;f_ptr = r_n;\n</code></pre>\n\n<p>Where <code>r_n</code> is a plain C function with the same signature as <code>RegisterBaz</code></p>\n\n<p>and in <code>r_n</code> I call the original implementation of <code>RegisterBaz</code></p>\n\n<p>So while this doesn't seg fault, it doesn't end up calling my wrapped function either. </p>\n"}, {"tags": ["c", "sublimetext3", "sublimetext", "sublimetext-snippet"], "answers": [{"tags": [], "owner": {"reputation": 970, "user_id": 1734303, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/6ee80feb1a2c3ecd7c5f3e1ed8927419?s=128&d=identicon&r=PG", "display_name": "cowboydan", "link": "https://stackoverflow.com/users/1734303/cowboydan"}, "is_accepted": false, "score": 0, "last_activity_date": 1504834258, "creation_date": 1504834258, "answer_id": 46107319, "question_id": 46064363, "link": "https://stackoverflow.com/questions/46064363/sublime-text-c-plugin-code-templates-and-autocomplete/46107319#46107319", "title": "Sublime Text C plugin - code templates and autocomplete", "body": "<p>For the benefit of others, here's the workaround I ended up working with and the rationale</p>\n\n<ol>\n<li><p>For C sourcefile generation, I ended up using eclipse CDT as it comes with the feature pretty much out of the box under templates.</p></li>\n<li><p>For comment generation I also used eclipse CDT templates bound to hotkeys. It is somewhat limited (the auto-population of function name and parameters only gets picked up if the hotkey is triggered inside the scope of the function), but it works also pretty much out of the box. </p></li>\n</ol>\n"}], "owner": {"reputation": 970, "user_id": 1734303, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/6ee80feb1a2c3ecd7c5f3e1ed8927419?s=128&d=identicon&r=PG", "display_name": "cowboydan", "link": "https://stackoverflow.com/users/1734303/cowboydan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 348, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1504834258, "creation_date": 1504651808, "last_edit_date": 1504687465, "question_id": 46064363, "link": "https://stackoverflow.com/questions/46064363/sublime-text-c-plugin-code-templates-and-autocomplete", "title": "Sublime Text C plugin - code templates and autocomplete", "body": "<p>I'm looking for a plugin (or a way to create metadata for a plugin) that will allow me to do the following with Sublime Text 3 for the C programming language.</p>\n\n<ol>\n<li>Generate C source file from a template</li>\n<li>(Auto) generate C style function comments </li>\n</ol>\n\n<p>For the plugin I am looking for something that handles autocompletion with argument hints (similar to the hover-box hints in VS indicating what the parameter is. I am aware that this may require some bit of coupling to the documentation of the function in a function block.</p>\n"}, {"tags": ["c", "malloc"], "comments": [{"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "edited": false, "score": 0, "creation_date": 1504646637, "post_id": 46063525, "comment_id": 79087902, "body": "It&#39;s often better if the user of the function can control the allocation."}, {"owner": {"reputation": 681, "user_id": 4575505, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10204940618347955/picture?type=large", "display_name": "Thecave3", "link": "https://stackoverflow.com/users/4575505/thecave3"}, "edited": false, "score": 1, "creation_date": 1504647137, "post_id": 46063525, "comment_id": 79088105, "body": "The rule is simple: &quot;What you allocate, you must deallocate when it&#39;s not meant to be used anymore&quot;."}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 5, "creation_date": 1504647177, "post_id": 46063525, "comment_id": 79088118, "body": "I wouldn&#39;t consider it bad practice, but I prefer the caller to supply the callee with what it needs, if for no other reason than the symmetry of equal numbers of <code>malloc</code>s and <code>free</code>s in your code. <a href=\"https://linux.die.net/man/3/getline\" rel=\"nofollow noreferrer\"><code>getline</code></a> is another function that will happily allocate memory for you internally. Good documentation is the most important thing."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 5, "creation_date": 1504647386, "post_id": 46063525, "comment_id": 79088207, "body": "Either design works -- and both have their merits on occasion.  The most crucial thing is that the documentation tells people exactly what to do to free the memory returned, or provide a function that frees the memory.  For example, if you&#39;re building a tree structure, have the tree builder functions allocate the memory, but also have a function to release all the memory.  Given a choice, make it flexible -- let the user control the memory allocation. But it isn&#39;t always sensible (<code>strdup()</code> is fine; so is <code>fread()</code>, so is POSIX <code>getline()</code> -- they&#39;re different, but the documentation says so)."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1504647468, "post_id": 46063525, "comment_id": 79088249, "body": "Note that standard I/O <code>FILE *</code> typically does allocate memory for you; you don&#39;t have to worry about it, though, because the <code>fclose()</code> releases it.  It is a reason you should ensure you close what you open, though."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1504648911, "post_id": 46063525, "comment_id": 79088755, "body": "&quot;bad practice to <b>hide</b> memory allocations in functions?&quot; Yes. &quot;bad practice to <b>clearly code and document</b> memory allocations in functions?&quot; No."}], "answers": [{"tags": [], "owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "is_accepted": false, "score": 2, "last_activity_date": 1504647062, "creation_date": 1504647062, "answer_id": 46063642, "question_id": 46063525, "link": "https://stackoverflow.com/questions/46063525/is-it-bad-practice-to-hide-memory-allocations-in-functions/46063642#46063642", "title": "Is it bad practice to hide memory allocations in functions?", "body": "<p>C library functions refrain from returning allocated memory. That's at least part of the reason why strdup is not part of the standard library, along with a popular scanf extension for reading C strings of unlimited length.</p>\n\n<p>Your library could choose either way. Using pre-allocated buffers is more flexible, because it lets users pass you statically allocated buffers. This flexibility comes at a cost, because user's code becomes more verbose.</p>\n\n<p>If you choose to allocate memory for a custom struct dynamically, it is a good idea to make a matching function for deallocating the struct once it becomes unnecessary to the user.</p>\n"}, {"comments": [{"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 2, "creation_date": 1504648584, "post_id": 46063692, "comment_id": 79088648, "body": "That is a good point about libs.  It can be very confusing if the developer does not realize that the library is running a different instance of memory manager/heap:("}], "tags": [], "owner": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "is_accepted": true, "score": 5, "last_activity_date": 1504648604, "last_edit_date": 1504648604, "creation_date": 1504647308, "answer_id": 46063692, "question_id": 46063525, "link": "https://stackoverflow.com/questions/46063525/is-it-bad-practice-to-hide-memory-allocations-in-functions/46063692#46063692", "title": "Is it bad practice to hide memory allocations in functions?", "body": "<p>It depends - I've seen C APIs use all kind of patterns for this, such as:</p>\n\n<ul>\n<li>functions that require the buffer and buffer size to be provided, and return the required size (so that you can adjust the buffer size if it was truncated); many of these allow passing <code>NULL</code> as a buffer if you are just asking how big the buffer should be; this allows the caller to use an existing buffer or to allocate an appropriately sized one, although with two calls;</li>\n<li>separate functions to obtain needed size and to fill the buffer; same as above, but with a clearer interface;</li>\n<li>functions that require buffer and buffer size, but can allocate the buffer themselves if <code>NULL</code> is passed as buffer; maximum flexibility and terseness, but the function signature can get confusing;</li>\n<li>functions that just return a newly allocated string; simple to use and avoids bugs arising from unguarded truncation, but inflexible if performance is a concern; also, requires the caller to remember to free the returned value, which is avoided in the cases above if using a stack-allocated buffer;</li>\n<li>functions that return a pointer to a static buffer, and then the caller is responsible to do whatever with it; extremely easy to use, extremely easy to misuse; requires care in case of multithreading (needs thread local storage) and if reentrancy is a concern. </li>\n</ul>\n\n<p>The last one is generally a bad idea - it poses problems with reentrancy and thread safety; the one before it can be used but may pose efficiency problems - I generally don't want to waste time in allocations if I have already a buffer big enough. All the others are generally pretty much OK.</p>\n\n<p>But besides the specifics of the interface, the most important point if you allocate stuff and/or return pointers is to clearly document who owns the pointed memory - is it a static object in your library? Is it a pointer to some internal of an object provided by the caller? Is it dynamically allocated stuff? Is the caller responsible for freeing it? Is it just the buffer that was provided as argument?</p>\n\n<p>Most importantly, in case you allocated stuff, always specify how to deallocate it; notice that, if you are building a library that may be compiled as a dll/so, it's a good idea to provide your own deallocation function (even if it's just a wrapper around <code>free</code>) to avoid mismatches between different versions of the C runtime running in the same process. Also, it avoids tying your code to the C library allocator - today it may be fine, tomorrow it may turn out that using a custom allocator may be a better idea. </p>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 3, "last_activity_date": 1504650718, "last_edit_date": 1504650718, "creation_date": 1504650052, "answer_id": 46064109, "question_id": 46063525, "link": "https://stackoverflow.com/questions/46063525/is-it-bad-practice-to-hide-memory-allocations-in-functions/46064109#46064109", "title": "Is it bad practice to hide memory allocations in functions?", "body": "<blockquote>\n  <p>Is it bad practice to hide memory allocations in functions?</p>\n</blockquote>\n\n<p>Sometimes.</p>\n\n<p>An answer to show when code can be abused to detail one of the pitfalls of allowing a function total freedom in memory allocation.</p>\n\n<hr>\n\n<p>A classic case occurs when the function itself determines the size needed, so the calling code lacks the information needed to to provide the memory buffer beforehand.</p>\n\n<p>This is the case with <a href=\"http://man7.org/linux/man-pages/man3/getline.3.html\" rel=\"nofollow noreferrer\"><code>getline()</code></a> where the stream content throttles the size of the allocation.  The problem with this, especially when the stream is <code>stdin</code>, is that the control over memory allocation is given to external sources and not limited by the calling code - the program.  External input may overwhelm memory space - a hack.</p>\n\n<p>With a modified function, such as <code>ssize_t getline_limit(char **lineptr, size_t *n, FILE *stream, size_t limit);</code>, the function could still provide a right-size allocation, yet still prevent a hacker abuse.</p>\n\n<pre><code>#define LIMIT 1000000\nchar *line = NULL;\nsize_t len = 0;\nssize_t nread;\n\nwhile ((nread = getline_limit(&amp;line, &amp;len, stdin, LIMIT)) != -1) {\n</code></pre>\n\n<hr>\n\n<p>An example where this is not an issue would be an allocation with a well bounded use.</p>\n\n<pre><code>// Convert `double` to its decimal character representation allocating a right-size buffer\n// At worst a few thousand characters\nchar *double_to_string_exact_alloc(int x)\n</code></pre>\n\n<hr>\n\n<p>Functions that perform memory allocation need some level of control to prevent unlimited memory allocation either with a specific parameter or by nature of the task.</p>\n"}], "owner": {"reputation": 570, "user_id": 6327671, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/edaa078c07f64b105935a2dda9256486?s=128&d=identicon&r=PG&f=1", "display_name": "dav", "link": "https://stackoverflow.com/users/6327671/dav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 223, "favorite_count": 0, "accepted_answer_id": 46063692, "answer_count": 3, "score": 5, "last_activity_date": 1504650718, "creation_date": 1504646497, "question_id": 46063525, "link": "https://stackoverflow.com/questions/46063525/is-it-bad-practice-to-hide-memory-allocations-in-functions", "title": "Is it bad practice to hide memory allocations in functions?", "body": "<p>Should I expect the user to provide a memory chunk of sufficient size, say, for copying a file into a buffer? Or should I allocate the memory myself, and expect the user to free it when they're done? For example, the function <code>strdup()</code> allocates memory itself, but the function <code>fread()</code> expects only a buffer of sufficient size.</p>\n"}, {"tags": ["c", "sockets", "ubuntu", "network-programming", "udp"], "comments": [{"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 1, "creation_date": 1504642326, "post_id": 46062621, "comment_id": 79086026, "body": "By its very nature, UDP is unreliable.  Packets could be getting dropped from anywhere.  You have to sniff the network traffic, such as with Wireshark, to see if it is on the sending side, the receiving side, and anywhere in between. Possible duplicate of <a href=\"https://stackoverflow.com/questions/10899937/\">UDP packet drops by linux kernel</a>. Most likely, the receiver is simply not receiving packets as fast as the sender is sending them, so the receive buffer fills up and discards packets."}, {"owner": {"reputation": 1, "user_id": 2584888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1a94d7f35f90338586e6f2863dab352?s=128&d=identicon&r=PG", "display_name": "Adel", "link": "https://stackoverflow.com/users/2584888/adel"}, "reply_to_user": {"reputation": 39539, "user_id": 153430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a446e1fd338fb334fa68b3f7470cd65b?s=128&d=identicon&r=PG", "display_name": "Jim Lewis", "link": "https://stackoverflow.com/users/153430/jim-lewis"}, "edited": false, "score": 0, "creation_date": 1504716851, "post_id": 46062621, "comment_id": 79122766, "body": "@Jim the packets are received in receiver VM as the netstat output shows but the receiving buffer gets full before the application can consume it"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 2584888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1a94d7f35f90338586e6f2863dab352?s=128&d=identicon&r=PG", "display_name": "Adel", "link": "https://stackoverflow.com/users/2584888/adel"}, "edited": false, "score": 0, "creation_date": 1504716985, "post_id": 46062886, "comment_id": 79122840, "body": "I could improve the performance significantly by increasing the receiving buffer size by using setsockopt with SO_RCVBUF option and passing a larger value for size but there is still some bottleneck in the application. Thank you for your comment."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user8549610"}, "is_accepted": false, "score": 0, "last_activity_date": 1504643269, "creation_date": 1504643269, "answer_id": 46062886, "question_id": 46062621, "link": "https://stackoverflow.com/questions/46062621/how-to-understand-where-the-udp-packets-are-dropped-in-my-ubuntu-c-program/46062886#46062886", "title": "How to understand where the UDP packets are dropped in my ubuntu C program", "body": "<p>Well, if you think that you need to find out <em>where</em> some packets get dropped, this might not be useful since you already know that <em>at least</em> <code>RcvbufErrors</code> figure is growing. This means that the NIC is able to deliver the packets to the kernel but the latter is unable to deliver the packets to the application, obviously, because a fixed-size receive buffer gets full faster than the application could read the data out (or just flush it).</p>\n\n<p>So, I'd say such a result just gives an impression of poor application design. Perhaps, you should consider some good technique to enhance packet capture in your application so that more packets are captured/examined/dropped per second. A good example is <code>PACKET_MMAP</code> Rx ring which has an <a href=\"https://www.kernel.org/doc/Documentation/networking/packet_mmap.txt\" rel=\"nofollow noreferrer\">exhaustive description</a> and is widely used in <code>libpcap</code>-based applications. The latter aspect makes it indeed reasonable to use <code>wireshark</code> or just <code>tcpdump</code> instead of your hand-made app to inspect the real capture rate, etc.</p>\n"}], "owner": {"reputation": 1, "user_id": 2584888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1a94d7f35f90338586e6f2863dab352?s=128&d=identicon&r=PG", "display_name": "Adel", "link": "https://stackoverflow.com/users/2584888/adel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2653, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1504643269, "creation_date": 1504641973, "last_edit_date": 1504642131, "question_id": 46062621, "link": "https://stackoverflow.com/questions/46062621/how-to-understand-where-the-udp-packets-are-dropped-in-my-ubuntu-c-program", "title": "How to understand where the UDP packets are dropped in my ubuntu C program", "body": "<p>I am using a python tool to generate packets in one VM and I capture them in my program running as a linux process in another VM. Both the VMs are ubuntu and they are running on the same subnet. I notice that some of the packets get dropped in my program. What is the best tool to know where the packets are dropped?</p>\n\n<p>I see that RcvbufErrors in netstat output gets increased as I send new packets.</p>\n\n<pre><code># netstat -us\nIcmpMsg:\n    InType0: 14\n    InType3: 1493\n    InType5: 204\n    InType8: 54\n    InType13: 5\n    InType17: 5\n    OutType0: 54\n    OutType3: 645946\n    OutType8: 584\n    OutType14: 5\nUdp:\n    7686124 packets received\n    646545 packets to unknown port received.\n    33928069 packet receive errors\n    7157259 packets sent\n    RcvbufErrors: 33928069\n    IgnoredMulti: 345772\nUdpLite:\nIpExt:\n    InMcastPkts: 4\n    InBcastPkts: 363522\n    InOctets: 13243409806\n    OutOctets: 8445992434\n    InMcastOctets: 144\n    InBcastOctets: 114457552\n    InNoECTPkts: 100191590\n    InECT0Pkts: 143\n</code></pre>\n"}, {"tags": ["c", "function", "function-pointers"], "comments": [{"owner": {"reputation": 4073, "user_id": 152, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oXFHS.jpg?s=128&g=1", "display_name": "Jonesinator", "link": "https://stackoverflow.com/users/152/jonesinator"}, "edited": false, "score": 0, "creation_date": 1504640284, "post_id": 46062123, "comment_id": 79085002, "body": "In <code>C</code>, no. <code>C++</code> has the concept of lambdas that fit what you&#39;re trying to do."}, {"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "edited": false, "score": 0, "creation_date": 1504641091, "post_id": 46062123, "comment_id": 79085413, "body": "In C, you need to make it a named function (probably a <code>static</code> one, unless you intend to reuse it from other compilation units) ."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1504641328, "post_id": 46062123, "comment_id": 79085538, "body": "In C (as well as C++) you haved to declare a name before using it."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1504641418, "post_id": 46062123, "comment_id": 79085584, "body": "Short answer: C no, C++ yes."}, {"owner": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1504643378, "post_id": 46062123, "comment_id": 79086516, "body": "C# also supports this."}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 6036802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d255eaaf23cde02d9eba40e81cbb775?s=128&d=identicon&r=PG&f=1", "display_name": "I1265", "link": "https://stackoverflow.com/users/6036802/i1265"}, "edited": false, "score": 1, "creation_date": 1504701499, "post_id": 46062219, "comment_id": 79111808, "body": "Got it. Thank you!"}], "tags": [], "owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "is_accepted": true, "score": 4, "last_activity_date": 1504642015, "last_edit_date": 1504642015, "creation_date": 1504640345, "answer_id": 46062219, "question_id": 46062123, "link": "https://stackoverflow.com/questions/46062123/give-non-declared-function-to-function-pointer/46062219#46062219", "title": "Give non-declared function to function pointer", "body": "<p>What you describe are called <a href=\"https://en.wikipedia.org/wiki/Anonymous_function\" rel=\"nofollow noreferrer\">lambda functions</a>, a mechanism which is not available in C. You can think of lambda functions as anonymous functions.</p>\n\n<p>C++ and C# support that. Read more in .<a href=\"https://stackoverflow.com/questions/208835/function-pointers-closures-and-lambda\">Function pointers, Closures, and Lambda</a></p>\n"}], "owner": {"reputation": 51, "user_id": 6036802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d255eaaf23cde02d9eba40e81cbb775?s=128&d=identicon&r=PG&f=1", "display_name": "I1265", "link": "https://stackoverflow.com/users/6036802/i1265"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 46062219, "answer_count": 1, "score": 2, "last_activity_date": 1504642015, "creation_date": 1504639959, "last_edit_date": 1504641942, "question_id": 46062123, "link": "https://stackoverflow.com/questions/46062123/give-non-declared-function-to-function-pointer", "title": "Give non-declared function to function pointer", "body": "<p>I am trying to understand all this HUGE concept of function pointers...</p>\n\n<p>Is it possible to initalize function pointer with non-declared function?</p>\n\n<p>For example, a simple use of function pointer would be:</p>\n\n<pre><code>void f()\n{\n  printf(\"Hello world!\");\n}\n//Somewhere in the program\nvoid (*foo)();\nfoo = &amp;f;\n</code></pre>\n\n<p>Is there any way to skip the declaration of f? something like that:</p>\n\n<pre><code>void (*foo)();\nfoo = { printf(\"Hello world!\"); }\n</code></pre>\n"}, {"tags": ["c", "visual-studio", "pointers", "pointer-arithmetic"], "comments": [{"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 1, "creation_date": 1504638899, "post_id": 46061807, "comment_id": 79084259, "body": "There&#39;s not much to explain?  Dereferencing your bodged-a-lot pointer causes a memory-management hardware interrupt and so an error message."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1504639079, "post_id": 46061807, "comment_id": 79084341, "body": "Can&#39;t see any issue. Did you expect some other result? What, specifically?"}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 1, "creation_date": 1504639881, "post_id": 46061807, "comment_id": 79084769, "body": "Both are illegal access and therefore undefined, so it&#39;s not meaningful to ask why one &quot;worked&quot; and one didn&#39;t."}], "answers": [{"tags": [], "owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "is_accepted": false, "score": 3, "last_activity_date": 1504674239, "last_edit_date": 1504674239, "creation_date": 1504638883, "answer_id": 46061875, "question_id": 46061807, "link": "https://stackoverflow.com/questions/46061807/pointers-read-access-violation-when-trying-to-dereference-pointer-by-adding-a-l/46061875#46061875", "title": "Pointers: Read access violation when trying to dereference pointer by adding a large number", "body": "<p>Because this <code>*(arth + 1)</code> invokes <em>Undefined Behavior</em>!</p>\n\n<p>Undefined behavior is when a program can act unexpectedly. In your case, it <em>might</em> work in your first code snippet, and in the second. Or, it might do not work at all for both cases, today. Tomorrow it can. In your machine it might work, in mine's..maybe not! Read more about <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">UB</a>.</p>\n\n<p>You are accessing memory that your pointer shouldn't be accessing. </p>\n\n<p>When you add 1, you probably are (un)lucky and you access memory that your program <em>owns</em>, thus you get away with it from the police (the OS).</p>\n\n<p>When you are adding 1000, you go out of the program's <em>segment</em>, causing a segmentation fault, or an access violation (you name it!).</p>\n\n<p>Visualization:</p>\n\n<p><a href=\"https://i.stack.imgur.com/7yybR.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7yybR.png\" alt=\"pointers\"></a></p>\n\n<p>You act like <code>arch</code> is pointing to an array, and when <code>array[i]</code> is valid, <code>array[i + 1]</code> is valid too (assuming i + 1 is not greater or equal than the array's size).</p>\n\n<p>However, <code>arch</code> is just pointing <em>to one variable</em>, nothing more, nothing less!</p>\n\n<hr>\n\n<p>C allows you to do pointer arithmetics all day long, but you are responsible for the result of this. In your case, both increments are valid, in terms of syntax, etc., but invoke Undefined Behavior, which is a logical error (which results in an invalid runtime, one could say).</p>\n"}, {"comments": [{"owner": {"reputation": 25296, "user_id": 2975396, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/33a5374a3c2e22b8895b38f14ef9b845?s=128&d=identicon&r=PG&f=1", "display_name": "TheGameiswar", "link": "https://stackoverflow.com/users/2975396/thegameiswar"}, "edited": false, "score": 0, "creation_date": 1504639098, "post_id": 46061879, "comment_id": 79084358, "body": "<code>With undefined behavior, anything can happen. Your program may crash, it may output strange results, or it may appear to work properly.</code>Thanks i think i am getting what is undefined behaviour"}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 2, "last_activity_date": 1504638893, "creation_date": 1504638893, "answer_id": 46061879, "question_id": 46061807, "link": "https://stackoverflow.com/questions/46061807/pointers-read-access-violation-when-trying-to-dereference-pointer-by-adding-a-l/46061879#46061879", "title": "Pointers: Read access violation when trying to dereference pointer by adding a large number", "body": "<p><code>arth</code> is pointing to a single instance of an <code>int</code>.  Adding any non-zero value to <code>arth</code> and subsequently dereferencing that new pointer value reads a memory location outside the bounds of the original <code>int</code>.  This invokes <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">undefined behavior</a>.</p>\n\n<p>With undefined behavior, anything can happen.  Your program may crash, it may output strange results, or it may appear to work properly.  The fact that you didn't crash on the  <code>*(arth + 1))</code> case but did crash on the <code>*(arth + 1000))</code> is an example of that.  </p>\n\n<p>Just because the program didn't crash doesn't mean it didn't do something wrong.</p>\n"}, {"comments": [{"owner": {"reputation": 25296, "user_id": 2975396, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/33a5374a3c2e22b8895b38f14ef9b845?s=128&d=identicon&r=PG&f=1", "display_name": "TheGameiswar", "link": "https://stackoverflow.com/users/2975396/thegameiswar"}, "edited": false, "score": 0, "creation_date": 1504639614, "post_id": 46061969, "comment_id": 79084631, "body": "<code>so arth+1 is technically allowed</code> Thanks,i think even arth+1 is undefined,if i understood correctly"}, {"owner": {"reputation": 491, "user_id": 8509272, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/487ff5fe4697aeb326fa5092ef38f116?s=128&d=identicon&r=PG&f=1", "display_name": "savram", "link": "https://stackoverflow.com/users/8509272/savram"}, "reply_to_user": {"reputation": 25296, "user_id": 2975396, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/33a5374a3c2e22b8895b38f14ef9b845?s=128&d=identicon&r=PG&f=1", "display_name": "TheGameiswar", "link": "https://stackoverflow.com/users/2975396/thegameiswar"}, "edited": false, "score": 0, "creation_date": 1504640083, "post_id": 46061969, "comment_id": 79084885, "body": "Arth+1 is technically allowed, but you didn&#39;t allocate anything at arth+1 so trying to dereference it is still undefined behavior lol."}], "tags": [], "owner": {"reputation": 491, "user_id": 8509272, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/487ff5fe4697aeb326fa5092ef38f116?s=128&d=identicon&r=PG&f=1", "display_name": "savram", "link": "https://stackoverflow.com/users/8509272/savram"}, "is_accepted": false, "score": 1, "last_activity_date": 1504639573, "last_edit_date": 1504639573, "creation_date": 1504639276, "answer_id": 46061969, "question_id": 46061807, "link": "https://stackoverflow.com/questions/46061807/pointers-read-access-violation-when-trying-to-dereference-pointer-by-adding-a-l/46061969#46061969", "title": "Pointers: Read access violation when trying to dereference pointer by adding a large number", "body": "<p>Arth is pointing to an integer, but arth+1 is not pointing to anywhere you defined in your code, neither is arth+1000. </p>\n\n<p>C actually allows you to increment the pointer to one element past the memory allocation so arth+1 is technically allowed, but arth+1000 is not. The behavior for arth+1000 is undefined, so anything can happen. In your case, it was an error.</p>\n"}, {"comments": [{"owner": {"reputation": 25296, "user_id": 2975396, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/33a5374a3c2e22b8895b38f14ef9b845?s=128&d=identicon&r=PG&f=1", "display_name": "TheGameiswar", "link": "https://stackoverflow.com/users/2975396/thegameiswar"}, "edited": false, "score": 0, "creation_date": 1504640384, "post_id": 46062189, "comment_id": 79085063, "body": "I didn&#39;t initialize arth+1 as well,so in summary trying to deference some thing which is not initialized leads to UB"}], "tags": [], "owner": {"reputation": 114, "user_id": 8380523, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OPdzkHq2UI8/AAAAAAAAAAI/AAAAAAAACZw/VBFIFcvdiDA/photo.jpg?sz=128", "display_name": "Vivek Singh", "link": "https://stackoverflow.com/users/8380523/vivek-singh"}, "is_accepted": false, "score": 1, "last_activity_date": 1504640234, "creation_date": 1504640234, "answer_id": 46062189, "question_id": 46061807, "link": "https://stackoverflow.com/questions/46061807/pointers-read-access-violation-when-trying-to-dereference-pointer-by-adding-a-l/46062189#46062189", "title": "Pointers: Read access violation when trying to dereference pointer by adding a large number", "body": "<p>*(arth + 1000), is similar to arth[1000] and <em>(arth+1) is equal to arth[1].</em>(arth + 1000) for which you have not allocated or initialised any space in the memory, and hence the compiler will throw the undefined behavior and there is no such allocated data to that location.</p>\n"}, {"tags": [], "owner": {"reputation": 124, "user_id": 8283102, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd364df21977eb17d0d27b31851acbd8?s=128&d=identicon&r=PG&f=1", "display_name": "Rohit", "link": "https://stackoverflow.com/users/8283102/rohit"}, "is_accepted": false, "score": 0, "last_activity_date": 1504790159, "creation_date": 1504790159, "answer_id": 46097409, "question_id": 46061807, "link": "https://stackoverflow.com/questions/46061807/pointers-read-access-violation-when-trying-to-dereference-pointer-by-adding-a-l/46097409#46097409", "title": "Pointers: Read access violation when trying to dereference pointer by adding a large number", "body": "<p>Both are invalid whether it is  *(arth + 1) or (arth +1000) since you are accessing memory which is not allocated at all.It may work due to undefined behavior.Run with valgrind and check the valgrind log it will always report invalid read whether it *(arth +1) or *(arth +1000).Always run valgrind when any pointer related code you are adding . </p>\n"}], "owner": {"reputation": 25296, "user_id": 2975396, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/33a5374a3c2e22b8895b38f14ef9b845?s=128&d=identicon&r=PG&f=1", "display_name": "TheGameiswar", "link": "https://stackoverflow.com/users/2975396/thegameiswar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 652, "favorite_count": 1, "accepted_answer_id": 46061879, "answer_count": 5, "score": 3, "last_activity_date": 1504790159, "creation_date": 1504638622, "last_edit_date": 1504639637, "question_id": 46061807, "link": "https://stackoverflow.com/questions/46061807/pointers-read-access-violation-when-trying-to-dereference-pointer-by-adding-a-l", "title": "Pointers: Read access violation when trying to dereference pointer by adding a large number", "body": "<p>I am trying to explore pointers more,below is one sample piece of code i am trying  </p>\n\n<p><strong>This works:</strong>  </p>\n\n<pre><code>int *arth, art;\nart = 100;\narth = &amp;art;\nprintf(\"arth address is %p arth+1 value is %d\", arth, *(arth + 1));\n</code></pre>\n\n<p>now if i try to add a large number to arth,i get read access violation </p>\n\n<p><strong>This doesn't:</strong>  </p>\n\n<pre><code>printf(\"arth address is %p arth+1 value is %d\", arth, *(arth + 1000));\n</code></pre>\n\n<p><strong>Error:</strong>  </p>\n\n<blockquote>\n  <p>Exception thrown: read access violation.\n  <strong>arth</strong> was 0xC9C5EFF964. occurred</p>\n</blockquote>\n\n<p><strong>ASK:</strong><br>\ncan some one explain why this works when adding 1 and not when adding 1000</p>\n"}, {"tags": ["c", "linux", "x86"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1504635275, "post_id": 46060996, "comment_id": 79082391, "body": "&quot;\u2026 the entry point for the program will be the &quot; <code>main</code> function. Anything else is irrelevant for your C program. If you want to go deeper, this is not related to C, but solely to your platform. Using Linux, reading the source code of the crt and the loader and single-stepping a simple program. It is definitively far too broad to explain all this here."}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1504635524, "post_id": 46060996, "comment_id": 79082514, "body": "The pointer representing the array of arguments, and the argument count, are passed around. The arguments themselves got processed by the runtime."}, {"owner": {"reputation": 1582, "user_id": 3185943, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/TJBWJ.png?s=128&g=1", "display_name": "blackghost", "link": "https://stackoverflow.com/users/3185943/blackghost"}, "edited": false, "score": 0, "creation_date": 1504636052, "post_id": 46060996, "comment_id": 79082762, "body": "The shell interpreting the command line will parse the parameters and will populate the array of arguments.  It then passes the count and pointer to main through a compiler specific method (either puts them on the stack, or more likely populates registers with these values prior to invoking main)."}], "answers": [{"comments": [{"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1504819195, "post_id": 46061441, "comment_id": 79173519, "body": "x86-64 Linux is basically the same as i386 as far as stack layout on process entry.  argc and pointers are 64 bits wide, though.  The ABIs document the details.  <a href=\"https://github.com/hjl-tools/x86-psABI/wiki/X86-psABI\" rel=\"nofollow noreferrer\">github.com/hjl-tools/x86-psABI/wiki/X86-psABI</a>"}], "tags": [], "owner": {"reputation": 14659, "user_id": 2705055, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/b1d5dfaf239229501a184c8858fbc954?s=128&d=identicon&r=PG&f=1", "display_name": "Martin Rosenau", "link": "https://stackoverflow.com/users/2705055/martin-rosenau"}, "is_accepted": false, "score": 4, "last_activity_date": 1504636991, "creation_date": 1504636991, "answer_id": 46061441, "question_id": 46060996, "link": "https://stackoverflow.com/questions/46060996/will-the-command-line-arguments-be-passed-twice/46061441#46061441", "title": "Will the command line arguments be &quot;passed twice&quot;?", "body": "<blockquote>\n  <p>Am I correct?</p>\n</blockquote>\n\n<p>Yes and no:</p>\n\n<p>The <code>_start()</code> function is not a C function but an assembler function. The reason for this is that the CPU is not in a \"state\" which is required by C programs so the <code>_start()</code> function also has to set up the CPU for executing C code.</p>\n\n<p>One difference between the \"state\" required by C programs and the \"state\" of the CPU when <code>_start()</code> is called is the way arguments (here: command line arguments) are stored.</p>\n\n<p>Under Linux (at least 32 bit - I don't know about 64 bit) you actually have an array that later represents <code>argv</code>. <code>_start()</code> has to calculate the location of <code>argv</code> and then pass the calculated value to <code>main()</code>.</p>\n\n<p>Under Windows there is a function that returns the entire command line as pointer to a single string (<code>const char *</code>)! The <code>_start()</code> function has to call that function and then to split the string into parts that will later become <code>argv</code>...</p>\n"}], "owner": {"reputation": 1254, "user_id": 4566312, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/f792d4cf0473ff830ff5a857ec41bf83?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/4566312/tom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 157, "favorite_count": 0, "closed_date": 1504652166, "answer_count": 1, "score": 0, "last_activity_date": 1504636991, "creation_date": 1504635063, "question_id": 46060996, "link": "https://stackoverflow.com/questions/46060996/will-the-command-line-arguments-be-passed-twice", "closed_reason": "Duplicate", "title": "Will the command line arguments be &quot;passed twice&quot;?", "body": "<p>I am trying to understand how command line arguments work in details.</p>\n\n<p>This is what I think happens:</p>\n\n<ul>\n<li><p>When you compile a source code that contains the <code>main()</code> function in C, the generated object file will be linked with the CRT, and the entry point for the program will be the <code>_start()</code> function (which exists in the CRT), and <code>_start()</code> will call <code>main()</code>.</p></li>\n<li><p>Now when you run your program and pass it some command line arguments, the command line arguments will be passed to the <code>_start()</code> function, and then <code>_start()</code> will re-pass the command line arguments to <code>main()</code>.</p></li>\n</ul>\n\n<p>Am I correct?</p>\n"}, {"tags": ["objective-c", "c", "multithreading"], "comments": [{"owner": {"reputation": 83109, "user_id": 1312143, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d64f50f989e564c337a8a8bd653b8e6?s=128&d=identicon&r=PG", "display_name": "Ken Thomases", "link": "https://stackoverflow.com/users/1312143/ken-thomases"}, "edited": false, "score": 1, "creation_date": 1504633155, "post_id": 46060325, "comment_id": 79081456, "body": "You realize that you&#39;re using a block in the call to <code>dispatch_async()</code>, right? If you can use it there, why can&#39;t you use one for a completion handler? Anyway, much better than a loop around <code>sleep()</code> (which, as you note, has many problems) would be to use a proper thread synchronization mechanism, such as a semaphore. GCD provides those."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1504633207, "post_id": 46060325, "comment_id": 79081475, "body": "Sidenote: names starting with underscore at file-scope are reserved for the implementation. (Names starting with two underscores are reserved for all scopes)."}, {"owner": {"reputation": 2537, "user_id": 1720829, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/e2DBe.png?s=128&g=1", "display_name": "Nathan F.", "link": "https://stackoverflow.com/users/1720829/nathan-f"}, "reply_to_user": {"reputation": 83109, "user_id": 1312143, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d64f50f989e564c337a8a8bd653b8e6?s=128&d=identicon&r=PG", "display_name": "Ken Thomases", "link": "https://stackoverflow.com/users/1312143/ken-thomases"}, "edited": false, "score": 0, "creation_date": 1504633559, "post_id": 46060325, "comment_id": 79081636, "body": "@KenThomases I suppose I should clarify. This function is used by a lower level C library to retrieve data from my higher level implementation of the library. That being the case, I can&#39;t modify the signature of the function. The function must return an int and take no parameters, which means I&#39;m unable to pass a completion handler to it. However, the code that I need to retrieve the data for the library must be executed on the main thread."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1504635829, "post_id": 46060325, "comment_id": 79082654, "body": "Still not clear what you are trying, but it looks like an XY problem. A low-level library depending on a high-level library sounds quite fishy."}, {"owner": {"reputation": 2537, "user_id": 1720829, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/e2DBe.png?s=128&g=1", "display_name": "Nathan F.", "link": "https://stackoverflow.com/users/1720829/nathan-f"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1504636476, "post_id": 46060325, "comment_id": 79082979, "body": "@Olaf The low level library requires a configuration to be passed to it. Within this configuration is a function pointer that the library uses to retrieve specific information about the higher level environment. It needs the function to be of a specific signature in order to call it when necessary. I wouldn&#39;t say the low level library is depending on the high level implementation, it&#39;s only relying on it to provide information about the high level environment in order to decide how to perform specific tasks. In this case the information can only be retrieved on the main thread."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1504637464, "post_id": 46060325, "comment_id": 79083556, "body": "@NathanFiscaletti: That supports the suspection of a bad architecture -&gt; XY problem, indeed."}, {"owner": {"reputation": 62027, "user_id": 603977, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/myasv.jpg?s=128&g=1", "display_name": "jscs", "link": "https://stackoverflow.com/users/603977/jscs"}, "edited": false, "score": 0, "creation_date": 1504639419, "post_id": 46060325, "comment_id": 79084535, "body": "<i>&quot;bad architecture&quot;</i> Sounds like just another datasource relationship to me, no different than a table view."}, {"owner": {"reputation": 83109, "user_id": 1312143, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d64f50f989e564c337a8a8bd653b8e6?s=128&d=identicon&r=PG", "display_name": "Ken Thomases", "link": "https://stackoverflow.com/users/1312143/ken-thomases"}, "edited": false, "score": 0, "creation_date": 1504646065, "post_id": 46060325, "comment_id": 79087670, "body": "@NathanFiscaletti, you can put whatever code you want in the same block as your call to <code>compareStates()</code>. Such code can, for example, use GCD to dispatch a completion handler to a background thread. Or, if <code>check_need_transition()</code> really, really needs to be synchronous, it can signal a semaphore."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 62027, "user_id": 603977, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/myasv.jpg?s=128&g=1", "display_name": "jscs", "link": "https://stackoverflow.com/users/603977/jscs"}, "edited": false, "score": 0, "creation_date": 1504695409, "post_id": 46060325, "comment_id": 79107388, "body": "@JoshCaswell: Circular dependencies with a low-level lib depending on a high-level lib are just bad architecture. Nothing against a common library, though. That could be plain C, instantly eliminating all issues."}], "owner": {"reputation": 2537, "user_id": 1720829, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/e2DBe.png?s=128&g=1", "display_name": "Nathan F.", "link": "https://stackoverflow.com/users/1720829/nathan-f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1504644015, "creation_date": 1504632095, "last_edit_date": 1504644015, "question_id": 46060325, "link": "https://stackoverflow.com/questions/46060325/how-to-get-around-waiting-for-function-that-has-to-be-executed-on-another-thread", "title": "How to get around waiting for function that has to be executed on another thread in Objective-C?", "body": "<p>I have a function that has to be called on the main thread, however I'm operating on a different thread than the main thread. I'm working with <strong>C</strong> style functions in Objective-C, so <strong>unfortunately I can't rely on a completion handler.</strong></p>\n\n<p>This function is used by a lower level C library to retrieve data from my higher level implementation of the library. That being the case, I can't modify the signature of the function. The function must return an int and take no parameters, which means I'm unable to pass a completion handler to it. However, the code that I need to retrieve the data for the library must be executed on the main thread. </p>\n\n<p>Currently, I'm using the following code to work around this issue:</p>\n\n<pre><code>int check_need_transition() {\n\n    // Create the return value variable\n    __block int bool_val = -1;\n\n    // Execute the code that needs to be run on\n    // on the main thread.\n    dispatch_async(dispatch_get_main_queue(), ^{\n        bool_val = compareStates() ? 0 : 1; \n    });\n\n    // Wait for the main thread execution to complete\n    while (bool_val == -1)\n        sleep (0.1);\n\n    // Return the value\n    return bool_val;\n}\n</code></pre>\n\n<p>I recognize that this is no the best way to do this, as it leaves a lot of potential to bugs like infinite looping etc. So, what is the best way to go about doing this properly?</p>\n"}, {"tags": ["c", "pointers", "strncmp"], "comments": [{"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1504628881, "post_id": 46059528, "comment_id": 79079406, "body": "You might like the operator <code>||</code>, it wouls allow you to simplify your logic."}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 1, "creation_date": 1504628893, "post_id": 46059528, "comment_id": 79079414, "body": "for the first one you have to include the compiler error. For the second one you have to say what didnt work"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1504629046, "post_id": 46059528, "comment_id": 79079485, "body": "The first argument to <code>strncmp</code> must be <code>char *</code>. <code>((char *)data)[0]</code> is a <code>char</code>."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1504629300, "post_id": 46059528, "comment_id": 79079625, "body": "Why on <i>earth</i> are you using <code>strcmp</code>, which expects <i>both</i> the <code>src</code> and <code>dst</code> to be <i>nullchar terminated strings</i> ? Would it be easier to simply compare the first octet against <code>&#39;M&#39;</code>, and the second against <code>&#39;Z&#39;</code> ? And <code>read_file_from(file, ptr, 2, BEGINNING_OF_FILE, 0L);</code> may compile, but I cannot fathom how sending a null pointer by-value as the second argument is going to do <i>anything</i> helpful, and considering <code>char *buffer2 = (char*) ptr;</code> you&#39;re of the belief <code>ptr</code> will change in that <code>read_file_from</code> call; it won&#39;t, so that code is a recipe for null-pointer dereferencing."}, {"owner": {"reputation": 1284, "user_id": 6262757, "user_type": "registered", "accept_rate": 40, "profile_image": "https://graph.facebook.com/1134014206619252/picture?type=large", "display_name": "Nam Vu", "link": "https://stackoverflow.com/users/6262757/nam-vu"}, "edited": false, "score": 0, "creation_date": 1504630815, "post_id": 46059528, "comment_id": 79080339, "body": "I&#39;m new to c, could you show an example of what this code should look like to compare the first character to &quot;M&quot;?"}, {"owner": {"reputation": 144, "user_id": 2982586, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56dea6792e3195dcbaff4e46505f4dae?s=128&d=identicon&r=PG&f=1", "display_name": "Math Lover", "link": "https://stackoverflow.com/users/2982586/math-lover"}, "edited": false, "score": 0, "creation_date": 1504686793, "post_id": 46059528, "comment_id": 79101295, "body": "You can write <b><i>if(*data ==&#39;M&#39;)</i></b> to compare the first element of data to &#39;M&#39; character"}], "answers": [{"tags": [], "owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "is_accepted": false, "score": 1, "last_activity_date": 1504629034, "creation_date": 1504629034, "answer_id": 46059589, "question_id": 46059528, "link": "https://stackoverflow.com/questions/46059528/prevent-characters-from-being-written-out-in-file-in-c/46059589#46059589", "title": "Prevent characters from being written out in file in c", "body": "<p>its much clearer to do</p>\n\n<pre><code>if(buff[0] == 'M' &amp;&amp; buff[1] == 'Z')....\n</code></pre>\n\n<p>This is the idiomatic C way to do it. Since you dont give your actual problems it hard to give a better answer</p>\n"}], "owner": {"reputation": 1284, "user_id": 6262757, "user_type": "registered", "accept_rate": 40, "profile_image": "https://graph.facebook.com/1134014206619252/picture?type=large", "display_name": "Nam Vu", "link": "https://stackoverflow.com/users/6262757/nam-vu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 238, "favorite_count": 1, "answer_count": 1, "score": -1, "last_activity_date": 1504629034, "creation_date": 1504628710, "question_id": 46059528, "link": "https://stackoverflow.com/questions/46059528/prevent-characters-from-being-written-out-in-file-in-c", "title": "Prevent characters from being written out in file in c", "body": "<p>I'm trying to write a program in c to write out some strings, words, characters,etc... The gist of the program is to allow everything to be written, however the first two bytes of the program cannot contain the character \"MZ\". I'm new to c and pointers, here is what I've tried:</p>\n\n<p>Method 1: This gave me compiling errors....</p>\n\n<pre><code>    else if (offset == 0L){                                                                                                                \u2502  write_file_at(f, \"MZ\", 2, BEGINNING_OF_FILE, 0L);                                           \n                                                                                                                                           \u2502  fs_print_error();                                                                           \n            if(!strncmp(((char*)data)[0], \"M\", 1)){                                                                                        \u2502  printf(\"\\n\\n\");                                                                             \n                    if(offset == 1L &amp;&amp; !strncmp(((char*)data), \"Z\", 1)){                                                                   \u2502                                                                                              \n                            fserror = ILLEGAL_MZ;                                                                                          \u2502//  Printf(\"Test case 3, write Z first\\n\");                                                   \n                    }                                                                                                                      \u2502//  write_file_at(f, \"Z\", 1, BEGINNING_OF_FILE+1, 0L);                                        \n            }                                                                                                                              \u2502//  fs_print_error();                                                                         \n    }                                                                                                                                      \u2502//  write_file_at(f, \"M\", 1, BEGINNING_OF_FILE, 0L);                                          \n                                                                                                                                           \u2502//  fs_print_error();                                                                         \n    else if (offset == 1L){                                                                                                                \u2502                                                                                              \n                                                                                                                                           \u2502                                                                                              \n            if(!strncmp(((char*)data), \"Z\", 1)){                                                                                           \u2502                                                                                              \n                    if(offset == 0L &amp;&amp; !strncmp(((char*)data), \"M\", 1)){                                                                   \u2502  printf(\"Closing file...\\n\");                                                                \n                            fserror = ILLEGAL_MZ;                                                                                          \u2502  close_file(f);                                                                              \n                    }                                                                                                                      \u2502  fs_print_error();                                                                           \n            }                                                                                                                              \u2502  return 0;                                                                                   \n    } \n</code></pre>\n\n<p>Here is another thing I've tried with no luck(well at least it complied hahaha):</p>\n\n<pre><code> char *ptr = NULL;                                                                                                                      \u2502                                                                                                    char *buffer = (char*) data;                                                                                                           \n\n\n read_file_from(file, ptr, 2, BEGINNING_OF_FILE, 0L);                                                                                   \u2502  printf(\"Test case: mz is lower cased\\n\");                                                   \n char *buffer2 = (char*) ptr;//data already written in file                                                                             \u2502  write_file_at(f, \"mz\", 2, BEGINNING_OF_FILE, 0L);                                           \n                                                                                                                                           \u2502  fs_print_error();                                                                           \n                                                                                                                                           \u2502  printf(\"\\n\\n\");                                                                             \n  if(buffer2[0] == 'M'){                                                                                                                 \u2502                                                                                              \n          if(buffer[1] == 'Z'){                                                                                                          \u2502                                                                                              \n          fserror = ILLEGAL_MZ;                                                                                                          \u2502 Test Case                                                                                  \n          }                                                                                                                              \u2502  printf(\"Test case: write Z in the second byte first, then write M in the first byte\\n\");    \n  }                                                                                                                                      \u2502  write_file_at(f, \"Z\", 1, BEGINNING_OF_FILE, 1L);                                            \n  if(buffer2[0] == 'M'){                                                                                                                 \u2502  fs_print_error();                                                                           \n          if(buffer[1] == 'Z'){                                                                                                          \u2502  write_file_at(f, \"MZ\", 2, BEGINNING_OF_FILE, 0L);                                           \n          fserror = ILLEGAL_MZ;                                                                                                          \u2502  fs_print_error();                                                                           \n          }                                                                                                                              \u2502  printf(\"\\n\\n\");                                                                             \n  }       \n</code></pre>\n\n<p>*also noted here that the read_file_from is a method given by my professor, here is the parameters:</p>\n\n<p>unsigned long read_file_from(File file, void *data, unsigned long num_bytes,                                                                                                                                            SeekAnchor start, long offset) </p>\n\n<p>Any help would be greatly appreciated, thank you!!</p>\n\n<p>BTW, Linux users should never drink and root!</p>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 1325, "user_id": 8055063, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/fUn28.png?s=128&g=1", "display_name": "Bite Bytes", "link": "https://stackoverflow.com/users/8055063/bite-bytes"}, "edited": false, "score": 0, "creation_date": 1504628461, "post_id": 46059253, "comment_id": 79079185, "body": "why you using <code>typedef unsigned char   BOOLEAN;</code>, instead of <code>typedef int  BOOLEAN;</code>? <code>int</code> generally has better performance than the other types, because it&#39;s the natural word size of the machine, and therefore often the most performant."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 1325, "user_id": 8055063, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/fUn28.png?s=128&g=1", "display_name": "Bite Bytes", "link": "https://stackoverflow.com/users/8055063/bite-bytes"}, "edited": false, "score": 0, "creation_date": 1504633901, "post_id": 46059253, "comment_id": 79081794, "body": "@BiteBytes: And why not use the built-in boolean type? Homebrew macros/aliases should not be used if there are standard types/macros!"}, {"owner": {"reputation": 1325, "user_id": 8055063, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/fUn28.png?s=128&g=1", "display_name": "Bite Bytes", "link": "https://stackoverflow.com/users/8055063/bite-bytes"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1504638292, "post_id": 46059253, "comment_id": 79083987, "body": "@Olaf some people restrict there code to c89/90."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 1325, "user_id": 8055063, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/fUn28.png?s=128&g=1", "display_name": "Bite Bytes", "link": "https://stackoverflow.com/users/8055063/bite-bytes"}, "edited": false, "score": 0, "creation_date": 1504638856, "post_id": 46059253, "comment_id": 79084242, "body": "@BiteBytes: Those people should read the wiki-page of the C tag and eventually move to the 21st century."}, {"owner": {"reputation": 1325, "user_id": 8055063, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/fUn28.png?s=128&g=1", "display_name": "Bite Bytes", "link": "https://stackoverflow.com/users/8055063/bite-bytes"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1504639125, "post_id": 46059253, "comment_id": 79084372, "body": "@Olaf by 21th century you mean c11?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 1325, "user_id": 8055063, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/fUn28.png?s=128&g=1", "display_name": "Bite Bytes", "link": "https://stackoverflow.com/users/8055063/bite-bytes"}, "edited": false, "score": 0, "creation_date": 1504639228, "post_id": 46059253, "comment_id": 79084430, "body": "@BiteBytes: Optimally, yes. But for booleans and most common constructs C99, i.e. modern C would be sufficient. After all C11 mostly added features, but was not such a major change to C99 as C99 was to ancient C (and for VLAs it was a kotau to commerical compiler manufacturers who don&#39;t want to leave the 1980ies)."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1504640494, "post_id": 46059253, "comment_id": 79085118, "body": "The function as written does not make any sense. The ideomatic way is to return the pointer to the string, that way the function cannot fail. If you want to <i>copy</i> the string, you exactly have to do this, which you don&#39;t. If the <code>const char []</code> is just an example, you could return a malloc&#39;ed pointer, a null pointer on failure. which would be the ideomatic way."}], "answers": [{"comments": [{"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 3, "creation_date": 1504628814, "post_id": 46059368, "comment_id": 79079377, "body": "There is only one place where you actually can - array initialisation char x[]=&quot;asdfghj&quot;;"}], "tags": [], "owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "is_accepted": false, "score": 0, "last_activity_date": 1504627990, "creation_date": 1504627990, "answer_id": 46059368, "question_id": 46059253, "link": "https://stackoverflow.com/questions/46059253/returning-pointer-to-static-constant-string-via-function/46059368#46059368", "title": "Returning pointer to static constant string via function", "body": "<p>The function parameter <code>pu8Version</code> is the local <em>copy</em> of the pointer passed.</p>\n\n<p>You change <code>pu8Version</code> to point to the static string <code>MAL_Version</code> which prints correctly. On returning fom the function, the changed version of <code>pu8Version</code> is forgotten.</p>\n\n<p>The original <code>unsigned char buffer[10];</code> is <em>uninitialised</em> and remains so, so rubbish is printed.</p>\n\n<p>Note you cannot copy a C string with the <code>=</code> operator. What that does is to change the pointer, but not what it is pointing to. You should use <code>strcpy</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "is_accepted": true, "score": 5, "last_activity_date": 1504628090, "creation_date": 1504628090, "answer_id": 46059389, "question_id": 46059253, "link": "https://stackoverflow.com/questions/46059253/returning-pointer-to-static-constant-string-via-function/46059389#46059389", "title": "Returning pointer to static constant string via function", "body": "<p>This statement</p>\n\n<pre><code>pu8Version = &amp;MAL_Version[0];\n</code></pre>\n\n<p>only modifies the local pointer <code>pu8Version</code> in <code>GetVersion()</code> and that doesn't change <code>buffer</code> in <code>main()</code>.</p>\n\n<p>Instead of:</p>\n\n<pre><code>pu8Version = &amp;MAL_Version[0];\n</code></pre>\n\n<p>you can <em>copy</em> the <code>MAL_Version</code> to <code>buffer</code> with:</p>\n\n<pre><code>strcpy(pu8Version, MAL_Version);\n</code></pre>\n\n<p>If you really don't need a copy of <code>MAL_Version</code>, you can also return the pointer to <code>MAL_Version</code> directly. Something like:</p>\n\n<pre><code>/* Function to return Version string */\nconst char *GetVersion(void)\n{\n    return MAL_Version;\n}\n\nint main(void) {\n   const char *version = GetVersion();\n   printf(\"\\n%s\", version);\n}\n</code></pre>\n\n<hr>\n\n<p>Note that you don't define a \"BOOLEAN\" yourself. <code>bool</code> (from <code>&lt;stdbool.h&gt;</code> header) type is available in C since C99.</p>\n"}, {"comments": [{"owner": {"reputation": 3699, "user_id": 474173, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/18331a42eeb0683a21fe3af6722c04cc?s=128&d=identicon&r=PG", "display_name": "Swanand", "link": "https://stackoverflow.com/users/474173/swanand"}, "edited": false, "score": 0, "creation_date": 1504667285, "post_id": 46059603, "comment_id": 79092971, "body": "<code>buffer</code> is only one character, I want to return 10. I am already doing this and facing problem."}, {"owner": {"reputation": 1325, "user_id": 8055063, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/fUn28.png?s=128&g=1", "display_name": "Bite Bytes", "link": "https://stackoverflow.com/users/8055063/bite-bytes"}, "reply_to_user": {"reputation": 3699, "user_id": 474173, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/18331a42eeb0683a21fe3af6722c04cc?s=128&d=identicon&r=PG", "display_name": "Swanand", "link": "https://stackoverflow.com/users/474173/swanand"}, "edited": false, "score": 0, "creation_date": 1504699656, "post_id": 46059603, "comment_id": 79110343, "body": "@Swanand I forgot the <code>*</code> before <code>buffer</code>."}, {"owner": {"reputation": 1325, "user_id": 8055063, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/fUn28.png?s=128&g=1", "display_name": "Bite Bytes", "link": "https://stackoverflow.com/users/8055063/bite-bytes"}, "reply_to_user": {"reputation": 3699, "user_id": 474173, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/18331a42eeb0683a21fe3af6722c04cc?s=128&d=identicon&r=PG", "display_name": "Swanand", "link": "https://stackoverflow.com/users/474173/swanand"}, "edited": false, "score": 0, "creation_date": 1504700216, "post_id": 46059603, "comment_id": 79110786, "body": "@Swanand And to avoid the warning complaining about discarding the <code>const</code> qualifier, try to declare <code>*buffer</code> and <code>**pu8Version</code> as constants too."}], "tags": [], "owner": {"reputation": 1325, "user_id": 8055063, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/fUn28.png?s=128&g=1", "display_name": "Bite Bytes", "link": "https://stackoverflow.com/users/8055063/bite-bytes"}, "is_accepted": false, "score": 0, "last_activity_date": 1504699613, "last_edit_date": 1504699613, "creation_date": 1504629096, "answer_id": 46059603, "question_id": 46059253, "link": "https://stackoverflow.com/questions/46059253/returning-pointer-to-static-constant-string-via-function/46059603#46059603", "title": "Returning pointer to static constant string via function", "body": "<p>Or you can pass a pointer to a pointer:</p>\n\n<pre><code>/* Function to return Version string */\nBOOLEAN GetVersion ( unsigned char **pu8Version )\n{\n    BOOLEAN success = FALSE;\n\n    if(*pu8Version != NULL)\n    {\n        *pu8Version = MAL_Version;\n        success = TRUE;\n        printf(\"\\r\\nTRUE\");\n        printf(\"\\r\\n%s\", *pu8Version);\n    }\n\n    return success;\n}\n\nint main() {\n   unsigned char *buffer;\n\n   GetVersion(&amp;buffer);\n   printf(\"\\r\\n%s\", buffer);\n}\n</code></pre>\n"}], "owner": {"reputation": 3699, "user_id": 474173, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/18331a42eeb0683a21fe3af6722c04cc?s=128&d=identicon&r=PG", "display_name": "Swanand", "link": "https://stackoverflow.com/users/474173/swanand"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 326, "favorite_count": 0, "accepted_answer_id": 46059389, "answer_count": 3, "score": 1, "last_activity_date": 1504699613, "creation_date": 1504627510, "question_id": 46059253, "link": "https://stackoverflow.com/questions/46059253/returning-pointer-to-static-constant-string-via-function", "title": "Returning pointer to static constant string via function", "body": "<p>I have a file which has a static constant string and a function which will return pointer to that string.\nFile looks like this:</p>\n\n<pre><code>typedef unsigned char   BOOLEAN;\n\n#define TRUE    1\n#define FALSE   0\n\n\nstatic const unsigned char MAL_Version[8] = \"2.001\";\n\n/* Function to return Version string */\nBOOLEAN GetVersion ( unsigned char* pu8Version )\n{\n    BOOLEAN success = FALSE;\n\n    if(pu8Version != NULL)\n    {\n        pu8Version = &amp;MAL_Version[0];\n        success = TRUE;\n        printf(\"\\r\\nTRUE\");\n        printf(\"\\r\\n%s\", pu8Version);\n    }\n\n    return success;\n}\n</code></pre>\n\n<p>and in main(), I declare an array and pass it's address to GetVersion function.\nWhen I do this, I am getting random characters.</p>\n\n<pre><code>int main() {\n   unsigned char buffer[10];\n\n   GetVersion(buffer);\n   printf(\"\\r\\n%s\", buffer);\n}\n</code></pre>\n\n<p>Output is:</p>\n\n<p>TRUE</p>\n\n<p>2.001</p>\n\n<p>D\ufffd3\ufffd</p>\n\n<p>What I am missing? The pointer in function is correctly printing the string, but when it returns, it prints garbage.</p>\n"}, {"tags": ["c", "pointers", "multidimensional-array", "memory-management", "struct"], "comments": [{"owner": {"reputation": 115745, "user_id": 119527, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lTjBL.png?s=128&g=1", "display_name": "Jonathon Reinhart", "link": "https://stackoverflow.com/users/119527/jonathon-reinhart"}, "edited": false, "score": 0, "creation_date": 1504627197, "post_id": 46059131, "comment_id": 79078485, "body": "After <a href=\"http://man7.org/linux/man-pages/man3/malloc.3.html\" rel=\"nofollow noreferrer\">reading the documentation</a>, what exactly don&#39;t you understand?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1504627443, "post_id": 46059131, "comment_id": 79078642, "body": "Any C textbook or tutorial should explain how to use <code>malloc</code> and <code>realloc</code> to implement a dynamic array. It&#39;s no different when the pointer is in a <code>struct</code>."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1504628083, "post_id": 46059131, "comment_id": 79079023, "body": "In <code>struct Base</code> you will want to add an item <code>int n_dataItems</code> to keep track of how many items there are in your array."}, {"owner": {"reputation": 123, "user_id": 5601732, "user_type": "registered", "accept_rate": 27, "profile_image": "https://lh6.googleusercontent.com/-TiNzHzxbVdQ/AAAAAAAAAAI/AAAAAAAAABE/9GwNCtv0iOU/photo.jpg?sz=128", "display_name": "stellarhawk 34", "link": "https://stackoverflow.com/users/5601732/stellarhawk-34"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1504628721, "post_id": 46059131, "comment_id": 79079334, "body": "@PaulOgilvie Where and how do I declare the detail_t array however, in order to link it to the &quot;data&quot; pointer of the base structure."}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1504631247, "post_id": 46059131, "comment_id": 79080540, "body": "Perhaps consider <a href=\"https://en.wikipedia.org/wiki/Flexible_array_member\" rel=\"nofollow noreferrer\">flexible array members</a>"}, {"owner": {"reputation": 144, "user_id": 2982586, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56dea6792e3195dcbaff4e46505f4dae?s=128&d=identicon&r=PG&f=1", "display_name": "Math Lover", "link": "https://stackoverflow.com/users/2982586/math-lover"}, "edited": false, "score": 0, "creation_date": 1504632717, "post_id": 46059131, "comment_id": 79081255, "body": "you should define in struct Base_t the pointer to Detail_t array as:"}], "answers": [{"comments": [{"owner": {"reputation": 123, "user_id": 5601732, "user_type": "registered", "accept_rate": 27, "profile_image": "https://lh6.googleusercontent.com/-TiNzHzxbVdQ/AAAAAAAAAAI/AAAAAAAAABE/9GwNCtv0iOU/photo.jpg?sz=128", "display_name": "stellarhawk 34", "link": "https://stackoverflow.com/users/5601732/stellarhawk-34"}, "edited": false, "score": 0, "creation_date": 1504630103, "post_id": 46059707, "comment_id": 79080006, "body": "Thanks for that, but could you maybe also quickly explain why this works? By incrementing &quot;t&quot; in that loop, what exactly is going on. Are you just looking at the next struct in the array?"}, {"owner": {"reputation": 123, "user_id": 5601732, "user_type": "registered", "accept_rate": 27, "profile_image": "https://lh6.googleusercontent.com/-TiNzHzxbVdQ/AAAAAAAAAAI/AAAAAAAAABE/9GwNCtv0iOU/photo.jpg?sz=128", "display_name": "stellarhawk 34", "link": "https://stackoverflow.com/users/5601732/stellarhawk-34"}, "edited": false, "score": 0, "creation_date": 1504630219, "post_id": 46059707, "comment_id": 79080052, "body": "And in my code, I would not actually know what the &quot;4&quot; (for loop&#39;s upper limit) will actually be. It will be dependent on the amount of BT devices that it detects. Would I need to rerun this for loop from 0 to n in main, every time that I detect a BT device, or just from previous n to current n. Thank you"}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1504631090, "post_id": 46059707, "comment_id": 79080472, "body": "the <code>++t.n_dataItems</code>  increments n_dataItems, Its just counting the added items."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1504643077, "post_id": 46059707, "comment_id": 79086373, "body": "Stellarhawk, you REALLY need to read a book on C if you don&#39;t understand these simple constructs and can&#39;t extend a for loop to a while loop. And read a book on programming in general. I hope you will not write production code."}], "tags": [], "owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "is_accepted": false, "score": 0, "last_activity_date": 1504629508, "creation_date": 1504629508, "answer_id": 46059707, "question_id": 46059131, "link": "https://stackoverflow.com/questions/46059131/pointer-within-struct-to-dynamic-array-of-structures-c/46059707#46059707", "title": "Pointer within struct to dynamic array of structures C", "body": "<p>Example:</p>\n\n<pre><code>typedef struct Base {\n   uuid_array unique_id;\n   int n_dataIems;\n   Detail_t *data;\n} Base_t;\n\nvoid example(void)\n{\n    Base_t t;\n    int i;\n    t.n_dataItems= 0;\n    t.data= 0;\n    for (i=0; i&lt;4; i++)\n    {\n        t.data= realloc(t.data, ++t.n_dataItems * sizeof(Detail_t));\n        t.data[i].power= i;\n    }\n}\n</code></pre>\n\n<p>(Error checking ommitted.)</p>\n\n<p>Note: definition of Detail must be before Base.</p>\n"}, {"tags": [], "owner": {"reputation": 491, "user_id": 8509272, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/487ff5fe4697aeb326fa5092ef38f116?s=128&d=identicon&r=PG&f=1", "display_name": "savram", "link": "https://stackoverflow.com/users/8509272/savram"}, "is_accepted": false, "score": 1, "last_activity_date": 1504631118, "last_edit_date": 1504631118, "creation_date": 1504630657, "answer_id": 46059989, "question_id": 46059131, "link": "https://stackoverflow.com/questions/46059131/pointer-within-struct-to-dynamic-array-of-structures-c/46059989#46059989", "title": "Pointer within struct to dynamic array of structures C", "body": "<p>Here's a short code to showcase how you could go about it:</p>\n\n<pre><code>#include &lt;stdint.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n\ntypedef struct {\n   uint8_t  uuid[16];\n} uuid_array;\n\ntypedef struct Detail {\n   int8_t power;\n   uint32_t t1;\n   uint32_t dT;\n} Detail_t;\n\ntypedef struct Base {\n   uuid_array unique_id;\n   Detail_t *data;\n} Base_t;\n\n\nint main() {\n  Detail_t data;\n  data.power = data.t1 = data.dT = 1;\n  Detail_t data2;\n  data2.power = data2.t1 = data2.dT = 2;\n  Base_t bases[10];//array of Base_t\n  int size = 1;//initial size of Detail_t array\n  bases[0].data = NULL;\n  bases[0].data = (Detail_t* )realloc(bases[0].data, size * sizeof(Detail_t));//first realloc acts as a malloc because bases[0].data is NULL at first\n  if (bases[0].data != NULL) {//if malloc(realloc) was successful\n    bases[0].data[0] = data;//store data\n  }\n  size = 2;//increase size of Detail_t array by 1\n  bases[0].data = (Detail_t* )realloc(bases[0].data, size * sizeof(Detail_t));//realloc new size\n  if (bases[0].data != NULL) {//if it didn't fail\n    bases[0].data[1] = data2;//store new data\n  }\n  printf(\"%d\\n\", bases[0].data[0].power);//print first data power\n  printf(\"%d\", bases[0].data[1].power);//print second data power\n  free(bases[0].data);//free memory\n}\n</code></pre>\n\n<p>Does this help? I guess the part that confuses beginners is the cast. Malloc and realloc returns a pointer of type void* to the memory allocated , which you then can cast to the type you're working with.</p>\n"}, {"tags": [], "owner": {"reputation": 5773, "user_id": 3525545, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Rge03.jpg?s=128&g=1", "display_name": "Mahonri Moriancumer", "link": "https://stackoverflow.com/users/3525545/mahonri-moriancumer"}, "is_accepted": true, "score": 1, "last_activity_date": 1504636403, "last_edit_date": 1504636403, "creation_date": 1504635031, "answer_id": 46060988, "question_id": 46059131, "link": "https://stackoverflow.com/questions/46059131/pointer-within-struct-to-dynamic-array-of-structures-c/46060988#46060988", "title": "Pointer within struct to dynamic array of structures C", "body": "<p>Here is another way...</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdint.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;string.h&gt;\n\ntypedef struct\n   {\n   uint8_t  uuid[16];\n   } uuid_array;\n\ntypedef struct Detail\n   {\n   int8_t   power;\n   uint32_t t1;\n   uint32_t dT;\n   } Detail_t;\n\ntypedef struct Base\n   {\n   uuid_array  unique_id;\n   Detail_t   *data;\n   uint32_t    dataItemCnt;  /* In struct Base you will want to add an item int **\n                           ** n_dataItems to keep track of how many items     **\n                           ** there are in your array. \u2013 Paul Ogilvie         */\n   } Base_t;\n\n#define SUCCESS 0\n\n/**********************************************************\n** Append a Detail_t structure to the data field of the to Base_t structure..\n*/\nint AppendData(Base_t *baseT, int8_t power, uint32_t t1, uint32_t dT)\n   {\n   int rCode = SUCCESS;\n   Detail_t *data=NULL;\n\n   /* Verify that the caller did not pass NULL as the Base_t structure address. */\n   if(!baseT)\n      {\n      rCode=EINVAL;     /* Invalid Base_t value argument. */\n      goto CLEANUP;\n      }\n\n  /* Increase the size of the baseT-&gt;data array sufficient for an additional Detail_t structure. */\n   errno=SUCCESS;\n   data=realloc(baseT-&gt;data, (baseT-&gt;dataItemCnt + 1) * sizeof(Detail_t));\n   if(!data)  /* Verify that the realloc() succeeded. */\n      {\n      rCode=errno;\n      goto CLEANUP;\n      }\n\n   /* Cause the Base_t data array to point to the newly (re-alloced) memory. */\n   baseT-&gt;data = data; \n\n   /* Initialize the new Detail_t structure values. */\n   baseT-&gt;data[baseT-&gt;dataItemCnt].power = power;\n   baseT-&gt;data[baseT-&gt;dataItemCnt].t1    = t1;\n   baseT-&gt;data[baseT-&gt;dataItemCnt].dT    = dT;\n\n   /* Increment Base_t-&gt;dataItemCnt to reflect the appended Detail_t structure. */\n   ++baseT-&gt;dataItemCnt;\n\nCLEANUP:\n\n   return(rCode);\n   }\n\n/**********************************************************\n** Free a previously allocated Base_t type.\n*/\nint FreeBaseT(Base_t **baseT)\n   {\n   int rCode = SUCCESS;\n\n   /* Verify that the caller did not pass in NULL for baseT */\n   if(!baseT)\n      {\n      rCode=EINVAL;     /* Invalid Base_t value argument. */\n      goto CLEANUP;\n      }\n\n   /* verify that the the Base_t structure is not already free. */\n   if(!*baseT)\n      {\n      rCode=EALREADY;   /* The Base_t structure is NULL  (Already free). */\n      goto CLEANUP;\n      }\n\n   /* If there are Detail_t structures in the data array, free the data array. */\n   if((*baseT)-&gt;data)\n      free((*baseT)-&gt;data);\n\n   /* Free the memory previously allocated to the Base_t structure. */\n   free(*baseT);\n   *baseT = NULL;   /* Eliminate the caller's reference to the freed memory. */\n\nCLEANUP:\n\n   return(rCode);\n   }\n\n/**********************************************************\n** Allocate a Base_t type.\n*/\nint AllocBaseT(Base_t **baseT_OUT, uint8_t uuid[16])\n   {\n   int     rCode = SUCCESS;\n   Base_t *baseT = NULL;\n\n   /* Allocate memory to the Base_t structure. */\n   errno=SUCCESS;\n   baseT = malloc(sizeof(Base_t));\n   if(!baseT)\n      {\n      rCode=errno;\n      goto CLEANUP;\n      }\n\n   /* Initialize the initial values of the Base_t structure. */\n   memset(baseT, 0, sizeof(Base_t));\n   memcpy(&amp;baseT-&gt;unique_id.uuid, uuid, 16);\n\n   /* Ensure that the caller passed a non-NULL address,\n      if so, return the address of the allocated Base_t structure. */\n   if(baseT_OUT)\n      {\n      *baseT_OUT = baseT;\n      baseT = NULL;\n      }\n\nCLEANUP:\n\n   /* If the caller passed-in a NULL for baseT_OUT,\n      free the allocated memory to that the program does not cause a leak. */\n   if(baseT)\n      {\n      int rc=FreeBaseT(&amp;baseT);\n      if(rc &amp;&amp; !rCode)\n         rCode=rc;\n      }\n\n   return(rCode);\n   }\n\n/**********************************************************\n** Dump a base_t structure.\n*/\nint DumpBaseT(Base_t *baseT)\n   {\n   int      rCode   = SUCCESS;\n   uint32_t index;\n\n   if(!baseT)\n      {\n      rCode=EINVAL;     /* Invalid Base_t value argument. */\n      goto CLEANUP;\n      }\n\n   /* Print the Base_t-&gt;unique_array-&gt;uuid */\n   printf(\"UUID: %02X %02X %02X %02X %02X %02X %02X %02X %02X %02X %02X %02X %02X %02X %02X %02X\\n\",\n      baseT-&gt;unique_id.uuid[0],\n      baseT-&gt;unique_id.uuid[1],\n      baseT-&gt;unique_id.uuid[2],\n      baseT-&gt;unique_id.uuid[3],\n      baseT-&gt;unique_id.uuid[4],\n      baseT-&gt;unique_id.uuid[5],\n      baseT-&gt;unique_id.uuid[6],\n      baseT-&gt;unique_id.uuid[7],\n      baseT-&gt;unique_id.uuid[8],\n      baseT-&gt;unique_id.uuid[9],\n      baseT-&gt;unique_id.uuid[10],\n      baseT-&gt;unique_id.uuid[11],\n      baseT-&gt;unique_id.uuid[12],\n      baseT-&gt;unique_id.uuid[13],\n      baseT-&gt;unique_id.uuid[14],\n      baseT-&gt;unique_id.uuid[15]\n      );\n\n   /* Print the Base_t-&gt;Detail_t values */   \n   printf(\"Number of data items: %u\\n\",  baseT-&gt;dataItemCnt);\n   for(index=0; index &lt; baseT-&gt;dataItemCnt; ++index)\n      {\n      printf(\"   data[%d] power=%d t1=%d dT=%d\\n\",\n         index,\n         baseT-&gt;data[index].power,\n         baseT-&gt;data[index].t1,\n         baseT-&gt;data[index].dT\n         );\n      }\n\nCLEANUP:\n\n   return(rCode);\n   }\n\n/**********************************************************\n** Program start.\n*/\nint main(int argC, char *argV[])\n   {\n   int     rCode   = SUCCESS;\n   Base_t *baset_A = NULL;\n   uint8_t  uuid[16] =\n      {\n      0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08,\n      0x09, 0x0A, 0x0B, 0x0C, 0x0D, 0x0E, 0x0F, 0x10\n      };\n\n   /* Allocate memory for a Base_t structure (with no attached data) */\n   rCode=AllocBaseT(&amp;baset_A, uuid);\n   if(rCode)\n      {\n      fprintf(stderr, \"AllocBaseT() reports: %d %s\\n\", rCode, strerror(rCode));\n      goto CLEANUP;\n      }\n\n   /* Allocate some data (Detail_t) to the Base_t structure. */\n   rCode=AppendData(baset_A, 1, 1000, 1111);\n   if(rCode)\n      {\n      fprintf(stderr, \"AppendData() reports: %d %s\\n\", rCode, strerror(rCode));\n      goto CLEANUP;\n      }\n\n   rCode=AppendData(baset_A, 2, 2000, 2222);\n   if(rCode)\n      {\n      fprintf(stderr, \"AppendData() reports: %d %s\\n\", rCode, strerror(rCode));\n      goto CLEANUP;\n      }\n\n   rCode=AppendData(baset_A, 3, 3000, 3333);\n   if(rCode)\n      {\n      fprintf(stderr, \"AppendData() reports: %d %s\\n\", rCode, strerror(rCode));\n      goto CLEANUP;\n      }\n\n   /* Print out the Base_t structure. */\n   rCode=DumpBaseT(baset_A);\n   if(rCode)\n      {\n      fprintf(stderr, \"DumpBaseT() reports: %d %s\\n\", rCode, strerror(rCode));\n      goto CLEANUP;\n      }\n\nCLEANUP:\n\n   /* Free the memory allocated to the Base_t structure. */ \n   if(baset_A)\n      {\n      int rc=FreeBaseT(&amp;baset_A);\n      if(rc)\n         fprintf(stderr, \"FreeBaseT() reports: %d %s\\n\", rCode, strerror(rCode));\n      }\n\n   return(rCode);\n   }\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>UUID: 01 02 03 04 05 06 07 08 09 0A 0B 0C 0D 0E 0F 10\nNumber of data items: 3\n   data[0] power=1 t1=1000 dT=1111\n   data[1] power=2 t1=2000 dT=2222\n   data[2] power=3 t1=3000 dT=3333\n</code></pre>\n"}], "owner": {"reputation": 123, "user_id": 5601732, "user_type": "registered", "accept_rate": 27, "profile_image": "https://lh6.googleusercontent.com/-TiNzHzxbVdQ/AAAAAAAAAAI/AAAAAAAAABE/9GwNCtv0iOU/photo.jpg?sz=128", "display_name": "stellarhawk 34", "link": "https://stackoverflow.com/users/5601732/stellarhawk-34"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 444, "favorite_count": 0, "accepted_answer_id": 46060988, "answer_count": 3, "score": -1, "last_activity_date": 1504637271, "creation_date": 1504627077, "last_edit_date": 1504637271, "question_id": 46059131, "link": "https://stackoverflow.com/questions/46059131/pointer-within-struct-to-dynamic-array-of-structures-c", "title": "Pointer within struct to dynamic array of structures C", "body": "<p>I am confused with one of the usual issues in C which is memory management and pointers. I have three structs, like this.</p>\n\n<pre><code>typedef struct {\n   uint8_t  uuid[16];\n} uuid_array;\n\ntypedef struct Detail {\n   int8_t power;\n   uint32_t t1;\n   uint32_t dT;\n} Detail_t;\n\ntypedef struct Base {\n   uuid_array unique_id;\n   Detail_t *data;\n} Base_t;\n</code></pre>\n\n<p>I would like to create ten <code>Base_t</code> structs and I want the <code>data</code> pointer in each <code>Base_t</code> <code>struct</code> to point to an array of dynamically growing <code>Detail_t</code> structs.</p>\n\n<p>I know I should use <code>malloc()</code>, and <code>realloc()</code> but I have no experience using these functions and I am quite confused as to how they work.</p>\n\n<p>How can the <code>data</code> pointer point to a dynamically sized array of <code>Detail_t</code> <code>struct</code>s?</p>\n\n<p>Thank you very much.</p>\n"}, {"tags": ["c", "random", "probability"], "comments": [{"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 1, "creation_date": 1504627175, "post_id": 46059125, "comment_id": 79078473, "body": "Only true for 3 doors, but you seem to use 4 <code>winDoor % 4</code>. With four doors you can even pick a loosing door again if at first you already did."}, {"owner": {"reputation": 564, "user_id": 1445733, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6c29da764b3b70f89fb2ba151494c4b?s=128&d=identicon&r=PG", "display_name": "Michael Whinfrey", "link": "https://stackoverflow.com/users/1445733/michael-whinfrey"}, "edited": false, "score": 0, "creation_date": 1514347061, "post_id": 46059125, "comment_id": 82941171, "body": "This doesn&#39;t actually emulate the monty hall problem, the mathematical crux of the problem lies in the Dealer opening a remaining door and the player choosing to switch"}], "answers": [{"comments": [{"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1504627361, "post_id": 46059186, "comment_id": 79078591, "body": "Does not explain the 75% chance, which is wrongly calculated. With more than three doors the chance is lower than 2/3, not higher. And is actually wrong if with 3/4 you mean the winning chance when switching."}, {"owner": {"reputation": 368279, "user_id": 1288, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/fc763c6ff6c160ddad05741e87e517b6?s=128&d=identicon&r=PG", "display_name": "Bill the Lizard", "link": "https://stackoverflow.com/users/1288/bill-the-lizard"}, "reply_to_user": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 1, "creation_date": 1504634105, "post_id": 46059186, "comment_id": 79081887, "body": "@Yunnosch The chance does go up with more doors if you always switch, assuming that all but two doors are revealed after the initial selection. (Try it with 100 doors and you&#39;ll have a 99% chance of winning.)"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "reply_to_user": {"reputation": 368279, "user_id": 1288, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/fc763c6ff6c160ddad05741e87e517b6?s=128&d=identicon&r=PG", "display_name": "Bill the Lizard", "link": "https://stackoverflow.com/users/1288/bill-the-lizard"}, "edited": false, "score": 0, "creation_date": 1504635587, "post_id": 46059186, "comment_id": 79082541, "body": "@BilltheLizard Thanks for that interesting information. I was thinking that no  showmaster would offer that..."}], "tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": true, "score": 3, "last_activity_date": 1504627260, "creation_date": 1504627260, "answer_id": 46059186, "question_id": 46059125, "link": "https://stackoverflow.com/questions/46059125/monty-hall-implementation/46059186#46059186", "title": "Monty Hall implementation", "body": "<p>The reason is that you're using <code>% 4</code> instead of <code>% 3</code>. That simulates 4 doors instead of 3, so the result changes from <code>2/3</code> to <code>3/4</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 1491, "user_id": 6232148, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9255cf10ac80e07a45561bbe5316a57f?s=128&d=identicon&r=PG&f=1", "display_name": "rma", "link": "https://stackoverflow.com/users/6232148/rma"}, "reply_to_user": {"reputation": 885, "user_id": 4176992, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/3a121.png?s=128&g=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/4176992/dan"}, "edited": false, "score": 0, "creation_date": 1504627522, "post_id": 46059205, "comment_id": 79078681, "body": "No worries, everyone makes mistakes :) Glad to help!"}], "tags": [], "owner": {"reputation": 1491, "user_id": 6232148, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9255cf10ac80e07a45561bbe5316a57f?s=128&d=identicon&r=PG&f=1", "display_name": "rma", "link": "https://stackoverflow.com/users/6232148/rma"}, "is_accepted": false, "score": 2, "last_activity_date": 1504627323, "creation_date": 1504627323, "answer_id": 46059205, "question_id": 46059125, "link": "https://stackoverflow.com/questions/46059125/monty-hall-implementation/46059205#46059205", "title": "Monty Hall implementation", "body": "<p>You're choosing from 4 doors, not 3. change your %4 to a %3. </p>\n\n<pre><code>include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;time.h&gt;\n\nint main()\n{\n    int repeat = 5000000, i;\n    int win = 0, lose = 0;\n\n    for (i = 1; i &lt;= repeat; i++) {\n        int winDoor = rand();\n        winDoor = winDoor % 3;\n\n        int firstPick = rand();\n        firstPick = firstPick % 3;\n\n        if (winDoor == firstPick) {\n            lose++;\n        } else {\n            win++;\n        }\n    }\n\n    printf(\"%.2f percent win rate\\n\", ((float)win/(float)repeat)*100.00);\n}\n</code></pre>\n"}], "owner": {"reputation": 885, "user_id": 4176992, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/3a121.png?s=128&g=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/4176992/dan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 299, "favorite_count": 0, "accepted_answer_id": 46059186, "answer_count": 2, "score": 2, "last_activity_date": 1504633587, "creation_date": 1504627053, "last_edit_date": 1504633587, "question_id": 46059125, "link": "https://stackoverflow.com/questions/46059125/monty-hall-implementation", "title": "Monty Hall implementation", "body": "<p>I recently watched a video regarding the Monty Hall problem and found it interesting, so I thought of implementing it to see if the probability is truly 66.6% as predicted.</p>\n\n<p>Here is what I have,</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;time.h&gt;\n\nint main()\n{\n    int repeat = 5000000, i;\n    int win = 0, lose = 0;\n\n    for (i = 1; i &lt;= repeat; i++) {\n        int winDoor = rand();\n        winDoor = winDoor % 4;\n\n        int firstPick = rand();\n        firstPick = firstPick % 4;\n\n        if (winDoor == firstPick) {\n            lose++;\n        } else {\n            win++;\n        }\n    }\n\n    printf(\"%.2f percent win rate\\n\", ((float)win/(float)repeat)*100.00);\n}\n</code></pre>\n\n<p>However, I seem to be getting a 75% win rate (by switching doors) with the above code. Is there something wrong with my codes? Or is the 66.6% (2/3) a lie?</p>\n\n<p>P.S. The logic I implemented is, if winning door is first picked, by switching, we lose. If losing door is first picked, by switching, we win. That's how I understand the Monty Hall problem.</p>\n\n<p>EDIT: I actually put %4 because I read that %4 will represent 0-3. I forgot I need 1-3, not 0-3. Question resolved.</p>\n"}, {"tags": ["c", "io", "sigabrt"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1504626822, "post_id": 46059046, "comment_id": 79078231, "body": "<a href=\"https://stackoverflow.com/q/5431941/2173917\">Please see Why is \u201cwhile ( !feof (file) )\u201d always wrong?</a>"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1504626860, "post_id": 46059046, "comment_id": 79078254, "body": "I don;t see any error checking for <code>malloc()</code> and family!!"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1504626869, "post_id": 46059046, "comment_id": 79078259, "body": "<i>Questions seeking debugging help (why isn&#39;t this code working?) must include the desired behavior, a specific problem or error and the shortest code necessary to reproduce it in the question itself. Questions without a clear problem statement are not useful to other readers. See: How to create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>.</i>"}, {"owner": {"reputation": 73, "user_id": 6896557, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5a3ec8ce5a7f4df60823d3c7abea6f0?s=128&d=identicon&r=PG&f=1", "display_name": "EDTwardy", "link": "https://stackoverflow.com/users/6896557/edtwardy"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1504627129, "post_id": 46059046, "comment_id": 79078444, "body": "@SouravGhosh thanks for catching those. I&#39;m immediately working on fixing those problems, however the problem persists."}, {"owner": {"reputation": 73, "user_id": 6896557, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5a3ec8ce5a7f4df60823d3c7abea6f0?s=128&d=identicon&r=PG&f=1", "display_name": "EDTwardy", "link": "https://stackoverflow.com/users/6896557/edtwardy"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1504627269, "post_id": 46059046, "comment_id": 79078529, "body": "Also, please inform me how to refine my question. I attempted to provide the minimal example, with the maximum description of the problem. I can include the output from the function with the printf &quot;fix&quot; if that would help."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1504627522, "post_id": 46059046, "comment_id": 79078682, "body": "change <code>while (!feof(file))</code> to <code>while (getline(&amp;line, &amp;n, file) != -1)</code>."}, {"owner": {"reputation": 73, "user_id": 6896557, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5a3ec8ce5a7f4df60823d3c7abea6f0?s=128&d=identicon&r=PG&f=1", "display_name": "EDTwardy", "link": "https://stackoverflow.com/users/6896557/edtwardy"}, "edited": false, "score": 0, "creation_date": 1504628800, "post_id": 46059046, "comment_id": 79079368, "body": "Thanks to the both of you, removing feof() fixed the problem. Lesson learned, on I/O, I suppose. If one of you would repost your comment as an answer, I can accept it as fixing the problem. Thank you again."}], "answers": [{"comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1504640406, "post_id": 46061865, "comment_id": 79085076, "body": "<i>Also it&#39;s considered better form to <code>printf(&quot;%s&quot;, &quot;[&quot;)</code> or <code>printf(&quot;%c&quot;, &#39;[&#39;)</code> rather than <code>printf(&quot;[&quot;)</code>.</i>  By who?"}], "tags": [], "owner": {"reputation": 2829, "user_id": 2569885, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XRfHX.png?s=128&g=1", "display_name": "Mike Gleason", "link": "https://stackoverflow.com/users/2569885/mike-gleason"}, "is_accepted": false, "score": 0, "last_activity_date": 1504638860, "creation_date": 1504638860, "answer_id": 46061865, "question_id": 46059046, "link": "https://stackoverflow.com/questions/46059046/strange-sigabrt-in-printf-with-const-char/46061865#46061865", "title": "Strange SIGABRT in printf with const char*", "body": "<p>The problem could be due to:</p>\n\n<pre><code>printf(\"%g, \", gsl_matrix_get(matrix, i, j));\n</code></pre>\n\n<p>Because you are trying to printf a double but your function is returning a gsl_matrix pointer.</p>\n\n<p>Also it's considered better form to <code>printf(\"%s\", \"[\")</code> or <code>printf(\"%c\", '[')</code> rather than <code>printf(\"[\"</code>).</p>\n"}, {"tags": [], "owner": {"reputation": 73, "user_id": 6896557, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5a3ec8ce5a7f4df60823d3c7abea6f0?s=128&d=identicon&r=PG&f=1", "display_name": "EDTwardy", "link": "https://stackoverflow.com/users/6896557/edtwardy"}, "is_accepted": true, "score": 0, "last_activity_date": 1504704299, "creation_date": 1504704299, "answer_id": 46076514, "question_id": 46059046, "link": "https://stackoverflow.com/questions/46059046/strange-sigabrt-in-printf-with-const-char/46076514#46076514", "title": "Strange SIGABRT in printf with const char*", "body": "<p>Thanks to @SouravGhosh and @PaulOgilvie for providing the answer. The problem lay in my use of feof() as a switch for the while loop. This is poor practice, and in many cases (this one included) it caused undefined behavior. Why this would cause the line</p>\n\n<pre><code>printf(\"[\");\n</code></pre>\n\n<p>To fail is beyond me. It appears to be a buffer overflow of stdout, but I tested this by calling fflush() on stdout before the failure, and the problem was not remedied. If anyone is able to identify the exact cause of the problem, I would appreciate it. Also thanks to @SouravGhosh for reminding me that I forgot to check the return value of calloc().</p>\n"}], "owner": {"reputation": 73, "user_id": 6896557, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5a3ec8ce5a7f4df60823d3c7abea6f0?s=128&d=identicon&r=PG&f=1", "display_name": "EDTwardy", "link": "https://stackoverflow.com/users/6896557/edtwardy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 399, "favorite_count": 0, "accepted_answer_id": 46076514, "answer_count": 2, "score": 2, "last_activity_date": 1504704299, "creation_date": 1504626800, "question_id": 46059046, "link": "https://stackoverflow.com/questions/46059046/strange-sigabrt-in-printf-with-const-char", "title": "Strange SIGABRT in printf with const char*", "body": "<p>Hello Stack Exchange community,</p>\n\n<p>I have a function that reads a CSV file into a gsl_matrix and then returns a pointer to the matrix. The function executes without error, however the program exits with SIGABRT when executing printf with a constant string after the function returns. I've tried:</p>\n\n<ul>\n<li>Changing the string that is printed</li>\n<li>Abstracting the string to be a format followed by a char</li>\n</ul>\n\n<p>Neither worked, however I discovered that placing a printf() before the call of the function prevents this error (commented out in main() below). I'm compiling with gcc 5.4.0 on Ubuntu 16.04. Calling malloc_stats() before this line shows that I'm using approximately 6kB of the heap. The LLDB output shown below illustrates exactly which line causes the error in print_matrix().</p>\n\n<pre><code>Process 10955 stopped\n* thread #1: tid = 10955, 0x000000000040114b main`print_matrix(matrix=0x0000000000604010) + 21 at main.c:88, name = 'main', stop reason = step over\n    frame #0: 0x000000000040114b main`print_matrix(matrix=0x0000000000604010) + 21 at main.c:88\n   85   static void print_matrix(gsl_matrix * matrix)\n   86   {\n   87     for (int i = 0; i &lt; matrix-&gt;size1; i++) {\n-&gt; 88       printf(\"[\");\n   89       for (int j = 0; j &lt; matrix-&gt;size2; j++) {\n   90         printf(\"%g, \", gsl_matrix_get(matrix, i, j));\n   91       }\n(lldb) \nProcess 10955 stopped\n* thread #1: tid = 10955, 0x00007ffff708d428 libc.so.6`__GI_raise(sig=6) + 56 at raise.c:54, name = 'main', stop reason = signal SIGABRT\n    frame #0: 0x00007ffff708d428 libc.so.6`__GI_raise(sig=6) + 56 at raise.c:54\n</code></pre>\n\n<p>The code shown below is the main function, which resides in main.c:</p>\n\n<pre><code>int main(int argc, char * argv[]) {\n  /* printf(\"This is the fix.\\n\"); */\n  gsl_matrix * matrix2 = read_tuples_csv(\"data/12AX7-Data.csv\", 3);\n  print_matrix(matrix2);\n}\n</code></pre>\n\n<p>The following code is the function read_tuples_csv(), which resides in util.c. The function takes the path of the file to read and the size of the tuples to parse. I suspect that the problem is in this function, but no amount of proofreading or debugging has been able to reveal the error in my semantics thus far.</p>\n\n<pre><code>gsl_matrix * read_tuples_csv(const char * filename, size_t n)\n{\n  FILE * file;\n  if ((file = fopen(filename, \"r\")) == NULL || n &lt;= 0)\n    return NULL;\n\n  List * list = malloc(sizeof(List));\n  list_init(list, free);\n\n  double * arr;\n  while (!feof(file)) {\n    arr = calloc(n, sizeof(double));\n    char *line = NULL, *scratch;\n    size_t n = 0;\n    if (getline(&amp;line, &amp;n, file) == -1) goto error_exit;\n    line = strtok_r(line, \",\", &amp;scratch);\n\n    int i = 0;\n    do {\n      int ret = sscanf(line, \"%lf\", &amp;arr[i]);\n      if (ret &lt;= 0) fprintf(stderr, \"Something happened:\\nline:\\t%s\", line);\n      i++;\n    } while ((line = strtok_r(NULL, \",\", &amp;scratch)) != NULL &amp;&amp; i &lt; n);\n\n    free(line);\n    line = NULL;\n    if (list_insnxt(list, list_tail(list), arr) != 0)\n      goto error_exit;\n  }\n  fclose(file);\n  file = NULL;\n\n  gsl_matrix * matrix = gsl_matrix_alloc(list_size(list), n);\n  int i = 0;\n  while (list_size(list) &gt; 0) {\n    double * vector;\n    list_remnxt(list, NULL, (void **)&amp;vector);\n    for (int j = 0; j &lt; n; j++) {\n      gsl_matrix_set(matrix, i, j, vector[j]);\n    }\n    i++;\n  }\n\n  list_dest(list);\n  free(list);\n\n  return matrix;\n\n error_exit: {\n    if (file != NULL) fclose(file);\n    list_dest(list);\n    free(arr);\n    free(list);\n    return NULL;\n  }\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "multithreading", "unit-testing", "open-source"], "comments": [{"owner": {"reputation": 8847, "user_id": 3484570, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/r5BRZ.png?s=128&g=1", "display_name": "nwp", "link": "https://stackoverflow.com/users/3484570/nwp"}, "edited": false, "score": 0, "creation_date": 1504625985, "post_id": 46058789, "comment_id": 79077731, "body": "Looks like it belongs on <a href=\"https://softwarerecs.stackexchange.com/\">software recommendations.so</a>."}, {"owner": {"reputation": 11771, "user_id": 1275653, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb781e5bd49c5d403228b98859d8b6dd?s=128&d=identicon&r=PG", "display_name": "thb", "link": "https://stackoverflow.com/users/1275653/thb"}, "reply_to_user": {"reputation": 8847, "user_id": 3484570, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/r5BRZ.png?s=128&g=1", "display_name": "nwp", "link": "https://stackoverflow.com/users/3484570/nwp"}, "edited": false, "score": 0, "creation_date": 1504626634, "post_id": 46058789, "comment_id": 79078117, "body": "@nwp: Reworded. Thanks."}, {"owner": {"reputation": 8847, "user_id": 3484570, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/r5BRZ.png?s=128&g=1", "display_name": "nwp", "link": "https://stackoverflow.com/users/3484570/nwp"}, "edited": false, "score": 0, "creation_date": 1504627346, "post_id": 46058789, "comment_id": 79078577, "body": "Not sure if replacing &quot;tool&quot; with &quot;technique&quot; saves the question. I can tell you my opinion: Testing assumes the tested thing behaves deterministically and reproducibly. That is no longer the case with UB and data races, so testing is basically useless here. I recommend you look into <a href=\"https://clang.llvm.org/docs/ThreadSanitizer.html\" rel=\"nofollow noreferrer\">TSan</a> and the other <a href=\"https://clang.llvm.org/docs/ThreadSafetyAnalysis.html\" rel=\"nofollow noreferrer\">TSan</a>. They don&#39;t do what you want, but they seem to be the best we have at the moment. Data race prevention by construction seems viable while data race prevention by testing doesn&#39;t."}, {"owner": {"reputation": 3193, "user_id": 6608866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/395a0bd6f09706e701866702448c5924?s=128&d=identicon&r=PG&f=1", "display_name": "PaulR", "link": "https://stackoverflow.com/users/6608866/paulr"}, "edited": false, "score": 0, "creation_date": 1504627445, "post_id": 46058789, "comment_id": 79078643, "body": "You could try <a href=\"http://www.cprover.org/cbmc/\" rel=\"nofollow noreferrer\">cbmc</a>, it is pretty good at concurrency. Note however that in general exhaustive testing of software is undecidable."}, {"owner": {"reputation": 1131, "user_id": 3448634, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/c1b5b4e95d700f849977e3c3e99b4ff7?s=128&d=identicon&r=PG&f=1", "display_name": "Makketronix", "link": "https://stackoverflow.com/users/3448634/makketronix"}, "edited": false, "score": 0, "creation_date": 1504650802, "post_id": 46058789, "comment_id": 79089308, "body": "In my humble opinion, you can NEVER exhaustively test anything in limited time. For example, say x = 1+2 returns 3. You say it passed. How many times do confirm it?  What if tomorrow the answer is 4? Only then you will try find the cause. I just get a a little tiny bit irritated when I see statements like this :-). Testing improves confidence level that there are no defects. The more, the better."}, {"owner": {"reputation": 11771, "user_id": 1275653, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb781e5bd49c5d403228b98859d8b6dd?s=128&d=identicon&r=PG", "display_name": "thb", "link": "https://stackoverflow.com/users/1275653/thb"}, "reply_to_user": {"reputation": 1131, "user_id": 3448634, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/c1b5b4e95d700f849977e3c3e99b4ff7?s=128&d=identicon&r=PG&f=1", "display_name": "Makketronix", "link": "https://stackoverflow.com/users/3448634/makketronix"}, "edited": false, "score": 0, "creation_date": 1504658208, "post_id": 46058789, "comment_id": 79090979, "body": "@Makketronix: okay. I would like to test each of the 24 possible orderings once."}, {"owner": {"reputation": 1131, "user_id": 3448634, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/c1b5b4e95d700f849977e3c3e99b4ff7?s=128&d=identicon&r=PG&f=1", "display_name": "Makketronix", "link": "https://stackoverflow.com/users/3448634/makketronix"}, "edited": false, "score": 0, "creation_date": 1504709931, "post_id": 46058789, "comment_id": 79118340, "body": "@thb An inefficient trivial way of testing it is to atomically log the operation into a file, and see if all the permutations occurred. I am pretty sure you are seeking a better answer though."}], "owner": {"reputation": 11771, "user_id": 1275653, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb781e5bd49c5d403228b98859d8b6dd?s=128&d=identicon&r=PG", "display_name": "thb", "link": "https://stackoverflow.com/users/1275653/thb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 102, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1504626976, "creation_date": 1504625901, "last_edit_date": 1504626976, "question_id": 46058789, "link": "https://stackoverflow.com/questions/46058789/exhaustive-testing-of-threaded-code", "title": "Exhaustive testing of threaded code", "body": "<p>Does an open-source technique exist to simulate all possible memory-access-ordering permutations to exhaustively unit test threaded C or C++ code?</p>\n\n<p><strong>REMARKS AND EXAMPLE</strong></p>\n\n<p>One answer is: \"Use a memory-safe/functional/very-high-level language. Avoid C and C++.\" However, that answer answers a different question. Rust, Go, Erlang, Haskell, etc., are great; but my question regards unconstrained C, C++, assembly, or the like.</p>\n\n<p>Another answer is: \"Avoid the question by using <code>future</code>, <code>promise</code>, etc.\" However, my question regards <em>testing</em> methods, not coding methods. I do not seek a code to help me satisfy a paradigm, but a paradigm (or tool) to help me test my code.</p>\n\n<p>The file <em>memory-barriers.txt</em> in the Linux kernel's source documentation affords a suitable example:</p>\n\n<blockquote>\n  <p>[C]onsider the following sequence of events:</p>\n</blockquote>\n\n<pre><code>    CPU 1           CPU 2\n    =============== ===============\n    { A == 1; B == 2 }\n    A = 3;          x = B;\n    B = 4;          y = A;\n</code></pre>\n\n<blockquote>\n  <p>The set of accesses as seen by the memory system in the middle can be arranged in 24 different combinations:</p>\n</blockquote>\n\n<pre><code>    STORE A=3,      STORE B=4,      y=LOAD A-&gt;3,    x=LOAD B-&gt;4\n    STORE A=3,      STORE B=4,      x=LOAD B-&gt;4,    y=LOAD A-&gt;3\n    STORE A=3,      y=LOAD A-&gt;3,    STORE B=4,      x=LOAD B-&gt;4\n    STORE A=3,      y=LOAD A-&gt;3,    x=LOAD B-&gt;2,    STORE B=4\n    STORE A=3,      x=LOAD B-&gt;2,    STORE B=4,      y=LOAD A-&gt;3\n    STORE A=3,      x=LOAD B-&gt;2,    y=LOAD A-&gt;3,    STORE B=4\n    STORE B=4,      STORE A=3,      y=LOAD A-&gt;3,    x=LOAD B-&gt;4\n    STORE B=4, ...\n    ...\n</code></pre>\n\n<blockquote>\n  <p>and can thus result in four different combinations of values:</p>\n</blockquote>\n\n<pre><code>    x == 2, y == 1\n    x == 2, y == 3\n    x == 4, y == 1\n    x == 4, y == 3\n</code></pre>\n\n<p>Rather than waiting for a Heisenbug to appear, for simple code like the above, one would rather just simulate all 24 cases in advance. Does an open-source technique exist to simulate the 24 cases?</p>\n\n<p>If the technique does not exist, then could it exist? Or would combinatorial explosion render such a technique useless in practice? If the latter, then how do disciplined C++ programmers instead unit test threaded logic when coding for maximum performance?</p>\n\n<p>Various authors have warned how hard it is to think right about concurrency. An open-source technique or tool to systematically expose potential faults in concrete cases would help, if it existed. Does it?</p>\n\n<p><strong>REFERENCES</strong></p>\n\n<ul>\n<li>There exists <a href=\"https://stackoverflow.com/a/2036005/1275653\">this answer</a>, but it's seven years old and anyway does not much help.</li>\n<li>There also exist <a href=\"https://stackoverflow.com/q/3362734/1275653\">these answers</a>, but they're just as old and do not regard open source.</li>\n<li><a href=\"https://stackoverflow.com/q/20861305/1275653\">Here</a> is a question that wasn't precise enough.</li>\n<li><a href=\"https://stackoverflow.com/q/12159/1275653\">Here</a> is a very interesting question with various partial answers, but it's <em>nine years old.</em> (No one really had an answer back then, apparently.)</li>\n<li><a href=\"http://wiki.c2.com/?ExtremeProgrammingChallengeFourteen\" rel=\"nofollow noreferrer\">Here</a> is someone off-site who at least understands the question.</li>\n<li>There exist various questions and answers on-site for Java, but Java is not what I was asking about.</li>\n<li><a href=\"https://stackoverflow.com/a/4435560/1275653\">This answer</a> re Objective C is straightforward, illuminating and recent, though not quite on target.</li>\n</ul>\n"}, {"tags": ["c", "function", "loops"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1504625933, "post_id": 46058762, "comment_id": 79077685, "body": "What <i>happens</i> when you run it? Please <a href=\"http://stackoverflow.com/help/how-to-ask\">read about how to ask good questions</a>. And please reas <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">How to debug small programs</a> by Eric Lippert, and learn how to use a debugger."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 2, "creation_date": 1504626498, "post_id": 46058762, "comment_id": 79078017, "body": "<code>n &#47;= 10;</code> ==&gt; <code>num &#47;= 10;</code>"}, {"owner": {"reputation": 22777, "user_id": 133203, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Fp3hB.jpg?s=128&g=1", "display_name": "Federico klez Culloca", "link": "https://stackoverflow.com/users/133203/federico-klez-culloca"}, "edited": false, "score": 0, "creation_date": 1504626781, "post_id": 46058762, "comment_id": 79078205, "body": "Get rid of <code>n</code> and simply use <code>num</code> instead. It&#39;s not like you need <code>num</code> to stay constant at the end of the function and it only generates confusion."}], "answers": [{"tags": [], "owner": {"reputation": 133, "user_id": 8413315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/957ab01c9bb7f3d2bc3f6e03c16ac00c?s=128&d=identicon&r=PG&f=1", "display_name": "CrankyElderGod", "link": "https://stackoverflow.com/users/8413315/crankyeldergod"}, "is_accepted": false, "score": 1, "last_activity_date": 1504626660, "creation_date": 1504626660, "answer_id": 46059010, "question_id": 46058762, "link": "https://stackoverflow.com/questions/46058762/program-c-counting-total-number-of-odd-digits/46059010#46059010", "title": "Program C counting total number of odd digits", "body": "<p>Looping variable is not correct.  Your outer loop is</p>\n\n<p><code>while (num !=0)</code></p>\n\n<p>but the <strong>num</strong> variable is never decremented; the final statement decrements the <strong>n</strong> variable.  My guess is you want to initialize </p>\n\n<pre><code>int n = num;\nwhile (n != 0 )\n{ ...\n  n/= 10;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 187, "user_id": 6308243, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0def07aa2b00de077d9f24ecefdcc1ce?s=128&d=identicon&r=PG&f=1", "display_name": "BEX", "link": "https://stackoverflow.com/users/6308243/bex"}, "edited": false, "score": 0, "creation_date": 1504627480, "post_id": 46059123, "comment_id": 79078664, "body": "Thanks! What if I want to use a void function?"}, {"owner": {"reputation": 353, "user_id": 4047083, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HN2Gm.png?s=128&g=1", "display_name": "curusarn", "link": "https://stackoverflow.com/users/4047083/curusarn"}, "reply_to_user": {"reputation": 187, "user_id": 6308243, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0def07aa2b00de077d9f24ecefdcc1ce?s=128&d=identicon&r=PG&f=1", "display_name": "BEX", "link": "https://stackoverflow.com/users/6308243/bex"}, "edited": false, "score": 0, "creation_date": 1504628069, "post_id": 46059123, "comment_id": 79079010, "body": "Well, you have to get the <code>result</code> value out of the function somehow. You could use output parameter instead of returning it."}, {"owner": {"reputation": 353, "user_id": 4047083, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HN2Gm.png?s=128&g=1", "display_name": "curusarn", "link": "https://stackoverflow.com/users/4047083/curusarn"}, "reply_to_user": {"reputation": 187, "user_id": 6308243, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0def07aa2b00de077d9f24ecefdcc1ce?s=128&d=identicon&r=PG&f=1", "display_name": "BEX", "link": "https://stackoverflow.com/users/6308243/bex"}, "edited": false, "score": 0, "creation_date": 1504628125, "post_id": 46059123, "comment_id": 79079039, "body": "@BEX Here is an example: <a href=\"https://stackoverflow.com/questions/42403940/c-input-and-out-parameters-of-a-function\" title=\"c input and out parameters of a function\">stackoverflow.com/questions/42403940/&hellip;</a>"}, {"owner": {"reputation": 187, "user_id": 6308243, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0def07aa2b00de077d9f24ecefdcc1ce?s=128&d=identicon&r=PG&f=1", "display_name": "BEX", "link": "https://stackoverflow.com/users/6308243/bex"}, "edited": false, "score": 0, "creation_date": 1504628309, "post_id": 46059123, "comment_id": 79079116, "body": "I tried changing it to void countOddDigits(int num, int *result), all &quot;result&quot; to &quot;*result&quot; and deleted the return statement but it doesn&#39;t output the value. Is there anything I should add to my code?"}, {"owner": {"reputation": 353, "user_id": 4047083, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HN2Gm.png?s=128&g=1", "display_name": "curusarn", "link": "https://stackoverflow.com/users/4047083/curusarn"}, "reply_to_user": {"reputation": 187, "user_id": 6308243, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0def07aa2b00de077d9f24ecefdcc1ce?s=128&d=identicon&r=PG&f=1", "display_name": "BEX", "link": "https://stackoverflow.com/users/6308243/bex"}, "edited": false, "score": 0, "creation_date": 1504628671, "post_id": 46059123, "comment_id": 79079305, "body": "It won&#39;t output the value - functions with <code>void</code> return type don&#39;t output anything. You need to create result variable in the <code>main</code> function. Then call the <code>countTheOddDigits</code> function. The function will <b>modify</b> the <code>result</code> variable and then you can print it out."}, {"owner": {"reputation": 353, "user_id": 4047083, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HN2Gm.png?s=128&g=1", "display_name": "curusarn", "link": "https://stackoverflow.com/users/4047083/curusarn"}, "reply_to_user": {"reputation": 187, "user_id": 6308243, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0def07aa2b00de077d9f24ecefdcc1ce?s=128&d=identicon&r=PG&f=1", "display_name": "BEX", "link": "https://stackoverflow.com/users/6308243/bex"}, "edited": false, "score": 0, "creation_date": 1504628783, "post_id": 46059123, "comment_id": 79079352, "body": "I recommend you to read something about pointers, because you won&#39;t really understand how output parameters work otherwise. Eg. <a href=\"https://www.tutorialspoint.com/cprogramming/c_pointers.htm\" rel=\"nofollow noreferrer\">tutorialspoint.com/cprogramming/c_pointers.htm</a>"}], "tags": [], "owner": {"reputation": 353, "user_id": 4047083, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HN2Gm.png?s=128&g=1", "display_name": "curusarn", "link": "https://stackoverflow.com/users/4047083/curusarn"}, "is_accepted": true, "score": 1, "last_activity_date": 1504628874, "last_edit_date": 1504628874, "creation_date": 1504627046, "answer_id": 46059123, "question_id": 46058762, "link": "https://stackoverflow.com/questions/46058762/program-c-counting-total-number-of-odd-digits/46059123#46059123", "title": "Program C counting total number of odd digits", "body": "<p>There were a few mistakes in your code. Here is a working version of your code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint countOddDigits(int n); \nint main()\n{\n    int number;\n    printf(\"Please enter the number: \\n\");\n    scanf(\"%d\", &amp;number);\n    printf(\"countOddDigits(): %d\\n\", countOddDigits(number));\n    return 0;\n}\n\nint countOddDigits(int n)\n{\n    int result = 0;\n    while(n != 0){\n        if(n % 2 != 0)\n            result++;\n        n /= 10;\n    }   \n    return result;\n}\n</code></pre>\n\n<ol>\n<li>You are mixing <code>n</code> and <code>num</code> together - there is no need for two variables.</li>\n<li><code>n%=10</code> is just causing mistakes - you need to check the last digit <code>if(n%2!=0)</code> and then move to the next one <code>n/=10</code>, that's all. </li>\n</ol>\n"}], "owner": {"reputation": 187, "user_id": 6308243, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0def07aa2b00de077d9f24ecefdcc1ce?s=128&d=identicon&r=PG&f=1", "display_name": "BEX", "link": "https://stackoverflow.com/users/6308243/bex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1186, "favorite_count": 0, "accepted_answer_id": 46059123, "answer_count": 2, "score": -3, "last_activity_date": 1504628874, "creation_date": 1504625814, "last_edit_date": 1504626389, "question_id": 46058762, "link": "https://stackoverflow.com/questions/46058762/program-c-counting-total-number-of-odd-digits", "title": "Program C counting total number of odd digits", "body": "<p>I'm writing a C program that counts the number of odd digits from user input.</p>\n\n<p>Eg. </p>\n\n<p>Please enter the number: 12345</p>\n\n<p>countOddDigits(): 3</p>\n\n<pre><code>int countOddDigits(int num);\nint main()\n{\n    int number;\n    printf(\"Please enter the number: \\n\");\n    scanf(\"%d\", &amp;number);\n    printf(\"countOddDigits(): %d\\n\", countOddDigits(number));\n    return 0;\n}\nint countOddDigits(int num)\n{\n    int result = 0, n;\n    while(num != 0){\n        n = num % 10;\n        if(n % 2 != 0){\n            result++;\n        }\n       n /= 10;\n    }\n    return result;\n}\n</code></pre>\n\n<p>The code is not working. \nCan someone tell me where does it go wrong?</p>\n"}, {"tags": ["c", "linux", "gcc"], "comments": [{"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 2, "creation_date": 1504625222, "post_id": 46058565, "comment_id": 79077234, "body": "Why does it need to, out of interest?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 2, "creation_date": 1504625223, "post_id": 46058565, "comment_id": 79077233, "body": "Why do you care what address is returned?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1504625268, "post_id": 46058565, "comment_id": 79077261, "body": "See <a href=\"https://en.wikipedia.org/wiki/Address_space_layout_randomization\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Address_space_layout_randomization</a>"}, {"owner": {"reputation": 1820, "user_id": 3849158, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/q1Gcg.png?s=128&g=1", "display_name": "izlin", "link": "https://stackoverflow.com/users/3849158/izlin"}, "edited": false, "score": 4, "creation_date": 1504625349, "post_id": 46058565, "comment_id": 79077302, "body": "Sounds like a <a href=\"http://xyproblem.info/\" rel=\"nofollow noreferrer\">XY-problem</a>, or do you aks just because you are curious?"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1504625473, "post_id": 46058565, "comment_id": 79077377, "body": "See <a href=\"https://stackoverflow.com/questions/11238457/disable-and-re-enable-address-space-layout-randomization-only-for-myself\">this question</a> regarding enabling/disabling address space layout randomization on Linux."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1504625633, "post_id": 46058565, "comment_id": 79077484, "body": "@dbush if ASLR is disabled, does it guarantee that the first malloc will return the same address on successive runs?"}, {"owner": {"reputation": 2597, "user_id": 4755321, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e93c2832d8928731e8e5d2f6d665c4a0?s=128&d=identicon&r=PG&f=1", "display_name": "Jacek \u015alimok", "link": "https://stackoverflow.com/users/4755321/jacek-%c5%9alimok"}, "edited": false, "score": 0, "creation_date": 1504625679, "post_id": 46058565, "comment_id": 79077512, "body": "Why do you need this? Even if it&#39;s for a test (unit, or any other kind), it really should not depend on the value returned malloc, other than checking if it&#39;s other than null (allocation failure)."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1504625801, "post_id": 46058565, "comment_id": 79077603, "body": "@MichaelWalz I would say no.  Some library thread/s in a race to the malloc mutex... and you&#39;re back with unreliable repeatability."}, {"owner": {"reputation": 1131, "user_id": 3448634, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/c1b5b4e95d700f849977e3c3e99b4ff7?s=128&d=identicon&r=PG&f=1", "display_name": "Makketronix", "link": "https://stackoverflow.com/users/3448634/makketronix"}, "edited": false, "score": 0, "creation_date": 1504650878, "post_id": 46058565, "comment_id": 79089331, "body": "BTW, gcc is a compiler. It has nothing to do with returning memory address."}, {"owner": {"reputation": 39, "user_id": 8409845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9be354a7559f1d0662065c412435f51e?s=128&d=identicon&r=PG&f=1", "display_name": "Fred", "link": "https://stackoverflow.com/users/8409845/fred"}, "edited": false, "score": 0, "creation_date": 1504715275, "post_id": 46058565, "comment_id": 79121832, "body": "I have an array of structures, each element has an id and severals pointers and offsets. I had an instability, some runs work fine and other ones failed. I dumped the content of the elements to check the offsets which must be constant from one run to the other. As the pointers always change, the diff is difficult. I agree that a good solution could be to dump only the offsets but I&#39;d like to know if there is a way to make the pointers constant."}], "answers": [{"comments": [{"owner": {"reputation": 1800, "user_id": 4769313, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/gFISt.png?s=128&g=1", "display_name": "Sir Jo Black", "link": "https://stackoverflow.com/users/4769313/sir-jo-black"}, "edited": false, "score": 0, "creation_date": 1504626766, "post_id": 46058622, "comment_id": 79078198, "body": "The same physical address, that is not always the same value the malloc function returns! It&#39;s possible to obtain physical addresses using other functions than malloc."}, {"owner": {"reputation": 1800, "user_id": 4769313, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/gFISt.png?s=128&g=1", "display_name": "Sir Jo Black", "link": "https://stackoverflow.com/users/4769313/sir-jo-black"}, "edited": false, "score": 0, "creation_date": 1504627021, "post_id": 46058622, "comment_id": 79078367, "body": "Some IPC functions may be used to obtain and manage same memory areas between different processes."}], "tags": [], "owner": {"reputation": 144, "user_id": 5198133, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000908598775/picture?type=large", "display_name": "Aidan Connelly", "link": "https://stackoverflow.com/users/5198133/aidan-connelly"}, "is_accepted": false, "score": 0, "last_activity_date": 1504625360, "creation_date": 1504625360, "answer_id": 46058622, "question_id": 46058565, "link": "https://stackoverflow.com/questions/46058565/how-to-make-malloc-return-always-the-same-adress/46058622#46058622", "title": "How to make malloc return always the same adress?", "body": "<p>The only way to do this is to assign the same address everytime, as in <a href=\"https://stackoverflow.com/questions/33534874/malloc-a-struct-at-a-specific-point-in-memory\">this</a> question. However what you're doing is questionable, and it is most likely the case there's a better way of doing what you want to do, rather than always getting the same address.</p>\n"}], "owner": {"reputation": 39, "user_id": 8409845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9be354a7559f1d0662065c412435f51e?s=128&d=identicon&r=PG&f=1", "display_name": "Fred", "link": "https://stackoverflow.com/users/8409845/fred"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 171, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1504625360, "creation_date": 1504625144, "question_id": 46058565, "link": "https://stackoverflow.com/questions/46058565/how-to-make-malloc-return-always-the-same-adress", "title": "How to make malloc return always the same adress?", "body": "<p>When running several times the same C programm, the address returned by malloc is always different.\nIs it possible to force Linux/gcc to always get the same adresses for a memory allocation ?</p>\n\n<p>Thanks,\nFred</p>\n"}, {"tags": ["c", "posix", "ld", "static-linking", "object-files"], "answers": [{"comments": [{"owner": {"reputation": 8833, "user_id": 337149, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3bbd41f2b74254f902cfe20acef9030b?s=128&d=identicon&r=PG", "display_name": "August Karlstrom", "link": "https://stackoverflow.com/users/337149/august-karlstrom"}, "edited": false, "score": 0, "creation_date": 1504628171, "post_id": 46058638, "comment_id": 79079056, "body": "That&#39;s an interesting approach. However, I would prefer a solution which works at the object file level."}, {"owner": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "reply_to_user": {"reputation": 8833, "user_id": 337149, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3bbd41f2b74254f902cfe20acef9030b?s=128&d=identicon&r=PG", "display_name": "August Karlstrom", "link": "https://stackoverflow.com/users/337149/august-karlstrom"}, "edited": false, "score": 0, "creation_date": 1504629842, "post_id": 46058638, "comment_id": 79079877, "body": "@AugustKarlstrom I can definitely understand this preference. However, I think this would be a linker specific solution. I edited my answer with details."}, {"owner": {"reputation": 8833, "user_id": 337149, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3bbd41f2b74254f902cfe20acef9030b?s=128&d=identicon&r=PG", "display_name": "August Karlstrom", "link": "https://stackoverflow.com/users/337149/august-karlstrom"}, "edited": false, "score": 0, "creation_date": 1504631781, "post_id": 46058638, "comment_id": 79080792, "body": "The GNU ld approach you linked to requires manually managing a file of exported symbols. I should be able to say that all symbols in util.o should be hidden."}, {"owner": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "reply_to_user": {"reputation": 8833, "user_id": 337149, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3bbd41f2b74254f902cfe20acef9030b?s=128&d=identicon&r=PG", "display_name": "August Karlstrom", "link": "https://stackoverflow.com/users/337149/august-karlstrom"}, "edited": false, "score": 0, "creation_date": 1504658584, "post_id": 46058638, "comment_id": 79091064, "body": "@AugustKarlstrom The same thread I linked to offers some other approaches as well. However, I think the only portable approach that will work regardless of compiler or linker would end up being the <code>#include</code> approach. Personally, I target <code>gcc</code> and <code>clang</code>, so I have an easy time using non-portable features."}], "tags": [], "owner": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "is_accepted": false, "score": 2, "last_activity_date": 1504658629, "last_edit_date": 1504658629, "creation_date": 1504625429, "answer_id": 46058638, "question_id": 46058364, "link": "https://stackoverflow.com/questions/46058364/hiding-non-api-symbols-in-library/46058638#46058638", "title": "Hiding non-API symbols in library", "body": "<p>There are probably other possible approaches, but here's one:</p>\n\n<p>You might consider including the file <code>util.c</code> within <code>foo.c</code> and making all the util functions / globals static. i.e.:</p>\n\n<pre><code>#include \"util.c\"\n// ...\n</code></pre>\n\n<p>This works the same as <code>*.h</code> files, it simply ports the whole source into <code>foo.c</code>, nesting <code>util.c</code> and making all the static data available.</p>\n\n<p>When I do this, I rename the file to <code>.inc</code> (i.e. <code>util.c</code> => <code>util.inc</code>)...</p>\n\n<pre><code>#include \"util.inc\"\n// ...\n</code></pre>\n\n<p>...it's an older convention I picked up somewhere, though it might conflict with assembler files, so you'll have to use your own discretion.</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>Another approach might require linker specific directives. For example, <a href=\"https://stackoverflow.com/a/452955/4025095\">this SO answer details GNU's <code>ld</code> to achieve this goal</a>. There are other approaches as well, listed in that same thread.</p>\n"}, {"tags": [], "owner": {"reputation": 179940, "user_id": 20713, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/09b9758a4a83cc25547eb93891f19df7?s=128&d=identicon&r=PG", "display_name": "ephemient", "link": "https://stackoverflow.com/users/20713/ephemient"}, "is_accepted": false, "score": 0, "last_activity_date": 1504634637, "creation_date": 1504634637, "answer_id": 46060905, "question_id": 46058364, "link": "https://stackoverflow.com/questions/46058364/hiding-non-api-symbols-in-library/46060905#46060905", "title": "Hiding non-API symbols in library", "body": "<p>The following is GCC-specific.</p>\n\n<p>You can mark each utility function with</p>\n\n<pre><code>__attribute__((visibility (\"hidden\")))\n</code></pre>\n\n<p>which will prevent it from being linked to from another shared object.</p>\n\n<p>You can apply this to a series of declarations by surrounding them with</p>\n\n<pre><code>#pragma GCC visibility push(hidden)\n/* ... */\n#pragma GCC visibility pop\n</code></pre>\n\n<p>or use <code>-fvisibility=hidden</code> when compiling the object, which applies to declarations without an explicit visibility (e.g. neither <code>__attribute__((visibility))</code> nor <code>#pragma GCC visibility</code>).</p>\n"}, {"tags": [], "owner": {"reputation": 8833, "user_id": 337149, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3bbd41f2b74254f902cfe20acef9030b?s=128&d=identicon&r=PG", "display_name": "August Karlstrom", "link": "https://stackoverflow.com/users/337149/august-karlstrom"}, "is_accepted": true, "score": 0, "last_activity_date": 1504759898, "creation_date": 1504759898, "answer_id": 46088060, "question_id": 46058364, "link": "https://stackoverflow.com/questions/46058364/hiding-non-api-symbols-in-library/46088060#46088060", "title": "Hiding non-API symbols in library", "body": "<p>Before each variable and function declaration in <code>util.h</code>, define a macro constant which renames the declared identifier by adding the library prefix <code>foo_</code>, for instance</p>\n\n<pre><code>#define util_x foo_util_x\nextern int util_x;   \n\n#define util_f foo_util_f\nvoid util_f(void);\n\n...\n</code></pre>\n\n<p>With these definitions in place, no other parts of the code need to be changed, and all global symbols in the object file <code>util.o</code> will be prefixed with <code>foo_</code>. This means that name collisions are less likely to occur. </p>\n"}], "owner": {"reputation": 8833, "user_id": 337149, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3bbd41f2b74254f902cfe20acef9030b?s=128&d=identicon&r=PG", "display_name": "August Karlstrom", "link": "https://stackoverflow.com/users/337149/august-karlstrom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 222, "favorite_count": 0, "accepted_answer_id": 46088060, "answer_count": 3, "score": 3, "last_activity_date": 1504759898, "creation_date": 1504624464, "last_edit_date": 1504632586, "question_id": 46058364, "link": "https://stackoverflow.com/questions/46058364/hiding-non-api-symbols-in-library", "title": "Hiding non-API symbols in library", "body": "<p>Suppose I have a library <em>foo</em> which consists of the modules <em>foo</em> and <em>util</em> and has the following source tree:</p>\n\n<pre><code>foo/\n    foo.c\n    foo.h\n    util.c\n    util.h\n</code></pre>\n\n<p>The public API of the library is defined in <em>foo.h</em> and all global identifiers are properly prefixed with <code>foo_</code> or <code>util_</code>. The module <em>util</em> is only used by <em>foo</em>. To prevent name clashes with other modules named <em>util</em> I want to create a (static) library in which only identifiers from module <em>foo</em> are visible. How can I do this?</p>\n\n<p>Edit: I have searched the internet quite extensively but surprisingly this seems to be one of those unsolved problems in computer science.</p>\n"}, {"tags": ["c", "factors"], "comments": [{"owner": {"reputation": 21326, "user_id": 1679849, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpvxY.png?s=128&g=1", "display_name": "r3mainer", "link": "https://stackoverflow.com/users/1679849/r3mainer"}, "edited": false, "score": 2, "creation_date": 1504624263, "post_id": 46058083, "comment_id": 79076610, "body": "This would be a good time to start learning how to use a debugger (like GDB, for example). Also, please try to format your code more consistently."}, {"owner": {"reputation": 743, "user_id": 2913477, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b126939c105b8d71b18f93c6850e55f1?s=128&d=identicon&r=PG&f=1", "display_name": "MiniMax", "link": "https://stackoverflow.com/users/2913477/minimax"}, "edited": false, "score": 1, "creation_date": 1504625161, "post_id": 46058083, "comment_id": 79077205, "body": "Why - &quot;24 output should be 2,2,3 but the output is coming as 2,3&quot;? <code>24 = 2 * 2 * 2 * 3</code>, i.e. output should be 2,2,2,3."}], "answers": [{"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1504635456, "post_id": 46059061, "comment_id": 79082475, "body": "The &quot;faster&quot; <code>primefactors()</code> has reduced range as <code>i*i</code> readily overflows when <code>i &gt; sqrt(INT_MAX)</code>.  TBD solution"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1504635801, "post_id": 46059061, "comment_id": 79082642, "body": "Suggest <code>for (i = 2; i &lt;= x&#47;i;) {</code> instead.  Try <code>primefactors(INT_MAX)</code> to see the effect."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1504647312, "post_id": 46059061, "comment_id": 79088171, "body": "@chux: I agree <code>INT_MAX</code> causes an arithmetic overflow, yet it does produce <code>2147483647 1</code> after a longer calculation than usual. <code>i &lt;= x&#47;i</code> is much slower for large primes. A quick a dirty fix would be <code>for (i = 2; (unsigned)i * i &lt;= (unsigned)x;) {</code>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1504647580, "post_id": 46059061, "comment_id": 79088282, "body": "&quot;<code>i &lt;= x&#47;i</code> is much slower for large primes.&quot; Perhaps not.  Good compilers will recognize the <code>x&#47;i</code> and nearby <code>x%i</code> and emit code that generates both for about the time cost of one of them.  IOWs, code can get <code>x&#47;i</code> for free since code needs to do <code>x%i</code>.  Of course code could force the issue with <code>div()</code>.  YMMV."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1504688556, "post_id": 46059061, "comment_id": 79102459, "body": "@chux: interesting remark! I shall investigate more... I was expecting that kind of optimisation when both <code>x &#47; i</code> and <code>x % i</code> were computed one after the other but was very disappointed last time I looked at code generated by both gcc and clang."}], "tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": false, "score": 1, "last_activity_date": 1504629374, "last_edit_date": 1504629374, "creation_date": 1504626847, "answer_id": 46059061, "question_id": 46058083, "link": "https://stackoverflow.com/questions/46058083/output-related-to-primes/46059061#46059061", "title": "output related to primes", "body": "<p>The <code>goto</code> statement is useless, it is exactly equivalent to a <code>break</code> statement in your case. It does not <em>break out of the <code>if</code> loop</em>, it breaks out of the <code>for</code> loop, which is exactly what <code>break</code> does.</p>\n\n<p>Furthermore, the inner loop is useless: if you divide <code>x</code> by <code>i</code>, you effectively remove the smaller primes from <code>x</code>, and <code>x % i == 0</code> will hold only for prime values of <code>i</code>.</p>\n\n<p>The problem in the output comes from the fact that you increment <code>i</code> even if <code>x</code> is a multiple of <code>i</code>. Therefore you only print a prime factor once and you do not remove it completely from <code>x</code>.</p>\n\n<p>The function can thus be simplified into:</p>\n\n<pre><code>void primefactors(int x) {\n    int i;             \n\n    for (i = 2; i &lt;= x;) {\n        if (x % i == 0) {\n            printf(\" %d\", i);\n            x = x / i;\n        } else {\n            i++;\n        }\n    }\n    printf(\"\\n\");\n}\n</code></pre>\n\n<p>The function can be made much faster: you can stop the scan when <code>i</code> is greater than the square root of <code>x</code>:</p>\n\n<pre><code>void primefactors(int x) {\n    int i;             \n\n    for (i = 2; i * i &lt;= x;) {\n        if (x % i == 0) {\n            printf(\" %d\", i);\n            x = x / i;\n        } else {\n            i += 1 + (i &amp; 1);  // skip even numbers\n        }\n    }\n    printf(\"%d\\n\", x);\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 743, "user_id": 2913477, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b126939c105b8d71b18f93c6850e55f1?s=128&d=identicon&r=PG&f=1", "display_name": "MiniMax", "link": "https://stackoverflow.com/users/2913477/minimax"}, "is_accepted": false, "score": 0, "last_activity_date": 1504640867, "last_edit_date": 1504640867, "creation_date": 1504632675, "answer_id": 46060456, "question_id": 46058083, "link": "https://stackoverflow.com/questions/46058083/output-related-to-primes/46060456#46060456", "title": "output related to primes", "body": "<p>My solution. I can add comments if you needed.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid prime_factors(int num) {\n    int i = 2;\n    while(num &gt; 1) {\n        while(num % i == 0) {\n            num /= i;   \n            printf(\"%d \", i); \n        }   \n        i++;\n    }   \n}\n\nint main() {\n    int num;\n\n    while(1) {\n        printf(\"%s\", \"Enter the number: \");\n\n        if(scanf(\"%d\", &amp;num) != 1)  \n            break;\n\n        // \\033[1;31m - changes text color to red\n        // \\033[0;0m  - resets color back to default\n        // It works on Linux, I don't know about Windows.\n        if(num &lt;= 1) {\n            puts(\"\\033[1;31mThe number must be greater than 1.\\033[0;0m\");\n            continue;\n        }   \n        puts(\"Prime factors are:\");\n\n        prime_factors(num);\n\n        puts(\"\\n\");\n    }   \n\n    return 0;\n}\n</code></pre>\n\n<p><strong>Testing:</strong></p>\n\n<pre><code>Enter the number: 24\nPrime factors are:\n2 2 2 3 \n\nEnter the number: 12\nPrime factors are:\n2 2 3 \n\nEnter the number: 1000\nPrime factors are:\n2 2 2 5 5 5\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 8537104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0c112836154bf83c4b449624561627f?s=128&d=identicon&r=PG&f=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/8537104/barry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1504640867, "creation_date": 1504623561, "last_edit_date": 1504626392, "question_id": 46058083, "link": "https://stackoverflow.com/questions/46058083/output-related-to-primes", "title": "output related to primes", "body": "<p>Only the function is written below</p>\n\n<p>Function of prime factors</p>\n\n<pre><code>void prime(int x) {\n    int i, j;             \n</code></pre>\n\n<p>wrote this because it wanted for information but don't have any</p>\n\n<pre><code>    for (i = 2; i &lt;= x; i++) {\n        if (x % i == 0) {\n            for (j = 2; j &lt;= i; j++) {\n                if (i == j) {\n                    printf(\"%d\", i);\n                } else\n                if ((i % j) != 0) {\n                    printf(\"%d\\n\", i);\n</code></pre>\n\n<p>The output should be prime numbers of the number and the repeated prime no.s also should be seen so by mutiplication we get the original number</p>\n\n<pre><code>                    goto l;\n</code></pre>\n\n<p>Here the <code>goto</code> statement takes out of <code>if</code> loop</p>\n\n<pre><code>                } else {\n                    break;\n                }\n            }\n        l: \n            x = x / i;\n        }\n    }\n}\n</code></pre>\n\n<p>Code seems to be correct and also is giving the prime numbers but is the factors are not repeating itself.</p>\n\n<p>for e.g: <code>24</code> output should be <code>2,2,3</code> but the output is coming as <code>2,3</code></p>\n"}, {"tags": ["c", "node.js", "sockets"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1504623835, "post_id": 46058058, "comment_id": 79076354, "body": "What you call &quot;virtual channels&quot; could easily be implemented with a very simple protocol, where each packet include something identifying the packet as sensor data message, an identifier for the sensor and of course the sensor data itself. Sending these packets several times every second is easier and much less work (not to mention less resourceful) than using multiple sockets. Try something like that first, and measure the throughput. If it&#39;s only over a local network it should not be a big problem."}, {"owner": {"reputation": 2628, "user_id": 1248638, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e85f0521e95f34c082c45467b731dc5d?s=128&d=identicon&r=PG", "display_name": "Ortix92", "link": "https://stackoverflow.com/users/1248638/ortix92"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1504623898, "post_id": 46058058, "comment_id": 79076386, "body": "@Someprogrammerdude Yeah I figured that would be much easier. Is there a resource I could read up on regarding this topic?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1504623967, "post_id": 46058058, "comment_id": 79076423, "body": "Or, you could send one packet containing all sensor data as an &quot;array&quot;? Might be even easier still. 400 bytes, times 50, is only 20000 bytes per second, not a large amount of data."}], "owner": {"reputation": 2628, "user_id": 1248638, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e85f0521e95f34c082c45467b731dc5d?s=128&d=identicon&r=PG", "display_name": "Ortix92", "link": "https://stackoverflow.com/users/1248638/ortix92"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1504623488, "creation_date": 1504623488, "question_id": 46058058, "link": "https://stackoverflow.com/questions/46058058/multiple-sockets-or-larger-packets-for-high-frequency-data-streams", "title": "Multiple sockets or larger packets for high frequency data streams?", "body": "<p>Im working on an application which uses NodeJS to communicate (as a client) with a socket exposed by a server (written in <code>C</code>). The server sends data from sensors and the client simply plots it.</p>\n\n<p>Suppose I have 100 plots and 100 sensors. Should I open 100 sockets with 100 different ports or should I create some sort of <em>virtual</em> channel inside a socket by sending larger packets?</p>\n\n<p>As it stands now I send 100 bytes at 50Hz where each byte is just dummy sensor data (<code>uint8</code>). Further down the road we will probably move to <code>uint32</code> to accommodate sensor data output, still transmitting at 50Hz. That would mean that each packet would be 400 bytes at 50Hz.</p>\n\n<p>In short: multiple sockets or virtual data channels inside the packet?</p>\n"}, {"tags": ["c", "segmentation-fault"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1504623341, "post_id": 46057962, "comment_id": 79075994, "body": "Is there a reason you made your own <code>len</code> function? And <i>where</i> in your code do the crash happen? Have you tried running in a debugger to catch the crash &quot;in action&quot;? Perhaps you should read <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">How to debug small programs</a> by Eric Lippert, and learn how to use a debugger?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 3, "creation_date": 1504623410, "post_id": 46057962, "comment_id": 79076043, "body": "Also please <a href=\"http://stackoverflow.com/help/how-to-ask\">read about how to ask good questions</a>, and learn how to create a <a href=\"http://stackoverflow.com/help/mcve\">Minimal, <b>Complete</b>, and Verifiable Example</a>. For example, you don&#39;t tell us how you <i>call</i> the <code>ricerca</code> function, and what you are passing for <code>percorso</code>."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 1, "creation_date": 1504623496, "post_id": 46057962, "comment_id": 79076113, "body": "In which <code>free</code> do you get that error? Are you aware that you might call <code>free(percorso)</code> twice without allocating memory in between?"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 2, "creation_date": 1504623533, "post_id": 46057962, "comment_id": 79076146, "body": "You need to debug this yourself. Or you may provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 310760, "user_id": 12711, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c330bdee507c95c603a93ca91d9145a9?s=128&d=identicon&r=PG", "display_name": "Michael Burr", "link": "https://stackoverflow.com/users/12711/michael-burr"}, "edited": false, "score": 0, "creation_date": 1504623945, "post_id": 46057962, "comment_id": 79076414, "body": "valgrind will probably point you right to the problem."}, {"owner": {"reputation": 33990, "user_id": 14768, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/b6aMa.png?s=128&g=1", "display_name": "Joshua", "link": "https://stackoverflow.com/users/14768/joshua"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1504624606, "post_id": 46057962, "comment_id": 79076824, "body": "@Someprogrammerdude: Got it! ricerca is recursive so we can indeed see how it is called."}, {"owner": {"reputation": 1639, "user_id": 2073349, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0266d3aafa1813f794a5b71058d5cd27?s=128&d=identicon&r=PG", "display_name": "Ritesh", "link": "https://stackoverflow.com/users/2073349/ritesh"}, "edited": false, "score": 0, "creation_date": 1504625151, "post_id": 46057962, "comment_id": 79077195, "body": "You have to ensure that percorso, the original string is NON NULL and if it is non NULL, then it has to be NULL terminated string. For verifying that len function is same as strlen, you may add assert(dim == strlen(percorso))"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1504659722, "post_id": 46057962, "comment_id": 79091289, "body": "regarding: <code>if (prov!=NULL)                 free(prov);</code>  the function: <code>free()</code> properly handles a NULL parameter, so no need to test the parameter first."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1504659871, "post_id": 46057962, "comment_id": 79091312, "body": "the OPs question is about a runtime problem.  BUT the OP did not supply run time code that we can use to expose the source of the problem.  Why should we debug this code?  To do so, we have to write the <code>main()</code> function AND supply dummy functions for those that are not present in the posted code.  As I see it, that is the OPs job to supply such code."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1504659975, "post_id": 46057962, "comment_id": 79091332, "body": "the <code>find()</code> function is using the variable <code>N</code>, which is not declared anywhere in the posted code."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1504660276, "post_id": 46057962, "comment_id": 79091395, "body": "the struct: <code>radice</code> is not defined anywhere in the posted code.   the struct: <code>stringhe</code> is not defined anywhere in the posted code.  The function: ricerca() doesn&#39;t have a prototype nor body.  The function: <code>insertion()</code> doesn&#39;t have a prototype nor body.  The function: <code>stampap()</code> doesn&#39;t have a prototype nor a body.  How do you expect us to determine what is wrong with your code if we cannot compile the code and certainly cannot experience the seg fault for ourselves?"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1504660433, "post_id": 46057962, "comment_id": 79091438, "body": "regarding: <code>prov = malloc(2 * dim * sizeof(char));</code>  1) the expression <code>sizeof(char)</code> is defined in the standard as 1.  using that expression in a call to <code>malloc()</code> just clutters the code and does not add any useful information.  2)  when calling any of the heap allocation functions: (malloc, calloc, realloc), always check (!=NULL) the returned value to assure the operation was successful."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1504660549, "post_id": 46057962, "comment_id": 79091461, "body": "what is the function: <code>len()</code>?  given the surrounding code, I suspect the code should have called <code>strlen()</code> from the <code>string.h</code> header file."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1504661105, "post_id": 46057962, "comment_id": 79091578, "body": "was the parameter: <code>percorso</code> generated via a call to one of the heap allocation functions?  If not, then that is the source of the problem.  We cannot tell due so very much necessary code is missing."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1504661194, "post_id": 46057962, "comment_id": 79091595, "body": "the heap allocation functions (malloc, calloc, realloc) expect the length parameter to be of type: <code>size_t</code> not <code>int</code>  however, most of the calls to <code>malloc()</code> are using the variable: <code>dim</code> which is an <code>int</code>"}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 8479184, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-wLm-FWtnkY4/AAAAAAAAAAI/AAAAAAAAAfk/zRQETQaX7sI/photo.jpg?sz=128", "display_name": "Alessio Fiorentino", "link": "https://stackoverflow.com/users/8479184/alessio-fiorentino"}, "edited": false, "score": 0, "creation_date": 1504625392, "post_id": 46058307, "comment_id": 79077326, "body": "I know that, but I do those free for decrease garbage."}, {"owner": {"reputation": 33990, "user_id": 14768, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/b6aMa.png?s=128&g=1", "display_name": "Joshua", "link": "https://stackoverflow.com/users/14768/joshua"}, "reply_to_user": {"reputation": 9, "user_id": 8479184, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-wLm-FWtnkY4/AAAAAAAAAAI/AAAAAAAAAfk/zRQETQaX7sI/photo.jpg?sz=128", "display_name": "Alessio Fiorentino", "link": "https://stackoverflow.com/users/8479184/alessio-fiorentino"}, "edited": false, "score": 0, "creation_date": 1504625456, "post_id": 46058307, "comment_id": 79077367, "body": "@AlessioFiorentino: It&#39;s freeing memory owned somewhere else."}, {"owner": {"reputation": 9, "user_id": 8479184, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-wLm-FWtnkY4/AAAAAAAAAAI/AAAAAAAAAfk/zRQETQaX7sI/photo.jpg?sz=128", "display_name": "Alessio Fiorentino", "link": "https://stackoverflow.com/users/8479184/alessio-fiorentino"}, "edited": false, "score": 0, "creation_date": 1504627447, "post_id": 46058307, "comment_id": 79078644, "body": "When i debug the code, i see that the first node of the chain has this problem. So if i check the content of that string i see the is not empty but with the next free istruction i&#39;ve the &quot;double free error&quot;."}], "tags": [], "owner": {"reputation": 33990, "user_id": 14768, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/b6aMa.png?s=128&g=1", "display_name": "Joshua", "link": "https://stackoverflow.com/users/14768/joshua"}, "is_accepted": false, "score": 1, "last_activity_date": 1504624813, "last_edit_date": 1504624813, "creation_date": 1504624353, "answer_id": 46058307, "question_id": 46057962, "link": "https://stackoverflow.com/questions/46057962/segmentation-fault-double-free-or-corruption-fast-top/46058307#46058307", "title": "Segmentation Fault: double free or corruption (fast top)", "body": "<p>This is really weird:</p>\n\n<pre><code>if (some condition)\n   free(percorso);\n</code></pre>\n\n<p>Later on we have:</p>\n\n<pre><code>    perc_orig = malloc(dim*sizeof(char));\n    for(something){\n        if(something){\n            ricerca(nome,punt-&gt;array-&gt;vet[i],perc_orig,indice);\n        }\n    }\n    free(perc_orig);\n</code></pre>\n\n<p>If that if conditions happens, perc_orig will be freed twice. Kaboom.</p>\n\n<p>I think your problem is you think that <code>ricerca(..., char percico[], ...)</code> copies percico. It doesn't; it's really <code>ricerca(..., char *percico, ...)</code> so you ended up freeing the memory twice.</p>\n"}, {"comments": [{"owner": {"reputation": 1618, "user_id": 4744142, "user_type": "registered", "accept_rate": 40, "profile_image": "https://graph.facebook.com/10205509523369034/picture?type=large", "display_name": "Michel Billaud", "link": "https://stackoverflow.com/users/4744142/michel-billaud"}, "edited": false, "score": 0, "creation_date": 1504624713, "post_id": 46058308, "comment_id": 79076897, "body": "The segmentation fault occurs when you dereference a badly initialized pointer. Putting the value <code>97</code> (<code>&#39;a&#39;</code>) in the pointer <code>a</code> will cause an undefined behaviour (probably a crash) when you&#39;ll use <code>*a</code> : because of  an attempt to memory location 97"}, {"owner": {"reputation": 1131, "user_id": 3448634, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/c1b5b4e95d700f849977e3c3e99b4ff7?s=128&d=identicon&r=PG&f=1", "display_name": "Makketronix", "link": "https://stackoverflow.com/users/3448634/makketronix"}, "edited": false, "score": 0, "creation_date": 1504651048, "post_id": 46058308, "comment_id": 79089369, "body": "what if the undefined behavior turned out to be segmentation fault in this case?"}], "tags": [], "owner": {"reputation": 1, "user_id": 8564276, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db330dcba2f35fbff2b9b6e0297cbb34?s=128&d=identicon&r=PG&f=1", "display_name": "Shashank Upadhya", "link": "https://stackoverflow.com/users/8564276/shashank-upadhya"}, "is_accepted": false, "score": -2, "last_activity_date": 1504625995, "last_edit_date": 1504625995, "creation_date": 1504624354, "answer_id": 46058308, "question_id": 46057962, "link": "https://stackoverflow.com/questions/46057962/segmentation-fault-double-free-or-corruption-fast-top/46058308#46058308", "title": "Segmentation Fault: double free or corruption (fast top)", "body": "<p>Segmentation fault occurs when you initialize a character pointer to <code>NULL</code> and try to point it to a not null value \nFor example,</p>\n\n<pre><code>char *a=NULL;\na='a';\n</code></pre>\n\n<p>Will cause segmentation fault. To avoid this you can try to initialize as,</p>\n\n<pre><code>char *a;\na='a';\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "is_accepted": false, "score": 0, "last_activity_date": 1504661449, "creation_date": 1504661449, "answer_id": 46065479, "question_id": 46057962, "link": "https://stackoverflow.com/questions/46057962/segmentation-fault-double-free-or-corruption-fast-top/46065479#46065479", "title": "Segmentation Fault: double free or corruption (fast top)", "body": "<p>the sizing for the char arrays needs to allow for the trailing NUL ('\\0') character.</p>\n\n<p>ALL fields that are referenced by <code>strcpy()</code> and similar functions need to have ALL source character arrays NUL terminated.</p>\n\n<p>The code does not seem to be allocating enough room for those trailing NUL bytes NOR terminating every character array with a NUL char.</p>\n"}], "owner": {"reputation": 9, "user_id": 8479184, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-wLm-FWtnkY4/AAAAAAAAAAI/AAAAAAAAAfk/zRQETQaX7sI/photo.jpg?sz=128", "display_name": "Alessio Fiorentino", "link": "https://stackoverflow.com/users/8479184/alessio-fiorentino"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 239, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1504661449, "creation_date": 1504623199, "last_edit_date": 1504625251, "question_id": 46057962, "link": "https://stackoverflow.com/questions/46057962/segmentation-fault-double-free-or-corruption-fast-top", "title": "Segmentation Fault: double free or corruption (fast top)", "body": "<p>I've a problem when I run this piece of code: a Segmentation Fault that appears during the <code>free</code> instruction of <code>percorso</code>. I cannot find the problem.</p>\n\n<pre><code>void ricerca(char nome[], struct node *radice, char percorso[], struct stringhe **indice) {\n    struct node *punt = radice;     \n    int dim = len(percorso);\n    char *prov = NULL;\n    if (dim &gt; 0) {\n        prov = malloc(2 * dim * sizeof(char));\n        prov[0] = '\\0';\n        strcpy(prov, percorso);\n        free(percorso);   //---------------------&gt;here the SegFault\n    }\n    struct stringhe *nuovo = NULL;\n    int i = 0, fine = 0;\n    char *perc_orig = NULL;\n\n    if (punt != NULL) {\n        if (punt-&gt;array != NULL) {\n            dim = len(prov) + len(punt-&gt;nome) + 2;\n            percorso = malloc(dim * sizeof(char));\n            percorso[0] = '\\0';\n            if (prov!=NULL)\n                strcpy(percorso, prov);\n            strcat(percorso, \"/\");\n            strcat(percorso, punt-&gt;nome);\n            perc_orig = malloc(dim * sizeof(char));\n            for (i = 0; i &lt; N; i++) {\n                if (punt-&gt;array-&gt;vet[i] != NULL) {\n                    perc_orig[0] = '\\0';\n                    strcpy(perc_orig, percorso);\n                    ricerca(nome, punt-&gt;array-&gt;vet[i], perc_orig,indice);\n                }\n            }\n            free(perc_orig);\n        }\n\n        if (strcmp(nome,punt-&gt;nome) == 0) {\n            free(percorso);\n            dim = len(prov) + len(punt-&gt;nome) + 2;\n            percorso = malloc(dim * sizeof(char));\n            inizializza(percorso, dim);\n            if (prov != NULL)\n                strcpy(percorso, prov);\n            strcat(percorso, \"/\");\n            strcat(percorso, punt-&gt;nome);\n            nuovo = malloc(sizeof(struct stringhe));\n            nuovo-&gt;next = NULL;\n            nuovo-&gt;str = malloc(dim * sizeof(char));\n            inizializza(nuovo-&gt;str, dim);\n            strcpy(nuovo-&gt;str, percorso);\n\n            nuovo-&gt;next = (*indice);\n            *indice = nuovo;\n        }           \n\n        while (punt-&gt;chain != NULL &amp;&amp; fine == 0) {\n            ricerca(nome, punt-&gt;chain,prov, indice);\n            fine = 1;\n            if (prov!=NULL)\n                free(prov);\n        }           \n    }       \n}\n</code></pre>\n\n<p>The <code>len</code> function is like <code>strlen</code>, but the difference is that I've made it myself.</p>\n\n<p>the context is:</p>\n\n<pre><code>void find(char nome[], struct node *radice) {\n    char *perc = NULL;\n    struct stringhe **inizio = NULL;\n    inizio = malloc(sizeof(struct stringhe*));\n    *inizio = NULL;\n    int i = 0;\n\n    for (i = 0; i &lt; N; i++) {\n        if (radice-&gt;array-&gt;vet[i] != NULL) {\n            perc = NULL;\n            ricerca(nome, radice-&gt;array-&gt;vet[i], perc, inizio);\n        }\n    }\n    if (*inizio != NULL) {\n        insertion(inizio);\n        stampap(*inizio);\n    } else\n        printf(\"no\\n\");\n}\n</code></pre>\n\n<p>And the data structures:</p>\n\n<pre><code>struct tab {\n    struct node *vet[64];\n};\n\nstruct node {\n    char nome[255];\n    int num;\n    int tipo;\n    char *dati;\n    struct tab *array;\n    struct node *chain;\n};\n</code></pre>\n"}, {"tags": ["c", "gcc", "openssl", "constants"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1504622566, "post_id": 46057628, "comment_id": 79075407, "body": "Not clear what your problem is. Just write const-correct code and check the declarations of the functions. If you don&#39;t know what the <code>const</code> qualifier is about, a good C book will help."}, {"owner": {"reputation": 1775, "user_id": 3715151, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/8gMtb.png?s=128&g=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/3715151/daniel"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1504622712, "post_id": 46057628, "comment_id": 79075528, "body": "@Olaf: What do you mean by &quot;write const-correct code and check the declarations of the functions&quot;? I currently can cast it to make the warning go away but I&#39;m not sure this is the correct way to do it."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1504622806, "post_id": 46057628, "comment_id": 79075599, "body": "Asking what this means clearly indicates you should follow my advice. And no, casts are <b>never</b> the correct way if you don&#39;t understand <b>why</b> an error or warning pops up!"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1504623117, "post_id": 46057628, "comment_id": 79075815, "body": "You deactivated by comment the <code>&#47;* const *&#47;</code>. What happens if you keep it active?"}, {"owner": {"reputation": 32098, "user_id": 646887, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YJ0Ye.jpg?s=128&g=1", "display_name": "Klas Lindb&#228;ck", "link": "https://stackoverflow.com/users/646887/klas-lindb%c3%a4ck"}, "edited": false, "score": 3, "creation_date": 1504623121, "post_id": 46057628, "comment_id": 79075820, "body": "If the function returns a pointer to const, then you probably aren&#39;t supposed to free the returned value."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "reply_to_user": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 1, "creation_date": 1504623233, "post_id": 46057628, "comment_id": 79075898, "body": "@Yunnosch depending on activating or deactivating the <code>const</code> he gets one of the 2 shown warning messages."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1504623259, "post_id": 46057628, "comment_id": 79075919, "body": "Ah, of course. Sorry."}, {"owner": {"reputation": 1775, "user_id": 3715151, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/8gMtb.png?s=128&g=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/3715151/daniel"}, "reply_to_user": {"reputation": 32098, "user_id": 646887, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YJ0Ye.jpg?s=128&g=1", "display_name": "Klas Lindb&#228;ck", "link": "https://stackoverflow.com/users/646887/klas-lindb%c3%a4ck"}, "edited": false, "score": 1, "creation_date": 1504623270, "post_id": 46057628, "comment_id": 79075929, "body": "@KlasLindb&#228;ck: &quot;If the function returns a pointer to const, then you probably aren&#39;t supposed to free it.&quot; --- The function <code>EC_KEY_get0_private_key</code> returns a <code>const BIGNUM *</code> but then I have to free this using <code>BN_free</code> which receives a <code>BIGNUM *</code>. So if I use const in the variable I get warning in one function call, if I don&#39;t use const I get a warning on the other function call. (I call free because of memory leaks.)"}, {"owner": {"reputation": 28330, "user_id": 298054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7dffcc86140441472cfb6119375a9d7?s=128&d=identicon&r=PG", "display_name": "jweyrich", "link": "https://stackoverflow.com/users/298054/jweyrich"}, "edited": false, "score": 0, "creation_date": 1504623398, "post_id": 46057628, "comment_id": 79076035, "body": "As mentioned by Daniel, you MUST NOT free the pointer returned by <code>EC_KEY_get0_private_key</code>."}, {"owner": {"reputation": 1775, "user_id": 3715151, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/8gMtb.png?s=128&g=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/3715151/daniel"}, "reply_to_user": {"reputation": 32098, "user_id": 646887, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YJ0Ye.jpg?s=128&g=1", "display_name": "Klas Lindb&#228;ck", "link": "https://stackoverflow.com/users/646887/klas-lindb%c3%a4ck"}, "edited": false, "score": 0, "creation_date": 1504623708, "post_id": 46057628, "comment_id": 79076259, "body": "@KlasLindb&#228;ck: Actually it seems you&#39;re right. I checked with valgrind and I get <code>in use at exit: 0 bytes in 0 blocks</code> even when I do <b>not</b> call <code>BN_free</code>."}, {"owner": {"reputation": 32098, "user_id": 646887, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YJ0Ye.jpg?s=128&g=1", "display_name": "Klas Lindb&#228;ck", "link": "https://stackoverflow.com/users/646887/klas-lindb%c3%a4ck"}, "edited": false, "score": 1, "creation_date": 1504623721, "post_id": 46057628, "comment_id": 79076269, "body": "@Daniel No new memory is allocated when you call <code>EC_KEY_get0_private_key</code>. See the answer of Kevin Boone."}], "answers": [{"comments": [{"owner": {"reputation": 28330, "user_id": 298054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7dffcc86140441472cfb6119375a9d7?s=128&d=identicon&r=PG", "display_name": "jweyrich", "link": "https://stackoverflow.com/users/298054/jweyrich"}, "edited": false, "score": 1, "creation_date": 1504623759, "post_id": 46058064, "comment_id": 79076291, "body": "OpenSSL&#39;s documentation is indeed horrific - too many things are badly documented or not documented at all. I can&#39;t blame them - few people can understand it well enough to the point of documenting it properly."}, {"owner": {"reputation": 1775, "user_id": 3715151, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/8gMtb.png?s=128&g=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/3715151/daniel"}, "edited": false, "score": 0, "creation_date": 1504624198, "post_id": 46058064, "comment_id": 79076563, "body": "I confirmed with valgrind that there are no leaks, thank you. I read the man pages of these functions (and I&#39;ve been looking into the OpenSSL wiki) but this behavior wasn&#39;t clear to me."}], "tags": [], "owner": {"reputation": 3725, "user_id": 8471208, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-zX6iRd9pmRI/AAAAAAAAAAI/AAAAAAAAAgE/F3-J9H4ZCno/photo.jpg?sz=128", "display_name": "Kevin Boone", "link": "https://stackoverflow.com/users/8471208/kevin-boone"}, "is_accepted": true, "score": 6, "last_activity_date": 1504973922, "last_edit_date": 1504973922, "creation_date": 1504623502, "answer_id": 46058064, "question_id": 46057628, "link": "https://stackoverflow.com/questions/46057628/the-const-conundrum-in-openssl/46058064#46058064", "title": "The const conundrum in OpenSSL", "body": "<p>It looks to me as if the EC_KEY object holds its own copy of the BIGNUM that models the private key:</p>\n\n<pre><code>int EC_KEY_set_private_key(EC_KEY *key, const BIGNUM *prv);\n</code></pre>\n\n<p>So when you get a <code>BIGNUM*</code> by calling <code>EC_KEY_get0_private_key()</code>, I think you're getting a reference to an internal object in the EC_KEY structure. If so, freeing it would be a mistake.</p>\n\n<p>If you had to call a function to allocate a BIGNUM before calling <code>EC_KEY_set_private_key()</code>, you could probably free it afterwards, if you didn't need it again, because a copy would be stored in EC_KEY.</p>\n\n<p>This doesn't seem to be well-documented -- I'm guessing based on the C programming conventions rather than actual knowledge.</p>\n\n<p>Using valgrind or similar might help to track down where the memory leak is really coming from.</p>\n"}, {"tags": [], "owner": {"reputation": 57, "user_id": 9216472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vLyBd.png?s=128&g=1", "display_name": "themadking", "link": "https://stackoverflow.com/users/9216472/themadking"}, "is_accepted": false, "score": 1, "last_activity_date": 1577126802, "creation_date": 1577126802, "answer_id": 59459971, "question_id": 46057628, "link": "https://stackoverflow.com/questions/46057628/the-const-conundrum-in-openssl/59459971#59459971", "title": "The const conundrum in OpenSSL", "body": "<p>Adding onto what Kevin Boone said in his answer, it might be useful to remember the difference between getter functions containing <strong>get0</strong> and <strong>get1</strong>.</p>\n\n<ul>\n<li><p><strong>get0</strong> - A reference to the internal object/structure is returned and your application doesn't need to free the memory, OpenSSL takes care of it.</p></li>\n<li><p><strong>get1</strong> - The memory needs to be freed by you by calling the appropriate <strong>free</strong> function.</p></li>\n</ul>\n"}], "owner": {"reputation": 1775, "user_id": 3715151, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/8gMtb.png?s=128&g=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/3715151/daniel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 480, "favorite_count": 0, "accepted_answer_id": 46058064, "answer_count": 2, "score": 0, "last_activity_date": 1577126802, "creation_date": 1504622238, "last_edit_date": 1504625492, "question_id": 46057628, "link": "https://stackoverflow.com/questions/46057628/the-const-conundrum-in-openssl", "title": "The const conundrum in OpenSSL", "body": "<p>In OpenSSL, some functions require the use of const but then down the road others require me to not use const for the same variable. An example is when I create a new <code>BIGNUM</code> I need to use const but then to free it I cannot have const.</p>\n\n<p>Is there a trick to solve this? What would be the proper why to get rid of the compiler warnings?</p>\n\n<hr>\n\n<p>Function signatures:</p>\n\n<pre><code>const BIGNUM *EC_KEY_get0_private_key(const EC_KEY *key);\nvoid BN_free(BIGNUM *a);\n</code></pre>\n\n<p>Offending code:</p>\n\n<pre><code>EC_KEY *ec_key = ...;\n/*const*/ BIGNUM *bignum = NULL;\nbignum = EC_KEY_get0_private_key(ec_key);\nBN_free(bignum);\n</code></pre>\n\n<p>Compiler warnings:</p>\n\n<pre><code>------------Without const in bignum------------:\nwarning: assignment discards \u2018const\u2019 qualifier from pointer target type [-Wdiscarded-qualifiers]\n  bignum = EC_KEY_get0_private_key(ec_key);\n     ^\n\n------------With const in bignum------------:\nwarning: passing argument 1 of \u2018BN_free\u2019 discards \u2018const\u2019 qualifier from pointer target type [-Wdiscarded-qualifiers]\n  BN_free(bignum);\n          ^\nIn file included from /usr/include/openssl/asn1.h:74:0,\n                 from /usr/include/openssl/objects.h:965,\n                 from /usr/include/openssl/evp.h:94,\n                 from ecdh.c:5:\n/usr/include/openssl/bn.h:493:6: note: expected \u2018BIGNUM * {aka struct bignum_st *}\u2019 but argument is of type \u2018const BIGNUM * {aka const struct bignum_st *}\u2019\n void BN_free(BIGNUM *a);\n</code></pre>\n\n<hr>\n\n<p><strong>Edit</strong> to add working example:</p>\n\n<pre><code>#include &lt;openssl/evp.h&gt;\n#include &lt;openssl/ec.h&gt;\n#include &lt;openssl/bn.h&gt;\n\nint main()\n{\n    EC_KEY *ec_key = NULL;\n    const BIGNUM *bignum = NULL;\n\n    ec_key = EC_KEY_new_by_curve_name(NID_X9_62_prime256v1);\n    bignum = EC_KEY_get0_private_key(ec_key);\n\n    //BN_free(bignum);    // unnecessary\n    EC_KEY_free(ec_key);\n    return 0;\n}\n//$ gcc -g -Wall -Wextra -o leak_ecdh leak_ecdh.c -lcrypto &amp;&amp; valgrind --leak-check=yes ./leak_ecdh\n//==26202== HEAP SUMMARY:\n//==26202==     in use at exit: 0 bytes in 0 blocks\n//==26202==   total heap usage: 104 allocs, 104 frees, 4,220 bytes allocated\n//==26202== \n//==26202== All heap blocks were freed -- no leaks are possible\n</code></pre>\n"}, {"tags": ["c", "struct", "typedef"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 3, "creation_date": 1504621923, "post_id": 46057500, "comment_id": 79074918, "body": "You don&#39;t need to use either of them in C++, so I&#39;m removing the C++ tag."}, {"owner": {"reputation": 3577, "user_id": 2176813, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/Nv7lK.jpg?s=128&g=1", "display_name": "tambre", "link": "https://stackoverflow.com/users/2176813/tambre"}, "edited": false, "score": 2, "creation_date": 1504621933, "post_id": 46057500, "comment_id": 79074923, "body": "C != C++. Please only a question once you know what language you want to ask about."}, {"owner": {"reputation": 61304, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1504621961, "post_id": 46057500, "comment_id": 79074950, "body": "c or c++ ? I does make a difference because in c++ you would not write <code>typedef struct Data {...</code> unless you try hard to make your code look like c"}, {"owner": {"reputation": 435637, "user_id": 367273, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/f1ed2b0c87f602ef30229f5c4b04eff6?s=128&d=identicon&r=PG", "display_name": "NPE", "link": "https://stackoverflow.com/users/367273/npe"}, "edited": false, "score": 0, "creation_date": 1504622007, "post_id": 46057500, "comment_id": 79074986, "body": "<a href=\"https://stackoverflow.com/questions/3371169/why-using-a-typedef-after-struct-definition\" title=\"why using a typedef after struct definition\">stackoverflow.com/questions/3371169/&hellip;</a>"}, {"owner": {"reputation": 49, "user_id": 6072864, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/091da849f1ba091343016612f2efd4ab?s=128&d=identicon&r=PG", "display_name": "user178831", "link": "https://stackoverflow.com/users/6072864/user178831"}, "edited": false, "score": 0, "creation_date": 1504622419, "post_id": 46057500, "comment_id": 79075275, "body": "My mistake. No excuse for including C++ in there. My question is about C. Thanks for removing the tag @NeilButterworth."}], "answers": [{"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1504622335, "post_id": 46057611, "comment_id": 79075210, "body": "Note that without the <code>typedef</code>, the C++ code would use <code>Data2_t</code> while C would use <code>struct Data2_t</code> (rather than <code>Data2</code> \u2014 I&#39;d make it <code>struct Data2 { \u2026 }</code>).  Also note that POSIX makes a grab for the <code>_t</code> suffix \u2014 you run the risk of conflicting with POSIX headers when you use it.  (And yes, I&#39;ve seen it happen, and yes, it causes headaches.)"}, {"owner": {"reputation": 27546, "user_id": 6266, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/398efb709eb606ef79ee6436f55f93bd?s=128&d=identicon&r=PG", "display_name": "Fire Lancer", "link": "https://stackoverflow.com/users/6266/fire-lancer"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1504622454, "post_id": 46057611, "comment_id": 79075311, "body": "Its still valid for the C++ to use the typedefed one, the other one is often not even a really a &quot;published&quot; name in most C libraries. and yes about the <code>_t</code>. between Win32 and POSIX everything is a pain..."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1504622662, "post_id": 46057611, "comment_id": 79075486, "body": "Many C libraries \u2014 look at POSIX, for example, and also the Linux kernel (which isn&#39;t a library, but\u2026) \u2014 only use <code>struct DoHickey</code> and not a <code>typedef struct DoHickey DoHickey;</code> in sight.  At least when the type is not intended to be opaque.  (So <code>DIR</code> is an opaque type, but <code>struct dirent</code> is one you poke around inside.)"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1504622783, "post_id": 46057611, "comment_id": 79075585, "body": "Note, the only minor criticism here is the use of <code>_t</code> \u2014 and that&#39;s a rule that&#39;s often breached.  The rest is just minor clarification.  Sorry about the amount of noise."}, {"owner": {"reputation": 27546, "user_id": 6266, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/398efb709eb606ef79ee6436f55f93bd?s=128&d=identicon&r=PG", "display_name": "Fire Lancer", "link": "https://stackoverflow.com/users/6266/fire-lancer"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1504622911, "post_id": 46057611, "comment_id": 79075679, "body": "Actually i think its all over :) I happened to have zlib headers open for somthing and they are using <code>_s</code> and typedefs (and also some nice <code>alloc_func</code>, <code>internal_state</code>, etc. things to trip users over...) and libssh2 is using <code>_LIBSSH2</code> prefix so another broken rule :(. Mostly my point was in C++ because <code>struct</code>  isnt needed to use it, that developers tend to just not bother since the question was tagged at the time."}], "tags": [], "owner": {"reputation": 27546, "user_id": 6266, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/398efb709eb606ef79ee6436f55f93bd?s=128&d=identicon&r=PG", "display_name": "Fire Lancer", "link": "https://stackoverflow.com/users/6266/fire-lancer"}, "is_accepted": false, "score": 0, "last_activity_date": 1504622522, "last_edit_date": 1504622522, "creation_date": 1504622170, "answer_id": 46057611, "question_id": 46057500, "link": "https://stackoverflow.com/questions/46057500/are-these-two-implementations-of-typedef-with-a-structure-equivalent/46057611#46057611", "title": "Are these two implementations of typedef with a structure equivalent?", "body": "<p>Yes, they both typedef <code>Data</code> to <code>struct Data</code>, allthough often people would use different names to avoid confusion.</p>\n\n<p>Note that in C++, you dont need the <code>struct</code> part at all when using the type, so its common to not have the <code>typedef</code> at all. The same applies to <code>enum</code>, etc.</p>\n\n<pre><code>struct Data\n{\n    int x;\n    int y;\n};\nvoid foo1(Data data); // OK in C++\nvoid foo2(struct Data data); // OK in C or C++, but almost never seen in C++\n\n\ntypedef struct Data2_\n{\n    int x;\n    int y;\n}Data2;\nvoid foo3(Data2 data); // OK in C or C++, but C++ code tends to skip the typedef as well\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 6072864, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/091da849f1ba091343016612f2efd4ab?s=128&d=identicon&r=PG", "display_name": "user178831", "link": "https://stackoverflow.com/users/6072864/user178831"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "closed_date": 1504622178, "answer_count": 1, "score": 0, "last_activity_date": 1504622522, "creation_date": 1504621858, "last_edit_date": 1504621930, "question_id": 46057500, "link": "https://stackoverflow.com/questions/46057500/are-these-two-implementations-of-typedef-with-a-structure-equivalent", "closed_reason": "Duplicate", "title": "Are these two implementations of typedef with a structure equivalent?", "body": "<p>What, if any, are the differences between these two implementations of typedef with a structure?</p>\n\n<pre><code>typedef struct Data{\n    int x;\n    int y;\n} Data;\n</code></pre>\n\n<p>and </p>\n\n<pre><code>struct Data{\n    int x;\n    int y;\n};\ntypedef struct Data Data;\n</code></pre>\n"}, {"tags": ["c", "c-strings", "char-pointer"], "comments": [{"owner": {"reputation": 2815, "user_id": 1462295, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/ts6jy.jpg?s=128&g=1", "display_name": "BurnsBA", "link": "https://stackoverflow.com/users/1462295/burnsba"}, "edited": false, "score": 3, "creation_date": 1504620672, "post_id": 46057088, "comment_id": 79073986, "body": "There&#39;s no string type in c. So you can&#39;t send &quot;the value&quot; to printf, if that makes sense. You can only send the first address to the array of characters."}, {"owner": {"reputation": 2815, "user_id": 1462295, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/ts6jy.jpg?s=128&g=1", "display_name": "BurnsBA", "link": "https://stackoverflow.com/users/1462295/burnsba"}, "edited": false, "score": 0, "creation_date": 1504620749, "post_id": 46057088, "comment_id": 79074043, "body": "3 is a duplicate, for example <a href=\"https://stackoverflow.com/questions/1335786/c-differences-between-char-pointer-and-array\" title=\"c differences between char pointer and array\">stackoverflow.com/questions/1335786/&hellip;</a>"}, {"owner": {"reputation": 714, "user_id": 8563383, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8NAmw.jpg?s=128&g=1", "display_name": "Gaurav Pant", "link": "https://stackoverflow.com/users/8563383/gaurav-pant"}, "reply_to_user": {"reputation": 2815, "user_id": 1462295, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/ts6jy.jpg?s=128&g=1", "display_name": "BurnsBA", "link": "https://stackoverflow.com/users/1462295/burnsba"}, "edited": false, "score": 0, "creation_date": 1504620750, "post_id": 46057088, "comment_id": 79074046, "body": "Why not put *ptr ?"}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1504620771, "post_id": 46057088, "comment_id": 79074055, "body": "<a href=\"https://stackoverflow.com/questions/562303/the-definitive-c-book-guide-and-list\">Pick a book, any book</a>"}, {"owner": {"reputation": 15569, "user_id": 2302862, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e264db339bb96e343770fa38018e00f1?s=128&d=identicon&r=PG", "display_name": "Siguza", "link": "https://stackoverflow.com/users/2302862/siguza"}, "edited": false, "score": 0, "creation_date": 1504620809, "post_id": 46057088, "comment_id": 79074083, "body": "@GauravPant Because that would be a single char."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1504620911, "post_id": 46057088, "comment_id": 79074157, "body": "&quot;Why should I send  the address instead of the value&quot; --&gt; consider if the string was 100s, or millions of bytes long.  Certainly easier to pass to the function the beginning address of the string rather than the value."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1504620912, "post_id": 46057088, "comment_id": 79074160, "body": "<code>*ptr</code> is of type char. You cannot assign a string literal to a character."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1504623975, "post_id": 46057088, "comment_id": 79076431, "body": "Read a beginners C book and learn about pointers and arrays. Instead asking this elementary questions read. Everything is in the books"}], "answers": [{"tags": [], "owner": {"reputation": 4398, "user_id": 3697264, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/5adc5afbd7a1145fdd762d872b4b43bb?s=128&d=identicon&r=PG", "display_name": "SPlatten", "link": "https://stackoverflow.com/users/3697264/splatten"}, "is_accepted": false, "score": 3, "last_activity_date": 1565861179, "last_edit_date": 1565861179, "creation_date": 1504620858, "answer_id": 46057185, "question_id": 46057088, "link": "https://stackoverflow.com/questions/46057088/use-of-pointers-on-strings/46057185#46057185", "title": "Use of pointers on strings", "body": "<p>\"*\" when used with a pointer means get the contents of what the pointer points to, in the case of:</p>\n\n<pre><code>    char* ptr;\n</code></pre>\n\n<p>ptr is a pointer to a character, you can assign it to a string like so:</p>\n\n<pre><code>   const char* ptr = \"test\";\n</code></pre>\n\n<p>The layout in memory of this is \"t\" followed by \"e\", \"s\", \"t\" and then finally a nul terminator '\\0'.</p>\n\n<p>When you assign it like ptr as above its assigning the pointer to the first memory location which happens to be a \"t\".</p>\n\n<p>*ptr returns the contents of what ptr points to and is always the size of the type it is declared as in this example a \"char\", single byte.</p>\n\n<p>*(++ptr) would return \"e\", as the ptr is incremented to the next location before returning the contents of what it now points to.</p>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1504621141, "post_id": 46057224, "comment_id": 79074317, "body": "Best to use <code>NULL</code> (uppercase) for the <i>null pointer constant</i> as used in the context of pointers.  Suggest to use &quot;the <i>null character</i> aka <code>&#39;\\0&#39;</code>)&quot; to match the C spec&#39;s style."}, {"owner": {"reputation": 6309, "user_id": 717822, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f7e6a550ddff2d2288933bfd21d49a14?s=128&d=identicon&r=PG", "display_name": "perror", "link": "https://stackoverflow.com/users/717822/perror"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1504621250, "post_id": 46057224, "comment_id": 79074396, "body": "I knew I was writing something strange when I wrote it... I fully agree."}, {"owner": {"reputation": 714, "user_id": 8563383, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8NAmw.jpg?s=128&g=1", "display_name": "Gaurav Pant", "link": "https://stackoverflow.com/users/8563383/gaurav-pant"}, "edited": false, "score": 0, "creation_date": 1504621939, "post_id": 46057224, "comment_id": 79074930, "body": "*p = &#39;M&#39; should work according to you since it&#39;s a char"}, {"owner": {"reputation": 6309, "user_id": 717822, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f7e6a550ddff2d2288933bfd21d49a14?s=128&d=identicon&r=PG", "display_name": "perror", "link": "https://stackoverflow.com/users/717822/perror"}, "edited": false, "score": 0, "creation_date": 1504622088, "post_id": 46057224, "comment_id": 79075050, "body": "Yes, but I meant &quot;Same as above...&quot; to match the case where it was dealing with <code>*p</code>. Not, &quot;Same as above...&quot; just a line above... Hmmm, not clear indeed... I rewrite the last sentence, then."}, {"owner": {"reputation": 6309, "user_id": 717822, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f7e6a550ddff2d2288933bfd21d49a14?s=128&d=identicon&r=PG", "display_name": "perror", "link": "https://stackoverflow.com/users/717822/perror"}, "edited": false, "score": 0, "creation_date": 1504622204, "post_id": 46057224, "comment_id": 79075126, "body": "Tell me if you better understand this way."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 2, "creation_date": 1504622462, "post_id": 46057224, "comment_id": 79075313, "body": "@perror still not quite clear. You should make clear that <code>p</code> is a pointer to a string literal, and that modifying a string literal yields in UB. But <code>*p = &#39;M&#39;</code> is of course syntactically correct. You should distinguish between compilation errors and runtime errors. <code>str++; </code> won&#39;t compile.  <code>*p = &#39;M&#39;</code> compiles but will yield in UB at runtime (most likely crash on modern systems)."}, {"owner": {"reputation": 714, "user_id": 8563383, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8NAmw.jpg?s=128&g=1", "display_name": "Gaurav Pant", "link": "https://stackoverflow.com/users/8563383/gaurav-pant"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1504623412, "post_id": 46057224, "comment_id": 79076046, "body": "@MichaelWalz is right, the program is not executing"}, {"owner": {"reputation": 6309, "user_id": 717822, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f7e6a550ddff2d2288933bfd21d49a14?s=128&d=identicon&r=PG", "display_name": "perror", "link": "https://stackoverflow.com/users/717822/perror"}, "edited": false, "score": 0, "creation_date": 1504624849, "post_id": 46057224, "comment_id": 79076991, "body": "Hum, the answer of Michael Walz is quite good. In fact, I do not feel right to paraphrase what he said in my answer. His comment is a good complement to my answer, I do not want to stole the paternity of it. But, you two are right, I should have detailed this point. Sorry."}], "tags": [], "owner": {"reputation": 6309, "user_id": 717822, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f7e6a550ddff2d2288933bfd21d49a14?s=128&d=identicon&r=PG", "display_name": "perror", "link": "https://stackoverflow.com/users/717822/perror"}, "is_accepted": true, "score": 5, "last_activity_date": 1504625603, "last_edit_date": 1504625603, "creation_date": 1504621008, "answer_id": 46057224, "question_id": 46057088, "link": "https://stackoverflow.com/questions/46057088/use-of-pointers-on-strings/46057224#46057224", "title": "Use of pointers on strings", "body": "<pre><code>char *ptr;\nptr = \"apple\"; // shouldn't it be *ptr =      \"apple\"\n</code></pre>\n\n<p>No, because <code>*ptr</code> would be a <code>char</code>. So, you may write <code>*ptr = 'a'</code> but you can't write as you suggest.</p>\n\n<pre><code>printf(\"%s\", ptr) // Why should I send  the address instead of the value\n</code></pre>\n\n<p>Because a string in C, is the address of a sequence of characters (<code>char</code>) terminated by zero (the null character aka <code>\\x0</code>).</p>\n\n<pre><code>char str[] = \"Quest\";\nchar *p = \"Quest\";\n\nstr++; // error, constant pointer can't change\n</code></pre>\n\n<p>No, a pointer can perfectly change, but here, <code>str</code> is an array (which is slightly different from being a pointer). But, thus, it cannot deal with pointer arithmetic.</p>\n\n<pre><code>*str='Z'; // works, because pointer is not constant\n</code></pre>\n\n<p>No, it works because <code>*str</code> should be a <code>char</code>.</p>\n\n<pre><code>p++; // works, because pointer is not constant\n</code></pre>\n\n<p>No, it works because, this time, this is a pointer (not an array).</p>\n\n<pre><code>*p = 'M'; // error, because string is constant\n</code></pre>\n\n<p>Same as above, this is a <code>char</code> again, so it works because it is the right type and not because the string is 'constant'. And, as stated by Michael Walz in the comments, even though it might compile, it will produce an undefined behavior at runtime (most likely a crash with <code>segfault</code>) because the specification do not tell if the string pointed by <code>*p</code> is read-only or not (yet, it seems that most of the modern compilers implementation decide to make it in read-only). Which might produce a <code>segfault</code>. </p>\n\n<p>For more information, refer to <a href=\"https://stackoverflow.com/questions/1704407/what-is-the-difference-between-char-s-and-char-s\">this SO question</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 1554, "user_id": 4935567, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a57653ee2ddf94addd6fb6d2d059a131?s=128&d=identicon&r=PG&f=1", "display_name": "Masked Man", "link": "https://stackoverflow.com/users/4935567/masked-man"}, "is_accepted": false, "score": 2, "last_activity_date": 1504621365, "creation_date": 1504621365, "answer_id": 46057330, "question_id": 46057088, "link": "https://stackoverflow.com/questions/46057088/use-of-pointers-on-strings/46057330#46057330", "title": "Use of pointers on strings", "body": "<ol>\n<li><p><code>\"SOME STRING\"</code> creates a char sequence in memory ending in <code>\\0</code> and returns its first char address so you can assign it to a pointer: <br/>\n<code>char *ptr = \"Hello\";</code></p></li>\n<li><p><code>printf</code> function also works with addresses and the type specifier define how it should read data from memory.</p></li>\n<li><p><code>char str[]=\"Quest\";\nchar *p=\"Quest\";</code><br/>\nin the first  one you are creating an array with 6 rooms and storing <code>'Q', 'u', 'e', 's', 't', '\\0'</code> in it, and then you can change some index value by <code>str[2] = 'x'</code> but the array name itself is a constant that has the address to the first location it points to so you can't change it with something like <code>str++;</code><br/>\nBut in the second one <code>\"Quest\\0\"</code> is a constant string saved into some location in memory and its first memory location stored in <code>p</code> so you can't change that but the pointer itself is not a <code>const</code> and you can do <code>p++;</code>.</p></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "is_accepted": false, "score": 2, "last_activity_date": 1504623006, "creation_date": 1504623006, "answer_id": 46057887, "question_id": 46057088, "link": "https://stackoverflow.com/questions/46057088/use-of-pointers-on-strings/46057887#46057887", "title": "Use of pointers on strings", "body": "<p>I'm only going to answer subquestion 1.  But you've touched on a frequent but subtle confusion in C, a slight mismatch between the way you initialize a pointer, versus assign to that pointer.  Watch carefully.</p>\n\n<p>If I have an <code>int</code> variable, I can either initialize it when I declare it:</p>\n\n<pre><code>int i = 42;\n</code></pre>\n\n<p>Or, I can declare it on one line (without initializing it), and give it a value later:</p>\n\n<pre><code>int i;\ni = 42;\n</code></pre>\n\n<p>No mystery there.  But when pointers are involved, it looks a little different.  Again, I can declare and initialize on one line:</p>\n\n<pre><code>char *ptr = \"apple\";\n</code></pre>\n\n<p>Or I can split the declaration and the assignment:</p>\n\n<pre><code>char *ptr;\nptr = \"apple\";\n</code></pre>\n\n<p>But, that looks weird at first -- based on the first syntax, shouldn't the second way look like this?</p>\n\n<pre><code>*ptr = \"apple\";         // WRONG\n</code></pre>\n\n<p>No, it shouldn't, and here's why.</p>\n\n<p><code>ptr</code> is a pointer to some characters.  It is one way of referring to a string in C.</p>\n\n<p><code>*</code> is the pointer-indirection operator.  In an expression, <code>*ptr</code> refers to the character (just the one character) that <code>ptr</code> points to.  So if we wanted to fetch the first character of the string, we could use <code>*</code> to do that:</p>\n\n<pre><code>printf(\"first character: %c\\n\", *ptr);\n</code></pre>\n\n<p>Note that the format in this <code>printf</code> call uses <code>%c</code>, because it's just printing one character.</p>\n\n<p>We can also assign pointers.  If we're using pointers to <code>char</code>, and if we're therefore thinking of those pointers as \"strings\", this is one way of doing string assignment in C.  If I say</p>\n\n<pre><code>ptr = \"apple\";\n</code></pre>\n\n<p>then no matter where <code>ptr</code> used to point, now it points to an array of characters containing the string \"apple\".  And if I later say</p>\n\n<pre><code>ptr = \"pear\";\n</code></pre>\n\n<p>then <code>ptr</code> doesn't point to the string \"apple\" any more; now it points to a different array of characters containing the string \"pear\".  You can think of this pointer sort of as if it's assigning all of the characters of the string at once (although that's not actually what it's doing, at all).</p>\n\n<p>So if <code>*ptr</code> accesses just one character, and <code>ptr</code> is the pointer value itself, then why does the first form</p>\n\n<pre><code>char *ptr = \"apple\";\n</code></pre>\n\n<p>work?</p>\n\n<p>The answer is that when you say</p>\n\n<pre><code>char *ptr = \"apple\";\n</code></pre>\n\n<p>the <code>*</code> that shows up in there is not the pointer-indirection operator.  It is not saying that we are trying to access the first character of anything.</p>\n\n<p>When you say</p>\n\n<pre><code>char *ptr = \"apple\";\n</code></pre>\n\n<p>the <code>*</code> is saying that <code>ptr</code> is a pointer.  It's just like when you say</p>\n\n<pre><code>char *ptr;\n</code></pre>\n\n<p>the <code>*</code> is saying that <code>ptr</code> is a pointer.</p>\n\n<p>C' declaration syntax for pointers is a little weird.  Here's how to think about it.  The syntax is</p>\n\n<p><em>type-name</em>     <em>thing-that-has-that-type</em> <code>;</code></p>\n\n<p>So when we say</p>\n\n<pre><code>char *ptr;\n</code></pre>\n\n<p>the <em>type-name</em> is <code>char</code>, and the <em>thing-that-has-that-type</em> is <code>*ptr</code>.\nWe're saying that <code>*ptr</code> will be a <code>char</code>.  And if <code>*ptr</code> will be a <code>char</code>, that means that <code>ptr</code> must be a pointer-to-<code>char</code>.</p>\n\n<p>And then, when we say</p>\n\n<pre><code>char *ptr = \"apple\";\n</code></pre>\n\n<p>we're saying that <code>ptr</code> (which we've just got done saying is a pointer-to-<code>char</code>) should have as its initial value a pointer to an array containing the string \"apple\".</p>\n"}, {"tags": [], "owner": {"reputation": 491, "user_id": 8509272, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/487ff5fe4697aeb326fa5092ef38f116?s=128&d=identicon&r=PG&f=1", "display_name": "savram", "link": "https://stackoverflow.com/users/8509272/savram"}, "is_accepted": false, "score": 3, "last_activity_date": 1504625804, "creation_date": 1504625804, "answer_id": 46058754, "question_id": 46057088, "link": "https://stackoverflow.com/questions/46057088/use-of-pointers-on-strings/46058754#46058754", "title": "Use of pointers on strings", "body": "<p>1- I think you are making some confusion with variable declaration and definition. This line:</p>\n\n<pre><code>char *ptr = \"apple\";\n</code></pre>\n\n<p>declares a pointer to char and assigns the address of the first character \"a\" to the variable ptr. This line is equivalent to the following 2:</p>\n\n<pre><code>char* ptr;\nptr = \"apple\";\n</code></pre>\n\n<p>Now, string literals in C are read only. They are implicitly constant, it's the same as doing</p>\n\n<pre><code>const char* ptr;\n</code></pre>\n\n<p>So in fact, you can not change the contents of the location this pointer points to. Now, even if you could, the way you did it is wrong. Because ptr points to the location of the first character of the string, when you do *ptr you are accessing the contents of the first char of that string. So it expects a char, not a string. So it would be something like: <code>*ptr = 'a'</code>;</p>\n\n<p>2-\nWell, that's the way printf works. If you want to print a string with the %s specifier, it expects a pointer to that string, the address of the string's first character, not the string's value itself.</p>\n\n<p>3- Now I'm going to comment your code.</p>\n\n<pre><code>str++; // error, constant pointer can't change\n</code></pre>\n\n<p>You are correct. Other people keep saying that arrays and pointers are slightly different, but they are not. Arrays are just an abstraction for the programmer to say that you're storing a sequence of values. At the assembly level, there is no difference at all. You could say that arrays are immutable pointers with mutable contents. An array stores the address of the first element of the sequence of values. You can change the contents of the array, but you can't change the address(the first element it points to).</p>\n\n<pre><code>*str='Z'; // works, because pointer is not constant\n</code></pre>\n\n<p>Now you're making some confusion. The pointer is actually constant, that is, you can not change the address it stores. But you can change the content the address points to, which is what the line above is doing. It's changing the first value of the sequence of values from the array.</p>\n\n<pre><code>p++; // works, because pointer is not constant\n</code></pre>\n\n<p>Correct. The pointer is not constant, although the content it points to is. You can change the address the pointer stores, but not the value it points at. String literals are mutable pointers to immutable strings.</p>\n\n<pre><code>*p = 'M'; // error, because string is constant\n</code></pre>\n\n<p>Correct, the string is immutable.</p>\n"}, {"tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": false, "score": 2, "last_activity_date": 1504651850, "creation_date": 1504651850, "answer_id": 46064369, "question_id": 46057088, "link": "https://stackoverflow.com/questions/46057088/use-of-pointers-on-strings/46064369#46064369", "title": "Use of pointers on strings", "body": "<blockquote>\n  <p><code>ptr = \"apple\"; // shouldn't it be *ptr = \"apple\"</code></p>\n</blockquote>\n\n<p>Starting from the beginning...</p>\n\n<p>The <em>string literal</em> <code>\"apple\"</code> is stored in a 6-element array of <code>char</code>, like so:</p>\n\n<pre><code>+---+---+---+---+---+---+\n|'a'|'p'|'p'|'l'|'e'| 0 |\n+---+---+---+---+---+---+\n</code></pre>\n\n<p>The trailing <code>0</code> marks the end of the string (it's called the <em>string terminator</em>).  </p>\n\n<p>When an expression of type \"N-element array of <code>T</code>\" appears in an expression, it will be converted (\"decay\") to an expression of type \"pointer to <code>T</code>\" and the value of the expression will be the address of the first element of the array, <em>unless</em> the array expression is the operand of the <code>sizeof</code> or unary <code>&amp;</code> operators, or is used to initialize a character array in a declaration.</p>\n\n<p>Thus, in the statement</p>\n\n<pre><code>ptr = \"apple\";\n</code></pre>\n\n<p>the expression <code>\"apple\"</code> is converted (\"decays\") from an expression of type \"6-element array of <code>char</code>\" to \"pointer to <code>char</code>\".  The type of the expression <code>ptr</code> is <code>char *</code>, or \"pointer to <code>char</code>\"; thus, in the assignment above, <code>ptr</code> will receive the address of the first element of <code>\"apple\"</code>.  </p>\n\n<p>It should <em>not</em> be written as</p>\n\n<pre><code>*ptr = \"apple\";\n</code></pre>\n\n<p>since the expression <code>*ptr</code> evaluates to the value of the thing <code>ptr</code> points to, which at this point is a) indeterminate, and b) the wrong type for the assignment.  The type of the expression <code>*ptr</code> is <code>char</code>, which is not compatible with <code>char *</code>.  </p>\n\n<p>I've written a utility that prints a map of items in memory; given the code</p>\n\n<pre><code>char *ptr = \"apple\";\nchar arr[] = \"apple\";\n</code></pre>\n\n<p>the map looks something like this:</p>\n\n<pre><code>       Item         Address   00   01   02   03\n       ----         -------   --   --   --   --\n      apple        0x400c80   61   70   70   6c    appl\n                   0x400c84   65   00   70   74    e.pt\n\n        ptr  0x7fffcb4d4518   80   0c   40   00    ..@.\n             0x7fffcb4d451c   00   00   00   00    ....\n\n        arr  0x7fffcb4d4510   61   70   70   6c    appl\n             0x7fffcb4d4514   65   00   00   00    e...\n</code></pre>\n\n<p>The string literal <code>\"apple\"</code> lives at address <code>0x400c80</code><sup>1</sup>.  The variables <code>ptr</code>  and <code>arr</code> live at addresses <code>0x7fffcb4d4518</code> and <code>0x7fffcb4d4510</code>, respectively<sup>2</sup>.  </p>\n\n<p>The variable <code>ptr</code> contains the value <code>0x400c80</code>, which is the address of the first element of the <code>\"apple\"</code> string literal (x86 stores multi-byte values in \"little-endian\" order, so the least-significant byte comes first, meaning you have to read right-to-left).</p>\n\n<p>Remember the \"except\" clause above?  In the second declaration, the string literal <code>\"apple\"</code> is being used to initialize an <em>array</em> of <code>char</code> in a declaration; instead of being converted to a pointer value, the <em>contents</em> of the string literal are copied to the array, which you can see in the memory dump.</p>\n\n<blockquote>\n  <ol start=\"2\">\n  <li><code>printf(\"%s\", ptr) // Why should I send  the address instead of the value</code></li>\n  </ol>\n</blockquote>\n\n<p>Because that's what the <code>%s</code> conversion specifier <em>expects</em> - it takes a pointer to the first character of a 0-terminated string, and will print out the sequence of characters starting at that location until it sees the terminator.  </p>\n\n<blockquote>\n  <p>3 ... I can't understand what is supposed to imply</p>\n</blockquote>\n\n<p>You cannot change the value of an array object.  Let's look at what <code>str</code> would look like in memory:</p>\n\n<pre><code>     +---+\nstr: |'Q'| str[0]\n     +---+\n     |'u'| str[1]\n     +---+\n     |'e'| str[2]\n     +---+\n     |'s'| str[3]\n     +---+\n     |'t'| str[4]\n     +---+\n     | 0 | str[5]\n     +---+ \n</code></pre>\n\n<p>You can write to each <code>str[i]</code><sup>3</sup> (changing its value), but you cannot write to <code>str</code> because there's nothing to write <em>to</em>.  There's no <code>str</code> object separate from the array elements.  Even though the <em>expression</em> <code>str</code> will \"decay\" to a pointer value, no storage is set aside anywhere for that pointer - the conversion is done at compile time.  </p>\n\n<p>Similarly, attempting to modify the contents of a string literal invokes <em>undefined behavior</em><sup>4</sup>; you may get a segfault, <em>or</em> your code may work as expected, <em>or</em> you may wind up launching nukes at Liechtenstein.  So you can't write to <code>*p</code> or <code>p[i]</code>; however, you <em>can</em> write a new value to <code>p</code>, pointing it to a different location.  </p>\n\n<p><hr>\n<sup></p>\n\n<ol>\n<li>Techically, it's <code>0x0000000000400c80</code>; the <code>%p</code> specifier drops leading zeros.\n<li>Same deal - technically, the values are <code>0x000000007fffcb4d4518</code> and <code>0x000000007fffcb4d4510</code>.  Note that the specific address values will change from run to run.  \n<li><code>*str</code> is equivalent to <code>str[0]</code>\n<li>The C language definition identifies certain operations which are erroneous, but doesn't place any requirements on the compiler to handle that code in any particular way.  Different platforms store string literals in different ways; some put them in read-only memory, so attempting to modify them results in a segfault, while other platforms store them in a writable segment so that the operation succeeds.  Some may store them in such a way that you don't get a segfault, but the string isn't changed.  \n</ol>\n\n<p></sup></p>\n"}], "owner": {"reputation": 714, "user_id": 8563383, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8NAmw.jpg?s=128&g=1", "display_name": "Gaurav Pant", "link": "https://stackoverflow.com/users/8563383/gaurav-pant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 986, "favorite_count": 0, "accepted_answer_id": 46057224, "answer_count": 6, "score": 4, "last_activity_date": 1565861179, "creation_date": 1504620571, "last_edit_date": 1504623539, "question_id": 46057088, "link": "https://stackoverflow.com/questions/46057088/use-of-pointers-on-strings", "title": "Use of pointers on strings", "body": "<p>I am really confused about the use of pointers on strings.\nIt feels like they obey different rules.\nConsider the following code</p>\n\n<ol>\n<li><pre><code>char *ptr = \"apple\";// perfectly valid here not when declaring afterwards like next\n\nptr = \"apple\"; // shouldn't it be *ptr = \"apple\"\n</code></pre></li>\n<li><p>Also <code>printf()</code> behaves differently -</p>\n\n<pre><code>printf(\"%s\", ptr) // Why should I send  the address instead of the value\n</code></pre></li>\n<li><p>Also I came across the following code in a book</p>\n\n<pre><code>char str[]=\"Quest\";\nchar *p=\"Quest\";\n\nstr++; // error, constant pointer can't change\n\n*str='Z'; // works, because pointer is not constant\n\np++; // works, because pointer is not constant\n\n*p = 'M'; // error, because string is constant\n</code></pre></li>\n</ol>\n\n<p>I can't understand what is supposed to imply</p>\n\n<p>Please help, I can't find any info anywhere else</p>\n"}, {"tags": ["python", "c", "wrapper"], "comments": [{"owner": {"reputation": 13419, "user_id": 1405588, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/01a91a47db3526000ffa9247f95fff62?s=128&d=identicon&r=PG", "display_name": "o11c", "link": "https://stackoverflow.com/users/1405588/o11c"}, "edited": false, "score": 0, "creation_date": 1504620746, "post_id": 46056980, "comment_id": 79074039, "body": "I don&#39;t understand your restriction, but you should always use <code>cffi</code> (in one of its 4 modes) rather than ctypes."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1504621885, "post_id": 46056980, "comment_id": 79074888, "body": "What is &quot;python script&quot;? Is that something like JavaScript (which has nothing to do with Java)?"}, {"owner": {"reputation": 53, "user_id": 8564032, "user_type": "registered", "profile_image": "https://graph.facebook.com/1809776962380679/picture?type=large", "display_name": "Jack Vu", "link": "https://stackoverflow.com/users/8564032/jack-vu"}, "edited": false, "score": 0, "creation_date": 1504622185, "post_id": 46056980, "comment_id": 79075114, "body": "python script is just my way of saying python code. Sorry if that confusing"}], "owner": {"reputation": 53, "user_id": 8564032, "user_type": "registered", "profile_image": "https://graph.facebook.com/1809776962380679/picture?type=large", "display_name": "Jack Vu", "link": "https://stackoverflow.com/users/8564032/jack-vu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 70, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1504620241, "creation_date": 1504620241, "question_id": 46056980, "link": "https://stackoverflow.com/questions/46056980/how-to-call-c-function-in-python-without-cdll", "title": "how to call C function in python without cdll", "body": "<p>I am trying to create a simple script to test calling a C function in python script. </p>\n\n<p>There are solution that using ctypes (load cdll wrapper) but for my application that i will load those script (using micro python interpreter) on to a MCU and it wont have any system file. </p>\n\n<p>Is there other way to call C function in python ?</p>\n\n<p>thanks </p>\n\n<p>sample code if using ctypes :</p>\n\n<p>C:</p>\n\n<pre><code>int our_function(int num_numbers, int *numbers) {\n    int i;\n    int sum;\n    for (i = 0; i &lt; num_numbers; i++) {\n        sum += numbers[i];\n    }\n    return sum;\n}\n</code></pre>\n\n<p>compile with gcc first</p>\n\n<p>python:</p>\n\n<pre><code>import ctypes\nimport sum\n\n_sum = ctypes.CDLL('libsum.so')\n_sum.our_function.argtypes = (ctypes.c_int, ctypes.POINTER(ctypes.c_int))\n\ndef our_function(numbers):\n    global _sum\n    num_numbers = len(numbers)\n    array_type = ctypes.c_int * num_numbers\n    result = _sum.our_function(ctypes.c_int(num_numbers), array_type(*numbers))\n    return int(result)\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1504617277, "post_id": 46055897, "comment_id": 79071402, "body": "try to google: why gets is dangerous."}, {"owner": {"reputation": 7, "user_id": 8521297, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d550ef46c831bbe51b5254047f719a3?s=128&d=identicon&r=PG&f=1", "display_name": "SrikantShrekk", "link": "https://stackoverflow.com/users/8521297/srikantshrekk"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1504617589, "post_id": 46055897, "comment_id": 79071655, "body": "I just edited it.. even with fgets , the error come is this  In function main: test.c:10:2: error: too few arguments to function fgets fgets(PS); ^ In file included from test.c:1:0: /usr/include/stdio.h:622:14: note: declared here extern char *fgets (char *__restrict __s, int __n, FILE *__restrict __stream) ^"}, {"owner": {"reputation": 7, "user_id": 8521297, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d550ef46c831bbe51b5254047f719a3?s=128&d=identicon&r=PG&f=1", "display_name": "SrikantShrekk", "link": "https://stackoverflow.com/users/8521297/srikantshrekk"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1504617645, "post_id": 46055897, "comment_id": 79071694, "body": "Hey Jean ... I tried with fgets too but I told in the above comment the error I get."}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 1, "creation_date": 1504618373, "post_id": 46055897, "comment_id": 79072245, "body": "&quot;I tried with fgets&quot;-- <a href=\"http://port70.net/~nsz/c/c11/n1570.html#7.21.7.2\" rel=\"nofollow noreferrer\">read the documentation</a> for the <a href=\"http://man7.org/linux/man-pages/man3/fgets.3.html\" rel=\"nofollow noreferrer\">functions that you use</a>; don&#39;t guess how they work."}, {"owner": {"reputation": 7, "user_id": 8521297, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d550ef46c831bbe51b5254047f719a3?s=128&d=identicon&r=PG&f=1", "display_name": "SrikantShrekk", "link": "https://stackoverflow.com/users/8521297/srikantshrekk"}, "edited": false, "score": 0, "creation_date": 1504618919, "post_id": 46055897, "comment_id": 79072680, "body": "i finally replaced gets(PS) with fgets(PS, sizeof(PS), stdin); . my first test case passed but in the 2nd test case it went on to a infinite loop &quot;AL@baL@baL@baL@baL ....&quot; and that too it is in loop considereing the strings before # .. I hope u got it.."}, {"owner": {"reputation": 7, "user_id": 8521297, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d550ef46c831bbe51b5254047f719a3?s=128&d=identicon&r=PG&f=1", "display_name": "SrikantShrekk", "link": "https://stackoverflow.com/users/8521297/srikantshrekk"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1504619351, "post_id": 46055897, "comment_id": 79073008, "body": "@Jean-Fran&#231;oisFabre : Why don&#39;t you wait on earth to sort the problem out by asker before voting it as a duplicate. There&#39;s always a second face to coin. Not all are same."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1504619456, "post_id": 46055897, "comment_id": 79073093, "body": "because it doesn&#39;t add anything useful to the site. Same questions and same answers (possibly good) all over again."}, {"owner": {"reputation": 7, "user_id": 8521297, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d550ef46c831bbe51b5254047f719a3?s=128&d=identicon&r=PG&f=1", "display_name": "SrikantShrekk", "link": "https://stackoverflow.com/users/8521297/srikantshrekk"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1504619528, "post_id": 46055897, "comment_id": 79073155, "body": "@Jean-Fran&#231;oisFabre : I faced a new problem. I already posted. Can you help me out?"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 1, "creation_date": 1504619708, "post_id": 46055897, "comment_id": 79073303, "body": "If you have a new problem, post it as a separate question."}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1504619748, "post_id": 46055897, "comment_id": 79073333, "body": "@SrikantShrekk-- don&#39;t modify your question when you have a new question; post a new question (and maybe search SO for duplicates first)."}, {"owner": {"reputation": 7, "user_id": 8521297, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d550ef46c831bbe51b5254047f719a3?s=128&d=identicon&r=PG&f=1", "display_name": "SrikantShrekk", "link": "https://stackoverflow.com/users/8521297/srikantshrekk"}, "reply_to_user": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1504619919, "post_id": 46055897, "comment_id": 79073459, "body": "@DavidBowling : If I do that the first thing people will do it mark as duplicate. It&#39;s pity. There&#39;s an option to modify which will let users know what I did, and probably people won&#39;t mark me fake."}, {"owner": {"reputation": 7, "user_id": 8521297, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d550ef46c831bbe51b5254047f719a3?s=128&d=identicon&r=PG&f=1", "display_name": "SrikantShrekk", "link": "https://stackoverflow.com/users/8521297/srikantshrekk"}, "reply_to_user": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1504620209, "post_id": 46055897, "comment_id": 79073663, "body": "@dbush : I&#39;m not pointing this at you but because of some non-patient people, after marking it duplicate crates the problem for the asker. Now, for the next 7 days I can&#39;t ask a new question just because they gave one advice and marked duplicate. I understand few guys are good at coding but doesn&#39;t mean in a minute you&#39;ll mark as duplicate. TRY TO UNDERSATND. I edited. sorted out. But now I cant post new question. Atleast give a breathe to the asker to think and edit."}], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 8521297, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d550ef46c831bbe51b5254047f719a3?s=128&d=identicon&r=PG&f=1", "display_name": "SrikantShrekk", "link": "https://stackoverflow.com/users/8521297/srikantshrekk"}, "edited": false, "score": 0, "creation_date": 1504619641, "post_id": 46056017, "comment_id": 79073253, "body": "Thank you @dbush @ TobySpeight  .. Your above comment helped me for my first test case but in the 2nd test case it went on to a infinite loop &quot;AL@baL@baL@baL@baL ....&quot; and that too it is in loop considering the strings before # .. I hope u got it."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 2, "last_activity_date": 1504618283, "last_edit_date": 1504618283, "creation_date": 1504617549, "answer_id": 46056017, "question_id": 46055897, "link": "https://stackoverflow.com/questions/46055897/the-first-test-case-passed-but-2nd-test-cases-output-went-to-an-infinite-loop/46056017#46056017", "title": "The first test case passed but 2nd test case&#39;s output went to an infinite loop. And only evaluating before the # part of the string (2nd test case)", "body": "<p>The <code>gets</code> function is dangerous because it places no limit on the number of characters entered.</p>\n\n<p>For example given the following code:</p>\n\n<pre><code>char str[10];\ngets(str);\n</code></pre>\n\n<p>If the user were to enter a string 10 characters or longer, the result would be written off the end of the array.  Doing so invokes <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">undefined behavior</a>.</p>\n\n<p>A safer alternative is the <code>fgets</code> function which has the following signature:</p>\n\n<pre><code>char *fgets(char *s, int size, FILE *stream);\n</code></pre>\n\n<p>The first parameter is the buffer to receive the string, and the second is the size of that buffer.  In your case you would call it like this:</p>\n\n<pre><code>fgets(PS, sizeof(PS), stdin);\n</code></pre>\n\n<p>Note that unlike <code>gets</code>, <code>fgets</code> will store a newline character in the resulting string if there is space for it.</p>\n"}], "owner": {"reputation": 7, "user_id": 8521297, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d550ef46c831bbe51b5254047f719a3?s=128&d=identicon&r=PG&f=1", "display_name": "SrikantShrekk", "link": "https://stackoverflow.com/users/8521297/srikantshrekk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 263, "favorite_count": 0, "closed_date": 1504618562, "accepted_answer_id": 46056017, "answer_count": 1, "score": -3, "last_activity_date": 1504619195, "creation_date": 1504617155, "last_edit_date": 1504619195, "question_id": 46055897, "link": "https://stackoverflow.com/questions/46055897/the-first-test-case-passed-but-2nd-test-cases-output-went-to-an-infinite-loop", "closed_reason": "Duplicate", "title": "The first test case passed but 2nd test case&#39;s output went to an infinite loop. And only evaluating before the # part of the string (2nd test case)", "body": "<p>Question:-\nWrite a program that replaces the occurence of a given character (say c)\nin a primary string (say PS) with another string (say s).</p>\n\n<p>Input:\nThe first line contains the primary string (PS)\nThe next line contains a character (c)\nThe next line contains a string (s)</p>\n\n<p>Output:\nPrint the string PS with every occurence of c replaced by s.</p>\n\n<p>NOTE:\n - There are no whitespaces in PS or s. \n - Maximum length of PS is 100.\n - Maximum length of s is 10.</p>\n\n<p>Test Case- </p>\n\n<pre><code>1) Input:\n\nabcxy\nb\ngh\n\nOutput:- aghxy\n\n2) Input:\n\nAl@bal#20owL\nl\nLL\n\nOutput:- ALL@baLL#20owL\n</code></pre>\n\n<p>This is the code I wrote:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;string.h&gt;\nint main()\n{\nchar PS[105];\nchar Final[105];\nchar ch;\nint i;\nfgets(PS, sizeof(PS), stdin);\nscanf(\"%c\",&amp;ch);\nscanf(\"%s\",Final);\nfor(i=0;i&lt;strlen(PS);i++)\n    {\n    if(PS[i]==ch)\n    {\n    for(i=0;i&lt;strlen(Final);i++)\n    printf(\"%c\",Final[i]);\n    }\n        else\n    printf(\"%c\",PS[i]);\n    }\n\n\nreturn 0;\n</code></pre>\n\n<p>}</p>\n"}, {"tags": ["c", "function", "pointers", "struct"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1504616812, "post_id": 46055731, "comment_id": 79071034, "body": "Read just about any <a href=\"http://stackoverflow.com/questions/562303/the-definitive-c-book-guide-and-list\">good beginners book</a>. They should have chapters on how to use pointers, including pointers to structures."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1504617060, "post_id": 46055731, "comment_id": 79071234, "body": "See answer by SPlatten and note the use of pointers (<code>*</code>) and address of (<code>&amp;</code>) operators. And read book."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 1, "creation_date": 1504617965, "post_id": 46055731, "comment_id": 79071947, "body": "You old function, i.e. <code>void init_struct(struct general){</code> is wrong and can&#39;t have been the one used"}, {"owner": {"reputation": 85822, "user_id": 597607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jCzJi.png?s=128&g=1", "display_name": "Bo Persson", "link": "https://stackoverflow.com/users/597607/bo-persson"}, "edited": false, "score": 0, "creation_date": 1504619094, "post_id": 46055731, "comment_id": 79072811, "body": "The way you name and group members indicates that there might be some smaller structs trying to get out. It&#39;s not at all unusual to start with some small structs and then use them to build the next level. And unless <code>ydln</code> and <code>gnls</code> are well known terms in the problem domain, I would try to use some names that are more easy to read."}, {"owner": {"reputation": 337, "user_id": 3490804, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6cd18e760451dc9e68e7ef7df90169a5?s=128&d=identicon&r=PG", "display_name": "Vivek Vijayan", "link": "https://stackoverflow.com/users/3490804/vivek-vijayan"}, "edited": false, "score": 0, "creation_date": 1504622052, "post_id": 46055731, "comment_id": 79075015, "body": "Read about pointers to structures and array of pointers."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1504626781, "post_id": 46055731, "comment_id": 79078204, "body": "Do you have any working code? Post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> then. We don&#39;t need all 300 of the struct members, 3 is enough for a demo. We then can discuss what&#39;s wrong with your current approach. As of now there isn&#39;t any approach to be seen, just a bunch of lines vaguely resembling C code."}], "answers": [{"comments": [{"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1504618813, "post_id": 46055818, "comment_id": 79072583, "body": "Seems to me that there is a <code>typedef</code>"}, {"owner": {"reputation": 4398, "user_id": 3697264, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/5adc5afbd7a1145fdd762d872b4b43bb?s=128&d=identicon&r=PG", "display_name": "SPlatten", "link": "https://stackoverflow.com/users/3697264/splatten"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1504618885, "post_id": 46055818, "comment_id": 79072650, "body": "Yes, there is, but it isn&#39;t being used."}], "tags": [], "owner": {"reputation": 4398, "user_id": 3697264, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/5adc5afbd7a1145fdd762d872b4b43bb?s=128&d=identicon&r=PG", "display_name": "SPlatten", "link": "https://stackoverflow.com/users/3697264/splatten"}, "is_accepted": true, "score": 0, "last_activity_date": 1504618869, "last_edit_date": 1504618869, "creation_date": 1504616964, "answer_id": 46055818, "question_id": 46055731, "link": "https://stackoverflow.com/questions/46055731/sending-pointers-of-structs-to-a-function-in-c/46055818#46055818", "title": "Sending Pointers of Structs to a Function in C", "body": "<p>To pass a pointer to your array element, you just prefix the parameter with &amp;, make sure you declare the function correctly:</p>\n\n<pre><code>    void init_struct(HUDL* pGeneral){\n        if ( pGeneral != NULL ) {\n    //This will ensure the entire structure contains '0'\n           memset(pGeneral, 0, sizeof(HUDL));\n    ...initialize members...\n        }\n    }\n\n    int main(){\n        HUDL general[10];\n\n        for( int i=0; i&lt;(sizeof(general) / sizeof(general[0])); i++ ) {\n            init_struct(&amp;general[i]);\n        }\n    }\n</code></pre>\n\n<p>I'm not sure why you haven't used the typedef 'HUDL' makes life a lost easier and code easier to read.</p>\n"}, {"comments": [{"owner": {"reputation": 4398, "user_id": 3697264, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/5adc5afbd7a1145fdd762d872b4b43bb?s=128&d=identicon&r=PG", "display_name": "SPlatten", "link": "https://stackoverflow.com/users/3697264/splatten"}, "edited": false, "score": 0, "creation_date": 1504680021, "post_id": 46056787, "comment_id": 79097172, "body": "You can&#39;t use the non const local variable num in the array declaration."}, {"owner": {"reputation": 4398, "user_id": 3697264, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/5adc5afbd7a1145fdd762d872b4b43bb?s=128&d=identicon&r=PG", "display_name": "SPlatten", "link": "https://stackoverflow.com/users/3697264/splatten"}, "edited": false, "score": 0, "creation_date": 1504680149, "post_id": 46056787, "comment_id": 79097234, "body": "The example would be better rewritten using a class instead of a structure."}, {"owner": {"reputation": 337, "user_id": 3490804, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6cd18e760451dc9e68e7ef7df90169a5?s=128&d=identicon&r=PG", "display_name": "Vivek Vijayan", "link": "https://stackoverflow.com/users/3490804/vivek-vijayan"}, "reply_to_user": {"reputation": 4398, "user_id": 3697264, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/5adc5afbd7a1145fdd762d872b4b43bb?s=128&d=identicon&r=PG", "display_name": "SPlatten", "link": "https://stackoverflow.com/users/3697264/splatten"}, "edited": false, "score": 0, "creation_date": 1504692690, "post_id": 46056787, "comment_id": 79105541, "body": "I bet it would be.. but only if we had class in C. Thanks for pointing out the other issue...I have changed the variable to be a predefined value."}], "tags": [], "owner": {"reputation": 337, "user_id": 3490804, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6cd18e760451dc9e68e7ef7df90169a5?s=128&d=identicon&r=PG", "display_name": "Vivek Vijayan", "link": "https://stackoverflow.com/users/3490804/vivek-vijayan"}, "is_accepted": false, "score": 0, "last_activity_date": 1504692165, "last_edit_date": 1504692165, "creation_date": 1504619683, "answer_id": 46056787, "question_id": 46055731, "link": "https://stackoverflow.com/questions/46055731/sending-pointers-of-structs-to-a-function-in-c/46056787#46056787", "title": "Sending Pointers of Structs to a Function in C", "body": "<p>A slightly cleaner and better approach would be to have a constructor and destructor function to allocate memory dynamically to structure and free it after use.</p>\n\n<pre><code>static void HUDL_destroy(HUDL* ptr)\n{\n  if(ptr)\n  {\n    //...any other clean up that needs to be done goes here..\n    free(ptr);\n  }\n}\n\nstatic HUDL* HUDL_create()\n{\n  HUDL* ptr = malloc(sizeof(HUDL));\n\n  if(!ptr)\n    return NULL;\n\n  //do initialization bits...\n  init_struct(ptr);\n\n  return ptr;\n}\n\nint main()\n{\n  //allocate and initialise structure\n  HUDL *general = HUDL_create();\n\n  //do stuff...\n\n  //free structure after use\n  HUDL_destroy(general);\n\n}\n</code></pre>\n\n<p>You might need an array of pointers in your case. So modify your main()  accordingly.</p>\n\n<pre><code>int main()\n{\n  //we need an array of structure pointers\n  HUDL* general[SIZE];\n\n  //allocate and initialize structure\n  for(int i=0; i&lt;SIZE; i++)\n    general[i] = HUDL_create();\n\n  //do stuff...\n\n  //free structure after use\n  for(i=0; i&lt;SIZE; i++)\n    HUDL_destroy( general[i] );\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 491, "user_id": 8509272, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/487ff5fe4697aeb326fa5092ef38f116?s=128&d=identicon&r=PG&f=1", "display_name": "savram", "link": "https://stackoverflow.com/users/8509272/savram"}, "is_accepted": false, "score": 1, "last_activity_date": 1504620868, "last_edit_date": 1504620868, "creation_date": 1504620035, "answer_id": 46056902, "question_id": 46055731, "link": "https://stackoverflow.com/questions/46055731/sending-pointers-of-structs-to-a-function-in-c/46056902#46056902", "title": "Sending Pointers of Structs to a Function in C", "body": "<p>There's a couple of things wrong on your code.\nFirst of, your function definition is wrong because you omit the parameter name. Your function definition should look like this:</p>\n\n<pre><code>void init_struct(struct general mygeneralstruct){}\n</code></pre>\n\n<p>Alternatively, you could use an alias for your struct using typedef, like so:</p>\n\n<pre><code>typedef struct {\n  int a;\n} general;\n</code></pre>\n\n<p>In which case, your function declaration could look like this:</p>\n\n<pre><code>void init_struct(general mygeneralstruct){}\n</code></pre>\n\n<p>You have the same problem when you declare your array of structures. You omit the name of your variable. Instead of</p>\n\n<pre><code>struct general[10];\n</code></pre>\n\n<p>it should be </p>\n\n<pre><code>struct general mygeneralstruct[10]\n</code></pre>\n\n<p>or \n<code>general mygeneralstruct[10]</code>(typedef)</p>\n\n<p>Finally, you can't change your array of structures by passing each structure's value to the function. You need to pass each structure's address instead.\nYour function declaration should then be(using typedef):</p>\n\n<pre><code>void init_struct(general* mygeneralstruct){}\n</code></pre>\n\n<p>and the code in the loop:</p>\n\n<pre><code>init_struct(&amp;mygeneralstruct[i]);\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user8506163"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 143, "favorite_count": 0, "accepted_answer_id": 46055818, "answer_count": 3, "score": 1, "last_activity_date": 1504692165, "creation_date": 1504616706, "last_edit_date": 1504625513, "question_id": 46055731, "link": "https://stackoverflow.com/questions/46055731/sending-pointers-of-structs-to-a-function-in-c", "title": "Sending Pointers of Structs to a Function in C", "body": "<p>I don't love this, but I have a struct with nearly 45 members inside; all are characters or character arrays. That said, I am going to need to optimize the way I initialize each struct. Ordinarily, I would pass the entire object into my init_struct() function, but I feel like that is not the best way to do this. </p>\n\n<p>How would I create and use a pointer to the struct to accomplish this?</p>\n\n<p>Old Method would look something like this:</p>\n\n<pre><code>void init_struct(struct general){\n...initialize members...\n}\n\nint main(){\n  struct general[10];\n\n  for(int i = 0 ; i &lt; 10 ; ++i){\n     init_struct(general[i];\n  }\n\n}\n</code></pre>\n\n<p>Since this struct is so large, as I said nearly 45 members inside it, I think a point to the struct would go a long way in optimizing this process. How would I accomplish that?</p>\n\n<hr>\n\n<p>Just in case you need, here is the typedef for my struct</p>\n\n<pre><code>typedef struct\n{ \n  //Basically, everything we want to read from HUDL should be here...\n  int play_num;\n  char down;\n  char dist[3];\n  char ydln[4];\n  char gnls[3];\n  char hash[3];\n  char home[20];\n  char away[20];\n  char odk[2];\n  char qtr[2];\n  char series[3];\n  char result[20];\n  char penalty[20];\n\n  char act_cb[20]; //How do they act post-snap\n  char act_dl[20];\n  char act_lb[20];\n  char act_ol[20];\n  char act_qb[20];\n  char act_rb[20];\n  char act_saf[20];\n\n  char aln_cb[20]; //How do they align pre-snap\n  char aln_dl[20];\n  char aln_lb[20];\n  char aln_ol[20];\n  char aln_qb[20];\n  char aln_rb[20];\n  char aln_saf[20];\n  char aln_wr[20];\n\n  char blitz[20];\n  char box_cnt[3];\n  char saf_count[20];\n  char coverage[20];\n  char cvr_basic[20];\n  char def_front[20]; \n  char mtn_def[20];\n  char num_rush[3];\n\n  char off_form[20];\n  char form_var[20];\n  char motion[20];\n  char off_pro[20];\n  char off_play[20];\n  char play_var[20];\n  char personnel[20];\n  char play_type[20];\n\n\n  char time[2]; \n  char score_diff[4];\n  char field_zone[2];\n  char dd_type[2];\n  char form_strength[2];\n\n} HUDL; // MAXIMUM of 63 Members\n</code></pre>\n"}, {"tags": ["c", "gcc", "inline-assembly"], "comments": [{"owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "edited": false, "score": 3, "creation_date": 1504615473, "post_id": 46055305, "comment_id": 79069996, "body": "What machine/architecture/platform is this? Looks like MC68k but I&#39;m not familiar with those suffixes."}, {"owner": {"reputation": 330, "user_id": 4454877, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0129832b19e0227f7085a5782b34b85?s=128&d=identicon&r=PG&f=1", "display_name": "Retr0id", "link": "https://stackoverflow.com/users/4454877/retr0id"}, "edited": false, "score": 6, "creation_date": 1504615571, "post_id": 46055305, "comment_id": 79070077, "body": "As a guess, I&#39;d say &quot;f&quot; means forwards, and &quot;b&quot; means backwards. These may also be hints to the CPU&#39;s  branch predictor. Knowing what the architecture is would help."}, {"owner": {"reputation": 33092, "user_id": 5801661, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D8ENZ.jpg?s=128&g=1", "display_name": "Margaret Bloom", "link": "https://stackoverflow.com/users/5801661/margaret-bloom"}, "edited": false, "score": 2, "creation_date": 1504616174, "post_id": 46055305, "comment_id": 79070552, "body": "If you are using AS, those are <a href=\"ftp://ftp.gnu.org/old-gnu/Manuals/gas/html_chapter/as_5.html#SEC48\" rel=\"nofollow noreferrer\">Local symbols</a>."}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 1, "creation_date": 1504616960, "post_id": 46055305, "comment_id": 79071147, "body": "yes 2f = 2: looking forward the next one you find.  1b 1: looking backward.  do some experiments and look at the disassembly."}, {"owner": {"reputation": 77, "user_id": 8563154, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/9bb354335c4b2d4d5e598218ae708471?s=128&d=identicon&r=PG&f=1", "display_name": "Esato", "link": "https://stackoverflow.com/users/8563154/esato"}, "edited": false, "score": 0, "creation_date": 1504617755, "post_id": 46055305, "comment_id": 79071788, "body": "This is Cortex M4, ARMv7E-M architecture and I think you are right, it is looking like forwards and backwards hints to processor."}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1504617907, "post_id": 46055305, "comment_id": 79071897, "body": "these are not hints to a branch predictor, how is the assembler/toolchain going to provide that hint?  the cortex-ms use a cache to deal with branch prediction (rather than looking deep into the pipe, their pipes are tiny anyway) first pass no hit, save, second time if not evicted then a chance at fetching early or maybe it always fetches early, an interesting performance experiment now that I think about it..."}], "answers": [{"tags": [], "owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "is_accepted": true, "score": 2, "last_activity_date": 1504617758, "creation_date": 1504617758, "answer_id": 46056095, "question_id": 46055305, "link": "https://stackoverflow.com/questions/46055305/what-does-2f-mean-when-branching-to-label-in-assembler/46056095#46056095", "title": "What does 2f mean when branching to label in assembler?", "body": "<p>It is a lazy programmer shortcut AFAIK specific to the gnu assembly language. (an assembly language is defined by the assembler, the program that reads it, there are many arm, mips, x86, etc assembly languages)</p>\n\n<pre><code>1:\n2:\n    b 1b\n    b 2b\n    b 1f\n    b 2f\n2:\n    b 1b\n    b 1f\n1:\n    nop\n    nop\n</code></pre>\n\n<p>assemble then disassemble</p>\n\n<pre><code>00000000 &lt;.text&gt;:\n   0:   eafffffe    b   0 &lt;.text&gt;\n   4:   eafffffd    b   0 &lt;.text&gt;\n   8:   ea000002    b   18 &lt;.text+0x18&gt;\n   c:   eaffffff    b   10 &lt;.text+0x10&gt;\n  10:   eafffffa    b   0 &lt;.text&gt;\n  14:   eaffffff    b   18 &lt;.text+0x18&gt;\n  18:   e1a00000    nop         ; (mov r0, r0)\n  1c:   e1a00000    nop         ; (mov r0, r0)\n</code></pre>\n"}], "owner": {"reputation": 77, "user_id": 8563154, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/9bb354335c4b2d4d5e598218ae708471?s=128&d=identicon&r=PG&f=1", "display_name": "Esato", "link": "https://stackoverflow.com/users/8563154/esato"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 305, "favorite_count": 1, "accepted_answer_id": 46056095, "answer_count": 1, "score": 1, "last_activity_date": 1504617772, "creation_date": 1504615424, "last_edit_date": 1504617772, "question_id": 46055305, "link": "https://stackoverflow.com/questions/46055305/what-does-2f-mean-when-branching-to-label-in-assembler", "title": "What does 2f mean when branching to label in assembler?", "body": "<p>I am trying to understand some snippet of assembler code:</p>\n\n<pre><code>       \".syntax unified\\n\"\n\"1:\\n\"\n       \" NOP\\n\"\n       \" NOP\\n\"\n       \" NOP\\n\"\n       \" NOP\\n\"\n       \" NOP\\n\"\n       \" CMP %[SystemCoreClock],%[clock16MHz]\\n\"\n       \" BEQ.n 2f\\n\"\n       \" NOP\\n\"\n       \" NOP\\n\"\n       \" NOP\\n\"\n       \" NOP\\n\"\n       \" NOP\\n\"\n       \" NOP\\n\"\n       \" NOP\\n\"\n       \" NOP\\n\"\n       \" NOP\\n\"\n\"2:\\n\"\n       \" SUBS %0, %0, #1\\n\"\n       \" BNE.n 1b\\n\"\n       \".syntax divided\\n\"\n</code></pre>\n\n<p>What is the meaning of \"f\" when program branch to label 2 in line:</p>\n\n<pre><code>\" BEQ.n 2f\\n\"\n</code></pre>\n\n<p>and what is the difference when branch with \"b\" in line </p>\n\n<pre><code>\" BNE.n 1b\\n\"\n</code></pre>\n"}, {"tags": ["c", "makefile", "binutils"], "answers": [{"tags": [], "owner": {"reputation": 20315, "user_id": 963881, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e82a2a2b9ddf6fb580a9c34b2eca65f4?s=128&d=identicon&r=PG&f=1", "display_name": "syntagma", "link": "https://stackoverflow.com/users/963881/syntagma"}, "is_accepted": true, "score": 2, "last_activity_date": 1504617369, "last_edit_date": 1504617369, "creation_date": 1504615742, "answer_id": 46055404, "question_id": 46055110, "link": "https://stackoverflow.com/questions/46055110/makefile-def-vs-makefile-am/46055404#46055404", "title": "Makefile.def vs Makefile.am", "body": "<blockquote>\n  <p>What exactly is the difference between Makefile.def and Makefile.am?</p>\n</blockquote>\n\n<p>Let's look at GCC, large project which is using <code>binutils</code> as well. Quoting <a href=\"http://gcc.gnu.org/wiki/Regenerating_GCC_Configuration\" rel=\"nofollow noreferrer\">Regenerating GCC Configuration</a>:</p>\n\n<blockquote>\n  <p>The Makefile.in file is sometimes big, and can be generated by automake from a Makefile.am file. Some Makefile.in files (used to generate Makefile in the build tree) are generated by autogen from Makefile.tpl and Makefile.def files. Autogen is a (GUILE scriptable) tool designed to simplify the creation and maintenance of programs that contain large amounts of repetitious text.</p>\n</blockquote>\n\n<p>So the difference is really about how and where you want to store parts of the input files that <code>autogen</code> will work on. In case of GCC, it <code>Makefile.tpl</code> stores a <strong>template</strong> (for generating the output Makefile, whereas<code>Makefile.def</code> stores <strong>definitions</strong>, which will be used by autogen.</p>\n\n<p>For example, inside <code>Makefile.tpl</code> you will find this template for filling <code>HOST_LIB_PATH</code> variable (note it uses <code>host_modules</code> variable):</p>\n\n<pre><code># This is the list of directories that may be needed in RPATH_ENVVAR\n# so that programs built for the host machine work.\nHOST_LIB_PATH = [+ FOR host_modules +][+\n  IF lib_path +]$(HOST_LIB_PATH_[+module+])[+ ENDIF lib_path +][+\n  ENDFOR host_modules +]\n</code></pre>\n\n<p>And inside <code>Makefile.def</code> there is a definition for <code>host_modules</code>:</p>\n\n<pre><code>host_modules= { module= bfd; bootstrap=true; };\nhost_modules= { module= opcodes; bootstrap=true; };\n// ...\n</code></pre>\n"}], "owner": {"reputation": 694, "user_id": 6528719, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jyH70.jpg?s=128&g=1", "display_name": "Dinesh Gowda", "link": "https://stackoverflow.com/users/6528719/dinesh-gowda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1243, "favorite_count": 1, "accepted_answer_id": 46055404, "answer_count": 1, "score": 1, "last_activity_date": 1504617369, "creation_date": 1504614835, "question_id": 46055110, "link": "https://stackoverflow.com/questions/46055110/makefile-def-vs-makefile-am", "title": "Makefile.def vs Makefile.am", "body": "<p>I am working on linux binutils-2.29.\nIn the parent directory there is not <code>Makefile.am</code>, but in all the sub directories there is <code>Makefile.am</code>.</p>\n\n<p>In the parent directory these are the Makefiles present:</p>\n\n<pre><code>Makefile  Makefile.def  Makefile.in  Makefile.tpl\n</code></pre>\n\n<p>In side <code>Makefile.tpl</code> there is a comment which says <code>Makefile</code> is generated from <code>Makefile.tpl</code> by <code>autogen Makefile.def</code></p>\n\n<p>but inside subdirectories there is not <code>Makefile.def</code>, when I run <code>autoreconf &amp;&amp; automake</code> it generates <code>Makefile</code> from <code>Makefile.am</code></p>\n\n<p>What exactly is the difference between <code>Makefile.def</code> and <code>Makefile.am</code>?</p>\n"}, {"tags": ["c", "unix", "linux-kernel", "signal-handling"], "comments": [{"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1504614983, "post_id": 46054751, "comment_id": 79069656, "body": "Aren&#39;t signals asynchronous by definition?"}, {"owner": {"reputation": 369, "user_id": 1440249, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/abb7ca3a6454236a0453dbcbeddf717a?s=128&d=identicon&r=PG", "display_name": "Shrikant Giridhar", "link": "https://stackoverflow.com/users/1440249/shrikant-giridhar"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1504615116, "post_id": 46054751, "comment_id": 79069742, "body": "I&#39;m not sure. This says that there are two types: <a href=\"ftp://ftp.gnu.org/old-gnu/Manuals/glibc-2.2.3/html_chapter/libc_24.html\" rel=\"nofollow noreferrer\">ftp.gnu.org/old-gnu/Manuals/glibc-2.2.3/html_chapter/&hellip;</a>."}], "answers": [{"tags": [], "owner": {"reputation": 855, "user_id": 4183260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0a9c774a5d112cd7a0eb387626ee5?s=128&d=identicon&r=PG&f=1", "display_name": "Guillermo", "link": "https://stackoverflow.com/users/4183260/guillermo"}, "is_accepted": false, "score": 0, "last_activity_date": 1504697442, "last_edit_date": 1504697442, "creation_date": 1504615735, "answer_id": 46055400, "question_id": 46054751, "link": "https://stackoverflow.com/questions/46054751/handling-synchronous-signals/46055400#46055400", "title": "Handling synchronous signals", "body": "<p>I think that one of the best resources out there are the:</p>\n\n<ul>\n<li><a href=\"https://murdercube.com/files/Computers/Programming/The%20Linux%20Programming%20Interface.pdf\" rel=\"nofollow noreferrer\">The Linux Programming interface by Michael KerrisK</a> Chapters 20, 21 and 22</li>\n<li><a href=\"http://index-of.es/OS/Linux%20System%20Programming.pdf\" rel=\"nofollow noreferrer\">Linux System Programming by Robert Love</a> Chapter 9</li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 369, "user_id": 1440249, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/abb7ca3a6454236a0453dbcbeddf717a?s=128&d=identicon&r=PG", "display_name": "Shrikant Giridhar", "link": "https://stackoverflow.com/users/1440249/shrikant-giridhar"}, "edited": false, "score": 0, "creation_date": 1504659435, "post_id": 46055408, "comment_id": 79091226, "body": "How does synchronous vs. asynchronous delivery affect the async-signal-safety of the program? Consider the program in <code>man mprotect(2)</code> on Linux. Is the handler incorrect in using a async-signal-unsafe function?"}, {"owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "reply_to_user": {"reputation": 369, "user_id": 1440249, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/abb7ca3a6454236a0453dbcbeddf717a?s=128&d=identicon&r=PG", "display_name": "Shrikant Giridhar", "link": "https://stackoverflow.com/users/1440249/shrikant-giridhar"}, "edited": false, "score": 0, "creation_date": 1504680153, "post_id": 46055408, "comment_id": 79097236, "body": "Yes it is not correct to use async-signal-unsafe function in <b>any</b> signal handler, just because you&#39;ll never know if the occurence of the signal is synchronous or not. (1) some external event may produce a SIGFPE (for example), so your process is unable to know if it is synchronous or not (2) you never know if in occurence of synchronous delivery the call to async-unsafe function is permitted. So <b>don&#39;t call async-signal-function in signal handlers</b>."}], "tags": [], "owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "is_accepted": true, "score": 5, "last_activity_date": 1505678525, "last_edit_date": 1505678525, "creation_date": 1504615754, "answer_id": 46055408, "question_id": 46054751, "link": "https://stackoverflow.com/questions/46054751/handling-synchronous-signals/46055408#46055408", "title": "Handling synchronous signals", "body": "<p>There are no synchronous and asynchronous signals by nature, but some signals are delivered asynchronously and some other can be delivered sync or async.</p>\n\n<p>Delivery is always the same: a signal handler in user mode is called if set. If not set then a default behavior is used (default behavior is terminating the process, except for some signals for which ignoring or pausing is done).</p>\n\n<p>Signals are considered to be delivered asynchronously if they are initiated by some external cause (for example somebody else called <code>kill</code>). In such a case from the point of view of the process there is time in between emitting and delivering: process can execute many things...</p>\n\n<p>Signals are delivered synchronously if some internal runtime cause is detected for which a signal should be emitted. For example, a bad memory access which can deliver <code>SIGSEGV</code> or <code>SIGBUS</code>, a floating point error like division by zero which deliver <code>SIGFPE</code>, a bad instruction (<code>SIGILL</code>), etc. In such a case it is the current executed code/instruction that is the source of the fault, then signal is immediately emitted and then delivered. In this case from the point of view of the process nothing happens in between emitting and delivery.</p>\n"}, {"comments": [{"owner": {"reputation": 369, "user_id": 1440249, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/abb7ca3a6454236a0453dbcbeddf717a?s=128&d=identicon&r=PG", "display_name": "Shrikant Giridhar", "link": "https://stackoverflow.com/users/1440249/shrikant-giridhar"}, "edited": false, "score": 0, "creation_date": 1504665410, "post_id": 46055591, "comment_id": 79092581, "body": "If the current process is suspended on a SIGSEGV, for example, would it be safe to execute othewise unsafe functions i.e. <code>printf</code>? Wouldn&#39;t the current process still hold locks (for example) even if gets suspended?"}, {"owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "edited": false, "score": 0, "creation_date": 1504680343, "post_id": 46055591, "comment_id": 79097340, "body": "No call to printf is not permitted (at least the behavior is undefined). Signal delivery does nothing on global state of process, except some things about signal management (signal mask, etc). So locked locks, remains locked..."}], "tags": [], "owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "is_accepted": false, "score": 0, "last_activity_date": 1504616815, "last_edit_date": 1504616815, "creation_date": 1504616295, "answer_id": 46055591, "question_id": 46054751, "link": "https://stackoverflow.com/questions/46054751/handling-synchronous-signals/46055591#46055591", "title": "Handling synchronous signals", "body": "<p>There are two parts here. The generating of signals and the receipt of signals. Signals are received by the program through signals handlers. As far as a signal handler is concerned, the receipt of the signal is always asynchronous (i.e. it cannot predict when it will be received).</p>\n\n<p>Whether generating a signal is synchronous or asynchronous is another question. An interrupt from an external device is clearly asynchronous. A call from a program to raise a signal will block that program until the call returns. During the call the signal can be sent asynchronously (i.e. it is placed in a queue for the receiving program) or synchronously (i.e. the signalled program's handler is invoked and the signalling program/thread is suspended until the handler returns, possibly returning some value.) An example of this is the Windows SendMessage (synchronous) and PostMessage (asynchronous)</p>\n\n<p>Addition: \"An interrupt from an external device is clearly asynchronous\" <em>and suspends the currently running process untill the handler has finished</em>. So a segmentation violation, a hardware interrupt, suspends the currently running process (which generated the hardware signal). Its default handling will be to terminate the process.</p>\n"}, {"tags": [], "owner": {"reputation": 124, "user_id": 8283102, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd364df21977eb17d0d27b31851acbd8?s=128&d=identicon&r=PG&f=1", "display_name": "Rohit", "link": "https://stackoverflow.com/users/8283102/rohit"}, "is_accepted": false, "score": 0, "last_activity_date": 1504619399, "creation_date": 1504619399, "answer_id": 46056686, "question_id": 46054751, "link": "https://stackoverflow.com/questions/46054751/handling-synchronous-signals/46056686#46056686", "title": "Handling synchronous signals", "body": "<p>Signal handling As mentioned previous comment are synchronous and asynchronous. Synchronous means process/thread wile executing some instruction and this execution have caused the interrupt. forex int *a;printf(\"%d\",*a);can cause segmentation fault.\nAsynchronous:-client process and server process example:-server is going down it will send signal to client to stop.Here client is not generating any interrupt it is from externally process. \nWhenever there is synchronous interrupt that means something wrong with the process.Suggested is to keep handling as minimum as possible no library or complex statement.Suppose interrupt is due to malloc failure than if some library function is used again this will again cause problem.Better way is to do a automatic process restart in signal handler itself.</p>\n"}], "owner": {"reputation": 369, "user_id": 1440249, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/abb7ca3a6454236a0453dbcbeddf717a?s=128&d=identicon&r=PG", "display_name": "Shrikant Giridhar", "link": "https://stackoverflow.com/users/1440249/shrikant-giridhar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2079, "favorite_count": 0, "accepted_answer_id": 46055408, "answer_count": 4, "score": 3, "last_activity_date": 1505678525, "creation_date": 1504613685, "question_id": 46054751, "link": "https://stackoverflow.com/questions/46054751/handling-synchronous-signals", "title": "Handling synchronous signals", "body": "<p>I'm trying to find resources talking about handling synchronous signals (SIGSEGV, SIGILL etc.) compared to handling async signals. </p>\n\n<p>The typical signal handling mechanism (using kill, for example) invokes signal handlers on control transfer from kernel to user mode. My understanding is that a 'synchronous' signal works more like a system call in that control transfers to kernel immediately - probably because synchronous signals are typically associated with CPU interrupts (memory protection etc.) and the kernel handler gets invoked for these anyway.</p>\n\n<ol>\n<li><p>Are libc functions which are otherwise 'async-signal-unsafe' safe to be used in synchronous signal handlers? I see the Linux mprotect(2) man page uses printf inside a SIGSEGV handler, for example. How can I determine if a function can be used in these situations?</p></li>\n<li><p>How does a typical Unix-like kernel's handling of synchronous signals differ from its handling of async signals? What makes them 'synchronous'?</p></li>\n</ol>\n"}, {"tags": ["c", "linux-kernel", "redhat", "system-calls"], "comments": [{"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 1, "creation_date": 1504619792, "post_id": 46054525, "comment_id": 79073359, "body": "Building a module uses kernel source.  It should not be using include files from userspace."}, {"owner": {"reputation": 2121, "user_id": 3610183, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/yJjyl.jpg?s=128&g=1", "display_name": "rainman", "link": "https://stackoverflow.com/users/3610183/rainman"}, "reply_to_user": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1504621991, "post_id": 46054525, "comment_id": 79074976, "body": "files from userspace  ???"}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 1, "creation_date": 1504631398, "post_id": 46054525, "comment_id": 79080605, "body": "There is no <code>sys&#47;</code> headers in the kernel. Not sure what you want to find there. Also, <code>#define MODULE</code> and <code>#define __KERNEL__</code> are wrong: these macros are defined by the kernel build system (KBuild) if needed. Including <code>&#47;usr&#47;src&#47;kernels&#47;linux&#47;arch&#47;x86&#47;include&#47;asm&#47;unistd.h</code> using its <b>absolute path</b> looks suspicious. Isn&#39;t including <code>asm&#47;unistd.h</code> sufficient?"}, {"owner": {"reputation": 2121, "user_id": 3610183, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/yJjyl.jpg?s=128&g=1", "display_name": "rainman", "link": "https://stackoverflow.com/users/3610183/rainman"}, "reply_to_user": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1504632941, "post_id": 46054525, "comment_id": 79081369, "body": "@Tsyvarev ok I removed all that you commented #define MODULE #define <b>KERNEL</b> and the include of /usr/src/kernels/linux/arch/x86/include/asm/unistd.h and it did not fix my problem"}, {"owner": {"reputation": 10901, "user_id": 1076479, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/eLQUX.jpg?s=128&g=1", "display_name": "Gil Hamilton", "link": "https://stackoverflow.com/users/1076479/gil-hamilton"}, "reply_to_user": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1504635849, "post_id": 46054525, "comment_id": 79082664, "body": "Did you remove the inclusion of <code>sys&#47;syscall.h</code> which, as @Tsyvarev noted, cannot be <code>#included</code> from the kernel? If so, that would have at a minimum changed the error message you were getting."}, {"owner": {"reputation": 2121, "user_id": 3610183, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/yJjyl.jpg?s=128&g=1", "display_name": "rainman", "link": "https://stackoverflow.com/users/3610183/rainman"}, "reply_to_user": {"reputation": 10901, "user_id": 1076479, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/eLQUX.jpg?s=128&g=1", "display_name": "Gil Hamilton", "link": "https://stackoverflow.com/users/1076479/gil-hamilton"}, "edited": false, "score": 0, "creation_date": 1504636372, "post_id": 46054525, "comment_id": 79082926, "body": "@GilHamilton yes now the error message is other, I edited my question"}], "answers": [{"comments": [{"owner": {"reputation": 2121, "user_id": 3610183, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/yJjyl.jpg?s=128&g=1", "display_name": "rainman", "link": "https://stackoverflow.com/users/3610183/rainman"}, "edited": false, "score": 0, "creation_date": 1504727349, "post_id": 46061914, "comment_id": 79128404, "body": "the program compiles without errors, but when I  try to insert the module  with: <code>insmod intercept.ko</code> the whole OS gets blocked and I have to restart the machine :("}, {"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "reply_to_user": {"reputation": 2121, "user_id": 3610183, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/yJjyl.jpg?s=128&g=1", "display_name": "rainman", "link": "https://stackoverflow.com/users/3610183/rainman"}, "edited": false, "score": 0, "creation_date": 1504728847, "post_id": 46061914, "comment_id": 79129156, "body": "In your init function, printk the address of sys_call_table and compare it to System.map.  Also, you do not show the module_init and module_exit calls."}, {"owner": {"reputation": 2121, "user_id": 3610183, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/yJjyl.jpg?s=128&g=1", "display_name": "rainman", "link": "https://stackoverflow.com/users/3610183/rainman"}, "edited": false, "score": 0, "creation_date": 1504736911, "post_id": 46061914, "comment_id": 79132496, "body": "how can i do this please ?"}], "tags": [], "owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "is_accepted": false, "score": 0, "last_activity_date": 1504639053, "creation_date": 1504639053, "answer_id": 46061914, "question_id": 46054525, "link": "https://stackoverflow.com/questions/46054525/error-after-compiling-kernel-module-sys-syscall-h-no-such-file-or-directory/46061914#46061914", "title": "Error after compiling kernel module: sys/syscall.h: No such file or directory", "body": "<p>The constant you are looking for is <code>__NR_geteuid</code> which is defined in <code>asm/unistd.h</code>.</p>\n"}], "owner": {"reputation": 2121, "user_id": 3610183, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/yJjyl.jpg?s=128&g=1", "display_name": "rainman", "link": "https://stackoverflow.com/users/3610183/rainman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2268, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1504639053, "creation_date": 1504612968, "last_edit_date": 1504636333, "question_id": 46054525, "link": "https://stackoverflow.com/questions/46054525/error-after-compiling-kernel-module-sys-syscall-h-no-such-file-or-directory", "title": "Error after compiling kernel module: sys/syscall.h: No such file or directory", "body": "<p>I am implementing a kernel module that edits the <code>whoami</code> command after being inserted, I am compiling it with a Makefile which content is as follows: </p>\n\n<pre><code>obj-m+=holamundo.o\nobj-m+=acumulador.o\nobj-m+=cliente.o\nobj-m+=intercept.o\n\nall:\n    make -C /lib/modules/$(shell uname -r)/build M=$(PWD) modules\nclean:\n    make -C /lib/modules/$(shell uname -r )/build M=$(PWD) clean\n</code></pre>\n\n<p>and my module code: </p>\n\n<pre><code>#define MODULE\n#define __KERNEL__\n#include &lt;linux/module.h&gt;\n#include &lt;linux/kernel.h&gt;\n#include &lt;/usr/src/kernels/linux/arch/x86/include/asm/unistd.h&gt;\n#include &lt;asm/unistd.h&gt;\n#include &lt;linux/unistd.h&gt;\n#include &lt;linux/syscalls.h&gt;\n#include &lt;sys/syscall.h&gt;\n#include &lt;asm/fcntl.h&gt;\n#include &lt;asm/errno.h&gt;\n#include &lt;linux/types.h&gt;\n#include &lt;linux/dirent.h&gt;\n#include &lt;linux/mman.h&gt;\n#include &lt;linux/string.h&gt;\n#include &lt;linux/fs.h&gt;\n\nextern void *sys_call_table[];\nint (*orig_geteuid)(const char *path);\n\nint hacked_geteuid(const char *path) {\nreturn 78;\n}\n\nint init_module(void) {\n\norig_geteuid = sys_call_table[SYS_geteuid32];\n\nsys_call_table[SYS_geteuid32] = hacked_geteuid;\nreturn 0;\n\n}\n\nvoid cleanup_module(void) {\n    sys_call_table[SYS_geteuid32] = orig_geteuid;\n}\n</code></pre>\n\n<p>The problem I am facing is when I execute the <code>make</code> command I get the error: </p>\n\n<pre><code>/usr/src/kernels/intercept.c:9:25: fatal error: sys/syscall.h: No such file or directory\n</code></pre>\n\n<p>I am using the linux kernel 4.12.10 in RedHat 7.3</p>\n\n<p>After removing <code>#include &lt;sys/syscall.h&gt;</code> from the code, I get the following error:</p>\n\n<pre><code>/usr/src/kernels/intercept.c:27:31: error: \u2018SYS_geteuid32\u2019 undeclared (first use in this function)\n orig_geteuid = sys_call_table[SYS_geteuid32];\n                               ^\n/usr/src/kernels/intercept.c:27:31: note: each undeclared identifier is reported only once for each function it appears in\n/usr/src/kernels/intercept.c: In function \u2018cleanup_module\u2019:\n/usr/src/kernels/intercept.c:35:17: error: \u2018SYS_geteuid32\u2019 undeclared (first use in this function)\n  sys_call_table[SYS_geteuid32] = orig_geteuid;\n</code></pre>\n\n<p>Does anybody know what I am doing wrong ?</p>\n"}, {"tags": ["c", "unix", "gcc", "segmentation-fault"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1504610831, "post_id": 46053747, "comment_id": 79066899, "body": "<code>temp1</code>is never initialized, neither is <code>temp</code>."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1504611009, "post_id": 46053747, "comment_id": 79067014, "body": "@MichaelWalz <code>temp = array;</code> initializes it. You&#39;re correct about <code>temp1</code>."}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 3721750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c69c114a4a0c396ab00dc1ef15ed17f9?s=128&d=identicon&r=PG&f=1", "display_name": "Shri", "link": "https://stackoverflow.com/users/3721750/shri"}, "edited": false, "score": 0, "creation_date": 1504611404, "post_id": 46053884, "comment_id": 79067281, "body": "Got it. But how does calling the display() function before calling swap() function removes this issue ? Becuase when i call the display() function before calling swap() function, i dont get the seg fault. Also , why does compiler doesnt give me a warning that the variable is not initialized before its used ?"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "reply_to_user": {"reputation": 27, "user_id": 3721750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c69c114a4a0c396ab00dc1ef15ed17f9?s=128&d=identicon&r=PG&f=1", "display_name": "Shri", "link": "https://stackoverflow.com/users/3721750/shri"}, "edited": false, "score": 0, "creation_date": 1504611777, "post_id": 46053884, "comment_id": 79067529, "body": "@Shri: <code>temp1</code> has undefined/random content. Depending on the previous usage of the storage location this can be NULL, -1 or the address of a poem."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "reply_to_user": {"reputation": 27, "user_id": 3721750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c69c114a4a0c396ab00dc1ef15ed17f9?s=128&d=identicon&r=PG&f=1", "display_name": "Shri", "link": "https://stackoverflow.com/users/3721750/shri"}, "edited": false, "score": 0, "creation_date": 1504611799, "post_id": 46053884, "comment_id": 79067546, "body": "@Shri Do you enable all warnings during compilation?"}, {"owner": {"reputation": 27, "user_id": 3721750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c69c114a4a0c396ab00dc1ef15ed17f9?s=128&d=identicon&r=PG&f=1", "display_name": "Shri", "link": "https://stackoverflow.com/users/3721750/shri"}, "edited": false, "score": 0, "creation_date": 1504612311, "post_id": 46053884, "comment_id": 79067895, "body": "I get these list of warnings when i compile with -Wall :    game7.c: In function &#39;swap&#39;: game7.c:80: error: &#39;for&#39; loop initial declaration used outside C99 mode"}, {"owner": {"reputation": 27, "user_id": 3721750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c69c114a4a0c396ab00dc1ef15ed17f9?s=128&d=identicon&r=PG&f=1", "display_name": "Shri", "link": "https://stackoverflow.com/users/3721750/shri"}, "edited": false, "score": 0, "creation_date": 1504613360, "post_id": 46053884, "comment_id": 79068588, "body": "@Neil: temp1[52] is not needed . I am mem copying only 2 bytes to temp1. So temp1 can have size as 3 including null terminator. or I can have <code>*temp1 = malloc(sizeof(char) * 3)</code> . Is my understanding correct ?"}, {"owner": {"reputation": 1008, "user_id": 261981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c602c66983841d31a8d2131c8428f1fb?s=128&d=identicon&r=PG", "display_name": "Neil", "link": "https://stackoverflow.com/users/261981/neil"}, "reply_to_user": {"reputation": 27, "user_id": 3721750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c69c114a4a0c396ab00dc1ef15ed17f9?s=128&d=identicon&r=PG&f=1", "display_name": "Shri", "link": "https://stackoverflow.com/users/3721750/shri"}, "edited": false, "score": 0, "creation_date": 1504621844, "post_id": 46053884, "comment_id": 79074853, "body": "@Shri you are correct, 52 is high, I could of just used 2 bytes for the array. Memcpy is a long-winded way to copy just two bytes thou. If you are only copying two bytes, you do not need a null terminator plus with malloc, you will also need to free temp1 at the end of the function. Having a char array is just easy to implement, read and debug."}, {"owner": {"reputation": 1008, "user_id": 261981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c602c66983841d31a8d2131c8428f1fb?s=128&d=identicon&r=PG", "display_name": "Neil", "link": "https://stackoverflow.com/users/261981/neil"}, "reply_to_user": {"reputation": 27, "user_id": 3721750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c69c114a4a0c396ab00dc1ef15ed17f9?s=128&d=identicon&r=PG&f=1", "display_name": "Shri", "link": "https://stackoverflow.com/users/3721750/shri"}, "edited": false, "score": 0, "creation_date": 1504622625, "post_id": 46053884, "comment_id": 79075460, "body": "@Shri - I have updated my answer, so the indexes are correct for the memcpy. I hope you understand why I have multiplied the indexes by 2"}, {"owner": {"reputation": 27, "user_id": 3721750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c69c114a4a0c396ab00dc1ef15ed17f9?s=128&d=identicon&r=PG&f=1", "display_name": "Shri", "link": "https://stackoverflow.com/users/3721750/shri"}, "edited": false, "score": 0, "creation_date": 1504677332, "post_id": 46053884, "comment_id": 79095814, "body": "@Neil : Your code gives a core dump because you copy every second element of an array of 52 cards. The for loop runs for 52 times and tries at least one swap for each of the 52 cards in the array."}, {"owner": {"reputation": 1008, "user_id": 261981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c602c66983841d31a8d2131c8428f1fb?s=128&d=identicon&r=PG", "display_name": "Neil", "link": "https://stackoverflow.com/users/261981/neil"}, "reply_to_user": {"reputation": 27, "user_id": 3721750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c69c114a4a0c396ab00dc1ef15ed17f9?s=128&d=identicon&r=PG&f=1", "display_name": "Shri", "link": "https://stackoverflow.com/users/3721750/shri"}, "edited": false, "score": 0, "creation_date": 1504683000, "post_id": 46053884, "comment_id": 79099036, "body": "@Shri - I should of just left it as is Shri ... I, wrongly assumed you were passing one large buffer in. I&#39;ve looked at the rest of your snippets and will change the indexes- also I will  apologize for not checking!"}], "tags": [], "owner": {"reputation": 1008, "user_id": 261981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c602c66983841d31a8d2131c8428f1fb?s=128&d=identicon&r=PG", "display_name": "Neil", "link": "https://stackoverflow.com/users/261981/neil"}, "is_accepted": true, "score": 2, "last_activity_date": 1504683066, "last_edit_date": 1504683066, "creation_date": 1504610947, "answer_id": 46053884, "question_id": 46053747, "link": "https://stackoverflow.com/questions/46053747/segfault-segv-accerr-invalid-permissions-for-object/46053884#46053884", "title": "segfault SEGV_ACCERR - Invalid Permissions for object", "body": "<p>In swap function - </p>\n\n<p>You are using temp1 with out initializing it.</p>\n\n<pre><code>void swap(char **array)\n{\n  char **temp;\n  int x;\n  temp = array;\n  char temp1[ 2 ];\n\n  for(int i=0;i&lt;=51;i++)\n  {\n        x = rand()%53;\n        if(x == 53 || x == 52)\n                continue;\n\n        // need to multiply the indexes by 2\n        // allowing for the suit and deck\n        memcpy(temp1,temp[ i  ],2);   // program segfaults here. \n        memcpy(temp[ i  ],temp[ x  ],2);\n        memcpy(temp[ x  ],temp1,2);\n  }\n}\n</code></pre>\n\n<p>The above shows temp1 initialized correctly.</p>\n\n<p>I haven't checked the rest of your function, but this will stop the segfault.</p>\n"}, {"comments": [{"owner": {"reputation": 27, "user_id": 3721750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c69c114a4a0c396ab00dc1ef15ed17f9?s=128&d=identicon&r=PG&f=1", "display_name": "Shri", "link": "https://stackoverflow.com/users/3721750/shri"}, "edited": false, "score": 0, "creation_date": 1504611497, "post_id": 46053944, "comment_id": 79067340, "body": "do you mean for the null terminator &#39;\\0&#39; ?"}], "tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": false, "score": 1, "last_activity_date": 1504611111, "creation_date": 1504611111, "answer_id": 46053944, "question_id": 46053747, "link": "https://stackoverflow.com/questions/46053747/segfault-segv-accerr-invalid-permissions-for-object/46053944#46053944", "title": "segfault SEGV_ACCERR - Invalid Permissions for object", "body": "<p>You have another UB as well</p>\n\n<p><code>sprintf(*array,\"%c%c\",deck[i],suit[j]);</code></p>\n\n<p>you need 3 chars not two as malloc:</p>\n\n<p><code>*array = malloc(sizeof(char)*2))</code></p>\n"}], "owner": {"reputation": 27, "user_id": 3721750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c69c114a4a0c396ab00dc1ef15ed17f9?s=128&d=identicon&r=PG&f=1", "display_name": "Shri", "link": "https://stackoverflow.com/users/3721750/shri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1841, "favorite_count": 0, "accepted_answer_id": 46053884, "answer_count": 2, "score": 0, "last_activity_date": 1504683066, "creation_date": 1504610551, "last_edit_date": 1504612709, "question_id": 46053747, "link": "https://stackoverflow.com/questions/46053747/segfault-segv-accerr-invalid-permissions-for-object", "title": "segfault SEGV_ACCERR - Invalid Permissions for object", "body": "<p>I have written a C code to shuffle a deck of 52 cards using swapping logic. The code generates a random number between 0 to 53 (52 and 53 are omitted) and then swaps it with the ith index in the array. The code is below. </p>\n\n<p>My issue :\nWhen i comment out display() function call before calling swap() function, the program throws a seg fault. But when i uncomment it and call the display function before calling swap() function , the program works fine and i get the desired output. I dont know why this is happening. </p>\n\n<p>Main Function : </p>\n\n<pre><code>int main()\n{\nchar deck[] = {'2','3','4','5','6','7','8','9','0','A','J','K','Q'};\nchar suit[] = {'D','H','S','C'};\n\nchar **array,**array1;\narray = malloc(sizeof(char *)*52);\narray1= array;\n\nsrand(time(NULL));\n\nfor(int i=0;i&lt;=12;i++)\n{\n        for(int j=0;j&lt;=3;j++)\n        {\n                if((*array = malloc(sizeof(char)*2))!=NULL)\n                {\n                        sprintf(*array,\"%c%c\",deck[i],suit[j]);\n                        *array++;\n                }\n        }\n}\n\n//display(array1); // when i comment this line, the program throws segfault. when i uncomment it the program runs fine. \nswap(array1);\ndisplay(array1);\nfree_array(array1);\nreturn 0;\n}\n</code></pre>\n\n<p>And here is the other functions swap and display. </p>\n\n<pre><code>void display(char **array)\n{\nchar **temp;\ntemp = array;\n\nfor(int i=0;i&lt;=51;i++)\n{\n        printf(\"temp [%s]\\n\",*temp);\n        *temp++;\n}\n\nreturn;\n}\n\nvoid swap(char **array)\n{\nchar **temp;\nint x;\ntemp = array;\nchar *temp1;\n\nfor(int i=0;i&lt;=51;i++)\n{\n        x = rand()%53;\n        if(x == 53 || x == 52)\n                continue;\n\n        memcpy(temp1,temp[i],2);   // program segfaults here. \n        memcpy(temp[i],temp[x],2);\n        memcpy(temp[x],temp1,2);\n}\nreturn;\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "libcurl", "ld", "name-conflict"], "comments": [{"owner": {"reputation": 205167, "user_id": 4323, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/qqgFU.png?s=128&g=1", "display_name": "John Zwinck", "link": "https://stackoverflow.com/users/4323/john-zwinck"}, "edited": false, "score": 0, "creation_date": 1504615656, "post_id": 46053383, "comment_id": 79070144, "body": "You say you don&#39;t have access to the source code of the application.  But can you at least rebuild or otherwise edit the binary to depend on a newer <code>libcurl</code>?  What platform is this on?"}, {"owner": {"reputation": 131, "user_id": 1019156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60e30e6c1028111327a0230f4861b83?s=128&d=identicon&r=PG", "display_name": "Bharath Gade", "link": "https://stackoverflow.com/users/1019156/bharath-gade"}, "reply_to_user": {"reputation": 205167, "user_id": 4323, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/qqgFU.png?s=128&g=1", "display_name": "John Zwinck", "link": "https://stackoverflow.com/users/4323/john-zwinck"}, "edited": false, "score": 0, "creation_date": 1504628160, "post_id": 46053383, "comment_id": 79079052, "body": "This is on solaris SunOS version 5.10. I cannot rebuild or edit the binary. I can use an external tool like objcopy and modify the symbols of that shared object externally but that may have some unintended consequences."}], "answers": [{"comments": [{"owner": {"reputation": 3725, "user_id": 8471208, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-zX6iRd9pmRI/AAAAAAAAAAI/AAAAAAAAAgE/F3-J9H4ZCno/photo.jpg?sz=128", "display_name": "Kevin Boone", "link": "https://stackoverflow.com/users/8471208/kevin-boone"}, "edited": false, "score": 0, "creation_date": 1504618697, "post_id": 46056159, "comment_id": 79072488, "body": "Yeah :/ I&#39;ve used this renaming trick to get around problems like this in the past, but it&#39;s horrible. You really need to change <i>everything</i> -- every exported symbol -- or there could still be references to the old version. You could check this, I guess, by building a test program that links against the hacked version of libcurl, and doesn&#39;t reference the &quot;real&quot; (old) libcurl at all. But nasty, really nasty."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "reply_to_user": {"reputation": 3725, "user_id": 8471208, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-zX6iRd9pmRI/AAAAAAAAAAI/AAAAAAAAAgE/F3-J9H4ZCno/photo.jpg?sz=128", "display_name": "Kevin Boone", "link": "https://stackoverflow.com/users/8471208/kevin-boone"}, "edited": false, "score": 0, "creation_date": 1504619125, "post_id": 46056159, "comment_id": 79072836, "body": "This is why the task should be done via some script. First, it saves a potentially tremendous amount of work, second, it can be called again on source update and third, if implemented correctly, is far more likely to catch all necessary occurences than doing doing things by hand... If being lucky, there even exists some script somewhere in the internet already..."}, {"owner": {"reputation": 131, "user_id": 1019156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60e30e6c1028111327a0230f4861b83?s=128&d=identicon&r=PG", "display_name": "Bharath Gade", "link": "https://stackoverflow.com/users/1019156/bharath-gade"}, "edited": false, "score": 0, "creation_date": 1504634253, "post_id": 46056159, "comment_id": 79081961, "body": "Thanks. I will give this a try and let you know. Does it make any difference if I am linking statically with libcurl.a and not libcurl.so? I expected that when I link statically, common.so contains all the definitions it needs within itself and those will supersede any definitions from other dependent so files."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1504659953, "post_id": 46056159, "comment_id": 79091328, "body": "Well, yes, common.so will contain any definitions it needs, but which ones supersede (newer or older libcurl definitions) depends on the order app.exe loads the SO - and as you experienced already, these can as well be the older ones... On the other hand, you wouldn&#39;t have had this problem at all if <i>both</i> common.so and the other library were linked against libcurl.so. You could just have exchanged the so and <i>done</i> - provided, at least, the (used part of) libcurl interface did not change..."}], "tags": [], "owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "is_accepted": false, "score": 0, "last_activity_date": 1504618365, "last_edit_date": 1504618365, "creation_date": 1504617963, "answer_id": 46056159, "question_id": 46053383, "link": "https://stackoverflow.com/questions/46053383/symbol-resolution-when-multiple-versions-of-same-library-are-used/46056159#46056159", "title": "Symbol resolution when multiple versions of same library are used", "body": "<p>When app.exe loads the two SO in question, it adds the functions of each to its symbol table. Now one of two possible scenarios <em>must</em> occur (which one actually is OS detail but irrelevant here...):</p>\n\n<ol>\n<li>The newer version is loaded <em>before</em> the older version and the older one overwrites the newer one's entries.</li>\n<li>The newer version is loaded <em>after</em> the older one, and as there are already entries in the table, it is not updated any more.</li>\n</ol>\n\n<p>Now the cleanest solution &ndash; if applicable, i. e. if you have access to the sources &ndash; would be updating the other SO to use the newer version of curl. If doing so, consider creating curl as a new SO instead of linking it statically into both common.so and the other SO.</p>\n\n<p>Otherwise, to solve the issue directly, you would have to switch the order the app loads the SO, which probaly would mean to decompile app.exe and rebuild it with the linkage order of the SO changed. Problem then: there might be two versions of app.exe around then, and you must make sure that only the correct one is distributed with your common.so. Potential source of trouble, too...</p>\n\n<p>Apart from this, best I can think up is a workaround:</p>\n\n<p>You might modify the curl prefix from <code>curl_</code> to e. g. <code>curl_755_</code>. Do not try this by hand, though, you most likely would go crazy this way... Use a script (e. g. perl or python) for instead. And if you ever update the curl sources, you can just run it again then...</p>\n\n<p>Faster version, but potentially unsafe: just replace any occurences. Safer: Identify the externally visible functions (and possibly global objects) in a first run and keep them in a map, then replace any occurence of a string contained in the map with the corresponding value.</p>\n\n<p>The latter approach (map) would additionally allow to generate macros in the header files of the following form:</p>\n\n<pre><code>#define curl_xyz curl_755_xyz\n</code></pre>\n\n<p>These macros allow the sources of common.so to just look like as if the original sources of curl were used...</p>\n"}], "owner": {"reputation": 131, "user_id": 1019156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60e30e6c1028111327a0230f4861b83?s=128&d=identicon&r=PG", "display_name": "Bharath Gade", "link": "https://stackoverflow.com/users/1019156/bharath-gade"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 627, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1504618365, "creation_date": 1504609433, "question_id": 46053383, "link": "https://stackoverflow.com/questions/46053383/symbol-resolution-when-multiple-versions-of-same-library-are-used", "title": "Symbol resolution when multiple versions of same library are used", "body": "<p>I have a solaris shared object (common.so file) that runs as part of a third party application(app.exe). I do not have access to the source code of the application. To the so, I need to add a capability to post http requests. My plan is to use libcurl with openssl. The tricky part is that app.exe already has a dependency on an older version of curl (7.14) which does not support ssl with tls v1.2.</p>\n\n<p>I downloaded the source code and built curl (7.55.1) and openssl .a files. I was also able to build common.so with static dependency on these archive files. ldd does not show dependency on curl or ssl .so files and it also does not report any \"Symbol not found\" errors.</p>\n\n<p>With this result, I was expecting my version of curl to be invoked when the so runs as part of the application but it did not. Instead curl_version() displays older version and I get the error unknown ssl protocol error</p>\n\n<p>I am using solaris studio compiler. The application does not depend on curl libraries directly but depends on a different .so file which exports symbols with the same names as curl. I realized from nm and I am assuming that this .so file also links curl statically.</p>\n"}, {"tags": ["c", "encryption", "caesar-cipher"], "comments": [{"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 5, "creation_date": 1504608894, "post_id": 46053182, "comment_id": 79065635, "body": "<i>&quot;seems that doesn&#39;t work can you tell me why?&quot;</i> We can&#39;t, because you haven&#39;t told us <b>how</b> it doesn&#39;t work. Please see <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> and <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 2292, "user_id": 8536377, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f51711156b8ff9b6ea77ea2de12995f6?s=128&d=identicon&r=PG", "display_name": "campovski", "link": "https://stackoverflow.com/users/8536377/campovski"}, "edited": false, "score": 1, "creation_date": 1504609027, "post_id": 46053182, "comment_id": 79065729, "body": "Cases in switch statement must be enclosed in curly braces <code>{}</code> like <code>case 1 { ... }</code>"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 2, "creation_date": 1504609699, "post_id": 46053182, "comment_id": 79066192, "body": "One &#39; basic mistake&#39; is trying to develop programs without knowing how to use your debugger:("}, {"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "reply_to_user": {"reputation": 2292, "user_id": 8536377, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f51711156b8ff9b6ea77ea2de12995f6?s=128&d=identicon&r=PG", "display_name": "campovski", "link": "https://stackoverflow.com/users/8536377/campovski"}, "edited": false, "score": 5, "creation_date": 1504609731, "post_id": 46053182, "comment_id": 79066218, "body": "@campovski that is not the case - braces are optional. the end of the case is defined by the <code>break</code> or closing brace of the <code>switch</code>"}, {"owner": {"reputation": 4827, "user_id": 8051589, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8VNG6.png?s=128&g=1", "display_name": "Andre Kampling", "link": "https://stackoverflow.com/users/8051589/andre-kampling"}, "edited": false, "score": 2, "creation_date": 1504609778, "post_id": 46053182, "comment_id": 79066251, "body": "If I compile this code I get many warnings e.g.: wrong format specifier for <code>scanf()</code>: <code>warning: format \u2018%d\u2019 expects argument of type \u2018int *\u2019, but argument 2 has type \u2018char (*)[100]\u2019 [-Wformat=]</code>, etc. You should take care of them! This line will miserably fail: <code>scanf(&quot;%d&quot;, &amp;message);</code>! Further there are logical errors about your decryption which is mentioned in the comments below."}, {"owner": {"reputation": 13335, "user_id": 8204776, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e6qyq.jpg?s=128&g=1", "display_name": "meowgoesthedog", "link": "https://stackoverflow.com/users/8204776/meowgoesthedog"}, "edited": false, "score": 0, "creation_date": 1504609837, "post_id": 46053182, "comment_id": 79066281, "body": "Three situations where this code will not work: 1) upper case letters, 2) <code>shift &lt; 0</code>, 3) <code>shift &gt; 26</code>"}, {"owner": {"reputation": 1008, "user_id": 261981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c602c66983841d31a8d2131c8428f1fb?s=128&d=identicon&r=PG", "display_name": "Neil", "link": "https://stackoverflow.com/users/261981/neil"}, "edited": false, "score": 0, "creation_date": 1504609852, "post_id": 46053182, "comment_id": 79066291, "body": "Just a quick look - on the decrypt - try this move the &quot;- shift&quot; line to after the check for lower case?"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "reply_to_user": {"reputation": 4827, "user_id": 8051589, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8VNG6.png?s=128&g=1", "display_name": "Andre Kampling", "link": "https://stackoverflow.com/users/8051589/andre-kampling"}, "edited": false, "score": 0, "creation_date": 1504610166, "post_id": 46053182, "comment_id": 79066466, "body": "Hmm.. it seems like you have made another &#39;basic error&#39; - not heeding the warnings from your compiler.  Using the wrong format specifier for the &#39;message&#39; string is a very basic error that your compiler would have warned of, as noted by @AndreKampling.  Also note that scanf() returns a value that you should check."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1504610404, "post_id": 46053182, "comment_id": 79066619, "body": "<code>char message[100]; ... scanf(&quot;%d&quot;, &amp;message);</code>?!?!?  As others have noted, pay attention to your warnings, and check return values."}], "answers": [{"comments": [{"owner": {"reputation": 4827, "user_id": 8051589, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8VNG6.png?s=128&g=1", "display_name": "Andre Kampling", "link": "https://stackoverflow.com/users/8051589/andre-kampling"}, "edited": false, "score": 0, "creation_date": 1504682290, "post_id": 46053993, "comment_id": 79098584, "body": "@popcorn: I&#39;ve added some more considerations to my answer. Please have a look at them."}, {"owner": {"reputation": 43, "user_id": 8563093, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/180737b728612203560652ded6bc1292?s=128&d=identicon&r=PG&f=1", "display_name": "popcorn", "link": "https://stackoverflow.com/users/8563093/popcorn"}, "edited": false, "score": 0, "creation_date": 1504724488, "post_id": 46053993, "comment_id": 79126957, "body": "I checked that out, thanks so much, now my code works pretty good, thank you so much! :-) I&#39;m gonna try to add Vigenere cipher, so if i get some troubles i will show here :) :p"}], "tags": [], "owner": {"reputation": 4827, "user_id": 8051589, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8VNG6.png?s=128&g=1", "display_name": "Andre Kampling", "link": "https://stackoverflow.com/users/8051589/andre-kampling"}, "is_accepted": true, "score": 3, "last_activity_date": 1504698625, "last_edit_date": 1504698625, "creation_date": 1504611232, "answer_id": 46053993, "question_id": 46053182, "link": "https://stackoverflow.com/questions/46053182/caesar-cipher-in-c-encryption-and-decryption/46053993#46053993", "title": "Caesar cipher in C - encryption and decryption", "body": "<p>Always pay attention to the compiler warnings. If I compile your code I get the following warnings (and some more):</p>\n\n<blockquote>\n<pre><code>../main.c:21:10: warning: format \u2018%d\u2019 expects argument of type \u2018int *\u2019, but argument 2 has type \u2018char (*)[100]\u2019 [-Wformat=]\n          scanf(\"%d\", &amp;message);\n          ^\n../main.c:38:10: warning: format \u2018%d\u2019 expects argument of type \u2018int *\u2019, but argument 2 has type \u2018char (*)[100]\u2019 [-Wformat=]\n          scanf(\"%d\", &amp;message);\n          ^\n</code></pre>\n</blockquote>\n\n<p>There are 2 main problems:</p>\n\n<p><strong>1. Wrong format specifier with <a href=\"http://en.cppreference.com/w/cpp/io/c/scanf\" rel=\"nofollow noreferrer\"><code>scanf()</code></a>:</strong></p>\n\n<p>Read about the different format specifier <a href=\"http://en.cppreference.com/w/cpp/io/c/scanf\" rel=\"nofollow noreferrer\">here on cppreference</a>.<br>\nIn you code you're using:</p>\n\n<pre><code>char message[100];\nscanf(\"%d\", &amp;message);\n</code></pre>\n\n<p>but instead of <code>%d</code> which is used for <code>int</code> it should be <code>%s</code> for C-strings (<code>char*</code>). Better use <code>%99s</code> to avoid a <a href=\"https://stackoverflow.com/questions/1621394/how-to-prevent-scanf-causing-a-buffer-overflow-in-c\">string format vulnerability</a>. Further it should be just <code>message</code> without the ampersand (<code>&amp;</code>) because <a href=\"https://stackoverflow.com/questions/1461432/what-is-array-decaying\">the array name will decay</a> to a <code>char*</code> but <code>&amp;message</code> will be a pointer to an array: <code>char (*)[100]</code>. This would result in a warning because <code>%s</code> expects <code>char*</code>.</p>\n\n<pre><code>char message[100];\nif (1 != scanf(\"%99s\", message)) /* buffer size - 1 */\n   return EXIT_FAILURE;\n</code></pre>\n\n<p>Moreover <code>scanf()</code> returns the number of successful read elements. I recommend always check the return values that indicate errors.</p>\n\n<p><strong>2. Logical error in decryption:</strong></p>\n\n<p>Instead of checking <code>message[i] &gt; 'z'</code> it must be <code>message[i] &lt; 'a'</code> as you're subtracting the <code>shift</code> value. Further add 26 instead of subtracting it in that case.</p>\n\n<pre><code>for (i = 0; message[i] != '\\0'; i++)\n{\n   message[i] = message[i] - shift;\n   if (message[i] &lt; 'a')\n      message[i] = message[i] + 26;\n}\n</code></pre>\n\n<hr>\n\n<p><strong>Edit #1:</strong></p>\n\n<p>There is also another logical problem about the message you type in. Your code will only work for messages that consists of lower letters. You can extend that to work with upper letters to.</p>\n\n<p>Further your buffer will may hold <code>signed char</code>s<sup>1</sup> as it is declared as <code>char message[100];</code>, that means if the calculation: <code>message[i] = message[i] + shift;</code> <a href=\"https://stackoverflow.com/questions/18195715/why-is-unsigned-integer-overflow-defined-behavior-but-signed-integer-overflow-is\">overflows the bahaviour is undefined</a>. That would happen for example if you use character <code>z</code> (decimal 122 in <a href=\"http://www.asciitable.com/\" rel=\"nofollow noreferrer\">ASCII code</a>) and a <code>shift</code> of 6 which will lead to 128 but a <code>signed char</code> can hold at most 127.</p>\n\n<hr>\n\n<p><sup>1</sup> I write <em>\"may hold <code>signed char</code>s\"</em> because the C standard leaves it up to the implementation to <a href=\"https://stackoverflow.com/questions/2054939/is-char-signed-or-unsigned-by-default\">define wether a <code>char</code> is <code>signed</code> or <code>unsigned</code></a>, but for GCC and MSVC a <code>char</code> will be a <code>signed char</code> by default.</p>\n"}], "owner": {"reputation": 43, "user_id": 8563093, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/180737b728612203560652ded6bc1292?s=128&d=identicon&r=PG&f=1", "display_name": "popcorn", "link": "https://stackoverflow.com/users/8563093/popcorn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4743, "favorite_count": 1, "accepted_answer_id": 46053993, "answer_count": 1, "score": -1, "last_activity_date": 1504698625, "creation_date": 1504608740, "last_edit_date": 1504610291, "question_id": 46053182, "link": "https://stackoverflow.com/questions/46053182/caesar-cipher-in-c-encryption-and-decryption", "title": "Caesar cipher in C - encryption and decryption", "body": "<p>I made this program and seems that doesn't work can you tell me why? I spent like 3 hours just figuring out why it's not working but I have no clue. I'm wondering if it's not something with shift but I'm not sure. That's my first program I'm making so sorry about some basic mistakes.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main(int argc, char** argv) {\n\n   char message[100];\n   int shift;\n   int i;\n   int choice;\n\n   printf(\"Enter operation with message\\n\");\n   printf(\"encrypt - 1\\n\");\n   printf(\"decrypt - 2\\n\");\n   scanf(\"%d\", &amp;choice);\n\n   switch(choice)\n   {\n      case 1:\n      {\n         printf(\"Enter message to encrypt\\n\");\n         scanf(\"%d\", &amp;message);\n\n         printf(\"Enter shift\\n\");\n         scanf(\"%d\", &amp;shift);\n\n         for (i = 0; message[i] != '\\0'; i++)\n         {\n            message[i] = message[i] + shift;\n            if (message[i] &gt; 'z')\n               message[i] = message[i] - 26;\n         }\n         printf(\"Encrypted message: %s\\n\", message);\n         break;\n      }\n      case 2: \n      {\n         printf(\"Enter message to decrypt\\n\");\n         scanf(\"%d\", &amp;message);\n\n         printf(\"Enter shift\\n\");\n         scanf(\"%d\", &amp;shift);\n\n         for (i = 0; message[i] != '\\0'; i++)\n         {\n            message[i] = message[i] - shift;\n            if (message[i] &gt; 'z')\n               message[i] = message[i] - 26;\n         }\n         printf(\"Decrypted message: %s\\n\", message);\n         break;\n      }\n   }\n\n   return (EXIT_SUCCESS);\n}\n</code></pre>\n\n<p>Here a screen of output:</p>\n\n<p><a href=\"https://i.stack.imgur.com/oy2Q3.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/oy2Q3.png\" alt=\"screenshot\"></a></p>\n"}, {"tags": ["c", "null", "segmentation-fault", "trie", "cs50"], "comments": [{"owner": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 0, "creation_date": 1504608099, "post_id": 46052907, "comment_id": 79065195, "body": "You need to debug your code, so you figure out which line your code segfaults at. You also need to do error handling and validation in your code. e.g. these lines:  <code>int alpha = (tolower(*c) - 97); if(trav -&gt; children[alpha] == NULL)</code> is not something you can do, you have to know if your input is valid, so you have to check if <code>alpha</code> is <code>&gt;= 0</code> and <code>&lt; 27</code> before you can go on and use it as an index in <code>trav -&gt; children[alpha]</code>"}, {"owner": {"reputation": 10774, "user_id": 4419802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d0f1bd19b8b8481b6b3e812691c1ccb?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/4419802/matt"}, "edited": false, "score": 1, "creation_date": 1504608332, "post_id": 46052907, "comment_id": 79065311, "body": "<code>char *c = NULL;</code> You&#39;ve never allocated memory for <code>c</code>, so fscanf faults while writing in it."}, {"owner": {"reputation": 13033, "user_id": 4029014, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/ndZhu.jpg?s=128&g=1", "display_name": "aghast", "link": "https://stackoverflow.com/users/4029014/aghast"}, "edited": false, "score": 0, "creation_date": 1504613300, "post_id": 46052907, "comment_id": 79068545, "body": "<code>fscanf</code> wants a pointer to a place to store the incoming data. You have set <code>c</code> to <code>NULL</code> and pass that to <code>fscanf</code>, so when you read a line it tries to write through the null pointer. Create a line buffer, of, say, 256 chars, and pass that as the argument to <code>fscanf</code>."}, {"owner": {"reputation": 13033, "user_id": 4029014, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/ndZhu.jpg?s=128&g=1", "display_name": "aghast", "link": "https://stackoverflow.com/users/4029014/aghast"}, "edited": false, "score": 0, "creation_date": 1504613429, "post_id": 46052907, "comment_id": 79068629, "body": "Also, when you allocate a new node you don&#39;t zero the memory. Try calling <code>calloc</code> instead. Better still, write a separate function to allocate, initialize, and return the node pointer."}, {"owner": {"reputation": 41, "user_id": 7899200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ae63499423fd69fbae5e11cff32c0c3?s=128&d=identicon&r=PG&f=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/7899200/jason"}, "edited": false, "score": 0, "creation_date": 1504686453, "post_id": 46052907, "comment_id": 79101096, "body": "What would the return function do?"}], "answers": [{"tags": [], "owner": {"reputation": 9095, "user_id": 8542346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11b206b49cec657d28a5876f8330780e?s=128&d=identicon&r=PG&f=1", "display_name": "H.S.", "link": "https://stackoverflow.com/users/8542346/h-s"}, "is_accepted": true, "score": 0, "last_activity_date": 1504613982, "creation_date": 1504613982, "answer_id": 46054845, "question_id": 46052907, "link": "https://stackoverflow.com/questions/46052907/load-function-trie-segmentation-fault/46054845#46054845", "title": "Load function trie segmentation fault", "body": "<p>The cause of segmentation fault is the pointer \"c\" which you have not allocated memory.</p>\n\n<p>Also, in your program -</p>\n\n<pre><code>//scan the file char by char until end and store it in c\nwhile(fscanf(dptr,\"%s\",c) != EOF)\n</code></pre>\n\n<p>Once you allocate memory to pointer c, c will hold the word read from file dictionary.\nBelow in your code, you are checking for '\\0' character-</p>\n\n<pre><code>   while ((*c) != '\\0')\n   {\n</code></pre>\n\n<p>But you are not moving the c pointer to point to next character in the string read because of which this code will end up executing infinite while loop.\nMay you can try something like this-</p>\n\n<pre><code>char *tmp;\ntmp = c;\nwhile ((*tmp) != '\\0')\n{\n     ......\n     ......\n     //Below in the loop at appropriate place\n     tmp++;\n}\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 7899200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ae63499423fd69fbae5e11cff32c0c3?s=128&d=identicon&r=PG&f=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/7899200/jason"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 168, "favorite_count": 0, "accepted_answer_id": 46054845, "answer_count": 1, "score": 0, "last_activity_date": 1504613982, "creation_date": 1504607760, "question_id": 46052907, "link": "https://stackoverflow.com/questions/46052907/load-function-trie-segmentation-fault", "title": "Load function trie segmentation fault", "body": "<p>I keep getting segfault for my load function.</p>\n\n<pre><code>    bool load(const char *dictionary)\n{\n    //create a trie data type\n   typedef struct node\n   {\n        bool is_word;\n        struct node *children[27]; //this is a pointer too!  \n   }node;\n\n   //create a pointer to the root of the trie and never move this (use traversal *)\n   node *root = malloc(sizeof(node));\n   for(int i=0; i&lt;27; i++)\n   {\n       //NULL point all indexes of root -&gt; children\n       root -&gt; children[i] = NULL;\n   }\n\n\n   FILE *dptr = fopen(dictionary, \"r\");\n   if(dptr == NULL)\n   {\n       printf(\"Could not open dictionary\\n\");\n       return false;\n   }\n\n\n\n   char *c = NULL;\n\n\n   //scan the file char by char until end and store it in c\n   while(fscanf(dptr,\"%s\",c) != EOF)\n   {\n       //in the beginning of every word, make a traversal pointer copy of root so we can always refer back to root\n       node *trav = root;\n\n       //repeat for every word\n       while ((*c) != '\\0')\n       {\n        //convert char into array index\n       int alpha = (tolower(*c) - 97);\n\n       //if array element is pointing to NULL, i.e. it hasn't been open yet,\n        if(trav -&gt; children[alpha] == NULL)\n            {\n            //then create a new node and point it with the previous pointer. \n            node *next_node = malloc(sizeof(node));\n            trav -&gt; children[alpha] = next_node; \n\n            //quit if malloc returns null\n            if(next_node == NULL)\n                {\n                    printf(\"Could not open dictionary\");\n                    return false;\n                }\n\n            }\n\n        else if (trav -&gt; children[alpha] != NULL)\n            {\n            //if an already existing path, just go to it\n            trav = trav -&gt; children[alpha];\n            }   \n       }\n        //a word is loaded. \n        trav -&gt; is_word = true;\n   }\n   //success\n   free(root);\n   return true;\n}\n</code></pre>\n\n<p>I checked whether I properly pointed new pointers to NULL during initialization. I have three types of nodes: root, traversal (for moving), and next_node. (i.) Am I allowed to null point the nodes before mallocing them? (ii.) Also, how do I free 'next_node' if that node is initialized and malloced inside an if statement? <code>node *next_node = malloc(sizeof(node));</code> (iii.) If I want to set the nodes as global variables, which ones should be global? (iv.) Lastly, where do I set global variables: inside the main of speller.c, outside its main, or somewhere else? That's alot of questions, so you don't have to answer all of them, but it would be nice if you could answer the answered ones! Please point out any other peculiarities in my code. There should be plenty. I will accept most answers.</p>\n"}, {"tags": ["c", "arrays", "function"], "comments": [{"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "edited": false, "score": 10, "creation_date": 1504606762, "post_id": 46052542, "comment_id": 79064370, "body": "May be use a <a href=\"https://en.wikipedia.org/wiki/Struct_(C_programming_language)\" rel=\"nofollow noreferrer\"><code>struct</code></a>?"}, {"owner": {"reputation": 1820, "user_id": 3849158, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/q1Gcg.png?s=128&g=1", "display_name": "izlin", "link": "https://stackoverflow.com/users/3849158/izlin"}, "edited": false, "score": 1, "creation_date": 1504606823, "post_id": 46052542, "comment_id": 79064408, "body": "Why don&#39;t you use a struct for all your data and pass a struct pointer to your function? Much less data to copy."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1504606891, "post_id": 46052542, "comment_id": 79064455, "body": "..and possibly a pointer to it, if copying the struct is expensive, undesired or even dangerous in your design."}, {"owner": {"reputation": 179, "user_id": 8524379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a324306a2482a3424a5f9a92f6beac1?s=128&d=identicon&r=PG&f=1", "display_name": "Guillermo. D. S.", "link": "https://stackoverflow.com/users/8524379/guillermo-d-s"}, "edited": false, "score": 0, "creation_date": 1504606976, "post_id": 46052542, "comment_id": 79064509, "body": "Wow, structures sound promising, I&#39;ll give it a look! Thx"}, {"owner": {"reputation": 23612, "user_id": 147407, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/65f858d8a973f4ee8d97517a21a17e7d?s=128&d=identicon&r=PG", "display_name": "Andrejs Cainikovs", "link": "https://stackoverflow.com/users/147407/andrejs-cainikovs"}, "edited": false, "score": 0, "creation_date": 1504607729, "post_id": 46052542, "comment_id": 79064982, "body": "You&#39;re talking about array of unions, but you want to use structs."}, {"owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "edited": false, "score": 1, "creation_date": 1504615335, "post_id": 46052542, "comment_id": 79069886, "body": "Define &quot;large&quot;.  More than 10?  More than 20?  Are they logically related to each other (i.e., <i>attributes</i> of a single data item) or not?  What does your function do with all these variables?  Don&#39;t use a <code>struct</code> type to collect attributes that aren&#39;t otherwise related to each other <i>just</i> to avoid passing lots of parameters."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1504620199, "post_id": 46052542, "comment_id": 79073654, "body": "&quot;Is there a way to leave unspecified the type of data stored into the matrix?&#39;  There is a way, yet how then does your function determine what data it received as it is unspecified?"}], "answers": [{"comments": [{"owner": {"reputation": 6009, "user_id": 3313438, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/Ks9C6.jpg?s=128&g=1", "display_name": "Ziezi", "link": "https://stackoverflow.com/users/3313438/ziezi"}, "edited": false, "score": 0, "creation_date": 1504607956, "post_id": 46052603, "comment_id": 79065114, "body": "Why not an array of pointers of type void and use index to identify type inside the function?"}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "reply_to_user": {"reputation": 6009, "user_id": 3313438, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/Ks9C6.jpg?s=128&g=1", "display_name": "Ziezi", "link": "https://stackoverflow.com/users/3313438/ziezi"}, "edited": false, "score": 1, "creation_date": 1504608140, "post_id": 46052603, "comment_id": 79065214, "body": "@Ziezi 1) It involves extra dereference. 2.) It is less type safe."}], "tags": [], "owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "is_accepted": false, "score": 8, "last_activity_date": 1504606872, "creation_date": 1504606872, "answer_id": 46052603, "question_id": 46052542, "link": "https://stackoverflow.com/questions/46052542/passing-array-of-variables-to-function-in-c/46052603#46052603", "title": "passing array of variables to function in C", "body": "<p>The elements of an array are always of a single type, that's the point.</p>\n\n<p>Collecting variables of multiple types is the job for a structure, i.e. a <code>struct</code>.</p>\n\n<p>This is a quite common way to solve this particular problem. If the structure becomes large, you might find it convenient to pass a <em>pointer</em> to an instance of it, rather than copying the entire thing in the call.</p>\n"}, {"comments": [{"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 1, "creation_date": 1504607979, "post_id": 46052856, "comment_id": 79065133, "body": "Just mentioning <code>va_list</code> is not enough. There needs to be a way to identify parameters, and your answer doesn&#39;t explain that at all."}], "tags": [], "owner": {"reputation": 732, "user_id": 3779533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb7ceb7c47ce798288bf7e7baaa7129c?s=128&d=identicon&r=PG&f=1", "display_name": "Ivan Sheigets", "link": "https://stackoverflow.com/users/3779533/ivan-sheigets"}, "is_accepted": false, "score": 0, "last_activity_date": 1504607578, "creation_date": 1504607578, "answer_id": 46052856, "question_id": 46052542, "link": "https://stackoverflow.com/questions/46052542/passing-array-of-variables-to-function-in-c/46052856#46052856", "title": "passing array of variables to function in C", "body": "<p>You can use va_list but struct is the best way to do it</p>\n"}, {"comments": [{"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1504608265, "post_id": 46052895, "comment_id": 79065275, "body": "I&#39;m not sure this much complexity is needed. <code>union</code> lacks compile time type safety that simple pointer to struct would offer."}], "tags": [], "owner": {"reputation": 427, "user_id": 1548298, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/24c66a8e9bba418dfdbc1a5f0419a2de?s=128&d=identicon&r=PG", "display_name": "Maquefel", "link": "https://stackoverflow.com/users/1548298/maquefel"}, "is_accepted": false, "score": 0, "last_activity_date": 1504607700, "creation_date": 1504607700, "answer_id": 46052895, "question_id": 46052542, "link": "https://stackoverflow.com/questions/46052542/passing-array-of-variables-to-function-in-c/46052895#46052895", "title": "passing array of variables to function in C", "body": "<pre><code>#define _GNU_SOURCE\n\n#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n\n#include &lt;stdint.h&gt;\n#include &lt;stddef.h&gt;\n\nenum type {\n        INT,\n        FLOAT,\n        PCHAR,\n};\n\nstruct any_type {\n        enum type type_;\n        union {\n                int int_;\n                float float_;\n                char* pchar_;\n        };\n};\n\n#define MYSIZE 10\n\nvoid process(size_t size, struct any_type* array)\n{\n        for(int i = 0; i &lt; size; i++) {\n                switch(array[i].type_) {\n                        case INT :\n                                printf(\"INT: %d\\n\", array[i].int_);\n                                break;\n                        case FLOAT :\n                                printf(\"FLOAT: %f\\n\", array[i].float_);\n                                break;\n                        case PCHAR :\n                                printf(\"PCHAR: %s\\n\", array[i].pchar_);\n                                break;\n                        default:\n                                printf(\"UNKNOWN TYPE PROVIDED\\n\");\n                                break;\n                }\n        }\n}\n\nint main(int argc, char *argv[])\n{\n  struct any_type *array;\n  array = malloc(MYSIZE*(sizeof(struct any_type)));\n\n  array[0].type_ = INT;\n  array[0].int_ = 10;\n\n  array[1].type_ = FLOAT;\n  array[1].float_ = 2.5;\n\n  array[2].type_ = PCHAR;\n  array[2].pchar_ = \"hello char\";\n\n  process(3, array);\n\n  return 0;\n}\n</code></pre>\n\n<p>You can extend type and union as needed. However using nameless unions require -std=c11.</p>\n"}, {"comments": [{"owner": {"reputation": 179, "user_id": 8524379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a324306a2482a3424a5f9a92f6beac1?s=128&d=identicon&r=PG&f=1", "display_name": "Guillermo. D. S.", "link": "https://stackoverflow.com/users/8524379/guillermo-d-s"}, "edited": false, "score": 0, "creation_date": 1504717720, "post_id": 46058273, "comment_id": 79123258, "body": "I&#39;m giving struct a go (trying right now). I get your concern about the amount of data, but this function is to perform a physical simulation which just requires several physical variables, it won&#39;t be easy to reduce this number  :-("}], "tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": false, "score": 0, "last_activity_date": 1504625293, "last_edit_date": 1504625293, "creation_date": 1504624233, "answer_id": 46058273, "question_id": 46052542, "link": "https://stackoverflow.com/questions/46052542/passing-array-of-variables-to-function-in-c/46058273#46058273", "title": "passing array of variables to function in C", "body": "<p>Expanding on my comment above:</p>\n\n<p>Needing to pass a large number of parameters<sup>1</sup> to a function <em>can</em> be a sign that there is a problem in your design - your function may be trying to do too many things at once, and you would be better off refactoring it into several smaller functions, each of which only takes a subset of the parameters.</p>\n\n<p>Assuming that's not the case, how are your parameters logically related to each other?  Can they be considered <em>attributes</em> of a single data item?  For example, a person may be described by the following attributes: surname, given name, birth date, sex.  These can be collected together into a single <code>struct</code> type such as</p>\n\n<pre><code>#include &lt;time.h&gt;\n\nstruct person {\n  char *surname; \n  char *name;\n  struct tm birthdate; // struct tm defined in time.h\n  char sex;\n};\n\nvoid write_to( struct person *p )\n{\n  p-&gt;surname = strdup( \"McGillicuddy\" ); \n  p-&gt;name = strdup( \"Aloysius\" );\n  p-&gt;sex = 'M';\n  p-&gt;birthdate.tm_year = 32; // tm_year starts at 1900, so this is 1932\n  p-&gt;birthdate.tm_mon = 11;  // december\n  p-&gt;birthdate.tm_day = 1;   \n};\n\nint main( void )\n{\n  struct person p;\n  ...\n  write_to( &amp;p );\n  ...\n}\n</code></pre>\n\n<p>Note that members of <code>struct</code> types can themselves be <code>struct</code> types - <a href=\"http://pubs.opengroup.org/onlinepubs/7908799/xsh/time.h.html\" rel=\"nofollow noreferrer\"><code>struct tm</code></a> is a type defined in <code>time.h</code> that specifies a datetime value using multiple attributes.</p>\n\n<p>Some notes on syntax:</p>\n\n<p>When you want to access a member of a <code>struct</code> instance, use the <code>.</code> operator.  When you want to access a member of a <code>struct</code> through a <em>pointer</em>, use the <code>-&gt;</code> operator.  In the function <code>write_to</code>, <code>p</code> is a pointer to <code>struct person</code>, so to access each member of <code>p</code> we use <code>-&gt;</code>.  The <code>birthdate</code> member is an <em>instance</em> of <code>struct tm</code>, not a pointer, so we use the <code>.</code> operator to access each member of <code>birthdate</code>.  </p>\n\n<p><code>p-&gt;m</code> is equivalent to <code>(*p).m</code>.  </p>\n\n<p>Like I said in my comment, you should <em>not</em> collect otherwise unrelated items into a <code>struct</code> type <em>just</em> to reduce the number of parameters being passed to a function.  They should all be attributes of a more complex type.  Some other examples of what I mean:</p>\n\n<pre><code>// A node in a list\nstruct node {\n  data_t data; // for some data type data_t;\n  struct node *next;\n  struct node *prev;\n};\n\n// A street address\nstruct addr {\n  char *number; // to handle things like 102A, 102B\n  char *street;\n  char *city;\n  char state[3];\n  char *zip;\n};\n</code></pre>\n\n<p>It's possible that you're really passing only a couple of distinct data items to your function, each of which is composed of a lot of different attributes.  Take a step back and look at your variables and see how they relate to each other.  </p>\n\n<p><hr>\n<sup></p>\n\n<ol>\n<li>\"Large\" depends on context, and of course there are always exceptions to any rule, but in general passing more than 7 distinct, unrelated parameters is a sign you may need to refactor your function into several smaller functions.  \n</ol>\n\n<p></sup></p>\n"}], "owner": {"reputation": 179, "user_id": 8524379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a324306a2482a3424a5f9a92f6beac1?s=128&d=identicon&r=PG&f=1", "display_name": "Guillermo. D. S.", "link": "https://stackoverflow.com/users/8524379/guillermo-d-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "answer_count": 4, "score": 2, "last_activity_date": 1504625293, "creation_date": 1504606681, "question_id": 46052542, "link": "https://stackoverflow.com/questions/46052542/passing-array-of-variables-to-function-in-c", "title": "passing array of variables to function in C", "body": "<p>I have a C function which needs a large amount of variables to be passed, so I came to the idea of \"packing\" them all in a single array (matrix of variables). The point is, these variables are of a very different type, some int, some arrays (strings and vectors), and many of them float. Is there a way to leave unspecified the type of data stored into the matrix? (I unsuccessfully explored the void \"data type\")</p>\n"}, {"tags": ["c", "arrays", "printf", "sigabrt"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 2, "creation_date": 1504605899, "post_id": 46052271, "comment_id": 79063841, "body": "<code>scanf(&quot;%s&quot;,x);</code> --&gt; <code>scanf(&quot;%24s&quot;,x);</code>"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1504605998, "post_id": 46052271, "comment_id": 79063902, "body": "What is <code>97</code>?  What is <code>122</code>?  Why  are you adding <code>32</code>?"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1504606000, "post_id": 46052271, "comment_id": 79063905, "body": "What is your input? What is your expected output?"}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1504606098, "post_id": 46052271, "comment_id": 79063972, "body": "Have you actually tried debugging this?  I&#39;d expect you to have run your <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> within Valgrind or a similar checker, and to have investigated with a debugger such as GDB.  Please <a href=\"https://stackoverflow.com/posts/46052271/edit\">edit</a> your question to summarize what the debugging tools told you and why they didn&#39;t solve your problem.  And read Eric Lippert&#39;s <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">How to debug small programs</a>."}, {"owner": {"reputation": 40001, "user_id": 2681632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YnXs3.png?s=128&g=1", "display_name": "Ilja Everil&#228;", "link": "https://stackoverflow.com/users/2681632/ilja-everil%c3%a4"}, "edited": false, "score": 0, "creation_date": 1504606109, "post_id": 46052271, "comment_id": 79063979, "body": "You might be interested in <code>isupper()</code>, <code>islower()</code>, <code>toupper()</code> and <code>tolower()</code>."}, {"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "edited": false, "score": 1, "creation_date": 1504606145, "post_id": 46052271, "comment_id": 79064011, "body": "Don&#39;t say <code>97</code> when you can say <code>&#39;a&#39;</code>. The latter is portable and readable. The former is neither."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1504606185, "post_id": 46052271, "comment_id": 79064039, "body": "Hint: avoid &quot;magic&quot; numbers such as 97, 122, 65, 90, 32 etc. Use <code>&#39;a&#39;</code>, <code>&#39;z&#39;</code>, <code>&#39;A&#39;</code>, <code>&#39;Z&#39;</code> , <code>&#39;a&#39; - &#39;A&#39;</code> etc."}, {"owner": {"reputation": 739, "user_id": 8281970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/abHXs.jpg?s=128&g=1", "display_name": "Ketan Mukadam", "link": "https://stackoverflow.com/users/8281970/ketan-mukadam"}, "edited": false, "score": 0, "creation_date": 1504606316, "post_id": 46052271, "comment_id": 79064128, "body": "As a side note, read this <a href=\"https://stackoverflow.com/questions/3413166/when-does-a-process-get-sigabrt-signal-6\">when does process get SIGABRT</a>"}], "answers": [{"tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 1, "last_activity_date": 1504606316, "last_edit_date": 1504606316, "creation_date": 1504605968, "answer_id": 46052310, "question_id": 46052271, "link": "https://stackoverflow.com/questions/46052271/sigabrt-error-in-c-programing/46052310#46052310", "title": "Sigabrt error in c programing", "body": "<p>Think of the difference between the source and the destination array, something is missing in the destination. The null-terminator.</p>\n\n<p><em>Note: Both the arrays are local variable with automatic storage and unless initialized explicitly, their content is indeterminate.</em></p>\n\n<p>Without a null-terminator in place, <code>printf()</code> will go out of bound for the supplied array while printing with <code>%s</code> which invokes <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">undefined behavior</a>.</p>\n\n<p>The easiest way to handle this is zero-initilize the arrays, like</p>\n\n<pre><code>  char x[25] = {0} ,y[25] = {0};\n</code></pre>\n\n<p>which makes all the elements of the arrays set to 0, and the same value being used as null-terminator, you are not required to add one manually to the destination array.</p>\n\n<p>Also, FWIW,</p>\n\n<ul>\n<li><p>You should length-limit the input to prevent buffer overflow from longer than expected input, using something along the line <code>scanf(\"%24s\",x);</code></p></li>\n<li><p>better to use <code>fgets()</code> to take the user input. If, iff, you have to use <code>scanf()</code>,you can use it but please use proper error checking.</p></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 868, "user_id": 4402433, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9bce35bd631fc9215f7885d6d0c84366?s=128&d=identicon&r=PG&f=1", "display_name": "Sathiya", "link": "https://stackoverflow.com/users/4402433/sathiya"}, "is_accepted": false, "score": 0, "last_activity_date": 1504606442, "creation_date": 1504606442, "answer_id": 46052456, "question_id": 46052271, "link": "https://stackoverflow.com/questions/46052271/sigabrt-error-in-c-programing/46052456#46052456", "title": "Sigabrt error in c programing", "body": "<p>If the input is less than 25 characters, then the string will be null terminated. If the size exceeds the array size specified then it overwrites the memory not belonging to the array.</p>\n\n<p>So <code>fgets()</code> is the alternative for <code>scanf()</code> in such case.</p>\n"}], "owner": {"reputation": 1, "user_id": 8436047, "user_type": "registered", "profile_image": "https://graph.facebook.com/888454107973786/picture?type=large", "display_name": "Arpit Aggarwal", "link": "https://stackoverflow.com/users/8436047/arpit-aggarwal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1278, "favorite_count": 0, "answer_count": 2, "score": -3, "last_activity_date": 1504606757, "creation_date": 1504605833, "last_edit_date": 1504606757, "question_id": 46052271, "link": "https://stackoverflow.com/questions/46052271/sigabrt-error-in-c-programing", "title": "Sigabrt error in c programing", "body": "<p>plz help me to remove SIBABRT error for the following code,plz suggest me why this error occurs even after getting correct output</p>\n\n<pre><code>#include&lt;stdio.h&gt; \n#include&lt;string.h&gt;\n\nint main()\n{\nchar x[25],y[25];\nint i,j=0;\nscanf(\"%s\",x);\nfor(i=0;i&lt;strlen(x);i++)\n{\n    if(x[i]&gt;=97 &amp;&amp; x[i]&lt;=122)\n    {\n        y[j]=x[i]-32;\n        j++;\n    }\n    else if(x[i]&gt;=65 &amp;&amp; x[i]&lt;=90)\n    {\n        y[j]=x[i]+32;\n        j++;\n    }\n\n}\nprintf(\"%s\",y);}\n</code></pre>\n"}]