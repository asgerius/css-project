[{"tags": ["c", "function", "void"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 2, "creation_date": 1564616539, "post_id": 57300103, "comment_id": 101093863, "body": "<code>=</code> is for assignment, <code>==</code> is for comparison. But if you want to compare strings, you have to use <code>strcmp()</code>."}, {"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 0, "creation_date": 1564616778, "post_id": 57300103, "comment_id": 101093916, "body": "You cannot directly compare arrays by value in C.  You must use a function or compare each individual element yourself.  BTW, thank you for enabling warnings.  It will serve you well in the future."}], "answers": [{"tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": true, "score": 1, "last_activity_date": 1564616855, "creation_date": 1564616855, "answer_id": 57300165, "question_id": 57300103, "link": "https://stackoverflow.com/questions/57300103/assignment-to-expression-with-array-type-error-in-c-functions-used-in-if-stateme/57300165#57300165", "title": "assignment to expression with array type error in C functions used in if statements", "body": "<p>The first error is because you're using <code>=</code> instead of <code>==</code> in your <code>if</code> statements. <code>=</code> is for assignment, <code>==</code> is for comparing for equality. But in order to compare strings, you have to use the <code>strcmp()</code> function; if you use <code>==</code>, it just compares the addresses of the arrays, not the contents.</p>\n\n<p>The error about implicit declarations is because you put the definitions of <code>command1</code> and <code>command2</code> after <code>main()</code>. C requires functions to be defined or declared before they're used, so you either have to move <code>main()</code> down, or put function prototypes before it.</p>\n\n<p>You also need to initializze <code>commandA</code> and <code>commandB</code>.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nvoid command1(){\n    printf(\"i don't know what to type here \");\n}\nvoid command2(){\n    printf(\"i don't know what to type here x2\");\n}\n\nint main()\n{\n    char commandA[20] = \"cmdA\";    \n    char commandB[20] = \"cmdB\";\n    char click [20];\n\n    scanf(\"%s\",click);\n    if (strcmp(click, commandA) == 0){\n        command1();\n    } else if (strcmp(click, commandB) == 0){\n        command2();\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 11839468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QgQmg.jpg?s=128&g=1", "display_name": "darth liutas", "link": "https://stackoverflow.com/users/11839468/darth-liutas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 57300165, "answer_count": 1, "score": -1, "last_activity_date": 1564616855, "creation_date": 1564616270, "last_edit_date": 1564616622, "question_id": 57300103, "link": "https://stackoverflow.com/questions/57300103/assignment-to-expression-with-array-type-error-in-c-functions-used-in-if-stateme", "title": "assignment to expression with array type error in C functions used in if statements", "body": "<p>so i was trying to make a choice-like code where you type something to get a command to run and you type something else to run an other command,and i tried to do this with functions with the void command since i am trying to learn and figure out how to use it but for some reason i keep getting this error message that i don't really understand what it means or how to solve it (this might be a obvious thing but i am still learning soooo)</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n\nint main()\n{\n    char commandA[20];    \n    char commandB[20];\n    char click [20];\n\n    scanf(\"%s\",click);\n    if (click=commandA){\n        command1();\n    } else if (click=commandB){\n        command2();\n    }\n}\n\nvoid command1(){\n    printf(\"i don't know what to type here \");\n}\nvoid command2(){\n    printf(\"i don't know what to type here x2\");\n}\n}\n</code></pre>\n\n<p>i expect to be able to type commandA and get the first printf message and i expect to able to type commandB to get the second printf message and here are the other warnings and errors i got : </p>\n\n<pre><code>|11|error: assignment to expression with array type|\n|12|error: assignment to expression with array type|\n|11|warning: implicit declaration of function 'command1' [-Wimplicit-function-declaration]|\n|12|warning: implicit declaration of function 'command2' [-Wimplicit-function-declaration]|\n|14|warning: conflicting types for 'command1'|\n|16|warning: conflicting types for 'command2'|\n</code></pre>\n"}, {"tags": ["c", "loops"], "comments": [{"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 1, "creation_date": 1564616166, "post_id": 57299998, "comment_id": 101093791, "body": "<code>characterName = malloc(sizeof(char));</code> You allocate memory only for a zero terminating character. There is no memory for a <code>yes</code> or <code>no</code> string. There is no memory to read a name into."}], "answers": [{"tags": [], "owner": {"reputation": 457, "user_id": 9821289, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "sgillen", "link": "https://stackoverflow.com/users/9821289/sgillen"}, "is_accepted": false, "score": 4, "last_activity_date": 1564616158, "creation_date": 1564616158, "answer_id": 57300086, "question_id": 57299998, "link": "https://stackoverflow.com/questions/57299998/want-to-create-some-kind-of-a-loop-for-this-code/57300086#57300086", "title": "Want to create some kind of a loop for this code", "body": "<p>Like most things in programming, there are many ways to do what you are asking. </p>\n\n<p>One way is to introduce a new variable, called yes_entered or something similar, that will track if the user has entered yes yet. Then inside the if statement where you check if yes was entered you can set this variable to true. To make this into a loop you can put the code you want to repeat inside a <code>while(!yes_entered){</code> loop. </p>\n\n<p>One other thing,  these lines:</p>\n\n<pre><code>characterName = malloc(sizeof(char));\nyes_no = malloc(sizeof(char));\n</code></pre>\n\n<p>are going to cause you problems. You are allocating the two char arrays to be the size of one char. For this case you should probably consider picking a maximum character length and then making these two variables static char arrays. something like:</p>\n\n<pre><code>char characterName[MAX_NAME_LENGTH] ;\nchar yes_no[MAX_CONF_LENGTH];\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 45, "user_id": 11866452, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-s9wPnbUcheQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc8hW-spFK93aAoXcof_UnXsdrpEA/photo.jpg?sz=128", "display_name": "Veljox Marjanovic", "link": "https://stackoverflow.com/users/11866452/veljox-marjanovic"}, "edited": false, "score": 1, "creation_date": 1564623957, "post_id": 57300108, "comment_id": 101095168, "body": "Thank you very much, i like that you&#39;ve put whole code with loop in it, because i&#39;m new and i&#39;m still learning. Appreciate it! :D"}], "tags": [], "owner": {"reputation": 1072, "user_id": 3488735, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/8DatZ.jpg?s=128&g=1", "display_name": "Gewure", "link": "https://stackoverflow.com/users/3488735/gewure"}, "is_accepted": true, "score": 3, "last_activity_date": 1564616772, "last_edit_date": 1564616772, "creation_date": 1564616301, "answer_id": 57300108, "question_id": 57299998, "link": "https://stackoverflow.com/questions/57299998/want-to-create-some-kind-of-a-loop-for-this-code/57300108#57300108", "title": "Want to create some kind of a loop for this code", "body": "<p>Ok, you got a implicit declaration warning for strcmp there, missing <code>#include &lt;string.h&gt;</code>, but code compiles great and it does what it should do so far. </p>\n\n<p>Now we add looping to it:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint main() {\n    char *characterName;\n    char *yes_no;\n\n    characterName = malloc(sizeof(char));\n    yes_no = malloc(sizeof(char));\n\n    printf(\"Enter you name: \");\n    scanf(\"%s\", characterName);\n    while(1) {\n        printf(\"Are you sure[Yes/No]: \");\n        scanf(\"%s\", yes_no);\n\n        if(strcmp(yes_no, \"Yes\") == 0 || strcmp(yes_no, \"yes\") == 0){\n            printf(\"Your name is %s\", characterName);\n            break;\n        }\n        else if(strcmp(yes_no, \"No\") == 0 || strcmp(yes_no, \"no\") == 0){\n            printf(\"Try again!\");\n        } else {\n            printf(\"Unknown command!\");\n        }\n    }\n\n  return 0;\n}\n</code></pre>\n\n<p>the code in the <code>while(1) { .. }</code> is always true ( 1 is true) untill you type 'yes' and the <code>break;</code> is hit. </p>\n\n<p>there are some memory-allocation issues, as pointed out by commentators. </p>\n\n<p>Try it here: <a href=\"https://onlinegdb.com/HJYRvokQH\" rel=\"nofollow noreferrer\">https://onlinegdb.com/HJYRvokQH</a> </p>\n"}], "owner": {"reputation": 45, "user_id": 11866452, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-s9wPnbUcheQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc8hW-spFK93aAoXcof_UnXsdrpEA/photo.jpg?sz=128", "display_name": "Veljox Marjanovic", "link": "https://stackoverflow.com/users/11866452/veljox-marjanovic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 57300108, "answer_count": 2, "score": 3, "last_activity_date": 1564632062, "creation_date": 1564615453, "last_edit_date": 1564632062, "question_id": 57299998, "link": "https://stackoverflow.com/questions/57299998/want-to-create-some-kind-of-a-loop-for-this-code", "title": "Want to create some kind of a loop for this code", "body": "<p>I'm new in programming I watched a tutorial for c (about 3 hours long) and I immediately  wrote this code. Now everything works fine, but I want to create some kind of loop, i will try to explain what I want as best as I can.</p>\n\n<p>Here is a code I wrote:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n\nint main()\n{\n    char *characterName;\n    char *yes_no;\n\n    characterName = malloc(sizeof(char));\n    yes_no = malloc(sizeof(char));\n\n    printf(\"Enter you name: \");\n    scanf(\"%s\", characterName);\n    printf(\"Are you sure[Yes/No]: \");\n    scanf(\"%s\", yes_no);\n\n    if(strcmp(yes_no, \"Yes\") == 0 || strcmp(yes_no, \"yes\") == 0)\n    {\n        printf(\"Your name is %s\", characterName);\n    }\n    else if(strcmp(yes_no, \"No\") == 0 || strcmp(yes_no, \"no\") == 0)\n    {\n        printf(\"Try again!\");\n    }\n    else\n    {\n        printf(\"Unknown command!\");\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>What it does is it basically asks you to enter your name and then to confirm it, if you type Yes or yes it will print what your name is, if you type No or no it will print try again, if you enter something else but Yes/yes or No/no it will print unknown command. Now what I want to know is how I can make a loop that will repeat over and over unless I type in yes.\nLike I entered no or unknown command I want it to ask me to enter my name again. I hope you can understand what I want to do and sorry for my bad English I'm still learning :D.</p>\n"}, {"tags": ["c", "resize", "cs50"], "comments": [{"owner": {"reputation": 30170, "user_id": 5231607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QzGsq.jpg?s=128&g=1", "display_name": "1201ProgramAlarm", "link": "https://stackoverflow.com/users/5231607/1201programalarm"}, "edited": false, "score": 0, "creation_date": 1564614818, "post_id": 57299534, "comment_id": 101093539, "body": "One problem I see is that you skip the padding going forward, but you don&#39;t skip it when rewinding (seeking backward) to duplicate a horizontal line."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1564627409, "post_id": 57299534, "comment_id": 101095784, "body": "Recommend to first practice good error checking.  Test the return values of all I/O functions <code>ftread, fwrite, ftell, fseek</code>."}], "owner": {"reputation": 1, "user_id": 11866239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd0e38dc311eb948cae832083af2d78e?s=128&d=identicon&r=PG&f=1", "display_name": "DavionKaizen", "link": "https://stackoverflow.com/users/11866239/davionkaizen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 94, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1564753206, "creation_date": 1564611573, "last_edit_date": 1564753206, "question_id": 57299534, "link": "https://stackoverflow.com/questions/57299534/stuck-on-resize-for-cs50-what-is-wrong-with-my-code", "title": "Stuck on resize for cs50. What is wrong with my code?", "body": "<p>While I was able to scale horizontally, the vertical scale alludes me. For smiley, what I'm using as a test subject, in this specific version the code  copies excess pixels after the face is complete and rather than scale it creates a constant colored bar going straight down the image. </p>\n\n<p>Other times it creates seemingly random results, such as duplicating the bottom half of the face multiple times, creating the bars at a different scale or having the bars produced edge downward to the right. </p>\n\n<p>I've tried nesting the loop with <code>fseek</code>, making it an individual loop both with and without a duplicate of the code, an if statement <code>(var &lt; sz (or n) - 1)</code> along with using <code>fseek</code> with <code>inptr</code> and <code>outptr</code> but while they've given various results none of them have scaled vertically.</p>\n\n<pre><code>for (int i = 0, oBiHeight = abs(oBi.biHeight); i &lt; oBiHeight; i++)\n{\n    for (int j = 0; j &lt; oBi.biWidth; j++)\n        {\n            // temporary storage\n            RGBTRIPLE triple;\n\n            // read RGB triple from infile\n            fread(&amp;triple, sizeof(RGBTRIPLE), 1, inptr);\n\n            // write RGB triple to outfile\n            for (int l = 0; l &lt; sz; l++)\n            {\n                    fwrite(&amp;triple, sizeof(RGBTRIPLE), 1, outptr);\n            }\n        }\n\n        // skip over padding, if any\n        fseek(inptr, padding, SEEK_CUR);\n\n        // then add it back (to demonstrate how)\n        for (int k = 0; k &lt; outPad; k++)\n        {\n            fputc(0x00, outptr);\n        }\n    for (int m = 0; m &lt; sz; m++)\n    {\n        fseek(inptr, - (bi.biWidth * sizeof(RGBTRIPLE)), SEEK_CUR);\n        // iterate over pixels in scanline\n        for (int j = 0; j &lt; oBi.biWidth; j++)\n        {\n            // temporary storage\n            RGBTRIPLE triple;\n\n            // read RGB triple from infile\n            fread(&amp;triple, sizeof(RGBTRIPLE), 1, inptr);\n\n            // write RGB triple to outfile\n            for (int l = 0; l &lt; sz; l++)\n            {\n                    fwrite(&amp;triple, sizeof(RGBTRIPLE), 1, outptr);\n            }\n        }\n\n        // skip over padding, if any\n        fseek(inptr, padding, SEEK_CUR);\n\n        // then add it back (to demonstrate how)\n        for (int k = 0; k &lt; outPad; k++)\n        {\n            fputc(0x00, outptr);\n        }\n    }\n}\n</code></pre>\n\n<p>I expected the output to scale both vertically and horizontally by a scale of <code>sz</code> which is input by the User. What am I doing to stop me from achieving those results?</p>\n"}, {"tags": ["c", "arrays", "string"], "comments": [{"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 1, "creation_date": 1564610401, "post_id": 57299328, "comment_id": 101092568, "body": "I believe the issue is that you have a two dimensional array and you are trying to treat it like an array of pointers.  You&#39;ll have to copy in the actual contents rather than trying to assign a pointer since it is in fact an array."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1564611194, "post_id": 57299328, "comment_id": 101092804, "body": "Use <code>strcpy()</code> to copy strings. Or change it to an array of pointers, and allocate the strings dynamically."}, {"owner": {"reputation": 941, "user_id": 7617604, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7f920ede1516b4f8460a1b0e554bc8b?s=128&d=identicon&r=PG&f=1", "display_name": "Burdui", "link": "https://stackoverflow.com/users/7617604/burdui"}, "edited": false, "score": 0, "creation_date": 1564655556, "post_id": 57299328, "comment_id": 101106534, "body": "As a sidenote: <code>scanf(&quot;%s&quot;, &amp;d);</code> should be <code>scanf(&quot;%s&quot;, d)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 2, "creation_date": 1564611329, "post_id": 57299491, "comment_id": 101092836, "body": "Casting to a pointer won&#39;t work at all. Arrays are not implemented as pointers."}, {"owner": {"reputation": 457, "user_id": 9821289, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "sgillen", "link": "https://stackoverflow.com/users/9821289/sgillen"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1564612230, "post_id": 57299491, "comment_id": 101093020, "body": "You&#39;re right, that&#39;s my mistake. Declaring n as an array of pointers would be the only way. In which case you would have to dynamically allocate the strings, as you mentioned above. However I did believe C arrays are implemented as pointers, with some amount of niceness from the compiler. If this is not the case could you please point me in the right direction to learn about the actual implementation."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 1, "creation_date": 1564654967, "post_id": 57299491, "comment_id": 101106208, "body": "&quot;<i>Although arrays are implemented with pointers in C</i>&quot; no, no, no, arrays are not pointers, nor are they &quot;implemented&quot; using them."}], "tags": [], "owner": {"reputation": 457, "user_id": 9821289, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "sgillen", "link": "https://stackoverflow.com/users/9821289/sgillen"}, "is_accepted": false, "score": 0, "last_activity_date": 1564612322, "last_edit_date": 1564612322, "creation_date": 1564611242, "answer_id": 57299491, "question_id": 57299328, "link": "https://stackoverflow.com/questions/57299328/how-to-delete-a-string-from-an-array-of-string-in-c/57299491#57299491", "title": "How to delete a string from an array of string in c", "body": "<p>Although arrays are implemented with pointers in C, the compiler will treat them the differently. As you can see in your own example the line  n[i] = n[i+1] causes the error you see, because n[i] is an array of chars.</p>\n\n<p>Even if you could make the assignment you wanted, the logic of your program still has an error. If you were able to succeed in your call to n[i] = n[i+1] you would effectively be duplicating whatever was in n[i+1] twice. </p>\n\n<p>Instead you likely want to copy n[i+1] into n[i], then copy n[i+2] into n[i+1] and so on. This will be expensive, you may want to look into using a linked list instead, although this really depends on what else you want to do with this data structure. </p>\n"}, {"tags": [], "owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "is_accepted": false, "score": 0, "last_activity_date": 1564655171, "creation_date": 1564655171, "answer_id": 57306950, "question_id": 57299328, "link": "https://stackoverflow.com/questions/57299328/how-to-delete-a-string-from-an-array-of-string-in-c/57306950#57306950", "title": "How to delete a string from an array of string in c", "body": "<blockquote>\n<pre><code>[Error] assignment to expression with array type\n</code></pre>\n</blockquote>\n\n<p>In C an array can not be assigned. </p>\n\n<p>You need to copy the content of the source array are into the destination array.</p>\n\n<p>For the special case of a <code>0</code>-terminated <code>char</code>array (aka C-string) you can use the <code>strcpy()</code> function  to do so:</p>\n\n<pre><code>    strcpy(n[i], n[i+1]);\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4780235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21b3922a50d4a186741c09d01749209a?s=128&d=identicon&r=PG&f=1", "display_name": "MANIAK9630", "link": "https://stackoverflow.com/users/4780235/maniak9630"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 77, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1564655171, "creation_date": 1564610121, "last_edit_date": 1564610234, "question_id": 57299328, "link": "https://stackoverflow.com/questions/57299328/how-to-delete-a-string-from-an-array-of-string-in-c", "title": "How to delete a string from an array of string in c", "body": "<p>I have a multidimensional array in which i put words inside . After , i ask the user to delete a word . But it won't delete.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n\nvoid main ()\n{\n\n    int i ; \n    int nbr ;\n    char n[50][50];\n    char d[50];\n\n    printf(\"Enter the number of word you want : \\n\");\n    scanf(\"%d\",&amp;nbr);\n\n    for(i=0; i &lt; nbr ; i++)\n    {\n        printf(\"Enter words : \\n\");\n        scanf(\"%s\",&amp;n[i]);  \n    }\n\n    printf(\"you have enter: \\n\");\n    for(i = 0; i &lt; nbr ; i++)\n    {   \n        printf(\"%s \\n\",n[i]);\n    }\n\n\n    printf(\"Wich word you want to remove  : ? \\n\");\n    scanf(\"%s\",&amp;d);\n\n    for(i=0; i &lt; nbr ; i++)\n    {\n        if(strcmp(n[i],d)==0)\n        {\n            n[i] = n[i+1] ; \n            i-- ; \n        }\n    }\n    printf(\"The rest of array is : \\n\");\n    scanf(\"%s\",&amp;n[i]);\n\n}\n</code></pre>\n\n<blockquote>\n  <p>[Error] assignment to expression with array type</p>\n</blockquote>\n"}, {"tags": ["c", "signals"], "answers": [{"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1564620159, "post_id": 57300476, "comment_id": 101094501, "body": "I wait 3 hours \u2014 and then someone jumps the gun less than a minute before I hit save!  Congratulations!"}, {"owner": {"reputation": 47633, "user_id": 3889449, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/eb07e0f09deb982a1a0deedca7a5c002?s=128&d=identicon&r=PG", "display_name": "Marco Bonelli", "link": "https://stackoverflow.com/users/3889449/marco-bonelli"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1564620302, "post_id": 57300476, "comment_id": 101094532, "body": "@JonathanLeffler I was just looking at your answer and the fact that we both proposed the same solution in the span of 30 seconds after hours of inactivity.  Quite funny indeed :&#39;)"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1564620439, "post_id": 57300476, "comment_id": 101094560, "body": "The good news \u2014 there&#39;s a chance that at least one of us has a decent solution :D"}, {"owner": {"reputation": 55, "user_id": 11711302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb00cae530390ce4187150985cfb6dd6?s=128&d=identicon&r=PG&f=1", "display_name": "gooddayjay", "link": "https://stackoverflow.com/users/11711302/gooddayjay"}, "edited": false, "score": 0, "creation_date": 1564966759, "post_id": 57300476, "comment_id": 101190259, "body": "Is there a more efficent way of doing this instead of looping through the full list of signals of the &#39;.h&#39; file? Like you only loop through the every signal in the current mask rather then every possible signal?"}, {"owner": {"reputation": 47633, "user_id": 3889449, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/eb07e0f09deb982a1a0deedca7a5c002?s=128&d=identicon&r=PG", "display_name": "Marco Bonelli", "link": "https://stackoverflow.com/users/3889449/marco-bonelli"}, "reply_to_user": {"reputation": 55, "user_id": 11711302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb00cae530390ce4187150985cfb6dd6?s=128&d=identicon&r=PG&f=1", "display_name": "gooddayjay", "link": "https://stackoverflow.com/users/11711302/gooddayjay"}, "edited": false, "score": 0, "creation_date": 1564973361, "post_id": 57300476, "comment_id": 101191207, "body": "@gooddayjay Nope. The point is that you cannot know which signal is in the current mask without checking with sigismember. This is the only way: check every possible signal. If you are worried about performance, this code only scans an array of around ~30 items, and the number does not change: it&#39;s going to be instantaneus anyway."}, {"owner": {"reputation": 55, "user_id": 11711302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb00cae530390ce4187150985cfb6dd6?s=128&d=identicon&r=PG&f=1", "display_name": "gooddayjay", "link": "https://stackoverflow.com/users/11711302/gooddayjay"}, "edited": false, "score": 0, "creation_date": 1564980786, "post_id": 57300476, "comment_id": 101192425, "body": "Great thank you for the explination! It makes a lot of sense now."}, {"owner": {"reputation": 47633, "user_id": 3889449, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/eb07e0f09deb982a1a0deedca7a5c002?s=128&d=identicon&r=PG", "display_name": "Marco Bonelli", "link": "https://stackoverflow.com/users/3889449/marco-bonelli"}, "reply_to_user": {"reputation": 55, "user_id": 11711302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb00cae530390ce4187150985cfb6dd6?s=128&d=identicon&r=PG&f=1", "display_name": "gooddayjay", "link": "https://stackoverflow.com/users/11711302/gooddayjay"}, "edited": false, "score": 0, "creation_date": 1565037358, "post_id": 57300476, "comment_id": 101217775, "body": "@gooddayjay you&#39;re welcome. If this correctly answered your question, please accept my answer so that this question can be marked as solved."}], "tags": [], "owner": {"reputation": 47633, "user_id": 3889449, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/eb07e0f09deb982a1a0deedca7a5c002?s=128&d=identicon&r=PG", "display_name": "Marco Bonelli", "link": "https://stackoverflow.com/users/3889449/marco-bonelli"}, "is_accepted": false, "score": 3, "last_activity_date": 1564620817, "last_edit_date": 1564620817, "creation_date": 1564620076, "answer_id": 57300476, "question_id": 57299119, "link": "https://stackoverflow.com/questions/57299119/iterating-over-a-list-of-possible-signals/57300476#57300476", "title": "Iterating over a list of possible signals", "body": "<p>If you're looking for a list or array of signals, then I'm afraid that there isn't one defined in <code>signal.h</code>. The only thing you can do is define it yourself and iterate over it. If you want, you could define it in a different helper file so as not to pollute the actual code.</p>\n\n<p>Example program:</p>\n\n<pre><code>#include \"siglist.h\"\n#include &lt;stdio.h&gt;\n#include &lt;stddef.h&gt;\n\nint main(void) {\n    sigset_t sigset;\n\n    // ... initialize stuff ...\n\n    for (size_t i = 0; i &lt; SIGLIST_LENGTH; i++) {\n        if (sigismember(&amp;sigset, siglist[i].code))\n            printf(\"%d - %s: %s.\\n\", siglist[i].code, siglist[i].name, siglist[i].description);\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>File <code>siglist.h</code> (all those <code>ifdef</code> are needed since you cannot know beforehand which signals are defined and which aren't on the target machine):</p>\n\n<pre><code>#ifndef SIGLIST_H_INCLUDED\n#define SIGLIST_H_INCLUDED\n\n#include &lt;signal.h&gt;\n\nstruct siginfo {\n    int code;\n    char *name;\n    char *description;\n};\n\nconst struct siginfo siglist[] = {\n#ifdef SIGABRT\n    {SIGABRT  , \"SIGABRT\"  , \"Abort signal\"},\n#endif\n#ifdef SIGALRM\n    {SIGALRM  , \"SIGALRM\"  , \"Timer signal\"},\n#endif\n#ifdef SIGBUS\n    {SIGBUS   , \"SIGBUS\"   , \"Bus error (bad memory access)\"},\n#endif\n#ifdef SIGCHLD\n    {SIGCHLD  , \"SIGCHLD\"  , \"Child stopped or terminated\"},\n#endif\n#ifdef SIGCLD\n    {SIGCLD   , \"SIGCLD\"   , \"Child stopped or terminated\"},\n#endif\n#ifdef SIGCONT\n    {SIGCONT  , \"SIGCONT\"  , \"Continue if stopped\"},\n#endif\n#ifdef SIGEMT\n    {SIGEMT   , \"SIGEMT\"   , \"Emulator trap\"},\n#endif\n#ifdef SIGFPE\n    {SIGFPE   , \"SIGFPE\"   , \"Floating-point exception\"},\n#endif\n#ifdef SIGHUP\n    {SIGHUP   , \"SIGHUP\"   , \"Hangup detected on controlling terminal or death of controlling process\"},\n#endif\n#ifdef SIGILL\n    {SIGILL   , \"SIGILL\"   , \"Illegal Instruction\"},\n#endif\n#ifdef SIGINFO\n    {SIGINFO  , \"SIGINFO\"  , \"Power failure\"},\n#endif\n#ifdef SIGINT\n    {SIGINT   , \"SIGINT\"   , \"Interrupt from keyboard\"},\n#endif\n#ifdef SIGIO\n    {SIGIO    , \"SIGIO\"    , \"I/O now possible\"},\n#endif\n#ifdef SIGIOT\n    {SIGIOT   , \"SIGIOT\"   , \"IOT trap: Abort signal\"},\n#endif\n#ifdef SIGKILL\n    {SIGKILL  , \"SIGKILL\"  , \"Kill signal\"},\n#endif\n#ifdef SIGLOST\n    {SIGLOST  , \"SIGLOST\"  , \"File lock lost \"},\n#endif\n#ifdef SIGPIPE\n    {SIGPIPE  , \"SIGPIPE\"  , \"Broken pipe: write to pipe with no readers\"},\n#endif\n#ifdef SIGPOLL\n    {SIGPOLL  , \"SIGPOLL\"  , \"Pollable event: I/O now possible\"},\n#endif\n#ifdef SIGPROF\n    {SIGPROF  , \"SIGPROF\"  , \"Profiling timer expired\"},\n#endif\n#ifdef SIGPWR\n    {SIGPWR   , \"SIGPWR\"   , \"Power failure\"},\n#endif\n#ifdef SIGQUIT\n    {SIGQUIT  , \"SIGQUIT\"  , \"Quit from keyboard\"},\n#endif\n#ifdef SIGSEGV\n    {SIGSEGV  , \"SIGSEGV\"  , \"Invalid memory reference\"},\n#endif\n#ifdef SIGSTKFLT\n    {SIGSTKFLT, \"SIGSTKFLT\", \"Stack fault on coprocessor\"},\n#endif\n#ifdef SIGSTOP\n    {SIGSTOP  , \"SIGSTOP\"  , \"Stop process\"},\n#endif\n#ifdef SIGTSTP\n    {SIGTSTP  , \"SIGTSTP\"  , \"Stop typed at terminal\"},\n#endif\n#ifdef SIGSYS\n    {SIGSYS   , \"SIGSYS\"   , \"Bad system call \"},\n#endif\n#ifdef SIGTERM\n    {SIGTERM  , \"SIGTERM\"  , \"Termination signal\"},\n#endif\n#ifdef SIGTRAP\n    {SIGTRAP  , \"SIGTRAP\"  , \"Trace/breakpoint trap\"},\n#endif\n#ifdef SIGTTIN\n    {SIGTTIN  , \"SIGTTIN\"  , \"Terminal input for background process\"},\n#endif\n#ifdef SIGTTOU\n    {SIGTTOU  , \"SIGTTOU\"  , \"Terminal output for background process\"},\n#endif\n#ifdef SIGUNUSED\n    {SIGUNUSED, \"SIGUNUSED\", \"Bad system call \"},\n#endif\n#ifdef SIGURG\n    {SIGURG   , \"SIGURG\"   , \"Urgent condition on socket \"},\n#endif\n#ifdef SIGUSR1\n    {SIGUSR1  , \"SIGUSR1\"  , \"User-defined signal 1\"},\n#endif\n#ifdef SIGUSR2\n    {SIGUSR2  , \"SIGUSR2\"  , \"User-defined signal 2\"},\n#endif\n#ifdef SIGVTALRM\n    {SIGVTALRM, \"SIGVTALRM\", \"Virtual alarm clock \"},\n#endif\n#ifdef SIGXCPU\n    {SIGXCPU  , \"SIGXCPU\"  , \"CPU time limit exceeded \"},\n#endif\n#ifdef SIGXFSZ\n    {SIGXFSZ  , \"SIGXFSZ\"  , \"File size limit exceeded\"},\n#endif\n#ifdef SIGWINCH\n    {SIGWINCH , \"SIGWINCH\" , \"Window resize signal\"},\n#endif\n};\n\nconst size_t SIGLIST_LENGTH = sizeof(siglist)/sizeof(siglist[0]);\n\n#endif // SIGLIST_H_INCLUDED\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": false, "score": 2, "last_activity_date": 1564654759, "last_edit_date": 1564654759, "creation_date": 1564620119, "answer_id": 57300487, "question_id": 57299119, "link": "https://stackoverflow.com/questions/57299119/iterating-over-a-list-of-possible-signals/57300487#57300487", "title": "Iterating over a list of possible signals", "body": "<p>Create a structure type, and preload an array with the appropriate information:</p>\n\n<pre><code>struct SigInfo\n{\n    int     signum;\n    char    signame[16];\n};\n\nstatic const struct SigInfo siginfo[] =\n{\n#ifdef SIGINT\n        { SIGINT, \"SIGINT\" },\n#endif\n#ifdef SIGQUIT\n        { SIGQUIT, \"SIGQUIT\" },\n#endif\n    \u2026\n};\nenum { NUM_SIGINFO = sizeof(siginfo) / sizeof(siginfo[0]) };\n</code></pre>\n\n<p>And then:</p>\n\n<pre><code>printf(\"%s\", str); \nfor (int i = 0; i &lt; NUM_SIGINFO; i++)\n{\n    if (sigismember(&amp;sigset, siginfo[i].signum))\n    {\n        printf(\" %s\\n\", siginfo[i].signame);\n        break;\n    }\n}\n</code></pre>\n\n<p>You can package the information multiple different ways.  Generating the signal information is fiddly.  I use a Perl script to scrutinize the appropriate header (usually <code>/usr/include/sys/errno.h</code>) and extract the information shown, plus the text of what the signal is for, plus the number associated with the signal:</p>\n\n<pre><code>typedef struct sig_info\n{\n    const char *sigsym;     /* Signal symbol  - \"EINTR\" */\n    int         signum;     /* Signal number  - EINTR   */\n    int         sigdef;     /* Signal define  - 2       */\n    const char *sigmsg;     /* Signal message - Interrupted system call */\n} sig_info;\n\n\u2026\n#ifdef SIGPIPE\n    {   \"SIGPIPE\",   SIGPIPE,   13,   \"Broken pipe (POSIX).\"                  },\n#endif\n#ifdef SIGPROF\n    {   \"SIGPROF\",   SIGPROF,   27,   \"Profiling alarm clock (4.2 BSD).\"      },\n#endif\n#ifdef SIGPWR\n    {   \"SIGPWR\",    SIGPWR,    30,   \"Power failure restart (System V).\"     },\n#endif\n\u2026\n</code></pre>\n\n<p>The program this comes from allows me to find signals by name or number:</p>\n\n<pre><code>$ ./signal int 2\nSIGINT (2): Interrupt (ANSI).\n2 (SIGINT): Interrupt (ANSI).\n$ ./signal -h\nUsage: signal [-hlqV] [lo[:hi] ...]\n  -h    Print help and exit\n  -l    Print list of all signals\n  -q    Validate signal but don't print messages\n  -V    Print version and exit\n$ ./signal -l\n1 (SIGHUP): Hangup (POSIX).\n2 (SIGINT): Interrupt (ANSI).\n3 (SIGQUIT): Quit (POSIX).\n4 (SIGILL): Illegal instruction (ANSI).\n5 (SIGTRAP): Trace trap (POSIX).\n6 (SIGIOT): IOT trap (4.2 BSD).\n6 (SIGIOT): IOT trap (4.2 BSD).\n7 (SIGBUS): BUS error (4.2 BSD).\n8 (SIGFPE): Floating-point exception (ANSI).\n9 (SIGKILL): Kill, unblockable (POSIX).\n10 (SIGUSR1): User-defined signal 1 (POSIX).\n11 (SIGSEGV): Segmentation violation (ANSI).\n12 (SIGUSR2): User-defined signal 2 (POSIX).\n13 (SIGPIPE): Broken pipe (POSIX).\n14 (SIGALRM): Alarm clock (POSIX).\n15 (SIGTERM): Termination (ANSI).\n16 (SIGSTKFLT): Stack fault.\n17 (SIGCHLD): Child status has changed (POSIX).\n18 (SIGCONT): Continue (POSIX).\n19 (SIGSTOP): Stop, unblockable (POSIX).\n20 (SIGTSTP): Keyboard stop (POSIX).\n21 (SIGTTIN): Background read from tty (POSIX).\n22 (SIGTTOU): Background write to tty (POSIX).\n23 (SIGURG): Urgent condition on socket (4.2 BSD).\n24 (SIGXCPU): CPU limit exceeded (4.2 BSD).\n25 (SIGXFSZ): File size limit exceeded (4.2 BSD).\n26 (SIGVTALRM): Virtual alarm clock (4.2 BSD).\n27 (SIGPROF): Profiling alarm clock (4.2 BSD).\n28 (SIGWINCH): Window size change (4.3 BSD, Sun).\n29 (SIGIO): I/O now possible (4.2 BSD).\n30 (SIGPWR): Power failure restart (System V).\n31 (SIGSYS): Bad system call.\n34 (SIGRT34): Real time signal 34 (SIGRTMIN)\n35 (SIGRT35): Real time signal 35\n\u2026\n63 (SIGRT63): Real time signal 63\n64 (SIGRT64): Real time signal 64 (SIGRTMAX)\n$\n</code></pre>\n\n<p>This particular list of signals was generated on an ancient RedHat Linux machine (5.2, IIRC).  The effect is similar on macOS, and other versions of Linux too.</p>\n"}], "owner": {"reputation": 55, "user_id": 11711302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb00cae530390ce4187150985cfb6dd6?s=128&d=identicon&r=PG&f=1", "display_name": "gooddayjay", "link": "https://stackoverflow.com/users/11711302/gooddayjay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 440, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1564654806, "creation_date": 1564608728, "last_edit_date": 1564654806, "question_id": 57299119, "link": "https://stackoverflow.com/questions/57299119/iterating-over-a-list-of-possible-signals", "title": "Iterating over a list of possible signals", "body": "<p>I have some code that I want to use to print a list of signals that prints the names of the signals in the signal mask of the calling process.</p>\n\n<p>The starting code that I have is below:</p>\n\n<pre><code>#include \"apue.h\" \n#include &lt;errno.h&gt; \n\nvoid \npr_mask(const char *str) \n{ \n    sigset_t sigset; \n    int errno_save;     \n\n    errno_save = errno; \n\n    if (sigprocmask(0, NULL, &amp;sigset) &lt; 0) { \n        err_ret(\"sigprocmask error\"); \n    }else { \n        printf(\"%s\", str); \n        if (sigismember(&amp;sigset, SIGINT)) \n            printf(\" SIGINT\"); \n        if (sigismember(&amp;sigset, SIGQUIT)) \n            printf(\" SIGQUIT\"); \n        if (sigismember(&amp;sigset, SIGUSR1)) \n            printf(\" SIGUSR1\"); \n        if (sigismember(&amp;sigset, SIGALRM)) \n            printf(\" SIGALRM\"); \n        printf(\"\\n\");\n    } \n    errno = errno_save; \n}\n</code></pre>\n\n<p>The thing is, I want to do more signals than just <code>SIGINT</code>, <code>SIGQUIT</code>, <code>SIGUSR1</code> and <code>SIGALRM</code>. I do not want to make a long list of if statements for each alarm.</p>\n\n<p>I want to do something like this:</p>\n\n<pre><code>for(int i = 0; i &lt; 32; i++) {\n     printf(\"%s\", str)\n     if(sigismember(sigset, signal_array[i]))\n        printf(\"%s\", signal_array[i]);\n}\n</code></pre>\n\n<p>Where <code>signal_array</code> is something like this:</p>\n\n<pre><code>signal array[32] {\n    SIGINT, \"SIGINT\"\n   ...\n   ...\n   ... \n}\n</code></pre>\n\n<p>Is there some way I can do this so it is easier for me to print out each signal? It would simplify things a lot.</p>\n"}, {"tags": ["c", "printf"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 4, "creation_date": 1564606553, "post_id": 57298706, "comment_id": 101091364, "body": "See <a href=\"https://stackoverflow.com/questions/2979209/using-fflushstdin\">Using <code>fflush(stdin)</code>?</a> for reasons why you shouldn&#39;t."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1564606697, "post_id": 57298706, "comment_id": 101091417, "body": "The sequence: <code>printf(&quot;Enter the course : &quot;);     fflush(stdin);     scanf(&quot;%c&quot;,&amp;s[i].course); }  printf(&quot;Enter the student number to display: &quot;); scanf(&quot;%c&quot;,&amp;sname);</code> is problematic.  Use <code>%c</code> to read single characters, not names, and note that <code>%c</code> does not skip white space (use <code>&quot; %c&quot;</code>, where the space is all important).  However, you have more work to do than that."}, {"owner": {"reputation": 1, "user_id": 11800009, "user_type": "registered", "profile_image": "https://graph.facebook.com/10220345850982617/picture?type=large", "display_name": "xeliano", "link": "https://stackoverflow.com/users/11800009/xeliano"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1564609291, "post_id": 57298706, "comment_id": 101092271, "body": "I made it thank you so much for your helps."}], "owner": {"reputation": 1, "user_id": 11800009, "user_type": "registered", "profile_image": "https://graph.facebook.com/10220345850982617/picture?type=large", "display_name": "xeliano", "link": "https://stackoverflow.com/users/11800009/xeliano"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "closed_date": 1564607067, "answer_count": 0, "score": 0, "last_activity_date": 1564606769, "creation_date": 1564606441, "last_edit_date": 1564606769, "question_id": 57298706, "link": "https://stackoverflow.com/questions/57298706/skips-printf-in-for", "closed_reason": "Duplicate", "title": "Skips printf in for", "body": "<p>If i choose the number of students 2 or more after i write first student informations, then when i writing the second students informations it skips \nthe Enter the student number and Enter the student name parts can you help me about that and english is not my main language sorry about mistakes.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;conio.h&gt;\n/* run this program using the console pauser or add your own getch, system(\"pause\") or input loop */\n\nstruct student{\n    int number, marks;\n    char name[20],course;\n};\n\n\nint main(int argc, char *argv[]) {\n\n    int i,n,found=0;\n\n    struct student s[10];\n\n    char sname[20];\n\n\n    printf (\"Enter number of students = \");\n\n    scanf(\"%d\",&amp;n);\n\n    for(i=0;i&lt;n;i++)\n    {\n        printf (\"\\nEnter the %d student details \\n\",i+1);\n        printf (\"Enter the student number:\");\n        scanf(\"%d\",&amp;s[i].number);\n        printf(\"Please enter the students name\\n\");\n        scanf(\"%s\",s[i].name);\n        printf(\"Enter the marks : \");\n        scanf(\"%d\",&amp;s[i].marks);\n        printf(\"Enter the course : \");\n        fflush(stdin);\n        scanf(\"%c\",&amp;s[i].course);\n    }\n\n    printf(\"Enter the student number to display: \");\n    scanf(\"%c\",&amp;sname);\n    for(i=0;i&lt;n;i++)\n    {\n        if(strcmp(s[i].number, sname)==0)\n        {\n            printf(\"\\n Marks of the student is %d \",s[i].marks);\n            found = 1;\n        }\n    }\n\n    if(found==0)\n        printf(\"Given student number not found\\n\");\n\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "node.js", "asynchronous", "posix", "multiplexing"], "answers": [{"comments": [{"owner": {"reputation": 1005, "user_id": 10674275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1710877d569a65bda20b7c7c0865b4c?s=128&d=identicon&r=PG&f=1", "display_name": "Julius", "link": "https://stackoverflow.com/users/10674275/julius"}, "edited": false, "score": 0, "creation_date": 1564605431, "post_id": 57298268, "comment_id": 101090950, "body": "Thank you! That really solved my confusion. How does select work internally though? I imagine it must either poll the status of the file descriptors or be notified asynchronously in order to unblock?"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "reply_to_user": {"reputation": 1005, "user_id": 10674275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1710877d569a65bda20b7c7c0865b4c?s=128&d=identicon&r=PG&f=1", "display_name": "Julius", "link": "https://stackoverflow.com/users/10674275/julius"}, "edited": false, "score": 1, "creation_date": 1564605528, "post_id": 57298268, "comment_id": 101090990, "body": "@Julius that is kernel magic, but it would very likely be asynchronous in there."}], "tags": [], "owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "is_accepted": true, "score": 4, "last_activity_date": 1564605271, "last_edit_date": 1564605271, "creation_date": 1564604331, "answer_id": 57298268, "question_id": 57298111, "link": "https://stackoverflow.com/questions/57298111/why-is-select2-called-synchronous-multiplexing/57298268#57298268", "title": "Why is select(2) called &quot;synchronous&quot; multiplexing?", "body": "<p>You've got a parse error there. It is not synchronous multiplexing but multiplexing of synchronous I/O: <code>select</code> is used to multiplex synchronous I/O calls. <code>read</code> and <code>write</code> and such are called synchronous I/O because they will either block until the transfer is complete, or not do the transfer (non-blocking non-ready sockets for example).</p>\n\n<p>This can be contrasted with truly asynchronous calls where the system call just initiates the transfer and it is completed in the background and a notification is given after the completion.</p>\n\n<p>The nodejs and libuv are different beasts. Even though the I/O in C is possibly multiplexed and synchronous, it will appear as asynchronous to <em>them</em> - there is no blocking synchronous read calls because it all happens transparently on the C/library side.</p>\n"}, {"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 1, "last_activity_date": 1564605628, "last_edit_date": 1564605628, "creation_date": 1564605130, "answer_id": 57298431, "question_id": 57298111, "link": "https://stackoverflow.com/questions/57298111/why-is-select2-called-synchronous-multiplexing/57298431#57298431", "title": "Why is select(2) called &quot;synchronous&quot; multiplexing?", "body": "<blockquote>\n  <p>So, what exactly does synchronous multiplexing mean?</p>\n</blockquote>\n\n<p>Synchronous operations are distinguished from asynchronous ones in that the former do not allow the caller to continue until they complete, whereas the latter do.  <em>Software</em> (a)synchronicity is closely related to multithreading, and the main characteristic of <code>select()</code> that makes its operation synchronous instead of asynchronous is that it works entirely within a single (user) thread of execution.  When you call <code>select()</code> your thread blocks until either one of the file descriptors you specified becomes ready, or the timeout you specified expires.</p>\n\n<p>The alternative would be a programming model where you register interest in I/O on the file descriptors, then come back later to check whether they are ready.</p>\n\n<p>It should be noted, however, that although <code>select()</code> is certainly synchronous itself, the multiplexing is mostly up to the programmer.  <code>select()</code> provides a means to achieve it, but performs no I/O itself.  It's essential brilliance is in giving you the information you need to avoid blocking trying to do I/O on one file descriptor while a different one is ready to be serviced.</p>\n\n<blockquote>\n  <p>Can I achieve async I/O using select?</p>\n</blockquote>\n\n<p>No, <code>select</code> doesn't do anything to particularly facilitate asynchronous I/O.  It helps you handle multiple I/O channels efficiently via a single thread, but that thread operates synchronously.  This nevertheless tends to be a big win, because I/O is very slow, and that slowness is mostly associated with I/O peripherals and media, not CPU and memory.  Generally speaking, a single thread has plenty of processing power to handle multiple I/O channels as long as it chooses wisely which ones to handle at any given opportunity, and <code>select()</code> facilitates that.</p>\n"}], "owner": {"reputation": 1005, "user_id": 10674275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1710877d569a65bda20b7c7c0865b4c?s=128&d=identicon&r=PG&f=1", "display_name": "Julius", "link": "https://stackoverflow.com/users/10674275/julius"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 204, "favorite_count": 0, "accepted_answer_id": 57298268, "answer_count": 2, "score": 1, "last_activity_date": 1564605628, "creation_date": 1564603475, "last_edit_date": 1564603779, "question_id": 57298111, "link": "https://stackoverflow.com/questions/57298111/why-is-select2-called-synchronous-multiplexing", "title": "Why is select(2) called &quot;synchronous&quot; multiplexing?", "body": "<p>I am a bit confused at the moment about <a href=\"https://linux.die.net/man/2/select\" rel=\"nofollow noreferrer\">select(2)</a>, which states in the summary: </p>\n\n<blockquote>\n  <p>select, pselect, FD_CLR, FD_ISSET, FD_SET, FD_ZERO - synchronous I/O\n  multiplexing</p>\n</blockquote>\n\n<p>as far as I am aware many libraries and programs such as libuv and nodejs use select/epoll/kqueue/iocp for their event loop, which is used for their corresponding async/await feature (and async I/O?).</p>\n\n<p>So, what exactly does synchronous multiplexing mean? Can I achieve async I/O using select? What exactly is the difference between <strong>synchronous multiplexing</strong> and <strong>asynchronous multiplexing</strong>?</p>\n"}, {"tags": ["c", "32bit-64bit", "judy-array"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1564603743, "post_id": 57298051, "comment_id": 101090362, "body": "The library header was not available? Strangely, the errors are not in line order."}], "owner": {"reputation": 31, "user_id": 11860668, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f1714c0d8fcf2d6bae865eba1ee520f?s=128&d=identicon&r=PG&f=1", "display_name": "Rhett L", "link": "https://stackoverflow.com/users/11860668/rhett-l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1564603155, "creation_date": 1564603155, "question_id": 57298051, "link": "https://stackoverflow.com/questions/57298051/set-of-structures-being-marked-as-undefined-in-32-bit-build-of-judy-arrays-but-n", "title": "Set of structures being marked as undefined in 32 bit build of Judy Arrays but not 64 bit?", "body": "<p>I am trying to test out using Judy Arrays. I wrote a short program that essentially tests simply inserting and retrieving strings from a Judy Array, using the JSLI and JSLG functions. The program inserts a list of strings, then finds them and prints out the strings in the order they were inserted and retrieved. I tried to compile with GCC.</p>\n\n<p>When I used the 64 build of Judy (followed instructions as specified in the INSTALL file), the program worked fine. When I used the 32 bit version, my program would not compile, throwing a list of errors, about structures being undefined, as show below. What could be causing such an error?</p>\n\n<p>Full Error Message:</p>\n\n<pre><code>/dv/scratch/users/testacct/judy_take_two/src/JudyL/JudyLNext.c:445: undefined reference to `j__L_LeafWOffset'\n/dv/scratch/users/testacct/judy_take_two/src/JudyL/JudyLNext.c:462: undefined reference to `j__L_LeafWOffset'\n/dv/scratch/users/testacct/judy_take_two/src/JudyL/JudyLNext.c:1610: undefined reference to `j__L_Leaf1Offset'\n/dv/scratch/users/testacct/judy_take_two/src/JudyL/JudyLNext.c:1618: undefined reference to `j__L_Leaf2Offset'\n/dv/scratch/users/testacct/judy_take_two/src/JudyL/JudyLNext.c:866: undefined reference to `j__L_Leaf4Offset'\n/dv/scratch/users/testacct/judy_take_two/src/JudyL/JudyLNext.c:773: undefined reference to `j__L_Leaf3Offset'\n/dv/scratch/users/testacct/judy_take_two/src/JudyL/JudyLNext.c:873: undefined reference to `j__L_Leaf5Offset'\n/dv/scratch/users/testacct/judy_take_two/src/JudyL/JudyLNext.c:881: undefined reference to `j__L_Leaf6Offset'\n/dv/scratch/users/testacct/judy_take_two/src/JudyL/JudyLNext.c:889: undefined reference to `j__L_Leaf7Offset'\n/dv/scratch/users/testacct/judy_take_two/src/JudyL/JudyLNext.c:1671: undefined reference to `j__L_Leaf7Offset'\n/dv/scratch/users/testacct/judy_take_two/src/JudyL/JudyLNext.c:1662: undefined reference to `j__L_Leaf6Offset'\n/dv/scratch/users/testacct/judy_take_two/src/JudyL/JudyLNext.c:1653: undefined reference to `j__L_Leaf5Offset'\n/dv/scratch/users/testacct/judy_take_two/src/JudyL/JudyLNext.c:1645: undefined reference to `j__L_Leaf4Offset'\n/dv/scratch/users/testacct/judy_take_two/src/JudyL/JudyLNext.c:1637: undefined reference to `j__L_Leaf3Offset'\n/dv/scratch/users/testacct/judy_take_two/src/JudyL/JudyLNext.c:851: undefined reference to `j__L_Leaf2Offset'\n/dv/scratch/users/testacct/judy_take_two/src/JudyL/JudyLNext.c:844: undefined reference to `j__L_Leaf1Offset'\n/dv/scratch/users/testacct/judy_take_two/src/JudyL/JudyLNext.c:858: undefined reference to `j__L_Leaf3Offset'\n/dv/scratch/users/testacct/judy_take_two/src/JudyL/JudyLPrev.c:445: undefined reference to `j__L_LeafWOffset'\n/dv/scratch/users/testacct/judy_take_two/src/JudyL/JudyLPrev.c:462: undefined reference to `j__L_LeafWOffset'\n/dv/scratch/users/testacct/judy_take_two/src/JudyL/JudyLPrev.c:1610: undefined reference to `j__L_Leaf1Offset'\n/dv/scratch/users/testacct/judy_take_two/src/JudyL/JudyLPrev.c:1618: undefined reference to `j__L_Leaf2Offset'\n/dv/scratch/users/testacct/judy_take_two/src/JudyL/JudyLPrev.c:775: undefined reference to `j__L_Leaf4Offset'\n/dv/scratch/users/testacct/judy_take_two/src/JudyL/JudyLPrev.c:773: undefined reference to `j__L_Leaf3Offset'\n/dv/scratch/users/testacct/judy_take_two/src/JudyL/JudyLPrev.c:777: undefined reference to `j__L_Leaf6Offset'\n/dv/scratch/users/testacct/judy_take_two/src/JudyL/JudyLPrev.c:776: undefined reference to `j__L_Leaf5Offset'\n/dv/scratch/users/testacct/judy_take_two/src/JudyL/JudyLPrev.c:778: undefined reference to `j__L_Leaf7Offset'\n/dv/scratch/users/testacct/judy_take_two/src/JudyL/JudyLPrev.c:1671: undefined reference to `j__L_Leaf7Offset'\n/dv/scratch/users/testacct/judy_take_two/src/JudyL/JudyLPrev.c:1662: undefined reference to `j__L_Leaf6Offset'\n/dv/scratch/users/testacct/judy_take_two/src/JudyL/JudyLPrev.c:1653: undefined reference to `j__L_Leaf5Offset'\n/dv/scratch/users/testacct/judy_take_two/src/JudyL/JudyLPrev.c:1645: undefined reference to `j__L_Leaf4Offset'\n/dv/scratch/users/testacct/judy_take_two/src/JudyL/JudyLPrev.c:1637: undefined reference to `j__L_Leaf3Offset'\n/dv/scratch/users/testacct/judy_take_two/src/JudyL/JudyLPrev.c:772: undefined reference to `j__L_Leaf2Offset'\n/dv/scratch/users/testacct/judy_take_two/src/JudyL/JudyLPrev.c:770: undefined reference to `j__L_Leaf1Offset'\n/dv/scratch/users/testacct/judy_take_two/src/JudyL/JudyLPrev.c:873: undefined reference to `j__L_Leaf5Offset'\n/dv/scratch/users/testacct/judy_take_two/src/JudyL/JudyLPrev.c:866: undefined reference to `j__L_Leaf4Offset'\n/dv/scratch/users/testacct/judy_take_two/src/JudyL/JudyLPrev.c:851: undefined reference to `j__L_Leaf2Offset'\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 3108, "user_id": 5288867, "user_type": "registered", "accept_rate": 77, "profile_image": "https://lh3.googleusercontent.com/-zd2wZZ4VrjY/AAAAAAAAAAI/AAAAAAAADiM/koENXn3dc8s/photo.jpg?sz=128", "display_name": "dangee1705", "link": "https://stackoverflow.com/users/5288867/dangee1705"}, "edited": false, "score": 1, "creation_date": 1564600243, "post_id": 57297434, "comment_id": 101088970, "body": "can you do <code>a[0] = 0, a[1] = 1, a[2] = 2;</code> ?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 5, "creation_date": 1564600270, "post_id": 57297434, "comment_id": 101088981, "body": "Or <code>int a[]={0,1,2};</code>."}, {"owner": {"reputation": 3108, "user_id": 5288867, "user_type": "registered", "accept_rate": 77, "profile_image": "https://lh3.googleusercontent.com/-zd2wZZ4VrjY/AAAAAAAAAAI/AAAAAAAADiM/koENXn3dc8s/photo.jpg?sz=128", "display_name": "dangee1705", "link": "https://stackoverflow.com/users/5288867/dangee1705"}, "edited": false, "score": 0, "creation_date": 1564600309, "post_id": 57297434, "comment_id": 101089001, "body": "also <code>a[2] = a[2] + 1;</code> can be written as <code>a[2]++;</code>"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1564600346, "post_id": 57297434, "comment_id": 101089017, "body": "What this code is supposed to do anyway?"}, {"owner": {"reputation": 51, "user_id": 7630542, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d96d255967883affa5d9484ba580aeb?s=128&d=identicon&r=PG&f=1", "display_name": "Mazeo", "link": "https://stackoverflow.com/users/7630542/mazeo"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1564600466, "post_id": 57297434, "comment_id": 101089071, "body": "@EugeneSh. Nope I can&#39;t"}, {"owner": {"reputation": 51, "user_id": 7630542, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d96d255967883affa5d9484ba580aeb?s=128&d=identicon&r=PG&f=1", "display_name": "Mazeo", "link": "https://stackoverflow.com/users/7630542/mazeo"}, "reply_to_user": {"reputation": 3108, "user_id": 5288867, "user_type": "registered", "accept_rate": 77, "profile_image": "https://lh3.googleusercontent.com/-zd2wZZ4VrjY/AAAAAAAAAAI/AAAAAAAADiM/koENXn3dc8s/photo.jpg?sz=128", "display_name": "dangee1705", "link": "https://stackoverflow.com/users/5288867/dangee1705"}, "edited": false, "score": 0, "creation_date": 1564600470, "post_id": 57297434, "comment_id": 101089074, "body": "@dangee1705 i know, for the increment, i just forgot, thanks for the reminder. But what you proposed is not allowed"}, {"owner": {"reputation": 4728, "user_id": 1288408, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r09bq.jpg?s=128&g=1", "display_name": "Modus Tollens", "link": "https://stackoverflow.com/users/1288408/modus-tollens"}, "edited": false, "score": 5, "creation_date": 1564600531, "post_id": 57297434, "comment_id": 101089100, "body": "Is this a homework assignment? I&#39;d like to talk to your tutor ;). Readability is more important than number of lines."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1564600578, "post_id": 57297434, "comment_id": 101089125, "body": "Anyway, this code has a predetermined output. You can simply run it as is, get this output and write another program printing it without any calculations."}, {"owner": {"reputation": 51, "user_id": 7630542, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d96d255967883affa5d9484ba580aeb?s=128&d=identicon&r=PG&f=1", "display_name": "Mazeo", "link": "https://stackoverflow.com/users/7630542/mazeo"}, "edited": false, "score": 0, "creation_date": 1564600609, "post_id": 57297434, "comment_id": 101089137, "body": "This is homework yeah, but it&#39;s done on purpose, it&#39;s the standard of the school, done in purpose to make it harder"}, {"owner": {"reputation": 51, "user_id": 7630542, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d96d255967883affa5d9484ba580aeb?s=128&d=identicon&r=PG&f=1", "display_name": "Mazeo", "link": "https://stackoverflow.com/users/7630542/mazeo"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1564600647, "post_id": 57297434, "comment_id": 101089156, "body": "@EugeneSh. I have to upload a single function to do the whole job"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1564600725, "post_id": 57297434, "comment_id": 101089190, "body": "@WumpusQ.Wumbley I guess <code>a</code> can be defined as <code>char</code>. Then all the <code>write</code>s can be squashed into one."}, {"owner": {"reputation": 51, "user_id": 7630542, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d96d255967883affa5d9484ba580aeb?s=128&d=identicon&r=PG&f=1", "display_name": "Mazeo", "link": "https://stackoverflow.com/users/7630542/mazeo"}, "edited": false, "score": 0, "creation_date": 1564600811, "post_id": 57297434, "comment_id": 101089213, "body": "@EugeneSh.could you give me the write sentence to do so ? please"}, {"owner": {"reputation": 1149, "user_id": 2472827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t5rYY.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/2472827/neil"}, "edited": false, "score": 0, "creation_date": 1564600822, "post_id": 57297434, "comment_id": 101089220, "body": "&quot;All the different combinations of numbers&quot; is an infinite set, is it not?"}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 0, "creation_date": 1564600992, "post_id": 57297434, "comment_id": 101089289, "body": "The requirements are moot. <i>&quot;<code>int a[]={0,1,2};</code> - I can&#39;t&quot;</i> Why? Which rule prevents that? <i>&quot;I can&#39;t delete current newlines&quot;</i> What do you mean?"}, {"owner": {"reputation": 51, "user_id": 7630542, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d96d255967883affa5d9484ba580aeb?s=128&d=identicon&r=PG&f=1", "display_name": "Mazeo", "link": "https://stackoverflow.com/users/7630542/mazeo"}, "reply_to_user": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 0, "creation_date": 1564601130, "post_id": 57297434, "comment_id": 101089349, "body": "@HolyBlackCat Sorry i forgot to mention that I can&#39;t declare and assign a var in the same line... corrected it"}, {"owner": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "edited": false, "score": 1, "creation_date": 1564601318, "post_id": 57297434, "comment_id": 101089436, "body": "@Mazeo I hope that the purpose of the assignment is a demonstration of how focusing on arbitrary rules can lead to worse code."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1564601375, "post_id": 57297434, "comment_id": 101089458, "body": "<i>What</i> Is it supposed to do?"}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 1, "creation_date": 1564601716, "post_id": 57297434, "comment_id": 101089596, "body": "Before we talk about minifying the code, are you sure it works as intended? I see a bunch of commas in the output, and that&#39;s all."}, {"owner": {"reputation": 1809, "user_id": 7339171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e618ef1f932f57ce1008799082f8db29?s=128&d=identicon&r=PG&f=1", "display_name": "CoffeeTableEspresso", "link": "https://stackoverflow.com/users/7339171/coffeetableespresso"}, "edited": false, "score": 0, "creation_date": 1564602302, "post_id": 57297434, "comment_id": 101089840, "body": "never have I missed for loops so much"}, {"owner": {"reputation": 409, "user_id": 11482040, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78e97145ede0f79467013cf464db3308?s=128&d=identicon&r=PG", "display_name": "Andr&#233; Sanson", "link": "https://stackoverflow.com/users/11482040/andr%c3%a9-sanson"}, "edited": false, "score": 0, "creation_date": 1564603029, "post_id": 57297434, "comment_id": 101090100, "body": "All combinations of numbers is infinite."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 3, "creation_date": 1564603590, "post_id": 57297434, "comment_id": 101090298, "body": "Assignments like these are the pedagogical equivalent of hazing."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1564603745, "post_id": 57297434, "comment_id": 101090365, "body": "@AndrewHenle: Stop with rants about how code ought to be written. The assignment is not teaching students to write this way. And it says <b>not</b> to cram operations onto one line, so you misread it. There is a purpose to introducing artificial constraints on <b>exercises</b>, not code for deployment. It is the same reason humans do weight training on machines even though those exercises are not real-world work, and the reason why children learning to write practice repetitious or arbitrary sequences of letters even though nobody wants a document with those sequences."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 1, "creation_date": 1564603755, "post_id": 57297434, "comment_id": 101090368, "body": "Nobody learns a skill fully formed. Human brains learn by practicing parts (as part of a regime that includes more comprehensive exercises over time). We practice elementary physics questions before tackling systems. Introducing artificial constraints forces a student to think about things in ways they might not have previously, thus giving them mental exercise they might not have gotten another way and forming more connections. There is nothing unreasonable about posing exercises with constraints that are not suitable for deployed software."}, {"owner": {"reputation": 51, "user_id": 7630542, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d96d255967883affa5d9484ba580aeb?s=128&d=identicon&r=PG&f=1", "display_name": "Mazeo", "link": "https://stackoverflow.com/users/7630542/mazeo"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1564604936, "post_id": 57297434, "comment_id": 101090780, "body": "Thanks ! @EricPostpischil"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1564609364, "post_id": 57297434, "comment_id": 101092291, "body": "@AndrewHenle: Comparing with a time constraint is a bad analogy. That forces a person to use existing skill and knowledge\u2014they do not have time to consider anything else. A length constraint is different. First, the student has time. That means they can ponder and research alternatives. Second, it forces the student to think: What alternative ways can I do this? What do I know about various operators? How can I use them differently than I used them previously? In order to have a worthwhile opinion on something, you need to actually understand it, not respond with knee-jerk reflexes."}, {"owner": {"reputation": 67968, "user_id": 584192, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YBSIc.png?s=128&g=1", "display_name": "Samuel Liew", "link": "https://stackoverflow.com/users/584192/samuel-liew"}, "edited": false, "score": 0, "creation_date": 1564623460, "post_id": 57297434, "comment_id": 101095094, "body": "Comments are not for extended discussion; this conversation has been <a href=\"https://chat.stackoverflow.com/rooms/197312/discussion-on-question-by-mazeo-how-can-i-reduce-this-function-code-down-to-max\">moved to chat</a>."}], "answers": [{"comments": [{"owner": {"reputation": 1809, "user_id": 7339171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e618ef1f932f57ce1008799082f8db29?s=128&d=identicon&r=PG&f=1", "display_name": "CoffeeTableEspresso", "link": "https://stackoverflow.com/users/7339171/coffeetableespresso"}, "edited": false, "score": 0, "creation_date": 1564603993, "post_id": 57297937, "comment_id": 101090455, "body": "wow turns out the code was messy because of what OP was doing rather than the rules he needed to follow"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1564632877, "post_id": 57297937, "comment_id": 101096700, "body": "Interesting that the last iteration calls <code>pnum(1000)</code> and then <code>digs[0] = 10 + &#39;0&#39;;</code>"}], "tags": [], "owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "is_accepted": false, "score": 2, "last_activity_date": 1564605379, "last_edit_date": 1564605379, "creation_date": 1564602489, "answer_id": 57297937, "question_id": 57297434, "link": "https://stackoverflow.com/questions/57297434/how-can-i-reduce-this-function-code-down-to-maximum-25-lines/57297937#57297937", "title": "How can i reduce this function code down to, maximum 25 lines?", "body": "<p>Something like this?</p>\n\n<pre><code>#include &lt;unistd.h&gt;\n\nvoid pnum(int num)\n{\n    char digs[4];\n    digs[0] = (num/100) + '0';\n    digs[1] = (num % 100)/10 + '0';\n    digs[2] = (num % 10) + '0';\n    digs[3] = '\\n';\n    if ((digs[0] &lt; digs[1]) &amp;&amp; (digs[1] &lt; digs[2]))\n        write(1, digs, 4);\n}\n\nint main()\n{\n    int a;\n    a=0;\n    while (a++ &lt; 1000)\n    {\n        pnum(a);\n    }\n}\n</code></pre>\n\n<p>Note: learn to break requirements down and implement them in pieces.  The breakdown that I saw was: 1) generate all combinations in ascending order. 2) display the ones that have the digits in ascending order.  That's why I wrote this in two parts.</p>\n"}, {"tags": [], "owner": {"reputation": 36, "user_id": 7576689, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8469cd251ba9198577857859456b1f2d?s=128&d=identicon&r=PG", "display_name": "Rodrigue Ren&#233;", "link": "https://stackoverflow.com/users/7576689/rodrigue-ren%c3%a9"}, "is_accepted": false, "score": 0, "last_activity_date": 1564618309, "creation_date": 1564618309, "answer_id": 57300315, "question_id": 57297434, "link": "https://stackoverflow.com/questions/57297434/how-can-i-reduce-this-function-code-down-to-maximum-25-lines/57300315#57300315", "title": "How can i reduce this function code down to, maximum 25 lines?", "body": "<p>Are you sure about your write? Because you have an array of int <code>int a[3]</code> but you write <code>1</code> it should be the size of a int so in case this is an error on your part i have made some ajustement.</p>\n\n<pre><code>void    ft_print_comb(void)\n{\n    char a[3] = {'0','1','2'};\n\n    while (a[0] &lt; '8')\n    {\n        if (a[2] &gt; '9')\n            a[2] = '0',\n            a[1] = a[1] + 1;\n        if (a[1] &gt; '9')\n            a[1] = '0',\n            a[0] = a[0] + 1;\n        if (a[0] &lt; a[1] &amp;&amp; a[1] &lt; a[2])\n            write(1, a, 3),\n            write(1, \", \", 1);\n        a[2] = a[2] + 1;\n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1564633320, "post_id": 57300624, "comment_id": 101096778, "body": "Nice use of <i>compound literal</i>."}], "tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": false, "score": 1, "last_activity_date": 1564657370, "last_edit_date": 1564657370, "creation_date": 1564621589, "answer_id": 57300624, "question_id": 57297434, "link": "https://stackoverflow.com/questions/57297434/how-can-i-reduce-this-function-code-down-to-maximum-25-lines/57300624#57300624", "title": "How can i reduce this function code down to, maximum 25 lines?", "body": "<p>Eight lines suffice:</p>\n\n<pre><code>#include &lt;unistd.h&gt;\n\nint main(void)\n{\n    int i;\n    i = 0;\n    while (++i &lt; 1000)\n        if (i/100 &lt; i/10%10 &amp;&amp; i/10%10 &lt; i%10)\n            write(1, (char []) { '0' + i/100, '0' + i/10%10, '0' + i%10, '\\n'}, 4);\n}\n</code></pre>\n\n<p>One could make it seven by changing <code>int i;</code> and <code>i = 0;</code> to <code>static int i;</code>, relying on static initialization to initialize <code>i</code> to zero.</p>\n"}], "owner": {"reputation": 51, "user_id": 7630542, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d96d255967883affa5d9484ba580aeb?s=128&d=identicon&r=PG&f=1", "display_name": "Mazeo", "link": "https://stackoverflow.com/users/7630542/mazeo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 150, "favorite_count": 0, "answer_count": 3, "score": -5, "last_activity_date": 1564657370, "creation_date": 1564600141, "last_edit_date": 1564601098, "question_id": 57297434, "link": "https://stackoverflow.com/questions/57297434/how-can-i-reduce-this-function-code-down-to-maximum-25-lines", "title": "How can i reduce this function code down to, maximum 25 lines?", "body": "<p>I for a reason need to reduce the length of my function down to maximum 25 lines.</p>\n\n<p>I can only use the <code>write</code> function</p>\n\n<p>I can't use <code>for</code></p>\n\n<p>I can't do multiple stuff at the same line (example <code>a[0] = 0;a[1] = 1;a[2] = 2;</code>)</p>\n\n<p>I can't delete current newlines</p>\n\n<p>I can't declare and assign a var in the same line</p>\n\n<p>Lines containing <code>{</code> or <code>}</code> should only be containing <code>{</code> or <code>}</code></p>\n\n<p>This is the smallest code i came up with after hours of work...</p>\n\n<pre><code>#include &lt;unistd.h&gt;\n\nvoid    ft_print_comb(void)\n{\n    int a[3];\n\n    a[0] = 0;\n    a[1] = 1;\n    a[2] = 2;\n    while (a[0] &lt; 8)\n    {\n        if (a[2] &gt; 9)\n        {\n            a[2] = 0;\n            a[1] = a[1] + 1;\n        }\n        if (a[1] &gt; 9)\n        {\n            a[1] = 0;\n            a[0] = a[0] + 1;\n        }\n        if (a[0] &lt; a[1] &amp;&amp; a[1] &lt; a[2])\n        {\n            write(1, &amp;a[0], 1);\n            write(1, &amp;a[1], 1);\n            write(1, &amp;a[2], 1);\n            write(1, \", \", 1);\n        }\n        a[2] = a[2] + 1;\n    }\n}\n</code></pre>\n\n<p>The code should do this :</p>\n\n<blockquote>\n  <p>Write a function that displays, in ascending order, all the different combinations of numbers in ascending order - yes, the repetition is voluntary.</p>\n</blockquote>\n"}, {"tags": ["c", "x86", "thread-safety", "memory-barriers", "memory-model"], "comments": [{"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1564603374, "post_id": 57297422, "comment_id": 101090215, "body": "(The <code>[memory-order]</code> tag is a synonym for <code>[memory-barriers]</code>, for some reason; that&#39;s why I added it; I know you&#39;re asking about the no-barriers case with non-atomic variables.)"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 1, "creation_date": 1564603517, "post_id": 57297422, "comment_id": 101090269, "body": "Your code seems to return -1 for all imaginable valid indexes. It only returns the value found in the array at the given index, if that is guaranteed to access outside of the array. Or am I misreading something?"}, {"owner": {"reputation": 4200, "user_id": 2288754, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/CJP6m.png?s=128&g=1", "display_name": "bmacnaughton", "link": "https://stackoverflow.com/users/2288754/bmacnaughton"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1564604230, "post_id": 57297422, "comment_id": 101090533, "body": "@PeterCordes - thanks. i didn&#39;t know about that tag."}, {"owner": {"reputation": 4200, "user_id": 2288754, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/CJP6m.png?s=128&g=1", "display_name": "bmacnaughton", "link": "https://stackoverflow.com/users/2288754/bmacnaughton"}, "reply_to_user": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1564605101, "post_id": 57297422, "comment_id": 101090832, "body": "@Yunnosch - it&#39;s a dumb example i wrote on the fly and inverted the test. am fixing now, but the question isn&#39;t really affected. thanks for pointing it out."}, {"owner": {"reputation": 9461, "user_id": 8422330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c0f90445d03447c587d1e595d531f69?s=128&d=identicon&r=PG&f=1", "display_name": "prl", "link": "https://stackoverflow.com/users/8422330/prl"}, "edited": false, "score": 1, "creation_date": 1564605401, "post_id": 57297422, "comment_id": 101090944, "body": "The x86 CPU architecture does not allow reordering these memory writes. However, the compiler is free to, in the absence of any barriers. Are you really interested in the defined behavior of the C code, or are you just using C code as pseudo-code to represent the order of actual CPU instructions?"}, {"owner": {"reputation": 4200, "user_id": 2288754, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/CJP6m.png?s=128&g=1", "display_name": "bmacnaughton", "link": "https://stackoverflow.com/users/2288754/bmacnaughton"}, "reply_to_user": {"reputation": 9461, "user_id": 8422330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c0f90445d03447c587d1e595d531f69?s=128&d=identicon&r=PG&f=1", "display_name": "prl", "link": "https://stackoverflow.com/users/8422330/prl"}, "edited": false, "score": 0, "creation_date": 1564605768, "post_id": 57297422, "comment_id": 101091087, "body": "@prl - i&#39;m interested in whether the code, as written, can be changed. it seems that if the compiler can arbitrarily change the order of code then what the language specifies is not deterministic. so if x86 cannot reorder the writes i&#39;m interested in the defined behavior of a C compiler. i honestly didn&#39;t consider that the c compiler could change the sequence of what my code specified."}], "answers": [{"comments": [{"owner": {"reputation": 18599, "user_id": 4230618, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KRWgI.jpg?s=128&g=1", "display_name": "Hadi Brais", "link": "https://stackoverflow.com/users/4230618/hadi-brais"}, "edited": false, "score": 1, "creation_date": 1564610346, "post_id": 57298777, "comment_id": 101092554, "body": "If the size of the array is sufficiently large, the latency of the first invocation to <code>get_index</code> may be too high, even though only a single array element may be needed. This latency can be significantly reduced by logically partitioning the array into multiple segments, where each segment has an initialization state. A thread only has to initialize the segment in which the target index exists. This also allows the array to be initialized in parallel. Alternatively, the array could be preemptively initialized (in a dedicated thread) when the program starts. A hybrid design is possible also."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 18599, "user_id": 4230618, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KRWgI.jpg?s=128&g=1", "display_name": "Hadi Brais", "link": "https://stackoverflow.com/users/4230618/hadi-brais"}, "edited": false, "score": 1, "creation_date": 1564610630, "post_id": 57298777, "comment_id": 101092636, "body": "@HadiBrais: yup, I was thinking some of that.  Init before starting multiple threads, or multi-threaded non-lazy init as the first thing threads do before any calls to <code>get_index</code>, is obviously best for the steady state fast-path, removing any flag check.  (I guess use a condition var or spin-loop as an all-thread barrier to make sure all threads finish init before any proceed past that point.)"}], "tags": [], "owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "is_accepted": false, "score": 4, "last_activity_date": 1564608799, "last_edit_date": 1564608799, "creation_date": 1564606858, "answer_id": 57298777, "question_id": 57297422, "link": "https://stackoverflow.com/questions/57297422/lazy-init-an-array-with-multi-threaded-readers-is-it-safe-without-barriers-or-a/57298777#57298777", "title": "Lazy-init an array with multi-threaded readers: is it safe without barriers or atomics?", "body": "<p>TL:DR: to make lazy-init safe if you don't do it before starting multiple threads, you need an <code>_Atomic</code> flag.</p>\n\n<hr>\n\n<blockquote>\n  <p>is it possible for <strong>the CPU</strong> to reorder memory access in a multi-core Intel (<strong>x86</strong>) architecture</p>\n</blockquote>\n\n<p>No, such reordering is possible at compile time only.  x86 asm effectively has acquire/release semantics for normal loads/stores.  (seq_cst + a store buffer with store forwarding).</p>\n\n<p><a href=\"https://preshing.com/20120625/memory-ordering-at-compile-time/\" rel=\"nofollow noreferrer\">https://preshing.com/20120625/memory-ordering-at-compile-time/</a></p>\n\n<blockquote>\n  <p>(or other architecture) </p>\n</blockquote>\n\n<p>Yes, most other ISAs have a weaker asm memory model that does allow StoreStore reordering and LoadLoad reordering.  (Effectively <code>memory_order_relaxed</code>, or sort of like <code>memory_order_consume</code> on ISAs other than Alpha AXP, but compilers don't try to maintain data dependencies.)</p>\n\n<hr>\n\n<p><strong>None of this really matters from C because the C memory model is very weak, allowing compile-time reordering</strong> and simultaneous read/write or write+write of any object is data-race UB.</p>\n\n<p>Data Race UB is what lets a compiler keep <code>static</code> variables in registers for the life of a function / inside a loop when compiling for \"normal\" ISAs.</p>\n\n<p><strong>Having 2 threads run this function is C data-race UB if <code>array_initialized</code> isn't already set before either of them run</strong>.  (e.g. by having the main thread run it once before starting any more threads).  And remove the <code>array_initialized</code> flag entirely, unless you have a use for the lazy-init feature before starting any more threads.</p>\n\n<p>It's 100% safe for a single thread, regardless of how many other threads are running: the C programming model guarantees that a single thread always sees its own operations in program order.  (Just like asm for all normal ISAs; other than explicit parallelism in ISAs like Itanium, you always see your own operations in order.  It's only other threads seeing your operations where things get weird).</p>\n\n<p>Starting a new thread is (I think) always a \"full barrier\", or in C terms \"synchronizes with\" the new thread.  Stuff in the new thread can't happen before anything in the parent thread.  So just calling <code>get_index</code> once from the main thread makes it safe with no further barriers for other threads to run <code>get_index</code> after that.</p>\n\n<hr>\n\n<h3>You could make lazy init thread-safe with an <code>_Atomic</code> flag</h3>\n\n<p><strong>This is similar to what gcc does for function-local <code>static</code> variables with non-constant initializers</strong>.  Check out the code-gen for that if you're curious: a read-only check of an already-init flag and then a call to an init function that makes sure only one thread runs the initializer.</p>\n\n<p>This requires an <code>acquire</code> load in the fast-path for the already-initialized state.  That's free on x86 and SPARC-TSO (same asm as a normal load), but not on weaker ISAs.  AArch64 has an acquire load instruction, other ISAs need some barrier instructions.</p>\n\n<p>Turn your <code>array_initialized</code> flag into a 3-state <code>_Atomic</code> variable:</p>\n\n<ul>\n<li>init not started  (e.g. <code>init == 0</code>).  Check for this with an <code>acquire</code> load.</li>\n<li>init started but not finished (e.g. <code>init == -1</code>)</li>\n<li>init finished (e.g. <code>init == 1</code>)</li>\n</ul>\n\n<p>You can leave <code>static int array[10];</code> itself non-<code>atomic</code> by <strong>making sure exactly 1 thread \"claims\" responsibility for doing the init,</strong> using <code>atomic_compare_exchange_strong</code> (which will succeed for exactly one thread).  And then have other threads spin-wait for the <code>INIT_FINISHED</code> state.</p>\n\n<p>Using initial state == 0 lets it be in the BSS, hopefully next to the data.  Otherwise we might prefer <code>INIT_FINISHED=0</code> for ISAs where branching on an <code>int</code> from memory being (non)zero is slightly more efficient than other numbers.  (e.g. AArch64 <code>cbnz</code>, MIPS <code>bne $reg, $zero</code>).</p>\n\n<p>We could get the best of both worlds (cheapest possible fast-path for the already-init case) while still having the flag in the BSS:  Have the main thread write it with <code>INIT_NOTSTARTED = -1</code> before starting any more threads.</p>\n\n<p>Having the flag next to the array is helpful for a small array where the flag is probably in the same cache line as the data we want to index.  Or at least the same 4k page.</p>\n\n<pre><code>#include &lt;stdatomic.h&gt;\n#include &lt;stdbool.h&gt;\n#ifdef __x86_64__\n#include &lt;immintrin.h&gt;\n#define SPINLOOP_BODY  _mm_pause()\n#else\n#define SPINLOOP_BODY  /**/\n#endif\n\n#ifdef __GNUC__\n#define unlikely(expr) __builtin_expect(!!(expr), 0)\n#define likely(expr) __builtin_expect(!!(expr), 1)\n#define NOINLINE __attribute__((noinline))\n#else \n#define unlikely(expr) (expr)\n#define likely(expr) (expr)\n#define NOINLINE /**/\n#endif\n\nenum init_states {\n INIT_NOTSTARTED = 0,\n INIT_STARTED = -1,\n INIT_FINISHED = 1   // optional: make this 0 to speed up the fast-path on some ISAs, and store an INIT_NOTSTARTED before the first call\n};\n\nstatic int array[10];\nstatic _Atomic int array_initialized = INIT_NOTSTARTED;\n\n// called either before or during init.\n// One thread claims responsibility for doing the init, others spin-wait\nNOINLINE    // this is rare, make sure it doesn't bloat the fast-path\nvoid initialize(void) {\n    bool winner = false;\n    // check read-only if another thread has already claimed init\n    if (array_initialized == INIT_NOTSTARTED) {\n        int expected = INIT_NOTSTARTED;\n        winner = atomic_compare_exchange_strong(&amp;array_initialized, &amp;expected, INIT_STARTED);\n        // seq_cst memory order is fine.  Weaker might be ok but it only has to run once\n    }\n\n    if (winner) {\n        array[0] = 1;\n        // ...\n        atomic_store_explicit(&amp;array_initialized, INIT_FINISHED, memory_order_release);\n    } else {\n         // spin-wait for the winner in other threads\n         // yield();  optional.\n         // Or use some kind of mutex or condition var if init is really slow\n\n         // otherwise just spin on a seq_cst load.  (Or acquire is fine.)\n         while(array_initialized != INIT_FINISHED)\n             SPINLOOP_BODY;   // x86 only\n\n         // winner's release store syncs with our load:\n         // array[] stores Happened Before this point so we can read it without UB\n    }\n\n}\n\nint get_index(int index) {\n    // atomic acquire load is fine, doesn't need seq_cst.  Cheaper than seq_cst on PowerPC\n    if (unlikely(atomic_load_explicit(&amp;array_initialized, memory_order_acquire) != INIT_FINISHED))\n        initialize();\n    if (unlikely(index &lt; 0 || index &gt; 9)) return -1;\n    return array[index];\n}\n</code></pre>\n\n<p>This does compile to correct-looking and efficient <a href=\"https://godbolt.org/z/RJsQsi\" rel=\"nofollow noreferrer\">asm on Godbolt</a>.  Without <code>unlikely()</code> macros, gcc/clang think that at least the stand-alone version of <code>get_index</code> has <code>initialize()</code> and/or <code>return -1</code> as the most likely fast-path.</p>\n\n<p>And compilers wanted to inline the init function, which would be silly because it only runs once per thread at most.  Hopefully profile-guided optimization would correct that.</p>\n"}], "owner": {"reputation": 4200, "user_id": 2288754, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/CJP6m.png?s=128&g=1", "display_name": "bmacnaughton", "link": "https://stackoverflow.com/users/2288754/bmacnaughton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1564608799, "creation_date": 1564600108, "last_edit_date": 1564607688, "question_id": 57297422, "link": "https://stackoverflow.com/questions/57297422/lazy-init-an-array-with-multi-threaded-readers-is-it-safe-without-barriers-or-a", "title": "Lazy-init an array with multi-threaded readers: is it safe without barriers or atomics?", "body": "<p>I've been having an implementation discussion where the idea that a CPU can choose to completely reorder the storing of memory has come up.</p>\n\n<p>I was initializing a static array in C using code similar to:</p>\n\n<pre><code>static int array[10];\nstatic int array_initialized = 0;\n\nvoid initialize () {\n\n    array[0] = 1;\n    array[1] = 2;\n    ...\n    array_initialized = -1;\n\n}\n</code></pre>\n\n<p>and it is used later similar to:</p>\n\n<pre><code>int get_index(int index) {\n    if (!array_initialized) initialize();\n    if (index &lt; 0 || index &gt; 9) return -1;\n    return array[index];\n}\n</code></pre>\n\n<p>is it possible for the CPU to reorder memory access in a multi-core intel architecture (or other architecture) such that it sets <code>array_initialized</code> before the <code>initialize</code> function has finished setting the array elements? or so that another execution thread can see <code>array_initialized</code> as non-zero before the entire array has been initialized in its view of the memory?</p>\n"}, {"tags": ["c++", "c", "openssl", "signed", "bignum"], "comments": [{"owner": {"reputation": 2528, "user_id": 4658169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b351ed2ce7ddde5ab5ac9bd96200a62d?s=128&d=identicon&r=PG&f=1", "display_name": "CuriouslyRecurringThoughts", "link": "https://stackoverflow.com/users/4658169/curiouslyrecurringthoughts"}, "edited": false, "score": 2, "creation_date": 1564600992, "post_id": 57297328, "comment_id": 101089287, "body": "BN_get_word returns an unsigned integer. Maybe it is the get that generates issues,  see <a href=\"https://www.openssl.org/docs/man1.0.2/man3/BN_get_word.html\" rel=\"nofollow noreferrer\">openssl.org/docs/man1.0.2/man3/BN_get_word.html</a>"}, {"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 1, "creation_date": 1564601235, "post_id": 57297328, "comment_id": 101089403, "body": "What makes you think openssl bignums support negative values?"}, {"owner": {"reputation": 5562, "user_id": 1946679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed74e2cdc59d058b76a76c90dd3c3bdc?s=128&d=identicon&r=PG", "display_name": "Matt Caswell", "link": "https://stackoverflow.com/users/1946679/matt-caswell"}, "edited": false, "score": 0, "creation_date": 1564611167, "post_id": 57297328, "comment_id": 101092796, "body": "BN_set_word() and BN_get_word() both only support unsigned values."}, {"owner": {"reputation": 303, "user_id": 3026356, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/60JOt.jpg?s=128&g=1", "display_name": "Colby", "link": "https://stackoverflow.com/users/3026356/colby"}, "reply_to_user": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1564659932, "post_id": 57297328, "comment_id": 101108956, "body": "@stark the <code>BN_set_negative()</code>, <code>BN_is_negative()</code> functions found here...: <a href=\"https://www.openssl.org/docs/man1.0.2/man3/bn.html\" rel=\"nofollow noreferrer\">openssl.org/docs/man1.0.2/man3/bn.html</a>"}, {"owner": {"reputation": 303, "user_id": 3026356, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/60JOt.jpg?s=128&g=1", "display_name": "Colby", "link": "https://stackoverflow.com/users/3026356/colby"}, "reply_to_user": {"reputation": 2528, "user_id": 4658169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b351ed2ce7ddde5ab5ac9bd96200a62d?s=128&d=identicon&r=PG&f=1", "display_name": "CuriouslyRecurringThoughts", "link": "https://stackoverflow.com/users/4658169/curiouslyrecurringthoughts"}, "edited": false, "score": 0, "creation_date": 1564659998, "post_id": 57297328, "comment_id": 101108993, "body": "@CuriouslyRecurringThoughts Ah thanks! That makes much more sense."}], "owner": {"reputation": 303, "user_id": 3026356, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/60JOt.jpg?s=128&g=1", "display_name": "Colby", "link": "https://stackoverflow.com/users/3026356/colby"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 167, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1564599589, "creation_date": 1564599589, "question_id": 57297328, "link": "https://stackoverflow.com/questions/57297328/openssl-bn-sub-cant-do-signed-subtraction", "title": "OpenSSL BN_sub() can&#39;t do signed subtraction", "body": "<p>I'm trying to perform subtraction using OpenSSL's <code>BN</code> functions. I am expecting a signed integer as the difference, but instead I get either the unsigned integer, or the integer overflows (or if neither I get the desired result). </p>\n\n<p>Am I using the wrong <code>BN</code> function? </p>\n\n<pre><code>int big_num_subtract_example(vector&lt;int&gt; *arr, unsigned int mod, int seed_num) {\n    BN_CTX *ctx;\n    ctx = BN_CTX_new();\n\n    BIGNUM *product = BN_new();\n    BIGNUM *tmp = BN_new();\n    BIGNUM *modulo = BN_new();\n    BIGNUM *mod_result = BN_new();\n\n    BN_set_word(product, seed_num);\n    BN_set_word(modulo, mod);\n\n    for (auto elem : arr) {\n\n        BN_CTX_start(ctx);\n\n        BN_set_word(tmp, elem);\n\n        BN_mul(product, product, tmp, ctx);\n\n        //Start of example\n        BIGNUM *sub_one = BN_new();\n        BIGNUM *sub_two = BN_new();\n\n        BIGNUM *num_one = BN_new();\n        BIGNUM *num_two = BN_new();\n\n        BN_set_word(num_one, -7);\n        BN_set_word(num_two, 11);\n\n        BN_sub(sub_one, num_one, num_two);\n        BN_sub(sub_two, num_two, num_one);\n\n        cout &lt;&lt; \"sub_one: \" &lt;&lt; BN_get_word(sub_one) &lt;&lt; \"\\n\"; //18446744073709551598 expected -4\n        cout &lt;&lt; \"sub_two: \" &lt;&lt; BN_get_word(sub_two) &lt;&lt; \"\\n\"; //18446744073709551598 expected 18\n\n        BN_set_word(num_one, 7);\n        BN_set_word(num_two, 11);\n\n        BN_sub(sub_one, num_one, num_two);\n        BN_sub(sub_two, num_two, num_one);\n\n        cout &lt;&lt; \"sub_one: \" &lt;&lt; BN_get_word(sub_one) &lt;&lt; \"\\n\"; //4 expected -11\n        cout &lt;&lt; \"sub_two: \" &lt;&lt; BN_get_word(sub_two) &lt;&lt; \"\\n\"; //4 \n        //end of example\n\n\n        //...\n        //Code using the product from start of loop and result of subtraction...\n        //...\n\n        BN_CTX_end(ctx);\n\n    }\n\n    BN_clear_free(product);\n    BN_clear_free(tmp);\n    BN_clear_free(modulo);\n    BN_clear_free(mod_result);\n    BN_CTX_free(ctx);\n\n    return 0;\n}\n</code></pre>\n\n<p>The <a href=\"https://www.openssl.org/docs/man1.1.0/man3/BN_sub.html\" rel=\"nofollow noreferrer\">docs</a> state:</p>\n\n<blockquote>\n  <p>BN_sub() subtracts b from a and places the result in r (r=a-b). r may\n  be the same BIGNUM as a or b.</p>\n</blockquote>\n"}, {"tags": ["c++", "c", "dll", "memory-leaks"], "comments": [{"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1564598745, "post_id": 57297091, "comment_id": 101088356, "body": "Have you considered just using <a href=\"https://clang.llvm.org/docs/LeakSanitizer.html\" rel=\"nofollow noreferrer\">LeakSanitizer</a> rather than trying to hand-roll an inferior solution?"}, {"owner": {"reputation": 4286, "user_id": 1440105, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/QxCty.jpg?s=128&g=1", "display_name": "Dweeberly", "link": "https://stackoverflow.com/users/1440105/dweeberly"}, "reply_to_user": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1564600024, "post_id": 57297091, "comment_id": 101088899, "body": "Wow, no I haven&#39;t considered using a Clang tool supported on Linux and OS X for my <i>Windows DLL</i>"}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1564600175, "post_id": 57297091, "comment_id": 101088946, "body": "The clang sanitizers can be used on Windows."}, {"owner": {"reputation": 4286, "user_id": 1440105, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/QxCty.jpg?s=128&g=1", "display_name": "Dweeberly", "link": "https://stackoverflow.com/users/1440105/dweeberly"}, "reply_to_user": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1564600369, "post_id": 57297091, "comment_id": 101089025, "body": "All I know is what I can read here: <a href=\"https://github.com/google/sanitizers/wiki/AddressSanitizerLeakSanitizer\" rel=\"nofollow noreferrer\">github.com/google/sanitizers/wiki/AddressSanitizerLeakSaniti&zwnj;&#8203;zer</a> which is pretty explicit about what is supported.  Either way it would be a non trivial task to convert my existing project to new tooling."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1564602612, "post_id": 57297091, "comment_id": 101089948, "body": "Just trying to help. As for supporting different tooling, that&#39;s usually a good idea regardless. Building with multiple compilers on multiple platforms tends to flush out lots of bugs :)"}, {"owner": {"reputation": 4286, "user_id": 1440105, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/QxCty.jpg?s=128&g=1", "display_name": "Dweeberly", "link": "https://stackoverflow.com/users/1440105/dweeberly"}, "reply_to_user": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1564604495, "post_id": 57297091, "comment_id": 101090618, "body": "I don&#39;t disagree but this code is 20+ years old, not well maintained and all about surfacing COM objects.  Oh, and it&#39;s mine now.  Sorry if I was snippy."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1564604933, "post_id": 57297091, "comment_id": 101090779, "body": "No hard feelings. But seriously; the clang sanitizers <i>can</i> be used on Windows - I&#39;ve done so. And just making the code build with that toolchain (even if that&#39;s not what you ship) will probably help find bugs. There&#39;s also the <a href=\"https://docs.microsoft.com/en-us/windows-hardware/test/wpt/windows-performance-analyzer\" rel=\"nofollow noreferrer\">Windows Performance Analyzer</a> that you can use - it&#39;s pretty damn good at finding issues."}], "owner": {"reputation": 4286, "user_id": 1440105, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/QxCty.jpg?s=128&g=1", "display_name": "Dweeberly", "link": "https://stackoverflow.com/users/1440105/dweeberly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 69, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1564598461, "creation_date": 1564598461, "question_id": 57297091, "link": "https://stackoverflow.com/questions/57297091/crtmemdumpallobjectssince-not-returning-expected-results", "title": "_CrtMemDumpAllObjectsSince not returning expected results", "body": "<p>I'm using <a href=\"https://docs.microsoft.com/en-us/cpp/c-runtime-library/reference/crtmemcheckpoint?view=vs-2019\" rel=\"nofollow noreferrer\">_CrtMemCheckpoint</a> and <a href=\"https://docs.microsoft.com/en-us/cpp/c-runtime-library/reference/crtmemdumpallobjectssince?view=vs-2019\" rel=\"nofollow noreferrer\">_CrtMemDumpAllObjectsSince</a> to track possible memory leaks in my dll.</p>\n\n<p>In DllMain when DLL_PROCESS_ATTACH is detected an init function is called which calls _CrtMemCheckpoint(&amp;startState) on the global _CrtMemState variable startState.  When DLL_PROCESS_DETACH is detected an exit function is called that calls _CrtMemDumpAllObjectsSince(&amp;startState).  This returns</p>\n\n<pre><code>ExitInstance()Dumping objects -&gt;\n{8706} normal block at 0x07088200, 8 bytes long.\n Data: &lt;p v     &gt; 70 FF 76 07 01 01 CD CD \n{8705} normal block at 0x07084D28, 40 bytes long.\n Data: &lt;                &gt; 00 00 00 10 FF FF FF FF FF FF FF FF 00 00 00 00 \n{4577} normal block at 0x070845F0, 40 bytes long.\n Data: &lt;dbV             &gt; 64 62 56 0F 01 00 00 00 FF FF FF FF FF FF FF FF \n{166} normal block at 0x028DD4B8, 40 bytes long.\n Data: &lt;dbV             &gt; 64 62 56 0F 01 00 00 00 FF FF FF FF FF FF FF FF \n{87} normal block at 0x02889BA8, 12 bytes long.\n Data: &lt; P          &gt; DC 50 90 02 00 00 00 00 01 00 00 00 \n</code></pre>\n\n<p>So far so good, except the last three entries (4577, 166 and 87) are also in startState.  I.E.  If I run <a href=\"https://docs.microsoft.com/en-us/cpp/c-runtime-library/reference/crtdumpmemoryleaks?view=vs-2019\" rel=\"nofollow noreferrer\">_CrtDumpMemoryLeaks()</a> in my Init function and in my Exit function those entries are in both lists.</p>\n\n<p>The <a href=\"https://docs.microsoft.com/en-us/cpp/c-runtime-library/reference/crtmemdumpallobjectssince?view=vs-2019\" rel=\"nofollow noreferrer\">documentation</a> says this:</p>\n\n<blockquote>\n  <p>_CrtMemDumpAllObjectsSince uses the value of the state parameter to determine where to initiate the dump operation. To begin dumping from\n  a specified heap state, the state parameter must be a pointer to a\n  _CrtMemState structure that has been filled in by _CrtMemCheckpoint before _CrtMemDumpAllObjectsSince was called.</p>\n</blockquote>\n\n<p>Which makes me believe that items tracked in startState would be excluded from the output.  At the end of the Init function where _CrtMemCheckpoint is called there have been about 4700 allocation calls.  Shouldn't _CrtMemDumpAllObjectsSince only dump objects allocated after that checkpoint call?</p>\n\n<p>What have I missed?</p>\n"}, {"tags": ["c", "assembly", "inline-assembly"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1564594850, "post_id": 57296246, "comment_id": 101086668, "body": "You know you don&#39;t need inline assembler just to invoke a syscall, right?"}, {"owner": {"reputation": 75, "user_id": 11729009, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1aeaab067fd7d266f8e47764ee6e2ad9?s=128&d=identicon&r=PG&f=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/11729009/jason"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1564595040, "post_id": 57296246, "comment_id": 101086746, "body": "why i don&#39;t need ?? if i use &quot;write&quot; fucntion, it will use the std wirte function which this syscall will happen inside it ... and also if i use (syscall) function, still there is an extra call to &quot;syscall&quot; function"}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 1, "creation_date": 1564595172, "post_id": 57296246, "comment_id": 101086805, "body": "Just include <code>unistd.h</code> and use <code>write</code> from there. No need for non-portable inline assembly."}, {"owner": {"reputation": 75, "user_id": 11729009, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1aeaab067fd7d266f8e47764ee6e2ad9?s=128&d=identicon&r=PG&f=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/11729009/jason"}, "edited": false, "score": 0, "creation_date": 1564595219, "post_id": 57296246, "comment_id": 101086835, "body": "this is the problem ... write in unistd is not a syscall ... it&#39;s a function which we &quot;call&quot; it and this syscall will happen inside it .... why i should call another function to use syscall inside it ??? !!"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 2, "creation_date": 1564595241, "post_id": 57296246, "comment_id": 101086847, "body": "Because it&#39;s easier, more portable, and faster."}, {"owner": {"reputation": 75, "user_id": 11729009, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1aeaab067fd7d266f8e47764ee6e2ad9?s=128&d=identicon&r=PG&f=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/11729009/jason"}, "edited": false, "score": 0, "creation_date": 1564595363, "post_id": 57296246, "comment_id": 101086893, "body": "no it&#39;s not faster in execution !!! alwyse direct syscall is faster in execution and performance is better"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1564595556, "post_id": 57296246, "comment_id": 101086973, "body": "Are you familiar with the <a href=\"http://man7.org/linux/man-pages/man7/vdso.7.html\" rel=\"nofollow noreferrer\">Linux vDSO</a>?"}, {"owner": {"reputation": 75, "user_id": 11729009, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1aeaab067fd7d266f8e47764ee6e2ad9?s=128&d=identicon&r=PG&f=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/11729009/jason"}, "edited": false, "score": 0, "creation_date": 1564595780, "post_id": 57296246, "comment_id": 101087078, "body": "no but i searched a little ... still i think it has an extra function calling ..."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 2, "creation_date": 1564595833, "post_id": 57296246, "comment_id": 101087099, "body": "I think you vastly overestimate how long a function call takes."}, {"owner": {"reputation": 75, "user_id": 11729009, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1aeaab067fd7d266f8e47764ee6e2ad9?s=128&d=identicon&r=PG&f=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/11729009/jason"}, "edited": false, "score": 0, "creation_date": 1564596169, "post_id": 57296246, "comment_id": 101087235, "body": "yes you right .... maybe &quot;call&quot; is not takes time but still it&#39;s an extra action ... and also i don&#39;t know what any extra things will happen in &quot;write&quot; function too !"}], "answers": [{"comments": [{"owner": {"reputation": 75, "user_id": 11729009, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1aeaab067fd7d266f8e47764ee6e2ad9?s=128&d=identicon&r=PG&f=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/11729009/jason"}, "edited": false, "score": 0, "creation_date": 1564595133, "post_id": 57296289, "comment_id": 101086783, "body": "amazing !! these registers are for all syscalls? is there any other register except rax and rcx and r11?"}, {"owner": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "reply_to_user": {"reputation": 75, "user_id": 11729009, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1aeaab067fd7d266f8e47764ee6e2ad9?s=128&d=identicon&r=PG&f=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/11729009/jason"}, "edited": false, "score": 0, "creation_date": 1564595755, "post_id": 57296289, "comment_id": 101087068, "body": "@Jason : In Linux the only register the system call doesn&#39;t restore is RAX as it is used as a return value. So the only registers that will potentially be clobbered are RAX and the two registers the <code>syscall</code> instruction itself clobbers (RCX and R11)."}, {"owner": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "edited": false, "score": 0, "creation_date": 1564595825, "post_id": 57296289, "comment_id": 101087097, "body": "Since you are passing pointers to memory through registers I&#39;d highly recommend adding a <code>memory</code> clobber to make sure what the pointers point at are realized into memory before you do the inline assembly. Without <code>memory</code> you can generate subtle bug when optimizations are on and what is being pointed at are stack based variables. Compilers like GCC will not emit data to a buffer on the stack if it thinks the data in the buffer/array itself isn&#39;t being used."}, {"owner": {"reputation": 75, "user_id": 11729009, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1aeaab067fd7d266f8e47764ee6e2ad9?s=128&d=identicon&r=PG&f=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/11729009/jason"}, "edited": false, "score": 0, "creation_date": 1564596058, "post_id": 57296289, "comment_id": 101087187, "body": "i use &quot;memory&quot; only when i have pointers to pass like this const void * and ... ?"}, {"owner": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "reply_to_user": {"reputation": 75, "user_id": 11729009, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1aeaab067fd7d266f8e47764ee6e2ad9?s=128&d=identicon&r=PG&f=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/11729009/jason"}, "edited": false, "score": 0, "creation_date": 1564596144, "post_id": 57296289, "comment_id": 101087226, "body": "@jason If you pass the address of some data through a register like RDI or RSI (n yhis case) you are only telling the compiler that the inline assembly that the pointers are being used, not what those pointers point at."}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "reply_to_user": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "edited": false, "score": 0, "creation_date": 1564596161, "post_id": 57296289, "comment_id": 101087232, "body": "@MichaelPetch Doesn&#39;t the <code>asm volatile</code> take care of this?  We don&#39;t write to memory, so surely a  <code>memory</code> clobber is not needed."}, {"owner": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "reply_to_user": {"reputation": 75, "user_id": 11729009, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1aeaab067fd7d266f8e47764ee6e2ad9?s=128&d=identicon&r=PG&f=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/11729009/jason"}, "edited": false, "score": 0, "creation_date": 1564596204, "post_id": 57296289, "comment_id": 101087247, "body": "@jason No, <code>volatile</code> doesn&#39;t handle that. Your inline assembly code expects that the data in the buffers is written to so that by the time the <code>syscall</code> sees it that it can read the buffer so it can write the data to a file descriptor."}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "reply_to_user": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "edited": false, "score": 0, "creation_date": 1564596483, "post_id": 57296289, "comment_id": 101087369, "body": "@MichaelPetch Can you give me an example where the compiler defers a memory write past an <code>asm volatile</code> when a pointer to that memory area is used?"}, {"owner": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "edited": false, "score": 2, "creation_date": 1564596803, "post_id": 57296289, "comment_id": 101087494, "body": "@fuz : Here is an example: <a href=\"https://pastebin.com/D4fy0uS3\" rel=\"nofollow noreferrer\">pastebin.com/D4fy0uS3</a>   . It will do as expected when optimizations are off  since the compiler is doing all the unnecessary loads and stores to and from memory. Then try it with <code>-O3</code>. Notice that the string has been placed on the stack. If you look at the generated code you will discover the optimizer never wrote the string to the stack because it was unaware the data in the string was being used. It only knew the pointer to the string was being used as input, not what the pointer was pointing at."}, {"owner": {"reputation": 75, "user_id": 11729009, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1aeaab067fd7d266f8e47764ee6e2ad9?s=128&d=identicon&r=PG&f=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/11729009/jason"}, "edited": false, "score": 0, "creation_date": 1564597108, "post_id": 57296289, "comment_id": 101087634, "body": "wonderful example ... i think it&#39;s better to update this answer with that &quot;memory&quot; thing ..."}, {"owner": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "edited": false, "score": 0, "creation_date": 1564597114, "post_id": 57296289, "comment_id": 101087636, "body": "You can see the effect in Godbolt when a higher optimization level is turned on. <a href=\"https://godbolt.org/z/TDz0iK\" rel=\"nofollow noreferrer\">godbolt.org/z/TDz0iK</a> vs when optimizations are off:"}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "reply_to_user": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "edited": false, "score": 0, "creation_date": 1564597155, "post_id": 57296289, "comment_id": 101087648, "body": "@MichaelPetch Cool example!  Thank you for this one.  LLVM seems more gracious and initialises the string anyway."}, {"owner": {"reputation": 75, "user_id": 11729009, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1aeaab067fd7d266f8e47764ee6e2ad9?s=128&d=identicon&r=PG&f=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/11729009/jason"}, "edited": false, "score": 0, "creation_date": 1564597190, "post_id": 57296289, "comment_id": 101087660, "body": "so i use &quot;rax&quot; and &quot;r11&quot; clobber for all syscalls and also use &quot;memory&quot; clobber for the syscalls that use a pointer to something ... true ?"}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "reply_to_user": {"reputation": 75, "user_id": 11729009, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1aeaab067fd7d266f8e47764ee6e2ad9?s=128&d=identicon&r=PG&f=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/11729009/jason"}, "edited": false, "score": 0, "creation_date": 1564597271, "post_id": 57296289, "comment_id": 101087702, "body": "@Jason Pretty much.  But do keep in mind that doing system calls directly is not really going to make your program measurably faster and you loose a lot of ways to debug or alter it (such as by using symbol interposition).  Also, the error handling is different like this; all the convenience given by the libc is lost."}, {"owner": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "reply_to_user": {"reputation": 75, "user_id": 11729009, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1aeaab067fd7d266f8e47764ee6e2ad9?s=128&d=identicon&r=PG&f=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/11729009/jason"}, "edited": false, "score": 0, "creation_date": 1564597335, "post_id": 57296289, "comment_id": 101087730, "body": "@jason I think you mean &quot;rcx&quot; and &quot;r11&quot; . The output constraint <code>=a</code> already tells the compiler rax will be overwritten. You will need a <code>memory</code> clobber when you pass the pointer to something through a register. If you use a memory constraints (which don&#39;t apply here since <code>syscall</code> forces pointers in registers) like <code>&quot;m&quot;</code> you can avoid the use of <code>memory</code> clobber (although you may have problems even with <code>&quot;m&quot;</code> constraints if passing arrays of data where the length of the array isn&#39;t known to the compiler."}, {"owner": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "reply_to_user": {"reputation": 75, "user_id": 11729009, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1aeaab067fd7d266f8e47764ee6e2ad9?s=128&d=identicon&r=PG&f=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/11729009/jason"}, "edited": false, "score": 1, "creation_date": 1564598367, "post_id": 57296289, "comment_id": 101088173, "body": "@jason : no problem. This kind of potential behaviour is actually documented in the GCC inline assembly documentation for the <code>memory</code> clobber. It shows some alternatives to using the <code>memory</code> clobber which include potentially adding dummy memory constraints. The docs for this can be found here: <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Extended-Asm.html\" rel=\"nofollow noreferrer\">gcc.gnu.org/onlinedocs/gcc/Extended-Asm.html</a> . Just search for <code>The &quot;memory&quot; clobber</code> to find the section."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "edited": false, "score": 0, "creation_date": 1564612334, "post_id": 57296289, "comment_id": 101093042, "body": "@MichaelPetch: We have a canonical Q&amp;A about the fact that pointer operands don&#39;t imply that the pointed-to memory is read or written:  <a href=\"//stackoverflow.com/q/56432259\">How can I indicate that the memory *pointed* to by an inline ASM argument may be used?</a>  For individual system call wrapper macros, you could of course use dummy memory inputs to avoid a <code>&quot;memory&quot;</code> clobber."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1564612537, "post_id": 57296289, "comment_id": 101093095, "body": "@fuz: LLVM isn&#39;t exactly &quot;more gracious&quot;, it&#39;s just bad at optimizing around inline asm.  It also always picks memory for a constraint like <code>&quot;rm&quot;</code> that allows a memory source, even if that means spilling a var from a register first!"}], "tags": [], "owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "is_accepted": true, "score": 5, "last_activity_date": 1564598272, "last_edit_date": 1564598272, "creation_date": 1564594742, "answer_id": 57296289, "question_id": 57296246, "link": "https://stackoverflow.com/questions/57296246/c-asm-linux-syscall-in-loop-continue-for-ever/57296289#57296289", "title": "C asm linux syscall in loop continue for ever", "body": "<p>The <code>syscall</code> instruction clobbers registers <code>rcx</code> and <code>r11</code>.  The compiler assumes their values are preserved, causing an infinite loop. Add these two to the clobber list to fix the problem:</p>\n\n<pre><code>#define write(RESULT, FD, BUFF, SIZE)               \\\n    asm volatile (\"syscall\" :                       \\\n        \"=a\" (RESULT) :                             \\\n        \"D\" (FD), \"S\" (BUFF), \"d\" (SIZE), \"a\" (1) : \\\n        \"rcx\", \"r11\", \"memory\")\n</code></pre>\n"}], "owner": {"reputation": 75, "user_id": 11729009, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1aeaab067fd7d266f8e47764ee6e2ad9?s=128&d=identicon&r=PG&f=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/11729009/jason"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 208, "favorite_count": 0, "accepted_answer_id": 57296289, "answer_count": 1, "score": 1, "last_activity_date": 1564598272, "creation_date": 1564594548, "question_id": 57296246, "link": "https://stackoverflow.com/questions/57296246/c-asm-linux-syscall-in-loop-continue-for-ever", "title": "C asm linux syscall in loop continue for ever", "body": "<p>I want to use extended asm in C language to handle a syscall (write).\neverything is fine and im using </p>\n\n<pre><code>#define write(RESULT, FD, BUFF, SIZE)   \\\n    asm volatile (\"syscall\" :           \\\n        \"=a\" (RESULT) :                 \\\n        \"D\" (FD), \"S\" (BUFF), \"d\" (SIZE), \"a\" (1))\n</code></pre>\n\n<p>this works without any problem ... for example</p>\n\n<pre><code>#define write(RESULT, FD, BUFF, SIZE)   \\\n    asm volatile (\"syscall\" :           \\\n        \"=a\" (RESULT) :                 \\\n        \"D\" (FD), \"S\" (BUFF), \"d\" (SIZE), \"a\" (1))\n\nint\nmain() {\n\n    int res;\n    write(res, 1, \"Hello\\n\", 6);\n\n    return 0;\n}\n</code></pre>\n\n<p>i have no problem with this code but my problem is when i put this call</p>\n\n<pre><code>write(res, 1, \"Hello\\n\", 6);\n</code></pre>\n\n<p>into a loop to use it for 100 times</p>\n\n<pre><code>#define write(RESULT, FD, BUFF, SIZE)   \\\n    asm volatile (\"syscall\" :           \\\n        \"=a\" (RESULT) :                 \\\n        \"D\" (FD), \"S\" (BUFF), \"d\" (SIZE), \"a\" (1))\n\nint\nmain() {\n\n    int res;\n    for (int i = 0; i &lt; 100; i++) {\n        write(res, 1, \"Hello\\n\", 6);\n    }    \n\n    return 0;\n}\n</code></pre>\n\n<p>but there is a point ... i have no problem with this code too but only in debug mode .... if i set the program to (Release) or optimization mode, this loop will be executed for ever !!!!! it's like there is no 100 times limitation ... this happen only in \"Release\" mode which optimize my code and makes it wrong !!</p>\n\n<p>yes ... the blow source code is find in \"debug\" but it's write \"Hello\" for ever (no limitation) in \"Release\" mode</p>\n\n<p>this is the assembly code which i used <a href=\"https://godbolt.org/\" rel=\"nofollow noreferrer\">online check</a>\nwith -O3 option (GCC x86_64)</p>\n\n<pre><code>.LC0:\n  .string \"Hello\\n\"\nmain:\n  movl $100, %ecx\n  movl $.LC0, %esi\n  movl $1, %edi\n  movl $6, %edx\n.L2:\n  movl %edi, %eax\n  syscall\n  subl $1, %ecx\n  jne .L2\n  xorl %eax, %eax\n  ret\n</code></pre>\n"}, {"tags": ["c", "gcc", "openssl"], "comments": [{"owner": {"reputation": 1053, "user_id": 7885081, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CZvVb.png?s=128&g=1", "display_name": "Jose Fernando Lopez Fernandez", "link": "https://stackoverflow.com/users/7885081/jose-fernando-lopez-fernandez"}, "edited": false, "score": 2, "creation_date": 1564673643, "post_id": 57296237, "comment_id": 101117108, "body": "Since the errors are specifically the assembly files, I would guess the problem is actually your Perl installation. OpenSSL uses perl to preprocess the assembly code. Do you have at least perl 5.10? There isn&#39;t a minimum C compiler version, as far as I know, it just needs to be ANSI compliant."}, {"owner": {"reputation": 649, "user_id": 6826476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yROmV.png?s=128&g=1", "display_name": "Omid N", "link": "https://stackoverflow.com/users/6826476/omid-n"}, "reply_to_user": {"reputation": 1053, "user_id": 7885081, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CZvVb.png?s=128&g=1", "display_name": "Jose Fernando Lopez Fernandez", "link": "https://stackoverflow.com/users/7885081/jose-fernando-lopez-fernandez"}, "edited": false, "score": 0, "creation_date": 1564674909, "post_id": 57296237, "comment_id": 101117854, "body": "@JoseFernandoLopezFernandez My perl version is 5.22.1 and your right, I just found out that the assembly file is generated by a perl script."}, {"owner": {"reputation": 1053, "user_id": 7885081, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CZvVb.png?s=128&g=1", "display_name": "Jose Fernando Lopez Fernandez", "link": "https://stackoverflow.com/users/7885081/jose-fernando-lopez-fernandez"}, "edited": false, "score": 0, "creation_date": 1564860592, "post_id": 57296237, "comment_id": 101171254, "body": "Any update on this? Were you able to figure out the problem?"}, {"owner": {"reputation": 649, "user_id": 6826476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yROmV.png?s=128&g=1", "display_name": "Omid N", "link": "https://stackoverflow.com/users/6826476/omid-n"}, "reply_to_user": {"reputation": 1053, "user_id": 7885081, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CZvVb.png?s=128&g=1", "display_name": "Jose Fernando Lopez Fernandez", "link": "https://stackoverflow.com/users/7885081/jose-fernando-lopez-fernandez"}, "edited": false, "score": 1, "creation_date": 1565101127, "post_id": 57296237, "comment_id": 101240845, "body": "@JoseFernandoLopezFernandez Yes, I found out the problem was from the perl script which was generating the assembly file. I fixed it on my own fork of Open SSL and made a pull request. You can see the changes I made in this link: <a href=\"https://github.com/openssl/openssl/pull/9518/files\" rel=\"nofollow noreferrer\">github.com/openssl/openssl/pull/9518/files</a> I believe the problem was from the new syntax of the assembly files or it might be a typo."}, {"owner": {"reputation": 1053, "user_id": 7885081, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CZvVb.png?s=128&g=1", "display_name": "Jose Fernando Lopez Fernandez", "link": "https://stackoverflow.com/users/7885081/jose-fernando-lopez-fernandez"}, "edited": false, "score": 0, "creation_date": 1565104464, "post_id": 57296237, "comment_id": 101242832, "body": "Nice, that&#39;s great. I don&#39;t think the OpenSSL team is going to accept the change as &quot;trivial&quot; though. At the very least I think it&#39;s going to require an update to the documentation to point out that ARM builds require the change in syntax. Trivial commits are basically just typos, I think. This is all speculation; I&#39;m not a committer, so this could be 100% wrong, but I&#39;m guessing that&#39;s what the comments on the commit are going to be. Specifically, I think they&#39;re going to want you to submit a CLA, which is not a big deal, but it will hold up the merge until they have that, for legal reasons."}], "answers": [{"tags": [], "owner": {"reputation": 649, "user_id": 6826476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yROmV.png?s=128&g=1", "display_name": "Omid N", "link": "https://stackoverflow.com/users/6826476/omid-n"}, "is_accepted": true, "score": 0, "last_activity_date": 1565745302, "creation_date": 1565745302, "answer_id": 57487024, "question_id": 57296237, "link": "https://stackoverflow.com/questions/57296237/problems-building-openssl-1-1-1c-using-gcc-version-4-3-3/57487024#57487024", "title": "Problems building OpenSSL 1.1.1c using gcc version 4.3.3", "body": "<p>Looks like the assembler was unable to recognize this syntax. </p>\n\n<p>After taking a look at other generated assembly files in the OpenSSL project, I found some lines of assembly code which were written in the same syntax with an additional comma(,) before the colons(:). So I went back to the main code and after changing the pointed lines by adding a comma before the colons, I had been able to get a successful build.\nI checked this change to see if it doesn't result in any misbehaves at the following link:\n<a href=\"https://stackoverflow.com/a/57317021/6826476\">https://stackoverflow.com/a/57317021/6826476</a></p>\n\n<p>I have also made a pull request to get a confirmation from the OpenSSL community and it got accepted:\n<a href=\"https://github.com/openssl/openssl/pull/9518#pullrequestreview-274502366\" rel=\"nofollow noreferrer\">https://github.com/openssl/openssl/pull/9518#pullrequestreview-274502366</a></p>\n"}], "owner": {"reputation": 649, "user_id": 6826476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yROmV.png?s=128&g=1", "display_name": "Omid N", "link": "https://stackoverflow.com/users/6826476/omid-n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 198, "favorite_count": 0, "accepted_answer_id": 57487024, "answer_count": 1, "score": 0, "last_activity_date": 1565745302, "creation_date": 1564594505, "last_edit_date": 1564661853, "question_id": 57296237, "link": "https://stackoverflow.com/questions/57296237/problems-building-openssl-1-1-1c-using-gcc-version-4-3-3", "title": "Problems building OpenSSL 1.1.1c using gcc version 4.3.3", "body": "<p>I'm trying to compile the OpenSSL 1.1.1c project in a toolchain which uses <code>gcc 4.3.3</code>\nAfter finishing the configurations and issuing <code>make</code> the following error messages are shown:</p>\n\n<pre><code>crypto/sha/keccak1600-armv4.S: Assembler messages:\ncrypto/sha/keccak1600-armv4.S:2203: Error: ']' expected -- `vst1.64 {q4},[r0:64]'\ncrypto/sha/keccak1600-armv4.S:2205: Error: ']' expected -- `vst1.64 {d18},[r1:64]'\ncrypto/sha/keccak1600-armv4.S:2248: Error: ']' expected -- `vld1.64 {q4},[r0:64]'\ncrypto/sha/keccak1600-armv4.S:2251: Error: ']' expected -- `vld1.64 {d18},[r1:64]'\ncrypto/sha/keccak1600-armv4.S:2326: Error: ']' expected -- `vst1.64 {q13},[r0:64]'\ncrypto/sha/keccak1600-armv4.S:2347: Error: ']' expected -- `vld1.64 d25,[r2:64]!'\n...\n</code></pre>\n\n<p>I assume the problem is because of the low version of gcc which I am using. \nI didn't find any explanations about the minimum required gcc version in the <a href=\"https://wiki.openssl.org/index.php/Compilation_and_Installation\" rel=\"nofollow noreferrer\">OpenSSL Wiki</a>. </p>\n\n<p>How can I solve this error?</p>\n\n<p>Is the problem from the gcc version?</p>\n"}, {"tags": ["c", "binary"], "comments": [{"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1564594596, "post_id": 57296082, "comment_id": 101086546, "body": "The last <code>printf</code> statement is wrong. You are not supposed to pass an array (<code>binary</code>) for a <code>%x</code> format specification. To see what is in the array, print each array element separately. (Since it is an array of <code>char</code>, you can abuse C semantics and print it with <code>%s</code>. First, set the last element to 0 (<code>binary[8] = 0;</code>) and then pass it to <code>printf</code> as you do now, but change <code>%x</code> to <code>%s</code>. Also, remove the <code>\\r</code>.)"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1564594705, "post_id": 57296082, "comment_id": 101086602, "body": "In the future, when you ask what is wrong with code, include a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> so that other people can compile and work with your code easily."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1564594720, "post_id": 57296082, "comment_id": 101086609, "body": "Turn on warnings in your compiler. It should have warned you that <code>binary</code> is the wrong argument for <code>%x</code>."}, {"owner": {"reputation": 768, "user_id": 6110631, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/bJuLe.png?s=128&g=1", "display_name": "InterLinked", "link": "https://stackoverflow.com/users/6110631/interlinked"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1564594999, "post_id": 57296082, "comment_id": 101086731, "body": "@EricPostpischil I think I follow, working on revisions now. But why remove the <code>\\r</code>? Otherwise there is a new line but no carriage return, which leads to messy output. <code>\\r</code> is required for carriage return"}, {"owner": {"reputation": 768, "user_id": 6110631, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/bJuLe.png?s=128&g=1", "display_name": "InterLinked", "link": "https://stackoverflow.com/users/6110631/interlinked"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1564595531, "post_id": 57296082, "comment_id": 101086960, "body": "@EricPostpischil I&#39;m in a similar dilemma now, instead of a perpetual <code>9A</code>, I get a perpetual <code>a3</code>. You said you can&#39;t pass in an array to sprintf - yet then how do you build up a string (inevitably a char[]) and then pass it in? I followed this answer: <a href=\"https://stackoverflow.com/a/2674333\">stackoverflow.com/a/2674333</a>"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1564595811, "post_id": 57296082, "comment_id": 101087089, "body": "Per the 2018 C standard, <code>\\n</code> is the <i>new line</i> character and \u201cMoves the active position to the initial position of the next line\u201d (5.2.2 2). A <code>\\r</code> should be unnecessary. If the system you are using does not both move the cursor to the next line and to the start of that line, it is not conforming to the C standard."}, {"owner": {"reputation": 768, "user_id": 6110631, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/bJuLe.png?s=128&g=1", "display_name": "InterLinked", "link": "https://stackoverflow.com/users/6110631/interlinked"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1564595987, "post_id": 57296082, "comment_id": 101087155, "body": "@EricPostpischil Interesting. I was initially using just <code>\\n</code> and could not figure out why things were messed up. I wondered if perhaps <code>\\n</code> was sufficient in Unix but not Windows (CF/LF/CF+LF encoding). I added the <code>\\r</code> and it fixed my issue, so I always use both now"}], "answers": [{"comments": [{"owner": {"reputation": 768, "user_id": 6110631, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/bJuLe.png?s=128&g=1", "display_name": "InterLinked", "link": "https://stackoverflow.com/users/6110631/interlinked"}, "edited": false, "score": 0, "creation_date": 1564668619, "post_id": 57307281, "comment_id": 101114159, "body": "Very odd. When I use your encryptCallSign (though I&#39;m not encrypting anything, just shifting bits), I do get the correct translation <i>per character</i>. However, when I have the following code in <code>main</code>: <code>printf(&quot;before %x&quot;, dest);       formatCallSign(&amp;dest);       printf(&quot;after %x&quot;, dest);</code> - I get &quot;before 88... the correct individual characters... after 88&quot;. I think it&#39;s referencing the memory location as you said. Should I combine your answer with the other and use strtol or sprintf to explicitly cast the string to binary?"}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "reply_to_user": {"reputation": 768, "user_id": 6110631, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/bJuLe.png?s=128&g=1", "display_name": "InterLinked", "link": "https://stackoverflow.com/users/6110631/interlinked"}, "edited": false, "score": 0, "creation_date": 1564669117, "post_id": 57307281, "comment_id": 101114496, "body": "@InterLinked Again, <code>%x</code> is <b>not</b> the right way to print a string of characters."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "reply_to_user": {"reputation": 768, "user_id": 6110631, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/bJuLe.png?s=128&g=1", "display_name": "InterLinked", "link": "https://stackoverflow.com/users/6110631/interlinked"}, "edited": false, "score": 0, "creation_date": 1564669269, "post_id": 57307281, "comment_id": 101114588, "body": "I&#39;m not in a position to post tested code just now, but try <code>printf(&quot;%s\\n&quot;, callSign)</code> both before and after to call to <code>encryptCallSign</code>, or, if you want to see the hexadecimal representation of the characters (rather than the raw characters), try something like <code>for(i = 0; i &lt; strlen(callSign); i++) printf(&quot;%02x &quot;, callSign[i]);</code>.  And to make sure you understand what&#39;s going on here, compare the behavior of the very similar loop <code>for(i = 0; i &lt; strlen(callSign); i++) printf(&quot;%c &quot;, callSign[i]);</code>."}, {"owner": {"reputation": 768, "user_id": 6110631, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/bJuLe.png?s=128&g=1", "display_name": "InterLinked", "link": "https://stackoverflow.com/users/6110631/interlinked"}, "edited": false, "score": 0, "creation_date": 1564669394, "post_id": 57307281, "comment_id": 101114669, "body": "That&#39;s close enough to what I need it do that it suffices, later on I actually need to build a super array containing the ordered hex values of all the callsigns of which I shift the bits, so having it in an array is an advantage after all. Thanks!"}], "tags": [], "owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "is_accepted": true, "score": 1, "last_activity_date": 1564657104, "last_edit_date": 1564657104, "creation_date": 1564656346, "answer_id": 57307281, "question_id": 57296082, "link": "https://stackoverflow.com/questions/57296082/how-to-get-and-store-binary-values-for-operations/57307281#57307281", "title": "How to get and store binary values for operations?", "body": "<p>There are two problems here.  I'll cover the easy, superficial one first.  Your code is <em>almost</em> correctly converting characters to their binary representation.  It's creating that representation as a string.  (This probably isn't what you want; more on that in a bit.)  But then it tries to print the string using printf's <code>%x</code> format.  Now, <code>%x</code> is for printing <em>numbers</em>, not strings, and due to the sometimes-surprising way C treats arrays and pointers, if you have an array <code>char binary[9]</code> and you try to print it using <code>%x</code>, what you get is the <em>address</em> of the array, not the contents of the array.  I think that's why you got the same value every time.</p>\n\n<p>You also forgot to null-terminate the constructed <code>binary</code> string.</p>\n\n<p>Here's a corrected version of your <code>formatCallSign</code> function.  (I've cleaned up a few other things at the same time.)</p>\n\n<pre><code>void formatCallSign(unsigned char *callsign) {\n   printf(\"original is %s\\n\",callsign);\n   for (int j = 0; j &lt; strlen(callsign); j++) {\n      printf(\"Hex of %c is %x\\n\", callsign[j], callsign[j]);\n      char binary[9];\n      binary[0] = ( (callsign[j] &amp; (1 &lt;&lt; 7)) ? '1' : '0' );\n      binary[1] = ( (callsign[j] &amp; (1 &lt;&lt; 6)) ? '1' : '0' );\n      binary[2] = ( (callsign[j] &amp; (1 &lt;&lt; 5)) ? '1' : '0' );\n      binary[3] = ( (callsign[j] &amp; (1 &lt;&lt; 4)) ? '1' : '0' );\n      binary[4] = ( (callsign[j] &amp; (1 &lt;&lt; 3)) ? '1' : '0' );\n      binary[5] = ( (callsign[j] &amp; (1 &lt;&lt; 2)) ? '1' : '0' );\n      binary[6] = ( (callsign[j] &amp; (1 &lt;&lt; 1)) ? '1' : '0' );\n      binary[7] = ( (callsign[j] &amp; (1 &lt;&lt; 0)) ? '1' : '0' );\n      binary[8] = '\\0';\n      printf(\"Binary of %c is: %s\\r\\n\", callsign[j], binary);\n   }\n}\n</code></pre>\n\n<p>With this function, when I call <code>formatCallSign(\"CQ\")</code>, it prints</p>\n\n<pre><code>original is CQ\nHex of C is 43\nBinary of C is: 01000011\nHex of Q is 51\nBinary of Q is: 01010001\n</code></pre>\n\n<p>And that's fine, it makes sense, those are the correct binary representations of <code>C</code> and <code>Q</code> in ASCII.</p>\n\n<p>But it's also much more trouble than it's worth -- and in fact it's pretty useless.  You said your ultimate goal is to shift bits in those characters, but converting everything to a string array <code>binary</code> is going to make that problem much harder.  (And we haven't even gotten to the problem of converting the binary strings back to real 8-bit characters.)</p>\n\n<p>As you probably know, just about everything you manipulate in a C program -- characters, integers, floating-point numbers, strings -- is, deep down inside, <em>already</em> in binary.  For example, the character <code>C</code> is already represented internally as 01000011.  It only <em>looks</em> like the character <code>C</code> if you print it out using <code>%c</code>, and it only <em>looks</em> like the hexadecimal number <code>43</code> if you print it out using <code>%x</code>.  Deep down inside it's still 01000011, and that didn't change when you printed it out in some other representation.</p>\n\n<p>And since characters are already represented internally as binary numbers, if you want to shift a character's binary representation left by 1, you can do that with a simple, straightforward application of the <code>&lt;&lt;</code> operator, no explicit conversion to binary beforehand required.  Here's an <code>encryptCallSign</code> function that does what I think you had in mind:</p>\n\n<pre><code>void encryptCallSign(unsigned char *callsign) {\n    for(int j = 0; j &lt; strlen(callsign); j++) {\n        unsigned char newchar = callsign[j] &lt;&lt; 1;\n        printf(\"%X -&gt; %X\\n\", callsign[j], newchar);\n        callsign[j] = newchar;\n    }\n}\n</code></pre>\n\n<p>I tried calling it from a little test <code>main</code> function like this:</p>\n\n<pre><code>main()\n{\n    char callSign[] = \"CQ\";\n    formatCallSign(callSign);\n    printf(\"encrypting...\\n\");\n    encryptCallSign(callSign);\n    printf(\"encrypted:\\n\");\n    formatCallSign(callSign);\n}\n</code></pre>\n\n<p>And this is the output I got:</p>\n\n<pre><code>original is CQ\nHex of C is 43\nBinary of C is: 01000011\nHex of Q is 51\nBinary of Q is: 01010001\nencrypting...\n43 -&gt; 86\n51 -&gt; A2\nencrypted:\noriginal is \u00a2\nHex of  is 86\nBinary of  is: 10000110\nHex of \u00a2 is a2\nBinary of \u00a2 is: 10100010\n</code></pre>\n\n<p>This looks a little funny because the character with value <code>A2</code> is the <code>\u00a2</code> sign (in ISO-8601-1 \"Latin1\", anyway), and the character with value <code>86</code> doesn't have a printing representation.</p>\n\n<p>Simple as it is, the <code>encryptCallSign</code> function I've shown is about twice as long as it needs to be.  If it weren't printing out its work as it goes along, we could simplify it down to</p>\n\n<pre><code>void encryptCallSign(unsigned char *callsign) {\n    for(int j = 0; j &lt; strlen(callsign); j++)\n        callsign[j] = callsign[j] &lt;&lt; 1;\n}\n</code></pre>\n\n<p>(You could also use C's \"op =\" shortcut <code>callsign[j] &lt;&lt;= 1</code>.)</p>\n\n<p>There are some other issues here -- for example, my compiler correctly complains that there's some fishy intermixing of <code>char *</code> and <code>unsigned char *</code> types going on -- but this should hopefully get you pointed in the right direction.</p>\n"}], "owner": {"reputation": 768, "user_id": 6110631, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/bJuLe.png?s=128&g=1", "display_name": "InterLinked", "link": "https://stackoverflow.com/users/6110631/interlinked"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 57307281, "answer_count": 1, "score": 0, "last_activity_date": 1564661027, "creation_date": 1564593815, "last_edit_date": 1564594904, "question_id": 57296082, "link": "https://stackoverflow.com/questions/57296082/how-to-get-and-store-binary-values-for-operations", "title": "How to get and store binary values for operations?", "body": "<p>I am trying to convert an array of characters to  binary. I've spent an hour now perusing SO posts, but few do quite what I need and none of them has worked for me.</p>\n\n<pre><code>void formatCallSign(unsigned char *callsign) {\n   unsigned char new[7];\n   printf(\"original is %s\",callsign);\n   for (int j = 0; j &lt; 6; j++) {\n      printf(\"Hex of this is %x\", callsign[j]); // this correctly prints out the original hex value\n      char binary[9];\n      binary[0] = ( (callsign[j] &amp; (1 &lt;&lt; 7)) ? '1' : '0' );\n      binary[1] = ( (callsign[j] &amp; (1 &lt;&lt; 6)) ? '1' : '0' );\n      binary[2] = ( (callsign[j] &amp; (1 &lt;&lt; 5)) ? '1' : '0' );\n      binary[3] = ( (callsign[j] &amp; (1 &lt;&lt; 4)) ? '1' : '0' );\n      binary[4] = ( (callsign[j] &amp; (1 &lt;&lt; 3)) ? '1' : '0' );\n      binary[5] = ( (callsign[j] &amp; (1 &lt;&lt; 2)) ? '1' : '0' );\n      binary[6] = ( (callsign[j] &amp; (1 &lt;&lt; 1)) ? '1' : '0' );\n      binary[7] = ( (callsign[j] &amp; (1 &lt;&lt; 0)) ? '1' : '0' );\n      printf(\"Binary of %c is: %x\\r\\n\", callsign[j], binary); // print hex representation of character\n   }\n   }\n</code></pre>\n\n<p>Essentially, the input to this function is a 7-character string (char array). I was also using a nested for loop, but the compiler was generating infinite loop errors that made no sense, so I rewrote it like this.</p>\n\n<p>I need to then get the binary representation of that character and shift do a left bitwise shift by 1 (not always but 95% of the time, I can add the logic later). After the bitshift, I need the hex value.</p>\n\n<p>Getting the binary value has proved elusive. In a prior project, I was never able to do it properly, and could only get the hex value. In this case, I can also get the hax value in the second printf statement, but I can't do a bitwise shift with the hex value, as I need to shift the individual bits.</p>\n\n<p>Yet, when I run the program, it always says <code>Binary of [char] is: 9A</code>. Always 9A, which is not the hex rep. of <em>any</em> of the characters in the string I pass into it.</p>\n\n<p>My thought is to use <code>sprintf</code> and pass in the array and use <code>%x</code> to get the hex representation of it. Right now, it prints to the console, but I would actually store that in the new array, which is unused in this snippet right now. Is it possible to do this somehow? The code to get the binary doesn't seem to work (based on the second part of <a href=\"https://stackoverflow.com/a/7863524\">this answer</a>).</p>\n\n<p>(To clarify, my 2nd and 3rd <code>printf</code> statements in this snippet <em>should</em> output the same thing. Only the 2nd one works. The reason for drawing it out like that is so I can do bitwise operations and then use a sprintf to put it back into a coherent single value and get the hex from that.)</p>\n\n<p>Many questions address this topic, but few have been helpful because I am not interested in printing the binary out to the console. Rather, I need to store the binary in a variable, do bitwise operations with it, then get a hex representation of the <em>final</em> binary. Right now, I can successfully get a hex representation of the <em>original</em> character, but that is not helpful.</p>\n\n<p>My only other idea is to <a href=\"https://stackoverflow.com/a/36099747/6110631\">manually define the binary values of every hex number</a> and then use that as a \"lookup table\", but this seems inefficient.</p>\n\n<p>To test this, all else that is required is this in <code>main</code>:</p>\n\n<pre><code>unsigned char dest[8]   = \"CQ     \";\nformatCallSign(&amp;dest);\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 21664, "user_id": 26742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e55b3f0161d8b3b4f573a655679220d?s=128&d=identicon&r=PG", "display_name": "Sani Singh Huttunen", "link": "https://stackoverflow.com/users/26742/sani-singh-huttunen"}, "edited": false, "score": 0, "creation_date": 1564593933, "post_id": 57295987, "comment_id": 101086254, "body": "NoRep: <a href=\"https://onlinegdb.com/rkv818kXS\" rel=\"nofollow noreferrer\">onlinegdb.com/rkv818kXS</a>"}, {"owner": {"reputation": 23, "user_id": 11158324, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-14LLVU8-EtY/AAAAAAAAAAI/AAAAAAAAABI/3aNWcr2Z2ps/photo.jpg?sz=128", "display_name": "Anand Yeole", "link": "https://stackoverflow.com/users/11158324/anand-yeole"}, "reply_to_user": {"reputation": 21664, "user_id": 26742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e55b3f0161d8b3b4f573a655679220d?s=128&d=identicon&r=PG", "display_name": "Sani Singh Huttunen", "link": "https://stackoverflow.com/users/26742/sani-singh-huttunen"}, "edited": false, "score": 0, "creation_date": 1564593994, "post_id": 57295987, "comment_id": 101086281, "body": "i think something is wrong with <code>pow()</code> function . I wrote another <code>power()</code> function in code and it is running fine so what is wrong happening with <code>pow()</code> function"}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 1, "creation_date": 1564613583, "post_id": 57295987, "comment_id": 101093300, "body": "<code>pow</code> function takes <code>double</code>s and returns a <code>double</code>. You probably get a rounding error and the <code>if (res==i)</code> doesn&#39;t get true."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1564755461, "post_id": 57295987, "comment_id": 101146637, "body": "I ran the OPs code, under linux 18.04 and gcc.  The result was the correct 4 outputs.   I suspect your problem is using the <code>pow()</code> function"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 11158324, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-14LLVU8-EtY/AAAAAAAAAAI/AAAAAAAAABI/3aNWcr2Z2ps/photo.jpg?sz=128", "display_name": "Anand Yeole", "link": "https://stackoverflow.com/users/11158324/anand-yeole"}, "edited": false, "score": 0, "creation_date": 1564594794, "post_id": 57296137, "comment_id": 101086639, "body": "so i thinks its compiler problem as it is running fine on dev c++ but not on code:blocks."}], "tags": [], "owner": {"reputation": 3419, "user_id": 7422352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c4e9f7e19cb98ee09930bb5454a5e78?s=128&d=identicon&r=PG", "display_name": "Deepak Tatyaji Ahire", "link": "https://stackoverflow.com/users/7422352/deepak-tatyaji-ahire"}, "is_accepted": false, "score": 0, "last_activity_date": 1564594069, "creation_date": 1564594069, "answer_id": 57296137, "question_id": 57295987, "link": "https://stackoverflow.com/questions/57295987/not-getting-a-desired-output-in-armstrong-number/57296137#57296137", "title": "not getting a desired output in armstrong number", "body": "<p>I tried running your code on Hackerrank Editor and it works perfectly fine and prints 153 as well.</p>\n\n<p>Try it out. Also attaching the screenshot:</p>\n\n<p><a href=\"https://i.stack.imgur.com/zEdZK.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zEdZK.png\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 0, "creation_date": 1564616677, "post_id": 57299717, "comment_id": 101093897, "body": "He needs an integer power function.  Harding coding the multiplies to a power of 3 will break the rest of his app."}], "tags": [], "owner": {"reputation": 11, "user_id": 11257031, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-vW6sqDyVG5E/AAAAAAAAAAI/AAAAAAAAARw/sKE0uBu5mvg/photo.jpg?sz=128", "display_name": "Tarek Rahman", "link": "https://stackoverflow.com/users/11257031/tarek-rahman"}, "is_accepted": false, "score": 0, "last_activity_date": 1564613051, "creation_date": 1564613051, "answer_id": 57299717, "question_id": 57295987, "link": "https://stackoverflow.com/questions/57295987/not-getting-a-desired-output-in-armstrong-number/57299717#57299717", "title": "not getting a desired output in armstrong number", "body": "<pre><code>#include&lt;stdio.h&gt;\n#include&lt;math.h&gt;\n\nvoid main() {\n  int number, i, digit, sum, start, end;\n  printf(\"Enter the range :\");\n  scanf(\"%d %d\", &amp;start, &amp;end);\n  for (i = start; i &lt;= end; i++) {\n    number = i;\n    sum = 0;\n\n    while (number &gt; 0) {\n        digit = number % 10;\n        sum += digit * digit * digit;\n        number /= 10;\n    }\n\n    if (sum == i) {\n        printf(\"%d\\t\", i);\n    }\n}\n</code></pre>\n\n<p>}</p>\n\n<p>Try this one</p>\n"}], "owner": {"reputation": 23, "user_id": 11158324, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-14LLVU8-EtY/AAAAAAAAAAI/AAAAAAAAABI/3aNWcr2Z2ps/photo.jpg?sz=128", "display_name": "Anand Yeole", "link": "https://stackoverflow.com/users/11158324/anand-yeole"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1564613051, "creation_date": 1564593321, "question_id": 57295987, "link": "https://stackoverflow.com/questions/57295987/not-getting-a-desired-output-in-armstrong-number", "title": "not getting a desired output in armstrong number", "body": "<p>its a program to find armstrong number between desired range \nsuppose i want to find amstrong between range 100 to 1000\nthen it is showing output as 370 371 407 but not 153 can't find what is going wrong</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;math.h&gt;\nint main()\n{\nint num,start,end,n,rem,res;\nprintf(\"Enter the range :\");\nscanf(\"%d %d\",&amp;start,&amp;end);\nprintf(\"Amstrong number between %d and %d are : \",start,end);\nfor(int i=start;i&lt;=end;i++)\n{\n    //int i=153;\n    num=i;\n    n=0;\n    while(num)\n    {\n        num/=10;\n        ++n;\n    }\n    num=i;\n    res=0;\n    while(num)\n    {\n        rem=num%10;\n        res=res+pow(rem,n);\n        num/=10;\n    }\n    if(res==i)\n        printf(\"%d\\t\",i);\n}\nreturn 0;\n}\n</code></pre>\n"}, {"tags": ["python", "c", "dll", "ctypes"], "comments": [{"owner": {"reputation": 28355, "user_id": 4788546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2jWn.jpg?s=128&g=1", "display_name": "CristiFati", "link": "https://stackoverflow.com/users/4788546/cristifati"}, "edited": false, "score": 0, "creation_date": 1564604254, "post_id": 57295045, "comment_id": 101090546, "body": "<code>Tridiagonal.Thomas.restype = POINTER(c_double)</code>. And does this <code>double* Thomas(int dimension, double MatrizTridiagonal[dimension]  [dimension],double vec_b[dimension]){</code> compile?"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 11795460, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-1w_cNy63yIg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf2Jnkj-JT2KcZ6QPLJdKg0z_vatg/photo.jpg?sz=128", "display_name": "Moreira12", "link": "https://stackoverflow.com/users/11795460/moreira12"}, "edited": false, "score": 0, "creation_date": 1564676809, "post_id": 57299823, "comment_id": 101118755, "body": "This explanation helped me a lot! I have some questions yet. I used the <b>free</b> function right after the <b>return</b> of the <b>Thomas</b> (C) function, but after several tests and errors I thought the <b>free</b> function could just be the problem because it frees the memory of the variable. couldn&#39;t i free the memory right after the <b>return</b>? Do you have any tips or bibliographies that you can recommend to improve my codestyle? I am always aware that I have to improve, but I always leave it aside."}, {"owner": {"reputation": 28355, "user_id": 4788546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2jWn.jpg?s=128&g=1", "display_name": "CristiFati", "link": "https://stackoverflow.com/users/4788546/cristifati"}, "reply_to_user": {"reputation": 21, "user_id": 11795460, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-1w_cNy63yIg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf2Jnkj-JT2KcZ6QPLJdKg0z_vatg/photo.jpg?sz=128", "display_name": "Moreira12", "link": "https://stackoverflow.com/users/11795460/moreira12"}, "edited": false, "score": 0, "creation_date": 1564732407, "post_id": 57299823, "comment_id": 101134889, "body": "You need to free a pointer once you&#39;re done with it. If you free it before returning the function, when you access it from <i>Python</i>, it is invalid. That&#39;s why a separate function (that is called manually by the user) is required. Regarding codestyle, check <a href=\"https://www.python.org/dev/peps/pep-0008/\" rel=\"nofollow noreferrer\">python.org/dev/peps/pep-0008</a>, and regarding <i>C</i>, there are some, here&#39;s one example: <a href=\"https://www.gnu.org/prep/standards/html_node/Formatting.html#Formatting\" rel=\"nofollow noreferrer\">gnu.org/prep/standards/html_node/Formatting.html#Formatting</a>."}, {"owner": {"reputation": 28355, "user_id": 4788546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2jWn.jpg?s=128&g=1", "display_name": "CristiFati", "link": "https://stackoverflow.com/users/4788546/cristifati"}, "reply_to_user": {"reputation": 21, "user_id": 11795460, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-1w_cNy63yIg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf2Jnkj-JT2KcZ6QPLJdKg0z_vatg/photo.jpg?sz=128", "display_name": "Moreira12", "link": "https://stackoverflow.com/users/11795460/moreira12"}, "edited": false, "score": 0, "creation_date": 1573079672, "post_id": 57299823, "comment_id": 103768783, "body": "@Moreira12: Did this answer your question? If yes, please accept the answer, so that others are able to acknowledge it as well  (<a href=\"https://stackoverflow.com/help/someone-answers\">&#91;SO&#93;: What should I do when someone answers my question?</a>)."}], "tags": [], "owner": {"reputation": 28355, "user_id": 4788546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2jWn.jpg?s=128&g=1", "display_name": "CristiFati", "link": "https://stackoverflow.com/users/4788546/cristifati"}, "is_accepted": false, "score": 0, "last_activity_date": 1606636031, "last_edit_date": 1606636031, "creation_date": 1564614033, "answer_id": 57299823, "question_id": 57295045, "link": "https://stackoverflow.com/questions/57295045/problems-with-passing-and-getting-arrays-for-a-c-function-using-ctypes/57299823#57299823", "title": "Problems with passing and getting arrays for a C function using ctypes", "body": "<p>Mentioning <a href=\"https://docs.python.org/library/ctypes.html#module-ctypes\" rel=\"nofollow noreferrer\">[Python.Docs]: ctypes - A foreign function library for Python</a>.</p>\n<p>There are a number of problems with your code. Here are a few:</p>\n<ul>\n<li>I don't know how a function header like this <code>double *Thomas(int dimension, double MatrizTridiagonal[dimension][dimension], double vec_b[dimension])</code> compiles (because of <em>dimension</em>). However, I didn't test it with <em>gcc</em></li>\n<li>Your <em>C</em> and <em>Python</em> function header (return value) differs: <code>double*</code> <em>vs.</em> <code>ctypes.POINTER(ctypes.c_double * 5)</code></li>\n<li>You never deallocate the returned array, resulting in <em>memory leaks</em></li>\n<li>The codestyle (including naming) could be very much improved</li>\n</ul>\n<p>When dealing with arrays (especially multidimensional - since dimension needs to be known at compile time) as function arguments, meaning that they are passed from outside, there are a couple of ways to handle things:</p>\n<ol>\n<li>Use a maximum constant value for dimension. The limitation is pretty obvious</li>\n<li>Use pointers instead. The drawback is that the function header is not that clear, and in general people tend to run away from pointers in general, but especially if they have more than one level of indirection (<em>2 star pointer</em> :) )</li>\n</ol>\n<p>However, I chose the latter approach. I created a dummy <em>.dll</em>, which contains a function that calculates the product of the 2 arrays (thinking of the <em>1D</em> array as a <em>2D</em> array that only has one column).</p>\n<p><em>dll0.c</em>:</p>\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdlib.h&gt;\n\n#if defined(_WIN32)\n#  define DLL0_EXPORT_API __declspec(dllexport)\n#else\n#  define DLL0_EXPORT_API\n#endif\n\n\nDLL0_EXPORT_API double *dll0Func0(int dimension, double **arr2D, double *arr1D) {\n    double *solution = (double*)calloc(dimension, sizeof(double));\n    for (int i = 0; i &lt; dimension; i++) {\n        for (int j = 0; j &lt; dimension; j++) {\n            solution[i] += arr2D[i][j] * arr1D[j];\n        }\n    }\n    return solution;\n}\n\n\nDLL0_EXPORT_API void dealloc(double *ptr) {\n    free(ptr);\n}\n</code></pre>\n<p><em>script0.py</em>:</p>\n<pre class=\"lang-py prettyprint-override\"><code>#!/usr/bin/env python3\n\nimport sys\nimport ctypes\n\n\nDLL_NAME = &quot;./dll0.dll&quot;\n\n\ndef main():\n    dim = 5\n    DoubleArr = ctypes.c_double * dim\n    DoubleArrArr = DoubleArr * dim\n\n    DoublePtr = ctypes.POINTER(ctypes.c_double)\n    DoublePtrPtr = ctypes.POINTER(DoublePtr)\n\n    DoublePtrArr = DoublePtr * dim\n\n    dll0 = ctypes.CDLL(DLL_NAME)\n\n    dll0Func0 = dll0.dll0Func0\n    dll0Func0.argtypes = [ctypes.c_int, DoublePtrPtr, DoublePtr]\n    dll0Func0.restype = DoublePtr\n\n    dealloc = dll0.dealloc\n    dealloc.argtypes = [DoublePtr]\n\n    mat = DoubleArrArr(\n        (2, -1, 0, 0, 0),\n        (-1, 2, -1, 0, 0),\n        (0, -1, 2, -1, 0),\n        (0, 0, -1, 2, -1),\n        (0, 0, 0, -1, 2),\n    )\n    vec = DoubleArr(4, 2, 2, 2, 4)\n\n    res = dll0Func0(dim, ctypes.cast(DoublePtrArr(*(ctypes.cast(row, DoublePtr) for row in mat)), DoublePtrPtr), ctypes.cast(vec, DoublePtr))\n    print(&quot;{0:s} returned {1:}&quot;.format(dll0Func0.__name__, res))\n    for i in range(dim):\n        print(&quot;{0:d} - {1:.3f}&quot;.format(i, res[i]))\n\n    dealloc(res)\n\n\nif __name__ == &quot;__main__&quot;:\n    print(&quot;Python {0:s} {1:d}bit on {2:s}\\n&quot;.format(&quot; &quot;.join(item.strip() for item in sys.version.split(&quot;\\n&quot;)), 64 if sys.maxsize &gt; 0x100000000 else 32, sys.platform))\n    main()\n    print(&quot;\\nDone.&quot;)\n</code></pre>\n<p>The only tricky thing here is the <em>DoublePtrArr</em> cast, as the <em>2D</em> array can't be cast to double (<em><strong>**</strong></em>, not the type) pointer directly (I mean it can be, but the 2 memory layouts differ, so it would generate <em><strong>Undefined Behavior</strong></em>, and most likely the program will <em>segfault</em> (<em>Access Violation</em>)), so each inner array is cast separately in the intermediary object, which will be then cast to a double (<em><strong>**</strong></em>) pointer (that the function expects).</p>\n<p><strong>Output</strong>:</p>\n\n<blockquote>\n<pre class=\"lang-batch prettyprint-override\"><code>cfati@CFATI-5510-0:e:\\Work\\Dev\\StackOverflow\\q057295045]&gt; sopr.bat\n*** Set shorter prompt to better fit when pasted in StackOverflow (or other) pages ***\n\n[prompt]&gt; &quot;c:\\Install\\x86\\Microsoft\\Visual Studio Community\\2017\\VC\\Auxiliary\\Build\\vcvarsall.bat&quot; x64\n**********************************************************************\n** Visual Studio 2017 Developer Command Prompt v15.9.14\n** Copyright (c) 2017 Microsoft Corporation\n**********************************************************************\n[vcvarsall.bat] Environment initialized for: 'x64'\n\n[prompt]&gt; dir /b\ndll0.c\nscript0.py\nthomas.c\nThomas.h\n\n[prompt]&gt; cl /nologo /DDLL dll0.c  /link /NOLOGO /DLL /OUT:dll0.dll\ndll0.c\n   Creating library dll0.lib and object dll0.exp\n\n[prompt]&gt; dir /b *.dll\ndll0.dll\n\n[prompt]&gt; &quot;e:\\Work\\Dev\\VEnvs\\py_064_03.07.03_test0\\Scripts\\python.exe&quot; script0.py\nPython 3.7.3 (v3.7.3:ef4ec6ed12, Mar 25 2019, 22:22:05) [MSC v.1916 64 bit (AMD64)] 64bit on win32\n\ndll0Func0 returned &lt;__main__.LP_c_double object at 0x0000026CD4BEC4C8&gt;\n0 - 6.000\n1 - -2.000\n2 - 0.000\n3 - -2.000\n4 - 6.000\n\nDone.\n</code></pre>\n</blockquote>\n"}], "owner": {"reputation": 21, "user_id": 11795460, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-1w_cNy63yIg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf2Jnkj-JT2KcZ6QPLJdKg0z_vatg/photo.jpg?sz=128", "display_name": "Moreira12", "link": "https://stackoverflow.com/users/11795460/moreira12"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 334, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1606636031, "creation_date": 1564589530, "last_edit_date": 1564614062, "question_id": 57295045, "link": "https://stackoverflow.com/questions/57295045/problems-with-passing-and-getting-arrays-for-a-c-function-using-ctypes", "title": "Problems with passing and getting arrays for a C function using ctypes", "body": "<p>I'm trying to use ctypes for passing a bidimensional array and an unidimensional array to a C function from my python code then this function return an unidimensional array to my python terminal.</p>\n\n<p>1-I need to pass the array from python, as you will see below (how i tried to do).\n2-Probably i don't set up argument types and return types correctly. I've been searching a lot but nothing solve my problems.</p>\n\n<p>My C code named Thomas_PYTHON_DLL.c:</p>\n\n<pre><code>#include\"stdio.h\"\n#include\"stdlib.h\"\n#include\"Thomas.h\"\n\n\nEXPORT double* Thomas(int dimension, double MatrizTridiagonal[dimension] \n[dimension],double vec_b[dimension]){\n\n\ndouble* Thomas(int dimension, double MatrizTridiagonal[dimension] \n[dimension],double vec_b[dimension]){\n\n\ndouble a[dimension];                            \ndouble b[dimension];                            \ndouble c[dimension];                            \ndouble resp[dimension];                         \n\ndouble *solution;\nsolution=(double *) malloc(dimension*sizeof(double));                       \n\nfor(int i=0;i&lt;dimension;i++){resp[i]=vec_b[i];}\n\n\nfor(int i=0;i&lt;dimension;i++){                    \n        if(i==0){a[i]=0.0;}\n        else{               \n            a[i]=MatrizTridiagonal[i][i-1]; \n            }\n}\n\nfor(int i=0;i&lt;dimension;i++){                           \n        b[i]=MatrizTridiagonal[i][i];       \n    }\n\n    for(int i=0;i&lt;dimension;i++){               \n        if(i==dimension-1){c[dimension-1]=0.0;}\n        else{\n            c[i]=MatrizTridiagonal[i][i+1];     \n    }\n}\n\n\nfor(int i=0;i&lt;dimension;i++){                   \n        if(i==0){\n            c[i]=c[i]/b[i];                     \n            resp[i]=resp[i]/b[i];               \n                        }\n        else{\n            c[i]=c[i]/(b[i]-c[i-1]*a[i]);                           \n            resp[i]=(resp[i]-a[i]*resp[i-1])/(b[i]-a[i]*c[i-1]);                \n    }\n}\n\n\nfor(int i=dimension-1;i&gt;=0;i--){            \n\n    if(i==dimension-1){\n        solution[i]=resp[i];\n    }\n\n    else{\n\n        solution[i]=resp[i]-c[i]*solution[i+1];\n    }   \n\n}\n\nfor(int i=0;i&lt;dimension;i++){printf(\"x%d=|%0.2f| \\n\",i,solution[i]);}  \n\nreturn solution;\n//free(solution);\n}\n\n}\n</code></pre>\n\n<p>My C code named Thomas.h:</p>\n\n<pre><code>#define EXPORT __declspec(dllexport)\n\nEXPORT double* Thomas(int dimension, double MatrizTridiagonal[dimension] \n[dimension],double vec_b[dimension]);\n</code></pre>\n\n<p>And finally my Python code, named Thomas_Python.py:</p>\n\n<pre><code>from ctypes import *\n\nx=(c_double*5)\nTridiagonal = cdll.LoadLibrary('Thomas_dll.dll')\nTridiagonal.Thomas.restype=POINTER(x)\nTridiagonal.Thomas.argtypes=[c_int,((c_double*5)*5),(c_double*5)]\n\n#arrays that i want to pass to C code\na=((c_double*5)*5)((2,-1,0,0,0),(-1,2,-1,0,0),(0,-1,2,-1,0),(0,0,-1,2,-1), \n(0,0,0,-1,2))\nb=(c_double*5)(4,2,2,2,4)\n\nr=Tridiagonal.Thomas(5,a,b)\n\nprint(r[2])\n</code></pre>\n\n<p>In the code above, i expected to print the value of the array r in the position \"2\", but the print show me:</p>\n\n<pre><code>&lt;__main__.c_double_Array_5 object at 0x03A77350&gt;\n</code></pre>\n\n<p>A great help would be beyond knowing how to read array values, getting the entire array as a list. Thank you so much for all your help and time, and I apologize for my English.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "edited": false, "score": 2, "creation_date": 1564588525, "post_id": 57294705, "comment_id": 101083733, "body": "It is possible, but it&#39;s not trivial."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 2, "creation_date": 1564592879, "post_id": 57294705, "comment_id": 101085831, "body": "Yes, operating systems do this all the time. They even let users, even unprivileged users, compile C code and run it on the fly, without reloading the operating system."}], "answers": [{"comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 2, "creation_date": 1564589203, "post_id": 57294746, "comment_id": 101084077, "body": "Yes, and if you do that, you deserve to reap the consequences of any misbehavior of the dynamically-generated binary."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 2, "last_activity_date": 1564588511, "creation_date": 1564588511, "answer_id": 57294746, "question_id": 57294705, "link": "https://stackoverflow.com/questions/57294705/is-there-a-way-to-compile-and-execute-dynamically-generated-code-in-c/57294746#57294746", "title": "Is there a way to compile and execute dynamically generated code in C?", "body": "<p>There's nothing built in to do this.</p>\n\n<p>This simplest thing to do is save the given code to a separate file, invoke GCC as a separate process to compile the code, then run the compiled code in a new process.</p>\n"}, {"tags": [], "owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "is_accepted": false, "score": 0, "last_activity_date": 1564600290, "last_edit_date": 1564600290, "creation_date": 1564588869, "answer_id": 57294856, "question_id": 57294705, "link": "https://stackoverflow.com/questions/57294705/is-there-a-way-to-compile-and-execute-dynamically-generated-code-in-c/57294856#57294856", "title": "Is there a way to compile and execute dynamically generated code in C?", "body": "<p>If you're targetting x86/ARM and Unix/Linux, you might find libtcc of use:</p>\n\n<pre><code>#include &lt;libtcc.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n\nint main(void) {\n    TCCState *s = tcc_new();\n    tcc_set_output_type(s, TCC_OUTPUT_MEMORY);\n\n    if (tcc_compile_string(s,\n                           \"#include &lt;stdio.h&gt;\\n\"\n                           \"void hello(void) {\\n\"\n                           \"    printf(\\\"Hello world\\\\n\\\");\\n\"\n                           \"}\\n\"\n        ) != 0)\n    {\n        fprintf(stderr, \"Failed to compile the code\\n\");\n        exit(2);\n    }\n\n    tcc_relocate(s, TCC_RELOCATE_AUTO);\n\n    void (*hello)(void) = tcc_get_symbol(s, \"hello\");\n    hello();\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "is_accepted": false, "score": 2, "last_activity_date": 1564589200, "creation_date": 1564589200, "answer_id": 57294953, "question_id": 57294705, "link": "https://stackoverflow.com/questions/57294705/is-there-a-way-to-compile-and-execute-dynamically-generated-code-in-c/57294953#57294953", "title": "Is there a way to compile and execute dynamically generated code in C?", "body": "<p>Relatively easy: write C code to temporary file, invoke <code>cc</code> on temporary file to create shared library, use <code>dlopen</code> to load in and call functions in shared library</p>\n\n<p>Harder: write C code to temporary file, invoke <code>cc</code> on temporary file to create conventional <code>.o</code> file, write your own dynamic linker to to load in and call functions in <code>.o</code> file</p>\n\n<p>Harder: write a C interpreter to interpret C code directly</p>\n"}], "owner": {"reputation": 35, "user_id": 9816797, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-pQ57VIFfhec/AAAAAAAAAAI/AAAAAAAAAZg/FKPrNES9Mm8/photo.jpg?sz=128", "display_name": "eye science international", "link": "https://stackoverflow.com/users/9816797/eye-science-international"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "accepted_answer_id": 57294746, "answer_count": 3, "score": -1, "last_activity_date": 1564600290, "creation_date": 1564588378, "question_id": 57294705, "link": "https://stackoverflow.com/questions/57294705/is-there-a-way-to-compile-and-execute-dynamically-generated-code-in-c", "title": "Is there a way to compile and execute dynamically generated code in C?", "body": "<p>Is it possible to execute C code in a C program? For instance when reading input from the user.</p>\n"}, {"tags": ["c", "pipe", "fifo"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 2, "creation_date": 1564588771, "post_id": 57294675, "comment_id": 101083853, "body": "Why do your reader/writer processes repeatedly open and close the pipe? How is that supposed to work?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 3, "creation_date": 1564588799, "post_id": 57294675, "comment_id": 101083865, "body": "You never check for errors \u2014 you&#39;ve no idea when the code starts going wrong."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1564588968, "post_id": 57294675, "comment_id": 101083957, "body": "When both ends of a FIFO are closed, any data unread in the pipe is discarded.  You probably need to revise the code so as to hold the FIFO open much longer than you currently do."}, {"owner": {"reputation": 5, "user_id": 8726802, "user_type": "registered", "profile_image": "https://graph.facebook.com/1637134533016144/picture?type=large", "display_name": "suchmitch", "link": "https://stackoverflow.com/users/8726802/suchmitch"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1564589147, "post_id": 57294675, "comment_id": 101084050, "body": "@melpomene, this is a basic implementation. My real program runs three threads that all write to the same fifo, that&#39;s why I need to close it for writing."}, {"owner": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 1, "creation_date": 1564589169, "post_id": 57294675, "comment_id": 101084060, "body": "Of course it &quot;crashes&quot;.  <code>fopen</code> fails, but you aren&#39;t checking that.  Instead, you just assume it returned a valid file pointer and tried to write to it."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 3, "creation_date": 1564589198, "post_id": 57294675, "comment_id": 101084075, "body": "@suchmitch That makes no sense."}, {"owner": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 1, "creation_date": 1564589292, "post_id": 57294675, "comment_id": 101084131, "body": "Just because 3 threads are all writing to the same fifo doesn&#39;t mean you need to open and close it each time you send data.  Open it once.  Spawn threads.  Have each thread write data.  When they&#39;re done writing, close it.  Or, have each thread open the file once, write data until they&#39;re done, and then close.  But that&#39;s harder to implement if you use a named fifo.  It would be much easier to use a pipe."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1564589363, "post_id": 57294675, "comment_id": 101084167, "body": "The file stream functions are required to be thread-safe \u2014 the three threads can share the same file stream as long as the message is written with a single I/O function \u2014 or you can use <code>flockfile()</code> and <code>funlockfile()</code> if need so be."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1564590025, "post_id": 57294675, "comment_id": 101084517, "body": "@JonathanLeffler Or just use <code>write()</code>, as write operations less than <code>PIPE_BUF</code> bytes will be atomic.  There&#39;s no guarantee that <code>fputs()</code> will write the string with a single <code>write()</code> operation, so there no guarantee that <code>fgets()</code> on the read end will get a complete string as passed to <code>fputs()</code>."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1564590068, "post_id": 57294675, "comment_id": 101084535, "body": "Is this some kind of school assignment? It rarely makes sense to use a FIFO for parent/child comms. Normally you would use an unnamed pipe."}, {"owner": {"reputation": 5, "user_id": 8726802, "user_type": "registered", "profile_image": "https://graph.facebook.com/1637134533016144/picture?type=large", "display_name": "suchmitch", "link": "https://stackoverflow.com/users/8726802/suchmitch"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1564592239, "post_id": 57294675, "comment_id": 101085557, "body": "@n.m. it indeed is a school assignment for which it&#39;s obligatory to use FIFO in combination with fork"}], "answers": [{"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1564589040, "post_id": 57294780, "comment_id": 101083990, "body": "If you &#39;open the FIFO for reading&#39; before forking, the <code>open()</code> will block until there&#39;s a writer (and there won&#39;t be a writer, so the program will stop).  If the program creates the FIFO, forks, opens the FIFO (for reading, for writing), does the reading/writing, closes the FIFO \u2014 that&#39;s a more plausible sequence."}], "tags": [], "owner": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "is_accepted": false, "score": 1, "last_activity_date": 1564589529, "last_edit_date": 1564589529, "creation_date": 1564588609, "answer_id": 57294780, "question_id": 57294675, "link": "https://stackoverflow.com/questions/57294675/c-fifo-crashes-when-writer-goes-faster-than-reader/57294780#57294780", "title": "C FIFO crashes when writer goes faster than reader", "body": "<p>Signal 13 is SIGPIPE. This happens because nobody is reading from the FIFO.</p>\n\n<p>You cannot write to a FIFO if there is no process that currently has that FIFO open for reading. If you try to do this, your process will get SIGPIPE (which can be ignored, which turns it into EPIPE... but either way, it fails).</p>\n\n<p>One way to handle this correctly:</p>\n\n<ol>\n<li><p>Create the FIFO in the parent.</p></li>\n<li><p>Fork.</p>\n\n<ul>\n<li><p>In the writer process, open it for writing. This will block until the reader has opened it. Keep it open.</p></li>\n<li><p>In the reader process, open it for writing. This will block until the writer has opened it. Keep it open.</p></li>\n</ul></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": true, "score": 1, "last_activity_date": 1564602852, "last_edit_date": 1564602852, "creation_date": 1564595998, "answer_id": 57296552, "question_id": 57294675, "link": "https://stackoverflow.com/questions/57294675/c-fifo-crashes-when-writer-goes-faster-than-reader/57296552#57296552", "title": "C FIFO crashes when writer goes faster than reader", "body": "<blockquote>\n  <p>When the writer writes faster to the FIFO pipe than the reader can read, I get an exit error with the following message: \"Terminated due to signal 13\".</p>\n</blockquote>\n\n<p>You have mischaracterized the nature of the problem.  As your other answer already observes, signal 13 is <code>SIGPIPE</code>, which is delivered if you try to write to a pipe that has no readers.</p>\n\n<p>There is normally some (limited) protection against entering that situation with FIFOs, in that opening one end of a FIFO blocks until the other end is opened as well. Therefore if a process opens a FIFO successfully, it knows that there is initially another process with the other end open.  The one with the write end open can then expect a high likelihood of writing successfully (but not necessarily without blocking).  As soon as the last reader closes the FIFO, however, further attempts to write to it will cause a <code>SIGPIPE</code> to be delivered to the writer.  Of course, if the same or a new reader opens the FIFO, that permits writing to resume -- something that's possible with a FIFO, but not with an ordinary pipe.</p>\n\n<p>So the problem is not that the reader does not keep up, but rather that it keeps opening and closing the FIFO.  This creates a race condition, in that there are multiple intervals in which the writer will elicit a <code>SIGPIPE</code> if it tries to write.  Since the writer <em>also</em> repeatedly opens and closes the FIFO, it follows that to receive a <code>SIGPIPE</code>, the writer must reopen the FIFO before the reader closes it after a previous message, but that doesn't mean the writer is outpacing the reader.  The reader cannot finish reading a given message before the writer finishes writing it, so their behaviors are staggered.  The writer does nothing else between closing the FIFO and reopening it, so it is not surprising that it sometimes reopens before the reader closes.</p>\n\n<p>The solution is simple: have each process keep the pipe open continuously until it is done communicating with the other.  There is no upside to opening and closing for each message, but plenty of downside.  For your particular use, however, it may be beneficial to put the writer's stream in line-buffered mode (<a href=\"https://linux.die.net/man/3/setvbuf\" rel=\"nofollow noreferrer\"><code>setvbuf()</code></a>; default will be fully-buffered).</p>\n"}], "owner": {"reputation": 5, "user_id": 8726802, "user_type": "registered", "profile_image": "https://graph.facebook.com/1637134533016144/picture?type=large", "display_name": "suchmitch", "link": "https://stackoverflow.com/users/8726802/suchmitch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 171, "favorite_count": 0, "accepted_answer_id": 57296552, "answer_count": 2, "score": -1, "last_activity_date": 1564602852, "creation_date": 1564588276, "question_id": 57294675, "link": "https://stackoverflow.com/questions/57294675/c-fifo-crashes-when-writer-goes-faster-than-reader", "title": "C FIFO crashes when writer goes faster than reader", "body": "<p>I have a parent and child process using fork who communicate using a FIFO pipe. The program will sometimes work and other times it will crash when the writer process (parent) goes faster than the reader process (child). </p>\n\n<p>The following code is what I currently have.</p>\n\n<pre><code>void writeprocess(char* text);\nvoid readprocess(void);\n\n#define FIFO_NAME     \"MYTESTFIFO\"\n#define MAX         200\n\nint main(int argc, const char * argv[]) {\n    pid_t pid;\n    pid = fork();\n\n    if(pid==0){\n        printf(\"Started child process.\\n\");\n        mkfifo(FIFO_NAME, 0666);\n        readprocess();\n        printf(\"Child process finished.\\n\");\n         exit(EXIT_SUCCESS);\n    }\n    else{\n        printf(\"Started parent process.\\n\");\n        mkfifo(FIFO_NAME, 0666);\n\n        writeprocess(\"Message 1\");\n        writeprocess(\"Message 2\");\n        writeprocess(\"Message 3\");\n        writeprocess(\"Message 4\");\n        writeprocess(\"terminate\");\n\n        printf(\"Waiting for child process to finish.\\n\");\n        int returnStatus;\n        waitpid(pid, &amp;returnStatus, 0);\n        printf(\"Parent process also finished.\\n\");\n        exit(EXIT_SUCCESS);\n    }\n}\n\nvoid writeprocess(char* text){\n    FILE *fp;\n    char *send_buf;\n\n    fp = fopen(FIFO_NAME, \"w\");\n    asprintf( &amp;send_buf, \"%s\\n\", text);\n    if ( fputs( send_buf, fp ) == EOF )\n    {\n        fprintf( stderr, \"Error writing data to fifo\\n\");\n        exit( EXIT_FAILURE );\n    }\n    printf(\"Message send: %s\", send_buf);\n    free( send_buf );\n\n    fclose(fp);\n}\n\nvoid readprocess(){\n    sleep(1);\n    FILE *fp;\n    char *str_result = NULL;\n    char recv_buf[MAX];\n\n    int stringdifference = 1;\n\n    while (stringdifference)\n    {\n        fp = fopen(FIFO_NAME, \"r\");\n        str_result = fgets(recv_buf, MAX, fp);\n        if ( str_result != NULL )\n        {\n            printf(\"Message received: %s\", recv_buf);\n        }\n        fclose( fp );\n\n        stringdifference = strncmp(str_result, \"terminate\", 9);\n    }\n}\n</code></pre>\n\n<p>When the writer writes faster to the FIFO pipe than the reader can read, I get an exit error with the following message: \"Terminated due to signal 13\". How can I avoid this from happening while keeping my program run at full performance?</p>\n\n<p>I do want the parent process to be able to end the process and I have to keep working using a FIFO pipe.</p>\n"}, {"tags": ["c", "file-handling"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 7, "creation_date": 1564586986, "post_id": 57294065, "comment_id": 101082849, "body": "The <code>&quot;a+&quot;</code> mode to <code>fopen()</code> means &quot;all writes append at the end of file&quot;, regardless of the current position in the file before writing.  If you don&#39;t want everything appended, don&#39;t use <code>a</code>; use <code>&quot;r+&quot;</code> or <code>&quot;w+&quot;</code> mode instead.  Even if you use <code>&quot;r+&quot;</code> or <code>&quot;w+&quot;</code> mode, you won&#39;t be able to insert data before what&#39;s already in the file; all you can do is overwrite what&#39;s already there."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1564587347, "post_id": 57294065, "comment_id": 101083061, "body": "Even if you use <code>&quot;r+&quot;</code> or <code>&quot;w+&quot;</code> mode, you won&#39;t be able to insert data before what&#39;s already in the file; all you can do is overwrite what&#39;s already there.  See <a href=\"https://stackoverflow.com/questions/10467711\">Inserting data into the middle of a file</a> or <a href=\"https://stackoverflow.com/questions/50996698\">Delete data from the middle of a file</a> for more information."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 7, "creation_date": 1564587557, "post_id": 57294065, "comment_id": 101083183, "body": "Off-topic, but functions such as <code>fopen_s()</code> are not really any safer than the standard functions such as <code>fopen()</code>, and the <code>*_s()</code> functions are, as implemented by Microsoft, non-standard and non-portable."}, {"owner": {"reputation": 2385, "user_id": 10306503, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31c5d6c9b08dd045f4876591d703bda6?s=128&d=identicon&r=PG", "display_name": "mosvy", "link": "https://stackoverflow.com/users/10306503/mosvy"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1564587624, "post_id": 57294065, "comment_id": 101083218, "body": "@JonathanLeffler the <code>r+</code> mode will not create the file if it doesn&#39;t already exists; the <code>w+</code> mode will truncate it if it already exists. Both sucks -- no way to <code>open(O_RDWR|O_CREAT)</code> via <code>fopen()</code>."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 2385, "user_id": 10306503, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31c5d6c9b08dd045f4876591d703bda6?s=128&d=identicon&r=PG", "display_name": "mosvy", "link": "https://stackoverflow.com/users/10306503/mosvy"}, "edited": false, "score": 0, "creation_date": 1564587812, "post_id": 57294065, "comment_id": 101083329, "body": "@mosvy \u2014 there&#39;s not much I can do about that except note that POSIX provides <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/open.html\" rel=\"nofollow noreferrer\"><code>open()</code></a> and <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/fdopen.html\" rel=\"nofollow noreferrer\"><code>fdopen()</code></a> which give you as much control as you want (or, at least, as much control as you can have)."}, {"owner": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 2, "creation_date": 1564588118, "post_id": 57294065, "comment_id": 101083508, "body": "<code>printf(&quot;error:...</code> is (almost) always a bug.  It should be <code>fprintf(stderr, &quot;error:...</code>"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 3, "creation_date": 1564588914, "post_id": 57294065, "comment_id": 101083924, "body": "<code>printf(&quot;Pointing to %d&quot;, ftell(maspass));  &#47;&#47;prints 0 every time</code> is undefined behavior as <code>ftell()</code> returns <code>long int</code>, not <code>int</code>.  You need to use <code>%ld</code>."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1564591651, "post_id": 57294065, "comment_id": 101085299, "body": "Perhaps <code>fopen</code> with mode <code>&quot;a&quot;</code> or <code>&quot;a+&quot;</code> and then <code>freopen</code> with mode <code>&quot;r+&quot;</code>."}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 0, "creation_date": 1564666498, "post_id": 57294065, "comment_id": 101112764, "body": "Questions seeking debugging help (&quot;why isn&#39;t this code working?&quot;) must include the desired behavior, a specific problem or error and the shortest code necessary to reproduce it in the question itself. Questions without a clear problem statement are not useful to other readers. See: <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 13306, "user_id": 162698, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HnjBG.png?s=128&g=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/162698/rob"}, "edited": false, "score": 0, "creation_date": 1565093368, "post_id": 57294065, "comment_id": 101235891, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/32366665/resetting-pointer-to-the-start-of-file\">Resetting pointer to the start of file</a>"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1565105453, "post_id": 57294065, "comment_id": 101243380, "body": "It&#39;s still not clear what you expect the code to do.  What exactly is your input, expected output, and actual output?"}], "answers": [{"comments": [{"owner": {"reputation": 4113, "user_id": 10305477, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/--qRrIlzhZP8/AAAAAAAAAAI/AAAAAAAAAbg/OMHxlGTcZp4/photo.jpg?sz=128", "display_name": "Chase", "link": "https://stackoverflow.com/users/10305477/chase"}, "edited": false, "score": 0, "creation_date": 1564633264, "post_id": 57295850, "comment_id": 101096768, "body": "Already tried, won&#39;t let me write stuff at the very first of the file. whereas at the very least &quot;a+&quot; or &quot;a&quot; writes the stuff, just at the end, &quot;r+&quot; doesn&#39;t write anything at all. Even though I checked that the loop is working in debug. The file still doesn&#39;t get any prints."}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "reply_to_user": {"reputation": 4113, "user_id": 10305477, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/--qRrIlzhZP8/AAAAAAAAAAI/AAAAAAAAAbg/OMHxlGTcZp4/photo.jpg?sz=128", "display_name": "Chase", "link": "https://stackoverflow.com/users/10305477/chase"}, "edited": false, "score": 0, "creation_date": 1564666424, "post_id": 57295850, "comment_id": 101112717, "body": "@Chase You need to use the <code>%ld</code> format specifier in <code>printf</code> because <code>ftell</code> returns a <code>long</code>. Change that and try again with <code>&quot;r+&quot;</code>."}, {"owner": {"reputation": 4113, "user_id": 10305477, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/--qRrIlzhZP8/AAAAAAAAAAI/AAAAAAAAAbg/OMHxlGTcZp4/photo.jpg?sz=128", "display_name": "Chase", "link": "https://stackoverflow.com/users/10305477/chase"}, "edited": false, "score": 0, "creation_date": 1564757560, "post_id": 57295850, "comment_id": 101147853, "body": "Done, same result :/"}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "reply_to_user": {"reputation": 4113, "user_id": 10305477, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/--qRrIlzhZP8/AAAAAAAAAAI/AAAAAAAAAbg/OMHxlGTcZp4/photo.jpg?sz=128", "display_name": "Chase", "link": "https://stackoverflow.com/users/10305477/chase"}, "edited": false, "score": 0, "creation_date": 1564845070, "post_id": 57295850, "comment_id": 101167534, "body": "@Chase Can you try this using <code>fopen</code>? I don&#39;t have Annex K available."}, {"owner": {"reputation": 4113, "user_id": 10305477, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/--qRrIlzhZP8/AAAAAAAAAAI/AAAAAAAAAbg/OMHxlGTcZp4/photo.jpg?sz=128", "display_name": "Chase", "link": "https://stackoverflow.com/users/10305477/chase"}, "edited": false, "score": 0, "creation_date": 1564902016, "post_id": 57295850, "comment_id": 101177087, "body": "Tried that as well, same result again. Is there any way to achieve this through command line arguments?"}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "reply_to_user": {"reputation": 4113, "user_id": 10305477, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/--qRrIlzhZP8/AAAAAAAAAAI/AAAAAAAAAbg/OMHxlGTcZp4/photo.jpg?sz=128", "display_name": "Chase", "link": "https://stackoverflow.com/users/10305477/chase"}, "edited": false, "score": 0, "creation_date": 1564931954, "post_id": 57295850, "comment_id": 101183255, "body": "@Chase No. Can you supply the full program and the contents of the file?"}, {"owner": {"reputation": 4113, "user_id": 10305477, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/--qRrIlzhZP8/AAAAAAAAAAI/AAAAAAAAAbg/OMHxlGTcZp4/photo.jpg?sz=128", "display_name": "Chase", "link": "https://stackoverflow.com/users/10305477/chase"}, "edited": false, "score": 0, "creation_date": 1565093150, "post_id": 57295850, "comment_id": 101235769, "body": "Sorry for the response but I added the 2 primary functions, can you tell me what&#39;s wrong now? @JL2210"}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "reply_to_user": {"reputation": 4113, "user_id": 10305477, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/--qRrIlzhZP8/AAAAAAAAAAI/AAAAAAAAAbg/OMHxlGTcZp4/photo.jpg?sz=128", "display_name": "Chase", "link": "https://stackoverflow.com/users/10305477/chase"}, "edited": false, "score": 0, "creation_date": 1565097825, "post_id": 57295850, "comment_id": 101238608, "body": "@Chase Can you possibly just create a <code>main</code> wrapper around the <code>master_globalprint</code> function and some file data that I can test? Right now, this question lacks a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 4113, "user_id": 10305477, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/--qRrIlzhZP8/AAAAAAAAAAI/AAAAAAAAAbg/OMHxlGTcZp4/photo.jpg?sz=128", "display_name": "Chase", "link": "https://stackoverflow.com/users/10305477/chase"}, "edited": false, "score": 0, "creation_date": 1565104626, "post_id": 57295850, "comment_id": 101242931, "body": "Ok, I edited it once again, think this&#39;ll do? @JL2210"}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "reply_to_user": {"reputation": 4113, "user_id": 10305477, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/--qRrIlzhZP8/AAAAAAAAAAI/AAAAAAAAAbg/OMHxlGTcZp4/photo.jpg?sz=128", "display_name": "Chase", "link": "https://stackoverflow.com/users/10305477/chase"}, "edited": false, "score": 0, "creation_date": 1565105485, "post_id": 57295850, "comment_id": 101243404, "body": "@Chase I suppose. If not then you&#39;ll need to make the example smaller and more compact (remove stuff until the issue goes away then add it back)."}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "reply_to_user": {"reputation": 4113, "user_id": 10305477, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/--qRrIlzhZP8/AAAAAAAAAAI/AAAAAAAAAbg/OMHxlGTcZp4/photo.jpg?sz=128", "display_name": "Chase", "link": "https://stackoverflow.com/users/10305477/chase"}, "edited": false, "score": 0, "creation_date": 1565106386, "post_id": 57295850, "comment_id": 101243964, "body": "@Chase The stuff in comments is what you should pay attention to here."}], "tags": [], "owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "is_accepted": false, "score": 1, "last_activity_date": 1565106359, "last_edit_date": 1565106359, "creation_date": 1564592737, "answer_id": 57295850, "question_id": 57294065, "link": "https://stackoverflow.com/questions/57294065/how-do-i-make-the-file-pointer-point-at-the-very-start-of-the-file/57295850#57295850", "title": "How do I make the file pointer point at the very start of the file?", "body": "<p>Here the writing mode should be <code>w+</code>:</p>\n\n<pre><code>err = fopen_s(&amp;maspass, \"Master_Password.txt\", \"a\" /* w+ */);\n</code></pre>\n\n<p>Here you should close the file and then remove it:</p>\n\n<pre><code>if (count == 0)\n{\n    /*fclose_s(maspass);*/\n    remove(\"Master_Password.txt\");\n    printf(\"Master Password cannot be empty\");\n    exit(0);\n}\n</code></pre>\n\n<p>Instead of doing this, you should keep the file descriptor open and pass it to <code>master_globalprint</code>:</p>\n\n<pre><code>fclose(maspass);\nmaster_globalprint(count);\n/* master_globalprint(count, maspass);\n * fclose(maspass); */\n</code></pre>\n\n<p>Then keep reusing the open file descriptor.</p>\n"}], "owner": {"reputation": 4113, "user_id": 10305477, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/--qRrIlzhZP8/AAAAAAAAAAI/AAAAAAAAAbg/OMHxlGTcZp4/photo.jpg?sz=128", "display_name": "Chase", "link": "https://stackoverflow.com/users/10305477/chase"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1565106359, "creation_date": 1564586299, "last_edit_date": 1565104590, "question_id": 57294065, "link": "https://stackoverflow.com/questions/57294065/how-do-i-make-the-file-pointer-point-at-the-very-start-of-the-file", "title": "How do I make the file pointer point at the very start of the file?", "body": "<p>I'm having trouble setting the file pointer to the very start of a file to write some stuff at first AFTER having already written some text in it.</p>\n\n<p>I've tried rewind(), fseek(), opening the file in \"r+\" &amp; \"a+\" modes, nothing seems to work.</p>\n\n<p>Here's a small recreation of the program:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n\nvoid master_globalprint(int lim)\n{\n    int i = 0;\n    FILE* maspass;\n    errno_t err;\n    err = fopen_s(&amp;maspass, \"Master_Password.txt\", \"r+\");\n    if (err != 0)\n    {\n        printf(\"Error opening Master_Password.txt\");\n        exit(0);\n    }\n    rewind(maspass);\n    printf(\"Pointing to %ld\", ftell(maspass));\n    while (i &lt; lim)\n    {\n        fprintf(maspass, \"%d\", i);          //Writing the array infront of the encrypted code\n        i++;\n    }\n    fclose(maspass);\n}\n\nvoid master_create()                                //To Create a Master Password\n{\n    int count = 0;\n    char pass;\n    FILE* maspass;\n    errno_t err;\n    err = fopen_s(&amp;maspass, \"Master_Password.txt\", \"a\");\n    if (err != 0)\n    {\n        printf(\"Error creating Master_Password.txt\");\n        exit(0);\n    }\n    printf(\" Enter Master Password : \");\n    while ((pass = getchar()) != EOF &amp;&amp; pass != '\\n')\n    {\n        count++;\n        fprintf(maspass, \"%c\", pass);                       //The characters are then printed one by one\n    }\n    if (count == 0)\n    {\n        remove(\"Master_Password.txt\");\n        printf(\"Master Password cannot be empty\");\n        exit(0);\n    }\n    fprintf(maspass, \"%c\", (count + 33));               //To put the amount of letters into file, forwarded by 33 to reach a certain ASCII threshold and converted to char\n    fprintf(maspass, \"\\n\");\n    fclose(maspass);\n    master_globalprint(count);\n}\n\nvoid main()\n{\n    master_create();\n}\n</code></pre>\n\n<p>The above functions work and print the correct values except the master_globalprint function starts printing exactly where the last function left off.</p>\n\n<p>Is it because I've to use command line arguments to achieve the task? If so, can I set the command line arguments to be executed by default somehow so that if the code is distributed, the user won't have to bother?</p>\n\n<p>EDIT : Added in a reproducible code sample. When I put \"a\" in line 31, it prints only the stuff I input and not the numbers in master_globalprint(). If I put \"w\", it ONLY prints the numbers in master_globalprint() and not the stuff I input.</p>\n"}, {"tags": ["c", "visual-studio-code", "macros", "intellisense"], "comments": [{"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1564606322, "post_id": 57293252, "comment_id": 101091289, "body": "the preprocesser step of the compilation does this.  so you could simply only run the preprocesser step"}, {"owner": {"reputation": 565, "user_id": 3412158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73164b39342aff045b6293ae30541e3f?s=128&d=identicon&r=PG&f=1", "display_name": "Aris Koning", "link": "https://stackoverflow.com/users/3412158/aris-koning"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1564670141, "post_id": 57293252, "comment_id": 101115102, "body": "Nope, that will preprocess every macro. I only want to expend one macro and let additional nested macro&#39;s in this one alone. Furthermore using the gcc preprocessor&#39;s output is also a lot of work: first call gcc -E ... capture the output. Clean up the line stuff and remove potential duplicate defines etc and finally you have to temporarily replace the current source file with the cleaned preprocessed output."}], "owner": {"reputation": 565, "user_id": 3412158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73164b39342aff045b6293ae30541e3f?s=128&d=identicon&r=PG&f=1", "display_name": "Aris Koning", "link": "https://stackoverflow.com/users/3412158/aris-koning"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1090, "favorite_count": 0, "answer_count": 0, "score": 4, "last_activity_date": 1564670336, "creation_date": 1564583671, "last_edit_date": 1564670336, "question_id": 57293252, "link": "https://stackoverflow.com/questions/57293252/is-there-a-way-to-do-in-place-c-macro-expansion-in-vs-code", "title": "Is there a way to do in-place C macro expansion in VS code?", "body": "<p>I am using Visual Studio Code 1.34 and ms-vscode.cpptools 0.24.1. In a C file, when I hover over a statement containing a C macro, VS Code is kind enough to expand the macro in a hover box.</p>\n\n<p>I can select this expanded piece of code and then manually replace the macro's 'call' side with it. But I was wondering if there is a way in vscode or in one of its extensions to do this macro expansion in-place, e.g. using some key shortcut.  From what I have read from the documentation, I think you cannot do this with ms-vscode.cpptools alone.</p>\n\n<p>It would be a nice bonus if back-slash line breaks were substituted with actual new lines in the in-place expension.</p>\n"}, {"tags": ["c", "arrays", "string", "for-loop", "char"], "comments": [{"owner": {"reputation": 2799, "user_id": 1485311, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/sNWZV.jpg?s=128&g=1", "display_name": "ChatterOne", "link": "https://stackoverflow.com/users/1485311/chatterone"}, "edited": false, "score": 0, "creation_date": 1564584172, "post_id": 57293199, "comment_id": 101081145, "body": "<code>r</code> is a consonant, so if you have the word <code>turreteer</code> it will not be printed because you&#39;ll count 3 <code>r</code>, 4 vowels and 2 consonants"}], "answers": [{"tags": [], "owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "is_accepted": false, "score": 2, "last_activity_date": 1564584147, "last_edit_date": 1564584147, "creation_date": 1564583806, "answer_id": 57293289, "question_id": 57293199, "link": "https://stackoverflow.com/questions/57293199/how-to-print-strings-that-have-more-consonants-than-vowels/57293289#57293289", "title": "How to print strings that have more consonants than vowels?", "body": "<p>You need to reset the counters after processing each string.</p>\n\n<p>And don't use <code>gets</code> use <code>fgets</code> instead.</p>\n\n<pre><code>for(i=0;i&lt;20;i++){\n    for(j=0;j&lt;50;j++){\n\n        if(string[i][j] == 'r'){\n            repeated_r++;\n        }\n        else if(string[i][j] == 'a' || string[i][j] == 'e' || string[i][j] == 'i' || string[i][j] == 'o' || string[i][j] == 'u'){\n            vowels++;\n        }\n        else{\n            consonants++;\n        }\n\n    }\n    if(consonants&gt;vowels &amp;&amp; repeated_r&gt;3){\n\n        fflush(stdin);\n        puts(string[i]);\n    }\n\n   //Reset the counters\n    consonants =0;\n    vowels =0;\n    repeated_r =0;\n  }\n }\n</code></pre>\n\n<p>Also note that in your current code <code>r</code> is not considered as consonant.</p>\n"}, {"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": true, "score": 1, "last_activity_date": 1564585762, "last_edit_date": 1564585762, "creation_date": 1564584992, "answer_id": 57293676, "question_id": 57293199, "link": "https://stackoverflow.com/questions/57293199/how-to-print-strings-that-have-more-consonants-than-vowels/57293676#57293676", "title": "How to print strings that have more consonants than vowels?", "body": "<p>You are not resetting the initial values of the variables in the outer loop</p>\n\n<pre><code>int vowels=0;\nint consonants=0;\nint repeated_r=0;\n</code></pre>\n\n<p>Also the condition in the inner loop</p>\n\n<pre><code>for(j=0;j&lt;50;j++){\n        ^^^^\n</code></pre>\n\n<p>is not correct because in this case there is an access to memory beyond stored strings in the array.</p>\n\n<p>The letter <code>'r'</code> is not counted as a consonant.</p>\n\n<p>Take into account that the function <code>gets</code> is not a standard C function that is it is not supported by the C Standard any more.</p>\n\n<p>And this call</p>\n\n<pre><code>fflush(stdin);\n</code></pre>\n\n<p>has undefined behavior.</p>\n\n<p>I can suggest the following solution as shown in the demonstrative program below.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main( void ) \n{\n    enum { M = 3, N = 50 };\n    char s[M][N];\n\n    for ( size_t i = 0; i &lt; M; i++ )\n    {\n        fgets( s[i], N, stdin );\n        s[i][strcspn( s[i], \"\\n\" )] = '\\0';\n    }\n\n    const char *vowels = \"aeiou\";\n    const char r = 'r';\n\n    for ( size_t i = 0; i &lt; M; i++ )\n    {\n        size_t repeated_r = 0;\n        size_t vowels_count = 0;\n        size_t n = strlen( s[i] );\n\n        for ( size_t j = 0; j &lt; n; j++ )\n        {\n            repeated_r += s[i][j] == r;\n            vowels_count += strchr( vowels, s[i][j] ) != NULL;\n        }\n\n        if ( repeated_r &gt;= 3 &amp;&amp; vowels_count &lt; n - vowels_count )\n        {\n            puts( s[i] );\n        }\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>If to enter the following strings</p>\n\n<pre><code>    Hello World\n    errors\n    photosynthesis_bro\n</code></pre>\n\n<p>then the program output might look like</p>\n\n<pre><code>errors\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 47, "user_id": 9908657, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a63b65be69104bc0e42a9988c610e2d?s=128&d=identicon&r=PG&f=1", "display_name": "Shreya Birthare", "link": "https://stackoverflow.com/users/9908657/shreya-birthare"}, "is_accepted": false, "score": 0, "last_activity_date": 1564592951, "creation_date": 1564592951, "answer_id": 57295897, "question_id": 57293199, "link": "https://stackoverflow.com/questions/57293199/how-to-print-strings-that-have-more-consonants-than-vowels/57295897#57295897", "title": "How to print strings that have more consonants than vowels?", "body": "<p>there is one more problem in your code, ypu're using gets. It'll also include white spaces so say if your string is \"_ _ <em>rrrbaeeeeiou</em> _ <em>\". It will print this string but actually this string should not have been printed.\nNote that \"</em>\" means a blank space.\nAccording to your code, \"_\" will be counted in consonants and even though there are 4 consonants in your string(3 r and 1 b) and 8 vowels, it will print this string as output since the blank spaces will be counted as consonants.\nAlso in your code r is not counted as consonant</p>\n"}], "owner": {"reputation": 67, "user_id": 10951636, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eJMBd.jpg?s=128&g=1", "display_name": "photosynthesis_bro", "link": "https://stackoverflow.com/users/10951636/photosynthesis-bro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 57293676, "answer_count": 3, "score": 1, "last_activity_date": 1564592951, "creation_date": 1564583505, "last_edit_date": 1564585590, "question_id": 57293199, "link": "https://stackoverflow.com/questions/57293199/how-to-print-strings-that-have-more-consonants-than-vowels", "title": "How to print strings that have more consonants than vowels?", "body": "<p>Enter the array of 20 strings. Make program that prints out strings which have more consonants than vowels and in which letter 'r' is repeated at least 3 times.</p>\n\n<p>I belive that the problem is in my if loops, but somehow i fail to understand why it does not work properly. It prints every string I enter.</p>\n\n<p>This is the code i wrote:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt; \n#include &lt;string.h&gt;\n\n\n    int main(void) {\n\n    char string[20][50];\n    int i, j;\n    int vowels=0;\n    int consonants=0;\n    int repeated_r=0;\n\n    printf(\"Enter the array of 20 strings:\\n\");\n\n    for(i=0;i&lt;20;i++){\n        gets(string[i]);\n        }\n\n    for(i=0;i&lt;20;i++){\n        for(j=0;j&lt;50;j++){\n\n            if(string[i][j] == 'r'){\n                repeated_r++;\n            }\n            else if(string[i][j] == 'a' || string[i][j] == 'e' || string[i][j] == 'i' || string[i][j] == 'o' || string[i][j] == 'u'){\n                vowels++;\n            }\n            else{\n                consonants++;\n            }\n\n        }\n        if(consonants&gt;vowels &amp;&amp; repeated_r&gt;=3){\n\n            fflush(stdin);\n            puts(string[i]);\n        }\n    }\n\n\n    return 0;\n}    \n\n</code></pre>\n"}, {"tags": ["c", "codeblocks"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 5, "creation_date": 1564582491, "post_id": 57292854, "comment_id": 101080030, "body": "<code>scanf(&quot;%d&quot;,&amp;a);</code> Also get an up-to-date C book. Looks like you are using K&amp;R or some other <i>old</i> book."}, {"owner": {"reputation": 1, "user_id": 11863945, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/679df848ce6770db30ff8f0ae678cc2f?s=128&d=identicon&r=PG&f=1", "display_name": "Kushal", "link": "https://stackoverflow.com/users/11863945/kushal"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1564582818, "post_id": 57292854, "comment_id": 101080245, "body": "wow, that was quick, thanks. that was a stupid error. I was not referring to any book, just freewheeling."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1564583128, "post_id": 57292854, "comment_id": 101080450, "body": "A free-wheeler should know that the correct definition is <code>int main(void)</code>"}], "answers": [{"tags": [], "owner": {"reputation": 43, "user_id": 11749606, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-xJFAaX1vwVw/AAAAAAAAAAI/AAAAAAAAAkI/S36GnRWWBT0/photo.jpg?sz=128", "display_name": "Akshay Waghmare", "link": "https://stackoverflow.com/users/11749606/akshay-waghmare"}, "is_accepted": false, "score": 0, "last_activity_date": 1564586141, "last_edit_date": 1564586141, "creation_date": 1564583240, "answer_id": 57293121, "question_id": 57292854, "link": "https://stackoverflow.com/questions/57292854/my-c-program-for-factorial-is-not-giving-any-value-in-the-output-box-though-it-s/57293121#57293121", "title": "my c program for factorial is not giving any value in the output box though it shows no errors", "body": "<p>You'll have to pass address of variable a like this..\n<code>scanf(\"%d\", &amp;a);</code></p>\n"}], "owner": {"reputation": 1, "user_id": 11863945, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/679df848ce6770db30ff8f0ae678cc2f?s=128&d=identicon&r=PG&f=1", "display_name": "Kushal", "link": "https://stackoverflow.com/users/11863945/kushal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "closed_date": 1564587609, "answer_count": 1, "score": -2, "last_activity_date": 1564586141, "creation_date": 1564582389, "last_edit_date": 1564582432, "question_id": 57292854, "link": "https://stackoverflow.com/questions/57292854/my-c-program-for-factorial-is-not-giving-any-value-in-the-output-box-though-it-s", "closed_reason": "Duplicate", "title": "my c program for factorial is not giving any value in the output box though it shows no errors", "body": "<p><strong>c program</strong>   </p>\n\n<p><em>my c program for factorial is not giving any value in the output box though it shows no errors</em></p>\n\n<pre><code> #include&lt;stdio.h&gt;\n    main()\n    {\n        int a,n,t=1;\n        printf(\"enter the number\\n\");\n        scanf(\"%d\",a);\n        for(n=1;n&lt;=a;n++)\n        {\n            t*=n;\n        }\n        printf(\"the factorial is %d\",t);\n    }\n</code></pre>\n\n<p><img src=\"https://i.stack.imgur.com/2TidB.png\" alt=\"the image\"></p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 32882, "user_id": 1870760, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/NAAkp.png?s=128&g=1", "display_name": "Hatted Rooster", "link": "https://stackoverflow.com/users/1870760/hatted-rooster"}, "edited": false, "score": 0, "creation_date": 1564580088, "post_id": 57292046, "comment_id": 101078395, "body": "<code>1024</code> is an integer literal. <code>1024L</code> is a long integer literal, you&#39;ll find you need to add the <code>L</code> if you have integer literals bigger than what a normal integer is able to hold."}, {"owner": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "edited": false, "score": 0, "creation_date": 1564580142, "post_id": 57292046, "comment_id": 101078425, "body": "It changes the type of the literal value. <code>1024</code> is an <code>int</code>, <code>1024</code> is a <code>long int</code>. The effect is the same because assigning an <code>int</code> to a <code>long</code> follows integer promotion rules."}, {"owner": {"reputation": 56, "user_id": 8603925, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e440efa45c0204ba22ebd7504f427488?s=128&d=identicon&r=PG&f=1", "display_name": "Giorgi Anakidze", "link": "https://stackoverflow.com/users/8603925/giorgi-anakidze"}, "edited": false, "score": 0, "creation_date": 1564580374, "post_id": 57292046, "comment_id": 101078563, "body": "Thanks guys, but why when I use long x while assigning it&#39;s still int, if so?"}], "answers": [{"tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": true, "score": 1, "last_activity_date": 1564581473, "creation_date": 1564581473, "answer_id": 57292542, "question_id": 57292046, "link": "https://stackoverflow.com/questions/57292046/whats-the-difference-between-1024-and-1024l-while-assigning-variable/57292542#57292542", "title": "What&#39;s the difference between 1024 and 1024L while assigning variable?", "body": "<p>In C source code, <code>1024</code> is an <code>int</code>, and <code>1024L</code> is a <code>long int</code>. During an assignment, the value on the right is converted to the type of the left operand. As long as the rules about which combinations of operands are obeyed and the value on the right is in the range of the left operand, there is no difference\u2014the value remains unchanged.</p>\n\n<p>In general, a decimal constant without a suffix is an <code>int</code>, and a decimal constant with an <code>L</code> is a <code>long int</code>. However, if its value is too big to be represented in the usual type, it will automatically be the next larger type. For example, in a C implementation where the maximum <code>int</code> is 2147483647, the constant <code>3000000000</code> in source code will be a <code>long int</code> even though it has no suffix. (Note that this rule means the same constant in source code can have different types in different C implementations.) If a <code>long int</code> is not big enough, it will be <code>long long int</code>. If that is not big enough, it can be a signed extended integer type, if the implementation supports one.</p>\n\n<p>The rules above are for decimal constants. There are also hexadecimal constants (which begin with <code>0x</code> or <code>0X</code>) and octal constants (which begin with <code>0</code>\u2014<code>020</code> is octal for sixteen, unlike <code>20</code> which is decimal for twenty), which may have signed or unsigned types. The different integer types are important because overflow and conversions behave differently depending on type. It is easy to take integer operations as a matter of course and assume they work, but it important to learn the details to avoid problems.</p>\n"}], "owner": {"reputation": 56, "user_id": 8603925, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e440efa45c0204ba22ebd7504f427488?s=128&d=identicon&r=PG&f=1", "display_name": "Giorgi Anakidze", "link": "https://stackoverflow.com/users/8603925/giorgi-anakidze"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 331, "favorite_count": 0, "accepted_answer_id": 57292542, "answer_count": 1, "score": 0, "last_activity_date": 1564581473, "creation_date": 1564580000, "question_id": 57292046, "link": "https://stackoverflow.com/questions/57292046/whats-the-difference-between-1024-and-1024l-while-assigning-variable", "title": "What&#39;s the difference between 1024 and 1024L while assigning variable?", "body": "<p>What's the difference ? Both of them give same output while using printf(\"%ld\")</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>long x = 1024;\nlong y = 1024L;\n</code></pre>\n"}, {"tags": ["c", "kernel", "bpf", "ebpf"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1564579931, "post_id": 57291946, "comment_id": 101078276, "body": "Have you tried to <i>debug</i> your user-space program?"}, {"owner": {"reputation": 776, "user_id": 10187988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4b241724a6266b0419c754aec2ed261?s=128&d=identicon&r=PG&f=1", "display_name": "Maicake", "link": "https://stackoverflow.com/users/10187988/maicake"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1564583813, "post_id": 57291946, "comment_id": 101080889, "body": "I&#39;ve tried to put some printf and it enters in the first if so it terminates because of the return 1; statement. Also If printf(%s, bpf_log_buf) doesn&#39;t print anything."}], "answers": [{"comments": [{"owner": {"reputation": 776, "user_id": 10187988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4b241724a6266b0419c754aec2ed261?s=128&d=identicon&r=PG&f=1", "display_name": "Maicake", "link": "https://stackoverflow.com/users/10187988/maicake"}, "edited": false, "score": 0, "creation_date": 1564590718, "post_id": 57295143, "comment_id": 101084869, "body": "Thanks again!. 1) Does SEC() requires specific names? Because I&#39;ve tried to use a random name like SEC(&quot;mine&quot;) and it didn&#39;t work (mine_user mine_kern are the name of the files). Then I&#39;ve tried one that I&#39;ve seen in another example (e.g. SEC(&quot;socket1&quot;) and it worked fine 2) why the socket is opened in a non blocking way? could I open up a socket by myself without SOCK_NONBLOCK or is discouraged?"}, {"owner": {"reputation": 776, "user_id": 10187988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4b241724a6266b0419c754aec2ed261?s=128&d=identicon&r=PG&f=1", "display_name": "Maicake", "link": "https://stackoverflow.com/users/10187988/maicake"}, "edited": false, "score": 0, "creation_date": 1564591359, "post_id": 57295143, "comment_id": 101085161, "body": "tools/lib/bpf/libbpf.c I think section_names[] answers my first question."}, {"owner": {"reputation": 4454, "user_id": 3716552, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/078Ob.jpg?s=128&g=1", "display_name": "Qeole", "link": "https://stackoverflow.com/users/3716552/qeole"}, "reply_to_user": {"reputation": 776, "user_id": 10187988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4b241724a6266b0419c754aec2ed261?s=128&d=identicon&r=PG&f=1", "display_name": "Maicake", "link": "https://stackoverflow.com/users/10187988/maicake"}, "edited": false, "score": 1, "creation_date": 1564592608, "post_id": 57295143, "comment_id": 101085724, "body": "You didn&#39;t use libbpf in your case. You used <code>bpf_load.c</code>, and it requires a specific <i>prefix</i>, in your case: <code>socket</code>. See <a href=\"https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/samples/bpf/bpf_load.c?h=v5.2#n627\" rel=\"nofollow noreferrer\">the code</a>. For 2) that&#39;s simply the way that sample was coded, again see the code/<a href=\"https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/samples/bpf/bpf_load.c?id=03f4723ed7a52bd31da26eefe2cdde563ea0f468\" rel=\"nofollow noreferrer\">commit log</a>: The user app doesn&#39;t read the socket, just BPF maps. I don&#39;t see why opening a classic blocking socket should be discouraged."}, {"owner": {"reputation": 776, "user_id": 10187988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4b241724a6266b0419c754aec2ed261?s=128&d=identicon&r=PG&f=1", "display_name": "Maicake", "link": "https://stackoverflow.com/users/10187988/maicake"}, "edited": false, "score": 0, "creation_date": 1564647777, "post_id": 57295143, "comment_id": 101102342, "body": "ah I thought I was using libbpf because at <a href=\"https://github.com/torvalds/linux/tree/master/samples/bpf\" rel=\"nofollow noreferrer\">github.com/torvalds/linux/tree/master/samples/bpf</a>  the first sentence states &quot;The examples use libbpf from tools/lib/bpf.&quot;  So load_bpf_file is from bpf_load.c and bpf_prog_load from libbpf. Now I&#39; m more confused than before . When should I use one and when the other?"}, {"owner": {"reputation": 4454, "user_id": 3716552, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/078Ob.jpg?s=128&g=1", "display_name": "Qeole", "link": "https://stackoverflow.com/users/3716552/qeole"}, "reply_to_user": {"reputation": 776, "user_id": 10187988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4b241724a6266b0419c754aec2ed261?s=128&d=identicon&r=PG&f=1", "display_name": "Maicake", "link": "https://stackoverflow.com/users/10187988/maicake"}, "edited": false, "score": 1, "creation_date": 1564648341, "post_id": 57295143, "comment_id": 101102606, "body": "Most content of <code>bpf_load.c</code> predates libbpf. This lead to a situation where BPF programs use a variety of loaders. Today, most have moved to libbpf, and this should be the reference for handling BPF object files and programs. Some samples still use <code>bpf_load.c</code> (and that file might even include some stuff from libbpf itself, I don&#39;t remember). Feel free to experiment with this loader, but if you build a serious project, definitely go for libbpf (and build your programs out of the kernel tree, it may make your life easier)."}, {"owner": {"reputation": 776, "user_id": 10187988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4b241724a6266b0419c754aec2ed261?s=128&d=identicon&r=PG&f=1", "display_name": "Maicake", "link": "https://stackoverflow.com/users/10187988/maicake"}, "edited": false, "score": 0, "creation_date": 1564651591, "post_id": 57295143, "comment_id": 101104379, "body": "Till now the only way I could build a program out of the kernel tree was using BCC. I need to understand well which are all the ways to write, compile and execute an eBPF program: 1) Inside kernel tree I can load it using bpf_load or libbpf or bpftool. CONS: too much dependencies on the kernel tree.  2) Outside kernel tree: BCC, backend C, fontend python   3) Outside kernel tree: write in C (which headers do I need?), compile with clang, load with tools/library. But how can I use libbpf and bpftool outside of the kernel tree if they are build inside?"}, {"owner": {"reputation": 776, "user_id": 10187988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4b241724a6266b0419c754aec2ed261?s=128&d=identicon&r=PG&f=1", "display_name": "Maicake", "link": "https://stackoverflow.com/users/10187988/maicake"}, "edited": false, "score": 0, "creation_date": 1564651616, "post_id": 57295143, "comment_id": 101104393, "body": "Indeed I&#39;ve seen there is a bpf syscall but I&#39;ve never seen an example using it."}, {"owner": {"reputation": 4454, "user_id": 3716552, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/078Ob.jpg?s=128&g=1", "display_name": "Qeole", "link": "https://stackoverflow.com/users/3716552/qeole"}, "reply_to_user": {"reputation": 776, "user_id": 10187988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4b241724a6266b0419c754aec2ed261?s=128&d=identicon&r=PG&f=1", "display_name": "Maicake", "link": "https://stackoverflow.com/users/10187988/maicake"}, "edited": false, "score": 1, "creation_date": 1564651975, "post_id": 57295143, "comment_id": 101104588, "body": "You don&#39;t need to use the syscall yourself, libbpf handles that for you. Apart from headers/includes, 3) is the same as 1). You can get it libbpf of the tree, there&#39;s <a href=\"https://github.com/libbpf/libbpf\" rel=\"nofollow noreferrer\">a GitHub mirror</a> you can download, install and use as any other C library. Did you look at the examples I provided? <a href=\"https://github.com/Netronome/bpf-samples/\" rel=\"nofollow noreferrer\">bpf-samples</a> use libbpf out of the tree to build the programs (the libbpf GitHub repo is added as a Git submodule). And other than for building it, <code>bpftool</code> works with any BPF stuff, not just the samples in the kernel."}, {"owner": {"reputation": 776, "user_id": 10187988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4b241724a6266b0419c754aec2ed261?s=128&d=identicon&r=PG&f=1", "display_name": "Maicake", "link": "https://stackoverflow.com/users/10187988/maicake"}, "edited": false, "score": 0, "creation_date": 1564657324, "post_id": 57295143, "comment_id": 101107514, "body": "Ok so I can get the libbpf,  write my backend using bpf functions which already comes with my kernel, then include the libbpf.h header and link the .so  to my frontend.  I&#39;ve seen them but they are quite complicated for me :(. I&#39;m trying the simplest things I can and still I&#39;m struggling.  OT: I was reading bpf man and &quot;In the current implementation, all bpf() commands require the caller to have the CAP_SYS_ADMIN capability.&quot; So it means that every ebpf program needs to be run with sudo. Is this always true?"}, {"owner": {"reputation": 4454, "user_id": 3716552, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/078Ob.jpg?s=128&g=1", "display_name": "Qeole", "link": "https://stackoverflow.com/users/3716552/qeole"}, "reply_to_user": {"reputation": 776, "user_id": 10187988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4b241724a6266b0419c754aec2ed261?s=128&d=identicon&r=PG&f=1", "display_name": "Maicake", "link": "https://stackoverflow.com/users/10187988/maicake"}, "edited": false, "score": 1, "creation_date": 1564659977, "post_id": 57295143, "comment_id": 101108985, "body": "No, the <code>bpf()</code> man page is completely out-of-date. Regarding permissions, you need this capability for most commands and program types, but <a href=\"https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/kernel/bpf/syscall.c?h=v5.2#n1621\" rel=\"nofollow noreferrer\">not for socket filters</a> or some of the cgroup stuff."}, {"owner": {"reputation": 776, "user_id": 10187988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4b241724a6266b0419c754aec2ed261?s=128&d=identicon&r=PG&f=1", "display_name": "Maicake", "link": "https://stackoverflow.com/users/10187988/maicake"}, "reply_to_user": {"reputation": 4454, "user_id": 3716552, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/078Ob.jpg?s=128&g=1", "display_name": "Qeole", "link": "https://stackoverflow.com/users/3716552/qeole"}, "edited": false, "score": 0, "creation_date": 1564660455, "post_id": 57295143, "comment_id": 101109264, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/197345/discussion-between-maicake-and-qeole\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 4454, "user_id": 3716552, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/078Ob.jpg?s=128&g=1", "display_name": "Qeole", "link": "https://stackoverflow.com/users/3716552/qeole"}, "is_accepted": true, "score": 1, "last_activity_date": 1564993555, "last_edit_date": 1564993555, "creation_date": 1564589821, "answer_id": 57295143, "question_id": 57291946, "link": "https://stackoverflow.com/questions/57291946/why-ebpf-program-inside-samples-bpf-doesnt-work/57295143#57295143", "title": "Why ebpf program inside samples/bpf doesn&#39;t work?", "body": "<p>Because of the way <code>load_bpf_file()</code> loads the function, you need to put your BPF program function in a separate ELF section. For example, I could load the program with:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>SEC(\"socket\")\nint icmp_filter(struct __sk_buff *skb){\n        ...\n}\n</code></pre>\n\n<p>After that, I see a succession of <code>res=-1</code> when running the program. This is because your socket is set as non-blocking by <code>open_raw_sock()</code>, from <code>sock_example.h</code>:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>sock = socket(PF_PACKET, SOCK_RAW|SOCK_NONBLOCK|SOCK_CLOEXEC, htons(ETH_P_ALL));\n</code></pre>\n\n<p>So when there is no packet to receive, <code>recvfrom()</code> simply returns with <code>-1</code> (and sets <code>errno</code> to <code>-EGAIN</code> -- you should consider printing <code>strerror(errno)</code> by the way) instead of waiting for a packet. So you may want to change that too.</p>\n"}], "owner": {"reputation": 776, "user_id": 10187988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4b241724a6266b0419c754aec2ed261?s=128&d=identicon&r=PG&f=1", "display_name": "Maicake", "link": "https://stackoverflow.com/users/10187988/maicake"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 589, "favorite_count": 1, "accepted_answer_id": 57295143, "answer_count": 1, "score": 0, "last_activity_date": 1564993555, "creation_date": 1564579730, "last_edit_date": 1564580665, "question_id": 57291946, "link": "https://stackoverflow.com/questions/57291946/why-ebpf-program-inside-samples-bpf-doesnt-work", "title": "Why ebpf program inside samples/bpf doesn&#39;t work?", "body": "<p><strong>GOAL:</strong> write a new <code>ebpf</code> example within <code>samples/bpf</code> directory in the kernel source tree of 4.18.0, compile and execute it.</p>\n\n<p><strong>PROBLEM:</strong> after compiling it when I run <code>sudo ./mine</code> it just terminates.</p>\n\n<p><strong>mine_kern.c</strong></p>\n\n<pre><code>#include &lt;uapi/linux/bpf.h&gt;\n#include &lt;uapi/linux/if_ether.h&gt;\n#include &lt;uapi/linux/ip.h&gt;\n#include &lt;linux/in.h&gt;\n#include &lt;linux/if_packet.h&gt;\n#include \"bpf_helpers.h\" \n\nint icmp_filter(struct __sk_buff *skb){\n\n        int proto = load_byte(skb, ETH_HLEN + offsetof(struct iphdr, protocol));\n        if(proto == IPPROTO_ICMP &amp;&amp; skb-&gt;pkt_type == PACKET_OUTGOING){\n           return -1;\n        } else {\n           return 0;\n        }\n}\n\nchar _license[] SEC(\"license\") = \"GPL\";\n</code></pre>\n\n<p><strong>mine_user.c</strong></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;assert.h&gt;\n#include &lt;linux/bpf.h&gt;\n#include &lt;bpf/bpf.h&gt;\n#include \"bpf_load.h\"\n#include \"sock_example.h\"\n#include &lt;unistd.h&gt;\n#include &lt;arpa/inet.h&gt;    \n\nint main(int ac, char **argv)\n{\n    char filename[256];\n    FILE *f;\n    int i, sock;\n\n    snprintf(filename, sizeof(filename), \"%s_kern.o\", argv[0]);\n\n    if (load_bpf_file(filename)) {\n        printf(\"%s\", bpf_log_buf);\n        return 1;\n    }   \n\n    sock = open_raw_sock(\"lo\");\n\n    assert(setsockopt(sock, SOL_SOCKET, SO_ATTACH_BPF, prog_fd,\n              sizeof(prog_fd[0])) == 0);\n\n    f = popen(\"ping -c5 localhost\", \"r\");\n    (void) f;\n\n    char buf[65535];\n\n    for(i=0; i&lt;20; i++){\n           int res = recvfrom(sock, buf, sizeof(buf), 0, NULL, 0);\n           printf(\"res=%d\\n\", res);\n     } \n\n     return 0;\n}\n</code></pre>\n\n<p>I've also modified the <code>Makefile</code> inside <code>samples/bpf</code> adding <code>mine_user.c</code> and <code>mine_kern.c</code> where required.\n<strong>QUESTIONS:</strong> what is wrong with this code? </p>\n"}, {"tags": ["c", "cryptography", "bitwise-xor"], "comments": [{"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 5, "creation_date": 1564577484, "post_id": 57291133, "comment_id": 101076769, "body": "XOR can produce an unprintable value.:)"}, {"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 1, "creation_date": 1564577503, "post_id": 57291133, "comment_id": 101076782, "body": "If you XOR two printable characters the result won&#39;t necessarily be a printable character. It can even be 0 (if the two characters are equal), which will act as a C string terminator."}, {"owner": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "edited": false, "score": 1, "creation_date": 1564577554, "post_id": 57291133, "comment_id": 101076816, "body": "Also, you never null-terminate your output string. It&#39;s not in a static scope, so it won&#39;t be null-initialized."}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1564577586, "post_id": 57291133, "comment_id": 101076834, "body": "@Naman Sood Moreover the array c can not contain a string because it is not zero terminated."}, {"owner": {"reputation": 17, "user_id": 11332633, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Rq7kE0od450/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfiKBZAAMnD3h73dRd6z7IKHNed7w/mo/photo.jpg?sz=128", "display_name": "Naman Sood", "link": "https://stackoverflow.com/users/11332633/naman-sood"}, "edited": false, "score": 0, "creation_date": 1564577588, "post_id": 57291133, "comment_id": 101076837, "body": "I tried it with two strings like HELLO and AXHJB which should give output as KMIVE but it is still giving some random unprintable characters"}, {"owner": {"reputation": 17, "user_id": 11332633, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Rq7kE0od450/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfiKBZAAMnD3h73dRd6z7IKHNed7w/mo/photo.jpg?sz=128", "display_name": "Naman Sood", "link": "https://stackoverflow.com/users/11332633/naman-sood"}, "edited": false, "score": 0, "creation_date": 1564577625, "post_id": 57291133, "comment_id": 101076856, "body": "In the end should I give c[i]=&#39;/0&#39; or something ?"}, {"owner": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "edited": false, "score": 3, "creation_date": 1564577750, "post_id": 57291133, "comment_id": 101076933, "body": "@NamanSood I think you may be confusing alphabet indices (0-25 or 1-26) with text encoding (probably ASCII). <code>&#39;H&#39;</code> and <code>&#39;A&#39;</code> have values of 0x48 and 0x41 respectively in ASCII. <code>&#39;H&#39; ^ &#39;A&#39;</code> is 9, which is a tab character."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 1, "creation_date": 1564578011, "post_id": 57291133, "comment_id": 101077084, "body": "&quot;I tried it with two strings like HELLO and AXHJB which should give output as KMIVE&quot; looks like you need something else than what everybody call XOR."}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 0, "creation_date": 1564578076, "post_id": 57291133, "comment_id": 101077137, "body": "First, lowercase them and then subtract <code>&#39;A&#39;</code>. Then XOR it and add <code>&#39;A&#39;</code> back."}, {"owner": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "edited": false, "score": 2, "creation_date": 1564578211, "post_id": 57291133, "comment_id": 101077218, "body": "Looks like the Vernam Cypher uses <a href=\"https://en.wikipedia.org/wiki/Baudot_code\" rel=\"nofollow noreferrer\">Baudot code</a> as it&#39;s text encoding. You need to convert to that before you perform the operation."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 2, "creation_date": 1564578611, "post_id": 57291133, "comment_id": 101077444, "body": "Or actually Baudot-Murray code (ITA2), not the original Baudot code (ITA1)."}, {"owner": {"reputation": 17, "user_id": 11332633, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Rq7kE0od450/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfiKBZAAMnD3h73dRd6z7IKHNed7w/mo/photo.jpg?sz=128", "display_name": "Naman Sood", "link": "https://stackoverflow.com/users/11332633/naman-sood"}, "edited": false, "score": 0, "creation_date": 1564579099, "post_id": 57291133, "comment_id": 101077741, "body": "Lowercase and subtract doesn&#39;t work"}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 11332633, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Rq7kE0od450/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfiKBZAAMnD3h73dRd6z7IKHNed7w/mo/photo.jpg?sz=128", "display_name": "Naman Sood", "link": "https://stackoverflow.com/users/11332633/naman-sood"}, "edited": false, "score": 0, "creation_date": 1564577862, "post_id": 57291264, "comment_id": 101076999, "body": "how would I take the input then ? same way ?"}, {"owner": {"reputation": 17, "user_id": 11332633, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Rq7kE0od450/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfiKBZAAMnD3h73dRd6z7IKHNed7w/mo/photo.jpg?sz=128", "display_name": "Naman Sood", "link": "https://stackoverflow.com/users/11332633/naman-sood"}, "edited": false, "score": 0, "creation_date": 1564578088, "post_id": 57291264, "comment_id": 101077146, "body": "Ah I got it, I was anyways going with the wrong logic to the question. thanks for the information"}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 1, "creation_date": 1564578137, "post_id": 57291264, "comment_id": 101077175, "body": "He&#39;s not XOR-ing the NULL character, though."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1564578238, "post_id": 57291264, "comment_id": 101077232, "body": "Indeed the OP&#39;s result array is not ensured terminated, but that has very little to do with most of this answer, it it probably is not the main reason for the unexpected output."}, {"owner": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "reply_to_user": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 0, "creation_date": 1564578240, "post_id": 57291264, "comment_id": 101077233, "body": "@JL2210 You still need to null-terminate the string"}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "reply_to_user": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "edited": false, "score": 0, "creation_date": 1564578275, "post_id": 57291264, "comment_id": 101077248, "body": "@ThomasJager Ah, yes. Didn&#39;t see that."}], "tags": [], "owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "is_accepted": false, "score": 0, "last_activity_date": 1564583715, "last_edit_date": 1564583715, "creation_date": 1564577777, "answer_id": 57291264, "question_id": 57291133, "link": "https://stackoverflow.com/questions/57291133/logical-xor-in-character-arrays/57291264#57291264", "title": "Logical XOR in character arrays", "body": "<p><em>Whenever I run the code, I get output as ????? in boxes</em>...  </p>\n\n<p><code>XOR</code>ing two printable characters does not always result in a printable value.  </p>\n\n<p>Consider the following:    </p>\n\n<ul>\n<li>the <code>^</code> operator operates at the bit level.</li>\n<li>there is a limited range of values that are <em>printable</em>. (from <em><a href=\"https://www.ionos.com/digitalguide/server/know-how/ascii-codes-overview-of-all-characters-on-the-ascii-table/\" rel=\"nofollow noreferrer\">here</a></em>):</li>\n</ul>\n\n<blockquote>\n<pre><code>Control Characters (0\u201331 &amp; 127): Control characters are not printable characters. They are used to send commands to the PC or the\n</code></pre>\n  \n  <p>printer and are based on telex technology. With these characters, you\n  can set line breaks or tabs. Today, they are mostly out of use.</p>\n\n<pre><code>Special Characters (32\u201347 / 58\u201364 / 91\u201396 / 123\u2013126): Special characters include all printable characters that are neither letters\n</code></pre>\n  \n  <p>nor numbers. These include punctuation or technical, mathematical\n  characters. ASCII also includes the space (a non-visible but printable\n  character), and, therefore, does not belong to the control characters\n  category, as one might suspect.</p>\n\n<pre><code>Numbers (30\u201339): These numbers include the ten Arabic numerals from 0-9.\n\nLetters (65\u201390 / 97\u2013122): Letters are divided into two blocks, with the first group containing the uppercase letters and the second\n</code></pre>\n  \n  <p>group containing the lowercase.</p>\n</blockquote>\n\n<p>Using the following two strings and the following code:</p>\n\n<pre><code>char str1 = {\"asdf\"};\nchar str1 = {\"jkl;\"};  \n</code></pre>\n\n<p>Following demonstrates XORing the elements of the strings:</p>\n\n<pre><code>int main(void)\n{\n    char str1[] = {\"asdf\"};\n    char str2[] = {\"jkl;\"};\n\n    for(int i=0;i&lt;sizeof(str1)/sizeof(str1[i]);i++)\n    {\n        printf(\"%d ^ %d: %d\\n\", str1[i],str2[i], str1[i]^str2[i]);\n    }\n    getchar();\n\n\n\n    return 0;   \n}\n</code></pre>\n\n<p>While all of the input characters are printable (except the NULL character), not all of the XOR results of corresponding characters are:</p>\n\n<pre><code> 97 ^ 106: 11  //not printable\n115 ^ 107: 24  //not printable\n100 ^ 108: 8   //not printable\n102 ^ 59: 93\n0 ^ 0: 0      \n</code></pre>\n\n<p>This is why you are seeing the odd output.  While all of the values may be completely valid for your purposes, they are not all printable.</p>\n"}, {"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 2, "last_activity_date": 1564582677, "last_edit_date": 1564582677, "creation_date": 1564580000, "answer_id": 57292048, "question_id": 57291133, "link": "https://stackoverflow.com/questions/57291133/logical-xor-in-character-arrays/57292048#57292048", "title": "Logical XOR in character arrays", "body": "<blockquote>\n  <p>I've been trying to make a program on Vernam Cipher which requires me to XOR two strings</p>\n</blockquote>\n\n<p>Yes, it does, but that's not the <em>only</em> thing it requires.  <a href=\"https://www.cryptomuseum.com/crypto/vernam.htm\" rel=\"nofollow noreferrer\">The Vernam cipher</a> involves first <strong><em>representing the message and key in <a href=\"https://www.cryptomuseum.com/crypto/baudot.htm\" rel=\"nofollow noreferrer\">the ITA2 encoding</a></em></strong> (also known as Baudot-Murray code), and then computing the XOR of each pair of corresponding character codes from the message and key streams.</p>\n\n<p>Moreover, to display the result in the manner you indicate wanting to do, you must first <strong><em>convert it from ITA2 to the appropriate character encoding for your locale</em></strong>, which is probably a superset of ASCII.</p>\n\n<p>The transcoding to and from ITA2 is relatively straightforward, but not so trivial that I'm inclined to write them for you.  There is a code chart at the ITA2 link above.</p>\n\n<p>Note also that ITA2 is a <em>stateful</em> encoding that includes shift codes and a null character.  This implies that the enciphered message may contain non-printing characters, which could cause some confusion, including a null character, which will be misinterpreted as a string terminator if you are not careful.  More importantly, <em>encoding in ITA2 may increase the length of the message</em> as a result of a need to insert shift codes.</p>\n\n<p>Additionally, as a technical matter, if you want to treat the enciphered bytes as a C string, then you need to ensure that it is terminated with a null character.  On a related note, <code>scanf()</code> will do that for the strings it reads, which uses one character, leaving you only 49 each for the actual message and key characters.</p>\n\n<blockquote>\n  <p>What is the method to XOR these two strings ?</p>\n</blockquote>\n\n<p>The XOR itself is not your problem.  Your code for that is fine.  The problem is that you are XORing the wrong values, and (once the preceding is corrected) outputting the result in a manner that does not serve your purpose. </p>\n"}], "owner": {"reputation": 17, "user_id": 11332633, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Rq7kE0od450/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfiKBZAAMnD3h73dRd6z7IKHNed7w/mo/photo.jpg?sz=128", "display_name": "Naman Sood", "link": "https://stackoverflow.com/users/11332633/naman-sood"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 317, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1564583715, "creation_date": 1564577374, "last_edit_date": 1564577494, "question_id": 57291133, "link": "https://stackoverflow.com/questions/57291133/logical-xor-in-character-arrays", "title": "Logical XOR in character arrays", "body": "<p>I've been trying to make a program on Vernam Cipher which requires me to XOR two strings. I tried to do this program in C and have been getting an error.The length of the two strings are the same.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;string.h&gt;\nint main()\n{\n    printf(\"Enter your string to be encrypted \");\n    char a[50];\n    char b[50];\n    scanf(\"%s\",a);\n    printf(\"Enter the key \");\n    scanf(\"%s\",b);\n    char c[50];\n    int q=strlen(a);\n    int i=0;\n    for(i=0;i&lt;q;i++)\n    {\n        c[i]=(char)(a[i]^b[i]);\n    }\n    printf(\"%s\",c);\n}\n</code></pre>\n\n<p>Whenever I run the code, I get output as ????? in boxes. What is the method to XOR these two strings ? </p>\n"}, {"tags": ["c", "list", "insert", "singly-linked-list"], "comments": [{"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1564575370, "post_id": 57290522, "comment_id": 101075521, "body": "This code snippet  nodo_ent *head; nodo_ent *tail; head = NULL; tail = NULL; will not compile if it is present in the global namespace"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1564575422, "post_id": 57290522, "comment_id": 101075551, "body": "<code>ptr = &amp;nodo;</code> immediately overwrites the pointer to the memory allocated."}, {"owner": {"reputation": 17, "user_id": 11863276, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a4701ec960e9d866a9a623592ec2b90?s=128&d=identicon&r=PG&f=1", "display_name": "Jack", "link": "https://stackoverflow.com/users/11863276/jack"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1564575849, "post_id": 57290522, "comment_id": 101075759, "body": "@WeatherVane I think that&#39;s intended? I want a new pointer, pointing to new data, so that should get me what I want, I think. Maybe I am misunderstanding your comment?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1564576074, "post_id": 57290522, "comment_id": 101075913, "body": "What I mean is that <code>ptr = malloc(sizeof(nodo_ent)); ptr = &amp;nodo;</code> ignores the memory allocation (since you now don&#39;t know what the pointer was), and also creates a memory leak for the same reason (the memory is not used and cannot be <code>free</code>d)."}], "answers": [{"tags": [], "owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "is_accepted": true, "score": 2, "last_activity_date": 1564576222, "creation_date": 1564576222, "answer_id": 57290780, "question_id": 57290522, "link": "https://stackoverflow.com/questions/57290522/assignments-in-my-linked-list-doesnt-work/57290780#57290780", "title": "Assignments in my linked list doesn&#39;t work", "body": "<p>As Weather Vane points out,</p>\n\n<pre><code>nodo_ent nodo = {NULL, ent};\nnodo_ent *ptr;\nptr = (nodo_ent*)malloc(sizeof(nodo_ent));\nptr = &amp;nodo;\n</code></pre>\n\n<p>this sequence allocates memory, then overwrites the pointer to this allocated memory with the address of the local variable <code>nodo</code>.</p>\n\n<p>Then you work on this local variable, but when the function returns, that local variable doesn't exist anymore and your list is corrupted.</p>\n\n<p>You have it all there, just use:</p>\n\n<pre><code>nodo_ent *ptr;\nptr = malloc(sizeof(nodo_ent));\n</code></pre>\n\n<p>(and don't cast the result of malloc. A pointer to <code>void</code>, which malloc returns, is compatible with any pointer.)</p>\n"}, {"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 0, "last_activity_date": 1564579687, "last_edit_date": 1564579687, "creation_date": 1564577113, "answer_id": 57291066, "question_id": 57290522, "link": "https://stackoverflow.com/questions/57290522/assignments-in-my-linked-list-doesnt-work/57291066#57291066", "title": "Assignments in my linked list doesn&#39;t work", "body": "<p>For starters if this code snippet</p>\n\n<pre><code>nodo_ent *head;\nnodo_ent *tail;\nhead = NULL;\ntail = NULL;\n</code></pre>\n\n<p>is in the global namespace then the code will not compile.</p>\n\n<p>The function <code>ent_exists</code> is too complicated.</p>\n\n<p>It can be implemented much simpler.</p>\n\n<pre><code>nodo_ent * ent_exists( const char *ent )\n{\n    nodo_ent *cursor = head;\n\n    while ( cursor != NULL &amp;&amp; strcmp( cursor-&gt;ent, ent ) != 0 )\n    {\n        cursor = cursor-&gt;next;\n    }\n\n    return cursor;  \n}\n</code></pre>\n\n<p>The function <code>addent</code> should have the return type int that to report whether inserting of a new node was successful.</p>\n\n<p>This code snippet</p>\n\n<pre><code>nodo_ent nodo = {NULL, ent};\nnodo_ent *ptr;\nptr = (nodo_ent*)malloc(sizeof(nodo_ent));\nptr = &amp;nodo;\n</code></pre>\n\n<p>does not make sense and moreover there is a memory leak.</p>\n\n<p>You have to make a copy of the string that is passed as an argument. Otherwise in general the program will have undefined behavior.</p>\n\n<p>Here is a demonstrative program that shows how the functions can be defined.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\ntypedef struct nodo_ent{\n  struct nodo_ent *next;\n  char *ent;\n}nodo_ent;\n\nnodo_ent *head = NULL;\nnodo_ent *tail = NULL;\n\nnodo_ent * ent_exists( const char *ent )\n{\n    nodo_ent *cursor = head;\n\n    while ( cursor != NULL &amp;&amp; strcmp( cursor-&gt;ent, ent ) != 0 )\n    {\n        cursor = cursor-&gt;next;\n    }\n\n    return cursor;  \n}\n\nint addent( const char *ent )\n{\n    nodo_ent *target_nodo = ent_exists( ent );\n\n    int success = target_nodo == NULL;\n\n    if ( success )\n    {\n        target_nodo = malloc( sizeof( nodo_ent ) );\n        success = target_nodo != NULL;\n    }\n\n    if ( success )\n    {\n        char *s = malloc( strlen( ent ) + 1 );\n\n        success = s != NULL;\n\n        if ( success )\n        {\n            strcpy( s, ent );\n            target_nodo-&gt;ent = s;\n            target_nodo-&gt;next = NULL;\n        }           \n        else \n        {\n            free( target_nodo );\n        }           \n    }\n\n    if ( success )\n    {\n        if ( head == NULL )\n        {\n            head = tail = target_nodo;\n        }\n        else\n        {\n            tail = tail-&gt;next = target_nodo;\n        }\n    }       \n\n    return success;\n}\n\nvoid output()\n{\n    for ( nodo_ent *cursor = head; cursor != NULL; cursor = cursor-&gt;next )\n    {\n        printf( \"%s \", cursor-&gt;ent );\n    }\n}\n\nint main(void) \n{\n    const char *ent;\n\n    ent = \"Hello\";\n    addent( ent );\n\n    ent = \"Jack\";\n    addent( ent );\n\n    output();\n\n    return 0;\n}\n</code></pre>\n\n<p>Its output is</p>\n\n<pre><code>Hello Jack\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 11863276, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a4701ec960e9d866a9a623592ec2b90?s=128&d=identicon&r=PG&f=1", "display_name": "Jack", "link": "https://stackoverflow.com/users/11863276/jack"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 57290780, "answer_count": 2, "score": -2, "last_activity_date": 1564582970, "creation_date": 1564575268, "last_edit_date": 1564582970, "question_id": 57290522, "link": "https://stackoverflow.com/questions/57290522/assignments-in-my-linked-list-doesnt-work", "title": "Assignments in my linked list doesn&#39;t work", "body": "<p>I am trying to implement a linked list that inserts an item only if it's not already present in the list. If the item is present, <code>ent_exists</code> returns a pointer to that item.</p>\n\n<pre><code>typedef struct nodo_ent{\n  struct nodo_ent *next;\n  char *ent;\n}nodo_ent;\n\nnodo_ent *head;\nnodo_ent *tail;\nhead = NULL;\ntail = NULL;\n\nnodo_ent *ent_exists(char *ent)\n{\n  if (head == NULL)\n {\n   return NULL;\n }\n else\n {\n   nodo_ent *cursor;\n   cursor = head;\n   while (cursor != tail)\n   {\n     if (strcmp(cursor-&gt;ent, ent) == 0);\n     {\n       return cursor;\n     }\n     cursor = cursor-&gt;next;\n   }\n   if (strcmp(tail-&gt;ent, ent) == 0);\n   {\n     return tail;\n   }\n   return NULL;\n }\n}\n\nvoid addent(char *ent)\n{\n  if (ent_exists(ent) != NULL)\n  {\n    return;\n  }\n  else\n  {\n    nodo_ent nodo = {NULL, ent};\n    nodo_ent *ptr;\n    ptr = (nodo_ent*)malloc(sizeof(nodo_ent));\n    ptr = &amp;nodo;\n    if (head == NULL)\n    {\n      head = ptr;\n      tail = ptr;\n    }\n    else\n    {\n      tail-&gt;next = ptr;\n      tail = ptr;\n    }\n    return;\n  }\n}\n\n\n</code></pre>\n\n<p>After the first call of \"addent\", both \"head\" and \"tail\" point to the address of the added node, but when I call it a second time and try to access tail->ent (in ent_exists), valgrind says it's uninitialised</p>\n"}, {"tags": ["c", "multidimensional-array", "random"], "comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1564576369, "post_id": 57290516, "comment_id": 101076082, "body": "<a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.7.9p10\" rel=\"nofollow noreferrer\">C11 Standard - 6.7.9 Initialization(p10)</a> <i>&quot;If an object that has automatic storage duration is not initialized explicitly, its value is indeterminate.&quot;</i> Use of an indeterminate value is <i>Undefined Behavior</i>. <a href=\"http://port70.net/~nsz/c/c11/n1570.html#J.2\" rel=\"nofollow noreferrer\">C11 Standard - J.2 Undefined Behavior</a> &quot;The value of an object with automatic storage duration is used while it is indeterminate (6.2.4, 6.7.9, 6.8).&quot;"}, {"owner": {"reputation": 9215, "user_id": 5212827, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/7e9f9b0d7e2d571c9f8886dd54bd50f9?s=128&d=identicon&r=PG&f=1", "display_name": "DeiDei", "link": "https://stackoverflow.com/users/5212827/deidei"}, "edited": false, "score": 0, "creation_date": 1564576381, "post_id": 57290516, "comment_id": 101076086, "body": "I&#39;m guessing <code>&amp;A[0][N - 1] + 1 != &amp;A[1][0]</code>. What if you just have a flat 2D array: <code>double A[N * N]</code>? Or just loop it anyway..."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1564576878, "post_id": 57290516, "comment_id": 101076367, "body": "<i>Is the only solution to use a loop here?</i> - no. You can initialize the arrays to know byte values and the &quot;Shuffle&quot; the arrays. <a href=\"https://en.wikipedia.org/wiki/Fisher%E2%80%93Yates_shuffle\" rel=\"nofollow noreferrer\">Fisher\u2013Yates shuffle</a> or you can loop filling each element with a random value."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 9215, "user_id": 5212827, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/7e9f9b0d7e2d571c9f8886dd54bd50f9?s=128&d=identicon&r=PG&f=1", "display_name": "DeiDei", "link": "https://stackoverflow.com/users/5212827/deidei"}, "edited": false, "score": 1, "creation_date": 1564577019, "post_id": 57290516, "comment_id": 101076467, "body": "@DeiDei: Arrays are required to be contiguous; Given <code>double A[N][N];</code>, then <code>&amp;A[0][N - 1] + 1 != &amp;A[1][0]</code> is necessarily true as a statement of where the terms must be placed (not as a C expression; it technically violates pointer arithmetic rules)."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1564577244, "post_id": 57290516, "comment_id": 101076612, "body": "@DavidC.Rankin: What does initialization or lack thereof have to do with anything here? The code in the question does not use any uninitialized object."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1564577276, "post_id": 57290516, "comment_id": 101076634, "body": "@DavidC.Rankin: What does a Fisher-Yates Shuffle have to do with anything here? The question does not ask for shuffling."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1564577430, "post_id": 57290516, "comment_id": 101076733, "body": "@EricPostpischil Since there was no definition of <code>arc4random_buf</code>, it initially appeared he was relying on <code>double A[N][N];</code> to fill <code>A</code> with random byte values by allowing it to remain uninitialized. If <code>arc4random_buf</code> is what is producing the random values -- then no problem."}], "answers": [{"tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": true, "score": 1, "last_activity_date": 1564576834, "creation_date": 1564576834, "answer_id": 57290979, "question_id": 57290516, "link": "https://stackoverflow.com/questions/57290516/filling-a-multidimensional-array-with-random-bytes-in-one-line-in-c/57290979#57290979", "title": "Filling a multidimensional array with random bytes in one line in C", "body": "<p>Stacks are limited in size. 8 MiB<sup>1</sup> or smaller is common.</p>\n\n<p>If <code>double</code> is eight bytes and <code>N</code> is 1000, then <code>double A[N][N];</code> requests 8 MiB. The stack in your C implementation is insufficient to provide this, so your program crashes.</p>\n\n<p>Instead of declaring a local object in your function, use <code>malloc</code> to request memory. The memory available via <code>malloc</code> is generally much larger:</p>\n\n<pre><code>double (*A)[N] = malloc(N * sizeof *A);\nif (!A) { /* Handle error. */ }\narc4random_buf(A, N * sizeof *A);\n</code></pre>\n\n<h2>Footnote</h2>\n\n<p><sup>1</sup> <a href=\"https://en.wikipedia.org/wiki/Mebibyte\" rel=\"nofollow noreferrer\">\u201cMiB\u201d stands for mebibyte, which is 2<sup>20</sup> = 1,048,576 bytes.</a></p>\n"}], "owner": {"reputation": 83, "user_id": 6089458, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gqjNK.jpg?s=128&g=1", "display_name": "Seiren", "link": "https://stackoverflow.com/users/6089458/seiren"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 57290979, "answer_count": 1, "score": 0, "last_activity_date": 1564577696, "creation_date": 1564575248, "last_edit_date": 1564577696, "question_id": 57290516, "link": "https://stackoverflow.com/questions/57290516/filling-a-multidimensional-array-with-random-bytes-in-one-line-in-c", "title": "Filling a multidimensional array with random bytes in one line in C", "body": "<p>I want to initialize a 2D matrix by filling it with random numbers (doubles).</p>\n\n<p>So, for example, this code </p>\n\n<pre><code>#define N 1000\n\nint main(void){\n  double A[N];\n\n  arc4random_buf(A,N*sizeof(double));\n\n  return 0;\n}\n</code></pre>\n\n<p>runs and produces a 1D array filled with random numbers as expected.</p>\n\n<p>However, this </p>\n\n<pre><code>#define N 1000\n\nint main(void){\n  double A[N][N];\n\n  arc4random_buf(A,N*N*sizeof(double));\n\n  return 0;\n}\n</code></pre>\n\n<p>produces a segmentation fault. I've tried initializing A with zeroes on the previous line, to no avail.</p>\n\n<p>Is the only solution to use a loop here?</p>\n\n<p>Edit: as Eric pointed out, stack size is likely the issue here: changing N to 600 'fixes' the 2nd code as well. Thanks! </p>\n\n<p>(stack size is indeed 8 MiB on my system, so this should've fit, but there is also a 2nd array of the same size in the actual code)</p>\n"}, {"tags": ["c", "winsock", "recv"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1564575162, "post_id": 57290464, "comment_id": 101075414, "body": "When <code>recv</code> returns <code>0</code> it means that the other side of the connection have closed it, and that you should too."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1564575802, "post_id": 57290464, "comment_id": 101075739, "body": "There are also other problems with your code, like for example you won&#39;t be receiving a null-terminated string, so <code>strlen(data)</code> will not work correctly (and will in fact lead to <i>undefined behavior</i>). If you want to treat the received data as a string you need to add the null-terminator yourself."}, {"owner": {"reputation": 1693, "user_id": 6889435, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/DKfVf.png?s=128&g=1", "display_name": "Kamila Szewczyk", "link": "https://stackoverflow.com/users/6889435/kamila-szewczyk"}, "edited": false, "score": 3, "creation_date": 1564577513, "post_id": 57290464, "comment_id": 101076795, "body": "Can&#39;t you just use curl or WinHTTP to get job done?"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1564596207, "post_id": 57290464, "comment_id": 101087248, "body": "The first line of your <code>POST</code> request is malformed. You can&#39;t have unencoded whitespace in a URL. The whitespace in front of <code>sensor=false</code> is breaking the request. There is no <code>sensor</code> attribute in the GeoLocation API, you need to remove it. The server is likely closing the connection with an error because of that mistake in your code."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1564596332, "post_id": 57290464, "comment_id": 101087299, "body": "Also, requesting <code>Connection: keep-alive</code> is redundant in HTTP 1.1. However, requesting a keep-alive doesnt guarantee the server will honor it. Ultimately, the server decides whether to keep the connection alive or not. You have to parse the server&#39;s response to know what decision was actually made, as well as to know when the response ends. You can&#39;t just blindly read data in an endless loop, <i>especially</i> when a keep-alive is used. You must stop reading when the end of the response is reached. Read <a href=\"https://tools.ietf.org/html/rfc2616#section-4.4\" rel=\"nofollow noreferrer\">RFC 2616 Section 4.4</a> for the rules on that."}, {"owner": {"reputation": 1, "user_id": 11863604, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f0c4a5bcc9045eb27ba7ff5280fd6e7?s=128&d=identicon&r=PG&f=1", "display_name": "siva", "link": "https://stackoverflow.com/users/11863604/siva"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1564642203, "post_id": 57290464, "comment_id": 101099452, "body": "@RemyLebeau I have remove sensor along with white space but still I receive zero"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1564677280, "post_id": 57290464, "comment_id": 101118950, "body": "@siva well, like I said, you are not PARSING THE RESPONSE at all, you are just reading in a loop until <code>recv()</code> fails, so it makes sense that you would get 0 from it eventually. See <a href=\"https://stackoverflow.com/questions/19199066/\">When is an HTTP response finished?</a>, and <a href=\"https://stackoverflow.com/a/16247097/65863\">this answer</a> to <a href=\"https://stackoverflow.com/questions/16243118/\">Differ between header and content of http server response (sockets)</a>. You have a ways to go still before you have a viable HTTP client."}], "owner": {"reputation": 1, "user_id": 11863604, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f0c4a5bcc9045eb27ba7ff5280fd6e7?s=128&d=identicon&r=PG&f=1", "display_name": "siva", "link": "https://stackoverflow.com/users/11863604/siva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1564575134, "creation_date": 1564575077, "last_edit_date": 1564575134, "question_id": 57290464, "link": "https://stackoverflow.com/questions/57290464/recv-always-returns-0-when-trying-to-send-http-post-request", "title": "recv() always returns 0 when trying to send HTTP POST request", "body": "<p>I am trying to use HTTP post request to get the location info from google geolocation API but something is going wrong with the connection after I send the query i get 0 as return value for recev() </p>\n\n<p>Is the way am sending post request the issue?</p>\n\n<p>why does the connection close after I send the request?\nwhat should i do to keep the connection alive?</p>\n\n<pre><code>#include &lt;windows.h&gt;\n#include &lt;winsock.h&gt;\n#include &lt;string.h&gt;\n#pragma comment(lib, \"Ws2_32.lib\")\n\nchar content[1500];\n\n#define constGLReq  \\\n    \"POST /geolocation/v1/geolocate?key=AIzaSyBibyFS6jV3OgPxIZkFp_t97G_THjrq0Z4; sensor=false HTTP/1.1\\r\\n\" \\\n        \"Host: www.googleapis.com\\r\\n\" \\\n        \"Connection: close\\r\\n\" \\\n        \"Cache-Control: no-cache\\r\\n\" \\\n        \"Connection: keep-alive\\r\\n\" \\\n        \"Content-Type: application/json\\r\\n\" \\\n        \"Content-Length: 0\\r\\n\" \\\n        \"\\r\\n\"\n\nint main()\n{\n    char data[512];\n    SOCKET Socket;\n    int Res ;\n    WSADATA wsaData;\n    char * host = \"www.googleapis.com\";\n    struct hostent *server;\n    SOCKADDR_IN Socaddr;\n\n\n    if (WSAStartup(MAKEWORD(2, 2), &amp;wsaData) != 0)\n    {           \n        return -1;\n    }\n\n    memset(data, 0, sizeof(data));\n    memset(content, 0, sizeof(content));\n    Socket = socket(AF_INET, SOCK_STREAM, 0);\n    if (Socket == INVALID_SOCKET)\n    {\n        /* Problem in socket creation*/\n    }\n    server = gethostbyname(host);\n\n    memset(&amp;Socaddr, 0, sizeof(SockAddr));\n    Socaddr.sin_port = htons(443);\n    Socaddr.sin_family = AF_INET;\n    memcpy(&amp;Socaddr.sin_addr.s_addr, server-&gt;h_addr, server-&gt;h_length);\n\n        Res = connect(Socket, (SOCKADDR*)(&amp;Socaddr), sizeof(Socaddr));\n    if (Res != 0)\n    {\n        closesocket(Socket1);\n    }\n    else\n    {\n        Res = send(Socket, constGLReq, (int)strlen(constGLReq), 0);\n\n        if (Res == SOCKET_ERROR)/* Checking for sending failed */\n        {\n            closesocket(Socket1);\n        }\n        else if (Res &lt;= 0)\n        {\n        }\n        else /* Sending successfull */`enter code here`\n        {\n\n\n            do\n            {\n            Res  = recv(Socket, data, sizeof(data), 0);\n            error = WSAGetLastError();\n\n            if (strlen(data) != 0)\n            {\n                    if (strlen(content) == 0)\n                    {\n                        strcpy(content, data);\n                    }\n                    else\n                    {\n                        strcat(content, data);\n                    }\n            }\n            memset(data, 0, sizeof(data));\n        } while (Res &gt; 0);\n                }\n            }\n    closesocket(Socket1);\n    WSACleanup();\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "windows", "encryption"], "comments": [{"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1564573721, "post_id": 57289750, "comment_id": 101074613, "body": "Just <code>unlink(fname); rename(&quot;temp.txt&quot;,fname);</code>. You must also open <code>temp.txt</code> in mode <code>&quot;wb&quot;</code> as the encryption can result in non-printable characters."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 2, "creation_date": 1564573978, "post_id": 57289750, "comment_id": 101074767, "body": "<code>ch</code> must be <code>int</code> as <code>EOF</code> is -1."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 2, "creation_date": 1564578919, "post_id": 57289750, "comment_id": 101077633, "body": "See: <a href=\"https://stackoverflow.com/questions/1694036/why-is-the-gets-function-dangerous-why-should-it-not-be-used\">Why gets() is so dangerous it should never be used!</a>  Also, consider spacing your code a bit more for readability, e.g. <code>if (fps == NULL)</code> is much easier to read -- especially for older eyes... Consider removing the old DOS <code>conio.h</code> and removing the non-portable <code>getch()</code> and replacing with <code>getchar()</code> since you are only using it to pause operation and hold the console window open."}, {"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 1, "creation_date": 1564578957, "post_id": 57289750, "comment_id": 101077651, "body": "@PaulOgilvie: ... as <code>EOF</code> is negative (usually -1)."}, {"owner": {"reputation": 1, "user_id": 10367368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/864a39e29b8af39d6b14643aaef277ec?s=128&d=identicon&r=PG&f=1", "display_name": "Jessica", "link": "https://stackoverflow.com/users/10367368/jessica"}, "edited": false, "score": 0, "creation_date": 1564590769, "post_id": 57289750, "comment_id": 101084896, "body": "Is it possible to somehow supplement this code so that when it starts in a folder or directory, it encrypts all the files in it? It may seem strange, but I&#39;m not going to harm anyone, it just interests me for educational purposes. I recently started learning C language"}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1564592663, "post_id": 57289750, "comment_id": 101085749, "body": "Well, sure it is. See <a href=\"https://stackoverflow.com/questions/1271064/how-do-i-loop-through-all-files-in-a-folder-using-c\">here</a> or <a href=\"https://stackoverflow.com/questions/1271064/how-do-i-loop-through-all-files-in-a-folder-using-c\">here</a> (C++, but method 3 and 4 can be used with minor changes from C, too)."}], "answers": [{"comments": [{"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 1, "creation_date": 1564582236, "post_id": 57292453, "comment_id": 101079866, "body": "This does not convert/encrypt <code>0x0D 0x0A</code>, cr/lf (on Windows). For that the file must be opened in binary mode. Probably seek -1 on cr/lf behaves unexpected."}, {"owner": {"reputation": 1, "user_id": 10367368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/864a39e29b8af39d6b14643aaef277ec?s=128&d=identicon&r=PG&f=1", "display_name": "Jessica", "link": "https://stackoverflow.com/users/10367368/jessica"}, "edited": false, "score": 0, "creation_date": 1564584273, "post_id": 57292453, "comment_id": 101081216, "body": "Thank you all so much for the help, you really helped me."}, {"owner": {"reputation": 1, "user_id": 10367368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/864a39e29b8af39d6b14643aaef277ec?s=128&d=identicon&r=PG&f=1", "display_name": "Jessica", "link": "https://stackoverflow.com/users/10367368/jessica"}, "edited": false, "score": 0, "creation_date": 1564584627, "post_id": 57292453, "comment_id": 101081448, "body": "Is it possible to somehow supplement this code so that when it starts in a folder or directory, it encrypts all the files in it?"}, {"owner": {"reputation": 1, "user_id": 10367368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/864a39e29b8af39d6b14643aaef277ec?s=128&d=identicon&r=PG&f=1", "display_name": "Jessica", "link": "https://stackoverflow.com/users/10367368/jessica"}, "edited": false, "score": 0, "creation_date": 1564584708, "post_id": 57292453, "comment_id": 101081515, "body": "It may seem strange, but I&#39;m not going to harm anyone, it just interests me for educational purposes. I recently started learning C language"}, {"owner": {"reputation": 347, "user_id": 8086115, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2MFa.jpg?s=128&g=1", "display_name": "eanmos", "link": "https://stackoverflow.com/users/8086115/eanmos"}, "reply_to_user": {"reputation": 1, "user_id": 10367368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/864a39e29b8af39d6b14643aaef277ec?s=128&d=identicon&r=PG&f=1", "display_name": "Jessica", "link": "https://stackoverflow.com/users/10367368/jessica"}, "edited": false, "score": 0, "creation_date": 1564659771, "post_id": 57292453, "comment_id": 101108864, "body": "@Jessica you probably need use Win API. See the <a href=\"https://stackoverflow.com/questions/41404711/how-to-list-files-in-a-directory-using-the-windows-api\">\u201eHow to list files in a directory using the Windows API?\u201c</a> question."}], "tags": [], "owner": {"reputation": 101, "user_id": 11353511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238ba3b07f6e47dee7d78ba26decd088?s=128&d=identicon&r=PG&f=1", "display_name": "riffic", "link": "https://stackoverflow.com/users/11353511/riffic"}, "is_accepted": true, "score": 1, "last_activity_date": 1564581226, "creation_date": 1564581226, "answer_id": 57292453, "question_id": 57289750, "link": "https://stackoverflow.com/questions/57289750/i-need-to-rename-the-file-but-i-do-not-understand-what-is-wrong-the-file-is-en/57292453#57292453", "title": "I need to rename the file, but I do not understand what is wrong, the file is encrypted, but the name does not change", "body": "<p>Don't know if I understand you completely, but I think you're trying to modify each byte as-is. Adapting <a href=\"https://stackoverflow.com/questions/21958155/modify-existing-contents-of-file-in-c\">this answer</a> to your code, you could do something like below. <strong>NOTE: There is still much room for improvement and error handling.</strong></p>\n\n<p>Also, I know you tagged this as Windows, but my Windows VM is screwing up at the moment, so I wrote and tested this code on Linux with gcc.  It may work on Windows as-is, but I did not test it. Nonetheless, I think it's straight-forward enough to get you 95% there. The key is opening the file in \"r+\" mode so you can read from and write to it.</p>\n\n<p>And lastly, don't gloss over the comments you've gotten so far from Paul Ogilvie and David C. Rankin; that's good advice.</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdio.h&gt;                                                                                  \n#include &lt;stdlib.h&gt;                                                                                 \n\nint main()                                                                                          \n{                                                                                                   \n    char fname[20];                                                                                 \n    int ch;                                                                                         \n    FILE *fps;                                                                                      \n\n    printf(\"Enter file name (with extension like file.txt) to encrypt : \");                         \n    scanf(\"%s\", fname);                                                                             \n\n    fps = fopen(fname, \"r+\");                                                                       \n    if (fps == NULL) {                                                                              \n        printf(\"Could not open file '%s'\\n\", fname);                                                \n        return 1;                                                                                   \n    }                                                                                               \n\n    while ((ch = fgetc(fps)) != EOF) {                                                              \n        ch += 100;                                                                                  \n        fseek(fps, -1, SEEK_CUR);                                                                   \n        fputc(ch, fps);                                                                             \n        fseek(fps, 0, SEEK_CUR);                                                                    \n    }                                                                                               \n\n    fclose(fps);                                                                                    \n\n    printf(\"File '%s' encrypted successfully\\n\", fname);                                            \n    return 0;                                                                                       \n}  \n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10367368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/864a39e29b8af39d6b14643aaef277ec?s=128&d=identicon&r=PG&f=1", "display_name": "Jessica", "link": "https://stackoverflow.com/users/10367368/jessica"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 0, "accepted_answer_id": 57292453, "answer_count": 1, "score": -1, "last_activity_date": 1564652182, "creation_date": 1564572619, "last_edit_date": 1564652182, "question_id": 57289750, "link": "https://stackoverflow.com/questions/57289750/i-need-to-rename-the-file-but-i-do-not-understand-what-is-wrong-the-file-is-en", "title": "I need to rename the file, but I do not understand what is wrong, the file is encrypted, but the name does not change", "body": "<p>I need to rename the file, but I do not understand what is wrong, the file is encrypted, but the name does not change, how to use the rename () function correctly.\nI need to change the file name to \"encrypt.yes\"</p>\n\n<pre><code>#include &lt;stdio.h&gt;                                                                                  \n#include &lt;stdlib.h&gt;  \n#include &lt;string.h&gt;\n\n\nint main(void)                                                                                       \n{   \n\nchar new[20];                                                                                                \nchar old[20];\nint rename(const char *old, const char *new);                                                                                 \nint ch;                                                                                         \nFILE *fps;                                                                            \nprintf(\"Enter file name (with extension like file.txt) to encrypt : \");\nstrcpy(new,\"encrypt.yes\");\nrename(old, new);                                \nscanf(\"%s\", old);\n\nfps = fopen(old, \"r+\");                                           \nif (fps == NULL) {                                                                              \n    printf(\"Could not open file '%s'\\n\", old);                                                \n    return 1;                                                                                   \n}                                                          \nwhile ((ch = fgetc(fps)) != EOF) {                                                              \n    ch += 100;                                                                                  \n    fseek(fps, -1, SEEK_CUR);                                                                   \n    fputc(ch, fps);                                                                             \n    fseek(fps, 0, SEEK_CUR);\n\n}                                                 \n\nfclose(fps);                                                                                    \n\nprintf(\"File '%s' encrypted successfully\\n\", old);                                            \nreturn 0;                                                                                       \n</code></pre>\n\n<p>}</p>\n"}, {"tags": ["c++", "c", "windows", "winsock", "iocp"], "comments": [{"owner": {"reputation": 2354, "user_id": 9428851, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-MBhDff_bdY0/AAAAAAAAAAI/AAAAAAAACAY/lx7DUTjS350/photo.jpg?sz=128", "display_name": "Victor Gubin", "link": "https://stackoverflow.com/users/9428851/victor-gubin"}, "edited": false, "score": 0, "creation_date": 1564573423, "post_id": 57289435, "comment_id": 101074451, "body": "Check [ IO completion ports](<a href=\"https://docs.microsoft.com/en-us/windows/win32/fileio/i-o-completion-ports\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/windows/win32/fileio/&hellip;</a>)"}, {"owner": {"reputation": 1005, "user_id": 10674275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1710877d569a65bda20b7c7c0865b4c?s=128&d=identicon&r=PG&f=1", "display_name": "Julius", "link": "https://stackoverflow.com/users/10674275/julius"}, "reply_to_user": {"reputation": 2354, "user_id": 9428851, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-MBhDff_bdY0/AAAAAAAAAAI/AAAAAAAACAY/lx7DUTjS350/photo.jpg?sz=128", "display_name": "Victor Gubin", "link": "https://stackoverflow.com/users/9428851/victor-gubin"}, "edited": false, "score": 0, "creation_date": 1564573853, "post_id": 57289435, "comment_id": 101074690, "body": "@VictorGubin Thanks! I was looking at that but I couldn&#39;t find any related information"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1564584683, "post_id": 57289435, "comment_id": 101081497, "body": "what sense at all pass zero size buffer ? just pass not empty buffer"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1564584789, "post_id": 57289435, "comment_id": 101081569, "body": "and anyway in all case you only got notify when I/O complete. no any sense in 0 buffer"}, {"owner": {"reputation": 1005, "user_id": 10674275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1710877d569a65bda20b7c7c0865b4c?s=128&d=identicon&r=PG&f=1", "display_name": "Julius", "link": "https://stackoverflow.com/users/10674275/julius"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1564585266, "post_id": 57289435, "comment_id": 101081883, "body": "@RbMm mostly for portability (compatibility with epoll and the like)"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1564586356, "post_id": 57289435, "comment_id": 101082518, "body": "i nothing understand in portability and are exist sense in this, but all this absolute unrelated to IOCP. <i>IOCP can sort of emulate readiness notification</i> - absolute senseless and wrong assumption. iocp nothing emulate. never. simply when I/O on file object complete and file object is bind to IOCP - packet queued to this IOCP. if you begin asynchronous I/O via <code>WSARecv</code> - when it finished - you got notification to IOCP. are you pass 0 or not 0 buffer - how here related at all ?! notification will be when io finished (if it not synchronous fail do invalid parameter/handle)"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1564586869, "post_id": 57289435, "comment_id": 101082793, "body": "you confuse completely different and unrelated things. if file is bind to IOCP and I/O operation finished on this file - you got notification via IOCP. all. what is I/O operation, what buffers you pass, are I/O operation at all have buffers - unrelate  here at all. pass emprty buffers i sure no sense - because in this case you need again call recv with not empty buffers. what sense do this, when you from begin can begin I/O operation with not empty buffers ? it will complete at the same time, if you use empty buffers. simply if case empty buffers need 2 I/O operation instead 1."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 1, "creation_date": 1564587582, "post_id": 57289435, "comment_id": 101083193, "body": "so in short - readiness notification not exist at all. iocp here unrelated. use empty buffers - have no any sense"}], "owner": {"reputation": 1005, "user_id": 10674275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1710877d569a65bda20b7c7c0865b4c?s=128&d=identicon&r=PG&f=1", "display_name": "Julius", "link": "https://stackoverflow.com/users/10674275/julius"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 92, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1564571819, "creation_date": 1564571504, "last_edit_date": 1564571819, "question_id": 57289435, "link": "https://stackoverflow.com/questions/57289435/winsock-and-iocp-readiness-notification", "title": "WinSock and IOCP readiness notification", "body": "<p>I was reading <a href=\"https://news.ycombinator.com/item?id=19541691\" rel=\"nofollow noreferrer\">this post</a> where someone mentions the ability to get notifications when a socket is ready to read instead of getting a notification when reading is finished - by submitting a 0 sized buffer.</p>\n\n<pre><code>...\nWSABUF DataBuf;\nDataBuf.len = 0;\nDataBuf.buf = NULL;\n...\nrc = WSARecv(ConnSocket, &amp;DataBuf, 1, &amp;RecvBytes, &amp;Flags, &amp;RecvOverlapped, NULL);\n</code></pre>\n\n<p>However, I couldn't find anything in the documentation about that so I am a bit worried. Is this common practice and safe to do?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1564570585, "post_id": 57289130, "comment_id": 101072822, "body": "Welcome to stackoverflow.com. Please take some time to read <a href=\"http://stackoverflow.com/help\">the help pages</a>, especially the sections named <a href=\"http://stackoverflow.com/help/on-topic\">&quot;What topics can I ask about here?&quot;</a> and <a href=\"http://stackoverflow.com/help/dont-ask\">&quot;What types of questions should I avoid asking?&quot;</a>. Also please <a href=\"http://stackoverflow.com/tour\">take the tour</a> and <a href=\"http://stackoverflow.com/help/how-to-ask\">read about how to ask good questions</a>. Lastly please read <a href=\"https://codeblog.jonskeet.uk/2012/11/24/stack-overflow-question-checklist/\" rel=\"nofollow noreferrer\">this question checklist</a>."}, {"owner": {"reputation": 4522, "user_id": 5157478, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bBcym.png?s=128&g=1", "display_name": "Frankie_C", "link": "https://stackoverflow.com/users/5157478/frankie-c"}, "edited": false, "score": 2, "creation_date": 1564571721, "post_id": 57289130, "comment_id": 101073488, "body": "These are questions from homework or an interview"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 4522, "user_id": 5157478, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bBcym.png?s=128&g=1", "display_name": "Frankie_C", "link": "https://stackoverflow.com/users/5157478/frankie-c"}, "edited": false, "score": 0, "creation_date": 1564573622, "post_id": 57289130, "comment_id": 101074562, "body": "@Frankie_C: What is your point? Neither of this is off topic for Stack Overflow."}, {"owner": {"reputation": 4522, "user_id": 5157478, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bBcym.png?s=128&g=1", "display_name": "Frankie_C", "link": "https://stackoverflow.com/users/5157478/frankie-c"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1564573966, "post_id": 57289130, "comment_id": 101074757, "body": "@EricPostpischil I thought that we don&#39;t do homework here, but the question can be interpreted as a request of better explanation maybe."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 4522, "user_id": 5157478, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bBcym.png?s=128&g=1", "display_name": "Frankie_C", "link": "https://stackoverflow.com/users/5157478/frankie-c"}, "edited": false, "score": 0, "creation_date": 1564574090, "post_id": 57289130, "comment_id": 101074818, "body": "@Frankie_C: <a href=\"https://meta.stackoverflow.com/questions/334822/how-do-i-ask-and-answer-homework-questions\">Asking about homework is fine.</a> <a href=\"https://stackoverflow.com/help/on-topic\">It is explicitly mentioned in the help on \u201cWhat topics can I ask about here?\u201d</a>"}, {"owner": {"reputation": 1, "user_id": 11863270, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-WyGx-hVx9YI/AAAAAAAAAAI/AAAAAAAAACI/rrs_UkNh_hE/photo.jpg?sz=128", "display_name": "RAMUDU RAMUDU", "link": "https://stackoverflow.com/users/11863270/ramudu-ramudu"}, "reply_to_user": {"reputation": 4522, "user_id": 5157478, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bBcym.png?s=128&g=1", "display_name": "Frankie_C", "link": "https://stackoverflow.com/users/5157478/frankie-c"}, "edited": false, "score": 0, "creation_date": 1564723557, "post_id": 57289130, "comment_id": 101131501, "body": "@Frankie_C .. yes i am expected better explanation..// thanks for your tricky doubt about this!!!!!!"}], "answers": [{"comments": [{"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 1, "creation_date": 1564573711, "post_id": 57289242, "comment_id": 101074605, "body": "The scope of the name of a \u201cglobal\u201d object is the translation unit in which it is declared (starting from the declaration, ending at the end of the translation unit). It is not the entire program. The same name can be declared in multiple translation units, and the names are made to refer to the same object through linkage, but each instance has a different scope, in the different translation units."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1564573812, "post_id": 57289242, "comment_id": 101074670, "body": "Although the C standard does not specify how memory is laid out by an implementation and how objects are stored, there are <b>overwhelmingly</b> common methods used, and it is important that students learn these and how they affect program behavior. Answers to such inquiries ought to teach these methods, not spurn the questions based on technicalities."}], "tags": [], "owner": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "is_accepted": false, "score": 0, "last_activity_date": 1564570857, "creation_date": 1564570857, "answer_id": 57289242, "question_id": 57289130, "link": "https://stackoverflow.com/questions/57289130/memory-segment-allocation-for-global-and-local-pointer-variables-in-c/57289242#57289242", "title": "Memory Segment allocation for global and local Pointer Variables in C", "body": "<p>Q1 &amp; 2) There is no concept of <em>stack</em> in the C standards. Also, the location where the different variable types are stored is <strong>implementation dependent</strong></p>\n\n<p>Q3) A local pointer will hold the address of global variables (if assigned correctly). Taking the value of this pointer, you can access global variables.</p>\n\n<p>Q4) Global variables have a scope throughout the entire program. They can be accessed from anywhere. They also have a lifetime of the entire program. </p>\n"}, {"comments": [{"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1564588262, "post_id": 57290002, "comment_id": 101083575, "body": "Yes, C kind of specifies a stack of activation records but it is nowhere said that it need to be contiguous memory or that they need to be cleaned inside out. In fact the C standard does not rule out closures or different cleanup order either - an implementation that has closures would conform to the specs."}], "tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": false, "score": 1, "last_activity_date": 1565110953, "last_edit_date": 1565110953, "creation_date": 1564573529, "answer_id": 57290002, "question_id": 57289130, "link": "https://stackoverflow.com/questions/57289130/memory-segment-allocation-for-global-and-local-pointer-variables-in-c/57290002#57290002", "title": "Memory Segment allocation for global and local Pointer Variables in C", "body": "<p>1) Most commonly, C implementations store regular local objects of functions on a stack. (The C standard permits any implementation that achieves the required effects.<sup>1</sup>)</p>\n\n<p>2) Most commonly, C implementations use a general data segment for global objects. Such data segments are created by the program loader from information in the executable file. There are various formats for executable files, but they commonly contain segments with read-only data, segments with data that will be writeable in the program but that has initial values, and segments for data that will be writeable but that is initialized to zero or perhaps uninitialized. The software that loads the program into memory in preparation for execution reads the executable file, requests memory from the operating system, and lays out all the segments. (Again, the C standard permits any implementation that achieves the required effects.)</p>\n\n<p>3) A local pointer can refer to a global object because they share a single address space within the process. The local and global objects are merely put in different places within the address space, not in different spaces.</p>\n\n<p>4) The scope of the name of a global object is the translation unit in which its declaration appears, starting at the place where it is declared and extending to the end of the translation unit. (A translation unit is a source file along with any other files it includes with the <code>#include</code> directive.)</p>\n\n<h2>Footnote</h2>\n\n<p><sup>1</sup> Some people make a hullabaloo of the C standard not requiring a stack. However, the C standard does specify stack semantics for function calls: The behavior of objects local to functions is last-in-first-out, which is the behavior of a stack. Because a hardware stack provides the required features of a stack data structure and hence matches the needs of the C standard, it is the natural way to implement function calls and their objects. Aside from the fact that optimization may actually eliminate local objects or put them in registers instead of memory, essentially the only time you would see a C implementation without a stack is in a very constrained special-purpose environment.</p>\n"}], "owner": {"reputation": 1, "user_id": 11863270, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-WyGx-hVx9YI/AAAAAAAAAAI/AAAAAAAAACI/rrs_UkNh_hE/photo.jpg?sz=128", "display_name": "RAMUDU RAMUDU", "link": "https://stackoverflow.com/users/11863270/ramudu-ramudu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 262, "favorite_count": 0, "closed_date": 1564579797, "answer_count": 2, "score": -2, "last_activity_date": 1565110953, "creation_date": 1564570496, "last_edit_date": 1564574031, "question_id": 57289130, "link": "https://stackoverflow.com/questions/57289130/memory-segment-allocation-for-global-and-local-pointer-variables-in-c", "closed_reason": "Needs more focus", "title": "Memory Segment allocation for global and local Pointer Variables in C", "body": "<p>Can you please clarify below questions.</p>\n\n<p>1) Where is the memory segment of local pointer located. e.g. where is p located in <code>int main () { int *p; }</code></p>\n\n<p>2) Where is the memory location for the global pointer variable?.</p>\n\n<p>3) How can local pointer variable access the global variables in case of different memory segments?</p>\n\n<p>4) global pointer variables, what is the scope and how can use it??</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1564569603, "post_id": 57288800, "comment_id": 101072284, "body": "Use an <code>uintptr_t</code> variable to store the address, and pass the pointer with suitable casting?"}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 2, "creation_date": 1564569606, "post_id": 57288800, "comment_id": 101072286, "body": "If you don&#39;t want to write your own function, you could just use <code>printf(&quot;%p\\n&quot;, addr)</code>."}, {"owner": {"reputation": 33, "user_id": 11785248, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df2ae68c53cbd58f3c18a18d07f21f6e?s=128&d=identicon&r=PG&f=1", "display_name": "pikl", "link": "https://stackoverflow.com/users/11785248/pikl"}, "edited": false, "score": 1, "creation_date": 1564569723, "post_id": 57288800, "comment_id": 101072346, "body": "i have to write my own fonction , it for a exercise i can only use write, thank you"}, {"owner": {"reputation": 33, "user_id": 11785248, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df2ae68c53cbd58f3c18a18d07f21f6e?s=128&d=identicon&r=PG&f=1", "display_name": "pikl", "link": "https://stackoverflow.com/users/11785248/pikl"}, "edited": false, "score": 1, "creation_date": 1564569763, "post_id": 57288800, "comment_id": 101072370, "body": "i manage to make it work , i use a convertion, i send it with (unsigned int)temp and it worked thanks you all ;D"}, {"owner": {"reputation": 2354, "user_id": 9428851, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-MBhDff_bdY0/AAAAAAAAAAI/AAAAAAAACAY/lx7DUTjS350/photo.jpg?sz=128", "display_name": "Victor Gubin", "link": "https://stackoverflow.com/users/9428851/victor-gubin"}, "edited": false, "score": 1, "creation_date": 1564569778, "post_id": 57288800, "comment_id": 101072380, "body": "Simply use the <a href=\"http://www.cplusplus.com/reference/cstdio/printf/\" rel=\"nofollow noreferrer\">printf</a> <code>%p</code> parameter and this is it <code>printf(&quot;0x%p \\n&quot;, str);</code>. In any case, any pointer is actually adderess value i.e. <code>unsigned long</code> or <code>unsigned long long</code> depending on the CPU and OS. There is a typedef type <code>size_t</code> defined by your C library which holds the exact type. So you can use  <code>size_t address = (size_t)str;</code> to obtain the address value from pointer."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 2354, "user_id": 9428851, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-MBhDff_bdY0/AAAAAAAAAAI/AAAAAAAACAY/lx7DUTjS350/photo.jpg?sz=128", "display_name": "Victor Gubin", "link": "https://stackoverflow.com/users/9428851/victor-gubin"}, "edited": false, "score": 0, "creation_date": 1564570419, "post_id": 57288800, "comment_id": 101072744, "body": "@VictorGubin &quot; typedef type size_t defined by your C library which holds the exact type&quot; --&gt; No -<code>size_t</code> is not specified to be sufficient.  Perhaps you are thinking of <code>uintptr_t</code> for object pointers?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1564571909, "post_id": 57288800, "comment_id": 101073583, "body": "Note: <code>write(1, &amp;hexa[nbr], 1);</code> could be surprisingly replaced with <code>write(1, &quot;0123456789abcdef&quot; + nbr, 1);</code>"}, {"owner": {"reputation": 2354, "user_id": 9428851, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-MBhDff_bdY0/AAAAAAAAAAI/AAAAAAAACAY/lx7DUTjS350/photo.jpg?sz=128", "display_name": "Victor Gubin", "link": "https://stackoverflow.com/users/9428851/victor-gubin"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1564573061, "post_id": 57288800, "comment_id": 101074251, "body": "@chux If we check the <a href=\"https://en.cppreference.com/w/cpp/types/size_t\" rel=\"nofollow noreferrer\">doc</a> <code>std::size_t can safely store the value of any non-member pointer, in which case it is synonymous with std::uintptr_t. </code>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 2354, "user_id": 9428851, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-MBhDff_bdY0/AAAAAAAAAAI/AAAAAAAACAY/lx7DUTjS350/photo.jpg?sz=128", "display_name": "Victor Gubin", "link": "https://stackoverflow.com/users/9428851/victor-gubin"}, "edited": false, "score": 0, "creation_date": 1564573368, "post_id": 57288800, "comment_id": 101074418, "body": "@VictorGubin  Note this post is tagged C.  C does not defined itself in terms of C++.  The quote was also couched with a restriction. &quot;On many platforms (an exception is systems with segmented addressing) std::size_t can safely store the value of any non-member pointer, in which case it is synonymous with std::uintptr_t.&quot;, so <code>size_t</code> is not sufficient <i>in general</i>."}], "answers": [{"comments": [{"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1564720780, "post_id": 57289272, "comment_id": 101130787, "body": "Won&#39;t be better to allow for negative values?  just to define <code>size</code> as a <code>signed int</code> ???  You will need a copy of the loop body to process the remaining up to 15 bytes in case size is not a multiple of 16 (you are forgetting processing the tail block)"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1564757967, "post_id": 57289272, "comment_id": 101148066, "body": "@LuisColorado <code>ft_print_memory()</code> is not printing the contents of memory, but a pointer value for every increment of 16.  The &quot;in between&quot; 15 bytes are not of concern."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1564758079, "post_id": 57289272, "comment_id": 101148128, "body": "@LuisColorado  A signed type is not required - so is not better, just trading one set of problems for another.  It would have prevented the infinite loop coding trap of this learner code.  Using <code>int</code> instead of <code>unsigned</code> is a problem is extreme case of <code>size &gt; INT_MAX</code>.  I would have coded <code>int ft_print_memory(const void *addr, size_t size)</code>"}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1564770123, "post_id": 57289272, "comment_id": 101153267, "body": "I know.  I&#39;m preparing some code to illustrate.... but you have to wait for it to be ready :)"}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 2, "last_activity_date": 1564571368, "last_edit_date": 1592644375, "creation_date": 1564570957, "answer_id": 57289272, "question_id": 57288800, "link": "https://stackoverflow.com/questions/57288800/how-to-send-a-char-address-to-a-function-so-it-prints-in-hexa/57289272#57289272", "title": "How to send a char* address to a function so it prints in hexa", "body": "<blockquote>\n<p>the compiler doesn't let me convert it to <code>unsigned int</code>.</p>\n<p>i manage to make it work , i use a convertion, i send it with <code>(unsigned int)temp</code> and it worked</p>\n</blockquote>\n<p>Explicitly converting to an integer type is a good first step.  &quot;compiler doesn't let me convert &quot; implies your compiler is well enabled - good.</p>\n<p>C provides<sup>1</sup> <code>(u)intptr_t</code> as an integer type sufficient to convert a <code>void *</code> to a integer and back to an equivalent pointer.  <code>unsigned</code> may be too narrow and lose valuable information.</p>\n<p>Avoid signed types in this code.<br />\n<code>write(1, &amp;hexa[nbr], 1);</code> will be a problem when <code>nbr &lt; 0</code>.</p>\n<pre><code>// void    convhexa(int nbr)\n// void    printaddr(unsigned int addr)\n\n#include &lt;stdint.h&gt;\nvoid convhexa(uintptr_t nbr)\nvoid printaddr(uintptr_t addr)\n</code></pre>\n<hr />\n<p>The below is precarious code.  It is an infiniite loop when <code>size</code> is not a multiple of 16.</p>\n<pre><code>unsigned int size\n...\nwhile (size &gt; 0) {\n    printaddr(temp);\n    temp += 16;\n    size -= 16;\n}\n</code></pre>\n<p>Suggest <code>while (size &gt;= 16)</code></p>\n<hr />\n<p><sup>1</sup> These are optional types.  Few modern compilers do not provide these types.</p>\n"}, {"tags": [], "owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "is_accepted": false, "score": 0, "last_activity_date": 1564779763, "last_edit_date": 1564779763, "creation_date": 1564777947, "answer_id": 57333102, "question_id": 57288800, "link": "https://stackoverflow.com/questions/57288800/how-to-send-a-char-address-to-a-function-so-it-prints-in-hexa/57333102#57333102", "title": "How to send a char* address to a function so it prints in hexa", "body": "<p>to print the address, just use a <code>%p</code> format in your <code>printf(3)</code> routine.  It is used with pointers, and prints the value in hexadecimal.</p>\n\n<pre><code>ssize_t print_string_with_offset(const char* s)\n{\n    int c;\n    ssize_t res =\n        printf(\"%08p[\", s);  /* the address (w. 8 hex digits) */\n    /* now print the chars of the string up (but not including) the final '\\0' */\n    while ((c = *s++) != 0)\n        res += printf(\" %02x\", c &amp; 0xff);  /* each char with 2 hex digits */\n    res += printf(\"]\\n\");\n    return res;\n}\n</code></pre>\n\n<p>If you want a more elaborate hex printing routine, you can use a version write to illustrate how to print hex buffers <a href=\"https://github.com/mojadita/fprintbuf.git\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}], "owner": {"reputation": 33, "user_id": 11785248, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df2ae68c53cbd58f3c18a18d07f21f6e?s=128&d=identicon&r=PG&f=1", "display_name": "pikl", "link": "https://stackoverflow.com/users/11785248/pikl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 208, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1564779763, "creation_date": 1564569333, "last_edit_date": 1564569525, "question_id": 57288800, "link": "https://stackoverflow.com/questions/57288800/how-to-send-a-char-address-to-a-function-so-it-prints-in-hexa", "title": "How to send a char* address to a function so it prints in hexa", "body": "<p>I have an exercise to do, I need to print the beginning of the address of my string, so to speak the <code>[0]</code> position.<br>\nI use a function that will write it in the right format <code>00000hexahexa</code>, but I don't know how to send the address to the function, so it becomes a int.</p>\n\n<p>Here is my code, the main function is at the bottom, <code>size</code> is the number of characters in the string.</p>\n\n<p>I try to send the address to the function <code>printaddr</code>, but the compiler doesn't let me convert it to <code>unsigned int</code>.</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>void    convhexa(int nbr)\n{\n    char *hexa;\n\n    hexa = \"0123456789abcdef\";\n    if (nbr &gt; 15)\n    {\n        convhexa(nbr / 16);\n        convhexa(nbr % 16);\n    }\n    else\n        write(1, &amp;hexa[nbr], 1);\n}\n\nvoid    printaddr(unsigned int addr)\n{\n    int count;\n    unsigned int nbr;\n\n    nbr = addr;\n    count = 0;\n    while (nbr &gt; 0)\n    {\n        nbr /= 16;\n        count++;\n    }\n    while (count++ &lt; 15)\n        write(1, \"0\", 1);\n    convhexa(addr);\n    write(1, \": \", 2);\n}\n\nvoid    *ft_print_memory(void *addr, unsigned int size)\n{\n    char *temp;\n\n    temp = addr;\n    while (size &gt; 0)\n    {\n        printaddr(temp);\n        temp += 16;\n        size -= 16;\n    }\n    return (addr);\n}\n</code></pre>\n"}, {"tags": ["c", "posix", "function-pointers", "c11", "function-prototypes"], "comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 2, "creation_date": 1564572194, "post_id": 57288730, "comment_id": 101073762, "body": "You&#39;ll probably get a better response if you replace some of your tags with the &quot;C&quot; and &quot;language-lawyer&quot; tags, especially the &quot;C&quot; tag."}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 2, "creation_date": 1564574111, "post_id": 57288730, "comment_id": 101074829, "body": "Your question vague on what equivalence you are interested in, and some of the code is presumably hidden behind external links. Please write simple <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> so we can see exactly what the answer should be."}, {"owner": {"reputation": 1765, "user_id": 1106540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45196b9a98daeb606ee718a26e881b9b?s=128&d=identicon&r=PG", "display_name": "Ismael Luceno", "link": "https://stackoverflow.com/users/1106540/ismael-luceno"}, "reply_to_user": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1564574578, "post_id": 57288730, "comment_id": 101075093, "body": "@user694733 thanks, I should add some more code... I thought it way obvious, but maybe not."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1564575929, "post_id": 57288730, "comment_id": 101075814, "body": "Please post a MRE as suggested by the previous comment.  <code>void *</code> and <code>struct X *</code> are not compatible types.  glibc is written to be compiled by gcc, it makes no pretense at being portable or standard-conforming"}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1564576171, "post_id": 57288730, "comment_id": 101075963, "body": "I added declarations of <code>readdir</code> and <code>opendir</code> to clarify the question. If there is a mistake, please edit or rollback the question."}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1564579795, "post_id": 57288730, "comment_id": 101078190, "body": "<code>The readdirfunc declaration can&#39;t be prototyped</code> this is a strange comment from openssh-portable/glob.c . A simple <code>static struct direcnt * conv_readdir_to_proper_pointer(void *pnt) { return readdit(pnt); }</code> would suffice to handle the pointer. They could even <code>while ((dp = (pglob-&gt;gl_flags &amp; GLOB_ALTDIRFUNC) ? pglob-&gt;gl_readdir(dirp) : readdir(dirp)))</code>."}], "answers": [{"comments": [{"owner": {"reputation": 1765, "user_id": 1106540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45196b9a98daeb606ee718a26e881b9b?s=128&d=identicon&r=PG", "display_name": "Ismael Luceno", "link": "https://stackoverflow.com/users/1106540/ismael-luceno"}, "edited": false, "score": 0, "creation_date": 1564577414, "post_id": 57290940, "comment_id": 101076722, "body": "This answer avoids to explain <i>why</i>, you just assert they&#39;re incompatible, but where&#39;s the proof? proving that is a lot easier than proving they&#39;re compatible, just a counterexample does."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "reply_to_user": {"reputation": 1765, "user_id": 1106540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45196b9a98daeb606ee718a26e881b9b?s=128&d=identicon&r=PG", "display_name": "Ismael Luceno", "link": "https://stackoverflow.com/users/1106540/ismael-luceno"}, "edited": false, "score": 2, "creation_date": 1564578315, "post_id": 57290940, "comment_id": 101077271, "body": "@IsmaelLuceno If the quoted text from section 6.7.5.3 is not sufficient, please explain what exactly would qualify as &quot;proof&quot; to you. In language-lawyer questions, that is usually the kind of proof we go for."}, {"owner": {"reputation": 1765, "user_id": 1106540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45196b9a98daeb606ee718a26e881b9b?s=128&d=identicon&r=PG", "display_name": "Ismael Luceno", "link": "https://stackoverflow.com/users/1106540/ismael-luceno"}, "edited": false, "score": 0, "creation_date": 1564580341, "post_id": 57290940, "comment_id": 101078532, "body": "well, basically that you actually can implement a valid compiler where <code>void*</code> and <code>struct*</code> can not be exchanged succesfully..."}], "tags": [], "owner": {"reputation": 28131, "user_id": 1956010, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bfdcb4596e9da98cccbf9a0069fdff6c?s=128&d=identicon&r=PG", "display_name": "nwellnhof", "link": "https://stackoverflow.com/users/1956010/nwellnhof"}, "is_accepted": false, "score": 2, "last_activity_date": 1564576737, "creation_date": 1564576737, "answer_id": 57290940, "question_id": 57288730, "link": "https://stackoverflow.com/questions/57288730/struct-vs-void-funtion-prototype-equivalence-in-c11-c99/57290940#57290940", "title": "(struct *) vs (void *) -- Funtion prototype equivalence in C11/C99", "body": "<p>From the C99 standard, <em>6.7.5.1 Pointer declarators:</em></p>\n\n<blockquote>\n  <p>For two pointer types to be compatible, both shall be identically qualified and both shall be pointers to compatible types. </p>\n</blockquote>\n\n<p>So <code>void *</code> and <code>DIR *</code> aren't compatible.</p>\n\n<p>From <em>6.7.5.3 Function declarators (including prototypes):</em></p>\n\n<blockquote>\n  <p>For two function types to be compatible, both shall specify compatible return types. Moreover, the parameter type lists, if both are present, shall agree in the number of parameters and in use of the ellipsis terminator; corresponding parameters shall have compatible types.</p>\n</blockquote>\n\n<p>So <code>struct dirent *(*)(void *)</code> (the type of <code>gl_readdir</code>) nd <code>struct dirent *(*)(DIR *)</code> (the type of <code>readdir</code>) aren't compatible.</p>\n\n<p>From <em>6.3.2.3 Pointers:</em></p>\n\n<blockquote>\n  <p>A pointer to a function of one type may be converted to a pointer to a function of another type and back again; the result shall compare equal to the original pointer. If a converted pointer is used to call a function whose type is not compatible with the pointed-to type, the behavior is undefined.</p>\n</blockquote>\n\n<p>So</p>\n\n<pre><code>gl_readdir = (struct dirent *(*)(void *))readdir;\ngl_readdir(x);\n</code></pre>\n\n<p>is undefined behavior.</p>\n"}, {"tags": [], "owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "is_accepted": false, "score": 1, "last_activity_date": 1564576789, "creation_date": 1564576789, "answer_id": 57290961, "question_id": 57288730, "link": "https://stackoverflow.com/questions/57288730/struct-vs-void-funtion-prototype-equivalence-in-c11-c99/57290961#57290961", "title": "(struct *) vs (void *) -- Funtion prototype equivalence in C11/C99", "body": "<p><code>struct x*</code> and <code>struct y*</code> for any two <code>x</code> and <code>y</code> are guaranteed to have the same representation and alignment requirements, same for <code>union</code> pointers, but not void pointers and struct pointers:</p>\n\n<p><a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.2.5p28\" rel=\"nofollow noreferrer\">http://port70.net/~nsz/c/c11/n1570.html#6.2.5p28</a></p>\n\n<blockquote>\n  <p>A pointer to void shall have the same representation and alignment\n  requirements as a pointer to a character type.48) Similarly, pointers\n  to qualified or unqualified versions of compatible types shall have\n  the same representation and alignment requirements. All pointers to\n  structure types shall have the same representation and alignment\n  requirements as each other. All pointers to union types shall have the\n  same representation and alignment requirements as each other. Pointers\n  to other types need not have the same representation or alignment\n  requirements.</p>\n</blockquote>\n\n<p>Furthermore, same representation and alignment requirements of a function type's \"subtypes\" isn't enough. For a call through a function pointer to be defined, the function pointer's target type must be compatible with the actual function's type and for function compatibility, strict compatibility between corresponding function arguments is required, which means that technically e.g., <code>void foo(char*);</code> is <em>not</em> compatible with <code>void foo(char const*);</code> even if <code>char*</code> and <code>char const*</code> have the same representation and alignment. </p>\n\n<p><a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.7.6.3p15\" rel=\"nofollow noreferrer\">http://port70.net/~nsz/c/c11/n1570.html#6.7.6.3p15</a></p>\n\n<blockquote>\n  <p>For two function types to be compatible, both shall specify compatible\n  return types.146) Moreover, the parameter type lists, if both are\n  present, shall agree in the number of parameters and in use of the\n  ellipsis terminator; corresponding parameters shall have compatible\n  types. If one type has a parameter type list and the other type is\n  specified by a function declarator that is not part of a function\n  definition and that contains an empty identifier list, the parameter\n  list shall not have an ellipsis terminator and the type of each\n  parameter shall be compatible with the type that results from the\n  application of the default argument promotions. If one type has a\n  parameter type list and the other type is specified by a function\n  definition that contains a (possibly empty) identifier list, both\n  shall agree in the number of parameters, and the type of each\n  prototype parameter shall be compatible with the type that results\n  from the application of the default argument promotions to the type of\n  the corresponding identifier. (In the determination of type\n  compatibility and of a composite type, each parameter declared with\n  function or array type is taken as having the adjusted type and each\n  parameter declared with qualified type is taken as having the\n  unqualified version of its declared type.)</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 1765, "user_id": 1106540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45196b9a98daeb606ee718a26e881b9b?s=128&d=identicon&r=PG", "display_name": "Ismael Luceno", "link": "https://stackoverflow.com/users/1106540/ismael-luceno"}, "edited": false, "score": 0, "creation_date": 1564577962, "post_id": 57291017, "comment_id": 101077059, "body": "please see the comments, I wasn&#39;t asking for a workaround, I was asking if this kind of hack is reliable because some standard specifies it in some way, even if obscure."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "reply_to_user": {"reputation": 1765, "user_id": 1106540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45196b9a98daeb606ee718a26e881b9b?s=128&d=identicon&r=PG", "display_name": "Ismael Luceno", "link": "https://stackoverflow.com/users/1106540/ismael-luceno"}, "edited": false, "score": 1, "creation_date": 1564578018, "post_id": 57291017, "comment_id": 101077089, "body": "@IsmaelLuceno I believe I am saying that this kind of hack is <i>not</i> to be relied on."}, {"owner": {"reputation": 1765, "user_id": 1106540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45196b9a98daeb606ee718a26e881b9b?s=128&d=identicon&r=PG", "display_name": "Ismael Luceno", "link": "https://stackoverflow.com/users/1106540/ismael-luceno"}, "edited": false, "score": 0, "creation_date": 1564578404, "post_id": 57291017, "comment_id": 101077318, "body": "well, that&#39;s a trivial guess I would have been happy with if I were lazy, but I&#39;m here to find out if it&#39;s just a widespread bug or it is in fact something reliable :-P."}, {"owner": {"reputation": 1765, "user_id": 1106540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45196b9a98daeb606ee718a26e881b9b?s=128&d=identicon&r=PG", "display_name": "Ismael Luceno", "link": "https://stackoverflow.com/users/1106540/ismael-luceno"}, "edited": false, "score": 0, "creation_date": 1564578430, "post_id": 57291017, "comment_id": 101077336, "body": "you have to admit the reduced indirection is desirable."}, {"owner": {"reputation": 1765, "user_id": 1106540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45196b9a98daeb606ee718a26e881b9b?s=128&d=identicon&r=PG", "display_name": "Ismael Luceno", "link": "https://stackoverflow.com/users/1106540/ismael-luceno"}, "edited": false, "score": 0, "creation_date": 1564578616, "post_id": 57291017, "comment_id": 101077450, "body": "also, again, this <i>is being used</i> by several implementations."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "reply_to_user": {"reputation": 1765, "user_id": 1106540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45196b9a98daeb606ee718a26e881b9b?s=128&d=identicon&r=PG", "display_name": "Ismael Luceno", "link": "https://stackoverflow.com/users/1106540/ismael-luceno"}, "edited": false, "score": 3, "creation_date": 1564578863, "post_id": 57291017, "comment_id": 101077599, "body": "@IsmaelLuceno My honest opinion is that all of those implementations are buggy, and also that there isn&#39;t anything more we, collectively, can quote at you; everything I might have said but didn&#39;t appears to be covered by the other answers."}], "tags": [], "owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "is_accepted": true, "score": 3, "last_activity_date": 1564577413, "last_edit_date": 1564577413, "creation_date": 1564576982, "answer_id": 57291017, "question_id": 57288730, "link": "https://stackoverflow.com/questions/57288730/struct-vs-void-funtion-prototype-equivalence-in-c11-c99/57291017#57291017", "title": "(struct *) vs (void *) -- Funtion prototype equivalence in C11/C99", "body": "<p>Considering ISO C alone: <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.3.2.3\" rel=\"nofollow noreferrer\">section 6.3.2.3</a> specifies which casts among pointer types are required not to lose information:</p>\n\n<blockquote>\n  <ul>\n  <li>A pointer to any object type may be converted to a pointer to void and back again; the result shall compare equal to the original pointer.</li>\n  <li>A pointer to an object type may be converted to a pointer to a different object type. If the resulting pointer is not correctly aligned for the referenced type, the behavior is undefined. Otherwise, when converted back again, the result shall compare equal to the original pointer.</li>\n  <li>A pointer to a function of one type may be converted to a pointer to a function of another type and back again; the result shall compare equal to the original pointer. <em>If a converted pointer is used to call a function whose type is not compatible with the referenced type, the behavior is undefined.</em></li>\n  </ul>\n</blockquote>\n\n<p>(emphasis mine) So, let's look at your code again, adding in some of the declarations from <code>dirent.h</code>:</p>\n\n<pre><code>struct dirent;\ntypedef /* opaque */ DIR;\nextern struct dirent *readdir (DIR *);\n\nstruct dirent *(*gl_readdir)(void *);\ngl_readdir = (struct dirent *(*)(void *))readdir;\nDIR *x = /* ... */;\nstruct dirent *y = gl_readdir(x);\n</code></pre>\n\n<p>This casts a function pointer of type <code>struct dirent *(*)(DIR *)</code> to a function pointer of type <code>struct dirent *(*)(void *)</code> and then calls the converted pointer.  Those two function pointer types are not compatible (in most cases, two types must be exactly the same to be \"compatible\"; there are a bunch of exceptions but none of them apply here) so the code has undefined behavior.</p>\n\n<p>I want to emphasize that \"they have basically the same storage/representation/alignment requirements\" is NOT enough to avoid undefined behavior.  The infamous <a href=\"https://stackoverflow.com/questions/42178179/will-casting-around-sockaddr-storage-and-sockaddr-in-break-strict-aliasing/42190913\"><code>sockaddr</code> mess</a> involves types with the same representation and alignment requirements, and even the same initial common subsequence, but <code>struct sockaddr</code> and <code>struct sockaddr_in</code> are still not compatible types, and reading the <code>sa_family</code> field of a <code>struct sockaddr</code> that was cast from a <code>struct sockaddr_in</code> is still undefined behavior.</p>\n\n<p>In the general case, to avoid undefined behavior due to incompatible function pointer types, you have to write \"glue\" functions that convert back from <code>void *</code> to whatever concrete type is expected by the underlying procedure:</p>\n\n<pre><code>static struct dirent *\ngl_readdir_glue (void *closure)\n{\n    return readdir((DIR *)closure);\n}\n\ngl_readdir = gl_readdir_glue;\n</code></pre>\n\n<p><code>GLOB_ALTDIRFUNC</code> is a GNU extension.  <a href=\"https://www.gnu.org/software/libc/manual/html_node/Calling-Glob.html\" rel=\"nofollow noreferrer\">Its specification</a> was clearly (to me, anyway) written back in the days when nobody worried about the compiler optimizing based on the assumption that undefined behavior could never occur, so I do not think you should assume that the compiler will Do What You Mean with <code>gl_readdir = (struct dirent *(*)(void *))readdir;</code>  If you are writing code that uses <code>GLOB_ALTDIRFUNC</code>, write the glue functions.</p>\n\n<p>If you are <em>implementing</em> <code>GLOB_ALTDIRFUNC</code>, just store the <code>void *</code> you get from the <code>gl_opendir</code> hook in a variable of type <code>void *</code>, and pass it directly to the <code>gl_readdir</code> and <code>gl_closedir</code> hooks.  Don't try to guess what the caller wants it to be.</p>\n\n<hr>\n\n<p><strong>EDIT:</strong> The code in the link is, in fact, an implementation of <code>glob</code>.  What it does is reduce the <em>non</em>-<code>GLOB_ALTDIRFUNC</code> case to the <code>GLOB_ALTDIRFUNC</code> case by setting the hooks itself.  And it doesn't have the glue functions I recommended, it has <code>gl_readdir = (struct dirent *(*)(void *))readdir;</code>  I wouldn't have done it that way, but is true that this particular class of undefined behavior is unlikely to cause problems with the compilers and optimization levels that are typically used for C library implementations.</p>\n"}], "owner": {"reputation": 1765, "user_id": 1106540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45196b9a98daeb606ee718a26e881b9b?s=128&d=identicon&r=PG", "display_name": "Ismael Luceno", "link": "https://stackoverflow.com/users/1106540/ismael-luceno"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 258, "favorite_count": 0, "accepted_answer_id": 57291017, "answer_count": 3, "score": 3, "last_activity_date": 1564584525, "creation_date": 1564569128, "last_edit_date": 1564584525, "question_id": 57288730, "link": "https://stackoverflow.com/questions/57288730/struct-vs-void-funtion-prototype-equivalence-in-c11-c99", "title": "(struct *) vs (void *) -- Funtion prototype equivalence in C11/C99", "body": "<p>I was trying to implement <code>GLOB_ALTDIRFUNC</code> last night, and tripped into an interesting question.</p>\n\n<p>While maybe slightly semantically different, are <code>(void *)</code> and <code>(struct *)</code> types equivalent?</p>\n\n<p>Example code:</p>\n\n<pre><code>typedef struct __dirstream DIR;\nstruct dirent *readdir(DIR *);\nDIR *opendir(const char *);\n...\nstruct dirent *(*gl_readdir)(void *);\nvoid *(*gl_opendir)(const char *);\n...\ngl_readdir = (struct dirent *(*)(void *))readdir;\ngl_opendir = (void *(*)(const char *))opendir;\n...\nDIR *x = gl_opendir(\".\");\nstruct dirent *y = gl_readdir(x);\n...\n</code></pre>\n\n<p>My intuition says so; they have basically the same storage/representation/alignment requirements; and they should be equivalent for arguments and return type.</p>\n\n<p>Sections <em>6.2.5 (Types)</em> and <em>6.7.6.3 (Function declarators (including prototypes))</em> of the <a href=\"http://www.open-std.org/jtc1/sc22/WG14/www/docs/n1256.pdf\" rel=\"nofollow noreferrer\">c99 standard</a> and the <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf\" rel=\"nofollow noreferrer\">c11 standard</a> seem to confirm this.</p>\n\n<p>So the following implementation should in theory work:</p>\n\n<ul>\n<li><a href=\"https://www.openwall.com/lists/musl/2019/07/30/8\" rel=\"nofollow noreferrer\">https://www.openwall.com/lists/musl/2019/07/30/8</a></li>\n</ul>\n\n<p>Now I see similar things being done in BSD and GNU libc code, which is interesting.</p>\n\n<p>Are the equivalence of these conversions a result of an implementation artifact from the compilers, or it is a fundamental restriction/property that can be inferred from the standard's specification?</p>\n\n<p>Does this result in undefined behavior?</p>\n\n<p>@nwellnhof said:</p>\n\n<blockquote>\n  <p>For two pointer types to be compatible, both shall be identically\n  qualified and both shall be pointers to compatible types.</p>\n</blockquote>\n\n<p>Ok, this is the key. How can <code>(void *)</code> and <code>(struct *)</code> be incompatible?</p>\n\n<blockquote>\n  <p>From 6.3.2.3 Pointers:\n      A pointer to a function of one type may be converted to a pointer to a function of another type and back again; the result shall compare\n  equal to the original pointer. If a converted pointer is used to call\n  a function <strong>whose type is not compatible</strong> with the pointed-to type, the\n  behavior is undefined.</p>\n</blockquote>\n\n<p>Not yet determined.</p>\n\n<p>Further clarification:</p>\n\n<ul>\n<li>Structs depend on their first element for alignment, so alignment requirements for a struct pointer should be the same as for void pointers, right?</li>\n<li>I didn't initially specify <code>DIR</code> anywhere, but it's guaranteed to be a struct.</li>\n<li>The whole point of the question is to know if I can avoid wrappers (like the one I did for gl_closedir, whose type is clearly incompatible).</li>\n<li>While this may not be allowed by C11/C99, it is in practice used by BSD and GNU system code, so maybe some other relevant standard, e.g. POSIX, specifies the behavior.</li>\n</ul>\n\n<p>Examples in the wild, in this very feature:</p>\n\n<ul>\n<li><a href=\"https://github.com/openssh/openssh-portable/blob/master/openbsd-compat/glob.c#L736\" rel=\"nofollow noreferrer\">OpenBSD glob.c</a></li>\n<li><a href=\"https://github.com/lattera/glibc/blob/master/posix/glob.h#L89\" rel=\"nofollow noreferrer\">glibc glob.h</a> (ABI shouldn't change, controlled by <code>_GNU_SOURCE</code> -> <code>__USE_GNU</code>).</li>\n</ul>\n\n<p>So, my thoughts so far are:</p>\n\n<ul>\n<li>I can't think of any reason you can't exchange a <code>(struct *)</code> with a <code>(void *)</code>, and the other way around.</li>\n<li>A <code>struct</code> would have the alignment of the first element, and this could be a <code>char</code> so requirements of a pointer are exactly the same as for <code>void</code> pointers.</li>\n<li>So a <code>struct</code> pointer should have the same implementation requirements as a <code>void</code> pointer, which is further reinforced by the requirement for all <code>struct</code> pointers to be equivalent.</li>\n<li>So <code>(const void *)</code> should be equivalent to <code>(const struct *)</code></li>\n<li>and <code>(void *)</code> should be equivalent to <code>(struct *)</code></li>\n<li>and so on with all special attributes.</li>\n</ul>\n"}, {"tags": ["python", "c", "python-embedding"], "comments": [{"owner": {"reputation": 1173, "user_id": 5226792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/khMGh.jpg?s=128&g=1", "display_name": "Wonka", "link": "https://stackoverflow.com/users/5226792/wonka"}, "edited": false, "score": 0, "creation_date": 1564569369, "post_id": 57288617, "comment_id": 101072161, "body": "To comunicate data, I suggest to use JSON standard. Maybe on read you have to cast some value to desired variable type"}, {"owner": {"reputation": 1, "user_id": 11856694, "user_type": "registered", "profile_image": "https://graph.facebook.com/157706265397073/picture?type=large", "display_name": "Subhra Bera", "link": "https://stackoverflow.com/users/11856694/subhra-bera"}, "reply_to_user": {"reputation": 1173, "user_id": 5226792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/khMGh.jpg?s=128&g=1", "display_name": "Wonka", "link": "https://stackoverflow.com/users/5226792/wonka"}, "edited": false, "score": 0, "creation_date": 1564636199, "post_id": 57288617, "comment_id": 101097451, "body": "I do not have experience of working with JSON. And when I am calling the method the call is happening but the problem is it i going iside first if block of above function definition."}], "owner": {"reputation": 1, "user_id": 11856694, "user_type": "registered", "profile_image": "https://graph.facebook.com/157706265397073/picture?type=large", "display_name": "Subhra Bera", "link": "https://stackoverflow.com/users/11856694/subhra-bera"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 71, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1564773225, "creation_date": 1564568766, "last_edit_date": 1564773225, "question_id": 57288617, "link": "https://stackoverflow.com/questions/57288617/how-to-send-python-list-to-a-c-array-of-string-and-to-a-c-array-of-long-integers", "title": "How to send python list to a C array of string and to a C array of long integers?", "body": "<p>I have tried to send a python list to a C array of string/integers. And I tried to print the array of string but it is printing nothing.</p>\n\n<p>I am actually writing code to extract data from a .csv file by using Python and trying to send this data to a C code.  When I am trying to run the code I am getting some warning. </p>\n\n<p>I am calling this function from <code>main(){}</code> like <code>string_arr_conversion(NULL,pFunc)</code>, but I am not able to see any print and I am getting the warning which below explained.</p>\n\n<p>I have debugged and found that <code>if(!PyArg_ParseTuple(args, \"o\", &amp;str_arr)) {retun NULL;}</code> when I am calling the function the above if block returning null.</p>\n\n<pre><code>#include &lt;Python.h&gt;\n\nstatic PyObject *string_arr_conversion(PyObject *self,PyObject *args){\n    PyObject *str_arr;\n    int i;\n    if(!PyArg_ParseTuple(args, \"o\", &amp;str_arr)){\n        retun NULL;\n    }\n    int n=PyObject_Length(str_arr);\n        if(n&lt;0) {\n            return NULL;\n        }\n    char arr[n][40];\n    for(i=0; i&lt;n;i++){\n        PyObject *str=PyList_GetItem(str_arr,i);\n        arr[i][40]=PyLong_FromString(str,NULL,10);\n    }\n    for(i = 0; i&lt;n; i++){\n        printf(\"\\n Element is %c\", arr[i]);\n    }\n    return arr;\n}\n</code></pre>\n\n<p>I am getting the following warnings:  </p>\n\n<pre><code>1.In string_err_conversion function passing argument 1 of 'PyLong_FromString' from incompatible pointer type.  \nnote: expected 'char *' but argument is of type 'struct PyObject *'  \nassignment makes integer from pointer without cast.{here            arr[i][MAX_STRING_SIZE]=PyLong_FromString(str,NULL,10); warnings are coming}  \n2.return from incompatible pointer type and function returns address of local variable.{In this line ::return arr;}\n</code></pre>\n"}, {"tags": ["c", "mpi"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1564568248, "post_id": 57288376, "comment_id": 101071543, "body": "For any pointer or array <code>p</code> and index <code>i</code>, the expression <code>*(p + i)</code> is <i>exactly</i> equal to <code>p[i]</code>. Now think about <code>*(send + sizeof(float)) = 2</code> a little more, and why using array-indexing syntax is recommended (besides being less to write)."}], "answers": [{"tags": [], "owner": {"reputation": 3, "user_id": 11847882, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c27cc954f2299cf05505d6a244e1792?s=128&d=identicon&r=PG", "display_name": "Juan", "link": "https://stackoverflow.com/users/11847882/juan"}, "is_accepted": false, "score": 0, "last_activity_date": 1564568776, "creation_date": 1564568776, "answer_id": 57288623, "question_id": 57288376, "link": "https://stackoverflow.com/questions/57288376/sending-the-address-content-with-mpi-send/57288623#57288623", "title": "Sending the address content with mpi_send", "body": "<p>I'm sorry, after spend almost 3 hours I realized that </p>\n\n<pre><code>*(send + sizeof(float))=2\n</code></pre>\n\n<p>Must be</p>\n\n<pre><code>*(send + 1) = 2;\n</code></pre>\n\n<p>And the same thing to the recv function. \nI thought that moving along the array you have to increase de address memory calculating the size, but this is only if you are using a void pointer. If you declare as a float pointer, the program knows how big is that size.</p>\n"}], "owner": {"reputation": 3, "user_id": 11847882, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c27cc954f2299cf05505d6a244e1792?s=128&d=identicon&r=PG", "display_name": "Juan", "link": "https://stackoverflow.com/users/11847882/juan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 69, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1564568776, "creation_date": 1564567951, "last_edit_date": 1564568126, "question_id": 57288376, "link": "https://stackoverflow.com/questions/57288376/sending-the-address-content-with-mpi-send", "title": "Sending the address content with mpi_send", "body": "<p>I'm writing a program which sends to every process an array of 2 numbers.\nI did't ok with array notation. The problem is that if I want to use pointer notation with an address memory allocated with malloc, I can't access to the second element. \nIn this example the program sends an array with pointer notation which contains the numbers 1 and 2 to every process. Then the root prints the received message. Thanks</p>\n\n<pre><code>#include \"stdio.h\"\n#include \"stdlib.h\"\n#include \"mpi.h\"\n\nint main(int argc, char *argv[])\n{\n\n    float *send = malloc(sizeof(float) * 2);\n    float *recv = malloc(sizeof(float) * 2);\n\n/*\n    float send2[2], recv2[2];\n    send2[0] = 1;\n    send2[1] = 2;\n*/\n\n    int rank, size;\n\n    MPI_Init(&amp;argc, &amp;argv);\n    MPI_Comm_size(MPI_COMM_WORLD, &amp;size);\n    MPI_Comm_rank(MPI_COMM_WORLD, &amp;rank);\n    *(send) = 1;\n    *(send + sizeof(float)) = 2;\n    MPI_Send(send, 2, MPI_FLOAT, 0, 99, MPI_COMM_WORLD);\n\n    if (rank == 0)\n    {\n\n        for (int i = 0; i &lt; size; i++)\n        {\n            MPI_Recv(recv, 2, MPI_FLOAT, i, 99, MPI_COMM_WORLD, MPI_STATUS_IGNORE);\n            printf(\"[%f][%f]\\n\", *(recv), *(recv + sizeof(float)));\n            //printf(\"[%f][%f]\\n\", recv2[0], recv2[1]);\n        }\n    }\n\n    MPI_Finalize();\n    return 0;\n}\n</code></pre>\n\n<p>This is the result</p>\n\n<pre><code>juan@um18:~/Documentos/EjemplosMPI$ mpirun -np 4 ejecutables/ex\n[1.000000][0.000000]\n[1.000000][0.000000]\n[1.000000][0.000000]\n[1.000000][0.000000]\n</code></pre>\n"}, {"tags": ["c++", "c", "linux", "samba"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1564697264, "post_id": 57287741, "comment_id": 101126550, "body": "What is Dolphin in this context?"}, {"owner": {"reputation": 136, "user_id": 6412806, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fSC3n.png?s=128&g=1", "display_name": "42LeapsOfFaith", "link": "https://stackoverflow.com/users/6412806/42leapsoffaith"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1564717470, "post_id": 57287741, "comment_id": 101130087, "body": "Dolphin in this context is KDE&#39;s version of Windows Explorer."}, {"owner": {"reputation": 349, "user_id": 4198124, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eEgbZ.png?s=128&g=1", "display_name": "Oren Kishon", "link": "https://stackoverflow.com/users/4198124/oren-kishon"}, "edited": false, "score": 0, "creation_date": 1573653988, "post_id": 57287741, "comment_id": 103952025, "body": "By \u201csmb://sharename\u201d you mean  \u201csmb://server/sharename\u201d? And why can&#39;t you use the server hostname in your program instead of the explicit IP?"}], "owner": {"reputation": 136, "user_id": 6412806, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fSC3n.png?s=128&g=1", "display_name": "42LeapsOfFaith", "link": "https://stackoverflow.com/users/6412806/42leapsoffaith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 124, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1565309666, "creation_date": 1564565992, "last_edit_date": 1565309666, "question_id": 57287741, "link": "https://stackoverflow.com/questions/57287741/how-to-find-refresh-local-network-samba-shares-on-a-linux-computer-with-c-c", "title": "How to find/refresh local network SAMBA Shares on a Linux computer with C/C++", "body": "<p>I am writing a c++ program on a Linux (KDE) computer that accesses files on a SAMBA share in a local network. However, I\u2019m finding that if the ip address lease expires the connection to the SAMBA share is lost.</p>\n\n<p>If I type \u201csmb://sharename\u201d into the address bar of Dolphin, it causes the system to renew the ip address and my connection can be resumed.</p>\n\n<p>My question is \u2013 what c or c++ functions can I call to provide the same outcome as Dolphin?</p>\n"}, {"tags": ["c", "printf", "scanf"], "comments": [{"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 6975, "user_id": 3121023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f52448806175b9aa66c86d40cf0829f1?s=128&d=identicon&r=PG&f=1", "display_name": "user3121023", "link": "https://stackoverflow.com/users/3121023/user3121023"}, "edited": false, "score": 0, "creation_date": 1564566581, "post_id": 57287666, "comment_id": 101070527, "body": "@user3121023 It is invalid for scanf. It is valid for printf."}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1564566763, "post_id": 57287666, "comment_id": 101070637, "body": "@KamilCuk Yes, &#39;*&#39; is an assignment suppressing character. I did not see it.:)"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1564566826, "post_id": 57287666, "comment_id": 101070670, "body": "The <code>34</code> input does not belong to the first input, becuase it was halted at two characters. That&#39;s the point of the restriction <code>%2d</code> - so that the 3rd and 4th characters do not belong with it. No input is <b>forgotten</b>: if it is in the input buffer, it remains there until it is read."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1564568228, "post_id": 57287666, "comment_id": 101071533, "body": "vijay_ky Tip: post text as text, not as a picture.  Text as pictures attracts down-votes."}, {"owner": {"reputation": 39, "user_id": 6018563, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-s-uTlmxZ9d0/AAAAAAAAAAI/AAAAAAAAAIs/KJ3b11CIz-0/photo.jpg?sz=128", "display_name": "vijay_ky", "link": "https://stackoverflow.com/users/6018563/vijay-ky"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1564568234, "post_id": 57287666, "comment_id": 101071534, "body": "@chux yes %2d upto 2 characters and thanks for information on not to post text as image"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1564586640, "post_id": 57287666, "comment_id": 101082679, "body": "Note (1) <a href=\"https://stackoverflow.com/questions/19499060/what-is-difference-between-scanfd-and-scanfd\">Trailing white space in a format string</a> and (2) <a href=\"https://stackoverflow.com/questions/5240789/scanf-leaves-the-new-line-char-in-buffer\"><code>scanf()</code> leaves the newline in the input buffer</a>."}], "answers": [{"tags": [], "owner": {"reputation": 864, "user_id": 11767915, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WVlF1.jpg?s=128&g=1", "display_name": "I&#39;m Limit", "link": "https://stackoverflow.com/users/11767915/im-limit"}, "is_accepted": false, "score": 0, "last_activity_date": 1564566770, "creation_date": 1564566770, "answer_id": 57287994, "question_id": 57287666, "link": "https://stackoverflow.com/questions/57287666/spacing-in-d-for-inputs-for-scanf/57287994#57287994", "title": "spacing in %d for inputs for scanf", "body": "<p>%2d will get <code>2 lengths decimal</code> when you in put.</p>\n\n<p><strong>If you try this...</strong></p>\n\n<pre><code>int x,y;\n/* type  : 1234 */\nscanf(\"%2d %d\", &amp;x &amp;y);\n/* var x : 12   */\nprintf(\"%d %d\", x,y);\n/* input : 12 34  */\n</code></pre>\n\n<p><strong>Or this?</strong></p>\n\n<pre><code>int x,y;\n/* type  : 1 234 */\nscanf(\"%2d %d\", &amp;x &amp;y);\n/* var x : 1   */\nprintf(\"%d %d\", x,y);\n/* input : 1 234   */\n</code></pre>\n\n<p>Then if you get limited length\nIt will record as next conversion character</p>\n\n<p>and it depent on your space to!</p>\n"}, {"comments": [{"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 0, "creation_date": 1564571437, "post_id": 57288102, "comment_id": 101073313, "body": "It might be worth noting that <code>&quot;%d %d&quot;</code> and <code>&quot;%d%d&quot;</code> (<code>scanf</code> format specifier) behave exactly the same."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 1, "creation_date": 1564571609, "post_id": 57288102, "comment_id": 101073422, "body": "@pmg True.  Surprising, to me, <code>&quot;%d&quot;</code> will consume leading white-space even if the conversion fails."}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 1, "last_activity_date": 1564568521, "last_edit_date": 1564568521, "creation_date": 1564567152, "answer_id": 57288102, "question_id": 57287666, "link": "https://stackoverflow.com/questions/57287666/spacing-in-d-for-inputs-for-scanf/57288102#57288102", "title": "spacing in %d for inputs for scanf", "body": "<blockquote>\n  <p>spacing in %d for inputs for scanf</p>\n</blockquote>\n\n<p>In <code>scanf()</code> format a <code>\" \"</code> never fails.  It scans for <em>optional</em> white-space.</p>\n\n<blockquote>\n  <p>why 34 is applied to the second conversion character ?</p>\n</blockquote>\n\n<p><code>\"%2d\"</code> consumes the <code>12</code> of input.  The 2 in the format limits input to 2 characters: <code>1</code> and <code>2</code>. <a href=\"https://stackoverflow.com/questions/57287666/spacing-in-d-for-inputs-for-scanf/57288102#comment101070670_57287666\">@Weather Vane</a><br>\n<code>\" \"</code> scans for spaces and sees none in the input.  Scanning continues.  <code>\"%d\"</code> scans in <code>34</code>.</p>\n\n<blockquote>\n  <p>can I include space, tab, newline in the scanf? what happens?</p>\n</blockquote>\n\n<p>Yes.  A whites-space in the scan format matches 0 or more input white-space.<sup>1</sup>  </p>\n\n<blockquote>\n  <p><code>scanf(\"% d %    d%s\",var1, var2, var3);</code>  is this fine?</p>\n</blockquote>\n\n<p>No.  <code>\"% d\"</code> is not a valid <code>scanf()</code> conversion specifier.</p>\n\n<blockquote>\n  <p>result expected: 12 elephant  </p>\n</blockquote>\n\n<p>This is curious. <code>printf(\"%d  %d  %s\", x, y, text);</code> would print <em>something</em> out for <code>y</code>.  This is no <em>nothing</em> value for an <code>int</code>.</p>\n\n<hr>\n\n<p>Tip: good code checks the return value from <code>scanf()</code>.</p>\n\n<pre><code>if (scanf(\"%2d %d %*f %5s\", &amp;x, &amp;y, text) == 3) {\n  printf(\"%d  %d  %s\", x, y, text);\n} else {\n  puts(\"Bad input\");\n} \n</code></pre>\n\n<p>Better code does not use <code>scanf()</code>, but <code>fgets()</code>.  Far easier to handle errant input.</p>\n\n<hr>\n\n<p><sup>1</sup>White-space in a <code>\"%[]\"</code> specifier is handled different though.  It needs an exact match.</p>\n"}], "owner": {"reputation": 39, "user_id": 6018563, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-s-uTlmxZ9d0/AAAAAAAAAAI/AAAAAAAAAIs/KJ3b11CIz-0/photo.jpg?sz=128", "display_name": "vijay_ky", "link": "https://stackoverflow.com/users/6018563/vijay-ky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 127, "favorite_count": 0, "closed_date": 1564591375, "answer_count": 2, "score": 0, "last_activity_date": 1564568521, "creation_date": 1564565734, "last_edit_date": 1564568301, "question_id": 57287666, "link": "https://stackoverflow.com/questions/57287666/spacing-in-d-for-inputs-for-scanf", "closed_reason": "Not suitable for this site", "title": "spacing in %d for inputs for scanf", "body": "<p><a href=\"https://i.stack.imgur.com/DAJGC.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/DAJGC.png\" alt=\"sololearn\"></a>1. If I give the input <code>1234 5.7 elephant</code> will give the resulting output\n<code>12  34  eleph</code> I know that * means it ignores the input field, %2d is up to 2 character will be considered. but why 34 is applied to the second conversion character %d it belongs to the first %d?<br>\n2. Can I include space, tab, newline in the scanf? what happens?\n<code>scanf(\"% d %    d%s\",var1, var2, var3);//</code>is this fine?</p>\n\n<pre><code>/* input: 1234  5.7  elephant */\n/* output: 12  34  eleph */\n</code></pre>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main() {\n    int x, y;\n    char text[20];\n\n    scanf(\"%2d %d %*f %5s\", &amp;x, &amp;y, text);\n    /* input: 1234  5.7  elephant */\n    printf(\"%d  %d  %s\", x, y, text);\n    /* output: 12  34  eleph */\n\n    return 0;\n} \n</code></pre>\n\n<p>result expected: 12 elephant</p>\n"}, {"tags": ["c", "sockets", "pointers", "struct", "raw-sockets"], "answers": [{"comments": [{"owner": {"reputation": 543, "user_id": 4776754, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/11d1d01327ec9b99568f9dddc9369584?s=128&d=identicon&r=PG&f=1", "display_name": "Aniruddha", "link": "https://stackoverflow.com/users/4776754/aniruddha"}, "edited": false, "score": 0, "creation_date": 1564567926, "post_id": 57288033, "comment_id": 101071360, "body": "Thank you for your assistance. Since ipheader is stored in beginning of buffer, is there a way to see/print those values or print values from buffer?"}, {"owner": {"reputation": 623, "user_id": 2491350, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/21b00afe3f3ab6235649f62a35132ac7?s=128&d=identicon&r=PG", "display_name": "SilverTear", "link": "https://stackoverflow.com/users/2491350/silvertear"}, "reply_to_user": {"reputation": 543, "user_id": 4776754, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/11d1d01327ec9b99568f9dddc9369584?s=128&d=identicon&r=PG&f=1", "display_name": "Aniruddha", "link": "https://stackoverflow.com/users/4776754/aniruddha"}, "edited": false, "score": 0, "creation_date": 1564568306, "post_id": 57288033, "comment_id": 101071574, "body": "You could easily just do printf(&quot;%d&quot;, ip-&gt;iph_chksum); for any field in  ip. If you want to get them from buffer, you can do that, but you need to know the offset of the field inside the struct. There are several ways to do this. See <a href=\"https://stackoverflow.com/questions/18749349/finding-offset-of-a-structure-element-in-c\" title=\"finding offset of a structure element in c\">stackoverflow.com/questions/18749349/&hellip;</a>. You could always just cast the buffer to struct ipheader and just use that"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1564571282, "post_id": 57288033, "comment_id": 101073220, "body": "<code>struct ipheader *ip = (struct ipheader *) buffer;</code> violates strict aliasing and can also result in undefined behavior due to misaligned object(s)."}, {"owner": {"reputation": 623, "user_id": 2491350, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/21b00afe3f3ab6235649f62a35132ac7?s=128&d=identicon&r=PG", "display_name": "SilverTear", "link": "https://stackoverflow.com/users/2491350/silvertear"}, "edited": false, "score": 2, "creation_date": 1564572126, "post_id": 57288033, "comment_id": 101073726, "body": "It seemed very fishy code to me as well. But I wasn&#39;t aware of such a rule. I would have just combined everything in a single struct and then cast this to a char array instead of concatenating different structs inside a char array."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 2, "creation_date": 1564572504, "post_id": 57288033, "comment_id": 101073938, "body": "@SilverTear That&#39;s because it is fishy code that&#39;s likely to fail on platforms that aren&#39;t forgiving of misaligned accesses."}], "tags": [], "owner": {"reputation": 623, "user_id": 2491350, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/21b00afe3f3ab6235649f62a35132ac7?s=128&d=identicon&r=PG", "display_name": "SilverTear", "link": "https://stackoverflow.com/users/2491350/silvertear"}, "is_accepted": true, "score": 3, "last_activity_date": 1564567475, "last_edit_date": 1564567475, "creation_date": 1564566890, "answer_id": 57288033, "question_id": 57287466, "link": "https://stackoverflow.com/questions/57287466/type-casting-struct-pointer/57288033#57288033", "title": "Type casting struct pointer", "body": "<p>You understanding is correct. The pointer *ip will point to buffer. char buffer[PCKT_LEN] is an array of size sizeof(char) * PCKT_LEN. Since a char is usually 1 byte long it is just a chunk of memory of PCKT_LEN bytes. PCKT_LEN is defined to be 8192</p>\n\n<p>The amount of bytes needed to store a struct ipheader is much less than this. Try <code>int a = sizeof(ipheader)</code> and use a debugger to see the value assigned to <code>a</code>. For me it is 24 bytes, but it could be slightly different for you. This means that buffer can hold much more data than the struct ipheader needs. I haven't looked to deeply into the code, and I don't know much about socket programming. But one use for this could be to augment buffer with additional data outside of the struct. Since you know struct ipheader takes up sizeof(ipheader) bytes you will have sizeof(char)*8192 - sizeof(ipheader) left to augment the array. </p>\n\n<p>Edit: \nUpun further inspection, this is kinda what is happening:</p>\n\n<pre><code>struct ipheader *ip = (struct ipheader *) buffer;\nstruct udpheader *udp = (struct udpheader *) (buffer + sizeof(struct ipheader));\n</code></pre>\n\n<p>It tries to store the ip header at the beginning of the buffer, then it augments that same buffer with an udp header. By using <code>buffer + sizeof(struct ipheader)</code>\nit makes sure that it stores the udp header <em>after</em> ipheader by offsetting buffer by sizeof(struct ipheader) bytes. Basically <code>struct ipheader *ip</code> points to the beginning of the buffer and <code>struct udpheader *udp</code> points to <code>buffer + sizeof(struct ipheader)</code>. I hope this makes sense. Obviously there is still a lot of space left over in buffer so you could potentially augment it even further.</p>\n"}, {"tags": [], "owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "is_accepted": false, "score": 2, "last_activity_date": 1564571133, "creation_date": 1564571133, "answer_id": 57289328, "question_id": 57287466, "link": "https://stackoverflow.com/questions/57287466/type-casting-struct-pointer/57289328#57289328", "title": "Type casting struct pointer", "body": "<blockquote>\n  <p>how a char array is cast into struct pointer</p>\n</blockquote>\n\n<p>You can't do that safely.  The code invokes undefined behavior:</p>\n\n<pre><code>char buffer[PCKT_LEN];\nstruct ipheader *ip = (struct ipheader *) buffer;\n//some code here\nip-&gt;iph_ihl = 5;\nip-&gt;iph_ver = 4;\nip-&gt;iph_tos = 16;\n</code></pre>\n\n<p>That code violates <a href=\"https://stackoverflow.com/questions/98650/what-is-the-strict-aliasing-rule\">the strict aliasing rule</a>.  That basically means memory that isn't a certain type of object can't be treated as being that type of object, with the exception that any non-<code>char</code> object can be treated as an array of <code>char</code>.</p>\n\n<p>That's not what's happening in the posted code.  In the posted code, a <code>char</code> array is being treated as if it were a <code>struct ipheader</code>.</p>\n\n<p>The memory is not a <code>struct ipheader</code> - it's an array of <code>char</code> - so the code violates strict aliasing.</p>\n\n<p>The casting from <code>char *</code> to <code>struct ipheader *</code> can also result in an improperly aligned object and violate <a href=\"https://port70.net/~nsz/c/c11/n1570.html#6.3.2.3p7\" rel=\"nofollow noreferrer\"><strong>6.3.2.3 Pointers</strong>, paragraph 7</a>:</p>\n\n<blockquote>\n  <p>A pointer to an object type may be converted to a pointer to a different object type. If the resulting pointer is not correctly aligned for the referenced type, the behavior is undefined. ...</p>\n</blockquote>\n\n<p>Code such as you've found here is unfortunately all too common as the x86-based machines that are the most common platform widely used by programmers are very forgiving of misaligned accesses, so such code tends to \"work\".</p>\n\n<p>See <a href=\"https://stackoverflow.com/questions/19114491/structure-assignment-in-linux-fails-in-arm-but-succeeds-in-x86\">Structure assignment in Linux fails in ARM but succeeds in x86</a> for an example of a platform where it doesn't work.</p>\n"}], "owner": {"reputation": 543, "user_id": 4776754, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/11d1d01327ec9b99568f9dddc9369584?s=128&d=identicon&r=PG&f=1", "display_name": "Aniruddha", "link": "https://stackoverflow.com/users/4776754/aniruddha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 223, "favorite_count": 0, "accepted_answer_id": 57288033, "answer_count": 2, "score": 1, "last_activity_date": 1564571133, "creation_date": 1564565105, "question_id": 57287466, "link": "https://stackoverflow.com/questions/57287466/type-casting-struct-pointer", "title": "Type casting struct pointer", "body": "<p>I'm trying to get into Socket programming and came across an article at <a href=\"https://www.tenouk.com/Module43a.html\" rel=\"nofollow noreferrer\">https://www.tenouk.com/Module43a.html</a> I'm having difficulty understanding as how a char array is cast into struct pointer</p>\n\n<pre><code>char buffer[PCKT_LEN];\nstruct ipheader *ip = (struct ipheader *) buffer;\n//some code here\nip-&gt;iph_ihl = 5;\nip-&gt;iph_ver = 4;\nip-&gt;iph_tos = 16;\n</code></pre>\n\n<p>As per my understanding, pointer ip will now hold the address of buffer and values for members of struct ipheader will now be stored in buffer. Please help understanding the same. If I'm right, then how would we be able to print values stored in buffer?</p>\n"}, {"tags": ["c", "linux", "background-process"], "comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1564574776, "post_id": 57287385, "comment_id": 101075190, "body": "The posted code will also fail to properly handle input if it&#39;s invoked with a file as input, as with <code>app &lt; input.txt</code>.  In that case, <code>read()</code> will fill <code>bufferUserInput</code> entirely and your code will then discard that input because <code>n</code> will equal <code>sizeOfBuffer</code>.  Also, <code>read()</code> returns <code>ssize_t</code>, not <code>int</code>."}, {"owner": {"reputation": 335, "user_id": 9698161, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a2881d4f88da4ddcd701eccf723006f?s=128&d=identicon&r=PG&f=1", "display_name": "J.Panek", "link": "https://stackoverflow.com/users/9698161/j-panek"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1564575376, "post_id": 57287385, "comment_id": 101075526, "body": "A file will never be the input, its just there for short debug commands to read out values. You a right about the return value."}], "answers": [{"comments": [{"owner": {"reputation": 335, "user_id": 9698161, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a2881d4f88da4ddcd701eccf723006f?s=128&d=identicon&r=PG&f=1", "display_name": "J.Panek", "link": "https://stackoverflow.com/users/9698161/j-panek"}, "edited": false, "score": 0, "creation_date": 1564575471, "post_id": 57290238, "comment_id": 101075572, "body": "After the <code>read</code> I check the value of <code>n</code> and <code>errno</code> in the quick debug version. There I get n is: 0 and Errno: Success. I added the two debug lines in my code snippet"}, {"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "reply_to_user": {"reputation": 335, "user_id": 9698161, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a2881d4f88da4ddcd701eccf723006f?s=128&d=identicon&r=PG&f=1", "display_name": "J.Panek", "link": "https://stackoverflow.com/users/9698161/j-panek"}, "edited": false, "score": 0, "creation_date": 1564576106, "post_id": 57290238, "comment_id": 101075934, "body": "@J.Panek I made my snippet read 256 bytes just as your does (the change makes no difference in the behavior). When I compile and do <code>.&#47;a.out &amp;</code> I get <code>Stopped</code> if the <code>SIG_IGN</code> line is commented out and  <code>Input&#47;output error</code> otherwise. I never get return value <code>0</code> if the input is a terminal and the process is backgrounded. If you do, please post concrete steps on how to reproduce such behavior."}, {"owner": {"reputation": 335, "user_id": 9698161, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a2881d4f88da4ddcd701eccf723006f?s=128&d=identicon&r=PG&f=1", "display_name": "J.Panek", "link": "https://stackoverflow.com/users/9698161/j-panek"}, "edited": false, "score": 0, "creation_date": 1564577434, "post_id": 57290238, "comment_id": 101076736, "body": "The software on the embedded device is started via startup script in <code>&#47;etc&#47;init.d</code> it redirects <code>stdout</code> and <code>stderr</code> into two log files. I tested your code snippet with a <code>while(1)</code> around the read block and get the same behavior, i.e. my log file is full of <code>0</code> and the CPU load is at 100%"}], "tags": [], "owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "is_accepted": false, "score": 0, "last_activity_date": 1564575968, "last_edit_date": 1564575968, "creation_date": 1564574302, "answer_id": 57290238, "question_id": 57287385, "link": "https://stackoverflow.com/questions/57287385/prevent-read-systemcall-returing-with-0-when-run-as-background-process/57290238#57290238", "title": "Prevent read() systemcall returing with 0 when run as background process", "body": "<p><code>read()</code> doesn't return 0 when reading from the terminal in a backgrounded process.\nIt either continues to block while causing a <code>SIGTTIN</code> to be sent to the process (which may break the blocking and cause <code>retval=-1,errno=EINTR</code> to be returned or it causes <code>retval=-1, errno EIO</code> if <code>SIGTTIN</code> is ignore.</p>\n\n<p>The snippet below demonstrates this:</p>\n\n<pre><code>#include &lt;unistd.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;signal.h&gt;\nint main()\n{\n    char c[256];\n    ssize_t nr;\n\n    signal(SIGTTIN,SIG_IGN);\n    nr = read(0,&amp;c,sizeof(c));\n    printf(\"%zd\\n\", nr);\n    if(0&gt;nr) perror(0);\n    fflush(stdout);\n}\n</code></pre>\n\n<p>The code snippet you've shown can't possibly test reveal 0-returns since you never test for zero-ness in the return value.</p>\n"}, {"comments": [{"owner": {"reputation": 335, "user_id": 9698161, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a2881d4f88da4ddcd701eccf723006f?s=128&d=identicon&r=PG&f=1", "display_name": "J.Panek", "link": "https://stackoverflow.com/users/9698161/j-panek"}, "edited": false, "score": 0, "creation_date": 1564577556, "post_id": 57290588, "comment_id": 101076819, "body": "Thank you, this fixes my general problem but I&#39;m still wondering why <code>read</code> is returning with <code>0</code>. I tested @PSkocik code snippet and got the same result."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "reply_to_user": {"reputation": 335, "user_id": 9698161, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a2881d4f88da4ddcd701eccf723006f?s=128&d=identicon&r=PG&f=1", "display_name": "J.Panek", "link": "https://stackoverflow.com/users/9698161/j-panek"}, "edited": false, "score": 0, "creation_date": 1564577750, "post_id": 57290588, "comment_id": 101076932, "body": "<code>read</code> is returning with 0 because you are at the end of the file.  <code>read</code> only blocks after reading all available input when there <i>could</i> be more input in the future, which is possible for terminals, pipes, sockets, etc. but not for files nor for <code>&#47;dev&#47;null</code>."}], "tags": [], "owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "is_accepted": true, "score": 1, "last_activity_date": 1564577785, "last_edit_date": 1564577785, "creation_date": 1564575517, "answer_id": 57290588, "question_id": 57287385, "link": "https://stackoverflow.com/questions/57287385/prevent-read-systemcall-returing-with-0-when-run-as-background-process/57290588#57290588", "title": "Prevent read() systemcall returing with 0 when run as background process", "body": "<p>When <code>stdin</code> is not a terminal, <code>read</code> is returning with 0 because you are at the end of the file.  <code>read</code> only blocks after reading all available input when there <em>could</em> be more input in the future, which is considered to be possible for terminals, pipes, sockets, etc. but not for regular files nor for <code>/dev/null</code>.  (Yes, another process could make a regular file bigger, but that possibility isn't considered in the specification for <code>read</code>.)</p>\n\n<p>Ignoring the various problems with your read loop that other people have pointed out (which you should fix <em>anyway</em>, as this will make reading debug commands from the user more reliable) the simplest change to your code that will fix the problem you're having right now is: check on startup whether stdin is a terminal, and don't launch the debug thread if it isn't.  You do that with the <a href=\"http://man7.org/linux/man-pages/man3/isatty.3.html\" rel=\"nofollow noreferrer\"><code>isatty</code></a> function, declared in <code>unistd.h</code>.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n// ...\n\nint main(void)\n{\n    if (isatty(fileno(stdin)))\n      start_debug_thread();\n    // ...\n}\n</code></pre>\n\n<p>(Depending on your usage context, it might also make sense to run the debug thread when <code>stdin</code> is a pipe or a socket, but I would personally not bother, I would rely on <code>ssh</code> to provide a remote (pseudo-)terminal when necessary.)</p>\n"}, {"tags": [], "owner": {"reputation": 2385, "user_id": 10306503, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31c5d6c9b08dd045f4876591d703bda6?s=128&d=identicon&r=PG", "display_name": "mosvy", "link": "https://stackoverflow.com/users/10306503/mosvy"}, "is_accepted": false, "score": 2, "last_activity_date": 1564578138, "creation_date": 1564578138, "answer_id": 57291380, "question_id": 57287385, "link": "https://stackoverflow.com/questions/57287385/prevent-read-systemcall-returing-with-0-when-run-as-background-process/57291380#57291380", "title": "Prevent read() systemcall returing with 0 when run as background process", "body": "<p>If you start your program in the \"background\" (as <code>./program &amp;</code>) from a shell <em>script</em>, it's stdin will be redirected from <code>/dev/null</code> (with some <a href=\"https://unix.stackexchange.com/a/523516/308316\">exceptions</a>).</p>\n\n<p>Trying to read from <code>/dev/null</code> will always return 0 (EOF).</p>\n\n<p>Example (on linux):</p>\n\n<pre><code>sh -c 'ls -l /proc/self/fd/0 &amp; wait'\n... -&gt; /dev/null\n\nsh -c 'dd &amp; wait'\n... -&gt;  0 bytes copied, etc\n</code></pre>\n\n<p>The fix from the link above should also work for you:</p>\n\n<pre><code>#! /bin/sh\n...\nexec 3&lt;&amp;0\n./your_program &lt;&amp;3 &amp;\n...\n</code></pre>\n"}], "owner": {"reputation": 335, "user_id": 9698161, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a2881d4f88da4ddcd701eccf723006f?s=128&d=identicon&r=PG&f=1", "display_name": "J.Panek", "link": "https://stackoverflow.com/users/9698161/j-panek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 57290588, "answer_count": 3, "score": 0, "last_activity_date": 1564603590, "creation_date": 1564564844, "last_edit_date": 1564603590, "question_id": 57287385, "link": "https://stackoverflow.com/questions/57287385/prevent-read-systemcall-returing-with-0-when-run-as-background-process", "title": "Prevent read() systemcall returing with 0 when run as background process", "body": "<p>I have a piece of software that is able to read commands from stdin for debug purposes in a separate thread. When my software runs as foreground process <code>read</code> behaves as expected, its blocking and waits for input by the user, i.e the thread sleeps.\nWhen the software is run as a background process, <code>read</code> constantly returns <code>0</code> (possible EOF detected?).</p>\n\n<p>The problem here is, that this specific read is in a <code>while(true)</code> loop. It runs as fast as it can and steals precious CPU load on my embedded device.</p>\n\n<p>I tried redirecting <code>/dev/null</code> to the process but the behavior was the same. I am running my custom Linux on an ARM Cortex A5 board.</p>\n\n<p>The problematic piece of code follows and is run inside its own thread:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>char bufferUserInput[256];\nconst int sizeOfBuffer = SIZE_OF_ARRAY(bufferUserInput);\n\nwhile (1)\n{\n\n    int n = read(0, bufferUserInput, sizeOfBuffer); //filedes = 0 equals to reading from stdin\n    printf(\"n is: %d\\n\", n);\n    printf(\"Errno: %s\",strerror(errno));\n\n    if (n == 1)\n    {\n        continue;\n    }\n\n    if ((1 &lt; n)\n            &amp;&amp; (n &lt; sizeOfBuffer)\n            &amp;&amp; ('\\n' == bufferUserInput[n - 1]))\n    {\n        printf(\"\\r\\n\");\n        bufferUserInput[n - 1] = '\\0';\n        ProcessUserInput(&amp;bufferUserInput[0]);\n    } else\n    {\n        n = 0;\n    }\n}\n</code></pre>\n\n<p>I am looking for a way to prevent <code>read</code> from constantly returning when running in the background and wait for user input (which of course will never come).</p>\n"}, {"tags": ["c", "performance", "intel", "avx2", "fma"], "comments": [{"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 3, "creation_date": 1564564848, "post_id": 57287186, "comment_id": 101069477, "body": "x86 doesn&#39;t have integer FMA / MAC (multiply-accumulate) other than horizontal <code>pmaddubsw</code> / <code>pmaddwd</code>.  FP-contract options have nothing to do with integer stuff; integer math is always exact."}, {"owner": {"reputation": 361, "user_id": 2764478, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/75c03e9ad9b4ef0091f7a9da911a6445?s=128&d=identicon&r=PG&f=1", "display_name": "Rick", "link": "https://stackoverflow.com/users/2764478/rick"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1564565137, "post_id": 57287186, "comment_id": 101069640, "body": "@PeterCordes I don&#39;t understand. I am talking about vector instructions."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1564565530, "post_id": 57287186, "comment_id": 101069890, "body": "<code>[v]pmaddubsw</code> and <code>[v]pmaddwd</code> are SIMD SSE / AVX2 instructions.  I meant SIMD-integer, of course, not scalar in GP registers."}, {"owner": {"reputation": 361, "user_id": 2764478, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/75c03e9ad9b4ef0091f7a9da911a6445?s=128&d=identicon&r=PG&f=1", "display_name": "Rick", "link": "https://stackoverflow.com/users/2764478/rick"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1564568194, "post_id": 57287186, "comment_id": 101071512, "body": "@PeterCordes Thank you. I understand now. I don&#39;t understand though that when I use FMA approach why the clockcylces reduces"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1564601613, "post_id": 57287186, "comment_id": 101089556, "body": "What compiler options did you use?  Did you forget to enable optimization?  <code>gcc -O3 -march=native</code>.  Actually your compiler is way too old to know <code>-march=skylake</code> so <code>-march=native</code> won&#39;t properly set <code>-mtune</code> settings.  But anyway, there shouldn&#39;t be a difference after optimization."}, {"owner": {"reputation": 361, "user_id": 2764478, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/75c03e9ad9b4ef0091f7a9da911a6445?s=128&d=identicon&r=PG&f=1", "display_name": "Rick", "link": "https://stackoverflow.com/users/2764478/rick"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1564656511, "post_id": 57287186, "comment_id": 101107052, "body": "@PeterCordes I used  -mavx2 -O3 -mfma. After your comments I also added -march=native in gcc-6.5. And as you said it does not change anything."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1564658015, "post_id": 57287186, "comment_id": 101107876, "body": "Oh right, the compiler knows your arrays are aligned so the default tuning of splitting unaligned 256-bit loads/stores wouldn&#39;t be a problem here."}], "answers": [{"comments": [{"owner": {"reputation": 361, "user_id": 2764478, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/75c03e9ad9b4ef0091f7a9da911a6445?s=128&d=identicon&r=PG&f=1", "display_name": "Rick", "link": "https://stackoverflow.com/users/2764478/rick"}, "edited": false, "score": 0, "creation_date": 1564831947, "post_id": 57307720, "comment_id": 101164620, "body": "thank you for the illustrated answer. You have written &quot;you&#39;re also modifying the input arrays and this doesn&#39;t get optimized away&quot;, Can you please tell me what is the best way to update an AVX2 array like this. I appreciate your help."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 361, "user_id": 2764478, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/75c03e9ad9b4ef0091f7a9da911a6445?s=128&d=identicon&r=PG&f=1", "display_name": "Rick", "link": "https://stackoverflow.com/users/2764478/rick"}, "edited": false, "score": 0, "creation_date": 1564832442, "post_id": 57307720, "comment_id": 101164701, "body": "@Rick: Generally don&#39;t use arrays of <code>__m256d</code> in the first place, just use a few __m256d locals so they can be kept in registers.  And when you do have arrays (whether they hold <code>double</code> or <code>__m256d</code>), use a tmp var instead of modifying them unless you actually <i>want</i> that side effect."}], "tags": [], "owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "is_accepted": true, "score": 3, "last_activity_date": 1564657911, "creation_date": 1564657911, "answer_id": 57307720, "question_id": 57287186, "link": "https://stackoverflow.com/questions/57287186/how-to-use-fused-multiply-and-add-in-avx-for-16-bit-packed-integers/57307720#57307720", "title": "How to use fused multiply and add in AVX for 16 bit packed integers", "body": "<p>x86 doesn't have SIMD-integer FMA / MAC (multiply-accumulate) other than horizontal pmaddubsw / pmaddwd which add horizontal into wider integers.  (Until AVX512IFMA <a href=\"https://www.felixcloutier.com/x86/vpmadd52luq\" rel=\"nofollow noreferrer\"><code>_mm_madd52lo_epu64</code></a> or AVX512_4VNNIW <a href=\"https://www.felixcloutier.com/x86/vp4dpwssd\" rel=\"nofollow noreferrer\"><code>_mm512_4dpwssd_epi32(__m512i, __m512ix4, __m128i *)</code></a>).</p>\n\n<p>FP-contract and <code>-ffast-math</code> options have nothing to do with SIMD-integer stuff; integer math is always exact.</p>\n\n<hr>\n\n<p>I think your \"simple\" approach is slower because you're also modifying the input arrays and this doesn't get optimized away, e.g.</p>\n\n<pre><code>a0_avx[i] = _mm256_mullo_epi16(a0_avx[i], b0_avx[i]);\n</code></pre>\n\n<p>as well as updating <code>res_avx[i]</code>.</p>\n\n<p>If the compiler doesn't optimize that away, those extra stores might be exactly why it's slower than your <code>mul_add</code> function.  <code>rdtsc</code> without a serializing instruction doesn't even have to wait for earlier instructions to execute, let alone retire or commit stores to L1d cache, but extra uops for the front-end are still more to chew through.  At only 1 store per clock throughput, that could easily be a new bottleneck.</p>\n\n<hr>\n\n<p><strong>FYI, you don't need to copy your inputs to arrays of <code>__m256i</code></strong>.  Normally you'd just use SIMD loads on regular data.  That's no slower than indexing arrays of <code>__m256i</code>.  Your arrays are too big for the compiler to fully unroll and keep everything in registers (like it would for scalar <code>__m256i</code> variables).</p>\n\n<p>If you'd just used <code>__m256i a0 = _mm256_loadu_si256(...)</code> inside the loop then you could have updated <code>a0</code> without slowing your code down because it would just be a single local variable that can be kept in a YMM reg.</p>\n\n<p>But I find it's good style to use new named tmp vars for most steps to make code more self-documenting.  Like <code>__m256i ab = ...</code> or <code>sum = ...</code>.  You could reuse the same <code>sum</code> temporary for each <code>a0+b0</code> and <code>a1+b1</code>.</p>\n\n<p>You might also use a temporary for the result vector instead of making the compiler optimize away the updates of memory at <code>res_avx[i]</code> until the final one.</p>\n\n<p>You can use <code>alignas(32) int16_t a0[...];</code> to make plain arrays aligned for <code>_mm256_load</code> instead of <code>loadu</code>.</p>\n\n<hr>\n\n<p>Your <code>cpucycles()</code> RDTSC function doesn't need to use inline asm.  <a href=\"https://stackoverflow.com/questions/13772567/how-to-get-the-cpu-cycle-count-in-x86-64-from-c/51907627#51907627\">Use <code>__rdtsc()</code> instead.</a></p>\n"}], "owner": {"reputation": 361, "user_id": 2764478, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/75c03e9ad9b4ef0091f7a9da911a6445?s=128&d=identicon&r=PG&f=1", "display_name": "Rick", "link": "https://stackoverflow.com/users/2764478/rick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 564, "favorite_count": 0, "accepted_answer_id": 57307720, "answer_count": 1, "score": 0, "last_activity_date": 1564657911, "creation_date": 1564564317, "question_id": 57287186, "link": "https://stackoverflow.com/questions/57287186/how-to-use-fused-multiply-and-add-in-avx-for-16-bit-packed-integers", "title": "How to use fused multiply and add in AVX for 16 bit packed integers", "body": "<p>I know there it is possible to do multiply-and-add using a single instruction in AVX2. I want to use multiply-and-add instruction where each 256-bit AVX2 variable is packed with 16, 16-bit variables. For instance, consider the example below,</p>\n\n<blockquote>\n  <p>res=a0*b0+a1*b1+a2*b2+a3*b3</p>\n</blockquote>\n\n<p>here each of res, a0, a1, a2, a3, b0, b1, b2, b3 are 16-bit variables.\nI have closely followed the <a href=\"https://stackoverflow.com/questions/15933100/how-to-use-fused-multiply-add-fma-instructions-with-sse-avx\">discussion</a>. Please find my code below to calculate the example shown above,</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdint.h&gt;\n#include &lt;immintrin.h&gt;\n#include&lt;time.h&gt;\n#include \"cpucycles.c\"\n\n#pragma STDC FP_CONTRACT ON\n\n#define AVX_LEN 16\n\ninline __m256i mul_add(__m256i a, __m256i b, __m256i c) { \n    return _mm256_add_epi16(_mm256_mullo_epi16(a, b), c);\n}\n\nvoid fill_random(int16_t *a, int32_t len){  //to fill up the random array\n\n    int32_t i;\n\n    for(i=0;i&lt;len;i++){     \n        a[i]=(int16_t)rand()&amp;0xffff;\n    }\n}\n\nvoid main(){\n\n\n    int16_t a0[16*AVX_LEN], b0[16*AVX_LEN];\n    int16_t a1[16*AVX_LEN], b1[16*AVX_LEN];\n    int16_t a2[16*AVX_LEN], b2[16*AVX_LEN];\n    int16_t a3[16*AVX_LEN], b3[16*AVX_LEN];\n    int16_t res[16*AVX_LEN];\n\n\n    __m256i a0_avx[AVX_LEN], b0_avx[AVX_LEN];\n    __m256i a1_avx[AVX_LEN], b1_avx[AVX_LEN];\n    __m256i a2_avx[AVX_LEN], b2_avx[AVX_LEN];\n    __m256i a3_avx[AVX_LEN], b3_avx[AVX_LEN];\n\n    __m256i res_avx[AVX_LEN];\n\n    int16_t res_avx_check[16*AVX_LEN];\n    int32_t i,j;\n\n    uint64_t mask_ar[4]; //for unloading AVX variables\n    mask_ar[0]=~(0UL);mask_ar[1]=~(0UL);mask_ar[2]=~(0UL);mask_ar[3]=~(0UL);\n    __m256i mask;\n    mask = _mm256_loadu_si256 ((__m256i const *)mask_ar);\n\n    time_t t;\n    srand((unsigned) time(&amp;t));\n\n\n    int32_t repeat=100000;\n\n    uint64_t clock1, clock2, fma_clock;\n\n    clock1=clock2=fma_clock=0;\n\n    for(j=0;j&lt;repeat;j++){\n        printf(\"j : %d\\n\",j);\n\n        fill_random(a0,16*AVX_LEN);// Genrate random data\n        fill_random(a1,16*AVX_LEN);\n        fill_random(a2,16*AVX_LEN);\n        fill_random(a3,16*AVX_LEN);\n\n        fill_random(b0,16*AVX_LEN);\n        fill_random(b1,16*AVX_LEN);\n        fill_random(b2,16*AVX_LEN);\n        fill_random(b3,16*AVX_LEN);\n\n\n        for(i=0;i&lt;AVX_LEN;i++){ //Load values in AVX variables\n\n            a0_avx[i] = _mm256_loadu_si256 ((__m256i const *) (&amp;a0[i*16]));\n            a1_avx[i] = _mm256_loadu_si256 ((__m256i const *) (&amp;a1[i*16]));\n            a2_avx[i] = _mm256_loadu_si256 ((__m256i const *) (&amp;a2[i*16]));\n            a3_avx[i] = _mm256_loadu_si256 ((__m256i const *) (&amp;a3[i*16]));\n\n            b0_avx[i] = _mm256_loadu_si256 ((__m256i const *) (&amp;b0[i*16]));\n            b1_avx[i] = _mm256_loadu_si256 ((__m256i const *) (&amp;b1[i*16]));\n            b2_avx[i] = _mm256_loadu_si256 ((__m256i const *) (&amp;b2[i*16]));\n            b3_avx[i] = _mm256_loadu_si256 ((__m256i const *) (&amp;b3[i*16]));\n        }\n\n        for(i=0;i&lt;AVX_LEN;i++){\n            res_avx[i]= _mm256_set_epi64x(0, 0, 0, 0);\n        }\n\n        //to calculate a0*b0 + a1*b1 + a2*b2 + a3*b3\n\n        //----standard calculation----\n        for(i=0;i&lt;16*AVX_LEN;i++){\n            res[i]=a0[i]*b0[i] + a1[i]*b1[i] + a2[i]*b2[i] + a3[i]*b3[i];\n        }\n\n\n        //-----AVX-----\n\n        clock1=cpucycles();\n\n\n        for(i=0;i&lt;AVX_LEN;i++){ //simple approach\n\n            a0_avx[i]=_mm256_mullo_epi16(a0_avx[i], b0_avx[i]);\n            res_avx[i]=_mm256_add_epi16(a0_avx[i], res_avx[i]);\n\n            a1_avx[i]=_mm256_mullo_epi16(a1_avx[i], b1_avx[i]);\n            res_avx[i]=_mm256_add_epi16(a1_avx[i], res_avx[i]);\n\n            a2_avx[i]=_mm256_mullo_epi16(a2_avx[i], b2_avx[i]);\n            res_avx[i]=_mm256_add_epi16(a2_avx[i], res_avx[i]);\n\n            a3_avx[i]=_mm256_mullo_epi16(a3_avx[i], b3_avx[i]);\n            res_avx[i]=_mm256_add_epi16(a3_avx[i], res_avx[i]);\n\n        }\n\n        /*\n        for(i=0;i&lt;AVX_LEN;i++){ //FMA approach\n\n            res_avx[i]=mul_add(a0_avx[i], b0_avx[i], res_avx[i]);\n\n            res_avx[i]=mul_add(a1_avx[i], b1_avx[i], res_avx[i]);\n            res_avx[i]=mul_add(a2_avx[i], b2_avx[i], res_avx[i]);\n\n            res_avx[i]=mul_add(a3_avx[i], b3_avx[i], res_avx[i]);\n\n        }\n        */\n\n        clock2=cpucycles();\n        fma_clock = fma_clock + (clock2-clock1);\n\n        //-----Check----\n\n        for(i=0;i&lt;AVX_LEN;i++){ //store avx results for comparison\n            _mm256_maskstore_epi64 (res_avx_check + i*16, mask, res_avx[i]);\n        }\n\n        for(i=0;i&lt;16*AVX_LEN;i++){\n            if(res[i]!=res_avx_check[i]){\n\n                printf(\"\\n--ERROR--\\n\");\n                return;\n            }   \n\n        }\n    }\n\n\n    printf(\"Total time taken is :%llu\\n\", fma_clock/repeat);\n\n}\n</code></pre>\n\n<p>The cpucycles code is from <a href=\"http://www.ecrypt.eu.org/ebats/cpucycles.html\" rel=\"nofollow noreferrer\">ECRYPT</a> and given below,</p>\n\n<pre><code>#include \"cpucycles.h\"\n\nlong long cpucycles(void)\n{\n  unsigned long long result;\n  asm volatile(\".byte 15;.byte 49;shlq $32,%%rdx;orq %%rdx,%%rax\"\n    : \"=a\" (result) ::  \"%rdx\");\n  return result;\n}\n</code></pre>\n\n<p>My gcc -version returns,</p>\n\n<pre><code>gcc (GCC) 4.8.5 20150623 (Red Hat 4.8.5-36)\n</code></pre>\n\n<p>I am using </p>\n\n<pre><code> Intel(R) Core(TM) i7-7700 CPU @ 3.60GHz\n</code></pre>\n\n<p>When I run this on my computer, I get the following cycles for fma approach and simple approach respectively</p>\n\n<pre><code>FMA approach : Total time taken is :109\nSimple approach : Total time taken is :141\n</code></pre>\n\n<p>As you can see, the FMA approach is slightly faster but I expected to be even more faster. I understand that in my sample code there are many memory accesses which might be the reason of deteriorating performance. But, </p>\n\n<ol>\n<li><p>When I dump the assembly I see the almost similar instructions for both approaches. I do not see any fma instructions in the FMA version. I don't understand the reason. Is it beacause _mm256_mullo_epi16 instructions?</p></li>\n<li><p>Is my approach correct? </p></li>\n<li><p>Can you please help me to fix this?</p></li>\n</ol>\n\n<p>I am new to AVX2 programming so it is highly possible that I ahve done something which is not very standard but I will be glad to answer something which is not clear.\nI thank you all for your help in advance.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1564563736, "post_id": 57286950, "comment_id": 101068809, "body": "use <code>sprintf</code> first to compose your command..."}], "answers": [{"tags": [], "owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "is_accepted": false, "score": 0, "last_activity_date": 1564563937, "creation_date": 1564563937, "answer_id": 57287056, "question_id": 57286950, "link": "https://stackoverflow.com/questions/57286950/how-to-ping-some-ip-in-progression-with-a-while-cycle-system-ping-in-c-c/57287056#57287056", "title": "how to ping some ip in progression with a while cycle (system.ping) in C \\ C++", "body": "<p><code>system</code> only takes an already composed command as sole <code>const char *</code> argument. First you have to <em>compose</em> your command, for instance using <code>sprintf</code>. That breaks your nice one-liner loop, I know...</p>\n\n<p>Here's how I'd do (infinite loop and <code>break</code> when return code is not zero).</p>\n\n<pre><code>int ip = 0;\nwhile(1)\n{\n   char command[100];  // will be enough\n   sprintf(command,\"ping 10.250.28.%d\",ip);\n   if (system(command))\n   {\n       break;\n   }\n   ip++;\n}\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9665055, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/834de8d228c280266c0f891ef09de80d?s=128&d=identicon&r=PG&f=1", "display_name": "mene", "link": "https://stackoverflow.com/users/9665055/mene"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 70, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1564568594, "creation_date": 1564563634, "last_edit_date": 1564568594, "question_id": 57286950, "link": "https://stackoverflow.com/questions/57286950/how-to-ping-some-ip-in-progression-with-a-while-cycle-system-ping-in-c-c", "title": "how to ping some ip in progression with a while cycle (system.ping) in C \\ C++", "body": "<p>i'm in a vlan, i need pinging some ip with a little program\nusing the while cycle.\nhow can i use the system.ping command with int value?</p>\n\n<pre><code>int ip=0;\nwhile(system(\"ping 10.250.28.%d\",ip)==0){\n    ip++;\n}\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/HImvI.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/HImvI.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["c++", "c", "stm32", "flash-memory", "stm32ldiscovery"], "comments": [{"owner": {"reputation": 1701, "user_id": 5836577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/931236857b09c3b0aea0f29fb5a23cbc?s=128&d=identicon&r=PG&f=1", "display_name": "Guillaume Petitjean", "link": "https://stackoverflow.com/users/5836577/guillaume-petitjean"}, "edited": false, "score": 1, "creation_date": 1564643475, "post_id": 57286886, "comment_id": 101100014, "body": "It&#39;s not clear why you need to swap memory. Why not calling the entry point of the application 2 from your boot loader ?"}, {"owner": {"reputation": 2336, "user_id": 31152, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BozWc.jpg?s=128&g=1", "display_name": "Malkocoglu", "link": "https://stackoverflow.com/users/31152/malkocoglu"}, "edited": false, "score": 0, "creation_date": 1564737151, "post_id": 57286886, "comment_id": 101137097, "body": "I do not know this specific model, but page sizes may differ (most probably get bigger) depending on their start address..."}], "answers": [{"tags": [], "owner": {"reputation": 68, "user_id": 3209700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff587d3b6bcf18f37e537946c080d291?s=128&d=identicon&r=PG&f=1", "display_name": "Terje", "link": "https://stackoverflow.com/users/3209700/terje"}, "is_accepted": true, "score": 1, "last_activity_date": 1564736769, "creation_date": 1564736769, "answer_id": 57323258, "question_id": 57286886, "link": "https://stackoverflow.com/questions/57286886/how-to-swap-two-memory-regions-from-different-banks-in-flash-memory-for-stm32l47/57323258#57323258", "title": "How to swap two memory regions from different banks in FLASH Memory for STM32L475?", "body": "<p>One possible workaround/different approach is to integrate the bootloader functionality into both application 1 and application 2, and having each application in its own flash bank (1 and 2). Using dual bank mode makes switching back and forth between applications much easier. I have used this approach with an STM32F7 device.</p>\n\n<p>When the device boots it is configured to boot from flash bank 1 or 2 depending on several device option bytes/settings. If your code in the bootloader/application decides to boot into the other application, it can do this by modifying some option bytes and then performing a soft reset. Also, while running bootloader/application from one flash bank, the other flash bank can be updated.</p>\n\n<p>If using this approach to do firmware updates, you must be especially careful that new firmware versions do not break the firmware update functionality of the bootloader.</p>\n"}], "owner": {"reputation": 81, "user_id": 11642594, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-a6b5XWAgnhA/AAAAAAAAAAI/AAAAAAAAArs/c_-a-liPyCs/photo.jpg?sz=128", "display_name": "Shetu Raj", "link": "https://stackoverflow.com/users/11642594/shetu-raj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 645, "favorite_count": 0, "accepted_answer_id": 57323258, "answer_count": 1, "score": 0, "last_activity_date": 1564736769, "creation_date": 1564563423, "last_edit_date": 1564598025, "question_id": 57286886, "link": "https://stackoverflow.com/questions/57286886/how-to-swap-two-memory-regions-from-different-banks-in-flash-memory-for-stm32l47", "title": "How to swap two memory regions from different banks in FLASH Memory for STM32L475?", "body": "<p>I am working on B-L475E-IOT01A2 which is a STM32L475 series Discovery IoT kit and has an ARM M4 cortex. It has two banks of FLASH Memory of size 512 KB each. I am implementing two applications along with a bootloader and all of them are stored in the FLASH. Since there is very little space, the bootloader, the 1st application and some part of the 2nd application is stored in the 1st bank whereas the 2nd bank contains the remaining part of the 2nd application. So at a point in the bootloader program, I need to swap both the applications.</p>\n\n<p>The problem is that only some part of both the applications is getting swapped because the 2nd Application is stored partly in both the banks. Only one page (2 KB) of memory can be written at once in the FLASH . Both the applications have a size of 384 KB and after calculation it turns out to be 192 pages. But after running the swapping program only 72 pages were swapped.</p>\n\n<p>Here are the addresses of the applications and the bootloader.</p>\n\n<pre><code>BOOTLOADER_ADDRESS 0x08000000,  (Size = 48K )\n\nAPPLICATION1_ADDRESS 0x0800F000 (Size = 384 KB)\n\nAPPLICATION2_ADDRESS 0x0806F800 (Size = 384 KB)\n</code></pre>\n\n<p>So what should I do to ensure proper swapping? Should I enable dual bank mode or store the 2nd Application in the 2nd bank or do something else?</p>\n\n<p>Your help will be highly appreciated.</p>\n\n<p>Thanks,</p>\n\n<p>Shetu</p>\n"}, {"tags": ["c", "interrupt-handling", "cortex-m", "thumb"], "answers": [{"comments": [{"owner": {"reputation": 2245, "user_id": 42968, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/405f80d55cb9bbab4ad3b4173e874e11?s=128&d=identicon&r=PG", "display_name": "Atilla Filiz", "link": "https://stackoverflow.com/users/42968/atilla-filiz"}, "edited": false, "score": 0, "creation_date": 1564669862, "post_id": 57299228, "comment_id": 101114929, "body": "Thank you, this is very informative. I will accept after I get the chance to test it."}, {"owner": {"reputation": 2084, "user_id": 605307, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0701a0034bcc346a1cf8399932a7cfd0?s=128&d=identicon&r=PG", "display_name": "cooperised", "link": "https://stackoverflow.com/users/605307/cooperised"}, "reply_to_user": {"reputation": 2245, "user_id": 42968, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/405f80d55cb9bbab4ad3b4173e874e11?s=128&d=identicon&r=PG", "display_name": "Atilla Filiz", "link": "https://stackoverflow.com/users/42968/atilla-filiz"}, "edited": false, "score": 1, "creation_date": 1565341994, "post_id": 57299228, "comment_id": 101332014, "body": "How did you get on?"}, {"owner": {"reputation": 2245, "user_id": 42968, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/405f80d55cb9bbab4ad3b4173e874e11?s=128&d=identicon&r=PG", "display_name": "Atilla Filiz", "link": "https://stackoverflow.com/users/42968/atilla-filiz"}, "edited": false, "score": 0, "creation_date": 1566389128, "post_id": 57299228, "comment_id": 101639693, "body": "sidetracked by shifting priorities, will come back to it when I can."}, {"owner": {"reputation": 2245, "user_id": 42968, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/405f80d55cb9bbab4ad3b4173e874e11?s=128&d=identicon&r=PG", "display_name": "Atilla Filiz", "link": "https://stackoverflow.com/users/42968/atilla-filiz"}, "edited": false, "score": 0, "creation_date": 1576082379, "post_id": 57299228, "comment_id": 104785537, "body": "I ended up doing something slightly different, but I am accepting this answer as this pointed me in the right direction."}], "tags": [], "owner": {"reputation": 2084, "user_id": 605307, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0701a0034bcc346a1cf8399932a7cfd0?s=128&d=identicon&r=PG", "display_name": "cooperised", "link": "https://stackoverflow.com/users/605307/cooperised"}, "is_accepted": true, "score": 2, "last_activity_date": 1564650040, "last_edit_date": 1564650040, "creation_date": 1564609553, "answer_id": 57299228, "question_id": 57286072, "link": "https://stackoverflow.com/questions/57286072/how-can-i-save-the-call-stack-from-an-exception-handler-in-cortex-m4/57299228#57299228", "title": "How can I save the call stack from an exception handler in Cortex M4?", "body": "<p>The best you can do, I think, is to find the address of the instruction that the handler would return to if it was allowed to return.  This will usually be the instruction after the one that caused the fault, though this is not guaranteed (for example if the fault was caused by a branch instruction).</p>\n\n<p>On entry to the handler the link register contains a code which tells you, among other things, which stack was in use when the exception occurred.  See for example <a href=\"https://developer.arm.com/docs/dui0553/latest/the-cortex-m4-processor/exception-model/exception-entry-and-return\" rel=\"nofollow noreferrer\">here</a> for the Cortex-M4.</p>\n\n<p>Just before branching to the exception handler, the CPU will push <code>r0-r3</code>, <code>r12</code>, <code>LR</code> (<code>r14</code>), <code>PC</code> (<code>r15</code>) and <code>xPSR</code> to the active stack.  If your device has a FPU and it's enabled, floating-point context may also be pushed, or space left for it.  The ARM stack is full descending, and registers are stored in ascending order of register number in ascending memory addresses, so on entry to the exception handler whichever stack pointer was in use will be pointing to the stacked value of <code>r0</code>; it stands to reason therefore that 6 words (24 bytes) above that will be the stacked value of <code>PC</code>, which is the return address for the exception handler.</p>\n\n<p>So the process for finding the instruction after the one that caused the fault, assuming it wasn't caused by a branch, is:</p>\n\n<ul>\n<li>Examine <code>LR</code> to find out which stack was in use</li>\n<li>Load the appropriate stack pointer into a free register (<code>r0-r3</code> are all available because they're pushed on entry to the handler)</li>\n<li>Read the word 24 bytes above this stack pointer to find the return address for the handler</li>\n</ul>\n\n<p>Whether the instruction that caused the fault is located 2 or 4 bytes before this return address depends on the instruction of course, the Thumb-2 instruction set is mixed 16- and 32-bit.  And of course it might be located somewhere else entirely!</p>\n\n<p>Bear in mind that if the <code>MSP</code> was in use prior to the fault, then the handler will be using the same stack, and all of this will work only if nothing has been pushed to the stack in the handler function's prologue.  The easiest thing to do may be to write the handler in assembly language.  It can always call a C function after it's finished messing with stacks to complete whatever termination process you have in mind.</p>\n\n<p>One last thing, it's probably worth also saving the stacked value of <code>LR</code>.  If the stacked value of <code>PC</code> tells you nothing of use (for example because it's zero, the code having attempted to branch to an invalid address), then the stacked value of <code>LR</code> will at least tell you where the last <code>BL</code> instruction was encountered, and if you're lucky this will be the branch that caused the fault.  Even if you're not that lucky it may help you to narrow down your search.</p>\n\n<h2>Code</h2>\n\n<p>Here's some (untested) code that might do what you want.  It's written in ARMASM syntax, so you'll need to change the odd thing if you're using a different toolchain:</p>\n\n<pre><code>    IMPORT cHandler\n\n    TST   lr, 0x4       ; Is bit 2 of LR clear?\n    ITE   eq\n    MRSEQ r3, MSP       ; If so, MSP was in use\n    MRSNE r3, PSP       ; Otherwise, PSP was in use\n    LDR   r0, [r3, #24] ; Load the stacked PC into r0\n    LDR   r1, [r3, #20] ; Load the stacked LR into r1\n    B     cHandler      ; Tail-call a C function to finish the job\n</code></pre>\n\n<p>If the C function <code>cHandler</code> has the prototype</p>\n\n<pre><code>void cHandler(void * PC, void * LR);\n</code></pre>\n\n<p>then the last line of the assembly language handler above will call this function, passing the recovered stacked PC as the first argument and the recovered stacked LR as the second.</p>\n"}, {"tags": [], "owner": {"reputation": 2245, "user_id": 42968, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/405f80d55cb9bbab4ad3b4173e874e11?s=128&d=identicon&r=PG", "display_name": "Atilla Filiz", "link": "https://stackoverflow.com/users/42968/atilla-filiz"}, "is_accepted": false, "score": 1, "last_activity_date": 1576082451, "creation_date": 1576082451, "answer_id": 59290363, "question_id": 57286072, "link": "https://stackoverflow.com/questions/57286072/how-can-i-save-the-call-stack-from-an-exception-handler-in-cortex-m4/59290363#59290363", "title": "How can I save the call stack from an exception handler in Cortex M4?", "body": "<p>I used the following code with GCC.</p>\n\n<pre><code>void McuHardFault_HandlerC(uint32_t *hardfault_args)\n{\n  static volatile unsigned long stacked_r0 __attribute__((unused));\n  static volatile unsigned long stacked_r1 __attribute__((unused));\n  static volatile unsigned long stacked_r2 __attribute__((unused));\n  static volatile unsigned long stacked_r3 __attribute__((unused));\n  static volatile unsigned long stacked_r12 __attribute__((unused));\n  static volatile unsigned long stacked_lr __attribute__((unused));\n  static volatile unsigned long stacked_pc __attribute__((unused));\n  static volatile unsigned long stacked_psr __attribute__((unused));\n  static volatile unsigned long _CFSR __attribute__((unused));\n  static volatile unsigned long _HFSR __attribute__((unused));\n  static volatile unsigned long _DFSR __attribute__((unused));\n  static volatile unsigned long _AFSR __attribute__((unused));\n  static volatile unsigned long _BFAR __attribute__((unused));\n  static volatile unsigned long _MMAR __attribute__((unused));\n  stacked_r0 = ((unsigned long)hardfault_args[0]);\n  stacked_r1 = ((unsigned long)hardfault_args[1]);\n  stacked_r2 = ((unsigned long)hardfault_args[2]);\n  stacked_r3 = ((unsigned long)hardfault_args[3]);\n  stacked_r12 = ((unsigned long)hardfault_args[4]);\n  stacked_lr = ((unsigned long)hardfault_args[5]);\n  stacked_pc = ((unsigned long)hardfault_args[6]);\n  stacked_psr = ((unsigned long)hardfault_args[7]);\n\n  /* Configurable Fault Status Register */\n  /* Consists of MMSR, BFSR and UFSR */\n  _CFSR = (*((volatile unsigned long *)(0xE000ED28)));\n\n  /* Hard Fault Status Register */\n  _HFSR = (*((volatile unsigned long *)(0xE000ED2C)));\n\n  /* Debug Fault Status Register */\n  _DFSR = (*((volatile unsigned long *)(0xE000ED30)));\n\n  /* Auxiliary Fault Status Register */\n  _AFSR = (*((volatile unsigned long *)(0xE000ED3C)));\n\n\n  /* Read the Fault Address Registers. */\n  /* These may not contain valid values. */\n  /* Check BFARVALID/MMARVALID to see */\n  /* if they are valid values */\n  /* MemManage Fault Address Register */\n  _MMAR = (*((volatile unsigned long *)(0xE000ED34)));\n  /* Bus Fault Address Register */\n  _BFAR = (*((volatile unsigned long *)(0xE000ED38)));\n\n  __asm(\"BKPT #0\\n\") ; /* cause the debugger to stop */\n}\n\nvoid HardFault_Handler(void) __attribute__((naked));\nvoid HardFault_Handler(void)\n{\n  __asm volatile (\n    \".syntax unified              \\n\"  /* needed for the 'adds r1,#2' below */\n    \" movs r0,#4                  \\n\"  /* load bit mask into R0 */\n    \" mov r1, lr                  \\n\"  /* load link register into R1 */\n    \" tst r0, r1                  \\n\"  /* compare with bitmask */\n    \" beq _MSP                    \\n\"  /* if bitmask is set: stack pointer is in PSP. Otherwise in MSP */\n    \" mrs r0, psp                 \\n\"  /* otherwise: stack pointer is in PSP */\n    \" b _GetPC                    \\n\"  /* go to part which loads the PC */\n  \"_MSP:                          \\n\"  /* stack pointer is in MSP register */\n    \" mrs r0, msp                 \\n\"  /* load stack pointer into R0 */\n  \"_GetPC:                        \\n\"  /* find out where the hard fault happened */\n    \" ldr r1,[r0,#24]             \\n\"  /* load program counter into R1. R1 contains address of the next instruction where the hard fault happened */\n    \" b McuHardFault_HandlerC   \\n\"  /* decode more information. R0 contains pointer to stack frame */\n  );\n}\n</code></pre>\n"}], "owner": {"reputation": 2245, "user_id": 42968, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/405f80d55cb9bbab4ad3b4173e874e11?s=128&d=identicon&r=PG", "display_name": "Atilla Filiz", "link": "https://stackoverflow.com/users/42968/atilla-filiz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 274, "favorite_count": 0, "accepted_answer_id": 57299228, "answer_count": 2, "score": 2, "last_activity_date": 1576082582, "creation_date": 1564560542, "last_edit_date": 1576082582, "question_id": 57286072, "link": "https://stackoverflow.com/questions/57286072/how-can-i-save-the-call-stack-from-an-exception-handler-in-cortex-m4", "title": "How can I save the call stack from an exception handler in Cortex M4?", "body": "<p>Here is what I want to achieve: Whenever I receive a hard fault or watchdog interrupt, I will save the previous instruction's address to some RAM location that will survive a reset.</p>\n\n<p>Kinetis M64 watchdog gives me 256 CPU cycles before it issues the reset, which should be enough time to save a few things. The question is where do I find these addresses? When an IRQ happens, LR holds an exception value instead of the actual return address.</p>\n\n<p>I want to do this without an SWD probe attached, so the device can self-report whenever something goes wrong.</p>\n"}, {"tags": ["c", "file", "intel", "sd-card", "fatfs"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1564559952, "post_id": 57285821, "comment_id": 101066761, "body": "Opening files for writing only usually truncates the file (removes the existing data) on most systems. Same thing happens with the standard C <code>fopen</code> function when you open using <code>&quot;w&quot;</code>."}, {"owner": {"reputation": 5, "user_id": 10388172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07190ad339f293e38584b1b3a50c2f63?s=128&d=identicon&r=PG&f=1", "display_name": "Bolt123", "link": "https://stackoverflow.com/users/10388172/bolt123"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1564561534, "post_id": 57285821, "comment_id": 101067597, "body": "@someprogrammerdude It doesn&#39;t work with only write or with both read and write."}], "owner": {"reputation": 5, "user_id": 10388172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07190ad339f293e38584b1b3a50c2f63?s=128&d=identicon&r=PG&f=1", "display_name": "Bolt123", "link": "https://stackoverflow.com/users/10388172/bolt123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1564559687, "creation_date": 1564559687, "question_id": 57285821, "link": "https://stackoverflow.com/questions/57285821/why-does-f-print-not-work-correctly-on-sd-card", "title": "Why does f_print not work correctly on SD card?", "body": "<p>Currently, I am working on writing to an SD card with Intel D2000 Quark board. I am using the standard FatFs system to set up a FAT16 standard. </p>\n\n<p>The problem:\nWhenever I write to the SD card, the SD card saves it only when there is something on the file. This means, the text I am sending, will overwrite what is in the file. When I set the read/write pointer to the end of the file(This is the goal in the end), the data I write gets lost. </p>\n\n<p>My main:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>int main(void)\n{\n    QM_PRINTF(\"Starting: SPI\\n\\n\");\n    FIL f;\n    char text1[512] =\"Ik ben makelaar in koffi, en woon op de Lauriergracht No 37.\\n \"\n            \"Het is mijn gewoonte niet, romans te schrijven, of zulke dingen, \\n\"\n            \"en het heeft dan ook lang geduurd,\";\n    f_mount(&amp;FatFs, \"\", 0);\n    fr = f_open(&amp;f, \"DATA.TXT\", FA_OPEN_ALWAYS | FA_WRITE);\n    QM_PRINTF(\"%d\\n\", (int)fr);\n    QM_PRINTF(\"Size: %d\\n\", f_size(&amp;f));\n    fr = f_write(&amp;f, text1, sizeof(text1), &amp;bw);\n    f_sync(&amp;f);\n    QM_PRINTF(\"write: %d count: %d\\n\", fr, bw);\n    QM_PRINTF(\"Size: %d\\n\", f_size(&amp;f));\n    QM_PRINTF(\"%d\\n\", bw);\n    fr = f_close(&amp;f);\n    f_mount(0,\"\",0);\n    QM_PRINTF(\"%d\\n\", fr);\n    QM_PRINTF(\"Finished: SPI\\n\");\n    QM_PRINTF(\"-----------------------------------\\n\");\n}\n</code></pre>\n\n<p>The result I am getting for the console when there is something in the file and the read/write pointer is at the beginning of the file. At this point, the data gets written to the SD card and is saved (I can read it when I put the SD card in my laptop and open the file).</p>\n\n<pre><code>Starting: SPI\n\n0\nSize: 3362\nwrite: 0 count: 512\nSize: 3362\n512\n0\nFinished: SPI\n-----------------------------------\n</code></pre>\n\n<p>The result I get from the console when the read/write pointer is at the end of the file (FA_OPEN_APPEND):</p>\n\n<pre><code>Starting: SPI\n\n0\nSize: 3362\nwrite: 0 count: 512\nSize: 3874\n512\n0\nFinished: SPI\n-----------------------------------\n</code></pre>\n\n<p>After this, when I put the SD card in my laptop, the text is gone. </p>\n\n<p>Has anyone encountered the same problem and found a solution. When you need more information, please ask.</p>\n"}, {"tags": ["c++", "c", "networking", "pcap", "libpcap"], "comments": [{"owner": {"reputation": 1928, "user_id": 10734452, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ps1ig8rG6G8/AAAAAAAAAAI/AAAAAAAAAS8/yVuRLo3SyCM/photo.jpg?sz=128", "display_name": "Guillaume D", "link": "https://stackoverflow.com/users/10734452/guillaume-d"}, "edited": false, "score": 0, "creation_date": 1564559573, "post_id": 57285445, "comment_id": 101066560, "body": "couldn&#39;t you just find the right size by dichotomy?"}, {"owner": {"reputation": 1, "user_id": 11862395, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6aa0d15d01776281224d93ae4d0b4235?s=128&d=identicon&r=PG&f=1", "display_name": "Yevgeni", "link": "https://stackoverflow.com/users/11862395/yevgeni"}, "reply_to_user": {"reputation": 1928, "user_id": 10734452, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ps1ig8rG6G8/AAAAAAAAAAI/AAAAAAAAAS8/yVuRLo3SyCM/photo.jpg?sz=128", "display_name": "Guillaume D", "link": "https://stackoverflow.com/users/10734452/guillaume-d"}, "edited": false, "score": 0, "creation_date": 1564560188, "post_id": 57285445, "comment_id": 101066889, "body": "I need to get the ring buffer free space every time before call pcap_dispatch() method. Thank you for your question."}, {"owner": {"reputation": 1928, "user_id": 10734452, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ps1ig8rG6G8/AAAAAAAAAAI/AAAAAAAAAS8/yVuRLo3SyCM/photo.jpg?sz=128", "display_name": "Guillaume D", "link": "https://stackoverflow.com/users/10734452/guillaume-d"}, "edited": false, "score": 0, "creation_date": 1564560785, "post_id": 57285445, "comment_id": 101067180, "body": "have you read <a href=\"https://stackoverflow.com/questions/7771963/pcap-dispatch-callback-processing-questions\">this</a>? hope this helps"}, {"owner": {"reputation": 1928, "user_id": 10734452, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ps1ig8rG6G8/AAAAAAAAAAI/AAAAAAAAAS8/yVuRLo3SyCM/photo.jpg?sz=128", "display_name": "Guillaume D", "link": "https://stackoverflow.com/users/10734452/guillaume-d"}, "edited": false, "score": 0, "creation_date": 1564561037, "post_id": 57285445, "comment_id": 101067337, "body": "and why do you want to get the free space size of the ringbuf before a <code>pcap_dispatch()</code> ?"}, {"owner": {"reputation": 1928, "user_id": 10734452, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ps1ig8rG6G8/AAAAAAAAAAI/AAAAAAAAAS8/yVuRLo3SyCM/photo.jpg?sz=128", "display_name": "Guillaume D", "link": "https://stackoverflow.com/users/10734452/guillaume-d"}, "edited": false, "score": 0, "creation_date": 1564561103, "post_id": 57285445, "comment_id": 101067364, "body": "<code>When reading packets from an interface opened for a live capture, pcap_dispatch(), pcap_next(), and pcap_next_ex() will, if no packets are currently available to be read, block waiting for packets to become available</code>"}, {"owner": {"reputation": 183, "user_id": 9065877, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/f93de7000747ab5efb5acd3034b2ebd7?s=128&d=identicon&r=PG", "display_name": "user9065877", "link": "https://stackoverflow.com/users/9065877/user9065877"}, "edited": false, "score": 0, "creation_date": 1564799734, "post_id": 57285445, "comment_id": 101159612, "body": "On what operating system are you running your application?  Different OSes have different capture mechanisms atop which libpcap runs."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11862395, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6aa0d15d01776281224d93ae4d0b4235?s=128&d=identicon&r=PG&f=1", "display_name": "Yevgeni", "link": "https://stackoverflow.com/users/11862395/yevgeni"}, "edited": false, "score": 0, "creation_date": 1564563448, "post_id": 57285936, "comment_id": 101068675, "body": "Thank you for your answer but I can not set a new ring buffer size when my application is running and libpcap was initialized before  calling of  pcap_dispatch()"}, {"owner": {"reputation": 1928, "user_id": 10734452, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ps1ig8rG6G8/AAAAAAAAAAI/AAAAAAAAAS8/yVuRLo3SyCM/photo.jpg?sz=128", "display_name": "Guillaume D", "link": "https://stackoverflow.com/users/10734452/guillaume-d"}, "reply_to_user": {"reputation": 1, "user_id": 11862395, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6aa0d15d01776281224d93ae4d0b4235?s=128&d=identicon&r=PG&f=1", "display_name": "Yevgeni", "link": "https://stackoverflow.com/users/11862395/yevgeni"}, "edited": false, "score": 0, "creation_date": 1564563586, "post_id": 57285936, "comment_id": 101068744, "body": "you have to change the size between two compilation."}, {"owner": {"reputation": 1, "user_id": 11862395, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6aa0d15d01776281224d93ae4d0b4235?s=128&d=identicon&r=PG&f=1", "display_name": "Yevgeni", "link": "https://stackoverflow.com/users/11862395/yevgeni"}, "edited": false, "score": 0, "creation_date": 1564563922, "post_id": 57285936, "comment_id": 101068901, "body": "Thank you! In order to change the size of the ring buffer, the only thing I can do is stop the application and set a new size?"}, {"owner": {"reputation": 1928, "user_id": 10734452, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ps1ig8rG6G8/AAAAAAAAAAI/AAAAAAAAAS8/yVuRLo3SyCM/photo.jpg?sz=128", "display_name": "Guillaume D", "link": "https://stackoverflow.com/users/10734452/guillaume-d"}, "reply_to_user": {"reputation": 1, "user_id": 11862395, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6aa0d15d01776281224d93ae4d0b4235?s=128&d=identicon&r=PG&f=1", "display_name": "Yevgeni", "link": "https://stackoverflow.com/users/11862395/yevgeni"}, "edited": false, "score": 0, "creation_date": 1564564031, "post_id": 57285936, "comment_id": 101068968, "body": "I mean it is the easiest way by what you shall start with, but I guess you can implement a command to call a <code>pcap_set_snaplen()</code>."}, {"owner": {"reputation": 1, "user_id": 11862395, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6aa0d15d01776281224d93ae4d0b4235?s=128&d=identicon&r=PG&f=1", "display_name": "Yevgeni", "link": "https://stackoverflow.com/users/11862395/yevgeni"}, "edited": false, "score": 0, "creation_date": 1564564362, "post_id": 57285936, "comment_id": 101069162, "body": "The pcap_set_snaplen() only change size of a packet. But my main goal to get information about how much free space is left when my application works. For example, I set the size of the ring buffer 128000000 and got dropped packets"}], "tags": [], "owner": {"reputation": 1928, "user_id": 10734452, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ps1ig8rG6G8/AAAAAAAAAAI/AAAAAAAAAS8/yVuRLo3SyCM/photo.jpg?sz=128", "display_name": "Guillaume D", "link": "https://stackoverflow.com/users/10734452/guillaume-d"}, "is_accepted": false, "score": 0, "last_activity_date": 1564563700, "last_edit_date": 1564563700, "creation_date": 1564560062, "answer_id": 57285936, "question_id": 57285445, "link": "https://stackoverflow.com/questions/57285445/how-can-i-get-if-a-ringbuffer-of-the-libpcap-is-going-to-full/57285936#57285936", "title": "How can I get if a ringbuffer of the libpcap is going to full", "body": "<p>from the <a href=\"http://man7.org/linux/man-pages/man3/pcap.3pcap.html\" rel=\"nofollow noreferrer\">man pcap</a>:</p>\n\n<blockquote>\n  <p>a size that's too small could mean that, if too many packets are being\n  captured and the snapshot length doesn't limit the amount of data\n  that's buffered, packets could be dropped if the buffer fills up\n  before the application can read packets from it, while a size that's\n  too large could use more non- pageable operating system memory than is\n  necessary to prevent packets from being dropped</p>\n</blockquote>\n\n<p>The ideal size of the buffer depends on the use case.</p>\n\n<p>What you could do to find this ideal size is by using dichotomy:</p>\n\n<ul>\n<li>set a huge but system supported size at first </li>\n<li>with pcap_stats() to get the number of dropped packets</li>\n<li>compile again and run.</li>\n<li><p>note if you have dropped packets.</p>\n\n<hr></li>\n<li><p>then set to your current size</p></li>\n<li>with pcap_stats() to get the number of dropped packets</li>\n<li>compile again and run.</li>\n<li><p>note if you have dropped packets.</p>\n\n<hr></li>\n<li><p>then set size to (huge size + current size)/2</p></li>\n<li>with pcap_stats() to get the number of dropped packets</li>\n<li>compile again and run.</li>\n<li><p>note if you have dropped packets.</p>\n\n<hr></li>\n<li><p>...</p></li>\n</ul>\n\n<p>Note that you can reduce the amount of buffer use by setting the snapshot lenght with <code>pcap_set_snaplen()</code></p>\n\n<blockquote>\n  <p>If, when capturing, you capture the entire contents of the packet,\n  that requires more CPU time to copy the packet to your application,\n  more disk and possibly network bandwidth to write the packet data to a\n  file, and more disk space to save the packet.  If you don't need the\n  entire contents of the packet - for example, if you are only\n  interested in the TCP headers of packets - you can set the \"snapshot\n  length\" for the capture to an appropriate value.  If the snapshot\n  length is set to snaplen, and snaplen is less than the size of a\n  packet that is captured, only the first snaplen bytes of that packet\n  will be captured and provided as packet data</p>\n</blockquote>\n\n<p>you can get the current snaplen with <code>shotpcap_snapshot()</code></p>\n"}], "owner": {"reputation": 1, "user_id": 11862395, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6aa0d15d01776281224d93ae4d0b4235?s=128&d=identicon&r=PG&f=1", "display_name": "Yevgeni", "link": "https://stackoverflow.com/users/11862395/yevgeni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 298, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1564563700, "creation_date": 1564558190, "last_edit_date": 1564558725, "question_id": 57285445, "link": "https://stackoverflow.com/questions/57285445/how-can-i-get-if-a-ringbuffer-of-the-libpcap-is-going-to-full", "title": "How can I get if a ringbuffer of the libpcap is going to full", "body": "<p>I am using the libpcap in my project and use the function pcap_set_buffer_size() to set an initial value. When the ring buffer is full the libpacp statistic shows me that a lot of packets was dropped.</p>\n\n<p>How can I get information about the ring buffer free space?</p>\n"}, {"tags": ["android", "c", "makefile", "cmake", "android-ndk"], "comments": [{"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 2, "creation_date": 1564559621, "post_id": 57285318, "comment_id": 101066586, "body": "&quot;How can I set this variable to 1 so the project compile for android device?&quot; - You need to specify appropriate toolchain. Just google how to build CMake projects for Android. See e.g. here: <a href=\"https://developer.android.com/ndk/guides/cmake\" rel=\"nofollow noreferrer\">developer.android.com/ndk/guides/cmake</a>"}], "owner": {"reputation": 458, "user_id": 8556874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ec3f0c2a4d2ed81e5f668e3784017cc?s=128&d=identicon&r=PG", "display_name": "mohsen saremi", "link": "https://stackoverflow.com/users/8556874/mohsen-saremi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 97, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1564557729, "creation_date": 1564557729, "question_id": 57285318, "link": "https://stackoverflow.com/questions/57285318/compile-c-file-for-using-in-android", "title": "Compile C file for using in android", "body": "<p>I want to compile following repo for using it in android and use <code>tun2socks</code> file in android phone\n<a href=\"https://github.com/shadowsocks/badvpn\" rel=\"nofollow noreferrer\">https://github.com/shadowsocks/badvpn</a></p>\n\n<p>I executed the following commands:</p>\n\n<pre><code>mkdir build\ncd build\ncmake .. -DBUILD_NOTHING_BY_DEFAULT=1 -DBUILD_TUN2SOCKS=1\nmake install\n</code></pre>\n\n<p>But I got the following errors:</p>\n\n<pre><code>/home/mohsen/badvpn/tun2socks/tun2socks.c: In function \u2018main\u2019:\n/home/mohsen/badvpn/tun2socks/tun2socks.c:488:16: error: \u2018struct &lt;anonymous&gt;\u2019 has no member named \u2018fake_proc\u2019\n     if (options.fake_proc) {\n\n</code></pre>\n\n<p>There is a macro <code>__ANDROID__</code> in source files</p>\n\n<p>How can I set this variable to 1 so the project compile for android device? </p>\n\n<p>How can I compile it for using output binary in <code>arm</code> and <code>x86</code> android processor?</p>\n"}, {"tags": ["c", "amazon-web-services", "esp8266", "aws-iot", "arduino-esp8266"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 11290482, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-xUhU8EgfXP4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rddTNQnyU_bLs6hrvmx5oAMSUGuPA/mo/photo.jpg?sz=128", "display_name": "AleLx", "link": "https://stackoverflow.com/users/11290482/alelx"}, "edited": false, "score": 0, "creation_date": 1564743052, "post_id": 57323533, "comment_id": 101140037, "body": "Thank you for your reply.I forgot to say that I have already registered my CA certificate in AWS Iot. I followed all the steps described in aws doc."}], "tags": [], "owner": {"reputation": 68, "user_id": 3209700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff587d3b6bcf18f37e537946c080d291?s=128&d=identicon&r=PG&f=1", "display_name": "Terje", "link": "https://stackoverflow.com/users/3209700/terje"}, "is_accepted": false, "score": 1, "last_activity_date": 1564740233, "last_edit_date": 1564740233, "creation_date": 1564737772, "answer_id": 57323533, "question_id": 57285074, "link": "https://stackoverflow.com/questions/57285074/connect-to-aws-mqtt-broker-using-openssl-intermediate-certificate/57323533#57323533", "title": "Connect to AWS MQTT broker using openssl intermediate certificate", "body": "<p>When using your own generated keys, you need to create and register the corresponding CA certificate with AWS IoT. This and additional necessary steps are described here:</p>\n\n<p><a href=\"https://docs.aws.amazon.com/iot/latest/developerguide/device-certs-your-own.html\" rel=\"nofollow noreferrer\">https://docs.aws.amazon.com/iot/latest/developerguide/device-certs-your-own.html</a></p>\n"}], "owner": {"reputation": 11, "user_id": 11290482, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-xUhU8EgfXP4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rddTNQnyU_bLs6hrvmx5oAMSUGuPA/mo/photo.jpg?sz=128", "display_name": "AleLx", "link": "https://stackoverflow.com/users/11290482/alelx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 994, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1564740233, "creation_date": 1564556769, "last_edit_date": 1564565867, "question_id": 57285074, "link": "https://stackoverflow.com/questions/57285074/connect-to-aws-mqtt-broker-using-openssl-intermediate-certificate", "title": "Connect to AWS MQTT broker using openssl intermediate certificate", "body": "<p>I have some problem with this project <a href=\"https://github.com/debsahu/ESP-MQTT-AWS-IoT-Core\" rel=\"nofollow noreferrer\">https://github.com/debsahu/ESP-MQTT-AWS-IoT-Core</a>: if I use the AWS certificates everything works good, but if I use certificates created with openssl, the code return this error: \"failed, reason -> Connection Accepted &lt; try again in 5 seconds\"</p>\n\n<p>To create the intermediate certificate (best practise for aws) i used this guide: <a href=\"https://jamielinux.com/docs/openssl-certificate-authority/introduction.html\" rel=\"nofollow noreferrer\">https://jamielinux.com/docs/openssl-certificate-authority/introduction.html</a></p>\n\n<pre><code>#ifdef ESP32\n#include &lt;WiFi.h&gt;\n#elif defined(ESP8266)\n#include &lt;ESP8266WiFi.h&gt;\n#else\n#error Platform not supported\n#endif\n#include &lt;WiFiClientSecure.h&gt;\n#include &lt;ArduinoJson.h&gt; //https://github.com/bblanchon/ArduinoJson (use v6.xx)\n#include &lt;time.h&gt;\n#define emptyString String()\n\n//Follow instructions from https://github.com/debsahu/ESP-MQTT-AWS-IoT-        Core/blob/master/doc/README.md\n//Enter values in secrets.h \u25bc\n#include \"secrets.h\"\n\n#ifndef PIO_PLATFORM\n//#define USE_PUB_SUB  //uncomment to use PubSubClient(https://github.com/knolleary/pubsubclient)\n#endif\n\n#if !(ARDUINOJSON_VERSION_MAJOR == 6 and ARDUINOJSON_VERSION_MINOR &gt;= 7)\n#error \"Install ArduinoJson v6.7.0-beta or higher\"\n#endif\n\nconst int MQTT_PORT = 8883;\nconst char MQTT_SUB_TOPIC[] = \"$aws/things/OggettoZero/shadow/update\";\nconst char MQTT_PUB_TOPIC[] = \"$aws/things/OggettoZero/shadow/update\";\n\n#ifdef USE_SUMMER_TIME_DST\nuint8_t DST = 1;\n#else\nuint8_t DST = 0;\n#endif\n\nWiFiClientSecure net;\n\n#ifdef ESP8266\nBearSSL::X509List cert(cacert);\nBearSSL::X509List client_crt(client_cert);\nBearSSL::PrivateKey key(privkey);\n#endif\n\n#ifdef USE_PUB_SUB\n#include &lt;PubSubClient.h&gt;\n#if defined(USE_PUB_SUB) and defined(PIO_PLATFORM) // PIO has issues, needs MQTT.h definition or else freaks out\n#include &lt;MQTT.h&gt;\n#endif\nPubSubClient client(net);\n#else\n#include &lt;MQTT.h&gt;\nMQTTClient client;\n#endif\n\nunsigned long lastMillis = 0;\ntime_t now;\ntime_t nowish = 1510592825;\n\nvoid NTPConnect(void)\n{\n  Serial.print(\"Setting time using SNTP\");\n  configTime(TIME_ZONE * 3600, DST * 3600, \"pool.ntp.org\", \"time.nist.gov\");\n  now = time(nullptr);\n  while (now &lt; nowish)\n  {\n    delay(500);\n    Serial.print(\".\");\n    now = time(nullptr);\n  }\n  Serial.println(\"done!\");\n  struct tm timeinfo;\n  gmtime_r(&amp;now, &amp;timeinfo);\n  Serial.print(\"Current time: \");\n  Serial.print(asctime(&amp;timeinfo));\n}\n\n#ifdef USE_PUB_SUB\n\nvoid messageReceivedPubSub(char *topic, byte *payload, unsigned int length)\n{\n  Serial.print(\"Received [\");\n  Serial.print(topic);\n  Serial.print(\"]: \");\n  for (unsigned int i = 0; i &lt; length; i++)\n  {\n    Serial.print((char)payload[i]);\n  }\n  Serial.println();\n}\n\nvoid pubSubErr(int8_t MQTTErr)\n{\n  if (MQTTErr == MQTT_CONNECTION_TIMEOUT)\n    Serial.print(\"Connection tiemout\");\n  else if (MQTTErr == MQTT_CONNECTION_LOST)\n    Serial.print(\"Connection lost\");\n  else if (MQTTErr == MQTT_CONNECT_FAILED)\n    Serial.print(\"Connect failed\");\n  else if (MQTTErr == MQTT_DISCONNECTED)\n    Serial.print(\"Disconnected\");\n  else if (MQTTErr == MQTT_CONNECTED)\n    Serial.print(\"Connected\");\n  else if (MQTTErr == MQTT_CONNECT_BAD_PROTOCOL)\n    Serial.print(\"Connect bad protocol\");\n  else if (MQTTErr == MQTT_CONNECT_BAD_CLIENT_ID)\n    Serial.print(\"Connect bad Client-ID\");\n  else if (MQTTErr == MQTT_CONNECT_UNAVAILABLE)\n    Serial.print(\"Connect unavailable\");\n  else if (MQTTErr == MQTT_CONNECT_BAD_CREDENTIALS)\n    Serial.print(\"Connect bad credentials\");\n  else if (MQTTErr == MQTT_CONNECT_UNAUTHORIZED)\n    Serial.print(\"Connect unauthorized\");\n}\n\n#else\n\nvoid messageReceived(String &amp;topic, String &amp;payload)\n{\n  Serial.println(\"Recieved [\" + topic + \"]: \" + payload);\n}\n\nvoid lwMQTTErr(lwmqtt_err_t reason)\n{\n  if (reason == lwmqtt_err_t::LWMQTT_SUCCESS)\n    Serial.print(\"Success\");\n  else if (reason == lwmqtt_err_t::LWMQTT_BUFFER_TOO_SHORT)\n    Serial.print(\"Buffer too short\");\n  else if (reason == lwmqtt_err_t::LWMQTT_VARNUM_OVERFLOW)\n    Serial.print(\"Varnum overflow\");\n  else if (reason == lwmqtt_err_t::LWMQTT_NETWORK_FAILED_CONNECT)\n    Serial.print(\"Network failed connect\");\n  else if (reason == lwmqtt_err_t::LWMQTT_NETWORK_TIMEOUT)\n    Serial.print(\"Network timeout\");\n  else if (reason == lwmqtt_err_t::LWMQTT_NETWORK_FAILED_READ)\n    Serial.print(\"Network failed read\");\n  else if (reason == lwmqtt_err_t::LWMQTT_NETWORK_FAILED_WRITE)\n    Serial.print(\"Network failed write\");\n  else if (reason == lwmqtt_err_t::LWMQTT_REMAINING_LENGTH_OVERFLOW)\n    Serial.print(\"Remaining length overflow\");\n  else if (reason == lwmqtt_err_t::LWMQTT_REMAINING_LENGTH_MISMATCH)\n    Serial.print(\"Remaining length mismatch\");\n  else if (reason == lwmqtt_err_t::LWMQTT_MISSING_OR_WRONG_PACKET)\n    Serial.print(\"Missing or wrong packet\");\n  else if (reason == lwmqtt_err_t::LWMQTT_CONNECTION_DENIED)\n    Serial.print(\"Connection denied\");\n  else if (reason == lwmqtt_err_t::LWMQTT_FAILED_SUBSCRIPTION)\n    Serial.print(\"Failed subscription\");\n  else if (reason == lwmqtt_err_t::LWMQTT_SUBACK_ARRAY_OVERFLOW)\n    Serial.print(\"Suback array overflow\");\n  else if (reason == lwmqtt_err_t::LWMQTT_PONG_TIMEOUT)\n    Serial.print(\"Pong timeout\");\n}\n\nvoid lwMQTTErrConnection(lwmqtt_return_code_t reason)\n{\n  if (reason == lwmqtt_return_code_t::LWMQTT_CONNECTION_ACCEPTED)\n    Serial.print(\"Connection Accepted\");\n  else if (reason == lwmqtt_return_code_t::LWMQTT_UNACCEPTABLE_PROTOCOL)\n    Serial.print(\"Unacceptable Protocol\");\n  else if (reason == lwmqtt_return_code_t::LWMQTT_IDENTIFIER_REJECTED)\n    Serial.print(\"Identifier Rejected\");\n  else if (reason == lwmqtt_return_code_t::LWMQTT_SERVER_UNAVAILABLE)\n    Serial.print(\"Server Unavailable\");\n  else if (reason == lwmqtt_return_code_t::LWMQTT_BAD_USERNAME_OR_PASSWORD)\n    Serial.print(\"Bad UserName/Password\");\n  else if (reason == lwmqtt_return_code_t::LWMQTT_NOT_AUTHORIZED)\n    Serial.print(\"Not Authorized\");\n  else if (reason == lwmqtt_return_code_t::LWMQTT_UNKNOWN_RETURN_CODE)\n    Serial.print(\"Unknown Return Code\");\n}\n#endif\n\nvoid connectToMqtt(bool nonBlocking = false)\n{\n  Serial.print(\"MQTT connecting \");\n  while (!client.connected())\n  {\n    if (client.connect(THINGNAME))\n    {\n      Serial.println(\"connected!\");\n      if (!client.subscribe(MQTT_SUB_TOPIC))\n#ifdef USE_PUB_SUB\n        pubSubErr(client.state());\n#else\n        lwMQTTErr(client.lastError());\n#endif\n    }\n    else\n    {\n      Serial.print(\"failed, reason -&gt; \");\n#ifdef USE_PUB_SUB\n      pubSubErr(client.state());\n#else\n      lwMQTTErrConnection(client.returnCode());\n#endif\n      if (!nonBlocking)\n      {\n        Serial.println(\" &lt; try again in 5 seconds\");\n        delay(5000);\n      }\n      else\n      {\n        Serial.println(\" &lt;\");\n      }\n    }\n    if (nonBlocking)\n      break;\n  }\n}\n\nvoid connectToWiFi(String init_str)\n{\n  if (init_str != emptyString)\n    Serial.print(init_str);\n  while (WiFi.status() != WL_CONNECTED)\n  {\n    Serial.print(\".\");\n    delay(1000);\n  }\n  if (init_str != emptyString)\n    Serial.println(\"ok!\");\n}\n\nvoid checkWiFiThenMQTT(void)\n{\n  connectToWiFi(\"Checking WiFi\");\n  connectToMqtt();\n}\n\nunsigned long previousMillis = 0;\nconst long interval = 5000;\n\nvoid checkWiFiThenMQTTNonBlocking(void)\n{\n  connectToWiFi(emptyString);\n  if (millis() - previousMillis &gt;= interval &amp;&amp; !client.connected()) {\n    previousMillis = millis();\n    connectToMqtt(true);\n  }\n}\n\nvoid checkWiFiThenReboot(void)\n{\n  connectToWiFi(\"Checking WiFi\");\n  Serial.print(\"Rebooting\");\n  ESP.restart();\n}\n\nvoid sendData(void)\n{\n  DynamicJsonDocument jsonBuffer(JSON_OBJECT_SIZE(3) + 100);\n  JsonObject root = jsonBuffer.to&lt;JsonObject&gt;();\n  JsonObject state = root.createNestedObject(\"state\");\n  JsonObject state_reported = state.createNestedObject(\"reported\");\n  state_reported[\"value\"] = random(100);\n  Serial.printf(\"Sending  [%s]: \", MQTT_PUB_TOPIC);\n  serializeJson(root, Serial);\n  Serial.println();\n  char shadow[measureJson(root) + 1];\n  serializeJson(root, shadow, sizeof(shadow));\n#ifdef USE_PUB_SUB\n  if (!client.publish(MQTT_PUB_TOPIC, shadow, false))\n    pubSubErr(client.state());\n#else\n  if (!client.publish(MQTT_PUB_TOPIC, shadow, false, 0))\n    lwMQTTErr(client.lastError());\n#endif\n}\n\nvoid setup()\n{\n  Serial.begin(115200);\n  delay(5000);\n  Serial.println();\n  Serial.println();\n#ifdef ESP32\n  WiFi.setHostname(THINGNAME);\n#else\n  WiFi.hostname(THINGNAME);\n#endif\n  WiFi.mode(WIFI_STA);\n  WiFi.begin(ssid, pass);\n  connectToWiFi(String(\"Attempting to connect to SSID: \") + String(ssid));\n\n  NTPConnect();\n\n#ifdef ESP32\n  net.setCACert(cacert);\n  net.setCertificate(client_cert);\n  net.setPrivateKey(privkey);\n#else\n  net.setTrustAnchors(&amp;cert);\n  net.setClientRSACert(&amp;client_crt, &amp;key);\n#endif\n\n#ifdef USE_PUB_SUB\n  client.setServer(MQTT_HOST, MQTT_PORT);\n  client.setCallback(messageReceivedPubSub);\n#else\n  client.begin(MQTT_HOST, MQTT_PORT, net);\n  client.onMessage(messageReceived);\n#endif\n  connectToMqtt();\n}\n\nvoid loop()\n{\n  now = time(nullptr);\n  if (!client.connected())\n  {\n    checkWiFiThenMQTT();\n    //checkWiFiThenMQTTNonBlocking();\n    //checkWiFiThenReboot();\n  }\n  else\n  {\n    client.loop();\n    if (millis() - lastMillis &gt; 5000)\n    {\n      lastMillis = millis();\n      sendData();\n    }\n  }\n}\n</code></pre>\n\n<p>In file secret.h I put the certificates created with openssl: private  key, device certificate and CA certificate.</p>\n\n<p>I expected that the connection will work exactly like with the AWS certificates, but the code return me this error: \"failed, reason -> Connection Accepted &lt; try again in 5 seconds\" and I don't what kind of error it can be!</p>\n"}, {"tags": ["c", "arrays", "string"], "comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 2, "creation_date": 1564555737, "post_id": 57284670, "comment_id": 101064653, "body": "You&#39;re loop is bounded only by an erroneous <code>while (!feof(fp))</code>, which in itself is wrong.Read this: <a href=\"https://stackoverflow.com/questions/5431941/why-is-while-feoffile-always-wrong\">Why is \u201cwhile (!feof(file))\u201d always wrong?</a>. Second, don&#39;t let more than 100 strings come through or you&#39;re going to breach your array and invoke undefined behavior. Third, make sure any string you&#39;re reading fits in <code>word</code> (a 100 character string or larger will <i>not</i>, accounting for the terminator). And after all of that, <code>word</code> is useless; you can read directly into <code>list[i]</code> and avoid the <code>strcpy</code> entirely."}], "answers": [{"tags": [], "owner": {"reputation": 362, "user_id": 9919938, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-rwSWEOoBBm4/AAAAAAAAAAI/AAAAAAAAAEs/FyBDyLid5k4/photo.jpg?sz=128", "display_name": "Issam Rafihi", "link": "https://stackoverflow.com/users/9919938/issam-rafihi"}, "is_accepted": false, "score": 0, "last_activity_date": 1564555851, "last_edit_date": 1564555851, "creation_date": 1564555446, "answer_id": 57284730, "question_id": 57284670, "link": "https://stackoverflow.com/questions/57284670/how-do-i-copy-text-from-file-to-array-of-strings/57284730#57284730", "title": "How do i copy text from file to array of strings?", "body": "<p>Try changing the name of your array (list) to something else. And tell us what happens</p>\n\n<p>Note: Add an extra condition in the while loop <code>&amp;&amp; i &lt; 100</code></p>\n\n<p><strong>This works for me</strong></p>\n\n<pre><code>char arr[100][100];\nchar word[100];\nint i = 0;\n\nFILE * fp = fopen(filename, \"r+\");\nwhile (!feof(fp) &amp;&amp; i &lt; 100)\n    fscanf(fp, \"%s\", arr[i++]);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 477, "user_id": 11795725, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZeIig.png?s=128&g=1", "display_name": "nipun-kavishka", "link": "https://stackoverflow.com/users/11795725/nipun-kavishka"}, "edited": false, "score": 0, "creation_date": 1564558327, "post_id": 57285411, "comment_id": 101065931, "body": "check this code if you want to modify yours  <a href=\"https://stackoverflow.com/questions/7374062/how-do-i-count-the-number-of-words-in-a-text-file-using-c\" title=\"how do i count the number of words in a text file using c\">stackoverflow.com/questions/7374062/&hellip;</a>"}], "tags": [], "owner": {"reputation": 477, "user_id": 11795725, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZeIig.png?s=128&g=1", "display_name": "nipun-kavishka", "link": "https://stackoverflow.com/users/11795725/nipun-kavishka"}, "is_accepted": false, "score": 0, "last_activity_date": 1564558060, "creation_date": 1564558060, "answer_id": 57285411, "question_id": 57284670, "link": "https://stackoverflow.com/questions/57284670/how-do-i-copy-text-from-file-to-array-of-strings/57285411#57285411", "title": "How do i copy text from file to array of strings?", "body": "<p>The error is your array defined 'list' is out of bound. Because the text file may contain Char(in this code,word) <strong>more than 100</strong>. Try to add another condition to avoid that, just like </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main()\n{\n    char list[100][100];\n    char word[100];\n    int i = 0;\n    char filename[]=\"mytxt.txt\";\n    FILE * fp = fopen(filename, \"r+\");\n\n\n\n    while (!feof(fp) &amp;&amp; i&lt;100 )\n    {\n        fscanf(fp, \"%s\", word);\n        strcpy(list[i], word);\n        i++;\n    }\n\n    printf(list[2]);\n    return 0;\n}\n</code></pre>\n\n<p>or you can modify that code to get the char length of the text file and looping that.</p>\n"}, {"tags": [], "owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "is_accepted": false, "score": 0, "last_activity_date": 1564560188, "creation_date": 1564560188, "answer_id": 57285964, "question_id": 57284670, "link": "https://stackoverflow.com/questions/57284670/how-do-i-copy-text-from-file-to-array-of-strings/57285964#57285964", "title": "How do i copy text from file to array of strings?", "body": "<p>You will want to look at <a href=\"https://stackoverflow.com/questions/5431941/why-is-while-feoffile-always-wrong\"><strong>Why is while ( !feof (file) ) always wrong?</strong></a></p>\n\n<p>Whenever you are reading data in a loop, you control the loop with the read function, e.g.</p>\n\n<pre><code>#define ROWS 100    /* if you need a constant, #define one (or more) */\n#define COLS ROWS\n...\n    /* you control the read loop with the read function itself\n     * you must protect your ROW bounds with the counter and \n     * protect your COL bounds with the field-width modifier.\n     */\n    while (i &lt; ROWS &amp;&amp; fscanf (fp, \"%99s\", list[i]) == 1)\n        i++;                        /* increment counter */\n</code></pre>\n\n<p>Above you protect your <code>ROWS</code> (rows) array bound by only adding a new word while your counter is less than the number of rows available. You protect your <code>COLS</code> bound by using the <em>field-width</em> modifier to the <code>\"%s\"</code> <em>conversion specifier</em> to ensure no more than <code>99</code> characters are read into your array (saving room for +1 -- the <em>nul-terminating</em> character).</p>\n\n<p>(<strong>note:</strong> your <code>words</code> array was superfluous. You can read directly into <code>list</code>)</p>\n\n<p>You now have all words read from the file stored in list. It doesn't matter whether there are one or more words on each line, you read a word-at-a-time and the <code>\"%s\"</code> conversion specifier ignores leading whitespace (including <code>'\\n'</code>).</p>\n\n<p>A short example that reads words from the file provided as the first argument to your program (or reads from <code>stdin</code> by default if no argument was given) could be:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#define ROWS 100    /* if you need a constant, #define one (or more) */\n#define COLS ROWS\n\nint main (int argc, char **argv) {\n\n    char list[ROWS][COLS];  /* 2D array to hold strings (words) */\n    int i = 0;              /* counter for strings */\n    /* use filename provided as 1st argument (stdin by default) */\n    FILE *fp = argc &gt; 1 ? fopen (argv[1], \"r\") : stdin;\n\n    if (!fp) {  /* validate file open for reading */\n        perror (\"file open failed\");\n        return 1;\n    }\n\n    /* you control the read loop with the read function itself\n     * you must protect your ROW bounds with the counter and \n     * protect your COL bounds with the field-width modifier.\n     */\n    while (i &lt; ROWS &amp;&amp; fscanf (fp, \"%99s\", list[i]) == 1)\n        i++;                        /* increment counter */\n\n    for (int j = 0; j &lt; i; j++)     /* output stored words */\n        printf (\"list[%2d] : %s\\n\", j, list[j]);\n\n    if (fp != stdin)                /* close file if not stdin */\n        fclose (fp);\n}\n</code></pre>\n\n<p><strong>Example Input File</strong></p>\n\n<p>Taking a file with multiple words on some lines and a single word on others:</p>\n\n<pre><code>$ cat dat/dictwrds20.txt\na\nAAA\nAAAS\naardvark Aarhus Aaron ABA\nAbaba\naback\nabacus abalone abandon abase\nabash\nabate abbas abbe\nabbey\nabbot\nAbbott\n</code></pre>\n\n<p><strong>Example Use/Output</strong></p>\n\n<p>The code above reads each word into your <code>list</code> array without any problems:</p>\n\n<pre><code>$ ./bin/readlist dat/dictwrds20.txt\nlist[ 0] : a\nlist[ 1] : AAA\nlist[ 2] : AAAS\nlist[ 3] : aardvark\nlist[ 4] : Aarhus\nlist[ 5] : Aaron\nlist[ 6] : ABA\nlist[ 7] : Ababa\nlist[ 8] : aback\nlist[ 9] : abacus\nlist[10] : abalone\nlist[11] : abandon\nlist[12] : abase\nlist[13] : abash\nlist[14] : abate\nlist[15] : abbas\nlist[16] : abbe\nlist[17] : abbey\nlist[18] : abbot\nlist[19] : Abbott\n</code></pre>\n\n<p>Look things over and let me know if you have questions.</p>\n"}], "owner": {"reputation": 11, "user_id": 11862179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1539e5f88127cdfd0f39ed66920907a1?s=128&d=identicon&r=PG&f=1", "display_name": "ascii7", "link": "https://stackoverflow.com/users/11862179/ascii7"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 260, "favorite_count": 1, "answer_count": 3, "score": 1, "last_activity_date": 1564568434, "creation_date": 1564555145, "last_edit_date": 1564568434, "question_id": 57284670, "link": "https://stackoverflow.com/questions/57284670/how-do-i-copy-text-from-file-to-array-of-strings", "title": "How do i copy text from file to array of strings?", "body": "<p>Im trying to write a function that, given a filename will read strings from the file to an array of strings. This array (list) will then be returned by the function.</p>\n\n<p>I've tried list being of type char * as well as an array of [50][100] where 50 is the maximum number of words in a list and 100 is the maximum length of a word. I've also tried both copying the word to an index in the array using strcpy and setting an index in the list to word (list[i] = word).</p>\n\n<pre><code>char list[100][100];\nchar word[100];\nint i = 0;\nFILE * fp = fopen(filename, \"r+\");\n\nwhile (!feof(fp)) {\n    fscanf(fp, \"%s\", word);\n    strcpy(list[i], word);\n    i++;\n}\n</code></pre>\n\n<p>When i run code that calls this function (and no other function) I get a segmentation fault 11.</p>\n\n<hr>\n\n<p>EDIT: I have changed the code to run as below:</p>\n\n<pre><code>char arr[100][100];\n\n    int i = 0;\n\n    FILE * fp = fopen(\"collection.txt\", \"r+\");\n    while (fscanf(fp, \"%s\", arr[i]) == 1 &amp;&amp; i &lt; 100) {\n        i++;\n    }\n</code></pre>\n\n<p>It works when i test it in a main function however I can't get it to work when calling it as a function. I had defined the function as:</p>\n\n<pre><code>char get_list (char * filename);\n</code></pre>\n\n<p>and called this function from a main function using</p>\n\n<pre><code>char list = get_list (\"testfile.txt\");\n</code></pre>\n\n<p>and the compiler is giving warning:</p>\n\n<pre><code>warning: incompatible pointer to integer conversion returning 'char [100][100]' from a function with result type 'char' [-Wint-conversion]\n</code></pre>\n\n<p>How should this function be defined and called?</p>\n"}, {"tags": ["c", "pointers", "buffer"], "answers": [{"comments": [{"owner": {"reputation": 730, "user_id": 9360663, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eAhe5.png?s=128&g=1", "display_name": "po.pe", "link": "https://stackoverflow.com/users/9360663/po-pe"}, "edited": false, "score": 0, "creation_date": 1564557236, "post_id": 57284876, "comment_id": 101065373, "body": "Could you reveal these quirks? :) I&#39;ll see what I can do with memcpy, already thought about it but somehow felt there should be an easier way"}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1564577264, "post_id": 57284876, "comment_id": 101076627, "body": "Note that pointer arithmetric or dereference on <code>void*</code> is non-standard compiler extension. Workaround is to first cast pointer to <code>unsigned char *</code> (or <code>uint8_t *</code>)."}, {"owner": {"reputation": 5397, "user_id": 11294831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M9BL5.png?s=128&g=1", "display_name": "the busybee", "link": "https://stackoverflow.com/users/11294831/the-busybee"}, "reply_to_user": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1564578625, "post_id": 57284876, "comment_id": 101077457, "body": "@user694733 That&#39;s right. The change will be another increment towards a better source code."}], "tags": [], "owner": {"reputation": 5397, "user_id": 11294831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M9BL5.png?s=128&g=1", "display_name": "the busybee", "link": "https://stackoverflow.com/users/11294831/the-busybee"}, "is_accepted": false, "score": 0, "last_activity_date": 1564576145, "last_edit_date": 1564576145, "creation_date": 1564556072, "answer_id": 57284876, "question_id": 57284668, "link": "https://stackoverflow.com/questions/57284668/ring-buffer-handler-for-individual-types/57284876#57284876", "title": "Ring-Buffer Handler for individual types", "body": "<p>Take a look at <code>memcpy()</code> and friends. Since you can't use a simple assignment when you can't provide a type you need to copy an untyped block of storage.</p>\n\n<p>Please raise the warning level of your compile command as high as possible. Your provided source has some quirks. ;-)</p>\n\n<p><strong>EDIT 1</strong></p>\n\n<p>Quirks found:</p>\n\n<p>Warnings reported by GCC 8.1.0 (MinGW 64 bit) with <code>-Wall -Wextra</code> after adding</p>\n\n<pre><code>#include &lt;stdbool.h&gt;\n#include &lt;stdint.h&gt;\n#include &lt;stdio.h&gt;\n</code></pre>\n\n<p><code>buf_init</code> has unused parameters, <code>element_size</code> and <code>max</code>. The source uses constants.</p>\n\n<p>And there are warnings about dereferencing <code>void*</code> pointers and assigning the element to be added. Of course, because the source was not meant to be correct.</p>\n\n<p>I would also use <code>size_t</code> also as type of <code>element_size</code> because it represents a size.</p>\n\n<p>With <code>-pedantic</code> GCC warns about pointer arithmetic. But we do this on purpose.</p>\n\n<p><strong>EDIT 2</strong></p>\n\n<p>The warning about dereferencing a <code>void*</code> pointer is correct, so replace each of</p>\n\n<pre><code>&amp;handle-&gt;buffer[offset]\n</code></pre>\n\n<p>by this</p>\n\n<pre><code>handle-&gt;buffer + offset\n</code></pre>\n\n<p>You have to implement address calculation \"by hand\".</p>\n\n<p>If you use an index instead of an offset you would have to add a multiplication by the element's size:</p>\n\n<pre><code>handle-&gt;buffer + index * handle-&gt;element_size\n</code></pre>\n\n<p>An additional issue: <code>memcpy()</code> expects a pointer as the second parameter... This is my proposal:</p>\n\n<pre><code>void buf_add(ring_buffer_t * handle, void *element) {\n    if (handle-&gt;head == handle-&gt;max) {\n        handle-&gt;head = 0;\n    } \n    memcpy(handle-&gt;buffer + handle-&gt;head, element, handle-&gt;element_size);\n    handle-&gt;head += handle-&gt;element_size;\n}\n</code></pre>\n"}], "owner": {"reputation": 730, "user_id": 9360663, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eAhe5.png?s=128&g=1", "display_name": "po.pe", "link": "https://stackoverflow.com/users/9360663/po-pe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1564576145, "creation_date": 1564555140, "last_edit_date": 1564560769, "question_id": 57284668, "link": "https://stackoverflow.com/questions/57284668/ring-buffer-handler-for-individual-types", "title": "Ring-Buffer Handler for individual types", "body": "<p>I'd like to build a ring buffer API but instead of creating the buffer dynamically using malloc() in the API itself I want to pass the already existing array of variable types (uint8_t, uint16_t, etc.).</p>\n\n<p>So I thought best way to achieve this would be to declare a struct holding all the required information and the required API functions</p>\n\n<pre><code>typedef struct ring_buffer {\n    void * buffer;\n    uint8_t element_size;\n    size_t head;\n    size_t tail;\n    size_t max;\n    bool full;\n} ring_buffer_t;\n\nring_buffer_t buf_init(void * buffer, uint8_t element_size, size_t max);\nvoid buf_add(ring_buffer_t * handle, uint8_t element);\nbool buf_is_emtpy(ring_buffer_t * handle);\nvoid* buf_pop(ring_buffer_t * handle);\n\nring_buffer_t buf_init(void * buffer, uint8_t element_size, size_t max){\n    return (ring_buffer_t){.buffer = buffer, .element_size = 2, .head=0, .tail=0, .max=64, .full=false};\n}\n\nvoid buf_add(ring_buffer_t * handle, const uint8_t element){\n    if(handle-&gt;head == handle-&gt;max){\n        handle-&gt;head = 0;\n    } \n    printf(\"adding %d at position %d\\n\", element, (uint8_t)handle-&gt;head);\n    handle-&gt;buffer[handle-&gt;head] = element;\n    handle-&gt;head += handle-&gt;element_size;\n}\n\nvoid* buf_pop(ring_buffer_t * handle){\n    void* ret;\n    if(handle-&gt;tail &lt; handle-&gt;head-1){\n        printf(\"Tail is at position %d\\n\", (uint8_t)handle-&gt;tail);\n        ret = &amp;handle-&gt;buffer[handle-&gt;tail];\n        handle-&gt;tail += handle-&gt;element_size;\n    } else {\n        printf(\"Tail is at position %d\\n\", (uint8_t)handle-&gt;tail);\n        ret = &amp;handle-&gt;buffer[handle-&gt;tail];\n    }\n    return ret;\n}\n\nbool buf_is_emtpy(ring_buffer_t * handle){\n    if(handle-&gt;head == handle-&gt;tail){\n        return true;\n    } else {\n        return false;\n    }\n}\n</code></pre>\n\n<p>But that doesn't work as void* don't seem to be the right thing to handle this. How can I deal with pointers I do know the size at the time I create the struct? Because in the buf_add() I'd need to cast the <code>handle-&gt;buffer</code> to the correct pointer type in order to add <code>element</code>. </p>\n\n<p>What would be the right approach for such a problem?</p>\n\n<hr>\n\n<p>Based on the given answer I changed the line</p>\n\n<p><code>handle-&gt;buffer[handle-&gt;head] = element;</code></p>\n\n<p>to</p>\n\n<p><code>memcpy(&amp;handle-&gt;buffer[handle-&gt;head], element, handle-&gt;element_size);</code></p>\n\n<p>What works so far but still gives me a warning that I'm <code>dereferencing 'void *' pointer</code> what is true of course but how would a correct dereferencing look like in this case?</p>\n"}, {"tags": ["c", "local-variables"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1564553489, "post_id": 57284257, "comment_id": 101063678, "body": "You\u2019re probably wrong. The two conditional variables would probably occupy the same space."}, {"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 0, "creation_date": 1564553677, "post_id": 57284257, "comment_id": 101063759, "body": "No, you\u2019re not right about that, and tighter scope is generally cleaner even before taking into account the more descriptive names, so the first version is better imo."}, {"owner": {"reputation": 33, "user_id": 11768464, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/761c9ed1ee58ae3d378b80a54e0a8411?s=128&d=identicon&r=PG&f=1", "display_name": "ElvisIsAlive", "link": "https://stackoverflow.com/users/11768464/elvisisalive"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1564553745, "post_id": 57284257, "comment_id": 101063790, "body": "@Jonathan Leffler: In that case, it is this due compiler optimisation, I assume? Do you have a reference for this topic? Assuming using the code in a function definition, wouldn&#39;t there be two local variables created, right?"}, {"owner": {"reputation": 1447, "user_id": 6746897, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1eb640fcdc6847c55c189ceddb6afca5?s=128&d=identicon&r=PG&f=1", "display_name": "Julien", "link": "https://stackoverflow.com/users/6746897/julien"}, "edited": false, "score": 0, "creation_date": 1564554426, "post_id": 57284257, "comment_id": 101064088, "body": "In first version Thehe 2 vars will not exist at same moment due to scope limitation.  So they will probably end in same ram address,  exactly as in second option.  What is really important here is could the temperature change between two call? To avoid any side effects.  In second option,  you can also factorise the sendMessage so I would prefer this option for code size even if compiler may do it"}, {"owner": {"reputation": 33, "user_id": 11768464, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/761c9ed1ee58ae3d378b80a54e0a8411?s=128&d=identicon&r=PG&f=1", "display_name": "ElvisIsAlive", "link": "https://stackoverflow.com/users/11768464/elvisisalive"}, "reply_to_user": {"reputation": 1447, "user_id": 6746897, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1eb640fcdc6847c55c189ceddb6afca5?s=128&d=identicon&r=PG&f=1", "display_name": "Julien", "link": "https://stackoverflow.com/users/6746897/julien"}, "edited": false, "score": 0, "creation_date": 1564555489, "post_id": 57284257, "comment_id": 101064527, "body": "@Julien: You are right regarding the change of temperature, the safer way would be a variable holding the return value of <code>GetTemperature()</code>. @Ry: Well, the struct variable itself holds the actual description. So, only looking at the variable identifiers, I personally would not mind using the more generic <code>err</code> identifier. But that&#39;s more a personal thing I guess. Thanks for your answers everybody!"}], "answers": [{"comments": [{"owner": {"reputation": 1447, "user_id": 6746897, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1eb640fcdc6847c55c189ceddb6afca5?s=128&d=identicon&r=PG&f=1", "display_name": "Julien", "link": "https://stackoverflow.com/users/6746897/julien"}, "edited": false, "score": 0, "creation_date": 1564554543, "post_id": 57284468, "comment_id": 101064124, "body": "Not identical due to getTemp being called twice if temperature changes in first version and not in second.  The rest is clear"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "reply_to_user": {"reputation": 1447, "user_id": 6746897, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1eb640fcdc6847c55c189ceddb6afca5?s=128&d=identicon&r=PG&f=1", "display_name": "Julien", "link": "https://stackoverflow.com/users/6746897/julien"}, "edited": false, "score": 0, "creation_date": 1564554587, "post_id": 57284468, "comment_id": 101064144, "body": "@Julien ah true dat :d well, if there were if-elseif-else ladder"}], "tags": [], "owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "is_accepted": true, "score": 1, "last_activity_date": 1564555675, "last_edit_date": 1564555675, "creation_date": 1564554177, "answer_id": 57284468, "question_id": 57284257, "link": "https://stackoverflow.com/questions/57284257/conditional-creation-of-local-variables-in-function/57284468#57284468", "title": "(Conditional?) creation of local variables in function", "body": "<p>The lifetime of a variable with <em>automatic storage duration</em> is until the end of the block. Storage will be guaranteed and it will retain constant address (i.e. the address given by e.g. <code>&amp;</code>) until the end of the block, and after that all pointers to that object will become indeterminate.</p>\n\n<p>The C standard does <strong>not</strong> say that <code>low</code> and <code>high</code> must occupy the same portion of memory! The storage must be guaranteed until the end of the block containing the declaration, but it can be around longer too.  On the other hand the as-if rule says that the program needs to only behave as if it was a program compiled for the abstract machine according to the rules of the C standard, so a high-quality implementation would probably</p>\n\n<ul>\n<li>not reserve memory for both <code>low</code> and <code>high</code> simultaneously at different addresses, <strong>and</strong></li>\n<li>not reserve memory for <code>err</code> in case the <code>else</code> branch is taken.</li>\n</ul>\n\n<p>In effect making the execution behaviour of these 2 virtually identical.</p>\n\n<p>The difference is mostly stylistic: in your version there is less to type, and the original version accommodates for bad compilers.</p>\n"}], "owner": {"reputation": 33, "user_id": 11768464, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/761c9ed1ee58ae3d378b80a54e0a8411?s=128&d=identicon&r=PG&f=1", "display_name": "ElvisIsAlive", "link": "https://stackoverflow.com/users/11768464/elvisisalive"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 57284468, "answer_count": 1, "score": 0, "last_activity_date": 1564555681, "creation_date": 1564553217, "last_edit_date": 1564555681, "question_id": 57284257, "link": "https://stackoverflow.com/questions/57284257/conditional-creation-of-local-variables-in-function", "title": "(Conditional?) creation of local variables in function", "body": "<p>I came across this [question]: <a href=\"https://stackoverflow.com/questions/57181087/how-can-i-store-values-into-a-multi-parameter-struct-and-pass-typedef-struct-to/57181462#57181462\">How can I store values into a multi-parameter struct and pass typedef struct to a function?</a>.\nI suggested declaring a variable of dtErrorMessage once before the if and use it for both conditions instead of declaring two different variables as shown here:</p>\n\n<pre><code>// Initial version\nif(GetTemperature() &lt;= -20)\n{\n    dtErrorMessage low;\n    low.errorCode=ERROR_CODE_UNDER_TEMP;\n    low.temperature=GetTemperature();\n    SendErrorReport(&amp;low);\n}\n\nif(GetTemperature() &gt;= 160)\n{\n    dtErrorMessage high;\n    high.errorCode=ERROR_CODE_OVER_TEMP;\n    high.temperature=GetTemperature();\n    SendErrorReport(&amp;high);\n}\n\n\n// My version\ndtErrorMessage err;\nint8_t temp = GetTemperature();       // Do not consider change during evaluation\n\nif(temp &lt;= -20)\n{\n    err.errorCode   = ERROR_CODE_UNDER_TEMP;\n    err.temperature = temp;\n    SendErrorReport(&amp;err);\n}\nelse if(temp &gt;= 160)\n{\n    err.errorCode   = ERROR_CODE_OVER_TEMP;\n    err.temperature = temp ;\n    SendErrorReport(&amp;err);\n}\nelse\n{\n  // Do not send error report \n}\n</code></pre>\n\n<p>My question is: (Under the embedded aspect,) am I right, that this way there will be two local variables created in RAM regardless of the condition? Consequently, it would reduce the reqired RAM using one unconditional variable declaration before the if and then using it for both conditions, right?</p>\n\n<p>I couldn't find the correct terms to search for getting this answered myself.</p>\n"}, {"tags": ["c", "xml", "libxml2"], "comments": [{"owner": {"reputation": 15619, "user_id": 1548468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0745dce203d52699e63a575b3103ad70?s=128&d=identicon&r=PG", "display_name": "Botje", "link": "https://stackoverflow.com/users/1548468/botje"}, "edited": false, "score": 1, "creation_date": 1564555073, "post_id": 57284237, "comment_id": 101064358, "body": "Have you tried <a href=\"http://www.xmlsoft.org/FAQ.html#Compilatio\" rel=\"nofollow noreferrer\">following the compilation instructions</a> or considered a <a href=\"https://www.zlatkovic.com/projects/libxml/\" rel=\"nofollow noreferrer\">binary package</a>?"}, {"owner": {"reputation": 5397, "user_id": 11294831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M9BL5.png?s=128&g=1", "display_name": "the busybee", "link": "https://stackoverflow.com/users/11294831/the-busybee"}, "edited": false, "score": 1, "creation_date": 1564556615, "post_id": 57284237, "comment_id": 101065049, "body": "Would you mind to give us more details, please? Which files did you download, where did you install them in which way, which &quot;flavour&quot; of MinGW is installed, what command lines did you use, ...? Please show us the source of your test program and the error messages you got. Unfortunately there is no thing like a crystal ball we could look into. ;-)"}, {"owner": {"reputation": 227, "user_id": 6844163, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dD0t6.png?s=128&g=1", "display_name": "Ashwant Manikoth", "link": "https://stackoverflow.com/users/6844163/ashwant-manikoth"}, "edited": false, "score": 0, "creation_date": 1564557000, "post_id": 57284237, "comment_id": 101065247, "body": "i have downloaded libxml,libxslt,xmlsec,iconv files which contains the header files for libxml2. Added them to C:\\gcc\\lib\\include\\ where the rest of the header files exist. but the gcc cant recognize them while including them in  program, gcc <code>xml2-config --cflags --libs</code> test.c it says xml2-config not found. i think the header files are linked but some other error as i copied and pasted the header files instead of installing the libxml2 extension in original way."}], "owner": {"reputation": 227, "user_id": 6844163, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dD0t6.png?s=128&g=1", "display_name": "Ashwant Manikoth", "link": "https://stackoverflow.com/users/6844163/ashwant-manikoth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 698, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1564554726, "creation_date": 1564553099, "last_edit_date": 1564554726, "question_id": 57284237, "link": "https://stackoverflow.com/questions/57284237/how-to-install-libxml2-for-c-program-in-gcc-mingw-compiler-in-windows", "title": "how to install libxml2 for c program in gcc mingw compiler in windows?", "body": "<p>I have tried downloading the libxml,libxslt packages and adding the header files to the gcc compiler header files directory, but its not working.</p>\n\n<p>Any one know how to install them properly?</p>\n"}, {"tags": ["c", "cs50"], "comments": [{"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 2, "creation_date": 1564551612, "post_id": 57283901, "comment_id": 101063008, "body": "<code>height - 1</code> is almost never <b>less than or equal to 0</b>. Also your other loop is wrong, for height iterations one does <code>0</code> to <b><code>&lt;</code></b> <code>height</code>. And finally, there are countless duplicates in Stack Overflow <b>and</b> <a href=\"https://cs50.stackexchange.com\">cs50.stackexchange.com</a>"}], "answers": [{"tags": [], "owner": {"reputation": 63, "user_id": 9918466, "user_type": "registered", "profile_image": "https://graph.facebook.com/2486510041374681/picture?type=large", "display_name": "Dan Sutton", "link": "https://stackoverflow.com/users/9918466/dan-sutton"}, "is_accepted": false, "score": 0, "last_activity_date": 1565123564, "creation_date": 1565123564, "answer_id": 57383621, "question_id": 57283901, "link": "https://stackoverflow.com/questions/57283901/having-trouble-right-aligning-pyramid-for-mario-problem-set/57383621#57383621", "title": "Having trouble right-aligning pyramid for Mario problem set", "body": "<p>As Antti said, in your 'spaces' loop, <code>height - 1</code> on the first iteration of i (so where i = 0), will never be &lt; or = to 0 (unless height is set to 1). </p>\n\n<p>How many spaces should you print before the # on the first line if your height is set to 5? Is it 4? </p>\n\n<p>So if on the first line int Space = 0, height = 5, what loop code would achieve a result of 4? But consider on the next iteration of Space if int Space = 1, Height = 5 what loop code could achieve a result of 3?</p>\n\n<pre><code> for (space = 0; \"this needs to to = 4\" ; space++)\n        {\n            printf(\" \");\n        }\n</code></pre>\n\n<pre><code> for (space = 1; \"this needs to to = 3\" ; space++)\n        {\n            printf(\" \");\n        }\n</code></pre>\n\n<p>The value of 'spaces' changes on every iteration, could you use this? </p>\n"}], "owner": {"reputation": 21, "user_id": 11828243, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3aeb36952e253b9b796d03fff50a0cf?s=128&d=identicon&r=PG&f=1", "display_name": "redautumnleaves", "link": "https://stackoverflow.com/users/11828243/redautumnleaves"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 368, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1565123564, "creation_date": 1564551482, "question_id": 57283901, "link": "https://stackoverflow.com/questions/57283901/having-trouble-right-aligning-pyramid-for-mario-problem-set", "title": "Having trouble right-aligning pyramid for Mario problem set", "body": "<p>I am currently doing the Mario problem (less comfortable) for Week 1 of CS50. So far, I can print the hashes of the pyramid, but I am having trouble right-justifying it with the spaces. Would someone be able to pinpoint where I am going wrong? Thank you so much in advance. </p>\n\n<pre><code>#include &lt;cs50.h&gt;\n#include &lt;stdio.h&gt;\n\nint main(void)\n{\nint hashes;\nint space;\nint height;\n\ndo \n{\n    height = get_int(\"height: \");\n}\nwhile (height &lt; 0 || height &gt; 5);\n{\n    for (int i = 0; i &lt;= height; i++)\n    {\n        for (space = (height - 1); space &lt;= 0; space++)\n        {\n            printf(\" \");\n        }\n\n        for (hashes = 1; hashes &lt;= i; hashes++)\n        {\n            printf(\"#\");\n        }\n        printf(\"\\n\");\n\n    }\n\n\n  }\n\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 3, "creation_date": 1564550842, "post_id": 57283749, "comment_id": 101062721, "body": "You have 6 formatting fields in your format string, but you&#39;re only writing to 1 variable <code>text</code>. That causes undefined behavior."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 1, "creation_date": 1564550976, "post_id": 57283749, "comment_id": 101062760, "body": "You want to <i>print</i> it with <code>fscanf</code>? Do you know what <code>fscanf</code> does?"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1564551158, "post_id": 57283749, "comment_id": 101062836, "body": "You are not checking the result of fopen."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1564551365, "post_id": 57283749, "comment_id": 101062921, "body": "@Barmar where is this specified?"}, {"owner": {"reputation": 5295, "user_id": 2513200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3d4b041c512a4e708a42494eb465b40f?s=128&d=identicon&r=PG", "display_name": "Hulk", "link": "https://stackoverflow.com/users/2513200/hulk"}, "edited": false, "score": 0, "creation_date": 1564551461, "post_id": 57283749, "comment_id": 101062953, "body": "related: <a href=\"https://stackoverflow.com/q/3351809/2513200\">Reading file using fscanf() in C</a>"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 2, "creation_date": 1564551471, "post_id": 57283749, "comment_id": 101062960, "body": "The documentation of the <code>scanf</code> family of functions. Each formatting operator needs a corresponding variable to write to."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1564551615, "post_id": 57283749, "comment_id": 101063011, "body": "You can use <code>%*s</code> to specify that a field should be parsed but not written to a variable."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11231270"}, "edited": false, "score": 0, "creation_date": 1564551753, "post_id": 57283749, "comment_id": 101063056, "body": "Ya thats a silly mistake i made. I failed to add 6 variables to save 6 data in a row. Thank you all for your solutions"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1564569295, "post_id": 57283749, "comment_id": 101072129, "body": "@Barmar sorry misunderstanding on my part, I was thinking about something different."}], "answers": [{"comments": [{"owner": {"reputation": 5295, "user_id": 2513200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3d4b041c512a4e708a42494eb465b40f?s=128&d=identicon&r=PG", "display_name": "Hulk", "link": "https://stackoverflow.com/users/2513200/hulk"}, "edited": false, "score": 1, "creation_date": 1564552101, "post_id": 57283892, "comment_id": 101063156, "body": "In addition to that, it would be a good idea to check the return value of <code>fopen</code> as well as ensuring that the return value of <code>fscanf</code> is the expected number of arguments, instead of just checking it is not <code>EOF</code>."}], "tags": [], "owner": {"reputation": 362, "user_id": 9919938, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-rwSWEOoBBm4/AAAAAAAAAAI/AAAAAAAAAEs/FyBDyLid5k4/photo.jpg?sz=128", "display_name": "Issam Rafihi", "link": "https://stackoverflow.com/users/9919938/issam-rafihi"}, "is_accepted": false, "score": 1, "last_activity_date": 1564551423, "creation_date": 1564551423, "answer_id": 57283892, "question_id": 57283749, "link": "https://stackoverflow.com/questions/57283749/how-to-read-data-in-a-file-using-fscanf/57283892#57283892", "title": "How to read data in a file using fscanf", "body": "<p>Your mistake is the number of variables you passed into <code>fscanf</code>. \nIf you want to read 6 strings you need to provide 6 string variables to save in</p>\n\n<p><strong>Like So</strong></p>\n\n<pre><code>FILE * file1;\nfile1 = fopen(\"Bank.txt\", \"r\");\nwhile (fscanf(file1, \"%s %s  %s  %s  %s  %s\", t1, t2, t3, t4, t5, t6) != EOF) {\n    printf(\"%s %s %s %s %s %s\\n\", t1, t2, t3, t4, t5, t6);\n}\nfclose(file1);\n</code></pre>\n\n<p>You have to instantiate all <code>t</code>s of course</p>\n"}, {"tags": [], "owner": {"reputation": 3940, "user_id": 2830116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/SnjA4.jpg?s=128&g=1", "display_name": "Rohan Kumar", "link": "https://stackoverflow.com/users/2830116/rohan-kumar"}, "is_accepted": false, "score": 2, "last_activity_date": 1564552323, "creation_date": 1564552323, "answer_id": 57284081, "question_id": 57283749, "link": "https://stackoverflow.com/questions/57283749/how-to-read-data-in-a-file-using-fscanf/57284081#57284081", "title": "How to read data in a file using fscanf", "body": "<p>As pointed out in answer and comments above, you need to provide six variables into the fscanf arguments. Also it would be better if you have a model for your data. I would suggest to use a <code>struct</code> and input all data into an array of <code>structs</code>, that way you would be able to manage it better rather than managing random variables.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\ntypedef struct Bank {\n    char name[100];\n    char date[100];\n    char opening[100];\n    char amount[100];\n    char type[100];\n    char closing[100];\n} Bank;\n\nint main() {\n    FILE *file1;\n    file1 = fopen(\"Bank.txt\",\"r\");\n\n    Bank bankList[100];\n    int nCustomers = 0;\n    while(fscanf(file1, \"%s%s%s%s%s%s\", bankList[nCustomers].name, bankList[nCustomers].date, bankList[nCustomers].opening, bankList[nCustomers].amount, bankList[nCustomers].type, bankList[nCustomers].closing) != EOF ){\n            printf(\"%s %s %s\\n\", bankList[nCustomers].name, bankList[nCustomers].date, bankList[nCustomers].opening);\n            nCustomers++;\n    }\n    fclose(file1);\n}\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user11231270"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1564556258, "creation_date": 1564550677, "last_edit_date": 1564556258, "question_id": 57283749, "link": "https://stackoverflow.com/questions/57283749/how-to-read-data-in-a-file-using-fscanf", "title": "How to read data in a file using fscanf", "body": "<p>I have a table format in a file. I want to print it using fscanf. The table looks like this with 6 columns and 4 rows.</p>\n\n<pre><code>Name       Date          Opening    Amount     Type             Closing\nThiluxan   21.05.2015    8500       4500       Withdrawal       4000\nBlack      05.02.2014    7896       6548       Withdrawal       1348\nWhitee     02.05.2015    8524       256394     Deposit          264918\n</code></pre>\n\n<pre class=\"lang-c prettyprint-override\"><code>FILE *file1;\nfile1 = fopen(\"Bank.txt\",\"r\");\nwhile(fscanf(file1, \"%s %s  %s  %s  %s  %s\", text) != EOF ) {\n    printf(\"%s\\n\", text);\n}\nfclose(file1);\n</code></pre>\n\n<p>The output doesn't show anything and it returns a blank screen</p>\n"}, {"tags": ["c", "linux-device-driver", "mmap", "dma", "reserved"], "comments": [{"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1564586789, "post_id": 57282806, "comment_id": 101082746, "body": "The only place I can see that returns <code>-EFAULT</code> in <code>get_user_pages_fast</code> is when the call to <code>access_ok</code> returns 0. To verify whether that is in fact the case, could you add a call to <code>access_ok</code> in your <code>mycooldev_write</code> and see if it returns 0 there too?"}, {"owner": {"reputation": 101, "user_id": 11353511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238ba3b07f6e47dee7d78ba26decd088?s=128&d=identicon&r=PG&f=1", "display_name": "riffic", "link": "https://stackoverflow.com/users/11353511/riffic"}, "reply_to_user": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1564607043, "post_id": 57282806, "comment_id": 101091554, "body": "Ok, I tried it and edited my <code>mycooldev_write</code> to show what I did.  <code>access_ok</code> did not return 0, meaning the call was successful. Arghh what does that mean?"}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1564663215, "post_id": 57282806, "comment_id": 101110854, "body": "That&#39;s a shame. The call to <code>access_ok</code> in <code>get_user_pages_fast</code> will actually see your <code>uaddr</code> as the address and your <code>npages &lt;&lt; PAGE_SHIFT</code> as the length, but I don&#39;t think that will make much difference (<code>access_ok</code> only does a basic range check on the address and length). I&#39;m not sure where your <code>PAGE_MASK_64</code> comes from. I guess it has the same value as <code>PAGE_MASK</code>?"}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1564664785, "post_id": 57282806, "comment_id": 101111703, "body": "Actually, there are a few places in &quot;mm/gup.c&quot; that could return <code>-EFAULT</code>, but they mostly seem related to problems faulting in the pages. That shouldn&#39;t be a problem for reserved memory as it shouldn&#39;t need faulting in."}, {"owner": {"reputation": 101, "user_id": 11353511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238ba3b07f6e47dee7d78ba26decd088?s=128&d=identicon&r=PG&f=1", "display_name": "riffic", "link": "https://stackoverflow.com/users/11353511/riffic"}, "reply_to_user": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1564677391, "post_id": 57282806, "comment_id": 101118990, "body": "Edited to add a comment about <code>PAGE_MASK_64</code>... I mean, it&#39;s probably not necessary for me to do it like this, but it&#39;s left over from some previous troubleshooting and it didn&#39;t seem to hurt, so I left it in..."}, {"owner": {"reputation": 101, "user_id": 11353511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238ba3b07f6e47dee7d78ba26decd088?s=128&d=identicon&r=PG&f=1", "display_name": "riffic", "link": "https://stackoverflow.com/users/11353511/riffic"}, "reply_to_user": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 1, "creation_date": 1564677527, "post_id": 57282806, "comment_id": 101119048, "body": "I&#39;m starting to think the pages do have to be faulted in. Can you explain your reasoning thinking they don&#39;t?  I&#39;m beginning to look into the <code>(*nopage)</code> or <code>(*fault)</code> function pointers in <code>vm_operations_struct</code>."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1564679869, "post_id": 57282806, "comment_id": 101120086, "body": "They may have to be faulted in to process virtual address space (possibly via the <code>(*nopage)</code> or <code>(*fault)</code> VM operations you mentioned), but I&#39;m thinking that if you are mmaping to reserved, physical memory, it should never be swapped out, so should never need paging in."}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1564720503, "post_id": 57282806, "comment_id": 101130727, "body": "IMHO but the mmap() function gets swappable pages, the file attached to it is precisely to swap the pages to a proper place.  Most probably the get_pages_fast will fail because your pages are not physically allocated."}], "owner": {"reputation": 101, "user_id": 11353511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238ba3b07f6e47dee7d78ba26decd088?s=128&d=identicon&r=PG&f=1", "display_name": "riffic", "link": "https://stackoverflow.com/users/11353511/riffic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 352, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1564677327, "creation_date": 1564544206, "last_edit_date": 1564677327, "question_id": 57282806, "link": "https://stackoverflow.com/questions/57282806/how-to-use-mmapd-reserved-kernel-memory-in-get-user-pages-fast", "title": "How to use mmap&#39;d reserved kernel memory in get_user_pages_fast()?", "body": "<p>I have reserved several GB of memory via <code>memmap=nn[KMG]$ss[KMG]</code> in the kernel cmd line parameters. I also have a custom char device driver which uses <code>mmap()</code> and <code>write()</code> from the <code>file_operations</code> struct and performs DMA operations to a custom PCIe device. I use the typical <a href=\"https://www.kernel.org/doc/Documentation/DMA-API-HOWTO.txt\" rel=\"nofollow noreferrer\">DMA API</a> to create the scatter-gather list.</p>\n\n<p>In my driver, <code>mmap()</code> is successful and I can read/write to this <code>io_remap_pfn_range()</code> memory all day long from user-space. My driver's <code>write()</code> function is supposed to use the mmap'd buffer to create a scatter-gather list.</p>\n\n<p>However, my driver's <code>write()</code> function fails with <code>EFAULT</code> when calling <code>get_user_pages_fast()</code> and I cannot explain why. If I use a malloc'd buffer instead of an mmap'd buffer from user-space everything works as expected.  <strong>It seems to be a problem with the way <code>get_user_pages_fast()</code> handles the mmap'd buffer. What's the workaround?</strong></p>\n\n<p>For example,</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>/* From user-space\n * What currently works but has poor performance\n */\n\nint fd;\nFILE *fdat;\nchar *buf;\nssize_t rc;\nsize_t len = 4*1024*1024*1024; /* 4GB */\n\nfd = open(\"/dev/mycooldev\", O_RDWR|O_SYNC);\nrc = posix_memalign(&amp;buf, 4096, len);\nfdat = fopen(\"mydat.bin\", \"r\");\nfread(buf, 1, len, fdat);\nfclose(fdat);\nrc = write(fd, buf, len);\nclose(fd);\n</code></pre>\n\n<pre class=\"lang-c prettyprint-override\"><code>/* From user-space\n * What I want to do, i.e. use the many GB of contiguous reserved memory\n */\n\nint fd;\nFILE *fdat;\nchar *buf;\nssize_t rc;\nsize_t len = 4*1024*1024*1024; /* 4GB */\n\nfd = open(\"/dev/mycooldev\", O_RDWR|O_SYNC);\nbuf = mmap(0, len, PROT_READ|PROT_WRITE, MAP_SHARED, fd, 0);\nfdat = fopen(\"mydat.bin\", \"r\");\nfread(buf, 1, len, fdat);\nfclose(fdat);\nrc = write(fd, buf, len);\nclose(fd);\n</code></pre>\n\n<p>Relevant <code>write()</code> function in my device driver:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>/* From the char device driver\n * buf is a pointer to the buffer returned from either \n * posix_memalign() or mmap(), but mmap() doesn't work\n * because of get_user_pages_fast()\n */\n\nssize_t mycooldev_write(struct file *file, char __user *buf, size_t len, loff_t *pos)\n{\n    int rc;\n    struct page **pages;\n    size_t npages;\n    struct sg_table sgt;\n    unsigned long uaddr, start, end;\n\n    ...\n\n    /* EDIT: I added this call per a request in comments */\n    if (access_ok(VERIFY_WRITE, buf, len) == 0) {\n        pr_err(\"Not allowed to access user address\\n\");\n        return -EFAULT;\n    }\n\n    uaddr = (unsigned long)buf;\n    start = uaddr &amp; PAGE_MASK_64; /* (0xFFFFFFFF00000000 | PAGE_MASK) */\n    end = uaddr + len + PAGE_SIZE - 1;\n    npages = (end - start) &gt;&gt; PAGE_SHIFT;\n\n    pages = kcalloc(npages, sizeof(struct page *), GFP_KERNEL);\n\n    /* This call fails with EFAULT when user passes in a buffer\n     * obtained with a call to mmap(). If user calls posix_memalign()\n     * to obtain their buffer, get_user_pages_fast() is successful.\n     */\n    rc = get_user_pages_fast(uaddr, npages, 1, pages);\n\n    rc = sg_alloc_table_from_pages(&amp;sgt, pages, npages, pos, len, GFP_KERNEL);\n\n    ...\n}\n</code></pre>\n\n<p>Why does <code>get_user_pages_fast()</code> not like my mmap'd buffer, but is fine with the malloc'd one? Any help is greatly appreciated.</p>\n"}, {"tags": ["python", "c", "structure", "ctypes"], "comments": [{"owner": {"reputation": 15260, "user_id": 1968182, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/E5nF2.jpg?s=128&g=1", "display_name": "Ulrich Eckhardt", "link": "https://stackoverflow.com/users/1968182/ulrich-eckhardt"}, "edited": false, "score": 0, "creation_date": 1565329844, "post_id": 57282055, "comment_id": 101326699, "body": "That C code you mention doesn&#39;t even compile. Please take the <a href=\"https://stackoverflow.com/tour\">tour</a> and read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>. Further, extract and provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 11861211, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-lSAN60YzgnU/AAAAAAAAAAI/AAAAAAAAGOY/CIchwODd70M/photo.jpg?sz=128", "display_name": "whatagreatdeal", "link": "https://stackoverflow.com/users/11861211/whatagreatdeal"}, "edited": false, "score": 0, "creation_date": 1565328586, "post_id": 57292171, "comment_id": 101326362, "body": "I did follow this way  def open_board(board_name, board_no, ch):     ...     abi = AAPBOARDINFO()     AcapGetBoardInfo(ctypes.byref(abi))     ref = abi.BOARDINDEX[0]     ... And it works! SO appreciate it"}, {"owner": {"reputation": 28355, "user_id": 4788546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2jWn.jpg?s=128&g=1", "display_name": "CristiFati", "link": "https://stackoverflow.com/users/4788546/cristifati"}, "reply_to_user": {"reputation": 3, "user_id": 11861211, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-lSAN60YzgnU/AAAAAAAAAAI/AAAAAAAAGOY/CIchwODd70M/photo.jpg?sz=128", "display_name": "whatagreatdeal", "link": "https://stackoverflow.com/users/11861211/whatagreatdeal"}, "edited": false, "score": 0, "creation_date": 1565690745, "post_id": 57292171, "comment_id": 101422716, "body": "@whatagreatdeal: Did this answer your question? If yes, please accept the answer, so that others are able to acknowledge it as well  (<a href=\"https://stackoverflow.com/help/someone-answers\">&#91;SO&#93;: What should I do when someone answers my question?</a>)."}], "tags": [], "owner": {"reputation": 28355, "user_id": 4788546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2jWn.jpg?s=128&g=1", "display_name": "CristiFati", "link": "https://stackoverflow.com/users/4788546/cristifati"}, "is_accepted": true, "score": 0, "last_activity_date": 1564653442, "last_edit_date": 1564653442, "creation_date": 1564580351, "answer_id": 57292171, "question_id": 57282055, "link": "https://stackoverflow.com/questions/57282055/reading-double-c-structures-of-dll-with-ctypes-in-python/57292171#57292171", "title": "Reading double c structures of Dll with Ctypes in Python", "body": "<p>Everything you need to know, can be found in the <a href=\"https://docs.python.org/3/library/ctypes.html#module-ctypes\" rel=\"nofollow noreferrer\">[Python 3.Docs]: ctypes - A foreign function library for Python</a>.</p>\n\n<p>There are a couple of problems with the code:</p>\n\n<ul>\n<li>Structure members are specified in the <strong><em>_fields_</em></strong> (<strong>not</strong> <em>_field_</em>) attribute</li>\n<li><code>char pBoardName[16]</code> maps to <code>ctypes.c_char * 16</code> (<strong>not</strong> <em>c_char_p</em>)</li>\n<li><em>HANDLE</em> should be mapped to <code>wintypes.HANDLE</code>. This kind of mismatch can (and most likely will) generate:\n\n<ul>\n<li><a href=\"https://stackoverflow.com/questions/52268294/python-ctypes-cdll-loadlibrary-instantiate-an-object-execute-its-method-priva/52272969#52272969\">[SO]: Python ctypes cdll.LoadLibrary, instantiate an object, execute its method, private variable address truncated (@CristiFati's answer)</a></li>\n<li><a href=\"https://stackoverflow.com/questions/53182796/python-ctypes-issue-on-different-oses/53185316#53185316\">[SO]: python ctypes issue on different OSes (@CristiFati's answer)</a></li>\n</ul></li>\n<li>Function prototype differs between <em>C</em> and <em>Python</em></li>\n<li>Using globals like <em>AapLib2</em> is best to be be avoided, but I left them unchanged as they are outside the question scope</li>\n</ul>\n\n<p>Here's a modified version of your code. Needless to say that I didn't actually test it, as I don't have the <em>.dll</em>:\n</p>\n\n<pre><code>#!/usr/bin/env python3\n\nimport sys\nimport ctypes\nfrom ctypes import wintypes\n\n\nclass BOARDINDEX(ctypes.Structure):\n    _fields_ = [\n        (\"nBoardName\", ctypes.c_char * 16),\n        (\"nBoardID\", ctypes.c_int),\n    ]\n\n\nclass AAPBOARDINFO(ctypes.Structure):\n    _fields_ = [\n        (\"nBoardNum\", ctypes.c_int),\n        (\"BOARDINDEX\", BOARDINDEX * 8),\n    ]\n\n\ndef open_board(board_name, board_no, ch):\n    AcapOpen = aaplib2.AcapOpen\n    AcapOpen.argtypes = [ctypes.c_char_p, ctypes.c_int, ctypes.c_int]\n    AcapOpen.restype = wintypes.HANDLE\n    ref = BOARDINDEX(board_name, board_no)  # Probably this line should be replaced by the 3 (commented) ones below (AcapGetBoardInfo prototype would have to be specified as well)\n    #abi = AAPBOARDINFO()\n    #AcapGetBoardInfo(ctypes.byref(abi))\n    #ref = abi.BOARDINDEX[0]\n    res = AcapOpen(ref.nBoardName, ref.nBoardID, ch)\n    return res\n\n\ndef main():\n    board_names = [\"ABC\", \"FWD\", \"HGW\"]\n    board_no = 0\n    ch = 1\n    aaplib2 = ctypes.WinDLL(\"AapLib2.dll\")\n    output = open_board(board_names[0], board_no, ch)\n    print(output)\n\n\nif __name__ == \"__main__\":\n    print(\"Python {0:s} {1:d}bit on {2:s}\\n\".format(\" \".join(item.strip() for item in sys.version.split(\"\\n\")), 64 if sys.maxsize &gt; 0x100000000 else 32, sys.platform))\n    main()\n    print(\"\\nDone.\")\n</code></pre>\n\n<p>Let me know how this works out for you.</p>\n"}], "owner": {"reputation": 3, "user_id": 11861211, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-lSAN60YzgnU/AAAAAAAAAAI/AAAAAAAAGOY/CIchwODd70M/photo.jpg?sz=128", "display_name": "whatagreatdeal", "link": "https://stackoverflow.com/users/11861211/whatagreatdeal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 127, "favorite_count": 0, "accepted_answer_id": 57292171, "answer_count": 1, "score": -1, "last_activity_date": 1565328556, "creation_date": 1564537361, "question_id": 57282055, "link": "https://stackoverflow.com/questions/57282055/reading-double-c-structures-of-dll-with-ctypes-in-python", "title": "Reading double c structures of Dll with Ctypes in Python", "body": "<p>I'v done researched a lot about this problem.. But there's no where and I couldn't find it. I'm trying to call double c structure by calling c dll. </p>\n\n<p>My question is, did i right way to declare \"Class Structure\" in python? I couldn't think that i'm right on my way. Because even though the Functions that I want to call from dll, It didn't come output anything. </p>\n\n<p>[Visual C++/C]</p>\n\n<p>I did try to C Syntax code,</p>\n\n<pre><code>typedef sturct {\n    int nBoardNum;\n    struct{\n        char  pBoardName[16];\n        int   nBoardID;\n    }BOARDINDEX[8];\n}AAPBOARDINFO, *PAAPBOARDINFO;\n\nHANDLE AcapOpen(char* cpBoardName, int nBoardNo, int nCh)\n</code></pre>\n\n<p>[Python]</p>\n\n<p>I changed Python Syntax like this.</p>\n\n<pre><code>import ctypes as c\n\nclass BOARDINDEX(c.Structure):\n    _field_ = [(\"nBoardName\", c.c_char_p * 16),(\"nBoardID\", c.c_int)]\n\nclass AAPBOARDINFO(c.Structure):\n    _field_ = [(\"nBoardNum\", c.c_int), (\"BOARDINDEX\", BOARDINDEX * 8)]\n\nAapLib2 = c.WinDLL(\"AapLib2.dll\")\n\nBoardName = [\"ABC\",\"FWD\",\"HGW\"]\nBoardNo = 0\nch = 1\n\noutput = Open(BoardName, BoardNo, ch)\n\ndef Open(BoardName, BoardNo, ch)\n\n    func = AapLib2.AcapOpen\n    func.argtypes = [c.POINTER(BOARDINDEX),c.c_int, c.c_int]\n    func.restype = c.c_int\n\n    ref = BOARDINDEX()\n\n    res = func(c.byref(ref.nBoardName),BoardNo, ch)\n    return res\n</code></pre>\n\n<p>Nothing outcomes when call Open() function... </p>\n\n<p>please consider my request and any answer would be great...</p>\n"}, {"tags": ["c", "assembly", "x86-64", "variadic-functions", "calling-convention"], "comments": [{"owner": {"reputation": 9461, "user_id": 8422330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c0f90445d03447c587d1e595d531f69?s=128&d=identicon&r=PG&f=1", "display_name": "prl", "link": "https://stackoverflow.com/users/8422330/prl"}, "edited": false, "score": 5, "creation_date": 1564536553, "post_id": 57281945, "comment_id": 101059922, "body": "No, there&#39;s no possible way for the callee to figure out how many parameters there are."}, {"owner": {"reputation": 1233, "user_id": 5366130, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ce3d4bd07d1115070e7727de382560ba?s=128&d=identicon&r=PG&f=1", "display_name": "Omid CompSCI", "link": "https://stackoverflow.com/users/5366130/omid-compsci"}, "edited": false, "score": 0, "creation_date": 1564537274, "post_id": 57281945, "comment_id": 101060057, "body": "You can use ... passed into a function and have any number of arguments, if that leads to any help"}, {"owner": {"reputation": 42504, "user_id": 1161878, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/0157ddd785dc01e95342e3661d34b42a?s=128&d=identicon&r=PG", "display_name": "Gene", "link": "https://stackoverflow.com/users/1161878/gene"}, "edited": false, "score": 1, "creation_date": 1564538303, "post_id": 57281945, "comment_id": 101060215, "body": "In nearly all C implementations, no. The original design of C depends on a contract between caller and callee that&#39;s up to the programmer to decide and enforce. For example printf&#39;s contract is that the number of <code>%</code> format specifiers will match the number of arguments."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1564551957, "post_id": 57281945, "comment_id": 101063119, "body": "Sometimes it isn&#39;t even possible to recover arguments unless you know their <b>types</b>."}], "answers": [{"comments": [{"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1564538822, "post_id": 57282186, "comment_id": 101060311, "body": "Yup, C doesn&#39;t have reflection so getting that from debug info would be a total hack."}], "tags": [], "owner": {"reputation": 33990, "user_id": 14768, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/b6aMa.png?s=128&g=1", "display_name": "Joshua", "link": "https://stackoverflow.com/users/14768/joshua"}, "is_accepted": false, "score": 2, "last_activity_date": 1564538561, "creation_date": 1564538561, "answer_id": 57282186, "question_id": 57281945, "link": "https://stackoverflow.com/questions/57281945/is-it-possible-to-count-the-function-variable-arguments-in-a-cdecl-with-inli/57282186#57282186", "title": "Is it possible to count the function (variable) arguments in a __cdecl with Inline ASM?", "body": "<p>No, you can't. It's impossible in the general case.</p>\n\n<p>In the specific case of compiling with debugging symbols on you have a shot at writing code to interpret your own symbols, but this compilation mode is frowned upon for release builds so writing this code is not recommended. It's also completely nonportable but you don't care about that constraint.</p>\n"}, {"tags": [], "owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "is_accepted": true, "score": 2, "last_activity_date": 1564538631, "creation_date": 1564538631, "answer_id": 57282195, "question_id": 57281945, "link": "https://stackoverflow.com/questions/57281945/is-it-possible-to-count-the-function-variable-arguments-in-a-cdecl-with-inli/57282195#57282195", "title": "Is it possible to count the function (variable) arguments in a __cdecl with Inline ASM?", "body": "<p>The only possible way for this to work is with a unique sentinel value (e.g. a <code>NULL</code> pointer) that marks the last argument.</p>\n\n<p>This normally only works when all the args are pointers, e.g. as used by the <a href=\"http://man7.org/linux/man-pages/man3/exec.3.html\" rel=\"nofollow noreferrer\">POSIX <code>execl(3)</code> functions</a> with signatures like </p>\n\n<pre><code>int execl(const char *pathname, const char *arg, ...\n                   /* (char  *) NULL */);\n</code></pre>\n\n<p>(Then you don't need inline asm; you can just use C VA_ARG macros.)</p>\n\n<hr>\n\n<p>Also, <code>rbp</code> is useless; you don't know whether or not the function was compiled with optimization enabled so it might not be a frame pointer at all.  If you want the frame address in GNU C, use <code>__builtin_frame_address(0)</code>.  (Look at the compiler-generated asm to see what it does.  IIRC, it forces <code>-fno-omit-frame-pointer</code> for that function and just gives you the value of <code>rbp</code>)</p>\n\n<p>And even getting a stack-frame address doesn't help you get register args (first 6 integer/pointer and first 8 FP args in x86-64 System V.  Or first 4 total args in Windows x64.)</p>\n\n<p>Declare your function as variadic and Use <code>VA_ARG</code> to read all the variadic args as <code>uint64_t</code> so you can check them for zero, or whatever bit-pattern you selected as your sentinel.</p>\n\n<p><strong>Obviously this requires the cooperation of the caller to pass a sentinel.</strong></p>\n\n<hr>\n\n<p>BTW, no calling convention called <code>__cdecl</code> exists for x86-64.  Microsoft calls theirs x64 <code>__fastcall</code> or <code>__vectorcall</code>.</p>\n"}], "owner": {"reputation": 3, "user_id": 11861106, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-R7JqoIVeYSM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfYqpUmaiYGmIRI8ljuIQa-3vi-Ew/photo.jpg?sz=128", "display_name": "Anxx Igloo", "link": "https://stackoverflow.com/users/11861106/anxx-igloo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 156, "favorite_count": 0, "accepted_answer_id": 57282195, "answer_count": 2, "score": 0, "last_activity_date": 1564538631, "creation_date": 1564536301, "last_edit_date": 1564537721, "question_id": 57281945, "link": "https://stackoverflow.com/questions/57281945/is-it-possible-to-count-the-function-variable-arguments-in-a-cdecl-with-inli", "title": "Is it possible to count the function (variable) arguments in a __cdecl with Inline ASM?", "body": "<p>Is it possible for the callee to iterate (and count) through the function call parameters by offsetting the stack base pointer (rbp) using the inline ASM (x86) without knowing the type or quantity of the arguments?</p>\n\n<p><code>void foo(char *arg, ...);</code></p>\n\n<p>I am using Intel compiler but its documentation states that it supports GCC style inline assembly. So GCC based example would be sufficient.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;inttypes.h&gt;\n\nint    main(int argc, char **argv){\n\n    uint64_t n;\n\n    __asm__ __volatile__(\n      \"movq %%rbp, %0\\n\\t\"\n      : \"=r\"(n)\n    );\n\n    printf(\"rbp = 0x%\" PRIx64 \"\\n\", n);\n    return 0;\n}\n</code></pre>\n\n<p><a href=\"https://stackoverflow.com/questions/22540825/how-to-access-stack-base-pointer-rbp-using-inline-assembly\">the code in this post</a></p>\n"}, {"tags": ["c#", "c", "sockets", "udp", "dtls"], "comments": [{"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 0, "creation_date": 1564546149, "post_id": 57281657, "comment_id": 101061572, "body": "The only way you can guarantee that kind of ordering is if the higher layer protocol implements stop-and-wait.  Maybe you&#39;d better implement dispatching packets from the base socket even if you open new sockets to shortcut future packets."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1564607643, "post_id": 57281657, "comment_id": 101091777, "body": "For the server to &#39;connect()` to the client, the client must have executed <code>socket()</code>, <code>bind()</code>, <code>listen()</code> and <code>accept()</code>.   Note: port 0 is a very bad idea to use for communication.  Infact any port number less than 1024 is a very bad idea.  <a href=\"https://www.iana.org/assignments/service-names-port-numbers/service-names-port-numbers.xhtml\" rel=\"nofollow noreferrer\">port numbers</a> gives the usage of the &#39;reserved&#39; port numbers (0...1023)  In general, to communicate on those ports, the &#39;firewall&#39; must be set to allow that communication"}, {"owner": {"reputation": 2425, "user_id": 693943, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bef0b29b7ebaec03aeff8accf444aefe?s=128&d=identicon&r=PG", "display_name": "Matthew Goulart", "link": "https://stackoverflow.com/users/693943/matthew-goulart"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1564697893, "post_id": 57281657, "comment_id": 101126702, "body": "@user3629249 we are talking about udp here.... And port 0 is neither a bad nor a good idea. It allows the socket engine to choose an ephemeral port. If that suits the application, then it should be used."}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1579224715, "post_id": 57281657, "comment_id": 105704280, "body": "@user3629249 Evidently you have never heard of <code>connect()</code> for UDP."}], "owner": {"reputation": 2425, "user_id": 693943, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bef0b29b7ebaec03aeff8accf444aefe?s=128&d=identicon&r=PG", "display_name": "Matthew Goulart", "link": "https://stackoverflow.com/users/693943/matthew-goulart"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 232, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1564533186, "creation_date": 1564533186, "question_id": 57281657, "link": "https://stackoverflow.com/questions/57281657/handling-multiple-udp-sockets-listening-on-the-same-endpoint", "title": "Handling multiple UDP sockets listening on the same endpoint", "body": "<p>I've been following (roughly) some example code <a href=\"https://github.com/nplab/DTLS-Examples/blob/master/src/dtls_udp_echo.c\" rel=\"nofollow noreferrer\">here</a> on writing a DTLS server that can handle multiple clients. In this example, which works quite well (I tried), the server listens on <code>INADDR_ANY</code> and port <code>0</code>.</p>\n\n<pre><code>fd = socket(server_addr.ss.ss_family, SOCK_DGRAM, 0);\nsetsockopt(fd, SOL_SOCKET, SO_REUSEADDR, (const void*) &amp;on, (socklen_t) sizeof(on));\nbind(fd, (const struct sockaddr *) &amp;server_addr, sizeof(struct sockaddr_in))\n</code></pre>\n\n<p>When a DGRAM is received, the server runs it through an OpenSSL method to generate a cookie and verify the client is <em>actually</em> at the address they say they are. Once that's done, the server <strong>creates a new socket bound to the same endpoint and does <code>connect()</code> to the new client's endpoint.</strong></p>\n\n<pre><code>bind(fd, (const struct sockaddr *) &amp;pinfo-&gt;server_addr, sizeof(struct sockaddr_in))\nconnect(fd, (struct sockaddr *) &amp;pinfo-&gt;client_addr, sizeof(struct sockaddr_in))\n</code></pre>\n\n<p>So at this point, there are 2 UDP sockets bound to the <em>same IP address and port</em>. One of them is <code>connect()</code>ed and the other is only bound. </p>\n\n<p>I've tried to do the same thing (in C#):</p>\n\n<pre><code>_sock = new Socket(AddressFamily.InterNetwork, SocketType.Dgram, ProtocolType.Udp);\n_sock.SetSocketOption(SocketOptionLevel.Socket, SocketOptionName.ReuseAddress, true);\n_sock.Bind(localEp);\n\nvar clientEndpoint = await DtlsListenAsync(ssl, _sock);\n\nvar clientSock = new Socket(AddressFamily.InterNetwork, SocketType.Dgram, ProtocolType.Udp);\nclientSock.SetSocketOption(SocketOptionLevel.Socket, SocketOptionName.ReuseAddress, true);\nclientSock.Bind(_localEp);\nclientSock.Connect(clientEndpoint);\n</code></pre>\n\n<p>Keep in mind, I've edited out most of the code for brevity.</p>\n\n<p>At this point, running <em>my</em> application fails miserably. It seems the socket created for the client never gets the messages. Basically any call to <code>await clientSock.ReceiveAsync()</code> hangs indefinitely.</p>\n\n<p><em>However</em>, if I debug and <strong>step through</strong> the code works. This leads me to believe that its a \"race\" between the sockets. Basically, can the client socket be created, bound and connected before the next DGRAM comes in and gets sent to the <em>original</em> socket.</p>\n\n<p>AFAIK, UDP sockets work on a <em>score</em> system. The kernel calculates a score based on how specific the rout is for a given DGRAM and sends it to the highest scoring socket. So, it seems to me that my server should work as well as the example... But it doesn't.</p>\n\n<p>So I'm not really asking if my <em>code</em> is right per se, but I'd like to know if what I'm trying to do makes any sense. Also if there are any considerations I haven't taken into account. Do sockets behave as I mentioned?</p>\n\n<p>My alternative if this method doesn't pan out is to use a single socket and maintain a hashtable of endpoints and dispatch the data to the appropriate client as it comes in. But TBH, I really like the idea of leveraging sockets to do the \"heavy lifting\" for me.</p>\n"}, {"tags": ["php", "c", "rsa", "phpseclib", "php-openssl"], "answers": [{"comments": [{"owner": {"reputation": 5834, "user_id": 2752520, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/6CORJ.jpg?s=128&g=1", "display_name": "Nelson Teixeira", "link": "https://stackoverflow.com/users/2752520/nelson-teixeira"}, "edited": false, "score": 0, "creation_date": 1564586659, "post_id": 57282853, "comment_id": 101082690, "body": "Now I got another problem. I checked against RSA public key. Not using client&#39;s certiticate. Do you know how to do check with the client certificate  ?"}, {"owner": {"reputation": 5834, "user_id": 2752520, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/6CORJ.jpg?s=128&g=1", "display_name": "Nelson Teixeira", "link": "https://stackoverflow.com/users/2752520/nelson-teixeira"}, "edited": false, "score": 0, "creation_date": 1564600595, "post_id": 57282853, "comment_id": 101089130, "body": "I could load the public key that way. But then I got unverified... And I thought my code better and realized that It&#39;s probably not being encrypted with the token&#39;s private key, once I only need the RSA public key to check the signature... I think I better open another question as this already deviates too far from the original question."}, {"owner": {"reputation": 14114, "user_id": 569976, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7872694d27b3b6fd8d71297a4799a82b?s=128&d=identicon&r=PG", "display_name": "neubert", "link": "https://stackoverflow.com/users/569976/neubert"}, "reply_to_user": {"reputation": 5834, "user_id": 2752520, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/6CORJ.jpg?s=128&g=1", "display_name": "Nelson Teixeira", "link": "https://stackoverflow.com/users/2752520/nelson-teixeira"}, "edited": false, "score": 1, "creation_date": 1564603734, "post_id": 57282853, "comment_id": 101090357, "body": "@NelsonTeixeira - you&#39;d probably have to do <code>$rsa-&gt;setSignatureMode(RSA::SIGNATURE_PKCS1)</code> again. But yah a new question might be more appropriate idk lol."}], "tags": [], "owner": {"reputation": 14114, "user_id": 569976, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7872694d27b3b6fd8d71297a4799a82b?s=128&d=identicon&r=PG", "display_name": "neubert", "link": "https://stackoverflow.com/users/569976/neubert"}, "is_accepted": true, "score": 1, "last_activity_date": 1564588041, "last_edit_date": 1564588041, "creation_date": 1564544582, "answer_id": 57282853, "question_id": 57281575, "link": "https://stackoverflow.com/questions/57281575/what-is-the-right-algorithm-for-digitally-signing-in-c-and-veryfing-in-php/57282853#57282853", "title": "What is the right algorithm for digitally signing in C and veryfing in PHP?", "body": "<p>For phpseclib do this before <code>$rsa-&gt;verify()</code>:</p>\n\n<pre><code>$rsa-&gt;setSignatureMode(RSA::SIGNATURE_PKCS1);\n</code></pre>\n\n<p>To do this with X.509 certs...</p>\n\n<pre><code>$x509 = new \\phpseclib\\File\\X509;\n$x509-&gt;loadX509('...');\n$rsa = $x509-&gt;getPublicKey();\n</code></pre>\n"}], "owner": {"reputation": 5834, "user_id": 2752520, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/6CORJ.jpg?s=128&g=1", "display_name": "Nelson Teixeira", "link": "https://stackoverflow.com/users/2752520/nelson-teixeira"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "accepted_answer_id": 57282853, "answer_count": 1, "score": 2, "last_activity_date": 1564588041, "creation_date": 1564532206, "last_edit_date": 1564544371, "question_id": 57281575, "link": "https://stackoverflow.com/questions/57281575/what-is-the-right-algorithm-for-digitally-signing-in-c-and-veryfing-in-php", "title": "What is the right algorithm for digitally signing in C and veryfing in PHP?", "body": "<p>I'm trying to digitally sign files/messages in C and verify the signature in PHP.\nI can verify it correctly in C, but when I try to import the signature and verify it in PHP it fails.</p>\n\n<p>I'm signing the message in C using this method:</p>\n\n<pre><code>bool RSASign( RSA* rsa,\n              const unsigned char* Msg,\n              size_t MsgLen,\n              unsigned char** EncMsg,\n              size_t* MsgLenEnc) {\n    EVP_MD_CTX* m_RSASignCtx = EVP_MD_CTX_create();\n    EVP_PKEY_assign_RSA(privkey, rsa);\n    if (EVP_DigestSignInit(m_RSASignCtx,NULL, EVP_sha256(), NULL,privkey)&lt;=0) {\n        return false;\n    }\n    if (EVP_DigestSignUpdate(m_RSASignCtx, Msg, MsgLen) &lt;= 0) {\n        return false;\n    }\n    if (EVP_DigestSignFinal(m_RSASignCtx, NULL, MsgLenEnc) &lt;=0) {\n        return false;\n    }\n    *EncMsg = (unsigned char*)malloc(*MsgLenEnc);\n    if (EVP_DigestSignFinal(m_RSASignCtx, *EncMsg, MsgLenEnc) &lt;= 0) {\n        return false;\n    }\n    EVP_MD_CTX_free(m_RSASignCtx);\n    return true;\n}\n</code></pre>\n\n<p>As I said, it's working fine if I try to validate this signature only in C. \nThe private key is obtained earlier in the code with this line of code:</p>\n\n<pre><code>pin = (char *) getpass(\"Enter PIN: \");\nrc = PKCS11_login(slot, 0, pin);\nauthkey = PKCS11_find_key(&amp;certs[0]);\n</code></pre>\n\n<p>If it's necessary I can post the code on how I get the slot, but I don't think it's necessary for now.</p>\n\n<p>I'm trying to validate the signature in PHP using this code:</p>\n\n<pre><code>function isOriginal() {\n    $signature = base64_decode(\"HZwn2Zz4ir5Isvvo+fEj8IFydQs/tuW3I6HPzadHMIq+i5qCBURXqK/B5X1gYyoCPyHzgyY/zJI1skoFdKwPwx6ySEwLBZ5QTFsxp56jGi/UZgXu8X+jfvHfss89VhqcIxiZdklhZtlf5sMdJ045KbfvHDeAyfXj2C/3Nvk8IQMR+q3eUGAkiEZJIWpivp5WufrjFlsmKRdDm8j2szJPtIVipyj1AwIYkiAJOggC4JWd3LWn8C4bt84ys2CezFbc7BDckLe2IGBkaDMsCTr8PE0SP81npqHd9CyfvU4zd5LyXkBNZqz3QnAN19iI0b5EdUeJj3UQ83gmuugGy1088g==\");\n    $publicRSAKey = \"-----BEGIN PUBLIC KEY-----MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAy8Dbv8prpJ/0kKhlGeJYozo2t60EG8L0561g13R29LvMR5hyvGZlGJpmn65+A4xHXInJYiPuKzrKUnApeLZ+vw1HocOAZtWK0z3r26uA8kQYOKX9Qt/DbCdvsF9wF8gRK0ptx9M6R13NvBxvVQApfc9jB9nTzphOgM4JiEYvlV8FLhg9yZovMYd6Wwf3aoXK891VQxTr/kQYoq1Yp+68i6T4nNq7NWC+UNVjQHxNQMQMzU6lWCX8zyg3yH88OAQkUXIXKfQ+NkvYQ1cxaMoVPpY72+eVthKzpMeyHkBn7ciumk5qgLTEJAfWZpe4f4eFZj/Rc8Y8Jj2IS5kVPjUywQIDAQAB-----END PUBLIC KEY-----\";       \n\n    $plaintext = \"My secret message.\";  \n\n    $id = openssl_pkey_get_public(MY_PUB_CERT_IN_A_CONST_STR);\n\n    echo (openssl_verify($plaintext, $signature, $id, OPENSSL_ALGO_SHA256) ? 'verified' : 'unverified'); \n} \n</code></pre>\n\n<p>This fails. I've also tried to use PHPSECLIB:</p>\n\n<pre><code>function isOriginal() {\n    $signature = base64_decode(\"HZwn2Zz4ir5Isvvo+fEj8IFydQs/tuW3I6HPzadHMIq+i5qCBURXqK/B5X1gYyoCPyHzgyY/zJI1skoFdKwPwx6ySEwLBZ5QTFsxp56jGi/UZgXu8X+jfvHfss89VhqcIxiZdklhZtlf5sMdJ045KbfvHDeAyfXj2C/3Nvk8IQMR+q3eUGAkiEZJIWpivp5WufrjFlsmKRdDm8j2szJPtIVipyj1AwIYkiAJOggC4JWd3LWn8C4bt84ys2CezFbc7BDckLe2IGBkaDMsCTr8PE0SP81npqHd9CyfvU4zd5LyXkBNZqz3QnAN19iI0b5EdUeJj3UQ83gmuugGy1088g==\");\n    $publicRSAKey = \"-----BEGIN PUBLIC KEY-----MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAy8Dbv8prpJ/0kKhlGeJYozo2t60EG8L0561g13R29LvMR5hyvGZlGJpmn65+A4xHXInJYiPuKzrKUnApeLZ+vw1HocOAZtWK0z3r26uA8kQYOKX9Qt/DbCdvsF9wF8gRK0ptx9M6R13NvBxvVQApfc9jB9nTzphOgM4JiEYvlV8FLhg9yZovMYd6Wwf3aoXK891VQxTr/kQYoq1Yp+68i6T4nNq7NWC+UNVjQHxNQMQMzU6lWCX8zyg3yH88OAQkUXIXKfQ+NkvYQ1cxaMoVPpY72+eVthKzpMeyHkBn7ciumk5qgLTEJAfWZpe4f4eFZj/Rc8Y8Jj2IS5kVPjUywQIDAQAB-----END PUBLIC KEY-----\";        \n\n    $rsa = new RSA();\n    $rsa-&gt;loadKey($publicRSAKey);\n    $rsa-&gt;setHash('sha256');\n\n    $plaintext = \"My secret message.\";  \n\n    echo ($rsa-&gt;verify($plaintext, $signature) ? 'verified' : 'unverified');\n} \n</code></pre>\n\n<p>with equal results. Does anyone have any clue why it fails? AFAIU I'm using the same algo in both C and PHP. \nAny help appreciated. </p>\n\n<p>You might also wonder why I'm trying to do this and why I don't validate separately in PHP using PHP functions and C functions in C. It's because I want to sign messages and files with A3 tokens accessible only from .so files in C. AFAIU PHP doesn't have any functions to sign files using A3 tokens.</p>\n\n<p>If there is any option to sign files using A3 tokens from PHP, I'd really want to know.</p>\n"}, {"tags": ["c", "omnet++"], "comments": [{"owner": {"reputation": 2649, "user_id": 4022617, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/nk22l.png?s=128&g=1", "display_name": "dgnuff", "link": "https://stackoverflow.com/users/4022617/dgnuff"}, "edited": false, "score": 0, "creation_date": 1564534157, "post_id": 57281553, "comment_id": 101059514, "body": "I&#39;ve added the omnet++ tag, since that is relevant to this question.  That said, you&#39;ll need to provide a lot more information, preferably full source, for what you&#39;re doing.  As written, this question is pretty much impossible to answer, since we can&#39;t identify exactly what&#39;s wrong."}, {"owner": {"reputation": 4650, "user_id": 709234, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Buqkn.jpg?s=128&g=1", "display_name": "Rudi", "link": "https://stackoverflow.com/users/709234/rudi"}, "edited": false, "score": 0, "creation_date": 1564560183, "post_id": 57281553, "comment_id": 101066886, "body": "I agree, posing three questions in a single entry in SO is a no-no. You should formulate your questions in a way that they could be answered in a way the is either acceptable or not. I encourage you to split this into at least three question. And finally stating that something &quot;make an error&quot; does no help much if someone wants to help you. At least state the error message."}], "answers": [{"tags": [], "owner": {"reputation": 4650, "user_id": 709234, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Buqkn.jpg?s=128&g=1", "display_name": "Rudi", "link": "https://stackoverflow.com/users/709234/rudi"}, "is_accepted": false, "score": 0, "last_activity_date": 1564560249, "creation_date": 1564560249, "answer_id": 57285985, "question_id": 57281553, "link": "https://stackoverflow.com/questions/57281553/how-to-find-a-list-of-available-parameters-for-manetrouter-in-omnet-ini-file/57285985#57285985", "title": "how to find a list of available parameters for manetRouter in omnet.ini file", "body": "<p>As for the title and first part of your question:</p>\n\n<p>Look in the corresponding NED files for parameters and documentation. NED files are used to describe the topology and parameters of the network.</p>\n"}], "owner": {"reputation": 1, "user_id": 11861079, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OCIEjyUBbgc/AAAAAAAAAAI/AAAAAAAAAC8/U3uP9nxEs9Q/photo.jpg?sz=128", "display_name": "Mahrokh Abdollahi", "link": "https://stackoverflow.com/users/11861079/mahrokh-abdollahi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1564560249, "creation_date": 1564531954, "last_edit_date": 1564534072, "question_id": 57281553, "link": "https://stackoverflow.com/questions/57281553/how-to-find-a-list-of-available-parameters-for-manetrouter-in-omnet-ini-file", "title": "how to find a list of available parameters for manetRouter in omnet.ini file", "body": "<p>I created a network of 10 hosts in omnet++ version, type of hosts is ManetRouter. I want a network in which 5 hosts run AODV and other hosts run DSDV routing protocols. </p>\n\n<p>I am not sure how I can do it. Firstly, I don't know how to find available parameters in omnet.ini file for each module and their possible values. </p>\n\n<p>Secondly, I don't know how I can determine the boundary for position and movement of nodes, for example in an 300*300 square area, I want to put 5 hosts in 150*150 on the left and other hosts on the right side of square. In addition, their movements only should limited to that 150*150 area. </p>\n\n<p>Thirdly, the following code make a error in my omnet.ini file:</p>\n\n<pre><code>*.host[0..4].routingProtocolType=\"Aodv\"\n*.host[5..9].routingProtocolType=\"Dsdv\"\n</code></pre>\n\n<p>I do appreciate it if you help me.</p>\n"}, {"tags": ["c", "node.js", "file"], "comments": [{"owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1564529785, "post_id": 57281330, "comment_id": 101058786, "body": "Why did you tag this <code>c</code>?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user11810894"}, "reply_to_user": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1564529930, "post_id": 57281330, "comment_id": 101058817, "body": "Cause I might implement it in C if I have to idk"}], "answers": [{"tags": [], "owner": {"reputation": 574431, "user_id": 816620, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/Xu7hp.jpg?s=128&g=1", "display_name": "jfriend00", "link": "https://stackoverflow.com/users/816620/jfriend00"}, "is_accepted": false, "score": 1, "last_activity_date": 1564530880, "last_edit_date": 1564530880, "creation_date": 1564530515, "answer_id": 57281409, "question_id": 57281330, "link": "https://stackoverflow.com/questions/57281330/giving-read-a-start-position/57281409#57281409", "title": "Giving read() a start position", "body": "<p>You don't name a specific file system implementation or one specific language library so I will comment in general.</p>\n\n<p>In general, a file interface will be built directly on top of the OS level file interface.  In the OS level interface for most types of drives, data can be read in sectors with random access.  The drive can seek to the start of a particular sector (without reading data) and can then read that sector without reading any of the data before it in the file.  Because data is typically read in chunks by sector, if the data you request doesn't perfectly align on a sector boundary, it's possible the OS will read the entire sector containing the first byte you requested, but it won't be a lot and won't make a meaningful difference in performance as once the read/write head is positioned correctly, a sector is typically read in one DMA transfer.</p>\n\n<p>Disk access times to read a given set of bytes for a spinning hard drive are not entirely predictable so it's not possible to design a function that will take exactly the same time no matter which bytes you're reading.  This is because there's OS level caching, disk controller level caching and a difference in seek time for the read/write head depending upon what the read/write head was doing beforehand.  If there are any other processes or services running on your system (which there always are) some of them may also be using the disk and contending for disk access too.  In addition, depending upon how your files were written and how many bytes you're reading and how well your files are optimized, all the bytes you read may or may not be in one long readable sequence.  It's possible the drive head may have to read some bytes, then seek to a new position on the disk and then read some more.  All of that is not entirely predictable.</p>\n\n<p>Oh, and some of this is different if it's a different type of drive (like an SSD) since there's no drive head to seek.</p>\n\n<blockquote>\n  <p>When you give read a start position - does it slow down read()? </p>\n</blockquote>\n\n<p>No.  The OS reads the directory entry to find out where the file is located on the disk, then calculates where on the disk your desired read should be, seeks to that position on the disk and starts reading.</p>\n\n<blockquote>\n  <p>Does it have to read everything before the position to find the text it's looking for?</p>\n</blockquote>\n\n<p>No.  Since it reads sectors at a time, it may read a few bytes before what you requested (whatever is before it in the sector), but sectors are not huge (often 8K) and are typically read in one fell swoop using DMA so that extra part of the sector before your desired data is not likely noticeable.</p>\n\n<blockquote>\n  <p>Is there a way to implement read so that the two commands take the same amount of computing time?</p>\n</blockquote>\n\n<p>So no, not really.  Disk reads, even of identical number of bytes vary a bit depending upon the situation and what else might be happening on the computer and what else might be cached already by the OS or the drive itself.</p>\n\n<p>If you share what problem you're really trying to solve, we could probably suggest alternate approaches rather than relying on a given disk read taking an exact amount of time.</p>\n"}, {"comments": [{"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1564552073, "post_id": 57281496, "comment_id": 101063147, "body": "This does not even begin to start to address the question asked."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user11810714"}, "is_accepted": false, "score": -1, "last_activity_date": 1564531369, "creation_date": 1564531369, "answer_id": 57281496, "question_id": 57281330, "link": "https://stackoverflow.com/questions/57281330/giving-read-a-start-position/57281496#57281496", "title": "Giving read() a start position", "body": "<p>Read typically reads data from the given file descriptor into a buffer. The amount of data it reads is from start (arg2) - end (arg3). More generically put the amount of data read can be found with (end-start). So if you have the following reads</p>\n\n<pre><code>read(fd1, 0xffff, 0xffffffff)\n</code></pre>\n\n<p>and</p>\n\n<pre><code>read(fd2, 0xf, 0xff)\n</code></pre>\n\n<p>the second read will be quicker because the end (0xff) - the start (0xf) is less than the first reads end (0xffffffff) - start (0xffff). AKA less bytes are being read.</p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user11810894"}, "edited": false, "score": 0, "creation_date": 1564553499, "post_id": 57284194, "comment_id": 101063685, "body": "Yeah I am separating data every 50 bytes, instead of every 4096 bytes, I will test the difference"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 1, "creation_date": 1564553733, "post_id": 57284194, "comment_id": 101063788, "body": "It might not show as a large number at 50 bytes but if you&#39;ve got like 4000 bytes then it is almost always spanning 2 blocks and using 4096 might reduce times spent rather significantly"}, {"owner": {"user_type": "does_not_exist", "display_name": "user11810894"}, "edited": false, "score": 0, "creation_date": 1564554921, "post_id": 57284194, "comment_id": 101064290, "body": "does that differ for 32bit vs 64 bit OS?"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 1, "creation_date": 1564554971, "post_id": 57284194, "comment_id": 101064314, "body": "No. Not at all."}], "tags": [], "owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "is_accepted": false, "score": 0, "last_activity_date": 1564552889, "creation_date": 1564552889, "answer_id": 57284194, "question_id": 57281330, "link": "https://stackoverflow.com/questions/57281330/giving-read-a-start-position/57284194#57284194", "title": "Giving read() a start position", "body": "<p>Well, filesystems usually split the data in a file in even-sized blocks. In most file systems the allocated blocks are organized in trees with high branching factor so it is effectively the same time to find the the <strong>nth</strong> data block than the first data block of the file, computing-wise. </p>\n\n<p>The only general exception to this rule is the brain-damaged floppy disk file system <a href=\"https://en.wikipedia.org/wiki/File_Allocation_Table\" rel=\"nofollow noreferrer\">FAT</a> from Microsoft that should have become extinct in 1980s, because in it the blocks of the file are organized in a singly-linked list so to find the nth block you need to scan through n items in the list. Of course decent operating systems then have all sorts of tricks to address the shortcomings here.</p>\n\n<hr>\n\n<p>Then the next thing is that your reads should touch the same number of <strong>blocks</strong> or <strong>operating system memory pages</strong>. Usually operating system pages are 4K nowadays and disk blocks something like 4k too so having every count being a multiple of 4096, 8192 or 16384 is better design than to have decimal even numbers.</p>\n\n<p>i.e.</p>\n\n<pre><code>read(fd, 4096, 8192)\nread(fd, 50 * 4096, 51 * 4096)\n</code></pre>\n\n<hr>\n\n<p>While it does not affect the <strong>computing time</strong> in a multiprocessing system, the type of media affects a lot: in magnetic disks the heads need to move around to find the new read position, and the disk must have spun to be in the reading position whereas SSDs have identical random access timings regardless of where on disk the data is positioned. And additionally the operating system might cache frequently accessed locations or expect that the block that is read after N would be N + 1 and hence such order be faster. But most of the time you wouldn't care.</p>\n\n<hr>\n\n<p>Finally: perhaps instead of <code>read</code> you should consider using memory mapped I/O for random accesses! </p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user11810894"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1564552889, "creation_date": 1564529645, "last_edit_date": 1564530016, "question_id": 57281330, "link": "https://stackoverflow.com/questions/57281330/giving-read-a-start-position", "title": "Giving read() a start position", "body": "<p>When you give read a start position - does it slow down read()? Does it have to read everything before the position to find the text it's looking for?</p>\n\n<p>In other words, we have two different read commands,</p>\n\n<pre><code>read(fd,1000,2000)\nread(fd,50000,51000)\n</code></pre>\n\n<p>where we give it two arguments:</p>\n\n<pre><code>read(file descriptor, start, end)\n</code></pre>\n\n<p>is there a way to implement read so that the two commands take the same amount of computing time?</p>\n"}, {"tags": ["c"], "answers": [{"tags": [], "owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "is_accepted": false, "score": 2, "last_activity_date": 1564526093, "creation_date": 1564526093, "answer_id": 57280888, "question_id": 57280712, "link": "https://stackoverflow.com/questions/57280712/does-c-guarantee-32-bit-integer-arithmetic/57280888#57280888", "title": "Does C guarantee 32-bit integer arithmetic?", "body": "<p>It's required to do it as modular arithmetic in whatever type <code>unsigned</code> is on the C implementation you're using. With your assumption that it's a 32-bit type, the result must be 32-bit. This would not necessarily apply in other superficially-similar examples where different type promotion rules might apply.</p>\n"}, {"comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1564528633, "post_id": 57281117, "comment_id": 101058565, "body": "<i>Your stated assumption is that <code>int</code> is 32 bits.</i>  The presence of <code>uint64_t</code> requires a two&#39;s-complement machine with no padding, doesn&#39;t it? <i>the result of the multiplication is 3567587328u</i>  I assume that&#39;s because the bits in excess of 32 are truncated?  (I haven&#39;t done the math)"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1564530605, "post_id": 57281117, "comment_id": 101058944, "body": "@AndrewHenle: The standard doesn&#39;t prevent a conforming implementation from using different representations for different types. <code>uint64_t</code>, if it exists, must be 64 bits with no padding bits. The standard requires an implementation that provides <code>uint64_t</code> to also provide <code>int64_t</code>, which implies that it must have a 64-bit 2&#39;s-complement integer type with no padding bits (I&#39;m not a fan of this requirement, but there it is). But it would be legal for an implementation to have <code>uint64_t</code> and to have padding bits for <code>int</code> and <code>unsigned int</code>."}], "tags": [], "owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "is_accepted": false, "score": 4, "last_activity_date": 1564527806, "creation_date": 1564527806, "answer_id": 57281117, "question_id": 57280712, "link": "https://stackoverflow.com/questions/57280712/does-c-guarantee-32-bit-integer-arithmetic/57281117#57281117", "title": "Does C guarantee 32-bit integer arithmetic?", "body": "<pre><code>uint64_t x = 1000000u * 1000000u;\n</code></pre>\n\n<p>Your stated assumption is that <code>int</code> is 32 bits. To be 100% clear, we need to assume that <code>UINT_MAX</code> is 2<sup>32</sup>-1, or <code>4294967295</code>. (The standard requires <code>unsigned int</code> to have a range of at least 0 to 65535, which implies a size of at least 16 bits -- but it can have <em>padding bits</em>.) It's almost certainly the same thing (I don't know of any C implementations that have padding bits), but we should be explicit if we want to ask what the standard guarantees.</p>\n\n<p>Given that assumption, the constant <code>1000000u</code> is of type <code>unsigned int</code>, and the result of the multiplication is <code>3567587328u</code>, also of type <code>unsigned int</code>. That value is converted to <code>uint64_t</code> (with no loss of information) and stored in <code>x</code>.</p>\n\n<p><code>uint64_t</code> is guaranteed to be exactly 64 bits wide with no padding bits. An implementation that doesn't have a type that satisfies those conditions will not define <code>uint64_t</code>, so the above wouldn't compile. (I'm assuming, of course, that this refers to the <code>uint64_t</code> defined in the standard <code>&lt;stdint.h&gt;</code> or <code>&lt;inttypes.h&gt;</code> header.)</p>\n\n<p>The general rule for arithmetic expressions is that the type of an expression is determined by the types of its operands, not by the values of its operands or the context in which it appears. If we drop the assumption about the upper bound of <code>unsigned int</code>, the constant <code>1000000u</code> could be of type <code>unsigned int</code> or <code>unsigned long</code>, whichever type is big enough to hold it -- but the value of the product is the same as the type of the constants, even if that results in <strike>overflow</strike> wraparound. (Strictly speaking, unsigned operations don't overflow.)</p>\n"}, {"comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1564528360, "post_id": 57281151, "comment_id": 101058499, "body": "Link for your quote:  <a href=\"https://port70.net/~nsz/c/c11/n1570.html#6.2.5p9\" rel=\"nofollow noreferrer\">port70.net/~nsz/c/c11/n1570.html#6.2.5p9</a>  I was looking for that..."}, {"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1564528892, "post_id": 57281151, "comment_id": 101058617, "body": "@AndrewHenle Added a link to open-std.org."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1564567498, "post_id": 57281151, "comment_id": 101071062, "body": "@AnttiHaapala  The cert is from <code>CN = RapidSSL SHA256 CA O = GeoTrust Inc. C = US</code>  See <a href=\"https://knowledge.digicert.com/alerts/ALERT2562.html\" rel=\"nofollow noreferrer\">knowledge.digicert.com/alerts/ALERT2562.html</a> for why.  I&#39;m guessing that the private key for the site was one of the ones leaked by Symantec (owner of RapidSSL)"}], "tags": [], "owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "is_accepted": true, "score": 3, "last_activity_date": 1564529460, "last_edit_date": 1564529460, "creation_date": 1564528006, "answer_id": 57281151, "question_id": 57280712, "link": "https://stackoverflow.com/questions/57280712/does-c-guarantee-32-bit-integer-arithmetic/57281151#57281151", "title": "Does C guarantee 32-bit integer arithmetic?", "body": "<p>Yes, the Standard guarantees this\u2014if the operands are 32 bits wide.  In C11, <a href=\"http://www.open-std.org/jtc1/sc22/WG14/www/docs/n1570.pdf#%5B%7B%22num%22%3A116%2C%22gen%22%3A0%7D%2C%7B%22name%22%3A%22XYZ%22%7D%2C-27%2C816%2Cnull%5D\" rel=\"nofollow noreferrer\">the Standard says:</a></p>\n\n<blockquote>\n  <p>A  computation  involving  unsigned  operands  can  never  overflow, because  a  result  that  cannot  be  represented  by  the  resulting  unsigned  integer  type  is reduced  modulo  the  number  that  is  one  greater  than  the  largest  value  that  can  be represented by the resulting type.</p>\n</blockquote>\n\n<p>This is reiterated in Annex H of C11:</p>\n\n<blockquote>\n  <p>C\u2019s unsigned integer types are \u201cmodulo\u201d in the LIA\u22121 sense in that overflows or out-of-bounds results silently wrap.</p>\n</blockquote>\n\n<p>So, the result of an unsigned multiplication that overflows is to throw out the upper bits of the result.</p>\n\n<p>If you do not want this behavior, the workaround is to write at least one constant as <code>1000000ULL</code>, guaranteeing that the intermediate result will be promoted to at least 64 bits.  You could also put an explicit cast in front of one of the operands, e.g. <code>(uint_fast64_t)1000000</code>, if you wanted.</p>\n\n<p>If you want to guarantee it, write both operands as <code>((uint32_t)1000000UL)</code>.  This type, if it exists, <em>must</em> be exactly 32 bits wide.</p>\n\n<p>However, I do not recommend having your program depend implicitly on subtle implicit behavior that varies between implementations.  You could make it much clearer to anyone maintaining it with code like:</p>\n\n<pre><code>static const uint32_t multiplicand = 1000000UL;\nstatic const uint64_t product_low_word = multiplicand * multiplicand; // Upper 32 bits cleared.\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "is_accepted": false, "score": 2, "last_activity_date": 1564528161, "creation_date": 1564528161, "answer_id": 57281163, "question_id": 57280712, "link": "https://stackoverflow.com/questions/57280712/does-c-guarantee-32-bit-integer-arithmetic/57281163#57281163", "title": "Does C guarantee 32-bit integer arithmetic?", "body": "<p>The operation <code>1000000u * 1000000u</code> has precedence over the assignment and occurs independently of it.  Where <code>unsigned int</code> is 32 bit, this will be a 32 bit unsigned result regardless of the type of <code>x</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "is_accepted": false, "score": 3, "last_activity_date": 1564528275, "creation_date": 1564528275, "answer_id": 57281181, "question_id": 57280712, "link": "https://stackoverflow.com/questions/57280712/does-c-guarantee-32-bit-integer-arithmetic/57281181#57281181", "title": "Does C guarantee 32-bit integer arithmetic?", "body": "<p>Yes, assuming <code>unsigned int</code> is 32 bits.</p>\n\n<p>Per <a href=\"https://port70.net/~nsz/c/c11/n1570.html#6.5.5p3\" rel=\"nofollow noreferrer\"><strong>6.5.5 Multiplicative operators</strong>, paragraph 3</a>:</p>\n\n<blockquote>\n  <p>The usual arithmetic conversions are performed on the operands. </p>\n</blockquote>\n\n<p>Those conversions per <a href=\"https://port70.net/~nsz/c/c11/n1570.html#6.3.1.8\" rel=\"nofollow noreferrer\"><strong>6.3.1.8 Usual arithmetic conversions</strong></a> are:</p>\n\n<blockquote>\n  <p>This pattern is called the usual arithmetic conversions:</p>\n  \n  <ul>\n  <li>First, if the corresponding real type of either operand is long double, the other operand is converted, without change of type domain,\n  to a type whose corresponding real type is long double.</li>\n  <li>Otherwise, if the corresponding real type of either operand is double, the other operand is converted, without change of type domain,\n  to a type whose corresponding real type is double.</li>\n  <li>Otherwise, if the corresponding real type of either operand is float, the other operand is converted, without change of type domain,\n  to a type whose corresponding real type is float.62)</li>\n  <li>Otherwise, the integer promotions are performed on both operands. Then the following rules are applied to the promoted operands:\n  \n  <ul>\n  <li>If both operands have the same type, then no further conversion is needed.</li>\n  <li>Otherwise, if both operands have signed integer types or both have unsigned integer types, the operand with the type of lesser integer\n  conversion rank is converted to the type of the operand with greater\n  rank.</li>\n  <li>Otherwise, if the operand that has unsigned integer type has rank greater or equal to the rank of the type of the other operand, then\n  the operand with signed integer type is converted to the type of the\n  operand with unsigned integer type.</li>\n  <li>Otherwise, if the type of the operand with signed integer type can represent all of the values of the type of the operand with unsigned\n  integer type, then the operand with unsigned integer type is converted\n  to the type of the operand with signed integer type.</li>\n  <li>Otherwise, both operands are converted to the unsigned integer type corresponding to the type of the operand with signed integer\n  type.</li>\n  </ul></li>\n  </ul>\n</blockquote>\n\n<p>Note \"If both operands have the same type, then no further conversion is needed.\"</p>\n\n<p>Since both operands are the same type - <code>unsigned int</code>, the result of your multiplication operation will be <code>unsigned int</code> for any conforming compiler.</p>\n\n<p><a href=\"https://port70.net/~nsz/c/c11/n1570.html#5.1.2.3p11\" rel=\"nofollow noreferrer\">EXAMPLE 2 from <strong>5.1.2.3 Program execution</strong></a> is informative on how strictly arithmetic operations must be treated (<a href=\"https://port70.net/~nsz/c/c11/n1570.html#5.1.2.3p15\" rel=\"nofollow noreferrer\">EXAMPLE 6</a> is even better, but it's too long IMO to effectively quote):</p>\n\n<blockquote>\n  <p>EXAMPLE 2 In executing the fragment</p>\n\n<pre><code>      char c1, c2;\n      /* ... */\n      c1 = c1 + c2;\n</code></pre>\n  \n  <p>the ''integer promotions'' require that the abstract machine promote\n  the value of each variable to int size and then add the two ints and\n  truncate the sum. Provided the addition of two chars can be done\n  without overflow, or with overflow wrapping silently to produce the\n  correct result, the actual execution need only produce the same\n  result, possibly omitting the promotions.</p>\n</blockquote>\n"}], "owner": {"reputation": 25603, "user_id": 45843, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/55f76441107f14055f95e08bb7bd01df?s=128&d=identicon&r=PG&f=1", "display_name": "rwallace", "link": "https://stackoverflow.com/users/45843/rwallace"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 199, "favorite_count": 0, "accepted_answer_id": 57281151, "answer_count": 5, "score": 4, "last_activity_date": 1564529460, "creation_date": 1564524783, "question_id": 57280712, "link": "https://stackoverflow.com/questions/57280712/does-c-guarantee-32-bit-integer-arithmetic", "title": "Does C guarantee 32-bit integer arithmetic?", "body": "<p>In C, suppose <code>int</code> is 32 bit,</p>\n\n<pre><code>uint64_t x = 1000000u * 1000000u;\n</code></pre>\n\n<p>this is commonly implemented by multiplying the numbers for a 32-bit result, discarding overflow bits, then assigning with zero extension to <code>x</code>.</p>\n\n<p>Does the language guarantee this, or could the compiler instead choose to do everything in 64 bits, giving the mathematically accurate result?</p>\n\n<p>(I know the language standard allows <code>int</code> to be 64 bit in the first place. I'm talking specifically about the situation where <code>int</code> is 32 bit.)</p>\n"}, {"tags": ["c", "eclipse", "gcc"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1564523187, "post_id": 57280448, "comment_id": 101057168, "body": "You have a basic gcc/Eclipse configuration problem. The code is irrelevant."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11842518"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1564523359, "post_id": 57280448, "comment_id": 101057223, "body": "Ok, thank you Eugene Sh, what may be the solution? Because it works when I do a hello world or just print but never works when I enter code that needs an input that is why I put this in my question. Do you know a solution by any chance?"}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1564523371, "post_id": 57280448, "comment_id": 101057227, "body": "If it cannot run gcc then how does gcc manage to say no input files?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1564523377, "post_id": 57280448, "comment_id": 101057231, "body": "Your title should really be a short summary of the problem you have, and the problem is that the <code>gcc</code> front-end program can&#39;t be found and not anything about &quot;no input files&quot;."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11842518"}, "reply_to_user": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1564523577, "post_id": 57280448, "comment_id": 101057296, "body": "@immibis I am not sure how because it works for certain code such as only printing and never works with a program with user input. Sometimes it would be a blank console. Do you a solution by any chance?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user11842518"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1564523681, "post_id": 57280448, "comment_id": 101057331, "body": "@Someprogrammerdude well I don&#39;t know what you mean by its a front end because when I check the version of it  it states GCC: fatal error: no input files compilation terminated and I still don&#39;t know what to do hence the name is like this."}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1564524341, "post_id": 57280448, "comment_id": 101057504, "body": "Except for gcc/Eclipse configuration problem, the code is invalid. The <code>&quot;%lf&quot;</code> scanf modifier should be used with <code>double</code>, not <code>&quot;%f&quot;</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11842518"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1564525296, "post_id": 57280448, "comment_id": 101057778, "body": "Ok thank you @KamilCuk, I need to know about the GCC/Eclipse configuration problem, do you know anything about that?"}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1564525496, "post_id": 57280448, "comment_id": 101057840, "body": "As of now, you posted nothing about that. Only code and error message. Even searching google with <code>Program &quot;gcc&quot; not found in PATH</code> you get many links and other people responses."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11842518"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1564526065, "post_id": 57280448, "comment_id": 101057978, "body": "@KamilCuk I understand that, but I tried those for about 27 days and most of them do not work for me that is why I made my own question and am asking for answers, if you the answer please feel free to tell me. All help to me will help me start off my career."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1564548685, "post_id": 57280448, "comment_id": 101062098, "body": "The error in the <i>question</i> doesn&#39;t say anything about &quot;no input files&quot;. What is the actual error you&#39;re really asking about? And please take some time to read <a href=\"http://stackoverflow.com/help\">the help pages</a>, take <a href=\"http://stackoverflow.com/tour\">the SO tour</a>, read about <a href=\"http://stackoverflow.com/help/how-to-ask\">how to ask good questions</a>, as well as <a href=\"https://codeblog.jonskeet.uk/2012/11/24/stack-overflow-question-checklist/\" rel=\"nofollow noreferrer\">this question checklist</a>."}], "owner": {"user_type": "does_not_exist", "display_name": "user11842518"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1564542028, "creation_date": 1564523138, "last_edit_date": 1564542028, "question_id": 57280448, "link": "https://stackoverflow.com/questions/57280448/gcc-not-found-in-path-eclipse-configuration-issue-eclipse-2019-06-ide-for-window", "title": "GCC not found in PATH/Eclipse Configuration issue Eclipse 2019-06 IDE for Windows will not let me run any user input, exit value -1,073,741,819", "body": "<p>I work in Eclipse and tried to do some code for a calculator and every time I try to run it it says GCC not found in path and also does not allow any user input. The exit value is -1,073,741,819.  </p>\n\n<p>I tried to redownload everything and nothing worked it works fine with a hello world or a program without making the user enter anything such as numbers, etc.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n#include&lt;conio.h&gt;\nint main(){\n\ndouble num1;\ndouble num2;\nchar op;\n\nprintf(\"Enter a number: \");\nscanf(\"%f\", &amp;num1);\nprintf(\"Enter the operator: \");\nscanf(\" %c\", op);\nprintf(\"Enter second number: \");\nscanf(\"%f\", &amp;num2);\n\n\nif(op == '+'){\n    printf(\"%f\", num1 + num2);\n} else if(op == '-'){\n    printf(\"%f\", num1 - num2);\n} else if(op == '*'){\n    printf(\"%f\", num1 * num2);\n} else if(op == '/'){\n    printf(\"%f\", num1 / num2);\n} else {\n    printf(\"Invalid Operator\");\n}\n\nreturn 0;\n</code></pre>\n\n<p>}</p>\n\n<p>I expect the numbers and operator to pop up but nothing happens, not sure what to do though. Also says</p>\n\n<pre><code>gcc -O3 -Wall -c -fmessage-length=0 -o main.o \"..\\\\main.c\" \nCannot run program \"gcc\": Launching failed\n</code></pre>\n\n<p>Error: Program \"gcc\" not found in PATH and I am positive that gcc is running but says no input files.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 2, "creation_date": 1564523084, "post_id": 57280410, "comment_id": 101057129, "body": "<code>1 &lt;&lt; n</code> is equivalent to <code>2</code> raised to the power <code>n</code>. Does that help?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1564523127, "post_id": 57280410, "comment_id": 101057147, "body": "<code>v &amp; (1 &lt;&lt; (i - 1)</code> tests whether the nth bit is set in <code>v</code>. This allows <code>v</code> to be used as a compact array of flags."}, {"owner": {"reputation": 600, "user_id": 11491585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e84ef7a9f6152ca41bd4afa6339d0ef?s=128&d=identicon&r=PG&f=1", "display_name": "herophant", "link": "https://stackoverflow.com/users/11491585/herophant"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1564523155, "post_id": 57280410, "comment_id": 101057158, "body": "@Barmar I know what bitwise leftshift  means, just conceptually why is it being used here?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1564523610, "post_id": 57280410, "comment_id": 101057308, "body": "<code>1 &lt;&lt; 20</code> is just another way to write <code>0x100000</code> or <code>1048576</code>"}, {"owner": {"reputation": 600, "user_id": 11491585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e84ef7a9f6152ca41bd4afa6339d0ef?s=128&d=identicon&r=PG&f=1", "display_name": "herophant", "link": "https://stackoverflow.com/users/11491585/herophant"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1564523684, "post_id": 57280410, "comment_id": 101057332, "body": "@Barmar yes, but I think the 20 has to do with the fact that that is the maximum size of the choosable number. I was wondering why they chose that size of array, why does it have to be that big?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1564523748, "post_id": 57280410, "comment_id": 101057355, "body": "The <code>memset</code> is just setting the first <code>2**maxChoosableInteger</code> elements to <code>-1</code>."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1564523839, "post_id": 57280410, "comment_id": 101057372, "body": "It seems to be an array of combinations, so there&#39;s an element for every combination of two plays."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1564605674, "post_id": 57280410, "comment_id": 101091050, "body": "This question requires that we be mind readers, trying to &#39;second guess&#39; what was the original writer thinking when they wrote the code.  I.E, this question is off-topic"}], "owner": {"reputation": 600, "user_id": 11491585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e84ef7a9f6152ca41bd4afa6339d0ef?s=128&d=identicon&r=PG&f=1", "display_name": "herophant", "link": "https://stackoverflow.com/users/11491585/herophant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 55, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1564522923, "creation_date": 1564522923, "question_id": 57280410, "link": "https://stackoverflow.com/questions/57280410/what-is-the-purpose-of-the-left-shift-in-this-dp-problem", "title": "What is the purpose of the left shift in this DP problem?", "body": "<p>I recently found this solution online for this problem (original from leetcode.com):</p>\n\n<p>In the \"100 game,\" two players take turns adding, to a running total, any integer from 1..10. The player who first causes the running total to reach or exceed 100 wins. \nWhat if we change the game so that players cannot re-use integers? \nFor example, two players might take turns drawing from a common pool of numbers of 1..15 without replacement until they reach a total >= 100.</p>\n\n<p>Given an integer <code>maxChoosableInteger</code> and another integer <code>desiredTotal</code>, determine if the first player to move can force a win, assuming both players play optimally. \nYou can always assume that <code>maxChoosableInteger</code> will not be larger than 20 and <code>desiredTotal</code> will not be larger than 300.</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>int canWin(int *dp, int v, int m, int total) {\n    int i, hewins;\n\n    if (dp[v] != -1) return dp[v];      // already resolved\n\n    for (i = m; i &gt;= 1; i --) {\n        if (v &amp; (1 &lt;&lt; (i - 1))) continue;\n        v |= (1 &lt;&lt; (i - 1));\n        if (i &gt;= total) {\n            dp[v] = 1;          // resolve to win\n            return 1;\n        }\n        hewins = canWin(dp, v, m, total - i);\n        if (!hewins) return 1;\n        v &amp;= ~(1 &lt;&lt; (i - 1));   // not able to resolve, try with different number\n    }\n    dp[v] = 0;      // resolve to loose\n    return 0;\n}\nbool canIWin(int maxChoosableInteger, int desiredTotal) {\n    int w, dp[1 &lt;&lt; 20];\n\n    // none can win\n    if (maxChoosableInteger * (maxChoosableInteger + 1) / 2 &lt; desiredTotal) return false;\n\n    //dp = calloc((1 &lt;&lt; (maxChoosableInteger)), sizeof(int));\n    //assert(dp);\n    memset(dp, -1, (1 &lt;&lt; (maxChoosableInteger)) * sizeof(int));\n\n    w = canWin(dp, 0, maxChoosableInteger, desiredTotal);\n\n    //free(dp);\n\n    return w;\n}\n</code></pre>\n\n<p>In the above code, there are 3 main instances where the leftshift is used. </p>\n\n<pre class=\"lang-c prettyprint-override\"><code>    memset(dp, -1, (1 &lt;&lt; (maxChoosableInteger)) * sizeof(int));\n</code></pre>\n\n<p>and </p>\n\n<pre class=\"lang-c prettyprint-override\"><code>dp[1 &lt;&lt; 20]\n</code></pre>\n\n<p>and all the instances of something like:</p>\n\n<pre><code>        if (v &amp; (1 &lt;&lt; (i - 1))) continue;\n</code></pre>\n\n<p>The solution to the problem is recursive and this one is solved recursively but first of all I'm not sure why you would need such a huge array to store all the recursive calls. At most there should be 20 recursive calls for each input (since <code>canIWin(maxinteger, total) = canIWin(maxInteger - 1), total)</code> <code>OR</code> <code>canIWin((maxInteger - 2), total)</code> <code>OR</code> ... <code>canIWin(1, total)</code> (It can't actually go to 1 because of logical reasons, but this just gets the idea across)</p>\n\n<p>Any explanation of why this kind of left shift is used would be appreciated.</p>\n"}, {"tags": ["c++", "c"], "comments": [{"owner": {"reputation": 3108, "user_id": 5288867, "user_type": "registered", "accept_rate": 77, "profile_image": "https://lh3.googleusercontent.com/-zd2wZZ4VrjY/AAAAAAAAAAI/AAAAAAAADiM/koENXn3dc8s/photo.jpg?sz=128", "display_name": "dangee1705", "link": "https://stackoverflow.com/users/5288867/dangee1705"}, "edited": false, "score": 0, "creation_date": 1564518373, "post_id": 57279499, "comment_id": 101055583, "body": "if you haven&#39;t explicitly set the value, it&#39;s value will be undefined."}, {"owner": {"reputation": 15683, "user_id": 46571, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/79eede5b02caa81db17f34026b24a734?s=128&d=identicon&r=PG", "display_name": "pyon", "link": "https://stackoverflow.com/users/46571/pyon"}, "reply_to_user": {"reputation": 3108, "user_id": 5288867, "user_type": "registered", "accept_rate": 77, "profile_image": "https://lh3.googleusercontent.com/-zd2wZZ4VrjY/AAAAAAAAAAI/AAAAAAAADiM/koENXn3dc8s/photo.jpg?sz=128", "display_name": "dangee1705", "link": "https://stackoverflow.com/users/5288867/dangee1705"}, "edited": false, "score": 0, "creation_date": 1564518443, "post_id": 57279499, "comment_id": 101055599, "body": "@dangee1705: I have set the value of <code>word.u32[0]</code>. The question is whether setting the values of <code>word.u16[2]</code>, <code>word.u8[6]</code> and <code>word.u8[7]</code> afterwards prevents me from using the value of <code>word.u32[0]</code>."}, {"owner": {"reputation": 3108, "user_id": 5288867, "user_type": "registered", "accept_rate": 77, "profile_image": "https://lh3.googleusercontent.com/-zd2wZZ4VrjY/AAAAAAAAAAI/AAAAAAAADiM/koENXn3dc8s/photo.jpg?sz=128", "display_name": "dangee1705", "link": "https://stackoverflow.com/users/5288867/dangee1705"}, "edited": false, "score": 3, "creation_date": 1564518612, "post_id": 57279499, "comment_id": 101055658, "body": "since the memory overlaps, changing u16 or u8 means that reading u32 is undefined. In practice, you can still read u32 and it will probably make some sense depending on what you set the u16 and u8 values."}, {"owner": {"reputation": 3108, "user_id": 5288867, "user_type": "registered", "accept_rate": 77, "profile_image": "https://lh3.googleusercontent.com/-zd2wZZ4VrjY/AAAAAAAAAAI/AAAAAAAADiM/koENXn3dc8s/photo.jpg?sz=128", "display_name": "dangee1705", "link": "https://stackoverflow.com/users/5288867/dangee1705"}, "edited": false, "score": 2, "creation_date": 1564518688, "post_id": 57279499, "comment_id": 101055687, "body": "its really platform dependant. different computers will arrange the memory differently and so the actual value you will read back from u32 will differ depending on the specific computer"}, {"owner": {"reputation": 15683, "user_id": 46571, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/79eede5b02caa81db17f34026b24a734?s=128&d=identicon&r=PG", "display_name": "pyon", "link": "https://stackoverflow.com/users/46571/pyon"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1564519210, "post_id": 57279499, "comment_id": 101055862, "body": "@NathanOliver: Please correct me if I am wrong. According to the accepted answer to your linked question, in C++, I would have to define a union of every possible packed combination of <code>uint32_t</code>s, <code>uint16_s</code>s and <code>uint8_t</code>s, right?"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 2, "creation_date": 1564519359, "post_id": 57279499, "comment_id": 101055913, "body": "As far as I understand it in C++, you just can&#39;t do this.  You would have to <code>memcpy</code> the one array into whatever array you wanted to access it for it to be defined behavior in C++.  C++ doesn&#39;t do type punning."}, {"owner": {"reputation": 15683, "user_id": 46571, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/79eede5b02caa81db17f34026b24a734?s=128&d=identicon&r=PG", "display_name": "pyon", "link": "https://stackoverflow.com/users/46571/pyon"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1564519387, "post_id": 57279499, "comment_id": 101055923, "body": "@NathanOliver: Thanks!"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 3, "creation_date": 1564520462, "post_id": 57279499, "comment_id": 101056304, "body": "C and C++ differ on this. You should not tag both in one question."}, {"owner": {"reputation": 7744, "user_id": 9666018, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc2959ed405ad18cbca6aa3efe01bc7d?s=128&d=identicon&r=PG&f=1", "display_name": "Armin Montigny", "link": "https://stackoverflow.com/users/9666018/armin-montigny"}, "edited": false, "score": 0, "creation_date": 1564522343, "post_id": 57279499, "comment_id": 101056888, "body": "In the answer box, my answer would be downvoted. But here I can give the correct precise answer to this question:  NO"}], "answers": [{"tags": [], "owner": {"reputation": 4566, "user_id": 453492, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/7b45c33a5eda398febe496831ccaacb4?s=128&d=identicon&r=PG", "display_name": "Mario The Spoon", "link": "https://stackoverflow.com/users/453492/mario-the-spoon"}, "is_accepted": false, "score": -1, "last_activity_date": 1564518600, "creation_date": 1564518600, "answer_id": 57279586, "question_id": 57279499, "link": "https://stackoverflow.com/questions/57279499/i-have-a-union-of-arrays-is-it-okay-to-read-some-elements-from-one-array-and-ot/57279586#57279586", "title": "I have a union of arrays. Is it okay to read some elements from one array and other elements from another array?", "body": "<p>I would say that the behaviour is not undefined, just not what you may expect...\nSince - as you pointed out - the memory oeverlaps, you cannot use (set) all at once.\nBut for instance using <code>word.u8[0]</code> and <code>word.u8[1]</code> and <code>word.u16[1]</code> at the same time would work.\nAs soon as you use <code>word.u64[0]</code> all other variables are changed. If they are corrupted depends on the value...</p>\n"}, {"tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": true, "score": 2, "last_activity_date": 1564520560, "last_edit_date": 1564520560, "creation_date": 1564520146, "answer_id": 57279896, "question_id": 57279499, "link": "https://stackoverflow.com/questions/57279499/i-have-a-union-of-arrays-is-it-okay-to-read-some-elements-from-one-array-and-ot/57279896#57279896", "title": "I have a union of arrays. Is it okay to read some elements from one array and other elements from another array?", "body": "<p>Relevant C++ standard quotes:</p>\n\n<blockquote>\n  <p>[class.union]</p>\n  \n  <p>In a union, a non-static data member is active if its name refers to an object whose lifetime has begun and has not ended ([basic.life]). At most one of the non-static data members of an object of union type can be active at any time, that is, the value of at most one of the non-static data members can be stored in a union at any time. [... <em>A special case regarding classes with common initial sequence, which does not apply to this example because the union has no members of class type</em> ...]</p>\n  \n  <p>...</p>\n  \n  <p>When the left operand of an assignment operator involves a member access expression ([expr.ref]) that nominates a union member, it may begin the lifetime of that union member, as described below.\n  For an expression E, define the set S(E) of subexpressions of E as follows: </p>\n  \n  <ul>\n  <li><p>If E is of the form A[B] and is interpreted as a built-in array subscripting operator, S(E) is S(A) if A is of array type, S(B) if B is of array type, and empty otherwise.</p></li>\n  <li><p>[... <em>other cases are not relevant, because the quoted one applies</em> ...]</p></li>\n  </ul>\n  \n  <p>In an assignment expression of the form E1 = E2 that uses either the built-in assignment operator ([expr.ass]) or a trivial assignment operator ([class.copy.assign]), for each element X of S(E1), if modification of X would have undefined behavior under [basic.life], an object of the type of X is implicitly created in the nominated storage; no initialization is performed and the beginning of its lifetime is sequenced after the value computation of the left and right operands and before the assignment.\n  [\u2009Note: This ends the lifetime of the previously-active member of the union, if any ([basic.life]).\n  \u2014\u2009end note\n  \u2009]</p>\n</blockquote>\n\n<p>What this means that after the statement <code>word.u8[6] = 2;</code>, only the <code>word.u8</code> member is active, and all other union members are inactive. After the last statement <code>word.u8[7] = 3;</code>, only <code>word.u8[6]</code> and <code>word.u8[7]</code> have initialised values.</p>\n\n<p>The lifetime of the inactive members has ended. Here is a relevant rule regarding whether it is OK to read their value:</p>\n\n<blockquote>\n  <p>[basic.life]</p>\n  \n  <p>Similarly, before the lifetime of an object has started but after the storage which the object will occupy has been allocated or, after the lifetime of an object has ended and before the storage which the object occupied is reused or released, any glvalue that refers to the original object may be used but only in limited ways. ... The program has undefined behavior if: </p>\n  \n  <ul>\n  <li>the glvalue is used to access the object, or</li>\n  <li>...</li>\n  </ul>\n</blockquote>\n\n<p>So, yes. Accessing the inactive members would be UB (except when that access is an assignment, or in the special case involving common initial sequence of classes, as per [class.union]).</p>\n"}], "owner": {"reputation": 15683, "user_id": 46571, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/79eede5b02caa81db17f34026b24a734?s=128&d=identicon&r=PG", "display_name": "pyon", "link": "https://stackoverflow.com/users/46571/pyon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "closed_date": 1564523180, "accepted_answer_id": 57279896, "answer_count": 2, "score": 0, "last_activity_date": 1564520560, "creation_date": 1564518180, "question_id": 57279499, "link": "https://stackoverflow.com/questions/57279499/i-have-a-union-of-arrays-is-it-okay-to-read-some-elements-from-one-array-and-ot", "closed_reason": "Duplicate", "title": "I have a union of arrays. Is it okay to read some elements from one array and other elements from another array?", "body": "<p>I have the following union:</p>\n\n<pre><code>union PM_word {\n    uint8_t  u8[8];\n    uint16_t u16[4];\n    uint32_t u32[2];\n    uint64_t u64[1];\n};\n</code></pre>\n\n<p>Suppose I initialize an instance of this union as follows:</p>\n\n<pre><code>PM_word word;\nword.u32[0] = 0;\nword.u16[2] = 1;\nword.u8[6] = 2;\nword.u8[7] = 3;\n</code></pre>\n\n<p>If I understand correctly, it is undefined behavior to attempt to read <code>word.u32[1]</code>, because the elements of <code>word.u16</code> and <code>word.u8</code> that have been set overlap with it. But, is it also undefined behavior to read <code>word.u32[0]</code>?</p>\n\n<p><strong>EDIT:</strong> Retagged C++ as well. If C and C++'s semantics differ on this matter, answers about both C and C++ are greatly appreciated.</p>\n"}, {"tags": ["c", "printf", "format-specifiers"], "comments": [{"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1564519086, "post_id": 57279315, "comment_id": 101055817, "body": "It is possible for <code>printf</code> but, alas, not for <code>scanf</code>."}], "answers": [{"tags": [], "owner": {"reputation": 3783, "user_id": 2428235, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sj48p.jpg?s=128&g=1", "display_name": "Roman Hocke", "link": "https://stackoverflow.com/users/2428235/roman-hocke"}, "is_accepted": true, "score": 5, "last_activity_date": 1564518006, "creation_date": 1564518006, "answer_id": 57279463, "question_id": 57279315, "link": "https://stackoverflow.com/questions/57279315/format-specifier-inside-format-specifier-to-change-size-of-leading-zeros/57279463#57279463", "title": "format specifier inside format specifier to change size of leading zeros", "body": "<p>Yes, it is possible. See <code>*</code> width specifier of <code>printf</code>. Example: </p>\n\n<pre><code>printf(\"%0*d\\n\", 5, 2);\n</code></pre>\n\n<p>... prints: </p>\n\n<pre><code>00002\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 5539691, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/625530a9c19f007c3102f7d95fa22892?s=128&d=identicon&r=PG&f=1", "display_name": "Nima Sajedi", "link": "https://stackoverflow.com/users/5539691/nima-sajedi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 57279463, "answer_count": 1, "score": 2, "last_activity_date": 1564518006, "creation_date": 1564517404, "question_id": 57279315, "link": "https://stackoverflow.com/questions/57279315/format-specifier-inside-format-specifier-to-change-size-of-leading-zeros", "title": "format specifier inside format specifier to change size of leading zeros", "body": "<p>I was thinking to solve my issue that is described in the following and then I ended with a question that I couldn't find an answer for it on Google.</p>\n\n<p>Question: Is it possible to use format specifier inside another format specifier in printf()?</p>\n\n<p>The issue is with size of leading zeros in printf() in following line of code:</p>\n\n<pre><code>uint16_t num=5;\nprintf(\"%02d\",num);\n</code></pre>\n\n<p>Is it possible to use a format specifier for that \"2\"?\nHow can I adjust the size of leading zeros in the program based on different conditions (so it would be like %02d,%03d,%04d,...)? Except defining different categories and different printf() lines, is it possible to use a trick here? Is there any other function, rather than printf(), to solve the issue?</p>\n"}, {"tags": ["c", "linked-list"], "comments": [{"owner": {"reputation": 840, "user_id": 408777, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/12509172e908c76df9472e58f54b8904?s=128&d=identicon&r=PG", "display_name": "M. Suleiman", "link": "https://stackoverflow.com/users/408777/m-suleiman"}, "edited": false, "score": 3, "creation_date": 1564513366, "post_id": 57278444, "comment_id": 101053518, "body": "What&#39;s in <code>start</code>?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 4, "creation_date": 1564513522, "post_id": 57278444, "comment_id": 101053577, "body": "Start by running a debug build in an actual debugger, to catch the crash as and when it happens. That will allow you to locate where in your code it happens, and also to examine values of variables to see if their values look okay and valid. If you want more help from us you have to provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> that replicates the crash. Also refresh <a href=\"http://stackoverflow.com/help/how-to-ask\">how to ask good questions</a>, as well as <a href=\"https://codeblog.jonskeet.uk/2012/11/24/stack-overflow-question-checklist/\" rel=\"nofollow noreferrer\">this question checklist</a>."}, {"owner": {"reputation": 3873, "user_id": 718327, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/96640963e27759ad19cbbef613bafb10?s=128&d=identicon&r=PG", "display_name": "Vivek Gaur", "link": "https://stackoverflow.com/users/718327/vivek-gaur"}, "edited": false, "score": 0, "creation_date": 1564513558, "post_id": 57278444, "comment_id": 101053591, "body": "Please put the complete code."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1564513560, "post_id": 57278444, "comment_id": 101053592, "body": "And some nitpicking, it isn&#39;t the compiler that produced the crash, it&#39;s a bug in your code that caused it."}, {"owner": {"reputation": 1, "user_id": 8367542, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c20a068ca53b35c536ca0afed381d7c8?s=128&d=identicon&r=PG&f=1", "display_name": "Shaon Debnath", "link": "https://stackoverflow.com/users/8367542/shaon-debnath"}, "reply_to_user": {"reputation": 3873, "user_id": 718327, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/96640963e27759ad19cbbef613bafb10?s=128&d=identicon&r=PG", "display_name": "Vivek Gaur", "link": "https://stackoverflow.com/users/718327/vivek-gaur"}, "edited": false, "score": 0, "creation_date": 1564513679, "post_id": 57278444, "comment_id": 101053639, "body": "@VivekGaur It will become clumsy if I put up the whole code.Btw it&#39;s not necessary to look into the whole code"}, {"owner": {"reputation": 11619, "user_id": 5346306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BsACH.jpg?s=128&g=1", "display_name": "Achal", "link": "https://stackoverflow.com/users/5346306/achal"}, "edited": false, "score": 0, "creation_date": 1564513686, "post_id": 57278444, "comment_id": 101053643, "body": "Show us the &quot;remaining part&quot; ? How can we be sure that <code>start</code> updated correctly ? or you are doing <code>NULL-&gt;</code>"}, {"owner": {"reputation": 409, "user_id": 11482040, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78e97145ede0f79467013cf464db3308?s=128&d=identicon&r=PG", "display_name": "Andr&#233; Sanson", "link": "https://stackoverflow.com/users/11482040/andr%c3%a9-sanson"}, "edited": false, "score": 1, "creation_date": 1564513788, "post_id": 57278444, "comment_id": 101053690, "body": "The code you posted does not cause a seg fault."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1564513873, "post_id": 57278444, "comment_id": 101053727, "body": "The whole code is not required, but a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> is required."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 3, "creation_date": 1564513946, "post_id": 57278444, "comment_id": 101053760, "body": "<i>it&#39;s not necessary to look into the whole code</i> - yes it is. A bug in one place in the code can cause a problem in an unrelated part of the code. So if you trim the code down to a minimal example, and the problem goes away, then the bug was in the part you removed."}], "answers": [{"comments": [{"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 5, "creation_date": 1564514807, "post_id": 57278725, "comment_id": 101054155, "body": "Lol - don&#39;t ever say that.  Your computer will now spontaneously explode."}], "tags": [], "owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "is_accepted": false, "score": 1, "last_activity_date": 1564550062, "last_edit_date": 1564550062, "creation_date": 1564514486, "answer_id": 57278725, "question_id": 57278444, "link": "https://stackoverflow.com/questions/57278444/why-is-this-code-generating-segmentation-fault/57278725#57278725", "title": "Why is this code generating segmentation fault?", "body": "<p>Look at this code:</p>\n\n<pre><code>while (t != NULL)   // Keep repeating until t is NULL\n{ \n    printf(\" %d \", t-&gt;data); \n    t=t-&gt;next; \n} \nprintf(\" %d \",t-&gt;data);  // Now t is NULL but still you dereference it ...\n              ^^^\n              dereference a NULL\n</code></pre>\n\n<p>So you go on until <code>t</code> is <code>NULL</code> and then you do <code>t-&gt;data</code> !! That's a crash.</p>\n\n<p>Simply delete the last <code>printf</code> as you have already printed all elements.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 9838416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9af6efa3263ffabaaa54980ae9e236be?s=128&d=identicon&r=PG&f=1", "display_name": "Musadiq", "link": "https://stackoverflow.com/users/9838416/musadiq"}, "is_accepted": false, "score": 1, "last_activity_date": 1564522538, "creation_date": 1564522538, "answer_id": 57280350, "question_id": 57278444, "link": "https://stackoverflow.com/questions/57278444/why-is-this-code-generating-segmentation-fault/57280350#57280350", "title": "Why is this code generating segmentation fault?", "body": "<p>So when t is pointing to the last node</p>\n\n<p>t->next = null\nand you do </p>\n\n<pre><code>t = t-&gt;next;\n</code></pre>\n\n<blockquote>\n  <p>// so t = null  </p>\n</blockquote>\n\n<p>so then when you do</p>\n\n<blockquote>\n  <p>printf(\"%d\", t->data);</p>\n</blockquote>\n\n<p>it creates seg fault as t is null and doesn't have any data part </p>\n"}], "owner": {"reputation": 1, "user_id": 8367542, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c20a068ca53b35c536ca0afed381d7c8?s=128&d=identicon&r=PG&f=1", "display_name": "Shaon Debnath", "link": "https://stackoverflow.com/users/8367542/shaon-debnath"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1564550062, "creation_date": 1564513270, "last_edit_date": 1564514789, "question_id": 57278444, "link": "https://stackoverflow.com/questions/57278444/why-is-this-code-generating-segmentation-fault", "title": "Why is this code generating segmentation fault?", "body": "<p>I was trying to implement the insertion of nodes to a singly linked list.The compiler produced segmentation error in the traversal part of the code.</p>\n\n<pre><code>struct Node *start=NULL;\n\nvoid traverse() \n{\n    struct Node *t;\n    t=start;\n    if(t==NULL)\n    {\n        printf(\"Linked list is empty\\n\");\n        return;\n    }\n    printf(\"there are %d elements in linked list\",count);\n\n    while (t != NULL) \n    { \n        printf(\" %d \",t-&gt;data); \n        t=t-&gt;next; \n    } \n    printf(\" %d \",t-&gt;data);\n}\n</code></pre>\n\n<p>After running the code:</p>\n\n<pre><code>Shaons-Air:VSC shaon$ cd \"/Users/shaon/Desktop/VSC/\" &amp;&amp; gcc linkedlist.c -o linkedlist &amp;&amp; \"/Users/shaon/Desktop/VSC/\"linkedlist\n1.insert at the beginning2.insert at the end3.traverse\n1\nenter element\n2\n1.insert at the beginning2.insert at the end3.traverse\n1\nenter element\n3\n1.insert at the beginning2.insert at the end3.traverse\n3\nSegmentation fault: 11\n</code></pre>\n"}, {"tags": ["c", "libpng"], "comments": [{"owner": {"reputation": 3574, "user_id": 5793987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a057299226b268d59f2faa0b3f1d1112?s=128&d=identicon&r=PG", "display_name": "gudok", "link": "https://stackoverflow.com/users/5793987/gudok"}, "edited": false, "score": 0, "creation_date": 1564517957, "post_id": 57278322, "comment_id": 101055438, "body": "I checked <code>writepng</code> function by using dummy data and it worked correctly. There maybe something wrong with how you prepare <code>rgb</code> array..."}, {"owner": {"reputation": 63, "user_id": 11845367, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75be50fb6a3ed561ea30b7bd479d6b86?s=128&d=identicon&r=PG&f=1", "display_name": "DRG", "link": "https://stackoverflow.com/users/11845367/drg"}, "reply_to_user": {"reputation": 3574, "user_id": 5793987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a057299226b268d59f2faa0b3f1d1112?s=128&d=identicon&r=PG", "display_name": "gudok", "link": "https://stackoverflow.com/users/5793987/gudok"}, "edited": false, "score": 0, "creation_date": 1564568704, "post_id": 57278322, "comment_id": 101071816, "body": "Thanks for the answer. The writepng function works fine, i just f*cked up the arrays _y,_cb,_cr. I might have been braindead while defining the arrays with malloc."}, {"owner": {"reputation": 6321, "user_id": 263858, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/ZKsgT.jpg?s=128&g=1", "display_name": "New Alexandria", "link": "https://stackoverflow.com/users/263858/new-alexandria"}, "edited": false, "score": 0, "creation_date": 1612039483, "post_id": 57278322, "comment_id": 116644362, "body": "@DRG could you summarize your solution briefly and post it as an answer to your question?  Thank you"}], "owner": {"reputation": 63, "user_id": 11845367, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75be50fb6a3ed561ea30b7bd479d6b86?s=128&d=identicon&r=PG&f=1", "display_name": "DRG", "link": "https://stackoverflow.com/users/11845367/drg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 338, "favorite_count": 1, "answer_count": 0, "score": 5, "last_activity_date": 1564516951, "creation_date": 1564512726, "last_edit_date": 1564516951, "question_id": 57278322, "link": "https://stackoverflow.com/questions/57278322/how-to-prepare-a-rgb-array-and-the-rowpointer-for-png-write-image", "title": "How to prepare a RGB array and the rowpointer for png_write_image?", "body": "<p>I am quite new to C and need a bit help with the libpng.\nI have an unsigned char array filled with the RGB values of an image and need to create a .png image. I managed to create an image with the right size and kinda filled in the pixel values but the Original Picture looks like this:\n<img src=\"https://i.imgur.com/4Kg8Hyv.png\" alt=\"Original picture\">\nand my code does this:\n<img src=\"https://i.imgur.com/ucr0OKW.png\" alt=\"new picture\"></p>\n\n<p>Am I right that the pixel values have to be stored in an unsigned char array as: pixel one red, pixel one green, pixel one blue, pixel two red, pixel two green, pixel two blue,...\nAnd do I calculate the row pointers in the code below correctly?</p>\n\n<p>Building the pixel array (form Y,Cb,Cr values to RGB):</p>\n\n<pre><code>int wcnt = 0;\n\nfor(int y = 0; y &lt; height; y++){\n  for(int x = 0; x &lt; width; x++){\n\n    rgb[wcnt] = round(1.0 * _y[y][x] + 0.0 * _cb[y][x] + 1.402 * _cr[y][x]);        //red\n    rgb[wcnt+1] = round(1.0 * _y[y][x] + (-0.34414 * _cb[y][x]) + (-0.71414 * _cr[y][x]));  //green\n    rgb[wcnt+2] = round(1.0 * _y[y][x] + 1.772 * _cb[y][x] + 0.0 * _cr[y][x]);  //blue\n\n    wcnt = wcnt +3;\n  }\n}\n</code></pre>\n\n<p>Writing the PNG:</p>\n\n<pre><code>int writepng(char* name, char* dest){   \n    char decpng[256];\n    FILE *fp = NULL;\n    png_structp png_ptr = NULL;\n    png_infop info_ptr = NULL;\n    png_bytep row_pointers[height];\n\n    sprintf(decpng, \"%s%s_dec.png\", dest, name);\n\n    //Create File\n    fp = fopen(decpng, \"wb\");\n    if (fp == NULL){\n      fprintf(stderr, \"PNG konnte nicht angelegt werden!\\n\");\n      return EXIT_FAILURE;\n    }\n\n    // Information init\n    png_ptr = png_create_write_struct (PNG_LIBPNG_VER_STRING, NULL, NULL, NULL);\n    if (png_ptr == NULL){\n      fprintf(stderr, \"Schreibstruktur konnte nicht angelegt werden.\\n\");\n      return EXIT_FAILURE;\n    }\n\n    info_ptr = png_create_info_struct(png_ptr);\n    if (info_ptr == NULL){\n      fprintf(stderr, \"Infostruktur konnte nicht angelegt werden.\\n\");\n      return EXIT_FAILURE;\n    }\n\n    if (setjmp(png_jmpbuf(png_ptr))){\n      fprintf(stderr, \"Fehler Initialisierung.\\n\");\n      return EXIT_FAILURE;\n    }\n\n    png_init_io(png_ptr, fp);\n\n    if (setjmp(png_jmpbuf(png_ptr))){\n      fprintf(stderr, \"Fehler beim schreiben des Headers.\\n\");\n      return EXIT_FAILURE;\n    }\n\n    png_set_IHDR(png_ptr, info_ptr, width, height, 8, PNG_COLOR_TYPE_RGB, PNG_INTERLACE_NONE, PNG_COMPRESSION_TYPE_DEFAULT, PNG_FILTER_TYPE_DEFAULT);\n\n    png_write_info(png_ptr, info_ptr);\n\n    if (setjmp(png_jmpbuf(png_ptr))){\n      fprintf(stderr, \"Fehler beim schreiben der Daten.\\n\");\n      return EXIT_FAILURE;\n    }\n\n    //Fill PNG - here is something wrong\n\n    for(int k = 0; k &lt; height; k++){\n      //k = each line, k*width = pixels till first pixel of like k, *3 = RGB values\n      row_pointers[k] = (rgb + k * width * 3);\n    }\n\n    //png_struct, png_bytep\n    png_write_image(png_ptr, row_pointers);\n\n    png_write_end(png_ptr, info_ptr);\n\n    return EXIT_SUCCESS;\n}\n</code></pre>\n"}, {"tags": ["c", "objective-c", "transactions", "mongo-c-driver", "foundationdb"], "answers": [{"tags": [], "owner": {"reputation": 303, "user_id": 972209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9472c34e18ea572f94cd1fd100dcae5?s=128&d=identicon&r=PG", "display_name": "APKar", "link": "https://stackoverflow.com/users/972209/apkar"}, "is_accepted": true, "score": 1, "last_activity_date": 1570253169, "creation_date": 1570253169, "answer_id": 58245599, "question_id": 57278097, "link": "https://stackoverflow.com/questions/57278097/how-to-do-transactions-using-mongodb-c-driver-with-foundationdb-document-layer/58245599#58245599", "title": "How to do transactions using MongoDB C driver with FoundationDB Document Layer?", "body": "<p>Document layer doesn\u2019t support transactions, yet. It used to expose FoundationDB transactions through some constructs different to MongoDB constructs. But they are disabled for a while.</p>\n"}], "owner": {"reputation": 1411, "user_id": 10900045, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e346705758a9d79e2b4f6c6c07cc64ad?s=128&d=identicon&r=PG&f=1", "display_name": "johndoe", "link": "https://stackoverflow.com/users/10900045/johndoe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 58245599, "answer_count": 1, "score": 0, "last_activity_date": 1570253169, "creation_date": 1564511755, "last_edit_date": 1564514925, "question_id": 57278097, "link": "https://stackoverflow.com/questions/57278097/how-to-do-transactions-using-mongodb-c-driver-with-foundationdb-document-layer", "title": "How to do transactions using MongoDB C driver with FoundationDB Document Layer?", "body": "<p>The mongoc documentation for transaction uses session. So I tried to insert documents within a transaction associated with a session. But I got the error</p>\n\n<pre><code>[ 3666]:    ERROR:       mongoc: Failed to start session: Server does not support sessions\n</code></pre>\n\n<p>How to do transactions using MongoDB C driver with FoundationDB Document Layer?</p>\n\n<p>My current code is:</p>\n\n<pre><code>- (int)insertUser:(User *)user {\n    mongoc_client_session_t *session;\n    mongoc_session_opt_t *session_opts;\n    mongoc_transaction_opt_t *default_txn_opts;\n    mongoc_transaction_opt_t *txn_opts;\n    mongoc_read_concern_t *read_concern;\n    mongoc_write_concern_t *write_concern;\n    bson_t *doc;\n    bson_t *insert_opts;\n    bson_error_t err;\n    default_txn_opts = mongoc_transaction_opts_new();\n    read_concern = mongoc_read_concern_new();\n    mongoc_read_concern_set_level(read_concern, \"snapshot\");\n    mongoc_transaction_opts_set_read_concern(default_txn_opts, read_concern);\n    session_opts = mongoc_session_opts_new();\n    mongoc_session_opts_set_default_transaction_opts(session_opts, default_txn_opts);\n    session = mongoc_client_start_session(client, session_opts, &amp;err);\n    if (!session) {\n        MONGOC_ERROR(\"Failed to start session: %s\", err.message);\n        return EXIT_FAILURE;\n    }\n    txn_opts = mongoc_transaction_opts_new();\n    write_concern = mongoc_write_concern_new();\n    mongoc_write_concern_set_wmajority(write_concern, 1000);  // write timeout\n    mongoc_transaction_opts_set_write_concern(txn_opts, write_concern);\n}\n</code></pre>\n\n<pre><code>int insertUserTransaction(id param, mongoc_client_session_t *session, mongoc_transaction_opt_t *txn_opts, User *user, bson_error_t *err) {\n    bool ret = mongoc_client_session_start_transaction(session, txn_opts, err);\n    if (!ret) {\n        MONGOC_ERROR(\"Failed to start transaction: %s\", err-&gt;message);\n        return EXIT_FAILURE;\n    }\n    // ...\n}\n</code></pre>\n"}, {"tags": ["c", "hashmap"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1564511246, "post_id": 57277872, "comment_id": 101052514, "body": "The variable <code>map</code> passed by <code>main</code> is unchanged, and was not even initialised so <code>printf(&quot;%p\\n&quot;, map-&gt;list[0]);</code> (in <code>main</code>) is <i>undefined behaviour</i>."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1564511655, "post_id": 57277872, "comment_id": 101052753, "body": "...only the <i>copy</i> of <code>struct hashMap *map</code> was changed in the function. It&#39;s a copy of an uninitialised value, which gets overwritten in the function."}, {"owner": {"reputation": 59, "user_id": 10271132, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f660f6a9318748a7a5e8f8c18132b275?s=128&d=identicon&r=PG&f=1", "display_name": "The Guest", "link": "https://stackoverflow.com/users/10271132/the-guest"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1564512224, "post_id": 57277872, "comment_id": 101053007, "body": "Thanks for the info. it will help me."}], "owner": {"reputation": 59, "user_id": 10271132, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f660f6a9318748a7a5e8f8c18132b275?s=128&d=identicon&r=PG&f=1", "display_name": "The Guest", "link": "https://stackoverflow.com/users/10271132/the-guest"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 23, "favorite_count": 0, "closed_date": 1564511359, "answer_count": 0, "score": 0, "last_activity_date": 1564510941, "creation_date": 1564510941, "question_id": 57277872, "link": "https://stackoverflow.com/questions/57277872/hashmap-in-c-strange-behavior", "closed_reason": "Duplicate", "title": "Hashmap in c Strange behavior", "body": "<p>Why wont this code produce my expected Output?\nAlso there is segmentation error.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdbool.h&gt;\n#include &lt;string.h&gt;\n\n\nstruct node {\n    int key;\n    int val;\n    struct node *next;\n};\n\nstruct hashMap {\n    unsigned int size;\n    struct node **list;\n};\n\nvoid mapCreate(struct hashMap *map, unsigned int size)\n{\n    map = malloc(sizeof(struct hashMap));\n\n    map-&gt;size = size;\n\n    map-&gt;list = malloc(sizeof(struct node*)*size);\n\n    int i;\n    for (i=0; i &lt; size; i++) {\n        map-&gt;list[i] = NULL;\n    }\n\n    printf(\"%p\\n\", map-&gt;list[0]); // Prints (nil) as expected\n}\n\n\nint main()\n{\n    struct hashMap *map;\n\n    mapCreate(map, 5);\n    printf(\"%p\\n\", map-&gt;list[0]); // Should print (nil) but it doesn't\n\n    return 0;\n}\n</code></pre>\n\n<p>Why does my last printf function call not work? And why there is segmentation fault?</p>\n\n<p>I can't see what i did wrong.</p>\n"}, {"tags": ["c", "arrays", "struct"], "comments": [{"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 2, "creation_date": 1564510126, "post_id": 57277586, "comment_id": 101051967, "body": "<code>&quot;%[^\\n]&quot;</code> doesn&#39;t skip whitespace. Try <code>&quot; %[^\\n]&quot;</code>."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1564510153, "post_id": 57277586, "comment_id": 101051986, "body": "That&#39;s not an array of structs. That&#39;s a <i>single</i> struct. You may want to name your book structure <code>Book</code> not <code>Books</code> as it&#39;s just one, not many."}, {"owner": {"reputation": 45, "user_id": 11718633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a32138f498582d555a8b802a1a03b2e2?s=128&d=identicon&r=PG&f=1", "display_name": "thep1rate", "link": "https://stackoverflow.com/users/11718633/thep1rate"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1564511242, "post_id": 57277586, "comment_id": 101052510, "body": "@user3386109 Thank you so much! That actually worked, but I&#39;m not sure why. Could you explain the difference please?"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1564511580, "post_id": 57277586, "comment_id": 101052702, "body": "The link in the yellow box at the top of your question leads to a duplicate question. The answers to that question explain what the space does, and provide alternative solutions to the problem."}], "answers": [{"tags": [], "owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "is_accepted": true, "score": 2, "last_activity_date": 1564511072, "creation_date": 1564511072, "answer_id": 57277920, "question_id": 57277586, "link": "https://stackoverflow.com/questions/57277586/array-of-structs-doesnt-take-input-properly/57277920#57277920", "title": "Array of structs doesn&#39;t take input properly", "body": "<p>In <code>scanf</code>, <code>%[^\\n]</code> doesn't skip whitespace. To skip whitespace (which should fix your issue), do this:</p>\n\n<pre><code>scanf(\" %[^\\n]\", library[num].member);\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 11718633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a32138f498582d555a8b802a1a03b2e2?s=128&d=identicon&r=PG&f=1", "display_name": "thep1rate", "link": "https://stackoverflow.com/users/11718633/thep1rate"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 1, "closed_date": 1564510947, "accepted_answer_id": 57277920, "answer_count": 1, "score": 0, "last_activity_date": 1564511632, "creation_date": 1564509881, "question_id": 57277586, "link": "https://stackoverflow.com/questions/57277586/array-of-structs-doesnt-take-input-properly", "closed_reason": "Duplicate", "title": "Array of structs doesn&#39;t take input properly", "body": "<p>Every time I try to use an array of structs and get the input from the users it skips a scanf and I can't figure out why.\nI simplified the code by making the array of only 1 element and scanning just for that element and not with a for loop, but it still doesn't work.  </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main(){\n\n  typedef struct {\n    char title[30];\n    char author[30];\n    int year;\n  } Books;\n\n  Books library[1]; //array of structs\n\n  //input\n    printf(\"\\nAdd a new book to the shelf\");\n    printf(\"\\nTitle: \");\n    scanf(\"%[^\\n]\",library[0].title);\n    printf(\"\\nAuthor: \");\n    scanf(\"%[^\\n]\",library[0].author);\n    printf(\"\\nYear: \");\n    scanf(\"%d\",&amp;library[0].year);\n\n  //print\n    printf(\"\\nTitle: \");\n    printf(\"%s\",library[0].title);\n    printf(\"\\nAuthor: \");\n    printf(\"%s\",library[0].author);\n    printf(\"\\nYear: \");\n    printf(\"%d\\n\",library[0].year);\n\n    return 0;\n}\n\n</code></pre>\n\n<p>terminal:  </p>\n\n<pre><code>Add a new book to the shelf\nTitle: Fist Book  //input by user\n\nAuthor:                 //doesn't let me scan anything and jumps to Year: \nYear: 1998 //input\n\nTitle: Fist Book \nAuthor: \nYear: 1998\n</code></pre>\n"}, {"tags": ["c", "assertion"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1564509683, "post_id": 57277508, "comment_id": 101051790, "body": "Did you try to look into <code>assert.h</code>?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8554358"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1564509711, "post_id": 57277508, "comment_id": 101051798, "body": "No, not at all :("}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1564509729, "post_id": 57277508, "comment_id": 101051808, "body": "Then you might want to."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1564510052, "post_id": 57277508, "comment_id": 101051924, "body": "@EugeneSh.: Looking into one implementation\u2019s header can tell you only what that implementation does, not what the C standard requires."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1564513150, "post_id": 57277508, "comment_id": 101053441, "body": "Note that users are apt to stress your program harder than you do, so keeping the assertions will head off trouble at the pass.  At least, think about what should happen in the release build if the assertion would be triggered at runtime.  You might want to have a non-assertion check of the same condition that does appropriate error handling for non-debug (production) builds."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8554358"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1564523741, "post_id": 57277508, "comment_id": 101057352, "body": "@JonathanLeffler thanks !"}], "answers": [{"comments": [{"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1564510311, "post_id": 57277631, "comment_id": 101052057, "body": "@EduardoG: If <code>NDEBUG</code> is defined when the header is included, a subsequent <code>assert(i == 6);</code> will be replaced by <code>((void)0);</code>."}], "tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": true, "score": 0, "last_activity_date": 1564510019, "creation_date": 1564510019, "answer_id": 57277631, "question_id": 57277508, "link": "https://stackoverflow.com/questions/57277508/are-assertions-skipped-when-running-in-no-debug-mode/57277631#57277631", "title": "Are assertions skipped when running in no debug mode?", "body": "<p>From the 2018 C standard, 7.2 1:</p>\n\n<blockquote>\n  <p>The header <code>&lt;assert.h&gt;</code> defines the <code>assert</code> and <code>static_assert</code> macros and refers to another macro, <code>NDEBUG</code> which is not defined by <code>&lt;assert.h&gt;</code>. If <code>NDEBUG</code> is defined as a macro name at the point in the source file where <code>&lt;assert.h&gt;</code> is included, the assert macro is defined simply as:</p>\n  \n  <p><code>#define assert(ignore) ((void)0)</code></p>\n  \n  <p>The <code>assert</code> macro is redefined according to the current state of <code>NDEBUG</code> each time that <code>&lt;assert.h&gt;</code> is included.</p>\n</blockquote>\n\n<p>In summary, if <code>NDEBUG</code> is defined, the <code>assert</code> maro will have no run-time effect. (During compilation, it does have a place in the syntax; you should follow it with a semicolon to form a complete expression statement, which is then essentially ignored.)</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user8554358"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 57277631, "answer_count": 1, "score": 0, "last_activity_date": 1564510916, "creation_date": 1564509572, "last_edit_date": 1564510916, "question_id": 57277508, "link": "https://stackoverflow.com/questions/57277508/are-assertions-skipped-when-running-in-no-debug-mode", "title": "Are assertions skipped when running in no debug mode?", "body": "<p>I was wondering what actually happens with assertions when I have built my program and declared #define NDEBUG before the header.</p>\n\n<p>Does it skip the line of code at execution time? or do something with that assert?</p>\n\n<p><strong>Example:</strong></p>\n\n<pre><code>#define NDEBUG\n#include&lt;assert.h&gt;\n\nint main() {\n\n    int i = 5;\n\n    assert(i == 6);\n\n    return 0;\n}\n</code></pre>\n\n<p>I want to look the assertions while debugging if the programmer do something wrong, but when I run my code as final build I just want to skip the lines with assertions. I mean to don't slow down the program.</p>\n\n<p><strong>EDIT :</strong></p>\n\n<p>Ok I realised how macros as function-like work. Cute</p>\n"}, {"tags": ["c", "struct", "malloc", "free"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1564503937, "post_id": 57276075, "comment_id": 101050002, "body": "Freeing <code>current</code> does not make it <code>NULL</code>. It simply can&#39;t change it as it is passed by value. It is just making it to point to an invalid location. Dereferencing it is UB."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 3, "creation_date": 1564504216, "post_id": 57276075, "comment_id": 101050152, "body": "Oh, this is a code from a book? Throw it away."}, {"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 3, "creation_date": 1564504332, "post_id": 57276075, "comment_id": 101050207, "body": "yes the book is wrong. After calling <code>free</code> you can never touch that memory again in any way. If you do the computer is allowed to explode. Most won&#39;t, but the Deathstation 9000 certainly would."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1564508266, "post_id": 57276075, "comment_id": 101051253, "body": "This book was originally published in 1984 and while it was perhaps a good reference at the time, it&#39;s woefully out of date now if this code is still present in it. The casual &quot;don&#39;t worry it&#39;s fine&quot; method of writing sloppy C code no longer works."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1564539141, "post_id": 57276075, "comment_id": 101060377, "body": "@tadman: The 6th edition was published in 2013. If this code is in the 6th edition, it needs to be reported as an error. Neither gcc nor clang detects the error, so it&#39;s not <i>too</i> surprising that it wasn&#39;t caught -- but valgrind does catch it."}, {"owner": {"reputation": 2402, "user_id": 5983746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Nq5PW.jpg?s=128&g=1", "display_name": "mathsyouth", "link": "https://stackoverflow.com/users/5983746/mathsyouth"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1564539180, "post_id": 57276075, "comment_id": 101060385, "body": "@EugeneSh. Why <code>printf</code> function could print correct values after making <code>current</code> point to an invalid location?"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1564539221, "post_id": 57276075, "comment_id": 101060392, "body": "@KeithThompson Maybe this book is different, but a lot of old books get these very minor updates that never address serious problems like this, just typos and such."}, {"owner": {"reputation": 2402, "user_id": 5983746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Nq5PW.jpg?s=128&g=1", "display_name": "mathsyouth", "link": "https://stackoverflow.com/users/5983746/mathsyouth"}, "reply_to_user": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1564539719, "post_id": 57276075, "comment_id": 101060481, "body": "@KeithThompson@tadman I am so sorry for my mistake. The original code does contain <code>printf</code> function. I found the loop for freeing memory is strange, so I add the <code>printf</code> function to detect whether the free function works. However, after adding it, it still works. I am confused with <code>free</code> function. How does <code>free</code> work? Which memory does <code>free</code> function deallocate?"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1564556028, "post_id": 57276075, "comment_id": 101064778, "body": "@mathsyouth: <code>free</code> makes memory available for further allocation. It does not (necessarily) make it impossible to access it. Accessing freed memory has <i>undefined behavior</i>. It&#39;s up to you, the programmer, to avoid doing that; the implementation probably won&#39;t help you."}], "answers": [{"comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 2, "creation_date": 1564508314, "post_id": 57276160, "comment_id": 101051268, "body": "Use-after-free is a pretty egregious mistake to make, especially when teaching."}, {"owner": {"reputation": 2402, "user_id": 5983746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Nq5PW.jpg?s=128&g=1", "display_name": "mathsyouth", "link": "https://stackoverflow.com/users/5983746/mathsyouth"}, "edited": false, "score": 0, "creation_date": 1564538837, "post_id": 57276160, "comment_id": 101060314, "body": "Thanks for your point. However, I don&#39;t understand why it still works when I am trying to use an invalid deleted pointer. &quot;works&quot; means <code>printf</code>function still prints the values of variables."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 2402, "user_id": 5983746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Nq5PW.jpg?s=128&g=1", "display_name": "mathsyouth", "link": "https://stackoverflow.com/users/5983746/mathsyouth"}, "edited": false, "score": 0, "creation_date": 1564539185, "post_id": 57276160, "comment_id": 101060386, "body": "@mathsyouth: That&#39;s the nature of undefined behavior. The <i>worst</i> thing that can happen is that the code appears to &quot;work&quot;."}], "tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 3, "last_activity_date": 1564504197, "creation_date": 1564504197, "answer_id": 57276160, "question_id": 57276075, "link": "https://stackoverflow.com/questions/57276075/free-memory-used-for-struct-in-c-but-fails-code-from-c-primer-plus-6th-edition/57276160#57276160", "title": "free memory used for struct in C but fails (code from C Primer Plus 6th Edition)", "body": "<p>At least this loop is incorrect</p>\n\n<pre><code>current = head;\nwhile (current != NULL) {\n    free(current);\n    printf(\"Movie: %s, Rating: %d\\n\",                                                                                                                                \n            current-&gt;title, current-&gt;rating);\n    current = current-&gt;next;\n}\n</code></pre>\n\n<p>there should be</p>\n\n<pre><code>current = head;\nwhile (current != NULL) {\n    printf(\"Movie: %s, Rating: %d\\n\",                                                                                                                                \n            current-&gt;title, current-&gt;rating);\n    struct film *tmp = current;\n    current = current-&gt;next;\n    free(tmp);\n}\n</code></pre>\n\n<p>Otherwise you are trying to use an invalid deleted pointer.</p>\n"}, {"tags": [], "owner": {"reputation": 36, "user_id": 7576689, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8469cd251ba9198577857859456b1f2d?s=128&d=identicon&r=PG", "display_name": "Rodrigue Ren&#233;", "link": "https://stackoverflow.com/users/7576689/rodrigue-ren%c3%a9"}, "is_accepted": true, "score": 2, "last_activity_date": 1564538676, "creation_date": 1564538676, "answer_id": 57282202, "question_id": 57276075, "link": "https://stackoverflow.com/questions/57276075/free-memory-used-for-struct-in-c-but-fails-code-from-c-primer-plus-6th-edition/57282202#57282202", "title": "free memory used for struct in C but fails (code from C Primer Plus 6th Edition)", "body": "<p>The variable is still available for use but the space allocated isn't so you will have undefined behavior.\nIt can work now but it can crash later.\nA good practice is to set your pointer to NULL after freeing it.</p>\n"}, {"tags": [], "owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "is_accepted": false, "score": 1, "last_activity_date": 1564554306, "last_edit_date": 1564554306, "creation_date": 1564547694, "answer_id": 57283235, "question_id": 57276075, "link": "https://stackoverflow.com/questions/57276075/free-memory-used-for-struct-in-c-but-fails-code-from-c-primer-plus-6th-edition/57283235#57283235", "title": "free memory used for struct in C but fails (code from C Primer Plus 6th Edition)", "body": "<p>The code is incorrect as mentionedbin other answers.</p>\n\n<p>On one of the subsequent pages the author does show a correct linked list freeing function. He says</p>\n\n<blockquote>\n  <p>The code saves the address of the next node because the call to <code>free()</code>, in principle, may make the contents of the current node (the one pointed to by <code>*plist</code>) no longer available.</p>\n</blockquote>\n\n<p>While technically correct, this passage disqualifies the author as a C instructor. Here's the corrected passage.</p>\n\n<blockquote>\n  <p>The code saves the address of the next node because the call to free() <strong>makes</strong> the contents of the current node (the one pointed to by <code>*plist</code>) no longer available, <strong>and accessing it is undefined behaviour</strong>. </p>\n</blockquote>\n\n<p>Apparently the author never ever mentions the term \"undefined behaviour\". This is unacceptable in any serious C textbook.</p>\n"}], "owner": {"reputation": 2402, "user_id": 5983746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Nq5PW.jpg?s=128&g=1", "display_name": "mathsyouth", "link": "https://stackoverflow.com/users/5983746/mathsyouth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 57282202, "answer_count": 3, "score": 0, "last_activity_date": 1564554306, "creation_date": 1564503873, "question_id": 57276075, "link": "https://stackoverflow.com/questions/57276075/free-memory-used-for-struct-in-c-but-fails-code-from-c-primer-plus-6th-edition", "title": "free memory used for struct in C but fails (code from C Primer Plus 6th Edition)", "body": "<p>I run the code from Listing 17.2, P781, C Primer Plus 6th Edition.</p>\n\n<pre><code>/* films2.c -- using a linked list of structures */    \n#include &lt;stdio.h&gt;    \n#include &lt;stdlib.h&gt;   /* has the malloc prototype */    \n#include &lt;string.h&gt;   /* has the strcpy prototype */    \n#define TSIZE 45      /* size of array to hold title */                                                                                                                  \n\nstruct film {    \n    char title[TSIZE];    \n    int rating;    \n    struct film *next;  /* points to next struct in list */    \n};    \n\nchar *s_gets(char *st, int n);    \n\n\nint main(void)    \n{    \n    struct film *head = NULL;    \n    struct film *prev, *current;    \n    char input[TSIZE];    \n\n    /* Gather and store information */    \n    puts(\"Enter first movie title:\");    \n    while (s_gets(input, TSIZE) != NULL &amp;&amp; input[0] != '\\0') {    \n        current = (struct film *) malloc(sizeof(struct film));    \n        if (head == NULL)   /* first structure */    \n            head = current;    \n        else   /* subseqent structures */    \n            prev-&gt;next = current;    \n        current-&gt;next = NULL;    \n        strcpy(current-&gt;title, input);    \n        puts(\"Enter your rating &lt;0-10&gt;:\");    \n        scanf(\"%d\", &amp;current-&gt;rating);    \n        while (getchar() != '\\n')    \n            continue;    \n        puts(\"Enter next movie title (empty line to stop):\");    \n        prev = current;    \n    } \n\n    /* show list of movies */    \n    if (head == NULL)    \n        printf(\"No data entered.\");    \n    else    \n        printf(\"Here is the movie list:\\n\");    \n    current = head;    \n    while (current != NULL) {\n        printf(\"Movie: %s     Rating: %d\\n\",\n                current-&gt;title, current-&gt;rating);\n        current = current-&gt;next;\n    }\n\n    /* Program done, so free allocated memory */\n    current = head;\n    while (current != NULL) {\n        free(current);\n        printf(\"Movie: %s, Rating: %d\\n\",                                                                                                                                \n                current-&gt;title, current-&gt;rating);\n        current = current-&gt;next;\n    }\n    printf(\"Bye!\\n\");\n\n    return 0;\n}\n\nchar *s_gets(char *st, int n)\n{\n    char *ret_val;\n    char *find;\n\n    ret_val = fgets(st, n, stdin);\n    if (ret_val) {\n        find = strchr(st, '\\n');  // look for newline\n        if (find)    // if the address is not NULL,\n            *find = '\\0';    // place a null character there\n        else\n            while (getchar() != '\\n')\n                continue;      // dispose of rest of line\n    }\n    return ret_val;\n}\n</code></pre>\n\n<p>My question is that after <code>free(current)</code>, <code>current-&gt;title</code> and <code>current-&gt;rating</code> still is there, and <code>current-&gt;next</code> is not <code>NULL</code>. I don't know why.                                                                                                </p>\n"}, {"tags": ["c++", "c", "c++11"], "comments": [{"owner": {"reputation": 22416, "user_id": 5494370, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152989584621642/picture?type=large", "display_name": "Alan Birtles", "link": "https://stackoverflow.com/users/5494370/alan-birtles"}, "edited": false, "score": 0, "creation_date": 1564508774, "post_id": 57276005, "comment_id": 101051415, "body": "try <a href=\"https://www.boost.org/doc/libs/1_70_0/doc/html/boost_asio/reference/ip__address_v6_range.html\" rel=\"nofollow noreferrer\">boost.org/doc/libs/1_70_0/doc/html/boost_asio/reference/&hellip;</a> <a href=\"https://www.boost.org/doc/libs/1_70_0/doc/html/boost_asio/reference/ip__basic_address_range_lt__address_v4__gt_.html\" rel=\"nofollow noreferrer\">boost.org/doc/libs/1_70_0/doc/html/boost_asio/reference/&hellip;</a>"}, {"owner": {"reputation": 2459, "user_id": 975989, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/21bb25fc82d8cf970dbea53bd9685917?s=128&d=identicon&r=PG", "display_name": "user975989", "link": "https://stackoverflow.com/users/975989/user975989"}, "edited": false, "score": 1, "creation_date": 1564559994, "post_id": 57276005, "comment_id": 101066783, "body": "c and c++ are only related, one answer might not apply to both languages. Pick a language for the question."}], "answers": [{"tags": [], "owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "is_accepted": false, "score": 0, "last_activity_date": 1564508279, "creation_date": 1564508279, "answer_id": 57277220, "question_id": 57276005, "link": "https://stackoverflow.com/questions/57276005/how-to-find-whether-a-given-ipv6-address-falls-in-the-cidr-range-using-c-or-c/57277220#57277220", "title": "How to find whether a given IPv6 address falls in the CIDR range using C or C++?", "body": "<p>Unless you have 128-bit unsigned int on your system (which you don't), you're well outside of range there. After that, your maths just don't work any more.</p>\n\n<p>Use a nice IP library instead!</p>\n"}, {"comments": [{"owner": {"reputation": 56858, "user_id": 131930, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/91536fe27d32713b8a154a0bf42f6748?s=128&d=identicon&r=PG", "display_name": "Jeremy Friesner", "link": "https://stackoverflow.com/users/131930/jeremy-friesner"}, "edited": false, "score": 1, "creation_date": 1564512809, "post_id": 57277907, "comment_id": 101053267, "body": "You might consider replacing <code>unsigned int</code> with <code>uint32_t</code> (from stdint.h), just to make the 32-bits size of each ip_parts[] value more explicit."}, {"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "edited": false, "score": 0, "creation_date": 1564513042, "post_id": 57277907, "comment_id": 101053387, "body": "Attempting to left-shift an operand by a number of bits greater than or equal to its width is undefined behavior. <code>ip[0]&lt;&lt;112</code>, etc., are bugs."}, {"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "edited": false, "score": 1, "creation_date": 1564517834, "post_id": 57277907, "comment_id": 101055390, "body": "Next issue: endianness."}, {"owner": {"reputation": 19, "user_id": 5984396, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1862a126568cfb2a17dea672e1915f1?s=128&d=identicon&r=PG&f=1", "display_name": "Chethan K T", "link": "https://stackoverflow.com/users/5984396/chethan-k-t"}, "edited": false, "score": 0, "creation_date": 1564547472, "post_id": 57277907, "comment_id": 101061820, "body": "Yes this works. If the mask is 8 or 16, how can it be achieved?"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 1, "creation_date": 1564568250, "post_id": 57277907, "comment_id": 101071545, "body": "<i>&quot;unsigned int only has a size of 32 Bits&quot;</i> This is not necessarily true."}, {"owner": {"reputation": 101, "user_id": 9783323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/419f0d3c2ddb0b4b9ea88a64f8515257?s=128&d=identicon&r=PG&f=1", "display_name": "Moray", "link": "https://stackoverflow.com/users/9783323/moray"}, "reply_to_user": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "edited": false, "score": 0, "creation_date": 1564599772, "post_id": 57277907, "comment_id": 101088802, "body": "@Davislor endianness isn&#39;t a problem as long as you stay constant over the whole program. Personally I like it more this way, because it&#39;s more intuitive for me, but of course the order can be swapped."}, {"owner": {"reputation": 101, "user_id": 9783323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/419f0d3c2ddb0b4b9ea88a64f8515257?s=128&d=identicon&r=PG&f=1", "display_name": "Moray", "link": "https://stackoverflow.com/users/9783323/moray"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1564599857, "post_id": 57277907, "comment_id": 101088832, "body": "@LightnessRacesinOrbit Yes that&#39;s true, I assume that OP is using a compiler which defines unsigned int with 32 bits of size"}, {"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "edited": false, "score": 1, "creation_date": 1564600037, "post_id": 57277907, "comment_id": 101088902, "body": "@Moray It \u201cisn\u2019t a problem\u201d until you recompile on another architecture and it breaks. Or worse, it doesn\u2019t, and you realize you\u2019ve been producing two incompatible data formats that now you have to support forever. A lot of companies have done this by accident."}, {"owner": {"reputation": 101, "user_id": 9783323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/419f0d3c2ddb0b4b9ea88a64f8515257?s=128&d=identicon&r=PG&f=1", "display_name": "Moray", "link": "https://stackoverflow.com/users/9783323/moray"}, "reply_to_user": {"reputation": 19, "user_id": 5984396, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1862a126568cfb2a17dea672e1915f1?s=128&d=identicon&r=PG&f=1", "display_name": "Chethan K T", "link": "https://stackoverflow.com/users/5984396/chethan-k-t"}, "edited": false, "score": 0, "creation_date": 1564602311, "post_id": 57277907, "comment_id": 101089846, "body": "@ChethanKT I have changed it now, so that you can generate a mask from a prefix."}, {"owner": {"reputation": 101, "user_id": 9783323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/419f0d3c2ddb0b4b9ea88a64f8515257?s=128&d=identicon&r=PG&f=1", "display_name": "Moray", "link": "https://stackoverflow.com/users/9783323/moray"}, "reply_to_user": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "edited": false, "score": 0, "creation_date": 1564602387, "post_id": 57277907, "comment_id": 101089873, "body": "@Davislor Oh you are right! Sorry I didn&#39;t think about that. I won&#39;t change it, because of time reasons, but +1 for your hint"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1564617581, "post_id": 57277907, "comment_id": 101094072, "body": "@Moray Then I have made the correction for you. You should address the other issues when you have the time, because you would not want to spread misinformation."}], "tags": [], "owner": {"reputation": 101, "user_id": 9783323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/419f0d3c2ddb0b4b9ea88a64f8515257?s=128&d=identicon&r=PG&f=1", "display_name": "Moray", "link": "https://stackoverflow.com/users/9783323/moray"}, "is_accepted": false, "score": 1, "last_activity_date": 1564617560, "last_edit_date": 1564617560, "creation_date": 1564511023, "answer_id": 57277907, "question_id": 57276005, "link": "https://stackoverflow.com/questions/57276005/how-to-find-whether-a-given-ipv6-address-falls-in-the-cidr-range-using-c-or-c/57277907#57277907", "title": "How to find whether a given IPv6 address falls in the CIDR range using C or C++?", "body": "<p>The problem is that unsigned int usually only has a size of 32 Bits. Sometimes it's more, and sometimes it's less, but today there's no mainstream compiler for which it's 128 Bits. An IPv6 address needs 128 Bits.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdint.h&gt;\n\n//Little struct containing a unsigned int array with the size of 4\n//4 * 32bit = 128bit (== IPv6)\ntypedef struct IPv6_address{\n    uint32_t ip_parts[4];\n} IPv6;\n\nIPv6 and(IPv6 first, IPv6 second);\nshort match(IPv6 first, IPv6 second);\nIPv6 mask_from_prefix(int prefix);\n\nint main(){\n    int netmask = 32;\n    unsigned int ip[8] = {0x2001, 0x4860, 0x4860, 0, 0, 0, 0x012D, 0x8888};\n    unsigned int cidr_ip[8] = {0x2001, 0x4860, 0x4860, 0, 0, 0, 0, 0x8888};\n\n    IPv6 ipv6 = {(ip[0]&lt;&lt;16) + (ip[1]), (ip[2]&lt;&lt;16) + (ip[3]), (ip[4]&lt;&lt;16) + (ip[5]), (ip[6]&lt;&lt;16) + ip[7]};\n    IPv6 range = {(cidr_ip[0]&lt;&lt;16) + (cidr_ip[1]), (cidr_ip[2]&lt;&lt;16) + (cidr_ip[3]), (cidr_ip[4]&lt;&lt;16) + (cidr_ip[5]), (cidr_ip[6]&lt;&lt;16) + cidr_ip[7]};\n    IPv6 mask = mask_from_prefix(netmask);\n\n    //if((ipv6 &amp; mask) == (range &amp; mask)){\n    if(match(and(ipv6, mask), and(range, mask))){\n        printf(\"matched\\n\");\n    }\n    else{\n        printf(\"no match\\n\");\n    }\n\n    return EXIT_SUCCESS;\n}\n\n//Bitwise-AND operation between two IPv6 addresses (128 bit integer as struct)\nIPv6 and(IPv6 first, IPv6 second){\n    IPv6 toReturn = {};\n    for(int i = 0; i &lt; 4; i++){\n        toReturn.ip_parts[i] = first.ip_parts[i] &amp; second.ip_parts[i];\n    }\n\n    return toReturn;\n}\n\n//Returns 1, if the given IPv6 addresses match\n//Otherwise 0\nshort match(IPv6 first, IPv6 second){\n    short matchCount = 0;\n    for(int i = 0; i &lt; 4; i++){\n        if(first.ip_parts[i] == second.ip_parts[i]){\n            matchCount++;\n        }\n    }\n\n    return matchCount == 4 ? 1 : 0; //If all four parts match return 1, otherwise 0\n}\n\n//Returns an IPv6 address representing the net mask of the given prefix\nIPv6 mask_from_prefix(int prefix){\n    IPv6 mask = {};\n    for(int i = 0; i &lt; 4; i++){\n        int onesForThisPart = prefix - i*32;\n\n        //Check if 0 (or less), because shifting by 32 would result in an \"erroneous\" behavior, where nothing would happen at all\n        if(onesForThisPart &lt;= 0){\n            mask.ip_parts[i] = 0;\n        }\n        else{\n            mask.ip_parts[i] = (~0u) &lt;&lt; (32 - onesForThisPart);\n        }\n    }\n\n    return mask;\n}\n</code></pre>\n\n<p>It's not the most beautiful solution, but it works.\nHope I could help!</p>\n"}, {"tags": [], "owner": {"reputation": 467, "user_id": 7771076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/035048bc359d1dbdf81f3a04ae5dd295?s=128&d=identicon&r=PG&f=1", "display_name": "ofo", "link": "https://stackoverflow.com/users/7771076/ofo"}, "is_accepted": false, "score": 0, "last_activity_date": 1564581128, "last_edit_date": 1564581128, "creation_date": 1564525293, "answer_id": 57280784, "question_id": 57276005, "link": "https://stackoverflow.com/questions/57276005/how-to-find-whether-a-given-ipv6-address-falls-in-the-cidr-range-using-c-or-c/57280784#57280784", "title": "How to find whether a given IPv6 address falls in the CIDR range using C or C++?", "body": "<p>It is simpler to treat IPv6 addresses as byte arrays rather than integer types as they are 128-bits and in network byte order.</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include &lt;algorithm&gt; // std::equal\n#include &lt;cassert&gt;   // assert\n\nstruct ipv6addr {\n    unsigned char addr[16];\n\n    bool is_subnet(const ipv6addr&amp; prefix, unsigned int len) const {\n        assert(len &lt;= sizeof(addr) * 8);\n\n        int cmp_bytes = len / 8;\n        if (!std::equal(addr, addr + cmp_bytes, prefix.addr)) return false;\n\n        int cmp_bits = len % 8;\n        if (cmp_bits) {\n            int bitmask = 0xff &lt;&lt; (8 - cmp_bits);\n            if ((addr[cmp_bytes] &amp; bitmask) != (prefix.addr[cmp_bytes] &amp; bitmask))\n                return false;\n        }\n        return true;\n    }\n};\n\nint main() {\n    ipv6addr addr {0x20, 0x01, 0x48, 0x60, 0, 0, 0, 0, 0, 0, 0x01, 0x2D, 0x88, 0x88};\n    ipv6addr prefix {0x20, 0x01, 0x48, 0x60, 0, 0, 0, 0, 0, 0, 0, 0, 0x88, 0x88};\n    unsigned int len = 32;\n\n    assert(addr.is_subnet(prefix, len));\n\n    return 0;\n}\n</code></pre>\n\n<p>If you really want to store them as integers you can use something like <code>struct { uint64_t hi; uint64_t lo; }</code>, but you need to account for endianness while accessing/modifying those fields.</p>\n\n<hr>\n\n<p><strong>Edit:</strong> Came to think about it, I realized using memcmp for subnet comparison wasn't correct. I corrected the code above. Also I've replaced <code>memcmp</code> with<code>std::equal</code>, but either one is okay. I didn't extensively test it though, so you should definitely test it more if you decide to use it.</p>\n"}, {"tags": [], "owner": {"reputation": 22416, "user_id": 5494370, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152989584621642/picture?type=large", "display_name": "Alan Birtles", "link": "https://stackoverflow.com/users/5494370/alan-birtles"}, "is_accepted": false, "score": 1, "last_activity_date": 1564569215, "creation_date": 1564569215, "answer_id": 57288759, "question_id": 57276005, "link": "https://stackoverflow.com/questions/57276005/how-to-find-whether-a-given-ipv6-address-falls-in-the-cidr-range-using-c-or-c/57288759#57288759", "title": "How to find whether a given IPv6 address falls in the CIDR range using C or C++?", "body": "<p>Boost ASIO's IP address and range classes do most of the work for this for you. Unfortunately they don't currently provide a way for parsing an IP address range from a string.</p>\n\n<p>Most of the following code is the parser for an IP address range, the code works with both IP4 and IP6:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;boost/asio.hpp&gt;\n\nusing namespace boost::asio::ip;\n\ntemplate &lt; typename Addr &gt;\nbool parseAddress( const std::string&amp; str, Addr&amp; addr )\n{\n  boost::system::error_code ec;\n  addr = Addr::from_string( str, ec );\n  return !ec;\n}\n\n address_v4_range getRange( address_v4 address, size_t size )\n{\n  address_v4 end = address_v4( ( address.to_ulong() + ( 1 &lt;&lt; ( 32 - size ) ) ) &amp; 0xFFFFFFFF );\n  return address_v4_range( address, end );\n}\n\naddress_v6_range getRange( address_v6 address, size_t size )\n{\n  auto bytes = address.to_bytes();\n  size_t offset = size &gt;&gt; 3;\n  uint8_t toAdd = 1 &lt;&lt; ( 8 - ( size &amp; 0x7 ) );\n  while ( toAdd )\n  {\n    int value = bytes[ offset ] + toAdd;\n    bytes[ offset ] = value &amp; 0xFF;\n    toAdd = value &gt;&gt; 8;\n    if ( offset == 0 )\n    {\n      break;\n    }\n    offset--;\n  }\n  address_v6 end = address_v6( bytes );\n  return address_v6_range( address, end );\n} \n\ntemplate &lt; typename Addr &gt;\nbool parseRange( const std::string&amp; str, basic_address_range&lt; Addr &gt;&amp; range )\n{\n  size_t pos = str.find( '/' );\n  if ( pos == std::string::npos )\n  {\n    return false;\n  }\n  // should only be one slash\n  if ( str.find( '/', pos + 1 ) != std::string::npos )\n  {\n    return false;\n  }\n  boost::system::error_code ec;\n  Addr address;\n  if ( !parseAddress( str.substr( 0, pos ), address ) )\n  {\n    return false;\n  }\n  std::string sizeStr = str.substr( pos + 1 );\n  size_t index;\n  int size = std::stoi( sizeStr, &amp;index );\n  if ( index != sizeStr.size() )\n  {\n    return false;\n  }\n  if ( size &gt; std::tuple_size&lt; typename Addr::bytes_type &gt;::value * 8 || size &lt; 0 )\n  {\n    return false;\n  }\n  range = getRange( address, size );\n  return !ec;\n}\n\nint main()\n{\n    address_v6 address;\n    if ( !parseAddress( \"2001:4860:4860:0000:0000:0000:012D:8888\", address ) )\n    {\n        std::cout &lt;&lt; \"invalid address\\n\";\n        return 1;\n    }\n    address_v6_range range;\n    if ( !parseRange( \"2001:4860:4860:0000:0000:0000:0000:8888/32\", range ) )\n    {\n        std::cout &lt;&lt; \"invalid range\\n\";\n        return 1;\n    }\n    bool inRange = range.find( address ) != range.end();\n    std::cout &lt;&lt; \"in range: \" &lt;&lt; inRange &lt;&lt; \"\\n\";\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 5984396, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1862a126568cfb2a17dea672e1915f1?s=128&d=identicon&r=PG&f=1", "display_name": "Chethan K T", "link": "https://stackoverflow.com/users/5984396/chethan-k-t"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 827, "favorite_count": 1, "answer_count": 4, "score": 1, "last_activity_date": 1564617560, "creation_date": 1564503590, "last_edit_date": 1564512478, "question_id": 57276005, "link": "https://stackoverflow.com/questions/57276005/how-to-find-whether-a-given-ipv6-address-falls-in-the-cidr-range-using-c-or-c", "title": "How to find whether a given IPv6 address falls in the CIDR range using C or C++?", "body": "<p>If I have an ipv6 address 2001:4860:4860:0000:0000:0000:012D:8888 and want to find whether this falls in the given CIDR range 2001:4860:4860:0000:0000:0000:0000:8888/32. How do I do this in C or C++?</p>\n\n<p>I tried similarly as we do for ipv4. \n(ip &amp; netmask) == (range &amp; netmask)</p>\n\n<pre><code>unsigned int ipv6 = (ip[0]&lt;&lt;112) + (ip[1]&lt;&lt;96) + (ip[2]&lt;&lt;80) + (ip[3]&lt;&lt;64)+ (ip[4]&lt;&lt;48) + (ip[5]&lt;&lt;32) + (ip[6]&lt;&lt;16) + ip[7];\n\nunsigned int range = (cidr_ip[0]&lt;&lt;112) + (cidr_ip[1]&lt;&lt;96) + (cidr_ip[2]&lt;&lt;80) + (cidr_ip[3]&lt;&lt;64)+ (cidr_ip[4]&lt;&lt;48) + (cidr_ip[5]&lt;&lt;32) + (cidr_ip[6]&lt;&lt;16) + cidr_ip[7];\nunsigned int mask = (~0u) &lt;&lt; (128-netmask);\n\nif((ipv6 &amp; mask) == (range &amp; mask)){\n    printf(\"matched\\n\");\n}\nelse\n{\n    printf(\"no match\\n\");\n}\n\n</code></pre>\n\n<p>This didn't work for me as expected. The above ipv6 falls in the range. But the program says \"no match\".</p>\n"}, {"tags": ["c", "dictionary", "compilation", "runtime"], "comments": [{"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1564503866, "post_id": 57275997, "comment_id": 101049973, "body": "Any reason you can&#39;t merge the two into a single program?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 2, "creation_date": 1564509570, "post_id": 57275997, "comment_id": 101051749, "body": "Running two different programs concurrently is a feature provided (or not) by your operating system.  All modern, general-purpose operating systems do provide for it, but available mechanisms vary.  But if you have more specific requirements, such as that the two programs share dictionary data, then that&#39;s more complicated."}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 10328700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47fd56882fce65669e29897f7761765f?s=128&d=identicon&r=PG&f=1", "display_name": "KSoni", "link": "https://stackoverflow.com/users/10328700/ksoni"}, "edited": false, "score": 0, "creation_date": 1564588255, "post_id": 57280972, "comment_id": 101083569, "body": "Please mark as the answer and close the question if no further question/concern."}], "tags": [], "owner": {"reputation": 51, "user_id": 10328700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47fd56882fce65669e29897f7761765f?s=128&d=identicon&r=PG&f=1", "display_name": "KSoni", "link": "https://stackoverflow.com/users/10328700/ksoni"}, "is_accepted": false, "score": 1, "last_activity_date": 1564526731, "creation_date": 1564526731, "answer_id": 57280972, "question_id": 57275997, "link": "https://stackoverflow.com/questions/57275997/is-there-a-way-to-run-two-programs-simultaneously-in-c-and-records-the-output/57280972#57280972", "title": "Is there a way to run two programs simultaneously in C and records the output", "body": "<p>you can use the threading to achieve your goal, for example:</p>\n\n<pre><code>#include \"pthread.h\"                                                                                    \n#include &lt;stdio.h&gt;                                                                                      \n\n#define bool int                                                                                        \n#define true 1                                                                                          \n#define false 0                                                                                         \n#define thread pthread_t                                                                                \n#define thread_fire pthread_create                                                                      \n#define thread_wait pthread_exit                                                                        \n\nint get_mul(int num, bool even)                                                                         \n{                                                                                                       \n    if (even)                                                                                           \n        return (2 * num);                                                                               \n    else                                                                                                \n        return ((2 * num) + 1);                                                                         \n}                                                                                                       \n\nvoid* func_odd(void *arg)                                                                               \n{                                                                                                       \n    int num =  *((int *)arg);                                                                           \n    printf(\"%s: [%d]\\n\", __func__, get_mul(num, false));                                                \n\n    return NULL;                                                                                        \n}                                                                                                       \n\nvoid* func_even(void *arg)                                                                              \n{                                                                                                       \n    int num = *((int *)arg);                                                                            \n    printf(\"%s: [%d]\\n\", __func__, get_mul(num, true));                                                 \n\n    return NULL;                                                                                        \n}                                                                                                       \n\nvoid func(int num)                                                                                      \n{                                                                                                       \n    thread tid;                                                                                         \n    thread_fire(&amp;tid, NULL, func_odd,  (void *)&amp;num);                                                   \n    thread_fire(&amp;tid, NULL, func_even, (void *)&amp;num);                                                   \n    thread_wait(NULL);                                                                                  \n}                                                                                                       \n\nint main(int argc, char **argv)                                                                         \n{                                                                                                       \n    int i, num = atoi(argv[1]);                                                                         \n\n    func(num);                                                                                          \n\n    return 0;                                                                                           \n}\n\n**compiling:**\ngcc -g -c thread.c\ngcc -o thread thread.o -lpthread\n\n**Output:**\n./thread 3 \nfunc_odd: [7]\nfunc_even: [6]\n</code></pre>\n\n<p>In above example, replace func_odd() and func_even() with your two functions (with same name) defined in two different files.</p>\n\n<p>For example, you can call \"func_odd\" to \"func_file1\", and \"fund_even\" to \"func_file2\".</p>\n\n<p>Power of multithreading!!!!</p>\n"}], "owner": {"reputation": 63, "user_id": 11069240, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-EJfoToUdxco/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQMuvu7sAMoA3ua6NdmuW4sVrr1Inw/mo/photo.jpg?sz=128", "display_name": "eng2019", "link": "https://stackoverflow.com/users/11069240/eng2019"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 530, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1564526731, "creation_date": 1564503561, "question_id": 57275997, "link": "https://stackoverflow.com/questions/57275997/is-there-a-way-to-run-two-programs-simultaneously-in-c-and-records-the-output", "title": "Is there a way to run two programs simultaneously in C and records the output", "body": "<p>I have two programs in C almost the same (with a little different) and I have (key/value) dictionary in another C file</p>\n\n<p>The following steps are done for both programs</p>\n\n<p>compile the first program</p>\n\n<pre><code>gcc file1.c dict.c\n</code></pre>\n\n<p>compile the second program</p>\n\n<pre><code>gcc file2.c dict.c\n</code></pre>\n\n<p>and inside the file.c I called both functions update(to fill the dictionary) and printDic (to print the content of dictionary)</p>\n\n<pre><code>//file1.c\nint func(int w){\n  update(\"w\",w) \n  if ((w &gt;= w) &amp;&amp; ((w % w) == 0))\n  {\n    w= w*4\n    update(\"w\",w) \n    printDic();\n  }\n  else\n  { \n    w=1;\n    update(\"w\",w) \n    printDic();\n  }\n  return 0; }\n\n//file2.c\nint func(int w){\n  update(\"w\",w) \n  if ((w &gt;= 4) &amp;&amp; ((w / w) == 0))\n  {\n    w = w/2;\n    update(\"w\",w)\n    printDic();\n\n  }\n  else\n  { \n    w=0;\n    update(\"w\",w)\n    printDic();\n  }\n  return 0; }\n</code></pre>\n\n<p>and both files have the same main </p>\n\n<pre><code>//main\n int main(int argc, char *argv[]){\n     func(10);\n     func(5);\n     func(2);\n     func(0);\n     func(180);\n\n    return 0; }\n</code></pre>\n\n<p>So, the update() will fill the dictionary with the values of w once they change and then print them.</p>\n\n<p>Is there a way to run these two files with the dictionary at once, in order to compare the output e.g. if I pass 10 in both programs will end up with a different value of w (which is stored in the dictionary).</p>\n\n<p>Note: I need to call the func many times and in the same file I don't want to run the program each time with only one call.</p>\n\n<p>the dictionary is working very well with one file and in each call to func the value of w is append to txt file.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 13842, "user_id": 759253, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0136e90dfd678a82c1dbba77dcbfc28e?s=128&d=identicon&r=PG", "display_name": "Igor R.", "link": "https://stackoverflow.com/users/759253/igor-r"}, "edited": false, "score": 0, "creation_date": 1564503119, "post_id": 57275845, "comment_id": 101049601, "body": "Array identifier is an lvalue - both in C and C++."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1564511368, "post_id": 57275845, "comment_id": 101052594, "body": "For some more information on this question, see <a href=\"https://stackoverflow.com/questions/50808782/what-does-impossibility-to-return-arrays-actually-mean-in-c/50808867#50808867\">this answer</a> and its comments.  (You&#39;ll notice, in fact, that the first comment is from the same John Bollinger who has answered your question here.  The question of &quot;is an array name an lvalue?&quot; is a complicated one.  It&#39;s certainly not a modifiable lvalue, and it can&#39;t appear on the <b>l</b>eft-hand side of an assignment operator, so it&#39;s at best a non-modifiable lvalue.)"}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 10584779, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-8OFhzRwTnEw/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbA2jQCXgkYEf1vYdghU45ySO70-3Q/mo/photo.jpg?sz=128", "display_name": "\uc774\uc2b9\ud6c8", "link": "https://stackoverflow.com/users/10584779/%ec%9d%b4%ec%8a%b9%ed%9b%88"}, "edited": false, "score": 0, "creation_date": 1564558709, "post_id": 57277375, "comment_id": 101066122, "body": "Thank you so much. It was helpful. It&#39;s a stupid question, but does an array name itself take up space in the memory?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 43, "user_id": 10584779, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-8OFhzRwTnEw/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbA2jQCXgkYEf1vYdghU45ySO70-3Q/mo/photo.jpg?sz=128", "display_name": "\uc774\uc2b9\ud6c8", "link": "https://stackoverflow.com/users/10584779/%ec%9d%b4%ec%8a%b9%ed%9b%88"}, "edited": false, "score": 0, "creation_date": 1564573967, "post_id": 57277375, "comment_id": 101074759, "body": "@\uc774\uc2b9\ud6c8, the array itself takes up memory, but its identifier is like all other symbols appearing in the program source.  C and C++ do not specify whether identifiers take up memory at runtime, and none of their specifications or requirements imply that identifiers are accessible at runtime (unlike Python, Java, and various others)."}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": true, "score": 1, "last_activity_date": 1564509013, "creation_date": 1564509013, "answer_id": 57277375, "question_id": 57275845, "link": "https://stackoverflow.com/questions/57275845/is-the-meaning-of-l-value-different-in-c-and-c/57277375#57277375", "title": "Is the meaning of l-value different in c and c++?", "body": "<blockquote>\n  <ol>\n  <li>is an array name l-value?</li>\n  </ol>\n</blockquote>\n\n<p>Yes, in both C and C++.</p>\n\n<blockquote>\n  <ol start=\"2\">\n  <li>Is there any difference between what means l-value in c and c++?</li>\n  </ol>\n</blockquote>\n\n<p>Yes, but not of great significance.  Here is the definition from C11, paragraph 6.3.2.1/1:</p>\n\n<blockquote>\n  <p>An lvalue is an expression (with an object type other than void) that potentially designates an object</p>\n</blockquote>\n\n<p>C also includes a footnote (#64) expanding on that, which includes:</p>\n\n<blockquote>\n  <p>The name ''lvalue'' comes originally from the assignment expression <code>E1 = E2</code>, in which the left operand <code>E1</code> is required to be a (modifiable) lvalue. It is perhaps better considered as representing an object\n  ''locator value''. [...] An\n  obvious example of an lvalue is an identifier of an object.</p>\n</blockquote>\n\n<p>Here is the definition from C++14, paragraph 3.10/1:</p>\n\n<blockquote>\n  <p>An <em>lvalue</em> (so called, historically, because lvalues could appear on\n  the left-hand side of an assignment expression) designates a function\n  or an object.</p>\n</blockquote>\n\n<p>If you read carefully, you will notice that in C, an lvalue only <em>potentially</em> designates an object, whereas in C++, no room is left for unfulfilled potential -- an lvalue does designate an object or function.  You'll also then notice that C++ includes function designators among its lvalues, whereas C does not.  In practice, these distinctions are more technical than deeply meaningful.  And neither of them affects the answer to your question (1).</p>\n\n<p>You'll also note that neither definition is written in terms of how or where an lvalue can be used.  That <em>follows from</em> the definition and other specifications; it is not a defining characteristic.</p>\n\n<p>In both C and C++, an array's identifier designates an object -- the array -- and it is therefore an lvalue.  Whether such an lvalue may in fact appear as the left operand in an assignment expression is an entirely separate question.</p>\n"}, {"tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": false, "score": 0, "last_activity_date": 1564514614, "last_edit_date": 1592644375, "creation_date": 1564514614, "answer_id": 57278759, "question_id": 57275845, "link": "https://stackoverflow.com/questions/57275845/is-the-meaning-of-l-value-different-in-c-and-c/57278759#57278759", "title": "Is the meaning of l-value different in c and c++?", "body": "<p>In the context of C:</p>\n<blockquote>\n<strong>6.3.2.1 Lvalues, arrays, and function designators</strong><br><br>\n1 An <em>lvalue</em> is an expression (with an object type other than <code><strong>void</strong></code>) that potentially\ndesignates an object;<sup>64)</sup> if an lvalue does not designate an object when it is evaluated, the\nbehavior is undefined. When an object is said to have a particular type, the type is\nspecified by the lvalue used to designate the object. A <em>modifiable lvalue</em> is an lvalue that\ndoes not have array type, does not have an incomplete type, does not have a const-qualified type, and if it is a structure or union, does not have any member (including,\nrecursively, any member or element of all contained aggregates or unions) with a const-qualified type.<br><br>\n2 Except when it is the operand of the <strong><code>sizeof</code></strong> operator, the <strong><code>_Alignof</code></strong> operator, the\nunary <strong><code>&</code></strong> operator, the <strong><code>++</code></strong> operator, the <strong><code>--</code></strong> operator, or the left operand of the <strong><code>.</code></strong> operator\nor an assignment operator, an lvalue that does not have array type is converted to the\nvalue stored in the designated object (and is no longer an lvalue); this is called <em>lvalue\nconversion</em>. If the lvalue has qualified type, the value has the unqualified version of the\ntype of the lvalue; additionally, if the lvalue has atomic type, the value has the non-atomic\nversion of the type of the lvalue; otherwise, the value has the type of the lvalue. If the\nlvalue has an incomplete type and does not have array type, the behavior is undefined. If\nthe lvalue designates an object of automatic storage duration that could have been\ndeclared with the <strong><code>register</code></strong> storage class (never had its address taken), and that object\nis uninitialized (not declared with an initializer and no assignment to it has been\nperformed prior to use), the behavior is undefined.<br><br>\n3 Except when it is the operand of the <strong><code>sizeof</code></strong> operator, the <strong><code>_Alignof</code></strong> operator, or the\nunary <strong><code>&</code></strong> operator, or is a string literal used to initialize an array, an expression that has\ntype \u2018\u2018array of <em>type</em>\u2019\u2019 is converted to an expression with type \u2018\u2018pointer to <em>type</em>\u2019\u2019 that points\nto the initial element of the array object and is not an lvalue. If the array object has\n<strong><code>register</code></strong> storage class, the behavior is undefined.\n<hr>\n<sup>64) The name \u2018\u2018lvalue\u2019\u2019 comes originally from the assignment expression <strong><code>E1 = E2</code></strong>, in which the left\noperand <strong><code>E1</code></strong> is required to be a (modifiable) lvalue. It is perhaps better considered as representing an\nobject \u2018\u2018locator value\u2019\u2019. What is sometimes called \u2018\u2018rvalue\u2019\u2019 is in this International Standard described\nas the \u2018\u2018value of an expression\u2019\u2019.<br><br>\nAn obvious example of an lvalue is an identifier of an object. As a further example, if <strong><code>E</code></strong> is a unary\nexpression that is a pointer to an object, <strong><code>*E</code></strong> is an lvalue that designates the object to which <strong><code>E</code></strong> points.</sup>\n</blockquote>\n<p><sup><em><a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf\" rel=\"nofollow noreferrer\">C 2011 Online Draft</a></em></sup></p>\n<p>Summarizing:</p>\n<p>An array <em>expression</em> (that is, any expression of array type) is indeed an lvalue; however, unless it is the operand of the <code>sizeof</code>, <code>_Alignof</code>, or unary <code>&amp;</code> operators, that expression gets converted (&quot;decays&quot;) to an expression of pointer type whose value is the address of the first element of the array, and that converted pointer expression is <em>not</em> an lvalue, and thus cannot be the target of an assignment.</p>\n<p>That is, if you declare <code>a</code> as</p>\n<pre><code>T a[N]; // for any type `T`\n</code></pre>\n<p>then the <em>expression</em> <code>a</code> has type &quot;N-element array of <code>T</code>&quot;.  If <code>a</code> is not the operand of the <code>sizeof</code>, unary <code>&amp;</code>, or <code>_Alignof</code> operators, it will be converted to an expression of type &quot;pointer to <code>T</code>&quot;, and its value will be the same as <code>&amp;a[0]</code>, and that value cannot be the target of an assignment (it's logically the same as writing <code>2 = 3</code> - you're trying to assign a value to a value, not an object, which doesn't work).</p>\n"}], "owner": {"reputation": 43, "user_id": 10584779, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-8OFhzRwTnEw/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbA2jQCXgkYEf1vYdghU45ySO70-3Q/mo/photo.jpg?sz=128", "display_name": "\uc774\uc2b9\ud6c8", "link": "https://stackoverflow.com/users/10584779/%ec%9d%b4%ec%8a%b9%ed%9b%88"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 139, "favorite_count": 1, "accepted_answer_id": 57277375, "answer_count": 2, "score": 0, "last_activity_date": 1564514614, "creation_date": 1564502931, "question_id": 57275845, "link": "https://stackoverflow.com/questions/57275845/is-the-meaning-of-l-value-different-in-c-and-c", "title": "Is the meaning of l-value different in c and c++?", "body": "<p>I was told that the array name is an non-modifiable l-value in C, but it is still confusing.</p>\n\n<p>Someone said that the array name can not be placed on the left side of the formula because it is converted to a pointer that is not l-value.</p>\n\n<p>My question is Here:</p>\n\n<ol>\n<li>is an array name l-value?</li>\n<li>Is there any difference between what means l-value in c and c++?</li>\n</ol>\n"}, {"tags": ["c", "unix"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1564502537, "post_id": 57275664, "comment_id": 101049304, "body": "You are right, it can&#39;t work. Is there the <i>actual</i> source code somewhere which can be compiled?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1564513412, "post_id": 57275664, "comment_id": 101053537, "body": "Version 6 Unix\u2122?  Talk about &quot;old&quot; \u2014 that predates 1978 (circa 1976).  C was a very different language back then.  The function definition line <code>getfs(dev)</code> is equivalent to <code>int getfs(int dev)</code>.   The <code>panic()</code> call won&#39;t return.  And it may have been from the era when structure members were in a single namespace across all structure types, rather than a separate namespace per structure type.  And dereferencing a pointer was fine as long as it was a pointer."}, {"owner": {"reputation": 38, "user_id": 11820145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b0caf2ad4c724478dcc3f1a0175ebbf?s=128&d=identicon&r=PG&f=1", "display_name": "b0kiii", "link": "https://stackoverflow.com/users/11820145/b0kiii"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1564513528, "post_id": 57275664, "comment_id": 101053580, "body": "@EugeneSh. I couldn&#39;t find one., but I&#39;m looking forward to seeing it."}, {"owner": {"reputation": 38, "user_id": 11820145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b0caf2ad4c724478dcc3f1a0175ebbf?s=128&d=identicon&r=PG&f=1", "display_name": "b0kiii", "link": "https://stackoverflow.com/users/11820145/b0kiii"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1564517647, "post_id": 57275664, "comment_id": 101055300, "body": "@JonathanLeffler Thank you. I didn&#39;t know that. It was helpful. What do you think should I do? Is there any version of UNIX implemented with more modern C or it is a complete waste of time?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1564517986, "post_id": 57275664, "comment_id": 101055453, "body": "If you want to learn about the Unix kernel, you&#39;d probably do better using a later version than V6 \u2014 you can find later versions (such as V7) on <a href=\"https://minnie.tuhs.org/cgi-bin/utree.pl\" rel=\"nofollow noreferrer\">minnie.tuhs.org/cgi-bin/utree.pl</a>, for example.  V7 Unix (what I started on, more or less) dates from 1978.  It uses a more modern version of C, one which was less lax about structure types, etc.  It is still K&amp;R C (standard C was still a decade in the future), but hews closely to K&amp;R 1st Edn (1978).  Any more recent version of Unix will be correspondingly closer to using standard C \u2014 it will be easier to understand (but still not easy)."}, {"owner": {"reputation": 38, "user_id": 11820145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b0caf2ad4c724478dcc3f1a0175ebbf?s=128&d=identicon&r=PG&f=1", "display_name": "b0kiii", "link": "https://stackoverflow.com/users/11820145/b0kiii"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1564518624, "post_id": 57275664, "comment_id": 101055668, "body": "@JonathanLeffler Thank you! Your information was very helpful."}, {"owner": {"reputation": 1079, "user_id": 1884351, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/0ccc73c4be038f1bb08243adc61f5550?s=128&d=identicon&r=PG&f=1", "display_name": "fnisi", "link": "https://stackoverflow.com/users/1884351/fnisi"}, "edited": false, "score": 0, "creation_date": 1564529447, "post_id": 57275664, "comment_id": 101058714, "body": "Studying the kernel of one of the BSD variants would be another option. They are modern and not as bloated as the Linux kernel. Exploring the FreeBSD kernel and keeping a reference book like &quot;Design and Implementation of the FreeBSD Operating System&quot; aside would make the task easier."}], "owner": {"reputation": 38, "user_id": 11820145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b0caf2ad4c724478dcc3f1a0175ebbf?s=128&d=identicon&r=PG&f=1", "display_name": "b0kiii", "link": "https://stackoverflow.com/users/11820145/b0kiii"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1564502254, "creation_date": 1564502254, "question_id": 57275664, "link": "https://stackoverflow.com/questions/57275664/unix-getfsdev", "title": "UNIX getfs(dev)", "body": "<p>I'm currently exploring the UNIX source code and I have trouble understanding a lot of it.  </p>\n\n<pre><code>getfs(dev)\n{\n    register struct mount *p;\n    register char *n1, *n2;\n\n    for(p = &amp;mount[0]; p &lt; &amp;mount[NMOUNT]; p++)\n    if(p-&gt;m_bufp != NULL &amp;&amp; p-&gt;m_dev == dev) {\n        p = p-&gt;m_bufp-&gt;b_addr;\n        n1 = p-&gt;s_nfree;\n        n2 = p-&gt;s_ninode;\n        if(n1 &gt; 100 || n2 &gt; 100) {\n            prdev(\"bad count\", dev);\n            p-&gt;s_nfree = 0;\n            p-&gt;s_ninode = 0;\n        }\n        return(p);\n    }\n    panic(\"no fs\");\n}\n</code></pre>\n\n<p>On the first line after the if statement, we try to access <code>p-&gt;m_bufp-&gt;b_addr</code>. How could possibly this happen, when <code>p-&gt;m_bufp</code> is an <code>int *</code>. And after that, we even assign all that to a variable with type <code>struct mount *</code>. </p>\n\n<p>Can somebody explain what am I missing? <a href=\"http://www.v6.cuzuco.com/v6.pdf\" rel=\"nofollow noreferrer\">This</a> is a link to the full source code.</p>\n\n<p>Thank you in advance! Have a nice day.</p>\n"}, {"tags": ["php", "c", "php-internals"], "comments": [{"owner": {"reputation": 51399, "user_id": 1553888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01ac05cf8db6f338aef3c2f65e348f5d?s=128&d=identicon&r=PG", "display_name": "u_mulder", "link": "https://stackoverflow.com/users/1553888/u-mulder"}, "edited": false, "score": 0, "creation_date": 1564502963, "post_id": 57275561, "comment_id": 101049516, "body": "Question, do you have it?"}, {"owner": {"reputation": 111, "user_id": 8682036, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XxHbR.jpg?s=128&g=1", "display_name": "Evgeniy Kapelko", "link": "https://stackoverflow.com/users/8682036/evgeniy-kapelko"}, "reply_to_user": {"reputation": 51399, "user_id": 1553888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01ac05cf8db6f338aef3c2f65e348f5d?s=128&d=identicon&r=PG", "display_name": "u_mulder", "link": "https://stackoverflow.com/users/1553888/u-mulder"}, "edited": false, "score": 0, "creation_date": 1564509403, "post_id": 57275561, "comment_id": 101051678, "body": "Yes, where is this exception thrown?"}], "owner": {"reputation": 111, "user_id": 8682036, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XxHbR.jpg?s=128&g=1", "display_name": "Evgeniy Kapelko", "link": "https://stackoverflow.com/users/8682036/evgeniy-kapelko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1564502156, "creation_date": 1564501911, "last_edit_date": 1564502156, "question_id": 57275561, "link": "https://stackoverflow.com/questions/57275561/php-api-reflection", "title": "PHP API Reflection", "body": "<p>I want to find where such messages are generated at a low level.</p>\n\n<pre><code>Uncaught TypeError: Argument 1 passed to A::__construct() must be an instance of B\n</code></pre>\n\n<p>I downloaded the source PHP 7. And tried to find the formation of an error pattern \"must be an instance\"</p>\n\n<p>Me interests where arguments of the __construct  parsed in php.</p>\n"}, {"tags": ["c", "cs50"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1564502287, "post_id": 57275525, "comment_id": 101049192, "body": "<a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">How to debug small programs</a>"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1564502463, "post_id": 57275525, "comment_id": 101049268, "body": "Watch for the <b>scope</b> of variables! Can you see where you are using <a href=\"https://stackoverflow.com/questions/618769/how-can-i-access-a-shadowed-global-variable-in-c\">shadow variables</a>?"}], "answers": [{"tags": [], "owner": {"reputation": 4475, "user_id": 5577076, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qG4gB.png?s=128&g=1", "display_name": "DinoCoderSaurus", "link": "https://stackoverflow.com/users/5577076/dinocodersaurus"}, "is_accepted": false, "score": 0, "last_activity_date": 1564510800, "creation_date": 1564510800, "answer_id": 57277836, "question_id": 57275525, "link": "https://stackoverflow.com/questions/57275525/mario-problem-set-why-wont-the-hashes-print/57277836#57277836", "title": "Mario problem set - why won&#39;t the hashes print?", "body": "<p>Assume you are using CS50 Lab and <code>make</code> to compile. This program will <em>not</em> compile because of shadow variables (as mentioned in the comments by @Weather Vane), and other errors. Therefore, I assume the executable that's running (i.e. <code>./mario</code>) was the last good compile of an older version of the source that did not print results.</p>\n\n<p>The <code>for</code> loop in this code is an infinite loop. If you correct the compile errors, you will see nothing but <code>#</code>.</p>\n\n<p>Recommend you delete the \"old\" compiled version (<code>rm mario</code> in the terminal) and then modify the code so 1) it compiles and 2) does not create an infinite loop.</p>\n\n<p>Remember, you <em>declare</em> a variable including the type, as here: <code>int height;</code>. But when you <em>use</em> the variable (as here <code>int height = get_int(\"height: \");</code>) you do not use the type declaration.  </p>\n"}, {"tags": [], "owner": {"reputation": 264, "user_id": 8228063, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IXfbv.jpg?s=128&g=1", "display_name": "Sarthak", "link": "https://stackoverflow.com/users/8228063/sarthak"}, "is_accepted": false, "score": 0, "last_activity_date": 1564512689, "creation_date": 1564512689, "answer_id": 57278308, "question_id": 57275525, "link": "https://stackoverflow.com/questions/57275525/mario-problem-set-why-wont-the-hashes-print/57278308#57278308", "title": "Mario problem set - why won&#39;t the hashes print?", "body": "<p><strong>try this code, hope it helps</strong></p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;cs50.h&gt;\n int main(void){\n\n\nint height ;\ndo\n{printf(\"height: \");\n    height = get_int();\n}\nwhile(height&lt;0 || height&gt;23);\n\nfor(int i=1;i&lt;height+1;i++)\n{\n\n    for(int j=0;j&lt;height-i;j++)\n    {\n        printf(\"%s\",\" \");\n    }\n    for(int l=0;l&lt;1;l++)\n    {\n        printf(\"#\");\n    }\nfor(int k=0;k&lt;i;k++)\n{\n    printf(\"#\");\n\n\n}\n\nprintf(\"\\n\");\n\n\n}\n}\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 11828243, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3aeb36952e253b9b796d03fff50a0cf?s=128&d=identicon&r=PG&f=1", "display_name": "redautumnleaves", "link": "https://stackoverflow.com/users/11828243/redautumnleaves"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 119, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1564512689, "creation_date": 1564501752, "question_id": 57275525, "link": "https://stackoverflow.com/questions/57275525/mario-problem-set-why-wont-the-hashes-print", "title": "Mario problem set - why won&#39;t the hashes print?", "body": "<p>I am currently trying to print a pyramid of hashes for the Mario problem set (less comfortable), and they won't print. Would someone be able to look at my code and pinpoint where I am going wrong? Thank you so much in advance. </p>\n\n<pre><code>#include &lt;cs50.h&gt;\n#include &lt;stdio.h&gt;\n\nint main(void)\n{\nint height;\nint hashes;\nint space;\n\ndo \n{\n    int height = get_int(\"height: \");\n}\nwhile (height &lt; 0 || height &gt; 5);\n{\n    for (int i = 0; i &lt; height; i++)\n    {\n        int hashes = i;\n        for (hashes = (i + 1); hashes &gt;= height; hashes++)\n        {\n            printf(\"#\");\n        }\n    }\n\n  }\n\n\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "pointers", "char", "integer"], "comments": [{"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 3, "creation_date": 1564500040, "post_id": 57274987, "comment_id": 101048006, "body": "This loop     while (stt[w] != &#39;\\n&#39;)         w++; does not make sense because the variable w is not used anywhere."}, {"owner": {"reputation": 78, "user_id": 9549401, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FjUGk.png?s=128&g=1", "display_name": "ZozeR", "link": "https://stackoverflow.com/users/9549401/zozer"}, "reply_to_user": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1564501527, "post_id": 57274987, "comment_id": 101048811, "body": "i had an typo, it looks good now."}], "answers": [{"tags": [], "owner": {"reputation": 289, "user_id": 9108344, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-shxPr-h8zN4/AAAAAAAAAAI/AAAAAAAAACs/xr9Ipc08J_k/photo.jpg?sz=128", "display_name": "Midnight Exigent", "link": "https://stackoverflow.com/users/9108344/midnight-exigent"}, "is_accepted": true, "score": 0, "last_activity_date": 1564502260, "last_edit_date": 1564502260, "creation_date": 1564500947, "answer_id": 57275317, "question_id": 57274987, "link": "https://stackoverflow.com/questions/57274987/how-to-convert-1d-char-to-2d-int-array-and-pass-it-int-c/57275317#57275317", "title": "How to convert 1D char to 2D int array and pass it int C?", "body": "<p>Try this :</p>\n\n<pre><code>char array1D[50];\nint height = 10;\nint width = 50/10;\nint** array2D = (int**)malloc(sizeof(int*)*height); //Allocate the rows for the new array\nfor(int i = 0; i &lt; height; ++i){\n    array2D[i] = (int*)malloc(sizeof(int)*width);  //For each row, allocate columns\n    for(int j = 0; j &lt; width; ++j){\n        array2D[i][j] = convert(array1D[j + width*i]); //convert the character to an integer \n    }\n}\n</code></pre>\n\n<p>For more information, see : how to <a href=\"https://stackoverflow.com/questions/2151084/map-a-2d-array-onto-a-1d-array\">Map a 2D array onto a 1D array</a> : </p>\n"}, {"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 1, "last_activity_date": 1564503648, "creation_date": 1564503648, "answer_id": 57276019, "question_id": 57274987, "link": "https://stackoverflow.com/questions/57274987/how-to-convert-1d-char-to-2d-int-array-and-pass-it-int-c/57276019#57276019", "title": "How to convert 1D char to 2D int array and pass it int C?", "body": "<p>What you mean is the following.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nvoid ft_test( const char *s, size_t rows, size_t cols )\n{\n    unsigned int a[rows][cols];\n    memset( a, 0, sizeof( a ) );\n\n    for ( size_t i = 0, j = 0; *s != '\\0'; ++s )\n    {\n        if ( *s == '\\n' )\n        {\n            j = 0;\n            ++i;\n        }\n        else \n        {\n            if ( *s == '.' ) a[i][j] = 1;\n            ++j;\n        }\n    }\n\n    for ( size_t i = 0; i &lt; rows; i++ )\n    {\n        for ( size_t j = 0; j &lt; cols; j++ )\n        {\n            printf( \"%u\", a[i][j] );\n        }\n        putchar( '\\n' );\n    }                \n}\n\nint main( void )  \n{\n    char s[] = \".o.o...o\\n........\\n...o..o.\\n\";\n\n    size_t rows = 0, cols = 0;\n\n    for ( char *p = s, *q = s; *p; q = p )\n    {\n        size_t n;\n\n        ++rows;\n\n        p = strchr( q, '\\n' );\n\n        if ( p == NULL ) n = strlen( q );\n        else n = p - q;\n\n        if ( cols &lt; n ) cols = n;\n\n        p = q + n + 1;\n    }\n\n    ft_test( s, rows, cols );\n}     \n</code></pre>\n\n<p>The program output is</p>\n\n<pre><code>10101110\n11111111\n11101101\n</code></pre>\n"}], "owner": {"reputation": 78, "user_id": 9549401, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FjUGk.png?s=128&g=1", "display_name": "ZozeR", "link": "https://stackoverflow.com/users/9549401/zozer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 57275317, "answer_count": 2, "score": -1, "last_activity_date": 1564503648, "creation_date": 1564499820, "last_edit_date": 1564501498, "question_id": 57274987, "link": "https://stackoverflow.com/questions/57274987/how-to-convert-1d-char-to-2d-int-array-and-pass-it-int-c", "title": "How to convert 1D char to 2D int array and pass it int C?", "body": "<p>For my school project i have to convert 1D char array to 2D int array and i have to send this array to another functions to work on it. but for some reason i cant create the 2D int array correctly or pass it to another functions. i need to pass the whole array! do i need to use malloc or pointers?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n    void ft_test(char *str,int w,int h)\n\n{\n    int ct = 0, ct2 = 0, i = 0, j = 0;\n    int stt[w][h];\n\n    //this converts the chars to integers and puts it inside stt arrray\n    while(str[ct])\n    {\n        if (str[ct] == '\\n')\n        {\n            j = 0;\n            i++;\n        }\n        if (str[ct] == '.')\n        {\n            stt[i][j] = 1;\n            j++;\n        }\n        else if (str[ct] == 'o')\n         {\n            stt[i][j] = 0;\n            j++;\n         }\n        ct++;\n    }\n\n    /*this is just to display the array but somehow there are errors in the displayed\n    matrix, some places needs to be 0 but displayed as 1. if you display the matrix\n    in the while before this, it works. but in this while it doesnt*/\n    ct = 0;\n    while (ct &lt; h)\n    {\n        ct2 = 0;\n        while (ct2 &lt; w)\n        {\n            printf(\"%d\",stt[ct][ct2]);\n            ct2++;\n        }\n        printf(\"\\n\");\n        ct++;\n    }\n}\n\nint main()\n{\n    int w = 0, ct = 0, h = 0;\n    char stt[] = \".o.o...o\\n........\\n...o..o.\\n\";\n\n    //counting width &amp; height while displaying it like a matrix\n    while (stt[w] != '\\n')\n        w++;\n    while (stt[ct] != '\\0')\n    {\n        if (stt[ct] == '\\n')\n            h++;\n        printf(\"%c\",stt[ct]);\n        ct++;\n    }\n    printf(\"\\n\");\n    ft_test(stt,w,h);\n    return 0;\n}\n</code></pre>\n\n<p>i dont get any errors. but the int array's some variables are incorrect. what am i missing?</p>\n\n<blockquote>\n  <p>instead of giving -1 vote why not describe what is wrong with my\n  question so that i can improve it?</p>\n</blockquote>\n"}, {"tags": ["c", "azure", "azure-blob-storage"], "answers": [{"comments": [{"owner": {"reputation": 2236, "user_id": 11384392, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j5bfH.jpg?s=128&g=1", "display_name": "Das_Geek", "link": "https://stackoverflow.com/users/11384392/das-geek"}, "edited": false, "score": 1, "creation_date": 1572280039, "post_id": 58594719, "comment_id": 103502355, "body": "This does not provide an answer to the question. You can <a href=\"//stackoverflow.com/search\">search for similar questions</a>, or refer to the related and linked questions on the right-hand side of the page to find an answer. If you have a related but different question, <a href=\"//stackoverflow.com/questions/ask\">ask a new question</a>, and include a link to this one to help provide context. See: <a href=\"//stackoverflow.com/tour\">Ask questions, get answers, no distractions</a>"}], "tags": [], "owner": {"reputation": 151, "user_id": 10200247, "user_type": "registered", "profile_image": "https://graph.facebook.com/750355266/picture?type=large", "display_name": "Fr&#233;d&#233;ric Thibault", "link": "https://stackoverflow.com/users/10200247/fr%c3%a9d%c3%a9ric-thibault"}, "is_accepted": false, "score": -2, "last_activity_date": 1572288713, "last_edit_date": 1572288713, "creation_date": 1572279888, "answer_id": 58594719, "question_id": 57274523, "link": "https://stackoverflow.com/questions/57274523/azure-iot-hub-c-client-upload-to-blob-fails-with-x-509-authentication/58594719#58594719", "title": "Azure Iot Hub C Client Upload to Blob Fails with X.509 Authentication", "body": "<p>I have had the exact same problem. I can do everything, but not upload a file when using x509. </p>\n\n<p>However, If I create a device using sas token and connect using <code>IoTHubClient_LL_CreateFromConnectionString</code> instead of <code>IoTHubDeviceClient_LL_CreateFromDeviceAuth</code>, it works.</p>\n"}], "owner": {"reputation": 1, "user_id": 10993063, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4bAeWGKeLy8/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQNI-ZsKxTcxm3i2R6j-1d1ooRoTLQ/mo/photo.jpg?sz=128", "display_name": "Anthony", "link": "https://stackoverflow.com/users/10993063/anthony"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 115, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1572288713, "creation_date": 1564498343, "last_edit_date": 1564561246, "question_id": 57274523, "link": "https://stackoverflow.com/questions/57274523/azure-iot-hub-c-client-upload-to-blob-fails-with-x-509-authentication", "title": "Azure Iot Hub C Client Upload to Blob Fails with X.509 Authentication", "body": "<p>I am using the Azure Iot Hub C SDK with the TI SimpleLink module to connect to an Azure IoT Hub using X.509 authentication. The authentication works for messaging and device twins but fails when I attempt an upload a file to blob storage. If I use symmetric key authentication, the file upload works as expected.</p>\n\n<p>Is file upload with X.509 authentication a supported feature of the Azure IoT SDK for C and the TI SimpleLink implementation?</p>\n\n<p>I know that the C# SDK does not have this problem but there could be differences in an implementation on a PC vs an implementation on a microcontroller. I also saw that there is not support for the Java SDK.\n<a href=\"https://github.com/Azure/azure-iot-sdk-java/issues/371\" rel=\"nofollow noreferrer\">https://github.com/Azure/azure-iot-sdk-java/issues/371</a></p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 3, "creation_date": 1564496793, "post_id": 57273995, "comment_id": 101045984, "body": "When I see a title like this I think &quot;null-termination&quot;."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1564496940, "post_id": 57273995, "comment_id": 101046081, "body": "And missing null-termination is exactly the reason here. You have to remember that <code>char</code> strings in C are really called <b><i>null-terminated</b> byte strings</i>."}], "owner": {"reputation": 1, "user_id": 11814352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04bc2f3719199332e514f694bf331edd?s=128&d=identicon&r=PG&f=1", "display_name": "rozella", "link": "https://stackoverflow.com/users/11814352/rozella"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "closed_date": 1564496873, "answer_count": 0, "score": 0, "last_activity_date": 1564496758, "creation_date": 1564496758, "question_id": 57273995, "link": "https://stackoverflow.com/questions/57273995/there-is-some-unknown-characters-at-last-of-my-char-array", "closed_reason": "Duplicate", "title": "&quot;There is some unknown characters at last of my char array&quot;", "body": "<p>I'm trying to code my own \"integer to string conversion program\" on c. I kind of managed to convert even if a long long integer using x64 compiler. But when I printed out my converted string, I see some unknown character at the last of it.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n//this method converts a 64-bit signed integer to a char array(i mean a \nstring).\n//(I'm using x64 compiler)\nchar* convert_ll(long long const *a) {\n    long long b = a;\n    short length = 0;\n    while (b &gt; 0) {\n        b /= 10;\n        length++;\n    }\n    char* converted = malloc(length * sizeof(char));\n    b = a; int i = 0; int c;\n    while (b &gt; 0) {\n        converted[i++] = (b % 10) + '0';\n        b /= 10;\n    }\n    return converted;\n}\n\nint main() {\n    long long aa = 12345678967889;\n    char* ptr = convert_ll(aa);\n    printf(ptr);\n    free(ptr);\n    return 0;\n}\n</code></pre>\n\n<p>this is what I want to see --> \"98876987654321\"\nbut the result is this --> \"98876987654321\u00b2\u00b2\u00b2\u00b2\"</p>\n"}, {"tags": ["c", "function", "parameters", "declaration", "definition"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 3, "creation_date": 1564496004, "post_id": 57273744, "comment_id": 101045467, "body": "Because <code>fputc</code> couldn&#39;t change <code>c</code> for outside of it even if it really wanted to."}], "answers": [{"comments": [{"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 1, "creation_date": 1564497237, "post_id": 57273799, "comment_id": 101046277, "body": "Putting <code>const</code> in <code>int fputc(int c, FILE *stream);</code> would not prevent <code>fputc</code> from modifying its copy of <code>c</code>. <code>const</code> in declarations that are not definitions has no effect."}, {"owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1564498056, "post_id": 57273799, "comment_id": 101046815, "body": "@EricPostpischil: I assume you mean that the definition of <code>fputc</code> is what would determine if it is <code>const</code> or not, not merely the prototype declaration? Because it will definitely complain if you define a function taking <code>const int c</code> and try to modify <code>c</code> within it (e.g. gcc dies with <code>error: assignment of read-only parameter \u2018c\u2019</code>)."}], "tags": [], "owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "is_accepted": false, "score": 0, "last_activity_date": 1564496079, "creation_date": 1564496079, "answer_id": 57273799, "question_id": 57273744, "link": "https://stackoverflow.com/questions/57273744/why-does-fputs-require-a-constant-as-first-parameter-and-not-fputc/57273799#57273799", "title": "Why does fputs() require a constant as first parameter and not fputc()?", "body": "<p>There is no need to make the first parameter <code>const</code>; the \"top level\" of arguments are copied, not referenced, so all <code>const</code> would do is prevent the called function from modifying its own copy of the argument.</p>\n\n<p>Similarly, note that only the values being pointed to are <code>const</code> for <code>fputs</code>; the parameter isn't <code>const char *const s</code> because the extra const-ness would only limit the callee's ability to modify where its copy of the pointer points to; the <code>const</code> guarantee is only applied to the (shared) values being pointed to.</p>\n"}, {"tags": [], "owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "is_accepted": false, "score": 7, "last_activity_date": 1564496086, "creation_date": 1564496086, "answer_id": 57273801, "question_id": 57273744, "link": "https://stackoverflow.com/questions/57273744/why-does-fputs-require-a-constant-as-first-parameter-and-not-fputc/57273801#57273801", "title": "Why does fputs() require a constant as first parameter and not fputc()?", "body": "<p>There's no point in marking parameters as <code>const</code> in a function declaration. Arguments are passed by value, so the parameter is a copy anyway. It doesn't affect how the function can be called.</p>\n\n<p>However, <code>const char *s</code> does not mean <code>s</code> is <code>const</code>. What this declaration means is that <code>s</code> is a pointer to a <code>const char</code>; i.e. the <code>fputs</code> function promises not to write through the pointer it is given. Also, there is an implicit conversion from <code>char *</code> to <code>const char *</code> (but not vice versa), meaning that <code>fputs</code> can be called with both read-only and writeable strings.</p>\n"}, {"comments": [{"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1564497087, "post_id": 57273832, "comment_id": 101046182, "body": "A <code>const</code> modifier to a parameter (the actual parameter, not a subcomponent, <i>e.g.</i>, <code>char * const s</code>, not <code>const char *s</code>) in a function declaration that is not a definition has no effect; it does not prevent the function from changing the parameter. (The argument cannot be changed [directly], of course, since it is passed by value. But functions can change their parameters unless they are defined with <code>const</code>.)"}], "tags": [], "owner": {"reputation": 3525, "user_id": 10927863, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYbxO.jpg?s=128&g=1", "display_name": "Eliahu Aaron", "link": "https://stackoverflow.com/users/10927863/eliahu-aaron"}, "is_accepted": true, "score": 2, "last_activity_date": 1564563961, "last_edit_date": 1564563961, "creation_date": 1564496208, "answer_id": 57273832, "question_id": 57273744, "link": "https://stackoverflow.com/questions/57273744/why-does-fputs-require-a-constant-as-first-parameter-and-not-fputc/57273832#57273832", "title": "Why does fputs() require a constant as first parameter and not fputc()?", "body": "<p>The <code>const</code> modifier prevents the function from changing the input parameter.</p>\n\n<p><code>fputc</code> function uses <code>int c</code> as input which is a value type. Because parameters are passed by value, the function can only change the internal copy, it could not change the original value.</p>\n\n<p><code>fputs</code> function uses <code>char *s</code> as input which is a pointer type, so the pointed memory could be changed by the function. The <code>const</code> modifier protects the pointed memory by preventing the function from changing it.</p>\n\n<p><strong>Note 1:</strong> The <code>const</code> modifier in function <code>fputs</code> is on the <code>char</code> type (<code>const char *s</code>), which means the pointed memory cannot be changed. If the <code>const</code> was on the input parameter <code>s</code> (<code>char * const s</code>), it would not protect the pointed memory, it would only protect the pointer itself which is anyway passed by value.</p>\n\n<p><strong>Note 2:</strong> As mentioned by <a href=\"https://stackoverflow.com/users/298225/eric-postpischil\">Eric Postpischil</a> in the comment and shown in <a href=\"https://stackoverflow.com/users/2877241/vlad-from-moscow\">Vlad from Moscow</a>'s <a href=\"https://stackoverflow.com/a/57273894/10927863\">answer</a>, if the const modifier is in the functions declaration and not in the functions definition, it has no effect.</p>\n"}, {"tags": [], "owner": {"reputation": 45031, "user_id": 213136, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b84a36c241e04175fcec402dac43018?s=128&d=identicon&r=PG", "display_name": "Bob Jarvis - Reinstate Monica", "link": "https://stackoverflow.com/users/213136/bob-jarvis-reinstate-monica"}, "is_accepted": false, "score": 0, "last_activity_date": 1564496283, "creation_date": 1564496283, "answer_id": 57273858, "question_id": 57273744, "link": "https://stackoverflow.com/questions/57273744/why-does-fputs-require-a-constant-as-first-parameter-and-not-fputc/57273858#57273858", "title": "Why does fputs() require a constant as first parameter and not fputc()?", "body": "<p><code>const char *s</code> doesn't mean that <code>s</code> must point to a constant. It means that <code>fputs</code> is not allowed to modify what is pointed to by <code>s</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 0, "last_activity_date": 1564497177, "last_edit_date": 1564497177, "creation_date": 1564496393, "answer_id": 57273894, "question_id": 57273744, "link": "https://stackoverflow.com/questions/57273744/why-does-fputs-require-a-constant-as-first-parameter-and-not-fputc/57273894#57273894", "title": "Why does fputs() require a constant as first parameter and not fputc()?", "body": "<p>When the compiler determines a function type then high level qualifiers of parameters are discarded.</p>\n\n<p>So these two function declarations</p>\n\n<pre><code>int fputc(int c, FILE *stream);\nint fputc( const int c, FILE *stream);\n</code></pre>\n\n<p>declare the same one function.</p>\n\n<p>And these two function declarations</p>\n\n<pre><code>int fputs(const char *s, FILE *stream);\nint fputs(const char * const s, FILE *stream);\n</code></pre>\n\n<p>also declare the same one function.</p>\n\n<p>So the high-level qualifier const has a meaning not for the user of the function but only for the internal definition of the function. In any case a corresponding argument is passed by value that is the function deals with a copy of the argument. So whether inside the function the copy will have the qualifier const or will not does not matter for the user of the function.</p>\n\n<p>Consider the following demonstrative program</p>\n\n<pre><code>#include &lt;stdio.h&gt; \n\nvoid f( const int x );\n\nvoid f( int x )\n{\n    x += 10;\n\n    printf( \"Inside the function x = %d\\n\", x );\n}    \n\n\nint main( void )  \n{ \n    int x = 1;\n\n    printf( \"Before calling f x = %d\\n\", x );\n\n    f( x );\n\n    printf( \"After calling f  x = %d\\n\", x );\n}   \n</code></pre>\n\n<p>Its output is</p>\n\n<pre><code>Before calling f x = 1\nInside the function x = 11\nAfter calling f  x = 1  \n</code></pre>\n\n<p>So it does not matter for the user of the function whether the parameter x of the function has the qualifier const. The both declarations declare the same one function from the point of view of the compiler (and the user of the function).</p>\n\n<p>Function parameters are their local variables. And users do not bother whether or not some local variables will be declared within the function with the qualifier const.</p>\n\n<p>Pat attention to that in this declaration</p>\n\n<pre><code>int fputs(const char *s, FILE *stream);\n</code></pre>\n\n<p>it is not the first parameter that is declared as constant. It is data pointed by the pointer that is constant. </p>\n\n<p>But in this declaration</p>\n\n<pre><code>int fputc( const int c, FILE *stream);\n</code></pre>\n\n<p>the parameter itself that is constant.</p>\n"}], "owner": {"reputation": 31, "user_id": 10471775, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6bf7ffa2feb6dfe473d5594ee9a233bb?s=128&d=identicon&r=PG&f=1", "display_name": "user10471775", "link": "https://stackoverflow.com/users/10471775/user10471775"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 194, "favorite_count": 0, "accepted_answer_id": 57273832, "answer_count": 5, "score": 1, "last_activity_date": 1564563961, "creation_date": 1564495909, "last_edit_date": 1564497055, "question_id": 57273744, "link": "https://stackoverflow.com/questions/57273744/why-does-fputs-require-a-constant-as-first-parameter-and-not-fputc", "title": "Why does fputs() require a constant as first parameter and not fputc()?", "body": "<pre class=\"lang-c prettyprint-override\"><code>int fputc(int c, FILE *stream);\n\nint fputs(const char *s, FILE *stream);\n</code></pre>\n\n<p>Why isn't <code>const int c</code> required in fputc()'s declaration?</p>\n"}, {"tags": ["c", "list", "recursion", "reverse", "singly-linked-list"], "comments": [{"owner": {"reputation": 1, "user_id": 11857886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e2bdb7aa5ed1b8f6bc70fcc42cc2b1f?s=128&d=identicon&r=PG&f=1", "display_name": "ThrowawayOfJulyPast", "link": "https://stackoverflow.com/users/11857886/throwawayofjulypast"}, "reply_to_user": {"reputation": 21694, "user_id": 34092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10e78a68c6e32f9b8aeb47a968ebea9f?s=128&d=identicon&r=PG&f=1", "display_name": "mjwills", "link": "https://stackoverflow.com/users/34092/mjwills"}, "edited": false, "score": 0, "creation_date": 1564493100, "post_id": 57272791, "comment_id": 101043485, "body": "@mjwills oh whoops wrong tag"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1564493208, "post_id": 57272791, "comment_id": 101043564, "body": "Time to <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">learn how to debug your program</a>. A quick <a href=\"https://en.wikipedia.org/wiki/Rubber_duck_debugging\" rel=\"nofollow noreferrer\">rubber duck debugging</a> should be enough to find the problem (especially if you indent the code consistently)."}, {"owner": {"reputation": 846, "user_id": 4675426, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/6a40956551f38afd8a2c712b4780d73a?s=128&d=identicon&r=PG", "display_name": "Karthick", "link": "https://stackoverflow.com/users/4675426/karthick"}, "edited": false, "score": 0, "creation_date": 1564493977, "post_id": 57272791, "comment_id": 101044073, "body": "What is the issue you are facing? Post more info about the input being passed and the output of your program"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1564494797, "post_id": 57272791, "comment_id": 101044625, "body": "Your rubber-duck debugging session should help you clarify for yourself the function&#39;s purpose, preconditions, and postconditions, including the significance of the arguments and return value.  Don&#39;t waste that: record those details in a documentation comment associated with the function, even if only for your own future benefit."}, {"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1564495737, "post_id": 57272791, "comment_id": 101045292, "body": "Your code doesn&#39;t include any means to print out anything"}], "answers": [{"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 0, "last_activity_date": 1564495880, "creation_date": 1564495880, "answer_id": 57273735, "question_id": 57272791, "link": "https://stackoverflow.com/questions/57272791/link-list-reverse-recursive-function-not-working/57273735#57273735", "title": "Link List Reverse Recursive Function Not Working", "body": "<p>The function can look the following way</p>\n\n<pre><code>NUMBERLINE * reverse( NUMBERLINE *head ) \n{ \n    if ( head &amp;&amp; head-&gt;next ) \n    { \n        NUMBERLINE *current = head; \n        head = head-&gt;next; \n        head = reverse( head ); \n        current-&gt;next-&gt;next = current; \n        current-&gt;next = NULL; \n    }\n\n    return head;\n} \n</code></pre>\n\n<p>As for your function definition then even this statement</p>\n\n<pre><code>if(curptr-&gt;next == NULL)\n{\n    return curptr;\n}\n</code></pre>\n\n<p>arises the undefined behavior when <code>curptr</code> is equal to <code>NULL</code>.</p>\n"}], "owner": {"reputation": 1, "user_id": 11857886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e2bdb7aa5ed1b8f6bc70fcc42cc2b1f?s=128&d=identicon&r=PG&f=1", "display_name": "ThrowawayOfJulyPast", "link": "https://stackoverflow.com/users/11857886/throwawayofjulypast"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1564496040, "creation_date": 1564492963, "last_edit_date": 1564496040, "question_id": 57272791, "link": "https://stackoverflow.com/questions/57272791/link-list-reverse-recursive-function-not-working", "title": "Link List Reverse Recursive Function Not Working", "body": "<p>I'm unable to workout why my recursive function isn't working. Everytime I run the code the linked list doesn't print in reverse.</p>\n\n<pre><code>typedef struct numberline NUMBERLINE; \nNUMBERLINE * startptr;\nNUMBERLINE * newptr;\nNUMBERLINE * curptr;\n\nNUMBERLINE *revRecursive(NUMBERLINE *curptr)\n{\n\n    NUMBERLINE *q, *head;\n\n    if(curptr-&gt;next == NULL)\n    {\n        return curptr;\n    }\n\n    head = curptr;\n\n    q = curptr = revRecursive(curptr);\n\n    while(q-&gt;next != NULL)\n    {\n        q = q-&gt;next;\n    q-&gt;next = head;\n    head-&gt;next = NULL;\n\n    return curptr;\n    }\n}\n</code></pre>\n\n<p>Maybe I'm using the wrong pointer in the parameter, or I haven't implemented properly I'm unsure.</p>\n"}, {"tags": ["python", "c", "python-3.x", "python-2.7", "embedding"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11856694, "user_type": "registered", "profile_image": "https://graph.facebook.com/157706265397073/picture?type=large", "display_name": "Subhra Bera", "link": "https://stackoverflow.com/users/11856694/subhra-bera"}, "edited": false, "score": 0, "creation_date": 1564634893, "post_id": 57285729, "comment_id": 101097165, "body": "I tried to call by using the above format but still I not getting my desired result. I checked before passing that is pFunc is NULL or not i saw it is not NULL. But if you see my class defination it is going inside of this if block.<code>if(!PyArg_ParseTuple(args, &quot;o&quot;, &amp;str_arr)) {            retun NULL; }</code>."}], "tags": [], "owner": {"reputation": 308, "user_id": 3927579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79c6744b7d14faaaa0cf636601f0aeb5?s=128&d=identicon&r=PG", "display_name": "tbejos", "link": "https://stackoverflow.com/users/3927579/tbejos"}, "is_accepted": false, "score": 0, "last_activity_date": 1564559257, "creation_date": 1564559257, "answer_id": 57285729, "question_id": 57272550, "link": "https://stackoverflow.com/questions/57272550/how-to-call-c-function-which-is-of-type-static-pyobject-inside-c/57285729#57285729", "title": "how to call c function which is of type static pyobject inside c", "body": "<p>Since this appears to be a function and not a method, since it does not belong to a class, you would use <code>NULL</code> for self. So calling the function with something like</p>\n\n<pre><code> string_arr_conversion(NULL, pFunc);\n</code></pre>\n\n<p>is what you are looking for.</p>\n"}], "owner": {"reputation": 1, "user_id": 11856694, "user_type": "registered", "profile_image": "https://graph.facebook.com/157706265397073/picture?type=large", "display_name": "Subhra Bera", "link": "https://stackoverflow.com/users/11856694/subhra-bera"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 155, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1564559257, "creation_date": 1564492296, "last_edit_date": 1564554422, "question_id": 57272550, "link": "https://stackoverflow.com/questions/57272550/how-to-call-c-function-which-is-of-type-static-pyobject-inside-c", "title": "how to call c function which is of type static pyobject inside c", "body": "<p>I want to call a function of static PyObject type which I described inside my c program in the inside of that that c program. How to call this function? What will be the (Pyobject self) argument? I understand that the \"args\" argument will be any module name.</p>\n\n<p>I have tried calling <code>mynewfunction(\"\",Pfunc)</code>. Here my <code>mynewfunction</code> is defined as <code>static PyObject mynewfunction(Pyobject *self, PyObject *args)</code>. \nBut it did not work. How to call this function from inside of C after <code>PyInitialize()</code>? What I will put in place of *self?</p>\n\n<pre><code>#include &lt;Python.h&gt;\n static PyObject *string_arr_conversion(PyObject *self, PyObject args){\n     Pyobject *str_arr;\n     int i;\n     .......\n     .......\n }\n int main(int argc,char *argv[]){\n     ............\n     ............\n     Py_Initialize();\n     .............\n     string_arr_conversion(\"\",pFunc);\n }\n</code></pre>\n\n<p>here I kept the self argument empty. What we need to put in place of self argument? Or how to call this function in c ? </p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 22777, "user_id": 133203, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Fp3hB.jpg?s=128&g=1", "display_name": "Federico klez Culloca", "link": "https://stackoverflow.com/users/133203/federico-klez-culloca"}, "edited": false, "score": 0, "creation_date": 1564491415, "post_id": 57272143, "comment_id": 101042430, "body": "Hello and welcome. What are you trying to do, exactly? Why do you expect that result? Why 5? Please, explain yourself a bit better."}, {"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1564491492, "post_id": 57272143, "comment_id": 101042477, "body": "You are passing <code>char *</code> instead of <code>char **</code> and passing a nonsense <code>argc</code> value."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1564491516, "post_id": 57272143, "comment_id": 101042496, "body": "You are passing a <code>char *</code> to <code>hello</code>, but it is expecting a <code>char **</code>. It&#39;s not surprising it doesn&#39;t work."}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1564491539, "post_id": 57272143, "comment_id": 101042509, "body": "@Sheik In any case the string literal  &quot;i am fine&quot; is one object"}, {"owner": {"reputation": 45685, "user_id": 69809, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yCVF0.jpg?s=128&g=1", "display_name": "Groo", "link": "https://stackoverflow.com/users/69809/groo"}, "edited": false, "score": 0, "creation_date": 1564491556, "post_id": 57272143, "comment_id": 101042520, "body": "<code>&quot;i am fine&quot;</code> is a string literal, i.e. <code>char*</code>, a pointer to the first char in a sequence of chars, terminated by a char with value <code>0</code>. <code>char **argv</code> is an array of such things."}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1564492636, "post_id": 57272143, "comment_id": 101043186, "body": "@Sheik I wonder what are the 5 elements that  the string literal &quot;i am fine&quot; contains?:) Why are you expecting the output i am fine"}, {"owner": {"reputation": 7, "user_id": 11464477, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-lwOMO5L97HY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reDEOMbuRgS1CB33sKRJE-SGzurSQ/mo/photo.jpg?sz=128", "display_name": "Sheik", "link": "https://stackoverflow.com/users/11464477/sheik"}, "edited": false, "score": 0, "creation_date": 1564493358, "post_id": 57272143, "comment_id": 101043663, "body": "sorry Federico for the unclear question..thats 3 and not 5..i don&#39;t know how to edit..thats why i left as it is..."}], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 11464477, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-lwOMO5L97HY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reDEOMbuRgS1CB33sKRJE-SGzurSQ/mo/photo.jpg?sz=128", "display_name": "Sheik", "link": "https://stackoverflow.com/users/11464477/sheik"}, "edited": false, "score": 0, "creation_date": 1564493230, "post_id": 57272404, "comment_id": 101043578, "body": "Thanks a lot Eric..I got what i want actually from your answer..and sorry for the unclear question..."}], "tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": true, "score": 3, "last_activity_date": 1564492114, "last_edit_date": 1564492114, "creation_date": 1564491803, "answer_id": 57272404, "question_id": 57272143, "link": "https://stackoverflow.com/questions/57272143/how-to-pass-string-as-a-function-parameter/57272404#57272404", "title": "how to pass string as a function parameter", "body": "<p>With <code>hello(5,\"i am fine\");</code> in main.c, one of three things should be true:</p>\n\n<ul>\n<li>You compiled without (many) warning messages enabled in your compiler. If so, turn on warning messages in your compiler.</li>\n<li>The compiler warns you that <code>hello</code> is not declared (and perhaps that it assumes a declaration/type for it). If so, insert a declaration of <code>hello</code> in main.c (or put it in a header named hello.h and insert <code>#include &lt;hello.h&gt;</code> in main.c).</li>\n<li>main.c contains code you did not show us in the question, either a declaration of <code>hello</code> or an include of a header file, and the declaration of <code>hello</code> in main.c or the header file differs from its definition in hello.c. If so, show the full code in the question.</li>\n</ul>\n\n<p>Once you fix the problems above, there should be a declaration of <code>hello</code> in main.c (explicitly or included in a header file) that matches its definition in hello.c:</p>\n\n<pre><code>int hello(int argc, char *argv[]);\n</code></pre>\n\n<p>Once that declaration is in main.c, the compiler should warn you that the call <code>hello(5,\"i am fine\");</code> does not match the declaration. This is because <code>\"i am fine\"</code> is an array of characters and, when used in this way, is automatically converted to a pointer to its first element. So the argument passed is a pointer to a <code>char</code>, also called a <code>char *</code>. But the parameter is a <code>char **</code>.</p>\n\n<p>So you need to pass a <code>char **</code>. An easy way to do this is to make an array of <code>char *</code>:</p>\n\n<pre><code>char *Arguments[] = { \"i am fine\" };\n</code></pre>\n\n<p>Then you can pass the array to <code>hello</code>:</p>\n\n<pre><code>hello(1, Arguments);\n</code></pre>\n\n<p>As with the array of <code>char</code>, this array of <code>char *</code> will be automatically converted to a pointer to its first argument, so a <code>char **</code> will be passed.</p>\n\n<p>Also note that I changed <code>5</code> to <code>1</code>. The first argument is the number of strings pointed to by the second argument, and you are passing only one string.</p>\n\n<p>To pass five strings, you should have five strings in the array, and, to match how the arguments to <code>main</code> are specified, there should be an additional element in the array that is a null pointer:</p>\n\n<pre><code>char *Arguments[] = { \"i am fine\", \"two\", \"three\", \"four\", \"five\", 0 };\nhello(5, Arguments);\n</code></pre>\n\n<p>After you have that working, you could use a compound literal instead of a named array. A compound literal is a way of creating an object in an expression, and it uses a type name in parentheses followed by values for the object in braces:</p>\n\n<pre><code>hello(5, (char *[]) { \"i am fine\", \"two\", \"three\", \"four\", \"five\", 0 });\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8833, "user_id": 337149, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3bbd41f2b74254f902cfe20acef9030b?s=128&d=identicon&r=PG", "display_name": "August Karlstrom", "link": "https://stackoverflow.com/users/337149/august-karlstrom"}, "is_accepted": false, "score": 0, "last_activity_date": 1564498866, "last_edit_date": 1564498866, "creation_date": 1564496576, "answer_id": 57273947, "question_id": 57272143, "link": "https://stackoverflow.com/questions/57272143/how-to-pass-string-as-a-function-parameter/57273947#57273947", "title": "how to pass string as a function parameter", "body": "<p>In your code you call function <em>hello</em> with a string instead of an array of strings. Here is a corrected version:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#define LEN(arr) (sizeof (arr) / sizeof (arr)[0])\n\nvoid hello(int argc, const char **argv)\n{\n    int i = 0;\n    printf(\"%d\\n\", argc);\n    for (i = 0; i &lt; argc; i++) {\n        printf(\"%s\\n\", argv[i]);\n    }\n}\n\n\nint main(void)\n{\n    const char *args[] = {\"i\", \"am\", \"fine\"};\n\n    hello(LEN(args), args);\n    return 0;\n}\n</code></pre>\n\n<p>I have also added a <code>const</code> qualifier to indicate that the strings will not be modified.</p>\n"}], "owner": {"reputation": 7, "user_id": 11464477, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-lwOMO5L97HY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reDEOMbuRgS1CB33sKRJE-SGzurSQ/mo/photo.jpg?sz=128", "display_name": "Sheik", "link": "https://stackoverflow.com/users/11464477/sheik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 0, "accepted_answer_id": 57272404, "answer_count": 2, "score": -2, "last_activity_date": 1564498866, "creation_date": 1564491022, "last_edit_date": 1564493560, "question_id": 57272143, "link": "https://stackoverflow.com/questions/57272143/how-to-pass-string-as-a-function-parameter", "title": "how to pass string as a function parameter", "body": "<p>I am trying to create a function that gets arguments similar to command line arguments. To do this I want to pass a string to my function, but I am getting a segmentation fault (core dumped).</p>\n\n<p>Here is my attempt in the function hello shown below,</p>\n\n<pre><code>int hello(int argc, char **argv)                                             \n{                                                                               \n    int i=0;                                                                        \n    printf(\"%d\\n\", argc);                                                                                                                               \n    for(i=0; i&lt;argc; i++)                                                                \n        printf(\"%s\\n\", argv[i]);                                                           \n    return 0;                                                                   \n}  \n</code></pre>\n\n<p>which I call from main,</p>\n\n<pre><code>int main ()                                                 \n{                                                                                                                                          \n    hello(3, \"i am fine\");                             \n    return 0;                                                                       \n}\n</code></pre>\n\n<p>I want to get</p>\n\n<pre><code>i\nam\nfine\n</code></pre>\n\n<p>but getting segmentation fault instead.</p>\n"}, {"tags": ["c", "sockets", "polling"], "comments": [{"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 3, "creation_date": 1564491820, "post_id": 57271852, "comment_id": 101042705, "body": "<i><code>nfds_t</code> -  An <b>unsigned integer type</b> used for the number of file descriptors.</i> Guess what it does with <code>-1</code>:D"}, {"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 1, "creation_date": 1564492433, "post_id": 57271852, "comment_id": 101043056, "body": "You aren&#39;t checking the return code from <code>getaddrinfo</code>"}, {"owner": {"reputation": 2851, "user_id": 2225050, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a2a8b891028237d6b90ac867428f650d?s=128&d=identicon&r=PG", "display_name": "JB_User", "link": "https://stackoverflow.com/users/2225050/jb-user"}, "edited": false, "score": 0, "creation_date": 1564492863, "post_id": 57271852, "comment_id": 101043319, "body": "Yes, I eliminated the return value check to make the code smaller for this discussion."}], "answers": [{"comments": [{"owner": {"reputation": 2851, "user_id": 2225050, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a2a8b891028237d6b90ac867428f650d?s=128&d=identicon&r=PG", "display_name": "JB_User", "link": "https://stackoverflow.com/users/2225050/jb-user"}, "edited": false, "score": 1, "creation_date": 1564492999, "post_id": 57272226, "comment_id": 101043419, "body": "Thank you.  Setting nfds to 1 solved it.  I would not have expected a compiler warning from that...."}], "tags": [], "owner": {"reputation": 158, "user_id": 11842168, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66ad0d8638912244e024a1378e6adf01?s=128&d=identicon&r=PG&f=1", "display_name": "Niklas1", "link": "https://stackoverflow.com/users/11842168/niklas1"}, "is_accepted": true, "score": 5, "last_activity_date": 1564492268, "last_edit_date": 1564492268, "creation_date": 1564491262, "answer_id": 57272226, "question_id": 57271852, "link": "https://stackoverflow.com/questions/57271852/socket-code-fails-when-compiled-with-o-flag/57272226#57272226", "title": "Socket code fails when compiled with -O flag", "body": "<p>From <code>man 2 poll</code>  </p>\n\n<blockquote>\n  <p>int poll(struct pollfd *fds, nfds_t nfds, int timeout);</p>\n  \n  <p>The caller should specify the number of items in the fds array in\n  nfds.</p>\n</blockquote>\n\n<p>So, your <code>poll(&amp;fds, -1, -1)</code> should be <code>poll(&amp;fds, 1, -1)</code></p>\n\n<p>Edit:<br>\nYou also should check the return values of your function calls.<br>\nThey might return a value which indicates an error (mostly <code>-1</code>) and set errno.</p>\n"}], "owner": {"reputation": 2851, "user_id": 2225050, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a2a8b891028237d6b90ac867428f650d?s=128&d=identicon&r=PG", "display_name": "JB_User", "link": "https://stackoverflow.com/users/2225050/jb-user"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 57272226, "answer_count": 1, "score": 0, "last_activity_date": 1564492268, "creation_date": 1564490165, "question_id": 57271852, "link": "https://stackoverflow.com/questions/57271852/socket-code-fails-when-compiled-with-o-flag", "title": "Socket code fails when compiled with -O flag", "body": "<p>I'm on Ubuntu 16.04 with gcc version 5.4.0.  I have a fairly simple sockets example in C that fails when I compile with optimization (-O) (it works with no optimization).  I trimmed my original code to:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;netdb.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;poll.h&gt;\n\nint main() {\n    struct addrinfo *ai, hints;\n    memset(&amp;hints, 0, sizeof hints);\n    getaddrinfo(NULL, \"7471\", &amp;hints, &amp;ai);\n\n    int listen_fd = socket(ai-&gt;ai_family, SOCK_STREAM, 0);\n    bind(listen_fd, ai-&gt;ai_addr, ai-&gt;ai_addrlen);\n    freeaddrinfo(ai);\n\n    listen(listen_fd, 128);\n\n    struct pollfd fds;\n    fds.fd = listen_fd;\n    fds.events = POLLIN;\n    poll(&amp;fds, -1, -1);\n}\n</code></pre>\n\n<p>The compiler has problems with the call to poll().  The warning message is</p>\n\n<pre><code>in function \u2018poll\u2019,\n    inlined from \u2018main\u2019 at simplecode.c:25:5:\n/usr/include/x86_64-linux-gnu/bits/poll2.h:43:9: warning: call to \u2018__poll_chk_warn\u2019 declared with attribute warning: poll called with fds buffer too small file nfds entries\n  return __poll_chk_warn (__fds, __nfds, __timeout, __bos (__fds));\n</code></pre>\n\n<p>The actual runtime error is longer, but starts with:</p>\n\n<pre><code>*** buffer overflow detected ***: ./simplecode terminated\n</code></pre>\n\n<p>Any ideas?</p>\n"}, {"tags": ["c", "file-handling"], "comments": [{"owner": {"reputation": 22777, "user_id": 133203, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Fp3hB.jpg?s=128&g=1", "display_name": "Federico klez Culloca", "link": "https://stackoverflow.com/users/133203/federico-klez-culloca"}, "edited": false, "score": 0, "creation_date": 1564489947, "post_id": 57271721, "comment_id": 101041540, "body": "You wrote <code>if (line == NULL)</code> then <code>else { if (line == NULL) ...</code> which seem contradictory to me."}, {"owner": {"reputation": 2531, "user_id": 1555662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7046fb9264a333e4c8ac89180f7fed20?s=128&d=identicon&r=PG", "display_name": "olivecoder", "link": "https://stackoverflow.com/users/1555662/olivecoder"}, "edited": false, "score": 1, "creation_date": 1564489983, "post_id": 57271721, "comment_id": 101041562, "body": "your code wont even enter the <code>else if (line==NULL)</code> which would leave the loop"}, {"owner": {"reputation": 4073, "user_id": 11498773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79d317da8c76af3f45f63986e9783740?s=128&d=identicon&r=PG&f=1", "display_name": "Mihir", "link": "https://stackoverflow.com/users/11498773/mihir"}, "edited": false, "score": 0, "creation_date": 1564490157, "post_id": 57271721, "comment_id": 101041664, "body": "I haven\u2019t read your question completely, but giving a quick read, the problem seems that you want real-time logging? Like immedieately when you get input, you want your output. Usng <code>FILE *</code> kind of file handling, data is not written in real time because its buffered and written in one go. If you want data to be written as soon as inputted, either fflush it or using <code>read(2)</code> and <code>write(2)</code> after getting a fd from <code>open(2)</code>."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1564490252, "post_id": 57271721, "comment_id": 101041718, "body": "Generally: Please don&#39;t write code like <code>if(condition) { } else if(!condition) { }</code> (which is what you actually intended), that&#39;s just redundant and serves for nothing, just write <code>if(condition) { } else { }</code> (of course, <i>do</i> write <code>if() {} else if() { }</code> if conditions are <i>not</i> complementary...)."}, {"owner": {"reputation": 136, "user_id": 9044006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0df6156070096ea25c13ea77351d3a20?s=128&d=identicon&r=PG&f=1", "display_name": "geo-freak", "link": "https://stackoverflow.com/users/9044006/geo-freak"}, "reply_to_user": {"reputation": 22777, "user_id": 133203, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Fp3hB.jpg?s=128&g=1", "display_name": "Federico klez Culloca", "link": "https://stackoverflow.com/users/133203/federico-klez-culloca"}, "edited": false, "score": 0, "creation_date": 1564491763, "post_id": 57271721, "comment_id": 101042656, "body": "@FedericoklezCulloca I just modified my code, even though not getting the expected result."}], "answers": [{"comments": [{"owner": {"reputation": 136, "user_id": 9044006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0df6156070096ea25c13ea77351d3a20?s=128&d=identicon&r=PG&f=1", "display_name": "geo-freak", "link": "https://stackoverflow.com/users/9044006/geo-freak"}, "edited": false, "score": 0, "creation_date": 1564495930, "post_id": 57272367, "comment_id": 101045424, "body": "Its working good, but my output log file is not growing by time, when execution coming to end(1 min before completion) then log file gets the data. Any solution for this?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 136, "user_id": 9044006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0df6156070096ea25c13ea77351d3a20?s=128&d=identicon&r=PG&f=1", "display_name": "geo-freak", "link": "https://stackoverflow.com/users/9044006/geo-freak"}, "edited": false, "score": 0, "creation_date": 1564497718, "post_id": 57272367, "comment_id": 101046590, "body": "@geo-freak Your trouble is in unposted code.  Cannot help with that unknown code."}, {"owner": {"reputation": 136, "user_id": 9044006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0df6156070096ea25c13ea77351d3a20?s=128&d=identicon&r=PG&f=1", "display_name": "geo-freak", "link": "https://stackoverflow.com/users/9044006/geo-freak"}, "edited": false, "score": 0, "creation_date": 1575985535, "post_id": 57272367, "comment_id": 104744556, "body": "based on your answer, can I read a media(.wav) file using fread()?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 136, "user_id": 9044006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0df6156070096ea25c13ea77351d3a20?s=128&d=identicon&r=PG&f=1", "display_name": "geo-freak", "link": "https://stackoverflow.com/users/9044006/geo-freak"}, "edited": false, "score": 0, "creation_date": 1575988675, "post_id": 57272367, "comment_id": 104746421, "body": "@geo-freak Yes."}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": true, "score": 0, "last_activity_date": 1564492057, "last_edit_date": 1564492057, "creation_date": 1564491690, "answer_id": 57272367, "question_id": 57271721, "link": "https://stackoverflow.com/questions/57271721/how-to-exit-safely-from-a-loop-while-working-on-a-growing-input-file/57272367#57272367", "title": "How to exit safely from a loop while working on a growing input file?", "body": "<p>Code is waiting indefinitely for additional data.  Code just waits longer and longer with <code>usleep(25000*failedReads)</code>.</p>\n\n<pre><code>// Ineffective code\nif (line == NULL){\n  if(feof(infile))\n       clearerr(infile);\n  failedReads++;\n  usleep(25000*failedReads); //wait for the data from live file\n  continue;     \n}\n\nelse{\n        if(line == NULL)  // this can never be true!\n                if(feof(infile))\n                        break;\n}\n</code></pre>\n\n<p>\"to get the data by time(means output file is not growing\" implies there should be an upper bound of time that if the input file fails to provide more data, quit the loop.</p>\n\n<p>Look for 2 successive read failures.  If waiting after the first failure does not provide more data, time to leave.</p>\n\n<pre><code>// instead\nbool failed_read_flag = false;\nwhile(1){\n  line = fgets(line_buf, sizeof(line_buf), infile);\n  if (line == NULL){\n    if (failed_read_flag) {\n      break; // 2 successive read fails \n    }\n    if(!feof(infile)) {\n      break; // Rare input error just occurred.\n    }\n    clearerr(infile);\n    failed_read_flag = true;\n    usleep(25000 /* us */); //wait for the data from live file\n    continue;     \n  }\n  failed_read_flag = false;\n\n  // Do some work\n}\n</code></pre>\n\n<hr>\n\n<p>Strange to open a file with <code>infile = fopen(filename, \"rb\");</code> and then use it with <code>fgets()</code>.</p>\n\n<p>It the file is a <em>text</em> file,  use <code>fopen(filename, \"r\")</code>.  If the file is binary, use <code>fread()</code>.</p>\n"}], "owner": {"reputation": 136, "user_id": 9044006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0df6156070096ea25c13ea77351d3a20?s=128&d=identicon&r=PG&f=1", "display_name": "geo-freak", "link": "https://stackoverflow.com/users/9044006/geo-freak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 1, "accepted_answer_id": 57272367, "answer_count": 1, "score": 1, "last_activity_date": 1564498288, "creation_date": 1564489744, "last_edit_date": 1564498288, "question_id": 57271721, "link": "https://stackoverflow.com/questions/57271721/how-to-exit-safely-from-a-loop-while-working-on-a-growing-input-file", "title": "How to exit safely from a loop while working on a growing input file?", "body": "<p>I am reading a growing input file, and do some work and write the info to the output file. I have some conditions to work on the growing file. But I am failing at exiting from the loop.</p>\n\n<pre><code>FILE *logfile;\n\nint main(int argc, char *argv[])\n{\n  char *filename;\n  char *logfilename;\n  FILE *infile;\n  char line_buf[255];\n  char *line;\n\n  sleep(3);\n\n  if (argc &lt; 3) {\n    fprintf(stderr, \"Usage: %s &lt;filename&gt; &lt;logfile&gt;\\n\",\n            argv[0]);\n    return -1;\n  }\n  filename = argv[1];\n  logfilename = argv[2];\n\n\n  infile = fopen(filename, \"rb\");\n  if (infile == NULL) {\n    fprintf(stderr, \"Failed to open file\\n\");\n    return -1;\n  }\n\n  logfile = fopen(logfilename, \"w\");\n  if (logfile == NULL) {\n    fprintf(stderr, \"Failed to open logfile - are permissions correct?\\n\");\n    return -1;\n  }\n\n  while(1){\n    line = fgets(line_buf, sizeof(line_buf), infile);\n\n\n    if (line == NULL){\n      if(feof(infile))\n           clearerr(infile);\n      failedReads++;\n      usleep(25000); //wait for the data from live file\n      continue;     \n    }\n\n    else{  \n            if(feof(infile))\n                   break;\n    }\n\n    ...........\n    //do some work\n    ...........\n  }\n\n fclose(infile);\n fclose(logfile);\n}\n</code></pre>\n\n<p>My output log file is getting the data only after the input file stops growing(means at the end of execution). I want my output logfile to get the data by time(means output file is not growing). I have a python script for create a growing file(If anyone really wants to work my issue). </p>\n\n<pre><code>#/usr/bin/python\nimport time\nwith open(\"input.txt\") as f:\n    fileoutput = f.readlines()\nwith open(\"out.txt\", \"a+\") as f1:\n    for line in fileoutput:\n        f1.write(line)\n        f1.flush()\n        time.sleep(0.01)\n</code></pre>\n"}, {"tags": ["c", "char", "sizeof", "literals"], "comments": [{"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 3, "creation_date": 1564488911, "post_id": 57271391, "comment_id": 101040840, "body": "<code>&#39;0&#39;</code> is an integer."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1564489022, "post_id": 57271391, "comment_id": 101040918, "body": "<code>sizeof()</code> returns a <code>size_t</code>, which is properly printed with <code>%zu</code>.  Printing <code>size_t</code> with <code>%d</code> is undefined behavior."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 1, "creation_date": 1564489254, "post_id": 57271391, "comment_id": 101041086, "body": "You would have been fond of a DSP I once worked with, it had <code>CHAR_BIT == 16</code> and <code>sizeof(char) == sizeof(int)</code> \u2013 on <i>this</i> machine, you would have received the output you expected..."}], "answers": [{"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 4, "last_activity_date": 1564489588, "last_edit_date": 1564489588, "creation_date": 1564488839, "answer_id": 57271433, "question_id": 57271391, "link": "https://stackoverflow.com/questions/57271391/the-value-of-sizeof0-is-how-much/57271433#57271433", "title": "the value of sizeof(&#39;0&#39;) is how much?", "body": "<p>Opposite to C++ in C (integer) character constants have the type <code>int</code>.</p>\n\n<p>From the C Standard (6.4.4.4 Character constants)</p>\n\n<blockquote>\n  <p>10 An integer character constant <strong>has type int</strong>.</p>\n</blockquote>\n\n<p>Compare the quote with the quote from the C++17 Standard (5.13.3 Character literals)</p>\n\n<blockquote>\n  <p>2 A character literal that does not begin with u8, u, U, or L is an\n  ordinary character literal. An ordinary character literal that\n  contains a single c-char representable in the execution character set\n  <strong>has type char</strong>, with value equal to the numerical value of the encoding of the c-char in the execution character set....</p>\n</blockquote>\n\n<p>As for this expression</p>\n\n<pre><code>sizeof(c)\n</code></pre>\n\n<p>then it provides the size of an object of the type <code>char</code>. Objects of the type <code>char</code> always have the size equal to <code>1</code>.</p>\n\n<p>From the C Standard (6.5.3.4 The sizeof and alignof operators)</p>\n\n<blockquote>\n  <p>4 When sizeof is applied to an operand that has type char, unsigned\n  char, or signed char, (or a qualified version thereof) the result is\n  1....</p>\n</blockquote>\n\n<p>Pay attention to that a valid call of the function printf will look like</p>\n\n<pre><code>printf(\"%zu %zu\",sizeof(c), sizeof('0'));\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 1, "creation_date": 1564489041, "post_id": 57271434, "comment_id": 101040925, "body": "Not in Klingon or EBCDIC computers :)"}, {"owner": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "reply_to_user": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 0, "creation_date": 1564489825, "post_id": 57271434, "comment_id": 101041465, "body": "@pmg When will these systems go extinct?"}, {"owner": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "reply_to_user": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "edited": false, "score": 1, "creation_date": 1564492351, "post_id": 57271434, "comment_id": 101043006, "body": "@machine_1 When <code>std::sentient</code> is added to the C++ STL."}], "tags": [], "owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "is_accepted": false, "score": 1, "last_activity_date": 1564488842, "creation_date": 1564488842, "answer_id": 57271434, "question_id": 57271391, "link": "https://stackoverflow.com/questions/57271391/the-value-of-sizeof0-is-how-much/57271434#57271434", "title": "the value of sizeof(&#39;0&#39;) is how much?", "body": "<pre><code>sizeof('0')\n</code></pre>\n\n<p>is actually</p>\n\n<p><code>sizeof(ASCII value of '0')</code> </p>\n\n<p>which is integer. Thus it is printing <code>sizeof(int)</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "is_accepted": true, "score": 3, "last_activity_date": 1564488904, "creation_date": 1564488904, "answer_id": 57271461, "question_id": 57271391, "link": "https://stackoverflow.com/questions/57271391/the-value-of-sizeof0-is-how-much/57271461#57271461", "title": "the value of sizeof(&#39;0&#39;) is how much?", "body": "<p>Character literals (<code>'0'</code>, <code>'a'</code>, <code>'d'</code>, <code>'.'</code>) in C are of type <code>int</code> (unlike in C++, where they are of type <code>char</code>).</p>\n\n<p>So you will get in C:</p>\n\n<pre><code>sizeof(char) == 1\nsizeof('0')  == sizeof(int) // note that this is not necessarily 4!\n</code></pre>\n\n<p>whereas in C++ you will have:</p>\n\n<pre><code>sizeof(char) == 1\nsizeof('0')  == sizeof(char)\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9745933, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b4919f4d55fa0eee5bf0b2a25213fed?s=128&d=identicon&r=PG&f=1", "display_name": "\u5434\u5c0f\u8471", "link": "https://stackoverflow.com/users/9745933/%e5%90%b4%e5%b0%8f%e8%91%b1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 253, "favorite_count": 0, "closed_date": 1564489030, "accepted_answer_id": 57271461, "answer_count": 3, "score": 0, "last_activity_date": 1564489588, "creation_date": 1564488722, "last_edit_date": 1564489427, "question_id": 57271391, "link": "https://stackoverflow.com/questions/57271391/the-value-of-sizeof0-is-how-much", "closed_reason": "Duplicate", "title": "the value of sizeof(&#39;0&#39;) is how much?", "body": "<pre><code>#include &lt;stdio.h&gt;\nint main()\n{\n    char c = '0';\n    printf(\"%d %d\",sizeof(c), sizeof('0'));\n    return 0;\n}\n</code></pre>\n\n<p>I expect the output is 1 1.but the real result is 1 4.</p>\n"}, {"tags": ["c", "select", "pipe", "fork", "ipc"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1564485763, "post_id": 57270372, "comment_id": 101039033, "body": "Do you need a high precision timer? Then <code>select</code> isn&#39;t it, and unless you also want to poll descriptors I suggest you do some searching regarding timers for your operating system (Linux?). You will get plenty of hits and examples."}, {"owner": {"reputation": 25, "user_id": 11828816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/197f87c0dad8d9c89ae301155ac544bf?s=128&d=identicon&r=PG&f=1", "display_name": "FloKl", "link": "https://stackoverflow.com/users/11828816/flokl"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1564486279, "post_id": 57270372, "comment_id": 101039329, "body": "everything with under ~50ms gap is okay. I think a high precision timer is not necessary here. And yes, Iam operating on Linux (rasbian)"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1564500776, "post_id": 57270372, "comment_id": 101048409, "body": "on linux, suggest using the function: <code>setitimer()</code>"}, {"owner": {"reputation": 25, "user_id": 11828816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/197f87c0dad8d9c89ae301155ac544bf?s=128&d=identicon&r=PG&f=1", "display_name": "FloKl", "link": "https://stackoverflow.com/users/11828816/flokl"}, "edited": false, "score": 0, "creation_date": 1564555552, "post_id": 57270372, "comment_id": 101064559, "body": "Thank your for your replay. Could you give me a little example how to structure the code for two running child process, that they start every 500ms to gather data? Thank you!"}], "owner": {"reputation": 25, "user_id": 11828816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/197f87c0dad8d9c89ae301155ac544bf?s=128&d=identicon&r=PG&f=1", "display_name": "FloKl", "link": "https://stackoverflow.com/users/11828816/flokl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 21, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1564485337, "creation_date": 1564485337, "question_id": 57270372, "link": "https://stackoverflow.com/questions/57270372/interprocess-and-time-based-process-controlling-with-select-and-pipes-in-c-lan", "title": "interprocess and time based process controlling with select() and pipes in c language", "body": "<p>Iam currently working on a program where I log OBD-data from my car. Currently Iam stucking on the problem to record these data every 500ms. I want to use the select() function for that because I got three child processes:</p>\n\n<ul>\n<li>videoLog</li>\n<li>GPSLog</li>\n<li>OBDLog</li>\n</ul>\n\n<p>and my parent process: <strong>main</strong></p>\n\n<p>I want that the <strong>GPSLog and OBDLog</strong> record data every 500ms and the <strong>videoLog</strong> should run the whole time.\nIam currently stucking on how to architect the software, that it is good to code.</p>\n\n<p>How can I controll my <strong>GPSLog and PBDLog</strong> that they <strong>record at the same time (every 500ms)</strong> and log the data to a mySQL DB? The rest of the time, no of the two processes should do anything.</p>\n\n<p>I would like to get a scheme or a example Code of that by you guys. Using select() and pipe().\nI can't really make a start here.</p>\n\n<p>Best wishes,</p>\n\n<p>FloKl</p>\n"}, {"tags": ["c", "xml", "xml-parsing", "libxml2", "xml-libxml"], "comments": [{"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 1, "creation_date": 1564483851, "post_id": 57269920, "comment_id": 101038039, "body": "<code>xml-config</code> is a tool that&#39;s supposed to be installed along with <code>libxml</code> to help your Makefile find it.  But if you installed <code>libxml</code> by hand, it&#39;s not too surprising if <code>xml-config</code> didn&#39;t get installed at all.  (And the official copy of <code>xml-config</code> probably wouldn&#39;t know where you chose to install the libraries themselves.)"}, {"owner": {"reputation": 227, "user_id": 6844163, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dD0t6.png?s=128&g=1", "display_name": "Ashwant Manikoth", "link": "https://stackoverflow.com/users/6844163/ashwant-manikoth"}, "reply_to_user": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1564483985, "post_id": 57269920, "comment_id": 101038117, "body": "any link for download and install?"}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 1, "creation_date": 1564484230, "post_id": 57269920, "comment_id": 101038256, "body": "Start with <code>gcc test.c -llibxml</code>.  It will probably say &quot;can&#39;t find header file xml.h&quot;. Then say <code>gcc -Iwhere_I_put_them test.c -llibxml</code>, replacing <code>where_I_put_them</code> with the directory where you put <code>xml.h</code>.  Then it will probably say &quot;can&#39;t find libxml&quot;.  So then try <code>gcc -Iwhere_I_put_them test.c -Llibdir -llibxml</code>, replacing <code>libdir</code> with the directory where you put the libraries.  You don&#39;t really need <code>xml-config</code>, it&#39;s just a tool that tries to make the rest of this easier."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 1, "creation_date": 1564484470, "post_id": 57269920, "comment_id": 101038361, "body": "The other problem you have here is that it looks like you&#39;re using the Windows command line, which doesn&#39;t support the Unix backquote mechanism."}], "answers": [{"tags": [], "owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "is_accepted": true, "score": 1, "last_activity_date": 1564486118, "last_edit_date": 1564486118, "creation_date": 1564485333, "answer_id": 57270371, "question_id": 57269920, "link": "https://stackoverflow.com/questions/57269920/whats-the-reason-for-the-xml2-config-not-found-while-compiling-libxml2/57270371#57270371", "title": "whats the reason for the xml2-config not found while compiling libxml2?", "body": "<p>When you write a program that uses a third-party library like <code>libxml</code>, typically you have two problems:</p>\n\n<ol>\n<li><p>You need to tell the compiler where the library's header files are installed, so that when your code says things like <code>#include &lt;xml.h&gt;</code> the compiler will be able to find them.</p></li>\n<li><p>You need to tell the linker where the library itself is installed.</p></li>\n</ol>\n\n<p>If you don't manage to do step 1 correctly, you typically get an error like \"error: 'xml.h' file not found\".</p>\n\n<p>If you don't manage to do step 2 correctly, you typically get errors like \"Undefined symbol: _xmlparse\" or \"library not found for -llibxml\".  (\"Undefined symbol\" means the compiler didn't even know to look for the library, so it complains that there are no definitions for the functions that would have been found in it.  \"library not found for -llibxml\" means you told the compiler which library to look for, but it couldn't find it.)</p>\n\n<p>On C compilers under Unix, anyway, you tell the compiler where to look for header files using the <code>-I</code> flag, like this:</p>\n\n<pre><code>cc -Idirectory_where_extra_header_files_are -c test.c\n</code></pre>\n\n<p>You tell the compiler/linker to load an additional library using the <code>-l</code> flag:</p>\n\n<pre><code>cc test.o -llibxml\n</code></pre>\n\n<p>You tell the compiler/linker where to <em>find</em> that additional library using the <code>-L</code> flag:</p>\n\n<pre><code>cc test.o -Ldirectory_where_extra_library_files_are -llibxml\n</code></pre>\n\n<p>But this can be a nuisance.  Many third-party libraries come with \"config\" programs which are supposed to help you with this.  An invocation like</p>\n\n<pre><code>xml-config --cflags\n</code></pre>\n\n<p>prints the string</p>\n\n<pre><code>-Idirectory_where_the_libxml_header_files_are\n</code></pre>\n\n<p>so you know what to add to the <code>cc</code> line to fix problem 1.  And the an invocation like</p>\n\n<pre><code>xml-config --libs\n</code></pre>\n\n<p>prints the string</p>\n\n<pre><code>-Ldirectory_where_the_libxml_libraries_are -llibxml\n</code></pre>\n\n<p>so you know what to add to the <code>cc</code> line to fix problem 2.</p>\n\n<p>And then, finally, this tool is intended to be used a special mechanism of the Unix shell, the backquote, which lets you take the output of one command and insert it into another command line:</p>\n\n<pre><code>cc `xml-config --cflags --libs` test.c\n</code></pre>\n\n<p>This literally runs the <code>xml-config</code> command, collects its output (that is, whatever <code>xml-config</code> prints out), and inserts that input into the command line, just as if you'd typed it, and then finally runs the <code>cc</code> command with those additional arguments.  It's a handy mechanism, but if you're using Windows you may not be able to use it.</p>\n\n<p>So <em>if</em> you're on a Unix-like system and <em>if</em> the <code>xml-config</code> program is installed where the shell can find it and <em>if</em> the header files and libraries are installed where <code>xml-config</code> thinks they are, then using <code>xml-config</code> can be very convenient.  But if any of these things is not true, the whole mechanism breaks down, and you may have to do things \"by hand\".</p>\n\n<p>Doing things \"by hand\" isn't impossible, and it isn't even particularly difficult.  It's how we always did things back before this kind of \"config\" tool helper mechanism was invented.  As discussed above, just use <code>-I</code> to tell the compiler where the header files are when you compile:</p>\n\n<pre><code>cc -Idirectory_where_the_libxml_header_files_are -c test.c\n</code></pre>\n\n<p>Use <code>-L</code> and <code>-l</code> to tell it where the library is:</p>\n\n<pre><code>cc test.o -Ldirectory_where_the_libxml_libraries_are -llibxml\n</code></pre>\n"}], "owner": {"reputation": 227, "user_id": 6844163, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dD0t6.png?s=128&g=1", "display_name": "Ashwant Manikoth", "link": "https://stackoverflow.com/users/6844163/ashwant-manikoth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 592, "favorite_count": 1, "accepted_answer_id": 57270371, "answer_count": 1, "score": 1, "last_activity_date": 1564486118, "creation_date": 1564483660, "question_id": 57269920, "link": "https://stackoverflow.com/questions/57269920/whats-the-reason-for-the-xml2-config-not-found-while-compiling-libxml2", "title": "whats the reason for the xml2-config not found while compiling libxml2?", "body": "<p>The program is to run a c program to parse a xml file in windows Gcc mingw.\nbut on compilation i get xml2-config not found ,--libs unrecognized commands, --cflags unrecognized commands.</p>\n\n<p>gcc<a href=\"https://i.stack.imgur.com/VAkjc.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/VAkjc.png\" alt=\"enter image description here\"></a></p>\n\n<p>i have added libxml files \"libxml libxslt iconv\" to the environmental path.</p>\n\n<p><a href=\"https://i.stack.imgur.com/pFYnO.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pFYnO.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 22777, "user_id": 133203, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Fp3hB.jpg?s=128&g=1", "display_name": "Federico klez Culloca", "link": "https://stackoverflow.com/users/133203/federico-klez-culloca"}, "edited": false, "score": 0, "creation_date": 1564482497, "post_id": 57269541, "comment_id": 101037281, "body": "Hello and welcome. How is this &quot;not working&quot;? What&#39;s the expected behavior and what happens instead?"}, {"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 0, "creation_date": 1564482982, "post_id": 57269541, "comment_id": 101037585, "body": "<code>chars</code> are integers! They are the shortest integer type available. If you care about whether they can or cannot be negative, use <code>signed char</code> or <code>unsigned char</code> because plain <code>char</code> will be different on different compilers."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1564483157, "post_id": 57269541, "comment_id": 101037681, "body": "Yes, you can use chars as integers!  And you don&#39;t have to write <code>randlett = rand() % 26 + 97</code>, you can write <code>randlett = rand() % 26 + &#39;a&#39;</code>, and it will do exactly the same thing."}, {"owner": {"reputation": 370, "user_id": 10876117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Bzy2d.gif?s=128&g=1", "display_name": "t3m2", "link": "https://stackoverflow.com/users/10876117/t3m2"}, "edited": false, "score": 0, "creation_date": 1564484506, "post_id": 57269541, "comment_id": 101038379, "body": "Wirte <code>int tries=1;</code> instead of <code>int tries=0</code> and then <code>printf(&quot;Try number %d\\nPick a letter\\n&quot;, tries); instead of </code>printf(&quot;Try number %d\\nPick a letter\\n&quot;, tries+1). Or write  <code>tries ++</code> in the beginng of the <code>while</code> loop, not in the end so that you don&#39;t have to print <code>tries+1</code>."}], "answers": [{"comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1564485915, "post_id": 57269633, "comment_id": 101039119, "body": "The first is better, which only skips whitespace. The second will skip evey other character of input such as <code>abcdef&lt;Enter&gt;</code>. You  cannot assume that every character is followed by Enter."}, {"owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1564487681, "post_id": 57269633, "comment_id": 101040139, "body": "@WeatherVane Well atleast for OP&#39;s case we can assume."}], "tags": [], "owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "is_accepted": true, "score": 0, "last_activity_date": 1564482619, "creation_date": 1564482619, "answer_id": 57269633, "question_id": 57269541, "link": "https://stackoverflow.com/questions/57269541/can-i-use-chars-as-integers-in-an-if-statement/57269633#57269633", "title": "Can I use chars as integers in an if statement?", "body": "<pre><code>scanf(\"%c\", &amp;playerlett);\n</code></pre>\n\n<p>As of now <code>scanf</code> is consuming <code>\\n</code>(enter pressed) from the previous input.</p>\n\n<p>Change it to,</p>\n\n<pre><code>    scanf(\" %c\", &amp;playerlett); \n           ^-------------------------//Extra space\n</code></pre>\n\n<p>or</p>\n\n<pre><code>    scanf(\"%c\", &amp;playerlett);\n    getchar();\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 3, "creation_date": 1564483776, "post_id": 57269919, "comment_id": 101037999, "body": "fflush(stdin); is undefined behavior."}, {"owner": {"reputation": 370, "user_id": 10876117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Bzy2d.gif?s=128&g=1", "display_name": "t3m2", "link": "https://stackoverflow.com/users/10876117/t3m2"}, "reply_to_user": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1564503396, "post_id": 57269919, "comment_id": 101049749, "body": "You are right: <a href=\"https://stackoverflow.com/a/2979217/10876117\">stackoverflow.com/a/2979217/10876117</a>."}], "tags": [], "owner": {"reputation": 370, "user_id": 10876117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Bzy2d.gif?s=128&g=1", "display_name": "t3m2", "link": "https://stackoverflow.com/users/10876117/t3m2"}, "is_accepted": false, "score": -1, "last_activity_date": 1564503468, "last_edit_date": 1564503468, "creation_date": 1564483657, "answer_id": 57269919, "question_id": 57269541, "link": "https://stackoverflow.com/questions/57269541/can-i-use-chars-as-integers-in-an-if-statement/57269919#57269919", "title": "Can I use chars as integers in an if statement?", "body": "<p>Supplementary to <a href=\"https://stackoverflow.com/users/4431643/kiran-biradar\">kiran Biradar</a>'s <a href=\"https://stackoverflow.com/a/57269633/10876117\">answer</a>:</p>\n\n<p>When you use <code>scanf(\"%c\", &amp;playerlett);</code> and you enter a character, you have to press <em>Enter</em>. The problem is that, this <em>Enter</em> is the character <code>'\\n'</code>, which is used as the next input for <code>scanf</code> in the next interation of the <code>while</code> loop. So, we have to make the program ignore this <code>'\\n'</code> (spaces, tabs or enters basically).</p>\n\n<p>This can be done by simply changing the initial <code>scanf</code> to <code>scanf(\" %c\", &amp;playerlett);</code>. By addind the extra space, you are \"telling\" the program to ignore spaces, tabs or enters, and only consider other characters as input. So, you can change this line: <code>scanf(\"%c\", &amp;playerlett);</code> to:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>scanf(\" %c\", &amp;playerlett); // this is probably the best solution\n</code></pre>\n\n<p>Other options (although the first one is the best):</p>\n\n<p>Writing this:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>scanf(\"%c\", &amp;playerlett); // this receives the letter eg 'q'\ngetchar(); // this receives the &lt;Enter&gt;, the '\\n'\n</code></pre>\n\n<p>Or this, very similar:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>playerlett=getchar(); // this receives the letter eg 'q'\ngetchar(); // this receives the &lt;Enter&gt;, the '\\n'\n</code></pre>\n\n<p>An alternative that should not be used: adding adding <code>fflush(stdin)</code> after the <code>scanf(\"%c\", &amp;playerlett);</code> to clean the buffer, basically, to \"tell\" the program to forget the characters such as <code>'\\n'</code> that were entered after the first character: (This is not very recommended, see <a href=\"https://stackoverflow.com/a/2979217/10876117\">this answer</a>):</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>scanf(\" %c\", &amp;playerlett); // this receives the letter eg 'q'\nfflush(stdin); // this \"forgets\" the &lt;Enter&gt;, the '\\n'\n</code></pre>\n\n<p>See: <a href=\"https://stackoverflow.com/questions/5240789/scanf-leaves-the-new-line-char-in-the-buffer\">scanf() leaves the new line char in the buffer</a> for more information.</p>\n"}], "owner": {"reputation": 13, "user_id": 11856895, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-kLOCY0tt6gA/AAAAAAAAAAI/AAAAAAAAXkU/9l_OLE564dI/photo.jpg?sz=128", "display_name": "Nicolas Pizzarelli", "link": "https://stackoverflow.com/users/11856895/nicolas-pizzarelli"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 0, "closed_date": 1564483653, "accepted_answer_id": 57269633, "answer_count": 2, "score": -2, "last_activity_date": 1564503468, "creation_date": 1564482306, "last_edit_date": 1564486591, "question_id": 57269541, "link": "https://stackoverflow.com/questions/57269541/can-i-use-chars-as-integers-in-an-if-statement", "closed_reason": "Duplicate", "title": "Can I use chars as integers in an if statement?", "body": "<p>I'm trying to make program that let the user try to guess the letter that the program choose randomly. The loops and the if statements seem not working. If anybody could check my code a little bit it would be awesome. </p>\n\n<p>I'll attach a pic of the output.</p>\n\n<p><a href=\"https://i.stack.imgur.com/egt82.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/egt82.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>int main()\n{\n    srand(time(NULL));\n\n    char randlett, playerlett;\n    int tries = 0;\n\n    randlett = rand() % 26 + 97;\n\n    printf(\"The program choose a letter\\n\\n\");\n\n    while (tries &lt; 5){\n        printf(\"Try number %d\\nPick a letter\\n\", tries + 1);\n        scanf(\"%c\", &amp;playerlett);\n\n        if (randlett != playerlett){\n            if (playerlett &gt; randlett){\n                printf(\"\\nThe letter is before the one you chosen\\n\");\n            }\n            else{\n                printf(\"\\nThe letter is after the one you chosen\\n\");\n            }\n            tries ++;\n            continue;\n        }\n        else{\n            printf(\"You win\");\n            break;\n        }\n    }\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 0, "creation_date": 1564481215, "post_id": 57269152, "comment_id": 101036566, "body": "Hmmm ... define/declare them in alphabetical order?"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1564481434, "post_id": 57269152, "comment_id": 101036700, "body": "What &quot;redefinition of typedef error&quot;? Are you talking about structs or typedefs?"}, {"owner": {"reputation": 22777, "user_id": 133203, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Fp3hB.jpg?s=128&g=1", "display_name": "Federico klez Culloca", "link": "https://stackoverflow.com/users/133203/federico-klez-culloca"}, "edited": false, "score": 0, "creation_date": 1564481666, "post_id": 57269152, "comment_id": 101036835, "body": "Do you mean, when the file is included you get errors because the structs are re-defined? If that&#39;s what you mean take a look <a href=\"https://stackoverflow.com/questions/1653958/why-are-ifndef-and-define-used-in-c-header-files\">here</a>"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 5, "creation_date": 1564482067, "post_id": 57269152, "comment_id": 101037054, "body": "Why and how are you getting redefinition errors?  Post some actual code that demonstrates those errors."}], "answers": [{"tags": [], "owner": {"reputation": 1145, "user_id": 11783812, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LFwV3.jpg?s=128&g=1", "display_name": "cocool97", "link": "https://stackoverflow.com/users/11783812/cocool97"}, "is_accepted": false, "score": 0, "last_activity_date": 1564481832, "creation_date": 1564481832, "answer_id": 57269394, "question_id": 57269152, "link": "https://stackoverflow.com/questions/57269152/how-can-i-check-if-a-struct-type-has-been-defined-before/57269394#57269394", "title": "How can I check if a struct type has been defined before?", "body": "<p>If your problem is the redefinition of elements with multiple header inclusions, you can use the preprocessor macros <code>#ifndef</code> and <code>#define</code> to only define once each value.</p>\n"}, {"comments": [{"owner": {"reputation": 51, "user_id": 8011520, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-owlJX5GmPwI/AAAAAAAAAAI/AAAAAAAAACk/L8hYZ5wRtIE/photo.jpg?sz=128", "display_name": "Alsamman", "link": "https://stackoverflow.com/users/8011520/alsamman"}, "edited": false, "score": 0, "creation_date": 1564498003, "post_id": 57269410, "comment_id": 101046788, "body": "Yes this is what I need thank you very much"}], "tags": [], "owner": {"reputation": 44, "user_id": 11813824, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-vpqIz4zs1qQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdx5KJN9RuhR6Y7ChruYVmEdy1Mwg/photo.jpg?sz=128", "display_name": "startFromZero", "link": "https://stackoverflow.com/users/11813824/startfromzero"}, "is_accepted": true, "score": 0, "last_activity_date": 1564482701, "last_edit_date": 1564482701, "creation_date": 1564481873, "answer_id": 57269410, "question_id": 57269152, "link": "https://stackoverflow.com/questions/57269152/how-can-i-check-if-a-struct-type-has-been-defined-before/57269410#57269410", "title": "How can I check if a struct type has been defined before?", "body": "<p>do you mean that you want to separate your program file into one header file that declares the struct you need and one program file that include your program?</p>\n\n<p>create a file named \"type.h\", and in this file</p>\n\n<pre><code>/* type.h */\n#ifndef TYPE_H\n#define TYPE_H\ntypedef struct t_Node\n{\n  int m_Info;\n}t_Node;\n\n/* ... definition of another struct */\n#endif\n</code></pre>\n\n<p>and in the file that includes your program, for example, \"main.c\"</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include  \"type.h\"\nint main(void)\n{\n  /* your program */\n}\n</code></pre>\n\n<p>and you need to put the two files in one directory. Or you need to use <code>gcc -c main.c -I &lt;directory of type.h&gt;</code></p>\n"}], "owner": {"reputation": 51, "user_id": 8011520, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-owlJX5GmPwI/AAAAAAAAAAI/AAAAAAAAACk/L8hYZ5wRtIE/photo.jpg?sz=128", "display_name": "Alsamman", "link": "https://stackoverflow.com/users/8011520/alsamman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 1, "closed_date": 1564484157, "accepted_answer_id": 57269410, "answer_count": 2, "score": 0, "last_activity_date": 1564482701, "creation_date": 1564481058, "last_edit_date": 1564481413, "question_id": 57269152, "link": "https://stackoverflow.com/questions/57269152/how-can-i-check-if-a-struct-type-has-been-defined-before", "closed_reason": "Needs details or clarity", "title": "How can I check if a struct type has been defined before?", "body": "<p>I need to define all structs in one head file but how can I do that, in order to avoid the redefinition of typedef error !</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 2, "creation_date": 1564481034, "post_id": 57269034, "comment_id": 101036457, "body": "For current standards (last 20 years), yes. C89 did not have <code>long long</code>. If you&#39;re also targeting pre-C99 implementations, stick to <code>unsigned long</code>."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1564498500, "post_id": 57269034, "comment_id": 101047109, "body": "<code>uintmax_t</code> is usually the longest, yet some compilers offer longer <i>extended</i> types - playing with C semantics.  No highly portable way to get those."}], "answers": [{"tags": [], "owner": {"reputation": 18268, "user_id": 5218354, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-NEO9rZKeffY/AAAAAAAAAAI/AAAAAAAAAKc/9IttO1jUOr4/photo.jpg=k-s128", "display_name": "norok2", "link": "https://stackoverflow.com/users/5218354/norok2"}, "is_accepted": false, "score": 0, "last_activity_date": 1564491539, "last_edit_date": 1564491539, "creation_date": 1564481092, "answer_id": 57269169, "question_id": 57269034, "link": "https://stackoverflow.com/questions/57269034/longest-portable-unsigned-integer-type/57269169#57269169", "title": "Longest portable unsigned integer type", "body": "<p>It depends on the <code>C</code> standard the compiler is <a href=\"https://en.wikipedia.org/wiki/ANSI_C\" rel=\"nofollow noreferrer\">supporting</a>.</p>\n\n<p>For example, <code>unsigned long long</code> is part of <a href=\"https://en.wikipedia.org/wiki/C99\" rel=\"nofollow noreferrer\"><code>C99</code></a> and compilers supporting earlier <code>C</code> standards are not guaranteed to have it.\nI am not aware of something larger than <code>long long</code> on newer <a href=\"https://en.wikipedia.org/wiki/C_data_types\" rel=\"nofollow noreferrer\">standards</a>.\nFor earlier standards <code>unsigned long</code> is the largest which is there since at least <code>C89</code>.</p>\n\n<hr>\n\n<h1>EDIT</h1>\n\n<p>As pointed out in the <a href=\"https://stackoverflow.com/a/57269993/5218354\">answer</a> by @AnttiHaapala as well as in <a href=\"https://en.wikipedia.org/wiki/C_data_types#Fixed-width_integer_types\" rel=\"nofollow noreferrer\">Wikipedia</a> (which I referenced also in the <a href=\"https://en.wikipedia.org/wiki/C_data_types\" rel=\"nofollow noreferrer\">prior</a> edit), the C99 standard provides you with:</p>\n\n<pre><code>TYPE      | MIN VALUE  | MAX VALUE\n----------+------------+------------\nintmax_t  | INTMAX_MIN | INTMAX_MAX\nuintmax_t | 0          | UINTMAX_MAX\n</code></pre>\n\n<p>which provides:</p>\n\n<blockquote>\n  <p>Maximum-width integer types that are guaranteed to be the largest integer type in the implementation.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "is_accepted": true, "score": 8, "last_activity_date": 1564491460, "last_edit_date": 1564491460, "creation_date": 1564483941, "answer_id": 57269993, "question_id": 57269034, "link": "https://stackoverflow.com/questions/57269034/longest-portable-unsigned-integer-type/57269993#57269993", "title": "Longest portable unsigned integer type", "body": "<blockquote>\n  <p>Is it accurate to say that, if you are writing portable C, the longest available unsigned integer type is <code>unsigned long long</code>? I'm not looking for a specific number of bits, or even 'at least a specific number of bits', but 'the longest supported by the current compiler and target platform, whatever that may happen to be'.</p>\n</blockquote>\n\n<p>No. Neither if you're targetting C89, nor if C99+. C89 does not support <code>unsigned long long</code> at all, so you're stuck with <code>unsigned long</code>. So if you want to support archaic platforms you cannot use it.</p>\n\n<p>And C99 added <code>uintmax_t</code> typedef (and <code>intmax_t</code> too) which <em>can</em> be greater than <code>unsigned long long</code>. Naturally <code>uintmax_t</code> must have range of <em>at least</em> that of <code>unsigned long long</code>. </p>\n\n<p><a href=\"https://port70.net/~nsz/c/c99/n1256.html#7.18.1.5\" rel=\"nofollow noreferrer\">C99 7.18.1.5</a>:</p>\n\n<blockquote>\n  <p><strong>7.18.1.5 Greatest-width integer types</strong></p>\n  \n  <p>1 The following type designates a signed integer type capable of\n  representing any value of any signed integer type:</p>\n\n<pre><code>intmax_t\n</code></pre>\n  \n  <p>The following type designates an unsigned integer type capable of\n  representing any value of any unsigned integer type:</p>\n\n<pre><code>uintmax_t\n</code></pre>\n  \n  <p>These types are required.</p>\n</blockquote>\n\n<p>This could be an extended integer type that is implementation-defined (GCC for example does not support extended integer types), but <strong>you</strong> wouldn't need to know about it; or, if a future standard implements <code>unsigned superduper long long</code> then in the future implementations <code>uintmax_t</code> could be a typedef to that.</p>\n\n<hr>\n\n<p>If you really need to support all sorts of compilers, you can use some trickery to create a typedef to the largest portable type like this:</p>\n\n<pre><code>#include &lt;limits.h&gt;\n\n#if defined(__STDC_VERSION__) &amp;&amp; __STDC_VERSION__ &gt;= 199901L\n\n/* C99+ */\n#include &lt;stdint.h&gt;\ntypedef uintmax_t mymaxuint;\n#define MYMAXUINT_MAX UINTMAX_MAX     \n\n#elif defined(ULLONG_MAX)\n\n/* Some compiler that does not support C99+ but seems to have \n   a macro for unsigned long long for some reason */\ntypedef unsigned long long mymaxuint;    \n#define MYMAXUINT_MAX ULLONG_MAX\n\n#else\n\ntypedef unsigned long mymaxuint;\n#define MYMAXUINT_MAX ULONG_MAX\n\n#endif\n</code></pre>\n"}], "owner": {"reputation": 25603, "user_id": 45843, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/55f76441107f14055f95e08bb7bd01df?s=128&d=identicon&r=PG&f=1", "display_name": "rwallace", "link": "https://stackoverflow.com/users/45843/rwallace"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "accepted_answer_id": 57269993, "answer_count": 2, "score": 0, "last_activity_date": 1564491539, "creation_date": 1564480704, "question_id": 57269034, "link": "https://stackoverflow.com/questions/57269034/longest-portable-unsigned-integer-type", "title": "Longest portable unsigned integer type", "body": "<p>Is it accurate to say that, if you are writing portable C, the longest available unsigned integer type is <code>unsigned long long</code>? I'm not looking for a specific number of bits, or even 'at least a specific number of bits', but 'the longest supported by the current compiler and target platform, whatever that may happen to be'.</p>\n"}, {"tags": ["c", "arrays", "pointers", "implicit-conversion"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1564480632, "post_id": 57268963, "comment_id": 101036254, "body": "Array decay happens when you use an array where a pointer is expected. Then the array will decay to a pointer to its first element."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1564480644, "post_id": 57268963, "comment_id": 101036261, "body": "And please, one question per question."}, {"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 0, "creation_date": 1564480828, "post_id": 57268963, "comment_id": 101036355, "body": "&quot;array decay&quot; is another way to say &quot;automatic array conversion (to pointer to its first element)&quot;. I usually prefer the longer version :)"}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1564482846, "post_id": 57268963, "comment_id": 101037500, "body": "See <a href=\"http://c-faq.com/aryptr/aryptrequiv.html\" rel=\"nofollow noreferrer\">question 6.3</a> in the <a href=\"http://c-faq.com/\" rel=\"nofollow noreferrer\">C FAQ list</a>."}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 10584779, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-8OFhzRwTnEw/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbA2jQCXgkYEf1vYdghU45ySO70-3Q/mo/photo.jpg?sz=128", "display_name": "\uc774\uc2b9\ud6c8", "link": "https://stackoverflow.com/users/10584779/%ec%9d%b4%ec%8a%b9%ed%9b%88"}, "edited": false, "score": 0, "creation_date": 1564481160, "post_id": 57269072, "comment_id": 101036528, "body": "Thank you very much. By the way, i have one more question.  I was told that if necessary, the array name is treated as a pointer. So what&#39;s the status of the array name when it&#39;s not needed?"}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 43, "user_id": 10584779, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-8OFhzRwTnEw/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbA2jQCXgkYEf1vYdghU45ySO70-3Q/mo/photo.jpg?sz=128", "display_name": "\uc774\uc2b9\ud6c8", "link": "https://stackoverflow.com/users/10584779/%ec%9d%b4%ec%8a%b9%ed%9b%88"}, "edited": false, "score": 0, "creation_date": 1564481286, "post_id": 57269072, "comment_id": 101036611, "body": "@\uc774\uc2b9\ud6c8 I have not understood the question. Please reread the quote from the C Standard."}, {"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 0, "creation_date": 1564481423, "post_id": 57269072, "comment_id": 101036693, "body": "The exceptions to the &quot;automatic conversion&quot; rule are: when the array is used as operand to the <code>sizeof</code> operator, when used as operand to the <code>&amp;</code> (address of) operator, when used as a string literal to initialize an array, as <a href=\"https://stackoverflow.com/a/17753057/25324\">detailed in this answer</a>."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "reply_to_user": {"reputation": 43, "user_id": 10584779, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-8OFhzRwTnEw/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbA2jQCXgkYEf1vYdghU45ySO70-3Q/mo/photo.jpg?sz=128", "display_name": "\uc774\uc2b9\ud6c8", "link": "https://stackoverflow.com/users/10584779/%ec%9d%b4%ec%8a%b9%ed%9b%88"}, "edited": false, "score": 0, "creation_date": 1564482741, "post_id": 57269072, "comment_id": 101037436, "body": "@\uc774\uc2b9\ud6c8 <i>if necessary, the array name is treated as a pointer</i> -- Not really.  An array is not a pointer, and an array name is not a pointer, either.  What happens is that when you use an array in an expression, in a context where it seems like you might be trying to use the &quot;value&quot; of the array, you don&#39;t get the whole array -- what you get is a pointer to the array&#39;s first element, as if you had written <code>&amp;array[0]</code>."}, {"owner": {"reputation": 43, "user_id": 10584779, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-8OFhzRwTnEw/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbA2jQCXgkYEf1vYdghU45ySO70-3Q/mo/photo.jpg?sz=128", "display_name": "\uc774\uc2b9\ud6c8", "link": "https://stackoverflow.com/users/10584779/%ec%9d%b4%ec%8a%b9%ed%9b%88"}, "edited": false, "score": 0, "creation_date": 1564486334, "post_id": 57269072, "comment_id": 101039359, "body": "I read the document that you uploaded. An array is not a pointer, nor vice versa,  and an array name is not a pointer. Then, is it correct that array name is a <code>non-modifable l-value</code>?"}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 43, "user_id": 10584779, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-8OFhzRwTnEw/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbA2jQCXgkYEf1vYdghU45ySO70-3Q/mo/photo.jpg?sz=128", "display_name": "\uc774\uc2b9\ud6c8", "link": "https://stackoverflow.com/users/10584779/%ec%9d%b4%ec%8a%b9%ed%9b%88"}, "edited": false, "score": 0, "creation_date": 1564486507, "post_id": 57269072, "comment_id": 101039472, "body": "@\uc774\uc2b9\ud6c8 Yes it is a non-modifiable lvalue."}, {"owner": {"reputation": 43, "user_id": 10584779, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-8OFhzRwTnEw/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbA2jQCXgkYEf1vYdghU45ySO70-3Q/mo/photo.jpg?sz=128", "display_name": "\uc774\uc2b9\ud6c8", "link": "https://stackoverflow.com/users/10584779/%ec%9d%b4%ec%8a%b9%ed%9b%88"}, "edited": false, "score": 0, "creation_date": 1564486818, "post_id": 57269072, "comment_id": 101039654, "body": "@Vlad from Moscow OK, I understand. Really appreciate it."}], "tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": true, "score": 0, "last_activity_date": 1564481235, "last_edit_date": 1564481235, "creation_date": 1564480815, "answer_id": 57269072, "question_id": 57268963, "link": "https://stackoverflow.com/questions/57268963/what-is-array-decay-in-c-and-when-it-happen/57269072#57269072", "title": "what is array decay in c and when it happen?", "body": "<p>From the C Standard (6.3.2.1 Lvalues, arrays, and function designators)</p>\n\n<blockquote>\n  <p>3 Except when it is the operand of the sizeof operator or the unary &amp;\n  operator, or is a string literal used to initialize an array, an\n  expression that has type \u2018\u2018array of type\u2019\u2019 is converted to an\n  expression with type \u2018\u2018pointer to type\u2019\u2019 that points to the initial\n  element of the array object and is not an lvalue. If the array object\n  has register storage class, the behavior is undefined.</p>\n</blockquote>\n\n<p>The two variables below </p>\n\n<pre><code>char(*zippo)[2] = NULL;\nchar zippo2[4][2];\n</code></pre>\n\n<p>have different types. The first one is a pointer to an object of the type <code>char[2]</code>. The second one is a two-dimensional array with four elements of the type <code>char[2]</code>.</p>\n\n<p>When the array <code>zippo2</code> is used in expression except the expressions listed in the quote (as for example using it with the sizeof operator) then its designator is implicitly converted to pointer to its first element and has the same type as the variable <code>zippo</code>.</p>\n"}], "owner": {"reputation": 43, "user_id": 10584779, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-8OFhzRwTnEw/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbA2jQCXgkYEf1vYdghU45ySO70-3Q/mo/photo.jpg?sz=128", "display_name": "\uc774\uc2b9\ud6c8", "link": "https://stackoverflow.com/users/10584779/%ec%9d%b4%ec%8a%b9%ed%9b%88"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "accepted_answer_id": 57269072, "answer_count": 1, "score": 0, "last_activity_date": 1564481384, "creation_date": 1564480515, "last_edit_date": 1564481384, "question_id": 57268963, "link": "https://stackoverflow.com/questions/57268963/what-is-array-decay-in-c-and-when-it-happen", "title": "what is array decay in c and when it happen?", "body": "<p>I am currently studying C language.\nI wonder what 'array decaying' means, and when it happens.</p>\n\n<p>And I wonder if the two variables below are interpreted in the same way.</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>\nchar(*zippo)[2] = NULL;\nchar zippo2[4][2];\n\nzippo = (char(*)[2])malloc(sizeof(char[2]) * 4);\n\n\n</code></pre>\n"}, {"tags": ["c", "struct", "casting", "malloc", "typedef"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 3, "creation_date": 1564479635, "post_id": 57268658, "comment_id": 101035732, "body": "<code>(cluster_s*)</code> ==&gt; <code>(struct cluster_s*)</code> but in C you should not need the casts anyway. If you get a compilation error after removing the casts then it&#39;s not C compiler, perhaps the file is .cpp."}, {"owner": {"reputation": 90, "user_id": 9654495, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Florian K", "link": "https://stackoverflow.com/users/9654495/florian-k"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1564480361, "post_id": 57268658, "comment_id": 101036122, "body": "Adding (struct cluster_s*) gives me the same error I get without casting. ie: In function _sbrk_r&#39;: sbrkr.c:(.text._sbrk_r+0xc): undefined reference to_sbrk&#39; collect2: error: ld returned 1 exit status"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1564480436, "post_id": 57268658, "comment_id": 101036167, "body": "You must change <code>(cluster_s**)</code> on another line too."}, {"owner": {"reputation": 90, "user_id": 9654495, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Florian K", "link": "https://stackoverflow.com/users/9654495/florian-k"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1564480685, "post_id": 57268658, "comment_id": 101036284, "body": "Yes I did it too."}], "answers": [{"comments": [{"owner": {"reputation": 90, "user_id": 9654495, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Florian K", "link": "https://stackoverflow.com/users/9654495/florian-k"}, "edited": false, "score": 0, "creation_date": 1564481138, "post_id": 57268721, "comment_id": 101036516, "body": "I guess I should have phrased my question differently, I always get the same strange error after using any of the correct proposed answer to properly call malloc. The error is: In function <code>_sbrk_r&#39;: sbrkr.c:(.text._sbrk_r+0xc): undefined reference to </code>_sbrk&#39; collect2: error: ld returned 1 exit status"}, {"owner": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "reply_to_user": {"reputation": 90, "user_id": 9654495, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Florian K", "link": "https://stackoverflow.com/users/9654495/florian-k"}, "edited": false, "score": 0, "creation_date": 1564482036, "post_id": 57268721, "comment_id": 101037026, "body": "You can go through <a href=\"https://stackoverflow.com/questions/28895703/sbrk-function-not-found-when-placed-in-a-static-library\" title=\"sbrk function not found when placed in a static library\">stackoverflow.com/questions/28895703/&hellip;</a>. Possibly it will solve the <code>_srbk</code> issue"}], "tags": [], "owner": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "is_accepted": false, "score": 0, "last_activity_date": 1564479743, "creation_date": 1564479743, "answer_id": 57268721, "question_id": 57268658, "link": "https://stackoverflow.com/questions/57268658/malloc-of-a-structure-in-c-ported-from-c/57268721#57268721", "title": "malloc of a structure in C ( ported from C++ )", "body": "<p>Replace </p>\n\n<pre><code>struct cluster_s\n{\n   ...\n};\n</code></pre>\n\n<p>with </p>\n\n<pre><code>typedef struct cluster_s \n{\n    ....\n}cluster_s;\n</code></pre>\n\n<p>In C++, a struct and a Class are analogous and can be used interchangeably for the most part. So <code>cluster_s</code> and <code>struct cluster_s</code> can both be used.</p>\n\n<p>In C, <code>cluster_s</code> is not defined. The change above will define a type of the same name.</p>\n\n<p>You can see the answer <a href=\"https://stackoverflow.com/questions/54585/when-should-you-use-a-class-vs-a-struct-in-c\">When should you use a class vs a struct in C++?</a> for the differences between a class and a struct.</p>\n"}, {"comments": [{"owner": {"reputation": 90, "user_id": 9654495, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Florian K", "link": "https://stackoverflow.com/users/9654495/florian-k"}, "edited": false, "score": 0, "creation_date": 1564480784, "post_id": 57268914, "comment_id": 101036332, "body": "Both possibilities give me compilation error: In function <code>_sbrk_r&#39;: sbrkr.c:(.text._sbrk_r+0xc): undefined reference to </code>_sbrk&#39; collect2: error: ld returned 1 exit status"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 90, "user_id": 9654495, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Florian K", "link": "https://stackoverflow.com/users/9654495/florian-k"}, "edited": false, "score": 0, "creation_date": 1564480895, "post_id": 57268914, "comment_id": 101036383, "body": "@FlorianK what is the apostrophe for? Where is function <code>_sbrk_r&#39;</code>?"}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 90, "user_id": 9654495, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Florian K", "link": "https://stackoverflow.com/users/9654495/florian-k"}, "edited": false, "score": 1, "creation_date": 1564480905, "post_id": 57268914, "comment_id": 101036389, "body": "@FlorianK It has nothing common with the question you asked. Undefined error means that the compo;er does not see the definition of _sbrk (or sbrk )"}, {"owner": {"reputation": 90, "user_id": 9654495, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Florian K", "link": "https://stackoverflow.com/users/9654495/florian-k"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1564481457, "post_id": 57268914, "comment_id": 101036715, "body": "@WeatherVane @Vlad from Moscow The full error is: Compiling camera.c Linking build/ch.elf /home/flo/bin/gcc-arm-none-eabi-7-2018-q2-update/bin/../lib/&zwnj;&#8203;gcc/arm-none-eabi/7.&zwnj;&#8203;3.1/../../../../arm-&zwnj;&#8203;none-eabi/lib/thumb/&zwnj;&#8203;v7e-m/fpv4-sp/hard/l&zwnj;&#8203;ibg.a(lib_a-sbrkr.o)&zwnj;&#8203;: In function <code>_sbrk_r&#39;: sbrkr.c:(.text._sbrk_r+0xc): undefined reference to </code>_sbrk&#39; collect2: error: ld returned 1 exit status lib/ChibiOS/os/common/startup/ARMCMx/compilers/GCC/mk/rules.&zwnj;&#8203;mk:204: recipe for target &#39;build/ch.elf&#39; failed make: *** [build/ch.elf] Error 1"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1564481527, "post_id": 57268914, "comment_id": 101036754, "body": "Isn&#39;t <code>error: ld</code> from the <i>linker</i>? That means there were no compilation errors."}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 90, "user_id": 9654495, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Florian K", "link": "https://stackoverflow.com/users/9654495/florian-k"}, "edited": false, "score": 0, "creation_date": 1564481548, "post_id": 57268914, "comment_id": 101036768, "body": "@FlorianK As I said the linker does not see the definition of sbrk."}, {"owner": {"reputation": 90, "user_id": 9654495, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Florian K", "link": "https://stackoverflow.com/users/9654495/florian-k"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1564482073, "post_id": 57268914, "comment_id": 101037058, "body": "Yes it seems that it is a linker problem. Without malloc call I can compile normally @WeatherVane"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1564482184, "post_id": 57268914, "comment_id": 101037110, "body": "So if you are porting from C++ you need the right libraries."}], "tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": true, "score": 1, "last_activity_date": 1564480358, "creation_date": 1564480358, "answer_id": 57268914, "question_id": 57268658, "link": "https://stackoverflow.com/questions/57268658/malloc-of-a-structure-in-c-ported-from-c/57268914#57268914", "title": "malloc of a structure in C ( ported from C++ )", "body": "<p>This</p>\n\n<blockquote>\n  <p>I also tried to remove the cast before malloc and got the compilation\n  error:</p>\n</blockquote>\n\n<p>and this</p>\n\n<blockquote>\n  <p>The code run fine in C++ but I cannot compile it in C.</p>\n</blockquote>\n\n<p>contradict each other.</p>\n\n<p>The first one means that you are trying to compile the program as a C++ program.</p>\n\n<p>To make the program to compile as a C++ program and as a C program there are two approaches.</p>\n\n<p>The first one is everywhere in the program to use the type specifier <code>struct cluster_s</code> instead of just <code>cluster_s</code> . For example</p>\n\n<pre><code>pixel = (struct cluster_s**) malloc(IMG_WIDTH * sizeof(struct cluster_s*));\n         ^^^^^^^^^^^^^^^^  \n//...\ncluster = (struct cluster*) malloc((IMG_WIDTH+1) * sizeof(struct cluster_s));\n           ^^^^^^^^^^^^^^\n</code></pre>\n\n<p>The second one is to introduce an alias for the type specifier <code>struct cluster_s</code> like</p>\n\n<pre><code>typedef struct cluster_s cluster_s;\n</code></pre>\n"}], "owner": {"reputation": 90, "user_id": 9654495, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Florian K", "link": "https://stackoverflow.com/users/9654495/florian-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "accepted_answer_id": 57268914, "answer_count": 2, "score": 1, "last_activity_date": 1564481974, "creation_date": 1564479477, "last_edit_date": 1564481974, "question_id": 57268658, "link": "https://stackoverflow.com/questions/57268658/malloc-of-a-structure-in-c-ported-from-c", "title": "malloc of a structure in C ( ported from C++ )", "body": "<p>I would like to reserve some memory space on the heap and access it with a pointer.</p>\n\n<p>The code run fine in C++ but I cannot compile it in C.</p>\n\n<pre><code>#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n\n#define IMG_WIDTH 320\n\nstruct cluster_s\n{\n  uint16_t size;\n  uint16_t xMin;\n  uint16_t xMax;\n  uint16_t yMin;\n  uint16_t yMax;\n};\n\nstatic struct cluster_s* detectPills(const uint16_t newPixel[])\n{\n\n  static struct cluster_s **pixel = NULL;\n  static struct cluster_s *cluster = NULL;\n\n  if(!pixel){\n    pixel = (cluster_s**) malloc(IMG_WIDTH * sizeof(struct cluster_s*));\n    if(pixel == NULL){\n      return NULL;\n    }\n  }\n  if(!cluster){\n    cluster = (cluster*) malloc((IMG_WIDTH+1) * sizeof(struct cluster_s));\n    if(cluster == NULL){\n      return NULL;\n    }\n    for(int i=0; i&lt;IMG_WIDTH;i++){\n      memset(&amp;cluster[i], 0, sizeof(cluster[i]));\n      pixel[i] = &amp;cluster[i];\n    }\n  }\n(...)\n}\n</code></pre>\n\n<p>which gives me the following compilation error:</p>\n\n<p>error: 'cluster_s' undeclared (first use in this function)\n   pixel = (cluster_s**) malloc(IMG_WIDTH * sizeof(struct *cluster_s));</p>\n\n<p>If I comment out the two malloc calls, I am able to compile it.\nI also tried to remove the cast before malloc and got the compilation error:</p>\n\n<p>In function <code>_sbrk_r':\nsbrkr.c:(.text._sbrk_r+0xc): undefined reference to</code>_sbrk'\ncollect2: error: ld returned 1 exit status</p>\n\n<p>EDIT:\nThe proposed answers are correct, the problem comes from the linker which do not find sbrk</p>\n"}, {"tags": ["c", "winapi"], "comments": [{"owner": {"reputation": 82917, "user_id": 3501, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/1fd5f5cc203c393634379a3b3b7e7a87?s=128&d=identicon&r=PG", "display_name": "Anders", "link": "https://stackoverflow.com/users/3501/anders"}, "edited": false, "score": 1, "creation_date": 1564479342, "post_id": 57268308, "comment_id": 101035540, "body": "Why does it matter?"}, {"owner": {"reputation": 25, "user_id": 11856269, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eJwBL.jpg?s=128&g=1", "display_name": "zask", "link": "https://stackoverflow.com/users/11856269/zask"}, "reply_to_user": {"reputation": 82917, "user_id": 3501, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/1fd5f5cc203c393634379a3b3b7e7a87?s=128&d=identicon&r=PG", "display_name": "Anders", "link": "https://stackoverflow.com/users/3501/anders"}, "edited": false, "score": 0, "creation_date": 1564479633, "post_id": 57268308, "comment_id": 101035730, "body": "@ Anders I just wanted to find it out."}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 2, "creation_date": 1564480115, "post_id": 57268308, "comment_id": 101035999, "body": "<a href=\"https://devblogs.microsoft.com/oldnewthing/20031001-00/?p=42343\" rel=\"nofollow noreferrer\">Why do I get spurious WM_MOUSEMOVE messages?</a> Although I&#39;m almost convinced, that the <code>WM_MOUSEMOVE</code> message you get is genuine. Double-clicking is hard to do <i>without</i> moving the mouse."}, {"owner": {"reputation": 25, "user_id": 11856269, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eJwBL.jpg?s=128&g=1", "display_name": "zask", "link": "https://stackoverflow.com/users/11856269/zask"}, "edited": false, "score": 1, "creation_date": 1564502851, "post_id": 57268308, "comment_id": 101049467, "body": "@ IInspectable. 1. The recipe that Chen gives in his book: &quot;So if your program wants to detect whether the mouse has moved, you need to add a check in your WM_MOUSEMOVE that the mouse position is different from the position reported by the previous WM_MOUSEMOVE message.&quot; is no good. In this case, before double clicking there are no messages WM_MOUSEMOVE, so, the comparison will still give a non-zero value."}, {"owner": {"reputation": 25, "user_id": 11856269, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eJwBL.jpg?s=128&g=1", "display_name": "zask", "link": "https://stackoverflow.com/users/11856269/zask"}, "edited": false, "score": 0, "creation_date": 1564502871, "post_id": 57268308, "comment_id": 101049475, "body": "@ IInspectable. 2. &quot;Although I&#39;m almost convinced, that the WM_MOUSEMOVE message you get is genuine.&quot; You want to say that the offset in the file selection window should give WM_MOUSEMOVE in the underlying window? This is a very strange behavior!"}, {"owner": {"reputation": 318, "user_id": 1203371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12a85501fd76c1f04754349f6b0ce651?s=128&d=identicon&r=PG", "display_name": "Jeff D.", "link": "https://stackoverflow.com/users/1203371/jeff-d"}, "edited": false, "score": 0, "creation_date": 1564511393, "post_id": 57268308, "comment_id": 101052610, "body": "This is correct Windows behavior - the message stream from the system always goes first to the child window that has the focus - you the programmer choose whether you are interested in that message and respond appropriately - however order and number of messages is indeterminate - you cannot and should not code to expect messages to arrive in a particular sequence."}, {"owner": {"reputation": 318, "user_id": 1203371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12a85501fd76c1f04754349f6b0ce651?s=128&d=identicon&r=PG", "display_name": "Jeff D.", "link": "https://stackoverflow.com/users/1203371/jeff-d"}, "edited": false, "score": 0, "creation_date": 1564511543, "post_id": 57268308, "comment_id": 101052685, "body": "So, once your mouse is over the child window, it is automatically receiving the message stream, the first of which is likely to be a mouse move.  Depending on the type of mouse and the resolution settings, each increment of movement (a &#39;mickey&#39; - I swear !) generates a new WM_MOUSEMOVE message."}, {"owner": {"reputation": 25, "user_id": 11856269, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eJwBL.jpg?s=128&g=1", "display_name": "zask", "link": "https://stackoverflow.com/users/11856269/zask"}, "edited": false, "score": 0, "creation_date": 1564513967, "post_id": 57268308, "comment_id": 101053776, "body": "@ Jeff D. The child window has no focus. The focus belongs to the file selection window."}, {"owner": {"reputation": 25, "user_id": 11856269, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eJwBL.jpg?s=128&g=1", "display_name": "zask", "link": "https://stackoverflow.com/users/11856269/zask"}, "edited": false, "score": 0, "creation_date": 1564514359, "post_id": 57268308, "comment_id": 101053964, "body": "@ Jeff D. The mouse does not move over the child window, and even more so with the left button pressed!"}, {"owner": {"reputation": 25, "user_id": 11856269, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eJwBL.jpg?s=128&g=1", "display_name": "zask", "link": "https://stackoverflow.com/users/11856269/zask"}, "edited": false, "score": 0, "creation_date": 1564514630, "post_id": 57268308, "comment_id": 101054078, "body": "It looks like a real glitch of the operating system and I cannot yet figure out how to overcome it."}, {"owner": {"reputation": 25, "user_id": 11856269, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eJwBL.jpg?s=128&g=1", "display_name": "zask", "link": "https://stackoverflow.com/users/11856269/zask"}, "edited": false, "score": 0, "creation_date": 1564514805, "post_id": 57268308, "comment_id": 101054153, "body": "@ Jeff D. In particular, as I said, there are no problems when choosing a file through a button. And in this case there is no WM_MOUSEMOVE."}], "answers": [{"tags": [], "owner": {"reputation": 25, "user_id": 11856269, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eJwBL.jpg?s=128&g=1", "display_name": "zask", "link": "https://stackoverflow.com/users/11856269/zask"}, "is_accepted": true, "score": 0, "last_activity_date": 1566370337, "last_edit_date": 1566370337, "creation_date": 1564516408, "answer_id": 57279119, "question_id": 57268308, "link": "https://stackoverflow.com/questions/57268308/superfluous-erroneous-message-in-the-windows-message-loop-of-child-window-when/57279119#57279119", "title": "Superfluous (erroneous) message in the Windows message loop of child window when selecting a file", "body": "<p>Solved the problem in a simple workaround. After double-clicking, I set the special flag to 1 and drop it to zero at the end of the WM_MOUSEMOVE message. In the message loop, I take into account the movement of the mouse only when the flag is lowered.</p>\n\n<p>It turned out that in Windows 10 a whole series of false WM_MOUSEMOVE messages is generated. Thus, in addition to the flag mentioned above, which protects against the first message, it is necessary to take advantage of the advice of R. Chen from his book \"Old New Things\" and integrate the comparison of the current message with the previous one. If they match, then the message is not taken into account.</p>\n\n<p>Adventure continues. The same spurious message appears when you double click on the window title. It is necessary also to raise the aforementioned flag when Windows sends WM_NCLBUTTONDBLCLK.</p>\n"}, {"tags": [], "owner": {"reputation": 760, "user_id": 65336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q0xWV.jpg?s=128&g=1", "display_name": "Andrew Beatty", "link": "https://stackoverflow.com/users/65336/andrew-beatty"}, "is_accepted": false, "score": 0, "last_activity_date": 1603297147, "creation_date": 1603297147, "answer_id": 64467769, "question_id": 57268308, "link": "https://stackoverflow.com/questions/57268308/superfluous-erroneous-message-in-the-windows-message-loop-of-child-window-when/64467769#64467769", "title": "Superfluous (erroneous) message in the Windows message loop of child window when selecting a file", "body": "<p>I had the same problem; the CLSID_FileOpenDialog modal dialog leaks mouse moves with MK_LBUTTON flag to any window underneath when the user double-clicks the selection (Microsoft bug). In my case the window underneath is a 3D viewport responding to these messages.</p>\n<p>I found a better solution by having the viewport track left mouse button state via the WM_LBUTTONDOWN and WM_LBUTTONUP messages. Then ignore mouse moves with MK_LBUTTON flag when button state is not down. This is cleaner (no global flags, related code all in one place).</p>\n"}], "owner": {"reputation": 25, "user_id": 11856269, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eJwBL.jpg?s=128&g=1", "display_name": "zask", "link": "https://stackoverflow.com/users/11856269/zask"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 169, "favorite_count": 1, "accepted_answer_id": 57279119, "answer_count": 2, "score": 0, "last_activity_date": 1603297147, "creation_date": 1564478395, "last_edit_date": 1565365473, "question_id": 57268308, "link": "https://stackoverflow.com/questions/57268308/superfluous-erroneous-message-in-the-windows-message-loop-of-child-window-when", "title": "Superfluous (erroneous) message in the Windows message loop of child window when selecting a file", "body": "<p>I create the main window and on it a child window and a file selection button. In the selection process, double clicking on a file results in a false message WM_MOUSEMOVE (with GetKeyState(VK_LBUTTON) &lt; 0) in the message loop of the child window. This happens in the case when the click point is over the child window. In this case, the coordinates of the click point are transferred to the lParam. If you select the file via the open button, then there is nothing like it.</p>\n\n<p>This message is not limited to the moment the file is selected: it enters the queue and fires after the selection. This can cause big problems, in particular when the child window is graphical.</p>\n\n<p>Windows 8, VS 2015, C++.</p>\n\n<p>Does anyone have any idea how to overcome this?</p>\n\n<pre><code>#include &lt;windows.h&gt;\n#include &lt;windowsx.h&gt;\n#include &lt;shobjidl_core.h&gt;      \n\n\n#define IDI_ICON                        110\n#define IDC_OPEN_FILE_BUTTON            120\n\n\n\nHWND                                g_hDwnd = NULL;\nHWND                                g_hWnd = NULL;\nHWND                                hwndOpenFile = NULL;            \n\n\nHRESULT InitWindow( HINSTANCE hInstance, int nCmdShow );\nLRESULT CALLBACK    WndProc( HWND, UINT, WPARAM, LPARAM );\nLRESULT CALLBACK    ChildProc(HWND, UINT, WPARAM, LPARAM);\n\n\nint WINAPI wWinMain( HINSTANCE hInstance, HINSTANCE hPrevInstance, LPWSTR lpCmdLine, int nCmdShow )\n{\n    UNREFERENCED_PARAMETER( hPrevInstance );\n    UNREFERENCED_PARAMETER( lpCmdLine );\n\n    if( FAILED( InitWindow( hInstance, nCmdShow ) ) )\n        return 0;\n\n    MSG msg = {0};\n\n    while( WM_QUIT != msg.message )\n    {\n        if( PeekMessage( &amp;msg, NULL, 0, 0, PM_REMOVE ) )\n        {\n            TranslateMessage( &amp;msg );\n            DispatchMessage( &amp;msg );\n        }\n\n    }\n\n     return ( int )msg.wParam;\n}\n\n\n\n\nHRESULT InitWindow( HINSTANCE hInstance, int nCmdShow )\n{\n    WNDCLASSEX wcdex;\n    wcdex.cbSize = sizeof( WNDCLASSEX );\n    wcdex.style = CS_HREDRAW | CS_VREDRAW;\n    wcdex.lpfnWndProc = WndProc;\n    wcdex.cbClsExtra = 0;\n    wcdex.cbWndExtra = 0;\n    wcdex.hInstance = hInstance;\n    wcdex.hIcon = LoadIcon( hInstance, ( LPCTSTR )IDI_ICON );\n    wcdex.hCursor = LoadCursor( NULL, IDC_ARROW );\n    wcdex.hbrBackground = ( HBRUSH )( COLOR_WINDOW + 1 );\n    wcdex.lpszMenuName = NULL;\n    wcdex.lpszClassName = L\"ParentWindowClass\";\n    wcdex.hIconSm = LoadIcon( wcdex.hInstance, ( LPCTSTR )IDI_ICON );\n\n    if( !RegisterClassEx( &amp;wcdex ) )\n        return E_FAIL;\n\n\n    g_hDwnd = CreateWindow( L\"ParentWindowClass\", L\"Test\", WS_OVERLAPPEDWINDOW,\n                           CW_USEDEFAULT, CW_USEDEFAULT, 840, 480, NULL, NULL, hInstance, NULL );\n    if( !g_hDwnd )\n        return E_FAIL;\n\n    hwndOpenFile = CreateWindowEx(0, L\"BUTTON\", L\"Open\", WS_CHILD | WS_VISIBLE | BS_PUSHBUTTON, \n                        560, 50, 100, 24, g_hDwnd, (HMENU)IDC_OPEN_FILE_BUTTON, hInstance, NULL);\n\n    ShowWindow( g_hDwnd, nCmdShow );\n    UpdateWindow(g_hDwnd);              \n\n\n    WNDCLASSEX wcex;\n    wcex.cbSize = sizeof(WNDCLASSEX);\n    wcex.style = CS_HREDRAW | CS_VREDRAW | CS_DBLCLKS;                  \n    wcex.lpfnWndProc = ChildProc;\n    wcex.cbClsExtra = 0;\n    wcex.cbWndExtra = 0;\n    wcex.hInstance = hInstance;\n    wcex.hIcon = NULL;\n    wcex.hCursor = LoadCursor(NULL, IDC_ARROW);\n    wcex.hbrBackground = CreateSolidBrush(RGB(200, 200, 205));\n    wcex.lpszMenuName = NULL;\n    wcex.lpszClassName = L\"ChildWindowClass\";\n    wcex.hIconSm = NULL;\n\n    if (!RegisterClassEx(&amp;wcex))\n        return E_FAIL;\n\n    g_hWnd = CreateWindowEx(WS_EX_APPWINDOW, L\"ChildWindowClass\", L\"test\", WS_CHILD,\n                                10, 10, 540, 460, g_hDwnd, NULL, hInstance, NULL);          \n\n    if (!g_hWnd)\n        return E_FAIL;  \n\n    ShowWindow(g_hWnd, nCmdShow);   \n    UpdateWindow(g_hWnd);       \n\n    return S_OK;\n}\n\n\n\nvoid OpenModelFile()\n{\n    char input;\n    LPWSTR g_path = NULL;   \n\n    LPWSTR szAPX = L\"Model format\";\n    COMDLG_FILTERSPEC rgSpec[] = { { szAPX, L\"*.txt\" } };\n\n    IFileDialog *pfd;\n    if (SUCCEEDED(CoCreateInstance(CLSID_FileOpenDialog, NULL, CLSCTX_INPROC_SERVER, IID_PPV_ARGS(&amp;pfd))))\n    {\n        DWORD dwOptions;\n\n        if (SUCCEEDED(pfd-&gt;GetOptions(&amp;dwOptions)))\n        {\n            pfd-&gt;SetOptions(dwOptions | FOS_STRICTFILETYPES);\n        }\n\n        if (SUCCEEDED(pfd-&gt;SetFileTypes(1, rgSpec)))\n        {\n            if (SUCCEEDED(pfd-&gt;SetDefaultExtension(L\"txt\")))\n            {\n                if (SUCCEEDED(pfd-&gt;SetFileName(L\"Model.txt\")))          \n                {\n\n                    if (SUCCEEDED(pfd-&gt;Show(NULL)))\n                    {\n                        IShellItem *psi;\n                        if (SUCCEEDED(pfd-&gt;GetResult(&amp;psi)))\n                        {\n\n                            if (SUCCEEDED(psi-&gt;GetDisplayName(SIGDN_NORMALDISPLAY, &amp;g_path)))\n                            {\n                                LPCTSTR a = L\"Path\";    \n                                MessageBox(NULL, g_path, a, NULL);\n                            }\n                            psi-&gt;Release();\n                        }\n                    }\n                }\n            }\n        }\n        pfd-&gt;Release();\n    }\n\n    return;\n\n}   \n\n\n\n\n\nLRESULT CALLBACK ChildProc(HWND hWnd, UINT message, WPARAM wParam, LPARAM lParam)\n{\n    PAINTSTRUCT ps;\n    HDC hdc;\n\n    int x ;\n    int y ;\n\n    switch (message)\n    {\n    case WM_PAINT:\n\n            hdc = BeginPaint(hWnd, &amp;ps);\n            EndPaint(hWnd, &amp;ps);\n\n        break;\n\n    case WM_MOUSEMOVE:\n\n        if (GetKeyState(VK_LBUTTON) &lt; 0)    \n        {\n\n            x = GET_X_LPARAM(lParam) ;\n            y = GET_Y_LPARAM(lParam) ;\n        }\n\n        break;\n\n    case WM_DESTROY:\n\n        PostQuitMessage(0);\n\n        break;\n\n    default:\n        return DefWindowProc(hWnd, message, wParam, lParam);\n    }\n\n    return 0;\n\n}   \n\n\n\n\nLRESULT CALLBACK WndProc( HWND hWnd, UINT message, WPARAM wParam, LPARAM lParam )\n{\n    PAINTSTRUCT ps;\n    HDC hdc;\n\n    int id = LOWORD(wParam);\n\n    switch( message )\n    {\n        case WM_PAINT:\n\n            hdc = BeginPaint( hWnd, &amp;ps );\n            EndPaint( hWnd, &amp;ps );\n\n            break;\n\n        case  WM_COMMAND:\n\n            if (id == IDC_OPEN_FILE_BUTTON)                         \n            {\n                OpenModelFile();\n            }\n\n            break;\n\n        case WM_DESTROY:\n\n            PostQuitMessage( 0 );\n            break;\n\n        default:\n            return DefWindowProc( hWnd, message, wParam, lParam );\n    }\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "linux-kernel", "stack-trace", "ebpf"], "answers": [{"tags": [], "owner": {"reputation": 4454, "user_id": 3716552, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/078Ob.jpg?s=128&g=1", "display_name": "Qeole", "link": "https://stackoverflow.com/users/3716552/qeole"}, "is_accepted": true, "score": 1, "last_activity_date": 1564480710, "creation_date": 1564480710, "answer_id": 57269039, "question_id": 57268045, "link": "https://stackoverflow.com/questions/57268045/how-to-read-stack-trace-kernelside-in-ebpf/57269039#57269039", "title": "How to read stack trace kernelside in ebpf?", "body": "<p>It is possible to access the stack traces.</p>\n\n<p>The first link you mention (bpf_design_QA) does not refer to the program being traced, it deals with the stack pointer used by the BPF program itself when performing the tracing operation. But as mentioned in the commit log for <code>bpf_get_stack()</code>, you can get access to the stack.</p>\n\n<p>There is some documentation for the BPF helpers, such as <code>bpf_get_stack()</code>, <a href=\"http://man7.org/linux/man-pages/man7/bpf-helpers.7.html\" rel=\"nofollow noreferrer\">available online</a>. You probably want to have a look at code <a href=\"https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/tools/testing/selftests/bpf/progs/test_get_stack_rawtp.c?h=v5.2\" rel=\"nofollow noreferrer\">samples using it</a> too.</p>\n\n<p>I don't have much experience myself with tracing stack, but it seems that very few tools doing so are actually using thie <code>bpf_get_stack()</code> helper. Instead, tools from bcc like <a href=\"https://github.com/iovisor/bcc/blob/master/tools/profile.py\" rel=\"nofollow noreferrer\"><code>profile</code></a> or from kernel samples like <code>offwaketime</code> (<a href=\"https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/samples/bpf/offwaketime_kern.c?h=v5.2\" rel=\"nofollow noreferrer\"><code>BPF side</code></a>, <a href=\"https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/samples/bpf/offwaketime_user.c?h=v5.2\" rel=\"nofollow noreferrer\"><code>user space side</code></a>) are generally using stack trace maps (<code>BPF_MAP_TYPE_STACK_TRACE</code>), so you may want to have a look at this too (bcc even offers a <a href=\"https://github.com/iovisor/bcc/blob/2627bae4a6f32b7d83128146d02fc779d635cf95/docs/reference_guide.md#5-bpf_stack_trace\" rel=\"nofollow noreferrer\">specific API</a> for them).</p>\n"}], "owner": {"reputation": 13, "user_id": 8370847, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KYtfJ.jpg?s=128&g=1", "display_name": "LeChatP", "link": "https://stackoverflow.com/users/8370847/lechatp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 491, "favorite_count": 1, "accepted_answer_id": 57269039, "answer_count": 1, "score": 1, "last_activity_date": 1564480710, "creation_date": 1564477600, "question_id": 57268045, "link": "https://stackoverflow.com/questions/57268045/how-to-read-stack-trace-kernelside-in-ebpf", "title": "How to read stack trace kernelside in ebpf?", "body": "<p>I would like to filter my ebpf with address in stack,\nby example if stack trace contain the address of <code>_do_fork</code> then write to map.</p>\n\n<p>I seen this <a href=\"https://www.kernel.org/doc/html/latest/bpf/bpf_design_QA.html#q-can-bpf-programs-access-stack-pointer\" rel=\"nofollow noreferrer\">https://www.kernel.org/doc/html/latest/bpf/bpf_design_QA.html#q-can-bpf-programs-access-stack-pointer</a> saying that it isn't possible to get adresses. But I also seen this <a href=\"https://www.spinics.net/lists/netdev/msg497159.html\" rel=\"nofollow noreferrer\">https://www.spinics.net/lists/netdev/msg497159.html</a>\n\"The bpf program\nis able to see all stack traces, and then can do in-kernel\nprocessing or send stack traces to user space through\". So I'm confused.\nThe final question is how we can get adresses of stack trace in-kernel with bpf_get_stack, if it is possible?</p>\n\n<p>thanks in advance</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1564477001, "post_id": 57267835, "comment_id": 101034231, "body": "<code>some negative value number</code> - change <code>int16_t</code> into <code>uint16_t</code> ?"}, {"owner": {"reputation": 628, "user_id": 10166067, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fk9rr.jpg?s=128&g=1", "display_name": "Chocorean", "link": "https://stackoverflow.com/users/10166067/chocorean"}, "edited": false, "score": 0, "creation_date": 1564477021, "post_id": 57267835, "comment_id": 101034241, "body": "I think using int16_t instead of uint16_t is you problem: the strongest bit is interpreted as a minus and not as 2^15"}, {"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 0, "creation_date": 1564477078, "post_id": 57267835, "comment_id": 101034280, "body": "After changing to <code>uint16_t</code> also change printf specifier to <code>&quot;%u\\n&quot;</code> (or <code>&quot;%&quot; PRIu16 &quot;\\n&quot;</code> with the inclusion of <code>&lt;inttypes.h&gt;</code>)"}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1564477693, "post_id": 57267835, "comment_id": 101034646, "body": "In many cases, the value isn&#39;t stored as a plain number, but with a certain encoding, which you have to decode first. Consult the specifications of the FPGA and the hardware design it runs."}], "answers": [{"tags": [], "owner": {"reputation": 25, "user_id": 5161544, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-FVZA8pluyQ8/AAAAAAAAAAI/AAAAAAAAACY/oENjlRuKTAA/photo.jpg?sz=128", "display_name": "akhil tiwari", "link": "https://stackoverflow.com/users/5161544/akhil-tiwari"}, "is_accepted": false, "score": 0, "last_activity_date": 1564484617, "last_edit_date": 1564484617, "creation_date": 1564477890, "answer_id": 57268139, "question_id": 57267835, "link": "https://stackoverflow.com/questions/57267835/read-value-from-function-returning-pointer/57268139#57268139", "title": "Read value from function returning pointer", "body": "<p>The return type of the function is a 16 bit integer, </p>\n\n<pre><code>int16_t getLastValueFromADC();\n</code></pre>\n\n<p>However the variable used to represent the result to be returned by the function is an unsigned integer.</p>\n\n<pre><code>volatile uint16_t *ip;\n</code></pre>\n\n<p>Unsigned integers are meant to be parsed by the compiler in such a way that there value is always positive. This is not the case with regular(signed) integers, in which case the MSB(most significant bit; leftmost bit) determines whether the value should be treated as postive(0) or negative(1).</p>\n"}], "owner": {"reputation": 41, "user_id": 11233325, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ec75fc7a690aebf8a9dca8dec6853e3?s=128&d=identicon&r=PG&f=1", "display_name": "shruti", "link": "https://stackoverflow.com/users/11233325/shruti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1564484617, "creation_date": 1564476854, "question_id": 57267835, "link": "https://stackoverflow.com/questions/57267835/read-value-from-function-returning-pointer", "title": "Read value from function returning pointer", "body": "<p>I am developing a code in which I need to read the value of function which returns value in pointer.</p>\n\n<p>below is the function whose value needs to be read (*ip)</p>\n\n<pre><code>int16_t getLastValueFromADC()\n{\n    volatile uint16_t *ip;\n\n    ip  = GET_FPGA_REGISTER_ADDRESS(REG_CURRENT_ADC_SAMPLE_R);\n\n#ifdef _JSB_BEHAVIOUR_0_65536\n    if (tighteningDirectionCCW)\n    {\n        tempValue = (int16_t)(*ip);\n        tempValue = (OFFSET_BB2AD - tempValue);\n    }\n    else\n    {\n        tempValue = ((*ip) + OFFSET_BB2AD);\n    }\n    return ((uint16_t)tempValue);\n#endif\n    return *ip;\n}\n</code></pre>\n\n<p>I am reading the value using below code:</p>\n\n<pre><code>int16_t vref2v5 = getLastValueFromADC();             \nprintf(\"VREF2V5 Status for Torque signal:  %d\\n\",vref2v5);\n</code></pre>\n\n<p>not getting expected values it is showing some negative value number.</p>\n\n<p>Please suggest</p>\n\n<p>Thanks &amp; Regards</p>\n"}, {"tags": ["c", "struct", "macros"], "comments": [{"owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 1, "creation_date": 1564476166, "post_id": 57267123, "comment_id": 101033740, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/36493099/array-of-macros-in-c-is-it-possible\">Array of macros in c -- is it possible</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11852870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/054ce9518522f30bd10905f59a7b1656?s=128&d=identicon&r=PG&f=1", "display_name": "Cecilia", "link": "https://stackoverflow.com/users/11852870/cecilia"}, "edited": false, "score": 0, "creation_date": 1564475293, "post_id": 57267343, "comment_id": 101033257, "body": "Ok, is there another way achieving the same thing without using structs? The thing is I cannot change the macros (they are generated) and I would rather not have to call each macro individually."}], "tags": [], "owner": {"reputation": 273, "user_id": 5102494, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-TfeMbyK3uME/AAAAAAAAAAI/AAAAAAAAABM/JUboTHdvH6I/photo.jpg?sz=128", "display_name": "Marco Sanfilippo", "link": "https://stackoverflow.com/users/5102494/marco-sanfilippo"}, "is_accepted": false, "score": 0, "last_activity_date": 1564475710, "last_edit_date": 1564475710, "creation_date": 1564475148, "answer_id": 57267343, "question_id": 57267123, "link": "https://stackoverflow.com/questions/57267123/how-to-include-macro-in-struct/57267343#57267343", "title": "How to include macro in struct", "body": "<p>Simply put: you won't.\nDont think of macros as <em>code</em>: they're just chunk of text replaced by the preprocessor before compiling your code.\nIf you need to embed code in a struct, you better look at function pointers.</p>\n\n<p>--- EDIT ---</p>\n\n<p>By the way, why you want to use macro in your code? Looking at it, it seems you cand do the same thing with a simple function returning a struct with a different content based on a parameter, like:</p>\n\n<pre><code>static struct CAN_Rx getCANrx(int index){\n    switch(index)\n    {\n    case '0':\n        struct CAN_rx res = /* initialize struct */;\n        return res;\n    case '1':\n        /* as previous */\n    default:\n        /* manage default result or errors */\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9545, "user_id": 5295429, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XcJZr.png?s=128&g=1", "display_name": "Oo.oO", "link": "https://stackoverflow.com/users/5295429/oo-oo"}, "is_accepted": false, "score": 0, "last_activity_date": 1564475719, "creation_date": 1564475719, "answer_id": 57267490, "question_id": 57267123, "link": "https://stackoverflow.com/questions/57267123/how-to-include-macro-in-struct/57267490#57267490", "title": "How to include macro in struct", "body": "<p>Maybe you can go with function pointers?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint Data_CAN_SES_Enbl() { return 0; }\nint Data_CAN_SAS_Enbl() { return 1; }\nint Data_CAN_PEP_Enbl() { return 2; }\n\nstruct CAN_Rx {\n    const int id;\n    const int bus;\n    int (*xx)();\n};\n\nstatic struct CAN_Rx CheckRx[] = {\n    /* SES */\n    {\n        0,0,Data_CAN_SES_Enbl\n    },\n    /* SAS */\n    {\n       1,0,Data_CAN_SAS_Enbl\n    },\n    /* PEP */\n    {\n       2,1,Data_CAN_PEP_Enbl\n    }\n};\n\nint run(int index)\n{\n    int enabled = (*CheckRx[index].xx)();\n    return enabled;\n}\n\nint main() {\n  printf(\"%d\\n\",run(0));\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 354, "user_id": 11727918, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-bTaZpiC4KJ8/AAAAAAAAAAI/AAAAAAAAABQ/ycG-qmsyeCA/photo.jpg?sz=128", "display_name": "J CHEN", "link": "https://stackoverflow.com/users/11727918/j-chen"}, "is_accepted": false, "score": 0, "last_activity_date": 1564479088, "creation_date": 1564479088, "answer_id": 57268545, "question_id": 57267123, "link": "https://stackoverflow.com/questions/57267123/how-to-include-macro-in-struct/57268545#57268545", "title": "How to include macro in struct", "body": "<p>If you are curious see below macro example.</p>\n\n<p>For your case , macro cant be better than  function pointers.</p>\n\n<p>Using macro just for fun at your case.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#define Data_CAN_SES_Enbl(Y,Z) Y+Z\n#define Data_CAN_SAS_Enbl(Y,Z) Y*Z\n#define Data_CAN_PEP_Enbl(Y,Z) Y-Z\n#define Str(X) #X\n\n\n#define Data_CAN_Enbl(X,Y,Z) Data_CAN_##X##_Enbl(Y,Z);\n\n#define SES 1\n#define SAS 2\n#define PEP 3\n\nstruct CAN_Rx {\n    int id;                     \n    int bus;\n    int Flag;\n};\n\nstatic struct CAN_Rx CheckRx[] = {\n    /* SES */\n    {\n        0,100,SES\n    },\n    /* SAS */\n    {\n       70,20,SAS\n    },\n    /* PEP */\n    {\n       100,50,PEP\n    }\n};\n\nvoid run(int index)\n{\n    int RRR=0;\n\n    switch(CheckRx[index].Flag){\n        case SES:\n            RRR=Data_CAN_Enbl(SES,CheckRx[index].id,CheckRx[index].bus);\n            printf(\"%s :%d\\n\",_Str(SES),RRR);\n        break;\n        case SAS:\n            RRR=Data_CAN_Enbl(SAS,CheckRx[index].id,CheckRx[index].bus);\n            printf(\"%s :%d\\n\",_Str(SAS),RRR);\n        break;\n        case PEP:\n            RRR=Data_CAN_Enbl(PEP,CheckRx[index].id,CheckRx[index].bus);\n            printf(\"%s :%d\\n\",_Str(PEP),RRR);\n        break;\n    }\n\n}\nint main(){\n\n\n\n    run(0);\n    run(1);\n    run(2);\n\n\n    printf(\"%d\\n\",CheckRx[0].Flag);\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11852870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/054ce9518522f30bd10905f59a7b1656?s=128&d=identicon&r=PG&f=1", "display_name": "Cecilia", "link": "https://stackoverflow.com/users/11852870/cecilia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 101, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1564479088, "creation_date": 1564474341, "last_edit_date": 1564475138, "question_id": 57267123, "link": "https://stackoverflow.com/questions/57267123/how-to-include-macro-in-struct", "title": "How to include macro in struct", "body": "<p>I am trying to find a way to dynamically access a certain macro in C. </p>\n\n<p>I tried to include the macro in the struct but then I get the \"initializer element is not constant\" error. Basically I just want to access the correct macro based on an index but I just don't know how. Is there a straight forward way of accomplishing this? Please note the code is not complete but only an illustration of what I want to do.</p>\n\n<pre><code>#define Data_CAN_SES_Enbl() (...)\n#define Data_CAN_SAS_Enbl() (...)\n#define Data_CAN_PEP_Enbl() (...)\n\n\nstruct CAN_Rx {\n    const uint8 id;                     \n    const uint8 bus;                    \n    xx\n};\n\nstatic struct CAN_Rx CheckRx[] = {\n    /* SES */\n    {\n        0,0,?\n    },\n    /* SAS */\n    {\n       1,0,?\n    },\n    /* PEP */\n    {\n       2,1,?\n    }\n};\n\nvoid run(uint8 index)\n{\n    uint8 enabled = CheckRx[index].xx;\n}\n</code></pre>\n"}]