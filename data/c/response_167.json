[{"tags": ["c", "volatile"], "answers": [{"comments": [{"owner": {"reputation": 123967, "user_id": 251153, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4b25144c09555e7d5b5e288469e011ef?s=128&d=identicon&r=PG", "display_name": "zneak", "link": "https://stackoverflow.com/users/251153/zneak"}, "edited": false, "score": 2, "creation_date": 1521678475, "post_id": 49418454, "comment_id": 85838942, "body": "Interrupt contexts are precisely one of the, like, 3 cases where volatile <i>is</i> enough."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1521680003, "post_id": 49418454, "comment_id": 85839257, "body": "Given &quot;func2 is called under interrupt context&quot;, your posted code will result in a deadlock if <code>func1</code> is interrupted while it holds the lock.  Locks make interrupt handlers, and all functions at that, async-signal-<b>unsafe</b>."}, {"owner": {"reputation": 5867, "user_id": 2252087, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/020cbe41b02f03d59f3adae022c0ce7d?s=128&d=identicon&r=PG", "display_name": "ensc", "link": "https://stackoverflow.com/users/2252087/ensc"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1521682120, "post_id": 49418454, "comment_id": 85839682, "body": "@AndrewHenle why? code is an example only and the depending on the system, <code>lock()</code> can be implemented e.g. by disabling interrupts ."}, {"owner": {"reputation": 5867, "user_id": 2252087, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/020cbe41b02f03d59f3adae022c0ce7d?s=128&d=identicon&r=PG", "display_name": "ensc", "link": "https://stackoverflow.com/users/2252087/ensc"}, "reply_to_user": {"reputation": 123967, "user_id": 251153, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4b25144c09555e7d5b5e288469e011ef?s=128&d=identicon&r=PG", "display_name": "zneak", "link": "https://stackoverflow.com/users/251153/zneak"}, "edited": false, "score": 0, "creation_date": 1521682268, "post_id": 49418454, "comment_id": 85839720, "body": "@zneak no; when thread <code>func2()</code> is run on a second core, changes done in core 1 might never reach it.  <code>volatile</code> is for the compiler only and does not say anything about parallel execution."}], "tags": [], "owner": {"reputation": 5867, "user_id": 2252087, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/020cbe41b02f03d59f3adae022c0ce7d?s=128&d=identicon&r=PG", "display_name": "ensc", "link": "https://stackoverflow.com/users/2252087/ensc"}, "is_accepted": false, "score": 0, "last_activity_date": 1521682544, "last_edit_date": 1521682544, "creation_date": 1521676923, "answer_id": 49418454, "question_id": 49418327, "link": "https://stackoverflow.com/questions/49418327/volatile-and-variable-modification-in-c/49418454#49418454", "title": "volatile and variable modification in C", "body": "<p>no. <code>volatile</code> is not enough.  You have both to set an optimization barrier for the compiler (which <strong>can</strong> be <code>volatile</code>) and for the processor.  E.g. when a CPU core writes data, this can go into some cache and won't be visible for another core.</p>\n\n<p>Usually, you need some locking in your code (spin locks, or mutex).  Such functions contain usually an optimization barrier so you do not need an <code>volatile</code>.</p>\n\n<p>Your code is racy, with proper locking it would look like</p>\n\n<pre><code>void func1(TsMyStruct* myStruct)\n{\n    lock();\n    myStruct-&gt;inc1 += 1;\n    unlock();\n}\n\nvoid func2(TsMyStruct* myStruct)\n{\n    lock();\n    myStruct-&gt;inc1 += 2;\n    unlock();\n    myStruct-&gt;inc1 += 3;\n}\n</code></pre>\n\n<p>and the <code>lock()</code> + <code>unlock()</code> functions contain optimization barriers (e.g. <code>__asm__ __volatile__(\"\" ::: \"memory\")</code> or just a call to a global function) which will cause the compiler to reload <code>myStruct</code>.</p>\n\n<p>For nitpicking: <code>lock()</code> and <code>unlock()</code> are expected to do the right thing (e.g. disable irqs).  Real world implementations would be e.g. <code>spin_lock_irqsave()</code> + <code>spin_lock_irqrestore()</code> in linux.</p>\n"}, {"comments": [{"owner": {"reputation": 5867, "user_id": 2252087, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/020cbe41b02f03d59f3adae022c0ce7d?s=128&d=identicon&r=PG", "display_name": "ensc", "link": "https://stackoverflow.com/users/2252087/ensc"}, "edited": false, "score": 1, "creation_date": 1521684204, "post_id": 49418686, "comment_id": 85840161, "body": "you still need synchronization (even on one-processor systems).  E.g. what happens when interrupt fires in the middle (between load + store) of the <code>+=</code>?  Because synchronization usually provides an optimization barrier the <code>volatile</code> is pointless."}, {"owner": {"reputation": 123967, "user_id": 251153, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4b25144c09555e7d5b5e288469e011ef?s=128&d=identicon&r=PG", "display_name": "zneak", "link": "https://stackoverflow.com/users/251153/zneak"}, "reply_to_user": {"reputation": 5867, "user_id": 2252087, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/020cbe41b02f03d59f3adae022c0ce7d?s=128&d=identicon&r=PG", "display_name": "ensc", "link": "https://stackoverflow.com/users/2252087/ensc"}, "edited": false, "score": 0, "creation_date": 1521684741, "post_id": 49418686, "comment_id": 85840302, "body": "@ensc, visually speaking, it would seem to me that approximately 80% of my answer is dedicated to that issue."}, {"owner": {"reputation": 190, "user_id": 7176709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e179e3c0c654ceffd3b0224a22f7a83?s=128&d=identicon&r=PG&f=1", "display_name": "awakened", "link": "https://stackoverflow.com/users/7176709/awakened"}, "reply_to_user": {"reputation": 5867, "user_id": 2252087, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/020cbe41b02f03d59f3adae022c0ce7d?s=128&d=identicon&r=PG", "display_name": "ensc", "link": "https://stackoverflow.com/users/2252087/ensc"}, "edited": false, "score": 0, "creation_date": 1521695463, "post_id": 49418686, "comment_id": 85842934, "body": "@ensc, I think we are supposed to use atomic addition operation. I maybe wrong."}, {"owner": {"reputation": 5867, "user_id": 2252087, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/020cbe41b02f03d59f3adae022c0ce7d?s=128&d=identicon&r=PG", "display_name": "ensc", "link": "https://stackoverflow.com/users/2252087/ensc"}, "reply_to_user": {"reputation": 190, "user_id": 7176709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e179e3c0c654ceffd3b0224a22f7a83?s=128&d=identicon&r=PG&f=1", "display_name": "awakened", "link": "https://stackoverflow.com/users/7176709/awakened"}, "edited": false, "score": 0, "creation_date": 1521716858, "post_id": 49418686, "comment_id": 85855108, "body": "@user7176709 atomic operations work for the <code>+=</code> case.  But  <code>volatile</code> is neither enough to implement such operations nor is it needed."}, {"owner": {"reputation": 123967, "user_id": 251153, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4b25144c09555e7d5b5e288469e011ef?s=128&d=identicon&r=PG", "display_name": "zneak", "link": "https://stackoverflow.com/users/251153/zneak"}, "reply_to_user": {"reputation": 5867, "user_id": 2252087, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/020cbe41b02f03d59f3adae022c0ce7d?s=128&d=identicon&r=PG", "display_name": "ensc", "link": "https://stackoverflow.com/users/2252087/ensc"}, "edited": false, "score": 0, "creation_date": 1521734330, "post_id": 49418686, "comment_id": 85868168, "body": "@ensc, we all agree that <code>func1</code> needs to be able to operate atomically over <code>myStruct</code>. Where we don&#39;t agree is OP&#39;s unspoken context: you assume kernel development for a multi-core machine and I assume a small embedded board."}, {"owner": {"reputation": 5867, "user_id": 2252087, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/020cbe41b02f03d59f3adae022c0ce7d?s=128&d=identicon&r=PG", "display_name": "ensc", "link": "https://stackoverflow.com/users/2252087/ensc"}, "edited": false, "score": 0, "creation_date": 1521763786, "post_id": 49418686, "comment_id": 85882850, "body": "@zneak <code>volatile</code> is the wrong choice for both use cases.  Use it in simple things like <code>while (!flag) {}</code>, but not in code which is already protected by some other optimization barriers (e.g.  synchronization methods)."}], "tags": [], "owner": {"reputation": 123967, "user_id": 251153, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4b25144c09555e7d5b5e288469e011ef?s=128&d=identicon&r=PG", "display_name": "zneak", "link": "https://stackoverflow.com/users/251153/zneak"}, "is_accepted": false, "score": 2, "last_activity_date": 1521682809, "last_edit_date": 1521682809, "creation_date": 1521678745, "answer_id": 49418686, "question_id": 49418327, "link": "https://stackoverflow.com/questions/49418327/volatile-and-variable-modification-in-c/49418686#49418686", "title": "volatile and variable modification in C", "body": "<p>Yes, any memory that is used both inside and outside of an interrupt handler should be <code>volatile</code>, including structs and arrays, and pointers passed as function parameters. Assuming that you are targeting a single-core device, you do not need additional synchronization.</p>\n\n<p>Still, you have to consider that <code>func1</code> could be interrupted anywhere, which may lead to inconsistent results if you're not careful. For instance, consider this:</p>\n\n<pre><code>void func1(volatile TsMyStruct* myStruct)\n{\n    myStruct-&gt;inc1 += 1;\n    if (myStruct-&gt;inc1 == 4)\n    {\n        print(myStruct-&gt;inc1); // assume \"print\" exists\n    }\n}\n\nvoid func2(volatile TsMyStruct* myStruct)\n{\n    myStruct-&gt;inc1 += 2;\n    myStruct-&gt;inc2 += 3;\n}\n</code></pre>\n\n<p>Since interrupts are asynchronous, this could print numbers different from 4. That would happen, for instance, if <code>func1</code>\u00a0is interrupted after the check but before the <code>print</code> call.</p>\n"}], "owner": {"reputation": 861, "user_id": 1651499, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/abe7235d2a5944f6656545de90ebe2c4?s=128&d=identicon&r=PG", "display_name": "rem", "link": "https://stackoverflow.com/users/1651499/rem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 2, "answer_count": 2, "score": 1, "last_activity_date": 1521682809, "creation_date": 1521676067, "last_edit_date": 1521676725, "question_id": 49418327, "link": "https://stackoverflow.com/questions/49418327/volatile-and-variable-modification-in-c", "title": "volatile and variable modification in C", "body": "<p>A structure TsMyStruct is given as parameter to some functions :</p>\n\n<pre><code>typedef struct\n{\n    uint16_t inc1;\n    uint16_t inc2;\n}TsMyStruct;\n\n\nvoid func1(TsMyStruct* myStruct)\n{\n    myStruct-&gt;inc1 += 1;\n}\n\nvoid func2(TsMyStruct* myStruct)\n{\n    myStruct-&gt;inc1 += 2;\n    myStruct-&gt;inc2 += 3;\n}\n</code></pre>\n\n<p>func1 is called under non-interrupt context and func2 is called under interrupt context. Call stack of func2 has an interrupt vector as origin. C compiler does not know func2 can be called (but code isn't considered as \"unused\" code as linker needs it in interrupt vector table memory section), so some code reading myStruct->inc2 outside func2 can be possibly optimized preventing  myStruct->inc2 to be reloaded from ram. It is true for C basic types, but is it true for inc2 structure member or some array...? Is it true for function parameters?</p>\n\n<p>As a general rule, can I say \"every memory zone (of basic type? or not?) modified in interrupt context and read elsewhere must be declared as volatile\"?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 2, "creation_date": 1521675250, "post_id": 49418167, "comment_id": 85838112, "body": "suggestion #1 - show us the code you have written that doesnt work"}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1521675316, "post_id": 49418167, "comment_id": 85838129, "body": "i did nt look, but perhaps you will find what you need here <a href=\"https://graphics.stanford.edu/~seander/bithacks.html\" rel=\"nofollow noreferrer\">graphics.stanford.edu/~seander/bithacks.html</a>"}, {"owner": {"reputation": 49, "user_id": 9124975, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5bf0bee0440a87c722448ca9c66a607?s=128&d=identicon&r=PG&f=1", "display_name": "Darren", "link": "https://stackoverflow.com/users/9124975/darren"}, "reply_to_user": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1521675429, "post_id": 49418167, "comment_id": 85838147, "body": "I added my code."}, {"owner": {"reputation": 21326, "user_id": 1679849, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpvxY.png?s=128&g=1", "display_name": "r3mainer", "link": "https://stackoverflow.com/users/1679849/r3mainer"}, "edited": false, "score": 0, "creation_date": 1521675875, "post_id": 49418167, "comment_id": 85838302, "body": "You&#39;re getting an answer of 3 because <code>101 &lt;&lt; 3 = 101000</code> and <code>101000 &amp; 111101 = 101000</code>. You need to mask off the unused bits of <code>pattern</code> somehow."}, {"owner": {"reputation": 3561, "user_id": 2511795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30c869f55cbcf82a7bc4536d563daa0a?s=128&d=identicon&r=PG", "display_name": "0andriy", "link": "https://stackoverflow.com/users/2511795/0andriy"}, "edited": false, "score": 0, "creation_date": 1521676328, "post_id": 49418167, "comment_id": 85838432, "body": "Your pattern is not a mask. To get mask out of given pattern you have to find last set bit and derive a mask from it. Let\u2019s assume we have a function <i>int fls(unsigned long value)</i>, which returns 0, if value is 0, and last set bit number + 1 otherwise. Then <i>mask  = (1 &lt;&lt; fls(pattern)) - 1;</i>, and <i>if ((num &amp; (mask &lt;&lt; i)) == (pattern &lt;&lt; i))</i>. Of course you have to take care about 0 case, and better to use right shifts than left to prevent overflows."}], "answers": [{"comments": [{"owner": {"reputation": 49, "user_id": 9124975, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5bf0bee0440a87c722448ca9c66a607?s=128&d=identicon&r=PG&f=1", "display_name": "Darren", "link": "https://stackoverflow.com/users/9124975/darren"}, "edited": false, "score": 0, "creation_date": 1521677203, "post_id": 49418330, "comment_id": 85838663, "body": "So you are saying do bitmask &amp; original? I don&#39;t understand how you end up with 00000000000000000000000000000001 if you did that."}, {"owner": {"reputation": 44, "user_id": 9161695, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a34310ff11f1b0221843dbb5deb00fa?s=128&d=identicon&r=PG&f=1", "display_name": "Vilyanare", "link": "https://stackoverflow.com/users/9161695/vilyanare"}, "reply_to_user": {"reputation": 49, "user_id": 9124975, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5bf0bee0440a87c722448ca9c66a607?s=128&d=identicon&r=PG&f=1", "display_name": "Darren", "link": "https://stackoverflow.com/users/9124975/darren"}, "edited": false, "score": 0, "creation_date": 1521677428, "post_id": 49418330, "comment_id": 85838714, "body": "Sorry I had that backwards.  I changed the bitmask.  It will work now to get the last three of the pattern. @Darren"}], "tags": [], "owner": {"reputation": 44, "user_id": 9161695, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a34310ff11f1b0221843dbb5deb00fa?s=128&d=identicon&r=PG&f=1", "display_name": "Vilyanare", "link": "https://stackoverflow.com/users/9161695/vilyanare"}, "is_accepted": true, "score": -1, "last_activity_date": 1521677391, "last_edit_date": 1521677391, "creation_date": 1521676079, "answer_id": 49418330, "question_id": 49418167, "link": "https://stackoverflow.com/questions/49418167/finding-certain-pattern-of-bits-in-an-unsigned-integer/49418330#49418330", "title": "Finding certain pattern of bits in an unsigned integer", "body": "<p>In this case you could make a bitmask that 0's out all the spaces you aren't looking for so in this case</p>\n\n<p>Pattern: 00000000000000000000000000000101</p>\n\n<p>Bitmask: 00000000000000000000000000000111</p>\n\n<p>So in the case of the number you are looking at</p>\n\n<p>Original: 00000000000000010100001111111001</p>\n\n<p>If you and that with this bitmask you end of with</p>\n\n<p>Number after &amp;: 00000000000000000000000000000001</p>\n\n<p>And compare the new number with your pattern to see if equal.</p>\n\n<p>Then >> the original number</p>\n\n<p>Original:      00000000000000010100001111111001</p>\n\n<p>Right shifted: 00000000000000001010000111111100</p>\n\n<p>And repeat the &amp; and compare to check the next 3 numbers in the sequence.</p>\n"}, {"tags": [], "owner": {"reputation": 5867, "user_id": 2252087, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/020cbe41b02f03d59f3adae022c0ce7d?s=128&d=identicon&r=PG", "display_name": "ensc", "link": "https://stackoverflow.com/users/2252087/ensc"}, "is_accepted": false, "score": 0, "last_activity_date": 1521677961, "creation_date": 1521677961, "answer_id": 49418592, "question_id": 49418167, "link": "https://stackoverflow.com/questions/49418167/finding-certain-pattern-of-bits-in-an-unsigned-integer/49418592#49418592", "title": "Finding certain pattern of bits in an unsigned integer", "body": "<pre><code>    for (int i=0; i&lt;32; i++)\n    {\n            if ((num &amp; (pattern &lt;&lt; i)) == (pattern &lt;&lt; i))\n</code></pre>\n\n<p>is bad:\n- it works only when pattern consists of <code>1</code> entirely\n- you generate at the end of the loop <code>pattern &lt;&lt; 31</code> which is <code>0</code> when pattern is even. Condition will hold every time then.</p>\n\n<p>Knowing the length of the pattern would simplify the loop above; just go until <code>32 - size</code>.  When not given by the API, the length can be calculated either by a <code>clz()</code> function or manually by looping over the bits.</p>\n\n<p>Now, you can generate the mask as <code>mask = (1u &lt;&lt; length) - 1u</code> (note: you have to handle the <code>length == 32</code> case in a special way) and write</p>\n\n<pre><code>for (int i=0; i &lt; (32 - length); i++)\n{\n        if ((num &amp; (mask &lt;&lt; i)) == (pattern &lt;&lt; i))\n</code></pre>\n\n<p>or</p>\n\n<pre><code>for (int i=0; i &lt; (32 - length); i++)\n{\n        if (((num &gt;&gt; i) &amp; mask) == pattern)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3561, "user_id": 2511795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30c869f55cbcf82a7bc4536d563daa0a?s=128&d=identicon&r=PG", "display_name": "0andriy", "link": "https://stackoverflow.com/users/2511795/0andriy"}, "edited": false, "score": 0, "creation_date": 1521713978, "post_id": 49418728, "comment_id": 85852910, "body": "You have an overflow condition if msb = 31. That\u2019s why I told in my comment about right shifts. Moreover some compilers have intrinsic to find last set bit."}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "reply_to_user": {"reputation": 3561, "user_id": 2511795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30c869f55cbcf82a7bc4536d563daa0a?s=128&d=identicon&r=PG", "display_name": "0andriy", "link": "https://stackoverflow.com/users/2511795/0andriy"}, "edited": false, "score": 0, "creation_date": 1521724544, "post_id": 49418728, "comment_id": 85860666, "body": "@0andriy you&#39;re right, I didn&#39;t thought about msb == 31. I&#39;ll fix the code later, right now I&#39;m at work."}], "tags": [], "owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "is_accepted": false, "score": 0, "last_activity_date": 1521679042, "creation_date": 1521679042, "answer_id": 49418728, "question_id": 49418167, "link": "https://stackoverflow.com/questions/49418167/finding-certain-pattern-of-bits-in-an-unsigned-integer/49418728#49418728", "title": "Finding certain pattern of bits in an unsigned integer", "body": "<p><code>((num &amp; (pattern &lt;&lt; i)) == (pattern &lt;&lt; i))</code> won't give you the desire results.</p>\n\n<p>Let's say you pattern is <code>0b101</code> and the value is <code>0b1111</code>, then</p>\n\n<pre><code>   0101   pattern\n   1111   value\n &amp; ----\n   0101   pattern\n</code></pre>\n\n<p>Even though the value has not the pattern <code>0b101</code>, the check would return true.</p>\n\n<p>You've got to create a mask where all bits of the pattern (until the most\nsignificant bit) are 1 and the rest are 0. So for the pattern <code>0b101</code> the mask\nmust be <code>b111</code>.</p>\n\n<p>So first you need to calculate the position of the most significant bit of the pattern, then create\nthe mask and then you can apply (bitwise AND) the mask to the value. If the\nresult is the same as the pattern, then you've found your pattern:</p>\n\n<pre><code>int find_sequence(unsigned int num, unsigned int pattern)\n{\n    unsigned int copy = pattern;\n\n    // checking edge cases\n    if(num == 0 &amp;&amp; pattern == 0)\n        return 0;\n\n    if(num == 0)\n        return -1;\n\n    // calculating msb of pattern\n    int msb = -1;\n    while(copy)\n    {\n        msb++;\n        copy &gt;&gt;= 1;\n    }\n\n    printf(\"msb of pattern at pos: %d\\n\", msb);\n\n    // creating mask\n    unsigned int mask = (1U &lt;&lt; msb + 1) - 1;\n\n    int pos = 0;\n    while(num)\n    {\n\n        if((num &amp; mask) == pattern)\n            return pos;\n\n        num &gt;&gt;= 1;\n        pos++;\n    }\n\n    return -1;\n}\n</code></pre>\n\n<p>Using this function I get the value 14, where your <code>0b101</code> pattern is found in\n<code>a</code>.</p>\n"}], "owner": {"reputation": 49, "user_id": 9124975, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5bf0bee0440a87c722448ca9c66a607?s=128&d=identicon&r=PG&f=1", "display_name": "Darren", "link": "https://stackoverflow.com/users/9124975/darren"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "accepted_answer_id": 49418330, "answer_count": 3, "score": 0, "last_activity_date": 1521679042, "creation_date": 1521675032, "last_edit_date": 1521675660, "question_id": 49418167, "link": "https://stackoverflow.com/questions/49418167/finding-certain-pattern-of-bits-in-an-unsigned-integer", "title": "Finding certain pattern of bits in an unsigned integer", "body": "<p>I am reviewing for an exam and have a practice problem that I'm stuck on.</p>\n\n<p>I need to write the function <code>find_sequence(unsigned int num, unsigned int patter) {}.</code></p>\n\n<p>I have tried comparing <code>num &amp; (pattern &lt;&lt; i) == (pattern &lt;&lt; i)</code> and other things like that but it keeps saying there is a pattern when there isn't. I see why it is doing that but I can not fix it.</p>\n\n<p>The <code>num</code> I'm using is <code>unsigned int a = 82937</code> and I'm searching for pattern <code>unsigned int b = 0x05</code>.</p>\n\n<pre><code>Pattern:         00000000000000000000000000000101\nOriginal bitmap: 00000000000000010100001111111001\n</code></pre>\n\n<p>The code so far:</p>\n\n<pre><code>int find_sequence(unsigned int num, unsigned int pattern)\n{\n        for (int i=0; i&lt;32; i++)\n        {\n                if ((num &amp; (pattern &lt;&lt; i)) == (pattern &lt;&lt; i))\n                {\n                        return i;\n                }\n        }\n\n        return -9999;\n}\n\nint\nmain()\n{\n    unsigned int a = 82937;\n    unsigned int b = 0x05;\n\n    printf(\"Pattern: \");\n    printBits(b);\n    printf(\"\\n\");\n\n    printf(\"Original bitmap: \");\n    printBits(a);\n    printf(\"\\n\");\n\n    int test = find_sequence(a, b);\n    printf(\"%d\\n\", test);\n\n    return 0;\n}\n</code></pre>\n\n<p>Here is what I have so far. This keeps returning 3, and I see why but I do not know how to avoid it.</p>\n"}, {"tags": ["c", "jenkins", "gnu-make"], "answers": [{"comments": [{"owner": {"reputation": 69991, "user_id": 939557, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/3VPea.png?s=128&g=1", "display_name": "MadScientist", "link": "https://stackoverflow.com/users/939557/madscientist"}, "edited": false, "score": 2, "creation_date": 1521679136, "post_id": 49418021, "comment_id": 85839084, "body": "FYI you need GNU make 4.0 or better for output sync support."}, {"owner": {"reputation": 500, "user_id": 1905648, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99548b03567289b889d232eeb52365f9?s=128&d=identicon&r=PG", "display_name": "skelliam", "link": "https://stackoverflow.com/users/1905648/skelliam"}, "reply_to_user": {"reputation": 69991, "user_id": 939557, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/3VPea.png?s=128&g=1", "display_name": "MadScientist", "link": "https://stackoverflow.com/users/939557/madscientist"}, "edited": false, "score": 0, "creation_date": 1521723326, "post_id": 49418021, "comment_id": 85859735, "body": "Thank you immibis.  There it is, right in the docs.  I appreciate being able to ask a question in plain English -- I didn&#39;t know what to search for in the docs, and according to @MadScientist I wouldn&#39;t have found anything as I need Make 4.0+ and I&#39;m using 3.8 at the moment.  Thanks so much for both of your comments."}, {"owner": {"reputation": 69991, "user_id": 939557, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/3VPea.png?s=128&g=1", "display_name": "MadScientist", "link": "https://stackoverflow.com/users/939557/madscientist"}, "edited": false, "score": 0, "creation_date": 1521728748, "post_id": 49418021, "comment_id": 85864005, "body": "There is no version 3.8.  You mean 3.80?  That&#39;s really old: released in 2002!  Just to note, the online docs are always for the latest version so you would have found it there, but the option would not have worked on your older version of GNU make."}, {"owner": {"reputation": 500, "user_id": 1905648, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99548b03567289b889d232eeb52365f9?s=128&d=identicon&r=PG", "display_name": "skelliam", "link": "https://stackoverflow.com/users/1905648/skelliam"}, "reply_to_user": {"reputation": 69991, "user_id": 939557, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/3VPea.png?s=128&g=1", "display_name": "MadScientist", "link": "https://stackoverflow.com/users/939557/madscientist"}, "edited": false, "score": 0, "creation_date": 1521729922, "post_id": 49418021, "comment_id": 85864878, "body": "3.81 is what I&#39;m using, @MadScientist"}, {"owner": {"reputation": 69991, "user_id": 939557, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/3VPea.png?s=128&g=1", "display_name": "MadScientist", "link": "https://stackoverflow.com/users/939557/madscientist"}, "edited": false, "score": 0, "creation_date": 1521741818, "post_id": 49418021, "comment_id": 85872999, "body": "3.81 was released 12 years ago so... only very old :p :)"}, {"owner": {"reputation": 500, "user_id": 1905648, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99548b03567289b889d232eeb52365f9?s=128&d=identicon&r=PG", "display_name": "skelliam", "link": "https://stackoverflow.com/users/1905648/skelliam"}, "edited": false, "score": 0, "creation_date": 1521755033, "post_id": 49418021, "comment_id": 85879875, "body": "I&#39;m aware but -- make is make.  If I&#39;m able to build and pass my tests make 3.81, there is no reason for to update it unless I need a new feature like --output-sync."}], "tags": [], "owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "is_accepted": true, "score": 1, "last_activity_date": 1521681059, "last_edit_date": 1592644375, "creation_date": 1521674184, "answer_id": 49418021, "question_id": 49418008, "link": "https://stackoverflow.com/questions/49418008/compiler-warnings-clobber-when-running-make-with-multiple-jobs/49418021#49418021", "title": "Compiler warnings clobber when running make with multiple jobs", "body": "<p>Use the --output-sync option. This feature was added in version 4.0 of GNU Make.</p>\n<p>As per the <a href=\"https://www.gnu.org/software/make/manual/html_node/Options-Summary.html\" rel=\"nofollow noreferrer\">GNU Make manual</a>:</p>\n<blockquote>\n<p><code>--output-sync[=type]</code></p>\n<p>Ensure that the complete output from each recipe is printed in one uninterrupted sequence. This option is only useful when using the --jobs option to run multiple recipes simultaneously (see Parallel Execution) Without this option output will be displayed as it is generated by the recipes.</p>\n</blockquote>\n"}], "owner": {"reputation": 500, "user_id": 1905648, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99548b03567289b889d232eeb52365f9?s=128&d=identicon&r=PG", "display_name": "skelliam", "link": "https://stackoverflow.com/users/1905648/skelliam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 203, "favorite_count": 0, "accepted_answer_id": 49418021, "answer_count": 1, "score": 0, "last_activity_date": 1521681059, "creation_date": 1521674051, "question_id": 49418008, "link": "https://stackoverflow.com/questions/49418008/compiler-warnings-clobber-when-running-make-with-multiple-jobs", "title": "Compiler warnings clobber when running make with multiple jobs", "body": "<p>I'm running a make with multiple jobs (-j4) on Windows.  At the end of the build, I have Jenkins scrape the console log and collect the number and type of compiler warnings.  The problem (I think) is that the multiple make jobs all have the same stdout, so occasionally (less often than you might think) the output of one job gets clobbered by the output of another job.  For example:</p>\n\n<pre><code>ctc W549: D:\\path\\to\\filename.c 10000/3 condition is always true\nctc W549: D:\\path\\to\\file^ctc W588: D:\\path\\to\\somefile.c dead assignment eliminated\nname.c 10000/3 condition is always true\n</code></pre>\n\n<p>In line 2 above, I inserted a caret where one warning got chopped.  Line 3 is what <em>should</em> have been after the caret on line 2.</p>\n\n<p>It seems like the jobs all flush their stdout buffers to the console at different times; is there any way to mitigate this?  The problem is that the warning scraper has trouble with the partially clobbered lines.</p>\n\n<p>One option is to use -j1, but I'd like to continue to take advantage of multiple cores if possible.</p>\n"}, {"tags": ["c", "ceph"], "comments": [{"owner": {"reputation": 2771, "user_id": 1887370, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/08bf95201cabfe02acc28041cff862ff?s=128&d=identicon&r=PG", "display_name": "sakurashinken", "link": "https://stackoverflow.com/users/1887370/sakurashinken"}, "edited": false, "score": 0, "creation_date": 1521675030, "post_id": 49418003, "comment_id": 85838053, "body": "what was your error? Please post it."}, {"owner": {"reputation": 37, "user_id": 9519333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/beb284e51e0dfe7c965651f4233e1f69?s=128&d=identicon&r=PG&f=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/9519333/vishal"}, "reply_to_user": {"reputation": 2771, "user_id": 1887370, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/08bf95201cabfe02acc28041cff862ff?s=128&d=identicon&r=PG", "display_name": "sakurashinken", "link": "https://stackoverflow.com/users/1887370/sakurashinken"}, "edited": false, "score": 0, "creation_date": 1521675453, "post_id": 49418003, "comment_id": 85838156, "body": "when i run the application, after few seconds it stops working"}], "owner": {"reputation": 37, "user_id": 9519333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/beb284e51e0dfe7c965651f4233e1f69?s=128&d=identicon&r=PG&f=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/9519333/vishal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 68, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1572878407, "creation_date": 1521674008, "last_edit_date": 1572878407, "question_id": 49418003, "link": "https://stackoverflow.com/questions/49418003/how-do-i-set-a-watch-on-an-object-in-ceph", "title": "How do i set a watch on an object in ceph?", "body": "<p>I am trying to keep a watch on an object in Ceph, but I don't know how to do it. I searched for examples online but could not find any. Found some documentation <a href=\"http://docs.ceph.com/docs/jewel/rados/api/librados/\" rel=\"nofollow noreferrer\">here</a>. It says that I can use rados_watch to watch an object for changes. But I dont know how to implement it in C, especially the rados_watchcb_t part. It says rados_watchcb_t would contain the action to execute on notification. How do I declare it?</p>\n\n<p>This is what I tried:</p>\n\n<pre><code>rados_watchcb_t rados_watch = printf(\"Updated\");\n</code></pre>\n\n<p>But this gives an error.</p>\n"}, {"tags": ["c", "visual-studio", "gcc", "malloc", "realloc"], "comments": [{"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1521673399, "post_id": 49417873, "comment_id": 85837564, "body": "What is the value of g-&gt;nelem_budget?"}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1521673495, "post_id": 49417873, "comment_id": 85837597, "body": "Please add the code of the function <code>readFileBudget</code>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1521673741, "post_id": 49417873, "comment_id": 85837680, "body": "<code>realloc()</code> is too late.  Needs to be before <code>g-&gt;b[g-&gt;nelem_budget].time.tm_mon = month;</code>  OR  <code>realloc(g-&gt;b, g-&gt;nelem_budget * sizeof(struct budget));</code> is 1 element too small."}, {"owner": {"reputation": 27279, "user_id": 857132, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4fd51ed5980999c7c6ce3729d6cb2184?s=128&d=identicon&r=PG", "display_name": "John3136", "link": "https://stackoverflow.com/users/857132/john3136"}, "edited": false, "score": 0, "creation_date": 1521673743, "post_id": 49417873, "comment_id": 85837682, "body": "Pretty good attempt for a first question. Well done! You need to show where the actual contents of <code>geral</code> are initialized."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1521674416, "post_id": 49417873, "comment_id": 85837870, "body": "Please <a href=\"https://stackoverflow.com/posts/49417873/edit\">edit</a> your question and show a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> including the input files"}, {"owner": {"reputation": 2048, "user_id": 4961259, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9b82c25cbde4d52888e6eccc44764b80?s=128&d=identicon&r=PG&f=1", "display_name": "Kami Kaze", "link": "https://stackoverflow.com/users/4961259/kami-kaze"}, "edited": false, "score": 0, "creation_date": 1521675333, "post_id": 49417873, "comment_id": 85838131, "body": "Have you tried debugging it and see where it fails? This is one of the best methods to find errors in the code. And should be your first step."}], "answers": [{"tags": [], "owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "is_accepted": true, "score": 1, "last_activity_date": 1521674500, "creation_date": 1521674500, "answer_id": 49418085, "question_id": 49417873, "link": "https://stackoverflow.com/questions/49417873/realloc-fails-in-visual-studio-but-work-using-gcc-ntdll-dll/49418085#49418085", "title": "realloc fails in visual studio, but work using gcc (ntdll.dll)", "body": "<p>You need to reallocate first, then add a new element, not the other way round.</p>\n\n<p>I don't like this</p>\n\n<pre><code>struct budget *tmp = NULL;\n    tmp = g-&gt;b;\n    g-&gt;b = realloc(g-&gt;b, g-&gt;nelem_budget * sizeof(struct budget));\n    if (g-&gt;b == NULL) {          //reallocated pointer ptr1\n        free(tmp);\n        printf(\"error-addBudget-&gt;realloc\");\n        exit(EXIT_FAILURE);\n    }\n</code></pre>\n\n<p>for a couple of reasons:</p>\n\n<p><code>realloc</code> should be called like this:</p>\n\n<pre><code>struct budget *tmp;\n\ntmp = realloc(g-&gt;b, (g-&gt;nelem_budget + 1) * sizeof *tmp);\n\nif(tmp == NULL)\n{\n    // error handling\n    return 0; // return error code\n}\n\ng-&gt;b = tmp;\ng-&gt;nelem_budget++;\n</code></pre>\n\n<p>Don't do <code>exit</code> in a function other than <code>main</code>. Instead of closing the program,\nmake <code>addBudget</code> return 1 on success and 0 on failure. The caller of <code>addBudget</code>\nshould decide what to do in case of failure, not <code>addBudget</code>. If you for example\nput these functions in a library, your program would automatically end on error,\nand that's sometimes something that you don't want to happen.</p>\n\n<p>So, the function should look like this:</p>\n\n<pre><code>int addBudget(struct geral *g) {\n    if(g == NULL)\n        return 0;\n\n    int month, year;\n    float value;\n\n    // in the future, this values are to be an user input\n    month = 5;\n    year = 2015;\n    value = 5000;\n\n    // reallocate first\n\n    struct budget *tmp = NULL;\n    tmp = realloc(g-&gt;b, (g-&gt;nelem_budget + 1) * sizeof *tmp);\n\n    if(tmp == NULL)\n    {\n        fprintf(stderr, \"error-addBudget-&gt;realloc\\n\");\n        return 0;\n    }\n\n    g-&gt;b = tmp;\n\n    // add new budget after reallocation\n    printf(\"Month: %d, Year: %d, Value: %f\\n\", month, year, value);\n\n    g-&gt;b[g-&gt;nelem_budget].time.tm_mon = month;\n    g-&gt;b[g-&gt;nelem_budget].time.tm_year = year;\n    g-&gt;b[g-&gt;nelem_budget].valor = value;\n\n    g-&gt;nelem_budget++;\n\n    // just for debug\n    printf(\"month: %d, year: %d, value: %f\\n\", g-&gt;b[g-&gt;nelem_budget - 1].time.tm_mon, g-&gt;b[g-&gt;nelem_budget - 1].time.tm_year, g-&gt;b[g-&gt;nelem_budget - 1].valor);\n\n    return 1;\n}\n</code></pre>\n\n<p>and then in <code>main</code>:</p>\n\n<pre><code>int main() {\n    // using calloc to initialize\n    // everything with 0\n    struct geral *g = calloc(1, sizeof *g);\n\n    if(g == NULL)\n    {\n        fprintf(stderr, \"Not engough memory\\n\");\n        return 1;\n    }\n\n    // you should also check of readFileBudget\n    // fails\n    readFileBudget(g);\n\n    // just to check if the read was ok\n    showBudget(g-&gt;b, g-&gt;nelem_budget);\n\n    if(addBudget(g) == 0)\n    {\n        free(g-&gt;b);\n        free(g);\n        return 1;\n    }\n\n    // to check again if the item added is ok\n    showBudget(g-&gt;b, g-&gt;nelem_budget);\n\n\n    // don't forget to free the memory\n    free(g-&gt;b);\n    free(g);\n\n    system(\"Pause\");\n    return 0;\n}\n</code></pre>\n\n<p>Also see: <a href=\"https://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc\">do not cast <code>malloc</code></a></p>\n\n<p>And error messages should be printed to <code>stderr</code>, not <code>stdout</code>.</p>\n"}], "owner": {"reputation": 13, "user_id": 9531481, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-6cobxlf-jaM/AAAAAAAAAAI/AAAAAAAAAQE/VPJkKqreB3I/photo.jpg?sz=128", "display_name": "Ricardo Barreto", "link": "https://stackoverflow.com/users/9531481/ricardo-barreto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 292, "favorite_count": 0, "accepted_answer_id": 49418085, "answer_count": 1, "score": 1, "last_activity_date": 1521674500, "creation_date": 1521673169, "last_edit_date": 1521673323, "question_id": 49417873, "link": "https://stackoverflow.com/questions/49417873/realloc-fails-in-visual-studio-but-work-using-gcc-ntdll-dll", "title": "realloc fails in visual studio, but work using gcc (ntdll.dll)", "body": "<p>I'm using Visual Studio 2017 and I have this code in C. When I run in VS it fails, but when I compile with gcc it runs perfectly. The error is this: </p>\n\n<blockquote>\n  <p>Exception thrown at 0x779BE643 (ntdll.dll) in GestaoFinanceira.exe: 0xC0000005: Access violation reading location 0x00000009.</p>\n</blockquote>\n\n<p>This is my code.</p>\n\n<p>I'm using this struct type:</p>\n\n<pre><code>struct budget {\n    struct tm time;\n    float valor;\n};\n\nstruct geral {\n    struct budget *b;\n    int nelem_budget;\n};\n</code></pre>\n\n<p>In main I call a function that will read from a file and save the values is the struct <code>g-&gt;b[]</code> as the number of elements in <code>g-&gt;nelem_budget</code></p>\n\n<pre><code>int main() {\n    struct geral *g = (struct geral *)malloc(sizeof(struct geral));\n\n    readFileBudget(g);\n    // just to check if the read was ok\n    showBudget(g-&gt;b, g-&gt;nelem_budget);\n\n    addBudget(g);\n    // to check again if the item added is ok\n    showBudget(g-&gt;b, g-&gt;nelem_budget);\n\n    system(\"Pause\");\n    return 0;\n}\n</code></pre>\n\n<p>Here is when the error appens:</p>\n\n<pre><code>void addBudget(struct geral *g) {\n    int month, year;\n    float value;\n\n    // in the future, this values are to be an user input\n    month = 5;\n    year = 2015;\n    value = 5000;\n\n    printf(\"Month: %d, Year: %d, Value: %f\\n\", month, year, value);\n\n    g-&gt;b[g-&gt;nelem_budget].time.tm_mon = month;\n    g-&gt;b[g-&gt;nelem_budget].time.tm_year = year;\n    g-&gt;b[g-&gt;nelem_budget].valor = value;\n\n    g-&gt;nelem_budget++;\n\n    struct budget *tmp = NULL;\n    tmp = g-&gt;b;\n    g-&gt;b = realloc(g-&gt;b, g-&gt;nelem_budget * sizeof(struct budget));\n    if (g-&gt;b == NULL) {          //reallocated pointer ptr1\n        free(tmp);\n        printf(\"error-addBudget-&gt;realloc\");\n        exit(EXIT_FAILURE);\n    }\n\n    // just for debug\n    printf(\"month: %d, year: %d, value: %f\\n\", g-&gt;b[g-&gt;nelem_budget - 1].time.tm_mon, g-&gt;b[g-&gt;nelem_budget - 1].time.tm_year, g-&gt;b[g-&gt;nelem_budget - 1].valor);\n}\n</code></pre>\n\n<p>I have an empty value at the end of the <code>g-&gt;b</code> array, that's why I first add the values, and then I call the <code>realloc</code>.</p>\n"}, {"tags": ["c", "libusb-1.0"], "comments": [{"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1521674791, "post_id": 49417855, "comment_id": 85837970, "body": "<code>if (cnt &lt; 0)</code> --&gt;&gt; <code>if (cnt &lt;= 0)</code> seems more logical."}, {"owner": {"reputation": 1, "user_id": 9531518, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-_a3YIY10l7E/AAAAAAAAAAI/AAAAAAAAAOQ/10FC8XLZhqI/photo.jpg?sz=128", "display_name": "\u0421\u0435\u0440\u0433\u0435\u0439 \u041a\u043b\u0435\u043c\u0435\u043d\u043e\u0432", "link": "https://stackoverflow.com/users/9531518/%d0%a1%d0%b5%d1%80%d0%b3%d0%b5%d0%b9-%d0%9a%d0%bb%d0%b5%d0%bc%d0%b5%d0%bd%d0%be%d0%b2"}, "reply_to_user": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1521677723, "post_id": 49417855, "comment_id": 85838786, "body": "cnt == 0 - it&#39;s a kind of non-error case. Zero devices found. This means than next loop has 0 iterations. Negative result means error.  Bottom line: I disagree.  Also this completely non-relevant to question: I found the device. This means that cnt&gt;0"}], "owner": {"reputation": 1, "user_id": 9531518, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-_a3YIY10l7E/AAAAAAAAAAI/AAAAAAAAAOQ/10FC8XLZhqI/photo.jpg?sz=128", "display_name": "\u0421\u0435\u0440\u0433\u0435\u0439 \u041a\u043b\u0435\u043c\u0435\u043d\u043e\u0432", "link": "https://stackoverflow.com/users/9531518/%d0%a1%d0%b5%d1%80%d0%b3%d0%b5%d0%b9-%d0%9a%d0%bb%d0%b5%d0%bc%d0%b5%d0%bd%d0%be%d0%b2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 256, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1521673037, "creation_date": 1521673037, "question_id": 49417855, "link": "https://stackoverflow.com/questions/49417855/libusb-claim-interface-raises-sigsegv-segmentation-fault-in-win7-64bit", "title": "libusb_claim_interface raises SIGSEGV (Segmentation fault) in Win7 64bit", "body": "<p>I am trying to work with USB HID Composite device (Self-written). \nThere are two interfaces, both HID. But second one is Custom HID.</p>\n\n<p>I am using libusb-1.0, but that's is that I can it is open device. Any other operations I tried raises SEGV.</p>\n\n<p>This is the code (QT Creator, MinGW64):</p>\n\n<pre><code>int main(int argc, char *argv[])\n{\n\nint i=0;\nstruct libusb_device_descriptor desc;\nlibusb_device ** devs;\nlibusb_device * dev;\n\nint r = libusb_init(NULL);\n    if (r &lt; 0)\n        return r;\nint cnt = libusb_get_device_list(NULL, &amp;devs);\nif (cnt &lt; 0)\n    return cnt;\n\nwhile((dev = devs[i++]) != 0){\n    r = libusb_get_device_descriptor(dev, &amp;desc);\n    if (r &lt; 0) {\n        fprintf(stderr, \"failed to get device descriptor\");\n        return -1;\n    }\n\n    if (desc.idVendor == 0x0483){\n        libusb_device_handle * h;\n        if (!libusb_open(dev,&amp;h)){\n                if (0 == (r=libusb_claim_interface (h,1)) )\n</code></pre>\n\n<p>Here I got SIGSEGV.\nI tried to get string descriptor and set configuration as well. I've got same result.</p>\n\n<p>Where I wrong?</p>\n"}, {"tags": ["c", "sockets", "client"], "comments": [{"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 1, "creation_date": 1521672418, "post_id": 49417742, "comment_id": 85837230, "body": "Usually this means the server isn&#39;t sending anything back (not even a &quot;go away&quot; packet) when your computer tries to connect, so your computer waits a few minutes for a response. Are you sure firefox.com is actually running a server on port 8080?"}, {"owner": {"reputation": 9, "user_id": 3368674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/471c56d96b8e5ef8470ce0fb16c320db?s=128&d=identicon&r=PG&f=1", "display_name": "user3368674", "link": "https://stackoverflow.com/users/3368674/user3368674"}, "reply_to_user": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1521672565, "post_id": 49417742, "comment_id": 85837272, "body": "I tried port 80, it returned. Thank you!!"}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1521672731, "post_id": 49417742, "comment_id": 85837326, "body": "Just for testing: first try to connect to a local service(echo, telnet, smtp)"}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 1, "creation_date": 1521673853, "post_id": 49417742, "comment_id": 85837719, "body": "It <i>does</i> return, after at most a minute or two, but as you are ignoring the return value and failing nto print the error that occurred, you are never discovering why it failed. Don&#39;t write code like this, or make incorrect claims about it."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1521678392, "post_id": 49417742, "comment_id": 85838928, "body": "&quot;<i>I do not want to set the socket to non-blocking, and then keep doing <code>select()</code> until I get a response</i>&quot; - unless you are willing to wait until <code>connect()</code> times out on its own if the host can&#39;t be reached (which can take a long time), it is the best option. Set the socket to non-blocking, call <code>select()</code> <i>once</i> with a timeout, and if <code>select()</code> times out or otherwise fails then close the socket and move on, otherwise set the socket back to blocking if desired and then perform your subsequent I/O as needed."}], "answers": [{"comments": [{"owner": {"reputation": 1658, "user_id": 10813146, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/502c57cd3ed11359acecbd8124d9ae17?s=128&d=identicon&r=PG&f=1", "display_name": "milad", "link": "https://stackoverflow.com/users/10813146/milad"}, "edited": false, "score": 0, "creation_date": 1575141121, "post_id": 49419062, "comment_id": 104468525, "body": "this is not the reason. if port is wrong then connect function should return with -1 value but you say it isn&#39;t."}], "tags": [], "owner": {"reputation": 9, "user_id": 3368674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/471c56d96b8e5ef8470ce0fb16c320db?s=128&d=identicon&r=PG&f=1", "display_name": "user3368674", "link": "https://stackoverflow.com/users/3368674/user3368674"}, "is_accepted": false, "score": 0, "last_activity_date": 1521681798, "creation_date": 1521681798, "answer_id": 49419062, "question_id": 49417742, "link": "https://stackoverflow.com/questions/49417742/c-connect-does-not-return/49419062#49419062", "title": "c - connect() does not return", "body": "<p>I should've been on port 80, not 8080, in the line:</p>\n\n<pre><code>serveraddr.sin_port = htons(8080); // no\nserveraddr.sin_port = htons(80); // yes\n</code></pre>\n\n<p>Thanks for your help guys.</p>\n"}], "owner": {"reputation": 9, "user_id": 3368674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/471c56d96b8e5ef8470ce0fb16c320db?s=128&d=identicon&r=PG&f=1", "display_name": "user3368674", "link": "https://stackoverflow.com/users/3368674/user3368674"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 408, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1521681798, "creation_date": 1521672307, "last_edit_date": 1521672521, "question_id": 49417742, "link": "https://stackoverflow.com/questions/49417742/c-connect-does-not-return", "title": "c - connect() does not return", "body": "<p>I'm trying to build a c client that sends an html request message to a website, and then reads the response. Unfortunately, my connect() statement does not return.</p>\n\n<p>Yes, I have seen this answer: <a href=\"https://stackoverflow.com/questions/20216462/connect-does-not-return\">connect() does not return</a></p>\n\n<p>However, I do not want to set the socket to non-blocking, and then keep doing select() until I get a response, as I am only dealing with one request at a time. </p>\n\n<pre><code>int main() {\n\n    struct hostent *hp;\n    struct sockaddr_in serveraddr;\n\n    mySocket = socket(AF_INET, SOCK_STREAM, 0);\n\n    hp = gethostbyname(\"firefox.com\"));\n\n    bzero((char *) &amp;serveraddr, sizeof(serveraddr));\n    serveraddr.sin_family = AF_INET;\n    bcopy((char *)hp-&gt;h_addr_list[0], (char *)&amp;serveraddr.sin_addr.s_addr, hp-&gt;h_length);\n\n    serveraddr.sin_port = htons(8080); // works up till here\n\n    connect(mySocket, (SA *) &amp;serveraddr, sizeof(serveraddr)); // never returns\n\n    return 0;\n}\n</code></pre>\n\n<p>Am I connecting correctly? I've gotten rid of the error checking in the above code.</p>\n\n<p>Here is the output of \"lsof -Pnl +M -i4\" in terminal</p>\n\n<pre><code>COMMAND  PID     USER   FD   TYPE DEVICE SIZE/OFF NODE NAME\nproxy   8321     1000    3u  IPv4  51542      0t0  TCP 10.0.2.15:42708-&gt;63.245.213.17:8080 (SYN_SENT)\n</code></pre>\n\n<p>Could this be a firewall issue? If so, how do I resolve it?</p>\n"}, {"tags": ["c", "split"], "comments": [{"owner": {"reputation": 100758, "user_id": 1899640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47374ccb28e4b0d2454b64f7b975bc66?s=128&d=identicon&r=PG", "display_name": "that other guy", "link": "https://stackoverflow.com/users/1899640/that-other-guy"}, "edited": false, "score": 8, "creation_date": 1521670063, "post_id": 49417300, "comment_id": 85836451, "body": "Cool. Do you have a question about it?"}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1521670271, "post_id": 49417300, "comment_id": 85836533, "body": "<code>for(size_t i=0; i&lt;strlen(original);i++ )</code> -&gt; <code>for (size_t i = 0;  original[i] != &#39;\\0&#39;; i++ )</code>, because <code>strlen()</code> <b>counts</b> the characters and that is inefficient."}, {"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 0, "creation_date": 1521670329, "post_id": 49417300, "comment_id": 85836557, "body": "<code>we have an school asignment</code> - Do not get me involved in your assignments."}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "reply_to_user": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 0, "creation_date": 1521670448, "post_id": 49417300, "comment_id": 85836605, "body": "@EdHeal - its fair to get involved in assignments if the questioner has make effort to do the work but is stuck. The ones I object to is when the assignment text simply gets pasted as the question."}, {"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 0, "creation_date": 1521670574, "post_id": 49417300, "comment_id": 85836658, "body": "&quot;we&quot; implies ownership. &quot;please help me with...&quot; would be better"}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1521670949, "post_id": 49417300, "comment_id": 85836777, "body": "@IharobAlAsimi Since <code>original</code> isn&#39;t modified in the loop, I would expect the optimizer to pre-compute the string length and replace the <code>for</code> loop condition with that value, rather than calling <code>strlen</code> each time through, no? Probably still not as efficient as what you&#39;ve proposed, but I wouldn&#39;t expect much of a performance hit from using <code>strlen</code>. Just wondering outloud, I haven&#39;t looked at any assembly."}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1521671078, "post_id": 49417300, "comment_id": 85836817, "body": "The strings must be <code>&#39;\\0&#39;</code>-terminated. Before <code>(*size)++;</code> do: <code>result[*size][str_begin] = 0;</code>"}, {"owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "edited": false, "score": 1, "creation_date": 1521671123, "post_id": 49417300, "comment_id": 85836830, "body": "What is the actual problem you are facing / what is not working? And  what  is your debugger telling you?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1521671124, "post_id": 49417300, "comment_id": 85836831, "body": "Make a copy of <code>original</code>, and then use <code>strtok()</code> and <code>strcpy()</code>."}, {"owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "edited": false, "score": 0, "creation_date": 1521671273, "post_id": 49417300, "comment_id": 85836881, "body": "... or use <code>strchr</code>, <code>memcpy</code> and terminate your destination  strings."}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1521671394, "post_id": 49417300, "comment_id": 85836925, "body": "if you are having trouble, learn to use your debugger to step through the code."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 1, "creation_date": 1521671485, "post_id": 49417300, "comment_id": 85836952, "body": "@yano correct. As I recall correctly, <code>strlen</code>, just uses a cast to <code>unsigned</code> to check 4-chars per-iteration instead of 1. You won&#39;t see much measurable difference until you work with strings of many hundreds (or thousands) of characters. (I did the tests -- because retentive minds just have to know....)"}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "reply_to_user": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 1, "creation_date": 1521672163, "post_id": 49417300, "comment_id": 85837161, "body": "@yano, Suppose that it&#39;s true. The optimizer did find out that the stirng didn&#39;t changed and replaced the call with the fixed length. It still looks like PHP and just for that it deserves to be changed. And also, the <code>original[i] != &#39;\\0&#39;</code> is more idiomatic."}, {"owner": {"reputation": 27, "user_id": 8761548, "user_type": "registered", "profile_image": "https://graph.facebook.com/1931456966880887/picture?type=large", "display_name": "Adrian Grupaty Chlpik", "link": "https://stackoverflow.com/users/8761548/adrian-grupaty-chlpik"}, "reply_to_user": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1521676652, "post_id": 49417300, "comment_id": 85838511, "body": "@pm100 tried that even my teacher couldnt tell what doesnt work i suppose it was something with pointer i do not understand them well yet"}], "answers": [{"tags": [], "owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "is_accepted": true, "score": 0, "last_activity_date": 1521672860, "last_edit_date": 1521672860, "creation_date": 1521672261, "answer_id": 49417731, "question_id": 49417300, "link": "https://stackoverflow.com/questions/49417300/string-split-in-c-without-changing-original/49417731#49417731", "title": "String split in c without changing original", "body": "<p>The idea is OK, but you have a couple of errors:</p>\n\n<p>Your string copies are not <code>'\\0'</code>-terminated. Also you are not taking into\naccount when multiple delimiters follow in a row.</p>\n\n<p>If you are not allowed to use\nfunctions like <code>strchr</code> and <code>strncpy</code>, then you can do this:</p>\n\n<pre><code>size_t str_begin = 0;\n*size = 0; // the user may have passed an uninitialized int variable\n\nfor(size_t i = 0; original[i] &amp;&amp; *size &lt; 50; ++i)\n{\n    if(original[i] == delim)\n    {\n        size_t sublen = i - str_begin;\n        if(sublen == 0)\n        {\n            // skip delimiter, last character was also a\n            // delimiter and/or the first character in\n            // original is a delimiter\n            str_begin++;\n            continue;\n\n            // or if you want to have empty words instead of skipping\n            // results[*size] = 0;\n            // (*size)++;\n        }\n\n        if(sublen &gt; 256)\n            sublen = 256;\n\n        for(size_t j = 0; j &lt; sublen; ++j)\n            result[*size][j] = original + str_begin + j;\n\n        result[*size][j] = 0; // \\0-terminating string\n\n        (*size)++;\n        str_begin = i + 1; // updating str_begin to next char\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "is_accepted": false, "score": 0, "last_activity_date": 1521672552, "creation_date": 1521672552, "answer_id": 49417791, "question_id": 49417300, "link": "https://stackoverflow.com/questions/49417300/string-split-in-c-without-changing-original/49417791#49417791", "title": "String split in c without changing original", "body": "<p>The straight forward way of doing so is - as suggested by Barmar - to make a copy of the original string and then work with <code>strtok()</code> and <code>strcpy</code>. </p>\n\n<p>Alternatively, you could use  <code>strchr</code> in a loop to find the delimiters and <code>memcpy</code> to copy the memory between the previous delimiter and the next one. See  the following code, which also takes the boundaries of the result array into account:</p>\n\n<pre><code>void stringSplit(const char *original, char result[50][256], int *size, char\n                 delim)\n{\n    if(!original){\n        return ;\n    }\n\n    *size = 0;\n    const char* nextDelim;\n    const char* prevDelim = original;\n    do  {\n        nextDelim = strchr(prevDelim,delim);\n        size_t len = nextDelim ? (nextDelim - prevDelim) : strlen(prevDelim);\n        if (len &gt;= 256) {\n            len = 256-1;\n        }\n        memcpy(result[*size],prevDelim,len);\n        result[*size][len] = '\\0';\n        (*size)++;\n        prevDelim = nextDelim ? nextDelim+1 : NULL;\n    }\n    while(nextDelim &amp;&amp; *size &lt; 50);\n}\n\nint main() {\n\n    char result[50][256];\n    int  size;\n    stringSplit(\"Hello, this, is\", result, &amp;size, ',');\n\n    return 0;\n\n}\n</code></pre>\n\n<p>Hope it helps.</p>\n"}], "owner": {"reputation": 27, "user_id": 8761548, "user_type": "registered", "profile_image": "https://graph.facebook.com/1931456966880887/picture?type=large", "display_name": "Adrian Grupaty Chlpik", "link": "https://stackoverflow.com/users/8761548/adrian-grupaty-chlpik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 306, "favorite_count": 0, "closed_date": 1521673629, "accepted_answer_id": 49417731, "answer_count": 2, "score": -2, "last_activity_date": 1521672860, "creation_date": 1521669954, "last_edit_date": 1521671092, "question_id": 49417300, "link": "https://stackoverflow.com/questions/49417300/string-split-in-c-without-changing-original", "closed_reason": "Needs details or clarity", "title": "String split in c without changing original", "body": "<p>we have an school asignment to make a specific function of string split \nthe header and arguments of function is given cannot change them .\nthis function should split original by delimiter into array of string that store each part of string delimiter not included and in additon for each delimiter increase size</p>\n\n<pre><code>void stringSplit(const char *original, char result[50][256], int* size, char delim){\n    size_t begin = 0;\n    if(!original){\n        return;\n    }\n    for(size_t i=0; i&lt;strlen(original);i++ ){\n        if (original[i] == delim){\n            int str_begin = 0;\n            for( ; begin &lt; i; begin++ ){\n                result[*size][str_begin] = original[begin];\n                str_begin++;\n            }\n            (*size)++;\n            begin ++ ;\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "posix", "glibc", "uclibc", "musl"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1521669042, "post_id": 49417051, "comment_id": 85836004, "body": "Have a look at the C library on your target platform and see where it originates. This is usually well documented for copyright reasons."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 2, "creation_date": 1521669230, "post_id": 49417051, "comment_id": 85836078, "body": "And rarely, if ever (for practical reasons), rewritten from scratch. There is no advantage to rewriting -- the libraries available have years of testing -- you can&#39;t rewrite and expect to avoid the years it takes to fully bugfix a complex library while keeping track of all updates and changes on your own."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1521669572, "post_id": 49417051, "comment_id": 85836236, "body": "Since POSIX compatibility is so widely desired, I suspect that most C library implementors ensure that they&#39;re compliant to begin with, so OS developers don&#39;t need to do much."}, {"owner": {"reputation": 19889, "user_id": 906839, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5bce6d276ec5c9b7b97804d0add55084?s=128&d=identicon&r=PG", "display_name": "Brett Hale", "link": "https://stackoverflow.com/users/906839/brett-hale"}, "edited": false, "score": 0, "creation_date": 1521678905, "post_id": 49417051, "comment_id": 85839031, "body": "<b>Counterpoint</b>: Look at <a href=\"https://www.musl-libc.org/\" rel=\"nofollow noreferrer\">musl-libc</a>. While not technically written from scratch, (most maths, or <i>libm</i>, parts of C libraries are re-used), sometimes a fresh start with - importantly - <i>modern</i> dev tools and compilers is worth it. You should investigate <code>musl</code> for your needs - it&#39;s clean, efficient, and already forms the basis of some distributions and embedded projects. I hope to see it refined and more widely adopted."}, {"owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "edited": false, "score": 0, "creation_date": 1522225218, "post_id": 49417051, "comment_id": 86064520, "body": "<i>an open source version of C Standard Library</i>, well proprietary will fit as well."}], "answers": [{"tags": [], "owner": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "is_accepted": false, "score": 0, "last_activity_date": 1521672097, "creation_date": 1521672097, "answer_id": 49417702, "question_id": 49417051, "link": "https://stackoverflow.com/questions/49417051/a-posix-compliant-os-usually-extends-an-existing-implementation-of-the-c-standar/49417702#49417702", "title": "A POSIX compliant OS usually extends an existing implementation of the C Standard Library?", "body": "<p>Well, <em>we are all dwarves standing on the shoulders of giants</em>.</p>\n\n<p>Writing a new OS is a <em>huge</em> undertaking, so the wise one will re-use whatever (design, libraries, compilers, other software) they can. It's still in all likelyhood far too much work, so why make it even harder by rewriting everything from scratch?</p>\n"}, {"tags": [], "owner": {"reputation": 5450, "user_id": 2758823, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9Nxaq.jpg?s=128&g=1", "display_name": "Giacomo Catenazzi", "link": "https://stackoverflow.com/users/2758823/giacomo-catenazzi"}, "is_accepted": false, "score": 1, "last_activity_date": 1521712825, "creation_date": 1521712825, "answer_id": 49425602, "question_id": 49417051, "link": "https://stackoverflow.com/questions/49417051/a-posix-compliant-os-usually-extends-an-existing-implementation-of-the-c-standar/49425602#49425602", "title": "A POSIX compliant OS usually extends an existing implementation of the C Standard Library?", "body": "<p>Really, it is done in the inverse way.</p>\n\n<p>We have different Unix versions: two main families: SystemV and BSD, different manufacturers, and so there was a need to standardize.  US government wanted also standardized programs, so POSIX (version 1) was created, by standardizing OS interfaces (a step further than just C standard).</p>\n\n<p>Windows NT is also POSIX (version 1) compatible, just because government wanted standardized tools. So POSIX was designed very very broad.</p>\n\n<p>Then with time, there were need to standardize some more Unix (and similar) systems. Not as just one system, one API, but as common API, and so programs (e.g. GUI libraries or databases) could eventually use extension, but also make sure that program that follow the standard works on compatible system.</p>\n\n<p>This was SUS (Single Unix Specification). This required a UNIX like system (unlike POSIX 1).</p>\n\n<p>Then POSIX became not so important: application that in theory could work on all POSIX systems didn't really work on POSIX Windows.</p>\n\n<p>So the new version of POSIX merged old POSIX plus SUS plus new useful function missing in SUS.</p>\n\n<p>Now Linux is important, so Linux implementations (e.g. glibc) is taken into account when updating POSIX.  You will see in the mailing list, that POSIX is defined by \"vendors\" of different Unix and similar systems.</p>\n\n<p>So, it is not that operating systems extend POSIX, it is just that POSIX takes the most useful and standard options from different OS. It creates new interfaces just when existing interfaces are so incompatible, that by standardizing, it will break existing programs.</p>\n\n<p>For the \"second\" question: when you develop a new operating system, you choose what way to go. Usually it is just derivation and fork (and distributions): again from the two Unix families, of just deriving Linuxes from RedHat or Debian). Sometime system is build from scratch, because of the design. Kernel provides most of system calls, so e.g. glibc needs a lot of systemcall (given by kernel) implemented in a similar way as POSIX. Glibc is not complete.  Note: early Linux distributions used other libraries. GLibc was also written from scratch.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4546925"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 699, "favorite_count": 1, "answer_count": 2, "score": 2, "last_activity_date": 1521712825, "creation_date": 1521668764, "last_edit_date": 1521679164, "question_id": 49417051, "link": "https://stackoverflow.com/questions/49417051/a-posix-compliant-os-usually-extends-an-existing-implementation-of-the-c-standar", "title": "A POSIX compliant OS usually extends an existing implementation of the C Standard Library?", "body": "<p>One of the <em>Units of Functionality</em> that POSIX states an OS needs to provide to be POSIX compliant is POSIX_C_LANG_SUPPORT. Basically this is the whole C Standard Library with some more things.</p>\n\n<p>My question is simple: developers of POSIX compliant OSes usually just download an open source version of C Standard Library (e.g. glib or uClibc) and adapt it to fit POSIX or they implement everything from scratch? Is there any advantage in rewriting the C Library instead of just picking one of the very known implementations and adjust it to my needs?</p>\n"}, {"tags": ["c", "arrays", "algorithm", "struct"], "comments": [{"owner": {"reputation": 8002, "user_id": 1143850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2927fac544c9960cd5433688fe4cae1d?s=128&d=identicon&r=PG", "display_name": "Serge", "link": "https://stackoverflow.com/users/1143850/serge"}, "edited": false, "score": 0, "creation_date": 1521669047, "post_id": 49416982, "comment_id": 85836007, "body": "not sure where you got n^2. you need linear search there, just O(n) per  element.  you will get 2*n in the worst case for pair"}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1521671925, "post_id": 49416982, "comment_id": 85837093, "body": "If you have the memory: inserting into a hash table (+checking) is O(N)"}], "answers": [{"comments": [{"owner": {"reputation": 377, "user_id": 9198437, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8f86fc9e316684b04e99c14655bc735d?s=128&d=identicon&r=PG&f=1", "display_name": "MiguelD", "link": "https://stackoverflow.com/users/9198437/migueld"}, "edited": false, "score": 0, "creation_date": 1521668864, "post_id": 49417025, "comment_id": 85835942, "body": "and would you sort the array using witch variable? id? any sorting algorithm that you recomend?"}, {"owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "reply_to_user": {"reputation": 377, "user_id": 9198437, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8f86fc9e316684b04e99c14655bc735d?s=128&d=identicon&r=PG&f=1", "display_name": "MiguelD", "link": "https://stackoverflow.com/users/9198437/migueld"}, "edited": false, "score": 2, "creation_date": 1521669070, "post_id": 49417025, "comment_id": 85836020, "body": "use, for example, <code>qsort</code>; write a custom comparison function that sorts according to a combination of <code>time</code>, then <code>x</code>, then <code>y</code>, then <code>id</code>. Then two elements with equal <code>time,x,y</code> will be right  after each other; compare the <code>id</code>s then for such elements to find duplicates."}], "tags": [], "owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "is_accepted": true, "score": 4, "last_activity_date": 1521673254, "last_edit_date": 1521673254, "creation_date": 1521668654, "answer_id": 49417025, "question_id": 49416982, "link": "https://stackoverflow.com/questions/49416982/finding-duplicate-elements-in-an-unsorted-array-of-structs-in-less-then-on2/49417025#49417025", "title": "Finding duplicate elements in an unsorted array of structs in less then O(n^2) - C", "body": "<p>Probably a simple solution: Sorting the array is <code>O(n*log(n))</code>, and finding duplicate entries then is a single loop of complexity <code>O(n)</code>. So all together, a complexity of <code>O(n*log(n))</code>, which is less than the <code>O(n^2)</code> you wanted to beat. Hope it helps.</p>\n"}, {"comments": [{"owner": {"reputation": 5867, "user_id": 2252087, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/020cbe41b02f03d59f3adae022c0ce7d?s=128&d=identicon&r=PG", "display_name": "ensc", "link": "https://stackoverflow.com/users/2252087/ensc"}, "edited": false, "score": 0, "creation_date": 1521673850, "post_id": 49417721, "comment_id": 85837717, "body": "what is, when each element in the list causes a hash collision?  E.g. when the hash function is <code>h(element) = 0</code>?"}, {"owner": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "reply_to_user": {"reputation": 5867, "user_id": 2252087, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/020cbe41b02f03d59f3adae022c0ce7d?s=128&d=identicon&r=PG", "display_name": "ensc", "link": "https://stackoverflow.com/users/2252087/ensc"}, "edited": false, "score": 0, "creation_date": 1521674419, "post_id": 49417721, "comment_id": 85837872, "body": "@ensc, Then a split or a rehashing occurs. Either way, a new hash perturbation key is used to virtually guarantee it won&#39;t happen again. You can even try again In the statistically impossible event that all the elements still all go to a single bucket. So yes, O(N) is really only the average case, but it&#39;s virtually impossible to exceed the average case."}, {"owner": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "reply_to_user": {"reputation": 5867, "user_id": 2252087, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/020cbe41b02f03d59f3adae022c0ce7d?s=128&d=identicon&r=PG", "display_name": "ensc", "link": "https://stackoverflow.com/users/2252087/ensc"}, "edited": false, "score": 0, "creation_date": 1521674957, "post_id": 49417721, "comment_id": 85838028, "body": "Only if a statistically impossible situation happens twice in a row. Even a malicious agent can&#39;t make it worse that O(N) if properly written. So, for all intents and purposes, it&#39;s O(N)."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 1, "creation_date": 1521677451, "post_id": 49417721, "comment_id": 85838716, "body": "<code>... when the hash function is h(element) = 0</code> Then: use a different <i>sane</i> hash function. (BTW:this fear of collisions is pathological)"}, {"owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "edited": false, "score": 0, "creation_date": 1521701635, "post_id": 49417721, "comment_id": 85845345, "body": "Much better than <code>O(n log(n)</code>; and thanks for editing my answer."}], "tags": [], "owner": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "is_accepted": false, "score": 3, "last_activity_date": 1521693361, "last_edit_date": 1521693361, "creation_date": 1521672171, "answer_id": 49417721, "question_id": 49416982, "link": "https://stackoverflow.com/questions/49416982/finding-duplicate-elements-in-an-unsorted-array-of-structs-in-less-then-on2/49417721#49417721", "title": "Finding duplicate elements in an unsorted array of structs in less then O(n^2) - C", "body": "<p>Adding N elements to a hash table can be done in O(N), so it can be done in O(N).</p>\n\n<p>A working demonstration in Perl:</p>\n\n<pre><code>#!/usr/bin/perl\nuse strict;\nuse warnings qw( all );\n\nmy @infos = (\n   { id =&gt; '002', time =&gt; 10, x =&gt; 30, y =&gt; 40 },\n   { id =&gt; '001', time =&gt; 10, x =&gt; 30, y =&gt; 40 },\n   { id =&gt; '001', time =&gt; 15, x =&gt; 45, y =&gt; 50 },\n   { id =&gt; '001', time =&gt; 20, x =&gt; 23, y =&gt; 37 },\n);\n\nmy %seen;\nfor my $i (0..$#infos) {\n   my $info = $infos[$i];\n   my $key = join(':', $info-&gt;{time}, $info-&gt;{x}, $info-&gt;{y});\n   push @{ $seen{$key} }, $i;\n}\n\nfor my $matches (values(%seen)) {\n   next if @$matches == 1;\n\n   print(\"Duplicates:\\n\");\n   for my $i (@$matches) {\n      my $info = $infos[$i];\n      printf(\"  %d %s %d %d %d\\n\", $i, @$info{qw( id time x y )});\n   }\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>Duplicates:\n  0: 002 10 30 40\n  1: 001 10 30 40\n</code></pre>\n"}], "owner": {"reputation": 377, "user_id": 9198437, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8f86fc9e316684b04e99c14655bc735d?s=128&d=identicon&r=PG&f=1", "display_name": "MiguelD", "link": "https://stackoverflow.com/users/9198437/migueld"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 430, "favorite_count": 0, "accepted_answer_id": 49417025, "answer_count": 2, "score": 1, "last_activity_date": 1521693361, "creation_date": 1521668497, "last_edit_date": 1521669326, "question_id": 49416982, "link": "https://stackoverflow.com/questions/49416982/finding-duplicate-elements-in-an-unsorted-array-of-structs-in-less-then-on2", "title": "Finding duplicate elements in an unsorted array of structs in less then O(n^2) - C", "body": "<p>the struct:</p>\n\n<pre><code>struct info{\n    int id;\n    int time;\n    int x;\n    int y;\n};\n</code></pre>\n\n<p>The array of structs will always follow this conditions: </p>\n\n<ul>\n<li><p>The time variable will always be given in a sorted away to it's corresponding id</p></li>\n<li><p>It's considered duplicated if the variables: <code>time</code>, <code>x</code>, <code>y</code> are equal and <code>id</code> is different</p></li>\n<li><p>The search it's done by looking for two different id values</p></li>\n</ul>\n\n<p><strong>Example 1:Find the duplicate for the pair - 001 002</strong></p>\n\n<pre><code>struct info *arr = {{002, 10, 30, 40}, {001, 10, 30, 40}, {001, 15, 45, 50}, {001, 20, 23, 37}}\n</code></pre>\n\n<p><strong>Output:</strong> the duplicate pair would be in position 0 &amp; 1 </p>\n\n<p><strong>Example 2:Find the duplicate for the pair - 001 002</strong></p>\n\n<pre><code>struct info *arr = {{002, 15, 45, 50}, {002, 16, 21, 13}, {001, 10, 30, 40}, {001, 15, 45, 50},}\n</code></pre>\n\n<p><strong>Output:</strong> the duplicate pair would be in position 0 &amp; 3 </p>\n\n<p><strong>Example 3:Find the duplicate for the pair - 003 004</strong></p>\n\n<pre><code>struct info *arr = {{004, 6, 47, 52}, {003, 6, 47, 52}, {001, 10, 30, 40}, {002, 15, 45, 50},}\n</code></pre>\n\n<p><strong>Output:</strong> the duplicate pair would be in position 0 &amp; 1 </p>\n\n<p>Is it possible to solve this in less then <code>O(n^2)</code> time?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 1, "creation_date": 1521667529, "post_id": 49416699, "comment_id": 85835312, "body": "<code>fflush(stdin);</code> is implementation defined/undefined -- don&#39;t use it, it doesn&#39;t do what you think it does. When you enter <code>y</code> or <code>n</code>, you actually enter <code>y\\n</code> or <code>n\\n</code> (the newline results from pressing <code>[Enter]</code>) You must remove it (and any other extraneous characters) from the input buffer after each input. (or use <code>fgets</code> as is recommended). What if you enter <code>&quot;yes&quot;</code> or <code>&quot;no&quot;</code> or <code>&quot;hell yes I want to continue!&quot;</code> You must handle each case."}, {"owner": {"reputation": 5, "user_id": 9526242, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49d51d299f471782ede9c0b70cdf141?s=128&d=identicon&r=PG&f=1", "display_name": "zxc20100123", "link": "https://stackoverflow.com/users/9526242/zxc20100123"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1521668134, "post_id": 49416699, "comment_id": 85835610, "body": "@DavidC.Rankin Thanks again. I actually only put fflush there to test if it works. I call yes() function there, so I assume it&#39;ll do clearkeyboard when input is invalid. Input is valid as shown in the image, it&#39;s giving me new lines because I didn&#39;t clear buffer? Also, I didn&#39;t put clearkeyboard() in &quot; else done = 0; is because it also gives a new line."}, {"owner": {"reputation": 5, "user_id": 9526242, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49d51d299f471782ede9c0b70cdf141?s=128&d=identicon&r=PG&f=1", "display_name": "zxc20100123", "link": "https://stackoverflow.com/users/9526242/zxc20100123"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1521668162, "post_id": 49416699, "comment_id": 85835621, "body": "My apology for bad English, lemme know if you dont get what I&#39;m saying :("}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1521668945, "post_id": 49416699, "comment_id": 85835966, "body": "You clear <code>stdin</code> with a simple function, e.g. <code>void empty_stdin (void) { int c = getchar(); while (c != &#39;\\n&#39; &amp;&amp; c != EOF) c = getchar(); }</code>. Then you simply call it <code>empty_stdin();</code> when you need to ... empty <code>stdin</code>."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1521669048, "post_id": 49416699, "comment_id": 85836009, "body": "You may find <a href=\"https://stackoverflow.com/posts/comments/85835321?noredirect=1\">call menu from another function</a> helpful. It covers <code>y&#47;n</code> and quite a bit more."}, {"owner": {"reputation": 5, "user_id": 9526242, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49d51d299f471782ede9c0b70cdf141?s=128&d=identicon&r=PG&f=1", "display_name": "zxc20100123", "link": "https://stackoverflow.com/users/9526242/zxc20100123"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1521670087, "post_id": 49416699, "comment_id": 85836461, "body": "Thanks, I&#39;ve read it. I encountered a problem that whenever the program is calling empty_stdin function, it requires me to press enter(a \\n) to continue the program."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1521684500, "post_id": 49416699, "comment_id": 85840238, "body": "That&#39;s because you are not being a good accountant and only calling it when there are characters to be read in <code>stdin</code>. That is another reason <code>fgets</code> is recommended <code>:)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 9526242, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49d51d299f471782ede9c0b70cdf141?s=128&d=identicon&r=PG&f=1", "display_name": "zxc20100123", "link": "https://stackoverflow.com/users/9526242/zxc20100123"}, "edited": false, "score": 0, "creation_date": 1521670008, "post_id": 49417123, "comment_id": 85836428, "body": "Thanks, I changed it to if. My problem is now, whenever I call said clearbuffer function, the program stops there and waiting for a \\n(Enter) which is not what I want."}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "reply_to_user": {"reputation": 5, "user_id": 9526242, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49d51d299f471782ede9c0b70cdf141?s=128&d=identicon&r=PG&f=1", "display_name": "zxc20100123", "link": "https://stackoverflow.com/users/9526242/zxc20100123"}, "edited": false, "score": 0, "creation_date": 1521670794, "post_id": 49417123, "comment_id": 85836725, "body": "@zxc20100123 perhaps you still have some old code that you didn&#39;t remove. Check this out: <a href=\"https://onlinegdb.com/rJfS98lcG\" rel=\"nofollow noreferrer\">onlinegdb.com/rJfS98lcG</a> this is the code I tried and it doesn&#39;t show the behaviour you are describing."}, {"owner": {"reputation": 5, "user_id": 9526242, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49d51d299f471782ede9c0b70cdf141?s=128&d=identicon&r=PG&f=1", "display_name": "zxc20100123", "link": "https://stackoverflow.com/users/9526242/zxc20100123"}, "edited": false, "score": 0, "creation_date": 1521671140, "post_id": 49417123, "comment_id": 85836840, "body": "<a href=\"https://imgur.com/a/BT10A\" rel=\"nofollow noreferrer\">imgur.com/a/BT10A</a> When I entered &#39;yes&#39; or &#39;nooooo&#39;, it should show the error messages instead of reading the first character! Other parts work fine! ty."}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "reply_to_user": {"reputation": 5, "user_id": 9526242, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49d51d299f471782ede9c0b70cdf141?s=128&d=identicon&r=PG&f=1", "display_name": "zxc20100123", "link": "https://stackoverflow.com/users/9526242/zxc20100123"}, "edited": false, "score": 0, "creation_date": 1521672482, "post_id": 49417123, "comment_id": 85837249, "body": "@zxc20100123 the change for that is minimal, see <a href=\"https://onlinegdb.com/rJOybDxqM\" rel=\"nofollow noreferrer\">onlinegdb.com/rJOybDxqM</a> at lines 28 and 29"}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "reply_to_user": {"reputation": 5, "user_id": 9526242, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49d51d299f471782ede9c0b70cdf141?s=128&d=identicon&r=PG&f=1", "display_name": "zxc20100123", "link": "https://stackoverflow.com/users/9526242/zxc20100123"}, "edited": false, "score": 0, "creation_date": 1521672561, "post_id": 49417123, "comment_id": 85837268, "body": "@zxc20100123 I also updated my answer with this small change"}], "tags": [], "owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "is_accepted": true, "score": 1, "last_activity_date": 1521682522, "last_edit_date": 1521682522, "creation_date": 1521669176, "answer_id": 49417123, "question_id": 49416699, "link": "https://stackoverflow.com/questions/49416699/call-a-yes-no-function-to-determine-if-user-enters-valid-input/49417123#49417123", "title": "Call a (yes/no) function to determine if user enters valid input", "body": "<p>I would recommend to use <code>fgets</code> instead of <code>scanf</code>, you have more control with\nlines using <code>fgets</code>.</p>\n\n<p>If you use <code>scanf</code> to read strings, I would use this function to clear the\nbuffer:</p>\n\n<pre><code>void clear_buffer(FILE *fp)\n{\n    int c;\n    while((c=fgetc(fp)) != '\\n' &amp;&amp; c!=EOF);\n}\n</code></pre>\n\n<p>and then you can do</p>\n\n<pre><code>char name[15];\nchar phone[15];\nscanf(\"%14s\", name);\nclear_buffer(stdin);\n\nscanf(\"%14s\", phone);\nclear_buffer(stdin);\n</code></pre>\n\n<p>So your <code>yes</code> function can be rewritten as:</p>\n\n<pre><code>int yes(const char *prompt)\n{\n    char line[10];\n    int ret;\n\n    do {\n        printf(\"%s: \", prompt);\n        fflush(stdout);\n\n        ret = scanf(\"%9s\", line);\n        clear_buffer(stdin);\n\n        if(ret == 1)\n        {\n            // catch entries like \"yes\" and \"nooooooo\"\n            if(line[1] != 0)\n                line[0] = 0;\n\n            switch(line[0])\n            {\n                case 'y':\n                case 'Y':\n                    return 1;\n\n                case 'n':\n                case 'N':\n                    return 0;\n\n                default:\n                    printf(\"*** INVALID ENTRY *** &lt;Only (Y)es or (N)o are acceptable&gt;\\n\");\n            }\n        }\n    } while(ret != EOF);\n\n    return 0;\n}\n</code></pre>\n\n<p>then you can read the numbers like this:</p>\n\n<pre><code>void getNumbers(struct Numbers *numbers) // getNumbers function definition\n{\n    int result;\n\n    printf(\"Please enter the contact's cell phone number: \");\n    scanf(\"%s\", numbers-&gt;cell);\n    clear_buffer(stdin);\n\n\n    if(yes(\"Do you want to enter a home phone number? (y or n)\"))\n    {\n        printf(\"Please enter the contact's home phone number: \");\n        scanf(\"%s\", numbers-&gt;home);\n        clear_buffer(stdin);\n    }\n\n    if(yes(\"Do you want to enter a business phone number? (y or n)\"))\n    {\n        printf(\"Please enter the contact's business phone number: \");\n        scanf(\"%s\", numbers-&gt;business);\n        clear_buffer(stdin);\n    }\n}\n</code></pre>\n\n<p>btw: why are you doing this</p>\n\n<pre><code>while (result == 1) {\n    printf(\"Please enter the contact's home phone number: \");\n    scanf(\"%s\", numbers-&gt;home);\n    break;\n}\n</code></pre>\n\n<p>instead of</p>\n\n<pre><code>if (result == 1) {\n    printf(\"Please enter the contact's home phone number: \");\n    scanf(\"%s\", numbers-&gt;home);\n}\n</code></pre>\n\n<p>That yields the same result but this is much more easier to read.</p>\n"}], "owner": {"reputation": 5, "user_id": 9526242, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49d51d299f471782ede9c0b70cdf141?s=128&d=identicon&r=PG&f=1", "display_name": "zxc20100123", "link": "https://stackoverflow.com/users/9526242/zxc20100123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 242, "favorite_count": 0, "accepted_answer_id": 49417123, "answer_count": 1, "score": 0, "last_activity_date": 1521682522, "creation_date": 1521667178, "last_edit_date": 1521668437, "question_id": 49416699, "link": "https://stackoverflow.com/questions/49416699/call-a-yes-no-function-to-determine-if-user-enters-valid-input", "title": "Call a (yes/no) function to determine if user enters valid input", "body": "<p>I'm trying to call a yes/no function to see if user enters valid input which is 'Y' 'y' 'N' 'n' in this case. But I don't want the two new lines between output as you can see from following attached image.</p>\n\n<p><img src=\"https://i.stack.imgur.com/ELUlq.png\" alt=\"Incorrect Part\"></p>\n\n<p>clearKeyboard function:\nvoid clearKeyboard(void)</p>\n\n<pre><code>{\n    int c;\n    while ((c = getchar()) != '\\n' &amp;&amp; c != EOF);\n}\n</code></pre>\n\n<p>Yes/No function:</p>\n\n<pre><code>int yes(void)\n{\n    int result, done = 1;\n    char c = 0, charenter;\n\n    scanf(\"%c%c\", &amp;charenter, &amp;c);\n\n    while (done == 1) {\n        if (c != '\\n' || (!(charenter == 'Y' || charenter == 'y' || charenter == 'N' || charenter == 'n'))) {\n            clearKeyboard();\n            printf(\"*** INVALID ENTRY *** &lt;Only (Y)es or (N)o are acceptable&gt;: \");\n            scanf(\"%c%c\", &amp;charenter, &amp;c);\n        }\n        else {\n            done = 0;\n        }\n    }\n\n    if (charenter == 'Y' || charenter == 'y')\n        result = 1;\n    else if (charenter == 'N' || charenter == 'n')\n        result = 0;\n\n    return result;\n}\n</code></pre>\n\n<p>Function to call yes/no function: I've tried remove the fflush(stdin); or leave a space before %c, none of them worked. But the \"home phone number\" part works fine without giving me new lines/ Invalid input error.</p>\n\n<pre><code>void getNumbers(struct Numbers *numbers) // getNumbers function definition\n{\n    char answer;\n    int result;\n\n    printf(\"Please enter the contact's cell phone number: \");\n    scanf(\"%s\", numbers-&gt;cell);\n\n    printf(\"Do you want to enter a home phone number? (y or n): \");\n    scanf(\"%c\", &amp;answer);\n    result = yes();\n    while (result == 1) {\n        printf(\"Please enter the contact's home phone number: \");\n        scanf(\"%s\", numbers-&gt;home);\n        break;\n    }\n\n    printf(\"Do you want to enter a business phone number? (y or n): \");\n    fflush(stdin);\n    scanf(\"%c\", &amp;answer);\n    result = yes();\n    while (result == 1) {\n        printf(\"Please enter the contact's business phone number: \");\n        scanf(\"%s\", numbers-&gt;business);\n        break;\n    }\n}\n</code></pre>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 1118, "user_id": 8074683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e8Ik8.jpg?s=128&g=1", "display_name": "Anton", "link": "https://stackoverflow.com/users/8074683/anton"}, "edited": false, "score": 0, "creation_date": 1521665992, "post_id": 49416324, "comment_id": 85834586, "body": "swap the last two lines of code"}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1521667157, "post_id": 49416324, "comment_id": 85835128, "body": "I&#39;ve made an update of my answer giving you a suggestion as to how to improve this function."}], "answers": [{"tags": [], "owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "is_accepted": true, "score": 1, "last_activity_date": 1521666853, "last_edit_date": 1521666853, "creation_date": 1521666186, "answer_id": 49416466, "question_id": 49416324, "link": "https://stackoverflow.com/questions/49416324/realloc-program-received-signal-sigtrap-trace-breakpoint-trap/49416466#49416466", "title": "realloc: Program received signal SIGTRAP, Trace/breakpoint trap", "body": "<p>There is a logic problem here. You initially allocate space for one object with\n<code>calloc</code> then call <code>add_entry</code> with the count equals to 0.</p>\n\n<p>Then you add the new entry at index <code>current_count</code> which is 0 at this point.\nThen you resize the memory with <code>current_count + 1</code>, which is also 1. So you are\nnot resizing the memory at all.</p>\n\n<p>In the next iteration, <code>entry_count</code> is 1 and you add a new element at\n<code>entries[1]</code>. And that's the problem, you are accessing the memory out of\nbounds, because you still have space for only <strong>one</strong> object at this time.</p>\n\n<p>Instead of reallocating by <code>current_count + 1</code>, you should reallocate by\n<code>current_count + 2</code>, so that the next iteration has space to put the new\nelements at the end of the memory.</p>\n\n<pre><code>void *add_entry(Entry *entries, int current_count)\n{\n    Entry entry;\n\n    printf(\"Enter name: \");\n    scanf(\" %[^\\n]s\", entry.name);\n    printf(\"Enter number: \");\n    scanf(\" %[^\\n]s\", entry.number);\n    printf(\"\\n\");\n\n    entries[current_count] = entry;\n    return realloc(entries, sizeof(Entry) * (current_count + 2));  // &lt;-- +2\n}\n</code></pre>\n\n<p>Note that your <code>current_count</code> variable is always one step behind the real size of the allocation, that's why you need the <code>+2</code></p>\n\n<p><strong>edit</strong></p>\n\n<p>Note also that the more natural way would be to resize first, and then insert\nthe new object. So I would initialize the memory with <code>NULL</code> and do it like\nthis:</p>\n\n<pre><code>int main()\n{\n    size_t entry_count = 0;\n    Entry *entries = NULL, *tmp;\n    int choice = 0;\n\n    while (1) {\n        printf(\"Options:\\n1) Add Entry\\n2) Modify Entry\\n3) Print Entries\\n4) Exit\\n\\nSelect an option: \");\n        scanf(\" %d\", &amp;choice);\n        switch (choice) {\n        case 1:\n            tmp = add_entry(entries, &amp;entry_count);\n            if(tmp == NULL)\n            {\n                // error handling\n                // entries still point to the old memory\n                // could be useful in error handling\n\n                free(entries);\n                return 1;\n            }\n\n            entries = tmp;\n            break;\n            // ...\n        }\n    }\n}\n\nvoid *add_entry(Entry *entries, size_t *current_count)\n{\n    if(current_count == NULL)\n        return NULL;\n\n    Entry entry;\n\n    printf(\"Enter name: \");\n    scanf(\" %[^\\n]s\", entry.name);\n    printf(\"Enter number: \");\n    scanf(\" %[^\\n]s\", entry.number);\n    printf(\"\\n\");\n\n    if(entries == NULL)\n        *current_count = 0;\n\n    Entry *tmp = realloc(entries, (*current_count + 1) * sizeof *entries);\n\n    if(tmp == NULL)\n        return NULL;\n\n    entries = tmp;\n\n    entries[(*current_count)++] = entry;\n\n    return entries;\n}\n</code></pre>\n\n<p>Note here that the <code>realloc</code> <strong>and</strong> the increment of the counting variable\nhappens in the same function. Only when everything goes OK, you should increase\nthe counter. Also note that <code>entries</code> is initialized with <code>NULL</code>, because\n<code>realloc(NULL, size)</code> is equivalent to <code>malloc(size)</code>.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4592253"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2308, "favorite_count": 0, "accepted_answer_id": 49416466, "answer_count": 1, "score": 0, "last_activity_date": 1521666853, "creation_date": 1521665652, "question_id": 49416324, "link": "https://stackoverflow.com/questions/49416324/realloc-program-received-signal-sigtrap-trace-breakpoint-trap", "title": "realloc: Program received signal SIGTRAP, Trace/breakpoint trap", "body": "<p>I am working on a program that stores an arbitrarily long list of contacts (names and phone numbers). The entries are stored in an array that is resized each time a new element is added with the <code>realloc</code> function. The first contact can be added and displayed normally. However, when I try to add the second contact, the program crashes with the following message:</p>\n\n<pre><code>Program received signal SIGTRAP, Trace/breakpoint trap.\nIn ntdll!RtlZeroHeap () (C:\\WINDOWS\\SYSTEM32\\ntdll.dll)\n</code></pre>\n\n<p>No breakpoints have been set in my editor. The debugger says the problem is on the line containing the <code>realloc</code> statement. How can I fix this issue? I have included the relevant sections of code below.</p>\n\n<pre><code>#define STRING_LENGTH 32\n\ntypedef struct entry_t {\n    char name[STRING_LENGTH];\n    char number[STRING_LENGTH];\n} Entry;\n\nvoid *add_entry(Entry*, int);\n\nint main()\n{\n    int entry_count = 0;\n    Entry *entries = calloc(1, sizeof(Entry));\n    int choice = 0;\n\n    while (1) {\n        printf(\"Options:\\n1) Add Entry\\n2) Modify Entry\\n3) Print Entries\\n4) Exit\\n\\nSelect an option: \");\n        scanf(\" %d\", &amp;choice);\n        switch (choice) {\n        case 1:\n            entries = add_entry(entries, entry_count++);\n            break;\n            // ...\n        }\n    }\n}\n\nvoid *add_entry(Entry *entries, int current_count)\n{\n    Entry entry;\n\n    printf(\"Enter name: \");\n    scanf(\" %[^\\n]s\", entry.name);\n    printf(\"Enter number: \");\n    scanf(\" %[^\\n]s\", entry.number);\n    printf(\"\\n\");\n\n    entries[current_count] = entry;\n    return realloc(entries, sizeof(Entry) * (current_count + 1));\n}\n</code></pre>\n"}, {"tags": ["c", "pointers", "struct"], "comments": [{"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1521666667, "post_id": 49416129, "comment_id": 85834915, "body": "You are perhaps trying to emulate a C++ feature, namely member pointers. You can always use a <i>normal</i> pointer and let it point to a member of a <i>particular</i> struct object, but that may not be what you want (you want a selector for a struct you can pass at run time)."}], "answers": [{"comments": [{"owner": {"reputation": 739, "user_id": 5433628, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e35c4de6242c82161ff4cacdbd29d0d2?s=128&d=identicon&r=PG", "display_name": "ebosi", "link": "https://stackoverflow.com/users/5433628/ebosi"}, "edited": false, "score": 0, "creation_date": 1521665428, "post_id": 49416209, "comment_id": 85834327, "body": "Good to know that it isn&#39;t possible. As I wanted to be &quot;smart&quot;, I indeed defined each letter of the alphabet as a member of <code>my_struct</code>, and hoped to be able to &quot;map&quot; them. Yet it seems I won&#39;t avoid a switch statement!"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 739, "user_id": 5433628, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e35c4de6242c82161ff4cacdbd29d0d2?s=128&d=identicon&r=PG", "display_name": "ebosi", "link": "https://stackoverflow.com/users/5433628/ebosi"}, "edited": false, "score": 1, "creation_date": 1521665672, "post_id": 49416209, "comment_id": 85834434, "body": "@ebo I&#39;ve updated it to show how to use a lookup table."}], "tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": false, "score": 4, "last_activity_date": 1521665448, "last_edit_date": 1521665448, "creation_date": 1521665224, "answer_id": 49416209, "question_id": 49416129, "link": "https://stackoverflow.com/questions/49416129/membership-operator-how-to-use-my-var-actual-value-in-my-struct-my-var/49416209#49416209", "title": "Membership operator: How to use &quot;my_var&quot; actual value in &quot;my_struct-&gt;my_var&quot;?", "body": "<p>There's nothing built-in that does this. C has no run-time introspection of structure types; member names only exist at compile time.</p>\n\n<p>You can use a conditional operator:</p>\n\n<pre><code>my_struct *x = my_var == 'a' ? my_struct-&gt;a : my_struct-&gt;b;\n</code></pre>\n\n<p>If the actual structure is more complicated (you only used 2 members as a simplified example in the question) you could use a lookup table:</p>\n\n<pre><code>struct offset_map {\n    char name;\n    size_t offset;\n}[] = {\n    {'a', offsetof(my_struct, a)},\n    {'b', offsetof(my_struct, b)}\n};\n</code></pre>\n\n<p>You can then write a function that loops through the table and returns the corresponding offset.</p>\n\n<pre><code>size_t get_offset(char name) {\n    int size = sizeof(offset_map)/sizeof(*offset_map);\n    for (int i = 0; i &lt; size; i++) {\n        if (offset_map[i].name == name) {\n            return offset_map[i].offset;\n        }\n    }\n    return 0;\n}\n\nmy_struct *x = (my_struct *)((char *)&amp;my_struct + get_offset(my_var));\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7975, "user_id": 5660517, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/1iIxK.jpg?s=128&g=1", "display_name": "Ronan Boiteau", "link": "https://stackoverflow.com/users/5660517/ronan-boiteau"}, "is_accepted": false, "score": 1, "last_activity_date": 1521665345, "creation_date": 1521665345, "answer_id": 49416241, "question_id": 49416129, "link": "https://stackoverflow.com/questions/49416129/membership-operator-how-to-use-my-var-actual-value-in-my-struct-my-var/49416241#49416241", "title": "Membership operator: How to use &quot;my_var&quot; actual value in &quot;my_struct-&gt;my_var&quot;?", "body": "<p><strong>You can't transform a <code>char</code> variable into code.</strong></p>\n\n<p>You need to check <code>my_var</code>'s value:</p>\n\n<pre><code>if (my_var == 'a')\n  my_struct-&gt;a;\nelse if (my_var == 'b')\n  my_struct-&gt;b;\nelse\n  ; // Handle unexpected value?\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "is_accepted": true, "score": 3, "last_activity_date": 1521667115, "creation_date": 1521667115, "answer_id": 49416686, "question_id": 49416129, "link": "https://stackoverflow.com/questions/49416129/membership-operator-how-to-use-my-var-actual-value-in-my-struct-my-var/49416686#49416686", "title": "Membership operator: How to use &quot;my_var&quot; actual value in &quot;my_struct-&gt;my_var&quot;?", "body": "<p>Let me point out that for indexing we usually use arrays ;-). IIUC, your use case implies that all members you want to be able to select through the character must be of the same type, here <code>my_struct *</code>. So define an array:</p>\n\n<pre><code>struct my_struct{\n  int foo;\n  my_struct* ptrs[255]; /* can index with any char */\n};\n</code></pre>\n\n<p>Now you can happily index with characters: </p>\n\n<pre><code>struct my_struct *sP; \n/* initialize sP and *sP... */\nstruct my_struct *sMemP = sP-&gt;ptrs['a'];\n</code></pre>\n"}], "owner": {"reputation": 739, "user_id": 5433628, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e35c4de6242c82161ff4cacdbd29d0d2?s=128&d=identicon&r=PG", "display_name": "ebosi", "link": "https://stackoverflow.com/users/5433628/ebosi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 49416686, "answer_count": 3, "score": 0, "last_activity_date": 1521667115, "creation_date": 1521664969, "last_edit_date": 1521665218, "question_id": 49416129, "link": "https://stackoverflow.com/questions/49416129/membership-operator-how-to-use-my-var-actual-value-in-my-struct-my-var", "title": "Membership operator: How to use &quot;my_var&quot; actual value in &quot;my_struct-&gt;my_var&quot;?", "body": "<p>In C, I have defined following <code>struct</code>:</p>\n\n<pre><code>typedef struct my_struct{\n  int foo;\n  my_struct* a;\n  my_struct* b;\n} my_struct;\n</code></pre>\n\n<p>Now, I have a variable <code>char my_var;</code> that holds either the value \"a\" or \"b\".</p>\n\n<p><strong>Question:</strong> How to access \"<code>my_struct-&gt;my_var</code>\" where <code>my_var</code> is considered as its actual value (i.e. either as the character <code>a</code> or <code>b</code>) rather than as the \"string\" <code>my_var</code>?</p>\n\n<p>(Indeed, my compiler throws an error saying that there is no member \"<code>my_var</code>\" defined in the struct <code>my_struct</code>.)</p>\n"}, {"tags": ["c++", "c", "visual-studio", "winapi"], "comments": [{"owner": {"reputation": 33827, "user_id": 506413, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1a474f3be606bcc6f964913b523626e9?s=128&d=identicon&r=PG", "display_name": "Jonathan Potter", "link": "https://stackoverflow.com/users/506413/jonathan-potter"}, "edited": false, "score": 0, "creation_date": 1521663423, "post_id": 49415624, "comment_id": 85833291, "body": "Are you getting errors?"}, {"owner": {"reputation": 2784, "user_id": 8413636, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d8c46d1ea221e93d32a1b3d2ee354cae?s=128&d=identicon&r=PG&f=1", "display_name": "zzxyz", "link": "https://stackoverflow.com/users/8413636/zzxyz"}, "reply_to_user": {"reputation": 33827, "user_id": 506413, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1a474f3be606bcc6f964913b523626e9?s=128&d=identicon&r=PG", "display_name": "Jonathan Potter", "link": "https://stackoverflow.com/users/506413/jonathan-potter"}, "edited": false, "score": 0, "creation_date": 1521663928, "post_id": 49415624, "comment_id": 85833552, "body": "@JonathanPotter - No.  Thanks--updated the question."}, {"owner": {"reputation": 33827, "user_id": 506413, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1a474f3be606bcc6f964913b523626e9?s=128&d=identicon&r=PG", "display_name": "Jonathan Potter", "link": "https://stackoverflow.com/users/506413/jonathan-potter"}, "edited": false, "score": 5, "creation_date": 1521664129, "post_id": 49415624, "comment_id": 85833671, "body": "I think _WINDLL is something the compiler defines for you, to tell you you&#39;re being compiled as a DLL. I don&#39;t think it changes anything implicitly; your code would have to actually test for it via #ifdef."}, {"owner": {"reputation": 2784, "user_id": 8413636, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d8c46d1ea221e93d32a1b3d2ee354cae?s=128&d=identicon&r=PG&f=1", "display_name": "zzxyz", "link": "https://stackoverflow.com/users/8413636/zzxyz"}, "reply_to_user": {"reputation": 33827, "user_id": 506413, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1a474f3be606bcc6f964913b523626e9?s=128&d=identicon&r=PG", "display_name": "Jonathan Potter", "link": "https://stackoverflow.com/users/506413/jonathan-potter"}, "edited": false, "score": 0, "creation_date": 1521664527, "post_id": 49415624, "comment_id": 85833864, "body": "@JonathanPotter - Ahhh, and it is being checked in a different solution which uses these same .props files.  Thanks.  I both hope and believe you are correct :)  I certainly didn&#39;t find it in the system headers, but I&#39;m always reluctant to trust that as a &quot;final answer&quot; :)"}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1521665707, "post_id": 49415624, "comment_id": 85834455, "body": "&quot;include Windows.h for sockets, mutexes, and threads&quot; at least for &quot;mutex&quot; and &quot;thread&quot;, I&#39;d recommend <code>include &lt;mutex&gt;</code> and <code>include &lt;thread&gt;</code> instead."}, {"owner": {"reputation": 2784, "user_id": 8413636, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d8c46d1ea221e93d32a1b3d2ee354cae?s=128&d=identicon&r=PG&f=1", "display_name": "zzxyz", "link": "https://stackoverflow.com/users/8413636/zzxyz"}, "reply_to_user": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 1, "creation_date": 1521668854, "post_id": 49415624, "comment_id": 85835938, "body": "@JesperJuhl I don\u2019t wanna trigger the C guys :). Plus it\u2019s an OS abstraction layer. Pedal to the metal and all."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 1, "creation_date": 1521668987, "post_id": 49415624, "comment_id": 85835986, "body": "@zzxyz. - I&#39;m not following you. <code>&lt;mutex&gt;</code> and <code>&lt;thread&gt;</code> are C++ headers, <i>not</i> C headers. What are you on about?"}, {"owner": {"reputation": 2784, "user_id": 8413636, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d8c46d1ea221e93d32a1b3d2ee354cae?s=128&d=identicon&r=PG&f=1", "display_name": "zzxyz", "link": "https://stackoverflow.com/users/8413636/zzxyz"}, "reply_to_user": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 2, "creation_date": 1521671546, "post_id": 49415624, "comment_id": 85836977, "body": "@JesperJuhl They are C guys, and I&#39;m going to pull STL headers into their code?  I truly don&#39;t understand what&#39;s not to get about that causing a problem."}, {"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 1, "creation_date": 1521672711, "post_id": 49415624, "comment_id": 85837316, "body": "It is not a predefined macro like Jonathan guessed.  This comes from the &quot;Windows Dynamic Link Library&quot; property sheet.  Use View &gt; (Other Windows) &gt; Property Manager to see that.  Doesn&#39;t mean anything more than &quot;this project builds a DLL that is going to be used on Windows&quot;.  You&#39;ll certainly lose elegance points for having it defined in a static library project but you&#39;ll probably get away with it.  Removing the property sheet would be wise."}, {"owner": {"reputation": 2784, "user_id": 8413636, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d8c46d1ea221e93d32a1b3d2ee354cae?s=128&d=identicon&r=PG&f=1", "display_name": "zzxyz", "link": "https://stackoverflow.com/users/8413636/zzxyz"}, "reply_to_user": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1521673557, "post_id": 49415624, "comment_id": 85837619, "body": "@HansPassant - It is explicitly defined in one of OUR property sheets (I know, I know) that is used by projects I&#39;ve never even looked at.  God only knows what those projects are doing with it.  I can&#39;t remove the sheet without major headaches, either."}, {"owner": {"reputation": 30593, "user_id": 27491, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/48cc12ad73f816bc5b115a9ca6965328?s=128&d=identicon&r=PG", "display_name": "Chris Becke", "link": "https://stackoverflow.com/users/27491/chris-becke"}, "edited": false, "score": 0, "creation_date": 1521698807, "post_id": 49415624, "comment_id": 85844172, "body": "_WINDLL might not be defined by the compiler, but it is defined by the implementation. Generally any identifier with leading underscore followed by a capital letter is reserved and its existence should be managed, if not by the compiler itself, the bundled runtime."}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1521749895, "post_id": 49415624, "comment_id": 85877389, "body": "Surely your property sheets are under source control. So just find out, who added that property sheet to your project, or who added the <code>_WINDLL</code> preprocessor symbol to the property sheet, and ask for clarification. The commit message may provide some clues as well."}], "owner": {"reputation": 2784, "user_id": 8413636, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d8c46d1ea221e93d32a1b3d2ee354cae?s=128&d=identicon&r=PG&f=1", "display_name": "zzxyz", "link": "https://stackoverflow.com/users/8413636/zzxyz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 993, "favorite_count": 1, "answer_count": 0, "score": 4, "last_activity_date": 1521674604, "creation_date": 1521662799, "last_edit_date": 1521674604, "question_id": 49415624, "link": "https://stackoverflow.com/questions/49415624/effect-of-defining-windll-in-a-static-lib", "title": "Effect of defining _WINDLL in a static lib", "body": "<p>For reasons I'm not going to get heavily into, but boil down to complicated .props chains, I have a number of projects (All <code>C</code> compiled with a <code>C++</code> compiler), that in a <code>DLL</code> <strong>solution,</strong> still build static libraries, but define <code>_WINDLL</code>.  This is fixable, but not easily.</p>\n\n<p>None of these projects will or ever will use MFC--or anything like it--but <em>one</em> project--an OS abstraction layer--does include Windows.h for sockets, mutexes, and threads.</p>\n\n<p>There are no errors or warnings during compilation because of this, and the application seems to run fine, but it's an ancient beast, with hundreds of little features and no unit tests :)</p>\n\n<p>My question is: do I <strong>need</strong> to fix these static libraries to not define _WINDLL?</p>\n\n<p>EDIT:</p>\n\n<p>More background would seem to be necessary although I think I have my answer:</p>\n\n<p>The property sheet defining this is OUR property sheet, and it's part of a relatively complex system that allows us to build Release/Debug/Lib/Dll Arm/WinCE/x86/x64 Clang/MSVC with <em>relatively</em> little pain, but it does occasionally have its issues.  The property sheets are hierarchical and are used by both projects I work with and by projects I have no desire to touch.</p>\n"}, {"tags": ["c", "matrix", "binary", "fwrite", "fread"], "comments": [{"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 1, "creation_date": 1521663406, "post_id": 49415616, "comment_id": 85833287, "body": "That&#39;s 1.6 billion binary values, which you&#39;re reading/writing as ASCII bytes and you&#39;re processing them one value at a time. The hour-plus time doesn&#39;t surprise me at all. Do you have control over the file format? Perhaps you could make it binary and process it a word at a time, handling several bits before hitting the file system. Or even if it&#39;s ASCII, deal with it a line at a time in an array. But hitting the file system for every cell is going to take a very long time."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1521663793, "post_id": 49415616, "comment_id": 85833490, "body": "How are you getting <code>40000x40000</code> from <code>&quot;input format, the first line contains the dem of the 2d matrix&quot;</code> which has <code>20 20</code> as the first line?"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 1, "creation_date": 1521665993, "post_id": 49415616, "comment_id": 85834589, "body": "Does your &quot;binary&quot; <code>input_filename</code> really have spaces in it? Or is the format as shown above, just representative of the values in the file? Binary files are generally not stored with <code>spaces</code> or <code>newlines</code>. Those are formatted &quot;text&quot; file contents. The answer to this question, determines what you need to do to input your data, and then output your data. Either way, there is no need for a 2D array, Just <code>fread</code> (or <code>mmap</code>, if available) the file into a buffer and write it out however you wish. That will be orders of magnitude faster than what you are doing."}, {"owner": {"reputation": 195, "user_id": 5914033, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1018951738161448/picture?type=large", "display_name": "Cees Mandjes", "link": "https://stackoverflow.com/users/5914033/cees-mandjes"}, "reply_to_user": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 0, "creation_date": 1521679186, "post_id": 49415616, "comment_id": 85839094, "body": "@lurker well I just have to set the grid array variable by the given file."}, {"owner": {"reputation": 195, "user_id": 5914033, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1018951738161448/picture?type=large", "display_name": "Cees Mandjes", "link": "https://stackoverflow.com/users/5914033/cees-mandjes"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1521679239, "post_id": 49415616, "comment_id": 85839102, "body": "@DavidC.Rankin The example shown is the 20x20 matrix (showed on the first line). The file which im trying to handle would have 40000 40000 on the first line. And yes it has spaces and new lines in it, after I parse the data I really need to store the values in the boolean 2d array since I am going to do some calculations on it."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1521685075, "post_id": 49415616, "comment_id": 85840390, "body": "OK, recommendation would be to ditch <code>bool</code>, you are not buying any space savings, and if you are not going to use <code>bits</code> instead of <code>bytes</code>, you may even be costing yourself memory, because there is no guarantee that <code>bool</code> uses the smallest storage size. (there are compiler options for some OS&#39;s to insure this)"}], "answers": [{"tags": [], "owner": {"reputation": 1273, "user_id": 8285732, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edc625d1ed5c36dfef98d17dfeac7fe7?s=128&d=identicon&r=PG&f=1", "display_name": "milbrandt", "link": "https://stackoverflow.com/users/8285732/milbrandt"}, "is_accepted": false, "score": 0, "last_activity_date": 1521663517, "creation_date": 1521663517, "answer_id": 49415794, "question_id": 49415616, "link": "https://stackoverflow.com/questions/49415616/c-read-big-matrix-from-input-file/49415794#49415794", "title": "C read big matrix from input file", "body": "<p>Read larger chunks from the input file - not every char as a separate call. Eg a complete row of your matrix at once.</p>\n\n<p>Why do you use in the inner loop of <code>set_grid_values_file</code> two <code>fwrite</code> calls. Better to combine them:</p>\n\n<pre><code>char buffer[2] = \"  \";\nfor(i=0; i&lt;n; i++){\n    int base = grid+i*m;\n    for(j=0; j&lt;m; j++){\n        fseek(out_file, k, SEEK_SET);           \n        buffer[0] = (*(base + j) ? '1' : '0');\n        fwrite (buffer, 1, 2, out_file);    \n        k+=2; \n     }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": false, "score": 0, "last_activity_date": 1521663589, "creation_date": 1521663589, "answer_id": 49415814, "question_id": 49415616, "link": "https://stackoverflow.com/questions/49415616/c-read-big-matrix-from-input-file/49415814#49415814", "title": "C read big matrix from input file", "body": "<p>I would suggest removing the calls to <code>fseek</code>.</p>\n\n<pre><code>while(search){\n\n   // Make sure the read is successful. Otherwise, break out of the loop.\n   if ( fread(buffer, 1, 1, in_file) != 1 )\n   {\n      break;\n   } \n\n   if(*buffer == '\\n')\n       search = false;\n   k++;         \n}\nint i,j;    \n\n// Rewind the file\nfseek(in_file, 0, SEEK_SET);\n\nfor(i=0; i&lt;n; i++){\n    for(j=0; j&lt;m; j++){\n\n      // Make sure the read is successful. Otherwise, break out of the loop.\n      if ( fread(buffer, 1, 1, in_file) != 1 )\n      {\n         break;\n      } \n\n      *((grid+i*m) + j) = atof(buffer);   \n      k+=2;\n    }\n}\n</code></pre>\n\n<p>Also <code>atof(buffer)</code> is a problem when <code>buffer</code> has only one element in it. Use at least a two element array.</p>\n\n<pre><code>char buffer[2] = {0};\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "is_accepted": false, "score": 0, "last_activity_date": 1521668718, "last_edit_date": 1521668718, "creation_date": 1521665311, "answer_id": 49416229, "question_id": 49415616, "link": "https://stackoverflow.com/questions/49415616/c-read-big-matrix-from-input-file/49416229#49416229", "title": "C read big matrix from input file", "body": "<p>This is about the simplest(and possibly the fastest) method.</p>\n\n<ul>\n<li>stdio is buffered, <code>getc()</code> is most probably a macro</li>\n<li>function calls are costly (they trash the instruction pipeline and cache) ; you use 1seek+1fread per boolean bit read.</li>\n<li>you dont need to seek the file; just read it sequentially and put the values at the correct{row,col} positions.</li>\n<li>setting and testing an indicator variable (your <code>search</code>) is a waste of time (often taught in Pascal and Java classes...) ;instead: just jump out of the loop (or continue)</li>\n<li>I am assuming an ASCII file with spaces between the values, but without the{nrow,ncol} at the top (the{n,m}values are supplied as function arguments)</li>\n</ul>\n\n<hr>\n\n<pre><code>void get_grid_values_file(bool *grid, int n, int m, char *input_filename)\n{\nunsigned col,row;\nFILE * fp;\n\nfp= fopen (input_filename, \"r\" );\nif(!fp)return;\n\nfor(row=col=0; ; ) {\n        int ch;\n        ch=getc(fp);\n        if (ch == EOF)break;\n        if (ch &lt; '0' || ch &gt; '1') continue;\n\n        grid[row*m+col++] = (ch == '0') ? False :True;\n        if (col == m) {col=0; row++; }\n        if (row == n) break;\n        }\nfclose(fp);\nreturn;\n}\n</code></pre>\n"}], "owner": {"reputation": 195, "user_id": 5914033, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1018951738161448/picture?type=large", "display_name": "Cees Mandjes", "link": "https://stackoverflow.com/users/5914033/cees-mandjes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 191, "favorite_count": 1, "answer_count": 3, "score": 0, "last_activity_date": 1521668718, "creation_date": 1521662756, "question_id": 49415616, "link": "https://stackoverflow.com/questions/49415616/c-read-big-matrix-from-input-file", "title": "C read big matrix from input file", "body": "<p>Im trying to read a 40000x40000 boolean (binary) matrix from a input file and store it in a variable. After I store it in the variable, I want to write it to a file. However, with the code I wrote it takes more than a hour. Can someone help me out? I think im doing something wrong. </p>\n\n<p>Code </p>\n\n<pre><code>void get_grid_values_file(bool *grid, int n, int m, char *input_filename){\n    FILE *in_file;\n    in_file = fopen(input_filename, \"r\");  \n    char buffer[1]; \n    bool search = true;\n    int k=0;\n    while(search){\n       fseek(in_file, k, SEEK_SET);\n       fread(buffer, 1, 1, in_file); \n        if(*buffer == '\\n')\n            search = false;\n        k++;         \n    }\n    int i,j;    \n    for(i=0; i&lt;n; i++){\n        for(j=0; j&lt;m; j++){\n           fseek(in_file, k, SEEK_SET);\n           fread(buffer, 1, 1, in_file);  \n           *((grid+i*m) + j) = atof(buffer);   \n           k+=2;\n        }\n    }\n    fclose(in_file);\n}\n\nvoid set_grid_values_file(bool *grid, int n, int m, char *output_filename){\n    FILE *out_file;\n    out_file = fopen(output_filename, \"w\"); \n    char buffer[1] = \" \"; \n    //Set n,m and spaces\n    int length_n= (int) (log10 (abs (n))) + 1;\n    char char_n[length_n];\n    sprintf(char_n, \"%d\", n);\n    fseek(out_file, 0, SEEK_SET);\n    fwrite (char_n, length_n, 1, out_file);\n    fseek(out_file, length_n, SEEK_SET); \n    fwrite (\" \", 1, 1, out_file);      \n    int length_m= (int) (log10 (abs (m))) + 1;\n    char char_m[length_m];\n    sprintf(char_m, \"%d\", m);\n    fseek(out_file, length_n+1, SEEK_SET);\n    fwrite (char_m, length_m, 1, out_file);\n    fseek(out_file, length_n+1+length_m, SEEK_SET);\n    fwrite (\"\\n\", sizeof(char), 1, out_file);\n    //Set grid\n    int i,j;\n    int k =length_n + length_m + 2;\n    for(i=0; i&lt;n; i++){\n        for(j=0; j&lt;m; j++){\n           fseek(out_file, k, SEEK_SET);           \n           buffer[0] = (*((grid+i*m) + j) == true ? '1' : '0');\n           fwrite (buffer, 1, 1, out_file);    \n           k++;\n           fseek(out_file, k, SEEK_SET); \n           fwrite (\" \", 1, 1, out_file);\n           k++; \n        }\n        fseek(out_file, k, SEEK_SET);\n        fwrite (\"\\n\", sizeof(char), 1, out_file);\n        k++;\n    }\n}\n\nint main(int argc, char *argv[])\n{\n\n    char *input_filename = \"gen0_40kx40k.in\";\n    char *output_filename = \"gol_output.out\";\n    int n = 40000;\n    int m = 40000;\n\n\n    bool *grid = (bool *)malloc(n*m*sizeof(bool));\n    //Read\n    get_grid_values_file((bool *)grid, n, m, input_filename);\n\n    //Write\n    set_grid_values_file((bool *)grid, n, m, output_filename);\n\n    return 0;\n}\n</code></pre>\n\n<p>Input format, the first line contains the dem of the 2d matrix: <br/>\n20 20<br/>\n1 0 1 0 0 1 0 0 1 0 1 0 1 0 1 1 0 1 0 0 <br/>\n1 1 0 0 0 0 0 1 0 1 1 1 1 0 0 1 0 0 1 1 <br/>\n0 1 1 0 1 0 1 1 0 0 0 1 1 0 0 1 1 0 0 1 <br/>\n1 0 1 1 0 1 0 0 1 0 1 1 1 0 1 0 1 1 1 1 <br/>\n1 1 0 0 0 0 0 1 0 0 0 0 0 1 1 1 0 1 1 1 <br/>\n1 1 1 0 1 0 0 0 1 0 1 0 1 0 1 1 0 1 0 1<br/>\n1 1 1 0 0 0 1 1 1 0 0 1 1 1 1 1 0 0 1 1<br/>\n0 1 0 1 1 1 1 1 0 1 0 1 0 1 1 1 1 0 0 1<br/>\n1 0 0 0 0 1 1 0 1 1 1 1 0 1 1 1 0 0 0 0<br/>\n1 1 0 0 0 1 1 0 0 1 1 1 1 1 1 1 0 1 1 0<br/>\n0 1 1 0 0 0 1 1 0 1 1 0 0 1 0 1 1 1 1 1<br/>\n0 0 0 1 1 1 1 1 0 0 1 0 1 1 0 0 1 1 1 0<br/>\n1 0 0 1 0 0 0 1 1 1 0 1 1 0 0 0 1 1 0 0<br/>\n0 1 0 1 0 1 1 0 0 0 0 1 1 0 1 1 0 1 0 1<br/>\n1 0 0 0 0 0 1 1 0 1 1 0 0 0 1 1 1 1 1 1<br/>\n1 1 1 0 1 0 1 1 1 1 0 0 1 0 1 1 0 0 1 0<br/>\n1 0 0 1 0 0 0 1 1 1 1 0 0 0 1 1 0 0 0 1<br/>\n0 0 0 1 0 1 1 1 1 0 1 0 0 0 1 1 0 0 0 1<br/>\n1 1 1 0 1 0 1 1 1 0 1 1 0 1 0 1 0 1 0 1<br/>\n1 1 1 0 1 0 1 1 0 1 0 0 1 0 0 0 0 1 0 1<br/></p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 1795, "user_id": 6099096, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/623gR.jpg?s=128&g=1", "display_name": "Inline", "link": "https://stackoverflow.com/users/6099096/inline"}, "edited": false, "score": 0, "creation_date": 1521662583, "post_id": 49415516, "comment_id": 85832825, "body": "8 is the pointer size. You should store the number of elements in the array in separate variable. Compiler can&#39;t get size of array where your pointer <code>copyrow</code> points."}, {"owner": {"reputation": 3560, "user_id": 5550963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7jAip.png?s=128&g=1", "display_name": "CEPB", "link": "https://stackoverflow.com/users/5550963/cepb"}, "reply_to_user": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "edited": false, "score": 0, "creation_date": 1521662894, "post_id": 49415516, "comment_id": 85833004, "body": "@machine_1 I flagged it as well and SO added this comment :("}], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 9366947, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hCTyM.jpg?s=128&g=1", "display_name": "ManKino", "link": "https://stackoverflow.com/users/9366947/mankino"}, "edited": false, "score": 0, "creation_date": 1521663280, "post_id": 49415553, "comment_id": 85833226, "body": "I just want to create an array wich number of elements dinamiclly, in the example i&#39;m trying I know is 18 numbers of elements, but that will change for other examples."}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "reply_to_user": {"reputation": 57, "user_id": 9366947, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hCTyM.jpg?s=128&g=1", "display_name": "ManKino", "link": "https://stackoverflow.com/users/9366947/mankino"}, "edited": false, "score": 0, "creation_date": 1521664958, "post_id": 49415553, "comment_id": 85834106, "body": "@ManKino the answer tells you exactly what you are asking. Instead of writing <code>int nrOfElements = 18;</code> you calculate the number by any means necessary to your algorithm."}, {"owner": {"reputation": 57, "user_id": 9366947, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hCTyM.jpg?s=128&g=1", "display_name": "ManKino", "link": "https://stackoverflow.com/users/9366947/mankino"}, "edited": false, "score": 0, "creation_date": 1521670476, "post_id": 49415553, "comment_id": 85836618, "body": "Ok so if BYTE copyrow[18]; is the same as BYTE *copyrow = calloc(18, sizeof(BYTE)); and I know that, why my program doesn&#39;t work with the dinamic one. This array is not storing the 18 bytes of data in need, or as I can&#39;t see what is storing each element of the dinamic array, I don&#39;t know what really is storing each element."}, {"owner": {"reputation": 57, "user_id": 9366947, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hCTyM.jpg?s=128&g=1", "display_name": "ManKino", "link": "https://stackoverflow.com/users/9366947/mankino"}, "edited": false, "score": 0, "creation_date": 1521670814, "post_id": 49415553, "comment_id": 85836733, "body": "I didn&#39;t find a way to see in the debugger what are storing each element of the dinamic array"}], "tags": [], "owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "is_accepted": false, "score": 4, "last_activity_date": 1521663488, "last_edit_date": 1521663488, "creation_date": 1521662511, "answer_id": 49415553, "question_id": 49415516, "link": "https://stackoverflow.com/questions/49415516/dinamic-array-dont-allocate-the-same-numbers-of-elements-than-stack-array/49415553#49415553", "title": "Dinamic array don&#39;t allocate the same numbers of elements than stack array", "body": "<p>When you define <code>BYTE *copyrow;</code>, <code>copyrow</code> is a pointer, and the size of a pointer is <code>8</code> on a 64 bit architecture, regardless how \"big\" the memory block to which it points is.</p>\n\n<p><code>BYTE copyrow[18];</code>, in constrast, is an array of 18 <code>BYTE</code>-elements, and the size of such an array is <code>18 * sizeof(BYTE)</code>.</p>\n\n<p>You could do it this way:</p>\n\n<pre><code>int nrOfElements = 18;  // could be dynamically set as well.\nBYTE *copyrow = calloc(nrOfElements, sizeof(BYTE));\nint arrsize = sizeof(BYTE) * nrOfElements;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 57, "user_id": 9366947, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hCTyM.jpg?s=128&g=1", "display_name": "ManKino", "link": "https://stackoverflow.com/users/9366947/mankino"}, "edited": false, "score": 0, "creation_date": 1521663502, "post_id": 49415585, "comment_id": 85833330, "body": "so if the size of une element is 8, half of the problem is going good, but anyway I need to allocate dinamic memory for an array of element, that, in this example I know is 18 but that can change, the thin is, when I declare the array in the stack, the program works, but I need to do it dinamic."}], "tags": [], "owner": {"reputation": 15050, "user_id": 8605791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ae3be140b26db13a86d624dba4ef1c8?s=128&d=identicon&r=PG&f=1", "display_name": "llllllllll", "link": "https://stackoverflow.com/users/8605791/llllllllll"}, "is_accepted": false, "score": 2, "last_activity_date": 1521662613, "creation_date": 1521662613, "answer_id": 49415585, "question_id": 49415516, "link": "https://stackoverflow.com/questions/49415516/dinamic-array-dont-allocate-the-same-numbers-of-elements-than-stack-array/49415585#49415585", "title": "Dinamic array don&#39;t allocate the same numbers of elements than stack array", "body": "<p><strong>Array and pointer are different things.</strong></p>\n\n<p>In many cases array will decay to a pointer, but they are essentially different.</p>\n\n<pre><code>BYTE copyrow[18];\narrsize = sizeof(copyrow);\n</code></pre>\n\n<p>Here <code>sizeof</code> shows the size of the whole array, which is <code>18 * sizeof(BYTE)</code>.</p>\n\n<pre><code>BYTE *copyrow;\narrsize = sizeof(copyrow);\n</code></pre>\n\n<p>Here <code>sizeof</code> shows the size of a pointer, which has nothing to do with what it points to.</p>\n"}, {"tags": [], "owner": {"reputation": 136, "user_id": 9518341, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Witnessthis", "link": "https://stackoverflow.com/users/9518341/witnessthis"}, "is_accepted": false, "score": 0, "last_activity_date": 1521667064, "creation_date": 1521667064, "answer_id": 49416671, "question_id": 49415516, "link": "https://stackoverflow.com/questions/49415516/dinamic-array-dont-allocate-the-same-numbers-of-elements-than-stack-array/49416671#49416671", "title": "Dinamic array don&#39;t allocate the same numbers of elements than stack array", "body": "<p>To me, this was also a confusing topic when I started of with C. It seemed like <code>sizeof()</code> were implemented differently depending on what the argument was.</p>\n\n<p><code>sizeof()</code> is in most cases evaluated at compile time and the only reason <code>int a[n]; sizeof(a);</code> works is because all the information needed to figure out its size is present at compile time.</p>\n\n<pre><code>BYTE copyrow[18];\narrsize = sizeof(copyrow);\n</code></pre>\n\n<p>Is (as pointed out by others) interpreted as...</p>\n\n<pre><code>BYTE copyrow[18];\narrsize = sizeof(BYTE)*18;\n</code></pre>\n\n<p>...by the compiler. Hence the dynamic case would look the same:</p>\n\n<pre><code>BYTE *copyrow;\ncopyrow = (BYTE*) calloc(18, sizeof(BYTE));\narrsize = sizeof(BYTE)*18;\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 9366947, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hCTyM.jpg?s=128&g=1", "display_name": "ManKino", "link": "https://stackoverflow.com/users/9366947/mankino"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "closed_date": 1521676171, "answer_count": 3, "score": -2, "last_activity_date": 1521667064, "creation_date": 1521662353, "question_id": 49415516, "link": "https://stackoverflow.com/questions/49415516/dinamic-array-dont-allocate-the-same-numbers-of-elements-than-stack-array", "closed_reason": "Duplicate", "title": "Dinamic array don&#39;t allocate the same numbers of elements than stack array", "body": "<p>I'm trying to create an array of 18 elements of BYTE whit calloc but don't know why calloc only give me back only 8 elements, I did it manually in the stack and the program works.</p>\n\n<pre><code>int arrsize;\nBYTE copyrow[18];\narrsize = sizeof(copyrow);\n</code></pre>\n\n<p>When i compile here arrsize = to 18, so, evrething is fine.\nBut when I use calloc:</p>\n\n<pre><code>int arrsize;\nBYTE *copyrow;\ncopyrow = calloc(18, sizeof(BYTE));\narrsize = sizeof(copyrow);\n</code></pre>\n\n<p>Now the compiler say arrsize = to 8, so I don't know what's happening here. Need help.</p>\n"}, {"tags": ["c", "struct", "linked-list"], "answers": [{"comments": [{"owner": {"reputation": 611, "user_id": 4975410, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/CThkY.jpg?s=128&g=1", "display_name": "Saeed Rahmani", "link": "https://stackoverflow.com/users/4975410/saeed-rahmani"}, "edited": false, "score": 0, "creation_date": 1521662704, "post_id": 49415487, "comment_id": 85832888, "body": "I edited it. You are right and I have two structs."}, {"owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "reply_to_user": {"reputation": 611, "user_id": 4975410, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/CThkY.jpg?s=128&g=1", "display_name": "Saeed Rahmani", "link": "https://stackoverflow.com/users/4975410/saeed-rahmani"}, "edited": false, "score": 0, "creation_date": 1521662827, "post_id": 49415487, "comment_id": 85832968, "body": "Clear. Also think of redesigning <code>path_list</code> as suggested. Maintaining head and tail seperately is redundant and hard to use."}, {"owner": {"reputation": 611, "user_id": 4975410, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/CThkY.jpg?s=128&g=1", "display_name": "Saeed Rahmani", "link": "https://stackoverflow.com/users/4975410/saeed-rahmani"}, "edited": false, "score": 0, "creation_date": 1521662952, "post_id": 49415487, "comment_id": 85833042, "body": "Is your mean just save <code>head</code> and <code>tail</code> of each list? I think I got it, but why you remove <code>struct path_list *next</code>?"}, {"owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "reply_to_user": {"reputation": 611, "user_id": 4975410, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/CThkY.jpg?s=128&g=1", "display_name": "Saeed Rahmani", "link": "https://stackoverflow.com/users/4975410/saeed-rahmani"}, "edited": false, "score": 0, "creation_date": 1521663161, "post_id": 49415487, "comment_id": 85833160, "body": "a path_list maintains a series of path elements, of which <code>head</code> points to the first, and <code>tail</code> points to the  last. In between, the  path elements themselves point to the <code>next</code> path element in  the  series; a <code>path_list.next</code> pointing to another path_list very likely makes no sense, and a <code>path_list.next</code> pointing to a path makes  no sense, as <code>head</code> is already the entry point to the series.#"}, {"owner": {"reputation": 611, "user_id": 4975410, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/CThkY.jpg?s=128&g=1", "display_name": "Saeed Rahmani", "link": "https://stackoverflow.com/users/4975410/saeed-rahmani"}, "edited": false, "score": 0, "creation_date": 1521663567, "post_id": 49415487, "comment_id": 85833368, "body": "Ok. But I will have multiple paths and each path has some nodes. For example: path_1: <code>1, 2, 3</code>, path_2: <code>1, 4, 5</code> and ... and I want to have a list of all of them and I will be able to access them separately."}], "tags": [], "owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "is_accepted": true, "score": 3, "last_activity_date": 1521662250, "creation_date": 1521662250, "answer_id": 49415487, "question_id": 49415384, "link": "https://stackoverflow.com/questions/49415384/how-to-print-access-linked-lists-inside-of-a-linked-list/49415487#49415487", "title": "How to print (access) linked lists inside of a linked list?", "body": "<p>I suppose your data structure is a little bit weird, as you maintain two <code>path_lists</code>, i.e. a head and a tail, whereas there should be one path_list comprising both a head and a tail.</p>\n\n<p>I'd suggest to have the following data structure:</p>\n\n<pre><code>struct path {\n   int node;\n   struct path *next;\n};\n\nstruct path_list {\n   struct path *head;\n   struct path *tail;\n   int path_size;\n};\n</code></pre>\n"}], "owner": {"reputation": 611, "user_id": 4975410, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/CThkY.jpg?s=128&g=1", "display_name": "Saeed Rahmani", "link": "https://stackoverflow.com/users/4975410/saeed-rahmani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "closed_date": 1521679076, "accepted_answer_id": 49415487, "answer_count": 1, "score": 0, "last_activity_date": 1521662355, "creation_date": 1521661870, "last_edit_date": 1521662355, "question_id": 49415384, "link": "https://stackoverflow.com/questions/49415384/how-to-print-access-linked-lists-inside-of-a-linked-list", "closed_reason": "Needs details or clarity", "title": "How to print (access) linked lists inside of a linked list?", "body": "<p>Consider a linked list includes linked lists, as shown in the following code:</p>\n\n<pre><code>struct path {\n   int node;\n   struct path *next;\n};\n\nstruct path_list {\n   struct path *path;\n   int path_size;\n   struct path_list *next;\n};\n</code></pre>\n\n<p>So, I define <code>listHead</code> and <code>listTail</code> for <code>path_list</code> and I am able to print and access the <code>path_size</code>:</p>\n\n<pre><code>struct path_list *listHead = NULL;\nstruct path_list *listTail = NULL;\n</code></pre>\n\n<p>but I do not know how can I access the paths?</p>\n"}, {"tags": ["c", "wchar-t"], "answers": [{"comments": [{"owner": {"reputation": 7787, "user_id": 1257035, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WHLC8.png?s=128&g=1", "display_name": "a3f", "link": "https://stackoverflow.com/users/1257035/a3f"}, "edited": false, "score": 0, "creation_date": 1521663367, "post_id": 49415686, "comment_id": 85833266, "body": "You might want to post the answer to <a href=\"https://stackoverflow.com/questions/9900399/windows-version-of-wcswidth-l\" title=\"windows version of wcswidth l\">stackoverflow.com/questions/9900399/&hellip;</a> as well."}], "tags": [], "owner": {"reputation": 4732, "user_id": 138228, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/e824817a5d99296b8d0d956a4728071b?s=128&d=identicon&r=PG&f=1", "display_name": "stan", "link": "https://stackoverflow.com/users/138228/stan"}, "is_accepted": true, "score": 1, "last_activity_date": 1521663089, "creation_date": 1521663089, "answer_id": 49415686, "question_id": 49415376, "link": "https://stackoverflow.com/questions/49415376/width-of-wide-character-strings/49415686#49415686", "title": "Width of wide character strings", "body": "<p>Here's a Github repo that claims to offer a platform independent library to resolve this: <a href=\"https://github.com/joshuarubin/wcwidth9\" rel=\"nofollow noreferrer\">https://github.com/joshuarubin/wcwidth9</a></p>\n\n<p>Archived link: <a href=\"http://archive.is/C5UAF\" rel=\"nofollow noreferrer\">http://archive.is/C5UAF</a></p>\n"}], "owner": {"reputation": 579, "user_id": 6475845, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/96c3b9dcdd7fa12b319bc78e01ab7ccf?s=128&d=identicon&r=PG&f=1", "display_name": "Seleznev Anton", "link": "https://stackoverflow.com/users/6475845/seleznev-anton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "closed_date": 1521663310, "accepted_answer_id": 49415686, "answer_count": 1, "score": 2, "last_activity_date": 1521663089, "creation_date": 1521661825, "last_edit_date": 1521662658, "question_id": 49415376, "link": "https://stackoverflow.com/questions/49415376/width-of-wide-character-strings", "closed_reason": "Duplicate", "title": "Width of wide character strings", "body": "<p>I need a function to determine columns needed for a wide-character string in  different OS. In <strong>glibc</strong> there is a function <code>wcswidth</code>. It doesn't seem to be available in Windows. </p>\n\n<p>Are there alternatives to it in Windows that I can use? Or maybe there are already available some cross-platfrom standard funcions to do it?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 1, "creation_date": 1521660006, "post_id": 49414874, "comment_id": 85831448, "body": "<code>for(i=1;i&lt;601;i++){</code> -&gt; Why are you using 1 and 601?"}, {"owner": {"reputation": 107, "user_id": 9323404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a251c7ef2b1e5e3817ba76f155b75cf?s=128&d=identicon&r=PG&f=1", "display_name": "gnu-nobody", "link": "https://stackoverflow.com/users/9323404/gnu-nobody"}, "reply_to_user": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 0, "creation_date": 1521660149, "post_id": 49414874, "comment_id": 85831527, "body": "@EdHeal because I don&#39;t want 0 to be counted. And I want numbers before 600 to be counted. inputs are in the 0-600 range."}, {"owner": {"reputation": 4245, "user_id": 3613657, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/16dbb100614d9c85c0a1689ef29f5f43?s=128&d=identicon&r=PG&f=1", "display_name": "Mathieu Border&#233;", "link": "https://stackoverflow.com/users/3613657/mathieu-border%c3%a9"}, "edited": false, "score": 0, "creation_date": 1521660158, "post_id": 49414874, "comment_id": 85831533, "body": "I have not yet read the problem statement, but why do you only initialize 600 entries of ar2 instead of 601?"}, {"owner": {"reputation": 7787, "user_id": 1257035, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WHLC8.png?s=128&g=1", "display_name": "a3f", "link": "https://stackoverflow.com/users/1257035/a3f"}, "edited": false, "score": 3, "creation_date": 1521660215, "post_id": 49414874, "comment_id": 85831563, "body": "You are reading <code>n</code> in <code>main</code>&#39;s second line before initializing it."}, {"owner": {"reputation": 107, "user_id": 9323404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a251c7ef2b1e5e3817ba76f155b75cf?s=128&d=identicon&r=PG&f=1", "display_name": "gnu-nobody", "link": "https://stackoverflow.com/users/9323404/gnu-nobody"}, "reply_to_user": {"reputation": 4245, "user_id": 3613657, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/16dbb100614d9c85c0a1689ef29f5f43?s=128&d=identicon&r=PG&f=1", "display_name": "Mathieu Border&#233;", "link": "https://stackoverflow.com/users/3613657/mathieu-border%c3%a9"}, "edited": false, "score": 0, "creation_date": 1521660265, "post_id": 49414874, "comment_id": 85831594, "body": "@MathieuBorder&#233; Oh, I completely forgot that. I&#39;ll fix that and try again. Also , n is in the 1-100 range."}, {"owner": {"reputation": 107, "user_id": 9323404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a251c7ef2b1e5e3817ba76f155b75cf?s=128&d=identicon&r=PG&f=1", "display_name": "gnu-nobody", "link": "https://stackoverflow.com/users/9323404/gnu-nobody"}, "reply_to_user": {"reputation": 7787, "user_id": 1257035, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WHLC8.png?s=128&g=1", "display_name": "a3f", "link": "https://stackoverflow.com/users/1257035/a3f"}, "edited": false, "score": 0, "creation_date": 1521660376, "post_id": 49414874, "comment_id": 85831646, "body": "@a3f Thanks! I always do that kind of stupid mistakes."}, {"owner": {"reputation": 58292, "user_id": 34824, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/ri8DI.jpg?s=128&g=1", "display_name": "abelenky", "link": "https://stackoverflow.com/users/34824/abelenky"}, "edited": false, "score": 0, "creation_date": 1521660392, "post_id": 49414874, "comment_id": 85831657, "body": "Do not make us follow a link to understand the problem.  Post the problem description directly."}, {"owner": {"reputation": 107, "user_id": 9323404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a251c7ef2b1e5e3817ba76f155b75cf?s=128&d=identicon&r=PG&f=1", "display_name": "gnu-nobody", "link": "https://stackoverflow.com/users/9323404/gnu-nobody"}, "reply_to_user": {"reputation": 58292, "user_id": 34824, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/ri8DI.jpg?s=128&g=1", "display_name": "abelenky", "link": "https://stackoverflow.com/users/34824/abelenky"}, "edited": false, "score": 0, "creation_date": 1521660493, "post_id": 49414874, "comment_id": 85831708, "body": "@abelenky thanks. I&#39;ll do that in my next questions."}, {"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 1, "creation_date": 1521660515, "post_id": 49414874, "comment_id": 85831726, "body": "Perhaps edit this question"}, {"owner": {"reputation": 107, "user_id": 9323404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a251c7ef2b1e5e3817ba76f155b75cf?s=128&d=identicon&r=PG&f=1", "display_name": "gnu-nobody", "link": "https://stackoverflow.com/users/9323404/gnu-nobody"}, "reply_to_user": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 0, "creation_date": 1521660561, "post_id": 49414874, "comment_id": 85831740, "body": "@edheal no. The input may be 5 1 600 600 600 600 and the answer would be 2."}, {"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 0, "creation_date": 1521660739, "post_id": 49414874, "comment_id": 85831855, "body": "Just realised that - had to re-read it"}, {"owner": {"reputation": 109324, "user_id": 21926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6e61d47f9a6ec0a7a286835e51f3332?s=128&d=identicon&r=PG", "display_name": "Sean Bright", "link": "https://stackoverflow.com/users/21926/sean-bright"}, "edited": false, "score": 0, "creation_date": 1521664285, "post_id": 49414874, "comment_id": 85833743, "body": "For what it&#39;s worth - I edited the question to format the code better and I moved the declaration of <code>ar</code> to where it is now. OP&#39;s original code had it after the call to <code>scanf</code>. I&#39;ve corrected my error in the most recent edit."}], "answers": [{"tags": [], "owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "is_accepted": true, "score": 1, "last_activity_date": 1521660780, "last_edit_date": 1521660780, "creation_date": 1521660310, "answer_id": 49414998, "question_id": 49414874, "link": "https://stackoverflow.com/questions/49414874/counting-different-numbers-other-than-0-c-outputs-different-in-different-compi/49414998#49414998", "title": "Counting different numbers other than 0 (C) outputs different in different compilers", "body": "<p>You are defining an  array of size <code>n</code> before the value of <code>n</code> has beed determined (note that you <code>scanf</code> the value of <code>n</code> later). This is undefined behaviour, such that different compilers may give different results, and even starting your program on your machine may give different results (including crashes).</p>\n\n<p>instead of</p>\n\n<pre><code>int n, count = 0, i;\nint ar[n];\n...\n</code></pre>\n\n<p>write</p>\n\n<pre><code>int n, count = 0, i;\n\nscanf(\"%d\", &amp;n);\n\nint ar[n], ar2[601] = { 0 };\n</code></pre>\n\n<p>At least the malformed array should then be solved, and <code>ar2</code> is completely initialized with <code>0</code>. You can get rid of your <code>memset</code>, which initialized only 600 items (instead of 601) anyway.</p>\n"}, {"comments": [{"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1521662210, "post_id": 49415324, "comment_id": 85832617, "body": "If you change <code>bool seen_number_before[601] = { false };</code> to <code>bool seen_number_before[601] = { true };</code>, you can delete <code>v != 0 &amp;&amp;</code>. But this does not answer OP\u2019s question of why their code malfunctioned."}, {"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1521662320, "post_id": 49415324, "comment_id": 85832681, "body": "@EricPostpischil  - Good point about <code>true</code> . I would post this as a comment but it is code and too big."}, {"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1521662458, "post_id": 49415324, "comment_id": 85832756, "body": "Thanks Eric - The variable name <code>not_seen_number_before</code> could be improved - I leave that as an exercise to the reader"}], "tags": [], "owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "is_accepted": false, "score": 1, "last_activity_date": 1521664190, "last_edit_date": 1521664190, "creation_date": 1521661648, "answer_id": 49415324, "question_id": 49414874, "link": "https://stackoverflow.com/questions/49414874/counting-different-numbers-other-than-0-c-outputs-different-in-different-compi/49415324#49415324", "title": "Counting different numbers other than 0 (C) outputs different in different compilers", "body": "<p>Here is a quicker solution to the problem</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main()\n{\n    bool seen_number_before[601] = { false };\n    int count = 0;\n    seen_number_before[0] = true;\n\n    int n;\n\n    scanf(\"%d\", &amp;n); // Should do error checking here\n\n    for (int i = 0; i &lt; n; ++i) {\n       int v;\n       scanf(\"%d\", v); // More error checking\n\n       if (!seen_number_before[v]) // Not seen it before\n          seen_number_before[v] = true; // Mark it as seen\n          ++count;    // Add to the count\n       }\n     }\n     printf(\"%d\\n\", count);\n     return 0;\n}\n</code></pre>\n\n<p>}</p>\n"}, {"comments": [{"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1521666664, "post_id": 49415495, "comment_id": 85834914, "body": "(a) <code>a[i-1]</code> in the loop accesses <code>a[-1]</code> when <code>i</code> is 0. (b) <code>hash[599]</code> is not big enough as there are 600 possibilities for non-zero scores (1-600). (c) You suggest naming variables \u201cproperly\u201d but then use <code>hash</code> for what is merely an array of flags, not hashes. (d) <code>a</code> is never freed. (e) There is no need for <code>a</code> at all, since each value read is used only once, so it does not need to be stored. (f) <code>int *a = malloc(n * sizeof(int))</code> is better as <code>int *a = malloc(n * sizeof *a)</code>, as this avoids errors in editing the type while neglecting to edit both occurrences."}, {"owner": {"reputation": 595, "user_id": 2426364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eab086711e114f83a8f506ff75c1a995?s=128&d=identicon&r=PG", "display_name": "Benedetto Abbenanti", "link": "https://stackoverflow.com/users/2426364/benedetto-abbenanti"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1521673935, "post_id": 49415495, "comment_id": 85837744, "body": "Just a 1 minute of coding, don&#39;t take so personally.  I agree at all, but (d) a is freed when the program is terminated."}], "tags": [], "owner": {"reputation": 595, "user_id": 2426364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eab086711e114f83a8f506ff75c1a995?s=128&d=identicon&r=PG", "display_name": "Benedetto Abbenanti", "link": "https://stackoverflow.com/users/2426364/benedetto-abbenanti"}, "is_accepted": false, "score": 0, "last_activity_date": 1521673996, "last_edit_date": 1521673996, "creation_date": 1521662275, "answer_id": 49415495, "question_id": 49414874, "link": "https://stackoverflow.com/questions/49414874/counting-different-numbers-other-than-0-c-outputs-different-in-different-compi/49415495#49415495", "title": "Counting different numbers other than 0 (C) outputs different in different compilers", "body": "<p>There are some errors in your code, from a[n] when n is not defined.\nTo check errors try compiling with some useful options:</p>\n\n<pre><code>gcc -Wall code.c -o code -g\n</code></pre>\n\n<p>the -Wall is for Warning all and the -g is used for debug on valgrind (useful tool to check memory leak and other errors).</p>\n\n<p>Also I suggest you to name properly every var in your code, could helpful for a large size of code base.</p>\n\n<p>This is my solution,</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main(){\n    int n, count = 0;\n    scanf(\"%d\", &amp;n);\n\n    int *a = malloc(n * sizeof(int));\n    int hash[600] = { 0 };\n\n    for(int i=0; i&lt;n; i++){\n        scanf(\"%d \", &amp;a[i]);\n        if(a[i] != 0){\n            hash[a[i]] = 1;\n        }\n    }\n\n    for(int i=0; i&lt;600; i++){\n        printf(\"%d \", hash[i]);\n        if(hash[i] == 1) ++count;\n    }\n\n    printf(\"\\n\\n%d\\n\", count);\n\n    return 0;\n}\n</code></pre>\n\n<p>it can be optimized in time, using only one for, and/or in memory by creating an hashset of int, and every int can store 32 bit and do some bitwise operations, so if the nth bit is 1, count++, otherwise don't do nothing.</p>\n"}], "owner": {"reputation": 107, "user_id": 9323404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a251c7ef2b1e5e3817ba76f155b75cf?s=128&d=identicon&r=PG&f=1", "display_name": "gnu-nobody", "link": "https://stackoverflow.com/users/9323404/gnu-nobody"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 49414998, "answer_count": 3, "score": -3, "last_activity_date": 1521673996, "creation_date": 1521659808, "last_edit_date": 1521664310, "question_id": 49414874, "link": "https://stackoverflow.com/questions/49414874/counting-different-numbers-other-than-0-c-outputs-different-in-different-compi", "title": "Counting different numbers other than 0 (C) outputs different in different compilers", "body": "<p>I am trying to find the number of distinct numbers from input which are not equal to 0. n is in 1-100 range. The numbers in the array are in the 0-600 range.\n<a href=\"http://codeforces.com/problemset/problem/937/A\" rel=\"nofollow noreferrer\">http://codeforces.com/problemset/problem/937/A</a>\nFor this question, I wrote a code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main(void)\n{\n    int n, count = 0, i;\n\n    scanf(\"%d\", &amp;n);\n\n    int ar[n], ar2[601];\n    memset(ar2, 0, 600 * sizeof(int));\n\n    for (i = 0; i &lt; n; i++) {\n        scanf(\"%d \", &amp;ar[i]);\n        if (ar2[ar[i]] == 0)\n            ar2[ar[i]] = 1;\n    }\n\n    for (i = 1; i &lt; 601; i++) {\n        if (ar2[i] != 0)\n            count++;\n    }\n\n    printf(\"%d\",count);\n    return 0;\n}\n</code></pre>\n\n<p>for the first test case (4 1 3 3 2) , it outputs the right answer 3 in ideone.com 's gcc 6.3, but outputs 4 in gcc 5.1 which is used at codeforces.</p>\n\n<p>Why does this happen, and how can I prevent this ?\n(I think it's because of memset, but I'm not sure.)</p>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1521659282, "post_id": 49414659, "comment_id": 85831042, "body": "The first section works in my test. The only problem was a lack of a newline whitespace before <code>printf(&quot;%s\\n&quot;,deck[0]); &#47;&#47;this does nothing (even if I change index)</code>"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1521659483, "post_id": 49414659, "comment_id": 85831152, "body": "In the second section you comment <code>but deck is now empty</code>. How do you know that, since section 2 has no output?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1521659720, "post_id": 49414659, "comment_id": 85831289, "body": "Typo in <code>for (int j = 0; j &lt; 3; i++)</code> ==&gt; <code>for (int j = 0; j &lt; 3; j++)</code>."}, {"owner": {"reputation": 4251, "user_id": 2171689, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37198fb9e562d45b14f52669c207e08d?s=128&d=identicon&r=PG&f=1", "display_name": "This isn&#39;t my real name", "link": "https://stackoverflow.com/users/2171689/this-isnt-my-real-name"}, "edited": false, "score": 0, "creation_date": 1521660808, "post_id": 49414659, "comment_id": 85831900, "body": "Add a tag to each <code>printf()</code> so you can see what they are: <code>printf(&quot;Card: %s\\n&quot;, deck[k-1]);</code>, for example, and <code>printf(&quot;TEST: %s\\n, deck[0]);</code>. Then add a similar printout in the section where you&#39;re defining all the pairs. Now that you&#39;ve corrected your <code>i</code> and <code>j</code> values, is it still not working?"}], "answers": [{"tags": [], "owner": {"reputation": 307, "user_id": 8716085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/105196db6d398c854e1f0300b3702a00?s=128&d=identicon&r=PG&f=1", "display_name": "whatthefish", "link": "https://stackoverflow.com/users/8716085/whatthefish"}, "is_accepted": false, "score": 1, "last_activity_date": 1521660068, "creation_date": 1521660068, "answer_id": 49414939, "question_id": 49414659, "link": "https://stackoverflow.com/questions/49414659/beginner-in-c-array-of-strings-lost-content-after-initialization-in-cyklus/49414939#49414939", "title": "Beginner in C - Array of strings lost content after initialization in cyklus", "body": "<p>What you need to do is replace <code>i++</code> with <code>j++</code> in the following statement</p>\n\n<pre><code>for (int j = 0; j &lt; 3; i++) \n</code></pre>\n\n<p>and also comment out the following line as it is printing <code>2c</code> again:</p>\n\n<pre><code>printf(\"%s\\n\",deck[0]);    //this does nothing (even if I change index)\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9530597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b7024d5bc322f69390f2d416daae997?s=128&d=identicon&r=PG&f=1", "display_name": "Mat\u011bj", "link": "https://stackoverflow.com/users/9530597/mat%c4%9bj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1521661322, "creation_date": 1521659020, "last_edit_date": 1521661322, "question_id": 49414659, "link": "https://stackoverflow.com/questions/49414659/beginner-in-c-array-of-strings-lost-content-after-initialization-in-cyklus", "title": "Beginner in C - Array of strings lost content after initialization in cyklus", "body": "<p>I am trying to make array of strings each representing one card of a poker deck from 2 strings (ranks, colors). If I try print card immidietly after assignment it's ok but if I try it after all assignments nothing happend. </p>\n\n<p>My \"code\":</p>\n\n<pre><code>int main(void)\n{\n    char rank[] = \"23456789TJQKA\";\n    char color[] = \"cdhs\";\n    char deck[52][3];\n    int k = 0;\n\n    for (int i = 0; i &lt; 13; i++) {\n        for(int j = 0; j &lt; 4; j++) {\n            deck[k][0] = rank[i];\n            deck[k][1] = color[j];\n            deck[k][2] = 0;\n            k++;\n            printf(\"%s\\n\",deck[k-1]);    // this print works\n        }\n    }\n\n    printf(\"%s\\n\",deck[0]);    //this does nothing (even if I change index)\n\n\n    //-------------------------- here I am trying make all possible pairs but deck is now empty :(\n\n    k = 0;\n    char allPairs[1327][5];\n    for (int i = 0; i &lt; 51; i++) {\n        for (int j = 0; j &lt; 52; j++) { //**edit** - thanks ;)\n            allPairs[k][0] = deck[i][0];\n            allPairs[k][1] = deck[i][1];\n            allPairs[k][2] = deck[j][0];\n            allPairs[k][3] = deck[j][1];\n            allPairs[k][4] = 0;\n            k++;\n        }\n    }\n}\n</code></pre>\n\n<p>All seems to work now thanks guys! </p>\n"}, {"tags": ["c", "c89"], "comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 3, "creation_date": 1521657712, "post_id": 49414243, "comment_id": 85830078, "body": "Ah, a three-star programmer!"}, {"owner": {"reputation": 595, "user_id": 2426364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eab086711e114f83a8f506ff75c1a995?s=128&d=identicon&r=PG", "display_name": "Benedetto Abbenanti", "link": "https://stackoverflow.com/users/2426364/benedetto-abbenanti"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1521657826, "post_id": 49414243, "comment_id": 85830147, "body": "Why? What&#39;s not good about this?"}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1521657918, "post_id": 49414243, "comment_id": 85830214, "body": "Using <code>***</code> is generally not considered the cleanest of designs, particularly coming from an absolute beginner."}, {"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 2, "creation_date": 1521657952, "post_id": 49414243, "comment_id": 85830239, "body": "Things can get a little less confusing if you create local variables (<code>char **local_a; int local_len;</code>) and use those throughout the function. Then, before the function exits, assign them: `*a = local_a; *len = local_len;"}, {"owner": {"reputation": 595, "user_id": 2426364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eab086711e114f83a8f506ff75c1a995?s=128&d=identicon&r=PG", "display_name": "Benedetto Abbenanti", "link": "https://stackoverflow.com/users/2426364/benedetto-abbenanti"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1521658269, "post_id": 49414243, "comment_id": 85830440, "body": "So, no one need a function like this? @EOF"}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1521658478, "post_id": 49414243, "comment_id": 85830579, "body": "In this case, you might have a good reason to use three levels of indirection, since you want a variably sized array of strings, but when dealing with multiple indirection you need to always consider the type of the objects you are dealing with."}, {"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 1, "creation_date": 1521658619, "post_id": 49414243, "comment_id": 85830664, "body": "One way to eliminate the <code>***</code> would be to have the function return an array: <code>char ** read(int *len) {...}</code>"}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1521661892, "post_id": 49414243, "comment_id": 85832456, "body": "Another way to avoid the<code>***</code> is to use (and return) a (pointer to) struct, containing both the pointer and the number of (used) elements. BTW:<code>read()</code> is a <i>terrible name</i> for a function, it could be confused with the <code>read</code> systemcall."}], "answers": [{"comments": [{"owner": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "edited": false, "score": 0, "creation_date": 1521658813, "post_id": 49414496, "comment_id": 85830791, "body": "You copy pasted bugs!"}, {"owner": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "reply_to_user": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "edited": false, "score": 0, "creation_date": 1521658889, "post_id": 49414496, "comment_id": 85830833, "body": "@freestyle what are you talking about?"}, {"owner": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "reply_to_user": {"reputation": 9095, "user_id": 8542346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11b206b49cec657d28a5876f8330780e?s=128&d=identicon&r=PG&f=1", "display_name": "H.S.", "link": "https://stackoverflow.com/users/8542346/h-s"}, "edited": false, "score": 0, "creation_date": 1521659047, "post_id": 49414496, "comment_id": 85830919, "body": "@H.S. That&#39;s not a bug, and I intentionally left it there for the OP to notice the difference between the two calls to malloc()."}, {"owner": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "reply_to_user": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "edited": false, "score": 0, "creation_date": 1521659099, "post_id": 49414496, "comment_id": 85830945, "body": "@freestyle I tested it 3 times. It&#39;s working fine on my system. If there is a problem in the code, tell me about it."}, {"owner": {"reputation": 9095, "user_id": 8542346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11b206b49cec657d28a5876f8330780e?s=128&d=identicon&r=PG&f=1", "display_name": "H.S.", "link": "https://stackoverflow.com/users/8542346/h-s"}, "edited": false, "score": 1, "creation_date": 1521659119, "post_id": 49414496, "comment_id": 85830956, "body": "@machine_1: I didn&#39;t point out it as a bug but just a suggestion."}, {"owner": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "edited": false, "score": 0, "creation_date": 1521659300, "post_id": 49414496, "comment_id": 85831051, "body": "For example, input string more then 100 characters."}, {"owner": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "reply_to_user": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "edited": false, "score": 1, "creation_date": 1521659454, "post_id": 49414496, "comment_id": 85831136, "body": "@freestyle Really? Are you serious? If the OP wants to protect against buffer overflow, that&#39;s his job. My answer addresses the problem in the question body."}, {"owner": {"reputation": 595, "user_id": 2426364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eab086711e114f83a8f506ff75c1a995?s=128&d=identicon&r=PG", "display_name": "Benedetto Abbenanti", "link": "https://stackoverflow.com/users/2426364/benedetto-abbenanti"}, "reply_to_user": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "edited": false, "score": 0, "creation_date": 1521659455, "post_id": 49414496, "comment_id": 85831138, "body": "@freestyle it works. Input string more than 100 chars is not concerned in this program."}, {"owner": {"reputation": 595, "user_id": 2426364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eab086711e114f83a8f506ff75c1a995?s=128&d=identicon&r=PG", "display_name": "Benedetto Abbenanti", "link": "https://stackoverflow.com/users/2426364/benedetto-abbenanti"}, "edited": false, "score": 0, "creation_date": 1521659476, "post_id": 49414496, "comment_id": 85831150, "body": "@machine_1 thanks on this tips about managing pointers. The cast is not necessary as suggested above."}], "tags": [], "owner": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "is_accepted": true, "score": 1, "last_activity_date": 1521658431, "creation_date": 1521658431, "answer_id": 49414496, "question_id": 49414243, "link": "https://stackoverflow.com/questions/49414243/c-read-and-allocate-an-arbitrary-array-of-strings/49414496#49414496", "title": "C - Read and allocate an arbitrary array of strings", "body": "<p>You need to look out for two things: operator precedence and indirection level. Do enclose your variables in parenthesis if you don't know which operator has higher precedence than the other:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint read(char ***a, int *len)\n{\n    scanf(\"%d\", len);\n\n    if (*len &lt;= 0) return 1;\n\n    *a = (char **)malloc(*len * sizeof(char *));\n    if (*a == NULL) return 1;\n\n    for (int i = 0; i&lt;*len; i++) {\n        (*a)[i] = (char *)malloc(101 * sizeof(char)); // note this line\n        scanf(\"%s\", (*a)[i]);\n    }\n    return 0;\n}\n\nint main()\n{\n    int len, i;\n    char **A;\n    // read an array of strings\n    if (read(&amp;A, &amp;len)) return 1;\n\n    // DO SOMETHING\n\n    for (i = 0; i&lt;len; i++)\n        printf(\"%s\\n\", A[i]);\n\n    //system(\"PAUSE\");\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 595, "user_id": 2426364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eab086711e114f83a8f506ff75c1a995?s=128&d=identicon&r=PG", "display_name": "Benedetto Abbenanti", "link": "https://stackoverflow.com/users/2426364/benedetto-abbenanti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "accepted_answer_id": 49414496, "answer_count": 1, "score": 0, "last_activity_date": 1521658556, "creation_date": 1521657562, "last_edit_date": 1521658556, "question_id": 49414243, "link": "https://stackoverflow.com/questions/49414243/c-read-and-allocate-an-arbitrary-array-of-strings", "title": "C - Read and allocate an arbitrary array of strings", "body": "<p>I'm getting mad at a really simple function to read an array of strings given in input.\nI also know how to read strings and put them into an array without writing a proper function (writing all thing in main() ).\nThis is the example I'm using.</p>\n\n<p>I think that the main obstacle is to use properly the 3-star pointer.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint read(char ***a, int *len){\n    scanf(\"%d\", len);\n\n    if(*len &lt;= 0) return 1;\n\n    *a = malloc(*len * sizeof(char *));\n    if(*a == NULL) return 1;\n\n    for(int i=0; i&lt;*len; i++){\n        a[i] = malloc(101 * sizeof(char));\n        scanf(\"%s\", *a[i]);\n    }\n    return 0;\n}\n\nint main(){\n    int len, i;\n    char **A;\n    // read an array of strings\n    if( read(&amp;A, &amp;len)) return 1;\n\n    // DO SOMETHING\n\n    for(i=0; i&lt;len; i++)\n        printf(\"%s\\n\", A[i]);\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "linux", "file", "raspbian"], "comments": [{"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 1, "creation_date": 1521658867, "post_id": 49414215, "comment_id": 85830820, "body": "What error / errno are you getting?"}, {"owner": {"reputation": 4353, "user_id": 7602, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/f9bf2c569b2bd023184b8ea9b6b1183c?s=128&d=identicon&r=PG", "display_name": "tomdemuyt", "link": "https://stackoverflow.com/users/7602/tomdemuyt"}, "reply_to_user": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1521665667, "post_id": 49414215, "comment_id": 85834429, "body": "The file or directory does not exist."}, {"owner": {"reputation": 4353, "user_id": 7602, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/f9bf2c569b2bd023184b8ea9b6b1183c?s=128&d=identicon&r=PG", "display_name": "tomdemuyt", "link": "https://stackoverflow.com/users/7602/tomdemuyt"}, "reply_to_user": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1592401185, "post_id": 49414215, "comment_id": 110412200, "body": "Of note to voters, my question was good enough to get the right (accepted!) answer."}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1592571415, "post_id": 49414215, "comment_id": 110480514, "body": "Without details, the phrase about <code>fstat</code> is very confusing: the first idea about opening the file - using <code>open</code> - would suffer from the same problems about <code>~</code> as the <code>stat</code> function. Please, either provide more details about <code>fstat</code> case (that is, usage of <code>my_fopen</code> for open the file) or remove this note completely. And it is better to add the error message into the <b>question post</b> itself. In current form, it is unclear from the question post (without comments!) that <code>stat</code> fails because it cannot find the file."}, {"owner": {"reputation": 4353, "user_id": 7602, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/f9bf2c569b2bd023184b8ea9b6b1183c?s=128&d=identicon&r=PG", "display_name": "tomdemuyt", "link": "https://stackoverflow.com/users/7602/tomdemuyt"}, "reply_to_user": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1592589827, "post_id": 49414215, "comment_id": 110490096, "body": "@Tsyvarev I think you missed my point entirely, for experienced folks like P.P. this question was good enough."}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1592592138, "post_id": 49414215, "comment_id": 110490957, "body": "@tomdemuyt: &quot;... for experienced folks like P.P. this question was good enough.&quot; - Yes, experienced folks simply <b>drops</b> your note about <code>fstat</code> when answers. And even after your comment about <code>my_fopen</code> the respond was &quot;But I don&#39;t know if that&#39;s what you are using.&quot;. In other words, it is clear which file contains the code you show us, but your modification &quot;When I replace the above code with code that opens the file&quot; is quite <b>vague</b>. Using the function <code>my_fopen</code> which is defined in the same file doesn&#39;t look like &quot;the <b>standard way</b> everyone should use in the context of Angband&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1521658777, "post_id": 49414330, "comment_id": 85830771, "body": "Is OP actually passing the unexpanded path to <code>stat</code>? OP mentioned getting the code to work by replacing the <code>stat</code> call with <code>open</code> (or possibly <code>fopen</code> plus <code>fileno</code>) and <code>fstat</code>, but those won&#39;t expand or understand the <code>~</code> (tilde) either!"}, {"owner": {"reputation": 4353, "user_id": 7602, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/f9bf2c569b2bd023184b8ea9b6b1183c?s=128&d=identicon&r=PG", "display_name": "tomdemuyt", "link": "https://stackoverflow.com/users/7602/tomdemuyt"}, "edited": false, "score": 0, "creation_date": 1521665638, "post_id": 49414330, "comment_id": 85834416, "body": "Angband uses a <code>my_fopen</code>, perhaps it expands the tilde."}, {"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "edited": false, "score": 0, "creation_date": 1521666223, "post_id": 49414330, "comment_id": 85834679, "body": "Googling Angband shows a &quot;my_fopen&quot; and it certainly does: <a href=\"http://angbandsource.wikia.com/wiki/Z-file.c\" rel=\"nofollow noreferrer\">angbandsource.wikia.com/wiki/Z-file.c</a> But I don&#39;t know if that&#39;s what you are using. Whatever &quot;open&quot; you&#39;re using, it must be expanding; otherwise, I&#39;d expect the failure for the same reason."}], "tags": [], "owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "is_accepted": true, "score": 1, "last_activity_date": 1521657914, "creation_date": 1521657914, "answer_id": 49414330, "question_id": 49414215, "link": "https://stackoverflow.com/questions/49414215/fstat-works-stat-does-not/49414330#49414330", "title": "fstat works, stat does not", "body": "<p>It's simple. <code>stat(2)</code> doesn't expand or understand <code>~</code> (tilde).</p>\n\n<p>You could <code>HOME</code> instead. For example, <code>getenv(\"HOME\")</code> and then prefix it with your filename before calling <code>stat(2)</code>.</p>\n"}], "owner": {"reputation": 4353, "user_id": 7602, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/f9bf2c569b2bd023184b8ea9b6b1183c?s=128&d=identicon&r=PG", "display_name": "tomdemuyt", "link": "https://stackoverflow.com/users/7602/tomdemuyt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 130, "favorite_count": 0, "accepted_answer_id": 49414330, "answer_count": 1, "score": 0, "last_activity_date": 1592589931, "creation_date": 1521657466, "last_edit_date": 1592589931, "question_id": 49414215, "link": "https://stackoverflow.com/questions/49414215/fstat-works-stat-does-not", "title": "fstat works, stat does not", "body": "<p>I am compiling an Angband variant on Raspbian, and the following fails:</p>\n\n<pre><code>struct stat txt_stat, raw_stat;\n\n/* Build the filename */\npath_build(buf, 1024, ANGBAND_DIR_EDIT, template_file);\n\n/* Access stats on text file */\nif (stat(buf, &amp;txt_stat))\n{\n  /* Error */\n  msg_format(\"Oh dear, something went wrong with stat()! %s\", strerror(errno));\n  msg_format(\"Could not retrieve stats on the text file at {%s}\", buf);\n  return (-1);\n}\n</code></pre>\n\n<p>What annoys me to no end is that the file is there at \n<code>~/git/hellband/lib/edit/r_info.txt</code></p>\n\n<p>When I replace the above code with code that opens the file (using the same buf) and then use <code>fstat()</code> on the file descriptor, it works!!</p>\n\n<p>I dont want to open a file (and remember to close that file), I just want to know/fix what is going on with <code>stat()</code>.</p>\n\n<p>PostScriptum 2020; it turned that when I used the Angband approach to opening files, it autoexpanded the ~ sign, which is why that worked, and fstat worked.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 796419, "user_id": 34397, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/7deca8ec973c3c0875e9a36e1e3e2c44?s=128&d=identicon&r=PG", "display_name": "SLaks", "link": "https://stackoverflow.com/users/34397/slaks"}, "edited": false, "score": 1, "creation_date": 1521657030, "post_id": 49414038, "comment_id": 85829726, "body": "Declaring a variable as the only statement in its scope makes no sense."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 3, "creation_date": 1521657218, "post_id": 49414038, "comment_id": 85829820, "body": "This is a great question. Made so because the answer is a bit intricate, and kinda neat."}, {"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 3, "creation_date": 1521657520, "post_id": 49414038, "comment_id": 85829978, "body": "Always use braces - stops you getting caught with your trousers down"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 1, "creation_date": 1521659659, "post_id": 49414038, "comment_id": 85831259, "body": "Interestingly, this is legal in C++ (because C++ syntactically treats a declaration as a kind of statement, unless it&#39;s at file scope)."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 796419, "user_id": 34397, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/7deca8ec973c3c0875e9a36e1e3e2c44?s=128&d=identicon&r=PG", "display_name": "SLaks", "link": "https://stackoverflow.com/users/34397/slaks"}, "edited": false, "score": 0, "creation_date": 1521676784, "post_id": 49414038, "comment_id": 85838547, "body": "@SLaks &quot;Declaring a variable as the only statement in its scope makes no sense.&quot; is true yet OP has nicely made a <i>minimal</i> <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> to exhibit the issue - a good thing."}], "answers": [{"comments": [{"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1521657429, "post_id": 49414117, "comment_id": 85829928, "body": "I think you can improve the answer even more if you point out where a declaration is specified as a grammatical element (solidifying it as different to a statement)."}, {"owner": {"reputation": 15050, "user_id": 8605791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ae3be140b26db13a86d624dba4ef1c8?s=128&d=identicon&r=PG&f=1", "display_name": "llllllllll", "link": "https://stackoverflow.com/users/8605791/llllllllll"}, "reply_to_user": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1521657618, "post_id": 49414117, "comment_id": 85830027, "body": "@StoryTeller I think the point is that a declaration is not either of labeled-statement, ..., jump-statement. I&#39;m not sure whether include the quotation of declaration itself will improve the answer..."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 1, "creation_date": 1521657719, "post_id": 49414117, "comment_id": 85830086, "body": "Because there is nothing in the answer currently that would hint at <code>compound-statement</code> or <code>expression-statement</code> not being expandable to a declaration. You aren&#39;t just writing an answer for language lawyers, novices will read it as well. The more people can understand it, the better."}, {"owner": {"reputation": 15050, "user_id": 8605791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ae3be140b26db13a86d624dba4ef1c8?s=128&d=identicon&r=PG&f=1", "display_name": "llllllllll", "link": "https://stackoverflow.com/users/8605791/llllllllll"}, "reply_to_user": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1521657830, "post_id": 49414117, "comment_id": 85830151, "body": "@StoryTeller OK, I added a link of declaration for interested reader to check."}], "tags": [], "owner": {"reputation": 15050, "user_id": 8605791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ae3be140b26db13a86d624dba4ef1c8?s=128&d=identicon&r=PG&f=1", "display_name": "llllllllll", "link": "https://stackoverflow.com/users/8605791/llllllllll"}, "is_accepted": true, "score": 8, "last_activity_date": 1521657797, "last_edit_date": 1521657797, "creation_date": 1521657153, "answer_id": 49414117, "question_id": 49414038, "link": "https://stackoverflow.com/questions/49414038/why-do-i-need-the-curly-braces-here/49414117#49414117", "title": "why do I need the curly braces here?", "body": "<p>This is because <code>if</code> must be followed by a statement:</p>\n\n<p><a href=\"https://busybox.net/~landley/c99-draft.html#6.8.4\" rel=\"noreferrer\">C99/6.8.4</a></p>\n\n<blockquote>\n  <p>if ( expression ) statement</p>\n</blockquote>\n\n<p>However, a <a href=\"https://busybox.net/~landley/c99-draft.html#6.7\" rel=\"noreferrer\">declaration</a> is <strong>not</strong> a statement:</p>\n\n<p><a href=\"https://busybox.net/~landley/c99-draft.html#statement\" rel=\"noreferrer\">C99/6.8</a></p>\n\n<blockquote>\n  <p>statement:</p>\n  \n  <p>labeled-statement</p>\n  \n  <p>compound-statement</p>\n  \n  <p>expression-statement</p>\n  \n  <p>selection-statement</p>\n  \n  <p>iteration-statement</p>\n  \n  <p>jump-statement</p>\n</blockquote>\n\n<p>When put inside a <code>{}</code>, it is a compound-statement, thus ok.</p>\n"}, {"comments": [{"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 1, "creation_date": 1521659567, "post_id": 49414178, "comment_id": 85831201, "body": "C doesn&#39;t have anything called a &quot;declaration statement&quot;. Declarations and statements are entirely disjoint. A compound statement consists of <code>{</code> followed by zero or more statements and/or declarations followed by <code>}</code>. (C90 requires all the declarations to precede all the declarations; C99 and C11 allow them to be mixed.) (C++ has different rules.) I suggest deleting the last word of your answer."}, {"owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "reply_to_user": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1521659888, "post_id": 49414178, "comment_id": 85831375, "body": "@KeithThompson; I agreed there is noting like &quot;declaration statement&quot; in C standard. My apologies that I just overlooked my answer before posting it. It wasn&#39;t intentional. Thanks for pointing it out."}], "tags": [], "owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "is_accepted": false, "score": 1, "last_activity_date": 1521659768, "last_edit_date": 1521659768, "creation_date": 1521657331, "answer_id": 49414178, "question_id": 49414038, "link": "https://stackoverflow.com/questions/49414038/why-do-i-need-the-curly-braces-here/49414178#49414178", "title": "why do I need the curly braces here?", "body": "<p>There is a difference between <em>declaration</em> and <em>statement</em>.   </p>\n\n<pre><code>int j = 11;   \n</code></pre>\n\n<p>is a declaration. <code>if</code> statement shall be followed by a statement. Putting <code>{}</code> after <code>if</code> statement results in a compound statement. A compound statement can have no other statement in it or can have a declaration.</p>\n"}, {"tags": [], "owner": {"reputation": 4625, "user_id": 1964969, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0879c1954a7ee8660f80eafdf9f66776?s=128&d=identicon&r=PG", "display_name": "Yury Schkatula", "link": "https://stackoverflow.com/users/1964969/yury-schkatula"}, "is_accepted": false, "score": 0, "last_activity_date": 1522752881, "creation_date": 1522752881, "answer_id": 49628301, "question_id": 49414038, "link": "https://stackoverflow.com/questions/49414038/why-do-i-need-the-curly-braces-here/49628301#49628301", "title": "why do I need the curly braces here?", "body": "<p>It seems you compile your ANSI C code with C89 standard. And, unlike his successor C99, it requires all variables to be declared at the beginning of the scope. So, having <code>int j = 11;</code> somewhere in-between other statements just contradicts that C89 rule. If you open a new scope just before that <code>int j = 11;</code>, it's back to OK.</p>\n\n<p>Actual reason of such C89 limitation should be an attempt to simplify memory management for stack-allocable variables. For instance, compare it with Pascal language that requires all variables to be declared in the special <code>var</code> section before the code (so, it's even more strict that C89).</p>\n"}], "owner": {"reputation": 972, "user_id": 9488865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d560f151faf6a0565f7cebd93958acf?s=128&d=identicon&r=PG&f=1", "display_name": "struggling_learner", "link": "https://stackoverflow.com/users/9488865/struggling-learner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 133, "favorite_count": 1, "accepted_answer_id": 49414117, "answer_count": 3, "score": 12, "last_activity_date": 1522752881, "creation_date": 1521656840, "last_edit_date": 1522751233, "question_id": 49414038, "link": "https://stackoverflow.com/questions/49414038/why-do-i-need-the-curly-braces-here", "title": "why do I need the curly braces here?", "body": "<p>Consider this simple program:</p>\n\n<p><code>fails.c</code>:</p>\n\n<pre><code>#include &lt;stdio.h&gt;                                            \n\nint main(){                                                   \n    int i = 10;                                                                                         \n    if (i == 10)                                          \n        int j = 11;                                                                                         \n    return 0;        \n}                                                             \n</code></pre>\n\n<p>That fails to compile (<code>gcc fails.c</code>), giving this error:</p>\n\n<pre><code>fails.c: In function \u2018main\u2019:\nfails.c:7:3: error: expected expression before \u2018int\u2019\n   int j = 11;\n   ^\n</code></pre>\n\n<p>But this one goes through just fine:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(){\n    int i = 10;\n    if (i == 10){\n        int j = 11;\n    }\n    return 0;\n}\n</code></pre>\n\n<p>I figured that the work around, is to put those <code>{}</code> in. But I wish to know why this is required. </p>\n\n<p>Why does it behave this way, when something like <code>printf</code> is acceptable?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(){\n    int i = 10;\n    if (i == 10)\n        printf(\"some text\\n\");\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "bit-manipulation", "bitwise-operators"], "comments": [{"owner": {"reputation": 145, "user_id": 8972359, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fe81755a07f76574d252cd0c2db4e6c?s=128&d=identicon&r=PG&f=1", "display_name": "R.Laney", "link": "https://stackoverflow.com/users/8972359/r-laney"}, "edited": false, "score": 0, "creation_date": 1521656672, "post_id": 49413864, "comment_id": 85829527, "body": "are you taking in to account of the &quot;sign&quot; of zero correctly? I suspect not. remember the number is in two&#39;s compliment. You likely need a line to check either if int x == 0 or if threex == 0. I&#39;ll leave it to you how to do that with ! ~ &amp; ^ | + &lt;&lt; &gt;&gt; and handle adjusting your return appropriately."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1521657063, "post_id": 49413864, "comment_id": 85829743, "body": "In addition to the error with the polarity of <code>overflow</code>, your approach is fundamentally broken. Consider a number like <code>1431655766</code>, which is positive and representable in 32-bit 2&#39;s complement. <code>3*1431655766 == 4294967298</code>, which is <i>not</i> representable in 32-bit 2&#39;s complement <b>and</b> does not have the MSB set."}, {"owner": {"reputation": 1, "user_id": 9530451, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e8aea603af94fd0b956f244af89cd57?s=128&d=identicon&r=PG&f=1", "display_name": "Henry", "link": "https://stackoverflow.com/users/9530451/henry"}, "edited": false, "score": 0, "creation_date": 1521657999, "post_id": 49413864, "comment_id": 85830277, "body": "I am not sure where I am going wrong with the &quot;sign&quot; of 0. Shouldn&#39;t it just have the MSB of 0? I realized there was an error with where I put the answer and threex which I fixed. But my approach was if the sign of the result differed from the original sign of x then there was an overflow. Am I missing another case?"}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1521659020, "post_id": 49413864, "comment_id": 85830899, "body": "@Henry First of, if you want anybody to see what you comment, include <code>@username</code> in your comment. Second, you are missing the case where there was overflow and the MSB of the overflowed result is the same as the MSB of the original value."}, {"owner": {"reputation": 1, "user_id": 9530451, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e8aea603af94fd0b956f244af89cd57?s=128&d=identicon&r=PG&f=1", "display_name": "Henry", "link": "https://stackoverflow.com/users/9530451/henry"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1521659992, "post_id": 49413864, "comment_id": 85831434, "body": "@EOF sorry this is my first time posting and I&#39;m not sure exactly how to check for that. So unless there is some way to check for that and I am just missing it, it would seem my approach is broken. Can you point me in the right direction?"}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1521660162, "post_id": 49413864, "comment_id": 85831536, "body": "@Henry Well, your approach is broken <i>for multipliers greater than two</i>. Since you have replaced <code>3*x</code> with<code>x+x+x</code>, and your approach would work for <code>2*x == x + x</code>, you might see how to do <code>3*x</code>. A warning though: signed overflow is <i>undefined behavior</i> in C. I recommend casting to <code>unsigned</code> first."}, {"owner": {"reputation": 1, "user_id": 9530451, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e8aea603af94fd0b956f244af89cd57?s=128&d=identicon&r=PG&f=1", "display_name": "Henry", "link": "https://stackoverflow.com/users/9530451/henry"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1521660670, "post_id": 49413864, "comment_id": 85831810, "body": "@EOF okay so if I do twox = x + x then check for overflow, then repeat for threex = twox + x and check for overflow again?"}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1521661071, "post_id": 49413864, "comment_id": 85832027, "body": "@Henry Yes, I believe that would correctly identify all possible overflows."}], "owner": {"reputation": 1, "user_id": 9530451, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e8aea603af94fd0b956f244af89cd57?s=128&d=identicon&r=PG&f=1", "display_name": "Henry", "link": "https://stackoverflow.com/users/9530451/henry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 914, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1521657668, "creation_date": 1521656279, "last_edit_date": 1521657668, "question_id": 49413864, "link": "https://stackoverflow.com/questions/49413864/using-bitwise-operators-multiply-an-integer-by-3-but-return-max-if-overflow", "title": "Using bitwise operators multiply an integer by 3, but return max if overflow", "body": "<p>This is for a homework problem I am currently stuck on. I have to multiply an integer by 3, if there if overflow return the maximum (0x7FFFFFFF) and underflow return the minimum (0x80000000). I am using 32bit numbers and am restricted to only using the operators: ! ~ &amp; ^ | + &lt;&lt; >></p>\n\n<p>I feel as though I have solved it, but when I run the professors tests the case x = 0x7FFFFFFF incorrectly returns 0x7FFFFFFd. There could be other tests failing, but that is the first one that fails and it doesn't run the other tests.</p>\n\n<p>This is my code so far:</p>\n\n<pre><code>int satMul3(int x) {\n    int threex = x + x + x; //Definition of multiplication 3x = x+x+x\n    int signx = x &gt;&gt; 31; //Makes bit all same number as MSB (1s = neg 0s = pos)\n    int sign3 = threex &gt;&gt; 31; //Same as signx but for the result of x*3\n    int overflow = signx ^ sign3; //Checks if signs are same. 0s if same sign\n    int tmin = 0x80000000;\n    int tmax = 0x7FFFFFFF;\n    int answer = (sign3 &amp; tmin) | (~sign3 &amp; tmax);\n    //Gets answer for overflow, if sign3 is negative returns Tmin else tmax\n\n    return (overflow &amp; answer) | (~overflow &amp; threex); //If overflow is 1,\n    //signs are the same so return x*3, if overflow is 0, then signs are\n    //different so return the saturated answer\n}\n</code></pre>\n\n<p>Hopefully it is just a simple error, but if not any advice would be greatly appreciated.</p>\n"}, {"tags": ["c", "list", "sorting", "pointers"], "comments": [{"owner": {"reputation": 261, "user_id": 3735221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f3a6e4503729f80f0760e4f22e2caad5?s=128&d=identicon&r=PG&f=1", "display_name": "Arthur Dent", "link": "https://stackoverflow.com/users/3735221/arthur-dent"}, "edited": false, "score": 0, "creation_date": 1521656316, "post_id": 49413632, "comment_id": 85829327, "body": "Do you have a definition for <code>ElType</code>?"}, {"owner": {"reputation": 153, "user_id": 8736816, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/raZLf.jpg?s=128&g=1", "display_name": "Igor", "link": "https://stackoverflow.com/users/8736816/igor"}, "reply_to_user": {"reputation": 261, "user_id": 3735221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f3a6e4503729f80f0760e4f22e2caad5?s=128&d=identicon&r=PG&f=1", "display_name": "Arthur Dent", "link": "https://stackoverflow.com/users/3735221/arthur-dent"}, "edited": false, "score": 0, "creation_date": 1521656401, "post_id": 49413632, "comment_id": 85829372, "body": "Forgot to write it - ElType is just an int"}, {"owner": {"reputation": 261, "user_id": 3735221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f3a6e4503729f80f0760e4f22e2caad5?s=128&d=identicon&r=PG&f=1", "display_name": "Arthur Dent", "link": "https://stackoverflow.com/users/3735221/arthur-dent"}, "edited": false, "score": 0, "creation_date": 1521656526, "post_id": 49413632, "comment_id": 85829460, "body": "What is <code>PushFront</code>?"}, {"owner": {"reputation": 153, "user_id": 8736816, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/raZLf.jpg?s=128&g=1", "display_name": "Igor", "link": "https://stackoverflow.com/users/8736816/igor"}, "reply_to_user": {"reputation": 261, "user_id": 3735221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f3a6e4503729f80f0760e4f22e2caad5?s=128&d=identicon&r=PG&f=1", "display_name": "Arthur Dent", "link": "https://stackoverflow.com/users/3735221/arthur-dent"}, "edited": false, "score": 0, "creation_date": 1521656816, "post_id": 49413632, "comment_id": 85829608, "body": "ListEl* PushFront(ListEl* head, ElType k) { ListEl* w = (ListEl*) malloc(sizeof(ListEl)); w-&gt;key = k; w-&gt;next = head; return w; // the new head }"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1521666500, "post_id": 49413632, "comment_id": 85834827, "body": "Why <code>PushFrontsort</code>? Aren&#39;t you wanting an <code>insert_sorted</code>? It&#39;s a bit bit unclear from the name what your want your function to do (your explanation is clear). Correct descriptive names really help readability."}], "answers": [{"tags": [], "owner": {"reputation": 261, "user_id": 3735221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f3a6e4503729f80f0760e4f22e2caad5?s=128&d=identicon&r=PG&f=1", "display_name": "Arthur Dent", "link": "https://stackoverflow.com/users/3735221/arthur-dent"}, "is_accepted": true, "score": 1, "last_activity_date": 1521663934, "last_edit_date": 1521663934, "creation_date": 1521662093, "answer_id": 49415441, "question_id": 49413632, "link": "https://stackoverflow.com/questions/49413632/adding-element-to-a-sorted-list/49415441#49415441", "title": "Adding element to a sorted list", "body": "<p>The error only occurs when your second call for <code>ListEl</code> has a value for <code>key</code> larger than your first call. That's why the code was failing ~%50 of the time, because it all depends on which numbers were randomly called. As for \"sometimes doesn't add 20 numbers and stop at 19\", I'm not sure why this was happening, as I cannot reproduce this.</p>\n\n<p>To fix your problem, from <a href=\"https://stackoverflow.com/questions/45133039/initialize-recursive-struct-type-in-c-properly\">this</a> answer, \"If you need a pointer of a typedeffed type, declare an instance of one, but keep your typedefs to types so an not to mask levels of indirection.\"</p>\n\n<p>So if you change your code to:</p>\n\n<pre><code>int i;\nsrand(time(NULL));\nListEl a = {0, NULL};\nListEl* head = &amp;a; \nhead = PushFront(head, rand()%100);\nfor (i = 0; i &lt; 20; i++)\n    head = PushFrontsort(head, rand()%100);\n</code></pre>\n\n<p>you should no longer have any issue. Also, it would probably be good form to change your typedef to:</p>\n\n<pre><code>typedef struct _ListEl {\n    int key;\n    struct _ListEl *next;\n} ListEl;\n</code></pre>\n\n<p>So as to differentiate between the struct type and instance of struct type. To be honest, I'm not exactly sure why this needs to be done, so if someone more knowledgeable can edit/chime in, feel free.</p>\n"}], "owner": {"reputation": 153, "user_id": 8736816, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/raZLf.jpg?s=128&g=1", "display_name": "Igor", "link": "https://stackoverflow.com/users/8736816/igor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 49415441, "answer_count": 1, "score": 1, "last_activity_date": 1521663934, "creation_date": 1521655409, "question_id": 49413632, "link": "https://stackoverflow.com/questions/49413632/adding-element-to-a-sorted-list", "title": "Adding element to a sorted list", "body": "<p>i've got a problem with list, more specific - adding new element to it.\nThis function is to add new element to a sorted list in proper place</p>\n\n<pre><code>ListEl* PushFrontsort(ListEl* head, ElType k)\n{\n    ListEl* x = (ListEl*) malloc(sizeof(ListEl));\n    x-&gt;key = k;\n    x-&gt;next = NULL;\n    ListEl* y=head;\n    ListEl* w=head;\n    ListEl* new1 = (ListEl*) malloc(sizeof(ListEl));\n    new1=head;\n    w=w-&gt;next;\n    if(head-&gt;key &gt;= x-&gt;key)\n    {\n        x-&gt;next=head;\n        new1=x;\n    }\n    else\n    {\n        while(w-&gt;key &lt; x-&gt;key &amp;&amp;w-&gt;next)\n        {\n            y=w;\n            w=w-&gt;next;\n        }\n        y-&gt;next=x;\n        x-&gt;next=w;\n    }\n    return new1;\n}\n</code></pre>\n\n<p>Type of the element is as following:</p>\n\n<pre><code>typedef struct ListEl {\n    ElType key;\n    struct ListEl *next;\n} ListEl;\n</code></pre>\n\n<p>When I try to add new, random element using following instructions:</p>\n\n<pre><code>    int i;\n    srand(time(NULL));\n    ListEl* head = NULL;\n    head = PushFront(head, rand()%100);\n    for (i = 0; i &lt; 20; i++)\n        head = PushFrontsort(head, rand()%100);\n</code></pre>\n\n<p>not only sometimes doesn't it add 20 number and stops at 19, but very often program crashes.\nThe whole problem is that I don't know what may cause this randomness of proper executing. \nIf you can give me any advice to improve it, I'd be very grateful.\nAny help will be appreciated</p>\n"}, {"tags": ["c", "linux", "multithreading", "operating-system"], "comments": [{"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1521651416, "post_id": 49412304, "comment_id": 85826381, "body": "why are you overriding the thread ids with <code>1</code>: <code>tid[l] = 1;</code> ???"}, {"owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "edited": false, "score": 0, "creation_date": 1521654403, "post_id": 49412304, "comment_id": 85828235, "body": "This is not an <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>..."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1521658844, "post_id": 49412304, "comment_id": 85830810, "body": "you&#39;re also reading <code>test_val</code> outside critical section. and when <code>isprime</code> is set to false, you should break the loop."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1521664508, "post_id": 49412304, "comment_id": 85833851, "body": "also you should print something when the number is not prime. That&#39;s help debugging..."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9500727, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8c79d3f847e74c657b16f1fd1ab570a?s=128&d=identicon&r=PG&f=1", "display_name": "Parrot", "link": "https://stackoverflow.com/users/9500727/parrot"}, "edited": false, "score": 0, "creation_date": 1521652322, "post_id": 49412381, "comment_id": 85826961, "body": "Thank you that got rid of my error! But now my code doesn&#39;t print anything. Could this be because of the virtual machine I am running this on? Or is it something else in the code?"}], "tags": [], "owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "is_accepted": false, "score": 0, "last_activity_date": 1521651514, "creation_date": 1521651514, "answer_id": 49412381, "question_id": 49412304, "link": "https://stackoverflow.com/questions/49412304/multithreading-simple-program-segment-fault-core-dumped/49412381#49412381", "title": "Multithreading: simple program Segment fault (core dumped)", "body": "<p>Here:</p>\n\n<pre><code>for(int l = 0; ti &lt; MAX_THREADS; ti++){\n    if(tid[l] == 0){\n        pthread_create(&amp;tid[l], NULL, testprime, NULL);\n        tid[l] = 1;\n    }   \n}\n</code></pre>\n\n<p>First argument of <code>pthread_create</code> is an output thread handle. On the next line, you're setting this value to <code>1</code> (probably to mark it as used).</p>\n\n<p>When performing <code>pthread_join</code> on those invalid handles, you invoke <em>undefined behaviour</em>.</p>\n\n<p>Remove this assignment, thread handles aren't 0, so your code will work anyway.</p>\n"}, {"tags": [], "owner": {"reputation": 5000, "user_id": 8405835, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sN3eq.png?s=128&g=1", "display_name": "Abhijit Pritam Dutta", "link": "https://stackoverflow.com/users/8405835/abhijit-pritam-dutta"}, "is_accepted": false, "score": 0, "last_activity_date": 1521652127, "creation_date": 1521652127, "answer_id": 49412580, "question_id": 49412304, "link": "https://stackoverflow.com/questions/49412304/multithreading-simple-program-segment-fault-core-dumped/49412580#49412580", "title": "Multithreading: simple program Segment fault (core dumped)", "body": "<p>You just need to correct your for loop here. You don't need to assign a value in the array. When you call <code>pthread_create</code> it will store the thread id in every location of your thread array.</p>\n\n<pre><code>for(int ti = 0; ti &lt; MAX_THREADS; ti++){\n        if(tid[ti] == 0){\n            pthread_create(&amp;tid[ti], NULL, testprime, NULL);\n            //tid[l] = 1;\n        }  \n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9500727, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8c79d3f847e74c657b16f1fd1ab570a?s=128&d=identicon&r=PG&f=1", "display_name": "Parrot", "link": "https://stackoverflow.com/users/9500727/parrot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 85, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1521673548, "creation_date": 1521651299, "last_edit_date": 1521673548, "question_id": 49412304, "link": "https://stackoverflow.com/questions/49412304/multithreading-simple-program-segment-fault-core-dumped", "title": "Multithreading: simple program Segment fault (core dumped)", "body": "<p>I am trying to create a program which calculates prime numbers from 1 to 1000. I believe the code is having trouble either creating or joining the pthreads. I keep getting a core dump error. My main concern is in the second for loop where I am joining the pthreads. Is this the correct way to check if a thread has ended?</p>\n\n<p>I am using gcc --std=c99 -Wall -Werror -pthread primes.c -o primes in the terminal.</p>\n\n<pre><code>    while (test_val &lt;= FINAL){\n        //loop to check if thread is finished\n        for(int i = 0; i &lt; THREADS; i++){\n            if(tid[i] == 0){\n                pthread_create(&amp;tid[i], NULL, testprime, NULL);\n\n            }   \n        }\n        //wait for thread to end\n        for(int i = 0; i &lt; THREADS; i++){\n            pthread_join(tid[i], NULL);\n</code></pre>\n\n<p>This is the error:\nSegmentation fault (core dumped)</p>\n"}, {"tags": ["c", "linux", "pthreads", "codeblocks"], "comments": [{"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 2, "creation_date": 1521651091, "post_id": 49411744, "comment_id": 85826152, "body": "<code>when I compile it on the Linux kernel</code> - You compile this program for Linux, not for Linux <b>kernel</b>, which has different API. Also, opposition of &quot;CodeBlocks&quot; and &quot;Linux&quot; is wrong: The first is a <b>build system</b>, but the second is <b>Operating System</b>."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 3, "creation_date": 1521651235, "post_id": 49411744, "comment_id": 85826244, "body": "You do not appear to actually <i>use</i> multithreading; you just create a single thread that runs the entire computation and immediately wait for it.  That means you perfectly well could call <code>occurrence</code> directly.  If you make that change, does that make the problem go away?  The other thing I would like you to try is eliminating all of the global variables."}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1521656007, "post_id": 49411744, "comment_id": 85829143, "body": "I haven&#39;t verified but I suspect <code>for(i=1;i&lt;=strlen(string1);i++)</code> may be the source of some problems. Memory offsets in <code>c</code> start at 0. That&#39;s true for pointers and arrays. Since you&#39;re starting at 1 instead of 0 there could be some off-by-1 errors somewhere."}], "answers": [{"tags": [], "owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "is_accepted": true, "score": 1, "last_activity_date": 1521651662, "creation_date": 1521651662, "answer_id": 49412436, "question_id": 49411744, "link": "https://stackoverflow.com/questions/49411744/pthread-program-printing-different-values-on-codeblocks-and-linux-kernel/49412436#49412436", "title": "Pthread program printing different values on Codeblocks and Linux Kernel", "body": "<p>There are several issues here. </p>\n\n<p>First the signature for <code>occurrence</code> is wrong; the thread function should take a <code>void*</code> as argument and return a <code>void*</code> as required by the <a href=\"http://man7.org/linux/man-pages/man3/pthread_create.3.html\" rel=\"nofollow noreferrer\">pthread_create</a> API. So it should be:</p>\n\n<pre><code>void *occurrence(void*);\n</code></pre>\n\n<p>and </p>\n\n<pre><code>void *occurrence(void arg*) {\n    ...\n    return NULL;\n}\n</code></pre>\n\n<p>There are several other questionable things in your code.</p>\n\n<ul>\n<li><p>You are passing the global variable <code>fp</code> to <code>readf()</code> function. Why do you need to pass a global variable?</p></li>\n<li><p>You are reading only the first two lines. What if the file contains many more lines?</p></li>\n<li><p>Why do you have <code>s1</code> and <code>s2</code> as global? You could easily rewrite it to pass from <code>readf</code> back to <code>occurrence</code>. Or <code>occurrence</code> could pass varibles that <code>readf</code> writes into.</p></li>\n<li><p>You don't close the file with <code>fclose</code>.</p></li>\n<li><p>You create just one thread to do the work and the main thread just waits for it. So there's no real need for threads here. You might as well let the main thread do the work and not bother with threads.</p></li>\n<li><p>Why do you subtract here?: <code>n2=strlen(s2)-1; /*length of s2*/</code>.\nWhat if the length of <code>s1</code> and <code>s2</code> are the same? Is <code>\"abc\"</code> not a substring of <code>\"abc\"</code>?</p></li>\n</ul>\n\n<p>Your actual of problem of getting incorrect substring count is probably because <a href=\"http://man7.org/linux/man-pages/man3/fgets.3p.html\" rel=\"nofollow noreferrer\"><code>fgets()</code></a> reads in the newline character and thus the substring match fails.</p>\n\n<p>To remove newlines, you can do in your <code>readf</code> function after reading <code>s1</code> and <code>s2</code>:</p>\n\n<pre><code>char *p = strchr(s1, '\\n');\nif (p) *p = 0;\np = strchr(s2, '\\n');\nif (p) *p = 0;\n</code></pre>\n\n<p>This should fix the immediate problem. But there's a lot you could improve.</p>\n"}], "owner": {"reputation": 33, "user_id": 8560766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b300cb928c8937209d629de93d8719bd?s=128&d=identicon&r=PG&f=1", "display_name": "brian nyaberi", "link": "https://stackoverflow.com/users/8560766/brian-nyaberi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "closed_date": 1521657307, "accepted_answer_id": 49412436, "answer_count": 1, "score": 0, "last_activity_date": 1521661414, "creation_date": 1521649702, "last_edit_date": 1521661414, "question_id": 49411744, "link": "https://stackoverflow.com/questions/49411744/pthread-program-printing-different-values-on-codeblocks-and-linux-kernel", "closed_reason": "Not suitable for this site", "title": "Pthread program printing different values on Codeblocks and Linux Kernel", "body": "<p>I'm working on the following pthread program that finds the number of substrings in string2 that are in string1:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;pthread.h&gt;\n#define NUM_THREADS 4\n#define MAX 1024\n\nint n1,n2,i;\nchar *s1,*s2;\nFILE *fp;\n\nchar *substring(char *string, int position, int length);\nvoid *occurrence();\n\n\nint readf(FILE *fp)\n{\n    if((fp=fopen(\"strings.txt\", \"r\"))==NULL){\n        printf(\"ERROR: can't open strings.txt!\\n\");\n        return 0;\n    }\n    s1=(char *)malloc(sizeof(char)*MAX);\n    if(s1==NULL){\n        printf(\"ERROR: Out of memory!\\n\");\n        return -1;\n    }\n    s2=(char *)malloc(sizeof(char)*MAX);\n    if(s1==NULL){\n        printf(\"ERROR: Out of memory\\n\");\n        return -1;\n    }\n    /*read s1 s2 from the file*/\n    s1=fgets(s1, MAX, fp);\n    s2=fgets(s2, MAX, fp);\n    n1=strlen(s1);  /*length of s1*/\n    n2=strlen(s2)-1; /*length of s2*/\n    if(s1==NULL || s2==NULL || n1&lt;n2)  /*when error exit*/\n        return -1;\n    return 0;\n}\n\nint main(void)\n{\n    pthread_t tid;\n    pthread_create(&amp;tid, NULL, occurrence, NULL);\n    pthread_join(tid, NULL);\n    exit(0);\n}\n\nchar *substring(char *string, int position, int length)\n{\n    char *pointer;\n    int c;\n\n    pointer = malloc(length+1);\n\n    if (pointer == NULL)\n    {\n        printf(\"Unable to allocate memory.\\n\");\n        exit(1);\n    }\n\n    for (c = 0 ; c &lt; length ; c++)\n    {\n        *(pointer+c) = *(string+position-1);\n        string++;\n    }\n\n    *(pointer+c) = '\\0';\n\n    return pointer;\n}\n\nvoid* occurrence()\n{\n    char *string1;\n    char *string2;\n    char *new_str;\n    int counter=0;\n    readf(fp);\n\n    string1 = s1;\n    string2 = s2;\n    new_str = malloc(200);\n    for(i=1;i&lt;=strlen(string1);i++)\n    {\n        new_str = substring(string1,i,strlen(string2));\n        if(strcmp(new_str, string2)==0)\n        {\n            counter++;\n        }\n    }\n    printf(\"The number of substrings is: %d \\n\",counter);\n    return 0;\n}\n</code></pre>\n\n<p>When i compile it on codeblocks, it prints the correct number of substrings. However, when I compile it on the Linux kernel, it always prints 1 as the number of substrings, even though there's more than one. For example, a <code>strings.txt</code> file that has <strong>abdeabjhab</strong> in the first line and <strong>ab</strong> in the 2nd line should print 3, since there's 3 instances of <em>ab</em> in the first line. My Linux kernel prints 1. <strong>Is there a specific way I'm supposed to compile it for it to print the right value?</strong> I'm current using <code>gcc -pthread substring.c -o substrings</code> to compile and <code>./substrings</code> to execute it.</p>\n"}, {"tags": ["c", "graph", "tarjans-algorithm"], "comments": [{"owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "edited": false, "score": 0, "creation_date": 1521655531, "post_id": 49411719, "comment_id": 85828883, "body": "Might want to pick a language. C and C++ are distinct, e.g. Boost::graph is pointless for C."}, {"owner": {"reputation": 13, "user_id": 5476920, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fmEQP.jpg?s=128&g=1", "display_name": "Miki Bakaiki", "link": "https://stackoverflow.com/users/5476920/miki-bakaiki"}, "reply_to_user": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "edited": false, "score": 0, "creation_date": 1521657421, "post_id": 49411719, "comment_id": 85829923, "body": "Thanks! yes, they are, but im using a mix of them, just for convinience. But i&#39;ll change it to C :)"}], "owner": {"reputation": 13, "user_id": 5476920, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fmEQP.jpg?s=128&g=1", "display_name": "Miki Bakaiki", "link": "https://stackoverflow.com/users/5476920/miki-bakaiki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 140, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1521657428, "creation_date": 1521649613, "last_edit_date": 1521657428, "question_id": 49411719, "link": "https://stackoverflow.com/questions/49411719/print-edges-that-connect-a-scc-to-another-scc", "title": "Print edges that connect a SCC to another SCC", "body": "<p>I am currently doing a project where i need to find how many <em>strongly connected components</em> (SCC) exist on a graph and, after that, i need to check if there are <em>any edges going from any SCC to another SCC</em>. </p>\n\n<p>I'm using Tarjan's algorithm and i can already get all the SCC from a given graph, but i can't compute the next part.</p>\n\n<p>I had two ideas:</p>\n\n<ol>\n<li>Delete all edges inside every SCC. The only ones left would be the possible candidates.</li>\n<li>Somehow turn every SCC to a \"vertex\", or a super vertex, and then check if there are any outgoing connections to any other super vertex.</li>\n</ol>\n\n<p>The only constraints i have are:</p>\n\n<ul>\n<li><p>If there is more than one connection to the same SCC, i only need to display it once;</p></li>\n<li><p>When i display the connection, i need to display always the smallest vertex id belonging to the SCC, whether it's the outgoing SCC or incoming SCC.</p></li>\n</ul>\n\n<p>A little example:</p>\n\n<p><strong>Input as <em>edge from x to y</em></strong></p>\n\n<p>1 2; 2 3; 3 1; 2 4; 4 5; 5 4;</p>\n\n<p>Here's an <a href=\"http://storage2.static.itmages.com/i/18/0321/h_1521649489_8942456_e8bcd10dba.png\" rel=\"nofollow noreferrer\">image of the above graph</a>, where 1 = A, 2 = B and so forth...</p>\n\n<p>My question is: How can i compute this? Every option i seem to come up with, seems like it will be too time and resources consuming.</p>\n\n<p>Appreciate all the help :)</p>\n"}, {"tags": ["c", "arrays", "pointers"], "comments": [{"owner": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "edited": false, "score": 2, "creation_date": 1521648888, "post_id": 49411287, "comment_id": 85824525, "body": "Your question is unclear. I don&#39;t feel I understand it."}, {"owner": {"reputation": 2311, "user_id": 6032010, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-cCbzrdp-8HI/AAAAAAAAAAI/AAAAAAAAAAA/g1GQeurueXA/photo.jpg?sz=128", "display_name": "SHG", "link": "https://stackoverflow.com/users/6032010/shg"}, "edited": false, "score": 0, "creation_date": 1521648895, "post_id": 49411287, "comment_id": 85824534, "body": "What do you mean by saying <i>array name cannot be used as a variable</i>? <code>ptr</code> is a variable and it&#39;s also an array&#39;s name"}, {"owner": {"reputation": 57, "user_id": 9436858, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/04842621c06bf13ecf1889ae6e57bfb2?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas", "link": "https://stackoverflow.com/users/9436858/thomas"}, "edited": false, "score": 0, "creation_date": 1521649140, "post_id": 49411287, "comment_id": 85824726, "body": "I mean if <code>int *pa, a[5];</code> you cannot use expressions like <code>a=pa;</code> or <code>a++;</code>"}, {"owner": {"reputation": 57, "user_id": 9436858, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/04842621c06bf13ecf1889ae6e57bfb2?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas", "link": "https://stackoverflow.com/users/9436858/thomas"}, "edited": false, "score": 0, "creation_date": 1521649245, "post_id": 49411287, "comment_id": 85824788, "body": "See Ritchie&#39;s book &#39;C programming language&#39; Page 99"}, {"owner": {"reputation": 5295, "user_id": 717523, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b436aae08258d0a6b3f515eb03d5f15?s=128&d=identicon&r=PG", "display_name": "sg7", "link": "https://stackoverflow.com/users/717523/sg7"}, "edited": false, "score": 0, "creation_date": 1521649346, "post_id": 49411287, "comment_id": 85824854, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/11555997/c-c-int-vs-int-pointers-vs-array-notation-what-is-the-difference\">C/C++ int&#91;&#93; vs int* (pointers vs. array notation). What is the difference?</a>"}, {"owner": {"reputation": 33597, "user_id": 2445184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/0b51ece74c2314ba345a862c4b00d804?s=128&d=identicon&r=PG", "display_name": "cmaster - reinstate monica", "link": "https://stackoverflow.com/users/2445184/cmaster-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1521649652, "post_id": 49411287, "comment_id": 85825099, "body": "It&#39;s pretty much the same reason why <code>pa = ...</code> is allowed while <code>a = </code> is not allowed: An array is never an assignable entity, but a pointer is."}, {"owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "edited": false, "score": 0, "creation_date": 1521649959, "post_id": 49411287, "comment_id": 85825366, "body": "Did you try to compile this code?  If so, did the compiler complain about it?  If so, what was the error message?"}, {"owner": {"reputation": 57, "user_id": 9436858, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/04842621c06bf13ecf1889ae6e57bfb2?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas", "link": "https://stackoverflow.com/users/9436858/thomas"}, "reply_to_user": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "edited": false, "score": 0, "creation_date": 1521651075, "post_id": 49411287, "comment_id": 85826142, "body": "@John Bode I&#39;m trying to understand the mechanism. It&#39;s easy to compile successfully because this example is from a textbook..."}, {"owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "edited": false, "score": 0, "creation_date": 1521655285, "post_id": 49411287, "comment_id": 85828754, "body": "@Thomas - that&#39;s the point, <code>*ptr++</code> is a <i>constraint violation</i> (<code>ptr</code> is not a modifiable lvalue, and thus may not be the operand of the the <code>++</code> operator), and the compiler must <i>at least</i> issue a diagnostic for it (on the order of &quot;invalid lvalue in increment&quot;).  Even <i>good</i> textbooks contain errors in code samples."}], "answers": [{"tags": [], "owner": {"reputation": 44, "user_id": 9161695, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a34310ff11f1b0221843dbb5deb00fa?s=128&d=identicon&r=PG&f=1", "display_name": "Vilyanare", "link": "https://stackoverflow.com/users/9161695/vilyanare"}, "is_accepted": false, "score": 0, "last_activity_date": 1521649216, "creation_date": 1521649216, "answer_id": 49411578, "question_id": 49411287, "link": "https://stackoverflow.com/questions/49411287/confusing-on-pointer-array/49411578#49411578", "title": "Confusing on pointer array", "body": "<p>I believe this link should help you.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/11555997/c-c-int-vs-int-pointers-vs-array-notation-what-is-the-difference\">C/C++ int[] vs int* (pointers vs. array notation). What is the difference?</a></p>\n\n<p>The array notation has a bounds limit while the pointer notation does not.</p>\n\n<p>If you wanted to access the next in the array with array notation it would look something like a[n++] n being whatever the current index of the array you are at.  Where as assigning ptr to a sets ptr to the first index of the array and you can increment a pointer.</p>\n"}, {"comments": [{"owner": {"reputation": 57, "user_id": 9436858, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/04842621c06bf13ecf1889ae6e57bfb2?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas", "link": "https://stackoverflow.com/users/9436858/thomas"}, "edited": false, "score": 0, "creation_date": 1521649884, "post_id": 49411590, "comment_id": 85825308, "body": "Thank you for your reply. My understanding is <code>ptr</code> is a pointer-to-pointer which points to the address of <code>ptr[0]</code>, so <code>*ptr == ptr[0]</code>, <code>*ptr+1 == ptr[1]</code> etc. So if we want to get the string, it seems that we need to dereference again?"}, {"owner": {"reputation": 20994, "user_id": 2170192, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/JsKlq.png?s=128&g=1", "display_name": "Alex Shesterov", "link": "https://stackoverflow.com/users/2170192/alex-shesterov"}, "reply_to_user": {"reputation": 57, "user_id": 9436858, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/04842621c06bf13ecf1889ae6e57bfb2?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas", "link": "https://stackoverflow.com/users/9436858/thomas"}, "edited": false, "score": 0, "creation_date": 1521650475, "post_id": 49411590, "comment_id": 85825724, "body": "You are right about <code>*ptr == ptr[0]</code> and <code>*(ptr+1) == ptr[1]</code> (note the grouping). But in C, a &quot;string&quot; is <i>a null-terminated &quot;array&quot; of characters</i>. So if you dereference a string, you&#39;ll actually get the first character.  Having <code>char** ptr</code> - this could be an array of strings; then <code>*ptr</code> or <code>ptr[0]</code> is the first string, <code>*(ptr+1)</code> or <code>ptr[1]</code> is the second string, and so on; <code>**ptr</code> or <code>ptr[0][0]</code> is the first character of the first string, <code>*(*(ptr + 1) + 2)</code> or <code>ptr[1][2]</code> is the third character of the second string, etc."}], "tags": [], "owner": {"reputation": 20994, "user_id": 2170192, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/JsKlq.png?s=128&g=1", "display_name": "Alex Shesterov", "link": "https://stackoverflow.com/users/2170192/alex-shesterov"}, "is_accepted": false, "score": 1, "last_activity_date": 1521650101, "last_edit_date": 1521650101, "creation_date": 1521649255, "answer_id": 49411590, "question_id": 49411287, "link": "https://stackoverflow.com/questions/49411287/confusing-on-pointer-array/49411590#49411590", "title": "Confusing on pointer array", "body": "<p>Postfix increment <code>++</code> has a higher precedence than dereference <code>*</code>. </p>\n\n<p>Thus, <code>*ptr++</code> is interpreted as <code>*(ptr++)</code>. And as you've correctly figured out, <code>ptr++</code> isn't allowed if <code>ptr</code> is an array (of anything, values or pointers).</p>\n\n<p>If <code>ptr</code> is a pointer, then <code>*ptr++</code> will indeed increment the pointer (so it will point to the next value <em>after</em> the operation), and this expression will return the <em>current</em> pointed-to value (before increment of the pointer). This expression is indeed sometimes used, e.g. for copying memory areas, e.g.: </p>\n\n<pre><code>while (...) {\n    *dest++ = *src++; // Copy the current element, then increment both pointers\n}\n</code></pre>\n\n<hr>\n\n<p><code>*ptr++</code> <em>doesn't necessarily give you a string</em> \u2014 it gives you a string if and only if <code>ptr</code> is pointing to a string. And in this case, it's not necessary to post-increment just to get the string \u2014 <code>*ptr</code> would be enough. <code>++</code> is done for another purpose. </p>\n\n<p>For example, it <code>ptr</code> is a pointer to an <em>\"array\" of strings</em> (i.e. a pointer to a pointer to a<code>char</code>, i.e. <code>char **ptr</code>), then you could print all the strings like this: </p>\n\n<pre><code>int i;\nfor (i = 0; i &lt; N; ++i) {\n    printf(\"%s\\n\",*ptr++); // '++' \"jumps\" to the next string\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 57, "user_id": 9436858, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/04842621c06bf13ecf1889ae6e57bfb2?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas", "link": "https://stackoverflow.com/users/9436858/thomas"}, "edited": false, "score": 0, "creation_date": 1521664965, "post_id": 49413819, "comment_id": 85834111, "body": "Yes, you&#39;re right, there is <code>error: lvalue required as increment operand</code> when I use <code>*ptr++</code>. I listed all the possible solutions below. If you have time, could you please look at it for me. Thanks"}], "tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": false, "score": 0, "last_activity_date": 1521656111, "creation_date": 1521656111, "answer_id": 49413819, "question_id": 49411287, "link": "https://stackoverflow.com/questions/49411287/confusing-on-pointer-array/49413819#49413819", "title": "Confusing on pointer array", "body": "<p><code>*ptr++</code> is parsed as <code>*(ptr++)</code> - apply the <code>++</code> operator to <code>ptr</code>, then dereference the result. </p>\n\n<p>As written, this results in a <em>constraint violation</em> - <code>ptr</code> is an <em>array</em> of pointers to <code>char</code>, and an expression of array type is a <em>non-modifiable lvalue</em>, and as such may not be the target of an assignment or the operand of the <code>++</code> and <code>--</code> operators.  </p>\n\n<p>The line</p>\n\n<pre><code>printf(\"%s\\n\",*ptr++);\n</code></pre>\n\n<p>should (indeed, <em>must</em>) result in the compiler issuing a diagnostic on the order of \"invalid lvalue in increment\" or something along those lines.  </p>\n"}, {"tags": [], "owner": {"reputation": 57, "user_id": 9436858, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/04842621c06bf13ecf1889ae6e57bfb2?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas", "link": "https://stackoverflow.com/users/9436858/thomas"}, "is_accepted": false, "score": 0, "last_activity_date": 1521665797, "creation_date": 1521665797, "answer_id": 49416367, "question_id": 49411287, "link": "https://stackoverflow.com/questions/49411287/confusing-on-pointer-array/49416367#49416367", "title": "Confusing on pointer array", "body": "<p>No. 1:</p>\n\n<pre><code>void main(void)\n{\n    int i;\n    char *ptr[3]={\"how\",\"are\",\"you\"};\n    for (i=0;i&lt;3;i++)\n        printf(\"%s\\n\",ptr[i]);\n}\n</code></pre>\n\n<p>This prints out correct answer. Good!</p>\n\n<p>No.2:</p>\n\n<pre><code>void main(void)\n{\n    int i;\n    char *ptr[3];\n    *ptr[0] = \"how\";\n    *ptr[1] = \"are\";\n    *ptr[2] = \"you\";\n    for (i=0;i&lt;3;i++)\n        printf(\"%s\\n\",ptr[i]);\n}\n</code></pre>\n\n<p>warning: assignment makes integer from pointer without a cast [enabled by default].....Why can't initialize like this?</p>\n\n<p>No.3:</p>\n\n<pre><code>void main(void)\n{\n    int i;\n    char *ptr[3]={\"how\",\"are\",\"you\"};\n    printf(\"%s\\n\",*ptr++);\n}\n</code></pre>\n\n<p>error: lvalue required as increment operand....Why can't we use <code>*ptr++</code>?</p>\n"}], "owner": {"reputation": 57, "user_id": 9436858, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/04842621c06bf13ecf1889ae6e57bfb2?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas", "link": "https://stackoverflow.com/users/9436858/thomas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 169, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1521665797, "creation_date": 1521648464, "last_edit_date": 1521649505, "question_id": 49411287, "link": "https://stackoverflow.com/questions/49411287/confusing-on-pointer-array", "title": "Confusing on pointer array", "body": "<p>The following is the C code:</p>\n\n<pre><code>char *ptr[100];\nprintf(\"%s\\n\",*ptr++);\n</code></pre>\n\n<p>My question is: we know that array name is not a variable (Ritchie's book \"The C programming language\" Page 99), so if we define</p>\n\n<pre><code>int *pa,a[5];\n</code></pre>\n\n<p>This is legal:</p>\n\n<pre><code>pa = a; pa++;\n</code></pre>\n\n<p>while this is illegal:</p>\n\n<pre><code>a++;\n</code></pre>\n\n<p>Here <code>char *ptr[100]</code> defines a char pointer array, so <code>ptr</code> represents the initial address of the array. For the above code, if <code>*ptr++</code> means <code>*(ptr++)</code>, this is illegal because array name cannot be used as a variable, and also it's meaningless because <code>*(ptr++)</code> still gets an address as opposed to <code>%s</code>. However, if <code>*ptr++</code> means <code>(*ptr)++</code>, it also looks strange... Can anyone help to understand this?</p>\n\n<p>The above is my thinking process, my question is: how can <code>*ptr++</code> give us a string as the code <code>printf(\"%s\\n\",*ptr++);</code> says?</p>\n"}, {"tags": ["c++", "c", "windows"], "comments": [{"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 8, "creation_date": 1521647343, "post_id": 49410616, "comment_id": 85823306, "body": "You might look at <a href=\"http://en.cppreference.com/w/cpp/thread/sleep_for\" rel=\"nofollow noreferrer\"><code>std::this_thread::sleep_for</code></a> if you want to modernize your code."}, {"owner": {"reputation": 1569, "user_id": 1694593, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9ec320e3d57fdbde4b7ecc8194b2a2d1?s=128&d=identicon&r=PG", "display_name": "Wander3r", "link": "https://stackoverflow.com/users/1694593/wander3r"}, "edited": false, "score": 1, "creation_date": 1521647683, "post_id": 49410616, "comment_id": 85823585, "body": "Exactly as the documentation states. Switching to <code>Sleep</code> should be a seamless transition from <code>_sleep</code>"}, {"owner": {"reputation": 154, "user_id": 4277804, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5946227d09a01798802c0418de26931a?s=128&d=identicon&r=PG&f=1", "display_name": "mlel", "link": "https://stackoverflow.com/users/4277804/mlel"}, "edited": false, "score": 0, "creation_date": 1521648018, "post_id": 49410616, "comment_id": 85823865, "body": "Thanks for the <code>sleep_for</code> function. We also have the same question for C project (I will add the C tag as well)."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1521648741, "post_id": 49410616, "comment_id": 85824418, "body": "if look for old crt code - in file <code>slbeep.c</code> - <code>void __cdecl _sleep(unsigned long dwDuration) {      if (dwDuration == 0) {         dwDuration++;     }     Sleep(dwDuration);  }</code> - so <code>_sleep</code> is very thin shell over <code>Sleep</code>"}, {"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1521649379, "post_id": 49410616, "comment_id": 85824883, "body": "sleep() is a posix function, once supported by Windows NT and Microsoft&#39;s C compiler.  It acquired a leading underscore after the posix subsystem fell out of use, too many short lowercase identifiers in the global namespace.  As long as you&#39;d consider posix functions you might as well consider Windows functions :)"}, {"owner": {"reputation": 61409, "user_id": 485343, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e18b024a122df74275dd2c4486e8a2b4?s=128&d=identicon&r=PG", "display_name": "rustyx", "link": "https://stackoverflow.com/users/485343/rustyx"}, "reply_to_user": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1521649522, "post_id": 49410616, "comment_id": 85824995, "body": "@HansPassant - Windows never supported POSIX fully. How do you explain sleep() accepting seconds and _sleep() milliseconds."}], "answers": [{"comments": [{"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1521649779, "post_id": 49411567, "comment_id": 85825222, "body": "simply look for <a href=\"http://www.cnhintl.com/it/DataMaster/1-VB6/VC98/CRT/SRC/SLBEEP.C\" rel=\"nofollow noreferrer\"><code>slbeep.c</code></a> - here <code>_sleep</code> implementation. not need any tests"}, {"owner": {"reputation": 834, "user_id": 3079037, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/DY854.jpg?s=128&g=1", "display_name": "David A. Gray", "link": "https://stackoverflow.com/users/3079037/david-a-gray"}, "edited": false, "score": 0, "creation_date": 1581458944, "post_id": 49411567, "comment_id": 106439107, "body": "I&#39;d count that as an improvement. Why would you ever want to sleep for zero milliseconds."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "reply_to_user": {"reputation": 834, "user_id": 3079037, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/DY854.jpg?s=128&g=1", "display_name": "David A. Gray", "link": "https://stackoverflow.com/users/3079037/david-a-gray"}, "edited": false, "score": 0, "creation_date": 1582543770, "post_id": 49411567, "comment_id": 106801303, "body": "@DavidA.Gray When you specify the amount of time to sleep, it&#39;s a minimum. The platform can put you to sleep for longer if that is beneficial to system performance. So a sleep for zero (or more) milliseconds says to the platform that now would be a good time to put you to sleep if it will help performance but if it won&#39;t help performance, you can continue to do useful work. It&#39;s commonly done at optimal pre-emption points such as right after releasing some locks (to give other threads a chance at it) or right before acquiring some (to reduce the odds you&#39;ll be pre-empted while holding it)."}, {"owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "edited": false, "score": 0, "creation_date": 1582554533, "post_id": 49411567, "comment_id": 106807168, "body": "This was especially useful before there were multicore processors. <code>Sleep(0)</code> is an effective way to hand back your control of the CPU core to the OS."}], "tags": [], "owner": {"reputation": 61409, "user_id": 485343, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e18b024a122df74275dd2c4486e8a2b4?s=128&d=identicon&r=PG", "display_name": "rustyx", "link": "https://stackoverflow.com/users/485343/rustyx"}, "is_accepted": true, "score": 6, "last_activity_date": 1521665153, "last_edit_date": 1521665153, "creation_date": 1521649184, "answer_id": 49411567, "question_id": 49410616, "link": "https://stackoverflow.com/questions/49410616/sleep-vs-sleep-functions/49411567#49411567", "title": "Sleep() vs _sleep() functions", "body": "<p>As RbMm mentioned, <code>_sleep</code> had been <a href=\"http://www.cnhintl.com/it/DataMaster/1-VB6/VC98/CRT/SRC/SLBEEP.C\" rel=\"noreferrer\">implemented</a> as a very thin wrapper around <code>Sleep</code>:</p>\n\n<pre><code>void __cdecl _sleep(unsigned long dwDuration)\n{\n\n    if (dwDuration == 0) {\n        dwDuration++;\n    }\n    Sleep(dwDuration);\n\n}\n</code></pre>\n\n<p>To confirm, we can test it. Fortunately it's easy to test:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;chrono&gt;\n#include &lt;windows.h&gt;\n#include &lt;stdlib.h&gt;\n\nusing namespace std::chrono_literals;\n\nint main() {\n    auto tm1 = std::chrono::system_clock::now();\n    _sleep(250);\n    auto tm2 = std::chrono::system_clock::now();\n    Sleep(250);\n    auto tm3 = std::chrono::system_clock::now();\n    std::cout &lt;&lt; \"_sleep took \" &lt;&lt; (tm2-tm1)/1ms &lt;&lt; \" ms, Sleep took \" &lt;&lt; (tm3-tm2)/1ms &lt;&lt; \" ms\\n\";\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>_sleep took 250 ms, Sleep took 250 ms\n</code></pre>\n\n<p>So it appears both <code>_sleep</code> and <code>Sleep</code> sleep for the specific number of milliseconds.<br>\n<code>_sleep</code> is a MSVC CRT function, and <code>Sleep</code> is a Windows API.<br>\nSo in MSVC they should be interchangeable.</p>\n\n<p>One minor difference is that in case of a <code>0</code> argument, <code>_sleep</code> sleeps for <code>1ms</code> whereas <code>Sleep</code> doesn't sleep at all.</p>\n"}], "owner": {"reputation": 154, "user_id": 4277804, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5946227d09a01798802c0418de26931a?s=128&d=identicon&r=PG&f=1", "display_name": "mlel", "link": "https://stackoverflow.com/users/4277804/mlel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10996, "favorite_count": 2, "accepted_answer_id": 49411567, "answer_count": 1, "score": 8, "last_activity_date": 1582541420, "creation_date": 1521646750, "last_edit_date": 1582541420, "question_id": 49410616, "link": "https://stackoverflow.com/questions/49410616/sleep-vs-sleep-functions", "title": "Sleep() vs _sleep() functions", "body": "<p>Currently, I am working on an old project developed (in C and C++) for Windows with Visual Studio 2010 or less. We would like to update it for newer version such as Visual Studio 2015 or 2017.</p>\n\n<p>I have found that the _sleep() function is <a href=\"https://msdn.microsoft.com/en-US/library/mt620088.aspx\" rel=\"nofollow noreferrer\">no longer supported by Microsoft</a> and that instead I shall use the <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms686298(v=vs.85).aspx\" rel=\"nofollow noreferrer\">Sleep()</a> function.</p>\n\n<p>I didn't find the equivalent <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms686298(v=vs.85).aspx\" rel=\"nofollow noreferrer\">documentation</a> for the old _sleep() function and I wonder if both functions behave exactly identical ? This <a href=\"https://social.msdn.microsoft.com/Forums/vstudio/en-US/dbd2073d-d8ce-4a39-b7b7-29549969536f/what-is-sleep?forum=vcgeneral\" rel=\"nofollow noreferrer\">MSDN post</a> makes me wondering if the only differences are in the types of the argument ?</p>\n\n<p>Thanks in advance for your answers.</p>\n"}, {"tags": ["c", "windows", "multithreading", "sorting"], "comments": [{"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1521646853, "post_id": 49410515, "comment_id": 85822879, "body": "There is a Windows implementation for the pthreads library, ought to be helpful to not have to rewrite the code.  Google can find it for you.  If it <i>must</i> be Windows-specific as an exercise then Google knows that too, query &quot;windows how to create a thread&quot;."}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1521646907, "post_id": 49410515, "comment_id": 85822928, "body": "this is probably a good place to start, but it seems like you&#39;re placing an extra burden on yourself by using a new API rather than what you&#39;re familiar with from lecture: <a href=\"https://msdn.microsoft.com/en-us/library/y6h8hye8.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/y6h8hye8.aspx</a>"}, {"owner": {"reputation": 19, "user_id": 8170658, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7546984cce8a22bdad95985719f00bbb?s=128&d=identicon&r=PG&f=1", "display_name": "xBaskerville", "link": "https://stackoverflow.com/users/8170658/xbaskerville"}, "reply_to_user": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1521647510, "post_id": 49410515, "comment_id": 85823453, "body": "@HansPassant It&#39;s not Windows-specific but i just want to learn it in Windows. I did some research and i read some article on Microsoft. But i can&#39;t get the concept.Especially in this sample code: <a href=\"https://msdn.microsoft.com/en-us/library/esszf9hw.aspx\" rel=\"nofollow noreferrer\">link</a>"}, {"owner": {"reputation": 2244, "user_id": 5520680, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/C1jQH.png?s=128&g=1", "display_name": "Tom&#39;s", "link": "https://stackoverflow.com/users/5520680/toms"}, "edited": false, "score": 0, "creation_date": 1521647987, "post_id": 49410515, "comment_id": 85823844, "body": "Note that since each thread will managing 1/8 of the array, it&#39;s safe to not have a mutex for reading/writing in the array IMHO."}, {"owner": {"reputation": 19, "user_id": 8170658, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7546984cce8a22bdad95985719f00bbb?s=128&d=identicon&r=PG&f=1", "display_name": "xBaskerville", "link": "https://stackoverflow.com/users/8170658/xbaskerville"}, "reply_to_user": {"reputation": 2244, "user_id": 5520680, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/C1jQH.png?s=128&g=1", "display_name": "Tom&#39;s", "link": "https://stackoverflow.com/users/5520680/toms"}, "edited": false, "score": 0, "creation_date": 1521648448, "post_id": 49410515, "comment_id": 85824190, "body": "@Tom&#39;s thanks for the comment i noted it. But i also don&#39;t see a reason for using mutex.I can achieve it without using mutex."}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 8170658, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7546984cce8a22bdad95985719f00bbb?s=128&d=identicon&r=PG&f=1", "display_name": "xBaskerville", "link": "https://stackoverflow.com/users/8170658/xbaskerville"}, "edited": false, "score": 0, "creation_date": 1521659973, "post_id": 49414310, "comment_id": 85831423, "body": "Thanks for the reply. When you say code you mean &quot;CreateThread&quot; part?Where after 3rd &quot;,&quot; which i write &quot;NULL&quot;? If so how i can pass double integer parameters (for indexes) to there if it takes LPVOID type?Should i write another method for splitting Array then in QuickSort method check with if else columns like; &quot;if(hThreadArray[0])then sort first array&quot;?"}, {"owner": {"reputation": 22874, "user_id": 3282056, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/IXonK.jpg?s=128&g=1", "display_name": "rcgldr", "link": "https://stackoverflow.com/users/3282056/rcgldr"}, "reply_to_user": {"reputation": 19, "user_id": 8170658, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7546984cce8a22bdad95985719f00bbb?s=128&d=identicon&r=PG&f=1", "display_name": "xBaskerville", "link": "https://stackoverflow.com/users/8170658/xbaskerville"}, "edited": false, "score": 0, "creation_date": 1521660245, "post_id": 49414310, "comment_id": 85831585, "body": "@xBaskerville - create an array of 8 structures, each with a pair of pointers (start, end) or each with a pointer to the array and a pair of indexes (start, end) or (start, last). Then lpParameter for each CreateThread call would point to one of the 8 structures."}, {"owner": {"reputation": 19, "user_id": 8170658, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7546984cce8a22bdad95985719f00bbb?s=128&d=identicon&r=PG&f=1", "display_name": "xBaskerville", "link": "https://stackoverflow.com/users/8170658/xbaskerville"}, "edited": false, "score": 0, "creation_date": 1521663533, "post_id": 49414310, "comment_id": 85833349, "body": "So, I created an array of 8 structures with 2 integer pointers.Should each proccess take 1 of them automatically?Because when i write pointers[i] in createthread block it says &quot;no suitable conversion function from &quot;arrayPointers&quot; to &quot;LPVOID&quot; exists&quot;. Sorry for newbie questions but i couldn&#39;t get it."}, {"owner": {"reputation": 22874, "user_id": 3282056, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/IXonK.jpg?s=128&g=1", "display_name": "rcgldr", "link": "https://stackoverflow.com/users/3282056/rcgldr"}, "reply_to_user": {"reputation": 19, "user_id": 8170658, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7546984cce8a22bdad95985719f00bbb?s=128&d=identicon&r=PG&f=1", "display_name": "xBaskerville", "link": "https://stackoverflow.com/users/8170658/xbaskerville"}, "edited": false, "score": 0, "creation_date": 1521684920, "post_id": 49414310, "comment_id": 85840353, "body": "@xBaskerville - use <code>&amp;pointers[i]</code> or <code>pointers+i</code> for lpParameter."}], "tags": [], "owner": {"reputation": 22874, "user_id": 3282056, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/IXonK.jpg?s=128&g=1", "display_name": "rcgldr", "link": "https://stackoverflow.com/users/3282056/rcgldr"}, "is_accepted": false, "score": 0, "last_activity_date": 1521659059, "last_edit_date": 1521659059, "creation_date": 1521657819, "answer_id": 49414310, "question_id": 49410515, "link": "https://stackoverflow.com/questions/49410515/sorting-1-million-integers-using-threads-in-windows/49414310#49414310", "title": "Sorting 1 Million Integers Using Threads in Windows", "body": "<p>The code looks OK, except that it creates 7 threads (MAX_THREADS-1) then waits for 8 threads. Also the code should use lpParameter as a pointer to a structure that specifies the 1/8th of the array to be sorted by the thread, which could be a pair of pointers (start and end pointers), or indexes. The code should read in the entire file into the array before starting the threads.</p>\n\n<p>To split the array into 8 parts, then each 1/8th size = array_size / 8, with the last 1/8th being larger than the others (by up to 7 larger). If you want a more even split, let <code>remainder</code> = array_size % 8. Then the first <code>remainder</code> threads get a size of (array_size / 8) + 1, and the rest get a size of (array_size / 8).</p>\n\n<p>Optional - you could use the threads for the merging. Numbering the threads 0 to 7, then thread 6 could wait for thread 7 to exit, then merge parts 6 and 7. Thread 4 could wait for thread 5, merge parts 4 and 5, then wait for thread 6, and merge the merged 4,5 and 6,7, and so on. I'm not sure this would be much faster than a single threaded 8 way merge.</p>\n"}], "owner": {"reputation": 19, "user_id": 8170658, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7546984cce8a22bdad95985719f00bbb?s=128&d=identicon&r=PG&f=1", "display_name": "xBaskerville", "link": "https://stackoverflow.com/users/8170658/xbaskerville"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 174, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1521761768, "creation_date": 1521646473, "last_edit_date": 1521761768, "question_id": 49410515, "link": "https://stackoverflow.com/questions/49410515/sorting-1-million-integers-using-threads-in-windows", "title": "Sorting 1 Million Integers Using Threads in Windows", "body": "<p>I have a task which is Sorting 1 million random integers with <code>8</code> threads in C programming language (in Windows platform).</p>\n\n<ol>\n<li>I have to create a binary file with 1 million random integer inside. (Done)</li>\n<li>I have to buffer these integers into an array. (Done)</li>\n<li>I have to create 8 threads. (Done) Each thread takes 1/8 of the array and sorts it (Algorithm could be Merge or Quick Sort).</li>\n<li>Then merge all sub arrays to construct a completely sorted array.</li>\n</ol>\n\n<p><a href=\"https://i.stack.imgur.com/wLVhu.jpg\" rel=\"nofollow noreferrer\">Here's a detailed description for threads.</a></p>\n\n<p>I'm writing codes on Visual Studio 2017 and here's my progress:</p>\n\n<pre><code>// 1MRandomNumber.cpp : Defines the entry point for the console application.\n//    \n#include \"stdafx.h\"\n#include \"stdio.h\"\n#include \"stdlib.h\"\n#include \"windows.h\"\n#include \"time.h\"\n#include &lt;tchar.h&gt;\n#include &lt;strsafe.h&gt;\n\n#define MAX_THREADS 8\n\nstatic int numbers[1000000];\n\nDWORD WINAPI QuickSort(LPVOID lpParam);\n\n//Creating a File with 1000000 random integers;\nvoid create1MBinaryFile(){\n    int i, x;\n    FILE *fp = fopen(\"1MRandomNumbers.dat\",\"wb\");\n    srand(time(NULL));\n    for (i = 0; i&lt;1000000; i++) {\n        x = (rand() * rand()) % 1000001;\n        fprintf(fp,\"%d \\n\", x);\n    }\n    fclose(fp);\n    printf(\"File is created\\n\");\n}\n\n//Buffers integers to \"numbers\" Array;\nvoid loadFiletoArray() {\n    int i = 0;\n    char buf[128];\n    FILE *fp = fopen(\"1MRandomNumbers.dat\", \"rb\");\n    if (fp == NULL) {\n        fprintf(stderr, \"Error in opening file\");\n        exit(1);\n    }\n\n    for (int i = 0; i &lt; 1000000 - 1; i++) {\n        fgets(buf, sizeof(buf), fp);\n        sscanf_s(buf, \"%d\", &amp;numbers[i]);\n    }\n    fclose(fp);\n    printf(\"Numbers loaded to an array\\n\");\n}\n\n//Creates 8 Threads\nvoid threadCreate() {\n    DWORD   dwThreadIdArray[MAX_THREADS];\n    HANDLE  hThreadArray[MAX_THREADS];\n\n    for (int i = 0; i&lt;MAX_THREADS -1; i++)\n    {\n        hThreadArray[i] = CreateThread(\n            NULL,          \n            0,                    \n            QuickSort,      \n            NULL,         \n            0,                     \n            &amp;dwThreadIdArray[i]);   \n        printf(\"Thread %d created \\n\", dwThreadIdArray[i]);\n    } \n\n    WaitForMultipleObjects(MAX_THREADS, hThreadArray, TRUE, INFINITE);\n\n    for (int i = 0; i&lt;MAX_THREADS; i++)\n    {\n        CloseHandle(hThreadArray[i]);\n    }\n}\n\nint main(int argv, char *argc[])\n{\n    create1MBinaryFile();\n    loadFiletoArray();\n    threadCreate();\n\n    return 0;\n}\n\nDWORD WINAPI QuickSort(LPVOID lpParam) {\n\n    return 0;\n}\n</code></pre>\n\n<p>So how can I create multi-threads in Windows platform. In our lecture we've learnt to do that in POSIX library but I want to learn how can I achieve it with windows threading.</p>\n\n<p>Edit: I Created <code>8</code> threads. Is this a true approach or should I change it? Also how can I split array for each thread and quicksort them? </p>\n"}, {"tags": ["c", "excel", "csv"], "comments": [{"owner": {"reputation": 44820, "user_id": 4492932, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e8938ef2681650e100bc9f83434ef272?s=128&d=identicon&r=PG", "display_name": "DYZ", "link": "https://stackoverflow.com/users/4492932/dyz"}, "edited": false, "score": 5, "creation_date": 1521645963, "post_id": 49410270, "comment_id": 85822185, "body": "It is a BOM marker. Read the first three bytes and discard them."}, {"owner": {"reputation": 4974, "user_id": 2587816, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d0ec5b10cbc8a9a5b707ea67ea60f84d?s=128&d=identicon&r=PG", "display_name": "Jiminion", "link": "https://stackoverflow.com/users/2587816/jiminion"}, "reply_to_user": {"reputation": 44820, "user_id": 4492932, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e8938ef2681650e100bc9f83434ef272?s=128&d=identicon&r=PG", "display_name": "DYZ", "link": "https://stackoverflow.com/users/4492932/dyz"}, "edited": false, "score": 1, "creation_date": 1521645998, "post_id": 49410270, "comment_id": 85822212, "body": "OK, figured it out. Looks like if one saves as UTF-8 .csv that adds the characters (probably header stuff).  If you save as plain .csv, the characters are not present."}, {"owner": {"reputation": 31408, "user_id": 243245, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/aed5c13647d581ae231f019a886e05a8?s=128&d=identicon&r=PG", "display_name": "Rup", "link": "https://stackoverflow.com/users/243245/rup"}, "edited": false, "score": 1, "creation_date": 1521646050, "post_id": 49410270, "comment_id": 85822257, "body": "Not exactly doucmentation, but Wikipedia here: <a href=\"https://en.wikipedia.org/wiki/Byte_order_mark#UTF-8\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Byte_order_mark#UTF-8</a>"}], "answers": [{"tags": [], "owner": {"reputation": 4974, "user_id": 2587816, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d0ec5b10cbc8a9a5b707ea67ea60f84d?s=128&d=identicon&r=PG", "display_name": "Jiminion", "link": "https://stackoverflow.com/users/2587816/jiminion"}, "is_accepted": false, "score": 0, "last_activity_date": 1521723996, "creation_date": 1521723996, "answer_id": 49429517, "question_id": 49410270, "link": "https://stackoverflow.com/questions/49410270/difficulty-reading-csv-file/49429517#49429517", "title": "Difficulty reading .csv file", "body": "<p>The UTF-8 representation of the BOM (byte order mark) is the (hexadecimal) byte sequence 0xEF,0xBB,0xBF. These may be displayed as the characters \u00ef\u00bb\u00bf.</p>\n\n<p>In decimal, these values are 239, 187, and 191 as shown above.</p>\n"}], "owner": {"reputation": 4974, "user_id": 2587816, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d0ec5b10cbc8a9a5b707ea67ea60f84d?s=128&d=identicon&r=PG", "display_name": "Jiminion", "link": "https://stackoverflow.com/users/2587816/jiminion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1521723996, "creation_date": 1521645792, "question_id": 49410270, "link": "https://stackoverflow.com/questions/49410270/difficulty-reading-csv-file", "title": "Difficulty reading .csv file", "body": "<p>I am trying to read in a .csv file (output from Excel) in C.  I assumed the file would only be text values, but I have found 3 characters at the beginning of the file.  They are (unsigned char): 239, 187, 191.</p>\n\n<p>Since I am not expecting these values, my reader gets confused and causes problems. But I have not been able to find documentation.  I saved the file as a UTF-8 .csv file from Excel.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 45031, "user_id": 213136, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b84a36c241e04175fcec402dac43018?s=128&d=identicon&r=PG", "display_name": "Bob Jarvis - Reinstate Monica", "link": "https://stackoverflow.com/users/213136/bob-jarvis-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1521646136, "post_id": 49410267, "comment_id": 85822327, "body": "You really need to debug your code but, OK, let&#39;s start with: &quot;get_numbers&quot; never returns a value. What is it supposed to return - perhaps the number of values entered? Then - you&#39;re passing <code>MAXSIZE</code> to <code>selection_sort</code>. Are you <i>always</i> entering <code>MAXSIZE</code> values? What will the program do if you enter fewer or more values than <code>MAXSIZE</code>?"}, {"owner": {"reputation": 89, "user_id": 5193342, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/iqvT8.jpg?s=128&g=1", "display_name": "Decapitated Rainbow", "link": "https://stackoverflow.com/users/5193342/decapitated-rainbow"}, "reply_to_user": {"reputation": 45031, "user_id": 213136, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b84a36c241e04175fcec402dac43018?s=128&d=identicon&r=PG", "display_name": "Bob Jarvis - Reinstate Monica", "link": "https://stackoverflow.com/users/213136/bob-jarvis-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1521646309, "post_id": 49410267, "comment_id": 85822471, "body": "Bob I see what you&#39;re saying, this is after much of my own failed debugging. At one point it did sort based on how many values are in the array. I also see what you mean for get_numbers. I&#39;ll change that to void."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 1, "creation_date": 1521646866, "post_id": 49410267, "comment_id": 85822894, "body": "Your program needs to remember <b>how many</b> values were entered. (this is your<code>i</code> variable after the loop) You should also check the array bounds before assigning."}, {"owner": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 2, "creation_date": 1521646953, "post_id": 49410267, "comment_id": 85822961, "body": "Why are you writing function prototypes in main? Also, adding a space between the printed values could make your outputs clearer."}, {"owner": {"reputation": 45031, "user_id": 213136, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b84a36c241e04175fcec402dac43018?s=128&d=identicon&r=PG", "display_name": "Bob Jarvis - Reinstate Monica", "link": "https://stackoverflow.com/users/213136/bob-jarvis-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1521647408, "post_id": 49410267, "comment_id": 85823367, "body": "Perhaps <code>get_numbers</code> should return the number of values read in, and that the number of values read should be passed on to the other functions."}, {"owner": {"reputation": 89, "user_id": 5193342, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/iqvT8.jpg?s=128&g=1", "display_name": "Decapitated Rainbow", "link": "https://stackoverflow.com/users/5193342/decapitated-rainbow"}, "edited": false, "score": 0, "creation_date": 1521648110, "post_id": 49410267, "comment_id": 85823931, "body": "Bob I added the spaces like you said, the output gives me this &#39;8 7 6 5 4 3 2 1 44176288 0 1 2 3 4 5 6 7 8 44176288 0&#39; it looks like it does sort it, but whats with these other numbers? Also, the local prototypes are what i&#39;ve been told to do if they&#39;re only used by one function."}, {"owner": {"reputation": 15221, "user_id": 1023911, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Wln26.jpg?s=128&g=1", "display_name": "Werner Henze", "link": "https://stackoverflow.com/users/1023911/werner-henze"}, "edited": false, "score": 1, "creation_date": 1521648418, "post_id": 49410267, "comment_id": 85824172, "body": "You are sorting MAXSIZE elements in the array, but with your input you only filled 8 elements in the array. Reading the last two uninitialized values is undefined behavior, you must not do that. In your case it happens that the array is randomly filled, one value is 0, the other 44176288."}], "answers": [{"comments": [{"owner": {"reputation": 89, "user_id": 5193342, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/iqvT8.jpg?s=128&g=1", "display_name": "Decapitated Rainbow", "link": "https://stackoverflow.com/users/5193342/decapitated-rainbow"}, "edited": false, "score": 0, "creation_date": 1521648991, "post_id": 49411413, "comment_id": 85824604, "body": "Thank you, I mention some of this in my answer."}], "tags": [], "owner": {"reputation": 88, "user_id": 7028606, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ab82a51fdc2fdee018ebd15990de52d?s=128&d=identicon&r=PG&f=1", "display_name": "Jake", "link": "https://stackoverflow.com/users/7028606/jake"}, "is_accepted": false, "score": 1, "last_activity_date": 1521648777, "creation_date": 1521648777, "answer_id": 49411413, "question_id": 49410267, "link": "https://stackoverflow.com/questions/49410267/selection-sort-doesnt-output-as-expected/49411413#49411413", "title": "Selection Sort doesn&#39;t output as expected", "body": "<p>There are quite a few issues with your program.</p>\n\n<p>Function prototypes need to be declared before any other functions.</p>\n\n<p>If they bail out early/late, you need to pass the value of i to print_array. If you pass MAXSIZE you will be reading/writing to memory that isn't yours. Which is why you get weird values.</p>\n"}, {"tags": [], "owner": {"reputation": 89, "user_id": 5193342, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/iqvT8.jpg?s=128&g=1", "display_name": "Decapitated Rainbow", "link": "https://stackoverflow.com/users/5193342/decapitated-rainbow"}, "is_accepted": false, "score": 0, "last_activity_date": 1521648944, "creation_date": 1521648944, "answer_id": 49411474, "question_id": 49410267, "link": "https://stackoverflow.com/questions/49410267/selection-sort-doesnt-output-as-expected/49411474#49411474", "title": "Selection Sort doesn&#39;t output as expected", "body": "<p>Thank you for everyone and their tips! I took what Bob Jarvis had mentioned (sorting based on exact number of values, spacing my output). My main problem was that it seemed to be printing a bunch of random numbers which I was unsure where it came from. After spacing I realized it does sort them but there was a random number ex. 8 7 6 5 4 3 2 1 44176288 0 1 2 3 4 5 6 7 8 44176288 0. After some more debugging I realized that I was also printing not at exact array size. After fixing all the different sizes it was fixed.</p>\n"}], "owner": {"reputation": 89, "user_id": 5193342, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/iqvT8.jpg?s=128&g=1", "display_name": "Decapitated Rainbow", "link": "https://stackoverflow.com/users/5193342/decapitated-rainbow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1521648944, "creation_date": 1521645783, "last_edit_date": 1521646330, "question_id": 49410267, "link": "https://stackoverflow.com/questions/49410267/selection-sort-doesnt-output-as-expected", "title": "Selection Sort doesn&#39;t output as expected", "body": "<p>I have this assignment for my C class. She gave us pseudo code for the selection sort. There's some other requisites, but those I don't need help with. I followed her code, and even looked online for sample code. And mine follows the same concept but it never works. When I print the \"sorted\" array, it prints the unsorted numbers and a bunch of other numbers. If I enter '8 7 6 5 4 3 2 1' my array prints '8765432146142368001234567846142368'.</p>\n\n<pre><code>#define MAXSIZE 10\n\nvoid print_array(const int a[], int size);\n\nint main()\n{\n   int get_numbers(int n[]); //Function to retrieve a list of numbers and \n   returns an array of the numbers\n\n   int numbers[MAXSIZE]; //Array to store unsorted list of numbers\n\n   void selection_sort(int a[], int size);\n\n   puts(\"Enter each number then press enter. (Ctrl + Z) to end.\");\n   get_numbers(numbers);\n   selection_sort(numbers, MAXSIZE);  \n   print_array(numbers, MAXSIZE);\n}\n\nvoid get_numbers(int n[])\n{\n   int s; //Stores return value of scanf\n   int i; //Stores amount of values entered\n\n   for(i = 0; (s = scanf(\"%i\", &amp;n[i])) != EOF; i++);\n\n   if(i == 0)\n   {\n      puts(\"Error: No numbers entered.\");\n   }else if(i &gt; MAXSIZE)\n   {\n      puts(\"Error: Too many values entered.\");\n      print_array(n, MAXSIZE);\n   }else\n   {\n      print_array(n, MAXSIZE);\n   }\n}\n\nvoid print_array(const int a[], int size)\n{\n    for(int i = 0; i &lt; size; i++)\n    {\n        printf(\"%i\", a[i]);\n    }\n}\n\nvoid selection_sort(int a[], int size)\n{\n   void swap(int n[], int i, int min_index);\n   for(int i = 0; i &lt; (size - 1); i++)\n   {\n      int min = a[i];\n      int min_index = i;\n      for(int j = (i + 1); j &lt; size; j++)\n      {\n         if(a[j] &lt; min)\n         {\n            min = a[j];\n            min_index = j;\n         }\n      }\n      swap(a, i, min_index);\n   }\n}\n\nvoid swap(int n[], int i, int min_index)\n{\n    int temp = n[i];\n    n[i] = n[min_index];\n    n[min_index] = temp;\n}\n</code></pre>\n"}, {"tags": ["c", "file", "ipc", "shared-memory", "segment"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1521644304, "post_id": 49409597, "comment_id": 85820832, "body": "If you get an error from a system call, check <code>errno</code> to see <i>why</i> it failed. Use e.g. the <code>perror</code> function instead of <code>printf</code> to print a nice message from <code>errno</code>."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1521644416, "post_id": 49409597, "comment_id": 85820917, "body": "On an unrelated note, by default output to <code>stdout</code> is <i>line buffered</i>. That means the output is flushed when you print a newline (<code>&#39;\\n&#39;</code>). If you print leading newlines, that newline will be printed together with the <i>previous</i> output but nut the output you actually have in the<code>printf</code> call. Try to make it a habit to have <i>trailing</i> newlines instead. I.e. do <code>printf(&quot;This is the client\\n&quot;);</code> instead."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1521648335, "post_id": 49409597, "comment_id": 85824106, "body": "FWIW, cramming everything into an <code>if</code> statement, such as with <code>if((shm=shmat(shmid,NULL,0))==(char*)-1)</code>, is a horrible coding style.  First, it&#39;s overly-complex.  How many extra sets of parenthesis did you have to add to make it work properly?  Second, it&#39;s <i>extremely</i> bug-prone because of the unnecessary complexity.  Third, it&#39;s just about impossible to add any real error-processing code in a way that isn&#39;t also extremely complex.  No one gets extra credit for stuffing as much code into as few lines as possible."}, {"owner": {"reputation": 1348, "user_id": 8096817, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-tfvYbFFghR8/AAAAAAAAAAI/AAAAAAAAABE/AhKI7LLZyGg/photo.jpg?sz=128", "display_name": "jasinth premkumar", "link": "https://stackoverflow.com/users/8096817/jasinth-premkumar"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1521649359, "post_id": 49409597, "comment_id": 85824867, "body": "it is a lab exercise @AndrewHenle it new for me ,"}, {"owner": {"reputation": 1348, "user_id": 8096817, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-tfvYbFFghR8/AAAAAAAAAAI/AAAAAAAAABE/AhKI7LLZyGg/photo.jpg?sz=128", "display_name": "jasinth premkumar", "link": "https://stackoverflow.com/users/8096817/jasinth-premkumar"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1521649580, "post_id": 49409597, "comment_id": 85825037, "body": "@AndrewHenle do you think changing memory address (content address) will work ?"}], "answers": [{"tags": [], "owner": {"reputation": 1348, "user_id": 8096817, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-tfvYbFFghR8/AAAAAAAAAAI/AAAAAAAAABE/AhKI7LLZyGg/photo.jpg?sz=128", "display_name": "jasinth premkumar", "link": "https://stackoverflow.com/users/8096817/jasinth-premkumar"}, "is_accepted": false, "score": 0, "last_activity_date": 1523786120, "creation_date": 1523786120, "answer_id": 49840630, "question_id": 49409597, "link": "https://stackoverflow.com/questions/49409597/shm-server-gives-open-error-for-other-user-when-executing-same-program/49840630#49840630", "title": "shm_server gives open error for other user when executing same program", "body": "<p>i found the problem . the problem every one in my class typed this program from given material which had misplaced semicolon in here</p>\n\n<pre><code>if((shm=shmat(shmid,NULL,0))==(char*)-1);\n</code></pre>\n\n<p>hence it executes next line which states \"open error\".</p>\n\n<p>and while opening file they chose the file which i had  that they didn't (file didn't exist in their directory )</p>\n\n<p>so it lead to another problem </p>\n"}], "owner": {"reputation": 1348, "user_id": 8096817, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-tfvYbFFghR8/AAAAAAAAAAI/AAAAAAAAABE/AhKI7LLZyGg/photo.jpg?sz=128", "display_name": "jasinth premkumar", "link": "https://stackoverflow.com/users/8096817/jasinth-premkumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1523786120, "creation_date": 1521644078, "last_edit_date": 1522151327, "question_id": 49409597, "link": "https://stackoverflow.com/questions/49409597/shm-server-gives-open-error-for-other-user-when-executing-same-program", "title": "shm_server gives open error for other user when executing same program", "body": "<p>we are working on Linux red hat server to practice interprocess communication . everyone in our class connect to server using telnet as different users.</p>\n\n<p>i have compiled and executed my server.c &amp; client.c at first it work's  without error but for my classmates it gives <strong>open error</strong> when executing server.c\n(for me it still works) and  when my friend executes client.c program it print's file content that i shared</p>\n\n<p>for Reference,\n<a href=\"https://users.cs.cf.ac.uk/Dave.Marshall/C/node27.html#SECTION002730000000000000000\" rel=\"nofollow noreferrer\">https://users.cs.cf.ac.uk/Dave.Marshall/C/node27.html#SECTION002730000000000000000</a></p>\n\n<p>SERVER.c</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;sys/ipc.h&gt;\n#include&lt;unistd.h&gt;\n#include&lt;sys/shm.h&gt;\n#include&lt;fcntl.h&gt;\n#include&lt;string.h&gt;\n#define SHMSZ 40\nint main()\n{\n        char ch;\n        int shmid,fo,n,i;\n        char fname[SHMSZ];\n     char buff[600];\n     char *shm,*s;\n     int key=3600;\n     if((shmid=shmget(key,SHMSZ,IPC_CREAT|0666))&lt;0)\n             printf(\"\\nOpen Error\");\n     if((shm=shmat(shmid,NULL,0))==(char*)-1)\n            printf(\"\\nOpen Error\");\n     s=shm;\n     system(\"clear\");\n        printf(\"\\n server is accepting the file name:\");\n        printf(\"\\n Enter the file name:\");\n     scanf(\"%s\",&amp;fname);\n        fo=open(fname,O_RDWR);\n            if(fo&lt;0)                   // here it fails\n                printf(\"\\n Open error\");\n            else\n            {\n                i=0;\n                while(read(fo,buff,sizeof(buff))!=0)\n                {\n                    for(i=0;i&lt;strlen(buff);i++)\n                        *s++=buff[i-1];\n                }\n                *s='\\0';\n                printf(\"\\nClient is loading\\n\");\\\n                while(*shm!='*')\n                    sleep(1);\n                printf(\"\\nClient finished into work\");\n         }\n}\n</code></pre>\n\n<p>client.c</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;sys/ipc.h&gt;\n#include&lt;sys/types.h&gt;\n#include&lt;sys/shm.h&gt;\n#define SHMSZ 40\nint main()\n{\n    int shmid;\n    int key=3600;\n    char *shm,*s;\nif((shmid=shmget(key,SHMSZ,0666))&lt;0)\n            printf(\"\\nShmat error\");\n    if((shm=shmat(shmid,NULL,0))==(char*)-1)\n            printf(\"\\nShmat error\");\n        system(\"clear\");\n        printf(\"\\nThis is the client\");\n        printf(\"\\nReading the content in the memory\");\n        *shm='*';\n        for(s=shm;*s!='\\0';s++)\n            putchar(*s);\n        putchar('\\n');\n\n}\n</code></pre>\n\n<p>expected output:\nServer Side</p>\n\n<pre><code>[it@itserver it]$ cc ipcshms.c\n[it@itserver it]$ ./a.out\nServer is accepting the filename\nEnter the filename:sum.c  //shared file\nClient is Loading\nClient finished its work\n</code></pre>\n\n<p>Client Side</p>\n\n<pre><code>[it@itserver it]$ cc ipcshmc.c\n[it@itserver it]$ ./a.out\nThis is client\nReading the content in memory //shared file content\n#include&lt;stdio.h&gt;\nint main()\n{\n        printf(\"Hi\");\n}\n</code></pre>\n\n<p>i triedto ask my professor about it he refused to lend his ear</p>\n\n<p>what could make <code>if</code> condition to fail and give open error in server.c?</p>\n\n<p>P.S:</p>\n\n<p>if i change segment will it work?</p>\n"}, {"tags": ["c", "pthreads", "isalive"], "comments": [{"owner": {"reputation": 22777, "user_id": 133203, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Fp3hB.jpg?s=128&g=1", "display_name": "Federico klez Culloca", "link": "https://stackoverflow.com/users/133203/federico-klez-culloca"}, "edited": false, "score": 0, "creation_date": 1521643561, "post_id": 49409352, "comment_id": 85820215, "body": "In case it helps <a href=\"https://stackoverflow.com/questions/2156353/how-do-you-query-a-pthread-to-see-if-it-is-still-running\" title=\"how do you query a pthread to see if it is still running\">stackoverflow.com/questions/2156353/&hellip;</a>"}, {"owner": {"reputation": 871334, "user_id": 157247, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/4HovX.jpg?s=128&g=1", "display_name": "T.J. Crowder", "link": "https://stackoverflow.com/users/157247/t-j-crowder"}, "edited": false, "score": 2, "creation_date": 1521643604, "post_id": 49409352, "comment_id": 85820249, "body": "Just because you mention Java, that doesn&#39;t mean the question is Java-related. Don&#39;t tag unrelated languages/technologies."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1521652557, "post_id": 49409352, "comment_id": 85827108, "body": "&#39;Do you guys have any suggestion?&#39; sure - redesign so that such calls/methods are not required."}], "owner": {"user_type": "does_not_exist", "display_name": "user6793527"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 132, "favorite_count": 0, "closed_date": 1521643604, "answer_count": 0, "score": 0, "last_activity_date": 1521643583, "creation_date": 1521643451, "last_edit_date": 1521643583, "question_id": 49409352, "link": "https://stackoverflow.com/questions/49409352/is-there-a-isalive-method-in-c-to-check-the-status-of-a-thread", "closed_reason": "Duplicate", "title": "is there a isAlive method in C to check the status of a thread?", "body": "<p>I need a method, like \"isAlive\" in java, to use in my C project to know the state of a pthread.\nWhile I was searching online I didn't manage to find anything. Do you guys have any suggestion?</p>\n"}, {"tags": ["c", "process", "operating-system"], "comments": [{"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1521643539, "post_id": 49409332, "comment_id": 85820187, "body": "Have the child process call the function and <code>exit()</code> after it returns."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1521644106, "post_id": 49409332, "comment_id": 85820664, "body": "You exit a child process just like you exit your parent process: By calling <code>exit</code> or by returning from <code>main</code>."}], "answers": [{"tags": [], "owner": {"reputation": 9095, "user_id": 8542346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11b206b49cec657d28a5876f8330780e?s=128&d=identicon&r=PG&f=1", "display_name": "H.S.", "link": "https://stackoverflow.com/users/8542346/h-s"}, "is_accepted": false, "score": 5, "last_activity_date": 1521644521, "last_edit_date": 1521644521, "creation_date": 1521644212, "answer_id": 49409652, "question_id": 49409332, "link": "https://stackoverflow.com/questions/49409332/run-a-process-to-work-on-a-particular-function/49409652#49409652", "title": "Run a process to work on a particular function", "body": "<p>You can do:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nvoid fun()\n{\n     printf (\"In fun\\n\");\n     // Do your stuff\n     // ....\n}\n\nint main(void)\n{\n   pid_t pid = fork();\n\n   if (pid == -1) {\n      perror(\"fork failed\");\n      exit(EXIT_FAILURE);\n   }\n   else if (pid == 0) {\n      // Child process\n      fun();   // Calling function in child process\n      exit(EXIT_SUCCESS);\n   }\n   else {\n      // Parent process\n      int status;\n      // Wait for child\n      waitpid(pid, &amp;status, 0);\n   }\n   return EXIT_SUCCESS;\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6690971, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0845703ddbdb07ae6238775422f61511?s=128&d=identicon&r=PG&f=1", "display_name": "MCS97", "link": "https://stackoverflow.com/users/6690971/mcs97"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 370, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1521644521, "creation_date": 1521643404, "question_id": 49409332, "link": "https://stackoverflow.com/questions/49409332/run-a-process-to-work-on-a-particular-function", "title": "Run a process to work on a particular function", "body": "<p>I got a code in C that contains main function and another function, And I made a fork to create another process. I want to make the new process perform only the function and once it finishes executing it will die.</p>\n\n<p>I searched solution but I didn't find.</p>\n"}, {"tags": ["c", "openmp", "hpc"], "comments": [{"owner": {"reputation": 1101, "user_id": 7021836, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/299fc62810116e741333419b8e6cfd24?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Quilliam", "link": "https://stackoverflow.com/users/7021836/alex-quilliam"}, "edited": false, "score": 0, "creation_date": 1521641307, "post_id": 49408326, "comment_id": 85818361, "body": "You&#39;re creating race conditions by accessing the same variable in an unsynchronized way. Try inserting <code>#pragma omp atomic</code> the line before you update an array."}, {"owner": {"reputation": 404, "user_id": 8696281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60d09d55a3db6a849bf5a1403b0ddec9?s=128&d=identicon&r=PG&f=1", "display_name": "Jeff Xi", "link": "https://stackoverflow.com/users/8696281/jeff-xi"}, "reply_to_user": {"reputation": 1101, "user_id": 7021836, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/299fc62810116e741333419b8e6cfd24?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Quilliam", "link": "https://stackoverflow.com/users/7021836/alex-quilliam"}, "edited": false, "score": 0, "creation_date": 1521641581, "post_id": 49408326, "comment_id": 85818577, "body": "@AlexQuilliam I still don&#39;t quite understand how to deal with the array race condition. Could you please be more specific to the modification of my code? Thanks!"}, {"owner": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "edited": false, "score": 2, "creation_date": 1521643645, "post_id": 49408326, "comment_id": 85820286, "body": "List ranking is a problem that is notoriously hard to parallelize. Don&#39;t expect simple OpenMP code to do it. You really would need a strategy that avoids concurrent writes to the same array element. Doing it with atomic would be one way, but that is costly, so you wouldn&#39;t see any performance gain. There is a lot of literature out there about LR, read it. Also, instead of <code>private(i)</code> you should nowadays just declare <code>i</code> inside the <code>for</code> loop."}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 1, "creation_date": 1521645060, "post_id": 49408326, "comment_id": 85821404, "body": "BTW, it&#39;s better to <code>#include &lt;stdlib.h&gt;</code> than to <a href=\"/q/605845\">to cast the return value of <code>malloc()</code> and family</a> in C."}, {"owner": {"reputation": 8381, "user_id": 5239503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MqgeX.jpg?s=128&g=1", "display_name": "Gilles", "link": "https://stackoverflow.com/users/5239503/gilles"}, "edited": false, "score": 3, "creation_date": 1521656228, "post_id": 49408326, "comment_id": 85829283, "body": "Also aside from the race condition your parallel code has, never ever ever do performance measurements on a code that was compiled without optimization switches. Try using at the very least <code>-O3</code> and better  <code>-O3 -march=native -mtune=native</code>"}, {"owner": {"reputation": 404, "user_id": 8696281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60d09d55a3db6a849bf5a1403b0ddec9?s=128&d=identicon&r=PG&f=1", "display_name": "Jeff Xi", "link": "https://stackoverflow.com/users/8696281/jeff-xi"}, "edited": false, "score": 0, "creation_date": 1521669132, "post_id": 49408326, "comment_id": 85836048, "body": "Thank you guys! I think I just found the problem. Since my parallel version code runs faster on my personal mac, I don&#39;t think race condition is a huge obstacle here. The real problem is when I run it on the cluster, I did not specify threads number in my code....(I thought by default I should be assigned some threads but it only assigns one to me given no specification in the code) Thanks again for your comments! I&#39;m writting this for any possible future reference!"}], "answers": [{"comments": [{"owner": {"reputation": 404, "user_id": 8696281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60d09d55a3db6a849bf5a1403b0ddec9?s=128&d=identicon&r=PG&f=1", "display_name": "Jeff Xi", "link": "https://stackoverflow.com/users/8696281/jeff-xi"}, "edited": false, "score": 0, "creation_date": 1521807573, "post_id": 49440276, "comment_id": 85900890, "body": "Thank you! Although I&#39;ve mentioned this problem in my comment. But you&#39;re right! I solved my problem specifying number of threads!"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user9478968"}, "is_accepted": true, "score": 0, "last_activity_date": 1521762588, "creation_date": 1521762588, "answer_id": 49440276, "question_id": 49408326, "link": "https://stackoverflow.com/questions/49408326/openmp-parallel-for-slow-down-my-code-c-language/49440276#49440276", "title": "OpenMP parallel for slow down my code (C language)", "body": "<p>Are you certain it is running on multiple threads?</p>\n\n<p>You should either be setting the \n<a href=\"https://msdn.microsoft.com/en-us/library/yw6c0z19.aspx\" rel=\"nofollow noreferrer\"><code>OMP_NUM_THREADS</code></a> environment variable \nor calling \n<a href=\"https://msdn.microsoft.com/en-us/library/e16bady3.aspx\" rel=\"nofollow noreferrer\"><code>omp_set_num_threads()</code></a> \nat the start of main. You can get the total number of threads available using <a href=\"https://msdn.microsoft.com/en-us/library/62akecca.aspx\" rel=\"nofollow noreferrer\"><code>omp_get_max_threads()</code></a> and do something like</p>\n\n<pre><code>max_threads = omp_get_max_threads()\nomp_set_num_threads(max_threads)\n</code></pre>\n\n<p>See more information about setting the number of threads in <a href=\"https://stackoverflow.com/a/11096742/9478968\">this answer</a>.</p>\n\n<p>Edit: Also you can check how many threads are being used with <a href=\"https://msdn.microsoft.com/en-us/library/xdeb73hc.aspx\" rel=\"nofollow noreferrer\"><code>omp_get_num_threads()</code></a>.</p>\n"}], "owner": {"reputation": 404, "user_id": 8696281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60d09d55a3db6a849bf5a1403b0ddec9?s=128&d=identicon&r=PG&f=1", "display_name": "Jeff Xi", "link": "https://stackoverflow.com/users/8696281/jeff-xi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 743, "favorite_count": 0, "accepted_answer_id": 49440276, "answer_count": 1, "score": 0, "last_activity_date": 1521762588, "creation_date": 1521640654, "last_edit_date": 1521640990, "question_id": 49408326, "link": "https://stackoverflow.com/questions/49408326/openmp-parallel-for-slow-down-my-code-c-language", "title": "OpenMP parallel for slow down my code (C language)", "body": "<p>I'm trying to use openMP to speed up a the parallel version of list ranking. My implementation is as follows:</p>\n\n<pre><code>int ListRankingParallel(int *R1,int *S, int N)\n{\nint i;\nint *Q = (int*)malloc(N * sizeof(int));\n\n#pragma omp parallel for private(i)\nfor (i=0; i&lt;N; i++){\n\n    if( S[i] != -1)R1[i] = 1;\n    else R1[i] = 0;\n    Q[i] = S[i];\n\n}\n\n#pragma omp parallel for private(i)\nfor(i=0; i&lt;N; i++)\n    while (Q[i] != -1 &amp; Q[Q[i]] != -1) {\n        R1[i] = R1[i] + R1[Q[i]];\n        Q[i] = Q[Q[i]];\n    }\n\nfree(Q);\n\nreturn *R1;\n}\n</code></pre>\n\n<p>The serial version of my list ranking is</p>\n\n<pre><code>int ListRankingSerial(int *R2,int *S, int N)\n{\nint temp;  \nint j,i;\nfor( i=0; i&lt;N; i++){\n    j = 0;\n    temp = S[i];\n    while(S[i]!=-1)\n    {\n        j++;\n        S[i] = S[S[i]];\n    }\n    R2[i] = j;\n    S[i] = temp;\n}\n\nreturn *R2;\n}\n</code></pre>\n\n<p>When I run them repectively, using </p>\n\n<pre><code>get_walltime(&amp;S1);\nListRankingParallel(R1,S,N);\nget_walltime(&amp;E1);\n\nget_walltime(&amp;S3);\nListRankingSerial(R3,S,N);\nget_walltime(&amp;E3);\n</code></pre>\n\n<p>If I run my code on my Mac, the parallel version runs significantly faster than the serial version. However, if I run it on another linux cluster, the  parallel version is twice slower than the serial version.</p>\n\n<p>On my mac, I compile my code using</p>\n\n<pre><code>gcc-7 -fopenmp &lt;file name&gt;.c \n</code></pre>\n\n<p>On the cluster, using</p>\n\n<pre><code>gcc -fopenmp &lt;file name&gt;.c \n</code></pre>\n\n<p>If you want to test my code, please use:</p>\n\n<pre><code>int main(){\n\nint N = 1e+5;\nint *S = (int*)malloc(N * sizeof(int));\nint *R1 = (int*)malloc(N * sizeof(int));\nint *R3 = (int*)malloc(N * sizeof(int));\ndouble S1,S2,S3,E1,E2,E3;\nint i;\n\nfor( i = 0; i &lt; N; i++)\n    S[i] = i+1;\n\nS[N-1] = -1;\n\nget_walltime(&amp;S1);\nListRankingParallel(R1,S,N);\nget_walltime(&amp;E1);\nprintf(\"%f\\n\",E1-S1);\n\nget_walltime(&amp;S3);\nListRankingSerial(R3,S,N);\nget_walltime(&amp;E3);\nprintf(\"%f\\n\",E3-S3);\n\n}\n</code></pre>\n\n<p>Can anyone please give me some advice? Thank you!</p>\n"}, {"tags": ["c", "misra"], "comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1523529985, "post_id": 49408077, "comment_id": 86603241, "body": "The function should return a value. Also, you only need to cast the first pointer which you can then offset from (or memcpy)"}], "answers": [{"comments": [{"owner": {"reputation": 1040, "user_id": 1614319, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff0ff3e7d5ad91f5432ad168d4f4c9f5?s=128&d=identicon&r=PG", "display_name": "Andrew", "link": "https://stackoverflow.com/users/1614319/andrew"}, "edited": false, "score": 0, "creation_date": 1523529326, "post_id": 49410361, "comment_id": 86602852, "body": "While you don&#39;t need a Deviation, contrary to popular belief, you should not &quot;simply ignore&quot; an Advisory Rule... you should still document why the Rule is not being applied - even if this is done in the Company- or Project-level coding standards."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 1040, "user_id": 1614319, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff0ff3e7d5ad91f5432ad168d4f4c9f5?s=128&d=identicon&r=PG", "display_name": "Andrew", "link": "https://stackoverflow.com/users/1614319/andrew"}, "edited": false, "score": 0, "creation_date": 1523531795, "post_id": 49410361, "comment_id": 86604446, "body": "@Andrew I think most companies do that too. But this also means that the amount of &quot;clutter&quot; advisory rules in the document needs to be reduced. MISRA-C:2012 11.4 simply can&#39;t be followed in any form of microcontroller system. Same with 1.2. And then there&#39;s 5.9 which isn&#39;t feasible to follow in <i>any</i> program and 15.5 which completely lacks any legitimate rationale. If we force people to write documentation about why they don&#39;t follow all these weak and often irrational advisory rules, that only makes MISRA-C less canonical, more cumbersome and more bureaucratic."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 1040, "user_id": 1614319, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff0ff3e7d5ad91f5432ad168d4f4c9f5?s=128&d=identicon&r=PG", "display_name": "Andrew", "link": "https://stackoverflow.com/users/1614319/andrew"}, "edited": false, "score": 0, "creation_date": 1523532410, "post_id": 49410361, "comment_id": 86604854, "body": "As for how I document these Advisory rules in my own MISRA implementations, I write an essay in the coding standard explaining why the rule isn&#39;t rational. This is fine as per 6.2.3 &quot;alternative arrangements should be made for documenting non-compliances&quot;. I would rather not have to add this extra bureaucracy to the coding standard. Though most of the time, the Advisory MISRA rule can be replaced with one that makes more sense, such as the case of 15.5 where you can instead set a rule that multiple return statements should only be used if they make the code <i>more</i> readable and safe."}, {"owner": {"reputation": 1040, "user_id": 1614319, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff0ff3e7d5ad91f5432ad168d4f4c9f5?s=128&d=identicon&r=PG", "display_name": "Andrew", "link": "https://stackoverflow.com/users/1614319/andrew"}, "edited": false, "score": 0, "creation_date": 1523535027, "post_id": 49410361, "comment_id": 86606590, "body": "My coding standards disapply some MISRA Rules too :-)  But the point I was making is that you shouldn&#39;t &quot;just ignore&quot; them... you should document (even briefly!) the decision,  After all, the Compliance Statement requires that."}], "tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 2, "last_activity_date": 1521646023, "creation_date": 1521646023, "answer_id": 49410361, "question_id": 49408077, "link": "https://stackoverflow.com/questions/49408077/misra-11-3-cast-from-int-to-pointer/49410361#49410361", "title": "MISRA 11.3: cast from int to pointer", "body": "<p>The rationale behind this rule is that MISRA worries about misaligned access when casting from an integer to a pointer. In your case, I assume <code>tm_uint8_t</code> is 1 byte, so alignment shouldn't be an issue here. In that case, the warning is simply a false positive and you can ignore it. This is an advisory rule, so you don't need to raise a deviation.</p>\n\n<p>There is no other work-around, except never working with absolute addresses. Which is most likely not an option here. As you can tell, this rule is very cumbersome when writing hardware-related code, there is just no way such code can follow the rule. </p>\n"}, {"tags": [], "owner": {"reputation": 1040, "user_id": 1614319, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff0ff3e7d5ad91f5432ad168d4f4c9f5?s=128&d=identicon&r=PG", "display_name": "Andrew", "link": "https://stackoverflow.com/users/1614319/andrew"}, "is_accepted": false, "score": 1, "last_activity_date": 1523529150, "creation_date": 1523529150, "answer_id": 49794291, "question_id": 49408077, "link": "https://stackoverflow.com/questions/49408077/misra-11-3-cast-from-int-to-pointer/49794291#49794291", "title": "MISRA 11.3: cast from int to pointer", "body": "<p>Note: MISRA-C:2004 Rule 11.3 is equivalent to MISRA C:2012 Rule 11.4</p>\n\n<p>It is accepted that some MISRA C/C++ Rules may cause a violation to be raised, in situations where the method used is necessary.</p>\n\n<p>Because of this, MISRA C provides a mechanism for Deviating a Rule - and this would be the appropriate route for you to follow... please do not try and find a way around the Rule using \"clever\" code!</p>\n\n<p>As highlighted by this question, accessing specific memory (and/or I/O devices) is one particular case.  In fact, one of the examples included in MISRA C:2012 shows this exact use case as being non-compliant with the Rule.</p>\n\n<p>In 2016, the MISRA C Working Group published additional guidance on Compliance, including enhancing the Deviation process... this gives help on what is a justifiable Deviation - and accessing hardware is one of those!</p>\n\n<p>In due course, it is planned to provide more \"layered\" guidance... but that will not be immediate.</p>\n\n<p>[Please note profile for disclaimer]</p>\n"}], "owner": {"reputation": 97, "user_id": 9430021, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Ankit Shah", "link": "https://stackoverflow.com/users/9430021/ankit-shah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1270, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1523529150, "creation_date": 1521640108, "question_id": 49408077, "link": "https://stackoverflow.com/questions/49408077/misra-11-3-cast-from-int-to-pointer", "title": "MISRA 11.3: cast from int to pointer", "body": "<p>I have one question on how to solve MISRA 2004 11.3 violation.</p>\n\n<p>The code is as follows:</p>\n\n<pre><code>tm_uint8 read( tm_uint8* data)\n{\ndata[0] = *((tm_uint8*)0x00003DD2); \ndata[1] = *((tm_uint8*)0x00003DD3);\ndata[2] = *((tm_uint8*)0x00003DD4);\n}\n</code></pre>\n\n<p>I want to write the value stored at the physical address. It compiles but I have a MISRA violation for 11.3. I want to solve it. Can anyone help me with that?</p>\n"}, {"tags": ["c", "embedded", "stm32f4"], "comments": [{"owner": {"reputation": 610, "user_id": 8979940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DmzYf.jpg?s=128&g=1", "display_name": "Omer Dagan", "link": "https://stackoverflow.com/users/8979940/omer-dagan"}, "edited": false, "score": 0, "creation_date": 1521639729, "post_id": 49407785, "comment_id": 85817045, "body": "youcan check if <code>temp == 4</code> before your <code>get_key()</code> or you can remove the <code>break</code> from the <code>FOURTH</code> case statment... i would have used the first solution"}, {"owner": {"reputation": 1, "user_id": 9511578, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-aLY6iMg0D3A/AAAAAAAAAAI/AAAAAAAAABA/bwYC3FOOsX4/photo.jpg?sz=128", "display_name": "hello you", "link": "https://stackoverflow.com/users/9511578/hello-you"}, "reply_to_user": {"reputation": 610, "user_id": 8979940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DmzYf.jpg?s=128&g=1", "display_name": "Omer Dagan", "link": "https://stackoverflow.com/users/8979940/omer-dagan"}, "edited": false, "score": 0, "creation_date": 1521640008, "post_id": 49407785, "comment_id": 85817260, "body": "what do u mean by check temp == 4 ?"}, {"owner": {"reputation": 610, "user_id": 8979940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DmzYf.jpg?s=128&g=1", "display_name": "Omer Dagan", "link": "https://stackoverflow.com/users/8979940/omer-dagan"}, "edited": false, "score": 0, "creation_date": 1521640737, "post_id": 49407785, "comment_id": 85817892, "body": "if i understand you correctly you need the 5th key press to actually check the entered password... in that case you can ignore this key press by <code>if (temp != 4) key=get_key();</code> it&#39;s a workaround but it should work - ofcourse you need to verify that you initialize and handle the <code>temp</code> variable correctly"}, {"owner": {"reputation": 2316, "user_id": 469006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3855250cd4b053ce9204c773246196b?s=128&d=identicon&r=PG", "display_name": "D Krueger", "link": "https://stackoverflow.com/users/469006/d-krueger"}, "reply_to_user": {"reputation": 610, "user_id": 8979940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DmzYf.jpg?s=128&g=1", "display_name": "Omer Dagan", "link": "https://stackoverflow.com/users/8979940/omer-dagan"}, "edited": false, "score": 0, "creation_date": 1521648530, "post_id": 49407785, "comment_id": 85824255, "body": "If you look at your state machine, every transition from one state to another requires a call to <code>get_key()</code>. So IDLE-&gt;FIRST-&gt;SECOND-&gt;THIRD-&gt;FOURTH-&gt;CHECK requires five calls. @Dagan is suggesting that you should do the check as part of the FOURTH state so that you don&#39;t require another key press to get to CHECK. ISimilarly, you may want to move the code in the IDLE state to the beginning of the FIRST state,."}, {"owner": {"reputation": 1, "user_id": 9511578, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-aLY6iMg0D3A/AAAAAAAAAAI/AAAAAAAAABA/bwYC3FOOsX4/photo.jpg?sz=128", "display_name": "hello you", "link": "https://stackoverflow.com/users/9511578/hello-you"}, "edited": false, "score": 0, "creation_date": 1521673966, "post_id": 49407785, "comment_id": 85837754, "body": "when i run this function now that has a case to check whether the password is correct or not it looks like it compares the first element and ignore the rest"}], "answers": [{"tags": [], "owner": {"reputation": 342, "user_id": 1390652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ca7a1370238d7fd3bf386202259c9e3?s=128&d=identicon&r=PG", "display_name": "Watachiaieto", "link": "https://stackoverflow.com/users/1390652/watachiaieto"}, "is_accepted": false, "score": 0, "last_activity_date": 1522294271, "creation_date": 1522294271, "answer_id": 49547561, "question_id": 49407785, "link": "https://stackoverflow.com/questions/49407785/finite-state-machine-for-reading-password/49547561#49547561", "title": "finite state machine for reading password", "body": "<pre><code>while (1)\n{\n    static uint8 Password[4] = {7, 3, 9, 2};\n    static uint8 Guesses = 0;\n    static uint8 Wrong = 0;\n\n    /*Get the key*/\n    key=get_key();\n\n    /*If the key is not in range...*/\n    if (key&lt;0 || key &gt;9)\n    {\n        /*Return early*/\n        return;\n    }\n\n    /*Wait 300*/\n    HAL_Delay(300);\n\n    /*If the value at the Guess position is not equal to what they pressed...*/\n    if (key != Password[Guesses])\n    {\n        /*Mark the input as wrong*/\n        Wrong = 1\n    }\n\n    /*Increment Guesses for the next time*/\n    Guesses++;\n\n    /*After their fourth input...*/\n    if (Guesses == 4)\n    {\n        /*Reet Guesses*/\n        Guesses = 0;\n        /*If they were wrong...*/\n        if (Wrong == 1)\n        {\n            /*Reset Wrong*/\n            Wrong = 0;\n        }\n        /*Otherwise if they were right...*/\n        else\n        {\n            /*Do something*/\n        }\n    }\n}\n</code></pre>\n\n<p>This is untested - debug a bit and it should work.</p>\n"}], "owner": {"reputation": 1, "user_id": 9511578, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-aLY6iMg0D3A/AAAAAAAAAAI/AAAAAAAAABA/bwYC3FOOsX4/photo.jpg?sz=128", "display_name": "hello you", "link": "https://stackoverflow.com/users/9511578/hello-you"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 408, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1522294271, "creation_date": 1521639276, "last_edit_date": 1521644874, "question_id": 49407785, "link": "https://stackoverflow.com/questions/49407785/finite-state-machine-for-reading-password", "title": "finite state machine for reading password", "body": "<p>I'm trying to read the input from a user using keypad 4x4 and compare the input using a finite state machine as shown below. </p>\n\n<p>When I come to case fourth my state machine does not go to Check case but to the default instead and then takes a key to go to CHECK immediately  which makes the user press five times instead of 4.</p>\n\n<pre><code>while (1)\n{\n    key=get_key();\n    if (key&gt;=0 &amp;&amp; key &lt;=9){\n        switch (password){\n            case FIRST:\n                if (key==7 &amp;&amp; i==0)\n                {\n                    temp++; // increasing every time we enter correct number\n                    password=SECOND;\n                    HAL_Delay(300);\n                    break;\n                }\n                HAL_Delay(300);\n                i++; // To check if we have fed in wrong digit\n                if(i==4) {\n                    password=CHECK;\n                }\n                break;\n//**********************************************************************************************************\n            case SECOND:\n                if (key==3 &amp;&amp; temp==1){\n                    temp++;\n                    HAL_Delay(300);\n                    password=THIRD;\n                    break;\n                }\n                HAL_Delay(300);\n                i++;\n                if((i==3) || (i==2)) {\n                    password=CHECK;\n                }\n                break;\n//****************************************************************************************************\n            case THIRD:\n                if (key==9 &amp;&amp; temp==2)\n                {\n                    temp++;\n                    HAL_Delay(300);\n                    password = FOURTH;\n                    break;\n                }\n                HAL_Delay(300);\n                i++;\n                if((i==2) || (i==1)) {\n                    password=CHECK;\n                }\n                break;\n//*******************************************************************************************************\n            case FOURTH:\n                if (key==2 &amp;&amp; temp==3)\n                {\n                    temp++;\n                    password=CHECK;\n                    break;\n                }\n                //HAL_Delay(300);\n                i++;\n                if(i==1) {\n                    password=CHECK;\n                }\n                break;\n//****************************************************************************************************\n            case CHECK:\n                if (temp==4){ // if temp has incresed to 4 that means that all the numbers entered are correct\n                    HAL_GPIO_WritePin(Led_test_GPIO_Port,Led_test_Pin,1);\n                    HAL_GPIO_WritePin(Led2_test_GPIO_Port,Led2_test_Pin,0);\n                    password=IDLE_PASSWORD;\n                }\n                else if((i==4) || (i==3) || (i==2) || (i==1)) {\n                    HAL_GPIO_WritePin(Led2_test_GPIO_Port,Led2_test_Pin,1);\n                    HAL_GPIO_WritePin(Led_test_GPIO_Port,Led_test_Pin,0);\n                    password=IDLE_PASSWORD;\n                }\n                break;\n//******************************************************************************************************\n            case IDLE_PASSWORD:\n                temp=0;\n                i=0;\n                password = FIRST;\n                break;\n                default:\n                password = FIRST;\n                break;\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1521639758, "post_id": 49407747, "comment_id": 85817070, "body": "Why do you need to do these ugly things? Read this: <a href=\"http://xyproblem.info/\" rel=\"nofollow noreferrer\">The XY problem</a>"}, {"owner": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 2, "creation_date": 1521639785, "post_id": 49407747, "comment_id": 85817085, "body": "No, it will not work always, you are unlucky that it works with your setup. It is simply undefined, there is no guarantee that the compiler does not replace your call with anything completely different."}, {"owner": {"reputation": 2287, "user_id": 5267751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd62e8fd8fbb37abc7e2a39d23828047?s=128&d=identicon&r=PG&f=1", "display_name": "user202729", "link": "https://stackoverflow.com/users/5267751/user202729"}, "edited": false, "score": 0, "creation_date": 1521640381, "post_id": 49407747, "comment_id": 85817584, "body": "You can make a ---lambda--- function wrapper that will call the other function."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 2287, "user_id": 5267751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd62e8fd8fbb37abc7e2a39d23828047?s=128&d=identicon&r=PG&f=1", "display_name": "user202729", "link": "https://stackoverflow.com/users/5267751/user202729"}, "edited": false, "score": 0, "creation_date": 1521640582, "post_id": 49407747, "comment_id": 85817764, "body": "@user202729 - <i>Wrong Language</i>"}, {"owner": {"reputation": 2287, "user_id": 5267751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd62e8fd8fbb37abc7e2a39d23828047?s=128&d=identicon&r=PG&f=1", "display_name": "user202729", "link": "https://stackoverflow.com/users/5267751/user202729"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1521640669, "post_id": 49407747, "comment_id": 85817842, "body": "@DavidC.Rankin Yes, I know this is not C++, so no lambda. But it&#39;s possible to write another function that call this function."}, {"owner": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "edited": false, "score": 0, "creation_date": 1521641231, "post_id": 49407747, "comment_id": 85818297, "body": "Don&#39;t do it. Recommended reading: <a href=\"https://blogs.msdn.microsoft.com/oldnewthing/20040119-00/?p=41003\" rel=\"nofollow noreferrer\">blogs.msdn.microsoft.com/oldnewthing/20040119-00/?p=41003</a> That blog post shows how this can cause real crashes that are pretty hard to debug."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1521641419, "post_id": 49407747, "comment_id": 85818458, "body": "Or very short and simple reading <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.3.2.3p8\" rel=\"nofollow noreferrer\">C11 Standard - 6.3.2.3 Pointers(p8)</a>"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1521642663, "post_id": 49407747, "comment_id": 85819462, "body": "Why even bother to speculate about this? A <code>myFuncA</code> compatible wrapper for <code>myFuncB</code> is a one-liner and all problems are gone."}], "answers": [{"comments": [{"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1521640781, "post_id": 49408023, "comment_id": 85817930, "body": "<i>&quot;if want to write portable code.&quot;</i> -&gt; <i>&quot;if want to write <b>working</b> code.&quot;</i>"}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1521641601, "post_id": 49408023, "comment_id": 85818598, "body": "I meant &quot;working&quot; as &quot;guaranteed to be working&quot;. I don&#39;t consider &quot;working by chance&quot; to be &quot;working&quot;."}], "tags": [], "owner": {"reputation": 369, "user_id": 7400340, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a6380568a3888fda9ed87f3e4f13ea4?s=128&d=identicon&r=PG&f=1", "display_name": "sdobak", "link": "https://stackoverflow.com/users/7400340/sdobak"}, "is_accepted": false, "score": 3, "last_activity_date": 1521639949, "creation_date": 1521639949, "answer_id": 49408023, "question_id": 49407747, "link": "https://stackoverflow.com/questions/49407747/casting-function-pointers-with-different-return-types/49408023#49408023", "title": "Casting function pointers with different return types", "body": "<p>Yes, this is an undefined behaviour and you should never rely on undefined behaviour if want to write portable code.</p>\n\n<p>Function with different return values can have different calling conventions. Your example will probably work for small return types, but when returning large structs (e.g. larger than 32 bits) some compilers will generate code where struct is returned in a temporary memory area which should be cleaned up the the caller. </p>\n"}, {"comments": [{"owner": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "edited": false, "score": 1, "creation_date": 1521644072, "post_id": 49408281, "comment_id": 85820634, "body": "Your last para doesn&#39;t really help, here, because even in C++ the return type is not encoded within, so they also aren&#39;t able to avoid the problem that you describe."}, {"owner": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "reply_to_user": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "edited": false, "score": 0, "creation_date": 1521649936, "post_id": 49408281, "comment_id": 85825353, "body": "That is true. It helps with arguments, but you are right it doesn&#39;t help with non-trivial return types."}], "tags": [], "owner": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "is_accepted": true, "score": 5, "last_activity_date": 1521650138, "last_edit_date": 1521650138, "creation_date": 1521640550, "answer_id": 49408281, "question_id": 49407747, "link": "https://stackoverflow.com/questions/49407747/casting-function-pointers-with-different-return-types/49408281#49408281", "title": "Casting function pointers with different return types", "body": "<p>Agreed it is undefined behaviour, don't do that!</p>\n\n<p>Yes the code functions, i.e. it doesn't fall over, but the value you assign after returning void is undefined.</p>\n\n<p>In a very old version of \"C\" the return type was unspecified and int and void functions could be 'safely' intermixed. The integer value being returned in the designated accumulator register. I remember writing code using this 'feature'!</p>\n\n<p>For almost anything else you might return the results are likely to be fatal.</p>\n\n<p>Going forward a few years, floating-point return values are often returned using the fp coprocessor (we are still in the 80s) register, so you can't mix int and float return types, because the state of the coprocessor would be confused if the caller does not strip off the value, or strips off a value that was never placed there and causes an fp exception. Worse, if you build with fp emulation, then the fp value may be returned on the stack as described next. Also on 32-bit builds it is possible to pass 64bit objects (on 16 bit builds you can have 32 bit objects) which would be returned either using multiple registers or on the stack. If they are on the stack and allocated the wrong size, then some local stomping will occur, </p>\n\n<p>Now, c supports struct return types and return value copy optimisations. All bets are off if you don't match the types correctly.</p>\n\n<p>Also some function models have the caller allocate stack space for the parameters for the call, but the function itself releases the stack. Disagreement between caller and implementation on on the number or types of parameters and return values would be fatal.</p>\n\n<p>By default C function names are exported and linked undecorated -  just the function name defines the symbol, so different modules of your program could have different views about function signatures, which conflict when you link, and potentially generate very interesting runtime errors. </p>\n\n<p>In c++ the function names are highly decorated primarily to allow overloading, but also it helps to avoid signature mismatches. This helps with keeping arguments in step, but actually, ( as noted by @Jens ) the return type is not encoded into the decorated name, primarily because the return type isn't used (wasn't, but I think occasionally can now influence) for overload resolution.</p>\n"}], "owner": {"reputation": 274, "user_id": 4428496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffcaac3073f944c7f550a1397030fdd3?s=128&d=identicon&r=PG&f=1", "display_name": "Thargon", "link": "https://stackoverflow.com/users/4428496/thargon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 793, "favorite_count": 0, "accepted_answer_id": 49408281, "answer_count": 2, "score": 2, "last_activity_date": 1521650138, "creation_date": 1521639164, "last_edit_date": 1521640148, "question_id": 49407747, "link": "https://stackoverflow.com/questions/49407747/casting-function-pointers-with-different-return-types", "title": "Casting function pointers with different return types", "body": "<p>This question is about using function pointers, which are not precisely compatible, but which I hope I can use nevertheless as long as my code relies only on the compatible parts. Let's start with some code to get the idea:</p>\n\n<pre><code>typedef void (*funcp)(int* val);\n\nstatic void myFuncA(int* val) {\n  *val *= 2;\n  return;\n}\n\nstatic int myFuncB(int* val) {\n  *val *= 2;\n  return *val;\n}\n\nint main(void) {\n  funcp f = NULL;\n  int v = 2;\n\n  f = myFuncA;\n  f(&amp;v);\n  // now v is 4\n\n  // explicit cast so the compiler will not complain\n  f = (funcp)myFuncB;\n  f(&amp;v);\n  // now v is 8\n\n  return 0;\n}\n</code></pre>\n\n<p>While the arguments of <code>myFuncA</code> and <code>myFuncB</code> are identical and fully compatible, the return values are not and are thus just ignored by the calling code. I <a href=\"http://coliru.stacked-crooked.com/a/816cf130ea0d6a81\" rel=\"nofollow noreferrer\">tried the above code</a> and it works correctly using GCC.</p>\n\n<p>What I learned so far from <a href=\"https://stackoverflow.com/questions/559581/casting-a-function-pointer-to-another-type\">here</a> and <a href=\"https://stackoverflow.com/questions/31942838/casting-function-pointers\">here</a> is that the functions are incompatible by definition of the standard and <strong>may</strong> cause undefined behavior. My intuition, however, tells me that my code example will still work correctly, since it does not rely in any way on the incompatible parts (the return value). However, in the answers to <a href=\"https://stackoverflow.com/questions/22782166/function-pointers-with-different-return-types\">this question</a> a possible corruption of the stack has been mentioned.</p>\n\n<p>So my question is: Is my example above valid C code so it will <strong>always</strong> work as intended (without any side effects), or does it depend on the compiler?</p>\n\n<hr>\n\n<p>EDIT:\nI want to do this in order to use a \"more powerful\" function with a \"les powerful\" interface. In my example <code>funcp</code> is the interface but I would like to provide additional functionality like <code>myFuncB</code> for optional use.</p>\n"}, {"tags": ["c", "pipe", "fork", "posix"], "comments": [{"owner": {"reputation": 811, "user_id": 9493582, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bfI3b.jpg?s=128&g=1", "display_name": "Arndt Jonasson", "link": "https://stackoverflow.com/users/9493582/arndt-jonasson"}, "edited": false, "score": 0, "creation_date": 1521639175, "post_id": 49407406, "comment_id": 85816586, "body": "There is something wrong with the matching of the { and }. I think you will see it if you reindent the program in your editor. Besides, please post the whole program, with header files and <code>main</code> definition."}, {"owner": {"reputation": 129, "user_id": 8237280, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/db4b912ebcaf01f037546cc8f4db7b76?s=128&d=identicon&r=PG&f=1", "display_name": "Karakayn", "link": "https://stackoverflow.com/users/8237280/karakayn"}, "reply_to_user": {"reputation": 811, "user_id": 9493582, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bfI3b.jpg?s=128&g=1", "display_name": "Arndt Jonasson", "link": "https://stackoverflow.com/users/9493582/arndt-jonasson"}, "edited": false, "score": 0, "creation_date": 1521640156, "post_id": 49407406, "comment_id": 85817390, "body": "I updated my post with a main function and include. It was a typo when I added a comment in my code to this post."}, {"owner": {"reputation": 811, "user_id": 9493582, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bfI3b.jpg?s=128&g=1", "display_name": "Arndt Jonasson", "link": "https://stackoverflow.com/users/9493582/arndt-jonasson"}, "edited": false, "score": 0, "creation_date": 1521640308, "post_id": 49407406, "comment_id": 85817518, "body": "I get some interesting warnings when I compile your program. You should enable warnings and look at the ones you get."}, {"owner": {"reputation": 811, "user_id": 9493582, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bfI3b.jpg?s=128&g=1", "display_name": "Arndt Jonasson", "link": "https://stackoverflow.com/users/9493582/arndt-jonasson"}, "edited": false, "score": 0, "creation_date": 1521640799, "post_id": 49407406, "comment_id": 85817945, "body": "<code>fd</code> is an array, so you presumably want either <code>fd[0]</code> or <code>fd[1]</code>. I haven&#39;t looked at the logic of the whole thing yet."}, {"owner": {"reputation": 129, "user_id": 8237280, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/db4b912ebcaf01f037546cc8f4db7b76?s=128&d=identicon&r=PG&f=1", "display_name": "Karakayn", "link": "https://stackoverflow.com/users/8237280/karakayn"}, "reply_to_user": {"reputation": 811, "user_id": 9493582, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bfI3b.jpg?s=128&g=1", "display_name": "Arndt Jonasson", "link": "https://stackoverflow.com/users/9493582/arndt-jonasson"}, "edited": false, "score": 0, "creation_date": 1521640880, "post_id": 49407406, "comment_id": 85818012, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/167267/discussion-between-karakayn-and-arndt-jonasson\">continue this discussion in chat</a>."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1521641213, "post_id": 49407406, "comment_id": 85818277, "body": "Note that <code>void main()</code> is wrong \u2014 you&#39;re using Unix calls, so you can&#39;t even claim the &#39;Windows exception&#39;.  See [What should <code>main()</code> return in C and C++?]( <a href=\"https://stackoverflow.com/questions/204476/\">stackoverflow.com/questions/204476</a>) for the details."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1521641291, "post_id": 49407406, "comment_id": 85818343, "body": "You aren&#39;t closing enough file descriptors in the child. <b>Rule of thumb</b>: If you <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/dup2.html\" rel=\"nofollow noreferrer\"><code>dup2()</code></a> one end of a pipe to standard input or standard output, close both of the original file descriptors from <code>pipe()</code> as soon as possible. In particular, that means before using any of the <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/execvp.html\" rel=\"nofollow noreferrer\"><code>exec*()</code></a> family of functions. The rule also applies with either <code>dup()</code> or <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/fcntl.html\" rel=\"nofollow noreferrer\"><code>fcntl()</code></a> with <code>F_DUPFD</code>."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1521641411, "post_id": 49407406, "comment_id": 85818451, "body": "The original process that creates the pipe doesn&#39;t self-evidently close the pipe file descriptors \u2014 which is a major problem (no EOF for any process reading from the pipe; processes writing to the pipe can be blocked and hang, rather than being terminated by SIGPIPE )."}, {"owner": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 1, "creation_date": 1521641644, "post_id": 49407406, "comment_id": 85818630, "body": "The general pattern is <code>close(fd[0); dup2(fd[1], STDOUT_FILENO); close(fd[1]);</code>.  You need to close the end of the pipe after you <code>dup</code> it."}, {"owner": {"reputation": 129, "user_id": 8237280, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/db4b912ebcaf01f037546cc8f4db7b76?s=128&d=identicon&r=PG&f=1", "display_name": "Karakayn", "link": "https://stackoverflow.com/users/8237280/karakayn"}, "edited": false, "score": 0, "creation_date": 1521641694, "post_id": 49407406, "comment_id": 85818666, "body": "I have update my post to remove one warning at compile (but I always have exactly the same problem) and update main function definition (I don&#39;t care of the definition because this code come from a function used in my code but here I have just created a quick program so search my mistake and to let you reproduce it)"}, {"owner": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 0, "creation_date": 1521642087, "post_id": 49407406, "comment_id": 85818957, "body": "Did you intend to do <code>close(fd[1]);...dup2(fd[1],STDOUT_FILENO)</code> in the second child, or is that a copy/paste error ?"}], "answers": [{"comments": [{"owner": {"reputation": 129, "user_id": 8237280, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/db4b912ebcaf01f037546cc8f4db7b76?s=128&d=identicon&r=PG&f=1", "display_name": "Karakayn", "link": "https://stackoverflow.com/users/8237280/karakayn"}, "edited": false, "score": 0, "creation_date": 1521709679, "post_id": 49409102, "comment_id": 85849934, "body": "I think I need to have the pipe declared before the first fork because I need to read fd[0] (stdout) in the grandparent process to have the result of the command. I will edit my post to close the write end of the pipe in the grandparent process, thank you. (With this one and when I close all descriptor with @William pattern the second exec doesn&#39;t blocked my program anymore)"}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "reply_to_user": {"reputation": 129, "user_id": 8237280, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/db4b912ebcaf01f037546cc8f4db7b76?s=128&d=identicon&r=PG&f=1", "display_name": "Karakayn", "link": "https://stackoverflow.com/users/8237280/karakayn"}, "edited": false, "score": 0, "creation_date": 1521716795, "post_id": 49409102, "comment_id": 85855062, "body": "I think you want to read a different pipe in the grandparent (with the output of the <code>grep</code> command), not the pipe connecting <code>ls</code> to <code>grep</code>.  It&#39;s easy to get confused here, and the challenge is to use good names and structure so that you know what&#39;s what!"}, {"owner": {"reputation": 129, "user_id": 8237280, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/db4b912ebcaf01f037546cc8f4db7b76?s=128&d=identicon&r=PG&f=1", "display_name": "Karakayn", "link": "https://stackoverflow.com/users/8237280/karakayn"}, "edited": false, "score": 0, "creation_date": 1521721481, "post_id": 49409102, "comment_id": 85858350, "body": "But the output of the grep command is in stdout no ? I redirect stdout to stdin when I am in second child process, then it execute <code>ls -l</code>, then I am in the parent which is executed with the stdin and fill the stdout, and then I am back to the grandparent where I want to read this stdout... I need to call something else ?"}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "reply_to_user": {"reputation": 129, "user_id": 8237280, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/db4b912ebcaf01f037546cc8f4db7b76?s=128&d=identicon&r=PG&f=1", "display_name": "Karakayn", "link": "https://stackoverflow.com/users/8237280/karakayn"}, "edited": false, "score": 0, "creation_date": 1521722678, "post_id": 49409102, "comment_id": 85859295, "body": "Only one process should be reading each pipe.  Why do you think you need the output end of the <code>ls</code>-to-<code>grep</code> pipe anywhere other than in the process that becomes <code>grep</code>?  Perhaps I&#39;m not understanding what you are trying to do."}], "tags": [], "owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "is_accepted": false, "score": 2, "last_activity_date": 1521642825, "creation_date": 1521642825, "answer_id": 49409102, "question_id": 49407406, "link": "https://stackoverflow.com/questions/49407406/how-to-redirect-stdout-to-stdin-using-fork-and-pipe-and-execvp-in-c/49409102#49409102", "title": "How to redirect stdout to stdin using fork and pipe and execvp in c?", "body": "<p>The write end of the pipe is still open in the grandparent process.  We can avoid this problem by creating the pipe in the first child, like this:</p>\n\n<pre><code>    pid = fork();\n\n    if (pid == 0) {\n        // First child process (parent of second child)\n\n        int fd[2];\n        if (pipe(fd) == -1) {\n            perror(\"pipe\");\n        }\n        fprintf(stderr, \"After creating pipe \\n\");\n\n        fprintf(stderr, \"First child process before fork again\\n\");\n        pid2 = fork();\n</code></pre>\n\n<p>We then need to remove the <code>close(fd[1]);</code> that's now out of scope (lean on the compiler).</p>\n\n<hr>\n\n<p>I note in passing that there's a typo: <code>if(pid&lt;0)</code> instead of <code>pid2&lt;0</code>.</p>\n"}], "owner": {"reputation": 129, "user_id": 8237280, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/db4b912ebcaf01f037546cc8f4db7b76?s=128&d=identicon&r=PG&f=1", "display_name": "Karakayn", "link": "https://stackoverflow.com/users/8237280/karakayn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2940, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1521710846, "creation_date": 1521638266, "last_edit_date": 1521710846, "question_id": 49407406, "link": "https://stackoverflow.com/questions/49407406/how-to-redirect-stdout-to-stdin-using-fork-and-pipe-and-execvp-in-c", "title": "How to redirect stdout to stdin using fork and pipe and execvp in c?", "body": "<p>I need to do my own shell implementation but I am not able to correctly implement pipes. </p>\n\n<p>If I have a command like <code>ls -l | grep toto</code> I need to redirect the output (stdout) of <code>ls -l</code> to input (stdin) of <code>grep toto</code>. </p>\n\n<p>I also want to display the result of the command in the parent and not directly in the child on the call of execvp (that's why I have 2 forks). </p>\n\n<p>For the moment, with the following code, I create one child to execute the command using execvp and then I write the result to a variable. The parent get it and display it. \nI also introduce an other fork to correctly execute my pipe. \nIt is working (it execute and display the right result), but my child never finished, execvp blocked after executing my second command after the pipe. </p>\n\n<p>With some research I see it's maybe because I don't close one of my file descriptor, but I checked multiple times and I really didn't see the problem or the descriptor not closed here...</p>\n\n<p>Anyone know what I am doing wrong ?</p>\n\n<p>I am not really good in c, forks &amp; pipes have really dark magic power for me, and I don't understand quite well how it is working at the end... So if you have some suggestions or think something I do is not good, feel free to say it in comments. </p>\n\n<p>Here is my function : </p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n#include&lt;string.h&gt;\n#include&lt;errno.h&gt;\n#include&lt;unistd.h&gt;\n#include&lt;fcntl.h&gt; // open function\n#include&lt;sys/types.h&gt;\n#include&lt;sys/stat.h&gt;\n#include&lt;getopt.h&gt;\n#include&lt;stdbool.h&gt;\n#define STDOUT 1\n#define STDERR 2\nint main(int argc, char** argv)\n{\n\n    //PARENT\n    pid_t pid, wpid, pid2;\n    int status, status2;\n    const int MIN_BUFF_SIZE = 1024;\n\n    int fd[2];\n    if (pipe(fd) == -1) {\n        perror(\"pipe\");\n    }\n    printf(\"After creating pipe \\n\");\n\n    pid = fork();\n\n    if (pid == 0) {\n        // First child process (parent of second child)\n        printf(\"First child process before fork again\\n\");\n        pid2 = fork();\n        if(pid2 == 0)\n        {\n            printf(\"Second child process begin\\n\");\n            //second child we need to execute the left command\n\n            close(fd[0]);\n            printf(\"Second child |Redirect stdout &gt; stdin\\n\");\n            dup2(fd[1], STDOUT_FILENO); // Redirect stdout to stdin\n\n            //test data\n            char* test[3];\n            test[0] = \"ls\\0\";\n            test[1] = \"-l\\0\";\n            test[2] = NULL;\n\n            //TODO test to remove\n            if (execvp(test[0], test) == -1) {\n                perror(\"shell launch error : error in child process &gt; execvp failed \\n\");\n                exit(errno);\n            }\n            printf(\"Second child | After execvp\\n\");\n            exit(errno);\n\n        }else if(pid&lt;0)\n        {\n            perror(\"shell launch error : error forking second child\");\n        }else{\n            do {\n                wpid = waitpid(pid2, &amp;status2, WUNTRACED);\n                printf(\"Second parent\\n\");\n                //Parent\n                close(fd[1]);\n                printf(\"Second parent | Redirect stdout &gt; stdin\\n\");\n                dup2(fd[0], STDIN_FILENO);\n                printf(\"Second parent | After Redirect stdout &gt; stdin\\n\");\n\n                //test data : grep toto \n                char* test2[3];\n                test2[0] = \"grep\\0\";\n                test2[1] = \"toto\\0\";\n                test2[2] = NULL;\n                printf(\"Second parent | Av dup2 fd stdout\\n\");\n                dup2(fd[1], STDOUT_FILENO);\n                close(fd[1]);\n                printf(\"Second parent | Ap dup2 fd stdout\\n\");\n                if (execvp(test2[0], test2) == -1) {\n                    perror(\"shell launch error : error in child process &gt; execvp failed \\n\");\n                    exit(errno);\n                }\n                exit(errno);\n            } while (!WIFEXITED(status2) &amp;&amp; !WIFSIGNALED(status2));\n        }\n\n    } else if (pid &lt; 0) {\n        // Error forking\n        perror(\"shell launch error : error forking\");\n    } else {\n        do {\n            //wait child process to finish it execution. So, according to project requirements,\n            //we need to print the result of the command after the child process is finished\n            wpid = waitpid(pid, &amp;status, WUNTRACED);\n            printf(\"Finished waiting for %d\\n\", wpid);\n\n            close(fd[1]);  // close the write end of the pipe in the parent\n\n            if(status != 0)\n            {\n                printf(\"Status : %d\\n\", status);\n\n            }else{\n                printf(\"We are in the first parent \\n\");\n            }\n        } while (!WIFEXITED(status) &amp;&amp; !WIFSIGNALED(status));\n    }\n    printf(\"Finish ! \\n\");\n    return 0;\n}\n</code></pre>\n\n<p>And here is the output after execution :</p>\n\n<pre><code>After creating pipe \nFirst child process before fork again\nSecond child process begin\nSecond child |Redirect stdout &gt; stdin\nSecond parent\nSecond parent | Redirect stdout &gt; stdin\nSecond parent | After Redirect stdout &gt; stdin\nSecond parent | Av dup2 fd stdout\nSecond parent | Ap dup2 fd stdout\n-rw-r--r-- 1 ubuntu ubuntu    0 Mar  8 08:20 toto.txt\n(and here it does not come back to my shell, it is waiting... something...)\n</code></pre>\n\n<p>I see a lot of subject about <a href=\"https://stackoverflow.com/questions/21914632/implementing-pipe-in-c\">Implementing pipe in c</a> and <a href=\"https://stackoverflow.com/questions/8082932/connecting-n-commands-with-pipes-in-a-shell\">Connecting n commands with pipes in a shell?</a> but they don't have 2 fork like me, and it's my problem here.</p>\n\n<h2> Edit </h2>\n\n<p>I edit my post with @William and @Toby suggestions (closing my descriptor with the pattern given in comments and closing write end of the pipe in the grandparent process before waiting children). I added a comment //new for all new line I added to help other people with the same problem to see the changes. My program is not blocked by execvp anymore. </p>\n\n<p>I always have a problem, if in my grandparent process I tried to read stdout, they are nothing in it instead of my command, I missed one redirection or I closed to much descriptor this time ?</p>\n\n<pre><code>    //PARENT\n    pid_t pid, wpid, pid2;\n    int status, status2;\n    const int MIN_BUFF_SIZE = 1024;\n\n    int fd[2];\n    if (pipe(fd) == -1) {\n        perror(\"pipe\");\n    }\n    printf(\"After creating pipe \\n\");\n\n    pid = fork();\n\n    if (pid == 0) {\n        // First child process (parent of second child)\n        printf(\"First child process before fork again\\n\");\n        pid2 = fork();\n        if(pid2 == 0)\n        {\n            printf(\"Second child process begin\\n\");\n            //second child we need to execute the left command\n\n            close(fd[0]);\n            printf(\"Second child |Redirect stdout &gt; stdin\\n\");\n            dup2(fd[1], STDOUT_FILENO); // Redirect stdout to stdin\n            close(fd[1]); // NEW                \n\n            //test data\n            char* test[3];\n            test[0] = \"ls\\0\";\n            test[1] = \"-l\\0\";\n            test[2] = NULL;\n\n            //TODO test to remove\n            if (execvp(test[0], test) == -1) {\n                perror(\"shell launch error : error in child process &gt; execvp failed \\n\");\n                exit(errno);\n            }\n            printf(\"Second child | After execvp\\n\");\n            exit(errno);\n\n        }else if(pid&lt;0)\n        {\n            perror(\"shell launch error : error forking second child\");\n        }else{\n            do {\n                wpid = waitpid(pid2, &amp;status2, WUNTRACED);\n                printf(\"Second parent\\n\");\n                //Parent\n                close(fd[1]);\n                printf(\"Second parent | Redirect stdout &gt; stdin\\n\");\n                dup2(fd[0], STDIN_FILENO);\n                close(fd[0]); // NEW\n                printf(\"Second parent | After Redirect stdout &gt; stdin\\n\");\n\n                //test data : grep toto \n                char* test2[3];\n                test2[0] = \"grep\\0\";\n                test2[1] = \"toto\\0\";\n                test2[2] = NULL;\n                printf(\"Second parent | Av dup2 fd stdout\\n\");\n\n                close(fd[0]); // NEW\n                dup2(fd[1], STDOUT_FILENO);\n                close(fd[1]);\n\n                printf(\"Second parent | Ap dup2 fd stdout\\n\");\n                if (execvp(test2[0], test2) == -1) {\n                    perror(\"shell launch error : error in child process &gt; execvp failed \\n\");\n                    exit(errno);\n                }\n                exit(errno);\n            } while (!WIFEXITED(status2) &amp;&amp; !WIFSIGNALED(status2));\n        }\n\n    } else if (pid &lt; 0) {\n        // Error forking\n        perror(\"shell launch error : error forking\");\n    } else {\n        do {\n            close(fd[1]);  //NEW close the write end of the pipe in the parent\n            //wait child process to finish it execution. So, according to project requirements,\n            //we need to print the result of the command after the child process is finished\n            wpid = waitpid(pid, &amp;status, WUNTRACED);\n            printf(\"Finished waiting for %d\\n\", wpid);\n\n            char* line_to_display = malloc(1);\n            line_to_display = '\\0';\n\n            if(status != 0)\n            {\n                printf(\"Status : %d\\n\", status);\n\n            }else{\n                printf(\"We are in the first parent \\n\");\n                ssize_t bytes_read = 1;\n                do {\n\n                    line_to_display = realloc(line_to_display, 1024); \n                    //sizeof(char) = 1 so don't need to do MIN_BUFF_SIZE * sizeof(char)\n                    bytes_read = read(fd[0], line_to_display, 1024);\n\n                } while (bytes_read &gt; 0);\n\n                printf(\"%s\\n\", line_to_display);\n            }\n        } while (!WIFEXITED(status) &amp;&amp; !WIFSIGNALED(status));\n    }\n    printf(\"Finish ! \\n\");\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "assembly", "embedded", "renesas-rx"], "comments": [{"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 2, "creation_date": 1521637596, "post_id": 49407044, "comment_id": 85815291, "body": "Do you mean <code>xchg</code> is the only atomic RMW?  Or do you really mean that a simple load or simple store might not be atomic?  i.e. could be only partially executed when an interrupt handler runs."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1521639204, "post_id": 49407044, "comment_id": 85816604, "body": "Yes, your understand is correct on those 3 points you list.  Interrupts happen before or after an instruction, not in the middle.  And a byte store is normally atomic anyway, even on a multi-core CPU.  <code>event_request_message++</code> would give you an atomic load and a separate atomic store, but <i>not</i> an atomic increment.  See <a href=\"https://stackoverflow.com/questions/39393850/can-num-be-atomic-for-int-num\">Can num++ be atomic for &#39;int num&#39;?</a> for more details (including some answers that mention the uniprocessor case where being a single instruction gives you atomicity)"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1521639718, "post_id": 49407044, "comment_id": 85817038, "body": "I created 2 tags for this.  I probably should have only done <code>renesas-rx</code>; we don&#39;t need separate tags for RXv1 vs. <a href=\"https://www.renesas.com/en-hq/about/press-center/news/2013/news20131112.html\" rel=\"nofollow noreferrer\">RXv2</a>.  Is <code>[renesas-rx]</code> a decent name?"}, {"owner": {"reputation": 883, "user_id": 2031070, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c1cdf46bfd03a2e8211bd7fec589bde8?s=128&d=identicon&r=PG&f=1", "display_name": "Krzysztof Bracha", "link": "https://stackoverflow.com/users/2031070/krzysztof-bracha"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1521640691, "post_id": 49407044, "comment_id": 85817859, "body": "@PeterCordes Regarding <code>xchg</code> from the hardware manual: <i>requests for bus access from masters other than the CPU are not accepted until data transfer for the XCHG instruction is completed.</i>  From my understanding that would be even simple load/store but the only controllers that could compete with CPU over memory bus mastership in this case would be DMA or DTC. Perhaps <code>xchg</code> it not relevant to the question, but I wanted to point out that I am aware of the issue."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1521640880, "post_id": 49407044, "comment_id": 85818011, "body": "One-way transfers like a load or a store can be (<a href=\"https://stackoverflow.com/questions/36624881/why-is-integer-assignment-on-a-naturally-aligned-\">and are on most architectures</a>) atomic without locking the bus, even with respect to DMA observers.  So the problem here is that you said &quot;only one instruction that <i>guarantees atomicity</i> (XCHG)&quot;, which would imply that <code>mov</code> load / store are not atomic.  Assuming they are, you should have said &quot;<i>only one read-modify-write instruction that guarantees atomicity (XCHG).</i>&quot; or &quot;<i>only one instruction that locks the bus for atomicity (XCHG).</i>&quot;"}, {"owner": {"reputation": 883, "user_id": 2031070, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c1cdf46bfd03a2e8211bd7fec589bde8?s=128&d=identicon&r=PG&f=1", "display_name": "Krzysztof Bracha", "link": "https://stackoverflow.com/users/2031070/krzysztof-bracha"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1521640906, "post_id": 49407044, "comment_id": 85818038, "body": "@PeterCordes Thank you for your help. The tag sounds good!"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1522055251, "post_id": 49407044, "comment_id": 85978048, "body": "Are you sure RX are always single-core? I don&#39;t know anything about this family, but it would seem that Renesas safety MCU falls into this family and those are usually dual core? (And run in lock-step on safety applications) And they also have various fast, monstrous networking processors in that family too."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1522055470, "post_id": 49407044, "comment_id": 85978206, "body": "Regarding the question, if you disassemble and notice that the caller uses 2 instructions to read, then the code is not safe, simple as that. You need to either use some manner of atomic access or to disable the interrupt during read. If you disable the interrupts and keep the share variable <code>volatile</code>, it should be fine. (assuming single core)"}], "answers": [{"comments": [{"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1521648447, "post_id": 49409910, "comment_id": 85824189, "body": "The OP is on a single-threaded / single-core architecture.  Only compile-time reordering is a concern, because a core always observes its own operations to happen in program order.  So you need a compiler barrier, but not a fence instruction (if RXv1 even has memory fence instructions).  Interrupts are serializing on most architectures, so a core doesn&#39;t have to worry about runtime reordering with respect to an interrupt handler on the same core (just like a thread wrt. a signal handler)."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1521648609, "post_id": 49409910, "comment_id": 85824318, "body": "Ideally the OP&#39;s compiler would support C11 <code>_Atomic char</code>, with <code>memory_order_acquire</code> / <code>memory_order_release</code> to order non-atomic variables with respect to the flag loads/stores."}, {"owner": {"reputation": 883, "user_id": 2031070, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c1cdf46bfd03a2e8211bd7fec589bde8?s=128&d=identicon&r=PG&f=1", "display_name": "Krzysztof Bracha", "link": "https://stackoverflow.com/users/2031070/krzysztof-bracha"}, "edited": false, "score": 0, "creation_date": 1522056324, "post_id": 49409910, "comment_id": 85978709, "body": "@Groo thank you for your help and very useful information!"}, {"owner": {"reputation": 45685, "user_id": 69809, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yCVF0.jpg?s=128&g=1", "display_name": "Groo", "link": "https://stackoverflow.com/users/69809/groo"}, "reply_to_user": {"reputation": 883, "user_id": 2031070, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c1cdf46bfd03a2e8211bd7fec589bde8?s=128&d=identicon&r=PG&f=1", "display_name": "Krzysztof Bracha", "link": "https://stackoverflow.com/users/2031070/krzysztof-bracha"}, "edited": false, "score": 0, "creation_date": 1522060938, "post_id": 49409910, "comment_id": 85981675, "body": "@KrzysztofBracha: no problem, although from the docs I&#39;ve glanced for the mentioned controller, your specific compiler doesn&#39;t seem to do any reordering, so most of my answer are general suggestions for portability since there are no instructions you can use for barriers anyway. Just keep in mind that none of these expressions are atomic, apart from single reads and writes to addresses not wider than <code>int</code> (e.g. an interrupt may enter in the middle of <code>if(event_request_message &amp;&amp; !condition_sending_message)</code>)."}, {"owner": {"reputation": 883, "user_id": 2031070, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c1cdf46bfd03a2e8211bd7fec589bde8?s=128&d=identicon&r=PG&f=1", "display_name": "Krzysztof Bracha", "link": "https://stackoverflow.com/users/2031070/krzysztof-bracha"}, "edited": false, "score": 1, "creation_date": 1522065326, "post_id": 49409910, "comment_id": 85984711, "body": "@Groo Still I appreciate the effort put into your answer. In the case of evaluation, it is fine to interrupt it at any point (<code>condition_sending_message</code> is a user code flag). In general, definitely the only approach to take here is to review each &quot;shared variable&quot; case separately if they consist of different usage/logic. This question and answers also opened a few new topics to me and the whole issue is much clearer now. Thanks again!"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1522081263, "post_id": 49409910, "comment_id": 85996105, "body": "@Groo: compiler barriers against compile-time reordering don&#39;t turn into instructions.  e.g. in GNU C, <code>asm volatile(&quot;&quot; ::: &quot;memory&quot;)</code> forces the contents of all globals to match the C abstract machine at that point (because of the <code>&quot;memory&quot;</code> clobber), and to assume they might have been modified, so the compiler can&#39;t reorder loads or stores in either direction across it.  But the asm instructions inserted is just the empty string <code>&quot;&quot;</code>, so it&#39;s <i>only</i> a compile-time barrier.  Similarly, when compiling for x86, <code>std::atomic_thread_fence(memory_order_release)</code> takes no instructions."}, {"owner": {"reputation": 45685, "user_id": 69809, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yCVF0.jpg?s=128&g=1", "display_name": "Groo", "link": "https://stackoverflow.com/users/69809/groo"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1522092295, "post_id": 49409910, "comment_id": 86002283, "body": "@PeterCordes: yes, perhaps my wording was unclear, I was referring to compiler barriers, I believe we already established that the microcontroller wouldn&#39;t reorder instructions at runtime in the previous comments."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1522092795, "post_id": 49409910, "comment_id": 86002532, "body": "You said &quot;there are no instructions you can use for barriers anyway&quot;.  I guess you meant &quot;intrinsics&quot; or builtins or &quot;C syntax&quot;, because &quot;instructions&quot; (in my mind) is specifically talking about asm-level stuff; i.e. the compiler ouput, not input (unless you use inline-asm).  Anyway, I wondered if this was a terminology issue, since you did say the compiler happens not to reorder.  (That sounds terrible, and would stop <code>a=1; b=2; a=3;</code> from optimizing into 2 stores, unless you just mean it doesn&#39;t reorder anything around / across <code>volatile</code>, so a <code>volatile</code> access is a memory barrier.)"}, {"owner": {"reputation": 45685, "user_id": 69809, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yCVF0.jpg?s=128&g=1", "display_name": "Groo", "link": "https://stackoverflow.com/users/69809/groo"}, "edited": false, "score": 0, "creation_date": 1522096646, "post_id": 49409910, "comment_id": 86004440, "body": "@PeterCorder: yes, intrinsics. I just glanced over the manual so I didn&#39;t want to make bold statements about how it operates. I&#39;ve noticed it doesn&#39;t support C11, mentions doing minor optimizations like loop unrolling and inlining, and states that accesses to non-volatile variables can be optimized, without particular emphasis on reordering. The only way to ensure that two accesses aren&#39;t reordered would therefore be to make them both volatile, as mentioned in the answer."}], "tags": [], "owner": {"reputation": 45685, "user_id": 69809, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yCVF0.jpg?s=128&g=1", "display_name": "Groo", "link": "https://stackoverflow.com/users/69809/groo"}, "is_accepted": true, "score": 3, "last_activity_date": 1521649697, "last_edit_date": 1521649697, "creation_date": 1521644876, "answer_id": 49409910, "question_id": 49407044, "link": "https://stackoverflow.com/questions/49407044/is-the-following-flag-variable-access-safe-between-interrupt-and-user-code/49409910#49409910", "title": "Is the following &quot;flag&quot; variable access safe between interrupt and user code?", "body": "<p>Depending on your goals, i.e. whether you're writing for a specific platform only or want to ensure portability, you need to keep several additional things in mind:</p>\n\n<ol>\n<li><p>With optimizations enabled, many compilers will happily reorder accesses to volatile variables with accesses to non volatile variables, as long as the final result of the operation is indistinguishable to a single-thread scenario. This means that code like this:</p>\n\n<pre><code>int a = 0;\nvolatile int b = 0;\n\nvoid interrupt_a(void) \n{\n    a = b + 1;\n    b = 0;       // set b to zero when done\n}\n</code></pre>\n\n<p>can be <a href=\"https://godbolt.org/g/JzpXbR\" rel=\"nofollow noreferrer\">rearranged by the compiler</a> into:</p>\n\n<pre><code>load acc from [b]\nstore 0 into [b]  // set b to zero *before* updating a, to mess with you a bit\nadd 1 to acc\nstore acc into [a]\n</code></pre>\n\n<p>The way to prevent an optimizing compiler from reordering would be to make <em>both</em> variables volatile.  (Or if available, to use C11 <code>_Atomic</code> with <code>memory_order_release</code> stores and <code>memory_order_acquire</code> loads to order it with respect to operations on non-atomic variables.)</p>\n\n<p>If you're on a multi-core uC, it can reorder memory operations, so this doesn't solve the problem, and the actual solution is to emit a fence for both the compiler and the CPU, if you care about observers on other cores (or in MMIO even on a single-core uC).  Hardware fence instructions aren't needed on a single core or single thread, because even an out-of-order execution CPU sees <em>it's own</em> operations happen in program order.</p>\n\n<p>Again, if the compiler you got with the toolchain for your particular embedded system doesn't know anything about fences, then it's quite likely it will refrain from doing stuff like this. So you need to examine the documentation and check the compiled assembly.</p>\n\n<p>For example, the <a href=\"http://infocenter.arm.com/help/index.jsp?topic=/com.arm.doc.dai0321a/BIHIEIHB.html\" rel=\"nofollow noreferrer\">ARM docs</a> state that the processor is \"allowed\" to reorder instructions and the programmer should take care to add memory barriers, but right after that it also states (under \"implementation detail\") that Cortex M processors do not reorder instructions. However, they still insist that proper barriers should be inserted, since it will simplify porting to a newer version of the processor.</p></li>\n<li><p>Depending on your pipeline length, it might take a couple of instructions until the interrupt is fully enabled or disabled, after you make the request. Again, you need to check the docs for this particular uC/compiler, but sometimes there needs to be a fence of some sort after writing to the register. For example, on ARM Cortex you need to issue both DSB and ISB instructions after disabling the interrupt, to make sure that the interrupt doesn't enter in the next several instructions</p>\n\n<pre><code>// you would have to do this on an ARM Cortex uC\nDisableIRQ(device_IRQn); // Disable certain interrupt by writing to NVIC_CLRENA\nDSB(); // data memory barrier\nISB(); // instruction synchronization barrier\n\n// &lt;-- this is where the interrupt is \"really disabled\"\n</code></pre>\n\n<p>Of course, your library might itself contain all required fence instructions when you call <code>disable_interrupts();</code>, or they might not be needed at all for this architecture.</p></li>\n<li><p>Increment operation (<code>x++</code>) should <strong>not</strong> be considered atomic, even it might \"accidentally\" turn out to be atomic on a certain single-core CPU. As you've noticed, it's not atomic on your particular uC, and the only way to guarantee atomicity is to disable interrupts around this operation.</p></li>\n</ol>\n\n<p>So, ultimately, you should make sure you read the documentation for this platform and understand what the compiler can and cannot do. Something that works today might not work tomorrow if the compiler decides to reorder instructions after you've added a seemingly minor change, especially since a race condition might not be frequent enough to detect it immediately.</p>\n"}], "owner": {"reputation": 883, "user_id": 2031070, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c1cdf46bfd03a2e8211bd7fec589bde8?s=128&d=identicon&r=PG&f=1", "display_name": "Krzysztof Bracha", "link": "https://stackoverflow.com/users/2031070/krzysztof-bracha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 500, "favorite_count": 0, "accepted_answer_id": 49409910, "answer_count": 1, "score": 5, "last_activity_date": 1522055985, "creation_date": 1521637337, "last_edit_date": 1522055985, "question_id": 49407044, "link": "https://stackoverflow.com/questions/49407044/is-the-following-flag-variable-access-safe-between-interrupt-and-user-code", "title": "Is the following &quot;flag&quot; variable access safe between interrupt and user code?", "body": "<p>We have inherited a project which targets Renesas RX231 microcontroller that I have been looking at.</p>\n\n<p>This uC has only one instruction that locks the bus for atomicity (XCHG).  </p>\n\n<p>Because the processor is the only component that accesses RAM memory (no DMA or DTC being used), to manipulate variables in user code that are shared with interrupts, the interrupts are disabled (in the processor status word register) for the access time i.e.</p>\n\n<pre><code>disable_interrupts(); /* set_psw(get_psw() &amp; ~(1 &lt;&lt; 16)); */\n/* access or modify shared variables */\nenable_interrupts();  /* set_psw(get_psw() | (1 &lt;&lt; 16)); */\n</code></pre>\n\n<p>However, there are also \"flags\" being shared without guarding, which are set in interrupts and polled in user code in the following way:</p>\n\n<pre><code>volatile unsigned char event_request_message = 0;\nunsigned char condition_sending_message = 0;\n\n#pragma interrupt\nvoid on_request_message()\n{\n     ...\n     event_request_message = 1; // mov.l   #0x3df5, r14\n                                // mov.b   #1, [r14]\n     ... \n}\n\nvoid user_code()\n{\n     for(;;)\n     {\n         ...\n         /* might be evaluated multiple times before transmit message is completed */\n         if(event_request_message &amp;&amp; !condition_sending_message) // mov.l   #0x3df5, r14\n                                                                 // movu.b  [r14], r14\n                                                                 // cmp     #0, r14\n                                                                 // beq.b   0xfff8e17b &lt;user_code+185&gt;\n                                                                 // mov.l   #0x5990, r14\n                                                                 // movu.b  [r14], r14\n                                                                 // cmp     #0, r14\n                                                                 // bne.b   0xfff8e16f &lt;user_code+173&gt;\n         {\n              event_request_message = 0;     // mov.l   #0x3df5, r14  \n                                             // mov.b   #0, [r14]                  \n              condition_sending_message = 1; // mov.l   #0x5990, r14               \n                                             // mov.b   #1, [r14]\n              /* transmit message */ \n              ... \n         }\n         ...\n     }\n}\n</code></pre>\n\n<p>My understanding of no guarding (by disabling interrupts in user code) in this case would be:</p>\n\n<ul>\n<li>To read, set or clear a \"flag\" always two instructions are used, one to put the memory address in a register and one to read/set/clear</li>\n<li>Memory addresses are always the same so can be discarded from consideration</li>\n<li>Each read/set/clear operation then is a single instruction and therefore the access/manipulation is atomic </li>\n</ul>\n\n<p>The question is: is my understanding correct? Is such \"flag\" variables access and manipulation safe in this case?<br>\nOr could there be any possible bugs/errors?     </p>\n\n<ul>\n<li>Assume the compiler used and compiler options are always the same.   </li>\n<li>Assume that the operations described are the only way such \"flags\" are accessed/manipulated (set to 0 or 1, read (all shown in assembly code)) (no addition, multiplication, etc.)</li>\n</ul>\n\n<p>What if we needed to upgrade the compiler or change compiler options?<br>\nCould such simple operations result in more than \"one instruction\"?</p>\n\n<p>The justification of using such \"flags\" without guarding is too limit the amount time interrupts are disabled. </p>\n\n<p>Looking at the code logic, the expected behaviour is that you can request a message one or more times but you only get one answer.</p>\n\n<p>PS. I tried to use the following additional tags: \"cc-rx\", \"rxv2-instruction-set\", \"rx231\".</p>\n"}, {"tags": ["c", "windows", "dll", "dll-injection"], "comments": [{"owner": {"reputation": 2233, "user_id": 2669128, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/430a24425fb593f00def23e45c454c39?s=128&d=identicon&r=PG", "display_name": "thurizas", "link": "https://stackoverflow.com/users/2669128/thurizas"}, "edited": false, "score": 0, "creation_date": 1521640787, "post_id": 49407028, "comment_id": 85817938, "body": "Did you try calling GetLastError() to see why SetWindowsHookEx failed?"}, {"owner": {"reputation": 41, "user_id": 9528683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72b63e73d89dfad78d14a8793af6eee4?s=128&d=identicon&r=PG&f=1", "display_name": "xizt", "link": "https://stackoverflow.com/users/9528683/xizt"}, "reply_to_user": {"reputation": 2233, "user_id": 2669128, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/430a24425fb593f00def23e45c454c39?s=128&d=identicon&r=PG", "display_name": "thurizas", "link": "https://stackoverflow.com/users/2669128/thurizas"}, "edited": false, "score": 0, "creation_date": 1521641148, "post_id": 49407028, "comment_id": 85818230, "body": "The DbgFunction does that. It returns &#39;failed to hook process: 87 The parameter is incorrect.&#39;"}, {"owner": {"reputation": 2233, "user_id": 2669128, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/430a24425fb593f00def23e45c454c39?s=128&d=identicon&r=PG", "display_name": "thurizas", "link": "https://stackoverflow.com/users/2669128/thurizas"}, "edited": false, "score": 0, "creation_date": 1521759241, "post_id": 49407028, "comment_id": 85881426, "body": "Just checking, you&#39;ve verified that addr and hdll are set correctly?  I don&#39;t see you checking the return values of LoadLibrary or GetProcAddress.  I wouldn&#39;t expect them to fail, but you should check those return values."}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 9528683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72b63e73d89dfad78d14a8793af6eee4?s=128&d=identicon&r=PG&f=1", "display_name": "xizt", "link": "https://stackoverflow.com/users/9528683/xizt"}, "edited": false, "score": 0, "creation_date": 1521651046, "post_id": 49408536, "comment_id": 85826113, "body": "the problem still persists"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "reply_to_user": {"reputation": 41, "user_id": 9528683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72b63e73d89dfad78d14a8793af6eee4?s=128&d=identicon&r=PG&f=1", "display_name": "xizt", "link": "https://stackoverflow.com/users/9528683/xizt"}, "edited": false, "score": 0, "creation_date": 1521651240, "post_id": 49408536, "comment_id": 85826249, "body": "@tejaskulkarni - if you correct write code - must not. faster of all you mistake somewhere. and simply run your code under debugger - step by step (this give enough time to child process to begin run) - still 87 ?"}], "tags": [], "owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "is_accepted": false, "score": 3, "last_activity_date": 1521641792, "last_edit_date": 1521641792, "creation_date": 1521641182, "answer_id": 49408536, "question_id": 49407028, "link": "https://stackoverflow.com/questions/49407028/setwindowshookex-functioning-returning-null/49408536#49408536", "title": "SetWindowsHookEx functioning returning NULL", "body": "<p><code>SetWindowsHookEx</code> fail if it called not for GUI thread. more exactly if <code>Win32Thread</code> field of <code>KTHREAD</code> is 0. you call <code>SetWindowsHookEx</code> too early - thread yet not GUI thread (not initialized gui subsystem). so you need wait for this, before call <code>SetWindowsHookEx</code>. not sure, are possible catch exactly moment (after thread call <code>NtGdiInit</code>), when already possible call <code>SetWindowsHookEx</code>, but simplest way call <code>WaitForInputIdle(pi.hProcess, INFINITE)</code> with handle of new created process and only after it return <code>WAIT_OBJECT_0</code> call  <code>SetWindowsHookExW</code></p>\n\n<p>also, as separate note - for what you allocate <code>STARTUPINFO</code> and <code>STARTUPINFO</code> from heap ? (and not free it late). simply declare it as local variables in function. also <code>STARTUPINFO</code> must be initialized, how minimum as<code>STARTUPINFO si = { sizeof(si) }</code> ; also you not close process and thread handles</p>\n"}], "owner": {"reputation": 41, "user_id": 9528683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72b63e73d89dfad78d14a8793af6eee4?s=128&d=identicon&r=PG&f=1", "display_name": "xizt", "link": "https://stackoverflow.com/users/9528683/xizt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 190, "favorite_count": 3, "answer_count": 1, "score": 4, "last_activity_date": 1521641792, "creation_date": 1521637269, "last_edit_date": 1521639095, "question_id": 49407028, "link": "https://stackoverflow.com/questions/49407028/setwindowshookex-functioning-returning-null", "title": "SetWindowsHookEx functioning returning NULL", "body": "<p>I am working on DLL Injection but getting the error as<br>\n<strong>failed to hook process: 87 The parameter is incorrect.</strong></p>\n\n<p>The target process as well as the dll are both 64 bit.</p>\n\n<p>The Injection code is: </p>\n\n<pre><code>BOOL HookInjection(TCHAR target[], TCHAR *dll_name)\n{\n    // https://msdn.microsoft.com/en-us/library/windows/desktop/ms644990(v=vs.85).aspx\n    // SetWindowsHookEx can be used to inject a DLL into another process. A 32 - bit DLL cannot be injected into a 64 - bit process, \n    // and a 64 - bit DLL cannot be injected into a 32 - bit process.If an application requires the use of hooks in other processes, \n    // it is required that a 32 - bit application call SetWindowsHookEx to inject a 32 - bit DLL into 32 - bit processes, \n    // and a 64 - bit application call SetWindowsHookEx to inject a 64 - bit DLL into 64 - bit processes.The 32 - bit and 64 - bit DLLs must have different names.\n\n    DbgPrint((char*)\"[ ] loading module in local process\");\n    auto hdll = LoadLibrary(dll_name);\n    //Load module -&gt;Loads the specified module into the address space of the calling process. The specified module may cause other modules to be loaded.\n\n    DbgPrint((char*)\"[+] loaded dll\\n\");\n\n    typedef LRESULT(WINAPI * MyProc)(int code, WPARAM wp, LPARAM lp); // export from calc_dll.dll\n\n    //GetProcAdress -&gt; // GetPROCEDUREAdress Retrieves the address of an exported function or variable from the specified dynamic-link library (DLL).\n    HOOKPROC addr = (HOOKPROC)(GetProcAddress(hdll, \"print_successful_injection\"));\n    //auto mp = MyProc(GetProcAddress(hdll, \"StartW\"));\n    //If you know who uses StartW, hush, its a secret ;)\n    DbgPrint((char*)\"[] It worked\");\n    auto pStartupInfo = new STARTUPINFO();\n    auto pProcessInfo = new PROCESS_INFORMATION();\n\n\n    DbgPrint((char*)\"[ ] creating process to hook\");\n    CreateProcess(target,\n        nullptr,\n        nullptr,\n        nullptr,\n        FALSE,\n        NORMAL_PRIORITY_CLASS,\n        nullptr,\n        nullptr,\n        pStartupInfo,\n        pProcessInfo);\n    if (!pProcessInfo)\n    {\n        DbgPrint((char*)\"[-] pprocessInfo fucked up\");\n    }\n\n    if (!pProcessInfo-&gt;hProcess)\n    {\n        DbgPrint((char*)\"[-] failed to create process\");\n        return FALSE;\n    }\n    DbgPrint((char*)\"[+] Created hook process\\n\");\n\n    DbgPrint((char*)\"[ ] creating process hook\");\n    auto hProc = SetWindowsHookEx(WH_CBT,   // Installs a hook procedure that receives notifications useful to a CBT application\n        addr,                                   // my proc symbol taken from the dll\n        hdll,                               // dll containing my proc\n        pProcessInfo-&gt;dwThreadId);          // dword to the thread (something something windows store) RTFM\n    if (!hProc)\n    {\n        DbgPrint((char*)\"[-] failed to hook process\");\n        //This is where the code fails ie hproc is NULL\n        return FALSE;\n    }\n    DbgPrint((char*)\"[+] hook injected\");\n    UnhookWindowsHookEx(hProc);\n\n    return TRUE;\n}\n</code></pre>\n\n<p>The dll that will be injected is as follows:</p>\n\n<pre><code>#include \"stdafx.h\"\n#include&lt;Windows.h&gt;\n\nLRESULT __stdcall print_successful_injection(int code, WPARAM w, LPARAM l)\n{\n    MessageBox(0, L\"Successfully Injected!\", L\"Hello\", MB_ICONINFORMATION);\n    return (CallNextHookEx(NULL, code, w, l));\n}\n</code></pre>\n\n<p>The def file is as follows:</p>\n\n<pre><code>LIBRARY \"dll_to_inject\"\nEXPORTS\nprint_successful_injection\n</code></pre>\n\n<p>the DbgFunction works as follows: </p>\n\n<pre><code>VOID DbgPrint(char *msg)\n{\n\n#ifdef DEBUG\nDWORD eMsgLen, errNum = GetLastError();//dword is unsigned int\nLPTSTR lpvSysMsg; // __Out__ LPTSTR lpBuffer , A pointer to a buffer that receives the null-terminated string that specifies the formatted message\n\nif (msg)\n    printf(\"%s: \", msg);\n\n//FORMAT_MESSAGE_ALLOCATE_BUFFER -&gt; The function allocates a buffer large enough to hold the formatted message, and places a pointer to the allocated buffer at the address specified by lpBuffer.The lpBuffer parameter is a pointer to an LPTSTR\n//FORMAT_MESSAGE_FROM_SYSTEM -&gt; The function should search the system message-table resource(s) for the requested message\neMsgLen = FormatMessage(FORMAT_MESSAGE_ALLOCATE_BUFFER |\n    FORMAT_MESSAGE_FROM_SYSTEM,\n    NULL, errNum, MAKELANGID(LANG_NEUTRAL, SUBLANG_DEFAULT),\n    (LPTSTR)&amp;lpvSysMsg, 0, NULL);\n\n//If the function succeeds, the return value is the number of TCHARs stored in the output buffer, excluding the terminating null character.\n//If the function fails, the return value is zero.\n\nif (eMsgLen &gt; 0)\n    _ftprintf(stderr, _T(\"%d %s\\n\"), errNum, lpvSysMsg);\nelse\n    _ftprintf(stderr, _T(\"Error %d\\n\"), errNum);\nif (lpvSysMsg != NULL)\n    LocalFree(lpvSysMsg);\n#endif\n}\n</code></pre>\n\n<p>I'm pretty new to stackoverflow so I hope I tried to provide as much as details necessary.</p>\n"}, {"tags": ["c", "matrix", "memory-leaks", "segmentation-fault"], "comments": [{"owner": {"reputation": 4232, "user_id": 5281962, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a29ae5ecb74bea23afa60d940edc0282?s=128&d=identicon&r=PG&f=1", "display_name": "Cherubim", "link": "https://stackoverflow.com/users/5281962/cherubim"}, "edited": false, "score": 7, "creation_date": 1521636282, "post_id": 49406621, "comment_id": 85814355, "body": "You need to seed the <code>rand()</code> function only once. Do <code>srand(time(0)); </code> at the start of your <code>main()</code> function and remove it from else where."}, {"owner": {"reputation": 1825, "user_id": 8118147, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/AeaWX.jpg?s=128&g=1", "display_name": "Benjamin Barrois", "link": "https://stackoverflow.com/users/8118147/benjamin-barrois"}, "edited": false, "score": 0, "creation_date": 1521636358, "post_id": 49406621, "comment_id": 85814407, "body": "Your problem is clearly <code>srand</code> as pointed out by the previous comments. An other problem is memory leaks here."}, {"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 3, "creation_date": 1521636441, "post_id": 49406621, "comment_id": 85814466, "body": "<code>time()</code> returns the time in seconds. If you call it 2x in rapid succession (&lt; 1sec) you may get the same value. Thus, you could be seeding the RNG with the same number, which will produce the same sequence of &quot;random&quot; numbers."}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 1, "creation_date": 1521637562, "post_id": 49406621, "comment_id": 85815268, "body": "You are allocating size incorrectly in <code>resMatrix[i] = (int *)malloc(sizeof(int *) * colsA);</code> (<code>sizeof(int *)</code> vs <code>sizeof(int)</code>). I suggest that you read <a href=\"https://stackoverflow.com/q/42094465/694733\">Correctly allocating multi-dimensional arrays</a>."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1521638120, "post_id": 49406621, "comment_id": 85815696, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/7343833/srand-why-call-it-only-once\">srand() \u2014 why call it only once?</a>"}, {"owner": {"reputation": 2244, "user_id": 5520680, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/C1jQH.png?s=128&g=1", "display_name": "Tom&#39;s", "link": "https://stackoverflow.com/users/5520680/toms"}, "edited": false, "score": 0, "creation_date": 1521638444, "post_id": 49406621, "comment_id": 85815969, "body": "It migth be a good idea to make a structure ... because having something like &quot;int **matrix_A,**matrix_B,**matrix_result,i,j,k,tid,rowsA,colsA,&zwnj;&#8203;rowsB,colsB;&quot; is not really friendly."}, {"owner": {"reputation": 33, "user_id": 7592742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28bf1cba74e3ba5e463f029399365875?s=128&d=identicon&r=PG&f=1", "display_name": "aBDYsINGH", "link": "https://stackoverflow.com/users/7592742/abdysingh"}, "edited": false, "score": 0, "creation_date": 1521642736, "post_id": 49406621, "comment_id": 85819532, "body": "Thanks. This really helped clear some of my concepts."}], "answers": [{"tags": [], "owner": {"reputation": 32098, "user_id": 646887, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YJ0Ye.jpg?s=128&g=1", "display_name": "Klas Lindb&#228;ck", "link": "https://stackoverflow.com/users/646887/klas-lindb%c3%a4ck"}, "is_accepted": false, "score": 1, "last_activity_date": 1521637506, "creation_date": 1521637506, "answer_id": 49407104, "question_id": 49406621, "link": "https://stackoverflow.com/questions/49406621/problems-in-generating-random-matrices-in-c/49407104#49407104", "title": "Problems in generating random matrices in C", "body": "<p>As pointed out in the comments: You need to seed the rand() function only once. Do srand(time(0)); at the start of your main() function and remove it from elsewhere.</p>\n\n<p>Non-square matrices: There is a bug/typo in <code>multiply_matrices</code></p>\n\n<p>The line</p>\n\n<pre><code>        for (k = 0; k &lt; colsA; k++)\n</code></pre>\n\n<p>should be </p>\n\n<pre><code>        for (k = 0; k &lt; rowsA; k++)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 33, "user_id": 7592742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28bf1cba74e3ba5e463f029399365875?s=128&d=identicon&r=PG&f=1", "display_name": "aBDYsINGH", "link": "https://stackoverflow.com/users/7592742/abdysingh"}, "edited": false, "score": 1, "creation_date": 1521642220, "post_id": 49407413, "comment_id": 85819079, "body": "Thanks. This fixed my code. I need to read about pointers in more detail."}], "tags": [], "owner": {"reputation": 17331, "user_id": 8950365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c6ba3b19f86f1bea8cf76e691db4349?s=128&d=identicon&r=PG&f=1", "display_name": "rafix07", "link": "https://stackoverflow.com/users/8950365/rafix07"}, "is_accepted": true, "score": 3, "last_activity_date": 1521638306, "creation_date": 1521638306, "answer_id": 49407413, "question_id": 49406621, "link": "https://stackoverflow.com/questions/49406621/problems-in-generating-random-matrices-in-c/49407413#49407413", "title": "Problems in generating random matrices in C", "body": "<p>There are a few issues in your code:</p>\n\n<p>1) You allocate memory incorrectly:</p>\n\n<p>in <em>multiply_matrices</em> should be</p>\n\n<pre><code>resMatrix[i] = (int *)malloc(sizeof(int) * colsB);\n</code></pre>\n\n<p>and in <em>matrix_generator</em></p>\n\n<pre><code>intMatrix[i] = (int *)malloc(sizeof(int) * col);\n</code></pre>\n\n<p>2) In <em>main</em> if you want to print <em>matrix_result</em> call </p>\n\n<pre><code>display_matrix(matrix_result,rowsA,colsB);\n</code></pre>\n\n<p>Dimensions of [rowsA,colsA] x [rowsB,colsB] is <strong>rowsA x colsB</strong> </p>\n\n<p>3)  <code>malloc</code> returns pointer to <strong>uninitialized memory</strong>, so you should set <code>resMatrix</code> elements to zero before summing</p>\n\n<p>Content of 2-nd for loop in <em>multiply_matrices</em> should be </p>\n\n<pre><code>    resMatrix[i][j] = 0;\n    for (k = 0; k &lt; rowsB; k++)  // CHANGED to rowsB\n        resMatrix[i][j] = resMatrix[i][j] + matrix_A[i][k] * matrix_B[k][j];     \n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 7592742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28bf1cba74e3ba5e463f029399365875?s=128&d=identicon&r=PG&f=1", "display_name": "aBDYsINGH", "link": "https://stackoverflow.com/users/7592742/abdysingh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "accepted_answer_id": 49407413, "answer_count": 2, "score": 1, "last_activity_date": 1521695366, "creation_date": 1521636104, "last_edit_date": 1521695366, "question_id": 49406621, "link": "https://stackoverflow.com/questions/49406621/problems-in-generating-random-matrices-in-c", "title": "Problems in generating random matrices in C", "body": "<p>I wrote a serial program to generate 2 random matrices, multiply them and display the result. I wrote functions for each of the tasks, i.e. generating random matrix, multiplying the matrices and displaying the results. I cannot figure out why both the generated matrices are the same.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;time.h&gt;\n\nint **matrix_generator(int row,int col);\nint **multiply_matrices(int **matrix_A,int **matrix_B,int rowsA, int colsA,int rowsB,int colsB);\nvoid display_result(int **matrix,int cols,int rows);\nvoid display_matrix(int **matrixA,int cols,int rows);\n\nvoid main()\n{\n    int **matrix_A,**matrix_B,**matrix_result,i,j,k,tid,rowsA,colsA,rowsB,colsB;\n    printf(\"Enter the dimensions of Matrix A:\\n\");\n    scanf(\"%d%d\",&amp;rowsA,&amp;colsA);\n    printf(\"Enter the dimensions of Matrix B:\\n\");\n    scanf(\"%d%d\",&amp;rowsB,&amp;colsB);\n\n    if(colsA==rowsB)\n    {\n        matrix_A = matrix_generator(rowsA,colsA);\n        matrix_B = matrix_generator(rowsB,colsB);\n        matrix_result = multiply_matrices(matrix_A,matrix_B,rowsA,colsA,rowsB,colsB);\n\n        printf(\"Matrix A:\\n\");\n        display_matrix(matrix_A,rowsA,colsA);\n        printf(\"\\n\\n\");\n\n        printf(\"Matrix B:\\n\");\n        display_matrix(matrix_B,rowsB,colsB);\n        printf(\"\\n\\n\");\n\n        display_matrix(matrix_result,rowsB,colsA);\n\n    }\n    else\n    {\n        printf(\"Check the dimensions of the matrices!\\n\");\n        exit(-1);\n    }\n}\n\nint **matrix_generator(int row, int col)\n{\n    int i, j, **intMatrix;\n\n    intMatrix = (int **)malloc(sizeof(int *) * row); \n    srand(time(0));\n\n    for (i = 0; i &lt; row; i++)\n    {\n        intMatrix[i] = (int *)malloc(sizeof(int *) * col);\n        for (j = 0;j&lt;col;j++)\n        {\n            intMatrix[i][j]=rand()%10;\n        }\n    }\n    return intMatrix;\n}\n\nint **multiply_matrices(int **matrix_A,int **matrix_B,int rowsA, int colsA,int rowsB,int colsB)\n{\n    int i, j, k, **resMatrix;\n\n    resMatrix = (int **)malloc(sizeof(int *) * rowsB); \n\n    for (i = 0; i &lt; rowsA; i++)\n    {\n        resMatrix[i] = (int *)malloc(sizeof(int *) * colsA);\n        for (j = 0;j&lt;colsB;j++)\n        {\n            for (k = 0; k &lt; colsA; k++)\n                resMatrix[i][j] = resMatrix[i][j] + matrix_A[i][k] * matrix_B[k][j];        \n        }\n    }\n    return resMatrix;\n}\n\nvoid display_matrix(int **matrix, int rows,int cols)\n{\n    int i,j;\n    for (i = 0; i &lt; rows; i = i + 1)\n    {\n        for (j = 0; j &lt; cols; j = j + 1)\n            printf(\"%d \",matrix[i][j]);\n        printf(\"\\n\");\n    }        \n}\n</code></pre>\n\n<p>OUTPUT: </p>\n\n<pre><code>Enter the dimensions of Matrix A:\n4\n4\nEnter the dimensions of Matrix B:\n4\n4\nMatrix A:\n8 7 8 4 \n9 8 3 9 \n1 2 0 4 \n6 0 2 3 \n\n\nMatrix B:\n8 7 8 4 \n9 8 3 9 \n1 2 0 4 \n6 0 2 3 \n\n\n159 128 93 139 \n201 133 114 147 \n50 23 22 34 \n68 46 54 41 \n</code></pre>\n\n<p>Can someone please help me understand where I'm going wrong? I have a pretty good idea that it's the matrix_generator() function but cannot seem to figure out what's wrong. Also, It's only multiplying square matrices, if the dimensions are different, like 4X5 and 5X4, I get a segmentation fault.</p>\n"}, {"tags": ["c", "list", "linked-list", "singly-linked-list"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1521634547, "post_id": 49406098, "comment_id": 85813100, "body": "Please show a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. Especially you need to show how you invoke <code>supprime</code>."}, {"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 2, "creation_date": 1521634549, "post_id": 49406098, "comment_id": 85813101, "body": "<code>while ((p-&gt;data!= data2) &amp;&amp; (!p)) {</code> You should reverse those."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1521634597, "post_id": 49406098, "comment_id": 85813132, "body": "There are many other possibilities for problems, like dereferencing <code>k</code> uninitialized if deleting the first node."}, {"owner": {"reputation": 1451, "user_id": 7615877, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AbOhS.jpg?s=128&g=1", "display_name": "akshayk07", "link": "https://stackoverflow.com/users/7615877/akshayk07"}, "reply_to_user": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 0, "creation_date": 1521634603, "post_id": 49406098, "comment_id": 85813134, "body": "@JohnnyMopp Yes, if p is <code>NULL</code>, we need to check that first, before accessing <code>p-&gt;data</code>"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1521634644, "post_id": 49406098, "comment_id": 85813163, "body": "Is the type <code>list</code> defined in a way that it can meaningfully be compared to NULL? <code>head</code> is a pointer to list, <code>*head</code> is a list, <code>*head == NULL</code>compares a list to NULL. Does not seem plausible. I would find <code>head==NULL</code> more convincing."}, {"owner": {"reputation": 1451, "user_id": 7615877, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AbOhS.jpg?s=128&g=1", "display_name": "akshayk07", "link": "https://stackoverflow.com/users/7615877/akshayk07"}, "reply_to_user": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1521634684, "post_id": 49406098, "comment_id": 85813185, "body": "@Yunnosch OP says type of list is not the problem clearly in the question."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "reply_to_user": {"reputation": 1451, "user_id": 7615877, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AbOhS.jpg?s=128&g=1", "display_name": "akshayk07", "link": "https://stackoverflow.com/users/7615877/akshayk07"}, "edited": false, "score": 0, "creation_date": 1521634765, "post_id": 49406098, "comment_id": 85813257, "body": "@aksha Even if list is free of problems, it is easy to misuse when using pointers to it."}, {"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 0, "creation_date": 1521634836, "post_id": 49406098, "comment_id": 85813305, "body": "Also, <code>if (p-&gt;data == data2) {</code>, you should check if <code>p</code> is <code>NULL</code> here."}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1521634877, "post_id": 49406098, "comment_id": 85813335, "body": "@Hocine Abdellatif Why does the second parameter have name data2?"}, {"owner": {"reputation": 1451, "user_id": 7615877, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AbOhS.jpg?s=128&g=1", "display_name": "akshayk07", "link": "https://stackoverflow.com/users/7615877/akshayk07"}, "reply_to_user": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1521634964, "post_id": 49406098, "comment_id": 85813400, "body": "@VladfromMoscow He has mentioned in the comments below the function definition. -- data2 refers to the value we are looking for"}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "reply_to_user": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1521634970, "post_id": 49406098, "comment_id": 85813404, "body": "@VladfromMoscow - did you see this line: <code>if (p-&gt;data == data2) {</code>, or are you just implying in general that <code>data2</code> is not a very descriptive name :)"}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1521635121, "post_id": 49406098, "comment_id": 85813516, "body": "<code>if (p-&gt;data == data2)</code> should simply be <code>if (p)</code> as only when p is not null has the data been found."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1521635223, "post_id": 49406098, "comment_id": 85813583, "body": "There is a problem when <code>(*head)-&gt;data==data2)</code> (i.e. the data searched is in the firts list item)"}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 1, "creation_date": 1521635330, "post_id": 49406098, "comment_id": 85813671, "body": "@ryyker Low-qualified programmers invent names like data3 and then invent reasons to use them. The parameter could be named just like data."}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 1451, "user_id": 7615877, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AbOhS.jpg?s=128&g=1", "display_name": "akshayk07", "link": "https://stackoverflow.com/users/7615877/akshayk07"}, "edited": false, "score": 0, "creation_date": 1521635382, "post_id": 49406098, "comment_id": 85813714, "body": "@akshayk07 And what? Why is the parameter named like data2?"}, {"owner": {"reputation": 1451, "user_id": 7615877, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AbOhS.jpg?s=128&g=1", "display_name": "akshayk07", "link": "https://stackoverflow.com/users/7615877/akshayk07"}, "reply_to_user": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1521641065, "post_id": 49406098, "comment_id": 85818159, "body": "@VladfromMoscow Got your point now."}], "answers": [{"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 5, "last_activity_date": 1521636759, "last_edit_date": 1521636759, "creation_date": 1521635199, "answer_id": 49406335, "question_id": 49406098, "link": "https://stackoverflow.com/questions/49406098/deleting-an-element-in-a-linked-list-in-c/49406335#49406335", "title": "deleting an element in a linked list in c", "body": "<p>It seems you mean something like the following</p>\n\n<pre><code>int supprime( list *head, int data ) \n{\n    while ( *head &amp;&amp; ( *head )-&gt;data != data ) head = &amp;( *head )-&gt;next;\n\n    int success = *head != NULL;\n\n    if ( success )\n    {\n        list tmp = *head;\n        *head = ( *head )-&gt;next;\n        free( tmp );\n    }\n\n    return success;\n}\n</code></pre>\n\n<p>Take into account that the finction should not issue a message. It is the client of the function who decides whether to issue a message.</p>\n\n<p>Here is a demonstrative program.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\ntypedef struct cell \n{\n    int data;\n    struct cell *next;\n} cellule;\n\ntypedef cellule *list;\n\nvoid affiche_liste( list head ) \n{\n    for ( ; head; head = head-&gt;next )\n    {\n        printf( \"%d \", head-&gt;data );\n    }\n}\n\nint ajout_fin( list *head, int data ) \n{\n    list tmp = malloc( sizeof( *tmp ) );\n    int success = tmp != NULL;\n\n    if ( success )\n    {\n        tmp-&gt;data = data;\n        tmp-&gt;next = NULL;\n\n        while ( *head ) head = &amp;( *head )-&gt;next;\n\n        *head = tmp;\n    }\n\n    return success; \n}\n\nint supprime( list *head, int data ) \n{\n    while ( *head &amp;&amp; ( *head )-&gt;data != data ) head = &amp;( *head )-&gt;next;\n\n    int success = *head != NULL;\n\n    if ( success )\n    {\n        list tmp = *head;\n        *head = ( *head )-&gt;next;\n        free( tmp );\n    }\n\n    return success;\n}\n\nint main(void) \n{\n    const int N = 10;\n    list head = NULL;\n\n    int i = 0;\n    for ( ; i &lt; N; i++ )\n    {\n        ajout_fin( &amp;head, i );\n        affiche_liste( head );\n        putchar( '\\n' );\n    }\n\n    while ( i )\n    {\n        supprime( &amp;head, --i );\n        affiche_liste( head );\n        putchar( '\\n' );\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>Its output is</p>\n\n<pre><code>0 \n0 1 \n0 1 2 \n0 1 2 3 \n0 1 2 3 4 \n0 1 2 3 4 5 \n0 1 2 3 4 5 6 \n0 1 2 3 4 5 6 7 \n0 1 2 3 4 5 6 7 8 \n0 1 2 3 4 5 6 7 8 9 \n0 1 2 3 4 5 6 7 8 \n0 1 2 3 4 5 6 7 \n0 1 2 3 4 5 6 \n0 1 2 3 4 5 \n0 1 2 3 4 \n0 1 2 3 \n0 1 2 \n0 1 \n0 \n</code></pre>\n"}], "owner": {"reputation": 511, "user_id": 9063787, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GtWoC.jpg?s=128&g=1", "display_name": "Hocine Abdellatif", "link": "https://stackoverflow.com/users/9063787/hocine-abdellatif"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1521700806, "creation_date": 1521634425, "last_edit_date": 1521644627, "question_id": 49406098, "link": "https://stackoverflow.com/questions/49406098/deleting-an-element-in-a-linked-list-in-c", "title": "deleting an element in a linked list in c", "body": "<p>This procedure in C should delete an element of the linked list according to it's data, but it gets stuck every time I call it. I can confirm that the problem is not with declaring the type of the list or something related.</p>\n\n<pre><code>void supprime(list *head, int data2) {//failed\n//data2 refers to the value we are looking for\n    list p= *head, k;\n    if (*head== NULL) \n        printf(\"the list is empty\");\n    else {\n        while ((p-&gt;data!= data2) &amp;&amp; (!p)) {\n            k= p;\n            p= p-&gt;next;\n        }\n        if (p-&gt;data == data2) {\n            k-&gt;next= p-&gt;next;\n            free(p);\n        }\n        else \n            printf(\"This data is not available\\n\");\n    }\n}\n</code></pre>\n\n<p>If anyone wants the <a href=\"https://1drv.ms/u/s!AkEail-kUdTklxY4S3QbE59j-A25\" rel=\"nofollow noreferrer\">entire source code</a>, just to make sure that everything is okay.</p>\n"}, {"tags": ["c", "execl", "winexe"], "comments": [{"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "edited": false, "score": 0, "creation_date": 1521631008, "post_id": 49404812, "comment_id": 85810626, "body": "Print those variables and check if they are as you expected before calling execl?"}, {"owner": {"reputation": 11, "user_id": 9060931, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcbda4113b5424027d98fddca090fb75?s=128&d=identicon&r=PG&f=1", "display_name": "Kang", "link": "https://stackoverflow.com/users/9060931/kang"}, "reply_to_user": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "edited": false, "score": 0, "creation_date": 1521631261, "post_id": 49404812, "comment_id": 85810804, "body": "Yes. I debugged the program using gdb. print command of gdb printed the variables as expected."}, {"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "edited": false, "score": 0, "creation_date": 1521632408, "post_id": 49404812, "comment_id": 85811618, "body": "You said you are reading from a file. So make sure the escapings are correct, there are no unwanted whitespaces in those variables, etc. Otherwise, it <i>should</i> work whether you use variables or passing strings  directly to execl."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2404501"}, "edited": false, "score": 0, "creation_date": 1521635055, "post_id": 49404812, "comment_id": 85813467, "body": "&quot;reading the above variables from a file&quot; - I bet there&#39;s a leftover newline and/or carriage return that you&#39;re overlooking in the debug print."}, {"owner": {"reputation": 11, "user_id": 9060931, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcbda4113b5424027d98fddca090fb75?s=128&d=identicon&r=PG&f=1", "display_name": "Kang", "link": "https://stackoverflow.com/users/9060931/kang"}, "edited": false, "score": 0, "creation_date": 1521637274, "post_id": 49404812, "comment_id": 85815047, "body": "gdb print is giving me equivalent ASCII codes and NULL at the remaining end of the string. But if i use x/20bc, am seeing 0xffffc042:     47 &#39;/&#39;  0 &#39;\\000&#39;        47 &#39;/&#39;  0 &#39;\\000&#39;        115 &#39;s&#39; 0 &#39;\\000&#39; . Does these &#39;\\000&#39; have any impact ?"}, {"owner": {"reputation": 811, "user_id": 9493582, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bfI3b.jpg?s=128&g=1", "display_name": "Arndt Jonasson", "link": "https://stackoverflow.com/users/9493582/arndt-jonasson"}, "edited": false, "score": 0, "creation_date": 1521639427, "post_id": 49404812, "comment_id": 85816804, "body": "Yes, definitely. Are they perhaps coded in UTF-16? (or wchar_t)"}, {"owner": {"reputation": 11, "user_id": 9060931, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcbda4113b5424027d98fddca090fb75?s=128&d=identicon&r=PG&f=1", "display_name": "Kang", "link": "https://stackoverflow.com/users/9060931/kang"}, "reply_to_user": {"reputation": 811, "user_id": 9493582, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bfI3b.jpg?s=128&g=1", "display_name": "Arndt Jonasson", "link": "https://stackoverflow.com/users/9493582/arndt-jonasson"}, "edited": false, "score": 0, "creation_date": 1521702724, "post_id": 49404812, "comment_id": 85845847, "body": "@ArndtJonasson Yeah, you are absolutely right! I changed it to a datatype that is not wchar_t and it worked. Thank you all."}], "owner": {"reputation": 11, "user_id": 9060931, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcbda4113b5424027d98fddca090fb75?s=128&d=identicon&r=PG&f=1", "display_name": "Kang", "link": "https://stackoverflow.com/users/9060931/kang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 116, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1521631127, "creation_date": 1521630755, "last_edit_date": 1521631127, "question_id": 49404812, "link": "https://stackoverflow.com/questions/49404812/variable-as-argument-to-winexe-command-in-execl-function-is-not-working", "title": "Variable as argument to winexe command in execl function is not working", "body": "<p>I want to execute winexe command through execl function call in a C program.\nIt works if i hard code credentials and machine name in execl call as follows</p>\n\n<pre><code>execl(\"winexe\",\"winexe\",\"-U\",\"Domain/Username%Password\",\"//hostname\",\"ipconfig\",NULL)\n</code></pre>\n\n<p>But if i replace hostname or credentials with a variable, it is not working.</p>\n\n<pre><code>execl(\"winexe\",\"winexe\",\"-U\",credentials_variable,hostname_variable,\"ipconfig\",NULL)\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>winexe version 1.00\nThis program may be freely redistributed under the terms of the GNU GPLv3\nUsage: winexe [-?] [-?] [-?] [-?NP] [-?NPV] [-?|--help] [--usage] [-d|--debuglevel DEBUGLEVEL]\n        [--debug-stderr] [-s|--configfile CONFIGFILE] [--option=name=value]\n        [-l|--log-basename LOGFILEBASE] [--leak-report] [--leak-report-full]\n        [-R|--name-resolve NAME-RESOLVE-ORDER]\n        [-O|--socket-options SOCKETOPTIONS] [-n|--netbiosname NETBIOSNAME]\n        [-S|--signing on|off|required] [-W|--workgroup WORKGROUP]\n        [--realm=REALM] [-i|--scope SCOPE] [-m|--maxprotocol MAXPROTOCOL]\n        [-U|--user [DOMAIN/]USERNAME[%PASSWORD]] [-N|--no-pass]\n        [--password=STRING] [-A|--authentication-file FILE] [-P|--machine-pass]\n        [--simple-bind-dn=STRING] [-k|--kerberos STRING] [-V|--version]\n        [--uninstall] [--reinstall] [--system]\n        [--runas=[DOMAIN\\]USERNAME%PASSWORD] [--runas-file=FILE]\n        [--interactive=0|1] [--ostype=0|1|2] //host command\n</code></pre>\n\n<p>The above output indicates that it is a syntax error. But i have used the exact string, including / and %, in the variable. Note that am reading the above variables from a file. I have passed variables as arguments to other commands using execl functions but i have no idea why winexe is not working! </p>\n\n<p>Please let me know how to use variables as winexe arguments in execl function call.</p>\n"}, {"tags": ["c", "if-statement", "double", "comparison"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1521630082, "post_id": 49404519, "comment_id": 85809985, "body": "There is nothing obviously wrong in the code snipped you posted. You need to debug this, or provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> as well as input (if any), actual and expected output."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1521630220, "post_id": 49404519, "comment_id": 85810082, "body": "Is it your intention that you have <code>coeff[0][0]</code> in the first <code>if</code> and <code>coeff[0][1]</code> in the second <code>if</code>?"}, {"owner": {"reputation": 85822, "user_id": 597607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jCzJi.png?s=128&g=1", "display_name": "Bo Persson", "link": "https://stackoverflow.com/users/597607/bo-persson"}, "edited": false, "score": 1, "creation_date": 1521630237, "post_id": 49404519, "comment_id": 85810097, "body": "You are comparing to <i>different</i> matrix values. Could that be the reason?"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "reply_to_user": {"reputation": 85822, "user_id": 597607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jCzJi.png?s=128&g=1", "display_name": "Bo Persson", "link": "https://stackoverflow.com/users/597607/bo-persson"}, "edited": false, "score": 0, "creation_date": 1521631349, "post_id": 49404519, "comment_id": 85810866, "body": "@BoPersson If it was the same element, the second <code>if ... else</code> would be rather useless."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 1, "creation_date": 1521631400, "post_id": 49404519, "comment_id": 85810903, "body": "What are the values stored in <code>coeff</code> and in <code>x</code>?"}, {"owner": {"reputation": 49, "user_id": 9217066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbb42589841878b30193e339619b5bad?s=128&d=identicon&r=PG&f=1", "display_name": "Mohamed Azzam", "link": "https://stackoverflow.com/users/9217066/mohamed-azzam"}, "reply_to_user": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1521631468, "post_id": 49404519, "comment_id": 85810953, "body": "@Gerhardh exactly, keeping in mind that x is zero and coeff[0][0] is also zero. it doesnt go in it just skips"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 1, "creation_date": 1521631550, "post_id": 49404519, "comment_id": 85811012, "body": "Please provide a <a href=\"https://stackoverflow.com/help/mcve\">MCVE</a> for your problem."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 1, "creation_date": 1521635388, "post_id": 49404519, "comment_id": 85813717, "body": "I bet when an MCVE arrives, it will be a duplicate of <a href=\"https://stackoverflow.com/questions/588004/is-floating-point-math-broken?s=1|1002.5412\" title=\"is floating point math broken\">stackoverflow.com/questions/588004/&hellip;</a>"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1521753077, "post_id": 49404519, "comment_id": 85879033, "body": "Wow! The real example is not even close to the previous Version."}, {"owner": {"reputation": 49, "user_id": 9217066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbb42589841878b30193e339619b5bad?s=128&d=identicon&r=PG&f=1", "display_name": "Mohamed Azzam", "link": "https://stackoverflow.com/users/9217066/mohamed-azzam"}, "reply_to_user": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1521808658, "post_id": 49404519, "comment_id": 85901618, "body": "@Gerhardh sorry for the confusion, i tried to trim out as much code as possible, because the code is 2000 lines and i took another example with the same issue"}], "answers": [{"comments": [{"owner": {"reputation": 49, "user_id": 9217066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbb42589841878b30193e339619b5bad?s=128&d=identicon&r=PG&f=1", "display_name": "Mohamed Azzam", "link": "https://stackoverflow.com/users/9217066/mohamed-azzam"}, "edited": false, "score": 0, "creation_date": 1521636570, "post_id": 49406229, "comment_id": 85814556, "body": "that&#39;s not the case, i do want to to have it like that. What i want to know is, does it make a difference if i compare a double or an int? are there different procedures i need to take care of?"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 49, "user_id": 9217066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbb42589841878b30193e339619b5bad?s=128&d=identicon&r=PG&f=1", "display_name": "Mohamed Azzam", "link": "https://stackoverflow.com/users/9217066/mohamed-azzam"}, "edited": false, "score": 0, "creation_date": 1521636838, "post_id": 49406229, "comment_id": 85814744, "body": "@MohamedAzzam please edit your question and  provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>!!"}], "tags": [], "owner": {"reputation": 384, "user_id": 7193039, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SD1Fs.png?s=128&g=1", "display_name": "Matthias Gr&#252;n", "link": "https://stackoverflow.com/users/7193039/matthias-gr%c3%bcn"}, "is_accepted": false, "score": 0, "last_activity_date": 1521634806, "creation_date": 1521634806, "answer_id": 49406229, "question_id": 49404519, "link": "https://stackoverflow.com/questions/49404519/how-to-compare-double-variables-in-the-if-statement/49406229#49406229", "title": "How to compare double variables in the if statement", "body": "<p>You're comparing <strong>x</strong> to two different matrix entries: the first if compares <strong>x</strong> to coeff[0]<strong>[0]</strong>, the second to coeff[0]<strong>[1]</strong>. So if <strong>x</strong> is greater than coeff[0]<strong>[0]</strong> and less than or equal to coeff[0]<strong>[1]</strong> the program will execture the final else branch. You probably want to compare x to the same matrix entry in both if statements. And in that case, the last else branch would be useless, since one of the three cases (less than, equal to or greater than) MUST be true.</p>\n"}, {"comments": [{"owner": {"reputation": 49, "user_id": 9217066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbb42589841878b30193e339619b5bad?s=128&d=identicon&r=PG&f=1", "display_name": "Mohamed Azzam", "link": "https://stackoverflow.com/users/9217066/mohamed-azzam"}, "edited": false, "score": 0, "creation_date": 1521808464, "post_id": 49427783, "comment_id": 85901483, "body": "that was exactly my problem. Thank you so much for your time investement."}, {"owner": {"reputation": 5295, "user_id": 717523, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b436aae08258d0a6b3f515eb03d5f15?s=128&d=identicon&r=PG", "display_name": "sg7", "link": "https://stackoverflow.com/users/717523/sg7"}, "reply_to_user": {"reputation": 49, "user_id": 9217066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbb42589841878b30193e339619b5bad?s=128&d=identicon&r=PG&f=1", "display_name": "Mohamed Azzam", "link": "https://stackoverflow.com/users/9217066/mohamed-azzam"}, "edited": false, "score": 0, "creation_date": 1521811872, "post_id": 49427783, "comment_id": 85903853, "body": "@MohamedAzzam Thanks! I am glad I could help."}], "tags": [], "owner": {"reputation": 5295, "user_id": 717523, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b436aae08258d0a6b3f515eb03d5f15?s=128&d=identicon&r=PG", "display_name": "sg7", "link": "https://stackoverflow.com/users/717523/sg7"}, "is_accepted": true, "score": 0, "last_activity_date": 1521721082, "last_edit_date": 1521721082, "creation_date": 1521718946, "answer_id": 49427783, "question_id": 49404519, "link": "https://stackoverflow.com/questions/49404519/how-to-compare-double-variables-in-the-if-statement/49427783#49427783", "title": "How to compare double variables in the if statement", "body": "<blockquote>\n  <p>How to compare double variables in the <code>if</code> statement?</p>\n</blockquote>\n\n<p>Take under account limited precision of the double representation of floating point numbers!</p>\n\n<p>Your problem is simple and covered in <a href=\"https://stackoverflow.com/questions/588004/is-floating-point-math-broken?rq=1\">Is floating point math broken?</a></p>\n\n<p>Floating point operations are not precise. The representation of the given number may not be precise.</p>\n\n<p>For <code>0.1</code> in the standard binary64 format, the representation can be written exactly as <code>0.1000000000000000055511151231257827021181583404541015625</code></p>\n\n<p>Double precision (double) gives you only <code>52</code> bits of significant, <code>11</code> bits of exponent, and <code>1</code> sign bit. <strong>Floating point numbers in C use IEEE 754 encoding.</strong></p>\n\n<p>See the output of your program and the possible fix where you settle down for the variable being close to <code>0.0</code>: </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\n\n#define PRECISION  1e-6\n\nint main (void) {\n\n    int i_wagen;\n    double dd[20];\n\n    dd[0]=0.;\n    dd[1]=0.;\n\n    double abstand= 15.;\n    double K_spiel=0.015;\n\n    double s_rel_0= K_spiel;\n    int i;\n\n    for(i=1; i&lt;=9; i++)\n    {\n        i_wagen = 2*(i-1)+2;\n\n        dd[i_wagen] = dd[i_wagen-1]-abstand;\n        i_wagen = 2*(i-1)+3;\n\n        dd[i_wagen] = dd[i_wagen-1] - s_rel_0;\n    }\n\n    double s_rel = dd[3-1]-dd[3];\n\n    printf(\" s_rel %.16f K_spiel %.16f  diff  %.16f \\n\" , s_rel, K_spiel, ((fabs(s_rel) - K_spiel)) );\n\n    if((fabs(s_rel) - K_spiel) == 0.0) // THIS WILL NOT WORK!\n    {\n       printf(\"yes\\n\");\n    }\n\n    //  Settle down for being close enough to 0.0     \n    if( fabs( (fabs(s_rel) - K_spiel)) &lt; PRECISION)\n    {      \n       printf(\"yes!!!\\n\");\n    }\n\n    return(0);\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>s_rel 0.0150000000000006 K_spiel 0.0150000000000000  diff  0.0000000000000006                                      \nyes!!!\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "is_accepted": false, "score": 0, "last_activity_date": 1521722749, "last_edit_date": 1521722749, "creation_date": 1521722309, "answer_id": 49428912, "question_id": 49404519, "link": "https://stackoverflow.com/questions/49404519/how-to-compare-double-variables-in-the-if-statement/49428912#49428912", "title": "How to compare double variables in the if statement", "body": "<p>First, <code>dd[i_wagen-1]</code> as used in the statement:</p>\n\n<pre><code>dd[i_wagen]=dd[i_wagen-1]-abstand;\n</code></pre>\n\n<p>is uninitialized.  Code will run, but will have unpredictable results.\nTo initialize, you can use:</p>\n\n<pre><code>double dd[20]={0}; //sufficient\n</code></pre>\n\n<p>or possibly</p>\n\n<pre><code>double dd[20]={0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0}; //explicit, but not necessary\n</code></pre>\n\n<p>Moving to your actual question, it all comes down to this statement:</p>\n\n<pre><code>if((fabs(s_rel) - K_spiel) == 0.)\n</code></pre>\n\n<p>You have initialized <code>K_spiel</code> to 0.015.  And at this point in your execution flow <code>s_rel</code> appears to be close to 0.015.  But it is actually closer to 0.0150000000000006. So the comparison fails.</p>\n\n<p>One trick that is commonly used is to define an epsilon value, and use it to determine if the difference between two floating point values is small enough to satisfy your purpose:</p>\n\n<p>From <em><a href=\"https://books.google.ca/books?ei=KRkLSYLZEJ7ktQOX3-ChBQ&amp;id=T89QAAAAMAAJ&amp;dq=%22essentially+equal%22+%22approximately+equal%22+knuth&amp;q=%22essentially+equal%22+%22approximately+equal%22+%22definitely+less+than%22&amp;pgis=1&amp;hl=en#search\" rel=\"nofollow noreferrer\">The Art of Computer Programming</a></em>, the following snippet uses this approach, and will work for your very specific example:  (caution: <em><a href=\"https://randomascii.wordpress.com/2012/02/25/comparing-floating-point-numbers-2012-edition/\" rel=\"nofollow noreferrer\">Read why this approach will not work for all floating point related comparisons.</a></em>)</p>\n\n<pre><code>bool approximatelyEqual(float a, float b, float epsilon)\n{\n    return fabs(a - b) &lt;= ( (fabs(a) &lt; fabs(b) ? fabs(b) : fabs(a)) * epsilon);\n}\n</code></pre>\n\n<p>So replace the line:</p>\n\n<pre><code>if((fabs(s_rel) - K_spiel) == 0.)\n</code></pre>\n\n<p>with </p>\n\n<pre><code>if(approximatelyEqual(s_rel, K_spiel, 1e-8)\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 9217066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbb42589841878b30193e339619b5bad?s=128&d=identicon&r=PG&f=1", "display_name": "Mohamed Azzam", "link": "https://stackoverflow.com/users/9217066/mohamed-azzam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1706, "favorite_count": 0, "accepted_answer_id": 49427783, "answer_count": 3, "score": 0, "last_activity_date": 1521722749, "creation_date": 1521629906, "last_edit_date": 1521719234, "question_id": 49404519, "link": "https://stackoverflow.com/questions/49404519/how-to-compare-double-variables-in-the-if-statement", "title": "How to compare double variables in the if statement", "body": "<p>As I am trying to compare these doubles, it won't seem to be working correctly</p>\n\n<p>Here it goes: (This is exactly my problem)</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\n\nint main () {\n    int i_wagen;\n    double dd[20];\n    dd[0]=0.;\n    dd[1]=0.;\n    double abstand= 15.;\n    double K_spiel=0.015;\n    double s_rel_0= K_spiel;\n    int i;\n\n    for(i=1; i&lt;=9; i++)\n    {\n        i_wagen=2*(i-1)+2;\n        dd[i_wagen]=dd[i_wagen-1]-abstand;\n        i_wagen=2*(i-1)+3;\n        dd[i_wagen]=dd[i_wagen-1]-s_rel_0;\n    }\n    double s_rel=dd[3-1]-dd[3];\n\n   if((fabs(s_rel) - K_spiel) == 0.)\n   {\n       printf(\"yes\\n\");\n   }\n   return(0);\n}\n</code></pre>\n\n<p>After executing the programm, it wont print the yes.</p>\n"}, {"tags": ["c", "signals", "interrupt"], "comments": [{"owner": {"reputation": 8196, "user_id": 395851, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f7417d04460fbc27bc0ac99204cfce9c?s=128&d=identicon&r=PG", "display_name": "dbrank0", "link": "https://stackoverflow.com/users/395851/dbrank0"}, "edited": false, "score": 1, "creation_date": 1521629661, "post_id": 49404021, "comment_id": 85809742, "body": "Block all signals before fork, then set appropriate masks for both?"}, {"owner": {"reputation": 385, "user_id": 7114946, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-FbfhnUgQmLU/AAAAAAAAAAI/AAAAAAAAARc/EdBSHus7rDU/photo.jpg?sz=128", "display_name": "Daniel Ortega", "link": "https://stackoverflow.com/users/7114946/daniel-ortega"}, "reply_to_user": {"reputation": 8196, "user_id": 395851, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f7417d04460fbc27bc0ac99204cfce9c?s=128&d=identicon&r=PG", "display_name": "dbrank0", "link": "https://stackoverflow.com/users/395851/dbrank0"}, "edited": false, "score": 0, "creation_date": 1521648008, "post_id": 49404021, "comment_id": 85823859, "body": "Yes, I was not aware that blocking signals mean to actually queue them. I thought blocked signals were discarded later on. Thanks."}], "answers": [{"comments": [{"owner": {"reputation": 385, "user_id": 7114946, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-FbfhnUgQmLU/AAAAAAAAAAI/AAAAAAAAARc/EdBSHus7rDU/photo.jpg?sz=128", "display_name": "Daniel Ortega", "link": "https://stackoverflow.com/users/7114946/daniel-ortega"}, "edited": false, "score": 0, "creation_date": 1521631564, "post_id": 49404439, "comment_id": 85811024, "body": "Thanks for your answer.   However, if I block the SIGINT, and one of these signals occurs when the signal is blocked, the process (or processes if it is after fork) will not have any behaviour and they will not know they need to exit.  In this case, I would need to modify the process who is sending the signals to send the same signal several times and I find this a bit &quot;dirty&quot; solution.  Would there be another possibility?"}, {"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "reply_to_user": {"reputation": 385, "user_id": 7114946, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-FbfhnUgQmLU/AAAAAAAAAAI/AAAAAAAAARc/EdBSHus7rDU/photo.jpg?sz=128", "display_name": "Daniel Ortega", "link": "https://stackoverflow.com/users/7114946/daniel-ortega"}, "edited": false, "score": 4, "creation_date": 1521631879, "post_id": 49404439, "comment_id": 85811269, "body": "Any signal received when it&#39;s blocked will be delivered once you unblock them. There&#39;s nothing dirty about this - it&#39;s the sort of the &quot;standard&quot; way."}, {"owner": {"reputation": 385, "user_id": 7114946, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-FbfhnUgQmLU/AAAAAAAAAAI/AAAAAAAAARc/EdBSHus7rDU/photo.jpg?sz=128", "display_name": "Daniel Ortega", "link": "https://stackoverflow.com/users/7114946/daniel-ortega"}, "edited": false, "score": 0, "creation_date": 1521632207, "post_id": 49404439, "comment_id": 85811485, "body": "Thank you. This is the key of my issue. I was not aware that blocked signals are actually queued. I thought they were just blocked and then discarded."}], "tags": [], "owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "is_accepted": true, "score": 9, "last_activity_date": 1521629665, "creation_date": 1521629665, "answer_id": 49404439, "question_id": 49404021, "link": "https://stackoverflow.com/questions/49404021/different-signal-handlers-for-parent-and-child/49404439#49404439", "title": "Different signal handlers for parent and child", "body": "<blockquote>\n  <p>So what happens if a SIGINT is called right after the fork but before the new sign handler is assigned?</p>\n</blockquote>\n\n<p>The signal handler installed in the parent will be called. Child process inherits it.</p>\n\n<blockquote>\n  <p>Can this happen or there is no possibility to be interrupted before the child gets the new signal handler.</p>\n</blockquote>\n\n<p>Cetainly can happen.</p>\n\n<blockquote>\n  <p>If it is possible. How could I queue the signal to the child so it gets time to get the new handler?</p>\n</blockquote>\n\n<p>To ensure, you need to block SIGINT <em>before</em> calling <code>fork()</code> and then reinstall a different for SIGINT\nin the child process and then unblock SGINT.</p>\n\n<pre><code>/* block SIGINT here. */\n\npid = fork();\n\nif (pid == 0) {\n    /* Install a new SIGINT handler here. */\n    /* Unblock SIGINT. */\n    ...\n} else if (pid &gt; 0) {\n   /* The SIGINT handler is already in place. So just unblock SIGINT. */\n   ...\n} else {\n   /* error */\n}\n</code></pre>\n\n<p>Look at <a href=\"http://man7.org/linux/man-pages/man2/sigprocmask.2.html\" rel=\"noreferrer\"><code>sigprocmask()</code></a> and <a href=\"http://man7.org/linux/man-pages/man3/pthread_sigmask.3.html\" rel=\"noreferrer\"><code>pthread_sigmask()</code></a> for blocking and unblocking signals.</p>\n\n<p>You may also find the <a href=\"https://www.gnu.org/software/libc/manual/html_node/Blocking-Signals.html#Blocking-Signals\" rel=\"noreferrer\">GNU documentation on signal blocking</a> useful.</p>\n"}], "owner": {"reputation": 385, "user_id": 7114946, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-FbfhnUgQmLU/AAAAAAAAAAI/AAAAAAAAARc/EdBSHus7rDU/photo.jpg?sz=128", "display_name": "Daniel Ortega", "link": "https://stackoverflow.com/users/7114946/daniel-ortega"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1891, "favorite_count": 3, "accepted_answer_id": 49404439, "answer_count": 1, "score": 8, "last_activity_date": 1521629665, "creation_date": 1521628558, "question_id": 49404021, "link": "https://stackoverflow.com/questions/49404021/different-signal-handlers-for-parent-and-child", "title": "Different signal handlers for parent and child", "body": "<p>I have a program with a signal handler:</p>\n\n<pre><code>signal(SIGINT, signalhandler);\n</code></pre>\n\n<p>Then the program forks and the child needs a different signal handler so:</p>\n\n<pre><code>pid = fork();\n\n/* What happens here? */\n\nif(pid==0)\n{\nsignal(SIGINT, signalhandler_for_child);\n}\n</code></pre>\n\n<p>So what happens if a SIGINT is called right after the fork but before the new sign handler is assigned?</p>\n\n<p>Can this happen or there is no possibility to be interrupted before the child gets the new signal handler.</p>\n\n<p>If it is possible. How could I queue the signal to the child so it gets time to get the new handler?</p>\n\n<p>I know that the probabilities, if they exist, must be almost 0, but I want to make sure the application is robust in this aspect.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 3, "creation_date": 1521628787, "post_id": 49403759, "comment_id": 85809134, "body": "Nope, not possible. The target process already has its stdin open and potentially used, you cannot hijack it from under its feet."}, {"owner": {"reputation": 811, "user_id": 9493582, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bfI3b.jpg?s=128&g=1", "display_name": "Arndt Jonasson", "link": "https://stackoverflow.com/users/9493582/arndt-jonasson"}, "edited": false, "score": 1, "creation_date": 1521634164, "post_id": 49403759, "comment_id": 85812825, "body": "Linux/Unix suggestion: If you can make <code>gnuplot</code> take its commands from another source than stdin, you can create a named pipe in the file system, and then write commands to it and let <code>gnuplot</code> read from it."}, {"owner": {"reputation": 811, "user_id": 9493582, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bfI3b.jpg?s=128&g=1", "display_name": "Arndt Jonasson", "link": "https://stackoverflow.com/users/9493582/arndt-jonasson"}, "edited": false, "score": 1, "creation_date": 1521636878, "post_id": 49403759, "comment_id": 85814773, "body": "I add another Linux/Unix suggestion, which I have used myself: use a helping program which runs <code>gnuplot</code> as a subprocess, and has full control over what goes to <code>stdin</code> of <code>gnuplot</code>. One program in this style is <code>script</code>, but it only sends on what you type. Another is <code>expect</code> which can do tons of things. I wrote a kind of <code>script</code> program which could send commands from arbitrary sources to my subprocess."}], "owner": {"reputation": 179, "user_id": 8524379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a324306a2482a3424a5f9a92f6beac1?s=128&d=identicon&r=PG&f=1", "display_name": "Guillermo. D. S.", "link": "https://stackoverflow.com/users/8524379/guillermo-d-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 81, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1521627837, "creation_date": 1521627837, "question_id": 49403759, "link": "https://stackoverflow.com/questions/49403759/pipe-to-an-existing-process", "title": "Pipe to an existing process", "body": "<p>Is it possible to open a pipe to an existing process so I could write stuff to its stdin? Say I launch \"gnuplot\" from terminal, how would I get a C-language script to write commands to gnuplot?</p>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 402, "user_id": 8064435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e611728942709d06ae35b352e864ec5?s=128&d=identicon&r=PG&f=1", "display_name": "drilow", "link": "https://stackoverflow.com/users/8064435/drilow"}, "edited": false, "score": 0, "creation_date": 1521628006, "post_id": 49403719, "comment_id": 85808552, "body": "Can you post enough code so that we can test it? For example the ListFirst function and how you allocate those PCBs."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1521628033, "post_id": 49403719, "comment_id": 85808567, "body": "There is not enough code, please <a href=\"https://stackoverflow.com/posts/49403719/edit\">edit</a> your question and show all relevant code."}, {"owner": {"reputation": 80047, "user_id": 169346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/645dbb4f7ba1ff9d7ff2de02f68fbe9c?s=128&d=identicon&r=PG", "display_name": "JeremyP", "link": "https://stackoverflow.com/users/169346/jeremyp"}, "edited": false, "score": 0, "creation_date": 1521628338, "post_id": 49403719, "comment_id": 85808811, "body": "We need to see the code for <code>ListFirst</code>, all related data structures and also the code that prints out the data."}, {"owner": {"reputation": 118, "user_id": 9527820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8be6d096c7331d2c3e737227a98b39a5?s=128&d=identicon&r=PG&f=1", "display_name": "Unks", "link": "https://stackoverflow.com/users/9527820/unks"}, "edited": false, "score": 0, "creation_date": 1521629388, "post_id": 49403719, "comment_id": 85809578, "body": "Okay so I added some more of the code. I also posted all the function headers from my ADT implementation file. That way if you guys need to see one of them you know what I called it and then I can grab it for you guys and post it"}], "answers": [{"tags": [], "owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "is_accepted": false, "score": 0, "last_activity_date": 1521628087, "creation_date": 1521628087, "answer_id": 49403846, "question_id": 49403719, "link": "https://stackoverflow.com/questions/49403719/returning-pointers-properly/49403846#49403846", "title": "Returning pointers properly", "body": "<p>Although I do not see all your declarations, it is most likely that you pass the listhead, the head gets updated, but cannot be returned. The reason it cannot be returned is because you do not pass a \"double pointer\". Consider:</p>\n\n<pre><code>void example(list *head) {\n    if (head==NULL) head= malloc(sizeof(list));\n    //...\n</code></pre>\n\n<p>Here you allocate memory to <code>head</code> but <code>head</code> is a <em>local</em> variable; any changes to it cannot be seen by the caller. Instead, do:</p>\n\n<pre><code>void example(list **head) {\n    if (*head==NULL) *head= malloc(sizeof(list));\n    //...\n</code></pre>\n\n<p>and call like:</p>\n\n<pre><code>list *myList;\nexample(&amp;myList);\n</code></pre>\n"}], "owner": {"reputation": 118, "user_id": 9527820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8be6d096c7331d2c3e737227a98b39a5?s=128&d=identicon&r=PG&f=1", "display_name": "Unks", "link": "https://stackoverflow.com/users/9527820/unks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 93, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1521653194, "creation_date": 1521627722, "last_edit_date": 1521653194, "question_id": 49403719, "link": "https://stackoverflow.com/questions/49403719/returning-pointers-properly", "title": "Returning pointers properly", "body": "<p>I have created an ADT in C. It\u2019s basically a linked list where. Each node in the list has a member variable that stores an item. </p>\n\n<pre><code>void *item\n</code></pre>\n\n<p>I have a member function for adding to the list and removing as well as others. </p>\n\n<p>In my main.c file I call the ListAdd() function that takes a list and adds an item to the next available node. The ListFirst() function goes to the front of the list and returns the item stored at that node. </p>\n\n<pre><code>return list-&gt;item\n</code></pre>\n\n<p>My main function is storing a structure, that I have named pcb, as the item at each node. \nSo here is my question. When I test the ADT the ListFirst() function, just before returning the void *item, has  all the correct member data of the item. But in my main.c file all the information is incorrect. Does anyone know why this could happen? </p>\n\n<p>I thought since the item is a void * I am returning the address to the item. So in my main.c file the code looks like this:</p>\n\n<pre><code>typdef struct PCB{\n        //member variables \n}pcb;\n\npcb *readypcb;\nreadypcb = (pcb *)ListFirst(listHead);\n//print out data\n</code></pre>\n\n<p>So I thought that the readypcb pointer would point to the address of the item ListFirst() returns. Also I cast the return value to <code>(pcb *)</code> cause I return a <code>void *</code>. </p>\n\n<p>So as a summary, the line right before I return the void *item prints out the item member data correctly. Then right after it\u2019s asssigned to readypcb I print out the data again, only this time it\u2019s all incorrect. Does anyone know what\u2019s going on?</p>\n\n<p>Here is some extra code that you guys are asking for:</p>\n\n<p>The header file for my PCB data structure:</p>\n\n<pre><code>typedef enum Priority{\n\n    high,\n    medium,\n    low\n\n}Priority;\n\ntypedef enum State{\n\n    running,\n    ready,\n    blocked\n}State;\n\ntypedef struct PCB{\n\n    Priority priority;              //records the priority level of the PCB\n    int pid;                    //The process id of the control block\n    State state;                    //records the state of the PCB\n\n    char received[200];             //records any messads sent to this PCB\n    char replied[200];              //records the messages that another process replies with\n\n}pcb;\n</code></pre>\n\n<p>Then my main.c file where I assign the returned item:</p>\n\n<pre><code>int checkForReadyProcesses(listPtr highP, listPtr medP, listPtr lowP, pcb *readypcb){\n    int retCode = 0;\n\n    //check that the item counts for the ready queues are 0\n    if(highP-&gt;itemCount &gt; 0){\n         readypcb = (pcb *)ListFirst(highP);\n        //ListRemove(highP);\n\n        if(TESTING_READY_QUEUES){\n            printf(\"We have a PCB in the high priority queue\\n\");\n        }\n\n    }else if(medP-&gt;itemCount &gt; 0){\n        readypcb = (pcb *)ListFirst(medP);\n        //ListRemove(medP);\n\n        if(TESTING_READY_QUEUES){\n            printf(\"We have a PCB in the medium priority queue\\n\");\n        }\n\n    }else if(lowP-&gt;itemCount &gt; 0){\n        readypcb = (pcb *)ListFirst(lowP);\n        //ListRemove(lowP);\n\n        if(TESTING_READY_QUEUES){\n            printf(\"We have a PCB in the low priority queue\\n\");\n        }\n\n    }else{\n        retCode = 1;\n    }\n\n    if(TESTING_READYPCB){\n        printf(\"The ready address is: %p\\n\", readypcb);\n        printf(\"The ready state is: %d\\n\", readypcb-&gt;state);\n        printf(\"The ready priority is: %d\\n\", readypcb-&gt;priority);\n        printf(\"The ready id is: %d\\n\", readypcb-&gt;pid);\n    }\n\n    return retCode;\n\n}\n</code></pre>\n\n<p>Finally LstFirst():</p>\n\n<pre><code>void *ListFirst(LIST *list){\n    void *tempItem;\n\n    list-&gt;currentItem = list-&gt;firstNode-&gt;item;\n    list-&gt;currentNode = list-&gt;firstNode;\n\n    //updates the position\n    list-&gt;position = first;\n\n    tempItem = ((list-&gt;firstNode-&gt;item));\n\n    pcb curpcb = *(pcb *)list-&gt;firstNode-&gt;item;\n\n    printf(\"the item has the adress: %p\\n\", list-&gt;firstNode-&gt;item);\n    printf(\"the item pid is: %d\\n\", curpcb.pid);\n    printf(\"the item state is: %d\\n\", curpcb.state);\n    printf(\"the item priority is: %d\\n\", curpcb.priority);\n\n    return list-&gt;firstNode-&gt;item;\n}\n</code></pre>\n\n<p>The List.h file:</p>\n\n<pre><code>typedef struct NODE *nodePtr;\ntypedef struct List *listPtr;\n\n//define the node structire used for each node in the list except the head node\ntypedef struct NODE{    \n    nodePtr nextNode;       //points to the next node in the list\n    nodePtr previousNode;       //points to the previous node in the list\n    void *item;         //holds the item for the node\n} node;\n\n//define the head structure for the List\ntypedef struct List{\n\n    nodePtr firstNode;      //points to the first node of the list\n    int itemCount;          //holds the number of items in the list\n    nodePtr end;            //points to the end of the list\n    void *currentItem;      //points to the current item\n    nodePtr currentNode;        //points to the current node\n    listPtr freedHeadNode;      //used for pointing to freedHead nodes when more than one is available\n\n    //using an enum to represent where the current node is\n    enum currentPos{\n        beyondEnd = 2,\n        end = 1,\n        middle = 0,\n        beforeStart = -1,\n        first = -2,     //this represents the first item ever to be added\n    } position;\n} LIST;\n\n//FUNCTIONS\nLIST *ListCreate();         //creates a new list when called\nint ListCount(LIST *list);      //returns the number of items in the list\nvoid *ListFirst(LIST *list);        //returns the first item in the list\nvoid *ListLast(LIST *list);     //returns a pointer to the last item\nint ListAdd(LIST *list, void *item);    //adds an item to a list\nvoid *ListCurr(LIST *list);     //points to the current item in the list\nvoid *ListNext(LIST *list);     //points to the next item after the current spot\nvoid *ListPrev(LIST *list);     //points to the previous item before the current node\nint ListInsert(LIST *list, void *item); //inserts a node just before the previous node\nint ListPrepend(LIST *list, void *item);//adds an item to the begining of the list\nint ListAppend(LIST *list, void *item); //adds an item to the end of the list\nvoid *ListRemove(LIST *list);       //removes and returns the current item from the list\nvoid *ListTrim(LIST *list);     //returns and removes the last item of the list\nvoid *ListSearch(LIST *list, int(*comparator)(void *, int), int comparatorArg);\nvoid ListFree(LIST *list, void(itemFree)(void *));\n</code></pre>\n\n<p>I think that should help. Let me know if you need any other information.</p>\n"}, {"tags": ["c", "string", "strcmp"], "comments": [{"owner": {"reputation": 4031, "user_id": 7640269, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/szGUJ.png?s=128&g=1", "display_name": "danglingpointer", "link": "https://stackoverflow.com/users/7640269/danglingpointer"}, "edited": false, "score": 1, "creation_date": 1521626947, "post_id": 49403360, "comment_id": 85807815, "body": "Strings in C are null terminated. When you compare strings means two null terminated strings."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1521627918, "post_id": 49403360, "comment_id": 85808490, "body": "I&#39;m pretty sure it&#39;s a duplicate. Anyone?"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1521628060, "post_id": 49403360, "comment_id": 85808587, "body": "this one? <a href=\"https://stackoverflow.com/questions/28997095/comparing-null-terminated-string-with-a-non-null-terminated-string-in-c\" title=\"comparing null terminated string with a non null terminated string in c\">stackoverflow.com/questions/28997095/&hellip;</a>"}, {"owner": {"reputation": 190, "user_id": 7176709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e179e3c0c654ceffd3b0224a22f7a83?s=128&d=identicon&r=PG&f=1", "display_name": "awakened", "link": "https://stackoverflow.com/users/7176709/awakened"}, "edited": false, "score": 0, "creation_date": 1521628214, "post_id": 49403360, "comment_id": 85808723, "body": "To add to the answers, you have not allocated memory for b."}, {"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 1, "creation_date": 1521632433, "post_id": 49403360, "comment_id": 85811634, "body": "Placing the code into a `main() and feeding to a C compiler cannot reproduce the behaviour."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 1, "creation_date": 1521639711, "post_id": 49403360, "comment_id": 85817032, "body": "Please include a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> which includes the part where you print the value of <code>c</code>. I strongly suspect that you are printing the value of some other (unitialised) variable."}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1534591100, "post_id": 49403360, "comment_id": 90766268, "body": "<a href=\"https://stackoverflow.com/q/370195/995714\">MSVC fills uninitialized memory with 0xCC to help debugging</a>, and -858993460 = 0xCCCCCCCC"}], "answers": [{"tags": [], "owner": {"reputation": 6751, "user_id": 1417063, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Mwy5e.jpg?s=128&g=1", "display_name": "Davide Spataro", "link": "https://stackoverflow.com/users/1417063/davide-spataro"}, "is_accepted": false, "score": 2, "last_activity_date": 1521635789, "last_edit_date": 1521635789, "creation_date": 1521627341, "answer_id": 49403579, "question_id": 49403360, "link": "https://stackoverflow.com/questions/49403360/c-strcmp-compare-strings-declared-by-char-and-char/49403579#49403579", "title": "C strcmp - compare strings declared by char and char*", "body": "<p>It is undefined behaviour because <code>a</code> is not null terminated. All string in C have to be null terminated to be used in <code>strcmp</code>. What <code>strcmp</code> does is looping over the two strings until either one of the two is NULL terminated (see  <a href=\"https://stackoverflow.com/questions/34873209/implementation-of-strcmp/34873406\">Implementation of strcmp</a> to get an idea of how it works).\nYou can see that if <code>'\\0'</code> is not present anywhere you got a problem there.</p>\n\n<p>Read <a href=\"https://stackoverflow.com/questions/2221304/why-do-strings-in-c-need-to-be-null-terminated\">Why do strings in C need to be null terminated?</a> for more info: </p>\n"}], "owner": {"reputation": 21, "user_id": 8731398, "user_type": "registered", "profile_image": "https://graph.facebook.com/920671597980486/picture?type=large", "display_name": "Brian Tsui", "link": "https://stackoverflow.com/users/8731398/brian-tsui"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 229, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1521652939, "creation_date": 1521626765, "last_edit_date": 1521652939, "question_id": 49403360, "link": "https://stackoverflow.com/questions/49403360/c-strcmp-compare-strings-declared-by-char-and-char", "title": "C strcmp - compare strings declared by char and char*", "body": "<p>I am trying to compare 2 strings using the below code:</p>\n\n<pre><code>char a[100] = \"\\0\";\nchar* b[10];\nfor (int i = 0; i &lt; 10; i++)\n    b[i] = \"\";\nb[0] = \"xy\";\na[0] = 'x';\na[1] = 'y';\nint c = strcmp(a, b[0]);\n</code></pre>\n\n<p>I think both <code>a</code> and <code>b[0]</code> contain the string <code>\"xy\"</code>, so I expect <code>int c</code> equal 0. However the result stored in <code>int c</code> is -858993460.\nWhy would that happen? What should I do in order to avoid this fault? Thank you very much.</p>\n\n<p>Update: I found that there is some error on my computer...</p>\n\n<pre><code>char a[3] = { NULL };\nchar d[3] = { NULL };\na[0] = 'x';\na[1] = 'y';\na[2] = '\\0';\n\nd[0] = 'x';\nd[1] = 'y';\nd[2] = '\\0';\nint c = strcmp(a, d);\n</code></pre>\n\n<p>Even using this code, I got <code>int c</code> to be a negative value. I have no idea why that happened.</p>\n"}, {"tags": ["c", "linux", "file", "fopen"], "comments": [{"owner": {"reputation": 12315, "user_id": 658031, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/711e76c263d03660772b5a5198d33671?s=128&d=identicon&r=PG", "display_name": "Saeid Yazdani", "link": "https://stackoverflow.com/users/658031/saeid-yazdani"}, "edited": false, "score": 2, "creation_date": 1521626277, "post_id": 49402992, "comment_id": 85807354, "body": "the problem might be how you try to mount the drive"}, {"owner": {"reputation": 1167, "user_id": 932786, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/49bf3465e918ef75eb511f089b833bb1?s=128&d=identicon&r=PG", "display_name": "Salahuddin", "link": "https://stackoverflow.com/users/932786/salahuddin"}, "reply_to_user": {"reputation": 12315, "user_id": 658031, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/711e76c263d03660772b5a5198d33671?s=128&d=identicon&r=PG", "display_name": "Saeid Yazdani", "link": "https://stackoverflow.com/users/658031/saeid-yazdani"}, "edited": false, "score": 0, "creation_date": 1521626339, "post_id": 49402992, "comment_id": 85807399, "body": "It&#39;s in the posted code: <code>system(&quot;mount &#47;dev&#47;mmcblk0p1 &#47;media&#47;sdcard&#47;&quot;);</code>. Is it not a good way?"}, {"owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "edited": false, "score": 2, "creation_date": 1521627805, "post_id": 49402992, "comment_id": 85808413, "body": "That mounting call looks like a <i>huge</i> race condition, I really don&#39;t think you can assume that once <code>system()</code> returns, the file system has been fully mounted. That&#39;d be my first thing to investigate."}, {"owner": {"reputation": 8196, "user_id": 395851, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f7417d04460fbc27bc0ac99204cfce9c?s=128&d=identicon&r=PG", "display_name": "dbrank0", "link": "https://stackoverflow.com/users/395851/dbrank0"}, "edited": false, "score": 0, "creation_date": 1521628137, "post_id": 49402992, "comment_id": 85808644, "body": "Try mount from sys/mount.h?"}, {"owner": {"reputation": 8196, "user_id": 395851, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f7417d04460fbc27bc0ac99204cfce9c?s=128&d=identicon&r=PG", "display_name": "dbrank0", "link": "https://stackoverflow.com/users/395851/dbrank0"}, "edited": false, "score": 0, "creation_date": 1521628343, "post_id": 49402992, "comment_id": 85808814, "body": "Do you have logs subdirectory on your card?"}, {"owner": {"reputation": 1167, "user_id": 932786, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/49bf3465e918ef75eb511f089b833bb1?s=128&d=identicon&r=PG", "display_name": "Salahuddin", "link": "https://stackoverflow.com/users/932786/salahuddin"}, "edited": false, "score": 0, "creation_date": 1521628382, "post_id": 49402992, "comment_id": 85808844, "body": "yes I do, and I can write into it when I use a normal name as <code>data.txt</code>"}, {"owner": {"reputation": 8196, "user_id": 395851, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f7417d04460fbc27bc0ac99204cfce9c?s=128&d=identicon&r=PG", "display_name": "dbrank0", "link": "https://stackoverflow.com/users/395851/dbrank0"}, "edited": false, "score": 2, "creation_date": 1521628514, "post_id": 49402992, "comment_id": 85808946, "body": "Does your filesystem on SD card allow for : in name? (<a href=\"https://en.wikipedia.org/wiki/Filename#Comparison_of_filename_limitations\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/&hellip;</a>)"}, {"owner": {"reputation": 1167, "user_id": 932786, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/49bf3465e918ef75eb511f089b833bb1?s=128&d=identicon&r=PG", "display_name": "Salahuddin", "link": "https://stackoverflow.com/users/932786/salahuddin"}, "edited": false, "score": 0, "creation_date": 1521628586, "post_id": 49402992, "comment_id": 85808987, "body": "No it doesn&#39;t. I just checked. But it allows for <code>-</code>s. I tried replacing them with dashes and the error changed to <code>Input&#47;output error</code>."}, {"owner": {"reputation": 8196, "user_id": 395851, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f7417d04460fbc27bc0ac99204cfce9c?s=128&d=identicon&r=PG", "display_name": "dbrank0", "link": "https://stackoverflow.com/users/395851/dbrank0"}, "edited": false, "score": 1, "creation_date": 1521628843, "post_id": 49402992, "comment_id": 85809177, "body": "If you have a true FAT (not exfat or similar) length of filename is also limited."}, {"owner": {"reputation": 1167, "user_id": 932786, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/49bf3465e918ef75eb511f089b833bb1?s=128&d=identicon&r=PG", "display_name": "Salahuddin", "link": "https://stackoverflow.com/users/932786/salahuddin"}, "reply_to_user": {"reputation": 12315, "user_id": 658031, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/711e76c263d03660772b5a5198d33671?s=128&d=identicon&r=PG", "display_name": "Saeid Yazdani", "link": "https://stackoverflow.com/users/658031/saeid-yazdani"}, "edited": false, "score": 0, "creation_date": 1521629035, "post_id": 49402992, "comment_id": 85809330, "body": "Thanks for all of your replies. Before posting the question, I tried replacing <code>:</code>s with <code>-</code>s but it didn&#39;t work. Now, I tried it again and it worked. It turned out that what changed is that I mounted the SD card in terminal before running the program. However, when I let the program to mount it itself, it doesn&#39;t work.  You were right @SaeidYazdani"}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1521634420, "post_id": 49402992, "comment_id": 85813006, "body": "In passing - you really ought to check the return value from <code>system()</code>, or you might find yourself writing to the wrong filesystem."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1521640197, "post_id": 49402992, "comment_id": 85817424, "body": "Off-topic, but using <code>chdir()</code> in a function is a really bad practice because it affects the state of the entire program.  Code that expects the current directory to be some value will be wrong (although even that&#39;s a bad practice, too).  Changing the current working directory can break things, and in a multithreaded process it can introduce race conditions.  Robust code will do exactly the same thing no matter what the current working directory happens to be."}], "answers": [{"comments": [{"owner": {"reputation": 1167, "user_id": 932786, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/49bf3465e918ef75eb511f089b833bb1?s=128&d=identicon&r=PG", "display_name": "Salahuddin", "link": "https://stackoverflow.com/users/932786/salahuddin"}, "edited": false, "score": 0, "creation_date": 1521629587, "post_id": 49404097, "comment_id": 85809707, "body": "Thanks for answering my question. But this is not the complete answer. This solves only one problem. The other problem is mounting the SD card in the code as pointed out by  @Saeid Yazdani. Could you please complete your answer?"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 1167, "user_id": 932786, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/49bf3465e918ef75eb511f089b833bb1?s=128&d=identicon&r=PG", "display_name": "Salahuddin", "link": "https://stackoverflow.com/users/932786/salahuddin"}, "edited": false, "score": 1, "creation_date": 1521629980, "post_id": 49404097, "comment_id": 85809929, "body": "@SalahuddinAshraf that&#39;s another unrelated question. I suggest you ask another question addressing this specific issue."}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 1, "creation_date": 1521634315, "post_id": 49404097, "comment_id": 85812923, "body": "<code>EINVAL</code> does seem to be what the FAT filesystem reports for illegal filenames, though <code>open(2)</code> doesn&#39;t specifically mention that as one of the possible causes of <code>EINVAL</code> (probably because normal POSIX filesystems don&#39;t prohibit anything).  It seems a reasonable thing to add to that man page, for anybody else experiencing this."}], "tags": [], "owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "is_accepted": true, "score": 4, "last_activity_date": 1521628745, "creation_date": 1521628745, "answer_id": 49404097, "question_id": 49402992, "link": "https://stackoverflow.com/questions/49402992/fopen-returns-inavlid-argument-when-writing-on-sd-card/49404097#49404097", "title": "fopen() returns inavlid argument when writing on SD card?", "body": "<p>The SD card is probably using a FAT/NTFS file system and filenames in a FAT/NTFS file system cannot contain the <code>:</code> character (and a few others).</p>\n\n<p>If you replace the <code>:</code> in the format string by <code>-</code>, then it should work also on the SD card.</p>\n"}], "owner": {"reputation": 1167, "user_id": 932786, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/49bf3465e918ef75eb511f089b833bb1?s=128&d=identicon&r=PG", "display_name": "Salahuddin", "link": "https://stackoverflow.com/users/932786/salahuddin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 290, "favorite_count": 0, "accepted_answer_id": 49404097, "answer_count": 1, "score": 0, "last_activity_date": 1521628745, "creation_date": 1521625803, "last_edit_date": 1521628280, "question_id": 49402992, "link": "https://stackoverflow.com/questions/49402992/fopen-returns-inavlid-argument-when-writing-on-sd-card", "title": "fopen() returns inavlid argument when writing on SD card?", "body": "<p>I'm trying to write a file on SD card if it's inserted into the kit. Otherwise, the file should be written to the current directory of the project. </p>\n\n<p>I can write the file in the project's directory without any problems.\nHowever, when I try to write it on the inserted SD card, it returns <code>Invalide argument</code>!</p>\n\n<pre><code>FILE* open_file(void)\n{\n    char filename[40];\n    struct tm *timenow;\n    time_t now = time(NULL);\n\n    if(card_inserted())\n    {\n        // Write to a file in the SD card\n        if(!card_mounted())\n        {\n            system(\"mount /dev/mmcblk0p1 /media/sdcard/\");\n        }\n\n        // Change directory from the project's dir to the SD card dir\n        chdir(\"/media/sdcard/\");\n    }\n\n    timenow = gmtime(&amp;now);\n\n    strftime(filename, sizeof(filename), \"logs/data_%Y-%m-%d_%H:%M:%S.txt\", timenow);\n\n    // Open a file to save the received data in (appending mode)\n    FILE *f = fopen(filename, \"w\"); \n    if (f == NULL)\n    {\n        perror(\"Error opening file!\\n\");\n        abort();\n    }\n\n    return f;\n}\n</code></pre>\n\n<p>I tried changing the <code>:</code>s into <code>-</code>s in the file name. This caused the error to change to <code>Input/output error</code>.</p>\n\n<p>I also tried not to use <code>chdir()</code>. Instead, to directly do the following:</p>\n\n<pre><code>strftime(filename, sizeof(filename), \"/media/sdcard/logs/data_%Y-%m-%d_%H-%M-%S.txt\", timenow);\n</code></pre>\n\n<p>This didn't solve the problem -> <code>Invalid argument</code>.</p>\n\n<p>I'm sure that the SD card is mounted to <code>/media/sdcard/</code> and I can create a file into it using the terminal without any problem.</p>\n\n<p>What can cause this error and how to solve it?</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>I made sure that the SD card is correctly mounted before running the program. This didn't solve the problem.</p>\n\n<p>Besides, when I try to write the file into SD card with a normal name, and not the current data and time, it works without any problems!!</p>\n\n<p>Following is my updated code:</p>\n\n<pre><code>FILE* open_file(void)\n{\n    struct tm *timenow;\n    time_t now = time(NULL);\n\n    if(card_inserted() &amp;&amp;  write_to_card)\n    {\n        char *filename;\n        filename = \"/media/sdcard/logs/data.txt\";\n\n        FILE *f = fopen(filename, \"w\"); \n        if (f == NULL)\n            pabort(\"Error opening file!\\n\");\n\n        return f;\n    }\n    else\n    {\n        char filename[40];\n        timenow = gmtime(&amp;now);\n        strftime(filename, sizeof(filename), \"logs/data_%Y-%m-%d_%H:%M:%S.txt\", timenow);\n\n        FILE *f = fopen(filename, \"w\"); \n        if (f == NULL)\n            pabort(\"Error opening file!\\n\");\n\n        return f;\n    }\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 12, "creation_date": 1521625291, "post_id": 49402758, "comment_id": 85806646, "body": "First of all, don&#39;t fall into the trap of premature optimization. Secondly, <i>meassure</i>! With an optimized build. And look at the generated code (with optimization) to compare."}, {"owner": {"reputation": 1998, "user_id": 5914654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b97f9c0f12c8ab7f33a1abeef2d68e2?s=128&d=identicon&r=PG&f=1", "display_name": "vincrichaud", "link": "https://stackoverflow.com/users/5914654/vincrichaud"}, "edited": false, "score": 0, "creation_date": 1521625787, "post_id": 49402758, "comment_id": 85806970, "body": "It will depend on your compiler and if you use <code>x</code> later. If you never use <code>x</code> mostly (maybe every) compiler will do the same for both."}, {"owner": {"reputation": 3936, "user_id": 7571171, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zfVoB.png?s=128&g=1", "display_name": "Thomas Flinkow", "link": "https://stackoverflow.com/users/7571171/thomas-flinkow"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1521626089, "post_id": 49402758, "comment_id": 85807212, "body": "I agree with @Someprogrammerdude. Apart from that, if the loop runs forever, why do you care about an advantage of a few cycles at the start?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 3936, "user_id": 7571171, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zfVoB.png?s=128&g=1", "display_name": "Thomas Flinkow", "link": "https://stackoverflow.com/users/7571171/thomas-flinkow"}, "edited": false, "score": 1, "creation_date": 1521626217, "post_id": 49402758, "comment_id": 85807316, "body": "@ThomasFlinkow if the loop body does very little, it can make quite a difference. One instruction less, if no test is made."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 1, "creation_date": 1521626221, "post_id": 49402758, "comment_id": 85807320, "body": "Do you need an endless loop? Then why use a condition? If you need a loop which can be left, then your <code>while(true){...}</code> will contain an <code>if(!x)</code> which your <code>while(x)</code> does not contain. Any potential optimisation benefit of <code>while(true)</code> over <code>while(x)</code> will be lost at that point."}, {"owner": {"reputation": 17, "user_id": 9527612, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "VolCoM", "link": "https://stackoverflow.com/users/9527612/volcom"}, "edited": false, "score": 0, "creation_date": 1521626877, "post_id": 49402758, "comment_id": 85807751, "body": "Yunnosch, you are right. For my application, I need to be able to get outside of the loop. But getting outside of the loop is not a &quot;normal runtime behavior&quot;, it happens only very rarely. That&#39;s why I want it to not interfere with my performance."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1521626954, "post_id": 49402758, "comment_id": 85807823, "body": "That is what I mean. leaving might be rare, but checking whether it is time to leave while be in each loop."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 1, "creation_date": 1521627318, "post_id": 49402758, "comment_id": 85808077, "body": "Go on, tells us, what is in the loop?   I mean, typically, such loops contain system calls which ,as others have said, would make your &#39;optimization&#39; pointless."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1521627357, "post_id": 49402758, "comment_id": 85808105, "body": "1. Compilers are smart nowadays, they take care of this kind of optimization themselves. 2. If your loop contains more than 2 or 3 instructions, the difference will be most likely non mesurable anyway."}, {"owner": {"reputation": 17, "user_id": 9527612, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "VolCoM", "link": "https://stackoverflow.com/users/9527612/volcom"}, "edited": false, "score": 0, "creation_date": 1521627455, "post_id": 49402758, "comment_id": 85808174, "body": "The loop must be optimized and so does not contains any system calls."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1521627507, "post_id": 49402758, "comment_id": 85808214, "body": "Yeah - the compiiler will just put in a jump back to the start in both cases."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1521627621, "post_id": 49402758, "comment_id": 85808292, "body": "OK, by this point, I&#39;m assuming an embedded system and you are continually polling an I/O device?  Probably with interrupts disabled?   Use hand-crafted assembler."}], "answers": [{"comments": [{"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1521626839, "post_id": 49403063, "comment_id": 85807720, "body": "Welcome to StackOverflow and thanks for making an answer. Would you like to show your badge for taking the <a href=\"https://stackoverflow.com/tour\">tour</a>? Most people with the privilege to upvote answers like to see that badge on an answerer account."}], "tags": [], "owner": {"reputation": 143, "user_id": 9038235, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8BsEW.jpg?s=128&g=1", "display_name": "Moritz Rinow", "link": "https://stackoverflow.com/users/9038235/moritz-rinow"}, "is_accepted": false, "score": 1, "last_activity_date": 1521626035, "creation_date": 1521626035, "answer_id": 49403063, "question_id": 49402758, "link": "https://stackoverflow.com/questions/49402758/c-whiletrue-vs-whilecondition-performance/49403063#49403063", "title": "C - while(true) vs while(condition) - performance", "body": "<p>First of all...\nIf you want to make an infinite loop you (always) use:</p>\n\n<pre><code>while(true)\n{\n  ...\n}\n</code></pre>\n\n<p>There would be absolutely no reason why defining a variable before that loop should speed up your \"application\". So there is no reason to use:</p>\n\n<pre><code>bool x = true;\nwhile(x)\n{\n  ...\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1521627084, "post_id": 49403334, "comment_id": 85807922, "body": "If the condition in the <code>while(x)</code> has any meaning (and OP has confirmed that) then each turn of the loop inside <code>while(true)</code> will at some point check the same condition, inverted for determining when to leave the loop. I.e. <code>if(!x)</code>, followed by things I don&#39;t like, e.g. <code>break</code> or <code>goto</code>. Not liking those things for me is another reason for using <code>while(x)</code> but strictly speaking not relevant for OPs question."}], "tags": [], "owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "is_accepted": true, "score": 2, "last_activity_date": 1521626695, "creation_date": 1521626695, "answer_id": 49403334, "question_id": 49402758, "link": "https://stackoverflow.com/questions/49402758/c-whiletrue-vs-whilecondition-performance/49403334#49403334", "title": "C - while(true) vs while(condition) - performance", "body": "<p>If you need a truly endless loop, then why use a condition?<br>\nIf you need a loop which can be left, then your <code>while(true){...}</code> will contain an <code>if(!x)</code> which your <code>while(x)</code> does not contain.<br>\nAny potential optimisation benefit of <code>while(true)</code> over <code>while(x)</code> will be lost at that point.</p>\n"}], "owner": {"reputation": 17, "user_id": 9527612, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "VolCoM", "link": "https://stackoverflow.com/users/9527612/volcom"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 358, "favorite_count": 0, "closed_date": 1521628644, "accepted_answer_id": 49403334, "answer_count": 2, "score": -4, "last_activity_date": 1521627243, "creation_date": 1521625157, "last_edit_date": 1521627243, "question_id": 49402758, "link": "https://stackoverflow.com/questions/49402758/c-whiletrue-vs-whilecondition-performance", "closed_reason": "Needs details or clarity", "title": "C - while(true) vs while(condition) - performance", "body": "<p>I would like to know if there is a difference in performance between : </p>\n\n<pre><code>while(true)\n{\n.....\n}\n</code></pre>\n\n<p>And : </p>\n\n<pre><code>bool x;\nx = true;\nwhile(x)\n{\n.....\n}\n</code></pre>\n\n<p>I need the best performance and a small difference between the two is important to my application.</p>\n\n<p>Info from comment by OP:<br>\nThe <code>while(true)</code> will at some point also be left, that is however rare.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 1, "creation_date": 1521624730, "post_id": 49402562, "comment_id": 85806275, "body": "I&#39;m sure it has been asked before."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1521624753, "post_id": 49402562, "comment_id": 85806290, "body": "Welcome to stackoverflow.com. Please take some time to read <a href=\"http://stackoverflow.com/help\">the help pages</a>, especially the sections named <a href=\"http://stackoverflow.com/help/on-topic\">&quot;What topics can I ask about here?&quot;</a> and <a href=\"http://stackoverflow.com/help/dont-ask\">&quot;What types of questions should I avoid asking?&quot;</a>. Also please <a href=\"http://stackoverflow.com/tour\">take the tour</a> and <a href=\"http://stackoverflow.com/help/how-to-ask\">read about how to ask good questions</a>."}, {"owner": {"reputation": 45516, "user_id": 838807, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/372d495ca83f81cfadb782894ee41b17?s=128&d=identicon&r=PG", "display_name": "musefan", "link": "https://stackoverflow.com/users/838807/musefan"}, "edited": false, "score": 3, "creation_date": 1521624781, "post_id": 49402562, "comment_id": 85806309, "body": "The first pattern in only 2 squares though..."}, {"owner": {"reputation": 45516, "user_id": 838807, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/372d495ca83f81cfadb782894ee41b17?s=128&d=identicon&r=PG", "display_name": "musefan", "link": "https://stackoverflow.com/users/838807/musefan"}, "edited": false, "score": 0, "creation_date": 1521624900, "post_id": 49402562, "comment_id": 85806373, "body": "Also, I believe the formula should be <code>(n * 3) + (n - 1)</code>"}, {"owner": {"reputation": 1778, "user_id": 1110642, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c9330d13cc8dcc109f541b4eed800e8e?s=128&d=identicon&r=PG", "display_name": "arminb", "link": "https://stackoverflow.com/users/1110642/arminb"}, "edited": false, "score": 0, "creation_date": 1521625400, "post_id": 49402562, "comment_id": 85806708, "body": "The guys at <a href=\"https://codegolf.stackexchange.com\">code golf</a> would love that challange!"}, {"owner": {"reputation": 4505, "user_id": 1168733, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5ewxJ.jpg?s=128&g=1", "display_name": "Sigi", "link": "https://stackoverflow.com/users/1168733/sigi"}, "edited": false, "score": 0, "creation_date": 1521629758, "post_id": 49402562, "comment_id": 85809796, "body": "I would have used a totally different approach: allocate an arbitrary size 2D array (eg: char raster[100][100]) in memory and &quot;draw&quot; the boxes in it using 2D coordinates. Then print it in output row-by-row. I don&#39;t know if you are starting to master arrays, thought."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 11021710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ef28e24e897329129b518740b24e4bd?s=128&d=identicon&r=PG&f=1", "display_name": "Zen", "link": "https://stackoverflow.com/users/11021710/zen"}, "is_accepted": false, "score": 0, "last_activity_date": 1549441372, "creation_date": 1549441372, "answer_id": 54549245, "question_id": 49402562, "link": "https://stackoverflow.com/questions/49402562/how-to-print-a-number-of-boxes-inside-eachother-in-c/54549245#54549245", "title": "How to print a number of boxes inside eachother in C", "body": "<pre><code>#include &lt;stdio.h&gt;\n\nint main (void) {\n\n    int boxes = 0;\n    printf(\"How many boxes: \");\n    scanf(\"%d\", &amp;boxes);\n    int size = ((boxes * 3) + (boxes - 1));\n    int i = 1; // Row counter\n    int j = 1; // Column counter\n    int mid_row = boxes * 2;\n\n    // For printing each row\n    while (i &lt;= size) {\n        j = 1;\n        if (i &lt; mid_row) {\n            // For printing each column\n            while (j &lt;= size) {\n\n                // If the current row is odd\n                if ((i % 2) != 0) {\n\n                    // If the current column is odd\n                    if ((j % 2) != 0) {\n                        printf(\"#\");\n                    } else {\n                        // If the current column is even\n                        if ((j &lt; i) || ((size - j) &lt; i)) {\n                            printf(\" \");\n                        } else {\n                            printf(\"#\");\n                        }\n                    }\n                } else {\n                    // If the current row is even\n\n                    // If the current column is odd\n                    if ((j % 2) != 0) {\n                        if ((j &lt; i) || ((size - j) &lt; i)) {\n                            printf(\"#\");\n                        } else {\n                            printf(\" \");\n                        }\n                    } else {\n                        // If the current column is even\n                        printf(\" \");\n                    }\n                }\n                j++;\n            }\n        } else if (i == mid_row) {\n            while (j &lt;= size) {\n                if ((j % 2) != 0) {\n                    printf(\"#\");\n                } else {\n                    printf(\" \");\n                };\n                j++;\n            }\n        } else {\n            // For printing each column\n            while (j &lt;= size) {\n\n                // If the current row is odd\n                if ((i % 2) != 0) {\n\n                    // If the current column is odd\n                    if ((j % 2) != 0) {\n                        printf(\"#\");\n                    } else {\n                        // If the current column is even\n                        if ((j &gt; i) || ((size - j) &gt;= i)) {\n                            printf(\" \");\n                        } else {\n                            printf(\"#\");\n                        }\n                    }\n                } else {\n                    // If the current row is even\n\n                    // If the current column is odd\n                    if ((j % 2) != 0) {\n                        if ((j &gt; i) || ((size - j) &gt;= i)) {\n                            printf(\"#\");\n                        } else {\n                            printf(\" \");\n                        }\n                    } else {\n                        // If the current column is even\n                        printf(\" \");\n                    }\n                }\n                j++;\n            }\n        }\n\n        printf(\"\\n\");\n        i++;\n    }\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "is_accepted": false, "score": 0, "last_activity_date": 1549535519, "last_edit_date": 1549535519, "creation_date": 1549501489, "answer_id": 54564903, "question_id": 49402562, "link": "https://stackoverflow.com/questions/49402562/how-to-print-a-number-of-boxes-inside-eachother-in-c/54564903#54564903", "title": "How to print a number of boxes inside eachother in C", "body": "<p>There are many ways to solve this, but first you have to correctly evalute the length of the printed side of the biggest square.</p>\n\n<pre><code>sideLength = n * 3 + 1;\n</code></pre>\n\n<p>Is wrong, it produces the sequence {4, 7, 10, ...}, while it should be {3, 7, 11, ...}, because the smallest square is 3 chars wide and they grow by 4 chars (a <code>' '</code> and a <code>'#'</code> at both sides) at every step.</p>\n\n<p>Then you can take advantage of the symmetry of the requested shape and split the drawing into smaller parts inside a function</p>\n\n<pre><code>void draw_boxes(int n) {\n    const char *stroke = \"# \";\n\n    if ( n &lt; 1 )\n        return;\n\n    int side = 4 * n - 1;\n\n    for (int row = 0; row &lt; side; ++row) {\n        int col = 0;\n        // Precalculate the boundaries\n        int left = row;\n        int right = side - row;\n        if ( left &gt; right ) {\n            left = right;\n            right = row;\n        }\n        // Left side, alternate '#' with ' '\n        for (; col &lt; left; ++col) {\n            putchar(stroke[col % 2]);\n        }\n        // Horizontal line, all '#' or ' ' \n        char ch = stroke[row % 2];\n        for (; col &lt; right; ++col) {\n            putchar(ch);\n        }\n        // Right side, same as left side\n        for (; col &lt; side; ++col) {\n            putchar(stroke[col % 2]);\n        }\n        putchar('\\n');\n    }\n}\n</code></pre>\n\n<p>Alternatively, it's possible to calculate the correct symbol to be printed at every position, so that the drawing part of the previous function could be written as</p>\n\n<pre><code>for (int row = 0; row &lt; side; ++row) {\n    for (int col = 0; col &lt; side; ++col) {\n        bool is_horizontal = \n            ( row &lt; col  &amp;&amp;  col &lt; side - row) ||\n            ( side - row &lt;= col  &amp;&amp;  col &lt;= row );\n        bool is_space =\n            (row % 2  &amp;&amp;  is_horizontal)  ||\n            (col % 2  &amp;&amp;  !is_horizontal);\n        putchar(stroke[is_space]);\n    }\n    putchar('\\n');\n}\n</code></pre>\n\n<p>The logic could be shrinked even further, implementing a sort of truth table, loosing some readability, though:</p>\n\n<pre><code>void draw_boxes(int n) {        \n    const char truth_table[] = \"# ##### #     # \";\n\n    if ( n &lt; 1 )\n        return;\n\n    int side = 4 * n - 1;\n\n    for (int row = 0, r_row = side - 1; row &lt; side; ++row, --r_row) {\n        for (int col = 0; col &lt; side; ++col) {\n            unsigned index = (row % 2) &lt;&lt; 3  // Is 'row' odd?\n                ^ (row &lt; col) &lt;&lt; 2           // Is in the top right half?\n                ^ (col &gt; r_row) &lt;&lt; 1         // Is in the bottom right half?\n                ^ (col % 2);                 // Is 'col' odd?\n\n            putchar(truth_table[index]);\n        }\n        putchar('\\n');\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 9527602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd3b710bf4b85d273544549045707563?s=128&d=identicon&r=PG&f=1", "display_name": "TimUNSW", "link": "https://stackoverflow.com/users/9527602/timunsw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1302, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1549535519, "creation_date": 1521624660, "last_edit_date": 1521625264, "question_id": 49402562, "link": "https://stackoverflow.com/questions/49402562/how-to-print-a-number-of-boxes-inside-eachother-in-c", "title": "How to print a number of boxes inside eachother in C", "body": "<p>I am currently doing a computer science course and am finding it very hard to complete a challenge question! It is meant to read in a number and then draws that many square boxes inside each other using the character # with Spaces filling the gaps in between = for example:</p>\n\n<p>How many boxes: 3</p>\n\n<pre><code>#######\n#     #\n# ### #\n# # # #\n# ### #\n#     #\n#######\n</code></pre>\n\n<p>How many boxes: 5</p>\n\n<pre><code>###################\n#                 #\n# ############### #\n# #             # #\n# # ########### # #\n# # #         # # #\n# # # ####### # # #\n# # # #     # # # #\n# # # # ### # # # #\n# # # # # # # # # #\n# # # # ### # # # #\n# # # #     # # # #\n# # # ####### # # #\n# # #         # # #\n# # ########### # #\n# #             # #\n# ############### #\n#                 #\n###################\n</code></pre>\n\n<p>If someone could help me out it would be greatly appreciated! This is my code so far:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void){\n    int row, column;\n    int n;\n\n    printf(\"How many boxes: \");\n    scanf(\"%d\", &amp;n);\n\n    int sideLength;\n    sideLength = n * 3 + 1;\n\n    row = 0;\n    while(row &lt; sideLength){\n        column = 0;\n        while(column &lt; sideLength){\n            if(row == 0 || row == sideLength - 1){\n                printf(\"#\"); \n            }\n            else if(column % 2 != 0){\n                printf(\" \");\n            }\n            else if(column % 2 == 0 &amp;&amp; row % 2 == 1){\n                printf(\" \");\n            }\n            else if(column == 0 || column == sideLength - 1 ){\n                printf(\"#\");\n            }\n            else if(column % 2 == 0 &amp;&amp; row % 2 == 0){\n                printf(\"#\");\n            }\n            column++;\n        }\n        printf(\"%d\", column);\n        printf(\"\\n\");\n        row++;  \n    }\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "dll", "visual-studio-2015"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1521624445, "post_id": 49402415, "comment_id": 85806107, "body": "To begin with, <code>#include &lt;iostream&gt;</code> in the header file? How would that work when including your header file in a C project?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1521624565, "post_id": 49402415, "comment_id": 85806175, "body": "Also, <code>extern &quot;C&quot;</code> is specific for C++, you can&#39;t use it when including the header file in a C source file. That&#39;s why you will see <code>#ifdef __cplusplus</code> for conditional compilation of it in other header files."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1521624694, "post_id": 49402415, "comment_id": 85806254, "body": "Finally, in the C project where you use the DLL, you need to declare the function with <code>dllimport</code> instead. Use conditional compilation and macros to help you. Most tutorials should have told you about that."}, {"owner": {"reputation": 53, "user_id": 6319196, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t4PJj.jpg?s=128&g=1", "display_name": "Kiva", "link": "https://stackoverflow.com/users/6319196/kiva"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1521625420, "post_id": 49402415, "comment_id": 85806722, "body": "I haven&#39;t found a complete tutorial from head to tail about using dllimport and macros because example were in the same programming language like C++ .dll used in C++  . I am trying to use dlls, this being my first time I make contact with dlls and disappointed not to find a complete guide. :|"}], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 6319196, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t4PJj.jpg?s=128&g=1", "display_name": "Kiva", "link": "https://stackoverflow.com/users/6319196/kiva"}, "edited": false, "score": 0, "creation_date": 1521630136, "post_id": 49402875, "comment_id": 85810030, "body": "Thank you very much for your time and patience. I&#39;ll try it right away :)"}], "tags": [], "owner": {"reputation": 384, "user_id": 7193039, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SD1Fs.png?s=128&g=1", "display_name": "Matthias Gr&#252;n", "link": "https://stackoverflow.com/users/7193039/matthias-gr%c3%bcn"}, "is_accepted": true, "score": 1, "last_activity_date": 1521628358, "last_edit_date": 1521628358, "creation_date": 1521625479, "answer_id": 49402875, "question_id": 49402415, "link": "https://stackoverflow.com/questions/49402415/how-to-create-a-dll-library-in-c-and-then-use-it-in-c-project-visualstudio/49402875#49402875", "title": "How to create a DLL library in C++ and then use it in C project VisualStudio?", "body": "<p>In your C++ DLL project open the project properties and define a preprocessor symbol:</p>\n\n<p><a href=\"https://i.stack.imgur.com/oL9MN.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/oL9MN.png\" alt=\"Project properties screenshot\"></a></p>\n\n<p>Then in your header file, define another symbol based on whether the preprocessor symbol circled in red is defined or not:</p>\n\n<pre><code>#ifdef CPPDLL_EXPORTS\n#define DLLIMPORT_EXPORT __declspec(dllexport)\n#else\n#define DLLIMPORT_EXPORT __declspec(dllimport)\n#endif\n</code></pre>\n\n<p>Then use that defined symbol in front of your function declaration:</p>\n\n<pre><code>DLLIMPORT_EXPORT void dllDelay(DWORD dwMsec);\n</code></pre>\n\n<p>This has the following effect:</p>\n\n<p>In your DLL project, the symbol (<strong>DLLIMPORT_EXPORT</strong>) is defined. Thus, DLLIMPORT_EXPORT will evaluate to <strong>__declspec(dllexport)</strong>. In your C project, which consumes the DLL, the symbol will not be defined. Ergo, DLLIMPORT_EXPORT evaluates to <strong>__declspec(dllimport)</strong> when the header file is included. Doing this will import the function and you will be able to use it. Failure to do so will result in a Linker error (<em>unresolved external symbol</em>) when trying to call the function.</p>\n\n<p>Hope this helps!</p>\n\n<p>PS: You should move all #includes that aren't needed in your header file to your implementation (CPP) file :-)</p>\n"}], "owner": {"reputation": 53, "user_id": 6319196, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t4PJj.jpg?s=128&g=1", "display_name": "Kiva", "link": "https://stackoverflow.com/users/6319196/kiva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3428, "favorite_count": 1, "accepted_answer_id": 49402875, "answer_count": 1, "score": 2, "last_activity_date": 1539540658, "creation_date": 1521624300, "last_edit_date": 1539540658, "question_id": 49402415, "link": "https://stackoverflow.com/questions/49402415/how-to-create-a-dll-library-in-c-and-then-use-it-in-c-project-visualstudio", "title": "How to create a DLL library in C++ and then use it in C project VisualStudio?", "body": "<p><strong>How to create a DLL library in C++ and then use it in C project VisualStudio(2015) ?</strong> </p>\n\n<p>I've seen only 1 <a href=\"https://stackoverflow.com/questions/740263/c-dll-in-c-program\">question</a> similar to my problem ,but I couldn't understand too much from it.</p>\n\n<p>I've seen lots of tutorials on how to use .dll written in C++ into another C++ project, a C .dll used in C#, but no example of how to use a C++ .dll into a C VS project.\nI really need help, I've searched all over the internet, tried all kind of 'solutions' to my problem, still, without any solution.</p>\n\n<p>I really need your help on this one.</p>\n\n<p><strong>The C++ dll Project has the following content :</strong> </p>\n\n<pre><code>//C++ dll Header Library, having the name \"dllDelay.h\":\n\n#include &lt;iostream&gt;\n#include &lt;stdio.h&gt;\n#include &lt;windows.h&gt;\n\nextern \"C\" __declspec(dllexport) void dllDelay(DWORD dwMsec);\n\n#endif\n</code></pre>\n\n<hr>\n\n<pre><code>//C++ .cpp file named \"dllDelay.cpp\":\n\n#include \"dllDelay.h\"\n#include \"stdafx.h\"\n\nextern \"C\" __declspec(dllexport)\n\nvoid dllDelay(DWORD dwMsec) {\nSleep(dwMsec);  \n}\n</code></pre>\n\n<hr>\n\n<p><strong>The C VisualStudio(2015) Project has the following content :</strong> </p>\n\n<pre><code>/*This function is intended to Delay 10 seconds, measure that elapsed time\nand write it into a file. I've checked this function using Sleep() instead of\ndllDelay() and it worked fine, so this function has no errors.*/\n\n#include \"dllDelay.h\"\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;time.h&gt;\n#include &lt;windows.h&gt;\n\n\nint main(void)\n{\n FILE *write1;\n // measure elapsed time on windows with QueryPerformanceCounter() : \n LARGE_INTEGER frequency;        // ticks per second\n LARGE_INTEGER t1, t2;           // ticks\n double elapsedTime;\n write1 = fopen(\"write_difftime_1Test.txt\", \"w\");\n fprintf(write1, \"\\n Sleep : 10000ms = 10s\");\n\n time_t start, stop;\n clock_t ticks;\n long count;\n double i = 0, v = 0, j = 0;\n\n  //make 10 such measurements and write them into file\n while ((j &lt; 10) &amp;&amp; ((write1 != NULL) &amp;&amp; (TRUE != fseek(write1, 0L, SEEK_END))))\n {\n    QueryPerformanceFrequency(&amp;frequency);\n    QueryPerformanceCounter(&amp;t1);\n    time(&amp;start);\n\n    //The function from dll\n    dllDelay(10000);        \n\n    time(&amp;stop);\n    QueryPerformanceCounter(&amp;t2);\n\n    // compute and print the elapsed time in millisec\n    elapsedTime = (t2.QuadPart - t1.QuadPart) * 1000.0 / frequency.QuadPart;\n    fprintf(write1, \"\\n Elapsed time : %lf s.  timeDiff time: %f in seconds\\n\\n\", elapsedTime / 1000, difftime(stop, start));\n\n    j++;        \n}\nfclose(write1);\n\nreturn 0;\n</code></pre>\n\n<p>}\n`</p>\n\n<p>This function is intended to Delay 10 seconds, measure that elapsed time\n    and write it into a file. <strong>I've checked this function using Sleep() instead of\n    dllDelay() and it worked fine, so this function has no errors.</strong></p>\n\n<p><strong>But when I use</strong> <code>#include \"dllDelay.h\"</code>  <strong>I get 3111 Errors</strong> such as : </p>\n\n<ul>\n<li>expected a '{'</li>\n<li><p>identifier *write1 is undefined from <code>FILE *write1;</code></p></li>\n<li><p>identifier clock_t is undefined from <code>clock_t ticks;</code></p></li>\n<li>declaration is incompatible with \"float log10(float_Xx)\" (declared at line 227) - in cmath - a standard file where we have <code>using _CSTD log10; using _CSTD modf; using _CSTD pow;</code></li>\n<li>declaration is incompatible with \"double pow(double_Xx, int _Yx)\" (declared at line 22) - in cmath - a standard file where we have <code>using _CSTD log10; using _CSTD modf; using _CSTD pow;</code></li>\n<li>so in the file cmath - the whole file is signaled as being with errors</li>\n<li>and many other errors of such type - meaning that the 2 languages are mangled somehow.</li>\n</ul>\n\n<p>I built the dll (in a dll project, of course), copied the .dll file into the C Project folder where the exe is found, I added to the solution Explorer the .lib file  and got these errors. </p>\n\n<p>I really neeed your help, I've looked everywhere and did not found a guide or anything regarding the usage of a C++ .dll used in a C project. :|</p>\n\n<p><em>Thank you for your time.</em> </p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 1575, "user_id": 9379617, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1162b38c786fe77dca7987df0ac24851?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/9379617/ben"}, "edited": false, "score": 0, "creation_date": 1521624974, "post_id": 49402341, "comment_id": 85806424, "body": "Questions seeking debugging help (&quot;why isn&#39;t this code working?&quot;) must include the desired behavior, a specific problem or error and the shortest code necessary to reproduce it in the question itself. Questions without a clear problem statement are not useful to other readers. Also please read a tutorial if you are not sure what code does and run a debugger."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 164, "user_id": 1931367, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6c1bc5bc02963e92db1abede6c02fd8?s=128&d=identicon&r=PG", "display_name": "Rajesh", "link": "https://stackoverflow.com/users/1931367/rajesh"}, "edited": false, "score": 0, "creation_date": 1521635268, "post_id": 49402341, "comment_id": 85813623, "body": "@Rajesh: That is not a helpful comment. One who does not understand that the compiler does not match the type of an initializer to the member might make the same mistake for a struct as for a union. Even if they did not, knowing that a struct stores multiple objects while a union stores only one of several does not mean one would know that the compiler does not match the type of the initializer to the member to be initialized."}, {"owner": {"reputation": 13, "user_id": 5743176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18c0c4a237ff73f32632f57f792356f4?s=128&d=identicon&r=PG&f=1", "display_name": "harsh82", "link": "https://stackoverflow.com/users/5743176/harsh82"}, "edited": false, "score": 0, "creation_date": 1521639979, "post_id": 49402341, "comment_id": 85817236, "body": "What I though was that the compiler was intelligent enough to match the data to its respective data type when there were not more than variable of the same type...You know, one of those , &quot;optimization&quot; things."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1521640457, "post_id": 49402341, "comment_id": 85817662, "body": "@harsh82: \u201cOptimization\u201d generally means making things perform better without changing their defined behavior."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 5743176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18c0c4a237ff73f32632f57f792356f4?s=128&d=identicon&r=PG&f=1", "display_name": "harsh82", "link": "https://stackoverflow.com/users/5743176/harsh82"}, "edited": false, "score": 0, "creation_date": 1521639850, "post_id": 49402996, "comment_id": 85817127, "body": "Thank you. It does. I am fairly informed about the concepts of designated intializers. What I don&#39;t understand is how my code leads to 0.000... for the double output in the thrird line of the output."}], "tags": [], "owner": {"reputation": 610, "user_id": 8979940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DmzYf.jpg?s=128&g=1", "display_name": "Omer Dagan", "link": "https://stackoverflow.com/users/8979940/omer-dagan"}, "is_accepted": false, "score": 0, "last_activity_date": 1521640551, "last_edit_date": 1521640551, "creation_date": 1521625851, "answer_id": 49402996, "question_id": 49402341, "link": "https://stackoverflow.com/questions/49402341/the-behaviour-of-unions-in-c/49402996#49402996", "title": "The behaviour of unions in C", "body": "<p>think of a union as an allocated space in the memory (size of which is the largest element in the union) each union defined can be interpeted as either element of the union so you can look at that allocated memory as a different type</p>\n\n<p><a href=\"https://www.tutorialspoint.com/cprogramming/c_unions.htm\" rel=\"nofollow noreferrer\">https://www.tutorialspoint.com/cprogramming/c_unions.htm</a></p>\n\n<p>taken from the link:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nunion Data {\n   int i;\n   float f;\n   char str[20];\n};\n\nint main( ) {\n\n   union Data data;        \n\n   data.i = 10;\n   printf( \"data.i : %d\\n\", data.i);\n\n   data.f = 220.5;\n   printf( \"data.f : %f\\n\", data.f);\n\n   strcpy( data.str, \"C Programming\");\n   printf( \"data.str : %s\\n\", data.str);\n\n   return 0;\n}\n</code></pre>\n\n<p>as you can see it has defined one union but it used three different times as a different type</p>\n\n<hr>\n\n<p>EDIT:\nby C99 when initalizing a <code>union</code> the first element is the one initialized hence the value <code>1.2</code> is casted to <code>1</code> where in the case of the <code>char</code> the casting works as expected</p>\n\n<p>if you reorder the elements in your <code>union</code> you will get:</p>\n\n<pre><code>0 , 0 , 1.000000                                                                                                                                             \n0 , 0 , 97.000000                                                                                                                                            \n858993459 , 51 , 1.200000\n</code></pre>\n\n<p>for further explanation:</p>\n\n<p><a href=\"http://en.cppreference.com/w/c/language/struct_initialization\" rel=\"nofollow noreferrer\">http://en.cppreference.com/w/c/language/struct_initialization</a></p>\n\n<blockquote>\n  <p>When initializing a struct, the first initializer in the list\n  initializes the first declared member (unless a designator is\n  specified) (since C99), and all subsequent initializers without\n  designators (since C99)initialize the struct members declared after\n  the one initialized by the previous expression.</p>\n</blockquote>\n\n<hr>\n\n<p>as mentioned in other comments there is a lot of information on the issue and you should research it further, but i hope this gives you a starting point</p>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 5743176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18c0c4a237ff73f32632f57f792356f4?s=128&d=identicon&r=PG&f=1", "display_name": "harsh82", "link": "https://stackoverflow.com/users/5743176/harsh82"}, "edited": false, "score": 0, "creation_date": 1521639674, "post_id": 49404856, "comment_id": 85817004, "body": "no , i understood the integer and character part when i saw the code but what&#39;s bugging me is the double output."}], "tags": [], "owner": {"reputation": 23612, "user_id": 147407, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/65f858d8a973f4ee8d97517a21a17e7d?s=128&d=identicon&r=PG", "display_name": "Andrejs Cainikovs", "link": "https://stackoverflow.com/users/147407/andrejs-cainikovs"}, "is_accepted": false, "score": 0, "last_activity_date": 1521647540, "last_edit_date": 1521647540, "creation_date": 1521630920, "answer_id": 49404856, "question_id": 49402341, "link": "https://stackoverflow.com/questions/49402341/the-behaviour-of-unions-in-c/49404856#49404856", "title": "The behaviour of unions in C", "body": "<p>As per C99 standard, you can still initialize your union with one-liner using <a href=\"http://gcc.gnu.org/onlinedocs/gcc/Designated-Inits.html\" rel=\"nofollow noreferrer\">designated initializers</a> without losing your data:</p>\n\n<pre><code>union x x[3] = {{.a = 1}, {.b = 'a'}, {.c = 1.2}};\n</code></pre>\n\n<p>This will force compiler to use particular union's member, rather than type of first declared one (which is <code>int</code> in your case).</p>\n\n<p>Output:</p>\n\n<pre><code>1, 1, 0.000000\n97, 97, 0.000000\n858993459, 51, 1.200000\n</code></pre>\n\n<p><a href=\"https://ideone.com/dqQnv6\" rel=\"nofollow noreferrer\">Proof</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 5743176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18c0c4a237ff73f32632f57f792356f4?s=128&d=identicon&r=PG&f=1", "display_name": "harsh82", "link": "https://stackoverflow.com/users/5743176/harsh82"}, "edited": false, "score": 0, "creation_date": 1521639739, "post_id": 49406325, "comment_id": 85817054, "body": "was helpful. I still don&#39;t understand how the floating output&#39;s coming up."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 13, "user_id": 5743176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18c0c4a237ff73f32632f57f792356f4?s=128&d=identicon&r=PG&f=1", "display_name": "harsh82", "link": "https://stackoverflow.com/users/5743176/harsh82"}, "edited": false, "score": 1, "creation_date": 1521640693, "post_id": 49406325, "comment_id": 85817861, "body": "@harsh82: Floating-point values are encoded in a special format. Printing the value of a floating-point member of a union after storing a value to a different member causes the implementation to reinterpret the bits of the latter member as if they encoded a floating-point value. In the encoding, small numbers such as 1 or 97 (for <code>a</code> in ASCII) encode very small floating-point values. They are so small that, when printed with <code>%lf</code>, they appear as zero. (Since <code>double</code> has more bytes than <code>char</code>, this also requires the extra bytes happen to be zero. Otherwise some other value could be printed.)"}], "tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": false, "score": 0, "last_activity_date": 1521635135, "creation_date": 1521635135, "answer_id": 49406325, "question_id": 49402341, "link": "https://stackoverflow.com/questions/49402341/the-behaviour-of-unions-in-c/49406325#49406325", "title": "The behaviour of unions in C", "body": "<p>When you provide an initial value for a union, the compiler assigns it to the first member of the union. So, given:</p>\n\n<pre><code>union x\n{\n    int a;\n    char b;\n    double c;\n};\n</code></pre>\n\n<p>and:</p>\n\n<pre><code>union x x[3] = {{1}, {'a'}, {1.2}};\n</code></pre>\n\n<p>the compiler initializes <code>x[0].a</code> to <code>1</code>, <code>x[1].a</code> to <code>a</code>, and <code>x[2].a</code> to 1.2. The compiler does not use the types of the initial values to match them to union elements. It merely initializes the first member with the value you give it. If there is a difference in types, the compiler converts the value to the type of the first member. (If that is a legal conversion. Otherwise, the compiler should provide a warning or error message.)</p>\n\n<p>To initialize specific members of the union, you can use designated initializers, in which you explicitly name the member of the union you want to initialize:</p>\n\n<pre><code>union x x[3] = { { .a = 1 }, { .b = 'a' }, { .c = 1.2 } };\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 5743176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18c0c4a237ff73f32632f57f792356f4?s=128&d=identicon&r=PG&f=1", "display_name": "harsh82", "link": "https://stackoverflow.com/users/5743176/harsh82"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 70, "favorite_count": 0, "answer_count": 3, "score": -4, "last_activity_date": 1521647540, "creation_date": 1521624075, "last_edit_date": 1521628181, "question_id": 49402341, "link": "https://stackoverflow.com/questions/49402341/the-behaviour-of-unions-in-c", "title": "The behaviour of unions in C", "body": "<p>I am really dumb. Please help me out by explaining the output:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nunion x\n{\n    int a;\n    char b;\n    double c;\n};\n\nint main()\n{\n    union x x[3] = {{1}, {'a'}, {1.2}};\n    int i;\n\n    for(i = 0; i &lt; 3; i++)\n        printf(\"%d , %d , %lf\\n\", x[i].a, x[i].b, x[i].c);\n\n    return 0;\n}\n</code></pre>\n\n<p>Output:</p>\n\n<p><a href=\"https://i.stack.imgur.com/biIxj.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/biIxj.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 15050, "user_id": 8605791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ae3be140b26db13a86d624dba4ef1c8?s=128&d=identicon&r=PG&f=1", "display_name": "llllllllll", "link": "https://stackoverflow.com/users/8605791/llllllllll"}, "edited": false, "score": 0, "creation_date": 1521623797, "post_id": 49402194, "comment_id": 85805666, "body": "You create a thread and immediately terminate the main thread. This is pointless and potentially segfault by invalide <code>args</code> address."}, {"owner": {"reputation": 45685, "user_id": 69809, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yCVF0.jpg?s=128&g=1", "display_name": "Groo", "link": "https://stackoverflow.com/users/69809/groo"}, "edited": false, "score": 0, "creation_date": 1521623798, "post_id": 49402194, "comment_id": 85805667, "body": "The scope of the struct you are passing can be local, as long as its lifetime is longer than the thread&#39;s lifetime. If it&#39;s local to <code>main</code>, then main will see the changes done on a separate thread, although you should use <code>volatile int counter</code>."}, {"owner": {"reputation": 164, "user_id": 1931367, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6c1bc5bc02963e92db1abede6c02fd8?s=128&d=identicon&r=PG", "display_name": "Rajesh", "link": "https://stackoverflow.com/users/1931367/rajesh"}, "edited": false, "score": 0, "creation_date": 1521623871, "post_id": 49402194, "comment_id": 85805720, "body": "What you mean by you can make it as global but have to pass it as struct?  Any way you can use global data inside thread"}, {"owner": {"reputation": 2104, "user_id": 4635537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cad50ed18dff8aaff0ff427ea7b1067d?s=128&d=identicon&r=PG", "display_name": "sameerkn", "link": "https://stackoverflow.com/users/4635537/sameerkn"}, "edited": false, "score": 0, "creation_date": 1521624134, "post_id": 49402194, "comment_id": 85805897, "body": "Since the thread routine expects a pointer so you have correctly passed the address of struct. Inside thread <code>Producer</code> you can update the counter as <code>data-&gt;counter += 1;</code>.  Note*: [1] you need to synchronize the access to shared struct by multiple threads [2] you need to wait inside <code>main</code> for threads to get completed."}, {"owner": {"reputation": 190, "user_id": 7176709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e179e3c0c654ceffd3b0224a22f7a83?s=128&d=identicon&r=PG&f=1", "display_name": "awakened", "link": "https://stackoverflow.com/users/7176709/awakened"}, "edited": false, "score": 0, "creation_date": 1521625328, "post_id": 49402194, "comment_id": 85806669, "body": "1. Why don&#39;t you pass the address of the structure? 2. Why are you not using <code>pthread_join</code>?"}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1521625933, "post_id": 49402194, "comment_id": 85807090, "body": "Off-topic: The cast <code>(struct Args*)</code> is superfluous."}], "answers": [{"comments": [{"owner": {"reputation": 45685, "user_id": 69809, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yCVF0.jpg?s=128&g=1", "display_name": "Groo", "link": "https://stackoverflow.com/users/69809/groo"}, "edited": false, "score": 0, "creation_date": 1521624302, "post_id": 49402396, "comment_id": 85806012, "body": "I don&#39;t see the point in doing this, vs. simply updating an <code>int</code> field."}, {"owner": {"reputation": 5181, "user_id": 5529197, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6af647bacfb3f0b596c73b0e3b0dc4b1?s=128&d=identicon&r=PG&f=1", "display_name": "Afshin", "link": "https://stackoverflow.com/users/5529197/afshin"}, "reply_to_user": {"reputation": 45685, "user_id": 69809, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yCVF0.jpg?s=128&g=1", "display_name": "Groo", "link": "https://stackoverflow.com/users/69809/groo"}, "edited": false, "score": 0, "creation_date": 1521624334, "post_id": 49402396, "comment_id": 85806033, "body": "@Groo yea,there is no point in doing it, but I guess this is what he want to do."}], "tags": [], "owner": {"reputation": 5181, "user_id": 5529197, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6af647bacfb3f0b596c73b0e3b0dc4b1?s=128&d=identicon&r=PG&f=1", "display_name": "Afshin", "link": "https://stackoverflow.com/users/5529197/afshin"}, "is_accepted": false, "score": 0, "last_activity_date": 1521624388, "last_edit_date": 1521624388, "creation_date": 1521624246, "answer_id": 49402396, "question_id": 49402194, "link": "https://stackoverflow.com/questions/49402194/c-passing-a-struct-by-reference/49402396#49402396", "title": "C passing a struct by reference", "body": "<p>If you need to reference a <strong>local</strong> variable from different threads, you can use a code like this:</p>\n\n<pre><code>struct Args{\n    char *name;\n    int *counter_ptr;\n};\n\nvoid *Producer(void* args){\n    struct Args *data = (struct Args*) args;\n    //change counter value here which should be changed in main too\n    *(data-&gt;counter_ptr)++;\n}\n\nint main(){\n    ...\n    ...\n\n    int counter = 0; //will be updated in Producer function\n    struct Args args;\n    args.counter_ptr = &amp;counter;\n    args.name = \"\";\n    pthread_create(&amp;thread_id, NULL, Producer, &amp;args);\n    // You need to join thread here to prevent program termination.\n    return 0;\n}\n</code></pre>\n\n<p>But generally speaking, I don't think there is any reason for this here.</p>\n"}], "owner": {"reputation": 483, "user_id": 2584325, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/3f45529aa8b723b760d2fa75cd4eb05c?s=128&d=identicon&r=PG", "display_name": "hmaxx", "link": "https://stackoverflow.com/users/2584325/hmaxx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 70, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1521624388, "creation_date": 1521623607, "question_id": 49402194, "link": "https://stackoverflow.com/questions/49402194/c-passing-a-struct-by-reference", "title": "C passing a struct by reference", "body": "<pre><code>struct Args{\n    char *name;\n    int counter;\n};\n\nvoid *Producer(void* args){\n    struct Args *data = (struct Args*) args;\n    //change counter value here which should be changed in main too\n}\n\nint main(){\n    ...\n    ...\n\n    int counter = 0; //will be updated in Producer function\n    struct Args args;\n    args.counter = counter;\n    args.name = \"\";\n    pthread_create(&amp;thread_id, NULL, Producer, &amp;args);\n    return 0;\n}\n</code></pre>\n\n<p>I can only pass struct to a thread function and I have a counter that I would like to be updated by each thread...I can make it global but have to pass it as a struct. How do I do achieve this?</p>\n"}, {"tags": ["android", "c", "android-ndk", "kotlin"], "comments": [{"owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "edited": false, "score": 2, "creation_date": 1521623334, "post_id": 49401934, "comment_id": 85805380, "body": "Typically problems like this stem from some kind of stack limit in the environment, but the exception you get doesn&#39;t sound like that. Anyway, no reason to use an automatic variable for this, try heap-allocating it instead using <code>calloc()</code> or move it to file scope."}], "answers": [{"tags": [], "owner": {"reputation": 927, "user_id": 5732539, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/6RUuh.jpg?s=128&g=1", "display_name": "Gre\u015fanu Emanuel - Vasile", "link": "https://stackoverflow.com/users/5732539/gre%c5%9fanu-emanuel-vasile"}, "is_accepted": true, "score": 1, "last_activity_date": 1521624124, "creation_date": 1521624124, "answer_id": 49402360, "question_id": 49401934, "link": "https://stackoverflow.com/questions/49401934/android-ndk-char-array-initializing-more-than-1mb/49402360#49402360", "title": "Android NDK char array initializing more than 1Mb", "body": "<p>Thanks <a href=\"https://stackoverflow.com/users/28169/unwind\">unwind</a>, you saved me. Now it works fine. Here is the correct code:</p>\n\n<pre><code>JNICALL\nJava_project_vasile_emanuel_gresanu_overwrite_1intrnal_1externals_1storage_utils_my_threads_WiperWorkerImpl_executeWiping(\n        JNIEnv *env, jclass clazz, jint fd, jlong bufferSize, jint patterntoWrite = 0) {\n\n    char str[80];\n    sprintf(str, \"FileDescriptor Primit = %d\", fd);\n    ALOG(str, __LINE__);\n\n    if (fd_is_valid(fd)) {\n\n        char *buf = (char*) calloc(bufferSize, sizeof(char));//allocate buffer. Now it doesn't matter how big is the buffer\n        for(int i=0;i&lt;bufferSize;i++)\n        {\n            buf[i] = 0;\n        }\n\n        while (true) {\n            if (0 &lt; write(fd, buf, (size_t) bufferSize)) {// write to file\n                if (0 &gt; fsync(fd)) //write to the raw disk\n                {\n                    ALOG(\"Cred ca am ajuns la capatul de scriere.\", __LINE__);\n                    break;\n                }\n            } else {\n                ALOG(\"Cred ca am ajuns la capatul de scriere.\", __LINE__);\n                break;\n            }\n        }\n        return JNI_TRUE;\n    } else {\n        ALOG(\"Sunt probleme cu file descriptorul primit!\", __LINE__);\n    }\n\n    return JNI_FALSE;\n}\n</code></pre>\n"}], "owner": {"reputation": 927, "user_id": 5732539, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/6RUuh.jpg?s=128&g=1", "display_name": "Gre\u015fanu Emanuel - Vasile", "link": "https://stackoverflow.com/users/5732539/gre%c5%9fanu-emanuel-vasile"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 153, "favorite_count": 0, "accepted_answer_id": 49402360, "answer_count": 1, "score": 0, "last_activity_date": 1521624124, "creation_date": 1521622738, "last_edit_date": 1521623147, "question_id": 49401934, "link": "https://stackoverflow.com/questions/49401934/android-ndk-char-array-initializing-more-than-1mb", "title": "Android NDK char array initializing more than 1Mb", "body": "<p>I have a problem initializing one simple char array. ( With values of 0's ) The size of the char array is higher and/or equal to 2Mb. I already searched the internet and read everything I could find (from <a href=\"https://stackoverflow.com/questions/745152/what-is-the-maximum-size-of-buffers-memcpy-memset-etc-can-handle\">What is the maximum size of buffers memcpy/memset etc. can handle?</a> to ... I don't know) and tried many different processes ( from trying to append values into the char array to trying to ... ). The purpose of this code is to write into a file using C library ( NDK ). The snipper that is being shown below works fine if I try to write values equal or lower then 1Mb. Please help me with suggestions that could replace \"memset\". Here is a sample code:</p>\n\n<p>My c library:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;linux/errno.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;fcntl.h&gt;\n\n\n#define APPNAME \"AppLogger2\"\n\n#define  ALOG(...)  __android_log_print(ANDROID_LOG_INFO,APPNAME,__VA_ARGS__)\n\nint fd_is_valid(int fd) {\n    return fcntl(fd, F_GETFD) != -1 || errno != EBADF;\n}\n\n\nextern \"C\"\nJNIEXPORT jboolean\n\n\nJNICALL\nJava_project_vasile_emanuel_gresanu_overwrite_1intrnal_1externals_1storage_utils_my_threads_WiperWorkerImpl_executeWiping(\n        JNIEnv *env, jclass clazz, jint fd, jlong bufferSize, jint patterntoWrite = 0) {\n\n    char str[80];\n    sprintf(str, \"FileDescriptor Primit = %d\", fd);\n    ALOG(str, __LINE__);\n\n    if (fd_is_valid(fd)) {\n        char buf[bufferSize];//allocate buffer\n        memset(buf, patterntoWrite, (size_t) bufferSize);// init buffer\n\n        while (true) {\n            if (0 &lt; write(fd, buf, (size_t) bufferSize)) {// write to file\n                if (0 &gt; fsync(fd)) //write to the raw disk\n                {\n                    ALOG(\"Cred ca am ajuns la capatul de scriere.\", __LINE__);\n                    break;\n                }\n            } else {\n                ALOG(\"Cred ca am ajuns la capatul de scriere.\", __LINE__);\n                break;\n            }\n        }\n        return JNI_TRUE;\n    } else {\n        ALOG(\"Sunt probleme cu file descriptorul primit!\", __LINE__);\n    }\n\n    return JNI_FALSE;\n}\n</code></pre>\n\n<p>Thre Java code:</p>\n\n<pre><code>class WiperWorkerImpl(val pathToFile: DocumentFile, ...): Runnable{\n\n    companion object {\n\n        const val useCExternalFunctionToOverWriteSpace = true\n\n        // Used to load the 'native-lib' library on application startup.\n        init {\n            System.loadLibrary(\"native-lib\")\n        }\n    }\n\n    /**\n     * A native method that is implemented by the 'native-lib' native library,\n     * which is packaged with this application.\n     */\n    external fun executeWiping(fileDescriptorValue: Int, bytesToWrite:Long, patternToUse:Int): Boolean\n\n\noverride fun run() {\nval pfd: ParcelFileDescriptor = contentResolver.openFileDescriptor(pathToFile.uri, \"w\")\n                        if(checkTheRamSpaceForTheBytestThatAreGoingToBeWritten(bytesPerBlockToWriteLocalThread.get())) {\n                            if (executeWiping(pfd.fd, bytesPerBlockToWriteLocalThread.get(), 0)) {\n                                AppLogger.i(\"WiperWorkerImpl. Finish with success\")\n                            } else {\n                                AppLogger.e(\"WiperWorkerImpl. Finished with error!\")\n                            }\n                        }\n                        closeFileDescriptor(pfd)\n}\n\n}\n</code></pre>\n\n<p>The error:\n<a href=\"https://i.stack.imgur.com/kxGIR.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/kxGIR.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["c", "arrays", "types", "volatile", "chars"], "comments": [{"owner": {"reputation": 45685, "user_id": 69809, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yCVF0.jpg?s=128&g=1", "display_name": "Groo", "link": "https://stackoverflow.com/users/69809/groo"}, "edited": false, "score": 4, "creation_date": 1521621526, "post_id": 49401438, "comment_id": 85804275, "body": "As the compiler is telling you, <code>temps[59]</code> is a single <code>char</code>, <code>TempCelsiusDisplay</code> is an array of <code>volatile char</code>s. So, I am presuming you want to <b>copy</b> the characters in the first array into the second array. Also, keep in mind that <code>temps[59]</code> is the last character in the <code>temps</code> array; you probably don&#39;t want to start copying to that place because it will overflow."}, {"owner": {"reputation": 45685, "user_id": 69809, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yCVF0.jpg?s=128&g=1", "display_name": "Groo", "link": "https://stackoverflow.com/users/69809/groo"}, "edited": false, "score": 1, "creation_date": 1521621661, "post_id": 49401438, "comment_id": 85804374, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/16645583/how-to-copy-a-char-array-in-c\">How to copy a char array in C?</a>"}, {"owner": {"reputation": 45685, "user_id": 69809, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yCVF0.jpg?s=128&g=1", "display_name": "Groo", "link": "https://stackoverflow.com/users/69809/groo"}, "edited": false, "score": 0, "creation_date": 1521622003, "post_id": 49401438, "comment_id": 85804549, "body": "Alternatively, if you want to store multiple character arrays into <code>temps</code>, then you want <code>temps</code> to be an array of character arrays, i.e. <code>char * volatile temps[60]</code> (I also believe the pointer should be volatile in that case, not the data), but it&#39;s hard to recommend exactly how to do the assignment since it&#39;s not specified how you allocate and free the arrays for storing individual temperatures."}], "answers": [{"tags": [], "owner": {"reputation": 384, "user_id": 7193039, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SD1Fs.png?s=128&g=1", "display_name": "Matthias Gr&#252;n", "link": "https://stackoverflow.com/users/7193039/matthias-gr%c3%bcn"}, "is_accepted": false, "score": 2, "last_activity_date": 1521624024, "last_edit_date": 1521624024, "creation_date": 1521622883, "answer_id": 49401974, "question_id": 49401438, "link": "https://stackoverflow.com/questions/49401438/storing-volatile-chars-in-an-array/49401974#49401974", "title": "Storing Volatile Chars in an Array", "body": "<p>Temps is an array of single chars, so temps[59] is of type char. So by saying</p>\n\n<pre><code>temps[59] = TempCelsiusDisplay;\n</code></pre>\n\n<p>you are trying to assign a value of type char[] (char array) to a value of type char (single character), which of course is not possible.</p>\n\n<p>If you want to copy the string in TempCelsiusDisplay into temps you could use strcpy_s:</p>\n\n<pre><code>strcpy_s((char*)temps, sizeof(temps), (const char*)TempCelsiusDisplay);\n</code></pre>\n\n<p>If, on the other hand, you want each of the entries in array temps to be able to hold a temperature string like the one contained in TempCelsiusDisplay, you would need to declare an array of strings (char pointers) like so:</p>\n\n<pre><code>volatile char* temps[60];\n</code></pre>\n\n<p>Then you could copy the string TempCelsiusDisplay into one of the strings in the array:</p>\n\n<pre><code>temps[0] = (char*) malloc(10);    // allocate memory (example: 10 bytes)\nstrcpy_s((char*)temps[0], 10, (const char*)TempCelsiusDisplay);\n// ... use string\nfree((void*) temps[0]);    // free memory\n</code></pre>\n\n<p>Optionally, you could save yourself the trouble of dynamically allocating memory by declaring a multidimensional array, like so:</p>\n\n<pre><code>volatile char temps[60][10];\n</code></pre>\n\n<p>This declares 60 10-character arrays.</p>\n\n<p>Then you can copy the string like before:</p>\n\n<pre><code>strcpy_s((char*)temps[0], sizeof(temps[0]), (const char*)TempCelsiusDisplay);\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7485967, "user_type": "registered", "profile_image": "https://graph.facebook.com/1580257768656612/picture?type=large", "display_name": "Rachel Fallow", "link": "https://stackoverflow.com/users/7485967/rachel-fallow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 417, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1521624024, "creation_date": 1521621142, "last_edit_date": 1521621275, "question_id": 49401438, "link": "https://stackoverflow.com/questions/49401438/storing-volatile-chars-in-an-array", "title": "Storing Volatile Chars in an Array", "body": "<p>Disclaimer: I'm quite new to C and to programming in general so this question may show a lack of basic knowledge.</p>\n\n<p>I'm trying to store a set of temperature readings of type 'volatile char' in an array. The temperature reading and array are declared respectively as follows:</p>\n\n<pre><code>volatile char TempCelsiusDisplay[] = \"+abc.d C\";\nvolatile char temps[60];\n</code></pre>\n\n<p>The rest of the code appears to work fine, until I try to store a temperature value in the array</p>\n\n<pre><code>temps[59] = TempCelsiusDisplay;\n</code></pre>\n\n<p>Which throws up the error:</p>\n\n<pre><code>Error: A value of type \"volatile char *\" cannot be assigned to an entity of \ntype \"char\" in \"main.cpp\", Line: 70, Col: 20\n</code></pre>\n\n<p>Is anybody able to explain why this is happening? It seems to me the way I have declared the array is not the correct way to declare a list of volatile chars, however I don't really understand what is happening or how to fix it.</p>\n\n<p>Thanks in Advance :)</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 1, "creation_date": 1521620382, "post_id": 49401199, "comment_id": 85803691, "body": "<code>word</code> is uninitialized at first <code>strcmp</code>"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1521620417, "post_id": 49401199, "comment_id": 85803705, "body": "When do you call <code>rewind(source)</code>, and when do you open the file for <code>source</code>?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1521620470, "post_id": 49401199, "comment_id": 85803743, "body": "Also remember that <code>char</code> strings in C are really called <b><i>null-terminated</b> byte strings</i>. That <i>null-terminated</i> bit is important, and means that a string of five characters really need the space for <i>six</i> characters. Now go back and look at your variable <code>start</code> and think about this."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1521620653, "post_id": 49401199, "comment_id": 85803836, "body": "<code>fscanf(source, &quot;%x&quot;, address);</code> ==&gt; <code>fscanf(source, &quot;%x&quot;, &amp;address);</code> note the <code>&amp;</code>."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 1, "creation_date": 1521620662, "post_id": 49401199, "comment_id": 85803842, "body": "<code>fscanf(source, &quot;%s&quot;, word);</code> into a 10 char buffer is dangerous... buffer overflow is likely."}], "answers": [{"comments": [{"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1521623231, "post_id": 49401875, "comment_id": 85805325, "body": "Might as well make <code>start[]</code> a <code>const char start[]</code>, so the compiler doesn&#39;t have to make a copy of the string in writeable memory on the stack.  (I know the assembler itself doesn&#39;t <i>have</i> to be efficient, and there are far worse performance issues here, like the whole idea of using <code>fscanf</code> to read one word at a time and copying to another file just to discard characters before <code>START</code> and turn <code>START 0x1234</code> into <code>1234START</code>...)  Also, you could use a <code>do{}while()</code> loop to avoid a pointless compare before reading the first word, so you can drop the initializer for it."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1521624980, "post_id": 49401875, "comment_id": 85806427, "body": "@PeterCordes Good suggestions. I have added them to the answer. Thanks."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1521627753, "post_id": 49401875, "comment_id": 85808376, "body": "<code>do{}while()</code> is under-appreciated, IMO.  If you&#39;re used to thinking in assembly, <a href=\"https://stackoverflow.com/questions/47783926/why-are-loops-always-compiled-like-this\">that&#39;s how asm loops are normally written</a>, so it&#39;s a handy way to let the compiler know that your loop will always run once, even in cases where the compiler can&#39;t prove that on its own (like it often can with a <code>for (i=0 ; i &lt; n; i++)</code>)."}], "tags": [], "owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "is_accepted": true, "score": 1, "last_activity_date": 1521624932, "last_edit_date": 1521624932, "creation_date": 1521622593, "answer_id": 49401875, "question_id": 49401199, "link": "https://stackoverflow.com/questions/49401199/how-to-implement-searching-words-in-a-file-and-then-writing-in-another-file/49401875#49401875", "title": "How to implement searching words in a file and then writing in another file?", "body": "<p>As I and others pointed out in comments, you have several errors.</p>\n\n<p>1) Use of uninitialized variables (word)</p>\n\n<p>2) rewind on file not open</p>\n\n<p>3) Too short arrays for a string (start)</p>\n\n<p>4) Wrong arguments to fscanf (address instead of &amp;address)</p>\n\n<p>Besides that there are other problems like:</p>\n\n<p>1) Risk of buffer overflow in fscanf</p>\n\n<p>2) Missing handling of EOF</p>\n\n<p>3) Missing close of files</p>\n\n<p>After fixing the above, the code could look like:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n#include&lt;string.h&gt;\n\nint main(int argc, char *argv[])\n{\n    FILE *source;\n    FILE *intermediate;\n    char word[10];\n    unsigned int address = 0;\n    const char start[] = \"START\";\n\n    source = fopen(argv[1],\"r\");       // Missing check of argc and successful file open\n    intermediate = fopen(argv[2],\"w\"); // Missing check of argc and successful file open\n\n    do\n    {\n      if (fscanf(source, \"%9s\", word) != 1)\n      {\n        printf(\"Illegal source file. START not found\\n\");\n        fclose(source);\n        fclose(intermediate);\n        exit(1);\n      }\n    } while(strcmp(word, start) != 0);\n\n    fscanf(source, \"%x\", &amp;address);  // Missing check of return value being 1\n\n    fprintf(intermediate, \"%x\", address);\n    fprintf(intermediate, \"%s\", word);\n\n    fclose(source);\n    fclose(intermediate);\n\n    return(0);\n}\n</code></pre>\n\n<p>Finally notice that the code still miss important checks like the number of arguments supplied, successful file open and return value from <code>fscan</code> when scanning the address.</p>\n"}], "owner": {"reputation": 165, "user_id": 7757916, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-XCG0krkopU8/AAAAAAAAAAI/AAAAAAAAADE/1teDtVLbDVk/photo.jpg?sz=128", "display_name": "topcat", "link": "https://stackoverflow.com/users/7757916/topcat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 49401875, "answer_count": 1, "score": 0, "last_activity_date": 1521624932, "creation_date": 1521620171, "last_edit_date": 1521623140, "question_id": 49401199, "link": "https://stackoverflow.com/questions/49401199/how-to-implement-searching-words-in-a-file-and-then-writing-in-another-file", "title": "How to implement searching words in a file and then writing in another file?", "body": "<p>Im trying to make SIC assembler in c, made a small test program to search for \"START\" keyword and get the starting address from the assembly code file. then write them in another file as first pass. code didn't work. mind telling whats wrong with it?</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n#include&lt;string.h&gt;\n\nint main(int argc, char *argv[])\n{\n    FILE *source;\n    FILE *intermediate;\n    rewind(source);\n    char word[10];\n    unsigned int address = 0;\n    char start[5] = \"START\";\n    source = fopen(argv[1],\"r\");\n    intermediate = fopen(argv[2],\"r+\");\n    while(strcmp(word,start) != 0)\n    {\n        fscanf(source, \"%s\", word);\n    }\n    fscanf(source, \"%x\", address);\n    fprintf(intermediate, \"%x\", address);\n    fprintf(intermediate, \"%s\", word);\n\n    return(0);\n}\n</code></pre>\n\n<p>this is the assembly input:</p>\n\n<pre><code>  COPY   START  1000\n  FIRST  STL    RETADR\n  CLOOP  JSUB   RDREC\n         LDA    LENGTH\n         COMP   ZERO\n         JEQ    ENDFIL\n         JSUB   WRREC\n         J      CLOOP\n  ENDFIL LDA    EOF\n         STA    BUFFER\n         LDA    THREE\n         STA    LENGTH\n         JSUB   WRREC\n         LDL    RETADR\n         RSUB\n  EOF    BYTE   C'EOF'\n  THREE  WORD   3\n  ZERO   WORD   0\n  RETADR RESW   1\n  LENGTH RESW   1\n  BUFFER RESB   4096\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 9140, "user_id": 637874, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3e2e7daf0ad564b90a61d1aec8dea175?s=128&d=identicon&r=PG", "display_name": "Geoffrey", "link": "https://stackoverflow.com/users/637874/geoffrey"}, "edited": false, "score": 0, "creation_date": 1521619364, "post_id": 49400945, "comment_id": 85803150, "body": "Use <a href=\"http://c-for-dummies.com/blog/?p=1112\" rel=\"nofollow noreferrer\"><code>getline</code></a>, <code>fgets</code> is not suitable for this."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1521619670, "post_id": 49400945, "comment_id": 85803332, "body": "<code>if(buf[0]) { printf(&quot;%s\\n&quot;, buf); }</code>"}, {"owner": {"reputation": 233, "user_id": 8658491, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e1c86647a34b4c0a2df1e6c282b07fd4?s=128&d=identicon&r=PG&f=1", "display_name": "e t", "link": "https://stackoverflow.com/users/8658491/e-t"}, "edited": false, "score": 0, "creation_date": 1521619713, "post_id": 49400945, "comment_id": 85803358, "body": "Thanks, that worked. I just put that before the first if"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1521620004, "post_id": 49400945, "comment_id": 85803509, "body": "You should replace <code>printf(&quot;%s\\n&quot;, buf);</code> instead."}], "answers": [{"comments": [{"owner": {"reputation": 233, "user_id": 8658491, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e1c86647a34b4c0a2df1e6c282b07fd4?s=128&d=identicon&r=PG&f=1", "display_name": "e t", "link": "https://stackoverflow.com/users/8658491/e-t"}, "edited": false, "score": 0, "creation_date": 1521620062, "post_id": 49401108, "comment_id": 85803543, "body": "Would there be a difference if you used buf[0] instead of strlen - 1?"}, {"owner": {"reputation": 2505, "user_id": 3118401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c066b73af214d8e7cf6b52f6ef75314a?s=128&d=identicon&r=PG", "display_name": "marcolz", "link": "https://stackoverflow.com/users/3118401/marcolz"}, "reply_to_user": {"reputation": 233, "user_id": 8658491, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e1c86647a34b4c0a2df1e6c282b07fd4?s=128&d=identicon&r=PG&f=1", "display_name": "e t", "link": "https://stackoverflow.com/users/8658491/e-t"}, "edited": false, "score": 0, "creation_date": 1521620118, "post_id": 49401108, "comment_id": 85803567, "body": "@et In the case of the lines that are more than an newline, yes."}], "tags": [], "owner": {"reputation": 2505, "user_id": 3118401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c066b73af214d8e7cf6b52f6ef75314a?s=128&d=identicon&r=PG", "display_name": "marcolz", "link": "https://stackoverflow.com/users/3118401/marcolz"}, "is_accepted": true, "score": 0, "last_activity_date": 1521619829, "creation_date": 1521619829, "answer_id": 49401108, "question_id": 49400945, "link": "https://stackoverflow.com/questions/49400945/how-do-i-detect-if-theres-a-new-line-then-ignore-it-fgets/49401108#49401108", "title": "How do I detect if there&#39;s a new line then ignore it (fgets)", "body": "<p>If there is a newline in the input, <code>fgets()</code> stops and includes it in the buffer. You don't need to search for it with <code>strchr()</code> as it will always be at <code>strlen() - 1</code> if present. Similarly, an empty line would mean that position <code>0</code> is a <code>\\n</code>, in which case you could skip it: </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main(int argc, char **argv) {\n    FILE *file = fopen(argv[1], \"r\");\n    char buf[100];\n    size_t len;\n\n    while (fgets(buf, sizeof(buf), file)) {\n        if (buf[(len = strlen(buf)) - 1] == '\\n')\n            buf[len - 1] = 0;\n        if (len &gt; 1)\n            printf(\"%s\\n\", buf);\n\n    }\n\n}\n</code></pre>\n"}], "owner": {"reputation": 233, "user_id": 8658491, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e1c86647a34b4c0a2df1e6c282b07fd4?s=128&d=identicon&r=PG&f=1", "display_name": "e t", "link": "https://stackoverflow.com/users/8658491/e-t"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 29, "favorite_count": 0, "accepted_answer_id": 49401108, "answer_count": 1, "score": 0, "last_activity_date": 1521619829, "creation_date": 1521619227, "question_id": 49400945, "link": "https://stackoverflow.com/questions/49400945/how-do-i-detect-if-theres-a-new-line-then-ignore-it-fgets", "title": "How do I detect if there&#39;s a new line then ignore it (fgets)", "body": "<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main(int argc, char **argv) {\n\n    FILE *file = fopen(argv[1], \"r\");\n    char buf[100];\n    char *pos;\n    while (fgets(buf, sizeof(buf), file)) {\n        if ((pos=strchr(buf, '\\n')) != NULL)\n            *pos = '\\0';\n        printf(\"%s\\n\", buf);\n\n    }\n\n}\n</code></pre>\n\n<p>Consider I have a file like below</p>\n\n<pre><code>a\n\nb\n\nc\n</code></pre>\n\n<p>How do I detect if there's a new line and ignore it then continue the while loop. For example,</p>\n\n<pre><code>$ gcc -Wall above.c\n$ ./a.out file\na\nb\nc\n</code></pre>\n\n<p>As you can see it ignored the new lines.</p>\n"}, {"tags": ["c", "primes"], "comments": [{"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 3, "creation_date": 1521619674, "post_id": 49400934, "comment_id": 85803336, "body": "And what is the problem with your current code?"}, {"owner": {"reputation": 1, "user_id": 9494244, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "heskin vader", "link": "https://stackoverflow.com/users/9494244/heskin-vader"}, "reply_to_user": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1521620196, "post_id": 49400934, "comment_id": 85803601, "body": "@klutt it makes perfect sense but for some reason its not producing an output im expecting"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1521621584, "post_id": 49400934, "comment_id": 85804316, "body": "What does <code>check_perfect_power(2147483647)</code> return? What should it return?"}, {"owner": {"reputation": 1, "user_id": 9494244, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "heskin vader", "link": "https://stackoverflow.com/users/9494244/heskin-vader"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1521622378, "post_id": 49400934, "comment_id": 85804789, "body": "@n.m. thats a really big number so its taking some time"}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1521623104, "post_id": 49400934, "comment_id": 85805252, "body": "Update your question so that it is clear."}, {"owner": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 0, "creation_date": 1521625076, "post_id": 49400934, "comment_id": 85806494, "body": "It does: <a href=\"https://ideone.com/ZknbsB\" rel=\"nofollow noreferrer\">ideone.com/ZknbsB</a>"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1521626038, "post_id": 49400934, "comment_id": 85807172, "body": "well if this takes you longer than a couple of minutes you know your method is terribly inefficient."}, {"owner": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1521628462, "post_id": 49400934, "comment_id": 85808905, "body": "@user3386109 No, because the smallest root must have the greater exponent. OP&#39;s code seems <a href=\"https://ideone.com/gpUKhQ\" rel=\"nofollow noreferrer\">almost correct</a> to me. It may be more efficient, of course, and it should consider the limited range of <code>int</code> though."}, {"owner": {"reputation": 811, "user_id": 9493582, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bfI3b.jpg?s=128&g=1", "display_name": "Arndt Jonasson", "link": "https://stackoverflow.com/users/9493582/arndt-jonasson"}, "edited": false, "score": 0, "creation_date": 1521634493, "post_id": 49400934, "comment_id": 85813060, "body": "I wonder if <code>sizeof(int)</code> does what you think it does."}], "owner": {"reputation": 1, "user_id": 9494244, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "heskin vader", "link": "https://stackoverflow.com/users/9494244/heskin-vader"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1521621350, "creation_date": 1521619202, "last_edit_date": 1521621350, "question_id": 49400934, "link": "https://stackoverflow.com/questions/49400934/how-to-check-if-an-integer-is-some-root", "title": "How to check if an integer is some root?", "body": "<pre><code>int intpow(int b, int e)\n{\n    int r;\n    if(e==0) return 1;\n    if(e==1) return b;\n    r = intpow(b, e/2);\n    return r*r*((e&amp;1)?b:1);\n}\n\nint check_perfect_power(int n)\n{\n    int p, i;\n    for(p=sizeof(int)*8;p&gt;2;p--)\n    {\n        for(i=2;intpow(i,p) &lt;= n;i++)\n        {\n            if(intpow(i,p)==n) return i;\n        }\n    }\n    return -1;\n}\n</code></pre>\n\n<p>I want to check if an integer greater than 0 is a square, cube, etc....</p>\n\n<p>and return the lowest root.</p>\n\n<p>For example:</p>\n\n<p><code>64 = 2^6 = 4^3 = 8^2</code></p>\n\n<p><code>check_perfect_power(64)</code> should return 2 (from 2^6).</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1521618120, "post_id": 49400668, "comment_id": 85802516, "body": "Because <code>fgets</code> retains the newline (if any). Please see <a href=\"https://stackoverflow.com/questions/2693776/removing-trailing-newline-character-from-fgets-input/28462221#28462221\">Removing trailing newline character from fgets() input</a>"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1521618131, "post_id": 49400668, "comment_id": 85802522, "body": "A <a href=\"http://en.cppreference.com/w/c/io/fgets\" rel=\"nofollow noreferrer\">good <code>fgets</code> reference</a> should be useful to read. Just about <i>any</i> tutorial or book that uses <code>fgets</code> should have told you about the issue."}], "owner": {"user_type": "does_not_exist", "display_name": "user9314692"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "closed_date": 1521618239, "answer_count": 0, "score": 0, "last_activity_date": 1521618150, "creation_date": 1521618038, "last_edit_date": 1521618150, "question_id": 49400668, "link": "https://stackoverflow.com/questions/49400668/print-statement-printing-on-two-lines-without-new-line-being-specified", "closed_reason": "Duplicate", "title": "Print statement printing on two lines without new line being specified?", "body": "<pre><code>#include &lt;stdio.h&gt;\n\nint main(int argc, char **argv) {\n\n    FILE *file = fopen(argv[1], \"r\");\n    char buf[100];\n    while (fgets(buf, sizeof(buf), file)) {\n        fprintf(stderr, \"%s: unparseable line: '%s', ignored\\n\", argv[0], buf);\n\n    }\n\n\n}\n</code></pre>\n\n<p>I got this random bug in my code. Consider this file</p>\n\n<pre><code>echo 1\necho 2 \necho 3\n</code></pre>\n\n<p>If I were to do</p>\n\n<pre><code>$ gcc -Wall above.c\n$ ./a.out file\n./a.out: unparseable line: 'echo 1\n', ignored\n./a.out: unparseable line: 'echo 2\n', ignored\n./a.out: unparseable line: 'echo 3\n', ignored\n</code></pre>\n\n<p>Why is the \"', ignored\" in it's own line? I want it to be 3 lines only not 6. Anyway to fix?</p>\n"}, {"tags": ["c", "linux", "gcc", "include", "gentoo"], "comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1521619027, "post_id": 49400397, "comment_id": 85802957, "body": "This is non-compliant behavior. If an include with <code>&quot; &quot;</code> fails, the compiler must try again as if you had written <code>&lt; &gt;</code>. So something is terribly wrong with your gcc."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1521645170, "post_id": 49400397, "comment_id": 85821500, "body": "How do you call gcc, from an IDE or through command line? In case of IDE:s, there might be some IDE hiccup where it manually creates an include path with <code>-I</code> and only passes that to gcc. &quot;Vanilla gcc&quot; from command line shouldn&#39;t have these issues."}], "answers": [{"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1521619110, "post_id": 49400805, "comment_id": 85803008, "body": "You are misinterpreting the standard. &quot;or if the search fails&quot; is very clear, the compiler must try again as if you had written <code>&lt; &gt;</code>. This is not unique to C99 either, it has always been like that."}], "tags": [], "owner": {"reputation": 5181, "user_id": 5529197, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6af647bacfb3f0b596c73b0e3b0dc4b1?s=128&d=identicon&r=PG&f=1", "display_name": "Afshin", "link": "https://stackoverflow.com/users/5529197/afshin"}, "is_accepted": false, "score": -1, "last_activity_date": 1521618669, "creation_date": 1521618669, "answer_id": 49400805, "question_id": 49400397, "link": "https://stackoverflow.com/questions/49400397/include-build-fails-after-switching-from-to/49400805#49400805", "title": "#include \u2013 build fails after switching from &lt;&gt; to &quot;&quot;", "body": "<p>I checked your git repository and I noticed that you compile code with <code>--std=c99</code>. I think this may cause the problem, Because I found this in <code>C99</code> draft:</p>\n\n<blockquote>\n  <p>The named  source  file  is  searched for in an implementation-defined\n  manner .If this search is not supported, or if the search fails, the\n  directive is reprocessed as if it read</p>\n</blockquote>\n\n<pre><code>#include &lt;header&gt;\n</code></pre>\n\n<p>So it means process is first implementation defined, and <strong>if not supported</strong> it uses <code>#include&lt;&gt;</code> mode. But this means if it defines that <code>#include\"\"</code> searches current directory, it will stop searching like <code>#include&lt;&gt;</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 2936, "user_id": 658651, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/2e2032cf85e31e19a6758b193782d686?s=128&d=identicon&r=PG", "display_name": "svoop", "link": "https://stackoverflow.com/users/658651/svoop"}, "is_accepted": false, "score": 0, "last_activity_date": 1521662328, "creation_date": 1521662328, "answer_id": 49415511, "question_id": 49400397, "link": "https://stackoverflow.com/questions/49400397/include-build-fails-after-switching-from-to/49415511#49415511", "title": "#include \u2013 build fails after switching from &lt;&gt; to &quot;&quot;", "body": "<p>Re-installing \"gumbo\" on the Gentoo box has fixed the problem. Apparently, a local installation mess has produced this weird behaviour.</p>\n"}], "owner": {"reputation": 2936, "user_id": 658651, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/2e2032cf85e31e19a6758b193782d686?s=128&d=identicon&r=PG", "display_name": "svoop", "link": "https://stackoverflow.com/users/658651/svoop"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 77, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1521662328, "creation_date": 1521616859, "last_edit_date": 1521617992, "question_id": 49400397, "link": "https://stackoverflow.com/questions/49400397/include-build-fails-after-switching-from-to", "title": "#include \u2013 build fails after switching from &lt;&gt; to &quot;&quot;", "body": "<p>A commit in the C implementation of the Nokogumbo gem is causing the build to fail on Gentoo Linux, however, the modification is minor and shouldn't cause any trouble. Unfortunately, I know next to zilch about C.</p>\n\n<p>Here's the commit:</p>\n\n<p><a href=\"https://github.com/rubys/nokogumbo/commit/8b4446847dea5c614759684ebcae4c580c47f4ad\" rel=\"nofollow noreferrer\">https://github.com/rubys/nokogumbo/commit/8b4446847dea5c614759684ebcae4c580c47f4ad</a></p>\n\n<p>It simply replaces the <code>&lt;&gt;</code> with <code>\"\"</code>:</p>\n\n<pre><code>-#include &lt;gumbo.h&gt;\n-#include &lt;error.h&gt;\n-#include &lt;parser.h&gt;\n+#include \"gumbo.h\"\n+#include \"error.h\"\n+#include \"parser.h\"\n</code></pre>\n\n<p>According to the <a href=\"https://gcc.gnu.org/onlinedocs/cpp/Include-Syntax.html\" rel=\"nofollow noreferrer\">GCC docs</a> this shouldn't cause any trouble since it falls back to the previous behaviour:</p>\n\n<blockquote>\n  <p><code>#include \"file\"</code></p>\n  \n  <p>This variant is used for header files of your own program. It searches for a file named file first in the directory containing the current file, then in the quote directories and then the same directories used for <code>&lt;file&gt;</code>. You can prepend directories to the list of quote directories with the -iquote option.</p>\n</blockquote>\n\n<p>Unfortunately, while it compiles just fine with <code>&lt;&gt;</code>, the build fails with <code>\"\"</code>:</p>\n\n<pre><code>compiling nokogumbo.c\nnokogumbo.c:24:20: fatal error: parser.h: No such file or directory\n#include \"parser.h\"\n</code></pre>\n\n<p>I'm wondering to what degree the way <code>&lt;&gt;</code> and <code>\"\"</code> behaves depends on the toolchain, environment and other settings.</p>\n\n<p>Thanks a lot for your hints!</p>\n"}, {"tags": ["c", "dynamic", "data-structures", "linked-list", "binary-tree"], "comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1521614841, "post_id": 49399547, "comment_id": 85800853, "body": "In your <code>insertIP</code> function, if you hit <code>else</code> you will need to iterate over your list until <code>-&gt;ipNext=NULL</code> and then allocate insert <code>tmp</code> at that address and set the value to <code>ip</code>. Since you will always allocate <code>if (search(username)==1)</code> the allocation of <code>temp</code> should be before the <code>if (head-&gt;ipHead == NULL)</code>. And... There is no need to cast the return of <code>malloc</code>, it is unnecessary. See: <a href=\"http://stackoverflow.com/q/605845/995714\"><b>Do I cast the result of malloc?</b></a>"}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 6898731, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Hc1OdxYTA_o/AAAAAAAAAAI/AAAAAAAAANg/gvgve_4svE0/photo.jpg?sz=128", "display_name": "Akash", "link": "https://stackoverflow.com/users/6898731/akash"}, "is_accepted": false, "score": 0, "last_activity_date": 1521619448, "last_edit_date": 1521619448, "creation_date": 1521616165, "answer_id": 49400231, "question_id": 49399547, "link": "https://stackoverflow.com/questions/49399547/how-to-insert-a-linked-list-at-node-of-binary-search-tree/49400231#49400231", "title": "How to insert a linked list at node of binary search tree?", "body": "<p>When you find that user already exist in the tree, then first you have to store that <code>bstNode</code> which contains the given user. After that you would have to traverse the linked list of that <code>bstNode</code> to append the <code>ip</code> at the last. There is one more problem with you code in case where the linked link is <code>NULL</code>. You would have to assign the new node address to the <code>ipHead</code>. Currently you have creating a temp node and not assigning that to head.</p>\n"}, {"tags": [], "owner": {"reputation": 346, "user_id": 5805327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/640e32c5cc9f8f3619bc5b2a8559b2a9?s=128&d=identicon&r=PG&f=1", "display_name": "mcbr", "link": "https://stackoverflow.com/users/5805327/mcbr"}, "is_accepted": false, "score": 0, "last_activity_date": 1521616227, "creation_date": 1521616227, "answer_id": 49400251, "question_id": 49399547, "link": "https://stackoverflow.com/questions/49399547/how-to-insert-a-linked-list-at-node-of-binary-search-tree/49400251#49400251", "title": "How to insert a linked list at node of binary search tree?", "body": "<p>1st issue: when you create <code>temp</code> you dont assign it to the <code>head-&gt;ipHead</code>.</p>\n\n<p>2nd issue: when <code>ipHead</code> exists you still have te allocate memory for the new list node and have to iterate over the whole list if you want to add it at the end. You can also add it at the begining of the list.</p>\n\n<p>3rd issue: the searching function should return the node in the tree if it found the username. I guess that you dont want to always add new list nodes tho the first tree node. I suggest that you traverse the tree using local variable in function - not recursion.</p>\n"}, {"tags": [], "owner": {"reputation": 9, "user_id": 2462363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f46aaf2a9268162d64a5fae99331e37c?s=128&d=identicon&r=PG", "display_name": "Urovoros Ofis", "link": "https://stackoverflow.com/users/2462363/urovoros-ofis"}, "is_accepted": false, "score": 0, "last_activity_date": 1602071988, "last_edit_date": 1602071988, "creation_date": 1602071588, "answer_id": 64243462, "question_id": 49399547, "link": "https://stackoverflow.com/questions/49399547/how-to-insert-a-linked-list-at-node-of-binary-search-tree/64243462#64243462", "title": "How to insert a linked list at node of binary search tree?", "body": "<p>Recently I coded a binary search tree in which each tree node hosts a linked list (list nodes are singly linked) and I used the following data structure (if someone needs the whole code, let me know).</p>\n<pre><code>// data in each\n// list node\nstruct data_info\n{\n    //body of data\n};\n\ntypedef struct data_info Item;\n\n// list node\ntypedef struct lnode\n{\n    Item data_item;\n    struct lnode * next;\n} Lnode;\n\n// List points to\n// first list node\ntypedef Lnode * List;\n\n// tree node contains\n// linked list\ntypedef struct trnode\n{\n    List list_item;\n    struct trnode * left;   // pointer to right branch\n    struct trnode * right;  // pointer to left branch\n} Trnode;\n\n// tree of linked lists\ntypedef struct tree\n{\n    Trnode * root;          // pointer to root of tree\n    int size;               // number of list nodes in tree\n} Tree;\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 9077890, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh3.googleusercontent.com/-SHwqBBbR44M/AAAAAAAAAAI/AAAAAAAAEAc/3oUZBrQ2mmQ/photo.jpg?sz=128", "display_name": "Anon_Singh", "link": "https://stackoverflow.com/users/9077890/anon-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 951, "favorite_count": 1, "answer_count": 3, "score": 0, "last_activity_date": 1602071988, "creation_date": 1521613341, "last_edit_date": 1521614184, "question_id": 49399547, "link": "https://stackoverflow.com/questions/49399547/how-to-insert-a-linked-list-at-node-of-binary-search-tree", "title": "How to insert a linked list at node of binary search tree?", "body": "<p>I would like to populate a linked list which is in a node of a binary search tree.\nIf the user already exits in the list add the ip to the linked list for that specific user.</p>\n\n<p>This is what I have tried so far:</p>\n\n<p>My Data Structures:</p>\n\n<pre><code>typedef struct ip{\n    int ip;\n    struct ip *ipNext;\n}IP;\n\ntypedef struct bstNode\n{\n    char data[32];\n    struct bstNode* left;\n    struct bstNode* right;\n    IP *ipHead; //Pointer to linked list. \n}bstNode;\n</code></pre>\n\n<p><strong>This is where I am having issues</strong></p>\n\n<p>My insert function to insert the IP address into the list for user:</p>\n\n<pre><code>bstNode insertIP(bstNode *head, char *username, int ip){\n\n if (search(username)==1)\n    {\n        if (head-&gt;ipHead == NULL)\n    {\n        IP *temp; \n        temp = (IP*)malloc(sizeof(IP));\n        temp-&gt;ip = ip;\n        temp-&gt;ipNext = NULL;\n    }else{\n        head-&gt;ipHead-&gt;ip= ip;\n        head-&gt;ipHead-&gt;ipNext=NULL;\n    }\n}\n</code></pre>\n\n<p>Insert Function (This works):</p>\n\n<pre><code>bstNode *insert(bstNode *node, char *word)\n{\n    if(node==NULL){\n        node= malloc(sizeof(bstNode));\n        //IP* ipNode=malloc(sizeof(IP));\n        strcpy(node-&gt;data, word);\n        node-&gt;left=NULL;\n        node-&gt;right=NULL;\n    }\n    else{\n        if(strcmp(word, node-&gt;data)&lt;0)\n            node-&gt;left=insert(node-&gt;left, word);\n        else if(strcmp(word, node-&gt;data)&gt;0)\n            node-&gt;right=insert(node-&gt;right, word);\n    }\n    return node;\n}\n</code></pre>\n\n<p>Search Function (This works):</p>\n\n<pre><code>void search(char* user, bstNode* root)  \n{\n    int res;\n    if( root!= NULL ) {\n        res = strcmp(root, root-&gt;data);\n        if( res &lt; 0)\n            search( user, root-&gt;left);\n        else if( res &gt; 0)\n            search( user, root-&gt;right);\n        else\n            printf(\"User Found\\n\");   \n            return 1;                       \n    }\n    else printf(\"\\nNot in tree\\n\");\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "ibm-mq"], "comments": [{"owner": {"reputation": 8737, "user_id": 7264620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbebce2451f4d9f7abdebb6b2db7b618?s=128&d=identicon&r=PG&f=1", "display_name": "JoshMc", "link": "https://stackoverflow.com/users/7264620/joshmc"}, "edited": false, "score": 0, "creation_date": 1521613131, "post_id": 49399409, "comment_id": 85800065, "body": "What is the Format of the MQMD?"}, {"owner": {"reputation": 750, "user_id": 3651664, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/9f9a701998639eda7df664ca7e1412b4?s=128&d=identicon&r=PG&f=1", "display_name": "HighPredator", "link": "https://stackoverflow.com/users/3651664/highpredator"}, "reply_to_user": {"reputation": 8737, "user_id": 7264620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbebce2451f4d9f7abdebb6b2db7b618?s=128&d=identicon&r=PG&f=1", "display_name": "JoshMc", "link": "https://stackoverflow.com/users/7264620/joshmc"}, "edited": false, "score": 0, "creation_date": 1521613178, "post_id": 49399409, "comment_id": 85800094, "body": "@JoshMc, MQFMT_RF_HEADER_2"}, {"owner": {"reputation": 8737, "user_id": 7264620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbebce2451f4d9f7abdebb6b2db7b618?s=128&d=identicon&r=PG&f=1", "display_name": "JoshMc", "link": "https://stackoverflow.com/users/7264620/joshmc"}, "edited": false, "score": 0, "creation_date": 1521614087, "post_id": 49399409, "comment_id": 85800512, "body": "Have you tried setting CodedCharSetId also to 1208?"}, {"owner": {"reputation": 750, "user_id": 3651664, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/9f9a701998639eda7df664ca7e1412b4?s=128&d=identicon&r=PG&f=1", "display_name": "HighPredator", "link": "https://stackoverflow.com/users/3651664/highpredator"}, "reply_to_user": {"reputation": 8737, "user_id": 7264620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbebce2451f4d9f7abdebb6b2db7b618?s=128&d=identicon&r=PG&f=1", "display_name": "JoshMc", "link": "https://stackoverflow.com/users/7264620/joshmc"}, "edited": false, "score": 0, "creation_date": 1521616631, "post_id": 49399409, "comment_id": 85801727, "body": "@JoshMc, yes I did. Same error."}, {"owner": {"reputation": 750, "user_id": 3651664, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/9f9a701998639eda7df664ca7e1412b4?s=128&d=identicon&r=PG&f=1", "display_name": "HighPredator", "link": "https://stackoverflow.com/users/3651664/highpredator"}, "reply_to_user": {"reputation": 8737, "user_id": 7264620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbebce2451f4d9f7abdebb6b2db7b618?s=128&d=identicon&r=PG&f=1", "display_name": "JoshMc", "link": "https://stackoverflow.com/users/7264620/joshmc"}, "edited": false, "score": 0, "creation_date": 1521620424, "post_id": 49399409, "comment_id": 85803710, "body": "I added contents of descriptor"}, {"owner": {"reputation": 8737, "user_id": 7264620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbebce2451f4d9f7abdebb6b2db7b618?s=128&d=identicon&r=PG&f=1", "display_name": "JoshMc", "link": "https://stackoverflow.com/users/7264620/joshmc"}, "edited": false, "score": 0, "creation_date": 1521655610, "post_id": 49399409, "comment_id": 85828928, "body": "Can you provide minimal sample code that will reproduce the issue?"}, {"owner": {"reputation": 750, "user_id": 3651664, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/9f9a701998639eda7df664ca7e1412b4?s=128&d=identicon&r=PG&f=1", "display_name": "HighPredator", "link": "https://stackoverflow.com/users/3651664/highpredator"}, "reply_to_user": {"reputation": 8737, "user_id": 7264620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbebce2451f4d9f7abdebb6b2db7b618?s=128&d=identicon&r=PG&f=1", "display_name": "JoshMc", "link": "https://stackoverflow.com/users/7264620/joshmc"}, "edited": false, "score": 0, "creation_date": 1521802845, "post_id": 49399409, "comment_id": 85897956, "body": "Added code part"}], "answers": [{"tags": [], "owner": {"reputation": 31, "user_id": 9604668, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUQEN.jpg?s=128&g=1", "display_name": "mrmn", "link": "https://stackoverflow.com/users/9604668/mrmn"}, "is_accepted": false, "score": 2, "last_activity_date": 1523218970, "creation_date": 1523218970, "answer_id": 49722392, "question_id": 49399409, "link": "https://stackoverflow.com/questions/49399409/invalid-mq-header-structure/49722392#49722392", "title": "Invalid MQ header structure", "body": "<p>The short answer to your question is you will need to set the length if you create the RFH2 header in the above fashion. The RFH2 header can vary in length. The default length will be MQRFH_STRUC_LENGTH_FIXED_2.</p>\n\n<p>Regarding why it doesn't display properly I don't have a good understanding of why that might be.</p>\n\n<p>I would recommend some RFH2 code samples for you to review. These samples can be found in your installation directory, for example: C:\\Program Files\\IBM\\WebSphere MQ\\Tools\\c\\Samples\\pubsub\\amqsgr2a.c. The samples in the pubsub directory have build RFH2 header functions. In these examples the length is explicitly set. They take a slightly different approach than you when it comes to obtaining and initializing storage.</p>\n\n<p>There is also the MQSETMP api, that I believe can be used to modify the RFH2 header. This api may also maintain and set the length for you in the RFH2 header. I haven't been able to find examples of its usage.</p>\n\n<p>Hope this helps.</p>\n"}], "owner": {"reputation": 750, "user_id": 3651664, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/9f9a701998639eda7df664ca7e1412b4?s=128&d=identicon&r=PG&f=1", "display_name": "HighPredator", "link": "https://stackoverflow.com/users/3651664/highpredator"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 803, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1523218970, "creation_date": 1521612769, "last_edit_date": 1521796131, "question_id": 49399409, "link": "https://stackoverflow.com/questions/49399409/invalid-mq-header-structure", "title": "Invalid MQ header structure", "body": "<p>I am trying to put a message with an RFH2 header in a queue using MQPUT function. Said function returns completion code 2 and reason 2142 which according to IBM docs means that header structure is not valid. Docs on this <a href=\"https://www.ibm.com/support/knowledgecenter/en/SSFKSJ_9.0.0/com.ibm.mq.tro.doc/q042030_.htm\" rel=\"nofollow noreferrer\">link</a> specify the fields that need to be checked. Header and message descriptor have following contents:</p>\n\n<pre><code>MQMD:\nStrucId          = 'MD  '\nVersion          = 2\nReport           = 0\nMsgType          = 8\nExpiry           = -1\nFeedback         = 0\nEncoding         = 273\nCodedCharSetId   = 1208\nFormat           = 'MQHRF2  '\nPriority         = -1\nPersistence      = 2\nMsgId            = 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\nCorrelId         = 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\nBackoutCount     = 0\nReplyToQ         = ''\nReplyToQMgr      = ''\nUserIdentifier   = ''\nAccountingToken  = 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\nApplIdentityData = ''\nPutApplType      = 0\nPutApplName      = ''\nPutDate          = ''\nPutTime          = ''\nApplOriginData   = ''\nGroupId          = 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\nMsgSeqNumber     = 1\nOffset           = 0\nMsgFlags         = 0\nOriginalLength   = -1\n\nMQRFH2:\nStrucId        = 'RFH '\nVersion        = 2\nStrucLength    = 128\nEncoding       = 273\nCodedCharSetId = 0\nFormat         = 'MQSTR   '\nFlags          = 0\nNameValueCCSID = 1208\n</code></pre>\n\n<p>I fail to understand how come the header is invalid and how do I fix this.\nThanks in advance.</p>\n\n<hr>\n\n<pre><code>int SendMessage(PMQHCONN connectionDescriptorPtr, PMQHOBJ queueDescriptorPtr, const char* payload, const char* message)\n{\n  MQLONG completionResult;\n  MQLONG reason;\n\n  unsigned char* buffer = NULL;\n\n  PMQRFH2 pHeader;\n\n  PMQINT32 pNameValueLength;\n\n  PMQCHAR pNameValueData;\n\n  PMQCHAR pMessage;\n\n  PMQCHAR p;\n\n  MQLONG bufferLength;\n  MQLONG structLength;\n  MQLONG nameValueLength;\n\n  size_t payloadLength = strlen(payload);\n  size_t messageLength = strlen(message);\n  size_t sizeOfLength = sizeof(MQINT32);\n  size_t headerStructLength = MQRFH_STRUC_LENGTH_FIXED_2;\n  size_t padding = CalcPadding(payload);\n  size_t i;\n\n  /* mqmd */\n  MQMD md = {MQMD_DEFAULT};\n\n  MQPMO pmo = {MQPMO_DEFAULT};\n\n  structLength = (MQLONG) (headerStructLength + sizeOfLength + payloadLength + padding);\n\n  /* calc total buffer length */\n  bufferLength = (MQLONG) (headerStructLength + sizeOfLength + payloadLength + padding + messageLength);\n  printf(\"Lengths:\\n\"\n         \"  Header:\\n\"\n         \"     structure    : %zu\\n\"\n         \"     length field : %zu\\n\"\n         \"     payload      : length = %zu, padding = %zu (total: %zu)\\n\"\n         \"  Total : %d\\n\"\n         \"  Message : %zu\\n\"\n         \"Total : %d\\n\",\n         headerStructLength,\n         sizeOfLength,\n         payloadLength, padding, payloadLength + padding,\n         structLength,\n         messageLength,\n         bufferLength\n  );\n\n  buffer = malloc((size_t) bufferLength);\n\n  /* setting up payload */\n  nameValueLength = (MQLONG) payloadLength;\n  pNameValueData = (PMQCHAR) (buffer + MQRFH_STRUC_LENGTH_FIXED_2 + sizeOfLength);\n  memcpy(pNameValueData, payload, (size_t) nameValueLength);\n\n  p = pNameValueData + nameValueLength;\n  for (i = 0; i &lt; padding; i++)\n  {\n    *p = ' ';\n    p++;\n    nameValueLength++;\n  }\n\n  /* setting up valueLength */\n  pNameValueLength = (PMQINT32) (buffer + MQRFH_STRUC_LENGTH_FIXED_2);\n  *pNameValueLength = nameValueLength;\n\n  /* setting up message */\n  pMessage = pNameValueData + nameValueLength;\n  memcpy(pMessage, message, messageLength);\n\n  /* setting up header */\n  pHeader = (PMQRFH2) buffer;\n  memcpy(pHeader, &amp;DefaultHeader, MQRFH_STRUC_LENGTH_FIXED_2);\n  memcpy(pHeader-&gt;Format, MQFMT_STRING, MQ_FORMAT_LENGTH);\n  pHeader-&gt;CodedCharSetId = MQCCSI_INHERIT;\n  pHeader-&gt;NameValueCCSID = 1208;\n  pHeader-&gt;StrucLength = (MQLONG) (headerStructLength + sizeOfLength + nameValueLength); /* !!! */\n\n  /* seeting up for put */\n  memcpy(md.Format, MQFMT_RF_HEADER_2, MQ_FORMAT_LENGTH);\n  md.MsgType = MQMT_DATAGRAM;\n  md.Persistence = MQPER_PERSISTENT;\n\n  pmo.Options = pmo.Options | MQPMO_NEW_MSG_ID | MQPMO_NO_SYNCPOINT;\n\n  MQPUT(*connectionDescriptorPtr, *queueDescriptorPtr, &amp;md, &amp;pmo, bufferLength, buffer, &amp;completionResult, &amp;reason);\n  free(buffer);\n  printf(\"Message put in queue with code %d and reason %d\\n\", completionResult, reason);\n\n  return 0;\n}\n</code></pre>\n\n<p>I use the code above to setup the buffer to be sent.\nThe problem was narrowed down to the following cases:</p>\n\n<p>1) if I DO NOT set the StrucLength field in header (line with !!!), message is being successfully put in queue and carries the correct format and data that can be read in message browser</p>\n\n<p>2) if I DO set the field calculated correctly like in the code, the message is put in queue, but is displayed as MQSTR message type with no MQRFH2 header data</p>\n\n<p>3) if I DO set the field calculated INCORRECTLY, then I get the 2142 reason code, which apparently was the source of the problem in the first place.</p>\n\n<p>Now all of this has led me to a question:\nAm I not supposed to populate the StrucLength field manually if I put messages?</p>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 1, "creation_date": 1521611550, "post_id": 49399073, "comment_id": 85799383, "body": "Cannot reproduce the error. Please include your compiler and show how you use <code>strcopy</code>."}, {"owner": {"reputation": 109956, "user_id": 159145, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/r8ryC.png?s=128&g=1", "display_name": "Dai", "link": "https://stackoverflow.com/users/159145/dai"}, "edited": false, "score": 0, "creation_date": 1521611636, "post_id": 49399073, "comment_id": 85799425, "body": "We need to see the code that calls your <code>strcopy</code> function and what argument value it assigns to the <code>dest</code> parameter."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1521611665, "post_id": 49399073, "comment_id": 85799433, "body": "Yes, I deleted it. The issue will be storage for <code>dest</code>."}, {"owner": {"reputation": 109956, "user_id": 159145, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/r8ryC.png?s=128&g=1", "display_name": "Dai", "link": "https://stackoverflow.com/users/159145/dai"}, "edited": false, "score": 2, "creation_date": 1521611679, "post_id": 49399073, "comment_id": 85799437, "body": "You don&#39;t need to call <code>strlen</code> - you can simply check for <code>*src == &#39;\\0&#39;</code> and stop the loop."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 4, "creation_date": 1521611739, "post_id": 49399073, "comment_id": 85799457, "body": "Please provide <a href=\"http://stackoverflow.com/help/mcve\"><b>A Minimal, Complete, and Verifiable Example (MCVE)</b></a>. I suspect your <code>dest</code> may be an uninitialized pointer in the caller."}, {"owner": {"reputation": 39159, "user_id": 1541563, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/U4EOh.png?s=128&g=1", "display_name": "Patrick Roberts", "link": "https://stackoverflow.com/users/1541563/patrick-roberts"}, "edited": false, "score": 0, "creation_date": 1521611750, "post_id": 49399073, "comment_id": 85799462, "body": "Also, <code>i</code> and <code>srcLength</code> should be <code>size_t</code>, not <code>int</code> for a proper implementation."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1521612101, "post_id": 49399073, "comment_id": 85799632, "body": "Using 0x01 when you mean 1 does not make you a wizard. Rather the reverse."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1521612573, "post_id": 49399073, "comment_id": 85799832, "body": "Note that <code>const char* cPtr = &amp;tmp[0];</code> is just <code>const char* cPtr = tmp;</code>, read your pointers chapter again if you&#39;re confused. Also, according to the standard <code>fflush(stdin)</code> is undefined behavior, some platforms imeplement the behavior for <code>stdin</code> only, but you should not rely on that, <code>fflush()</code> is only for output streams. And <code>s = s+0x01;</code>??? really???  Please also note, that even though you implemented <code>strlen()</code> yourself, you still used it when you could do a loop just like the one you did in <code>strlen()</code> to traverse through the characters of the string."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 1, "creation_date": 1521612620, "post_id": 49399073, "comment_id": 85799851, "body": "And finally, &quot;<i>at this line program breaks</i>&quot; is not a helpful comment, please describe &quot;<i>breaks</i>&quot; precisely."}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1521612823, "post_id": 49399073, "comment_id": 85799941, "body": "Compile with all warnings and debug info (<code>gcc -Wall -Wextra -g</code> with <a href=\"http://gcc.gnu.org/\" rel=\"nofollow noreferrer\">GCC</a>). Improve the code to get no warnings. <a href=\"https://sourceware.org/gdb/current/onlinedocs/gdb/\" rel=\"nofollow noreferrer\">use the debugger, e.g. <code>gdb</code></a>. And avoid naming your own functions like standard ones (so use <code>mystrcpy</code> not <code>strcpy</code>)"}], "answers": [{"comments": [{"owner": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "edited": false, "score": 1, "creation_date": 1521612577, "post_id": 49399257, "comment_id": 85799834, "body": "There&#39;s no need to call <code>strlen</code> when writing <code>strcpy</code>... you are actually making it less efficient (you iterate twice over the source string for no good reason). In general, a common implementation of <code>strcpy</code> has one third of the lines of yours (and a compact one is a three-liner)."}], "tags": [], "owner": {"reputation": 941, "user_id": 9354476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc42e9e097bc5a2fb492c1a5254d49c5?s=128&d=identicon&r=PG&f=1", "display_name": "Syed.Waris", "link": "https://stackoverflow.com/users/9354476/syed-waris"}, "is_accepted": false, "score": -1, "last_activity_date": 1521612140, "creation_date": 1521612140, "answer_id": 49399257, "question_id": 49399073, "link": "https://stackoverflow.com/questions/49399073/cant-assign-const-char-to-char/49399257#49399257", "title": "Can&#39;t assign const char* to char*", "body": "<p>Your program is crashing because you cant modify the pointer to a constant. Please find the corrected code below:</p>\n\n<pre><code>char *\nmstrcpy (char *dest, const char *src)\n{\n  char *retPtr = dest;\n\n  int i = 0;\n  int srcLength = strlen (src);\n\n  for (i = 0; i &lt; srcLength; i++)\n    {\n      *(dest) = *(src);     //now doesn't break at this line\n      dest = dest + 1;\n      src = src + 1;\n    }\n\n  *(dest) = 0x00;       //finish with terminating null byte\n\n  return retPtr;\n}\n\n\nint\nmain ()\n{\n\n  //char a = \"abc\";    // will cause crash\n  char a[] = \"abc\";    // won't crash\n  char *b = \"xyz\";\n\n  mstrcpy(a,b); //works fine !!!!\n  return 0;\n\n}\n</code></pre>\n\n<p>Note that in the main function if you use <code>char a = \"abc\"</code> , then it will cause problem because its a pointer to a constant</p>\n"}, {"tags": [], "owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "is_accepted": false, "score": 7, "last_activity_date": 1521614925, "last_edit_date": 1521614925, "creation_date": 1521612630, "answer_id": 49399373, "question_id": 49399073, "link": "https://stackoverflow.com/questions/49399073/cant-assign-const-char-to-char/49399373#49399373", "title": "Can&#39;t assign const char* to char*", "body": "<p>Here</p>\n\n<pre><code>cpyString = strcpy(\"Sample\", cPtr);\n                   ^^^^^^^\n                   const\n</code></pre>\n\n<p>you have swapped the arguments. The first argument is a string literal (\"sample\") that you are not allowed to write to. See <a href=\"https://stackoverflow.com/a/4493156/4386427\">https://stackoverflow.com/a/4493156/4386427</a></p>\n\n<p>Try</p>\n\n<pre><code>cpyString = strcpy(cPtr, \"Sample\");\n</code></pre>\n\n<p>I'm not sure that the second line is exactly what you want but at least it is legal.</p>\n\n<p>Maybe you really want:</p>\n\n<pre><code>cpyStringBuffer[100];\ncpyString = strcpy(cpyStringBuffer, cPtr);\n</code></pre>\n\n<p>In general your code in <code>main</code> is more complicated than needed.</p>\n\n<p>Try:</p>\n\n<pre><code>int main() \n{\n    char input[100] = {0};\n    char dest[100];\n\n    printf(\"Enter word:\");  \n    scanf(\"%99s\", input);     // notice the 99 to avoid buffer overflow\n\n    strcpy(dest, input);\n\n    printf(\"new count is %d\\n\", strlen(dest));\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 9127580, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b2c7a17833f5b970b5335d487afb3acb?s=128&d=identicon&r=PG&f=1", "display_name": "IDEN", "link": "https://stackoverflow.com/users/9127580/iden"}, "is_accepted": false, "score": 0, "last_activity_date": 1521612893, "creation_date": 1521612893, "answer_id": 49399443, "question_id": 49399073, "link": "https://stackoverflow.com/questions/49399073/cant-assign-const-char-to-char/49399443#49399443", "title": "Can&#39;t assign const char* to char*", "body": "<p>I think you used non initialized destination and literal string pointer. \nYou have to declare your destination as a buffer  like </p>\n\n<pre><code>char dest[const_size]\n</code></pre>\n\n<p>So </p>\n\n<pre><code>char* strcpy(char* dest, const char* src)\n{\nchar* retPtr = dest;\n\nint i =0;\nint srcLength = strlen(src);\n\nfor(i = 0; i&lt; srcLength; i++)\n{\n   *(dest) = *(src); //at this line program breaks\n    dest = dest + 0x01;\n    src = src + 0x01;\n}\n\n*(dest) = 0x00; //finish with terminating null byte\n\n return retPtr;\n}\n\n\n\nint main()\n{\n char *arr=\"xxxxxx\";\n\nchar *dest=\"fffff\";  // this won't work because you can not modify const string\nchar *dest_1;   // this won't work because it is uninitialized pointer\nchar dest_2[50]; // this will work fine \nstrcpy(x, y);\n\n\n printf(\"%s\",x);\n     //x still the same as point pointer\n\nreturn 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 25, "user_id": 2318920, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Taq07.jpg?s=128&g=1", "display_name": "starjasmine", "link": "https://stackoverflow.com/users/2318920/starjasmine"}, "is_accepted": false, "score": 1, "last_activity_date": 1521613935, "creation_date": 1521613935, "answer_id": 49399691, "question_id": 49399073, "link": "https://stackoverflow.com/questions/49399073/cant-assign-const-char-to-char/49399691#49399691", "title": "Can&#39;t assign const char* to char*", "body": "<p>I guess you might have wanted to code like below.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint strlen(char* s);\nchar* strcpy(char* dest, char* src);\n\nint main() \n{\n    char tmp[100];\n    char cpyString[100];\n\n    printf(\"Enter word:\");  \n    fflush(stdin);\n    scanf(\"%s\", &amp;tmp);\n\n    strcpy(cpyString, tmp);\n\n    printf(\"new count is %d\\n\", strlen(cpyString));\n\n}\n\nint strlen(char* s)\n{\n   int count = 0; \n\n   while(*(s) != 0x00) \n   {\n      count++;\n      s = s+0x01;\n   }\n   return count;\n}\n\nchar* strcpy(char* dest, char* src)\n{\n    char* retPtr = dest;\n\n    int i =0;\n    int srcLength = strlen(src);\n\n    for(i = 0; i&lt; srcLength; i++)\n    {           \n       *(dest) = *(src); //at this line program breaks\n        dest = dest + 0x01;\n        src = src + 0x01;\n    }\n\n    *(dest) = 0x00; //finish with terminating null byte\n\n     return retPtr;\n}\n</code></pre>\n\n<ol>\n<li>When you invoke your <strong>strcpy()</strong> in the main function, arguments src and dest are reversed.</li>\n<li>if you want to use the variable cpyString, then you are supposed to determine which to allocate pieces of memory from either static or dynamic.\n\n<ul>\n<li>In my example, I declared <strong>cpyString</strong> as an array of characters.  Which means that the variable will occupy static memory partly.</li>\n<li>You can also alternatively allocate bytes of dynamic memory to it by calling <strong>malloc()</strong> or <strong>calloc()</strong> function.</li>\n</ul></li>\n</ol>\n"}], "owner": {"reputation": 29, "user_id": 9526589, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a99d49c64e98102734084fcf8edb6287?s=128&d=identicon&r=PG&f=1", "display_name": "MasterGuapo", "link": "https://stackoverflow.com/users/9526589/masterguapo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3288, "favorite_count": 0, "answer_count": 4, "score": 2, "last_activity_date": 1521614925, "creation_date": 1521611379, "last_edit_date": 1521614585, "question_id": 49399073, "link": "https://stackoverflow.com/questions/49399073/cant-assign-const-char-to-char", "title": "Can&#39;t assign const char* to char*", "body": "<p>I'm writing in C and have to return a char*\nI am trying to replicate the strcpy function. I have the following code</p>\n\n<pre><code>int main() \n{\n    char tmp[100];\n    char* cpyString;\n    const char* cPtr = &amp;tmp[0];\n\n    printf(\"Enter word:\");  \n    fflush(stdin);\n    scanf(\"%s\", &amp;tmp);\n\n    cpyString = strcpy(\"Sample\", cPtr);\n\n    printf(\"new count is %d\\n\", strlen(cpyString));\n\n}\n\nint strlen(char* s)\n{\n   int count = 0; \n\n   while(*(s) != 0x00) \n   {\n      count++;\n      s = s+0x01;\n   }\n   return count;\n}\n\nchar* strcpy(char* dest, const char* src)\n{\n    char* retPtr = dest;\n\n    int i =0;\n    int srcLength = strlen(src);\n\n    for(i = 0; i&lt; srcLength; i++)\n    {           \n       *(dest) = *(src); //at this line program breaks\n        dest = dest + 0x01;\n        src = src + 0x01;\n    }\n\n    *(dest) = 0x00; //finish with terminating null byte\n\n     return retPtr;\n}\n</code></pre>\n\n<p>Q1: How can I assign the dereferenced value at the src to the destination without the program crashing?</p>\n\n<p>Q2: If I need to copy the <code>tmp</code> string entered into a new string, how would I do that? I can't seem pass <code>tmp</code> as the second parameter</p>\n"}, {"tags": ["c", "mql5", "metatrader5"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 3666197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79fc6c23061326c7e6a6f82a1663634b?s=128&d=identicon&r=PG", "display_name": "user3666197", "link": "https://stackoverflow.com/users/3666197/user3666197"}, "is_accepted": true, "score": 1, "last_activity_date": 1521618948, "creation_date": 1521618948, "answer_id": 49400873, "question_id": 49398968, "link": "https://stackoverflow.com/questions/49398968/mql5-remove-or-reduce-dot-size-of-trend-line/49400873#49400873", "title": "MQL5 Remove or Reduce dot size of trend line", "body": "<h2>Remove is easy, resize is not possible at all:</h2>\n\n<p>Well, these GUI-attributes are <strong><code>{ On | Off }</code></strong> only, one can hardly ( as of 2018-Q1 ) inject changes into the MetaTrader Terminal internal handling of it's native GUI-elements. Sad, but that is the fact to live with ( the same for GUI-fonts, the same for GUI-Comment-zone font sizes and many others ).</p>\n\n<hr>\n\n<h2>Yet, there is a way to go:</h2>\n\n<p>One may switch-off these control-points upon the line creation ( just modify the calls with <strong><code>selection</code></strong> attribute set off ( as the default call-signature has:<br>\n<code>selection=true,    // highlight to move</code> </p>\n\n<p>and let the user a choice to double-click the GUI-object as she/he wishes at any later stage, once the GUI-object is to get indeed moved.</p>\n\n<p>This way the reported disturbances of the GUI composition will get eliminated, yet protecting the user-side comfort to work with GUI.</p>\n"}], "owner": {"reputation": 6177, "user_id": 4948889, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/7f1b540c13a4b2663a9bf668f6a50145?s=128&d=identicon&r=PG", "display_name": "Jaffer Wilson", "link": "https://stackoverflow.com/users/4948889/jaffer-wilson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 143, "favorite_count": 0, "accepted_answer_id": 49400873, "answer_count": 1, "score": 0, "last_activity_date": 1521618948, "creation_date": 1521610890, "last_edit_date": 1521612034, "question_id": 49398968, "link": "https://stackoverflow.com/questions/49398968/mql5-remove-or-reduce-dot-size-of-trend-line", "title": "MQL5 Remove or Reduce dot size of trend line", "body": "<p>I trying to plot a trend line object on the graph. But I am disturbed by the dots that are appearing on the trend lines. Here is the code:  </p>\n\n<pre><code>bool TrendCreate(const long            chart_ID=0,        // chart's ID \n                 const string          name=\"TrendLine\",  // line name \n                 const int             sub_window=0,      // subwindow index \n                 datetime              time1=0,           // first point time \n                 double                price1=0,          // first point price \n                 datetime              time2=0,           // second point time \n                 double                price2=0,          // second point price \n                 const color           clr=clrRed,        // line color \n                 const ENUM_LINE_STYLE style=STYLE_SOLID, // line style \n                 const int             width=1,           // line width \n                 const bool            back=false,        // in the background \n                 const bool            selection=true,    // highlight to move \n                 const bool            ray_left=false,    // line's continuation to the left \n                 const bool            ray_right=false,   // line's continuation to the right \n                 const bool            hidden=true,       // hidden in the object list \n                 const long            z_order=0)         // priority for mouse click \n  { \n//--- set anchor points' coordinates if they are not set \n   ChangeTrendEmptyPoints(time1,price1,time2,price2); \n//--- reset the error value \n   ResetLastError(); \n//--- create a trend line by the given coordinates \n   if(!ObjectCreate(chart_ID,name,OBJ_TREND,sub_window,time1,price1,time2,price2)) \n     { \n      Print(__FUNCTION__, \n            \": failed to create a trend line! Error code = \",GetLastError()); \n      return(false); \n     } \n//--- set line color \n   ObjectSetInteger(chart_ID,name,OBJPROP_COLOR,clr); \n//--- set line display style \n\n   ObjectSetInteger(chart_ID,name,OBJPROP_STYLE,style); \n\n//Set text on the graph\n\n   ObjectSetString(chart_ID,name,OBJPROP_TEXT,DoubleToString(price1 - price2));\n\n//--- set line width \n   ObjectSetInteger(chart_ID,name,OBJPROP_WIDTH,width); \n//--- display in the foreground (false) or background (true) \n   ObjectSetInteger(chart_ID,name,OBJPROP_BACK,back); \n//--- enable (true) or disable (false) the mode of moving the line by mouse \n//--- when creating a graphical object using ObjectCreate function, the object cannot be \n//--- highlighted and moved by default. Inside this method, selection parameter \n//--- is true by default making it possible to highlight and move the object \n   ObjectSetInteger(chart_ID,name,OBJPROP_SELECTABLE,selection); \n   ObjectSetInteger(chart_ID,name,OBJPROP_SELECTED,selection); \n//--- enable (true) or disable (false) the mode of continuation of the line's display to the left \n   ObjectSetInteger(chart_ID,name,OBJPROP_RAY_LEFT,ray_left); \n//--- enable (true) or disable (false) the mode of continuation of the line's display to the right \n   ObjectSetInteger(chart_ID,name,OBJPROP_RAY_RIGHT,ray_right); \n//--- hide (true) or display (false) graphical object name in the object list \n   ObjectSetInteger(chart_ID,name,OBJPROP_HIDDEN,hidden); \n//--- set the priority for receiving the event of a mouse click in the chart \n   ObjectSetInteger(chart_ID,name,OBJPROP_ZORDER,z_order); \n//--- successful execution \n   return(true); \n  } \n//+------------------------------------------------------------------+ \n//| Move trend line anchor point                                     | \n//+------------------------------------------------------------------+ \nbool TrendPointChange(const long   chart_ID=0,       // chart's ID \n                      const string name=\"TrendLine\", // line name \n                      const int    point_index=0,    // anchor point index \n                      datetime     time=0,           // anchor point time coordinate \n                      double       price=0)          // anchor point price coordinate \n  { \n//--- if point position is not set, move it to the current bar having Bid price \n   if(!time) \n      time=TimeCurrent(); \n   if(!price) \n      price=SymbolInfoDouble(Symbol(),SYMBOL_BID); \n//--- reset the error value \n   ResetLastError(); \n//--- move trend line's anchor point \n   if(!ObjectMove(chart_ID,name,point_index,time,price)) \n     { \n      Print(__FUNCTION__, \n            \": failed to move the anchor point! Error code = \",GetLastError()); \n      return(false); \n     } \n//--- successful execution \n   return(true); \n  } \n//+------------------------------------------------------------------+ \n//| The function deletes the trend line from the chart.              | \n//+------------------------------------------------------------------+ \n\n//+------------------------------------------------------------------+ \n//| Check the values of trend line's anchor points and set default   | \n//| values for empty ones                                            | \n//+------------------------------------------------------------------+ \nvoid ChangeTrendEmptyPoints(datetime &amp;time1,double &amp;price1, \n                            datetime &amp;time2,double &amp;price2) \n  { \n//--- if the first point's time is not set, it will be on the current bar \n   if(!time1) \n      time1=TimeCurrent(); \n//--- if the first point's price is not set, it will have Bid value \n   if(!price1) \n      price1=SymbolInfoDouble(Symbol(),SYMBOL_BID); \n//--- if the second point's time is not set, it is located 9 bars left from the second one \n   if(!time2) \n     { \n      //--- array for receiving the open time of the last 10 bars \n      datetime temp[10]; \n      CopyTime(Symbol(),Period(),time1,10,temp); \n      //--- set the second point 9 bars left from the first one \n      time2=temp[0]; \n     } \n//--- if the second point's price is not set, it is equal to the first point's one \n   if(!price2) \n      price2=price1; \n  }\n</code></pre>\n\n<p>Here is the image:<br>\n<a href=\"https://i.stack.imgur.com/GPLlQ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/GPLlQ.png\" alt=\"Expected image\"></a>  </p>\n\n<p>Now what I am expecting is that the dots on the line should be small or if not available still will do.  </p>\n\n<p>But I am not getting the way out how I can do that. Kindly suggest me.</p>\n"}, {"tags": ["python", "c", "swig", "typemaps"], "answers": [{"comments": [{"owner": {"reputation": 131156, "user_id": 235698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KjvlE.png?s=128&g=1", "display_name": "Mark Tolonen", "link": "https://stackoverflow.com/users/235698/mark-tolonen"}, "reply_to_user": {"reputation": 1, "user_id": 5377003, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/087e491be2b6b16ef7950e255eaad501?s=128&d=identicon&r=PG&f=1", "display_name": "\u9038\u5cf0\u674e", "link": "https://stackoverflow.com/users/5377003/%e9%80%b8%e5%b3%b0%e6%9d%8e"}, "edited": false, "score": 0, "creation_date": 1521643904, "post_id": 49400299, "comment_id": 85820504, "body": "@\u9038\u5cf0\u674e If my answer is useful, consider upvoting and accepting :)"}], "tags": [], "owner": {"reputation": 131156, "user_id": 235698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KjvlE.png?s=128&g=1", "display_name": "Mark Tolonen", "link": "https://stackoverflow.com/users/235698/mark-tolonen"}, "is_accepted": false, "score": 0, "last_activity_date": 1521616984, "last_edit_date": 1521616984, "creation_date": 1521616422, "answer_id": 49400299, "question_id": 49398631, "link": "https://stackoverflow.com/questions/49398631/using-swig-for-python-list-input-and-output/49400299#49400299", "title": "Using swig for python list input and output", "body": "<p>I'm not sure what your evaluation function is supposed to do, so I took a guess and implemented a wrapper for it.  I took <code>value_list = module.eval(point_matrix, func_id)</code> to mean you want to return a list of result of evaluating some function against each row of data points, and came up with the following.  Things I changed:</p>\n\n<ol>\n<li>The typemaps replace the first <em>four</em> parameters with a Python list of lists of numbers.</li>\n<li>space for the results in <code>f</code> was malloced.</li>\n<li>To accept other numeric types except <code>float</code>, <code>PyFloat_AsDouble</code> was called on each value, and <code>PyErr_Occurred</code> was called to see if it failed to convert.</li>\n<li>The <code>freearg</code> typemap now frees both allocations.</li>\n<li>The <code>argout</code> typemap now handles the <code>f</code> output parameter correctly.</li>\n<li><p>I added a sample <code>eval</code> implementation.</p>\n\n<pre><code>%module cec17\n\n%typemap(in) (double *x, int nx, int mx, double* f) %{\n    if (PyList_Check($input)) {\n        $3 = PyList_Size($input);\n        $2 = PyList_Size(PyList_GetItem($input, 0));\n        $1 = malloc($2 * $3 * sizeof(double));\n        $4 = malloc($3 * sizeof(double));\n        for (int i = 0; i &lt; $3; i++) {\n            for (int j = 0; j &lt; $2; j++) {\n                PyObject *o = PyList_GetItem(PyList_GetItem($input, i), j);\n                double tmp = PyFloat_AsDouble(o);\n                if(PyErr_Occurred())\n                    SWIG_fail;\n                $1[i * $2 + j] = PyFloat_AsDouble(o);\n            }\n        }\n    } else {\n        PyErr_SetString(PyExc_TypeError, \"not a list\");\n        return NULL;\n    }\n%}\n\n\n%typemap(freearg) (double *x, int nx, int mx, double* f) %{\n    free($1);\n    free($4);\n%}\n\n%typemap(argout) (double *x, int nx, int mx, double* f) (PyObject* tmp) %{\n    tmp = PyList_New($3);\n    for (int i = 0; i &lt; $3; i++) {\n        PyList_SET_ITEM(tmp, i, PyFloat_FromDouble($4[i]));\n    }\n    $result = SWIG_Python_AppendOutput($result, tmp);\n%}\n\n%inline %{\n    void eval(double *x, int nx, int mx, double *f, int func_num)\n    {\n        for(int i = 0; i &lt; mx; ++i) {\n            f[i] = 0.0;\n            for(int j = 0; j &lt; nx; ++j)\n                f[i] += x[i*nx+j];\n        }\n    }\n%}\n</code></pre></li>\n</ol>\n\n<p>Output:</p>\n\n<pre><code>&gt;&gt;&gt; import cec17\n&gt;&gt;&gt; cec17.eval([[1,2,3],[4,5,6]],99)\n[6.0, 15.0]\n</code></pre>\n\n<p>Error checking could be improved.  For example, checking for sequences instead of lists.  Only the outer list is checked that it actually is a list, so if <code>[1,2,3]</code> was the first parameter instead of nested lists, it won't behave properly.  There is no check that all the sublists are the same size, either.</p>\n\n<p>Hope this helps.  Let me know if anything is unclear.</p>\n"}], "owner": {"reputation": 1, "user_id": 5377003, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/087e491be2b6b16ef7950e255eaad501?s=128&d=identicon&r=PG&f=1", "display_name": "\u9038\u5cf0\u674e", "link": "https://stackoverflow.com/users/5377003/%e9%80%b8%e5%b3%b0%e6%9d%8e"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 340, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1601166674, "creation_date": 1521609180, "last_edit_date": 1601166674, "question_id": 49398631, "link": "https://stackoverflow.com/questions/49398631/using-swig-for-python-list-input-and-output", "title": "Using swig for python list input and output", "body": "<p>I am using SWIG to build a Python module for some functions' evaluation based on their C code.</p>\n<p>The main function I need is defined as follow:</p>\n<pre><code>void eval(double *x, int nx, int mx, double *f, int func_id)\n</code></pre>\n<p>And the aimed python function should be:</p>\n<pre><code>value_list = module.eval(point_matrix, func_id)\n</code></pre>\n<p>Here, <code>eval</code> will call a benchmark function and return their values. <code>func_id</code> is the id of function eval going to call, <code>nx</code> is the dimension of the function, and <code>mx</code> is the number of points which will be evaluated.</p>\n<p>Actually, I did not clearly understand how SWIG pass values between typemaps (like, <code>temp$argnum</code>, why always using <code>$argnum</code>?). But by looking into the wrap code, I finished the <code>typemap.i</code> file:</p>\n<pre><code>%module cec17\n\n%{\n#include &quot;cec17.h&quot;\n%}\n\n%typemap(in) (double *x, int nx, int mx) (int count){\n        if (PyList_Check($input)) {\n                $3 = PyList_Size($input);\n                $2 = PyList_Size(PyList_GetItem($input, 0));\n                count = $3;\n                int i = 0, j = 0;\n                $1 = (double *) malloc($2*$3*sizeof(double));\n                for (i = 0; i &lt; $3; i++){\n                        for (j = 0; j &lt; $2; j++){\n                                PyObject *o = PyList_GetItem(PyList_GetItem($input, i), j);\n                                if (PyFloat_Check(o))\n                                        $1[i*$2+j] = PyFloat_AsDouble(o);\n                                else {\n                                        PyErr_SetString(PyExc_TypeError, &quot;list must contrain strings&quot;);\n                                        free($1);\n                                        return NULL;\n                                }\n                        }\n                } \n        } else {\n                PyErr_SetString(PyExc_TypeError, &quot;not a list&quot;);\n                return NULL;\n        }\n}\n\n%typemap(freearg) double *x {\n        free((void *) $1);\n}\n\n%typemap(in, numinputs=0) double *f (double temp) {\n        $1 = &amp;temp;\n}\n\n%typemap(argout) double *f {\n        int i = 0;\n        int s = count1;\n        printf(&quot;pass arg %d&quot;, s);\n        $result = PyList_New(0);\n        for (i = 0; i &lt; s; i++){\n                PyList_Append($result, PyFloat_FromDouble($1[i]));\n        }\n}\n\nvoid eval(double *x, int nx, int mx, double *f, int func_num);\n</code></pre>\n<p>However, strange things happened then. Usually, I test 30 dimensional functions. When evaluating less than 10 points (<code>mx</code> &lt; 10), the module works fine. When evaluating more points, an error occurs:</p>\n<pre><code>[1] 13616 segmentation fault (core dumped) python test.py\n</code></pre>\n<p>I'm quite sure the problem is not in the c code, because the only place where 'mx' occurs is in the 'for-loop' line in which are evaluations of each point.</p>\n<p>I also tried to read the wrap code and debug, but I just can't find where the problem is. Following is a part of the wrap code generated by SWIG, and I added a 'printf' line. Even this string is not printed before the error.</p>\n<pre><code>#ifdef __cplusplus\nextern &quot;C&quot; {\n#endif\nSWIGINTERN PyObject *_wrap_eval(PyObject *SWIGUNUSEDPARM(self), PyObject *args) {\n  PyObject *resultobj = 0;\n  double *arg1 = (double *) 0 ;\n  int arg2 ;\n  int arg3 ;\n  double *arg4 = (double *) 0 ;\n  int arg5 ;\n  int count1 ;\n  double temp4 ;\n  int val5 ;\n  int ecode5 = 0 ;\n  PyObject * obj0 = 0 ;\n  PyObject * obj1 = 0 ;\n  printf(&quot;check point 0&quot;);  \n  {\n    arg4 = &amp;temp4;\n  }\n  if (!PyArg_ParseTuple(args,(char *)&quot;OO:eval&quot;,&amp;obj0,&amp;obj1)) SWIG_fail;\n  {\n    if (PyList_Check(obj0)) {\n      arg3 = PyList_Size(obj0);\n      arg2 = PyList_Size(PyList_GetItem(obj0, 0));\n      count1 = arg3;\n      int i = 0, j = 0;\n      arg1 = (double *) malloc(arg2*arg3*sizeof(double));\n      for (i = 0; i &lt; arg3; i++){\n        for (j = 0; j &lt; arg2; j++){\n          PyObject *o = PyList_GetItem(PyList_GetItem(obj0, i), j);\n          if (PyFloat_Check(o))\n          arg1[i*arg2+j] = PyFloat_AsDouble(o);\n          else {\n            PyErr_SetString(PyExc_TypeError, &quot;list must contrain strings&quot;);\n            free(arg1);\n            return NULL;\n          }\n        }\n      } \n    } else {\n      PyErr_SetString(PyExc_TypeError, &quot;not a list&quot;);\n      return NULL;\n    }\n  }\n  ecode5 = SWIG_AsVal_int(obj1, &amp;val5);\n  if (!SWIG_IsOK(ecode5)) {\n    SWIG_exception_fail(SWIG_ArgError(ecode5), &quot;in method '&quot; &quot;eval&quot; &quot;', argument &quot; &quot;5&quot;&quot; of type '&quot; &quot;int&quot;&quot;'&quot;);\n  } \n  arg5 = (int)(val5);\n  eval(arg1,arg2,arg3,arg4,arg5);\n  resultobj = SWIG_Py_Void();\n  {\n    int i = 0;\n    int s = count1;\n    resultobj = PyList_New(0);\n    for (i = 0; i &lt; s; i++){\n      PyList_Append(resultobj, PyFloat_FromDouble(arg4[i]));\n    }\n  }\n  return resultobj;\nfail:\n  return NULL;\n}\n</code></pre>\n<p>The problem seems a little tedious. Maybe you could just show me how to write the proper <code>typemap.i</code> code.</p>\n"}, {"tags": ["c", "u-boot"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1521608248, "post_id": 49398448, "comment_id": 85798309, "body": "Try running the code through the preprocessor only (use the <code>-E</code> option to GCC) and take a look at what the preprocessor replaces the macro invocation with."}, {"owner": {"reputation": 198, "user_id": 9526419, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "SRK", "link": "https://stackoverflow.com/users/9526419/srk"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1521608956, "post_id": 49398448, "comment_id": 85798499, "body": "I understand that @Someprogrammerdude. But you see find_cmd() can take any C string as a parameter, and what parameters it can take is not known during pre-processing or compilation stage. In find_cmd() the parameter cmd is passed to ll_entry_start() as its second parameter. How can #(stringizing) operator generate a string from a token which is known only at runtime?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1521610262, "post_id": 49398448, "comment_id": 85798958, "body": "It can&#39;t. That&#39;s why you have to look at what the preprocessor generates. That&#39;s the best way to find out what really happens."}, {"owner": {"reputation": 198, "user_id": 9526419, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "SRK", "link": "https://stackoverflow.com/users/9526419/srk"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1521611395, "post_id": 49398448, "comment_id": 85799320, "body": "Thanks @Someprogrammerdude . I checked the pre-processor output. &quot;.u_boot_list_2_&quot;#_list&quot;_1&quot; gets replaced with &quot;&quot;.u_boot_list_2_cmd_1&quot;. # just converts a token into string. Seeing this piece of code i thought that #_list will cause the string value in cmd to be replaced."}], "answers": [{"tags": [], "owner": {"reputation": 1585, "user_id": 3670607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c0ac3a4aac38bc184c7b6c1e45e98e1?s=128&d=identicon&r=PG", "display_name": "Xypron", "link": "https://stackoverflow.com/users/3670607/xypron"}, "is_accepted": true, "score": 0, "last_activity_date": 1523086122, "creation_date": 1523086122, "answer_id": 49705018, "question_id": 49398448, "link": "https://stackoverflow.com/questions/49398448/how-ll-entry-declare-works-in-u-boot/49705018#49705018", "title": "How ll_entry_declare() works in U-Boot?", "body": "<p>The linker generated list for the commands is filled by specifying the commands with the U_BOOT_CMD macro. Here is an example from cmd/bootefi.c</p>\n\n<pre><code>U_BOOT_CMD(\n        bootefi, 3, 0, do_bootefi,\n        \"Boots an EFI payload from memory\",\n        bootefi_help_text\n);\n</code></pre>\n\n<p>The linker creates a section in the u-boot binary for each command, e.g. for bootefi: .u_boot_list_2_cmd_2_bootefi</p>\n\n<p>You can iterate over linker generated lists using ll_entry_start and ll_entry_next. Below is an example taken from lib/efi_selftest/efi_selftest.c:</p>\n\n<pre><code>for (test = ll_entry_start(struct efi_unit_test, efi_unit_test);\n     test &lt; ll_entry_end(struct efi_unit_test, efi_unit_test); ++test) {\n        efi_st_printf(\"'%s'%s\\n\", test-&gt;name,\n                      test-&gt;on_request ? \" - on request\" : \"\");\n} \n</code></pre>\n"}], "owner": {"reputation": 198, "user_id": 9526419, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "SRK", "link": "https://stackoverflow.com/users/9526419/srk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 442, "favorite_count": 0, "accepted_answer_id": 49705018, "answer_count": 1, "score": 0, "last_activity_date": 1523086122, "creation_date": 1521608054, "last_edit_date": 1521612606, "question_id": 49398448, "link": "https://stackoverflow.com/questions/49398448/how-ll-entry-declare-works-in-u-boot", "title": "How ll_entry_declare() works in U-Boot?", "body": "<p>When the U-boot shell wants to find a command from the linker_list, it invokes the following function - </p>\n\n<pre><code>cmd_tbl_t *find_cmd(const char *cmd)\n{\n         cmd_tbl_t *start = ll_entry_start(cmd_tbl_t, cmd);\n         const int len = ll_entry_count(cmd_tbl_t, cmd);\n         return find_cmd_tbl(cmd, start, len);\n}\n</code></pre>\n\n<p>To get a pointer to the struct cmd_tbl_t which holds all the specifics of this command, ll_entry_start() is invoked. </p>\n\n<pre><code>#define ll_entry_start(_type, _list)                                    \n ({                                                                      \n         static char start[0] __aligned(4) __attribute__((unused,        \n                 section(\".u_boot_list_2_\"#_list\"_1\")));                 \n         (_type *)&amp;start;                                                \n })\n</code></pre>\n\n<p>ll_entry_start gives back pointer to the start of the struct cmd_tbl_t holding the command. </p>\n\n<p>We cannot predict what is the string passed to find_cmd().</p>\n\n<p>The #(stringizing) operator is a pre-processor directive. It cannot generate a string from a token name in runtime. How does the compiler generate code for all the possible string values that _list can take in this? </p>\n"}, {"tags": ["c#", "c", "mapserver", "getenv"], "comments": [{"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1521821873, "post_id": 49398367, "comment_id": 85911197, "body": "in general, an environment variable is only visible in the creating process and in &#39;children&#39; of the creating process"}], "answers": [{"comments": [{"owner": {"reputation": 8181, "user_id": 115988, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/5f4389b462408f1e198c2955f93710f8?s=128&d=identicon&r=PG", "display_name": "Porton", "link": "https://stackoverflow.com/users/115988/porton"}, "edited": false, "score": 0, "creation_date": 1521609346, "post_id": 49398515, "comment_id": 85798614, "body": "we target EnvironmentVariableTarget.Process, which worked with everything but Win2016+VS-redist-2015)  trying now with EnvironmentVariableTarget.Machine.  thanks for the tip"}, {"owner": {"reputation": 8181, "user_id": 115988, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/5f4389b462408f1e198c2955f93710f8?s=128&d=identicon&r=PG", "display_name": "Porton", "link": "https://stackoverflow.com/users/115988/porton"}, "edited": false, "score": 1, "creation_date": 1521610499, "post_id": 49398515, "comment_id": 85799028, "body": "EnvironmentVariableTarget.Machine did not work either."}], "tags": [], "owner": {"reputation": 2579, "user_id": 88289, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/2430f108035a5de4a18595bac2034daf?s=128&d=identicon&r=PG", "display_name": "pmcilreavy", "link": "https://stackoverflow.com/users/88289/pmcilreavy"}, "is_accepted": false, "score": 2, "last_activity_date": 1521608476, "creation_date": 1521608476, "answer_id": 49398515, "question_id": 49398367, "link": "https://stackoverflow.com/questions/49398367/environment-setenvironmentvariable-does-not-set-any-value/49398515#49398515", "title": "Environment.SetEnvironmentVariable does not set any value", "body": "<p>By default <code>Environment.SetEnvironmentVariable(string &lt;variable&gt;, string &lt;value&gt;)</code> stores variables for the <em>current process</em>. To be more sure you need to use the overload that contains the target <code>Environment.SetEnvironmentVariable(string &lt;variable&gt;, string &lt;value&gt;, EnvironmentVariableTarget &lt;target&gt;)</code>. That way you can set the target to <code>Machine</code> or <code>User</code>.</p>\n"}], "owner": {"reputation": 8181, "user_id": 115988, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/5f4389b462408f1e198c2955f93710f8?s=128&d=identicon&r=PG", "display_name": "Porton", "link": "https://stackoverflow.com/users/115988/porton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 605, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1521609277, "creation_date": 1521607601, "last_edit_date": 1521609277, "question_id": 49398367, "link": "https://stackoverflow.com/questions/49398367/environment-setenvironmentvariable-does-not-set-any-value", "title": "Environment.SetEnvironmentVariable does not set any value", "body": "<p>i'm encountering this issue with only</p>\n\n<ul>\n<li>Windows Server 2016 (Win2016) and</li>\n<li>VisualStudio-redistributable 2015 (VS-redist-2015 = msvcp14)</li>\n</ul>\n\n<p>c# <code>Environment.SetEnvironmentVariable(key,val, EnvironmentVariableTarget.Process)</code> does not seem to set values that can be retrieved on the native-C app using <a href=\"https://github.com/szekerest/mapserver/blob/intramaps-ms7/fontcache.c#L162\" rel=\"nofollow noreferrer\">getenv()</a></p>\n\n<p>native-C app <a href=\"https://github.com/szekerest/mapserver/blob/intramaps-ms7/fontcache.c#L162\" rel=\"nofollow noreferrer\">getenv()</a> can read the values OK using Win2016 + VS-redist-2010</p>\n\n<p>This works fine in Windows Server 2012 and 2008 using VS-redist-2015</p>\n\n<p>Any thought / suggestion will be appreciated.</p>\n"}, {"tags": ["c", "parameters", "pthreads"], "answers": [{"tags": [], "owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "is_accepted": true, "score": 0, "last_activity_date": 1521607148, "creation_date": 1521607148, "answer_id": 49398304, "question_id": 49398280, "link": "https://stackoverflow.com/questions/49398280/error-with-parameters-used-in-pthread-create/49398304#49398304", "title": "Error with Parameters used in pthread_create", "body": "<p>Just make <code>occurence</code> function accept one <code>void*</code> parameter and the warning go away.</p>\n"}, {"tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": false, "score": 2, "last_activity_date": 1521607199, "creation_date": 1521607199, "answer_id": 49398312, "question_id": 49398280, "link": "https://stackoverflow.com/questions/49398280/error-with-parameters-used-in-pthread-create/49398312#49398312", "title": "Error with Parameters used in pthread_create", "body": "<p>The thread function must follow a specific signature. Even if you don't use the argument and don't return a value, you must still have the correct signature.</p>\n\n<p>If you don't need the argument, just ignore it.</p>\n\n<p>If you don't have a specific return value, just return <code>NULL</code>.</p>\n"}], "owner": {"reputation": 33, "user_id": 8560766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b300cb928c8937209d629de93d8719bd?s=128&d=identicon&r=PG&f=1", "display_name": "brian nyaberi", "link": "https://stackoverflow.com/users/8560766/brian-nyaberi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "accepted_answer_id": 49398304, "answer_count": 2, "score": 0, "last_activity_date": 1521607199, "creation_date": 1521607031, "question_id": 49398280, "link": "https://stackoverflow.com/questions/49398280/error-with-parameters-used-in-pthread-create", "title": "Error with Parameters used in pthread_create", "body": "<p>I'm working on the following pthread program that finds the number of substrings in string2 that are in string:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;pthread.h&gt;\n#define NUM_THREADS 4\n#define MAX 1024\n\nint n1,n2,i;\nchar *s1,*s2;\nFILE *fp;\n\nchar *substring(char *string, int position, int length);\nvoid occurrence();\n\n\nint readf(FILE *fp)\n{\n    if((fp=fopen(\"strings.txt\", \"r\"))==NULL){\n        printf(\"ERROR: can't open strings.txt!\\n\");\n        return 0;\n    }\n    s1=(char *)malloc(sizeof(char)*MAX);\n    if(s1==NULL){\n        printf(\"ERROR: Out of memory!\\n\");\n        return -1;\n    }\n    s2=(char *)malloc(sizeof(char)*MAX);\n    if(s1==NULL){\n        printf(\"ERROR: Out of memory\\n\");\n        return -1;\n    }\n    /*read s1 s2 from the file*/\n    s1=fgets(s1, MAX, fp);\n    s2=fgets(s2, MAX, fp);\n    n1=strlen(s1);  /*length of s1*/\n    n2=strlen(s2)-1; /*length of s2*/\n    if(s1==NULL || s2==NULL || n1&lt;n2)  /*when error exit*/\n        return -1;\n}\n\nint main(void)\n{\n    pthread_t tid;\n    pthread_create(&amp;tid, NULL, occurrence, NULL);\n    pthread_join(tid, NULL);\n    exit(0);\n\n}\n\nchar *substring(char *string, int position, int length)\n{\n    char *pointer;\n    int c;\n\n    pointer = malloc(length+1);\n\n    if (pointer == NULL)\n    {\n        printf(\"Unable to allocate memory.\\n\");\n        exit(1);\n    }\n\n    for (c = 0 ; c &lt; length ; c++)\n    {\n        *(pointer+c) = *(string+position-1);\n        string++;\n    }\n\n    *(pointer+c) = '\\0';\n\n    return pointer;\n}\n\nvoid occurrence()\n{\n    char *string1;\n    char *string2;\n    char *new_str;\n    int counter=0;\n    readf(fp);\n\n    string1 = s1;\n    string2 = s2;\n    new_str = malloc(200);\n    for(i=1;i&lt;=strlen(string1);i++)\n    {\n        new_str = substring(string1,i,strlen(string2));\n        if(strcmp(new_str, string2)==0)\n        {\n            counter++;\n        }\n    }\n    printf(\"The number of substrings is: %d\",counter);\n}\n</code></pre>\n\n<p>When I compile and run it, it runs okay but I get the following warning: </p>\n\n<pre><code>|44|warning: passing argument 3 of 'pthread_create' from incompatible pointer type|\n|314|note: expected 'void * (*)(void *)' but argument is of type 'void (*)()'|\n</code></pre>\n\n<p>I know it has to do with the parameters used for Pthread, however i'm having trouble figuring out how to fix it. Any suggestions?</p>\n"}, {"tags": ["c", "data-structures", "rendering", "text-editor"], "comments": [{"owner": {"reputation": 811, "user_id": 9493582, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bfI3b.jpg?s=128&g=1", "display_name": "Arndt Jonasson", "link": "https://stackoverflow.com/users/9493582/arndt-jonasson"}, "edited": false, "score": 0, "creation_date": 1521640112, "post_id": 49398180, "comment_id": 85817356, "body": "Just after opening the file, you will always have to scan through the file to get to a particular line, unless you store line offsets somewhere on disk as well."}, {"owner": {"reputation": 811, "user_id": 9493582, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bfI3b.jpg?s=128&g=1", "display_name": "Arndt Jonasson", "link": "https://stackoverflow.com/users/9493582/arndt-jonasson"}, "edited": false, "score": 0, "creation_date": 1521640144, "post_id": 49398180, "comment_id": 85817377, "body": "Are you free to modify the <code>struct</code> definitions and add new ones?"}, {"owner": {"reputation": 1814, "user_id": 3907602, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f9c85de931a7e03143116752bdde53aa?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/3907602/john"}, "reply_to_user": {"reputation": 811, "user_id": 9493582, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bfI3b.jpg?s=128&g=1", "display_name": "Arndt Jonasson", "link": "https://stackoverflow.com/users/9493582/arndt-jonasson"}, "edited": false, "score": 0, "creation_date": 1521640932, "post_id": 49398180, "comment_id": 85818066, "body": "Yeah, I can do whatever I want. This isn&#39;t homework, just a for fun project. I get that there will have to be some initial scan of the file, I guess I&#39;m wondering what people usually store to make jumping between lines easy. I haven&#39;t seen anything about this in any of the readings about people using piece tables for text editing."}, {"owner": {"reputation": 811, "user_id": 9493582, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bfI3b.jpg?s=128&g=1", "display_name": "Arndt Jonasson", "link": "https://stackoverflow.com/users/9493582/arndt-jonasson"}, "edited": false, "score": 0, "creation_date": 1521642443, "post_id": 49398180, "comment_id": 85819284, "body": "You could look at how <code>emacs</code> does it. I don&#39;t know what it does now - I last looked at the C code for version 17."}], "owner": {"reputation": 1814, "user_id": 3907602, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f9c85de931a7e03143116752bdde53aa?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/3907602/john"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 147, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1521606320, "creation_date": 1521606320, "question_id": 49398180, "link": "https://stackoverflow.com/questions/49398180/working-with-particular-lines-when-using-a-piece-table", "title": "Working with particular lines when using a piece table", "body": "<p>So I've implemented a text editor the \"normal\" way (just an array of arrays), but now I am trying to do so using a piece table. Implementing the data structure seems straightforward, but it's unclear to me how to translate actions the user takes in the GUI over to the table without stupidly reading through the entire file. Here is my piece-table definition:</p>\n\n<pre><code>typedef struct piece {\n    int start;\n    int length; \n    char *buffer;\n} piece;\n\ntypedef struct piece_table {\n    char *file_buffer;\n    int file_buffer_size;\n    char *add_buffer;\n    int add_buffer_size; \n    piece *pieces;\n} piece_table;\n</code></pre>\n\n<p>My main problem is not knowing what line number some random bit of text is in. For example, let's say someone who has just opened the file tells the editor to \"Jump to line 10,000\". Doing this in my current text editor is constant time, since I can just index the line in question. But for a piece table approach, it would seem I have to search through every character of the text, counting newline characters until I get to 10,000. Nothing about the actual line count is stored at the data structure level, which seems unfortunate. </p>\n\n<p>I considered adding a special line transition piece to the table, but that fragments things more than necessary. I don't have a lot of other ideas, and am wondering how this is actually done in practice when one works with piece tables. </p>\n\n<p>TL;DR How do I quickly determine what line a particular bit of text is at in my piece table? </p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1521604820, "post_id": 49397889, "comment_id": 85797425, "body": "You need to validate the <b>return</b> of <code>scanf(&quot;%d&quot;, &amp;choice)</code>. You need to handle <code>EOF</code> and a return of <code>0</code>. You must receive a return of <code>1</code> before considering <code>choice</code> to hold a valid integer. You must flush any characters that remain in <code>stdin</code> after a return of <code>0</code>."}, {"owner": {"reputation": 4328, "user_id": 920069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd39f0db1f22e1314746491df063602a?s=128&d=identicon&r=PG", "display_name": "Retired Ninja", "link": "https://stackoverflow.com/users/920069/retired-ninja"}, "edited": false, "score": 0, "creation_date": 1521604869, "post_id": 49397889, "comment_id": 85797436, "body": "You return an int from your menu function, but the switch in <code>ContactManagerSystem</code> is looking for a char."}, {"owner": {"reputation": 5, "user_id": 9526242, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49d51d299f471782ede9c0b70cdf141?s=128&d=identicon&r=PG&f=1", "display_name": "zxc20100123", "link": "https://stackoverflow.com/users/9526242/zxc20100123"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1521605820, "post_id": 49397889, "comment_id": 85797689, "body": "@DavidC.Rankin I&#39;m not sure about the return part, but I added clearkeyboard function. Post edited."}, {"owner": {"reputation": 5, "user_id": 9526242, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49d51d299f471782ede9c0b70cdf141?s=128&d=identicon&r=PG&f=1", "display_name": "zxc20100123", "link": "https://stackoverflow.com/users/9526242/zxc20100123"}, "reply_to_user": {"reputation": 4328, "user_id": 920069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd39f0db1f22e1314746491df063602a?s=128&d=identicon&r=PG", "display_name": "Retired Ninja", "link": "https://stackoverflow.com/users/920069/retired-ninja"}, "edited": false, "score": 0, "creation_date": 1521605917, "post_id": 49397889, "comment_id": 85797708, "body": "@RetiredNinja The menu function prototype is set by our prof. Does that mean I should probably use anything else other than switch?"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1521606132, "post_id": 49397889, "comment_id": 85797769, "body": "The key here is <code>int rtn = scanf(&quot;%d&quot;, &amp;choice);</code> then test <code>if (rtn == EOF) { &#47;* user canceled input *&#47; }</code> then <code>if (rtn == 0) { &#47;* matching failure - clear stdin *&#47; }</code> finally <code>if (rtn == 1) { &#47;* I have a good value in choice *&#47; }</code> after which you should clear <code>stdin</code> to handle input like <code>&quot;3 ants go marching on again...&quot;</code>"}, {"owner": {"reputation": 5, "user_id": 9526242, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49d51d299f471782ede9c0b70cdf141?s=128&d=identicon&r=PG&f=1", "display_name": "zxc20100123", "link": "https://stackoverflow.com/users/9526242/zxc20100123"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1521607159, "post_id": 49397889, "comment_id": 85798027, "body": "@DavidC.Rankin Thank you for that, I&#39;ve edited the code, might not be exactly same as what you said, but I tried :("}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1521611182, "post_id": 49397889, "comment_id": 85799240, "body": "Read <a href=\"http://en.cppreference.com/w/c\" rel=\"nofollow noreferrer\">documentation</a> (e.g. of functions like <a href=\"http://en.cppreference.com/w/c/io/fscanf\" rel=\"nofollow noreferrer\">scanf</a>) of every standard function that you use. Compile with all warnings and debug info (<code>gcc -Wall -Wextra -g</code> with <a href=\"http://gcc.gnu.org/\" rel=\"nofollow noreferrer\">GCC</a>) and improve your code to get no warnings. <a href=\"https://sourceware.org/gdb/current/onlinedocs/gdb/\" rel=\"nofollow noreferrer\">use the debugger, e.g. <code>gdb</code></a>"}], "answers": [{"comments": [{"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1521605836, "post_id": 49398064, "comment_id": 85797690, "body": "There are no methods in <b>C</b>"}, {"owner": {"reputation": 603, "user_id": 6647878, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8819773417e9f95c851a5690d80ba1a6?s=128&d=identicon&r=PG&f=1", "display_name": "Nidhi257", "link": "https://stackoverflow.com/users/6647878/nidhi257"}, "reply_to_user": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1521606102, "post_id": 49398064, "comment_id": 85797760, "body": "which method you are talking?"}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1521606930, "post_id": 49398064, "comment_id": 85797963, "body": "This \u2014&gt;&gt; \u201cmenu() method ..\u201d. In <b>C</b>, menu is a Function."}, {"owner": {"reputation": 5, "user_id": 9526242, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49d51d299f471782ede9c0b70cdf141?s=128&d=identicon&r=PG&f=1", "display_name": "zxc20100123", "link": "https://stackoverflow.com/users/9526242/zxc20100123"}, "edited": false, "score": 0, "creation_date": 1521607215, "post_id": 49398064, "comment_id": 85798039, "body": "Thank you for the help. I&#39;ve edited my code. I&#39;m using char yesno to determine if the user wants to end the program or not. And the first character to be scanned should be either &#39;y&#39; or &#39;n&#39;. May I ask why you wanted me to put it like that(scanf(&quot;%c%c&quot;, &amp;c,&amp;yesno);)?"}, {"owner": {"reputation": 603, "user_id": 6647878, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8819773417e9f95c851a5690d80ba1a6?s=128&d=identicon&r=PG&f=1", "display_name": "Nidhi257", "link": "https://stackoverflow.com/users/6647878/nidhi257"}, "edited": false, "score": 0, "creation_date": 1521607229, "post_id": 49398064, "comment_id": 85798042, "body": "yes i mean menu() function. will update the answer. thanks"}, {"owner": {"reputation": 603, "user_id": 6647878, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8819773417e9f95c851a5690d80ba1a6?s=128&d=identicon&r=PG&f=1", "display_name": "Nidhi257", "link": "https://stackoverflow.com/users/6647878/nidhi257"}, "reply_to_user": {"reputation": 5, "user_id": 9526242, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49d51d299f471782ede9c0b70cdf141?s=128&d=identicon&r=PG&f=1", "display_name": "zxc20100123", "link": "https://stackoverflow.com/users/9526242/zxc20100123"}, "edited": false, "score": 0, "creation_date": 1521607298, "post_id": 49398064, "comment_id": 85798065, "body": "@zxc20100123 if answer is correct mark it as resolved."}], "tags": [], "owner": {"reputation": 603, "user_id": 6647878, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8819773417e9f95c851a5690d80ba1a6?s=128&d=identicon&r=PG&f=1", "display_name": "Nidhi257", "link": "https://stackoverflow.com/users/6647878/nidhi257"}, "is_accepted": true, "score": 1, "last_activity_date": 1521607240, "last_edit_date": 1521607240, "creation_date": 1521605557, "answer_id": 49398064, "question_id": 49397889, "link": "https://stackoverflow.com/questions/49397889/call-menu-function-in-another-function/49398064#49398064", "title": "Call menu function in another function", "body": "<p>there are two problem in your code.</p>\n\n<ol>\n<li><p>menu() function returns <code>int</code> and you are matching <code>int</code> with <code>char</code> in switch case <code>case '1':</code> it should be <code>case 1:</code></p></li>\n<li><p>replace below line</p></li>\n</ol>\n\n<p><code>scanf(\"%c%c\", &amp;yesno,&amp;c);</code> with <code>scanf(\"%c%c\", &amp;c,&amp;yesno);</code></p>\n\n<p>hope this help you.</p>\n"}, {"comments": [{"owner": {"reputation": 5, "user_id": 9526242, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49d51d299f471782ede9c0b70cdf141?s=128&d=identicon&r=PG&f=1", "display_name": "zxc20100123", "link": "https://stackoverflow.com/users/9526242/zxc20100123"}, "edited": false, "score": 0, "creation_date": 1521608140, "post_id": 49398315, "comment_id": 85798283, "body": "Thanks, I finally manage to make it work with you guys&#39; help :D"}, {"owner": {"reputation": 5295, "user_id": 717523, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b436aae08258d0a6b3f515eb03d5f15?s=128&d=identicon&r=PG", "display_name": "sg7", "link": "https://stackoverflow.com/users/717523/sg7"}, "reply_to_user": {"reputation": 5, "user_id": 9526242, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49d51d299f471782ede9c0b70cdf141?s=128&d=identicon&r=PG&f=1", "display_name": "zxc20100123", "link": "https://stackoverflow.com/users/9526242/zxc20100123"}, "edited": false, "score": 0, "creation_date": 1521608276, "post_id": 49398315, "comment_id": 85798317, "body": "@Great! I am glad that we helped. Please accept one of the answers."}, {"owner": {"reputation": 5, "user_id": 9526242, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49d51d299f471782ede9c0b70cdf141?s=128&d=identicon&r=PG&f=1", "display_name": "zxc20100123", "link": "https://stackoverflow.com/users/9526242/zxc20100123"}, "edited": false, "score": 0, "creation_date": 1521608413, "post_id": 49398315, "comment_id": 85798368, "body": "You definitely help too, I gave it to Nidhi257 since (s)he answered first! Appreciate it!"}], "tags": [], "owner": {"reputation": 5295, "user_id": 717523, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b436aae08258d0a6b3f515eb03d5f15?s=128&d=identicon&r=PG", "display_name": "sg7", "link": "https://stackoverflow.com/users/717523/sg7"}, "is_accepted": false, "score": 1, "last_activity_date": 1521607526, "last_edit_date": 1521607526, "creation_date": 1521607221, "answer_id": 49398315, "question_id": 49397889, "link": "https://stackoverflow.com/questions/49397889/call-menu-function-in-another-function/49398315#49398315", "title": "Call menu function in another function", "body": "<p>Two issues to be improved.</p>\n\n<p>1) Since <code>menu()</code> returns integer, switch case should have integers not characters.</p>\n\n<p>2) </p>\n\n<pre><code>    printf(\"Exit the program? (Y)es/(N)o: \");\n    scanf(\"%c%c\", &amp;yesno, &amp;c);\n</code></pre>\n\n<p>You do not use <code>c</code>;</p>\n\n<p><code>scanf(\" %c\", &amp;yesno);</code> \nis enough.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid clearKeyboard(void)\n{\n    int c;\n    while ((c = getchar()) != '\\n' &amp;&amp; c != EOF);\n}\n\nvoid ContactManagerSystem(void)\n{\n    int contactchoice;\n    int done = 1;\n    char yesno, c;\n    do {\n        contactchoice = menu();\n        switch (contactchoice) {\n        case 1:\n            printf(\"&lt;&lt;&lt; Feature 1 is unavailable &gt;&gt;&gt;\\n\");\n            break;\n        case 2:\n            printf(\"&lt;&lt;&lt; Feature 2 is unavailable &gt;&gt;&gt;\\n\");\n            break;\n        case 3:\n            printf(\"&lt;&lt;&lt; Feature 3 is unavailable &gt;&gt;&gt;\\n\");\n            break;\n        case 4:\n            printf(\"&lt;&lt;&lt; Feature 4 is unavailable &gt;&gt;&gt;\\n\");\n            break;\n        case 5:\n            printf(\"&lt;&lt;&lt; Feature 5 is unavailable &gt;&gt;&gt;\\n\");\n            break;\n        case 6:\n            printf(\"&lt;&lt;&lt; Feature 6 is unavailable &gt;&gt;&gt;\\n\");\n        case 0:\n            printf(\"Exit the program? (Y)es/(N)o: \");\n            scanf(\" %c\", &amp;yesno);\n            if (yesno == 'Y' || yesno == 'y') {\n                done = 0;\n                break;\n            }\n            else if (yesno == 'N' || yesno == 'n')\n                break;          \n        default:\n            break;\n        }\n\n    } while (done == 1);\n}\n\n\n\nint menu(void)\n{\n    int done = 1;\n    int choice;\n    do {\n        printf(\"Contact Management System\\n\");\n        printf(\"-------------------------\\n\");\n        printf(\"1. Display contacts\\n\");\n        printf(\"2. Add a contact\\n\");\n        printf(\"3. Update a contact\\n\");\n        printf(\"4. Delete a contact\\n\");\n        printf(\"5. Search contacts by cell phone number\\n\");\n        printf(\"6. Sort contacts by cell phone numbe\\n\");\n        printf(\"0. Exit\\n\\n\");\n        printf(\"Select an option:&gt; \");\n        scanf(\"%d\", &amp;choice);\n\n        if (choice &gt;= 0 &amp;&amp; choice &lt;= 6)\n            done = 0;\n        else {\n            clearKeyboard();\n            printf(\"*** OUT OF RANGE *** &lt;Enter a number between 0 and 6&gt;: \");\n            scanf(\"%d\", &amp;choice);\n        }\n    } while (done == 1);\n\n    return choice;\n}\n\nint main(void)\n{\n    ContactManagerSystem();\n    return 0;\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>Contact Management System                                                                                                                   \n-------------------------                                                                                                                   \n1. Display contacts                                                                                                                         \n2. Add a contact                                                                                                                            \n3. Update a contact                                                                                                                         \n4. Delete a contact                                                                                                                         \n5. Search contacts by cell phone number                                                                                                     \n6. Sort contacts by cell phone numbe                                                                                                        \n0. Exit                                                                                                                                     \n\nSelect an option:&gt; 1                                                                                                                        \n&lt;&lt;&lt; Feature 1 is unavailable &gt;&gt;&gt;                                                                                                            \nContact Management System                                                                                                                   \n-------------------------                                                                                                                   \n1. Display contacts                                                                                                                         \n2. Add a contact                                                                                                                            \n3. Update a contact                                                                                                                         \n4. Delete a contact                                                                                                                         \n5. Search contacts by cell phone number                                                                                                     \n6. Sort contacts by cell phone numbe                                                                                                        \n0. Exit                                                                                                                                     \n\nSelect an option:&gt; 0                                                                                                                        \nExit the program? (Y)es/(N)o: Y\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5, "user_id": 9526242, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49d51d299f471782ede9c0b70cdf141?s=128&d=identicon&r=PG&f=1", "display_name": "zxc20100123", "link": "https://stackoverflow.com/users/9526242/zxc20100123"}, "edited": false, "score": 0, "creation_date": 1521667550, "post_id": 49398972, "comment_id": 85835321, "body": "Wow nice one, this is bit over what I&#39;ve learned. Thanks for your time and effort. am taking a look at it!"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 5, "user_id": 9526242, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49d51d299f471782ede9c0b70cdf141?s=128&d=identicon&r=PG&f=1", "display_name": "zxc20100123", "link": "https://stackoverflow.com/users/9526242/zxc20100123"}, "edited": false, "score": 0, "creation_date": 1521667849, "post_id": 49398972, "comment_id": 85835471, "body": "It does pretty must just what the others do, but it protects against the user canceling at each input and makes things more readable by simply using a single <code>printf</code> for the menu (C will put all sequential string literals together for you <code>&quot;...&quot; &quot;...&quot; &quot;...&quot;</code>) and by introducing you to the <code>case-fallthrough</code> which is part of the <code>switch</code> statement (It can allow you to tailor the <code>switch</code> as needed - or bite you if you forget to <code>break;</code>). Good luck with your coding <code>:)</code>"}], "tags": [], "owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "is_accepted": false, "score": 1, "last_activity_date": 1521610903, "creation_date": 1521610903, "answer_id": 49398972, "question_id": 49397889, "link": "https://stackoverflow.com/questions/49397889/call-menu-function-in-another-function/49398972#49398972", "title": "Call menu function in another function", "body": "<p>Just a few additional cleanups. You need to determine how to handle the user canceling input by generating a manual <code>EOF</code> with <kbd>Ctrl+d</kbd> (or <kbd>Ctrl+z</kbd> on windoze). Since you are returning an <code>int</code> value, you can easily return <code>-1</code> for your <code>EOF</code> case. </p>\n\n<p>Also, how many calls to <code>printf</code> do you need to make? One is enough, e.g.</p>\n\n<pre><code>int menu (void)\n{\n    int rtn, choice;    /* scanf return, menu choice */\n\n    for (;;) {  /* loop until valid input or EOF displaying menu */\n        printf (\"\\nContact Management System\\n\"\n                \"-------------------------\\n\"\n                \" 1. Display contacts\\n\"\n                \" 2. Add a contact\\n\"\n                \" 3. Update a contact\\n\"\n                \" 4. Delete a contact\\n\"\n                \" 5. Search contacts by cell phone number\\n\"\n                \" 6. Sort contacts by cell phone number\\n\"\n                \" 0. Exit\\n\\n\"\n                \"Select an option:&gt; \");\n\n        rtn = scanf (\"%d\", &amp;choice);    /* save scanf return */\n\n        if (rtn == 1 &amp;&amp; 0 &lt;= choice &amp;&amp; choice &lt;= 6) /* good value, break */\n            break;\n        else if (rtn == EOF) {  /* user canceled input, return -1 */\n            fprintf (stderr, \"(user canceled input).\\n\");\n            return -1;\n        }\n        empty_stdin();  /* empty_stdin for rtn = 0 case */\n        fprintf (stderr, \" error: invalid input.\\n\");\n    }\n    empty_stdin();  /* empty_stdin after good value */\n\n    return choice;  /* return choice to user */\n}\n</code></pre>\n\n<p>The C <code>switch</code> function provides <em>case-fallthrough</em> until a <code>break</code> statement is encountered. You can use this to your advantage in your CMS function until you fill all <code>case:</code> statements. You can continue to use fallthrough to handle the <code>0 - exit</code> and handle the <code>EOF</code> (user canceled input) return from <code>menu()</code>, e.g.</p>\n\n<pre><code>void cms (void)\n{\n    for (;;) {          /* loop continually calling menu */\n        int choice = menu();\n        char c;\n        switch (choice) {\n            case 1:\n            case 2:\n            case 3:     /* use case-fallthrough until setup */\n            case 4:\n            case 5:\n            case 6:\n                printf(\"&lt;&lt;&lt; Feature %d is unavailable &gt;&gt;&gt;\\n\", choice);\n                break;\n            case 0:\n                printf (\"exit program [y/n]: \");    /* confirm exit */\n                if (scanf (\" %c\", &amp;c) == EOF) {     /* handle EOF  */\n                    fprintf (stderr, \"(user canceled input).\\n\");\n                    return;\n                }\n                empty_stdin();\n                if (c == 'N' || c == 'n') {     /* handle no exit */\n                    continue;\n                    break;\n                }\n            case -1:        /* fallthrough yes exit or EOF in menu */\n                return;\n                break;\n        }\n    }\n}\n</code></pre>\n\n<p>Putting it altogether, you can create a fairly robust little menu system, e.g.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid empty_stdin (void)\n{\n    for (int c = getchar(); c != '\\n' &amp;&amp; c != EOF; c = getchar()) {}\n}\n\nint menu (void)\n{\n    int rtn, choice;    /* scanf return, menu choice */\n\n    for (;;) {  /* loop until valid input or EOF displaying menu */\n        printf (\"\\nContact Management System\\n\"\n                \"-------------------------\\n\"\n                \" 1. Display contacts\\n\"\n                \" 2. Add a contact\\n\"\n                \" 3. Update a contact\\n\"\n                \" 4. Delete a contact\\n\"\n                \" 5. Search contacts by cell phone number\\n\"\n                \" 6. Sort contacts by cell phone number\\n\"\n                \" 0. Exit\\n\\n\"\n                \"Select an option:&gt; \");\n\n        rtn = scanf (\"%d\", &amp;choice);    /* save scanf return */\n\n        if (rtn == 1 &amp;&amp; 0 &lt;= choice &amp;&amp; choice &lt;= 6) /* good value, break */\n            break;\n        else if (rtn == EOF) {  /* user canceled input, return -1 */\n            fprintf (stderr, \"(user canceled input).\\n\");\n            return -1;\n        }\n        empty_stdin();  /* empty_stdin for rtn = 0 case */\n        fprintf (stderr, \" error: invalid input.\\n\");\n    }\n    empty_stdin();  /* empty_stdin after good value */\n\n    return choice;  /* return choice to user */\n}\n\nvoid cms (void)\n{\n    for (;;) {          /* loop continually calling menu */\n        int choice = menu();\n        char c;\n        switch (choice) {\n            case 1:\n            case 2:\n            case 3:     /* use case-fallthrough until setup */\n            case 4:\n            case 5:\n            case 6:\n                printf(\"&lt;&lt;&lt; Feature %d is unavailable &gt;&gt;&gt;\\n\", choice);\n                break;\n            case 0:\n                printf (\"exit program [y/n]: \");    /* confirm exit */\n                if (scanf (\" %c\", &amp;c) == EOF) {     /* handle EOF  */\n                    fprintf (stderr, \"(user canceled input).\\n\");\n                    return;\n                }\n                empty_stdin();\n                if (c == 'N' || c == 'n') {     /* handle no exit */\n                    continue;\n                    break;\n                }\n            case -1:        /* fallthrough yes exit or EOF in menu */\n                return;\n                break;\n        }\n    }\n}\n\nint main (void) {\n\n    cms();\n    return 0;\n}\n</code></pre>\n\n<p><strong>Example Use/Output</strong></p>\n\n<p>Checking the cases where user cancels input either in <code>menu()</code> or at the <code>exit program [y/n]:</code> prompt by generating a manual <code>EOF</code> with <kbd>Ctrl+d</kbd> (or <kbd>Ctrl+z</kbd> on windoze):</p>\n\n<pre><code>$ ./bin/scanf_menu_cms\n\nContact Management System\n-------------------------\n 1. Display contacts\n 2. Add a contact\n 3. Update a contact\n 4. Delete a contact\n 5. Search contacts by cell phone number\n 6. Sort contacts by cell phone number\n 0. Exit\n\nSelect an option:&gt; (user canceled input).\n\n$ ./bin/scanf_menu_cms\n\nContact Management System\n-------------------------\n 1. Display contacts\n 2. Add a contact\n 3. Update a contact\n 4. Delete a contact\n 5. Search contacts by cell phone number\n 6. Sort contacts by cell phone number\n 0. Exit\n\nSelect an option:&gt; 0\nexit program [y/n]: (user canceled input).\n</code></pre>\n\n<p>All good, now check a normal use case answering No to exit, then Yes:</p>\n\n<pre><code>$ ./bin/scanf_menu_cms\n\nContact Management System\n-------------------------\n 1. Display contacts\n 2. Add a contact\n 3. Update a contact\n 4. Delete a contact\n 5. Search contacts by cell phone number\n 6. Sort contacts by cell phone number\n 0. Exit\n\nSelect an option:&gt; 4\n&lt;&lt;&lt; Feature 4 is unavailable &gt;&gt;&gt;\n\nContact Management System\n-------------------------\n 1. Display contacts\n 2. Add a contact\n 3. Update a contact\n 4. Delete a contact\n 5. Search contacts by cell phone number\n 6. Sort contacts by cell phone number\n 0. Exit\n\nSelect an option:&gt; 0\nexit program [y/n]: n\n\nContact Management System\n-------------------------\n 1. Display contacts\n 2. Add a contact\n 3. Update a contact\n 4. Delete a contact\n 5. Search contacts by cell phone number\n 6. Sort contacts by cell phone number\n 0. Exit\n\nSelect an option:&gt; 0\nexit program [y/n]: y\n</code></pre>\n\n<p>Finally an invalid entry case:</p>\n\n<pre><code>$ ./bin/scanf_menu_cms\n\nContact Management System\n-------------------------\n 1. Display contacts\n 2. Add a contact\n 3. Update a contact\n 4. Delete a contact\n 5. Search contacts by cell phone number\n 6. Sort contacts by cell phone number\n 0. Exit\n\nSelect an option:&gt; My dog has fleas!\n error: invalid input.\n\nContact Management System\n-------------------------\n 1. Display contacts\n 2. Add a contact\n 3. Update a contact\n 4. Delete a contact\n 5. Search contacts by cell phone number\n 6. Sort contacts by cell phone number\n 0. Exit\n\nSelect an option:&gt; -1\n error: invalid input.\n\nContact Management System\n-------------------------\n 1. Display contacts\n 2. Add a contact\n 3. Update a contact\n 4. Delete a contact\n 5. Search contacts by cell phone number\n 6. Sort contacts by cell phone number\n 0. Exit\n\nSelect an option:&gt; 7\n error: invalid input.\n\nContact Management System\n-------------------------\n 1. Display contacts\n 2. Add a contact\n 3. Update a contact\n 4. Delete a contact\n 5. Search contacts by cell phone number\n 6. Sort contacts by cell phone number\n 0. Exit\n\nSelect an option:&gt; 4\n&lt;&lt;&lt; Feature 4 is unavailable &gt;&gt;&gt;\n</code></pre>\n\n<p>While not an error, the standard coding style for C avoids the use of <code>camelCase</code> or <code>MixedCase</code> variable names in favor of all <em>lower-case</em> while reserving <em>upper-case</em> names for use with macros and constants. It is a matter of style -- so it is completely up to you, but failing to follow it can lead to the wrong first impression in some circles.</p>\n"}], "owner": {"reputation": 5, "user_id": 9526242, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49d51d299f471782ede9c0b70cdf141?s=128&d=identicon&r=PG&f=1", "display_name": "zxc20100123", "link": "https://stackoverflow.com/users/9526242/zxc20100123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 596, "favorite_count": 0, "accepted_answer_id": 49398064, "answer_count": 3, "score": 0, "last_activity_date": 1521610903, "creation_date": 1521604352, "last_edit_date": 1521607572, "question_id": 49397889, "link": "https://stackoverflow.com/questions/49397889/call-menu-function-in-another-function", "title": "Call menu function in another function", "body": "<p>I'm trying to call menu function in the main function and let it prompt until the user decides to quit, but seems like it's not giving me response..\nI'm new at this website coding, let me know if there's anything eg. post format I can improve!</p>\n\n<p>clearkeyboard function:</p>\n\n<pre><code>void clearKeyboard(void)\n{\n    int c;\n    while ((c = getchar()) != '\\n' &amp;&amp; c != EOF);\n}\n</code></pre>\n\n<p>The function to call menu:</p>\n\n<pre><code>void ContactManagerSystem(void)\n{\n    int contactchoice;\n    int done = 1;\n    char yesno, c;\n    do {\n        clearKeyboard();\n        contactchoice = menu();\n        switch (contactchoice) {\n        case 1:\n            printf(\"&lt;&lt;&lt; Feature 1 is unavailable &gt;&gt;&gt;\\n\");\n            break;\n        case 2:\n            printf(\"&lt;&lt;&lt; Feature 2 is unavailable &gt;&gt;&gt;\\n\");\n            break;\n        case 3:\n            printf(\"&lt;&lt;&lt; Feature 3 is unavailable &gt;&gt;&gt;\\n\");\n            break;\n        case 4:\n            printf(\"&lt;&lt;&lt; Feature 4 is unavailable &gt;&gt;&gt;\\n\");\n            break;\n        case 5:\n            printf(\"&lt;&lt;&lt; Feature 5 is unavailable &gt;&gt;&gt;\\n\");\n            break;\n        case 6:\n            printf(\"&lt;&lt;&lt; Feature 6 is unavailable &gt;&gt;&gt;\\n\");\n            break;\n        case 0:\n            printf(\"Exit the program? (Y)es/(N)o: \");\n            scanf(\"%c%c\", &amp;yesno, &amp;c);\n            if (yesno == 'Y' || yesno == 'y' &amp;&amp; c == '\\n') {\n                done = 0;\n                break;\n            }\n            else if (yesno == 'N' || yesno == 'n')\n                break;\n        default:\n            break;\n        }\n\n    } while (done == 1);\n}\n</code></pre>\n\n<p>Menu function:</p>\n\n<pre><code>int menu(void)\n{\n    int done = 1;\n    int choice;\n    char c;\n    do {\n        printf(\"Contact Management System\\n\");\n        printf(\"-------------------------\\n\");\n        printf(\"1. Display contacts\\n\");\n        printf(\"2. Add a contact\\n\");\n        printf(\"3. Update a contact\\n\");\n        printf(\"4. Delete a contact\\n\");\n        printf(\"5. Search contacts by cell phone number\\n\");\n        printf(\"6. Sort contacts by cell phone numbe\\n\");\n        printf(\"0. Exit\\n\\n\");\n        printf(\"Select an option:&gt; \");\n        int rtn = scanf(\"%d%c\", &amp;choice, &amp;c);\n\n        if (rtn == EOF || rtn == 0 || c != '\\n')\n            clearKeyboard();\n        else if (choice &gt;= 0 &amp;&amp; choice &lt;= 6 &amp;&amp; c == '\\n')\n            done = 0;\n        else {\n            clearKeyboard();\n            printf(\"*** OUT OF RANGE *** &lt;Enter a number between 0 and 6&gt;: \");\n            scanf(\"%d\", &amp;choice);\n        }\n    } while (done == 1);\n\n    return choice;\n}\n</code></pre>\n\n<p>Attached image below is where goes wrong, the correct version should do case 1 instead of keep prompt menu again.</p>\n\n<p><strong>Incorrect Part</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/QIuGy.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/QIuGy.png\" alt=\"enter image description here\"></a></p>\n\n<p>Thanks in advance!!!</p>\n"}, {"tags": ["c", "data-structures"], "comments": [{"owner": {"reputation": 13306, "user_id": 162698, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HnjBG.png?s=128&g=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/162698/rob"}, "edited": false, "score": 3, "creation_date": 1521603082, "post_id": 49397665, "comment_id": 85796997, "body": "You will watch your language, please."}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 3, "creation_date": 1521603240, "post_id": 49397665, "comment_id": 85797034, "body": "I removed the part about how your course sucks because it&#39;s not relevant to your question. What is left is essentially &quot;here&#39;s my code, why doesn&#39;t it work?&quot;. You will be more likely to get a helpful answer if you explain what you&#39;ve already done to narrow down the problem."}, {"owner": {"reputation": 15118, "user_id": 7258538, "user_type": "registered", "profile_image": "https://graph.facebook.com/10102111546405895/picture?type=large", "display_name": "Charles Srstka", "link": "https://stackoverflow.com/users/7258538/charles-srstka"}, "edited": false, "score": 0, "creation_date": 1521603757, "post_id": 49397665, "comment_id": 85797149, "body": "I&#39;ve gotta say, it&#39;s going to be great for your academic success once your professor finds this question and clicks on the edit history."}, {"owner": {"reputation": 27, "user_id": 8738859, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gQAu6.jpg?s=128&g=1", "display_name": "TeoPeiShen", "link": "https://stackoverflow.com/users/8738859/teopeishen"}, "edited": false, "score": 0, "creation_date": 1521605575, "post_id": 49397665, "comment_id": 85797616, "body": "She is professor on Udemy website, not my university that decide my grade. That is why I told people not to enroll her course in Udemy."}, {"owner": {"reputation": 2048, "user_id": 4961259, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9b82c25cbde4d52888e6eccc44764b80?s=128&d=identicon&r=PG&f=1", "display_name": "Kami Kaze", "link": "https://stackoverflow.com/users/4961259/kami-kaze"}, "edited": false, "score": 1, "creation_date": 1521621318, "post_id": 49397665, "comment_id": 85804148, "body": "Just showing your code and saying it doesn&#39;t work does make helping you quite hard. You should at least give a brief, structered explanation what the code is doing, so people can understand it faster. Also SO is a Q&amp;A site not &quot;rate your professor&quot; or &quot;talk-s*** -about-other-people.com&quot;. Please keep it professional."}, {"owner": {"reputation": 2048, "user_id": 4961259, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9b82c25cbde4d52888e6eccc44764b80?s=128&d=identicon&r=PG&f=1", "display_name": "Kami Kaze", "link": "https://stackoverflow.com/users/4961259/kami-kaze"}, "edited": false, "score": 0, "creation_date": 1521797110, "post_id": 49397665, "comment_id": 85894073, "body": "Do not change/add to the content of the question. It is unlikly that you will get answers for this because the people moved on. And it will just confuse people in the future who see the question without matching answers."}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 8738859, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gQAu6.jpg?s=128&g=1", "display_name": "TeoPeiShen", "link": "https://stackoverflow.com/users/8738859/teopeishen"}, "edited": false, "score": 0, "creation_date": 1521604261, "post_id": 49397836, "comment_id": 85797266, "body": "I am too dumb. Thanks for help. LOL What a big mistake."}, {"owner": {"reputation": 4598, "user_id": 9264702, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mHczh.jpg?s=128&g=1", "display_name": "Stephen Docy", "link": "https://stackoverflow.com/users/9264702/stephen-docy"}, "reply_to_user": {"reputation": 27, "user_id": 8738859, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gQAu6.jpg?s=128&g=1", "display_name": "TeoPeiShen", "link": "https://stackoverflow.com/users/8738859/teopeishen"}, "edited": false, "score": 0, "creation_date": 1521604323, "post_id": 49397836, "comment_id": 85797288, "body": "It&#39;s the little ones that give the biggest headaches sometimes."}, {"owner": {"reputation": 27, "user_id": 8738859, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gQAu6.jpg?s=128&g=1", "display_name": "TeoPeiShen", "link": "https://stackoverflow.com/users/8738859/teopeishen"}, "edited": false, "score": 0, "creation_date": 1521605646, "post_id": 49397836, "comment_id": 85797639, "body": "The power function got problem with &#39;==&#39; too, but after i fix it, it still cannot count 5^4. but 5^3 is ok. May I know why?"}], "tags": [], "owner": {"reputation": 4598, "user_id": 9264702, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mHczh.jpg?s=128&g=1", "display_name": "Stephen Docy", "link": "https://stackoverflow.com/users/9264702/stephen-docy"}, "is_accepted": false, "score": 2, "last_activity_date": 1521606048, "last_edit_date": 1521606048, "creation_date": 1521604019, "answer_id": 49397836, "question_id": 49397665, "link": "https://stackoverflow.com/questions/49397665/data-structure-in-c-program/49397836#49397836", "title": "Data Structure in C program", "body": "<p>Simple error in you <code>isEmpty()</code> routine :</p>\n\n<pre><code>int isEmpty()\n{\n    printf(\"top is %d\\n\", top);\n    if (top = -1)\n        return 1;\n    else\n        return 0;\n}\n</code></pre>\n\n<p>the error is</p>\n\n<pre><code>if (top = -1)\n</code></pre>\n\n<p>should be</p>\n\n<pre><code>if (top == -1)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2005, "user_id": 9180179, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IHVRQ.jpg?s=128&g=1", "display_name": "Usman", "link": "https://stackoverflow.com/users/9180179/usman"}, "is_accepted": false, "score": 1, "last_activity_date": 1521605612, "creation_date": 1521605612, "answer_id": 49398070, "question_id": 49397665, "link": "https://stackoverflow.com/questions/49397665/data-structure-in-c-program/49398070#49398070", "title": "Data Structure in C program", "body": "<p>You should change the if condition in <strong>isEmpty()</strong> function .</p>\n\n<p>Replace the ,</p>\n\n<pre><code>if(top=-1)\n</code></pre>\n\n<p>by </p>\n\n<pre><code>if(top==-1)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 27, "user_id": 8738859, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gQAu6.jpg?s=128&g=1", "display_name": "TeoPeiShen", "link": "https://stackoverflow.com/users/8738859/teopeishen"}, "edited": false, "score": 0, "creation_date": 1521720778, "post_id": 49401867, "comment_id": 85857820, "body": "I key in your code. 5^3 can count but 5^4 cannot count. I think that declaration of char inside the push and pop function cause the integer up to 125 only can be stored in stack. Change the type of declaration of push and pop function to long int fix that problem. But i dun understand why the operator symbol can be kept in stack even the declaration type is long int. operator symbol is not integer. If you know about that, please explain to me. Thanks a lot."}, {"owner": {"reputation": 2048, "user_id": 4961259, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9b82c25cbde4d52888e6eccc44764b80?s=128&d=identicon&r=PG&f=1", "display_name": "Kami Kaze", "link": "https://stackoverflow.com/users/4961259/kami-kaze"}, "reply_to_user": {"reputation": 27, "user_id": 8738859, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gQAu6.jpg?s=128&g=1", "display_name": "TeoPeiShen", "link": "https://stackoverflow.com/users/8738859/teopeishen"}, "edited": false, "score": 0, "creation_date": 1521728174, "post_id": 49401867, "comment_id": 85863586, "body": "Yes the problem was that your functions had to cut down anything bigger than <code>char</code>. But I really don&#39;t get what you are trying to say/ask now."}, {"owner": {"reputation": 27, "user_id": 8738859, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gQAu6.jpg?s=128&g=1", "display_name": "TeoPeiShen", "link": "https://stackoverflow.com/users/8738859/teopeishen"}, "edited": false, "score": 0, "creation_date": 1521773339, "post_id": 49401867, "comment_id": 85885128, "body": "I means the type of the stack is long int stack[MAX]. Although the type is long int ,but the push function can still store the operator symbol (+,-,*,/,%)inside the stack even the operator symbol is not integer."}, {"owner": {"reputation": 2048, "user_id": 4961259, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9b82c25cbde4d52888e6eccc44764b80?s=128&d=identicon&r=PG&f=1", "display_name": "Kami Kaze", "link": "https://stackoverflow.com/users/4961259/kami-kaze"}, "reply_to_user": {"reputation": 27, "user_id": 8738859, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gQAu6.jpg?s=128&g=1", "display_name": "TeoPeiShen", "link": "https://stackoverflow.com/users/8738859/teopeishen"}, "edited": false, "score": 0, "creation_date": 1521791975, "post_id": 49401867, "comment_id": 85891238, "body": "a <code>char</code> is just a an 8bit integer that may get interpreted as a character the mapping of values above 127 is depending on your environment. But generally you could just look it up in an ASCII table. But honestly you should read more about variables and character handling, before you continue."}, {"owner": {"reputation": 27, "user_id": 8738859, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gQAu6.jpg?s=128&g=1", "display_name": "TeoPeiShen", "link": "https://stackoverflow.com/users/8738859/teopeishen"}, "edited": false, "score": 0, "creation_date": 1521795637, "post_id": 49401867, "comment_id": 85893151, "body": "you mean operator symbol(+,-\uff0c*\uff0c/\uff0c%\uff09 is also a type of integer can be represented in ASCII table?"}], "tags": [], "owner": {"reputation": 2048, "user_id": 4961259, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9b82c25cbde4d52888e6eccc44764b80?s=128&d=identicon&r=PG&f=1", "display_name": "Kami Kaze", "link": "https://stackoverflow.com/users/4961259/kami-kaze"}, "is_accepted": true, "score": 1, "last_activity_date": 1521728218, "last_edit_date": 1521728218, "creation_date": 1521622577, "answer_id": 49401867, "question_id": 49397665, "link": "https://stackoverflow.com/questions/49397665/data-structure-in-c-program/49401867#49401867", "title": "Data Structure in C program", "body": "<p>The mistake in is <code>isEmpty()</code> was spotted correctly before. <code>if (top = -1)</code> -> <code>if (top == -1)</code></p>\n\n<p>As you have commented yourself the same problem occurs in <code>pow()</code> at two points,</p>\n\n<pre><code>if (a = 0)\n    return 1;\nelse if (a = 1)\n    return b;\n</code></pre>\n\n<p>should be</p>\n\n<pre><code>if (a == 0)\n    return 1;\nelse if (a == 1)\n    return b;\n</code></pre>\n\n<p>but the second check is superflous as you it is covered by the part below if you modify it a bit, fix the error about higher powers (every iteration gave you the square of the last)  and return something if <code>a</code> is negative:</p>\n\n<pre><code>int power(int b,int a)\n{\n    int i = 1;\n    int c = b;\n    if (a == 0)\n        return 1;\n    else if (a &gt;= 1)\n    {\n        for (i=1; i&lt;a; i++)\n            c *= b; // meaning c = c * b;\n        return c;\n    }\n    else\n        return -1;\n}\n</code></pre>\n\n<p>I would also suggest that if you check for upper and lower bounds you don't check for equality with the value next to the bound but with <code>&lt;</code> and <code>&gt;</code> on the bound. <br>So if by some circumstance (maybe in a more complex program or if you use float) you don't hit the value next to the bound exactly you still abort the operation.</p>\n\n<p>if <code>(top == -1)</code> -> <code>if (top &lt; 0)</code></p>\n"}], "owner": {"reputation": 27, "user_id": 8738859, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gQAu6.jpg?s=128&g=1", "display_name": "TeoPeiShen", "link": "https://stackoverflow.com/users/8738859/teopeishen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "closed_date": 1521623712, "accepted_answer_id": 49401867, "answer_count": 3, "score": -9, "last_activity_date": 1521728218, "creation_date": 1521602965, "last_edit_date": 1521720984, "question_id": 49397665, "link": "https://stackoverflow.com/questions/49397665/data-structure-in-c-program", "closed_reason": "Needs more focus", "title": "Data Structure in C program", "body": "<p>I need help because one of the programs that I created would not run and I don't know why. My instructor ignored my question. The problem of the program is that the operator is missing when transferring the infix to postfix. Thanks in advance. By the way, I noticed that the declaration type of stack is long int. But i dun know why the operator symbol can be kept inside the stack even though the operator symbol is not integer. If someone knew about this, please help me. Thanks again.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n#include&lt;string.h&gt;\n\n#define MAX 100\n\nvoid infixToPostfix(char infix[], char postfix[]);\nlong int evaluatePostfix(char postfix[]);\nint precedence(char symbol);\nint power(int b, int a);\n\nlong int stack[MAX];\nint top = -1;\nvoid push(char symbol);\nchar pop();\nint isEmpty();\n\nmain()\n{\n    char infix[MAX], postfix[MAX];\n\n    printf(\"Enter infix expression: \");\n    gets(infix);\n\n    infixToPostfix(infix, postfix);\n    printf(\"Postfix expression is : %s\\n\", postfix);\n    printf(\"Value of expression : %ld\\n\", evaluatePostfix(postfix));\n}\n\nvoid infixToPostfix(char infix[], char postfix[])\n{\n    unsigned int i, p;\n    char next, symbol;\n\n    p = 0;\n    for (i=0; i&lt;strlen(infix); i++)\n    {\n        symbol = infix[i];\n\n        if (symbol == ' ' || symbol == '\\t')/*ignore blanks and tabs*/\n            continue;\n\n        switch(symbol)\n        {\n            case '(':\n                push(symbol);\n                break;\n            case ')':\n                while ((next = pop()) != '(')\n                postfix[p++] = next;\n                break;\n            case '+':\n            case '-':\n            case '*':\n            case '/':\n            case '%':\n            case '^':\n                while (!isEmpty() &amp;&amp; precedence(stack[top]) &gt;= precedence(symbol))\n                postfix[p++] = pop();\n                push(symbol);\n                break;\n            default:/*operand*/\n                postfix[p++] = symbol;\n        }\n    }\n    while (!isEmpty())\n    postfix[p++] = pop();\n    postfix[p] = '\\0';/*Add '\\0' to make postfix a string*/\n}\n\nint precedence(char symbol)\n{\n    switch(symbol)\n    {\n        case '(':\n            return 0;\n        case '+':\n        case '-':\n            return 1;\n        case '*':\n        case '/':\n        case '%':\n            return 2;\n        case '^':\n            return 3;\n        default:\n            return 0;\n    }\n}\n\nlong int evaluatePostfix(char postfix[])\n{\n    long int x, y, result;\n    unsigned int i;\n    for (i=0; i&lt;strlen(postfix); i++)\n    {\n        if (postfix[i] &lt;= '9' &amp;&amp; postfix[i] &gt;= '0')\n            push(postfix[i]-'0');\n        else\n        {\n            x = pop();\n            y = pop();\n            switch(postfix[i])\n            {\n                case '+':\n                    push(y+x);\n                    break;\n                case '-':\n                    push(y-x);\n                    break;\n                case '*':\n                    push(y*x);\n                    break;\n                case '/':\n                    push(y/x);\n                    break;\n                case '%':\n                    push(y%x);\n                    break;\n                case '^':\n                    push(power(y,x));\n            }\n        }\n    }\n    result = pop();\n    return result;\n}\n\n\n\nint power(int b,int a)\n{\n    int i = 1;\n    if (a = 0)\n        return 1;\n    else if (a = 1)\n        return b;\n    else if (a &gt; 1)\n    {\n        for (i=1; i&lt;a; i++)\n            b = b * b;  \n        return b;\n    }\n\n}\nvoid push(char symbol)\n{\n    if (top == MAX-1)\n    {\n        printf(\"Stack Overflow\\n\");\n        return;\n    }\n    top = top + 1;\n    stack[top] = symbol;\n}\n\nchar pop()\n{\n    char x;\n    if (isEmpty())\n    {\n        printf(\"stack Underflow\\n\");\n        exit(1);\n    }\n    x = stack[top];\n    top = top - 1;\n    return x;\n}\n\nint isEmpty()\n{\n    if (top = -1)\n        return 1;\n    else\n        return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "sockets", "tcp"], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 4644877, "user_type": "registered", "profile_image": "https://graph.facebook.com/947423041943747/picture?type=large", "display_name": "L&#237;sias de Castro", "link": "https://stackoverflow.com/users/4644877/l%c3%adsias-de-castro"}, "edited": false, "score": 0, "creation_date": 1521605189, "post_id": 49397855, "comment_id": 85797512, "body": "Thank you very much. I am going to try it here. :)"}], "tags": [], "owner": {"reputation": 56858, "user_id": 131930, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/91536fe27d32713b8a154a0bf42f6748?s=128&d=identicon&r=PG", "display_name": "Jeremy Friesner", "link": "https://stackoverflow.com/users/131930/jeremy-friesner"}, "is_accepted": false, "score": 1, "last_activity_date": 1521606148, "last_edit_date": 1521606148, "creation_date": 1521604148, "answer_id": 49397855, "question_id": 49397664, "link": "https://stackoverflow.com/questions/49397664/change-listen-to-nonblock-mode-in-c/49397855#49397855", "title": "change listen to nonblock mode in c", "body": "<p>First, a quick clarification -- it isn't <code>listen()</code> that will block, but rather <code>accept()</code>.  <code>listen()</code> simply lets the operating system know that you would like that socket to be able to accept incoming TCP connections in the future; so there is no reason for it to ever block.</p>\n\n<p>Second, to make <code>accept()</code> non-blocking, you'll need to first make the socket you are calling <code>accept()</code> on non-blocking -- the info on how to do that is available <a href=\"https://stackoverflow.com/questions/1543466/how-do-i-change-a-tcp-socket-to-be-non-blocking/1549344#1549344\">here</a>.</p>\n\n<p>Once you've done that, instead of not returning until an incoming TCP connection has been detected, <code>accept()</code> will return -1 and set errno to <code>EWOULDBLOCK</code> if there is no TCP connection already waiting for it... so in order to know when it's appropriate to call <code>accept()</code> on the socket, you can include the socket in your read fd-set in your select() call.  The accept-socket will signal ready-for-read whenever an incoming TCP connection is present and it's time to call accept() to handle it.</p>\n"}], "owner": {"reputation": 19, "user_id": 4644877, "user_type": "registered", "profile_image": "https://graph.facebook.com/947423041943747/picture?type=large", "display_name": "L&#237;sias de Castro", "link": "https://stackoverflow.com/users/4644877/l%c3%adsias-de-castro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1521608900, "creation_date": 1521602956, "last_edit_date": 1521608900, "question_id": 49397664, "link": "https://stackoverflow.com/questions/49397664/change-listen-to-nonblock-mode-in-c", "title": "change listen to nonblock mode in c", "body": "<p>I am trying to implement a socket library. It was all doing ok, until I reach accept function. I looked into the stack overflow, and I guy said it won't return until a client is being connected through this but if it is not in blockmode. So, I would like to know: HOW TO CHANGE LISTEN TO NONBLOCK mode?</p>\n\n<p>Here is my header:</p>\n\n<pre><code>#ifndef NET_SOCKET_H\n#define NET_SOCKET_H\n\n#ifdef __cplusplus\nextern \"C\" {\n#endif\n\n#if defined(WIN32) || defined(WINDOWS_XP)\n#include &lt;winsock2.h&gt;\n#endif\n\n#include &lt;type-of/include/type.h&gt;\n#include &lt;unistd.h&gt;\n\n#define NET_SOCK_ALLOCATED 1\n\n    typedef struct NetSocket NET_SOCK;\n    typedef struct sockaddr_in NET_ADDR_IN;\n    typedef struct sockaddr NET_ADDR;\n\n    struct NetSocket {\n\n        struct {\n            B32 sys; // PF_INET or PF_UNIX\n            B32 data; // SOCK_STREAM or SOCK_DGRAM\n            B32 mode; // IPPROTO_TCP or IPPROTO_UDP\n        } from;\n#if defined(WIN32) || defined(WINDOWS_XP)\n        SOCKET sock;\n#else\n        B32 sock;\n#endif\n        B8 * host;\n        NET_ADDR_IN to;\n        BIT status;\n        STATUS(*open)(NET_SOCK * net);\n        STATUS(*tie)(NET_SOCK * server);\n        STATUS(*wait)(NET_SOCK * net, B32 max);\n        STATUS(*join)(NET_SOCK * server, NET_SOCK * client);\n        STATUS(*in)(NET_SOCK * client);\n        void (*close)(NET_SOCK * net);\n        void (*pop)(NET_SOCK * net);\n    };\n\n    NET_SOCK net_sock_std(B8U * host, B32U port);\n    NET_SOCK * net_sock_push(B8U * host, B32U port);\n    void net_sock_zero(NET_SOCK * net);\n    STATUS net_sock_open(NET_SOCK * net);\n    STATUS net_sock_tie(NET_SOCK * server);\n    STATUS net_sock_wait(NET_SOCK * net, B32 max);\n    STATUS net_sock_join(NET_SOCK * server, NET_SOCK * client);\n    STATUS net_sock_in(NET_SOCK * client);\n    STATUS net_sock_put(NET_SOCK * net);\n    void net_sock_close(NET_SOCK * net);\n    void net_sock_pop(NET_SOCK * net);\n\n    void winsock_start();\n    void winsock_stop();\n\n\n#ifdef __cplusplus\n}\n#endif\n\n#endif /* NET_SOCKET_H */\n</code></pre>\n\n<p>Here is my source:</p>\n\n<pre><code>#include \"net_socket.h\"\n\nvoid net_sock_function(NET_SOCK * net){\n    if(net){\n        net-&gt;open = net_sock_open;\n        net-&gt;tie = net_sock_tie;\n        net-&gt;wait = net_sock_wait;\n        net-&gt;join = net_sock_join;\n        net-&gt;in = net_sock_in;\n        net-&gt;close = net_sock_close;\n        net-&gt;pop = net_sock_pop;\n    }\n}\n\nNET_SOCK net_sock_std(B8U * host, B32U port){\n    NET_SOCK net;\n    net_sock_zero(&amp;net);\n    if(host)net.host = strdup(host);\n    if(port)net.to.sin_port = htons(port);\n    bit_off(&amp;net.status,NET_SOCK_ALLOCATED);\n    return(net);\n}\n\nNET_SOCK * net_sock_push(B8U * host, B32U port){\n    NET_SOCK * net = malloc(sizeof(NET_SOCK));\n    net_sock_zero(net);\n    if(host)net-&gt;host = strdup(host);\n    if(port)net-&gt;to.sin_port = htons(port);\n    bit_on(&amp;net-&gt;status,NET_SOCK_ALLOCATED);\n    return(net);\n}\n\nvoid net_sock_zero(NET_SOCK * net){\n    if(net){\n        winsock_start();\n        net-&gt;from.data = SOCK_STREAM;\n        net-&gt;from.mode = IPPROTO_TCP;\n        if(is_win()){\n            net-&gt;from.sys = AF_INET;\n            net-&gt;to.sin_family = AF_INET;\n        }\n        else {\n            net-&gt;from.sys = AF_UNIX;\n            net-&gt;to.sin_family = AF_UNIX;\n        }\n        net-&gt;sock = -1;\n        net-&gt;host = NULL;\n        net-&gt;to.sin_addr.s_addr = htonl(INADDR_ANY);\n        net-&gt;to.sin_port = 0;\n        net_sock_function(net);\n    }\n}\n\nSTATUS net_sock_open(NET_SOCK * net){\n    if(!net)return(Off);\n    if( (net-&gt;sock = socket(net-&gt;from.sys,net-&gt;from.data,net-&gt;from.mode)) != -1)return(On);\n    return(Off);\n}\n\nSTATUS net_sock_tie(NET_SOCK * server){\n    if(!server)return(Off);\n    if(bind(server-&gt;sock,(NET_ADDR*)&amp;server-&gt;to,sizeof(server-&gt;to)) != -1)return(On);\n    return(Off);\n}\n\nSTATUS net_sock_wait(NET_SOCK * net, B32 max){\n    if(!net)return(Off);\n    if(listen(net-&gt;sock,max) != -1)return(On);\n    return(Off);\n}\n\nSTATUS net_sock_join(NET_SOCK * server,NET_SOCK * client){\n    if(!server || !client)return(Off);\n    B32U clientLen = sizeof(client-&gt;to);\n    while((client-&gt;sock = accept(server-&gt;sock,(NET_ADDR *)&amp;client-&gt;to,&amp;clientLen)) == -1)return(On);\n    return(Off);\n}\n\nSTATUS net_sock_in(NET_SOCK * client){\n    if(!client)return(Off);\n    if(connect(client-&gt;sock,(NET_ADDR *)&amp;client-&gt;to,sizeof(client-&gt;to)) != -1)return(On);\n    return(Off);\n}\n\nSTATUS net_sock_put(NET_SOCK * net){\n    if(!net)return(Off);\n\n    return(Off);\n}\n\nvoid net_sock_close(NET_SOCK * net){\n    if(is_win())closesocket(net-&gt;sock);\n    else close(net-&gt;sock);\n}\n\nvoid net_sock_pop(NET_SOCK * net){\n    if(net){\n        if(net-&gt;host){\n            free(net-&gt;host);\n            net-&gt;host = NULL;\n        }\n        if(bit_is_on(net-&gt;status,NET_SOCK_ALLOCATED)){\n            free(net);\n            net = NULL;\n        }\n    }\n}\n\nvoid winsock_start() {\n    if (is_win()) {\n        WORD versionWanted = MAKEWORD(1, 1);\n        WSADATA wsaData;\n        WSAStartup(versionWanted, &amp;wsaData);\n        atexit(winsock_stop);\n    }\n}\n\nvoid winsock_stop() {\n    if (is_win()) {\n        WSACleanup();\n    }\n}\n</code></pre>\n\n<p>And finally my main:</p>\n\n<pre><code>#include \"net_socket.h\"\n\nvoid command_line(B32 c, B8 ** v, B8U ** host, B32U * port) {\n    B32 i = 1;\n    while (i &lt; c) {\n        switch (i) {\n        case 1:\n        {\n            *port = atoi(v[i]);\n        }\n            break;\n        case 2:\n        {\n            *host = v[i];\n        }\n            break;\n        }\n        i++;\n    }\n}\n\nint main(int argc, char** argv) {\n    B8U * host = NULL;\n    B32U port = 50;\n    command_line(argc, argv, &amp;host, &amp;port);\n    NET_SOCK server = net_sock_std(NULL, port);\n    if (server.open(&amp;server)) {\n        if (!host) {\n            NET_SOCK client = net_sock_std(\"localhost\", port);\n            printf(\"server openned in %hu\\n\", server.to.sin_port);\n            if (client.open(&amp;client)) {\n                printf(\"Server client openned in %hu\", client.to.sin_port);\n            }\n\n            if (server.tie(&amp;server) &amp;&amp; server.wait(&amp;server, 1)){\n                printf(\"\\nready\\n\");\n            }\n\n            while (server.join(&amp;server, &amp;client)){ // I can't get in search mode\n                printf(\"searching\\n\");\n            }\n            client.pop(&amp;client);\n\n        } else {\n            NET_SOCK client = net_sock_std(host, port);\n            if (client.open(&amp;client)) {\n                printf(\"client openned in %s %hu\\n\", host, client.to.sin_port);\n                while (!client.in(&amp;client)) {\n                    printf(\"trying to connect\\n\");\n                }\n                printf(\"bye server\\n\");\n            }\n        }\n        server.close(&amp;server);\n    }\n    server.pop(&amp;server);\n    return (EXIT_SUCCESS);\n}\n</code></pre>\n\n<p>With the help of my friend Jeremy I found: (IT IS JUST TO SET SERVER SOCK TO OFF)</p>\n\n<pre><code>STATUS net_lock_socket(NET_SOCK * net, STATUS block) {\n    if (!net || net-&gt;sock &lt; 0) return Off;\n#if defined(WIN32)\n        unsigned long mode = block ? 0 : 1;\n        return (ioctlsocket(net-&gt;sock, FIONBIO, &amp;mode) == 0) ? On : Off;\n#else\n        int flags = fcntl(net-&gt;sock, F_GETFL, 0);\n        if (flags == -1) return Off;\n        flags = block ? (flags &amp; ~O_NONBLOCK) : (flags | O_NONBLOCK);\n        return (fcntl(net-&gt;sock, F_SETFL, flags) == 0) ? On : Off;\n#endif\n}\n</code></pre>\n"}, {"tags": ["c", "algorithm", "lcs"], "comments": [{"owner": {"reputation": 52185, "user_id": 1782792, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7e8dde1ee800b9687983617bbea3cb9b?s=128&d=identicon&r=PG&f=1", "display_name": "jdehesa", "link": "https://stackoverflow.com/users/1782792/jdehesa"}, "edited": false, "score": 0, "creation_date": 1521630140, "post_id": 49397622, "comment_id": 85810033, "body": "Not a pathetic question (better than many first-timers anyway), but maybe you could describe what you mean exactly by &quot;longest common subsequence&quot; and give a couple of examples of program inputs and expected outputs (I mean according to the usual definition of longest-common subsequence, for the input <code>jdbac,abjac</code> the output should be <code>ac</code>, right?)."}, {"owner": {"reputation": 7290, "user_id": 4785110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1bae5c00f27770d807c943268438bb6?s=128&d=identicon&r=PG&f=1", "display_name": "maraca", "link": "https://stackoverflow.com/users/4785110/maraca"}, "reply_to_user": {"reputation": 52185, "user_id": 1782792, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7e8dde1ee800b9687983617bbea3cb9b?s=128&d=identicon&r=PG&f=1", "display_name": "jdehesa", "link": "https://stackoverflow.com/users/1782792/jdehesa"}, "edited": false, "score": 2, "creation_date": 1521631337, "post_id": 49397622, "comment_id": 85810853, "body": "@jdehesa you are confusing substring (consecutive characters in order) and subsequence (characters in order but don&#39;t have to be consecutive). So [jac, bac] are the correct answers for [jdbac, abjac]."}, {"owner": {"reputation": 52185, "user_id": 1782792, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7e8dde1ee800b9687983617bbea3cb9b?s=128&d=identicon&r=PG&f=1", "display_name": "jdehesa", "link": "https://stackoverflow.com/users/1782792/jdehesa"}, "reply_to_user": {"reputation": 7290, "user_id": 4785110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1bae5c00f27770d807c943268438bb6?s=128&d=identicon&r=PG&f=1", "display_name": "maraca", "link": "https://stackoverflow.com/users/4785110/maraca"}, "edited": false, "score": 0, "creation_date": 1521632118, "post_id": 49397622, "comment_id": 85811419, "body": "@maraca I see, you&#39;re right, thanks (and hence I was thinking of the longest-common substring problem). I have the impression &quot;subsequence&quot; is frequently misused instead of &quot;substring&quot; in programming (although maybe it feels weird to talk about &quot;substrings&quot; for non-text data, e.g. a sequence of numbers or objects... I&#39;d probably end up saying &quot;contiguous subsequence&quot;, even though it&#39;s the same but longer)."}, {"owner": {"reputation": 811, "user_id": 9493582, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bfI3b.jpg?s=128&g=1", "display_name": "Arndt Jonasson", "link": "https://stackoverflow.com/users/9493582/arndt-jonasson"}, "edited": false, "score": 0, "creation_date": 1521634702, "post_id": 49397622, "comment_id": 85813203, "body": "What does LCD stand for?"}, {"owner": {"reputation": 7290, "user_id": 4785110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1bae5c00f27770d807c943268438bb6?s=128&d=identicon&r=PG&f=1", "display_name": "maraca", "link": "https://stackoverflow.com/users/4785110/maraca"}, "edited": false, "score": 0, "creation_date": 1521635166, "post_id": 49397622, "comment_id": 85813554, "body": "I see the problem, but there is no easy fix for it. You basically have to see that when you do a split if way is 4 and end up on the same 1 next, then it will be the same subsequence. Same with unused letters at the start, there are several ways through them, all representing the same subsequence."}, {"owner": {"reputation": 41, "user_id": 9526113, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1eb264fd8da27e3f56bc10aea479ed48?s=128&d=identicon&r=PG&f=1", "display_name": "GlonPL", "link": "https://stackoverflow.com/users/9526113/glonpl"}, "edited": false, "score": 0, "creation_date": 1521642426, "post_id": 49397622, "comment_id": 85819269, "body": "Oh! I see now, You are right. I have plenty 4&#39;s on the way, that&#39;s probably why it prints more results than necessary. But how to fix it then?"}], "owner": {"reputation": 41, "user_id": 9526113, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1eb264fd8da27e3f56bc10aea479ed48?s=128&d=identicon&r=PG&f=1", "display_name": "GlonPL", "link": "https://stackoverflow.com/users/9526113/glonpl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 257, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1521708557, "creation_date": 1521602666, "last_edit_date": 1521603849, "question_id": 49397622, "link": "https://stackoverflow.com/questions/49397622/recursive-longest-common-subsequence-incorrect-printing", "title": "Recursive longest common subsequence, incorrect printing", "body": "<p>First I'd like to excuse for probably pathetic question. I am writing recursive longest common subsequence program. It usually works fine, but if there are two (or more) equally long results it gets wild. (e.g. jdbac,abjac should give: \"bac, jac\" but instead it prints jac,jac,bac );\nI am using two 2D arrays, first with \"way\", second with lcs lengths.\ncode:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\n#define max 99\nint way[max][max];\nint n, m;\nint PrintLCD(char * subseq1, char * subseq2, int i, int j) {\n  //printf(\"%d %d \\n\",i,j);\n  //printf(\"%d \\n\",way[i][j]);\n  //if(i==0 || j==0)return 0;\n  if (way[i][j] == 1) {\n    PrintLCD(subseq1, subseq2, i - 1, j - 1);\n    printf(\"%c\", subseq1[i]);\n  }\n  if (way[i][j] == 2) {\n    PrintLCD(subseq1, subseq2, i - 1, j);\n  }\n  if (way[i][j] == 3) {\n    PrintLCD(subseq1, subseq2, i, j - 1);\n  }\n  if (way[i][j] == 4) {\n    //printf(\"\\n %d\",way[i][j]);\n    way[i][j] = 2;\n    PrintLCD(subseq1, subseq2, n - 1, m - 1);\n    printf(\"\\n\");\n    PrintLCD(subseq1, subseq2, i, j - 1);\n  }\n  return 0;\n}\n\nint main() {\n\n  /*\n    a   b   d   c\n    0   0   0   0\n  a0    1   1   1   1\n  b0    1   2   2   2\n  c0    1   2   2   3\n  d0    1   2   3   3\n\n  1 3   3   3\n  2 1   3   3\n  2 2   4   1\n  2 2   1   4   \n\n  */\n\n  //1-skos 2-gora 3-lewo 4-gora/lewo\n  //1-\\ 2-up 3-left 4-both\n  int i, j;\n  char A[15], B[15];\n  char subseq1[16] = {'~'};\n  char subseq2[16] = {'~'};\n  printf(\"Podaj pierwszy ciag: \");\n  scanf(\"%s\", A);\n  printf(\"\\nPodaj drugi ciag: \");\n  scanf(\"%s\", B);\n  printf(\"\\n\");\n  strcat(subseq1, A);\n  strcat(subseq2, B);\n  m = strlen(subseq1);\n  n = strlen(subseq2);\n  int C[n][m];\n  for (i = 0; i &lt; m; i++) C[i][0] = 0;\n  for (j = 1; j &lt; n; j++) C[0][j] = 0;\n  for (i = 1; i &lt; m; i++) {\n    for (j = 1; j &lt; n; j++) {\n      if (subseq1[i] == subseq2[j]) {\n        C[i][j] = C[i - 1][j - 1] + 1;\n        way[i][j] = 1;\n      } else if (C[i - 1][j] &gt;= C[i][j - 1]) {\n        C[i][j] = C[i - 1][j];\n        if (C[i - 1][j] == C[i][j - 1]) {\n          way[i][j] = 4;\n        } else {\n          way[i][j] = 2;\n        }\n      } else {\n        C[i][j] = C[i][j - 1];\n        way[i][j] = 3;\n      }\n    }\n  }\n  /*************\n  rekurencja(i.j)\n  jezeli w way ij:\n  4 rekurencja i-1j\n  rekurencja ij-1\n  3 rekurencja i-1j\n  2 rekurencja ij-1\n  1 printf(\"%c\",subseq1[i]);\n  ***********\n  */\n  printf(\"Najdluzszy podciag to: \");\n  PrintLCD(subseq1, subseq2, n - 1, m - 1);\n  printf(\"\\n\");\n  return 0;\n}\n</code></pre>\n\n<p>Thank You in advance.</p>\n"}, {"tags": ["c", "scanf", "stdin"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1521602611, "post_id": 49397593, "comment_id": 85796888, "body": "Your <code>scanf</code> call will <i>never</i> detect extra input. That&#39;s simply not how it works."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1521602631, "post_id": 49397593, "comment_id": 85796892, "body": "On another note, <code>read &gt; 2 || read &lt; 2</code> is the same as <code>read != 2</code>."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1521604091, "post_id": 49397593, "comment_id": 85797223, "body": "Raad a <i>line</i> with <code>fgets()</code>..Then try <code>sscanf(  , &quot;%d%d%d&quot;,...</code> to look for more than 2 elements in a <i>line</i>."}, {"owner": {"reputation": 811, "user_id": 9493582, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bfI3b.jpg?s=128&g=1", "display_name": "Arndt Jonasson", "link": "https://stackoverflow.com/users/9493582/arndt-jonasson"}, "edited": false, "score": 0, "creation_date": 1521642757, "post_id": 49397593, "comment_id": 85819550, "body": "As for your question about EOF: look under RETURN VALUE in the manual page for <code>scanf</code>."}], "owner": {"reputation": 137, "user_id": 8613485, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/9bec138b16f41695902fb305eb6ece2b?s=128&d=identicon&r=PG&f=1", "display_name": "\uc2b9\uae30\uc720", "link": "https://stackoverflow.com/users/8613485/%ec%8a%b9%ea%b8%b0%ec%9c%a0"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 149, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1521602494, "creation_date": 1521602494, "question_id": 49397593, "link": "https://stackoverflow.com/questions/49397593/parsing-exactly-two-elements-from-standard-input-using-scanf", "title": "Parsing exactly two elements from standard input using scanf()", "body": "<p>What I am trying to achieve is to parse exactly 2 elements from stdin using scanf, otherwise print error.</p>\n\n<p>I tried</p>\n\n<pre><code>int read = scanf(\"%d %d\", &amp;width, &amp;height);\nif(read &gt; 2 || read == EOF || read &lt; 2)\n{\n    printf(\"Invalid inputs\\n\");\n    exit(0);\n}\n</code></pre>\n\n<p>But this does not print error for some cases. Although I enter 3 elements, it just read the first 2 elements from stdin, not occurring the error message. How should I occur an error if number of elements is greater than 2?</p>\n\n<p>Also Could someone please tell me what EOF means to scanf()? Wasn't EOF for a function that actually reads a file, not stdin? Are we able to use EOF with scanf()?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["c++", "c", "recursion", "tail-recursion"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 0, "creation_date": 1521601431, "post_id": 49397319, "comment_id": 85796582, "body": "Whatever foo() does has no effect on bar(). If the compiler can optimise bar() for tail recursion it does not (at least in your scenario) have to worry about foo(). Supposed you called printf() - would that prevent tail recursion optimisation?"}, {"owner": {"reputation": 13760, "user_id": 224704, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4c94b60d81fde0361f2daa910a0f9a77?s=128&d=identicon&r=PG", "display_name": "Disillusioned", "link": "https://stackoverflow.com/users/224704/disillusioned"}, "edited": false, "score": 0, "creation_date": 1521601437, "post_id": 49397319, "comment_id": 85796584, "body": "Calling <code>foo()</code> from <code>bar()</code> is not recursion. So I fail to see the relevance."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 1, "creation_date": 1521601615, "post_id": 49397319, "comment_id": 85796633, "body": "The optimisation you are talking about is &quot;tail <b>call</b> optimisation&quot;. Although it is most useful with (mutual) recursion, it is in no way limited to that case."}, {"owner": {"reputation": 106013, "user_id": 633183, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/RHeN9.png?s=128&g=1", "display_name": "Thank you", "link": "https://stackoverflow.com/users/633183/thank-you"}, "reply_to_user": {"reputation": 13760, "user_id": 224704, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4c94b60d81fde0361f2daa910a0f9a77?s=128&d=identicon&r=PG", "display_name": "Disillusioned", "link": "https://stackoverflow.com/users/224704/disillusioned"}, "edited": false, "score": 0, "creation_date": 1521607593, "post_id": 49397319, "comment_id": 85798136, "body": "@CraigYoung read about <a href=\"https://en.wikipedia.org/wiki/Mutual_recursion\" rel=\"nofollow noreferrer\">mutual recursion</a>"}, {"owner": {"reputation": 13760, "user_id": 224704, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4c94b60d81fde0361f2daa910a0f9a77?s=128&d=identicon&r=PG", "display_name": "Disillusioned", "link": "https://stackoverflow.com/users/224704/disillusioned"}, "reply_to_user": {"reputation": 106013, "user_id": 633183, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/RHeN9.png?s=128&g=1", "display_name": "Thank you", "link": "https://stackoverflow.com/users/633183/thank-you"}, "edited": false, "score": 0, "creation_date": 1521612317, "post_id": 49397319, "comment_id": 85799720, "body": "@naomik The question fails to <i>demonstrate</i> mutual recursion in its &#39;minimal example&#39;. (<i>Wishy washy vague hand-wavy expositions about <code>foo()</code> is not a substitute for demonstration.</i>) So: What&#39;s your point? OP doesn&#39;t demonstrate <b><i>any kind of recursion</i></b> with <code>foo()</code>. So I still don&#39;t see the relevance."}, {"owner": {"reputation": 13760, "user_id": 224704, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4c94b60d81fde0361f2daa910a0f9a77?s=128&d=identicon&r=PG", "display_name": "Disillusioned", "link": "https://stackoverflow.com/users/224704/disillusioned"}, "reply_to_user": {"reputation": 106013, "user_id": 633183, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/RHeN9.png?s=128&g=1", "display_name": "Thank you", "link": "https://stackoverflow.com/users/633183/thank-you"}, "edited": false, "score": 0, "creation_date": 1521613092, "post_id": 49397319, "comment_id": 85800046, "body": "@naomik To be clear, tail recursion optimisation can be applied to the code in the question regardless of what&#39;s going on in <code>foo()</code>. If OP wants to ask about tail recursion optimisation with mutual recursion, then the <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> (with emphasis on <b><i>Complete</i></b>) should indicate the mutual recursion under consideration. Otherwise the question is a boundless roulette game of many hypothetical implementations of <code>foo()</code>; making the question far too broad."}], "answers": [{"tags": [], "owner": {"reputation": 42504, "user_id": 1161878, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/0157ddd785dc01e95342e3661d34b42a?s=128&d=identicon&r=PG", "display_name": "Gene", "link": "https://stackoverflow.com/users/1161878/gene"}, "is_accepted": false, "score": 4, "last_activity_date": 1521601558, "creation_date": 1521601558, "answer_id": 49397454, "question_id": 49397319, "link": "https://stackoverflow.com/questions/49397319/is-tail-call-optimization-applicable-to-this-function/49397454#49397454", "title": "Is tail call optimization applicable to this function?", "body": "<p>The term \"tail-recursive\" is a local property of a call site. It's not affected at all by other calls in the same method. </p>\n\n<p>Roughly speaking, a call is tail-recursive if no executable code needs to run between its return and the return of the enclosing method.</p>\n\n<p>Consequently all the calls to <code>bar()</code> in your example are tail-recursive.</p>\n\n<p>But note that if you said</p>\n\n<pre><code>return i % 2 ? bar(i/2) : 1 + bar(3*i + 1);\n</code></pre>\n\n<p>then the first call is tail-recursive, but the second isn't because the addition <code>1 +</code>  must execute after it returns.</p>\n"}, {"tags": [], "owner": {"reputation": 12858, "user_id": 6752050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d5c4caa7ff50e6e492c3957ca20ef6c?s=128&d=identicon&r=PG&f=1", "display_name": "S.M.", "link": "https://stackoverflow.com/users/6752050/s-m"}, "is_accepted": true, "score": 2, "last_activity_date": 1521601570, "creation_date": 1521601570, "answer_id": 49397456, "question_id": 49397319, "link": "https://stackoverflow.com/questions/49397319/is-tail-call-optimization-applicable-to-this-function/49397456#49397456", "title": "Is tail call optimization applicable to this function?", "body": "<blockquote>\n  <p>Is tail recursion optimization applicable to this function?</p>\n</blockquote>\n\n<p>Yes, the tail recursion optimization is applicable in your examples. Please look at assembler <a href=\"https://godbolt.org/g/cSpUZw\" rel=\"nofollow noreferrer\">https://godbolt.org/g/cSpUZw</a> for the second sample. The more progressive optimization applied. Recursion is replaced with a loop.</p>\n\n<pre><code>bar(int):\n  cmp edi, 1\n  jg .L12\n  jmp .L6\n.L15:\n  sar edi\n  cmp edi, 1\n  je .L14\n.L12:\n  test dil, 1\n  jne .L15\n  lea edi, [rdi+1+rdi*2]\n  jmp foo(int)\n.L14:\n  mov eax, 1\n  ret\n.L6:\n  mov eax, edi\n  ret\n</code></pre>\n"}], "owner": {"reputation": 551, "user_id": 7254686, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/51e48e3e7298422d80ea289093732e8d?s=128&d=identicon&r=PG&f=1", "display_name": "Stephen", "link": "https://stackoverflow.com/users/7254686/stephen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 136, "favorite_count": 1, "accepted_answer_id": 49397456, "answer_count": 2, "score": 1, "last_activity_date": 1521725649, "creation_date": 1521600547, "last_edit_date": 1521725649, "question_id": 49397319, "link": "https://stackoverflow.com/questions/49397319/is-tail-call-optimization-applicable-to-this-function", "title": "Is tail call optimization applicable to this function?", "body": "<p>If bar calls bar(i/2) if i is an even integer and bar(3*i + 1) otherwise, the recursive function bar would tail-recursion. </p>\n\n<pre><code>const int bar(const int i) \n{\n  if (i &lt; 2) return i;\n  return i % 2 ? bar(i/2) : bar(3*i + 1);\n}\n</code></pre>\n\n<p>However, what if bar calls either bar or foo, who has a completely different set of local variables from bar? </p>\n\n<pre><code>const int bar(const int i) \n{\n  if (i &lt; 2) return i;\n  return i % 2 ? bar(i/2) : foo(3*i + 1);\n  // where foo is very complicated recursive call that has \n  // 11 different user-defined/primitive type of\n  // local variables that can't be optimized out\n}\n</code></pre>\n\n<p>My understanding is tail recursion optimization will use caller's stack. The caller is already done with its local variables before calling the callee. So, the callee can reuse it. My understanding sounds fine when the caller and callee are the same function(e.g. foo calls foo, bar calls bar). However, if the stack size and layout are totally different, and the callees might be one of multiple different functions with different stack layout, what is going to happen?</p>\n\n<p>Firstly, would it be tail recursion? (Now, I understand that tail \"call\" optimization might be applied to but not this is not tail \"recursion.\") Secondly, major compilers such as gcc, clang, etc, would optimize this kind of tail calls? (The answer seems yes.) </p>\n\n<p>What if the callee (foo in the second code example) is much more complicated? If the callee and caller are calling each other (mutual recursion), is the call in my second code example would be tail-call-optimized? If the callee (e.g. foo) is a complicated recursive call that is definitely not a tail recursion and very hard for a compiler to reduce it to a loop or so, would it be still tail-call-optimized? </p>\n"}, {"tags": ["c", "scheme", "racket", "transformation", "interpreter"], "comments": [{"owner": {"reputation": 15758, "user_id": 90559, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c9ca8274294ea39ea6d92617be7cb9bb?s=128&d=identicon&r=PG", "display_name": "John Clements", "link": "https://stackoverflow.com/users/90559/john-clements"}, "edited": false, "score": 4, "creation_date": 1521604321, "post_id": 49397206, "comment_id": 85797285, "body": "You&#39;re using a lot of non-standard library hardware. For instance: what is define-label? What is define-union? BTW, this looks like fun. Whose curriculum is this.... Jay McCarthy&#39;s?"}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1521623365, "post_id": 49397206, "comment_id": 85805395, "body": "What does this have to do with converting to C?"}, {"owner": {"reputation": 1030, "user_id": 5064324, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q6vbb.png?s=128&g=1", "display_name": "ghosh", "link": "https://stackoverflow.com/users/5064324/ghosh"}, "edited": false, "score": 0, "creation_date": 1521741602, "post_id": 49397206, "comment_id": 85872878, "body": "please add definitions for empty-env &amp; empty-k"}], "owner": {"reputation": 95, "user_id": 9526062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5f404c9d5c1c1d36cc58fd4ace94a23?s=128&d=identicon&r=PG&f=1", "display_name": "excessive rice eater", "link": "https://stackoverflow.com/users/9526062/excessive-rice-eater"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 87, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1521599685, "creation_date": 1521599685, "question_id": 49397206, "link": "https://stackoverflow.com/questions/49397206/transform-scheme-interpreter-to-c", "title": "transform scheme interpreter to C", "body": "<p>So I am currently working on a project that requires me to convert my interpreter from scheme to C.</p>\n\n<p>Below is the interpreter I have now after the first step which is \"add the expr define-union to your file, change the match-expression in value-of-cps to instead be a union-case-expression\":</p>\n\n<pre><code>(define-union expr\n  (const cexp)\n  (var n)\n  (if test conseq alt)\n  (mult nexp1 nexp2)\n  (sub1 nexp)\n  (zero nexp)\n  (letcc body)\n  (throw kexp vexp)\n  (let exp body)                  \n  (lambda body)\n  (app rator rand))\n\n(define-label value-of-cps\n  (lambda (expr env k)\n     (union-case k expr\n       [(var n) (apply-env env n k)]\n       [(const cexp) (k cexp)]\n       [(mult nexp1 nexp2) (value-of-cps nexp1 env (lambda (x) (value-of-cps nexp2 env (lambda (x^) (k (* x x^))))))]\n       [(sub1 nexp) (value-of-cps nexp env (lambda (x) (k (sub1 x))))]\n       [(zero nexp) (value-of-cps nexp env (lambda (x) (k (zero? x))))]\n       [(if test conseq alt) (value-of-cps test env (lambda (x) (if x (value-of-cps conseq env k) (value-of-cps alt env k))))]\n       [(letcc body) (value-of-cps body (extend-env k env) k)]\n       [(throw kexp vexp) (value-of-cps kexp env (lambda (x) (value-of-cps vexp env (lambda (x^) (x x^)))))]\n       [(let exp body) (value-of-cps exp env (lambda (x) (value-of-cps body (extend-env x env) k)))]            \n       [(lambda body)  (k (make-closure body env))]\n       [(app rator rand) (value-of-cps rator env (lambda (x) (value-of-cps rand env (lambda (x^) (apply-closure x x^ k)))))])))\n</code></pre>\n\n<p>although, When I try to run this main function with my interpreter:</p>\n\n<pre><code>define main \n  (lambda ()\n    (value-of-cps \n     (expr_let \n      (expr_lambda\n       (expr_lambda \n        (expr_if\n         (expr_zero (expr_var 0))\n          (expr_const 1)\n           (expr_mult (expr_var 0) (expr_app (expr_app (expr_var 1) (expr_var 1)) (expr_sub1 (expr_var 0)))))))\n            (expr_mult\n             (expr_letcc\n              (expr_app\n               (expr_app (expr_var 1) (expr_var 1))\n                (expr_throw (expr_var 0) (expr_app (expr_app (expr_var 1) (expr_var 1)) (expr_const 4)))))\n       (expr_const 5)))\n     (empty-env)\n     (empty-k))))\n</code></pre>\n\n<p>I get an error saying that:</p>\n\n<p>value-of-cps: arity mismatch;\n the expected number of arguments does not match the given number\n  expected: 0\n  given: 3\n  arguments...:</p>\n\n<p>but my interpreter does take 3 arguments.... Please help!! Thank you!</p>\n"}, {"tags": ["c", "bit-manipulation"], "comments": [{"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1521597985, "post_id": 49396937, "comment_id": 85795774, "body": "This book has a strong reputation, but it is very old, and will lead you astray when dealing with modern (post-2005 or so) C compilers."}, {"owner": {"reputation": 145, "user_id": 6511371, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d3389a6b20543f115622b6976cfe6d12?s=128&d=identicon&r=PG&f=1", "display_name": "TheCaptain", "link": "https://stackoverflow.com/users/6511371/thecaptain"}, "reply_to_user": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1521598304, "post_id": 49396937, "comment_id": 85795868, "body": "@zwol what book do you recommend?"}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1521599337, "post_id": 49396937, "comment_id": 85796109, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/43239906/shift-operator-in-c-prepends-ones-instead-of-zeros\">Shift operator in C prepends ones instead of zeros</a>"}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1521652205, "post_id": 49396937, "comment_id": 85826899, "body": "@TheCaptain I regret to say I do not have a recommendation for a newer book.  I learned C a very long time ago myself."}], "answers": [{"comments": [{"owner": {"reputation": 145, "user_id": 6511371, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d3389a6b20543f115622b6976cfe6d12?s=128&d=identicon&r=PG&f=1", "display_name": "TheCaptain", "link": "https://stackoverflow.com/users/6511371/thecaptain"}, "edited": false, "score": 0, "creation_date": 1521597914, "post_id": 49396952, "comment_id": 85795754, "body": "what does the U mean and where can I read more about this topic? The book doesn&#39;t give very good details. There is no U at all."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 145, "user_id": 6511371, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d3389a6b20543f115622b6976cfe6d12?s=128&d=identicon&r=PG&f=1", "display_name": "TheCaptain", "link": "https://stackoverflow.com/users/6511371/thecaptain"}, "edited": false, "score": 0, "creation_date": 1521597952, "post_id": 49396952, "comment_id": 85795763, "body": "@TheCaptain: A <code>U</code> suffix on an integer constant means that it&#39;s of an unsigned type, in this case specifically <code>unsigned int</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user9522315"}, "reply_to_user": {"reputation": 145, "user_id": 6511371, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d3389a6b20543f115622b6976cfe6d12?s=128&d=identicon&r=PG&f=1", "display_name": "TheCaptain", "link": "https://stackoverflow.com/users/6511371/thecaptain"}, "edited": false, "score": 0, "creation_date": 1521598085, "post_id": 49396952, "comment_id": 85795806, "body": "@TheCaptain I think <a href=\"http://en.cppreference.com/w/c/language/operator_arithmetic#Shift_operators\" rel=\"nofollow noreferrer\">C++ Reference</a> is a good site for reference. Look up that link and you&#39;ll find a detailed description about shift operators."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 1, "creation_date": 1521598194, "post_id": 49396952, "comment_id": 85795831, "body": "Right-shifting a negative signed integer yields an implementation-defined result."}, {"owner": {"user_type": "does_not_exist", "display_name": "user9522315"}, "reply_to_user": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1521598562, "post_id": 49396952, "comment_id": 85795918, "body": "@KeithThompson I realized that. See if the edit makes sense now."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1521599826, "post_id": 49396952, "comment_id": 85796239, "body": "Note that with 32-bit <code>int</code> and <code>n==0</code>, <code>int mask = ~0U &gt;&gt; n;</code> results in more implementation defined behavior of assigning an out-of-range <code>unsigned</code> to an <code>int</code>.  Using <i>unsigned</i> types with shifts is much less complicated."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user9522315"}, "is_accepted": false, "score": 3, "last_activity_date": 1521600693, "last_edit_date": 1521600693, "creation_date": 1521597548, "answer_id": 49396952, "question_id": 49396937, "link": "https://stackoverflow.com/questions/49396937/cant-shift-negative-numbers-to-the-right-in-c/49396952#49396952", "title": "can&#39;t shift negative numbers to the right in c", "body": "<p>Right-shifting negative signed integers is an implementation-defined behavior, which is usually (but not always) filling the left with ones instead of zeros. That's why no matter how many bits you've shifted, it's always -1, as the left is always filled by ones.</p>\n\n<p>When you shift unsigned integers, the left will always be filled by zeros. So you can do this:</p>\n\n<pre><code>unsigned int mask = ~0U &gt;&gt; n;\n                      ^\n</code></pre>\n\n<p>You should also note that <code>int</code> is typically 2 or 4 bytes, meaning if you want to get 15, you need to right-shift 12 or 28 bits instead of only 4. You can use a <code>char</code> instead:</p>\n\n<pre><code>unsigned char mask = ~0U;\nmask &gt;&gt;= 4;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 29848, "user_id": 5958455, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lBWIE.png?s=128&g=1", "display_name": "iBug", "link": "https://stackoverflow.com/users/5958455/ibug"}, "edited": false, "score": 0, "creation_date": 1521598146, "post_id": 49396971, "comment_id": 85795823, "body": "Your change makes sense now :-)"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 1, "creation_date": 1521598256, "post_id": 49396971, "comment_id": 85795856, "body": "Right-shifting a negative signed integer yields an implementation-defined result."}], "tags": [], "owner": {"reputation": 115745, "user_id": 119527, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lTjBL.png?s=128&g=1", "display_name": "Jonathon Reinhart", "link": "https://stackoverflow.com/users/119527/jonathon-reinhart"}, "is_accepted": false, "score": 2, "last_activity_date": 1521598299, "last_edit_date": 1521598299, "creation_date": 1521597746, "answer_id": 49396971, "question_id": 49396937, "link": "https://stackoverflow.com/questions/49396937/cant-shift-negative-numbers-to-the-right-in-c/49396971#49396971", "title": "can&#39;t shift negative numbers to the right in c", "body": "<p>In C, and many other languages, <code>&gt;&gt;</code> is (usually) an <a href=\"https://en.wikipedia.org/wiki/Arithmetic_shift\" rel=\"nofollow noreferrer\"><em>arithmetic</em> right shift</a> when performed on <em>signed</em> variables (like <code>int</code>). This means that the new bit shifted in from the left is a copy of the previous most-significant bit (MSB). This has the effect of preserving the sign of a two's compliment negative number (and in this case the value).</p>\n\n<p>This is in contrast to a <a href=\"https://en.wikipedia.org/wiki/Logical_shift\" rel=\"nofollow noreferrer\"><em>logical</em> right shift</a>, where the MSB is always replaced with a zero bit. This is applied when your variable is <em>unsigned</em> (e.g. <code>unsigned int</code>).</p>\n\n<p>From Wikipeda:</p>\n\n<blockquote>\n  <p>The >> operator in C and C++ is not necessarily an arithmetic shift. Usually it is only an arithmetic shift if used with a signed integer type on its left-hand side. If it is used on an unsigned integer type instead, it will be a logical shift.</p>\n</blockquote>\n\n<p>In your case, if you plan to be working at a bit level (i.e. using masks, etc.) I would strongly recommend two things:</p>\n\n<ol>\n<li>Use unsigned values.</li>\n<li>Use types with specific sizes from <code>&lt;stdint.h&gt;</code> like <code>uint32_t</code></li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 1, "creation_date": 1521598136, "post_id": 49396997, "comment_id": 85795821, "body": "More precisely, it yields an implementation-defined value. <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf\" rel=\"nofollow noreferrer\">N1570</a> 6.5.7p5. (Implementation-defined <i>behavior</i> could permit it to do something other than yielding a value.)"}, {"owner": {"reputation": 145, "user_id": 6511371, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d3389a6b20543f115622b6976cfe6d12?s=128&d=identicon&r=PG&f=1", "display_name": "TheCaptain", "link": "https://stackoverflow.com/users/6511371/thecaptain"}, "edited": false, "score": 0, "creation_date": 1521599469, "post_id": 49396997, "comment_id": 85796141, "body": "implementation-defined values are unpredictable values?"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 145, "user_id": 6511371, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d3389a6b20543f115622b6976cfe6d12?s=128&d=identicon&r=PG&f=1", "display_name": "TheCaptain", "link": "https://stackoverflow.com/users/6511371/thecaptain"}, "edited": false, "score": 0, "creation_date": 1521599680, "post_id": 49396997, "comment_id": 85796200, "body": "@TheCaptain Implementation defined means that the C standard doesn&#39;t specify what the values must be, but the specific implementation (i.e. gcc, MSVC, etc.) must document what it does in that case.  If the values were unpredictable, that would be called either <b>indeterminate</b> or <b>unspecified</b> values."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 6, "last_activity_date": 1521598184, "last_edit_date": 1521598184, "creation_date": 1521597991, "answer_id": 49396997, "question_id": 49396937, "link": "https://stackoverflow.com/questions/49396937/cant-shift-negative-numbers-to-the-right-in-c/49396997#49396997", "title": "can&#39;t shift negative numbers to the right in c", "body": "<p>Performing a right shift on a negative value yields an <em>implementation defined</em> value.  Most hosted implementations will shift in <code>1</code> bits on the left, as you've seen in your case, however that doesn't necessarily have to be the case.</p>\n\n<p>Unsigned types as well as positive values of signed types always shift in <code>0</code> bits on the left when shifting right.  So you can get the desired behavior by using unsigned values:</p>\n\n<pre><code>unsigned int mask = ~0u &gt;&gt; n;\n</code></pre>\n\n<p>This behavior is documented in section 6.5.7 of the <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf\" rel=\"noreferrer\">C standard</a>:</p>\n\n<blockquote>\n  <p><em>5</em> The result of <strong>E1 >> E2</strong> is <strong>E</strong>1 right-shifted <strong>E2</strong> bit positions.  If <strong>E1</strong> has an unsigned type or if <strong>E1</strong> has a signed type and a nonnegative\n  value, the value of the result is the integral part  of  the  quotient\n  of <strong>E1 / 2<sup>E2</sup></strong> .If <strong>E1</strong> has  a  signed  type  and  a  negative  value,  the\n  resulting value is implementation-defined.</p>\n</blockquote>\n"}], "owner": {"reputation": 145, "user_id": 6511371, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d3389a6b20543f115622b6976cfe6d12?s=128&d=identicon&r=PG&f=1", "display_name": "TheCaptain", "link": "https://stackoverflow.com/users/6511371/thecaptain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1154, "favorite_count": 0, "answer_count": 3, "score": 3, "last_activity_date": 1521600693, "creation_date": 1521597392, "last_edit_date": 1521598850, "question_id": 49396937, "link": "https://stackoverflow.com/questions/49396937/cant-shift-negative-numbers-to-the-right-in-c", "title": "can&#39;t shift negative numbers to the right in c", "body": "<p>I am going through 'The C language by K&amp;R'. Right now I am doing the bitwise section. I am having a hard time in understanding the following code.</p>\n\n<pre><code>int mask = ~0 &gt;&gt; n;\n</code></pre>\n\n<p>I was playing on using this to mask n left side of another binary like this.\n    0000 1111\n    1010 0101 // random number</p>\n\n<p>My problem is that when I print var mask it still negative -1. Assuming n is 4. I thought shifting ~0 which is -1 will be 15 (0000 1111).</p>\n\n<p>thanks for the answers</p>\n"}, {"tags": ["c", "algorithm", "coin-change"], "comments": [{"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 2, "creation_date": 1521597386, "post_id": 49396902, "comment_id": 85795630, "body": "Use a debugger to step through the code and see where it&#39;s not working as you intend."}, {"owner": {"reputation": 3699, "user_id": 375399, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/2ee1c857b767375e1fc848279f64584b?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/375399/nick"}, "edited": false, "score": 1, "creation_date": 1521597443, "post_id": 49396902, "comment_id": 85795645, "body": "It sounds like you may need to learn how to use a debugger to step through your code.  With a good debugger, you can execute your program line by line and see where it is deviating from what you expect.  This is an essential tool if you are going to do any programming. Further reading: <a href=\"http://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">How to debug small programs</a>"}, {"owner": {"reputation": 25, "user_id": 7366448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b3e95191cad43c1a3eaf9f9098dc0e7?s=128&d=identicon&r=PG&f=1", "display_name": "Linx", "link": "https://stackoverflow.com/users/7366448/linx"}, "edited": false, "score": 1, "creation_date": 1521597785, "post_id": 49396902, "comment_id": 85795728, "body": "I don&#39;t think it is some line in particular that is wrong, but rather the algorithm logic. And I can&#39;t come up with a logic that works 100% of the cases. (I&#39;ve been trying for a long time)"}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1521597934, "post_id": 49396902, "comment_id": 85795755, "body": "As we&#39;ve said, use a debugger to step through the code and see where it&#39;s not working as you intend. A debugger works for you just like it would work for us, and it&#39;s an excellent learning opportunity. It&#39;s never too early to learn to use a debugger, which is one of the most powerful tools a developer has in their toolbox. As far as the logic, grab a piece of paper and pencil and work it through. How do you do it there?"}, {"owner": {"reputation": 895, "user_id": 7418646, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mVlz8.jpg?s=128&g=1", "display_name": "Samantha", "link": "https://stackoverflow.com/users/7418646/samantha"}, "edited": false, "score": 0, "creation_date": 1521599422, "post_id": 49396902, "comment_id": 85796129, "body": "A good solution to the problem will also handle the cases where change cannot be made for the input value (e.g. 15 cents). Also, observe that any value that can be made using 100-cent coins or 50-cent coins can be made using 10-cent coins. So it will be helpful to consider the simpler case of making change from 10-cent coins and 25-cent coins only. The optimizations can come later."}, {"owner": {"reputation": 10042, "user_id": 580412, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/f057f53afd6fffc5075d8d59277cd103?s=128&d=identicon&r=PG", "display_name": "phs", "link": "https://stackoverflow.com/users/580412/phs"}, "edited": false, "score": 0, "creation_date": 1521601486, "post_id": 49396902, "comment_id": 85796591, "body": "This is a common enough example of <a href=\"https://en.wikipedia.org/wiki/Dynamic_programming\" rel=\"nofollow noreferrer\">dynamic programming</a> that it gets its own <a href=\"https://en.wikipedia.org/wiki/Change-making_problem\" rel=\"nofollow noreferrer\">wikipedia article</a>."}, {"owner": {"reputation": 184, "user_id": 4122814, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/57db9a555a5e3bf9b0c7154362f18329?s=128&d=identicon&r=PG&f=1", "display_name": "Mathers", "link": "https://stackoverflow.com/users/4122814/mathers"}, "edited": false, "score": 0, "creation_date": 1521601694, "post_id": 49396902, "comment_id": 85796651, "body": "Does it have to be iterative or it can be recursive?"}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 7366448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b3e95191cad43c1a3eaf9f9098dc0e7?s=128&d=identicon&r=PG&f=1", "display_name": "Linx", "link": "https://stackoverflow.com/users/7366448/linx"}, "edited": false, "score": 0, "creation_date": 1521682990, "post_id": 49397405, "comment_id": 85839859, "body": "Thank you very much! This helped me a lot :)"}], "tags": [], "owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "is_accepted": true, "score": 1, "last_activity_date": 1521601739, "last_edit_date": 1521601739, "creation_date": 1521601199, "answer_id": 49397405, "question_id": 49396902, "link": "https://stackoverflow.com/questions/49396902/coin-change-algorithm-c/49397405#49397405", "title": "Coin Change Algorithm C", "body": "<p>You could use a recursive algorithm along the following steps:</p>\n\n<ul>\n<li>Take 1 100c coin and try to break down the remaining amount into only 50, 25, 10s</li>\n<li>If that didn't work, take 2 100c coins and try to break down the remaining amount into only 50, 25, 10s </li>\n<li>Etc.</li>\n</ul>\n\n<p>If you tried every possibility for the number of 100c coins (including 0!) then you will have covered all possible solutions.</p>\n\n<p>I wrote some demo code. If this is homework then please don't copy-paste my code but maybe write your own code once you understand the ideas involved ...</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdbool.h&gt;\n\nbool coin_find(unsigned int total, unsigned int *denom)\n{\n    if ( total == 0 )\n        return true;    // Success - reduced total remaining to 0\n\n    if ( *denom == 0 )\n        return false;   // Failure - tried all coins in the list with no solution yet\n\n    // Try 0 of the largest coin, then 1, etc.\n    for (unsigned int d = 0; ; ++d)\n    {\n        if ( d * *denom &gt; total )\n            return false;\n\n        if ( coin_find(total - d * *denom, denom + 1) )\n        {\n            if ( d ) \n                printf(\"%ux%uc \", d, *denom);\n            return true;\n        }\n    }\n}\n\nint main(int argc, char **argv)\n{\n    if ( argc &lt; 2 )\n        return EXIT_FAILURE;\n\n    unsigned int denoms[] = { 100, 50, 25, 10, 0 };\n\n    long t = strtol(argv[1], NULL, 10);\n    if ( t &lt; 0 || t &gt;= LONG_MAX )\n        return EXIT_FAILURE;\n\n    if ( !coin_find(t, denoms) )\n        printf(\"No solution found\");\n\n    printf(\"\\n\");\n}\n</code></pre>\n\n<p>Exercises for the reader:</p>\n\n<ol>\n<li>Loop backwards instead of forwards so that we find tidier solutions by default.</li>\n<li>Output only the breakdown with the smallest number of coins.</li>\n<li>Output all possible breakdowns.</li>\n</ol>\n\n<p>Bonus exercise:</p>\n\n<ul>\n<li>Rewrite this to not actually use recursion at all; instead use an array that holds the solution so far, and <em>backtrack</em> when you reach the end. Exercise 3 will actually be easier this way.</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 2015, "user_id": 4586108, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/0srZq.jpg?s=128&g=1", "display_name": "lcastillov", "link": "https://stackoverflow.com/users/4586108/lcastillov"}, "is_accepted": false, "score": 0, "last_activity_date": 1521610635, "creation_date": 1521610635, "answer_id": 49398917, "question_id": 49396902, "link": "https://stackoverflow.com/questions/49396902/coin-change-algorithm-c/49398917#49398917", "title": "Coin Change Algorithm C", "body": "<p>The following solution uses <em>Dynamic Programming</em> and you can use it as long as the value of <code>M</code> (<code>x</code> for you) is small. If <code>prev[j]</code> is different than <code>-1</code> then this means that <code>j</code> can be made with the given coins. <code>coin[j]</code> store the value of the coin used to make <code>j</code>, and <code>prev[j]</code> is the value without using <code>coin[j]</code>. Thus, <code>(j - prev[j]) / coin[j]</code> give us the number of coins of denomination <code>coin[j]</code> used to make weight <code>j</code>.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nconst int\n    COINS = 4;\n\nint M = 1100; \nint prev[10000];\nint coin[10000];\n// Available denominations.\nint value[COINS] = { 10, 25, 50, 100 };\n// Available quantities.\nint quant[COINS] = { 10, 15, 8, 12 };\n// Number of selected coins per denomination.\nint answer[COINS] = { 0, 0, 0, 0 };\n\nint main() {\n    // base case    \n    prev[0] = 0;\n    for (int i = 1; i &lt; 10000; i++)\n        prev[i] = -1;\n\n    // dynamic programming\n    for (int i = 0; i &lt; COINS; i++)\n        for (int j = M; j &gt;= 0; j--)\n            if (prev[j] != -1) {\n                int k = 1;\n                while (k &lt;= quant[i] &amp;&amp; j + k * value[i] &lt;= M) {\n                    if (prev[j + k * value[i]] == -1) {\n                        prev[j + k * value[i]] = j;\n                        coin[j + k * value[i]] = value[i];\n                    }\n                    k++;\n                }\n            }\n\n    // build the answer\n    if (prev[M] != -1) {\n        int current = M;\n        while (current &gt; 0) {\n            int k = 0;\n            while (k &lt; COINS &amp;&amp; coin[current] != value[k])\n                k++;\n            answer[k] += (current - prev[current]) / coin[current];\n            current = prev[current];\n        }\n        printf(\"Change\\n\");\n        for (int i = 0; i &lt; COINS; i++)\n            printf(\"\\t%d %d cent coin(s).\\n\", answer[i], value[i]);\n    } else {\n        printf(\"It was not possible to change the value\");\n    }\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 8572920, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01d1e2ac144f24099be93c378107114a?s=128&d=identicon&r=PG&f=1", "display_name": "Erdal Tufan", "link": "https://stackoverflow.com/users/8572920/erdal-tufan"}, "is_accepted": false, "score": 0, "last_activity_date": 1521620135, "creation_date": 1521620135, "answer_id": 49401188, "question_id": 49396902, "link": "https://stackoverflow.com/questions/49396902/coin-change-algorithm-c/49401188#49401188", "title": "Coin Change Algorithm C", "body": "<p>Because 25%10 is not equal to 0, You need to consider it. Try this algorithm:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nstruct coins{\n    int value;\n    int quant;\n};\n\nint main()\n{\n    int change = 30;\n    int changecoins[4] = {0};\n    struct coins available_coins[4] = { 0 };\n    int temp;\n\n    available_coins[3].value = 10; //10 cents coins\n    available_coins[2].value = 25; //25 cents coins\n    available_coins[1].value = 50;  //50 cents coins\n    available_coins[0].value = 100; //100 cents coins\n\n    //quantity values just for test purposes\n    available_coins[3].quant = 10; //10 cents coins\n    available_coins[2].quant = 15; //25 cents coins\n    available_coins[1].quant = 8;  //50 cents coins\n    available_coins[0].quant = 12; //100 cents coins\n\n\n    if(((change/10 &lt; 2)&amp;&amp;(change%10 != 0)) || (change/10 &gt;= 2)&amp;&amp;((change%10 != 5) &amp;&amp; change%10 != 0)) {\n        printf(\"It was not possible to change the value\\n\");\n        return 0;\n    }\n    else {\n        for(int i=0; i&lt;2; i++){\n            changecoins[i] = change / available_coins[i].value;\n            change = change % available_coins[i].value;\n            if(changecoins[i] &gt;= available_coins[i].quant) {\n                change = change + (changecoins[i] - available_coins[i].quant) * available_coins[i].value;\n                changecoins[i] = available_coins[i].quant;\n            }\n        }\n\n        if(change%10 == 5) {\n            if(available_coins[2].quant &lt; 1) {\n                printf(\"It was not possible to change the value\\n\");\n                return 0;\n            }\n            else {\n                changecoins[2] = change / available_coins[2].value;\n                change = change % available_coins[2].value;\n                if(changecoins[2] &gt;= available_coins[2].quant) {\n                    change = change + (changecoins[2] - available_coins[2].quant) * available_coins[2].value;\n                    changecoins[2] = available_coins[2].quant;\n                }\n                if(change%10 == 5) {\n                    changecoins[2]--;\n                    change = change + available_coins[2].value;\n                }\n            }\n        }\n\n        changecoins[3] = change / available_coins[3].value;\n        change = change % available_coins[3].value;\n        if(changecoins[3] &gt;= available_coins[3].quant) {\n            change = change + (changecoins[3] - available_coins[3].quant) * available_coins[3].value;\n            changecoins[3] = available_coins[3].quant;\n        }\n\n        if(change&gt;0) {\n            printf(\"It was not possible to change the value\\n\");\n        }\n        else {\n            printf(\"Change:\\n\");\n            printf(\"\\t%d 100 cent coin(s).\\n\", changecoins[0]);\n            printf(\"\\t%d 50 cent coin(s).\\n\", changecoins[1]);\n            printf(\"\\t%d 25 cent coin(s).\\n\", changecoins[2]);\n            printf(\"\\t%d 10 cent coin(s).\\n\", changecoins[3]);\n\n            for(int i = 0; i &lt; 4; i++) {\n                available_coins[i].quant -= changecoins[i];\n            }\n        }\n    }\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 7366448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b3e95191cad43c1a3eaf9f9098dc0e7?s=128&d=identicon&r=PG&f=1", "display_name": "Linx", "link": "https://stackoverflow.com/users/7366448/linx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 876, "favorite_count": 0, "accepted_answer_id": 49397405, "answer_count": 3, "score": 2, "last_activity_date": 1521620135, "creation_date": 1521597072, "question_id": 49396902, "link": "https://stackoverflow.com/questions/49396902/coin-change-algorithm-c", "title": "Coin Change Algorithm C", "body": "<p>I'm having some trouble coming up with a working algorithm for the following problem.</p>\n\n<p>Given determined quantities of available coins from 100, 50, 25 and 10 cents, I need to find how to fit a combination of these coins into a given value x. (it doesn't have to be optimal, any combination from availables coins will do).</p>\n\n<p>So far, I've got this code, which works only for some cases.</p>\n\n<pre><code>struct coins{\n    int valor;\n    int quant;\n};\n\nint change = 0;\nint changecoins[4] = {0};\nstruct coins available_coins[4] = { 0 };\n\nmoedas_disp[3].value = 10; //10 cents coins\nmoedas_disp[2].value = 25; //25 cents coins\nmoedas_disp[1].value = 50;  //50 cents coins\nmoedas_disp[0].value = 100; //100 cents coins\n\n//quantity values just for test purposes\nmoedas_disp[3].quant = 10; //10 cents coins\nmoedas_disp[2].quant = 15; //25 cents coins\nmoedas_disp[1].quant = 8;  //50 cents coins\nmoedas_disp[0].quant = 12; //100 cents coins\n\n\nfor(int i=0; i&lt;4; i++){\n    while((change/available_coins[i].value&gt;0)&amp;&amp;(available_coins[i].quant&gt;0)){\n        change -= available_coins[i].value;\n        available_coins[i].quant--;\n        changecoins[i]++;\n    }\n}\nif(change&gt;0){\n    printf(\"It was not possible to change the value\");\n}\nelse{\n    printf(\"Change:\\n\");\n    printf(\"\\t%d 100 cent coin(s).\\n\", changecoins[0]);\n    printf(\"\\t%d 50 cent coin(s).\\n\", changecoins[1]);\n    printf(\"\\t%d 25 cent coin(s).\\n\", changecoins[2]);\n    printf(\"\\t%d 10 cent coin(s).\\n\", changecoins[3]);\n}\n</code></pre>\n\n<p>However for quantities like 30 this won't work. The program will fit 1 coin of 25 cents, but then have 5 cents left, which will fail to compute. This also occurs with 40, 65, and so on.</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["c", "linux", "uclibc", "c-standard-library"], "comments": [{"owner": {"reputation": 1949, "user_id": 7088038, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/590b55e4592cb019a72a3a2a4f847878?s=128&d=identicon&r=PG&f=1", "display_name": "avigil", "link": "https://stackoverflow.com/users/7088038/avigil"}, "edited": false, "score": 0, "creation_date": 1521596956, "post_id": 49396847, "comment_id": 85795525, "body": "what other OSes would you have in mind?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1521597019, "post_id": 49396847, "comment_id": 85795538, "body": "If it is optimized to Linux, it probably uses system calls that are unique to Linux and therefore won\u2019t readily port to other platforms that don\u2019t have full support for all the Linux system calls."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4546925"}, "reply_to_user": {"reputation": 1949, "user_id": 7088038, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/590b55e4592cb019a72a3a2a4f847878?s=128&d=identicon&r=PG&f=1", "display_name": "avigil", "link": "https://stackoverflow.com/users/7088038/avigil"}, "edited": false, "score": 0, "creation_date": 1521597228, "post_id": 49396847, "comment_id": 85795585, "body": "@avigil, I&#39;m writing a POSIX PSE51 compliant OS. To comply with the standard there are lots of C standard library functionalities the OS needs to provide. I don&#39;t want to reinvent the wheel so I&#39;d like to use one of the open source libc&#39;s that exist out there instead of writing my own."}, {"owner": {"reputation": 1949, "user_id": 7088038, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/590b55e4592cb019a72a3a2a4f847878?s=128&d=identicon&r=PG&f=1", "display_name": "avigil", "link": "https://stackoverflow.com/users/7088038/avigil"}, "edited": false, "score": 0, "creation_date": 1521597383, "post_id": 49396847, "comment_id": 85795627, "body": "Linux is &quot;mostly POSIX compliant&quot; which means there will probably be things specific to linux that will break the library"}], "owner": {"user_type": "does_not_exist", "display_name": "user4546925"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 81, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1521596592, "creation_date": 1521596592, "question_id": 49396847, "link": "https://stackoverflow.com/questions/49396847/is-uclibc-only-used-in-linux-based-operating-systems", "title": "Is uClibc only used in Linux based Operating Systems?", "body": "<p>uClibc (or uClibc-ng) is stated as a C library for embedded Linux systems. The documentation cites Linux everywhere and say the library is very carefully optimized for Linux.</p>\n\n<p>Although the library has been specially developed to be used in Linux, is it also useful to other systems? Is there any restrictions one needs to know when using the library with other OSes?</p>\n"}, {"tags": ["c", "windows", "compilation", "linker", "msp430"], "comments": [{"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 1, "creation_date": 1521596715, "post_id": 49396834, "comment_id": 85795475, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/12573816/what-is-an-undefined-reference-unresolved-external-symbol-error-and-how-do-i-fix\">What is an undefined reference/unresolved external symbol error and how do I fix it?</a>"}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 2, "creation_date": 1521596894, "post_id": 49396834, "comment_id": 85795509, "body": "Please don&#39;t post pictures of code/output. Copy &amp; paste the text into your question."}], "owner": {"reputation": 1, "user_id": 4283510, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98da68646d381f3af05b284ffd71a177?s=128&d=identicon&r=PG&f=1", "display_name": "dodger", "link": "https://stackoverflow.com/users/4283510/dodger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 734, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1521768977, "creation_date": 1521596503, "last_edit_date": 1521768977, "question_id": 49396834, "link": "https://stackoverflow.com/questions/49396834/ccs-unresolved-symbols-in-linker-or-compiler-causing-errors", "title": "CCS unresolved symbols in linker or compiler causing errors", "body": "<p>I am newbee c programmer so be patient.  I have a MSP430 C project in Code Composer Studio 7.3 using windows 7.  My project (USB) was working fine and then I tried to add more code to incorporate a SPI interface and everything went sideways.  I restored my original code but now have problems that weren't there before.  Seems to compile but has several unresolved symbols errors in the linker (I think).  I have searched/researched many answers to these types of problems on the forum and tried many things (over the past two days!!) and cannot resolve my problem.  Possibly I made things worse by copying library/functions directly into my project directory but still didn't seem to change anything. The errors are related to standard MSP430 functions, not my code. My project tree looks like:</p>\n\n<p><a href=\"https://i.stack.imgur.com/MwkFT.jpg\" rel=\"nofollow noreferrer\">project tree</a></p>\n\n<p>Errors from Console are:</p>\n\n<p><a href=\"https://i.stack.imgur.com/rfm1b.jpg\" rel=\"nofollow noreferrer\">console errors</a></p>\n\n<p>From everything I have read it indicates that either I have a compiler library path problem or a linker file path problem.  Tried a lot of combinations to no avail.   Following are the compiler and linker path info:</p>\n\n<p><a href=\"https://i.stack.imgur.com/pAxqu.jpg\" rel=\"nofollow noreferrer\">linker 1</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/jKTzP.jpg\" rel=\"nofollow noreferrer\">linker 2</a></p>\n\n<p>If I look in my repository of library stuff downloaded from TI you can see that the dma.h and dma.c files which reference the error message lines in the files are there and I don't understand why the linker can't do its thing.</p>\n\n<p><a href=\"https://i.stack.imgur.com/FDYan.jpg\" rel=\"nofollow noreferrer\">dma file tree</a></p>\n\n<p>In the linker under library files I noticed the original libmath.a file didn't point to anything so I found one and added it (not help).  Also the libc.a points to a section of 3 directories (different versions of a tool) which each have a different version of libc.a and I think I tried all of them.  See below for directories</p>\n\n<p><a href=\"https://i.stack.imgur.com/OIO0O.jpg\" rel=\"nofollow noreferrer\">directories</a>\nAny help would be greatly appreciated</p>\n\n<p>A CLUE POSSIBLY: CLUE? In my quest to solve my issues, I created a new CCs project and pasted my main.c file in and then went through a series of compiles solving the errors as the showed up. I was down to one error : can't open source file hal.h. I believe this is a file that was included with the usb example code I started with. After copying it into my project I am back to square on with all the errors listed above. To get here I only needed to point the compiler to driverlib to solve previous errors. The hal.h file seems to only include driverlib.h which is also referenced in my main function so why all the errors??</p>\n\n<p>FIXED BUT WHY!!!\nTo solve this issue I imported the drivlib directory from the TI repo on my D drive into my project.  Now everything compiles.  Can anyone tell me why I had to do that given that I had path directives to look on my D drive??  Can it be related to search path length being too long?</p>\n"}, {"tags": ["c", "ncurses"], "comments": [{"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1521596371, "post_id": 49396767, "comment_id": 85795382, "body": "See <a href=\"http://man7.org/linux/man-pages/man3/ncurses.3x.html\" rel=\"nofollow noreferrer\">man7.org/linux/man-pages/man3/ncurses.3x.html</a> look at the <code>wmove</code> function to move the cursor."}, {"owner": {"reputation": 516, "user_id": 8734514, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/10216756708654277/picture?type=large", "display_name": "Kevin Gardenhire", "link": "https://stackoverflow.com/users/8734514/kevin-gardenhire"}, "reply_to_user": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1521596528, "post_id": 49396767, "comment_id": 85795418, "body": "I am familiar with wmove to move my logical cursor. This alone does not accomplish what I am trying to do. Am I missing something? I hope so lol"}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1521596756, "post_id": 49396767, "comment_id": 85795480, "body": "And why does that not accomplish your goal? If I understand you correctly, you are using <code>insertln</code> insert a new line but it also moves the cursor. Then you can move the cursor back with <code>wmove</code> to the old position."}, {"owner": {"reputation": 516, "user_id": 8734514, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/10216756708654277/picture?type=large", "display_name": "Kevin Gardenhire", "link": "https://stackoverflow.com/users/8734514/kevin-gardenhire"}, "reply_to_user": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1521596885, "post_id": 49396767, "comment_id": 85795506, "body": "Sorry, what I meant was that I wanted to be able to have the cursor in the middle of a string and then insert a new line and have all the text after the cursor be moved to the new line. if you open a file in vi and hit enter mid string you will see the behavior that I mean"}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1521596987, "post_id": 49396767, "comment_id": 85795532, "body": "Ok, are you talking about a buffer where the user can enter text or any position on screen?"}, {"owner": {"reputation": 516, "user_id": 8734514, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/10216756708654277/picture?type=large", "display_name": "Kevin Gardenhire", "link": "https://stackoverflow.com/users/8734514/kevin-gardenhire"}, "reply_to_user": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1521597096, "post_id": 49396767, "comment_id": 85795559, "body": "correct, I am just making a simple text editor"}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1521597294, "post_id": 49396767, "comment_id": 85795607, "body": "I don&#39;t think there is a ncurses function thatdoes that, it&#39;s been a long time since I&#39;ve programmed my last ncurses app. I guess the best action would be to store all lines in separate buffers and track the position of the cursor. If the uses presses ENTER then you modify <code>buffer[lineno]</code> by moving everything after the cursor into <code>buffer[lineno+1]</code>, then you do a redraw of the lines/screen."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2404501"}, "is_accepted": true, "score": 2, "last_activity_date": 1521597292, "creation_date": 1521597292, "answer_id": 49396926, "question_id": 49396767, "link": "https://stackoverflow.com/questions/49396767/add-a-line-in-ncurses/49396926#49396926", "title": "Add a line in Ncurses", "body": "<p>You can use <code>instr</code> to read the text currently in the window, then erase it with <code>clrtoeol</code>, and <code>addstr</code> to put the text in the new location. (Add <code>w</code> and/or <code>mv</code> prefixes as needed).</p>\n\n<p>Note that a real text editor doing an \"insert newline\" will not just be operating on screen lines. It will operate on a logical line in the file buffer, potentially affecting multiple screen lines (if the line in the file is big enough to wrap). If you don't keep your own logical line structure separate from what you're displaying on screen, you aren't really doing a text-editor-like job.</p>\n"}], "owner": {"reputation": 516, "user_id": 8734514, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/10216756708654277/picture?type=large", "display_name": "Kevin Gardenhire", "link": "https://stackoverflow.com/users/8734514/kevin-gardenhire"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 670, "favorite_count": 0, "accepted_answer_id": 49396926, "answer_count": 1, "score": 0, "last_activity_date": 1521597292, "creation_date": 1521595936, "question_id": 49396767, "link": "https://stackoverflow.com/questions/49396767/add-a-line-in-ncurses", "title": "Add a line in Ncurses", "body": "<p>Is there a function in ncurses to add a line and move the text after the cursor to that new line? I am using insertln () now and that moves the entire current row down, but I would like behavior closer to vi when hitting enter in the middle of a row.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["c", "binary", "hex", "endianness", "fread"], "comments": [{"owner": {"reputation": 500, "user_id": 4160412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ebceeef47cea45e06679300a39ab1c4?s=128&d=identicon&r=PG&f=1", "display_name": "afic", "link": "https://stackoverflow.com/users/4160412/afic"}, "edited": false, "score": 2, "creation_date": 1521595005, "post_id": 49396604, "comment_id": 85795045, "body": "This does look like an endianess problem, maybe it would be more clear if you printed the hex number with left padded zeros which would be 00190000.  This is the exact reverse of what is in the file.  (This is assuming that the file contents that you gave us is in hex)"}, {"owner": {"reputation": 2287, "user_id": 5267751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd62e8fd8fbb37abc7e2a39d23828047?s=128&d=identicon&r=PG&f=1", "display_name": "user202729", "link": "https://stackoverflow.com/users/5267751/user202729"}, "edited": false, "score": 2, "creation_date": 1521595044, "post_id": 49396604, "comment_id": 85795057, "body": "That&#39;s expected when you use little-endian <code>int</code>."}, {"owner": {"reputation": 11, "user_id": 8755599, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155983169495052/picture?type=large", "display_name": "Daniel Olaya", "link": "https://stackoverflow.com/users/8755599/daniel-olaya"}, "reply_to_user": {"reputation": 2287, "user_id": 5267751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd62e8fd8fbb37abc7e2a39d23828047?s=128&d=identicon&r=PG&f=1", "display_name": "user202729", "link": "https://stackoverflow.com/users/5267751/user202729"}, "edited": false, "score": 1, "creation_date": 1521596748, "post_id": 49396604, "comment_id": 85795478, "body": "@user202729 Would the output not be 00 19 00 00 if it was little endian reversed?"}, {"owner": {"reputation": 2287, "user_id": 5267751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd62e8fd8fbb37abc7e2a39d23828047?s=128&d=identicon&r=PG&f=1", "display_name": "user202729", "link": "https://stackoverflow.com/users/5267751/user202729"}, "edited": false, "score": 0, "creation_date": 1521618987, "post_id": 49396604, "comment_id": 85802934, "body": "... You know that leading zeroes don&#39;t have any value, right?"}, {"owner": {"reputation": 811, "user_id": 9493582, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bfI3b.jpg?s=128&g=1", "display_name": "Arndt Jonasson", "link": "https://stackoverflow.com/users/9493582/arndt-jonasson"}, "edited": false, "score": 0, "creation_date": 1521643010, "post_id": 49396604, "comment_id": 85819764, "body": "Is the file produced by some other program writing a 4-byte integer? Or does it write two 2-byte integers? The functions <code>htonl</code> and <code>ntohl</code> may be useful."}, {"owner": {"reputation": 11, "user_id": 8755599, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155983169495052/picture?type=large", "display_name": "Daniel Olaya", "link": "https://stackoverflow.com/users/8755599/daniel-olaya"}, "reply_to_user": {"reputation": 811, "user_id": 9493582, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bfI3b.jpg?s=128&g=1", "display_name": "Arndt Jonasson", "link": "https://stackoverflow.com/users/9493582/arndt-jonasson"}, "edited": false, "score": 0, "creation_date": 1521766646, "post_id": 49396604, "comment_id": 85883521, "body": "@ArndtJonasson The file was indeed produced by other program with 4-byte integers, <code>htonl</code> and <code>ntohl</code> fixed the problem. Thank you!"}], "answers": [{"tags": [], "owner": {"reputation": 811, "user_id": 9493582, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bfI3b.jpg?s=128&g=1", "display_name": "Arndt Jonasson", "link": "https://stackoverflow.com/users/9493582/arndt-jonasson"}, "is_accepted": false, "score": 0, "last_activity_date": 1521795018, "creation_date": 1521795018, "answer_id": 49445619, "question_id": 49396604, "link": "https://stackoverflow.com/questions/49396604/bytes-swapped-using-fread-from-binary-hex-file/49445619#49445619", "title": "Bytes swapped using fread from binary (hex) file", "body": "<p>To handle the problem of endianness when transferring data between computers or between applications, the functions <code>htonl</code> and <code>ntohl</code> are useful.</p>\n"}], "owner": {"reputation": 11, "user_id": 8755599, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155983169495052/picture?type=large", "display_name": "Daniel Olaya", "link": "https://stackoverflow.com/users/8755599/daniel-olaya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 107, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1521795018, "creation_date": 1521594608, "last_edit_date": 1521596831, "question_id": 49396604, "link": "https://stackoverflow.com/questions/49396604/bytes-swapped-using-fread-from-binary-hex-file", "title": "Bytes swapped using fread from binary (hex) file", "body": "<p>I have binary file (hex represented) with the following input,</p>\n\n<pre><code>0000 1900\n</code></pre>\n\n<p>and I am using the following code to read data into an integer.</p>\n\n<pre><code> fp = fopen(argv[1], \"rb\");\n    if (fp == NULL){\n        printf(\"Error - Failed opening the file\\n\");\n        return EXIT_FAILURE;\n    } else{\n        printf(\"Disk image file [%s] opened...\\n\\n\", argv[1]);\n    }\n\nint x = 0;\nfread(&amp;x, sizeof(int), 1, fp);\nprintf(\"Block count Hex: %x\\n\", x);\nprintf(\"Block count dec: %d\\n\", x);\n</code></pre>\n\n<p>Following output is produced, the bytes position seem to be swapped by the fread function.</p>\n\n<pre><code>Block count Hex: 190000\nBlock count dec: 1638400\n</code></pre>\n\n<p>If I have read around the endianness problem but this doesnt seem to match the output that I am getting. Any help to figure this out would be greatly appreciated.</p>\n\n<p>Additional question:</p>\n\n<p>-What is the best way to read the hex value stored in an int variable? I have been using %x with p\u0155intf and I am wondering if there is a better way to debug my code.</p>\n"}, {"tags": ["c", "linux", "windows", "ubuntu", "gdb"], "comments": [{"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1521594751, "post_id": 49396598, "comment_id": 85794973, "body": "<code>char *words = &quot;words&quot;;</code> is a pointer to a string literal, modifying it is undefined behaviour and leads in most cases into a segfault, as it is read-only memory. You cannot modify it."}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1521594990, "post_id": 49396598, "comment_id": 85795042, "body": "Do Not Write a Code like this."}, {"owner": {"reputation": 83, "user_id": 9525807, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "tfreifeld", "link": "https://stackoverflow.com/users/9525807/tfreifeld"}, "edited": false, "score": 0, "creation_date": 1521595036, "post_id": 49396598, "comment_id": 85795053, "body": "Pablo thanks, but I&#39;m not asking about the bug itself , and why the segmentation fault happened. I&#39;m asking why it didn&#39;t happen with gdb. Sorry if that was not clear enough."}, {"owner": {"reputation": 83, "user_id": 9525807, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "tfreifeld", "link": "https://stackoverflow.com/users/9525807/tfreifeld"}, "edited": false, "score": 0, "creation_date": 1521595078, "post_id": 49396598, "comment_id": 85795065, "body": "Michi, what is the problem?"}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1521595180, "post_id": 49396598, "comment_id": 85795093, "body": "@tfreifeld Do you know what Literal Strings are?"}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1521595295, "post_id": 49396598, "comment_id": 85795121, "body": "Before you use a debugger you should use a memory tool like VALGRIND. By the way, you should definitely turn on your compiler Flags."}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1521595450, "post_id": 49396598, "comment_id": 85795158, "body": "Strange, I ran the exact same code on my gdb and I got <code>Program received signal SIGSEGV, Segmentation fault</code> on line 8"}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1521595494, "post_id": 49396598, "comment_id": 85795167, "body": "@tfreifeld use \u201c-Wwrite-strings\u201d"}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "reply_to_user": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1521595618, "post_id": 49396598, "comment_id": 85795201, "body": "@pablo why is that Strange? Should not happen?"}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "reply_to_user": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 1, "creation_date": 1521595717, "post_id": 49396598, "comment_id": 85795224, "body": "@Michi I find it strange that the OP&#39;s gdb did not show the segfault."}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1521595797, "post_id": 49396598, "comment_id": 85795237, "body": "Could it be that the Linux subsystem in windows 10 does not treat string literals as read-only memory?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1521595797, "post_id": 49396598, "comment_id": 85795240, "body": "That&#39;s UB. Don&#39;t ask for an explanation of why faulty code sometimes works."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1521596096, "post_id": 49396598, "comment_id": 85795311, "body": "There are better ways to pluralise, for example <code>char *plural[] = { &quot;&quot;, &quot;s&quot; }; printf(&quot;%d word%s&quot;, count, plural[count != 1]);</code>"}, {"owner": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "edited": false, "score": 0, "creation_date": 1521596960, "post_id": 49396598, "comment_id": 85795526, "body": "that code may or may not segfault, depending on how and where the string literal is stored.  As pointed out, code that modifies the string literal has undefined behavior (I.e. UB).  Also, in your gdb trace, you won&#39;t be able to step into strlen.  But if you step over if with <code>n</code> what do you get when you examine the variable <code>words</code>."}], "answers": [{"comments": [{"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1521595120, "post_id": 49396645, "comment_id": 85795077, "body": "\u201cbut modifying a string literal is undefined behaviour and anything can happen.\u201d, maybe the OP gets lucky and see how his PC burns. He will never code like that."}, {"owner": {"reputation": 83, "user_id": 9525807, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "tfreifeld", "link": "https://stackoverflow.com/users/9525807/tfreifeld"}, "edited": false, "score": 0, "creation_date": 1521622643, "post_id": 49396645, "comment_id": 85804956, "body": "That would have been fun to see ;) Actually, I didn&#39;t write that code. It was written by my course instructor, to serve as an exercise in pointers and gdb debugging. Some of the point of it was to teach not to write code like that."}], "tags": [], "owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "is_accepted": false, "score": 0, "last_activity_date": 1521596616, "last_edit_date": 1521596616, "creation_date": 1521594968, "answer_id": 49396645, "question_id": 49396598, "link": "https://stackoverflow.com/questions/49396598/segmentation-fault-disappear-with-gdb-in-ubunutu-on-windows/49396645#49396645", "title": "Segmentation fault disappear with gdb in ubunutu on windows", "body": "<p>This function is wrong</p>\n\n<pre><code>char *words(int count) {\n  char *words = \"words\";\n  if(count==1) \n    words[strlen(words)-1] = '\\0';\n  return words;\n}\n</code></pre>\n\n<p>The pointer <code>words</code> points to the string literal <code>\"words\"</code>. Modifying a string\nliteral is undefined behaviour and in most system string literals are stored in\nread-only memory, so doing</p>\n\n<pre><code>    words[strlen(words)-1] = '\\0';\n</code></pre>\n\n<p>will lead into a segfault. That's the behaviour you see in Ubuntu. I don't know\nwhere strings literals are stored in windows executables, but modifying a string\nliteral is undefined behaviour and anything can happen and it's pointless to try\nto deduce why sometimes things work and why sometimes things don't work. That's\nthe nature of undefined behaviour.</p>\n\n<p><strong>edit</strong></p>\n\n<blockquote>\n  <p>Pablo thanks, but I'm not asking about the bug itself , and why the segmentation fault happened. I'm asking why it didn't happen with gdb. Sorry if that was not clear enough.</p>\n</blockquote>\n\n<p>I don't know why it doesn't happent to your, but when I run your code on my gdb I get:</p>\n\n<pre><code>Reading symbols from ./bug...done.\n(gdb) b 8\nBreakpoint 1 at 0x6fc: file bug.c, line 8.\n(gdb) r hey\nStarting program: /tmp/bug hey\n\nBreakpoint 1, words (count=1) at bug.c:8\n8       words[strlen(words)-1] = '\\0';\n(gdb) s\n\nProgram received signal SIGSEGV, Segmentation fault.\n0x0000555555554713 in words (count=1) at bug.c:8\n8       words[strlen(words)-1] = '\\0';\n(gdb) \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 83, "user_id": 9525807, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "tfreifeld", "link": "https://stackoverflow.com/users/9525807/tfreifeld"}, "edited": false, "score": 0, "creation_date": 1521622514, "post_id": 49397359, "comment_id": 85804877, "body": "Thank you, I understand now. I guess I will have to settle to the VM (which works relatively slow for me, although I had given it plenty of RAM... don&#39;t know why it is slow, but I didn&#39;t give it a lot of thought. that&#39;s why I chose to work with Ubuntu on Windows instead). Thanks again"}], "tags": [], "owner": {"reputation": 162629, "user_id": 50617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YFykQ.png?s=128&g=1", "display_name": "Employed Russian", "link": "https://stackoverflow.com/users/50617/employed-russian"}, "is_accepted": true, "score": 1, "last_activity_date": 1521600828, "creation_date": 1521600828, "answer_id": 49397359, "question_id": 49396598, "link": "https://stackoverflow.com/questions/49396598/segmentation-fault-disappear-with-gdb-in-ubunutu-on-windows/49397359#49397359", "title": "Segmentation fault disappear with gdb in ubunutu on windows", "body": "<blockquote>\n  <p>I'm asking why it didn't happen with gdb</p>\n</blockquote>\n\n<p>It <em>did</em> happen with GDB, when run on a real (or virtual) UNIX system.</p>\n\n<p>It didn't happen when running under the weird \"Ubuntu on Windows\" environment, because that environment is doing crazy sh*t. In particular, for some reason the Windows subsystem maps usually readonly sections (<code>.rodata</code>, and probably <code>.text</code> as well) with writable permissions (which is why the program no longer crashes), but only when you run the program under debugger.</p>\n\n<p>I don't know why exactly Windows does that.</p>\n\n<p>Note that debuggers <em>do</em> need to write to (readonly) <code>.text</code> section in order to insert breakpoints. On a real UNIX system, this is achieved by <code>ptrace(PTRACE_POKETEXT, ...)</code> system call, which updates the readonly page, <em>but leaves it readonly</em> for the inferior (being debugged) process.</p>\n\n<p>I am guessing that Windows is imperfectly emulating this behavior (in particular does not write-protect the page after updating it).</p>\n\n<p>P.S. In general, using \"Ubuntu on Windows\" to learn Ubuntu is going to be full of gotchas like this one. You will likely be <em>much</em> better off using a virtual machine instead.</p>\n"}], "owner": {"reputation": 83, "user_id": 9525807, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "tfreifeld", "link": "https://stackoverflow.com/users/9525807/tfreifeld"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 307, "favorite_count": 1, "accepted_answer_id": 49397359, "answer_count": 2, "score": 0, "last_activity_date": 1521601436, "creation_date": 1521594549, "question_id": 49396598, "link": "https://stackoverflow.com/questions/49396598/segmentation-fault-disappear-with-gdb-in-ubunutu-on-windows", "title": "Segmentation fault disappear with gdb in ubunutu on windows", "body": "<p>I've been tasked with locating the bug in the following code, and fixing it:</p>\n\n<pre><code>/* $Id: count-words.c 858 2010-02-21 10:26:22Z tolpin $ */\n\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\n/* return string \"word\" if the count is 1 or \"words\" otherwise */\nchar *words(int count) {\n  char *words = \"words\";\n  if(count==1) \n    words[strlen(words)-1] = '\\0';\n  return words;\n}\n\n/* print a message reportint the number of words */\nint print_word_count(char **argv) {\n  int count = 0;\n  char **a = argv;\n  while(*(a++))\n    ++count;\n  printf(\"The sentence contains %d %s.\\n\", count, words(count));\n  return count;\n}\n\n/* print the number of words in the command line and return the number as the exit code */\nint main(int argc, char **argv) {\n  return print_word_count(argv+1);\n}\n</code></pre>\n\n<p>The program works well for every number of words given to it, except for one word. Running it with <code>./count-words hey</code> will cause a segmentation fault.</p>\n\n<p>I'm running my code on the Linux subsystem on Windows 10 (that's what I understand it is called at least...), with the official Ubuntu app.</p>\n\n<p>When running the program from terminal, I do get the segmentation fault, but using gdb, for some reason the program works fine:</p>\n\n<pre><code>(gdb) r hey\nStarting program: .../Task 0/count-words hey\nThe sentence contains 1 word.\n[Inferior 1 (process 87) exited with code 01]\n(gdb)\n</code></pre>\n\n<p>After adding a breakpoint on line 9 and stepping through the code, I get this:</p>\n\n<pre><code>(gdb) b 9\nBreakpoint 1 at 0x400579: file count-words.c, line 9.\n(gdb) r hey\nStarting program: /mnt/c/Users/tfrei/Google Drive/BGU/Semester F/Computer Architecture/Labs/Lab 2/Task 0/count-words hey\n\nBreakpoint 1, words (count=1) at count-words.c:9\n9         if(count==1)\n(gdb) s\n10          words[strlen(words)-1] = '\\0';\n(gdb) s\nstrlen () at ../sysdeps/x86_64/strlen.S:66\n66      ../sysdeps/x86_64/strlen.S: No such file or directory.\n(gdb) s\n67      in ../sysdeps/x86_64/strlen.S\n(gdb) s\n68      in ../sysdeps/x86_64/strlen.S\n(gdb)\n</code></pre>\n\n<p>The weird thing is that when I ran the same thing from a \"true\" Ubuntu (using a virtual machine on Windows 10), the segmentation fault did happen on gdb.</p>\n\n<p>I tend to believe that the reason for this is somehow related to my runtime environment (the \"Ubuntu on Windows\" thing), but could not find anything that will help me.</p>\n\n<p>This is my makefile:</p>\n\n<pre><code>all: \n    gcc -g -Wall -o count-words count-words.c \n\nclean: \n    rm -f count-words \n</code></pre>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["c", "structure", "tdm-gcc"], "comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 5, "creation_date": 1521593844, "post_id": 49396453, "comment_id": 85794757, "body": "The purpose of a bitfield is allow you to name separate ranges of bits within <i>one</i> variable. Using both <code>int</code> and <code>char</code> for 3-bits or <code>int</code> and <code>short</code> for 3-bits -- defeats the purpose."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1521594189, "post_id": 49396453, "comment_id": 85794843, "body": "I get size <code>16</code> for both <code>struct M</code> and <code>struct N</code> (MSVC). If I pack <code>struct N</code> it is size <code>13</code>."}, {"owner": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "edited": false, "score": 0, "creation_date": 1521594269, "post_id": 49396453, "comment_id": 85794861, "body": "In the <code>struct M</code>, if you wanted to assign two bits to n, a and c, try making them all the same type."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1521594727, "post_id": 49396453, "comment_id": 85794969, "body": "The C standard gives compilers a great deal of flexibility in how they implement bit fields. So there&#39;s not much to be said about this, except as others have pointed out, there&#39;s little to no benefit using different types for your bit fields."}, {"owner": {"reputation": 1015, "user_id": 6446479, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3371e33213376c495106d97858500c40?s=128&d=identicon&r=PG&f=1", "display_name": "Rajesh", "link": "https://stackoverflow.com/users/6446479/rajesh"}, "edited": false, "score": 0, "creation_date": 1521596073, "post_id": 49396453, "comment_id": 85795302, "body": "My purpose is definitely not to combine few bits from int and few bits from char into one variable. struct P,Q and R are given just show the result in my compiler. I understand that structure size depends on compiler. But within the same compiler, why size of M and N  are different is what my question. Within same compiler, behavior should be consistent right?"}, {"owner": {"reputation": 811, "user_id": 9493582, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bfI3b.jpg?s=128&g=1", "display_name": "Arndt Jonasson", "link": "https://stackoverflow.com/users/9493582/arndt-jonasson"}, "edited": false, "score": 0, "creation_date": 1521643459, "post_id": 49396453, "comment_id": 85820116, "body": "The behaviour is consistent if M is always handled the same way and N always the same way, but they need not be equal. However, for me and gcc they are. What is your gcc version and what does the compile command look like?"}, {"owner": {"reputation": 1015, "user_id": 6446479, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3371e33213376c495106d97858500c40?s=128&d=identicon&r=PG&f=1", "display_name": "Rajesh", "link": "https://stackoverflow.com/users/6446479/rajesh"}, "reply_to_user": {"reputation": 811, "user_id": 9493582, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bfI3b.jpg?s=128&g=1", "display_name": "Arndt Jonasson", "link": "https://stackoverflow.com/users/9493582/arndt-jonasson"}, "edited": false, "score": 0, "creation_date": 1521651054, "post_id": 49396453, "comment_id": 85826121, "body": "@ArndtJonasson Compiler version: tdm64-gcc-5.1.0-2  Compiler log: gcc.exe -Os -pedantic -Wextra -Wall -std=c99  -c C:\\Temp\\temp.c -o C:\\Temp\\temp.o  g++.exe  -o C:\\Temp\\temp.exe C:\\Temp\\temp.o"}, {"owner": {"reputation": 811, "user_id": 9493582, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bfI3b.jpg?s=128&g=1", "display_name": "Arndt Jonasson", "link": "https://stackoverflow.com/users/9493582/arndt-jonasson"}, "edited": false, "score": 0, "creation_date": 1521659935, "post_id": 49396453, "comment_id": 85831397, "body": "<code>-Os</code> means optimize for space, I think."}], "owner": {"reputation": 1015, "user_id": 6446479, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3371e33213376c495106d97858500c40?s=128&d=identicon&r=PG&f=1", "display_name": "Rajesh", "link": "https://stackoverflow.com/users/6446479/rajesh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1521593519, "creation_date": 1521593519, "question_id": 49396453, "link": "https://stackoverflow.com/questions/49396453/size-of-structure-with-bit-field-is-not-as-expected", "title": "Size of structure with bit field is not as expected", "body": "<p>I was looking at several SO posts on bit fields like <a href=\"https://stackoverflow.com/questions/24933242/when-to-use-bit-fields-in-c\">link1</a> <a href=\"https://stackoverflow.com/questions/24725188/size-of-structure-with-bit-fields\">link2</a>.\nI am using TDM-GCC-64 compiler.\nIn wrote this code below to test the size of structures under various scenario.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nstruct P\n{\n    int k:2;\n    char c:1;\n};\n\nstruct Q\n{\n    int k:2;\n    short c:1;\n};\n\n#pragma pack(1)\nstruct R\n{\n    int k:2;\n    char c:1;\n    int a;\n};\n#pragma pack()\n\n\nstruct M {\n    int m;\n    short l;\n    short k;\n    short x;\n    short n:2;\n    char a:2;\n    char c:2;\n};\n\nstruct N {\n    int m:2;\n    short l;\n    short k;\n    short x;\n    short n:2;\n    char a:2;\n    char c:2;\n};\n\n\nint main()\n{\n    printf(\"sizeof struct P = %d\\n\",sizeof(struct P));\n    printf(\"sizeof struct Q = %d\\n\",sizeof(struct Q));\n    printf(\"sizeof struct R = %d\\n\",sizeof(struct R));\n    printf(\"sizeof struct M = %d\\n\",sizeof(struct M));\n    printf(\"sizeof struct N = %d\\n\",sizeof(struct N));\n    return 0;\n}\n</code></pre>\n\n<p>I am getting the sizeof(struct P) and sizeof(struct Q) as 8 bytes. \nThis means that, character and integers will be considered separately and char will not be placed in integer space even if integer is of bit field type and free space is available. Again entire structure is aligned to the boundary of sizeof(int) and hence total size would be 4+1+3 padding bytes in case of P. \nIf I use #pragma pack(1), I get 9 bytes and integers are now not naturally aligned and also entire structure is packed an not aligned to the boundary of integer type.</p>\n\n<p>Considering the same concept, I was expecting sizeof(struct N) to be [4 byte for int, + 2 byte short + 2 byte short + 2 byte short + 2 byte for short + 1 byte for two char type combined + 3 for alignment = 16 bytes. </p>\n\n<p>But sizeof(struct N) is 12bytes and not 16 bytes. Why size of M and N are not same?</p>\n"}, {"tags": ["c", "gcc", "makefile", "cmake"], "comments": [{"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1521621461, "post_id": 49396399, "comment_id": 85804236, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/43136418/how-to-add-l-ell-compiler-flag-in-cmake\">How to add &quot;-l&quot; (ell) compiler flag in CMake</a>"}], "answers": [{"tags": [], "owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "is_accepted": true, "score": 3, "last_activity_date": 1521593559, "creation_date": 1521593559, "answer_id": 49396465, "question_id": 49396399, "link": "https://stackoverflow.com/questions/49396399/convert-makefile-to-cmakelist/49396465#49396465", "title": "Convert makefile to cmakelist", "body": "<p>You have to use <a href=\"https://cmake.org/cmake/help/v3.0/command/target_link_libraries.html\" rel=\"nofollow noreferrer\"><code>target_link_libraries</code></a> like this:</p>\n\n<pre><code>target_link_libraries(project1 m)\n</code></pre>\n\n<p>and put it after <code>add_executable</code> call, as the first argument of <code>target_link_libraries</code> is a known target, <code>project1</code> in your case.</p>\n\n<p>See <a href=\"https://stackoverflow.com/questions/34625627/adding-math-library-with-cmake\">this</a></p>\n\n<p>Also note that <code>CMAKE_CXX_FLAGS</code> is the variable for the compiler flags, <code>-lm</code> is linker flag, so doing <code>-lm</code> during compilation is useless.</p>\n"}], "owner": {"reputation": 181, "user_id": 4466306, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/87a0e63ffef2176606858ca200d1971e?s=128&d=identicon&r=PG&f=1", "display_name": "user8109", "link": "https://stackoverflow.com/users/4466306/user8109"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1154, "favorite_count": 0, "accepted_answer_id": 49396465, "answer_count": 1, "score": 1, "last_activity_date": 1521593559, "creation_date": 1521593038, "question_id": 49396399, "link": "https://stackoverflow.com/questions/49396399/convert-makefile-to-cmakelist", "title": "Convert makefile to cmakelist", "body": "<p>I have a makefile which looks like this:</p>\n\n<pre><code>CC = gcc \nOPTFLAGS = -O3 -fno-strict-aliasing -D_GNU_SOURCE\nCOPTIONS = -DLINUX -D_FILE_OFFSET_BITS=64 -std=c99 -Wall\\\n       -Wno-unused-function -Wno-unused-label -Wno-unused-variable\\\n       -Wno-parentheses -Wsequence-point\n\n#Standard Libraries\nSTDLIBS = -lm\n\nCFLAGS = $(COPTIONS)  $(OPTFLAGS)\nLIBS = $(STDLIBS)\n\nSOURCE = sd.c getopt.c cmdline.c util.c\nEXE = sd\n\ndefault:\n    $(CC) $(CFLAGS) $(SOURCE) $(LIBS) -o $(EXE)\n</code></pre>\n\n<p>I want to write the Cmakelist.txt for the above makefile. I tried following:</p>\n\n<pre><code>cmake_minimum_required(VERSION 3.9)\nproject(project1)\n\nset(CMAKE_CXX_STANDARD 11)\nset(CMAKE_CXX_FLAGS \"-O3 -fno-strict-aliasing -D_GNU_SOURCE DLINUX -D_FILE_OFFSET_BITS=64 -std=c99 -Wall -Wno-unused-function -Wno-unused-label -Wno-unused-variable -Wno-parentheses -Wsequence-point -lm\" )\n\nadd_executable(project1\n    cmdline.c\n    getopt.c\n    sd.c\n    util.c)\n</code></pre>\n\n<p>After that still, I am getting an error </p>\n\n<pre><code>undefined reference to `sqrt' \n</code></pre>\n\n<p>because my cmakefile is not able to load standard libraries(-lm). Can somebody help me with cmakelist. What is wrong with my cmakelist ?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1521589258, "post_id": 49395846, "comment_id": 85793597, "body": "What do you think <code>scanf(&quot;%match&quot;, &amp;user_guess);</code> does? <code>%match</code> is not a valid format spec. You don&#39;t show the variable type with a <a href=\"http://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable example</a> but my <b>user guess</b> is <code>int</code> and if so it should be <code>scanf(&quot;%d&quot;, &amp;user_guess);</code> and of course you need to check the return value from <code>scanf</code> too to see if the input was converted successfully."}, {"owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 1, "creation_date": 1521589332, "post_id": 49395846, "comment_id": 85793620, "body": "Your <code>break</code> is executed unconditionally. Move it up one line so it&#39;s inside the last <code>else</code> block."}, {"owner": {"reputation": 655, "user_id": 3616601, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d9dbe1da7416f8fa9b0cf1d0974269e7?s=128&d=identicon&r=PG&f=1", "display_name": "Phantom", "link": "https://stackoverflow.com/users/3616601/phantom"}, "edited": false, "score": 0, "creation_date": 1521616543, "post_id": 49395846, "comment_id": 85801686, "body": "Instead of using a <code>break</code>, you should set <code>match</code> to 1, which will make the <code>while</code> condition fail and stop your program."}, {"owner": {"reputation": 11, "user_id": 9519606, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a970d98496601e53c691989d62733b38?s=128&d=identicon&r=PG&f=1", "display_name": "Debrah", "link": "https://stackoverflow.com/users/9519606/debrah"}, "edited": false, "score": 0, "creation_date": 1521640258, "post_id": 49395846, "comment_id": 85817469, "body": "Hey guys! thanks every changes to pointed errors yielded positive result. it worked! Thanks! :D"}], "answers": [{"comments": [{"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 3, "creation_date": 1521590686, "post_id": 49395966, "comment_id": 85793967, "body": "Please make your answer better by explaining your correction so that the OP and other people in the feature can learn from this."}, {"owner": {"reputation": 655, "user_id": 3616601, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d9dbe1da7416f8fa9b0cf1d0974269e7?s=128&d=identicon&r=PG&f=1", "display_name": "Phantom", "link": "https://stackoverflow.com/users/3616601/phantom"}, "edited": false, "score": 0, "creation_date": 1521617245, "post_id": 49395966, "comment_id": 85802046, "body": "You should not encourage the use of <code>break</code> in loop. Instead use a better stop condition."}, {"owner": {"reputation": 666, "user_id": 9060838, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/889fa7aa60691aed08d3a5b1e396770f?s=128&d=identicon&r=PG&f=1", "display_name": "chanioxaris", "link": "https://stackoverflow.com/users/9060838/chanioxaris"}, "reply_to_user": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1521617399, "post_id": 49395966, "comment_id": 85802132, "body": "I added some documentation to explain my code for further purposes. Thanks for pointing out @Pablo"}, {"owner": {"reputation": 11, "user_id": 9519606, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a970d98496601e53c691989d62733b38?s=128&d=identicon&r=PG&f=1", "display_name": "Debrah", "link": "https://stackoverflow.com/users/9519606/debrah"}, "edited": false, "score": 0, "creation_date": 1521640443, "post_id": 49395966, "comment_id": 85817647, "body": "Hey guys! thanks every changes to pointed errors yielded positive result. it worked! Thanks! :D"}], "tags": [], "owner": {"reputation": 666, "user_id": 9060838, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/889fa7aa60691aed08d3a5b1e396770f?s=128&d=identicon&r=PG&f=1", "display_name": "chanioxaris", "link": "https://stackoverflow.com/users/9060838/chanioxaris"}, "is_accepted": false, "score": -1, "last_activity_date": 1521617317, "last_edit_date": 1521617317, "creation_date": 1521589897, "answer_id": 49395966, "question_id": 49395846, "link": "https://stackoverflow.com/questions/49395846/guessing-game-code-in-c-programming/49395966#49395966", "title": "Guessing game code in C Programming", "body": "<p>Instead of your approach you can use a infinite loop <code>while(1);</code> and break out of it if some criteria are meet. In this way your code will be more readable, efficient and scalable.</p>\n\n<p>So there is no need to use a flag variable 'match', in the else statement add a <code>break();</code> command at the end if the user guess the right number.</p>\n\n<p>Also use an if statement to check if the user has more chances to guess, or he has suppressed them.</p>\n\n<p>Last but not least you have to replace <code>scanf(\"%match\", &amp;user_guess);</code> with <code>scanf(\"%d\", &amp;user_guess);</code> because you need to read an int variable from the user and store it at the 'user_guess' variable</p>\n\n<pre><code> while(1)\n {\n        printf(\"Enter your number: \");\n        scanf(\"%d\", &amp;user_guess);\n\n        if(user_guess &gt; computer_guess)\n        {\n          printf(\"your guess is high\\n\");\n          printf(\"your remaining chances are %d\\n\", MAX_CHANCES - chance_count);\n          printf(\"number of steps taken is %d\\n\", chance_count);\n        }\n        else if (user_guess &lt;  computer_guess)\n        {\n           printf(\"your guess is too low\\n\");\n           printf(\"your remaining chances are %d\\n\",MAX_CHANCES - chance_count);\n           printf(\"number of steps taken is %d\\n\", chance_count);\n        }\n        else\n        {\n         printf(\"BINGO! you have won\\n\");\n         printf(\"it took you %d steps for the number\\n\", chance_count);\n         break;\n        }\n\n        if(chance_count &gt; MAX_CHANCES)\n        {\n          printf(\"GAME OVER\");\n          break;\n        }\n\n        chance_count++;\n } // end of while loop\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 9504078, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4aeab7ea08f0c89f257e302dcd029a5?s=128&d=identicon&r=PG&f=1", "display_name": "H. Jenkins", "link": "https://stackoverflow.com/users/9504078/h-jenkins"}, "reply_to_user": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1521594881, "post_id": 49396505, "comment_id": 85795006, "body": "@Pablo  Thanks for your adjustment."}, {"owner": {"reputation": 25937, "user_id": 338904, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/dea29233fa03ea84f8a853102deb0344?s=128&d=identicon&r=PG", "display_name": "e2-e4", "link": "https://stackoverflow.com/users/338904/e2-e4"}, "edited": false, "score": 0, "creation_date": 1521603931, "post_id": 49396505, "comment_id": 85797195, "body": "&quot;Wrong&quot; is a blame, but how do you fix it? This is what OP wants to know."}, {"owner": {"reputation": 1, "user_id": 9504078, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4aeab7ea08f0c89f257e302dcd029a5?s=128&d=identicon&r=PG&f=1", "display_name": "H. Jenkins", "link": "https://stackoverflow.com/users/9504078/h-jenkins"}, "reply_to_user": {"reputation": 25937, "user_id": 338904, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/dea29233fa03ea84f8a853102deb0344?s=128&d=identicon&r=PG", "display_name": "e2-e4", "link": "https://stackoverflow.com/users/338904/e2-e4"}, "edited": false, "score": 0, "creation_date": 1521615942, "post_id": 49396505, "comment_id": 85801382, "body": "@Ring See the code right there above! There&#39;s no any complicated algorithms there. And why is &quot;wrong&quot; a blame? &#39;Wrong&#39; is just &#39;Wrong&#39; because he is wrong. That&#39;s not a kind of humiliation. Have you ever seen &quot;%match&quot; in scanf? Have ever seen such a break statement which makes only one time execution in loop without any plausible conditional statements? I thought only slight adjustment in his code is quite enough to make him do whatever he wants."}], "tags": [], "owner": {"reputation": 1, "user_id": 9504078, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4aeab7ea08f0c89f257e302dcd029a5?s=128&d=identicon&r=PG&f=1", "display_name": "H. Jenkins", "link": "https://stackoverflow.com/users/9504078/h-jenkins"}, "is_accepted": false, "score": 0, "last_activity_date": 1521603366, "last_edit_date": 1521603366, "creation_date": 1521593809, "answer_id": 49396505, "question_id": 49395846, "link": "https://stackoverflow.com/questions/49395846/guessing-game-code-in-c-programming/49396505#49396505", "title": "Guessing game code in C Programming", "body": "<pre><code>scanf(\"%match\", &amp;user_guess);\n</code></pre>\n\n<p>Wrong. There's no such placeholders in <code>scanf</code> format string. Read this carefully <a href=\"https://en.wikipedia.org/wiki/Scanf_format_string\" rel=\"nofollow noreferrer\">https://en.wikipedia.org/wiki/Scanf_format_string</a></p>\n\n<p>Your <code>break;</code> matches with <code>while(match ==0 &amp;&amp; chance_count &lt;= MAX_CHANCES)</code></p>\n\n<p>So, it will run only first time once the condition is true. </p>\n"}], "owner": {"reputation": 11, "user_id": 9519606, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a970d98496601e53c691989d62733b38?s=128&d=identicon&r=PG&f=1", "display_name": "Debrah", "link": "https://stackoverflow.com/users/9519606/debrah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 455, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1521617317, "creation_date": 1521589101, "question_id": 49395846, "link": "https://stackoverflow.com/questions/49395846/guessing-game-code-in-c-programming", "title": "Guessing game code in C Programming", "body": "<p>Hello i am new to C programming, currently working on a code, a simple guessing game. Maybe not simple for me, Every time i build and run the code.  At the first attempt. The command interface asks to press any key to continue and then takes the interface away. I have to start from the beginning and it doesn't let me go any further unless i run the code again as it is meant to allow another guessed number  until the game is over or until i guess right. i do not know what is wrong with my code. Please help, Code is attached below. Thank you. </p>\n\n<pre><code>while(match ==0 &amp;&amp; chance_count &lt;= MAX_CHANCES){\n\n    printf(\"Enter your number: \");\n        scanf(\"%match\", &amp;user_guess);\n        if(user_guess &gt; computer_guess)\n        {\n            printf(\"your guess is high\\n\");\n            printf(\"your remaining chances are %d\\n\", MAX_CHANCES - chance_count);\n            printf(\"number of steps taken is %d\\n\", chance_count);\n\n    }\n       else if (user_guess &lt;  computer_guess){\n                 printf(\"your guess is too low\\n\");\n                 printf(\"your remaining chances are %d\\n\",MAX_CHANCES - chance_count);\n                 printf(\"number of steps taken is %d\\n\", chance_count);\n\n    }\n       else{\n                 printf(\"BINGO! you have won\\n\");\n                 printf(\"it took you %d steps for the number\\n\", MAX_CHANCES - (MAX_CHANCES - chance_count));\n\n    }\n    break;\n                 printf(\"\\n\\n\");\n                 chance_count++;\n    } // end of while loop\n     if(chance_count &gt; MAX_CHANCES){\n                 printf(\"GAME OVER\");\n    }\n          return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "stack", "buffer-overflow"], "comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 7, "creation_date": 1521588966, "post_id": 49395799, "comment_id": 85793499, "body": "<code>printf</code> isn&#39;t what is broken in this code. <code>arr[10] = 1;</code> invokes <i>undefind behavior</i>. After that, stop trying to make sense out of this; there isn&#39;t any."}, {"owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 0, "creation_date": 1521588973, "post_id": 49395799, "comment_id": 85793502, "body": "<code>arr[10]</code> is one past the end of the array. The array is declared <code>int arr[10]</code> so <code>arr[9]</code> is the last element. Thus, <code>arr[10] = 1;</code> is undefined behavior (i.e. crash)"}], "answers": [{"tags": [], "owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "is_accepted": true, "score": 4, "last_activity_date": 1521589013, "creation_date": 1521589013, "answer_id": 49395832, "question_id": 49395799, "link": "https://stackoverflow.com/questions/49395799/simple-stack-corruption-in-c/49395832#49395832", "title": "Simple stack corruption in C", "body": "<p>Your program acesses the array beyond it's bounds. The array indexes start at <em>0</em> and end at <em>N - 1</em> where <em>N</em> is the size of the array.</p>\n\n<p>Doing this invokes undefined behavior, so your prediction of program's behavior will be wrong after this. Adding the <code>printf()</code> can change this behavior and it does, and that is what <em>undefined behavior</em> means, it should not affect the behavior of the program but once you have caused the undefined behavior at</p>\n\n<pre><code>arr[10] = 1;\n</code></pre>\n\n<p>you cannot know how the program will behave anymore.</p>\n"}, {"tags": [], "owner": {"reputation": 4598, "user_id": 9264702, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mHczh.jpg?s=128&g=1", "display_name": "Stephen Docy", "link": "https://stackoverflow.com/users/9264702/stephen-docy"}, "is_accepted": false, "score": 0, "last_activity_date": 1521589087, "creation_date": 1521589087, "answer_id": 49395841, "question_id": 49395799, "link": "https://stackoverflow.com/questions/49395799/simple-stack-corruption-in-c/49395841#49395841", "title": "Simple stack corruption in C", "body": "<p>This is causing your problem</p>\n\n<pre><code>arr[10] = 1;\n</code></pre>\n\n<p>You only allocate 10 elements in your array</p>\n\n<pre><code>int arr[10] = { 0 };\n</code></pre>\n\n<p><code>arr[10]</code> is actually trying to access the 11th element in the array because array indices start at <code>0</code>.</p>\n"}], "owner": {"reputation": 534, "user_id": 6683120, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/d54Aq.jpg?s=128&g=1", "display_name": "Robert", "link": "https://stackoverflow.com/users/6683120/robert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 49395832, "answer_count": 2, "score": 0, "last_activity_date": 1521662896, "creation_date": 1521588757, "last_edit_date": 1521662896, "question_id": 49395799, "link": "https://stackoverflow.com/questions/49395799/simple-stack-corruption-in-c", "title": "Simple stack corruption in C", "body": "<p>Can somebody explain me, why in this program if I call the <code>printf</code> in that way the flag will be win? but without will not? Why this <code>printf</code> allow such things i can't understand thanks. Why without the <code>printf</code> the array can't overwrite the variable flag?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdbool.h&gt;\n\nint main() {\n\n    int flag = false;\n\n    int arr[10] = {0};\n    int siz = sizeof(arr) / sizeof(* arr);\n\n    printf(\"%p\", &amp;flag);\n    arr[10] = 1; // Without the printf call can't get the win. Why?\n    puts(\"\");\n\n    if(flag == true)\n    {\n        printf(\"win !\");\n    }\n    else\n    {\n        printf(\"lose\");\n    }\n\n\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "audio", "types"], "comments": [{"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1521588750, "post_id": 49395691, "comment_id": 85793427, "body": "Your&#39;e using the low-order 24 bits of the 32. You need to use the high order bits."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1521594121, "post_id": 49395691, "comment_id": 85794823, "body": "Have you done printing to check: <code>printf(&quot;0x%.6X . = %.2X %.2X %.2X\\n&quot;, buffer_32[i] &amp; 0xFFFFFF, buffer_24[i*3+0], buffer_24[i*3+1], buffer_24[i*3+2]);</code> as the last statement of the loop?  Do the printed values agree with each other?"}, {"owner": {"reputation": 500, "user_id": 4160412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ebceeef47cea45e06679300a39ab1c4?s=128&d=identicon&r=PG&f=1", "display_name": "afic", "link": "https://stackoverflow.com/users/4160412/afic"}, "edited": false, "score": 0, "creation_date": 1521596591, "post_id": 49395691, "comment_id": 85795434, "body": "Are you sure that your output byte order matches the expected byte order of whatever player you are using?  I am interested in seeing your 16-bit version of this code to see if they match."}], "answers": [{"comments": [{"owner": {"reputation": 83, "user_id": 8140834, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9249e5c78308015f7a1c4a160535ed7f?s=128&d=identicon&r=PG&f=1", "display_name": "Ratatax", "link": "https://stackoverflow.com/users/8140834/ratatax"}, "edited": false, "score": 0, "creation_date": 1521589147, "post_id": 49395747, "comment_id": 85793563, "body": "I forgot to add that my int array contain values that are already scaled to fit in 24-bit range, so MSB is empty"}, {"owner": {"reputation": 500, "user_id": 4160412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ebceeef47cea45e06679300a39ab1c4?s=128&d=identicon&r=PG&f=1", "display_name": "afic", "link": "https://stackoverflow.com/users/4160412/afic"}, "edited": false, "score": 1, "creation_date": 1521597009, "post_id": 49395747, "comment_id": 85795536, "body": "Here is a hacky solution that could be used to test if the error is not in this part of the code.  Multiply the buffer_32[i] by 0x100 and then use the code given in this answer."}], "tags": [], "owner": {"reputation": 8444, "user_id": 1837203, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4db7eb958bf0c84072c8e9658700167?s=128&d=identicon&r=PG", "display_name": "jaket", "link": "https://stackoverflow.com/users/1837203/jaket"}, "is_accepted": false, "score": 3, "last_activity_date": 1521588362, "creation_date": 1521588362, "answer_id": 49395747, "question_id": 49395691, "link": "https://stackoverflow.com/questions/49395691/convert-32-bit-signed-int-to-24-bit-signed-for-audio-data/49395747#49395747", "title": "Convert 32 bit signed int to 24 bit signed for audio data", "body": "<p>The reason it sounds like noise is that you're stripping the MSB from the data.</p>\n\n<p>Try this instead:</p>\n\n<pre><code>buffer_24[i*3] = (unsigned char)((buffer_32[i] &amp; 0xff000000) &gt;&gt; 24);\nbuffer_24[i*3+1] = (unsigned char)((buffer_32[i] &amp; 0xff0000) &gt;&gt; 16);\nbuffer_24[i*3+2] = (unsigned char)((buffer_32[i] &amp; 0xff00) &gt;&gt; 8);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 312, "user_id": 9472112, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78f21a93aaf54b8fc8f5293efea07de6?s=128&d=identicon&r=PG", "display_name": "Mr. de Silva", "link": "https://stackoverflow.com/users/9472112/mr-de-silva"}, "is_accepted": false, "score": 0, "last_activity_date": 1521593722, "last_edit_date": 1521593722, "creation_date": 1521588512, "answer_id": 49395762, "question_id": 49395691, "link": "https://stackoverflow.com/questions/49395691/convert-32-bit-signed-int-to-24-bit-signed-for-audio-data/49395762#49395762", "title": "Convert 32 bit signed int to 24 bit signed for audio data", "body": "<p>It is over 30 years since I did this kind of stuff, so bear with me:</p>\n\n<ol>\n<li>If your audio is multiplexed stereo then I doubt what you are doing works. </li>\n<li>If the signed bit is for left and right then then you should work (AND) the sign out of it and work with the result and then re-attach (OR) the sign back.</li>\n<li>If you are just trying to remove the top byte then you should AND out the top bytes with 0x00ffffffff (four bytes).</li>\n</ol>\n\n<p>If it is a pure analogue sample, I would reduce the resolution (software resample), depending on what type of quality I want, reduce the volume, etc.</p>\n\n<p>Trust this helps.</p>\n"}], "owner": {"reputation": 83, "user_id": 8140834, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9249e5c78308015f7a1c4a160535ed7f?s=128&d=identicon&r=PG&f=1", "display_name": "Ratatax", "link": "https://stackoverflow.com/users/8140834/ratatax"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1109, "favorite_count": 1, "answer_count": 2, "score": 2, "last_activity_date": 1521596457, "creation_date": 1521587959, "last_edit_date": 1521593935, "question_id": 49395691, "link": "https://stackoverflow.com/questions/49395691/convert-32-bit-signed-int-to-24-bit-signed-for-audio-data", "title": "Convert 32 bit signed int to 24 bit signed for audio data", "body": "<p>I'm trying to convert my audio data which is 32 bit signed int, into 24 bit signed.\nThe goal is to write a Wave file. I already managed to write correct Wave files with 8, 16 and 32 bit depths, but for some reason I struggle with 24 bit. The sound output sounds like 8 bits (lots of noise), which seems to mean only the MSB is correctly interpreted, the second and third bytes of the 24-bit value seems not working.</p>\n\n<p>The code:</p>\n\n<pre><code>int buffer_32[1024];\nunsigned char buffer_24[1024*3];\n\nfor (unsigned i = 0; i &lt; 1024; i++)\n{\n    buffer_24[i*3] = (unsigned char)((buffer_32[i] &amp; 0xff0000) &gt;&gt; 16);\n    buffer_24[i*3+1] = (unsigned char)((buffer_32[i] &amp; 0xff00) &gt;&gt; 8);\n    buffer_24[i*3+2] = (unsigned char)(buffer_32[i] &amp; 0xff);\n}\n</code></pre>\n\n<p>Basically, I manipulate bytes to create a 24-bit stream ('24bit packed').</p>\n\n<p>I don't know whats wrong in my conversion algorithm: can you help me?</p>\n\n<p>EDIT : I forgot to say, my int values are already correctly scaled into -8388608,8388607 (24-bit signed integer) range before going into this conversion loop.</p>\n"}, {"tags": ["c", "sgx"], "comments": [{"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1521587994, "post_id": 49395654, "comment_id": 85793184, "body": "<code>public</code> is not a C keyword. Are you really doing C or just something that looks like c."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 2, "creation_date": 1521588607, "post_id": 49395654, "comment_id": 85793377, "body": "@Pablo: The OP tagged the question <a href=\"https://stackoverflow.com/questions/tagged/sgx\">sgx</a> and already stated that those code blocks represent EDL functions. That format matches examples <a href=\"https://github.com/digawp/hello-enclave/blob/master/Enclave/Enclave.edl\" rel=\"nofollow noreferrer\">here</a>."}], "answers": [{"tags": [], "owner": {"reputation": 28, "user_id": 1866363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa222ad2607c45a825a52a0953667d1f?s=128&d=identicon&r=PG", "display_name": "user1866363", "link": "https://stackoverflow.com/users/1866363/user1866363"}, "is_accepted": true, "score": 1, "last_activity_date": 1523347937, "creation_date": 1523347937, "answer_id": 49748575, "question_id": 49395654, "link": "https://stackoverflow.com/questions/49395654/pass-variable-size-buffer-from-sgx-enclave-to-outside/49748575#49748575", "title": "Pass variable-size buffer from SGX enclave to outside", "body": "<p>As far as I know it is not possible to do what you intend to. It seems the ecall function needs to know to size of the buffer with [out] attribute when the function is called. This is also why your last solution will not work, the size function or variable is computed at function call. </p>\n\n<p>I see two solutions to your problem, either use a buffer with a predetermined sufficient size, or declare an ocall function with variable size parameter, and call it from the code of your ecall function to \"set\" your return value. Here is an (untested) example of the second solution:</p>\n\n<p>In your .edl file: </p>\n\n<pre><code>untrusted {\n  public void get_buffer([in, size = buffer_in_len] void* buffer_in, size_t buffer_in_len);\n};\n\ntrusted {\n  void set_buffer([in, size = buffer_len] void* buffer, size_t buffer_len);\n};\n</code></pre>\n\n<p>and in your enclave:</p>\n\n<pre><code>void get_buffer(void* buffer_in, size_t buffer_in_len){\n  [...]\n  set_buffer(my_buffer, my_buffer_len);\n}\n</code></pre>\n\n<p>I'm not sure this is optimal, but it's the solution I ended up using.</p>\n"}], "owner": {"reputation": 83, "user_id": 7759265, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de1091a2ecf7f6f77a02ed50383be7a8?s=128&d=identicon&r=PG&f=1", "display_name": "Guilherme Borges", "link": "https://stackoverflow.com/users/7759265/guilherme-borges"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 330, "favorite_count": 0, "accepted_answer_id": 49748575, "answer_count": 1, "score": 1, "last_activity_date": 1523347937, "creation_date": 1521587762, "last_edit_date": 1521630624, "question_id": 49395654, "link": "https://stackoverflow.com/questions/49395654/pass-variable-size-buffer-from-sgx-enclave-to-outside", "title": "Pass variable-size buffer from SGX enclave to outside", "body": "<p>I am trying to do a function with the following prototype:</p>\n\n<pre><code>void pass_buffer(void** buffer_out, size_t* buffer_out_len, const void* buffer_in, size_t buffer_in_len);\n</code></pre>\n\n<p>So the idea is to pass a buffer into the enclave, and then return a response in another buffer, which can vary in size, that size being stored in <code>buffer_out_len</code>.</p>\n\n<p>I'm having trouble in defining the EDL function. So my idea was to do something like:</p>\n\n<pre><code>public void pass_buffer([out]void** buffer_out, [out]size_t* buffer_out_len, [in, size = buffer_in_len]const void* buffer_in, size_t buffer_in_len);\n</code></pre>\n\n<p>Now, that only returns a buffer filled with one's. I know I'm supposed to pass the length of the buffer with the <code>size</code> parameter, but using a pointer in <code>size</code> was not allowed:</p>\n\n<pre><code>public void pass_buffer([out, size = *buffer_out_len]void** buffer_out, [out]size_t* buffer_out_len, [in, size = buffer_in_len]const void* buffer_in, size_t buffer_in_len);\n</code></pre>\n\n<p>Is my last solution possible with another syntax? Or maybe by making the return value that <code>size_t buffer_out_len</code>? If so, how do I reference it from the <code>size</code> parameter in <code>[out]</code>?</p>\n\n<p>Or maybe there is another way to do this kind of behaviour? Initialise a buffer of variable size and pass it to the outside? Thanks so much.</p>\n"}, {"tags": ["c", "function", "return", "boolean"], "comments": [{"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1521586127, "post_id": 49395316, "comment_id": 85792570, "body": "are you sure you&#39;re initializing the board to all <code>&#39;_&#39;</code>? Have you printed out the whole board to check? What is <code>SIZE</code> defined as?"}, {"owner": {"reputation": 27, "user_id": 9519541, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Luke ", "link": "https://stackoverflow.com/users/9519541/luke"}, "reply_to_user": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1521586185, "post_id": 49395316, "comment_id": 85792601, "body": "Yes I have printed out the whole array and they all are underscores and SIZE is defined as 3 to have a 3 x 3 board"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1521595978, "post_id": 49395316, "comment_id": 85795281, "body": "BTW the function body could be <code>return !std::memchr(&amp;board, &#39;_&#39;, 9);</code>"}], "answers": [{"tags": [], "owner": {"reputation": 1876, "user_id": 2353816, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/t5smr.jpg?s=128&g=1", "display_name": "Anders Cedronius", "link": "https://stackoverflow.com/users/2353816/anders-cedronius"}, "is_accepted": false, "score": -1, "last_activity_date": 1521628829, "last_edit_date": 1521628829, "creation_date": 1521586187, "answer_id": 49395400, "question_id": 49395316, "link": "https://stackoverflow.com/questions/49395316/checking-an-arrray-and-returning-a-bool/49395400#49395400", "title": "checking an arrray and returning a bool", "body": "<p>Your method of traversing the matrix is not scalable, you can easily introduce errors and is unnecessary complex. My 'check method' is 2 lines of code for any matrix size.</p>\n\n<p>This is how you roll -></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdbool.h&gt;\n#define MXSIZE 3\nbool is_full(char *block) {\n    for (int l=0;l&lt;MXSIZE*MXSIZE;l++)if(*(block+l)=='_')return false;\n    return true;\n}\nint main() {\n    char my2DArray[MXSIZE][MXSIZE]={{'O','O','O'},{'O','O','O'},{'O','O','_'}};\n    printf(\"%s\",is_full(&amp;my2DArray[0][0])?\"The array is full\\n\":\"The array is not full\\n\");\n    return 0;\n}\n</code></pre>\n\n<p>(LOL.. for the down vote.)</p>\n\n<p>/A</p>\n"}, {"comments": [{"owner": {"reputation": 280, "user_id": 790463, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e54ac851fd2c01eea0fb5e11506fed87?s=128&d=identicon&r=PG&f=1", "display_name": "jyotesh", "link": "https://stackoverflow.com/users/790463/jyotesh"}, "edited": false, "score": 0, "creation_date": 1521586372, "post_id": 49395424, "comment_id": 85792680, "body": "I was just typing the same answer. You beat me to it. :)"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1521595832, "post_id": 49395424, "comment_id": 85795248, "body": "There should be an argument given, e.g. <code>check_table_full(board)</code>"}], "tags": [], "owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "is_accepted": true, "score": 3, "last_activity_date": 1521586322, "creation_date": 1521586322, "answer_id": 49395424, "question_id": 49395316, "link": "https://stackoverflow.com/questions/49395316/checking-an-arrray-and-returning-a-bool/49395424#49395424", "title": "checking an arrray and returning a bool", "body": "<p><strong>If</strong> you do <code>printf(\"%s\", check_table_full?\"true\":\"false\");</code>, you are <em>not</em> calling the function.</p>\n\n<p><code>check_table_full</code> is the <em>address</em> of the function. You want <code>check_table_full()</code></p>\n"}, {"comments": [{"owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 0, "creation_date": 1521587741, "post_id": 49395544, "comment_id": 85793120, "body": "This is tagged <code>c</code> [not <code>c++</code>] so <code>string</code> is not available. Also, your function falls off the end without a  <code>return</code>, so the last line should be <code>return true;</code>"}, {"owner": {"reputation": 1, "user_id": 6308731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f25d458396f73d55b0d41f8076a5365e?s=128&d=identicon&r=PG&f=1", "display_name": "Chuck Bartowski", "link": "https://stackoverflow.com/users/6308731/chuck-bartowski"}, "edited": false, "score": 0, "creation_date": 1521588007, "post_id": 49395544, "comment_id": 85793186, "body": "Thank you Craig. I had no idea that string was not available in C. I will edit my code to reflect that, so hopefully the questionier will understand what I am saying."}], "tags": [], "owner": {"reputation": 1, "user_id": 6308731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f25d458396f73d55b0d41f8076a5365e?s=128&d=identicon&r=PG&f=1", "display_name": "Chuck Bartowski", "link": "https://stackoverflow.com/users/6308731/chuck-bartowski"}, "is_accepted": false, "score": 0, "last_activity_date": 1521595665, "last_edit_date": 1521595665, "creation_date": 1521587038, "answer_id": 49395544, "question_id": 49395316, "link": "https://stackoverflow.com/questions/49395316/checking-an-arrray-and-returning-a-bool/49395544#49395544", "title": "checking an arrray and returning a bool", "body": "<p>You may want to use nested for-loops. I have learned C++ syntax and not C syntax, so the syntax may be a little off.\nExample Code...</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint main() {\n    char board[2][2];\n    int outer_count, inner_count;\n    //It will use nested for loops\n    for (outer_count = 0; outer_count &lt;= 2; count++) {\n        for (inner_count = 0; inner_count &lt;= 2; count ++) {\n            if (board[outer_count][inner_count] == '_'){\n                return false;\n            }\n        }\n    }\n    return True\n}\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 9519541, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Luke ", "link": "https://stackoverflow.com/users/9519541/luke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 273, "favorite_count": 1, "accepted_answer_id": 49395424, "answer_count": 3, "score": 0, "last_activity_date": 1521628829, "creation_date": 1521585725, "last_edit_date": 1521586280, "question_id": 49395316, "link": "https://stackoverflow.com/questions/49395316/checking-an-arrray-and-returning-a-bool", "title": "checking an arrray and returning a bool", "body": "<p>I'm in a CS class and I'm trying to create a tic tac toe program. This is my first time using functions and I need help checking a 2d array to see if it is full with 'x' or 'o' s. I initialized to start off with all the elements to '_' and I want a return value of true or false so I'm using <code>#include &lt;stdbool.h&gt;</code>. Here is the function:</p>\n\n<pre><code>bool check_table_full(char board[SIZE][SIZE]){\n\n    if(board[0][0] == '_'){\n       return false;\n    }else if(board[1][0] == '_'){\n       return false;\n    }else if(board[2][0] == '_'){\n       return false;\n    }else if(board[0][1] == '_'){\n       return false;\n    }else if(board[1][1] == '_'){\n       return false;\n    }else if(board[2][1] == '_'){\n       return false;\n    }else if(board[0][2] == '_'){\n       return false;\n    }else if(board[1][2] == '_'){\n       return false;\n    }else if(board[2][2] == '_'){\n       return false;\n    }else{\n        return true;\n}\n</code></pre>\n\n<p>I know there is a better optimization then using if else statement but this is just is simple in my head. I use <code>printf(\"%s\", check_table_full?\"true\":\"false\");</code> to check if it returns false as it should since all elements in the array are '_'. No matter what I do it prints true, and if I change the \"true\" in the printf statement it prints whatever is inside the first quote.</p>\n\n<p>Everything else works like SIZE is defined, the array is defined, I just can't get this function to return false.</p>\n\n<p>Sorry if this is lengthy, this is my first time asking a question on here. </p>\n"}, {"tags": ["c", "stm32", "i2c", "atmega", "nucleo"], "comments": [{"owner": {"reputation": 170455, "user_id": 149341, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/omfTQ.png?s=128&g=1", "display_name": "duskwuff -inactive-", "link": "https://stackoverflow.com/users/149341/duskwuff-inactive"}, "edited": false, "score": 2, "creation_date": 1521586118, "post_id": 49395314, "comment_id": 85792565, "body": "What code do you have running on the Mega328? Without a device configured at that address, you will get timeouts when you try to select it."}, {"owner": {"reputation": 79, "user_id": 1776802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/259db9a4f27bc04aff01680a0bae6cdf?s=128&d=identicon&r=PG", "display_name": "Robybyte", "link": "https://stackoverflow.com/users/1776802/robybyte"}, "reply_to_user": {"reputation": 170455, "user_id": 149341, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/omfTQ.png?s=128&g=1", "display_name": "duskwuff -inactive-", "link": "https://stackoverflow.com/users/149341/duskwuff-inactive"}, "edited": false, "score": 0, "creation_date": 1521622073, "post_id": 49395314, "comment_id": 85804589, "body": "It is [link]<a href=\"https://www.arduino.cc/en/Tutorial/MasterReader\" rel=\"nofollow noreferrer\">arduino.cc/en/Tutorial/MasterReader</a> Code for Slave Sender - Program for Arduino 2 running at the Mega328. The address is set with  Wire.begin(8);"}, {"owner": {"reputation": 79, "user_id": 1776802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/259db9a4f27bc04aff01680a0bae6cdf?s=128&d=identicon&r=PG", "display_name": "Robybyte", "link": "https://stackoverflow.com/users/1776802/robybyte"}, "reply_to_user": {"reputation": 170455, "user_id": 149341, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/omfTQ.png?s=128&g=1", "display_name": "duskwuff -inactive-", "link": "https://stackoverflow.com/users/149341/duskwuff-inactive"}, "edited": false, "score": 0, "creation_date": 1522962312, "post_id": 49395314, "comment_id": 86374791, "body": "The solution was very  easy. It was an not cleared interrupt."}], "owner": {"reputation": 79, "user_id": 1776802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/259db9a4f27bc04aff01680a0bae6cdf?s=128&d=identicon&r=PG", "display_name": "Robybyte", "link": "https://stackoverflow.com/users/1776802/robybyte"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 276, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1522688567, "creation_date": 1521585696, "last_edit_date": 1522688567, "question_id": 49395314, "link": "https://stackoverflow.com/questions/49395314/stm32-f302r8-nucleo-i2c-notworking", "title": "STM32 F302R8 Nucleo I2C Notworking", "body": "<p>I have got a problem with the development of a i2c communication between a ATMega328 and a STM32 F302R8 controller. </p>\n\n<p>Below the initialisation code of the st controller, generated by Cube. </p>\n\n<pre><code>void MX_I2C2_Init(void) {\n\nhi2c2.Instance = I2C2;\nhi2c2.Init.Timing = 0x2000090E;\nhi2c2.Init.OwnAddress1 = 0;\nhi2c2.Init.AddressingMode = I2C_ADDRESSINGMODE_7BIT;\nhi2c2.Init.DualAddressMode = I2C_DUALADDRESS_DISABLE;\nhi2c2.Init.OwnAddress2 = 0;\nhi2c2.Init.OwnAddress2Masks = I2C_OA2_NOMASK;\nhi2c2.Init.GeneralCallMode = I2C_GENERALCALL_DISABLE;\nhi2c2.Init.NoStretchMode = I2C_NOSTRETCH_DISABLE;\nif (HAL_I2C_Init(&amp;hi2c2) != HAL_OK) {\n    _Error_Handler(__FILE__, __LINE__);\n}\n\n/**Configure Analogue filter\n */\nif (HAL_I2CEx_ConfigAnalogFilter(&amp;hi2c2, I2C_ANALOGFILTER_ENABLE)\n        != HAL_OK) {\n    _Error_Handler(__FILE__, __LINE__);\n}\n\n/**Configure Digital filter\n */\nif (HAL_I2CEx_ConfigDigitalFilter(&amp;hi2c2, 0) != HAL_OK) {\n    _Error_Handler(__FILE__, __LINE__);\n}\nHAL_I2C_MspInit(&amp;hi2c2);\n}\n\nvoid HAL_I2C_MspInit(I2C_HandleTypeDef* i2cHandle) {\n\nGPIO_InitTypeDef GPIO_InitStruct;\nif (i2cHandle-&gt;Instance == I2C2) {\n    /* USER CODE BEGIN I2C2_MspInit 0 */\n\n    /* USER CODE END I2C2_MspInit 0 */\n\n    /**I2C2 GPIO Configuration\n     PA9     ------&gt; I2C2_SCL\n     PA10     ------&gt; I2C2_SDA\n     */\n    GPIO_InitStruct.Pin = GPIO_PIN_9 | GPIO_PIN_10;\n    GPIO_InitStruct.Mode = GPIO_MODE_AF_OD;\n    GPIO_InitStruct.Pull = GPIO_PULLUP;\n    GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_HIGH;\n    GPIO_InitStruct.Alternate = GPIO_AF4_I2C2;\n    HAL_GPIO_Init(GPIOA, &amp;GPIO_InitStruct);\n\n    /* I2C2 clock enable */\n    __HAL_RCC_I2C2_CLK_ENABLE()\n    ;\n    /* USER CODE BEGIN I2C2_MspInit 1 */\n\n    /* USER CODE END I2C2_MspInit 1 */\n}\n</code></pre>\n\n<p>}</p>\n\n<p>I added the <code>HAL_I2C_MspInit(&amp;hi2c2);</code> call for setting the pins in the right mode.</p>\n\n<p>The Function SerialMain part of a thread and will be called regularly. </p>\n\n<pre><code>void SerialMain(void const* arg) {\nMX_USART1_UART_Init();\nMX_I2C2_Init();\nchar *buffer = \"Hello World! \";\nint cnt = 0;\nfor (;;) {\n    cnt++;\n    if (HAL_I2C_Master_Transmit(&amp;hi2c2, 8 , buffer, 13, 1000) != HAL_OK) { //PA9   SCL PA10 SDA\n        SerialError();\n    }\n    if (HAL_I2C_Master_Transmit(&amp;hi2c2, 8 &gt;&gt; 1, &amp;cnt, sizeof(cnt), 1000)\n            != HAL_OK) { //PA9 SCL PA10 SDA\n        SerialError();\n    }\n    osDelay(10);\n\n}\n\n}\n</code></pre>\n\n<p>After trying to transmit the  Hello World message the HAL_I2C_Master_Transmit will return HAL_TIMEOUT. </p>\n\n<p>Does someone know why it returns HAL_TIMEOUT? </p>\n\n<p>Does someone know how to transmit data successfully?</p>\n"}, {"tags": ["c", "arrays", "string", "csv", "archive"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1521586297, "post_id": 49395313, "comment_id": 85792648, "body": "Why the <code>rewind</code> and why the <code>fseek</code> and why the <code>fscanf</code> since you already read sequential lines with <code>fgets</code>?"}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 1, "creation_date": 1521586416, "post_id": 49395313, "comment_id": 85792700, "body": "What&#39;s the point of this line? <code>fseek(csv, +1, SEEK_CUR);</code>"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1521586489, "post_id": 49395313, "comment_id": 85792723, "body": "You can use <code>sscanf</code> to extract the data from <code>linha</code>."}], "answers": [{"comments": [{"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1521588289, "post_id": 49395692, "comment_id": 85793267, "body": "replace the line <code>line[len-1] = &#39;\\0&#39;;</code> with <code>line[strcspn(line, &quot;\\n&quot;)] = 0;</code>, you want to remove the newline if and only if there is a newline."}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1521588340, "post_id": 49395692, "comment_id": 85793287, "body": "And use <code>strncpy</code> instead of <code>strcpy</code> otherwise you might overflow <code>v[i].data</code>"}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1521588629, "post_id": 49395692, "comment_id": 85793383, "body": "You should check that <code>i</code> doesn&#39;t get to <code>num_lines</code>, otherwise you are overflowing the allocated memory."}, {"owner": {"user_type": "does_not_exist", "display_name": "user9478968"}, "reply_to_user": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1521588772, "post_id": 49395692, "comment_id": 85793436, "body": "@Pablo <code>strncpy</code> and <code>strcspn</code> are best practice but I was only giving an minimal example to convey the ideas. Not necessarily handling all edge cases."}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1521589511, "post_id": 49395692, "comment_id": 85793674, "body": "<i>The first line contains the number of lines to be read</i>  yes, I deleted the comment after I realized that the first line has the total number of lines. I&#39;ve seen similar questions where the OP reads the whole CSV first in order to calculate the number of lines. That confused me at first and that&#39;s why I wrote the comment, then I realized my mistake and removed the comment."}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1521589609, "post_id": 49395692, "comment_id": 85793699, "body": "<i>Not necessarily handling all edge cases</i> I don&#39;t agree with that, even if it&#39;s a &quot;minimal example&quot;, code should be correct and using <code>strcpy</code> when you don&#39;t know the length of the source string, is incorrect. If the size of the source buffer were smaller than <code>v[i].data</code>, then that would be OK, but this is not the case."}, {"owner": {"user_type": "does_not_exist", "display_name": "user9478968"}, "reply_to_user": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 1, "creation_date": 1521590019, "post_id": 49395692, "comment_id": 85793783, "body": "Changed length of src buffer to be the same as v[i].data."}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1521590429, "post_id": 49395692, "comment_id": 85793898, "body": "That&#39;s OK then."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user9478968"}, "is_accepted": true, "score": 1, "last_activity_date": 1521589812, "last_edit_date": 1521589812, "creation_date": 1521587966, "answer_id": 49395692, "question_id": 49395313, "link": "https://stackoverflow.com/questions/49395313/c-turning-lines-of-an-archive-into-arrays/49395692#49395692", "title": "C Turning lines of an archive into arrays", "body": "<p>There were a number of mistakes so I went ahead and rewrote the problem areas with comments explaining what I did</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\ntypedef struct{\n    char data[20];\n\n}vetor;\n\nint main(int argc,char *argv[]){\n    FILE *csv;\n\n    if((csv=fopen(argv[1], \"r\")) == NULL  )\n    {\n        printf(\"not found csv\\n\");\n        exit(1);\n    }\n\n    char line[20];\n\n    // Read number of lines\n    int num_lines = 0;\n    if (!fgets(line, sizeof(line), csv)) {\n        printf(\"Cannot read line\\n\");\n        exit(1);    \n    }\n    char* token = strtok(line, \"\\n\");\n    num_lines = atoi(token) + 1;\n    vetor* v = malloc(num_lines * sizeof(vetor));\n\n    // Fill in vetor\n    int i = 0;\n    while (fgets(line, sizeof(line), csv) != NULL) {\n        int len = strlen(line);\n        line[len-1] = '\\0'; // replace newline with string terminator\n        strcpy(v[i].data, line); //copy line into v[i].data\n        i++;\n    }\n\n    printf(\"%d\\n\", num_lines);\n    for (i = 0; i &lt; num_lines; i++) {\n            printf(\"%s\\n\", v[i].data);\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>I think the main mistake was a misunderstanding of how best to read in each line of information. If I understood correctly you want each <code>02/20/18,11403.7</code> line to be an element in the <code>vetor</code> array.</p>\n\n<p>The easiest way is to simply get each line one at a time with fgets</p>\n\n<pre><code>while (fgets(line, sizeof(line), csv) != NULL) \n</code></pre>\n\n<p>Change the ending character from newline to the string terminating character <code>'\\0'</code></p>\n\n<pre><code>int len = strlen(line);\nline[len-1] = '\\0';\n</code></pre>\n\n<p>Then copy the string into the ith element of <code>vetor</code> and update <code>i</code> for the next iteration of the loop.</p>\n\n<pre><code>strcpy(v[i].data, line);\ni++;\n</code></pre>\n"}], "owner": {"reputation": 125, "user_id": 9464367, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7e8b7320b8f6bfcba2bbb6302a5a293a?s=128&d=identicon&r=PG&f=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/9464367/andre"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 49395692, "answer_count": 1, "score": 1, "last_activity_date": 1521589812, "creation_date": 1521585688, "question_id": 49395313, "link": "https://stackoverflow.com/questions/49395313/c-turning-lines-of-an-archive-into-arrays", "title": "C Turning lines of an archive into arrays", "body": "<p>I have an archive and I want to turn every line into an array: v[i].data.\nHowever, when I run the code it shows zeros for the arrays.\nIs there anything I should change?</p>\n\n<p><strong>Input</strong>   </p>\n\n<blockquote>\n  <p>1760<br>\n  02/20/18,11403.7<br>\n  02/19/18,11225.3<br>\n  02/18/18,10551.8<br>\n  02/17/18,11112.7<br>\n  02/16/18,10233.9</p>\n</blockquote>\n\n<p><strong>Actual Output</strong>   </p>\n\n<blockquote>\n  <p>1761<br>\n      0</p>\n</blockquote>\n\n<p><strong>Expected Output</strong></p>\n\n<blockquote>\n  <p>1761<br>\n  02/20/18,11403.7      </p>\n</blockquote>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;math.h&gt;\n#include &lt;string.h&gt;\n\n\ntypedef struct{\n    char data[20];\n\n}vetor;\n\nint main(int argc,char *argv[]){\n    FILE *csv;\n\n        if((csv=fopen(argv[1], \"r\")) == NULL  )\n        {\n            printf(\"not found csv\\n\");\n            exit(1);\n        }\n\n\n        long int a=0;\n\n        char linha[256];\n\n        char *token = NULL;\n\n        if(fgets(linha, sizeof(linha), csv)) //counting lines\n        {\n            token = strtok(linha, \"\\n\");\n            a =(1 + atoi(token));\n        }\n\n\n        printf(\"%d\\n\", a);\n\n        rewind(csv);\n\n        vetor *v;\n\n        v=(vetor*)malloc(a*sizeof(vetor));\n\n        char linha2[256];\n\n        while (fgets(linha2, sizeof(linha2), csv) != 0)\n        {\n            fseek(csv, +1, SEEK_CUR);\n\n            for(int i=0;i&lt;a;i++)\n            {   \n                fscanf(csv, \"%[^\\n]\", v[i].data);\n\n\n            }\n        }\n\n        printf(\"%s\\n\", v[0].data);\n\n\n    fclose(csv);\n\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "linux", "c++11", "signals", "sigint"], "comments": [{"owner": {"reputation": 1487, "user_id": 276311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2badde067ffa52cab3d6b1dfbebb4bc5?s=128&d=identicon&r=PG", "display_name": "Adriano P", "link": "https://stackoverflow.com/users/276311/adriano-p"}, "edited": false, "score": 1, "creation_date": 1521585975, "post_id": 49395268, "comment_id": 85792517, "body": "Please post a <a href=\"https://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable example</a>. And welcome to StackOverflow!"}, {"owner": {"reputation": 33, "user_id": 9525414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/215e78f336fb05ee43efe8813b3eb9ce?s=128&d=identicon&r=PG&f=1", "display_name": "GouzdniJouza", "link": "https://stackoverflow.com/users/9525414/gouzdnijouza"}, "reply_to_user": {"reputation": 1487, "user_id": 276311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2badde067ffa52cab3d6b1dfbebb4bc5?s=128&d=identicon&r=PG", "display_name": "Adriano P", "link": "https://stackoverflow.com/users/276311/adriano-p"}, "edited": false, "score": 0, "creation_date": 1521587192, "post_id": 49395268, "comment_id": 85792943, "body": "Sorry, I forgot. Added. And thanks."}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 9525414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/215e78f336fb05ee43efe8813b3eb9ce?s=128&d=identicon&r=PG&f=1", "display_name": "GouzdniJouza", "link": "https://stackoverflow.com/users/9525414/gouzdnijouza"}, "edited": false, "score": 0, "creation_date": 1521645921, "post_id": 49395910, "comment_id": 85822155, "body": "Yeah but where do I star the time measure? I&#39;m trying to measure the time with time.h libraries. But I don&#39;t know where to put it."}], "tags": [], "owner": {"reputation": 6882, "user_id": 3403834, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xpA5S.jpg?s=128&g=1", "display_name": "user58697", "link": "https://stackoverflow.com/users/3403834/user58697"}, "is_accepted": false, "score": 1, "last_activity_date": 1521589580, "creation_date": 1521589580, "answer_id": 49395910, "question_id": 49395268, "link": "https://stackoverflow.com/questions/49395268/signals-kill-the-process-with-ctrl-c-and-stop-the-process-with-ctrl-z-measur/49395910#49395910", "title": "Signals - kill the process with CTRL-C and stop the process with CTRL-Z + measure the time", "body": "<p>Quoting <code>man signal</code>,</p>\n\n<blockquote>\n  <p><code>SIGSTOP</code> cannot be caught or ignored.</p>\n</blockquote>\n\n<p>The only solution I see is to poll current time, and measure the delta between current and previous sample. A difference large enough would most likely indicate that the program has been stopped.</p>\n\n<p>This is not precise, but I guess that for your exercise can be good enough.</p>\n\n<p>PS: don't <code>printf</code> in a signal handler.</p>\n"}], "owner": {"reputation": 33, "user_id": 9525414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/215e78f336fb05ee43efe8813b3eb9ce?s=128&d=identicon&r=PG&f=1", "display_name": "GouzdniJouza", "link": "https://stackoverflow.com/users/9525414/gouzdnijouza"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1127, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1521646077, "creation_date": 1521585491, "last_edit_date": 1521646077, "question_id": 49395268, "link": "https://stackoverflow.com/questions/49395268/signals-kill-the-process-with-ctrl-c-and-stop-the-process-with-ctrl-z-measur", "title": "Signals - kill the process with CTRL-C and stop the process with CTRL-Z + measure the time", "body": "<p>I need to make a program where the process indefinitely writes three dots. When pressing <kbd>CTRL</kbd>+<kbd>C</kbd> (using <em>SIGINT</em>) the program needs to write the goodbye message and kill the process. When pressing <kbd>CTRL</kbd>+<kbd>Z</kbd> and then <em>fg</em> (using <em>SIGCONT</em>) the program need to measure the time which passed during this time in seconds and for every second that has passed the program needs to write one dot. When the program write all dots of one, it returns to three dots. </p>\n\n<pre><code>$ ./program\n...\n...\n...\n...\n... &lt;pressing Ctrl+Z&gt;\n$ &lt;we wait few seconds (5)&gt;\n$ fg\n.\n.\n.\n.\n.\n...\n...\n...\n...\n&lt;pressing Ctrl+C&gt;\nEnding\n$\n</code></pre>\n\n<p>I managed to get through the first part (killing the process with <kbd>CTRL</kbd>+<kbd>C</kbd> while in an infinite loop) but I can't find the way to measure the time after stopping the process with <kbd>CTRL</kbd>+<kbd>Z</kbd> and then continue with fg. </p>\n\n<p>Current working code:</p>\n\n<pre><code>bool stop = true;\n\nvoid end(int sig){\n    printf(\"ending\\n\");\n    //signal(SIGINT, SIG_DFL);\n    //kill(getpid(), SIGINT);\n    stop = false;\n}\n\nint main(){\n    struct sigaction act;\n    act.sa_handler = end;\n    sigemptyset(&amp;act.sa_mask);\n    act.sa_flags = 0;\n    sigaction(SIGINT, &amp;act, 0);\n    while(stop) {\n        printf(\"...\\n\");\n        sleep(1);\n    }\n    return 0;\n}\n</code></pre>\n\n<p>How I'm planing to measure the time:</p>\n\n<pre><code>t = clock();\npause();\nt = clock() - t;\ndouble time = ((double)t)/CLOCKS_PER_SEC;\nprintf(\"time: %f\", time);\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 21326, "user_id": 1679849, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpvxY.png?s=128&g=1", "display_name": "r3mainer", "link": "https://stackoverflow.com/users/1679849/r3mainer"}, "edited": false, "score": 1, "creation_date": 1521584132, "post_id": 49394931, "comment_id": 85791677, "body": "Apparently <a href=\"https://sourceware.org/gdb/onlinedocs/gdb/Inline-Functions.html\" rel=\"nofollow noreferrer\">support for inline functions isn&#39;t universal</a>. It might help if you mention which compiler and which version of GDB you&#39;re using."}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 1, "creation_date": 1521584196, "post_id": 49394931, "comment_id": 85791699, "body": "have you checked if the real return value from <code>isInBounds</code> is 1 or 0 rather than just <code>gdb</code>?"}, {"owner": {"reputation": 5867, "user_id": 2252087, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/020cbe41b02f03d59f3adae022c0ce7d?s=128&d=identicon&r=PG", "display_name": "ensc", "link": "https://stackoverflow.com/users/2252087/ensc"}, "edited": false, "score": 0, "creation_date": 1521584220, "post_id": 49394931, "comment_id": 85791705, "body": "the values and types of <code>y</code> and <code>surface-&gt;h</code> would be interesting here."}, {"owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 3, "creation_date": 1521584367, "post_id": 49394931, "comment_id": 85791769, "body": "Also, note that this occurs after a segfault, so some of the values may not be able to be trusted."}, {"owner": {"reputation": 1036, "user_id": 8209813, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-50FvkCZNkNA/AAAAAAAAAAI/AAAAAAAAABM/kJBPktdQ6uQ/photo.jpg?sz=128", "display_name": "Nick S", "link": "https://stackoverflow.com/users/8209813/nick-s"}, "edited": false, "score": 1, "creation_date": 1521584576, "post_id": 49394931, "comment_id": 85791868, "body": "Also, you checked for y &gt;= img-&gt;h twice"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1521586171, "post_id": 49394931, "comment_id": 85792594, "body": "&quot;shouldn&#39;t the function isInBounds(surface,x,y) return 0 &quot;  No.  After a segfault, behavior is not defined.  Fix the cause of the seg  fault first."}, {"owner": {"reputation": 102, "user_id": 9277345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9209f7eedbbae54ecbd99877bea46a4c?s=128&d=identicon&r=PG&f=1", "display_name": "vincent456", "link": "https://stackoverflow.com/users/9277345/vincent456"}, "edited": false, "score": 0, "creation_date": 1521586430, "post_id": 49394931, "comment_id": 85792707, "body": "gcc version 5.4.0 20160609 (Ubuntu 5.4.0-6ubuntu1~16.04.9), GNU gdb (Ubuntu 7.11.1-0ubuntu1~16.5) 7.11.1, y and surface-&gt;h are both int and their values are equals. For a little bit of context, I&#39;m writing a C application with SDL2 library (for a school project). I have this program that runs, and iterate y over the height of an image (which is a SDL_Surface) and the segfault appears because I iterate until y reaches the very end of the height of the picture. isInBounds should check if the coordinate (x,y) is still inside the picture or out of bounds, but doesn&#39;t seems to work."}, {"owner": {"reputation": 811, "user_id": 9493582, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bfI3b.jpg?s=128&g=1", "display_name": "Arndt Jonasson", "link": "https://stackoverflow.com/users/9493582/arndt-jonasson"}, "edited": false, "score": 0, "creation_date": 1521635400, "post_id": 49394931, "comment_id": 85813728, "body": "Add a printing statement in the function, showing all of <code>x</code>, <code>img-&gt;w</code>, <code>y</code> and <code>img-h</code>."}, {"owner": {"reputation": 811, "user_id": 9493582, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bfI3b.jpg?s=128&g=1", "display_name": "Arndt Jonasson", "link": "https://stackoverflow.com/users/9493582/arndt-jonasson"}, "edited": false, "score": 0, "creation_date": 1521643580, "post_id": 49394931, "comment_id": 85820234, "body": "(<code>img-&gt;h</code>, of course)"}], "answers": [{"tags": [], "owner": {"reputation": 102, "user_id": 9277345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9209f7eedbbae54ecbd99877bea46a4c?s=128&d=identicon&r=PG&f=1", "display_name": "vincent456", "link": "https://stackoverflow.com/users/9277345/vincent456"}, "is_accepted": true, "score": 0, "last_activity_date": 1521722393, "creation_date": 1521722393, "answer_id": 49428947, "question_id": 49394931, "link": "https://stackoverflow.com/questions/49394931/my-code-returns-an-unexcpected-value/49428947#49428947", "title": "My code returns an unexcpected value", "body": "<p>The error solved itself one day when I re-run it. Gods know what happened.</p>\n"}], "owner": {"reputation": 102, "user_id": 9277345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9209f7eedbbae54ecbd99877bea46a4c?s=128&d=identicon&r=PG&f=1", "display_name": "vincent456", "link": "https://stackoverflow.com/users/9277345/vincent456"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "accepted_answer_id": 49428947, "answer_count": 1, "score": 2, "last_activity_date": 1521722393, "creation_date": 1521583721, "last_edit_date": 1592644375, "question_id": 49394931, "link": "https://stackoverflow.com/questions/49394931/my-code-returns-an-unexcpected-value", "title": "My code returns an unexcpected value", "body": "<p>Sorry for the generic question but I've come across a behaviour in my code that I can't explain and that I find relevant for further users.\nThere is the screenshot of my screen when it happend. It's a repeatable error that happend any time my code runs.\n<a href=\"https://i.stack.imgur.com/2smxg.png\" rel=\"nofollow noreferrer\">screenshot</a>\nand there is the text version of it.\nMy code runs a function</p>\n<pre><code>inline static int isInBounds(SDL_Surface* img,int x,int y){\n  if((x&lt;0)||(x &gt;= img-&gt;w)||(y&lt;0)||(y &gt;= img-&gt;h) ) return 0;\n  return 1;\n}\n</code></pre>\n<p>I ran my code using gdb and I got the results</p>\n<pre><code>(gdb) print isInBounds(surface,x,y)\n$1 = 1\n(gdb) print y &gt;= surface-&gt;h\n$2 = 1\n</code></pre>\n<p>I don't get it. If (y &gt;= surface-&gt;h) = 1, shouldn't the function isInBounds(surface,x,y) return 0 since the if statement is fulfilled ?</p>\n"}, {"tags": ["c", "memory-leaks", "valgrind"], "comments": [{"owner": {"reputation": 1828, "user_id": 2584754, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/Q3gFD.jpg?s=128&g=1", "display_name": "sturcotte06", "link": "https://stackoverflow.com/users/2584754/sturcotte06"}, "edited": false, "score": 0, "creation_date": 1521582979, "post_id": 49394746, "comment_id": 85791186, "body": "add <code>--track-origins=yes</code>."}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1521582980, "post_id": 49394746, "comment_id": 85791187, "body": "Can you post the whole output of valgrind?"}, {"owner": {"reputation": 811, "user_id": 9493582, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bfI3b.jpg?s=128&g=1", "display_name": "Arndt Jonasson", "link": "https://stackoverflow.com/users/9493582/arndt-jonasson"}, "edited": false, "score": 0, "creation_date": 1521583129, "post_id": 49394746, "comment_id": 85791248, "body": "You can perhaps remove parts of your program to see if they are responsible for this, until you have something small enough to show here."}, {"owner": {"reputation": 85, "user_id": 6365084, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/314bc6464f0bd0a4b59d65df260891ea?s=128&d=identicon&r=PG&f=1", "display_name": "fabero", "link": "https://stackoverflow.com/users/6365084/fabero"}, "reply_to_user": {"reputation": 1828, "user_id": 2584754, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/Q3gFD.jpg?s=128&g=1", "display_name": "sturcotte06", "link": "https://stackoverflow.com/users/2584754/sturcotte06"}, "edited": false, "score": 0, "creation_date": 1521583257, "post_id": 49394746, "comment_id": 85791297, "body": "@sturcotte06 I added --track-origins=yes and adjusted the output."}, {"owner": {"reputation": 85, "user_id": 6365084, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/314bc6464f0bd0a4b59d65df260891ea?s=128&d=identicon&r=PG&f=1", "display_name": "fabero", "link": "https://stackoverflow.com/users/6365084/fabero"}, "reply_to_user": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1521583278, "post_id": 49394746, "comment_id": 85791306, "body": "@Pablo This is the complete output (without input output cases for brevity)"}, {"owner": {"reputation": 85, "user_id": 6365084, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/314bc6464f0bd0a4b59d65df260891ea?s=128&d=identicon&r=PG&f=1", "display_name": "fabero", "link": "https://stackoverflow.com/users/6365084/fabero"}, "reply_to_user": {"reputation": 811, "user_id": 9493582, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bfI3b.jpg?s=128&g=1", "display_name": "Arndt Jonasson", "link": "https://stackoverflow.com/users/9493582/arndt-jonasson"}, "edited": false, "score": 0, "creation_date": 1521583343, "post_id": 49394746, "comment_id": 85791335, "body": "@ArndtJonasson That would be quite difficult as the program handles expression trees and all parts are needed"}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1521583390, "post_id": 49394746, "comment_id": 85791362, "body": "Did you compile your code with <code>-g</code>? Compiler it with <code>-g</code> and rerun valgrind."}, {"owner": {"reputation": 85, "user_id": 6365084, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/314bc6464f0bd0a4b59d65df260891ea?s=128&d=identicon&r=PG&f=1", "display_name": "fabero", "link": "https://stackoverflow.com/users/6365084/fabero"}, "reply_to_user": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1521583451, "post_id": 49394746, "comment_id": 85791380, "body": "@Pablo thats what I did."}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 4, "creation_date": 1521583732, "post_id": 49394746, "comment_id": 85791493, "body": "Could it be that you are adding <code>--leak-check=full</code> at the end of the command line? In that case valgrind will think that this is an argument for the program it&#39;s testing, not for itself. Did you run <code>valgrind --leak-check=full .&#47;your_program arg1 arg2...</code>?"}, {"owner": {"reputation": 85, "user_id": 6365084, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/314bc6464f0bd0a4b59d65df260891ea?s=128&d=identicon&r=PG&f=1", "display_name": "fabero", "link": "https://stackoverflow.com/users/6365084/fabero"}, "reply_to_user": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1521584003, "post_id": 49394746, "comment_id": 85791618, "body": "@Pablo Ah yes that was probably the problem! Thank you very much! Now it found three errors (that I also do not understand, but at least this is some progress :-) )!"}, {"owner": {"reputation": 1132, "user_id": 721721, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HiJkX.jpg?s=128&g=1", "display_name": "Miroslav Franc", "link": "https://stackoverflow.com/users/721721/miroslav-franc"}, "reply_to_user": {"reputation": 1828, "user_id": 2584754, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/Q3gFD.jpg?s=128&g=1", "display_name": "sturcotte06", "link": "https://stackoverflow.com/users/2584754/sturcotte06"}, "edited": false, "score": 1, "creation_date": 1521584135, "post_id": 49394746, "comment_id": 85791680, "body": "@sturcotte06 <code>--track-origins=yes</code> is for tracking sources of uninitialized data, it has nothing to do with memory leaks. <code>--leak-check=full</code> is what he needs."}, {"owner": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 1, "creation_date": 1521587027, "post_id": 49394746, "comment_id": 85792898, "body": "Valgrind is saying that somewhere in your code  you have malloc&#39;ed some memory that you have never freed . Doing  just that might not be an issue in itself, and valgrind does not count it as errors. WHen you ran valgrind with the --leak.check=full, the important part is in the &quot;(This is where the input and output cases are displayed, which are a lot)&quot; part that you left out. This will show you where you allocate the memory that you have not freed, and you need to figure out if that is a problem or not. As always, start with the 1. item, fix it, re-run valgrind and fix the 1.item ...."}], "answers": [{"comments": [{"owner": {"reputation": 85, "user_id": 6365084, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/314bc6464f0bd0a4b59d65df260891ea?s=128&d=identicon&r=PG&f=1", "display_name": "fabero", "link": "https://stackoverflow.com/users/6365084/fabero"}, "edited": false, "score": 0, "creation_date": 1521988697, "post_id": 49459714, "comment_id": 85956549, "body": "Thanks, this was indeed the solution. The errors turned out to be caused by valgrind not being supported as much on OS X as on Linux (<a href=\"https://stackoverflow.com/questions/34573039/possible-memory-leak-valgrind-in-osx-el-capitan/35592274\" title=\"possible memory leak valgrind in osx el capitan\">stackoverflow.com/questions/34573039/&hellip;</a>)."}], "tags": [], "owner": {"reputation": 326109, "user_id": 85371, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6d52c235ec6dd15f30bab444103e7af2?s=128&d=identicon&r=PG", "display_name": "sehe", "link": "https://stackoverflow.com/users/85371/sehe"}, "is_accepted": true, "score": 1, "last_activity_date": 1521848869, "creation_date": 1521848869, "answer_id": 49459714, "question_id": 49394746, "link": "https://stackoverflow.com/questions/49394746/valgrind-reporting-memory-definitely-lost-without-errors/49459714#49459714", "title": "Valgrind reporting memory definitely lost without errors", "body": "<p>It <em>is</em> possible to get false positives (e.g. in shared library initializers, or things like <code>libcrypto.so</code> which does leak some allocation).</p>\n\n<p>However, you should always check - most likely you're forgetting some allocation.</p>\n\n<p>In your output, we can see:</p>\n\n<blockquote>\n<pre><code> Command: ./a.out --leak-check=full --track-origins=yes`\n</code></pre>\n</blockquote>\n\n<p>This indicates you've invoked valgrind with:</p>\n\n<pre><code>valgrind ./a.out --leak-check=full --track-origins=yes\n</code></pre>\n\n<p>You <strong>should</strong> use this:</p>\n\n<pre><code>valgrind --leak-check=full --track-origins=yes ./a.out\n</code></pre>\n\n<p>If you find a leak (or other diagnostic) that you cannot control because it's internal to a third-party library, you can make a <a href=\"https://wiki.wxwidgets.org/Valgrind_Suppression_File_Howto\" rel=\"nofollow noreferrer\">suppression file</a></p>\n"}], "owner": {"reputation": 85, "user_id": 6365084, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/314bc6464f0bd0a4b59d65df260891ea?s=128&d=identicon&r=PG&f=1", "display_name": "fabero", "link": "https://stackoverflow.com/users/6365084/fabero"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 530, "favorite_count": 0, "accepted_answer_id": 49459714, "answer_count": 1, "score": 1, "last_activity_date": 1521849346, "creation_date": 1521582901, "last_edit_date": 1521583167, "question_id": 49394746, "link": "https://stackoverflow.com/questions/49394746/valgrind-reporting-memory-definitely-lost-without-errors", "title": "Valgrind reporting memory definitely lost without errors", "body": "<p>I am testing C code for memory leaks and can't seem to find the source of the leaks because there are 0 errors. Valgrind reports that there is a (quite significant) memory leak:</p>\n\n<pre><code>==30492== Memcheck, a memory error detector\n==30492== Copyright (C) 2002-2017, and GNU GPL'd, by Julian Seward et al.\n==30492== Using Valgrind-3.14.0.GIT and LibVEX; rerun with -h for copyright \ninfo\n==30492== Command: ./a.out --leak-check=full --track-origins=yes\n==30492== \n(This is where the input and output cases are displayed, which are a lot)\n==30492== \n==30492== HEAP SUMMARY:\n==30492==     in use at exit: 39,155 bytes in 167 blocks\n==30492==   total heap usage: 380 allocs, 213 frees, 53,426 bytes allocated\n==30492== \n==30492== LEAK SUMMARY:\n==30492==    definitely lost: 20,480 bytes in 2 blocks\n==30492==    indirectly lost: 2,064 bytes in 1 blocks\n==30492==      possibly lost: 0 bytes in 0 blocks\n==30492==    still reachable: 348 bytes in 9 blocks\n==30492==         suppressed: 16,263 bytes in 155 blocks\n==30492== Rerun with --leak-check=full to see details of leaked memory\n==30492== \n==30492== For counts of detected and suppressed errors, rerun with: -v\n==30492== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 4 from 4)\n</code></pre>\n\n<p>The code is written in a few files and consists of hundreds of lines, so posting it here would probably be a bit much. Could anyone explain what could be the problem here? Or would you need to see the actual code to give an answer? I can find only little documentation on valgrind and am quite stuck here.</p>\n\n<p>(valgrind suggests to rerun with --leak-check=full, but that is what I did to get this output)</p>\n"}, {"tags": ["c", "collectd"], "comments": [{"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1521583333, "post_id": 49394733, "comment_id": 85791333, "body": "Can you also post the code around line 308 of the <code>daemon&#47;common.h</code> file? There must be an <code>#ifdef</code> check or something that the header file is doing and fails so that <code>#error</code> is evaluated."}, {"owner": {"reputation": 61, "user_id": 9525326, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/221d0a7cea4ddafd81665752bcbd52c1?s=128&d=identicon&r=PG&f=1", "display_name": "cyanbreak", "link": "https://stackoverflow.com/users/9525326/cyanbreak"}, "reply_to_user": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1521583456, "post_id": 49394733, "comment_id": 85791382, "body": "It&#39;s on github, <a href=\"https://github.com/collectd/collectd\" rel=\"nofollow noreferrer\">github.com/collectd/collectd</a>    <a href=\"https://github.com/collectd/collectd/blob/master/src/daemon/common.h\" rel=\"nofollow noreferrer\">github.com/collectd/collectd/blob/master/src/daemon/common.h</a>  I wouldn&#39;t think this should break since I literally copied load.c <a href=\"https://github.com/collectd/collectd/blob/master/src/load.c\" rel=\"nofollow noreferrer\">github.com/collectd/collectd/blob/master/src/load.c</a> and tried to compile it manually as a another plugin. I changed the includes #include &quot;collectd.h&quot;  #include &quot;common.h&quot; #include &quot;plugin.h&quot;      to daemon/common.h , etc"}, {"owner": {"reputation": 6021, "user_id": 206404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/497437666710e8b13ee168bd7b62fcba?s=128&d=identicon&r=PG", "display_name": "Stephen Newell", "link": "https://stackoverflow.com/users/206404/stephen-newell"}, "edited": false, "score": 0, "creation_date": 1521583522, "post_id": 49394733, "comment_id": 85791404, "body": "Paths on github can change or the project can be deleted.  Please put a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> directly in the question."}, {"owner": {"reputation": 9367, "user_id": 4454124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c094d8979fb41b789a7c7f21d9329359?s=128&d=identicon&r=PG&f=1", "display_name": "mnistic", "link": "https://stackoverflow.com/users/4454124/mnistic"}, "edited": false, "score": 0, "creation_date": 1521583714, "post_id": 49394733, "comment_id": 85791488, "body": "My guess is that you didn&#39;t run <code>autoconf</code> and <code>.&#47;configure</code> before <code>make</code>"}, {"owner": {"reputation": 61, "user_id": 9525326, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/221d0a7cea4ddafd81665752bcbd52c1?s=128&d=identicon&r=PG&f=1", "display_name": "cyanbreak", "link": "https://stackoverflow.com/users/9525326/cyanbreak"}, "edited": false, "score": 0, "creation_date": 1521583734, "post_id": 49394733, "comment_id": 85791496, "body": "This is from common.h"}, {"owner": {"reputation": 61, "user_id": 9525326, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/221d0a7cea4ddafd81665752bcbd52c1?s=128&d=identicon&r=PG&f=1", "display_name": "cyanbreak", "link": "https://stackoverflow.com/users/9525326/cyanbreak"}, "edited": false, "score": 0, "creation_date": 1521583956, "post_id": 49394733, "comment_id": 85791593, "body": "I ran autoconf and ./configure and make when I was trying to get it work with the build system of collectd. And that didn&#39;t work. Now I&#39;m just trying to use gcc to compile a single plugin, then drop that compiled library in and put it in autoconf. Shouldn&#39;t that work too?"}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1521584459, "post_id": 49394733, "comment_id": 85791804, "body": "Did <code>.&#47;configure</code> generate a <code>config.h</code> file (or similar)? You should also include that file, this file might have the necessary <code>#defines</code> calculated during <code>.&#47;configure</code> like <code>FP_LAYOUT_NEED_NOTHING</code> or <code>FP_LAYOUT_NEED_ENDIANFLIP</code>"}, {"owner": {"reputation": 61, "user_id": 9525326, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/221d0a7cea4ddafd81665752bcbd52c1?s=128&d=identicon&r=PG&f=1", "display_name": "cyanbreak", "link": "https://stackoverflow.com/users/9525326/cyanbreak"}, "edited": false, "score": 0, "creation_date": 1521585500, "post_id": 49394733, "comment_id": 85792285, "body": "I don&#39;t know if ./configure generated it. But in src/daemon there is a configfile.c and configfile.h. I tried including the .h file to load_copy.c. Still got the same error"}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1521586182, "post_id": 49394733, "comment_id": 85792600, "body": "<code>.&#47;configure</code> will generate a file <code>src&#47;config.h</code> (see <a href=\"https://github.com/collectd/collectd/blob/master/configure.ac#L5\" rel=\"nofollow noreferrer\"><code>configure.ac</code></a>) where the checks performed by <code>.&#47;configure</code> are stored as <code>#define</code>s. The endianes checks starts at line 1297 of <code>configure.ac</code>. Perhaps you are using the wrong header file which is not supposed to use by the library users."}, {"owner": {"reputation": 61, "user_id": 9525326, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/221d0a7cea4ddafd81665752bcbd52c1?s=128&d=identicon&r=PG&f=1", "display_name": "cyanbreak", "link": "https://stackoverflow.com/users/9525326/cyanbreak"}, "edited": false, "score": 0, "creation_date": 1521656428, "post_id": 49394733, "comment_id": 85829389, "body": "Thank you! That got me past that problem, I ran ./configure again and then found src/config.h. I then included config.h in the .c file, and generated a shared library with the following: gcc -I. -g -O -c -fPIC myplugin.c -shared -o myplugin.so. Now I&#39;m seeing the error &quot;dlopen myplugin.so failed...The most common cause for this problem is missing dependencies. Use ldd(1) to check the dependencies"}], "owner": {"reputation": 61, "user_id": 9525326, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/221d0a7cea4ddafd81665752bcbd52c1?s=128&d=identicon&r=PG&f=1", "display_name": "cyanbreak", "link": "https://stackoverflow.com/users/9525326/cyanbreak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 192, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1521583867, "creation_date": 1521582851, "last_edit_date": 1521583867, "question_id": 49394733, "link": "https://stackoverflow.com/questions/49394733/custom-collectd-plugin-will-not-compile", "title": "custom collectd plugin will not compile", "body": "<p>I am trying to write a custom plugin in C for collectd and cannot get it to compile with collectd. I've tried <a href=\"https://wiki.opnfv.org/display/fastpath/Collectd+how+to+implement+a+simple+plugin\" rel=\"nofollow noreferrer\">this tutorial</a> and could get the plugin to work with the collectd build system.</p>\n\n<p>I've also tried <a href=\"https://collectd.org/wiki/index.php/Build_system\" rel=\"nofollow noreferrer\">this</a> with just a copy of the load plugin, and tried to manually compile the c-file in order to just link the compiled library (kind of a hackish way around). But I'm still getting errors.</p>\n\n<p>When I run </p>\n\n<pre><code>gcc -I. -g -O -c load_copy.c -lcommon\n</code></pre>\n\n<p>I get this error</p>\n\n<pre><code>daemon/common.h:308:2: error: #error \"Don't know how to convert between host \nand network representation of doubles.\"\n #error                                                                         \n\\\n  ^\ndaemon/common.h:336:23: warning: \u2018struct passwd\u2019 declared inside parameter list\n            struct passwd **pwbufp);\n                   ^\ndaemon/common.h:336:23: warning: its scope is only this definition or declaration, which is probably not what you want\nload_copy.c: In function \u2018load_read\u2019:\nload_copy.c:184:2: error: #error \"No applicable input method.\"\n #error \"No applicable input method.\"\n</code></pre>\n\n<p>like there is still a compilation error. Has anyone successfully written a C plugin for collectd? Any tips?</p>\n\n<p>This is from common.h    </p>\n\n<pre><code>#ifdef HAVE_LIBKSTAT\nint get_kstat(kstat_t **ksp_ptr, char *module, int instance, char *name);\nlong long get_kstat_value(kstat_t *ksp, char *name);\n#endif\n\n#ifndef HAVE_HTONLL\nunsigned long long ntohll(unsigned long long n);\nunsigned long long htonll(unsigned long long n);\n#endif\n\n#if FP_LAYOUT_NEED_NOTHING\n#define ntohd(d) (d)\n#define htond(d) (d)\n#elif FP_LAYOUT_NEED_ENDIANFLIP || FP_LAYOUT_NEED_INTSWAP\ndouble ntohd(double d);\ndouble htond(double d);\n#else\n#error                                                                         \\\n    \"Don't know how to convert between host and network representation of \ndoubles.\"\n#endif\n</code></pre>\n"}]