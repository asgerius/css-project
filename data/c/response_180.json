[{"tags": ["c"], "comments": [{"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 3, "creation_date": 1529536068, "post_id": 50958241, "comment_id": 88913765, "body": "The code doesn&#39;t copy anything into <code>s</code>. Instead, it copies random stuff from <code>s</code> into the other strings."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 9970112, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-3b4flg4uncI/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq0Jv1GwRAFR_whTfOorrJMtogfNlg/mo/photo.jpg?sz=128", "display_name": "Alexander Aubert", "link": "https://stackoverflow.com/users/9970112/alexander-aubert"}, "edited": false, "score": 0, "creation_date": 1529537463, "post_id": 50958344, "comment_id": 88914065, "body": "thank you for your help.when i try to run the program, it only display &quot;adg&quot;"}, {"owner": {"reputation": 3560, "user_id": 5550963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7jAip.png?s=128&g=1", "display_name": "CEPB", "link": "https://stackoverflow.com/users/5550963/cepb"}, "reply_to_user": {"reputation": 23, "user_id": 9970112, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-3b4flg4uncI/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq0Jv1GwRAFR_whTfOorrJMtogfNlg/mo/photo.jpg?sz=128", "display_name": "Alexander Aubert", "link": "https://stackoverflow.com/users/9970112/alexander-aubert"}, "edited": false, "score": 0, "creation_date": 1529537623, "post_id": 50958344, "comment_id": 88914102, "body": "@AlexanderAubert see the update, instead of <code>i &lt; count</code> it should be <code>j &lt; count</code>."}], "tags": [], "owner": {"reputation": 3560, "user_id": 5550963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7jAip.png?s=128&g=1", "display_name": "CEPB", "link": "https://stackoverflow.com/users/5550963/cepb"}, "is_accepted": true, "score": 0, "last_activity_date": 1529537552, "last_edit_date": 1529537552, "creation_date": 1529536770, "answer_id": 50958344, "question_id": 50958241, "link": "https://stackoverflow.com/questions/50958241/merge-each-letter-in-string-orderly-into-a-new-string/50958344#50958344", "title": "merge each letter in string (orderly) into a new string", "body": "<pre><code>for(i=0, j = 0;j&lt;count;i += 3, j++){\n    s[i]   = str1[j];\n    s[i+1] = str2[j];\n    s[i+2] = str3[j];\n}\ns[i] = '\\0';\nprintf(\"String:%s \", s);\n</code></pre>\n\n<p>This is what you want :) as a little challenge try to figure out how this works, it will help you understand what is going on. For SO community I will come back and edit the answer explaining what is this doing in about an hour.</p>\n"}, {"tags": [], "owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "is_accepted": false, "score": 1, "last_activity_date": 1529538050, "creation_date": 1529538050, "answer_id": 50958498, "question_id": 50958241, "link": "https://stackoverflow.com/questions/50958241/merge-each-letter-in-string-orderly-into-a-new-string/50958498#50958498", "title": "merge each letter in string (orderly) into a new string", "body": "<p>to clarify your issue. In c</p>\n\n<pre><code>str1[i]=s[j];\n</code></pre>\n\n<p>means</p>\n\n<p>'copy the jth character from s and put it in the ith character of str1'</p>\n\n<p>You mean the other way round</p>\n\n<pre><code>s[i]=str1[j];\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3971, "user_id": 2840714, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/s9vli.jpg?s=128&g=1", "display_name": "ChuckCottrill", "link": "https://stackoverflow.com/users/2840714/chuckcottrill"}, "is_accepted": false, "score": 1, "last_activity_date": 1529548232, "creation_date": 1529548232, "answer_id": 50959521, "question_id": 50958241, "link": "https://stackoverflow.com/questions/50958241/merge-each-letter-in-string-orderly-into-a-new-string/50959521#50959521", "title": "merge each letter in string (orderly) into a new string", "body": "<p>You really should check the size of destination string. This approach uses pointers, fewer operations, you might enjoy the comparison.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n\nchar*\nstrmerge3(char* s, char*str1, char*str2, char*str3)\n//strmerge3(char* s, long slen, char*str1, char*str2, char*str3)\n{\n    if(!s) return(s); //handle NULL in string\n    char *dp=s; //destination pointer\n    char *p1=str1?str1:\"\"; //source pointers\n    char *p2=str2?str2:\"\";\n    char *p3=str3?str3:\"\";\n    //long len=0; //slen--; //save room for null terminator\n\n    for( ; (*p1 | *p2 | *p3) ; ) {\n        if(*p1) dp++ = p1++; //if(++len&gt;len) break;\n        if(*p2) dp++ = p2++; //if(++len&gt;len) break;\n        if(*p3) dp++ = p3++; //if(++len&gt;len) break;\n    }\n    dp = '\\0'; //null terminate dest, at end\n    return(s);\n}\n\nint main(void)\n{\n    char str1[32], str2[32], str3[32], s[32*3];\n    int count, i, j=0;\n    printf(\"Insert String 1:\");\n    scanf(\"%s\", str1);\n    printf(\"Insert String 2:\");\n    scanf(\"%s\", str2);\n    printf(\"Insert String 3:\");\n    scanf(\"%s\", str3);\n\n    strmerge3(s,str1,str2,str3);\n    //strmerge3(s,sizeof(s),str1,str2,str3); //you should pass s size\n\n    printf(\"String:%s\", s);\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 9970112, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-3b4flg4uncI/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq0Jv1GwRAFR_whTfOorrJMtogfNlg/mo/photo.jpg?sz=128", "display_name": "Alexander Aubert", "link": "https://stackoverflow.com/users/9970112/alexander-aubert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 50958344, "answer_count": 3, "score": 0, "last_activity_date": 1529548232, "creation_date": 1529535948, "last_edit_date": 1529536280, "question_id": 50958241, "link": "https://stackoverflow.com/questions/50958241/merge-each-letter-in-string-orderly-into-a-new-string", "title": "merge each letter in string (orderly) into a new string", "body": "<p>So, I'm still very new in C programming.<br/>\nThere is 3 strings with the same length.<br/>\nstr1=\"abc\", str2=\"def\", str3=\"ghi\".<br/>\nThe output in the new string will be like \"adgbehcfi\".</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n\nint main(void)\n{\n    char str1[32], str2[32], str3[32], s[32];\n    int count, i, j=0;\n    printf(\"Insert String 1:\");\n    scanf(\"%s\", str1);\n    printf(\"Insert String 2:\");\n    scanf(\"%s\", str2);\n    printf(\"Insert String 3:\");\n    scanf(\"%s\", str3);\n    for(count=0;str1[count]!='\\0';count++);\n    for(i=0;i&lt;count;i++){\n        str1[i]=s[j];\n        str2[i]=s[j+1];\n        str3[i]=s[j+1];\n        j++;\n\n    }\n    printf(\"String:%s\", s);\n    return 0;\n}\n</code></pre>\n\n<p>i tried to run this program, but when i try to display the new string, it won't come out. All help is deeply appriciated. </p>\n"}, {"tags": ["c", "clang"], "comments": [{"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 3, "creation_date": 1529533774, "post_id": 50957919, "comment_id": 88913238, "body": "<code>int **board = malloc( sizeof(int) * num_rows );</code>--&gt;<code>int **board = malloc( sizeof(int *) * num_rows );</code>"}, {"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "reply_to_user": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1529533941, "post_id": 50957919, "comment_id": 88913282, "body": "@ChristianGibbons Thanks, 4 vs 8, that would do it. Put that in an answer and I&#39;ll accept. Strange <code>-fsanitize=address</code> didn&#39;t catch it."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 2, "creation_date": 1529534115, "post_id": 50957919, "comment_id": 88913328, "body": "Simple rule: 1 less <code>*</code> in the <code>sizeof</code> argument than the type of the pointer."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 3, "creation_date": 1529534150, "post_id": 50957919, "comment_id": 88913335, "body": "There are already hundreds of similar questions, not much point in answering this one."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1529537168, "post_id": 50957919, "comment_id": 88913999, "body": "@Barmar an even simpler rule is to use <code>sizeof *variable_name</code>"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1529537306, "post_id": 50957919, "comment_id": 88914032, "body": "@Schwern In case you are unaware, you can use a single allocation pointed to by <code>int (*)[num_cols]</code>, instead of using one allocation per row"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1529537437, "post_id": 50957919, "comment_id": 88914057, "body": "@M.M Yes, I know, I didn&#39;t want to complicate my comment."}], "answers": [{"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1529550351, "post_id": 50957996, "comment_id": 88916609, "body": "Or, better in some ways, <code>int **board = malloc(sizeof(*board) * num_rows);</code>."}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1529592220, "post_id": 50957996, "comment_id": 88939137, "body": "@JonathanLeffler Ah, yes, that notation would have avoided the problem in the first place.."}], "tags": [], "owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "is_accepted": true, "score": 5, "last_activity_date": 1534961775, "last_edit_date": 1534961775, "creation_date": 1529534144, "answer_id": 50957996, "question_id": 50957919, "link": "https://stackoverflow.com/questions/50957919/strange-memory-corruption-in-c/50957996#50957996", "title": "Strange memory corruption in C", "body": "<p>You are allocating your array of int pointers as an array of ints resulting in some unexpected behavior.  Simple enough fix, fortunately.</p>\n\n<p>Replace this line:</p>\n\n<pre><code>int **board = malloc( sizeof(int) * num_rows );\n</code></pre>\n\n<p>With this line:</p>\n\n<pre><code>int **board = malloc( sizeof(int *) * num_rows );\n</code></pre>\n\n<p>Or, to avoid these kind of mistakes in the future, as pointed out by Jonathan Leffler below in the comments, you can perform the <code>sizeof</code> operator on the dereferenced variable you are trying to allocate so you don't have to worry about getting the type correct: </p>\n\n<pre><code>int **board = malloc( sizeof(*board) * num_rows );\n</code></pre>\n"}], "owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "accepted_answer_id": 50957996, "answer_count": 1, "score": 2, "last_activity_date": 1534961775, "creation_date": 1529533639, "question_id": 50957919, "link": "https://stackoverflow.com/questions/50957919/strange-memory-corruption-in-c", "title": "Strange memory corruption in C", "body": "<p>In answering another question I wrote up what should be some simple code to initialize and print a 2D array. But something very strange is happening.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nvoid print_row( const int *row, size_t num_cols ) {\n    printf(\"%p\\n\", (void*)row);\n    for( size_t col_num = 0; col_num &lt; num_cols; col_num++ ) {\n        printf(\" %2d \", row[col_num]);\n    }\n    puts(\"\");\n}\n\nint **make_board( const size_t num_rows, const size_t num_cols ) {\n    int **board = malloc( sizeof(int) * num_rows );\n\n    for( size_t row_num = 0; row_num &lt; num_rows; row_num++ ) {\n        int *row = calloc( num_cols, sizeof(int) );\n        board[row_num] = row;\n        print_row(row, num_cols);\n    }\n\n    return board;\n}\n\nvoid print_board( int **board, const size_t num_rows, const size_t num_cols ) {\n    for( size_t row_num = 0; row_num &lt; num_rows; row_num++ ) {\n        const int *row = board[row_num];\n        print_row(row, num_cols);\n    }\n}\n\nint main() {\n    size_t num_rows = 6;\n    size_t num_cols = 4;\n    puts(\"Making the board\");\n    int **board = make_board(num_rows, num_cols);\n    puts(\"Printing the board\");\n    print_board(board, num_rows, num_cols);\n}\n</code></pre>\n\n<p>Running it, I occasionally get one corrupted row, but only ever in <code>print_board</code> never in <code>make_board</code>.</p>\n\n<pre><code>cc -Wall -Wshadow -Wwrite-strings -Wextra -Wconversion -std=c99 -pedantic -g   -c -o test.o test.c\ncc   test.o   -o test\n\nMaking the board\n0x7fc4e6d00370\n  0   0   0   0 \n0x7fc4e6d001e0\n  0   0   0   0 \n0x7fc4e6d001f0\n  0   0   0   0 \n0x7fc4e6d00200\n  0   0   0   0 \n0x7fc4e6d00210\n  0   0   0   0 \n0x7fc4e6d00220\n  0   0   0   0 \nPrinting the board\n0x7fc4e6d00370\n  0   0   0   0 \n0x7fc4e6d001e0\n -422575600  32708  -422575584  32708 \n0x7fc4e6d001f0\n  0   0   0   0 \n0x7fc4e6d00200\n  0   0   0   0 \n0x7fc4e6d00210\n  0   0   0   0 \n0x7fc4e6d00220\n  0   0   0   0 \n</code></pre>\n\n<p>If I link in packages, like glib-2, the corruption happens more frequently.</p>\n\n<pre><code>cc -Wall -Wshadow -Wwrite-strings -Wextra -Wconversion -std=c99 -pedantic -g `pkg-config --cflags glib-2.0`   -c -o test.o test.c\ncc `pkg-config --libs glib-2.0`   test.o   -o test\n</code></pre>\n\n<p>The memory locations are all correct. All rows are fine during initialization. There's no compiler warnings. <code>-fsanitize=address</code> finds no errors.</p>\n\n<p>What might be causing that one row to become corrupted? Can anyone even repeat the problem?</p>\n\n<pre><code>$ cc --version\nApple LLVM version 8.0.0 (clang-800.0.42.1)\nTarget: x86_64-apple-darwin17.6.0\nThread model: posix\nInstalledDir: /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin\n\n$ uname -a\nDarwin Windhund.local 17.6.0 Darwin Kernel Version 17.6.0: Tue May  8 15:22:16 PDT 2018; root:xnu-4570.61.1~1/RELEASE_X86_64 x86_64 i386 MacBookPro8,1 Darwin\n</code></pre>\n"}, {"tags": ["c", "android-studio", "linux-kernel"], "answers": [{"tags": [], "owner": {"reputation": 170455, "user_id": 149341, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/omfTQ.png?s=128&g=1", "display_name": "duskwuff -inactive-", "link": "https://stackoverflow.com/users/149341/duskwuff-inactive"}, "is_accepted": false, "score": 4, "last_activity_date": 1529535815, "creation_date": 1529535815, "answer_id": 50958224, "question_id": 50957866, "link": "https://stackoverflow.com/questions/50957866/getting-the-starting-address-of-dram-or-sram-galaxy-s7/50958224#50958224", "title": "Getting the starting address of DRAM or SRAM galaxy S7", "body": "<p>It sounds like you're confused about the nature of the NDK. The NDK does not let you write programs which run on the \"bare metal\" of the Android system. As such, the \"starting address\" of SRAM / DRAM resources is not available (and is not meaningful) to NDK code.</p>\n\n<p>NDK libraries run in an environment that is similar to Linux userspace. They run as userspace processes, and allocate memory using standard Linux APIs (like <code>malloc()</code> or <code>mmap()</code>).</p>\n"}], "owner": {"reputation": 1, "user_id": 9969500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff8afe584236d288dca0d8c498c5026a?s=128&d=identicon&r=PG&f=1", "display_name": "BoB", "link": "https://stackoverflow.com/users/9969500/bob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1529535815, "creation_date": 1529533204, "question_id": 50957866, "link": "https://stackoverflow.com/questions/50957866/getting-the-starting-address-of-dram-or-sram-galaxy-s7", "title": "Getting the starting address of DRAM or SRAM galaxy S7", "body": "<p>Im using NDK tool in android studio to program C for android devices.I want to know how i can get the starting address of SRAM or DRAM samsung galaxy S7.</p>\n"}, {"tags": ["c"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 9969592, "user_type": "registered", "profile_image": "https://graph.facebook.com/1776271989131030/picture?type=large", "display_name": "Abd El-Rahman Khalil", "link": "https://stackoverflow.com/users/9969592/abd-el-rahman-khalil"}, "edited": false, "score": 0, "creation_date": 1529535370, "post_id": 50958058, "comment_id": 88913609, "body": "i know how to use extern for declaration but this is not my question my question was there are 3 rules that the linker follow during linking time when global Symbols Defined at Multiple Places   Rule 1: Multiple strong symbols (with same variable name) are not allowed.  Rule 2: Given a strong symbol and multiple weak symbols, choose the strong  symbol . Rule 3: Given multiple weak symbols, choose any of the weak symbols.  this case the linker should use rule 2   finally the linker didn&#39;t throw an error    and in another program chick rule 2 it works as expected"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1529538077, "post_id": 50958058, "comment_id": 88914214, "body": "<i>their scope (visibility) is limited to its compilation unit</i> Are you sure about that? Per <a href=\"https://port70.net/~nsz/c/c11/n1570.html#6.2.2p5\" rel=\"nofollow noreferrer\"><b>6.2.2 Linkages of identifiers</b>, paragraph 5 of the C Standard</a>:  &quot;If the declaration of an identifier for an object has file scope and no storage-class specifier, its linkage is external.&quot;  That seems to say that if an object with file scope <i>doesn&#39;t</i> have <code>static</code>, it has an implicit <code>extern</code>."}], "tags": [], "owner": {"reputation": 33, "user_id": 9457658, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Rc_v7QLkG8Y/AAAAAAAAAAI/AAAAAAAAAHA/aaZORjHX1cg/photo.jpg?sz=128", "display_name": "PacoPeps", "link": "https://stackoverflow.com/users/9457658/pacopeps"}, "is_accepted": false, "score": 0, "last_activity_date": 1529534611, "creation_date": 1529534611, "answer_id": 50958058, "question_id": 50957847, "link": "https://stackoverflow.com/questions/50957847/how-linkers-resolve-global-symbols-with-the-same-name-defined-at-multiple-places/50958058#50958058", "title": "How Linkers Resolve Global Symbols with the same name Defined at Multiple Places", "body": "<p>The declaration in main.c</p>\n\n<pre><code>int x;\n</code></pre>\n\n<p>has nothing to do with the one in second_file.c</p>\n\n<pre><code>double x=100.0;\n</code></pre>\n\n<p>because their scope (visibility) is limited to its compilation unit. That is, their are globals but (roughly) only visible along functions in the same file.\nIn case you wanted both files to share the same global variable you have to specify it by using <code>extern</code>keyword:</p>\n\n<pre><code>extern int x;\n</code></pre>\n\n<p>in one of the files, and that will force the linker to match a symbol at linking time that implements that declaration.</p>\n\n<p>Don't forget: you can declare a variable (consistently in type) multiple times but only define it once. To avoid taking this answer too long, try to search in stackoverflow for the best approach for using globals in multiple files; it's much better to work via *.h for declarations an of course implement it in one *.c file.</p>\n\n<p>Finally, in this example anyway the linker will not match the <code>int x</code>declaration with the <code>double x</code>definition, and it will throw an error at linking time.</p>\n"}, {"tags": [], "owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "is_accepted": true, "score": 0, "last_activity_date": 1529539159, "last_edit_date": 1529539159, "creation_date": 1529538739, "answer_id": 50958567, "question_id": 50957847, "link": "https://stackoverflow.com/questions/50957847/how-linkers-resolve-global-symbols-with-the-same-name-defined-at-multiple-places/50958567#50958567", "title": "How Linkers Resolve Global Symbols with the same name Defined at Multiple Places", "body": "<p>As you may or may not know, you need to be careful with multiple definitions.  Ideally, every global symbol will be defined precisely once.  There are various circumstances under which you can get away with multiple definitions, but you have to be careful.</p>\n\n<p>In this case, you're relying on the \"common allocation model\", which was (and still is) widespread among C compiler because of the early influence of, believe it or not, FORTRAN.  This model says that you can have multiple definitions as long as at most one of gives an initializing value. But -- and this is the biggie -- <em>all the definitions must have the same type</em>.  (I'm not sure I've ever seen this rule stated; I'm not sure I'd even thought about it explicitly, because it ends up being pretty obvious that it has to be that way.)</p>\n\n<p>C uses the concept of <em>separate compilation</em>.  Each .c file compiles down to a separate, standalone \"object file\".  Later, a separate program called the <em>linker</em> links the object files together.  It's the linker that assigns the final address to global variables, and ends up resolving common allocation.</p>\n\n<p>But the linker only resolves addresses.  It will arrange that <code>x</code> in your <code>main.c</code> and <code>x</code> in your <code>second_file.c</code> are at the same address.  But if <code>main.c</code> thinks there's an <code>int</code> located at location <code>x</code>, that's how it's going to interpret it.  And if <code>second_file.c</code> thinks there's a <code>double</code> at location <code>x</code>, and indeed stores a value of type <code>double</code> there, it's going to be gibberish when <code>main.c</code> tries to interpret that bit pattern as an <code>int</code>.</p>\n\n<p>As @user58697 discusses in another answer, you've got additional problems in your <code>printf</code> call, trying to use <code>%f</code> to print (what the compiler thinks are) <code>int</code> values, which is never going to work properly, either.</p>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 9969592, "user_type": "registered", "profile_image": "https://graph.facebook.com/1776271989131030/picture?type=large", "display_name": "Abd El-Rahman Khalil", "link": "https://stackoverflow.com/users/9969592/abd-el-rahman-khalil"}, "edited": false, "score": 0, "creation_date": 1529545420, "post_id": 50958604, "comment_id": 88915658, "body": "thnx alot ur first paragraph was very helpful about UB i found it was the reason for the value x=0 and y=89 when i changed %1f to%d the value of y became  500 as expected but x still 0 . as @Steve Summit discussed in his pre-last paragraph i known that the problem was in the format which every data type represented by it ,in second_file.c when the compiler find -100 is given to a double type var (will b() is called)then -100 is stored in x(8 byte) in the followed formate for double but in main.c  the compiler push only 4bytes which content is 0 because -100 is a very small compared to double"}, {"owner": {"reputation": 3, "user_id": 9969592, "user_type": "registered", "profile_image": "https://graph.facebook.com/1776271989131030/picture?type=large", "display_name": "Abd El-Rahman Khalil", "link": "https://stackoverflow.com/users/9969592/abd-el-rahman-khalil"}, "edited": false, "score": 0, "creation_date": 1529545671, "post_id": 50958604, "comment_id": 88915712, "body": "i tried to give x a very high value x = -19999655455854555.0 so it give a value in the output not equal to zero and i think the function pulled the 4 bytes and treated with them as they represent an integer value."}], "tags": [], "owner": {"reputation": 6882, "user_id": 3403834, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xpA5S.jpg?s=128&g=1", "display_name": "user58697", "link": "https://stackoverflow.com/users/3403834/user58697"}, "is_accepted": false, "score": 0, "last_activity_date": 1529540353, "last_edit_date": 1529540353, "creation_date": 1529539025, "answer_id": 50958604, "question_id": 50957847, "link": "https://stackoverflow.com/questions/50957847/how-linkers-resolve-global-symbols-with-the-same-name-defined-at-multiple-places/50958604#50958604", "title": "How Linkers Resolve Global Symbols with the same name Defined at Multiple Places", "body": "<p>First, in the line</p>\n\n<pre><code>    printf(\"x = %1f y = %d\\n\",x , y);\n</code></pre>\n\n<p>you lied to <code>printf</code>. You told the compiler to push an <code>int</code> (apparently 4 bytes worth), but instructed <code>printf</code> to pull a <code>double</code> (apparently 8 bytes). This is an UB. All bets are off. Nobody knows where <code>printf</code> would pull <code>y</code> from.</p>\n\n<p>And this is what happens with <code>x</code>:</p>\n\n<pre><code>vnp$ nm -n main.o\n                 U _b\n                 U _printf\n0000000000000000 T _main\n0000000000000004 C _x\n0000000000000040 D _a\n0000000000000044 D _y\n0000000000000048 D _x1\n</code></pre>\n\n<p>You can see that <code>_x</code> is annotated with <code>C</code> (for <code>Common</code>). The compiler took <code>int x;</code> as a <em>definition</em>, realized that <code>x</code> is an uninitialized global, and placed  it in <code>BSS</code>. By the time it compiled the</p>\n\n<pre><code>    printf(\"x = %1f y = %d\\n\",x , y);\n</code></pre>\n\n<p>line, it generated a relocation record relative to the <code>.bss</code>.</p>\n\n<p>The linker, however, selected <code>x</code> from the second file, and which is placed in <code>.data</code>, but performed the relocation as directed, that is relative to <code>.bss</code>. This is why <code>x</code> prints as <code>0</code>.</p>\n\n<p>Disclaimer: since there is an UB, the above is a pure (however educated) speculation.</p>\n\n<p>PS: the address of <code>x</code> is due to the alignment requirement or <code>double</code>.</p>\n"}], "owner": {"reputation": 3, "user_id": 9969592, "user_type": "registered", "profile_image": "https://graph.facebook.com/1776271989131030/picture?type=large", "display_name": "Abd El-Rahman Khalil", "link": "https://stackoverflow.com/users/9969592/abd-el-rahman-khalil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 679, "favorite_count": 0, "accepted_answer_id": 50958567, "answer_count": 3, "score": 0, "last_activity_date": 1529540353, "creation_date": 1529533069, "last_edit_date": 1529536705, "question_id": 50957847, "link": "https://stackoverflow.com/questions/50957847/how-linkers-resolve-global-symbols-with-the-same-name-defined-at-multiple-places", "title": "How Linkers Resolve Global Symbols with the same name Defined at Multiple Places", "body": "<p>i am new in programming and i started with c . i am learning in the point How Linkers Resolve Global Symbols Defined at Multiple Places. so i made a small program which says:</p>\n\n<p>//main.c</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid b(void);\n\n\nint x;\nint a=10;\nint y =500;\nint x1 = 2016;\n\nint main()\n{\nb();\n\n\nprintf(\"x = %1f y = %d\\n\",x , y);\nreturn 0;\n}\n</code></pre>\n\n<p>//second_file.c</p>\n\n<pre><code>double x=100.0;\nint g=100;\nextern int y;\nvoid b()\n{\nx = -100.0;\n\n}\n</code></pre>\n\n<p>i know from the rules that linkers follow to solve this case that, the linker will choose the strong symbol which in this case (double x=100.0;) not the integer one defined in main.c. so i expected the output to be x=-100.0 y=500,\nbut the output was x=0.000000 y=89 can any one explain why did i find this output or where is my wrong?</p>\n\n<p>i tried to use objdump command in cmd (for windows) to view the symbol table may i find something make my understand but i found another thing weird i found the addresses of the variables as follow:</p>\n\n<p>a------ 0x00000000</p>\n\n<p>y------ 0x00000004</p>\n\n<p>x1----- 0x00000008</p>\n\n<p>x------ 0x00000010</p>\n\n<p>g------ 0x00000018</p>\n\n<p>i thought that x should start from 0x0000000c why not?</p>\n"}, {"tags": ["c", "cuda"], "comments": [{"owner": {"reputation": 119299, "user_id": 1695960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f9f557c03db19232aa410540af2f966?s=128&d=identicon&r=PG", "display_name": "Robert Crovella", "link": "https://stackoverflow.com/users/1695960/robert-crovella"}, "edited": false, "score": 1, "creation_date": 1529543263, "post_id": 50957840, "comment_id": 88915236, "body": "you can&#39;t pass a pointer to a host-code function to a device kernel to execute on the device. Your &quot;normal&quot; C code is host code. It is compiled by the host compiler into an x86 executable entry point. That bare pointer to that entry point is completely useless in device code. GPUs don&#39;t execute x86 code. If you did  CUDA error checking, you&#39;d discover that things are going wrong in the kernel. There are <a href=\"https://stackoverflow.com/questions/31057870/passing-host-function-as-a-function-pointer-in-global-or-device-function/31058123#31058123\">many examples</a> on the <code>cuda</code> tag for device pointers."}], "answers": [{"tags": [], "owner": {"reputation": 141, "user_id": 1070063, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3qS6g.png?s=128&g=1", "display_name": "nitroglycerine", "link": "https://stackoverflow.com/users/1070063/nitroglycerine"}, "is_accepted": true, "score": 0, "last_activity_date": 1529544732, "creation_date": 1529544732, "answer_id": 50959146, "question_id": 50957840, "link": "https://stackoverflow.com/questions/50957840/cuda-c-pointer-gives-confusing-value/50959146#50959146", "title": "CUDA C pointer gives confusing value", "body": "<p>Here's my understanding of why the outputs are seen:</p>\n\n<ul>\n<li><p><code>A42</code> is working as expected because i is equal to 42</p></li>\n<li><p><code>B431891052</code> because the pointer <code>void* d</code> is not initialized, and may be containing a garbage value, and the print statement <code>printf(\"B%d\",d)</code> just prints the lower 32 bits of it.</p></li>\n<li><p><code>C-288453328</code> because the statement <code>printf(\"C%d\",s)</code> prints the lower 32 bits of variable <code>i</code>. In 32 bits the number -288453328 corresponds to hexadecimal number 0xEECE8D30; I think it's the lower 32 bits of the stack address 0x7FFFEECE8D30.</p></li>\n<li><p><code>D1</code> because the <code>hr</code> will contain whatever first 8 bytes <code>dr</code> is point to. It is uninitialized, and in this example the value it points to happens to be 1.</p></li>\n</ul>\n\n<p>I think to assign have <code>D12</code> the function <code>memManageC</code> may need to be changed to the following:</p>\n\n<pre><code>__global__ void MemManageC(int *r) {\n    *r = dat;\n}\n</code></pre>\n\n<p>Thus, the content pointed to by <code>r</code> will have the value of <code>dat</code>. Without the de-reference, the function only modifies the argument that's passed in, which is an no-op and may get optimized away by the compiler.</p>\n\n<p>To have <code>D12</code> also requires <code>toBe</code> to correctly set the value of <code>dat</code> which seems to require some more code changes. <code>toBe</code> is a host-side function, and a usage of a host-side function in __global__ or __kernel__ functions can be found in this answer: <a href=\"https://stackoverflow.com/questions/31057870/passing-host-function-as-a-function-pointer-in-global-or-device-function/31058123#31058123\">Passing Host Function as a function pointer in __global__ OR __device__ function in CUDA</a></p>\n"}], "owner": {"reputation": 55, "user_id": 7265042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eff77ef2f7963fdbada03acc5060029c?s=128&d=identicon&r=PG&f=1", "display_name": "Liverwurst", "link": "https://stackoverflow.com/users/7265042/liverwurst"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 355, "favorite_count": 0, "accepted_answer_id": 50959146, "answer_count": 1, "score": 0, "last_activity_date": 1529544732, "creation_date": 1529533017, "question_id": 50957840, "link": "https://stackoverflow.com/questions/50957840/cuda-c-pointer-gives-confusing-value", "title": "CUDA C pointer gives confusing value", "body": "<p>Well, sorry if this is similar to something seen before.\nI have the following code:</p>\n\n<pre><code>//kern.cu\n#include &lt;stdio.h&gt;\n#include &lt;dlfcn.h&gt;\n#include &lt;unistd.h&gt;\nextern \"C\"{\n#include \"Kernalize.h\"\n#include &lt;stdio.h&gt;\n}\n\nextern \"C\" {\n    __device__ void *dat;\n    __global__ void memManageDevice(void *data){\n        dat=data;\n    }\n    void memManageD(void *data){\n        printf(\"A%d\",data);\n        void *d;\n        printf(\"B%d\",d);\n        cudaMemcpy(d,&amp;data,sizeof(data),cudaMemcpyHostToDevice);\n        memManageDevice&lt;&lt;&lt;1,1&gt;&gt;&gt;(data);\n    }\n    __global__ void MemManageC(void *r){//don't call this unless in this file.\n        r=dat;\n    }\n    void* memManageH(void *s){\n        printf(\"C%d\",s);\n        void *dr;\n        cudaMalloc((void **)&amp;dr, sizeof(s));\n        void *hr;\n        int size=sizeof(s);\n        MemManageC&lt;&lt;&lt;1,1&gt;&gt;&gt;(dr);\n        cudaMemcpy(&amp;hr, dr, size, cudaMemcpyDeviceToHost);\n        printf(\"D%d\",hr);\n        return hr;\n    }\n    __global__ void kernalize(void (*ptr)(void *)) {\n        (*ptr)(dat);\n    }\n    void Start(int d1, int d2, void (*ptr)(void *), void *data) {//TODO: make arrays as to start many  kernels\n        int size=sizeof(data);\n        // void *ddata;\n        // bool ab=true;\n        // bool *coolbeans=&amp;ab;\n        // memManageD&lt;&lt;&lt;1,1&gt;&gt;&gt;(data);\n        kernalize&lt;&lt;&lt;d1,d2,d2*size&gt;&gt;&gt;(ptr);\n        // data=sdata;\n        // coolbeans=false;\n        //kernalize(ptr,data);\n    }\n}\n</code></pre>\n\n<p>And I compile this into a .so:</p>\n\n<pre><code>nvcc --ptxas-options=-v --compiler-options '-fPIC' -o libpar.so --shared kern.cu\n</code></pre>\n\n<p>Then from normal C I reference it:</p>\n\n<pre><code>typedef void (*gFunc) ();\ntypedef void (*sFunc) (int,int,gFunc*,void *data);\n\ntypedef void* (*hFunc) (void *);\ntypedef void (*dFunc) (void *);\nvoid toBe(void *data){\n        data=12;\n        while(1){}//side-expirement, don't think it's the stem of the issue.\n}\nint main() {\n    printf(\"start\");\n    sFunc fS;\n    hFunc hS;\n    dFunc dS;\n    void* hLibrary = dlopen(\"./libpar.so\", RTLD_NOW | RTLD_GLOBAL);\n    if(hLibrary == NULL) {\n        fprintf(stderr, \"%s\\n\", dlerror());\n        return 1;\n    }\n    int i=42;\n    *(void**)(&amp;dS)=dlsym(hLibrary,\"memManageD\");\n    (void) dS(i);\n    sleep(1);\n    printf(\"checkpoint\");\n    *(void**)(&amp;fS)=dlsym(hLibrary,\"Start\");\n    (void) fS(2,2,toBe,&amp;i);\n    sleep(1);\n    *(void**)(&amp;hS)=dlsym(hLibrary,\"memManageH\");\n    int x=(void*) hS(&amp;i);\n    printf(\"%d\", x);\n\n    return 0;\n}\n</code></pre>\n\n<p>As you might be able to tell through my monstrously hideous code, the function toBe is being passed to a CUDA C kernel, where upon execution it's expected to change the non-type variable pointer \"data\" to 12. \"data\" is a reference to \"i\" in the normal c, and starts as 42. Unfortunately, my output is 1, and not 12:</p>\n\n<pre><code> startA42B431891052checkpointC-288453328D1\n</code></pre>\n\n<p>which is really just garbage memory listings in between a \"A42\" and a \"D1\".\nI'm relatively new to CUDA C, and to C for that matter. (I spend the majority of my time with higher-level programming languages.)\nSo the question really is where I am making a stupid mistake, either in my understanding of CUDA, my syntax with C, or my whole perception of how I envisioned this.</p>\n"}, {"tags": ["c", "function", "variables", "floating-point", "return"], "comments": [{"owner": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 3, "creation_date": 1529532710, "post_id": 50957775, "comment_id": 88912949, "body": "Enable compiler warnings."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 3, "creation_date": 1529532772, "post_id": 50957775, "comment_id": 88912967, "body": "<code>float function(float x)</code> &lt;-- mind the type."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 1, "creation_date": 1529533868, "post_id": 50957775, "comment_id": 88913267, "body": "For future reference, you could have demonstrated the problem using a constant value in your program rather than reading the value from stdin. For example: <code>float x = 0.1; printf(&quot;x = %f, function(x) = %f\\n&quot;, x, function(x));</code> And show us the program&#39;s actual output (copy-and-paste it as code in the body of your question)."}], "answers": [{"comments": [{"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1529532993, "post_id": 50957803, "comment_id": 88913036, "body": "The type defaults to <code>int</code> only in pre-C99 compilers, or compilers that don&#39;t fully enforce C99 or C11 rules. Recent versions of gcc, for example, would warn about the OP&#39;s code even without any extra warning options."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1529533742, "post_id": 50957803, "comment_id": 88913229, "body": "The argument is not converted to <code>int</code>. See my answer."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1529537005, "post_id": 50957803, "comment_id": 88913968, "body": "There is no argument conversion when calling a function with no prototype, other than the default argument promotions"}, {"owner": {"reputation": 23, "user_id": 9969963, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-qhKLo8qkpiA/AAAAAAAAAAI/AAAAAAAAK5A/p75SdmrJ43o/photo.jpg?sz=128", "display_name": "Matteo_Vezzoli", "link": "https://stackoverflow.com/users/9969963/matteo-vezzoli"}, "edited": false, "score": 0, "creation_date": 1529586478, "post_id": 50957803, "comment_id": 88934935, "body": "Thank you a lot for the correction and for the explanation, that was the error and now everything works fine."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 2, "last_activity_date": 1529532779, "creation_date": 1529532779, "answer_id": 50957803, "question_id": 50957775, "link": "https://stackoverflow.com/questions/50957775/float-function-always-returning-0-000000/50957803#50957803", "title": "Float function always returning 0.000000", "body": "<p>You never defined the type of the function's parameter <code>x</code>.  Without an explicit type, the type defaults to <code>int</code>.  As a result, the <code>float</code> that you pass to the function gets converted to an <code>int</code> and gets truncated.</p>\n\n<p>Add the parameter type to the function definition.</p>\n\n<pre><code>float function(float x){\n    return x;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 42447, "user_id": 1016716, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/1c83d772b1c065603c7f20975d8d3552?s=128&d=identicon&r=PG", "display_name": "Mr Lister", "link": "https://stackoverflow.com/users/1016716/mr-lister"}, "edited": false, "score": 0, "creation_date": 1529585569, "post_id": 50957933, "comment_id": 88934334, "body": "Note that the keyword <code>int</code> is still optional in many cases. E.G., you can write  <code>signed</code> for a type, even though the type name is formally <code>signed int</code>!"}, {"owner": {"reputation": 23, "user_id": 9969963, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-qhKLo8qkpiA/AAAAAAAAAAI/AAAAAAAAK5A/p75SdmrJ43o/photo.jpg?sz=128", "display_name": "Matteo_Vezzoli", "link": "https://stackoverflow.com/users/9969963/matteo-vezzoli"}, "edited": false, "score": 0, "creation_date": 1529586549, "post_id": 50957933, "comment_id": 88934973, "body": "Thank you a lot for the complete explanation and for the correction, now everything works fine."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 42447, "user_id": 1016716, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/1c83d772b1c065603c7f20975d8d3552?s=128&d=identicon&r=PG", "display_name": "Mr Lister", "link": "https://stackoverflow.com/users/1016716/mr-lister"}, "edited": false, "score": 0, "creation_date": 1529597179, "post_id": 50957933, "comment_id": 88942377, "body": "@MrLister: That has nothing to do with the old implicit <code>int</code> rule. <code>int</code>, <code>signed</code>, <code>signed int</code>, and <code>int signed</code> are all equally valid names for the type. <code>int</code> happens to be the one that&#39;s listed first in the standard. See <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf\" rel=\"nofollow noreferrer\">N1570</a> 6.7.2."}], "tags": [], "owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "is_accepted": true, "score": 5, "last_activity_date": 1529533727, "creation_date": 1529533727, "answer_id": 50957933, "question_id": 50957775, "link": "https://stackoverflow.com/questions/50957775/float-function-always-returning-0-000000/50957933#50957933", "title": "Float function always returning 0.000000", "body": "<p>You defined your function as:</p>\n\n<pre><code>float function(x){\n    return x;\n}\n</code></pre>\n\n<p>If you want the function to take a <code>float</code> argument, you need to say so:</p>\n\n<pre><code>float function(float x){\n    return x;\n}\n</code></pre>\n\n<p>Fixing that should fix your problem. You don't <em>really</em> need to worry about why your incorrect program behaves the way it does.</p>\n\n<p>But if you're curious ...</p>\n\n<p>Prior to the C99 standard, C had an \"implicit <code>int</code>\" rule. In this case, the parameter <code>x</code> would be of type <code>int</code> because you didn't specify its type explicitly. But since you used an old-style definition, not a prototype, you haven't told the compiler that the argument should be of type <code>int</code>. (Yes, old-style function declarations and definitions can cause some serious problems. That's why we have prototypes.)</p>\n\n<p>So when you call your function with a <code>float</code> argument, the compiler doesn't complain, and it doesn't convert your argument from <code>float</code> to <code>int</code>. Instead, it promotes your argument from <code>float</code> to <code>double</code> (that's just one of the rules for calling a function with no visible prototype, or for calling a variadic function like <code>printf</code>), and the function itself <em>assumes</em> that you really passed it an <code>int</code>.</p>\n\n<p>Result: The behavior is undefined.</p>\n\n<p>One likely result is that the function will treat the <code>double</code> argument as if it were of type <code>int</code>, yielding garbage. Another is that it will read the <code>int</code> value from some other memory location or register, yielding even worse garbage.</p>\n\n<p>Always enable warnings.  Always pay attention to any warnings your compiler produces.  Always ask your compiler to conform to the C99 or C11 standard unless you have a specific reason not to. And always declare and define your functions with prototypes.  (A <em>prototype</em> is a function declaration that specifies the types of the parameters.)</p>\n\n<p>This also means that <code>int main()</code> should be <code>int main(void)</code>. That's not likely to matter (unless you call <code>main</code> recursively, which would be silly), but it's a good habit.</p>\n"}], "owner": {"reputation": 23, "user_id": 9969963, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-qhKLo8qkpiA/AAAAAAAAAAI/AAAAAAAAK5A/p75SdmrJ43o/photo.jpg?sz=128", "display_name": "Matteo_Vezzoli", "link": "https://stackoverflow.com/users/9969963/matteo-vezzoli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 239, "favorite_count": 1, "accepted_answer_id": 50957933, "answer_count": 2, "score": 2, "last_activity_date": 1529533727, "creation_date": 1529532641, "last_edit_date": 1529532794, "question_id": 50957775, "link": "https://stackoverflow.com/questions/50957775/float-function-always-returning-0-000000", "title": "Float function always returning 0.000000", "body": "<p>I'm a beginner with C and I can't find the solution for this \"error\" ...\n(I don't want to just print what I read with scanf, that's just an extract from a bigger program, so can you try not to create a new code but to modify this ?)</p>\n\n<p>Here's the code</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nfloat function(x){\n    return x;\n}\n\nint main(){\n\n    float x;\n    scanf(\"%f\", &amp;x);\n    printf(\"%f \\n\", function(x));\n\n    return 0;\n}\n</code></pre>\n\n<p>And if you don't mind ... can you explain the reason why it doesn't work in this way ? Thank you a lot</p>\n"}, {"tags": ["c", "variadic-functions"], "comments": [{"owner": {"reputation": 2663, "user_id": 6301420, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9f4693f2fcba86b5f59737b94120acc2?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Schepler", "link": "https://stackoverflow.com/users/6301420/daniel-schepler"}, "edited": false, "score": 0, "creation_date": 1529532685, "post_id": 50957748, "comment_id": 88912941, "body": "You might take a look at what libffi does as I think that needs to solve a similar problem.  <a href=\"https://sourceware.org/libffi/\" rel=\"nofollow noreferrer\">sourceware.org/libffi</a>"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1529535890, "post_id": 50957748, "comment_id": 88913719, "body": "Are you sure there&#39;s no version of the C function that takes an array, similar to the relationship between <code>execl()</code> and <code>execv()</code>? There&#39;s no standard mechanism for dynamically creating a variadic argument list."}, {"owner": {"reputation": 1141, "user_id": 188046, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/183ec81bfdbe6442a896a43223281177?s=128&d=identicon&r=PG", "display_name": "Elliott Slaughter", "link": "https://stackoverflow.com/users/188046/elliott-slaughter"}, "edited": false, "score": 0, "creation_date": 1529536701, "post_id": 50957748, "comment_id": 88913904, "body": "This isn&#39;t a standard library function, it&#39;s an internal API, and the authors apparently didn&#39;t consider the use case with dynamic arguments. To be clear, it could be changed with some amount of effort, but due to non-technical factors I&#39;m expecting the required effort to be high...."}, {"owner": {"reputation": 1141, "user_id": 188046, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/183ec81bfdbe6442a896a43223281177?s=128&d=identicon&r=PG", "display_name": "Elliott Slaughter", "link": "https://stackoverflow.com/users/188046/elliott-slaughter"}, "edited": false, "score": 0, "creation_date": 1529536762, "post_id": 50957748, "comment_id": 88913918, "body": "I thought libffi was going to be a lot of work, but actually <a href=\"https://stackoverflow.com/a/12267468/188046\">this answer</a> makes it look not so bad. That may actually be the way to go here."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 1, "creation_date": 1529539349, "post_id": 50957748, "comment_id": 88914503, "body": "There is definitely no standard way of doing what you want to do, and <code>libffi</code> is the non-standard way of choice. But note that you have to use <code>ffi_prep_cif_var</code> to call variadic functions."}], "answers": [{"comments": [{"owner": {"reputation": 1141, "user_id": 188046, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/183ec81bfdbe6442a896a43223281177?s=128&d=identicon&r=PG", "display_name": "Elliott Slaughter", "link": "https://stackoverflow.com/users/188046/elliott-slaughter"}, "edited": false, "score": 1, "creation_date": 1529534290, "post_id": 50957938, "comment_id": 88913373, "body": "Doesn&#39;t this require the argumens to known at compile time? I.e. <code>__VA_ARGS__</code> is a feature of the C preprocessor, not of the C language itself. Unfortunately, in my use case, I actually need to be able to build these dynamically."}, {"owner": {"reputation": 9367, "user_id": 4454124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c094d8979fb41b789a7c7f21d9329359?s=128&d=identicon&r=PG&f=1", "display_name": "mnistic", "link": "https://stackoverflow.com/users/4454124/mnistic"}, "reply_to_user": {"reputation": 1141, "user_id": 188046, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/183ec81bfdbe6442a896a43223281177?s=128&d=identicon&r=PG", "display_name": "Elliott Slaughter", "link": "https://stackoverflow.com/users/188046/elliott-slaughter"}, "edited": false, "score": 0, "creation_date": 1529534572, "post_id": 50957938, "comment_id": 88913449, "body": "Yep, this is compile time."}], "tags": [], "owner": {"reputation": 9367, "user_id": 4454124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c094d8979fb41b789a7c7f21d9329359?s=128&d=identicon&r=PG&f=1", "display_name": "mnistic", "link": "https://stackoverflow.com/users/4454124/mnistic"}, "is_accepted": false, "score": 0, "last_activity_date": 1529533757, "creation_date": 1529533757, "answer_id": 50957938, "question_id": 50957748, "link": "https://stackoverflow.com/questions/50957748/passing-a-dynamic-set-of-variadic-arguments-to-a-c-function/50957938#50957938", "title": "Passing a dynamic set of variadic arguments to a C function", "body": "<p>The easiest way to do this would be with <a href=\"https://gcc.gnu.org/onlinedocs/cpp/Variadic-Macros.html\" rel=\"nofollow noreferrer\">variadic macros</a>, kind of like the way it's done for <code>eprintf</code>:</p>\n\n<pre><code>#define eprintf(\u2026) fprintf (stderr, __VA_ARGS__)\n</code></pre>\n\n<p><code>__VA_ARGS__</code> expands into the full argument list passed into the macro with which you can then call the other function declared with <code>...</code>. Unfortunately what you want to do cannot be done within a function without going through a lot of effort that you seem to want to avoid.</p>\n"}, {"comments": [{"owner": {"reputation": 1141, "user_id": 188046, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/183ec81bfdbe6442a896a43223281177?s=128&d=identicon&r=PG", "display_name": "Elliott Slaughter", "link": "https://stackoverflow.com/users/188046/elliott-slaughter"}, "edited": false, "score": 0, "creation_date": 1529534882, "post_id": 50958029, "comment_id": 88913514, "body": "This looks like an excellent answer to <a href=\"https://stackoverflow.com/q/3530771/188046\">this question</a>. However, as best I can tell, this only allows you to forward varargs from the current function to a callee. For my use case, I&#39;m actually dynamically building the argument list, it&#39;s not coming in as a parameter list."}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "reply_to_user": {"reputation": 1141, "user_id": 188046, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/183ec81bfdbe6442a896a43223281177?s=128&d=identicon&r=PG", "display_name": "Elliott Slaughter", "link": "https://stackoverflow.com/users/188046/elliott-slaughter"}, "edited": false, "score": 0, "creation_date": 1529535355, "post_id": 50958029, "comment_id": 88913607, "body": "Can you provide an example? I don&#39;t know what you mean by &quot;dynamically&quot; building the argument list. You can have one function witch &quot;transposes&quot; the arguments and which then calls the function which calls __builtin_apply()."}, {"owner": {"reputation": 1141, "user_id": 188046, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/183ec81bfdbe6442a896a43223281177?s=128&d=identicon&r=PG", "display_name": "Elliott Slaughter", "link": "https://stackoverflow.com/users/188046/elliott-slaughter"}, "edited": false, "score": 0, "creation_date": 1529537166, "post_id": 50958029, "comment_id": 88913998, "body": "(This is a toy example, but illustrates the point.) Suppose you have a function that dynamically allocates and returns something like an array of values. The values are computed in some arbitrary way by the inputs to the program. Are the <code>__builtin_*</code> functions sufficient to convert an array to varargs? I don&#39;t see a way to do that with those APIs. (Note in the real application, the values are not all of the same type, though they do have some structure.)"}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "reply_to_user": {"reputation": 1141, "user_id": 188046, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/183ec81bfdbe6442a896a43223281177?s=128&d=identicon&r=PG", "display_name": "Elliott Slaughter", "link": "https://stackoverflow.com/users/188046/elliott-slaughter"}, "edited": false, "score": 0, "creation_date": 1529539551, "post_id": 50958029, "comment_id": 88914559, "body": "No. Puff, an array is a good example. To do this in C you need to create a switch for each case. Arguments passed to functions are resolved compile time. You can&#39;t <code>push_back</code> an argument, at least I haven&#39;t heard of it."}], "tags": [], "owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "is_accepted": false, "score": 0, "last_activity_date": 1529540012, "last_edit_date": 1529540012, "creation_date": 1529534411, "answer_id": 50958029, "question_id": 50957748, "link": "https://stackoverflow.com/questions/50957748/passing-a-dynamic-set-of-variadic-arguments-to-a-c-function/50958029#50958029", "title": "Passing a dynamic set of variadic arguments to a C function", "body": "<p>If you use gcc compiler, you can use __builtin_va_arg_pack() or __builtin_apply(), see <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Constructing-Calls.html\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>Examples:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stddef.h&gt;\n#include &lt;stdarg.h&gt;\n\nint my_printf(const char *fmt, ...)\n{\n    void *args = __builtin_apply_args();\n    void *ret = __builtin_apply((void(*)())printf, args, 100);\n    __builtin_return(ret);\n}\n\nextern int my2_printf(const char *, ...);\nextern inline __attribute__((__always_inline__,__gnu_inline__))\nint my2_printf(const char *fmt, ...) {\n    return printf(fmt, __builtin_va_arg_pack());\n}\n\nint main()\n{\n    my_printf(\"%s %s %s %s %s\\n\", \"Hi\", \"I\", \"am\", \"kamil\", \"!\");\n    my2_printf(\"%s %s %s %s\\n\", \"Variadic\", \"args\", \"are\", \"fun\");\n    return 0;\n}\n</code></pre>\n\n<p>@edit:<br>\nAs the question is also about on how to construct a dynamic argument list and then pass it to function. You can create a function for each case you need to support and use a big switch to differentiate between them.<br>\nA example for printing an array of unknown compile size:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stddef.h&gt;\n#include &lt;stdarg.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;boost/preprocessor/repetition/repeat.hpp&gt;\n\nvoid print_array(size_t cnt, ...)\n{\n        va_list va;\n        va_start(va, cnt);\n        printf(\"%s cnt=%d :\", __func__, cnt);\n        for (size_t i = 0; i &lt; cnt; ++i) {\n                printf(\" %d\", va_arg(va, int));\n        }\n        va_end(va);\n        printf(\"%s\\n\");\n}\n\n// we support an array up to that many arguments\n#define CALL_PRINT_ARRAY_MAX  128\n\n\n#define CALL_PRINT_ARRAY_ARGS(z, n, text) \\\n        , arr[n]\n#define CALL_PRINT_ARRAY_DECLARE(z, n, text) \\\nvoid call_print_array_##n (int arr[]) \\\n{ \\\n        print_array(n BOOST_PP_REPEAT(n, CALL_PRINT_ARRAY_ARGS, ())); \\\n}\nBOOST_PP_REPEAT(CALL_PRINT_ARRAY_MAX, CALL_PRINT_ARRAY_DECLARE, ())\n#undef CALL_PRINT_ARRAY_DECLARE\n#undef CALL_PRINT_ARRAY_ARGS\n\nint call_print_array(int arr[], size_t n)\n{\n        switch(n) {\n\n#define CALL_PRINT_ARRAY_CASE(z, n, text) \\\n        case n: call_print_array_##n(arr); break;\n                BOOST_PP_REPEAT(CALL_PRINT_ARRAY_MAX, CALL_PRINT_ARRAY_CASE, ())\n#undef CALL_PRINT_ARRAY_CASE\n\n        default:\n                fprintf(stderr, \"Array size is too big for what we're prepared\\n\");\n                return -1;\n        }\n        return 0;\n}\n\nint main()\n{\n        //int a1[5] = {1,2,3,4,5};\n        //call_print_array(a1, sizeof(a1)/sizeof(a1[0]));\n\n        size_t size;\n        scanf(\"%zu\", &amp;size); // insecure\n        int * a2 = calloc(size, sizeof(*a2));\n        for (size_t i = 0; i &lt; size; ++i)\n                a2[i] = i;\n        call_print_array(a2, size);\n\n\n        return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 1141, "user_id": 188046, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/183ec81bfdbe6442a896a43223281177?s=128&d=identicon&r=PG", "display_name": "Elliott Slaughter", "link": "https://stackoverflow.com/users/188046/elliott-slaughter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 535, "favorite_count": 0, "closed_date": 1529536096, "answer_count": 2, "score": 1, "last_activity_date": 1529540012, "creation_date": 1529532464, "last_edit_date": 1529538261, "question_id": 50957748, "link": "https://stackoverflow.com/questions/50957748/passing-a-dynamic-set-of-variadic-arguments-to-a-c-function", "closed_reason": "Duplicate", "title": "Passing a dynamic set of variadic arguments to a C function", "body": "<p>I'm trying to call a C function that takes variadic arguments, and I need to pass in a dynamic number of arguments to the function. Additionally, this is an API I can't modify without going to a lot of effort, so if there's any possible to make this work I'll take it.</p>\n\n<p>As far as I can tell, <code>va_list</code> is not sufficient for this purpose since you can't pass a <code>va_list</code> where <code>...</code> was written in the original function signature.</p>\n\n<p>Answers for other questions like <a href=\"https://stackoverflow.com/q/3530771/188046\">this one</a> talk about how to pass a <code>...</code> from one function to another, but that's not what I'm doing. I need to actually dynamically generate the list of arguments, I'm not getting it in as a <code>...</code>. Also, all the answers I can find rely being able to modify the function to take a <code>va_list</code>, which is not an option here.</p>\n\n<p>There was also <a href=\"https://stackoverflow.com/q/24927094/188046\">this question</a>, which was marked as a dupe of the previous question despite not actually asking the same question. Again, the only answer suggests converting the call to use <code>va_list</code> which is not an option.</p>\n\n<p>I would understand if the standard didn't include a way to do this, but this seems like a case where I can imagine a perfectly reasonable implementation. This isn't so different from, say, <code>alloca</code>. Anyway, if it's not possible, that's fine, but I'd like the SO community to realize that this isn't a dupe of <a href=\"https://stackoverflow.com/q/3530771/188046\">this question</a> and deserves a definitive answer.</p>\n\n<p>The API I'm calling is in C, but if there's a way to do this in C++ I would consider it.</p>\n\n<p><strong>Edit:</strong> If you have these requirements, it looks like <a href=\"https://stackoverflow.com/a/12267468/188046\">this answer using libffi</a> is the best way to go. There does not appear to be a way to do this either in standard C or with GCC extensions otherwise.</p>\n"}, {"tags": ["c", "arrays", "pointers"], "comments": [{"owner": {"reputation": 478, "user_id": 9906369, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-r_zu7LSk4bY/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1tWAu5bmCC_qF7xvQSMJaDeY2cBQ/mo/photo.jpg?sz=128", "display_name": "Ilan Keshet", "link": "https://stackoverflow.com/users/9906369/ilan-keshet"}, "edited": false, "score": 0, "creation_date": 1529531531, "post_id": 50957576, "comment_id": 88912533, "body": "you will need to use malloc then, and instead of int faceverts[6][4],  make it int **faceverts"}, {"owner": {"reputation": 478, "user_id": 9906369, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-r_zu7LSk4bY/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1tWAu5bmCC_qF7xvQSMJaDeY2cBQ/mo/photo.jpg?sz=128", "display_name": "Ilan Keshet", "link": "https://stackoverflow.com/users/9906369/ilan-keshet"}, "edited": false, "score": 0, "creation_date": 1529531571, "post_id": 50957576, "comment_id": 88912546, "body": "Is this straight up C, no C++?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9914667"}, "reply_to_user": {"reputation": 478, "user_id": 9906369, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-r_zu7LSk4bY/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1tWAu5bmCC_qF7xvQSMJaDeY2cBQ/mo/photo.jpg?sz=128", "display_name": "Ilan Keshet", "link": "https://stackoverflow.com/users/9906369/ilan-keshet"}, "edited": false, "score": 0, "creation_date": 1529531639, "post_id": 50957576, "comment_id": 88912569, "body": "Yes, this is C only. No C++ here!"}, {"owner": {"reputation": 478, "user_id": 9906369, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-r_zu7LSk4bY/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1tWAu5bmCC_qF7xvQSMJaDeY2cBQ/mo/photo.jpg?sz=128", "display_name": "Ilan Keshet", "link": "https://stackoverflow.com/users/9906369/ilan-keshet"}, "edited": false, "score": 0, "creation_date": 1529531677, "post_id": 50957576, "comment_id": 88912586, "body": "<code>as well as not have a fixed 2D array, but rather an array of 1D arrays of varying length</code>. Vary array length is not a possible thing to achieve. Once an array has been allocated either on the stack or on the heap, you cannot vary it&#39;s allocated size, unless you reallocate entire thing + copy back in the previously stored guys"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9914667"}, "reply_to_user": {"reputation": 478, "user_id": 9906369, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-r_zu7LSk4bY/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1tWAu5bmCC_qF7xvQSMJaDeY2cBQ/mo/photo.jpg?sz=128", "display_name": "Ilan Keshet", "link": "https://stackoverflow.com/users/9906369/ilan-keshet"}, "edited": false, "score": 0, "creation_date": 1529531768, "post_id": 50957576, "comment_id": 88912616, "body": "Is it possible I can use pointers to multiple 1D arrays of varying length rather than specifically an array of 1D arrays?"}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 1, "creation_date": 1529531769, "post_id": 50957576, "comment_id": 88912617, "body": "What you want is an array of pointers.  Those pointers will then themselves point to your arrays of varying size."}, {"owner": {"reputation": 478, "user_id": 9906369, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-r_zu7LSk4bY/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1tWAu5bmCC_qF7xvQSMJaDeY2cBQ/mo/photo.jpg?sz=128", "display_name": "Ilan Keshet", "link": "https://stackoverflow.com/users/9906369/ilan-keshet"}, "edited": false, "score": 1, "creation_date": 1529531867, "post_id": 50957576, "comment_id": 88912646, "body": "<code>Is it possible I can use pointers to multiple 1D arrays of varying length? </code>.    Arrays cannot &quot;vary&quot; in length once allocated either on the heap or on the stack.  You can move pointers around / reallocate.   But concept of &quot;varying&quot; an array length is not a thing."}, {"owner": {"user_type": "does_not_exist", "display_name": "user9914667"}, "edited": false, "score": 0, "creation_date": 1529531884, "post_id": 50957576, "comment_id": 88912648, "body": "Ah, thank you Christian! I don&#39;t have enough rep to say that is a useful comment... but +1 anyway!"}, {"owner": {"reputation": 478, "user_id": 9906369, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-r_zu7LSk4bY/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1tWAu5bmCC_qF7xvQSMJaDeY2cBQ/mo/photo.jpg?sz=128", "display_name": "Ilan Keshet", "link": "https://stackoverflow.com/users/9906369/ilan-keshet"}, "edited": false, "score": 0, "creation_date": 1529531931, "post_id": 50957576, "comment_id": 88912665, "body": "@Crunchly You&#39;re welcome too... :p"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9914667"}, "edited": false, "score": 0, "creation_date": 1529531934, "post_id": 50957576, "comment_id": 88912667, "body": "Ilan, I guess I should clarify. When I mean varying 1D arrays, I mean multiple 1D arrays of differing lengths, not an array that is actually changing size."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1529531963, "post_id": 50957576, "comment_id": 88912678, "body": "Initialization in C is done with fixed sizes determined when the code is compiled.  If you need variable sizes determined at runtime, you cannot use initialization \u2014 you have to use run-time assignments in some shape or form."}, {"owner": {"user_type": "does_not_exist", "display_name": "user9914667"}, "edited": false, "score": 0, "creation_date": 1529531973, "post_id": 50957576, "comment_id": 88912682, "body": "Ok, thanks you two!"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1529532038, "post_id": 50957576, "comment_id": 88912711, "body": "&quot;multiple 1D arrays of differing lengths, not an array that is actually changing size&quot; --&gt; when are these lengths known? At compile time?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9914667"}, "edited": false, "score": 0, "creation_date": 1529532126, "post_id": 50957576, "comment_id": 88912746, "body": "I am basically just passing my function a bunch of 1D arrays of varying lengths, so I do not know when the lengths are known"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1529532209, "post_id": 50957576, "comment_id": 88912773, "body": "If the 1D &quot;arrays&quot; have various lengths, how would you want code to retrieve the information on the &quot;array&quot; length? With a separate array of length values? Or as part of the &quot;array&quot; - somehow?"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1529532225, "post_id": 50957576, "comment_id": 88912783, "body": "You can make a 2D array with varying length and you do not need to use pointers. Just change <code>int faceverts[6][4]</code> to <code>int faceverts[ROW][COL]</code>, and change <code>int (*q)[4]</code> to <code>int (*q)[COL]</code>. You will also need to change how you initialize the array because obviously you can&#39;t use a fixed length braced list when the array sizes may change at runtime. If this does not answer your question then please elaborate"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9914667"}, "edited": false, "score": 0, "creation_date": 1529532317, "post_id": 50957576, "comment_id": 88912815, "body": "MM, for me the problem with using a 2D array is that the columns will be of varying lengths, and I do not think I can account for that at runtime."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1529532711, "post_id": 50957576, "comment_id": 88912950, "body": "So <code>int faceverts[6][4]</code> becomes <code>int *faceverts[6]</code>.  Still where do you want code to save/retrieve the length of the 1D arrays it points too?  Those 1D arrays ares not constant (4) as you say, so where/how to save its length is another issue to solve too."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1529533163, "post_id": 50957576, "comment_id": 88913080, "body": "@Crunchly Do you mean that the array can simultaneously hold rows of different lengths?"}], "answers": [{"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 1, "last_activity_date": 1529534050, "last_edit_date": 1529534050, "creation_date": 1529533607, "answer_id": 50957915, "question_id": 50957576, "link": "https://stackoverflow.com/questions/50957576/how-to-initialize-an-array-of-arrays-with-non-constant-length/50957915#50957915", "title": "How to initialize an array of arrays with non-constant length?", "body": "<p>One approach is to create an array of structures.  Each structure element contains a pointer and count to  an array.  </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\ntypedef struct {\n  int *a;\n  size_t n;\n} TwoD;\n\n#define AN(a) (sizeof (a)/sizeof (a)[0])\n\nint smallest[1] = { 1 };\nint smaller[2] = { 2, 3 };\nint small[3] = { 4, 5, 6 };\nint big[4] = { 7, 8, 9, 10 };\nint bigger[5] = { 11, 12, 13, 14, 15 };\nint biggest[6] = { 16, 17, 18, 19, 20, 21 };\n\nTwoD faceverts[6] = {\n    { smallest, AN(smallest) }, { smaller, AN(smaller) }, { small, AN(small) }, \n    { big, AN(big) }, { bigger, AN(bigger) }, { biggest, AN(biggest) } };\n\nint main(void) {\n  // Let us change things a bit at run time\n  int change[] = { 22,23,24,25,26,27,28 };\n  faceverts[0] = (TwoD) {change, AN(change)};  // compound literal\n  for (size_t row = 0; row &lt; AN(faceverts); row++) {\n    for (size_t col = 0; col &lt; faceverts[row].n; col++) {\n      printf(\" %d\", faceverts[row].a[col]);\n    }\n    printf(\"\\n\");\n  }\n  return 0;\n}\n</code></pre>\n\n<p>Output</p>\n\n<pre><code> 22 23 24 25 26 27 28\n 2 3\n 4 5 6\n 7 8 9 10\n 11 12 13 14 15\n 16 17 18 19 20 21\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 427, "user_id": 8834967, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Xrf_YCVb2Vw/AAAAAAAAAAI/AAAAAAAAAAc/K52j8i_sYWw/photo.jpg?sz=128", "display_name": "Joy Allen", "link": "https://stackoverflow.com/users/8834967/joy-allen"}, "is_accepted": false, "score": 0, "last_activity_date": 1529544618, "creation_date": 1529544618, "answer_id": 50959134, "question_id": 50957576, "link": "https://stackoverflow.com/questions/50957576/how-to-initialize-an-array-of-arrays-with-non-constant-length/50959134#50959134", "title": "How to initialize an array of arrays with non-constant length?", "body": "<p>There is only 1D array in memory. (2D array is actually a long 1D array)</p>\n\n<p>Allocate a 2D array (rows, cols)</p>\n\n<pre><code>int *arr;\nint size;\nsize = width * height;\narr = (int *) malloc(sizeof(int) * size);\n</code></pre>\n\n<p>Access element (x, y) in the array</p>\n\n<pre><code>int e;\nint offset;\noffset = x * cols + y;\ne = *(arr + offset);\n</code></pre>\n\n<p>Free the array</p>\n\n<pre><code>free(arr);\n</code></pre>\n\n<p>Allocate a irregular 2D array (col_0, col_2, ...., col_n-1);</p>\n\n<pre><code>int arr;\nint size = 0;\n// size = col_0 + ... + col_n-1;\narr = (int *) malloc(sizeof(int) * size);\n</code></pre>\n\n<p>Access element (x_row, y_col) in the array</p>\n\n<pre><code>int e;\nint offset;\n// offset = col_1 + ... + col_x-1 + y_col;\ne = *(arr + offset);\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9914667"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1529544618, "creation_date": 1529531394, "last_edit_date": 1529531870, "question_id": 50957576, "link": "https://stackoverflow.com/questions/50957576/how-to-initialize-an-array-of-arrays-with-non-constant-length", "title": "How to initialize an array of arrays with non-constant length?", "body": "<p>I am trying to make an array which contains 1D arrays of varying length. Due to the variation in length, I cannot use a 2D array. My code is as follows:</p>\n\n<pre><code>int ROW = 6;\nint COL = 4;\nint faceverts[6][4] = {{3,2,1,0}, {4,5,1,0}, {2,6,5,1}, {2,3,5,6}, {7,3,0,4}, {1,6,7,4}};   \nint (*q)[4] = faceverts;\n\nint main(){\n    for (int i = 0; i &lt; ROW; i++){\n        for (int k = 0; k &lt; COL; k++)\n            printf(\"%d \", *(*(q+i)+k));\n        printf(\"\\n\");\n    }\n}\n</code></pre>\n\n<p>My goal is to be able to get rid of those <code>ROW</code> and <code>COL</code> variables, as well as not have a fixed 2D array, but rather an array of 1D arrays of varying length. I have been told that using pointers is key to doing this task, but I do not know how to do this myself.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 33, "user_id": 9457658, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Rc_v7QLkG8Y/AAAAAAAAAAI/AAAAAAAAAHA/aaZORjHX1cg/photo.jpg?sz=128", "display_name": "PacoPeps", "link": "https://stackoverflow.com/users/9457658/pacopeps"}, "edited": false, "score": 0, "creation_date": 1529531171, "post_id": 50957470, "comment_id": 88912402, "body": "I forgot the pointer. Just edited it. Thnks"}, {"owner": {"reputation": 100407, "user_id": 16406, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fadf252892475e9b177d5cd5e8b24145?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Dodd", "link": "https://stackoverflow.com/users/16406/chris-dodd"}, "edited": false, "score": 0, "creation_date": 1529531176, "post_id": 50957470, "comment_id": 88912403, "body": "As written, this gives you <code>error: member reference type &#39;tInnerStruct&#39; is not a pointer; did you mean to use &#39;.&#39;?</code>.  If you change it to <code>.</code> you get <code>error: cannot assign to variable &#39;ptr&#39; with const-qualified type</code>"}, {"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 0, "creation_date": 1529531178, "post_id": 50957470, "comment_id": 88912404, "body": "<code>struct1</code> is just a pointer. Its target doesn\u2019t belong to <code>tContainerStruct</code> and it isn\u2019t a <code>const</code> pointer, so\u2026"}, {"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1529531334, "post_id": 50957470, "comment_id": 88912462, "body": "Const declares what&#39;s const-ptr. That&#39;s it."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1529531656, "post_id": 50957470, "comment_id": 88912577, "body": "<code>const tContainerStruct *ptr</code> says that you can&#39;t modify the things that <code>ptr</code> points at \u2014 the <code>struct1</code>, <code>struct2</code> and <code>struct3</code> pointers.  It doesn&#39;t say you can&#39;t use the <code>ptr-&gt;struct1</code> pointer to change what it points at."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1529532120, "post_id": 50957470, "comment_id": 88912744, "body": "<code>struct1-&gt;member1</code> is not an underlying member of <code>tContainerStruct</code> . There is no relationship between a pointer and where it is currently pointing."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1529532390, "post_id": 50957470, "comment_id": 88912840, "body": "&quot;Why is this legal?&quot; --&gt; because <code>tInnerStruct *struct1;</code> is not <code>const tInnerStruct *struct1;</code>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1529532546, "post_id": 50957470, "comment_id": 88912887, "body": "Detail: &quot;all members of struct1, struct2 and struct3 ....&quot; --&gt; <code>struct1, struct2, struct3</code> have no members.  They are all pointers.  What they point to has members."}, {"owner": {"reputation": 33, "user_id": 9457658, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Rc_v7QLkG8Y/AAAAAAAAAAI/AAAAAAAAAHA/aaZORjHX1cg/photo.jpg?sz=128", "display_name": "PacoPeps", "link": "https://stackoverflow.com/users/9457658/pacopeps"}, "edited": false, "score": 0, "creation_date": 1529532868, "post_id": 50957470, "comment_id": 88912999, "body": "So if <code>struct1, struct 2, struct3</code> were not pointers but just structs inside <code>tContainerStruct</code>, would their members be protected?"}], "answers": [{"tags": [], "owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "is_accepted": true, "score": 1, "last_activity_date": 1529533452, "last_edit_date": 1529533452, "creation_date": 1529532776, "answer_id": 50957802, "question_id": 50957470, "link": "https://stackoverflow.com/questions/50957470/scope-of-const-for-pointers-to-protect-underlying-members-of-struct-in-c/50957802#50957802", "title": "Scope of &#39;const&#39; for pointers to protect underlying members of struct in C", "body": "<p><code>const</code> only applies to the portion of the declaration it is modifying.</p>\n\n<p>So:</p>\n\n<pre><code>int d;\nint * const q = &amp;d;\n*q = 3;             /* OK, *q is not const */\nq = NULL;           /* ERROR, q is const */\nconst int * p;\np = &amp;d;             /* OK, p is not const */\n*p = 3;             /* ERROR, *p is const */\n</code></pre>\n\n<p><code>const</code>ness does not traverse beyond the immediate object to which it is applied.\nFor your example, a <code>const tContainerStruct</code> would mean that each member of <code>tContainerStruct</code> would be <code>const</code>. Suppose we defined:</p>\n\n<pre><code>typedef struct {\n    tInnerStruct * const struct1;\n    tInnerStruct * const struct2;\n    tInnerStruct * const struct3;\n}constant_tContainerStruct;\n</code></pre>\n\n<p>Then <code>constant_tContainerStruct</code> would behave like your <code>const tContainerStruct</code>. But, since the <code>const</code> is applied to the pointer member, it has no affect on the <code>tInnerStruct</code> being pointed to, so those objects remain modifiable.</p>\n"}, {"tags": [], "owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "is_accepted": false, "score": 0, "last_activity_date": 1529532788, "creation_date": 1529532788, "answer_id": 50957804, "question_id": 50957470, "link": "https://stackoverflow.com/questions/50957470/scope-of-const-for-pointers-to-protect-underlying-members-of-struct-in-c/50957804#50957804", "title": "Scope of &#39;const&#39; for pointers to protect underlying members of struct in C", "body": "<p>In this case, const applies only to the \"second level\", per se. Only the level to which it is applied.<br>\nConsider the following:</p>\n\n<pre><code>struct a_s {\n   int x;\n   const int cx;\n};\nstruct b_s { \n    struct a_s *y;\n    const struct a_s *cy;\n    struct a_s * const yc;\n    const struct a_s * const cyc;\n};\nstruct b_s *b;\nb = 1; // ok\n\nb-&gt;y = 1; // ok\nb-&gt;y-&gt;x = 1; // ok\nb-&gt;y-&gt;cx = 1; // error, typeof(b-&gt;y-&gt;cx) = const int\n\nb-&gt;cy = 1; // ok, you can modify the pointers value\nb-&gt;cy-&gt;x = 1; // error, b-&gt;cy points to a read-only object, you can't modify the memory where the pointer points to\nb-&gt;cy-&gt;cx = 1; // error, typeof(b-&gt;y-&gt;cx) = const int\n\nb-&gt;yc = 1; // error, b-&gt;yc is const, the pointers value itself is read-only, but...\nb-&gt;yc-&gt;x = 1; // ok, you can modify the memory where the pointer points to.\nb-&gt;yc-&gt;cx = 1; // error, typeof(b-&gt;y-&gt;cx) = const int\n\nb-&gt;cyc = 1; // error, the pointers value itself is read-only, you can't modify the pointer\nb-&gt;cyc-&gt;x = 1; // error, the memory to which the pointer points is read-only too\nb-&gt;cyc-&gt;cx = 1; // error, typeof(b-&gt;y-&gt;cx) = const int\n\nconst struct b_s *cb;\ncb = 1; // ok, there is no const after '*' ;)\n\ncb-&gt;y = 1; // error, cb points to read-only object, but\ncb-&gt;y-&gt;x = 1; // ok, the pointer cb-&gt;y points to a modifiable memory. \n// The pointer cb-&gt;y can't be modified, but the memory to which the pointer points to can be modified\ncb-&gt;y-&gt;cx = 1; // this is always error\n\ncb-&gt;cy = 1; // still error\ncb-&gt;cy-&gt;x = 1; // error\n\ncb-&gt;yc = 1; // error, not only b points to read-only memory, but the pointer itself is read-only\n</code></pre>\n\n<p>For some reference&amp;reading see <a href=\"https://en.cppreference.com/w/cpp/language/pointer\" rel=\"nofollow noreferrer\">constness section here</a>.</p>\n"}], "owner": {"reputation": 33, "user_id": 9457658, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Rc_v7QLkG8Y/AAAAAAAAAAI/AAAAAAAAAHA/aaZORjHX1cg/photo.jpg?sz=128", "display_name": "PacoPeps", "link": "https://stackoverflow.com/users/9457658/pacopeps"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 50957802, "answer_count": 2, "score": 0, "last_activity_date": 1529533452, "creation_date": 1529530891, "last_edit_date": 1529531104, "question_id": 50957470, "link": "https://stackoverflow.com/questions/50957470/scope-of-const-for-pointers-to-protect-underlying-members-of-struct-in-c", "title": "Scope of &#39;const&#39; for pointers to protect underlying members of struct in C", "body": "<p>What is the scope of 'const' in pointer declaration to protect underlying members of a struct?</p>\n\n<p>Here my code explanation:</p>\n\n<pre><code>typedef struct {\n    int member1;\n    int member2;\n}tInnerStruct;\n\ntypedef struct {\n    tInnerStruct *struct1;\n    tInnerStruct *struct2;\n    tInnerStruct *struct3;\n}tContainerStruct;\n\nvoid function1(const tContainerStruct * ptr)\n{\n//  L1  |   L2   |  L3         =&gt; Up to which level 'const' protects ?\n    ptr-&gt;struct1-&gt;member1 = 5;  // =&gt; Why is this legal?\n                                //    Shouldn't 'const' protect this?\n}\n</code></pre>\n\n<p>Up to which level 'const' qualifier protects underlying members?\nSeems evident that</p>\n\n<pre><code>ptr-&gt;struct1\n</code></pre>\n\n<p>cannot be modified, the same for struct2 and struct3, because are members of the struct marked as const. But all members of struct1, struct2 and struct3 are not affected at all by 'const' modifier?</p>\n"}, {"tags": ["c", "libxlsxwriter"], "comments": [{"owner": {"reputation": 4231, "user_id": 1947216, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b52eaf82bd907e8b39e49aeea74273e?s=128&d=identicon&r=PG", "display_name": "mentallurg", "link": "https://stackoverflow.com/users/1947216/mentallurg"}, "edited": false, "score": 0, "creation_date": 1529530613, "post_id": 50957135, "comment_id": 88912180, "body": "Describe what you have done so far."}], "answers": [{"tags": [], "owner": {"reputation": 28655, "user_id": 10238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8c3b1025babebf20168dd90ea8f268c?s=128&d=identicon&r=PG", "display_name": "jmcnamara", "link": "https://stackoverflow.com/users/10238/jmcnamara"}, "is_accepted": false, "score": 1, "last_activity_date": 1536741943, "last_edit_date": 1536741943, "creation_date": 1530003481, "answer_id": 51038814, "question_id": 50957135, "link": "https://stackoverflow.com/questions/50957135/chartcheet-on-libxlsxwriter/51038814#51038814", "title": "chartcheet on libxlsxwriter", "body": "<p>Chartsheets aren't currently available in libxlsxwriter but they are a planned feature.</p>\n\n<p><strong>Update</strong>: <a href=\"https://libxlsxwriter.github.io/chartsheet_8h.html\" rel=\"nofollow noreferrer\">Chartsheet</a> support has been added to libxlsxwriter in version 0.8.0.</p>\n"}], "owner": {"reputation": 23, "user_id": 9969825, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-XQWKkoIBcv8/AAAAAAAAAAI/AAAAAAAAAHU/4Lott_zCYxc/photo.jpg?sz=128", "display_name": "Wired", "link": "https://stackoverflow.com/users/9969825/wired"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1536741943, "creation_date": 1529529351, "last_edit_date": 1529566205, "question_id": 50957135, "link": "https://stackoverflow.com/questions/50957135/chartcheet-on-libxlsxwriter", "title": "chartcheet on libxlsxwriter", "body": "<p>I'm trying to use the <a href=\"https://github.com/jmcnamara/libxlsxwriter\" rel=\"nofollow noreferrer\"><code>libxlsxwriter</code></a> C library but I'm struggling to make chartsheets on a new excel sheet (and not a basic chart on a sheet between formulas).</p>\n\n<p>Any Ideas ? Even on how-to hardcode this ?</p>\n\n<p><strong>Edit</strong>\nThis is what I've done so far :</p>\n\n<pre><code>lxw_worksheet *ChartWorksheet = workbook_add_worksheet(workbook, \"TTime\");\nlxw_chart *chart = workbook_add_chart(workbook, LXW_CHART_SCATTER);\n\nlxw_chart_series *AutoWarmSerie = chart_add_series(chart, \"\", \"\");\nchart_series_set_name(AutoWarmSerie, \"AutoEchauff\");\n\n// fill the series\nchart_series_set_categories(AutoWarmSerie, DataWorksheet-&gt;name, 4, Idx, 4 + m_AutoWarmTime.size(), m_DataColumnIdx); // Time\nchart_series_set_values(AutoWarmSerie, DataWorksheet-&gt;name, 4, m_DataColumnIdx + 1, 4 + m_AutoWarmTime.size(), m_DataColumnIdx + 1); // Temperature\n\n/* Add a chart title and some axis labels. */\nchart_title_set_name(chart, \"Results of sample analysis\");\nchart_axis_set_name(chart-&gt;x_axis, \"Test number\");\nchart_axis_set_name(chart-&gt;y_axis, \"Sample length (mm)\");\n\n/* Set an Excel chart style. */\nchart_set_style(chart, 11);\n\n/* Insert the chart into the worksheet. */\nworksheet_insert_chart(ChartWorksheet, CELL(\"E2\"), chart);\n</code></pre>\n\n<p>But I only get a single chart box on a sheet, and I dunno how to make the box a whole sheet, so...</p>\n"}, {"tags": ["c", "for-loop", "scanf"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1529530714, "post_id": 50957131, "comment_id": 88912218, "body": "Note: <code>scanf(&quot; %d&quot;...</code> scans the same as <code>scanf(&quot;%d&quot;...</code>  (no space)."}], "answers": [{"comments": [{"owner": {"reputation": 1120, "user_id": 3381662, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/100001425623999/picture?type=large", "display_name": "Aleksandrus", "link": "https://stackoverflow.com/users/3381662/aleksandrus"}, "edited": false, "score": 0, "creation_date": 1529530111, "post_id": 50957266, "comment_id": 88911979, "body": "pretty simple eh... hahaha"}, {"owner": {"reputation": 33, "user_id": 9969809, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JsjuY.jpg?s=128&g=1", "display_name": "GoldMonkeyTMM", "link": "https://stackoverflow.com/users/9969809/goldmonkeytmm"}, "edited": false, "score": 0, "creation_date": 1529530435, "post_id": 50957266, "comment_id": 88912112, "body": "Wow... thank you so much, it would have taken me ages to see that extra semicolon. I made possibly the most beginner error in coding, sorry about that."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1529530618, "post_id": 50957266, "comment_id": 88912183, "body": "@TannerMiller The &quot;beginner error&quot; is not the <code>;</code> issue.  It is the last point here: not enabling all compiler warnings or using a weak compiler."}, {"owner": {"reputation": 33, "user_id": 9969809, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JsjuY.jpg?s=128&g=1", "display_name": "GoldMonkeyTMM", "link": "https://stackoverflow.com/users/9969809/goldmonkeytmm"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1529530786, "post_id": 50957266, "comment_id": 88912250, "body": "@chux for the class we are required to use the NoMachine gcc compiler running a remote linux desktop. I am not entirely sure if it is a good compiler or not, I will play around with it to make sure all warnings are enabled."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 33, "user_id": 9969809, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JsjuY.jpg?s=128&g=1", "display_name": "GoldMonkeyTMM", "link": "https://stackoverflow.com/users/9969809/goldmonkeytmm"}, "edited": false, "score": 0, "creation_date": 1529530904, "post_id": 50957266, "comment_id": 88912296, "body": "@GoldMonkeyTMM You can always use <i>another</i> compiler too - even if just to get good compiler error/warning feedback.  Well enabled <code>gcc</code> should be good enough."}], "tags": [], "owner": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "is_accepted": true, "score": 5, "last_activity_date": 1529530003, "creation_date": 1529530003, "answer_id": 50957266, "question_id": 50957131, "link": "https://stackoverflow.com/questions/50957131/why-is-scanf-being-skipped-over-in-this-nested-for-loop-in-language-c/50957266#50957266", "title": "Why is scanf() being skipped over in this nested for loop in language C?", "body": "<p>You just have a stray semicolon.  Try changing</p>\n\n<pre><code>for (col = 0; col &lt; M; col++); \n{\n</code></pre>\n\n<p>to:</p>\n\n<pre><code>for (col = 0; col &lt; M; col++)\n{\n</code></pre>\n\n<p>A <code>for</code> introduces a statement which controls the very next statement, which could be a simple statement ending with a semicolon, another control statement, or a compound statement using <code>{</code> braces <code>}</code>.  In your code, the semicolon on the same line as the <code>for</code> keyword counts as an empty statement that has no effect.  So that code will just increment the loop variable the appropriate number of times, and only after that move on to the next part.</p>\n\n<p>Make sure you enable compiler warnings.  (Both gcc and clang provide clear warnings that this code might not do what you meant.)</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 9957943, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-8QanBgtC1Lg/AAAAAAAAAAI/AAAAAAAAAAc/yNQRjtmcw68/photo.jpg?sz=128", "display_name": "cody benedict", "link": "https://stackoverflow.com/users/9957943/cody-benedict"}, "is_accepted": false, "score": 0, "last_activity_date": 1529530337, "creation_date": 1529530337, "answer_id": 50957339, "question_id": 50957131, "link": "https://stackoverflow.com/questions/50957131/why-is-scanf-being-skipped-over-in-this-nested-for-loop-in-language-c/50957339#50957339", "title": "Why is scanf() being skipped over in this nested for loop in language C?", "body": "<pre><code>for (col = 0; col &lt; M; col++);\n</code></pre>\n\n<p>This is what you wrote inside the nest for loop. But the \";\" simply means the end of code line and it will just run the for loop M times without doing anything.</p>\n\n<p>Change it to</p>\n\n<pre><code>for (col = 0; col &lt; M; col++)\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 9969809, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JsjuY.jpg?s=128&g=1", "display_name": "GoldMonkeyTMM", "link": "https://stackoverflow.com/users/9969809/goldmonkeytmm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "accepted_answer_id": 50957266, "answer_count": 2, "score": 2, "last_activity_date": 1529530337, "creation_date": 1529529314, "last_edit_date": 1529529971, "question_id": 50957131, "link": "https://stackoverflow.com/questions/50957131/why-is-scanf-being-skipped-over-in-this-nested-for-loop-in-language-c", "title": "Why is scanf() being skipped over in this nested for loop in language C?", "body": "<p>I am writing a program for class that asks users to enter a the size of a 2D array and then has the user enter the values for the array. This is the code I have so far: </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void)\n{\n    // Setup \n    int N, M;\n    int row = 0, col = 0;\n\n    printf(\"\\n\");\n    printf(\"This program counts occurences of digits 0 through 9 in an NxM array.\\n\");\n    printf(\"Enter the size of the array (Row Column): \");\n    scanf(\" %d %d\", &amp;N, &amp;M);\n\n    int array[N][M];     \n\n    // Array Input\n    for (row = 0; row &lt; N; row++)\n    {    \n        printf(\"Enter row %d: \", row);      \n        for (col = 0; col &lt; M; col++); \n        {    \n            scanf(\" %d\", &amp;array[row][col]);\n        }   \n    }    \n    printf(\"\\n\");    \n    return 0;\n}\n</code></pre>\n\n<p>The issue that I am having when the program is compiled and the information is entered, the second and all following scanf() statements are skipped over or the whole second for loop is skipped over after the first line is entered. Here is an example of entered input: </p>\n\n<pre><code>This program counts occurences of digits 0 through 9 in an NxM array.\nEnter the size of the array (Row Column): 2 6\nEnter row 0: 0 1 2 3 4 5\nEnter row 1:\n</code></pre>\n\n<p>And then the program ends entirely. I really have no idea why its being skipped over. I have tried altering how many spaces are in the scanf() statement but no matter what I change the same issue occurs. I am unsure if I am missing some stupid mistake I have made or if there is a bigger problem. I am pretty new at coding.  </p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 1, "creation_date": 1529529618, "post_id": 50957104, "comment_id": 88911767, "body": "That is terrible code, and it&#39;s assuming <code>int</code> is the same size as a function pointer."}, {"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 1, "creation_date": 1529530273, "post_id": 50957104, "comment_id": 88912050, "body": "The h function returns function pointer, the extra () are because of that. It also crashes at ideone... And no wonder, the return value doesn&#39;t look like an address of function to me (but that is rather obfuscated code so...)."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1529530299, "post_id": 50957104, "comment_id": 88912066, "body": "On my computer and on... uh, I dunno... about one billion perhaps? at any rate, on many other computers on this planet, the meaning of this program is &quot;Segmentation fault&quot;."}, {"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 0, "creation_date": 1529530766, "post_id": 50957104, "comment_id": 88912240, "body": "It actually works on (almost all) 32 bit systems as is, I think. To make it work on (almost) any system, use intptr_t instead of int. Not 100% sure if there even is undefind behavior here then... Quite nice obfuscated code, I hope someone takes time to write an actual answer. This also demonstrates how C is a loaded gun, firmly strapped on your leg pointing at your foot."}, {"owner": {"reputation": 794, "user_id": 1328157, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LwvtP.jpg?s=128&g=1", "display_name": "nachiketkulk", "link": "https://stackoverflow.com/users/1328157/nachiketkulk"}, "edited": false, "score": 1, "creation_date": 1529531388, "post_id": 50957104, "comment_id": 88912485, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/1448849/how-do-i-understand-complicated-function-declarations\">How do I understand complicated function declarations?</a>"}, {"owner": {"reputation": 4376, "user_id": 2850543, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2bb15c1da6de8180d9adc99954f167f7?s=128&d=identicon&r=PG&f=1", "display_name": "Millie Smith", "link": "https://stackoverflow.com/users/2850543/millie-smith"}, "edited": false, "score": 0, "creation_date": 1529531729, "post_id": 50957104, "comment_id": 88912604, "body": "When pf1() and pf2() are equal, it returns null."}, {"owner": {"reputation": 217, "user_id": 4250401, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6Qdmf.png?s=128&g=1", "display_name": "esoterik", "link": "https://stackoverflow.com/users/4250401/esoterik"}, "reply_to_user": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 0, "creation_date": 1529532787, "post_id": 50957104, "comment_id": 88912973, "body": "@hyde your assuming that code like this is normal and necessary; yes guns are dangerous more so when you use them recklessly."}, {"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "reply_to_user": {"reputation": 217, "user_id": 4250401, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6Qdmf.png?s=128&g=1", "display_name": "esoterik", "link": "https://stackoverflow.com/users/4250401/esoterik"}, "edited": false, "score": 0, "creation_date": 1529555615, "post_id": 50957104, "comment_id": 88917675, "body": "@esoterik No I am not assuming that, you misread my meaning. Code like this should be burned with real fire from any &quot;real&quot; project, and perpetrator flogged. But writing or deciphering it for understanding can be fun."}], "answers": [{"comments": [{"owner": {"reputation": 100407, "user_id": 16406, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fadf252892475e9b177d5cd5e8b24145?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Dodd", "link": "https://stackoverflow.com/users/16406/chris-dodd"}, "edited": false, "score": 1, "creation_date": 1529531957, "post_id": 50957545, "comment_id": 88912674, "body": "<code>h</code> is not a pointer to a function, its a function that returns a pointer to a function..."}, {"owner": {"reputation": 11310, "user_id": 1067943, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/93c13b4e7dc0e35c60f09d3abca0f601?s=128&d=identicon&r=PG", "display_name": "Michael", "link": "https://stackoverflow.com/users/1067943/michael"}, "edited": false, "score": 0, "creation_date": 1529594698, "post_id": 50957545, "comment_id": 88940793, "body": "Thanks for post it really helped me. But there is one thing that I cant understand is why &#39;h&#39; returns pointer to a function?Isn&#39;t it a pointer to the function?"}, {"owner": {"reputation": 76, "user_id": 9217314, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/517f65593122f710486e44ed8aac8dc9?s=128&d=identicon&r=PG&f=1", "display_name": "Jagawag", "link": "https://stackoverflow.com/users/9217314/jagawag"}, "reply_to_user": {"reputation": 11310, "user_id": 1067943, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/93c13b4e7dc0e35c60f09d3abca0f601?s=128&d=identicon&r=PG", "display_name": "Michael", "link": "https://stackoverflow.com/users/1067943/michael"}, "edited": false, "score": 1, "creation_date": 1529602549, "post_id": 50957545, "comment_id": 88945231, "body": "Hi @Michael, I added to the answer to provide clarification, and a working example you can play with. <code>h</code> is a function, and it is defined to return a pointer b/c it has <code>*</code> in front of the <code>h</code>. The pointer that <code>h</code> returns must also be a pointer to a void function because we have empty parentheses<code>( )</code> at the end of the function signature."}], "tags": [], "owner": {"reputation": 76, "user_id": 9217314, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/517f65593122f710486e44ed8aac8dc9?s=128&d=identicon&r=PG&f=1", "display_name": "Jagawag", "link": "https://stackoverflow.com/users/9217314/jagawag"}, "is_accepted": true, "score": 4, "last_activity_date": 1529602027, "last_edit_date": 1529602027, "creation_date": 1529531247, "answer_id": 50957545, "question_id": 50957104, "link": "https://stackoverflow.com/questions/50957104/i-have-c-language-syntax-troubels/50957545#50957545", "title": "I have c language syntax troubels", "body": "<p>Function pointers can be tricky to read. I start by reading the inner-most parenthesis, and work my way to the outer-most parenthesis.</p>\n\n<p>Here's a breakdown of that declaration:</p>\n\n<p><code>int (*h(int (*pf1)(), int (*pf2)()))()</code></p>\n\n<p><code>(*pf1)()</code> and <code>(*pf2)()</code> are pointers to functions that accept no parameters (i.e. ()), and both of them return an <code>int</code>.</p>\n\n<p><code>*h(int (*pf1)() , int (*pf2)())</code> is a function that accepts two function pointers that return<code>int</code> s.  So, h returns a pointer to a function that accepts nothing and returns an <code>int</code> </p>\n\n<p>Here is a link to some examples of the syntax, and a more elaborate breakdown:\n<a href=\"https://www.cprogramming.com/tutorial/function-pointers.html\" rel=\"nofollow noreferrer\">https://www.cprogramming.com/tutorial/function-pointers.html</a></p>\n\n<hr>\n\n<p>Added:</p>\n\n<p>Since the original code that was provided segfaults, I wrote two different implementations that compare two integers and return the bigger one.</p>\n\n<p>First, look at <code>j</code>. It's just a regular function that accepts two parameters that happen to be function pointers. Those function pointers are then used within the function. And because we said <code>j</code> returns an <code>int</code>, we return the actual integer by calling <code>pf1()</code> or <code>pf2()</code> with <code>()</code>.</p>\n\n<p>Now look at <code>h</code>. In this scenario, <code>h</code> is going to return a pointer <code>*</code>. So we still call the function pointers <code>pf1()</code> and <code>pf2()</code> in <code>h</code>, but when we return, we DO NOT use <code>()</code> because we want to return the whole function pointer (either <code>pf1</code> or <code>pf2</code>).</p>\n\n<p>Lastly, look at main and see the difference between how <code>j</code> and <code>h</code> are used. Again, <code>j</code> is just a regular function. However, <code>h</code> uses the this syntax: h(f,g)() because <code>h</code> returns a pointer to a function which we then want to call using <code>()</code> to get the actual integer result for printing.</p>\n\n<p>Hope this helps provide a little more clarity with a working example! Good luck!</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint  f(){return 1;}\nint  g(){return 2;}\n\nint j(int (*pf1)(), int (*pf2)())\n{\n    return ((pf1() &gt; pf2() ? pf1() : pf2()));\n}\n\nint (*    h( int(*pf1)() , int(*pf2)() )   ) () \n{\n    return (pf1() &gt; pf2() ? pf1 : pf2);\n}\n\n\nint main()\n{\n    int res1 = j(f,g);\n\n    int res2 = h(f,g)();\n\n    //print values returned by calling f and g.\n    printf(\"f: %d \\ng: %d\\n\", f(),g());\n\n    //print result of calling j(f,g)\n    printf(\"res1: %d\\n\", res1);\n\n    //print result of calling h(f,g)()\n    printf(\"res2: %d\\n\", res2);\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "is_accepted": false, "score": 2, "last_activity_date": 1529532742, "creation_date": 1529532742, "answer_id": 50957794, "question_id": 50957104, "link": "https://stackoverflow.com/questions/50957104/i-have-c-language-syntax-troubels/50957794#50957794", "title": "I have c language syntax troubels", "body": "<p><code>main</code> calls the function returned by <code>h</code> and returns that result.  <code>h</code> compares the output of <code>f</code> and <code>g</code> and returns the function which returns the larger value (else it returns 0).  Since the output of <code>g</code> is greater than <code>f</code>, <code>h</code> returns <code>g</code>.  Hence <code>main</code> returns 2.</p>\n"}], "owner": {"reputation": 11310, "user_id": 1067943, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/93c13b4e7dc0e35c60f09d3abca0f601?s=128&d=identicon&r=PG", "display_name": "Michael", "link": "https://stackoverflow.com/users/1067943/michael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 114, "favorite_count": 1, "accepted_answer_id": 50957545, "answer_count": 2, "score": 0, "last_activity_date": 1529602027, "creation_date": 1529529178, "question_id": 50957104, "link": "https://stackoverflow.com/questions/50957104/i-have-c-language-syntax-troubels", "title": "I have c language syntax troubels", "body": "<p>I work on my tutorial in C language.</p>\n\n<p>I have a small pice of code that I need to deciph.</p>\n\n<p>Here is the code:</p>\n\n<pre><code>int  f(){return 1;}\nint  g(){return 2;}\nint (*h(int (*pf1)(), int (*pf2)()))(){\n  return (int (*) ())((pf1() &gt; pf2())*(int)pf1 + (pf2()&gt;pf1())*(int)pf2);\n}\nvoid main(){\n    int res = h(f,g)();\n}\n</code></pre>\n\n<p>I have problem to unndestand this syntex:</p>\n\n<pre><code>int (*h(int (*pf1)(), int (*pf2)()))()\n</code></pre>\n\n<p>I can't understand what is the meaning of this outter parentheses ->(*h(int (*pf1)(), int (*pf2)()))  </p>\n\n<p>and this parentheses() at the end of the function's signature.</p>\n\n<p>Also what is '*h' inside parentheses? I understand that it get two functions and trigger it.</p>\n\n<p>Can I get brif explanation on questions above?</p>\n"}, {"tags": ["c", "microchip", "mplab", "pic32"], "comments": [{"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1529529304, "post_id": 50957089, "comment_id": 88911648, "body": "Consider where the code is running"}, {"owner": {"reputation": 58, "user_id": 4043118, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10ebfefdfa7e9158170f2dc1d49b7cee?s=128&d=identicon&r=PG&f=1", "display_name": "Firestarter without a lighter", "link": "https://stackoverflow.com/users/4043118/firestarter-without-a-lighter"}, "reply_to_user": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1529529426, "post_id": 50957089, "comment_id": 88911690, "body": "I am expecting to see it in the output window, but there is nothing there... Do I have to use the simulator if I want to print just a simple text to help me debbug?"}], "answers": [{"tags": [], "owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "is_accepted": false, "score": 0, "last_activity_date": 1529531279, "creation_date": 1529531279, "answer_id": 50957554, "question_id": 50957089, "link": "https://stackoverflow.com/questions/50957089/cant-see-printf-in-mplabx-ide-anywhere-why/50957554#50957554", "title": "Cant see printf in mplabX IDE anywhere... Why?", "body": "<p>Why?<br>\nBecause mplabX IDE doesn't have access to your hardware. I guess you use debugging (you haven't written), then your debugging (unit? hardware? software?) might not support it.  </p>\n\n<p>Where I can find the printed result?<br>\nThat depends on how you have written your _mon_putc() function. <code>By default, MPLAB\u00ae XC32's libraries use UART2 for STDOUT.</code> For example for <a href=\"http://ww1.microchip.com/downloads/en/DeviceDoc/70005282B.pdf\" rel=\"nofollow noreferrer\">PIC32MZ EF CURIOSITY DEVELOPMENT BOARD</a> UART2 (signal U2TX) would be on pin 7 on MCU, that would be pin 4 on J11 or pin 13 on J10 or pin 5 on connector J14. The best would be to buy a cheap UART&lt;->USB converter to read from that uart.</p>\n\n<p>Any info?<br>\nSure.<br>\n<a href=\"http://microchipdeveloper.com/faq:81\" rel=\"nofollow noreferrer\">(XC32) How do I instruct printf to output to UART1 or other UART channels instead of UART2?</a><br>\n<a href=\"http://www.microchip.com/forums/m1037661.aspx\" rel=\"nofollow noreferrer\">Debugging: Can I redirect printf or putchar to the MPLAB X console?</a><br>\n<a href=\"https://gist.github.com/raivisr/5007565\" rel=\"nofollow noreferrer\">stdio over uart1 example</a><br>\nThe mplab simulator uses uart1 as stdout and the simulator connects a simulated \"reader\" to that uart which shows it's output on mplab console. The uart on your real hardware, I guess, isn't anyhow connected to the computer.</p>\n"}, {"comments": [{"owner": {"reputation": 58, "user_id": 4043118, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10ebfefdfa7e9158170f2dc1d49b7cee?s=128&d=identicon&r=PG&f=1", "display_name": "Firestarter without a lighter", "link": "https://stackoverflow.com/users/4043118/firestarter-without-a-lighter"}, "edited": false, "score": 0, "creation_date": 1529592706, "post_id": 50961226, "comment_id": 88939514, "body": "I thought it was possible to use the output window without the Simulator... We all learn from our dumb mistakes."}], "tags": [], "owner": {"reputation": 3478, "user_id": 9061264, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TPing.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/9061264/mike"}, "is_accepted": true, "score": 2, "last_activity_date": 1529560289, "creation_date": 1529560289, "answer_id": 50961226, "question_id": 50957089, "link": "https://stackoverflow.com/questions/50957089/cant-see-printf-in-mplabx-ide-anywhere-why/50961226#50961226", "title": "Cant see printf in mplabX IDE anywhere... Why?", "body": "<p><code>printf</code> always uses the UART as STDOUT. \nIf you use the simulator you could enable UART IO under Project Properties. Know it's your choice if you like to see your printed data in a file or in an output window. </p>\n"}], "owner": {"reputation": 58, "user_id": 4043118, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10ebfefdfa7e9158170f2dc1d49b7cee?s=128&d=identicon&r=PG&f=1", "display_name": "Firestarter without a lighter", "link": "https://stackoverflow.com/users/4043118/firestarter-without-a-lighter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4445, "favorite_count": 0, "accepted_answer_id": 50961226, "answer_count": 2, "score": 2, "last_activity_date": 1529560289, "creation_date": 1529529115, "question_id": 50957089, "link": "https://stackoverflow.com/questions/50957089/cant-see-printf-in-mplabx-ide-anywhere-why", "title": "Cant see printf in mplabX IDE anywhere... Why?", "body": "<p>I tried this in a function, but I dont see anywhere the result in MPLAB X IDE. Why? Where I can find the printed result? I am using pic32 Curiosity development board and XC32.</p>\n\n<pre><code>int a = 5;\nint b = 10;\nprintf(\"a = %d\\nb = %d\\n\", a, b);\n</code></pre>\n\n<p>Any info? Thanks in advance!</p>\n"}, {"tags": ["c", "pointers", "segmentation-fault", "printf"], "comments": [{"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 3, "creation_date": 1529528686, "post_id": 50956990, "comment_id": 88911422, "body": "<code>a</code> does not point to any allocated buffer"}], "answers": [{"comments": [{"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 1, "creation_date": 1529530574, "post_id": 50957366, "comment_id": 88912155, "body": "It is preferred not to cast the results of <code>malloc</code> in C."}], "tags": [], "owner": {"reputation": 671, "user_id": 9796205, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/83X8u.jpg?s=128&g=1", "display_name": "Francesco Re", "link": "https://stackoverflow.com/users/9796205/francesco-re"}, "is_accepted": false, "score": 0, "last_activity_date": 1529530447, "creation_date": 1529530447, "answer_id": 50957366, "question_id": 50956990, "link": "https://stackoverflow.com/questions/50956990/segmentation-fault-in-a-very-small-c-program-for-accepting-and-printing-a-string/50957366#50957366", "title": "Segmentation fault in a very small c program for accepting and printing a string", "body": "<p>You have to initialize the variable <code>a</code> using either a malloc or declaring it as an array:</p>\n\n<pre><code>char a[20];\n\nchar * a = (char *) malloc(20);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 449, "user_id": 9897919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4315a79d0d04da3596dfa08d8d9d8f24?s=128&d=identicon&r=PG&f=1", "display_name": "Aniket", "link": "https://stackoverflow.com/users/9897919/aniket"}, "is_accepted": true, "score": 2, "last_activity_date": 1529539624, "creation_date": 1529539624, "answer_id": 50958660, "question_id": 50956990, "link": "https://stackoverflow.com/questions/50956990/segmentation-fault-in-a-very-small-c-program-for-accepting-and-printing-a-string/50958660#50958660", "title": "Segmentation fault in a very small c program for accepting and printing a string", "body": "<p>There are two ways of doing it. One is storing the input as a <code>char *</code> the other is storing it into an array.</p>\n\n<p><strong>How to do it as a char *</strong></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main(void) {\n    char *a = malloc(sizeof(char) * 20); // You can change 20 to the number of letters you need\n\n    printf(\"Enter name: \");\n    scanf(\"%s\", a);\n    printf(\"%s\\n\", a);\n\n    free(a); // Don't forget to free. If you malloc memory, you must free it\n    return 0;\n}\n</code></pre>\n\n<hr>\n\n<p><strong>How to do it as an array</strong></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n#define ARRAY_SIZE      20 // You can change 20 to the number of letters you need\n\nint main(void) {\n\n    char a[ARRAY_SIZE];\n\n    printf(\"Enter name: \");\n    fgets(a, ARRAY_SIZE, stdin); // Scanning in the letters into the array\n    printf(\"%s\", a);\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user7015283"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 50958660, "answer_count": 2, "score": 2, "last_activity_date": 1529539624, "creation_date": 1529528628, "last_edit_date": 1529532252, "question_id": 50956990, "link": "https://stackoverflow.com/questions/50956990/segmentation-fault-in-a-very-small-c-program-for-accepting-and-printing-a-string", "title": "Segmentation fault in a very small c program for accepting and printing a string", "body": "<p>Why do I get Segmentation error during execution of printf() ? </p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint main()\n{\n    char* a ;\n    printf(\"Enter name: \");\n    scanf(\"%s\",a);\n    printf(\"%s\\n\",a);\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 1, "creation_date": 1529527393, "post_id": 50956709, "comment_id": 88910859, "body": "I&#39;m gonna guess <code>*dosHeader-&gt;e_lfanew</code> --&gt; <code>dosHeader-&gt;e_lfanew</code>"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1529527412, "post_id": 50956709, "comment_id": 88910869, "body": "Please show the definition of <code>PIMAGE_DOS_HEADER</code>."}, {"owner": {"reputation": 33, "user_id": 7873298, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1013dce1a4d3cba5b6f67a041c062b3b?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Cullins", "link": "https://stackoverflow.com/users/7873298/richard-cullins"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1529529287, "post_id": 50956709, "comment_id": 88911644, "body": "Added it  @WeatherVane"}, {"owner": {"reputation": 33, "user_id": 7873298, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1013dce1a4d3cba5b6f67a041c062b3b?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Cullins", "link": "https://stackoverflow.com/users/7873298/richard-cullins"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1529529694, "post_id": 50956709, "comment_id": 88911807, "body": "@M.M Unfortunately that did not fix it."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1529529922, "post_id": 50956709, "comment_id": 88911909, "body": "Oops, I mean <code>(*dosHeader)-&gt;e_lfanew</code>"}, {"owner": {"reputation": 33, "user_id": 7873298, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1013dce1a4d3cba5b6f67a041c062b3b?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Cullins", "link": "https://stackoverflow.com/users/7873298/richard-cullins"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1529530086, "post_id": 50956709, "comment_id": 88911968, "body": "@M.M That solved it! Not sure WHY exactly, I&#39;m assuming order of operations?"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1529530162, "post_id": 50956709, "comment_id": 88912009, "body": "<code>dosHeader</code> is pointer to a pointer so you need to dereference it twice to get the structure"}, {"owner": {"reputation": 33, "user_id": 7873298, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1013dce1a4d3cba5b6f67a041c062b3b?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Cullins", "link": "https://stackoverflow.com/users/7873298/richard-cullins"}, "edited": false, "score": 0, "creation_date": 1529530370, "post_id": 50956709, "comment_id": 88912097, "body": "Ah I saw, but all I was missing were those parenthesis around dosHeader. That&#39;s why I was wondering if it was an order of operations issue."}], "owner": {"reputation": 33, "user_id": 7873298, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1013dce1a4d3cba5b6f67a041c062b3b?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Cullins", "link": "https://stackoverflow.com/users/7873298/richard-cullins"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1041, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1529529911, "creation_date": 1529527254, "last_edit_date": 1529529911, "question_id": 50956709, "link": "https://stackoverflow.com/questions/50956709/expression-must-have-pointer-to-struct-or-union-type", "title": "Expression Must Have Pointer-To-Struct-Or-Union Type", "body": "<p>I am passing dosHeader as a reference to the Test method, which should print out the ntHeader's signature. However, I am getting a compiler error under <code>*dosHeader-&gt;e_lfanew</code> - \"expression must have pointer-to-struct-or-union type\". I've tried casting it to (PIMAGE_DOS_HEADER*), which does remove the compiler error but doesn't work. What am I misunderstanding?</p>\n\n<pre><code>PIMAGE_NT_HEADERS ntHeader;    \n\nTest(PIMAGE_DOS_HEADER *dosHeader)\n{\n    *dosHeader = (PIMAGE_DOS_HEADER)PEBytes;\n    ntHeader = (PIMAGE_NT_HEADERS)((LONG)*dosHeader + *dosHeader-&gt;e_lfanew);\n    printf(\"%d\", ntHeader-&gt;Signature);\n}\n\nvoid main()\n{\n    PIMAGE_DOS_HEADER dosHeader = 0;\n    Test(&amp;dosHeader);\n}\n</code></pre>\n\n<p>Here is the structure definition</p>\n\n<pre><code>typedef struct _IMAGE_DOS_HEADER {      // DOS .EXE header\n    WORD   e_magic;                     // Magic number\n    WORD   e_cblp;                      // Bytes on last page of file\n    WORD   e_cp;                        // Pages in file\n    WORD   e_crlc;                      // Relocations\n    WORD   e_cparhdr;                   // Size of header in paragraphs\n    WORD   e_minalloc;                  // Minimum extra paragraphs needed\n    WORD   e_maxalloc;                  // Maximum extra paragraphs needed\n    WORD   e_ss;                        // Initial (relative) SS value\n    WORD   e_sp;                        // Initial SP value\n    WORD   e_csum;                      // Checksum\n    WORD   e_ip;                        // Initial IP value\n    WORD   e_cs;                        // Initial (relative) CS value\n    WORD   e_lfarlc;                    // File address of relocation table\n    WORD   e_ovno;                      // Overlay number\n    WORD   e_res[4];                    // Reserved words\n    WORD   e_oemid;                     // OEM identifier (for e_oeminfo)\n    WORD   e_oeminfo;                   // OEM information; e_oemid specific\n    WORD   e_res2[10];                  // Reserved words\n    LONG   e_lfanew;                    // File address of new exe header\n  } IMAGE_DOS_HEADER, *PIMAGE_DOS_HEADER;\n</code></pre>\n"}, {"tags": ["c", "mpi"], "comments": [{"owner": {"reputation": 7287, "user_id": 8062491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rd6rD.png?s=128&g=1", "display_name": "Gilles Gouaillardet", "link": "https://stackoverflow.com/users/8062491/gilles-gouaillardet"}, "edited": false, "score": 0, "creation_date": 1529532197, "post_id": 50956288, "comment_id": 88912767, "body": "Generally speaking, you should use <code>offsetof()</code> to populate the displacements array (since the compiler might add some padding here and there)"}], "answers": [{"comments": [{"owner": {"reputation": 122, "user_id": 7361495, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ab0cb53129ef14bc733c87da865222a?s=128&d=identicon&r=PG&f=1", "display_name": "WhoAmIWhereAmIWhatIAmDoing", "link": "https://stackoverflow.com/users/7361495/whoamiwhereamiwhatiamdoing"}, "edited": false, "score": 0, "creation_date": 1529543572, "post_id": 50957356, "comment_id": 88915280, "body": "so the &quot;count&quot; is not the number of ctype but the number of entries?"}, {"owner": {"reputation": 339, "user_id": 8853057, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a19bb824882c7c6fe2099af173a61085?s=128&d=identicon&r=PG&f=1", "display_name": "supercheval", "link": "https://stackoverflow.com/users/8853057/supercheval"}, "reply_to_user": {"reputation": 122, "user_id": 7361495, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ab0cb53129ef14bc733c87da865222a?s=128&d=identicon&r=PG&f=1", "display_name": "WhoAmIWhereAmIWhatIAmDoing", "link": "https://stackoverflow.com/users/7361495/whoamiwhereamiwhatiamdoing"}, "edited": false, "score": 0, "creation_date": 1529584346, "post_id": 50957356, "comment_id": 88933628, "body": "you have 3 variables in ctype corresponding to the 3 variables of your structure. If your structure was made of n variables, you would use count=n. I hope it helps!"}], "tags": [], "owner": {"reputation": 339, "user_id": 8853057, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a19bb824882c7c6fe2099af173a61085?s=128&d=identicon&r=PG&f=1", "display_name": "supercheval", "link": "https://stackoverflow.com/users/8853057/supercheval"}, "is_accepted": true, "score": 1, "last_activity_date": 1529530412, "creation_date": 1529530412, "answer_id": 50957356, "question_id": 50956288, "link": "https://stackoverflow.com/questions/50956288/mpi-datatype-alignment/50957356#50957356", "title": "MPI datatype alignment", "body": "<p>You should put the number of element in the structure in your MPI_Type_create_struct, 3 instead of 1.</p>\n\n<pre><code>MPI_Type_create_struct(3, blocklen, disp, ctype, &amp;type);\n</code></pre>\n\n<p>I tested it and I got:</p>\n\n<pre><code>5.000000 1.00 h\n5.000000 1.00 h\n</code></pre>\n\n<p>Some info here:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/33618937/trouble-understanding-mpi-type-create-struct\">Trouble Understanding MPI_Type_create_struct</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/9864510/struct-serialization-in-c-and-transfer-over-mpi\">struct serialization in C and transfer over MPI</a></p>\n"}], "owner": {"reputation": 122, "user_id": 7361495, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ab0cb53129ef14bc733c87da865222a?s=128&d=identicon&r=PG&f=1", "display_name": "WhoAmIWhereAmIWhatIAmDoing", "link": "https://stackoverflow.com/users/7361495/whoamiwhereamiwhatiamdoing"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "accepted_answer_id": 50957356, "answer_count": 1, "score": 1, "last_activity_date": 1529530412, "creation_date": 1529525356, "last_edit_date": 1529525775, "question_id": 50956288, "link": "https://stackoverflow.com/questions/50956288/mpi-datatype-alignment", "title": "MPI datatype alignment", "body": "<p>I'm working on a sample coding but just couldn't get send and receive the same value. </p>\n\n<p>the datatype i create is<br></p>\n\n<pre><code>typedef struct customData{\n    double iv;\n    double dv[5];\n    char cv[10];\n} customData;\n</code></pre>\n\n<p><br></p>\n\n<p>I create datatype here<br></p>\n\n<pre><code>MPI_Datatype type;\nMPI_Datatype ctype[3] = {MPI_DOUBLE, MPI_DOUBLE, MPI_CHAR};\nint blocklen[3] = {1, 5, 10};\nMPI_Aint disp[3] = { 0, sizeof(double), sizeof(double)*6 };\n\nMPI_Type_create_struct(1, blocklen, disp, ctype, &amp;type);\nMPI_Type_commit(&amp;type);\n</code></pre>\n\n<p><br></p>\n\n<p>send and receive<br></p>\n\n<pre><code>if(rank == 0){\n    customData data = {5, \n            {1,2,3,4,5}, \n            {'h','d','h','a','q','w','e','s','l','z'}};\n    printf(\"%f %.2f %c\\n\", data.iv, data.dv[0], data.cv[0]);\n\n    MPI_Send(&amp;data, 1, type, 1, 0, MPI_COMM_WORLD);     \n} else {\n    customData recv;\n    MPI_Status status;\n    MPI_Recv(&amp;recv, 1, type, 0, 0, MPI_COMM_WORLD, &amp;status);\n    printf(\"%f %.2f %c\\n\", recv.iv, recv.dv[0], recv.cv[0]);\n}\n</code></pre>\n\n<p>The output is<br> \n5.000000 1.00 h<br>\n5.000000 0.00 \ufffd</p>\n"}, {"tags": ["c", "assembly", "x86", "framebuffer"], "comments": [{"owner": {"reputation": 33092, "user_id": 5801661, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D8ENZ.jpg?s=128&g=1", "display_name": "Margaret Bloom", "link": "https://stackoverflow.com/users/5801661/margaret-bloom"}, "edited": false, "score": 1, "creation_date": 1529525791, "post_id": 50955961, "comment_id": 88910191, "body": "scale <code>i</code> in <code>fb_write_cell</code> (e.g. <code>i*2</code> and <code>i*2+1</code>) or call it with even values. Depending on the exact semantics of the argument <code>i</code>"}, {"owner": {"reputation": 111, "user_id": 7941690, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d6084928f25ad35feb567636cff33aa3?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/7941690/michael"}, "reply_to_user": {"reputation": 33092, "user_id": 5801661, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D8ENZ.jpg?s=128&g=1", "display_name": "Margaret Bloom", "link": "https://stackoverflow.com/users/5801661/margaret-bloom"}, "edited": false, "score": 0, "creation_date": 1529526380, "post_id": 50955961, "comment_id": 88910455, "body": "That worked, and now that I think of it, it makes perfect sense"}], "answers": [{"tags": [], "owner": {"reputation": 111, "user_id": 7941690, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d6084928f25ad35feb567636cff33aa3?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/7941690/michael"}, "is_accepted": true, "score": 2, "last_activity_date": 1529526436, "creation_date": 1529526436, "answer_id": 50956534, "question_id": 50955961, "link": "https://stackoverflow.com/questions/50955961/writing-incorrect-characters-to-framebuffer/50956534#50956534", "title": "Writing incorrect characters to framebuffer", "body": "<p>@Margaret Bloom's comment solved my issue. The issue was that a character is 16 bits, and I needed to increment I by 2, but I was increment it by 1, causing it to overlap like this:</p>\n\n<p>Intended: char1Data char1Color char2Data char2Color</p>\n\n<p>Problem:  char1Data char2Data char2Color</p>\n"}], "owner": {"reputation": 111, "user_id": 7941690, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d6084928f25ad35feb567636cff33aa3?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/7941690/michael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "accepted_answer_id": 50956534, "answer_count": 1, "score": 0, "last_activity_date": 1529526436, "creation_date": 1529523947, "question_id": 50955961, "link": "https://stackoverflow.com/questions/50955961/writing-incorrect-characters-to-framebuffer", "title": "Writing incorrect characters to framebuffer", "body": "<p>I have been following a tutorial called <a href=\"https://littleosbook.github.io/\" rel=\"nofollow noreferrer\">\"The little book about OS development\"</a>. I can write individual characters to the framebuffer, but not the next character. Here are the files:</p>\n\n<h1>kmain.c</h1>\n\n<pre><code>#include \"io.h\"\n\n#define FB_BLACK 0\n#define FB_BLUE 1\n#define FB_GREEN 2\n#define FB_CYAN 3\n#define FB_RED 4\n#define FB_MAGENTA 5\n#define FB_BROWN 6\n#define FB_LIGHTGREY 7\n#define FB_DARKGREY 8\n#define FB_LIGHTBLUE 9\n#define FB_LIGHTGREEN 10\n#define FB_LIGHTCYAN 11\n#define FB_LIGHTRED 12\n#define FB_LIGHTMAGENTA 13\n#define FB_LIGHTBROWN 14\n#define FB_WHITE 15\n\n#define FB_COMMAND_PORT 0x3D4\n#define FB_DATA_PORT 0x3D5\n#define FB_HIGH_BYTE_COMMAND 14\n#define FB_LOW_BYTE_COMMAND 15\nchar *fb = (char*)0x000B8000;\n\nvoid fb_move_cursor(unsigned short pos) {\n    outb(FB_COMMAND_PORT, FB_HIGH_BYTE_COMMAND);\n    outb(FB_DATA_PORT, ((pos &gt;&gt; 8) &amp; 0x00FF));\n    outb(FB_COMMAND_PORT, FB_LOW_BYTE_COMMAND);\n    outb(FB_DATA_PORT, pos &amp; 0x00FF);\n}\n\nvoid fb_write_cell(unsigned int i, char c, unsigned char fg, unsigned char bg)\n{\n    fb[i] = c;\n    fb[i + 1] = ((fg &amp; 0x0F) &lt;&lt; 4) | (bg &amp; 0x0F);\n}\n\n\nvoid kmain(void) {\n    fb_write_cell(0, 'H', FB_WHITE, FB_BLACK);\n    fb_move_cursor(2);\n    fb_write_cell(1, 'i', FB_WHITE, FB_BLACK);\n}\n</code></pre>\n\n<h1>io.h</h1>\n\n<pre><code>#ifndef INCLUDE_IOH\n#define INCLUDE_IOH\n\n\nvoid outb(unsigned short port, unsigned char data);\n\n\n#endif\n</code></pre>\n\n<h1>io.s</h1>\n\n<pre><code>global outb\nglobal hang\n;Sends a byte to an io port\n; [esp + 8] data byte\n; [esp + 4] the io port\n\noutb:\n    mov al, [esp + 8]\n    mov dx, [esp + 4]\n    out dx, al\n    ret\nhang:\n    jmp hang; so that program can hang\n</code></pre>\n\n<h1>loader.s</h1>\n\n<pre><code>global loader\n\nMAGIC_NUMBER equ 0x1BADB002    ;Multiboot constant\nFLAGS        equ 0x0           ;Multiboot flags\nCHKSUM       equ -MAGIC_NUMBER   ;Multiboot checksum. Valid if CHKSUM + FLAGS + MAGIC_NUMBER == 0 \n\n\nKERNEL_STACK_SIZE equ 4096\nsection .bss\nalign 4\nkernel_stack:\n    resb KERNEL_STACK_SIZE\n\nsection .text\nalign 4\n    dd MAGIC_NUMBER\n    dd FLAGS\n    dd CHKSUM\n\nloader:\n    mov esp,kernel_stack+KERNEL_STACK_SIZE\n    extern kmain\n    call kmain\nhang:\n    jmp hang\n</code></pre>\n\n<h1>link.ld</h1>\n\n<pre><code>ENTRY(loader)                /* the name of the entry label */\n\nSECTIONS {\n    . = 0x00100000;          /* the code should be loaded at 1 MB */\n\n    .text ALIGN (0x1000) :   /* align at 4 KB */\n    {\n        *(.text)             /* all text sections from all files */\n    }\n\n    .rodata ALIGN (0x1000) : /* align at 4 KB */\n    {\n        *(.rodata*)          /* all read-only data sections from all files */\n    }\n\n    .data ALIGN (0x1000) :   /* align at 4 KB */\n    {\n        *(.data)             /* all data sections from all files */\n    }\n\n    .bss ALIGN (0x1000) :    /* align at 4 KB */\n    {\n        *(COMMON)            /* all COMMON sections from all files */\n        *(.bss)              /* all bss sections from all files */\n    }\n}\n</code></pre>\n\n<h1>Makefile</h1>\n\n<pre><code>OBJECTS = loader.o kmain.o io.o\nCC = gcc\nCFLAGS = -m32 -nostdlib -nostdinc -fno-builtin -fno-stack-protector \\\n     -nostartfiles -nodefaultlibs -Wall -Wextra -Werror -c\nLDFLAGS = -T link.ld -melf_i386\nAS = nasm\nASFLAGS = -f elf\n\nall: kernel.elf\n\nkernel.elf: $(OBJECTS)\nld $(LDFLAGS) $(OBJECTS) -o kernel.elf\n\nos.iso: kernel.elf\ncp kernel.elf iso/boot/kernel.elf\ngenisoimage -R                \\\n        -b boot/grub/stage2_eltorito    \\\n        -no-emul-boot          \\\n        -boot-load-size 4          \\\n        -A os              \\\n        -input-charset utf8      \\\n        -quiet            \\\n        -boot-info-table        \\\n        -o os.iso              \\\n        iso\n\nrun: os.iso\nbochs -f bochsrc.txt -q\n\n%.o: %.c\n$(CC) $(CFLAGS)  $&lt; -o $@\n\n%.o: %.s\n$(AS) $(ASFLAGS) $&lt; -o $@\n\nclean:\nrm -rf *.o kernel.elf os.iso\n</code></pre>\n\n<p>You can download the folder the project is in <a href=\"https://drive.google.com/drive/folders/1HukoRlvgEmcm9nuzs7v18J4TAzgnsIy1?usp=sharing\" rel=\"nofollow noreferrer\">here</a>\nI expect to see \"Hi\" in the upper left corner, but instead I see 2 weird characters: <a href=\"https://i.stack.imgur.com/Kxkjr.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Kxkjr.png\" alt=\"incorrect characters\"></a> Printing the first character and moving the cursor works fine, but when I attempt to print the second character, it messes up. </p>\n\n<p>Edit: I realized that the first character is an <strong>incorrectly</strong> colored H.</p>\n"}, {"tags": ["c", "hashmap", "embedded", "perfect-hash"], "answers": [{"comments": [{"owner": {"reputation": 1269, "user_id": 2736423, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/228894d9dc4748986d23a1a92fe704c4?s=128&d=identicon&r=PG&f=1", "display_name": "HXSP1947", "link": "https://stackoverflow.com/users/2736423/hxsp1947"}, "edited": false, "score": 0, "creation_date": 1529531708, "post_id": 50957360, "comment_id": 88912599, "body": "How would using the indices as hash values solve my problem?  While the hash it would produce would be unique, how would I later recalculate the hash?  So suppose the keys are [1000,989, 15, 17] which would gives hashes [3, 2, 0, 1].  If I wanted the hash later for 1000, wouldn&#39;t I have to linearly search for it?  That somewhat defeats the purpose of using a hash.  If I wanted to take that route a better solution would be to put all of my elements into a linked list and just search for the struct with the appropriate key."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 1269, "user_id": 2736423, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/228894d9dc4748986d23a1a92fe704c4?s=128&d=identicon&r=PG&f=1", "display_name": "HXSP1947", "link": "https://stackoverflow.com/users/2736423/hxsp1947"}, "edited": false, "score": 0, "creation_date": 1529548273, "post_id": 50957360, "comment_id": 88916208, "body": "Yes, @HXSP1947, the hash computation would be a search.  If you keep a sorted array of the keys then it would be a binary search; if an unsorted array then a linear search."}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 2, "last_activity_date": 1529530727, "last_edit_date": 1529530727, "creation_date": 1529530426, "answer_id": 50957360, "question_id": 50955706, "link": "https://stackoverflow.com/questions/50955706/16-bit-unique-key-to-8-bit-array-index-perfect-hash/50957360#50957360", "title": "16 bit unique key to 8 bit array index (perfect hash)", "body": "<blockquote>\n  <p>Given that I will know all of the keys at runtime (though I won't know\n  before runtime) is there an algorithm that exists that will give me a\n  unique mapping (i.e. perfect hash) in general?</p>\n</blockquote>\n\n<p>Given that you have up to 256 (16-bit) values to map, there are in principle many mappings you could use.  If the keys to be supported are uncorrelated, however, then any algorithm to compute the mappings requires all 256 keys or functions of them as parameters.  In comments, for example, the idea of a 256<sup>th</sup>-degree polynomial is discussed, and the parameters would there are the coefficients of the polynomial.</p>\n\n<p>Now consider that since the mapping needs 256 parameters, it also will <em>use</em> all those parameters in some way.  How, then, can something with these general characteristics be efficiently computable?</p>\n\n<p>The best solution I see for uncorrelated keys is to put all the keys in an array, sort them, and use each key's index in the sorted array as the wanted hash value.  (Thus the parameters are the keys themselves in this case.) You can compute those indices fairly efficiently by binary search.  Supposing that you store the sorted array for the duration of the program, I don't think you can do any such computation much more efficiently than this, and it's simple enough that you can be confident of its correctness.</p>\n\n<p>That assumes you know all the keys before you need to hash any of them.  If that is not the case then at minimum you can use an unsorted array and a linear search (though there may be in-between approaches, too).  A linear search may not seem particularly efficient, but it's unlikely to be worse on average than a purely arithmetic computation involving 256 parameters.</p>\n"}, {"comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1529554359, "post_id": 50957687, "comment_id": 88917349, "body": "Whereas I&#39;m prepared to believe that this general approach can work, it looks like there are several problems with the actual code you present.  To begin, be aware that your arithmetic on <code>uint8_t</code> operands will be done with operands promoted to <code>int</code> and evaluating to an <code>int</code>, which can produce results larger than 255."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1529554604, "post_id": 50957687, "comment_id": 88917419, "body": "I&#39;m also very suspicious of your computation of elements of <code>offset</code>.  It looks like after you choose an offset that works for one key with respect to those that follow it, you may later change that offset to accommodate a different key with the same most-significant byte, without checking whether the new offset also works for the first key."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1529554925, "post_id": 50957687, "comment_id": 88917497, "body": "Moreover, I find it odd that in the innermost block you are updating the <code>offset</code> for <code>index</code> rather than that for <code>test_index</code>.  I&#39;m not <i>confident</i> that that&#39;s wrong, but that&#39;s a second-order issue of its own: if this code is in fact correct, it is difficult to reason out why."}, {"owner": {"reputation": 1269, "user_id": 2736423, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/228894d9dc4748986d23a1a92fe704c4?s=128&d=identicon&r=PG&f=1", "display_name": "HXSP1947", "link": "https://stackoverflow.com/users/2736423/hxsp1947"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1529554997, "post_id": 50957687, "comment_id": 88917516, "body": "@JohnBollinger &quot;To begin, be aware that your arithmetic on uint8_t operands will be done with operands promoted to int and evaluating to an int, which can produce results larger than 255&quot;, I&#39;m not sure where you&#39;re looking.  Could you be a bit more specific?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1529555359, "post_id": 50957687, "comment_id": 88917610, "body": "I&#39;m looking all over, but most importantly at your computations of the form <code>remainder + offset[divisor]</code>.  You rely on these to produce results in the range 0-255, but it is not certain that they will do.  You need to consistently cast the results of those particular computations to <code>uint8_t</code>."}, {"owner": {"reputation": 1269, "user_id": 2736423, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/228894d9dc4748986d23a1a92fe704c4?s=128&d=identicon&r=PG&f=1", "display_name": "HXSP1947", "link": "https://stackoverflow.com/users/2736423/hxsp1947"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1529555987, "post_id": 50957687, "comment_id": 88917775, "body": "@JohnBollinger, good catch.  Should be fixed. &quot;It looks like after you choose an offset that works for one key with respect to those that follow it, you may later change that offset to accommodate a different key with the same most-significant byte, without checking whether the new offset also works for the first key.&quot; If I&#39;m understanding you correctly here you are saying things can and most likely will go south if the key is later changed?  I agree, after the keys are selected they will not change."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1529556375, "post_id": 50957687, "comment_id": 88917880, "body": "No, I&#39;m saying that it looks like the elements of <code>offset</code> computed by <code>create_mapping()</code> are not certain to yield distinct mappings for all keys known at the time it runs.  One way to help with that would be to sort the keys before computing (any of) the offsets, so that all keys with the same most-significant byte (which determines the relevant <code>offset</code>) are handled together.  Sorting does not by itself provide a complete solution to the problem, however."}, {"owner": {"reputation": 1269, "user_id": 2736423, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/228894d9dc4748986d23a1a92fe704c4?s=128&d=identicon&r=PG&f=1", "display_name": "HXSP1947", "link": "https://stackoverflow.com/users/2736423/hxsp1947"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1529556570, "post_id": 50957687, "comment_id": 88917936, "body": "@JohnBollinger, If you&#39;re saying that create_mapping() is not guaranteed to find a mapping I partially agree.  A mapping may not exist. if there are more than 256 keys.  However, if there is less than 256 keys a mapping will be found since the algorithm is essentially brute force.  The idea is the following (1) pick a key and increment its hash by 1 until it has a unique hash.  (2) go to the next key and repeat (1).  Since the hash is represented by 0-255 and there are less than 256 elements a valid hash must exist.  The key idea is the integer overflow which I am abusing to get what I want."}, {"owner": {"reputation": 1269, "user_id": 2736423, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/228894d9dc4748986d23a1a92fe704c4?s=128&d=identicon&r=PG&f=1", "display_name": "HXSP1947", "link": "https://stackoverflow.com/users/2736423/hxsp1947"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1529556766, "post_id": 50957687, "comment_id": 88917989, "body": "I had made a mistake in how I implemented the overflow though (and you caught) that I believe I have since corrected."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1529557888, "post_id": 50957687, "comment_id": 88918345, "body": "But in fact that&#39;s <i>not</i> what you do, nor does your approach afford that.  Whenever you find a collision and therefore increment an element of <code>offset</code>, you are changing the hash values of <i>every</i> key with a certain most-significant byte.  That may be many keys, including some that you&#39;ve already checked for collisions, and the change invalidates those prior collision tests.  You need to collision-check all the keys relying on the same offset together.  Moreover, it&#39;s only meaningful to test them against keys whose offsets are already decided."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1529558344, "post_id": 50957687, "comment_id": 88918506, "body": "To be clear: nothing I am saying relies on there being more than 256 keys, nor on keys changing or being added after the initial <code>create_mapping()</code> computation."}], "tags": [], "owner": {"reputation": 1269, "user_id": 2736423, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/228894d9dc4748986d23a1a92fe704c4?s=128&d=identicon&r=PG&f=1", "display_name": "HXSP1947", "link": "https://stackoverflow.com/users/2736423/hxsp1947"}, "is_accepted": false, "score": -1, "last_activity_date": 1529556802, "last_edit_date": 1529556802, "creation_date": 1529532113, "answer_id": 50957687, "question_id": 50955706, "link": "https://stackoverflow.com/questions/50955706/16-bit-unique-key-to-8-bit-array-index-perfect-hash/50957687#50957687", "title": "16 bit unique key to 8 bit array index (perfect hash)", "body": "<p>I ended up using the first fit algorithm to uniquely map 16 bit values onto 8 bit values (works under the assumption that there are no more than 256 16 bit values).  Below is a very short example that I coded up to test it.  While the mapping function is fairly expensive (called create mapping below), the get_value function is constant.  Therefore, once the mapping is established it should be fairly quick to calculate the hash (give by remainder + offset[divisor] in my example) and get the associated value.</p>\n\n<pre><code>uint16_t keys[256];\nuint16_t actual_mapping[256];\nuint8_t offset[256];\nuint8_t num_keys = 0;\n\nvoid \ncreate_mapping()\n{\n    uint8_t mapping_matrix[num_keys][2];\n\n    uint8_t index;\n    uint8_t test_index;\n    for(index = 0; index &lt; num_keys; index++)\n    {\n        mapping_matrix[index][0] = (uint8_t) (keys[index] / 256);\n        mapping_matrix[index][1] = keys[index] % 256;\n    }\n\n    for(index = 0; index &lt; num_keys - 1; index++)\n    {\n        uint8_t hash_not_found = 1;\n        while(hash_not_found)\n        {\n            hash_not_found = 0;\n            for(test_index = index + 1; test_index &lt; num_keys; test_index++)\n            {\n                if(mapping_matrix[index][0] != mapping_matrix[test_index][0])\n                {\n                    if((uint8_t) (mapping_matrix[index][1] + offset[mapping_matrix[index][0]]) == (uint8_t) (mapping_matrix[test_index][1] + offset[mapping_matrix[test_index][0]]))\n                    {\n                        hash_not_found = 1;\n                        offset[mapping_matrix[index][0]]++;\n                        break;\n                    }\n                }\n            }\n        }\n\n        actual_mapping[(uint8_t) (mapping_matrix[index][1] + offset[mapping_matrix[index][0]])] = keys[index];\n    }\n}\n\nuint16_t\nget_value(uint16_t value)\n{\n    uint8_t divisor = (uint8_t) (value / 256);\n    uint8_t remainder = value % 256;\n    return actual_mapping[(uint8_t) (remainder + offset[divisor])];\n}\n\nint main(int argc, char** argv) {\n\n    keys[0] = 0;\n    keys[1] = 256;\n    keys[2] = 4;\n    keys[3] = 13000;\n    keys[4] = 14000;\n    keys[5] = 15000;\n    keys[6] = 16000;\n    keys[7] = 3500;\n    keys[8] = 69;\n    keys[9] = 15;\n    keys[10] = 16;\n    keys[11] = 789;\n    keys[12] = 12001;\n\n    num_keys = 13;\n\n    create_mapping();\n\n    uint8_t index;\n    for(index = 0; index &lt; num_keys; index++)\n    {\n        printf(\"%hu\\n\", get_value(keys[index]));\n    }  \n\n\n}\n</code></pre>\n"}], "owner": {"reputation": 1269, "user_id": 2736423, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/228894d9dc4748986d23a1a92fe704c4?s=128&d=identicon&r=PG&f=1", "display_name": "HXSP1947", "link": "https://stackoverflow.com/users/2736423/hxsp1947"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 174, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1529556802, "creation_date": 1529522936, "question_id": 50955706, "link": "https://stackoverflow.com/questions/50955706/16-bit-unique-key-to-8-bit-array-index-perfect-hash", "title": "16 bit unique key to 8 bit array index (perfect hash)", "body": "<p>I have a set of structs that are uniquely identified by a uint16_t.  There will never be more than 256 of these structs (due to reasons I won't get into a uint16_t must be used to identify the structs).</p>\n\n<p>I would like to store these structs via an array of pointers.  Since there will never be more than 256 structs, I would like to statically allocate an array of struct pointers with size 256.  To do this though, I need a function to uniquely map uint16_t onto uint8_t.</p>\n\n<p>Given that I will know all of the keys at runtime (though I won't know before runtime) is there an algorithm that exists that will give me a unique mapping (i.e. perfect hash) in general?</p>\n\n<p>One caveat is that the system I am using has 16bit addresses.  So for efficiency reasons I don't want to use any types larger than uint16_t.</p>\n"}, {"tags": ["c", "logic"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1529522880, "post_id": 50955653, "comment_id": 88908957, "body": "Note <code>A[i+1]</code> could be out of bounds on the last loop iteration, but you have not checked anything. Be rigorous, check the return value from <code>scanf</code> (what is that) and the actual input values too."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1529523059, "post_id": 50955653, "comment_id": 88909036, "body": "<code>(R*B[i])&#47;100</code> is an integer calculation. One operand needs to be cast to <code>double</code>."}, {"owner": {"reputation": 49, "user_id": 8994644, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-DdbNGGtG8RQ/AAAAAAAAAAI/AAAAAAAABxQ/KWy0fz95cx8/photo.jpg?sz=128", "display_name": "VishnuPriya", "link": "https://stackoverflow.com/users/8994644/vishnupriya"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1529523092, "post_id": 50955653, "comment_id": 88909046, "body": "Sorry, I don&#39;t get you. A[i+1] what can be done for that.. and what to check with scanf values."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1529523259, "post_id": 50955653, "comment_id": 88909123, "body": "Then please read the <code>scanf</code> man page to find out what its return value means."}, {"owner": {"reputation": 49, "user_id": 8994644, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-DdbNGGtG8RQ/AAAAAAAAAAI/AAAAAAAABxQ/KWy0fz95cx8/photo.jpg?sz=128", "display_name": "VishnuPriya", "link": "https://stackoverflow.com/users/8994644/vishnupriya"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1529523265, "post_id": 50955653, "comment_id": 88909125, "body": "Yeah, I have done casting as double at that place already."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1529523445, "post_id": 50955653, "comment_id": 88909205, "body": "Only the first term, see @dbush answer."}], "answers": [{"comments": [{"owner": {"reputation": 49, "user_id": 8994644, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-DdbNGGtG8RQ/AAAAAAAAAAI/AAAAAAAABxQ/KWy0fz95cx8/photo.jpg?sz=128", "display_name": "VishnuPriya", "link": "https://stackoverflow.com/users/8994644/vishnupriya"}, "edited": false, "score": 0, "creation_date": 1529523580, "post_id": 50955761, "comment_id": 88909284, "body": "Omg, It has worked and cleared all cases. Thanks alot sir, :)"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 49, "user_id": 8994644, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-DdbNGGtG8RQ/AAAAAAAAAAI/AAAAAAAABxQ/KWy0fz95cx8/photo.jpg?sz=128", "display_name": "VishnuPriya", "link": "https://stackoverflow.com/users/8994644/vishnupriya"}, "edited": false, "score": 0, "creation_date": 1529523633, "post_id": 50955761, "comment_id": 88909299, "body": "@VishnuPriya Glad I could help.  Feel free to <a href=\"https://stackoverflow.com/help/accepted-answer\">accept this answer</a> if you found it useful."}, {"owner": {"user_type": "does_not_exist", "display_name": "user3458"}, "edited": false, "score": 0, "creation_date": 1529523771, "post_id": 50955761, "comment_id": 88909366, "body": "@dbush No need to cast to <code>double</code> (<code>int - double</code> is <code>double</code>). Also, depending on the values of <code>R</code> and <code>B[i]</code> you may get integer overflow, so maybe <code>(double)R*B[i]</code> is needed (and the cast is back :) )"}, {"owner": {"reputation": 49, "user_id": 8994644, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-DdbNGGtG8RQ/AAAAAAAAAAI/AAAAAAAABxQ/KWy0fz95cx8/photo.jpg?sz=128", "display_name": "VishnuPriya", "link": "https://stackoverflow.com/users/8994644/vishnupriya"}, "edited": false, "score": 0, "creation_date": 1529524090, "post_id": 50955761, "comment_id": 88909465, "body": "Oh I get it now sir,"}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 3, "last_activity_date": 1529523122, "creation_date": 1529523122, "answer_id": 50955761, "question_id": 50955653, "link": "https://stackoverflow.com/questions/50955653/accurate-precision-in-float-in-c/50955761#50955761", "title": "Accurate precision in float in C", "body": "<p>The problem is here:</p>\n\n<pre><code>sol=(double)R-(R*B[i])/100;\n</code></pre>\n\n<p>Each of the variables and constants in the sub-expression <code>(R*B[i])/100</code> have type <code>int</code>, so the result is also of type <code>int</code>.  The division operation is integer division which is truncating the result.  The cast you have on <code>R</code> isn't enough because the right-hand operand of the subtraction has already been evaluated as an <code>int</code>.</p>\n\n<p>Change the constant <code>100</code> to <code>100.0</code>.  That will give it type <code>double</code> which will cause the division to be floating point division.</p>\n\n<pre><code>sol=(double)R-(R*B[i])/100.0;\n</code></pre>\n\n<p>Also, the following comparison will read past the end of the array <code>A</code> on the last iteration:</p>\n\n<pre><code>if(R&gt;=A[i]&amp;&amp;R&lt;=A[i+1])\n</code></pre>\n\n<p>You need to account for the case of the last item:</p>\n\n<pre><code>if((R&gt;=A[i]) &amp;&amp; ((i==N-1) || (R&lt;=A[i+1])) )\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 8994644, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-DdbNGGtG8RQ/AAAAAAAAAAI/AAAAAAAABxQ/KWy0fz95cx8/photo.jpg?sz=128", "display_name": "VishnuPriya", "link": "https://stackoverflow.com/users/8994644/vishnupriya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 1, "closed_date": 1529527522, "accepted_answer_id": 50955761, "answer_count": 1, "score": 0, "last_activity_date": 1529526024, "creation_date": 1529522740, "last_edit_date": 1529526024, "question_id": 50955653, "link": "https://stackoverflow.com/questions/50955653/accurate-precision-in-float-in-c", "closed_reason": "Not suitable for this site", "title": "Accurate precision in float in C", "body": "<p>Given my program for the question in the image.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;math.h&gt;\n\nint main()\n{\n    int N,R,A[100],B[100],i,flag=0;\n    double sol;\n    scanf(\"%d%d\",&amp;N,&amp;R);\n\n    for(i=0;i&lt;N;i++)\n    {\n        scanf(\"%d\",&amp;A[i]);\n    }\n    for(i=0;i&lt;N;i++)\n    {\n        scanf(\"%d\",&amp;B[i]);\n    }\n    for(i=0;i&lt;N;i++)\n    {\n        if(R&gt;=A[i]&amp;&amp;R&lt;=A[i+1])\n        {\n            sol=(double)R-(R*B[i])/100;\n            flag++;\n        }\n    }\n    if(flag==0)\n    {\n        sol=(double)R;\n    }\n    printf(\"%.2f\",sol);\n}\n</code></pre>\n\n<p>This program passes three test cases. But fails in five. And shows expected output 3176.5 and the actual output is 3177.0. How to get all the cases cleared.</p>\n\n<p><a href=\"https://i.stack.imgur.com/kOYqK.png\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n"}, {"tags": ["c", "fonts", "rendering", "sdl", "opengl-es-2.0"], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 9967647, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-jaT2BCvWqlI/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq3uYIDGZLjF81yKsAOQC8IzqFWpLg/mo/photo.jpg?sz=128", "display_name": "Emmanouil Tsachalidis", "link": "https://stackoverflow.com/users/9967647/emmanouil-tsachalidis"}, "edited": false, "score": 0, "creation_date": 1529566622, "post_id": 50956263, "comment_id": 88922474, "body": "Rabbid76, this is just great. I knew it was close but due to my inexperience with openGL ES i had no idea where to look. After adding your code, it just worked. I am really thankfull. My best regards."}, {"owner": {"reputation": 33, "user_id": 9967647, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-jaT2BCvWqlI/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq3uYIDGZLjF81yKsAOQC8IzqFWpLg/mo/photo.jpg?sz=128", "display_name": "Emmanouil Tsachalidis", "link": "https://stackoverflow.com/users/9967647/emmanouil-tsachalidis"}, "edited": false, "score": 0, "creation_date": 1529652125, "post_id": 50956263, "comment_id": 88960432, "body": "Thanks Rabbid76 for your time. I am however facing a could of other issues. Could you pls see: <a href=\"https://stackoverflow.com/questions/50982640/font-rendering-freetype-with-opengl-es-2-0-combined-with-other-line-drawing-fu\" title=\"font rendering freetype with opengl es 2 0 combined with other line drawing fu\">stackoverflow.com/questions/50982640/&hellip;</a>"}], "tags": [], "owner": {"reputation": 138000, "user_id": 5577765, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LoGpC.jpg?s=128&g=1", "display_name": "Rabbid76", "link": "https://stackoverflow.com/users/5577765/rabbid76"}, "is_accepted": true, "score": 0, "last_activity_date": 1529525251, "creation_date": 1529525251, "answer_id": 50956263, "question_id": 50955558, "link": "https://stackoverflow.com/questions/50955558/render-fonts-with-sdl2-opengl-es-2-0-glsl-1-0-freetype/50956263#50956263", "title": "Render fonts with SDL2, openGL ES 2.0 (GLSL 1.0) &amp; Freetype", "body": "<p>The issue is simple, you have forgotten to set the uniform variables <code>tex</code> and <code>color</code> (<code>tex</code> is not necessary in your case, because it is set to 0 by default).</p>\n\n<p>Determine the uniform locations of the active program resources <code>tex</code> and <code>color</code>, by <code>glGetUniformLocation</code>, after the program is linked (<code>glLinkProgram</code>).\nSet the uniforms by <code>glUniform1i</code> respectively <code>glUniform4fv</code>, after the shader program has become the current program (<code>gUseProgram</code>):</p>\n\n<pre><code>shaderProg = shaderProgLoad(\"shaderV1.vert\", \"shaderV1.frag\");\n\nGLuint tex_loc   = glGetUniformLocation( shaderProg, \"tex\" );\nGLuint color_loc = glGetUniformLocation( shaderProg, \"color\" );\n\n// Activate the program\nglUseProgram(shaderProg);\n\nglUniform1i( tex_loc, 0 ); // 0, because the texture is bound to of texture unit 0\nfloat col[4] = { 1.0f, 0.0f, 0.0, 1.0f }; // red and opaque\nglUniform4fv( color_loc, 1, col); \n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 9967647, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-jaT2BCvWqlI/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq3uYIDGZLjF81yKsAOQC8IzqFWpLg/mo/photo.jpg?sz=128", "display_name": "Emmanouil Tsachalidis", "link": "https://stackoverflow.com/users/9967647/emmanouil-tsachalidis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 830, "favorite_count": 0, "accepted_answer_id": 50956263, "answer_count": 1, "score": 1, "last_activity_date": 1529525251, "creation_date": 1529522340, "question_id": 50955558, "link": "https://stackoverflow.com/questions/50955558/render-fonts-with-sdl2-opengl-es-2-0-glsl-1-0-freetype", "title": "Render fonts with SDL2, openGL ES 2.0 (GLSL 1.0) &amp; Freetype", "body": "<p>this is my first post here. I am working on an app that is intended for use on a raspberry pi 3 board. My target is to successfully draw graphics with the gpu instead of the cpu thus keeping the later available enough to satisfy cpu processing needs required by other parts of the app's program such as math calculations, i/o comms, I2C comms, virtual serial port comms etc.</p>\n\n<p>I have so far been able to reach the point where i could use SDL2 &amp; opengles 2.0 to draw lines with glDrawArrays() after, among others, following the tutorial of a paper from: <a href=\"https://keasigmadelta.com/store/gles3sdl2-tutorial/\" rel=\"nofollow noreferrer\">https://keasigmadelta.com/store/gles3sdl2-tutorial/</a> . I successfully tried that in my raspberry pi 3 which with the GL driver enabled supports openGL ES 2.0 and GLSL 1.0 .</p>\n\n<p>I was experimenting with rendering fonts with SDL2 which provides quite good functions that let you defined color &amp; size as well as other params of the resulting rendering. Despite the fact that rendering fonts with SDL2 function TTF_RenderText_Blended(...) gave me perfect results, reasonable times and cpu overhead on my intel core 2 Quad core 9550 2.8GHz, i cannot say the same about the raspberry pi 3. Trying to use the gpu with glDrawArrays() on my raspi3 gave me impressive results with an almost 5-10% cpu load with 1000 lines between randomly selected vertices being drawn >50 times per second. However i need to render fonts by using the gpu instead of the cpu because plain SDL2 font rendering on my raspi3 resulted in 50-60% cpu load which leaves me with no space for other math calculations and such. </p>\n\n<p>After searching for 2-3 days in the internet i decided to follow a tutorial from: <a href=\"https://en.wikibooks.org/wiki/OpenGL_Programming/Modern_OpenGL_Tutorial_Text_Rendering_01\" rel=\"nofollow noreferrer\">https://en.wikibooks.org/wiki/OpenGL_Programming/Modern_OpenGL_Tutorial_Text_Rendering_01</a> which however did not include SDL2. Although i was able to compile the code, i am giving below, with no errors with: g++ -Wall main.cpp -I/usr/include/freetype2 -lSDL2 -lSDL2_ttf -lGL -lGLEW -lfreetype -o main . You could exclude some options as they refer to other libs being used such as ttf.</p>\n\n<p>Please keep in mind that the code already works fine with glDrawArrays() although there is no reference to that.</p>\n\n<p>Some of you will find some of my comments ridiculous i know. </p>\n\n<p>What i get out of the following code is a screen at the color set by glClearColor(0.5, 0.5, 0.5, 1); which is grey and that is exactly what i get.\nNothing else happens. When it comes to debuging, i placed a SDL_Log() in function renderText() . If you noticed, display() function contains 2 calls to renderText(). The 2 SDL_Log() functions give me the following in the app window:</p>\n\n<pre><code>INFO: Debug info: glyph w: 0, glyph rows: 0\nINFO: Debug info: glyph w: 25, glyph rows: 36\n</code></pre>\n\n<p>There is no much more info i can give you. Can you help me go through the font rendering?</p>\n\n<p>One thing is for sure. I have to sit down and learn some opengles as well as GLSL.</p>\n\n<p>Vertex shader contents</p>\n\n<pre><code>#version 100\n\nattribute vec4 coord;\nvarying vec2 texcoord;\n\nvoid main(void) {\n  gl_Position = vec4(coord.xy, 0, 1);\n  texcoord = coord.zw;\n}\n</code></pre>\n\n<p>Fragment shader contents</p>\n\n<pre><code>#version 100\n\n#ifdef GL_ES\n  precision highp float;\n#endif\n\nvarying vec2 texcoord;\nuniform sampler2D tex;\nuniform vec4 color;\n\nvoid main(void) {\n  gl_FragColor = vec4(1, 1, 1, texture2D(tex, texcoord).r) * color;\n}\n</code></pre>\n\n<p>Compiles with:</p>\n\n<pre><code>g++ -Wall main.cpp -I/usr/include/freetype2 -lSDL2 -lGL -lGLEW -lfreetype -o main\n</code></pre>\n\n<p>The source code was tested in Linux Mint 18.3 (ubuntu 16.04) and is as follows:</p>\n\n<pre><code>// Standard libs\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;time.h&gt;\n\n// Add -lSDL2\n// Found at /usr/local/include/SDL2\n#include &lt;SDL2/SDL.h&gt;\n\n// Add -lGL and -lGLEW to compiler\n// Found at /usr/include/GL\n#include &lt;GL/glew.h&gt;\n#include &lt;GL/glu.h&gt;\n\n// Add -lfreetype and -I/usr/include/freetype2 to compiler\n// Found at /usr/include/freetype2/freetype/config/\n#include &lt;ft2build.h&gt;\n#include FT_FREETYPE_H\n\nSDL_Window *window=NULL;\nSDL_GLContext openGLContext;\nFT_Library ft=NULL;\nFT_Face face;\nGLuint shaderProg;\n\ntypedef struct {\n  float position[2];\n} Vertex;\n\n// The function render_text() takes 5 arguments: the string to render, the x and y start coordinates, \n// and the x and y scale parameters. The last two should be chosen such that one glyph pixel corresponds \n// to one screen pixel. Let's look at the display() function which draws the whole screen:\nvoid render_text(const char *text, float x, float y, float sx, float sy) {\n  const char *p;\n\n  FT_GlyphSlot g = face-&gt;glyph;\n\n  SDL_Log(\"Debug info: glyph w: %d, glyph rows: %d\", g-&gt;bitmap.width, g-&gt;bitmap.rows);\n\n  for(p = text; *p; p++) {\n\n    // If FT_Load_Char() returns a non-zero value then the glyph in *p could not be loaded\n    if(FT_Load_Char(face, *p, FT_LOAD_RENDER))\n        continue;\n\n    glTexImage2D(\n      GL_TEXTURE_2D,\n      0,\n      GL_RED,\n      g-&gt;bitmap.width,\n      g-&gt;bitmap.rows,\n      0,\n      GL_RED,\n      GL_UNSIGNED_BYTE,\n      g-&gt;bitmap.buffer\n    );\n\n    float x2 = x + g-&gt;bitmap_left * sx;\n    float y2 = -y - g-&gt;bitmap_top * sy;\n    float w = g-&gt;bitmap.width * sx;\n    float h = g-&gt;bitmap.rows * sy;\n\n    GLfloat box[4][4] = {\n        {x2,     -y2    , 0, 0},\n        {x2 + w, -y2    , 1, 0},\n        {x2,     -y2 - h, 0, 1},\n        {x2 + w, -y2 - h, 1, 1},\n    };\n\n    glBufferData(GL_ARRAY_BUFFER, sizeof box, box, GL_DYNAMIC_DRAW);\n    glDrawArrays(GL_TRIANGLE_STRIP, 0, 4);\n\n    x += (g-&gt;advance.x/64) * sx;\n    y += (g-&gt;advance.y/64) * sy;\n  }\n}\n\n\nvoid display(void) {\n\n  // I had to add the three next lines of code because the 1st param to glUniform4fv() was unreferenced in the Wiki tutorial.\n  // After looking at: https://www.khronos.org/registry/OpenGL-Refpages/gl4/html/glGetUniformLocation.xhtml\n  // I concluded that i had to use glGetUniformLocation() to get the uLocation but i had no idea what to pass as 2nd param to glGetUniformLocation()\n  // Docs say regarding the 2nd param: Points to a null terminated string containing the name of the uniform variable whose location is to be queried.\n  // There is a var called uniform_location in the fragment shader so i had i pick one from there. I know i sound ridiculus...\n  int w=0, h=0;\n  SDL_GetWindowSize(window, &amp;w, &amp;h);\n  GLint uLocation = glGetUniformLocation(shaderProg, \"sample2D\");\n\n  // Clear the invisible buffer with the color specified\n  glClearColor(0.5, 0.5, 0.5, 1);\n  glClear(GL_COLOR_BUFFER_BIT);\n\n  GLfloat black[4] = {0, 0, 0, 1};\n  glUniform4fv(uLocation, 1, black);\n\n  float sx = 2.0 / (float)w;\n  float sy = 2.0 / (float)h;\n\n  render_text(\"The Quick Brown Fox Jumps Over The Lazy Dog\", -1 + 8 * sx,   1 - 50 * sy, sx, sy);\n  render_text(\"The Misaligned Fox Jumps Over The Lazy Dog\", -1 + 8.5 * sx, 1 - 100.5 * sy, sx, sy);\n\n  // I replaced glutSwapBuffers(); with the following\n  SDL_GL_SwapWindow(window);\n}\n\nvoid shaderProgDestroy(GLuint shaderProg) {\n  glDeleteProgram(shaderProg);\n}\n\n/** Destroys a shader.\n*/\nstatic void shaderDestroy(GLuint shaderID) {\nglDeleteShader(shaderID);\n}\n\n/** Gets the file's length.\n*\n* @param file the file\n*\n* @return size_t the file's length in bytes\n*/\nstatic size_t fileGetLength(FILE *file) {\n  size_t length;\n  size_t currPos = ftell(file);\n  fseek(file, 0, SEEK_END);\n  length = ftell(file);\n  // Return the file to its previous position\n  fseek(file, currPos, SEEK_SET);\n  return length;\n}\n\n\n/** Loads and compiles a shader from a file.\n*\n* This will print any errors to the console.\n*\n* @param filename the shader's filename\n* @param shaderType the shader type (e.g., GL_VERTEX_SHADER)\n*\n* @return GLuint the shader's ID, or 0 if failed\n*/\nstatic GLuint shaderLoad(const char *filename, GLenum shaderType) {\n  FILE *file = fopen(filename, \"r\");\n  if (!file) {\n    SDL_Log(\"Can't open file: %s\\n\", filename);\n    return 0;\n  }\n  size_t length = fileGetLength(file);\n  // Alloc space for the file (plus '\\0' termination)\n  GLchar *shaderSrc = (GLchar*)calloc(length + 1, 1);\n  if (!shaderSrc) {\n    SDL_Log(\"Out of memory when reading file: %s\\n\", filename);\n    fclose(file);\n    file = NULL;\n    return 0;\n  }\n  fread(shaderSrc, 1, length, file);\n  // Done with the file\n  fclose(file);\n  file = NULL;\n\n  // Create the shader\n  GLuint shader = glCreateShader(shaderType);\n\n  glShaderSource(shader, 1, (const GLchar**)&amp;shaderSrc, NULL);\n  free(shaderSrc);\n  shaderSrc = NULL;\n  // Compile it\n  glCompileShader(shader);\n  GLint compileSucceeded = GL_FALSE;\n  glGetShaderiv(shader, GL_COMPILE_STATUS, &amp;compileSucceeded);\n  if (!compileSucceeded) {\n    // Compilation failed. Print error info\n    SDL_Log(\"Compilation of shader %s failed:\\n\", filename);\n    GLint logLength = 0;\n    glGetShaderiv(shader, GL_INFO_LOG_LENGTH, &amp;logLength);\n    GLchar *errLog = (GLchar*)malloc(logLength);\n    if (errLog) {\n      glGetShaderInfoLog(shader, logLength, &amp;logLength, errLog);\n      SDL_Log(\"%s\\n\", errLog);\n      free(errLog);\n    }\n    else {\n      SDL_Log(\"Couldn't get shader log; out of memory\\n\");\n    }\n    glDeleteShader(shader);\n    shader = 0;\n  }\n  return shader;\n}\n\nGLuint shaderProgLoad(const char *vertFilename, const char *fragFilename) {\n\n  // Load vertex shader file from disk\n  GLuint vertShader = shaderLoad(vertFilename, GL_VERTEX_SHADER);\n  if (!vertShader) {\n    SDL_Log(\"Couldn't load vertex shader: %s\\n\", vertFilename);\n    return 0;\n  }\n\n  // Load fragment shader file from disk\n  GLuint fragShader = shaderLoad(fragFilename, GL_FRAGMENT_SHADER);\n  if (!fragShader) {\n    SDL_Log(\"Couldn't load fragment shader: %s\\n\", fragFilename);\n    shaderDestroy(vertShader);\n    vertShader = 0;\n    return 0;\n  }\n\n  // Create a shader program out of the two (or more) shaders loaded\n  GLuint shaderProg = glCreateProgram();\n  if (shaderProg) {\n    // Attach the the two shaders to the program\n    glAttachShader(shaderProg, vertShader);\n    glAttachShader(shaderProg, fragShader);\n    // Link the two shaders together\n    glLinkProgram(shaderProg);\n\n    GLint linkingSucceeded = GL_FALSE;\n\n    // Get a status (true or false) of the linking process\n    glGetProgramiv(shaderProg, GL_LINK_STATUS, &amp;linkingSucceeded);\n\n    // Handle the error if linking the two shaders went wrong\n    if (!linkingSucceeded) {\n      SDL_Log(\"Linking shader failed (vert. shader: %s, frag. shader: %s\\n\", vertFilename, fragFilename);\n      GLint logLength = 0;\n      glGetProgramiv(shaderProg, GL_INFO_LOG_LENGTH, &amp;logLength);\n      GLchar *errLog = (GLchar*)malloc(logLength);\n      if (errLog) {\n        glGetProgramInfoLog(shaderProg, logLength, &amp;logLength, errLog);\n        SDL_Log(\"%s\\n\", errLog);\n        free(errLog);\n      }\n      else {\n        SDL_Log(\"Couldn't get shader link log; out of memory\\n\");\n      }\n      glDeleteProgram(shaderProg);\n      shaderProg = 0;\n    }\n  }\n  else {\n    SDL_Log(\"Couldn't create shader program\\n\");\n  }\n\n  // Free resources\n  shaderDestroy(vertShader);\n  shaderDestroy(fragShader);\n\n  // Return the resulting shader program\n  return shaderProg;\n}\n\n/** Creates the Vertex Buffer Object (VBO) containing\n* the given vertices.\n*\n* @param vertices pointer to the array of vertices\n* @param numVertices the number of vertices in the array\n*/\nGLuint vboCreate(Vertex *vertices, GLuint numVertices) {\n  // Create the Vertex Buffer Object\n  GLuint vbo;\n  int nBuffers = 1;\n  // Create a buffer\n  glGenBuffers(nBuffers, &amp;vbo);\n  // Make the buffer a VBO buffer\n  glBindBuffer(GL_ARRAY_BUFFER, vbo);\n  // Copy the vertices data in the buffer, and deactivate with glBindBuffer(GL_ARRAY_BUFFER, 0);\n  glBufferData(GL_ARRAY_BUFFER, sizeof(Vertex) * numVertices, vertices, GL_STATIC_DRAW);\n  glBindBuffer(GL_ARRAY_BUFFER, 0);\n  // Check for problems\n  GLenum err = glGetError();\n  if (err != GL_NO_ERROR) {\n    // Failed\n    glDeleteBuffers(nBuffers, &amp;vbo);\n    SDL_Log(\"Creating VBO failed, code %u\\n\", err);\n    vbo = 0;\n  }\n  return vbo;\n}\n\n\n/** Frees the VBO.\n*\n* @param vbo the VBO's name.\n*/\nvoid vboFree(GLuint vbo) {\n  glDeleteBuffers(1, &amp;vbo);\n}\n\nvoid freeResources(void){\n    SDL_GL_DeleteContext(openGLContext);\n  shaderProgDestroy(shaderProg);\n  SDL_Quit();\n  SDL_DestroyWindow(window);\n}\n\n\nint main(int argc, char* args[]){\n    // SDL2 video init\n    SDL_Init( SDL_INIT_VIDEO | SDL_INIT_TIMER );\n\n    // Setting openGL attributes\n    SDL_GL_SetAttribute(SDL_GL_CONTEXT_PROFILE_MASK, SDL_GL_CONTEXT_PROFILE_CORE);\n    SDL_GL_SetAttribute(SDL_GL_CONTEXT_MAJOR_VERSION, 2);\n    SDL_GL_SetAttribute(SDL_GL_CONTEXT_MINOR_VERSION, 0);\n    // Enable double buffering\n    SDL_GL_SetAttribute(SDL_GL_DOUBLEBUFFER, 1);\n    // Enable hardware accelaration if available\n    SDL_GL_SetAttribute(SDL_GL_ACCELERATED_VISUAL, 1);\n    glewExperimental = GL_TRUE;\n\n    // Get window\n    window = SDL_CreateWindow( \"Test\", SDL_WINDOWPOS_UNDEFINED, \n    SDL_WINDOWPOS_UNDEFINED, 800, 600, SDL_WINDOW_SHOWN | SDL_WINDOW_OPENGL);\n    // Get openGL context\n    openGLContext = SDL_GL_CreateContext(window);\n    // Init glew\n    glewInit();\n\n    // ft globally defined with FT_Library ft\n    FT_Init_FreeType(&amp;ft);\n\n    // face globally defined with FT_Face face;\n    FT_New_Face(ft, \"LiberationMono-Bold.ttf\", 0, &amp;face);\n\n\n    // All return values of the init functions above since the point where main starts are normal. No errors are returned.\n    // I have skipped the if conditions for the shake of simplicity\n\n\n    // Load vertex &amp; fragment shaders, compile them, link them together, make a program and return it\n    shaderProg = shaderProgLoad(\"shaderV1.vert\", \"shaderV1.frag\");\n    // Activate the program\n    glUseProgram(shaderProg);\n\n    // The code up to this point works fine\n\n\n    // This is where the code from wikipedia starts\n    FT_Set_Pixel_Sizes(face, 0, 48);\n\n    glEnable(GL_BLEND);\n    glBlendFunc(GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA);\n\n    glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_WRAP_S, GL_CLAMP_TO_EDGE);\n    glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_WRAP_T, GL_CLAMP_TO_EDGE);\n\n    glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_LINEAR);\n    glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_LINEAR);\n\n    glPixelStorei(GL_UNPACK_ALIGNMENT, 1);\n\n    GLuint vbo;\n\n    // I set the var attribute_coord. Is this right? The code from Wiki did not have any initializations for this variable.\n    GLuint attribute_coord=0;\n\n    glGenBuffers(1, &amp;vbo);\n    glEnableVertexAttribArray(attribute_coord);\n    glBindBuffer(GL_ARRAY_BUFFER, vbo);\n    glVertexAttribPointer(attribute_coord, 4, GL_FLOAT, GL_FALSE, 0, 0);\n\n    display();\n    // This is where the code from wikipedia ends\n\n    while (1){\n\n      // Wait\n      SDL_Delay(10);\n    }\n\n\n    // A function that free resources\n    freeResources();\n\n    return 0;\n  }\n</code></pre>\n"}, {"tags": ["c", "macos", "makefile", "archlinux", "package-managers"], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 6758031, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/79OpK.jpg?s=128&g=1", "display_name": "oioioi", "link": "https://stackoverflow.com/users/6758031/oioioi"}, "edited": false, "score": 0, "creation_date": 1529564547, "post_id": 50956499, "comment_id": 88921262, "body": "Thanks for your help again! :) #archlinux-pacman are helpful guys and gal!"}, {"owner": {"reputation": 43, "user_id": 6758031, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/79OpK.jpg?s=128&g=1", "display_name": "oioioi", "link": "https://stackoverflow.com/users/6758031/oioioi"}, "edited": false, "score": 0, "creation_date": 1529570143, "post_id": 50956499, "comment_id": 88924488, "body": "Using <code>brew</code>, the directories need to be created in <code>post_install</code>, see: <a href=\"https://discourse.brew.sh/t/building-a-bottle-how-can-i-stop-brew-from-deleting-directories/2411\" rel=\"nofollow noreferrer\">discourse.brew.sh/t/&hellip;</a>."}], "tags": [], "owner": {"reputation": 303, "user_id": 9969680, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oe3Ye.png?s=128&g=1", "display_name": "eschwartz", "link": "https://stackoverflow.com/users/9969680/eschwartz"}, "is_accepted": true, "score": 1, "last_activity_date": 1529526281, "creation_date": 1529526281, "answer_id": 50956499, "question_id": 50955346, "link": "https://stackoverflow.com/questions/50955346/pacman-fork-on-macos/50956499#50956499", "title": "Pacman fork on macOS", "body": "<p>As discussed in the #archlinux-pacman IRC channel on Freenode (official pacman development channel) pacman installs a couple of empty directories, which seem to be created successfully on a manual <code>make install</code> but not when brew does it.</p>\n\n<p>Brew may be deleting these directories because it thinks you don't need them. This is similar to a feature in makepkg too -- if the !emptydirs option is specified in <a href=\"https://www.archlinux.org/pacman/makepkg.conf.5.html#_options\" rel=\"nofollow noreferrer\">makepkg.conf(5)</a> or the PKGBUILD, empty directories will be deleted. This option is disabled by default because it can cause issues when those directories are legitimately needed.</p>\n"}], "owner": {"reputation": 43, "user_id": 6758031, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/79OpK.jpg?s=128&g=1", "display_name": "oioioi", "link": "https://stackoverflow.com/users/6758031/oioioi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 194, "favorite_count": 0, "accepted_answer_id": 50956499, "answer_count": 1, "score": 0, "last_activity_date": 1580890675, "creation_date": 1529521448, "last_edit_date": 1580890675, "question_id": 50955346, "link": "https://stackoverflow.com/questions/50955346/pacman-fork-on-macos", "title": "Pacman fork on macOS", "body": "<p>I\u2019m working on an project, which is a <a href=\"https://www.archlinux.org/pacman/\" rel=\"nofollow noreferrer\"><code>pacman</code></a> fork. I\u2019m trying to develop this project for both macOS and Linux. Compiling my project on macOS is so far successful, but I\u2019ve got a problem with some directories. In the Makefile.am, directories for the DB and cache are supposed to be create:.</p>\n\n<pre><code># create the meme DB, cache, makepkg-template and system hook directories upon install\ninstall-data-local:\n    for dir in \"$(DESTDIR)$(localstatedir)/lib/meme\" \"$(DESTDIR)$(localstatedir)/cache/meme/pkg\" \\\n               \"$(DESTDIR)$(datarootdir)/makepkg-template\" \"$(DESTDIR)$(datarootdir)/libalpm/hooks\"; do \\\n    test -z \"$$dir\" || $(MKDIR_P) \"$$dir\"; \\\ndone\n</code></pre>\n\n<p>Those directories are missing after installation on macOS, so that I get the following error by <code>pacman</code>:</p>\n\n<pre><code>error: failed to initialize alpm library\n(could not find or read directory: /usr/local/Cellar/meme/0.0.8.2/var/lib/meme/)\n</code></pre>\n\n<p>I\u2019m using Homebrew to compile, bottle and install the package manager. You can find my formula on GitHub: <a href=\"https://github.com/kenokenobingo/homebrew-memetap\" rel=\"nofollow noreferrer\">https://github.com/kenokenobingo/homebrew-memetap</a>.</p>\n\n<p>Do you have any idea how to get rid of this problem? Is this a OS-specific issue?</p>\n"}, {"tags": ["c", "gcc", "stack-overflow", "stack-smash"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 3, "creation_date": 1529521207, "post_id": 50955249, "comment_id": 88908182, "body": "Yes, you are hiding the problem."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 4, "creation_date": 1529521297, "post_id": 50955249, "comment_id": 88908227, "body": "<code>-fstack-protector</code> is supposed to turn exploitable bugs into prompt crashes, not to prevent stack corruption altogether.  If the program stops crashing when compiled with <code>-fstack-protector</code>, then it&#39;s just had the bug perturbed out of manifesting.  Try <code>valgrind</code> instead."}, {"owner": {"reputation": 3193, "user_id": 6608866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/395a0bd6f09706e701866702448c5924?s=128&d=identicon&r=PG&f=1", "display_name": "PaulR", "link": "https://stackoverflow.com/users/6608866/paulr"}, "edited": false, "score": 0, "creation_date": 1529681426, "post_id": 50955249, "comment_id": 88977078, "body": "I recommend compiling with <code>-fsanitize=address</code> and running the program. It is better at analyzing the stack than valgrind, because it knows the actual variables on the stack and it can tell you when an array access on the stack overflows into another stack variable. <a href=\"https://github.com/google/sanitizers/wiki/AddressSanitizerExampleStackOutOfBounds\" rel=\"nofollow noreferrer\">github.com/google/sanitizers/wiki/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 2, "last_activity_date": 1529522492, "creation_date": 1529522492, "answer_id": 50955597, "question_id": 50955249, "link": "https://stackoverflow.com/questions/50955249/how-does-gccs-fstack-protector-option-prevent-stack-smashing/50955597#50955597", "title": "How does gcc&#39;s -fstack-protector option prevent stack smashing?", "body": "<p>This option does not <em>prevent</em> stack smashing, but rather detects it and halts the program.</p>\n\n<p>From the gcc man page:</p>\n\n<blockquote>\n  <p>-fstack-protector</p>\n  \n  <p>Emit extra code to check for buffer overflows, such as stack\n       smashing attacks.  This is done by adding a guard variable to\n       functions with vulnerable objects.  This includes functions that\n       call \"alloca\", and functions with buffers larger than 8 bytes.  The\n       guards are initialized when a function is entered and then checked\n       when the function exits.  If a guard check fails, an error message\n       is printed and the program exits.</p>\n</blockquote>\n\n<p>You still have an overflow problem, but the addition of the guard variables is apparently masking the issue.  If you run your program under <a href=\"http://valgrind.org\" rel=\"nofollow noreferrer\">valgrind</a> it should be able to detect what's happening.</p>\n"}], "owner": {"reputation": 28, "user_id": 9771155, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dqc4C.jpg?s=128&g=1", "display_name": "hmarceau", "link": "https://stackoverflow.com/users/9771155/hmarceau"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1817, "favorite_count": 0, "accepted_answer_id": 50955597, "answer_count": 1, "score": 1, "last_activity_date": 1529522492, "creation_date": 1529521094, "question_id": 50955249, "link": "https://stackoverflow.com/questions/50955249/how-does-gccs-fstack-protector-option-prevent-stack-smashing", "title": "How does gcc&#39;s -fstack-protector option prevent stack smashing?", "body": "<p>I've been running into a stack-smashing issue and I'm having difficulty finding the cause. The stack smashing error only happens occasionally, and only at the very end of the program's execution. It also stops happening completely when I compile it using the 'fstack-protector' option with gcc. I'm wondering if using the 'fstack-protector' option is an actual solution or if I'm just hiding the problem? I'd post the code but it's 3000 lines long and I'm not sure which part of the code is responsible.</p>\n"}, {"tags": ["c++", "c"], "comments": [{"owner": {"reputation": 18522, "user_id": 5241642, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/TadbK.png?s=128&g=1", "display_name": "Xirema", "link": "https://stackoverflow.com/users/5241642/xirema"}, "edited": false, "score": 7, "creation_date": 1529520500, "post_id": 50955093, "comment_id": 88907863, "body": "&quot;<i>I&#39;ve tried everything</i>&quot;\u2014then it should be pretty easy to show us what you&#39;ve tried."}, {"owner": {"reputation": 18522, "user_id": 5241642, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/TadbK.png?s=128&g=1", "display_name": "Xirema", "link": "https://stackoverflow.com/users/5241642/xirema"}, "edited": false, "score": 2, "creation_date": 1529521391, "post_id": 50955093, "comment_id": 88908273, "body": "The rules for this website clearly specify that we&#39;re not a homework website. You&#39;re expected to show us, in a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>, what you&#39;ve already tried to do to solve your problem. Posting the definitions for the two types you&#39;re working with doesn&#39;t satisfy that requirement. Additionally, your question is still unclear: what does &quot;move between them&quot; mean in this context? What&#39;s stopping you from just transforming the <code>std::complex&lt;float&gt;</code> array into a <code>_Complex</code> array, using elementary functions?"}, {"owner": {"reputation": 1051, "user_id": 916046, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ac4f5c34b40b8626dbeb447d6d0b1bc8?s=128&d=identicon&r=PG&f=1", "display_name": "CompEng88", "link": "https://stackoverflow.com/users/916046/compeng88"}, "reply_to_user": {"reputation": 18522, "user_id": 5241642, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/TadbK.png?s=128&g=1", "display_name": "Xirema", "link": "https://stackoverflow.com/users/5241642/xirema"}, "edited": false, "score": 0, "creation_date": 1529682589, "post_id": 50955093, "comment_id": 88977706, "body": "I&#39;ve clarified my problem Xirema. Still can&#39;t figure this out."}, {"owner": {"reputation": 18522, "user_id": 5241642, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/TadbK.png?s=128&g=1", "display_name": "Xirema", "link": "https://stackoverflow.com/users/5241642/xirema"}, "edited": false, "score": 0, "creation_date": 1529683310, "post_id": 50955093, "comment_id": 88978113, "body": "<a href=\"https://godbolt.org/g/WKx6kF\" rel=\"nofollow noreferrer\">I punched your code into an online compiler</a>, and got a different error message, related to the <code>complex</code> keyword not mapping to a valid type. Swapping <code>complex</code> with <code>_Complex</code> eliminated the compile errors. I don&#39;t know which compiler you&#39;re using, but your compiler doesn&#39;t appear to alias <code>_Complex</code> to <code>complex</code> like the documentation suggests is possible."}], "answers": [{"comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 18522, "user_id": 5241642, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/TadbK.png?s=128&g=1", "display_name": "Xirema", "link": "https://stackoverflow.com/users/5241642/xirema"}, "edited": false, "score": 0, "creation_date": 1529521873, "post_id": 50955330, "comment_id": 88908493, "body": "@Xirema C++ has made a specific exemption for <code>std::complex</code> for binary compatibility with C."}, {"owner": {"reputation": 18522, "user_id": 5241642, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/TadbK.png?s=128&g=1", "display_name": "Xirema", "link": "https://stackoverflow.com/users/5241642/xirema"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1529522068, "post_id": 50955330, "comment_id": 88908606, "body": "@NathanOliver Noted. The answer should probably have a reference added to the relevant text to verify that: <a href=\"https://en.cppreference.com/w/cpp/numeric/complex\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/numeric/complex</a>"}, {"owner": {"reputation": 22818, "user_id": 509868, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/83450238b4ee0eddbf54d7ce5a3a64e4?s=128&d=identicon&r=PG", "display_name": "anatolyg", "link": "https://stackoverflow.com/users/509868/anatolyg"}, "edited": false, "score": 0, "creation_date": 1529522264, "post_id": 50955330, "comment_id": 88908682, "body": "What&#39;s this <code>cfloat</code>? I tried to search the Internet for it, but failed. Is there anything more convenient than simple casting?"}, {"owner": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "reply_to_user": {"reputation": 22818, "user_id": 509868, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/83450238b4ee0eddbf54d7ce5a3a64e4?s=128&d=identicon&r=PG", "display_name": "anatolyg", "link": "https://stackoverflow.com/users/509868/anatolyg"}, "edited": false, "score": 0, "creation_date": 1529528235, "post_id": 50955330, "comment_id": 88911240, "body": "@anatolyg, please see my edit"}], "tags": [], "owner": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "is_accepted": false, "score": 3, "last_activity_date": 1529565208, "last_edit_date": 1529565208, "creation_date": 1529521372, "answer_id": 50955330, "question_id": 50955093, "link": "https://stackoverflow.com/questions/50955093/c11-complexfloat-to-c-float-complex/50955330#50955330", "title": "C++11 complex&lt;float&gt;* to C float complex*", "body": "<p>This incompatibility is syntax only, both languages guarantee that their complex types have the same layout as a <code>float[2]</code> (or <code>double[2]</code> etc). So you could mediate between the two on having a macro <code>cfloat</code> that is defined according to the language in which it is expanded. Something along the lines of</p>\n\n<pre><code>#ifdef __cplusplus\ntypedef std::complex&lt;float&gt; cfloat;\n#else\ntypedef float _Complex cfloat;\n#endif\n</code></pre>\n\n<p>And then use this <code>cfloat</code> in all your function prototypes.</p>\n"}, {"comments": [{"owner": {"reputation": 1051, "user_id": 916046, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ac4f5c34b40b8626dbeb447d6d0b1bc8?s=128&d=identicon&r=PG&f=1", "display_name": "CompEng88", "link": "https://stackoverflow.com/users/916046/compeng88"}, "edited": false, "score": 0, "creation_date": 1529682494, "post_id": 50955357, "comment_id": 88977649, "body": "I&#39;ve tried this. Please see my edits. There&#39;s something up with my headers clashing because I get some syntax errors within the library I am using. The libraries header forces me to include &lt;complex.h&gt; and I have to include &lt;complex&gt; in my C++11 code. I think the problem is that I have to have both."}, {"owner": {"reputation": 1680, "user_id": 5282154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a468ae12f72b587ad0c4e89ffde11839?s=128&d=identicon&r=PG", "display_name": "doug", "link": "https://stackoverflow.com/users/5282154/doug"}, "reply_to_user": {"reputation": 1051, "user_id": 916046, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ac4f5c34b40b8626dbeb447d6d0b1bc8?s=128&d=identicon&r=PG&f=1", "display_name": "CompEng88", "link": "https://stackoverflow.com/users/916046/compeng88"}, "edited": false, "score": 0, "creation_date": 1529685522, "post_id": 50955357, "comment_id": 88979192, "body": "In your original post you said your older C library used <code>_Complex</code> which is how C works and now you have changed it to <code>complex</code> which will clash as well as undefined. Hard to help without a more complete example."}, {"owner": {"reputation": 1680, "user_id": 5282154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a468ae12f72b587ad0c4e89ffde11839?s=128&d=identicon&r=PG", "display_name": "doug", "link": "https://stackoverflow.com/users/5282154/doug"}, "reply_to_user": {"reputation": 1051, "user_id": 916046, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ac4f5c34b40b8626dbeb447d6d0b1bc8?s=128&d=identicon&r=PG&f=1", "display_name": "CompEng88", "link": "https://stackoverflow.com/users/916046/compeng88"}, "edited": false, "score": 0, "creation_date": 1529692469, "post_id": 50955357, "comment_id": 88982194, "body": "Check out this: <a href=\"https://stackoverflow.com/questions/23414270/c-complex-and-complex-h-in-the-same-file\" title=\"c complex and complex h in the same file\">stackoverflow.com/questions/23414270/&hellip;</a>   It goes into the necessary machinations to use &lt;complex.h&gt; and &lt;complex&gt; in the same translation unit. In particular the clash between <code>complex</code> and a macro defined in <code>&lt;complex.h&gt;</code>"}, {"owner": {"reputation": 1051, "user_id": 916046, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ac4f5c34b40b8626dbeb447d6d0b1bc8?s=128&d=identicon&r=PG&f=1", "display_name": "CompEng88", "link": "https://stackoverflow.com/users/916046/compeng88"}, "edited": false, "score": 0, "creation_date": 1529937778, "post_id": 50955357, "comment_id": 89044702, "body": "doug, thanks for the link. That provided <i>some</i> clarity. The problem is the functions in the header file for the library I am using. They all use &quot;float complex*&quot;  so &quot;#undef complex&quot; causes compilation errors for those function."}], "tags": [], "owner": {"reputation": 1680, "user_id": 5282154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a468ae12f72b587ad0c4e89ffde11839?s=128&d=identicon&r=PG", "display_name": "doug", "link": "https://stackoverflow.com/users/5282154/doug"}, "is_accepted": false, "score": 3, "last_activity_date": 1529714130, "last_edit_date": 1529714130, "creation_date": 1529521483, "answer_id": 50955357, "question_id": 50955093, "link": "https://stackoverflow.com/questions/50955093/c11-complexfloat-to-c-float-complex/50955357#50955357", "title": "C++11 complex&lt;float&gt;* to C float complex*", "body": "<p>It may be quite easy. <code>std::complex</code> defines the storage order of complex objects and provides ways to access the real and imaginary parts of arrays of complex objects. If the order is the same as in your older library you may be in luck</p>\n\n<p>From <a href=\"http://en.cppreference.com/w/cpp/numeric/complex\" rel=\"nofollow noreferrer\">http://en.cppreference.com/w/cpp/numeric/complex</a></p>\n\n<blockquote>\n  <p>For any object <code>z</code> of type <code>complex&lt;T&gt;</code>, <code>reinterpret_cast&lt;T(&amp;)[2]&gt;(z)[0]</code> is the real part of <code>z</code> and <code>reinterpret_cast&lt;T(&amp;)[2]&gt;(z)[1]</code> is the imaginary part of <code>z</code></p>\n</blockquote>\n\n<p>and</p>\n\n<blockquote>\n  <p>For any pointer to an element of an array of <code>complex&lt;T&gt;</code> named <code>p</code> and any valid array index <code>i</code>, <code>reinterpret_cast&lt;T*&gt;(p)[2*i]</code> is the real part of the complex number <code>p[i]</code>, and <code>reinterpret_cast&lt;T*&gt;(p)[2*i + 1]</code> is the imaginary part of the complex number <code>p[i]</code></p>\n</blockquote>\n\n<p>Thus you can refer to a C99 compatible <code>float _Complex *cx</code> simply.</p>\n\n<blockquote>\n  <p>`std::complex *cx1 = reinterpret_cast*> cx;</p>\n</blockquote>\n\n<p>Due to conflicts when including both <code>complex</code> and <code>complex.h</code> one approach is to pull out the basic declarations from the C header and include it in a \"C\" extern statement along with the used C function declarations like so:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;complex&gt;\n\nextern \"C\" {\n    // this is commented out because it is also declared in the c++ complex header\n    //typedef struct _C_float_complex\n    //{ /* float complex */\n    //    float _Val[2];\n    //} _C_float_complex;\n    typedef _C_float_complex _Fcomplex;\nvoid double_my_reals(_Fcomplex *pcx, int len);\n}\n\n\nint main()\n{\n    std::complex&lt;float&gt; cf[5]{ 1,2,3,4,5 };\n    for (auto x:cf)\n        std::cout &lt;&lt; x &lt;&lt; std::endl;\n    double_my_reals(reinterpret_cast&lt;_Fcomplex*&gt;(cf), 5);\n    for (auto x:cf)\n        std::cout &lt;&lt; x &lt;&lt; std::endl;\n}\n</code></pre>\n\n<p>This code is specific to Visual Studio C and C++. VSC is not compatible with C99 but the data structures are the same so you will need to pull out the specific declaration for a complex float in whatever C compiler is being used.</p>\n\n<p>And this would be an example of the called \"C\" code for VC.</p>\n\n<pre><code>#include &lt;complex.h&gt;\n\nvoid double_my_reals(_Fcomplex *pcx, int len)\n{\n    for (int i = 0; i &lt; len; i++)\n    {\n        pcx[i]._Val[0] *= 2.0f;\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 1051, "user_id": 916046, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ac4f5c34b40b8626dbeb447d6d0b1bc8?s=128&d=identicon&r=PG&f=1", "display_name": "CompEng88", "link": "https://stackoverflow.com/users/916046/compeng88"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2208, "favorite_count": 0, "closed_date": 1529560352, "answer_count": 2, "score": -6, "last_activity_date": 1609870611, "creation_date": 1529520349, "last_edit_date": 1609870611, "question_id": 50955093, "link": "https://stackoverflow.com/questions/50955093/c11-complexfloat-to-c-float-complex", "closed_reason": "Needs details or clarity", "title": "C++11 complex&lt;float&gt;* to C float complex*", "body": "<p>I have an array of complex floats that I'm working with in C++11:</p>\n<pre><code>std::complex&lt;float&gt; *cx;\n</code></pre>\n<p>I am trying to use an older library which takes in C style complex floats:</p>\n<pre><code>float complex *cx;\n</code></pre>\n<p>When I try this:</p>\n<pre><code>std::complex&lt;float&gt; *cpp = new std::complex&lt;float&gt;[100];\ncomplex float *c = reinterpret_cast&lt;complex float*&gt;(cpp);\nc_process(c); // c_process(complex float *c)    [ c library function ]\n</code></pre>\n<p>I get:</p>\n<pre><code>error: expected ';' before 'float'   \ncomplex float *c = reinterpret_cast&lt;complex float*&gt;(cpp);\n        ^\n</code></pre>\n<p>The problem is that the library <code>#includes &lt;complex.h&gt;</code> in its header and I have to include that header, and I have to <code>#include &lt;complex&gt;</code> in my C++11 code to use std::complex.</p>\n<p><code>class complex</code> from <code>&lt;complex&gt;</code> and <code>#define complex _Complex</code> from <code>&lt;complex.h&gt;</code> seem to be clashing on the word <code>complex</code>.</p>\n<p><strong>One Solution:</strong>\n<strong>This solution only works if you can modify the other library's headers.</strong></p>\n<p>Since the powers at be closed this question (although I think it's a pretty good), here's what I did:</p>\n<p>Since <code>&lt;complex.h&gt;</code> has a <code>#define complex _Complex</code> and <code>&lt;complex&gt;</code> contains a <code>class complex</code>, there is some conflict when including both headers.</p>\n<p>I had to change all <code>float complex*</code> to <code>float _Complex*</code> everywhere in my code and other library's header files. This removed the clash on the word <code>complex</code> from the cstyle &lt;complex.h&gt;'s define and c++ style's class complex without changing what the code does.</p>\n"}, {"tags": ["c", "operating-system", "signals"], "comments": [{"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 5, "creation_date": 1529520079, "post_id": 50955009, "comment_id": 88907657, "body": "who told you <code>continue</code> was bad practice? It&#39;s a tool in the toolbox just like the other features of the language."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 4, "creation_date": 1529520146, "post_id": 50955009, "comment_id": 88907690, "body": "You don&#39;t initialize <code>hasNotQuitted</code> before you first test it, so you&#39;ve no idea whether your loop will exit or not."}, {"owner": {"reputation": 360, "user_id": 5875805, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S4zBy.jpg?s=128&g=1", "display_name": "Tormund Giantsbane", "link": "https://stackoverflow.com/users/5875805/tormund-giantsbane"}, "edited": false, "score": 0, "creation_date": 1529520165, "post_id": 50955009, "comment_id": 88907706, "body": "You could remove it if you wanted and just put the rest of the loop in an <code>else{...}</code>? I think this is more readable though"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1529520499, "post_id": 50955009, "comment_id": 88907862, "body": "<code>enum Bool hasNotQuitted;</code> - this is a bad practice indeed. You have a standard <code>bool</code> type."}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 2, "creation_date": 1529520902, "post_id": 50955009, "comment_id": 88908052, "body": "but to answer your question, you need to change the logic of your <code>if</code> statement. All the stuff after the <code>continue</code> is what will execute if <code>isAlegalKey()</code> is true, so change <code>if (!isAlegalKey(c)) {</code> to <code>if (isAlegalKey(c)) {</code>, and what you replaced <code>continue</code> with will execute."}], "answers": [{"tags": [], "owner": {"reputation": 13, "user_id": 9596901, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fcd107195d40b92aa9b9ea47e727427?s=128&d=identicon&r=PG&f=1", "display_name": "Tyresius", "link": "https://stackoverflow.com/users/9596901/tyresius"}, "is_accepted": false, "score": 1, "last_activity_date": 1529521751, "creation_date": 1529521751, "answer_id": 50955414, "question_id": 50955009, "link": "https://stackoverflow.com/questions/50955009/continue-acting-weird/50955414#50955414", "title": "Continue acting weird?", "body": "<p>I would argue that the bad practice doesn't lie in the \"continue\" but rather in the use of the !isALegalKey construction. This is more readable/clear. </p>\n\n<pre><code>while (hasNotQuitted) {\n    c = getch();\n\n    if (isAlegalKey(c)) {\n        if(write(fd[1], &amp;c, 1) &lt; 0) {\n            sysCallFailureProcedure();\n        }\n        kill(pid, SIGUSR2);\n\n        if (c == QUIT_KEY) {\n            hasNotQuitted = false;\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 109, "user_id": 9837518, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d993923eb5784f74211b791d799bdef8?s=128&d=identicon&r=PG&f=1", "display_name": "elihar", "link": "https://stackoverflow.com/users/9837518/elihar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1529521751, "creation_date": 1529519975, "question_id": 50955009, "link": "https://stackoverflow.com/questions/50955009/continue-acting-weird", "title": "Continue acting weird?", "body": "<p>Iv'e encountered this code:</p>\n\n<pre><code>int main() {\n    int fd[2];\n    pipe(fd);\n    int pid;\n\n    if ((pid = fork()) &lt; 0) {\n        sysCallFailureProcedure();\n    }\n\n    if (pid == SON_PROCESS) {\n\n        dup2(fd[0], 0);\n        execlp(TETRIS_DISP_NAME, TETRIS_DISP_NAME, NULL);\n\n        sysCallFailureProcedure();\n    }\n\n    char c;\n    enum Bool hasNotQuitted;\n    while (hasNotQuitted) {\n        c = getch();\n        if (!isAlegalKey(c)) {\n            continue;\n        }\n        if(write(fd[1], &amp;c, 1) &lt; 0) {\n            sysCallFailureProcedure();\n        }\n        kill(pid, SIGUSR2);\n\n        if (c == QUIT_KEY) {\n            hasNotQuitted = false;\n        }\n    }\n\n    return OPERATION_SUCCEEDED;\n}\n</code></pre>\n\n<p>I'm trying to improve it and lose the continue statement (its a bad practice). But when I do,\nit causes my program to function not propetly, its a runner program for some kind of a tetris game. All I did is to replace the continue with this:</p>\n\n<pre><code>if(write(fd[1], &amp;c, 1) &lt; 0) {\n    sysCallFailureProcedure();\n}\nkill(pid, SIGUSR2);\n\nif (c == QUIT_KEY) {\n    hasNotQuitted = false;\n}\n</code></pre>\n\n<p>meaning the code that follows the continue.\nCan anyone tell me what did I miss?</p>\n"}, {"tags": ["java", "c", "algorithm"], "comments": [{"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 1, "creation_date": 1529520783, "post_id": 50954974, "comment_id": 88908003, "body": "How do you find that point in the haystack without looking at all the preceding characters?"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 1201812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2329be9e9727c4504899e14b13fd2ce0?s=128&d=identicon&r=PG", "display_name": "bjwg", "link": "https://stackoverflow.com/users/1201812/bjwg"}, "edited": false, "score": 0, "creation_date": 1529525124, "post_id": 50955325, "comment_id": 88909905, "body": "Yes, I fully understand your point of course. I&#39;m seeing the irony however that there is no real way to take advantage of a self-evident possibility of this kind - which the human eye can see and logic support, but which can&#39;t be implemented in code effectively. In tests nevertheless, timings for the algorithm I&#39;ve outlined are better in certain cases than the B-M equivalent."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "reply_to_user": {"reputation": 11, "user_id": 1201812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2329be9e9727c4504899e14b13fd2ce0?s=128&d=identicon&r=PG", "display_name": "bjwg", "link": "https://stackoverflow.com/users/1201812/bjwg"}, "edited": false, "score": 1, "creation_date": 1529537722, "post_id": 50955325, "comment_id": 88914122, "body": "@bjwg: That&#39;s highly dependent on how you code the two possibilities. But on the whole, a well-written Boyer-Moore is a big win. (I&#39;m not sure that its really a case of &quot;irony&quot;, but it is certainly true that complex parallel processing systems like human vision can sometimes outperform a computer. On the other, human vision suffers from optical illusions so all is not necessarily what it seems."}, {"owner": {"reputation": 11, "user_id": 1201812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2329be9e9727c4504899e14b13fd2ce0?s=128&d=identicon&r=PG", "display_name": "bjwg", "link": "https://stackoverflow.com/users/1201812/bjwg"}, "edited": false, "score": 0, "creation_date": 1529656652, "post_id": 50955325, "comment_id": 88962710, "body": "&lt;&lt;you would have to look at every character in the haystack until the end.&gt;&gt;. Right, although the search space decreases of course as the needle moves along the haystack. I&#39;d imagine that the relative &#39;rarity&#39; of the needle&#39;s character in the overall alphabet will also impact performance, so searching for an &#39;e&#39; would be more time-consuming than looking for a &#39;z&#39;."}], "tags": [], "owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "is_accepted": false, "score": 3, "last_activity_date": 1529521348, "creation_date": 1529521348, "answer_id": 50955325, "question_id": 50954974, "link": "https://stackoverflow.com/questions/50954974/boyer-moore-string-search-algorithm-starting-alignments/50955325#50955325", "title": "Boyer-Moore String Search algorithm starting alignments", "body": "<p>If you were to try to find the first <code>t</code> in the haystack (starting at the seventh character), you would have to look at every character in the haystack until the end.</p>\n\n<p>Boyer Moore finds the position with many fewer comparisons. For example, after comparing <code>t</code> with <code>e</code>, it can move forward five characters. So the next comparison will be between the <code>t</code> and the second last <code>a</code>, and that will lead to a displacement of two. So the correct alignment is found after just two comparisons instead of seven.</p>\n"}], "owner": {"reputation": 11, "user_id": 1201812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2329be9e9727c4504899e14b13fd2ce0?s=128&d=identicon&r=PG", "display_name": "bjwg", "link": "https://stackoverflow.com/users/1201812/bjwg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1529521348, "creation_date": 1529519804, "question_id": 50954974, "link": "https://stackoverflow.com/questions/50954974/boyer-moore-string-search-algorithm-starting-alignments", "title": "Boyer-Moore String Search algorithm starting alignments", "body": "<p>I'm not a professional programmer, so pls bear with me.\nI'm looking around for reasons as to why the initial 'alignment' of haystack and needle should not be made at the first congruence of the needle's last character with the same one in the haystack, <em>but at the earliest</em> that being sought at needle.length()-1, rather than enforcing a comparison at 'haystack.needle.length()-1' and 'needle.length()-1'  ?</p>\n\n<p>Example :-</p>\n\n<p>haystack : actuateaaaaaat</p>\n\n<p>needle   :   descant</p>\n\n<p>Above, everything before the final 't' in haystack can be completely ignored, in terms of shifts and comparisons theretofore.</p>\n"}, {"tags": ["c", "mplab"], "comments": [{"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 2, "creation_date": 1529519522, "post_id": 50954867, "comment_id": 88907397, "body": "What exactly is your question?  What have you tried so far?"}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 1, "creation_date": 1529519527, "post_id": 50954867, "comment_id": 88907401, "body": "So is the problem that you aren&#39;t initializing, and since they are const, you cannot set them after you&#39;ve created them?"}, {"owner": {"reputation": 113, "user_id": 6450588, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/686897ec2c0f9c6181a4c4a63f3f1e6a?s=128&d=identicon&r=PG&f=1", "display_name": "drs", "link": "https://stackoverflow.com/users/6450588/drs"}, "edited": false, "score": 1, "creation_date": 1529519672, "post_id": 50954867, "comment_id": 88907487, "body": "I&#39;m getting error a.c:119: error: (364) attempt to modify object qualified const a.c:123: warning: (358) illegal conversion of pointer to integer"}, {"owner": {"user_type": "does_not_exist", "display_name": "user3458"}, "edited": false, "score": 1, "creation_date": 1529519951, "post_id": 50954867, "comment_id": 88907599, "body": "Please edit the error message into your question. Please add the code that error is pointing at to your question. Please mark the exact line that&#39;s referred to as <code>a.c:123</code>"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1529519986, "post_id": 50954867, "comment_id": 88907614, "body": "<code>volatile</code> is in some ways the antithesis of &#39;constancy&#39;.  It says &quot;the value may change in ways the compiler cannot expect&quot;.  The <code>const</code> says &quot;the value cannot be changed via this name.  You&#39;ve not shown the lines where you&#39;re getting the error messages \u2014 nor should you; line 119 is too big to be an MCVE (<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>).  You should be able to get the line number down to about 20, and you can then show it.  Your <code>MenuRegister</code> must be initialized fully when it is created; it cannot be modified meaningfully (you can modify <code>DefaultValue</code> and <code>bytes</code>, in the <code>SetValues</code> union member, but that&#39;s all)."}, {"owner": {"user_type": "does_not_exist", "display_name": "user3458"}, "edited": false, "score": 0, "creation_date": 1529520025, "post_id": 50954867, "comment_id": 88907629, "body": "<i>I need to succeed minimum program and data memory</i> is, unfortunately, not clear at all. Please try stating your goal in a different way."}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1529520162, "post_id": 50954867, "comment_id": 88907703, "body": "@drs edit your error into the question."}, {"owner": {"reputation": 113, "user_id": 6450588, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/686897ec2c0f9c6181a4c4a63f3f1e6a?s=128&d=identicon&r=PG&f=1", "display_name": "drs", "link": "https://stackoverflow.com/users/6450588/drs"}, "edited": false, "score": 0, "creation_date": 1529520725, "post_id": 50954867, "comment_id": 88907971, "body": "I update question. I need to have static values and non static values in same typedef"}], "answers": [{"tags": [], "owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "is_accepted": false, "score": 3, "last_activity_date": 1529520960, "creation_date": 1529520960, "answer_id": 50955222, "question_id": 50954867, "link": "https://stackoverflow.com/questions/50954867/how-to-use-const-int-inside-typedef-struct/50955222#50955222", "title": "How to use const int inside typedef struct?", "body": "<p>The problem is that you cannot set these const-qualified values after instanciation.  You will need to initialize the const-qualified struct members upon creation.</p>\n\n<p>Perhaps like so (I simplified to an array of 2 because I wasn't gonna do that for 50 of 'em in an example):</p>\n\n<pre><code>MenuRegisters[2] = {\n   {.Name = {\"A\",\"B\"},\n    .Type=1,\n    .SetValues.DefaultValue=1,\n    .EppromLocation=1,\n    .Visible=true,\n    .NextID=1,\n    .PreviousID=1},\n   {.Name = {\"C\",\"D\"},\n    .Type=2,\n    .SetValues.DefaultValue=2,\n    .EppromLocation=2,\n    .Visible=true,\n    .NextID=2,\n    .PreviousID=2}}\n</code></pre>\n\n<p>Also want to note that <code>Visible</code> is not in the definition of <code>Parameters</code> you gave us.</p>\n"}], "owner": {"reputation": 113, "user_id": 6450588, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/686897ec2c0f9c6181a4c4a63f3f1e6a?s=128&d=identicon&r=PG&f=1", "display_name": "drs", "link": "https://stackoverflow.com/users/6450588/drs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 279, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1529522284, "creation_date": 1529519343, "last_edit_date": 1529522284, "question_id": 50954867, "link": "https://stackoverflow.com/questions/50954867/how-to-use-const-int-inside-typedef-struct", "title": "How to use const int inside typedef struct?", "body": "<p>I'm using 'const int' and 'char const * const', to inform  compiler that my value will never change. I need to succeed minimum program and data memory. </p>\n\n<pre><code>   typedef struct{\n         char const * const   Name[2];\n         const int  MaxValue;\n         const int  MinValue;\n         const int  Type;\n         const int  EppromLocation;\n         const int  NextID;\n         const int  PreviousID;\n\n      union{ \n      unsigned int DefaultValue;\n      unsigned char bytes[2];\n      }SetValues;\n\n   } Parameters;\n\n  extern volatile  Parameters MenuRegister[50];\n</code></pre>\n\n<p>I'm getting errors:</p>\n\n<pre><code>a.c:119: error: (364) attempt to modify object qualified const\na.c:123: warning: (358) illegal conversion of pointer to integer \n</code></pre>\n\n<p>the error is showing in my source file</p>\n\n<pre><code> MenuRegister[0].Name[0]=\"A\";\n MenuRegister[0].Type=1;\n MenuRegister[0].SetValues.DefaultValue=1;\n MenuRegister[0].EppromLocation=1;\n MenuRegister[0].Visible=true;\n MenuRegister[0].NextID=1;\n MenuRegister[0].PreviousID=1;\n MenuRegister[0].MaxValue=1;\n</code></pre>\n"}, {"tags": ["c++", "c", "lua", "stack"], "answers": [{"comments": [{"owner": {"reputation": 422, "user_id": 9922866, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-OSxxbkIUZrA/AAAAAAAAAAI/AAAAAAAAADU/tiPj589rmBE/photo.jpg?sz=128", "display_name": "Personage", "link": "https://stackoverflow.com/users/9922866/personage"}, "edited": false, "score": 0, "creation_date": 1529520119, "post_id": 50954232, "comment_id": 88907678, "body": "Thank you for the excellent answer. As far as raising an error in the event of too many or too few arguments being passed, would <code>luaL_error</code> also be appropriate?"}, {"owner": {"reputation": 1476, "user_id": 9383219, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97fabe5d903589acb1dfdf17fe4e405e?s=128&d=identicon&r=PG&f=1", "display_name": "cyclaminist", "link": "https://stackoverflow.com/users/9383219/cyclaminist"}, "edited": false, "score": 1, "creation_date": 1529797291, "post_id": 50954232, "comment_id": 89005184, "body": "<code>luaL_error</code> (and <code>luaL_argerror</code>) both call <code>lua_error</code>, but provide extra functionality that is sometimes useful, so you can use whichever one suits your purposes."}], "tags": [], "owner": {"reputation": 374839, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "is_accepted": true, "score": 3, "last_activity_date": 1529516886, "creation_date": 1529516886, "answer_id": 50954232, "question_id": 50954049, "link": "https://stackoverflow.com/questions/50954049/can-i-guarantee-the-size-of-the-lua-stack/50954232#50954232", "title": "Can I guarantee the size of the Lua stack?", "body": "<p>If you have directly registered a function to Lua, and a Lua script calls that function with N arguments, then that function will have N values on the stack when it gets called. That's how it works, and no process can interfere with this (well, you could <em>manually</em> call that function from C with an improper <code>lua_State</code>, but that's your fault).</p>\n\n<p>So long as you don't do any stack manipulation between the start of that function and whatever you use to check the current stack size, then your test will be accurate.</p>\n\n<p>Every Lua function is well-documented in how (or if) it manipulates the stack. Whether it inserts values to the stack, removes them from the stack, and so forth.</p>\n\n<p>That being said, <code>assert</code> is probably the wrong tool. If the user provides the wrong number of parameters, and you consider that erroneous behavior, you should invoke <code>lua_error</code>. And not just on debug builds.</p>\n"}], "owner": {"reputation": 422, "user_id": 9922866, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-OSxxbkIUZrA/AAAAAAAAAAI/AAAAAAAAADU/tiPj589rmBE/photo.jpg?sz=128", "display_name": "Personage", "link": "https://stackoverflow.com/users/9922866/personage"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 659, "favorite_count": 0, "accepted_answer_id": 50954232, "answer_count": 1, "score": 2, "last_activity_date": 1529516886, "creation_date": 1529516230, "question_id": 50954049, "link": "https://stackoverflow.com/questions/50954049/can-i-guarantee-the-size-of-the-lua-stack", "title": "Can I guarantee the size of the Lua stack?", "body": "<p>I am using the Lua API for C/C++ to create functions in C/C++ and then register them for use in Lua scripts. Obviously these functions expect a certain number of arguments with specific types, which is no problem in C/C++ because of static typing. However, given that Lua is dynamic, I need to manually check the number of arguments passed and their types when I call this C-function from Lua. These arguments are pushed onto the Lua stack, so I can check the number of arguments with <code>lua_gettop</code> and then check their individual types with <code>lua_type</code>.</p>\n\n<p>My question, though, is can I guarantee the number of elements on the stack, that is, the number of arguments passed to my function? That way, I could check this at the beginning of my C-function with an assertion: <code>assert(lua_gettop(L) == x)</code>, with <code>x</code> just being a placeholder for the desired number of arguments and <code>L</code> being a <code>lua_State*</code>. This extends a little deeper, as I wonder if other functions that interact with the Lua stack clean up so that the stack is empty when I call this function; otherwise, if some things were left sitting on the stack from a previous function call, the assertion would fail. Below is a simple example.</p>\n\n<p>C/C++ code:</p>\n\n<pre><code>int foo(lua_State* L) {\n    assert(lua_gettop(L) == 2);\n\n    // do stuff\n\n    return 1;\n}\n</code></pre>\n\n<p>Calling the function in Lua. Assume that the function expects two strings as arguments; thus, the first call would succeed and the second would fail.</p>\n\n<pre><code>foo(\"hello\", \"world\")\nfoo(\"hello\", \"world\", 1)\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1529516287, "post_id": 50954024, "comment_id": 88905861, "body": "Both variables are pointers and have no string content. So with <code>cmd = TOKEN</code> which copies the pointer, to point to the same string literal."}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1529516340, "post_id": 50954024, "comment_id": 88905883, "body": "You cannot &quot;assign&quot; a string in such a manner.  You will need to create a buffer to hold your string and then use string functions such as <code>strcpy</code> or <code>strcat</code> to copy a string into your buffer (careful with <code>strcat</code> as it usually results in Shlemiel The Painter algorithms)"}, {"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 1, "creation_date": 1529516353, "post_id": 50954024, "comment_id": 88905892, "body": "You need to find a good tutorial on pointers.  5 seconds of google on C pointer tutorial gives lots of hits.  Sorry, this isn&#39;t Python :)"}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 4, "creation_date": 1529516410, "post_id": 50954024, "comment_id": 88905936, "body": "You can use something like <code>snprintf(cmdbuf, cmdbufsize, &quot;some_cmd --auth-token=%s&quot;, TOKEN)</code>.  But <code>cmdbuf</code> has to be a properly-allocated array of sufficient size."}, {"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 0, "creation_date": 1529517261, "post_id": 50954024, "comment_id": 88906359, "body": "You&#39;ll also need to find a good tutorial on C operators. <code>cmd = &quot;some_cmd --auth-token=%s&quot;, TOKEN;</code> assigns the pointer in <code>TOKEN</code> to <code>cmd</code>. The string prior to the comma does nothing in this context. In some languages the comma concatenates strings. Not in C."}, {"owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "edited": false, "score": 1, "creation_date": 1529517792, "post_id": 50954024, "comment_id": 88906588, "body": "Do you actually need to <i>store</i> the value of <code>TOKEN</code> in <code>cmd</code>, or do you just need to display it via <code>printf</code>?  If the latter, you could simply write <code>printf( cmd, TOKEN );</code>"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1529518112, "post_id": 50954024, "comment_id": 88906726, "body": "What do you think <code>cmd = &quot;some_cmd --auth-token=%s&quot;, TOKEN;</code> does? Look up the <b>comma operator</b>. Here you simply assign <code>cmd = &quot;some_cmd --auth-token=%s&quot;;</code> and then there is a dangling <code>TOKEN</code> statement at the end that does nothing. Then you call to <code>printf(cmd)</code> (missing <code>&#39;;&#39;</code>) attempt to print with the format <code>&quot;some_cmd --auth-token=%s&quot;</code> but with 1 too few arguments invoking undefined behavior."}], "answers": [{"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 0, "last_activity_date": 1529518080, "creation_date": 1529518080, "answer_id": 50954550, "question_id": 50954024, "link": "https://stackoverflow.com/questions/50954024/c-how-to-reference-variables-in-other-variables/50954550#50954550", "title": "C how to reference variables in other variables", "body": "<blockquote>\n  <p>How can I assign the value of to <code>TOKEN</code> to another variable <code>cmd</code></p>\n</blockquote>\n\n<p>Providing that the types of <code>TOKEN</code> and <code>cmd</code> permit it, one can assign the value of the former to the latter via the assignment operator, <code>=</code>.  In your code, the types of those variables <em>do</em> permit it, but what you seem actually to be trying to do is something different.</p>\n\n<p>It looks like you were hoping this sequence of statements ...</p>\n\n<pre><code>TOKEN = \"some auth token\";\ncmd = \"some_cmd --auth-token=%s\", TOKEN;\nprintf(cmd);\n</code></pre>\n\n<p>(missing semicolon added) would have the same effect as this ...</p>\n\n<pre><code>TOKEN = \"some auth token\";\nprintf(\"some_cmd --auth-token=%s\", TOKEN);\n</code></pre>\n\n<p>..., but C doesn't work like that.  Variables have values.  Values may be composite, comprising other values, but they cannot contain <em>variables</em>.</p>\n\n<p>More generally, variables cannot contain C code (that is intended to be interpreted as such where the variable's name appears).  The C preprocessor does, however, have a <em>macro</em> facility that serves that purpose.  Macros are not variables, and in particular, they have no separate representation in a compiled program.  Their full effect is realized at compile time.  But that's exactly what you need for something that represents C code.</p>\n\n<p>In your case, then, you might do this:</p>\n\n<pre><code>#define COMMAND_WITH_TOKEN \"some_cmd --auth-token=%s\", token\n\nint main () {\n    const char *token;\n\n    token = \"some auth token\";\n    printf(COMMAND_WITH_TOKEN);\n}\n</code></pre>\n\n<p>That has precisely the same meaning as:</p>\n\n<pre><code>int main () {\n    const char *token;\n\n    token = \"some auth token\";\n    printf(\"some_cmd --auth-token=%s\", token);\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "is_accepted": true, "score": 0, "last_activity_date": 1529518369, "creation_date": 1529518369, "answer_id": 50954631, "question_id": 50954024, "link": "https://stackoverflow.com/questions/50954024/c-how-to-reference-variables-in-other-variables/50954631#50954631", "title": "C how to reference variables in other variables", "body": "<p>Beware, there are two kinds of <em>intructions</em> in a C source file. Macros or other prerpocessor directives that are executed before actual compilation and true C expressions that are compiled after that preprocessing.</p>\n\n<p>C is a rather low-level language, so variables have a type and can only contain a value of that type: here <code>cmd</code> is a pointer to char and can only contain... a pointer to a char (the only magic is that a null terminated char array is interpreted as a string by many functions of the standard library.</p>\n\n<p>So in this line:</p>\n\n<pre><code>cmd = \"some_cmd --auth-token=%s\", TOKEN;\n</code></pre>\n\n<p>the compiler sees some variables (<code>cmd</code> and <code>TOKEN</code>), a string litteral (<code>\"some_cmd --auth-token=%s\"</code>) an assignment operator (<code>=</code>) and a comma operator (<code>,</code>). First the parameters of the comma operator are evaluated: <code>\"some_cmd --auth-token=%s\"</code> decays to a pointer to its first character, <code>TOKEN</code> is evaluated to its value (it is a mere pointer) Then the comma operator is executed and the value of the expression becomes the value of the right member of the comma, here <code>TOKEN</code>. Finally, the assignment <code>cmd = TOKEN;</code> is executed. So it works perfectly but and does what you have asked, but it may not be what you wanted because in next line you try to print an uninitialized char pointer...</p>\n\n<p>You have to possible ways:</p>\n\n<ol>\n<li><p>a macro:</p>\n\n<pre><code>int main () {\n\n    const char *TOKEN;\n\n    TOKEN = \"some auth token\";\n#define CMD \"some_cmd --auth-token=%s\", TOKEN\n    printf(CMD);\n}\n</code></pre>\n\n<p>The preprocessing changes this to:</p>\n\n<pre><code>int main () {\n\n    const char *TOKEN;\n\n    TOKEN = \"some auth token\";\n    printf(\"some_cmd --auth-token=%s\", TOKEN);\n}\n</code></pre>\n\n<p>which will gives expected result</p></li>\n<li><p>the sprintf function:</p>\n\n<pre><code>int main () {\n\n    const char *TOKEN;\n    char *cmd;\n\n    TOKEN = \"some auth token\";\n    cmd = malloc(strlen(TOKEN) + sizeof(\"some_cmd --auth-token=%s\") + 1;\n    sprintf(cmd, \"some_cmd --auth-token=%s\", TOKEN);\n    printf(cmd);\n    free(cmd);\n}\n</code></pre></li>\n</ol>\n"}], "owner": {"reputation": 403, "user_id": 6037143, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/2fdfb6bc13be9e0e471d29125f70612f?s=128&d=identicon&r=PG&f=1", "display_name": "user6037143", "link": "https://stackoverflow.com/users/6037143/user6037143"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 50954631, "answer_count": 2, "score": 0, "last_activity_date": 1529518369, "creation_date": 1529516153, "question_id": 50954024, "link": "https://stackoverflow.com/questions/50954024/c-how-to-reference-variables-in-other-variables", "title": "C how to reference variables in other variables", "body": "<p>I am fairly new to C and I haven't been able to figure how I can reference variables in other variables.</p>\n\n<pre><code>int main () {\n\n    const char *TOKEN;\n    char *cmd;\n\n    TOKEN = \"some auth token\";\n    cmd = \"some_cmd --auth-token=%s\", TOKEN;\n    printf(cmd)\n}\n</code></pre>\n\n<p>This apparently doesn't work. How can I assign the value of to <code>TOKEN</code> to another variable <code>cmd</code> </p>\n"}, {"tags": ["c", "linux"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1529515886, "post_id": 50953901, "comment_id": 88905661, "body": "The single quotes represent an <code>int</code> value."}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1529515939, "post_id": 50953901, "comment_id": 88905694, "body": "<code>printf(buffer)</code> is interpreting buffer as a format string. To print the actual contents of the string, use <code>printf(&quot;%s\\n&quot;, buffer)</code>. That will tell you what the shell actually passed in. Then read up on shell quoting rules to figure out why."}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1529515969, "post_id": 50953901, "comment_id": 88905711, "body": "@WeatherVane Perhaps if they were in the C program, but this appears to be from the commandline, so most likely we&#39;re dealing with bash"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1529516051, "post_id": 50953901, "comment_id": 88905758, "body": "@ChristianGibbons yes of course - but it is a common misconception that <code>&#39;A&#39;</code> is <code>char</code> type."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1529516219, "post_id": 50953901, "comment_id": 88905833, "body": "Rule 1: Never pass a string-valued variable (such as <code>argv[1]</code>, here copied to the intermediate variable <code>buffer</code>) as the first argument to <code>printf</code>.  You can&#39;t tell how it will behave, since it might contain <code>%</code> characters, and if it does, <code>printf</code> will try to fetch additional arguments, which you probably didn&#39;t provide.  If you want to print an arbitrary string with <code>printf</code>, always use something like <code>printf(&quot;%s\\n&quot;, buffer)</code>."}, {"owner": {"reputation": 5768, "user_id": 3088572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/769f723b0fd6eb8c99d5f65b39392b18?s=128&d=identicon&r=PG&f=1", "display_name": "alvits", "link": "https://stackoverflow.com/users/3088572/alvits"}, "edited": false, "score": 0, "creation_date": 1529516519, "post_id": 50953901, "comment_id": 88905985, "body": "In any bourne or korn shells, quotes are treated differently. Inside a double quote, <code>$p</code> will be treated as a variable but inside a single quote they are literal <code>$</code> and <code>p</code>."}, {"owner": {"reputation": 5768, "user_id": 3088572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/769f723b0fd6eb8c99d5f65b39392b18?s=128&d=identicon&r=PG&f=1", "display_name": "alvits", "link": "https://stackoverflow.com/users/3088572/alvits"}, "reply_to_user": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1529517040, "post_id": 50953901, "comment_id": 88906244, "body": "In summary <code>printf(&quot;AAAA%6&quot;);</code> and <code>printf(&quot;AAAA%6$p&quot;);</code> will have different output. Using string formatter will show the obvious difference. As @SteveSummit has mentioned, the string buffer is used as formatter."}], "answers": [{"tags": [], "owner": {"reputation": 76206, "user_id": 108205, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ef459127edc89cc575d80a73cd8c567a?s=128&d=identicon&r=PG", "display_name": "jsbueno", "link": "https://stackoverflow.com/users/108205/jsbueno"}, "is_accepted": false, "score": 2, "last_activity_date": 1529515930, "creation_date": 1529515930, "answer_id": 50953977, "question_id": 50953901, "link": "https://stackoverflow.com/questions/50953901/output-variation-in-linux/50953977#50953977", "title": "Output variation in lInux", "body": "<p>This has to do on how the shell expand the  <code>$p</code> variable for double and single quoted strings, and has nothing to do with your program:</p>\n\n<pre><code>[gwidion@powergrid ~]$ export p=\"0x4141\"\n[gwidion@powergrid ~]$ echo \"$p\"\n0x4141\n[gwidion@powergrid ~]$ echo '$p'\n$p\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 7841051, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-D69vvR7KuzU/AAAAAAAAAAI/AAAAAAAAACI/hH0zR3nl8NE/photo.jpg?sz=128", "display_name": "ABHISHEK SRIVASTAVA", "link": "https://stackoverflow.com/users/7841051/abhishek-srivastava"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1529515930, "creation_date": 1529515650, "question_id": 50953901, "link": "https://stackoverflow.com/questions/50953901/output-variation-in-linux", "title": "Output variation in lInux", "body": "<p>In the following program when I pass the argument - \"AAAA%6$p\" - my output is - AAAA - but when I pass the argument - 'AAAA%6$p' the output shows - AAAA0x41414141 -. My question is how does the quotes make a difference in the output as the single quotes only represent a character. I need an explanation for the different output.\nPS: I'm using Linux 32 bit varient.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n\nint main(int argc, char** argv) {\n\n    char buffer[100];\n    strncpy(buffer, argv[1], 100);\n    printf(buffer);\n\n return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "grpc"], "answers": [{"tags": [], "owner": {"reputation": 252, "user_id": 9493141, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-G-OfrYsO6AI/AAAAAAAAAAI/AAAAAAAAA6E/fPWsafxbluw/photo.jpg?sz=128", "display_name": "Yash Tibrewal", "link": "https://stackoverflow.com/users/9493141/yash-tibrewal"}, "is_accepted": false, "score": 3, "last_activity_date": 1529520408, "creation_date": 1529520408, "answer_id": 50955104, "question_id": 50953651, "link": "https://stackoverflow.com/questions/50953651/how-to-write-a-grpc-client-server-in-c/50955104#50955104", "title": "How to write a gRPC client/server in C?", "body": "<p>If you are using the gRPC core library directly, then you will need to perform your own serialization, and deal with low level operations documented in  <a href=\"https://github.com/grpc/grpc/blob/master/include/grpc/impl/codegen/grpc_types.h\" rel=\"nofollow noreferrer\">https://github.com/grpc/grpc/blob/master/include/grpc/impl/codegen/grpc_types.h</a>.</p>\n\n<p>If you have any specific questions, we will be happy to help, but if this is just a one-time thing it might be easier to just solve the version incompatibility problem, or maybe simply wrap the C++ implementation with a C interface.</p>\n"}], "owner": {"reputation": 61, "user_id": 9525326, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/221d0a7cea4ddafd81665752bcbd52c1?s=128&d=identicon&r=PG&f=1", "display_name": "cyanbreak", "link": "https://stackoverflow.com/users/9525326/cyanbreak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4704, "favorite_count": 0, "answer_count": 1, "score": 5, "last_activity_date": 1529520408, "creation_date": 1529514690, "question_id": 50953651, "link": "https://stackoverflow.com/questions/50953651/how-to-write-a-grpc-client-server-in-c", "title": "How to write a gRPC client/server in C?", "body": "<p>I have a program written in C and want to include gRPC in it. However, the API for gRPC is written in C++. </p>\n\n<p>I've looked here and got the foo_client and foo_server working. \n<a href=\"https://github.com/Juniper/grpc-c/tree/master/examples\" rel=\"noreferrer\">https://github.com/Juniper/grpc-c/tree/master/examples</a></p>\n\n<p>However, the C client is not compatible with my gRPC C++ server. They will not talk to each other. I believe it is because I am using the lates gRPC which uses protocbuf version 3.2.0. And Juniper's grpc-c is using an older version of gRPC that uses protocbuf version 3.0.0.</p>\n\n<p>So the Juniper version in C doesn't seem to work with the new gRPC. I know the gRPC low level C API is supposed to be here: <a href=\"https://github.com/grpc/grpc/blob/master/include/grpc/grpc.h\" rel=\"noreferrer\">https://github.com/grpc/grpc/blob/master/include/grpc/grpc.h</a> \nBut I'm having difficulty implementing it. Can anyone help me make sense of it?</p>\n\n<p>I haven't programmed in C in awhile so I'm a little rusty.</p>\n"}, {"tags": ["c", "makefile", "c-preprocessor", "openwrt"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1529514393, "post_id": 50953309, "comment_id": 88904849, "body": "Try without <code>\\&quot;</code> ? Maybe the <code>CONFIG_VENDOR_PREFIX</code> is already a string."}, {"owner": {"reputation": 1108, "user_id": 1934741, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/b9fcef56e9894bc4ef3c2ee71921ef6a?s=128&d=identicon&r=PG", "display_name": "Kallel Omar", "link": "https://stackoverflow.com/users/1934741/kallel-omar"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1529514836, "post_id": 50953309, "comment_id": 88905106, "body": "@EugeneSh. no it doesn&#39;t work. Same issue"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1529517281, "post_id": 50953309, "comment_id": 88906366, "body": "Well, you can probably work around it by <code>#define STR(x)    #x</code> and then <code>STR(CUSTOM_PREFIX)</code>. But it won&#39;t explain why this is not working."}, {"owner": {"reputation": 1108, "user_id": 1934741, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/b9fcef56e9894bc4ef3c2ee71921ef6a?s=128&d=identicon&r=PG", "display_name": "Kallel Omar", "link": "https://stackoverflow.com/users/1934741/kallel-omar"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1529571054, "post_id": 50953309, "comment_id": 88925054, "body": "@EugeneSh. if I use your suggestion, good, I don&#39;t get a compilation error. But I don&#39;t get good result in the execution. because in c code the structure initiate will be struct parameter_struct param1= {STR(CUSTOM_PREFIX)&quot;param1&quot;, 4}; so I get as string &quot;CUSTOM_PREFIXparam1&quot; but I want it X_CUSTOM1_SE_param1"}], "answers": [{"tags": [], "owner": {"reputation": 1108, "user_id": 1934741, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/b9fcef56e9894bc4ef3c2ee71921ef6a?s=128&d=identicon&r=PG", "display_name": "Kallel Omar", "link": "https://stackoverflow.com/users/1934741/kallel-omar"}, "is_accepted": false, "score": 1, "last_activity_date": 1529573797, "creation_date": 1529573797, "answer_id": 50965255, "question_id": 50953309, "link": "https://stackoverflow.com/questions/50953309/macro-wrongly-defined-in-makefile-of-openwrt-package/50965255#50965255", "title": "Macro wrongly defined in Makefile of Openwrt package", "body": "<p>As I expected and I noted in the my post title the mistake is in the definition of the macro in the Makefile. In Openwrt Makefile the definition of the Macro should be like that:</p>\n\n<pre><code>TARGET_CFLAGS += -DCUSTOM_PREFIX=\\\\\\\"$(CONFIG_VENDOR_PREFIX)\\\\\\\"\n</code></pre>\n"}], "owner": {"reputation": 1108, "user_id": 1934741, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/b9fcef56e9894bc4ef3c2ee71921ef6a?s=128&d=identicon&r=PG", "display_name": "Kallel Omar", "link": "https://stackoverflow.com/users/1934741/kallel-omar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 219, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1529573797, "creation_date": 1529513289, "question_id": 50953309, "link": "https://stackoverflow.com/questions/50953309/macro-wrongly-defined-in-makefile-of-openwrt-package", "title": "Macro wrongly defined in Makefile of Openwrt package", "body": "<p>In the openwrt package that I'm working on, I defined a new config flag by adding following bloc to the Config.in file:</p>\n\n<pre><code>config VENDOR_PREFIX\n    string \"Vendor Prefix\"\n    default \"X_Custom_SE_\"\n</code></pre>\n\n<p>The flag is well added in the menuconfig:</p>\n\n<p><a href=\"https://i.stack.imgur.com/mw0ba.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/mw0ba.png\" alt=\"enter image description here\"></a></p>\n\n<p>I want that the value of this config flag is viewed in my C code as a macro. So I defined a macro CUSTOM_PREFIX  in the Makefile of the package and assigned to it the value of the defined flag with this way:</p>\n\n<pre><code>TARGET_CFLAGS += -DCUSTOM_PREFIX=\\\"$(CONFIG_VENDOR_PREFIX)\\\"\n</code></pre>\n\n<p>and then I tried to use my macro in my C code by calling it in a structure variable initiation like that:</p>\n\n<pre><code>struct parameter_struct param1= {CUSTOM_PREFIX\"param1\", 4};\n</code></pre>\n\n<p>After that I tried to compile it. But I got this compilation error:</p>\n\n<pre><code>/home/user/openwrt//staging_dir/toolchain-mips_mips32_gcc-5.5.0_musl/usr/include -I/home/user/openwrt/staging_dir/toolchain-mips_mips32_gcc-5.5.0_musl/include/fortify -I/home/user/openwrt/staging_dir/toolchain-mips_mips32_gcc-5.5.0_musl/include -I/home/user/openwrt/staging_dir/target-mips_mips32_musl/usr/include -I/home/user/openwrt/staging_dir/target-mips_mips32_musl/usr/include -I/home/user/openwrt/staging_dir/target-mips_mips32_musl/usr/include -DCWMP_VERSION=\\\"3.0.0\\\" -I../inc/ -I../dm/ -I../dm/dmtree/ -I../dm/dmtree/common -I../dm/dmtree/tr098 -I../dm/dmtree/tr181 -I../dm/dmtree/upnp -Os -pipe -mips32 -mtune=mips32 -fno-caller-saves -DCONFIG_TARGET_iopsys_brcm63xx_mips -g3 -fno-caller-saves -fno-plt -fhonour-copts -Wno-error=unused-but-set-variable -Wno-error=unused-result -msoft-float -iremap/home/user/openwrt/build_dir/target-mips_mips32_musl/icwmp-curl/icwmp-4.0-2018-03-21:icwmp-4.0-2018-03-21 -Wformat -Werror=format-security -fstack-protector -D_FORTIFY_SOURCE=1 -Wl,-z,now -Wl,-z,relro -DCUSTOM_PREFIX=X_CUSTOM1_SE_ -D_GNU_SOURCE -D_AADJ -MT ../dm/dmtree/common/libdatamodel_la-deviceinfo.lo -MD -MP -MF ../dm/dmtree/common/.deps/libdatamodel_la-deviceinfo.Tpo -c ../dm/dmtree/common/deviceinfo.c  -fPIC -DPIC -o ../dm/dmtree/common/.libs/libdatamodel_la-deviceinfo.o\n                 ^\n../dm/dmtree/common/deviceinfo.c: At top level:\n&lt;command-line&gt;:0:15: error: 'X_CUSTOM1_SE_' undeclared here (not in a function)\n../dm/dmtree/common/deviceinfo.c:28:2: note: in expansion of macro 'CUSTOM_PREFIX'\n {CUSTOM_PREFIX\"param1\", 4}\n</code></pre>\n\n<p>struct parameter_struct param1= {CUSTOM_PREFIX\"param1\", 4};\nseems like that the c program doesn't accept it as a string.\nIs there something wrong in my macro definition?</p>\n"}, {"tags": ["c", "process", "signals", "kill-process"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 2, "creation_date": 1529513437, "post_id": 50953279, "comment_id": 88904339, "body": "You should read the command line in the parent process, not the child. If they type <code>q</code> you return, otherwise you fork and execute the command."}, {"owner": {"reputation": 101, "user_id": 9914548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e47916896bfd1434892dd1f6fc3e9c47?s=128&d=identicon&r=PG&f=1", "display_name": "feded", "link": "https://stackoverflow.com/users/9914548/feded"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1529513779, "post_id": 50953279, "comment_id": 88904527, "body": "@Barmar it&#39;s a good solution but I need to know if is possible to kill the child and set its termination state to a non-zero value recoverable with wait()."}], "answers": [{"comments": [{"owner": {"reputation": 101, "user_id": 9914548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e47916896bfd1434892dd1f6fc3e9c47?s=128&d=identicon&r=PG&f=1", "display_name": "feded", "link": "https://stackoverflow.com/users/9914548/feded"}, "edited": false, "score": 0, "creation_date": 1529514920, "post_id": 50953492, "comment_id": 88905145, "body": "Yes I forgot to handle with WIFEXITED.Thanks it works! You and @Barmar &#39;ve right I should handle from the parent but in this case I needed to understand how handle signals in this way. Thank you very much."}], "tags": [], "owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "is_accepted": false, "score": 3, "last_activity_date": 1529514057, "creation_date": 1529514057, "answer_id": 50953492, "question_id": 50953279, "link": "https://stackoverflow.com/questions/50953279/how-to-set-status-termination-of-a-process-c/50953492#50953492", "title": "How to set status termination of a process C?", "body": "<p>You're printing out <code>WEXITSTATUS()</code> for all cases, but that isn't right. You need to check if the status returned by <code>wait</code> is an exit status or not using <code>WIFEXITED()</code>. If it's non-zero then the child exited normally. Otherwise, you can use <code>WIFSIGNALED()</code> to see if the child was terminated and you'll get the signal from <code>WTERMSIG()</code></p>\n\n<pre><code>if(WIFEXITED(status))\n  {\n  printf(\"end current process (status=%d, child=%d)\\n\", WEXITSTATUS(status), son);\n  }\nelse if(WIFSIGNALED(status))\n  {\n  printf(\"end current process (signal=%d, child=%d)\\n\", WTERMSIG(status), son);\n  }\n</code></pre>\n\n<p>You really should have the parent process handle the inputting of the command and leave the child process to run it though.</p>\n"}], "owner": {"reputation": 101, "user_id": 9914548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e47916896bfd1434892dd1f6fc3e9c47?s=128&d=identicon&r=PG&f=1", "display_name": "feded", "link": "https://stackoverflow.com/users/9914548/feded"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1553, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1529514057, "creation_date": 1529513145, "last_edit_date": 1529513525, "question_id": 50953279, "link": "https://stackoverflow.com/questions/50953279/how-to-set-status-termination-of-a-process-c", "title": "How to set status termination of a process C?", "body": "<p>My program is a rudimental little shell.\nIt allow you to run programs in PATH as ls, cd..also with arguments.\nTo run the program type from terminal \"./myshell2\" then it starts and you can insert how many commands you want.</p>\n\n<p>It starts a child process, runs execvp,it returns and restarts so you can type a new command.\nWhen typed \"Q\" or \"q\" all the entire program should terminates.\nThe problem is that I don't know how to stop it,the code is below.\nMy idea is, when typed \"Q\" or \"q\", to kill the child process created and send a signal to comunicate its bad termination(of child process).\nSo the final status(from parent) 'll be not 1 and the function returns.\nI commented some parts of the code hoping that it's easier to understand.\nIt works the problem is that to stop it I need of ctrl C.\nI would like to say to child process that he must ends with a non-zero value.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/wait.h&gt;\n#include &lt;string.h&gt;\n#include &lt;signal.h&gt;\n\nint main(int argc, char * argv[]) {\nwhile(1)\n{\n    pid_t pid = fork();\n\n    if (pid == -1) {\n        perror(\"fork error\");\n        exit(EXIT_FAILURE);\n    }\n\n    if (pid == 0) { // child process\n        printf(\"type the command to start (and arguments if required) \\n\"\n            \"Q to quit\\n\");\n        char *dest[10]; // allow you to insert\n        char line[4096];//commands from terminal\n        if (fgets(line,sizeof(line),stdin)==0) return 1;\n        int i;\n        line[strcspn(line, \"\\n\")] = '\\0';  \n        char *st = line;\n        for (i=0; i&lt; 10 &amp;&amp; (dest[i]=strsep(&amp;st,\" \"))!=NULL;i++)\n            continue;//now you typed the command\n        if ( ( memcmp(dest[0],\"Q\",1)==0 ) // if Q or q the program\n             || (memcmp(dest[0],\"q\",1)==0) ) //must end\n        {\n            printf(\"got it!\\n\");\n            if (kill(getpid(),SIGSEGV)==-1) printf(\"kill error\\n\");\n            //in theory the process should terminates with bad status\n            // and the value of the variable \"status\" 'll be not 0\n           // I think that the problem is in this part of the code\n        }\n\n\n        if( strcmp(dest[0],\" \")!=0 )\n        {\n            int res = execvp(dest[0], dest);    \n         }\n        else\n            { int res= execvp(dest[1],dest+1);}\n\n       perror(\"execvp error\");\n       exit(EXIT_FAILURE);\n    }\n\n    int status;\n    pid_t child = wait(&amp;status);\n\n    if (child == -1) {\n        perror(\"wait error\");\n     exit(EXIT_FAILURE);\n    }\n    if (status==1)\n        break; //so it can exit from the loop that creates new process\n    setenv(\"WAIT\",\"TRUE\",0);                    //dont' worry about\n    //perror(\"setenv error\\n\");\n    if (memcmp(\"TRUE\",getenv(\"WAIT\"),4) == 0 )  //these 6 lines\n        printf(\"WAIT=TRUE\\n\");\n    else if(memcmp(\"FALSE\",getenv(\"WAIT\"),4) == 0 )\n        printf(\"WAIT=FALSE\\n\");                     \nprintf(\"end current process (status=%d, child=%d)\\n\", WEXITSTATUS(status), son);\n }\nreturn EXIT_SUCCESS;\n}\n</code></pre>\n"}, {"tags": ["c", "bash"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1529511791, "post_id": 50952854, "comment_id": 88903434, "body": "Why not create a makefile and use that?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6138916"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1529511828, "post_id": 50952854, "comment_id": 88903458, "body": "I would have to create it for every exercise."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 3, "creation_date": 1529511878, "post_id": 50952854, "comment_id": 88903490, "body": "Really?  I have a single makefile in my SOQ (Stack Overflow Questions) directory which I use to compile any program I choose without editing the makefile.  Granted, I type <code>make newprog43</code> (specifying the executable, not the source file), but it compiles <code>newprog43.c</code> into <code>newprog43</code> with all my default compiler options, which I can tune if I need to with extra command line arguments."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6138916"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1529512105, "post_id": 50952854, "comment_id": 88903624, "body": "Ok I&#39;ll try that"}], "answers": [{"comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 2, "creation_date": 1529512386, "post_id": 50953005, "comment_id": 88903780, "body": "And in fact, you can take this a step further: <code>make</code> does not require any Makefile at all if it can rely on a built-in rule to build the requested target from an available source.  I use it that way fairly frequently.  But the Makefile does provide a handy place to record commonly-used options for reuse."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1529512566, "post_id": 50953005, "comment_id": 88903878, "body": "I think OP wanted to build a single program from several source files, which this snippet will not do."}, {"owner": {"reputation": 689, "user_id": 4678048, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2d4cab92f164433dabd22844a55590f7?s=128&d=identicon&r=PG&f=1", "display_name": "Jouster500", "link": "https://stackoverflow.com/users/4678048/jouster500"}, "reply_to_user": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1529514586, "post_id": 50953005, "comment_id": 88904955, "body": "@IanAbbott The OP did tag bash. If he is working in a linux environment, he could probably make a link to the makefile so all he has to do is make, and the makefile can be referenced to attempt the build with."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "reply_to_user": {"reputation": 689, "user_id": 4678048, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2d4cab92f164433dabd22844a55590f7?s=128&d=identicon&r=PG&f=1", "display_name": "Jouster500", "link": "https://stackoverflow.com/users/4678048/jouster500"}, "edited": false, "score": 0, "creation_date": 1529574663, "post_id": 50953005, "comment_id": 88927288, "body": "@Jouster500 I mean OP&#39;s question says something like passing foo.c bar.c baz.c to build program foo. A &quot;generic&quot; makefile rule won&#39;t work for that. It would need a specific makefile rule."}, {"owner": {"reputation": 1203, "user_id": 5872193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9839edfacb5837e124d10164cdc0c558?s=128&d=identicon&r=PG&f=1", "display_name": "Honza Reme\u0161", "link": "https://stackoverflow.com/users/5872193/honza-reme%c5%a1"}, "reply_to_user": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1529577718, "post_id": 50953005, "comment_id": 88929287, "body": "@IanAbbott He wanted a <code>mk()</code> function that would allow him to do <code>mk foo.c</code> to produce <code>foo</code> from <code>foo.c</code> (for any <code>foo</code>). I have written an answer which (while not technically providing exactly what OP asked) actually helps them achieve what they wanted with minimal effort and a standard tool for this kind of things."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1529584041, "post_id": 50953005, "comment_id": 88933445, "body": "To quote from the question: &quot;to which I can pass many arguments and the name of the resulting file is the name of the first one&quot;. I read that as the &quot;many arguments&quot; being many .c files and the &quot;resulting file&quot; being the resulting executable."}], "tags": [], "owner": {"reputation": 1203, "user_id": 5872193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9839edfacb5837e124d10164cdc0c558?s=128&d=identicon&r=PG&f=1", "display_name": "Honza Reme\u0161", "link": "https://stackoverflow.com/users/5872193/honza-reme%c5%a1"}, "is_accepted": false, "score": 5, "last_activity_date": 1529512079, "creation_date": 1529512079, "answer_id": 50953005, "question_id": 50952854, "link": "https://stackoverflow.com/questions/50952854/custom-make-command-for-learning/50953005#50953005", "title": "Custom make command for learning", "body": "<p>You can write a <code>Makefile</code> which will allow you to create multiple targets with a single rule.</p>\n\n<p>In fact, building a <code>&lt;FOO&gt;</code> from <code>&lt;FOO&gt;.c</code> is something for which <code>make</code> has a predefined rule, so you can create a Makefile with</p>\n\n<pre><code>CC = gcc\nCFLAGS = -ggdb -std=c99 -Wall -Werror\n</code></pre>\n\n<p>and then run <code>make bar</code>.</p>\n\n<p>As long as there is a file named <code>bar.c</code>, <code>make</code> will build it for you.</p>\n"}, {"tags": [], "owner": {"reputation": 55059, "user_id": 212858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1166c87b6f3fc2e6746da96b60fefb46?s=128&d=identicon&r=PG", "display_name": "Useless", "link": "https://stackoverflow.com/users/212858/useless"}, "is_accepted": false, "score": 0, "last_activity_date": 1529512356, "creation_date": 1529512356, "answer_id": 50953099, "question_id": 50952854, "link": "https://stackoverflow.com/questions/50952854/custom-make-command-for-learning/50953099#50953099", "title": "Custom make command for learning", "body": "<p>To answer your specific question, bash has a way to remove suffix patterns (like <code>.c</code> for example):</p>\n\n<pre><code>mk() {\n    SOURCE=\"$1\"\n    DEST=\"${1%.c}\"\n    echo \"gcc -ggdb -std=c99 -Wall -Werror ${SOURCE}.c -o $DEST\";\n    gcc -ggdb -std=c99 -Wall -Werror \"${SOURCE}.c\" -o \"$DEST\" ;\n}\n</code></pre>\n\n<p>You should learn to use make properly anyway, but that's no reason you can't <em>also</em> learn bash.</p>\n"}, {"tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": false, "score": 0, "last_activity_date": 1529513351, "last_edit_date": 1529513351, "creation_date": 1529512978, "answer_id": 50953243, "question_id": 50952854, "link": "https://stackoverflow.com/questions/50952854/custom-make-command-for-learning/50953243#50953243", "title": "Custom make command for learning", "body": "<p>Use a <code>makefile</code> \u2014 probably one like <a href=\"https://stackoverflow.com/users/5872193/honza-reme%c5%a1\">Honza Reme\u0161</a> suggests in their <a href=\"https://stackoverflow.com/a/50953005/15168\">answer</a>, or a somewhat more complex one like this, which is closely based on what I use when working on Stack Overflow questions.  It allows me to configure which compilation options are used with great granularity.  This is probably overkill for you at the moment \u2014 Honza's version is a good starting point \u2014 but you may eventually get fussy enough for this to be of benefit.</p>\n\n<pre><code>CC     = gcc\nDFLAGS = #-DHAVE_CONFIG_H\nGFLAGS = -g\nIFLAG1 = #-I${INCDIR}\nIFLAG2 = #-I${HOME}/inc\nIFLAGS = #${IFLAG1} ${IFLAG2}\nOFLAGS = -O3\nSFLAGS = -std=c11 # -pedantic\nUFLAGS = # Set on command line\nWFLAG1 = -Wall\nWFLAG2 = -Wextra\nWFLAG3 = -Werror\nWFLAG4 = -Wmissing-prototypes\nWFLAG5 = -Wstrict-prototypes\nWFLAG6 = #-Wold-style-declaration   # Strict GCC only (not clang, it would seem).\nWFLAG7 = #-Wold-style-definition    # Part of -Wextra in GCC 7.1.0\nWFLAGS = ${WFLAG1} ${WFLAG2} ${WFLAG3} ${WFLAG4} ${WFLAG5} ${WFLAG6} ${WFLAG7}\n\nLDFLAG1 = #-L${LIBDIR}\nLDFLAG2 = #-L${HOME}/lib/64\nLDFLAGS = ${LDFLAG1} ${LDFLAG2}\nLDLIB1  = #-l${SOQBASE}\nLDLIB2  = #-l${CS50BASE}\nLDLIBS  = ${LDLIB1} ${LDLIB2}\n\nCFLAGS   = ${OFLAGS} ${GFLAGS} ${DFLAGS} ${IFLAGS} ${SFLAGS} ${WFLAGS} ${TFLAGS} ${UFLAGS}\n\nDEBRIS = core a.out *~ *.o\nRM_FR  = rm -fr\nRM_F   = rm -f\n\ndefault:\n        @echo \"You must specify a target to build\"\n\n#all:\n# ...rules for what to do for 'make all'\n\n# Provides target 'clean' to do sensible cleaning.\n# Relies on user to set macro PROGRAMS (plural) for removing programs.\n# OUTFILES can be set per makefile to hold output file names that should\n# be cleaned.  OUTDIRS can be set per makefile to hold output directory\n# names that should be cleaned.\n# .dSYM directories are an artefact of building single-file programs on\n# .Mac OS X (or using dsymutil).\n\n.DEFAULT:\n    @echo \"No commands specified for building $@\"\n\nclean:\n    ${RM_F} *.o *.a ${DEBRIS} ${OUTFILES}\n    ${RM_F} ${PROGRAMS}\n    ${RM_FR} *.dSYM ${OUTDIRS}\n</code></pre>\n\n<p>The <code>UFLAGS</code> option, in particular, is one I use for 'user flags' \u2014 something that I want to add to a particular compilation.  I could use:</p>\n\n<pre><code>make UFLAGS=\"-Wshadow -Wpointer-arith\" newprog53\n</code></pre>\n\n<p>to add the extra warning options <code>-Wshadow -Wpointer-arith</code> to the compiler command line.</p>\n\n<p>You can find the full version of this makefile in three files:</p>\n\n<ul>\n<li><code>makefile</code></li>\n<li><code>etc/soq-head.mk</code></li>\n<li><code>etc/soq-tail.mk</code></li>\n</ul>\n\n<p>in my <a href=\"https://github.com/jleffler/soq\" rel=\"nofollow noreferrer\">SOQ</a> (Stack Overflow Questions) repository on GitHub.</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6138916"}, "is_accepted": false, "score": 0, "last_activity_date": 1529515466, "creation_date": 1529515466, "answer_id": 50953851, "question_id": 50952854, "link": "https://stackoverflow.com/questions/50952854/custom-make-command-for-learning/50953851#50953851", "title": "Custom make command for learning", "body": "<pre><code>mk() {\n    output=\"${1%.c}\"\n    echo \"gcc -ggdb -std=c99 -Wall -Werror ${@} -o $output\";\n    gcc -ggdb -std=c99 -Wall -Werror ${@} -o $output;\n}\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6138916"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1529515466, "creation_date": 1529511512, "last_edit_date": 1529512691, "question_id": 50952854, "link": "https://stackoverflow.com/questions/50952854/custom-make-command-for-learning", "title": "Custom make command for learning", "body": "<p>I want to have a make command like this but to which I can pass many arguments and the name of the resulting file is the name of the first one.</p>\n\n<p>It has to accept the name with .c and remove the .c from the source file name for the executable name.</p>\n\n<pre><code># My custom make command\nmk() {\n    echo \"gcc -ggdb -std=c99 -Wall -Werror ${1}.c -o $1\";\n    gcc -ggdb -std=c99 -Wall -Werror ${1}.c -o $1 ;\n}\n</code></pre>\n\n<p>Something like this maybe?</p>\n\n<pre><code>mk() {\n    echo \"gcc -ggdb -std=c99 -Wall -Werror ${@} -o $1\";\n    output=$1\n    set -- \"${@/%/.c}\"\n    gcc -ggdb -std=c99 -Wall -Werror ${@} -o $output;\n}\n</code></pre>\n"}, {"tags": ["c", "restrict"], "answers": [{"tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": true, "score": 1, "last_activity_date": 1529518208, "creation_date": 1529518208, "answer_id": 50954584, "question_id": 50952466, "link": "https://stackoverflow.com/questions/50952466/c-restrict-keyword-based-optimisation/50954584#50954584", "title": "C &#39;restrict&#39; keyword based optimisation", "body": "<ol>\n<li><p>You've told the compiler that <code>object-&gt;def</code> doesn't change, so it can assume that the information is not changed by the call to <code>do_something()</code>, so it could avoid reloading the loop limits on each iteration of each loop.  However, it is not obliged to make such an optimization.  You'd have to look at the generated assembler to know whether it does make the optimization or not.</p></li>\n<li><p>Using <code>restrict</code> would have no bearing on this whatsoever.</p></li>\n<li><p>N/A \u2014 <code>restrict</code> simply indicates that there is no other pointer to the object.</p></li>\n</ol>\n"}], "owner": {"reputation": 261, "user_id": 6745155, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0Frv4.png?s=128&g=1", "display_name": "Piotr Jedyk", "link": "https://stackoverflow.com/users/6745155/piotr-jedyk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 1, "accepted_answer_id": 50954584, "answer_count": 1, "score": 1, "last_activity_date": 1529518208, "creation_date": 1529510290, "question_id": 50952466, "link": "https://stackoverflow.com/questions/50952466/c-restrict-keyword-based-optimisation", "title": "C &#39;restrict&#39; keyword based optimisation", "body": "<p>There are following structures:</p>\n\n<pre><code>typedef struct test_def {\n  int a, b, c;\n} test_def_t;\n\ntypedef struct test {\n  test_def_t const * const def;\n} test_t;\n</code></pre>\n\n<p>I want want to use them like this:</p>\n\n<pre><code>test_def_t initial_def;\ntest_t * object;\n\ninitial_def.a = 123;\ninitial_def.b = 456;\ninitial_def.c = 789;\n\ninit_object(&amp;object, &amp;initial_def);\n</code></pre>\n\n<p>Now, <code>object-&gt;def</code> is a pointer to <strong>a copy</strong> of <code>initial_def</code>.</p>\n\n<p>Later, I will use code which often fetches values from <code>object-&gt;def</code>. I know that this <code>object-&gt;def</code> is read-only and will never change.</p>\n\n<p>Example:</p>\n\n<pre><code>for(int a = 0; a &lt; object-&gt;def-&gt;a; ++a)\n  for(int b = 0; b &lt; object-&gt;def-&gt;b; ++b)\n    for(int c = 0; c &lt; object-&gt;def-&gt;c; ++c)\n      do_something(object);\n</code></pre>\n\n<p><strong>Question #1</strong>: Does the compiler load <code>object-&gt;def-&gt;a</code> and the rest every iteration, even if it can be loaded once?</p>\n\n<p><strong>Question #2</strong>: Does using <code>restrict</code> like below change this behavior?</p>\n\n<pre><code>typedef struct test {\n  test_def const * const restrict def;\n                      /* ^^^^^^^^ */\n} test_t;\n</code></pre>\n\n<p><strong>Question #3</strong>: Should I also use <code>test_t * restrict object</code> instead of just <code>test_t * object</code> to increase optimisation when I use the <code>object</code> only locally?</p>\n"}, {"tags": ["c", "unicode", "glibc"], "comments": [{"owner": {"reputation": 188064, "user_id": 635608, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIJia.png?s=128&g=1", "display_name": "Mat", "link": "https://stackoverflow.com/users/635608/mat"}, "edited": false, "score": 1, "creation_date": 1529510041, "post_id": 50952142, "comment_id": 88902350, "body": "<a href=\"http://en.cppreference.com/w/cpp/string/wide/iswspace\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/string/wide/iswspace</a> has a note about a list of space characters from ISO 30112, last three not listed there."}, {"owner": {"reputation": 188064, "user_id": 635608, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIJia.png?s=128&g=1", "display_name": "Mat", "link": "https://stackoverflow.com/users/635608/mat"}, "edited": false, "score": 1, "creation_date": 1529510544, "post_id": 50952142, "comment_id": 88902704, "body": "<a href=\"http://www.open-std.org/JTC1/SC35/WG5/docs/30112d10.pdf\" rel=\"nofollow noreferrer\">open-std.org/JTC1/SC35/WG5/docs/30112d10.pdf</a> working draft for that standard, maybe you&#39;ll find some clues in there."}, {"owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "reply_to_user": {"reputation": 188064, "user_id": 635608, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIJia.png?s=128&g=1", "display_name": "Mat", "link": "https://stackoverflow.com/users/635608/mat"}, "edited": false, "score": 0, "creation_date": 1529513960, "post_id": 50952142, "comment_id": 88904612, "body": "@Mat: That is a very, <i>very</i> valuable link you have provided me with, because the underlying problem I am facing is much larger than this question, and ISO 30112 seems to be <i>exactly</i> what I have been looking for..."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1529514543, "post_id": 50952142, "comment_id": 88904927, "body": "That document also explains why no-break spaces aren&#39;t in the space category: because they shouldn&#39;t be used as word separators."}], "answers": [{"comments": [{"owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "edited": false, "score": 0, "creation_date": 1529525903, "post_id": 50955136, "comment_id": 88910247, "body": "Funny enough, though, that particular standard defines its LC_CTYPE <i>in terms of glibc output</i>, so there is a certain bit of circular reasoning involved..."}], "tags": [], "owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "is_accepted": true, "score": 2, "last_activity_date": 1529520569, "creation_date": 1529520569, "answer_id": 50955136, "question_id": 50952142, "link": "https://stackoverflow.com/questions/50952142/why-are-no-break-space-and-others-ispunct-in-glibc/50955136#50955136", "title": "Why are &quot;no-break space&quot; and others ispunct() in GLibC?", "body": "<p>ISO/IEC 30112 <em>Information technology -- Specification methods for cultural conventions</em> states, emphasis mine:</p>\n\n<blockquote>\n  <p><strong>space</strong></p>\n  \n  <p>Define characters to be classified as white-space characters, <strong>to find syntactical boundaries</strong>. [...] The class should <strong>not include the NO-BREAK spaces characters</strong> <code>&lt;U00A0&gt;</code>, <code>&lt;U2007&gt;</code>, <code>&lt;UFEFF&gt;</code>, as these characters should not be used for word boundaries.</p>\n</blockquote>\n"}], "owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 50955136, "answer_count": 1, "score": 2, "last_activity_date": 1529520569, "creation_date": 1529509283, "question_id": 50952142, "link": "https://stackoverflow.com/questions/50952142/why-are-no-break-space-and-others-ispunct-in-glibc", "title": "Why are &quot;no-break space&quot; and others ispunct() in GLibC?", "body": "<p>I've been looking at the <code>&lt;wctype.h&gt;</code> flags given to various separator characters by GNU LibC. There are two groups, basically.</p>\n\n<p>The first group returns true on <code>iswspace()</code> and <code>iswblank()</code> (and <code>isprint()</code>, but that is true for the other group as well). These include:</p>\n\n<ul>\n<li><a href=\"http://www.fileformat.info/info/unicode/char/0020/index.htm\" rel=\"nofollow noreferrer\">U+0020 SPACE</a></li>\n<li><a href=\"http://www.fileformat.info/info/unicode/char/1680/index.htm\" rel=\"nofollow noreferrer\">U+1680 OGHAM SPACE MARK</a></li>\n<li><a href=\"http://www.fileformat.info/info/unicode/char/2000/index.htm\" rel=\"nofollow noreferrer\">U+2000 EN QUAD</a></li>\n<li><a href=\"http://www.fileformat.info/info/unicode/char/2001/index.htm\" rel=\"nofollow noreferrer\">U+2001 EM QUAD</a></li>\n<li><a href=\"http://www.fileformat.info/info/unicode/char/2002/index.htm\" rel=\"nofollow noreferrer\">U+2002 EN SPACE</a></li>\n<li><a href=\"http://www.fileformat.info/info/unicode/char/2003/index.htm\" rel=\"nofollow noreferrer\">U+2003 EM SPACE</a></li>\n<li><a href=\"http://www.fileformat.info/info/unicode/char/2004/index.htm\" rel=\"nofollow noreferrer\">U+2004 THREE-PER-EM SPACE</a></li>\n<li><a href=\"http://www.fileformat.info/info/unicode/char/2005/index.htm\" rel=\"nofollow noreferrer\">U+2005 FOUR-PER-EM SPACE</a></li>\n<li><a href=\"http://www.fileformat.info/info/unicode/char/2006/index.htm\" rel=\"nofollow noreferrer\">U+2006 SIX-PER-EM SPACE</a></li>\n<li><a href=\"http://www.fileformat.info/info/unicode/char/2008/index.htm\" rel=\"nofollow noreferrer\">U+2008 PUNCTUATION SPACE</a></li>\n<li><a href=\"http://www.fileformat.info/info/unicode/char/2009/index.htm\" rel=\"nofollow noreferrer\">U+2009 THIN SPACE</a></li>\n<li><a href=\"http://www.fileformat.info/info/unicode/char/200a/index.htm\" rel=\"nofollow noreferrer\">U+200a HAIR SPACE</a></li>\n<li><a href=\"http://www.fileformat.info/info/unicode/char/205f/index.htm\" rel=\"nofollow noreferrer\">U+205f MEDIUM MATHEMATICAL SPACE</a></li>\n<li><a href=\"http://www.fileformat.info/info/unicode/char/3000/index.htm\" rel=\"nofollow noreferrer\">U+3000 IDEOGRAPHIC SPACE</a></li>\n</ul>\n\n<p>No complaints so far. The <strong>other</strong> group has me puzzled, though:</p>\n\n<ul>\n<li><a href=\"http://www.fileformat.info/info/unicode/char/00a0/index.htm\" rel=\"nofollow noreferrer\">U+00a0 NO-BREAK SPACE</a></li>\n<li><a href=\"http://www.fileformat.info/info/unicode/char/2007/index.htm\" rel=\"nofollow noreferrer\">U+2007 FIGURE SPACE</a></li>\n<li><a href=\"http://www.fileformat.info/info/unicode/char/202f/index.htm\" rel=\"nofollow noreferrer\">U+202f NARROW NO-BREAK SPACE</a></li>\n</ul>\n\n<p>These return <strong>false</strong> on <code>iswspace()</code> and <code>iswblank()</code>, but <strong>true</strong> for <code>iswpunct()</code> and <code>iswgraph()</code>.</p>\n\n<p><strong>Why are the last three considered punctuation, not whitespace?</strong></p>\n\n<p>Java agrees with GLibC on this, apparently (see linked pages). <a href=\"https://www.unicode.org/reports/tr44/#Property_Values\" rel=\"nofollow noreferrer\">Unicode</a> labels both groups as category 'Zs', \"Space_Separator\"...</p>\n"}, {"tags": ["java", "c#", "c", "visual-studio", "static-code-analysis"], "comments": [{"owner": {"reputation": 32443, "user_id": 1485872, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/9XWSA.png?s=128&g=1", "display_name": "Ander Biguri", "link": "https://stackoverflow.com/users/1485872/ander-biguri"}, "edited": false, "score": 0, "creation_date": 1529508758, "post_id": 50951677, "comment_id": 88901535, "body": "The answer is 2, as an example like this can be seen in wikipedia: &quot;<i>If the code had one single-condition IF statement, there would be two paths through the code: one where the IF statement evaluates to TRUE and another one where it evaluates to FALSE, so the complexity would be 2</i>&quot;"}, {"owner": {"reputation": 32443, "user_id": 1485872, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/9XWSA.png?s=128&g=1", "display_name": "Ander Biguri", "link": "https://stackoverflow.com/users/1485872/ander-biguri"}, "edited": false, "score": 0, "creation_date": 1529508845, "post_id": 50951677, "comment_id": 88901595, "body": "I wonder what do eclipse and visual studio report if instead of filling the variable <code>result</code>, you would type <code>return -1</code> and <code>return a*b</code>"}, {"owner": {"reputation": 608, "user_id": 949477, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4288030df390b69e82c0a389445549fc?s=128&d=identicon&r=PG", "display_name": "FaisalM", "link": "https://stackoverflow.com/users/949477/faisalm"}, "reply_to_user": {"reputation": 32443, "user_id": 1485872, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/9XWSA.png?s=128&g=1", "display_name": "Ander Biguri", "link": "https://stackoverflow.com/users/1485872/ander-biguri"}, "edited": false, "score": 0, "creation_date": 1529556802, "post_id": 50951677, "comment_id": 88918000, "body": "@AnderBiguri When I use <code>return -1</code> and <code>return a*b</code>, both VS and Eclipse shows the same value &#39;3&#39;. However if I change the line 4 to <code>if (a == 0)</code> they shows &#39;2&#39;."}, {"owner": {"reputation": 608, "user_id": 949477, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4288030df390b69e82c0a389445549fc?s=128&d=identicon&r=PG", "display_name": "FaisalM", "link": "https://stackoverflow.com/users/949477/faisalm"}, "reply_to_user": {"reputation": 32443, "user_id": 1485872, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/9XWSA.png?s=128&g=1", "display_name": "Ander Biguri", "link": "https://stackoverflow.com/users/1485872/ander-biguri"}, "edited": false, "score": 0, "creation_date": 1529731504, "post_id": 50951677, "comment_id": 88990451, "body": "Any explanation why Visual Studio and Eclipse reports &#39;3&#39;?"}], "answers": [{"tags": [], "owner": {"reputation": 65, "user_id": 8797392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ed5b7f7973c2fddf3d55759832518d5?s=128&d=identicon&r=PG&f=1", "display_name": "smitz", "link": "https://stackoverflow.com/users/8797392/smitz"}, "is_accepted": false, "score": 2, "last_activity_date": 1544385236, "last_edit_date": 1544385236, "creation_date": 1529508994, "answer_id": 50952045, "question_id": 50951677, "link": "https://stackoverflow.com/questions/50951677/cyclomatic-complexity-when-if-conditions-are-combined/50952045#50952045", "title": "Cyclomatic complexity when if conditions are combined", "body": "<blockquote>\n  <p>Cyclomatic complexity\n  is a software metric that provides a quantitative measure of the\n  logical complexity of a program. When used in the context of the basis path testing\n  method, the value computed for cyclomatic complexity defines the number of inde-\n  pendent paths in the basis set of a program and provides us with an upper bound for\n  the number of tests that must be conducted to ensure that all statements have been\n  executed at least once.</p>\n</blockquote>\n\n<p>An \nindependent path\nis any path through the program that introduces at least one\nnew set of processing statements or a new condition.</p>\n\n<p>There are only 2 independent paths in your code, one that goes through if branch and one through else branch.</p>\n"}, {"tags": [], "owner": {"reputation": 41, "user_id": 2949112, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e0461cf9ab52f52519fe3a8a21dabf8?s=128&d=identicon&r=PG&f=1", "display_name": "testmuse", "link": "https://stackoverflow.com/users/2949112/testmuse"}, "is_accepted": false, "score": 2, "last_activity_date": 1542328199, "creation_date": 1542328199, "answer_id": 53329760, "question_id": 50951677, "link": "https://stackoverflow.com/questions/50951677/cyclomatic-complexity-when-if-conditions-are-combined/53329760#53329760", "title": "Cyclomatic complexity when if conditions are combined", "body": "<p>You have 3 paths through the program because \"&amp;&amp;\" is a short-cut condition.\nThe 3 paths/tests are:</p>\n\n<pre><code>    a=1 and b=7 (actually anything)  which short cuts and returns a*b or 7\n    a=0 and b=7  which goes to else and returns a*b or 0\n    a=0 and b=0  which goes to then and returns -1'\n</code></pre>\n\n<p>The fact that b is not evaluated in the first condition can be significant.</p>\n"}], "owner": {"reputation": 608, "user_id": 949477, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4288030df390b69e82c0a389445549fc?s=128&d=identicon&r=PG", "display_name": "FaisalM", "link": "https://stackoverflow.com/users/949477/faisalm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 825, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1544385236, "creation_date": 1529507885, "last_edit_date": 1530682107, "question_id": 50951677, "link": "https://stackoverflow.com/questions/50951677/cyclomatic-complexity-when-if-conditions-are-combined", "title": "Cyclomatic complexity when if conditions are combined", "body": "<p>I would like to compute the cyclomatic complexity of below code.</p>\n\n<pre><code>    int test(int a, int b)\n    {\n          int result = 0;\n          if (a == 0 &amp;&amp; b == 0)\n              result = -1;\n          else\n              result = a * b;\n\n          return result;\n    }\n</code></pre>\n\n<p>Mathwork's Polyspace tool calculates a value of 2.\nVisual studio and Metrics plugin for Eclipse shows 3. Which is correct?</p>\n"}, {"tags": ["c", "compiler-errors", "mingw", "undefined-reference"], "comments": [{"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1529507909, "post_id": 50951536, "comment_id": 88900997, "body": "You should consider compiling <i>all</i> your code with <code>gcc -Wall -g</code>"}], "answers": [{"comments": [{"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1529508059, "post_id": 50951658, "comment_id": 88901078, "body": "On Linux, some linkers are able to use DWARF debug information to report line numbers"}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "reply_to_user": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1529508110, "post_id": 50951658, "comment_id": 88901109, "body": "@BasileStarynkevitch Yup, was just adding that."}], "tags": [], "owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "is_accepted": true, "score": 2, "last_activity_date": 1529509887, "last_edit_date": 1529509887, "creation_date": 1529507849, "answer_id": 50951658, "question_id": 50951536, "link": "https://stackoverflow.com/questions/50951536/compiler-does-not-give-line-number-of-error-undefined-reference/50951658#50951658", "title": "Compiler does not give line number of error undefined reference", "body": "<p>That error comes from the \"linker\" (<code>ld</code>), not the compiler proper.</p>\n\n<p>Typically, the compiler compiles each source file into its own, individual object file, containing just the code and data from that source file.  Then, the linker combines one or more object files together, and also links in any needed library functions.</p>\n\n<p>Crucially, there's no problem if a single source file (a single object file) calls an undefined function -- that's normal, if the definition of the function is in another source file, or a library.  So that's why it's the linker (not the compiler) that finally discovers that there's not a definition for a function anywhere, that it's truly undefined.</p>\n\n<p>But since the linker is working with object files, typically it doesn't know which source file line numbers the functions were originally called on.</p>\n\n<p>(Some C compilers work more closely with their linkers, so that these \"undefined external\" error messages can, more usefully, contain actual source file line numbers, but that's a relatively recent innovation.  For this to work it may be important to compile with debugging enabled, e.g. by using the <code>-g</code> flag, so that the compiler includes source line number information in its object files.)</p>\n"}], "owner": {"reputation": 37, "user_id": 3914044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59a386d5ebf09ded319beaee0ccfed15?s=128&d=identicon&r=PG&f=1", "display_name": "newbie_developer93", "link": "https://stackoverflow.com/users/3914044/newbie-developer93"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 587, "favorite_count": 0, "accepted_answer_id": 50951658, "answer_count": 1, "score": 0, "last_activity_date": 1529882031, "creation_date": 1529507433, "last_edit_date": 1529882031, "question_id": 50951536, "link": "https://stackoverflow.com/questions/50951536/compiler-does-not-give-line-number-of-error-undefined-reference", "title": "Compiler does not give line number of error undefined reference", "body": "<p>Why does the compiler sometimes not give line number of the error? Where is the use case of that \"undefined reference\". I've already included everything as header files I myself wrote so it needs to give a specific line number. It is not closed source. Have I changed some setting of the compiler by accident or is it another thing whatever that another thing is?</p>\n\n<blockquote>\n  <p>D:\\Projects\\DanceOfPixels\\GLEW>gcc main.c glad.c -IC:\\mingw_dev_lib\\include\\SDL2 -LC:\\mingw_dev_lib\\lib -lmingw32 -lopengl32 -lSDL2main -lSDL2 -lSDL2_image -o main.exe -ansi -std=c89 -pedantic -w\n  C:\\Users\\user\\AppData\\Local\\Temp\\ccMooHZm.o:main.c:(.text+0x126ce): undefined reference to `drawImagePartScaledHW'\n  collect2.exe: error: ld returned 1 exit status</p>\n</blockquote>\n\n<p><strong>Edit:</strong> I have solved the problem. I have included two different versions of the draw.h, one coming from software renderer, other from OpenGL renderer. Since they use same</p>\n\n<pre><code>#ifndef DRAW_H\n#define DRAW_H\n\n...\n\n#endif\n</code></pre>\n\n<p>structure for both files; the compiler didn't include the second. Once I've changed the DRAW_H to DRAW_HW I managed to compile and run the application.</p>\n"}, {"tags": ["c", "syntax", "printf"], "comments": [{"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 5, "creation_date": 1529507814, "post_id": 50951525, "comment_id": 88900939, "body": "<code>&amp;</code> is bitwise and, not a boolean operator. The second one is unspecified behaviour because <code>strcmp</code> is only specified to return a positive integer, not necessarily 1. And &#39;char` is an integer, not a boolean."}, {"owner": {"reputation": 162, "user_id": 6432241, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-MIJZrdsx4z8/AAAAAAAAAAI/AAAAAAAAABo/1xNzv23cHCc/photo.jpg?sz=128", "display_name": "Immanuel", "link": "https://stackoverflow.com/users/6432241/immanuel"}, "reply_to_user": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1529508944, "post_id": 50951525, "comment_id": 88901657, "body": "Thank you! I now have a much better understanding regarding &amp; and &amp;&amp; :)!"}], "answers": [{"tags": [], "owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "is_accepted": true, "score": 5, "last_activity_date": 1529507999, "last_edit_date": 1529507999, "creation_date": 1529507682, "answer_id": 50951608, "question_id": 50951525, "link": "https://stackoverflow.com/questions/50951525/understanding-syntax-puzzle-in-c/50951608#50951608", "title": "Understanding syntax puzzle in c", "body": "<p>For the first question the expression is <code>'&amp;' &amp; '&amp;'</code>, where <code>&amp;</code> is a <em>bitwise</em> AND operator (not a logical operator). With bitwise AND the result of <code>x &amp; x</code> is <code>x</code>, so the result in this case is just the character <code>'&amp;'</code>.</p>\n\n<p>For the second question, assuming the the result of the call to <code>strcmp()</code> is <code>1</code>, you can then simplify the expression to <code>1 * '*'</code> which is just <code>'*'</code>. (Note that as <a href=\"https://stackoverflow.com/users/1566221/rici\">@rici</a> mentions in the comments above, the result of <code>strcmp</code> is not guaranteed to be 1 in this case, only that it will be an integer > 0, so you should not rely on this behaviour, and the question is therefore a bad question).</p>\n"}, {"tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 1, "last_activity_date": 1529509419, "last_edit_date": 1529509419, "creation_date": 1529508649, "answer_id": 50951919, "question_id": 50951525, "link": "https://stackoverflow.com/questions/50951525/understanding-syntax-puzzle-in-c/50951919#50951919", "title": "Understanding syntax puzzle in c", "body": "<ol>\n<li><p><code>'&amp;'</code> is a constant of type <code>int</code>. <code>'&amp;'&amp;'&amp;'</code> has the same value and type as <code>'&amp;'</code> since <code>a &amp; a</code> is <code>a</code> for any <code>int</code> <code>a</code>. So the output is equivalent to <code>printf (\"%c\", '&amp;');</code>.</p></li>\n<li><p>The analysis of the second snippet is more difficult. The result of <code>strcmp</code> is a positive number. And that is multiplied by <code>'*'</code> (which must be a positive number for any <em>encoding</em> supported by C). That's an <code>int</code> but the value is implementation defined (subject to the encoding on your platform and your platform's implementation of <code>strcmp</code>), and the behaviour of <code>%c</code> is contingent on the signedness or otherwise of <code>char</code> on your platform. If the result is too big to fit into a <code>char</code>, and <code>char</code> is <code>unsigned</code>, then the value is converted to a <code>char</code> with the normal wrap-around behaviour. If <code>char</code> is <code>signed</code> then the conversion is implementation-defined and an implementation-defined signal might be raised.</p></li>\n</ol>\n"}], "owner": {"reputation": 162, "user_id": 6432241, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-MIJZrdsx4z8/AAAAAAAAAAI/AAAAAAAAABo/1xNzv23cHCc/photo.jpg?sz=128", "display_name": "Immanuel", "link": "https://stackoverflow.com/users/6432241/immanuel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 50951608, "answer_count": 2, "score": 4, "last_activity_date": 1529509419, "creation_date": 1529507404, "question_id": 50951525, "link": "https://stackoverflow.com/questions/50951525/understanding-syntax-puzzle-in-c", "title": "Understanding syntax puzzle in c", "body": "<p>In an upcoming exam in c, we have one question that gives you extra credit.</p>\n\n<p>The question is always related to tricky syntax of various printing types.</p>\n\n<p>Overall, I understood all the questions I have gone through, but two questions in particular had me puzzled :</p>\n\n<p>What is the output of the following program?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nvoid main(){\n    printf (\"%c\", '&amp;'&amp;'&amp;');\n}\n</code></pre>\n\n<p>answer: &amp;</p>\n\n<p>What is the output of the following program?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\nvoid main(){\n    printf(\"%c\",strcmp(\"***\",\"**\")*'*');\n}\n</code></pre>\n\n<p>answer: *</p>\n\n<p>As you can see the questions are quite similar.\nMy question is, why is this the output?</p>\n\n<p>Regarding the first question: I understand that a character is, logic-wise, always TRUE and that AND-ing TRUE with TRUE gives you TRUE (or 1) as well, but why would it convert 1 to '&amp;', why not the char equivalent of 1 from the ASCII-table? (notice the required print of %c and not %d)</p>\n\n<p>Regarding the second question: I understand that strcmp returns an int according to the value that 'appears first in the dictionary' and in this example would result in 1 but why multiplying it with the char '*' (again, logic-wise equals to 1) would result in converting (1*1=1) to char '*'?</p>\n"}, {"tags": ["c", "bit-manipulation"], "answers": [{"comments": [{"owner": {"reputation": 21663, "user_id": 9305398, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cqJvE.png?s=128&g=1", "display_name": "Acorn", "link": "https://stackoverflow.com/users/9305398/acorn"}, "edited": false, "score": 0, "creation_date": 1529508734, "post_id": 50951459, "comment_id": 88901518, "body": "It can be reduced to 4 operations instead of 5."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1531661862, "post_id": 50951459, "comment_id": 89670280, "body": "This <code>out &amp;= 0b00111100</code> should be <code>out |= 0b00111100</code> shouldn&#39;t it?"}], "tags": [], "owner": {"reputation": 3560, "user_id": 5550963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7jAip.png?s=128&g=1", "display_name": "CEPB", "link": "https://stackoverflow.com/users/5550963/cepb"}, "is_accepted": true, "score": 6, "last_activity_date": 1618051502, "last_edit_date": 1618051502, "creation_date": 1529507267, "answer_id": 50951459, "question_id": 50951380, "link": "https://stackoverflow.com/questions/50951380/change-4-middle-bits-of-a-byte-in-c/50951459#50951459", "title": "Change 4 middle bits of a byte in C", "body": "<p>simple:</p>\n<pre><code>out &amp;= 0b11000011;\nout |= (in &gt;&gt; 2 &amp; 0b00111100);\n</code></pre>\n<p><code>out &amp;= 0b11000011</code> sets <code>out</code> to <code>0bxx0000xx</code> preserving 2 most significant bits and 2 least significant bits. <code>in &gt;&gt; 2</code> shifts input by 2 giving us <code>0xYYABCDEF</code>, <code>YY</code> could be <code>00</code> or <code>11</code> depending on what <code>A</code> is. To get rid of <code>YY</code> and <code>EF</code> we do <code>&amp; 0b00111100</code>.</p>\n<p>As pointed by @JB <code>0B</code> is not standard notation, thus you should use something else, most preferably hex <code>0x</code> notation. See <a href=\"https://stackoverflow.com/questions/18244726/why-doesnt-c-have-binary-literals\">this</a> for more info.</p>\n<p>Thus using hex this would be:</p>\n<pre><code>out &amp;= 0xC3;\nout |= (in &gt;&gt; 2 &amp; 0x3C)\n</code></pre>\n<p>here is conversion table</p>\n<pre><code>`0xf` is `0b1111`\n`0x3` is `0b0011`\n`0xc` is `0b1100`\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 21663, "user_id": 9305398, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cqJvE.png?s=128&g=1", "display_name": "Acorn", "link": "https://stackoverflow.com/users/9305398/acorn"}, "is_accepted": false, "score": 5, "last_activity_date": 1529508661, "creation_date": 1529508661, "answer_id": 50951924, "question_id": 50951380, "link": "https://stackoverflow.com/questions/50951380/change-4-middle-bits-of-a-byte-in-c/50951924#50951924", "title": "Change 4 middle bits of a byte in C", "body": "<p>Assuming <code>in</code> and <code>out</code> are <code>unsigned char</code>, and that <code>CHAR_BIT == 8</code>:</p>\n\n<pre><code>out = (out &amp; 0xC3) | ((in &gt;&gt; 2) &amp; 0x3C);\n</code></pre>\n\n<p>i.e. 4 operations in total.</p>\n"}, {"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 2, "last_activity_date": 1529508722, "creation_date": 1529508722, "answer_id": 50951941, "question_id": 50951380, "link": "https://stackoverflow.com/questions/50951380/change-4-middle-bits-of-a-byte-in-c/50951941#50951941", "title": "Change 4 middle bits of a byte in C", "body": "<p>There are multiple alternatives.  From a high-level perspective, you could</p>\n\n<ul>\n<li>force the four middle bits of <code>Out</code> <strong>off</strong>, prepare a mask from <code>In</code> as show in your question, and combine <code>Out</code> and mask via bitwise OR (<code>|</code>)</li>\n<li>force the four middle bits of <code>Out</code> <strong>off</strong>, prepare a mask from <code>In</code> as show in your question, and combine <code>Out</code> and mask via bitwise EXCLUSIVE OR (<code>^</code>)</li>\n<li>force the four middle bits of <code>Out</code> <strong>on</strong>, prepare a mask from <code>In</code> similarly to how you do now, but with the outer bits on, and combine <code>Out</code> and mask via bitwise AND (<code>&amp;</code>)</li>\n<li>use a series of shifts, masks, and addition or bitwise OR operations to build up the wanted result section by section</li>\n</ul>\n\n<p>Forcing bits off is achieved by bitwise AND with a mask that has 0s at (only) the positions you want to turn off.</p>\n\n<p>Forcing bits on is achieved by bitwise OR with a mask that has 1s at (only) the positions you want to turn on.</p>\n\n<p>You already seem to have a handle on shifting, though you do need to be careful there if you happen to be shifting objects of signed types.  Prefer to use unsigned types for bit manipulation wherever possible.</p>\n"}], "owner": {"reputation": 1103, "user_id": 5108333, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/KrNTC.png?s=128&g=1", "display_name": "A. Vieira", "link": "https://stackoverflow.com/users/5108333/a-vieira"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 349, "favorite_count": 0, "accepted_answer_id": 50951459, "answer_count": 3, "score": 4, "last_activity_date": 1618051502, "creation_date": 1529507066, "question_id": 50951380, "link": "https://stackoverflow.com/questions/50951380/change-4-middle-bits-of-a-byte-in-c", "title": "Change 4 middle bits of a byte in C", "body": "<p>I'm trying to change the 4 middle bits of a byte to correspond to the High nibble of another byte:</p>\n\n<p>Suppose we start with:</p>\n\n<pre><code>In = 0bABCDEFGH\nOut = 0bXXXXXXXX // Some random byte\n</code></pre>\n\n<p>I want:</p>\n\n<pre><code>Out = 0bXXABCDXX\n</code></pre>\n\n<p>Leaving whatever other bits were in <code>Out</code>'s extremes unchanged.</p>\n\n<p>How can I do this?</p>\n\n<p><strong>Note:</strong> The 'X' represents any bit, 0 or 1, just to distinguish what came from the input.</p>\n\n<p>I got to:</p>\n\n<pre><code>(0b00111100 &amp; (IN&gt;&gt;2)) = 0b00ABCD00\n</code></pre>\n\n<p>, which filters the high nibble and centers it but then what? How can I move it to <code>Out</code>?</p>\n"}, {"tags": ["c", "increment"], "comments": [{"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 35, "creation_date": 1529506889, "post_id": 50951261, "comment_id": 88900296, "body": "That&#39;s not bad in terms of research. You are on the right track."}, {"owner": {"reputation": 31255, "user_id": 28494, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/c14ME.gif?s=128&g=1", "display_name": "qrdl", "link": "https://stackoverflow.com/users/28494/qrdl"}, "edited": false, "score": 35, "creation_date": 1529506952, "post_id": 50951261, "comment_id": 88900338, "body": "What do you expect the expression to do?"}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 4, "creation_date": 1529507276, "post_id": 50951261, "comment_id": 88900571, "body": "according to C11 standard 6.5.3.1: <i>The  operand  of  the  prefix  increment  or  decrement  operator  shall  have  atomic,  qualified, or unqualified real or pointer type, and shall be a modifiable lvalue</i>"}, {"owner": {"reputation": 528, "user_id": 2184331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c59f93339e2cf87731ed5d709f275d5?s=128&d=identicon&r=PG", "display_name": "William J Bagshaw", "link": "https://stackoverflow.com/users/2184331/william-j-bagshaw"}, "edited": false, "score": 1, "creation_date": 1529507745, "post_id": 50951261, "comment_id": 88900887, "body": "They are pre or post increment operators and do two things. They are not just for incrementing a variable. Typical use is c = s[i++]; where i acts as an index and you want to get a value in the array and increment the index, ( Not the value) The pre/post increments are  notoriously bad if used in parameters to functions and are should be avoided in this case. I think you really want c = (a + b +1);  Take the example a = b++;  a is assigned the value of b and then b is incremented. It is doing two things."}, {"owner": {"reputation": 20736, "user_id": 1115360, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uMQGl.png?s=128&g=1", "display_name": "Andrew Morton", "link": "https://stackoverflow.com/users/1115360/andrew-morton"}, "edited": false, "score": 10, "creation_date": 1529520801, "post_id": 50951261, "comment_id": 88908015, "body": "How would you like the 1 to be distributed between a and b? <i>&quot;Should array indices start at 0 or 1? My compromise of 0.5 was rejected without, I thought, proper consideration.&quot;</i> \u2014 Stan Kelly-Bootle"}, {"owner": {"reputation": 281, "user_id": 5832442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e31e7c78387ad46cf27c5a84cec6027f?s=128&d=identicon&r=PG&f=1", "display_name": "Trevor", "link": "https://stackoverflow.com/users/5832442/trevor"}, "edited": false, "score": 5, "creation_date": 1529543411, "post_id": 50951261, "comment_id": 88915258, "body": "I think a follow on question is why would you ever want to do this when <code>c = a + b + 1</code> makes your intent clearer and is also shorter to type.  The increment/decrement operators do two things 1. they and their argument form an expression (that can be used, e.g. in a for loop), 2. they modify the argument.  In your example you are using property 1. but not property 2., since you throw away the modified argument.  If you don&#39;t need property 2. and just want the expression, then you can just write an expression, e.g. x+1 instead of x++."}, {"owner": {"reputation": 68467, "user_id": 1081110, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fp4Pm.jpg?s=128&g=1", "display_name": "Dawood ibn Kareem", "link": "https://stackoverflow.com/users/1081110/dawood-ibn-kareem"}, "edited": false, "score": 1, "creation_date": 1529546271, "post_id": 50951261, "comment_id": 88915835, "body": "How on earth would you modify <code>a + b</code> without modifying <code>a</code> or <code>b</code>?  Unless you intend <code>++(a+b)</code> to mean &quot;increment <code>a</code> AND increment <code>b</code>&quot;."}, {"owner": {"reputation": 1505, "user_id": 1704733, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf423695f1d5008a3fa18f8aaecefc27?s=128&d=identicon&r=PG", "display_name": "Tamir Daniely", "link": "https://stackoverflow.com/users/1704733/tamir-daniely"}, "edited": false, "score": 1, "creation_date": 1529579353, "post_id": 50951261, "comment_id": 88930322, "body": "I think the point here is that while a+b MAY eventually be something that you can increment, there is no guarantee that there WILL be, as far as the language definition is concerned. And just as a side note, ++ is two characters, +1 is two characters. Don&#39;t be too OCD about it."}, {"owner": {"reputation": 42447, "user_id": 1016716, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/1c83d772b1c065603c7f20975d8d3552?s=128&d=identicon&r=PG", "display_name": "Mr Lister", "link": "https://stackoverflow.com/users/1016716/mr-lister"}, "edited": false, "score": 0, "creation_date": 1529580800, "post_id": 50951261, "comment_id": 88931299, "body": "I would have found this a much more interesting question if it had been about <code>c = ++(a,b);</code>"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 42447, "user_id": 1016716, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/1c83d772b1c065603c7f20975d8d3552?s=128&d=identicon&r=PG", "display_name": "Mr Lister", "link": "https://stackoverflow.com/users/1016716/mr-lister"}, "edited": false, "score": 0, "creation_date": 1529673222, "post_id": 50951261, "comment_id": 88972043, "body": "@MrLister: How would that change the question in the slightest way?"}, {"owner": {"reputation": 42447, "user_id": 1016716, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/1c83d772b1c065603c7f20975d8d3552?s=128&d=identicon&r=PG", "display_name": "Mr Lister", "link": "https://stackoverflow.com/users/1016716/mr-lister"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1529673641, "post_id": 50951261, "comment_id": 88972305, "body": "@Olaf Well, because <code>(a,b)</code> is an expression that yields <code>b</code>. And <code>b</code> being an lvalue..."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 42447, "user_id": 1016716, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/1c83d772b1c065603c7f20975d8d3552?s=128&d=identicon&r=PG", "display_name": "Mr Lister", "link": "https://stackoverflow.com/users/1016716/mr-lister"}, "edited": false, "score": 1, "creation_date": 1529676276, "post_id": 50951261, "comment_id": 88974020, "body": "@MrLister: That&#39;s true for the addition, too. But neverthless the comma-operator does <b>not</b> yield <code>b</code>, but it&#39;s value. See the standard, footnote 114!"}], "answers": [{"tags": [], "owner": {"reputation": 17097, "user_id": 672689, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IPnRU.png?s=128&g=1", "display_name": "Roee Gavirel", "link": "https://stackoverflow.com/users/672689/roee-gavirel"}, "is_accepted": false, "score": 21, "last_activity_date": 1529507396, "creation_date": 1529507396, "answer_id": 50951521, "question_id": 50951261, "link": "https://stackoverflow.com/questions/50951261/why-does-c-ab-give-compilation-error/50951521#50951521", "title": "Why does c = ++(a+b) give compilation error?", "body": "<p>You are correct. the <code>++</code> tries to assign the new value to the original variable. So <code>++a</code> will take the value of <code>a</code>, adds <code>1</code> to it and then assign it back to <code>a</code>. Since, as you said, (a+b) is a temp value, and not a variable with assigned memory address the assignment can't be performed.</p>\n"}, {"comments": [{"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 4, "creation_date": 1529507968, "post_id": 50951526, "comment_id": 88901027, "body": "I think point (1) hits the nail on the head. Just looking at the rules for temporary materialization in C++ can turn one&#39;s stomach (but it&#39;s powerful, though, gotta say that)."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 4, "creation_date": 1529508023, "post_id": 50951526, "comment_id": 88901059, "body": "@StoryTeller: Indeed, unlike our beloved language C++, C still compiles into assembly relatively trivially."}, {"owner": {"reputation": 19530, "user_id": 884372, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/93234f6c046fc1554f9fb2c471fb09ec?s=128&d=identicon&r=PG", "display_name": "Carl Witthoft", "link": "https://stackoverflow.com/users/884372/carl-witthoft"}, "edited": false, "score": 0, "creation_date": 1529519712, "post_id": 50951526, "comment_id": 88907503, "body": "Bit of a shame that a pair of parentheses isn&#39;t interpreted as a nested operation. Then  <code>++(a+b)</code> could be translated into  the equivalent of  <code>a+b |  c = ++ </code>"}, {"owner": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "edited": false, "score": 29, "creation_date": 1529525668, "post_id": 50951526, "comment_id": 88910139, "body": "Here&#39;s a real reason IMHO: it would be a dreadful confusion if <code>++</code> sometimes had a side effect of modifying something and sometimes just didn&#39;t."}, {"owner": {"reputation": 13419, "user_id": 1405588, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/01a91a47db3526000ffa9247f95fff62?s=128&d=identicon&r=PG", "display_name": "o11c", "link": "https://stackoverflow.com/users/1405588/o11c"}, "edited": false, "score": 0, "creation_date": 1529557383, "post_id": 50951526, "comment_id": 88918168, "body": "<code>Foo&amp; operator ++() {...}</code> would allow OP&#39;s code to compile, whereas <code>Foo&amp; operator ++() &amp; {...}</code> would fail the way primitives do."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 13419, "user_id": 1405588, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/01a91a47db3526000ffa9247f95fff62?s=128&d=identicon&r=PG", "display_name": "o11c", "link": "https://stackoverflow.com/users/1405588/o11c"}, "edited": false, "score": 2, "creation_date": 1529558618, "post_id": 50951526, "comment_id": 88918593, "body": "@o11c although that would require your convincing the c standards committee of the need for references and operator overloading."}, {"owner": {"reputation": 1245, "user_id": 9270843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cdd1f497c45bb6c42a363ad660e09c3e?s=128&d=identicon&r=PG&f=1", "display_name": "dng", "link": "https://stackoverflow.com/users/9270843/dng"}, "edited": false, "score": 0, "creation_date": 1529566429, "post_id": 50951526, "comment_id": 88922336, "body": "@Bathsheba I see, so it is a good idea to imagine 2 different classes of expressions/variable, left and right?"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 1245, "user_id": 9270843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cdd1f497c45bb6c42a363ad660e09c3e?s=128&d=identicon&r=PG&f=1", "display_name": "dng", "link": "https://stackoverflow.com/users/9270843/dng"}, "edited": false, "score": 5, "creation_date": 1529566485, "post_id": 50951526, "comment_id": 88922372, "body": "@dng: Indeed it is; that&#39;s why the terms lvalue and rvalue were introduced, although things are more complicated than that nowadays (particularly in C++). For example, a constant can never be an lvalue: something like 5 = a makes no sense."}, {"owner": {"reputation": 1245, "user_id": 9270843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cdd1f497c45bb6c42a363ad660e09c3e?s=128&d=identicon&r=PG&f=1", "display_name": "dng", "link": "https://stackoverflow.com/users/9270843/dng"}, "edited": false, "score": 6, "creation_date": 1529570583, "post_id": 50951526, "comment_id": 88924752, "body": "@Bathsheba That explains why 5++ also causes a compilation error"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 1245, "user_id": 9270843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cdd1f497c45bb6c42a363ad660e09c3e?s=128&d=identicon&r=PG&f=1", "display_name": "dng", "link": "https://stackoverflow.com/users/9270843/dng"}, "edited": false, "score": 3, "creation_date": 1529570621, "post_id": 50951526, "comment_id": 88924779, "body": "@dng: Absolutely."}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 2, "creation_date": 1529592835, "post_id": 50951526, "comment_id": 88939600, "body": "@Bathsheba And that is why the recommendation exists to put constants on the left in equality comparisons such as <code>if( 5 == a )</code> so if there is a typo and one of the <code>=</code> is left out, the program will refuse to compile rather than silently set <code>a</code> equal to <code>5</code> instead of perform an equality check."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1545342660, "post_id": 50951526, "comment_id": 94600372, "body": "You can write <code>(a+b)+1</code> if that was the intent, I think it would be detrimental to also add <code>++(a+b)</code> with the same meaning:  it adds nothing to the language, it violates the design principle of having there be only one way to do a thing, and it makes it harder for people to learn what <code>++</code> does since now there are two separate cases, <code>++lvalue</code> and <code>++rvalue</code>"}], "tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": true, "score": 118, "last_activity_date": 1529614345, "last_edit_date": 1529614345, "creation_date": 1529507407, "answer_id": 50951526, "question_id": 50951261, "link": "https://stackoverflow.com/questions/50951261/why-does-c-ab-give-compilation-error/50951526#50951526", "title": "Why does c = ++(a+b) give compilation error?", "body": "<p>It's just a rule, that's all, and is possibly there to (1) make it easier to write C compilers and (2) nobody has convinced the C standards committee to relax it.</p>\n\n<p>Informally speaking you can only write <code>++foo</code> if <code>foo</code> can appear on the left hand side of an assignment expression like <code>foo = bar</code>. Since you can't write <code>a + b = bar</code>, you can't write <code>++(a + b)</code> either.</p>\n\n<p>There's no real reason why <code>a + b</code> couldn't yield a temporary on which <code>++</code> can operate, and the result of that is the value of the expression <code>++(a + b)</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 1281, "user_id": 5600363, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/d820760191b1bb057846d5a06c2bf5b6?s=128&d=identicon&r=PG", "display_name": "hkBst", "link": "https://stackoverflow.com/users/5600363/hkbst"}, "edited": false, "score": 1, "creation_date": 1529581044, "post_id": 50951669, "comment_id": 88931473, "body": "Your conclusion from these definitions is missing... You want to say that (a+b) does not potentially designate an object, but these paragraphs do not allow that."}], "tags": [], "owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "is_accepted": false, "score": 40, "last_activity_date": 1545341253, "last_edit_date": 1545341253, "creation_date": 1529507870, "answer_id": 50951669, "question_id": 50951261, "link": "https://stackoverflow.com/questions/50951261/why-does-c-ab-give-compilation-error/50951669#50951669", "title": "Why does c = ++(a+b) give compilation error?", "body": "<p>The C11 standard states in section 6.5.3.1</p>\n\n<blockquote>\n  <p>The operand of the prefix increment or decrement operator shall have\n  atomic, qualified, or unqualified real or pointer type, and shall be a\n  modifiable lvalue</p>\n</blockquote>\n\n<p>And \"modifiable lvalue\" is described in section 6.3.2.1 subsection 1</p>\n\n<blockquote>\n  <p>An lvalue is an expression (with an object type other than void) that\n  potentially designates an object; if an lvalue does not designate an\n  object when it is evaluated, the behavior  is  undefined.   When  an \n  object  is  said  to  have  a  particular  type,  the  type  is\n  specified by the lvalue used to designate the object.  <strong>A modifiable\n  lvalue is an lvalue that does  not  have  array  type,  does not  have\n  an  incomplete  type,  does  not  have  a  const-qualified  type,  and\n  if  it  is  a  structure  or  union,  does  not  have  any  member \n  (including, recursively, any  member  or  element  of  all  contained \n  aggregates  or  unions) with  a  const-qualified type.</strong></p>\n</blockquote>\n\n<p>So <code>(a+b)</code> is not a modifiable lvalue and is therefore not eligible for the prefix increment operator.</p>\n"}, {"tags": [], "owner": {"reputation": 1135, "user_id": 5590742, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vNXUZ.png?s=128&g=1", "display_name": "jgreve", "link": "https://stackoverflow.com/users/5590742/jgreve"}, "is_accepted": false, "score": 12, "last_activity_date": 1552227331, "last_edit_date": 1552227331, "creation_date": 1529512812, "answer_id": 50953200, "question_id": 50951261, "link": "https://stackoverflow.com/questions/50951261/why-does-c-ab-give-compilation-error/50953200#50953200", "title": "Why does c = ++(a+b) give compilation error?", "body": "<p>I think you mostly answered your own question.\nI might make a small change to your phrasing and replace \"temporary variable\" with \"rvalue\" as C.Gibbons mentioned.</p>\n\n<p>The terms variable, argument, temporary variable and so on will become more clear as you learn about C's memory model (this looks like a nice overview: <a href=\"https://www.geeksforgeeks.org/memory-layout-of-c-program/\" rel=\"nofollow noreferrer\">https://www.geeksforgeeks.org/memory-layout-of-c-program/</a> ).</p>\n\n<p>The term \"rvalue\" may seem opaque when you're just starting out, so I hope the following helps with developing an intuition about it.</p>\n\n<p>Lvalue/rvalue are talking about the different sides of an equals sign (assignment operator):\nlvalue = left hand side (lowercase L, not a \"one\")\nrvalue = right hand side</p>\n\n<p>Learning a little about how C uses memory (and registers) will be helpful for seeing why the distinction is important.  In <em>broad brush strokes</em>, the compiler creates a list of machine language instructions that compute the result of an expression (the rvalue) and then <em>puts</em> that result somewhere (the lvalue).  Imagine a compiler dealing with the following code fragment:</p>\n\n<pre><code>x = y * 3\n</code></pre>\n\n<p>In assembly pseudocode it <em>might</em> look something like this toy example:</p>\n\n<pre><code>load register A with the value at memory address y\nload register B with a value of 3\nmultiply register A and B, saving the result in A\nwrite register A to memory address x\n</code></pre>\n\n<p>The ++ operator (and its -- counterpart) need a \"somewhere\" to modify, essentially anything that can work as an lvalue.</p>\n\n<p>Understanding the C memory model will be helpful because you'll get a better idea in your head about how arguments get passed to functions and (eventually) how to work with dynamic memory allocation, like the malloc() function.  For similar reasons you might study some simple assembly programming at some point to get a better idea of what the compiler is doing.  Also if you're using <strong>gcc</strong>, the <strong>-S</strong> option \"Stop after the stage of compilation proper; do not assemble.\" can be interesting (though I'd recommend trying it on a <em>small</em> code fragment).</p>\n\n<p>Just as an aside:\nThe ++ instruction <a href=\"https://en.wikipedia.org/wiki/Increment_and_decrement_operators#History\" rel=\"nofollow noreferrer\">has been around since 1969</a> (though it started in C's predecessor, B):  </p>\n\n<blockquote>\n  <p>(Ken Thompson's) observation (was) that the translation of ++x was smaller than that of x=x+1.\"</p>\n</blockquote>\n\n<p>Following that wikipedia reference will take you to an interesting writeup by Dennis Ritchie (the \"R\" in \"K&amp;R C\") on the history of the C language, linked here for convenience: <a href=\"http://www.bell-labs.com/usr/dmr/www/chist.html\" rel=\"nofollow noreferrer\">http://www.bell-labs.com/usr/dmr/www/chist.html</a> where you can search for \"++\".</p>\n"}, {"tags": [], "owner": {"reputation": 61429, "user_id": 572743, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9941673f566f229bc536c1c2b558884e?s=128&d=identicon&r=PG&f=1", "display_name": "Damon", "link": "https://stackoverflow.com/users/572743/damon"}, "is_accepted": false, "score": 6, "last_activity_date": 1531477936, "last_edit_date": 1531477936, "creation_date": 1529588117, "answer_id": 50969936, "question_id": 50951261, "link": "https://stackoverflow.com/questions/50951261/why-does-c-ab-give-compilation-error/50969936#50969936", "title": "Why does c = ++(a+b) give compilation error?", "body": "<p>The reason is that the standard requires the operand being an lvalue. The expression <code>(a+b)</code> is not a lvalue, so applying the increment operator isn't allowed.</p>\n\n<p>Now, one might say <em>\"OK, that's indeed the reason, but there is actually no *real* reason other than that\"</em>, but unluckily the particular wording of how the operator works factually <em>does</em> require that to be the case.</p>\n\n<blockquote>\n  <p>The expression ++E is equivalent to (E+=1).</p>\n</blockquote>\n\n<p>Obviously, you cannot write <code>E += 1</code> if <code>E</code> isn't a lvalue. Which is a shame because one could just as well have said: <em>\"increments E by one\"</em> and be done. In that case, applying the operator on a non-lvalue would (in principle) be perfectly possible, at the expense of making the compiler slightly more complex.</p>\n\n<p>Now, the definition could trivially be reworded (I think it isn't even originally C but an heirloom of B), but doing so would fundamentally change the language to something that's no longer compatible with its former versions. Since the possible benefit is rather small but the possible implications are huge, that never happened and probably is never going to happen.</p>\n\n<p>If you consider C++ in addition to C (question is tagged C, but there was discussion about operator overloads), the story becomes even more complicated. In C, it's hard to imagine that this could be the case, but in C++ the result of <code>(a+b)</code> could very well be something that you cannot increment at all, or incrementing could have very considerable side effects (not just adding 1). The compiler must be able to cope with that, and diagnose problematic cases as they occur. On a lvalue, that's still kinda trivial to check. Not so for any kind of haphazard expression inside a parenthesis that you throw at the poor thing.<br>\nThis isn't a <em>real</em> reason why it <em>couldn't</em> be done, but it sure lends as an explanation why the people who implemented this are not precisely ecstatic to add such a feature which promises very little benefit to very few people.</p>\n"}, {"tags": [], "owner": {"reputation": 185, "user_id": 9906531, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lFN72.jpg?s=128&g=1", "display_name": "Jeet Parikh", "link": "https://stackoverflow.com/users/9906531/jeet-parikh"}, "is_accepted": false, "score": 2, "last_activity_date": 1529992952, "creation_date": 1529992952, "answer_id": 51035833, "question_id": 50951261, "link": "https://stackoverflow.com/questions/50951261/why-does-c-ab-give-compilation-error/51035833#51035833", "title": "Why does c = ++(a+b) give compilation error?", "body": "<p>When ++(a+b) expression performed, then for example :  </p>\n\n<pre><code>int a, b;\na = 10;\nb = 20;\n/* NOTE :\n //step 1: expression need to solve first to perform ++ operation over operand\n   ++ ( exp );\n// in your case \n   ++ ( 10 + 20 );\n// step 2: result of that inc by one \n   ++ ( 30 );\n// here, you're applying ++ operator over constant value and it's invalid use of ++ operator \n*/\n++(a+b);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 153, "user_id": 2599562, "user_type": "registered", "profile_image": "https://graph.facebook.com/1001025033/picture?type=large", "display_name": "Casper B. Hansen", "link": "https://stackoverflow.com/users/2599562/casper-b-hansen"}, "is_accepted": false, "score": 3, "last_activity_date": 1530119250, "creation_date": 1530119250, "answer_id": 51068125, "question_id": 50951261, "link": "https://stackoverflow.com/questions/50951261/why-does-c-ab-give-compilation-error/51068125#51068125", "title": "Why does c = ++(a+b) give compilation error?", "body": "<p>(a+b) evaluates to an rvalue, which cannot be incremented.</p>\n"}, {"tags": [], "owner": {"reputation": 81, "user_id": 6559131, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-LiqIPhoYlAA/AAAAAAAAAAI/AAAAAAAAIqE/Yf3tbZ5us-0/photo.jpg?sz=128", "display_name": "Babu Chandermani", "link": "https://stackoverflow.com/users/6559131/babu-chandermani"}, "is_accepted": false, "score": 3, "last_activity_date": 1531812830, "creation_date": 1531812830, "answer_id": 51375682, "question_id": 50951261, "link": "https://stackoverflow.com/questions/50951261/why-does-c-ab-give-compilation-error/51375682#51375682", "title": "Why does c = ++(a+b) give compilation error?", "body": "<p>++ tries to give the value to the original variable and since (a+b) is a temp value it cannot perform the operation. And they are basically rules of the C programming conventions to make the programming easy. That's it. </p>\n"}], "owner": {"reputation": 1245, "user_id": 9270843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cdd1f497c45bb6c42a363ad660e09c3e?s=128&d=identicon&r=PG&f=1", "display_name": "dng", "link": "https://stackoverflow.com/users/9270843/dng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9506, "favorite_count": 4, "accepted_answer_id": 50951526, "answer_count": 8, "score": 112, "last_activity_date": 1552227331, "creation_date": 1529506769, "last_edit_date": 1529522276, "question_id": 50951261, "link": "https://stackoverflow.com/questions/50951261/why-does-c-ab-give-compilation-error", "title": "Why does c = ++(a+b) give compilation error?", "body": "<p>After researching, I read that the increment operator requires the operand to have a modifiable data object: <a href=\"https://en.wikipedia.org/wiki/Increment_and_decrement_operators\" rel=\"noreferrer\">https://en.wikipedia.org/wiki/Increment_and_decrement_operators</a>.</p>\n\n<p>From this I guess that it gives compilation error because <code>(a+b)</code> is a temporary integer and so is not modifiable.</p>\n\n<p>Is this understanding correct? This was my first time trying to research a problem so if there was something I should have looked for please advise.</p>\n"}, {"tags": ["c", "linux-kernel", "debian"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1529507180, "post_id": 50951147, "comment_id": 88900505, "body": "Could be a duplicate of <a href=\"https://stackoverflow.com/questions/30800331/getrandom-syscall-in-c-not-found\">this</a>"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1529507314, "post_id": 50951147, "comment_id": 88900596, "body": "Since you are writing a <i>kernel module</i>, you can rely only on a small subset of the C standard library and on functions the kernel itself provides to you.  In fact &quot;subset of the C standard library&quot; is misleading -- you can rely on several specific headers, but these define only macros and types, not any callable functions."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1529507481, "post_id": 50951147, "comment_id": 88900713, "body": "The kernel does seem to provide some functions for random number generation, however.  You are already including <code>linux&#47;random.h</code> -- look into the functions it declares for you."}, {"owner": {"reputation": 21, "user_id": 8614820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42bd56f21f54099f59325a548c6526d6?s=128&d=identicon&r=PG&f=1", "display_name": "Projava", "link": "https://stackoverflow.com/users/8614820/projava"}, "edited": false, "score": 0, "creation_date": 1529510069, "post_id": 50951147, "comment_id": 88902384, "body": "John your comment helped me rephrase my question and I found the answer I was looking for <a href=\"https://stackoverflow.com/questions/40961482/how-to-use-get-random-bytes-in-linux-kernel-module\">here</a>. Thank you for the help, I&#39;ll amend the main post"}], "owner": {"reputation": 21, "user_id": 8614820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42bd56f21f54099f59325a548c6526d6?s=128&d=identicon&r=PG&f=1", "display_name": "Projava", "link": "https://stackoverflow.com/users/8614820/projava"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 413, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1529506440, "creation_date": 1529506440, "question_id": 50951147, "link": "https://stackoverflow.com/questions/50951147/how-to-fix-implicit-declaration-of-getrandom-in-kernel-module-compilation", "title": "How to fix implicit declaration of &#39;getrandom&#39; in Kernel Module compilation", "body": "<p>I am attempting to create a Kernel Module, and I am looking to use getrandom to access a secure random from /dev/urandom. I am having problems getting the make to allow the function. Make will not complete and is returning the following error:</p>\n\n<p><code>implicit declaration of function 'getrandom' [-Werror=implicit-function-declaration]</code></p>\n\n<p>What would I need to do to fix this?</p>\n\n<hr>\n\n<p>I've already followed <a href=\"https://stackoverflow.com/questions/10863613/how-to-upgrade-glibc-from-version-2-13-to-2-15-on-debian\">this</a> guide on how to update my glibc library from the sid repositories. Running <code>ldd --version</code> in the terminal will return the following info:</p>\n\n<p><code>ldd (Debian GLIBC 2.27-3) 2.27</code></p>\n\n<hr>\n\n<p>hello-2.c</p>\n\n<pre><code>#define MODULE \n#define LINUX \n#define __KERNEL__\n\n#include &lt;linux/module.h&gt;\n#include &lt;linux/kernel.h&gt;\n#include &lt;linux/init.h&gt;\n#include &lt;linux/random.h&gt;\n\nstatic int hello_2_init(void)\n{\n printk(\"Hello, world 2\\n\");\n int rnd = 0;\n void *buf;\n getrandom(rnd, 256, 0);\n printk(\"Number is %d \", rnd);\n return 0;\n}\n</code></pre>\n\n<hr>\n\n<p>The expected result would be getrandom to not prevent my program from compiling into a kernel mod and return a random int, but the current result is the fatal compilation error. </p>\n"}, {"tags": ["c", "types", "declaration"], "comments": [{"owner": {"reputation": 705, "user_id": 8359764, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZZGPy.jpg?s=128&g=1", "display_name": "hat", "link": "https://stackoverflow.com/users/8359764/hat"}, "edited": false, "score": 0, "creation_date": 1529506492, "post_id": 50951054, "comment_id": 88900004, "body": "Since the error message gives you the line number for the error, you should be able to find where it is, and post a more concise piece of code containing the error."}, {"owner": {"reputation": 19, "user_id": 9967905, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28b9012405570173b76b185cf703e6b6?s=128&d=identicon&r=PG&f=1", "display_name": "F Pierron", "link": "https://stackoverflow.com/users/9967905/f-pierron"}, "reply_to_user": {"reputation": 705, "user_id": 8359764, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZZGPy.jpg?s=128&g=1", "display_name": "hat", "link": "https://stackoverflow.com/users/8359764/hat"}, "edited": false, "score": 0, "creation_date": 1529523673, "post_id": 50951054, "comment_id": 88909315, "body": "Thank you, i do know the problem lies in my PID_Courant(...) function, but i can&#39;t see what is wrong with it."}, {"owner": {"reputation": 811, "user_id": 9493582, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bfI3b.jpg?s=128&g=1", "display_name": "Arndt Jonasson", "link": "https://stackoverflow.com/users/9493582/arndt-jonasson"}, "edited": false, "score": 0, "creation_date": 1529526473, "post_id": 50951054, "comment_id": 88910494, "body": "<code>PID_Courant</code> seems to have 5 arguments in one place, and 6 and 7 in other places."}, {"owner": {"reputation": 811, "user_id": 9493582, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bfI3b.jpg?s=128&g=1", "display_name": "Arndt Jonasson", "link": "https://stackoverflow.com/users/9493582/arndt-jonasson"}, "edited": false, "score": 1, "creation_date": 1529526765, "post_id": 50951054, "comment_id": 88910615, "body": "What J\u01ddss\u01dd meant was that you should make the code exhibiting the problem as small as possible, removing all irrelevant parts. It makes it much easier to find the error, and to make others interested in finding the error for you."}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 9967905, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28b9012405570173b76b185cf703e6b6?s=128&d=identicon&r=PG&f=1", "display_name": "F Pierron", "link": "https://stackoverflow.com/users/9967905/f-pierron"}, "edited": false, "score": 0, "creation_date": 1529933783, "post_id": 50963456, "comment_id": 89042043, "body": "ty very much, i found out a few days ago !"}, {"owner": {"reputation": 705, "user_id": 8359764, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZZGPy.jpg?s=128&g=1", "display_name": "hat", "link": "https://stackoverflow.com/users/8359764/hat"}, "reply_to_user": {"reputation": 19, "user_id": 9967905, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28b9012405570173b76b185cf703e6b6?s=128&d=identicon&r=PG&f=1", "display_name": "F Pierron", "link": "https://stackoverflow.com/users/9967905/f-pierron"}, "edited": false, "score": 0, "creation_date": 1529934093, "post_id": 50963456, "comment_id": 89042267, "body": "Great! To mark your question as solved you can mark the answer as correct by clicking the check mark underneath the voting buttons (this will also give you two reputation points)"}], "tags": [], "owner": {"reputation": 705, "user_id": 8359764, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZZGPy.jpg?s=128&g=1", "display_name": "hat", "link": "https://stackoverflow.com/users/8359764/hat"}, "is_accepted": false, "score": 0, "last_activity_date": 1529568417, "creation_date": 1529568417, "answer_id": 50963456, "question_id": 50951054, "link": "https://stackoverflow.com/questions/50951054/issues-with-conflicting-declarations-and-type-redeclaration-on-pic18f87f22-c-la/50963456#50963456", "title": "Issues with conflicting declarations and type redeclaration on PIC18F87f22 (C language)", "body": "<p>I didn't get a chance to read through your code yesterday (you posted quite a lot of it) but I think I have found your error. In your mcc.h you have declared <code>PID_courant</code> as</p>\n\n<pre><code>int16_t PID_Courant(int16_t erreur_courant, int16_t consigne_courant, int16_t kp_courant, int16_t ki_courant, int16_t kd_courant,int wind_up_flag_courant);\n</code></pre>\n\n<p>However, in your mcc.c you declare and define it as</p>\n\n<pre><code>int16_t PID_Courant(int16_t erreur_courant, int16_t consigne_courant,int16_t integrale_courant, int16_t kp_courant, int16_t ki_courant, int16_t kd_courant,int16_t wind_up_flag_courant)\n</code></pre>\n\n<p>If you compare the two, you will find that the first one (in mcc.h) is missing the third argument, <code>int16_t integrale_courant</code>. You also declare the last argument as <code>int wind_up_flag_courant</code> it mcc.h but as <code>int16_t wind_up_flag_courant</code> in mcc.c.</p>\n\n<p>Essentially, your code tries to change <code>PID_courant</code> from how it is declared in mcc.h; i.e. trying to redefine it. This is what throws your error.</p>\n"}], "owner": {"reputation": 19, "user_id": 9967905, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28b9012405570173b76b185cf703e6b6?s=128&d=identicon&r=PG&f=1", "display_name": "F Pierron", "link": "https://stackoverflow.com/users/9967905/f-pierron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 447, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1529568417, "creation_date": 1529506164, "last_edit_date": 1529507259, "question_id": 50951054, "link": "https://stackoverflow.com/questions/50951054/issues-with-conflicting-declarations-and-type-redeclaration-on-pic18f87f22-c-la", "title": "Issues with conflicting declarations and type redeclaration on PIC18F87f22 (C language)", "body": "<p>I would first like to apologize for my bad English and also for my <strong><em>very</em></strong> basic skills with C language. I am really struggling.</p>\n\n<p>I'm currently trying to implement a cascade PID regulation for a DC motor. I'm using a PIC1887f22 for my regulation and am coding with MPLAB X IDE 4.05.</p>\n\n<p>I'm having some issues while trying to build the project, and I need some guidance from you guys.</p>\n\n<p>Here is the prototype/declaration of my PID function in a file called mcc.c</p>\n\n<pre><code>int16_t PID_Courant(int16_t erreur_courant, int16_t consigne_courant,int16_t \nintegrale_courant, int16_t kp_courant, int16_t ki_courant, int16_t \nkd_courant,int16_t wind_up_flag_courant)\n{\n    int32_t prop=0;\n    int32_t dev=0;\n    int16_t Erreur_courant_old=0;\n    int32_t integra=0;\n    int32_t u=0;\n    int16_t a=0;\n\n    Erreur_courant_old = erreur_courant;\n    a = get_courant();\n    erreur_courant = consigne_courant-a;\n    prop = kp_courant * erreur_courant;\n\n    if(!wind_up_flag_courant)\n    {\n        integrale_courant = integrale_courant + erreur_courant;\n    }\n\n    integra = ki_courant * integrale_courant;\n    dev = erreur_courant-Erreur_courant_old;\n    u = prop + integra + dev;\n    u = u/100000000;\n    if (abs(u)&gt;TENSION_MAX)\n    {\n        wind_up_flag_courant=1;\n        if(u&lt;0)\n        {\n            u=-TENSION_MAX;\n        }\n        else\n        {\n            u=TENSION_MAX;\n        }\n    }\n\n    return u;\n}\n</code></pre>\n\n<p>The parameters of the function are all declared as global variables in my main.c (before my main function) as follows:</p>\n\n<pre><code>#include &lt;xc.h&gt;\n#include\"mcc_generated_files/epwm1.h\"\n#include\"mcc_generated_files/epwm2.h\"\n#include\"mcc_generated_files/epwm3.h\" \n#include\"mcc_generated_files/interrupt_manager.h\"\n#include\"mcc_generated_files/mcc.h\"\n#include\"mcc_generated_files/tmr2.h\"\n#include\"mcc_generated_files/pin_manager.h\"\n#define KE 1\n#define KC 1\n#define TE_COURANT 0.00001\n#define TE_VITESSE 0.0001\n#define VITESSE_MAX 60000\n#define COURANT_MAX 50000 //mA\n#define TENSION_MAX 240000 //mV\nint16_t Security_flag=1;\nint Stop_flag=1;\nint Start_flag=0;\nint Wind_up_flag_courant=0;\nint Wind_up_flag_vitesse=0;\nint Emergency_flag=0;\nint Choix_Mode=0;\nint16_t MESURE_COURANT=0;\nint16_t MESURE_VITESSE=0;\nint16_t Consigne_courant =0;\nint16_t Consigne_vitesse = 0;\nint16_t Kp_courant=0;\nint16_t Ki_courant=0;\nint16_t Kd_courant=0;\nint16_t Kp_vitesse=0;\nint16_t Ki_vitesse=0;\nint16_t Kd_vitesse=0;\nint16_t Erreur_courant=0;\nint16_t Erreur_vitesse=0;\nint32_t Integrale_courant=0;\nint32_t Integrale_vitesse=0; \n</code></pre>\n\n<p>The trick is that inside of the <code>PID_Courant</code> function, I modify the variables that are used to call the function, and I'm not really sure if that is ok for my compiler. Anyway, I'm getting these error codes:</p>\n\n<blockquote>\n<pre><code>mcc_generated_files/mcc.c:116: error: (984) type redeclared\n</code></pre>\n</blockquote>\n\n<p>and: </p>\n\n<blockquote>\n<pre><code>mcc_generated_files/mcc.c:116: error: (1098) conflicting declarations for variable \"PID_Courant\" (mcc_generated_files/mcc.c:115)\n</code></pre>\n</blockquote>\n\n<p>I can't see what conflicts there are here. Is it because I'm trying to put the result of the multiplication of two <code>int16_t</code> into another <code>int16_t</code>?</p>\n\n<p>I tried switching some of those variables to <code>int32_t</code>, but it changed nothing.</p>\n\n<p>Here is the full code of my main.c:</p>\n\n<pre><code>#include &lt;xc.h&gt;\n#include\"mcc_generated_files/epwm1.h\"\n#include\"mcc_generated_files/epwm2.h\"\n#include\"mcc_generated_files/epwm3.h\"\n#include\"mcc_generated_files/interrupt_manager.h\"\n#include\"mcc_generated_files/mcc.h\"\n#include\"mcc_generated_files/tmr2.h\"\n#include\"mcc_generated_files/pin_manager.h\"\n\n#define KE 1\n#define KC 1\n#define TE_COURANT 0.00001\n#define TE_VITESSE 0.0001\n\n#define VITESSE_MAX 60000\n#define COURANT_MAX 50000 //mA\n#define TENSION_MAX 240000 //mV\nint16_t Security_flag=1;\nint Stop_flag=1;\nint Start_flag=0;\nint Wind_up_flag_courant=0;\nint Wind_up_flag_vitesse=0;\nint Emergency_flag=0;\nint Choix_Mode=0;\nint16_t MESURE_COURANT=0;\nint16_t MESURE_VITESSE=0;\nint16_t Consigne_courant =0;\nint16_t Consigne_vitesse = 0;\nint16_t Kp_courant=0;\nint16_t Ki_courant=0;\nint16_t Kd_courant=0;\nint16_t Kp_vitesse=0;\nint16_t Ki_vitesse=0;\nint16_t Kd_vitesse=0;\nint16_t Erreur_courant=0;\nint16_t Erreur_vitesse=0;\nint32_t Integrale_courant=0;\nint32_t Integrale_vitesse=0;\n\nvoid main(void) \n{\n    SYSTEM_Initialize();\n\n    TMR2_StartTimer();\n\n    while(!Start_flag)\n    {\n       ;\n    }\n    if(Choix_Mode)\n    {\n        EPWM2_Initialize();\n        EPWM3_Initialize();\n    }\n    else\n    {\n        EPWM1_Initialize(); \n    }\n    Consigne_courant=PID_Vitesse(Erreur_vitesse,Consigne_vitesse,Kp_vitesse,Ki_vitesse,Kd_vitesse,Wind_up_flag_vitesse);\n    while(!Stop_flag)\n    {\n        int16_t tension=0;\n        int i=0;\n        do\n        {\n            tension = PID_Courant(Erreur_courant,Consigne_courant,Integrale_courant,Kp_courant,Ki_courant,Kd_courant,Wind_up_flag_courant);\n            Put_Rapport_Cyclique(tension,Choix_Mode);\n            i++;\n        }while(i&lt;10);\n       Consigne_courant = PID_Vitesse(Erreur_vitesse,Consigne_vitesse,Integrale_vitesse,Kp_vitesse,Ki_vitesse,Kd_vitesse,Wind_up_flag_vitesse);\n       Security_flag = Update_Security_flag();\n    }\n    if(Choix_Mode)\n    {\n         STOP_EPWM2();\n         STOP_EPWM3(); \n    }\n    else\n    {\n        STOP_EPWM1();\n    }\n}\n</code></pre>\n\n<p>And here is my mcc.c:</p>\n\n<pre><code>#include \"mcc.h\"\n#define A 399/240000\n#define B 199/240000\n#define VITESSE_MAX 6000\n#define COURANT_MAX 5000 //mA\n#define TENSION_MAX 24000 //mV\n\nvoid SYSTEM_Initialize(void)\n{\n    INTERRUPT_Initialize();\n    PIN_MANAGER_Initialize();\n    OSCILLATOR_Initialize();\n    //EPWM1_Initialize();\n    TMR2_Initialize();\n    //EPWM2_Initialize();\n    //EPWM3_Initialize();\n}\n\nvoid OSCILLATOR_Initialize(void)\n{\n    // SCS FOSC; IDLEN disabled; IRCF 16MHz_HF; \n    OSCCON = 0x70;\n    // SOSCGO disabled; MFIOSEL disabled; \n    OSCCON2 = 0x00;\n    // INTSRC INTRC; PLLEN disabled; TUN 0; \n    OSCTUNE = 0x00;\n    // ROSEL System Clock(FOSC); ROON disabled; ROSSLP Disabled in Sleep mode; RODIV Fosc; \n    REFOCON = 0x00;\n}\nint16_t get_courant()\n{\n    return 1;      \n}\nint16_t get_vitesse()\n{\n  return 1; \n}\nint16_t PID_Courant(int16_t erreur_courant, int16_t consigne_courant,int16_t integrale_courant, int16_t kp_courant, int16_t ki_courant, int16_t kd_courant,int16_t wind_up_flag_courant)\n{\n    int32_t prop=0;\n    int32_t dev=0;\n    int16_t Erreur_courant_old=0;\n    int32_t integra=0;\n    int32_t u=0;\n    int16_t a=0;\n\n    Erreur_courant_old = erreur_courant;\n    a = get_courant();\n    erreur_courant = consigne_courant-a;\n    prop = kp_courant * erreur_courant;\n\n    if(!wind_up_flag_courant)\n    {\n        integrale_courant = integrale_courant + erreur_courant;\n    }\n\n    integra = ki_courant * integrale_courant;\n    dev = erreur_courant-Erreur_courant_old;\n    u = prop + integra + dev;\n    u = u/100000000;\n    if (abs(u)&gt;TENSION_MAX)\n    {\n        wind_up_flag_courant=1;\n        if(u&lt;0)\n        {\n            u=-TENSION_MAX;\n        }\n        else\n        {\n            u=TENSION_MAX;\n        }\n    }\n\n    return u;\n}\n\nint16_t PID_Vitesse(int16_t erreur_vitesse, int16_t consigne_vitesse,int16_t integrale_vitesse ,int16_t Kk_vitesse, int16_t ki_vitesse, int16_t kd_vitesse, int wind_up_flag_vitesse)\n{\n    int16_t prop=0;\n    int16_t dev=0;\n    int32_t integra=0;\n    int32_t u=0;\n    int16_t a=0;\n    int16_t Erreur_vitesse_old=0;\n\n    Erreur_vitesse_old = Erreur_vitesse;\n    a = get_vitesse();\n    Erreur_vitesse = Consigne_vitesse-a;\n    prop = Kp_vitesse * Erreur_vitesse;\n\n    if(!Wind_up_flag_vitesse)\n    {\n        Integrale_vitesse = Integrale_vitesse + Erreur_vitesse;\n    }\n\n    integra = Ki_vitesse*Integrale_vitesse;\n    dev = Erreur_vitesse-Erreur_vitesse_old;\n    u = prop + integra + dev;\n    u = u / (1000000);\n    if (u&gt;abs(COURANT_MAX))\n    {\n        Wind_up_flag_vitesse=1;\n        if(u&lt;0)\n        {\n            u=-COURANT_MAX;\n        }\n        else\n        {\n            u=COURANT_MAX;\n        }\n    }\n\n    return u;\n}\n\nvoid Put_Rapport_Cyclique(int16_t u, int choix_mode)\n{\n    if(choix_mode=1)\n    {\n        if (u&lt;=0)\n        {\n            bit_set(CCP1CON,1);\n        }\n        else\n        {\n            bit_clr(CCP1CON,1);\n        }\n        u=A*u;\n        EPWM1_LoadDutyValue(u);\n    }\n    else\n    {\n        u=199+u*B;\n    }\n    EPWM2_LoadDutyValue(u);\n    EPWM3_LoadDutyValue(u);\n}\n\nint Update_Security_flag(void)\n{\n    int a=0;\n    int b=0;\n\n    a=get_courant();\n    b=get_vitesse();\n    if (abs(a)&gt; COURANT_MAX || abs(b)&gt; VITESSE_MAX)\n    {\n        return 1;\n    }\n    else\n    {\n        return 0;\n    }\n}\n\nvoid STOP_EPWM1(void)\n{\n    bits_off(CCP1CON,0b00001111);\n}\n//EPWM1_LoadDutyValue(0);\nvoid STOP_EPWM2(void)\n{\n    //EPWM2_LoadDutyValue(0);\n    bits_off(CCP2CON,0b00001111);\n}\nvoid STOP_EPWM3(void)\n{\n    //EPWM3_LoadDutyValue(0);\n    bits_off(CCP3CON, 0b00001111);\n}\n</code></pre>\n\n<p>and the mcc.h :</p>\n\n<pre><code>#define MCC_H\n#include &lt;xc.h&gt;\n#include&lt;math.h&gt;\n#include&lt;stdlib.h&gt;\n#include&lt;stdio.h&gt;\n#include&lt;stdint.h&gt;\n#include \"pin_manager.h\"\n#include &lt;stdint.h&gt;\n#include &lt;stdbool.h&gt;\n#include \"interrupt_manager.h\"\n#include \"epwm1.h\"\n#include \"epwm2.h\"\n#include \"tmr2.h\"\n#include \"epwm3.h\"\n#define unsigned char  RAPPORT_CYCLIQUE 0\n#define bit_set(var,bitno) ((var) |= 1 &lt;&lt; (bitno))\n#define bit_clr(var,bitno) ((var) &amp;= ~(1 &lt;&lt; (bitno)))\n#define bits_on(var,mask) var |= mask\n#define bits_off(var,mask) var &amp;= ~0 ^ mask\n#define _XTAL_FREQ  16000000\n\n/*\n * Initializes the device to the default states configured in the MCC GUI\n */\nvoid SYSTEM_Initialize(void);\n\n/*\n * Initializes the oscillator to the default states configured in the MCC GUI\n */\nvoid OSCILLATOR_Initialize(void);\nvoid STOP_EPWM1(void);\nvoid STOP_EPWM2(void);\nvoid STOP_EPWM3(void);\nint16_tget_courant(void);\nint16_tget_vitesse(void);\nint16_t PID_Courant(int16_t erreur_courant, int16_t consigne_courant, int16_t kp_courant, int16_t ki_courant, int16_t kd_courant,int wind_up_flag_courant);\nint16_t PID_Vitesse(int16_t erreur_vitesse, int16_t consigne_vitesse, int16_t kp_vitesse, int16_t ki_vitesse, int16_t kd_vitesse,int wind_up_flag_vitesse);\nint16_t Put_Rapport_cyclique(int16_t u, int choix_mode);\nint Update_Security_flag(void);\n</code></pre>\n\n<p>Can anyone see a problem here?\nWhat do you think cause these errors ?\nThank you very much for even reading this!!</p>\n"}, {"tags": ["c", "security", "buffer", "overflow"], "comments": [{"owner": {"reputation": 198, "user_id": 9317706, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd96f97c58b306523bb8defb014daab6?s=128&d=identicon&r=PG&f=1", "display_name": "purec", "link": "https://stackoverflow.com/users/9317706/purec"}, "edited": false, "score": 1, "creation_date": 1529507463, "post_id": 50951013, "comment_id": 88900696, "body": "getenv[&quot;CONTENT_LENGTH&quot;] -- What is this???"}, {"owner": {"reputation": 342, "user_id": 2038089, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b63f7e356acc7018e0c5c57bbf632532?s=128&d=identicon&r=PG", "display_name": "Ahmad Bilal", "link": "https://stackoverflow.com/users/2038089/ahmad-bilal"}, "reply_to_user": {"reputation": 198, "user_id": 9317706, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd96f97c58b306523bb8defb014daab6?s=128&d=identicon&r=PG&f=1", "display_name": "purec", "link": "https://stackoverflow.com/users/9317706/purec"}, "edited": false, "score": 0, "creation_date": 1529508478, "post_id": 50951013, "comment_id": 88901339, "body": "Sorry, was in a hurry (had to step away for a bit), thus the mistake. If you see the linked question, I had the right syntax there. Anyways fixed. Thanks."}, {"owner": {"reputation": 198, "user_id": 9317706, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd96f97c58b306523bb8defb014daab6?s=128&d=identicon&r=PG&f=1", "display_name": "purec", "link": "https://stackoverflow.com/users/9317706/purec"}, "edited": false, "score": 0, "creation_date": 1529509027, "post_id": 50951013, "comment_id": 88901701, "body": "char *some = getenv(&quot;CONTENT_LENGTH&quot;);"}, {"owner": {"reputation": 342, "user_id": 2038089, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b63f7e356acc7018e0c5c57bbf632532?s=128&d=identicon&r=PG", "display_name": "Ahmad Bilal", "link": "https://stackoverflow.com/users/2038089/ahmad-bilal"}, "reply_to_user": {"reputation": 198, "user_id": 9317706, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd96f97c58b306523bb8defb014daab6?s=128&d=identicon&r=PG&f=1", "display_name": "purec", "link": "https://stackoverflow.com/users/9317706/purec"}, "edited": false, "score": 0, "creation_date": 1529511099, "post_id": 50951013, "comment_id": 88903011, "body": "Well, that is not helpful. I&#39;m playing with data types here, hence I didn&#39;t use a single line. Besides, this question is not related to that, but instead getenv_s"}], "answers": [{"comments": [{"owner": {"reputation": 342, "user_id": 2038089, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b63f7e356acc7018e0c5c57bbf632532?s=128&d=identicon&r=PG", "display_name": "Ahmad Bilal", "link": "https://stackoverflow.com/users/2038089/ahmad-bilal"}, "edited": false, "score": 0, "creation_date": 1529511879, "post_id": 50952165, "comment_id": 88903492, "body": "I don&#39;t know about other _s functions, but I have already seen getenv_s being used in the book &quot;ModernC(by Jens Gustedt)&quot; as well as &quot;C in a Nutshell (by Peter Prinz)&quot;, where they actually recommend it instead of getenv. Portability is not a issue here, in-case that is what you are worried about. I only intend to run it on a single server with latest GCC. I also found this post on windows: <a href=\"https://msdn.microsoft.com/en-us/library/tb2sfw2z.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/tb2sfw2z.aspx</a>"}, {"owner": {"reputation": 342, "user_id": 2038089, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b63f7e356acc7018e0c5c57bbf632532?s=128&d=identicon&r=PG", "display_name": "Ahmad Bilal", "link": "https://stackoverflow.com/users/2038089/ahmad-bilal"}, "edited": false, "score": 0, "creation_date": 1529512962, "post_id": 50952165, "comment_id": 88904068, "body": "Even after using fgets in my current script, should I still be worried about reading more than or less than CONTENT_LENGTH? And what if, CONTENT_LENGTH contains dangerous input? The only way I can think of logically is to accept only 1 to X (numerical/integer) value of CONTENT_LENGTH, and else throw an error page."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "reply_to_user": {"reputation": 342, "user_id": 2038089, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b63f7e356acc7018e0c5c57bbf632532?s=128&d=identicon&r=PG", "display_name": "Ahmad Bilal", "link": "https://stackoverflow.com/users/2038089/ahmad-bilal"}, "edited": false, "score": 0, "creation_date": 1529516713, "post_id": 50952165, "comment_id": 88906081, "body": "@AhmadBilal Yes, you do still have to worry about there being more or less data available than CONTENT_LENGTH says.  fgets will not return more data than you tell it to read <i>in one call</i>, but if you&#39;re assuming that CONTENT_LENGTH bytes are always immediately followed by an EOF you could be in trouble.  &quot;Accept only 1 to X value of CONTENT_LENGTH&quot; is exactly what the above function does."}, {"owner": {"reputation": 342, "user_id": 2038089, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b63f7e356acc7018e0c5c57bbf632532?s=128&d=identicon&r=PG", "display_name": "Ahmad Bilal", "link": "https://stackoverflow.com/users/2038089/ahmad-bilal"}, "edited": false, "score": 0, "creation_date": 1529592971, "post_id": 50952165, "comment_id": 88939698, "body": "I&#39;m looking at it, and trying a few things on my own as well. I will reply back here tomorrow. Thanks for your contribution btw."}, {"owner": {"reputation": 342, "user_id": 2038089, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b63f7e356acc7018e0c5c57bbf632532?s=128&d=identicon&r=PG", "display_name": "Ahmad Bilal", "link": "https://stackoverflow.com/users/2038089/ahmad-bilal"}, "edited": false, "score": 0, "creation_date": 1530106361, "post_id": 50952165, "comment_id": 89118207, "body": "Can you please add a answer that uses getenv_s as well?"}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "reply_to_user": {"reputation": 342, "user_id": 2038089, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b63f7e356acc7018e0c5c57bbf632532?s=128&d=identicon&r=PG", "display_name": "Ahmad Bilal", "link": "https://stackoverflow.com/users/2038089/ahmad-bilal"}, "edited": false, "score": 0, "creation_date": 1530108633, "post_id": 50952165, "comment_id": 89119835, "body": "As it should not be used, I decline to do that."}, {"owner": {"reputation": 342, "user_id": 2038089, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b63f7e356acc7018e0c5c57bbf632532?s=128&d=identicon&r=PG", "display_name": "Ahmad Bilal", "link": "https://stackoverflow.com/users/2038089/ahmad-bilal"}, "edited": false, "score": 0, "creation_date": 1531795555, "post_id": 50952165, "comment_id": 89716868, "body": "What is your opinion on strnlen (note, not strlen)? in regards to string length safety discussed above ?"}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "reply_to_user": {"reputation": 342, "user_id": 2038089, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b63f7e356acc7018e0c5c57bbf632532?s=128&d=identicon&r=PG", "display_name": "Ahmad Bilal", "link": "https://stackoverflow.com/users/2038089/ahmad-bilal"}, "edited": false, "score": 0, "creation_date": 1531840207, "post_id": 50952165, "comment_id": 89741537, "body": "@AhmadBilal I don&#39;t understand how strnlen would be useful in this context, but this is probably because I don&#39;t have a clear enough picture of what you are thinking of doing with it. Please ask a new question about that."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "reply_to_user": {"reputation": 342, "user_id": 2038089, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b63f7e356acc7018e0c5c57bbf632532?s=128&d=identicon&r=PG", "display_name": "Ahmad Bilal", "link": "https://stackoverflow.com/users/2038089/ahmad-bilal"}, "edited": false, "score": 0, "creation_date": 1531840249, "post_id": 50952165, "comment_id": 89741577, "body": "@AhmadBilal Note however that POST data can be arbitrary binary data, so treating it as a C string is definitely the wrong approach."}], "tags": [], "owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "is_accepted": true, "score": 3, "last_activity_date": 1529509343, "creation_date": 1529509343, "answer_id": 50952165, "question_id": 50951013, "link": "https://stackoverflow.com/questions/50951013/working-with-getenv-s-in-c-to-process-content-length/50952165#50952165", "title": "Working with getenv_s in C to process CONTENT_LENGTH", "body": "<p>First off, do not use any of the <code>_s</code> functions.  They are an <em>optional</em> feature of C11 which, to my knowledge, has never been fully implemented by anyone, not even Microsoft, which invented them, and it has been proposed to remove them again; even more importantly, they do not actually solve the problems they purport to address.  (The intention was to have a bunch of drop-in replacements for dangerous string-related functions, but it turns out that that doesn't work; fixing string-related security bugs in C programs requires actual redesign with thought put into it.  The functions that genuinely could not be used safely already had portable replacements, e.g. <code>fgets</code> instead of <code>gets</code>, <code>snprintf</code> instead of <code>sprintf</code>, <code>strsep</code> instead of <code>strtok</code> -- sometimes the replacement is not in ISO C but it's usually widespread enough not to worry about, or you can get a shim implementation from <a href=\"https://www.gnu.org/software/gnulib/\" rel=\"nofollow noreferrer\">gnulib</a>.)</p>\n\n<p><code>getenv</code> is guaranteed to return a valid NUL-terminated C string (or a null pointer), but the string could be arbitrarily long.  In the context of a CGI program written in C, the correct way to \"sanitize\" the value of the <code>CONTENT_LENGTH</code> environment variable is to feed it to <code>strtol</code> and carefully check for errors:</p>\n\n<pre><code>/* Returns a valid content_length, or -1 on error.  */\nlong get_content_length(void)\n{\n    char *content_length, *endp;\n    long rv;\n\n    content_length = getenv(\"CONTENT_LENGTH\");\n    if (!content_length) return -1;\n    errno = 0;\n    rv = strtol(content_length, &amp;endp, 10);\n    if (endp == content_length || *endp || errno || rv &lt;= 0)\n        return -1;\n    return rv;\n}\n</code></pre>\n\n<p>Each of the four clauses in the <code>if</code> statement after the <code>strtol</code> call checks for a different class of ill-formed input.  You have to clear <code>errno</code> explicitly before the call, because the value <code>strtol</code> returns when it reports an overflow is also a value it can return when there was no overflow, so the only way to distinguish is to look at <code>errno</code>, but <code>errno</code> could have a stale nonzero value from some earlier operation.</p>\n\n<p>Note that even if <code>CONTENT_LENGTH</code> is syntactically valid, it might not be <em>trustworthy</em>.  That is, the actual amount of POST data available to you might be either less or more than <code>CONTENT_LENGTH</code>.  Make sure to pay attention to the numbers returned by <code>read</code> as well.  (This is an example of how swapping out string functions for \"hardened\" ones doesn't solve all your problems.)</p>\n"}], "owner": {"reputation": 342, "user_id": 2038089, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b63f7e356acc7018e0c5c57bbf632532?s=128&d=identicon&r=PG", "display_name": "Ahmad Bilal", "link": "https://stackoverflow.com/users/2038089/ahmad-bilal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1408, "favorite_count": 0, "accepted_answer_id": 50952165, "answer_count": 1, "score": -1, "last_activity_date": 1529509343, "creation_date": 1529506073, "last_edit_date": 1529508342, "question_id": 50951013, "link": "https://stackoverflow.com/questions/50951013/working-with-getenv-s-in-c-to-process-content-length", "title": "Working with getenv_s in C to process CONTENT_LENGTH", "body": "<p>Being new to C, I just came across the C11 addition getenv_s. Here is what I'm actually trying to do:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/50752374/handling-post-data-sent-by-html-form-in-cgi-c\">Handling POST data sent by html form in CGI C</a></p>\n\n<p>I'm trying to sanitize, both CONTENT_LENGTH and message-body(stdin) in my case. That is the objective here.</p>\n\n<p>So in order to limit the upper-bounds (against malformed CONTENT_LENGTH, trying to cause overflow), I tried using an array instead of pointer, like this:</p>\n\n<pre><code>char some[512];\nsome = getenv(\"CONTENT_LENGTH\");\n</code></pre>\n\n<p>It naturally threw an error (incompatible types when assigning to type char[512] from type char *). So I assume, </p>\n\n<p>Q1. getenv is already a string?   </p>\n\n<p>Then I came across \"getenv_s\"<br>\n<a href=\"http://en.cppreference.com/w/c/program/getenv\" rel=\"nofollow noreferrer\">http://en.cppreference.com/w/c/program/getenv</a></p>\n\n<p>Q2. Can anyone tell me a safe-as-rocksolid way of using this? To avoid underflow, overflow, etc.  </p>\n"}, {"tags": ["c", "assembly", "x86", "mutex", "memory-barriers"], "comments": [{"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1529506335, "post_id": 50951011, "comment_id": 88899878, "body": "Why didn&#39;t you undelete and edit your previous version of this: <a href=\"https://stackoverflow.com/questions/50948788/how-does-a-mutex-lock-and-unlock-accomplishes-acquire-and-release-semantics\" title=\"how does a mutex lock and unlock accomplishes acquire and release semantics\">stackoverflow.com/questions/50948788/&hellip;</a>?  This is the same question with minor edits, and Martin&#39;s comment still applies."}, {"owner": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 1, "creation_date": 1529508184, "post_id": 50951011, "comment_id": 88901155, "body": "&quot;I assume that the above quote is talking about CPU reordering and not about compiler reordering.&quot;  Certainly, locking/unlocking a pthread mutex MUST ensure the compiler does not re-order the instructions it is protecting. So the quote is talking about both compiler and CPU reordering - they&#39;re equally important from the point of a pthread mutex."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1529511967, "post_id": 50951011, "comment_id": 88903547, "body": "It is the <i>implementations</i> of <code>pthread_mutex_lock()</code> and <code>pthread_mutex_unlock()</code> that realize their promises about runtime ordering.  CPUs that perform such reordering also have instructions for modulating it, and the mutex lock / unlock functions use these (among other things)."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1529517903, "post_id": 50951011, "comment_id": 88906638, "body": "@JohnBollinger: I already mentioned this in my answer.  I highlighted it since it&#39;s an important point about why the mutex functions are special."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1529519014, "post_id": 50951011, "comment_id": 88907160, "body": "And I already upvoted your answer, @PeterCordes, and I declined to write one of my own.  But your answer is so full of information that even with the highlighting, it is easy to overlook this point -- which I think is the crux -- within."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1529519302, "post_id": 50951011, "comment_id": 88907299, "body": "@JohnBollinger: That&#39;s fair, it&#39;s definitely a key point.  I started writing before reading the question super carefully, so I probably answered some stuff that the question doesn&#39;t ask explicitly.  Seemed like a good idea to cover a bunch of related ground.  (And I started with compiler reordering because I&#39;d just been looking at another Q&amp;A about that. :P)"}, {"owner": {"reputation": 50907, "user_id": 149138, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/cfd457233c8ebbab383475fc097442d9?s=128&d=identicon&r=PG", "display_name": "BeeOnRope", "link": "https://stackoverflow.com/users/149138/beeonrope"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1529522707, "post_id": 50951011, "comment_id": 88908864, "body": "I wrote my answer because although @PeterCordes answer is great I thought this question also deserved one &quot;little&quot; answer just focusing on the narrow thing that I thought the OP was asking: how does the compiler/runtime/implementation prevent CPU reordering (not compiler reordering). The answer for that is simple: the implementation includes barriers which prevent CPU reordering. The OP commented on my answer which reveals their original misunderstanding: that reordering could occur around <code>call</code> as if it were any other instruction. It can&#39;t. Reordering happens against the &quot;dynamic trace&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 3378, "user_id": 2069150, "user_type": "registered", "accept_rate": 12, "profile_image": "https://i.stack.imgur.com/filKc.jpg?s=128&g=1", "display_name": "Arch D. Robison", "link": "https://stackoverflow.com/users/2069150/arch-d-robison"}, "edited": false, "score": 0, "creation_date": 1529624324, "post_id": 50951199, "comment_id": 88953397, "body": "Being a non-inline function call is not necessarily enough to prevent compile-time reordering across the call.  For example, if a translation unit has file-scope static variables, and the compiler can prove that their addresses are not accessible to the call, then the compiler is free to reorder accesses to those variables, across the call, even though those variables could be accessed by more than one thread."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 3378, "user_id": 2069150, "user_type": "registered", "accept_rate": 12, "profile_image": "https://i.stack.imgur.com/filKc.jpg?s=128&g=1", "display_name": "Arch D. Robison", "link": "https://stackoverflow.com/users/2069150/arch-d-robison"}, "edited": false, "score": 1, "creation_date": 1529624821, "post_id": 50951199, "comment_id": 88953487, "body": "@ArchD.Robison: A compiler could only prove that if the only functions that touch the <code>static</code> var are themselves <code>static</code>, and not called from any non-<code>static</code> functions and don&#39;t have the function address passed to any black-box functions.  Otherwise it has to assume that the unknown function can call back into this translation unit to eventually reach a function that reads or writes the static var. Thread-creation and signal-handler functions are a black-box, so there&#39;s no way to start another thread running a <code>static</code> function without having static var access &quot;escape&quot; the translation unit."}, {"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "edited": false, "score": 1, "creation_date": 1529809362, "post_id": 50951199, "comment_id": 89006530, "body": "@PeterCordes If you have a set of variables V only manipulated by functions F1 that are only called by the set of functions F2 and none of these can be named outside the TU, and no other function inside the TU takes the address to put it in an object accessible elsewhere... at the end of the day, V, F1, F2... serve no purpose at all."}, {"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "reply_to_user": {"reputation": 3378, "user_id": 2069150, "user_type": "registered", "accept_rate": 12, "profile_image": "https://i.stack.imgur.com/filKc.jpg?s=128&g=1", "display_name": "Arch D. Robison", "link": "https://stackoverflow.com/users/2069150/arch-d-robison"}, "edited": false, "score": 1, "creation_date": 1529809682, "post_id": 50951199, "comment_id": 89006560, "body": "@ArchD.Robison Presumably, in a realistic program static variables can be indirectly <b>accessed from main</b>."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "edited": false, "score": 1, "creation_date": 1529846553, "post_id": 50951199, "comment_id": 89013321, "body": "@curiousguy: Good point.  Unless this is the TU containing <code>main</code>, then maybe the compiler could prove that those variables can only be used by the main thread (if it optimized based on it being UB to call <code>main</code> again from inside the program).  I don&#39;t think there are any cases where a non-inline function call can fail to order any variables that are actually shared."}, {"owner": {"reputation": 3378, "user_id": 2069150, "user_type": "registered", "accept_rate": 12, "profile_image": "https://i.stack.imgur.com/filKc.jpg?s=128&g=1", "display_name": "Arch D. Robison", "link": "https://stackoverflow.com/users/2069150/arch-d-robison"}, "edited": false, "score": 1, "creation_date": 1529883630, "post_id": 50951199, "comment_id": 89022331, "body": "I concur with @PeterCordes&#39; analysis.  I had forgotten to consider the &quot;call back in&quot; possibility."}, {"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "edited": false, "score": 0, "creation_date": 1572842470, "post_id": 50951199, "comment_id": 103673107, "body": "&quot;<i>if it can prove that nothing outside the current function have their address.</i>&quot; Is there a name for that? Function private variables?"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "edited": false, "score": 1, "creation_date": 1572842686, "post_id": 50951199, "comment_id": 103673145, "body": "@curiousguy: <a href=\"https://en.wikipedia.org/wiki/Escape_analysis\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Escape_analysis</a> is the name for the checking.  I&#39;m not aware of a widely-established name for variables that meet the criteria.  I&#39;d maybe say &quot;variable that hasn&#39;t escaped&quot;."}], "tags": [], "owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "is_accepted": false, "score": 6, "last_activity_date": 1572855660, "last_edit_date": 1572855660, "creation_date": 1529506613, "answer_id": 50951199, "question_id": 50951011, "link": "https://stackoverflow.com/questions/50951011/how-does-a-mutex-lock-and-unlock-functions-prevents-cpu-reordering/50951199#50951199", "title": "How does a mutex lock and unlock functions prevents CPU reordering?", "body": "<p>If <code>i</code> and <code>j</code> are local variables, nothing.  The compiler can keep them in registers across the function call if it can prove that nothing outside the current function have their address.</p>\n\n<p><strong>But any global variables, or locals whose address might be stored in a global, <em>do</em> have to be \"in sync\" in memory for a non-inline function call.</strong>  The compiler has to assume that any function call it can't inline modifies any / every variable it can possibly have a reference to.</p>\n\n<p>So for example, if <code>int i;</code> is a local variable, after <code>sscanf(\"0\", \"%d\", &amp;i);</code> its <a href=\"https://en.wikipedia.org/wiki/Escape_analysis\" rel=\"nofollow noreferrer\">address will have escaped the function</a> and the compiler will then have to spill/reload it around function calls instead of keeping it in a call-preserved register.</p>\n\n<p>See my answer on <a href=\"https://stackoverflow.com/questions/50935690/understanding-volatile-asm-vs-volatile-variable/50937064#50937064\">Understanding volatile asm vs volatile variable</a>, with an example of <code>asm volatile(\"\":::\"memory\")</code> being a barrier for a local variable whose address escaped the function (<code>sscanf(\"0\", \"%d\", &amp;i);</code>), but not for locals that are still purely local.  It's exactly the same behaviour for exactly the same reason.</p>\n\n<hr>\n\n<blockquote>\n  <p>I assume that the above quote is talking about CPU reordering and not about compiler reordering.</p>\n</blockquote>\n\n<p>It's talking about both, because both are necessary for correctness. </p>\n\n<p>This is why the <em>compiler</em> can't reorder updates to shared variables with <em>any</em> function call.  (This is very important: the weak C11 memory model allows lots of <a href=\"http://preshing.com/20120625/memory-ordering-at-compile-time/\" rel=\"nofollow noreferrer\">compile-time reordering</a>.  The strong x86 memory model only allows StoreLoad reordering, and local store-forwarding.)</p>\n\n<p><strong><code>pthread_mutex_lock</code> being a non-inline function call takes care of compile-time reordering</strong>, and the fact that it does a <code>lock</code>ed operation, an atomic RMW, also means it includes a full runtime memory barrier on x86.  (Not the <code>call</code> instruction itself, though, just the code in the function body.)  This gives it acquire semantics.</p>\n\n<p>Unlocking a spinlock only needs a release-store, not a RMW, so depending on the implementation details the unlock function might not be a StoreLoad barrier.  (This is still ok: it keeps everything in the critical section from getting out.  It's not necessary to stop later operations from appearing before the unlock.  See Jeff Preshing's <a href=\"http://preshing.com/20120913/acquire-and-release-semantics/\" rel=\"nofollow noreferrer\">article explaining Acquire and Release semantics</a>)</p>\n\n<p><strong>On a weakly-ordered ISA, those mutex functions would run barrier instructions, like ARM <code>dmb</code> (data memory barrier)</strong>.  Normal functions wouldn't, so the author of that guide is correct to point out that those functions are special.</p>\n\n<hr>\n\n<blockquote>\n  <p>Now what prevents <strong>the CPU</strong> from reordering mov 10 into i and mov 20 into j to above <code>call pthread_mutex_lock()</code></p>\n</blockquote>\n\n<p>This isn't the important reason (because on a weakly-ordered ISA <code>pthread_mutex_unlock</code> would run a barrier instruction), but <strong>it is actually true on x86 that the stores can't even be reorder with the <code>call</code> instruction</strong>, let alone actual locking/unlocking of the mutex done by the function body before the function returns.</p>\n\n<p>x86 has strong memory-ordering semantics (stores don't reorder with other stores), and <code>call</code> is a store (pushing the return address).</p>\n\n<p>So <code>mov [i], 10</code> must appear in the global store between the stores done by the <code>call</code> instruction.</p>\n\n<p>Of course in a normal program, nobody is observing the call stack of other threads, just the <code>xchg</code> to take the mutex or the release-store to release it in <code>pthread_mutex_unlock</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 507, "user_id": 8426277, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/5e38346f3b638606197692696331b88f?s=128&d=identicon&r=PG&f=1", "display_name": "user8426277", "link": "https://stackoverflow.com/users/8426277/user8426277"}, "edited": false, "score": 0, "creation_date": 1529519269, "post_id": 50952621, "comment_id": 88907283, "body": "<i>&quot;The short answer is that the body of the pthread_mutex_lock and pthread_mutex_unlock calls will include the necessary platform-specific memory barriers which will prevent the CPU from moving memory accesses within the critical section outside of it.&quot;</i>  I don&#39;t underatnd why the body of these functions matters, I mean <code>i = 10;</code> could be executed before <code>pthread_mutex_lock(&amp;lock);</code> is executed, and so what is inside the critical section has been moved to the outside of the critical section. Or is such reordering not allowed on all CPU architectures?"}, {"owner": {"reputation": 50907, "user_id": 149138, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/cfd457233c8ebbab383475fc097442d9?s=128&d=identicon&r=PG", "display_name": "BeeOnRope", "link": "https://stackoverflow.com/users/149138/beeonrope"}, "reply_to_user": {"reputation": 507, "user_id": 8426277, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/5e38346f3b638606197692696331b88f?s=128&d=identicon&r=PG&f=1", "display_name": "user8426277", "link": "https://stackoverflow.com/users/8426277/user8426277"}, "edited": false, "score": 2, "creation_date": 1529522117, "post_id": 50952621, "comment_id": 88908622, "body": "@user8426277 - because it&#39;s the <i>dynamic</i> flow of instructions that (mostly) matters for re-ordering. The CPU doesn&#39;t execute the <code>call</code> as a single instruction and then continue on to the next instruction in source/assembly order, it goes <i>into</i> the body of the <code>pthread</code> function. So for the purpose of analysis, you can imagine the entire body of the <code>lock</code> and <code>unlock</code> calls sort of &quot;inlined&quot; in the assembly at the place the <code>call</code> instruction appears. If that weren&#39;t the case, mutexes and many other sync mechanisms would be impossible to implement as plain function calls!"}, {"owner": {"reputation": 50907, "user_id": 149138, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/cfd457233c8ebbab383475fc097442d9?s=128&d=identicon&r=PG", "display_name": "BeeOnRope", "link": "https://stackoverflow.com/users/149138/beeonrope"}, "reply_to_user": {"reputation": 507, "user_id": 8426277, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/5e38346f3b638606197692696331b88f?s=128&d=identicon&r=PG&f=1", "display_name": "user8426277", "link": "https://stackoverflow.com/users/8426277/user8426277"}, "edited": false, "score": 1, "creation_date": 1529522261, "post_id": 50952621, "comment_id": 88908680, "body": "@user8426277 - I updated my question to make it clearer. The bottom line is that, at the assembly level, you can&#39;t talk about what types of reordering are possible across a <code>call</code>, <code>jmp</code> or any other control flow change because you need to know what happens at the location jumped to."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1529522663, "post_id": 50952621, "comment_id": 88908844, "body": "x86 <code>call</code> does a release-store (pushing the return address), so if you want to be pedantic the <code>call</code> itself <i>does</i> actually have an effect.  But no moreso than any normal stores done inside the function.  But yes, very good update, I think that might be getting at the heart of what the OP is missing."}, {"owner": {"reputation": 50907, "user_id": 149138, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/cfd457233c8ebbab383475fc097442d9?s=128&d=identicon&r=PG", "display_name": "BeeOnRope", "link": "https://stackoverflow.com/users/149138/beeonrope"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1529522817, "post_id": 50952621, "comment_id": 88908931, "body": "@PeterCordes I never say that <code>call</code> doesn&#39;t have release effect do I? I&#39;m saying you need to know what is inside the <code>call</code> to know about the entire effect of <code>call</code> on the instruction trace. Of course, the <code>call</code> <i>itself</i> may have some ordering semantics, such as those associated with the store to the stack, but that is practically unusable and is IMO a total red herring (and another answer covers it well :-). Note that release-acquire talks about a location: the <code>lock</code> part of a mutex doesn&#39;t synchronize with a <code>push</code> the return address on another thread, so that release isn&#39;t very useful."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1529523000, "post_id": 50952621, "comment_id": 88909010, "body": "I just meant that in reply to <i>you can&#39;t talk about what types of reordering are possible across a <code>call</code>...</i>&quot; in your 2nd comment.  Not suggesting you overcomplicate this answer with that, because I already did that in mine :P  Agreed that it&#39;s a total red herring, and the memory-ordering part of <code>call</code> is totally unimportant because other threads aren&#39;t looking at your call stack."}, {"owner": {"reputation": 50907, "user_id": 149138, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/cfd457233c8ebbab383475fc097442d9?s=128&d=identicon&r=PG", "display_name": "BeeOnRope", "link": "https://stackoverflow.com/users/149138/beeonrope"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1529523183, "post_id": 50952621, "comment_id": 88909093, "body": "@PeterCordes - well yes, I wonder if someone would come along say something like that, and I half-considered making it more price, like noting that the <code>call</code> itself may prevent some reorderings, but the body may then prevent <i>more</i> reordering. That said, I actually don&#39;t think it&#39;s meaningful to say that <code>call</code> has &quot;release semantics&quot; (with the implication perhaps being that you don&#39;t need a store in side the <code>unlock</code> implementation): <i>release</i> is meaningful when talking about a particular <i>location</i> and in the case of <code>call</code> the location is an anonymous location on the stack."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1529523281, "post_id": 50952621, "comment_id": 88909135, "body": "Ah right, that&#39;s a good analysis of exactly why it&#39;s not meaningful or useful.  It doesn&#39;t matter where <code>call</code>&#39;s store appears in the global order, just stores outside the critical section vs. the mutex lock vs. inside.  I knew I was being pedantic, but hadn&#39;t thought through exactly how useless that was.  If we&#39;re talking about the non-store part of instructions, then it&#39;s another out-of-order exec vs. memory ordering question."}, {"owner": {"reputation": 50907, "user_id": 149138, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/cfd457233c8ebbab383475fc097442d9?s=128&d=identicon&r=PG", "display_name": "BeeOnRope", "link": "https://stackoverflow.com/users/149138/beeonrope"}, "edited": false, "score": 0, "creation_date": 1529523360, "post_id": 50952621, "comment_id": 88909162, "body": "... because in what sense can the acquire side (the <code>lock</code> call) synchronize with the store implied by <code>call</code>? I don&#39;t think it can. I can&#39;t see a way you could rely on the so-called &quot;release&quot; semantics of the store. [&lt;-- this part of my comment raced with your last reply]. So we should <i>not</i> think of release stores as some type of memory barrier really: putting a &quot;dummy&quot; store with &quot;release&quot; semantics doesn&#39;t do anything meaningful. It&#39;s only useful to something that consumes its value, to establish a type of happens-before relationship or however you want to think of it."}, {"owner": {"reputation": 507, "user_id": 8426277, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/5e38346f3b638606197692696331b88f?s=128&d=identicon&r=PG&f=1", "display_name": "user8426277", "link": "https://stackoverflow.com/users/8426277/user8426277"}, "edited": false, "score": 0, "creation_date": 1529618596, "post_id": 50952621, "comment_id": 88951974, "body": "@BeeOnRope <i>&quot;The CPU doesn&#39;t execute the call as a single instruction and then continue on to the next instruction in source/assembly order, it goes into the body of the pthread function&quot;</i> I didn&#39;t mean in my question in the comments that I thought that the CPU will execute <code>pthread_mutex_lock(&amp;lock);</code> and then immediately afterwards the CPU will execute <code>i = 10;</code> without going to the function body first. What I meant was: what if the CPU completely ignored <code>pthread_mutex_lock(&amp;lock);</code> and instead executed <code>i = 10;</code> first, and then after that, the CPU executed <code>pthread_mutex_lock(&amp;lock);</code>."}, {"owner": {"reputation": 50907, "user_id": 149138, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/cfd457233c8ebbab383475fc097442d9?s=128&d=identicon&r=PG", "display_name": "BeeOnRope", "link": "https://stackoverflow.com/users/149138/beeonrope"}, "reply_to_user": {"reputation": 507, "user_id": 8426277, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/5e38346f3b638606197692696331b88f?s=128&d=identicon&r=PG&f=1", "display_name": "user8426277", "link": "https://stackoverflow.com/users/8426277/user8426277"}, "edited": false, "score": 1, "creation_date": 1529688886, "post_id": 50952621, "comment_id": 88980669, "body": "@user8426277 - right, I understood. What I am saying though is that the CPU doesn&#39;t reorder at the assembly level listing. You are imagining assembly like <code>call mutex_lock; store 10 to I;</code> and asking &quot;what happens if the CPU reorders the store before the <code>call</code>? The answer is that wasn&#39;t the right way to look at it in the first place: the CPU doesn&#39;t reorder against the static assembly you find on disk in the binary, it operates against the <i>dynamic</i> stream of instructions, so you need to mentally trace out the execution and record that stream."}, {"owner": {"reputation": 50907, "user_id": 149138, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/cfd457233c8ebbab383475fc097442d9?s=128&d=identicon&r=PG", "display_name": "BeeOnRope", "link": "https://stackoverflow.com/users/149138/beeonrope"}, "edited": false, "score": 1, "creation_date": 1529688930, "post_id": 50952621, "comment_id": 88980683, "body": "In this case the result is simple: you just end up with the instructions that are part of the body of the <code>lock</code> and <code>unlock</code> functions replacing the call instruction. <i>Then</i> you can talk about reordering against that list of instructions - that&#39;s what I call the <i>dynamic trace</i>."}, {"owner": {"reputation": 507, "user_id": 8426277, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/5e38346f3b638606197692696331b88f?s=128&d=identicon&r=PG&f=1", "display_name": "user8426277", "link": "https://stackoverflow.com/users/8426277/user8426277"}, "edited": false, "score": 0, "creation_date": 1529696720, "post_id": 50952621, "comment_id": 88983919, "body": "Oh! in that case, is the purpose of the memory barrier inside the <code>pthread_mutex_lock(&amp;lock);</code> function is to prevent the reordering of <code>i = 10;</code> to above the code that sets/locks the mutex variable inside the <code>pthread_mutex_lock(&amp;lock);</code> function?"}, {"owner": {"reputation": 50907, "user_id": 149138, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/cfd457233c8ebbab383475fc097442d9?s=128&d=identicon&r=PG", "display_name": "BeeOnRope", "link": "https://stackoverflow.com/users/149138/beeonrope"}, "reply_to_user": {"reputation": 507, "user_id": 8426277, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/5e38346f3b638606197692696331b88f?s=128&d=identicon&r=PG&f=1", "display_name": "user8426277", "link": "https://stackoverflow.com/users/8426277/user8426277"}, "edited": false, "score": 0, "creation_date": 1529696846, "post_id": 50952621, "comment_id": 88983977, "body": "@user - correct. As a consequence it also prevents it from moving above the lock function enirely."}], "tags": [], "owner": {"reputation": 50907, "user_id": 149138, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/cfd457233c8ebbab383475fc097442d9?s=128&d=identicon&r=PG", "display_name": "BeeOnRope", "link": "https://stackoverflow.com/users/149138/beeonrope"}, "is_accepted": true, "score": 7, "last_activity_date": 1529523862, "last_edit_date": 1529523862, "creation_date": 1529510750, "answer_id": 50952621, "question_id": 50951011, "link": "https://stackoverflow.com/questions/50951011/how-does-a-mutex-lock-and-unlock-functions-prevents-cpu-reordering/50952621#50952621", "title": "How does a mutex lock and unlock functions prevents CPU reordering?", "body": "<p>The short answer is that the body of the <code>pthread_mutex_lock</code> and <code>pthread_mutex_unlock</code> calls will include the necessary platform-specific memory barriers which will prevent the CPU from moving memory accesses within the critical section outside of it. The instruction flow will move from the calling code into the <code>lock</code> and <code>unlock</code> functions via a <code>call</code> instruction, and it is this <em>dynamic instruction trace</em> you have to consider for the purposes of reordering - not the static sequence you see in an assembly listing.</p>\n\n<p>On x86 specifically, you probably won't find <em>explicit, standalone</em> memory barriers inside those methods, since you'll already have <a href=\"https://stackoverflow.com/q/8891067/149138\"><code>lock</code>-prefixed</a> instructions in order to perform the actual locking and unlocking atomically, and these instructions <em>imply</em> a full memory barrier, which prevents the CPU reordering you are concerned about.</p>\n\n<p>For example, on my Ubuntu 16.04 system with glibc 2.23, <code>pthread_mutex_lock</code> is implemented using a <code>lock cmpxchg</code> (compare-and-exchange) and <code>pthread_mutex_unlock</code> is implemented using <code>lock dec</code> (decrement), both of which have full barrier semantics.</p>\n"}], "owner": {"reputation": 507, "user_id": 8426277, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/5e38346f3b638606197692696331b88f?s=128&d=identicon&r=PG&f=1", "display_name": "user8426277", "link": "https://stackoverflow.com/users/8426277/user8426277"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1264, "favorite_count": 5, "accepted_answer_id": 50952621, "answer_count": 2, "score": 2, "last_activity_date": 1572855660, "creation_date": 1529506069, "last_edit_date": 1572842586, "question_id": 50951011, "link": "https://stackoverflow.com/questions/50951011/how-does-a-mutex-lock-and-unlock-functions-prevents-cpu-reordering", "title": "How does a mutex lock and unlock functions prevents CPU reordering?", "body": "<p>As far as I know, a function call acts as a compiler barrier, but not as a CPU barrier.</p>\n\n<p>This <a href=\"http://preshing.com/20120913/acquire-and-release-semantics/\" rel=\"nofollow noreferrer\">tutorial</a> says the following:</p>\n\n<blockquote>\n  <p>acquiring a lock implies acquire semantics, while releasing a lock\n  implies release semantics! All the memory operations in between are\n  contained inside a nice little barrier sandwich, preventing any\n  undesireable memory reordering across the boundaries.</p>\n</blockquote>\n\n<p>I assume that the above quote is talking about CPU reordering and not about compiler reordering.</p>\n\n<p>But I don't understand how does a mutex lock and unlock causes the CPU to give these functions acquire and release semantics.</p>\n\n<p>For example, if we have the following C code:</p>\n\n<pre><code>pthread_mutex_lock(&amp;lock);\ni = 10;\nj = 20;\npthread_mutex_unlock(&amp;lock);\n</code></pre>\n\n<p>The above C code is translated into the following (pseudo) assembly instructions:</p>\n\n<pre><code>push the address of lock into the stack\ncall pthread_mutex_lock()\nmov 10 into i\nmov 20 into j\npush the address of lock into the stack\ncall pthread_mutex_unlock()\n</code></pre>\n\n<p>Now what prevents the CPU from reordering <code>mov 10 into i</code> and <code>mov 20 into j</code>  to above <code>call pthread_mutex_lock()</code> or to below <code>call pthread_mutex_unlock()</code>?</p>\n\n<p>If it is the <code>call</code> instruction that prevents the CPU from doing the reordering, then why is the tutorial I quoted makes it seem like it is the mutex lock and unlock functions that prevents the CPU reordering, why the tutorial I quoted didn't say that any function call will prevent the CPU reordering?</p>\n\n<p><em>My question is about the x86 architecture.</em></p>\n"}, {"tags": ["c", "pointers", "scanf"], "comments": [{"owner": {"reputation": 2999, "user_id": 7520531, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0107497596782a18d4a853214a883546?s=128&d=identicon&r=PG&f=1", "display_name": "Jose", "link": "https://stackoverflow.com/users/7520531/jose"}, "edited": false, "score": 1, "creation_date": 1529505747, "post_id": 50950862, "comment_id": 88899468, "body": "Actually the code is not correct: <a href=\"https://stackoverflow.com/questions/37549594/crash-or-segmentation-fault-when-data-is-copied-scanned-read-to-an-uninitializ\" title=\"crash or segmentation fault when data is copied scanned read to an uninitializ\">stackoverflow.com/questions/37549594/&hellip;</a>"}, {"owner": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 1, "creation_date": 1529505766, "post_id": 50950862, "comment_id": 88899479, "body": "The <a href=\"http://en.cppreference.com/w/c/io/fscanf\" rel=\"nofollow noreferrer\">documentation for <code>scanf</code></a> clearly states what types should be passed for which format specifier. Also <code>*s</code> would return a singular <code>char</code>, not a string."}, {"owner": {"reputation": 590, "user_id": 9848932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a484cace64c76f71d3bb1fab9410761?s=128&d=identicon&r=PG&f=1", "display_name": "jdc", "link": "https://stackoverflow.com/users/9848932/jdc"}, "edited": false, "score": 1, "creation_date": 1529506069, "post_id": 50950862, "comment_id": 88899688, "body": "<code>char * s</code> does not create a &quot;memory box&quot;.  I think what you meant to say is that something like <code>char * s = malloc(80);</code> creates a &quot;memory box&quot; capable of holding 80 bytes, which must be freed later."}, {"owner": {"user_type": "does_not_exist", "display_name": "user9311878"}, "edited": false, "score": 0, "creation_date": 1529506148, "post_id": 50950862, "comment_id": 88899748, "body": "Yes you&#39;re right, that was not complete. Although, and i just tried, if I do malloc(1) then type a long text, printf(&quot;%s&quot;, s) shows that all the text was taken in, why is that? Shouldn&#39;t it stop at 1?"}, {"owner": {"reputation": 528, "user_id": 2184331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c59f93339e2cf87731ed5d709f275d5?s=128&d=identicon&r=PG", "display_name": "William J Bagshaw", "link": "https://stackoverflow.com/users/2184331/william-j-bagshaw"}, "edited": false, "score": 2, "creation_date": 1529506220, "post_id": 50950862, "comment_id": 88899797, "body": "Best to use the phrase &quot;pointer&quot;. It is the technical word and describes what it does. It is not the thing itself, it points to a thing. You should look for some examples of scanf(). Your example at time of writing is not correct. You  need some memory into which the string will go. The string is a number of &quot;char&quot;s. You need a pointer to that memory. The pointer can just be to the first one. Then pass the pointer to scanf() and it will look for the string and put it i the memory the pointer points to."}, {"owner": {"reputation": 590, "user_id": 9848932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a484cace64c76f71d3bb1fab9410761?s=128&d=identicon&r=PG&f=1", "display_name": "jdc", "link": "https://stackoverflow.com/users/9848932/jdc"}, "edited": false, "score": 1, "creation_date": 1529506450, "post_id": 50950862, "comment_id": 88899965, "body": "@archaic Reading many chars into a small buffer is a buffer overflow.  A buffer overflow results in undefined behavior.  Undefined behavior is precisely that."}, {"owner": {"user_type": "does_not_exist", "display_name": "user9311878"}, "edited": false, "score": 0, "creation_date": 1529506556, "post_id": 50950862, "comment_id": 88900051, "body": "Alright, thank you!"}, {"owner": {"reputation": 528, "user_id": 2184331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c59f93339e2cf87731ed5d709f275d5?s=128&d=identicon&r=PG", "display_name": "William J Bagshaw", "link": "https://stackoverflow.com/users/2184331/william-j-bagshaw"}, "edited": false, "score": 1, "creation_date": 1529506585, "post_id": 50950862, "comment_id": 88900074, "body": "The C language is not &quot;managed&quot; and you can do what you like, even if it messes things up. If you do not give it enough space it does not know and just keeps going. Simplistically the memory is vast and uniform and C does not manage where things begin and end, you have to get it right. I think you need a working example. malloc() is not what you would find in a working example."}, {"owner": {"reputation": 528, "user_id": 2184331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c59f93339e2cf87731ed5d709f275d5?s=128&d=identicon&r=PG", "display_name": "William J Bagshaw", "link": "https://stackoverflow.com/users/2184331/william-j-bagshaw"}, "edited": false, "score": 1, "creation_date": 1529507015, "post_id": 50950862, "comment_id": 88900379, "body": "To be honest I think you want to look at gets() as this does the same thing, You could find some example code for that and start to explore the language."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user9311878"}, "edited": false, "score": 0, "creation_date": 1529506486, "post_id": 50951120, "comment_id": 88899999, "body": "Thank you, initially I thought that in scanf the parameter is not the address of the &quot;want to read&quot; variable but the variable itself."}, {"owner": {"reputation": 690, "user_id": 4532332, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/73a889f290c7f4926c7fa49e832d3465?s=128&d=identicon&r=PG&f=1", "display_name": "AndreiM", "link": "https://stackoverflow.com/users/4532332/andreim"}, "edited": false, "score": 1, "creation_date": 1529506679, "post_id": 50951120, "comment_id": 88900149, "body": "The last example was supposed to do exactly that, I updated it now"}, {"owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "edited": false, "score": 1, "creation_date": 1529567287, "post_id": 50951120, "comment_id": 88922868, "body": "@archaic C is pass by value. You cannot pass &quot;the variable itself&quot; in any way to any function, all you ever get is a copy of the variable&#39;s value."}], "tags": [], "owner": {"reputation": 690, "user_id": 4532332, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/73a889f290c7f4926c7fa49e832d3465?s=128&d=identicon&r=PG&f=1", "display_name": "AndreiM", "link": "https://stackoverflow.com/users/4532332/andreim"}, "is_accepted": true, "score": 1, "last_activity_date": 1529506655, "last_edit_date": 1529506655, "creation_date": 1529506343, "answer_id": 50951120, "question_id": 50950862, "link": "https://stackoverflow.com/questions/50950862/scanf-and-pointers-misunderstanding/50951120#50951120", "title": "Scanf and pointers misunderstanding", "body": "<p>Let's take a simpler example:</p>\n\n<pre><code>char c;\nscanf(\"%c\", &amp;c);\n</code></pre>\n\n<p>In this example, if you want to read a char, then you have to pass the address of that char (c), so that the method knows where to put the resulting char.</p>\n\n<p>Let's expand to a string:</p>\n\n<pre><code>char *str;\nscanf(\"%s\", str);\n</code></pre>\n\n<p>In this case str is the address of the beginning of a string, therefore you could pass it to the scanf and expect the string to be read.</p>\n\n<p>However, there's a catch here: str points to the beginning of the string, but this string doesn't actually exists, you'll have to create it. Like this:</p>\n\n<pre><code>char str[80];\nscanf(\"%s\", &amp;str[0]);\n</code></pre>\n\n<p>As you can see here, str is now a string of 80 chars, and you can pass the location (address) of the beginning of this string to scanf. BUT, you have to pray that the string read is not bigger than 80 characters, otherwise the method will try to write outside the bounds of the string. You can correct this by telling scanf how many chars to read:</p>\n\n<pre><code>char str[80];\nscanf(\"%79s\", &amp;str[0]);\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9311878"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 50951120, "answer_count": 1, "score": 0, "last_activity_date": 1529506655, "creation_date": 1529505613, "question_id": 50950862, "link": "https://stackoverflow.com/questions/50950862/scanf-and-pointers-misunderstanding", "title": "Scanf and pointers misunderstanding", "body": "<p>take a look at this :</p>\n\n<pre><code>char* s;\nscanf(\"%s\", s);\n</code></pre>\n\n<p>In general, s is a \"memory box\" that will contain an address to another one which, in this case, would be the first of a number of \"memory boxes\" containing chars before the \"\\0\" marking the end of the string.<br> \n*s would let us access the \"memory boxes\", i.e the string.<br><br>\nNow back to the code and precisely scanf, I read it as follows : Take the user input, which is a string hence the \"%s\", and assign it to s. But how can this be? s is the reference, so shouldn't it be <code>scanf(\"%s\", *s)</code> instead ?</p>\n"}, {"tags": ["c", "file-io"], "comments": [{"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 2, "creation_date": 1529505638, "post_id": 50950788, "comment_id": 88899386, "body": "<code>printf(&quot;you said %s is that true???&quot;, &amp;reply);</code> --&gt; <code>printf(&quot;you said %s is that true???&quot;, reply);</code>"}, {"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 2, "creation_date": 1529505666, "post_id": 50950788, "comment_id": 88899403, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/5406935/reading-a-string-with-scanf\">Reading a string with scanf</a>"}, {"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 1, "creation_date": 1529505832, "post_id": 50950788, "comment_id": 88899527, "body": "You should always check what <code>fopen</code> (and other functions) returns to make sure your file has actually been opened or not and then deal with failures"}, {"owner": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 0, "creation_date": 1529508256, "post_id": 50950788, "comment_id": 88901198, "body": "There&#39;s  plenty of dupes, but in short, using the <code>%s</code> format specifier, &#39;fscanf&#39; will read and store until  the first space in the input, leaving the remainings in the stream. So, if in input you have &quot;Hello world. yes&quot;, you&#39;ll end up comparing &quot;world.&quot; with {&#39;Y&#39;, &#39;E&#39;, &#39;S&#39;}\u2026 Try <a href=\"http://en.cppreference.com/w/c/io/fgets\" rel=\"nofollow noreferrer\">fgets</a>, instead."}], "answers": [{"comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1529518745, "post_id": 50953484, "comment_id": 88907020, "body": "You cannot rely on the operation of <code>fscanf</code> unless you check the return. You must handle 3-cases, <code>EOF</code>, success, and for <i>matching</i> or <i>input</i> failure. (<code>EOF</code> can be manually generated with <code>Ctrl+d</code> (Linux) or <code>Ctrl+z</code> (windoze), but see <a href=\"http://proc-x.com/2017/06/ctrlz-does-not-generate-eof-in-windows-10/\" rel=\"nofollow noreferrer\">CTRL+Z does not generate EOF in Windows 10</a>. This applies to every call to any of the <code>scanf</code> family of functions. Also <code>if (!fp)</code> simply handle the error and <code>return 1;</code> or <code>exit (EXIT_FAILURE);</code> there is no need to nest and <code>else</code>. <code>fscanf(stdin, &quot;%149s&quot;, buffer);</code> protects bounds."}], "tags": [], "owner": {"reputation": 26606, "user_id": 4603670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7eabc1427aa3c8185153cc81978289a?s=128&d=identicon&r=PG&f=1", "display_name": "Barmak Shemirani", "link": "https://stackoverflow.com/users/4603670/barmak-shemirani"}, "is_accepted": true, "score": 0, "last_activity_date": 1529514035, "creation_date": 1529514035, "answer_id": 50953484, "question_id": 50950788, "link": "https://stackoverflow.com/questions/50950788/trying-to-read-information-in-a-file-c-programming/50953484#50953484", "title": "Trying to read information in a file (c programming)", "body": "<blockquote>\n  <p><code>if ((toupper(reply[0]) == 'Y') &amp;&amp; (toupper(reply[1]) == 'E') ...</code></p>\n</blockquote>\n\n<p>You can convert the string to lowercase or uppercase and <code>strcmp</code>, rather than checking letters one by one.</p>\n\n<blockquote>\n  <p><code>while (!feof(fpointer))</code><br>\n  <code>fgets(SingleLine, 150, fpointer);</code><br>\n  <code>puts(SingleLine);</code><br></p>\n</blockquote>\n\n<p>Don't use <a href=\"https://stackoverflow.com/questions/5431941/why-is-while-feof-file-always-wrong\"><code>feof</code></a>. Instead check if <code>fgets</code> succeeds. Presumably you want to print each line in the file, so don't print the line after the loop finishes. You also need error checks to make sure the file was opened successfully. Example:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;ctype.h&gt;\n#include &lt;string.h&gt;\n\nint main(void)\n{\n    char buffer[150];\n    printf(\"enter a message: \");\n    fscanf(stdin, \"%s\", buffer);\n    printf(\"you said %s \\n\", buffer);\n\n    FILE *fp = fopen(\"gift.txt\", \"w\");\n    fprintf(fp, \"%s \\n\", buffer);\n    fclose(fp);\n\n    printf(\"yes or no? \");\n    scanf(\"%s\", buffer);\n    for(int i = 0, len = strlen(buffer); i &lt; len; i++)\n        buffer[i] = (char)tolower(buffer[i]);\n    if (strcmp(buffer, \"yes\") == 0)\n    {\n        fp = fopen(\"luvtracey.txt\", \"r\");\n        if(!fp)\n        {\n            printf(\"can't open...\\n\");\n        }\n        else\n        {\n            while(fgets(buffer, sizeof(buffer), fp))\n                printf(\"%s\", buffer);\n            fclose(fp);\n        }\n    }\n    return 0;\n}\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6945056"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 50953484, "answer_count": 1, "score": 1, "last_activity_date": 1529514035, "creation_date": 1529505385, "last_edit_date": 1529506661, "question_id": 50950788, "link": "https://stackoverflow.com/questions/50950788/trying-to-read-information-in-a-file-c-programming", "title": "Trying to read information in a file (c programming)", "body": "<p>I'm new to programming in  c and I've come across a problem with my file system. The aim of this program is for a user to <strong>enter</strong> a message and that message gets stored in a <strong>text file</strong>. After the users message gets <strong>stored</strong> in a text file, they have the choice to '<strong>read</strong>' a messaged their loved one has sent to them. </p>\n\n<pre><code>char SingleLine[150];\nFILE * filePointer;\nFILE * fpointer;\nchar mess[10];\nchar reply[100];\n\ncase 4:\n    printf(\"enter a message: \");\n    fscanf(stdin, \"%s\", mess);\n    filePointer = fopen(\"gift.txt\", \"w\");\n    fprintf(filePointer, \"%s \\n\", mess);\n    printf(\"you said %s \\n\", mess);\n    printf(\"they wrote something back?, would you like to read it?  yes or no? \\n \");\n    scanf(\"%s\", &amp;reply);    \n    if ((toupper(reply[0]) == 'Y') &amp;&amp; (toupper(reply[1]) == 'E') &amp;&amp; (toupper(reply[2]) == 'S'))\n    {\n        printf(\"you said %s is that true???\", &amp;reply);\n        printf(\"ok loading...\\n\");\n        fpointer = fopen(\"luvtracey.txt\", \"r\");\n        while (!feof(fpointer))\n            fgets(SingleLine, 150, fpointer);\n            puts(SingleLine);\n    }\n    else if ((toupper(reply[0]) == 'N') &amp;&amp; (toupper(reply[1]) == 'O'))\n    {\n        printf(\"wow ignorant \\n\");\n    }\n    else\n    {\n        printf(\"your not having it anymore\");\n    }\n}\n</code></pre>\n\n<p>But when this code runs firstly, when a user <strong>enters</strong> a message with <strong><em>no spaces</em></strong>, it'll get stored. But when you add spaces, the message would get <strong>chopped</strong> in half and the first bit would get stored. Secondly, when you type 'yes' (when you want to see what your loved one has sent) it crashes completely but i don't understand why. <em>Also</em> its not <strong>retrieving</strong> the information in the <strong>'luvtracey.txt</strong>' file which has words in it.  </p>\n\n<p>I accept feedback and i just want to say thank you to those in advance who help me solve these problems.</p>\n\n<p>~Neamus</p>\n"}, {"tags": ["c", "matrix"], "comments": [{"owner": {"reputation": 14339, "user_id": 1466970, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/V1J6z.jpg?s=128&g=1", "display_name": "Richard Chambers", "link": "https://stackoverflow.com/users/1466970/richard-chambers"}, "edited": false, "score": 2, "creation_date": 1529504992, "post_id": 50950581, "comment_id": 88898964, "body": "I suggest you provide some source code to show what you are doing and where the error is coming from."}, {"owner": {"reputation": 15176, "user_id": 390363, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/662dda87a8ad559dca5570b7786cf6fb?s=128&d=identicon&r=PG", "display_name": "aragaer", "link": "https://stackoverflow.com/users/390363/aragaer"}, "edited": false, "score": 0, "creation_date": 1529505218, "post_id": 50950581, "comment_id": 88899122, "body": "Not &quot;convert&quot; but &quot;create the array and fill it with values you read from file&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 590, "user_id": 9848932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a484cace64c76f71d3bb1fab9410761?s=128&d=identicon&r=PG&f=1", "display_name": "jdc", "link": "https://stackoverflow.com/users/9848932/jdc"}, "is_accepted": true, "score": 1, "last_activity_date": 1529505519, "last_edit_date": 1529505519, "creation_date": 1529505395, "answer_id": 50950791, "question_id": 50950581, "link": "https://stackoverflow.com/questions/50950581/read-matrix-from-txt-file/50950791#50950791", "title": "Read matrix from .txt file", "body": "<p>Based on what (little) you have provided, I think your problem is that <code>fscanf()</code> expects a <code>FILE *</code> as its first argument, but you are providing the name of the file as a <code>const char *</code>.</p>\n\n<p>You can get a <code>FILE *</code> by using <code>fopen()</code>.</p>\n\n<pre><code>FILE * fileptr = fopen(\"&lt;name of file in double quotes&gt;\", \"r\"); // open file for reading\nif (fileptr == NULL) /* do some error handling stuff */;\nint i, j;\nfor (i = 0; i &lt; 12; ++i)\n    for (j = 0; j &lt; 12; ++j)\n        fscanf(fileptr, \"%d\", &amp;matr[i][j]);\n// Some important matrix stuff...\nfclose(fileptr); // close your file when done\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 9430314, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AU4Mz.jpg?s=128&g=1", "display_name": "CH4B", "link": "https://stackoverflow.com/users/9430314/ch4b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 50950791, "answer_count": 1, "score": -2, "last_activity_date": 1529505519, "creation_date": 1529504780, "last_edit_date": 1529505189, "question_id": 50950581, "link": "https://stackoverflow.com/questions/50950581/read-matrix-from-txt-file", "title": "Read matrix from .txt file", "body": "<p>This is something kinda hard for me, as the tutorials I found are not really useful, and the answers I found here were quite confusing... I have this .txt file:</p>\n\n<pre><code>1  5  4  7  8  9  6  5  4  7  8  9\n4  8  7  5  2  6  9  8  5  4  4  7\n3  3  2  5  9  9  7  4  5  6  9  8\n1  7  3  6  5  4  7  8  5  1  4  2\n9  5  1  2  3  5  7  8  4  6  5  5\n4  5  9  6  8  2  3  4  8  1  6  3\n8  4  5  3  2  0  1  2  6  9  8  7\n0  2  3  5  4  8  9  5  1  5  6  5\n1  2  0  4  5  9  3  5  7  1  9  4\n4  8  9  5  6  7  8  4  9  1  5  2\n6  3  5  9  8  4  2  3  5  6  7  8\n3  0  2  9  4  0  5  8  9  7  3  1\n</code></pre>\n\n<p>And I need to convert it into a</p>\n\n<pre><code>int matr[12][12];\n</code></pre>\n\n<p>How do I structure my code in order to put all those numbers into a matrix?\nI know I'm supposed to use fscanf and pointers, but I keep getting errors like</p>\n\n<blockquote>\n  <p>cannot convert 'const char*' to 'FILE* {aka _iobuf*}' for argument '1' to 'int fscanf(FILE*, const char*, ...)'</p>\n</blockquote>\n\n<p>So please, just give me some light here.</p>\n"}, {"tags": ["c", "mpi"], "comments": [{"owner": {"reputation": 5326, "user_id": 614065, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f164c6c3b709c97862a0d14f7725830b?s=128&d=identicon&r=PG", "display_name": "Olcay Erta\u015f", "link": "https://stackoverflow.com/users/614065/olcay-erta%c5%9f"}, "edited": false, "score": 0, "creation_date": 1529502788, "post_id": 50949828, "comment_id": 88897426, "body": "Which platform are you trying to compile? Can you share your code? Maybe compiler doesn&#39;t know lib paths."}, {"owner": {"reputation": 72, "user_id": 9361993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfaf5f8c715b845eadc02c72968354a9?s=128&d=identicon&r=PG&f=1", "display_name": "Letsplaybar", "link": "https://stackoverflow.com/users/9361993/letsplaybar"}, "reply_to_user": {"reputation": 5326, "user_id": 614065, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f164c6c3b709c97862a0d14f7725830b?s=128&d=identicon&r=PG", "display_name": "Olcay Erta\u015f", "link": "https://stackoverflow.com/users/614065/olcay-erta%c5%9f"}, "edited": false, "score": 0, "creation_date": 1529502882, "post_id": 50949828, "comment_id": 88897488, "body": "i used a Debian Cluster in the Uni and a Ubuntu on Windows"}, {"owner": {"reputation": 7287, "user_id": 8062491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rd6rD.png?s=128&g=1", "display_name": "Gilles Gouaillardet", "link": "https://stackoverflow.com/users/8062491/gilles-gouaillardet"}, "edited": false, "score": 0, "creation_date": 1529503659, "post_id": 50949828, "comment_id": 88897972, "body": "You are trying to invoke functions that simply do not exist in the MPI standard !"}], "answers": [{"comments": [{"owner": {"reputation": 72, "user_id": 9361993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfaf5f8c715b845eadc02c72968354a9?s=128&d=identicon&r=PG&f=1", "display_name": "Letsplaybar", "link": "https://stackoverflow.com/users/9361993/letsplaybar"}, "edited": false, "score": 0, "creation_date": 1529507434, "post_id": 50950281, "comment_id": 88900676, "body": "I accidentally copied the statement from the standard and did not see that they are written differently in C."}], "tags": [], "owner": {"reputation": 40, "user_id": 7746379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff22bd7507c00954e52cd82f8f0184ae?s=128&d=identicon&r=PG&f=1", "display_name": "valkorai", "link": "https://stackoverflow.com/users/7746379/valkorai"}, "is_accepted": true, "score": 1, "last_activity_date": 1529503870, "creation_date": 1529503870, "answer_id": 50950281, "question_id": 50949828, "link": "https://stackoverflow.com/questions/50949828/mpi-send-and-mpi-recieve-have-no-reference-by-compile/50950281#50950281", "title": "MPI_SEND and MPI_RECIEVE have no Reference by Compile", "body": "<p>Are you talking about MPI_Send and MPI_Recv ?</p>\n\n<p>Don't know about any MPI_SEND or MPI_RECIV function...</p>\n\n<p>I think you just mispelled them.</p>\n\n<p>BTW: here is a great tutorial about how to use them <a href=\"http://mpitutorial.com/tutorials/mpi-send-and-receive/\" rel=\"nofollow noreferrer\">http://mpitutorial.com/tutorials/mpi-send-and-receive/</a></p>\n"}], "owner": {"reputation": 72, "user_id": 9361993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfaf5f8c715b845eadc02c72968354a9?s=128&d=identicon&r=PG&f=1", "display_name": "Letsplaybar", "link": "https://stackoverflow.com/users/9361993/letsplaybar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 50950281, "answer_count": 1, "score": 0, "last_activity_date": 1529507629, "creation_date": 1529502446, "last_edit_date": 1529507629, "question_id": 50949828, "link": "https://stackoverflow.com/questions/50949828/mpi-send-and-mpi-recieve-have-no-reference-by-compile", "title": "MPI_SEND and MPI_RECIEVE have no Reference by Compile", "body": "<p>I am trying to compile an MPI program with mpicc. The compiler complains only that there is no reference to MPI_RECIVE and MPI_SEND, and ends the compile error. I have #include  in the .c file.</p>\n\n<p>Can someone tell me how I can fix this?</p>\n\n<p>Here ist the Code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\n#include &lt;assert.h&gt;\n#include &lt;mpi.h&gt;\n\n#include \"random.h\"\n#include \"md5tool.h\"\n\n/* horizontal size of the configuration */\n#define XSIZE 1024\n\n/* \"ADT\" State and line of states (plus border) */\ntypedef char State;\ntypedef State Line[XSIZE + 2];\n\n/* determine random integer between 0 and n-1 */\n#define randInt(n) ((int)(nextRandomLEcuyer() * n))\n\n/* random starting configuration */\nstatic void initConfig(Line *buf, int lines){\n    int x, y;\n\n    initRandomLEcuyer(424243);\n    for (y = 1;  y &lt;= lines;  y++) {\n        for (x = 1;  x &lt;= XSIZE;  x++) {\n            buf[y][x] = randInt(100) &gt;= 50;\n        }\n    }\n}\n\n/* annealing rule from ChoDro96 page 34 \n * the table is used to map the number of nonzero\n * states in the neighborhood to the new state\n */\nstatic State anneal[10] = {0, 0, 0, 0, 1, 0, 1, 1, 1, 1};\n\n/* a: pointer to array; x,y: coordinates; result: n-th element of anneal,\n      where n is the number of neighbors */\n#define transition(a, x, y) \\\n   (anneal[(a)[(y)-1][(x)-1] + (a)[(y)][(x)-1] + (a)[(y)+1][(x)-1] +\\\n           (a)[(y)-1][(x)  ] + (a)[(y)][(x)  ] + (a)[(y)+1][(x)  ] +\\\n           (a)[(y)-1][(x)+1] + (a)[(y)][(x)+1] + (a)[(y)+1][(x)+1]])\n\n/* treat torus like boundary conditions */\nstatic void boundary(Line *buf, int lines){\n    int x,y;\n    for (y = 0;  y &lt;= lines+1;  y++) {\n        /* copy rightmost column to the buffer column 0 */\n        buf[y][0      ] = buf[y][XSIZE];\n\n        /* copy leftmost column to the buffer column XSIZE + 1 */\n        buf[y][1+1] = buf[y][1    ];\n    }\n\n    for (x = 0;  x &lt;= XSIZE+1;  x++) {\n        /* copy bottommost row to buffer row 0 */\n        buf[0][x      ] = buf[lines][x];\n\n        /* copy topmost row to buffer row lines + 1 */\n        buf[lines+1][x] = buf[1][x    ];\n    }\n}\n/* make one simulation iteration with lines lines.\n * old configuration is in from, new one is written to to.\n */\n\n //umschreiben\n /**\nstatic void simulate(Line *from, Line *to, int lines){\n\n\n    boundary(from, lines); \n    for (y = 1;  y &lt;= lines;  y++) {\n        for (x = 1;  x &lt;= XSIZE;  x++) {\n            to[y][x  ] = transition(from, x  , y);\n        }\n    }\n}\n*/\n\n/* --------------------- measurement ---------------------------------- */\n\nint main(int argc, char** argv){\n    int lines, its;\n    int i;\n    Line *from, *to, *temp, *next;\n    char* hash;\n\n    assert(argc == 3);\n\n    lines = atoi(argv[1]);\n    its   = atoi(argv[2]);\n    from = malloc((lines + 2) * sizeof(Line));\n    to   = malloc((lines + 2) * sizeof(Line));\n\n    MPI_Init(NULL, NULL);\n    // Get the number of processes\n    int world_size;\n    MPI_Comm_size(MPI_COMM_WORLD, &amp;world_size);\n\n    // Get the rank of the process\n    int world_rank;\n    MPI_Comm_rank(MPI_COMM_WORLD, &amp;world_rank);\n\n    if(world_rank == 0){ \n        int y;\n        next = malloc((lines + 2) * sizeof(Line));\n        initConfig(from, lines);\n        for (i = 0;  i &lt; its;  i++) {\n            boundary(from, lines);\n            int z;\n            for(z = 0; z &lt; world_size;z++){\n                if(z !=world_rank ){\n                    MPI_SEND(from,(lines + 2) * sizeof(Line),MPI_CHARACTER,z,0,MPI_COMM_WORLD);\n                }\n            }\n            MPI_Status status;\n            for(z = 0; z &lt; world_size;z++){\n                if(z !=world_rank ){\n                    MPI_RECIVE(next,(lines + 2) * sizeof(Line),MPI_CHARACTER,z,1,&amp;status);\n                    if(status.MPI_ERROR){\n                        //TODO\n                        MPI_Abort(MPI_COMM_WORLD,1);\n                    }\n\n                    for (y = 1;  y &lt;= (lines%world_size+lines/world_size);  y++) {\n                        stpcpy(to[y*z],next[y*z]);\n                    }\n\n                }\n            }\n\n            temp = from;  \n            from = to;  \n            to = temp;\n    }\n\n    hash = getMD5DigestStr(from[1], sizeof(Line) * (lines));\n    printf(\"hash: %s\\n\", hash);\n        free(next);\n    }else{\n        int x,y;\n        MPI_Status status;\n        for(i = 0;  i &lt; its;  i++){\n            MPI_RECIVE(from,(lines + 2) * sizeof(Line),MPI_CHARACTER,0,0,&amp;status);\n            if(status.MPI_ERROR){\n                MPI_Abort(MPI_COMM_WORLD,2);\n            }\n            for (y = 1;  y &lt;= (lines%world_size+lines/world_size);  y++) {\n                for (x = 1;  x &lt;= XSIZE;  x++) {\n                    to[y*world_rank][x  ] = transition(from, x  , y*world_rank);\n                }\n            }\n            MPI_SEND(to,(lines + 2) * sizeof(Line),MPI_CHARACTER,0,1,MPI_COMM_WORLD);\n\n        }\n\n\n    }\n\n\n\n    MPI_Finalize();\n\n    free(from);\n    free(to);\n    free(hash);\n    return 0;\n}\n</code></pre>\n\n<p>This is a C a Sequence implementation which I wrote for the university as a homework assignment.</p>\n"}, {"tags": ["c", "makefile"], "comments": [{"owner": {"reputation": 69991, "user_id": 939557, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/3VPea.png?s=128&g=1", "display_name": "MadScientist", "link": "https://stackoverflow.com/users/939557/madscientist"}, "edited": false, "score": 3, "creation_date": 1529504513, "post_id": 50949720, "comment_id": 88898633, "body": "Just a note about the &quot;considered harmful&quot; paper: many people take the headline and assume recursion should never be used, but that&#39;s not actually what the paper talks about.  It discusses how splitting your dependency graph into multiple makefiles is bad.  However, in some cases recursion doesn&#39;t do that (for example, in your situation you&#39;re building a suite of prerequisites separate from the main objects).  Recursion can be a powerful tool and shouldn&#39;t just be tossed based on a headline... as with most powerful tools there&#39;s a right and wrong way to use it."}], "answers": [{"comments": [{"owner": {"reputation": 69991, "user_id": 939557, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/3VPea.png?s=128&g=1", "display_name": "MadScientist", "link": "https://stackoverflow.com/users/939557/madscientist"}, "edited": false, "score": 0, "creation_date": 1529503956, "post_id": 50949943, "comment_id": 88898178, "body": "A more modern/efficient method of dependency generation, which doesn&#39;t even rely on this feature of GNU make, is described here: <a href=\"http://make.mad-scientist.net/papers/advanced-auto-dependency-generation/\" rel=\"nofollow noreferrer\">make.mad-scientist.net/papers/&hellip;</a>"}], "tags": [], "owner": {"reputation": 149903, "user_id": 14637, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1904e7096278a10f1dfb3fdc0ceb53cc?s=128&d=identicon&r=PG", "display_name": "Thomas", "link": "https://stackoverflow.com/users/14637/thomas"}, "is_accepted": false, "score": 4, "last_activity_date": 1529502845, "creation_date": 1529502845, "answer_id": 50949943, "question_id": 50949720, "link": "https://stackoverflow.com/questions/50949720/building-dependencies-by-a-recursive-call-to-make/50949943#50949943", "title": "Building dependencies by a recursive call to make?", "body": "<p>If you're using GNU make, this hack is unnecessary. GNU make is <a href=\"https://www.gnu.org/software/make/manual/html_node/Automatic-Prerequisites.html\" rel=\"nofollow noreferrer\">smart enough</a> to automatically rebuild any (make)file that is included, and then restart itself:</p>\n\n<blockquote>\n  <p>Since the \u2018.d\u2019 files are makefiles like any others, make will remake them as necessary with no further work from you. See <a href=\"https://www.gnu.org/software/make/manual/html_node/Remaking-Makefiles.html\" rel=\"nofollow noreferrer\">Remaking Makefiles</a>.</p>\n</blockquote>\n\n<p>About other make implementations, the GNU make manual has this to say:</p>\n\n<blockquote>\n  <p>With old make programs, it was traditional practice to use [the -M] compiler feature to generate prerequisites on demand with a command like \u2018make depend\u2019. That command would create a file depend containing all the automatically-generated prerequisites; then the makefile could use include to read them in (see <a href=\"https://www.gnu.org/software/make/manual/html_node/Include.html\" rel=\"nofollow noreferrer\">Include</a>). </p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 1618, "user_id": 4744142, "user_type": "registered", "accept_rate": 40, "profile_image": "https://graph.facebook.com/10205509523369034/picture?type=large", "display_name": "Michel Billaud", "link": "https://stackoverflow.com/users/4744142/michel-billaud"}, "is_accepted": false, "score": 0, "last_activity_date": 1529681365, "creation_date": 1529681365, "answer_id": 50991241, "question_id": 50949720, "link": "https://stackoverflow.com/questions/50949720/building-dependencies-by-a-recursive-call-to-make/50991241#50991241", "title": "Building dependencies by a recursive call to make?", "body": "<p>As remarked by other contributors, gnu make treats .d dependencies files as Makefile and rebuilds them automagically when needed. </p>\n\n<p>This makes the recursive call unnecessary, and the question  falls flat.</p>\n\n<p>Of course, as usual, \"considered harmful\" paper titles have to be read with a grain of salt, if really read at all, from a long tradition (Knuth's \"rebuttal\" of Dijkstra's paper cites Disjktra own fear to be believed as terribly dogmatic\" and \"others making a religion of it\". \"Fanatical advocates going over the board\" !).</p>\n"}], "owner": {"reputation": 1618, "user_id": 4744142, "user_type": "registered", "accept_rate": 40, "profile_image": "https://graph.facebook.com/10205509523369034/picture?type=large", "display_name": "Michel Billaud", "link": "https://stackoverflow.com/users/4744142/michel-billaud"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1529681365, "creation_date": 1529502124, "last_edit_date": 1529680725, "question_id": 50949720, "link": "https://stackoverflow.com/questions/50949720/building-dependencies-by-a-recursive-call-to-make", "title": "Building dependencies by a recursive call to make?", "body": "<p>I've read some articles explaining how recursive makefiles were evil in the case of compiling projects with subdirectories.</p>\n\n<p>But, I found this handy way to automatically generate dependencies </p>\n\n<pre><code>exec = main\nobjs  = main.o A.o B.o C.o   # main and object modules\n\ndeps = $(objs:.o=.d)         # dependencies file\n\nall: $(deps)\n    $(MAKE) $(exec)\n\n-include $(deps)\n\n%.d: %.c                        # how to build dependency files\n    $(CC) -MM $(CFLAGS) $&lt; &gt; $@\n\nmain: $(objs)          # How to build the main exec\n</code></pre>\n\n<p>Building the target \"all\" updates the dependency files if needed, and then considers rebuilding the main exec if needed.</p>\n\n<p>Is there something fundamentally flawed with this approach?</p>\n"}, {"tags": ["java", "android", "c", "android-studio"], "owner": {"reputation": 11, "user_id": 9966768, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/043941a805b4d18449d1397c27604fa7?s=128&d=identicon&r=PG&f=1", "display_name": "Rofinho", "link": "https://stackoverflow.com/users/9966768/rofinho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 219, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1529502417, "creation_date": 1529501508, "last_edit_date": 1529502417, "question_id": 50949492, "link": "https://stackoverflow.com/questions/50949492/barcodedetector-dont-work-and-return-false", "title": "BarcodeDetector dont work and return false", "body": "<p>I come to you for your help on the following:</p>\n\n<p>I develop an application that uses the barcode, but the problem arises when I run the activity that contains the reading of the camera : <code>barcode.isOperational()</code> return false.</p>\n\n<pre><code>@Override\nprotected void onCreate(Bundle savedInstanceState) {\n    super.onCreate(savedInstanceState);\n    setContentView(R.layout.qr_scan_layout);\n    cameraView = (SurfaceView) findViewById(R.id.cameraView);\n    cameraView.setZOrderMediaOverlay(true);\n    holder = cameraView.getHolder();\n    barcode = new BarcodeDetector.Builder(this)\n            .setBarcodeFormats(Barcode.QR_CODE)\n            .build();\n    if (!barcode.isOperational()) {\n        Toast.makeText(getApplicationContext(), \"Sorry, Couldn't setup the detector\", Toast.LENGTH_LONG).show();\n        this.finish();\n    }\n</code></pre>\n\n<p>.......</p>\n\n<p>and in the run there is the following message:</p>\n\n<blockquote>\n  <p>Blockquote\n  W/DynamiteModule: Local module descriptor class for com.google.android.gms.vision.dynamite not found.\n  W/DynamiteModule: Failed to load module via fast routecom.google.android.gms.dynamite.DynamiteModule$zza: V2 version check failed\n  W/DynamiteModule: Local module descriptor class for com.google.android.gms.vision.dynamite not found.\n  E/dalvikvm: Could not find class 'android.os.UserManager', referenced from method com.google.android.gms.common.zze.zzas\n  W/dalvikvm: VFY: unable to resolve check-cast 244 (Landroid/os/UserManager;) in Lcom/google/android/gms/common/zze;\n  W/dalvikvm: VFY: unable to resolve virtual method 456: Landroid/content/pm/PackageManager;.getPackageInstaller ()Landroid/content/pm/PackageInstaller;\n  E/dalvikvm: Could not find class 'android.app.AppOpsManager', referenced from method com.google.android.gms.internal.zzacw.zzg\n  W/dalvikvm: VFY: unable to resolve check-cast 22 (Landroid/app/AppOpsManager;) in Lcom/google/android/gms/internal/zzacw;\n  I/DynamiteModule: Considering local module com.google.android.gms.vision.dynamite:0 and remote module com.google.android.gms.vision.dynamite:1702\n  I/DynamiteModule: Selected remote version of com.google.android.gms.vision.dynamite, version >= 1702\n  W/dalvikvm: VFY: unable to resolve virtual method 4664: Landroid/content/ContextWrapper;.createCredentialProtectedStorageContext ()Landroid/content/Context;\n  W/dalvikvm: VFY: unable to resolve virtual method 4665: Landroid/content/ContextWrapper;.createDeviceProtectedStorageContext ()Landroid/content/Context;\n  W/dalvikvm: VFY: unable to resolve virtual method 4613: Landroid/content/Context;.createDeviceProtectedStorageContext ()Landroid/content/Context;\n  E/dalvikvm: Could not find class 'android.os.UserManager', referenced from method llu.b\n  W/dalvikvm: VFY: unable to resolve const-class 1187 (Landroid/os/UserManager;) in Lllu;\n  W/dalvikvm: VFY: unable to resolve virtual method 4664: Landroid/content/ContextWrapper;.createCredentialProtectedStorageContext ()Landroid/content/Context;\n  W/dalvikvm: VFY: unable to resolve virtual method 4665: Landroid/content/ContextWrapper;.createDeviceProtectedStorageContext ()Landroid/content/Context;\n  W/dalvikvm: VFY: unable to resolve virtual method 13946: Lcom/google/android/chimera/ContextThemeWrapper;.createDisplayContext (Landroid/view/Display;)Landroid/content/Context;\n  W/dalvikvm: VFY: unable to resolve static field 2263 (SUPPORTED_64_BIT_ABIS) in Landroid/os/Build;\n  W/dalvikvm: VFY: unable to resolve static field 2263 (SUPPORTED_64_BIT_ABIS) in Landroid/os/Build;\n  W/dalvikvm: VFY: unable to resolve static field 2262 (SUPPORTED_32_BIT_ABIS) in Landroid/os/Build;\n  W/dalvikvm: VFY: unable to resolve static field 2264 (SUPPORTED_ABIS) in Landroid/os/Build;\n  W/dalvikvm: VFY: unable to resolve virtual method 1777: Landroid/content/pm/PackageManager;.getPackageInstaller ()Landroid/content/pm/PackageInstaller;\n  E/dalvikvm: Could not find class 'android.os.UserManager', referenced from method qu.a\n  W/dalvikvm: VFY: unable to resolve check-cast 579 (Landroid/os/UserManager;) in Lqu;\n  D/libc: pt_debug : pthread_create->start_routine=0x411e4645, tls=0x55379f00, arg=0x5269d860\n  D/libc: pt_debug : __thread_entry->func=0x411e4645\n          , tls=0x55379f00, arg=0x5269d860\n  W/dalvikvm: VFY: unable to resolve virtual method 1647: Landroid/app/NotificationManager;.getNotificationChannel (Ljava/lang/String;)Landroid/app/NotificationChannel;\n  W/dalvikvm: VFY: unable to resolve virtual method 1601: Landroid/app/Notification$Builder;.setChannelId (Ljava/lang/String;)Landroid/app/Notification$Builder;\n  W/dalvikvm: VFY: unable to resolve virtual method 1689: Landroid/content/Context;.isDeviceProtectedStorage ()Z\n  W/dalvikvm: VFY: unable to resolve virtual method 1689: Landroid/content/Context;.isDeviceProtectedStorage ()Z\n  W/dalvikvm: VFY: unable to resolve static method 1541: Landroid/app/AppOpsManager;.permissionToOp (Ljava/lang/String;)Ljava/lang/String;\n  E/dalvikvm: Could not find class 'android.app.AppOpsManager', referenced from method afw.d\n  W/dalvikvm: VFY: unable to resolve const-class 384 (Landroid/app/AppOpsManager;) in Lafw;\n  I/Vision: Loading library libbarhopper.so\n  W/dalvikvm: VFY: unable to resolve static field 1054 (SUPPORTED_64_BIT_ABIS) in Landroid/os/Build;\n  W/dalvikvm: VFY: unable to resolve static field 1053 (SUPPORTED_32_BIT_ABIS) in Landroid/os/Build;\n  W/dalvikvm: VFY: unable to resolve static field 1054 (SUPPORTED_64_BIT_ABIS) in Landroid/os/Build;\n  I/Vision: libbarhopper.so library load status: false\n  I/Vision: Request download for engine barcode\n  W/BarcodeNativeHandle: Native handle not yet available. Reverting to no-op handle.\n  W/DynamiteModule: Local module descriptor class for com.google.android.gms.vision.dynamite not found.\n  W/DynamiteModule: Failed to load module via fast routecom.google.android.gms.dynamite.DynamiteModule$zza: V2 version check failed\n  W/DynamiteModule: Local module descriptor class for com.google.android.gms.vision.dynamite not found.\n  I/DynamiteModule: Considering local module com.google.android.gms.vision.dynamite:0 and remote module com.google.android.gms.vision.dynamite:1702\n  I/DynamiteModule: Selected remote version of com.google.android.gms.vision.dynamite, version >= 1702\n  I/Vision: Loading library libbarhopper.so\n  I/Vision: libbarhopper.so library load status: false\n  D/memalloc: ion: Mapped buffer base:0x5537f000 size:159744 offset:0 fd:89\n  D/memalloc: ion: Mapped buffer base:0x40a67000 size:4096 offset:0 fd:91\n  D/memalloc: ion: Unmapping buffer  base:0x5537f000 size:159744\n  D/memalloc: ion: Unmapping buffer  base:0x40a67000 size:4096</p>\n</blockquote>\n\n<p>here is my <code>Build.Gradle</code> :</p>\n\n<pre><code>apply plugin: 'com.android.application'\n\nandroid {\ncompileSdkVersion 23\nbuildToolsVersion '25.0.1'\ndefaultConfig {\n    applicationId \"com.jconceptstudio.cd.mobilecheque\"\n    minSdkVersion 9\n    targetSdkVersion 23\n    versionCode 1\n    versionName \"1.0\"\n    testInstrumentationRunner \"android.support.test.runner.AndroidJUnitRunner\"\n    multiDexEnabled true\n}\nbuildTypes {\n    release {\n        minifyEnabled false\n        proguardFiles getDefaultProguardFile('proguard-android.txt'), 'proguard-rules.pro'\n    }\n}\nproductFlavors {\n}\n</code></pre>\n\n<p>}</p>\n\n<pre><code>dependencies {\ncompile fileTree(include: ['*.jar'], dir: 'libs')\nandroidTestCompile('com.android.support.test.espresso:espresso-core:2.2.2', {\n    exclude group: 'com.android.support', module: 'support-annotations'\n})\ncompile 'com.google.android.gms:play-services-vision:10.0.1'\ntestCompile 'junit:junit:4.12'\ncompile 'com.android.support:appcompat-v7:23.0.0'\n</code></pre>\n\n<p>}</p>\n\n<h2>when I remove the barcode.isOperational () condition, the activity works but the barcode detection does not work.</h2>\n\n<p>Please note :</p>\n\n<p>However, I noticed the presence of the following lines in my run and I do not know why it happens.</p>\n\n<blockquote>\n  <p>E/dalvikvm: Could not find class 'android.os.UserManager', referenced  from method com.google.android.gms.common.zze.zzas </p>\n  \n  <p>E/dalvikvm: Could not find class 'android.app.AppOpsManager', referenced from method com.google.android.gms.internal.zzacw.zzg </p>\n  \n  <p>E/dalvikvm: Could not find class 'android.os.UserManager', referenced from method llu.b</p>\n  \n  <p>E/dalvikvm: Could not find class 'android.os.UserManager', referenced from method qu.a </p>\n  \n  <p>E/dalvikvm: Could not find class 'android.app.AppOpsManager', referenced from method afw.d</p>\n</blockquote>\n"}, {"tags": ["c", "sockets", "getaddrinfo", "gethostbyname"], "comments": [{"owner": {"reputation": 360, "user_id": 5875805, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S4zBy.jpg?s=128&g=1", "display_name": "Tormund Giantsbane", "link": "https://stackoverflow.com/users/5875805/tormund-giantsbane"}, "edited": false, "score": 0, "creation_date": 1529502561, "post_id": 50949291, "comment_id": 88897248, "body": "Where do these variables <code>x</code>, <code>domain</code>, <code>socketType</code>, <code>hostname</code>, <code>fd</code> come from?"}, {"owner": {"reputation": 316, "user_id": 5014179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40da5af8c5586b883ae742ed9af2732f?s=128&d=identicon&r=PG&f=1", "display_name": "Pellekrino", "link": "https://stackoverflow.com/users/5014179/pellekrino"}, "reply_to_user": {"reputation": 360, "user_id": 5875805, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S4zBy.jpg?s=128&g=1", "display_name": "Tormund Giantsbane", "link": "https://stackoverflow.com/users/5875805/tormund-giantsbane"}, "edited": false, "score": 0, "creation_date": 1529503179, "post_id": 50949291, "comment_id": 88897691, "body": "&quot;//simplified loops &amp; error handling for concision&quot; i should have added also int and error var declaration. Since i wanted to post 4 similar piece of code, i tried to keep only the minimum to understand the differences and keep it concise. I could have pasted everything with traces, loops and errors it wouldn&#39;t have helped here. let me fix a few declarations then"}, {"owner": {"reputation": 316, "user_id": 5014179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40da5af8c5586b883ae742ed9af2732f?s=128&d=identicon&r=PG&f=1", "display_name": "Pellekrino", "link": "https://stackoverflow.com/users/5014179/pellekrino"}, "reply_to_user": {"reputation": 360, "user_id": 5875805, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S4zBy.jpg?s=128&g=1", "display_name": "Tormund Giantsbane", "link": "https://stackoverflow.com/users/5875805/tormund-giantsbane"}, "edited": false, "score": 1, "creation_date": 1529504888, "post_id": 50949291, "comment_id": 88898881, "body": "I finally added to both questions and answer function prototype and type declaration for every var (hope i didn&#39;t miss one)."}], "answers": [{"tags": [], "owner": {"reputation": 316, "user_id": 5014179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40da5af8c5586b883ae742ed9af2732f?s=128&d=identicon&r=PG&f=1", "display_name": "Pellekrino", "link": "https://stackoverflow.com/users/5014179/pellekrino"}, "is_accepted": true, "score": 5, "last_activity_date": 1529504684, "last_edit_date": 1529504684, "creation_date": 1529502067, "answer_id": 50949690, "question_id": 50949291, "link": "https://stackoverflow.com/questions/50949291/connecting-a-socket-using-getaddrinfo-times-out/50949690#50949690", "title": "Connecting a socket, using getaddrinfo, times out", "body": "<p>The reason why it kept failing was : to retrieve the addrinfo, I had left the field 'service' equals to NULL. It will still return success and provide you an address (which you can map with getnameinfo to the right IP address). Still the address won't be usable to connect your socket !</p>\n\n<p>I had found an hybrid version of both methods here : \n<a href=\"https://codereview.stackexchange.com/questions/17863/socket-connect-realization-gethostbyname-or-getnameinfo\">https://codereview.stackexchange.com/questions/17863/socket-connect-realization-gethostbyname-or-getnameinfo</a>\nThis one is functional, but i don't buy the casting</p>\n\n<pre><code>void connect_UsingGetAddrInfo_HYBRID (std::string host, unsigned short int port, int&amp; socketfd)\n{\n    //simplified loops &amp; error handling for concision\n    int x;\n\n    int domain = AF_INET;         // IP_v4\n    int socketType = SOCK_STREAM; // Sequenced, reliable, connection-based byte streams. \n\n    addrinfo hints, *addr;\n    //fine-tune hints according to which socket you want to open\n    hints.ai_family = domain; \n    hints.ai_socktype = socketType; \n    hints.ai_protocol = 0;           // no enum : possible value can be read in /etc/protocols\n    hints.ai_flags = AI_CANONNAME | AI_ALL | AI_ADDRCONFIG;\n\n    x =  getaddrinfo(host, NULL, &amp;hints, &amp;addr);\n    socketfd = socket(addr-&gt;ai_family, addr-&gt;ai_socktype, addr-&gt;ai_protocol);\n\n    //here is the hybrid part\n    sockaddr_in servAddr;\n    memset(&amp;servAddr, 0, sizeof(servAddr));\n    servAddr.sin_family = addr-&gt;ai_family;\n    servAddr.sin_addr.s_addr = *((uint32_t*) &amp; (((sockaddr_in*)addr-&gt;ai_addr)-&gt;sin_addr));\n    servAddr.sin_port        = htons(port);\n\n    x=connect(socketfd, (struct sockaddr*) &amp;servAddr, sizeof(servAddr));\n}\n</code></pre>\n\n<p>In the end, it helped me find the rootcause :</p>\n\n<pre><code>void connect_UsingGetAddrInfo_FIXED (std::string host, unsigned short int port, int&amp; socketfd)\n{\n    //simplified loops &amp; error handling for concision\n    int x;\n\n    int domain = AF_INET;         // IP_v4\n    int socketType = SOCK_STREAM; // Sequenced, reliable, connection-based byte streams.  \n\n    addrinfo hints, *addr;\n    //fine-tune hints according to which socket you want to open\n    hints.ai_family = domain; \n    hints.ai_socktype = socketType; \n    hints.ai_protocol = 0;           // no enum : possible value can be read in /etc/protocols\n    hints.ai_flags = AI_CANONNAME | AI_ALL | AI_ADDRCONFIG;\n\n    //Precise here the port !\n    const char* service = std::to_string(port).c_str();\n\n    x =  getaddrinfo(host, service, &amp;hints, &amp;addr);\n    socketfd = socket(addr-&gt;ai_family, addr-&gt;ai_socktype, addr-&gt;ai_protocol);\n    x = connect(socketfd, addr-&gt;ai_addr, addr-&gt;ai_addrlen);\n}\n</code></pre>\n\n<p>Hope this will help someone one day ! </p>\n"}], "owner": {"reputation": 316, "user_id": 5014179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40da5af8c5586b883ae742ed9af2732f?s=128&d=identicon&r=PG&f=1", "display_name": "Pellekrino", "link": "https://stackoverflow.com/users/5014179/pellekrino"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1666, "favorite_count": 2, "accepted_answer_id": 50949690, "answer_count": 1, "score": 4, "last_activity_date": 1529504684, "creation_date": 1529500912, "last_edit_date": 1529504106, "question_id": 50949291, "link": "https://stackoverflow.com/questions/50949291/connecting-a-socket-using-getaddrinfo-times-out", "title": "Connecting a socket, using getaddrinfo, times out", "body": "<p>I spent hours trying to find out my issue, just found the solution as I was writing my question (it always help when you need to formalize your issue and explain it). I post it, hopefully it helps someone.</p>\n\n<p>Using getaddrinfo, if I try to connect a socket to my server, doing (what I thought was) exactly what is being explained on tons of website aswell as in the man page sample code of getaddrinfo, it FAILS with a \"connection timed out\" error message:\n(Simplifying the code to be more concise)</p>\n\n<pre><code>void connect_UsingGetAddrInfo_Wrong (std::string host, unsigned short int port, int&amp; socketfd)\n{\n    //simplified loops &amp; error handling for concision\n    int x;\n\n    int domain = AF_INET;         // IP_v4\n    int socketType = SOCK_STREAM; // Sequenced, reliable, connection-based byte streams.  \n\n    addrinfo hints, *addr;\n    //fine-tune hints according to which socket you want to open\n    hints.ai_family = domain; \n    hints.ai_socktype = socketType; \n    hints.ai_protocol = 0;           // no enum : possible value can be read in /etc/protocols\n    hints.ai_flags = AI_CANONNAME | AI_ALL | AI_ADDRCONFIG;\n\n    x =  getaddrinfo(hostname, NULL, &amp;hints, &amp;addr);\n    //shall rather loop on addr linked list, but this is not the topic here.\n\n    socketfd = socket(addr-&gt;ai_family, addr-&gt;ai_socktype, addr-&gt;ai_protocol);\n    x = connect(socketfd, addr-&gt;ai_addr, addr-&gt;ai_addrlen);\n}\n</code></pre>\n\n<p>However, I was able to connect a socket to the same server, using gethostbyname method. </p>\n\n<pre><code>void connect_UsingGetHostByName_Deprecated (std::string host, unsigned short int port, int&amp; socketfd)\n{\n    //simplified loops &amp; error handling for concision\n    int x;\n\n    int domain = AF_INET;         // IP_v4\n    int socketType = SOCK_STREAM; // Sequenced, reliable, connection-based byte streams.  \n\n    struct hostent DNS, *r;\n    char buf[1024];\n    x = gethostbyname_r(hostname.c_str(), &amp; DNS, buf, sizeof(buf), &amp; r, &amp; err));\n    socketfd = socket(domain, socketType, 0);\n\n    //server.\n    sockaddr_in server;\n    memset(&amp;server, 0x00, sizeof(server));\n    server.sin_family=domain;\n    server.sin_port=htons(port);\n    memcpy(&amp; server.sin_addr.s_addr, DNS.h_addr, (size_t) DNS.h_length);\n    x = connect(socketfd, (struct sockaddr *) &amp; server, sizeof(server));\n}\n</code></pre>\n\n<p>Running code shows that both version correctly retrieve the valid IP address of the server. Still the first one won't connect and will time out.\nWhy ? </p>\n"}, {"tags": ["c", "process", "operating-system", "pipe", "ps"], "comments": [{"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 1, "creation_date": 1529500874, "post_id": 50949214, "comment_id": 88896049, "body": "<code>getpid()</code> will not return 0 for the child process after a call to <code>fork()</code>, it will return the child process&#39;s actual PID. You need to check the value returned by <code>fork()</code>, not the value returned by <code>getpid()</code>."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1529501206, "post_id": 50949214, "comment_id": 88896265, "body": "The parent must hold open all pipe ends that its child needs to use until <i>after</i> it forks that child.  Any that it closes before forking will already be closed in the child when it starts executing."}, {"owner": {"reputation": 1, "user_id": 9967542, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-V8QnaZMc8i0/AAAAAAAAAAI/AAAAAAAABbA/h_OUZvzUtKE/photo.jpg?sz=128", "display_name": "francesco messina", "link": "https://stackoverflow.com/users/9967542/francesco-messina"}, "edited": false, "score": 0, "creation_date": 1529501331, "post_id": 50949214, "comment_id": 88896350, "body": "Actually i first write pid = fork() also before the first if..is it correct like this?"}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1529501472, "post_id": 50949214, "comment_id": 88896440, "body": "Yes, <code>pid = fork();</code> will set the <code>pid</code> variable to 0 for the child process."}, {"owner": {"reputation": 1, "user_id": 9967542, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-V8QnaZMc8i0/AAAAAAAAAAI/AAAAAAAABbA/h_OUZvzUtKE/photo.jpg?sz=128", "display_name": "francesco messina", "link": "https://stackoverflow.com/users/9967542/francesco-messina"}, "edited": false, "score": 0, "creation_date": 1529501671, "post_id": 50949214, "comment_id": 88896584, "body": "Ok, now looks like it receive the string from parent to the child and grandchild.. thanks..but now how do I pass a bash command and execute?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1529505616, "post_id": 50949214, "comment_id": 88899367, "body": "<code>ps</code> is not a <i>bash</i> command specifically.  It&#39;s a command, period.  You can execute it via bash, or via another shell instead.  Or, as I imagine the assignment expects, you can execute it via one of the exec-family functions, such as <code>execvp()</code>."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1529505816, "post_id": 50949214, "comment_id": 88899517, "body": "As for getting the command from parent to grandchild, I can only guess at what the exercise specifies, but it seems likely that that&#39;s the point of the pipes.  Certainly that&#39;s what I assumed when I first read your question."}, {"owner": {"reputation": 8293, "user_id": 8656552, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FPg67.png?s=128&g=1", "display_name": "Paul Hodges", "link": "https://stackoverflow.com/users/8656552/paul-hodges"}, "edited": false, "score": 0, "creation_date": 1529511615, "post_id": 50949214, "comment_id": 88903332, "body": "Are you allowed to use <a href=\"http://man7.org/linux/man-pages/man3/popen.3.html\" rel=\"nofollow noreferrer\">popen()</a>?"}, {"owner": {"reputation": 1, "user_id": 9967542, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-V8QnaZMc8i0/AAAAAAAAAAI/AAAAAAAABbA/h_OUZvzUtKE/photo.jpg?sz=128", "display_name": "francesco messina", "link": "https://stackoverflow.com/users/9967542/francesco-messina"}, "edited": false, "score": 0, "creation_date": 1529595149, "post_id": 50949214, "comment_id": 88941114, "body": "Never heard of it actually..but as i read from the man page it looks like is the thing i&#39;, searching for this purpose"}, {"owner": {"reputation": 1, "user_id": 9967542, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-V8QnaZMc8i0/AAAAAAAAAAI/AAAAAAAABbA/h_OUZvzUtKE/photo.jpg?sz=128", "display_name": "francesco messina", "link": "https://stackoverflow.com/users/9967542/francesco-messina"}, "edited": false, "score": 0, "creation_date": 1529596568, "post_id": 50949214, "comment_id": 88942039, "body": "I tried to use the popen() but it gives me the segmentation error..what should i put inside the brachets?"}], "owner": {"reputation": 1, "user_id": 9967542, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-V8QnaZMc8i0/AAAAAAAAAAI/AAAAAAAABbA/h_OUZvzUtKE/photo.jpg?sz=128", "display_name": "francesco messina", "link": "https://stackoverflow.com/users/9967542/francesco-messina"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 96, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1529502288, "creation_date": 1529500655, "last_edit_date": 1529502288, "question_id": 50949214, "link": "https://stackoverflow.com/questions/50949214/c-pipe-and-processes", "title": "C pipe and processes", "body": "<p>I have a question for this process homework. \nThere's a parent process that has two child(the first just print hello) , the second child have another child.\nThe parent should pass to the child(the second one) the bash command \"ps\", then it passes through the other child(the grandchild) and this should execute the command.\nI first tried to pass just a string to see if I put correct all the the pipe and the relation between parent and child, but it does print correctly the string.</p>\n\n<p>Could you help me for this problem? and also with the bash command as well?</p>\n\n<p>Thanks to everyone who read this </p>\n\n<pre><code>int main(){ \n\npid_t pid;\nint pipefd[2];\nchar comando[10] ;\npipe(pipefd);\n\n\n\nfork();\npid = getpid();\n\nif(pid == 0){ // figlio F1\n    printf(\"C:F1 printing...\");\n    printf(\"    HELLO   \");\n}else if(pid &gt; 0){//parent\n    printf(\"P: sending command ps to F2\\n\");        \n    comando[10] = \"ps\";\n\n    close(pipefd[0]);   \n    write(pipefd[1],(void*)&amp;comando ,sizeof(comando)  );\n\n\n    pid = fork();\n    if(pid == 0){//figlio F2\n        printf(\"C:F2 receiving from parent \\n\");\n        close( pipefd[1] );\n        read(pipefd[0], (void*)&amp;comando , sizeof(comando));\n        printf(\"C:F2 riceve %s \\n\",comando);\n        pid = fork();\n        printf(\"C:F2 sending %s to F3\\n\",comando);\n        close(pipefd[0]);\n        write(pipefd[1], (void*)&amp;comando, sizeof(comando));\n        if(pid == 0){\n            printf(\"C:F3 receiving from F2\\n\");\n            close( pipefd[1] );\n            read(pipefd[0], (void*)&amp;comando , sizeof(comando));\n            //int system(const char *comando);\n            printf(\"C:F3 print %s \\n\",comando);\n        }\n    }\n}else{\n    printf(\"fork error\\n\");     \n}\nwait(NULL);\nreturn 0;\n}\n</code></pre>\n"}, {"tags": ["c", "python-2.7", "ctypes"], "comments": [{"owner": {"reputation": 28355, "user_id": 4788546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2jWn.jpg?s=128&g=1", "display_name": "CristiFati", "link": "https://stackoverflow.com/users/4788546/cristifati"}, "edited": false, "score": 0, "creation_date": 1529506523, "post_id": 50949186, "comment_id": 88900024, "body": "<a href=\"https://stackoverflow.com/help/mcve\">&#91;SO&#93;: How to create a Minimal, Complete, and Verifiable example (mcve)</a>."}, {"owner": {"reputation": 6531, "user_id": 507028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/150b5324471a76f6f2fa9dd2380ad611?s=128&d=identicon&r=PG", "display_name": "Neitsa", "link": "https://stackoverflow.com/users/507028/neitsa"}, "edited": false, "score": 1, "creation_date": 1529511619, "post_id": 50949186, "comment_id": 88903334, "body": "See <a href=\"https://docs.python.org/2.7/library/ctypes.html#accessing-values-exported-from-dlls\" rel=\"nofollow noreferrer\">Accessing values exported from dlls</a> from the python documentation."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 9967630, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-oDsrnTHKKtw/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1G9AuxtkWWqsqOacKXoG1EeqN9QQ/mo/photo.jpg?sz=128", "display_name": "Akshay Kumar Meena", "link": "https://stackoverflow.com/users/9967630/akshay-kumar-meena"}, "edited": false, "score": 0, "creation_date": 1529558387, "post_id": 50954986, "comment_id": 88918521, "body": "I want to use it in ubuntu. So how to implement this for .so files"}, {"owner": {"reputation": 131156, "user_id": 235698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KjvlE.png?s=128&g=1", "display_name": "Mark Tolonen", "link": "https://stackoverflow.com/users/235698/mark-tolonen"}, "reply_to_user": {"reputation": 13, "user_id": 9967630, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-oDsrnTHKKtw/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1G9AuxtkWWqsqOacKXoG1EeqN9QQ/mo/photo.jpg?sz=128", "display_name": "Akshay Kumar Meena", "link": "https://stackoverflow.com/users/9967630/akshay-kumar-meena"}, "edited": false, "score": 0, "creation_date": 1529558875, "post_id": 50954986, "comment_id": 88918681, "body": "@Akshay Same Python code, I just had a Windows system to test with.  Just export a global variable in a .so file."}, {"owner": {"reputation": 13, "user_id": 9967630, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-oDsrnTHKKtw/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1G9AuxtkWWqsqOacKXoG1EeqN9QQ/mo/photo.jpg?sz=128", "display_name": "Akshay Kumar Meena", "link": "https://stackoverflow.com/users/9967630/akshay-kumar-meena"}, "edited": false, "score": 0, "creation_date": 1529563115, "post_id": 50954986, "comment_id": 88920505, "body": "It is showing me the error of undefined symbol.                                            ValueError: /home/akshay/Desktop/ffmpeg/linking/addr.so: undefined symbol: globalVar"}, {"owner": {"reputation": 131156, "user_id": 235698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KjvlE.png?s=128&g=1", "display_name": "Mark Tolonen", "link": "https://stackoverflow.com/users/235698/mark-tolonen"}, "reply_to_user": {"reputation": 13, "user_id": 9967630, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-oDsrnTHKKtw/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1G9AuxtkWWqsqOacKXoG1EeqN9QQ/mo/photo.jpg?sz=128", "display_name": "Akshay Kumar Meena", "link": "https://stackoverflow.com/users/9967630/akshay-kumar-meena"}, "edited": false, "score": 0, "creation_date": 1529566435, "post_id": 50954986, "comment_id": 88922340, "body": "You may need something like <code>__attribute__ ((visibility (&quot;default&quot;)))</code> in Linux to do the equivalent of Windows&#39; <code>__declspec(dllexport)</code> to export the definition from the shared library.  See <a href=\"http://gcc.gnu.org/wiki/Visibility\" rel=\"nofollow noreferrer\">gcc.gnu.org/wiki/Visibility</a>.  I don&#39;t have a Linux account handy to work it out."}, {"owner": {"reputation": 131156, "user_id": 235698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KjvlE.png?s=128&g=1", "display_name": "Mark Tolonen", "link": "https://stackoverflow.com/users/235698/mark-tolonen"}, "reply_to_user": {"reputation": 13, "user_id": 9967630, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-oDsrnTHKKtw/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1G9AuxtkWWqsqOacKXoG1EeqN9QQ/mo/photo.jpg?sz=128", "display_name": "Akshay Kumar Meena", "link": "https://stackoverflow.com/users/9967630/akshay-kumar-meena"}, "edited": false, "score": 0, "creation_date": 1529566805, "post_id": 50954986, "comment_id": 88922597, "body": "@Akshay <code>extern int globalVar;</code> may also work.  My Linux is rusty."}], "tags": [], "owner": {"reputation": 131156, "user_id": 235698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KjvlE.png?s=128&g=1", "display_name": "Mark Tolonen", "link": "https://stackoverflow.com/users/235698/mark-tolonen"}, "is_accepted": true, "score": 1, "last_activity_date": 1529519869, "creation_date": 1529519869, "answer_id": 50954986, "question_id": 50949186, "link": "https://stackoverflow.com/questions/50949186/calling-global-variable-of-c-in-python/50954986#50954986", "title": "Calling global variable of C in Python", "body": "<p>Given this one-line source for a Windows DLL:</p>\n\n<pre><code>__declspec(dllexport) int test = 5;\n</code></pre>\n\n<p>You access global variables by using the <code>.in_dll()</code> method of a ctypes type, which takes a ctypes DLL reference and the name of the global variable:</p>\n\n<pre><code>&gt;&gt;&gt; from ctypes import *\n&gt;&gt;&gt; dll = CDLL('test')   # test.dll of the above source.\n&gt;&gt;&gt; c_int.in_dll(dll,'test')\nc_long(5)\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 9967630, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-oDsrnTHKKtw/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1G9AuxtkWWqsqOacKXoG1EeqN9QQ/mo/photo.jpg?sz=128", "display_name": "Akshay Kumar Meena", "link": "https://stackoverflow.com/users/9967630/akshay-kumar-meena"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 285, "favorite_count": 0, "accepted_answer_id": 50954986, "answer_count": 1, "score": 1, "last_activity_date": 1529563278, "creation_date": 1529500585, "last_edit_date": 1529563278, "question_id": 50949186, "link": "https://stackoverflow.com/questions/50949186/calling-global-variable-of-c-in-python", "title": "Calling global variable of C in Python", "body": "<p>I want to access the global variable of c in python. I can already use/access the functions of c in python using ctypes after making a .so file.\nHere's the C code :</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint globalVar = 2;\n\nvoid add_int(int num1,int num2){\n    globalVar = num1+num2;\n    fprintf(globalVar, \"%d\\n\", );\n}\n\nfloat add_float(float num1,float num2){\n    return num1+num2;\n}\n</code></pre>\n\n<p>and the Python Code:</p>\n\n<pre><code>from ctypes import *\n\nadder = CDLL('/home/akshay/Desktop/ffmpeg/linking/addr.so')\n\nadder.add_int(4,5)\n\nvar = c_int.in_dll(adder,\"globalVar\")\nprint \"Sum of 4 and 5 = \" + str(adder.add_int(4,5))\n\na = c_float(5.5)\nb = c_float(4.1)\n\nadd_float = adder.add_float\nadd_float.restype = c_float\nprint \"Sum of 5.5 and 4.1 = \", str(add_float(a, b))\n</code></pre>\n"}, {"tags": ["c", "gcc", "compilation", "compiler-optimization", "compile-time"], "comments": [{"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 1, "creation_date": 1529500510, "post_id": 50949055, "comment_id": 88895814, "body": "Why don&#39;t you consider generating C (or C++) code from your parser generator tool? This is usual practice!"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1529501894, "post_id": 50949055, "comment_id": 88896757, "body": "&quot;... allocated on the heap&quot; That makes me think - no, not possible."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1529502105, "post_id": 50949055, "comment_id": 88896915, "body": "You can do it in principle. But I assume your generated parser will have a lot of pointers. Which won&#39;t be guaranteed to be correct when you load and run it."}, {"owner": {"reputation": 387, "user_id": 7208947, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/43e59c36d69a180a9b501f93099c05ac?s=128&d=identicon&r=PG", "display_name": "VannTen", "link": "https://stackoverflow.com/users/7208947/vannten"}, "reply_to_user": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1533628663, "post_id": 50949055, "comment_id": 90403762, "body": "@BasileStarynkevitch I did consider it, in fact I used that method initially. But it added some complexity, since generating C from C is not that fun, and I also had to consider that at the build system level. If I was to redo that project (a shell), I&#39;ll certainly go that way, since constructing the parser at startup is probably quite a cost, given a complex enough grammar. But I was curious to know if there was use cases of compiler optimizations like this one. Sorry for the late reply by the way^."}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1533630818, "post_id": 50949055, "comment_id": 90404954, "body": "BTW, on Linux and POSIX systems, you might generate some temporary C code in <code>&#47;tmp&#47;tempcode.c</code>, compile it as a plugin (<code>gcc -Wall -O -fPIC -shared &#47;tmp&#47;tempcode.c -o &#47;tmp&#47;tempcode.so</code>) then <code>dlopen</code> that <code>&#47;tmp&#47;tempcode.so</code> plugin. See <a href=\"http://man7.org/linux/man-pages/man3/dlopen.3.html\" rel=\"nofollow noreferrer\">dlopen(3)</a> and <a href=\"http://man7.org/linux/man-pages/man3/dlsym.3.html\" rel=\"nofollow noreferrer\">dlsym(3)</a>"}], "answers": [{"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 1, "last_activity_date": 1529501411, "creation_date": 1529501411, "answer_id": 50949455, "question_id": 50949055, "link": "https://stackoverflow.com/questions/50949055/can-gcc-clang-optimize-initialization-computing/50949455#50949455", "title": "Can gcc/clang optimize initialization computing?", "body": "<p>What you could do in this case is have code that generates code.</p>\n\n<p>Have your initial parser generator as a separate piece of code that runs independently.  The output of this code would be a header file containing a set of variable definitions initialized to the proper values.  You then use this file in your main code.</p>\n\n<p>As an example, suppose you have a program that needs to know the number of bits that are set in a given byte.  You could do this manually whenever you need:</p>\n\n<pre><code>int count_bits(uint8_t b)\n{\n    int count = 0;\n    while (b) {\n        count += b &amp; 1;\n        b &gt;&gt;= 1;\n    }\n    return count;\n}\n</code></pre>\n\n<p>Or you can generate the table in a separate program:</p>\n\n<pre><code>int main()\n{\n    FILE *header = fopen(\"bitcount.h\", \"w\");\n    if (!header) {\n        perror(\"fopen failed\");\n        exit(1);\n    }\n\n    fprintf(header, \"int bit_counts[256] = {\\n\");\n\n    int count;\n    unsigned v;\n\n    for (v=0,count=0; v&lt;256; v++) {\n        uint8_t b = v;\n        while (b) {\n            count += b &amp; 1;\n            b &gt;&gt;= 1;\n        }\n        fprintf(header, \"    %d,\\n\" count);\n    }\n\n    fprintf(header, \"};\\n\");\n    fclose(header);\n    return 0;\n}\n</code></pre>\n\n<p>This create a file called bitcount.h that looks like this:</p>\n\n<pre><code>int bit_counts[256] = {\n    0,\n    1,\n    1,\n    2,\n    ...\n    7,\n};\n</code></pre>\n\n<p>That you can include in your \"real\" code.</p>\n"}], "owner": {"reputation": 387, "user_id": 7208947, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/43e59c36d69a180a9b501f93099c05ac?s=128&d=identicon&r=PG", "display_name": "VannTen", "link": "https://stackoverflow.com/users/7208947/vannten"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1529501411, "creation_date": 1529500187, "question_id": 50949055, "link": "https://stackoverflow.com/questions/50949055/can-gcc-clang-optimize-initialization-computing", "title": "Can gcc/clang optimize initialization computing?", "body": "<p>I recently wrote a parser generator tool that takes a BNF grammar (as a string) and a set of actions (as a function pointer array) and output a parser (= a state automaton, allocated on the heap). I then use another function to use that parser on my input data and generates a abstract syntax tree.</p>\n\n<p>In the initial parser generation, there is quite a lot of steps, and i was wondering if gcc or clang are able to optimize this, given constant inputs to the parser generation function (and never using the pointers values, only dereferencing them) ? Is is possible to run the function at compile time, and embed the result (aka, the allocated memory) in the executable ?</p>\n\n<p>(obviously, that would be using link time optimization, since the compiler would need to be able to check that the whole function does indeed have the same result with the same parameters)</p>\n"}, {"tags": ["c", "embedded", "fpga", "microblaze"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1529498661, "post_id": 50948549, "comment_id": 88894649, "body": "Bitwise shifts and OR operations is one way to go. And don&#39;t forget to use only <code>unsigned</code> data types."}, {"owner": {"reputation": 858, "user_id": 4267929, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/98885eca3b83031612bef15ed5b21abc?s=128&d=identicon&r=PG&f=1", "display_name": "Henricus V.", "link": "https://stackoverflow.com/users/4267929/henricus-v"}, "edited": false, "score": 1, "creation_date": 1529498700, "post_id": 50948549, "comment_id": 88894669, "body": "You could do it in a <a href=\"https://stackoverflow.com/questions/31310496/smallest-data-type-can-i-define-a-one-bit-variable\">struct</a>"}, {"owner": {"reputation": 5590, "user_id": 3535598, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XmZch.png?s=128&g=1", "display_name": "Oldfart", "link": "https://stackoverflow.com/users/3535598/oldfart"}, "edited": false, "score": 0, "creation_date": 1529498769, "post_id": 50948549, "comment_id": 88894700, "body": "If you have written the LCD Verilog you could add the bit-set and bit-clear operations in there."}], "answers": [{"comments": [{"owner": {"reputation": 2405, "user_id": 1526321, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/g5TKE.jpg?s=128&g=1", "display_name": "PhilMasterG", "link": "https://stackoverflow.com/users/1526321/philmasterg"}, "edited": false, "score": 1, "creation_date": 1529498845, "post_id": 50948624, "comment_id": 88894747, "body": "I guess you mean <code>:</code> instead of <code>=</code>?"}, {"owner": {"reputation": 61409, "user_id": 485343, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e18b024a122df74275dd2c4486e8a2b4?s=128&d=identicon&r=PG", "display_name": "rustyx", "link": "https://stackoverflow.com/users/485343/rustyx"}, "edited": false, "score": 6, "creation_date": 1529498908, "post_id": 50948624, "comment_id": 88894785, "body": "Be careful with <a href=\"https://wiki.sei.cmu.edu/confluence/display/c/EXP11-C.+Do+not+make+assumptions+regarding+the+layout+of+structures+with+bit-fields\" rel=\"nofollow noreferrer\">relying on bit field layout</a>."}, {"owner": {"reputation": 5590, "user_id": 3535598, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XmZch.png?s=128&g=1", "display_name": "Oldfart", "link": "https://stackoverflow.com/users/3535598/oldfart"}, "edited": false, "score": 0, "creation_date": 1529498944, "post_id": 50948624, "comment_id": 88894805, "body": "That does not control the way the bit is written. We are talking hardware registers here. Also the language allows the bit mapping to be ignored."}, {"owner": {"reputation": 4888, "user_id": 5785362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a786fd81952576dc07942023bf8830b?s=128&d=identicon&r=PG", "display_name": "tofro", "link": "https://stackoverflow.com/users/5785362/tofro"}, "edited": false, "score": 1, "creation_date": 1529609833, "post_id": 50948624, "comment_id": 88948602, "body": "Bitfields can be made to work with a specific compiler and a specific machine. Once you change one of these parameters, nothing is guaranteed any more. After you have experienced the porting effort of such a construct onto another platform, you will very probably be convinced that bitfields are not a good idea to access hardware directly."}], "tags": [], "owner": {"reputation": 355, "user_id": 9515951, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-m53-xNkMviQ/AAAAAAAAAAI/AAAAAAAAAW0/rfDtMQwohLs/photo.jpg?sz=128", "display_name": "Umaiki", "link": "https://stackoverflow.com/users/9515951/umaiki"}, "is_accepted": false, "score": 0, "last_activity_date": 1529499187, "last_edit_date": 1529499187, "creation_date": 1529498764, "answer_id": 50948624, "question_id": 50948549, "link": "https://stackoverflow.com/questions/50948549/how-to-control-a-single-bit-within-a-variable/50948624#50948624", "title": "How to control a single bit within a variable?", "body": "<p>You can create a bitfields within a struct:</p>\n\n<pre><code>typedef struct {\n  Uint32 LCD_RS : 1, /* 1 is the size in bit */\n         LCD_RW : 1,\n         LCD_E  : 1,\n         bus    : 4\n                : 15;\n} data;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 9657727, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9e284181f2c852f470e3306b937d73d?s=128&d=identicon&r=PG&f=1", "display_name": "Arnold Hucks", "link": "https://stackoverflow.com/users/9657727/arnold-hucks"}, "edited": false, "score": 0, "creation_date": 1529501055, "post_id": 50948843, "comment_id": 88896158, "body": "Many thanks. Using read-modify-write, is there a way to a change to a set of bits, such as for 4 bits from the value i want to send?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1529502501, "post_id": 50948843, "comment_id": 88897205, "body": "To avoid UB shifting into a sign bit, use an unsigned 1 as in <code>1u&lt;&lt;LCD_RS_BIT_POS</code>.  To work with 16-bit <code>int&#47;unsigned</code>, use a wider  1, <code>((unitn32_t)1) &lt;&lt;LCD_RS_BIT_POS</code> or the like.  <code>data &amp;= ~(1&lt;&lt;LCD_RS_BIT_POS)</code> will fail with 16-bit <code>int&#47;unsigned</code>."}], "tags": [], "owner": {"reputation": 5590, "user_id": 3535598, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XmZch.png?s=128&g=1", "display_name": "Oldfart", "link": "https://stackoverflow.com/users/3535598/oldfart"}, "is_accepted": true, "score": 0, "last_activity_date": 1529572677, "last_edit_date": 1529572677, "creation_date": 1529499497, "answer_id": 50948843, "question_id": 50948549, "link": "https://stackoverflow.com/questions/50948549/how-to-control-a-single-bit-within-a-variable/50948843#50948843", "title": "How to control a single bit within a variable?", "body": "<p>As you want a very precise defined way of bit control, the safest way is to use read-modify-write. </p>\n\n<pre><code>volatile uint32_t *reg_address;\nuint32_t data;\n   data  = *reg_address;\n   data |= (1&lt;&lt;LCD_RS_BIT_POS); // Set bit \n   // data &amp;= ~(1&lt;&lt;LCD_RS_BIT_POS); // Clear bit \n   *reg_address = data;\n</code></pre>\n\n<p>Alternative is to add bit-set/bit clear address locations to you LCD port register map (This is Verilog code):</p>\n\n<pre><code>if (cpu_select &amp;&amp; cpu_write)\n  case (cpu_address[4:2])\n  3'h0 : lcd_reg &lt;= cpu_wdata[7:0]; // Direct write\n  3'h1 : lcd_reg &lt;= lcd_reg  |  cpu_wdata[7:0]; // set bit(s) write\n  3'h2 : lcd_reg &lt;= lcd_reg  &amp; ~cpu_wdata[7:0]; // Clear bit(s) write\n  ....\n  endcase\n</code></pre>\n\n<hr>\n\n<p>You asked for setting more bits.<br>\nA basic approach is to clear all the bits you want to change, then set them again with the desired values.</p>\n\n<p>For example: You have a 4 bit value (bits 4,5,6,7) a R/W bit (2) plus an address bit (0). You turn those into a mask: 0b11110101.</p>\n\n<pre><code>   // Write to LCD\n   data  = *reg_address;\n   data &amp;= ~0xF5; // Clear all the bits\n   if (address==1)\n     data |= (data_nibble&lt;&lt;4) | (1&lt;&lt;LCD_WRT_BIT_POS)  |(1&lt;&lt;LCD_ADR_BIT_POS) ; \n   else // Address 0 \n     data |= (data_nibble&lt;&lt;4) | (1&lt;&lt;LCD_WRT_BIT_POS); \n   *reg_address = data;\n</code></pre>\n\n<p>But....<br>\nIn your case you probably only need to control the 'E' signal separately. And you know that it should start low.The whole procedure becomes simpler:</p>\n\n<pre><code>   uint32_t data;\n\n   // Set the data, R/Wnot and RS all at the same time \n   if (write_data)\n      data = nibble_data&lt;&lt;4; // R/Wn=0, RS=0. E=0\n   else // Write command \n      data = nibble_data&lt;&lt;4 | (1&lt;&lt;RS_BIT_POS); // R/Wn=0, RS=1, E=0\n   *reg_address = data;\n\n   // Pulse E high and low:\n   *reg_address = data | (1&lt;&lt;E_BIT_POS); // E high\n   some_kind_of_wait_routine(); // Wait a while\n\n   *reg_address = data; // E low \n   some_kind_of_wait_routine();  // Wait a while to guarantee minimum low time!\n</code></pre>\n\n<p>For a read you do not need to set the data but you must set the Read line high. However the LCD display can be operated without reading.</p>\n"}], "owner": {"reputation": 11, "user_id": 9657727, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9e284181f2c852f470e3306b937d73d?s=128&d=identicon&r=PG&f=1", "display_name": "Arnold Hucks", "link": "https://stackoverflow.com/users/9657727/arnold-hucks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 179, "favorite_count": 0, "accepted_answer_id": 50948843, "answer_count": 2, "score": 0, "last_activity_date": 1535383744, "creation_date": 1529498522, "last_edit_date": 1535383744, "question_id": 50948549, "link": "https://stackoverflow.com/questions/50948549/how-to-control-a-single-bit-within-a-variable", "title": "How to control a single bit within a variable?", "body": "<p>I'm working on an LCD controller in a Microblaze soft CPU I've embedded in an FPGA. To connect to the top level Verilog file's outputs, I've used a single 8bit GPO.</p>\n\n<p>In my C, I've used placeholder variables for each bit I'm controlling, for example:</p>\n\n<pre><code>LcdDataBus = (cmd &amp; 0xF0);  //Send higher nibble\nLCD_RS = 0;\nLCD_RW = 0;\nLCD_EN = 1;\n</code></pre>\n\n<p>If I were programming a PIC, I could simply define each as a pin on the uC, i.e. <code>#define LCD_RS PORTA,0</code>.</p>\n\n<p>However, I believe I can only access the port through a function</p>\n\n<pre><code>data = XIOModule_Initialize(&amp;gpo, XPAR_IOMODULE_0_DEVICE_ID);\ndata = XIOModule_Start(&amp;gpo);\n</code></pre>\n\n<p>Where <code>data</code> is some variable.</p>\n\n<p>Is there a way I could <code>#define</code> a single bit in <code>data</code>, so LCD_RS = bit0, LCD_RW = bit1, LCD_E = bit3, and my LCD data bus could be the next four bits?</p>\n"}, {"tags": ["c", "eclipse", "eclipse-cdt"], "comments": [{"owner": {"reputation": 75, "user_id": 8537000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8f13709e5a1e7789a017cd1dff1e0c3?s=128&d=identicon&r=PG&f=1", "display_name": "Mai", "link": "https://stackoverflow.com/users/8537000/mai"}, "reply_to_user": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 0, "creation_date": 1529497747, "post_id": 50948249, "comment_id": 88894036, "body": "multiple definition of main"}, {"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 0, "creation_date": 1529497787, "post_id": 50948249, "comment_id": 88894061, "body": "The error means exactly what it says. Look at <code>test.c</code> and <code>HelloWorld.c</code>. Do they both have a <code>main</code>? If so, that&#39;s wrong since you&#39;re linking them together. You can only have one <code>main</code>. Actually you can only have one of anything that is global. Why are you linking <code>test</code> with <code>HelloWorld</code>? Does one depend upon the other?"}, {"owner": {"reputation": 75, "user_id": 8537000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8f13709e5a1e7789a017cd1dff1e0c3?s=128&d=identicon&r=PG&f=1", "display_name": "Mai", "link": "https://stackoverflow.com/users/8537000/mai"}, "reply_to_user": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 0, "creation_date": 1529497916, "post_id": 50948249, "comment_id": 88894151, "body": "Thank you@lurker"}], "answers": [{"comments": [{"owner": {"reputation": 75, "user_id": 8537000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8f13709e5a1e7789a017cd1dff1e0c3?s=128&d=identicon&r=PG&f=1", "display_name": "Mai", "link": "https://stackoverflow.com/users/8537000/mai"}, "edited": false, "score": 1, "creation_date": 1529497889, "post_id": 50948310, "comment_id": 88894129, "body": "Thank you, I forgot to the previous c source file!"}], "tags": [], "owner": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "is_accepted": true, "score": 1, "last_activity_date": 1529497772, "creation_date": 1529497772, "answer_id": 50948310, "question_id": 50948249, "link": "https://stackoverflow.com/questions/50948249/c-multiple-definition-main-kr-eclipse/50948310#50948310", "title": "C - multiple definition main() K&amp;R eclipse", "body": "<p>You have created two main source files in a single Eclipse project. When these are built, the two main() functions conflict. To resolves this, create seperate empty projects for each set of code you want to build.</p>\n"}], "owner": {"reputation": 75, "user_id": 8537000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8f13709e5a1e7789a017cd1dff1e0c3?s=128&d=identicon&r=PG&f=1", "display_name": "Mai", "link": "https://stackoverflow.com/users/8537000/mai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 223, "favorite_count": 0, "accepted_answer_id": 50948310, "answer_count": 1, "score": -1, "last_activity_date": 1588171973, "creation_date": 1529497602, "last_edit_date": 1592644375, "question_id": 50948249, "link": "https://stackoverflow.com/questions/50948249/c-multiple-definition-main-kr-eclipse", "title": "C - multiple definition main() K&amp;R eclipse", "body": "<p><em><strong>C Programming Language 2nd</strong></em> Page 43 example code</p>\n<pre><code>#include &lt;stdio.h&gt;\n#define MAXLINE 1000\n\nint get_line (char line[], int maxline);\nvoid copy (char to[], char from[]);\n\nint main()\n{\n    int len;\n    int max;\n    char line[MAXLINE];\n    char longest[MAXLINE];\n\n    max = 0;\n    while ((len = get_line(line, MAXLINE)) &gt; 0)\n        if (len &gt; max)\n        {\n            max = len;\n            copy (longest, line);\n        }\n   if (max &gt; 0)\n        printf(&quot;%s&quot;, longest);\n   return 0;\n}\n\nint get_line (char s[], int lim)\n{\n    int c, i;\n\n    for (i = 0; i &lt; lim-1 &amp;&amp; (c = getchar()) != EOF &amp;&amp; c != '\\n'; ++i)\n    {\n        s[i] = c;\n    }\n    if (c == '\\n')\n    {\n        s[i] = c;\n        ++i;\n    }\n    s[i] = '\\0';\n    return i;\n }\n \nvoid copy (char to[], char from[])\n{\n    int i;\n\n    i = 0;\n    while ((to[i] = from[i]) != '\\0')\n        ++i;\n}\n</code></pre>\n<p>and <kbd>Ctrl</kbd> + <kbd>B</kbd></p>\n<blockquote>\n<p>Info: Internal Builder is used for build</p>\n<p>gcc -o HelloWorld.exe &quot;src\\HelloWorld.o&quot; &quot;src\\test.o&quot;</p>\n<p>src\\test.o: In function `main':</p>\n<p>C:\\Users\\Administrator\\eclipse-workspace\\HelloWorld\\Debug/../src/test.c:15: multiple definition of `main'</p>\n<p>src\\HelloWorld.o:C:\\Users\\Administrator\\eclipse-workspace\\HelloWorld\\Debug/../src/HelloWorld.c:14: first defined here</p>\n<p>collect2.exe: error: ld returned 1 exit status</p>\n</blockquote>\n<p><em><strong>multiple definition of main</strong></em></p>\n"}, {"tags": ["c", "arrays", "file", "struct", "binary"], "comments": [{"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 4, "creation_date": 1529495520, "post_id": 50947511, "comment_id": 88892449, "body": "Wont work: <code>sizeof(data[i]),</code>  will be <code>sizeof(void *),</code> , which is constant , and doesn&#39;t depend on the actual array.Also, it makes no sense to write pointer values to disk, they have no meaning outside your running program."}, {"owner": {"reputation": 355, "user_id": 9515951, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-m53-xNkMviQ/AAAAAAAAAAI/AAAAAAAAAW0/rfDtMQwohLs/photo.jpg?sz=128", "display_name": "Umaiki", "link": "https://stackoverflow.com/users/9515951/umaiki"}, "edited": false, "score": 0, "creation_date": 1529495551, "post_id": 50947511, "comment_id": 88892471, "body": "You should add an enumeration to your <code>save</code> function to distinguish a <code>user</code> from a <code>guest</code>. Like: <code>void save(void *data, char *filename, int size, int user_type);</code>. And then cast the <code>data</code> pointer with the correct structure."}, {"owner": {"reputation": 355, "user_id": 9515951, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-m53-xNkMviQ/AAAAAAAAAAI/AAAAAAAAAW0/rfDtMQwohLs/photo.jpg?sz=128", "display_name": "Umaiki", "link": "https://stackoverflow.com/users/9515951/umaiki"}, "edited": false, "score": 0, "creation_date": 1529498176, "post_id": 50947511, "comment_id": 88894326, "body": "Well I need to rework on that. You have to know the size of any fields of your structure in order to have a consistent <code>sizeof</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1529539902, "post_id": 50947511, "comment_id": 88914644, "body": "regarding: <code>fwrite(&amp;data[i], sizeof(data[i]), 1, file);</code>  the only &#39;size&#39; that the compiler knows is the size of a pointer (say 4 or 8 bytes)  The compiler knows NOTHING about the size of the target of a <code>void*</code>"}], "answers": [{"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1529500662, "post_id": 50948507, "comment_id": 88895916, "body": "If you have to use legacy C and can&#39;t use _Generic, then the union version is the second best option. There&#39;s the &quot;common initial sequence rule&quot;, found in a dark, forgotten corner of the C standard (6.5.2.3/6), which allows us to do things like <code>user u; ... guest* gptr = (guest*)&amp;u; &#47;* use gptr *&#47;</code>, which is actually well-defined and portable."}], "tags": [], "owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "is_accepted": false, "score": 1, "last_activity_date": 1529522856, "last_edit_date": 1529522856, "creation_date": 1529498366, "answer_id": 50948507, "question_id": 50947511, "link": "https://stackoverflow.com/questions/50947511/how-to-pass-multiple-array-of-struct-to-a-single-function-in-c/50948507#50948507", "title": "How to pass multiple array of struct to a single function in C", "body": "<p>The short answer to your question: <em>I have 2 different array of structs (user and guest) and I'd like to know how pass them to a single function.</em>: Combine them while including a <code>union</code> and an <code>enum</code> in that combined definition...</p>\n\n<p>A few related architectural suggestions:</p>\n\n<ul>\n<li>1st, eliminate the pointer members in your structs and replace them\nwith 'large enough' arrays. (This will greatly simplify the memory allocations and corresponding calls to <code>free()</code> ).</li>\n<li>2nd, create a single combined struct, eg. VISITORS, containing all\nthe others.</li>\n<li>3rd, use an <code>enum</code> to distinguish between type of record to\ncreate/store/use the data etc.</li>\n<li>4th, use a union to contain 2 types of visitors.  </li>\n</ul>\n\n<p>In this way, you can pass a single <code>struct</code> argument in your functions.  </p>\n\n<pre><code>#define MAX_VISITOR 20\n\ntypedef struct {\n    int day;\n    int month;\n    int year;\n} date;\n\ntypedef enum {\n    USER,\n    GUEST\n} TYPE;\n\ntypedef struct {\n    short id;\n    char name[30];  //no pointers here, just create 'large enough' arrays\n    char surname[30];  \n    char email[30];\n    char password[30];\n    date birthday;\n} user;\n\ntypedef struct {\n    short id;        \n    char name[30];\n    char surname[30];\n    char email[30];\n} guest;\n\ntypedef struct {\n    date d;       //date\n    TYPE t;       //either USER or GUEST\n    union   {     //(only one member will be populated per instance of VISITOR)\n        user u;   //6 elements\n        guest g;  //4 elements \n    };\n} VISITOR;\n\nvoid StoreVisitors(VISITOR *v); //these prototypes will accept a single argument containing single struct. \nvoid UpdateVisitors(VISITORS **v);\n\nint main(void)\n{\n    VISITOR *pV = calloc(MAX_VISITOR, sizeof(*pV)); //20 instances of VISITOR\n    if(pV)\n    {\n        UpdateVisitors(&amp;pV);\n        StoreVisitors(pV);\n    }\n    free(pV);\n\n\n    return 0;\n}\n\nvoid StoreVisitors(VISITOR *p)\n{\n    // Write the information in p to the data file      \n}\n\nvoid UpdateVisitors(VISITOR **v)\n{\n    // Read records from existing visitor files\n    // and update array of struct VISITOR with data     \n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 51, "user_id": 2572065, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c3b0337d83b2795197b5c579098c442e?s=128&d=identicon&r=PG", "display_name": "JohnnyKing94", "link": "https://stackoverflow.com/users/2572065/johnnyking94"}, "edited": false, "score": 0, "creation_date": 1529513212, "post_id": 50949042, "comment_id": 88904205, "body": "@Lundin am i wrong or in this way you have to declare and write twice the function (guest_save &amp; user_save)? I was trying to avoid that, finding something more clean and elegant... but thanks anyway"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 51, "user_id": 2572065, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c3b0337d83b2795197b5c579098c442e?s=128&d=identicon&r=PG", "display_name": "JohnnyKing94", "link": "https://stackoverflow.com/users/2572065/johnnyking94"}, "edited": false, "score": 0, "creation_date": 1529569413, "post_id": 50949042, "comment_id": 88924080, "body": "@JohnnyKing94 Not really, you could let those two functions be wrappers around the file I/O. Something along the lines of <code>void guest_save (size_t size, guest array[size], const char* filename) { file_write (filename, array, size, sizeof(guest); ...</code> where <code>file_write</code> doesn&#39;t concern itself with the types used, only their sizes. With that design you separate the struct type-specific behavior from file I/O."}], "tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 2, "last_activity_date": 1529500149, "creation_date": 1529500149, "answer_id": 50949042, "question_id": 50947511, "link": "https://stackoverflow.com/questions/50947511/how-to-pass-multiple-array-of-struct-to-a-single-function-in-c/50949042#50949042", "title": "How to pass multiple array of struct to a single function in C", "body": "<p>The problem is <code>sizeof(data[i])</code> which is nonsense, it gives you a void pointer size.</p>\n\n<p>With modern standard C programming (C11) you can do like this:</p>\n\n<pre><code>void guest_save (size_t size, guest array[size], const char* filename);\n\nvoid user_save (size_t size, user array[size], const char* filename);\n\n#define save(size, array, filename) \\\n  _Generic((array),                 \\\n           guest*: guest_save,      \\\n           user*:  user_save)(size, array, filename)\n</code></pre>\n\n<p>With this method you won't have to use dangerous void pointers. And you can now easily take <code>sizeof array[i]</code> etc.</p>\n"}], "owner": {"reputation": 51, "user_id": 2572065, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c3b0337d83b2795197b5c579098c442e?s=128&d=identicon&r=PG", "display_name": "JohnnyKing94", "link": "https://stackoverflow.com/users/2572065/johnnyking94"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 358, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1529522856, "creation_date": 1529495226, "question_id": 50947511, "link": "https://stackoverflow.com/questions/50947511/how-to-pass-multiple-array-of-struct-to-a-single-function-in-c", "title": "How to pass multiple array of struct to a single function in C", "body": "<p>I have 2 different array of structs (user and guest) and I'd like to know how pass them to a single function. For example I have these structs</p>\n\n<pre><code>typedef struct {\n    int day;\n    int month;\n    int year;\n} date;\n\ntypedef struct {\n    short id;\n    char *name;\n    char *surname;\n    char *email;\n    char *password;\n    date birthday;\n} user;\n\ntypedef struct {\n    short id;\n    char *name;\n    char *surname;\n    char *email;\n} guest;\n</code></pre>\n\n<p>and I want to save the data in a binary file using the same function. But despite I tried to inform myself how to pass multiple structs to a single function, I'm having problem on <em>how to pass <strong>multiple array of structs</strong> to a single function</em>. Here's what I tried to achieve so far. The file is generated but it's incomplete. The writing procedure stops at a specific data for both of the structs.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#define MAX_USER 20\n#define MAX_GUEST 20\n\nuser record_user[MAX_USER] = {\n{ 1     , \"Name 1\"          , \"Surname 1\"           , \"name1.surname1@email.com\"            , \"S\\\\(6`].}\"   ,{ 9    , 3     , 1994 }    ,{ 10   , 3     , 2010 } },\n{ 2     , \"Name 2\"          , \"Surname 2\"           , \"name2.surname2@email.com\"            , \"O!5[0R9P\"    ,{ 29   , 8     , 1977 }    ,{ 18   , 1     , 2009 } },\n{ 3     , \"Name 3\"          , \"Surname 3\"           , \"name3.surname3@email.com\"            , \"j+$\\\"XrLw\"   ,{ 15   , 9     , 1971 }    ,{ 14   , 3     , 2013 } },\n{ 4     , \"Name 4\"          , \"Surname 4\"           , \"name4.surname4@email.com\"            , \"\\\"n^{:&amp;}(\"   ,{ 15   , 7     , 1980 }    ,{ 11   , 6     , 2011 } },\n{ 5     , \"Name 5\"          , \"Surname 5\"           , \"name5.surname5@email.com\"            , \"JHKv%Kgg\"    ,{ 15   , 4     , 1975 }    ,{ 19   , 8     , 2011 } },\n{ 6     , \"Name 6\"          , \"Surname 6\"           , \"name6.surname6@email.com\"            , \"o_bsggpN\"    ,{ 28   , 5     , 1989 }    ,{ 18   , 9     , 2009 } },\n/* it keeps going */\n};\n\nguest record_guest[MAX_GUEST] = {\n{ 1     , \"Name 1\"          , \"Surname 1\"           , \"name1.surname1@email.com\" },\n{ 2     , \"Name 2\"          , \"Surname 2\"           , \"name2.surname2@email.com\" },\n{ 3     , \"Name 3\"          , \"Surname 3\"           , \"name3.surname3@email.com\" },\n{ 4     , \"Name 4\"          , \"Surname 4\"           , \"name4.surname4@email.com\" },\n{ 5     , \"Name 5\"          , \"Surname 5\"           , \"name5.surname5@email.com\" },\n{ 6     , \"Name 6\"          , \"Surname 6\"           , \"name6.surname6@email.com\" },\n/* it keeps going */\n};\n\n\n    int main() {\n        /* some prev code */\n        save(record_user, \"user.dat\", MAX_USER);\n        /* some middle code */\n        save(record_guest, \"guest.dat\", MAX_GUEST);\n        /* some after code */\n        return 0;\n    }\n\n    void save(void *data[], char *filename, int size) {\n        FILE *file;\n        file = fopen(filename, \"rb+\");\n\n        // If the file is missing, it is created\n        if (file == NULL) {\n            file = fopen(filename, \"wb\");\n        }\n\n        for (int i = 0; i &lt; size; i++) {\n            fwrite(&amp;data[i], sizeof(data[i]), 1, file);\n        }\n\n        fclose(file);\n    };\n</code></pre>\n"}, {"tags": ["c", "string", "concatenation"], "comments": [{"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 1, "creation_date": 1529495082, "post_id": 50947429, "comment_id": 88892128, "body": "so it&#39;s basically an eclipse IDE questions? most IDEs have a great trouble parsing C/C++ code on the fly, one of the reasons being the macros"}, {"owner": {"reputation": 10050, "user_id": 3512538, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/6Om7A.png?s=128&g=1", "display_name": "CIsForCookies", "link": "https://stackoverflow.com/users/3512538/cisforcookies"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1529495133, "post_id": 50947429, "comment_id": 88892167, "body": "@Jean-Fran&#231;oisFabre it is not an IDE question. It is a C question raised by seeing an IDE problem that might stem from an actual problem"}, {"owner": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 0, "creation_date": 1529495237, "post_id": 50947429, "comment_id": 88892240, "body": "Did you include the header file in the c file?"}, {"owner": {"reputation": 10050, "user_id": 3512538, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/6Om7A.png?s=128&g=1", "display_name": "CIsForCookies", "link": "https://stackoverflow.com/users/3512538/cisforcookies"}, "reply_to_user": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 0, "creation_date": 1529495286, "post_id": 50947429, "comment_id": 88892271, "body": "@mch Obviously :-)"}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 5, "creation_date": 1529495669, "post_id": 50947429, "comment_id": 88892547, "body": "I do believe it&#39;s an IDE problem. It&#39;s perfectly valid C code. Anecdotal, but I was never able to run Eclipse&#39;s indexer to the point nothing is underlined red."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 1, "creation_date": 1529495738, "post_id": 50947429, "comment_id": 88892594, "body": "I&#39;d recommend GNAT Programming Studio, which has a nice C mode (based on clang) which works... it also uses projects and doesn&#39;t have workspaces. Eclipse sucks so much... Code::Blocks isn&#39;t better."}, {"owner": {"reputation": 10050, "user_id": 3512538, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/6Om7A.png?s=128&g=1", "display_name": "CIsForCookies", "link": "https://stackoverflow.com/users/3512538/cisforcookies"}, "edited": false, "score": 0, "creation_date": 1529495802, "post_id": 50947429, "comment_id": 88892653, "body": "OK, thanks guys! should I delete, close or leave the question as it is?"}], "answers": [{"tags": [], "owner": {"reputation": 136, "user_id": 9920986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IpNEc.jpg?s=128&g=1", "display_name": "tstn3357", "link": "https://stackoverflow.com/users/9920986/tstn3357"}, "is_accepted": false, "score": 1, "last_activity_date": 1529497593, "last_edit_date": 1529497593, "creation_date": 1529496985, "answer_id": 50948040, "question_id": 50947429, "link": "https://stackoverflow.com/questions/50947429/concatenating-nested-strings-using-macros/50948040#50948040", "title": "concatenating nested strings using macros", "body": "<p>I tried to run your code (<code>header.h</code> and <code>c.c</code>) on the Eclipse, it outputted <code>hello world!</code> successfully.<br>\nMy execution environment is as follows.</p>\n\n<ul>\n<li>OS:  macOS 10.13.5</li>\n<li>IDE: Eclipse IDE for C/C++ Developers, Oxygen.1a Release (4.7.1a), Build id 20171005-1200</li>\n<li>Compiler(tool chain): Linux GCC</li>\n</ul>\n\n<p>Your code is probably correct.<br>\nIf you are running Eclipse with default settings, it seems that there is a problem with eclipse as you said.</p>\n\n<hr>\n"}], "owner": {"reputation": 10050, "user_id": 3512538, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/6Om7A.png?s=128&g=1", "display_name": "CIsForCookies", "link": "https://stackoverflow.com/users/3512538/cisforcookies"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1529497593, "creation_date": 1529494954, "last_edit_date": 1529496492, "question_id": 50947429, "link": "https://stackoverflow.com/questions/50947429/concatenating-nested-strings-using-macros", "title": "concatenating nested strings using macros", "body": "<p>Is there a problem doing something like this</p>\n\n<pre><code>#define A \"world\"\n#define B \"hello \"A  // or adding a whitespace --&gt; #define B \"hello \" A\n</code></pre>\n\n<p>and then using the <code>B</code> in <code>printf(B\"!\");</code> (added another concatenation...)?</p>\n\n<p><strong><em>BTW</strong>, using  <code>#define B \"hello \"A</code> without white-space is OK in C, but less so in C++11 - \"invalid suffix on literal; C++11 requires a space between literal and identifier [-Wliteral-suffix]\"</em></p>\n\n<p>By what I know, this should be OK, since the compiler concatenates the strings (as said <a href=\"https://stackoverflow.com/a/5256426/3512538\">here</a>), but when writing this on eclipse, with the <code>#define</code>'s in one header file, and the <code>printf</code> in another, I get no errors, but the eclipse can't seem to recognize the <code>define</code>'s</p>\n\n<p><em>I know eclipse is evil, but is there a C problem in this (including misuse of language features, if this is one)?</em></p>\n\n<hr>\n\n<p><strong>header.h</strong></p>\n\n<pre><code>#define A \"world\"\n#define B \"hello \"A \n</code></pre>\n\n<p><strong>c.c</strong></p>\n\n<pre><code>#include \"header.h\"\n#include &lt;stdio.h&gt;\nint main(){\n   printf(\"%s\", B\"!\");\n   return 0;\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1529494983, "post_id": 50947400, "comment_id": 88892060, "body": "Do you know what operators like <code>~</code> and <code>++</code> do?"}, {"owner": {"reputation": 45, "user_id": 9824556, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46128f962296cf3fd09ed14081363e59?s=128&d=identicon&r=PG&f=1", "display_name": "Marco ", "link": "https://stackoverflow.com/users/9824556/marco"}, "reply_to_user": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1529495101, "post_id": 50947400, "comment_id": 88892149, "body": "@SteveSummit Yes I do. How does the 1st expression work tho? X = -2 != -3?? I can&#39;t understand"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1529495163, "post_id": 50947400, "comment_id": 88892190, "body": "@Marco It&#39;s time for you to dig out your operator precedence tables."}, {"owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 1, "creation_date": 1529495210, "post_id": 50947400, "comment_id": 88892221, "body": "know your <a href=\"http://en.cppreference.com/w/c/language/operator_precedence\" rel=\"nofollow noreferrer\">operator precedence</a>"}, {"owner": {"reputation": 85822, "user_id": 597607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jCzJi.png?s=128&g=1", "display_name": "Bo Persson", "link": "https://stackoverflow.com/users/597607/bo-persson"}, "edited": false, "score": 2, "creation_date": 1529495883, "post_id": 50947400, "comment_id": 88892704, "body": "Specifically note that <code>A = (~C) - A--</code> is not valid code (trying to change <code>A</code> twice), so we cannot expect any specific result."}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1529495915, "post_id": 50947400, "comment_id": 88892727, "body": "In the first section of the ternary, it is TRUE that <code>B != C</code>, so <code>X</code> evaluates to 1, meaning execution flows to the the <i>true</i> section of the ternary.  But this results in executing code that doesn&#39;t make sense."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1529499833, "post_id": 50947400, "comment_id": 88895355, "body": "The only good, rather than required, answer is to not use such compound expressions and instead, split them up and use temporary boolean vars to hold the intermediate results.  If you look at an expression for more than ten seconds and cannot understand how it works and/or how to debug it, split it up."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 2, "creation_date": 1529501243, "post_id": 50947400, "comment_id": 88896289, "body": "Good luck with your exam.  If this question is representative of the ones you&#39;re likely to see on it, you&#39;re going to <i>need</i> some luck.  (This may be one of those times where you have a choice between passing your exam, or learning C, because whatever it is that the exam is testing, it has little to do with actually knowing C well. Certainly the expression in this question has very little to do with knowing C well.)"}], "answers": [{"tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": true, "score": 3, "last_activity_date": 1529496915, "creation_date": 1529496915, "answer_id": 50948016, "question_id": 50947400, "link": "https://stackoverflow.com/questions/50947400/conditional-expression/50948016#50948016", "title": "Conditional expression", "body": "<p>The behaviour of the program is undefined.</p>\n\n<p><code>(X = B != C)</code> is grouped as <code>(X = (B != C))</code> and is 1 since <code>B</code> is not equal to <code>C</code>.</p>\n\n<p>A <em>sequencing point</em> is passed over (not relevant here but you can be confident that <code>X</code> is 1 when one of the ternary branches are evaluated), and the \"true\" branch of the ternary conditional is evaluated. But the behaviour of the expression <code>(A = (~C) - A--)</code> is <em>undefined</em>. And that puts the whole program into an undefined state including, somewhat bizarrely, any statements that have already ran.</p>\n"}], "owner": {"reputation": 45, "user_id": 9824556, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46128f962296cf3fd09ed14081363e59?s=128&d=identicon&r=PG&f=1", "display_name": "Marco ", "link": "https://stackoverflow.com/users/9824556/marco"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "closed_date": 1529499588, "accepted_answer_id": 50948016, "answer_count": 1, "score": -4, "last_activity_date": 1529496915, "creation_date": 1529494873, "question_id": 50947400, "link": "https://stackoverflow.com/questions/50947400/conditional-expression", "closed_reason": "Duplicate", "title": "Conditional expression", "body": "<p>so I'm studying for my exam and I do not understand how can I solve this conditional expression. I know that if the expression 1 is true, I do the expression 2, and if it is false, I do the expression 3. Can someone help me understanding what I need to do in the first expression?</p>\n\n<pre><code>int A = -1, B = -2, C = -3;\nint X = 1;\n(X = B != C) ? (A = (~C) - A--) : (++C + (~A));\nprintf(\" A = %d  B = %d  C = %d  X = %d\\n\", A, B, C, X);\n</code></pre>\n"}, {"tags": ["c++", "c", "unit-testing"], "comments": [{"owner": {"reputation": 85822, "user_id": 597607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jCzJi.png?s=128&g=1", "display_name": "Bo Persson", "link": "https://stackoverflow.com/users/597607/bo-persson"}, "edited": false, "score": 0, "creation_date": 1529496036, "post_id": 50947358, "comment_id": 88892816, "body": "Sorry, didn&#39;t notice it was you in the other question as well, just that it seemed to ask the same thing. Reopening here."}, {"owner": {"reputation": 3805, "user_id": 4165552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18b32c5e142791fca01cbf252f663ac?s=128&d=identicon&r=PG&f=1", "display_name": "pptaszni", "link": "https://stackoverflow.com/users/4165552/pptaszni"}, "edited": false, "score": 1, "creation_date": 1529497616, "post_id": 50947358, "comment_id": 88893948, "body": "You should never include <code>*.c</code> or <code>*.cpp</code> files, no matter what. If you use some variables/functions/classes in multiple translation units, you should declare them first in a header."}, {"owner": {"reputation": 3805, "user_id": 4165552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18b32c5e142791fca01cbf252f663ac?s=128&d=identicon&r=PG&f=1", "display_name": "pptaszni", "link": "https://stackoverflow.com/users/4165552/pptaszni"}, "edited": false, "score": 0, "creation_date": 1529498315, "post_id": 50947358, "comment_id": 88894431, "body": "@YoungDevelopers, please edit your question to include some sample code that you wish to test and I will explain how to test it. I don&#39;t want to write an answer which will probably be unclear to you."}, {"owner": {"reputation": 1015, "user_id": 5688187, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-8yTdoOskIOk/AAAAAAAAAAI/AAAAAAAAAAA/YTYc19Rnn9Y/photo.jpg?sz=128", "display_name": "Martin V&#233;ronneau", "link": "https://stackoverflow.com/users/5688187/martin-v%c3%a9ronneau"}, "reply_to_user": {"reputation": 3805, "user_id": 4165552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18b32c5e142791fca01cbf252f663ac?s=128&d=identicon&r=PG&f=1", "display_name": "pptaszni", "link": "https://stackoverflow.com/users/4165552/pptaszni"}, "edited": false, "score": 0, "creation_date": 1529499617, "post_id": 50947358, "comment_id": 88895213, "body": "You ask how you can test functions un multiple .cpp files? Why not simply compile your .c file, and include the .h in your .cpp files? Note that if you&#39;re testing c code in c++, there are other issues to consider, but I agree with @Ptaq666 that you should never include a .c or .cpp file."}], "answers": [{"comments": [{"owner": {"reputation": 1015, "user_id": 5688187, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-8yTdoOskIOk/AAAAAAAAAAI/AAAAAAAAAAA/YTYc19Rnn9Y/photo.jpg?sz=128", "display_name": "Martin V&#233;ronneau", "link": "https://stackoverflow.com/users/5688187/martin-v%c3%a9ronneau"}, "reply_to_user": {"reputation": 31, "user_id": 9915550, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-PjRjp0-OJUY/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq2HOtSf3NdwVVvL6xXv09qLrNI3Jg/mo/photo.jpg?sz=128", "display_name": "Young Developers", "link": "https://stackoverflow.com/users/9915550/young-developers"}, "edited": false, "score": 0, "creation_date": 1529502731, "post_id": 50949088, "comment_id": 88897381, "body": "Just compile the C files, exactly as you&#39;re doing your CPP files."}, {"owner": {"reputation": 1015, "user_id": 5688187, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-8yTdoOskIOk/AAAAAAAAAAI/AAAAAAAAAAA/YTYc19Rnn9Y/photo.jpg?sz=128", "display_name": "Martin V&#233;ronneau", "link": "https://stackoverflow.com/users/5688187/martin-v%c3%a9ronneau"}, "reply_to_user": {"reputation": 31, "user_id": 9915550, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-PjRjp0-OJUY/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq2HOtSf3NdwVVvL6xXv09qLrNI3Jg/mo/photo.jpg?sz=128", "display_name": "Young Developers", "link": "https://stackoverflow.com/users/9915550/young-developers"}, "edited": false, "score": 0, "creation_date": 1529503137, "post_id": 50949088, "comment_id": 88897659, "body": "Okay, I haven&#39;t realized this yet, but are you trying to test static functions?"}, {"owner": {"reputation": 31, "user_id": 9915550, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-PjRjp0-OJUY/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq2HOtSf3NdwVVvL6xXv09qLrNI3Jg/mo/photo.jpg?sz=128", "display_name": "Young Developers", "link": "https://stackoverflow.com/users/9915550/young-developers"}, "edited": false, "score": 0, "creation_date": 1529503620, "post_id": 50949088, "comment_id": 88897951, "body": "Yes, I change your code make behave almost like my code without static function and variables. Try fix that first without changes .h and .c files"}, {"owner": {"reputation": 1015, "user_id": 5688187, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-8yTdoOskIOk/AAAAAAAAAAI/AAAAAAAAAAA/YTYc19Rnn9Y/photo.jpg?sz=128", "display_name": "Martin V&#233;ronneau", "link": "https://stackoverflow.com/users/5688187/martin-v%c3%a9ronneau"}, "reply_to_user": {"reputation": 31, "user_id": 9915550, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-PjRjp0-OJUY/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq2HOtSf3NdwVVvL6xXv09qLrNI3Jg/mo/photo.jpg?sz=128", "display_name": "Young Developers", "link": "https://stackoverflow.com/users/9915550/young-developers"}, "edited": false, "score": 0, "creation_date": 1529506031, "post_id": 50949088, "comment_id": 88899665, "body": "You can&#39;t include a file containing at least one non-static function in multiple units and compile them together. That just won&#39;t work. I&#39;m editing my post to explain that more in details."}, {"owner": {"reputation": 3805, "user_id": 4165552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18b32c5e142791fca01cbf252f663ac?s=128&d=identicon&r=PG&f=1", "display_name": "pptaszni", "link": "https://stackoverflow.com/users/4165552/pptaszni"}, "reply_to_user": {"reputation": 31, "user_id": 9915550, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-PjRjp0-OJUY/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq2HOtSf3NdwVVvL6xXv09qLrNI3Jg/mo/photo.jpg?sz=128", "display_name": "Young Developers", "link": "https://stackoverflow.com/users/9915550/young-developers"}, "edited": false, "score": 1, "creation_date": 1529582214, "post_id": 50949088, "comment_id": 88932190, "body": "@YoungDevelopers, now your question is more clear. The purpose of testing is to test the public functions only (in C language - non static) (you want to test the functionality, not the way it is implemented). All solutions allowing you to test private (static) function are just some ugly hacks."}, {"owner": {"reputation": 1015, "user_id": 5688187, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-8yTdoOskIOk/AAAAAAAAAAI/AAAAAAAAAAA/YTYc19Rnn9Y/photo.jpg?sz=128", "display_name": "Martin V&#233;ronneau", "link": "https://stackoverflow.com/users/5688187/martin-v%c3%a9ronneau"}, "edited": false, "score": 0, "creation_date": 1529589675, "post_id": 50949088, "comment_id": 88937201, "body": "The purpose of a static function or variable is literally to hide the function or variable away from a programmer. You hide it inside a translation unit so that others (units/programmers) can&#39;t mess with them and break the functionality of the unit. So, architecturally, testing internal and hidden functions is the responsability of the translation unit which hides these functions. Anything else is an ugly hack, and a ugly hack is by definition not easy to maintain."}, {"owner": {"reputation": 1015, "user_id": 5688187, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-8yTdoOskIOk/AAAAAAAAAAI/AAAAAAAAAAA/YTYc19Rnn9Y/photo.jpg?sz=128", "display_name": "Martin V&#233;ronneau", "link": "https://stackoverflow.com/users/5688187/martin-v%c3%a9ronneau"}, "edited": false, "score": 1, "creation_date": 1529672411, "post_id": 50949088, "comment_id": 88971553, "body": "So, I guess my third solution didn&#39;t help you?"}, {"owner": {"reputation": 31, "user_id": 9915550, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-PjRjp0-OJUY/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq2HOtSf3NdwVVvL6xXv09qLrNI3Jg/mo/photo.jpg?sz=128", "display_name": "Young Developers", "link": "https://stackoverflow.com/users/9915550/young-developers"}, "edited": false, "score": 0, "creation_date": 1530081548, "post_id": 50949088, "comment_id": 89102637, "body": "It solves the problem even if it get some extra code."}], "tags": [], "owner": {"reputation": 1015, "user_id": 5688187, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-8yTdoOskIOk/AAAAAAAAAAI/AAAAAAAAAAA/YTYc19Rnn9Y/photo.jpg?sz=128", "display_name": "Martin V&#233;ronneau", "link": "https://stackoverflow.com/users/5688187/martin-v%c3%a9ronneau"}, "is_accepted": true, "score": 1, "last_activity_date": 1529507441, "last_edit_date": 1529507441, "creation_date": 1529500271, "answer_id": 50949088, "question_id": 50947358, "link": "https://stackoverflow.com/questions/50947358/include-c-files-in-unit-test-project-and-get-access-to-it-from-multiple-cpp-fil/50949088#50949088", "title": "Include .c files in Unit test project and get access to it from multiple cpp files without linking problems", "body": "<p>You should never include a .C or .CPP file.</p>\n\n<p>However, you can compile C code in C++. Here's an example based on the information you gave in your initial post.</p>\n\n<p><strong>YourCCode.h</strong></p>\n\n<pre><code>#ifndef YourCCode_H\n#define YourCCode_H\n\nint FunctionToTest(int SomeParams);\n\nint TestStaticFunctions(int SomeParam1, int SomeParam2);\n\n#endif // YourCCode_H\n</code></pre>\n\n<p><strong>YourCCode.c</strong></p>\n\n<pre><code>#include \"YourCCode.h\"\n\nstatic int SomeStaticFunction(int Param1, int Param2)\n{\n  return Param1 + Param2; // that needs extensive testing, obviously.\n}\n\nint FunctionToTest(int SomeParams)\n{\n  return SomeStaticFunction(SomeParams, 1); \n}\n\nint TestStaticFunctions(int SomeParam1, int SomeParam2)\n{\n  return SomeStaticFunction(SomeParam1, SomeParam2);\n}\n</code></pre>\n\n<p><strong>UnitTest1.cpp</strong></p>\n\n<pre><code>extern \"C\" {\n#include \"YourCCode.h\"\n}\n\nbool TestFunction(int Value)\n{\n  return (FunctionToTest(Value) == Value+1);\n}\n</code></pre>\n\n<p><strong>UnitTest2.cpp</strong></p>\n\n<pre><code>extern \"C\" {\n#include \"YourCCode.h\"\n}\n\nvoid AnotherTestFunction(int Val, int Val2)\n{\n  int newValue = TestStaticFunctions(Val, Val2);\n  ASSERT(newValue == Val+Val2);\n}\n</code></pre>\n\n<p>Then compile your CPP and C file.</p>\n\n<hr>\n\n<p>After you clarified your intent, I realized you're trying to test static functions from another unit. Static function, by definition, are only available to other functions in the same translation unit. This is mostly use as a protection to prevent programmers to call some functions without knowing how to validate their inputs, know the call order, etc...</p>\n\n<p>My best bet here is either you choose that your functions are not static and you can test them from outside your translation unit, or you implement the test functions inside the translation unit containing those static functions. I would recommend the latter as a translation unit should know (architecturally speaking) how to test their own features.</p>\n\n<hr>\n\n<p>As a third solution, if you don't have any control over the content of the C file (but since you have that C file, I doubt it), you could have a proxy CPP file that includes the C file, and create a proxy call for each static call.</p>\n\n<p>That is a ugly hack, though, and could break very easily if the C file ever gets updated, so I'm advising against it.</p>\n\n<p>Here's a quick example :</p>\n\n<p><strong>YourCCode.h</strong></p>\n\n<pre><code>#ifndef YourCCode_H\n#define YourCCode_H\n\nvoid SomeFunction(void);\n\n#endif // YourCCode_H\n</code></pre>\n\n<p><strong>YourCCode.c</strong></p>\n\n<pre><code>#include \"YourCCode.h\"\n\nstatic int AddSomething(int Param1, int Param2)\n{\n  return Param1 + Param2;\n}\n\nstatic int SubtractSomething(int Param1, int Param2)\n{\n  return Param1 - Param2;\n}\n\nvoid SomeFunction(void)\n{\n  // code meant to be called externally.\n}\n</code></pre>\n\n<p><strong>ProxyTestCode.hpp</strong></p>\n\n<pre><code>bool TestAddSomething(void);\nbool TestSubtractSomething(void);\n</code></pre>\n\n<p><strong>ProxyTestCode.cpp</strong></p>\n\n<pre><code>extern \"C\" {\n#include \"YourCCode.h\"\n#include \"YourCCode.c\"\n}\n\nbool TestAddSomething(void)\n{\n  return (AddSomething(2,2) == 4);\n}\n\nbool TestSubtractSomething(void)\n{\n  return (AddSomething(2,2) == 0);\n}\n</code></pre>\n\n<p><strong>UnitTest1.cpp</strong></p>\n\n<pre><code>#include \"ProxyTestCode.hpp\"\n\nvoid TestAdd(void)\n{\n  ASSERT(TestAddSomething());\n}\n</code></pre>\n\n<p><strong>UnitTest2.cpp</strong></p>\n\n<pre><code>#include \"ProxyTestCode.hpp\"\n\nvoid TestSubtract(void)\n{\n  ASSERT(TestSubtractSomething());\n}\n</code></pre>\n\n<p>If you do that, <strong>don't</strong> compile your C file in your project.</p>\n"}], "owner": {"reputation": 31, "user_id": 9915550, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-PjRjp0-OJUY/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq2HOtSf3NdwVVvL6xXv09qLrNI3Jg/mo/photo.jpg?sz=128", "display_name": "Young Developers", "link": "https://stackoverflow.com/users/9915550/young-developers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1015, "favorite_count": 0, "accepted_answer_id": 50949088, "answer_count": 1, "score": -2, "last_activity_date": 1529507441, "creation_date": 1529494740, "last_edit_date": 1529502401, "question_id": 50947358, "link": "https://stackoverflow.com/questions/50947358/include-c-files-in-unit-test-project-and-get-access-to-it-from-multiple-cpp-fil", "title": "Include .c files in Unit test project and get access to it from multiple cpp files without linking problems", "body": "<p>I'm doing functional testing on c code. Have include .c file in test .cpp file so far, everything works well. But I need to include the same .c file in another .cpp file where I do other unit tests. Then I get problems that is already defined. Because I already include it in the first file cpp.</p>\n\n<p>If merge all the test methods into one cpp file then it works well. If keep all unit test in one file get to big handle so I need to split up diffrent files in same project it also create help functions for secure that functions get in capsules.</p>\n\n<p>This not a normal LNK2005 because I can not declare the variable and functions in .h: as extern BOOL MyBool; and then assign to it in a .c or .cpp file. Because need include c file as I do unit test this function. Also I can't or should avoid do any changes .c.</p>\n\n<p>I looking way to keep include of .c local not effect other files in same project.</p>\n\n<p>source.h</p>\n\n<pre><code>#ifndef SOURCE_H_\n#define SOURCE_H_\n\n#include \"../car.h\"\n\nenum INITIALMODE {\n   INITIALMODE_NOT_POSITIONING,             // 0\n   INITIALMODE_NO_DRIVER_INPUT,             // 1\n   INITIALMODE_POSITION_LOW_POSITION,       // 2\n   INITIALMODE_POSITION_STANDARD_POSITION,  // 3\n   INITIALMODE_POSITION_HIGH_POSITION       // 4\n};\nvoid initMotor(void);\n#endif\n</code></pre>\n\n<p>source.c</p>\n\n<pre><code>/* Compiler include files */\n#pragma once\n\n#include \"positioning.h\"\n#include \"api.h\"\n#include \"drive.h\"\n#include \"types.h\"\n\nstatic void updateTarget(void);\nstatic SWord getMax(UWord Limit, UWord Aux);\nstatic DWord getHeight(void);\nstatic Bool isMode(void);\nstatic Bool isExiting(void);\n\n#define cMaxHeight      100 * Profile.s.Max /* m -&gt; mm */\n\nvoid initMotor(void)\n{\n   // do something\n}\n\nstatic void updatePositioning(void)\n{\n   // do something\n}\n</code></pre>\n\n<p>Test files look like this, however, this is very scaled for making exemple small.</p>\n\n<p><strong>UnitTest.cpp</strong> and <strong>UnitTest2.cpp</strong></p>\n\n<pre><code>#include \"CppUnitTest.h\"\n\n#ifndef UNIT_TEST\n#define UNIT_TEST\n\nusing namespace Microsoft::VisualStudio::CppUnitTestFramework;\n\nnamespace Test\n{\n\n    extern \"C\" {\n     #include \"../../Test/source.h\"\n     #include \"../../Test/source.c\"\n    }\n\nTEST_CLASS(UnitTest_1)\n{\npublic:\n\n    TEST_METHOD(Test_1)\n    {\n        // Verify that the initial state is as expected.\n        initTest();\n\n        //Expected value\n        UWord Expected = 500\n        //Trigger to execute.\n        UWord Test = updatePositioning();\n\n        // Verify that the results are as expected.\n        Assert::AreEqual(Expected, Test);\n\n      }\n   };\n}\n#endif\n</code></pre>\n"}, {"tags": ["c", "embedded"], "comments": [{"owner": {"reputation": 16371, "user_id": 479251, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9870fa7c3f578b33976c7a770cbff4b2?s=128&d=identicon&r=PG", "display_name": "Pac0", "link": "https://stackoverflow.com/users/479251/pac0"}, "edited": false, "score": 2, "creation_date": 1529492585, "post_id": 50946625, "comment_id": 88890607, "body": "it would probably depend on the achitecture of your microcontroller (for word alignment)"}, {"owner": {"reputation": 2999, "user_id": 7520531, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0107497596782a18d4a853214a883546?s=128&d=identicon&r=PG&f=1", "display_name": "Jose", "link": "https://stackoverflow.com/users/7520531/jose"}, "edited": false, "score": 1, "creation_date": 1529492627, "post_id": 50946625, "comment_id": 88890634, "body": "Have a look at structure packing and padding, it is very helpful (but it doesn&#39;t perform miracles)."}, {"owner": {"reputation": 9602, "user_id": 7151494, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-a_FzvY-b2O0/AAAAAAAAAAI/AAAAAAAAAEw/kNwilSAvQTI/photo.jpg?sz=128", "display_name": "Fureeish", "link": "https://stackoverflow.com/users/7151494/fureeish"}, "edited": false, "score": 2, "creation_date": 1529492715, "post_id": 50946625, "comment_id": 88890683, "body": "On my machine, <code>sizeof(status)</code> is 584. This is exactly the result of <code>sizeof(sub)</code> (18) * 4 * 8 + 4*2, so the statement &quot;<i>Currently, it needs approximately twice the space all variables would need individually if they were not stored in a structure</i>&quot; is simply incorrect. What is the actual size of the <code>status</code> on your machine?"}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 1, "creation_date": 1529493257, "post_id": 50946625, "comment_id": 88891014, "body": "<i>&quot;twice the space all variables would need individually&quot;</i> : If that is true, it would suggest that the compiler is generating 32bit alignment, which may or may not be the case.  Options for &quot;packing&quot; a structure are compiler/target dependent.  On some targets, packing a structure may generate additional access code if unaligned access is not supported.  Saving RAM usage is generally a high-level application design issue rather then a code-level &quot;trick&quot;.  For example, what is teh range of values stored in each member?  Do they need to be 16 bit?  Could you use bitfields for example?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 3, "creation_date": 1529493424, "post_id": 50946625, "comment_id": 88891117, "body": "Questions about optimization can&#39;t be answered without knowing the specific system and compiler used."}, {"owner": {"reputation": 547, "user_id": 7816874, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/2e8bf5f2776c69a174b07db86dcba337?s=128&d=identicon&r=PG&f=1", "display_name": "Peter123", "link": "https://stackoverflow.com/users/7816874/peter123"}, "reply_to_user": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1529493537, "post_id": 50946625, "comment_id": 88891187, "body": "@Clifford: The range of all a1 - a8 is 0 - 1023."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1529495436, "post_id": 50946625, "comment_id": 88892390, "body": "@Peter123 So use 10 bit bitfields and structure packing, but be aware that member access will probably generate larger code."}], "answers": [{"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1529493485, "post_id": 50946856, "comment_id": 88891154, "body": "It&#39;s far from obvious why padding would create a struct twice as big anyway."}, {"owner": {"reputation": 2999, "user_id": 7520531, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0107497596782a18d4a853214a883546?s=128&d=identicon&r=PG&f=1", "display_name": "Jose", "link": "https://stackoverflow.com/users/7520531/jose"}, "edited": false, "score": 0, "creation_date": 1529494131, "post_id": 50946856, "comment_id": 88891548, "body": "&quot;This only works with gcc compiler...&quot; <code>__attribute__((packed))</code> works on several compilers, not only GCC (for instance, keil compiler, <a href=\"http://www.keil.com/support/man/docs/armcc/armcc_chr1359124980173.htm\" rel=\"nofollow noreferrer\">keil.com/support/man/docs/armcc/armcc_chr1359124980173.htm</a>)"}, {"owner": {"reputation": 2030, "user_id": 550235, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/934de7ad57af9a8f6a37e0c78017f942?s=128&d=identicon&r=PG", "display_name": "Russ Schultz", "link": "https://stackoverflow.com/users/550235/russ-schultz"}, "edited": false, "score": 0, "creation_date": 1529495270, "post_id": 50946856, "comment_id": 88892263, "body": "I think the answer could easily be made more generic by mentioning the idea of packing and referring to the GCC or pragma methods of specifying it.  That would at least give search engine terms to guide somebody to further info."}, {"owner": {"reputation": 370, "user_id": 9769810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XAI8c.jpg?s=128&g=1", "display_name": "Killian G.", "link": "https://stackoverflow.com/users/9769810/killian-g"}, "edited": false, "score": 0, "creation_date": 1529495368, "post_id": 50946856, "comment_id": 88892341, "body": "As you can see in the &quot;Edit&quot;, i said that <code>padding</code> is the important idea to remember"}], "tags": [], "owner": {"reputation": 370, "user_id": 9769810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XAI8c.jpg?s=128&g=1", "display_name": "Killian G.", "link": "https://stackoverflow.com/users/9769810/killian-g"}, "is_accepted": false, "score": 1, "last_activity_date": 1529494262, "last_edit_date": 1529494262, "creation_date": 1529493119, "answer_id": 50946856, "question_id": 50946625, "link": "https://stackoverflow.com/questions/50946625/reduce-ram-consumption-of-structure-in-c/50946856#50946856", "title": "Reduce RAM consumption of structure in C", "body": "<p>You can use <code>__attribute__((packed))</code> for your structure, that will change the padding and then reduce the RAM needed for your structure</p>\n\n<p>Edit:</p>\n\n<p>This doesn't works with all compilers, but the idea you have to remember is <code>padding</code>, you can do it naturally by sorting your variables by their types.</p>\n\n<p>Ex:</p>\n\n<pre><code>struct s_structure1 {\n    int a;\n    int b;\n    char c;\n    char d;\n    float e;\n}\n\nstruct s_structure2 {\n    int a;\n    char c;\n    int b;\n    float e;\n    char d;\n}\n</code></pre>\n\n<p>size of s_structure1 in bytes : 16</p>\n\n<p>size of s_structure2 in bytes : 20</p>\n"}], "owner": {"reputation": 547, "user_id": 7816874, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/2e8bf5f2776c69a174b07db86dcba337?s=128&d=identicon&r=PG&f=1", "display_name": "Peter123", "link": "https://stackoverflow.com/users/7816874/peter123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1529494262, "creation_date": 1529492350, "question_id": 50946625, "link": "https://stackoverflow.com/questions/50946625/reduce-ram-consumption-of-structure-in-c", "title": "Reduce RAM consumption of structure in C", "body": "<p>I'm currently developing a firmware for a microcontroller. I'm using the following structure in my code:</p>\n\n<pre><code>struct sub\n{\nuint16_t a1;\nuint16_t a2;\nuint16_t a3;\nuint16_t a4;\nuint16_t a5;\nuint16_t a6;\nuint16_t a7;\nuint16_t a8;\nuint8_t a9;\nuint8_t a10;\n};\n\nstruct state\n{\nstruct sub sub1;\nstruct sub sub2;\nstruct sub sub3;\nstruct sub sub4;\n};\n\n\ntypedef struct\n{\nuint16_t c1;\nuint16_t c2;\nuint16_t c3;\nuint16_t c4;\nstruct state state1;\nstruct state state2;\nstruct state state3;\nstruct state state4;\nstruct state state5;\nstruct state state6;\nstruct state state7;\nstruct state state8;\n} status\n</code></pre>\n\n<p>So, the hierarchy is status, state and sub.\nDoes anybody of you see a possibility to reduce the RAM size needed by this structure? Currently, it needs approximately twice the space all variables would need individually if they were not stored in a structure.</p>\n"}, {"tags": ["c", "types"], "comments": [{"owner": {"reputation": 6023, "user_id": 2417459, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/QcuXb.png?s=128&g=1", "display_name": "i486", "link": "https://stackoverflow.com/users/2417459/i486"}, "edited": false, "score": 1, "creation_date": 1529491401, "post_id": 50946280, "comment_id": 88889869, "body": "Maybe you ignore compiler warnings."}, {"owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "edited": false, "score": 2, "creation_date": 1529491402, "post_id": 50946280, "comment_id": 88889870, "body": "<b>Always enable compiler warnings, and heed them.</b> C (and C++) are very much languages that <i>allow</i> you to do &quot;illegal&quot; things if you insist... (You also didn&#39;t <code>#include &lt;stdio.h&gt;</code> there, for example, or wrote <code>int main( void )</code> as you should have done...)"}, {"owner": {"reputation": 12315, "user_id": 658031, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/711e76c263d03660772b5a5198d33671?s=128&d=identicon&r=PG", "display_name": "Saeid Yazdani", "link": "https://stackoverflow.com/users/658031/saeid-yazdani"}, "edited": false, "score": 0, "creation_date": 1529492116, "post_id": 50946280, "comment_id": 88890309, "body": "ever heard of overflow?"}, {"owner": {"reputation": 12315, "user_id": 658031, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/711e76c263d03660772b5a5198d33671?s=128&d=identicon&r=PG", "display_name": "Saeid Yazdani", "link": "https://stackoverflow.com/users/658031/saeid-yazdani"}, "edited": false, "score": 0, "creation_date": 1529492169, "post_id": 50946280, "comment_id": 88890351, "body": "Note: char range is [-128, 127] , not [-127, 127] as you said !!!!! in 2s complement the negative range is alwasy 1 more than positive range"}, {"owner": {"reputation": 1008, "user_id": 261981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c602c66983841d31a8d2131c8428f1fb?s=128&d=identicon&r=PG", "display_name": "Neil", "link": "https://stackoverflow.com/users/261981/neil"}, "edited": false, "score": 0, "creation_date": 1529492251, "post_id": 50946280, "comment_id": 88890406, "body": "Also, run the code through a debugger and see the actual value stored in &#39;b&#39;."}, {"owner": {"reputation": 85822, "user_id": 597607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jCzJi.png?s=128&g=1", "display_name": "Bo Persson", "link": "https://stackoverflow.com/users/597607/bo-persson"}, "reply_to_user": {"reputation": 12315, "user_id": 658031, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/711e76c263d03660772b5a5198d33671?s=128&d=identicon&r=PG", "display_name": "Saeid Yazdani", "link": "https://stackoverflow.com/users/658031/saeid-yazdani"}, "edited": false, "score": 0, "creation_date": 1529492997, "post_id": 50946280, "comment_id": 88890854, "body": "@Saeid - char range can also be [0, 511], it <a href=\"https://stackoverflow.com/a/6972551/597607\">depends on your system</a>. And who says it is using 2&#39;s complement? :-)"}, {"owner": {"reputation": 1, "user_id": 7539079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a08ff0faa194d07a81cb20b28d9cfb65?s=128&d=identicon&r=PG&f=1", "display_name": "african_hermit", "link": "https://stackoverflow.com/users/7539079/african-hermit"}, "edited": false, "score": 0, "creation_date": 1529493288, "post_id": 50946280, "comment_id": 88891032, "body": "I tried to run the code via Visual Studio.. The only option is command line visual c++ application, which I selected.. the code did not run, this could be because it is visuall c++ and my source code is in C"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1529494276, "post_id": 50946280, "comment_id": 88891642, "body": "Also: <a href=\"https://stackoverflow.com/questions/2054939/is-char-signed-or-unsigned-by-default\">Is char signed or unsigned by default?</a>"}, {"owner": {"reputation": 12315, "user_id": 658031, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/711e76c263d03660772b5a5198d33671?s=128&d=identicon&r=PG", "display_name": "Saeid Yazdani", "link": "https://stackoverflow.com/users/658031/saeid-yazdani"}, "reply_to_user": {"reputation": 85822, "user_id": 597607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jCzJi.png?s=128&g=1", "display_name": "Bo Persson", "link": "https://stackoverflow.com/users/597607/bo-persson"}, "edited": false, "score": 0, "creation_date": 1529675138, "post_id": 50946280, "comment_id": 88973258, "body": "@BoPersson Ahhh you did find that 1% chance :)"}], "answers": [{"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1529495060, "post_id": 50947007, "comment_id": 88892107, "body": "Strictly speaking, this isn&#39;t actually a signed integer overflow, but a conversion from a large signed integer to a smaller one. Still a bad idea of course, but not undefined, but impl.defined. An overflow would be <code>signed char b=0; b+=666;</code>."}], "tags": [], "owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "is_accepted": false, "score": 0, "last_activity_date": 1529494674, "last_edit_date": 1529494674, "creation_date": 1529493572, "answer_id": 50947007, "question_id": 50946280, "link": "https://stackoverflow.com/questions/50946280/c-data-types-range/50947007#50947007", "title": "C Data Types&#39; range", "body": "<p>C is an old-school language.  Don't say things like \"I did not expect this to compile because...\".  In general, most C compilers try as hard as they can to compile <em>something</em> for you, even if it's dangerous.  Don't say things like \"Shouldn't any value outside the range be rejected by the compiler?\".  Most C compilers don't reject things just because they're a bad idea -- or even because they might not work.</p>\n\n<p>Most modern compilers will, however, <em>warn</em> you about bad ideas, but even then, you may have to explicitly request such warnings, because in their default mode, the compilers may still be operating under the old-school assumption that the programmer knows what he is doing.</p>\n\n<p>In C, overflow of <code>unsigned</code> types has guaranteed behavior -- arithmetic is always performed, in effect, modulo the size of the type.  Although it's not guaranteed, most processors and most compilers implement the same sort of thing for overflow on signed types as well -- and there's probably a fair amount of code that depends on this.  So that's another reason that compiler warnings about signed integer overflow aren't necessarily prominent.</p>\n\n<p>With that said, though, I tried your code under two different compilers.  One said \"warning: overflow in implicit constant conversion\", and the other said \"warning: implicit conversion from 'int' to 'signed char' changes value from 32767 to -1\".</p>\n\n<p>If your compiler is not giving you warnings like these, you will either want to (a) make sure all warnings are enabled (either with a checkbox in a configuration settings dialog somewhere, or with a command-line option flag like <code>-Wall</code>), or (b) get a better compiler.</p>\n"}, {"tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 0, "last_activity_date": 1529494918, "creation_date": 1529494918, "answer_id": 50947413, "question_id": 50946280, "link": "https://stackoverflow.com/questions/50946280/c-data-types-range/50947413#50947413", "title": "C Data Types&#39; range", "body": "<p>The C language allows you try to show a larger type into a smaller one, though how it will do so it is not well-defined and shouldn't be relied upon.</p>\n\n<p>On this row <code>signed char b = 32767;</code> you attempt to store an <code>int</code> inside a <code>signed char</code>. What applies then is this part from the C standard (C11 6.3.1.3/3):</p>\n\n<blockquote>\n  <p>Otherwise, the new type is signed and the value cannot be represented in it; either the\n  result is implementation-defined or an implementation-defined signal is raised.</p>\n</blockquote>\n\n<p>So what will happen is not well-defined, but left to the system and compiler. On a typical 2's complement system, it is likely taking the binary value of <code>32767 = 0x7FFF</code>, cutting off everything but the LS byte = <code>0xFF</code>, then translating this as a <code>signed char</code> number, meaning decimal <code>-1</code>.</p>\n\n<p>That being said, your code doesn't really make any sense and there's no use for such code in real applications, so good compilers will give you a warning for it.</p>\n\n<hr>\n\n<p>The reason your anti-virus pops up is because anti-virus hates programmers. It spots that you try to change an executable (your own program's binary output). I would advise to disable/uninstall anti-virus on computers used for programming.</p>\n"}], "owner": {"reputation": 1, "user_id": 7539079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a08ff0faa194d07a81cb20b28d9cfb65?s=128&d=identicon&r=PG&f=1", "display_name": "african_hermit", "link": "https://stackoverflow.com/users/7539079/african-hermit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1529494918, "creation_date": 1529491271, "last_edit_date": 1529492001, "question_id": 50946280, "link": "https://stackoverflow.com/questions/50946280/c-data-types-range", "title": "C Data Types&#39; range", "body": "<pre><code>#include &lt;math.h&gt;\n\nint main(){\n\n    signed char b = 32767;\n    if (b){\n        printf(\"YES\");\n    }\n    else\n        printf(\"NO\");\n}\n</code></pre>\n\n<p>I did not expect this to compile because signed char's range is [\u2212127, +127] ?? I also tried to enter a value with 8 bits (12345678), that also compiled okay, 9 bits, however, caused my Avast antivirus to come up I thought the program hanged, but it compiled after a while.. My questions is shouldn't any value outside [\u2212127, +127] be rejected by the compiler for a signed char data type?</p>\n"}, {"tags": ["mysql", "c", "linux", "posix"], "comments": [{"owner": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 0, "creation_date": 1529491833, "post_id": 50946251, "comment_id": 88890143, "body": "Note that regardless of posix, it has been an underlying assumption across all unixes that write()(and similar functions such as pwrite)  on a <b>regular file</b> (<i>as opposed to other devices such as pipes or sockets</i>) will always write the entire buffer - and if that does not happen, some hard error has occured. I do not know whether this is stated in any official documentation though. - it is probably still worth it to file a bug report."}, {"owner": {"reputation": 80047, "user_id": 169346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/645dbb4f7ba1ff9d7ff2de02f68fbe9c?s=128&d=identicon&r=PG", "display_name": "JeremyP", "link": "https://stackoverflow.com/users/169346/jeremyp"}, "edited": false, "score": 1, "creation_date": 1529492157, "post_id": 50946251, "comment_id": 88890339, "body": "<code>errno</code> is 0 because if <code>write</code> returns a short count, no error is raised until the <i>next</i> attempt to write. From your link: &quot;If a write() requests that more bytes be written than there is room for ... only as many bytes as there is room for shall be written. For example, suppose there is space for 20 bytes more in a file before reaching a limit. A write of 512 bytes will return 20. <b>The next write of a non-zero number of bytes would give a failure return</b> ... &quot; Yes, there is a bug in MySQL because it bails before it has determined the reason for the short count."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 0, "creation_date": 1529493345, "post_id": 50946251, "comment_id": 88891064, "body": "@nos <i>it has been an underlying assumption across all unixes that write()(and similar functions such as pwrite) on a regular file (as opposed to other devices such as pipes or sockets) will always write the entire buffer</i>  I know - I have <b>never</b> seen a short write before.  Yet I got about 6 of them yesterday.  I&#39;m thinking it has to be something specific about my customer&#39;s &quot;cloud&quot; configuration. I&#39;m wondering how much other software out there is going to have problems on such clouds as layers upon layers of virtualization do things that undermine previous assumptions about reliability."}, {"owner": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 0, "creation_date": 1529495375, "post_id": 50946251, "comment_id": 88892347, "body": "@AndrewHenle Hence my recommendation of filing a bug report - with as much technical information about the environment(filesystem, iSCSI configuration, VMWare version, kernel version and so on) as possible."}, {"owner": {"reputation": 1320, "user_id": 1600612, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab513043b9b486138701a4b2a98648c8?s=128&d=identicon&r=PG", "display_name": "dvk", "link": "https://stackoverflow.com/users/1600612/dvk"}, "edited": false, "score": 1, "creation_date": 1529495784, "post_id": 50946251, "comment_id": 88892635, "body": "WRT &quot;underlying assumption&quot; about short write. I&#39;m glad I do not know about such assumption. The documentation explicitly says it&#39;s not the case. First, <code>man pwrite</code> says &quot;Note that is not an error for a successful call to transfer fewer bytes than requested (see read(2) and write(2)).&quot; And then <code>man write</code> repeats that and even gives an example: &quot;If a write() is interrupted by a signal handler before any bytes are written, then the call fails with the error EINTR; if it is interrupted after at least one byte has been written, the call succeeds, and  returns  the number of bytes written.&quot;"}, {"owner": {"reputation": 1320, "user_id": 1600612, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab513043b9b486138701a4b2a98648c8?s=128&d=identicon&r=PG", "display_name": "dvk", "link": "https://stackoverflow.com/users/1600612/dvk"}, "edited": false, "score": 0, "creation_date": 1529496184, "post_id": 50946251, "comment_id": 88892931, "body": "In other words, I do think it&#39;s a MySQL bug and a bug report should be filed"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 1320, "user_id": 1600612, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab513043b9b486138701a4b2a98648c8?s=128&d=identicon&r=PG", "display_name": "dvk", "link": "https://stackoverflow.com/users/1600612/dvk"}, "edited": false, "score": 0, "creation_date": 1529500326, "post_id": 50946251, "comment_id": 88895689, "body": "@dvk Thanks for the reference to a signal interrupting the write.  I&#39;m wondering if that might be happening - writing a full MB over an iSCSI LUN in the customer&#39;s environment likely takes a long time and the underlying data transfer consists of a pretty substantial number of individual SCSI requests and network packets.  I&#39;m also wondering if I&#39;m hitting some SCSI timeout in that long sequence."}], "owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 220, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1529491360, "creation_date": 1529491152, "last_edit_date": 1529491360, "question_id": 50946251, "link": "https://stackoverflow.com/questions/50946251/mysql-assumes-partial-pwrite-means-disk-is-full", "title": "MySQL assumes partial `pwrite()` means disk is full", "body": "<p>I'm supporting a large customer, running a few MySQL 5.5.59 databases on Centos 6 or 7 virtual servers running under VMWare.  MySQL databases are stored on XFS filesystems on iSCSI LUNs.</p>\n\n<p>I'm getting intermittent corrupt tables correlated with errors such as this in the MySQL error logs:</p>\n\n<pre><code>180619 15:08:38  InnoDB: Error: Write to file (merge) failed at offset 0 656408576\nInnoDB: 1048576 bytes should have been written, only 921600 were written.\nInnoDB: Operating system error number 0.\nInnoDB: Check that your OS and file system support files of this size.\nInnoDB: Check also that the disk is not full or a disk quota exceeded.\nInnoDB: Error number 0 means 'Success'.\n</code></pre>\n\n<p>The disk(s) are never full, there are no quotas, and the file size is a few GB (2-6) and well within the range of supported file sizes on XFS on 64-bit Linux.</p>\n\n<p><strong>And note that <code>errno</code> is <code>0</code>.</strong></p>\n\n<p>The MySQL code that generates this error is <code>storage/innobase/os/os0file.c</code>.  It blindly assumes <strong>ANY</strong> partial write must mean the disk is full (full MySQL source for 5.5 is available at <a href=\"https://dev.mysql.com/downloads/mysql/5.5.html\" rel=\"nofollow noreferrer\">https://dev.mysql.com/downloads/mysql/5.5.html</a>):</p>\n\n<pre><code>ret = os_file_pwrite(file, buf, n, offset, offset_high);\n\nif ((ulint)ret == n) {\n\n    return(TRUE);\n}\n\nif (!os_has_said_disk_full) {\n\n    ut_print_timestamp(stderr);\n\n    fprintf(stderr,\n        \"  InnoDB: Error: Write to file %s failed\"\n        \" at offset %lu %lu.\\n\"\n        \"InnoDB: %lu bytes should have been written,\"\n        \" only %ld were written.\\n\"\n        \"InnoDB: Operating system error number %lu.\\n\"\n        \"InnoDB: Check that your OS and file system\"\n        \" support files of this size.\\n\"\n        \"InnoDB: Check also that the disk is not full\"\n        \" or a disk quota exceeded.\\n\",\n        name, offset_high, offset, n, (long int)ret,\n        (ulint)errno);\n    if (strerror(errno) != NULL) {\n        fprintf(stderr,\n            \"InnoDB: Error number %lu means '%s'.\\n\",\n            (ulint)errno, strerror(errno));\n    }\n\n    fprintf(stderr,\n        \"InnoDB: Some operating system error numbers\"\n        \" are described at\\n\"\n        \"InnoDB: \"\n        REFMAN \"operating-system-error-codes.html\\n\");\n\n    os_has_said_disk_full = TRUE;\n}\n\nreturn(FALSE);\n</code></pre>\n\n<p>The relevant part of MySQL's InnoDB <code>os_file_pwrite()</code> function (it's a wrapper around the actual <code>pwrite()</code> function call):</p>\n\n<pre><code>/*******************************************************************//**\nDoes a synchronous write operation in Posix.\n@return number of bytes written, -1 if error */\nstatic\nssize_t\nos_file_pwrite(\n/*===========*/\n    os_file_t   file,   /*!&lt; in: handle to a file */\n    const void* buf,    /*!&lt; in: buffer from where to write */\n    ulint       n,  /*!&lt; in: number of bytes to write */\n    ulint       offset, /*!&lt; in: least significant 32 bits of file\n                offset where to write */\n    ulint       offset_high) /*!&lt; in: most significant 32 bits of\n                offset */\n{\n    ssize_t ret;\n    off_t   offs;\n\n    ut_a((offset &amp; 0xFFFFFFFFUL) == offset);\n\n    /* If off_t is &gt; 4 bytes in size, then we assume we can pass a\n    64-bit address */\n\n    if (sizeof(off_t) &gt; 4) {\n        offs = (off_t)offset + (((off_t)offset_high) &lt;&lt; 32);\n    } else {\n        offs = (off_t)offset;\n\n        if (offset_high &gt; 0) {\n            fprintf(stderr,\n                \"InnoDB: Error: file write\"\n                \" at offset &gt; 4 GB\\n\");\n        }\n    }\n\n    os_n_file_writes++;\n\n#if defined(HAVE_PWRITE) &amp;&amp; !defined(HAVE_BROKEN_PREAD)\n    os_mutex_enter(os_file_count_mutex);\n    os_file_n_pending_pwrites++;\n    os_n_pending_writes++;\n    os_mutex_exit(os_file_count_mutex);\n\n    ret = pwrite(file, buf, (ssize_t)n, offs);\n\n    os_mutex_enter(os_file_count_mutex);\n    os_file_n_pending_pwrites--;\n    os_n_pending_writes--;\n    os_mutex_exit(os_file_count_mutex);\n\n# ifdef UNIV_DO_FLUSH\n    if (srv_unix_file_flush_method != SRV_UNIX_LITTLESYNC\n        &amp;&amp; srv_unix_file_flush_method != SRV_UNIX_NOSYNC\n        &amp;&amp; !os_do_not_call_flush_at_each_write) {\n\n        /* Always do fsync to reduce the probability that when\n        the OS crashes, a database page is only partially\n        physically written to disk. */\n\n        ut_a(TRUE == os_file_flush(file));\n    }\n# endif /* UNIV_DO_FLUSH */\n\n    return(ret);\n</code></pre>\n\n<p>A cursory examination of the rest of the MySQL source seems to indicate that MySQL pretty much gives up after getting a partial <code>pwrite()</code>, resulting in data corruption in the database.</p>\n\n<p>The <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/write.html\" rel=\"nofollow noreferrer\">POSIX standard for <code>pwrite()</code></a> states that a partial write is an acceptable result and implies that it is not an error condition:</p>\n\n<blockquote>\n  <p>The <code>write()</code> function shall attempt to write <code>nbyte</code> bytes from the\n  buffer pointed to by <code>buf</code> to the file associated with the open file\n  descriptor, <code>fildes</code>.</p>\n  \n  <p>...</p>\n  \n  <p>The <code>pwrite()</code> function shall be equivalent to <code>write()</code> ...</p>\n  \n  <p><strong>RETURN VALUE</strong></p>\n  \n  <p>Upon successful completion, these functions shall return the number of\n  bytes actually written to the file associated with <code>fildes</code>. This\n  number shall never be greater than <code>nbyte</code>. Otherwise, <code>-1</code> shall be\n  returned and <code>errno</code> set to indicate the error.</p>\n</blockquote>\n\n<p>Per POSIX, the only <code>errno</code> value that indicates a full disk is:</p>\n\n<blockquote>\n  <p>[ENOSPC]\n      There was no free space remaining on the device containing the file.</p>\n</blockquote>\n\n<p>This to me is a MySQL bug - a partial <code>pwrite()</code> result is not an error condition and does not necessarily mean that the underlying disk is full - <strong>especially when <code>errno</code> is <code>0</code></strong>.</p>\n\n<p>I'm specifically asking if my interpretation of POSIX is correct.  If so, I plan on filing a MySQL bug report as I expect a database to be reliable.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 115745, "user_id": 119527, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lTjBL.png?s=128&g=1", "display_name": "Jonathon Reinhart", "link": "https://stackoverflow.com/users/119527/jonathon-reinhart"}, "edited": false, "score": 1, "creation_date": 1529491119, "post_id": 50946203, "comment_id": 88889671, "body": "Your structure contains a pointer (which is hard to see because of Microsoft&#39;s asinine <code>P</code> typedefs). Pointers point to data <i>in memory</i> - it makes no sense to write a pointer to disk."}, {"owner": {"reputation": 3, "user_id": 9941075, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-f_R65i5mX58/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq2hzyaFUPuJY-L6PZUn4g6HnBzWoA/mo/photo.jpg?sz=128", "display_name": "Aziz Parpiyev", "link": "https://stackoverflow.com/users/9941075/aziz-parpiyev"}, "reply_to_user": {"reputation": 115745, "user_id": 119527, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lTjBL.png?s=128&g=1", "display_name": "Jonathon Reinhart", "link": "https://stackoverflow.com/users/119527/jonathon-reinhart"}, "edited": false, "score": 0, "creation_date": 1529491463, "post_id": 50946203, "comment_id": 88889899, "body": "So, you say that this structure is pointer, if so, is it possible to get data and write it to file which this structure points ? (if i understand you correct)"}], "answers": [{"tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": false, "score": 1, "last_activity_date": 1529491168, "creation_date": 1529491168, "answer_id": 50946255, "question_id": 50946203, "link": "https://stackoverflow.com/questions/50946203/writing-data-structure-to-file/50946255#50946255", "title": "Writing data (structure) to file", "body": "<p>You're writing the <em>pointer</em> to the file. Pointers point to memory that is specific to the currently running process. If you load the pointer in another process, even one running the same program, then the pointer will not be valid.</p>\n\n<p>So a quick-fix is to not write the pointer, but the <em>structure</em> to the file.</p>\n\n<p><strong><em>However</em></strong> that will lead to the very same problem happening again, since one of the members in the structure is a pointer. What you need to do is to <a href=\"https://en.wikipedia.org/wiki/Serialization\" rel=\"nofollow noreferrer\"><em>serialize</em></a> the structure.</p>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 9941075, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-f_R65i5mX58/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq2hzyaFUPuJY-L6PZUn4g6HnBzWoA/mo/photo.jpg?sz=128", "display_name": "Aziz Parpiyev", "link": "https://stackoverflow.com/users/9941075/aziz-parpiyev"}, "edited": false, "score": 0, "creation_date": 1529494107, "post_id": 50946752, "comment_id": 88891540, "body": "Good explanation! You are partially right. Now I am getting private key itself <a href=\"http://lapo.it/asn1js/#02202D816B2FBCE9886C563442DF10FB914FC14A3A05563E5394BB150F5C1209E4F6\" rel=\"nofollow noreferrer\">link</a>, but I need all the structure. like this: <a href=\"http://lapo.it/asn1js/#3044020100301B06062A865C010703301106072A865C0107240006062A865C010709042202201177640858A94339A1A392726D6DF0FA3DF0B342D6505CDB802A5E810359B7F8\" rel=\"nofollow noreferrer\">link</a>"}, {"owner": {"reputation": 3, "user_id": 9941075, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-f_R65i5mX58/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq2hzyaFUPuJY-L6PZUn4g6HnBzWoA/mo/photo.jpg?sz=128", "display_name": "Aziz Parpiyev", "link": "https://stackoverflow.com/users/9941075/aziz-parpiyev"}, "edited": false, "score": 0, "creation_date": 1529494521, "post_id": 50946752, "comment_id": 88891797, "body": "may be I am not right, and I need to look somewhere else to get this type of data"}], "tags": [], "owner": {"reputation": 56328, "user_id": 4265352, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-lzAUc5pYb24/AAAAAAAAAAI/AAAAAAAAAGQ/q3h7bZUnqrs/photo.jpg?sz=128", "display_name": "axiac", "link": "https://stackoverflow.com/users/4265352/axiac"}, "is_accepted": true, "score": 0, "last_activity_date": 1596099503, "last_edit_date": 1596099503, "creation_date": 1529492783, "answer_id": 50946752, "question_id": 50946203, "link": "https://stackoverflow.com/questions/50946203/writing-data-structure-to-file/50946752#50946752", "title": "Writing data (structure) to file", "body": "<pre><code>fwrite(&amp;pPriKeyInfo, sizeof(pPriKeyInfo), cbPriKeyInfo, fp);\n</code></pre>\n<p>The first three arguments of your call to <code>fwrite()</code> are incorrect. They tell <code>fwrite()</code> what to write in the file, so there is no doubt why the data stored in the file doesn't look good.</p>\n<h3>How to use the <code>fwrite()</code> function, in general</h3>\n<p>The first argument of <a href=\"http://en.cppreference.com/w/c/io/fwrite\" rel=\"nofollow noreferrer\"><code>fwrite()</code></a> is a pointer to the data to be written. <code>fwrite()</code> can write an array of objects and its first argument is the address of the first object to write.</p>\n<p><code>pPriKeyInfo</code> is itself a pointer to the data you want to write in the file. Passing <code>&amp;pPriKeyInfo</code> to <code>fwrite()</code> doesn't make any sense. You don't care about the value of <code>pPriKeyInfo</code> but to the data it points to.</p>\n<p>The second argument of <code>fwrite()</code> is the size of each object to be written in the file. It should be the size of the structure pointed by the first argument (<code>CRYPT_PRIVATE_KEY_INFO</code>).</p>\n<p>The third argument of <code>fwrite()</code> is the number of objects to write. In your example it should be <code>1</code>.</p>\n<p>All in all, the call to <code>fwrite()</code> should look like:</p>\n<pre><code>fwrite(pPriKeyInfo, sizeof(CRYPT_PRIVATE_KEY_INFO), 1, fp);\n</code></pre>\n<h3>But wait, it still doesn't save the correct data!</h3>\n<p>The explanation above assumes the object passed as the first argument to <code>fwrite()</code> (a struct of type <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa381448(v=vs.85).aspx\" rel=\"nofollow noreferrer\"><code>CRYPT_PRIVATE_KEY_INFO</code></a>) contains the actual data you want to write in the file.</p>\n<p>This is not the case for <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa381448(v=vs.85).aspx\" rel=\"nofollow noreferrer\">struct <code>CRYPT_PRIVATE_KEY_INFO</code></a>. This is its definition:</p>\n<pre><code>typedef struct _CRYPT_PRIVATE_KEY_INFO {\n  DWORD                      Version;\n  CRYPT_ALGORITHM_IDENTIFIER Algorithm;\n  CRYPT_DER_BLOB             PrivateKey;\n  CRYPT_ATTRIBUTES           *pAttributes;\n} CRYPT_PRIVATE_KEY_INFO, CRYPT_PRIVATE_KEY_INFO, *PCRYPT_PRIVATE_KEY_INFO;\n</code></pre>\n<p>As you can see, the field <code>pAttributes</code> is a pointer to a <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa381146(v=vs.85).aspx\" rel=\"nofollow noreferrer\"><code>CRYPT_ATTRIBUTES</code></a> structure and the other two structure fields (<code>Algorithm</code> and <code>PrivateKey</code>) contain pointers themselves.</p>\n<p><strong>This is definitely <em>not the correct way</em> to save a <code>CRYPT_PRIVATE_KEY_INFO</code> structure in a file!</strong> And from the large amount of pointers it contains I think this structure is designed to be used in memory, not to be saved.</p>\n<p>It's not clear for me what exactly you want to save to the file but from the documentation it seems the actual key is stored in the <code>PrivateKey</code> member of the structure. To write it into the file you can use:</p>\n<pre><code>fwrite(pPriKeyInfo-&gt;PrivateKey.pbData, sizeof(BYTE), pPriKeyInfo-&gt;PrivateKey.cbData, fp);\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9941075, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-f_R65i5mX58/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq2hzyaFUPuJY-L6PZUn4g6HnBzWoA/mo/photo.jpg?sz=128", "display_name": "Aziz Parpiyev", "link": "https://stackoverflow.com/users/9941075/aziz-parpiyev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 50946752, "answer_count": 2, "score": 0, "last_activity_date": 1596099503, "creation_date": 1529491013, "question_id": 50946203, "link": "https://stackoverflow.com/questions/50946203/writing-data-structure-to-file", "title": "Writing data (structure) to file", "body": "<p>Well, I have a function:</p>\n\n<pre><code>CRYPT_PRIVATE_KEY_INFO *pPriKeyInfo = NULL;\nDWORD cbPriKeyInfo = 0;\nSxKS_ExportPKCS8_PriKeyInfo(\n            pKey,\n            &amp;pPriKeyInfo,\n            &amp;cbPriKeyInfo);\n</code></pre>\n\n<p>which exports storage key (private key) into private key in specific structure:</p>\n\n<pre><code>typedef struct _CRYPT_PRIVATE_KEY_INFO{\n    DWORD                       Version;\n    CRYPT_ALGORITHM_IDENTIFIER  Algorithm;\n    CRYPT_DER_BLOB              PrivateKey;\n    PCRYPT_ATTRIBUTES           pAttributes;\n}  CRYPT_PRIVATE_KEY_INFO, *PCRYPT_PRIVATE_KEY_INFO;\n</code></pre>\n\n<p>I need to write data in this structure to the file:</p>\n\n<pre><code>FILE *fp;\nfp = fopen(\"c:\\\\CRYPT_PRIVATE_KEY_INFO.pem\", \"wb\");\nfwrite(&amp;pPriKeyInfo, sizeof(pPriKeyInfo), cbPriKeyInfo, fp);\nfclose(fp);\n</code></pre>\n\n<p>question is that, am I doing it right? because I think I am getting wrong data.</p>\n"}, {"tags": ["c", "string", "memory"], "comments": [{"owner": {"reputation": 8852, "user_id": 1383240, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/41093f55db0d5feaa0012ed6b5c3ca5c?s=128&d=identicon&r=PG&f=1", "display_name": "NiVeR", "link": "https://stackoverflow.com/users/1383240/niver"}, "edited": false, "score": 0, "creation_date": 1529490843, "post_id": 50946120, "comment_id": 88889497, "body": "Are you in C++?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9311878"}, "reply_to_user": {"reputation": 8852, "user_id": 1383240, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/41093f55db0d5feaa0012ed6b5c3ca5c?s=128&d=identicon&r=PG&f=1", "display_name": "NiVeR", "link": "https://stackoverflow.com/users/1383240/niver"}, "edited": false, "score": 0, "creation_date": 1529490981, "post_id": 50946120, "comment_id": 88889591, "body": "No, I&#39;m in C language"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9311878"}, "edited": false, "score": 0, "creation_date": 1529491177, "post_id": 50946120, "comment_id": 88889708, "body": "Yes that&#39;s what I meant, sorry being unclear."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user9311878"}, "edited": false, "score": 0, "creation_date": 1529491253, "post_id": 50946239, "comment_id": 88889762, "body": "Thank you for the answer!"}], "tags": [], "owner": {"reputation": 2240, "user_id": 3499640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff85dddff0538584dfeb0dfc0946a341?s=128&d=identicon&r=PG&f=1", "display_name": "srdjan.veljkovic", "link": "https://stackoverflow.com/users/3499640/srdjan-veljkovic"}, "is_accepted": true, "score": 2, "last_activity_date": 1529491120, "creation_date": 1529491120, "answer_id": 50946239, "question_id": 50946120, "link": "https://stackoverflow.com/questions/50946120/string-reference-in-the-c-language/50946239#50946239", "title": "String reference in the C language", "body": "<p>Assuming you're using C and not C++, a \"string\" is actually a pointer to a character (presumably, an array of characters actually, but, formally \"a character\"). So, assigning \"strings\" is assigning pointers and there will be no copy of the memory pointed to (by said pointer) involved.</p>\n\n<pre><code>char const* s = \"whatev\";\nchar const* s2 = s; // both s and s2 point to the same memory \n                // that \"holds\" the 'w' (followed by `hatev` and NUL character)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 9965931, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48af5fd871f84f239d9560ff8a85228c?s=128&d=identicon&r=PG", "display_name": "Linus Nielsen", "link": "https://stackoverflow.com/users/9965931/linus-nielsen"}, "is_accepted": false, "score": 1, "last_activity_date": 1529491443, "creation_date": 1529491443, "answer_id": 50946343, "question_id": 50946120, "link": "https://stackoverflow.com/questions/50946120/string-reference-in-the-c-language/50946343#50946343", "title": "String reference in the C language", "body": "<p>In C, there is no string type. Strings in C are just arrays of characters. A string variable is declared to be of type <code>char *</code>, which is a pointer to a char (array).</p>\n\n<p>Therefore, the assignment <code>s1 = s</code> will just copy the pointer from s to s1, i.e a memory reference, and not a copy of the string data.</p>\n\n<p>If you want to copy the string, you can use the <code>strdup()</code> function, which will allocate memory and copy the string data to it. Remember to <code>free()</code> the memory afterwards.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9311878"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 1, "accepted_answer_id": 50946239, "answer_count": 2, "score": 1, "last_activity_date": 1529491443, "creation_date": 1529490760, "last_edit_date": 1529491214, "question_id": 50946120, "link": "https://stackoverflow.com/questions/50946120/string-reference-in-the-c-language", "title": "String reference in the C language", "body": "<p><br>\nlet's say I create a char *s = \"something\" and then I assign another variable s1 = s, would s1 take the memory reference of s or would it go to another memory chunk and copy the \"value\" of s so that it has a reference on its own?</p>\n"}, {"tags": ["c", "linux", "conditional", "mutex"], "answers": [{"tags": [], "owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "is_accepted": true, "score": 0, "last_activity_date": 1529492417, "last_edit_date": 1592644375, "creation_date": 1529490883, "answer_id": 50946162, "question_id": 50945546, "link": "https://stackoverflow.com/questions/50945546/do-we-need-to-unlocking-a-mutex-after-recived-a-signal-from-cond-variable/50946162#50946162", "title": "Do we need to unlocking a mutex after recived a signal from cond variable?", "body": "<blockquote>\n<p>Can you explain me, why after &quot;while&quot; statment (and recived signal from second thread) we need to unlock the mutex, when signal makes that mutex is locked?</p>\n</blockquote>\n<p>When <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/pthread_cond_wait.html\" rel=\"nofollow noreferrer\"><code>pthread_cond_wait</code></a> returns the mutex is locked so that you can examine the shared state protected by it safely:</p>\n<blockquote>\n<p>These functions atomically release mutex and cause the calling thread to block on the condition variable cond; atomically here means &quot;atomically with respect to access by another thread to the mutex and then the condition variable&quot;. That is, if another thread is able to acquire the mutex after the about-to-block thread has released it, then a subsequent call to <code>pthread_cond_broadcast()</code> or <code>pthread_cond_signal()</code> in that thread shall behave as if it were issued after the about-to-block thread has blocked.</p>\n<p><strong>Upon successful return, the mutex shall have been locked and shall be owned by the calling thread.</strong> If mutex is a robust mutex where an owner terminated while holding the lock and the state is recoverable, the mutex shall be acquired even though the function returns an error code.</p>\n</blockquote>\n<p>Generally, a mutex should be unlocked as soon as possible to reduce contention.</p>\n<p>In your case, you wait for shared state <code>is_done</code> to change. Once it changed and you are done accessing the shared state protected by the mutex, the mutex must be unlocked.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9687180"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 183, "favorite_count": 0, "accepted_answer_id": 50946162, "answer_count": 1, "score": 0, "last_activity_date": 1529492417, "creation_date": 1529489034, "question_id": 50945546, "link": "https://stackoverflow.com/questions/50945546/do-we-need-to-unlocking-a-mutex-after-recived-a-signal-from-cond-variable", "title": "Do we need to unlocking a mutex after recived a signal from cond variable?", "body": "<p>I making an app in C for educational purposes with mutexes and conditional variables.</p>\n\n<p>Short example here:</p>\n\n<pre><code>while (!(is_done == 0))         \n    pthread_cond_wait(&amp;cond, &amp;mutex);\n\n pthread_mutex_unlock(&amp;mutex); \n</code></pre>\n\n<p>Can you explain me, why after \"while\" statment (and recived signal from second thread) we need to unlock the mutex, when signal makes that mutex is locked? </p>\n\n<p>I get it from a lot examples from web, but when i want to work with mutex after reciving signal, do i need to unlocking mutex? Ofc i want to work on this thread after reciving signal </p>\n"}, {"tags": ["c", "math", "division"], "comments": [{"owner": {"reputation": 159, "user_id": 5413925, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/e512b08eca489aecffe11d4873ebdfb5?s=128&d=identicon&r=PG&f=1", "display_name": "Dropper", "link": "https://stackoverflow.com/users/5413925/dropper"}, "reply_to_user": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "edited": false, "score": 0, "creation_date": 1529488548, "post_id": 50945187, "comment_id": 88888046, "body": "@gsamaras, I hoped to find something similar to this   <code>static A_UINT32 div_10(A_UINT32 duration) {     A_UINT64 invDivisor = 0x1999999A;     return (A_UINT32)((invDivisor * duration) &gt;&gt; 32); }</code>"}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 1, "creation_date": 1529491418, "post_id": 50945187, "comment_id": 88889881, "body": "You could just do <code>x &#47; 13</code> and let the compiler optimise it. That doesn&#39;t eliminate the division operator, but the compiler may avoid using &#39;divide&#39; instructions to evaluate it."}, {"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 0, "creation_date": 1529492431, "post_id": 50945187, "comment_id": 88890516, "body": "Think about what your <code>div_10</code> does. It computes <code>m * duration &#47; (2^32)</code>. In other words, they came up with a value <code>m</code> (in this case, specifically <code>0x1999999A</code>) such that <code>(m * duration) &#47; (2^32)</code> is as close as possible to <code>duration &#47; 10</code>. In other words, they have found values <code>p</code> and <code>m</code> such that <code>2^p</code> is as close to <code>10 * m</code> as possible. You want to find <code>p</code> and <code>m</code> such that <code>2^p</code> is as close to <code>13 * m</code> as possible."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 2, "creation_date": 1529492442, "post_id": 50945187, "comment_id": 88890523, "body": "This answer is courtesy of the GCC compiler: <code>static A_UINT32 div_13(A_UINT32 duration) { \tA_UINT64 intDivisor = 1321528399; \treturn (A_UINT32)((intDivisor * duration) &gt;&gt; 34); } </code>"}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "reply_to_user": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 1, "creation_date": 1529492683, "post_id": 50945187, "comment_id": 88890662, "body": "@lurker Well a useful tip is to get GCC to do the work, look at the assembly output and write a function to do the same thing. :)"}, {"owner": {"reputation": 159, "user_id": 5413925, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/e512b08eca489aecffe11d4873ebdfb5?s=128&d=identicon&r=PG&f=1", "display_name": "Dropper", "link": "https://stackoverflow.com/users/5413925/dropper"}, "reply_to_user": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 0, "creation_date": 1529496596, "post_id": 50945187, "comment_id": 88893177, "body": "@lurker, thank you. I got it. @IanAbbott, thank you, but value <code>0x13B13B14</code> with right 32 bits shift more convenient for me."}, {"owner": {"reputation": 48421, "user_id": 1196549, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/fa597bf0dc47449a25e1f7f5b57e3ef1?s=128&d=identicon&r=PG", "display_name": "Yves Daoust", "link": "https://stackoverflow.com/users/1196549/yves-daoust"}, "edited": false, "score": 1, "creation_date": 1529500424, "post_id": 50945187, "comment_id": 88895757, "body": "IMO, division by a specific constant (13) can yield more ad-hoc answers than the general case. Not a duplicate."}, {"owner": {"reputation": 48421, "user_id": 1196549, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/fa597bf0dc47449a25e1f7f5b57e3ef1?s=128&d=identicon&r=PG", "display_name": "Yves Daoust", "link": "https://stackoverflow.com/users/1196549/yves-daoust"}, "edited": false, "score": 1, "creation_date": 1529500516, "post_id": 50945187, "comment_id": 88895819, "body": "What is the range of the dividend ?"}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 1, "creation_date": 1529504095, "post_id": 50945187, "comment_id": 88898306, "body": "if you want to manually calculate the magic number without the compiler then <a href=\"http://www.hackersdelight.org/magic.htm\" rel=\"nofollow noreferrer\">hackers delight</a> comes to the help"}, {"owner": {"reputation": 4818, "user_id": 1725562, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/4288cd33194976e81fbba4715e592858?s=128&d=identicon&r=PG", "display_name": "coproc", "link": "https://stackoverflow.com/users/1725562/coproc"}, "edited": false, "score": 0, "creation_date": 1529521648, "post_id": 50945187, "comment_id": 88908402, "body": "@Dropper note: the approximation with 32 bits shift only works up to 2^30. For <code>duration=1073741837</code> (<code>=2^30+13</code>) you get 82595526 instead of 82595525."}, {"owner": {"reputation": 4818, "user_id": 1725562, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/4288cd33194976e81fbba4715e592858?s=128&d=identicon&r=PG", "display_name": "coproc", "link": "https://stackoverflow.com/users/1725562/coproc"}, "edited": false, "score": 0, "creation_date": 1529524705, "post_id": 50945187, "comment_id": 88909725, "body": "also the approximation for dividing by 10 with only 32 bits shift only works up to 2^30. The only correct solution for all 32 bit unsigned integers with 64 bit intermediate result is <code>duration*3435973837&#47;2^35</code>"}, {"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 0, "creation_date": 1529525802, "post_id": 50945187, "comment_id": 88910199, "body": "And if any of the above issues matter at all, use the built-in divide and let the compiler handle it.  If this is a for fun thing, then have fun.  You could also revert back to the old school shifts and subtracts that was done for generic divides in systems that didn&#39;t have them."}, {"owner": {"reputation": 159, "user_id": 5413925, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/e512b08eca489aecffe11d4873ebdfb5?s=128&d=identicon&r=PG&f=1", "display_name": "Dropper", "link": "https://stackoverflow.com/users/5413925/dropper"}, "reply_to_user": {"reputation": 4818, "user_id": 1725562, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/4288cd33194976e81fbba4715e592858?s=128&d=identicon&r=PG", "display_name": "coproc", "link": "https://stackoverflow.com/users/1725562/coproc"}, "edited": false, "score": 0, "creation_date": 1529565938, "post_id": 50945187, "comment_id": 88922053, "body": "@coproc maximal duration value is 6386640 or something around that. It is less than 2^30. I think I am okay with such accuracy."}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1532652985, "post_id": 50945187, "comment_id": 90066263, "body": "you mentioned <code>tests that checks divisibility by 13</code>, so actually do you want a division by 13 or a modulo 13? The answers will be completely different"}], "answers": [{"tags": [], "owner": {"reputation": 4818, "user_id": 1725562, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/4288cd33194976e81fbba4715e592858?s=128&d=identicon&r=PG", "display_name": "coproc", "link": "https://stackoverflow.com/users/1725562/coproc"}, "is_accepted": true, "score": 1, "last_activity_date": 1529525242, "last_edit_date": 1529525242, "creation_date": 1529520733, "answer_id": 50955170, "question_id": 50945187, "link": "https://stackoverflow.com/questions/50945187/how-to-divide-by-13-without-operation/50955170#50955170", "title": "How to divide by 13 without &quot;/&quot; operation", "body": "<p>You are looking for two positive integers k and m, s.t. </p>\n\n<pre><code>[n*k/2^m] = [n/13],  0 &lt;= n &lt; 2^32\n</code></pre>\n\n<p>where <code>[x]</code> means \"rounding down\" the rational number <code>x</code> and <code>n</code> runs through all 32-bit unsigned integers. These 2^32 equations can be reduced to two inequalities:</p>\n\n<pre><code>k &gt; 2^m/13\nk &lt; 2^m*N/(13N-1)\n</code></pre>\n\n<p>where <code>N = [2^32/13]</code>. So we have to look for a value of <code>m</code> s.t. there is an integer value between <code>2^m/13</code> and <code>2^m*N/(13N-1)</code>. Since we carry out the computations with 64 bit we have to make sure that <code>n*k</code> is representable by 64 bits for all interesting n, hence we need <code>(2^32-1)*k &lt; 2^64</code>, i.e. <code>k &lt; 2^32</code>. From the first inequality we get <code>2^m/13 &lt; 2^32-1</code> which means <code>m &lt;= 35</code>. Now computing the lower and upper boundaries for <code>k</code> for <code>m</code> up to 35 we get the following table:</p>\n\n<pre><code> m      2^m/13      2^m*N/(13N-1)\n        ....\n31   165191049.85    165191049.88\n32   330382099.69    330382099.77\n33   660764199.38    660764199.54\n34  1321528398.77   1321528399.08\n35  2643056797.54   2643056798.15\n</code></pre>\n\n<p>When <code>m &lt; 34</code> there is no integer value in the range for k. But for <code>m=34</code> and <code>m=35</code> there is exactly one integer in the range. Hence the possible solutions: <code>k = 1321528399, m = 34</code> or <code>k = 2643056798, m = 35</code>.</p>\n\n<p>Here are solutions for other divisors:</p>\n\n<pre><code> d   m      k\n 3  33  2863311531\n 5  34  3435973837\n 6  34  2863311531\n 9  35  3817748708\n10  35  3435973837\n11  35  3123612579\n12  35  2863311531\n13  35  2643056798\n15  35  2290649225\n17  36  4042322161\n</code></pre>\n\n<p>There do not seem to be solutions of this form for division by 7, 14, 19, 21 (and more) if one wants correct results for all 32 bit unsigned integers with 64 bit calculations.</p>\n"}], "owner": {"reputation": 159, "user_id": 5413925, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/e512b08eca489aecffe11d4873ebdfb5?s=128&d=identicon&r=PG&f=1", "display_name": "Dropper", "link": "https://stackoverflow.com/users/5413925/dropper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 140, "favorite_count": 0, "accepted_answer_id": 50955170, "answer_count": 1, "score": -2, "last_activity_date": 1529525242, "creation_date": 1529488087, "last_edit_date": 1529489289, "question_id": 50945187, "link": "https://stackoverflow.com/questions/50945187/how-to-divide-by-13-without-operation", "title": "How to divide by 13 without &quot;/&quot; operation", "body": "<p>Is there any way to divide by 13 without actual division operation?</p>\n\n<p>I have found only tests that checks divisibility by 13.</p>\n\n<p>I am looking for something similar to this division by 10:</p>\n\n<pre><code>static A_UINT32 div_10(A_UINT32 duration)\n{\n    A_UINT64 invDivisor = 0x1999999A;\n    return (A_UINT32)((invDivisor * duration) &gt;&gt; 32);\n}\n</code></pre>\n\n<p>or to this division by 3:</p>\n\n<pre><code>static A_UINT32 div_3(A_UINT32 duration)\n{\n    duration += (duration + 0x2) &gt;&gt; 2;\n    duration += (duration + 0x8) &gt;&gt; 4;\n    duration += (duration + 0x80) &gt;&gt; 8;\n    duration += (duration + 0x8000) &gt;&gt; 16;\n    return duration &gt;&gt;= 2;\n}\n</code></pre>\n"}, {"tags": ["c", "linux", "elf", "linkage"], "comments": [{"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1529487411, "post_id": 50944859, "comment_id": 88887258, "body": "<code>main.o</code> will have a relocation entry in the data section for x. Let me reproduce and show the exact wordings."}], "answers": [{"comments": [{"owner": {"reputation": 15037, "user_id": 1111371, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/85fbe34f335b26ff6f6c8ef921a682ae?s=128&d=identicon&r=PG", "display_name": "ugoren", "link": "https://stackoverflow.com/users/1111371/ugoren"}, "edited": false, "score": 0, "creation_date": 1529489468, "post_id": 50945037, "comment_id": 88888665, "body": "Thanks. But is it possible to find it by inspecting the binary <code>main</code> alone? Recreating the intermediate files isn&#39;t always simple."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "reply_to_user": {"reputation": 15037, "user_id": 1111371, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/85fbe34f335b26ff6f6c8ef921a682ae?s=128&d=identicon&r=PG", "display_name": "ugoren", "link": "https://stackoverflow.com/users/1111371/ugoren"}, "edited": false, "score": 0, "creation_date": 1529489533, "post_id": 50945037, "comment_id": 88888702, "body": "@ugoren the same relocation table exists for the executable too. Since these are 64 bit references."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "reply_to_user": {"reputation": 15037, "user_id": 1111371, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/85fbe34f335b26ff6f6c8ef921a682ae?s=128&d=identicon&r=PG", "display_name": "ugoren", "link": "https://stackoverflow.com/users/1111371/ugoren"}, "edited": false, "score": 0, "creation_date": 1529489568, "post_id": 50945037, "comment_id": 88888725, "body": "Although some names might have disappeared if the binary is stripped"}, {"owner": {"reputation": 15037, "user_id": 1111371, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/85fbe34f335b26ff6f6c8ef921a682ae?s=128&d=identicon&r=PG", "display_name": "ugoren", "link": "https://stackoverflow.com/users/1111371/ugoren"}, "edited": false, "score": 0, "creation_date": 1529490329, "post_id": 50945037, "comment_id": 88889172, "body": "The relocation entries don&#39;t exist in <code>main</code>. I didn&#39;t strip it - I compiled exactly as in my question."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "reply_to_user": {"reputation": 15037, "user_id": 1111371, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/85fbe34f335b26ff6f6c8ef921a682ae?s=128&d=identicon&r=PG", "display_name": "ugoren", "link": "https://stackoverflow.com/users/1111371/ugoren"}, "edited": false, "score": 0, "creation_date": 1529493503, "post_id": 50945037, "comment_id": 88891163, "body": "@ugoren oh, that is because the gcc linker discards the relocation table, because executables are usually non relocatable. i.e. they are always executed at the same address. You can link (your last command) as <code>gcc -Wl,-q ...</code> to instruct <code>gcc</code> to keep the relocation table."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "reply_to_user": {"reputation": 15037, "user_id": 1111371, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/85fbe34f335b26ff6f6c8ef921a682ae?s=128&d=identicon&r=PG", "display_name": "ugoren", "link": "https://stackoverflow.com/users/1111371/ugoren"}, "edited": false, "score": 0, "creation_date": 1529493570, "post_id": 50945037, "comment_id": 88891213, "body": "@ugoren If you cannot control how the binaries are linked, there is not much to do other than searching for the address of the variables (like in your answer). But as you guesses that wouldn&#39;t always work."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "reply_to_user": {"reputation": 15037, "user_id": 1111371, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/85fbe34f335b26ff6f6c8ef921a682ae?s=128&d=identicon&r=PG", "display_name": "ugoren", "link": "https://stackoverflow.com/users/1111371/ugoren"}, "edited": false, "score": 0, "creation_date": 1529493673, "post_id": 50945037, "comment_id": 88891275, "body": "@ugoren relocation table is also kept by default if you make a shared library."}, {"owner": {"reputation": 15037, "user_id": 1111371, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/85fbe34f335b26ff6f6c8ef921a682ae?s=128&d=identicon&r=PG", "display_name": "ugoren", "link": "https://stackoverflow.com/users/1111371/ugoren"}, "edited": false, "score": 0, "creation_date": 1529494829, "post_id": 50945037, "comment_id": 88891983, "body": "I did eventually find it, by adding trace flags to the link command. The reference to the variable actually wasn&#39;t in the binary - it was in a shared library it was linked with."}], "tags": [], "owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "is_accepted": false, "score": 2, "last_activity_date": 1529487653, "creation_date": 1529487653, "answer_id": 50945037, "question_id": 50944859, "link": "https://stackoverflow.com/questions/50944859/find-who-uses-a-symbol-in-an-elf-file/50945037#50945037", "title": "Find who uses a symbol in an ELF file", "body": "<p>I compiled the same code (and same commands) and ran <code>objdump -x main.o</code>. There is a section </p>\n\n<pre><code>RELOCATION RECORDS FOR [.data]:\nOFFSET           TYPE              VALUE\n0000000000000000 R_X86_64_64       x\n</code></pre>\n\n<p>Which means it is a 64 bit relocation record(<code>R_X86_64_64</code>). It is at offset 0 in the data section (this is the offset of y in the data section). And the value to be relocated is <code>x</code> (which is actually the address of the variable <code>x</code>, since it is the label). </p>\n\n<p>To understand this better I added another variable - </p>\n\n<pre><code>extern int ** z = &amp;y;\n</code></pre>\n\n<p>Now the symbol table looks like - </p>\n\n<pre><code>0000000000000000 l     O .data  0000000000000008 y\n0000000000000008 l     O .data  0000000000000008 z\n</code></pre>\n\n<p>The first shows the offset of both the variables in the data section and the second number is their sizes. </p>\n\n<p>The relocation table also now looks like - </p>\n\n<pre><code>0000000000000000 R_X86_64_64       x\n0000000000000008 R_X86_64_64       .data\n</code></pre>\n\n<p>You can see that there are two entries now. One for <code>x</code>'s address being stored in <code>y</code> (offset 0) and the other is for <code>y</code>'s address being stored in <code>z</code> (offset 8). Instead of <code>y</code> you see <code>.data</code> because the address of the data section is the same as the address of <code>y</code> because <code>y</code> is at offset <code>0</code>.</p>\n\n<p>Thus by looking at the relocation table, you can find the absolute references of all variables (or functions). </p>\n"}, {"tags": [], "owner": {"reputation": 15037, "user_id": 1111371, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/85fbe34f335b26ff6f6c8ef921a682ae?s=128&d=identicon&r=PG", "display_name": "ugoren", "link": "https://stackoverflow.com/users/1111371/ugoren"}, "is_accepted": false, "score": 0, "last_activity_date": 1529491021, "creation_date": 1529491021, "answer_id": 50946205, "question_id": 50944859, "link": "https://stackoverflow.com/questions/50944859/find-who-uses-a-symbol-in-an-elf-file/50946205#50946205", "title": "Find who uses a symbol in an ELF file", "body": "<p>Here's the method I found. It works for this simple example, but unfortunately not for my real case. I'm not sure what's the difference.</p>\n\n<p>I'm looking for users of symbol <code>x</code> in binary <code>main</code>:</p>\n\n<pre><code>$ objdump -t main | grep -w x\n0000000000000000 l    df *ABS*  0000000000000000              x.c\n0000000000601040 g     O .data  0000000000000004              x\n</code></pre>\n\n<p>So x is in offset <code>00601040</code>. I look for this address, reversed (because of endianity, I guess):</p>\n\n<pre><code>$ objdump -s main | egrep '^Contents of section|40106000'\n... omitted irrelevant sections ...\nContents of section .data:\n 601028 00000000 00000000 40106000 00000000  ........@.`.....\n</code></pre>\n\n<p>So the symbol at offset <code>601030</code> in <code>.data</code> contains this address.</p>\n\n<pre><code>$ objdump -t main | grep 601030\n0000000000601030 g     O .data  0000000000000008              y\n</code></pre>\n\n<p>So the reference is from <code>y</code></p>\n\n<p>In my real case, the address is found in the <code>.dynsym</code> section, and <code>objdump -t</code> doesn't find any symbols there.</p>\n"}], "owner": {"reputation": 15037, "user_id": 1111371, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/85fbe34f335b26ff6f6c8ef921a682ae?s=128&d=identicon&r=PG", "display_name": "ugoren", "link": "https://stackoverflow.com/users/1111371/ugoren"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1361, "favorite_count": 1, "answer_count": 2, "score": 4, "last_activity_date": 1529491021, "creation_date": 1529487157, "question_id": 50944859, "link": "https://stackoverflow.com/questions/50944859/find-who-uses-a-symbol-in-an-elf-file", "title": "Find who uses a symbol in an ELF file", "body": "<p>I have a big binary, that contains a symbol. I can see the symbol in <code>nm</code> or <code>objdump</code>.<br>\nI know that the symbol is used, because otherwise the linker wouldn't include it (more precisely, I know that some symbol in the same source file is used).<br>\nI'm trying to find how exactly it's used.</p>\n\n<p>If the reference is by a function (e.g. function calling a function, function using global variatble), I can use <code>objdump -rd</code> to disassemble the file and find the reference.<br>\nBut if the reference is by a variable (e.g. a global pointer initialized to point to some variable), disassembly doesn't show it.<br>\nI failed to find any method that does.</p>\n\n<p>Here's an example that demonstrates it. In this example it's obvious who uses <code>x</code>, but I don't know how to examine the resulting binary and find it.</p>\n\n<pre><code>// x.c\nint x = 3;\n\n// main.c\nextern int x;\nstatic int *y = &amp;x;\nint main() { \n    return *y;\n}\n\n// Build process\ngcc -o x.o -c x.c\nar r libx.a x.o\ngcc -o main.o -c main.c\ngcc -o main main.o -L. -lx\n</code></pre>\n"}, {"tags": ["c", "list", "nodes"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1529485059, "post_id": 50944164, "comment_id": 88885698, "body": "If you program in C then please use only the C tag. C and C++, even though they share some syntax, are otherwise two <i>very</i> different languages."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2486888"}, "edited": false, "score": 2, "creation_date": 1529485062, "post_id": 50944164, "comment_id": 88885700, "body": "There is no such thing as &quot;C/C++&quot;. Use a real language."}, {"owner": {"reputation": 61304, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 2, "creation_date": 1529485075, "post_id": 50944164, "comment_id": 88885710, "body": "there is no language called C/C++. The code you have looks like C"}, {"owner": {"reputation": 61304, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 1, "creation_date": 1529485142, "post_id": 50944164, "comment_id": 88885754, "body": "...there should be a disclaimer for every question that tags C and C++, that would save us a lot of comments. And imho question containing the phrase C/C++ could be banned completely ;)"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1529485144, "post_id": 50944164, "comment_id": 88885756, "body": "And nowhere in your code do you have an <i>array</i>. What you have is a pretty standard implementation of a single-linked list."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2486888"}, "reply_to_user": {"reputation": 61304, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1529485248, "post_id": 50944164, "comment_id": 88885818, "body": "@user463035818 Or you can create a new language called &quot;C/C++&quot;, just to prank people who use the term."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1529485262, "post_id": 50944164, "comment_id": 88885826, "body": "Lastly about your problems, I suggest you <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">learn how to debug your programs</a>. Even some simple <a href=\"https://en.wikipedia.org/wiki/Rubber_duck_debugging\" rel=\"nofollow noreferrer\">rubber duck debugging</a> should make the problem in your append function quite clear."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1529485437, "post_id": 50944164, "comment_id": 88885940, "body": "Yeah... I looked for the expected realloc() where you make the pointer array longer so you can add new elements, but did not find it?   I don&#39;t see much correlation between your requirement and code?"}, {"owner": {"reputation": 61304, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1529485491, "post_id": 50944164, "comment_id": 88885978, "body": "@NickyC nice idea. It would be a true superset of C and C++ syntax-wise and consist of only undefined behaviour (would make it rather easy to write a standard and be just natural as <code>c&#47;c++</code> is ub in both languages afaik). Joking aside, its a pity that this term is used so often and we cannot blame someone who doesnt know better...."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1529485700, "post_id": 50944164, "comment_id": 88886089, "body": "<code>*n = NULL;</code> doesn&#39;t make any sense. This causes your function to always return NULL."}, {"owner": {"reputation": 11, "user_id": 9702610, "user_type": "registered", "profile_image": "https://graph.facebook.com/1758512767505499/picture?type=large", "display_name": "Irfan Mokhtar", "link": "https://stackoverflow.com/users/9702610/irfan-mokhtar"}, "edited": false, "score": 0, "creation_date": 1529488011, "post_id": 50944164, "comment_id": 88887680, "body": "Sorry, my bad. I&#39;m student who is very new to programming, and my lecturer use g++ while compiling his program. So I thought that he is using C++. Learned something new here. Thanks for the comments."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1529489779, "post_id": 50944164, "comment_id": 88888841, "body": "If you compile this as C++, it <b>is</b> C++! <b>Identical syntax does not imply identical semantics</b> Try removing the (in C) unnecessary and deprecated casts of <code>void *</code> on <code>malloc</code>. And if that&#39;s supposed to be a C course, get better lecturer, he doesn&#39;t know at least one of the language well enough to teach it. You wouldn&#39;t compile Java code with a Brainfuck compiler either."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1529489967, "post_id": 50944164, "comment_id": 88888935, "body": "@NickyC: I once proposed to create a <code>c&#47;c++</code> tag and automatically putting all tagged questions to hold and into a queue for clearance."}, {"owner": {"reputation": 61304, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1529490095, "post_id": 50944164, "comment_id": 88889004, "body": "@Olaf it is rare, but there are questions where both tags are relevant and putting those on hold would be a bit unfair imho"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 61304, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1529490133, "post_id": 50944164, "comment_id": 88889037, "body": "@user463035818: Hence the clearance queue! They are in fact very rare, so it would not be much of a loss. Most double-tagged are about how to call C functions from C++, which is a C++ vs. C ABI (`extern &quot;C&quot;) matter, not about the C language. We could take badged into account for the decission."}], "answers": [{"comments": [{"owner": {"reputation": 4107, "user_id": 9770840, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/984adcd06e81b4ed593225545018aacb?s=128&d=identicon&r=PG&f=1", "display_name": "Attersson", "link": "https://stackoverflow.com/users/9770840/attersson"}, "edited": false, "score": 0, "creation_date": 1529493720, "post_id": 50944348, "comment_id": 88891312, "body": "@ downvoter: please comment. I am open to amendments and constructive criticism."}], "tags": [], "owner": {"reputation": 4107, "user_id": 9770840, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/984adcd06e81b4ed593225545018aacb?s=128&d=identicon&r=PG&f=1", "display_name": "Attersson", "link": "https://stackoverflow.com/users/9770840/attersson"}, "is_accepted": true, "score": 0, "last_activity_date": 1529499471, "last_edit_date": 1529499471, "creation_date": 1529485572, "answer_id": 50944348, "question_id": 50944164, "link": "https://stackoverflow.com/questions/50944164/appending-a-node-to-an-array-of-pointer/50944348#50944348", "title": "Appending a node to an array of pointer", "body": "<p>Let's analyze this code:</p>\n\n<blockquote>\n<pre><code>struct NODE *next;\n\nwhile(node-&gt;next != NULL)\n{\n    node-&gt;next = next;\n}\n</code></pre>\n</blockquote>\n\n<p>First a pointer to <code>NODE</code> is declared, <code>next</code>, and never initialized. It points to a random location of memory. In general, better initialize everything.</p>\n\n<p><code>node</code>, passed as parameter, is the head of the list.</p>\n\n<p>At the first iteration, <code>node-&gt;next</code> is the second element of the list, clearly not null since the list should have 20 elements.</p>\n\n<p>To this element, you do assign <code>next</code>, which is uninitialized.</p>\n\n<p><strong>Undefined behaviour</strong> follows.</p>\n\n<p>At this point <code>node-&gt;next</code> is some random address, which could even be inaccessible by your process. <strong>The last node will be appended to this random memory location</strong> or crash.</p>\n\n<p>What you were after, is looping till the last element of the list. Therefore:</p>\n\n<pre><code>struct NODE *curr = node;\n\nwhile(curr-&gt;next != NULL)\n{\n    curr= curr-&gt;next;\n}\n</code></pre>\n\n<p>So <code>curr</code> will be the last node.</p>\n"}], "owner": {"reputation": 11, "user_id": 9702610, "user_type": "registered", "profile_image": "https://graph.facebook.com/1758512767505499/picture?type=large", "display_name": "Irfan Mokhtar", "link": "https://stackoverflow.com/users/9702610/irfan-mokhtar"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "closed_date": 1529497203, "accepted_answer_id": 50944348, "answer_count": 1, "score": -3, "last_activity_date": 1529683315, "creation_date": 1529484985, "last_edit_date": 1529683315, "question_id": 50944164, "link": "https://stackoverflow.com/questions/50944164/appending-a-node-to-an-array-of-pointer", "closed_reason": "Needs details or clarity", "title": "Appending a node to an array of pointer", "body": "<p>I'm currently studying data structure using C, and now assigned to create an list using pointer. Then I got a problem when trying to add a element into my created list. This is my code right now.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nstruct NODE\n{\n    int x;\n    char c;\n    struct NODE *next;\n};\nvoid make_list(struct NODE **n)\n{\n    for(int k = 0; k &lt; 20; k++)\n    {\n        *n = (struct NODE *)malloc(sizeof(struct NODE));\n        (*n)-&gt;x = k+1;\n        (*n)-&gt;c = 'A'+k;\n        n = &amp;(*n)-&gt;next;\n    }\n    *n = NULL;\n}\n\nvoid print_list(struct NODE *node)\n{\n    int k = 0;\n    printf(\"###### Content of list ######\\n\");\n\n    while(node != NULL)\n    {\n        printf(\"[%d]:x = %d, c = %c\\n\", k++, node-&gt;x, node-&gt;c);\n        node = node-&gt;next;\n    }\n}\n\nvoid append_last_node(struct NODE *node)\n{\n    struct NODE *next;\n\n    while(node-&gt;next != NULL)\n    {\n        node-&gt;next = next;\n    }\n\n    node-&gt;next = (struct NODE *)malloc(sizeof(struct NODE));\n\n    node-&gt;next-&gt;next = NULL;\n    node-&gt;next-&gt;x = 100;\n    node-&gt;next-&gt;c = 'a';\n}\n\nint main()\n{\n    struct NODE *n;\n\n    make_list(&amp;n);\n    print_list(n);\n\n    append_last_node(n);\n    print_list(n);\n\n    return 0;\n</code></pre>\n\n<p>Once I run this one, only the list that I had created in make_list function was printed while the append_last_node function was not printed and the process of execution does not automatically end after my list was printed.</p>\n\n<pre><code>###### Content of list ###### \n[0]:x = 1, c = A \n[1]:x = 2, c = B \n[2]:x = 3, c = C \n[3]:x = 4, c = D \n[4]:x = 5, c = E \n[5]:x = 6, c = F \n[6]:x = 7, c = G \n[7]:x = 8, c = H \n[8]:x = 9, c = I \n[9]:x = 10, c = J \n[10]:x = 11, c = K \n[11]:x = 12, c = L \n[12]:x = 13, c = M \n[13]:x = 14, c = N\n[14]:x = 15, c = O \n[15]:x = 16, c = P \n[16]:x = 17, c = Q \n[17]:x = 18, c = R \n[18]:x = 19, c = S \n[19]:x = 20, c = T\n</code></pre>\n\n<p>Is there any mistake in my append_last_node function or are there something that I am missing right there?</p>\n\n<p>P/S: Sorry for my bad English.</p>\n"}, {"tags": ["c", "image-processing", "flip"], "comments": [{"owner": {"reputation": 9953, "user_id": 8012206, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/z0Yl9.jpg?s=128&g=1", "display_name": "Joseph D.", "link": "https://stackoverflow.com/users/8012206/joseph-d"}, "edited": false, "score": 0, "creation_date": 1529484759, "post_id": 50944013, "comment_id": 88885535, "body": "so what&#39;s the question? flip vertical or flip horizontal?"}, {"owner": {"reputation": 1, "user_id": 4613757, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-hsCVyUXj1Bs/AAAAAAAAAAI/AAAAAAAAACo/XYQZWFrdP_A/photo.jpg?sz=128", "display_name": "Anthony Gladiator", "link": "https://stackoverflow.com/users/4613757/anthony-gladiator"}, "reply_to_user": {"reputation": 9953, "user_id": 8012206, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/z0Yl9.jpg?s=128&g=1", "display_name": "Joseph D.", "link": "https://stackoverflow.com/users/8012206/joseph-d"}, "edited": false, "score": 0, "creation_date": 1529484836, "post_id": 50944013, "comment_id": 88885583, "body": "Sorry its flip Horizontally."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 1, "creation_date": 1529485057, "post_id": 50944013, "comment_id": 88885696, "body": "To me your question is a bit unclear. But it seems to me that all you are looking for is <code>for(x = HEIGHT-1 ; x &gt;= 0; x--) {</code> and then have <code>y</code> to go from zero to WIDTH-1"}], "answers": [{"tags": [], "owner": {"reputation": 48421, "user_id": 1196549, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/fa597bf0dc47449a25e1f7f5b57e3ef1?s=128&d=identicon&r=PG", "display_name": "Yves Daoust", "link": "https://stackoverflow.com/users/1196549/yves-daoust"}, "is_accepted": false, "score": 1, "last_activity_date": 1529487478, "last_edit_date": 1529487478, "creation_date": 1529485777, "answer_id": 50944425, "question_id": 50944013, "link": "https://stackoverflow.com/questions/50944013/how-to-write-on-a-file-from-top-to-bottom-in-c/50944425#50944425", "title": "How to write on a file from Top to Bottom in C", "body": "<p>Beware that the terms that you use are very ambiguous. Flip vertically, flip horizontally can be understood two ways, as can top-to-bottom when speaking of a file.</p>\n\n<p>Hence I'll give a general answer.</p>\n\n<p>Assume you write the pixels in the usual scanning order, top row first, left pixel first, i.e. by addressing <code>Image[Column + Row * Pitch]</code> in a double loop (outer on <code>Row</code>, inner on <code>Column</code>). You can also reverse the loop traversal order.</p>\n\n<p>Then you will obtain a left-right mirroring (pixels move horizontally) by writing <code>Image[(Width - 1 - Column) + Row * Pitch]</code>, and a top-bottom mirroring (pixels move vertically) with <code>Image[Column + (Height - 1 - Row) * Pitch]</code>.</p>\n\n<p>You can combine the two modifications to achieve a 180\u00b0 rotation.</p>\n"}, {"tags": [], "owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "is_accepted": true, "score": 0, "last_activity_date": 1529486933, "creation_date": 1529486933, "answer_id": 50944788, "question_id": 50944013, "link": "https://stackoverflow.com/questions/50944013/how-to-write-on-a-file-from-top-to-bottom-in-c/50944788#50944788", "title": "How to write on a file from Top to Bottom in C", "body": "<p>When writing to a file would normally write data from start-of-file towards end-of-file. Writing in any other order will in most cases make your program more complicated and give worse performance.</p>\n\n<p>So what you need is to access your data in the correct order depending on how you want to flip the data.</p>\n\n<p>Something like:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#define WIDTH 2\n#define HEIGHT 3\n\nvoid print_element(char* p)\n{\n  // Here I just print to stdout but you can just save it to a file\n  printf(\"%c %c %c \", *p, *(p+1), *(p+2));\n}\n\nint main()\n{\n  char data[3 * HEIGHT][3 * WIDTH] = {{'a', 'b', 'c', 'd', 'e', 'f'},\n                                       {'g', 'h', 'i', 'j', 'k', 'l'},\n                                       {'m', 'n', 'o', 'p', 'q', 'r'}};\n\n  char* datap = (char*)data;\n  char* p;\n\n  printf(\"Normal\\n\");\n  for(int y = 0; y &lt; HEIGHT; y++)\n  {\n    for(int x = 0 ; x &lt; WIDTH; x++)\n    {\n        p = datap + ((WIDTH) * y * 3) + (x * 3);\n        print_element(p);\n    }\n    printf(\"\\n\");\n  }\n\n  printf(\"\\nFlip horizontal\\n\");\n  for(int y = HEIGHT-1 ; y &gt;= 0 ; y--)\n  {\n    for(int x = 0 ; x &lt; WIDTH; x++)\n    {\n      p = datap + ((WIDTH) * y * 3) + (x * 3);\n      print_element(p);\n    }\n    printf(\"\\n\");\n  }\n\n  printf(\"\\nFlip vertical\\n\");\n  for(int y = 0; y &lt; HEIGHT; y++)\n  {\n    for(int x =WIDTH-1; x &gt;= 0; x--)\n    {\n      p = datap + ((WIDTH) * y * 3) + (x * 3);\n      print_element(p);\n    }\n    printf(\"\\n\");\n  }\n\n  printf(\"\\nFlip both\\n\");\n  for(int y = HEIGHT-1 ; y &gt;= 0 ; y--)\n  {\n    for(int x = WIDTH-1; x &gt;= 0; x--)\n    {\n      p = datap + ((WIDTH) * y * 3) + (x * 3);\n      print_element(p);\n    }\n    printf(\"\\n\");\n  }\n\n  return 0;\n}\n</code></pre>\n\n<p>This will produce:</p>\n\n<pre><code>Normal\na b c d e f\ng h i j k l\nm n o p q r\n\nFlip horizontal\nm n o p q r\ng h i j k l\na b c d e f\n\nFlip vertical\nd e f a b c\nj k l g h i\np q r m n o\n\nFlip both\np q r m n o\nj k l g h i\nd e f a b c\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4613757, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-hsCVyUXj1Bs/AAAAAAAAAAI/AAAAAAAAACo/XYQZWFrdP_A/photo.jpg?sz=128", "display_name": "Anthony Gladiator", "link": "https://stackoverflow.com/users/4613757/anthony-gladiator"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 320, "favorite_count": 1, "accepted_answer_id": 50944788, "answer_count": 2, "score": 0, "last_activity_date": 1529487478, "creation_date": 1529484520, "last_edit_date": 1529484817, "question_id": 50944013, "link": "https://stackoverflow.com/questions/50944013/how-to-write-on-a-file-from-top-to-bottom-in-c", "title": "How to write on a file from Top to Bottom in C", "body": "<p>I would like to ask if its possible to write on a file from top to bottom?\n   The current code below will flip and image Vertically.\n   This uses left to right writing to a file.</p>\n\n<p>On the other hand, I am having problem on how would I do the flip image Horizontally if I follow the left to right pattern on writing to a file.\n<em>Note: I have other option here, which is to swap lines from top to bottom.</em></p>\n\n<p>Who knows maybe there's a way to follow the Vertical Flip pattern.</p>\n\n<p>I would appreciate any help you guys can give. Thanks. </p>\n\n<pre><code> //Flip Vertically\nfor(y = WIDTH-1 ; y &gt;= 0 ; y--) {\n    for(x = 0 ; x &lt; HEIGHT; x++) {\n\n        p = (unsigned char *)datap + ((WIDTH) * y * 3) + (x * 3); \n        // output pixel\n        if(fwrite(p, sizeof(char), 3, outfp) != 3) {\n            cleanUpBeforeExit(infp, outfp, datap, E_FILE_WRITE_ERROR);\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "assembly", "strlen"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 9, "creation_date": 1529482614, "post_id": 50943467, "comment_id": 88884345, "body": "The best is the <i>standard</i> <code>strlen</code> function."}, {"owner": {"reputation": 12144, "user_id": 72882, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9d17e71eae127205da470fffa2dba899?s=128&d=identicon&r=PG", "display_name": "dandan78", "link": "https://stackoverflow.com/users/72882/dandan78"}, "edited": false, "score": 2, "creation_date": 1529482633, "post_id": 50943467, "comment_id": 88884351, "body": "When asking people to look at working code, you should probably use the Code Review site."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 10, "creation_date": 1529482658, "post_id": 50943467, "comment_id": 88884365, "body": "As for what assembly code the compiler would translate it to, build both variants with optimizations enabled and compare."}, {"owner": {"reputation": 144, "user_id": 7055163, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/1Ftw9.jpg?s=128&g=1", "display_name": "Adminy", "link": "https://stackoverflow.com/users/7055163/adminy"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1529482737, "post_id": 50943467, "comment_id": 88884406, "body": "@Someprogrammerdude The Standard won&#39;t do for what I use them for."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 6, "creation_date": 1529482841, "post_id": 50943467, "comment_id": 88884459, "body": "The standard <code>strlen</code> function should be highly optimized, and as it&#39;s the <i>standard</i> function it should be available everywhere. It seems that you should probably ask a very different question, explaining your <i>actual</i> problem, and what you have tried to solve it. Don&#39;t forget to tell us <i>why</i> the standard function &quot;won&#39;t do&quot;."}, {"owner": {"reputation": 15145, "user_id": 4271923, "user_type": "registered", "profile_image": "https://graph.facebook.com/543414580/picture?type=large", "display_name": "Ped7g", "link": "https://stackoverflow.com/users/4271923/ped7g"}, "edited": false, "score": 6, "creation_date": 1529483212, "post_id": 50943467, "comment_id": 88884690, "body": "both will translate to very similar code, there&#39;s no particular point to bother with digging deeper into it, as from performance point of view both will be a bit worse than standard implementation, and from code size point of view they will be probably +-2B equal. If you would be going for really minimal code, you would write them in pure assembly. So I can&#39;t figure out, what you are actually trying to solve, because the question makes little sense, &quot;as is&quot; you are just wasting time, pick one variant randomly and use it. (like &quot;better&quot; in what sense??)"}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 2, "creation_date": 1529483575, "post_id": 50943467, "comment_id": 88884890, "body": "@Adminy What exactly doesn&#39;t the standard <code>strlen</code> function do that you need to be done?"}, {"owner": {"reputation": 579, "user_id": 2310837, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/31dd98bf2d532f8d0addfcb5665c3134?s=128&d=identicon&r=PG", "display_name": "joelfischerr", "link": "https://stackoverflow.com/users/2310837/joelfischerr"}, "edited": false, "score": 0, "creation_date": 1529484092, "post_id": 50943467, "comment_id": 88885161, "body": "Both functions run in O(n) time where n is the length of <code>*str</code>, i.e. linear in the length of the input string. So performance should be similar for long strings.  Taking a look behind the O-Notation we can see that Version 1 does one comparison and two additions per iteration. Version 2 only does one comparison and one addition and one subtraction at the end. We get 2n additions for version 1 and n + 1 additions for version 2. And n comparisons for both of them."}, {"owner": {"reputation": 15145, "user_id": 4271923, "user_type": "registered", "profile_image": "https://graph.facebook.com/543414580/picture?type=large", "display_name": "Ped7g", "link": "https://stackoverflow.com/users/4271923/ped7g"}, "reply_to_user": {"reputation": 579, "user_id": 2310837, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/31dd98bf2d532f8d0addfcb5665c3134?s=128&d=identicon&r=PG", "display_name": "joelfischerr", "link": "https://stackoverflow.com/users/2310837/joelfischerr"}, "edited": false, "score": 3, "creation_date": 1529484731, "post_id": 50943467, "comment_id": 88885517, "body": "@joelfischerr yup, but the modern compilers will optimize that out, so you can expect <i>n</i> comparisons and <i>n</i> additions only, nothing more. Code-size wise the second variant + clang-6.0.0 wins, but in terms of performance they are pretty much all equal (and that said, all of them are sub-optimal compared to standard one, which is probably using SSE/AVX to do about n/4 or n/8 comparisons using instructions operating over pack of values simultaneously). godbolt live used to compare code: <a href=\"https://godbolt.org/g/zyDj89\" rel=\"nofollow noreferrer\">godbolt.org/g/zyDj89</a>"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1529487096, "post_id": 50943467, "comment_id": 88887044, "body": "Rather, standard library strlen runs in &quot;O(n/align + some)&quot; time. glibc for example uses non-standard C to work with 32 bit chunks instead of 8 bit ones. Though if you would compile it with a standard compiler such as <code>gcc -std=c11</code>, glibc would invoke massive UB for these kind of functions. (Likely they compile with <code>-fno_strict_aliasing</code> and various other such non-standard settings.)"}, {"owner": {"reputation": 2572, "user_id": 5784350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1be79d2a9a367e3b66c42928c0b095a7?s=128&d=identicon&r=PG&f=1", "display_name": "Tommylee2k", "link": "https://stackoverflow.com/users/5784350/tommylee2k"}, "edited": false, "score": 0, "creation_date": 1529489532, "post_id": 50943467, "comment_id": 88888700, "body": "in fact it&#39;s <code>str++</code> + <code>retval++</code> vs <code>s++</code> Any new compiler will optimize it, using just <code>cmp byte ptr [ base + register ]</code> and a <code>inc register</code> inside the loop, question is: do you have an optimizing compiler?"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 2, "creation_date": 1529505297, "post_id": 50943467, "comment_id": 88899166, "body": "@Lundin: glibc&#39;s <code>strlen</code> implementations are hand-written in assembly, making it safe to do anything (and impossible for the optimizer to break anything, because there is no C definition to inline / link-time-optimize according to strict-aliasing rules, it&#39;s a pure blackbox.)  e.g. for x86 with AVX2, the main loop checks 2 whole cache lines at a time with 4x 32-byte YMM vectors: <a href=\"https://code.woboq.org/userspace/glibc/sysdeps/x86_64/multiarch/strlen-avx2.S.html\" rel=\"nofollow noreferrer\">code.woboq.org/userspace/glibc/sysdeps/x86_64/multiarch/&hellip;</a>, using <code>vpminub</code> to get vectors with a <code>0</code> where any one of the 4 input vectors had a <code>0</code> instead of pcmpeqb/pmovmskb separately."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 2572, "user_id": 5784350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1be79d2a9a367e3b66c42928c0b095a7?s=128&d=identicon&r=PG&f=1", "display_name": "Tommylee2k", "link": "https://stackoverflow.com/users/5784350/tommylee2k"}, "edited": false, "score": 2, "creation_date": 1529505575, "post_id": 50943467, "comment_id": 88899335, "body": "@Tommylee2k: Interestingly, gcc for x86 will actually use a pointer increment for one but an indexed addressing mode for the other (see Ped7g&#39;s Godbolt link).  This could be relevant for uop throughput in a hyperthreading situation (sharing a core with another thread), see <a href=\"https://stackoverflow.com/q/26046634\">Micro fusion and addressing modes</a>.  Also, <code>cmp [mem],imm</code> might not be able to macro-fuse with a jcc, or might not be able to micro-fuse.  Something like that, I forget."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1529509948, "post_id": 50943467, "comment_id": 88902296, "body": "@PeterCordes So all the people posting <a href=\"https://stackoverflow.com/questions/20021066/how-the-glibc-strlen-implementation-works\">this code</a> all over the internet are lying? Or it has been rewritten?"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1529510330, "post_id": 50943467, "comment_id": 88902562, "body": "@Lundin: Oops, yes glibc has a generic C implementation for platforms that don&#39;t have a hand-written asm version.  But it has hand-written for the major platforms, including ARM32/64, PowerPC.  Hmm, I don&#39;t see MIPS in the search box, and <a href=\"https://code.woboq.org/userspace/glibc/sysdeps/mips/\" rel=\"nofollow noreferrer\">code.woboq.org/userspace/glibc/sysdeps/mips</a> only has memcpy and some other things but not strlen.  So I guess it&#39;s used there.  It would be strict-aliasing safe if it loaded <code>long</code> using <code>memcpy</code> instead of pointer-casting, but that might hide the fact the pointer is aligned and not compile to an <code>lw</code> or <code>ld</code> (MIPS64 doubleword) instruction."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1529510544, "post_id": 50943467, "comment_id": 88902702, "body": "@Lundin: So probably it&#39;s safe because it can&#39;t inline from the library into code that stores with a different type.  A non-inline function call boundary is a compiler memory barrier, and makes strict-aliasing &quot;violations&quot; invisible.  (This is glibc code, so the set of compilers / platforms where it has to work is somewhat limited.)  It could well be unsafe if you made a static library with link-time optimization that could LTO with the program using it.  But glibc&#39;s build system doesn&#39;t do that."}, {"owner": {"reputation": 144, "user_id": 7055163, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/1Ftw9.jpg?s=128&g=1", "display_name": "Adminy", "link": "https://stackoverflow.com/users/7055163/adminy"}, "reply_to_user": {"reputation": 15145, "user_id": 4271923, "user_type": "registered", "profile_image": "https://graph.facebook.com/543414580/picture?type=large", "display_name": "Ped7g", "link": "https://stackoverflow.com/users/4271923/ped7g"}, "edited": false, "score": 0, "creation_date": 1529527371, "post_id": 50943467, "comment_id": 88910844, "body": "@Ped7g I like your side by side comparison answer, sorry guys I should have mentioned I was trying to use this with a compiler that is told not to load the standard libraries."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1529529658, "post_id": 50943467, "comment_id": 88911787, "body": "What architecture / compiler?  If you care about strlen performance, you shouldn&#39;t use a generic implementation anyway, and definitely not a one-byte-at-a-time loop (unfortunately compilers are not yet good enough to replace this code with something more efficient).  If you&#39;re writing a kernel, that might mean you can&#39;t use SIMD vector registers (which could speed this up by ~16x on typical x86 CPUs), but you can still do better than 1 byte per clock with glibc&#39;s generic implementation, for example (see Lundin&#39;s link above)."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1529529813, "post_id": 50943467, "comment_id": 88911866, "body": "And even if you do want to ask about these specific implementations, then the answer will depend on exactly how your compile compiles each.  One might be better with one compiler on one platform (e.g. where an indexed memory operand has no extra cost and the compiler compiles it that way) or the other might be better on other compiler + CPU combinations if it happens to lead the compiler into producing code that is slightly faster."}, {"owner": {"reputation": 579, "user_id": 2310837, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/31dd98bf2d532f8d0addfcb5665c3134?s=128&d=identicon&r=PG", "display_name": "joelfischerr", "link": "https://stackoverflow.com/users/2310837/joelfischerr"}, "reply_to_user": {"reputation": 15145, "user_id": 4271923, "user_type": "registered", "profile_image": "https://graph.facebook.com/543414580/picture?type=large", "display_name": "Ped7g", "link": "https://stackoverflow.com/users/4271923/ped7g"}, "edited": false, "score": 0, "creation_date": 1529587208, "post_id": 50943467, "comment_id": 88935457, "body": "@Ped7g Thanks for the explanation. I thought that there was still value in looking at how the code was written."}, {"owner": {"reputation": 144, "user_id": 7055163, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/1Ftw9.jpg?s=128&g=1", "display_name": "Adminy", "link": "https://stackoverflow.com/users/7055163/adminy"}, "reply_to_user": {"reputation": 15145, "user_id": 4271923, "user_type": "registered", "profile_image": "https://graph.facebook.com/543414580/picture?type=large", "display_name": "Ped7g", "link": "https://stackoverflow.com/users/4271923/ped7g"}, "edited": false, "score": 0, "creation_date": 1529590084, "post_id": 50943467, "comment_id": 88937502, "body": "@Ped7g Could you post it as an answer, I&#39;d really be happy with that as the answer."}, {"owner": {"reputation": 15145, "user_id": 4271923, "user_type": "registered", "profile_image": "https://graph.facebook.com/543414580/picture?type=large", "display_name": "Ped7g", "link": "https://stackoverflow.com/users/4271923/ped7g"}, "reply_to_user": {"reputation": 579, "user_id": 2310837, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/31dd98bf2d532f8d0addfcb5665c3134?s=128&d=identicon&r=PG", "display_name": "joelfischerr", "link": "https://stackoverflow.com/users/2310837/joelfischerr"}, "edited": false, "score": 0, "creation_date": 1530186786, "post_id": 50943467, "comment_id": 89152839, "body": "@joelfischerr well, there is certainly value to look at how code was written, and actually to write reasonably clean code, because the compiler has only limited machine time for its work, so the more the original source leads logically to efficient machine code, the more likely the optimizer will produce decent machine code. If the code is too complex/messy, the optimizer may fail to understand enough of it to remove the redundant parts within reasonable time/memory limits. But generally the compilers do good-enough job. Then there&#39;s this thing called &quot;profiling&quot; for the rest of it."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1530924533, "post_id": 50943467, "comment_id": 89419236, "body": "Related: <a href=\"https://stackoverflow.com/q/34449407\">Questions about the performance of different implementations of strlen</a> for a basic SIMD strlen for x86."}], "answers": [{"comments": [{"owner": {"reputation": 579, "user_id": 2310837, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/31dd98bf2d532f8d0addfcb5665c3134?s=128&d=identicon&r=PG", "display_name": "joelfischerr", "link": "https://stackoverflow.com/users/2310837/joelfischerr"}, "edited": false, "score": 1, "creation_date": 1529485895, "post_id": 50943595, "comment_id": 88886211, "body": "You have a hidden constant in the time complexity of the first version. It does twice as many additions. Which might be relevant if additions are expensive, but they are generally not so it most likely won&#39;t matter."}, {"owner": {"reputation": 85822, "user_id": 597607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jCzJi.png?s=128&g=1", "display_name": "Bo Persson", "link": "https://stackoverflow.com/users/597607/bo-persson"}, "reply_to_user": {"reputation": 579, "user_id": 2310837, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/31dd98bf2d532f8d0addfcb5665c3134?s=128&d=identicon&r=PG", "display_name": "joelfischerr", "link": "https://stackoverflow.com/users/2310837/joelfischerr"}, "edited": false, "score": 2, "creation_date": 1529493651, "post_id": 50943595, "comment_id": 88891262, "body": "@joelfischerr - You should not assume that the compiler translates the code literally. Check this question from yesterday <a href=\"https://stackoverflow.com/questions/50934651/understanding-what-clang-is-doing-in-assembly-decrementing-for-a-loop-that-is-i\">Understanding what clang is doing in assembly, decrementing for a loop that is incrementing</a>"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 3, "creation_date": 1529504918, "post_id": 50943595, "comment_id": 88898910, "body": "The question was about the constant factor, not the complexity class.  gcc compiles both of these about 16x slower (checking 1 byte at a time) than a good SIMD version on x86 (checking 16 bytes at a time with <code>pcmpeqb</code>/<code>pmovmskb</code>)."}], "tags": [], "owner": {"reputation": 4496, "user_id": 7277505, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jYwIw.jpg?s=128&g=1", "display_name": "Taohidul Islam", "link": "https://stackoverflow.com/users/7277505/taohidul-islam"}, "is_accepted": true, "score": 0, "last_activity_date": 1529483253, "last_edit_date": 1529483253, "creation_date": 1529483016, "answer_id": 50943595, "question_id": 50943467, "link": "https://stackoverflow.com/questions/50943467/do-both-of-these-strlen-functions-translate-to-the-same-assembly-code/50943595#50943595", "title": "Do both of these strlen functions translate to the same assembly code?", "body": "<p>Both of your function's time complexity is <code>O(n)</code>. So regarding performance on time theoretically both of them will take almost same time to compute. Though standard <code>strlen</code> function's time complexity is also <code>O(n)</code> but it may have more efficiency.\nHave a look at <a href=\"http://qa.geeksforgeeks.org/8275/qa.geeksforgeeks.org/8275/time-complexity-of-strlen-in-c\" rel=\"nofollow noreferrer\">this</a>.</p>\n"}], "owner": {"reputation": 144, "user_id": 7055163, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/1Ftw9.jpg?s=128&g=1", "display_name": "Adminy", "link": "https://stackoverflow.com/users/7055163/adminy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 150, "favorite_count": 0, "accepted_answer_id": 50943595, "answer_count": 1, "score": -3, "last_activity_date": 1529528690, "creation_date": 1529482531, "last_edit_date": 1529485724, "question_id": 50943467, "link": "https://stackoverflow.com/questions/50943467/do-both-of-these-strlen-functions-translate-to-the-same-assembly-code", "title": "Do both of these strlen functions translate to the same assembly code?", "body": "<p>I have 2 different versions of strlen which should do the same thing, but I'm not sure which one would be faster, more readable or more energy efficient.</p>\n\n<pre><code>//version 1\nsize_t strlen(const char *str) {\n   size_t retval;\n   for(retval = 0; *str != '\\0'; str++) retval++;\n   return retval;\n}\n\n//version2\nsize_t strlen(const char *str) {\n   const char *s;\n   for (s = str; *s; ++s);\n   return(s - str);\n}\n</code></pre>\n\n<p>Or would they just translate to the same assembly code?</p>\n"}, {"tags": ["c", "arrays", "printf", "memset"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1529485469, "post_id": 50943276, "comment_id": 88885964, "body": "You don&#39;t need to do anything with you buffer prior to calling <code>sprintf</code> or <code>snprintf</code>. You don&#39;t call <code>memset</code> either before using <code>strcpy</code>, do you?"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1529485737, "post_id": 50943276, "comment_id": 88886109, "body": "@snr The reason is explained in the answer below."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1529486892, "post_id": 50943276, "comment_id": 88886897, "body": "Strange question for someone with &gt;3k of reputation and lots of answers to C tagged questions."}, {"owner": {"reputation": 13191, "user_id": 4990642, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/xY0PD.jpg?s=128&g=1", "display_name": "snr", "link": "https://stackoverflow.com/users/4990642/snr"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1529487852, "post_id": 50943276, "comment_id": 88887562, "body": "@Jabberwocky &lt;  There were some points I overlooked and realize later on. It may be not important so much, but I engage in concurrent programming with signals nowadays to learn. Small things sometimes result in big results."}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1529501997, "post_id": 50943276, "comment_id": 88896832, "body": "Perhaps you&#39;re confusing with <code>strncpy()</code> - which doesn&#39;t write a NUL if it fills the output buffer."}, {"owner": {"reputation": 13191, "user_id": 4990642, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/xY0PD.jpg?s=128&g=1", "display_name": "snr", "link": "https://stackoverflow.com/users/4990642/snr"}, "reply_to_user": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1529504530, "post_id": 50943276, "comment_id": 88898646, "body": "@TobySpeight &lt; Thanks indeed."}], "answers": [{"comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 13191, "user_id": 4990642, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/xY0PD.jpg?s=128&g=1", "display_name": "snr", "link": "https://stackoverflow.com/users/4990642/snr"}, "edited": false, "score": 0, "creation_date": 1529485691, "post_id": 50943377, "comment_id": 88886082, "body": "@snr <i>sprintf doesn&#39;t put null terminator</i>: if this is the case, then either your implementation of <code>sprintf</code> is broken, or your progam did something bad beforehand leading to undefined behaviour. Please edit your question and post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 13191, "user_id": 4990642, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/xY0PD.jpg?s=128&g=1", "display_name": "snr", "link": "https://stackoverflow.com/users/4990642/snr"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1529485889, "post_id": 50943377, "comment_id": 88886207, "body": "@Jabberwocky it is cuz lack of my knowledge, sprintf also is null terminated."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 13191, "user_id": 4990642, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/xY0PD.jpg?s=128&g=1", "display_name": "snr", "link": "https://stackoverflow.com/users/4990642/snr"}, "edited": false, "score": 0, "creation_date": 1529485945, "post_id": 50943377, "comment_id": 88886243, "body": "@snr <code>sprintf</code> and <code>snprintf</code> are very similar, both do <code>NUL</code> terminate the string."}], "tags": [], "owner": {"reputation": 17170, "user_id": 1671066, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/bd4c9461f2d17a884fba66eeed20e320?s=128&d=identicon&r=PG", "display_name": "Micha Wiedenmann", "link": "https://stackoverflow.com/users/1671066/micha-wiedenmann"}, "is_accepted": true, "score": 3, "last_activity_date": 1529482237, "creation_date": 1529482237, "answer_id": 50943377, "question_id": 50943276, "link": "https://stackoverflow.com/questions/50943276/do-snprintf-internally-call-memset-or-similar/50943377#50943377", "title": "do snprintf() internally call memset() or similar?", "body": "<p>From <a href=\"http://www.cplusplus.com/reference/cstdio/snprintf/\" rel=\"nofollow noreferrer\">snprintf</a>:</p>\n\n<blockquote>\n  <p>A terminating null character is automatically appended after the content written.</p>\n</blockquote>\n\n<p>If you were to inspect the buffer, you would find </p>\n\n<pre><code>{ 's', 'o', 'n', 'e', 'r', '\\0', 'v', 'e', 'r', /* ... */ }\n</code></pre>\n"}], "owner": {"reputation": 13191, "user_id": 4990642, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/xY0PD.jpg?s=128&g=1", "display_name": "snr", "link": "https://stackoverflow.com/users/4990642/snr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 821, "favorite_count": 0, "accepted_answer_id": 50943377, "answer_count": 1, "score": 0, "last_activity_date": 1529482237, "creation_date": 1529481928, "question_id": 50943276, "link": "https://stackoverflow.com/questions/50943276/do-snprintf-internally-call-memset-or-similar", "title": "do snprintf() internally call memset() or similar?", "body": "<p>I'm cognizant of using <code>snprintf()</code> in lieu of <code>sprintf()</code> for safety. However, I always do <code>memset()</code> on buffer used by <code>snprintf()</code>. I saw some codes using the function without <code>memset()</code>. And, it works as expected. I mean there is no overwriting on the buffer. Let me exemplify,</p>\n\n<pre><code>char str[100];\nsnprintf(str, sizeof(str), \"stackoverflow %zu\", sizeof(str));\nfprintf(stderr, \"%s\\n\", str);\n\nsnprintf(str, sizeof(str), \"soner\");\nfprintf(stderr, \"%s\\n\", str);\n</code></pre>\n\n<p>Until now, I thought that the code would print <code>soneroverflow 100</code> that's why I used <code>memset()</code>. Nevertheless, it prints <code>soner</code>. How is it done underhood? By the way, same thing is applied for <code>sprintf()</code>.</p>\n"}, {"tags": ["c++", "c", "linux", "network-programming"], "comments": [{"owner": {"reputation": 294, "user_id": 2007980, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1gEDH.gif?s=128&g=1", "display_name": "schaiba", "link": "https://stackoverflow.com/users/2007980/schaiba"}, "edited": false, "score": 0, "creation_date": 1529482107, "post_id": 50943190, "comment_id": 88884030, "body": "Please provide some code that shows that you at least tried to do something. Also post any errors, if any. Help us help you."}, {"owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "edited": false, "score": 0, "creation_date": 1529488938, "post_id": 50943190, "comment_id": 88888329, "body": "Which version of Ubuntu? It matters."}], "answers": [{"tags": [], "owner": {"reputation": 7193, "user_id": 765971, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2f390fb2ccc9321e41ca5bcd09cb9a9a?s=128&d=identicon&r=PG", "display_name": "SKi", "link": "https://stackoverflow.com/users/765971/ski"}, "is_accepted": true, "score": 5, "last_activity_date": 1529484172, "creation_date": 1529484172, "answer_id": 50943914, "question_id": 50943190, "link": "https://stackoverflow.com/questions/50943190/detect-network-interface-change/50943914#50943914", "title": "detect network interface change", "body": "<p>You can poll status of links with <code>ioctl()</code>:</p>\n\n<pre><code>struct ifreq ifr;\n\nmemset(&amp;ifr, 0, sizeof(ifr));\nstrcpy(ifr.ifr_name, \"eth0\");\n\nif (ioctl(fd, SIOCGIFFLAGS, &amp;ifr) != -1)\n{\n    up_and_running = (ifr.ifr_flags &amp; ( IFF_UP | IFF_RUNNING )) == ( IFF_UP | IFF_RUNNING );\n}\n</code></pre>\n\n<p>If you want immediately information about changes,\nthen listen netlink messages from kernel.</p>\n\n<p>See man page <a href=\"http://man7.org/linux/man-pages/man7/netlink.7.html\" rel=\"noreferrer\">PF_NETLINK(7)</a>.</p>\n\n<p>For creating AF_NETLINK socket for getting link events:</p>\n\n<pre><code>const int netlink_fd = socket(AF_NETLINK, SOCK_RAW, NETLINK_ROUTE);\nif (netlink_fd != -1)\n{\n    struct sockaddr_nl sa;\n\n    memset(&amp;sa, 0, sizeof(sa));\n    sa.nl_family = AF_NETLINK;\n    sa.nl_groups = RTNLGRP_LINK;\n    bind(netlink_fd, (struct sockaddr*)&amp;sa, sizeof(sa));\n}\n</code></pre>\n\n<p>..And receive and handle messages however you want.</p>\n\n<p>There is a library <a href=\"https://www.infradead.org/~tgr/libnl/\" rel=\"noreferrer\">libnl</a> for making that easier.</p>\n"}], "owner": {"reputation": 35, "user_id": 4768978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc78d31cd4558a14712cf05ebb66efa?s=128&d=identicon&r=PG&f=1", "display_name": "raj", "link": "https://stackoverflow.com/users/4768978/raj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1231, "favorite_count": 1, "accepted_answer_id": 50943914, "answer_count": 1, "score": 1, "last_activity_date": 1529484172, "creation_date": 1529481624, "last_edit_date": 1529482278, "question_id": 50943190, "link": "https://stackoverflow.com/questions/50943190/detect-network-interface-change", "title": "detect network interface change", "body": "<p>My UBUNTU machine is having two network interface ports. I want to write an application in C/C++ where I can detect changes in network interface and print the result.</p>\n\n<p>e.g. When two network cables are connected then application should print both interfaces are up.\nWhen I unplug one cable then application should remove all information of that interface and print which interface is down and up.  </p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1529481779, "post_id": 50943148, "comment_id": 88883851, "body": "In the second example, <code>getchar()</code> will receive the <i>next character</i> from the stream, which will be a <i>space</i>!"}, {"owner": {"reputation": 494, "user_id": 1383880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/258c2172c30ab4b732d6fb83ffb2c586?s=128&d=identicon&r=PG", "display_name": "CannedMoose", "link": "https://stackoverflow.com/users/1383880/cannedmoose"}, "edited": false, "score": 0, "creation_date": 1529481781, "post_id": 50943148, "comment_id": 88883852, "body": "You can simply search the internet about what these functions do. Is it easier to post a question here?"}, {"owner": {"reputation": 31, "user_id": 9421924, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-u0xBSypkmvw/AAAAAAAAAAI/AAAAAAAAACI/GNo8awCi6mc/photo.jpg?sz=128", "display_name": "LIFE", "link": "https://stackoverflow.com/users/9421924/life"}, "edited": false, "score": 0, "creation_date": 1529481945, "post_id": 50943148, "comment_id": 88883934, "body": "My question is &quot;Doesn`t the stream get only one character?&quot;"}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1529483978, "post_id": 50943148, "comment_id": 88885101, "body": "Your question should be, &quot;Do these <i>functions</i> get only one character?&quot;, and that is best answered by their documentation. <a href=\"http://en.cppreference.com/w/c/io/getchar\" rel=\"nofollow noreferrer\"><code>getchar()</code></a> and <a href=\"http://en.cppreference.com/w/c/io/fgetc\" rel=\"nofollow noreferrer\"><code>fgetc()</code></a>"}, {"owner": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 2, "creation_date": 1529485400, "post_id": 50943148, "comment_id": 88885910, "body": "The characters you hit on your keyboard are not given to your program until you hit the Enter key, and hitting that Enter key will also produce a newline on your terminal (At least normally that is the case, this depends on how you run your program)"}], "answers": [{"tags": [], "owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "is_accepted": false, "score": 0, "last_activity_date": 1529488425, "last_edit_date": 1529488425, "creation_date": 1529486847, "answer_id": 50944749, "question_id": 50943148, "link": "https://stackoverflow.com/questions/50943148/about-stream-and-getchar-and-fgetc/50944749#50944749", "title": "About Stream and getchar() and fgetc()", "body": "<p>These three calls are, by definition, identical:</p>\n\n<pre><code>getchar()\ngetc(stdin)\nfgetc(stdin)\n</code></pre>\n\n<p>So the program you posted is exactly equivalent to</p>\n\n<pre><code>ch1 = getchar();\nch2 = getchar();\n\nputchar(ch1);\nputchar(ch2);\n</code></pre>\n\n<p>If you're puzzled about how this program works, it's not because of any difference between <code>getchar</code>/<code>fgetc</code> or <code>putchar</code>/<code>putc</code>.</p>\n\n<p>If you run this program and then press <strong>p</strong> and the enter key, I would expect <code>ch1</code> to end up containing <code>'p'</code>, and <code>ch2</code> to end up containing the newline character.  If you run this program and type \"a b\" and press the enter key, I would expect <code>ch1</code> to end up containing <code>'a'</code>, and <code>ch2</code> to end up containing the space character.  I would not expect this program to be able to print \"<code>a b</code>\", because it can only read and print two characters.</p>\n\n<p>It's always tricky to think about character-by-character reading at first.  This is because, behind the scenes, the system is typically reading a whole <em>line</em> of text as you type, and then making the characters available to your program only after you press the Enter key.</p>\n\n<p>It's easier to see what's going on if you print out a bit more information.  For example, here is a modification of your program:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main()\n{\n    int ch1, ch2;\n\n    ch1 = fgetc(stdin);\n    ch2 = getchar();\n\n    fprintf(stdout, \"ch1 = '%c'\\n\", ch1);\n    printf(\"ch2 = '%c'\\n\", ch2);\n}\n</code></pre>\n\n<p>When I run this program and hit <strong>p</strong> and the Enter key, I see</p>\n\n<pre><code>ch1 = 'p'\nch2 = '\n'\n</code></pre>\n\n<p>As you can see, <code>ch2</code> ended up containing the newline character.</p>\n\n<p>When I run this program and hit <strong>a</strong> and a space and <strong>b</strong> and the Enter key, I see</p>\n\n<pre><code>ch1 = 'a'\nch2 = ' '\n</code></pre>\n\n<p>Well, more precisely, what I see is</p>\n\n<pre><code>a b\nch1 = 'a'\nch2 = ' '\n</code></pre>\n\n<p>But that first line <code>a b</code> is just where my computer echoed the characters as I typed them.  (See also <a href=\"https://www.eskimo.com/~scs/cclass/notes/sx6b.html\" rel=\"nofollow noreferrer\">this web page</a>, and especially the paragraph beginning \"Finally, don't be disappointed\".)</p>\n\n<p>Again, there's no important difference between <code>fgetc(stdin)</code> and <code>getchar</code> here.  I could have written</p>\n\n<pre><code>ch1 = getchar();\nch2 = getchar();\n\nprintf(\"ch1 = '%c'\\n\", ch1);\nprintf(\"ch2 = '%c'\\n\", ch2);\n</code></pre>\n\n<p>and it would have done just the same thing.</p>\n\n<p>Finally, it will probably help you see things more clearly if you write a program that reads and prints a whole <em>line</em> of characters.  Your first program read exactly two characters.  Here's a program that keeps reading and printing until it sees the <code>'\\n'</code> character that marks the end of the line:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main()\n{\n    int c;\n\n    c = getchar();\n    while(c != '\\n') {\n        printf(\"c = '%c'\\n\", c);\n        c = getchar();\n    }\n}\n</code></pre>\n\n<p>This program reads one character.  If it's not the newline character <code>\\n</code>, it prints it and reads another character.  If that's not the newline character, it prints it and reads another character.  It keeps reading and printing until it sees a newline character, then stops.  If I run this and type \"a b c\", I see</p>\n\n<pre><code>c = 'a'\nc = ' '\nc = 'b'\nc = ' '\nc = 'c'\n</code></pre>\n\n<p>(I don't see a line printed for the newline character, because this program stops reading immediately after it reads the newline character, and before it prints it.)</p>\n\n<p>Again, what I actually see on my screen is</p>\n\n<pre><code>a b c\nc = 'a'\nc = ' '\nc = 'b'\nc = ' '\nc = 'c'\n</code></pre>\n\n<p>but that first line <code>a b c</code> is just me typing the characters, before the program has a chance to read and print any of them.</p>\n\n<p>Even for a simple test like this, I would never write the program quite that way, though.  I would write the loop as</p>\n\n<pre><code>while(c != '\\n' &amp;&amp; c != EOF) {\n    ...\n</code></pre>\n\n<p>because I would also want to make sure that the program stopped reading if it saw an end-of-file condition, that is, if <code>getchar</code> returned the special code <code>EOF</code>.</p>\n"}], "owner": {"reputation": 31, "user_id": 9421924, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-u0xBSypkmvw/AAAAAAAAAAI/AAAAAAAAACI/GNo8awCi6mc/photo.jpg?sz=128", "display_name": "LIFE", "link": "https://stackoverflow.com/users/9421924/life"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 316, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1529488425, "creation_date": 1529481495, "last_edit_date": 1529481824, "question_id": 50943148, "link": "https://stackoverflow.com/questions/50943148/about-stream-and-getchar-and-fgetc", "title": "About Stream and getchar() and fgetc()", "body": "<pre><code>#include&lt;stdio.h&gt;\n\nint main(void)\n{\n    int ch1, ch2;\n\n    ch1 = fgetc(stdin);\n    ch2 = getchar();\n\n    fputc(ch1, stdout);\n    putchar(ch2);\n\n    return 0;\n}\n</code></pre>\n\n<p>today I first learn about stream. I understood what stream is. But I can`t understood print result of this program. \nI pressed 'p' and enter key. And this program printed </p>\n\n<p><strong>p</strong> <br/>\np <br/>\nPress any key to continue...</p>\n\n<p>In book which i read, It said \"enter key is a kind of ascii code, so you can see this result.\" But in front page, it said getchar and fgetc is a function that receive a character. But why it doesn`t print like</p>\n\n<p><strong>a b</strong> <br/>\na\nb</p>\n\n<p>when i press 'a', space bar and 'b'?</p>\n\n<p>May i know about stream and this two functions( getchar() and fgetc() )?</p>\n"}, {"tags": ["c", "function", "parameters", "segmentation-fault"], "comments": [{"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 1, "creation_date": 1529481084, "post_id": 50942985, "comment_id": 88883418, "body": "On which line? (Yes, you should find that out on your own.)"}, {"owner": {"reputation": 494, "user_id": 1383880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/258c2172c30ab4b732d6fb83ffb2c586?s=128&d=identicon&r=PG", "display_name": "CannedMoose", "link": "https://stackoverflow.com/users/1383880/cannedmoose"}, "edited": false, "score": 0, "creation_date": 1529481102, "post_id": 50942985, "comment_id": 88883430, "body": "What is the error and where does it happen?"}, {"owner": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 0, "creation_date": 1529481111, "post_id": 50942985, "comment_id": 88883439, "body": "<code>printf(&quot;%s\\n&quot;, *fileName);</code> is already wrong, <code>*fileName</code> returns a <code>char</code>, but <code>%s</code> expects a <code>char*</code>"}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "reply_to_user": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 0, "creation_date": 1529481188, "post_id": 50942985, "comment_id": 88883487, "body": "As @UnholySheep says. Change to <code>printf(&quot;%s\\n&quot;, fileName)</code>"}, {"owner": {"reputation": 57, "user_id": 4327115, "user_type": "registered", "profile_image": "https://graph.facebook.com/100002170390790/picture?type=large", "display_name": "Inchan Hwang", "link": "https://stackoverflow.com/users/4327115/inchan-hwang"}, "edited": false, "score": 0, "creation_date": 1529484181, "post_id": 50942985, "comment_id": 88885205, "body": "I am sorry!! I deleted it. I put there for debugging purpose. I made that mistake.  I feel difficulty setting up gdb over Visual Studio Code with Makefile project. I am sorry I could not point out the exact error point. Windows GDB says that &quot;if(strcmp(tmpRetValue, extensions[i]) == 0)&quot; currently causes a problem."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1529484503, "post_id": 50942985, "comment_id": 88885378, "body": "<code>if(strcmp(tmpRetValue, extensions[i]) == 0)</code> You should be aware that <code>strstr</code> will return <code>NULL</code> in most cases."}, {"owner": {"reputation": 57, "user_id": 4327115, "user_type": "registered", "profile_image": "https://graph.facebook.com/100002170390790/picture?type=large", "display_name": "Inchan Hwang", "link": "https://stackoverflow.com/users/4327115/inchan-hwang"}, "edited": false, "score": 0, "creation_date": 1529484673, "post_id": 50942985, "comment_id": 88885480, "body": "is there any better way to extract substring out of the whole string, then?"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1529484703, "post_id": 50942985, "comment_id": 88885494, "body": "No, that&#39;s perfectly fine. You just need to check the return value before further comparing is done..."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 1, "creation_date": 1529488243, "post_id": 50942985, "comment_id": 88887852, "body": "Furthermore, <b>tutorialspoint</b> is not <b>the</b> documentation. I wouldn&#39;t consider using it even as <i>a</i> documentation."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1529488361, "post_id": 50942985, "comment_id": 88887926, "body": "Also, your <code>const char* extensions[] = {&quot;.iexe&quot;, &quot;.doc&quot;, &quot;.xls&quot;, &quot;.ppt&quot;, &quot;.txt&quot;, &quot;.jpg&quot;, &quot;.eml&quot;, &quot;.log&quot;};</code> would need to create a new const array every time. You want <code>static const char *</code> here."}, {"owner": {"reputation": 57, "user_id": 4327115, "user_type": "registered", "profile_image": "https://graph.facebook.com/100002170390790/picture?type=large", "display_name": "Inchan Hwang", "link": "https://stackoverflow.com/users/4327115/inchan-hwang"}, "edited": false, "score": 0, "creation_date": 1529488854, "post_id": 50942985, "comment_id": 88888267, "body": "Thank you for the advice! Antti Haapala"}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1529505299, "post_id": 50942985, "comment_id": 88899168, "body": "You need a better library reference.  For example, CPPReference says &quot;<i>Return value: Pointer to the first character of the found substring in <code>str</code>, or <b><code>NULL</code> if no such character is found</b>.</i>&quot;.  (My emphasis)"}, {"owner": {"reputation": 8919, "user_id": 8873508, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2uDHi.png?s=128&g=1", "display_name": "p-a-o-l-o", "link": "https://stackoverflow.com/users/8873508/p-a-o-l-o"}, "edited": false, "score": 0, "creation_date": 1529594226, "post_id": 50942985, "comment_id": 88940516, "body": "I think you should check that for loop, because <code>sizeof(extensions)&#47;sizeof(const char *)</code> boils down to <code>1</code> on 64 bit platforms and to <code>2</code> on 32 bit ones ..."}], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 4327115, "user_type": "registered", "profile_image": "https://graph.facebook.com/100002170390790/picture?type=large", "display_name": "Inchan Hwang", "link": "https://stackoverflow.com/users/4327115/inchan-hwang"}, "edited": false, "score": 0, "creation_date": 1529484610, "post_id": 50943057, "comment_id": 88885443, "body": "I deleted that line.. Thank you for pointing it out"}], "tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": false, "score": 1, "last_activity_date": 1529481187, "creation_date": 1529481187, "answer_id": 50943057, "question_id": 50942985, "link": "https://stackoverflow.com/questions/50942985/segmentation-fault-while-calling-a-self-made-c-function/50943057#50943057", "title": "segmentation fault while calling a self-made C function", "body": "<p>The problem is most likely here:</p>\n\n<pre><code>printf(\"%s\\n\", *fileName);\n</code></pre>\n\n<p>The variable <code>fileName</code> is a pointer to <code>char</code>. Just the type expected when printing a string using the <code>\"%s\"</code> format. However, you dereference the pointer, which result in passing the first character in the string to the <code>\"%s\"</code> format. The expression <code>*fileName</code> is the same as <code>fileName[0]</code>. It's a single <code>char</code> element.</p>\n\n<p>Mismatching format specifier and argument leads to <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\"><em>undefined behavior</em></a>, which is a common cause for crashes like yours.</p>\n"}, {"comments": [{"owner": {"reputation": 57, "user_id": 4327115, "user_type": "registered", "profile_image": "https://graph.facebook.com/100002170390790/picture?type=large", "display_name": "Inchan Hwang", "link": "https://stackoverflow.com/users/4327115/inchan-hwang"}, "edited": false, "score": 0, "creation_date": 1529487523, "post_id": 50944041, "comment_id": 88887321, "body": "Why does it return NULL? According to the doc, it never returns NULL. Read <a href=\"https://www.tutorialspoint.com/c_standard_library/c_function_strstr.htm\" rel=\"nofollow noreferrer\">tutorialspoint.com/c_standard_library/c_function_strstr.htm</a>"}, {"owner": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "reply_to_user": {"reputation": 57, "user_id": 4327115, "user_type": "registered", "profile_image": "https://graph.facebook.com/100002170390790/picture?type=large", "display_name": "Inchan Hwang", "link": "https://stackoverflow.com/users/4327115/inchan-hwang"}, "edited": false, "score": 0, "creation_date": 1529491172, "post_id": 50944041, "comment_id": 88889706, "body": "@InchanHwang In the &quot;Return Value&quot; chapter of your link, it says right there: &quot;or a null pointer if the sequence is not present in haystack.&quot; So for example, if you call <code>strstr(&quot;Essay.doc&quot;, &quot;.exe&quot;)</code> , then strstr returns a NULL pointer, since &quot;.exe&quot; is not found in the &quot;Essay.doc&quot; string."}, {"owner": {"reputation": 57, "user_id": 4327115, "user_type": "registered", "profile_image": "https://graph.facebook.com/100002170390790/picture?type=large", "display_name": "Inchan Hwang", "link": "https://stackoverflow.com/users/4327115/inchan-hwang"}, "edited": false, "score": 0, "creation_date": 1529492517, "post_id": 50944041, "comment_id": 88890562, "body": "Thank you! English is not my 1st language. I sometimes omit details."}], "tags": [], "owner": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "is_accepted": true, "score": 1, "last_activity_date": 1529484612, "creation_date": 1529484612, "answer_id": 50944041, "question_id": 50942985, "link": "https://stackoverflow.com/questions/50942985/segmentation-fault-while-calling-a-self-made-c-function/50944041#50944041", "title": "segmentation fault while calling a self-made C function", "body": "<p>You have to check the return value of your <code>strstr</code> call. If <code>strstr</code> returns NULL, you cannot pass that to <code>strcmp</code> . You need to do e.g.</p>\n\n<pre><code>tmpRetValue = strstr(fName, extensions[i]);\nif(tmpRetValue != NULL &amp;&amp; strcmp(tmpRetValue, extensions[i]) == 0)\n{\n       finalRetValue = extensions[i];\n}\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 4327115, "user_type": "registered", "profile_image": "https://graph.facebook.com/100002170390790/picture?type=large", "display_name": "Inchan Hwang", "link": "https://stackoverflow.com/users/4327115/inchan-hwang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 1, "closed_date": 1529486686, "accepted_answer_id": 50944041, "answer_count": 2, "score": 0, "last_activity_date": 1529488605, "creation_date": 1529480952, "last_edit_date": 1529488605, "question_id": 50942985, "link": "https://stackoverflow.com/questions/50942985/segmentation-fault-while-calling-a-self-made-c-function", "closed_reason": "Not suitable for this site", "title": "segmentation fault while calling a self-made C function", "body": "<pre><code>#include &lt;string.h&gt;\n#include &lt;time.h&gt;\n#include &lt;stdio.h&gt;\n\nstatic char* extensionSearch(char * fileName){\n    const char* extensions[] = {\".exe\", \".doc\", \".xls\", \".ppt\", \".txt\", \".jpg\", \".eml\", \".log\"};\n\n    char * fName = fileName;\n    char* tmpRetValue = \"\";\n    char* finalRetValue = \"noExt\";\n    for(int i=0; i&lt;sizeof(extensions)/sizeof(const char *); i ++)\n    {\n        tmpRetValue = strstr(fName, extensions[i]);\n        if(strcmp(tmpRetValue, extensions[i]) == 0)\n        {\n            finalRetValue = extensions[i];\n        }\n\n\n    }\n    return finalRetValue;\n}\n\nint main () {\n    char* fileExt = extensionSearch(\"great.exe\");\n}\n</code></pre>\n\n<p>This is a self-made C function. I am calling it </p>\n\n<p>And it causes a segmentation fault. \nThe reason the segment fault occurs is that strstr() returns NULL, But when I read the doc \"<a href=\"https://www.tutorialspoint.com/c_standard_library/c_function_strstr.htm\" rel=\"nofollow noreferrer\">https://www.tutorialspoint.com/c_standard_library/c_function_strstr.htm</a>,\" it never returns NULL. Why does it return NULL?</p>\n\n<p>The function gets a filename and checks whether it has one of those extensions in the function. If it has one, it returns the file extension.</p>\n"}, {"tags": ["c", "linux", "inotify"], "answers": [{"tags": [], "owner": {"reputation": 9079, "user_id": 73299, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/ae887ea49a5c212e2ab407d90eba4c8c?s=128&d=identicon&r=PG", "display_name": "tstenner", "link": "https://stackoverflow.com/users/73299/tstenner"}, "is_accepted": false, "score": 0, "last_activity_date": 1529480837, "creation_date": 1529480837, "answer_id": 50942955, "question_id": 50942687, "link": "https://stackoverflow.com/questions/50942687/inotify-monitoring-only-some-files-inside-a-folder/50942955#50942955", "title": "Inotify: monitoring only some files inside a folder", "body": "<p>You can't exclude files, but you could only subscribe to create/delete events for the folder and add more fine-grained watches (i.e. also modifications) for individual files via <code>inotify_add_watch</code>.</p>\n"}], "owner": {"reputation": 1, "user_id": 9535207, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Patrizia Orioli", "link": "https://stackoverflow.com/users/9535207/patrizia-orioli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 157, "favorite_count": 1, "answer_count": 1, "score": -1, "last_activity_date": 1529480837, "creation_date": 1529479972, "last_edit_date": 1529480737, "question_id": 50942687, "link": "https://stackoverflow.com/questions/50942687/inotify-monitoring-only-some-files-inside-a-folder", "title": "Inotify: monitoring only some files inside a folder", "body": "<p>I'm writing a simple thread in C to monitor the modification to files inside a directory. There are several files inside the directory and some of them change frequently. I want to monitor few specific files.</p>\n\n<p>I read carefully the Linux manual but I didn't find the answer\nThanks\nRegards\nPatrizia</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 0, "creation_date": 1529477377, "post_id": 50940735, "comment_id": 88881363, "body": "Try either <code>j++</code> or <code>j = j + 1</code>, <i>not</i> <code>j = j++</code>"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 2, "creation_date": 1529478019, "post_id": 50940735, "comment_id": 88881684, "body": "Out of interest, is <code>j = ++j</code> now well-defined in C? It is in C++, from C++11."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 0, "creation_date": 1529479252, "post_id": 50940735, "comment_id": 88882342, "body": "@SanderDeDycker: Thanks - good to know for those pub quizzes."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "reply_to_user": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 0, "creation_date": 1529479673, "post_id": 50940735, "comment_id": 88882582, "body": "@SanderDeDycker no it didn&#39;t."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1529479781, "post_id": 50940735, "comment_id": 88882648, "body": "<a href=\"http://port70.net/~nsz/c/c11/n1570.html#note84\" rel=\"nofollow noreferrer\">See the footnote 84</a>"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1529479932, "post_id": 50940735, "comment_id": 88882743, "body": "@Bathsheba another good to know for pub quiz ^"}, {"owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1529481069, "post_id": 50940735, "comment_id": 88883408, "body": "@AnttiHaapala : interesting, so there is a difference in this respect between C11 and C++11. A good write-up : <a href=\"https://stackoverflow.com/questions/22616044/assignment-operator-sequencing-in-c11-expressions/22616368#22616368\" title=\"assignment operator sequencing in c11 expressions\">stackoverflow.com/questions/22616044/&hellip;</a> . Thanks ! It&#39;s good to know."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "reply_to_user": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 0, "creation_date": 1529481290, "post_id": 50940735, "comment_id": 88883545, "body": "@SanderDeDycker <a href=\"https://stackoverflow.com/a/22697426/918959\">Jens&#39; answer</a> is the best. There is nothing else needed."}, {"owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1529481481, "post_id": 50940735, "comment_id": 88883670, "body": "@Bathsheba : my apologies for misleading you ... I missed some important differences"}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1529489396, "post_id": 50940735, "comment_id": 88888621, "body": "@Jayesh The important line in your code, <code>j = j++</code>, is just about perfectly meaningless.  If you want to add 1 to <code>j</code>, you can use <code>j = j + 1</code> or <code>j++</code>.  But never try to mash the two together as <code>j = j++</code>, because the results are undefined."}], "owner": {"reputation": 4293, "user_id": 7035151, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/ce9aa200c854d26a2cd263f6fc8c24eb?s=128&d=identicon&r=PG&f=1", "display_name": "Jayesh", "link": "https://stackoverflow.com/users/7035151/jayesh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 78, "favorite_count": 1, "closed_date": 1529472200, "answer_count": 0, "score": 0, "last_activity_date": 1529472024, "creation_date": 1529472024, "question_id": 50940735, "link": "https://stackoverflow.com/questions/50940735/why-variable-always-print-0", "closed_reason": "Duplicate", "title": "Why variable always print 0?", "body": "<pre><code>#include &lt;stdio.h&gt;\n\nint main(void)\n{\n    int j = 0;\n    for(int i = 0; i &lt; 100; i++)\n    {\n        j = j++;\n    }\n    printf(\"%d\\n\",j);\n\n    return 0;\n}\n</code></pre>\n\n<p>In the above program, I aspect <code>99</code> outputs of <code>j</code> variable. but It's always print <code>0</code>.</p>\n\n<p>I don't understand, Why <code>j</code> always print <code>0</code>?</p>\n"}, {"tags": ["c", "vnc-server", "rfb-protocol"], "answers": [{"comments": [{"owner": {"reputation": 229, "user_id": 3911119, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/be7b752c34eb00ed62a5d137bc084284?s=128&d=identicon&r=PG&f=1", "display_name": "user3911119", "link": "https://stackoverflow.com/users/3911119/user3911119"}, "edited": false, "score": 0, "creation_date": 1529476381, "post_id": 50941495, "comment_id": 88880926, "body": "thanks for the response! if this works, it solves my problem. I will try and let know."}], "tags": [], "owner": {"reputation": 50, "user_id": 6266963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OUL8Z.png?s=128&g=1", "display_name": "Rorschach", "link": "https://stackoverflow.com/users/6266963/rorschach"}, "is_accepted": true, "score": 2, "last_activity_date": 1529475689, "creation_date": 1529475689, "answer_id": 50941495, "question_id": 50940621, "link": "https://stackoverflow.com/questions/50940621/can-we-host-multiple-vnc-servers-using-libvncserver-library-in-the-same-proces/50941495#50941495", "title": "Can we host multiple vnc servers (using LibVNCServer library) in the same process?", "body": "<p>I tried to write a vnc server with server-side-downscale ability, which is one source multi-stream.</p>\n\n<pre><code>int main(int argc, char** argv)\n{\n    ...\n\n    rfbScreenInfoPtr rfbScreen_1080 = rfbGetScreen(&amp;argc,argv,1920,1080,8,3,bpp);\n    rfbScreenInfoPtr rfbScreen_720 = rfbGetScreen(&amp;argc,argv,1280,720,8,3,bpp);\n    rfbScreen_1080-&gt;frameBuffer = (char*)_aligned_malloc(1920*1080*bpp,256);\n    rfbScreen_720-&gt;frameBuffer = (char*)_aligned_malloc(1280*720*bpp,256);\n\n    rfbScreen_1080-&gt;progressiveSliceHeight = 1080/2;\n    rfbScreen_720-&gt;progressiveSliceHeight = 720/2;\n    rfbScreen_1080-&gt;cursor = rfbMakeXCursor(0,0,NULL,NULL);\n    rfbScreen_720-&gt;cursor = rfbMakeXCursor(0,0,NULL,NULL);\n\n\n    rfbScreen_1080-&gt;port = 5900;\n    rfbScreen_720-&gt;port = 5901;\n\n    rfbScreen_1080-&gt;alwaysShared = 1;\n    rfbScreen_720-&gt;alwaysShared = 1;\n    rfbInitServer(rfbScreen_1080);\n    rfbInitServer(rfbScreen_720);\n\n    int begin = clock();\n    while(rfbIsActive(rfbScreen_1080) || rfbIsActive(rfbScreen_720))\n    {\n    int end = clock();    \n        if(end - begin &gt;= UPDATE_INTERVAL)\n        {\n            //printf(\"%d\\n\",end-begin);\n            begin = clock()-(end - begin - UPDATE_INTERVAL);\n            CaptureScreen(rfbScreen_1080, rfbScreen_720);\n\n            rfbMarkRectAsModified(rfbScreen_1080,0,0,1920,1080);\n            rfbMarkRectAsModified(rfbScreen_720,0,0,1280,720);\n\n        }\n        rfbProcessEvents(rfbScreen_1080,40);\n        rfbProcessEvents(rfbScreen_720,40);\n        //Sleep(1);\n    }\n...\n}\nvoid CaptureScreen(rfbScreenInfoPtr rfbScreen1, rfbScreenInfoPtr rfbScreen2)\n{\n    //capture screen to bmp, resize and copy data to rfbScreen-&gt;frameBuffer;\n}\n</code></pre>\n"}], "owner": {"reputation": 229, "user_id": 3911119, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/be7b752c34eb00ed62a5d137bc084284?s=128&d=identicon&r=PG&f=1", "display_name": "user3911119", "link": "https://stackoverflow.com/users/3911119/user3911119"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 149, "favorite_count": 0, "accepted_answer_id": 50941495, "answer_count": 1, "score": 1, "last_activity_date": 1529475689, "creation_date": 1529471449, "last_edit_date": 1529471929, "question_id": 50940621, "link": "https://stackoverflow.com/questions/50940621/can-we-host-multiple-vnc-servers-using-libvncserver-library-in-the-same-proces", "title": "Can we host multiple vnc servers (using LibVNCServer library) in the same process?", "body": "<p>There is an example called camera.c in the LibVNCServer library which captures camera snapshots and populates the framebuffer used by vnc server in intervals. My requirement is to do the same with mpeg transport streams (many sources instead of a single source like camera). Therefore, one vnc server per transport stream is required.</p>\n\n<p>I read in the RFB protocol that we can host multiple vnc servers on the same host on ports starting from 5900 (5900+x). However, it would be better to host multiple vnc servers in the same process so that unwanted I/O between the vnc servers and the process generating the data can be avoided.</p>\n\n<p>Does LibVNCServer support that use case or do I have to launch a vnc server process per video stream?</p>\n\n<p>Note: I went through the library and saw that the rfbScreenInfoPtr is circulated everywhere and is not static. But could not conclude if LibVNCServer is thread safe because I am not familiar with C.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1529471061, "post_id": 50940522, "comment_id": 88878839, "body": "goodness,, how big is your hard drive?"}, {"owner": {"reputation": 325, "user_id": 1675483, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/36891f4258274be0dbfaac8dda7ee2e3?s=128&d=identicon&r=PG", "display_name": "Total Anime Immersion", "link": "https://stackoverflow.com/users/1675483/total-anime-immersion"}, "reply_to_user": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1529471167, "post_id": 50940522, "comment_id": 88878870, "body": "10TB. And I&#39;m reading values from a volume of 5 TB in Raw format. That is reading every character and storing them in a text file with both hex and char representation. Is it possible I&#39;ll overflow unsigned long long int with that much data?"}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1529471444, "post_id": 50940522, "comment_id": 88878963, "body": "heh well on my system, <code>unsigned long long</code> is 8 bytes, so that can hold values from 0 to 2^64-1. According to the answer, that&#39;s 18 exabytes. I don&#39;t know what an exabyte is, but it sounds big. A terabyte is 2^40, so 5 terabytes is 5*2^40.. that can easily fit in my <code>unsigned long long</code>. Although not necessary in this case, there are libraries available that deal with even larger numbers, googling can surely help you find some."}, {"owner": {"reputation": 34083, "user_id": 1287251, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IQkBy.png?s=128&g=1", "display_name": "Cornstalks", "link": "https://stackoverflow.com/users/1287251/cornstalks"}, "edited": false, "score": 1, "creation_date": 1529471766, "post_id": 50940522, "comment_id": 88879076, "body": "<a href=\"https://en.wikipedia.org/wiki/Metric_prefix#List_of_SI_prefixes\" rel=\"nofollow noreferrer\">18 exabytes is 18 <i>million</i> terabytes</a>. If you have 18 million terabytes of data you need to store, you&#39;re gonna need a few billion dollars to afford that..."}, {"owner": {"reputation": 325, "user_id": 1675483, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/36891f4258274be0dbfaac8dda7ee2e3?s=128&d=identicon&r=PG", "display_name": "Total Anime Immersion", "link": "https://stackoverflow.com/users/1675483/total-anime-immersion"}, "edited": false, "score": 0, "creation_date": 1529471883, "post_id": 50940522, "comment_id": 88879115, "body": "Updated the question a little. Can you kindly answer the next part as well?"}, {"owner": {"reputation": 34083, "user_id": 1287251, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IQkBy.png?s=128&g=1", "display_name": "Cornstalks", "link": "https://stackoverflow.com/users/1287251/cornstalks"}, "edited": false, "score": 2, "creation_date": 1529471922, "post_id": 50940522, "comment_id": 88879129, "body": "Please keep your question focused to a single question. Open a new question if you have a new question. The two questions you&#39;re asking here aren&#39;t really related."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 34083, "user_id": 1287251, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IQkBy.png?s=128&g=1", "display_name": "Cornstalks", "link": "https://stackoverflow.com/users/1287251/cornstalks"}, "edited": false, "score": 0, "creation_date": 1529473691, "post_id": 50940522, "comment_id": 88879797, "body": "@Cornstalks: You can find 4 TB drives for about $100 on Amazon, so 18 EB would cost less than $0.5B (maybe quite a bit less if you get a bulk discount).  You can find 10 TB drives for about $320, too \u2014 but that&#39;s more expensive.  Of course, you also need to order a power station to get the electricity to run that much disk."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 1, "creation_date": 1529476064, "post_id": 50940522, "comment_id": 88880750, "body": "Unfortunately, the chances are here that <b>if you need to ask, you ain&#39;t gonna need it</b>"}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1529476888, "post_id": 50940522, "comment_id": 88881132, "body": "@JonathanLeffler also a mother board that has 70312 SATA ports."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1529477084, "post_id": 50940522, "comment_id": 88881222, "body": "Even if you manage to have a bigger data type, I am not sure how you will use it, since the standard file functions (<code>ftell</code>, <code>fseek</code>) work only with with <code>long int</code>"}, {"owner": {"reputation": 34083, "user_id": 1287251, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IQkBy.png?s=128&g=1", "display_name": "Cornstalks", "link": "https://stackoverflow.com/users/1287251/cornstalks"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1529502902, "post_id": 50940522, "comment_id": 88897498, "body": "@JonathanLeffler: That&#39;s true, but that&#39;s an oversimplified view. At 18 EB, you <i>will</i> see disk failures, so you need some level of replication (unless you&#39;re okay with partially corrupt data). So you need some extra disks. You also need computers/equipment to plug the disks into. And a physical building. And power. And cooling. And humans to put it all together (and maintain it). etc. You might be able to buy 18 EB worth of disks for under a billion dollars, but in order to actually use it I&#39;m quite sure you&#39;d have to blow through a few billion."}, {"owner": {"reputation": 26606, "user_id": 4603670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7eabc1427aa3c8185153cc81978289a?s=128&d=identicon&r=PG&f=1", "display_name": "Barmak Shemirani", "link": "https://stackoverflow.com/users/4603670/barmak-shemirani"}, "edited": false, "score": 0, "creation_date": 1529537241, "post_id": 50940522, "comment_id": 88914020, "body": "<i>&quot;the maximum number of elements that I can have in an array is 10000&quot;</i> - This seems to be a different question. You can have a lot more than 10,000 elements in an array. Unless you are declaring an array on stack. Maybe you need <code>malloc</code> to create array on heap."}], "answers": [{"tags": [], "owner": {"reputation": 16871, "user_id": 1281385, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/3590d48970d9b0e96fabb0b23614be61?s=128&d=identicon&r=PG", "display_name": "exussum", "link": "https://stackoverflow.com/users/1281385/exussum"}, "is_accepted": true, "score": 5, "last_activity_date": 1529471582, "last_edit_date": 1529471582, "creation_date": 1529471190, "answer_id": 50940563, "question_id": 50940522, "link": "https://stackoverflow.com/questions/50940522/is-there-anything-longer-than-unsigned-long-long-int-in-c/50940563#50940563", "title": "Is there anything longer than unsigned long long int in C?", "body": "<p>Just for the number of chars in a file you don't have to worry \n<a href=\"https://www.google.co.uk/search?q=2%5E64+bytes+in+exabytes\" rel=\"nofollow noreferrer\">https://www.google.co.uk/search?q=2%5E64+bytes+in+exabytes</a></p>\n\n<p>That gives 18 exabyte files worth of storage space. </p>\n\n<p>To answer the question directly though. You should look at a library of you need numbers larger that 64 bit</p>\n\n<p>GMP is one I have used many times \n<a href=\"https://gmplib.org\" rel=\"nofollow noreferrer\">https://gmplib.org</a></p>\n\n<p>As a note \n1 exabyte = 1,000,000 terabytes</p>\n"}, {"tags": [], "owner": {"reputation": 30168, "user_id": 5612562, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/gzBQY.jpg?s=128&g=1", "display_name": "msc", "link": "https://stackoverflow.com/users/5612562/msc"}, "is_accepted": false, "score": 2, "last_activity_date": 1529471462, "creation_date": 1529471462, "answer_id": 50940626, "question_id": 50940522, "link": "https://stackoverflow.com/questions/50940522/is-there-anything-longer-than-unsigned-long-long-int-in-c/50940626#50940626", "title": "Is there anything longer than unsigned long long int in C?", "body": "<p>The largest standard integer type specified by the standard is <code>long long int</code>.</p>\n\n<p>The <a href=\"http://gcc.gnu.org/onlinedocs/\" rel=\"nofollow noreferrer\">GCC 4.7.1 manual</a> says:</p>\n\n<blockquote>\n  <h2>6.8 128-bits integers</h2>\n  \n  <p>As an extension the integer scalar type <code>__int128</code> is supported for targets having an integer\n  mode wide enough to hold 128-bit. Simply write <code>__int128</code> for a signed 128-bit integer, or\n  <code>unsigned __int128</code> for an unsigned 128-bit integer. There is no support in GCC to express\n  an integer constant of type <code>__int128</code> for targets having <code>long long</code> integer with less then [<em>sic</em>]\n  128 bit width.</p>\n</blockquote>\n\n<p>One of such types is <code>__int128</code>, which is available on <code>x86-64</code> and supported by all major compilers. As you can guess, it's 128 bits wide.</p>\n"}, {"tags": [], "owner": {"reputation": 14752, "user_id": 1787973, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2853d3d7c18c97459c34b86ced8c18e2?s=128&d=identicon&r=PG", "display_name": "Maxime Ch&#233;ramy", "link": "https://stackoverflow.com/users/1787973/maxime-ch%c3%a9ramy"}, "is_accepted": false, "score": 1, "last_activity_date": 1529471838, "creation_date": 1529471838, "answer_id": 50940694, "question_id": 50940522, "link": "https://stackoverflow.com/questions/50940522/is-there-anything-longer-than-unsigned-long-long-int-in-c/50940694#50940694", "title": "Is there anything longer than unsigned long long int in C?", "body": "<blockquote>\n  <p>I'm using an unsigned long long int to store number of characters in a file.</p>\n</blockquote>\n\n<p>Most of the file systems nowadays also use 64 bits to store the file size (e.g with ext2, it's <code>i_size</code> + <code>i_dir_acl</code>, two 32 bits integers).</p>\n\n<p>With 64 bits, the maximum file size is 18 exabytes, which is very, very big.</p>\n"}], "owner": {"reputation": 325, "user_id": 1675483, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/36891f4258274be0dbfaac8dda7ee2e3?s=128&d=identicon&r=PG", "display_name": "Total Anime Immersion", "link": "https://stackoverflow.com/users/1675483/total-anime-immersion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1393, "favorite_count": 1, "closed_date": 1529498241, "accepted_answer_id": 50940563, "answer_count": 3, "score": 0, "last_activity_date": 1529471838, "creation_date": 1529470963, "last_edit_date": 1529471800, "question_id": 50940522, "link": "https://stackoverflow.com/questions/50940522/is-there-anything-longer-than-unsigned-long-long-int-in-c", "closed_reason": "Needs more focus", "title": "Is there anything longer than unsigned long long int in C?", "body": "<p>I'm using an unsigned long long int to store number of characters in a file. And I'm scared that its range will be bypassed soon. Is therr another datatype which can hold values more than unsigned long long int?</p>\n\n<p>I also need 2 unsigned long long int arrays to store the pointers to certain positions in the file. However the maximum number of elements that I can have in an array is 10000. Is there a way to have a lot more?</p>\n"}, {"tags": ["c", "strtok", "strcpy"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1529470998, "post_id": 50940484, "comment_id": 88878814, "body": "It is remarkably hard to read code laid out as shown \u2014 there are advantages to the orthodox layout styles, and one of them is readability and another is familiarity."}, {"owner": {"reputation": 3794, "user_id": 7256714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adeb98b0e8995d8576ad5f66c0f982e5?s=128&d=identicon&r=PG&f=1", "display_name": "Pras", "link": "https://stackoverflow.com/users/7256714/pras"}, "edited": false, "score": 1, "creation_date": 1529471031, "post_id": 50940484, "comment_id": 88878825, "body": "You have to check if strtok returns NULL before copying"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1529471411, "post_id": 50940484, "comment_id": 88878951, "body": "What happens if there are several adjacent blanks between parts of the name, or at the beginning or end?  You also don&#39;t check for overflows.  But the principal problem is that you don&#39;t check for null quick enough."}, {"owner": {"reputation": 317, "user_id": 9965330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98aa2785e28665f32e5e04a0c8a274c4?s=128&d=identicon&r=PG&f=1", "display_name": "Thuan Nguyen", "link": "https://stackoverflow.com/users/9965330/thuan-nguyen"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1529471532, "post_id": 50940484, "comment_id": 88878992, "body": "@JonathanLeffler is my code hard to read? I am new to coding, could you tell me how to make it easier to read."}, {"owner": {"reputation": 317, "user_id": 9965330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98aa2785e28665f32e5e04a0c8a274c4?s=128&d=identicon&r=PG&f=1", "display_name": "Thuan Nguyen", "link": "https://stackoverflow.com/users/9965330/thuan-nguyen"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1529471701, "post_id": 50940484, "comment_id": 88879049, "body": "@JonathanLeffler this code assumes that users input correctly and how can check for null? i thought while(token!=NULL) checks for null already?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 3794, "user_id": 7256714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adeb98b0e8995d8576ad5f66c0f982e5?s=128&d=identicon&r=PG&f=1", "display_name": "Pras", "link": "https://stackoverflow.com/users/7256714/pras"}, "edited": false, "score": 0, "creation_date": 1529472349, "post_id": 50940484, "comment_id": 88879289, "body": "Assuming that users do anything other than try to make your code crash is dangerous.  They always get it wrong.  You should assume they are doing their worst.  Yes, <code>while (token != NULL)</code> checks for nullness, but you then have <code>token = strtok(NULL, s);</code> and you don&#39;t check <code>token</code> immediately after that \u2014 which is the crux of your problem, as pointed out by @Pras and @Soumen.  (See also <a href=\"http://www.kalzumeus.com/2010/06/17/falsehoods-programmers-believe-about-names/\" rel=\"nofollow noreferrer\">Falsehoods programmers believe about names</a>.)"}, {"owner": {"reputation": 317, "user_id": 9965330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98aa2785e28665f32e5e04a0c8a274c4?s=128&d=identicon&r=PG&f=1", "display_name": "Thuan Nguyen", "link": "https://stackoverflow.com/users/9965330/thuan-nguyen"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1529473944, "post_id": 50940484, "comment_id": 88879889, "body": "@JonathanLeffler Thank you for spending time replying and helping me!!"}, {"owner": {"reputation": 317, "user_id": 9965330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98aa2785e28665f32e5e04a0c8a274c4?s=128&d=identicon&r=PG&f=1", "display_name": "Thuan Nguyen", "link": "https://stackoverflow.com/users/9965330/thuan-nguyen"}, "reply_to_user": {"reputation": 3794, "user_id": 7256714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adeb98b0e8995d8576ad5f66c0f982e5?s=128&d=identicon&r=PG&f=1", "display_name": "Pras", "link": "https://stackoverflow.com/users/7256714/pras"}, "edited": false, "score": 0, "creation_date": 1529473977, "post_id": 50940484, "comment_id": 88879898, "body": "@Pras Thank you! I understand it now!"}, {"owner": {"reputation": 317, "user_id": 9965330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98aa2785e28665f32e5e04a0c8a274c4?s=128&d=identicon&r=PG&f=1", "display_name": "Thuan Nguyen", "link": "https://stackoverflow.com/users/9965330/thuan-nguyen"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1529474702, "post_id": 50940484, "comment_id": 88880199, "body": "@JonathanLeffler really sorry but  can i ask you 1 more question? What can i use instead of strlen()? Because in the main function i have a string: char ar[500] (which is the argument for the function i mentioned above).  I use fgets for getting input and strlen is the only way that i know to calculate the number of elements in the inputted string."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1529475076, "post_id": 50940484, "comment_id": 88880353, "body": "The length doesn&#39;t change during the <code>for</code> loop.  Either use <code>int len = strlen(ar);</code> before the loop and then <code>i &lt; len</code> in the loop, or use <code>for (int i = 0; ar[i] != &#39;\\0&#39;; i++)</code> as the loop control.  That avoids scanning the string twice \u2014 once for <code>strlen()</code> and once to look for blanks (and saving <code>len</code> saves scanning the string once per character in the string, which might save a lot, or which might be detected by a very good optimizer)."}], "answers": [{"comments": [{"owner": {"reputation": 317, "user_id": 9965330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98aa2785e28665f32e5e04a0c8a274c4?s=128&d=identicon&r=PG&f=1", "display_name": "Thuan Nguyen", "link": "https://stackoverflow.com/users/9965330/thuan-nguyen"}, "edited": false, "score": 0, "creation_date": 1529473799, "post_id": 50940594, "comment_id": 88879838, "body": "So if i try to copy NULL to a string, it will cause problem? And i know that strtok maintains a static pointer to continue from where it has left, but i don&#39;t understand why passing null pointer to the second call causes strtok continue to scan the string. Sorry for my grammar, if you don&#39;t understand, pls tell me and i will fix it."}, {"owner": {"reputation": 966, "user_id": 1386127, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/01cef9fb064e908463d83e6cb1f08cf8?s=128&d=identicon&r=PG&f=1", "display_name": "Soumen", "link": "https://stackoverflow.com/users/1386127/soumen"}, "reply_to_user": {"reputation": 317, "user_id": 9965330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98aa2785e28665f32e5e04a0c8a274c4?s=128&d=identicon&r=PG&f=1", "display_name": "Thuan Nguyen", "link": "https://stackoverflow.com/users/9965330/thuan-nguyen"}, "edited": false, "score": 0, "creation_date": 1529482369, "post_id": 50940594, "comment_id": 88884205, "body": "Providing NULL as argument to strcpy() results in segfault. You can check it using a simple program. And for how strtok(), after giving NULL argument, starts scanning where it left off, you would have to check the source code of strtok() itself. You can check <a href=\"https://www.gnu.org/software/libc/sources.html\" rel=\"nofollow noreferrer\">the source code</a>"}], "tags": [], "owner": {"reputation": 966, "user_id": 1386127, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/01cef9fb064e908463d83e6cb1f08cf8?s=128&d=identicon&r=PG&f=1", "display_name": "Soumen", "link": "https://stackoverflow.com/users/1386127/soumen"}, "is_accepted": false, "score": 1, "last_activity_date": 1529471327, "creation_date": 1529471327, "answer_id": 50940594, "question_id": 50940484, "link": "https://stackoverflow.com/questions/50940484/c-can-not-use-strcpy-with-strtok/50940594#50940594", "title": "C - Can not use strcpy with strtok", "body": "<p>When first is copied (i.e. all tokens identified), while loop will be entered once again(note that token is not NULL, but points to first in this case). Now strtok() will be called and it will return NULL. Code will go to the else part and try to strcpy(), which is causing the problem.</p>\n\n<p>Check for NULL before strcpy(). I have done this like this and it works fine.</p>\n\n<pre><code>while(token!=NULL)                                                          \n{                                                                           \n    token=strtok(NULL,s);                                                   \n    if (token == NULL)                                                      \n      break;                                                                \n    if(a&lt;count) strcpy(middle,token);                                       \n    else strcpy(first,token);                                               \n    a++;                                                                    \n} \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": false, "score": 1, "last_activity_date": 1529472210, "creation_date": 1529472210, "answer_id": 50940779, "question_id": 50940484, "link": "https://stackoverflow.com/questions/50940484/c-can-not-use-strcpy-with-strtok/50940779#50940779", "title": "C - Can not use strcpy with strtok", "body": "<p>This is more like how I'd present the code in the question \u2014 before I passed it through a compiler:</p>\n\n<pre><code>void order(char ar[])\n{\n    int count = 0, a = 1;\n    char *token;\n    char last[20], middle[20], first[20];\n    char s[] = \" \";\n\n    for (int i = 0; i &lt; strlen(ar) - 1; i++)\n    {\n        if (ar[i] == ' ')\n            count++;\n    }\n\n    token = strtok(ar, s);\n    strcpy(last, token);\n\n    while (token != NULL)\n    {\n        token = strtok(NULL, s);\n        if (a &lt; count)\n            strcpy(middle, token);\n        else\n            strcpy(first, token);\n        a++;\n    }\n    printf(\"%s %s %s\", first, middle, last);\n}\n</code></pre>\n\n<p>You can argue about brace placement \u2014 I use <a href=\"https://en.wikipedia.org/wiki/Indentation_style\" rel=\"nofollow noreferrer\">Allman</a> but 1TBS is a widely used alternative style.  I recommend choosing one of those two.  I put braces around the body of a loop if it is more than one line; YMMV.</p>\n\n<p>Use more white space around operators.  Don't define unused variables (<code>c</code> vanished).  I placed <code>int i</code> in the <code>for</code> loop.  I would probably define one variable per line, and I probably wouldn't use the <code>count</code> or <code>a</code>.</p>\n\n<p>The call to <code>strlen()</code> should not be in the condition of the loop.  I'm not sure how you'd cope with my name \u2014 I don't have a middle name.  I think you could avoid the <code>while</code> loop altogether.  I'm not convinced you need the <code>for</code> loop either.  Those are a separate discussion.</p>\n\n<p>I'm not attempting to fix the algorithmic problem \u2014 this is not an answer to the question in the question (so it shouldn't be accepted), but is an answer to the question in the <a href=\"https://stackoverflow.com/questions/50940484/c-can-not-use-strcpy-with-strtok?noredirect=1#comment88878992_50940484\">comment</a>, and since code cannot be formatted in comments, I can't answer it sanely in a comment; hence, this 'not an answer' but 'intended to be helpful to an auxilliary question from the OP'.</p>\n"}], "owner": {"reputation": 317, "user_id": 9965330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98aa2785e28665f32e5e04a0c8a274c4?s=128&d=identicon&r=PG&f=1", "display_name": "Thuan Nguyen", "link": "https://stackoverflow.com/users/9965330/thuan-nguyen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 651, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1529472210, "creation_date": 1529470671, "last_edit_date": 1529470831, "question_id": 50940484, "link": "https://stackoverflow.com/questions/50940484/c-can-not-use-strcpy-with-strtok", "title": "C - Can not use strcpy with strtok", "body": "<p>I am working with a function that accept full name as input and print them out in order: first name, middle name, last name.</p>\n\n<p>The problem is my while loop seem to go infinite and i haven't figured out how to fix it.</p>\n\n<p>Here is my function:</p>\n\n<pre><code>void order(char ar[])\n{\n    int i, count=0, a=1;\n    char* token;\n    char last[20], middle[20], first[20],c;\n    char s[]=\" \";\n    for(i=0;i&lt;strlen(ar)-1;i++)\n        if(ar[i]==' ') count++;\n\n    token=strtok(ar,s);\n    strcpy(last,token);\n\n\n    while(token!=NULL)\n    {\n        token=strtok(NULL,s);\n        if(a&lt;count) strcpy(middle,token);\n        else strcpy(first,token);\n        a++; \n    }\n    printf(\"%s %s %s\",first,middle,last);\n}\n</code></pre>\n"}, {"tags": ["c", "file"], "answers": [{"comments": [{"owner": {"reputation": 554, "user_id": 4476501, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oTMdb.jpg?s=128&g=1", "display_name": "Summer Sun", "link": "https://stackoverflow.com/users/4476501/summer-sun"}, "edited": false, "score": 0, "creation_date": 1529472241, "post_id": 50940476, "comment_id": 88879245, "body": "Thank you Basile, for my problem here is the file position is incoreect. I use rewind after fflush and it works to read from the header of newly inserted content. Thank you for your kind reminds!"}], "tags": [], "owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "is_accepted": true, "score": 2, "last_activity_date": 1529472242, "last_edit_date": 1529472242, "creation_date": 1529470641, "answer_id": 50940476, "question_id": 50940428, "link": "https://stackoverflow.com/questions/50940428/how-can-c-read-content-that-is-newly-inserted-into-a-file/50940476#50940476", "title": "How can C read content that is newly inserted into a file?", "body": "<p>You might use not only <a href=\"http://en.cppreference.com/w/c/io/fflush\" rel=\"nofollow noreferrer\">fflush</a>, but also <a href=\"http://en.cppreference.com/w/c/io/rewind\" rel=\"nofollow noreferrer\">rewind</a>, <a href=\"http://en.cppreference.com/w/c/io/fseek\" rel=\"nofollow noreferrer\">fseek</a>, <a href=\"http://en.cppreference.com/w/c/io/ftell\" rel=\"nofollow noreferrer\">ftell</a> (or even <a href=\"http://en.cppreference.com/w/c/io/fgetpos\" rel=\"nofollow noreferrer\">fgetpos</a> &amp; <a href=\"http://en.cppreference.com/w/c/io/fsetpos\" rel=\"nofollow noreferrer\">fsetpos</a>)</p>\n\n<p>Beware that any <a href=\"http://en.cppreference.com/w/c/io\" rel=\"nofollow noreferrer\">standard IO</a> function can fail, and you should check that.</p>\n\n<p>On Linux, some files (e.g. <a href=\"http://man7.org/linux/man-pages/man7/fifo.7.html\" rel=\"nofollow noreferrer\">fifo(7)</a>) are not <a href=\"https://stackoverflow.com/q/3238788/841108\">seekable</a>.</p>\n\n<p>Perhaps you want some higher level way of storing <a href=\"https://en.wikipedia.org/wiki/Persistence_(computer_science)\" rel=\"nofollow noreferrer\">persistent</a> data on the disk. Did you consider using some library for indexed files (like <a href=\"https://www.gnu.org.ua/software/gdbm/\" rel=\"nofollow noreferrer\">gdbm</a>) or for databases (like <a href=\"http://sqlite.org/\" rel=\"nofollow noreferrer\">sqlite</a>)? Or even use a full fledged <a href=\"https://en.wikipedia.org/wiki/Database\" rel=\"nofollow noreferrer\">database</a>, like with some <a href=\"https://en.wikipedia.org/wiki/Relational_database_management_system\" rel=\"nofollow noreferrer\">RDBMS</a> (e.g. <a href=\"http://postgresql.org/\" rel=\"nofollow noreferrer\">PostGreSQL</a> or <a href=\"https://dev.mysql.com/\" rel=\"nofollow noreferrer\">MySQL</a> or <a href=\"https://mariadb.org/\" rel=\"nofollow noreferrer\">MariaDB</a> which are <a href=\"https://en.wikipedia.org/wiki/Free_software\" rel=\"nofollow noreferrer\">free software</a>), or some <a href=\"https://en.wikipedia.org/wiki/NoSQL\" rel=\"nofollow noreferrer\">NoSQL</a> thing like e.g. <a href=\"http://mongodb.com/\" rel=\"nofollow noreferrer\">MongoDB</a> ?</p>\n\n<p><strong>There is no way to <em>insert</em> a sequence of bytes in the middle of some <a href=\"https://en.wikipedia.org/wiki/Computer_file\" rel=\"nofollow noreferrer\">file</a></strong> or to delete, i.e. remove, a sequence of bytes inside a file. This is a fundamental limitation of <a href=\"https://en.wikipedia.org/wiki/File_system\" rel=\"nofollow noreferrer\">file systems</a> on most current <a href=\"https://en.wikipedia.org/wiki/Operating_system\" rel=\"nofollow noreferrer\">operating systems</a> (and on all usual ones like Linux &amp; Windows &amp; Android &amp; MacOSX). You generally should copy that file (by chunks) into some other one (and libraries like gdbm or sqlite don't do that, they either append some data to a file at its end or rewrite some bytes inside the file; they might also <a href=\"http://man7.org/linux/man-pages/man2/truncate.2.html\" rel=\"nofollow noreferrer\">truncate</a> a file).</p>\n\n<p>In particular, if you want to programmatically insert some line in the middle of some small text file, you usually should read the file entirely in some appropriate data structure, modify that data structure in memory, then dump that data structure into the (overwritten) file.</p>\n"}, {"comments": [{"owner": {"reputation": 554, "user_id": 4476501, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oTMdb.jpg?s=128&g=1", "display_name": "Summer Sun", "link": "https://stackoverflow.com/users/4476501/summer-sun"}, "edited": false, "score": 0, "creation_date": 1529472300, "post_id": 50940503, "comment_id": 88879267, "body": "Thank you, I finally used <code>rewind</code> to reset the file read positino and it works for me."}], "tags": [], "owner": {"reputation": 5360, "user_id": 9435815, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xaQWU.jpg?s=128&g=1", "display_name": "r3mus n0x", "link": "https://stackoverflow.com/users/9435815/r3mus-n0x"}, "is_accepted": false, "score": 1, "last_activity_date": 1529470843, "creation_date": 1529470843, "answer_id": 50940503, "question_id": 50940428, "link": "https://stackoverflow.com/questions/50940428/how-can-c-read-content-that-is-newly-inserted-into-a-file/50940503#50940503", "title": "How can C read content that is newly inserted into a file?", "body": "<p>You need to use <a href=\"http://man7.org/linux/man-pages/man3/fseek.3.html\" rel=\"nofollow noreferrer\">fseek()</a> to return to the beginning of the file before trying to read it.</p>\n"}], "owner": {"reputation": 554, "user_id": 4476501, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oTMdb.jpg?s=128&g=1", "display_name": "Summer Sun", "link": "https://stackoverflow.com/users/4476501/summer-sun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 50940476, "answer_count": 2, "score": 0, "last_activity_date": 1529472242, "creation_date": 1529470325, "question_id": 50940428, "link": "https://stackoverflow.com/questions/50940428/how-can-c-read-content-that-is-newly-inserted-into-a-file", "title": "How can C read content that is newly inserted into a file?", "body": "<p>I want to first write something to a file, then use <code>fgets</code> to read it. But I want it to work without close it and switch file open mode between read and write, </p>\n\n<p>I have tried <code>r+</code> and <code>w+</code> for file open. For r+ it is able to read original content but fail to read newly inserted content. For w+ it does not read anything I think that's because w+ clear the original content. </p>\n\n<p>I currently found no way to read the newly inserted content of a file before close and switch file open mode, although with <code>fflush</code> new content is already written to a file and can be viewed externally.</p>\n\n<p>Here is a simple code snippet for testing.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main()\n{\n    FILE *fp = NULL;\n    char line[256]; \n    int status;\n\n    /*input by user*/\n    scanf(\"%s\", line);\n\n    /*write to a file*/\n    fp = fopen(\"f5.txt\", \"w+\");\n    fprintf(fp, \"%s\", line);\n    fflush(fp); /*flush buffer*/\n\n    /*read it*/\n    char lineRead[256];\n    while (fgets(lineRead, 5, fp) != NULL) {\n        puts(lineRead);\n    }\n\n    fclose(fp);\n}\n</code></pre>\n"}, {"tags": ["c", "function", "void"], "comments": [{"owner": {"reputation": 4562, "user_id": 9254539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b45538511384660bfaef5092e30b7ea?s=128&d=identicon&r=PG&f=1", "display_name": "BessieTheCookie", "link": "https://stackoverflow.com/users/9254539/bessiethecookie"}, "edited": false, "score": 1, "creation_date": 1529469324, "post_id": 50940271, "comment_id": 88878374, "body": "Do you know what it means to have a function return void?"}, {"owner": {"reputation": 9, "user_id": 9336484, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-f9TvTNhNEI0/AAAAAAAAAAI/AAAAAAAACqc/IZSk44mliCc/photo.jpg?sz=128", "display_name": "Ryuujin Willy Willy Lee", "link": "https://stackoverflow.com/users/9336484/ryuujin-willy-willy-lee"}, "reply_to_user": {"reputation": 4562, "user_id": 9254539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b45538511384660bfaef5092e30b7ea?s=128&d=identicon&r=PG&f=1", "display_name": "BessieTheCookie", "link": "https://stackoverflow.com/users/9254539/bessiethecookie"}, "edited": false, "score": 1, "creation_date": 1529469379, "post_id": 50940271, "comment_id": 88878390, "body": "It means that it doesn&#39;t return anything right? or at least return null or something."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1529469430, "post_id": 50940271, "comment_id": 88878404, "body": "What output do you imagine <code>printf(checkArray(n, V))</code> would produce?"}, {"owner": {"reputation": 4562, "user_id": 9254539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b45538511384660bfaef5092e30b7ea?s=128&d=identicon&r=PG&f=1", "display_name": "BessieTheCookie", "link": "https://stackoverflow.com/users/9254539/bessiethecookie"}, "edited": false, "score": 0, "creation_date": 1529469435, "post_id": 50940271, "comment_id": 88878406, "body": "Exactly. In your code, the function returns nothing, and you&#39;re trying to output its return value. The function does the printing itself, so all you have to do is call it. You don&#39;t need to print the results again in <code>main()</code>."}, {"owner": {"reputation": 39159, "user_id": 1541563, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/U4EOh.png?s=128&g=1", "display_name": "Patrick Roberts", "link": "https://stackoverflow.com/users/1541563/patrick-roberts"}, "edited": false, "score": 1, "creation_date": 1529469450, "post_id": 50940271, "comment_id": 88878411, "body": "<code>printf()</code> expects a <code>const char *</code> as the first argument. You can&#39;t have <code>void</code> as a parameter type."}, {"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 0, "creation_date": 1529469451, "post_id": 50940271, "comment_id": 88878413, "body": "@RyuujinWillyWillyLee It means it doesn&#39;t return anything; returning <code>NULL</code> means something different. What do you expect <code>printf(checkArray(n, V))</code> to mean when <code>checkArray</code> doesn&#39;t return anything?"}, {"owner": {"reputation": 9, "user_id": 9336484, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-f9TvTNhNEI0/AAAAAAAAAAI/AAAAAAAACqc/IZSk44mliCc/photo.jpg?sz=128", "display_name": "Ryuujin Willy Willy Lee", "link": "https://stackoverflow.com/users/9336484/ryuujin-willy-willy-lee"}, "edited": false, "score": 0, "creation_date": 1529469522, "post_id": 50940271, "comment_id": 88878430, "body": "Oh, ok, but how do I use the function then? I learned how to code in Java, but there i&#39;m using objects."}, {"owner": {"reputation": 4562, "user_id": 9254539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b45538511384660bfaef5092e30b7ea?s=128&d=identicon&r=PG&f=1", "display_name": "BessieTheCookie", "link": "https://stackoverflow.com/users/9254539/bessiethecookie"}, "edited": false, "score": 0, "creation_date": 1529469569, "post_id": 50940271, "comment_id": 88878445, "body": "Just do <code>checkArray(n, V);</code>. The function will print the results itself."}, {"owner": {"reputation": 9, "user_id": 9336484, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-f9TvTNhNEI0/AAAAAAAAAAI/AAAAAAAACqc/IZSk44mliCc/photo.jpg?sz=128", "display_name": "Ryuujin Willy Willy Lee", "link": "https://stackoverflow.com/users/9336484/ryuujin-willy-willy-lee"}, "edited": false, "score": 0, "creation_date": 1529469572, "post_id": 50940271, "comment_id": 88878446, "body": "I only used printf as i typed how to use a function in C hahaha"}, {"owner": {"reputation": 9, "user_id": 9336484, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-f9TvTNhNEI0/AAAAAAAAAAI/AAAAAAAACqc/IZSk44mliCc/photo.jpg?sz=128", "display_name": "Ryuujin Willy Willy Lee", "link": "https://stackoverflow.com/users/9336484/ryuujin-willy-willy-lee"}, "edited": false, "score": 0, "creation_date": 1529469600, "post_id": 50940271, "comment_id": 88878451, "body": "Ok, thanks i&#39;ll try! xD"}, {"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 0, "creation_date": 1529469668, "post_id": 50940271, "comment_id": 88878468, "body": "@RyuujinWillyWillyLee The <code>void</code> keyword works just like in Java; if a function returns <code>void</code> you can&#39;t use it as a parameter to another function, and you can just call functions without them being parameters to other functions."}, {"owner": {"reputation": 4328, "user_id": 920069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd39f0db1f22e1314746491df063602a?s=128&d=identicon&r=PG", "display_name": "Retired Ninja", "link": "https://stackoverflow.com/users/920069/retired-ninja"}, "edited": false, "score": 0, "creation_date": 1529469874, "post_id": 50940271, "comment_id": 88878524, "body": "You should take another look at your function too. If you don&#39;t want to always print &quot;Not Latin&quot; you need an else, and always using braces is a good habit to learn in my opinion. I&#39;ve seen bugs caused by not using them but never by using them."}, {"owner": {"reputation": 9, "user_id": 9336484, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-f9TvTNhNEI0/AAAAAAAAAAI/AAAAAAAACqc/IZSk44mliCc/photo.jpg?sz=128", "display_name": "Ryuujin Willy Willy Lee", "link": "https://stackoverflow.com/users/9336484/ryuujin-willy-willy-lee"}, "edited": false, "score": 0, "creation_date": 1529469943, "post_id": 50940271, "comment_id": 88878553, "body": "Ok, I&#39;ll use it, thanks for the hint!"}], "answers": [{"tags": [], "owner": {"reputation": 5360, "user_id": 9435815, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xaQWU.jpg?s=128&g=1", "display_name": "r3mus n0x", "link": "https://stackoverflow.com/users/9435815/r3mus-n0x"}, "is_accepted": false, "score": 2, "last_activity_date": 1529470170, "creation_date": 1529470170, "answer_id": 50940401, "question_id": 50940271, "link": "https://stackoverflow.com/questions/50940271/how-am-i-using-wrongly-the-void-expression/50940401#50940401", "title": "How am i using wrongly the void expression?", "body": "<p>Your <code>checkArray()</code> function returns nothing (which is what <code>void</code> means) and you are trying to print that 'nothing' which is obviously impossible. Your <code>checkArray()</code> function already prints the result so you don't need to print anything in <code>main()</code>.</p>\n\n<p>It's seems though that you are missing <code>else</code> before <code>printf(\"Not Latin\")</code> and your <code>length</code> variable is also incorrect. The <code>V</code> parameter of your <code>checkArray()</code> function is just a pointer (like a reference) to array and it doesn't hold any size information, you'll have to pass size separately to your function if you want to be able to traverse the array properly.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 9800649, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fd56b2c049bfcdabc13d06336527b42?s=128&d=identicon&r=PG&f=1", "display_name": "Ujjawal Kumar Mishra", "link": "https://stackoverflow.com/users/9800649/ujjawal-kumar-mishra"}, "is_accepted": false, "score": 0, "last_activity_date": 1529475772, "creation_date": 1529475772, "answer_id": 50941516, "question_id": 50940271, "link": "https://stackoverflow.com/questions/50940271/how-am-i-using-wrongly-the-void-expression/50941516#50941516", "title": "How am i using wrongly the void expression?", "body": "<p>In my view, there are two mistakes in your program.\n1. You didn't put \"else\" condition in function definition.\n2. you already print something in your functions definitions so no need to use 'printf' in main() function.\nyou just call that function.\nand put \"return 0;\" in last of the main function.</p>\n"}, {"tags": [], "owner": {"reputation": 3478, "user_id": 9061264, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TPing.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/9061264/mike"}, "is_accepted": false, "score": 0, "last_activity_date": 1529477370, "last_edit_date": 1529477370, "creation_date": 1529476327, "answer_id": 50941674, "question_id": 50940271, "link": "https://stackoverflow.com/questions/50940271/how-am-i-using-wrongly-the-void-expression/50941674#50941674", "title": "How am i using wrongly the void expression?", "body": "<p>To put together:</p>\n\n<pre><code> #include &lt;stdio.h&gt;\n\nvoid checkArray(int n, int* V, size_t length);\n\nvoid checkArray(int n, int* V, size_t length){\n    int remain = n;\n\n    for(int i = 0; i&lt;length;i++){\n        for(int j = 0; j&lt;length;j++){\n            if(V[j] == remain){\n                remain--;\n            }\n        }\n    }\n    if(remain == 0){\n        printf(\"It's Latin\");\n    else {\n        printf(\"Not Latin\");\n    }\n}\n\nint main(){\n    int n;\n    size_t length;\n\n    scanf(\"%d\", &amp;n);\n    int V[] = {1,2,3,4,5,6,7,8};\n    length = sizeof(V) / sizeof(V[0]);\n\n    checkArray(n, V, length);\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 9336484, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-f9TvTNhNEI0/AAAAAAAAAAI/AAAAAAAACqc/IZSk44mliCc/photo.jpg?sz=128", "display_name": "Ryuujin Willy Willy Lee", "link": "https://stackoverflow.com/users/9336484/ryuujin-willy-willy-lee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "answer_count": 3, "score": -2, "last_activity_date": 1529477370, "creation_date": 1529469225, "last_edit_date": 1529475655, "question_id": 50940271, "link": "https://stackoverflow.com/questions/50940271/how-am-i-using-wrongly-the-void-expression", "title": "How am i using wrongly the void expression?", "body": "<p>I'm newbie in C and wanted to create a function that receives one integer <code>n</code> and one array <code>V</code>, and check if my array contains the values of <code>1</code> to <code>n</code>.</p>\n\n<p>This is my actual code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid checkArray(int n, int* V);\n\nvoid checkArray(int n, int* V){\n\n    int remain = n;\n    size_t length = sizeof V / sizeof V[0];\n    for(int i = 0; i&lt;length;i++){\n        for(int j = 0; j&lt;length;j++){\n            if(V[j] == remain){\n                remain--;\n            }\n        }\n    }\n    if(remain == 0)\n        printf(\"It's Latin\");\n        printf(\"Not Latin\");\n}\n\nint main(){\n\n    int n;\n    scanf(\"%d\", &amp;n);\n    int V[] = {1,2,3,4,5,6,7,8};\n    printf(checkArray(n, V));\n\n}\n</code></pre>\n\n<p>I'm getting the error at my printf, where it says invalid use of void expression.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1529469023, "post_id": 50939968, "comment_id": 88878308, "body": "I see no pointer array in your code, only a couple of individual pointers.  And one of them is used while uninitialized."}, {"owner": {"reputation": 539, "user_id": 2805824, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tBgwo.gif?s=128&g=1", "display_name": "Gaurav Pathak", "link": "https://stackoverflow.com/users/2805824/gaurav-pathak"}, "edited": false, "score": 0, "creation_date": 1529469114, "post_id": 50939968, "comment_id": 88878325, "body": "<code>char *first_phrase</code> has not been allocated any memory using malloc so doing <code>first_phrase += buf[i];</code> is resulting in segmentation fault."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 1, "creation_date": 1529469328, "post_id": 50939968, "comment_id": 88878375, "body": "@guarav: why?  <code>first_phrase</code> is uninitialized, but incrementing a pointer normaly won&#39;t segfault even if the pointer is uninitialized. (Technically, it&#39;s UB. But mist architectures these days don&#39;t care about the bit pattern of a pointer.)"}], "answers": [{"tags": [], "owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "is_accepted": false, "score": 0, "last_activity_date": 1529469955, "last_edit_date": 1529469955, "creation_date": 1529469638, "answer_id": 50940323, "question_id": 50939968, "link": "https://stackoverflow.com/questions/50939968/how-to-add-elements-to-a-pointer-char-array/50940323#50940323", "title": "how to add elements to a pointer char array?", "body": "<p>You're not copying anything at all in that snippet.</p>\n\n<pre><code>first_phrase += buf[i];\n</code></pre>\n\n<p>Adds the (integer code) of the i-th character in buf to the uninitialised pointer <code>first_phrase</code>. Adding a random number to an unitialised variable is meaningless but it's not illegal.</p>\n\n<p>Trying to see what an unitialised pointer happens to point at <em>is</em> illegal, because the pointer doesn't point at anything.\u00b9 You probably do that later in your code, at which point your program will segfault (if you're lucky).</p>\n\n<hr>\n\n<p>\u00b9 And the fact that it's been incremented to some other unspecified value doesn't make it more or less legal.</p>\n"}, {"tags": [], "owner": {"reputation": 6192, "user_id": 2041317, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/58b0m.png?s=128&g=1", "display_name": "cup", "link": "https://stackoverflow.com/users/2041317/cup"}, "is_accepted": true, "score": 0, "last_activity_date": 1529469861, "creation_date": 1529469861, "answer_id": 50940364, "question_id": 50939968, "link": "https://stackoverflow.com/questions/50939968/how-to-add-elements-to-a-pointer-char-array/50940364#50940364", "title": "how to add elements to a pointer char array?", "body": "<p>Several faults in your code snippet</p>\n\n<p>1) Comparison - surprised you didn't get any warnings on this.</p>\n\n<pre><code>if (buff[i] != \" \")\nif (buff[i] == \" \")\n</code></pre>\n\n<p>Compares a character against a string.  This will not work.  It needs to be changed to</p>\n\n<pre><code>if (buff[i] != ' ')\nif (buff[i] == ' ')\n</code></pre>\n\n<p>2) As mentioned in the comments, the space in first_phrase must be allocated before you can add to it</p>\n\n<pre><code>first_phrase = malloc(strlen(buff) + 1);\n</code></pre>\n\n<p>Allocate the same size as your input string just in case there are no spaces in the string.  Add 1 for the string terminator</p>\n\n<p>3) Concatenating to the string needs a counter.  The += adds to the pointer so all you are doing is moving first_phrase by a size but not actually adding to its content.  Something like</p>\n\n<pre><code>int fp = -1;\n...\nfor ...\n    if (buff[i] != ' ')\n        first_phrase[++fp] = buff[i];\n</code></pre>\n\n<p>4) At the end of the loop, first_phrase needs to be terminated</p>\n\n<pre><code>first_phrase[++fp] = '\\0';\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 8386920, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zVKoT.jpg?s=128&g=1", "display_name": "digitalXmage", "link": "https://stackoverflow.com/users/8386920/digitalxmage"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 457, "favorite_count": 0, "accepted_answer_id": 50940364, "answer_count": 2, "score": 0, "last_activity_date": 1529469955, "creation_date": 1529466898, "question_id": 50939968, "link": "https://stackoverflow.com/questions/50939968/how-to-add-elements-to-a-pointer-char-array", "title": "how to add elements to a pointer char array?", "body": "<p><strong>Introduction</strong></p>\n\n<p>I'm trying to iterate over a buffer and copy it's contents into a pointer array. the end goal is to split each word into their own buffers. Here is the code. (it's not complete and only a snippet.)</p>\n\n<p><strong>Code</strong></p>\n\n<pre><code>char *buf = \"install-pkg argument1\";\nchar *first_phrase;\n\nfor(int i=0; i&lt;strlen(buf); i++)\n{\n      if(buf[i] != \" \")\n         first_phrase += buf[i]; //***incorect?***\n\n      else if(buf[i] == \" \")\n         break;   \n}\n</code></pre>\n\n<p><strong>The problem</strong></p>\n\n<p>It compiles with no errors or warnings. However when i run the program i get a <em>segmentation fault</em>. So i'm accessing memory my process does not have access to and i'm guessing i'm copying the contents of the first buffer to the 2nd incorrectly?</p>\n"}, {"tags": ["c", "arrays", "memory-management", "stack"], "comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1529484283, "post_id": 50939612, "comment_id": 88885263, "body": "See <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.2.4\" rel=\"nofollow noreferrer\">C11 Standard - 6.2.4 Storage durations of objects</a>"}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 4213126, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-vXU54cpFtYA/AAAAAAAAAAI/AAAAAAAAAGw/Ypx4YvIcgDk/photo.jpg?sz=128", "display_name": "Saurabh Suman", "link": "https://stackoverflow.com/users/4213126/saurabh-suman"}, "edited": false, "score": 0, "creation_date": 1529464964, "post_id": 50939696, "comment_id": 88877488, "body": "Yes I understand that. My question is - Can I reduce the amount of memory I got from stack at runtime. In this case 24 bytes of memory."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 9, "user_id": 4213126, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-vXU54cpFtYA/AAAAAAAAAAI/AAAAAAAAAGw/Ypx4YvIcgDk/photo.jpg?sz=128", "display_name": "Saurabh Suman", "link": "https://stackoverflow.com/users/4213126/saurabh-suman"}, "edited": false, "score": 1, "creation_date": 1529465040, "post_id": 50939696, "comment_id": 88877503, "body": "@SaurabhSuman No you can&#39;t.  If you want to change the amount of memory in use you should use <code>malloc</code> / <code>free</code> instead."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 9, "user_id": 4213126, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-vXU54cpFtYA/AAAAAAAAAAI/AAAAAAAAAGw/Ypx4YvIcgDk/photo.jpg?sz=128", "display_name": "Saurabh Suman", "link": "https://stackoverflow.com/users/4213126/saurabh-suman"}, "edited": false, "score": 1, "creation_date": 1529465129, "post_id": 50939696, "comment_id": 88877521, "body": "@SaurabhSuman: You asked for 10 integers, four with non-zero values and six with zeros to start with.  The compiler can&#39;t do the job you asked it to do with less.  If you&#39;d written <code>int num[] = { 1, 2, 3, 4, };</code> then you&#39;d save the space.  Since initializers are fixed at compile time, the choice is up to you \u2014 C makes you think."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1529465884, "post_id": 50939696, "comment_id": 88877642, "body": "The lifetime of objects with automatic storage duration ends when execution of their block ends, not when they go out of scope. Lifetime is a duration in time. Scope is location in code. When a function calls another, its identifiers are not in the scope of the called function\u2019s code, but its objects continue to exist. (Also, during a function call, the calling function\u2019s execution is suspended, not ended.)"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1529465988, "post_id": 50939696, "comment_id": 88877657, "body": "@EricPostpischil Good distinction there.  Updated to reflect."}, {"owner": {"reputation": 9, "user_id": 4213126, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-vXU54cpFtYA/AAAAAAAAAAI/AAAAAAAAAGw/Ypx4YvIcgDk/photo.jpg?sz=128", "display_name": "Saurabh Suman", "link": "https://stackoverflow.com/users/4213126/saurabh-suman"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1529466122, "post_id": 50939696, "comment_id": 88877687, "body": "@JonathanLeffler The above case is just an example. In the actual case, I can have int num[MAX_SIZE] , only at runtime I populate it and now I figured out that I don&#39;t need that much space. So how can I reduce that memory?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1529466171, "post_id": 50939696, "comment_id": 88877695, "body": "Except VLAs.  The lifetime of a VLA really does correspond exactly to the time the program is executing the code in which that VLA is in scope."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1529466303, "post_id": 50939696, "comment_id": 88877715, "body": "@JohnBollinger: If <code>functionA()</code> has a VLA <code>int a[n];</code> and then calls another function, <code>functionB()</code>, the VLA <code>a</code> is out of scope but still exists while <code>functionB()</code> is executing."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 9, "user_id": 4213126, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-vXU54cpFtYA/AAAAAAAAAAI/AAAAAAAAAGw/Ypx4YvIcgDk/photo.jpg?sz=128", "display_name": "Saurabh Suman", "link": "https://stackoverflow.com/users/4213126/saurabh-suman"}, "edited": false, "score": 0, "creation_date": 1529466385, "post_id": 50939696, "comment_id": 88877736, "body": "You show initializers, @SaurabhSuman: those are fixed at compile time.  If the content (and hence size of the array) is determined at run time, you need to use either a VLA or dynamically allocated memory."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1529467083, "post_id": 50939696, "comment_id": 88877875, "body": "My apologies, @JonathanLeffler, this is a tricky word-smithing exercise.  The standard puts it exactly this way: &quot;its lifetime extends from the declaration of the object until execution of the program leaves the scope of the declaration.&quot;  This is pretty much what dbush initially described, and different from other automatic variables, whose lifetimes start when execution enters their <i>block</i> (not scope) and ends when execution leaves that block.  I acknowledge that the identifier of a VLA may not be in-scope for that object&#39;s entire lifetime."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 1, "last_activity_date": 1529466920, "last_edit_date": 1529466920, "creation_date": 1529464821, "answer_id": 50939696, "question_id": 50939612, "link": "https://stackoverflow.com/questions/50939612/free-memory-from-stack-in-c/50939696#50939696", "title": "Free memory from stack in C", "body": "<p>The memory used by local variables is reclaimed when the block they are defined in ends.  They can't be free'ed the way dynamically allocated memory can.</p>\n\n<p>If you need to adjust the amount of memory you're using, allocate memory with <code>malloc</code> / <code>free</code>:</p>\n\n<pre><code>int *num = malloc(NUM_BYTES);\n...\nint *tmp = realloc(num, NEW_NUM_BYTES);\nif (tmp) num = tmp;\n...\nfree(num);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 1, "last_activity_date": 1529468053, "creation_date": 1529468053, "answer_id": 50940121, "question_id": 50939612, "link": "https://stackoverflow.com/questions/50939612/free-memory-from-stack-in-c/50940121#50940121", "title": "Free memory from stack in C", "body": "<blockquote>\n  <p>Can I free the 6*4 bytes (Assuming int requires 4 bytes) at runtime?</p>\n</blockquote>\n\n<p>No.  Objects of automatic (or static) storage duration have fixed size for their lifetime, as determined by their declarations.  If you want to use less space, then declare a smaller object.</p>\n\n<p>If you are specifically declaring a small-ish array, you do not know until runtime just what size it needs to be, and you want to declare only as much as you actually need, then you may have the alternative of using a variable-length array.  VLA support is optional in C2011, and VLAs carry some potential issues that fixed-length arrays do not, but if that's acceptable to you then you might do it like so:</p>\n\n<pre><code>void count_to(unsigned char max) {\n    int numbers[max];\n    for (int i = 0; i &lt; max; i++) {\n        numbers[i] = i + 1;\n    }\n\n    // ...\n}\n</code></pre>\n\n<p>Note that VLAs may not have initializers, and that you can get yourself in trouble (e.g. overflow the stack) if you end up with VLAs larger than you accounted for.</p>\n\n<p>Your main alternative is dynamic allocation.  Allocating your arrays dynamically has code and often performance overhead, and it requires you to be sure to free the allocated memory, but all conforming implementations support it, and it typically supports much larger objects than VLAs do.</p>\n"}], "owner": {"reputation": 9, "user_id": 4213126, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-vXU54cpFtYA/AAAAAAAAAAI/AAAAAAAAAGw/Ypx4YvIcgDk/photo.jpg?sz=128", "display_name": "Saurabh Suman", "link": "https://stackoverflow.com/users/4213126/saurabh-suman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1529468053, "creation_date": 1529464177, "last_edit_date": 1529464830, "question_id": 50939612, "link": "https://stackoverflow.com/questions/50939612/free-memory-from-stack-in-c", "title": "Free memory from stack in C", "body": "<p>Just wondering if there is a way to free or reduce the memory allocated from the stack at runtime.\nEx:</p>\n\n<pre><code>int num[10] = {1,2,3,4};\n</code></pre>\n\n<p>Can I free the 6*4 bytes (Assuming int requires 4 bytes) at runtime?</p>\n"}, {"tags": ["c", "windows", "sockets", "tcp", "ip"], "comments": [{"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1529473366, "post_id": 50939365, "comment_id": 88879688, "body": "This is not related to SMTP, retagged the question therefore."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 2, "creation_date": 1529473749, "post_id": 50939365, "comment_id": 88879824, "body": "<code>AF_INET</code> and <code>struct sockaddr_in</code> are to connect using IPv4 only. To do IPv6 use can use <code>AF_INET6</code> and <code>struct sockaddr_in6</code>."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1529543716, "post_id": 50939365, "comment_id": 88915307, "body": "OT:  error messages should be output to <code>stderr</code>, not <code>stdout</code>  and when the error indication is from a C library function, also output the text version of the error.  The function: <code>perror()</code> does all that for you.  Note: doesn&#39;t windows have a function: <code>getLastError()</code> or similar?"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1529543885, "post_id": 50939365, "comment_id": 88915342, "body": "OT:  in general, a leading underscore followed by a capital letter is reserved for C."}], "answers": [{"tags": [], "owner": {"reputation": 3984, "user_id": 541591, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/74eceb067d98fe7fe1b047a70e06cc7b?s=128&d=identicon&r=PG", "display_name": "James Wong", "link": "https://stackoverflow.com/users/541591/james-wong"}, "is_accepted": false, "score": 1, "last_activity_date": 1529463899, "creation_date": 1529463899, "answer_id": 50939580, "question_id": 50939365, "link": "https://stackoverflow.com/questions/50939365/c-socket-cant-connect-to-smtp-server/50939580#50939580", "title": "C - socket can&#39;t connect to SMTP server", "body": "<p>It's very likely that the machine you are using is still on IPv4. Since the address you have right now is an IPv6 format <code>2607:f8b0:400c:c05::6c</code></p>\n\n<p>To obtain the IPv4 address you can run a <code>dig</code> command as so:</p>\n\n<p><code>dig A smtp.gmail.com</code></p>\n\n<p>Here is a sample output</p>\n\n<pre><code>C:\\Users\\PC-James&gt;dig A smtp.gmail.com\n\n; &lt;&lt;&gt;&gt; DiG 9.10.3-P4 &lt;&lt;&gt;&gt; A smtp.gmail.com\n;; global options: +cmd\n;; Got answer:\n;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 61819\n;; flags: qr rd ra; QUERY: 1, ANSWER: 3, AUTHORITY: 0, ADDITIONAL: 1\n\n;; OPT PSEUDOSECTION:\n; EDNS: version: 0, flags:; udp: 512\n;; QUESTION SECTION:\n;smtp.gmail.com.                        IN      A\n\n;; ANSWER SECTION:\nsmtp.gmail.com.         299     IN      CNAME   gmail-smtp-msa.l.google.com.\ngmail-smtp-msa.l.google.com. 299 IN     A       108.177.125.108\ngmail-smtp-msa.l.google.com. 299 IN     A       108.177.125.109\n</code></pre>\n\n<p>In my region, the IPv4 address of Google's SMTP servers would be <code>108.177.125.108</code></p>\n\n<p>If you don't have <code>dig</code> on your computer, you can also run the request via the web interface from <a href=\"https://toolbox.googleapps.com/apps/dig/\" rel=\"nofollow noreferrer\">Google's Toolbox</a>.</p>\n"}], "owner": {"reputation": 336, "user_id": 7502346, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/3e3d3a4364b52890bf50df9486bc42b0?s=128&d=identicon&r=PG&f=1", "display_name": "Dskato", "link": "https://stackoverflow.com/users/7502346/dskato"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 249, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1529473336, "creation_date": 1529461874, "last_edit_date": 1529473336, "question_id": 50939365, "link": "https://stackoverflow.com/questions/50939365/c-socket-cant-connect-to-smtp-server", "title": "C - socket can&#39;t connect to SMTP server", "body": "<p>I am trying to connect to a Gmail SMTP server to send an e-mail, but when i try to connect I get an error, the socket can't be connected. I tried to get the IP from Gmail SMTP but I just get 2607:f8b0:400c:c05::6c.</p>\n\n<pre><code>#define IP \"2607:f8b0:400c:c05::6c\"// Gmail smtp ip \n#define DOOR 25           \n#define FROM \"someemail@gmail.com\"\n#define TO \"dskato0603@gmail.com\" \n#define SUBJECT \"Data\"\n#define _MAX_CHAR 20    \n\n\n\n\n#define _OPEN   \"HELO default\\r\\n\"\\\n            \"MAIL FROM: &lt;\"\n\n#define _RCPT   \"&gt;\\r\\nRCPT TO: &lt;\"\n#define _DATA   \"&gt;\\r\\nDATA\\r\\n\"\\\n            \"From: &lt;\"\n\n#define _SUB    \"&gt;\\r\\nSubject: \"\n#define _NEWLINE    \"\\r\\n\\r\\n\"\n\n#define _CLOSE  \"\\r\\n.\\r\\n\"\\\n            \"QUIT\\r\\n\"\n\n\nint send_mail ( char * subject, char * message, char * to, char * from, const \nchar ip [ 17 ], int door )\n{\nint sock;\nstruct sockaddr_in saddr;\n\nWSADATA wsadata;\nif ( WSAStartup ( MAKEWORD ( 2, 2 ), &amp; wsadata ) != 0 ) {\n    printf(\"Hubo un error MAKE WORD\");\n    return -1;\n}\n\nif ( ( sock = socket ( AF_INET, SOCK_STREAM, 0 ) ) &lt; 0) {\n    printf(\"Hubo un error CREANDO EL SOCKET\");\n    return -1;\n}\n\nsaddr . sin_family = AF_INET;\nsaddr . sin_addr . s_addr = inet_addr ( ip );\nsaddr . sin_port = htons ( door );\n\nif ( connect ( sock, ( struct sockaddr * ) &amp; saddr, sizeof ( saddr ) ) &lt; 0 ) {\n    printf(\"Hubo un error CONECTANDO EL SOCKET\");\n    return -1;\n}\n\nsize_t check_size = get_len ( _OPEN );\nif ( check_size != send ( sock, _OPEN, check_size, 0 ) ) {\n    printf(\"Hubo un error EVIANDO OPEN\");\n    return -1;\n}\n\ncheck_size = get_len ( from );\nif ( check_size != send ( sock, from, check_size, 0 ) ) {\n    printf(\"Hubo un error ENVIANDO FROM\");\n    return -1;\n}\n\ncheck_size = get_len ( _RCPT );\nif ( check_size != send ( sock, _RCPT, check_size, 0 ) ) {\n    printf(\"Hubo un error ENVIANDO RCTP\");\n    return -1;\n}\n\ncheck_size = get_len ( to );\nif ( check_size != send ( sock, to, check_size, 0 ) ) {\n    printf(\"Hubo un error ENVIANDO TO\");\n    return -1;\n}\n\ncheck_size = get_len ( _DATA );\nif ( check_size != send ( sock, _DATA, check_size, 0 ) ) {\n    printf(\"Hubo un error ENVIANDO DATA\");\n    return -1;\n}\n\ncheck_size = get_len ( from );\nif ( check_size != send ( sock, from, check_size, 0 ) ) {\n    printf(\"Hubo un error ENVIANDO from\");\n    return -1;\n}\n\ncheck_size = get_len ( _SUB );\nif ( check_size != send ( sock, _SUB, check_size, 0 ) ) {\n    printf(\"Hubo un error ENVIANDO sub\");\n    return -1;\n}\n\ncheck_size = get_len ( subject );\nif ( check_size != send ( sock, subject, check_size, 0 ) ) {\n    printf(\"Hubo un error ENVIANDO subjet\");\n    return -1;\n}\n\ncheck_size = get_len ( _NEWLINE );\nif ( check_size != send ( sock, _NEWLINE, check_size, 0 ) ) {\n    printf(\"Hubo un error ENVIANDO newline\");\n    return -1;\n}\n\ncheck_size = get_len ( message );\nif ( check_size != send ( sock, message, check_size, 0 ) ) {\n    printf(\"Hubo un error ENVIANDO message\");\n    return -1;\n}\n\ncheck_size = get_len ( _CLOSE );\nif ( check_size != send ( sock, _CLOSE, check_size, 0 ) ) {\n    printf(\"Hubo un error ENVIANDO close\");\n    return -1;\n}\n\nclosesocket ( sock );\nWSACleanup ( );\n\nreturn 0;\n }\n</code></pre>\n\n<p>What is wrong with this?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 35, "user_id": 9917647, "user_type": "registered", "profile_image": "https://graph.facebook.com/2217264141647602/picture?type=large", "display_name": "GeneNight", "link": "https://stackoverflow.com/users/9917647/genenight"}, "reply_to_user": {"reputation": 6975, "user_id": 3121023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f52448806175b9aa66c86d40cf0829f1?s=128&d=identicon&r=PG&f=1", "display_name": "user3121023", "link": "https://stackoverflow.com/users/3121023/user3121023"}, "edited": false, "score": 0, "creation_date": 1529457907, "post_id": 50938929, "comment_id": 88876065, "body": "It doesn&#39;t work, I tried already"}, {"owner": {"reputation": 35, "user_id": 9917647, "user_type": "registered", "profile_image": "https://graph.facebook.com/2217264141647602/picture?type=large", "display_name": "GeneNight", "link": "https://stackoverflow.com/users/9917647/genenight"}, "reply_to_user": {"reputation": 6975, "user_id": 3121023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f52448806175b9aa66c86d40cf0829f1?s=128&d=identicon&r=PG&f=1", "display_name": "user3121023", "link": "https://stackoverflow.com/users/3121023/user3121023"}, "edited": false, "score": 0, "creation_date": 1529457977, "post_id": 50938929, "comment_id": 88876076, "body": "I&#39;m sorry, it still takes more than 20 characters"}, {"owner": {"reputation": 35, "user_id": 9917647, "user_type": "registered", "profile_image": "https://graph.facebook.com/2217264141647602/picture?type=large", "display_name": "GeneNight", "link": "https://stackoverflow.com/users/9917647/genenight"}, "reply_to_user": {"reputation": 6975, "user_id": 3121023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f52448806175b9aa66c86d40cf0829f1?s=128&d=identicon&r=PG&f=1", "display_name": "user3121023", "link": "https://stackoverflow.com/users/3121023/user3121023"}, "edited": false, "score": 0, "creation_date": 1529458452, "post_id": 50938929, "comment_id": 88876180, "body": "Yes, I&#39;m sure about that. Anyway, I just realized that it works, but another problem has occured. The new vector of chars will be appended to the last one for no reason after the 20 characters."}, {"owner": {"reputation": 35, "user_id": 9917647, "user_type": "registered", "profile_image": "https://graph.facebook.com/2217264141647602/picture?type=large", "display_name": "GeneNight", "link": "https://stackoverflow.com/users/9917647/genenight"}, "reply_to_user": {"reputation": 6975, "user_id": 3121023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f52448806175b9aa66c86d40cf0829f1?s=128&d=identicon&r=PG&f=1", "display_name": "user3121023", "link": "https://stackoverflow.com/users/3121023/user3121023"}, "edited": false, "score": 0, "creation_date": 1529458756, "post_id": 50938929, "comment_id": 88876244, "body": "I tried to open another project and check the code, it works fine, I need to find out where my main project is bugged, thank you for the help."}, {"owner": {"reputation": 35, "user_id": 9917647, "user_type": "registered", "profile_image": "https://graph.facebook.com/2217264141647602/picture?type=large", "display_name": "GeneNight", "link": "https://stackoverflow.com/users/9917647/genenight"}, "reply_to_user": {"reputation": 6975, "user_id": 3121023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f52448806175b9aa66c86d40cf0829f1?s=128&d=identicon&r=PG&f=1", "display_name": "user3121023", "link": "https://stackoverflow.com/users/3121023/user3121023"}, "edited": false, "score": 0, "creation_date": 1529459160, "post_id": 50938929, "comment_id": 88876304, "body": "Yeah, I got that, again thank your for the explanation, that clarifies everything."}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1529483932, "post_id": 50938929, "comment_id": 88885084, "body": "Why not combine your approaches - use a field width with <code>%[</code> like this: <code>%20[^\\n]</code>."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1529515352, "post_id": 50938929, "comment_id": 88905363, "body": "Please remove the <code>fflush(stdin);</code>. It is useless and has undefined behavior. Also you must break from the loop if <code>fgets()</code> returns <code>NULL</code>."}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 9917647, "user_type": "registered", "profile_image": "https://graph.facebook.com/2217264141647602/picture?type=large", "display_name": "GeneNight", "link": "https://stackoverflow.com/users/9917647/genenight"}, "edited": false, "score": 0, "creation_date": 1529501792, "post_id": 50941708, "comment_id": 88896665, "body": "The first solution that you are giving me was suggested by someone in the comments yesterday, but I&#39;m looking right now and I think the user deleted his messages. I managed to solve my problem by using &quot;scanf(&quot;%20[^\\n]&quot;, str)&quot;, but I&#39;d like to change it as a function, that&#39;s why I&#39;ll try out the second solution suggested by you, thanks a lot for the help."}, {"owner": {"reputation": 35, "user_id": 9917647, "user_type": "registered", "profile_image": "https://graph.facebook.com/2217264141647602/picture?type=large", "display_name": "GeneNight", "link": "https://stackoverflow.com/users/9917647/genenight"}, "edited": false, "score": 0, "creation_date": 1529502415, "post_id": 50941708, "comment_id": 88897136, "body": "I don&#39;t know how to update my question by putting the solution, the second one works like a charm, thank you so much."}, {"owner": {"reputation": 35, "user_id": 9917647, "user_type": "registered", "profile_image": "https://graph.facebook.com/2217264141647602/picture?type=large", "display_name": "GeneNight", "link": "https://stackoverflow.com/users/9917647/genenight"}, "edited": false, "score": 0, "creation_date": 1529503269, "post_id": 50941708, "comment_id": 88897738, "body": "I only need to solve the last problem, I don&#39;t want to take &#39;\\n&#39; as first value of input, how do I check that?"}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 35, "user_id": 9917647, "user_type": "registered", "profile_image": "https://graph.facebook.com/2217264141647602/picture?type=large", "display_name": "GeneNight", "link": "https://stackoverflow.com/users/9917647/genenight"}, "edited": false, "score": 0, "creation_date": 1529514028, "post_id": 50941708, "comment_id": 88904644, "body": "@GeneNight:  There is no need to modify the question to add a solution or a solved remark. Regarding how to treat empty lines, you can test if the line is empty after stripping the newline: <code>if (*s == &#39;\\0&#39;) { printf(&quot;invalid input\\n&quot;); return 1; }</code> and test the return value at the calling point."}], "tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": false, "score": 2, "last_activity_date": 1529476472, "creation_date": 1529476472, "answer_id": 50941708, "question_id": 50938929, "link": "https://stackoverflow.com/questions/50938929/insert-a-certain-number-of-characters-with-spaces-included/50941708#50941708", "title": "Insert a certain number of characters with spaces included", "body": "<p>The format for character classes does <strong>not</strong> have a trailing <code>s</code>, it is written this way:</p>\n\n<pre><code>scanf(\"%[^\\n]\", str)\n</code></pre>\n\n<p>If you wish to limit the maximum number of characters stored into the destination array, specify this number between the <code>%</code> and the <code>[</code>:</p>\n\n<pre><code>scanf(\"%20[^\\n]\", str)\n</code></pre>\n\n<p>Note however that the conversion will fail and <code>scanf()</code> will return <code>0</code> if there is an empty line pending for this conversion specification.</p>\n\n<p>It is a common mistake to omit the test on the return value of <code>scanf()</code>, causing undefined behavior in case of conversion failures because the destination variables are left in their previous state (uninitialized in many cases).</p>\n\n<p>It may be more effective to use <code>fgets()</code> and remove the trailing newline this way:</p>\n\n<pre><code>if (fgets(s, 20, stdin)) {\n    /* line was read, can be an empty line */\n    s[strcspn(s, \"\\n\")] = '\\0';  /* remove the trailing newline if any */\n    ...\n} else {\n    /* fgets() failed, either at end-of-file or because of I/O error */\n    ...\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 66, "user_id": 6112265, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e51ff31b427e482facc406c1ebd2c681?s=128&d=identicon&r=PG&f=1", "display_name": "Sadiq Nayeem", "link": "https://stackoverflow.com/users/6112265/sadiq-nayeem"}, "is_accepted": false, "score": 1, "last_activity_date": 1529480570, "creation_date": 1529480570, "answer_id": 50942854, "question_id": 50938929, "link": "https://stackoverflow.com/questions/50938929/insert-a-certain-number-of-characters-with-spaces-included/50942854#50942854", "title": "Insert a certain number of characters with spaces included", "body": "<p>You can use the following:</p>\n\n<pre><code>for(i = 0; i &lt; x; i++) \n{\n    getchar(c);\n    if(c == '\\n') break;\n    str[i] = c; \n}\n</code></pre>\n\n<p>But you must have to be aware of the existing newlines in the buffer. :)</p>\n"}], "owner": {"reputation": 35, "user_id": 9917647, "user_type": "registered", "profile_image": "https://graph.facebook.com/2217264141647602/picture?type=large", "display_name": "GeneNight", "link": "https://stackoverflow.com/users/9917647/genenight"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1529504155, "creation_date": 1529457765, "last_edit_date": 1529504155, "question_id": 50938929, "link": "https://stackoverflow.com/questions/50938929/insert-a-certain-number-of-characters-with-spaces-included", "title": "Insert a certain number of characters with spaces included", "body": "<p>What I'm trying to accomplish is to take no more than \"x\" characters (spaces included) as input. I only know how to do both of them separately with <code>scanf</code>,</p>\n\n<p>like the following:</p>\n\n<pre><code>scanf(\"%20s\",str)\n</code></pre>\n\n<p>This takes no more than 20 characters.</p>\n\n<p><code>scanf(\"%[^\\n]s\",str)</code> takes spaces as well, but it has no limit.\nI tried <code>getline</code> but it takes the <code>\\n</code> as a value in the string as well and I don't want that. I hope I was clear enough about what I'm asking.</p>\n\n<p>From what @chqrlie has told me I wrote this fuction: </p>\n\n<pre><code>void getstring(char *str, int len)\n{\n    do\n    {\n        if (fgets(str, len, stdin))\n        {\n            fflush(stdin);\n// if is not the first character to be the new line then change it to '\\0' which is the end of the string.\n            if (str[0] != '\\n')\n                str[strcspn(str, \"\\n\")] = '\\0';\n        }\n    }while (str[0] == '\\n'); // Check if the user has inserted a new line as first character\n}\n</code></pre>\n"}, {"tags": ["c", "function-pointers", "abstract-syntax-tree", "clang-static-analyzer", "clang-query"], "comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 3, "creation_date": 1529458313, "post_id": 50938019, "comment_id": 88876146, "body": "Does it matter that your code is invalid?  You cannot return a value from a function declared to return <code>void</code>."}], "answers": [{"tags": [], "owner": {"reputation": 690, "user_id": 6661026, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/36f9bbecbbd034e86d0058d4f66140b2?s=128&d=identicon&r=PG&f=1", "display_name": "TheAhmad", "link": "https://stackoverflow.com/users/6661026/theahmad"}, "is_accepted": true, "score": 1, "last_activity_date": 1529534230, "creation_date": 1529534230, "answer_id": 50958004, "question_id": 50938019, "link": "https://stackoverflow.com/questions/50938019/matching-function-pointers-in-clang-query/50958004#50958004", "title": "Matching Function Pointers in Clang-Query", "body": "<p>Finally, this is the answer for a call to a function pointer. The main difficulty was to detect the type of function pointers using the query. So I added the <code>ignoringParens(functionType())</code> traversal matcher to solve the problem. A simple usage of <code>functionType()</code> will not work.</p>\n\n<pre><code>match callExpr(hasDescendant(memberExpr(hasType(pointerType(pointee(ignoringParens(functionType()))))).bind(\"member\")))\n</code></pre>\n"}], "owner": {"reputation": 690, "user_id": 6661026, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/36f9bbecbbd034e86d0058d4f66140b2?s=128&d=identicon&r=PG&f=1", "display_name": "TheAhmad", "link": "https://stackoverflow.com/users/6661026/theahmad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 186, "favorite_count": 1, "accepted_answer_id": 50958004, "answer_count": 1, "score": 0, "last_activity_date": 1529534230, "creation_date": 1529449157, "last_edit_date": 1529529561, "question_id": 50938019, "link": "https://stackoverflow.com/questions/50938019/matching-function-pointers-in-clang-query", "title": "Matching Function Pointers in Clang-Query", "body": "<p>What is the query to match a function pointer, e.g., in the following code:</p>\n\n<pre><code>int foo(struct A *a, int b)\n{\n    return a-&gt;x-&gt;y(b);\n}\n</code></pre>\n\n<p><code>y</code> is the function pointer to match.</p>\n"}, {"tags": ["c", "pointers", "literals", "c-strings"], "comments": [{"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1529449559, "post_id": 50938018, "comment_id": 88874423, "body": "Arrays are not pointers.  There are many, many explanations of this here on SO, and elsewhere on the net.  Yes, you can assign a pointer so it points at an array.  No, you can&#39;t assign an array so that it points at anything (because it&#39;s not a pointer).  The initialization <code>char cString[] = &quot;Hello World&quot;</code> does not involve any pointers -- the symbol <code>cString</code> ends up being the address of an array of 12 characters, initialized with the characters from &quot;Hello World&quot;."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1529464634, "post_id": 50938018, "comment_id": 88877426, "body": "You write &quot;so-called &#39;array&#39;&quot; as if there were something doubtful about it. There is not. The term &quot;array&quot; is well defined in C, and the standard explicitly specifies that part of the process of translating C source files into programs is to add a null byte to those of each string literal, and to use the resulting byte sequences to initialize static arrays just long enough to accommodate them.  There&#39;s no &quot;as if&quot; or &quot;like&quot; -- string literals appearing in C source code correspond to <i>bona fide</i> arrays in programs."}, {"owner": {"reputation": 1810, "user_id": 5500589, "user_type": "registered", "accept_rate": 35, "profile_image": "https://i.stack.imgur.com/IldVR.jpg?s=128&g=1", "display_name": "Galaxy", "link": "https://stackoverflow.com/users/5500589/galaxy"}, "edited": false, "score": 0, "creation_date": 1529465243, "post_id": 50938018, "comment_id": 88877541, "body": "I do not understand &quot;bona fide&quot;. My point is that the string literal appears to be an array stored in the .rodata section of the program. However, it is not a array as I, the programmer, would declare it explicitly in the code: char array[];"}], "answers": [{"tags": [], "owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "is_accepted": true, "score": 6, "last_activity_date": 1529450377, "last_edit_date": 1529450377, "creation_date": 1529449798, "answer_id": 50938110, "question_id": 50938018, "link": "https://stackoverflow.com/questions/50938018/what-happens-when-a-char-array-gets-initialized-from-a-string-literal/50938110#50938110", "title": "What happens when a char array gets initialized from a string literal?", "body": "<p>Your understanding of memory layout is more or less correct. But the problem you are having is one of initialization semantics in C.</p>\n\n<p>The <code>=</code> symbol in a declaration here is NOT the assignment operator. Instead, it is syntax that specifies the initializer for a variable being instantiated.  In the general case, <code>T x = y;</code> is not the same as <code>T x; x = y;</code>.</p>\n\n<p>There is a language rule that a character array can be initialized from a string literal. (The string literal is not \"evaluated to its base address\" in this context).  There is <strong>not</strong> a language rule that an array can be initialized from a pointer to the elements intended to be copied into the array.</p>\n\n<p>Why are the rules like this? \"Historical reasons\".</p>\n"}, {"tags": [], "owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "is_accepted": false, "score": 3, "last_activity_date": 1529450136, "last_edit_date": 1529450136, "creation_date": 1529449829, "answer_id": 50938114, "question_id": 50938018, "link": "https://stackoverflow.com/questions/50938018/what-happens-when-a-char-array-gets-initialized-from-a-string-literal/50938114#50938114", "title": "What happens when a char array gets initialized from a string literal?", "body": "<blockquote>\n  <p>I am assuming that as in the previous situation <code>\"Hello World\"</code> also degrades to the address of <code>'H'</code> and <code>0x4</code>.</p>\n</blockquote>\n\n<p>Not really: <code>cString[]</code> gets a completely new address in memory. Compiler allocates 12 <code>char</code>s to it, and initializes them with the content of <code>\"Hello World\"</code> string literal.</p>\n\n<blockquote>\n  <p>I assume that <code>\"Hello World\"</code> evaluates to its base address, <code>0x4</code>. Does using a string literal in the code return the base address to the \"array\" where the chars are stored in the memory?</p>\n</blockquote>\n\n<p><code>cString</code> may be <em>converted</em> to <code>char*</code> later on, yielding its base address, but it remains an array in the regular contexts. In particular, if you invoke <code>sizeof(cString)</code> you would get the size of the array, not the size of the pointer.</p>\n\n<blockquote>\n  <p>How come you can't use a char pointer as a temporary placeholder to store the base address of a string literal?</p>\n</blockquote>\n\n<p>You can. However, once a string literal is assigned to <code>char *</code>, it stops being a string literal, at least as far as the compiler is concerned. It becomes a <code>char *</code> pointer, no different from other <code>char *</code> pointers.</p>\n\n<p>Note that modern C compilers combine identical string literals as an optimization, so if you write</p>\n\n<pre><code>#define HELLO_WORLD \"Hello World\"\n...\nchar* cptr = HELLO_WORLD;\nchar cString[] = HELLO_WORLD;\n</code></pre>\n\n<p>and turn optimization on, the compiler would eliminate duplicate copies of the string literal.</p>\n"}, {"comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1529450964, "post_id": 50938187, "comment_id": 88874712, "body": "In the abstract machine, there is a string literal which is copied into <code>cString</code>. In terms of <i>observable behaviour</i> the two codes you give are the same. The options for implementing it could be described as an optimization issue."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1529451304, "post_id": 50938187, "comment_id": 88874784, "body": "@M.M: true but <i>copying</i> the string literal is somewhat ambiguous, it does not precisely describe the semantics of another example <code>char cString[12] = { &quot;Hello&quot; };</code> is equivalent to <code>char cString[12] = { &#39;H&#39;, &#39;e&#39;, &#39;l&#39;, &#39;l&#39;, &#39;o&#39;, &#39;\\0&#39;, &#39;\\0&#39;, &#39;\\0&#39;, &#39;\\0&#39;, &#39;\\0&#39;, &#39;\\0&#39;, &#39;\\0&#39; };</code>, not <code>char cString[12]; strcpy(cString, &quot;Hello&quot;);</code>"}], "tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": false, "score": 3, "last_activity_date": 1529450581, "creation_date": 1529450581, "answer_id": 50938187, "question_id": 50938018, "link": "https://stackoverflow.com/questions/50938018/what-happens-when-a-char-array-gets-initialized-from-a-string-literal/50938187#50938187", "title": "What happens when a char array gets initialized from a string literal?", "body": "<p>The second definition <code>char cString[] = \"Hello World\";</code> is a shorthand for this equivalent definition:</p>\n\n<pre><code>char cString[12] = { 'H', 'e', 'l', 'l', 'o', ' ', 'W', 'o', 'r', 'l', 'd', '\\0' };\n</code></pre>\n\n<p>If this definition occurs as a global scope or with <code>static</code> storage, <code>cString</code> will be in the <code>.data</code> segment with the initial contents in the executable image. If it occurs un the scope of a function with automatic storage, the compiler will allocate automatic storage for the array (reserving space on the stack frame or equivalent) and generate code to perform the initialization at run-time.</p>\n"}], "owner": {"reputation": 1810, "user_id": 5500589, "user_type": "registered", "accept_rate": 35, "profile_image": "https://i.stack.imgur.com/IldVR.jpg?s=128&g=1", "display_name": "Galaxy", "link": "https://stackoverflow.com/users/5500589/galaxy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 971, "favorite_count": 0, "accepted_answer_id": 50938110, "answer_count": 3, "score": 5, "last_activity_date": 1529450581, "creation_date": 1529449150, "question_id": 50938018, "link": "https://stackoverflow.com/questions/50938018/what-happens-when-a-char-array-gets-initialized-from-a-string-literal", "title": "What happens when a char array gets initialized from a string literal?", "body": "<p>As I understand it, the following code works like so:</p>\n\n<pre><code>char* cptr = \"Hello World\";\n</code></pre>\n\n<p>\"Hello World\" lives in the <code>.rodata</code> section of the program's memory. The string literal <code>\"Hello World\"</code> returns a pointer to the base address of the string, or the address of the first element in the so-called \"array\", since the chars are laid out sequentially in memory it would be the 'H'. This is my little diagram as I visualize the string literal getting stored in the memory:</p>\n\n<pre><code>0x4 : 'H'\n0x5 : 'e'\n0x6 : 'l'\n0x6 : 'l'\n0x7 : 'o'\n0x8 : ' '\n0x9 : 'W'\n0xa : 'o'\n0xb : 'r'\n0xc : 'l'\n0xd : 'd'\n0xe : '\\0'\n</code></pre>\n\n<p>So the declaration above becomes:</p>\n\n<pre><code>char* cptr = 0x4;\n</code></pre>\n\n<p>Now cptr points to the string literal. I'm just making up the addresses.</p>\n\n<pre><code>0xa1 : 0x4\n</code></pre>\n\n<p>Now how does this code work?</p>\n\n<pre><code>char cString[] = \"Hello World\";\n</code></pre>\n\n<p>I am assuming that as in the previous situation <code>\"Hello World\"</code> also degrades to the address of 'H' and 0x4.</p>\n\n<pre><code>char cString[] = 0x4;\n</code></pre>\n\n<p>I am reading the <code>=</code> as an overloaded assignment operator when it used with initialization of a char array. As I understand, at initialization of C-string only, it copies char-by-char starting at the given base address into the C-string until it hits a '\\0' as the last char copied. It also allocates enough memory for all the chars. Because overloaded operators are really just functions, I assume that it's internal implementation is similar to <code>strcpy()</code>.</p>\n\n<p>I would like one of the more experienced C programmers to confirm my assumptions of how this code works. This is my visualization of the C-string after the chars from the string literal get copied into it:</p>\n\n<pre><code>0xb4 : 'H'\n0xb5 : 'e'\n0xb6 : 'l'\n0xb6 : 'l'\n0xb7 : 'o'\n0xb8 : ' '\n0xb9 : 'W'\n0xba : 'o'\n0xbb : 'r'\n0xbc : 'l'\n0xbd : 'd'\n0xbe : '\\0'\n</code></pre>\n\n<p>Once again, the addresses are arbitrary, the point is that the C-string in the stack is distinct from the string literal in the <code>.rodata</code> section in memory.</p>\n\n<p>What am I trying to do? I am trying to use a char pointer to temporarily hold the base address of the string literal, and use that same char pointer (base address of string literal) to initialize the C-string.</p>\n\n<pre><code>char* cptr = \"Hello World\";\nchar cString[] = cptr;\n</code></pre>\n\n<p>I assume that <code>\"Hello World\"</code> evaluates to its base address, <code>0x4</code>. So this code ought to look like this:</p>\n\n<pre><code>char* cptr = 0x4;\nchar cString[] = 0x4;\n</code></pre>\n\n<p>I assume that it should be no different from <code>char cString[] = \"Hello World\";</code> since \"Hello World\" evaluates to its base address, and that is what is stored in the char pointer!</p>\n\n<p>However, gcc gives me an error:</p>\n\n<pre><code>error: invalid initializer\nchar cString[] = cptr;\n                 ^\n</code></pre>\n\n<ol>\n<li>How come you can't use a char pointer as a tempoorary placeholder to store   the base address of a string literal?</li>\n<li>How does this code work? Are my assumptions correct?</li>\n<li>Does using a string literal in the code return the base address to the \"array\" where the chars are stored in the memory?</li>\n</ol>\n"}, {"tags": ["c", "image-processing", "barcode", "bmp"], "comments": [{"owner": {"reputation": 26606, "user_id": 4603670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7eabc1427aa3c8185153cc81978289a?s=128&d=identicon&r=PG&f=1", "display_name": "Barmak Shemirani", "link": "https://stackoverflow.com/users/4603670/barmak-shemirani"}, "edited": false, "score": 0, "creation_date": 1529454019, "post_id": 50937988, "comment_id": 88875299, "body": "Change the 2nd loop to <code>for(int j = 0; j &lt; width; j++) if(j % 2 == 0) { fwrite(white, 3, 1, barcode) } else { fwrite(black, 3, 1, barcode) }</code> This will write <code>width * 3</code> bytes for each line, followed by padding. You seem to be using Visual Studio which has bitmap support. Is this a homework where they make you do things in weird ways?"}, {"owner": {"reputation": 11, "user_id": 9964506, "user_type": "registered", "profile_image": "https://graph.facebook.com/10215338250984868/picture?type=large", "display_name": "Ben Ayash", "link": "https://stackoverflow.com/users/9964506/ben-ayash"}, "reply_to_user": {"reputation": 26606, "user_id": 4603670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7eabc1427aa3c8185153cc81978289a?s=128&d=identicon&r=PG&f=1", "display_name": "Barmak Shemirani", "link": "https://stackoverflow.com/users/4603670/barmak-shemirani"}, "edited": false, "score": 0, "creation_date": 1529479159, "post_id": 50937988, "comment_id": 88882296, "body": "Yes its a homework assignment and the teacher failed to teach bitmap format so Im trying to figure it out on my own, so far with little success"}], "answers": [{"comments": [{"owner": {"reputation": 144819, "user_id": 2836621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/suHg4.jpg?s=128&g=1", "display_name": "Mark Setchell", "link": "https://stackoverflow.com/users/2836621/mark-setchell"}, "edited": false, "score": 1, "creation_date": 1529475655, "post_id": 50941262, "comment_id": 88880571, "body": "Nice and easy to read. You can take the <code>if(white)&#47;else</code> outside the loop and set <code>value=0</code> or <code>value=255</code>  in <code>setColumn()</code> and just use <code>data[...]=value;</code> inside the loop."}, {"owner": {"reputation": 11, "user_id": 9964506, "user_type": "registered", "profile_image": "https://graph.facebook.com/10215338250984868/picture?type=large", "display_name": "Ben Ayash", "link": "https://stackoverflow.com/users/9964506/ben-ayash"}, "edited": false, "score": 0, "creation_date": 1529480430, "post_id": 50941262, "comment_id": 88883020, "body": "I tried using it and it seems to have c++/c# variations (std::ofstream filestream; and such) cause i couldnt use it so i tried to costumize it to plain c but somehow it didnt work and all i get &quot;the picture you are trying to open is empty&quot;"}, {"owner": {"reputation": 443, "user_id": 409007, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d70267d20fb95a4bf022689ab8c04e4?s=128&d=identicon&r=PG&f=1", "display_name": "Jon", "link": "https://stackoverflow.com/users/409007/jon"}, "edited": false, "score": 0, "creation_date": 1529508340, "post_id": 50941262, "comment_id": 88901246, "body": "Sorry about that. Missed the &#39;C&#39; part of the requirement. You can use the stdin <code>FILE</code> stream object and then the final data write would be: <code>fwrite(data, 1, height * width * 4, barcode); \tfclose(barcode);</code>"}], "tags": [], "owner": {"reputation": 443, "user_id": 409007, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d70267d20fb95a4bf022689ab8c04e4?s=128&d=identicon&r=PG&f=1", "display_name": "Jon", "link": "https://stackoverflow.com/users/409007/jon"}, "is_accepted": false, "score": 1, "last_activity_date": 1529476957, "last_edit_date": 1529476957, "creation_date": 1529474530, "answer_id": 50941262, "question_id": 50937988, "link": "https://stackoverflow.com/questions/50937988/generating-a-barcode-bmp-in-c/50941262#50941262", "title": "Generating a barcode BMP in c", "body": "<p>Try the below. Note that I've moved the BMP to a bit depth of 32. The wrapper function setColumn will allow you to set individual columns to black or white as you see fit. Much more manageable to think of the BMP as an array that you can freely manipulate instead of having to deal with a ton of <code>fwrite</code> logic.</p>\n\n<pre><code>#include \"stdafx.h\"\n#include &lt;fstream&gt;\n\n#define NEWBARCODE \"test.bmp\"\n#define WHITE 255\n#define BLACK 0\n\nvoid setColumn(unsigned char *data, const int height, const int width, const int colIndex, const int grayVal)\n{\n    for (int r = 0; r &lt; height; ++r)\n    {\n        data[r * width * 4 + colIndex * 4 + 0] = grayVal;\n        data[r * width * 4 + colIndex * 4 + 1] = grayVal;\n        data[r * width * 4 + colIndex * 4 + 2] = grayVal;\n        data[r * width * 4 + colIndex * 4 + 3] = 255;\n    }\n}\n\nint main()\n{\n    int width, height;\n    width = 141;\n    height = 70;\n\n    std::ofstream filestream;\n\n    filestream.open(NEWBARCODE, std::ios::beg | std::ios::out | std::ios::binary);\n\n    int filesize = 54 + 4 * width * height; \n\n    char bmpfileheader[14] = { 'B','M', 0,0,0,0, 0,0, 0,0, 54,0,0,0 };\n    char bmpinfoheader[40] = { 0x28,0,0,0, 141,0,0,0, 70,0,0,0, 1,0, 32,0,0,0,0,0,0x8c,0x05,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 };\n\n    bmpfileheader[2] = (unsigned char)(filesize);\n    bmpfileheader[3] = (unsigned char)(filesize &gt;&gt; 8);\n    bmpfileheader[4] = (unsigned char)(filesize &gt;&gt; 16);\n    bmpfileheader[5] = (unsigned char)(filesize &gt;&gt; 24);\n\n    filestream.write(bmpfileheader, 14);\n    filestream.write(bmpinfoheader, 40);\n\n    //Allocate BMP data block\n    unsigned char *data = new unsigned char[width * height * 4]{ 0 };\n\n    //Initialize BMP data to all black pixels\n    for (int i = 0; i &lt; width * height * 4; ++i)\n        data[i] = 0;\n\n    //Set white\n    for (int i = 75; i &lt; 100; ++i)\n        setColumn(data, height, width, i, WHITE);\n\n    //Set white\n    for (int i = 15; i &lt; 25; ++i)\n        setColumn(data, height, width, i, WHITE);\n\n    //Set black\n    for (int i = 20; i &lt; 23; ++i)\n        setColumn(data, height, width, i, BLACK);\n\n    filestream.write((const char *)data, height * width * 4);\n    filestream.close();\n\n    delete data;\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9964506, "user_type": "registered", "profile_image": "https://graph.facebook.com/10215338250984868/picture?type=large", "display_name": "Ben Ayash", "link": "https://stackoverflow.com/users/9964506/ben-ayash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 293, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1564865982, "creation_date": 1529448840, "last_edit_date": 1564865982, "question_id": 50937988, "link": "https://stackoverflow.com/questions/50937988/generating-a-barcode-bmp-in-c", "title": "Generating a barcode BMP in c", "body": "<p>I've been assigned to create a barcode image from a number generated randomly by me (that I've already done). So far I tried to create a BMP file and put in a simple black and white columns but my picture is distorted by other colors and not even in columns. I didn't even start to write the barcode itself (that itself is still a mystery to me), I tried to create it for almost 2 weeks now and to no avail.. I mostly need a program that writes black or white to the program by columns or row by row so i can put black or white at will.</p>\n\n<p>This is my code: </p>\n\n<pre><code>`int width, hight;\nwidth = 141;\nhight = 70;\nFILE* barcode;\nfopen_s(&amp;barcode,NEWBARCODE, \"wb\");\n\nint filesize = 54 + 3 * width*height;  //w is your image width, h is image height, both int\n\nchar bmpfileheader[14] = { 'B','M', 0,0,0,0, 0,0, 0,0, 54,0,0,0 };\nchar bmpinfoheader[40] = { 0x28,0,0,0, 141,0,0,0, 70,0,0,0, 1,0, 24,0,0,0,0,0,0x8c,0x05,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};\nunsigned char white[3] = {255,255,255 };\nunsigned char black[3] = {0,0,0 };\nunsigned char pad[1] = { 0 };\n\nbmpfileheader[2] = (unsigned char)(filesize);\nbmpfileheader[3] = (unsigned char)(filesize &gt;&gt; 8);\nbmpfileheader[4] = (unsigned char)(filesize &gt;&gt; 16);\nbmpfileheader[5] = (unsigned char)(filesize &gt;&gt; 24);\n\nfwrite(&amp;bmpfileheader, 1, 14, barcode);\nfwrite(&amp;bmpinfoheader, 1, 40, barcode);\n\nfor (int i = 0; i &lt; height; i++) { //columns\n    for (int j = 0; j &lt; width*3+1; j++) {\n        if (i % 2 == 0) {\n            fwrite(&amp;white, 1, 3, barcode);\n            fwrite(&amp;black, 1, 3, barcode);\n        }\n        else {\n            fwrite(&amp;black, 1, 3, barcode);\n            fwrite(&amp;white, 1, 3, barcode);\n        }\n    }\n    fwrite(&amp;pad, 1, 1, barcode);\n}\n</code></pre>\n\n<p>and that outputs the bmp file</p>\n\n<p><img src=\"https://i.stack.imgur.com/c8zkR.png\" alt=\"\"></p>\n\n<p>What is wrong? And if there are any tips to work on creating a bmp file would be greatly appreciated :)</p>\n"}, {"tags": ["c", "arrays", "pointers", "encryption"], "comments": [{"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 2, "creation_date": 1529450700, "post_id": 50937899, "comment_id": 88874659, "body": "And I bet there were warnings?"}, {"owner": {"reputation": 18851, "user_id": 414813, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/83284c54c3fc960dcdf8844ed92227d7?s=128&d=identicon&r=PG", "display_name": "CAFxX", "link": "https://stackoverflow.com/users/414813/cafxx"}, "edited": false, "score": 0, "creation_date": 1529452048, "post_id": 50937899, "comment_id": 88874914, "body": "Instead of saying &quot;please forgive my horrible formatting&quot; it would be much better to actually format the code so that people don&#39;t have to do it to help you. Your editor should be able to do it for you automatically BTW."}], "answers": [{"tags": [], "owner": {"reputation": 3971, "user_id": 2840714, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/s9vli.jpg?s=128&g=1", "display_name": "ChuckCottrill", "link": "https://stackoverflow.com/users/2840714/chuckcottrill"}, "is_accepted": false, "score": 0, "last_activity_date": 1529451638, "last_edit_date": 1529451638, "creation_date": 1529450303, "answer_id": 50938158, "question_id": 50937899, "link": "https://stackoverflow.com/questions/50937899/how-to-fix-segmenation-fault-in-this-simple-encryption-program/50938158#50938158", "title": "How to fix segmenation fault in this simple encryption program?", "body": "<p>There is a huge difference between \"\\0\" (double quote) and '\\0' (single quote). The first is a pointer to a 'string' literal (constant), and the second is a character literal constant. One is a pointer to char(acter), the other is char(acter).</p>\n\n<p>Do this to illustrate:</p>\n\n<pre><code>printf(\"%p\\n\", \"\\0\");\nprintf(\"%d\\n\", '\\0');\n</code></pre>\n\n<p>You use them interchangeably (<em>Python, Ruby, Perl, and R basically allow this</em>), the first is incorrect, the second is correct.</p>\n\n<pre><code>//don't do this\nwhile (sMessage[x] != \"\\0\") {\n    sMessage[x] += random;\n    x++;\n}\n\n//do this\nwhile ('\\0' != sMessage[x]) {\n    sMessage[x] -= random;\n    x++;\n}\n</code></pre>\n\n<p>Actually, the best thing to do is define a constant (either #define or const),</p>\n\n<pre><code>#define EOS ('\\0')\nconst char EOS = ('\\0');\nwhile (EOS != sMessage[x]) { //this is why I prefer #define literal\n</code></pre>\n\n<p>Note that Ruby and Perl allow string 'interpolation' on double-quoted strings, and do not allow string 'interpolation' on single quoted string.</p>\n\n<p>But even more important is to guard against walking off the end of strings, so pass the length of sMessage, and check that as you traverse the array. This is why for(;;) repetition structures exist.</p>\n\n<pre><code>void encrypt(char buffer[], size_t len, int random)\n...\nfor( x=0; x&lt;len &amp;&amp; (EOS != sMessage[x]; ++x ) {\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 17343, "user_id": 445976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c82b2b9bdcf1baaf4677238d59cf745f?s=128&d=identicon&r=PG", "display_name": "Blastfurnace", "link": "https://stackoverflow.com/users/445976/blastfurnace"}, "is_accepted": false, "score": 0, "last_activity_date": 1529451816, "creation_date": 1529451816, "answer_id": 50938321, "question_id": 50937899, "link": "https://stackoverflow.com/questions/50937899/how-to-fix-segmenation-fault-in-this-simple-encryption-program/50938321#50938321", "title": "How to fix segmenation fault in this simple encryption program?", "body": "<p>In options 1 and 2 where you prompt the user to enter a string you are doing:</p>\n\n<pre><code>scanf(\"%s\", &amp;iSelection);\n</code></pre>\n\n<p>This is clearly wrong because the <code>iSelection</code> variable is an <code>int</code> but the <code>\"%s\"</code> format specifier requires a string. I think you meant to do this instead:</p>\n\n<pre><code>scanf(\"%s\", myString);\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 9964503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HGukF.jpg?s=128&g=1", "display_name": "John C", "link": "https://stackoverflow.com/users/9964503/john-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 2, "score": -3, "last_activity_date": 1529451921, "creation_date": 1529448131, "question_id": 50937899, "link": "https://stackoverflow.com/questions/50937899/how-to-fix-segmenation-fault-in-this-simple-encryption-program", "title": "How to fix segmenation fault in this simple encryption program?", "body": "<p>I copied this exactly from the book I am reading after making multiple attempts at writing this program. I continue to get the same segmentation fault error.</p>\n\n<p>This is the book, the chapter 7: Pointers program. \n<a href=\"https://www.barnesandnoble.com/p/c-programming-for-the-absolute-beginner-michael-vine/1101415261/2678286102503?st=PLA&amp;sid=BNB_DRS_New+Marketplace+Shopping+Textbooks_00000000&amp;2sid=Google_&amp;sourceId=PLGoP211448&amp;gclid=CjwKCAjw06LZBRBNEiwA2vgMVU96G7-LHaUncLG9FGCb6hq96xniJRdf0InjdEqM7qFs4-ETXXwzURoC3lYQAvD_BwE\" rel=\"nofollow noreferrer\">https://www.barnesandnoble.com/p/c-programming-for-the-absolute-beginner-michael-vine/1101415261/2678286102503?st=PLA&amp;sid=BNB_DRS_New+Marketplace+Shopping+Textbooks_00000000&amp;2sid=Google_&amp;sourceId=PLGoP211448&amp;gclid=CjwKCAjw06LZBRBNEiwA2vgMVU96G7-LHaUncLG9FGCb6hq96xniJRdf0InjdEqM7qFs4-ETXXwzURoC3lYQAvD_BwE</a></p>\n\n<p>The debugger is saying \"Cannot access memory at address 0x7ffffffff000\", which is the address of sMessage[0]. I'm not sure why I can't access the contents of the array.</p>\n\n<p>Lastly, please forgive my horrible formatting. It's my first time asking a question.</p>\n\n<pre><code>    #include &lt;stdio.h&gt;\n    #include &lt;stdlib.h&gt;\n\n    // function prototypes\n    void encrypt(char [], int);\n    void decrypt(char [], int);\n\n    main()\n    {\n\nchar myString[21] = {'\\0'};\nint iSelection = 0;\nint iRand;\n\nsrand(time(NULL));\n\niRand = (rand() % 4); // random #, 1-4\nsystem(\"clear\");\n\nprintf(\"okay\");\n\nwhile( iSelection != 4) {\n\n    printf(\"\\n\\n1\\tEncrypt Clear Text\");\n    printf(\"\\n2\\tDecrypt Cipher Text\");\n    printf(\"\\n3\\tGenerate New Key\");\n    printf(\"\\n4\\tQuit\");\n    printf(\"\\nSelect a Cryptography Option:\");\n    scanf(\"%d\", &amp;iSelection);\n    switch (iSelection) {\n\n        case 1:\n        system(\"clear\");\n        printf(\"\\nEnter clear text: \");\n        scanf(\"%s\", &amp;iSelection);\n        encrypt(myString, iRand);\n        break;\n\n        case 2:\n        system(\"clear\");\n        printf(\"\\nEnter cipher text: \");\n        scanf(\"%s\", &amp;iSelection);\n        encrypt(myString, iRand);\n        break;\n\n        case 3:\n        system(\"clear\");\n        iRand = (rand() % 4); // random #, 1-4\n        printf(\"\\nNew Key Generated\\n\");\n        break;\n    } // end switch\n} // end while loop\n    } // end main\n\n    void encrypt(char sMessage[], int random)\n    {\nint x = 0;\n\n// encrypt the message by shifting each characters ASCII value\nwhile (sMessage[x] != \"\\0\") {\n    sMessage[x] += random;\n    x++;\n} // end while loop\nx = 0;\nprintf(\"Encrypted message is: \");\n\n// print encrypted messsage\nwhile (sMessage[x] != \"\\0\") {\n    printf(\"%c\", sMessage[x]);\n    x++;\n} // end while loop\n    } // end encrypt function\n\n    void decrypt(char sMessage[], int random)\n    {\nint x=0;\nx=0;\n\n// decrypt the message by shifting each characters ASCII value\nwhile (sMessage[x] != '\\0') {\n    sMessage[x] = sMessage[x] - random;\n    x++;\n} // end loop\n\nx = 0;\nprintf(\"\\n Decrypted Message is: \");\n\n// print decrypted message\nwhile (sMessage[x] != '\\0') {\nprintf(\"%c\", sMessage[x]);\nx++;\n\n} // end while loop\n\n    } // end decrypt function\n</code></pre>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 4, "creation_date": 1529446267, "post_id": 50937598, "comment_id": 88873588, "body": "Your code just causes undefined behaviour by using uninitialized variables,  the output is meaningless"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1529446390, "post_id": 50937598, "comment_id": 88873617, "body": "Note that with <code>*p=0</code> you don&#39;t make the pointer point somewhere, you&#39;re not assigning to the pointer. You&#39;re assigning to what the pointer <i>is pointing to</i>."}, {"owner": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 1, "creation_date": 1529446501, "post_id": 50937598, "comment_id": 88873649, "body": "if you have a variable <code>int *p; , then the statement </code>p = 0;` assigns 0 to <code>p</code> , that is, <code>p</code> is then a NULL pointer. The statement <code>*p = 0;</code> on the other hand assigns 0 to whatever <code>p</code> points to. You are not allowed to do that unless <code>p</code> points to something valid - which your code has many examples of not adhering to."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 1, "creation_date": 1529446512, "post_id": 50937598, "comment_id": 88873650, "body": "I think you are mistaking <i>pointer</i> and <i>index</i> notation. With an array, <code>array[n]</code> index notation is equivalent to <code>*(array + n)</code> in pointer notation (where <code>n</code> is simply the index (or offset) of the dereferenced element within the array) Obviously when <code>n = 0</code> pointer notation simplifies to <code>*array</code> to reference the 1st element of the array."}, {"owner": {"reputation": 7050, "user_id": 8033585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbcd92ce2da15d74815d79b2908132d3?s=128&d=identicon&r=PG&f=1", "display_name": "AGN Gazer", "link": "https://stackoverflow.com/users/8033585/agn-gazer"}, "edited": false, "score": 0, "creation_date": 1529446546, "post_id": 50937598, "comment_id": 88873669, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/36962226/why-can-you-assign-an-integer-value-to-an-uninitialized-pointer\">Why can you assign an integer value to an uninitialized pointer</a>"}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1529456355, "post_id": 50937598, "comment_id": 88875754, "body": "The pointer was actually &quot;initialized&quot; to 0x7ffeb36b5c30, not 1. And they aren&#39;t different. Why do you think they were different?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1529465353, "post_id": 50937598, "comment_id": 88877554, "body": "Good to see re-posted."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1529474707, "post_id": 50937598, "comment_id": 88880203, "body": "<code>int * p = 0;</code> is roughly the same as <code>int * p; p = 0;</code>. But definitely <b><i>not</i></b> the same as <code>int * p; *p = 0;</code>.  The <code>*</code> in the variable definition is a different from the de-referencing operator <code>*</code>."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1529486315, "post_id": 50937598, "comment_id": 88886503, "body": "See <a href=\"https://stackoverflow.com/a/32136460/584518\">this answer</a>."}], "answers": [{"tags": [], "owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "is_accepted": true, "score": 1, "last_activity_date": 1529454531, "creation_date": 1529454531, "answer_id": 50938606, "question_id": 50937598, "link": "https://stackoverflow.com/questions/50937598/how-is-zero-overloaded-when-assigning-values-to-pointers-in-c/50938606#50938606", "title": "How is zero &#39;overloaded&#39; when assigning values to pointers in C", "body": "<p>The concept you're asking about is <em>null pointer constants</em>.</p>\n\n<p>The C standard defines a null pointer constant as</p>\n\n<blockquote>\n  <p>An integer constant expression with the value <code>0</code>, or such an expression cast\n   to type <code>void *</code></p>\n</blockquote>\n\n<p>So the expression <code>0</code>, which is of type <code>int</code>, is also a null pointer constant. (Note that a null pointer constant needn't be of pointer type.)</p>\n\n<p>The standard further says that:</p>\n\n<blockquote>\n  <p>If a null pointer constant is converted to a pointer type, the\n  resulting pointer, called a <em>null pointer</em>, is guaranteed to compare\n  unequal to a pointer to any object or function.</p>\n</blockquote>\n\n<p>Given:</p>\n\n<pre><code>int n;\nint *p;\n</code></pre>\n\n<p>this:</p>\n\n<pre><code>p = 0;\n</code></pre>\n\n<p>implicitly converts the <code>int</code> expression <code>0</code> to a null pointer of type <code>int*</code>, while this:</p>\n\n<pre><code>n = 0;\n</code></pre>\n\n<p>or</p>\n\n<pre><code>*p = 0;\n</code></pre>\n\n<p>does not perform an implicit conversion, because the object being initialized is already of type <code>int</code>.</p>\n\n<p>The rules for when implicit conversions are invoked are stated in the description of the assignment operator.  The same rules apply to initialization, argument passing, and <code>return</code> statements. These rules explicitly state that a null pointer constant is converted to the target type.</p>\n\n<p>See the <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf\" rel=\"nofollow noreferrer\">N1570</a> draft of the C11 standard (large PDF).</p>\n\n<ul>\n<li>Null pointer constants and null pointers: 6.3.2.3</li>\n<li>Simple assignment: 6.15.6.1</li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 464, "user_id": 6688314, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b954d32dda14a7228f24cfa213f2b926?s=128&d=identicon&r=PG&f=1", "display_name": "flerb", "link": "https://stackoverflow.com/users/6688314/flerb"}, "edited": false, "score": 0, "creation_date": 1529520163, "post_id": 50938794, "comment_id": 88907705, "body": "In fairness to the book, I just started it, came across the interesting piece of code *p=0 having differing results at times and screwed myself up with the debugger instead of checking the docs...or continuing to read the book."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 464, "user_id": 6688314, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b954d32dda14a7228f24cfa213f2b926?s=128&d=identicon&r=PG&f=1", "display_name": "flerb", "link": "https://stackoverflow.com/users/6688314/flerb"}, "edited": false, "score": 0, "creation_date": 1529525195, "post_id": 50938794, "comment_id": 88909939, "body": "There is nothing wrong with chasing every rabbit-trail to its end. That&#39;s how we learn. We all screwed up pointers when starting to code in C. While pointers and pointer arithmetic are simple, it&#39;s a difficult concept to wrap your head around at first. Once you make peace with what a pointer is and that its <code>type</code> controls the number of bytes (offset) between <code>*p</code> and <code>*(p + 1)</code>, then you are on your way to a full understanding. Good luck with your coding."}], "tags": [], "owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "is_accepted": false, "score": 1, "last_activity_date": 1529457584, "last_edit_date": 1529457584, "creation_date": 1529456454, "answer_id": 50938794, "question_id": 50937598, "link": "https://stackoverflow.com/questions/50937598/how-is-zero-overloaded-when-assigning-values-to-pointers-in-c/50938794#50938794", "title": "How is zero &#39;overloaded&#39; when assigning values to pointers in C", "body": "<p>I'm not familiar with the book or article you cite, but it failed spectacularly in helping you <em>Understand and Use Pointers in C</em>.</p>\n\n<p><strong>What is a Pointer?</strong></p>\n\n<p>A pointer is simply a normal variable that holds the <em>address of</em> something else as its value. In other words, a pointer <em>points to</em> the address where something else can be found. Where you normally think of a variable holding an immediate values, such as <code>int a = 5;</code>, a pointer would simply hold the address where <code>5</code> is stored in memory, e.g. <code>int *b = &amp;a;</code>. It works the same way regardless what type of object the pointer points to. (a pointer, is just a pointer....)</p>\n\n<p><strong>How to Declare, Assign an Address to &amp; Reference the Value Pointed to</strong></p>\n\n<p>Let's take your example and look at what each line does (ignoring your <code>p</code> &amp; <code>pi</code> typos and using <code>p</code> only):</p>\n\n<pre><code>int num;    /* declares an integer 'num' whose value is uninitialized */\n\nint *p = 0; /* declares a pointer 'p' and ininializes the address\n             * to a the constant expression 0. (a Null Pointer Constant)\n             */\n</code></pre>\n\n<p>See <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.3.2.3p3\" rel=\"nofollow noreferrer\">C11 Standard - Null Pointer Constant (p3)</a> which is a constant expression with the value <code>0</code>, or such an expression cast to type <code>void *</code> (e.g. <code>(void *)0</code>). Virtually all C compilers, and if fact the C-Standard provide <code>NULL</code> for this purpose. (see: <a href=\"http://port70.net/~nsz/c/c11/n1570.html#7.19\" rel=\"nofollow noreferrer\">C11 Standard - 7.19 Common definitions </a>) So you would generally see:</p>\n\n<pre><code>int *p = NULL;  /* declare and initialize 'p' to the Null Pointer Constant */\n</code></pre>\n\n<p>Next the unary operator <code>'&amp;'</code> is used to obtain the <strong>address of</strong> an object. Here:</p>\n\n<pre><code>p = &amp;num;   /* assigns the address of 'num' as the value of 'p', so \n             * 'p' holds the address of 'num' (e.g. 'p' points to the\n             * memory location where 'num' is stored).\n             */\n</code></pre>\n\n<p>The unary <code>'*'</code> opertor is the <strong>dereference operator</strong> and provides a way to directly access the value located at the memory address held (pointed to) by a pointer, so:</p>\n\n<pre><code>*p = 0;     /* sets the value at the address held by 'p' to zero */\n</code></pre>\n\n<p>Now lets look at your code and output:</p>\n\n<pre><code>int num;\nint *p;                                \n\nprintf(\"0) %p is %d\\n\",p,*p);\n</code></pre>\n\n<p><strong>What is the address held by <code>p</code> and what is the value of <code>num</code>?</strong></p>\n\n<p>You have attempted to access the value of an <strong>uninitialized pointer</strong> and an <strong>uninitialized</strong> integer. You have just invoked <strong><em>Undefined Behavior</em></strong>. The defined operation of your code is over and anything can happen, from appearing to behave normally or SegFault'ing. You cannot access <strong>uninitialized values</strong>.</p>\n\n<pre><code>*p=0;\n\nprintf(\"1) %p is %d\\n\",p,*p);\n</code></pre>\n\n<p><code>p</code> is now initialized to the <em>Null Pointer Constant</em>, you cannot dereference a NULL pointer -- Undefined behavior again.</p>\n\n<pre><code>num=5;\np=&amp;num;\n\nprintf(\"2) Now %p is %d\\n\",p,*p);\n</code></pre>\n\n<p>Hallelujah! <code>num</code> is now initialized to <code>5</code> and <code>p</code> now holds (points to) a valid memory address! (but unfortunately once you invoke <em>Undefined Behavior</em>, the game is over, and you may or may not get the correct output, but luckily you appear to.</p>\n\n<pre><code>*p=0;\n\nprintf(\"3) p is not null, %p : %d\\n\",p,*p);\n</code></pre>\n\n<p>What does <code>p</code> point to? (hint: <code>num</code>). What does the <em>dereference operator do</em>? (hint: allows you to access the value at the memory location held by a pointer). So what did <code>*p = 0;</code> do? (hint: you just set the value of <code>num</code> to <code>0</code>, which is the value at the address held by <code>p</code>)</p>\n\n<p>Let me know if you have further questions.</p>\n"}], "owner": {"reputation": 464, "user_id": 6688314, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b954d32dda14a7228f24cfa213f2b926?s=128&d=identicon&r=PG&f=1", "display_name": "flerb", "link": "https://stackoverflow.com/users/6688314/flerb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 50938606, "answer_count": 2, "score": 0, "last_activity_date": 1529520358, "creation_date": 1529446168, "last_edit_date": 1529520358, "question_id": 50937598, "link": "https://stackoverflow.com/questions/50937598/how-is-zero-overloaded-when-assigning-values-to-pointers-in-c", "title": "How is zero &#39;overloaded&#39; when assigning values to pointers in C", "body": "<p>This question was inspired by this snipped from a C book I've been working through</p>\n\n<p>Where is says:</p>\n\n<pre><code>int num;\nint *pi=0; // Zero referes to the null pointer, NULL\npi = &amp;num;\n*pi = 0;   // Zero refers to the integer zero\n</code></pre>\n\n<blockquote>\n  <p>We are accustomed to overloaded operators, such as the asterisk used\n  to declare a pointer, to dereference a pointer, or to multiply. The\n  zero is also overloaded. We may find this discomforting because we are\n  not used to overloading operands.</p>\n</blockquote>\n\n<p>So I did a bunch of investigating with the debugger and my answer is what the debugger showed me. It's undefined behavior, I get that, but I'm not writing a program I'm trying to figure something out. Whatever the case, the pointer is initialized to 1 every time I run it, I'm not depending on that in some calculation, it's what the debugger repeatedly shows.</p>\n\n<p>This is all just one question really, but I had to write more or it wouldn't accept it.\nWhy does *p=0 have different effects at different times? How is 0 overloaded?\nHow can I tell if *p=0 is making p a null pointer or if it is assigning 0 to a variable that p is pointing to? And how does the compiler know to assign a null at the address of p rather than the address that p points too?</p>\n\n<pre><code>$ cat prac.c\n#include &lt;stdio.h&gt;\n\nint main()\n{\n  int num;\n  int *p;                                \n\n  printf(\"0) %p is %d\\n\",p,*p);\n\n  *p=0;                                  //Why is this......\n\n  printf(\"1) %p is %d\\n\",p,*p);\n\n  num=5;\n  p=&amp;num;\n\n  printf(\"2) Now %p is %d\\n\",p,*p);\n\n  *p=0;                                  //....different than this\n\n  printf(\"3) p is not null, %p : %d\\n\",p,*p);\n\n\n  return 0;\n}\n\n\n\n$ ./prac\n0) 0x7ffeb36b5c30 is 1    //pointer is initialized to 1, not-null, definitely out-of-bounds though\n1) 0x7ffeb36b5c30 is 0\n2) Now 0x7ffeb36b5b3c is 5\n3) p is not null, 0x7ffeb36b5b3c : 0\n</code></pre>\n"}, {"tags": ["c", "logging"], "comments": [{"owner": {"reputation": 2476, "user_id": 5931673, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/aTpXN.jpg?s=128&g=1", "display_name": "ajxs", "link": "https://stackoverflow.com/users/5931673/ajxs"}, "edited": false, "score": 1, "creation_date": 1529445882, "post_id": 50937500, "comment_id": 88873494, "body": "Can you provide an example of you calling the example you&#39;ve shown above that fails? It looks like this example will work well, it may just be a minor issue with the format specifiers."}, {"owner": {"reputation": 836, "user_id": 7908852, "user_type": "registered", "accept_rate": 18, "profile_image": "https://www.gravatar.com/avatar/b14abd54fe35e900d7a6a57438e1a3e3?s=128&d=identicon&r=PG&f=1", "display_name": "arsenal88", "link": "https://stackoverflow.com/users/7908852/arsenal88"}, "reply_to_user": {"reputation": 2476, "user_id": 5931673, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/aTpXN.jpg?s=128&g=1", "display_name": "ajxs", "link": "https://stackoverflow.com/users/5931673/ajxs"}, "edited": false, "score": 0, "creation_date": 1529446114, "post_id": 50937500, "comment_id": 88873544, "body": "I used the %f format specifier... see my edit above."}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 1, "creation_date": 1529447005, "post_id": 50937500, "comment_id": 88873806, "body": "What type is <code>e</code>?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 3, "creation_date": 1529448679, "post_id": 50937500, "comment_id": 88874205, "body": "In the code you&#39;re basing your modifications on, the declaration of <code>e</code> is <code>int e;</code> \u2014 so it is not surprising you&#39;re getting erroneous results.  You read a <code>double</code> into an <code>int</code>, throwing away any fractional information, and then lie to <code>printf()</code> and tell it you&#39;re passing a <code>double</code> when actually you pass an <code>int</code>.  Consider: <code>case &#39;f&#39;: { double d = va_arg(list, double); fprintf(&quot;fp, &quot;%f, d); continue; }</code>.  Note, too, that you should have been getting <code>0.000000</code> since the default precision for <code>%f</code> is 6 decimal places."}], "answers": [{"tags": [], "owner": {"reputation": 836, "user_id": 7908852, "user_type": "registered", "accept_rate": 18, "profile_image": "https://www.gravatar.com/avatar/b14abd54fe35e900d7a6a57438e1a3e3?s=128&d=identicon&r=PG&f=1", "display_name": "arsenal88", "link": "https://stackoverflow.com/users/7908852/arsenal88"}, "is_accepted": false, "score": 0, "last_activity_date": 1529449663, "creation_date": 1529449663, "answer_id": 50938096, "question_id": 50937500, "link": "https://stackoverflow.com/questions/50937500/logging-variables-into-a-file-in-c/50938096#50938096", "title": "Logging variables into a file in C", "body": "<p>Ah yes good spot. The data type of <code>e</code> was set to <code>int</code></p>\n\n<p>I created a new variable of type <code>double</code> and used this instead.</p>\n\n<pre><code>double d;\n\ncase 'f':\n{\n    d = va_arg( list, double );\n\n    fprintf(fp,\"%f\", d);\n    continue;\n}\n</code></pre>\n"}], "owner": {"reputation": 836, "user_id": 7908852, "user_type": "registered", "accept_rate": 18, "profile_image": "https://www.gravatar.com/avatar/b14abd54fe35e900d7a6a57438e1a3e3?s=128&d=identicon&r=PG&f=1", "display_name": "arsenal88", "link": "https://stackoverflow.com/users/7908852/arsenal88"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 258, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1529449663, "creation_date": 1529445547, "last_edit_date": 1529446215, "question_id": 50937500, "link": "https://stackoverflow.com/questions/50937500/logging-variables-into-a-file-in-c", "title": "Logging variables into a file in C", "body": "<p>I have quite a large project at work written in C (which I have little experience in) and I'm looking to create a log file when it is run that will log the value of variables (of all different data types) to a txt file.</p>\n\n<p>It seems it is really not very straight forward with a language like C (for a beginner)</p>\n\n<p>I'm trying to write a function to call throughout the code that will simply write values to a txt file with maybe a timestamp. It doesn't need to be clever or anything.</p>\n\n<p>I found this <a href=\"http://simplestcodings.blogspot.com/2010/10/simple-logger-in-c.html\" rel=\"nofollow noreferrer\">C logging</a> example that works well for strings and integers but when I attempt to expand it for doubles it doesn't work.</p>\n\n<p>Any help on how to go about this in an easy to understand way would be appreciated!</p>\n\n<p>Thanks</p>\n\n<p>Update:</p>\n\n<p>The code extended for double data types from the link... just another switch case: </p>\n\n<pre><code>case 'f':\n{\n    e = va_arg( list, double );\n\n    fprintf(fp,\"%f\", e);\n    continue;\n}\n</code></pre>\n\n<p>I then in my main function call it..</p>\n\n<pre><code>int main()\n{\n    double floating = 25.3;    \n    LOG_PRINT(\"%f\", floating);\n}\n</code></pre>\n\n<p>The output to the file is 0.0000 instead though..</p>\n"}, {"tags": ["c", "linux", "file", "permissions", "file-permissions"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user7287311"}, "edited": false, "score": 1, "creation_date": 1529445432, "post_id": 50937375, "comment_id": 88873374, "body": "Nothing. Would you expect an error to occur on I/O operations? That would be disasterous. What do you mean by even more uncertain? Where do you have doubts?"}, {"owner": {"reputation": 191202, "user_id": 147356, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/b9506717d24256a090524dd5505d3207?s=128&d=identicon&r=PG", "display_name": "larsks", "link": "https://stackoverflow.com/users/147356/larsks"}, "edited": false, "score": 2, "creation_date": 1529446758, "post_id": 50937375, "comment_id": 88873735, "body": "What happens when you try? That seems easy to test."}, {"owner": {"reputation": 233489, "user_id": 14122, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5e2861b08f37fa306fbf5384994af688?s=128&d=identicon&r=PG", "display_name": "Charles Duffy", "link": "https://stackoverflow.com/users/14122/charles-duffy"}, "edited": false, "score": 1, "creation_date": 1529447082, "post_id": 50937375, "comment_id": 88873827, "body": "Opening handles before dropping privileges wouldn&#39;t be very useful if you could no longer use them post-drop."}, {"owner": {"reputation": 233489, "user_id": 14122, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5e2861b08f37fa306fbf5384994af688?s=128&d=identicon&r=PG", "display_name": "Charles Duffy", "link": "https://stackoverflow.com/users/14122/charles-duffy"}, "edited": false, "score": 1, "creation_date": 1529447552, "post_id": 50937375, "comment_id": 88873944, "body": "...which is to say, it&#39;s <i>extremely intentional</i> that you retain access to your file handles; if that weren&#39;t possible, a number of mechanisms for restricting daemons&#39; privileges if compromised (while still giving them access to the content they need to work) would be broken."}, {"owner": {"reputation": 7668, "user_id": 2554472, "user_type": "registered", "profile_image": "https://graph.facebook.com/1119155584/picture?type=large", "display_name": "Mark Plotnick", "link": "https://stackoverflow.com/users/2554472/mark-plotnick"}, "edited": false, "score": 1, "creation_date": 1529450570, "post_id": 50937375, "comment_id": 88874624, "body": "For ordinary files on local filesystems, permissions don&#39;t matter after a successful open. But the rules are different for procfs files and some NFS servers."}], "answers": [{"tags": [], "owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "is_accepted": true, "score": 3, "last_activity_date": 1529452202, "last_edit_date": 1529452202, "creation_date": 1529449419, "answer_id": 50938057, "question_id": 50937375, "link": "https://stackoverflow.com/questions/50937375/what-happens-to-already-opened-files-when-you-change-process-ownership-uid-gid/50938057#50938057", "title": "What happens to already opened files when you change process ownership (uid/gid) in Linux?", "body": "<p>When you open a file, your ability to do so is determined by your effective uid and gid at the time you open the file.</p>\n\n<p>When you change your effective uid or gid, it has no effect on any open file descriptors that you may have.</p>\n\n<p>In most cases, if you have a valid file descriptor, that's all you need to read or write the resource that descriptor is connected to.  The fact that you hold the valid file descriptor is supposed to be all the proof you need that you have permission to read/write the underlying resource.</p>\n\n<p>When you read or write using an ordinary file descriptor, no additional authorization checks are performed.  This is partly for efficiency (because those authentication checks would be expensive to perform each time), and partly so that -- this may be exactly what you are trying to do -- you can open a privileged resource, downgrade your process's privileges, and continue to access the open resource.</p>\n\n<p>Bottom line: Yes, it's entirely possible for a process to use an open file descriptor to read or write a file which (based on its current uid/gid) it would not be able to open.</p>\n\n<hr>\n\n<p>Footnote: What I've said is true for ordinary Unix file descriptors connected to ordinary resources (files, devices, pipes, network streams, etc.).  But as @Mark Plotnick reminds in a comment, some file descriptors and underlying resources are \"different\" -- NFS and Linux <code>/proc</code> files are two examples.  For those, it's possible for additional checks to be performed at the time of read/write.</p>\n"}], "owner": {"reputation": 4264, "user_id": 2111737, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/3cbb6d8cbe739789803ace7db751e3ef?s=128&d=identicon&r=PG", "display_name": "Lapsio", "link": "https://stackoverflow.com/users/2111737/lapsio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 298, "favorite_count": 0, "accepted_answer_id": 50938057, "answer_count": 1, "score": 3, "last_activity_date": 1529452202, "creation_date": 1529444867, "last_edit_date": 1529445244, "question_id": 50937375, "link": "https://stackoverflow.com/questions/50937375/what-happens-to-already-opened-files-when-you-change-process-ownership-uid-gid", "title": "What happens to already opened files when you change process ownership (uid/gid) in Linux?", "body": "<p>It's possible to change UID/GID of current process as it runs programatically with <code>setresgid</code>/<code>setresuid</code> which affects future files access rights.</p>\n\n<p>However what happens to already opened or memory mapped files? Are they still accessible for i/o operations like read/write? I'm asking more in context of \"not explicit\" i/o operations performed by libraries, for example sqlite database or other libraries that operate on files more internally. Files opened in <code>DIRECT_IO</code> mode sound even more uncertain in this aspect.</p>\n"}, {"tags": ["c", "function", "tree", "malloc", "binary-search-tree"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1529443141, "post_id": 50937068, "comment_id": 88872601, "body": "Why not to collaborate with your classmate: <a href=\"https://stackoverflow.com/questions/50935603/inserting-in-a-binary-search-tree\" title=\"inserting in a binary search tree\">stackoverflow.com/questions/50935603/&hellip;</a> ?"}, {"owner": {"reputation": 91, "user_id": 9964094, "user_type": "registered", "profile_image": "https://graph.facebook.com/898153053702367/picture?type=large", "display_name": "Ayaz S Imran", "link": "https://stackoverflow.com/users/9964094/ayaz-s-imran"}, "reply_to_user": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1529443267, "post_id": 50937068, "comment_id": 88872649, "body": "@ChristianGibbons No. In this case my while loop is running forever. why so?"}], "answers": [{"comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1529443611, "post_id": 50937152, "comment_id": 88872776, "body": "<code>while (ptr != NULL)</code> could just be <code>while (1)</code>, since nothing ever sets <code>ptr</code> to <code>NULL</code>."}], "tags": [], "owner": {"reputation": 4598, "user_id": 9264702, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mHczh.jpg?s=128&g=1", "display_name": "Stephen Docy", "link": "https://stackoverflow.com/users/9264702/stephen-docy"}, "is_accepted": true, "score": 1, "last_activity_date": 1529443614, "last_edit_date": 1529443614, "creation_date": 1529443459, "answer_id": 50937152, "question_id": 50937068, "link": "https://stackoverflow.com/questions/50937068/insertion-failure-in-a-binary-search-tree/50937152#50937152", "title": "Insertion failure in a Binary Search Tree", "body": "<p>Your <code>while()</code> loop goes on forever because you keep going even after you find a place to insert the node:</p>\n\n<pre><code>while(ptr!=NULL){\n    if(data&lt;ptr-&gt;info){\n        if(ptr-&gt;left==NULL)\n        ptr-&gt;left=n;\n\n        ptr=ptr-&gt;left;\n    }\n    else if(data&gt;ptr-&gt;info){\n        if(ptr-&gt;right==NULL)\n        ptr-&gt;right=n;\n\n        ptr=ptr-&gt;right;\n    }\n}\n</code></pre>\n\n<p>You need to break out of the <code>while()</code> loop after inserting the node:</p>\n\n<pre><code>while (ptr != NULL) {\n    if (data &lt; ptr-&gt;info) {\n        if (ptr-&gt;left == NULL) {\n            ptr-&gt;left = n;\n            break;\n        }\n\n\n        ptr = ptr-&gt;left;\n    } else if (data &gt; ptr-&gt;info) {\n        if (ptr-&gt;right == NULL) {\n            ptr-&gt;right = n;\n            break;\n        }\n\n\n        ptr = ptr-&gt;right;\n    }\n}\n</code></pre>\n\n<p>Also, bonus points for checking if <code>malloc()</code> fails</p>\n\n<pre><code>struct BTNode *n = malloc(sizeof(struct BTNode));\nif (n == NULL)\n    printf(\"\\nOUT OF MEMORY!\\n\");\n</code></pre>\n\n<p>But negative points for simply continuing on anyway, you should exit the function if <code>malloc()</code> fails</p>\n\n<pre><code>struct BTNode *n = malloc(sizeof(struct BTNode));\nif (n == NULL) {\n    printf(\"\\nOUT OF MEMORY!\\n\");\n    return NULL:\n}\n</code></pre>\n\n<p>And then of course, the code calling <code>insert()</code> should know what to do if <code>insert()</code> returns NULL.</p>\n"}], "owner": {"reputation": 91, "user_id": 9964094, "user_type": "registered", "profile_image": "https://graph.facebook.com/898153053702367/picture?type=large", "display_name": "Ayaz S Imran", "link": "https://stackoverflow.com/users/9964094/ayaz-s-imran"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 183, "favorite_count": 0, "accepted_answer_id": 50937152, "answer_count": 1, "score": 0, "last_activity_date": 1529447553, "creation_date": 1529443031, "last_edit_date": 1529447553, "question_id": 50937068, "link": "https://stackoverflow.com/questions/50937068/insertion-failure-in-a-binary-search-tree", "title": "Insertion failure in a Binary Search Tree", "body": "<p>Here is my code for the creation and insertion of the binary search tree</p>\n\n<pre><code>struct BTNode\n{\n    int info;\n    struct BTNode *left, *right;\n};\n\nstruct BTNode* create(int data)\n{\n    struct BTNode *root;\n    struct BTNode *n = malloc(sizeof(struct BTNode));\n\n    n-&gt;info = data;\n    n-&gt;left = NULL;\n    n-&gt;right = NULL;\n    root = n;\n\n    return(root);\n}\n\nstruct BTNode* insert(struct BTNode *root, int data)\n{\n    struct BTNode *ptr;\n    struct BTNode *n = malloc(sizeof(struct BTNode));\n    if (n == NULL)\n        printf(\"\\nOUT OF MEMORY!\\n\");\n\n    n-&gt;info = data;\n    n-&gt;left = NULL;\n    n-&gt;right = NULL;\n\n\n    ptr = root;\n    while (ptr != NULL){\n        if (data &lt; ptr-&gt;info){\n            if (ptr-&gt;left == NULL)\n            ptr-&gt;left = n;\n\n            ptr = ptr-&gt;left;\n        }\n        else if (data &gt; ptr-&gt;info){\n            if (ptr-&gt;right == NULL)\n            ptr-&gt;right = n;\n\n            ptr = ptr-&gt;right;\n        }\n    }\n\n    return(n);\n}\n</code></pre>\n\n<p>and here is the main() function</p>\n\n<pre><code>int main()\n{\n    struct BTNode *root = NULL;\n    int choice, data;\n\n    printf(\"\\nWrite the root data: \");\n    scanf(\"%d\", &amp;data);\n    root = create(data);\n\n    while (1){\n    printf(\"\\n1.Insert 2.Preorder 3.Exit\\n\");\n    scanf(\"%d\", &amp;choice);\n    switch(choice){\n        case 1:\n        printf(\"\\nWrite the data: \");\n        scanf(\"%d\", &amp;data);\n        insert(root, data);\n        break;\n</code></pre>\n\n<p>I am able to create the root node but whenever I am trying to insert the data, I give my data and the compiler stops doing anything. Any idea why this is happening?</p>\n"}, {"tags": ["c++", "c", "winapi", "setupapi"], "comments": [{"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 2, "creation_date": 1529443712, "post_id": 50937052, "comment_id": 88872805, "body": "It is supposed to fail with that error.  You now know the <i>requiredSize</i> so you allocate a buffer big enough to call it again, now passing a non-NULL value for the 5th argument.  Feature, not a bug."}, {"owner": {"reputation": 3960, "user_id": 654614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fc0d43eb99234ed9702badb191b7d96?s=128&d=identicon&r=PG&f=1", "display_name": "Frank Boyne", "link": "https://stackoverflow.com/users/654614/frank-boyne"}, "reply_to_user": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 1, "creation_date": 1529444206, "post_id": 50937052, "comment_id": 88872988, "body": "To add to what @HansPassant said, this is a fairly common Windows API pattern.  Let&#39;s say that instead of passing <code>NULL</code> and zero you passed a valid pointer and the length 200 <b>but</b> the requested data required 400 bytes.  You would get the same &quot;too small&quot; error and <code>requiredSize</code> would be set to 400.  Passing in <code>NULL</code> and zero is just an easy way of triggering this error so you get the <code>requiredSize</code> variable set."}, {"owner": {"reputation": 743, "user_id": 2355322, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/2wRIw.jpg?s=128&g=1", "display_name": "Sergio Calderon", "link": "https://stackoverflow.com/users/2355322/sergio-calderon"}, "edited": false, "score": 0, "creation_date": 1529444426, "post_id": 50937052, "comment_id": 88873075, "body": "Oh, I get it. I thought I would get a different error code as a result when it was called with <code>NULL</code> and <code>0</code>. Thanks a lot, no errors then."}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1529449456, "post_id": 50937052, "comment_id": 88874400, "body": "You may be calling <code>GetLastError</code> too late. You need to call it immediately after entering a state, where it returns a meaningful value, and no later."}, {"owner": {"reputation": 743, "user_id": 2355322, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/2wRIw.jpg?s=128&g=1", "display_name": "Sergio Calderon", "link": "https://stackoverflow.com/users/2355322/sergio-calderon"}, "reply_to_user": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1529460328, "post_id": 50937052, "comment_id": 88876545, "body": "@IInspectable, would you show me where I should put the <code>GetLastError</code>?"}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1529461966, "post_id": 50937052, "comment_id": 88876848, "body": "Make it a single statement, and move it outside your <code>fwprintf</code> calls."}], "owner": {"reputation": 743, "user_id": 2355322, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/2wRIw.jpg?s=128&g=1", "display_name": "Sergio Calderon", "link": "https://stackoverflow.com/users/2355322/sergio-calderon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1891, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1552282595, "creation_date": 1529442927, "last_edit_date": 1529443442, "question_id": 50937052, "link": "https://stackoverflow.com/questions/50937052/error-code-122-using-setupdigetdeviceregistrypropertyw-to-get-the-required-size", "title": "Error code 122 using SetupDiGetDeviceRegistryPropertyW to get the required size", "body": "<p>I want to get the Device ID of a USB stick by using the Setup API, but first I am trying to understand some of the functions I have to use. The <code>SetupDiGetDeviceRegistryProperty</code> documentation says I can send NULL to the buffer and buffer size to get the required size, but I am getting the <code>122</code> error code, which means: </p>\n\n<blockquote>\n  <p>The data area passed to a system call is too small</p>\n</blockquote>\n\n<p>Can anyone tell me what am I doing wrong?</p>\n\n<p>Here is my code so far:</p>\n\n<pre><code>#include &lt;Windows.h&gt;\n#include &lt;wchar.h&gt;\n#include &lt;SetupAPI.h&gt;\n\n#pragma comment(lib, \"Setupapi.lib\")\n\nint wmain(int argc, wchar_t *arv[])\n{\n    // SetupDiGetClassDevs\n    HDEVINFO hDeviceInfo;\n    DWORD filterDevInfo = DIGCF_ALLCLASSES;\n\n    hDeviceInfo = SetupDiGetClassDevsW(NULL, NULL, NULL, filterDevInfo);\n\n    if (hDeviceInfo != INVALID_HANDLE_VALUE)\n    {\n        // SetupDiEnumDeviceInfo\n        DWORD memberIndex = 0;\n        SP_DEVINFO_DATA devInfoData;\n\n        devInfoData.cbSize = sizeof(SP_DEVINFO_DATA);\n\n        if (!SetupDiEnumDeviceInfo(\n            hDeviceInfo,\n            memberIndex,\n            &amp;devInfoData))\n        {\n            fwprintf(stderr, L\"Error on enum: %u\\n\", GetLastError());\n            return 1;\n\n        }\n\n        // SetupDiGetDeviceRegistryProperty\n        DWORD propertyRetrieved = SPDRP_DEVICEDESC;\n        DWORD requiredSize;\n\n        // First call to get the required size for the buffer\n\n        if (!SetupDiGetDeviceRegistryPropertyW(\n            hDeviceInfo,\n            &amp;devInfoData,\n            propertyRetrieved,\n            NULL,\n            NULL,\n            0,\n            &amp;requiredSize))\n        {\n            fwprintf(stderr, L\"Error on registry property: %u\\n\", GetLastError());\n            return 1;\n\n        }\n\n    }\n    else\n    {\n        wprintf(L\"Error code: %u\\n\", GetLastError());\n        return 1;\n    }\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "truncate", "g-wan"], "answers": [{"tags": [], "owner": {"reputation": 3189, "user_id": 1079036, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/368d20296c0ae6df9a0dd7ddfbdec535?s=128&d=identicon&r=PG", "display_name": "Gil", "link": "https://stackoverflow.com/users/1079036/gil"}, "is_accepted": false, "score": 1, "last_activity_date": 1529499368, "creation_date": 1529499368, "answer_id": 50948794, "question_id": 50936579, "link": "https://stackoverflow.com/questions/50936579/g-wan-c-function-xbuf-trunclen-and-xbuf-truncptr/50948794#50948794", "title": "G-WAN C function xbuf_trunclen() and xbuf_truncptr()", "body": "<p>In your code, you duplicate the <code>xbuffer</code>'s buffer so (<code>ptr</code> != <code>buffer.ptr</code>):</p>\n\n<pre><code>char *ptr = (char*)strdup(\"Boundary\");\nxbuf_truncptr(&amp;buffer, ptr);\n</code></pre>\n\n<p>Doing so cannot work: <code>ptr</code> must belong to the [<code>buffer.ptr</code>, <code>buffer.ptr + buffer.len</code>] memory range. This would work as well: ptr[3] = 0;</p>\n\n<p>And, if you merely want to cut a string with xbuf_trunclen() that's faster to do the following:</p>\n\n<p>buffer.ptr[3] = 0;</p>\n\n<p>Hope this helps.</p>\n\n<p>Note: in restrospective, looking at these two function makes me wondering why they were created in the first place. I guess it was for Java and C# APIs and developpers (as both languages don't use C-like \"strings\" and encapsulate them in hidden structures).</p>\n"}], "owner": {"reputation": 211, "user_id": 1993277, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1a0df023b9f8c26054c501589b0ea5c5?s=128&d=identicon&r=PG", "display_name": "John S", "link": "https://stackoverflow.com/users/1993277/john-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1529499368, "creation_date": 1529440660, "question_id": 50936579, "link": "https://stackoverflow.com/questions/50936579/g-wan-c-function-xbuf-trunclen-and-xbuf-truncptr", "title": "G-WAN C function xbuf_trunclen() and xbuf_truncptr()", "body": "<p>I would like to use the xbuf_trunclen() and xbuf_truncptr() functions to cut my buffer but the functions do not seem to work.</p>\n\n<p>Here's an example with an example running via char pointer:</p>\n\n<pre><code>char *string = (char*)strdup(\"---Boundary\");\nstring += 3;\nprintf(\"String is '%s'\", string);\n</code></pre>\n\n<p>Result: String is 'Boundary'</p>\n\n<p>Here is what I would like to do but does not seem to work:</p>\n\n<pre><code>xbuf_t buffer;\nxbuf_init(&amp;buffer);\nxbuf_cat(&amp;buffer, \"---Boundary\");\nxbuf_trunclen(&amp;buffer, 3);\nprintf(\"Buffer is '%s'\", buffer.ptr);\n</code></pre>\n\n<p>Result: Buffer is '---Boundary'</p>\n\n<p>while I would like: Buffer is 'Boundary'</p>\n\n<p>and with 'xbuf_trunptr()':</p>\n\n<pre><code>...\nchar *ptr = (char*)strdup(\"Boundary\");\nxbuf_truncptr(&amp;buffer, ptr);\n...\n</code></pre>\n\n<p>Result: Buffer is '---Boundary'</p>\n\n<p>while I would like: Buffer is 'Boundary'</p>\n\n<p>Is this an error of use on my part or a problem of operation of the 2 functions?\nThe goal is to manipulate the beginning of the buffer.</p>\n"}, {"tags": ["c", "pointers", "tree", "malloc", "binary-search-tree"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1529436512, "post_id": 50935603, "comment_id": 88869856, "body": "<code>root=n;</code> will have the effect in the function only."}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 1, "creation_date": 1529436515, "post_id": 50935603, "comment_id": 88869858, "body": "<code>if(root==NULL) root=n;</code>  You are only setting a local var to point to <code>n</code>"}, {"owner": {"reputation": 1931, "user_id": 3696914, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/oLaiN.png?s=128&g=1", "display_name": "Edenia", "link": "https://stackoverflow.com/users/3696914/edenia"}, "edited": false, "score": 0, "creation_date": 1529438487, "post_id": 50935603, "comment_id": 88870750, "body": "I am just curious, are you codding with a formatting like this or it was because of stack overflow editor or something?"}], "answers": [{"tags": [], "owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "is_accepted": false, "score": 0, "last_activity_date": 1529436970, "creation_date": 1529436970, "answer_id": 50935749, "question_id": 50935603, "link": "https://stackoverflow.com/questions/50935603/inserting-in-a-binary-search-tree/50935749#50935749", "title": "Inserting in a Binary Search Tree", "body": "<p>You should be passing in a pointer to your root pointer if you want to be able to change where your root pointer points (sorry if that got a bit convoluted).</p>\n\n<p>What you'll want is something like this:</p>\n\n<pre><code>void insert(struct BTNode **root,int data)\n{\n...\n    if(*root == NULL) {\n        *root = n;\n    }\n...\n}\n</code></pre>\n\n<p>And then when you call it, you'd pass in the address to your root pointer:</p>\n\n<pre><code>int main()\n{\n    struct BTNode *root=NULL;\n    int data;\n    ...\n    scanf(\"%d\", &amp;data);\n    insert(&amp;root, data);\n    ...\n}\n</code></pre>\n\n<p>Also note above: you should be passing in the address of your variable to <code>scanf</code>.  Maybe that was just a typo as you transferred since you did that properly with your <code>choice</code> var.</p>\n"}, {"tags": [], "owner": {"reputation": 93, "user_id": 9911031, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8afbcbfa605198e74ad2b20a399d7010?s=128&d=identicon&r=PG&f=1", "display_name": "CrazyCranberry", "link": "https://stackoverflow.com/users/9911031/crazycranberry"}, "is_accepted": false, "score": 0, "last_activity_date": 1529439150, "creation_date": 1529439150, "answer_id": 50936237, "question_id": 50935603, "link": "https://stackoverflow.com/questions/50935603/inserting-in-a-binary-search-tree/50936237#50936237", "title": "Inserting in a Binary Search Tree", "body": "<p>As other people have said, modifying a pointer that was a parameter won't have any effect outside of the method.</p>\n\n<p>C passes pointers by value not by reference. Meaning the pointer you're dealing with in the function is a different pointer that just points to the same thing. You have to pass a pointer to a pointer like the answer above me.</p>\n\n<p>I wish I could've just commented this explanation but I guess I need reputation to do that..</p>\n"}], "owner": {"reputation": 159, "user_id": 9958640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25846e4ff112e1350c83e383af5b8690?s=128&d=identicon&r=PG&f=1", "display_name": "Klasen", "link": "https://stackoverflow.com/users/9958640/klasen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 85, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1529439150, "creation_date": 1529436324, "question_id": 50935603, "link": "https://stackoverflow.com/questions/50935603/inserting-in-a-binary-search-tree", "title": "Inserting in a Binary Search Tree", "body": "<p>I've made a binary search tree</p>\n\n<pre><code>struct BTNode\n{\n    int info;\n    struct BTNode *left,*right;\n};\n</code></pre>\n\n<p>I've wrote a code to insert a node in the tree</p>\n\n<pre><code>void insert(struct BTNode *root,int data)\n{\n    struct BTNode *ptr;\n    struct BTNode *n=malloc(sizeof(struct BTNode));\n    n-&gt;info=data;\n    n-&gt;left=NULL;\n    n-&gt;right=NULL;\n    if(root==NULL)\n    root=n;\n    else{\n    ptr=root;\n    while(ptr!=NULL){\n        if(data&lt;ptr-&gt;info){\n            if(ptr-&gt;left==NULL)\n            ptr-&gt;left=n;\n            else\n            ptr=ptr-&gt;left;\n        }\n        else if(data&gt;ptr-&gt;info){\n            if(ptr-&gt;right==NULL)\n            ptr-&gt;right=n;\n            else\n            ptr=ptr-&gt;right;\n        }\n    }\n    }\n}\n</code></pre>\n\n<p>and a main() function</p>\n\n<pre><code>int main()\n{\n    struct BTNode *root=NULL;\n    int choice,data;\n    printf(\"\\n1.Insert 2.Preorder 3.Exit\\n\");\n    scanf(\"%d\",&amp;choice);\n    switch(choice){\n        case 1:\n        printf(\"\\nWrite the data: \");\n        scanf(\"%d\",data);\n        insert(root, data);\n        break;\n</code></pre>\n\n<p>But when I try to insert a node, my program crashes. Any hints what's the problem?</p>\n"}, {"tags": ["c++", "c", "opnet"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1529435570, "post_id": 50935420, "comment_id": 88869465, "body": "Find one path, remove it. Find another. And the paths you cited are not disjoint, they only have one different node."}, {"owner": {"reputation": 33, "user_id": 9963798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59f90fb2d99516b3b6cf99e5262a973a?s=128&d=identicon&r=PG&f=1", "display_name": "Saman2018", "link": "https://stackoverflow.com/users/9963798/saman2018"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1529435777, "post_id": 50935420, "comment_id": 88869545, "body": "Thanks for your reply. But the problem is that I have some resources on each link and I must reserve the resources on both routes simultaneously. So if a link of the original path fails or something happens on that path, I switch to another(protection path) and survive  my  current service."}, {"owner": {"reputation": 3142, "user_id": 2311167, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rZpVr.jpg?s=128&g=1", "display_name": "Adrian W", "link": "https://stackoverflow.com/users/2311167/adrian-w"}, "edited": false, "score": 0, "creation_date": 1529435782, "post_id": 50935420, "comment_id": 88869546, "body": "Welcome to Stack Overflow! This is a site where programmers write their own code and share issues with a specific problem after trying to solve it on their own. If, after <b><a href=\"https://meta.stackoverflow.com/q/261592\">doing more research</a></b>, you have a specific problem, please edit your post to share <a href=\"https://stackoverflow.com/help/mcve\">examples of your code and relevant data</a> and some background info. You might also want to read <a href=\"https://stackoverflow.com/help/how-to-ask\">&quot;How to Ask&quot;</a> and <a href=\"https://meta.stackoverflow.com/q/347937\">these tips</a>."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1529435852, "post_id": 50935420, "comment_id": 88869576, "body": "What the resources have to do with your question statement? If you have some additional constraints, you should mention them in the question."}], "answers": [{"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 0, "last_activity_date": 1529442326, "creation_date": 1529442326, "answer_id": 50936941, "question_id": 50935420, "link": "https://stackoverflow.com/questions/50935420/how-to-find-two-disjoint-paths-in-a-bidirectional-graph/50936941#50936941", "title": "How to find two disjoint paths in a bidirectional graph?", "body": "<blockquote>\n  <p>I have a graph with 14 nodes and 21 links. [...] for each source and destination, I must establish a working and a\n  protection path simultaneously in advance in case of a link failure\n  but they muse be link disjoint.(they cannot traverse any common link)</p>\n</blockquote>\n\n<p>Note well in the first place that the information you have presented in no way ensures that there will be even one path between any two particular nodes, much less two disjoint ones.  If your graph is structured in such a way that it is guaranteed to have two disjoint paths between each pair of nodes, however, then your best bet is probably to use your knowledge of that structure to find the wanted pairs of paths.  For example, if you know that the graph contains a loop that traverses all nodes, then you can obtain two disjoint paths between each node pair by traversing that loop in opposite directions from one to the other.</p>\n\n<p>On the other hand, if you're trying to find such disjoint path pairs where they exist, and elsewhere to determine that no such pair exists, then you have some options.</p>\n\n<p>Conceptually easiest would be to determine for each pair of nodes <em>all</em> non-looping paths between them, and then to look for two that have only the start and end nodes in common.  You could use either a depth-first or a breadth-first search for the path enumeration.  This is computationally challenging on general graphs because the number of paths scales exponentially, but with the relatively small and fairly sparse graph you describe, it would probably work.</p>\n\n<p>You could refine that approach by testing each new path, as you discover it, against all the previously-discovered ones.  You may that way sometimes discover usable pairs without enumerating every path.  If you do this then a BFS-based approach will tend to find a usable pair more quickly than DFS-based one.  This will still enumerate all the paths between your nodes when there is no disjoint pair.</p>\n\n<p>I can imagine more elaborate approaches in which you search disjoint <em>pairs</em> together, instead of searching individual paths, but I'm inclined to think that these would tend to be inefficient on account of involving a lot of duplicate work.  That suggests a possible resolution via dynamic programming, but at this point I'm indulging fairly heavily in speculation.</p>\n\n<p>What you <em>cannot</em> reliably do is simply choose one path and and then look for another that traverses the remaining nodes.  It is entirely possible that there are suitable path pairs, but the first path you choose is not a member of such a pair.</p>\n"}], "owner": {"reputation": 33, "user_id": 9963798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59f90fb2d99516b3b6cf99e5262a973a?s=128&d=identicon&r=PG&f=1", "display_name": "Saman2018", "link": "https://stackoverflow.com/users/9963798/saman2018"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 144, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1529442326, "creation_date": 1529435424, "last_edit_date": 1529437148, "question_id": 50935420, "link": "https://stackoverflow.com/questions/50935420/how-to-find-two-disjoint-paths-in-a-bidirectional-graph", "title": "How to find two disjoint paths in a bidirectional graph?", "body": "<p>I have a graph with 14 nodes and 21 links. This graph shows an optical network. The links are bidirectional and there are some resources on each link. Assume there is a working path from a source to a destination which carry a packet containing data and uses some resources(some amount of bandwidth of the link that it is traversed by). for each source and destination, I must establish a working and a protection path simultaneously in advance in case of a link failure but they muse be link disjoint.(they cannot traverse any common link)</p>\n\n<p>For example I send a packet from node1 to node4 through route&lt;1,2,3,4> as the working path.\n If link 1-2 fails, I have to send the packet through a protection path that has been established in advance and is disjoint with the working path. for example my protection path may be &lt;1,9,3,4>.</p>\n\n<p>The purpose is write a code in C/C++ to find the protection path which is link disjoint with the working path. Actualy I couldn't get an idea for doing that. Any help would be greatly appreciated.</p>\n\n<p>This is a piece of my code where I have allocate resources to working paths, I don't know how I can do the same for establishing protection path under condition that it must be disjoint with the working path.</p>\n\n<pre><code> int required_fs;\n    int des;\n    int idpk;\n    double holding;\n    int src;\n\n  //get the information about the packet that is sent from source to destination.    \n    Packet *pkptr;\n    pkptr = op_pk_get (0);\n    op_pk_nfd_get(pkptr,\"bw_fs\",&amp;required_fs);\n    op_pk_nfd_get(pkptr,\"des\",&amp;des);\n    op_pk_nfd_get(pkptr,\"src\",&amp;src);\n    op_pk_nfd_get(pkptr,\"id\",&amp;idpk);\n    op_pk_nfd_get(pkptr,\"ht\",&amp;holding);\n\n\n    bw_req=bw_req + required_fs;\n    number_of_req=number_of_req+1;\n\n    if (number_of_req &gt; 1000000)\n        {\n            FILE* file1=fopen(\"C:/400f_rsa.txt\",\"a+\");\n            fprintf(file1,\"\\n\");\n            fprintf(file1,\"number_of_req ,number_of_nack,number_of_ack , bw_req , bw_nack , bw_ack \" );\n            fprintf(file1,\"\\n\");\n            fprintf(file1,\"  %d , %d , %d , %d , %d , %d   \", number_of_req, number_of_nack ,number_of_ack,bw_req,bw_nack,bw_ack );\n            fprintf(file1,\"\\n\");\n            fprintf(file1,\"------------------------------- \");\n            fclose (file1);\n            op_sim_end(\"1000000 paket\",\"\",\"\",\"\");\n\n        }\n\n //  Allocate the resources on each link to the working path, This part must be the same for the protection path too.\n    int determined_t=0;\n    int determined_r=0;\n    int determined_p_f=0;\n    int determined_p_e=0;\n    int determined_k=0;\n\n    for ( int i=1; i&lt;=10; i++)\n        {\n            if (transmitter[src][i]==0)\n                {\n                    determined_t=i;\n                    break;\n                }\n        }\n\n    if (determined_t!=0)\n        {\n            for ( int i=1; i&lt;=10; i++)\n                {\n                    if (reciever[des][i]==0)\n                        {\n                            determined_r=i;\n                            break;\n                        }\n                }\n\n            if (determined_r!=0)\n                {\n\n                    for ( int k=1; k&lt;=2 ; k++)\n                        {\n\n                            determined_p_f=0;\n                            determined_p_e=0;\n                            int count = paths_node[src][des][k][2][14];\n\n                            zero_array();\n\n                            for (int i=1; i&lt;=count; i++)\n                                {\n                                    finding_fs( k, i, des, src );\n                                }\n                            if ( ff_rr==0)\n                                {//ff\n                                    ////checking gap\n                                    determined_p_f=find_first_free_gap(required_fs);\n                                    if (determined_p_f!=0)\n                                        {   \n                                            determined_p_e=determined_p_f+required_fs-1;\n                                            if (determined_p_e != 1000)\n                                                {\n                                                    determined_p_e=determined_p_e+1;\n                                                }\n                                            determined_k=k;\n                                            break;\n                                        }\n\n\n                                }\n                            else if (ff_rr==1)\n                                {//rr\n                                    clear_rr_gap();\n                                    find_rr_gap(required_fs);\n                                    int index=rr_spectrum();\n                                    determined_p_f=ary_rr[index].first;\n                                    if (determined_p_f!=0)\n                                        {\n                                            determined_p_e=ary_rr[index].last;\n                                            determined_k=k;\n                                            break;\n                                        }\n\n                                }\n\n\n                        }\n\n                    if (determined_p_f!=0)\n                        {\n                            //add to ls , applying\n                         int count_link = paths_node[src][des][determined_k][2][14];\n\n                         for ( int i=1; i&lt;=count_link ; i++)\n                             {\n                                int num_link_p=paths_node[src][des][determined_k][2][i];\n\n                                for ( int j=determined_p_f ; j&lt;=determined_p_e; j++)\n                                    {\n                                        links_fs[num_link_p][j]=1;\n\n                                    }\n                             }\n\n                         reciever[des][determined_r]=1;\n                         transmitter[src][determined_t]=1;\n                         ls(determined_p_f,determined_p_e,determined_r,determined_t,determined_k,src,des,idpk);\n\n                            number_of_ack= number_of_ack +1 ;\n                            bw_ack= bw_ack + required_fs;\n                            op_intrpt_schedule_self(op_sim_time ()+ holding,idpk);\n                            op_pk_destroy(pkptr);\n                        }\n                    else\n                        {\n                            number_of_nack=number_of_nack+1;\n                            bw_nack= bw_nack + required_fs;\n                            op_pk_destroy(pkptr);\n                        }\n                }\n            else\n                {\n                    number_of_nack=number_of_nack+1;\n                    bw_nack= bw_nack + required_fs;\n                    op_pk_destroy(pkptr);\n                }\n        }\n    else\n        {\n            number_of_nack=number_of_nack+1;\n            bw_nack= bw_nack + required_fs;\n            op_pk_destroy(pkptr);\n        }\n</code></pre>\n"}, {"tags": ["c", "pointers", "memory", "dynamic-memory-allocation"], "answers": [{"tags": [], "owner": {"reputation": 1931, "user_id": 3696914, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/oLaiN.png?s=128&g=1", "display_name": "Edenia", "link": "https://stackoverflow.com/users/3696914/edenia"}, "is_accepted": true, "score": 3, "last_activity_date": 1529438101, "last_edit_date": 1529438101, "creation_date": 1529433666, "answer_id": 50935021, "question_id": 50934939, "link": "https://stackoverflow.com/questions/50934939/increasing-value-of-array-of-strings-in-c/50935021#50935021", "title": "Increasing Value of Array of Strings in C", "body": "<p>Okay first of all, <code>**string_ptr</code> semantically does not guarantee that <code>string_ptr</code> is going to be an array of strings or an array of char pointers. This comes clear after memory management is handled.</p>\n\n<p>To your function you are passing a pointer to string as far as I understood.\nSo you do something like that</p>\n\n<pre><code>char* string = \"my string in read-only memory\";\n\nfoo(&amp;string);\n</code></pre>\n\n<p>To access the value of the string the pointer points to, you dereference the pointer and then dereference the string. This resolves to the first character of the string.</p>\n\n<p><code>**string_ptr</code> is the first character of your string.</p>\n\n<p><code>*string_ptr</code> is string</p>\n\n<p><code>string_ptr</code> is pointer to string.</p>\n\n<hr>\n\n<p>There is much clearer or at least more understandable way to do what you want to achieve:</p>\n\n<pre><code>char* p = *string_ptr;\n\nfor(char* p = *string_ptr; *p != '\\0' p++);\n</code></pre>\n\n<p>you create new pointer to the string</p>\n\n<p>then increment it until it points to the address that holds the <code>\\0</code></p>\n\n<hr>\n\n<p>Adding more <code>*</code> to a variable just means that it points to another thing.</p>\n\n<pre><code>char* ch; // ch points to char or string\nchar** ch; // ch points to char*\nchar*** ch; // ch points to char**\n</code></pre>\n\n<p>and so on</p>\n\n<hr>\n\n<blockquote>\n  <p>*string_ptr would be the string that is being passed in the function. So what would it mean to increase the value of that?</p>\n</blockquote>\n\n<p>You are correct about that.\nIncreasing value of a pointer usually means performing pointer arithmetics on the variable. Essentially it is the same as if you increment regular variable, but this time this is performed on an address value, where increase of 1 means increase of <code>1 * sizeof(type)</code></p>\n\n<p>I demonstrated what incrementing pointer is and what it does.</p>\n\n<hr>\n\n<p><code>*string_ptr += strlen( *string_ptr );</code></p>\n\n<p>since <code>*string_ptr</code> is the string offset\nThis would make your string point to the end of itself.\nSo it would be good if you obtain an additional reference of it before that.</p>\n"}, {"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 1, "last_activity_date": 1529436695, "creation_date": 1529436695, "answer_id": 50935680, "question_id": 50934939, "link": "https://stackoverflow.com/questions/50934939/increasing-value-of-array-of-strings-in-c/50935680#50935680", "title": "Increasing Value of Array of Strings in C", "body": "<blockquote>\n  <p>I have an assignment where I pass a string into a function with the\n  [prototype] <code>char *get_word( char **string_ptr);</code></p>\n  \n  <p>My main will stop calling the function when the string that was passed\n  points to the '/0' character.</p>\n</blockquote>\n\n<p>It is important to distinguish between a <em>string</em>, which is a null-terminated <em>array</em> of <code>char</code>, and a <em>pointer</em> to (the first character of) a string, which is how strings are conveyed to functions and returned from them, and very often how strings are accessed in general.  A <code>char *</code> pointing to the first character of a string is separate from and independent of the string itself.  Your statement therefore makes sense only when interpreted as \"My main will stop calling the function when the value of the pointer variable whose address was passed points to the '/0' character of the string.\"</p>\n\n<blockquote>\n  <p>Therefore I have to implement this line\n  inside the function: <code>*string_ptr += strlen( *string_ptr )</code>;</p>\n</blockquote>\n\n<p>That would indeed update the pointer value at the address to which <code>string_ptr</code> points so that it points to the terminator of the string to which it initially pointed.  I'm inclined to suppose, however, that that is <em>not</em> what you actually want because then there would be no need to call the function more than once.  If the function unconditionally executed that statement then the passed pointer would always point to the terminator after the just one call.</p>\n\n<blockquote>\n  <p>This is very confusing to me. I am under the impression that\n  <code>*string_ptr</code> would be the string that is being passed in the function. So what would it mean to increase the value of that?</p>\n</blockquote>\n\n<p><code>*string_ptr</code> is whatever <code>string_ptr</code> points to.  With the declaration you present, that would be a pointer of type <code>char *</code>.  Remember: it is important to distinguish between such a pointer and the thing (the first character of a string in this case) to which it points.  Increasing the value of the pointer simply makes it point to some later character in the string (as long as you don't increase it too much).  If you increase it by the full count of characters in the string, then it will point to the terminator.</p>\n\n<blockquote>\n  <p>Another question. If <code>**string_ptr</code> is an array of strings then what\n  would be <code>*string_ptr</code> or just <code>string_ptr</code> on it's own?</p>\n</blockquote>\n\n<p>Considered as expressions, <code>*string_ptr</code> and <code>**string_ptr</code> are meaningless out of context.  With the declaration you provided, however, the expression <code>*string_ptr</code> evaluates to the <code>char *</code> pointed to by <code>string_ptr</code>.  The expression <code>**string_ptr</code> evaluates to the <code>char</code> pointed to by the <code>char *</code> pointed to by <code>string_ptr</code>.  <code>string_ptr</code> itself is simply the value of the function's argument, which is declared to be a pointer to pointer to <code>char</code>.</p>\n\n<p>But I think you're actually asking about the function prototype, in which case you've asked the wrong question.  The usual question is about whether the type (<code>char **</code>) of parameter <code>string_ptr</code> represents an array of strings.  The answer is \"no\" on several levels, and \"maybe, sort of\" on at least one.</p>\n\n<p>On its face, type <code>char **</code> represents a pointer to pointer to char.  This <em>can be</em> a pointer to the first <code>char *</code> in an array of <code>char *</code>, and that's what it will be if you present such an array as the corresponding argument.  It is by no means certain that the pointed-to <code>char *</code> is a member of an array, however, and if it is, no information is conveyed about the length of that array.  There is no meaningful distinction between such a pointer pointing to a single, scalar <code>char *</code> and it pointing to the first and only element of a one-member array of <code>char *</code>.</p>\n\n<p>The same distinction applies one level down, of course.  A valid <code>char *</code> <em>often</em> points to the first <code>char</code> of a string, but you don't know that from the type alone.  Supposing such a pointer is valid, it might instead point into an unterminated array of <code>char</code>, or to a single, scalar <code>char</code>.  For type <code>char *</code> in particular, it may also point (in)to the raw bytes of the value of an object of any other type, too.</p>\n"}], "owner": {"reputation": 337, "user_id": 9781768, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed70d0c2ec5a7a9b51c4bc892703ecbe?s=128&d=identicon&r=PG&f=1", "display_name": "User9123", "link": "https://stackoverflow.com/users/9781768/user9123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 50935021, "answer_count": 2, "score": -1, "last_activity_date": 1529438101, "creation_date": 1529433352, "last_edit_date": 1529435760, "question_id": 50934939, "link": "https://stackoverflow.com/questions/50934939/increasing-value-of-array-of-strings-in-c", "title": "Increasing Value of Array of Strings in C", "body": "<p>I have an assignment where I pass a string into a function with the definition <code>char *get_word( char **string_ptr);</code></p>\n\n<p>My main will stop calling the function when the string that was passed points to the <code>'\\0'</code> character. Therefore I have to implement this line inside the function: <code>*string_ptr += strlen( *string_ptr );</code> </p>\n\n<p>This is very confusing to me. I am under the impression that <code>*string_ptr</code> would be the string that is being passed in the function. So what would it mean to increase the value of that? </p>\n\n<p>Another question. If <code>**string_ptr</code> is an array of strings then what would be <code>*string_ptr</code> or just <code>string_ptr</code> on it's own? </p>\n"}, {"tags": ["c", "cuda"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1529436341, "post_id": 50934343, "comment_id": 88869781, "body": "Looks strange to declare a 2D array and call an allocator.  The <code>(void**)</code> is likely hiding that coding issue."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1529437706, "post_id": 50934343, "comment_id": 88870415, "body": "@chux Cuda apparently relies on various undefined behavior. I remember making the very same remark, but apparently that&#39;s the API."}, {"owner": {"reputation": 119299, "user_id": 1695960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f9f557c03db19232aa410540af2f966?s=128&d=identicon&r=PG", "display_name": "Robert Crovella", "link": "https://stackoverflow.com/users/1695960/robert-crovella"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1529440090, "post_id": 50934343, "comment_id": 88871475, "body": "The statement by @chux is correct. That is incorrect coding. OP should use ordinary pointers there, not arrays. CUDA does not rely on UB to my knowledge."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 119299, "user_id": 1695960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f9f557c03db19232aa410540af2f966?s=128&d=identicon&r=PG", "display_name": "Robert Crovella", "link": "https://stackoverflow.com/users/1695960/robert-crovella"}, "edited": false, "score": 0, "creation_date": 1529440774, "post_id": 50934343, "comment_id": 88871745, "body": "@RobertCrovella Should it be <code>int (*dev_A)[BLOCK_SIZE][BLOCK_SIZE]; cudaMalloc((void**)&amp;dev_A, sizeof *dev_A);</code>?  I am not strongly versed in CUDA."}, {"owner": {"reputation": 1, "user_id": 7605257, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yGlbj.jpg?s=128&g=1", "display_name": "Noppadol K.", "link": "https://stackoverflow.com/users/7605257/noppadol-k"}, "edited": false, "score": 0, "creation_date": 1529456334, "post_id": 50934343, "comment_id": 88875750, "body": "I have a problem with if i declare dev_A is a pointer, i will cannot use the add function because it has a problem with C = A+B"}, {"owner": {"reputation": 119299, "user_id": 1695960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f9f557c03db19232aa410540af2f966?s=128&d=identicon&r=PG", "display_name": "Robert Crovella", "link": "https://stackoverflow.com/users/1695960/robert-crovella"}, "edited": false, "score": 1, "creation_date": 1529470225, "post_id": 50934343, "comment_id": 88878630, "body": "yes, there are multiple issues here.  perhaps I should just mark this as a duplicate of <a href=\"https://stackoverflow.com/questions/45643682/cuda-using-2d-and-3d-arrays\">this</a>."}], "answers": [{"tags": [], "owner": {"reputation": 66945, "user_id": 681865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77320b8ddf13954ffb22aa22965d465e?s=128&d=identicon&r=PG&f=1", "display_name": "talonmies", "link": "https://stackoverflow.com/users/681865/talonmies"}, "is_accepted": true, "score": 0, "last_activity_date": 1529497374, "creation_date": 1529497374, "answer_id": 50948183, "question_id": 50934343, "link": "https://stackoverflow.com/questions/50934343/my-first-2d-arrays-cuda/50948183#50948183", "title": "My first 2D arrays CUDA", "body": "<p>There is a lot wrong with the code you posted, and most of it probably related to the ambiguous way that C and related languages deal with statically declared multidimensional arrays and the <code>[][]</code> style indexing scheme it supports.</p>\n\n<p>Rather than describe all the required fixes I will just leave this here:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#define BLOCK_SIZE 6\n#define GRID_SIZE 1\n\ntemplate&lt;typename T&gt;\nstruct array2D\n{\n\n    T* p;\n    int lda;\n\n    __device__ __host__ \n    array2D(T* _p, int cols) : p(_p), lda(cols) {}\n\n    __device__ __host__\n    T&amp; operator()(int i, int j) { return p[i * lda + j]; }\n\n    __device__ __host__\n    T&amp; operator()(int i, int j) const { return p[i * lda + j]; }\n};\n\n\n__global__ void test(array2D&lt;int&gt; A, array2D&lt;int&gt; B, array2D&lt;int&gt; C) {\n\n    int i = blockIdx.y * blockDim.y + threadIdx.y;\n    int j = blockIdx.x * blockDim.x + threadIdx.x;\n\n    C(i,j) = A(i,j) + B(i,j);\n}\n\nint main(){\n\n    int A[BLOCK_SIZE][BLOCK_SIZE];\n    int B[BLOCK_SIZE][BLOCK_SIZE];\n    int C[BLOCK_SIZE][BLOCK_SIZE];\n\n    for (int i = 0; i&lt;BLOCK_SIZE; i++) {\n        for (int j = 0; j&lt;BLOCK_SIZE; j++){\n            A[i][j] = i + j;\n            B[i][j] = i + j;\n        }\n    }\n\n    int* dev_A; cudaMalloc((void**)&amp;dev_A, BLOCK_SIZE * BLOCK_SIZE * sizeof(int));\n    int* dev_B; cudaMalloc((void**)&amp;dev_B, BLOCK_SIZE * BLOCK_SIZE * sizeof(int));\n    int* dev_C; cudaMalloc((void**)&amp;dev_C, BLOCK_SIZE * BLOCK_SIZE * sizeof(int));\n\n    cudaMemcpy(dev_A, A, BLOCK_SIZE * BLOCK_SIZE * sizeof(int), cudaMemcpyHostToDevice);\n    cudaMemcpy(dev_B, B, BLOCK_SIZE * BLOCK_SIZE * sizeof(int), cudaMemcpyHostToDevice);\n\n    dim3 dimBlock(BLOCK_SIZE, BLOCK_SIZE); // so your threads are BLOCK_SIZE*BLOCK_SIZE, 36 in this case\n    dim3 dimGrid(GRID_SIZE, GRID_SIZE); // 1*1 blocks in a grid\n    test &lt;&lt;&lt;dimGrid, dimBlock &gt;&gt;&gt; (array2D&lt;int&gt;(dev_A, BLOCK_SIZE),\n                                   array2D&lt;int&gt;(dev_B, BLOCK_SIZE), \n                                   array2D&lt;int&gt;(dev_C, BLOCK_SIZE));\n    cudaDeviceSynchronize();\n\n    cudaMemcpy(C, dev_C, BLOCK_SIZE * BLOCK_SIZE * sizeof(int), cudaMemcpyDeviceToHost);\n\n    for (int i = 0; i&lt;BLOCK_SIZE; i++) {\n        for (int j = 0; j&lt;BLOCK_SIZE; j++){\n            printf(\"(%d,%d) = %d {%d}\\n\", i, j, C[i][j], A[i][j] + B[i][j]);\n        }\n    }\n    return 0;\n}\n</code></pre>\n\n<p>The most important feature of the code is the use of a tiny wrapper class which provides you with the <code>(i,j)</code> style indexing you apparently want without any complexity in the kernel code. At this point you don't even need to understand how it works, just accept that it provides you with the necessary indexing mechanism you want within the kernel and use it.</p>\n\n<p>It you compile and run the code like so:</p>\n\n<pre><code>$ nvcc --std=c++11 myfirstpony.cu -o myfirstpony\n\n$ ./myfirstpony\n(0,0) = 0 {0}\n(0,1) = 2 {2}\n(0,2) = 4 {4}\n(0,3) = 6 {6}\n(0,4) = 8 {8}\n(0,5) = 10 {10}\n(1,0) = 2 {2}\n(1,1) = 4 {4}\n(1,2) = 6 {6}\n(1,3) = 8 {8}\n(1,4) = 10 {10}\n(1,5) = 12 {12}\n(2,0) = 4 {4}\n(2,1) = 6 {6}\n(2,2) = 8 {8}\n(2,3) = 10 {10}\n(2,4) = 12 {12}\n(2,5) = 14 {14}\n(3,0) = 6 {6}\n(3,1) = 8 {8}\n(3,2) = 10 {10}\n(3,3) = 12 {12}\n(3,4) = 14 {14}\n(3,5) = 16 {16}\n(4,0) = 8 {8}\n(4,1) = 10 {10}\n(4,2) = 12 {12}\n(4,3) = 14 {14}\n(4,4) = 16 {16}\n(4,5) = 18 {18}\n(5,0) = 10 {10}\n(5,1) = 12 {12}\n(5,2) = 14 {14}\n(5,3) = 16 {16}\n(5,4) = 18 {18}\n(5,5) = 20 {20}\n</code></pre>\n\n<p>You can see for yourself the correctness of the result. </p>\n"}, {"tags": [], "owner": {"reputation": 2651, "user_id": 3371258, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hmVpr.png?s=128&g=1", "display_name": "Candy Gumdrop", "link": "https://stackoverflow.com/users/3371258/candy-gumdrop"}, "is_accepted": false, "score": 1, "last_activity_date": 1529654654, "last_edit_date": 1529654654, "creation_date": 1529506501, "answer_id": 50951163, "question_id": 50934343, "link": "https://stackoverflow.com/questions/50934343/my-first-2d-arrays-cuda/50951163#50951163", "title": "My first 2D arrays CUDA", "body": "<p>There are two main issues to your code:</p>\n\n<p>Firstly, when you define an array within function scope like this:</p>\n\n<pre><code>int dev_A[BLOCK_SIZE][BLOCK_SIZE];\n</code></pre>\n\n<p>This creates an array of arrays in host memory which is stored contiguously on the stack.  This array can be used straight away from host code without further allocating any memory for it.  This is a real C array and not a pointer.  While this is fine and correct for <code>A</code>, <code>B</code> and <code>C</code>, this will not suffice for your declarations of <code>dev_A</code>, <code>dev_B</code> and <code>dev_C</code>, as you require memory allocated on the device for these.</p>\n\n<p>There are a couple of ways to correct this.  One way is to instead use a pointer to an array of arrays of ints.  The syntax for such a declaration is as follows:</p>\n\n<pre><code>int (*dev_A)[BLOCK_SIZE][BLOCK_SIZE];\n</code></pre>\n\n<p>If you go by this approach, I would recommend changing your <code>cudaMalloc</code> and <code>cudaMemcpy</code> calls as follows:</p>\n\n<pre><code>cudaMalloc((void **) &amp;dev_A, sizeof *dev_A);\n\n// ...\n\ncudaMemcpy(dev_A, &amp;A, sizeof *dev_A, cudaMemcpyHostToDevice);\n</code></pre>\n\n<p>The difference here is that using <code>sizeof *dev_A</code> is the same as writing <code>sizeof(int [BLOCK_SIZE][BLOCK_SIZE])</code>, which gives the number of bytes taken up by the entire host array, and using <code>&amp;A</code> instead of <code>A</code>, since <code>&amp;A</code> gives a pointer to an array of arrays, while <code>A</code> decays to a pointer to an array.  Technically what you already have should evaluate to the exact same values, since the size of an array is equal to the size of its elements multiplied by its length, and also a pointer to an array points to the same address as the first element in that array, however it would be more correct and consistent with how you would use <code>cudaMalloc</code> and <code>cudaMemcpy</code> with any other non-array type, and rightly treats the array of arrays as one single value:</p>\n\n<pre><code>int A, *dev_A;\ncudaMalloc((void **) &amp;dev_A, sizeof *dev_A);\ncudaMemcpy(dev_A, &amp;A, sizeof *dev_A, cudaMemcpyHostToDevice);\n</code></pre>\n\n<p>The other approach would be to dynamically allocate memory for multiple contiguous <code>int [BLOCK_SIZE]</code>s rather than a single <code>int [BLOCK_SIZE][BLOCK_SIZE]</code>, which could be done as follows:</p>\n\n<pre><code>int (*dev_A)[BLOCK_SIZE];\n// ...\ncudaMalloc((void **) &amp;dev_A, sizeof *dev_A * BLOCK_SIZE);\n// ...\ncudaMemcpy(dev_A, A, sizeof *dev_A * BLOCK_SIZE, cudaMemcpyHostToDevice);\n</code></pre>\n\n<p>This means <code>dev_A</code> now represents a pointer to an array of <code>BLOCK_SIZE</code> ints which is the first element of a sequence of <code>BLOCK_SIZE</code> contiguous arrays in memory.  Notice how this time, <code>A</code> is used for <code>cudaMemcpy</code> rather than <code>&amp;A</code>, as <code>A</code>'s <code>int [BLOCK_SIZE][BLOCK_SIZE]</code> type decays to <code>int (*)[BLOCK_SIZE]</code> which matches the type of <code>dev_A</code>.  Technically speaking, all the approaches mentioned so far do exactly the same thing and pass the same numerical values to the <code>cudaMalloc</code> and <code>cudaMemcpy</code> functions, however, the type of <code>dev_A</code>, <code>dev_B</code> and <code>dev_C</code> is important for how the arrays are used later.</p>\n\n<p>The second issue with your code is in the signature of the <code>test</code> kernel function itself.  This function has parameters declared like <code>int A[BLOCK_SIZE][BLOCK_SIZE]</code>, however, in C (and C++), when you declare an array parameter in a function, it is instead adjusted to actually be a pointer to the array's element type.  So <code>int A[N]</code> as a function parameter actually declares <code>int *A</code>, and the size is ignored.  In the case of arrays of arrays, such as <code>int A[N][M]</code>, this is converted to <code>int (*A)[M]</code>, which means your parameters are <code>int (*)[BLOCK_SIZE]</code> (pointer to an array of <code>BLOCK_SIZE</code> ints) and your function currently has the following effective signature:</p>\n\n<pre><code>__global__\nvoid test(int (*A)[BLOCK_SIZE],\n          int (*B)[BLOCK_SIZE],\n          int (*C)[BLOCK_SIZE])\n</code></pre>\n\n<p>If you stick with this function signature, then if you follow the approach of making <code>dev_A</code> and friends of type <code>int (*)[BLOCK_SIZE]</code>, then your code should work as is, as the expression <code>A[i][j]</code> in your function first locates and dereferences the <code>i</code>th array after the address <code>A</code>, and then this array value decays into an <code>int *</code> pointer, and then the <code>j</code>th <code>int</code> after this address is accessed.  However if you take the approach of declaring your device pointers as <code>int (*dev_A)[BLOCK_SIZE][BLOCK_SIZE]</code>, then you will either have to dereference these pointers when calling your kernel like so (which should be fine as the dereferenced array immediately decays into a pointer so device memory should not be accessed from host code):</p>\n\n<pre><code>test&lt;&lt;&lt;dimGrid, dimBlock&gt;&gt;&gt;(*dev_A, *dev_B, *dev_C);\n</code></pre>\n\n<p>Or alternatively, the signature of the <code>test</code> function can be changed as follows:</p>\n\n<pre><code>__global__\nvoid test(int (*A)[BLOCK_SIZE][BLOCK_SIZE],\n          int (*B)[BLOCK_SIZE][BLOCK_SIZE],\n          int (*C)[BLOCK_SIZE][BLOCK_SIZE])\n</code></pre>\n\n<p>When doing so however, these pointers-to-arrays must be first dereferenced before accessing their data, so your code within your function will have to be changed as follows:</p>\n\n<pre><code>(*C)[i][j] = (*A)[i][j] + (*B)[i][j];\n</code></pre>\n\n<p>Using plain C arrays, arrays of arrays, pointers to arrays, and pointers to arrays of arrays can have quite confusing semantics, and also requires your array's size to be fixed at compile-time, so you may prefer instead of using any of these approaches to use a single linear sequence of <code>int</code>s, and then index the elements yourself, for example:</p>\n\n<pre><code>void test(int *A)\n{\n    A[row * BLOCK_SIZE + col] = 123;\n}\n</code></pre>\n\n<p>Device memory for this can easily be allocated as follows:</p>\n\n<pre><code>int *dev_A;\ncudaMalloc((void **) &amp;dev_A, sizeof *dev_A * BLOCK_SIZE * BLOCK_SIZE);\n</code></pre>\n\n<p>An important note is that CUDA code is not C and is actually C++, however your code and the code discussed in this answer is both valid C and C++ (ignoring CUDA extensions).  This may create some additional obstacles when writing C-like code, for example having to explicitly cast <code>void *</code> values to other pointer types, but also allows you to make use of useful C++ features such as operator overloading, as featured in talonmies's answer, to encapsulate addressing a 2D grid of values within a single linear buffer of data (so you can write <code>A(row, col)</code> instead of <code>A[row * BLOCK_SIZE + col]</code>).</p>\n"}], "owner": {"reputation": 1, "user_id": 7605257, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yGlbj.jpg?s=128&g=1", "display_name": "Noppadol K.", "link": "https://stackoverflow.com/users/7605257/noppadol-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 132, "favorite_count": 0, "accepted_answer_id": 50948183, "answer_count": 2, "score": 0, "last_activity_date": 1529654654, "creation_date": 1529430819, "last_edit_date": 1529434410, "question_id": 50934343, "link": "https://stackoverflow.com/questions/50934343/my-first-2d-arrays-cuda", "title": "My first 2D arrays CUDA", "body": "<pre><code>#include \"cuda_runtime.h\"\n#include \"device_launch_parameters.h\"\n#include &lt;stdio.h&gt;\n\n#define BLOCK_SIZE 6\n#define GRID_SIZE 1\n\n__global__ void test(int A[BLOCK_SIZE][BLOCK_SIZE], int B[BLOCK_SIZE][BLOCK_SIZE], int C[BLOCK_SIZE][BLOCK_SIZE]) {\n\n    int i = blockIdx.y * blockDim.y + threadIdx.y;\n    int j = blockIdx.x * blockDim.x + threadIdx.x;\n\n    C[i][j] = A[i][j] + B[i][j];\n\n}\n\nint main(){\n\n    int A[BLOCK_SIZE][BLOCK_SIZE];\n    int B[BLOCK_SIZE][BLOCK_SIZE];\n    int C[BLOCK_SIZE][BLOCK_SIZE];\n\n    for (int i = 0; i&lt;BLOCK_SIZE; i++)\n        for (int j = 0; j&lt;BLOCK_SIZE; j++){\n            A[i][j] = i + j;\n            B[i][j] = i + j;\n        }\n\n    int dev_A[BLOCK_SIZE][BLOCK_SIZE];\n    int dev_B[BLOCK_SIZE][BLOCK_SIZE];\n    int dev_C[BLOCK_SIZE][BLOCK_SIZE];\n    cudaMalloc((void**)&amp;dev_C, BLOCK_SIZE * BLOCK_SIZE * sizeof(int));\n    cudaMalloc((void**)&amp;dev_A, BLOCK_SIZE * BLOCK_SIZE * sizeof(int));\n    cudaMalloc((void**)&amp;dev_B, BLOCK_SIZE * BLOCK_SIZE * sizeof(int));\n\n    cudaMemcpy(dev_A, A, BLOCK_SIZE * BLOCK_SIZE * sizeof(int), cudaMemcpyHostToDevice);\n    cudaMemcpy(dev_B, B, BLOCK_SIZE * BLOCK_SIZE * sizeof(int), cudaMemcpyHostToDevice);\n\n    dim3 dimBlock(BLOCK_SIZE, BLOCK_SIZE); // so your threads are BLOCK_SIZE*BLOCK_SIZE, 36 in this case\n    dim3 dimGrid(GRID_SIZE, GRID_SIZE); // 1*1 blocks in a grid\n    test &lt;&lt;&lt;dimGrid, dimBlock &gt;&gt;&gt; (dev_A, dev_B, dev_C);\n    cudaDeviceSynchronize();\n\n    cudaMemcpy(C, dev_C, BLOCK_SIZE * BLOCK_SIZE * sizeof(int), cudaMemcpyDeviceToHost);\n}\n</code></pre>\n\n<p>I tried to copy this code <a href=\"https://stackoverflow.com/questions/5029920/how-to-use-2d-arrays-in-cuda\">How to use 2D Arrays in CUDA?</a>.</p>\n\n<p>Some website tell me to use something like</p>\n\n<pre><code>result[row*WIDTH + col] = array1[row*WIDTH + col] + array2[row*WIDTH + col];\n</code></pre>\n\n<p>but I don't know how to use it.\nMy solution is always -858993460</p>\n"}]