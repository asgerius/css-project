[{"tags": ["c", "arrays", "copy", "malloc"], "comments": [{"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 6, "creation_date": 1516233432, "post_id": 48311878, "comment_id": 83609586, "body": "<code>free</code> memory when you no longer need it .. simple as that"}, {"owner": {"reputation": 5010, "user_id": 3150445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bfca2588483eadf6695a120cbcef1f8?s=128&d=identicon&r=PG&f=1", "display_name": "jwdonahue", "link": "https://stackoverflow.com/users/3150445/jwdonahue"}, "edited": false, "score": 0, "creation_date": 1516234786, "post_id": 48311878, "comment_id": 83609923, "body": "Please take the <a href=\"https://stackoverflow.com/tour\">tour</a> and read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>.  There are probably existing answers to this question in these search results: <a href=\"https://stackoverflow.com/search?q=%5Bc%5Dwhere+to+free\">stackoverflow.com/search?q=%5Bc%5Dwhere+to+free</a>"}], "answers": [{"comments": [{"owner": {"reputation": 509, "user_id": 9220448, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5YtOb.jpg?s=128&g=1", "display_name": "mariusz_latarnik01", "link": "https://stackoverflow.com/users/9220448/mariusz-latarnik01"}, "edited": false, "score": 0, "creation_date": 1516233547, "post_id": 48311893, "comment_id": 83609612, "body": "don&#39;t worry about free? xdd"}, {"owner": {"reputation": 3, "user_id": 7828814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e74e7a224b280903cf752f88d9924a51?s=128&d=identicon&r=PG&f=1", "display_name": "Simon Arndt", "link": "https://stackoverflow.com/users/7828814/simon-arndt"}, "edited": false, "score": 0, "creation_date": 1516233580, "post_id": 48311893, "comment_id": 83609622, "body": "But how to free after print?"}, {"owner": {"reputation": 3, "user_id": 7828814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e74e7a224b280903cf752f88d9924a51?s=128&d=identicon&r=PG&f=1", "display_name": "Simon Arndt", "link": "https://stackoverflow.com/users/7828814/simon-arndt"}, "edited": false, "score": 0, "creation_date": 1516233643, "post_id": 48311893, "comment_id": 83609644, "body": "Like that: free(stringcat(surname, lastname)); ?"}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "reply_to_user": {"reputation": 509, "user_id": 9220448, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5YtOb.jpg?s=128&g=1", "display_name": "mariusz_latarnik01", "link": "https://stackoverflow.com/users/9220448/mariusz-latarnik01"}, "edited": false, "score": 2, "creation_date": 1516233889, "post_id": 48311893, "comment_id": 83609708, "body": "@mariusz_latarnik01 in a simple program like the OP&#39;s program there is no harm in forgetting the <code>free</code>, because the OS will free any memory left when the process is gone. I do however believes that that&#39;s bad style. For larger projects you should free the memory when you don&#39;t need it."}, {"owner": {"reputation": 182833, "user_id": 2970947, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HAq55.png?s=128&g=1", "display_name": "Elliott Frisch", "link": "https://stackoverflow.com/users/2970947/elliott-frisch"}, "reply_to_user": {"reputation": 3, "user_id": 7828814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e74e7a224b280903cf752f88d9924a51?s=128&d=identicon&r=PG&f=1", "display_name": "Simon Arndt", "link": "https://stackoverflow.com/users/7828814/simon-arndt"}, "edited": false, "score": 0, "creation_date": 1516234000, "post_id": 48311893, "comment_id": 83609729, "body": "@SimonArndt If you call it twice, then you allocate memory twice. If you <code>free</code> it as you propose there then you allocate two and free one. That&#39;s the same memory leak (plus a pointless allocation and free)."}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "reply_to_user": {"reputation": 3, "user_id": 7828814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e74e7a224b280903cf752f88d9924a51?s=128&d=identicon&r=PG&f=1", "display_name": "Simon Arndt", "link": "https://stackoverflow.com/users/7828814/simon-arndt"}, "edited": false, "score": 0, "creation_date": 1516234053, "post_id": 48311893, "comment_id": 83609747, "body": "@SimonArndt read our answers, we&#39;ve both told you how to deal with it."}], "tags": [], "owner": {"reputation": 182833, "user_id": 2970947, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HAq55.png?s=128&g=1", "display_name": "Elliott Frisch", "link": "https://stackoverflow.com/users/2970947/elliott-frisch"}, "is_accepted": false, "score": 2, "last_activity_date": 1516234069, "last_edit_date": 1516234069, "creation_date": 1516233414, "answer_id": 48311893, "question_id": 48311878, "link": "https://stackoverflow.com/questions/48311878/where-to-free-in-c-code/48311893#48311893", "title": "Where to free In C Code", "body": "<p>You leak memory because you don't assign the result of <code>stringcat</code> to a <code>char *</code>. Do so. And then <code>free</code> that after you <code>print</code>. Or (in a trivial program such as presented here) don't worry about it, and let <code>main</code> exiting cause it for you.</p>\n\n<pre><code>char *name = stringcat(surname, lastname);\nprintf(\"%s\\n\", name);\nfree(name);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 7828814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e74e7a224b280903cf752f88d9924a51?s=128&d=identicon&r=PG&f=1", "display_name": "Simon Arndt", "link": "https://stackoverflow.com/users/7828814/simon-arndt"}, "edited": false, "score": 0, "creation_date": 1516234996, "post_id": 48311934, "comment_id": 83609977, "body": "thanks. so you recomment to null res at the end? &quot;res = NULL;&quot;"}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "reply_to_user": {"reputation": 5010, "user_id": 3150445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bfca2588483eadf6695a120cbcef1f8?s=128&d=identicon&r=PG&f=1", "display_name": "jwdonahue", "link": "https://stackoverflow.com/users/3150445/jwdonahue"}, "edited": false, "score": 0, "creation_date": 1516235074, "post_id": 48311934, "comment_id": 83609991, "body": "@jwdonahue technically there is no guarantee that size of pointers should the same, but in practice they are. <code>sizeof *ptr</code> however will return the correct size. See <a href=\"https://stackoverflow.com/questions/1241205/are-all-data-pointers-the-same-size-in-one-platform-for-all-data-types\" title=\"are all data pointers the same size in one platform for all data types\">stackoverflow.com/questions/1241205/&hellip;</a>"}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "reply_to_user": {"reputation": 3, "user_id": 7828814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e74e7a224b280903cf752f88d9924a51?s=128&d=identicon&r=PG&f=1", "display_name": "Simon Arndt", "link": "https://stackoverflow.com/users/7828814/simon-arndt"}, "edited": false, "score": 1, "creation_date": 1516235226, "post_id": 48311934, "comment_id": 83610037, "body": "@SimonArndt For me, it depends. There are good reasons for doing it, but in your example there is no point, because your program ends at that point anyway. See <a href=\"https://stackoverflow.com/a/1025604/1480131\">stackoverflow.com/a/1025604/1480131</a>"}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "reply_to_user": {"reputation": 5010, "user_id": 3150445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bfca2588483eadf6695a120cbcef1f8?s=128&d=identicon&r=PG&f=1", "display_name": "jwdonahue", "link": "https://stackoverflow.com/users/3150445/jwdonahue"}, "edited": false, "score": 0, "creation_date": 1516235716, "post_id": 48311934, "comment_id": 83610149, "body": "@jwdonahue I didn&#39;t say that. If <code>arr</code> is for example a simple pointer, then <code>sizeof arr != sizeof *arr</code> (there might be types where this is true, but not in general)."}, {"owner": {"reputation": 5010, "user_id": 3150445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bfca2588483eadf6695a120cbcef1f8?s=128&d=identicon&r=PG&f=1", "display_name": "jwdonahue", "link": "https://stackoverflow.com/users/3150445/jwdonahue"}, "edited": false, "score": 0, "creation_date": 1516235781, "post_id": 48311934, "comment_id": 83610161, "body": "@Pablo, brain fart. I deleted my comment the same time you posted your response.  My lesdyxia is messing with my head today."}, {"owner": {"reputation": 189, "user_id": 3856983, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a67a988dace3ed748d1aec31a925c2f8?s=128&d=identicon&r=PG&f=1", "display_name": "MountainLogic", "link": "https://stackoverflow.com/users/3856983/mountainlogic"}, "edited": false, "score": 0, "creation_date": 1516236010, "post_id": 48311934, "comment_id": 83610217, "body": "While not an issue in the case, always make sure you check for other return statements in the code that have might otherwise exited without freeing any malloc&#39;ed memory.  Often that &quot;never-mind I&#39;m leaving early,&quot; return statement can have you bleeding heap memory."}], "tags": [], "owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "is_accepted": true, "score": 2, "last_activity_date": 1516234553, "last_edit_date": 1516234553, "creation_date": 1516233717, "answer_id": 48311934, "question_id": 48311878, "link": "https://stackoverflow.com/questions/48311878/where-to-free-in-c-code/48311934#48311934", "title": "Where to free In C Code", "body": "<p>Usually you should free the memory at the point where you don't need it any more. For that you should store the pointer somewhere.</p>\n\n<pre><code>int main() {\n    char surname[] = \"Simon\";\n    char lastname[] = \"Arndt\";\n    char *res;\n\n    res = stringcat(surname, lastname); // first store it\n    if(res == NULL)\n    {\n        fprintf(stderr, \"error\");\n        return 1;\n    }\n\n    // then print it\n    puts(res); // equivalent to printf(\"%s\\n\", res);\n\n\n    free(res);\n\n    return 0;\n}\n</code></pre>\n\n<p>Don't forget that C-Strings are <code>\\0</code>-terminated, that means that when you\ndynamically allocate memory for a string, you should allocate at least\n<code>strlen(string) + 1</code>:</p>\n\n<pre><code>char * newstr = malloc(length + 1);\n\nif(newstr == NULL)\n    return NULL;\n</code></pre>\n\n<p>In case of strings you don't need the <code>sizeof(char)</code> because it is always one.</p>\n\n<p>For other types, avoid using <code>sizeof(&lt;type&gt;)</code>, it's easy to make mistakes.\nInstead do it like this:</p>\n\n<pre><code>int *arr = malloc(10 * sizeof *arr);\n</code></pre>\n\n<p>The <code>sizeof *arr</code> will always return the correct number of bytes.</p>\n\n<p><strong>edit</strong></p>\n\n<p>You should always check for that <code>malloc</code> doesn't return <code>NULL</code>. Sure, for a\nsimple program like this, you can skip it. But in a larger project, you\ndefinitely should check that.</p>\n"}], "owner": {"reputation": 3, "user_id": 7828814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e74e7a224b280903cf752f88d9924a51?s=128&d=identicon&r=PG&f=1", "display_name": "Simon Arndt", "link": "https://stackoverflow.com/users/7828814/simon-arndt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 48311934, "answer_count": 2, "score": 0, "last_activity_date": 1516237739, "creation_date": 1516233294, "question_id": 48311878, "link": "https://stackoverflow.com/questions/48311878/where-to-free-in-c-code", "title": "Where to free In C Code", "body": "<p>I have a working C code. It connnects 2 char arrays and prints the solution out. <br> But I have a dynamic memory management here (malloc) and have to free it now. <br>Can someone tell me where to free and why?</p>\n\n<pre><code>char * stringcat(const char * str1, const char * str2) {\n    int length_1 = strlength(str1);\n    int length_2 = strlength(str2);\n    int length = length_1 + length_2 + 1;\n\n    char * newstr = malloc(sizeof(char) * length);\n\n    for(int i=0; i &lt; length; i++)\n    {\n        char charToCopy = '\\0';\n        if(i &lt; length_1)\n        {\n            charToCopy = *(str1 + i);\n        } else if(i &lt; (length_1 + length_2)) {\n            charToCopy = *(str2 + i - length_1);\n        }\n\n        *(newstr + i) = charToCopy;\n    }\n\n    return newstr;\n}\n\n\nint strlength(char *c) {\n    int count = 0;\n    while(*(c + count) != '\\0') {\n        count++;\n    }\n    return count;\n}\n\n\nint main() {\n\n    char surname[] = \"Simon\";\n    char lastname[] = \"Arndt\";\n\n    printf(\"%s\\n\", stringcat(surname, lastname));\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "cmake", "escaping"], "comments": [{"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1516232458, "post_id": 48311733, "comment_id": 83609321, "body": "Have you tried <code>-E echo \\&quot;#include Something\\&quot; &gt; \\&quot;${BUILD_INFO_CPP}\\&quot;</code>?"}, {"owner": {"reputation": 5913, "user_id": 1244932, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d2c608e688b798896e8b516855fc1ab1?s=128&d=identicon&r=PG", "display_name": "user1244932", "link": "https://stackoverflow.com/users/1244932/user1244932"}, "reply_to_user": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1516233020, "post_id": 48311733, "comment_id": 83609484, "body": "@Pablo This is not helps, <code>cmake</code> eat quotes. But looks like <code>VERBATIM</code> works."}], "answers": [{"tags": [], "owner": {"reputation": 9936, "user_id": 6525260, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-DdsW6uGdpjg/AAAAAAAAAAI/AAAAAAAAAAw/srXxxqCzyW0/photo.jpg?sz=128", "display_name": "Arnav Borborah", "link": "https://stackoverflow.com/users/6525260/arnav-borborah"}, "is_accepted": false, "score": 1, "last_activity_date": 1516233648, "creation_date": 1516233648, "answer_id": 48311925, "question_id": 48311733, "link": "https://stackoverflow.com/questions/48311733/cmake-add-custom-target-escaping/48311925#48311925", "title": "cmake add_custom_target escaping", "body": "<p>According to the official documentation for <a href=\"https://cmake.org/cmake/help/v3.0/command/add_custom_target.html\" rel=\"nofollow noreferrer\"><code>add_custom_target</code></a> (CMake 3.0):</p>\n\n<blockquote>\n  <p>If VERBATIM is given <strong>then all arguments to the commands will be escaped properly for the build tool so that the invoked command receives each argument unchanged</strong>. Note that one level of escapes is still used by the CMake language processor before add_custom_target even sees the arguments. Use of VERBATIM is recommended as it enables correct behavior. <strong>When VERBATIM is not given the behavior is platform specific because there is no protection of tool-specific special characters.</strong></p>\n</blockquote>\n\n<p>Thus, add <code>VERBATIM</code> so that the command is properly escaped in <code>add_custom_target</code>.</p>\n\n<p>The same applies for all versions onwards and CMake 2.8 as well.</p>\n"}], "owner": {"reputation": 5913, "user_id": 1244932, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d2c608e688b798896e8b516855fc1ab1?s=128&d=identicon&r=PG", "display_name": "user1244932", "link": "https://stackoverflow.com/users/1244932/user1244932"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 296, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1516233812, "creation_date": 1516232272, "last_edit_date": 1516233812, "question_id": 48311733, "link": "https://stackoverflow.com/questions/48311733/cmake-add-custom-target-escaping", "title": "cmake add_custom_target escaping", "body": "<p>Here is minimal <code>CMakeLists.txt</code> to reproduce problem:</p>\n\n<pre><code>cmake_minimum_required(VERSION 3.9 FATAL_ERROR)\n\nset(BUILD_INFO_CPP \"${CMAKE_BINARY_DIR}/build_info.cpp\")\nadd_custom_target(GenerateBuildInfo ALL\n   COMMAND ${CMAKE_COMMAND} -E echo \"#include Something\" &gt; \"${BUILD_INFO_CPP}\"\n)\n</code></pre>\n\n<p>On every build I want regenerate <code>${CMAKE_BINARY_DIR}/build_info.cpp</code>,\nbut this code not create <code>build_info.cpp</code>, because of <code>cmake</code> execute it like this:</p>\n\n<pre><code>/usr/bin/cmake -E echo #include &gt; /tmp/2/build/build_info.cpp\n</code></pre>\n\n<p>and as understand shell interpret <code>#</code> as start of comments, so this is equivalent to</p>\n\n<pre><code>/usr/bin/cmake -E echo\n</code></pre>\n\n<p>I wonder is special symbols escaping not implemented in <code>cmake</code>?</p>\n\n<p>I use linux/bash and Makefile generator.</p>\n"}, {"tags": ["c", "memory-management", "malloc"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1516229089, "post_id": 48311200, "comment_id": 83608254, "body": "<code>malloc</code> <i>may</i> allocate space larger than requested depending on the algorithm used."}, {"owner": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 1, "creation_date": 1516229317, "post_id": 48311200, "comment_id": 83608355, "body": "(135168 B is 132 KiB and 270336 B is 264 KiB.)"}, {"owner": {"reputation": 1342, "user_id": 6946652, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/6W5x0.jpg?s=128&g=1", "display_name": "Bobby", "link": "https://stackoverflow.com/users/6946652/bobby"}, "reply_to_user": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1516229475, "post_id": 48311200, "comment_id": 83608420, "body": "@ikegami it looks pretty interesting almost feels like page by page. But page is wayy smaller than this. If this is an optimization, why is malloc_info not abstracting away this"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1516231001, "post_id": 48311200, "comment_id": 83608939, "body": "Since <code>malloc_info</code> is a GNU extension, you might want to read <a href=\"https://www.gnu.org/software/libc/manual/html_node/Memory.html#Memory\" rel=\"nofollow noreferrer\">the glibc manual&#39;s chapter on memory management</a>.  You might also look around for a definition of what <code>malloc_info</code>&#39;s output means, as I suspect your surprise arises in part from misinterpreting it."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 1, "creation_date": 1516231319, "post_id": 48311200, "comment_id": 83609035, "body": "Isn&#39;t easier instead of asking seeing the malloc source for your system"}], "owner": {"reputation": 1342, "user_id": 6946652, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/6W5x0.jpg?s=128&g=1", "display_name": "Bobby", "link": "https://stackoverflow.com/users/6946652/bobby"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 102, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1516231626, "creation_date": 1516228979, "question_id": 48311200, "link": "https://stackoverflow.com/questions/48311200/why-smaller-alloc-doesnt-change-malloc-info-but-larger-ones-does", "title": "Why smaller alloc doesn&#39;t change malloc_info but larger ones does", "body": "<p>I was playing around with <code>malloc_info</code> today and I discovered some very strange behaviors. The <code>malloc_info</code> size doesn't grow linearly with the size of malloc I am calling. It jumps around with different parameters to malloc and there are certain magic numbers that just keeps showing up. I was guessing this might be some kind of optimization by c to allocate chunk by chunk without actually using all of them. </p>\n\n<p>Some interesting magic numbers</p>\n\n<p><code>&lt;aspace type=\"total\" size=\"135168\"/&gt;</code> happens for most of malloc calls that don't ask for a huge memory. Like <code>malloc(1500)</code></p>\n\n<p><code>&lt;system type=\"current\" size=\"270336\"/&gt;</code> happens for slightly larger ones. Like <code>malloc(1500</code> called 100 times in a loop.  </p>\n\n<p>But the interesting thing is, <code>malloc(1000)</code> called 100 times in a loop gives me the magic number <code>135168</code> again. So it seems to be some arbitrary cut off between 1000 and 1500 called 100 times in a loop.</p>\n\n<p>Can anyone shine some light on this strange behavior? I am doing a task of replacing old <code>mallinfo</code> with 64 bit compatible function</p>\n"}, {"tags": ["c", "while-loop", "fgets", "input-buffer"], "comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1516228688, "post_id": 48311092, "comment_id": 83608080, "body": "After fgets you probably want to clear the remainder of the input line if it didn&#39;t read a whole line"}, {"owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "reply_to_user": {"reputation": 6975, "user_id": 3121023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f52448806175b9aa66c86d40cf0829f1?s=128&d=identicon&r=PG&f=1", "display_name": "user3121023", "link": "https://stackoverflow.com/users/3121023/user3121023"}, "edited": false, "score": 0, "creation_date": 1516228719, "post_id": 48311092, "comment_id": 83608096, "body": "@user3121023: it is the answer, and you could make an answer with it..."}, {"owner": {"reputation": 401, "user_id": 8157681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/254e5f1c21d197ec875de4f2e70fd40c?s=128&d=identicon&r=PG&f=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/8157681/dan"}, "edited": false, "score": 0, "creation_date": 1516229099, "post_id": 48311092, "comment_id": 83608256, "body": "We need a National Programmers Day - honor all the programmers that struggled so we can just take plain English and compile it"}], "answers": [{"tags": [], "owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "is_accepted": true, "score": 3, "last_activity_date": 1516229755, "last_edit_date": 1516229755, "creation_date": 1516229066, "answer_id": 48311213, "question_id": 48311092, "link": "https://stackoverflow.com/questions/48311092/while-loop-skips-the-first-fgets-on-second-iteration/48311213#48311213", "title": "While loop skips the first `fgets()` on second iteration", "body": "<p>When you enter <code>Y&lt;ENTER&gt;</code>, then you have 2 characters in the input buffer: <code>Y</code> and <code>\\n</code>. Since <code>answer</code> is a <code>char[2]</code> and <code>fgets</code> always writes a C-String, the string saved in <code>answer</code> will be <code>\"Y\"</code>.</p>\n\n<p>The newline character remains in the input buffer, so the next <code>fgets</code> reads the remainder of the input buffer. Because its a newline, <code>fgets</code> reads only the newline, thus <code>word</code> will have the string <code>\"\\n\"</code>.</p>\n\n<p>You can declare the array <code>answer</code> with a larger dimension (at least 3) or use <code>word</code> instead. If you choose the former, then you should do</p>\n\n<pre><code>char answer[10];\n...\nif (strcmp(answer, \"F\\n\") == 0)\n   ...\n</code></pre>\n\n<p><strong>edit</strong></p>\n\n<p>I'd like to add a quote from the <code>fgets</code> man page, this summarizes how <code>fgets</code>\nwork.</p>\n\n<blockquote>\n  <p><em>man fgets</em></p>\n\n<pre><code>#include &lt;stdio.h&gt;\nchar *fgets(char *s, int size, FILE *stream);\n</code></pre>\n  \n  <p><strong>DESCRIPTION</strong></p>\n  \n  <p><code>fgets()</code> reads  in  <strong>at  most  one less than <code>size</code> characters</strong> from <code>stream</code> and stores them into the buffer pointed to by <code>s</code>.\n  <strong>Reading stops after an <code>EOF</code> or a newline.  If a newline is read, it is stored into the buffer</strong>.  A terminating null byte (<code>'\\0'</code>)\n  is  stored  after  the  last character in the buffer.</p>\n</blockquote>\n"}], "owner": {"reputation": 401, "user_id": 8157681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/254e5f1c21d197ec875de4f2e70fd40c?s=128&d=identicon&r=PG&f=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/8157681/dan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1100, "favorite_count": 0, "closed_date": 1516252221, "accepted_answer_id": 48311213, "answer_count": 1, "score": 1, "last_activity_date": 1516229755, "creation_date": 1516228387, "last_edit_date": 1516228487, "question_id": 48311092, "link": "https://stackoverflow.com/questions/48311092/while-loop-skips-the-first-fgets-on-second-iteration", "closed_reason": "Duplicate", "title": "While loop skips the first `fgets()` on second iteration", "body": "<p>I know questions like this get asked all the time, and I have read several, however, I never use <code>scanf()</code> in my code like all the other ones, so I cannot find a comparable question.  I don't know why on the second, third, fourth and so on iterations, the while loop is skipping my first <code>fgets()</code>.</p>\n\n<p>Code:</p>\n\n<pre><code>    int main()\n{\n    char word[40];\n    char answer[2];\n    while(true) {\n        printf(\"Please enter word: \");\n        fgets(word, sizeof(word), stdin);\n        printf(\"Your word is: %s\\n\", word);\n        printf(\"Would you like to go again?\");\n        fgets(answer, sizeof(answer), stdin);\n        printf(\"%d\\n\", strcmp(answer, \"F\"));\n        if (strcmp(answer, \"F\") == 0) {\n            printf(\"breaking\");\n            break;\n        } else {\n            printf(\"continuing\");\n            continue;\n        }\n    }\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>Please enter word: Hey\nYour word is: Hey\n\nWould you like to go again?Y\nPlease enter word: Your word is: \n\nWould you like to go again?Y\nPlease enter word: Your word is: \n\nWould you like to go again?Y\n</code></pre>\n\n<p>...etc.</p>\n\n<p>I figure this has something to do with clearing the input buffer, and I have tried several things, but nothing is working.  Second day messing around with C, so I don't understand to much of it. (Python was easier lol)</p>\n"}, {"tags": ["c++", "c", "memory", "malloc"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 7, "creation_date": 1516226387, "post_id": 48310692, "comment_id": 83607108, "body": "Are you using C or C++?  If it is the latter you shouldn&#39;t be using <code>malloc</code>."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 2, "creation_date": 1516226473, "post_id": 48310692, "comment_id": 83607143, "body": "Yet another bug that would be fixed by not using <code>sizeof(type)</code> in malloc"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1516226509, "post_id": 48310692, "comment_id": 83607163, "body": "There must be dozens of duplicates of this question. Got a link @M.M?"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 1, "creation_date": 1516226631, "post_id": 48310692, "comment_id": 83607216, "body": "<i>I was doing a simple code</i> -- It would be a lot more simpler if you used <code>std::string</code> and/or <code>std::vector</code> instead of raw pointers."}, {"owner": {"reputation": 26959, "user_id": 1294207, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Inny3.jpg?s=128&g=1", "display_name": "Fantastic Mr Fox", "link": "https://stackoverflow.com/users/1294207/fantastic-mr-fox"}, "reply_to_user": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1516227743, "post_id": 48310692, "comment_id": 83607739, "body": "@PaulMcKenzie But the jury is still out on if this is <code>c++</code> or not. No indicators in the code unfortunately."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1516228549, "post_id": 48310692, "comment_id": 83608017, "body": "True enough. C with a redundant cast or C++ with obsolete reference material. But C++ is tagged, so C++ options should be considered."}], "answers": [{"comments": [{"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "reply_to_user": {"reputation": 3, "user_id": 7081781, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9bd0cb4731fde749347dfd9750a7af47?s=128&d=identicon&r=PG&f=1", "display_name": "Rafael Marinho", "link": "https://stackoverflow.com/users/7081781/rafael-marinho"}, "edited": false, "score": 1, "creation_date": 1516228736, "post_id": 48310719, "comment_id": 83608108, "body": "@RafaelMarinho, The argument to <code>sizeof</code> can be a type or an expression. When it is an expression, its type is used to come up with the size. When you use <code>*CM</code> as argument to <code>sizeof</code>, tit evaluates to expression of type <code>char*</code>, which is exactly what you need."}], "tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": true, "score": 3, "last_activity_date": 1516226789, "last_edit_date": 1516226789, "creation_date": 1516226441, "answer_id": 48310719, "question_id": 48310692, "link": "https://stackoverflow.com/questions/48310692/weird-issue-with-malloc/48310719#48310719", "title": "Weird issue with malloc", "body": "<p><code>malloc(sizeof(char)*lines)</code> allocates enough memory to hold <code>line</code> number of <code>char</code>s. You need enough memory to hold <code>line</code> number of <code>char*</code>s. Hence, you need to use <code>sizeof(char*)</code> instead of <code>sizeof(char)</code>.</p>\n\n<pre><code>CM = (char**)malloc(sizeof(char*)*lines);\nACM = (char**)malloc(sizeof(char*)*lines);\n</code></pre>\n\n<p>As a matter of good coding practice, use:</p>\n\n<pre><code>CM = (char**)malloc(sizeof(*CM)*lines);    // CM  -&gt; sizeof(*CM)\nACM = (char**)malloc(sizeof(*ACM)*lines);  // ACM -&gt; sizeof(*ACM)\n</code></pre>\n\n<p>That would prevent errors of the kind you ran into.</p>\n"}, {"tags": [], "owner": {"reputation": 11238, "user_id": 7594711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7872c871b0431b72df6350dd0394bea?s=128&d=identicon&r=PG&f=1", "display_name": "SoronelHaetir", "link": "https://stackoverflow.com/users/7594711/soronelhaetir"}, "is_accepted": false, "score": 0, "last_activity_date": 1516226457, "creation_date": 1516226457, "answer_id": 48310724, "question_id": 48310692, "link": "https://stackoverflow.com/questions/48310692/weird-issue-with-malloc/48310724#48310724", "title": "Weird issue with malloc", "body": "<p>In</p>\n\n<pre><code>ACM = (char**)malloc(sizeof(char)*lines);\n</code></pre>\n\n<p>You are allocating lines chars, not lines char*s</p>\n"}, {"tags": [], "owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "is_accepted": false, "score": 0, "last_activity_date": 1516226641, "creation_date": 1516226641, "answer_id": 48310771, "question_id": 48310692, "link": "https://stackoverflow.com/questions/48310692/weird-issue-with-malloc/48310771#48310771", "title": "Weird issue with malloc", "body": "<p>With <code>char **CM = (char**)malloc(sizeof(char)*lines)</code> and <code>char **ACM = (char**)malloc(sizeof(char)*lines)</code>, you allocate a sequence of characters, though you should allocate a list of pointers.</p>\n\n<p>Write <code>char **CM = (char**)malloc(sizeof(char*)*lines)</code> and <code>char **ACM = (char**)malloc(sizeof(char*)*lines)</code> instead.</p>\n\n<p>As a general rule, the return type (<code>char**</code> in your case) usually has one more star than the type inside the <code>malloc</code>, i.e. (<code>char*</code> in your case).</p>\n\n<p>Note further, that in C you usually do not cast the result of malloc, whereas in C++ you have to cast. BTW: <code>malloc</code> is rarely used in C++.</p>\n"}], "owner": {"reputation": 3, "user_id": 7081781, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9bd0cb4731fde749347dfd9750a7af47?s=128&d=identicon&r=PG&f=1", "display_name": "Rafael Marinho", "link": "https://stackoverflow.com/users/7081781/rafael-marinho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "accepted_answer_id": 48310719, "answer_count": 3, "score": 0, "last_activity_date": 1516226789, "creation_date": 1516226307, "last_edit_date": 1516226560, "question_id": 48310692, "link": "https://stackoverflow.com/questions/48310692/weird-issue-with-malloc", "title": "Weird issue with malloc", "body": "<p>I was doing a simple code to open a file with a matrix but I got a weird error. Here's my code:</p>\n\n<pre><code>char** CM;\nchar** ACM;\nint lines, columns;\nint i, j;\n\n//read file\nFILE* file = fopen(\"matrix.txt\", \"r\");\nfscanf(file, \"%i %i\", &amp;lines, &amp;columns);\nCM = (char**)malloc(sizeof(char)*lines);\nACM = (char**)malloc(sizeof(char)*lines);\nfor(i=0; i&lt;lines; i++)\n{\n    CM[i] = (char*)malloc(sizeof(char)*columns+1);\n    ACM[i] = (char*)malloc(sizeof(char)*columns);\n    fscanf(file, \"%s\", CM[i]);\n    CM[i] = (char*)realloc(CM[i], sizeof(char)*columns);//don't need \\n\n    printf(\"%s\\n\", CM[i]);\n}\nprintf(\"\\n\");\nfor(i=0; i&lt;lines; i++)\n{\n    printf(\"%s\\n\", CM[i]);\n}\n</code></pre>\n\n<p>But it happens that the output is not what I expected:</p>\n\n<pre><code>00000\n01010\n01010\n01100\n00000\n\n\ufffd\ufffd6\n01010\n01010\n01100\n00000\n</code></pre>\n\n<p>If I comment <code>ACM[i] = (char*)malloc(sizeof(char)*columns);</code> it works with no no problem. I even used GDB to see what was going on and I got this :</p>\n\n<pre><code>23          ACM[i] = (char*)malloc(sizeof(char)*columns);\n2: CM[0][0] = 48 '0'\n3: CM[1][1] = 49 '1'\n4: i = 4\n(gdb) \n24          fscanf(file, \"%s\", CM[i]);\n2: CM[0][0] = -80 '\\260'\n3: CM[1][1] = 49 '1'\n4: i = 4\n</code></pre>\n\n<p>Please, could someone tell me what's going on with my code?</p>\n"}, {"tags": ["python", "c", "numpy"], "comments": [{"owner": {"reputation": 117275, "user_id": 5393381, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/308ffa6266fda6d94bc56fbd9e9798f9?s=128&d=identicon&r=PG&f=1", "display_name": "MSeifert", "link": "https://stackoverflow.com/users/5393381/mseifert"}, "edited": false, "score": 2, "creation_date": 1516225546, "post_id": 48310452, "comment_id": 83606742, "body": "Could you add the (minimized) code that &quot;creates the numpy array of strings in a C extension module&quot; and gives you the wrong result?"}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1516230385, "post_id": 48310452, "comment_id": 83608739, "body": "This looks like C++ code, it would be better if you replace the <code>c</code> tag of your question with the <code>c++</code> tag. Then your question will appear in the correct filter."}, {"owner": {"reputation": 117275, "user_id": 5393381, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/308ffa6266fda6d94bc56fbd9e9798f9?s=128&d=identicon&r=PG&f=1", "display_name": "MSeifert", "link": "https://stackoverflow.com/users/5393381/mseifert"}, "edited": false, "score": 1, "creation_date": 1516233408, "post_id": 48310452, "comment_id": 83609585, "body": "sorry, but that&#39;s not some code that can be executed without having your GrowingBuffer. Could you include a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>?"}], "owner": {"reputation": 833, "user_id": 3812403, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/0963dc953188cca0374d4fa3436748ab?s=128&d=identicon&r=PG&f=1", "display_name": "ByteMe95", "link": "https://stackoverflow.com/users/3812403/byteme95"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 553, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1516287814, "creation_date": 1516225283, "last_edit_date": 1516287814, "question_id": 48310452, "link": "https://stackoverflow.com/questions/48310452/how-to-properly-create-numpy-string-arrays-using-the-numpy-c-api", "title": "How to properly create numpy string arrays using the NumPY C API", "body": "<p>I'm trying to create a numpy array of strings in a C extension module.  I cant tell what im doing wrong, I've tried various things at this point.  My main issue is that im creating a fixed-size string type array, where the fixed size is effectively the max size but the strings are null-terminated c strings.\nThe problem is that when I print out the array ive returned, it prints the entire fixed length rather than respecting the null terminator, ie:</p>\n\n<blockquote>\n  <p>b'PZYJKT\\x00A\\x04' b'PZYJKBT\\x00\\x04' b'PZYJKBT\\x00\\x04'</p>\n</blockquote>\n\n<p>rather than</p>\n\n<blockquote>\n  <p>b'PZYJKT' b'PZYJKBT' b'PZYJKBT'</p>\n</blockquote>\n\n<p>I set the dtype in this example = \"S13\".  If I do the same thing in native python, everything works fine:</p>\n\n<pre><code>&gt;&gt;&gt; import numpy as np\n&gt;&gt;&gt; np.array( [ 'PZYJKT', 'PZYJKBT', 'PZYJKBT' ], dtype = 'S13' )\narray([b'PZYJKT', b'PZYJKBT', b'PZYJKBT'], dtype='|S13')\n</code></pre>\n\n<p>even though internally it seems to be represented just like my string array:</p>\n\n<pre><code>&gt;&gt;&gt; _.tobytes()\nb'PZYJKT\\x00\\x00\\x00\\x00\\x00\\x00\\x00PZYJKBT\\x00\\x00\\x00\\x00\\x00\\x00PZYJKBT\\x00\\x00\\x00\\x00\\x00\\x00'\n</code></pre>\n\n<p>The only thing I just noticed is that if i zero init the entire fixed string, then it seems to work similar to python.   Could it be that numpy looks at the entire string for the <em>last</em> null-terminator?</p>\n\n<p>EDIT: Code im using to create the array:</p>\n\n<pre><code>template&lt;size_t N&gt;\nPyObject * as_nparray( char * data )\n{\n    npy_intp dims[1]{ ( npy_intp ) buffer.size() };\n\n    bp::str date_type = ( \"S\"s + std::to_string( N ) ).c_str();\n    PyArray_Descr *descr;\n    PyArray_DescrConverter( date_type.ptr(), &amp;descr );\n    return PyArray_NewFromDescr( &amp;PyArray_Type, descr, 1, dims, NULL, data, NPY_ARRAY_OWNDATA, NULL );\n}\n</code></pre>\n\n<p>I'll also add that I found this post which seems to imply my suspicion that numpy strings are expected to be null <em>padded</em> rather than null terminated:\n<a href=\"https://mail.scipy.org/pipermail/numpy-discussion/2014-July/070637.html\" rel=\"nofollow noreferrer\">https://mail.scipy.org/pipermail/numpy-discussion/2014-July/070637.html</a></p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1516224550, "post_id": 48310228, "comment_id": 83606321, "body": "well, maybe that the function returns <code>NULL</code> and you&#39;re dereferencing a null pointer. Your debugger could help you"}, {"owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "edited": false, "score": 0, "creation_date": 1516224593, "post_id": 48310228, "comment_id": 83606338, "body": "<b>Or</b> you could help us by providing us with <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>?"}, {"owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "edited": false, "score": 0, "creation_date": 1516224738, "post_id": 48310228, "comment_id": 83606397, "body": "Btw C is pass by value ...so <code>items = newSLL;</code> is not doing what you are expecting"}, {"owner": {"reputation": 53, "user_id": 6047058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e56426b7f5c5d7476e06e38b4cb1f7e?s=128&d=identicon&r=PG&f=1", "display_name": "Apurva Patel", "link": "https://stackoverflow.com/users/6047058/apurva-patel"}, "edited": false, "score": 0, "creation_date": 1516224846, "post_id": 48310228, "comment_id": 83606437, "body": "so how should i rewrite that? items -&gt; value = newSLL-&gt;value; ?"}], "answers": [{"tags": [], "owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "is_accepted": true, "score": 1, "last_activity_date": 1516224837, "creation_date": 1516224837, "answer_id": 48310354, "question_id": 48310228, "link": "https://stackoverflow.com/questions/48310228/when-printing-linked-list-value-at-0-index-it-gives-segmentation-fault/48310354#48310354", "title": "When printing linked list value at 0 index it gives segmentation fault.", "body": "<p>First element is never inserted because C is pass by value. So you make changes to the local variable of that <code>insert..()</code> function.</p>\n\n<p>You should either pass the address of the pointer or return the address of the allocated memory and assign it to the pointer.</p>\n\n<p>And then again, one thing to notice is - you already allocated memory dynamically before you even called <code>insertSLL</code> - you don't need that.  The <code>insert</code> logic can be written in way that it would do that itself for the first and middle nodes both.</p>\n"}], "owner": {"reputation": 53, "user_id": 6047058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e56426b7f5c5d7476e06e38b4cb1f7e?s=128&d=identicon&r=PG&f=1", "display_name": "Apurva Patel", "link": "https://stackoverflow.com/users/6047058/apurva-patel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "accepted_answer_id": 48310354, "answer_count": 1, "score": -2, "last_activity_date": 1516224837, "creation_date": 1516224309, "question_id": 48310228, "link": "https://stackoverflow.com/questions/48310228/when-printing-linked-list-value-at-0-index-it-gives-segmentation-fault", "title": "When printing linked list value at 0 index it gives segmentation fault.", "body": "<p>// my main function </p>\n\n<pre><code>int main (void) {\nsrandom(1);\nSLL *p = newSLL(displayINTEGER,freeINTEGER);\ninsertSLL(p,0,newINTEGER(3));\ninsertSLL(p,sizeSLL(p),newINTEGER(2));\ninsertSLL(p,1,newINTEGER(22));\n\nint x = getINTEGER((INTEGER *) getSLL(p,2)); //Works fine it prints 2\nprintf (\"x is : %d\\n\",x); \n\nx = getINTEGER((INTEGER *) getSLL(p,1)); //Works fine it prints 22\nprintf (\"x is : %d\\n\",x);\n\nx = getINTEGER((INTEGER *) getSLL(p,0)); //This is where i get error (Segmentation Fault)\nprintf (\"x is : %d\\n\",x);\n</code></pre>\n\n<p>//Insert function @param SLL, index, value</p>\n\n<pre><code> void insertSLL(SLL *items,int index,void *value)\n    {\n    SLL *newSLL = malloc(sizeof(SLL));\n    newSLL-&gt;value = value;\n    if (items == NULL)\n            {\n            }\n    else if (index == 0)\n            {\n            newSLL-&gt;tail = items;\n            items = newSLL;\n            }\n    else\n            {\n            struct sll *current = items;\n            for(int i=0; i&lt;index-1; i++)\n            {\n            current = current -&gt; tail;\n            }\n            newSLL -&gt; tail = current -&gt; tail;\n            current -&gt; tail = newSLL;\n            }\n    }\n</code></pre>\n\n<p>//getSLL @param SLL and index and returns pointer to that value.\n //this function works fine with index > 0 but gives segmentation fault when index == 0</p>\n\n<pre><code>    void *getSLL(SLL *items,int index)\n    {\n    int count = 0;\n    while (items != NULL)\n    {\n            if (count == index)\n            {\n            return items-&gt;value;\n            }\n    count++;\n    items = items-&gt;tail;\n    }\n    return NULL;\n    }\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 11, "creation_date": 1516224076, "post_id": 48310164, "comment_id": 83606130, "body": "There is no anonymous structure in either of your codes."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 2, "creation_date": 1516224104, "post_id": 48310164, "comment_id": 83606138, "body": "That&#39;s an initializer list, not an anonymous structure."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1516224139, "post_id": 48310164, "comment_id": 83606157, "body": "it just means you don&#39;t have to repeat <code>obj2.</code> for every member. This becomes more valuable if you have nested structures and arrays."}, {"owner": {"reputation": 858, "user_id": 4806970, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/EO255.jpg?s=128&g=1", "display_name": "LandonZeKepitelOfGreytBritn", "link": "https://stackoverflow.com/users/4806970/landonzekepitelofgreytbritn"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1516224162, "post_id": 48310164, "comment_id": 83606165, "body": "@Barmar could you plese show en example of what an anonymous structure is? I was 100% sure this is what is called an anonymous struct..."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 4, "creation_date": 1516224231, "post_id": 48310164, "comment_id": 83606196, "body": "Your code actually shows the difference between <i>initialization</i> and <i>assignment</i>, it is analogous to asking &quot;why would I do <code>int x = 5;</code> instead of <code>int x; x = 5;</code>"}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1516224829, "post_id": 48310164, "comment_id": 83606427, "body": "maybe this will help: <a href=\"https://stackoverflow.com/questions/8932707/what-are-anonymous-structs-and-unions-useful-for-in-c11\" title=\"what are anonymous structs and unions useful for in c11\">stackoverflow.com/questions/8932707/&hellip;</a>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1516224888, "post_id": 48310164, "comment_id": 83606458, "body": "Is the post about initialization vs. assignment or what is an anonymous <code>struct</code>?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1516225075, "post_id": 48310164, "comment_id": 83606543, "body": "Anonymous structures are very convenient when you have them nested into other structs/unions. This way you don&#39;t have to type the full &quot;path&quot; to the fields."}, {"owner": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "edited": false, "score": 0, "creation_date": 1516229038, "post_id": 48310164, "comment_id": 83608227, "body": "I wonder how you ever obtained <i>the wrong idea</i>, and note that you seem to ask questions as I would consider prematurely... Could it be that the method you use to learn isn&#39;t working for you, and what you should actually be asking for is an &quot;example&quot; of a better method to learn?"}], "answers": [{"comments": [{"owner": {"reputation": 858, "user_id": 4806970, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/EO255.jpg?s=128&g=1", "display_name": "LandonZeKepitelOfGreytBritn", "link": "https://stackoverflow.com/users/4806970/landonzekepitelofgreytbritn"}, "edited": false, "score": 0, "creation_date": 1516224472, "post_id": 48310243, "comment_id": 83606289, "body": "could you plese show en example of what an anonymous structure looks like? I was 100% sure this is what is called an anonymous struct..."}], "tags": [], "owner": {"reputation": 11238, "user_id": 7594711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7872c871b0431b72df6350dd0394bea?s=128&d=identicon&r=PG&f=1", "display_name": "SoronelHaetir", "link": "https://stackoverflow.com/users/7594711/soronelhaetir"}, "is_accepted": false, "score": 0, "last_activity_date": 1516224366, "creation_date": 1516224366, "answer_id": 48310243, "question_id": 48310164, "link": "https://stackoverflow.com/questions/48310164/c-what-advantage-do-anonymous-structures-offer/48310243#48310243", "title": "C - what advantage do anonymous structures offer?", "body": "<p>That's not an anonymous struct, that is simply using designated initializers, and you use them particularly when you don't need to provide values for all the members of a complicated struct.</p>\n"}, {"comments": [{"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 165, "user_id": 9214270, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5015413cdd23101b12239a68dfffc89?s=128&d=identicon&r=PG", "display_name": "CookiePLMonster", "link": "https://stackoverflow.com/users/9214270/cookieplmonster"}, "edited": false, "score": 1, "creation_date": 1516226039, "post_id": 48310614, "comment_id": 83606952, "body": "@CookiePLMonster - C11 standardized them"}], "tags": [], "owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "is_accepted": false, "score": 1, "last_activity_date": 1516226310, "last_edit_date": 1516226310, "creation_date": 1516225972, "answer_id": 48310614, "question_id": 48310164, "link": "https://stackoverflow.com/questions/48310164/c-what-advantage-do-anonymous-structures-offer/48310614#48310614", "title": "C - what advantage do anonymous structures offer?", "body": "<p>Here's <em>one</em> use. When working with unions, it's implementation defined what you'll get when reading a union member that wasn't last written to. But, in the case of structures, you can inspect the common initial sequence of fields. Here's an example to illustrate:</p>\n\n<pre><code>#include &lt;assert.h&gt;\n\nstruct S1 {\n  int  type;\n  char value;\n};\n\nstruct S2 {\n  int   type;\n  float value;\n};\n\nunion U {\n  struct S1 s1;\n  struct S2 s2;\n};\n\nint main() {\n  union U un;\n  un.s1.type = 1;\n  un.s1.value = 'c';\n  assert(un.s2.type == 1);\n}\n</code></pre>\n\n<p>As you can see above, it is guaranteed by the C standard that whatever I write to <code>un.s1.type</code> I can then read from <code>un.s2.type</code>. So far so good. But there's a problem if I try to do something like this instead:</p>\n\n<pre><code>union U {\n  struct S1 s1;\n  int type;\n};\n</code></pre>\n\n<p>Now there is no guarantee. We can't read <code>un.s1.type</code> from <code>un.type</code> under the protection of the standard. But hope is not lost, we can just make it a field of a structure again, an anonymous structure, like so:</p>\n\n<pre><code>union U {\n  struct S1 s1;\n  struct {\n    int type;\n  };\n};\n</code></pre>\n\n<p>The fields of an anonymous structure are \"injected\" into the enclosing structure or union, so we may refer to <code>type</code> by accessing <code>un.type</code>. And now were are back to the warm embrace of the standard. Since now we again have two structures with a common initial sequence of fields.</p>\n"}, {"tags": [], "owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "is_accepted": false, "score": 2, "last_activity_date": 1516226011, "creation_date": 1516226011, "answer_id": 48310622, "question_id": 48310164, "link": "https://stackoverflow.com/questions/48310164/c-what-advantage-do-anonymous-structures-offer/48310622#48310622", "title": "C - what advantage do anonymous structures offer?", "body": "<p>An anonymous struct is useful when you want to nest structures/unions without assigning a particular \"meaning\" to the inner structures. It lets you access the members of an inner structure as if they were a direct member of the enclosing struct. See the following example taken from <a href=\"http://en.cppreference.com/w/c/language/struct\" rel=\"nofollow noreferrer\">cppreference.com</a>:</p>\n\n<blockquote>\n  <p>Similar to union, an unnamed member of a struct whose type is a struct\n  without name is known as anonymous struct. Every member of an\n  anonymous struct is considered to be a member of the enclosing struct\n  or union. This applies recursively if the enclosing struct or union is\n  also anonymous.</p>\n\n<pre><code>struct v {\n   union { // anonymous union\n      struct { int i, j; }; // anonymous structure\n      struct { long k, l; } w;\n   };\n   int m;\n} v1;\n\nv1.i = 2;   // valid\nv1.k = 3;   // invalid: inner structure is not anonymous\nv1.w.k = 5; // valid\n</code></pre>\n</blockquote>\n\n<p>The code you showed actually has nothing to do with anonymous structs. It is rather an example of using an initializer list with designated members.</p>\n\n<p>Hope it helps :-)  </p>\n"}, {"tags": [], "owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "is_accepted": false, "score": 1, "last_activity_date": 1516226695, "creation_date": 1516226695, "answer_id": 48310781, "question_id": 48310164, "link": "https://stackoverflow.com/questions/48310164/c-what-advantage-do-anonymous-structures-offer/48310781#48310781", "title": "C - what advantage do anonymous structures offer?", "body": "<p>Your example has nothing to do with anonymous structs, but only with initialization vs. assignement. It matters mainly when objects are declared const:</p>\n\n<pre><code>const  my_struct_t obj1 =\n{\n    .a = 33,\n    .b = 44\n};\n</code></pre>\n\n<p>is correct while this is not:</p>\n\n<pre><code>const my_struct_t obj2;\nobj2.a = 55;   // error: try to assign to const object\n</code></pre>\n\n<p>Anonymous structures and unions allow members of a sub struct/union to be used as if they were members of the containing sub/union.</p>\n\n<p>Draft n1570 for C11 says at 6.7.2.1 Structure and union specifiers \u00a713 says:</p>\n\n<blockquote>\n  <p>An unnamed member whose type specifier is a structure specifier with no tag is called an\n  anonymous structure; an unnamed member whose type specifier is a union specifier with\n  no tag is called an anonymous union. The members of an anonymous structure or union\n  are considered to be members of the containing structure or union. This applies\n  recursively if the containing structure or union is also anonymous.</p>\n</blockquote>\n\n<p>and even gives a (non normative) example:</p>\n\n<pre><code>struct v {\n    union { // anonymous union\n        struct { int i, j; }; // anonymous structure\n        struct { long k, l; } w;\n    };\n    int m;\n} v1;\nv1.i = 2; // valid\nv1.k = 3; // invalid: inner structure is not anonymous\nv1.w.k = 5; // valid\n</code></pre>\n"}], "owner": {"reputation": 858, "user_id": 4806970, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/EO255.jpg?s=128&g=1", "display_name": "LandonZeKepitelOfGreytBritn", "link": "https://stackoverflow.com/users/4806970/landonzekepitelofgreytbritn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 135, "favorite_count": 0, "answer_count": 4, "score": -1, "last_activity_date": 1516226695, "creation_date": 1516223997, "question_id": 48310164, "link": "https://stackoverflow.com/questions/48310164/c-what-advantage-do-anonymous-structures-offer", "title": "C - what advantage do anonymous structures offer?", "body": "<p>I would like to know why and when one would explicitly choose to use an anonymous structure like so:</p>\n\n<pre><code>typedef struct my_struct_t my_struct_t;\n\nstruct my_struct_t\n{\n    int a;\n    int b;\n};\n\nint main()\n{   \n\n    my_struct_t obj1 =\n    {\n        .a = 33,\n        .b = 44\n    };\n\n    return 0; \n}\n</code></pre>\n\n<p>rather than doing:</p>\n\n<pre><code>typedef struct my_struct_t my_struct_t;\n\nstruct my_struct_t\n{\n    int a;\n    int b;\n};\n\nint main()\n{   \n\n    my_struct_t obj2;\n    obj2.a = 55;\n    obj2.b = 66;\n\n    return 0; \n}\n</code></pre>\n\n<p>What advantages does the former offer over the latter and/or vice-verca?\nthanks</p>\n"}, {"tags": ["c", "linux", "sockets", "ipv6"], "comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1516224274, "post_id": 48310068, "comment_id": 83606213, "body": "By an &quot;empty&quot; flow label, do you mean one with all bits 0?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1516224722, "post_id": 48310068, "comment_id": 83606387, "body": "And when you say &quot;not set by the user&quot; do you mean &quot;specified as zero by the user&quot;?"}, {"owner": {"reputation": 35, "user_id": 3835407, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0915016d72279b1935d67fa80f8b8b49?s=128&d=identicon&r=PG", "display_name": "Morichika Maho", "link": "https://stackoverflow.com/users/3835407/morichika-maho"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1516224856, "post_id": 48310068, "comment_id": 83606445, "body": "@john-bollinger not set by the user mean the user did not specify anything, and yes, by empty I mean all bits are 0."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1516225436, "post_id": 48310068, "comment_id": 83606693, "body": "To the best of my knowledge, the user cannot <i>fail</i> to set a flow label on an IPv6 socket when they <code>connect()</code> or <code>bind()</code> it.  It is part of <code>struct sockaddr_in6</code> (member <code>sin6_flowinfo</code>), an instance of which must be provided to both those interfaces.  Is your problem perhaps that you do not initialize this member?  Or how else should I interpret &quot;did not specify anything&quot;?"}, {"owner": {"reputation": 35, "user_id": 3835407, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0915016d72279b1935d67fa80f8b8b49?s=128&d=identicon&r=PG", "display_name": "Morichika Maho", "link": "https://stackoverflow.com/users/3835407/morichika-maho"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1516226555, "post_id": 48310068, "comment_id": 83607177, "body": "I did initialize it. For &quot;did not specify anything&quot; I mean user did not use <code>IPV6_FLOWLABEL_MGR</code> to set a label."}, {"owner": {"reputation": 4989, "user_id": 3745413, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jQsNL.png?s=128&g=1", "display_name": "Ron Maupin", "link": "https://stackoverflow.com/users/3745413/ron-maupin"}, "edited": false, "score": 1, "creation_date": 1516226707, "post_id": 48310068, "comment_id": 83607251, "body": "&quot;<i>I need IPv6 flow label to be empty.</i>&quot; Why?"}, {"owner": {"reputation": 35, "user_id": 3835407, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0915016d72279b1935d67fa80f8b8b49?s=128&d=identicon&r=PG", "display_name": "Morichika Maho", "link": "https://stackoverflow.com/users/3835407/morichika-maho"}, "edited": false, "score": 0, "creation_date": 1516227218, "post_id": 48310068, "comment_id": 83607493, "body": "I&#39;m trying the implement MikroTik&#39;s EoIPv6 tunnel. Somehow MikroTik seems to be discarding incoming EoIPv6 packet with a non-zero flow label."}, {"owner": {"reputation": 35, "user_id": 3835407, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0915016d72279b1935d67fa80f8b8b49?s=128&d=identicon&r=PG", "display_name": "Morichika Maho", "link": "https://stackoverflow.com/users/3835407/morichika-maho"}, "edited": false, "score": 0, "creation_date": 1516228252, "post_id": 48310068, "comment_id": 83607908, "body": "I managed to get it work by setting <code>IPV6_HDRINCL</code> and build the IPv6 packet including header myself."}], "answers": [{"tags": [], "owner": {"reputation": 2156, "user_id": 939955, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ea57a2497b6aa276b753571a901a7d0?s=128&d=identicon&r=PG", "display_name": "lgekman", "link": "https://stackoverflow.com/users/939955/lgekman"}, "is_accepted": false, "score": 4, "last_activity_date": 1523300322, "last_edit_date": 1523300322, "creation_date": 1523295919, "answer_id": 49738727, "question_id": 48310068, "link": "https://stackoverflow.com/questions/48310068/linux-c-ipv6-raw-socket-tell-socket-not-to-assign-a-flow-label/49738727#49738727", "title": "Linux C IPv6 raw socket - tell socket NOT to assign a flow label", "body": "<p>See the <a href=\"https://www.kernel.org/doc/Documentation/networking/ip-sysctl.txt\" rel=\"nofollow noreferrer\">sysctl</a>:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>/proc/sys/net/ipv6/auto_flowlabels - INTEGER\n    Automatically generate flow labels based on a flow hash of the\n    packet. This allows intermediate devices, such as routers, to\n    identify packet flows for mechanisms like Equal Cost Multipath\n    Routing (see RFC 6438).\n    0: automatic flow labels are completely disabled\n    1: automatic flow labels are enabled by default, they can be\n       disabled on a per socket basis using the IPV6_AUTOFLOWLABEL\n       socket option\n    2: automatic flow labels are allowed, they may be enabled on a\n       per socket basis using the IPV6_AUTOFLOWLABEL socket option\n    3: automatic flow labels are enabled and enforced, they cannot\n       be disabled by the socket option\n    Default: 1\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 3835407, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0915016d72279b1935d67fa80f8b8b49?s=128&d=identicon&r=PG", "display_name": "Morichika Maho", "link": "https://stackoverflow.com/users/3835407/morichika-maho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 651, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1523300322, "creation_date": 1516223568, "question_id": 48310068, "link": "https://stackoverflow.com/questions/48310068/linux-c-ipv6-raw-socket-tell-socket-not-to-assign-a-flow-label", "title": "Linux C IPv6 raw socket - tell socket NOT to assign a flow label", "body": "<p>I was trying to send something using an IPv6 raw socket. For some reason, I need IPv6 flow label to be empty. Linux seems to be assigning random flow label when it is not set by the user.</p>\n\n<p>What I found is <code>IPV6_FLOWLABEL_MGR</code> and <code>IPV6_FLOWINFO_SEND</code>. I was able to assign a label myself using <code>IPV6_FLOWLABEL_MGR</code> with a <code>in6_flowlabel_req</code> by setting <code>IPV6_FLOWINFO_SEND</code> to true. </p>\n\n<p>However, I can't find the option to disable the automatic assign behavior. I tried setting the label to 0 manually - but Linux assigned a new label to it when user set the label to 0.</p>\n\n<p>Am I missing something?</p>\n"}, {"tags": ["c", "hashmap", "clang"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1516222802, "post_id": 48309721, "comment_id": 83605501, "body": "Note: <code>if (ll == NULL) {     return -1;     }</code> not needed in <code>get_element()</code>."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1516223070, "post_id": 48309721, "comment_id": 83605632, "body": "Tip concerning <code>#define N (1000)</code>.  Use <code>#define N 997u</code>.  A good hash function is good regardless of <code>N</code>, yet a weaker hash function typically benefits with a mod by a prime number."}], "answers": [{"comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1516222505, "post_id": 48309808, "comment_id": 83605353, "body": "... and fix the loop that ends at a null dereference on collision-search exhaustion."}, {"owner": {"reputation": 386, "user_id": 1536235, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/ye5mV.jpg?s=128&g=1", "display_name": "blasrodri", "link": "https://stackoverflow.com/users/1536235/blasrodri"}, "reply_to_user": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1516222603, "post_id": 48309808, "comment_id": 83605403, "body": "@WhozCraig I a not sure I follow. Can you elaborate, please?"}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "reply_to_user": {"reputation": 386, "user_id": 1536235, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/ye5mV.jpg?s=128&g=1", "display_name": "blasrodri", "link": "https://stackoverflow.com/users/1536235/blasrodri"}, "edited": false, "score": 1, "creation_date": 1516222680, "post_id": 48309808, "comment_id": 83605437, "body": "@Blas Suppose you fix the code that stores the entry. Now suppose you have a collision on a new insertion, and determine the keys do NOT match, you&#39;ll walk the list to the end, where <code>ll</code> becomes NULL, then proceed to do <code>ll-&gt;key = ...</code> etc That&#39;s <i>undefined behavior</i>."}, {"owner": {"reputation": 386, "user_id": 1536235, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/ye5mV.jpg?s=128&g=1", "display_name": "blasrodri", "link": "https://stackoverflow.com/users/1536235/blasrodri"}, "reply_to_user": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1516222881, "post_id": 48309808, "comment_id": 83605535, "body": "@WhozCraig If there&#39;s a collision, I am missing further allocation, right? And I don&#39;t understand how it is that I am not storing the entry. Isn&#39;t <code>ll-&gt;value = value;</code> doing it?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 386, "user_id": 1536235, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/ye5mV.jpg?s=128&g=1", "display_name": "blasrodri", "link": "https://stackoverflow.com/users/1536235/blasrodri"}, "edited": false, "score": 3, "creation_date": 1516223190, "post_id": 48309808, "comment_id": 83605696, "body": "@Blas When code attempts <code>ll-&gt;value = value;</code>, <code>ll</code> is a <i>null pointer</i>."}], "tags": [], "owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "is_accepted": true, "score": 2, "last_activity_date": 1516223846, "last_edit_date": 1516223846, "creation_date": 1516222353, "answer_id": 48309808, "question_id": 48309721, "link": "https://stackoverflow.com/questions/48309721/whats-wrong-with-this-mini-hashmap/48309808#48309808", "title": "What&#39;s wrong with this mini HashMap?", "body": "<p>Well the primary problem is that you never inserted anything, You got prepared , allocated and then assigned to appropriate members and then you simply returned from the function. </p>\n\n<p>Assign the allocated memory to <code>hashmap</code>s <code>data</code>.(<code>hm-&gt;data[hk] = ll</code>). Also check the return value of <code>malloc</code>.</p>\n\n<p>Also the second loop is quite misleading in that - you end up with <code>NULL</code> in <code>ll</code> and then you dereference it. You should allocate and do the same thing as you did before. </p>\n\n<pre><code>   for (; ll != NULL; ll = ll-&gt;next){\n    if (strcmp(ll-&gt;key, key) == 0){\n        // already exists\n        ll-&gt;value = value;\n        return;\n    }\n    }\n    // if the ll is NULL (in case it doesn't match) \n    // the you wil dereference NULL leading to UB.\n    // new element, same hash key\n    ll-&gt;key = key;\n    ll-&gt;value = value;\n    ll-&gt;next = NULL;\n</code></pre>\n\n<p>Dereferencing the <code>NULL</code> value is Undefined behavior. Here the probable solution would be to allocate memory for this new node and then assign it to a slot in hashmap.</p>\n\n<p>From <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.5.3.2p4\" rel=\"nofollow noreferrer\">standard 6.5.3.2p4</a> </p>\n\n<blockquote>\n  <p>The unary * operator denotes indirection. If the operand points to a\n  function, the result is a function designator; if it points to an\n  object, the result is an lvalue designating the object. If the operand\n  has type ''pointer to type'', the result has type ''type''. <strong>If an\n  invalid value has been assigned to the pointer, the behavior of the\n  unary * operator is undefined</strong>.</p>\n</blockquote>\n\n<p>On footnote</p>\n\n<blockquote>\n  <p>Among the <strong>invalid values for dereferencing a pointer by the unary <code>*</code>\n  operator are a null pointer</strong>, an address inappropriately aligned for\n  the type of object pointed to, and the address of an object after the\n  end of its lifetime.</p>\n</blockquote>\n"}], "owner": {"reputation": 386, "user_id": 1536235, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/ye5mV.jpg?s=128&g=1", "display_name": "blasrodri", "link": "https://stackoverflow.com/users/1536235/blasrodri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 48309808, "answer_count": 1, "score": 0, "last_activity_date": 1516223846, "creation_date": 1516221997, "last_edit_date": 1516222459, "question_id": 48309721, "link": "https://stackoverflow.com/questions/48309721/whats-wrong-with-this-mini-hashmap", "title": "What&#39;s wrong with this mini HashMap?", "body": "<p>I am trying to implement a simple HashMap with only <code>new</code> <code>get</code> and <code>insert</code> functionalities.\nThere's a very simple test function which is currently not passing.</p>\n\n<p>The output:</p>\n\n<pre><code>test: Assertion `el == -10' failed.\n</code></pre>\n\n<p>When debugging the test, I get:</p>\n\n<pre><code>key: hhh value: 300\nkey: aba value: 300\n</code></pre>\n\n<p>When it shuold be:</p>\n\n<pre><code>key: hhh value: 10\nkey: aba value: -10\n</code></pre>\n\n<p>The code:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n#include&lt;string.h&gt;\n\n#include&lt;assert.h&gt;\n\n#define N (1000)\n#define MULTIPLIER (37)\n\ntypedef struct Node {\n    char* key;\n    int value;\n    struct Node* next;\n} Node;\n\ntypedef struct HashMap {\n    Node* data[N];\n} HashMap;\n\nvoid test();\n\nunsigned long hash(const char* key);\nHashMap* new_hash_map();\nvoid insert_element(char* key, int value, HashMap* hm);\nint get_element(char* key, HashMap* hm, int* el);\n\nunsigned long hash (const char* s)\n{\n    unsigned long h;\n    unsigned const char* us;\n\n    us = (unsigned const char*) s;\n\n    h = 0;\n    while (*us != '\\0'){\n    h = h * MULTIPLIER + *us;\n    us++;\n    }\n    return h % N;\n}\n\nHashMap* new_hash_map()\n{\n    HashMap* hm = malloc(sizeof(HashMap));\n    for (int i = 0; i &lt; N; i++){\n    hm-&gt;data[i] = NULL;\n    }\n    return hm;\n}\nvoid insert_element(char* key, int value, HashMap* hm)\n{\n    unsigned long hk = hash(key);\n    Node* ll = hm-&gt;data[hk];\n    if (ll == NULL) {\n    ll = malloc(sizeof(Node));\n    ll-&gt;key = key;\n    ll-&gt;value = value;\n    ll-&gt;next = NULL;\n    return;\n    }\n    for (; ll != NULL; ll = ll-&gt;next){\n    if (strcmp(ll-&gt;key, key) == 0){\n        // already exists\n        ll-&gt;value = value;\n        return;\n    }\n    }\n    // new element, same hash key\n    ll-&gt;key = key;\n    ll-&gt;value = value;\n    ll-&gt;next = NULL;\n}\n\nint get_element(char* key, HashMap* hm, int* el)\n{\n    unsigned long hk = hash(key);\n    Node* ll = hm-&gt;data[hk];\n    if (ll == NULL) {\n    return -1;\n    }\n    for (; ll != NULL; ll = ll-&gt;next){\n    if (strcmp(ll-&gt;key, key) == 0){\n        // already exists\n        *el = ll-&gt;value;\n        return 1;\n    }\n    }\n    return -1;\n}\n\nvoid test()\n{\n    HashMap* hm = new_hash_map();\n    int el;\n    insert_element(\"aba\", 10, hm);\n    insert_element(\"hhhh\", -10, hm);\n    get_element(\"hhhh\", hm, &amp;el);\n    assert(el == -10);\n    get_element(\"aba\", hm, &amp;el);\n    assert(el == 10);\n}\n\nint main () {\n    test();\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "pointers"], "answers": [{"tags": [], "owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "is_accepted": false, "score": 1, "last_activity_date": 1516221760, "last_edit_date": 1516221760, "creation_date": 1516221691, "answer_id": 48309652, "question_id": 48309614, "link": "https://stackoverflow.com/questions/48309614/how-to-rewrite-this-code-to-pointers-in-c/48309652#48309652", "title": "How to rewrite this code to pointers in C", "body": "<p><code>scanf(\"%d\", &amp;r[k]);</code> will be <code>scanf(\"%d\", r+k);</code></p>\n\n<p><code>scanf(\"%d\", &amp;p[i][j]);</code> will be <code>scanf(\"%d\", *(p + i) + j )</code>\nand</p>\n\n<p><code>r[k] = p[i][j];</code>  is <code>*(r+k) = *(*(p+i)+j)</code></p>\n\n<p><code>*r = *p</code> This is wrong. If you have a compiler try to compile this you will understand where you were wrong. You will have type mismatch.</p>\n\n<p><code>r</code> decays into pointer to first element. So </p>\n\n<p><code>*r = *p</code> will try to assign an <code>int[]</code> to <code>int</code>. </p>\n"}, {"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": true, "score": 2, "last_activity_date": 1516222424, "last_edit_date": 1516222424, "creation_date": 1516221884, "answer_id": 48309691, "question_id": 48309614, "link": "https://stackoverflow.com/questions/48309614/how-to-rewrite-this-code-to-pointers-in-c/48309691#48309691", "title": "How to rewrite this code to pointers in C", "body": "<p>It seems you mean the following</p>\n\n<pre><code>r[k] = p[i][j];  -----&gt; *( r + k ) = *( *( p + i ) + j )\n\nscanf(\"%d\", &amp;r[k]);   ------&gt; scanf (\"%d\", r + k )\n\nscanf(\"%d\", &amp;p[i][j]); ----&gt; scanf ( \"%d\", *(p + i) + j )\n</code></pre>\n\n<p>Here is a demonstrative program</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#define N   2\n\nint main(void) \n{\n    int r[N];\n    int p[N][N] =\n    {\n        { 1, 2 },\n        { 3, 4 }\n    };\n\n    size_t k = 1;\n    size_t i = 1, j = 1;\n\n    *( r + k ) = *( *( p + i ) + j );\n\n    printf( \"r[%zu] = %d\\n\", k, r[k] );\n\n    scanf ( \"%d\", r + k );      //  Enter 10\n\n    printf( \"r[%zu] = %d\\n\", k, r[k] );\n\n    scanf ( \"%d\", *(p + i) + j );   //  Enter 20\n\n    printf( \"p[%zu][%zu] = %d\\n\", i, j, p[i][j] );\n\n    return 0;\n}\n</code></pre>\n\n<p>Its output is</p>\n\n<pre><code>r[1] = 4\nr[1] = 10\np[1][1] = 20\n</code></pre>\n\n<p>Pay attention to the following quote form the C Standard (6.5.2.1 Array subscripting)</p>\n\n<blockquote>\n  <p>2 A postfix expression followed by an expression in square brackets []\n  is a subscripted designation of an element of an array object. The\n  definition of the subscript operator [] is that E1[E2] is identical to\n  (*((E1)+(E2))). Because of the conversion rules that apply to the\n  binary + operator, if E1 is an array object (equivalently, a pointer\n  to the initial element of an array object) and E2 is an integer,\n  E1[E2] designates the E2-th element of E1 (counting from zero).</p>\n</blockquote>\n"}], "owner": {"reputation": 9, "user_id": 9231708, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59ff75d2e0cd9ad255219c55453b99d5?s=128&d=identicon&r=PG&f=1", "display_name": "Copen", "link": "https://stackoverflow.com/users/9231708/copen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 48309691, "answer_count": 2, "score": -5, "last_activity_date": 1516222424, "creation_date": 1516221484, "question_id": 48309614, "link": "https://stackoverflow.com/questions/48309614/how-to-rewrite-this-code-to-pointers-in-c", "title": "How to rewrite this code to pointers in C", "body": "<p>i need to rewrite this code to pointers (use pointers (without index), instead of that code).</p>\n\n<pre><code>r[k] = p[i][j];  -----&gt; *r = *p\n\nscanf(\"%d\", &amp;r[k]);   ------&gt; scanf (\"%s\",r )\n\nscanf(\"%d\", &amp;p[i][j]); ----&gt; scanf (( *(x + i) + j ))\n</code></pre>\n\n<p>Is this good rewriten?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["c++", "c", "linux", "networking", "multicast"], "comments": [{"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1516230678, "post_id": 48309329, "comment_id": 83608837, "body": "You have iterate over the interfaces issuing a JOIN via each interface in turn in a multi homed host."}, {"owner": {"reputation": 13, "user_id": 7770351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fac2d2a1bdf41af4394a5aa29cfa73ba?s=128&d=identicon&r=PG&f=1", "display_name": "duick", "link": "https://stackoverflow.com/users/7770351/duick"}, "reply_to_user": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1516737089, "post_id": 48309329, "comment_id": 83808976, "body": "@EJP thanks for the pointer.  This solved my problem!"}], "answers": [{"comments": [{"owner": {"reputation": 1432, "user_id": 214756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d98bd414e82a350321fc5cf7b1cd44c?s=128&d=identicon&r=PG", "display_name": "Mike B", "link": "https://stackoverflow.com/users/214756/mike-b"}, "edited": false, "score": 0, "creation_date": 1525266448, "post_id": 48399108, "comment_id": 87288772, "body": "Thank you! I have the same DM9601 adapter and this change has fixed the issue where the pi failed to respond to mDNS lookups."}], "tags": [], "owner": {"reputation": 11, "user_id": 4190708, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa45b0e07172bfa8a3ec8fc6581839ba?s=128&d=identicon&r=PG&f=1", "display_name": "mhp", "link": "https://stackoverflow.com/users/4190708/mhp"}, "is_accepted": false, "score": 1, "last_activity_date": 1516702362, "creation_date": 1516702362, "answer_id": 48399108, "question_id": 48309329, "link": "https://stackoverflow.com/questions/48309329/receiving-multicast-on-linux-host-with-multiple-interfaces/48399108#48399108", "title": "Receiving multicast on linux host with multiple interfaces", "body": "<p>I found a similar problem (Raspberry Pi Zero with USB-to-Ethernet adaptor, fails to respond to mDNS queries).  To work out if your problem is the same, does does your app correctly receive multicast traffic whilst running tcpdump at the same time?  And does running tcpdump with <code>--no-promiscuous-mode</code> not see multicast traffic?</p>\n\n<p>If your answer is yes to both, then the workaround I've found is simply <code>ip link set eth0 promisc on</code>.  I don't know if it is a hardware bug (I'm using a Kontron DM9601 adaptor, ID 0FE6:9700) or a driver bug, but either way, enabling promiscuous mode seems to fix multicast reception for me.  Alternatively you could try a better USB-to-ethernet adaptor.</p>\n"}, {"tags": [], "owner": {"reputation": 13, "user_id": 7770351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fac2d2a1bdf41af4394a5aa29cfa73ba?s=128&d=identicon&r=PG&f=1", "display_name": "duick", "link": "https://stackoverflow.com/users/7770351/duick"}, "is_accepted": true, "score": 0, "last_activity_date": 1516737186, "last_edit_date": 1516737186, "creation_date": 1516736470, "answer_id": 48409584, "question_id": 48309329, "link": "https://stackoverflow.com/questions/48309329/receiving-multicast-on-linux-host-with-multiple-interfaces/48409584#48409584", "title": "Receiving multicast on linux host with multiple interfaces", "body": "<p>The <code>ip_mreq</code> stucture is passed as the option value for the <code>IP_ADD_MEMBERSHIP</code> socket option to join a multicast group.  From the <a href=\"http://www.tldp.org/HOWTO/Multicast-HOWTO-6.html#ss6.4\" rel=\"nofollow noreferrer\">Multicast programming HOWTO</a> from the The Linux Documentation Project:</p>\n\n<blockquote>\n  <p>The first member, <code>imr_multiaddr</code>, holds the group address you want to join. Remember that memberships are also associated with interfaces, not just groups. This is the reason you have to provide a value for the second member: <code>imr_interface</code>. This way, if you are in a multihomed host, you can join the same group in several interfaces. You can always fill this last member with the wildcard address (<code>INADDR_ANY</code>) and then the kernel will deal with the task of choosing the interface.</p>\n</blockquote>\n\n<p>The <code>IP_MULTICAT_IF</code> socket option is also relevant on a multihomed host to set the outbound interface for multicast data sent via the socket.  More information on these socket options, the <code>ip_mreq</code> structure, and the newer <code>ip_mreqn</code> stucture is found <a href=\"http://man7.org/linux/man-pages/man7/ip.7.html\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>For those using Boost on a multihomed host, you will need to use the native handle to join the group on specific interfaces.  As of Boost 1.58 running on Ubuntu 16.04, the socket option abstraction <code>ip::multiast::join_group()</code> joins the group on an interface of the kernel's choosing and does not allow the developer to specify an interface.  The socket option abstraction <code>ip::multicast::outbound_interface()</code> controls the outbound interface but does not affect which interface the socket receives on.</p>\n\n<p>Here is a code sample to join a group on a specific interface based on the local interface IP address:</p>\n\n<pre><code>struct ip_mreq mreq;\nmreq.imr_multiaddr.s_addr = inet_addr(discovery_ip);\nmreq.imr_interface.s_addr = inet_addr(local_interface_ip);\nif(setsockopt(socket_.native_handle(), IPPROTO_IP, IP_ADD_MEMBERSHIP, &amp;mreq, sizeof(mreq))) {\n    ... handle error ...\n}\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 7770351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fac2d2a1bdf41af4394a5aa29cfa73ba?s=128&d=identicon&r=PG&f=1", "display_name": "duick", "link": "https://stackoverflow.com/users/7770351/duick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1850, "favorite_count": 0, "accepted_answer_id": 48409584, "answer_count": 2, "score": 0, "last_activity_date": 1516737186, "creation_date": 1516220326, "last_edit_date": 1516736958, "question_id": 48309329, "link": "https://stackoverflow.com/questions/48309329/receiving-multicast-on-linux-host-with-multiple-interfaces", "title": "Receiving multicast on linux host with multiple interfaces", "body": "<p>I have a host running Ubuntu 16.04 connected to one network via the primary wired network interface, and to another network via a USB-to-Ethernet adapter. Using <code>tcpdump</code>, I am able to verify incoming multicast packets on both network interfaces.  However, my application does not receive any multicast data from the secondary interface.  If I disconnect the cable to the primary interface, and then restart my application, then I do receive the data from the secondary interface.  It is only with both interfaces connected that the application does not receive from the secondary interface.</p>\n"}, {"tags": ["c", "memcpy"], "comments": [{"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 5, "creation_date": 1516219619, "post_id": 48309157, "comment_id": 83603857, "body": "use <code>memmove</code> when the buffers overlap"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1516219791, "post_id": 48309157, "comment_id": 83603942, "body": "BTW, such a question is usually resolved <i>much faster</i> by looking at <code>man memcpy</code>."}, {"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 0, "creation_date": 1516220399, "post_id": 48309157, "comment_id": 83604259, "body": "The <a href=\"https://linux.die.net/man/3/memcpy\" rel=\"nofollow noreferrer\">manual page</a> for <code>memcpy</code> states very clearly: <i>The <code>memcpy()</code> function copies <code>n</code> bytes from memory area <code>src</code> to memory area <code>dest</code>. <b>The memory areas must not overlap.</b> Use <code>memmove(3)</code> if the memory areas do overlap.</i> That&#39;s actually the complete description given for the function."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1516221595, "post_id": 48309157, "comment_id": 83604871, "body": "In terms of speed, the &quot;everytime something gets read the data behind will be moved to the front.&quot; sounds like that is the true performance issue.  It certainly sounds like the wrong design choice.  I suggest re-examining the design, rather than concerns about micro-optimization of <code>memcpy()</code>,  <code>memmove()</code>, vs. crafted code."}, {"owner": {"reputation": 3975, "user_id": 3560981, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/8fa10e8d564dd93ece697b0aebe689dd?s=128&d=identicon&r=PG&f=1", "display_name": "Nidhoegger", "link": "https://stackoverflow.com/users/3560981/nidhoegger"}, "edited": false, "score": 0, "creation_date": 1516221633, "post_id": 48309157, "comment_id": 83604894, "body": "Speed does not matter that much in my case"}], "answers": [{"tags": [], "owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "is_accepted": false, "score": 1, "last_activity_date": 1516220015, "last_edit_date": 1516220015, "creation_date": 1516219706, "answer_id": 48309203, "question_id": 48309157, "link": "https://stackoverflow.com/questions/48309157/move-data-in-an-array-will-overwrite-data/48309203#48309203", "title": "Move data in an array will overwrite data?", "body": "<blockquote>\n  <p>Is this a \"good practice\"?</p>\n</blockquote>\n\n<p>It's undefined behavior, so don't do it.</p>\n\n<p>Use <a href=\"http://man7.org/linux/man-pages/man3/memmove.3.html\" rel=\"nofollow noreferrer\"><code>memmove()</code></a> which is designed specifically for this.</p>\n\n<blockquote>\n  <p><strong>DESCRIPTION</strong></p>\n  \n  <p>The <em>memmove()</em> function copies n bytes from memory area src to memory\n     area dest.  The memory areas may overlap: copying takes place as\n     though the bytes in src are first copied into a temporary array that\n     does not overlap src or dest, and the bytes are then copied from the\n     temporary array to dest.</p>\n</blockquote>\n\n<p>The following paragraph, taken from <a href=\"http://man7.org/linux/man-pages/man3/memcpy.3.html\" rel=\"nofollow noreferrer\">memcpy()</a>'s manual page clearly states that both POSIX and the C standard <em>are explicit</em> in that it's udnefined behavior to use <code>memcpy()</code> with overlapping areas.</p>\n\n<blockquote>\n  <p><strong>NOTES</strong></p>\n  \n  <p>Failure to observe the requirement that the memory areas do not\n     overlap has been the source of significant bugs. (<strong>POSIX and the C\n     standards are explicit that employing <em>memcpy()</em> with overlapping areas\n     produces undefined behavior.</strong>)  Most notably, in glibc 2.13 a\n     performance optimization of <em>memcpy()</em> on some platforms (including\n     x86-64) included changing the order in which bytes were copied from\n     src to dest.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "is_accepted": false, "score": 1, "last_activity_date": 1516219759, "creation_date": 1516219759, "answer_id": 48309221, "question_id": 48309157, "link": "https://stackoverflow.com/questions/48309157/move-data-in-an-array-will-overwrite-data/48309221#48309221", "title": "Move data in an array will overwrite data?", "body": "<p><code>memcpy</code> is the wrong function for this task:</p>\n\n<blockquote>\n  <p><em>man memcpy</em>, <em>man memmove</em></p>\n\n<pre><code>#include &lt;string.h&gt;\n\nvoid *memcpy(void *dest, const void *src, size_t n);\nvoid *memmove(void *dest, const void *src, size_t n);\n</code></pre>\n  \n  <p>The  <code>memcpy()</code>  function copies <code>n</code> bytes from memory area <code>src</code> to memory area <code>dest</code>.\n  <strong>The memory areas must not overlap</strong>.  Use <code>memmove(3)</code> if the memory areas do overlap.</p>\n  \n  <p>The  <code>memmove()</code> function copies <code>n</code> bytes from memory area <code>src</code> to memory area <code>dest</code>.\n  <strong>The memory areas may overlap</strong>: copying takes place as though the bytes in <code>src</code> are\n  first copied into a temporary array that does not overlap <code>src</code> or <code>dest</code>, and the bytes\n  are then  copied  from the temporary array to <code>dest</code>.</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 3975, "user_id": 3560981, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/8fa10e8d564dd93ece697b0aebe689dd?s=128&d=identicon&r=PG&f=1", "display_name": "Nidhoegger", "link": "https://stackoverflow.com/users/3560981/nidhoegger"}, "edited": false, "score": 0, "creation_date": 1516219899, "post_id": 48309232, "comment_id": 83603988, "body": "Wont that cause the memory fragmentation?"}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "reply_to_user": {"reputation": 3975, "user_id": 3560981, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/8fa10e8d564dd93ece697b0aebe689dd?s=128&d=identicon&r=PG&f=1", "display_name": "Nidhoegger", "link": "https://stackoverflow.com/users/3560981/nidhoegger"}, "edited": false, "score": 0, "creation_date": 1516220010, "post_id": 48309232, "comment_id": 83604035, "body": "No, there&#39;s just a temporary buffer used to prevent overwriting data that has yet to be copied.  The memory still gets copied to the same place in the end."}, {"owner": {"reputation": 3975, "user_id": 3560981, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/8fa10e8d564dd93ece697b0aebe689dd?s=128&d=identicon&r=PG&f=1", "display_name": "Nidhoegger", "link": "https://stackoverflow.com/users/3560981/nidhoegger"}, "edited": false, "score": 0, "creation_date": 1516220093, "post_id": 48309232, "comment_id": 83604070, "body": "yes, but I work on a Controller with 2k of ram. What happens e.g. if my buffer is 128bytes and no temp array with 128 bytes can be allocated as temporary array? Would it not be better in this case to write a function that will copy bytewise in the overlapping area?"}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "reply_to_user": {"reputation": 3975, "user_id": 3560981, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/8fa10e8d564dd93ece697b0aebe689dd?s=128&d=identicon&r=PG&f=1", "display_name": "Nidhoegger", "link": "https://stackoverflow.com/users/3560981/nidhoegger"}, "edited": false, "score": 1, "creation_date": 1516220455, "post_id": 48309232, "comment_id": 83604297, "body": "hmm, that may come down to implementation.  I would think it best to assume <code>memmove</code> is the way to go until proven otherwise.  Perhaps look into the implementation of <code>memmove</code> on your platform to get a better idea."}, {"owner": {"reputation": 3975, "user_id": 3560981, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/8fa10e8d564dd93ece697b0aebe689dd?s=128&d=identicon&r=PG&f=1", "display_name": "Nidhoegger", "link": "https://stackoverflow.com/users/3560981/nidhoegger"}, "edited": false, "score": 0, "creation_date": 1516220619, "post_id": 48309232, "comment_id": 83604398, "body": "according to a post in a arduino forum its better to copy bytes by hand because the memmove overhead is rather expensive... Thats why I hoped memcpy will work..."}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "reply_to_user": {"reputation": 3975, "user_id": 3560981, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/8fa10e8d564dd93ece697b0aebe689dd?s=128&d=identicon&r=PG&f=1", "display_name": "Nidhoegger", "link": "https://stackoverflow.com/users/3560981/nidhoegger"}, "edited": false, "score": 0, "creation_date": 1516221060, "post_id": 48309232, "comment_id": 83604611, "body": "How costly is the fragmentation of wrapping at the end of the buffer vs. constantly rearranging the buffer so that it&#39;s completely sequential?"}, {"owner": {"reputation": 3975, "user_id": 3560981, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/8fa10e8d564dd93ece697b0aebe689dd?s=128&d=identicon&r=PG&f=1", "display_name": "Nidhoegger", "link": "https://stackoverflow.com/users/3560981/nidhoegger"}, "edited": false, "score": 0, "creation_date": 1516221513, "post_id": 48309232, "comment_id": 83604815, "body": "if the memory is too fragmented and the temp array does not fit it might come to a stack and heap clash..."}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "reply_to_user": {"reputation": 3975, "user_id": 3560981, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/8fa10e8d564dd93ece697b0aebe689dd?s=128&d=identicon&r=PG&f=1", "display_name": "Nidhoegger", "link": "https://stackoverflow.com/users/3560981/nidhoegger"}, "edited": false, "score": 0, "creation_date": 1516222708, "post_id": 48309232, "comment_id": 83605449, "body": "I am trying to understand the fragmentation issue you are worried about.  I&#39;m not sure I follow your concern.  With a circular buffer/queue where data wraps back to the beginning when it reaches the end, I don&#39;t think that should be an issue of fit anymore than the you&#39;d get from rearranging the buffer every time you remove something from the beginning.  But that discussion might be best for a question about preventing fragmentation rather than a question about copying memory in overlapping buffers."}], "tags": [], "owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "is_accepted": false, "score": 2, "last_activity_date": 1516219845, "creation_date": 1516219845, "answer_id": 48309232, "question_id": 48309157, "link": "https://stackoverflow.com/questions/48309157/move-data-in-an-array-will-overwrite-data/48309232#48309232", "title": "Move data in an array will overwrite data?", "body": "<p>The manual for <code>memcpy</code> explicitly states that it is not to be used when the buffers overlap and that in such case you should use <code>memmove</code>:</p>\n\n<blockquote>\n  <p>The memcpy() function copies n bytes from memory area src to memory area dest.  The memory areas must not overlap.  Use memmove(3) if the memory areas do overlap.</p>\n</blockquote>\n\n<p>For completion's sake, here's the description of <code>memmove</code>:</p>\n\n<blockquote>\n  <p>The  memmove() function copies n bytes from memory area src to memory area dest.  The memory areas may overlap: copying takes place as though the bytes in src are first copied into a temporary array that does not overlap src\n         or dest, and the bytes are then copied from the temporary array to dest.</p>\n</blockquote>\n"}], "owner": {"reputation": 3975, "user_id": 3560981, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/8fa10e8d564dd93ece697b0aebe689dd?s=128&d=identicon&r=PG&f=1", "display_name": "Nidhoegger", "link": "https://stackoverflow.com/users/3560981/nidhoegger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 758, "favorite_count": 0, "answer_count": 3, "score": -3, "last_activity_date": 1516220015, "creation_date": 1516219529, "question_id": 48309157, "link": "https://stackoverflow.com/questions/48309157/move-data-in-an-array-will-overwrite-data", "title": "Move data in an array will overwrite data?", "body": "<p>I have a question regarding memcpy. I have a buffer and want to move data from the rear end of the buffer to the front. Something like this:</p>\n\n<pre><code>int buffer[100];\nmemcpy(buffer, buffer + 10, 30);\n</code></pre>\n\n<p>There is overlapping data (Elements 11 - 21), will there be data lost or will this copy the data to the front? Is this a \"good practice\"?</p>\n\n<p>The background: I have a big buffer on a microcontroller and do not want to reallocate this buffer. Its a fifo buffer and everytime something gets read the data behind will be moved to the front. I do this to avoid memory fragmentation on the microcontroller.</p>\n"}, {"tags": ["c", "pointers", "output"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1516219320, "post_id": 48309094, "comment_id": 83603693, "body": "First of all - what is the point of decimal value of an address?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1516219347, "post_id": 48309094, "comment_id": 83603707, "body": "<code>&quot;%d&quot;</code> works with <code>int</code>.  It may not work with <code>&amp;a</code>.  Suggest <code>printf(&quot;%p\\n&quot;,(void*) &amp;a);</code>"}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1516219384, "post_id": 48309094, "comment_id": 83603729, "body": "To print address of pointers, you should use <code>%p</code>. Forget the decimal interpretation of pointers, the hexadecimal representation is far superior."}, {"owner": {"reputation": 1436, "user_id": 2154359, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/cbcb885163f3112cbd223bdd88651471?s=128&d=identicon&r=PG", "display_name": "xmen-5", "link": "https://stackoverflow.com/users/2154359/xmen-5"}, "edited": false, "score": 0, "creation_date": 1516219463, "post_id": 48309094, "comment_id": 83603782, "body": "later i will try to manipulte the tab variable , and i will test if every cell in the tab is 4 byte , so may be i wiill do tab+8 bytes to get the value of a specific   cell ,here it&#39;s a simple example , with decimal it will be easy for me ."}, {"owner": {"reputation": 1436, "user_id": 2154359, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/cbcb885163f3112cbd223bdd88651471?s=128&d=identicon&r=PG", "display_name": "xmen-5", "link": "https://stackoverflow.com/users/2154359/xmen-5"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1516220322, "post_id": 48309094, "comment_id": 83604212, "body": "@chux your solution give me a hexadecimal value."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1516220760, "post_id": 48309094, "comment_id": 83604462, "body": "@zakzak The output format of <code>%p</code> is implementation defined, but it is <i>defined</i>.  You code gave decimal output, but not necessarily correct output.  Your goal seems to wants any simple decimal output and not necessarily correct decimal output."}], "answers": [{"tags": [], "owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "is_accepted": false, "score": 5, "last_activity_date": 1516222001, "last_edit_date": 1516222001, "creation_date": 1516219462, "answer_id": 48309138, "question_id": 48309094, "link": "https://stackoverflow.com/questions/48309094/how-to-print-the-address-value-of-a-pointer-in-a-c-program/48309138#48309138", "title": "How to print the address value of a pointer in a C program?", "body": "<p>First, be aware that addresses are often \"number-like\" but might not be (e.g. remember the segment+offset notion of far addresses on 1980-era 16 bits x86 PCs).</p>\n\n<p>Then, the integral type the most similar to pointers is <code>intptr_t</code> (signed) or <code>uintptr_t</code> (unsigned) - both from <a href=\"http://en.cppreference.com/w/c/types/integer\" rel=\"nofollow noreferrer\"><code>&lt;stdint.h&gt;</code></a>.</p>\n\n<p>You might cast that to a <code>long long</code> (hoping that they are not smaller than pointers), e.g.</p>\n\n<pre><code> printf(\"address of a in decimal is %lld\\n\", (long long) (intptr_t) (&amp;a));\n</code></pre>\n\n<p>But really, why do you want to show an address in such a fashion? I see no need for it (e.g. debuggers or linkers are generally showing addresses in hexa, which is probably what <code>%p</code>  does).</p>\n\n<p>Notice that the C11 standard (see <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf\" rel=\"nofollow noreferrer\">n1570</a>, \u00a77.21.6.2, p315) does not say much about <code>%p</code> for printing pointer:</p>\n\n<blockquote>\n  <p>The  argument  shall  be  a  pointer  to <code>void</code>.  The  value  of  the  pointer is converted to a sequence of printing characters, in an implementation-defined manner.</p>\n</blockquote>\n\n<p>I'm understanding the above in a way where printing <code>Hello \u2b54</code> for any pointer would be an acceptable and standard conforming behavior. In practice, implementations print pointers in a way similar to what linkers and debuggers do, and don't behave in a silly way (but I understand they could).</p>\n\n<p>At last, the actual concrete \"numerical\" value of a pointer is not really important and can vary greatly from one execution to the next (e.g. because of <a href=\"https://en.wikipedia.org/wiki/ASLR\" rel=\"nofollow noreferrer\">ASLR</a>).</p>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": true, "score": 10, "last_activity_date": 1516220876, "last_edit_date": 1516220876, "creation_date": 1516219642, "answer_id": 48309189, "question_id": 48309094, "link": "https://stackoverflow.com/questions/48309094/how-to-print-the-address-value-of-a-pointer-in-a-c-program/48309189#48309189", "title": "How to print the address value of a pointer in a C program?", "body": "<p>To print a <em>decimal</em> version of an object pointer, 1st convert the pointer to an integer.  Best to use the optional type <code>uintptr_t</code>.</p>\n\n<blockquote>\n  <p>The following type (<code>uintptr_t</code>) designates an unsigned integer type with the property that any valid pointer to void can be converted to this type (<code>uintptr_t</code>) ... C11dr \u00a77.20.1.4 1</p>\n</blockquote>\n\n<pre><code>#include &lt;inttypes.h&gt;\nuintptr_t d = (uintptr_t)(void *) &amp;a;\n</code></pre>\n\n<p>Then print it.<br>\nSome info on <a href=\"http://pubs.opengroup.org/onlinepubs/009695399/basedefs/inttypes.h.html\" rel=\"noreferrer\">PRIuPTR</a></p>\n\n<pre><code>printf(\"%\" PRIuPTR \"\\n\", d);\n</code></pre>\n\n<hr>\n\n<p>For pre-C99 code, consider a direct cast to <code>unsigned long</code>.  <a href=\"https://stackoverflow.com/a/48309191/2410359\">@Barmar</a></p>\n\n<hr>\n\n<p>OP later commented</p>\n\n<p>\"... i will try to manipulate the tab variable , and i will test if every cell in the tab is 4 byte , so may be i will do tab+8 bytes to get the value of a specific cell , here it's a simple example , with decimal it will be easy for me .\"</p>\n\n<p>This is a questionable approach as the decimalization of a pointer may not provide the continuous numeric model expected.  This post this may be good for learning, but with OP providing more details in another post, even better ideas could be given for the higher level problem.</p>\n"}, {"comments": [{"owner": {"reputation": 1436, "user_id": 2154359, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/cbcb885163f3112cbd223bdd88651471?s=128&d=identicon&r=PG", "display_name": "xmen-5", "link": "https://stackoverflow.com/users/2154359/xmen-5"}, "edited": false, "score": 0, "creation_date": 1516220367, "post_id": 48309191, "comment_id": 83604238, "body": "your solution worked for me , i would prefere this because it&#39;s simple. i have to thank every One ."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 1436, "user_id": 2154359, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/cbcb885163f3112cbd223bdd88651471?s=128&d=identicon&r=PG", "display_name": "xmen-5", "link": "https://stackoverflow.com/users/2154359/xmen-5"}, "edited": false, "score": 0, "creation_date": 1516220511, "post_id": 48309191, "comment_id": 83604321, "body": "@zakzak It is simple - and with pointers wider than <code>long</code>, may provide confusing results."}, {"owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "edited": false, "score": 0, "creation_date": 1516226758, "post_id": 48309191, "comment_id": 83607274, "body": "chux&#39;s answer is the right one, don&#39;t prefer <i>simple</i> answers to right answers..."}], "tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": false, "score": 3, "last_activity_date": 1516449001, "last_edit_date": 1516449001, "creation_date": 1516219655, "answer_id": 48309191, "question_id": 48309094, "link": "https://stackoverflow.com/questions/48309094/how-to-print-the-address-value-of-a-pointer-in-a-c-program/48309191#48309191", "title": "How to print the address value of a pointer in a C program?", "body": "<p>If you want to see the pointer as a decimal integer, cast it to <code>unsigned long</code> and print it with <code>%lu</code> format. While this isn't guaranteed by the standard, it should work in most implementations.</p>\n\n<pre><code>printf(\"the address of a is %lu\\n\", (unsigned long)&amp;a);    \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 2, "creation_date": 1516220521, "post_id": 48309235, "comment_id": 83604332, "body": "I would use <code>unsigned long long</code> above instead of <code>uint64_t</code>, even if they are usually the same."}, {"owner": {"reputation": 11238, "user_id": 7594711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7872c871b0431b72df6350dd0394bea?s=128&d=identicon&r=PG&f=1", "display_name": "SoronelHaetir", "link": "https://stackoverflow.com/users/7594711/soronelhaetir"}, "edited": false, "score": 0, "creation_date": 1516222407, "post_id": 48309235, "comment_id": 83605306, "body": "Why not #include &lt;stdint.h&gt; and use size_t? Seems preferable to either uint64_t or unsigned long long. size_t may well be the same as either of those but uint64_t is very likely to be the same as unsigned long long while size_t is merely likely to be the same."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 11238, "user_id": 7594711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7872c871b0431b72df6350dd0394bea?s=128&d=identicon&r=PG&f=1", "display_name": "SoronelHaetir", "link": "https://stackoverflow.com/users/7594711/soronelhaetir"}, "edited": false, "score": 1, "creation_date": 1516227713, "post_id": 48309235, "comment_id": 83607725, "body": "@SoronelHaetir <code>size_t</code> may be as small a <code>uint16_t</code>.  Converting to a wide type like <code>unsigned long long</code> or <code>uintmax_t</code>, which are both at least 64-bit,  reduces the chance of information loss."}], "tags": [], "owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "is_accepted": false, "score": 4, "last_activity_date": 1516220562, "last_edit_date": 1516220562, "creation_date": 1516219869, "answer_id": 48309235, "question_id": 48309094, "link": "https://stackoverflow.com/questions/48309094/how-to-print-the-address-value-of-a-pointer-in-a-c-program/48309235#48309235", "title": "How to print the address value of a pointer in a C program?", "body": "<p>For printing an \"address\" (actually a pointer) <code>\"%p\"</code> is the most common method (note the necessary cast to <code>void*</code>). If you need the address in decimal instead of hexadecimal, you can convert the pointer into an integral value; this is well defined in C (cf. <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.3.2.3p6\" rel=\"nofollow noreferrer\">this</a> online C standard draft):</p>\n\n<blockquote>\n  <p>6.3.2.3 Pointers</p>\n  \n  <p>(6) Any pointer type may be converted to an integer type. Except as\n  previously specified, the result is implementation-defined. If the\n  result cannot be represented in the integer type, the behavior is\n  undefined. The result need not be in the range of values of any\n  integer type.</p>\n</blockquote>\n\n<p>So the code could look as follows:</p>\n\n<pre><code>int main(int argc, char *argv[]) {\n    int a =10;\n    int *p = &amp;a;\n    p  = &amp;a;\n\n    unsigned long long addrAsInt = (unsigned long long)p;\n\n    printf(\"the adress of a is %llu \\n\",addrAsInt);\n    printf(\"the adress of a using the pointer is %p \\n\",(void*)p);\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2005, "user_id": 9180179, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IHVRQ.jpg?s=128&g=1", "display_name": "Usman", "link": "https://stackoverflow.com/users/9180179/usman"}, "is_accepted": false, "score": 0, "last_activity_date": 1516451436, "creation_date": 1516451436, "answer_id": 48356157, "question_id": 48309094, "link": "https://stackoverflow.com/questions/48309094/how-to-print-the-address-value-of-a-pointer-in-a-c-program/48356157#48356157", "title": "How to print the address value of a pointer in a C program?", "body": "<p>p is the conversion specifier to print pointers. Use this.</p>\n\n<pre><code>int a = 42;\n\nprintf(\"%p\\n\", (void *) &amp;a);\n</code></pre>\n\n<p>Remember that omitting the cast is undefined behavior and that printing with p conversion specifier is done in an implementation-defined manner.</p>\n"}], "owner": {"reputation": 1436, "user_id": 2154359, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/cbcb885163f3112cbd223bdd88651471?s=128&d=identicon&r=PG", "display_name": "xmen-5", "link": "https://stackoverflow.com/users/2154359/xmen-5"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4354, "favorite_count": 3, "accepted_answer_id": 48309189, "answer_count": 5, "score": 2, "last_activity_date": 1594817465, "creation_date": 1516219263, "last_edit_date": 1594817465, "question_id": 48309094, "link": "https://stackoverflow.com/questions/48309094/how-to-print-the-address-value-of-a-pointer-in-a-c-program", "title": "How to print the address value of a pointer in a C program?", "body": "<p>I'm trying to learn how to use the pointer in a C program;  my example is as follows:</p>\n<pre><code>   #include &lt;stdio.h&gt;\n   #include &lt;stdlib.h&gt;\n   \n   int main(int argc, char *argv[]) {\n        int * tab = (int*)malloc(sizeof(int)*5);\n        int a = 10;\n        int *p;\n        p  = &amp;a;\n        printf(&quot;the address of a is %d \\n&quot;,&amp;a);    \n        printf(&quot;the address of a using the pointer is %p \\n&quot;,p);    \n        printf(&quot;the address of tab is %d \\n&quot;,tab);    \n    }\n</code></pre>\n<p>I'm trying to print the address of <code>a</code>, the address value inside of <code>p</code> and where the first byte of the <code>tab</code> begins.</p>\n<p>I can get hexadecimal values when using <code>&quot;%p&quot;</code>, but I'm willing the decimal value of the addresses.</p>\n<p><strong>Edit :</strong> On this <a href=\"https://www.youtube.com/watch?v=X1DcpcgSUXw&amp;index=2&amp;list=PL2_aWCzGMAwLZp6LMUKI3cc7pgGsasm2_\" rel=\"nofollow noreferrer\">Video</a>  <a href=\"https://image.prntscr.com/image/Ycq33ax2SAqvfxrOM_CnHQ.png\" rel=\"nofollow noreferrer\">image</a>, someone has used <code>&quot;%d&quot;</code> to print a decimal value for a pointer address, and it has confused me.</p>\n"}, {"tags": ["c", "posix"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1516219062, "post_id": 48308963, "comment_id": 83603555, "body": "Note  <code>lseek()</code> does not insure a failure when &quot;file is not a regular file&quot;.  Seems like an important advantage of <code>fstat()</code>."}, {"owner": {"reputation": 1056, "user_id": 4319483, "user_type": "registered", "profile_image": "https://graph.facebook.com/668992100/picture?type=large", "display_name": "Bjorn A.", "link": "https://stackoverflow.com/users/4319483/bjorn-a"}, "edited": false, "score": 2, "creation_date": 1516219599, "post_id": 48308963, "comment_id": 83603847, "body": "stat() and fstat() are fine. Why use anything else on POSIX systems?"}, {"owner": {"reputation": 509, "user_id": 9220448, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5YtOb.jpg?s=128&g=1", "display_name": "mariusz_latarnik01", "link": "https://stackoverflow.com/users/9220448/mariusz-latarnik01"}, "edited": false, "score": 0, "creation_date": 1516219675, "post_id": 48308963, "comment_id": 83603882, "body": "<a href=\"https://stackoverflow.com/questions/5957845/using-fseek-and-ftell-to-determine-the-size-of-a-file-has-a-vulnerability\">this</a> seems to be your answer, but in my opinion if you want only see the size of file fstat is clearer()."}], "answers": [{"tags": [], "owner": {"reputation": 135, "user_id": 5038027, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qHzGO.jpg?s=128&g=1", "display_name": "Nitin", "link": "https://stackoverflow.com/users/5038027/nitin"}, "is_accepted": false, "score": 1, "last_activity_date": 1516223437, "creation_date": 1516223437, "answer_id": 48310046, "question_id": 48308963, "link": "https://stackoverflow.com/questions/48308963/best-practices-for-determining-binary-regular-file-size-in-posix-compliant-c-pro/48310046#48310046", "title": "Best practices for determining binary regular file size in POSIX compliant C program", "body": "<p>Normally stat(), fstat() will read the metadata of the file to retrieve the file properties for the user. Mechanism to store metadata of files may vary from file system to file system but in general designed to give optimum speed/time complexity. </p>\n\n<p>'file size' is one of the file properties stored in metadata and is updated at various file operations (e.g. write/append etc). Further fstat() doesn't require you to 'open()' the file. </p>\n\n<p>On the other hand, Every 'open()' and 'lseek()' operations together could involve disk activity if the file is not present in the page cache of the operating system and could be exponentially more expensive.</p>\n\n<p>Therefore I would recommend fstat().</p>\n"}, {"comments": [{"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 0, "creation_date": 1516224131, "post_id": 48310110, "comment_id": 83606151, "body": "Would it be useful in any way to try both ways? Apart from catastrophical failure (which I&#39;d happily consider an outlier \u2013 just as your attempting to get the length of a file as it is being written ...), could <code>ftell</code> fail where <code>fstat</code> would succeed or the other way around?"}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "reply_to_user": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 1, "creation_date": 1516224192, "post_id": 48310110, "comment_id": 83606175, "body": "I don&#39;t think so, and most importantly, for me <i>by definition</i> the size of a file is what <code>stat</code> gives. I cannot find any better definition that this one."}], "tags": [], "owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "is_accepted": false, "score": 1, "last_activity_date": 1516270043, "last_edit_date": 1516270043, "creation_date": 1516223738, "answer_id": 48310110, "question_id": 48308963, "link": "https://stackoverflow.com/questions/48308963/best-practices-for-determining-binary-regular-file-size-in-posix-compliant-c-pro/48310110#48310110", "title": "Best practices for determining binary regular file size in POSIX compliant C program", "body": "<p>I recommend using <a href=\"http://man7.org/linux/man-pages/man2/stat.2.html\" rel=\"nofollow noreferrer\">stat(2)</a> or <a href=\"http://man7.org/linux/man-pages/man2/fstat.2.html\" rel=\"nofollow noreferrer\">fstat(2)</a> to get the size of a regular file (and in my opinion, the definition of a file size is what <code>stat</code> tells in <code>.st_size</code> field).</p>\n\n<p>Some regular files are not that regular. For example <code>/proc/self/status</code> or <code>/proc/self/maps</code> on a Linux system (read <a href=\"http://man7.org/linux/man-pages/man5/proc.5.html\" rel=\"nofollow noreferrer\">proc(5)</a>), even if <code>stat</code> or <code>ls</code> tells that they are \"regular files\". See <a href=\"https://stackoverflow.com/a/12237783/841108\">this</a>.</p>\n\n<p>On such <code>/proc/</code> pseudofiles, there is no simple way to get their \"real\" size (because <a href=\"http://man7.org/linux/man-pages/man2/stat.2.html\" rel=\"nofollow noreferrer\">stat(2)</a> is telling 0).</p>\n\n<p>However, I believe that the file size is, almost by definition, what <a href=\"http://man7.org/linux/man-pages/man2/stat.2.html\" rel=\"nofollow noreferrer\">stat(2)</a> tells you (and the fact that it is \"lying\" on <code>/proc/</code> is IMHO a deficiency of the <code>/proc/</code> file system; actually <code>/proc/self/maps</code> behave nearly like a <a href=\"http://man7.org/linux/man-pages/man7/pipe.7.html\" rel=\"nofollow noreferrer\">pipe(7)</a> read end, not like a regular file).</p>\n\n<p>Think also of the weird cases where <em>another</em> process is changing a file (e.g. <a href=\"http://man7.org/linux/man-pages/man2/write.2.html\" rel=\"nofollow noreferrer\">write(2)</a>-ing or <a href=\"http://man7.org/linux/man-pages/man2/ftruncate.2.html\" rel=\"nofollow noreferrer\">ftruncate(2)</a>-ing it). Then doing several syscalls might not work very well.</p>\n\n<p>At last,  <code>stat</code> is the simplest (and often the fastest) way to get a file size. So why bother using something else?</p>\n"}], "owner": {"reputation": 782, "user_id": 947839, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/813a73d7279efdda53dc8cd61a2348a2?s=128&d=identicon&r=PG", "display_name": "Luke Peterson", "link": "https://stackoverflow.com/users/947839/luke-peterson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 640, "favorite_count": 2, "answer_count": 2, "score": 3, "last_activity_date": 1516270043, "creation_date": 1516218800, "last_edit_date": 1516222406, "question_id": 48308963, "link": "https://stackoverflow.com/questions/48308963/best-practices-for-determining-binary-regular-file-size-in-posix-compliant-c-pro", "title": "Best practices for determining binary regular file size in POSIX compliant C program", "body": "<p>I need to determine the file size in bytes of binary regular files under POSIX. I'm aware of how to use this with lseek() and fstat():</p>\n\n<pre><code>#include &lt;sys/stat.h&gt; // for open() and fstat()\n#include &lt;fcntl.h&gt;    // for O_RDONLY\n#include &lt;unistd.h&gt;   // for lseek()\n\nint fd = open(\"something.bin\", O_RDONLY);\nif (fd == -1)\n{\n    perror(\"Unable to open file to read\");\n    return EXIT_FAILURE;\n}\n\n// Using lseek()\nconst off_t size = lseek(fd, 0, SEEK_END);\nif (size == (off_t) -1)\n{\n    perror(\"Unable to determine input file size\");\n    return EXIT_FAILURE;\n}\n// Don't forget to rewind\nif (lseek(fd, 0, SEEK_SET) != 0)\n{\n    perror(\"Unable to seek to beginning of input file\");\n    return EXIT_FAILURE;\n}\n...\n\n// Using fstat()\nstruct stat file_stat;\nint rc = fstat(fd, &amp;file_stat);\nif (rc != 0 || S_ISREG(file_stat.st_mod) == 0)\n{\n    perror(\"fstat failed or file is not a regular file\");\n    return EXIT_FAILURE;\n}\nconst off_t size = file_stat.st_size;\n</code></pre>\n\n<p>Why would I prefer one solution over the other?</p>\n\n<p>Does one approach do more (and perhaps unnecessary) than the other?</p>\n\n<p>Are there other POSIX compliant or standard C solutions that should be preferred?</p>\n"}, {"tags": ["c++", "c", "assembly", "stack", "stack-overflow"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1516218689, "post_id": 48308882, "comment_id": 83603321, "body": "Why does it have to go any particular direction?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1516218773, "post_id": 48308882, "comment_id": 83603366, "body": "M\u0265\u0250\u0287 \u1d09s \u028d\u0279ou\u0183 \u028d\u1d09\u0287\u0265 nds\u1d09p\u01dd-po\u028du&#191;"}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1516219125, "post_id": 48308882, "comment_id": 83603592, "body": "heap grows up stack grows down, gives you some flexibility.  if your stack started low and went high then you are going to hit it with the heap much sooner."}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "reply_to_user": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1516221987, "post_id": 48308882, "comment_id": 83605078, "body": "@old_timer: Depends on the memory implementation.  You could have the stack at lower memory and grow (upwards) towards the heap.  There is no requirement for a heap or a stack."}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1516222173, "post_id": 48308882, "comment_id": 83605166, "body": "absolutely...this question has no answer...it is one common implementation that may make a decreasing stack make sense."}], "owner": {"reputation": 115, "user_id": 7395780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71aaeec87a5585005d3277bda8e98743?s=128&d=identicon&r=PG&f=1", "display_name": "yehuda corsia", "link": "https://stackoverflow.com/users/7395780/yehuda-corsia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 88, "favorite_count": 0, "closed_date": 1516218674, "answer_count": 0, "score": 0, "last_activity_date": 1516218484, "creation_date": 1516218484, "question_id": 48308882, "link": "https://stackoverflow.com/questions/48308882/why-stack-get-backwards", "closed_reason": "Duplicate", "title": "Why stack get backwards?", "body": "<p>I was thinking why when I push something into stack esp decrease and don't increase.</p>\n\n<p>I know that this is the way that stack use in a lot of language, but I want to know why they do this and don't do this in upside down.</p>\n\n<p>I search a lot in internet and don't see a good answer. </p>\n\n<p>I was thinking about this when I was learn about stack overflow, and this is look like if stack was create upside down.. Was very hard to do stack overflow </p>\n"}, {"tags": ["c", "dpdk"], "answers": [{"comments": [{"owner": {"reputation": 170, "user_id": 8419637, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/21c0c1fadb8b914635d482fccf02bc88?s=128&d=identicon&r=PG&f=1", "display_name": "stoneman_41", "link": "https://stackoverflow.com/users/8419637/stoneman-41"}, "edited": false, "score": 0, "creation_date": 1516228274, "post_id": 48309666, "comment_id": 83607919, "body": "I&#39;ll try out <code>l2fwd</code> when I get the chance, but in the meantime, I did put print statements inside the main loop which calls the RX and TX burst methods. After a while the RX number seems to be 0, so the loop doesn&#39;t receive and then transmit anything."}, {"owner": {"reputation": 6709, "user_id": 7969900, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-FRmSKJ3-SLE/AAAAAAAAAAI/AAAAAAAAR3I/9HHcvlfBbNg/photo.jpg?sz=128", "display_name": "Andriy Berestovskyy", "link": "https://stackoverflow.com/users/7969900/andriy-berestovskyy"}, "reply_to_user": {"reputation": 170, "user_id": 8419637, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/21c0c1fadb8b914635d482fccf02bc88?s=128&d=identicon&r=PG&f=1", "display_name": "stoneman_41", "link": "https://stackoverflow.com/users/8419637/stoneman-41"}, "edited": false, "score": 0, "creation_date": 1516229868, "post_id": 48309666, "comment_id": 83608575, "body": "Well, if there are no packets on RX, there will be nothing to forward. Are you sure there are packets on RX? How do you generate the traffic?"}, {"owner": {"reputation": 170, "user_id": 8419637, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/21c0c1fadb8b914635d482fccf02bc88?s=128&d=identicon&r=PG&f=1", "display_name": "stoneman_41", "link": "https://stackoverflow.com/users/8419637/stoneman-41"}, "edited": false, "score": 0, "creation_date": 1516235295, "post_id": 48309666, "comment_id": 83610049, "body": "Don&#39;t mean to answer your question with another question, but how do you generate traffic in <code>basicfwd</code>, considering there&#39;s no stack as far as I know. Just realizing that may be the issue."}, {"owner": {"reputation": 170, "user_id": 8419637, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/21c0c1fadb8b914635d482fccf02bc88?s=128&d=identicon&r=PG&f=1", "display_name": "stoneman_41", "link": "https://stackoverflow.com/users/8419637/stoneman-41"}, "edited": false, "score": 0, "creation_date": 1516238376, "post_id": 48309666, "comment_id": 83610749, "body": "As a further point, I tried using <code>l2fwd</code>. Because there&#39;s no IP address concept, I added artificial IP addresses, and used <code>arp -s</code> to bind those to the hardware addresses that are listed when I start the application (on <code>l2fwd</code>). If I do it this way, does it matter what interface <code>ip route</code> is bounded to for this address (since the address isn&#39;t attached to the Kernel networking stack)? I am guessing something is wrong in this latter part."}, {"owner": {"reputation": 6709, "user_id": 7969900, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-FRmSKJ3-SLE/AAAAAAAAAAI/AAAAAAAAR3I/9HHcvlfBbNg/photo.jpg?sz=128", "display_name": "Andriy Berestovskyy", "link": "https://stackoverflow.com/users/7969900/andriy-berestovskyy"}, "reply_to_user": {"reputation": 170, "user_id": 8419637, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/21c0c1fadb8b914635d482fccf02bc88?s=128&d=identicon&r=PG&f=1", "display_name": "stoneman_41", "link": "https://stackoverflow.com/users/8419637/stoneman-41"}, "edited": false, "score": 0, "creation_date": 1516269734, "post_id": 48309666, "comment_id": 83622415, "body": "@stoneman_41 there is no need to add any IPs both in basicfwd and l2fwd cases. Both of those examples work as a basic switch, i.e. forward packets from one port to another. In both cases you need to generate traffic using external generator. There are variety of options: 1) <code>ping -f</code> 2) <code>dpdk-pktgen</code> 3) hardware generator. l2fwd example has few figures about the setup: <a href=\"http://dpdk.org/doc/guides/sample_app_ug/l2_forward_job_stats.html\" rel=\"nofollow noreferrer\">dpdk.org/doc/guides/sample_app_ug/l2_forward_job_stats.html</a>"}, {"owner": {"reputation": 170, "user_id": 8419637, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/21c0c1fadb8b914635d482fccf02bc88?s=128&d=identicon&r=PG&f=1", "display_name": "stoneman_41", "link": "https://stackoverflow.com/users/8419637/stoneman-41"}, "edited": false, "score": 0, "creation_date": 1516298135, "post_id": 48309666, "comment_id": 83640457, "body": "Thanks, so I got <code>pktgen</code> working independently (without an <code>l2fwd</code> application as well). Is it possible to run both simultaneously, since <code>pktgen</code> seems to open up <code>dpdk</code> as well and uses the available <code>HugePages</code>.  Also, in this scenario, how would you use <code>ping -f</code> w/o an IP address assigned? To clarify, I&#39;d want to do all of this locally, on the same machine without VMs (for testing purposes)."}, {"owner": {"reputation": 6709, "user_id": 7969900, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-FRmSKJ3-SLE/AAAAAAAAAAI/AAAAAAAAR3I/9HHcvlfBbNg/photo.jpg?sz=128", "display_name": "Andriy Berestovskyy", "link": "https://stackoverflow.com/users/7969900/andriy-berestovskyy"}, "reply_to_user": {"reputation": 170, "user_id": 8419637, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/21c0c1fadb8b914635d482fccf02bc88?s=128&d=identicon&r=PG&f=1", "display_name": "stoneman_41", "link": "https://stackoverflow.com/users/8419637/stoneman-41"}, "edited": false, "score": 0, "creation_date": 1516298510, "post_id": 48309666, "comment_id": 83640647, "body": "@stoneman_41 packet generator or <code>ping -f</code> should generate packets which will go through the host with running <code>l2fwd</code>. So destination IP must be an IP of another host, i.e. <code>HostA -- L2FWD -- HostB</code> and then from HostA you run <code>ping -f HostB</code> Here is the diagram: <a href=\"http://dpdk.org/doc/guides/_images/l2_fwd_vm2vm.svg\" rel=\"nofollow noreferrer\">dpdk.org/doc/guides/_images/l2_fwd_vm2vm.svg</a>"}, {"owner": {"reputation": 170, "user_id": 8419637, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/21c0c1fadb8b914635d482fccf02bc88?s=128&d=identicon&r=PG&f=1", "display_name": "stoneman_41", "link": "https://stackoverflow.com/users/8419637/stoneman-41"}, "reply_to_user": {"reputation": 6709, "user_id": 7969900, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-FRmSKJ3-SLE/AAAAAAAAAAI/AAAAAAAAR3I/9HHcvlfBbNg/photo.jpg?sz=128", "display_name": "Andriy Berestovskyy", "link": "https://stackoverflow.com/users/7969900/andriy-berestovskyy"}, "edited": false, "score": 0, "creation_date": 1516299343, "post_id": 48309666, "comment_id": 83641118, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/163431/discussion-between-stoneman-41-and-andriy-berestovskyy\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 6709, "user_id": 7969900, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-FRmSKJ3-SLE/AAAAAAAAAAI/AAAAAAAAR3I/9HHcvlfBbNg/photo.jpg?sz=128", "display_name": "Andriy Berestovskyy", "link": "https://stackoverflow.com/users/7969900/andriy-berestovskyy"}, "is_accepted": true, "score": 1, "last_activity_date": 1516221775, "creation_date": 1516221775, "answer_id": 48309666, "question_id": 48308821, "link": "https://stackoverflow.com/questions/48308821/cant-transmit-packets-in-dpdk-sample-application/48309666#48309666", "title": "Can&#39;t transmit packets in DPDK sample application", "body": "<p>The <code>basicfwd</code> example does not provide any statistics, so it could look like it hangs, but it fact it might work well.</p>\n\n<p>There are few options:</p>\n\n<ol>\n<li><p>It is possible to run the application with <code>gdb --args ./basicfwd</code> and confirm it receives frames, send frames or hangs.</p></li>\n<li><p>Try another example applications, for example <code>l2fwd</code>, which provide some statistics.</p></li>\n</ol>\n\n<p>Please also include logs, debug info etc information.</p>\n"}], "owner": {"reputation": 170, "user_id": 8419637, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/21c0c1fadb8b914635d482fccf02bc88?s=128&d=identicon&r=PG&f=1", "display_name": "stoneman_41", "link": "https://stackoverflow.com/users/8419637/stoneman-41"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 697, "favorite_count": 0, "accepted_answer_id": 48309666, "answer_count": 1, "score": 0, "last_activity_date": 1516221775, "creation_date": 1516218234, "last_edit_date": 1516220609, "question_id": 48308821, "link": "https://stackoverflow.com/questions/48308821/cant-transmit-packets-in-dpdk-sample-application", "title": "Can&#39;t transmit packets in DPDK sample application", "body": "<p>I have set up DPDK 17.08.01 on an Ubuntu 16.04.2 system. I've followed the guides involving HugePages setup. I have set up 2048 HugePages (1024 pages per NUMA core), with each page being 2048 kB. This can be shown with the command <code>cat /proc/meminfo</code>: </p>\n\n<pre><code>HugePages_Total:    2048\nHugePages_Free:        0\nHugePages_Rsvd:        0\nHugePages_Surp:        0\nHugepagesize:       2048 kB\n</code></pre>\n\n<p>I believe the <code>HugePages_Free</code> is <code>0</code> because I already started running an application on DPDK. They have no issue try to allocate <code>HugePages</code> as far as I know.</p>\n\n<p>I have also attached the corresponding drivers necessary to two of my interfaces Here is the output of <code>usertools/dpdk-devbind.py --status</code>:</p>\n\n<pre><code>Network devices using DPDK-compatible driver\n============================================\n0000:01:00.0 '82599ES 10-Gigabit SFI/SFP+ Network Connection 10fb' drv=igb_uio unused=uio_pci_generic\n0000:01:00.1 '82599ES 10-Gigabit SFI/SFP+ Network Connection 10fb' drv=igb_uio unused=uio_pci_generic\n\nNetwork devices using kernel driver\n===================================\n0000:84:00.0 '82580 Gigabit Network Connection 150e' if=ens2f0 drv=igb unused=igb_uio,uio_pci_generic *Active*\n0000:84:00.1 '82580 Gigabit Network Connection 150e' if=ens2f1 drv=igb unused=igb_uio,uio_pci_generic \n0000:84:00.2 '82580 Gigabit Network Connection 150e' if=ens2f2 drv=igb unused=igb_uio,uio_pci_generic \n0000:84:00.3 '82580 Gigabit Network Connection 150e' if=ens2f3 drv=igb unused=igb_uio,uio_pci_generic\n</code></pre>\n\n<p>I am trying the simple <code>basicfwd</code> sample application, which simply forwards from one port to the other. When I put in debug statements, however, I see only two loops for each port, and afterwards the application hangs. I am assuming the forwarding and whatnot is supposed to go on until the user stops it. Two packets are received in each port, but nothing is transmitted unfortunately.</p>\n\n<p>I understand the issue is a bit vague, and related to <code>DPDK</code> setup, but any other help with commands to use for debugging, things I should check, would be appreciated, as I am a beginner with <code>DPDK</code>. I haven't been able to find any good diagnosing tips online.</p>\n"}, {"tags": ["c", "include", "closures"], "comments": [{"owner": {"reputation": 6882, "user_id": 3403834, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xpA5S.jpg?s=128&g=1", "display_name": "user58697", "link": "https://stackoverflow.com/users/3403834/user58697"}, "edited": false, "score": 2, "creation_date": 1516219104, "post_id": 48308803, "comment_id": 83603574, "body": "Bad news: Mac OS indeed does not have the functions you are missing. Check out <a href=\"https://www.mikeash.com/pyblog/friday-qa-2011-05-06-a-tour-of-mablockclosure.html\" rel=\"nofollow noreferrer\">this</a>, particularly <b>Closure Allocation</b> section."}, {"owner": {"reputation": 31218, "user_id": 211160, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Z2fk7.png?s=128&g=1", "display_name": "HostileFork says dont trust SE", "link": "https://stackoverflow.com/users/211160/hostilefork-says-dont-trust-se"}, "reply_to_user": {"reputation": 6882, "user_id": 3403834, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xpA5S.jpg?s=128&g=1", "display_name": "user58697", "link": "https://stackoverflow.com/users/3403834/user58697"}, "edited": false, "score": 0, "creation_date": 1516229076, "post_id": 48308803, "comment_id": 83608250, "body": "@user58697 Strange, really?  I see some corroboration of missing <code>ffi_prep_cif_var</code> on MacOS.  But closures seem to be there...there are discussions of current bugs in closures on MacOS...such as <a href=\"https://github.com/libffi/libffi/issues/355\" rel=\"nofollow noreferrer\">this one</a> mentioning it recently, and <code>ffi_closure_alloc</code> is referred to <a href=\"https://sourceware.org/ml/libffi-discuss/2009/msg00236.html\" rel=\"nofollow noreferrer\">here in 2009</a>.  Are they talking about something different?"}, {"owner": {"reputation": 7691, "user_id": 152016, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/61e75a9dfee755b5a3d1104d4d3c104a?s=128&d=identicon&r=PG", "display_name": "Niloct", "link": "https://stackoverflow.com/users/152016/niloct"}, "edited": false, "score": 1, "creation_date": 1516233879, "post_id": 48308803, "comment_id": 83609702, "body": "<a href=\"https://bugs.python.org/msg115649\" rel=\"nofollow noreferrer\">bugs.python.org/msg115649</a> is more evidence."}], "answers": [{"comments": [{"owner": {"reputation": 3678, "user_id": 292969, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/q0SM6.jpg?s=128&g=1", "display_name": "rgchris", "link": "https://stackoverflow.com/users/292969/rgchris"}, "edited": false, "score": 0, "creation_date": 1516327132, "post_id": 48312139, "comment_id": 83651726, "body": "I get the following error: <code>Undefined symbols for architecture x86_64:   &quot;_ffi_closure_alloc&quot;, referenced from:       _main in closure-77e81a.o   &quot;_ffi_closure_free&quot;, referenced from:       _main in closure-77e81a.o   &quot;_ffi_prep_closure_loc&quot;, referenced from:       _main in closure-77e81a.o ld: symbol(s) not found for architecture x86_64 clang: error: linker command failed with exit code 1 (use -v to see invocation)</code>"}, {"owner": {"reputation": 7691, "user_id": 152016, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/61e75a9dfee755b5a3d1104d4d3c104a?s=128&d=identicon&r=PG", "display_name": "Niloct", "link": "https://stackoverflow.com/users/152016/niloct"}, "reply_to_user": {"reputation": 3678, "user_id": 292969, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/q0SM6.jpg?s=128&g=1", "display_name": "rgchris", "link": "https://stackoverflow.com/users/292969/rgchris"}, "edited": false, "score": 0, "creation_date": 1516328362, "post_id": 48312139, "comment_id": 83651994, "body": "In what step of the procedure I told you does this error occur ?"}, {"owner": {"reputation": 3678, "user_id": 292969, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/q0SM6.jpg?s=128&g=1", "display_name": "rgchris", "link": "https://stackoverflow.com/users/292969/rgchris"}, "edited": false, "score": 0, "creation_date": 1516329287, "post_id": 48312139, "comment_id": 83652188, "body": "At the build point: <code>gcc -o ffi -lffi ffi.c</code> \u2014double-checked, ran all the steps beforehand."}, {"owner": {"reputation": 7691, "user_id": 152016, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/61e75a9dfee755b5a3d1104d4d3c104a?s=128&d=identicon&r=PG", "display_name": "Niloct", "link": "https://stackoverflow.com/users/152016/niloct"}, "reply_to_user": {"reputation": 3678, "user_id": 292969, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/q0SM6.jpg?s=128&g=1", "display_name": "rgchris", "link": "https://stackoverflow.com/users/292969/rgchris"}, "edited": false, "score": 0, "creation_date": 1516331758, "post_id": 48312139, "comment_id": 83652679, "body": "Have you changed the <code>#include</code> to <code>#include &lt;ffi.h&gt;</code> ?"}], "tags": [], "owner": {"reputation": 7691, "user_id": 152016, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/61e75a9dfee755b5a3d1104d4d3c104a?s=128&d=identicon&r=PG", "display_name": "Niloct", "link": "https://stackoverflow.com/users/152016/niloct"}, "is_accepted": false, "score": 5, "last_activity_date": 1516236672, "last_edit_date": 1516236672, "creation_date": 1516235429, "answer_id": 48312139, "question_id": 48308803, "link": "https://stackoverflow.com/questions/48308803/how-to-include-ffi-in-os-x/48312139#48312139", "title": "How to include FFI in OS X?", "body": "<p>Well, seems like you can fix it doing this:</p>\n\n<pre><code>$ cd\n$ git clone https://github.com/libffi/libffi\n$ cd libffi/\n$ ./autogen.sh\n$ ./configure\n$ make\n$ make install\n</code></pre>\n\n<p>This will build <code>libffi</code> from source and it will work even if you have <code>libffi</code> installed from <code>brew</code>, because this new version will be installed under <code>/usr/local</code> and not in <code>Cellar</code>.</p>\n\n<p>Then you don't need to change the <code>#include</code>, keep it like <code>#include &lt;ffi.h&gt;</code>, open a terminal to the folder your isolated c source is and issue <code>gcc -o ffi -lffi ffi.c</code> (assuming it's the source file you have).</p>\n\n<pre><code>teixeira: ~/etudes_c $ ./ffi\nHello World!\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4107, "user_id": 791609, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DztuN.png?s=128&g=1", "display_name": "chenrui", "link": "https://stackoverflow.com/users/791609/chenrui"}, "is_accepted": false, "score": 0, "last_activity_date": 1609293187, "creation_date": 1609293187, "answer_id": 65501052, "question_id": 48308803, "link": "https://stackoverflow.com/questions/48308803/how-to-include-ffi-in-os-x/65501052#65501052", "title": "How to include FFI in OS X?", "body": "<p><code>brew install libffi</code> is the quick solution to help me solve the ld issue.</p>\n"}, {"tags": [], "owner": {"reputation": 167, "user_id": 6852444, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ds-dpPKZvAo/AAAAAAAAAAI/AAAAAAAAAJY/2qwze-T7XE4/photo.jpg?sz=128", "display_name": "Stuart Mclean", "link": "https://stackoverflow.com/users/6852444/stuart-mclean"}, "is_accepted": false, "score": 1, "last_activity_date": 1610832179, "last_edit_date": 1610832179, "creation_date": 1610815007, "answer_id": 65751929, "question_id": 48308803, "link": "https://stackoverflow.com/questions/48308803/how-to-include-ffi-in-os-x/65751929#65751929", "title": "How to include FFI in OS X?", "body": "<p><code>brew install libffi</code> worked for me with one additional step. When you run <code>brew info libffi</code> you'll see the following:</p>\n<pre class=\"lang-sh prettyprint-override\"><code># For compilers to find libffi you may need to set:\n  export LDFLAGS=&quot;-L/opt/homebrew/opt/libffi/lib&quot;\n  export CPPFLAGS=&quot;-I/opt/homebrew/opt/libffi/include&quot;\n\n# For pkg-config to find libffi you may need to set:\n  export PKG_CONFIG_PATH=&quot;/opt/homebrew/opt/libffi/lib/pkgconfig&quot;\n</code></pre>\n<p>Exporting these env vars allowed rvm to work correctly.</p>\n"}], "owner": {"reputation": 3678, "user_id": 292969, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/q0SM6.jpg?s=128&g=1", "display_name": "rgchris", "link": "https://stackoverflow.com/users/292969/rgchris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2181, "favorite_count": 0, "answer_count": 3, "score": 3, "last_activity_date": 1610832179, "creation_date": 1516218170, "question_id": 48308803, "link": "https://stackoverflow.com/questions/48308803/how-to-include-ffi-in-os-x", "title": "How to include FFI in OS X?", "body": "<p>I'm having trouble building <a href=\"https://github.com/metaeducation/ren-c\" rel=\"nofollow noreferrer\">this project</a> with the FFI extension enabled. To isolate the problem, I'm trying to compile <a href=\"http://www.chiark.greenend.org.uk/doc/libffi-dev/html/Closure-Example.html\" rel=\"nofollow noreferrer\">this example</a> (included in full below).</p>\n\n<p>I'm using OS X 10.13.2, Xcode 9.2 with Command Line Tools installed (confirmed that <strong>/usr/include/ffi/ffi.h</strong> exists). I modified the example so the include line reads <code>include &lt;ffi/ffi.h&gt;</code>.</p>\n\n<p>Invoking the compiler with no options, I get the following:</p>\n\n<pre><code>$ gcc closure.test.c\nclosure.test.c:23:13: warning: implicit declaration of function 'ffi_closure_alloc' is invalid in C99 [-Wimplicit-function-declaration]\n  closure = ffi_closure_alloc(sizeof(ffi_closure), &amp;bound_puts);\n            ^\nclosure.test.c:23:11: warning: incompatible integer to pointer conversion assigning to 'ffi_closure *' (aka 'struct ffi_closure *') from\n      'int' [-Wint-conversion]\n  closure = ffi_closure_alloc(sizeof(ffi_closure), &amp;bound_puts);\n          ^ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\nclosure.test.c:35:15: warning: implicit declaration of function 'ffi_prep_closure_loc' is invalid in C99 [-Wimplicit-function-declaration]\n          if (ffi_prep_closure_loc(closure, &amp;cif, puts_binding,\n              ^\nclosure.test.c:45:3: warning: implicit declaration of function 'ffi_closure_free' is invalid in C99 [-Wimplicit-function-declaration]\n  ffi_closure_free(closure);\n  ^\n4 warnings generated.\nUndefined symbols for architecture x86_64:\n  \"_ffi_closure_alloc\", referenced from:\n      _main in closure-7b0e9b.o\n  \"_ffi_closure_free\", referenced from:\n      _main in closure-7b0e9b.o\n  \"_ffi_prep_cif\", referenced from:\n      _main in closure-7b0e9b.o\n  \"_ffi_prep_closure_loc\", referenced from:\n      _main in closure-7b0e9b.o\n  \"_ffi_type_pointer\", referenced from:\n      _main in closure-7b0e9b.o\n  \"_ffi_type_sint32\", referenced from:\n      _main in closure-7b0e9b.o\nld: symbol(s) not found for architecture x86_64\nclang: error: linker command failed with exit code 1 (use -v to see invocation)\n</code></pre>\n\n<p>What options/modifications do I need to correct this?</p>\n\n<h2>Source of <code>closure.test.c</code>:</h2>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;ffi.h&gt;\n\n/* Acts like puts with the file given at time of enclosure. */\nvoid puts_binding(ffi_cif *cif, void *ret, void* args[],\n                  void *stream)\n{\n  *(ffi_arg *)ret = fputs(*(char **)args[0], (FILE *)stream);\n}\n\ntypedef int (*puts_t)(char *);\n\nint main()\n{\n  ffi_cif cif;\n  ffi_type *args[1];\n  ffi_closure *closure;\n\n  void *bound_puts;\n  int rc;\n\n  /* Allocate closure and bound_puts */\n  closure = ffi_closure_alloc(sizeof(ffi_closure), &amp;bound_puts);\n\n  if (closure)\n    {\n      /* Initialize the argument info vectors */\n      args[0] = &amp;ffi_type_pointer;\n\n      /* Initialize the cif */\n      if (ffi_prep_cif(&amp;cif, FFI_DEFAULT_ABI, 1,\n                       &amp;ffi_type_sint, args) == FFI_OK)\n        {\n          /* Initialize the closure, setting stream to stdout */\n          if (ffi_prep_closure_loc(closure, &amp;cif, puts_binding,\n                                   stdout, bound_puts) == FFI_OK)\n            {\n              rc = ((puts_t)bound_puts)(\"Hello World!\");\n              /* rc now holds the result of the call to fputs */\n            }\n        }\n    }\n\n  /* Deallocate both closure, and bound_puts */\n  ffi_closure_free(closure);\n\n  return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "linux", "gdb", "libc"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1516215678, "post_id": 48308171, "comment_id": 83601739, "body": "Why would that <code>.c</code> file exist? Do you have the Kernel source?"}], "answers": [{"comments": [{"owner": {"reputation": 17717, "user_id": 691867, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/86cad22e6f9100c801c56c099872bbc2?s=128&d=identicon&r=PG", "display_name": "colinfang", "link": "https://stackoverflow.com/users/691867/colinfang"}, "edited": false, "score": 1, "creation_date": 1516274627, "post_id": 48308507, "comment_id": 83625493, "body": "After downloading the source, <code>dir ~&#47;glibc&#47;glibc-2.23&#47;sysdeps&#47;unix&#47;sysv&#47;linux</code> works for me.  I wonder why <code>dir ~&#47;glibc&#47;glibc-2.23&#47;</code> doesn&#39;t work."}, {"owner": {"reputation": 7668, "user_id": 2554472, "user_type": "registered", "profile_image": "https://graph.facebook.com/1119155584/picture?type=large", "display_name": "Mark Plotnick", "link": "https://stackoverflow.com/users/2554472/mark-plotnick"}, "reply_to_user": {"reputation": 17717, "user_id": 691867, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/86cad22e6f9100c801c56c099872bbc2?s=128&d=identicon&r=PG", "display_name": "colinfang", "link": "https://stackoverflow.com/users/691867/colinfang"}, "edited": false, "score": 1, "creation_date": 1516308884, "post_id": 48308507, "comment_id": 83646015, "body": "@colinfang gdb does a limited amount of rummaging through the <code>dirs</code> directories in search of a file. <code>set substitute-path</code> may work better if you need to look at a variety of functions in glibc. <a href=\"https://sourceware.org/gdb/onlinedocs/gdb/Source-Path.html\" rel=\"nofollow noreferrer\">sourceware.org/gdb/onlinedocs/gdb/Source-Path.html</a>"}], "tags": [], "owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "is_accepted": true, "score": 8, "last_activity_date": 1516216933, "creation_date": 1516216933, "answer_id": 48308507, "question_id": 48308171, "link": "https://stackoverflow.com/questions/48308171/why-gdb-cannot-find-sysdeps-unix-sysv-linux-ifaddrs-c/48308507#48308507", "title": "Why gdb cannot find ../sysdeps/unix/sysv/linux/ifaddrs.c", "body": "<p>The debugging information in the <code>libc6-dbg</code> package includes the <em>names</em> of the source files for the C library, and a mapping from assembly instructions to specific lines within those source files, but it does not include the source files themselves.  So <code>gdb</code> can tell you that your breakpoint is associated with line 840 of a file named <code>sysdeps/unix/sysv/linux/ifaddrs.c</code>, but it can't show you what's actually on that line.  (The leading <code>../</code> is an artifact of glibc's terrifyingly complicated build system.)</p>\n\n<p>If you know where to find the Git repository for <a href=\"https://sourceware.org/git/?p=glibc.git\" rel=\"noreferrer\">the source code for the GNU C Library</a>, then you can look up <a href=\"https://sourceware.org/git/?p=glibc.git;a=blob;f=sysdeps/unix/sysv/linux/ifaddrs.c;hb=HEAD#l840\" rel=\"noreferrer\">that specific file and line</a> by hand in a web browser.  This is relatively quick and easy once you know how to do it, but probably won't show you the exact same version of the code that was used to build your copy of the library (this file in particular <a href=\"https://sourceware.org/git/?p=glibc.git;a=history;f=sysdeps/unix/sysv/linux/ifaddrs.c;hb=HEAD\" rel=\"noreferrer\">doesn't change very often</a>, but others do), and it doesn't get you access to the code <em>inside gdb</em>.</p>\n\n<p>To get the code visible inside gdb, you would need to download the source package that matches the C library on your system.  Based on the package name <code>libc6-dbg</code> I am guessing you are using a Linux distribution in the Debian family; if that's right, the command</p>\n\n<pre><code>apt-get source glibc\n</code></pre>\n\n<p>will do the job.  Then you can use the GDB command <a href=\"https://sourceware.org/gdb/current/onlinedocs/gdb/Source-Path.html\" rel=\"noreferrer\"><code>directory</code></a> to tell GDB where to look for the source files.  It will probably take a bit of fiddling to get everything working just so.</p>\n"}], "owner": {"reputation": 17717, "user_id": 691867, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/86cad22e6f9100c801c56c099872bbc2?s=128&d=identicon&r=PG", "display_name": "colinfang", "link": "https://stackoverflow.com/users/691867/colinfang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7189, "favorite_count": 3, "accepted_answer_id": 48308507, "answer_count": 1, "score": 7, "last_activity_date": 1516216933, "creation_date": 1516215585, "question_id": 48308171, "link": "https://stackoverflow.com/questions/48308171/why-gdb-cannot-find-sysdeps-unix-sysv-linux-ifaddrs-c", "title": "Why gdb cannot find ../sysdeps/unix/sysv/linux/ifaddrs.c", "body": "<p>I have <code>libc6</code> &amp; <code>libc6-dbg</code> installed.</p>\n\n<pre><code>(gdb) b\nreak freeifaddrs\n(gdb) run\nBreakpoint 1, __freeifaddrs (ifa=0xa822e0) at ../sysdeps/unix/sysv/linux/ifaddrs.c:840\n840 ../sysdeps/unix/sysv/linux/ifaddrs.c: No such file or directory.\n(gdb) list\n835 in ../sysdeps/unix/sysv/linux/ifaddrs.c\n(gdb) disassemble\nDump of assembler code for function __freeifaddrs:\n=&gt; 0x00007ffff7912fd0 &lt;+0&gt;: jmpq   0x7ffff780f8a8\nEnd of assembler dump.\n\n(gdb) where\n#0  __freeifaddrs (ifa=0xa822e0) at ../sysdeps/unix/sysv/linux/ifaddrs.c:840\n</code></pre>\n\n<p>However, gdb refuse to get me any info about ifaddrs.c, although it knows it is on line 840</p>\n\n<p>What happened here?</p>\n"}, {"tags": ["c", "file", "pointers", "malloc", "2d"], "comments": [{"owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "edited": false, "score": 1, "creation_date": 1516213421, "post_id": 48307623, "comment_id": 83600587, "body": "Can you please post <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1516213653, "post_id": 48307623, "comment_id": 83600704, "body": "Sample input, expected output?"}, {"owner": {"reputation": 641, "user_id": 9148849, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/023a4371461ee3649aadee1609399bed?s=128&d=identicon&r=PG&f=1", "display_name": "nabil.douss", "link": "https://stackoverflow.com/users/9148849/nabil-douss"}, "edited": false, "score": 0, "creation_date": 1516213735, "post_id": 48307623, "comment_id": 83600735, "body": "Where do you declare the variable &quot;world&quot;?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1516213766, "post_id": 48307623, "comment_id": 83600753, "body": "The very first code line should probably be using <code>sizeof(char*)</code> because the third line is setting its elements to pointers."}, {"owner": {"reputation": 3, "user_id": 9184208, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HvooU.jpg?s=128&g=1", "display_name": "Achilleas Guru", "link": "https://stackoverflow.com/users/9184208/achilleas-guru"}, "reply_to_user": {"reputation": 641, "user_id": 9148849, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/023a4371461ee3649aadee1609399bed?s=128&d=identicon&r=PG&f=1", "display_name": "nabil.douss", "link": "https://stackoverflow.com/users/9148849/nabil-douss"}, "edited": false, "score": 0, "creation_date": 1516213903, "post_id": 48307623, "comment_id": 83600814, "body": "@nabil.douss The var world is an universal variable.. I have declared it outside the fuction."}, {"owner": {"reputation": 3, "user_id": 9184208, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HvooU.jpg?s=128&g=1", "display_name": "Achilleas Guru", "link": "https://stackoverflow.com/users/9184208/achilleas-guru"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1516213978, "post_id": 48307623, "comment_id": 83600850, "body": "@WeatherVane Still codeblocks crashes when i compile&amp;run it... It crashes when it enters at the first for."}, {"owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "edited": false, "score": 0, "creation_date": 1516214015, "post_id": 48307623, "comment_id": 83600869, "body": "@AchilleasGuru.: SHow the full code."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1516214989, "post_id": 48307623, "comment_id": 83601356, "body": "It is impossible to store the contents of a file of any appreciable size in a pointer (including a pointer to a pointer).  You may, however, be able to store the file contents in the object(s) to which the pointer points, or in other, even more indirectly-specified objects.  Yes, I am in part nitpicking your wording, but it is important to understand the distinction between a pointer and the thing to which it points, and many questions around here hinge on a failure to understand it.  Yours may be one of them, in fact."}], "answers": [{"comments": [{"owner": {"reputation": 11619, "user_id": 5346306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BsACH.jpg?s=128&g=1", "display_name": "Achal", "link": "https://stackoverflow.com/users/5346306/achal"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1516214854, "post_id": 48307796, "comment_id": 83601272, "body": "@chux I suggested the same"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1516215654, "post_id": 48307796, "comment_id": 83601729, "body": "Tip: use <code>world = malloc(sizeof *word * grammes);</code>  It is easier to code, review and maintain.  No need to trying to get the type right."}], "tags": [], "owner": {"reputation": 11619, "user_id": 5346306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BsACH.jpg?s=128&g=1", "display_name": "Achal", "link": "https://stackoverflow.com/users/5346306/achal"}, "is_accepted": false, "score": 1, "last_activity_date": 1516214829, "last_edit_date": 1516214829, "creation_date": 1516214018, "answer_id": 48307796, "question_id": 48307623, "link": "https://stackoverflow.com/questions/48307623/reading-files-with-a-double-pointer-and-malloc/48307796#48307796", "title": "Reading Files with a double pointer and malloc", "body": "<p>Reason for crash is that <code>world</code> is double pointer and you should allocate memory for <code>world</code> first not for <code>**world</code>. </p>\n\n<p>Replace below statement</p>\n\n<pre><code>  **world = (char **)malloc(grammes * sizeof(char));\n</code></pre>\n\n<p>with</p>\n\n<pre><code> world = malloc(grammes * sizeof(char*)); //since world is double pointer it should be sizeof(char*)\n</code></pre>\n\n<p>Note : Typecasting of <code>malloc</code> is not required as suggested here <a href=\"https://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc\">Do I cast the result of malloc?</a></p>\n"}, {"tags": [], "owner": {"reputation": 641, "user_id": 9148849, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/023a4371461ee3649aadee1609399bed?s=128&d=identicon&r=PG&f=1", "display_name": "nabil.douss", "link": "https://stackoverflow.com/users/9148849/nabil-douss"}, "is_accepted": true, "score": 2, "last_activity_date": 1516214185, "creation_date": 1516214185, "answer_id": 48307839, "question_id": 48307623, "link": "https://stackoverflow.com/questions/48307623/reading-files-with-a-double-pointer-and-malloc/48307839#48307839", "title": "Reading Files with a double pointer and malloc", "body": "<ol>\n<li>By <code>**world</code>  you access the actual value and not the address. You have to change it to <code>world</code> ( If you have already declared the variable)</li>\n<li>In the first line it should be <code>sizeof(char*)</code> because world is a pointer to an array of char* </li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1516216573, "post_id": 48308191, "comment_id": 83602203, "body": "A pedantic note to your good answer: <code>if( world == NULL ){</code> is not necessarily a &quot;malloc failed&quot;.  Consider  if <code>grammes == 0</code>, a return value of <code>NULL</code> is OK. <code>malloc(0)</code> is one of those implementation defined corner cases.  I&#39;d use <code>if( world == NULL &amp;&amp; grammes != 0){</code> Another corner is <code>sizeof *world * grammes</code> overflowing.  Yet such details are certainly beyond OP&#39;s present concern."}, {"owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1516216704, "post_id": 48308191, "comment_id": 83602269, "body": "@chux.: Yes those are the nice corner points - Yes that&#39;s why safest would be to check the size first - because on size 0 malloc <i>may</i> return NULL...will add it as note."}, {"owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1516217020, "post_id": 48308191, "comment_id": 83602439, "body": "@chux.: but again here shouldn&#39;t the check be <code>grammes &gt; 0</code>? Ofcourse if it <code>size_t</code> then assigning <code>negative</code> will always results in true to this."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1516217849, "post_id": 48308191, "comment_id": 83602875, "body": "OP did not specify the sign-ness of <code>grammes</code> unfortunately.  <code>grammes != 0</code> appeared safer as we lack the &quot;sign-ness&quot; info.   With an <i>unsigned</i> <code>grammes</code>, then either <code>grammes != 0</code> or <code>grammes &gt; 0</code> function the same.  <code>grammes &gt; 0</code> is more clear in that case."}], "tags": [], "owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "is_accepted": false, "score": 1, "last_activity_date": 1516216994, "last_edit_date": 1516216994, "creation_date": 1516215708, "answer_id": 48308191, "question_id": 48307623, "link": "https://stackoverflow.com/questions/48307623/reading-files-with-a-double-pointer-and-malloc/48308191#48308191", "title": "Reading Files with a double pointer and malloc", "body": "<p>Well the thing is - you asked the question to misguide us not to help us to help you.</p>\n\n<pre><code>char ** world = malloc(..);\n</code></pre>\n\n<p>This is ok. </p>\n\n<p>When you did this before <code>char** world;</code> and then you do this </p>\n\n<pre><code>**world = ...\n</code></pre>\n\n<p>Wrong. Because you have used a <code>char</code> to store the value of a pointer.</p>\n\n<p>Well now see what you did, instead creating a chunk of memory which contains multiple <code>char*</code> you allocated for <code>char</code> then again used each of them to store the address of memory where <code>char</code> will be stored. Yes wrong it is</p>\n\n<pre><code>world = malloc(sizeof(char*) *grammes);\n</code></pre>\n\n<p>Better</p>\n\n<pre><code>world = malloc(sizeof *world * grammes);\n</code></pre>\n\n<p>And <code>malloc</code>'s return value should be checked and <code>malloc</code> returns a <code>void*</code> which can be implicitly converted to <code>char*</code> no need to cast the result.</p>\n\n<pre><code>world = malloc(sizeof *world * grammes);\nif( world == NULL ){\n    perror(\"malloc failed\");\n    exit(EXIT_FAILURE);\n} \n</code></pre>\n\n<p>Check the return value of <code>fscanf</code> also. You can check the man pages or standard to know their success value that hey return.</p>\n\n<hr>\n\n<p><code>chux</code> points out - </p>\n\n<p>There are few more things but it is not sure if you will be engage in such details </p>\n\n<p><code>malloc(sz)</code> <em>may</em> return <code>NULL</code> if <code>sz = 0</code> So saying <code>malloc</code> returns <code>NULL</code> means error is not perfectly correct or even if the <code>sz</code> is an overflown value then also it might return <code>NULL</code>.</p>\n\n<p>Here it is better to write the check like this</p>\n\n<pre><code>if( world != NULL &amp;&amp; grammes != 0){\n   //Error.\n}\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9184208, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HvooU.jpg?s=128&g=1", "display_name": "Achilleas Guru", "link": "https://stackoverflow.com/users/9184208/achilleas-guru"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 754, "favorite_count": 0, "accepted_answer_id": 48307839, "answer_count": 3, "score": -1, "last_activity_date": 1516216994, "creation_date": 1516213369, "last_edit_date": 1516213678, "question_id": 48307623, "link": "https://stackoverflow.com/questions/48307623/reading-files-with-a-double-pointer-and-malloc", "title": "Reading Files with a double pointer and malloc", "body": "<p>So, i am making the <strong>Game of Life</strong> of Conway.I  want to read a file and save it in a double pointer and malloc it's memory but i am getting a crash in codeblocks.\nIn the world i will put the dead and the living cells.</p>\n\n<pre><code>**world = (char **)malloc(grammes * sizeof(char));\nfor(i=0;i&lt;grammes;i++)\n    world[i]=(char *)malloc(stiles * sizeof(char));\n\n\nfor(i=0;i&lt;grammes;i++)\n{\n    for(j=0;j&lt;stiles;j++)\n    {\n        fscanf(fp,\"%c\",&amp;world[i][j]);\n    }\n}\n\nfor(i=0;i&lt;grammes;i++)\n{\n    for(j=0;j&lt;stiles;j++)\n    {\n        printf(\"%c\",world[i][j]);\n    }\n    printf(\"\\n\");\n}\n</code></pre>\n"}, {"tags": ["c", "assembly", "x86"], "comments": [{"owner": {"reputation": 15145, "user_id": 4271923, "user_type": "registered", "profile_image": "https://graph.facebook.com/543414580/picture?type=large", "display_name": "Ped7g", "link": "https://stackoverflow.com/users/4271923/ped7g"}, "edited": false, "score": 0, "creation_date": 1516220322, "post_id": 48307459, "comment_id": 83604213, "body": "You may want to check also <a href=\"https://stackoverflow.com/questions/48269670/x86-64-assembly-to-c/48269762#48269762\" title=\"x86 64 assembly to c\">stackoverflow.com/questions/48269670/x86-64-assembly-to-c/&hellip;</a> (although you have different questions about the same source)"}, {"owner": {"reputation": 15145, "user_id": 4271923, "user_type": "registered", "profile_image": "https://graph.facebook.com/543414580/picture?type=large", "display_name": "Ped7g", "link": "https://stackoverflow.com/users/4271923/ped7g"}, "edited": false, "score": 0, "creation_date": 1516220669, "post_id": 48307459, "comment_id": 83604420, "body": "And this one: <a href=\"https://stackoverflow.com/q/48262294/4271923\">stackoverflow.com/q/48262294/4271923</a> It&#39;s about different CPU (different instructions and registers), but there&#39;s my explanation of mental model of CPU vs memory chips, which can be used with x86 in the same way."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9231044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc72aa2a4e530fba7d309a0de0a3aa98?s=128&d=identicon&r=PG&f=1", "display_name": "Pete90", "link": "https://stackoverflow.com/users/9231044/pete90"}, "edited": false, "score": 0, "creation_date": 1516215740, "post_id": 48307817, "comment_id": 83601769, "body": "hmm interesting. With your information I have tried to translate it into the following C code (see answer), but still unsure."}], "tags": [], "owner": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "is_accepted": false, "score": 0, "last_activity_date": 1516214093, "creation_date": 1516214093, "answer_id": 48307817, "question_id": 48307459, "link": "https://stackoverflow.com/questions/48307459/task-rewrite-x86-assembler-program-in-c/48307817#48307817", "title": "Task: Rewrite X86-assembler program in C", "body": "<ol>\n<li>The <code>test</code> is used for a zero (<code>NULL</code>) check.</li>\n<li>The argument registers may be used as general purpose. As such, this function only takes 1 argument. <code>rdx</code> is just used as a local variable.</li>\n<li><strong>You</strong> never set it to anything, but the caller presumably has.</li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 15145, "user_id": 4271923, "user_type": "registered", "profile_image": "https://graph.facebook.com/543414580/picture?type=large", "display_name": "Ped7g", "link": "https://stackoverflow.com/users/4271923/ped7g"}, "edited": false, "score": 0, "creation_date": 1516220449, "post_id": 48308225, "comment_id": 83604291, "body": "The <code>rax</code> itself in your calling convention is very likely used as return value, so your function is not returning <code>void</code>, and the <code>return</code> statements miss the <code>rax</code>, which is being returned. And you are wrong about the first <code>rax = rdi;</code>, in C it&#39;s more like <code>rax = *rdi;</code>, it&#39;s loading value from memory, not from register itself, that <code>rdi</code> is used as memory address (pointer)."}, {"owner": {"reputation": 1, "user_id": 9231044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc72aa2a4e530fba7d309a0de0a3aa98?s=128&d=identicon&r=PG&f=1", "display_name": "Pete90", "link": "https://stackoverflow.com/users/9231044/pete90"}, "reply_to_user": {"reputation": 15145, "user_id": 4271923, "user_type": "registered", "profile_image": "https://graph.facebook.com/543414580/picture?type=large", "display_name": "Ped7g", "link": "https://stackoverflow.com/users/4271923/ped7g"}, "edited": false, "score": 0, "creation_date": 1516222665, "post_id": 48308225, "comment_id": 83605427, "body": "@Ped7g this and the questions you linked to was just what I needed, thank you very much."}], "tags": [], "owner": {"reputation": 1, "user_id": 9231044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc72aa2a4e530fba7d309a0de0a3aa98?s=128&d=identicon&r=PG&f=1", "display_name": "Pete90", "link": "https://stackoverflow.com/users/9231044/pete90"}, "is_accepted": false, "score": 0, "last_activity_date": 1516215859, "creation_date": 1516215859, "answer_id": 48308225, "question_id": 48307459, "link": "https://stackoverflow.com/questions/48307459/task-rewrite-x86-assembler-program-in-c/48308225#48308225", "title": "Task: Rewrite X86-assembler program in C", "body": "<p>I have been able to make a guess as to how it would look in C (thanks to Jesters answer):</p>\n\n<pre><code>void main(rdi)\n{\n    long rax = rdi;\n\n    if (rax == 0)\n    {\n        return;\n    }\n\n    rdi += 8;\n\n    long rdx = rdi;\n\n    do \n    {\n        if(rdx-rax &lt; 0)\n        {\n            rax = rdx;\n\n        }\n\n        rdi += 8;\n        rdx = unknown_variable //(-8(%rdi))\n\n\n    } while(rdx != 0 );\n\n    return;\n\n}\n</code></pre>\n\n<p>Am I far off?</p>\n"}], "owner": {"reputation": 1, "user_id": 9231044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc72aa2a4e530fba7d309a0de0a3aa98?s=128&d=identicon&r=PG&f=1", "display_name": "Pete90", "link": "https://stackoverflow.com/users/9231044/pete90"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 178, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1516215859, "creation_date": 1516212756, "last_edit_date": 1516214135, "question_id": 48307459, "link": "https://stackoverflow.com/questions/48307459/task-rewrite-x86-assembler-program-in-c", "title": "Task: Rewrite X86-assembler program in C", "body": "<p>I'm having trouble with a question from my Computer Systems exam testset. </p>\n\n<p>The question/task is: <strong>\"Rewrite the following X86-assembler program in C\"</strong>. </p>\n\n<p>I have gone through the assembly code, and commented what I think I know:</p>\n\n<pre><code>program:\n    movq (%rdi), %rax   # 1st argument copied to return value register\n    testq %rax, %rax    # Sets ZF to 1 if value stored in it is 0 (return value == 0)?\n    je L1               # Jump to L1 if (ZF == 1)\n    addq $8, %rdi        # Value 8 is added to 1st argument\n    movq %rax, %rdx     # Retun value register is copied to 3rd argument\nL3:\n    cmpq %rdx, %rax     # sets SF if (return value - 3rd argument &lt; 0)?\n    cmovl %rdx, %rax    # Copy 3rd argument to return value register if (SF = 1)?\n    addq $8, %rdi        # Value 8 is added to 1st argument\n    movq -8(%rdi), %rdx # ?\n    testq %rdx, %rdx    # Sets ZF to 1 if value stored in it is 0 (3rd argument == 0)?\n    jne L3              # Jump to L3 if (ZF == 0)?\nL1:\n    ret                 # Pop's return address off the stack, and sets intruction pointer to it\n</code></pre>\n\n<p>There is quiet a few things I am uncertain about, which could be awsome if somebody could clarify for me:</p>\n\n<ul>\n<li>What is the purpose of <code>testq %rax, %rax</code> and <code>testq %rdx, %rdx</code>?</li>\n<li>The code make use of <code>%rdi</code> (arg1) and <code>%rdx</code> (arg3), but not <code>%rsi</code> (arg2) - is this to trick us students (no usage for arg2), or how should that be intrepreted when converted to C?</li>\n<li>We never copied anything to the address <code>-8(%rdi)</code>, but suddenly we want to copy its content to <code>%rdx</code>?</li>\n</ul>\n\n<p>I have been reading up on assembly the entire day, but I am having a really hard time to fully grasp it. If I have made any mistakes in my comments please point them out.</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["c", "r", "r-package"], "comments": [{"owner": {"reputation": 3634, "user_id": 9153525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccd3f85ced0a618c40bf37c5e65c7391?s=128&d=identicon&r=PG&f=1", "display_name": "RolandASc", "link": "https://stackoverflow.com/users/9153525/rolandasc"}, "edited": false, "score": 0, "creation_date": 1516214360, "post_id": 48307397, "comment_id": 83601015, "body": "If you could show the <code>query_row</code> source I could probably give you an answer. When using <code>.C()</code> in the past, I would have typically passed a pre-initialized (named) argument that was supposed to be filled with the output from within the executed C code."}, {"owner": {"reputation": 12258, "user_id": 4596596, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/b00c839c9e28eb73aeb299bf3ef69a76?s=128&d=identicon&r=PG&f=1", "display_name": "ShanZhengYang", "link": "https://stackoverflow.com/users/4596596/shanzhengyang"}, "reply_to_user": {"reputation": 3634, "user_id": 9153525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccd3f85ced0a618c40bf37c5e65c7391?s=128&d=identicon&r=PG&f=1", "display_name": "RolandASc", "link": "https://stackoverflow.com/users/9153525/rolandasc"}, "edited": false, "score": 0, "creation_date": 1516218045, "post_id": 48307397, "comment_id": 83602989, "body": "@RolandASc I&#39;ve added the function above. It looks like it&#39;s just printing to STDOUT. Let me know if the above doesn&#39;t make sense."}, {"owner": {"reputation": 3634, "user_id": 9153525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccd3f85ced0a618c40bf37c5e65c7391?s=128&d=identicon&r=PG&f=1", "display_name": "RolandASc", "link": "https://stackoverflow.com/users/9153525/rolandasc"}, "edited": false, "score": 1, "creation_date": 1516228748, "post_id": 48307397, "comment_id": 83608114, "body": "ok - I think you would add a <code>char **result</code> to the <code>void query_row(...)</code>, extend your call to <code>.C(&#39;query_row&#39;, ..., result = character(4)</code>, and then do e.g. <code>strcat</code> in addition to printing in <code>print_db_row</code> and return the resulting char array into the corresponding element of <code>result</code>. Afterwards you can access the result under <code>foobar$result</code>. I should still point out that for character vector output or more advanced the .C() interface is not really recommended. My personal preference would be to use <code>Rcpp</code> as the interface here."}, {"owner": {"reputation": 12258, "user_id": 4596596, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/b00c839c9e28eb73aeb299bf3ef69a76?s=128&d=identicon&r=PG&f=1", "display_name": "ShanZhengYang", "link": "https://stackoverflow.com/users/4596596/shanzhengyang"}, "reply_to_user": {"reputation": 3634, "user_id": 9153525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccd3f85ced0a618c40bf37c5e65c7391?s=128&d=identicon&r=PG&f=1", "display_name": "RolandASc", "link": "https://stackoverflow.com/users/9153525/rolandasc"}, "edited": false, "score": 0, "creation_date": 1516229816, "post_id": 48307397, "comment_id": 83608559, "body": "@RolandASc  Thanks for the help! &quot; My personal preference would be to use Rcpp as the interface here.&quot; I would love to do this, but I&#39;ve never understood how it should work with C code."}, {"owner": {"reputation": 12258, "user_id": 4596596, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/b00c839c9e28eb73aeb299bf3ef69a76?s=128&d=identicon&r=PG&f=1", "display_name": "ShanZhengYang", "link": "https://stackoverflow.com/users/4596596/shanzhengyang"}, "reply_to_user": {"reputation": 3634, "user_id": 9153525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccd3f85ced0a618c40bf37c5e65c7391?s=128&d=identicon&r=PG&f=1", "display_name": "RolandASc", "link": "https://stackoverflow.com/users/9153525/rolandasc"}, "edited": false, "score": 0, "creation_date": 1516231027, "post_id": 48307397, "comment_id": 83608950, "body": "@RolandASc &quot;return the resulting char array into the corresponding element of result&quot; I seem to run into bugs here. Could you be a bit more concrete? <code>strcat()</code> an empty <code>char **</code> and <code>print_db_row()</code>?"}], "owner": {"reputation": 12258, "user_id": 4596596, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/b00c839c9e28eb73aeb299bf3ef69a76?s=128&d=identicon&r=PG&f=1", "display_name": "ShanZhengYang", "link": "https://stackoverflow.com/users/4596596/shanzhengyang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 99, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1516217988, "creation_date": 1516212533, "last_edit_date": 1516217988, "question_id": 48307397, "link": "https://stackoverflow.com/questions/48307397/cannot-parse-the-output-of-a-c-function-into-r", "title": "Cannot parse the output of a C function into R", "body": "<p>I'm hacking third-party R code (and the C code in <code>/src</code>) which makes queries to a database. The way the R package does this is to use <code>.C()</code> to interact with C code. </p>\n\n<p>(Note: my understanding is that <code>.C()</code> is deprecated and users are recommended to use <code>.Call()</code> instead). </p>\n\n<pre><code>foobar = .C('query_row', file, index, query)\n</code></pre>\n\n<p>This actually does work in R when the R function is called. However, foobar is of type <code>list</code>, and calling <code>.C()</code> simply prints the C output into the R terminal:</p>\n\n<pre><code>&gt; foobar = .C('query_row', file, index, query)\n## outputs the query from the C function 'query_row'`\nrow1    row2    row3   row4 \nrow1    row2    row3   row4 \nrow1    row2    row3   row4 \nrow1    row2    row3   row4 \n...\n&gt; foobar       ### now, I cannot access the output from the C function\n[[1]]\n[1] \"/path/dbfile\"\n\n[[2]]\n[1] \"/path/dbindex\"\n\n[[3]]\n[1] \"query_string\"\n</code></pre>\n\n<p>I actually cannot work with the output of the C function, even though it prints to the R terminal. How could I \"grab\" this C output so I could put it into an R data structure? Something like <code>fread()</code> from <code>data.table</code> or <code>paste()</code> from base R</p>\n\n<p>I first thought I could use <code>readLines()</code> as if this was a connection:</p>\n\n<pre><code>&gt; readLines(.C('query_row', file, index, query))\n## outputs the query from the C function 'query_row'`\nrow1    row2    row3   row4 \nrow1    row2    row3   row4 \nrow1    row2    row3   row4 \nrow1    row2    row3   row4 \n...\nError in readLines(.C('query_row', file, : \n      'con' is not a connection\n</code></pre>\n\n<p>It still outputs the C output into the R terminal, but throws an error at <code>readLines()</code></p>\n\n<p>I've tried re-writing this with <code>.Call()</code>, but I get a massive error: </p>\n\n<pre><code>*** caught segfault ***\naddress 0x20000090, cause 'memory not mapped'\n\nTraceback:\n 1: .Call(.C('query_row', file, index, query, package = 'packageName'))\n\nPossible actions:\n1: abort (with core dump, if enabled)\n2: normal R exit\n3: exit R without saving workspace\n4: exit R saving workspace\n</code></pre>\n\n<p>EDIT: Here is the <code>query_row</code> C source code. It looks like it's just printing to STDOUT:</p>\n\n<pre><code>void\nquery_row(char **input, char **dbfile, char **query)\n{\n    db_row_set_t *row_set = get_query_rows(*input_file_name, *dbfile, *query);\n\n    if (row_set != NULL) {\n        for (size_t j = 0; j &lt; row_set-&gt;n_entries; ++j) {\n            print_db_row(row_set-&gt;rows[j]);\n        }\n    }\n}\n</code></pre>\n\n<p>and <code>print_db_row</code> is just a wrapper around <code>printf()</code></p>\n\n<pre><code>void\nprint_db_row(db_row_set_t *row)\n{\n    printf(\"%s\", row-&gt;row1name);\n    printf(\"\\t%s\", row-&gt;row2name);\n    printf(\"\\t%s\", row-&gt;row3name);\n    printf(\"\\t%s\", row-&gt;row4name);\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "c-preprocessor"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user8782808"}, "edited": false, "score": 0, "creation_date": 1516212753, "post_id": 48307385, "comment_id": 83600218, "body": "Will using <code>(...)</code> and <code>__VA_ARGS__</code> work for you? I\u2019m not sure what you\u2019re asking."}, {"owner": {"reputation": 5285, "user_id": 195873, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53912b2e0cc619ca6c81ab1406522c2a?s=128&d=identicon&r=PG", "display_name": "Eric Niebler", "link": "https://stackoverflow.com/users/195873/eric-niebler"}, "edited": false, "score": 0, "creation_date": 1516213579, "post_id": 48307385, "comment_id": 83600667, "body": "I updated the problem description to give my motivating use case, but all I need is to know how to do <i>something</i> for each element in a list like <code>(A)(B)(C)</code>. I can do the rest."}, {"owner": {"reputation": 815, "user_id": 1150292, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VQ2aZ.jpg?s=128&g=1", "display_name": "Mara Bos", "link": "https://stackoverflow.com/users/1150292/mara-bos"}, "edited": false, "score": 0, "creation_date": 1516294179, "post_id": 48307385, "comment_id": 83638173, "body": "How strict is your requirement on the syntax? Does it need to be <code>(A)(B)(C)</code>, or is <code>((A)(B)(C))</code> also fine?"}], "answers": [{"comments": [{"owner": {"reputation": 5285, "user_id": 195873, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53912b2e0cc619ca6c81ab1406522c2a?s=128&d=identicon&r=PG", "display_name": "Eric Niebler", "link": "https://stackoverflow.com/users/195873/eric-niebler"}, "edited": false, "score": 0, "creation_date": 1516217297, "post_id": 48307889, "comment_id": 83602572, "body": "The docs claim there is no limit on the number of elements that can be processed by something like <code>BOOST_PP_SEQ_FOLD_LEFT</code> (although something like <code>SIZE</code> or <code>ELEM</code> would have a limit, I suppose). I&#39;m still left wondering how that is achieved."}, {"owner": {"reputation": 10212, "user_id": 1277769, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/wEHKk.jpg?s=128&g=1", "display_name": "SirGuy", "link": "https://stackoverflow.com/users/1277769/sirguy"}, "reply_to_user": {"reputation": 5285, "user_id": 195873, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53912b2e0cc619ca6c81ab1406522c2a?s=128&d=identicon&r=PG", "display_name": "Eric Niebler", "link": "https://stackoverflow.com/users/195873/eric-niebler"}, "edited": false, "score": 0, "creation_date": 1516217626, "post_id": 48307889, "comment_id": 83602745, "body": "@EricNiebler That&#39;s interesting because looking at the source code (I have v1.60) it lists out these types of repeating macros up to 257 (at which point you get an error). I looked at the docs <a href=\"http://www.boost.org/doc/libs/1_64_0/libs/preprocessor/doc/ref/seq_fold_left.html\" rel=\"nofollow noreferrer\">here</a> and didn&#39;t see any mention of <i>not</i> having a limit, which I took to mean that there is the usual limit."}, {"owner": {"reputation": 5285, "user_id": 195873, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53912b2e0cc619ca6c81ab1406522c2a?s=128&d=identicon&r=PG", "display_name": "Eric Niebler", "link": "https://stackoverflow.com/users/195873/eric-niebler"}, "edited": false, "score": 0, "creation_date": 1516217895, "post_id": 48307889, "comment_id": 83602898, "body": "From <a href=\"http://www.boost.org/doc/libs/1_62_0/libs/preprocessor/doc/AppendixA-AnIntroductiontoPreprocessorMetaprogramming.html\" rel=\"nofollow noreferrer\">boost.org/doc/libs/1_62_0/libs/preprocessor/doc/&hellip;</a>, &quot;It&#39;s worth noting that while there is no upper limit on the length of a sequence, operations such as <code>BOOST_PP_SEQ_ELEM</code> that take numeric arguments will only work with values up to 256.&quot;"}, {"owner": {"reputation": 10212, "user_id": 1277769, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/wEHKk.jpg?s=128&g=1", "display_name": "SirGuy", "link": "https://stackoverflow.com/users/1277769/sirguy"}, "reply_to_user": {"reputation": 5285, "user_id": 195873, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53912b2e0cc619ca6c81ab1406522c2a?s=128&d=identicon&r=PG", "display_name": "Eric Niebler", "link": "https://stackoverflow.com/users/195873/eric-niebler"}, "edited": false, "score": 1, "creation_date": 1516218681, "post_id": 48307889, "comment_id": 83603319, "body": "@EricNiebler Well, I&#39;m sorry to say that I have just tried an example with a sequence of 275 elements and BOOST_PP_SEQ_FOLD_LEFT failed. When I cut that sequence down to about 160 elements it worked so I think there is a size limit to BOOST_PP_FOLD_LEFT."}, {"owner": {"reputation": 5285, "user_id": 195873, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53912b2e0cc619ca6c81ab1406522c2a?s=128&d=identicon&r=PG", "display_name": "Eric Niebler", "link": "https://stackoverflow.com/users/195873/eric-niebler"}, "edited": false, "score": 0, "creation_date": 1516218844, "post_id": 48307889, "comment_id": 83603410, "body": "Interesting! Are you using MSVC by chance? I know Boost.PP is hobbled on that compiler."}, {"owner": {"reputation": 10212, "user_id": 1277769, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/wEHKk.jpg?s=128&g=1", "display_name": "SirGuy", "link": "https://stackoverflow.com/users/1277769/sirguy"}, "reply_to_user": {"reputation": 5285, "user_id": 195873, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53912b2e0cc619ca6c81ab1406522c2a?s=128&d=identicon&r=PG", "display_name": "Eric Niebler", "link": "https://stackoverflow.com/users/195873/eric-niebler"}, "edited": false, "score": 0, "creation_date": 1516219292, "post_id": 48307889, "comment_id": 83603684, "body": "@EricNiebler GCC4.8, not a recent one for sure but I think the test is still valid."}, {"owner": {"reputation": 3789, "user_id": 2434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d51d8dcc8d3785976ae21fb5e25b4520?s=128&d=identicon&r=PG", "display_name": "Daniel James", "link": "https://stackoverflow.com/users/2434/daniel-james"}, "edited": false, "score": 1, "creation_date": 1516220391, "post_id": 48307889, "comment_id": 83604255, "body": "FWIW I think Chaos could deal with longer sequences. Seems to be a copy here: <a href=\"https://github.com/ldionne/chaos-pp\" rel=\"nofollow noreferrer\">github.com/ldionne/chaos-pp</a>"}, {"owner": {"reputation": 5285, "user_id": 195873, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53912b2e0cc619ca6c81ab1406522c2a?s=128&d=identicon&r=PG", "display_name": "Eric Niebler", "link": "https://stackoverflow.com/users/195873/eric-niebler"}, "edited": false, "score": 0, "creation_date": 1516222020, "post_id": 48307889, "comment_id": 83605096, "body": "I have no hope of understanding how Chaos works before the heat death of the universe. :-("}, {"owner": {"reputation": 5285, "user_id": 195873, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53912b2e0cc619ca6c81ab1406522c2a?s=128&d=identicon&r=PG", "display_name": "Eric Niebler", "link": "https://stackoverflow.com/users/195873/eric-niebler"}, "edited": false, "score": 0, "creation_date": 1516226020, "post_id": 48307889, "comment_id": 83606944, "body": "It&#39;s occurring to me now that simply knowing how to implement <code>BOOST_PP_SEQ_FOLD_LEFT</code> isn&#39;t really enough given the problem I describe above. There is no one macro that receives the whole list, so I can&#39;t figure out how to apply the techniques described here."}, {"owner": {"reputation": 10212, "user_id": 1277769, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/wEHKk.jpg?s=128&g=1", "display_name": "SirGuy", "link": "https://stackoverflow.com/users/1277769/sirguy"}, "reply_to_user": {"reputation": 5285, "user_id": 195873, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53912b2e0cc619ca6c81ab1406522c2a?s=128&d=identicon&r=PG", "display_name": "Eric Niebler", "link": "https://stackoverflow.com/users/195873/eric-niebler"}, "edited": false, "score": 0, "creation_date": 1516228364, "post_id": 48307889, "comment_id": 83607950, "body": "@EricNiebler I&#39;m not sure what you mean in your last comment, can&#39;t you just create a macro that pops the head of the sequence and does something with that, and then passes the tail of the sequence off to the iteration macro?"}], "tags": [], "owner": {"reputation": 10212, "user_id": 1277769, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/wEHKk.jpg?s=128&g=1", "display_name": "SirGuy", "link": "https://stackoverflow.com/users/1277769/sirguy"}, "is_accepted": false, "score": 2, "last_activity_date": 1516217089, "last_edit_date": 1516217089, "creation_date": 1516214343, "answer_id": 48307889, "question_id": 48307385, "link": "https://stackoverflow.com/questions/48307385/how-does-boost-pp-seq-fold-left-work/48307889#48307889", "title": "How does BOOST_PP_SEQ_FOLD_LEFT work?", "body": "<p>Alright, here's a quick and dirty thing I whipped up that I think you can use:</p>\n\n<pre><code>#include &lt;iostream&gt;\n\n#define LIST (1)(2)(3)(4)\n\n#define EAT2(list)\n#define EAT(list) EAT2 list\n#define KEEP(x) x EAT2(\n#define STRINGIFY2(x) #x\n#define STRINGIFY(x) STRINGIFY2(x)\n\n#define HEAD(list) KEEP list )\n#define TAIL(list) EAT(list)\nint main()\n{\n    std::cout &lt;&lt; STRINGIFY(HEAD(LIST)) &lt;&lt; std::endl;\n    std::cout &lt;&lt; STRINGIFY(TAIL(LIST)) &lt;&lt; std::endl;\n}\n</code></pre>\n\n<p>Basically, you need to get tricky with how you call macros.<br>\nTake for example:  </p>\n\n<pre><code>HEAD((1)(2))\n</code></pre>\n\n<p>expands to</p>\n\n<pre><code>KEEP (1)(2) )\n</code></pre>\n\n<p>which expands to</p>\n\n<pre><code>1 EAT2 ((2))\n</code></pre>\n\n<p>which expands to</p>\n\n<pre><code>1\n</code></pre>\n\n<p>This isn't a full answer, but I think can be a starting point for what you want to to do.</p>\n\n<p><strong>EDIT</strong>  </p>\n\n<p>I have now figured out how BOOST.PP does its iterations and it's not pretty, you basically manually write out iterations up to some maximum size.  </p>\n\n<pre><code>#define CONCAT2(x, y) x##y\n#define CONCAT(x, y) CONCAT2(x, y)\n\n#define SEQ_SIZE(seq) CONCAT(SEQ_SIZE_, SEQ_SIZE_0 seq)\n\n# define SEQ_SIZE_0(_) SEQ_SIZE_1\n# define SEQ_SIZE_1(_) SEQ_SIZE_2\n# define SEQ_SIZE_2(_) SEQ_SIZE_3\n# define SEQ_SIZE_3(_) SEQ_SIZE_4\n# define SEQ_SIZE_4(_) SEQ_SIZE_5\n# define SEQ_SIZE_5(_) SEQ_SIZE_6\n# define SEQ_SIZE_6(_) SEQ_SIZE_7\n# define SEQ_SIZE_7(_) SEQ_SIZE_8\n# define SEQ_SIZE_8(_) SEQ_SIZE_9\n# define SEQ_SIZE_9(_) SEQ_SIZE_10\n# define SEQ_SIZE_10(_) SEQ_SIZE_11\n# define SEQ_SIZE_SEQ_SIZE_0 0\n# define SEQ_SIZE_SEQ_SIZE_1 1\n# define SEQ_SIZE_SEQ_SIZE_2 2\n# define SEQ_SIZE_SEQ_SIZE_3 3\n# define SEQ_SIZE_SEQ_SIZE_4 4\n# define SEQ_SIZE_SEQ_SIZE_5 5\n# define SEQ_SIZE_SEQ_SIZE_6 6\n# define SEQ_SIZE_SEQ_SIZE_7 7\n# define SEQ_SIZE_SEQ_SIZE_8 8\n# define SEQ_SIZE_SEQ_SIZE_9 9\n# define SEQ_SIZE_SEQ_SIZE_10 10\n\n#define MAKE_VAR(elem)                         \\\n    float CONCAT(var_, elem) = 0;\n\n#define MAKE_LIST_0(op, list)\n#define MAKE_LIST_1(op, list)  op (HEAD(list)) MAKE_LIST_0(op, TAIL(list))\n#define MAKE_LIST_2(op, list)  op (HEAD(list)) MAKE_LIST_1(op, TAIL(list))\n#define MAKE_LIST_3(op, list)  op (HEAD(list)) MAKE_LIST_2(op, TAIL(list))\n#define MAKE_LIST_4(op, list)  op (HEAD(list)) MAKE_LIST_3(op, TAIL(list))\n#define MAKE_LIST_5(op, list)  op (HEAD(list)) MAKE_LIST_4(op, TAIL(list))\n#define MAKE_LIST_6(op, list)  op (HEAD(list)) MAKE_LIST_5(op, TAIL(list))\n#define MAKE_LIST_7(op, list)  op (HEAD(list)) MAKE_LIST_6(op, TAIL(list))\n#define MAKE_LIST_8(op, list)  op (HEAD(list)) MAKE_LIST_7(op, TAIL(list))\n#define MAKE_LIST_9(op, list)  op (HEAD(list)) MAKE_LIST_8(op, TAIL(list))\n#define MAKE_LIST_10(op, list)  op (HEAD(list)) MAKE_LIST_9(op, TAIL(list))\n\n#define MAKE_LIST(op, list) CONCAT(MAKE_LIST_, SEQ_SIZE(list)) (op, list)\n\nint main()\n{\n    MAKE_LIST(MAKE_VAR, LIST)\n}\n</code></pre>\n\n<p>Running the preprocessor on this gives the following:</p>\n\n<pre><code>int main()\n{\n    float var_1 = 0; float var_2 = 0; float var_3 = 0; float var_4 = 0; float var_5 = 0;\n}\n</code></pre>\n\n<p>As desired. I'm sure this could be streamlined a bit, but I hope this helps.</p>\n"}, {"tags": [], "owner": {"reputation": 7813, "user_id": 271781, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de16842ae94ddafdf546d5b7e5e21e62?s=128&d=identicon&r=PG", "display_name": "daminetreg", "link": "https://stackoverflow.com/users/271781/daminetreg"}, "is_accepted": false, "score": 0, "last_activity_date": 1516266332, "creation_date": 1516266332, "answer_id": 48317389, "question_id": 48307385, "link": "https://stackoverflow.com/questions/48307385/how-does-boost-pp-seq-fold-left-work/48317389#48317389", "title": "How does BOOST_PP_SEQ_FOLD_LEFT work?", "body": "<p>Here are my little 2 cents:</p>\n\n<p>The problem in my remembering from the preprocessor metaprogramming techniques used in Boost.Preprocessor is that having an arbitrary long list of element is not possible when folding over a sequence.</p>\n\n<p>You need to have as much macros as maximum iteration, so it can be arbitrary but to some maximum.</p>\n\n<p>I wonder however if you could even expand commas, because typically this is based on concatenating with what comes next to either a stop condition macro or a next iteration macro. And I don't see how it's possible to expands commas from a concatenated macro as the concatenation won't work anymore.</p>\n\n<p>What I would do for this case, if you can change a bit the API is  : </p>\n\n<pre><code>#define EXPAND(...) __VA_ARGS__\n\n#define template_(X, Y)   \\\n  template&lt;EXPAND X       \\\n    , int dummy = 0       \\\n  Y                       \\\n&gt;\n\n#define requires(...) \\\n  COMMA() std::enable_if_t&lt; dummy == 0 &amp;&amp; (__VA_ARGS__) &gt; = 0  \n\n#define COMMA() ,\n</code></pre>\n\n<p>So with a slighlty changed API : </p>\n\n<pre><code>template_((class A, class B, class C),\n    requires(IsFoo&lt;A&gt; &amp;&amp; IsBar&lt;B&gt;)\n    requires(IsBaz&lt;C&gt;)\n)\nvoid frobozzle(A, B, C);\n</code></pre>\n\n<p>It outputs to what was wished :</p>\n\n<pre><code>template&lt;class A, class B, class C , \n  int dummy = 0 , \n  std::enable_if_t&lt; dummy == 0 &amp;&amp; (IsFoo&lt;A&gt; &amp;&amp; IsBar&lt;B&gt;) &gt; = 0 ,\n  std::enable_if_t&lt; dummy == 0 &amp;&amp; (IsBaz&lt;C&gt;) &gt; = 0 &gt;\nvoid frobozzle(A, B, C);\n</code></pre>\n\n<p>Is not exactly the requested API, but the advantage is that you can have requires expression with commas thanks to the requires macros which uses <strong>VA_ARGS</strong> : </p>\n\n<pre><code>template_((class A, class B, class C),\n    requires(IsBaseOf&lt;B,C&gt;)\n)\nint boo()\n</code></pre>\n\n<p>I tried hard to make an unlimited FOLD_LEFT and it doesn't looks like to be in my reach :D.</p>\n\n<p>What I didn't try is reproducing the same input syntax as you provided with expression templates, which sounds to me finally more doable.</p>\n"}, {"comments": [{"owner": {"reputation": 5285, "user_id": 195873, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53912b2e0cc619ca6c81ab1406522c2a?s=128&d=identicon&r=PG", "display_name": "Eric Niebler", "link": "https://stackoverflow.com/users/195873/eric-niebler"}, "edited": false, "score": 1, "creation_date": 1516316198, "post_id": 48326119, "comment_id": 83649067, "body": "Pretty nice! :-)"}, {"owner": {"reputation": 7813, "user_id": 271781, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de16842ae94ddafdf546d5b7e5e21e62?s=128&d=identicon&r=PG", "display_name": "daminetreg", "link": "https://stackoverflow.com/users/271781/daminetreg"}, "edited": false, "score": 0, "creation_date": 1516370965, "post_id": 48326119, "comment_id": 83671164, "body": "Really nice, I tried similarly but never got the <code>#define template_impl_ADD_END2(...) __VA_ARGS__ ## _END</code> working as I implemented it like <code>BOOST_PP_CAT(requiresclauses , _end)</code> and because requiresclauses where expanding comma it didn&#39;t work.It&#39;s pretty good how you solved it."}], "tags": [], "owner": {"reputation": 815, "user_id": 1150292, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VQ2aZ.jpg?s=128&g=1", "display_name": "Mara Bos", "link": "https://stackoverflow.com/users/1150292/mara-bos"}, "is_accepted": true, "score": 13, "last_activity_date": 1516296308, "last_edit_date": 1516296308, "creation_date": 1516293279, "answer_id": 48326119, "question_id": 48307385, "link": "https://stackoverflow.com/questions/48307385/how-does-boost-pp-seq-fold-left-work/48326119#48326119", "title": "How does BOOST_PP_SEQ_FOLD_LEFT work?", "body": "<p>If you add an extra set of parentheses in your syntax, it's possible without a limit on the number of 'required' clauses, with relatively few macros:</p>\n\n<pre><code>template_((class A, class B, class C)\n    (requires IsFoo&lt;A&gt; &amp;&amp; IsBar&lt;B&gt;)\n    (requires IsBaz&lt;C&gt;)\n)\nvoid frobozzle(A, B, C);\n</code></pre>\n\n<p>Macros:</p>\n\n<pre><code>#define template_(...) template_impl_ADD_END(template_impl_LIST __VA_ARGS__) &gt;\n\n#define template_impl_ADD_END(...) template_impl_ADD_END2(__VA_ARGS__)\n#define template_impl_ADD_END2(...) __VA_ARGS__ ## _END\n\n#define template_impl_LIST(...) template&lt;__VA_ARGS__, int dummy = 0 template_impl_LIST_1\n\n#define template_impl_LIST_1(...) , std::enable_if_t&lt;dummy == 0 &amp;&amp; template_impl_REQUIRES(__VA_ARGS__), int&gt; = 0 template_impl_LIST_2\n#define template_impl_LIST_2(...) , std::enable_if_t&lt;dummy == 0 &amp;&amp; template_impl_REQUIRES(__VA_ARGS__), int&gt; = 0 template_impl_LIST_1\n\n#define template_impl_REQUIRES(...) (template_impl_REQUIRES_ ## __VA_ARGS__)\n#define template_impl_REQUIRES_requires\n\n#define template_impl_LIST_END\n#define template_impl_LIST_1_END\n#define template_impl_LIST_2_END\n</code></pre>\n\n<p>With these macros, the example above expands to:</p>\n\n<pre><code>template &lt;class A, class B, class C,\n          int dummy = 0,\n          std::enable_if_t&lt;dummy == 0 &amp;&amp; (IsFoo&lt;A&gt; &amp;&amp; IsBar&lt;B&gt;), int&gt; = 0,\n          std::enable_if_t&lt;dummy == 0 &amp;&amp; (IsBaz&lt;C&gt;), int&gt; = 0&gt;\n\nvoid frobozzle(A, B, C);\n</code></pre>\n\n<h1>Explanation</h1>\n\n<p>Consider these macros:</p>\n\n<pre><code>#define a(x) [x] b\n#define b(x) [x] a\n</code></pre>\n\n<p>With these, this:</p>\n\n<pre><code>a (1) (2) (3) (4)\n</code></pre>\n\n<p>Will cause a 'chain reaction' of expansion as follows:</p>\n\n<pre><code>a (1) (2) (3) (4)\n[1] b (2) (3) (4)\n[1] [2] a (3) (4)\n[1] [2] [3] b (4)\n[1] [2] [3] [4] a\n</code></pre>\n\n<p>Recursion isn't allowed in the preprocessor, but this type of chain reaction isn't recursion since the invocation of the macro only happens after expansion of the previous one, not during, since the <code>(</code> isn't part of the expansion. (Although, see <a href=\"https://wg21.link/cwg268\" rel=\"noreferrer\">https://wg21.link/cwg268</a>)</p>\n\n<p>Unfortunately, although this will nicely loop over a sequence of <code>(A)(B)(C)</code>, it'll leave an extra token at the end: the name of one of the two used macros. The trick I used to get rid of that one, is to wrap the entire list with another macro invocation, that will append (with the concat operator <code>##</code>) <code>_END</code> after the full expansion, so it will become:</p>\n\n<pre><code>[1] [2] [3] [4] a_END\n</code></pre>\n\n<p>Then we can simply get rid of this last token by defining:</p>\n\n<pre><code>#define a_END\n#define b_END\n</code></pre>\n\n<p>If we can't wrap the entire list, there's no way to know when we've reached the last element. The only thing that happens is that the last <code>a</code> or <code>b</code> is left over without a <code>(</code> that follows it, meaning that it simply won't expand, as <code>a</code> and <code>b</code> are function-style macros. (And we can't just define <code>a</code> and <code>b</code> to expand to nothing, because <code>a</code> and <code>b</code> are already macros, although they won't expand without a <code>(</code>.)</p>\n\n<h2>Why two macros?</h2>\n\n<p>When we try to cause a chain reaction like the above, with just one macro like this:</p>\n\n<pre><code>#define a(x) [x] a\n</code></pre>\n\n<p>It won't work:</p>\n\n<pre><code>a (1) (2) (3) (4)\n[1] a (2) (3) (4) // Doesn't expand further\n</code></pre>\n\n<p>This is because of how the '(infinite) recursion protection' works: If during the expansion of a macro, a token with the name of the macro being expanded is produced, it is marked as 'unexpandable', meaning that it will never ever expand again. See <a href=\"http://eel.is/c++draft/cpp.rescan#2\" rel=\"noreferrer\">http://eel.is/c++draft/cpp.rescan#2</a></p>\n\n<p>This means that the expanded <code>a</code> is marked as 'unexpandable', and our chain reaction stops right there after the first step. We avoid this by using two macros to work around this rule: <code>a(..)</code> will not produce any token with its own name, but only with the name of the other macro <code>b</code>. The expansion of <code>a</code> ends right there, before <code>b</code> is expanded, because there is no <code>(</code> yet after b, since we're 'inside' the expansion of a. After the expansion is done, and we're no longer 'inside' <code>a</code>, the tokens get re-examined, and a proper invocation of <code>b</code> is found: <code>b(..)</code>. That one will produce a token with the name of <code>a</code> again, but since we're no longer in the expansion of the first <code>a</code>, this one will not be marked as 'unexpandable', and the chain reaction continues.</p>\n"}], "owner": {"reputation": 5285, "user_id": 195873, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53912b2e0cc619ca6c81ab1406522c2a?s=128&d=identicon&r=PG", "display_name": "Eric Niebler", "link": "https://stackoverflow.com/users/195873/eric-niebler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 770, "favorite_count": 5, "accepted_answer_id": 48326119, "answer_count": 3, "score": 11, "last_activity_date": 1516296308, "creation_date": 1516212444, "last_edit_date": 1516217354, "question_id": 48307385, "link": "https://stackoverflow.com/questions/48307385/how-does-boost-pp-seq-fold-left-work", "title": "How does BOOST_PP_SEQ_FOLD_LEFT work?", "body": "<p>I need to write a macro that processes an arbitrarily long list of things like <code>(A)(B)(C)</code>. If I could take a Boost dependency, I would just use one of the <a href=\"http://www.boost.org/doc/libs/1_62_0/libs/preprocessor/doc/data/sequences.html\" rel=\"noreferrer\"><code>BOOST_PP_SEQ_</code></a> family of macros. Unfortunately, I can't so I am left trying to figure out how it works. This Stuff Is Not Obvious.</p>\n\n<p>Can anybody here write a simple, stand-alone implementation of, say, <a href=\"http://www.boost.org/doc/libs/1_62_0/libs/preprocessor/doc/ref/seq_fold_left.html\" rel=\"noreferrer\"><code>BOOST_PP_SEQ_FOLD_LEFT</code></a> for me to look at? In particular, I would like to transform:</p>\n\n<pre><code>template_(class A, class B, class C)(\n    requires IsFoo&lt;A&gt; &amp;&amp; IsBar&lt;B&gt;)(\n    requires IsBaz&lt;C&gt;)\nvoid frobozzle(A, B, C);\n</code></pre>\n\n<p>to be rewritten as:</p>\n\n<pre><code>template&lt;class A, class B, class C,\n    int dummy = 0,\n    std::enable_if_t&lt;dummy == 0 &amp;&amp; (IsFoo&lt;A&gt; &amp;&amp; IsBar&lt;B&gt;), int&gt; = 0,\n    std::enable_if_t&lt;dummy == 0 &amp;&amp; (IsBaz&lt;C&gt;), int&gt; = 0&gt;\nvoid frobozzle(A, B, C);\n</code></pre>\n\n<p>There could be an arbitrary number of <code>requires</code> clauses, and they should each get their own <code>enable_if_t</code>. I have it working with one <code>requires</code> clause, but I exhausted my C preprocessor-fu in the process.</p>\n\n<p>It's OK to assume a std-compliant preprocessor, since I don't need MSVC support.</p>\n"}, {"tags": ["c", "while-loop", "variable-assignment"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1516212291, "post_id": 48307219, "comment_id": 83599983, "body": "No, the logic is not exactly correct. The pointers are always incremented at least once. What is &quot;do stuff&quot;? The original loop has no body. If you add one, then the placement of &quot;stuff&quot; is incorrect. Also <code>*x++;</code> on its own has a useless <code>*</code>."}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1516212670, "post_id": 48307219, "comment_id": 83600176, "body": "the thing you missed is that your original while loop is <i>copying</i> src to dst (till it hit null terminator), it is not simply a different syntax for a for loop."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1516253531, "post_id": 48307219, "comment_id": 83614532, "body": "I&#39;d use <code>while ((*dst++ = *src++) != &#39;\\0&#39;) ;</code> with the semicolon on the next line on its own.  It makes explicit that the result of the assignment is compared with zero (which is what the compiler has to do anyway \u2014 it doesn&#39;t add anything to the object code)."}], "answers": [{"comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1516213761, "post_id": 48307321, "comment_id": 83600749, "body": "I agree that that&#39;s better, inasmuch as it separates the pointer increment operations from the dereferences and assignment.  But it still uses the value of the assignment expression in boolean context, which I&#39;d argue is an even bigger readability problem."}], "tags": [], "owner": {"reputation": 11238, "user_id": 7594711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7872c871b0431b72df6350dd0394bea?s=128&d=identicon&r=PG&f=1", "display_name": "SoronelHaetir", "link": "https://stackoverflow.com/users/7594711/soronelhaetir"}, "is_accepted": false, "score": 0, "last_activity_date": 1516212581, "last_edit_date": 1516212581, "creation_date": 1516212172, "answer_id": 48307321, "question_id": 48307219, "link": "https://stackoverflow.com/questions/48307219/using-the-assignment-operator-in-a-while-loop-condition-in-c/48307321#48307321", "title": "Using the assignment operator in a while loop condition in C", "body": "<p>Your understanding of what the loop does is correct, but not your understanding of the post-increment, the post-increment has higher precedence than the *, so in the original while loop the post-increment increments the pointers (returning the original values), then dereferences those pointers assigning original *src to original *dest.</p>\n\n<p>I suggest doing it as a for loop (although the original is already highly idiomatic):</p>\n\n<pre><code>for( ; *dst = *src; ++dst, ++src)\n{ }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "is_accepted": false, "score": 3, "last_activity_date": 1516214744, "last_edit_date": 1516214744, "creation_date": 1516212188, "answer_id": 48307326, "question_id": 48307219, "link": "https://stackoverflow.com/questions/48307219/using-the-assignment-operator-in-a-while-loop-condition-in-c/48307326#48307326", "title": "Using the assignment operator in a while loop condition in C", "body": "<p>Yes this is exactly what is being done (<code>char</code>s are copied along with null terminator) on the one-line code. But in your code </p>\n\n<pre><code>*dst++;\n*src++;\n</code></pre>\n\n<p>can be replaced by</p>\n\n<pre><code>dst++;\nsrc++;\n</code></pre>\n\n<p>You have <strong>dereferenced it unnecessarily</strong>. </p>\n\n<p>To explain a bit further the value assigned is the value of the assignment expression which is being checked in the while condition which when turns out to be <code>\\0</code> terminates the loop but the <code>\\0</code> is copied in the <code>dst</code> also.</p>\n\n<p>The implementation you wrote also will do one check and one assignment even if it is empty string just like the original one.</p>\n\n<p>And yes in your case, the post increment or pre increment doesn't matter but in original implementation <strong><em>it does</em></strong>. </p>\n\n<p>By the last line I meant,<code>++dst;++src;</code><em>will be <strong>same</strong> as</em> <code>dst++;src++;</code> in <strong><em>your</em></strong> case.</p>\n\n<p>But in original implementation if you have used </p>\n\n<pre><code>*++dst = *++src\n</code></pre>\n\n<p>This would be <strong>wrong and meaningless</strong> for the purpose of copying. Think of the case when it is empty string. You will access array index out of bound.</p>\n\n<hr>\n\n<blockquote>\n<pre><code>while(*dst++ = *src++);\n</code></pre>\n</blockquote>\n\n<p>This is <strong>readable</strong> - in fact for the second code you wrote I have to think twice of the edge cases - here it is clean simple logic. Less code Less confusion. <em>Readability doesn't mean  more code - it is the clean code which is more readable.</em> </p>\n"}, {"tags": [], "owner": {"reputation": 9645, "user_id": 1465553, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/5b559f395549789c041652429444dc0a?s=128&d=identicon&r=PG", "display_name": "Saurav Sahu", "link": "https://stackoverflow.com/users/1465553/saurav-sahu"}, "is_accepted": false, "score": 1, "last_activity_date": 1516215729, "last_edit_date": 1516215729, "creation_date": 1516212538, "answer_id": 48307398, "question_id": 48307219, "link": "https://stackoverflow.com/questions/48307219/using-the-assignment-operator-in-a-while-loop-condition-in-c/48307398#48307398", "title": "Using the assignment operator in a while loop condition in C", "body": "<pre><code>   *dst++;\n   *src++;\n</code></pre>\n\n<p>is same as </p>\n\n<pre><code>   *dst; &lt;&lt;dereferencing for no use. \n    dst++;  \n   *src; &lt;&lt;dereferencing for no use.\n    src++;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 1, "last_activity_date": 1516213921, "last_edit_date": 1516213921, "creation_date": 1516213619, "answer_id": 48307689, "question_id": 48307219, "link": "https://stackoverflow.com/questions/48307219/using-the-assignment-operator-in-a-while-loop-condition-in-c/48307689#48307689", "title": "Using the assignment operator in a while loop condition in C", "body": "<blockquote>\n  <p>By assigning *src to *dst, it is checking if *dst (and, by extension,\n  *src) is a non-zero (or zero) value. If non-zero, the while body is executed, otherwise it is skipped.</p>\n</blockquote>\n\n<p>That's correct as far as it goes, but as far as the <em>purpose</em> of such code goes, it misses the point.  A high-level description of the function of the code would be: copy successive elements of the array pointed into by <code>src</code> to successive elements of the array pointed into by <code>dst</code> until an element with value 0 has been copied.  In particular, if <code>src</code> and <code>dst</code> are pointers to <code>char</code> then this is a possible implementation of the <code>strcpy()</code> function.</p>\n\n<p>But your characterization does not describe <em>all</em> the effects of the code, which include incrementing the <code>src</code> and <code>dst</code> pointers to one position past the last element copied.  Your version does not match this.  Moreover, your version is a bit odd in how it performs the pointer increments, in that after it performs the increments, it pointlessly dereferences the new pointer values and ignores the results.  <em>That's</em> not good style.</p>\n\n<p>There are a lot of alternatives that I would consider more readable, but your instructor may be looking for some particular characteristics.  I expect first of all that they would want a version that does not use an assignment expression in boolean context.  I imagine that they would also want to see the pointer dereferences and pointer increments performed in separate expressions.  Here's a version that has those characteristics, that produces all the side effects of the original code, and that minimizes code duplication:</p>\n\n<pre><code>do {\n    *dst = *src;\n    dst++;\n    src++;\n} while (*(src - 1));\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1516216033, "post_id": 48307987, "comment_id": 83601941, "body": "Hmm, I seem to remember that <code>char c</code> wouldn&#39;t be in scope for the <code>while ( c )</code>."}, {"owner": {"reputation": 26704, "user_id": 1202830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bd22084046f375b15ff56ffae8237b0?s=128&d=identicon&r=PG", "display_name": "Michael Geary", "link": "https://stackoverflow.com/users/1202830/michael-geary"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1516216274, "post_id": 48307987, "comment_id": 83602066, "body": "Oh, good catch, thanks. I updated it to fix that. Of course that also meant I had to add another pair of curly braces to keep the variable <code>c</code> local to this bit of code. Whew!"}], "tags": [], "owner": {"reputation": 26704, "user_id": 1202830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bd22084046f375b15ff56ffae8237b0?s=128&d=identicon&r=PG", "display_name": "Michael Geary", "link": "https://stackoverflow.com/users/1202830/michael-geary"}, "is_accepted": false, "score": 2, "last_activity_date": 1516216784, "last_edit_date": 1516216784, "creation_date": 1516214757, "answer_id": 48307987, "question_id": 48307219, "link": "https://stackoverflow.com/questions/48307219/using-the-assignment-operator-in-a-while-loop-condition-in-c/48307987#48307987", "title": "Using the assignment operator in a while loop condition in C", "body": "<p>As you may know, the original loop is a common C idiom for copying a zero-terminated string. Any C programmer should recognize it at a glance. So in that sense it it already quite readable.</p>\n\n<p>The revised version is harder to understand, with the repeated assignment outside and inside the loop.</p>\n\n<p>If you want to write it out step by step in the most detailed manner possible, while also keeping exactly the same behavior as the original, I suggest this, assuming that <code>src</code> and <code>dst</code> are <code>char*</code> pointers.</p>\n\n<pre><code>// This extra pair of curly braces keeps the `char c` local to this code\n{\n    char c;  // Change this if the type is different\n    do {\n        c = *src;\n        *dst = c;\n        src = src + 1;\n        dst = dst + 1;\n    } while( c );\n}\n</code></pre>\n\n<p>BTW one problem with the original is that many modern C compilers will issue a warning on the assignment, the idea being that it may be a typo for an intended <code>==</code> comparison. You can usually suppress this warning with an extra set of parentheses:</p>\n\n<pre><code>while(( *dst++ = *src++ )) ;\n</code></pre>\n"}], "owner": {"reputation": 321, "user_id": 5998360, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/0c5140df967f69eac3c3de6ca4c63f33?s=128&d=identicon&r=PG&f=1", "display_name": "so8857", "link": "https://stackoverflow.com/users/5998360/so8857"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1256, "favorite_count": 0, "answer_count": 5, "score": 2, "last_activity_date": 1516216784, "creation_date": 1516211774, "last_edit_date": 1516212173, "question_id": 48307219, "link": "https://stackoverflow.com/questions/48307219/using-the-assignment-operator-in-a-while-loop-condition-in-c", "title": "Using the assignment operator in a while loop condition in C", "body": "<p>The question is:</p>\n\n<p>Rewrite the following C code in a more readable style:</p>\n\n<pre><code>while (*dst++ = *src++);\n</code></pre>\n\n<p>I want to check that I am understanding this line correctly. By assigning *src to *dst, it is checking if *dst (and, by extension, *src) is a non-zero (or zero) value. If non-zero, the <code>while</code> body is executed, otherwise it is skipped. </p>\n\n<p>My answer, based on the above understanding:</p>\n\n<pre><code>*dst = *src;\nwhile (*dst) {\n   [do stuff]\n   *dst++;\n   *src++;\n   *dst = *src;\n}\n</code></pre>\n\n<p>I realize that the position of the post-increment for both variables is important for a real program, but I don't think it matters here. </p>\n"}, {"tags": ["c", "file", "encryption"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 2, "creation_date": 1516211612, "post_id": 48307002, "comment_id": 83599624, "body": "<code>fopen</code> and other functions like that will return errors. Check for those."}, {"owner": {"reputation": 11238, "user_id": 7594711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7872c871b0431b72df6350dd0394bea?s=128&d=identicon&r=PG&f=1", "display_name": "SoronelHaetir", "link": "https://stackoverflow.com/users/7594711/soronelhaetir"}, "edited": false, "score": 0, "creation_date": 1516211773, "post_id": 48307002, "comment_id": 83599709, "body": "If your program works when run from the debugger or when you run it yourself I suspect (though do not know for sure) that it is a matter of where files are being placed, that when the checker runs the files are in fact created, just not where you expect them to be."}, {"owner": {"reputation": 11, "user_id": 9223487, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-k-6iAwDCGts/AAAAAAAAAAI/AAAAAAAADqI/JBW5afgN4l8/photo.jpg?sz=128", "display_name": "Stefan Apostolescu", "link": "https://stackoverflow.com/users/9223487/stefan-apostolescu"}, "reply_to_user": {"reputation": 11238, "user_id": 7594711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7872c871b0431b72df6350dd0394bea?s=128&d=identicon&r=PG&f=1", "display_name": "SoronelHaetir", "link": "https://stackoverflow.com/users/7594711/soronelhaetir"}, "edited": false, "score": 1, "creation_date": 1516213537, "post_id": 48307002, "comment_id": 83600645, "body": "Thanks both @SoronelHaetir and @-tadman . The function fopen does not return any error. I think he is making the files in other directories but still cannot find out why. Thanks for helping me !"}, {"owner": {"reputation": 6882, "user_id": 3403834, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xpA5S.jpg?s=128&g=1", "display_name": "user58697", "link": "https://stackoverflow.com/users/3403834/user58697"}, "edited": false, "score": 0, "creation_date": 1516216790, "post_id": 48307002, "comment_id": 83602311, "body": "Looks like checker passes arguments in the different order. You should not treat them as positional, but parse the command line properly and rely on the options (<code>-in</code>, <code>-out</code>, <code>-key</code>, etc)."}], "owner": {"reputation": 11, "user_id": 9223487, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-k-6iAwDCGts/AAAAAAAAAAI/AAAAAAAADqI/JBW5afgN4l8/photo.jpg?sz=128", "display_name": "Stefan Apostolescu", "link": "https://stackoverflow.com/users/9223487/stefan-apostolescu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 111, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1516253248, "creation_date": 1516210985, "last_edit_date": 1516253248, "question_id": 48307002, "link": "https://stackoverflow.com/questions/48307002/program-does-not-create-output-file", "title": "Program does not create output file", "body": "<p>I have to write a program that receives the arguments (<strong>ex: <code>-in cypher/in/in2.txt -out cypher/out/out2.txt -key 0 -mode enc -alg  caesar</code></strong>) and it has to do the encrypt/decrypt operation on the text from \"in\" file and print the output in the \"out\" file.</p>\n\n<p>Because we are many students, to check our programs, the teacher has made/downloaded a program \"checker\" that gives 7 tests like the one from the example and compares the output file with one called ref file. \nI've done the encrypt algorithms but I've met a problem: when I run the tests \"manually\" (from cmd -introducing parameters, or just inserting them in vs-proprieties-debugging) the program works well. It creates the output files, exactly as the one from ref. But when I run the checker, the program doesn't create the output files.</p>\n\n<p>I've noticed something interesting,in the folder where I have the source, after I run the checker it appears some files, with the name of some arguments (<strong>ex: <code>-hint</code>, <code>-alg</code>, with no extension</strong>) that contain what should be in the output file. I've used debugging in VS and checked the name of the output file and it is correct. But still when I run it \"manually\" the files are build correctly and when using the checker it doesn't even create them.(the program was verified by some friend and it seems no to have any writing issues).</p>\n\n<p><a href=\"https://i.stack.imgur.com/nHTSy.png\" rel=\"nofollow noreferrer\">here is a pic with the folder created after running the checker</a></p>\n\n<p>Here I've rebuild the first part of the program just to solve the output problem; it's not the full program, but at the first test, in the checker it should return :Missing input file!</p>\n\n<pre><code>void ordonare_argumente(int n, char *p[]) {\n    int v[20];\n    int g[20], k = 0;\n    for (int i = 1; i &lt; n; i++)\n    {\n        int sum = 0;\n        char *j;\n        j = p[i];\n        if (j[0] == '-') {\n            for (size_t u = 1; u &lt; strlen(j); u++)\n                sum = sum + j[u];\n            k++;\n            v[k] = sum;\n            g[k] = i;\n\n        }\n    }\n    for (int i = 1; i &lt;= k - 1; i++)\n        for (int j = i + 1; j &lt;= k; j++)\n            if (v[i] &gt; v[j]) {\n                char **pahar = (char**)malloc(1000);\n                int aux = v[i];\n                v[i] = v[j];\n                v[j] = aux;\n\n                pahar[g[i]] = p[g[j]];\n                p[g[j]] = p[g[i]];\n                p[g[i]] = pahar[g[i]];\n\n                pahar[g[i] + 1] = p[g[j] + 1];\n                p[g[j] + 1] = p[g[i] + 1];\n                p[g[i] + 1] = pahar[g[i] + 1];\n                free(pahar);\n\n            }\n}\n</code></pre>\n\n<p>The function from above sorts the arguments by the ASCII sum and what's immediate after so that I know the exact meaning of each argument</p>\n\n<pre><code>int main(int argc, char *argv[]) {\n    char f_out[30];\n    FILE *intrare;\n\n    ordonare_argumente(argc, argv);\n\n    if (argc != 11)  strcpy(f_out, argv[4]);\n    else strcpy(f_out, argv[8]);\n    if ((intrare = fopen(argv[2], \"r\")) == NULL) {\n        FILE *iesire = fopen(f_out, \"w\");\n        fprintf(iesire, \"Missing the input file\");\n    }\n\n    for (int i = 0; i &lt; argc; i++)\n        printf(\"argumentul nr %d este:%s\\n \", i, argv[i]);\n\n    return(0);\n}\n</code></pre>\n"}, {"tags": ["c", "gcc", "x86-64", "inline-assembly"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2404501"}, "edited": false, "score": 0, "creation_date": 1516210770, "post_id": 48306932, "comment_id": 83599122, "body": "IA-64 is Itanium, not x86_64. In the linked gcc documentation, the x86 section covers both x86_32 (a.k.a. IA-32 a.k.a. i386) and x86_64 (a.k.a. amd64)"}, {"owner": {"reputation": 1048, "user_id": 1250984, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/521df281c0905011eddc34b42df02bff?s=128&d=identicon&r=PG", "display_name": "Maxthecat", "link": "https://stackoverflow.com/users/1250984/maxthecat"}, "edited": false, "score": 0, "creation_date": 1516210928, "post_id": 48306932, "comment_id": 83599231, "body": "Whoops! That was the entirety of the mistake. x86 family specifies those modifiers go to those registers. Thanks!"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 2, "creation_date": 1516212341, "post_id": 48306932, "comment_id": 83600016, "body": "That&#39;s badly-written asm.  It clobbers <code>%rbx</code> without telling the compiler about it.  (Of course, when used for the Meltdown vulnerability, the architectural state after this statement doesn&#39;t matter, because the <code>movb</code> faults).  However, the whole loop to retry on zero is probably not needed; AFAICT it&#39;s based on a misunderstanding by the authors of the Meltdown paper from looking at Linux core-dumps where <code>rax</code> is always zero.  (Of course it is, because the <code>movb</code> faults so it still has its xor-zero value).  Also, <code>movzbl (%%rcx), %eax</code> would do the same thing without needing xor-zeroing."}, {"owner": {"reputation": 33092, "user_id": 5801661, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D8ENZ.jpg?s=128&g=1", "display_name": "Margaret Bloom", "link": "https://stackoverflow.com/users/5801661/margaret-bloom"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1516267725, "post_id": 48306932, "comment_id": 83621131, "body": "@PeterCordes Yes! Finally! That retry-on-zero always bugged me when reading the Metldown paper but I&#39;ve always been too afraid to dispute it."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 33092, "user_id": 5801661, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D8ENZ.jpg?s=128&g=1", "display_name": "Margaret Bloom", "link": "https://stackoverflow.com/users/5801661/margaret-bloom"}, "edited": false, "score": 0, "creation_date": 1516276568, "post_id": 48306932, "comment_id": 83626689, "body": "@MargaretBloom: I mentioned that in an email to the authors of the Meltdown authors (along with some other stuff).  I heard back from Werner Haas who said my analysis sounded right; so I guess they had been confused by the crash-dump register value, and thought it was always zero because something was forcing it to zero, rather than it was still zero because exceptions are taken <i>before</i> the faulting instruction completes (architecturally).  Hopefully when they have time to revise their rushed paper, they&#39;ll remove the loop and simplify to <code>movzx</code> instead of merging with the old <code>rax</code>."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 33092, "user_id": 5801661, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D8ENZ.jpg?s=128&g=1", "display_name": "Margaret Bloom", "link": "https://stackoverflow.com/users/5801661/margaret-bloom"}, "edited": false, "score": 0, "creation_date": 1516276761, "post_id": 48306932, "comment_id": 83626822, "body": "@MargaretBloom: But until then, see <a href=\"https://security.stackexchange.com/questions/177100/why-are-amd-processors-not-less-vulnerable-to-meltdown-and-spectre/177101#177101\">my (untested) Meltdown sequence of instructions</a> which should work just as well (and includes a chain of 30x <code>sqrtpd</code> to delay retirement of the faulting load).  I hope the paper authors will copy it verbatim for an update to their paper.  (And Max: I&#39;d suggest porting that sequence to GNU C inline asm)."}], "owner": {"reputation": 1048, "user_id": 1250984, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/521df281c0905011eddc34b42df02bff?s=128&d=identicon&r=PG", "display_name": "Maxthecat", "link": "https://stackoverflow.com/users/1250984/maxthecat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 207, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1516219174, "creation_date": 1516210673, "last_edit_date": 1516219174, "question_id": 48306932, "link": "https://stackoverflow.com/questions/48306932/whats-the-purpose-of-these-assembly-register-modifiers", "title": "What&#39;s the purpose of these assembly register modifiers?", "body": "<p>I'm looking at some C code with inline x86_64 assembly.</p>\n\n<p>In the C-code, I see a couple of global declarations, with an assembly macro</p>\n\n<pre><code>static char *mem = NULL; // Gets malloc()'d before macro is called\nstatic size_t phys = 0;\n\n#define ASM_READ \\\n  asm volatile(\"xorq %%rax, %%rax\\n\",\n               \"1:\\n\"\n               \"movb (%%rcx), %%al\\n\"\n               \"shl $12, %%rax\\n\"\n               \"jz 1b\\n\"\n               \"movq (%%rbx, %%rax, 1), %%rbx\\n\"\n               :\n               : \"c\"(phys), \"b\"(mem)\n               : \"rax\");\n</code></pre>\n\n<p>This is then later called in the code as ASM_READ.</p>\n\n<p>My question is: how is it that rbx is getting loaded with the address of mem and rcx is loaded with the address of phys?</p>\n\n<p>The \"Intel IA-64\" machine constraints in the gcc compiler docs (<a href=\"https://gcc.gnu.org/onlinedocs/gcc/Machine-Constraints.html#Machine-Constraints\" rel=\"nofollow noreferrer\">https://gcc.gnu.org/onlinedocs/gcc/Machine-Constraints.html#Machine-Constraints</a>) list \"b\" as a branch regsiter and \"c\" as a conditional register. Still, I don't see how this is forcing the mem and phys into rbx and rcx, respectively</p>\n"}, {"tags": ["c", "memory", "struct", "bit-fields"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1516211157, "post_id": 48306842, "comment_id": 83599356, "body": "Do you know how negatives represented in C? Hint: The leftmost bit is the sign."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 4, "creation_date": 1516211171, "post_id": 48306842, "comment_id": 83599362, "body": "Almost everything about bit-fields is implementation defined.  When you store <code>13</code> into a 4-bit bit field, you may get a signed or an unsigned value stored.  <code>13</code> has the bit pattern <code>1101</code>; the high bit is set; it will be treated as negative if your plain <code>int</code> bit-fields are signed types.  If you want it unsigned, say so: <code>unsigned k:4;</code> (the <code>int</code> is optional in this context)."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1516211310, "post_id": 48306842, "comment_id": 83599449, "body": "@JonathanLeffler I am wondering if it is really possible to get positive <code>13</code> in the 4 bit field? How?"}, {"owner": {"reputation": 13, "user_id": 7496168, "user_type": "registered", "accept_rate": 17, "profile_image": "https://graph.facebook.com/770785556392763/picture?type=large", "display_name": "Zeyad Ibrahim", "link": "https://stackoverflow.com/users/7496168/zeyad-ibrahim"}, "edited": false, "score": 0, "creation_date": 1516211458, "post_id": 48306842, "comment_id": 83599527, "body": "so when an int is allocated using a bitfield it can contain negative number but why?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 3, "creation_date": 1516211503, "post_id": 48306842, "comment_id": 83599553, "body": "<a href=\"https://port70.net/~nsz/c/c11/n1570.html#note125\" rel=\"nofollow noreferrer\">C11 &#167;6.7.2.1 footnote 125</a> As specified in 6.7.2 above, if the actual type specifier used is <code>int</code> or a typedef-name defined as <code>int</code>, then it is implementation-defined whether the bit-field is signed or unsigned.  And <a href=\"https://port70.net/~nsz/c/c11/n1570.html#6.7.2p5\" rel=\"nofollow noreferrer\">C11 &#167;6.7.2</a> &#182;5 Each of the comma-separated multisets designates the same type, except that for bit-fields, it is implementation-defined whether the specifier <code>int</code> designates the same type as <code>signed int</code> or the same type as <code>unsigned int</code>."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 3, "creation_date": 1516211804, "post_id": 48306842, "comment_id": 83599728, "body": "Those notes means that you can&#39;t tell what value is stored in an <code>int x:1;</code> bit-field.  It can store zero or non-zero; you can&#39;t tell whether the non-zero is <code>-1</code> or <code>+1</code> except by reading the compiler documentation \u2014 or experimentation.  It has no portable interpretation, but that&#39;s hardly a major problem since bit-fields generally have no portable interpretation."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1516212261, "post_id": 48306842, "comment_id": 83599967, "body": "@ZeyadIbrahim: Normally, <code>int</code> means the same as <code>signed int</code>; bit-fields are the only place I can think of where it sometimes means the same as <code>unsigned int</code> \u2014 and that depends on your compiler.  So, by default, most people would expect an <code>int</code> member of a structure to be a signed quantity."}], "answers": [{"tags": [], "owner": {"reputation": 11619, "user_id": 5346306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BsACH.jpg?s=128&g=1", "display_name": "Achal", "link": "https://stackoverflow.com/users/5346306/achal"}, "is_accepted": false, "score": 1, "last_activity_date": 1516213336, "last_edit_date": 1516213336, "creation_date": 1516211871, "answer_id": 48307245, "question_id": 48306842, "link": "https://stackoverflow.com/questions/48306842/comparison-between-structs-in-c-using-bitfields/48307245#48307245", "title": "Comparison between structs in C using bitfields", "body": "<p><strong>Structure bit filed</strong> means reserving memory in terms of <strong>bits</strong> for data member of structure. While working on <code>bit-field</code> you should take care of <code>sign bit</code> if input is of <code>signed</code> type.</p>\n\n<p><strong>memory allocation for struc2</strong> : </p>\n\n<pre><code>typedef struct{\n        int i:1;\n        int k:4;\n        int x;\n}Struc2;\n</code></pre>\n\n<p><strong>1)</strong> For member <code>i</code> only <code>one bits</code> is reserved as</p>\n\n<pre><code> -------\n|  1    |\n -------\n        i\n        |\n        this is only first and last bit\n</code></pre>\n\n<p><code>int i : 1 ;</code> If there is no type mentioned for <strong>variable/constant</strong> then by default compiler will consider as <strong>signed</strong> type and if <strong>sign(MSB)</strong> bit of signed integer is <code>1</code> means it will be <strong>negative</strong> no. <code>2's complement</code> of <code>1</code> is <code>-1</code>. so <code>s2.i = -1</code></p>\n\n<p><strong>Note :</strong> In C, Negative no are stored in memory in form of <strong>two's complement</strong> </p>\n\n<p><strong>2)</strong> for member <code>k</code>, <code>4 bits</code> are reserved (in that you are storing <code>13</code>), it looks like below</p>\n\n<pre><code>       ---------------------------\n13 =&gt; | 1   |    1   |  0   |  1  |\n       ---------------------------\n       0x103  0x102   0x101  0x100                      \n        |\n      sign bit\n</code></pre>\n\n<p>In this case also <code>sign bit</code> is <code>1</code> so <code>s2.k</code> will be <strong>negative</strong> and how much ? take <strong>two's complement</strong>(one's complement + 1).</p>\n\n<pre><code>        13 =&gt; 1101\n           =&gt; 0010 (one's complement)\n                +1\n              -----\n              0011 =&gt; 3  since sign bit was 1 so s2.k = -3\n              -----    \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 3, "last_activity_date": 1516218612, "last_edit_date": 1516218612, "creation_date": 1516217310, "answer_id": 48308600, "question_id": 48306842, "link": "https://stackoverflow.com/questions/48306842/comparison-between-structs-in-c-using-bitfields/48308600#48308600", "title": "Comparison between structs in C using bitfields", "body": "<p>This is a place in C where <code>int</code>, <code>signed int</code> may differ.</p>\n\n<p><strong>With bit-fields</strong>, An <code>int</code> without a <code>signed</code> or <code>unsigned</code> may be treated as <code>signed int</code> or <code>unsigned int</code>.  Based on OP's reported output, this implementation defined behavior of  <code>int</code> appears to be like <code>signed int</code>.</p>\n\n<pre><code>typedef struct{\n  int i:1;  // like signed int i:1; for OP\n  int k:4;  // like signed int k:4; for OP\n  int x;\n}Struc2;\n</code></pre>\n\n<p>The <code>i</code> bit-field likely has the range <code>[-1...0]</code> and <code>k</code> has <code>[-8...7]</code>. Initializing a <em>signed integer</em> via <code>Struc2 s2={1,13,13};</code> with a value outside its range is <em>implementation defined</em> (Details: C11dr 6.3.1.3 3).</p>\n\n<p>A common <em>implementation defined</em> behavior is to wrap around.  So like <code>Struc2 s2 = {1-2, 13-16, 13};</code> or <code>Struc2 s2 = {-1, -3, 13};</code></p>\n\n<hr>\n\n<p>When using bit-fields, recommend to use <code>unsigned</code> whenever possible.  If <code>int</code> bit-fields are needed, use <code>signed int</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 8101399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad1389ac45f9227eea5e9788b2fdcb65?s=128&d=identicon&r=PG&f=1", "display_name": "cdhaval", "link": "https://stackoverflow.com/users/8101399/cdhaval"}, "is_accepted": false, "score": 0, "last_activity_date": 1516293481, "creation_date": 1516293481, "answer_id": 48326183, "question_id": 48306842, "link": "https://stackoverflow.com/questions/48306842/comparison-between-structs-in-c-using-bitfields/48326183#48326183", "title": "Comparison between structs in C using bitfields", "body": "<p>Your system is little endian so first bit is signed bit from right most bit that's why in your second <code>struct</code> you are inserting odd numbers so it takes first bit as signed bit and give a negative value.</p>\n\n<pre><code> typedef struct{   \n    int i:1;   //Here you inserting **1** so it will take as signed bit. \n    int k:4;   //Here you inserting odd value **13** so it will take negative\n    int x;     //This is also signed but it is **32** bit so it has enough space to store your **13** integer value.\n  }Struc2;\n</code></pre>\n\n<p>if you don't want negative value then give it as a <code>unsigned</code> or increase the bits allocation.Cheers..</p>\n"}], "owner": {"reputation": 13, "user_id": 7496168, "user_type": "registered", "accept_rate": 17, "profile_image": "https://graph.facebook.com/770785556392763/picture?type=large", "display_name": "Zeyad Ibrahim", "link": "https://stackoverflow.com/users/7496168/zeyad-ibrahim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 542, "favorite_count": 1, "answer_count": 3, "score": 0, "last_activity_date": 1516293481, "creation_date": 1516210311, "last_edit_date": 1516219203, "question_id": 48306842, "link": "https://stackoverflow.com/questions/48306842/comparison-between-structs-in-c-using-bitfields", "title": "Comparison between structs in C using bitfields", "body": "<p>So I really can't understand the difference between these two code segments. What I know about bit field is that I reserve in memory how many BITS I will use for this int. But why negative number appear in 2nd Struct?</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;string.h&gt;\ntypedef struct {\n        unsigned int i:1;\n        unsigned int k:31;\n        int x;\n}Struc1;\ntypedef struct{\n        int i:1;\n        int k:4;\n        int x;\n}Struc2;\nint main()\n{\n        Struc1 s1={1,13,13};\n        printf(\"%d %d %d\\n\",s1.i,s1.k,s1.x);\n        Struc2 s2={1,13,13};\n        printf(\"%d %d %d\\n\",s2.i,s2.k,s2.x);\n        return 0;\n}\n</code></pre>\n\n<p>OUTPUT:</p>\n\n<pre><code>1 13 13\n-1 -3 13\n</code></pre>\n"}, {"tags": ["c", "matrix"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1516210322, "post_id": 48306821, "comment_id": 83598861, "body": "You are asking about printing. But your code is not printing anything."}, {"owner": {"reputation": 99, "user_id": 9079872, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a356be38b2b8588bf433b7b52f13f7d5?s=128&d=identicon&r=PG&f=1", "display_name": "PagliFra", "link": "https://stackoverflow.com/users/9079872/paglifra"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1516210368, "post_id": 48306821, "comment_id": 83598891, "body": "@EugeneSh. I just inserted the part where I have to fill the matrix here"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1516210455, "post_id": 48306821, "comment_id": 83598945, "body": "How is it relevant to your problem? (BTW <i>what</i> is the problem?)"}, {"owner": {"reputation": 99, "user_id": 9079872, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a356be38b2b8588bf433b7b52f13f7d5?s=128&d=identicon&r=PG&f=1", "display_name": "PagliFra", "link": "https://stackoverflow.com/users/9079872/paglifra"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1516210542, "post_id": 48306821, "comment_id": 83598986, "body": "@EugeneSh. The problem is that I cannot input the matrix the way it is requested."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1516210617, "post_id": 48306821, "comment_id": 83599042, "body": "But where is the input? Do you mean &quot;initialize&quot; instead?"}], "answers": [{"tags": [], "owner": {"reputation": 2967, "user_id": 8616205, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3o2ct.png?s=128&g=1", "display_name": "frslm", "link": "https://stackoverflow.com/users/8616205/frslm"}, "is_accepted": false, "score": 1, "last_activity_date": 1516213967, "last_edit_date": 1516213967, "creation_date": 1516213603, "answer_id": 48307682, "question_id": 48306821, "link": "https://stackoverflow.com/questions/48306821/how-to-input-the-border-of-a-matrix/48307682#48307682", "title": "How to input the border of a matrix?", "body": "<p>You have two types of issues:</p>\n\n<ol>\n<li>You don't properly reset <code>i</code> or <code>j</code> before each of the 4 for-loops within the while-loop. Because of that, you're usually going out-of-bounds when attempting to fill the matrix.</li>\n<li>Your <code>flag</code> never gets set to 1, since the for-loop it's in will never run once the matrix is filled (trace through your code on paper to see exactly why). Now, with your for-loop bounds, you don't actually need a <code>flag</code> to keep track of when you're done filling the matrix.</li>\n</ol>\n\n<p>Taking those points into account, your modified code could look like this:</p>\n\n<pre><code>int a=0, c=1, i, j, map[N][N] //N with a #define\n\n// (no need to fill your matrix with zeros; your matrix will be filled when your while-loop below ends)\n\n//Here I fill the matrix\nwhile(a &lt; N/2){ // &lt;- stop filling the matrix once a == N/2\n\n    i = a; // &lt;- set i, otherwise the for-loop below will use i=undefined on the first iteration (or i=N if you keep the zeroing code above)\n\n    for(j=a; j&lt;N-a; j++){\n        map[i][j]=c;\n        c++;\n    }\n\n    j = N-a-1; // &lt;- set j, otherwise the for-loop below will use j=N-a, which is out-of-bounds on the first iteration\n\n    for(i=a+1; i&lt;N-a; i++){\n        map[i][j]=c;\n        c++;\n    }\n\n    i = N-a-1; // &lt;- set i, otherwise the for-loop below will use i=N-a, which, again, is out-of-bounds on the first iteration\n\n    for(j=N-a-2; j&gt;=a; j--){ // &lt;- set j=N-a-2 instead of j=N-a-1 to avoid overwriting existing elements of the map\n        map[i][j]=c;\n        c++;\n    }\n\n    j = a; // &lt;- set j, otherwise the for-loop below will use j=a-1, which is out-of-bounds on the first iteration\n\n    for(i=N-a-2; i&gt;a+1; i--){ // &lt;- set i=N-a-2 instead of i=N-a-1 to avoid overwriting existing elements of the map\n        // (no need to check if an element is 0)            \n\n        map[i][j]=c;\n        c++;\n    }\nc=1;\na++;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 99, "user_id": 9079872, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a356be38b2b8588bf433b7b52f13f7d5?s=128&d=identicon&r=PG&f=1", "display_name": "PagliFra", "link": "https://stackoverflow.com/users/9079872/paglifra"}, "edited": false, "score": 1, "creation_date": 1516215729, "post_id": 48307908, "comment_id": 83601763, "body": "Thank you this is exactly the kind of correction I was looking for!"}], "tags": [], "owner": {"reputation": 24506, "user_id": 8472377, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MTIqJ.jpg?s=128&g=1", "display_name": "Austin", "link": "https://stackoverflow.com/users/8472377/austin"}, "is_accepted": true, "score": 2, "last_activity_date": 1516215265, "last_edit_date": 1516215265, "creation_date": 1516214412, "answer_id": 48307908, "question_id": 48306821, "link": "https://stackoverflow.com/questions/48306821/how-to-input-the-border-of-a-matrix/48307908#48307908", "title": "How to input the border of a matrix?", "body": "<p>The simplest way without modifying much of your code is as follows:</p>\n\n<pre><code> #define N 4\n #include&lt;stdio.h&gt;\n\n  int a=0, c=1, i, j, flag=0, map[N][N]; //N with a #define\n\n\n    main() {\n\n   //First I input my matrix with 0.\n    for (i=0; i&lt;N; i++)\n        for (j=0; j&lt;N; j++)\n            map[i][j]=0;\n\n    i=0;\n    //Here I fill the matrix\n    while(!flag){\n\n        for(j=a; j&lt;N-a; j++){\n            map[i][j]=c;\n            c++;\n        }\n        j--;\n        for(i=a+1; i&lt;N-a-1; i++){\n            map[i][j]=c;\n            c++;\n        }\n        for(j=N-a-1; j&gt;=a; j--){\n            map[i][j]=c;\n            c++;\n        }\n        j++;\n        for(i=N-a-1; i&gt;=a+1; i--){\n            if(map[i][j]==0){\n                map[i][j]=c;\n                c++;\n            }\n        }\n        if(map[i+1][j+1]!=0)\n            flag=1;\n\n        c=1;\n        a++;\n        i++;\n    }\n    for(i=0;i&lt;N;i++){\n        for(j=0;j&lt;N;j++){\n            printf(\"%d \",map[i][j]);\n        }\n        printf(\"\\n\");\n    }\n    }\n</code></pre>\n\n<p>Here <code>N</code> is set as <code>4</code>. So output is as follows:</p>\n\n<pre><code>1 2 3 4\n12 1 2 5\n11 4 3 6\n10 9 8 7\n</code></pre>\n"}], "owner": {"reputation": 99, "user_id": 9079872, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a356be38b2b8588bf433b7b52f13f7d5?s=128&d=identicon&r=PG&f=1", "display_name": "PagliFra", "link": "https://stackoverflow.com/users/9079872/paglifra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 178, "favorite_count": 0, "accepted_answer_id": 48307908, "answer_count": 2, "score": 1, "last_activity_date": 1516215879, "creation_date": 1516210225, "last_edit_date": 1516215879, "question_id": 48306821, "link": "https://stackoverflow.com/questions/48306821/how-to-input-the-border-of-a-matrix", "title": "How to input the border of a matrix?", "body": "<p>I'm having trouble filling a matrix in the way it's shown in the image below.\nThe matrix must be NxN with N an even number.</p>\n\n<p><a href=\"https://i.stack.imgur.com/Zewx7.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Zewx7.png\" alt=\"Example\"></a></p>\n\n<p>I think the best way to do it is by using two <code>for</code> inside a <code>while</code>. Something like this:</p>\n\n<pre><code>int a=0, c=1, i, j, flag=0, map[N][N] //N with a #define\n\n//First I input my matrix with 0.\n\nfor (i=0; i&lt;N; i++)\n    for (j=0; j&lt;N; j++)\n        map[i][j]=0;\n\n//Here I fill the matrix\nwhile(!flag){\n\n    for(j=a; j&lt;N-a; j++){\n        map[i][j]=c;\n        c++;\n    }\n    for(i=a+1; i&lt;N-a; i++){\n        map[i][j]=c;\n        c++;\n    }\n    for(j=N-a-1; j&gt;=a; j--){\n        map[i][j]=c;\n        c++;\n    }\n    for(i=N-a-1; i&gt;a+1; i--){\n        if(map[i][j]==0){\n            map[i][j]=c;\n            c++;\n        }\n        else if(map[i][j]!=0)\n            flag=1;\n    }\nc=1;\na++;\n}\n</code></pre>\n\n<p>The problem is that id doesn't really work... Could you help me? Thanks</p>\n"}, {"tags": ["c", "string", "char", "int"], "comments": [{"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1516210085, "post_id": 48306747, "comment_id": 83598736, "body": "if you want just one character at a time, looping through the string and subtracting <code>&#39;0&#39;</code> from each character should work.. of course you&#39;ll have to verify your string is all base 10 characters first"}, {"owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "edited": false, "score": 0, "creation_date": 1516210089, "post_id": 48306747, "comment_id": 83598739, "body": "what exactly did not work out?"}, {"owner": {"reputation": 728, "user_id": 4628444, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-S_tKKQ1s_PY/AAAAAAAAAAI/AAAAAAAAHU8/ph4sOcIgi0w/photo.jpg?sz=128", "display_name": "JoshKisb", "link": "https://stackoverflow.com/users/4628444/joshkisb"}, "edited": false, "score": 0, "creation_date": 1516210120, "post_id": 48306747, "comment_id": 83598755, "body": "looks to me like its working fine"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1516210374, "post_id": 48306747, "comment_id": 83598897, "body": "the function: <code>strlen()</code> returns a <code>size_t</code> not an <code>int</code>,"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1516210593, "post_id": 48306747, "comment_id": 83599023, "body": "the function: <code>atoi()</code> takes all the characters, starting at the indicated address, until it reaches a non-digit character, so the code is not going char by char but rather progressively dropping a leading digit.  Also, the function <code>atoi()</code> (in general) should not be used as it gives no indication of success/failure.  Suggest using: <code>strtol()</code>"}, {"owner": {"reputation": 813, "user_id": 3182105, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1103e5812033d0337647294100c885d1?s=128&d=identicon&r=PG&f=1", "display_name": "SciGuyMcQ", "link": "https://stackoverflow.com/users/3182105/sciguymcq"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1516211226, "post_id": 48306747, "comment_id": 83599398, "body": "@user3629249 I have made the <code>main()</code> explicit now so it should compile just fine :).  Implicit type conversion seems to handle the size_t (or unsigned long) to int just fine for this toy example, thanks for pointing that out though ... I&#39;m playing with <code>strtol</code> now but it appears to be doing the same thing. I&#39;ll post another edit soon."}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1516211346, "post_id": 48306747, "comment_id": 83599470, "body": "also add your expected output"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1516211611, "post_id": 48306747, "comment_id": 83599623, "body": "implicit conversions are risky.  Either cast to the desired type (which indicates your aware of the potential problems) or use the correct types"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1516212130, "post_id": 48306747, "comment_id": 83599890, "body": "for ease of readability and understanding: 1) use meaningful variable names. variable names should indicate <code>content</code> or <code>usage</code> (or better, both)  2) follow the axiom: <i>only one statement per line and (at most) one variable declaration per statement.</i>  3) consistently indent the code.  indent after every opening brace &#39;{&#39;.  unindent before every closing brace &#39;}&#39;.  Suggest each indent level be 4 spaces."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1516212245, "post_id": 48306747, "comment_id": 83599958, "body": "When editing a question, always indicate the changes (perhaps by using <code>EDIT:</code> )  Otherwise, such edits make prior comments meaningless and lending confusion to future readers of the question."}, {"owner": {"reputation": 813, "user_id": 3182105, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1103e5812033d0337647294100c885d1?s=128&d=identicon&r=PG&f=1", "display_name": "SciGuyMcQ", "link": "https://stackoverflow.com/users/3182105/sciguymcq"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1516212527, "post_id": 48306747, "comment_id": 83600118, "body": "@user3629249 this is why people don&#39;t want to use this site anymore.  Clearly I&#39;m doing the following: explaining that I&#39;m new to the language, using brevity (no <code>main</code> originally because it does not convey purpose of question), not concerned about type conversions because its a toy example not iron clad production code, Editing the original question with bold Edit tags and and explanation, do i need to go on ...?"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1516212647, "post_id": 48306747, "comment_id": 83600164, "body": "regarding: <code>for ( i = 0; i &lt; n; i++ )</code> Because each &#39;string&#39; is terminated with a NUL byte (&#39;\\0&#39;) and because it is good programming practice to limit the scope of a variable, this statement could be modified to: <code>for ( int i = 0; charNums[i]; i++ )</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1516212766, "post_id": 48306747, "comment_id": 83600225, "body": "When asking a question about a runtime problem, as this question is doing, it is necessary to post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>.  Questions that do not adhere to the giudelines tend to get marked down and soon closed.  The original question failed to provide that key component.  Suggest you read the help topic"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1516213180, "post_id": 48306747, "comment_id": 83600442, "body": "when compiling, always enable the warnings, then fix those warnings.  ( for <code>gcc</code>, at a minimum use: <code>-Wall -Wextra -Wconversion -pedantic -std=gnu11</code> )"}, {"owner": {"reputation": 135, "user_id": 5038027, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qHzGO.jpg?s=128&g=1", "display_name": "Nitin", "link": "https://stackoverflow.com/users/5038027/nitin"}, "edited": false, "score": 0, "creation_date": 1516213572, "post_id": 48306747, "comment_id": 83600661, "body": "if you want to convert to individual ints from chars then subtract 48 from each char. I hope you know that ascii value of char &#39;0&#39; is 48, therefore int 0 can be obtained by &#39;0&#39; - 48 = 0. In my opinion, the problem is prettry simple and your program is too complex which is not required."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 8101399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad1389ac45f9227eea5e9788b2fdcb65?s=128&d=identicon&r=PG&f=1", "display_name": "cdhaval", "link": "https://stackoverflow.com/users/8101399/cdhaval"}, "is_accepted": false, "score": 0, "last_activity_date": 1516212841, "creation_date": 1516212841, "answer_id": 48307483, "question_id": 48306747, "link": "https://stackoverflow.com/questions/48306747/c-program-convert-string-of-chars-representing-numbers-to-ints/48307483#48307483", "title": "C program: Convert string of chars representing numbers to ints", "body": "<p>Hello My Friend i think you want to convert each char to an integer so here is the code if you requirement is same.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\nint my_atoi(char *str_to_int){\n\n    int num = 0;\n    for(int rot=0 ; str_to_int[rot] ; rot++){\n\n            num = num * 10 + (str_to_int[rot] - 48);\n            printf(\"Char to int is :: %d\\n\",num);\n    }\n    return num;\n}\n\n\nint main() {\n\n    char *charNums = \"12345\";\n    int get_int;\n\n    get_int = my_atoi(charNums);\n    printf(\"In String :: %s In Integer :: %d\\n\",charNums,get_int);\n}\n</code></pre>\n\n<p>OutPut is:</p>\n\n<pre><code>Char to int is :: 1\nChar to int is :: 12\nChar to int is :: 123\nChar to int is :: 1234\nChar to int is :: 12345\nIn String :: 12345 In Integer :: 12345\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9645, "user_id": 1465553, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/5b559f395549789c041652429444dc0a?s=128&d=identicon&r=PG", "display_name": "Saurav Sahu", "link": "https://stackoverflow.com/users/1465553/saurav-sahu"}, "is_accepted": true, "score": 1, "last_activity_date": 1516213520, "last_edit_date": 1516213520, "creation_date": 1516213157, "answer_id": 48307563, "question_id": 48306747, "link": "https://stackoverflow.com/questions/48306747/c-program-convert-string-of-chars-representing-numbers-to-ints/48307563#48307563", "title": "C program: Convert string of chars representing numbers to ints", "body": "<p>You can treat characters as number while doing the <a href=\"https://stackoverflow.com/questions/10778920/subtracting-letters-in-c\">subtraction</a> in this way:</p>\n\n<pre><code>int diff = c - '0';  //c is a character. \n//Avoid using hard code values like 48 in place of '0'.\n//as they less readable.\n</code></pre>\n\n<p>then the <code>diff</code> is nothing, but the integral value.  </p>\n"}, {"tags": [], "owner": {"reputation": 813, "user_id": 3182105, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1103e5812033d0337647294100c885d1?s=128&d=identicon&r=PG&f=1", "display_name": "SciGuyMcQ", "link": "https://stackoverflow.com/users/3182105/sciguymcq"}, "is_accepted": false, "score": 0, "last_activity_date": 1516213748, "creation_date": 1516213748, "answer_id": 48307727, "question_id": 48306747, "link": "https://stackoverflow.com/questions/48306747/c-program-convert-string-of-chars-representing-numbers-to-ints/48307727#48307727", "title": "C program: Convert string of chars representing numbers to ints", "body": "<p>The full and complete answer to my question is here.  Thanks to @Saurav Sahu and @yano for leading me in the right direction.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main(int argc, char **argv) {\n  char *charNums = \"12345\";\n  int num;\n\n  for (int i = 0; charNums[i]; i++) {\n    num = charNums[i] - '0';\n    printf(\"\\ncharNums[%d] = %c\", i, charNums[i]);\n    printf(\"\\nnum = %d\\n\", num);\n  }\n  return 0;\n}\n</code></pre>\n\n<p>Compiling and output of program.</p>\n\n<pre><code>\u279c  testcompile gcc -o soQuestion main.c\n\u279c  testcompile ./soQuestion\n\ncharNums[0] = 1\nnum = 1\n\ncharNums[1] = 2num = 2\n\ncharNums[2] = 3\nnum = 3\n\ncharNums[3] = 4\nnum = 4\n\ncharNums[4] = 5\nnum = 5\n</code></pre>\n"}], "owner": {"reputation": 813, "user_id": 3182105, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1103e5812033d0337647294100c885d1?s=128&d=identicon&r=PG&f=1", "display_name": "SciGuyMcQ", "link": "https://stackoverflow.com/users/3182105/sciguymcq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 156, "favorite_count": 0, "accepted_answer_id": 48307563, "answer_count": 3, "score": 0, "last_activity_date": 1516213748, "creation_date": 1516209970, "last_edit_date": 1516211674, "question_id": 48306747, "link": "https://stackoverflow.com/questions/48306747/c-program-convert-string-of-chars-representing-numbers-to-ints", "title": "C program: Convert string of chars representing numbers to ints", "body": "<p>I am learning C and I am trying to get a toy example working. My fake use case is given a string of chars where each char represents and int, loop over each char of the string and convert it to an int.  What I've tried so far has not worked.</p>\n\n<p><strong>EDIT:</strong> Original question edited to now include a <code>main()</code> to allow responders to compile and using <code>strtol</code> per suggestions in comments.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint main(int argc, char **argv) {\n  char *charNums = \"12345\";\n  int num, num2, num3, i, n = strlen(charNums);\n  char *ptr = charNums;\n\n  for (i = 0; i &lt; n; i++) {\n    num = atoi(&amp;charNums[i]);\n    num2 = atoi(ptr);\n    num3 = strtol(ptr, NULL, 10);\n    printf(\"\\ncharNums[%d] = %c (the expected value but as an int not a char)\\n num = %d\\n num2 = %d\\n num3 = %d\\n\", \n        i, charNums[i], num, num2, num3);\n    ptr++;\n  }\n  return 0;\n)\n</code></pre>\n\n<p><strong>Edit:</strong> Show method of compiling of C code along with program execution</p>\n\n<pre><code>gcc -o soQuestion main.c\n./soQuestion\ncharNums[0] = 1 (the expected value but as an int not a char)\n  num = 12345\n  num2 = 12345\n  num3 = 12345\n\ncharNums[1] = 2 (the expected value but as an int not a char)\n  num = 2345\n  num2 = 2345\n  num3 = 2345\n\ncharNums[2] = 3 (the expected value but as an int not a char)\n  num = 345\n  num2 = 345\n  num3 = 345\n\ncharNums[3] = 4 (the expected value but as an int not a char)\n  num = 45\n  num2 = 45\n  num3 = 45\n\ncharNums[4] = 5 (the expected value but as an int not a char)\n  num = 5\n  num2 = 5\n  num3 = 5\n</code></pre>\n\n<p>Appreciate any feedback.</p>\n\n<p><strong>Edit:</strong> The desired outcome of this program is to convert each char in the chars string \"12345\" to individual ints of 1 2 3 4 5 so I can do math with them such as sum them 1 + 2 + 3 + 4 + 5 = 15</p>\n"}, {"tags": ["c", "crash", "malloc", "valgrind", "free"], "comments": [{"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1516214222, "post_id": 48306394, "comment_id": 83600968, "body": "how are we to test this without the contents of the header file: <code>get_next_line.h</code>?"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1516214302, "post_id": 48306394, "comment_id": 83600998, "body": "usually, when a call to <code>free()</code> crashes, it means the heap has been corrupted.  This is often due to overflowing a buffer that is allocated in the heap."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1516214507, "post_id": 48306394, "comment_id": 83601084, "body": "when calling any of the heap allocation function: ( malloc, calloc, realloc ), always check (!=NULL) the returned value to assure the operation was successful."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1516215231, "post_id": 48306394, "comment_id": 83601506, "body": "when calling <code>open()</code> always check the returned value.  a value of -1 means an error occurred.  When an error occurs, call <code>perror()</code> to output the enclosed text and the reason the system thinks the error occurred to <code>stderr</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1516215421, "post_id": 48306394, "comment_id": 83601627, "body": "regarding: <code>int is_str_malloced = 0; if (!is_str_malloced)</code>  the <code>is_str_malloced</code> will ALWAYS be 0, so the <code>if</code> code block will always be entered."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1516215643, "post_id": 48306394, "comment_id": 83601720, "body": "the posted code is missing the statement: <code>#include &lt;unistd.h&gt;</code> to expose the function: <code>read()</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1516215956, "post_id": 48306394, "comment_id": 83601892, "body": "there is the concept of the <code>file position pointer (FPP)</code>.   After the posted code &#39;reads&#39; a line from the input file, the FPP will be far beyond the beginning of the next line in the input file.  This means the next call to <code>get_next_line()</code> will (effectively) skip portions of the input file.  (and what happens when the calling program is wanting to read from more than 1 input file?)"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1516221241, "post_id": 48306394, "comment_id": 83604696, "body": "in <code>main()</code>   the variable <code>str</code>  will contain a pointer to allocated memory.  The pointer to the allocated memory needs to be passed to <code>free()</code> before exiting the program.  Note: <code>free()</code> has no problem with being passed a NULL pointer.  Suggest also initializing <code>str</code> to NULL."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1516221843, "post_id": 48306394, "comment_id": 83605010, "body": "Since the posted code is trying to replace the system <code>getline()</code>, suggest looking at the source code for <code>getline()</code>, <a href=\"https://dev.w3.org/libwww/Library/src/vms/getline.c\" rel=\"nofollow noreferrer\">source</a>  and to implement all the functionality of <code>getline()</code>, including returning the length of the read in line.  Note: unlike the referenced version of <code>getline()</code> I would not limit the length to 256 bytes"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1516222307, "post_id": 48306394, "comment_id": 83605242, "body": "in function: <code>main()</code>, this: <code>while (1)     {         str = get_next_line(fd);         if (str == NULL)         {             close(fd);             return (0);         }</code>  should probably be replaced with: <code>while( (str = get_next_line( fd ) ) != NULL ) {</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1516222594, "post_id": 48306394, "comment_id": 83605397, "body": "the code in <code>get_next_line()</code> could be replaced with: <code>static char *str;  return get_text( fd, str );</code>"}, {"owner": {"reputation": 43, "user_id": 9230703, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e71a9f6d76312d4d45b1f8b2e3039937?s=128&d=identicon&r=PG&f=1", "display_name": "Louis Didierjean", "link": "https://stackoverflow.com/users/9230703/louis-didierjean"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1516225978, "post_id": 48306394, "comment_id": 83606921, "body": "get_next_line.h only contains a declaration of my get_next_line() function to be used in other projects"}, {"owner": {"reputation": 43, "user_id": 9230703, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e71a9f6d76312d4d45b1f8b2e3039937?s=128&d=identicon&r=PG&f=1", "display_name": "Louis Didierjean", "link": "https://stackoverflow.com/users/9230703/louis-didierjean"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1516226103, "post_id": 48306394, "comment_id": 83606978, "body": "And the macro READ_SIZE that is used to change the number of bytes read each time read() is called"}, {"owner": {"reputation": 43, "user_id": 9230703, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e71a9f6d76312d4d45b1f8b2e3039937?s=128&d=identicon&r=PG&f=1", "display_name": "Louis Didierjean", "link": "https://stackoverflow.com/users/9230703/louis-didierjean"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1516226165, "post_id": 48306394, "comment_id": 83607005, "body": "I&#39;ll try to correct my code using the information you&#39;ve given me, thanks a lot!"}], "answers": [{"tags": [], "owner": {"reputation": 16, "user_id": 8749699, "user_type": "registered", "profile_image": "https://graph.facebook.com/1642271985848012/picture?type=large", "display_name": "L&#233;o Lecherbonnier", "link": "https://stackoverflow.com/users/8749699/l%c3%a9o-lecherbonnier"}, "is_accepted": true, "score": 0, "last_activity_date": 1525016167, "last_edit_date": 1525016167, "creation_date": 1516232259, "answer_id": 48311731, "question_id": 48306394, "link": "https://stackoverflow.com/questions/48306394/getline-like-function-crashing/48311731#48311731", "title": "Getline-like function crashing", "body": "<p><strong>Rebuilding your <code>realloc</code> can be a good idea!</strong></p>\n\n<p>Think about the <code>start_at</code> value you give to your <code>realloc</code>.</p>\n\n<p>An easier way to realloc:</p>\n\n<pre><code>char            *my_realloc(char *old, int size)\n{\n  int           i = 0;\n  char          *new;\n\n  new = malloc(sizeof(char) * (my_strlen(old) + size));\n  while (old[i] != '\\0')\n    {\n      new[i] = old[i];\n      i++;\n    }\n  free(old);\n  return (new);\n}\n</code></pre>\n\n<p>Also, I prefer to <code>malloc</code> like this:</p>\n\n<pre><code>malloc(sizeof(char) * len);\n</code></pre>\n\n<p>And it's better for this projet to have a <code>get_char</code>:</p>\n\n<pre><code>char get_char(const int fd)\n{\n  static char buff[READ_MAX];\n  static char* pointer;\n  static int len = 0;\n  char caracter;\n\n  if (len == 0)\n    {\n      len = read(fd, buff, READ_MAX);\n      pointer = (char*)&amp;buff;\n      if (len == 0)\n        return (0);\n    }\n  caracter = *pointer;\n  pointer++;\n  len--;\n  return caracter;\n}\n</code></pre>\n\n<p>Good luck!</p>\n"}], "owner": {"reputation": 43, "user_id": 9230703, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e71a9f6d76312d4d45b1f8b2e3039937?s=128&d=identicon&r=PG&f=1", "display_name": "Louis Didierjean", "link": "https://stackoverflow.com/users/9230703/louis-didierjean"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 0, "accepted_answer_id": 48311731, "answer_count": 1, "score": 1, "last_activity_date": 1525016167, "creation_date": 1516208623, "last_edit_date": 1516210498, "question_id": 48306394, "link": "https://stackoverflow.com/questions/48306394/getline-like-function-crashing", "title": "Getline-like function crashing", "body": "<p>I'm currently studying programming and I'm on my first year. We're currently studying C and we've been tasked with creating a function that works a bit like <em>getline()</em>, but the differences are that the function only takes a file descriptor as parameter and will return on each call a <strong>malloc'd</strong> string that represents the next line in the file corresponding to the file descriptor.</p>\n\n<p>The line that the function returns must not contain any <strong>'\\n'</strong> character, must return <strong>NULL</strong> when there is nothing left to read or the functions encounters an error. We're also limited to the following functions: <strong>read, malloc and free.</strong></p>\n\n<p>I've written the following code (sorry if it's hard to read I'm still learning and we have a \"coding style\" to follow when writing code):</p>\n\n<pre><code>#include \"get_next_line.h\"\n#include &lt;sys/types.h&gt;\n#include &lt;sys/stat.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;stdio.h&gt;\n\nint find_n(char *str)\n{\n    int i = 0;\n\n    while (str[i] != '\\0') {\n        if (str[i] == '\\n')\n            return (i);\n        i++;\n    }\n    return (0);\n}\n\nstatic char *my_realloc(char *str, unsigned int size, unsigned int start_at)\n{\n    int i = 0;\n    char *new_str;\n\n    new_str = malloc(size);\n    while (str[i + start_at] != '\\0') {\n        new_str[i] = str[i + start_at];\n        i++;\n    }\n    if (str[i + start_at] == '\\0')\n        new_str[i] ==  '\\0';\n    free(str);\n    return (new_str);\n}\n\nstatic char *get_line(char *str, unsigned int *total_read)\n{\n    int i = find_n(str);\n    int j = 0;\n    int len = 0;\n    char *line = malloc(i + 1);\n\n    while (j &lt; i) {\n        line[j] = str[j];\n        j++;\n    }\n    line[j] = '\\0';\n    while (str[i + 1 + len] != '\\0') {\n        len++;\n    }\n    *total_read = len;\n    str = my_realloc(str, len + 1, i + 1);\n    return (line);\n}\n\nstatic void my_strcat(char *dest, char const *src)\n{\n    int dest_len = 0;\n    int i = 0;\n\n    while (dest[i] != '\\0') {\n        i++;\n    }\n    dest_len = i;\n    i = 0;\n    while (src[i] != '\\0') {\n        dest[dest_len + i] = src[i];\n        i++;\n    }\n    dest[dest_len + i] = '\\0';\n}\n\nstatic char *get_text(int fd, char *str)\n{\n    char *buf;\n    int n_read = READ_SIZE;\n    static unsigned int total_read = 0;\n    int loop_started = 0;\n\n    buf = malloc(READ_SIZE + 1);\n    buf[0] = '\\0';\n    while (n_read == READ_SIZE) {\n        n_read = read(fd, buf, READ_SIZE);\n        if (n_read == -1 || (n_read == 0 &amp;&amp; !loop_started)) {\n            free(str);\n            free(buf);\n            return (NULL);\n        }\n        buf[n_read] = '\\0';\n        total_read += n_read;\n        str = my_realloc(str, total_read + 1, 0);\n        my_strcat(str, buf);\n        loop_started = 1;\n        if (find_n(buf)) {\n            break;\n        }\n    }\n    free(buf);\n    return (get_line(str, &amp;total_read));\n}\n\nchar *get_next_line(int fd)\n{\n    static char *str;\n    int is_str_malloced = 0;\n\n    if (!is_str_malloced) {\n        str = malloc(1);\n        str[0] = '\\0';\n        is_str_malloced = 1;\n    }\n    return(get_text(fd, str));\n}\n\nint main(void)\n{\n    char *str;\n    int fd;\n\n    fd = open(\"script\", O_RDONLY);\n    while (1) {\n        str = get_next_line(fd);\n        if (str == NULL) {\n            close(fd);\n            return (0);\n        }\n        printf(\"%s\\n\", str);\n    }\n    close(fd);\n    return (0);\n}\n</code></pre>\n\n<p>The main function is pretty much only for testing purposes. When I compile and test this I get:</p>\n\n<pre><code>*** Error in `./a.out': free(): invalid next size (normal): 0x0000000000ed71b0 ***\n======= Backtrace: =========\n/lib64/libc.so.6(+0x7cbac)[0x7f67d51a5bac]\n/lib64/libc.so.6(+0x87a59)[0x7f67d51b0a59]\n/lib64/libc.so.6(cfree+0x16e)[0x7f67d51b63be]\n./a.out[0x40071b]\n./a.out[0x40095f]\n./a.out[0x400a07]\n./a.out[0x400a32]\n/lib64/libc.so.6(__libc_start_main+0xea)[0x7f67d514988a]\n./a.out[0x40059a]\n======= Memory map: ========\n00400000-00401000 r-xp 00000000 103:05 22939320                          /home/ldidierjean/delivery/CPE_getnextline_2017/a.out\n00600000-00601000 r--p 00000000 103:05 22939320                          /home/ldidierjean/delivery/CPE_getnextline_2017/a.out\n00601000-00602000 rw-p 00001000 103:05 22939320                          /home/ldidierjean/delivery/CPE_getnextline_2017/a.out\n00ed7000-00ef8000 rw-p 00000000 00:00 0                                  [heap]\n7f67d0000000-7f67d0021000 rw-p 00000000 00:00 0 \n7f67d0021000-7f67d4000000 ---p 00000000 00:00 0 \n7f67d4f12000-7f67d4f28000 r-xp 00000000 103:05 7210485                   /usr/lib64/libgcc_s-7-20170915.so.1\n7f67d4f28000-7f67d5127000 ---p 00016000 103:05 7210485                   /usr/lib64/libgcc_s-7-20170915.so.1\n7f67d5127000-7f67d5128000 r--p 00015000 103:05 7210485                   /usr/lib64/libgcc_s-7-20170915.so.1\n7f67d5128000-7f67d5129000 rw-p 00016000 103:05 7210485                   /usr/lib64/libgcc_s-7-20170915.so.1\n7f67d5129000-7f67d52f4000 r-xp 00000000 103:05 7217643                   /usr/lib64/libc-2.25.so\n7f67d52f4000-7f67d54f4000 ---p 001cb000 103:05 7217643                   /usr/lib64/libc-2.25.so\n7f67d54f4000-7f67d54f8000 r--p 001cb000 103:05 7217643                   /usr/lib64/libc-2.25.so\n7f67d54f8000-7f67d54fa000 rw-p 001cf000 103:05 7217643                   /usr/lib64/libc-2.25.so\n7f67d54fa000-7f67d54fe000 rw-p 00000000 00:00 0 \n7f67d54fe000-7f67d5525000 r-xp 00000000 103:05 7219338                   /usr/lib64/ld-2.25.so\n7f67d56f6000-7f67d56f9000 rw-p 00000000 00:00 0 \n7f67d5721000-7f67d5724000 rw-p 00000000 00:00 0 \n7f67d5724000-7f67d5725000 r--p 00026000 103:05 7219338                   /usr/lib64/ld-2.25.so\n7f67d5725000-7f67d5727000 rw-p 00027000 103:05 7219338                   /usr/lib64/ld-2.25.so\n7fff51a9b000-7fff51abd000 rw-p 00000000 00:00 0                          [stack]\n7fff51ac2000-7fff51ac5000 r--p 00000000 00:00 0                          [vvar]\n7fff51ac5000-7fff51ac7000 r-xp 00000000 00:00 0                          [vdso]\nffffffffff600000-ffffffffff601000 r-xp 00000000 00:00 0                  [vsyscall]\nAbandon (core dumped)\n</code></pre>\n\n<p>Valgrind gives me:</p>\n\n<pre><code>==6142== Memcheck, a memory error detector\n==6142== Copyright (C) 2002-2017, and GNU GPL'd, by Julian Seward et al.\n==6142== Using Valgrind-3.13.0 and LibVEX; rerun with -h for copyright info\n==6142== Command: ./a.out --track-origins=yes\n==6142== \n==6142== Conditional jump or move depends on uninitialised value(s)\n==6142==    at 0x400824: my_strcat (get_next_line.c:67)\n==6142==    by 0x400960: get_text (get_next_line.c:98)\n==6142==    by 0x4009F1: get_next_line (get_next_line.c:118)\n==6142==    by 0x400A1C: main (get_next_line.c:128)\n==6142== \n==6142== Invalid read of size 1\n==6142==    at 0x40081F: my_strcat (get_next_line.c:67)\n==6142==    by 0x400960: get_text (get_next_line.c:98)\n==6142==    by 0x4009F1: get_next_line (get_next_line.c:118)\n==6142==    by 0x400A1C: main (get_next_line.c:128)\n==6142==  Address 0x5214257 is 0 bytes after a block of size 16,759 alloc'd\n==6142==    at 0x4C2EB6B: malloc (vg_replace_malloc.c:299)\n==6142==    by 0x4006B3: my_realloc (get_next_line.c:31)\n==6142==    by 0x400949: get_text (get_next_line.c:97)\n==6142==    by 0x4009F1: get_next_line (get_next_line.c:118)\n==6142==    by 0x400A1C: main (get_next_line.c:128)\n==6142== \n==6142== Invalid write of size 1\n==6142==    at 0x400857: my_strcat (get_next_line.c:73)\n==6142==    by 0x400960: get_text (get_next_line.c:98)\n==6142==    by 0x4009F1: get_next_line (get_next_line.c:118)\n==6142==    by 0x400A1C: main (get_next_line.c:128)\n==6142==  Address 0x5214270 is 16 bytes after a block of size 16,768 in arena \"client\"\n==6142== \n==6142== Invalid write of size 1\n==6142==    at 0x400883: my_strcat (get_next_line.c:76)\n==6142==    by 0x400960: get_text (get_next_line.c:98)\n==6142==    by 0x4009F1: get_next_line (get_next_line.c:118)\n==6142==    by 0x400A1C: main (get_next_line.c:128)\n==6142==  Address 0x5214277 is 23 bytes after a block of size 16,768 in arena \"client\"\n==6142== \n==6142== Conditional jump or move depends on uninitialised value(s)\n==6142==    at 0x4006F7: my_realloc (get_next_line.c:32)\n==6142==    by 0x400949: get_text (get_next_line.c:97)\n==6142==    by 0x4009F1: get_next_line (get_next_line.c:118)\n==6142==    by 0x400A1C: main (get_next_line.c:128)\n==6142== \n==6142== Invalid read of size 1\n==6142==    at 0x4006F2: my_realloc (get_next_line.c:32)\n==6142==    by 0x400949: get_text (get_next_line.c:97)\n==6142==    by 0x4009F1: get_next_line (get_next_line.c:118)\n==6142==    by 0x400A1C: main (get_next_line.c:128)\n==6142==  Address 0x5214257 is 0 bytes after a block of size 16,759 alloc'd\n==6142==    at 0x4C2EB6B: malloc (vg_replace_malloc.c:299)\n==6142==    by 0x4006B3: my_realloc (get_next_line.c:31)\n==6142==    by 0x400949: get_text (get_next_line.c:97)\n==6142==    by 0x4009F1: get_next_line (get_next_line.c:118)\n==6142==    by 0x400A1C: main (get_next_line.c:128)\n==6142== \n==6142== Invalid read of size 1\n==6142==    at 0x4006D8: my_realloc (get_next_line.c:33)\n==6142==    by 0x400949: get_text (get_next_line.c:97)\n==6142==    by 0x4009F1: get_next_line (get_next_line.c:118)\n==6142==    by 0x400A1C: main (get_next_line.c:128)\n==6142==  Address 0x5214257 is 0 bytes after a block of size 16,759 alloc'd\n==6142==    at 0x4C2EB6B: malloc (vg_replace_malloc.c:299)\n==6142==    by 0x4006B3: my_realloc (get_next_line.c:31)\n==6142==    by 0x400949: get_text (get_next_line.c:97)\n==6142==    by 0x4009F1: get_next_line (get_next_line.c:118)\n==6142==    by 0x400A1C: main (get_next_line.c:128)\n==6142== \n==6142== Invalid write of size 1\n==6142==    at 0x4006DB: my_realloc (get_next_line.c:33)\n==6142==    by 0x400949: get_text (get_next_line.c:97)\n==6142==    by 0x4009F1: get_next_line (get_next_line.c:118)\n==6142==    by 0x400A1C: main (get_next_line.c:128)\n==6142==  Address 0x521841e is 0 bytes after a block of size 16,766 alloc'd\n==6142==    at 0x4C2EB6B: malloc (vg_replace_malloc.c:299)\n==6142==    by 0x4006B3: my_realloc (get_next_line.c:31)\n==6142==    by 0x400949: get_text (get_next_line.c:97)\n==6142==    by 0x4009F1: get_next_line (get_next_line.c:118)\n==6142==    by 0x400A1C: main (get_next_line.c:128)\n==6142== \n==6142== Invalid read of size 1\n==6142==    at 0x40070A: my_realloc (get_next_line.c:36)\n==6142==    by 0x400949: get_text (get_next_line.c:97)\n==6142==    by 0x4009F1: get_next_line (get_next_line.c:118)\n==6142==    by 0x400A1C: main (get_next_line.c:128)\n==6142==  Address 0x5214277 is 23 bytes after a block of size 16,768 in arena \"client\"\n==6142== \n--6142-- VALGRIND INTERNAL ERROR: Valgrind received a signal 11 (SIGSEGV) - exiting\n--6142-- si_code=1;  Faulting address: 0x206991B288;  sp: 0x1002ba9e30\n\nvalgrind: the 'impossible' happened:\n   Killed by fatal signal\n\nhost stacktrace:\n==6142==    at 0x5804F2DC: ??? (in /usr/lib64/valgrind/memcheck-amd64-linux)\n==6142==    by 0x5800B304: ??? (in /usr/lib64/valgrind/memcheck-amd64-linux)\n==6142==    by 0x5800B4D2: ??? (in /usr/lib64/valgrind/memcheck-amd64-linux)\n==6142==    by 0x58098653: ??? (in /usr/lib64/valgrind/memcheck-amd64-linux)\n==6142==    by 0x580A7256: ??? (in /usr/lib64/valgrind/memcheck-amd64-linux)\n\nsched status:\n  running_tid=1\n\nThread 1: status = VgTs_Runnable (lwpid 6142)\n==6142==    at 0x4C2EB6B: malloc (vg_replace_malloc.c:299)\n==6142==    by 0x4006B3: my_realloc (get_next_line.c:31)\n==6142==    by 0x400949: get_text (get_next_line.c:97)\n==6142==    by 0x4009F1: get_next_line (get_next_line.c:118)\n==6142==    by 0x400A1C: main (get_next_line.c:128)\n\n\nNote: see also the FAQ in the source distribution.\nIt contains workarounds to several common problems.\nIn particular, if Valgrind aborted or crashed after\nidentifying problems in your program, there's a good chance\nthat fixing those problems will prevent Valgrind aborting or\ncrashing, especially if it happened in m_mallocfree.c.\n\nIf that doesn't help, please report this bug to: www.valgrind.org\n\nIn the bug report, send all the above text, the valgrind\nversion, and what OS and version you are using.  Thanks.\n</code></pre>\n\n<p>It looks like the free() in the my_realloc function is causing the program to crash, but I can't find out why at all, can somebody help me?</p>\n"}, {"tags": ["c", "arrays", "windows", "eof"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 6, "creation_date": 1516208308, "post_id": 48306269, "comment_id": 83597642, "body": "You didn&#39;t initialize <code>arreglo</code> before using it."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 2, "creation_date": 1516208389, "post_id": 48306269, "comment_id": 83597686, "body": "It is a good habit to initialize all variables when you define them."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 3, "creation_date": 1516208737, "post_id": 48306269, "comment_id": 83597916, "body": "Aside: please remember that the array should be indexed from <code>0</code> to <code>ARRAY_SIZE - 1</code>."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 2, "creation_date": 1516209572, "post_id": 48306269, "comment_id": 83598433, "body": "The indentation on this code is a wreck. That helps communicate not only flow, but <i>intent</i>, and helps avoid ugly, hard to see bugs."}, {"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 2, "creation_date": 1516211791, "post_id": 48306269, "comment_id": 83599719, "body": "Have you included the same version of your code that generated that output? There is no way the included code could print out two numbers."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1516212702, "post_id": 48306269, "comment_id": 83600189, "body": "@ChrisTurner why not? There is a <code>while</code> loop and no newline output."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1516214745, "post_id": 48306269, "comment_id": 83601215, "body": "@ChrisTurner on consideration, you are right - there is no space printed to output."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1516223155, "post_id": 48306269, "comment_id": 83605676, "body": "regarding: <code>main()</code>   The compiler will output a warning message about this line.  This can be fixed by using: <code>int main( void )</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1516223456, "post_id": 48306269, "comment_id": 83605829, "body": "regarding: <code>if(c==&#39; &#39;||c==&#39;\\t&#39;||c==&#39;\\n&#39;)</code>  probably also want to check for <code>,</code> <code>.</code> <code>;</code> and <code>:</code>.   Suggest examining the contents of the header file: <code>ctype.h</code> for further information and some predefined macros."}, {"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1516271936, "post_id": 48306269, "comment_id": 83623851, "body": "@WeatherVane hard to tell with the poor formatting, but the <code>printf</code> is outside the <code>while</code> loop"}], "answers": [{"comments": [{"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1516213984, "post_id": 48306508, "comment_id": 83600854, "body": "@chux Thanks, I was baited into the trap of lazyness by a seven-figure rep.... ;-)"}, {"owner": {"reputation": 21, "user_id": 9230647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fca7c2d56a72b97d2a9800d51d8d9d93?s=128&d=identicon&r=PG&f=1", "display_name": "Alan Hidalgo", "link": "https://stackoverflow.com/users/9230647/alan-hidalgo"}, "edited": false, "score": 0, "creation_date": 1516220144, "post_id": 48306508, "comment_id": 83604108, "body": "Ok, my code works now. I initialized the array and all variables. I also made sure the array was indexed from 1 to ARRAY_SIZE-1. I indexed the array from 1 because I assumed there had already been a word typed as I usually don&#180;t start typing by using a space, I must work in a more robust version however."}, {"owner": {"reputation": 21, "user_id": 9230647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fca7c2d56a72b97d2a9800d51d8d9d93?s=128&d=identicon&r=PG&f=1", "display_name": "Alan Hidalgo", "link": "https://stackoverflow.com/users/9230647/alan-hidalgo"}, "edited": false, "score": 0, "creation_date": 1516220262, "post_id": 48306508, "comment_id": 83604178, "body": "I would like to post the code with the corrections added to get feedback from you but there is a limit. Does anybody know how to do so without stackoverflow assuming I&#39;m answering my own question?"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "reply_to_user": {"reputation": 21, "user_id": 9230647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fca7c2d56a72b97d2a9800d51d8d9d93?s=128&d=identicon&r=PG&f=1", "display_name": "Alan Hidalgo", "link": "https://stackoverflow.com/users/9230647/alan-hidalgo"}, "edited": false, "score": 0, "creation_date": 1516220835, "post_id": 48306508, "comment_id": 83604493, "body": "It is OK to answer your own question. It might even get you a badge. You can show your final solution for the benefit of others. If none of the existing answers was even close you can accept your own answer. If you basically use one of the answers and have just fine-tuned it a little, you can consider accepting that answer instead of your own."}], "tags": [], "owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "is_accepted": false, "score": 1, "last_activity_date": 1516213886, "last_edit_date": 1516213886, "creation_date": 1516209044, "answer_id": 48306508, "question_id": 48306269, "link": "https://stackoverflow.com/questions/48306269/why-am-i-getting-this-huge-numbers-in-c/48306508#48306508", "title": "Why am I getting this huge numbers in C?", "body": "<p>On the side:<br>\nYour call to <code>printf()</code> has more parameters than covered by the format string.<br>\nSo you should clean up your code to something similar to</p>\n\n<pre><code>printf(\"%d %d\\n\", arreglo[1], arreglo[2]);\n</code></pre>\n\n<p>Concerning the strange output:\nA way of getting surprising values is using non-initialised variables.<br>\nIn your case the lack of initialisation affects the array <code>arreglo</code>.<br>\nMake sure to initialise it, so that all counting starts on a meaningful value.</p>\n\n<p>Another way of getting seemingly very high values is printing several numbers next to each other, without separating white space in between.<br>\nSo the \" \" and the \"\\n\" in the format string I proposed are quite relevant.</p>\n"}, {"tags": [], "owner": {"reputation": 116, "user_id": 9230693, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-p8SGkYta8dY/AAAAAAAAAAI/AAAAAAAAAKs/iCeQwqO3N9M/photo.jpg?sz=128", "display_name": "Jutorres", "link": "https://stackoverflow.com/users/9230693/jutorres"}, "is_accepted": false, "score": 1, "last_activity_date": 1516209514, "creation_date": 1516209514, "answer_id": 48306641, "question_id": 48306269, "link": "https://stackoverflow.com/questions/48306269/why-am-i-getting-this-huge-numbers-in-c/48306641#48306641", "title": "Why am I getting this huge numbers in C?", "body": "<p>First, try the solution answered before, changing the printf() call.</p>\n\n<p>If there is still a problem try:</p>\n\n<pre><code>     printf(\"%d %d \\n\",arreglo[1],arreglo[2]); \n</code></pre>\n\n<p>Just before the while loop, to see if the \"arreglo\" array is initialize to 0's or just random values.</p>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 5, "last_activity_date": 1516214349, "last_edit_date": 1516214349, "creation_date": 1516211243, "answer_id": 48307085, "question_id": 48306269, "link": "https://stackoverflow.com/questions/48306269/why-am-i-getting-this-huge-numbers-in-c/48307085#48307085", "title": "Why am I getting this huge numbers in C?", "body": "<p>At least these problems.</p>\n\n<ol>\n<li><p><code>int arreglo[ARRAY_SIZE];</code> is not initialized before its elements are incremented.  This is the mostly likely cause of  \"Why am I getting this huge numbers\"  <a href=\"https://stackoverflow.com/a/48306310/2410359\">@ikegami</a></p>\n\n<pre><code> // int arreglo[ARRAY_SIZE];\n // replace with \n int arreglo[ARRAY_SIZE] = { 0 };\n</code></pre></li>\n<li><p>Code can access out of array bounds as <code>nopalabra</code> is not confined to 0 to 99.  </p>\n\n<pre><code>#define ARRAY_SIZE 100\nint arreglo[ARRAY_SIZE];\n++arreglo[nopalabra];  // No access protection\n</code></pre></li>\n<li><p><code>printf(\"%d\",arreglo[1],arreglo[2]);</code> only prints <code>arreglo[1]</code></p></li>\n<li><p>Logic flow is incorrect to \"make a graph that indicates how many letters there are in each word.\"</p></li>\n<li><p><code>main()</code> return type not coded.</p></li>\n</ol>\n\n<hr>\n\n<p>Some pseudo-code as an alternative</p>\n\n<pre><code>int main(void) {\n  set all arreglo[] to 0\n  int nopalabra = 0;\n  part_of_word = false;  // Keep track of word state\n  loop forever {\n    get a character into c\n    if c is a separator or EOF\n      if (part_of_word) {\n        arreglo[nopalabra]++;\n        part_of_word = false;\n      nopalabra = 0;\n      if (c == EOF) break loop\n    } else {\n      nopalabra++;\n      part_of_word = true;\n    }\n  }\n\n  print out results\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 509, "user_id": 8857328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a43855efb44db02b57d0f7253394882?s=128&d=identicon&r=PG&f=1", "display_name": "VladP", "link": "https://stackoverflow.com/users/8857328/vladp"}, "is_accepted": false, "score": 0, "last_activity_date": 1516215179, "creation_date": 1516215179, "answer_id": 48308082, "question_id": 48306269, "link": "https://stackoverflow.com/questions/48306269/why-am-i-getting-this-huge-numbers-in-c/48308082#48308082", "title": "Why am I getting this huge numbers in C?", "body": "<p>the question is: \"Why am I getting this huge numbers in C?\"</p>\n\n<p>the answer is: you have not assigned anything to arreglo array, and since you have not initialized it, you got some random values that have been there in memory. Trust me on this, I have run your code in debugger, which I also highly recommend a a standard practice while lerning to program.</p>\n\n<p>Also, this is a common mistake where the format specifier is not written:\nprintf(\"%d\",arreglo[1],arreglo[2]); </p>\n\n<p>See if using printf(\"%d\",\"%d\",arreglo[1],arreglo[2]) solves your problem.</p>\n\n<p>By the way, K&amp;R book is very old, and written at the time where there have been no other C books. There are better ways to learn C.</p>\n"}], "owner": {"reputation": 21, "user_id": 9230647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fca7c2d56a72b97d2a9800d51d8d9d93?s=128&d=identicon&r=PG&f=1", "display_name": "Alan Hidalgo", "link": "https://stackoverflow.com/users/9230647/alan-hidalgo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 685, "favorite_count": 0, "answer_count": 4, "score": 2, "last_activity_date": 1516215179, "creation_date": 1516208213, "last_edit_date": 1516214176, "question_id": 48306269, "link": "https://stackoverflow.com/questions/48306269/why-am-i-getting-this-huge-numbers-in-c", "title": "Why am I getting this huge numbers in C?", "body": "<p>I'm trying to teach myself C using Kernighan's book and I'm supposed to make a graph that indicates how many letters there are in each word. I haven't got to the \"plotting\" part as I'm getting really weird and enormous numbers at the output. Right now I'm just trying to have the value of the first and second elements of the array \"arreglo\" printed.  </p>\n\n<p>The code is the following:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#define ARRAY_SIZE 100\n\n/*#define AUX 0\n#define AUX2 0*/\n\nmain()\n{\n    int s,j,noletra,i,arreglo[ARRAY_SIZE],otros, nopalabra, c;\n    int a;\nnopalabra=1;\n\n    while((c=getchar())!=EOF)\n{\n        if(c==' '||c=='\\t'||c=='\\n')\n               ++nopalabra;\n        else\n               ++arreglo[nopalabra];\n        }\n        printf(\"%d\",arreglo[1],arreglo[2]);\n\n}\n</code></pre>\n\n<p>The reason I'm trying to know the value in the second element in the array is that the first element has the correct value. The code is supposed to add 1 to the array index which is the number of words each time a space, tab or \\n is typed and to add 1 to the array element whenever something different than the previously mentioned characters is typed (Letters). Right now it\u00b4s supposed to print correctly the number of the letters of two words, the first element is correctly printed but the second is a huge number, the output is:</p>\n\n<pre><code>    alan amaury\n^Z\n4 8257542\n--------------------------------\nProcess exited after 7.773 seconds with return value 9\nPress any key to continue . . .\n</code></pre>\n\n<p>The output is supposed to be 4 7. I'm using a compiler in windows so EOF should be Ctrl+Z</p>\n\n<p>Any help that I could get from you will be appreciated :)</p>\n"}, {"tags": ["c++", "c"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1516208139, "post_id": 48306204, "comment_id": 83597537, "body": "Because Win32 API, as the name suggests is targeted fo Windows. While Qt is by design requirement is portable."}, {"owner": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "edited": false, "score": 2, "creation_date": 1516208141, "post_id": 48306204, "comment_id": 83597539, "body": "Win32 api is specific to the windows operating system which is different from other operating systems."}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1516208190, "post_id": 48306204, "comment_id": 83597570, "body": "There is <code>wine</code> which has a goal to implement the  winapi usage on non windows systems. <a href=\"https://www.winehq.org/\" rel=\"nofollow noreferrer\">winehq.org</a>"}, {"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 2, "creation_date": 1516208443, "post_id": 48306204, "comment_id": 83597714, "body": "Guess what QT on Windows calls to do the native screen drawing."}], "answers": [{"tags": [], "owner": {"reputation": 13016, "user_id": 8751754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7k6Li.png?s=128&g=1", "display_name": "Ron", "link": "https://stackoverflow.com/users/8751754/ron"}, "is_accepted": false, "score": 6, "last_activity_date": 1516208093, "creation_date": 1516208093, "answer_id": 48306241, "question_id": 48306204, "link": "https://stackoverflow.com/questions/48306204/why-is-win32-api-non-portable/48306241#48306241", "title": "Why is win32 API non-portable?", "body": "<p>Because WinAPI was not designed to be portable as it targets only the Windows OS while the QT framework targets multiple OS-es. The fact that WinAPI was written in C does not make a difference.</p>\n"}, {"tags": [], "owner": {"reputation": 11238, "user_id": 7594711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7872c871b0431b72df6350dd0394bea?s=128&d=identicon&r=PG&f=1", "display_name": "SoronelHaetir", "link": "https://stackoverflow.com/users/7594711/soronelhaetir"}, "is_accepted": false, "score": 2, "last_activity_date": 1516208517, "creation_date": 1516208517, "answer_id": 48306362, "question_id": 48306204, "link": "https://stackoverflow.com/questions/48306204/why-is-win32-api-non-portable/48306362#48306362", "title": "Why is win32 API non-portable?", "body": "<p>The windows API is portable in the sense of being processor agnostic (indeed, it has run on many non-Intel processors over the years). It is not portable in the sense of being OS agnostic; although even there Microsoft's is not the only implementation of the API. The wine project has done a credible job of re-implementing the API for other platforms, to the point that windows binaries will run, at least on processors that match the binary.</p>\n"}, {"comments": [{"owner": {"reputation": 13984, "user_id": 501126, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/839de8a602b21abf36e020bcb32959fe?s=128&d=identicon&r=PG", "display_name": "nemequ", "link": "https://stackoverflow.com/users/501126/nemequ"}, "edited": false, "score": 0, "creation_date": 1516218439, "post_id": 48306448, "comment_id": 83603202, "body": "<a href=\"http://www.straightrunning.com/XmingNotes/\" rel=\"nofollow noreferrer\">straightrunning.com/XmingNotes</a>"}], "tags": [], "owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "is_accepted": false, "score": 0, "last_activity_date": 1516208811, "creation_date": 1516208811, "answer_id": 48306448, "question_id": 48306204, "link": "https://stackoverflow.com/questions/48306204/why-is-win32-api-non-portable/48306448#48306448", "title": "Why is win32 API non-portable?", "body": "<p>Why is a rather open question; but here's my take on it:</p>\n\n<p>Win32 API is produced by microsoft; which has commercial reasons for not being portable.</p>\n\n<p>QT is open source; which was created with the sole intention to be portable.</p>\n\n<p>Bonus:\nX11 is open source; which was created with the idea that the machine displaying the images might not be the machine running the program that wants the window.  Which makes it inherently non-portable to other APIs that don't (eg windows)</p>\n"}, {"tags": [], "owner": {"reputation": 8884, "user_id": 8372104, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/72UbV.png?s=128&g=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/8372104/simon"}, "is_accepted": false, "score": 2, "last_activity_date": 1516210018, "last_edit_date": 1516210018, "creation_date": 1516208936, "answer_id": 48306470, "question_id": 48306204, "link": "https://stackoverflow.com/questions/48306204/why-is-win32-api-non-portable/48306470#48306470", "title": "Why is win32 API non-portable?", "body": "<p>The fact that the WinAPI is aimed at C makes no difference.  </p>\n\n<p>Just because the language is cross platform it does not mean the library (especially in the case of those like WinAPI which are <em>not</em> in the standard library) are the same.</p>\n\n<p>It's just a library that interacts with the video card/processor to make a GUI on a <strong>very</strong> low level.  At this point it is so low level the process depends more on memory locations or processor specific operations.  IE saying that certain memory locations (specific to the OS) will reference a pixel on a screen ect.</p>\n\n<p>The Win32API has been built so that it <em>only</em> \"knows\" the tasks for computers with Windows OS, libraries like QT, once again are still not truly \"cross-platform\" they have just been built to include all the relevant operations needed for each OS it covers.    </p>\n"}], "owner": {"reputation": 13, "user_id": 9012351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/375c2df9abcc5321cfc1bf8dfed7093d?s=128&d=identicon&r=PG", "display_name": "user9012351", "link": "https://stackoverflow.com/users/9012351/user9012351"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 164, "favorite_count": 0, "closed_date": 1516212964, "answer_count": 4, "score": -5, "last_activity_date": 1516210018, "creation_date": 1516207980, "question_id": 48306204, "link": "https://stackoverflow.com/questions/48306204/why-is-win32-api-non-portable", "closed_reason": "Needs details or clarity", "title": "Why is win32 API non-portable?", "body": "<p>I know that win32 API is written in C language and also why Qt is portable?</p>\n\n<p>Could someone explain this to me?</p>\n"}, {"tags": ["c", "arrays", "algorithm", "optimization", "binary-search"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1516208019, "post_id": 48306191, "comment_id": 83597449, "body": "If you need to do it with only one/few <code>n</code>, then your &quot;optimization&quot; is actually &quot;de-optimization&quot;."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1516208111, "post_id": 48306191, "comment_id": 83597515, "body": "Sorting, with luck and a good algo is O(n logn), whatever you do afterwards will make that worse. Scanning once through the array, incrementing three counters, would be O(n). Where is the optimisation you want to achieve?"}, {"owner": {"reputation": 52, "user_id": 3680288, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d036318cd7126e8ba513ccb8199843f1?s=128&d=identicon&r=PG&f=1", "display_name": "klm", "link": "https://stackoverflow.com/users/3680288/klm"}, "edited": false, "score": 0, "creation_date": 1516208187, "post_id": 48306191, "comment_id": 83597567, "body": "But in best case (no duplicates) i think im saving a lot of time"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1516208207, "post_id": 48306191, "comment_id": 83597581, "body": "You <i>think</i>? Prove it then. There is a well established scientific notation for this stuff."}, {"owner": {"reputation": 52, "user_id": 3680288, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d036318cd7126e8ba513ccb8199843f1?s=128&d=identicon&r=PG&f=1", "display_name": "klm", "link": "https://stackoverflow.com/users/3680288/klm"}, "edited": false, "score": 0, "creation_date": 1516208292, "post_id": 48306191, "comment_id": 83597630, "body": "so is there any better way to do this instead O(n) ?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1516208320, "post_id": 48306191, "comment_id": 83597646, "body": "No. You have to check the whole array in any case."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1516208885, "post_id": 48306191, "comment_id": 83598019, "body": "So.. you have actually taken the answer and edited it into the question, invalidating everything said.... And pretty much removing the point of the question itself. It&#39;s not clear now what you are asking."}, {"owner": {"reputation": 52, "user_id": 3680288, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d036318cd7126e8ba513ccb8199843f1?s=128&d=identicon&r=PG&f=1", "display_name": "klm", "link": "https://stackoverflow.com/users/3680288/klm"}, "edited": false, "score": 0, "creation_date": 1516209085, "post_id": 48306191, "comment_id": 83598137, "body": "i dont know what to do if bsearch returns null"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1516209143, "post_id": 48306191, "comment_id": 83598171, "body": "So your real question is &quot;how to use <code>bsearch</code> function?&quot; and not the whole thing above. And I think this function is not very suitable for your purpose. You don&#39;t want to search for the exact element."}, {"owner": {"reputation": 52, "user_id": 3680288, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d036318cd7126e8ba513ccb8199843f1?s=128&d=identicon&r=PG&f=1", "display_name": "klm", "link": "https://stackoverflow.com/users/3680288/klm"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1516209226, "post_id": 48306191, "comment_id": 83598211, "body": "@EugeneSh. i also wanted to know if my idea is good, i tagged bsearch because its related with my quesion"}, {"owner": {"reputation": 2026, "user_id": 3789665, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/38983281a7926f50843153d9e0788cdf?s=128&d=identicon&r=PG&f=1", "display_name": "greybeard", "link": "https://stackoverflow.com/users/3789665/greybeard"}, "edited": false, "score": 0, "creation_date": 1516209592, "post_id": 48306191, "comment_id": 83598449, "body": "(<code>how to [get number of elements lower&#47;higher]</code> with C++, there&#39;d be <code>lower_bound()</code> and <code>upper_bound()</code> - any special reason to use C?)"}, {"owner": {"reputation": 52, "user_id": 3680288, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d036318cd7126e8ba513ccb8199843f1?s=128&d=identicon&r=PG&f=1", "display_name": "klm", "link": "https://stackoverflow.com/users/3680288/klm"}, "reply_to_user": {"reputation": 2026, "user_id": 3789665, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/38983281a7926f50843153d9e0788cdf?s=128&d=identicon&r=PG&f=1", "display_name": "greybeard", "link": "https://stackoverflow.com/users/3789665/greybeard"}, "edited": false, "score": 0, "creation_date": 1516209735, "post_id": 48306191, "comment_id": 83598512, "body": "@greybeard i have no problem with cpp, thanks i will check it"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1516210330, "post_id": 48306191, "comment_id": 83598865, "body": "&quot;I have to do this a lot of times and given array also can have thousands of elements.&quot; still lacks clarity.  On repeated runs, does <code>k</code> change? does  <code>array</code> change?"}, {"owner": {"reputation": 52, "user_id": 3680288, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d036318cd7126e8ba513ccb8199843f1?s=128&d=identicon&r=PG&f=1", "display_name": "klm", "link": "https://stackoverflow.com/users/3680288/klm"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1516210371, "post_id": 48306191, "comment_id": 83598895, "body": "array doesnt change, number is changing @chux"}, {"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 0, "creation_date": 1516228641, "post_id": 48306191, "comment_id": 83608063, "body": "One more thought - if the array is unchanging, you can multi-thread it without too much issue as well."}], "answers": [{"comments": [{"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 52, "user_id": 3680288, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d036318cd7126e8ba513ccb8199843f1?s=128&d=identicon&r=PG&f=1", "display_name": "klm", "link": "https://stackoverflow.com/users/3680288/klm"}, "edited": false, "score": 3, "creation_date": 1516208553, "post_id": 48306307, "comment_id": 83597794, "body": "@klm That&#39;s an important detail that you left out.  Please update your question describing what you&#39;re <b>really</b> trying to do."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1516208568, "post_id": 48306307, "comment_id": 83597806, "body": "So it will depend on how the number of times relative to the array size."}, {"owner": {"reputation": 86506, "user_id": 701092, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/xYrM0.jpg?s=128&g=1", "display_name": "0x499602D2", "link": "https://stackoverflow.com/users/701092/0x499602d2"}, "edited": false, "score": 0, "creation_date": 1516208602, "post_id": 48306307, "comment_id": 83597822, "body": "Why <code>O(n + k log n)</code>?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 86506, "user_id": 701092, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/xYrM0.jpg?s=128&g=1", "display_name": "0x499602D2", "link": "https://stackoverflow.com/users/701092/0x499602d2"}, "edited": false, "score": 0, "creation_date": 1516208695, "post_id": 48306307, "comment_id": 83597898, "body": "@0x499602D2 <code>n log n</code> for sorting, <code>k log n</code> for <code>k</code> binary searches."}, {"owner": {"reputation": 2026, "user_id": 3789665, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/38983281a7926f50843153d9e0788cdf?s=128&d=identicon&r=PG&f=1", "display_name": "greybeard", "link": "https://stackoverflow.com/users/3789665/greybeard"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1516208905, "post_id": 48306307, "comment_id": 83598032, "body": "@EugeneSh. isn&#39;t that <code>O((n+k)log n)</code>, then?"}, {"owner": {"reputation": 52, "user_id": 3680288, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d036318cd7126e8ba513ccb8199843f1?s=128&d=identicon&r=PG&f=1", "display_name": "klm", "link": "https://stackoverflow.com/users/3680288/klm"}, "edited": false, "score": 0, "creation_date": 1516208932, "post_id": 48306307, "comment_id": 83598047, "body": "so do you have the way to count larger or smaller when bsearch returns null?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 2026, "user_id": 3789665, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/38983281a7926f50843153d9e0788cdf?s=128&d=identicon&r=PG&f=1", "display_name": "greybeard", "link": "https://stackoverflow.com/users/3789665/greybeard"}, "edited": false, "score": 0, "creation_date": 1516208963, "post_id": 48306307, "comment_id": 83598070, "body": "@greybeard Oh, that... Sure."}, {"owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "reply_to_user": {"reputation": 52, "user_id": 3680288, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d036318cd7126e8ba513ccb8199843f1?s=128&d=identicon&r=PG&f=1", "display_name": "klm", "link": "https://stackoverflow.com/users/3680288/klm"}, "edited": false, "score": 0, "creation_date": 1516209563, "post_id": 48306307, "comment_id": 83598429, "body": "@klm You will need to implement your own binary search that looks for the insertion position, rather than using <code>bsearch</code>. Fortunately, this is one of the easier algorithms to implement :-)"}, {"owner": {"reputation": 52, "user_id": 3680288, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d036318cd7126e8ba513ccb8199843f1?s=128&d=identicon&r=PG&f=1", "display_name": "klm", "link": "https://stackoverflow.com/users/3680288/klm"}, "edited": false, "score": 0, "creation_date": 1516209655, "post_id": 48306307, "comment_id": 83598474, "body": "@dasblinkenlight insertion of what?"}, {"owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "reply_to_user": {"reputation": 52, "user_id": 3680288, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d036318cd7126e8ba513ccb8199843f1?s=128&d=identicon&r=PG&f=1", "display_name": "klm", "link": "https://stackoverflow.com/users/3680288/klm"}, "edited": false, "score": 0, "creation_date": 1516209769, "post_id": 48306307, "comment_id": 83598534, "body": "@klm Insertion position of the missing element to maintain the order of the sequence. E.g. in a sequence of 1 2 4 8 10 15 the insertion position of 7 would be 3 (between 4 and 8)."}, {"owner": {"reputation": 52, "user_id": 3680288, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d036318cd7126e8ba513ccb8199843f1?s=128&d=identicon&r=PG&f=1", "display_name": "klm", "link": "https://stackoverflow.com/users/3680288/klm"}, "edited": false, "score": 0, "creation_date": 1516209834, "post_id": 48306307, "comment_id": 83598569, "body": "@dasblinkenlight i dont understand, im not inserting anything :("}, {"owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "reply_to_user": {"reputation": 52, "user_id": 3680288, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d036318cd7126e8ba513ccb8199843f1?s=128&d=identicon&r=PG&f=1", "display_name": "klm", "link": "https://stackoverflow.com/users/3680288/klm"}, "edited": false, "score": 0, "creation_date": 1516209947, "post_id": 48306307, "comment_id": 83598652, "body": "@klm Binary search algorithm answers the question &quot;if I wanted to maintain the order of the sequence, where would I insert a given number into it?&quot; Please make sure you understand the example that I gave you in the comment above."}], "tags": [], "owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "is_accepted": true, "score": 2, "last_activity_date": 1516209418, "last_edit_date": 1516209418, "creation_date": 1516208305, "answer_id": 48306307, "question_id": 48306191, "link": "https://stackoverflow.com/questions/48306191/fast-way-to-count-smaller-equal-larger-elements-in-array/48306307#48306307", "title": "Fast way to count smaller/equal/larger elements in array", "body": "<p>If the array is unsorted, and the numbers in it have no other useful properties, there is no way to beat an O(n) approach of walking the array once, and counting items in the three buckets.</p>\n\n<p>Sorting the array followed by a binary search would be no better than O(n), assuming that you employ a sort algorithm that is linear in time (e.g. a radix sort). For comparison-based sorts, such as quicksort, the timing would increase to O(n<code>*</code>log<sub>2</sub>n).</p>\n\n<p>On the other hand, sorting would help if you need to run multiple queries against the same set of numbers. The timing for k queries against n numbers would go from O(n<code>*</code>k) for k linear searches to O(n+k<code>*</code>log<sub>2</sub>n) assuming a linear-time sort, or O((n+k)<code>*</code>log<sub>2</sub>n) with comparison-based sort. Given a sufficiently large k, the average query time would go down.</p>\n"}, {"comments": [{"owner": {"reputation": 52, "user_id": 3680288, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d036318cd7126e8ba513ccb8199843f1?s=128&d=identicon&r=PG&f=1", "display_name": "klm", "link": "https://stackoverflow.com/users/3680288/klm"}, "edited": false, "score": 0, "creation_date": 1516224335, "post_id": 48310032, "comment_id": 83606236, "body": "thanks, now i need to find out how to rewrite binary search that returns the index, but doesnt checks equality. so &quot;look for n, if exist return index, if not exixst return index where it should be&quot; and after calling this check equality"}], "tags": [], "owner": {"reputation": 7053, "user_id": 1162141, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7db6bfbfbb420620e6df76c0e406098d?s=128&d=identicon&r=PG", "display_name": "technosaurus", "link": "https://stackoverflow.com/users/1162141/technosaurus"}, "is_accepted": false, "score": 1, "last_activity_date": 1516223386, "creation_date": 1516223386, "answer_id": 48310032, "question_id": 48306191, "link": "https://stackoverflow.com/questions/48306191/fast-way-to-count-smaller-equal-larger-elements-in-array/48310032#48310032", "title": "Fast way to count smaller/equal/larger elements in array", "body": "<ol>\n<li><p>Since the array is (apparently?) not changing, presort it.  This allows a binary search (Log(n))</p>\n\n<p>a.) implement your own version of bsearch (it will be less code anyhow)</p>\n\n<ul>\n<li>you can do it inline using indices vs. pointers </li>\n<li>you won't need function pointers to a specialized function</li>\n</ul>\n\n<p>b.) Since you say that you want to count the number of matches, you imply that the array can contain multiple entries with the same value (otherwise you would have used a boolean has_n).</p>\n\n<ul>\n<li>This means you'll need to do a linear search for the beginning and end of the array of \"n\"s.</li>\n<li>From which you can calculate the number less than n and greater than n. </li>\n<li>It appears that you have some unwritten algorithm for choosing these (for n=3 you look for count of values greater and less than 2 and equal to 1, so there is no way to give specific code)</li>\n</ul>\n\n<p>c.)  For further optimization (at the expense of memory) you can sort the data into a binary search tree of structs that holds not just the value, but also the count and the number of values before and after each value.  It may not use more memory at all if you have a lot of repeat values, but it is hard to tell without the dataset.</p></li>\n<li><p>That's as much as I can help without code that describes your hidden algorithms and data or at least a sufficient description (aside from recommending a course or courses in data structures and algorithms).</p></li>\n</ol>\n"}], "owner": {"reputation": 52, "user_id": 3680288, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d036318cd7126e8ba513ccb8199843f1?s=128&d=identicon&r=PG&f=1", "display_name": "klm", "link": "https://stackoverflow.com/users/3680288/klm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 204, "favorite_count": 1, "accepted_answer_id": 48306307, "answer_count": 2, "score": 1, "last_activity_date": 1516223386, "creation_date": 1516207916, "last_edit_date": 1516210510, "question_id": 48306191, "link": "https://stackoverflow.com/questions/48306191/fast-way-to-count-smaller-equal-larger-elements-in-array", "title": "Fast way to count smaller/equal/larger elements in array", "body": "<p>I need to optimize my algorithm for counting larger/smaller/equal numbers in array(unsorted), than a given number.</p>\n\n<p>I have to do this a lot of times and given array also can have thousands of elements.</p>\n\n<p>Array doesn't change, number is changing</p>\n\n<p>Example:</p>\n\n<p>array: 1,2,3,4,5</p>\n\n<p>n = 3</p>\n\n<ul>\n<li>Number of &lt;: 2 </li>\n<li>Number of >: 2</li>\n<li>Number of ==:1</li>\n</ul>\n\n<p><strong>First thought:</strong></p>\n\n<p>Iterate through the array and check if element is > or &lt; or == than n.\n<strong>O(n*k)</strong></p>\n\n<h2>Possible optimization:</h2>\n\n<p><strong>O((n+k) * logn)</strong></p>\n\n<p>Firstly sort the array (im using c qsort), then use binary search to find equal number, and then somehow count smaller and larger values. But how to do that?</p>\n\n<p>If elements exists (bsearch returns pointer to the element) I also need to check if array contain possible duplicates of this elements (so I need to check before and after this elements while they are equal to found element), and then use some pointer operations to count larger and smaller values.\nHow to get number of values larger/smaller having a pointer to equal element? \nBut what to do if I don't find the value (bsearch returns null)?</p>\n"}, {"tags": ["c++", "c", "stm32", "fat32", "fatfs"], "answers": [{"comments": [{"owner": {"reputation": 353, "user_id": 9090821, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KgpAu.jpg?s=128&g=1", "display_name": "MemAllox", "link": "https://stackoverflow.com/users/9090821/memallox"}, "edited": false, "score": 0, "creation_date": 1516219098, "post_id": 48309021, "comment_id": 83603573, "body": "If this does not help you, please give additional information: show your code, which library are you using,..."}, {"owner": {"reputation": 1, "user_id": 8688286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9dc2bf3f970956fa6530e1dc52a1eac3?s=128&d=identicon&r=PG&f=1", "display_name": "M.kh", "link": "https://stackoverflow.com/users/8688286/m-kh"}, "edited": false, "score": 0, "creation_date": 1516258346, "post_id": 48309021, "comment_id": 83616126, "body": "I&#39;m using FATFS_V010B, before that this program has been tested by stm32f429 discovery board and it was ok but with my board not ok, i checked the pins 100 times and it was ok and crystal has 8MHZ frequency. the initialize return is SD_OK."}], "tags": [], "owner": {"reputation": 353, "user_id": 9090821, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KgpAu.jpg?s=128&g=1", "display_name": "MemAllox", "link": "https://stackoverflow.com/users/9090821/memallox"}, "is_accepted": false, "score": 0, "last_activity_date": 1516218993, "creation_date": 1516218993, "answer_id": 48309021, "question_id": 48306098, "link": "https://stackoverflow.com/questions/48306098/fr-not-enabled-fat-fs-error-when-read-sd-card/48309021#48309021", "title": "FR_Not_Enabled Fat_fs error when read sd card?", "body": "<p>It's difficult to help you without any further information, but maybe the following thread is helpful to you:\n<a href=\"https://stackoverflow.com/q/37897576/8484720\">STM32 : FatFs Library - f_mount</a></p>\n"}], "owner": {"reputation": 1, "user_id": 8688286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9dc2bf3f970956fa6530e1dc52a1eac3?s=128&d=identicon&r=PG&f=1", "display_name": "M.kh", "link": "https://stackoverflow.com/users/8688286/m-kh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1159, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1516218993, "creation_date": 1516207589, "question_id": 48306098, "link": "https://stackoverflow.com/questions/48306098/fr-not-enabled-fat-fs-error-when-read-sd-card", "title": "FR_Not_Enabled Fat_fs error when read sd card?", "body": "<p>i am using stmf429 mcu,Ive designed the board by myself,</p>\n\n<p>want to read sd card and open it but the f_mount has an error(FR_Not_Enabled).the in initialize is ok. </p>\n"}, {"tags": ["c", "sockets", "nonblocking", "recvfrom"], "comments": [{"owner": {"reputation": 2975, "user_id": 5559342, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/39185a39d1b8b29d0b51564f7d55164e?s=128&d=identicon&r=PG&f=1", "display_name": "Robb1", "link": "https://stackoverflow.com/users/5559342/robb1"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1516207401, "post_id": 48305917, "comment_id": 83597034, "body": "@EugeneSh. thanks for your answer. I understand what the problem is, but how can I solve it? Can I ignore this problem and loop with recvfrom again?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1516207708, "post_id": 48305917, "comment_id": 83597239, "body": "Increase the timeout or make it completely blocking (if possible)."}, {"owner": {"reputation": 2975, "user_id": 5559342, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/39185a39d1b8b29d0b51564f7d55164e?s=128&d=identicon&r=PG&f=1", "display_name": "Robb1", "link": "https://stackoverflow.com/users/5559342/robb1"}, "reply_to_user": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1516208892, "post_id": 48305917, "comment_id": 83598024, "body": "@ikegami that means that actually I didn&#39;t understand the problem! I thought that using <code>setsockopt()</code> in such a way would simply let me skip the <code>recvfrom</code> if I wasn&#39;t receiving anything and go on with the following code... not making it return with an error!"}, {"owner": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1516221851, "post_id": 48305917, "comment_id": 83605015, "body": "Comments are not for new questions. Existing questions are not for new questions.  If you have a question to ask, click <a href=\"https://stackoverflow.com/questions/ask\">Ask Question</a>."}], "answers": [{"tags": [], "owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "is_accepted": true, "score": 1, "last_activity_date": 1516217154, "creation_date": 1516217154, "answer_id": 48308563, "question_id": 48305917, "link": "https://stackoverflow.com/questions/48305917/recvfrom-resource-temporarily-unavailable-why/48308563#48308563", "title": "recvfrom: Resource temporarily unavailable. Why?", "body": "<p>Just modify the code to do what you want. When you get an error, instead of calling <code>perror</code> unconditionally, check if it's a timeout. If it's not a timeout, then call <code>perror</code> and return. If it's a timeout, do whatever it is you want to do when you get a timeout.</p>\n"}], "owner": {"reputation": 2975, "user_id": 5559342, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/39185a39d1b8b29d0b51564f7d55164e?s=128&d=identicon&r=PG&f=1", "display_name": "Robb1", "link": "https://stackoverflow.com/users/5559342/robb1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1415, "favorite_count": 0, "closed_date": 1516375378, "accepted_answer_id": 48308563, "answer_count": 1, "score": 0, "last_activity_date": 1516221777, "creation_date": 1516206999, "last_edit_date": 1516221777, "question_id": 48305917, "link": "https://stackoverflow.com/questions/48305917/recvfrom-resource-temporarily-unavailable-why", "closed_reason": "Duplicate", "title": "recvfrom: Resource temporarily unavailable. Why?", "body": "<p>I'm running this piece of code several times (for a non-blocking <code>recvfrom</code> on a <strong>UDP socket</strong>):</p>\n\n<pre><code>struct timeval read_timeout;\nread_timeout.tv_sec = 0;\nread_timeout.tv_usec = 1000;\nsetsockopt(sockfd, SOL_SOCKET, SO_RCVTIMEO, &amp;read_timeout, sizeof read_timeout);\nssize_t n = recvfrom(sockfd, recvline, sizeof(recvline), 0, NULL, NULL);\nif (n &lt; 0) {\n    perror(\"recvfrom\");\n    return -1;\n} else // ... normal usage\n</code></pre>\n\n<p>Sometimes the program stops and I get the following error from <code>perror</code></p>\n\n<blockquote>\n  <p>recvfrom: Resource temporarily unavailable</p>\n</blockquote>\n\n<p>What could the issue be?</p>\n"}, {"tags": ["c++", "c", "linux", "root"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 5, "creation_date": 1516206900, "post_id": 48305839, "comment_id": 83596733, "body": "No. Privileges are per-process."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 2, "creation_date": 1516206916, "post_id": 48305839, "comment_id": 83596744, "body": "I do not think so, and that would be huge security breach. Only way I know is suid app."}, {"owner": {"reputation": 28, "user_id": 1946274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb9dde31c7985c5a44b5525c23e416ea?s=128&d=identicon&r=PG", "display_name": "CDF", "link": "https://stackoverflow.com/users/1946274/cdf"}, "edited": false, "score": 0, "creation_date": 1516262911, "post_id": 48305839, "comment_id": 83618325, "body": "I agree with the security issue, but the alternative at this moment is to execute the whole program as root, with the consequent security problems (I can&#39;t check for security holes in the whole library sources)"}], "answers": [{"comments": [{"owner": {"reputation": 28, "user_id": 1946274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb9dde31c7985c5a44b5525c23e416ea?s=128&d=identicon&r=PG", "display_name": "CDF", "link": "https://stackoverflow.com/users/1946274/cdf"}, "edited": false, "score": 0, "creation_date": 1516263147, "post_id": 48306035, "comment_id": 83618445, "body": "Oh, good tip, I learnt something new, thanks! At this moment I can&#39;t do this because /dev/mem is opened everytime function is called an not once at startup. But I can try to propose a modification to the function developer."}], "tags": [], "owner": {"reputation": 1056, "user_id": 4319483, "user_type": "registered", "profile_image": "https://graph.facebook.com/668992100/picture?type=large", "display_name": "Bjorn A.", "link": "https://stackoverflow.com/users/4319483/bjorn-a"}, "is_accepted": true, "score": 0, "last_activity_date": 1516207349, "creation_date": 1516207349, "answer_id": 48306035, "question_id": 48305839, "link": "https://stackoverflow.com/questions/48305839/library-so-with-root-privilege/48306035#48306035", "title": "library (.so) with root privilege", "body": "<p>Start the program as root and open /dev/mem as a file. Then change user id to something less intrusive.  The file will keep its original permissions.</p>\n"}, {"comments": [{"owner": {"reputation": 28, "user_id": 1946274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb9dde31c7985c5a44b5525c23e416ea?s=128&d=identicon&r=PG", "display_name": "CDF", "link": "https://stackoverflow.com/users/1946274/cdf"}, "edited": false, "score": 0, "creation_date": 1516288314, "post_id": 48316671, "comment_id": 83634219, "body": "Thanks for your concerns, but we need to write to /dev/mem to turn on/off a device. The function wasn&#39;t written by me but by who designed the board where the device is connected on, so he know what he do. And we don&#39;t have alternatives. As suggested by other, I will try to use seteuid() function to change privileges after open /dev/mem as root."}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "reply_to_user": {"reputation": 28, "user_id": 1946274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb9dde31c7985c5a44b5525c23e416ea?s=128&d=identicon&r=PG", "display_name": "CDF", "link": "https://stackoverflow.com/users/1946274/cdf"}, "edited": false, "score": 0, "creation_date": 1516606160, "post_id": 48316671, "comment_id": 83739741, "body": "@CDF, then probably it is better to use <code>&#47;dev&#47;kmem</code> which maps to the kernel virtual memory space.  That way, you can use the kernel memory map and don&#39;t have to translate yourself.  Anyway, a simple device development would be a better solution, as the way you proceed, there&#39;s no chance to be able to block or to impede simultaneous access to the same place, and crashing the whole system.  I think you don&#39;t know what you are planning.... a device driver would be the solution for that purpose."}, {"owner": {"reputation": 28, "user_id": 1946274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb9dde31c7985c5a44b5525c23e416ea?s=128&d=identicon&r=PG", "display_name": "CDF", "link": "https://stackoverflow.com/users/1946274/cdf"}, "edited": false, "score": 0, "creation_date": 1516612967, "post_id": 48316671, "comment_id": 83743033, "body": "I forward to the developer your suggestion to use /dev/kmem, thanks."}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "reply_to_user": {"reputation": 28, "user_id": 1946274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb9dde31c7985c5a44b5525c23e416ea?s=128&d=identicon&r=PG", "display_name": "CDF", "link": "https://stackoverflow.com/users/1946274/cdf"}, "edited": false, "score": 0, "creation_date": 1516616090, "post_id": 48316671, "comment_id": 83744858, "body": "No, my suggestion was not to use <code>&#47;dev&#47;kmem</code>, but to write a driver... drivers are the only things to control devices..... if you try to control it by writing to <code>&#47;dev&#47;kmem</code> you will crash the thing also.... <code>&#47;dev&#47;kmem</code> is strongly deprecated to use.  Please, never say I have recommended to use <code>&#47;dev&#47;kmem</code> to stop a device... I have never done that.  And also, why is not the developer who asks the questions.  Do you feel you are needed in between?"}, {"owner": {"reputation": 28, "user_id": 1946274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb9dde31c7985c5a44b5525c23e416ea?s=128&d=identicon&r=PG", "display_name": "CDF", "link": "https://stackoverflow.com/users/1946274/cdf"}, "edited": false, "score": 0, "creation_date": 1516697980, "post_id": 48316671, "comment_id": 83783002, "body": "Long story <i>very very</i> short (because comments have a limitation of characters): hardware/library people here are good on hardware/kernel/devices stuffs but are not good about security issues. I am the &quot;last guy&quot; hired and before my arrive they usually used to executed <i>all</i> the software by root (yeah, I known: do you remember the part where I say that they aren&#39;t good on security?). So I am trying to hardening the system. Oh, and I don&#39;t mentioned other constraint that don&#39;t allow us to do it in a different way."}, {"owner": {"reputation": 28, "user_id": 1946274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb9dde31c7985c5a44b5525c23e416ea?s=128&d=identicon&r=PG", "display_name": "CDF", "link": "https://stackoverflow.com/users/1946274/cdf"}, "edited": false, "score": 0, "creation_date": 1516697986, "post_id": 48316671, "comment_id": 83783008, "body": "So, please, stay on topic: the thread IS NOT about if it is a good or bad idea to write on /dev/mem, but about how to write to /dev/mem by unprivileged user. The answear is &quot;NOT directly&quot;, but as suggested by Bjorn, I can start the program as root, open the file and than change the effective user id."}], "tags": [], "owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "is_accepted": false, "score": 2, "last_activity_date": 1516264228, "last_edit_date": 1516264228, "creation_date": 1516263631, "answer_id": 48316671, "question_id": 48305839, "link": "https://stackoverflow.com/questions/48305839/library-so-with-root-privilege/48316671#48316671", "title": "library (.so) with root privilege", "body": "<p>The quick answer is <strong>NO</strong>.  You cannot switch userids on a per-library basis, as the user identity is a per-process property (you should know at least this, if you are trying to dig into the <code>/dev/mem</code> device).</p>\n\n<p>Runtime library loading is a library task (it is done by a shared object called the dynamic loader, <code>ld-linux-x86-64.so.2</code>, in my system) and it is done at runtime, so no privileged access can be granted to it, for security reasons.</p>\n\n<p>Anyway, the setuid property for a program allows you to switch privileges between the <em>effective</em> user (this is the setuid user) and the <em>real</em> user (the user who executes the program) and back, so in the special case of the <code>root</code> account, you can use it to access <code>/dev/mem</code>.</p>\n\n<p>Anyway, apart of the access problem, writing to <code>/dev/mem</code> is very dangerous, as it maps to the physical address space of the machine (so, it's there as physical pages, from different processes and the kernel, with no apparent order).  This has to be done with the translation table available, as pages come and go to swap in a very dynamic way.  And you are touching kernel memory anyway, so you have to extreme care when writing there.  I don't know what do you want to do, but you had better to think twice before writing there (as from your question, you don't know a process' properties well enough, it's most probable you don't know also the virtual to physical translation of pages that is being held in the kernel).</p>\n\n<p>But if you want to crash your system, this is the perfect way to do.  Anyway, if that is the target you pursue, then just make the whole program setuid root (if you know what this sentence mean) and go ahead.  Or even better, do it as the root user, so you don't need to worry about setuid or the like.</p>\n"}], "owner": {"reputation": 28, "user_id": 1946274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb9dde31c7985c5a44b5525c23e416ea?s=128&d=identicon&r=PG", "display_name": "CDF", "link": "https://stackoverflow.com/users/1946274/cdf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 175, "favorite_count": 0, "accepted_answer_id": 48306035, "answer_count": 2, "score": 0, "last_activity_date": 1516264228, "creation_date": 1516206768, "question_id": 48305839, "link": "https://stackoverflow.com/questions/48305839/library-so-with-root-privilege", "title": "library (.so) with root privilege", "body": "<p>I have a C++ program that uses some C libraries. The program is executed as an \"unprivileged\" user but one and only one function of a library (.so) loaded by the program need root privileges (it needs to write to /dev/mem).</p>\n\n<p>Do exists a way to have only that function or only that library executed as root, leaving all the rest code \"unprivileged\"?</p>\n\n<p>Thanks to all,\nCristian</p>\n"}, {"tags": ["c", "typedef"], "comments": [{"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1516206588, "post_id": 48305734, "comment_id": 83596538, "body": "either make it a common include, or rename one of the SHORT idents. Is that a typedef?"}, {"owner": {"reputation": 22818, "user_id": 509868, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/83450238b4ee0eddbf54d7ce5a3a64e4?s=128&d=identicon&r=PG", "display_name": "anatolyg", "link": "https://stackoverflow.com/users/509868/anatolyg"}, "edited": false, "score": 3, "creation_date": 1516206690, "post_id": 48305734, "comment_id": 83596602, "body": "You can <a href=\"https://stackoverflow.com/posts/48305734/edit\">edit</a> your question to add relevant details (i.e. code)"}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 4, "creation_date": 1516206726, "post_id": 48305734, "comment_id": 83596629, "body": "trick answer: use better libraries, that don&#39;t do such ugly things. <code>typedef</code>ing <code>SHORT</code> as <code>int</code>, really?"}, {"owner": {"reputation": 2704, "user_id": 6794772, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/2d8db2b0d48b6e1b25657fda9ec4ae02?s=128&d=identicon&r=PG&f=1", "display_name": "Dellowar", "link": "https://stackoverflow.com/users/6794772/dellowar"}, "edited": false, "score": 0, "creation_date": 1516219120, "post_id": 48305734, "comment_id": 83603588, "body": "...These libraries might as well <code>#define if else</code> while they&#39;re at it."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1516324271, "post_id": 48305734, "comment_id": 83651093, "body": "Place the #include for the header files in different source files,  Then each source file only accesses the functions in the related header file."}], "answers": [{"comments": [{"owner": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "edited": false, "score": 0, "creation_date": 1516210023, "post_id": 48305859, "comment_id": 83598703, "body": "&quot;<i>fancy name for a C file</i>&quot; ... I like that :)"}, {"owner": {"reputation": 48201, "user_id": 1250772, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/633e1f643d2c9b043231b4a32b078907?s=128&d=identicon&r=PG", "display_name": "Kaz", "link": "https://stackoverflow.com/users/1250772/kaz"}, "reply_to_user": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "edited": false, "score": 0, "creation_date": 1516210272, "post_id": 48305859, "comment_id": 83598835, "body": "@machine_1 Except it isn&#39;t. The translation unit may be organized around a C file, but it consists of all the material from the include files also."}], "tags": [], "owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "is_accepted": false, "score": 7, "last_activity_date": 1516206822, "creation_date": 1516206822, "answer_id": 48305859, "question_id": 48305734, "link": "https://stackoverflow.com/questions/48305734/c-project-two-libraries-use-same-typedef-identifier-for-different-types/48305859#48305859", "title": "C Project - two libraries use same typedef identifier for different types", "body": "<p>You need to restructure your project in such a way that no translation unit of your library would have to include headers from both libraries (translation unit is a fancy name for a C file).</p>\n\n<p>One approach is to write your own thin \"wrapper\" functions around MODBUS2 and FatFs functionality. Each wrapper would have to include headers for the library that it wraps, so there would be no compile-time collision. Then the main module of your library would program to your \"wrappers\", without including MODBUS2 or FatFs headers at all.</p>\n"}, {"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1516234620, "post_id": 48305908, "comment_id": 83609880, "body": "Note that repeating a <code>typedef</code> without error requires C11 support."}], "tags": [], "owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "is_accepted": false, "score": 1, "last_activity_date": 1516206954, "creation_date": 1516206954, "answer_id": 48305908, "question_id": 48305734, "link": "https://stackoverflow.com/questions/48305734/c-project-two-libraries-use-same-typedef-identifier-for-different-types/48305908#48305908", "title": "C Project - two libraries use same typedef identifier for different types", "body": "<p>The libraries which use those <code>SHORT</code> typedefs without any prefix are ill-designed, since there are no namespaces in C, so they're strongly constraining the users. Ok, but we have to live with that.</p>\n\n<p>If the typedefs were defining the same type, there would be no problem as you can repeat:</p>\n\n<pre><code>typedef int SHORT;\ntypedef int SHORT;\n</code></pre>\n\n<p>as many times you want as long as it defines the same base type. But here the types are different, so that's the issue.</p>\n\n<p>One hack would be to use a \"word-only\" replace on all of the FatFs library includes/sources for instance to replace <code>SHORT</code> by <code>FF_SHORT</code>.</p>\n\n<p>now you can include both libraries without any conflict.</p>\n\n<ul>\n<li>main advantage: no need for more changes or wrappers (like the superior other answer suggests): quick &amp; dirty.</li>\n<li>main drawback: must be done at each upgrade of the library interface.</li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1516219958, "post_id": 48306181, "comment_id": 83604006, "body": "If you&#39;re going to go down this route, put the code you show in a new header file, and where you include both library headers, replace the two lines of code with a single include of your composite file.  Then, when there are another pair of collisions after the next release of one of the libraries, you only have one file to edit.  Beware &quot;boiled frog&quot; syndrome: you have one collision now; it is &#39;simple&#39; to patch the 20 files, so you add the preprocessor magic to each file. Then the new version comes out, and you go and patch the 20 files again. Rinse and repeat; it gets worse over time."}], "tags": [], "owner": {"reputation": 22818, "user_id": 509868, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/83450238b4ee0eddbf54d7ce5a3a64e4?s=128&d=identicon&r=PG", "display_name": "anatolyg", "link": "https://stackoverflow.com/users/509868/anatolyg"}, "is_accepted": false, "score": 3, "last_activity_date": 1516207866, "creation_date": 1516207866, "answer_id": 48306181, "question_id": 48305734, "link": "https://stackoverflow.com/questions/48305734/c-project-two-libraries-use-same-typedef-identifier-for-different-types/48306181#48306181", "title": "C Project - two libraries use same typedef identifier for different types", "body": "<p>Suppose library 1 has</p>\n\n<pre><code>typedef int SHORT;\n</code></pre>\n\n<p>and library 2 has</p>\n\n<pre><code>typedef short SHORT;\n</code></pre>\n\n<p>Suppose you have this code:</p>\n\n<pre><code>#include \"lib1.h\"\n#include \"lib2.h\"\n</code></pre>\n\n<p>You might be able to fix the compilation error like this:</p>\n\n<pre><code>#define SHORT LIB1_SHORT\n#include \"lib1.h\"\n#undef SHORT\n#define SHORT LIB2_SHORT\n#include \"lib2.h\"\n#undef SHORT\n</code></pre>\n\n<p>If you do this, you should do it consistently for all <code>#include</code> directives in your code. If you don't have too many <code>#include</code>s, this is not too tedious.</p>\n\n<p>If you don't want to keep these rules in mind all the time, stuff the <code>#define</code> and <code>#undef</code> as first and last thing in all problematic library headers.</p>\n"}], "owner": {"reputation": 51, "user_id": 9230584, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3a517a050f817e0f2b8ff2b8faac155?s=128&d=identicon&r=PG&f=1", "display_name": "VC-C", "link": "https://stackoverflow.com/users/9230584/vc-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 518, "favorite_count": 0, "answer_count": 3, "score": 5, "last_activity_date": 1516207866, "creation_date": 1516206450, "last_edit_date": 1516206693, "question_id": 48305734, "link": "https://stackoverflow.com/questions/48305734/c-project-two-libraries-use-same-typedef-identifier-for-different-types", "title": "C Project - two libraries use same typedef identifier for different types", "body": "<p>I'm working on a project using the MODBUS2 lib, and I want to add the FatFs lib to it to interface with an SD card. Both libraries use identifier <code>SHORT</code> for <code>short</code> and <code>int</code> respectively, and the compiler throws this error: </p>\n\n<pre><code>#258 invalid redeclaration of type name \"SHORT\" \n</code></pre>\n\n<p>How can I work around this?</p>\n"}, {"tags": ["c", "macros"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1516206443, "post_id": 48305691, "comment_id": 83596443, "body": "<code>uint32_t</code> is not a &quot;built-in&quot; c type, so it doesn&#39;t have specific built-in suffixes or literals having this type."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1516209461, "post_id": 48305691, "comment_id": 83598363, "body": "@Snoopy, Although defining a number to a specific type is often useful, I have found it often masks a higher level problem.  Knowing code&#39;s need for this type, answers could address such concerns."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1516209861, "post_id": 48305691, "comment_id": 83598583, "body": "Note that casts in macro <code>#if</code> processioning have nil effect.  With <code>#if CLOCK_FREQUENCY  ...</code>, the value is still type 64-bit (or more) then."}], "answers": [{"comments": [{"owner": {"reputation": 954, "user_id": 2152513, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/d656bd1d7ebf7873d08d4b7a430c0b97?s=128&d=identicon&r=PG&f=1", "display_name": "Snoop", "link": "https://stackoverflow.com/users/2152513/snoop"}, "edited": false, "score": 0, "creation_date": 1516206608, "post_id": 48305731, "comment_id": 83596551, "body": "I always thought a cast could only be executed at run-time, so I didn&#39;t see that as an option. Thank you."}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "reply_to_user": {"reputation": 954, "user_id": 2152513, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/d656bd1d7ebf7873d08d4b7a430c0b97?s=128&d=identicon&r=PG&f=1", "display_name": "Snoop", "link": "https://stackoverflow.com/users/2152513/snoop"}, "edited": false, "score": 1, "creation_date": 1516206773, "post_id": 48305731, "comment_id": 83596656, "body": "@Snoopy Macros just cause simple text substitution, so the cast will notionally occur wherever the macro is expanded. More generally, whether a cast really incurs any additional code at runtime is an implementation detail, but basically, it won&#39;t if it doesn&#39;t have to."}], "tags": [], "owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "is_accepted": false, "score": 1, "last_activity_date": 1516206420, "creation_date": 1516206420, "answer_id": 48305731, "question_id": 48305691, "link": "https://stackoverflow.com/questions/48305691/how-can-i-assign-the-type-to-a-macro-defined-number/48305731#48305731", "title": "How can I assign the type to a macro-defined number?", "body": "<p>You can define a macro that includes the cast to the desired type, like this:</p>\n\n<pre><code>#define CLOCK_FREQUENCY ((uint32_t)16000000)\n</code></pre>\n\n<p>This lets you avoid integer literal notation altogether.</p>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 2, "last_activity_date": 1516209092, "last_edit_date": 1516209092, "creation_date": 1516206945, "answer_id": 48305906, "question_id": 48305691, "link": "https://stackoverflow.com/questions/48305691/how-can-i-assign-the-type-to-a-macro-defined-number/48305906#48305906", "title": "How can I assign the type to a macro-defined number?", "body": "<blockquote>\n  <p>How can I assign the type to a macro-defined number?</p>\n</blockquote>\n\n<p>For <code>uint32_t</code>, use a cast as well answered by <a href=\"https://stackoverflow.com/users/335858/dasblinkenlight\">@dasblinkenlight</a></p>\n\n<hr>\n\n<p>There are pitfalls to casting.</p>\n\n<p>A cast may <em>narrow</em> the constant as below when <code>unsigned</code> is 16-bit.   A cast may not generate a warnings about this as the compiler assumes the programmer is correct.</p>\n\n<pre><code>// Becomes  9216 on a 16-bit `unsigned.\n#define CLOCK_FREQUENCY ((unsigned) 16000000)\n</code></pre>\n\n<hr>\n\n<p>C with <code>&lt;stdint.h&gt;</code> provides <em>Macros for minimum-width integer constants</em>.  I find the <code>((uint32_t)16000000)</code> preferable</p>\n\n<p>The below results in a <code>uint_least32_t</code>, which is commonly the same as <code>uint32_t</code>.</p>\n\n<pre><code>UINT32_C(16000000)\n</code></pre>\n\n<hr>\n\n<p>When a type that is needed to accommodate the constant, often a cast is not used.</p>\n\n<pre><code>#define CLOCK_FREQUENCY 16000000U\n</code></pre>\n\n<p>When a specific type is needed, casting is a good idea.  </p>\n\n<pre><code>#define CLOCK_FREQUENCY ((uint32_t) 16000000U)\n</code></pre>\n\n<p>When a type is needed that is <em>at least</em> the width of a type, be more gentile.</p>\n\n<pre><code>#define FOO 16000000000U\n#define CLOCK_FREQUENCY (((uint32_t) 1) * FOO)\n</code></pre>\n\n<hr>\n\n<p>Notes: </p>\n\n<p>In C, <code>16000000UL</code> is not a <em>literal</em>, but a <em>constant</em>.  <em>Literals</em> can have their address taken.</p>\n\n<p>Further, the <code>L</code> in <code>16000000UL</code> only serves to widen a constant, in this case to at least <code>unsigned long</code>.  With a  <code>long</code> as a 64-bit, this widening may not be needed.\n <code>16000000U</code> is sufficient to form  a constant as wide as needed.  </p>\n\n<p><code>UL</code> does not force the constant to be <code>unsigned long</code>, but only <em>at least</em> <code>unsigned long</code>.   <code>16000000000UL</code> may be type <code>unsigned long long</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1516208581, "post_id": 48305951, "comment_id": 83597812, "body": "Aside: I find <code>UINTN_C(value)</code> sometimes a surprise  when <code>N</code> &lt; <code>int&#47;unsigned</code> bit width .  <code>UINT8_C(42)</code> may result in a <code>unsigned&#47;uint32_t</code> type and not an <code>unint8_t</code>.  Further the sign-ness is not assured.  I&#39;d, at first, expect <code>printf(&quot;%d\\n&quot;, (UINT8_C(-5)) &lt; 0  );</code> to be false."}], "tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": false, "score": 1, "last_activity_date": 1516207102, "creation_date": 1516207102, "answer_id": 48305951, "question_id": 48305691, "link": "https://stackoverflow.com/questions/48305691/how-can-i-assign-the-type-to-a-macro-defined-number/48305951#48305951", "title": "How can I assign the type to a macro-defined number?", "body": "<p>The standard provides macros for that job in <code>&lt;stdint.h&gt;</code>:</p>\n\n<blockquote>\n  <h3><a href=\"https://port70.net/~nsz/c/c11/n1570.html#7.20.4.1\" rel=\"nofollow noreferrer\">C11 7.20.4.1</a> Macros for minimum-width integer constants</h3>\n  \n  <p>\u00b61 The macro <code>INTN_C(value)</code> shall expand to an integer constant expression\n  corresponding to the type <code>int_leastN_t</code>. The macro <code>UINTN_C(value)</code> shall expand\n  to an integer constant expression corresponding to the type <code>uint_leastN_t</code>. For\n  example, if <code>uint_least64_t</code> is a name for the type <code>unsigned long long int</code>,\n  then <code>UINT64_C(0x123)</code> might expand to the integer constant <code>0x123ULL</code>.</p>\n</blockquote>\n\n<p>That means you could write:</p>\n\n<pre><code>#define CLOCK_FREQUENCY UINT32_C(16000000)\n</code></pre>\n\n<p>The advantage is that <code>uint_least32_t</code> is guaranteed to exist where <code>uint32_t</code> is not guaranteed to exist.  The downside is that <code>uint_least32_t</code> might not be the same type as <code>uint32_t</code> (but that can only happen if there is no <code>uint32_t</code>, so your code might not fail to compile on account of your constant even though it would if you managed to use <code>uint32_t</code> directly.  I suppose you could tinker with <code>(uint32_t)UINT32_C(16000000)</code>, but that seems like a serious case of overkill.</p>\n"}], "owner": {"reputation": 954, "user_id": 2152513, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/d656bd1d7ebf7873d08d4b7a430c0b97?s=128&d=identicon&r=PG&f=1", "display_name": "Snoop", "link": "https://stackoverflow.com/users/2152513/snoop"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 804, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1516209092, "creation_date": 1516206289, "question_id": 48305691, "link": "https://stackoverflow.com/questions/48305691/how-can-i-assign-the-type-to-a-macro-defined-number", "title": "How can I assign the type to a macro-defined number?", "body": "<p>In general, I kind of understand how integer literals work within macros. So if I wanted to define something as an <code>unsigned long</code> within a macro I would produce the following code:</p>\n\n<p><code>#define CLOCK_FREQUENCY 16000000UL</code></p>\n\n<p>That's my general understanding of integer literals.</p>\n\n<p>What I am aiming to do however, is designate a number as <code>uint32_t</code> inside of my macro. In trying to find a way to do this, I haven't discovered any integer literals that would correspond to <code>uint32_t</code>. So, is there a way to actually designate a number as a <code>uint32_t</code> or other type (for that matter) not available by integer literal notation?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 54921, "user_id": 294949, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/3326427b9c2edc60ad293fdf51c5ba4c?s=128&d=identicon&r=PG&f=1", "display_name": "danh", "link": "https://stackoverflow.com/users/294949/danh"}, "edited": false, "score": 0, "creation_date": 1516205764, "post_id": 48305413, "comment_id": 83596030, "body": "I don&#39;t see any code that writes anything.  Debug tip: first just prove you can read a few bytes and write them."}, {"owner": {"reputation": 23, "user_id": 8896011, "user_type": "registered", "profile_image": "https://graph.facebook.com/1866893003351364/picture?type=large", "display_name": "Chris Petrou", "link": "https://stackoverflow.com/users/8896011/chris-petrou"}, "reply_to_user": {"reputation": 54921, "user_id": 294949, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/3326427b9c2edc60ad293fdf51c5ba4c?s=128&d=identicon&r=PG&f=1", "display_name": "danh", "link": "https://stackoverflow.com/users/294949/danh"}, "edited": false, "score": 0, "creation_date": 1516206520, "post_id": 48305413, "comment_id": 83596498, "body": "i have also that part in my code that i can write on the file but i am just not sure if my fread is correct.... FILE *write_ptr; write_ptr=fopen(&quot;movies.dat&quot;,&quot;wb&quot;); fseek(write_ptr,0,SEEK_END); fwrite(p,sizeof(node),1,write_ptr); fclose(write_ptr);"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 1, "creation_date": 1516206805, "post_id": 48305413, "comment_id": 83596678, "body": "Please don&#39;t put this code into comments, but putit in the question. You should at least provide some complete function, not only snippets without context."}, {"owner": {"reputation": 54921, "user_id": 294949, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/3326427b9c2edc60ad293fdf51c5ba4c?s=128&d=identicon&r=PG&f=1", "display_name": "danh", "link": "https://stackoverflow.com/users/294949/danh"}, "edited": false, "score": 3, "creation_date": 1516207090, "post_id": 48305413, "comment_id": 83596873, "body": "Debug tip:  before any processing, prove you can read and write by simply echoing the contents of the input file into the output."}, {"owner": {"reputation": 849, "user_id": 4086095, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CMn9X.jpg?s=128&g=1", "display_name": "Tsakiroglou Fotis", "link": "https://stackoverflow.com/users/4086095/tsakiroglou-fotis"}, "edited": false, "score": 0, "creation_date": 1516207258, "post_id": 48305413, "comment_id": 83596963, "body": "First of all , where is the List?"}], "answers": [{"tags": [], "owner": {"reputation": 849, "user_id": 4086095, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CMn9X.jpg?s=128&g=1", "display_name": "Tsakiroglou Fotis", "link": "https://stackoverflow.com/users/4086095/tsakiroglou-fotis"}, "is_accepted": true, "score": 1, "last_activity_date": 1516207887, "last_edit_date": 1516207887, "creation_date": 1516207425, "answer_id": 48306049, "question_id": 48305413, "link": "https://stackoverflow.com/questions/48305413/how-to-read-the-data-from-the-binary-file-and-create-lists-in-c/48306049#48306049", "title": "how to read the data from the binary file and create lists in c?", "body": "<p>First of all a list should look like this\nInside the header file :</p>\n\n<pre><code>typedef struct Node_t Node;\n\nstruct Node_t\n{\n    void* data;\n    int id;\n    Node_t* next_node; //next node\n};\n\ntypedef struct List_t\n{\n    int number_of_nodes;\n    Node_t* start_index;  //pointer , points at first node , start of the list.\n}List;\n</code></pre>\n\n<p>So upon reading (which seems ok) , for each movie you have to create a structure to hold movie data.Let's say </p>\n\n<pre><code>typedef struct Movie_t\n{\n    char name[16];\n    int year;\n}Movie_t;\n</code></pre>\n\n<p>So in every element you read you store name and year in a struct and then you create a Node_t that points for void* data in the pointer of the Movie_t object and you add Node_t in list.</p>\n"}, {"tags": [], "owner": {"reputation": 5000, "user_id": 8405835, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sN3eq.png?s=128&g=1", "display_name": "Abhijit Pritam Dutta", "link": "https://stackoverflow.com/users/8405835/abhijit-pritam-dutta"}, "is_accepted": false, "score": 1, "last_activity_date": 1516212553, "creation_date": 1516212553, "answer_id": 48307400, "question_id": 48305413, "link": "https://stackoverflow.com/questions/48305413/how-to-read-the-data-from-the-binary-file-and-create-lists-in-c/48307400#48307400", "title": "how to read the data from the binary file and create lists in c?", "body": "<p>Your code is not enough to help you where exactly you made the mistake. Hence I have developed the below codes for you. Just modify the structure for more field and change the code accordingly so that you can learn properly.</p>\n\n<pre><code>    struct Movie\n    {\n            char  *name;\n            char  *date;\n            struct Movie *next;\n    };\n\n    struct Movie * initialize(char *);\n    void display(struct Movie *);\n\n    int main()\n    {\n            struct Movie *head;\n            char fname[100];\n            head=initialize(\"movies.dat\");\n            display(head);\n    }\n\n    struct Movie * initialize(char *fname)\n    {\n            FILE* fpointer;\n            char ch;\n            fpointer = fopen(fname,\"r\");\n            if(fpointer == NULL)\n            {\n\n                    printf(\"\\nFile not found\");\n                    exit(1);\n            }\n\n            //FILE IS OPENED\n            struct Movie *head=NULL;\n            struct Movie *t;\n            char line[255];\n            char sent[2]=\";\";\n\n            while(!feof(fpointer) &amp;&amp; fgets(line,sizeof line,fpointer))\n            {\n                char *name=strtok(line,sent);\n                char *date=strtok(NULL,sent);\n                    if(head == NULL)\n                    {\n                              head=(struct Movie*)malloc(sizeof(struct Movie));\n                              t = head;\n                              t-&gt;name = (char *)malloc(strlen(name));\n                              t-&gt;date = (char *)malloc(strlen(date));\n                              strcpy(t-&gt;name,name);\n                              strcpy(t-&gt;date,date);\n                              t-&gt;next=NULL;\n                    }\n                    else\n                    {\n                            t-&gt;next=(struct Movie*)malloc(sizeof(struct Movie));\n                            t=t-&gt;next;\n                            t-&gt;name = (char *)malloc(strlen(name));\n                            t-&gt;date = (char *)malloc(strlen(date));\n                            strcpy(t-&gt;name,name);\n                            strcpy(t-&gt;date,date);\n                            t-&gt;next=NULL;\n                    }\n            }\n            return head;\n    }\n\n    void display(struct Movie *h)\n    {\n            while(h!=NULL)\n            {\n                    printf(\"Name :%20s        %10s\\n\",h-&gt;name,h-&gt;date);\n                    h=h-&gt;next;\n            }\n    }\n</code></pre>\n\n<p>now create movies.dat with below information:-</p>\n\n<p>The Godfather;1972;\nSnatch;2000;</p>\n\n<p>here in the file you can add as many as film information. Here every field has been separated by <code>;</code> you can separate field with any special character as per your wish but you need to make necessary changes in the below line of code each time.</p>\n\n<pre><code> char sent[2]=\";\";\n</code></pre>\n\n<p>Your field separator can be any character for example  <code>The Godfather|1972|</code> in this case you need to modify your code like <code>char sent[2]=\"|\";</code> Better give it a proper name like <code>char seperator[2]=\":\";</code> here your separator is <code>:</code></p>\n\n<p>Also do not forget to add header files , and </p>\n\n<p>Wish you all the very best.</p>\n"}], "owner": {"reputation": 23, "user_id": 8896011, "user_type": "registered", "profile_image": "https://graph.facebook.com/1866893003351364/picture?type=large", "display_name": "Chris Petrou", "link": "https://stackoverflow.com/users/8896011/chris-petrou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 208, "favorite_count": 0, "accepted_answer_id": 48306049, "answer_count": 2, "score": 2, "last_activity_date": 1516212553, "creation_date": 1516205379, "question_id": 48305413, "link": "https://stackoverflow.com/questions/48305413/how-to-read-the-data-from-the-binary-file-and-create-lists-in-c", "title": "how to read the data from the binary file and create lists in c?", "body": "<p>I am trying to read a binary file which it has names,years, from movies and then to create a list from that file data....but when am using this code am getting a blank screen.</p>\n\n<pre><code>struct node *next;\n    }node;\n    node *head;\n    node *tail;\n     node*inventory = NULL;\n    int main(int argc , char * argv){\n        node *current;\n        node n;\n        node *p;\n    FILE *ptr;\n    ptr=fopen(\"movies.dat\", \"rb\");\n    head= NULL;\n    while(!feof(ptr))\n    {\n        p = (node*)malloc(sizeof(node));\n        if (!head)\n        {\n            head =(node*) malloc(sizeof(node));\n            current = head;\n        }\n        fread(p, sizeof(node), 1, ptr);\n       current-&gt;next = p;\n        p=current;\n    }\n    fclose(ptr);\n</code></pre>\n\n<p>The example output should look like this:</p>\n\n<pre><code>$ ./a.out --list-all\n       The Godfather       1972         245066416.00\n              Snatch       2000          30093108.00\n</code></pre>\n\n<p>Thanks in regards</p>\n"}, {"tags": ["c", "floating-point"], "comments": [{"owner": {"reputation": 200780, "user_id": 116908, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/54d38793d7a407446999b33b81d607fd?s=128&d=identicon&r=PG", "display_name": "Carl Norum", "link": "https://stackoverflow.com/users/116908/carl-norum"}, "edited": false, "score": 1, "creation_date": 1516205286, "post_id": 48305329, "comment_id": 83595732, "body": "Hint: <code>1.1</code> is a <code>double</code>, not a <code>float</code>. Watch out for implicit conversions."}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 1, "creation_date": 1516206435, "post_id": 48305329, "comment_id": 83596441, "body": "<code>==</code> is almost useless for floating point types."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 2, "creation_date": 1516228259, "post_id": 48305329, "comment_id": 83607909, "body": "@dbush: Please do not promiscuously mark floating-point questions as a duplicate of <a href=\"https://stackoverflow.com/questions/588004/is-floating-point-math-broken\">that question</a>. Floating-point has numerous properties and features that can be individually questioned and answered. This question has source code essentially identical to <a href=\"https://stackoverflow.com/questions/18986141/why-does-this-program-gives-no-output-for-float-and-double-datatypes\">this question</a>, which is a <b>much</b> more suitable original."}, {"owner": {"reputation": 24793, "user_id": 1798593, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be41e365336e709f1bfc2c9866eac8e9?s=128&d=identicon&r=PG", "display_name": "Patricia Shanahan", "link": "https://stackoverflow.com/users/1798593/patricia-shanahan"}, "edited": false, "score": 2, "creation_date": 1516230726, "post_id": 48305329, "comment_id": 83608851, "body": "Assuming IEEE 754 binary floating point arithmetic, <code>x</code> is the closest 32-bit approximation to 1.1, 1.10000002384185791015625. <code>1.1</code> is the closest 64-bit approximation to 1.1, 1.100000000000000088817841970012523233890533447265625. They are not equal."}, {"owner": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1516233977, "post_id": 48305329, "comment_id": 83609725, "body": "@EricPostpischil Not only the source code, the question itself is the same. It looks like both posters had the same homework."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 0, "creation_date": 1516237783, "post_id": 48305329, "comment_id": 83610594, "body": "@Bob__: 1.1 is popular: <a href=\"https://stackoverflow.com/questions/17343155/double-and-float-comparison\">1</a>, <a href=\"https://stackoverflow.com/questions/32066576/float-variable-comparison-fails\">2</a>, <a href=\"https://stackoverflow.com/questions/41540392/c-programming-anomaly-behaviour-of-while-loop-for-float-condition\">3</a>, <a href=\"https://stackoverflow.com/questions/9014303/comparing-float-and-double\">4</a>."}], "owner": {"reputation": 61, "user_id": 9207943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91c197133c484fe033d060b96fe26dd5?s=128&d=identicon&r=PG&f=1", "display_name": "Aksh", "link": "https://stackoverflow.com/users/9207943/aksh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "closed_date": 1516205316, "answer_count": 0, "score": 0, "last_activity_date": 1516228287, "creation_date": 1516205163, "last_edit_date": 1516205338, "question_id": 48305329, "link": "https://stackoverflow.com/questions/48305329/while-loop-involving-floating-point-numbers", "closed_reason": "Duplicate", "title": "While loop involving floating point numbers", "body": "<pre><code>#include&lt;stdio.h&gt;\nvoid main()\n{\n float x=1.1;\n while(x==1.1)\n {\n     printf(\"\\n%f\",x);\n     x=x-0.1;\n }\n}\n</code></pre>\n\n<p>I have learnt that while loop can also involve floating point numbers but the above program doesn't show any output. Why is it so ?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 486140, "user_id": 1187415, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/LpTRB.png?s=128&g=1", "display_name": "Martin R", "link": "https://stackoverflow.com/users/1187415/martin-r"}, "edited": false, "score": 3, "creation_date": 1516203864, "post_id": 48304823, "comment_id": 83594742, "body": "<code>n1</code> is always <i>zero</i> when printed. I suggest learning how to use a <i>debugger.</i>"}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 2, "creation_date": 1516203930, "post_id": 48304823, "comment_id": 83594795, "body": "Okay, now that it&#39;s formatted... you never even use the arguments passed in. Where are <code>a</code> and <code>b</code> used?  What are they supposed to be?"}, {"owner": {"reputation": 787, "user_id": 7714006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2bf23fe02b176b9ec4b72f65570e0b5?s=128&d=identicon&r=PG&f=1", "display_name": "Aditi Rawat", "link": "https://stackoverflow.com/users/7714006/aditi-rawat"}, "edited": false, "score": 0, "creation_date": 1516203939, "post_id": 48304823, "comment_id": 83594799, "body": "By the way , you are not anywhere using the parameteres <code>a</code> and <code>b</code> in <code>fibo()</code>"}, {"owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "edited": false, "score": 0, "creation_date": 1516204329, "post_id": 48304823, "comment_id": 83595057, "body": "<code>int n1=a, n2=b</code> will do (partly) the trick, revise the recursion and the end condition"}, {"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 1, "creation_date": 1516204370, "post_id": 48304823, "comment_id": 83595083, "body": "The code you are showing has a syntax error: <code>#include &lt;stdio.h</code>. And where&#39;s the return value for <code>fibo</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 1, "creation_date": 1516204854, "post_id": 48305087, "comment_id": 83595428, "body": "instead of an else clause, couldn&#39;t he just put the recursive call into the if clause?"}], "tags": [], "owner": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "is_accepted": true, "score": 2, "last_activity_date": 1516204488, "creation_date": 1516204488, "answer_id": 48305087, "question_id": 48304823, "link": "https://stackoverflow.com/questions/48304823/i-am-trying-to-get-fibonacci-series-using-recursion-using-3-arguments-it-only-gi/48305087#48305087", "title": "I am trying to get Fibonacci series using recursion using 3 arguments it only gives 0000..values not incrementing", "body": "<p>You have two problems in your code.  First you don't initialize your local variables in the <code>fibo</code> function properly.  So, your variable declarations should be:</p>\n\n<pre><code> int n1=a,n2=b,ele=0;\n</code></pre>\n\n<p>Also, you never stop the recursion you just keep calling fibo with a decremented value of n.  So, add an else to your if clause to return when <code>n &lt; 1</code>.</p>\n"}], "owner": {"reputation": 148, "user_id": 9230309, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-CiP1wfZQX-8/AAAAAAAAAAI/AAAAAAAAATM/BgxcZX_soMM/photo.jpg?sz=128", "display_name": "Suraj Bhandarkar", "link": "https://stackoverflow.com/users/9230309/suraj-bhandarkar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 48305087, "answer_count": 1, "score": -1, "last_activity_date": 1516204488, "creation_date": 1516203602, "last_edit_date": 1516204378, "question_id": 48304823, "link": "https://stackoverflow.com/questions/48304823/i-am-trying-to-get-fibonacci-series-using-recursion-using-3-arguments-it-only-gi", "title": "I am trying to get Fibonacci series using recursion using 3 arguments it only gives 0000..values not incrementing", "body": "<pre><code>#include&lt;stdio.h\nvoid fibo(int n ,int a ,int b)\n{\n        int n1=0,n2=1,ele=0;\n        if(n&gt;=1){\n                printf(\" %d\",n1);\n                ele=n1+n2;\n                n1=n2;\n                n2=ele;\n        }\n        fibo(n-1,n1,n2);\n}\n\n\nint main(){\n\n        fibo(10,0,1);\n\n        return 0;\n\n}\n</code></pre>\n"}, {"tags": ["c", "for-loop", "ternary"], "comments": [{"owner": {"reputation": 1707, "user_id": 7510753, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce531a625b29b9f4b5748308ee38495?s=128&d=identicon&r=PG", "display_name": "kLabz", "link": "https://stackoverflow.com/users/7510753/klabz"}, "edited": false, "score": 4, "creation_date": 1516203241, "post_id": 48304666, "comment_id": 83594298, "body": "Did you make a typo? There are two consecutive <code>;</code> in your first for loop."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 3, "creation_date": 1516203724, "post_id": 48304666, "comment_id": 83594639, "body": "The code you posted in your question does not compile because of the doubled <code>;</code> in the <code>for</code> statement. This also tells us you did not paste exactly the code you are using, so we have to wonder whether there may be other errors. You should edit your question to show <b>exactly</b> the code that fails. You should also show the code that works, and you should show exactly the input you give it that results in incorrect output."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1516203725, "post_id": 48304666, "comment_id": 83594641, "body": "(1) Present the code you are actually asking about.  Preferrably,  copy &amp; paste it into the question.  What you have presented does not compile.  (2) Present the expected and actual output you get."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 2, "creation_date": 1516204916, "post_id": 48304666, "comment_id": 83595471, "body": "Why are you even trying to stuff all that code into the <code>for()</code> statement in the first place?  Unless you&#39;re <a href=\"https://www.ioccc.org/\" rel=\"nofollow noreferrer\">competing in the IOCCC</a> there&#39;s no reason to do that."}, {"owner": {"reputation": 1, "user_id": 9203470, "user_type": "registered", "profile_image": "https://graph.facebook.com/1357938407637595/picture?type=large", "display_name": "Jun-Young Lee", "link": "https://stackoverflow.com/users/9203470/jun-young-lee"}, "edited": false, "score": 0, "creation_date": 1516240624, "post_id": 48304666, "comment_id": 83611254, "body": "To Adrew: Yes I do know that such codes are awkward but I was just experimenting by giving trivial changes and that&#39;s how I got into this problem :) Besides, for a beginner, IOCCC is a quite unreachable goal :3"}], "answers": [{"comments": [{"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 3, "creation_date": 1516204174, "post_id": 48304917, "comment_id": 83594938, "body": "The extra <code>;</code> would prevent compilation. It would not cause the program to \u201c[print] out values not understandable\u201d as the question reports. So it is not the cause of the problem. The OP must have posted code different from the code causing the problem, and that needs to be clarified before an answer can be provided."}, {"owner": {"reputation": 1, "user_id": 9203470, "user_type": "registered", "profile_image": "https://graph.facebook.com/1357938407637595/picture?type=large", "display_name": "Jun-Young Lee", "link": "https://stackoverflow.com/users/9203470/jun-young-lee"}, "edited": false, "score": 0, "creation_date": 1516240973, "post_id": 48304917, "comment_id": 83611330, "body": "Sorry, it was my first time posting the question, and I consequently made a terrible mistake! &#39;I&#39;ll be more aware of properly posting the code. Sorry."}], "tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": false, "score": -2, "last_activity_date": 1516203953, "creation_date": 1516203953, "answer_id": 48304917, "question_id": 48304666, "link": "https://stackoverflow.com/questions/48304666/using-the-ternary-operator-inside-for/48304917#48304917", "title": "Using the ternary operator inside &quot;for&quot;", "body": "<p>The etrtra <code>;</code> is the problem. It means do nothing. The i++ as the 4th statement is ignored.</p>\n\n<p>Anyway, complex expressions inside the for statement make code more difficult to read (by humans) same times with the negative performance effect.</p>\n"}, {"comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1516204322, "post_id": 48305012, "comment_id": 83595053, "body": "Better yet, don&#39;t write code that you have to stare at for three minutes to figure out."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1516204675, "post_id": 48305012, "comment_id": 83595296, "body": "@AndrewHenle: That is bad advice for students. It is important, even necessary, that students explore and experiment, and even code that is simple to experienced programmers will take considerable time for a student to figure out."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1516205009, "post_id": 48305012, "comment_id": 83595528, "body": "@EricPostpischil, although I agree that there is didactic value in <i>interpreting</i> complex code, and also that &quot;complex&quot; is a relative measure, I heartily agree with what I take as Andrew&#39;s sentiment: that one should generally prefer to write simpler code for any given task over more complex code."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1516205017, "post_id": 48305012, "comment_id": 83595539, "body": "@EricPostpischil Are you really saying students should <i>write</i> code that&#39;s hard to understand?"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1516205229, "post_id": 48305012, "comment_id": 83595688, "body": "@AndrewHenle: I am saying students should experiment. That will inevitably cause them to write code that is hard to understand. That is not the purpose of it, of course, but it is an inevitable consequence. At the point in learning where a student is figuring out how expressions are interpreted, the advice not to write complicated code is useless; they do not even know what the alternatives are. It is like giving a baby who is just learning to walk advice on how to do an elegant curtsy or bow."}, {"owner": {"reputation": 68, "user_id": 9229623, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ad087efc399b11bf64c035265b28e30?s=128&d=identicon&r=PG&f=1", "display_name": "Steranoid", "link": "https://stackoverflow.com/users/9229623/steranoid"}, "edited": false, "score": 0, "creation_date": 1516205304, "post_id": 48305012, "comment_id": 83595739, "body": "Optimizing a little, because num1 and num2 don&#39;t change after being set by the user, both result of both ternary operator should be stored in constants so they are not processed on each iteration."}], "tags": [], "owner": {"reputation": 68, "user_id": 9229623, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ad087efc399b11bf64c035265b28e30?s=128&d=identicon&r=PG&f=1", "display_name": "Steranoid", "link": "https://stackoverflow.com/users/9229623/steranoid"}, "is_accepted": false, "score": 1, "last_activity_date": 1516204419, "last_edit_date": 1516204419, "creation_date": 1516204231, "answer_id": 48305012, "question_id": 48304666, "link": "https://stackoverflow.com/questions/48304666/using-the-ternary-operator-inside-for/48305012#48305012", "title": "Using the ternary operator inside &quot;for&quot;", "body": "<p>Your weird results are due to <a href=\"http://en.cppreference.com/w/c/language/operator_precedence\" rel=\"nofollow noreferrer\">operator precedence</a>, the ternary operator is executed after comparing i with (num1>num2). So when you write </p>\n\n<pre><code>i&lt;=(num1&gt;num2)?num1:num2;\n</code></pre>\n\n<p>You're actually writing something like</p>\n\n<pre><code>(i&lt;=(num1&gt;num2))?num1:num2;\n</code></pre>\n\n<p>So the condition relies on the value of num1 or num2. Just add parenthesis around your ternary operator and you're good.</p>\n"}, {"tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": false, "score": 0, "last_activity_date": 1516204513, "creation_date": 1516204513, "answer_id": 48305093, "question_id": 48304666, "link": "https://stackoverflow.com/questions/48304666/using-the-ternary-operator-inside-for/48305093#48305093", "title": "Using the ternary operator inside &quot;for&quot;", "body": "<p>In <code>i&lt;=(num1&gt;num2)?num1:num2</code>, <code>&lt;=</code> has higher precedence than <code>? :</code>. So this expression is equivalent to:</p>\n\n<pre><code>(i &lt;= (num1 &gt; num2))  ?  num1  :  num2;\n</code></pre>\n\n<p>Thus, the expression always evaluates to one of <code>num1</code> or <code>num2</code>. If they are both non-zero, then the loop continues forever.</p>\n\n<p>What you actually want is:</p>\n\n<pre><code>i &lt;= (num1 &gt; num2 ? num1 : num2)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 9203470, "user_type": "registered", "profile_image": "https://graph.facebook.com/1357938407637595/picture?type=large", "display_name": "Jun-Young Lee", "link": "https://stackoverflow.com/users/9203470/jun-young-lee"}, "edited": false, "score": 0, "creation_date": 1516240468, "post_id": 48305159, "comment_id": 83611213, "body": "Thank you for a brief and clear answer! I really appreciate it!!"}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 2, "last_activity_date": 1516204653, "creation_date": 1516204653, "answer_id": 48305159, "question_id": 48304666, "link": "https://stackoverflow.com/questions/48304666/using-the-ternary-operator-inside-for/48305159#48305159", "title": "Using the ternary operator inside &quot;for&quot;", "body": "<p>You have a problem with operator precedence.  The ternary operator has very low precedence, higher only than the assignment operator, compound assignment operators, and comma operator.  Thus, your loop condition</p>\n\n<pre><code>i&lt;=(num1&gt;num2)?num1:num2\n</code></pre>\n\n<p>is equivalent to</p>\n\n<pre><code>(i&lt;=(num1&gt;num2))?num1:num2\n</code></pre>\n\n<p>.  That expression will always evaluate to the value of either <code>num1</code> or <code>num2</code>, so unless one of those is zero, your loop will never terminate.  This also explains why you observed different behavior when you precomputed the ternary expressions.</p>\n\n<p>You want this:</p>\n\n<pre><code>for(i = ((num1 &lt; num2) ? num1 : num2);\n        i &lt;= ((num1 &gt; num2) ? num1 : num2); i++) {\n</code></pre>\n\n<p>But actually, I'd recommend the precomputation in the first place.  The code is slightly longer, but much clearer.</p>\n"}, {"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 2, "last_activity_date": 1516207664, "last_edit_date": 1516207664, "creation_date": 1516206419, "answer_id": 48305730, "question_id": 48304666, "link": "https://stackoverflow.com/questions/48304666/using-the-ternary-operator-inside-for/48305730#48305730", "title": "Using the ternary operator inside &quot;for&quot;", "body": "<p>For starters there is a typo in the for statement</p>\n\n<pre><code>for(i=(num1&lt;num2)?num1:num2;i&lt;=(num1&gt;num2)?num1:num2;; i++)\n                                                   ^^^^ \n</code></pre>\n\n<p>There is a redundant semicolon.</p>\n\n<p>According to the C Standard the conditional operator is defined the following way</p>\n\n<pre><code>conditional-expression:\n    logical-OR-expression ? expression : conditional-expression\n</code></pre>\n\n<p>Relative to this expression</p>\n\n<pre><code>i&lt;=(num1&gt;num2)?num1:num2\n</code></pre>\n\n<p>then it is interpreted like</p>\n\n<pre><code>( i&lt;=(num1&gt;num2) ) ? num1 : num2\n</code></pre>\n\n<p>It is evident that you mean instead</p>\n\n<pre><code>i &lt;= (num1 &gt; num2 ? num1 : num2 )\n</code></pre>\n\n<p>Nevertheless it would be better to use one if statement before the loops than using the conditional operators in the loop.</p>\n\n<p>Take into account that in any case the first loop is unsafe because the user can enter a value equal to <code>INT_MAX</code>. In this case the program will have undefined behavior. It is better and safe to use <code>do-while</code> loop.</p>\n\n<p>Also for the result of multiplication it is better to use the type <code>long long int</code>.</p>\n\n<p>The program can look the following way</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void)\n{\n    int num1 = 0, num2 = 0;\n\n    printf( \"Enter two Integers: \" );\n\n    scanf( \"%d%d\", &amp;num1, &amp;num2 );\n\n    if ( num2 &lt; num1 )\n    {\n        int tmp = num1;\n        num1 = num2;\n        num2 = tmp;\n    }\n\n    int i = num1;\n    do\n    {\n        for ( int j = 1; j &lt; 10; j++ )\n        {\n            printf( \"%d x %d = %-2lld\\n\", i, j, ( long long int )i * j );\n        }\n        printf(\"\\n\");\n    } while ( i++ != num2 );\n\n    return 0;\n}\n</code></pre>\n\n<p>Its output might look like</p>\n\n<pre><code>Enter two Integers: 1 5\n1 x 1 = 1 \n1 x 2 = 2 \n1 x 3 = 3 \n1 x 4 = 4 \n1 x 5 = 5 \n1 x 6 = 6 \n1 x 7 = 7 \n1 x 8 = 8 \n1 x 9 = 9 \n\n2 x 1 = 2 \n2 x 2 = 4 \n2 x 3 = 6 \n2 x 4 = 8 \n2 x 5 = 10\n2 x 6 = 12\n2 x 7 = 14\n2 x 8 = 16\n2 x 9 = 18\n\n3 x 1 = 3 \n3 x 2 = 6 \n3 x 3 = 9 \n3 x 4 = 12\n3 x 5 = 15\n3 x 6 = 18\n3 x 7 = 21\n3 x 8 = 24\n3 x 9 = 27\n\n4 x 1 = 4 \n4 x 2 = 8 \n4 x 3 = 12\n4 x 4 = 16\n4 x 5 = 20\n4 x 6 = 24\n4 x 7 = 28\n4 x 8 = 32\n4 x 9 = 36\n\n5 x 1 = 5 \n5 x 2 = 10\n5 x 3 = 15\n5 x 4 = 20\n5 x 5 = 25\n5 x 6 = 30\n5 x 7 = 35\n5 x 8 = 40\n5 x 9 = 45\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9203470, "user_type": "registered", "profile_image": "https://graph.facebook.com/1357938407637595/picture?type=large", "display_name": "Jun-Young Lee", "link": "https://stackoverflow.com/users/9203470/jun-young-lee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 975, "favorite_count": 0, "answer_count": 5, "score": 0, "last_activity_date": 1516207975, "creation_date": 1516203106, "last_edit_date": 1516207975, "question_id": 48304666, "link": "https://stackoverflow.com/questions/48304666/using-the-ternary-operator-inside-for", "title": "Using the ternary operator inside &quot;for&quot;", "body": "<p>i'm a beginner in programming.\nthe code does get compiled but prints out values not understandable.\nwhen i put those values inside the outer \"for\" by declaring extra integers, and put them into use, the code seems to properly work. What is the problem with the code below? Thanks!</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main( int argc, char** argv ) {\n    int num1, num2, i, j, k;\n    printf( \"Enter the two Integers: \" );\n    scanf( \"%d%d\", &amp;num1, &amp;num2 );\n    for ( i = (num1 &lt; num2) ? num1 : num2; i &lt;= (num1 &gt; num2) ?num1 : num2; ; i++ ) {\n        for ( j = 1; j &lt;= 9; j++ ) {\n            printf( \"%d x %d = %-2d\", i, j, i*j );\n        }\n        printf( \"\\n\" );\n    }\n    return EXIT_SUCCESS;\n}\n</code></pre>\n"}, {"tags": ["c", "types"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1516201577, "post_id": 48304101, "comment_id": 83593052, "body": "Struct with two fields. One will indicate STATE1 through STATE3, and then when it is STATE3, it will look at the second field with the int value. But I would guess you have interpreted your assignment too literally."}, {"owner": {"reputation": 2975, "user_id": 5559342, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/39185a39d1b8b29d0b51564f7d55164e?s=128&d=identicon&r=PG&f=1", "display_name": "Robb1", "link": "https://stackoverflow.com/users/5559342/robb1"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1516201851, "post_id": 48304101, "comment_id": 83593261, "body": "@EugeneSh. that&#39;s what I was looking for, if you make it an answer I&#39;ll accept it. Thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 2975, "user_id": 5559342, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/39185a39d1b8b29d0b51564f7d55164e?s=128&d=identicon&r=PG&f=1", "display_name": "Robb1", "link": "https://stackoverflow.com/users/5559342/robb1"}, "edited": false, "score": 0, "creation_date": 1516202082, "post_id": 48304286, "comment_id": 83593438, "body": "Thanks again! Just one question: why are you using <code>typedef</code> here? Would there be any problem if I was not using it?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 2975, "user_id": 5559342, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/39185a39d1b8b29d0b51564f7d55164e?s=128&d=identicon&r=PG&f=1", "display_name": "Robb1", "link": "https://stackoverflow.com/users/5559342/robb1"}, "edited": false, "score": 0, "creation_date": 1516202133, "post_id": 48304286, "comment_id": 83593469, "body": "@Robb1 Then you will have to carry the <code>enum</code> and <code>struct</code> keywords along all of the way. Just convenience."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1516202189, "post_id": 48304286, "comment_id": 83593508, "body": "... and that&#39;s a pure stylistic consideration about which opinions vary."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1516202208, "post_id": 48304286, "comment_id": 83593521, "body": "Convenience <i>and</i> industry standard everywhere. (Except in Linux code bases, where they frown at not having to write <code>struct</code> all over the code, no rationale given.)"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1516202356, "post_id": 48304286, "comment_id": 83593637, "body": "I&#39;d certainly accept &quot;widely used&quot;, @Lundin, but &quot;industry standard everywhere&quot; seems a bit strong, even with your exception."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1516202523, "post_id": 48304286, "comment_id": 83593766, "body": "@JohnBollinger I know of no other code base than the Linux ones that uses that style. Notably, using typedef makes your code style compatible/consistent with C++ and with pretty much every other mainstream programming language that uses types."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1516203183, "post_id": 48304286, "comment_id": 83594260, "body": "@Lundin, I am confident that you very well know that &quot;I know of no other style&quot; is not at all the same thing as &quot;there is no other style&quot;.  And I observe, too, that although POSIX is by no means consistent in this area, there are multiple data structures used by POSIX interfaces for which POSIX does not define a <code>typedef</code>.  The C standard library even does this -- <code>struct timespec</code>, for example. This is much broader than &quot;Linux code bases&quot;."}], "tags": [], "owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "is_accepted": true, "score": 3, "last_activity_date": 1516202095, "last_edit_date": 1516202095, "creation_date": 1516202008, "answer_id": 48304286, "question_id": 48304101, "link": "https://stackoverflow.com/questions/48304101/variable-with-3-states-with-one-of-those-states-variable-as-well/48304286#48304286", "title": "Variable with 3 states (with one of those states variable as well)", "body": "<p>You can use a structure with two fields, while the first field will indicate one of these custom discrete states with one extra state which will indicate that the other field to be used as the numeric value:</p>\n\n<pre><code>typedef enum \n{\n    STATE1, \n    STATE2,\n    STATE3\n} dstate_t;\n\ntypedef struct\n{\n    dstate_t dstate;   // Discrete state\n    unsigned long val;  // The value for STATE3\n} state_t;\n</code></pre>\n\n<p>Then you can have an array of <code>state_t</code> such as </p>\n\n<pre><code>{{STATE1, 0}, {STATE3, 3984902}, {STATE3,20304}, {STATE2, 0}, {STATE1, 0}, {STATE3,3021289129}}\n</code></pre>\n"}], "owner": {"reputation": 2975, "user_id": 5559342, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/39185a39d1b8b29d0b51564f7d55164e?s=128&d=identicon&r=PG&f=1", "display_name": "Robb1", "link": "https://stackoverflow.com/users/5559342/robb1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 48304286, "answer_count": 1, "score": 0, "last_activity_date": 1516202095, "creation_date": 1516201430, "question_id": 48304101, "link": "https://stackoverflow.com/questions/48304101/variable-with-3-states-with-one-of-those-states-variable-as-well", "title": "Variable with 3 states (with one of those states variable as well)", "body": "<p>I get this is a tricky question but I'll try to explain it in the best way I can.</p>\n\n<p>I want a variable to be able to assume one out of 3 possible values, two of them are specific \"flag values\" (<code>STATE1</code> and <code>STATE2</code>), the third one is a number <code>unsigned long</code>.</p>\n\n<p>So, for example, I could have an array like this:</p>\n\n<pre><code>{STATE1, 3984902, 20304, STATE2, STATE1, 3021289129}\n</code></pre>\n\n<p>Is it possible to do such a thing in C?</p>\n"}, {"tags": ["c", "image", "x11", "gif"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1516201524, "post_id": 48304080, "comment_id": 83593024, "body": "Do you have a GUI framework you&#39;re working with? Then it probably already have functionality to load <i>and display</i> any number of open and public image formats, including GIF."}, {"owner": {"reputation": 879, "user_id": 5693785, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/mfKhd.jpg?s=128&g=1", "display_name": "ron", "link": "https://stackoverflow.com/users/5693785/ron"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1516204677, "post_id": 48304080, "comment_id": 83595301, "body": "no gui framwork, everything currently done in text, menu driven in a shell/terminal.  Eventually i&#39;d like a gui with a slider and check boxes that will redraw the image real time by moving the slider to change the min max values of the colorbar or apply a han or hamming window to the data and redisplay"}], "answers": [{"comments": [{"owner": {"reputation": 879, "user_id": 5693785, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/mfKhd.jpg?s=128&g=1", "display_name": "ron", "link": "https://stackoverflow.com/users/5693785/ron"}, "edited": false, "score": 0, "creation_date": 1516204900, "post_id": 48305055, "comment_id": 83595459, "body": "using <code>display</code> from ImageMagick says &quot;corrupt image&quot; however I can open my gif in microsoft windows 7 with just about any application.  I just stumbled across <code>giflib</code> and <code>gif2x11</code> displays my gif in a window in linux"}, {"owner": {"reputation": 144819, "user_id": 2836621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/suHg4.jpg?s=128&g=1", "display_name": "Mark Setchell", "link": "https://stackoverflow.com/users/2836621/mark-setchell"}, "reply_to_user": {"reputation": 879, "user_id": 5693785, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/mfKhd.jpg?s=128&g=1", "display_name": "ron", "link": "https://stackoverflow.com/users/5693785/ron"}, "edited": false, "score": 0, "creation_date": 1516205419, "post_id": 48305055, "comment_id": 83595822, "body": "Are you maybe running an old version of ImageMagick? Try <code>identify -version</code> to see. The current version is v7.0. Can you share the troublesome GIF?"}, {"owner": {"reputation": 879, "user_id": 5693785, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/mfKhd.jpg?s=128&g=1", "display_name": "ron", "link": "https://stackoverflow.com/users/5693785/ron"}, "edited": false, "score": 0, "creation_date": 1516205940, "post_id": 48305055, "comment_id": 83596130, "body": "<code>Version: ImageMagick 6.4.3 2017-12-11 Q16 OpenMP</code>,  what&#39;s the best way to share a file on here?, the gif file is 64k and I think the code will always write a gif of size 580x530 with 256 colors"}, {"owner": {"reputation": 144819, "user_id": 2836621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/suHg4.jpg?s=128&g=1", "display_name": "Mark Setchell", "link": "https://stackoverflow.com/users/2836621/mark-setchell"}, "reply_to_user": {"reputation": 879, "user_id": 5693785, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/mfKhd.jpg?s=128&g=1", "display_name": "ron", "link": "https://stackoverflow.com/users/5693785/ron"}, "edited": false, "score": 0, "creation_date": 1516206433, "post_id": 48305055, "comment_id": 83596439, "body": "Yikes! That must be at least 8 years old... I think you&#39;ll need to update if you want to progress this route."}, {"owner": {"reputation": 879, "user_id": 5693785, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/mfKhd.jpg?s=128&g=1", "display_name": "ron", "link": "https://stackoverflow.com/users/5693785/ron"}, "edited": false, "score": 0, "creation_date": 1516208938, "post_id": 48305055, "comment_id": 83598053, "body": "trying to install imagemagick 6.9 or 7.0 results in dependency problem nothing provides libc.so.6 (glibc_2.14).  not sure why version 6.4 can&#39;t read a gif in 20+ year old format when everything else does."}, {"owner": {"reputation": 144819, "user_id": 2836621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/suHg4.jpg?s=128&g=1", "display_name": "Mark Setchell", "link": "https://stackoverflow.com/users/2836621/mark-setchell"}, "reply_to_user": {"reputation": 879, "user_id": 5693785, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/mfKhd.jpg?s=128&g=1", "display_name": "ron", "link": "https://stackoverflow.com/users/5693785/ron"}, "edited": false, "score": 0, "creation_date": 1516210071, "post_id": 48305055, "comment_id": 83598723, "body": "Dropbox, GitHub, filebin.net"}], "tags": [], "owner": {"reputation": 144819, "user_id": 2836621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/suHg4.jpg?s=128&g=1", "display_name": "Mark Setchell", "link": "https://stackoverflow.com/users/2836621/mark-setchell"}, "is_accepted": false, "score": 0, "last_activity_date": 1516206768, "last_edit_date": 1516206768, "creation_date": 1516204378, "answer_id": 48305055, "question_id": 48304080, "link": "https://stackoverflow.com/questions/48304080/best-way-in-linux-to-display-gif-gif87a-image-from-c/48305055#48305055", "title": "best way in linux to display gif gif87a image from C", "body": "<p>Writing an X11 application is non-trivial. You can display a GIF (or any one of around 200 image formats) using <strong>ImageMagick</strong> which is included in most Linux distros and is available for macOS. Windows doesn't count.</p>\n\n<p>So, you can create images and manipulate images from the command line, or in C if you want. So, let's create a GIF that is 1024x768 and full of random colours:</p>\n\n<pre><code>convert -size 1024x768 xc:blue +noise random -pointsize 72 -gravity center -annotate 0 \"10\" image.gif\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/TNrbw.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/TNrbw.gif\" alt=\"enter image description here\"></a></p>\n\n<p>Now we can display it, using <strong>ImageMagick</strong>'s <code>display</code> program:</p>\n\n<pre><code>display image.gif &amp;\n</code></pre>\n\n<p>Now we can get its X11 <em>\"window-id\"</em> with:</p>\n\n<pre><code>xprop -root\n\n...\n_NET_ACTIVE_WINDOW(WINDOW): window id # 0x600011\n...\n...\n</code></pre>\n\n<p>Now you can change the image, however you like with filters and blurs and morphology and thresholds and convolutions:</p>\n\n<pre><code>convert image.gif -threshold 80% -morphology erode diamond -blur 0x3 -convolve \"3x3: -1,0,1, -2,0,2, -1,0,1\" ... image.gif\n</code></pre>\n\n<p>And then tell the <code>display</code> program to redraw the window with:</p>\n\n<pre><code>display -window 0x600011 image.gif\n</code></pre>\n\n<hr>\n\n<p>Here is a little script that generates images with a new number in the middle of each frame and updates the screen:</p>\n\n<pre><code>for ((t=0;t&lt;100;t++)) ; do \n   convert -size 640x480 xc:blue +noise random -pointsize 72 -fill white -gravity center -annotate 0 \"$t\" image.gif\n   display -window 0x600011 image.gif\ndone\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/xLkyc.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xLkyc.gif\" alt=\"enter image description here\"></a></p>\n\n<hr>\n\n<p>Now all you need to do is find a little Python or Tcl/Tk library that draws some knobs and dials, reads their positions and changes the image accordingly and tells the screen to redraw.</p>\n"}, {"tags": [], "owner": {"reputation": 144819, "user_id": 2836621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/suHg4.jpg?s=128&g=1", "display_name": "Mark Setchell", "link": "https://stackoverflow.com/users/2836621/mark-setchell"}, "is_accepted": false, "score": 0, "last_activity_date": 1516649697, "creation_date": 1516649697, "answer_id": 48389013, "question_id": 48304080, "link": "https://stackoverflow.com/questions/48304080/best-way-in-linux-to-display-gif-gif87a-image-from-c/48389013#48389013", "title": "best way in linux to display gif gif87a image from C", "body": "<p>As a result of the lack of enthusiasm for my other answer, I thought I'd have another attempt. I had a quick look and learn of <strong>Processing</strong> which is a very simple language, very similar to C but much easier to program.</p>\n\n<p>Here is a screen shot of it loading a GIF and displaying a couple of twiddly knobs - one of which I attached to do a threshold on the image.</p>\n\n<p><a href=\"https://i.stack.imgur.com/6OnS6.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/6OnS6.gif\" alt=\"enter image description here\"></a></p>\n\n<p>Here's the code - it is not the prettiest in the world because it is my first ever code in <strong>Processing</strong> but you should be able to see what it is doing and adapt to your needs:</p>\n\n<pre><code>import controlP5.*;\n\nControlP5 cp5;\n\nint myColorBackground = color(0,0,0);\nint knobValue = 100;\nfloat threshold=128;\n\nKnob myKnobA;\nKnob myKnobB;\n\nPImage src,dst;  // Declare a variable of type PImage\n\nvoid setup() {\n  size(800,900);\n\n  // Make a new instance of a PImage by loading an image file\n  src = loadImage(\"image.gif\");\n  // The destination image is created as a blank image the same size as the source.\n  dst = createImage(src.width, src.height, RGB);\n\n  smooth();\n  noStroke();\n\n  cp5 = new ControlP5(this);\n\n  myKnobA = cp5.addKnob(\"some knob\")\n               .setRange(0,255)\n               .setValue(50)\n               .setPosition(130,650)\n               .setRadius(100)\n               .setDragDirection(Knob.VERTICAL)\n               ;\n\n  myKnobB = cp5.addKnob(\"threshold\")\n               .setRange(0,255)\n               .setValue(220)\n               .setPosition(460,650)\n               .setRadius(100)\n               .setNumberOfTickMarks(10)\n               .setTickMarkLength(4)\n               .snapToTickMarks(true)\n               .setColorForeground(color(255))\n               .setColorBackground(color(0, 160, 100))\n               .setColorActive(color(255,255,0))\n               .setDragDirection(Knob.HORIZONTAL)\n               ;\n\n}\n\nvoid draw() {\n  background(0);\n  src.loadPixels();\n  dst.loadPixels();\n\n  for (int x = 0; x &lt; src.width; x++) {\n    for (int y = 0; y &lt; src.height; y++ ) {\n      int loc = x + y*src.width;\n      // Test the brightness against the threshold\n      if (brightness(src.pixels[loc]) &gt; threshold) {\n        dst.pixels[loc]  = color(255);  // White\n      }  else {\n        dst.pixels[loc]  = color(0);    // Black\n      }\n    }\n  }\n\n  // We changed the pixels in destination\n  dst.updatePixels();\n  // Display the destination\n  image(dst,100,80);\n}\n\nvoid knob(int theValue) {\n  threshold = color(theValue);\n  println(\"a knob event. setting background to \"+theValue);\n}\n\n\nvoid keyPressed() {\n  switch(key) {\n    case('1'):myKnobA.setValue(180);break;\n    case('2'):myKnobB.setConstrained(false).hideTickMarks().snapToTickMarks(false);break;\n    case('3'):myKnobA.shuffle();myKnobB.shuffle();break;\n  }\n\n}\n</code></pre>\n\n<p>Here are some links I used - <a href=\"https://processing.org/tutorials/pixels/\" rel=\"nofollow noreferrer\">image processing</a>, <a href=\"http://www.sojamo.de/libraries/controlP5/\" rel=\"nofollow noreferrer\">P5 library of widgets and knobs</a>.</p>\n"}], "owner": {"reputation": 879, "user_id": 5693785, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/mfKhd.jpg?s=128&g=1", "display_name": "ron", "link": "https://stackoverflow.com/users/5693785/ron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 492, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1516649697, "creation_date": 1516201364, "question_id": 48304080, "link": "https://stackoverflow.com/questions/48304080/best-way-in-linux-to-display-gif-gif87a-image-from-c", "title": "best way in linux to display gif gif87a image from C", "body": "<p>What would be the best way, in linux from gnu C and not C++, to display a gif87a file on screen and redisplay it in the same location on the screen so the user can observe changes that are made on the fly to the dataset?  This is not an animated gif.</p>\n\n<p>in some old code (fortran77) that has a C wrapper which takes an image that was displayed on the screen and writes it to a gif file, there is a comment about <code>X Window Applications Programming, Ed. 2, Johnson &amp; Reichard</code> that was used as a reference to write the C code to display image data to the screen and write a gif87a file, and this code was written around 1995, the onscreen display of the image no longer works (just a black window) but the creation of the gif file still works.  What i would like to do is from the existing C code, in SLES version 11.4 with the libraries that are available to open the gif file and display it on screen.  The image, or contour plot, has a color bar that the user sets the min/max value for to display the image to their liking and it would be preferable to make it as easy &amp; efficient for the user to adjust those min max values then redraw the image (re-write the gif then redisplay on screen in same location).  There's also a handful of other knobs that the user can turn, such as windowing of the dat (hamming or han) and it would be best if the user can quickly/easily run though about 5+ ways of looking at the image before settling on what is considered correct then using that final gif that was created in powerpoint, excel, etc.</p>\n"}, {"tags": ["css", "c", "gtk", "gtk3"], "comments": [{"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 4, "creation_date": 1516199322, "post_id": 48303437, "comment_id": 83591558, "body": "<i>&quot;This doesn&#39;t work&quot;</i> This is not a helpful problem description."}, {"owner": {"reputation": 3671, "user_id": 7728864, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hv4Sl.jpg?s=128&g=1", "display_name": "Jos&#233; Fonte", "link": "https://stackoverflow.com/users/7728864/jos%c3%a9-fonte"}, "edited": false, "score": 1, "creation_date": 1516199510, "post_id": 48303437, "comment_id": 83591675, "body": "Indeed. Which Gtk+ version are you using? It&#39;s important to know due to CSS changes between versions. Did you try Gtk Inspector? It let&#39;s you tweak CSS at runtime."}, {"owner": {"reputation": 55, "user_id": 8810684, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62a844abb8f0e786fcb05e65c0efac01?s=128&d=identicon&r=PG&f=1", "display_name": "Robert", "link": "https://stackoverflow.com/users/8810684/robert"}, "edited": false, "score": 0, "creation_date": 1516199680, "post_id": 48303437, "comment_id": 83591786, "body": "version 3.22.26. &quot;This doesn&#39;t work&quot; I mean colors didn&#39;t change. When I use full path, everything from css file work."}, {"owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "edited": false, "score": 1, "creation_date": 1516199699, "post_id": 48303437, "comment_id": 83591804, "body": "It sounds as if the CSS file is not in the current directory of the process, which is why it works with the full path."}, {"owner": {"reputation": 55, "user_id": 8810684, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62a844abb8f0e786fcb05e65c0efac01?s=128&d=identicon&r=PG&f=1", "display_name": "Robert", "link": "https://stackoverflow.com/users/8810684/robert"}, "edited": false, "score": 1, "creation_date": 1516199829, "post_id": 48303437, "comment_id": 83591894, "body": "I copied and pasted it everywhere and it still won&#39;t work :D"}, {"owner": {"reputation": 3671, "user_id": 7728864, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hv4Sl.jpg?s=128&g=1", "display_name": "Jos&#233; Fonte", "link": "https://stackoverflow.com/users/7728864/jos%c3%a9-fonte"}, "edited": false, "score": 0, "creation_date": 1516212058, "post_id": 48303437, "comment_id": 83599852, "body": "Is the binary in the same path as style.css?"}, {"owner": {"reputation": 10263, "user_id": 518853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IjKPw.png?s=128&g=1", "display_name": "liberforce", "link": "https://stackoverflow.com/users/518853/liberforce"}, "edited": false, "score": 0, "creation_date": 1516271565, "post_id": 48303437, "comment_id": 83623619, "body": "Have you looked at the last argument of <code>gtk_css_provider_load_from_file</code>? That amazing thing is where the error code and message is stored if that function call fails. So what if you gave an eye to what is in that error and printed the error message? Don&#39;t you think it would be easier for everyone?"}], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 8810684, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62a844abb8f0e786fcb05e65c0efac01?s=128&d=identicon&r=PG&f=1", "display_name": "Robert", "link": "https://stackoverflow.com/users/8810684/robert"}, "edited": false, "score": 0, "creation_date": 1516283780, "post_id": 48319332, "comment_id": 83631115, "body": "Thank you very much, on Mac OS with GTK 3.22.26 everything works now, but on Linux with GTK 3.18 I got error: &quot;style.css:2:19Not a valid image&quot;. What does it mean?"}, {"owner": {"reputation": 10263, "user_id": 518853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IjKPw.png?s=128&g=1", "display_name": "liberforce", "link": "https://stackoverflow.com/users/518853/liberforce"}, "reply_to_user": {"reputation": 55, "user_id": 8810684, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62a844abb8f0e786fcb05e65c0efac01?s=128&d=identicon&r=PG&f=1", "display_name": "Robert", "link": "https://stackoverflow.com/users/8810684/robert"}, "edited": false, "score": 0, "creation_date": 1516287997, "post_id": 48319332, "comment_id": 83633985, "body": "Your css file has an error at line 2, character 19. From the file content you posted, your css file is probably badly formed. I&#39;m not familiar with CSS3, are you sure <code>image()</code> is allowed? Wherever I look I see <code>url()</code> instead."}, {"owner": {"reputation": 10263, "user_id": 518853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IjKPw.png?s=128&g=1", "display_name": "liberforce", "link": "https://stackoverflow.com/users/518853/liberforce"}, "reply_to_user": {"reputation": 55, "user_id": 8810684, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62a844abb8f0e786fcb05e65c0efac01?s=128&d=identicon&r=PG&f=1", "display_name": "Robert", "link": "https://stackoverflow.com/users/8810684/robert"}, "edited": false, "score": 0, "creation_date": 1516289169, "post_id": 48319332, "comment_id": 83634816, "body": "Ok, didn&#39;t see at first the different GTK+ versions. There has been changes in the CSS engine, so different versions may behave differently. <code>background-image</code> on GTK+ 3.18 is documented as <code>background-image: [none|url|linear-gradient]</code>, so I don&#39;t think using <code>image()</code> would work on that version. See <a href=\"https://developer.gnome.org/gtk3/3.18/GtkCssProvider.html\" rel=\"nofollow noreferrer\">developer.gnome.org/gtk3/3.18/GtkCssProvider.html</a>"}], "tags": [], "owner": {"reputation": 10263, "user_id": 518853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IjKPw.png?s=128&g=1", "display_name": "liberforce", "link": "https://stackoverflow.com/users/518853/liberforce"}, "is_accepted": true, "score": 0, "last_activity_date": 1516272533, "last_edit_date": 1516272533, "creation_date": 1516272131, "answer_id": 48319332, "question_id": 48303437, "link": "https://stackoverflow.com/questions/48303437/css-in-gtk-doesnt-work/48319332#48319332", "title": "CSS in GTK+ doesn&#39;t work", "body": "<p>Please, do the bare minimum: check your error codes, and process them.</p>\n\n<pre><code>const gchar *css_relpath = \"style.css\";\nGError *error = NULL;\nGFile *css_file = g_file_new_for_path(css_relpath); \n\ngtk_css_provider_load_from_file(provider, css_file, &amp;error);\nif (error)\n{\n    // Display a warning if the stylesheet is not loaded\n    g_warning (\"%s\", error-&gt;message);\n\n    // Free the memory allocated for the error\n    // and acknowledge the error has been processed\n    g_clear_error (&amp;error);\n}\ng_object_unref (css_file);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 55, "user_id": 8810684, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62a844abb8f0e786fcb05e65c0efac01?s=128&d=identicon&r=PG&f=1", "display_name": "Robert", "link": "https://stackoverflow.com/users/8810684/robert"}, "is_accepted": false, "score": 0, "last_activity_date": 1516284070, "creation_date": 1516284070, "answer_id": 48323104, "question_id": 48303437, "link": "https://stackoverflow.com/questions/48303437/css-in-gtk-doesnt-work/48323104#48323104", "title": "CSS in GTK+ doesn&#39;t work", "body": "<pre><code>window {\n    background-image: image(Peru);\n}\n\nbutton {\n    background-image: image(Tan);\n    background-color: Tan;\n}\n\nbutton:active {\n    background-image: image(#C69F6C);\n    background-color: #C69F6C;\n}\n\n#unpressed {\n    background-image: image(Sienna);\n    background-color: Sienna;\n}\n\n#button_black {\n    background-image: image(Black);\n    background-color: Black;\n}\n\n#button_white {\n    background-image: image(White);\n    background-color: White;\n}\n</code></pre>\n\n<p>\"style.css:2:19Not a valid image\"\nMy .css file above</p>\n"}], "owner": {"reputation": 55, "user_id": 8810684, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62a844abb8f0e786fcb05e65c0efac01?s=128&d=identicon&r=PG&f=1", "display_name": "Robert", "link": "https://stackoverflow.com/users/8810684/robert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 770, "favorite_count": 0, "accepted_answer_id": 48319332, "answer_count": 2, "score": 0, "last_activity_date": 1516284070, "creation_date": 1516199223, "last_edit_date": 1516271376, "question_id": 48303437, "link": "https://stackoverflow.com/questions/48303437/css-in-gtk-doesnt-work", "title": "CSS in GTK+ doesn&#39;t work", "body": "<pre><code>GtkCssProvider *provider;\nGdkDisplay *display;\nGdkScreen *screen;\n\nprovider = gtk_css_provider_new ();\ndisplay = gdk_display_get_default ();\nscreen = gdk_display_get_default_screen (display);\ngtk_style_context_add_provider_for_screen (screen, GTK_STYLE_PROVIDER (provider), GTK_STYLE_PROVIDER_PRIORITY_APPLICATION);\n\nconst gchar *myCssFile = \"style.css\";\nGError *error = 0;\n\ngtk_css_provider_load_from_file(provider, g_file_new_for_path(myCssFile), &amp;error);\ng_object_unref (provider);\n</code></pre>\n\n<p>This doesn't work, but when I change \"style.css\" to the full path, everything works great. What am I doing wrong?</p>\n"}, {"tags": ["c#", "c++", "c", "windows", "winapi"], "comments": [{"owner": {"reputation": 2565, "user_id": 4781312, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/lDEcJ.jpg?s=128&g=1", "display_name": "Asesh", "link": "https://stackoverflow.com/users/4781312/asesh"}, "edited": false, "score": 0, "creation_date": 1516198956, "post_id": 48303227, "comment_id": 83591278, "body": "Use this API: <code>GetGUIThreadInfo</code>: <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms633506(v=vs.85).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/windows/desktop/&hellip;</a>"}, {"owner": {"reputation": 11092, "user_id": 982149, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LdDoZ.png?s=128&g=1", "display_name": "Fildor", "link": "https://stackoverflow.com/users/982149/fildor"}, "edited": false, "score": 1, "creation_date": 1516199312, "post_id": 48303227, "comment_id": 83591551, "body": "x-y ... Why would you ever need that handle?"}, {"owner": {"reputation": 14021, "user_id": 7571258, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fBP6e.png?s=128&g=1", "display_name": "zett42", "link": "https://stackoverflow.com/users/7571258/zett42"}, "edited": false, "score": 0, "creation_date": 1516199512, "post_id": 48303227, "comment_id": 83591677, "body": "Sounds like an <a href=\"http://xyproblem.info/\" rel=\"nofollow noreferrer\">XY problem</a>. What are you actually trying to achieve?"}, {"owner": {"reputation": 21, "user_id": 9229759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/809a2dd71d7bdb8a34da7e1ae2c2c06f?s=128&d=identicon&r=PG&f=1", "display_name": "Zbigniew R\u0119bacz", "link": "https://stackoverflow.com/users/9229759/zbigniew-r%c4%99bacz"}, "edited": false, "score": 1, "creation_date": 1516199684, "post_id": 48303227, "comment_id": 83591790, "body": "Currently I am working on screen sharing technology and I need to hide the content of that Window while sending the desktop content to other users. This is potential security issue, because we are leaking sensitive data such as private messages etc."}, {"owner": {"reputation": 14021, "user_id": 7571258, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fBP6e.png?s=128&g=1", "display_name": "zett42", "link": "https://stackoverflow.com/users/7571258/zett42"}, "edited": false, "score": 0, "creation_date": 1516218633, "post_id": 48303227, "comment_id": 83603296, "body": "You could try <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ee684009(v=vs.85).aspx\" rel=\"nofollow noreferrer\">UI automation</a>, it might give you a way to find the window without relying on localized strings. Use the Inspect tool to check which information you get using UI automation."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 1, "creation_date": 1516243245, "post_id": 48303227, "comment_id": 83611853, "body": "&quot;<i>the only parameter I can base on is window name</i>&quot; - did you try looking at the window <b>class name</b> yet?"}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 2, "creation_date": 1516250537, "post_id": 48303227, "comment_id": 83613616, "body": "This is not the only place where information may leaks. I think you are chasing a ghost here. Once the user shares the screen then they are making an explicit decision to let somebody else see what appears there. You can&#39;t win this battle."}, {"owner": {"reputation": 21, "user_id": 9229759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/809a2dd71d7bdb8a34da7e1ae2c2c06f?s=128&d=identicon&r=PG&f=1", "display_name": "Zbigniew R\u0119bacz", "link": "https://stackoverflow.com/users/9229759/zbigniew-r%c4%99bacz"}, "reply_to_user": {"reputation": 14021, "user_id": 7571258, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fBP6e.png?s=128&g=1", "display_name": "zett42", "link": "https://stackoverflow.com/users/7571258/zett42"}, "edited": false, "score": 0, "creation_date": 1516270723, "post_id": 48303227, "comment_id": 83623066, "body": "@zett42 I used <b>Spy++</b> tool to investigate the window hierarchy."}, {"owner": {"reputation": 21, "user_id": 9229759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/809a2dd71d7bdb8a34da7e1ae2c2c06f?s=128&d=identicon&r=PG&f=1", "display_name": "Zbigniew R\u0119bacz", "link": "https://stackoverflow.com/users/9229759/zbigniew-r%c4%99bacz"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 1, "creation_date": 1516271256, "post_id": 48303227, "comment_id": 83623427, "body": "@RemyLebeau The notification window has <b>Windows.UI.Core.CoreWindow</b> type. What is quite common in the window hierarchy and it can not be used as a a point of attachment. Moreover we can not base on the <b>Z</b> axis, because the window has got <b>TOPMOST</b> style. Moreover, the overall window style is not different than other windows."}, {"owner": {"reputation": 21, "user_id": 9229759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/809a2dd71d7bdb8a34da7e1ae2c2c06f?s=128&d=identicon&r=PG&f=1", "display_name": "Zbigniew R\u0119bacz", "link": "https://stackoverflow.com/users/9229759/zbigniew-r%c4%99bacz"}, "reply_to_user": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1516271453, "post_id": 48303227, "comment_id": 83623545, "body": "@David Hefferman we let user to share his/her application window. We do not want to leak any other unrelated applications. We do it quite well for UWP and regular window application, but in this certain scenario we don&#39;t have good solution."}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 1, "creation_date": 1516273850, "post_id": 48303227, "comment_id": 83625060, "body": "OK, application sharing is different from screen sharing. So why don&#39;t you do that? Why are you sending anything other than the application window? You can capture that and nothing else. Trying to pick on one specific class of notification window is futile. What about other popup windows that aren&#39;t of this class? So your current approach is doomed to fail."}], "owner": {"reputation": 21, "user_id": 9229759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/809a2dd71d7bdb8a34da7e1ae2c2c06f?s=128&d=identicon&r=PG&f=1", "display_name": "Zbigniew R\u0119bacz", "link": "https://stackoverflow.com/users/9229759/zbigniew-r%c4%99bacz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 333, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1516198626, "creation_date": 1516198626, "question_id": 48303227, "link": "https://stackoverflow.com/questions/48303227/how-to-obtain-handle-to-notification-window-in-windows-10", "title": "How to obtain handle to notification window in Windows 10", "body": "<p>I would like to obtain handle to notification window (balloon) using WinAPI. How can I do it, correctly?</p>\n\n<p>Currently I found the solution by enumerating all windows using <strong>FindWindowEx</strong> function and then obtaining all windows that belongs to <strong>ShellExperienceHost.exe</strong> process. The operation is executed using <strong>GetWindowThreadProcessId</strong> API call.</p>\n\n<p>After that we are limited to five windows and one of that window is notification window. But, the only parameter I can base on is window name. In this certain case it is \"New notification\". However, for my native language it is \"Nowe powiadomienie\". The application I am currently working on, needs to support multiple language. So, creating set with the names is not good options. Because, the code will be difficult to maintenance and can be depend on further changes in Windows.</p>\n\n<p>I will be grateful for any help in this area.</p>\n"}, {"tags": ["c", "aix"], "comments": [{"owner": {"reputation": 9095, "user_id": 8542346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11b206b49cec657d28a5876f8330780e?s=128&d=identicon&r=PG&f=1", "display_name": "H.S.", "link": "https://stackoverflow.com/users/8542346/h-s"}, "edited": false, "score": 0, "creation_date": 1516200624, "post_id": 48303211, "comment_id": 83592416, "body": "Your code snippet and its output are not matching. In the code, you have the last character as - <code>[</code> (<code>errno=%d[</code>) in the <code>format</code> string of <code>printf()</code> but in the output, the last character is <code>]</code> (<code>errno=28]</code>). Make sure that the output belongs the same code that you have shown."}, {"owner": {"reputation": 43, "user_id": 9229470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f3b01eee9240313dade31fb87227ff0?s=128&d=identicon&r=PG&f=1", "display_name": "Dan F", "link": "https://stackoverflow.com/users/9229470/dan-f"}, "reply_to_user": {"reputation": 9095, "user_id": 8542346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11b206b49cec657d28a5876f8330780e?s=128&d=identicon&r=PG&f=1", "display_name": "H.S.", "link": "https://stackoverflow.com/users/8542346/h-s"}, "edited": false, "score": 0, "creation_date": 1516207124, "post_id": 48303211, "comment_id": 83596892, "body": "It is a simplified version of the code, and there was obviously a typo there.  Corrected."}, {"owner": {"reputation": 1339, "user_id": 2141064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c56d69ec8f5e469a8c6ca22d60271e9b?s=128&d=identicon&r=PG", "display_name": "Lorinczy Zsigmond", "link": "https://stackoverflow.com/users/2141064/lorinczy-zsigmond"}, "edited": false, "score": 0, "creation_date": 1516211123, "post_id": 48303211, "comment_id": 83599340, "body": "Please check again your AIX version (<code>oslevel -r</code> or similar command)"}, {"owner": {"reputation": 1339, "user_id": 2141064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c56d69ec8f5e469a8c6ca22d60271e9b?s=128&d=identicon&r=PG", "display_name": "Lorinczy Zsigmond", "link": "https://stackoverflow.com/users/2141064/lorinczy-zsigmond"}, "edited": false, "score": 0, "creation_date": 1516211451, "post_id": 48303211, "comment_id": 83599524, "body": "Make sure to compile <i>everything</i> with option <code>-D_THREAD_SAFE</code> (and <code>-pthread</code> if necessary)"}, {"owner": {"reputation": 43, "user_id": 9229470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f3b01eee9240313dade31fb87227ff0?s=128&d=identicon&r=PG&f=1", "display_name": "Dan F", "link": "https://stackoverflow.com/users/9229470/dan-f"}, "edited": false, "score": 0, "creation_date": 1516213549, "post_id": 48303211, "comment_id": 83600650, "body": "Corrected, AIX 6.1, thanks.  Do you have any particular thoughts on why the compile flags you recommend would change this?  Why you think it might be thread issues?  I would be interested to read them if you have any links.  Also, are you proposing this as an answer?"}, {"owner": {"reputation": 1339, "user_id": 2141064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c56d69ec8f5e469a8c6ca22d60271e9b?s=128&d=identicon&r=PG", "display_name": "Lorinczy Zsigmond", "link": "https://stackoverflow.com/users/2141064/lorinczy-zsigmond"}, "edited": false, "score": 0, "creation_date": 1516215340, "post_id": 48303211, "comment_id": 83601576, "body": "No, it&#39;s just a little step toward cleaner code. See this: <a href=\"http://web.axelero.hu/lzsiga/aix-linking.html#Q0028\" rel=\"nofollow noreferrer\">web.axelero.hu/lzsiga/aix-linking.html#Q0028</a> Also Timer_id might or might not be compatible with int, so you should use typecast when printf-ing it with &#39;%d&#39;"}, {"owner": {"reputation": 43, "user_id": 9229470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f3b01eee9240313dade31fb87227ff0?s=128&d=identicon&r=PG&f=1", "display_name": "Dan F", "link": "https://stackoverflow.com/users/9229470/dan-f"}, "edited": false, "score": 0, "creation_date": 1516278833, "post_id": 48303211, "comment_id": 83628036, "body": "Thanks. Again, this is just a simplified example.  The errno and the fact that the return value is less than zero are the points that are relevant, I think (showing an error occurred).  I am not really as interested in the printf, but more about why the timer can fail, and what would be indicated by ENOSPC as an errno."}, {"owner": {"reputation": 3635, "user_id": 382166, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/a74d859f6f39a29f52d6590e16ef054a?s=128&d=identicon&r=PG", "display_name": "asc99c", "link": "https://stackoverflow.com/users/382166/asc99c"}, "edited": false, "score": 0, "creation_date": 1519299029, "post_id": 48303211, "comment_id": 84858676, "body": "Was going to say I&#39;m having the same problem, but turns out I&#39;m looking at the same code as you!  Hi Dan :)"}], "answers": [{"tags": [], "owner": {"reputation": 3635, "user_id": 382166, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/a74d859f6f39a29f52d6590e16ef054a?s=128&d=identicon&r=PG", "display_name": "asc99c", "link": "https://stackoverflow.com/users/382166/asc99c"}, "is_accepted": true, "score": 2, "last_activity_date": 1519307295, "creation_date": 1519307295, "answer_id": 48929056, "question_id": 48303211, "link": "https://stackoverflow.com/questions/48303211/what-could-cause-gettimerid-to-fail-setting-errno-to-enospc-undocumented/48929056#48929056", "title": "What could cause gettimerid() to fail, setting errno to ENOSPC (undocumented)?", "body": "<p>It can be caused by repeatedly getting the <code>TIMEOFDAY</code> timer without calling <code>reltimerid</code> in between.  As an example to cause it:</p>\n\n<pre><code> while( 1 )\n {\n   timer_t TimerId;\n   if( ( TimerId = gettimerid( TIMEOFDAY, 0 ) ) &lt; 0 )\n   {\n     printf( \"gettimerid failed: %d\\n\", errno );\n     break;\n   }\n   else\n     printf( \"gettimerid OK: %d\\n\", TimerId );\n }\n</code></pre>\n\n<p>Output from this loop is:</p>\n\n<pre><code>gettimerid OK: 5\ngettimerid OK: 6\ngettimerid OK: 7\ngettimerid OK: 8\ngettimerid failed: 28\n</code></pre>\n\n<p>Which is the undocumented <code>ENOSPC</code> errno.</p>\n"}], "owner": {"reputation": 43, "user_id": 9229470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f3b01eee9240313dade31fb87227ff0?s=128&d=identicon&r=PG&f=1", "display_name": "Dan F", "link": "https://stackoverflow.com/users/9229470/dan-f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 0, "accepted_answer_id": 48929056, "answer_count": 1, "score": 4, "last_activity_date": 1519307295, "creation_date": 1516198555, "last_edit_date": 1516213305, "question_id": 48303211, "link": "https://stackoverflow.com/questions/48303211/what-could-cause-gettimerid-to-fail-setting-errno-to-enospc-undocumented", "title": "What could cause gettimerid() to fail, setting errno to ENOSPC (undocumented)?", "body": "<p>I am using AIX 6.1.  A program I am using (and involved in the development of) contains calls to the C library <code>gettimerid()</code> function.</p>\n\n<p>The problem I am having is that <code>gettimerid()</code> calls have started intermittently failing perhaps once per day, returning -1 (indicating an error), and when I check <code>errno</code>, it has been set to <code>ENOSPC</code> (28d), meaning \"No space left on device\".</p>\n\n<p>According to <a href=\"https://www.ibm.com/support/knowledgecenter/en/ssw_aix_61/com.ibm.aix.basetrf1/gettimerid.htm\" rel=\"nofollow noreferrer\">the AIX documentation</a>, <code>ENOSPC</code> is not shown as one of the possible return values, leaving me confused as to what this means.</p>\n\n<p>As far as I am aware, this does not require any file system space, but I checked the unused file space and inode usage of the file systems, and these seemed to be fine with plenty available, and as far as I can tell there is plenty of free memory (although there may be some limit of this particular process I am not aware of, if this is relevant), so I am not sure what could cause <code>ENOSPC</code> to be returned as a result of a <code>gettimerid()</code> call.</p>\n\n<p>Example code:</p>\n\n<pre><code>static timer_t TimerId;\n\nif ( ( TimerId = gettimerid(TIMEOFDAY, 0) ) &lt; 0 )\n{\n  printf( \"gettimerid fail [timer id=%d, errno=%d]\", TimerId, errno );\n}\n</code></pre>\n\n<p>Example Output:</p>\n\n<pre><code>gettimerid fail [timer id=-1, errno=28]\n</code></pre>\n\n<p>Does anyone know what might cause this return code from <code>gettimerid()</code> on AIX?</p>\n"}, {"tags": ["c", "octave", "code-translation"], "comments": [{"owner": {"reputation": 3699, "user_id": 375399, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/2ee1c857b767375e1fc848279f64584b?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/375399/nick"}, "edited": false, "score": 0, "creation_date": 1516200201, "post_id": 48302750, "comment_id": 83592128, "body": "My employer &quot;forces&quot; me to use ASP, but I smile and learn it because I like having a job. Have you considered learning Octave?"}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1516202838, "post_id": 48302750, "comment_id": 83594007, "body": "learn octave (basically matlab).  It has different use-cases than C and it will help to broaden your horizons."}, {"owner": {"reputation": 7449, "user_id": 3811887, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/88dcea89bc4be8736da3b890f368a788?s=128&d=identicon&r=PG&f=1", "display_name": "Andy", "link": "https://stackoverflow.com/users/3811887/andy"}, "edited": false, "score": 0, "creation_date": 1516210397, "post_id": 48302750, "comment_id": 83598909, "body": "It&#39;s not possible to automatically translate C to &quot;M language&quot;. It&#39;s a little bit like asking &quot;Is there an assembler to Java converter?&quot;"}, {"owner": {"reputation": 3, "user_id": 5866821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae6133d97d6c65201336a21a2cacd00c?s=128&d=identicon&r=PG&f=1", "display_name": "Bhaskar", "link": "https://stackoverflow.com/users/5866821/bhaskar"}, "edited": false, "score": 0, "creation_date": 1516654551, "post_id": 48302750, "comment_id": 83767981, "body": "I was just trying to look out. Octave/MATLAB is not exactly the best way to write efficient fast numerical codes. I&#39;m not a core industry developer, but rather someone using languages like C to write codes for numerical solutions. I&#39;d rather write numerically efficient codes and get it translated to octave script rather than getting a messy translated code back. If there&#39;s a way to reduce double work, then awesome. Otherwise I don&#39;t mind writing in octave."}], "answers": [{"comments": [{"owner": {"reputation": 7449, "user_id": 3811887, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/88dcea89bc4be8736da3b890f368a788?s=128&d=identicon&r=PG&f=1", "display_name": "Andy", "link": "https://stackoverflow.com/users/3811887/andy"}, "edited": false, "score": 1, "creation_date": 1516210256, "post_id": 48303692, "comment_id": 83598827, "body": "I think this answer completly missed the question from OP. He is asking to translate C to Octave, not the other way"}], "tags": [], "owner": {"reputation": 26, "user_id": 9229737, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e2b237f6f78e019d223a7bfd8ea156?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin Efe", "link": "https://stackoverflow.com/users/9229737/kevin-efe"}, "is_accepted": true, "score": 1, "last_activity_date": 1516200050, "creation_date": 1516200050, "answer_id": 48303692, "question_id": 48302750, "link": "https://stackoverflow.com/questions/48302750/converting-c-code-to-octave/48303692#48303692", "title": "Converting C code to octave", "body": "<p>There are at least 2 packages that can convert many Octave operations to C++:</p>\n\n<p>There is a MATLAB toolbox called Coders toolbox which could do the job for you. But this is licensed toolbox and you need to purchase it if not available already. </p>\n\n<p>Ublas tool is worth trying. \nOne could also use  Armadillo library in native C/C++ to achieve the same functionalities and can be tweaked for performance as well.</p>\n\n<p>Hope this helps.</p>\n"}], "owner": {"reputation": 3, "user_id": 5866821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae6133d97d6c65201336a21a2cacd00c?s=128&d=identicon&r=PG&f=1", "display_name": "Bhaskar", "link": "https://stackoverflow.com/users/5866821/bhaskar"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 537, "favorite_count": 0, "closed_date": 1516200476, "accepted_answer_id": 48303692, "answer_count": 1, "score": -5, "last_activity_date": 1516200050, "creation_date": 1516197080, "question_id": 48302750, "link": "https://stackoverflow.com/questions/48302750/converting-c-code-to-octave", "closed_reason": "Not suitable for this site", "title": "Converting C code to octave", "body": "<p>I'm looking for libraries which would translate C code to octave. My instructor is forcing me to use octave, even though C is my strong point. </p>\n\n<p>Is there any way through which I can convert C to octave code ? I'm currently using octave in Linux.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 1204, "user_id": 4070243, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sVC5e.png?s=128&g=1", "display_name": "gj13", "link": "https://stackoverflow.com/users/4070243/gj13"}, "edited": false, "score": 1, "creation_date": 1516195727, "post_id": 48302265, "comment_id": 83589138, "body": "Please more information. e.g. platform, OS, are the buttons GPIOs etc.."}, {"owner": {"reputation": 1, "user_id": 8971168, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6041dc2267af9a5956ac4edf8634846?s=128&d=identicon&r=PG&f=1", "display_name": "joe adamu", "link": "https://stackoverflow.com/users/8971168/joe-adamu"}, "reply_to_user": {"reputation": 1204, "user_id": 4070243, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sVC5e.png?s=128&g=1", "display_name": "gj13", "link": "https://stackoverflow.com/users/4070243/gj13"}, "edited": false, "score": 0, "creation_date": 1516197632, "post_id": 48302265, "comment_id": 83590392, "body": "@gj13 i have updated it"}, {"owner": {"reputation": 19601, "user_id": 1620779, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/dlgGb.png?s=128&g=1", "display_name": "sjsam", "link": "https://stackoverflow.com/users/1620779/sjsam"}, "edited": false, "score": 0, "creation_date": 1516197701, "post_id": 48302265, "comment_id": 83590435, "body": "Hmm. always tag sensibly to attract the relevant audience.  :)"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1516199201, "post_id": 48302265, "comment_id": 83591462, "body": "If you are using the C/C++ language, please tag your question with the C/C++ tag. C and C++ tags are not appropriate here, they are for C and C++ languages respectively."}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1516202179, "post_id": 48302265, "comment_id": 83593501, "body": "Since you are using the C++ tag, you should consider using <code>std::stringstream</code> instead of <code>sprintf</code>.  The <code>sprintf</code> has the possibility of overflowing buffers."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1516204910, "post_id": 48302265, "comment_id": 83595465, "body": "C++ tag deleted as nothing about this post hints at C++"}], "owner": {"reputation": 1, "user_id": 8971168, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6041dc2267af9a5956ac4edf8634846?s=128&d=identicon&r=PG&f=1", "display_name": "joe adamu", "link": "https://stackoverflow.com/users/8971168/joe-adamu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 99, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1516204854, "creation_date": 1516195530, "last_edit_date": 1516204854, "question_id": 48302265, "link": "https://stackoverflow.com/questions/48302265/setting-date-and-time-using-push-buttons", "title": "setting date and time using push buttons", "body": "<p>Hello guys i am trying to write a program that i can use a push switch(GPIO) to set date and time so basically after setting the time it should keep on counting just as a normal time would am going to use a nucleo board-f746zg(os.mbed platform) but i haven't got an idea how to do that i would appreciate it very much if any one could give me an idea on how to do it please even if its small i would appreciate it. i found this code below but i don't know how it really works.</p>\n\n<pre><code>/*********************************************************************/\nvoid set_clock()\n{   unsigned char i;  \n    unsigned char temp;      //temp is used to hold a value specifying which digit we are changing\n    temp=1;                      //start with HOUR\n    i=1;\n    lcd_clear();                 //clear display\n    lcd_goto(0x40);           //go to second row\n    lcd_puts(mSet);          //display user message\n    //must convert values to decimal for displaying since they are in Binary Coded Decimal format used in the RTC\n    rtc_hour=myBCD2DEC(rtc_hour);\n    rtc_min=myBCD2DEC(rtc_min);\n    rtc_month=myBCD2DEC(rtc_month);\n    rtc_date=myBCD2DEC(rtc_date);\n    rtc_year=myBCD2DEC(rtc_year);\n    rtc_day=myBCD2DEC(rtc_day);\n    update_time();             //display time/date on LCD\n\n    while(!Middle_Switch){};        //wait for button to be released\n\n    while(i){\n    if(!Middle_Switch){\n        ++temp;\n        DelayMs(200);\n        while(!Middle_Switch){};        //wait for button to be released\n    }; \n    switch(temp) {\n        case 1: //Hour\n            if (!Right_Switch){\n                ++rtc_hour;\n                if(rtc_hour&gt;23){rtc_hour=0;};\n                DelayMs(200);           //delay to De-Bounce switch\n            }\n            else if (!Left_Switch){\n                if(rtc_hour==0){\n                    rtc_hour=23;}\n                else{\n                    --rtc_hour;\n                };\n                DelayMs(200);\n            };\n            break;\n        case 2: //Minutes\n            if (!Right_Switch){\n                ++rtc_min;\n                if(rtc_min&gt;59){rtc_min=0;};\n                DelayMs(200);\n            }\n            else if (!Left_Switch){\n                if(rtc_min==0){\n                    rtc_min=59;}\n                else{\n                    --rtc_min;\n                };\n                DelayMs(200);\n            };\n            break;\n        case 3: //Month\n            if (!Right_Switch){\n                ++rtc_month;\n                if(rtc_month&gt;12){rtc_month=1;};\n                DelayMs(200);\n            }\n            else if (!Left_Switch){\n                if(rtc_month==1){\n                    rtc_month=12;}\n                else{\n                    --rtc_month;\n                };\n                DelayMs(200);\n            };\n            break;\n        case 4: //Date\n            if (!Right_Switch){\n                ++rtc_date;\n                if(rtc_date&gt;31){rtc_date=1;};\n                DelayMs(200);\n            }\n            else if (!Left_Switch){\n                if(rtc_date==1){\n                    rtc_date=31;}\n                else{\n                    --rtc_date;\n                };\n                DelayMs(200);\n            };\n            break;\n        case 5: //year\n            if (!Right_Switch){\n                ++rtc_year;\n                if(rtc_year&gt;99){rtc_year=0;};\n                DelayMs(200);\n            }\n            else if (!Left_Switch){\n                if(rtc_year==0){\n                    rtc_year=99;}\n                else{\n                    --rtc_year;\n                };\n                DelayMs(200);\n            };\n            break;\n        case 6: //day of week (sunday = 1)\n            if (!Right_Switch){\n                ++rtc_day;\n                if(rtc_day&gt;7){rtc_day=1;};\n                DelayMs(200);\n            }\n            else if (!Left_Switch){\n                if(rtc_day==1){\n                    rtc_day=7;}\n                else{\n                    --rtc_day;\n                };\n                DelayMs(200);\n            };\n            break;\n        case 7:\n            //convert settings back to BCD\n            rtc_hour=myDEC2BCD(rtc_hour);\n            rtc_min=myDEC2BCD(rtc_min);\n            rtc_sec=0;\n            rtc_month=myDEC2BCD(rtc_month);\n            rtc_date=myDEC2BCD(rtc_date);\n            rtc_year=myDEC2BCD(rtc_year);\n            rtc_day=myDEC2BCD(rtc_day);\n            //save all settings back to registers\n            write_clk_regs();\n            i=0;       \n            break;\n        };//end switch\n        update_time();\n    };//end while\n}//end set clock\n/*********************************************************************/\n//Function used to display the date/time on 2x16 LCD//\nvoid update_time()\n{   lcd_goto(0x00);\n    sprintf(LCD_Buffer,\"%2d:%2d %2d|%2d|%2d %d\",rtc_hour,rtc_min,rtc_month,rtc_date,rtc_year,rtc_day);\n    lcd_puts(LCD_Buffer);\n}\n/*********************************************************************/\n</code></pre>\n"}, {"tags": ["c", "arrays", "string", "qsort"], "comments": [{"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1516194824, "post_id": 48301965, "comment_id": 83588484, "body": "change <code>const char *ia = a;</code> to  <code>const char *ia = (char *)a;</code>"}, {"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 1, "creation_date": 1516194839, "post_id": 48301965, "comment_id": 83588494, "body": "The problem is not in your function.   It will be in the call <code>qsort(string_mix, (size_t) (k - 1), sizeof(char), compare_at3)</code>.   If <code>string_mix</code> is an array of <code>char *</code> and <code>k-1</code> is equal to the number of elements in <code>string_mix</code>, then the call will need to be <code>qsort(string_mix, (size_t) (k - 1), sizeof(char *), compare_at3)</code>  (note the additional <code>*</code> in the operand of <code>sizeof</code>).      However, if <code>string_mix</code> or <code>k-1</code> are something else (you haven&#39;t specified), all bets are off."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1516194898, "post_id": 48301965, "comment_id": 83588533, "body": "<code>sizeof(char)</code> looks fishy, please post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. There is not enough information, so there is no reliable way to answer this question."}, {"owner": {"reputation": 17331, "user_id": 8950365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c6ba3b19f86f1bea8cf76e691db4349?s=128&d=identicon&r=PG&f=1", "display_name": "rafix07", "link": "https://stackoverflow.com/users/8950365/rafix07"}, "edited": false, "score": 1, "creation_date": 1516195125, "post_id": 48301965, "comment_id": 83588698, "body": "if you have array with 20 characters, call <code>qsort(string_mix, 4, 5, compare_at3);</code>, it should work. You want to sort 4 elements when each one has 5 bytes length."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1516201370, "post_id": 48301965, "comment_id": 83592914, "body": "Since you don&#39;t show the variable declarations, nobody can answer the question. What is <code>k</code>? Why do you do implicit casts to size_t, are you trying to use a C++ compiler? Your qsort is definitely wrong: each item in your list is either an array of <code>char</code> or a pointer to <code>char</code>, not a single <code>char</code>. Using a static variable in the compare function seems mighty fishy."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1516201597, "post_id": 48301965, "comment_id": 83593064, "body": "@Lundin: The static object in the comparison function is just for debugging. It is not used in evaluating the comparison, just for printing a statement to help the OP trace execution. It can be disregarded."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1516201663, "post_id": 48301965, "comment_id": 83593112, "body": "@EricPostpischil So you say, but the OP seems to name every variable in their program <code>k</code>..."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6306428"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1516202239, "post_id": 48301965, "comment_id": 83593547, "body": "@Lundin K in the compare function is just there for debugging. The implicit casting is just a habit."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6306428"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1516202371, "post_id": 48301965, "comment_id": 83593655, "body": "@MichaelWalz <code>string_mix</code> is a 2D array consisting of those strings in the question. Defined like <code>char* string_mix[MAX_NO_OF_STRINGS]</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6306428"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1516202765, "post_id": 48301965, "comment_id": 83593958, "body": "@MichaelWalz Done! Sorry about that."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1516202818, "post_id": 48301965, "comment_id": 83593992, "body": "@dis.obs as already requested you should post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1516204116, "post_id": 48301965, "comment_id": 83594906, "body": "Please post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> what you posted is not complete."}], "answers": [{"comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1516195068, "post_id": 48302105, "comment_id": 83588665, "body": "This is rather a comment than an answer. Yes, you need 50 points of reputation to be able to comment."}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1516195145, "post_id": 48302105, "comment_id": 83588715, "body": "@MichaelWalz -  Yes, but it is a decent comment, and yes, answerer does need points for any other interaction"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 1, "creation_date": 1516195864, "post_id": 48302105, "comment_id": 83589227, "body": "Pointer type in the compare function is most probably not causing the problem. As the function shall compare strings, it is a valid assumption that accessing the pointers via a <code>char*</code> does not cause problems. Problem is that swapping the elements of the array only swaps 1 byte instead of a pointer."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1516199406, "post_id": 48302105, "comment_id": 83591618, "body": "The number (non-ascii character) is at index [3], not [2]. Text of the question is a bit unclear, while the provided data shows what is desired"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1516201187, "post_id": 48302105, "comment_id": 83592785, "body": "The <code>qsort</code> interface <b>requires</b> that the comparison routines accept <code>const void *</code>, and they must cast them to pointers to the actual type. This is not bad style because it is not style; it is a requirement of C. It may be deficient in some regards compared to facilities available in more modern language, but that is a legacy burden, and it is not the OP\u2019s responsibility and has no relevance to the question."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1516201581, "post_id": 48302105, "comment_id": 83593055, "body": "Of course they know about the memory, they pass an array of a certain format to qsort. It is not bad style, since qsort expects a function with two <code>const void*</code>, there&#39;s no way around it. Do you even know how qsort works?"}, {"owner": {"reputation": 300, "user_id": 8800091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/230f0c9c6f2224071a4c4dc45bd1087f?s=128&d=identicon&r=PG&f=1", "display_name": "andi8086", "link": "https://stackoverflow.com/users/8800091/andi8086"}, "edited": false, "score": 0, "creation_date": 1516270970, "post_id": 48302105, "comment_id": 83623246, "body": "Thanks for voting me down becuase I wanted to help."}], "tags": [], "owner": {"reputation": 300, "user_id": 8800091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/230f0c9c6f2224071a4c4dc45bd1087f?s=128&d=identicon&r=PG&f=1", "display_name": "andi8086", "link": "https://stackoverflow.com/users/8800091/andi8086"}, "is_accepted": false, "score": -2, "last_activity_date": 1516195016, "creation_date": 1516195016, "answer_id": 48302105, "question_id": 48301965, "link": "https://stackoverflow.com/questions/48301965/using-qsort-from-stdlib-c-to-sort-an-array-of-strings-in-c-according-to-the-3r/48302105#48302105", "title": "Using qsort() from stdlib.c to sort an array of strings in C according to the 3rd letter in each *char", "body": "<p>You convert a void pointer to a char pointer and access index 3 without knowing anything about the memory, the char pointer is pointing to inside the function. This is bad style and most probably the reason for your SIGSEGV, because you cannot access ia[3].</p>\n\n<p>Furthermore, you say, you want to sort according to the 3rd letter... this would be ia[2], if ia were the correct pointer to the char array.</p>\n\n<p>Please post your code... how did you create the array of char*?</p>\n"}, {"comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1516195504, "post_id": 48302209, "comment_id": 83588964, "body": "We don&#39;t really know what <code>string_mix</code> is, so not sure if this is the right answer."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 1, "creation_date": 1516198367, "post_id": 48302209, "comment_id": 83590900, "body": "@ryyker we don&#39;t know what <code>string_mix</code> is, the OP didn&#39;t bother to tell us, therefore using <code>sizeof (char*)</code> might or might not be the thing to use. In other words we don&#39;t know if he wants to sort pointers to strings or just strings."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1516201505, "post_id": 48302209, "comment_id": 83593007, "body": "This is why we shouldn&#39;t answer the question in the first place - it can&#39;t be answered since not enough information was provided. Instead of guessing, ask the OP for clarification."}], "tags": [], "owner": {"reputation": 32098, "user_id": 646887, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YJ0Ye.jpg?s=128&g=1", "display_name": "Klas Lindb&#228;ck", "link": "https://stackoverflow.com/users/646887/klas-lindb%c3%a4ck"}, "is_accepted": false, "score": 3, "last_activity_date": 1516195361, "creation_date": 1516195361, "answer_id": 48302209, "question_id": 48301965, "link": "https://stackoverflow.com/questions/48301965/using-qsort-from-stdlib-c-to-sort-an-array-of-strings-in-c-according-to-the-3r/48302209#48302209", "title": "Using qsort() from stdlib.c to sort an array of strings in C according to the 3rd letter in each *char", "body": "<p>The call to <code>qsort</code> is incorrect. The third parameter should be the size of each element. A correct call could be:</p>\n\n<pre><code>qsort(string_mix, (size_t) (k - 1), sizeof *string_mix, compare_at3);\n</code></pre>\n\n<p>or, if you prefer, and assuming <code>string_mix</code> is an array of <code>char*</code>:</p>\n\n<pre><code>qsort(string_mix, (size_t) (k - 1), sizeof (char*), compare_at3);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": true, "score": 2, "last_activity_date": 1516204484, "last_edit_date": 1516204484, "creation_date": 1516204154, "answer_id": 48304985, "question_id": 48301965, "link": "https://stackoverflow.com/questions/48301965/using-qsort-from-stdlib-c-to-sort-an-array-of-strings-in-c-according-to-the-3r/48304985#48304985", "title": "Using qsort() from stdlib.c to sort an array of strings in C according to the 3rd letter in each *char", "body": "<p><code>string_mix</code> is an array of pointers - each array element is a pointer.  <code>qsort()</code> calls need to pass the size of the element. <a href=\"https://stackoverflow.com/a/48302209/2410359\">@Klas Lindb\u00e4ck</a></p>\n\n<pre><code>void qsort(void *base, size_t nmemb, size_t size, \n    int (*compar)(const void *, const void *));\n\nchar* string_mix[MAX_NO_OF_STRINGS];\n\n// qsort(string_mix, (size_t) (k - 1), sizeof(char), compare_at3);\n\n// I suppose k-1 represents the count of elements used \nsize_t number_of_elements = k - 1;\n\nqsort(string_mix, number_of_elements, sizeof string_mix[0], compare_at3);\n</code></pre>\n\n<hr>\n\n<blockquote>\n  <p>what am I doing wrong to get SIGSEGV segfault errors?</p>\n</blockquote>\n\n<p>Wrong type assumed in compare function.</p>\n\n<p>The compare function receives 2 pointers.  Each is a pointer to an element of the array.  In OP's case this is a pointer to a pointer. </p>\n\n<pre><code>int compare_at3(const void* a, const void* b){\n  static int k = 1;\n  printf(\"In compare_at3 %d iter\\n\", k++);\n\n  // const char *ia = a;\n  const char **ia = (const char **) a;\n  const char **ib = (const char **) b;\n\n  const char *sa = *ia;\n  const char *sb = *ib;\n\n  // Code could insure sa, sb are long enough\n  if (sa[0] == '\\0' || sa[1] == '\\0' || sa[2] == '\\0') Handle_OddCase();\n  if (sb[0] == '\\0' || sb[1] == '\\0' || sb[2] == '\\0') Handle_OddCase();\n\n  // The classic compare indium is below, it never overflows.\n  return (sa[3] &gt; sb[3]) - (sa[3] &lt; sb[3]);\n}\n</code></pre>\n\n<hr>\n\n<p>Note: Concerning OP comment \"It's a 2D array of those strings in the question defined like\".  <code>string_mix</code> is better described as a 1D array of pointers.</p>\n\n<pre><code>char* string_mix[MAX_NO_OF_STRINGS];\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6306428"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 273, "favorite_count": 0, "accepted_answer_id": 48304985, "answer_count": 3, "score": 0, "last_activity_date": 1516204484, "creation_date": 1516194508, "last_edit_date": 1516203910, "question_id": 48301965, "link": "https://stackoverflow.com/questions/48301965/using-qsort-from-stdlib-c-to-sort-an-array-of-strings-in-c-according-to-the-3r", "title": "Using qsort() from stdlib.c to sort an array of strings in C according to the 3rd letter in each *char", "body": "<p>I have an array of char* like this</p>\n\n<pre><code>aob3l\ngou5!\noib1k\nllp6d\n</code></pre>\n\n<p>with every 3rd index a number.</p>\n\n<p>I want to use qsort() to sort that list according to those numbers.</p>\n\n<p>A sorted list would look like this</p>\n\n<pre><code>oib1k\naob3l\ngou5!\nllp6d\n</code></pre>\n\n<p>This is how I'm trying to implement it.</p>\n\n<pre><code>qsort(string_mix, (size_t) (k - 1), sizeof(char), compare_at3);\n</code></pre>\n\n<p>My <code>compare_at3</code> function looks like this</p>\n\n<pre><code>int compare_at3(const void* a, const void* b){\n    static int k = 1;\n    const char *ia = a;\n    const char *ib = b;\n\n    printf(\"In compare_at3 %d iter\\n\", k++);\n\n    return ((ia[3] - '0') - (ib[3] - '0'));\n}\n</code></pre>\n\n<p>And my question is, </p>\n\n<p>what am I doing wrong to get SIGSEGV segfault errors?</p>\n\n<p>My best guess is that this line <code>const char *ia = a;</code> isn't doing what I think it's doing.</p>\n\n<p>I'm using <code>*</code> in <code>*ia</code> so I can subscript <code>int</code> as its index but maybe <code>*ia</code> isn't the <code>char*</code> like <code>aob3l</code>.</p>\n\n<p>EDIT1: Sorry, I didn't mention what exactly <code>string_mix</code> is.</p>\n\n<p>It's a 2D array of those strings in the question defined like</p>\n\n<p><code>char* string_mix[MAX_NO_OF_STRINGS]</code></p>\n\n<pre><code>char s1_formatted[strlen(s1)];\nchar s2_formatted[strlen(s2)];\nformatted(s1, s1_formatted);\nformatted(s2, s2_formatted);\n\nchar s1_s[26][MAX_LEN_A];\nchar s2_s[26][MAX_LEN_B];\n\nfor(char ch = 'a'; ch &lt;= 'z'; ch++) {\n    sprintf(s1_s[ch - 'a'], \"%c%d%s\", ch, s1_n[ch - 'a'], t_stringer1[ch - 'l']);\n    sprintf(s2_s[ch - 'a'], \"%c%d%s\", ch, s2_n[ch - 'a'], fs_stringer1[ch - 'o')]);\n}\n\nchar* string_mix[MAX_NO_OF_STRINGS];\n\nint k = 0;\nfor(int i = 0; i &lt; 26; i++){\n    if(s1_s[i][3] - '0' != 0){\n        string_mix[k] = s1_s[i];\n        k++;\n    }\n    else if(s2_s[i][3] - '0' != 0){\n        string_mix[k] = s2_s[i];\n        k++;\n    }\n}\n</code></pre>\n"}, {"tags": ["c#", "c"], "comments": [{"owner": {"reputation": 3108, "user_id": 4641116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gc52U.png?s=128&g=1", "display_name": "Eljay", "link": "https://stackoverflow.com/users/4641116/eljay"}, "edited": false, "score": 0, "creation_date": 1516194273, "post_id": 48301847, "comment_id": 83588164, "body": "I&#39;m not sure why this question is tagged <code>c++</code>."}, {"owner": {"reputation": 20747, "user_id": 1233251, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/cI9GF.png?s=128&g=1", "display_name": "E_net4 says don&#39;t copy that", "link": "https://stackoverflow.com/users/1233251/e-net4-says-dont-copy-that"}, "edited": false, "score": 2, "creation_date": 1516194485, "post_id": 48301847, "comment_id": 83588278, "body": "Please remove the C++ tag. Can you also explain in words what the function is supposed to do?"}, {"owner": {"reputation": 3, "user_id": 9229453, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-EvDHdq7HXOk/AAAAAAAAAAI/AAAAAAAAABE/-4DrW9GSxU8/photo.jpg?sz=128", "display_name": "scaw.dev", "link": "https://stackoverflow.com/users/9229453/scaw-dev"}, "edited": false, "score": 0, "creation_date": 1516194539, "post_id": 48301847, "comment_id": 83588303, "body": "c++ tag removed, sorry."}, {"owner": {"reputation": 85822, "user_id": 597607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jCzJi.png?s=128&g=1", "display_name": "Bo Persson", "link": "https://stackoverflow.com/users/597607/bo-persson"}, "edited": false, "score": 2, "creation_date": 1516194934, "post_id": 48301847, "comment_id": 83588565, "body": "<code>uint8_t</code> is the closest you have to a <code>byte</code> type in C, for accessing raw memory as bytes. And even in C the code sucks big time. You should <i>really</i> figure out what <code>foo</code> is <b>supposed</b> to be doing and recode that in your language."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1516201783, "post_id": 48301847, "comment_id": 83593198, "body": "The purpose of <code>((uint8_t *)st)[Length] = 0x01;</code> appears to be write out of bounds of the array, in order to create a program crash."}], "answers": [{"tags": [], "owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "is_accepted": true, "score": 0, "last_activity_date": 1516197258, "creation_date": 1516197258, "answer_id": 48302812, "question_id": 48301847, "link": "https://stackoverflow.com/questions/48301847/equivalent-c-code-in-c-uint8-t-cast/48302812#48302812", "title": "Equivalent C code in C#. (uint8_t *) cast?", "body": "<p>What your function does is rather primitive memory manipulation:</p>\n\n<pre><code>void foo(uint64_t *output, uint64_t *input, uint32_t Length)\n{\n  uint64_t st[25];\n</code></pre>\n\n<p>Your function takes a pointer to 16 elements of <code>uint64_t</code> and prepares a local buffer (<code>st</code>) to store a copy of them.</p>\n\n<pre><code>  memcpy(st, input, Length);\n  ((uint8_t *)st)[Length] = 0x01;\n  memset(((uint8_t *)st) + Length + 1, 0x00, 128 - Length - 1);\n</code></pre>\n\n<p>Make a copy of the <code>input</code> array into <code>st</code> but insert a byte with value 1 at an offset of <code>Length</code> bytes from the start. </p>\n\n<pre><code>  for(int i = 16; i &lt; 25; ++i) st[i] = 0x00UL;\n</code></pre>\n\n<p>The remaining 8 elements of the buffer are cleared to 0. Writing <code>st[16]</code> is pointless as it will be changed again by the next line...</p>\n\n<pre><code>  // Last bit of padding\n  st[16] = 0x8000000000000000UL;\n</code></pre>\n\n<p>Now we have 16*8 bytes from the input buffer, 1 extra byte with value 1 inserted somewhere and the remaining elements are filled with 1&lt;&lt;63 and lots of 0 bytes.</p>\n\n<pre><code>  bar(st);\n\n  memcpy(output, st, 200);\n}\n</code></pre>\n\n<p>Do something we have no clue about and copy the resulting 25 elements into the <code>output</code> buffer</p>\n"}], "owner": {"reputation": 3, "user_id": 9229453, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-EvDHdq7HXOk/AAAAAAAAAAI/AAAAAAAAABE/-4DrW9GSxU8/photo.jpg?sz=128", "display_name": "scaw.dev", "link": "https://stackoverflow.com/users/9229453/scaw-dev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 521, "favorite_count": 0, "accepted_answer_id": 48302812, "answer_count": 1, "score": -2, "last_activity_date": 1516197258, "creation_date": 1516194140, "last_edit_date": 1516194418, "question_id": 48301847, "link": "https://stackoverflow.com/questions/48301847/equivalent-c-code-in-c-uint8-t-cast", "title": "Equivalent C code in C#. (uint8_t *) cast?", "body": "<p>I am trying to convert these C piece of code into C#. But I've stumble in some parts that I don't understand exactly what is happening, so I am unable to translate it.</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>void foo(uint64_t *output, uint64_t *input, uint32_t Length){\n\n    uint64_t st[25];\n\n    memcpy(st, input, Length);\n\n    ((uint8_t *)st)[Length] = 0x01;\n\n    memset(((uint8_t *)st) + Length + 1, 0x00, 128 - Length - 1);\n\n    for(int i = 16; i &lt; 25; ++i) st[i] = 0x00UL;\n\n    // Last bit of padding\n    st[16] = 0x8000000000000000UL;\n\n    bar(st);\n\n    memcpy(output, st, 200);\n}\n</code></pre>\n\n<p>More specifically in the <code>((uint8_t *)st)[Length] = 0x01;</code> part. I cannot understand the cast/pointer in this line. Why is the <code>*</code> there for? If somebody could explain what is happening, I would be grateful.</p>\n\n<p>What I got so far in C#:</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>private void foo(ref ulong[] output, ref ulong[] input, uint Length)\n    {\n        ulong[] st = new ulong[25];\n\n        //memcpy(st, input, Length);\n        Buffer.BlockCopy(input, 0, st, 0, (int)Length);\n\n        // Help in these line please:\n        //((uint8_t *)st)[Length] = 0x01;\n\n        // Still don't know what to do here too:\n        //memset(((byte)st) + Length + 1, 0x00, 128 - Length - 1);\n\n        for (int i = 16; i &lt; 25; ++i)\n        {\n            st[i] = 0x00U;\n        }\n\n        // Last bit of padding\n        st[16] = 0x8000000000000000U;\n\n        bar(st);\n\n        //memcpy(output, st, 200);\n        Buffer.BlockCopy(st, 0, output, 0, 200);\n    }\n</code></pre>\n\n<p>Thank you.</p>\n"}, {"tags": ["c", "bus-error"], "comments": [{"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 3, "creation_date": 1516193762, "post_id": 48301700, "comment_id": 83587842, "body": "<code>fgets(input, 100, stdin);</code> but <code>input</code> isn&#39;t initialized. <code>char input[100];</code> would work"}, {"owner": {"reputation": 133, "user_id": 6225440, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a6bdbf75603c9c010f063f2accfb6899?s=128&d=identicon&r=PG&f=1", "display_name": "mark", "link": "https://stackoverflow.com/users/6225440/mark"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1516193863, "post_id": 48301700, "comment_id": 83587918, "body": "so i should use &quot;char input[100];&quot; instead of &quot;char *input;&quot;? @Jean-Fran&#231;oisFabre"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 1, "creation_date": 1516193884, "post_id": 48301700, "comment_id": 83587931, "body": "yup exactly...."}], "owner": {"reputation": 133, "user_id": 6225440, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a6bdbf75603c9c010f063f2accfb6899?s=128&d=identicon&r=PG&f=1", "display_name": "mark", "link": "https://stackoverflow.com/users/6225440/mark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 69, "favorite_count": 0, "closed_date": 1516193808, "answer_count": 0, "score": 0, "last_activity_date": 1516193832, "creation_date": 1516193658, "question_id": 48301700, "link": "https://stackoverflow.com/questions/48301700/unclear-bus-error-in-c-code", "closed_reason": "Duplicate", "title": "unclear bus error in C code", "body": "<p>I am currently trying to learn C and in order to do that I have tried to create very simple code that requests the first name of a person and puts it into a struct. It should then proceed to print the information using the \"print_contact\" function.</p>\n\n<p>For some reason I keep getting a Bus error 10 and I don't understand why this happens.</p>\n\n<pre><code>typedef struct {\n\n    char *first_name;\n    char *last_name;\n\n} contact;\n\nvoid print_contact(contact *c) {\n    printf(\"Name: %s %s\\n\", c-&gt;first_name, c-&gt;last_name);\n}\n\ncontact *populate_contact() {\n\n    contact *c;\n    char *input;\n\n    c = (contact *)malloc(sizeof(contact));\n\n    printf(\"&gt;&gt;&gt; Please Input The First Name: \");\n    fgets(input, 100, stdin);\n    c-&gt;first_name = strdup(input);\n    c-&gt;last_name = \"Doe\";\n\n}\n\n\nint main() {\n\n\n    contact m = *populate_contact();\n\n    print_contact(&amp;m);\n\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "assembly", "x86"], "comments": [{"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 5, "creation_date": 1516191071, "post_id": 48300784, "comment_id": 83586129, "body": "If your class is in Assembly programming, reading compiler generated code is not going to be of help. It&#39;s likely to be detriment in this stage of your education."}, {"owner": {"reputation": 5101, "user_id": 700170, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gZ8hw.png?s=128&g=1", "display_name": "Morten Jensen", "link": "https://stackoverflow.com/users/700170/morten-jensen"}, "edited": false, "score": 5, "creation_date": 1516191112, "post_id": 48300784, "comment_id": 83586152, "body": "you can try using <code>gcc -c -S -fverbose-asm file.c</code> - that should generate <code>file.s</code> with commented ASM"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 1, "creation_date": 1516191137, "post_id": 48300784, "comment_id": 83586162, "body": "It helps to single-step thropugh the assembler with your debugger, taking note of the actions on registers, memory etc."}, {"owner": {"reputation": 335, "user_id": 6144817, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/817d8a3995ca6e3f5a0cc6a8f45d0406?s=128&d=identicon&r=PG&f=1", "display_name": "Average_guy", "link": "https://stackoverflow.com/users/6144817/average-guy"}, "reply_to_user": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 1, "creation_date": 1516191338, "post_id": 48300784, "comment_id": 83586296, "body": "@StoryTeller My upcoming exam will have questions like &quot;Rewrite the above X86-assembler program in C&quot;, so I thought by practicing the other way around I could benifit."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1516191451, "post_id": 48300784, "comment_id": 83586379, "body": "@Hako - Is this a course in reverse engineering? If not, I doubt you&#39;ll need to understand the C to machine code transform :) Either way, assembly programming, like all programming, is about writing code that other people will understand. That&#39;s why compiler generated code can be a problem. Though it&#39;s not bad if you need help understanding a specific ABI"}, {"owner": {"reputation": 335, "user_id": 6144817, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/817d8a3995ca6e3f5a0cc6a8f45d0406?s=128&d=identicon&r=PG&f=1", "display_name": "Average_guy", "link": "https://stackoverflow.com/users/6144817/average-guy"}, "reply_to_user": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1516191813, "post_id": 48300784, "comment_id": 83586601, "body": "@StoryTeller The course is &quot;Computer Systems&quot;, and the question is under the category &quot;Machine architecture&quot; :) I see your point."}, {"owner": {"reputation": 335, "user_id": 6144817, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/817d8a3995ca6e3f5a0cc6a8f45d0406?s=128&d=identicon&r=PG&f=1", "display_name": "Average_guy", "link": "https://stackoverflow.com/users/6144817/average-guy"}, "reply_to_user": {"reputation": 5101, "user_id": 700170, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gZ8hw.png?s=128&g=1", "display_name": "Morten Jensen", "link": "https://stackoverflow.com/users/700170/morten-jensen"}, "edited": false, "score": 0, "creation_date": 1516192126, "post_id": 48300784, "comment_id": 83586763, "body": "@MortenJensen thanks for the tip!"}, {"owner": {"reputation": 335, "user_id": 6144817, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/817d8a3995ca6e3f5a0cc6a8f45d0406?s=128&d=identicon&r=PG&f=1", "display_name": "Average_guy", "link": "https://stackoverflow.com/users/6144817/average-guy"}, "reply_to_user": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1516192155, "post_id": 48300784, "comment_id": 83586778, "body": "@MartinJames thanks for the advice :)"}, {"owner": {"reputation": 15145, "user_id": 4271923, "user_type": "registered", "profile_image": "https://graph.facebook.com/543414580/picture?type=large", "display_name": "Ped7g", "link": "https://stackoverflow.com/users/4271923/ped7g"}, "edited": false, "score": 3, "creation_date": 1516192319, "post_id": 48300784, "comment_id": 83586878, "body": "You should also check optimized output of compiler, your current assembly is unoptimized -O0 updating stack frame and local variables after each line of source to make debugging in C source &quot;per line&quot; possible, the machine code generated without that feature will be considerably different (also much shorter, and probably easier to understand from the point of pure assembly ... and a bit harder to rewrite back into C source, at that point you must basically do asm -&gt; algorithm -&gt; write C from scratch, while the unoptimized code can be reconstructed almost literally by asm-&gt;C back-translation)."}], "answers": [{"comments": [{"owner": {"reputation": 335, "user_id": 6144817, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/817d8a3995ca6e3f5a0cc6a8f45d0406?s=128&d=identicon&r=PG&f=1", "display_name": "Average_guy", "link": "https://stackoverflow.com/users/6144817/average-guy"}, "edited": false, "score": 0, "creation_date": 1516191507, "post_id": 48300852, "comment_id": 83586422, "body": "Thank you! So the first line is because arg[1] is not in the stackframe, so we have to move it into another register fist, before we can move it into an address in the stackframe?"}, {"owner": {"reputation": 141, "user_id": 9164688, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Av6im.png?s=128&g=1", "display_name": "j31d0", "link": "https://stackoverflow.com/users/9164688/j31d0"}, "reply_to_user": {"reputation": 335, "user_id": 6144817, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/817d8a3995ca6e3f5a0cc6a8f45d0406?s=128&d=identicon&r=PG&f=1", "display_name": "Average_guy", "link": "https://stackoverflow.com/users/6144817/average-guy"}, "edited": false, "score": 2, "creation_date": 1516191588, "post_id": 48300852, "comment_id": 83586468, "body": "yes, because x86 and x64 don&#39;t have general memory to memory instruction (some exists but not for general use)"}, {"owner": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 1, "creation_date": 1516198263, "post_id": 48300852, "comment_id": 83590826, "body": "You don&#39;t have to copy it, it&#39;s just unoptimized code. Notice it&#39;s writing <code>rax</code> into memory, then reloading it and then transferring to <code>rdi</code>. Those 3 instructions can be replaced by a single <code>mov 0x8(%rax), %rdi</code>"}], "tags": [], "owner": {"reputation": 141, "user_id": 9164688, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Av6im.png?s=128&g=1", "display_name": "j31d0", "link": "https://stackoverflow.com/users/9164688/j31d0"}, "is_accepted": false, "score": 4, "last_activity_date": 1516191044, "creation_date": 1516191044, "answer_id": 48300852, "question_id": 48300784, "link": "https://stackoverflow.com/questions/48300784/trouble-understanding-this-assembly-code/48300852#48300852", "title": "Trouble understanding this assembly code", "body": "<pre><code>   0x00000000000006ba &lt;+26&gt;:    mov    0x8(%rax),%rax     # get argv[1] to rax\n   0x00000000000006be &lt;+30&gt;:    mov    %rax,-0x8(%rbp)    # move argv[1] to local variable\n   0x00000000000006c2 &lt;+34&gt;:    mov    -0x8(%rbp),%rax    # move local variable to rax (for move to rdi)\n   0x00000000000006c6 &lt;+38&gt;:    mov    %rax,%rdi          # now rdi has argv[1]\n   0x00000000000006c9 &lt;+41&gt;:    callq  0x560              # it is puts (optimized)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 335, "user_id": 6144817, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/817d8a3995ca6e3f5a0cc6a8f45d0406?s=128&d=identicon&r=PG&f=1", "display_name": "Average_guy", "link": "https://stackoverflow.com/users/6144817/average-guy"}, "edited": false, "score": 0, "creation_date": 1516193138, "post_id": 48301272, "comment_id": 83587416, "body": "It was unclear to me why  the <code>mov %rax,%rdi</code> was there, thank you :)"}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 1, "creation_date": 1516198694, "post_id": 48301272, "comment_id": 83591110, "body": "OP compiled without optimizations.  It&#39;s fairly normal to see really weird stuff when disabling optimizations. I recommend to compile with at least <code>-O1</code> to get the most basic optimizations in."}], "tags": [], "owner": {"reputation": 110, "user_id": 5789497, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/92PMU.jpg?s=128&g=1", "display_name": "Giuseppe Cotugno", "link": "https://stackoverflow.com/users/5789497/giuseppe-cotugno"}, "is_accepted": true, "score": 2, "last_activity_date": 1516192424, "creation_date": 1516192424, "answer_id": 48301272, "question_id": 48300784, "link": "https://stackoverflow.com/questions/48300784/trouble-understanding-this-assembly-code/48301272#48301272", "title": "Trouble understanding this assembly code", "body": "<p>I will try to make a guess:</p>\n\n<pre><code>mov    -0x20(%rbp),%rax   # retrieve argv[0]\nmov    0x8(%rax),%rax     # store argv[1] into rax\nmov    %rax,-0x8(%rbp)    # store argv[1] (which now is in rax) into y\nmov    -0x8(%rbp),%rax    # put y back into rax (which might look dumb, but possibly it has its reasons)\nmov    %rax,%rdi          # copy y to rdi, possibly to prepare the context for the printf\n</code></pre>\n\n<p>When you deal with assembler, please specify which architecture you are using. An Intel processor might use a different set of instructions from an ARM one, the same instructions might be different or they might rely on different assumptions. As you might know, optimisations change the sequence of assembler instructions generated by the compiler, you might want to specify whether you are using that as well (looks like not?) and which compiler you are using as everyone has its own policy for generating assembler.</p>\n\n<p>Maybe we will never know why the compiler must prepare the context for printf by copying from rax, it could be a compiler's choice or an obligation imposed by the specific architecture. For all those annoying reasons, most of people prefer to use a \"high level language\" such as C, so that the set of instructions is always right although it might look very dumb for a human (as we know computers are dumb by design) and not always the most choice, that's why there are still many compilers around.</p>\n\n<p>I can give you two more tips:</p>\n\n<ol>\n<li><p>you IDE must have a way to interleave assembler instructions with C code, and to single step within the assembler. Try to find it out and explore it yourself</p></li>\n<li><p>the IDE should also have a function to explore the memory of your program. If you find that try to enter the 0x560 address and look were it will lead you. It is very likely that that will be the entry point of your printf</p></li>\n</ol>\n\n<p>I hope that my answer will help you work it out, good luck</p>\n"}], "owner": {"reputation": 335, "user_id": 6144817, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/817d8a3995ca6e3f5a0cc6a8f45d0406?s=128&d=identicon&r=PG&f=1", "display_name": "Average_guy", "link": "https://stackoverflow.com/users/6144817/average-guy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 424, "favorite_count": 0, "accepted_answer_id": 48301272, "answer_count": 2, "score": 1, "last_activity_date": 1516195169, "creation_date": 1516190769, "last_edit_date": 1516195169, "question_id": 48300784, "link": "https://stackoverflow.com/questions/48300784/trouble-understanding-this-assembly-code", "title": "Trouble understanding this assembly code", "body": "<p>I have an exam comming up, and I'm strugling with assembly. I have written some simple C code, gotten its assembly code, and then trying to comment on the assembly code as practice. The C code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main(int argc, char const *argv[])\n{\n   int x = 10;\n   char const* y = argv[1];\n\n   printf(\"%s\\n\",y );\n\n   return 0;\n}\n</code></pre>\n\n<p>Its assembly code:</p>\n\n<pre class=\"lang-asm-x86 prettyprint-override\"><code>   0x00000000000006a0 &lt;+0&gt;: push   %rbp                   # Creating stack\n   0x00000000000006a1 &lt;+1&gt;: mov    %rsp,%rbp              # Saving base of stack into base pointer register\n   0x00000000000006a4 &lt;+4&gt;: sub    $0x20,%rsp             # Allocate 32 bytes of space on the stack\n   0x00000000000006a8 &lt;+8&gt;: mov    %edi,-0x14(%rbp)       # First argument stored in stackframe\n   0x00000000000006ab &lt;+11&gt;:    mov    %rsi,-0x20(%rbp)   # Second argument stored in stackframe\n   0x00000000000006af &lt;+15&gt;:    movl   $0xa,-0xc(%rbp)    # Value 10 stored in x's address in the stackframe\n   0x00000000000006b6 &lt;+22&gt;:    mov    -0x20(%rbp),%rax   # Second argument stored in return value register\n   0x00000000000006ba &lt;+26&gt;:    mov    0x8(%rax),%rax     # ??\n   0x00000000000006be &lt;+30&gt;:    mov    %rax,-0x8(%rbp)    # ??\n   0x00000000000006c2 &lt;+34&gt;:    mov    -0x8(%rbp),%rax    # ??\n   0x00000000000006c6 &lt;+38&gt;:    mov    %rax,%rdi          # Return value copied to 1st argument register - why??\n   0x00000000000006c9 &lt;+41&gt;:    callq  0x560              # printf??\n   0x00000000000006ce &lt;+46&gt;:    mov    $0x0,%eax          # Value 0 is copied to return register\n   0x00000000000006d3 &lt;+51&gt;:    leaveq                    # Destroying stackframe\n   0x00000000000006d4 &lt;+52&gt;:    retq                      # Popping return address, and setting instruction pointer equal to it\n</code></pre>\n\n<p>Can a friendly soul help me out wherever I have \"??\" (meaning I don't understand what is happening or I'm unsure)?</p>\n"}, {"tags": ["c", "recursion", "c-strings"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1516188187, "post_id": 48299883, "comment_id": 83584225, "body": "<code>if (!x)</code>-&gt;<code>if (!*x)</code> or a bit more readable: <code>if (!(*x))</code> or even more readable <code>if (x[0] == 0)</code>"}, {"owner": {"reputation": 13, "user_id": 7496168, "user_type": "registered", "accept_rate": 17, "profile_image": "https://graph.facebook.com/770785556392763/picture?type=large", "display_name": "Zeyad Ibrahim", "link": "https://stackoverflow.com/users/7496168/zeyad-ibrahim"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1516188346, "post_id": 48299883, "comment_id": 83584328, "body": "so what is the problem? why the compiler is giving me infinite loop? can u explain the mechanism?"}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1516189427, "post_id": 48299883, "comment_id": 83585009, "body": "Relevant: <a href=\"https://stackoverflow.com/q/1296843/694733\">What is the difference between NULL, &#39;\\0&#39; and 0</a>"}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1516190675, "post_id": 48299883, "comment_id": 83585864, "body": "Just in passing, there&#39;s no need to assign back to <code>x</code> (i.e. <code>++x</code>), as it&#39;s not used again in the same scope.  Just recurse with <code>foo1(x+1)</code> instead (remember that each invocation of <code>foo1()</code> gets its own value of <code>x</code>, that&#39;s unrelated to any other <code>x</code> in the program)."}], "answers": [{"tags": [], "owner": {"reputation": 55713, "user_id": 26095, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/WLsjF.jpg?s=128&g=1", "display_name": "Sean", "link": "https://stackoverflow.com/users/26095/sean"}, "is_accepted": true, "score": 2, "last_activity_date": 1516188516, "creation_date": 1516188516, "answer_id": 48300050, "question_id": 48299883, "link": "https://stackoverflow.com/questions/48299883/infinite-loop-when-callling-recursive-function-even-with-base-case/48300050#48300050", "title": "infinite loop when callling recursive function even with base case", "body": "<p>You stop iterating when the pointer becomes <code>null</code>. What you actually want is to stop iterating when you get to the <code>\\0</code> character (ie the end of the string):</p>\n\n<pre><code>int main()\n{\n  foo1(\"abc\");\n\n  return 0;\n}\n\nvoid foo1(char* x)\n{\n  if (*x == 0)\n      return;\n\n  printf(\"%c \",*x);\n  foo1(++x);\n}\n</code></pre>\n\n<p>Because you're iterating on the pointer value, rather than the item pointed to, you'll basically start to iterate over the process address space, starting from the location of the string. Chances are you'll run out of stack space before you get to an invalid address that causes a segmentation fault!</p>\n"}, {"tags": [], "owner": {"reputation": 2445, "user_id": 4390699, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/4fe7d756a92a20b8b49b05cc0f1bb628?s=128&d=identicon&r=PG", "display_name": "Raman", "link": "https://stackoverflow.com/users/4390699/raman"}, "is_accepted": false, "score": 0, "last_activity_date": 1516188545, "creation_date": 1516188545, "answer_id": 48300057, "question_id": 48299883, "link": "https://stackoverflow.com/questions/48299883/infinite-loop-when-callling-recursive-function-even-with-base-case/48300057#48300057", "title": "infinite loop when callling recursive function even with base case", "body": "<p>The problem is in your terminating condition</p>\n\n<pre><code>if (!x)\n    return;\n</code></pre>\n\n<p>Your pointer <code>x</code> never becomes <code>0</code> (or <code>NULL</code>). So it never terminates.</p>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 7496168, "user_type": "registered", "accept_rate": 17, "profile_image": "https://graph.facebook.com/770785556392763/picture?type=large", "display_name": "Zeyad Ibrahim", "link": "https://stackoverflow.com/users/7496168/zeyad-ibrahim"}, "edited": false, "score": 0, "creation_date": 1516189023, "post_id": 48300059, "comment_id": 83584746, "body": "u mean NULL is different from 0?"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 13, "user_id": 7496168, "user_type": "registered", "accept_rate": 17, "profile_image": "https://graph.facebook.com/770785556392763/picture?type=large", "display_name": "Zeyad Ibrahim", "link": "https://stackoverflow.com/users/7496168/zeyad-ibrahim"}, "edited": false, "score": 0, "creation_date": 1516191528, "post_id": 48300059, "comment_id": 83586435, "body": "@ZeyadIbrahim read <a href=\"https://stackoverflow.com/questions/1296843/what-is-the-difference-between-null-0-and-0\">this</a>"}], "tags": [], "owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "is_accepted": false, "score": 0, "last_activity_date": 1516188547, "creation_date": 1516188547, "answer_id": 48300059, "question_id": 48299883, "link": "https://stackoverflow.com/questions/48299883/infinite-loop-when-callling-recursive-function-even-with-base-case/48300059#48300059", "title": "infinite loop when callling recursive function even with base case", "body": "<p>This test is wrong:</p>\n\n<pre><code>if (!x)\n</code></pre>\n\n<p>your are simply testing if <code>x</code> is 0 and this never happens and therefore the base case never happens.</p>\n\n<p>Instead you need to check if <code>x</code> <em>points</em> to a NUL character (strings are terminated by a NUL character):</p>\n\n<pre><code>if (x[0] == 0) \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 9229285, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e49b17e5cd0837b1932530c1392d3e8?s=128&d=identicon&r=PG", "display_name": "user9229285", "link": "https://stackoverflow.com/users/9229285/user9229285"}, "is_accepted": false, "score": 0, "last_activity_date": 1516189271, "creation_date": 1516189271, "answer_id": 48300302, "question_id": 48299883, "link": "https://stackoverflow.com/questions/48299883/infinite-loop-when-callling-recursive-function-even-with-base-case/48300302#48300302", "title": "infinite loop when callling recursive function even with base case", "body": "<p>you need check not only pointer value but end of string also.\nYou code if(*x) checks only pointer value. You need check string element value also if(!x &amp;&amp; !(*x))</p>\n"}], "owner": {"reputation": 13, "user_id": 7496168, "user_type": "registered", "accept_rate": 17, "profile_image": "https://graph.facebook.com/770785556392763/picture?type=large", "display_name": "Zeyad Ibrahim", "link": "https://stackoverflow.com/users/7496168/zeyad-ibrahim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 161, "favorite_count": 0, "accepted_answer_id": 48300050, "answer_count": 4, "score": 0, "last_activity_date": 1516189388, "creation_date": 1516188017, "last_edit_date": 1516189388, "question_id": 48299883, "link": "https://stackoverflow.com/questions/48299883/infinite-loop-when-callling-recursive-function-even-with-base-case", "title": "infinite loop when callling recursive function even with base case", "body": "<p>I can't understand this code segment. What I think I know is that when I pass <code>\"abc\"</code> then <code>x</code> becomes a pointer to first element in string is this correct? and why is it giving me infinite loop?</p>\n\n<p>Here's my code:</p>\n\n<pre><code>void foo1(char* x)\n{\n    if (!x)\n        return;\n    printf(\"%c \",*x);\n    foo1(++x);\n}\n\nint main()\n{\n    foo1(\"abc\");\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "embedded"], "comments": [{"owner": {"reputation": 115745, "user_id": 119527, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lTjBL.png?s=128&g=1", "display_name": "Jonathon Reinhart", "link": "https://stackoverflow.com/users/119527/jonathon-reinhart"}, "edited": false, "score": 0, "creation_date": 1516187207, "post_id": 48299556, "comment_id": 83583631, "body": "This is not a good question for SO because it is very unlikely that it will be discovered by any future viewers."}, {"owner": {"reputation": 4677, "user_id": 519348, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/TIdre.jpg?s=128&g=1", "display_name": "TZHX", "link": "https://stackoverflow.com/users/519348/tzhx"}, "edited": false, "score": 0, "creation_date": 1516187231, "post_id": 48299556, "comment_id": 83583646, "body": "you&#39;re declaring a pointer (pUART) that references an instance of the tUART struct by casting the object UART_ADDR."}, {"owner": {"reputation": 32098, "user_id": 646887, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YJ0Ye.jpg?s=128&g=1", "display_name": "Klas Lindb&#228;ck", "link": "https://stackoverflow.com/users/646887/klas-lindb%c3%a4ck"}, "edited": false, "score": 6, "creation_date": 1516187233, "post_id": 48299556, "comment_id": 83583649, "body": "Looks like a memory-mapped UART."}, {"owner": {"reputation": 322, "user_id": 6409591, "user_type": "registered", "accept_rate": 38, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "jenny", "link": "https://stackoverflow.com/users/6409591/jenny"}, "edited": false, "score": 0, "creation_date": 1516187342, "post_id": 48299556, "comment_id": 83583727, "body": "the line <code>*pUART = (tUART*) UART_ADDR</code> meant assigning a pointer to another pointer right?"}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 2, "creation_date": 1516189197, "post_id": 48299556, "comment_id": 83584853, "body": "I&#39;m voting to close this question as off-topic because - easy to google, but it will not help the OP as he/she just do not know C. Some basic language knowledge is requierd"}, {"owner": {"reputation": 5101, "user_id": 700170, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gZ8hw.png?s=128&g=1", "display_name": "Morten Jensen", "link": "https://stackoverflow.com/users/700170/morten-jensen"}, "edited": false, "score": 1, "creation_date": 1516189574, "post_id": 48299556, "comment_id": 83585111, "body": "It&#39;s a mapping of the UART registers."}], "answers": [{"tags": [], "owner": {"reputation": 504, "user_id": 5097473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c46c48a9d610a31cc11fd8a3cf1aac9?s=128&d=identicon&r=PG", "display_name": "Vel", "link": "https://stackoverflow.com/users/5097473/vel"}, "is_accepted": false, "score": 1, "last_activity_date": 1516187370, "creation_date": 1516187370, "answer_id": 48299673, "question_id": 48299556, "link": "https://stackoverflow.com/questions/48299556/what-is-meant-by-following-line-of-code/48299673#48299673", "title": "What is meant by following line of code?", "body": "<p><code>pUART</code> is a pointer to variable of type <code>tUART</code> and it's static, so it's visible only within a file it's in. \nWhen you cast UART address like that (to a structure), you can acces specific registers easily, by fields of a structure instead of using <code>UART_ADDR</code> all the time.</p>\n"}, {"tags": [], "owner": {"reputation": 58, "user_id": 9225659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e3312cebfe63f9f5d969f35f1614698?s=128&d=identicon&r=PG&f=1", "display_name": "JDP", "link": "https://stackoverflow.com/users/9225659/jdp"}, "is_accepted": true, "score": 0, "last_activity_date": 1516188619, "creation_date": 1516188619, "answer_id": 48300088, "question_id": 48299556, "link": "https://stackoverflow.com/questions/48299556/what-is-meant-by-following-line-of-code/48300088#48300088", "title": "What is meant by following line of code?", "body": "<p>static keyword at global scope gives a variable internal linkage.Consequently the variable cannot be accessed from some other file using the extern qualifier.\nHere pUART is pointer to structure tUART. The line explains that UART_ADDR is hardware register address for UART and it assigned to another pointer of structure tUART.</p>\n"}], "owner": {"reputation": 322, "user_id": 6409591, "user_type": "registered", "accept_rate": 38, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "jenny", "link": "https://stackoverflow.com/users/6409591/jenny"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "closed_date": 1516208596, "accepted_answer_id": 48300088, "answer_count": 2, "score": -1, "last_activity_date": 1516188619, "creation_date": 1516187050, "last_edit_date": 1516187118, "question_id": 48299556, "link": "https://stackoverflow.com/questions/48299556/what-is-meant-by-following-line-of-code", "closed_reason": "Not suitable for this site", "title": "What is meant by following line of code?", "body": "<p>Here in a program, I found the following a line of code,</p>\n\n<p><code>static tUART  *pUART = (tUART*)UART_ADDR;</code></p>\n\n<p>Can anyone explain, what does above line of code means?\nAnd <code>tUART</code> is defined in one of the header files as follows:</p>\n\n<pre><code>typedef struct               /**&lt; UART data structure  */\n{\n    volatile tUARTBDH uartbdh;   /**&lt; UART baud rate high register  */\n    volatile tUARTBDL uartbdl;   /**&lt; UART baud rate low register   */\n    volatile tUARTCR1 uartcr1;   /**&lt; UART control register 1       */\n    volatile tUARTCR2 uartcr2;   /**&lt; UART control register 2 */\n    volatile tUARTSR1 uartsr1;   /**&lt; UART status register 1 */\n    volatile tUARTSR2 uartsr2;   /**&lt; UART status register 2 */\n    volatile tUARTCR3 uartcr3;   /**&lt; UART control register 3 */\n    volatile tUARTD   uartd;     /**&lt; UART data register */\n} tUART;\n</code></pre>\n"}, {"tags": ["c", "scanf"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6247531, "user_type": "registered", "profile_image": "https://graph.facebook.com/1038090816269580/picture?type=large", "display_name": "Vivek Singh", "link": "https://stackoverflow.com/users/6247531/vivek-singh"}, "edited": false, "score": 0, "creation_date": 1516189560, "post_id": 48299164, "comment_id": 83585095, "body": "Thanks got it. Thanks for the reference link."}], "tags": [], "owner": {"reputation": 19601, "user_id": 1620779, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/dlgGb.png?s=128&g=1", "display_name": "sjsam", "link": "https://stackoverflow.com/users/1620779/sjsam"}, "is_accepted": false, "score": 0, "last_activity_date": 1516186654, "last_edit_date": 1516186654, "creation_date": 1516185810, "answer_id": 48299164, "question_id": 48299112, "link": "https://stackoverflow.com/questions/48299112/why-scanfc-ch-do-not-read-the-character-from-console-while-scanf-c/48299164#48299164", "title": "why scanf(&quot;%c&quot;, &amp;ch ) do not read the character from console while scanf(&quot; %c&quot;, &amp;ch ) Does", "body": "<pre><code>scanf(\" %c\", &amp;ch );\n</code></pre>\n\n<p>This space before the <code>%c</code> is, probably, taking care of the buffered newline character. See <a href=\"https://stackoverflow.com/a/8464649/1620779\">[ this ]</a> answer.</p>\n"}], "owner": {"reputation": 1, "user_id": 6247531, "user_type": "registered", "profile_image": "https://graph.facebook.com/1038090816269580/picture?type=large", "display_name": "Vivek Singh", "link": "https://stackoverflow.com/users/6247531/vivek-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "closed_date": 1516185763, "answer_count": 1, "score": -1, "last_activity_date": 1516186654, "creation_date": 1516185657, "last_edit_date": 1516185755, "question_id": 48299112, "link": "https://stackoverflow.com/questions/48299112/why-scanfc-ch-do-not-read-the-character-from-console-while-scanf-c", "closed_reason": "Duplicate", "title": "why scanf(&quot;%c&quot;, &amp;ch ) do not read the character from console while scanf(&quot; %c&quot;, &amp;ch ) Does", "body": "<p><code>scanf(\"%c\", &amp;ch )</code> do not read the character from console while <code>scanf(\"  %c\", &amp;ch )</code> does, the snipet from code is given under</p>\n\n<pre><code>printf(\"If the value of speed of sound is known enter Y else enter N\");\nscanf(\" %c\", &amp;ch );\n</code></pre>\n"}, {"tags": ["c", "arrays", "pointers"], "comments": [{"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 0, "creation_date": 1516187197, "post_id": 48299005, "comment_id": 83583621, "body": "On your PS: so this is not a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>? I cannot copy your code, save it in a file, and compile it? Even if I paste all these separate pieces together, in order, and add a <code>main</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 319, "user_id": 8764412, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/40269045bb263d31ef71df3051c326b0?s=128&d=identicon&r=PG&f=1", "display_name": "Arduino", "link": "https://stackoverflow.com/users/8764412/arduino"}, "edited": false, "score": 0, "creation_date": 1516187413, "post_id": 48299150, "comment_id": 83583768, "body": "For every string I&#39;m stating their individual length when writing to the bin file (POINTS[i].namelength) if that&#39;s what you mean, would it maybe work better with the &#39;\\0&#39;?"}, {"owner": {"reputation": 3794, "user_id": 7256714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adeb98b0e8995d8576ad5f66c0f982e5?s=128&d=identicon&r=PG&f=1", "display_name": "Pras", "link": "https://stackoverflow.com/users/7256714/pras"}, "reply_to_user": {"reputation": 319, "user_id": 8764412, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/40269045bb263d31ef71df3051c326b0?s=128&d=identicon&r=PG&f=1", "display_name": "Arduino", "link": "https://stackoverflow.com/users/8764412/arduino"}, "edited": false, "score": 0, "creation_date": 1516187782, "post_id": 48299150, "comment_id": 83583994, "body": "I mean writing &quot;5Jordi&quot;, instead of &quot;Jordi&quot; so that you know length of &quot;Jordi&quot; is 5 when you read it back, another option i mentioned is write &#39;\\0&#39; to file,  fwrite(point[i].name, sizeof(char), POINTS[i].namelength+1, fin) should do that if namelength has corect string length, in both the cases you need to parse out each individually when you read them back"}, {"owner": {"reputation": 319, "user_id": 8764412, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/40269045bb263d31ef71df3051c326b0?s=128&d=identicon&r=PG&f=1", "display_name": "Arduino", "link": "https://stackoverflow.com/users/8764412/arduino"}, "edited": false, "score": 0, "creation_date": 1516219207, "post_id": 48299150, "comment_id": 83603638, "body": "Amazing, it worked with fwrite(point[i].name, sizeof(char), POINTS[i].namelength+1, fin)! Thanks a million!"}], "tags": [], "owner": {"reputation": 3794, "user_id": 7256714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adeb98b0e8995d8576ad5f66c0f982e5?s=128&d=identicon&r=PG&f=1", "display_name": "Pras", "link": "https://stackoverflow.com/users/7256714/pras"}, "is_accepted": true, "score": 1, "last_activity_date": 1516185761, "creation_date": 1516185761, "answer_id": 48299150, "question_id": 48299005, "link": "https://stackoverflow.com/questions/48299005/set-pointers-to-a-string-of-char-in-c/48299150#48299150", "title": "Set pointers to a string of char in C", "body": "<p>You are writing variable length strings to files, so when you read it you need to know length of individual string</p>\n\n<p>You may decide to include length string along with the string to write in the file or ensure you write trailing '\\0' to indicate earlier string ends and new one begins from next byte, your reader program will have to parse the strings accordngly</p>\n"}, {"tags": [], "owner": {"reputation": 79, "user_id": 4325033, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-IrZvVflX7Y8/AAAAAAAAAAI/AAAAAAAAAEI/x8jI8vL-5pE/photo.jpg?sz=128", "display_name": "Yi Tang", "link": "https://stackoverflow.com/users/4325033/yi-tang"}, "is_accepted": false, "score": 0, "last_activity_date": 1516185763, "creation_date": 1516185763, "answer_id": 48299151, "question_id": 48299005, "link": "https://stackoverflow.com/questions/48299005/set-pointers-to-a-string-of-char-in-c/48299151#48299151", "title": "Set pointers to a string of char in C", "body": "<blockquote>\n  <p><code>prints</code> the entire array of names</p>\n</blockquote>\n\n<p>Sounds like because you do not tell your program the end of each name, print <code>char *</code> stop when meet a <code>\\0</code> .</p>\n"}], "owner": {"reputation": 319, "user_id": 8764412, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/40269045bb263d31ef71df3051c326b0?s=128&d=identicon&r=PG&f=1", "display_name": "Arduino", "link": "https://stackoverflow.com/users/8764412/arduino"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 48299150, "answer_count": 2, "score": -2, "last_activity_date": 1516185763, "creation_date": 1516185365, "question_id": 48299005, "link": "https://stackoverflow.com/questions/48299005/set-pointers-to-a-string-of-char-in-c", "title": "Set pointers to a string of char in C", "body": "<p>I have an array (POINTS) with a length >20M of the following structure (point) and would like to save it in a binary file to read it afterwards in a different program:</p>\n\n<pre><code>typedef struct {\n  char *name;\n  unsigned char namelength;  \n} point;\n\nif((POINTS = (point *) malloc (N * sizeof(point))) == NULL){        \n    printf(\"when allocating memory for the points vector\\n\");\n    exit(0);\n}\n</code></pre>\n\n<p>What I'm doing is the following; First I'm creating a variable <code>namestot</code> to know how many characters I have in total (some names may be empty):</p>\n\n<pre><code>for (i = 0; i &lt; N; i++) namestot += POINTS[i].namelength;\n</code></pre>\n\n<p>Then I'm writing the array in a file:</p>\n\n<pre><code>if ((fin = fopen(name, \"wb\")) == NULL){\n    printf(\"the output binary data file cannot be open\\n\");\n    exit(0);\n}\n\nfor ( i=0; i &lt; N; i++){\n    if (POINTS[i].namelength){\n        if( fwrite(point[i].name, sizeof(char), POINTS[i].namelength, fin) != POINTS[i].namelength){\n            printf(\"when writing names to the output binary data file\\n\");\n            exit(0);\n        }       \n    }\n}\n</code></pre>\n\n<p>With that I create the file without issues. Now we change to another program with the binary file saved, so we open and read it:</p>\n\n<pre><code>if ((fin = fopen (argv[1], \"r\")) == NULL){\n    printf(\"the data file does not exist or cannot be opened\\n\");\n    exit(0);\n}\n//Here we allocate memory again for the POINTS vector\n    if((POINTS = (point *) malloc (N * sizeof(point))) == NULL){        \n        printf(\"when allocating memory for the points vector\\n\");\n        exit(0);\n    }\n\nif((allnames = (char *) malloc (namestot * sizeof(char))) == NULL){\n    printf(\"when allocating memory for the names vector\");  \n    exit(0);\n}\n\nif (fread(allnames, sizeof(char), namestot, fin) != namestot){\n        printf(\"when reading names from the binary data file\\n\");\n        exit(0);\n    }\n\n//Setting pointers to names\nfor (i = 0; i &lt; N; i++){\n    if(POINTS[i].namelength &gt; 0){\n        POINTS[i].name = allnames; \n        allnames += POINTS[i].namelength;\n    }\n}   \n</code></pre>\n\n<p>However, when I try to read the first non-empty name the program prints the entire array of names, any advice on how to set the pointers to the mesan to have the POINTS array as I had it in the first program? </p>\n\n<p>Thanks!</p>\n\n<p>PS: if there's any non-declared variable I've probably forgot to paste it here, that's not the issue.</p>\n"}, {"tags": ["c++", "c", "llvm"], "comments": [{"owner": {"reputation": 464288, "user_id": 34509, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/7FnYg.jpg?s=128&g=1", "display_name": "Johannes Schaub - litb", "link": "https://stackoverflow.com/users/34509/johannes-schaub-litb"}, "edited": false, "score": 0, "creation_date": 1516188792, "post_id": 48298766, "comment_id": 83584598, "body": "The operand should be an AddInst or something like that. Remember that the insns are equivalent with the value they represent. Perhaps <a href=\"http://llvm.org/doxygen/classllvm_1_1BinaryOperator.html\" rel=\"nofollow noreferrer\">llvm.org/doxygen/classllvm_1_1BinaryOperator.html</a> ?"}, {"owner": {"reputation": 464288, "user_id": 34509, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/7FnYg.jpg?s=128&g=1", "display_name": "Johannes Schaub - litb", "link": "https://stackoverflow.com/users/34509/johannes-schaub-litb"}, "edited": false, "score": 0, "creation_date": 1516189173, "post_id": 48298766, "comment_id": 83584838, "body": "To get the actual leaf int value, you could try a constant propagation transformation (including a preceding mem2reg pass to remove the pointers in favor of registers). But.. I am still not sure what you are trying to accomplish. Do you want to actually run the code, or do you want a static analysis?"}, {"owner": {"reputation": 1175, "user_id": 3341863, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/100000106811779/picture?type=large", "display_name": "Mantas", "link": "https://stackoverflow.com/users/3341863/mantas"}, "reply_to_user": {"reputation": 464288, "user_id": 34509, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/7FnYg.jpg?s=128&g=1", "display_name": "Johannes Schaub - litb", "link": "https://stackoverflow.com/users/34509/johannes-schaub-litb"}, "edited": false, "score": 0, "creation_date": 1516189239, "post_id": 48298766, "comment_id": 83584877, "body": "Is it possible to do a generic solution, not only for binary operator?"}, {"owner": {"reputation": 464288, "user_id": 34509, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/7FnYg.jpg?s=128&g=1", "display_name": "Johannes Schaub - litb", "link": "https://stackoverflow.com/users/34509/johannes-schaub-litb"}, "edited": false, "score": 1, "creation_date": 1516189525, "post_id": 48298766, "comment_id": 83585075, "body": "sounds like you want to actually run the code instead of analysing it? Which means you don&#39;t need to do anything special. Just pass the value operand to the call insns as an argument. And make the parameter of the function a int32_t."}], "answers": [{"comments": [{"owner": {"reputation": 1175, "user_id": 3341863, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/100000106811779/picture?type=large", "display_name": "Mantas", "link": "https://stackoverflow.com/users/3341863/mantas"}, "edited": false, "score": 0, "creation_date": 1516208706, "post_id": 48302166, "comment_id": 83597903, "body": "I did that but got  &quot;Instruction does not dominate all uses!   %3 = load i32, i32* %2, align 4   call void @printLoad(i32 %3) LLVM ERROR: Broken function found, compilation aborted!&quot;"}], "tags": [], "owner": {"reputation": 10317, "user_id": 666785, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/NIzSh.jpg?s=128&g=1", "display_name": "sbabbi", "link": "https://stackoverflow.com/users/666785/sbabbi"}, "is_accepted": true, "score": 6, "last_activity_date": 1516209903, "last_edit_date": 1516209903, "creation_date": 1516195235, "answer_id": 48302166, "question_id": 48298766, "link": "https://stackoverflow.com/questions/48298766/loadinst-and-storeinst-values-and-addresses-llvm/48302166#48302166", "title": "LoadInst and StoreInst Values and addresses LLVM", "body": "<p>Assuming that you have an <code>llvm::Function</code> that represents <code>printLoad()</code> and <code>printStore()</code>:</p>\n\n<pre><code>llvm::Function * print_load = ....\nllvm::Function * print_store = ...\n</code></pre>\n\n<p>You can emit a <code>CallInst</code> for each <code>LoadInst</code> and <code>StoreInst</code>.</p>\n\n<p>For <code>LoadInst</code>:</p>\n\n<pre><code>LoadInst * some_load = ...\nValue * address_of_load = some_load-&gt;getOperand(0);\nValue * print_load_arguments[] = { address_of_load, some_load };\n\n// Insert a CallInst just after the load.\nCallInst::Create(print_load, print_load_arguments )-&gt;insertAfter( some_load );\n</code></pre>\n\n<p>Remember that in llvm the value loaded by the <code>LoadInst</code> is the same thing as the <code>LoadInst</code> itself.</p>\n\n<p>For <code>StoreInst</code>:</p>\n\n<pre><code>StoreInst * some_store = ...\nValue * value_to_store = some_store-&gt;getOperand(0);\nValue * address_of_store = some_store-&gt;getOperand(1);\nValue * print_store_arguments[] = { address_of_store, value_to_store };\n\n// Insert a CallInst just after the store.\nCallInst::Create(print_store, print_store_arguments)-&gt;insertAfter(some_store);\n</code></pre>\n\n<p>This will work if all the types match. Otherwise, you have to insert <code>BitCast</code> instructions just before calling <code>printStore()</code> or <code>printLoad()</code>.</p>\n"}], "owner": {"reputation": 1175, "user_id": 3341863, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/100000106811779/picture?type=large", "display_name": "Mantas", "link": "https://stackoverflow.com/users/3341863/mantas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2373, "favorite_count": 1, "accepted_answer_id": 48302166, "answer_count": 1, "score": 2, "last_activity_date": 1516221578, "creation_date": 1516184672, "last_edit_date": 1516221578, "question_id": 48298766, "link": "https://stackoverflow.com/questions/48298766/loadinst-and-storeinst-values-and-addresses-llvm", "title": "LoadInst and StoreInst Values and addresses LLVM", "body": "<p>I have a file print.c, which has two functions:</p>\n\n<pre><code>void printLoad(...) {\n  // print address and value of memory location from which value\n  printf(\"address=... value=...\", ...); \n}\n\nvoid printStore(...) {\n  // print address and value of memory location from which value \n}\n</code></pre>\n\n<p>I have an LLVM pass which iterates over the instructions and adds CallInst instruction either printLoad or printStore (depending on the instruction type) after the current one (load/store inst).</p>\n\n<p>In order to call this printStore or printLoad I need to add appropriate arguments to CallInst::Create function, which are the address and the value of the memory location.</p>\n\n<p>This is an example of what I want to achieve:</p>\n\n<pre><code>define void @mains() #0 {\n  %1 = alloca i32, align 4\n  %2 = alloca i32, align 4\n  store i32 0, i32* %1, align 4\n  store i32 5, i32* %1, align 4\n  store i32 2, i32* %2, align 4\n  store i32 4, i32* %2, align 4\n  %3 = load i32, i32* %2, align 4\n  %4 = add nsw i32 %3, 5\n  store i32 %4, i32* %1, align 4\n  ret void\n}\n\nThe output should be:\n  store instruction: \n    address=...   // address of %1\n    value=0\n  ...\n  ...\n  ...\n  load instruction:\n    address=...  // address of %2\n    value=4\n  store instruction:\n    address=...  // address of %1\n    value=9\n</code></pre>\n\n<p><strong>Progress so far:</strong></p>\n\n<p>I am able to get the addresses of the operands using getPointerOperand() on LoadInst/StoreInst.</p>\n\n<p>I can also get the value of StoreInst in the first 4 store instructions by casting the operand to ConstantInt, but I don't know how to extract the value in the last StoreInst. Is it even possible?</p>\n\n<p><strong>EDITED:</strong></p>\n\n<p>Using </p>\n\n<pre><code>void printLoad(int32_t p) \n</code></pre>\n\n<p>and</p>\n\n<pre><code>Constant *hookLoadFunc = M.getOrInsertFunction(\"printLoad\", Type::getVoidTy(M.getContext()), Type::getInt32Ty(M.getContext()));\n</code></pre>\n\n<p>.</p>\n\n<pre><code>  %1 = alloca i32, align 4\n  %2 = alloca i32, align 4\n  %3 = alloca i32, align 4\n  store i32 0, i32* %1, align 4\n  call void @printStore(i32 0)\n  store i32 0, i32* %2, align 4\n  call void @printStore(i32 0)\n  store i32 5, i32* %2, align 4\n  call void @printStore(i32 5)\n  store i32 2, i32* %3, align 4\n  call void @printStore(i32 2)\n  store i32 4, i32* %3, align 4\n  call void @printStore(i32 4)\n  %4 = load i32, i32* %3, align 4\n  %5 = add nsw i32 %4, 5\n  store i32 %5, i32* %2, align 4\n  call void @printStore(i32 %5)\n  ret i32 0\n  %2 = alloca i32, align 4\n  store i32 %0, i32* %2, align 4\n  call void @printStore(i32 %0)\n  %3 = load i32, i32* %2, align 4\n  %4 = call i32 (i8*, ...) @printf(i8* getelementptr inbounds ([22 x i8], [22 x i8]* @.str, i32 0, i32 0), i32 %3)\n  ret void\n  %2 = alloca i32, align 4\n  store i32 %0, i32* %2, align 4\n  call void @printStore(i32 %0)\n  %3 = load i32, i32* %2, align 4\n  %4 = call i32 (i8*, ...) @printf(i8* getelementptr inbounds ([22 x i8], [22 x i8]* @.str.1, i32 0, i32 0), i32 %3)\n  ret void\n</code></pre>\n\n<p>This causes Segmentation fault: 11 when run.</p>\n\n<p><strong>SOLVED:</strong></p>\n\n<p>Figured out that I had infinity loop (due to recursion). <strong>printStore</strong> actually uses load/store instructions, thus creating another call to <strong>printStore</strong> and so on.</p>\n"}, {"tags": ["c", "gcc", "shared-libraries"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1516184303, "post_id": 48298594, "comment_id": 83581667, "body": "Somewhat unrelated to your question and problem, but you should really create your object files with <code>-fPIC</code> when building."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1516184351, "post_id": 48298594, "comment_id": 83581700, "body": "Also, if you try to <code>strip</code> the libraries, how does that change the sizes?"}, {"owner": {"reputation": 981, "user_id": 494725, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/mo0IY.jpg?s=128&g=1", "display_name": "Charly", "link": "https://stackoverflow.com/users/494725/charly"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1516184400, "post_id": 48298594, "comment_id": 83581733, "body": "Yes, I just wanted to keep the example simple. I came to the problem, that my rootfs increased from 40Mb to 60Mb and the lines above are just a example to talk about."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 1, "creation_date": 1516184437, "post_id": 48298594, "comment_id": 83581755, "body": "Are you using similar optimization levels for all the runs? Even if the optimization levels are the same, different compilers could be running different individual optimizations, so there is nothing to compare. For this code specifically, you can just look at the generated assembly and manually compare what is different"}, {"owner": {"reputation": 981, "user_id": 494725, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/mo0IY.jpg?s=128&g=1", "display_name": "Charly", "link": "https://stackoverflow.com/users/494725/charly"}, "edited": false, "score": 0, "creation_date": 1516184438, "post_id": 48298594, "comment_id": 83581756, "body": "Stripping makes no difference: 67K to 66K"}, {"owner": {"reputation": 981, "user_id": 494725, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/mo0IY.jpg?s=128&g=1", "display_name": "Charly", "link": "https://stackoverflow.com/users/494725/charly"}, "edited": false, "score": 0, "creation_date": 1516184471, "post_id": 48298594, "comment_id": 83581778, "body": "I compiled the code with -Os: also 67K"}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 1, "creation_date": 1516184540, "post_id": 48298594, "comment_id": 83581822, "body": "@Charly, each compiler has a different definition of <code>-Os</code> (there is a huge difference in the versions of your gcc too). So I wouldn&#39;t be surprised."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1516184587, "post_id": 48298594, "comment_id": 83581854, "body": "If binary size is the only concern for you, you can just chose the compiler that gives you the smallest size. Even a higher version doesn&#39;t necessarily guarantee anything."}, {"owner": {"reputation": 981, "user_id": 494725, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/mo0IY.jpg?s=128&g=1", "display_name": "Charly", "link": "https://stackoverflow.com/users/494725/charly"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1516184780, "post_id": 48298594, "comment_id": 83581995, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/163314/discussion-between-charly-and-ajay-brahmakshatriya\">continue this discussion in chat</a>."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1516185323, "post_id": 48298594, "comment_id": 83582374, "body": "It might be relevant to show which optimizations you have enabled, if any."}, {"owner": {"reputation": 981, "user_id": 494725, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/mo0IY.jpg?s=128&g=1", "display_name": "Charly", "link": "https://stackoverflow.com/users/494725/charly"}, "edited": false, "score": 0, "creation_date": 1516195212, "post_id": 48298594, "comment_id": 83588766, "body": "how do I see, which optimizations are enabled? In the command-line I perform the command as I written above - so without any flags."}], "answers": [{"tags": [], "owner": {"reputation": 981, "user_id": 494725, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/mo0IY.jpg?s=128&g=1", "display_name": "Charly", "link": "https://stackoverflow.com/users/494725/charly"}, "is_accepted": true, "score": 2, "last_activity_date": 1516200539, "creation_date": 1516200539, "answer_id": 48303823, "question_id": 48298594, "link": "https://stackoverflow.com/questions/48298594/size-of-shared-object-files-is-huge/48303823#48303823", "title": "Size of Shared Object files is huge", "body": "<p>from <a href=\"https://stackoverflow.com/questions/47244572/how-to-reduce-elf-section-padding\">How to reduce ELF section padding?</a>:</p>\n\n<blockquote>\n  <p>It looks like this is due to binutils 2.27 increasing the default page size of PowerPC targets to 64k, resulting in bloated binaries on embedded platforms.</p>\n  \n  <p>There's a discussion on the crosstool-NG github here.</p>\n  \n  <p>Configuring binutils with --disable-relro should improve things.</p>\n  \n  <p>You can also add -Wl,-z,max-page-size=0x1000 to gcc when compiling.</p>\n</blockquote>\n\n<p>When adding <code>BR2_BINUTILS_EXTRA_CONFIG_OPTIONS=\"--disable-relro\"</code> to my buildroot configuration, the share object size is reduced.</p>\n"}], "owner": {"reputation": 981, "user_id": 494725, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/mo0IY.jpg?s=128&g=1", "display_name": "Charly", "link": "https://stackoverflow.com/users/494725/charly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 669, "favorite_count": 0, "accepted_answer_id": 48303823, "answer_count": 1, "score": 2, "last_activity_date": 1516200539, "creation_date": 1516184163, "last_edit_date": 1516199914, "question_id": 48298594, "link": "https://stackoverflow.com/questions/48298594/size-of-shared-object-files-is-huge", "title": "Size of Shared Object files is huge", "body": "<p>I compare three compilers:</p>\n\n<ul>\n<li>GCC (x86) from Debian (6.3.0) produces hugo_x86.so with <strong>7.8K</strong>,</li>\n<li>GCC (ppc) from Codesourcery (4.6.0) produces hugo_46.so with <strong>6.6K</strong>,</li>\n<li>GCC (x86) from Buildroot 2017.08 (7.2.0) produces hugo.so with <strong>7.5K</strong>,</li>\n<li>GCC (ppc) from Buildroot 2017.08 (7.2.0) produces hugo.so with <strong>67K</strong>,</li>\n<li>GCC (ppc) from Buildroot 2017.08 (6.4.0) produces hugo.so with <strong>67K</strong> and</li>\n<li>GCC (ppc) from Buildroot 2017.08 (4.9.4) produces hugo.so with <strong>67K</strong></li>\n</ul>\n\n<p>The code was taken from <a href=\"https://eli.thegreenplace.net/2011/08/25/load-time-relocation-of-shared-libraries/\" rel=\"nofollow noreferrer\" title=\"eli.thegreenplace.net\">eli.thegreenplace.net</a>:</p>\n\n<pre><code>int myglob = 42;\n\nint ml_func(int a, int b)\n{\n    myglob += a;\n    return b + myglob;\n}\n</code></pre>\n\n<p>I ve compiled all sources like this:</p>\n\n<pre><code>powerpc-linux-gcc -c -o hugo.o hugo.c\npowerpc-linux-gcc --shared -o hugo.so hugo.o\n</code></pre>\n\n<p>The difference between the files seems to be a padding (<code>hexdump hugo.so | wc -l</code>):</p>\n\n<ul>\n<li>Debian (6.3.0): <strong>381 lines</strong></li>\n<li>Codesourcery (4.6.0): <strong>283 lines</strong></li>\n<li>Buildroot 2017.08 (7.2.0): <strong>298 lines</strong></li>\n<li>Buildroot 2017.08 (6.4.0): <strong>294 lines</strong></li>\n</ul>\n\n<p>(<code>objdump -s</code> shows a similar result)</p>\n\n<p><strong>Questions</strong>:</p>\n\n<ol>\n<li>How can I analyze the difference in the Object file best? (objdump, readelf, etc)</li>\n<li>How can I analyze the difference (e.g. default options) of the compiler best? (e.g. -dumpspecs)</li>\n<li>What could be the reason, for blowing up the shared object? How to increase the file size?</li>\n</ol>\n\n<p>Thanks!</p>\n\n<p>--\n<strong>Edit:</strong>\nIt is also independent of the GCC specs. I ve dumped (<code>-dumpspec</code>) the spec of the Codesourcery (4.6.0) GCC which produces a small shared object, and used it with the Buildroot GCC (<code>-specs</code>) and got again a 67K shared object.</p>\n"}, {"tags": ["c", "pointers", "memory-address"], "comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 3, "creation_date": 1516184027, "post_id": 48298487, "comment_id": 83581522, "body": "Please edit your question and fix code formatting and indention."}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 2, "creation_date": 1516184065, "post_id": 48298487, "comment_id": 83581538, "body": "Please ask only one question at the time."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1516184193, "post_id": 48298487, "comment_id": 83581602, "body": "The pointer returned by the function you show will not be valid, as it points to a local variable inside the function, and that variables life-time ends when the function ends."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1516184475, "post_id": 48298487, "comment_id": 83581781, "body": "Somewhat of topic, but returning the pointer to a local variable is a bad idea, read <a href=\"https://stackoverflow.com/questions/4824342/returning-a-local-variable-from-function-in-c\">this</a>"}], "answers": [{"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 2, "last_activity_date": 1516184203, "creation_date": 1516184203, "answer_id": 48298606, "question_id": 48298487, "link": "https://stackoverflow.com/questions/48298487/type-of-address-and-pointers-in-c/48298606#48298606", "title": "Type of address and pointers in c", "body": "<p>According to the C Standard (6.3.2.3 Pointers)</p>\n\n<blockquote>\n  <p>1 A pointer to void may be converted to or from a pointer to any\n  object type. A pointer to any object type may be converted to a\n  pointer to void and back again; the result shall compare equal to the\n  original pointer.</p>\n</blockquote>\n\n<p>So for example in this code snippet</p>\n\n<pre><code>int x = 10;\nvoid *p = &amp;x;\n</code></pre>\n\n<p>the expression <code>&amp;x</code> in the right side of the assignment has the type <code>int *</code>. According to the quote it may be converted to pointer of the type <code>void *</code> in the left side of the assignment.</p>\n"}, {"tags": [], "owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "is_accepted": false, "score": 0, "last_activity_date": 1516184232, "creation_date": 1516184232, "answer_id": 48298612, "question_id": 48298487, "link": "https://stackoverflow.com/questions/48298487/type-of-address-and-pointers-in-c/48298612#48298612", "title": "Type of address and pointers in c", "body": "<p>1) You are correct\n2) It is simply returning a <code>void *</code> that is pointing to <code>k</code> - a local variable. (Any pointers can be cast to void pointers).</p>\n\n<p>You are correct in saying that you should not use the returned value as <code>k</code> no longer exists</p>\n"}, {"tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 1, "last_activity_date": 1516184461, "creation_date": 1516184461, "answer_id": 48298694, "question_id": 48298487, "link": "https://stackoverflow.com/questions/48298487/type-of-address-and-pointers-in-c/48298694#48298694", "title": "Type of address and pointers in c", "body": "<p>1) Yes all of that is correct.</p>\n\n<p>2) The type of the pointed-at data remains <code>int</code> no matter what kind of pointer that points at it. (This is known as <em>effective type</em> in formal C.) In your example you return a void pointer so that's the type the caller gets. The information of what type it pointed at is lost, from the point you do <code>void *ptr=&amp;k;</code> and onward. This is why void pointers are problematic to use.</p>\n"}], "owner": {"reputation": 31, "user_id": 6660778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16384e8e0856f71ad5078180ca3da147?s=128&d=identicon&r=PG&f=1", "display_name": "Zeroslade", "link": "https://stackoverflow.com/users/6660778/zeroslade"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 247, "favorite_count": 0, "answer_count": 3, "score": -3, "last_activity_date": 1578783437, "creation_date": 1516183866, "last_edit_date": 1578783437, "question_id": 48298487, "link": "https://stackoverflow.com/questions/48298487/type-of-address-and-pointers-in-c", "title": "Type of address and pointers in c", "body": "<p>I have 2 questions about pointers in c.</p>\n\n<p>1) from my understanding the <code>&amp;</code> returns the memory address of a variable. For example:</p>\n\n<pre><code>int x=10;    \nint *p=&amp;x; \n</code></pre>\n\n<p>So I think that the <code>&amp;</code> will return the memory address of <code>x</code> and that memory address is type <code>int*</code> because the variable type of <code>x</code> is <code>int</code>.</p>\n\n<p>Also because the type of the address is  <code>int*</code>  I believe that is the reason that only an <code>int*</code> (and <code>void *</code>) pointer can point in the address (they are the same type).</p>\n\n<p>Any thoughts about that? comments? I don't know if I am correct.</p>\n\n<p>2) It's about the void pointer. I know that the <code>void*</code> pointer can point to any type of variable. For example</p>\n\n<pre><code>int x=10;\nvoid *ptr=&amp;x;   \n</code></pre>\n\n<p>Now I have a function:</p>\n\n<pre><code>void * foo(some parameters)\n{\n  // just for this example let's say that I return the address of a local variable\n\n  // I know that is wrong to do so because when the foo ends\n  // the local variables deallocate\n\n  int k=10;\n  void *ptr=&amp;k;\n  return ptr;    \n}\n</code></pre>\n\n<p>So my pointer is type <code>void</code> but it points to  <code>int*</code> memory address. So <code>ptr</code> will save the address of <code>k</code> and when I return <code>ptr</code> the address of <code>k</code>  is returned which is type <code>int*</code> . But my function is type <code>void*</code>.</p>\n\n<p>What is happening here?</p>\n"}, {"tags": ["c", "prototype", "function-prototypes", "promotions"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1516183284, "post_id": 48298215, "comment_id": 83580991, "body": "You\u2019ve declared <code>impl()</code> but it has no prototype.  You define it using an implicit <code>int</code> argument. That was allowed in C90 (for backwards compatibility) but banned in c99.  The other problems are consequences of these."}, {"owner": {"reputation": 1737, "user_id": 6793085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/59da9fd7490b959c0158e3ee56cf1a50?s=128&d=identicon&r=PG&f=1", "display_name": "godaygo", "link": "https://stackoverflow.com/users/6793085/godaygo"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1516197969, "post_id": 48298215, "comment_id": 83590605, "body": "@JonathanLeffler yes I understand that I define a function with implicit argument, but I can not find the source where it is stated that implicit argument is treated as type <code>int</code>.  Could you give me the link?"}, {"owner": {"reputation": 1737, "user_id": 6793085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/59da9fd7490b959c0158e3ee56cf1a50?s=128&d=identicon&r=PG&f=1", "display_name": "godaygo", "link": "https://stackoverflow.com/users/6793085/godaygo"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1516644188, "post_id": 48298215, "comment_id": 83762809, "body": "This is stated in C89 standard in  Section 3.7.1 under &quot;Semantics&quot; part."}], "answers": [{"tags": [], "owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "is_accepted": false, "score": 1, "last_activity_date": 1516183203, "creation_date": 1516183203, "answer_id": 48298264, "question_id": 48298215, "link": "https://stackoverflow.com/questions/48298215/c-prototype-functions-and-default-argument-promotions-in-c-function-calls/48298264#48298264", "title": "C prototype functions and default argument promotions in C function calls", "body": "<p>This:</p>\n\n<pre><code>void impl(val)\n</code></pre>\n\n<p>doesn't specify the formal type of the <code>val</code> argument. This makes it default to <code>int</code>. This has nothing to do with what kind of value gets passed to the function at run-time, and would be equally true if the function was never called.</p>\n\n<p>Also omitting the type is very old-school and not supported in modern C, I think.</p>\n"}], "owner": {"reputation": 1737, "user_id": 6793085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/59da9fd7490b959c0158e3ee56cf1a50?s=128&d=identicon&r=PG&f=1", "display_name": "godaygo", "link": "https://stackoverflow.com/users/6793085/godaygo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 348, "favorite_count": 0, "closed_date": 1516183282, "answer_count": 1, "score": 0, "last_activity_date": 1516607661, "creation_date": 1516183054, "last_edit_date": 1516607661, "question_id": 48298215, "link": "https://stackoverflow.com/questions/48298215/c-prototype-functions-and-default-argument-promotions-in-c-function-calls", "closed_reason": "Duplicate", "title": "C prototype functions and default argument promotions in C function calls", "body": "<p><strong>EDIT:</strong> Actually this is a duplicate for this question -\n<a href=\"https://stackoverflow.com/questions/13950642/why-does-a-function-with-no-parameters-compared-to-the-actual-function-definiti\">Why does a function with no parameters (compared to the actual function definition) compile?</a></p>\n\n<p>I am a beginner to C and while I understand the need of function prototypes  and the default argument promotion machinery. I also read several \nposts about this topic on SO.</p>\n\n<ol>\n<li><a href=\"https://stackoverflow.com/questions/1255775/default-argument-promotions-in-c-function-calls\">Default argument promotions in C function calls</a></li>\n<li><a href=\"https://stackoverflow.com/questions/4914589/c-prototype-functions\">C prototype functions</a></li>\n</ol>\n\n<p>I am still confused with the obtained warning and final result for this simplified snippet.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid impl();\n\nint main(void)\n{   \n    impl(3.0);\n    return 0;\n}\n\nvoid impl(val)\n{\n    printf(\"%.2f\", val);\n}\n</code></pre>\n\n<p>I get the following warning: <strong><code>format specifies type 'double' but the argument has type 'int' [-Wformat]</code></strong> for this line <strong><code>printf(\"%.2f\", val);</code></strong> </p>\n\n<p>I can not understand why it is supposed by a compiler that <code>val</code> should be treated as <code>int</code> and not to perform default argument promotion. Also I read that if you don't provide argument types:</p>\n\n<blockquote>\n  <p>An ANSI C compiler will assume that you have decided to forego function prototyping, and it will not check arguments.</p>\n</blockquote>\n\n<p>The result which is printed to the console is <strong><code>0.00</code></strong>, but as I understood  the caller will place double on the stack and <code>%f</code> also means double in <code>printf</code> so it reads double off the stack, and the result should not be affected. While this question <a href=\"https://stackoverflow.com/questions/18202232/c-function-with-parameter-without-type-indicator-still-works\">C Function with parameter without type indicator still works?</a> explains some bits, I still do not understand the problem to the end. Also I can't find where it is stated that the argument without a type should be treated by compiler as type <code>int</code>.</p>\n\n<p>I think that I do not understand this part <em>6.5.2.2 \"Function calls\"</em> written in the standard:</p>\n\n<blockquote>\n  <p>If the expression that denotes the called function has a type that does not include a prototype, the integer promotions are performed on each argument, and arguments that have type float are promoted to double. These are called the default argument promotions.</p>\n</blockquote>\n\n<p>Compiled with <code>clang 6.0</code> and <code>--std=c89</code> flag under Windows 10.</p>\n"}, {"tags": ["c", "regex", "grep"], "comments": [{"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 3, "creation_date": 1516183076, "post_id": 48298157, "comment_id": 83580854, "body": "If you bothered to format your code, the opening and closing braces might be a good bet to use in a search &amp; replace type situation"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1516183773, "post_id": 48298157, "comment_id": 83581330, "body": "@ChrisTurner Unless there are compound statements inside the function, which seems kind of likely."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1516183857, "post_id": 48298157, "comment_id": 83581406, "body": "@Lundin but only the function levels start with no spaces/tabs before them :)"}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1516184003, "post_id": 48298157, "comment_id": 83581503, "body": "If you are okay with putting in a bit of effort, clang&#39;s <a href=\"https://clang.llvm.org/docs/LibTooling.html\" rel=\"nofollow noreferrer\">LibTooling</a> is a very nice option."}], "answers": [{"tags": [], "owner": {"reputation": 119, "user_id": 6450641, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/G6pAb.png?s=128&g=1", "display_name": "Irvingz", "link": "https://stackoverflow.com/users/6450641/irvingz"}, "is_accepted": false, "score": 0, "last_activity_date": 1516184326, "creation_date": 1516184326, "answer_id": 48298644, "question_id": 48298157, "link": "https://stackoverflow.com/questions/48298157/how-to-insert-lines-of-text-after-any-c-function-begin-and-before-end-of-functio/48298644#48298644", "title": "How to insert lines of text after any C function begin and before end of function?", "body": "<p>The following regex will select the each void, its name, any parameters and its first opening curly brace. If you match this against your input, you can take it's match index and match length to find the beginning index of the void's inner content. You can then add you're additional content at the index.</p>\n\n<pre><code>(void [\\w_][\\w\\d_]*\\(.*\\)(\\r|)(\\n|){)\n</code></pre>\n\n<p>Feel free to play around with it here: <a href=\"https://regexr.com/3jarc\" rel=\"nofollow noreferrer\">https://regexr.com/3jarc</a></p>\n\n<p>To get the end of the function, you could use the regex above as a positive lookbehind then match the closing '}'.</p>\n"}, {"comments": [{"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1516186549, "post_id": 48298911, "comment_id": 83583212, "body": "That&#39;d also match structs (for example)"}, {"owner": {"reputation": 2244, "user_id": 5520680, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/C1jQH.png?s=128&g=1", "display_name": "Tom&#39;s", "link": "https://stackoverflow.com/users/5520680/toms"}, "reply_to_user": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1516194643, "post_id": 48298911, "comment_id": 83588369, "body": "Ah, that&#39;s rigth, i forgot that (and enum, and union, etc etc). So, maybe, have a buffer that retain the &quot;line&quot; that is just before the first &#39;{&#39; and parse it to know if this is a function. (I know it&#39;s not juste the previous &quot;line&quot;, because it can be on multiple line, but that&#39;s the idea). Or more simplier : You modify the source code with the bracket counter, and after you fix the bad struct/enum/union (must give critical error). If there is hundred function, there probably shouldn&#39;t be many struct/enum/union in a .c"}], "tags": [], "owner": {"reputation": 2244, "user_id": 5520680, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/C1jQH.png?s=128&g=1", "display_name": "Tom&#39;s", "link": "https://stackoverflow.com/users/5520680/toms"}, "is_accepted": false, "score": 0, "last_activity_date": 1516185068, "creation_date": 1516185068, "answer_id": 48298911, "question_id": 48298157, "link": "https://stackoverflow.com/questions/48298157/how-to-insert-lines-of-text-after-any-c-function-begin-and-before-end-of-functio/48298911#48298911", "title": "How to insert lines of text after any C function begin and before end of function?", "body": "<p>What about a brace counter ?</p>\n\n<p>you open your source code file, and you read char by char.\nEach time you have '{', you increment the brace_counter, and each time you have '}', you decremente it.</p>\n\n<p>If you found a '{' and the counter is 0 before incrementation, you have the beginning of your function.\nIf you found a '}' and the counteur is 0 after decrementation, you have the end of your function.</p>\n\n<p>Could this work ? Or there are tricky C syntax that can broke that down ?</p>\n"}], "owner": {"reputation": 29, "user_id": 8609276, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0be5433149e6363d4759792f11cb052c?s=128&d=identicon&r=PG&f=1", "display_name": "Sergeant", "link": "https://stackoverflow.com/users/8609276/sergeant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1516185068, "creation_date": 1516182907, "last_edit_date": 1516183948, "question_id": 48298157, "link": "https://stackoverflow.com/questions/48298157/how-to-insert-lines-of-text-after-any-c-function-begin-and-before-end-of-functio", "title": "How to insert lines of text after any C function begin and before end of function?", "body": "<p>I have hundred of C-functions like</p>\n\n<pre><code>void test()\n{\n    &lt;content of function&gt;\n}\n</code></pre>\n\n<p>(Functions may have a return value <code>UBYTE</code>, <code>BOOL</code>, <code>WORD</code>, ...)</p>\n\n<p>Now I would like to add a text to all functions as follows:</p>\n\n<pre><code>void test()\n{\n    LABEEL_BEGIN\n    &lt;blank line&gt;\n    &lt;content of function&gt;\n    &lt;blank line&gt;\n    LABEL_END\n}\n</code></pre>\n\n<p>So  I need to insert <code>LABEL_BEGIN</code> and a blank line at the start of the function and a blank line and <code>LABEL_END</code> at end of the function.</p>\n\n<p>I assume that this might be possible with some ticky regex!? Or is there a Text Editor available which has such a feature? Currently, I have MS Studio 2013 IDE, Notapad++, Textpad, PSpad available and also the GNU grep 2.4.5 command line tool.</p>\n"}, {"tags": ["c", "string", "pointers"], "comments": [{"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1516180157, "post_id": 48297212, "comment_id": 83579083, "body": "Not exact dupe, but same problem: <a href=\"https://stackoverflow.com/q/39486797/694733\">stackoverflow.com/q/39486797/694733</a>"}], "answers": [{"comments": [{"owner": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 0, "creation_date": 1516181033, "post_id": 48297268, "comment_id": 83579623, "body": "<code>return_string = &amp;tmp;</code> should be <code>*return_string = tmp;</code>"}, {"owner": {"reputation": 19910, "user_id": 8012646, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/T8yOZ.png?s=128&g=1", "display_name": "\u30ed\u30fc\u30a6", "link": "https://stackoverflow.com/users/8012646/%e3%83%ad%e3%83%bc%e3%82%a6"}, "reply_to_user": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 0, "creation_date": 1516181296, "post_id": 48297268, "comment_id": 83579774, "body": "@mch <code>tmp</code> has automatic storage duration, so it does not exist after leaving the function. It didn&#39;t make sense at all."}, {"owner": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 0, "creation_date": 1516181422, "post_id": 48297268, "comment_id": 83579851, "body": "<code>*return_string = tmp;</code> is okay, if <code>tmp</code> points to a string literal. Using <code>&amp;tmp</code> is dangerous."}, {"owner": {"reputation": 2975, "user_id": 5559342, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/39185a39d1b8b29d0b51564f7d55164e?s=128&d=identicon&r=PG&f=1", "display_name": "Robb1", "link": "https://stackoverflow.com/users/5559342/robb1"}, "edited": false, "score": 0, "creation_date": 1516182455, "post_id": 48297268, "comment_id": 83580461, "body": "If I&#39;m passing the pointer by reference should I call <code>foo</code> in such a way? <code>char *s = &quot;old string&quot;; foo(&amp;s); printf(&quot;%s\\n&quot;, s);</code>"}, {"owner": {"reputation": 19910, "user_id": 8012646, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/T8yOZ.png?s=128&g=1", "display_name": "\u30ed\u30fc\u30a6", "link": "https://stackoverflow.com/users/8012646/%e3%83%ad%e3%83%bc%e3%82%a6"}, "edited": false, "score": 0, "creation_date": 1516182513, "post_id": 48297268, "comment_id": 83580499, "body": "Yes, in order to pass the pointer <code>s</code> by reference, use <code>foo(&amp;s)</code> (i.e.: pass the address of the pointer)."}], "tags": [], "owner": {"reputation": 19910, "user_id": 8012646, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/T8yOZ.png?s=128&g=1", "display_name": "\u30ed\u30fc\u30a6", "link": "https://stackoverflow.com/users/8012646/%e3%83%ad%e3%83%bc%e3%82%a6"}, "is_accepted": true, "score": 1, "last_activity_date": 1516181497, "last_edit_date": 1516181497, "creation_date": 1516180067, "answer_id": 48297268, "question_id": 48297212, "link": "https://stackoverflow.com/questions/48297212/modifying-a-string-being-passed-as-argument-of-a-function-in-c/48297268#48297268", "title": "Modifying a string being passed as argument of a function in C", "body": "<h3>The problem</h3>\n\n<p>In the function <code>foo()</code>:</p>\n\n<pre><code>int foo(char *return_string) {\n    char *tmp = \"new string\";\n    return_string = tmp;\n    return 0;\n}\n</code></pre>\n\n<p>You are just assigning the pointer <code>tmp</code> to the pointer <code>return_string</code>. The parameter <code>retrun_string</code> is passed by value to <code>foo()</code> (i.e.: it is a copy of what the caller passed). Neither what <code>return_string</code> is pointing to is being modified (which may be what you want) nor the pointer passed is keeps the modification at the caller's side.</p>\n\n<hr>\n\n<h3><code>strcpy()</code></h3>\n\n<p>Consider using <code>strcpy()</code> instead:</p>\n\n<pre><code>int foo(char *return_string) {\n    char *tmp = \"new string\";\n    strcpy(return_string, tmp);\n    return 0;\n}\n</code></pre>\n\n<p>This will modify the contents of the string pointed by <code>return_string</code>.</p>\n\n<hr>\n\n<h3>Passing the pointer by reference</h3>\n\n<p>Passing the pointer by reference, will make possible the modification of the pointer pointing to the string:</p>\n\n<pre><code>int foo(char **return_string) {\n    char *tmp = \"new string\";\n    *return_string = tmp;\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5101, "user_id": 700170, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gZ8hw.png?s=128&g=1", "display_name": "Morten Jensen", "link": "https://stackoverflow.com/users/700170/morten-jensen"}, "is_accepted": false, "score": 0, "last_activity_date": 1516180091, "creation_date": 1516180091, "answer_id": 48297280, "question_id": 48297212, "link": "https://stackoverflow.com/questions/48297212/modifying-a-string-being-passed-as-argument-of-a-function-in-c/48297280#48297280", "title": "Modifying a string being passed as argument of a function in C", "body": "<p>You are passing the pointer by value. You need to pass the pointer by reference.</p>\n\n<p>Change the function interface to pass a <code>char** return_string</code> instead of a <code>char* return_string</code>.\nAnd then do <code>*return_string = tmp;</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1516180391, "post_id": 48297321, "comment_id": 83579203, "body": "nothing guarantees that the argument is dynamically allocated."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1516182057, "post_id": 48297321, "comment_id": 83580239, "body": "try <code>char *test=&quot;hello&quot;; foo(&amp;hello);</code> =&gt; BANG! the caller is responsible for the memory leak when passing a pointer on a pointer."}, {"owner": {"reputation": 2360, "user_id": 4819357, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-M-St3cpKcOs/AAAAAAAAAAI/AAAAAAAAAIg/HqtjEfI3EFE/photo.jpg?sz=128", "display_name": "AndreyS Scherbakov", "link": "https://stackoverflow.com/users/4819357/andreys-scherbakov"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1516182462, "post_id": 48297321, "comment_id": 83580465, "body": "Yes of course. You will need some agreement on how do you allocate your strings. If you use dynamic allocation, it&#39;s the most universal solution (you will need to avoid storing constants, but it&#39;s not the worst restriction. Say, when you use strcpy - based approach, you&#39;ll need to worry about buffer size. All options have their drawbacks. The best solution might be your own string container with an explicit deallocator pointer.. but it&#39;s probably beyond the scope of the question in hand."}], "tags": [], "owner": {"reputation": 2360, "user_id": 4819357, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-M-St3cpKcOs/AAAAAAAAAAI/AAAAAAAAAIg/HqtjEfI3EFE/photo.jpg?sz=128", "display_name": "AndreyS Scherbakov", "link": "https://stackoverflow.com/users/4819357/andreys-scherbakov"}, "is_accepted": false, "score": 0, "last_activity_date": 1516180196, "creation_date": 1516180196, "answer_id": 48297321, "question_id": 48297212, "link": "https://stackoverflow.com/questions/48297212/modifying-a-string-being-passed-as-argument-of-a-function-in-c/48297321#48297321", "title": "Modifying a string being passed as argument of a function in C", "body": "<p>Provided that your strings are dynamically allocated, it might be implemented as follows</p>\n\n<pre><code>int foo(char **return_string) {\n    if (*return string) free(*return_string)\n    *return_string = strdup(\"new string\");\n    return 0;\n}\n\nchar* s = strdup(\"original\");\nfoo(&amp;s);\n....\n</code></pre>\n"}], "owner": {"reputation": 2975, "user_id": 5559342, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/39185a39d1b8b29d0b51564f7d55164e?s=128&d=identicon&r=PG&f=1", "display_name": "Robb1", "link": "https://stackoverflow.com/users/5559342/robb1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1649, "favorite_count": 0, "closed_date": 1516182075, "accepted_answer_id": 48297268, "answer_count": 3, "score": 0, "last_activity_date": 1516181497, "creation_date": 1516179843, "question_id": 48297212, "link": "https://stackoverflow.com/questions/48297212/modifying-a-string-being-passed-as-argument-of-a-function-in-c", "closed_reason": "Duplicate", "title": "Modifying a string being passed as argument of a function in C", "body": "<p>How can I <strong>modify</strong> the value of a string <strong>being passed as argument</strong> in a function?</p>\n\n<p>For example I have this function <code>foo</code> (that is supposed to change the value of <code>return_string</code> from <code>\"old string\"</code> to <code>\"new string\"</code>):</p>\n\n<pre><code>int foo(char *return_string) {\n    char *tmp = \"new string\";\n    return_string = tmp;\n    return 0;\n}\n</code></pre>\n\n<p>But if I call it in the following way:</p>\n\n<pre><code>char *s = \"old string\";\nfoo(s);\nprintf(\"%s\\n\", s);\n</code></pre>\n\n<p>I still get <code>old string</code> as output. Why?</p>\n\n<p>I admit I have a little of confusion with pointers and strings in C.</p>\n"}, {"tags": ["c", "libgit2"], "comments": [{"owner": {"reputation": 63488, "user_id": 729881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fdfaf0aad74fef442e2ffc9999ef9c1?s=128&d=identicon&r=PG", "display_name": "Edward Thomson", "link": "https://stackoverflow.com/users/729881/edward-thomson"}, "edited": false, "score": 0, "creation_date": 1516186089, "post_id": 48296823, "comment_id": 83582895, "body": "No, this is nothing to worry about.  VSTS is trying to be helpful, but has (incorrectly) decided that you&#39;re running an older version of the Git command-line client.  I&#39;ll follow up with the VSTS Server team and try to get this resolved."}], "answers": [{"tags": [], "owner": {"reputation": 63488, "user_id": 729881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fdfaf0aad74fef442e2ffc9999ef9c1?s=128&d=identicon&r=PG", "display_name": "Edward Thomson", "link": "https://stackoverflow.com/users/729881/edward-thomson"}, "is_accepted": true, "score": 2, "last_activity_date": 1516187572, "creation_date": 1516187572, "answer_id": 48299758, "question_id": 48296823, "link": "https://stackoverflow.com/questions/48296823/visualstudio-com-thinks-latest-libgit2-is-old/48299758#48299758", "title": "visualstudio.com thinks latest libgit2 is old", "body": "<p>No - there's nothing to worry about here.  VSTS is trying to be helpful by looking at the version of Git that you're running and suggesting that you upgrade if you're running something outdated.</p>\n\n<p>libgit2 <a href=\"https://github.com/libgit2/libgit2/pull/4041\" rel=\"nofollow noreferrer\">has to send a Git version string as part of its user agent</a>, pretending to be Git itself, because some hosting providers[1] are \"over enthusiastic\" about looking at the user agent[2] and if they don't see a <code>git/</code> prefix at the start, will assume that you're a web browser and redirect you to their home page.</p>\n\n<p>This is much the same way that every graphical web browser claims to be <code>Mozilla</code>.  \ud83d\ude22</p>\n\n<p>In this case, though, VSTS needs to be smart enough to recognize that libgit2-based clients should not follow the same matching rules as Git itself.</p>\n\n<p>There's nothing that you can do to change this behavior in your client.  You <em>can</em> change the user agent string that's sent with your requests, but libgit2 will always prefix it with <code>git/2.0</code> (to save you from those aforementioned hosting providers.)  For example, if you:</p>\n\n<pre><code>git_libgit2_opts(GIT_OPT_SET_USER_AGENT, \"MyAwesomeGitClient/32.14\");\n</code></pre>\n\n<p>Then the actual user-agent will be sent as:</p>\n\n<pre><code>git/2.0 MyAwesomeGitClient/32.14\n</code></pre>\n\n<p>But I don't recommend this, since there's no need to make any changes.  It's clear that VSTS is incorrect here, and I'll ask the VSTS Git Server team to investigate.</p>\n\n<hr>\n\n<p>[1] Not Visual Studio Team Services.</p>\n\n<p>[2] I say that this hosting provider is \"over enthusiastic\", but that's rather polite.  There are specific endpoints that Git hits when it fetches and pushes, and they shouldn't need to be protected by a user agent match.  This sort of behavior is the kind of thing that gives us endless hack upon endless hack, like all libgit2 clients pretending to be <code>git/2.0</code> and Safari pretending to be <code>Mozilla</code>.</p>\n\n<p>We should do better.</p>\n"}], "owner": {"reputation": 275, "user_id": 507287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2d924d81f69ced6b6d65e6dab0951d1?s=128&d=identicon&r=PG", "display_name": "palmin", "link": "https://stackoverflow.com/users/507287/palmin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 387, "favorite_count": 0, "accepted_answer_id": 48299758, "answer_count": 1, "score": 2, "last_activity_date": 1516187572, "creation_date": 1516178411, "last_edit_date": 1516178739, "question_id": 48296823, "link": "https://stackoverflow.com/questions/48296823/visualstudio-com-thinks-latest-libgit2-is-old", "title": "visualstudio.com thinks latest libgit2 is old", "body": "<p>When cloning or fetching from visualstudio.com I get a sideband message that \"you're using an older version of Git\".</p>\n\n<p>This happens with libgit2 commit <a href=\"https://github.com/libgit2/libgit2/commit/f1323d9c161aeeada190fd9615a8b5a9fb8a7f3e\" rel=\"nofollow noreferrer\">f1323d9</a> that is from January 10.</p>\n\n<p>Is there anything I can do about this and is this anything I should worry about?</p>\n\n<p>It can be replicated with something like</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;git2.h&gt;\n\nstatic int cred_acquire_cb(git_cred **cred, const char *url, \n                           const char *username_from_url,\n                           unsigned int allowed_types, void *payload) {\n  return git_cred_userpass_plaintext_new(cred, \"email@address.com\", \"token\");\n}\n\nstatic int sideband_progress_cb(const char *str, int len, void *payload) {\n   printf(\"%s\", str);\n   return 0;\n}\n\nint main() {\n   git_libgit2_init();\n\n   git_clone_options clone_options = GIT_CLONE_OPTIONS_INIT;\n   clone_options.fetch_opts.callbacks.credentials = cred_acquire_cb;\n   clone_options.fetch_opts.callbacks.sideband_progress = sideband_progress_cb;\n\n   git_repository *repo = NULL;\n   const char *url = \"https://account.visualstudio.com/project/_git/repo\";\n   const char *path = \"repo\";\n   int error = git_clone(&amp;repo, url, path, &amp;clone_options);\n   if(error &lt; 0) {\n      fprintf(stderr, \"error = %d, %s\\n\", error, giterr_last()-&gt;message);       \n   }\n\n   return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "makefile"], "comments": [{"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 3, "creation_date": 1516179125, "post_id": 48296804, "comment_id": 83578464, "body": "&quot;It does not work&quot; is not a proper way to describe a problem"}, {"owner": {"reputation": 33, "user_id": 2377144, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/acbb7a4d775d8992b76146369c1cf8ff?s=128&d=identicon&r=PG", "display_name": "Jones", "link": "https://stackoverflow.com/users/2377144/jones"}, "reply_to_user": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1516179394, "post_id": 48296804, "comment_id": 83578638, "body": "Apologise about that. I am doing something wrong and I dont know what. Any help?"}, {"owner": {"reputation": 33, "user_id": 2377144, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/acbb7a4d775d8992b76146369c1cf8ff?s=128&d=identicon&r=PG", "display_name": "Jones", "link": "https://stackoverflow.com/users/2377144/jones"}, "reply_to_user": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1516179825, "post_id": 48296804, "comment_id": 83578884, "body": "Thanks. Just updated."}, {"owner": {"reputation": 4826, "user_id": 193789, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/a17cc57e47435930a48f7c80bcd53863?s=128&d=identicon&r=PG", "display_name": "kebs", "link": "https://stackoverflow.com/users/193789/kebs"}, "edited": false, "score": 1, "creation_date": 1516182498, "post_id": 48296804, "comment_id": 83580486, "body": "Your makefile shows a lot of irrelevant things. But the strangest is how you define the object files ! : you hardcode them, instead of generating them automatically from source files. Checkout the <code>patsubst</code> make function."}, {"owner": {"reputation": 4826, "user_id": 193789, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/a17cc57e47435930a48f7c80bcd53863?s=128&d=identicon&r=PG", "display_name": "kebs", "link": "https://stackoverflow.com/users/193789/kebs"}, "edited": false, "score": 0, "creation_date": 1516182815, "post_id": 48296804, "comment_id": 83580683, "body": "Are you sure about the error message ? Sounds odd to me..."}, {"owner": {"reputation": 33, "user_id": 2377144, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/acbb7a4d775d8992b76146369c1cf8ff?s=128&d=identicon&r=PG", "display_name": "Jones", "link": "https://stackoverflow.com/users/2377144/jones"}, "edited": false, "score": 0, "creation_date": 1516183151, "post_id": 48296804, "comment_id": 83580908, "body": "Honestly it is not my makefile. If it was I would understand everything there and be able to add it."}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 1, "creation_date": 1516203921, "post_id": 48296804, "comment_id": 83594792, "body": "You need to understand that <code>Makefile</code>.  Perhaps using <a href=\"http://bashdb.sourceforge.net/remake/\" rel=\"nofollow noreferrer\">remake</a> with <code>-x</code>  could help. Or at least <code>make --trace</code>. Take time to read the <a href=\"https://www.gnu.org/software/make/manual/html_node/index.html\" rel=\"nofollow noreferrer\">documentation of GNU <code>make</code></a>. And that <code>makefile</code> is not that complex. If you prefer, rewrite it from scratch (or switch to some other <a href=\"https://en.wikipedia.org/wiki/Build_automation\" rel=\"nofollow noreferrer\">build automation</a> tool, perhaps <a href=\"http://ninja-build.org/\" rel=\"nofollow noreferrer\">ninja</a>...). Be sure to understand how to <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Invoking-GCC.html\" rel=\"nofollow noreferrer\">invoke GCC</a>"}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 2377144, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/acbb7a4d775d8992b76146369c1cf8ff?s=128&d=identicon&r=PG", "display_name": "Jones", "link": "https://stackoverflow.com/users/2377144/jones"}, "edited": false, "score": 0, "creation_date": 1516183530, "post_id": 48298107, "comment_id": 83581160, "body": "still gives me no rule to target obj/test.cpp. It does not make sense since test.cpp is in examples/."}], "tags": [], "owner": {"reputation": 4826, "user_id": 193789, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/a17cc57e47435930a48f7c80bcd53863?s=128&d=identicon&r=PG", "display_name": "kebs", "link": "https://stackoverflow.com/users/193789/kebs"}, "is_accepted": false, "score": 1, "last_activity_date": 1516207785, "last_edit_date": 1516207785, "creation_date": 1516182752, "answer_id": 48298107, "question_id": 48296804, "link": "https://stackoverflow.com/questions/48296804/adding-c-to-complex-c-makefile/48298107#48298107", "title": "Adding c++ to complex C makefile", "body": "<p>I think you need a recipe to compile object files from <code>.cpp</code> file:</p>\n\n<pre><code>$(OBJDIR)%.o: %.cpp $(DEPS)\n    $(CXX) $(COMMON) $(CFLAGS) -c $&lt; -o $@\n</code></pre>\n\n<p>The error you describe probably comes from an incorrect usage of <code>vpath</code>: I don't think its usage is necessary here.</p>\n\n<p>But basically I agree with @Basile Starynkevitch : you might be better rewriting from scratch. I have a few suggestions:</p>\n\n<p>1 - Clearly separate in different folders <strong>programs</strong> (C or C++ files that hold a <code>main()</code> function) and <strong>library</strong> files (C or C++ files that hold functions). This will be useful for linking.</p>\n\n<p>For example:</p>\n\n<pre><code>|\n+--lib   // holds \"library\" code\n+--app   // holds programs\n+--headers\n+--BUILD\n    |\n    +-- obj\n    |    |\n    |    +-- app\n    |    +-- lib\n    |\n    +-- bin\n</code></pre>\n\n<p>2 - Automatically generate both object files and programs from source files:</p>\n\n<pre><code>SRC_FILES_LIB = $(wildcard lib/*.cpp)\nSRC_FILES_APP = $(wildcard app/*.cpp)\nOBJ_FILES_LIB = $(patsubst lib/%.cpp,BUILD/obj/lib/%.o,$(SRC_FILES_LIB))\nOBJ_FILES_APP = $(patsubst app/%.cpp,BUILD/obj/app/%.o,$(SRC_FILES_APP))\nEXEC_FILES    = $(patsubst app/%.cpp,BUILD/bin/%,$(SRC_FILES_APP))\n</code></pre>\n\n<p>3 - add a target that builds the programs:</p>\n\n<pre><code>all:  $(EXEC_FILES)\n    @echo \"done\"\n</code></pre>\n\n<p>After that, its just a matter of providing the sufficient pattern rule.\n(sorry, no more time for that)</p>\n"}], "owner": {"reputation": 33, "user_id": 2377144, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/acbb7a4d775d8992b76146369c1cf8ff?s=128&d=identicon&r=PG", "display_name": "Jones", "link": "https://stackoverflow.com/users/2377144/jones"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 268, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1516207785, "creation_date": 1516178344, "last_edit_date": 1516179811, "question_id": 48296804, "link": "https://stackoverflow.com/questions/48296804/adding-c-to-complex-c-makefile", "title": "Adding c++ to complex C makefile", "body": "<p>I would like to add a cpp file to use the c functions. I made the file but the problem becomes how to include the file in the makefile.All I know is that I should compile with c++ after C. and then link it together.</p>\n\n<p>May someone point me in the right direction.</p>\n\n<p>This is a snippet of testcpp.cpp</p>\n\n<pre><code>    extern \"C\" {\n  #include \"darknet.h\"\n}\n</code></pre>\n\n<p>Below is the makefile but i keep getting No rule to make target 'obj/test.cpp', needed by 'darknet'.</p>\n\n<pre><code>    GPU=0\nCUDNN=0\nOPENCV=0\nNNPACK=1\nNNPACK_FAST=1\nARM_NEON=1\nOPENMP=0\nDEBUG=0\nQPU_GEMM=1\n\nARCH= -gencode arch=compute_30,code=sm_30 \\\n      -gencode arch=compute_35,code=sm_35 \\\n      -gencode arch=compute_50,code=[sm_50,compute_50] \\\n      -gencode arch=compute_52,code=[sm_52,compute_52]\n#      -gencode arch=compute_20,code=[sm_20,sm_21] \\ This one is deprecated?\n\n# This is what I use, uncomment if you know your arch and want to specify\n# ARCH= -gencode arch=compute_52,code=compute_52\n\nVPATH=./src/:./examples\nSLIB=libdarknet.so\nALIB=libdarknet.a\nEXEC=darknet\nOBJDIR=./obj/\n\nCC=gcc\nNVCC=nvcc \nAR=ar\nARFLAGS=rcs\nOPTS=-Ofast\nLDFLAGS= -lm -pthread \nCOMMON= -Iinclude/ -Isrc/\n#CFLAGS=-Wall -Wno-unknown-pragmas -Wfatal-errors -fPIC\n#CFLAGS=-Wall -Wno-unknown-pragmas -Wfatal-errors -fPIC -march=native -mfpmath=sse\nCFLAGS=-Wall -Wno-unknown-pragmas -Wfatal-errors -fPIC -mcpu=cortex-a53\n\n\nifeq ($(OPENMP), 1) \nCFLAGS+= -fopenmp\nendif\n\nifeq ($(DEBUG), 1) \nOPTS=-O0 -g\nendif\n\nCFLAGS+=$(OPTS)\n\nifeq ($(OPENCV), 1) \nCOMMON+= -DOPENCV\nCFLAGS+= -DOPENCV\nLDFLAGS+= `pkg-config --libs opencv` \nCOMMON+= `pkg-config --cflags opencv` \nendif\n\nifeq ($(GPU), 1) \nCOMMON+= -DGPU -I/usr/local/cuda/include/\nCFLAGS+= -DGPU\nLDFLAGS+= -L/usr/local/cuda/lib64 -lcuda -lcudart -lcublas -lcurand\nendif\n\nifeq ($(CUDNN), 1) \nCOMMON+= -DCUDNN \nCFLAGS+= -DCUDNN\nLDFLAGS+= -lcudnn\nendif\n\nifeq ($(QPU_GEMM), 1) \nCOMMON+= -DQPU_GEMM\nCFLAGS+= -DQPU_GEMM\nLDFLAGS+= -lqmkl\nendif\n\nifeq ($(NNPACK), 1)\nCOMMON+= -DNNPACK\nCFLAGS+= -DNNPACK\nLDFLAGS+= -lnnpack -lpthreadpool\nendif\n\nifeq ($(NNPACK_FAST), 1)\nCOMMON+= -DNNPACK_FAST\nCFLAGS+= -DNNPACK_FAST\nendif\n\nifeq ($(ARM_NEON), 1)\nCOMMON+= -DARM_NEON\nCFLAGS+= -DARM_NEON -mfpu=neon-vfpv4 -funsafe-math-optimizations -ftree-vectorize\nendif\n\nOBJ=gemm.o utils.o cuda.o deconvolutional_layer.o convolutional_layer.o list.o image.o activations.o im2col.o col2im.o blas.o crop_layer.o dropout_layer.o maxpool_layer.o softmax_layer.o data.o matrix.o network.o connected_layer.o cost_layer.o parser.o option_list.o detection_layer.o route_layer.o box.o normalization_layer.o avgpool_layer.o layer.o local_layer.o shortcut_layer.o activation_layer.o rnn_layer.o gru_layer.o crnn_layer.o demo.o batchnorm_layer.o region_layer.o reorg_layer.o tree.o  lstm_layer.o\nEXECOBJA=captcha.o lsd.o super.o art.o tag.o cifar.o go.o rnn.o segmenter.o regressor.o classifier.o coco.o yolo.o detector.o nightmare.o attention.o darknet.o\nEXECOBJA1=testcpp.cpp\nifeq ($(GPU), 1) \nLDFLAGS+= -lstdc++ \nOBJ+=convolutional_kernels.o deconvolutional_kernels.o activation_kernels.o im2col_kernels.o col2im_kernels.o blas_kernels.o crop_layer_kernels.o dropout_layer_kernels.o maxpool_layer_kernels.o avgpool_layer_kernels.o\nendif\n\nEXECOBJ = $(addprefix $(OBJDIR), $(EXECOBJA))\nEXECOBJ1 = $(addprefix $(OBJDIR), $(EXECOBJA1))\nOBJS = $(addprefix $(OBJDIR), $(OBJ))\nDEPS = $(wildcard src/*.h) Makefile include/darknet.h\nCPP=g++\n#all: obj backup results $(SLIB) $(ALIB) $(EXEC)\nall: obj  results $(SLIB) $(ALIB) $(EXEC)\n\n\n$(EXEC): $(EXECOBJ) $(ALIB)\n    $(CC) $(COMMON) $(CFLAGS) $^ -o $@ $(LDFLAGS) $(ALIB)\n\n$(EXEC): $(EXECOBJ1)\n    $(CPP) -Wall $^ -o $@ $(LDFLAGS)\n\n$(ALIB): $(OBJS)\n    $(AR) $(ARFLAGS) $@ $^\n\n$(SLIB): $(OBJS)\n    $(CPP) $(CFLAGS) -shared $^ -o $@\n\n$(OBJDIR)%.o: %.c $(DEPS)\n    $(CC) $(COMMON) $(CFLAGS) -c $&lt; -o $@\n\n$(OBJDIR)%.o: %.cu $(DEPS)\n    $(NVCC) $(ARCH) $(COMMON) --compiler-options \"$(CFLAGS)\" -c $&lt; -o $@\n\nobj:\n    mkdir -p obj\nbackup:\n    mkdir -p backup\nresults:\n    mkdir -p results\n\n.PHONY: clean\n\nclean:\n    rm -rf $(OBJS) $(SLIB) $(ALIB) $(EXEC) $(EXECOBJ)\n</code></pre>\n\n<p>I thought\n <code>$(EXEC): $(EXECOBJ1)\n    $(CPP) -Wall $^ -o $@ $(LDFLAGS)</code>\nwould compile the cpp file and </p>\n\n<pre><code>$(OBJDIR)%.o: %.c $(DEPS)\n$(CC) $(COMMON) $(CFLAGS) -c $&lt; -o $@\n</code></pre>\n\n<p>would link it</p>\n"}, {"tags": ["c++", "c", "linear-algebra"], "comments": [{"owner": {"reputation": 504, "user_id": 5097473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c46c48a9d610a31cc11fd8a3cf1aac9?s=128&d=identicon&r=PG", "display_name": "Vel", "link": "https://stackoverflow.com/users/5097473/vel"}, "edited": false, "score": 3, "creation_date": 1516177160, "post_id": 48296404, "comment_id": 83577395, "body": "please fix it to be readable"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1516177253, "post_id": 48296404, "comment_id": 83577439, "body": "There are so many blank lines that they make the code unreadable.  Some blank lines are good.  Too many as as bad as too few."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1516177338, "post_id": 48296404, "comment_id": 83577479, "body": "What a load of rubbish. Don&#39;t try to build your own linear algebra library. Use BLAS or similar, BLAS is part of the Boost C++ distribution."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1516177400, "post_id": 48296404, "comment_id": 83577512, "body": "Also, are you referring to an &#39;adjoint matrix&#39; or an &#39;adjugate matrix&#39; (or some other type of matrix)?  Neither &#39;adjunt&#39; nor &#39;adjucate&#39; is quite right in English, but I&#39;m not sure what you&#39;re thinking of."}, {"owner": {"reputation": 2397, "user_id": 9038475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b7f74f49de917e716f4d679473e70f4?s=128&d=identicon&r=PG&f=1", "display_name": "Geshode", "link": "https://stackoverflow.com/users/9038475/geshode"}, "edited": false, "score": 1, "creation_date": 1516177871, "post_id": 48296404, "comment_id": 83577779, "body": "While editing your code to be readable, I saw that you have forgotten multiple <code>{</code> and <code>}</code>. You should add those and also you should use lower-case for <code>for</code> and <code>if</code>."}, {"owner": {"reputation": 17958, "user_id": 1971013, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/EtqFE.jpg?s=128&g=1", "display_name": "meaning-matters", "link": "https://stackoverflow.com/users/1971013/meaning-matters"}, "edited": false, "score": 3, "creation_date": 1516178477, "post_id": 48296404, "comment_id": 83578098, "body": "A senior developer supplied this?"}, {"owner": {"reputation": 8739, "user_id": 5603247, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c27998979eedac7a3737411e77b0bf4b?s=128&d=identicon&r=PG&f=1", "display_name": "Hans Olsson", "link": "https://stackoverflow.com/users/5603247/hans-olsson"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1516179074, "post_id": 48296404, "comment_id": 83578431, "body": "@JonathanLeffler The adjugate matrix can be used in this way. However, it is seldom a good idea to do this - and it doesn&#39;t scale to larger matrices so OP should investigate Lapack or similarly. And invert matrices is rarely correct at all."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1516180890, "post_id": 48296404, "comment_id": 83579514, "body": "It is actually a correct statement of deriving a solution to <code>AX = B</code> (where <code>A</code> is the coefficient matrix and <code>B</code> the solution vector) using the definition of the identity matrix and law of matrix multiplication, Essentially <code>(A-1)AX = (A-1)B or IX = (A-1)B or X = (A-1)B</code> (where <code>(A-1)</code> is used to represent the inverse of <code>A</code>)"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1516181581, "post_id": 48296404, "comment_id": 83579926, "body": "The code will work as fine as it did on any other system. Of course you must use <code>printf</code> not <code>Printf</code>, <code>for</code> not <code>For</code> and <code>if</code> not <code>If</code> and use actual compound expressions, either <code>&amp;&amp;</code> or <code>||</code> instead of the <i>comma operator</i> in your <code>if</code> clauses. You also have a bounds problem with <code>j</code> failing to reset it after its use in a <code>for</code> loop. (but the code actually compiles)"}, {"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1516184438, "post_id": 48296404, "comment_id": 83581757, "body": "@DavidC.Rankin: it does not compile on my system \u2013 <i>without</i> any of your post-hoc fixes, because that is not what OP states. Or OP is not telling the truth: &quot;The code is not running when compiled ...&quot; because It Does Not Compile."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1516207256, "post_id": 48296404, "comment_id": 83596961, "body": "<code>gcc -Wall -Wextra -pedantic -Wshadow -finline-functions -std=gnu11 -Ofast -o bin&#47;matrixinv matrixinv.c</code> And, <code>ls -al bin&#47;matrixinv -rwxr-xr-x 1 david david 13296 Jan 17 03:27 bin&#47;matrixinv</code>. Two warnings: <code>16:22: warning: unused variable \u2018n\u2019</code> and <code>45:20: warning: array subscript is above array bounds</code> (repeated 3-times for each <code>j</code> in <code>swap (&amp;A[i][j], &amp;A[j][i]);</code>)  <b>post-hoc</b> fixes? C does not have a <code>For</code> loop or an <code>If</code> statement or a <code>Printf</code> function..."}, {"owner": {"reputation": 2287, "user_id": 5267751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd62e8fd8fbb37abc7e2a39d23828047?s=128&d=identicon&r=PG&f=1", "display_name": "user202729", "link": "https://stackoverflow.com/users/5267751/user202729"}, "edited": false, "score": 0, "creation_date": 1516259576, "post_id": 48296404, "comment_id": 83616697, "body": "<a href=\"https://i.redd.it/ev4bbol8rxsx.png\" rel=\"nofollow noreferrer\">Related joke</a>."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 9228288, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-XpQVUPtaxIE/AAAAAAAAAAI/AAAAAAAAANs/Az4E1StgpF4/photo.jpg?sz=128", "display_name": "Tumul Kumar", "link": "https://stackoverflow.com/users/9228288/tumul-kumar"}, "edited": false, "score": 0, "creation_date": 1516279529, "post_id": 48315608, "comment_id": 83628501, "body": "Thank you very much, David for the help. I was at a loss, trying to find solutions to it. I just started learning C some months ago, and in my linear algebra class, we haven&#39;t covered adjucate matrices yet, so it was daunting to understand the maths and code behind it. Thanks again for clarifying my query."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 11, "user_id": 9228288, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-XpQVUPtaxIE/AAAAAAAAAAI/AAAAAAAAANs/Az4E1StgpF4/photo.jpg?sz=128", "display_name": "Tumul Kumar", "link": "https://stackoverflow.com/users/9228288/tumul-kumar"}, "edited": false, "score": 0, "creation_date": 1516298787, "post_id": 48315608, "comment_id": 83640782, "body": "Glad to help. C is a fantastic language. In a lot of ways similar to the language of math. You either know it, or you don&#39;t. There is no magic to learning either, you just have to be stubborn enough to never give up until you understand it -- until the light-bulb winks on if you will. Both require repetition to master -- and you know when you know it -- and when you don&#39;t. Learning takes time and effort. Keep at it, you will do fine in both."}], "tags": [], "owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "is_accepted": true, "score": 1, "last_activity_date": 1516259291, "creation_date": 1516259291, "answer_id": 48315608, "question_id": 48296404, "link": "https://stackoverflow.com/questions/48296404/solving-linear-equations-via-adjunt-matrix-in-c/48315608#48315608", "title": "Solving linear equations via adjunt matrix in C", "body": "<p>The problem with getting uncommented code \"<em>from a senior (buddy) of mine</em>\", is that you have absolutely no guidance and zero reference for the algorithms used in the code. Many times this leaves you in a worse position than you would be in if you had taken the time to learn the math involved and coded the solution yourself. </p>\n\n<p>Why? Instead of getting the benefit of learning the math involved and then logically applying that knowledge in forming a numeric solution, you end up guessing at where the error is in the code and needlessly guessing, recompiling, and failing again.</p>\n\n<p>Compounding that fact, the code you got from your buddy doesn't even contain valid C. There is no \"<code>For</code>\" loop in C, there is no \"<code>If</code>\" statement and there is no \"<code>Printf</code>\" function. In fact none of the standard library functions and none of the operators start with a Capital Letter at all. The inclusion of the <code>curses.h</code> header is superfluous. </p>\n\n<p>Further, you invoke <em>Undefined Behavior</em> by allowing the value of <code>j</code> to exceed the bounds of your array <code>A</code> in the loop:</p>\n\n<pre><code>for(i=0;i&lt;3;i++){ \n   swap (&amp;A[i][j], &amp;A[j][i]);} \n</code></pre>\n\n<p>Why? Because the value of <code>j</code> is <code>3</code> following the nested loops where you fill <code>A</code> from <code>cof_x</code> and it is never reset prior to attempting the transpose.</p>\n\n<p>(<strong>note:</strong> that turns out to be only one of the problems with your attempt to transpose the cofactor matrix)</p>\n\n<p>One of you primary complaints is the code does not compile. Of course it doesn't. However, if you <strong>enable compiler warnings</strong> the compiler would tell you the exact line where the problem occurs helping you fix the code so it does compile. For gcc, add <code>-Wall -Wextra -pedantic</code> to your compile string. For clang, add <code>-Weverything</code> and for VS (<code>cl.exe</code>) add <code>/W3</code> (or <code>/Wall</code> for literally all warnings). Do not accept code until it compiles cleanly without warning.</p>\n\n<p>Once you handle the basics, you can turn to the specifics of the algorithms. While the code forming the adjugate (or adjunct of squares) looked suspect, it in fact properly forms for adjugate matrix. The determinate is properly calculated. Where your code fails is computing the transpose the adjugate matrix by improperly swapping elements while iterating over the entire matrix.</p>\n\n<p>You have two options to transpose. Either iterate over the entire bounds <strong>assigning</strong> <code>A[j][i] = A[i][j];</code> or for a square matrix, iterate over only those elements that change swapping the values.</p>\n\n<p>After correcting the transpose (and commenting the code with reference to the operation at issue), the code works fine, e.g.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#define NDIM 3  /* if you need a constant - define one (or more) */\n\nvoid swap (float *a, float *b)\n{\n    float temp;\n    temp = *a;\n    *a = *b;\n    *b = temp;\n}\n\nint main (void) {\n\n    int i, j, cof_1, cof_2, cof_3, cof_4;\n    float   a[NDIM][NDIM]   = {{0}},    /* coefficient matrix */\n            c[NDIM]         =  {0},     /* solution vector */\n            A[NDIM][NDIM]   = {{0}},    /* adjunct matrix */\n            INV[NDIM][NDIM] = {{0}},    /* inverse of a */\n            det             =  0.0,     /* determinant of a */\n            X[NDIM]         =  {0},     /* linear system roots */\n            B[NDIM]         =  {0};     /* product A * c */\n\n    i = j = cof_1 = cof_2 = cof_3 = cof_4 = 0;  /* initialize */\n\n    for (i = 0; i &lt; NDIM; i++) {    /* validate input */\n        printf (\"Eq[%d] coefficients and constant: \", i + 1);\n        if (scanf (\"%f%f%f%f\", &amp;a[i][0], &amp;a[i][1], &amp;a[i][2], &amp;c[i]) != 4) {\n            fprintf (stderr, \"error: invalid coefficient.\\n\");\n            return 1;\n        }\n    }\n    putchar ('\\n');\n\n    /* cofactor matrix from matrix of minors incorporating\n     * patterned +/- sign to maxtix of minors.\n     */\n    for (i = 0; i &lt; NDIM; i++)\n        for (j = 0; j &lt; NDIM; j++) {\n            cof_1 = (i + 1) % NDIM;\n            cof_2 = (j + 1) % NDIM;\n            cof_3 = (i + 2) % NDIM;\n            cof_4 = (j + 2) % NDIM;\n\n            A[i][j]   = (a[cof_1][cof_2] * a[cof_3][cof_4]) -\n                        (a[cof_1][cof_4] * a[cof_3][cof_2]);\n        }\n\n    /* compute determinant */\n    for (i = 0; i &lt; NDIM; i++)\n        det += a[i][0] * A[i][0];\n\n    /* transpose cofactor (adjunct) */\n    for (i = 1; i &lt; NDIM; i++)\n        for (j = 0; j &lt; i; j++)\n            swap (&amp;A[i][j], &amp;A[j][i]);\n\n    /* consistency check B */\n    for (i = 0; i &lt; NDIM; i++)\n        for (j = 0; j &lt; NDIM; j++)\n            B[i] += A[i][j] * c[j];\n\n    if (det == 0) { /* eliminate infinite and no solution cases */\n        if (B[0] == 0 &amp;&amp; B[1] == 0 &amp;&amp; B[2] == 0) {\n            printf (\"The system is consistent and there \"\n                    \"are infinitely many solutions.\\n\");\n            return 1;\n        } else\n            printf (\"There is no solution to this system.\\n\");\n        return 2;\n    }\n\n    /* compute inverse of A (1/det * A) */\n    for (i = 0; i &lt; NDIM; i++)\n        for (j = 0; j &lt; NDIM; j++)\n            INV[i][j] = A[i][j] / det;\n\n    /* multiply constant vector by inverse */\n    for (i = 0; i &lt; NDIM; i++)\n        for (j = 0; j &lt; NDIM; j++)\n            X[i] += INV[i][j] * c[j];\n\n    if (X[0] == 0 &amp;&amp; X[1] == 0 &amp;&amp; X[2] == 0)\n        /* The case for trivial solution */\n        printf (\"This system has a trivial solution.\\n\");\n    else\n        /* The case for unique solution */\n        printf (\"This system has a unique solution.\\n\\n\");\n\n    /* output solutions for linear system of eq. */\n    for (i = 0; i &lt; NDIM; i++)\n        printf (\"\\t%c = %.2f\\n\", 'x' + i, X[i]);\n\n    return 0;\n}\n</code></pre>\n\n<p><strong>Example Use/Output</strong></p>\n\n<p>Linear equations from a simple proof of a <code>30-60-90</code> triangle used for the example:</p>\n\n<pre><code>$ ./bin/matrixinv\nEq[1] coefficients and constant: 1 1 1 180\nEq[2] coefficients and constant: 5 -1 -1 0\nEq[3] coefficients and constant: 1 1 -1 0\n\nThis system has a unique solution.\n\n        x = 30.00\n        y = 60.00\n        z = 90.00\n</code></pre>\n\n<p>Look things over and let me know if you have further questions.</p>\n"}], "owner": {"reputation": 11, "user_id": 9228288, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-XpQVUPtaxIE/AAAAAAAAAAI/AAAAAAAAANs/Az4E1StgpF4/photo.jpg?sz=128", "display_name": "Tumul Kumar", "link": "https://stackoverflow.com/users/9228288/tumul-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 114, "favorite_count": 0, "closed_date": 1516728342, "accepted_answer_id": 48315608, "answer_count": 1, "score": -6, "last_activity_date": 1516259291, "creation_date": 1516176954, "last_edit_date": 1516256779, "question_id": 48296404, "link": "https://stackoverflow.com/questions/48296404/solving-linear-equations-via-adjunt-matrix-in-c", "closed_reason": "Not suitable for this site", "title": "Solving linear equations via adjunt matrix in C", "body": "<p>Below is a C code that a senior of mine gave me, which is supposed to find a solution to a 3*3 simultaneous linear equation. He used the adjucate matrix method basically A-1 = 1|A| * adj A to find the solution of the linear equation. The code is not running when compiled (via GCC). Any help will be greatly appreciated. Below is the code:</p>\n\n<pre><code>#include &lt;stdio.h&gt; \n#include &lt;curses.h&gt; \n#include &lt;stdlib.h&gt; \n\nvoid swap(float*a, float*b){ \n    float temp; \n    temp=*a; \n    *a=*b; \n    *b=temp;} \n\nint main(){ \n    int i, j, cof_1,cof_2,cof_3,cof_4; \n    float a[3][3], c[3], A[3][3], INV[3][3], det=0.0, X[3], B[3]={0,0,0}, n; \n\n    for(i=0;i&lt;3;i++){ \n        printf(\"Enter x, y &amp; z co-efficient and the constant term of equation number %d: \\n\", i+1); \n        scanf(\"%f%f%f%f\", &amp;a[i][0], &amp;a[i][1], &amp;a[i][2], &amp;c[i]); \n    } \n\n    for(i=0;i&lt;3;i++)\n       {for(j=0;j&lt;3;j++)\n           {cof_1=(i+1)%3; \n            cof_2=(j+1)%3; \n            cof_3=(i+2)%3; \n            cof_4=(j+2)%3; \n\n   A[i][j] =(a[cof_1][cof_2]*a[cof_3][cof_4])-(a[cof_1][cof_4]*a[cof_3][cof_2]);} \n   } \n\n   for(i=0;i&lt;3;i++){ \n       det+=a[i][0]*A[i][0];} \n\n   printf(\"\\n\\n\\n\"); \n\n   for(i=0;i&lt;3;i++){ \n       swap (&amp;A[i][j], &amp;A[j][i]);} \n\n   for(i=0;i&lt;3;i++){ \n       For (j=0;j&lt;3;j++){ \n           B[i]+=A[i][j]*c[j]; \n       } \n   } \n\n   if(det==0){ \n       If (B[0]==0, B[1]==0, B[2]==0){ \n           printf(\"The system is consistent and there are infinitely many solutions.\"); \n           exit(1);} \n   else \n           printf(\"There is no solution to this system.\"); \n           exit(2); \n       } \n\n       for (i=0;i&lt;3;i++){ //for cases with possible solutions \n           for (j=0;j&lt;3;j++) \n               INV[i][j]=A[i][j]/det; \n       }\n\n       for(i=0;i&lt;3;i++){ \n           X[i]=0.0; \n           for (j=0;j&lt;3;j++){ \n               X[i]+=INV[i][j]*c[j]; \n           } \n       } \n\n       if(X[0]==0, X[1]==0, X[2]==0){ \n           printf (\"This system has a trivial solution. \\n\"); //The case for trivial solution} \n      else { \n           printf (\"This system has a unique solution. \\n\"); //The case for unique solution} \n       printf (\"Solution of the equations: \\n\\tx=%.2f\\n\\ty=%.2f\\n\\tz=%.2f\", X[0], X[1], X[2]); \n       return 0; \n} \n</code></pre>\n"}, {"tags": ["c", "linux", "string"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1516173190, "post_id": 48295464, "comment_id": 83575485, "body": "The &quot;instead of&quot; part, I suspect the order of the calls should be the opposite? Otherwise the slash will be at the end and not between the two strings."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1516173242, "post_id": 48295464, "comment_id": 83575521, "body": "As for a solution, why not simply write a function which does the two <code>strcat</code> calls, and returns the result? Then you can simply call that when and as needed. That will, probably, be the &quot;better way&quot; in the long run."}, {"owner": {"reputation": 310760, "user_id": 12711, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c330bdee507c95c603a93ca91d9145a9?s=128&d=identicon&r=PG", "display_name": "Michael Burr", "link": "https://stackoverflow.com/users/12711/michael-burr"}, "edited": false, "score": 3, "creation_date": 1516173683, "post_id": 48295464, "comment_id": 83575732, "body": "One suggestion: walk the list of items to concatenate twice: once to figure out how much space you&#39;ll need, then allocate that space.  Walk the list a second time to copy the data into the allocation. Not only is memory allocation an expensive operation (comparatively), it also generally means that the data gets copied again  by each <code>realloc()</code>."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 3, "creation_date": 1516174020, "post_id": 48295464, "comment_id": 83575894, "body": "Sounds like a job for snprintf(). Is there a reason not to use it?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1516203091, "post_id": 48295464, "comment_id": 83594194, "body": "IMO, OP is headed to a micro-optimization.  The time spent performing I/O certainly must exceed OP&#39;s good code of string concatenation - it is fast enough."}, {"owner": {"reputation": 3209, "user_id": 5794048, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Egkox.jpg?s=128&g=1", "display_name": "Murphy", "link": "https://stackoverflow.com/users/5794048/murphy"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1516219395, "post_id": 48295464, "comment_id": 83603734, "body": "@chux At the same time it&#39;s complex and obfuscated, prone to introduce new errors, the opposite of elegant, and surely not the best way available to concatenate two strings with a delimiter in C."}, {"owner": {"reputation": 310760, "user_id": 12711, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c330bdee507c95c603a93ca91d9145a9?s=128&d=identicon&r=PG", "display_name": "Michael Burr", "link": "https://stackoverflow.com/users/12711/michael-burr"}, "edited": false, "score": 0, "creation_date": 1516223568, "post_id": 48295464, "comment_id": 83605881, "body": "<code>snprintf()</code>  might not be the best tool for repeated concatenation even if it might be a good tool for concatenating several strings in one go. repeated concatenation across several <code>snprinf()</code> calls requires some managing of the destination buffer manually, which can be error prone.  Specifically, the following pattern which I&#39;ve seen used to append strings to a buffer is undefined behavior: <code>snprintf( dest, size-of-dest, &quot;%s&#47;%s&quot;, dest, newstring)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 3209, "user_id": 5794048, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Egkox.jpg?s=128&g=1", "display_name": "Murphy", "link": "https://stackoverflow.com/users/5794048/murphy"}, "edited": false, "score": 0, "creation_date": 1516192455, "post_id": 48296767, "comment_id": 83586997, "body": "For security&#39;s sake, please <b>always</b> use <code>snprintf()</code>."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 3209, "user_id": 5794048, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Egkox.jpg?s=128&g=1", "display_name": "Murphy", "link": "https://stackoverflow.com/users/5794048/murphy"}, "edited": false, "score": 0, "creation_date": 1516202420, "post_id": 48296767, "comment_id": 83593692, "body": "@Murphy <code>snprintf()</code> does have advantages over <code>sprintf()</code>, yet many application of it fail to check its return value.  By preventing overflow, yet  without acting on it, <code>snprintf()</code> trades one bad problem for another.  A substitution of <code>snprintf()</code> for <code>sprintf()</code> is insufficient for security, but can be a good 1st step."}, {"owner": {"reputation": 310760, "user_id": 12711, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c330bdee507c95c603a93ca91d9145a9?s=128&d=identicon&r=PG", "display_name": "Michael Burr", "link": "https://stackoverflow.com/users/12711/michael-burr"}, "edited": false, "score": 0, "creation_date": 1516289813, "post_id": 48296767, "comment_id": 83635252, "body": "Can you show how to add a variable number of items?  That&#39;s where using <code>sprintf()</code>/<code>snprintf()</code> get more complicated."}], "tags": [], "owner": {"reputation": 385, "user_id": 7114946, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-FbfhnUgQmLU/AAAAAAAAAAI/AAAAAAAAARc/EdBSHus7rDU/photo.jpg?sz=128", "display_name": "Daniel Ortega", "link": "https://stackoverflow.com/users/7114946/daniel-ortega"}, "is_accepted": false, "score": 3, "last_activity_date": 1516178213, "creation_date": 1516178213, "answer_id": 48296767, "question_id": 48295464, "link": "https://stackoverflow.com/questions/48295464/is-there-a-fast-way-to-interpose-a-character-between-strings/48296767#48296767", "title": "Is there a fast way to interpose a character between strings?", "body": "<p>Yes, you can do sprintf:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main()\n{\n\n    char var1[] = \"FileA.txt\";\n    char var2[] = \"FileB.png\";\n    char var3[] = \"FileC\";\n\n    char result[30];\n\n    sprintf(result, \"%s/%s/%s\", var1, var2,var3);\n    printf(\"result: %s\\n\", result);\n\n\n    return 0;\n}\n</code></pre>\n\n<p>And the result is like this:</p>\n\n<pre><code>result: FileA.txt/FileB.png/FileC\n</code></pre>\n\n<p>If you need, the variable result can be a pointer and allocate space based on your needs.</p>\n"}, {"tags": [], "owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "is_accepted": false, "score": 1, "last_activity_date": 1516181799, "creation_date": 1516181799, "answer_id": 48297793, "question_id": 48295464, "link": "https://stackoverflow.com/questions/48295464/is-there-a-fast-way-to-interpose-a-character-between-strings/48297793#48297793", "title": "Is there a fast way to interpose a character between strings?", "body": "<p>As Michael Burr mentioned in a comment to the question, it is best to walk the list/array twice. On the first pass, calculate the total length of the string needed. Next, allocate the memory needed for the entire string. On the second pass, copy the contents. Do not forget to account for, and append, the string-terminating nul byte (<code>\\0</code>).</p>\n\n<p>Consider the following example functions <code>dupcat()</code> and <code>dupcats()</code>:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdarg.h&gt;\n#include &lt;stdio.h&gt;\n\nchar *dupcat(const size_t count, const char *parts[])\n{\n    size_t  i, len = 0;\n    char   *dst, *end;\n\n    /* Calculate total length of parts. Skip NULL parts. */\n    for (i = 0; i &lt; count; i++)\n        len += (parts[i]) ? strlen(parts[i]) : 0;\n\n    /* Add room for '\\0'.\n       We add an extra 8 to 15 '\\0's, just because\n       it is sometimes useful, and we do a dynamic\n       allocation anyway. */\n    len = (len | 7) + 9;\n\n    /* Allocate memory. */\n    dst = malloc(len);\n    if (!dst) {\n        fprintf(stderr, \"dupcat(): Out of memory; tried to allocate %zu bytes.\\n\", len);\n        exit(EXIT_FAILURE);\n    }\n\n    /* Copy parts. */\n    end = dst;\n    for (i = 0; i &lt; count; i++) {\n        const char  *src = parts[i];\n        /* We could use strlen() and memcpy(),\n           but a loop like this will work just as well. */\n        if (src)\n            while (*src)\n                *(end++) = *(src++);\n    }\n\n    /* Sanity check time! */\n    if (end &gt;= dst + len) {\n        fprintf(stderr, \"dupcat(): Arguments were modified during duplication; buffer overrun!\\n\");\n        free(dst); /* We can omit this free(), but only in case of exit(). */\n        exit(EXIT_FAILURE);\n    }\n\n    /* Terminate string (and clear padding). */\n    memset(end, '\\0', (size_t)(dst + len - end));\n\n    /* Done! */\n    return dst;\n}\n\nchar *dupcats(const size_t count, ...)\n{\n    size_t   i, len = 0;\n    char    *dst, *end;\n    va_list  args;\n\n    /* Calculate total length of 'count' source strings. */\n    va_start(args, count);\n    for (i = 0; i &lt; count; i++) {\n        const char  *src = va_arg(args, const char *);\n        if (src)\n            len += strlen(src);\n    }\n    va_end(args);\n\n    /* Add room for end-of-string '\\0'.\n       Because it is often useful to know you have\n       at least one extra '\\0' at the end of the string,\n       and we do a dynamic allocation anyway,\n       we pad the string with 9 to 16 '\\0',\n       aligning 'len' to a multiple of 8. */\n    len = (len | 7) + 9;\n\n    /* Allocate memory for the string. */\n    dst = malloc(len);\n    if (!dst) {\n        fprintf(stderr, \"dupcats(): Out of memory; tried to allocate %zu bytes.\\n\", len);\n        exit(EXIT_FAILURE);\n    }\n\n    /* Copy the source strings. */\n    end = dst;\n    va_start(args, count);\n    for (i = 0; i &lt; count; i++) {\n        const char  *src = va_arg(args, const char *);\n        /* We could use strlen() and memcpy() here;\n           however, this loop is easier to follow. */\n        if (src)\n            while (*src)\n                *(end++) = *(src++);\n    }\n    va_end(args);\n\n    /* Sanity check. */\n    if (end &gt;= dst + len) {\n        fprintf(stderr, \"dupcats(): Arguments were modified during duplication; buffer overrun!\\n\");\n        free(dst); /* We can omit this free(), but only in case of exit(). */\n        exit(EXIT_FAILURE);\n    }\n\n    /* Add end-of-string '\\0' (filling the padding). */\n    memset(end, '\\0', dst + len - end);\n\n    /* Done. */\n    return dst;\n}\n\n\nint main(int argc, char *argv[])\n{\n    char *result;\n\n    result = dupcat(argc - 1, (const char **)(argv + 1));\n    printf(\"Arguments concatenated: '%s'.\\n\", result);\n    free(result);\n\n    result = dupcats(5, \"foo\", \"/\", \"bar\", \"/\", \"baz\");\n    printf(\"Concatenating 'foo', '/', 'bar', '/', and 'baz': '%s'.\\n\", result);\n    free(result);\n\n    return EXIT_SUCCESS;\n}\n</code></pre>\n\n<p>Neither <code>dupcat()</code> nor <code>dupcats()</code> will ever return NULL: they will print an error message to standard error and exit, if an error occurs.</p>\n\n<p><code>dupcat()</code> takes an array of strings, and returns a dynamically allocated concatenated copy with at least eight bytes of nul padding.</p>\n\n<p><code>dupcats()</code> takes a variable number of pointers, and returns a dynamically allocated concatenated copy with at least eight bytes of nul padding.</p>\n\n<p>Both functions treat NULL pointers as if they were empty strings. For both functions, the first parameter is the number of strings to concatenate.</p>\n\n<p>(Since OP did not show the definitions of <code>struct file_list</code> or <code>struct file_node</code>, I did not bother to write a list-based version. However, it should be trivial to adapt from one of the two versions shown.)</p>\n\n<hr>\n\n<p>In some cases, a variant that constructs a valid path from a fixed <code>base</code> part, with one or more relative file or directory names concatenated, and POSIXy <code>./</code> removed and <code>../</code> backtracked (but not out of <code>base</code> subtree), is very useful.</p>\n\n<p>If carefully written, it allows the program to accept untrusted paths, relative to a specific subtree. (The combined paths are confined to that subtree, but symlinks and hardlinks can still be used to escape the subtree.)</p>\n\n<p>One possible implementation is as follows:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;errno.h&gt;\n\nchar *dynamic_path(const char *const subtree,\n                   const size_t      parts,\n                   const char       *part[])\n{\n    const size_t  subtree_len = (subtree) ? strlen(subtree) : 0;\n    size_t        parts_len = 0;\n    size_t        total_len, i;\n    char         *path, *mark, *curr;\n\n    /* Calculate the length of each individual part.\n       Include room for a leading slash.\n    */\n    for (i = 0; i &lt; parts; i++)\n        parts_len += (part[i]) ? 1 + strlen(part[i]) : 0;\n\n    /* Add room for the string-terminating '\\0'.\n       We're paranoid, and add a bit more padding. */\n    total_len = ((subtree_len + parts_len) | 7) + 9;\n\n    /* Allocate memory for the combined path. */\n    path = malloc(total_len);\n    if (!path) {\n        errno = ENOMEM;\n        return NULL;\n    }\n\n    /* If the user specified a subtree, we use it as the fixed prefix. */\n    if (subtree_len &gt; 0) {\n        memcpy(path, subtree, subtree_len);\n        mark = path + subtree_len;\n        /* Omit a trailing /. We enforce it below anyway. */\n        if (parts &gt; 0 &amp;&amp; subtree_len &gt; 1 &amp;&amp; mark[-1] == '/')\n            --mark;\n    } else\n        mark = path;\n\n    /* Append the additional path parts. */\n    curr = mark;\n    for (i = 0; i &lt; parts; i++) {\n        const size_t  len = (part[i]) ? strlen(part[i]) : 0;\n        if (len &gt; 0) {\n            /* Each path part is a separate file/directory name,\n               so there is an (implicit) slash before each one. */\n            if (part[i][0] != '/')\n                *(curr++) = '/';\n            memcpy(curr, part[i], len);\n            curr += len;\n        }\n    }\n\n    /* Sanity check. */\n    if (curr &gt;= path + total_len) {\n        /* Buffer overrun occurred. */\n        fprintf(stderr, \"Buffer overrun in dynamic_path()!\\n\");\n        free(path); /* Can be omitted if we exit(). */\n        exit(EXIT_FAILURE);\n    }\n\n    /* Terminate string (and clear padding). */\n    memset(curr, '\\0', (size_t)(path + total_len - curr));\n\n    /* Cleanup pass.\n       Convert \"/foo/../\" to \"/\", but do not backtrack over mark.\n       Combine consecutive slashes and /./ to a single slash.\n    */\n    {\n        char *src = mark;\n        char *dst = mark;\n\n        while (*src)\n            if (src[0] == '/' &amp;&amp; src[1] == '.' &amp;&amp; src[2] == '.' &amp;&amp; (!src[3] || src[3] == '/')) {\n                src += 3; /* Skip over /.. */\n                /* Backtrack, but do not underrun mark. */\n                if (dst &gt; mark) {\n                    dst--;\n                    while (dst &gt; mark &amp;&amp; *dst != '/')\n                        dst--;\n                }\n                /* Never consume the mark slash. */\n                if (dst == mark)\n                    dst++;\n            } else\n            if (src[0] == '/' &amp;&amp; src[1] == '.' &amp;&amp; (!src[2] || src[2] == '/')) {\n                src += 2; /* Skip over /. */\n                if (dst == mark || dst[-1] != '/')\n                    *(dst++) = '/';\n            } else\n            if (src[0] == '/') {\n                src++;\n                if (dst == mark || dst[-1] != '/')\n                    *(dst++) = '/';\n            } else\n                *(dst++) = *(src++);\n\n        /* Clear removed part. */\n        if (dst &lt; src)\n            memset(dst, '\\0', (size_t)(src - dst));\n    }\n\n    return path;\n}\n\nint main(int argc, char *argv[])\n{\n    char *path;\n\n    if (argc &lt; 2) {\n        fprintf(stderr, \"\\nUsage: %s PREFIX [ PATHNAME ... ]\\n\\n\", argv[0]);\n        return EXIT_FAILURE;\n    }\n\n    path = dynamic_path(argv[1], argc - 2, (const char **)(argv + 2));\n    if (!path) {\n        fprintf(stderr, \"dynamic_path(): %s.\\n\", strerror(errno));\n        return EXIT_FAILURE;\n    }\n\n    printf(\"%s\\n\", path);\n    free(path);\n\n    return EXIT_SUCCESS;\n}\n</code></pre>\n\n<p>Note that I wrote the above version from scratch (and dedicate it to <a href=\"https://creativecommons.org/publicdomain/zero/1.0/\" rel=\"nofollow noreferrer\">public domain (CC0)</a>), so you should thoroughly test it before relying it on production use. (My intent is for it to be an useful example or basis, that will help you write your own implementation tailored to your needs.)</p>\n\n<p>If you do find any bugs or issues in it, let me know in a comment, so I can verify and fix.</p>\n"}], "owner": {"reputation": 2975, "user_id": 5559342, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/39185a39d1b8b29d0b51564f7d55164e?s=128&d=identicon&r=PG&f=1", "display_name": "Robb1", "link": "https://stackoverflow.com/users/5559342/robb1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1516181799, "creation_date": 1516173056, "question_id": 48295464, "link": "https://stackoverflow.com/questions/48295464/is-there-a-fast-way-to-interpose-a-character-between-strings", "title": "Is there a fast way to interpose a character between strings?", "body": "<p>I wrote this function that will generate a single string out of a file list.\n(e.g. if I have a folder with <code>FileA.txt</code>, <code>FileB.png</code> and <code>FileC</code> I'll get as output this string: <code>FileA.txtFileB.pngFileC</code>). Now I want to add a <code>/</code> character between each filename. (e.g. <code>FileA.txt/FileB.png/FileC/</code>) Is there a way to do it in \"one blow\" without having to repeat the same operation twice?</p>\n\n<p>In other words, is there a way to do something like:</p>\n\n<pre><code>original_string = append2(original_string, new_string, '/');\n</code></pre>\n\n<p>instead of having to do</p>\n\n<pre><code>append(original_string, new_string);\nappend(original_string, \"/\");\n</code></pre>\n\n<p>?</p>\n\n<p>Here's the function I wrote as reference:</p>\n\n<pre><code>/**\n * @brief Concatenate all file names in a file list (putting a '/' between each of them)\n * @param file_list The file list to serialize.\n * @return          A string containing all files in the file list.\n */\nchar *file_list_tostring(struct file_list *file_list) {\n    char *final_string = NULL;\n    size_t final_len = 0;\n    struct file_node *list_iter = file_list-&gt;first;\n    while (list_iter != NULL) {\n        char *tmp = list_iter-&gt;filename;\n        size_t tmp_len = strlen(tmp);\n        char *s = realloc(final_string, final_len + tmp_len + 1); // +1 for '\\0'\n        if (s == NULL) {\n            perror(\"realloc\");\n            exit(EXIT_FAILURE);\n        }\n        final_string = s;\n        memcpy(final_string + final_len, tmp, tmp_len + 1);\n        final_len += tmp_len;\n        list_iter = list_iter-&gt;next;\n    }\n    return final_string;\n}\n</code></pre>\n\n<p>Maybe there is a <strong>simple way to interpose a single character between two strings</strong>?</p>\n\n<p>Note: I know there's nothing wrong in repeating the same operation twice, I'm asking this question to know <strong>if there is a better way</strong> of doing so!</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 2, "creation_date": 1516171054, "post_id": 48294924, "comment_id": 83574552, "body": "Did you try debugging? Split the lines and expressions in more parts. Print everything often and early."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1516171144, "post_id": 48294924, "comment_id": 83574587, "body": "Are you sure the output was <code>0x18</code> or <code>18</code>?"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1516171834, "post_id": 48294924, "comment_id": 83574857, "body": "What is <code>b11000 &amp; b11111</code>?"}, {"owner": {"reputation": 45, "user_id": 8943896, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/HXK4H.jpg?s=128&g=1", "display_name": "Miko", "link": "https://stackoverflow.com/users/8943896/miko"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1516171987, "post_id": 48294924, "comment_id": 83574905, "body": "@DavidC.Rankin b11000?"}, {"owner": {"reputation": 135, "user_id": 5038027, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qHzGO.jpg?s=128&g=1", "display_name": "Nitin", "link": "https://stackoverflow.com/users/5038027/nitin"}, "edited": false, "score": 0, "creation_date": 1516171998, "post_id": 48294924, "comment_id": 83574910, "body": "You see output 18 because you are printing a decimal value in the printf(&quot;%d&quot;,... ) that is an expected output. if you want to see output 12 then use prinf(&quot;%x&quot;, ...) format specifier. if you want to prefix output with 0x (0x12) then use printf(&quot;0x%x&quot;, ...);"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1516172614, "post_id": 48294924, "comment_id": 83575217, "body": "@Miko correct, which is hex <code>0x18</code> or decimal <code>24</code>. Why do you expect <code>12</code>?"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1516173929, "post_id": 48294924, "comment_id": 83575845, "body": "Hint, the conversion specifiers are mnemonics. %decimal, he%xadecimal."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1516174166, "post_id": 48294924, "comment_id": 83575958, "body": "Though, of course the output from this program is <b>24</b> which <i>is</i> 0x18, and this question is missing a proper <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1516174192, "post_id": 48294924, "comment_id": 83575970, "body": "And it is the operator precedence issue"}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 8943896, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/HXK4H.jpg?s=128&g=1", "display_name": "Miko", "link": "https://stackoverflow.com/users/8943896/miko"}, "edited": false, "score": 0, "creation_date": 1516171647, "post_id": 48294997, "comment_id": 83574789, "body": "Add parenthesis did the trick. This is really strang? &quot;+&quot; is higher prioritized than &quot;&amp;&quot;? Also, I hope this don&#39;t sound silly, after you perform operation and calculation on val, the value of val changes, right? No compiler is smart enough to store it in some &quot;temporary location&quot;, right?"}, {"owner": {"reputation": 3633, "user_id": 675154, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/23da6806cab4830b5d1b15ef2a410541?s=128&d=identicon&r=PG", "display_name": "delta", "link": "https://stackoverflow.com/users/675154/delta"}, "reply_to_user": {"reputation": 45, "user_id": 8943896, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/HXK4H.jpg?s=128&g=1", "display_name": "Miko", "link": "https://stackoverflow.com/users/8943896/miko"}, "edited": false, "score": 0, "creation_date": 1516171778, "post_id": 48294997, "comment_id": 83574829, "body": "@Miko no, <code>val</code> does not change, use <code>printf(&quot;%x\\n&quot;,val);</code> to check"}], "tags": [], "owner": {"reputation": 3633, "user_id": 675154, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/23da6806cab4830b5d1b15ef2a410541?s=128&d=identicon&r=PG", "display_name": "delta", "link": "https://stackoverflow.com/users/675154/delta"}, "is_accepted": true, "score": 2, "last_activity_date": 1516171152, "creation_date": 1516171152, "answer_id": 48294997, "question_id": 48294924, "link": "https://stackoverflow.com/questions/48294924/why-is-the-result-0x18-instead-of-0x12/48294997#48294997", "title": "Why is the result 0x18 instead of 0x12?", "body": "<p><code>int val1 = (val&amp;0xf) + ((val&gt;&gt;4)&amp;0xf)*10</code></p>\n\n<p>add parentheses around <code>val&amp;0xf</code>, check c operator precedence for details.</p>\n\n<p>if you want hex format, use <code>printf(\"%x\", ...)</code></p>\n\n<hr>\n\n<ol>\n<li><a href=\"http://en.cppreference.com/w/c/language/operator_precedence\" rel=\"nofollow noreferrer\">http://en.cppreference.com/w/c/language/operator_precedence</a></li>\n</ol>\n"}], "owner": {"reputation": 45, "user_id": 8943896, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/HXK4H.jpg?s=128&g=1", "display_name": "Miko", "link": "https://stackoverflow.com/users/8943896/miko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 462, "favorite_count": 0, "closed_date": 1516240214, "accepted_answer_id": 48294997, "answer_count": 1, "score": -3, "last_activity_date": 1516171839, "creation_date": 1516170840, "question_id": 48294924, "link": "https://stackoverflow.com/questions/48294924/why-is-the-result-0x18-instead-of-0x12", "closed_reason": "Not suitable for this site", "title": "Why is the result 0x18 instead of 0x12?", "body": "<p>The code is as follows:</p>\n\n<pre><code>int main() {\n// your code goes here\nint val = 0x18;\nint val1 = val&amp;0xf + ((val&gt;&gt;4)&amp;0xf)*10;\n printf(\"%d %d\\n\",val1,val1&amp;0x3f);\nreturn 0;\n}\n</code></pre>\n\n<p>I'm caught in a loop or something I can't figure it out. My handcrafted, step by step calculation places the result at 0x12 which is 18D, but I tried 2 compilers the print out was always 0x18.</p>\n\n<p>Why is that?</p>\n\n<p>The last step I calculated was 8+ 10 = 18?</p>\n"}, {"tags": ["c", "matlab", "mex"], "comments": [{"owner": {"reputation": 2452, "user_id": 2260153, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/96250cb35c79be3d7df6335d91408aff?s=128&d=identicon&r=PG&f=1", "display_name": "buzjwa", "link": "https://stackoverflow.com/users/2260153/buzjwa"}, "edited": false, "score": 0, "creation_date": 1516177485, "post_id": 48294328, "comment_id": 83577561, "body": "The third argument of <code>memcpy</code> is the number of <b>bytes</b> to copy. For generality replace <code>1</code> there with <code>1*sizeof(int)</code>. Besides this, it looks like you&#39;re copying an int to a <code>mxREAL</code> which might not be correct. You might need to convert it to float or double before."}, {"owner": {"reputation": 713, "user_id": 8408902, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/91bc8741e6c127bdede3317e71dc9d9c?s=128&d=identicon&r=PG&f=1", "display_name": "tryingtosolve", "link": "https://stackoverflow.com/users/8408902/tryingtosolve"}, "reply_to_user": {"reputation": 2452, "user_id": 2260153, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/96250cb35c79be3d7df6335d91408aff?s=128&d=identicon&r=PG&f=1", "display_name": "buzjwa", "link": "https://stackoverflow.com/users/2260153/buzjwa"}, "edited": false, "score": 0, "creation_date": 1516201000, "post_id": 48294328, "comment_id": 83592678, "body": "@buzjwa How can I convert that to a double?"}], "answers": [{"tags": [], "owner": {"reputation": 42647, "user_id": 7328782, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/treJu.png?s=128&g=1", "display_name": "Cris Luengo", "link": "https://stackoverflow.com/users/7328782/cris-luengo"}, "is_accepted": false, "score": 1, "last_activity_date": 1516260461, "last_edit_date": 1516260461, "creation_date": 1516259906, "answer_id": 48315739, "question_id": 48294328, "link": "https://stackoverflow.com/questions/48294328/assigning-an-integer-to-an-mxarray-of-pointers/48315739#48315739", "title": "Assigning an integer to an mxArray of pointers", "body": "<p>What you are doing in this bit of code:</p>\n\n<pre><code>funcInputs[3] = mxCreateDoubleMatrix(1,1,mxREAL);\nint total = 33;\nstd::memcpy(funcInputs[3], &amp;total, 1);\n</code></pre>\n\n<p>is create an <code>mxArray</code> object and assign its pointer to the 4th element of your pointer array, and then overwriting the first byte of the <code>mxArray</code> object with the first byte of an <code>int</code>.</p>\n\n<p>An <code>mxArray</code> is an object that contains information about its size and type, and a pointer to the actual array data. You can get this pointer using <a href=\"https://www.mathworks.com/help/matlab/apiref/mxgetpr.html\" rel=\"nofollow noreferrer\"><code>mxGetPr</code></a>:</p>\n\n<pre><code>double* ptr = mxGetPr(funcInputs[3]);\n</code></pre>\n\n<p>and you can then assign your value to the location pointed to:</p>\n\n<pre><code>*ptr = 33;\n</code></pre>\n\n<p><code>mxPr</code> always returns a double. If your matrix is of a different type, you need to use a different accessor. See the <a href=\"https://www.mathworks.com/help/matlab/cc-mx-matrix-library.html\" rel=\"nofollow noreferrer\">documentation</a>.</p>\n\n<p>Note that all the code above can be replaced by a single function call:</p>\n\n<pre><code>funcInputs[3] = mxCreateDoubleScalar(33);\n</code></pre>\n"}], "owner": {"reputation": 713, "user_id": 8408902, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/91bc8741e6c127bdede3317e71dc9d9c?s=128&d=identicon&r=PG&f=1", "display_name": "tryingtosolve", "link": "https://stackoverflow.com/users/8408902/tryingtosolve"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 157, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1516260461, "creation_date": 1516167929, "last_edit_date": 1516259983, "question_id": 48294328, "link": "https://stackoverflow.com/questions/48294328/assigning-an-integer-to-an-mxarray-of-pointers", "title": "Assigning an integer to an mxArray of pointers", "body": "<p>I'm trying to use function <code>mexCallMATLAB</code> as <a href=\"https://www.mathworks.com/help/matlab/apiref/mexcallmatlab.html\" rel=\"nofollow noreferrer\" title=\"here\">described here</a>.</p>\n\n<p>However, I have 4 input arguments in total, so I created an <code>mxArray</code> by doing</p>\n\n<pre><code>mxArray *funcInputs[4]; \n</code></pre>\n\n<p>And I want to assign the first three pointers with vectors (I have done so successfully). However, for the last pointer, I want to assign an integer to it, but to no avail.</p>\n\n<p>This is what I have done so far:</p>\n\n<pre><code>funcInputs[3] = mxCreateDoubleMatrix(1,1,mxREAL);\nint total = 33;\nstd::memcpy(funcInputs[3], &amp;total, 1);\n</code></pre>\n\n<p>The mex function compiles successfully but the value <code>33</code> is not passed. </p>\n\n<p>I'm trying to execute the function like this:</p>\n\n<pre><code>mxArray *outs[2];\nmexCallMATLAB(2, outs, 4, funcInputs, \"myFunction\");\n</code></pre>\n\n<p><code>mexCallMATLAB</code> does call the function <code>myFunction</code> as expected, but the value <code>33</code> is not passed to the function.</p>\n\n<p>How did I mess this up?</p>\n"}, {"tags": ["c++", "c", "c++11", "macros"], "comments": [{"owner": {"reputation": 32078, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 6, "creation_date": 1516168041, "post_id": 48294314, "comment_id": 83573538, "body": "Just use <code>::std::swap</code> instead."}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 9, "creation_date": 1516168179, "post_id": 48294314, "comment_id": 83573577, "body": "<code>SWAP(a, a)</code> fails with this definition."}, {"owner": {"user_type": "does_not_exist", "display_name": "user743382"}, "edited": false, "score": 3, "creation_date": 1516168820, "post_id": 48294314, "comment_id": 83573760, "body": "If you&#39;re saying this is to be used in a C file, why tag your question as C++?"}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 2, "creation_date": 1516171585, "post_id": 48294314, "comment_id": 83574764, "body": "@hvd: It is not uncommon to have a header file that gets <code>#include</code>d by both C source files and C++ source files."}, {"owner": {"user_type": "does_not_exist", "display_name": "user743382"}, "reply_to_user": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1516171783, "post_id": 48294314, "comment_id": 83574833, "body": "@jxh Sure, and that&#39;s why I didn&#39;t remove the tags yet. However, there&#39;s nothing in the question to indicate that&#39;s the case here, so either the tags are inappropriate and should be removed, or the OP should edit the question to make it clear why the tags are appropriate. What seems most likely to me is that the OP just put them in without thinking about it and now ended up with a lot of useless extra information in the answers."}, {"owner": {"reputation": 7407, "user_id": 1757805, "user_type": "registered", "accept_rate": 51, "profile_image": "https://i.stack.imgur.com/AMueI.jpg?s=128&g=1", "display_name": "Francis Cugler", "link": "https://stackoverflow.com/users/1757805/francis-cugler"}, "edited": false, "score": 0, "creation_date": 1516171797, "post_id": 48294314, "comment_id": 83574845, "body": "I can agree with jxh; I&#39;ve seen a few times here and there a <code>declaration or interface file</code> - header with its declarations and pre processor directives for use with either C or C++ then there were accompanying <code>*.c</code> &amp; <code>*.cpp</code> files with the actual definitions for each language. It was a library base that supported both C, C++ &amp; other languages such as C#, Java &amp; F#."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1516179624, "post_id": 48294314, "comment_id": 83578771, "body": "1) Never use XOR swaps, they are dangerous, unreadable and most likely not faster. 2) Use a function instead of a function-like macro. 3) When writing function-like macros (which you should avoid), protect all macro parameters against accidental precedence issues by surrounding them with parenthesis, as demonstrated in your beginner-level C programming book."}, {"owner": {"reputation": 5668, "user_id": 4083309, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6b4ef5a2e912153069b82607789a717?s=128&d=identicon&r=PG&f=1", "display_name": "Arne Vogel", "link": "https://stackoverflow.com/users/4083309/arne-vogel"}, "edited": false, "score": 0, "creation_date": 1516190128, "post_id": 48294314, "comment_id": 83585497, "body": "Expanding on Lundin&#39;s 1): a) if XOR swaps were still so cool, the compiler would know about them; Back then, an average coder could write assembler that was faster than compiler-generated. Now, it takes an expert to beat it, if even possible. b) as they were invented, registers were scarce (6 usable GP on x86, maybe 7 if you messed with the frame pointer) and caches were absent or sucked. Now, there are many more  (x86-64 has at least 14 GP \u2013 also reg renaming) and very effective caching. c) they are RMW ops and are most likely more expensive than assignment (<code>mov</code>) after translation to &#181;code."}, {"owner": {"reputation": 85822, "user_id": 597607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jCzJi.png?s=128&g=1", "display_name": "Bo Persson", "link": "https://stackoverflow.com/users/597607/bo-persson"}, "edited": false, "score": 1, "creation_date": 1516191457, "post_id": 48294314, "comment_id": 83586383, "body": "You might want to check the answer here <a href=\"https://stackoverflow.com/a/1826175/597607\">stackoverflow.com/a/1826175/597607</a> for <i>how</i> much slower the xor-trick actually is."}], "answers": [{"tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": false, "score": 3, "last_activity_date": 1516168058, "creation_date": 1516168058, "answer_id": 48294341, "question_id": 48294314, "link": "https://stackoverflow.com/questions/48294314/how-to-use-ifndef-with-macro-argument/48294341#48294341", "title": "How to use #ifndef with macro argument?", "body": "<p>It is incorrect.</p>\n\n<p>The correct usage of <code>#ifndef</code> is:</p>\n\n<pre><code>#ifndef SWAP\n#define SWAP(a, b)  {a ^= b; b ^= a; a ^= b;}\n#endif\n</code></pre>\n\n<p>From  <a href=\"http://en.cppreference.com/w/cpp/preprocessor/conditional\" rel=\"nofollow noreferrer\">http://en.cppreference.com/w/cpp/preprocessor/conditional</a>:</p>\n\n<blockquote>\n  <p><code>#ifndef</code> <em><code>identifier</code></em></p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 54818, "user_id": 962089, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/b6SVs.jpg?s=128&g=1", "display_name": "chris", "link": "https://stackoverflow.com/users/962089/chris"}, "edited": false, "score": 5, "creation_date": 1516168875, "post_id": 48294342, "comment_id": 83573772, "body": "To be fair, <code>std::swap(t[i++],i)</code> is undefined behaviour (assuming <code>i</code> is <code>int</code>) until C++17, where there are still multiple possible well-defined results. Your point still stands, of course. <code>SWAP(t[i], i)</code> wouldn&#39;t go very well."}, {"owner": {"reputation": 5668, "user_id": 4083309, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6b4ef5a2e912153069b82607789a717?s=128&d=identicon&r=PG&f=1", "display_name": "Arne Vogel", "link": "https://stackoverflow.com/users/4083309/arne-vogel"}, "reply_to_user": {"reputation": 54818, "user_id": 962089, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/b6SVs.jpg?s=128&g=1", "display_name": "chris", "link": "https://stackoverflow.com/users/962089/chris"}, "edited": false, "score": 0, "creation_date": 1516189444, "post_id": 48294342, "comment_id": 83585015, "body": "@chris Good point, <code>swap(t[i++], t[last])</code> would be a better example (or just any second argument not related to <code>i</code>)."}], "tags": [], "owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "is_accepted": false, "score": 7, "last_activity_date": 1516168069, "creation_date": 1516168069, "answer_id": 48294342, "question_id": 48294314, "link": "https://stackoverflow.com/questions/48294314/how-to-use-ifndef-with-macro-argument/48294342#48294342", "title": "How to use #ifndef with macro argument?", "body": "<p>You want to code</p>\n\n<pre><code>#ifndef SWAP\n#define SWAP(a, b)  {a ^= b; b ^= a; a ^= b;}\n#endif\n</code></pre>\n\n<p>The <a href=\"http://en.cppreference.com/w/cpp/preprocessor/conditional\" rel=\"noreferrer\"><code>#ifndef</code></a> is just looking into the preprocessor's symbol table (for the presence or absence of some given preprocessor symbol). It does not care about the arguments of your <code>SWAP</code> macro.</p>\n\n<p>Of course in genuine C++11 you should prefer the standard <a href=\"http://en.cppreference.com/w/cpp/algorithm/swap\" rel=\"noreferrer\"><code>std::swap</code></a> function. It is typesafe, more readable, and safer (think about <code>SWAP(t[i++],i)</code> as a misbehaving example).</p>\n"}, {"comments": [{"owner": {"reputation": 7407, "user_id": 1757805, "user_type": "registered", "accept_rate": 51, "profile_image": "https://i.stack.imgur.com/AMueI.jpg?s=128&g=1", "display_name": "Francis Cugler", "link": "https://stackoverflow.com/users/1757805/francis-cugler"}, "edited": false, "score": 0, "creation_date": 1516170671, "post_id": 48294486, "comment_id": 83574405, "body": "Yeah it would work but it&#39;s not particularly safe... what if <code>(a==b)</code>? what if <code>(a &amp;| b)</code> are pointers or expressions... etc."}], "tags": [], "owner": {"reputation": 541, "user_id": 7373699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a8e52aa20dda4ed7983eca128bd0f5b?s=128&d=identicon&r=PG&f=1", "display_name": "Bharath T S", "link": "https://stackoverflow.com/users/7373699/bharath-t-s"}, "is_accepted": false, "score": 0, "last_activity_date": 1516168776, "creation_date": 1516168776, "answer_id": 48294486, "question_id": 48294314, "link": "https://stackoverflow.com/questions/48294314/how-to-use-ifndef-with-macro-argument/48294486#48294486", "title": "How to use #ifndef with macro argument?", "body": "<pre><code>#ifndef SWAP\n#define SWAP(a, b)  {a ^= b; b ^= a; a ^= b;}\n#endif\n</code></pre>\n\n<p>above change will work for c,c++11. probably it will work for all the versions of c++XX.</p>\n"}, {"tags": [], "owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "is_accepted": false, "score": 4, "last_activity_date": 1516170019, "last_edit_date": 1516170019, "creation_date": 1516169566, "answer_id": 48294653, "question_id": 48294314, "link": "https://stackoverflow.com/questions/48294314/how-to-use-ifndef-with-macro-argument/48294653#48294653", "title": "How to use #ifndef with macro argument?", "body": "<p>Before asking the question you could have looked into the standard to get an idea of how it is used.</p>\n\n<p>From standard - <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.10.1p5\" rel=\"nofollow noreferrer\"><strong>\u00a76.10.1p5</strong></a></p>\n\n<blockquote>\n  <p>Preprocessing directives of the forms</p>\n\n<pre><code># ifdef identifier new-line groupopt\n# ifndef identifier new-line groupopt\n</code></pre>\n  \n  <p>check whether <em>the identifier is or is not currently defined as a\n  <strong>macro name</em></strong>. Their conditions are equivalent to #if defined identifier and #if !defined identifier respectively.</p>\n</blockquote>\n\n<p>Then again if you are not sure what is the macro name and what are the parameters etc..</p>\n\n<p>From standard <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.10.3p10\" rel=\"nofollow noreferrer\"><strong>\u00a76.10.3.p10</strong></a></p>\n\n<blockquote>\n  <p>A preprocessing directive of the form</p>\n\n<pre><code># define identifier lparen identifier-listopt ) replacement-list new-line\n# define identifier lparen ... ) replacement-list new-line\n# define identifier lparen identifier-list , ... ) replacement-list new-line\n</code></pre>\n  \n  <p>defines a <em>function-like macro with parameters</em>, whose use is similar\n  syntactically to a function call. The parameters are specified by the\n  optional list of identifiers, whose scope extends from their\n  declaration in the identifier list until the new-line character that\n  terminates the #define preprocessing directive. <em>Each subsequent\n  instance of the function-like macro name followed by a <code>(</code> as the next\n  preprocessing token introduces the sequence of preprocessing tokens\n  that is replaced by the replacement list in the definition (an\n  invocation of the macro).</em>...</p>\n</blockquote>\n\n<p>The last section just will let you know enough what should be written in the <code>ifndef</code> in place of identifier. It is clear from the highlighted parts.</p>\n\n<p>In <code>C</code> you have to a considerable amount of work to write a generic and correct swap macro. For two same value your <code>swap</code> will not work as you expect it to. </p>\n"}, {"tags": [], "owner": {"reputation": 7407, "user_id": 1757805, "user_type": "registered", "accept_rate": 51, "profile_image": "https://i.stack.imgur.com/AMueI.jpg?s=128&g=1", "display_name": "Francis Cugler", "link": "https://stackoverflow.com/users/1757805/francis-cugler"}, "is_accepted": false, "score": 0, "last_activity_date": 1516171196, "last_edit_date": 1516171196, "creation_date": 1516170299, "answer_id": 48294802, "question_id": 48294314, "link": "https://stackoverflow.com/questions/48294314/how-to-use-ifndef-with-macro-argument/48294802#48294802", "title": "How to use #ifndef with macro argument?", "body": "<p>In the older days of C++ before safer smart pointers <code>std::shared_ptr&lt;T&gt;</code> &amp; <code>std::unique_ptr&lt;T&gt;</code> came around when using <code>new &amp; delete</code> &amp; <code>new [] &amp; delete []</code> these are some older macros that I once used in C++ for helping to manage memory.</p>\n\n<pre><code>#ifndef SAFE_DELETE\n    #define SAFE_DELETE(p)  { if(p) { delete (p); (p) = nullptr; } }\n#endif\n\n#ifndef SAFE_DELETE_ARRAY\n    #define SAFE_DELETE_ARRAY(p)    { if(p) { delete [] (p); (p) = nullptr; } }\n#endif \n</code></pre>\n\n<p>Similar to what you are trying to achieve: the design of these types of macros typically look to see if the <code>tag - identifier</code> is not yet defined. If it isn't then you define the name along with its parameter and functionality, then you end the if definition. Also as a side note when working with macros it may seem like over doing it but it is always advisable to enclose each parameter name in parenthesis. So in your case you would want something like:</p>\n\n<pre><code>#ifndef SWAP\n    #define SWAP(a, b)  if ( (a) != (b) ) { \\\n                            ((a) ^= (b));   \\\n                            ((b) ^= (a));   \\\n                            ((a) ^= (b));   \\\n                        } else {            \\ \n                            ((a) = (a));    \\\n                            ((b) = (b));    \\\n                        }                   \n#endif\n</code></pre>\n\n<p>Now the above macro is simplistic and it doesn't prevent from invalid types such as pointers, expressions, references etc., but it should work with any built in default basic types. </p>\n"}, {"comments": [{"owner": {"reputation": 7407, "user_id": 1757805, "user_type": "registered", "accept_rate": 51, "profile_image": "https://i.stack.imgur.com/AMueI.jpg?s=128&g=1", "display_name": "Francis Cugler", "link": "https://stackoverflow.com/users/1757805/francis-cugler"}, "edited": false, "score": 0, "creation_date": 1516170914, "post_id": 48294828, "comment_id": 83574493, "body": "Wow I really like your macro design! Looks very handy; yet why go through the trouble? Couldn&#39;t you achieve the same with a simple in place lambda? -rhetorical question- ..."}, {"owner": {"reputation": 7407, "user_id": 1757805, "user_type": "registered", "accept_rate": 51, "profile_image": "https://i.stack.imgur.com/AMueI.jpg?s=128&g=1", "display_name": "Francis Cugler", "link": "https://stackoverflow.com/users/1757805/francis-cugler"}, "edited": false, "score": 0, "creation_date": 1516171288, "post_id": 48294828, "comment_id": 83574639, "body": "I know that C lacks lambdas... It&#39;s been a really long time since I&#39;ve written anything in C probably 20 years... I can not remember but I thought C was &quot;lacking&quot; in macros too,... I know C doesn&#39;t have templates, nor classes only structs... and some of the same key words mean one thing in C but something different in C++. It might not be the macros, it could be namespaces that I was thinking of..."}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "reply_to_user": {"reputation": 7407, "user_id": 1757805, "user_type": "registered", "accept_rate": 51, "profile_image": "https://i.stack.imgur.com/AMueI.jpg?s=128&g=1", "display_name": "Francis Cugler", "link": "https://stackoverflow.com/users/1757805/francis-cugler"}, "edited": false, "score": 0, "creation_date": 1516171795, "post_id": 48294828, "comment_id": 83574843, "body": "@FrancisCugler: I am not clear what your point is, but the complexity in the macro I propose is there to resolve the 4 issues raised in my answer when the macro is used in C source, and use <code>std:swap</code> instead when C++ is detected."}, {"owner": {"reputation": 7407, "user_id": 1757805, "user_type": "registered", "accept_rate": 51, "profile_image": "https://i.stack.imgur.com/AMueI.jpg?s=128&g=1", "display_name": "Francis Cugler", "link": "https://stackoverflow.com/users/1757805/francis-cugler"}, "edited": false, "score": 0, "creation_date": 1516171932, "post_id": 48294828, "comment_id": 83574885, "body": "My apology; I&#39;m starting to lose train of thought as it&#39;s starting to get late where I&#39;ll be finishing up here within the next hour. My grammer - typing is bad right now so-to-speak - tongue-in-cheek..."}, {"owner": {"reputation": 7407, "user_id": 1757805, "user_type": "registered", "accept_rate": 51, "profile_image": "https://i.stack.imgur.com/AMueI.jpg?s=128&g=1", "display_name": "Francis Cugler", "link": "https://stackoverflow.com/users/1757805/francis-cugler"}, "edited": false, "score": 0, "creation_date": 1516172045, "post_id": 48294828, "comment_id": 83574929, "body": "My original statement was based on the fact that I don&#39;t typically write in C and that I mostly use C++..."}, {"owner": {"reputation": 7407, "user_id": 1757805, "user_type": "registered", "accept_rate": 51, "profile_image": "https://i.stack.imgur.com/AMueI.jpg?s=128&g=1", "display_name": "Francis Cugler", "link": "https://stackoverflow.com/users/1757805/francis-cugler"}, "edited": false, "score": 0, "creation_date": 1516172751, "post_id": 48294828, "comment_id": 83575282, "body": "I did learn something new about Macros that I either didn&#39;t know or long forgot as I do not typically use them, but that is about containing compound statements in a <code>do { ... } while(0)</code> loop."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1516179923, "post_id": 48294828, "comment_id": 83578943, "body": "The C macro is quite ugly - an inline function should be used instead.  Furthermore, C supports static assert, no need for ugly -1 array size tricks. Furthermore, the do while 0 trick is harmful as it allows coding styles that do not always use compound statements to exist. (That is, &quot;Please Mr. compiler, let me write the Apple goto fail bug, the most expensive bug in SW history&quot;.) Overall, use modern C programming instead of old tricks from the early 90s."}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1516180446, "post_id": 48294828, "comment_id": 83579241, "body": "@Lundin: I don&#39;t think a <code>static_assert</code> actually increases the clarity of the code here, just the clarity of the compile time error. I do call an <code>inline</code> function, but the size information must still be passed in, or the macro signature has to change to include the type. The primitive types can be inferred from <code>_Generic</code>, but that would still require writing a macro."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1516180931, "post_id": 48294828, "comment_id": 83579544, "body": "@jxh A _Generic would enforce you to implement a &quot;functor&quot; just as C++  would enforce you to implement some operator overloading, so I don&#39;t think that&#39;s ideal. Rather, the programmer should make a type-specific function such as <code>int_swap</code> and it should be inline."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1516181029, "post_id": 48294828, "comment_id": 83579619, "body": "(As a parenthesis, any macro would btw be problematic if both parameters point at the same address. In C this could be solved with <code>restrict</code> pointers, or alternatively by using memmove instead of memcpy.)"}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1516209271, "post_id": 48294828, "comment_id": 83598244, "body": "@Lundin: You make valid points, but just to give the alternate points of view: C macros are merely a tool in the C programmer&#39;s toolbox, and any tool can be abused. The coding style objection is curious, since <code>do</code>...<code>while(0)</code> just makes a macro behave syntactically like a <code>void</code> function call. Implementing type-specific functions fits <code>_Generic</code> usage, as <code>_Generic</code> allows you to dispatch to the right type-specific function."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1516260568, "post_id": 48294828, "comment_id": 83617174, "body": "@jxh The single purpose of using <code>do{ }while(0)</code> in a macro, rather than just <code>{ }</code>, is to bad allow coding styles like <code>if(x) MACRO(); else ...</code> to exist. It has no other purpose. Which is why <code>{ }</code> is preferable, to discourage a coding style that ultimately leads to Apple goto fail bugs."}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1516269212, "post_id": 48294828, "comment_id": 83622099, "body": "@Lundin: <code>do</code>...<code>while(0)</code> did not cause the goto fail bug. Buggy code did that. As I said, any tool can be abused. You shouldn&#39;t use syntax as an excuse for writing buggy code. If a coding style is important, make sure the code reviewers enforce it."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1516270168, "post_id": 48294828, "comment_id": 83622700, "body": "There is no doubt that the &quot;Apple goto fail&quot; was caused by a bad coding style. At the point where a certain coding style is blatantly dangerous, it is not a subjective matter of preference any longer. It is clear that a coding style without compound statements is dangerous and should not be used. This is why all well-known coding standards such as MISRA and CERT ban that style. And as I already explained, the whole purpose of the somewhat obscure <code>do { }  while(0)</code> trick, is to propagate for this bad and dangerous coding style. If you aren&#39;t using bad and dangerous style, you would use <code>{ }</code>."}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1516270394, "post_id": 48294828, "comment_id": 83622833, "body": "@Lundin: It doesn&#39;t prevent someone from leaving off the <code>;</code>."}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1516270545, "post_id": 48294828, "comment_id": 83622939, "body": "@Lundin: My point being, code reviewers (even the robotic kind) have to enforce good style. C syntax is just syntax."}], "tags": [], "owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "is_accepted": false, "score": 4, "last_activity_date": 1516303257, "last_edit_date": 1516303257, "creation_date": 1516170420, "answer_id": 48294828, "question_id": 48294314, "link": "https://stackoverflow.com/questions/48294314/how-to-use-ifndef-with-macro-argument/48294828#48294828", "title": "How to use #ifndef with macro argument?", "body": "<p>To briefly answer your question, it is as the other answers have already stated. The <code>#ifdef</code>/<code>#ifndef</code> conditional only cares about the macro identifier, so the arguments are not part of its syntax.</p>\n\n<p>However, your macro has a couple of weaknesses that should be addressed. First, note that using the XOR-operator for swapping, although a commonly taught trick to avoid using a temporary, fails if the two arguments are the same object. This is because the result of the first XOR would be 0, and the remaining XOR steps cannot recover the original value. Second, this version of the macro fails for pointer types, because XOR wants integral types. Third, the macro invokes the arguments multiple times, which will cause problems if the argument is an expression with side effects. Fourth, compound statements in a macro should be guarded by <code>do</code> .. <code>while (0)</code> to allow the macro to expand into a statement. This makes the macro syntactically cleaner, so that a semi-colon after it is not spurious.</p>\n\n<p>As explained in a separate answer, in C++, use <code>std::swap</code> instead of defining your own. Unfortunately, C does not provide a generic swapping utility function. However, it is not difficult to author a generic function:</p>\n\n<pre><code>static inline void swap_generic (void *a, void *b, void *t, size_t sz) {\n    if (a != b) {\n        memcpy(t, a, sz);\n        memcpy(a, b, sz);\n        memcpy(b, t, sz);\n    }\n}\n</code></pre>\n\n<p>Your macro could then invoke this function.</p>\n\n<pre><code>#ifndef SWAP\n# ifdef __cplusplus\n#  define SWAP(a, b) std::swap(a, b)\n# else\n#  define SWAP_ASSERT(X) _Static_assert(X, #X)\n#  if  __STDC_VERSION__ &lt; 201112L\n#   undef SWAP_ASSERT\n#   define SWAP_ASSERT(X) struct dummy\n#  endif\n#  define SWAP(a, b) do {                                \\\n       SWAP_ASSERT(sizeof(a) == sizeof(b));              \\\n       char t[sizeof(a) != sizeof(b) ? -1 : sizeof(a)];  \\\n       swap_generic(&amp;(a), &amp;(b), t, sizeof(a));           \\\n   } while (0)\n# endif\n#endif\n</code></pre>\n\n<p>Note how we use <code>std::swap</code> if C++ is detected.</p>\n\n<p>If you use a C compiler that supports the <code>typeof</code> extension, then the macro can be simplified greatly, since you do not need a generic swapping function.</p>\n\n<pre><code>#ifndef SWAP\n# ifdef __cplusplus\n#  define SWAP(a, b) std::swap(a, b)\n# else\n#  define SWAP(a, b) do {                      \\\n       typeof(a) *p = &amp;(a), *q = &amp;(b), t = *p; \\\n       *p = *q;                                \\\n       *q = t;                                 \\\n   } while (0)\n# endif\n#endif\n</code></pre>\n\n<p>Note that the <code>typeof</code> version promotes better type safety.</p>\n"}], "owner": {"reputation": 77, "user_id": 5575697, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/99e59715ea1228c7584652b452291f63?s=128&d=identicon&r=PG&f=1", "display_name": "A. Gupta", "link": "https://stackoverflow.com/users/5575697/a-gupta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3851, "favorite_count": 0, "answer_count": 6, "score": 4, "last_activity_date": 1516303257, "creation_date": 1516167868, "question_id": 48294314, "link": "https://stackoverflow.com/questions/48294314/how-to-use-ifndef-with-macro-argument", "title": "How to use #ifndef with macro argument?", "body": "<p>I have a simple code in header.h-</p>\n\n<pre><code>#define SWAP(a, b)  {a ^= b; b ^= a; a ^= b;} \n</code></pre>\n\n<p>This header.h is included in a code.c file, but my requirement is-\nI want SWAP to be checked first like-</p>\n\n<pre><code>#ifndef SWAP(a, b)\n#define SWAP(a, b)  {a ^= b; b ^= a; a ^= b;}\n#endif\n</code></pre>\n\n<p>Is this correct or I don't have to provide the argument to the first line?</p>\n"}, {"tags": ["javascript", "c", "ajax", "mongodb", "express"], "answers": [{"tags": [], "owner": {"reputation": 550, "user_id": 3518621, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bf3b0c525ec4ad5c29864f230486dea2?s=128&d=identicon&r=PG&f=1", "display_name": "cslrnr", "link": "https://stackoverflow.com/users/3518621/cslrnr"}, "is_accepted": true, "score": 1, "last_activity_date": 1516167249, "creation_date": 1516167249, "answer_id": 48294216, "question_id": 48294120, "link": "https://stackoverflow.com/questions/48294120/sending-data-from-javascript-to-mongo-through-c/48294216#48294216", "title": "Sending data from JavaScript to Mongo through C", "body": "<p>You could try using rabbitmq and it's c based client library for serialization from/to UI or Db </p>\n"}], "owner": {"reputation": 62, "user_id": 6680124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7c65342940ed8ad75613cc1b3636592?s=128&d=identicon&r=PG&f=1", "display_name": "manpozi", "link": "https://stackoverflow.com/users/6680124/manpozi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 28, "favorite_count": 0, "accepted_answer_id": 48294216, "answer_count": 1, "score": 0, "last_activity_date": 1516167249, "creation_date": 1516166717, "question_id": 48294120, "link": "https://stackoverflow.com/questions/48294120/sending-data-from-javascript-to-mongo-through-c", "title": "Sending data from JavaScript to Mongo through C", "body": "<p>I am currently using Express and its built in router functionality to send some data that is collected using a form to my mongodb instance. I would like to expand my project to do some heavy manipulation on the data before it reaches the mongo instance. </p>\n\n<p>As I would like my project to scale to possibly 1,000-10,000 data collections and manipulations per second, I thought that the best idea would be to do the manipulation on the server side in C. I am unsure if 1) this is the best approach and 2) how to even send data from my front-end to the C program? </p>\n\n<p>My initial research shows that I may be able to simple make an AJAX call to the C program; however, I am unable to find anyway of process a received AJAX call in C. Any help regarding the best approach to this problem would be greatly appreciated!</p>\n"}, {"tags": ["c", "scanf"], "comments": [{"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1516165602, "post_id": 48293922, "comment_id": 83572866, "body": "<code>scanf</code> is not good for <i>bad</i> input. It always looks only one character ahead. By the time it meets <code>s</code> it is already too late. Of course you could try something like capture the following character using a scan set if it is non-whitespace, and checking the return value, but I&#39;d suggest that you would look at the myriad duplicates about how to ensuring that a string is only an integer using <code>strtol</code>."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1516166434, "post_id": 48293922, "comment_id": 83573082, "body": "Use <code>getchar()</code> to read the offending non-numeric, then try <code>scanf(&quot;%d&quot;, &amp;val)==1</code> again."}, {"owner": {"reputation": 77, "user_id": 9174523, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/5d50839cf0362cfb81fffa4aedcefdf1?s=128&d=identicon&r=PG&f=1", "display_name": "novel", "link": "https://stackoverflow.com/users/9174523/novel"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1516167000, "post_id": 48293922, "comment_id": 83573218, "body": "@chux how would you use getchar() in the for loop?"}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1516167323, "post_id": 48293922, "comment_id": 83573314, "body": "Read documentation of <a href=\"http://en.cppreference.com/w/c/io/fscanf\" rel=\"nofollow noreferrer\">scanf</a>."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1516202109, "post_id": 48293922, "comment_id": 83593449, "body": "What should happen with input like  <code>&quot;123 456&quot;</code> or <code>&quot;123-456&quot;</code> ?"}, {"owner": {"reputation": 2382, "user_id": 987607, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/292c76bb4fd91cc23e2dadb982471d59?s=128&d=identicon&r=PG", "display_name": "Germano Massullo", "link": "https://stackoverflow.com/users/987607/germano-massullo"}, "edited": false, "score": 0, "creation_date": 1597759229, "post_id": 48293922, "comment_id": 112234686, "body": "Does this answer your question? <a href=\"https://stackoverflow.com/questions/26583717/how-to-scanf-only-integer\">How to scanf only integer?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1516202335, "post_id": 48294201, "comment_id": 83593623, "body": "@chux: I tried initially, but suppressed assignments are not included into the count returned by <code>scanf</code>. So, the version with <code>*</code> will return <code>1</code> even for <code>10ss</code> input, which is not what is needed in this case."}], "tags": [], "owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "is_accepted": false, "score": 4, "last_activity_date": 1516202456, "last_edit_date": 1516202456, "creation_date": 1516167127, "answer_id": 48294201, "question_id": 48293922, "link": "https://stackoverflow.com/questions/48293922/c-scanf-reading-integers/48294201#48294201", "title": "c: scanf reading integers", "body": "<p>You can try reading the next character and analyzing it. Something along the lines of</p>\n\n<pre><code>int n;\nchar c;\nfor (int i = 0; \n     (n = scanf(\"%d%c\", &amp;val, &amp;c)) == 1 || (n == 2 &amp;&amp; isspace(c)); \n     i++)\n  ...\n\n// Include into the test whatever characters you see as acceptable after a number \n</code></pre>\n\n<p>or, in an attempt to create something \"fancier\"</p>\n\n<pre><code>for (int i = 0; \n     scanf(\"%d%1[^ \\n\\t]\", &amp;val, (char[2]) { 0 }) == 1; \n     i++)\n  ...\n\n// Include into the `[^...]` set whatever characters you see as acceptable after a number \n</code></pre>\n\n<p>But in general you will probably run into limitations of <code>scanf</code> rather quickly. It is a better idea to read your input as a string and parse/analyze it afterwards.</p>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 0, "last_activity_date": 1516201763, "last_edit_date": 1516201763, "creation_date": 1516197140, "answer_id": 48302771, "question_id": 48293922, "link": "https://stackoverflow.com/questions/48293922/c-scanf-reading-integers/48302771#48302771", "title": "c: scanf reading integers", "body": "<blockquote>\n  <p>how do I rewrite it to ignore an <code>int</code> that's followed by other characters?</p>\n</blockquote>\n\n<p>The robust approach is to read a <em>line</em> with <code>fgets()</code> and then parse it.</p>\n\n<pre><code>// Returns\n//   1 on success\n//   0 on a line that fails\n//   EOF when end-of-file or input error occurs.\nint read_int(int *val) {\n  char buf[80];\n  if (fgets(buf, sizeof buf, stdin) == NULL) {\n    return EOF;\n  }\n  // Use sscanf or strtol to parse.\n  // sscanf is simpler, yet strtol has well defined overflow funcitonaitly\n  char sentinel;  // Place to store trailing junk\n  return sscanf(buf, \"%d %c\", val, &amp;sentinel) == 1;\n}\n\n\nfor (int i = 0; read_int(&amp;val) == 1; i++)\n</code></pre>\n\n<p>Additional code needed to detect excessively long lines.</p>\n"}], "owner": {"reputation": 77, "user_id": 9174523, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/5d50839cf0362cfb81fffa4aedcefdf1?s=128&d=identicon&r=PG&f=1", "display_name": "novel", "link": "https://stackoverflow.com/users/9174523/novel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3143, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1537832586, "creation_date": 1516165456, "question_id": 48293922, "link": "https://stackoverflow.com/questions/48293922/c-scanf-reading-integers", "title": "c: scanf reading integers", "body": "<p>This scanf statement will read in numbers from input like <code>10ss</code> as 10 - how do I rewrite it to ignore an int that's followed by other characters? If <code>10ss</code> is read, it should ignore it and stop the for loop.</p>\n\n<pre><code>for (int i = 0; scanf(\"%d\", &amp;val)==1; i++)\n</code></pre>\n"}, {"tags": ["c", "stack-overflow", "buffer-overflow"], "comments": [{"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 4, "creation_date": 1516164046, "post_id": 48293701, "comment_id": 83572420, "body": "Use a debugger. Provide the disassembly of the provided function. Undefined behaviour is <b>undefined</b>, so there is not much to discuss in terms of C code."}, {"owner": {"reputation": 1010, "user_id": 3508752, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/S4Ink.png?s=128&g=1", "display_name": "max_max_mir", "link": "https://stackoverflow.com/users/3508752/max-max-mir"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1516164704, "post_id": 48293701, "comment_id": 83572615, "body": "I just added the disassembly. I am using gdb, but not sure how to visualize the stack and see where the stack pointer is compared to the variable x."}, {"owner": {"reputation": 15118, "user_id": 7258538, "user_type": "registered", "profile_image": "https://graph.facebook.com/10102111546405895/picture?type=large", "display_name": "Charles Srstka", "link": "https://stackoverflow.com/users/7258538/charles-srstka"}, "edited": false, "score": 0, "creation_date": 1516164707, "post_id": 48293701, "comment_id": 83572616, "body": "You just posted this for the meta-ness of using the <code>stack-overflow</code> tag, didn&#39;t you. :-P"}, {"owner": {"reputation": 1010, "user_id": 3508752, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/S4Ink.png?s=128&g=1", "display_name": "max_max_mir", "link": "https://stackoverflow.com/users/3508752/max-max-mir"}, "edited": false, "score": 0, "creation_date": 1516164743, "post_id": 48293701, "comment_id": 83572624, "body": "Should it not be tagged stack-overflow? Happy to remove it if it&#39;s not helpful"}, {"owner": {"reputation": 15118, "user_id": 7258538, "user_type": "registered", "profile_image": "https://graph.facebook.com/10102111546405895/picture?type=large", "display_name": "Charles Srstka", "link": "https://stackoverflow.com/users/7258538/charles-srstka"}, "edited": false, "score": 0, "creation_date": 1516164757, "post_id": 48293701, "comment_id": 83572626, "body": "(joking, hence the :-P)"}, {"owner": {"reputation": 1010, "user_id": 3508752, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/S4Ink.png?s=128&g=1", "display_name": "max_max_mir", "link": "https://stackoverflow.com/users/3508752/max-max-mir"}, "edited": false, "score": 0, "creation_date": 1516164807, "post_id": 48293701, "comment_id": 83572638, "body": "Ah - sorry :). I have been struggling with this problem for a while now, so ...."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 1, "creation_date": 1516165117, "post_id": 48293701, "comment_id": 83572713, "body": "So, what does the <code>and</code> + <code>sub</code> do? Try it with different values of <code>esp</code>. For visualization I suggest using <i>a writing implement or art medium constructed of a narrow, solid pigment core inside a protective casing</i> to <i>draw</i> some kinds of markings on <i>a thin material produced by pressing together moist fibres of cellulose pulp derived from wood, rags or grasses, and drying them into flexible sheets.</i>"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1516165305, "post_id": 48293701, "comment_id": 83572773, "body": "Notice that the overflow does not happen in C. In C there is only undefined behaviour. Everything happens in machine code."}, {"owner": {"reputation": 1010, "user_id": 3508752, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/S4Ink.png?s=128&g=1", "display_name": "max_max_mir", "link": "https://stackoverflow.com/users/3508752/max-max-mir"}, "edited": false, "score": 0, "creation_date": 1516165393, "post_id": 48293701, "comment_id": 83572805, "body": "Thanks. I don&#39;t know how to read assembly code, so not sure what and + sub does, or how to try a different value of esp."}, {"owner": {"reputation": 1010, "user_id": 3508752, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/S4Ink.png?s=128&g=1", "display_name": "max_max_mir", "link": "https://stackoverflow.com/users/3508752/max-max-mir"}, "edited": false, "score": 0, "creation_date": 1516166819, "post_id": 48293701, "comment_id": 83573173, "body": "I am also note sure why this question was down voted."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 4, "creation_date": 1516169595, "post_id": 48293701, "comment_id": 83574020, "body": "If you don&#39;t know how to read/understand/write assembly, I don&#39;t think you can do anything useful with a Stack exploit ad this. I think you are starting from the wrong end. You should try to understand how machine languages work, how compilers generate code and how the operating system behaves when something &quot;bad&quot; happens."}, {"owner": {"reputation": 1422, "user_id": 4538770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adfd2f0b91001372439c7e23c60e4c52?s=128&d=identicon&r=PG", "display_name": "Jo&#235;l Hecht", "link": "https://stackoverflow.com/users/4538770/jo%c3%abl-hecht"}, "edited": false, "score": 0, "creation_date": 1516170260, "post_id": 48293701, "comment_id": 83574263, "body": "What do you mean by 5 As, 13 As and so on ? If it is an assembly line number it does not match your assembly code. Also you should remove all optimizations, it makes understand a &quot;C&quot; program by reading assembly much easy."}, {"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "reply_to_user": {"reputation": 1422, "user_id": 4538770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adfd2f0b91001372439c7e23c60e4c52?s=128&d=identicon&r=PG", "display_name": "Jo&#235;l Hecht", "link": "https://stackoverflow.com/users/4538770/jo%c3%abl-hecht"}, "edited": false, "score": 0, "creation_date": 1516190477, "post_id": 48293701, "comment_id": 83585731, "body": "@Jo&#235;lHecht: that&#39;s OP&#39;s &quot;when I enter &quot;AAAAA&quot; <i>as input</i>&quot; with <code>gets</code> in the way too small char array <code>x</code>."}], "answers": [{"comments": [{"owner": {"reputation": 1010, "user_id": 3508752, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/S4Ink.png?s=128&g=1", "display_name": "max_max_mir", "link": "https://stackoverflow.com/users/3508752/max-max-mir"}, "edited": false, "score": 0, "creation_date": 1516215858, "post_id": 48300613, "comment_id": 83601830, "body": "Thank you! Would you mind explaining #1 in a bit more detail. How do I find out how the stack is set up? So does 16 byte right aligned mean that every stack cell is 16 bytes long? So even if I declare a 1 byte char variable, the OS uses 16 bytes to store it? Also, why is where the return address saved not deterministic?"}, {"owner": {"reputation": 141, "user_id": 9164688, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Av6im.png?s=128&g=1", "display_name": "j31d0", "link": "https://stackoverflow.com/users/9164688/j31d0"}, "reply_to_user": {"reputation": 1010, "user_id": 3508752, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/S4Ink.png?s=128&g=1", "display_name": "max_max_mir", "link": "https://stackoverflow.com/users/3508752/max-max-mir"}, "edited": false, "score": 0, "creation_date": 1516238212, "post_id": 48300613, "comment_id": 83610708, "body": "First, you can guess the stack address based on x64 ABI (when call instruction executes, at that time stack must be 16-byte aligned), but It isn&#39;t always right because of optimization by compiler or something.  stack align means rsp should be multiple of number (in this case, 16). Your declared variable is not related about stack alignment. It is done (maybe) because you called function in main - then by ABI, rsp must be multiple of 16 at call instruction."}, {"owner": {"reputation": 141, "user_id": 9164688, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Av6im.png?s=128&g=1", "display_name": "j31d0", "link": "https://stackoverflow.com/users/9164688/j31d0"}, "reply_to_user": {"reputation": 1010, "user_id": 3508752, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/S4Ink.png?s=128&g=1", "display_name": "max_max_mir", "link": "https://stackoverflow.com/users/3508752/max-max-mir"}, "edited": false, "score": 0, "creation_date": 1516238398, "post_id": 48300613, "comment_id": 83610756, "body": "also there are no reason for saved return address to be deterministic. compiler makes code to satisfy ABI, and non-deterministic behavior for saved return address is just side effect."}], "tags": [], "owner": {"reputation": 141, "user_id": 9164688, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Av6im.png?s=128&g=1", "display_name": "j31d0", "link": "https://stackoverflow.com/users/9164688/j31d0"}, "is_accepted": true, "score": 1, "last_activity_date": 1516190231, "creation_date": 1516190231, "answer_id": 48300613, "question_id": 48293701, "link": "https://stackoverflow.com/questions/48293701/c-stack-buffer-overflow/48300613#48300613", "title": "C Stack Buffer Overflow", "body": "<ol>\n<li>the stack is 16-byte aligned right after the main function executed ( at line 3 ). so you cannot just calculate exact address for saved return address, you can just try from 5 bytes to 21 bytes.</li>\n<li>Illegal instruction is such bytes which didn't match with any defined instruction. every instruction is represented in machine code (Ex: push ebp is 0x55 , etc) but for example, 0xff 0xff is not matched with any instruction in x86 machine. but segmentation fault is occured when any memory access is invalid.</li>\n</ol>\n"}], "owner": {"reputation": 1010, "user_id": 3508752, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/S4Ink.png?s=128&g=1", "display_name": "max_max_mir", "link": "https://stackoverflow.com/users/3508752/max-max-mir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 571, "favorite_count": 0, "accepted_answer_id": 48300613, "answer_count": 1, "score": -3, "last_activity_date": 1516190231, "creation_date": 1516163943, "last_edit_date": 1516164520, "question_id": 48293701, "link": "https://stackoverflow.com/questions/48293701/c-stack-buffer-overflow", "title": "C Stack Buffer Overflow", "body": "<p>I am trying to replicate a stack buffer overflow. This is my code</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(int argc, char *argv[]) {\n  char x[1];\n  gets(x);\n  printf(\"%s\\n\", x);\n}\n</code></pre>\n\n<p>I am compiling this on a 32 bit machine, which means each memory address is 4 bytes long. Since each character is 1 byte (verified using sizeof), I am expecting a stack buffer overflow when I enter \"AAAAA\" as input (1 byte more than what x can hold). However, nothing happens till I enter 13 As, at which point I get an \"Illegal Instruction\" error. 14 As results in a \"Segmentation fault\". </p>\n\n<p>Questions</p>\n\n<ol>\n<li>Why am I not getting a segmentation fault at 5 As?</li>\n<li>What is the difference between Illegal Instruction and Segmentation Fault?</li>\n<li>What is a good tool (other than gdb) to visualize the stack? </li>\n</ol>\n\n<p>I've looked at <a href=\"https://stackoverflow.com/questions/30366966/trouble-replicating-a-stack-buffer-overflow-exploit\">Trouble replicating a stack buffer overflow exploit</a>, but I had trouble understanding the answer.</p>\n\n<p>Here's my assembly dump:</p>\n\n<pre><code>(gdb) disassemble main\nDump of assembler code for function main:\n   0x0804844d &lt;+0&gt;: push   %ebp\n   0x0804844e &lt;+1&gt;: mov    %esp,%ebp\n   0x08048450 &lt;+3&gt;: and    $0xfffffff0,%esp\n   0x08048453 &lt;+6&gt;: sub    $0x20,%esp\n   0x08048456 &lt;+9&gt;: lea    0x1f(%esp),%eax\n   0x0804845a &lt;+13&gt;:    mov    %eax,(%esp)\n   0x0804845d &lt;+16&gt;:    call   0x8048310 &lt;gets@plt&gt;\n=&gt; 0x08048462 &lt;+21&gt;:    lea    0x1f(%esp),%eax\n   0x08048466 &lt;+25&gt;:    mov    %eax,(%esp)\n   0x08048469 &lt;+28&gt;:    call   0x8048320 &lt;puts@plt&gt;\n   0x0804846e &lt;+33&gt;:    leave  \n   0x0804846f &lt;+34&gt;:    ret    \nEnd of assembler dump.\n</code></pre>\n"}, {"tags": ["c", "arrays", "mpi"], "comments": [{"owner": {"reputation": 7287, "user_id": 8062491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rd6rD.png?s=128&g=1", "display_name": "Gilles Gouaillardet", "link": "https://stackoverflow.com/users/8062491/gilles-gouaillardet"}, "edited": false, "score": 0, "creation_date": 1516162445, "post_id": 48293446, "comment_id": 83571975, "body": "if <b>only one</b> task should receive some extra cells, a simpler alternative is to <code>MPI_Scatter(5 cells)</code> followed by the root task sending the extra cell(s) to the special task.."}, {"owner": {"reputation": 7287, "user_id": 8062491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rd6rD.png?s=128&g=1", "display_name": "Gilles Gouaillardet", "link": "https://stackoverflow.com/users/8062491/gilles-gouaillardet"}, "edited": false, "score": 0, "creation_date": 1516162542, "post_id": 48293446, "comment_id": 83572002, "body": "if <code>root==0</code> and the root task should get more cells, you can <code>MPI_Scatter(items+1, 5 cells)</code>"}, {"owner": {"reputation": 1436, "user_id": 2154359, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/cbcb885163f3112cbd223bdd88651471?s=128&d=identicon&r=PG", "display_name": "xmen-5", "link": "https://stackoverflow.com/users/2154359/xmen-5"}, "reply_to_user": {"reputation": 7287, "user_id": 8062491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rd6rD.png?s=128&g=1", "display_name": "Gilles Gouaillardet", "link": "https://stackoverflow.com/users/8062491/gilles-gouaillardet"}, "edited": false, "score": 0, "creation_date": 1516162678, "post_id": 48293446, "comment_id": 83572032, "body": "sorry i didn&#39;t get your idea, just to note the number of processor and the size of the array is known only when the program is executed.the user choose the size and the number of processor."}, {"owner": {"reputation": 1436, "user_id": 2154359, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/cbcb885163f3112cbd223bdd88651471?s=128&d=identicon&r=PG", "display_name": "xmen-5", "link": "https://stackoverflow.com/users/2154359/xmen-5"}, "reply_to_user": {"reputation": 7287, "user_id": 8062491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rd6rD.png?s=128&g=1", "display_name": "Gilles Gouaillardet", "link": "https://stackoverflow.com/users/8062491/gilles-gouaillardet"}, "edited": false, "score": 0, "creation_date": 1516162806, "post_id": 48293446, "comment_id": 83572067, "body": "do you mean that for the last processor i shoud send him the chanks two times? 5 cells for the first message and the extra extra cells for the second message?"}, {"owner": {"reputation": 7287, "user_id": 8062491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rd6rD.png?s=128&g=1", "display_name": "Gilles Gouaillardet", "link": "https://stackoverflow.com/users/8062491/gilles-gouaillardet"}, "edited": false, "score": 0, "creation_date": 1516163011, "post_id": 48293446, "comment_id": 83572134, "body": "the 5 chunks are received by <code>MPI_Scatter()</code> and the remaining cell is received by <code>MPI_Recv()</code>. i would not call <code>MPI_Scatter()</code> a message, so let&#39;s say the chunks are received in two phases."}, {"owner": {"reputation": 1436, "user_id": 2154359, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/cbcb885163f3112cbd223bdd88651471?s=128&d=identicon&r=PG", "display_name": "xmen-5", "link": "https://stackoverflow.com/users/2154359/xmen-5"}, "reply_to_user": {"reputation": 7287, "user_id": 8062491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rd6rD.png?s=128&g=1", "display_name": "Gilles Gouaillardet", "link": "https://stackoverflow.com/users/8062491/gilles-gouaillardet"}, "edited": false, "score": 0, "creation_date": 1516163285, "post_id": 48293446, "comment_id": 83572219, "body": "so for the last processor i should have two buffer for upcoming data , is that a good idea?I mean the best way is to have only one buffer receiving that upcoming data.do you have any idea?another problee is i would like to return the buffer to the master processor ,will it be complicated with  Mpi_gather ?"}, {"owner": {"reputation": 1436, "user_id": 2154359, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/cbcb885163f3112cbd223bdd88651471?s=128&d=identicon&r=PG", "display_name": "xmen-5", "link": "https://stackoverflow.com/users/2154359/xmen-5"}, "reply_to_user": {"reputation": 7287, "user_id": 8062491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rd6rD.png?s=128&g=1", "display_name": "Gilles Gouaillardet", "link": "https://stackoverflow.com/users/8062491/gilles-gouaillardet"}, "edited": false, "score": 0, "creation_date": 1516163635, "post_id": 48293446, "comment_id": 83572305, "body": "i edited my question to clear things ; thank you"}, {"owner": {"reputation": 7287, "user_id": 8062491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rd6rD.png?s=128&g=1", "display_name": "Gilles Gouaillardet", "link": "https://stackoverflow.com/users/8062491/gilles-gouaillardet"}, "edited": false, "score": 0, "creation_date": 1516164244, "post_id": 48293446, "comment_id": 83572479, "body": "no need for two buffers. simply allocate a larger buffer on the last task, and <code>MPI_Recv()</code> at the 5th element (since you <code>MPI_Scatter()</code> 5 elements). Things would be much easier if you let <code>rank=0</code> handle extra elements (in that case, simply offset the send buffer)"}, {"owner": {"reputation": 7287, "user_id": 8062491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rd6rD.png?s=128&g=1", "display_name": "Gilles Gouaillardet", "link": "https://stackoverflow.com/users/8062491/gilles-gouaillardet"}, "edited": false, "score": 0, "creation_date": 1516165535, "post_id": 48293446, "comment_id": 83572850, "body": "to be complete, if rank zero should have the extra cells, <code>MPI_IN_PLACE</code> has to be used."}], "owner": {"reputation": 1436, "user_id": 2154359, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/cbcb885163f3112cbd223bdd88651471?s=128&d=identicon&r=PG", "display_name": "xmen-5", "link": "https://stackoverflow.com/users/2154359/xmen-5"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 109, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1516164175, "creation_date": 1516162104, "last_edit_date": 1516164175, "question_id": 48293446, "link": "https://stackoverflow.com/questions/48293446/processing-a-two-dimentional-array-with-mpi-scatter-and-mpi-gather", "title": "processing a two dimentional array with MPI_Scatter and MPI_Gather", "body": "<p>I'm trying to learn Mpi throught some examples.</p>\n\n<p>After reading some  discutions about manipulating arrays with mpi , i saw that  the cells in two dimentional array are not contigous in memory ; So it could make the things harder.</p>\n\n<p>supposing my 2d array is as follows :</p>\n\n<pre><code>1111\n2222\n3333\n4444\n</code></pre>\n\n<p>I saw in one example that there is another way for allocating memory for a two dimentional array :</p>\n\n<pre><code>   int  *items = ( int *) malloc(rows * cols * sizeof(*items));\n</code></pre>\n\n<p>with the instruction above and  would be presented in memory as follows:</p>\n\n<p><code>111122223334444</code>.</p>\n\n<p>My question is: how i can send a portion of the array to each processor, i know that there are many ways like  MPI_Scatter,but it's only for the same chunks size.</p>\n\n<p>As an example I want to execute my program on n processors(let n=3) ,each processor will get the length of the array divided by 3 ;</p>\n\n<p>in my example 16/3 = 5 celles for each processor:</p>\n\n<pre><code>11112  rank= 0\n22233  rank= 1\n334444 rank= 2\n</code></pre>\n\n<p>as we see the last processor will get a different size.</p>\n\n<p>i saw that we can define our custom MPI_Scatter method with MPI_Scatterv but i'm wondering if there is a simple way to do that?</p>\n\n<p>sending m chunks to every processor and the last processor could get a different size;i'm speaking only for the case where the last processor could get a different chunk size.</p>\n\n<p><strong>So</strong> my 3 processors has to do some calculation on the received data and they should return the modified buffer ,how i could use  MPI_Gather in this senario?</p>\n\n<p>My processors should increment the values in the received buffer </p>\n\n<pre><code>22223  rank= 0\n33344  rank= 1\n445555 rank= 2\n</code></pre>\n\n<p><strong>-</strong> how can i return the received  buffer  to the master processor?</p>\n\n<p>Any help will be very welcomed.</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 1, "creation_date": 1516156361, "post_id": 48292727, "comment_id": 83570647, "body": "I think it&#39;s the <code>&amp;(students+i)-&gt;name</code> in <code>scanf</code>. That gives the <i>address of the pointer</i> as the parameter, not the <i>address of the memory to store the name</i>."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1516156395, "post_id": 48292727, "comment_id": 83570655, "body": "<code>scanf(&quot; %s&quot;,&amp;(students+i)-&gt;name);</code> --&gt; <code>scanf(&quot; %s&quot;,(students+i)-&gt;name);</code> or <code>scanf(&quot; %s&quot;, students[i].name);</code>"}, {"owner": {"reputation": 2287, "user_id": 5267751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd62e8fd8fbb37abc7e2a39d23828047?s=128&d=identicon&r=PG&f=1", "display_name": "user202729", "link": "https://stackoverflow.com/users/5267751/user202729"}, "edited": false, "score": 0, "creation_date": 1516156423, "post_id": 48292727, "comment_id": 83570665, "body": "&quot;Avoid answering questions in comments.&quot;"}, {"owner": {"reputation": 25, "user_id": 4267032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/432abe2568c70786e7d1da3ec837f2db?s=128&d=identicon&r=PG&f=1", "display_name": "Jaspar", "link": "https://stackoverflow.com/users/4267032/jaspar"}, "edited": false, "score": 0, "creation_date": 1516156572, "post_id": 48292727, "comment_id": 83570697, "body": "It worked , thank you both!"}, {"owner": {"reputation": 25, "user_id": 4267032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/432abe2568c70786e7d1da3ec837f2db?s=128&d=identicon&r=PG&f=1", "display_name": "Jaspar", "link": "https://stackoverflow.com/users/4267032/jaspar"}, "edited": false, "score": 0, "creation_date": 1516156867, "post_id": 48292727, "comment_id": 83570752, "body": "The program works fine now , but if i change this command scanf(&quot;%d&quot;,&amp;(students+i)-&gt;grade); to scanf(&quot;%d&quot;,(students+i)-&gt;grade); it crashes , just for learning purposes could anyone explain why?"}, {"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "reply_to_user": {"reputation": 2287, "user_id": 5267751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd62e8fd8fbb37abc7e2a39d23828047?s=128&d=identicon&r=PG&f=1", "display_name": "user202729", "link": "https://stackoverflow.com/users/5267751/user202729"}, "edited": false, "score": 0, "creation_date": 1516156952, "post_id": 48292727, "comment_id": 83570764, "body": "@user202729 I wasn&#39;t sure that was the case and I hadn&#39;t checked, which is why I put it in the comments. I like to reserve answers for when I&#39;m more confident."}, {"owner": {"reputation": 2287, "user_id": 5267751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd62e8fd8fbb37abc7e2a39d23828047?s=128&d=identicon&r=PG&f=1", "display_name": "user202729", "link": "https://stackoverflow.com/users/5267751/user202729"}, "edited": false, "score": 0, "creation_date": 1516157282, "post_id": 48292727, "comment_id": 83570842, "body": "... why downvote? Is this too easy? I don&#39;t think this can be searched at all, although the question as-is is not too useful to be searched. The asker does show their code, and when it crashes, what&#39;s the problem?"}], "answers": [{"comments": [{"owner": {"reputation": 550, "user_id": 3518621, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bf3b0c525ec4ad5c29864f230486dea2?s=128&d=identicon&r=PG&f=1", "display_name": "cslrnr", "link": "https://stackoverflow.com/users/3518621/cslrnr"}, "edited": false, "score": 0, "creation_date": 1516161033, "post_id": 48292947, "comment_id": 83571647, "body": "Don&#39;t forget to free the memory you have allocated for char* / struct * , or it will lead to memleak"}, {"owner": {"reputation": 2287, "user_id": 5267751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd62e8fd8fbb37abc7e2a39d23828047?s=128&d=identicon&r=PG&f=1", "display_name": "user202729", "link": "https://stackoverflow.com/users/5267751/user202729"}, "reply_to_user": {"reputation": 550, "user_id": 3518621, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bf3b0c525ec4ad5c29864f230486dea2?s=128&d=identicon&r=PG&f=1", "display_name": "cslrnr", "link": "https://stackoverflow.com/users/3518621/cslrnr"}, "edited": false, "score": 0, "creation_date": 1516162124, "post_id": 48292947, "comment_id": 83571891, "body": "@cslrnr Thanks, added."}, {"owner": {"reputation": 25, "user_id": 4267032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/432abe2568c70786e7d1da3ec837f2db?s=128&d=identicon&r=PG&f=1", "display_name": "Jaspar", "link": "https://stackoverflow.com/users/4267032/jaspar"}, "edited": false, "score": 0, "creation_date": 1516169266, "post_id": 48292947, "comment_id": 83573912, "body": "Super answer!Thanks , much apreciated!"}], "tags": [], "owner": {"reputation": 2287, "user_id": 5267751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd62e8fd8fbb37abc7e2a39d23828047?s=128&d=identicon&r=PG&f=1", "display_name": "user202729", "link": "https://stackoverflow.com/users/5267751/user202729"}, "is_accepted": true, "score": 1, "last_activity_date": 1516162101, "last_edit_date": 1516162101, "creation_date": 1516158120, "answer_id": 48292947, "question_id": 48292727, "link": "https://stackoverflow.com/questions/48292727/struct-pointer-contains-pointer-to-char-string-how-to-allocate-memory-for-it/48292947#48292947", "title": "Struct pointer contains pointer to char (string) , how to allocate memory for it?", "body": "<p>Some of the correct ways to call C <code>scanf</code> function are:</p>\n\n<pre><code>scanf(\"%d\", int*)\nscanf(\"%s\", char*)\n</code></pre>\n\n<p>This is incorrect:</p>\n\n<pre><code>scanf(\"%s\", char**)\n</code></pre>\n\n<p>Consider the working code:</p>\n\n<pre><code>int grade;\nchar name [50];\nscanf(\"%d\", &amp;grade);\nscanf(\"%s\", name);\n</code></pre>\n\n<p>Here <code>grade</code> is an <code>int</code> variable, so <code>&amp;grade</code> is the pointer to a <code>int</code> variable, having type <code>int*</code>. So this is correct.</p>\n\n<p><code>name</code> is an array of <code>char</code>, when passed to <code>scanf</code> it decays to a <code>char</code> pointer (type <code>char*</code>) point to the first element of the array. So this is also correct.</p>\n\n<pre><code>char name [50];\nscanf(\"%s\", &amp;name);\n</code></pre>\n\n<p><code>&amp;name</code> is a pointer to an array of <code>50</code> <code>char</code>s, having type <code>char(*)[50]</code>, so technically this is incorrect, but it happens to work because the pointer have the same value as <code>&amp;name[0]</code> or <code>(char*) name</code>.</p>\n\n<pre><code>struct a { int x; int y; };\na b;\nscanf(\"%d\", &amp;b);\n</code></pre>\n\n<p>This code is also wrong, but happens to work because <code>&amp;b</code> have the same value (most of the time) as <code>&amp;b.x</code>, so the code will have identical functionality to</p>\n\n<pre><code>scanf(\"%d\", &amp;b.x);\n</code></pre>\n\n<p>although the pointer types are different. Don't rely on the behavior, anyway.</p>\n\n<pre><code>int grade;\nscanf(\"%d\", grade);\n</code></pre>\n\n<p>This crashes because <code>grade</code> is not a pointer to a <code>int</code>.</p>\n\n<p>Now consider dynamically allocated array (of course, remember to call <code>free(name)</code> when you've done using it).</p>\n\n<pre><code>char* name;\nname = (char*) malloc(50 * sizeof(char));\n</code></pre>\n\n<p>Consider using <code>calloc</code> instead. But anyway, in this case, <code>name</code> is a <code>char</code> pointer that point to the first byte of the allocated memory. So</p>\n\n<pre><code>scanf(\"%s\", name)\n</code></pre>\n\n<p>is correct, because <code>name</code> is a <code>char*</code> pointing to the allocated memory, as I said above.</p>\n\n<pre><code>scanf(\"%s\", &amp;name)\n</code></pre>\n\n<p><code>&amp;name</code> is the pointer to the char pointer <code>name</code>, having type <code>char**</code>. Incorrect.</p>\n\n<hr>\n\n<p>In conclusion, use <code>&amp;</code> wisely. Don't stick to the pattern <code>scanf(\"format\", &amp;variables)</code>.</p>\n\n<hr>\n\n<p>Unrelated note: Don't use <code>(students+i)-&gt;name</code>, use <code>students[i].name</code> instead. It's much clearer.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 4052661, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZik.jpg?s=128&g=1", "display_name": "David R", "link": "https://stackoverflow.com/users/4052661/david-r"}, "is_accepted": false, "score": 0, "last_activity_date": 1516242150, "creation_date": 1516242150, "answer_id": 48312874, "question_id": 48292727, "link": "https://stackoverflow.com/questions/48292727/struct-pointer-contains-pointer-to-char-string-how-to-allocate-memory-for-it/48312874#48312874", "title": "Struct pointer contains pointer to char (string) , how to allocate memory for it?", "body": "<p>Firstly, remove the '&amp;' in the scanf(\" %s\" &amp;(students+i)->name)\nThis is because it is already a pointer, and the '&amp;' makes it a pointer to a pointer when it asks for just a pointer. After adding this change it works fine for me.</p>\n"}], "owner": {"reputation": 25, "user_id": 4267032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/432abe2568c70786e7d1da3ec837f2db?s=128&d=identicon&r=PG&f=1", "display_name": "Jaspar", "link": "https://stackoverflow.com/users/4267032/jaspar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "accepted_answer_id": 48292947, "answer_count": 2, "score": 0, "last_activity_date": 1516242150, "creation_date": 1516156000, "last_edit_date": 1516156216, "question_id": 48292727, "link": "https://stackoverflow.com/questions/48292727/struct-pointer-contains-pointer-to-char-string-how-to-allocate-memory-for-it", "title": "Struct pointer contains pointer to char (string) , how to allocate memory for it?", "body": "<p>Excuse my english , my program crashes as it is , but when i change the struct member <code>*name</code> (string) to <code>name[50]</code> and remove the command <code>(students+i)-&gt;name = (char*)malloc(50 * sizeof(char));</code>  the program works fine , so i guess the problem is that i do something wrong when dynamically allocating memory for each name.  </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nstruct student\n{\n    char *name;\n    int grade;\n};\n\nint main()\n{\n    int student_number = 0,i;\n    struct student *students = NULL;\n\n    printf(\"Give the number of students: \");\n    scanf(\"%d\",&amp;student_number);\n\n    students = (struct student*)malloc(student_number * sizeof(struct student));\n\n    for(i=0;i&lt;student_number;i++)\n    {\n        (students+i)-&gt;name = (char*)malloc(50 * sizeof(char));\n\n        system(\"CLS\");\n\n        printf(\"Give the name of student no. %d: \",i+1);\n        scanf(\" %s\",&amp;(students+i)-&gt;name);\n        printf(\"Give the grade of student no. %d: \",i+1);\n        scanf(\"%d\",&amp;(students+i)-&gt;grade);\n    }\n\n    system(\"CLS\");\n\n    for(i=0;i&lt;student_number;i++)\n    {\n        printf(\"%d. %s %d\\n\",i+1,(students+i)-&gt;name,(students+i)-&gt;grade);\n    }\n\n    system(\"PAUSE\");\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "macos", "qt", "osx-snow-leopard"], "comments": [{"owner": {"reputation": 1858, "user_id": 599484, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/38907a1ff475a70dc71663370685a1a1?s=128&d=identicon&r=PG", "display_name": "fyngyrz", "link": "https://stackoverflow.com/users/599484/fyngyrz"}, "reply_to_user": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1516151591, "post_id": 48292163, "comment_id": 83569648, "body": "@Pablo... hmm. I can&#39;t tell if you&#39;re trolling or just confused. In any case, the answer is <b>yes.</b> I am writing, generally, in C++. I can drop back to c anytime, of course, so I can use either approach. Does that answer your question?"}, {"owner": {"reputation": 48820, "user_id": 182676, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/446fa39e5f227c92db408e1b68356b5e?s=128&d=identicon&r=PG", "display_name": "Macmade", "link": "https://stackoverflow.com/users/182676/macmade"}, "edited": false, "score": 0, "creation_date": 1516151687, "post_id": 48292163, "comment_id": 83569681, "body": "No time to write a proper answer. Search for gestalt..."}, {"owner": {"reputation": 1858, "user_id": 599484, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/38907a1ff475a70dc71663370685a1a1?s=128&d=identicon&r=PG", "display_name": "fyngyrz", "link": "https://stackoverflow.com/users/599484/fyngyrz"}, "edited": false, "score": 0, "creation_date": 1516152407, "post_id": 48292163, "comment_id": 83569850, "body": "gestalt has been deprecated as of 10.8, so I&#39;m worried about using it"}, {"owner": {"reputation": 3108, "user_id": 4641116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gc52U.png?s=128&g=1", "display_name": "Eljay", "link": "https://stackoverflow.com/users/4641116/eljay"}, "edited": false, "score": 0, "creation_date": 1516153442, "post_id": 48292163, "comment_id": 83570087, "body": "Dup of <a href=\"https://stackoverflow.com/questions/11072804/how-do-i-determine-the-os-version-at-runtime-in-os-x-or-ios-without-using-gesta\" title=\"how do i determine the os version at runtime in os x or ios without using gesta\">stackoverflow.com/questions/11072804/&hellip;</a> ... have to use a combination of old and new if you need to go back to 10.6."}, {"owner": {"reputation": 21298, "user_id": 309425, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/75a67cd9a3d7367a6e594fcbe5e41400?s=128&d=identicon&r=PG", "display_name": "JWWalker", "link": "https://stackoverflow.com/users/309425/jwwalker"}, "edited": false, "score": 0, "creation_date": 1516153495, "post_id": 48292163, "comment_id": 83570099, "body": "I don&#39;t think there is single approach that will be undeprecated and yet work back to OS 10.6.  Of course, deprecated doesn&#39;t mean it&#39;s definitely going away soon.  Gestalt is still in the 10.13 SDK."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1516154024, "post_id": 48292163, "comment_id": 83570216, "body": "OP does not actually need a method that \u201cworks\u201d back to 10.6. Per the question, what they really need to know is whether they are on 10.12 or not. Thus, a call that returned the version number for recent versions but returned an error indication for older versions would suffice. (Incidentally, have you tested all versions of 10.12, such as 10.12.6? Did you <a href=\"http://bugreport.apple.com\" rel=\"nofollow noreferrer\">report the problems to Apple</a>?)"}, {"owner": {"reputation": 1858, "user_id": 599484, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/38907a1ff475a70dc71663370685a1a1?s=128&d=identicon&r=PG", "display_name": "fyngyrz", "link": "https://stackoverflow.com/users/599484/fyngyrz"}, "edited": false, "score": 0, "creation_date": 1516154876, "post_id": 48292163, "comment_id": 83570366, "body": "Eric, yes, I reported the problem when 10.12 initially came out. The problem&#39;s been there for all versions of 10.12, and none of the previous versions back to 10.6... you&#39;re right, I think what i need to know is 10.12 and later; faster machines make the &quot;native&quot; mode reasonable to use. It would be nice, of course, to be able to generally know what version the OS was... I&#39;m astonished there isn&#39;t an obvious set of calls for this. But there you go."}, {"owner": {"reputation": 1858, "user_id": 599484, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/38907a1ff475a70dc71663370685a1a1?s=128&d=identicon&r=PG", "display_name": "fyngyrz", "link": "https://stackoverflow.com/users/599484/fyngyrz"}, "reply_to_user": {"reputation": 3108, "user_id": 4641116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gc52U.png?s=128&g=1", "display_name": "Eljay", "link": "https://stackoverflow.com/users/4641116/eljay"}, "edited": false, "score": 0, "creation_date": 1516155146, "post_id": 48292163, "comment_id": 83570423, "body": "@Eljay, if you don&#39;t know what version of the OS you are running on, how are you to decide what API to use? The page you link to is unclear about an actual atomic solution to the problem that is workable with 10.6 and forward."}, {"owner": {"reputation": 3108, "user_id": 4641116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gc52U.png?s=128&g=1", "display_name": "Eljay", "link": "https://stackoverflow.com/users/4641116/eljay"}, "edited": false, "score": 0, "creation_date": 1516159197, "post_id": 48292163, "comment_id": 83571226, "body": "@fyngyrz \u2022 test to see if the newer routine exists, if it does use it, otherwise fall back to the older routine."}, {"owner": {"reputation": 1858, "user_id": 599484, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/38907a1ff475a70dc71663370685a1a1?s=128&d=identicon&r=PG", "display_name": "fyngyrz", "link": "https://stackoverflow.com/users/599484/fyngyrz"}, "reply_to_user": {"reputation": 3108, "user_id": 4641116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gc52U.png?s=128&g=1", "display_name": "Eljay", "link": "https://stackoverflow.com/users/4641116/eljay"}, "edited": false, "score": 0, "creation_date": 1516192646, "post_id": 48292163, "comment_id": 83587126, "body": "@Eljay, how does one test if an API routine exists from c or c++?"}, {"owner": {"reputation": 3108, "user_id": 4641116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gc52U.png?s=128&g=1", "display_name": "Eljay", "link": "https://stackoverflow.com/users/4641116/eljay"}, "edited": false, "score": 0, "creation_date": 1516194398, "post_id": 48292163, "comment_id": 83588237, "body": "@fyngyrz \u2022 you can&#39;t do it from C or C++ (afaik).  You&#39;ll have to use the Objective-C way of detecting if a method exists.  In Objective-C, you use <a href=\"https://stackoverflow.com/questions/2732863/check-if-a-method-exists\">respondsToSelector</a>."}, {"owner": {"reputation": 1858, "user_id": 599484, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/38907a1ff475a70dc71663370685a1a1?s=128&d=identicon&r=PG", "display_name": "fyngyrz", "link": "https://stackoverflow.com/users/599484/fyngyrz"}, "reply_to_user": {"reputation": 3108, "user_id": 4641116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gc52U.png?s=128&g=1", "display_name": "Eljay", "link": "https://stackoverflow.com/users/4641116/eljay"}, "edited": false, "score": 0, "creation_date": 1516195964, "post_id": 48292163, "comment_id": 83589309, "body": "@Eljay, right, but I&#39;m writing in c++ (or c). Thank you for that though. I have found a solution as marked below."}], "answers": [{"comments": [{"owner": {"reputation": 1858, "user_id": 599484, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/38907a1ff475a70dc71663370685a1a1?s=128&d=identicon&r=PG", "display_name": "fyngyrz", "link": "https://stackoverflow.com/users/599484/fyngyrz"}, "edited": false, "score": 0, "creation_date": 1516196649, "post_id": 48296398, "comment_id": 83589767, "body": "Thank you for pointing out sw_vers; that did exactly what I needed and it works from 10.6.8 through 10.12.6, perfect. Silly they didn&#39;t have that capability in the system API from day 1, but oh well. For future readers, I was able to use <code>sw_vers -productVersion</code> to get the major, minor and revision levels of OS X. I approached it as a simple use of <code>QString params=&quot;-productVersion&quot;</code>, <code>QProcess p</code>, <code>p.start(&quot;sw_vers&quot;, params)</code>, <code>p.waitForFinished(-1)</code>, <code>QString p_stdout = p.readAll()</code> and then parsing the result rather than the above, but the idea is the same."}], "tags": [], "owner": {"reputation": 8919, "user_id": 8873508, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2uDHi.png?s=128&g=1", "display_name": "p-a-o-l-o", "link": "https://stackoverflow.com/users/8873508/p-a-o-l-o"}, "is_accepted": true, "score": 3, "last_activity_date": 1516177280, "last_edit_date": 1516177280, "creation_date": 1516176928, "answer_id": 48296398, "question_id": 48292163, "link": "https://stackoverflow.com/questions/48292163/retrieving-os-x-version-using-qt-c-c/48296398#48296398", "title": "Retrieving OS X version using Qt, c, c++", "body": "<p>You could execute a command like <a href=\"https://scriptingosx.com/2017/11/on-the-macos-version/\" rel=\"nofollow noreferrer\"><code>sw_vers</code></a> and read its output.</p>\n\n<p>Example code, using <code>QProcess</code>:</p>\n\n<p><strong>osxversion.h</strong></p>\n\n<pre><code>#ifndef OSXVERSION_H\n#define OSXVERSION_H\n\n#include &lt;QProcess&gt;\n\nclass OSXVersion : public QProcess\n{\n    Q_OBJECT\n\n    int majr;\n    int minr;\n    int step;\n\n    OSXVersion();\n\npublic:\n\n    int majorOSRevision() const { return majr; }\n    int minorOSRevision() const { return minr; }\n    int stepOSRevision() const { return step; }\n\n    static OSXVersion * getVersion();\n\nprivate slots:\n    void dataReady();\n};\n\n#endif // OSXVERSION_H\n</code></pre>\n\n<p><strong>osxversion.cpp</strong></p>\n\n<pre><code>#include \"osxversion.h\"\n\nOSXVersion::OSXVersion() : QProcess(0)\n{\n    majr = 0;\n    minr = 0;\n    step = 0;\n    connect(this, SIGNAL(readyRead()), this, SLOT(dataReady()));\n}\n\nOSXVersion * OSXVersion::getVersion()\n{\n    OSXVersion * v = new OSXVersion();\n    v-&gt;start(\"sw_vers -productName\");\n    v-&gt;waitForFinished();\n    return v;\n}\n\nvoid OSXVersion::dataReady()\n{\n    int * v[3] = {&amp;majr, &amp;minr, &amp;step};\n\n    QByteArray data = readAll();\n    QList&lt;QByteArray&gt; tokens =  data.split(':');\n    tokens = tokens[tokens.size() - 1].split('.');\n    for(int i=0; i&lt;tokens.size(); i++)\n    {\n        *(v[i]) = QString(tokens[i]).toInt();\n    }\n}\n</code></pre>\n\n<p><strong>main.cpp</strong></p>\n\n<pre><code>#include &lt;QCoreApplication&gt;\n#include &lt;QDebug&gt;\n\n#include \"osxversion.h\"\n\nint main(int argc, char *argv[])\n{\n    QCoreApplication a(argc, argv);\n\n    OSXVersion * version = OSXVersion::getVersion();\n\n    qDebug() &lt;&lt; \"OSX Version: \"\n             &lt;&lt; version-&gt;majorOSRevision()\n             &lt;&lt; \".\"\n             &lt;&lt; version-&gt;minorOSRevision()\n             &lt;&lt; \".\"\n             &lt;&lt; version-&gt;stepOSRevision();\n\n    delete version;\n\n    return a.exec();\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 25560, "user_id": 2068642, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/DYTnZ.jpg?s=128&g=1", "display_name": "TheDarkKnight", "link": "https://stackoverflow.com/users/2068642/thedarkknight"}, "is_accepted": false, "score": 1, "last_activity_date": 1516201806, "creation_date": 1516201806, "answer_id": 48304222, "question_id": 48292163, "link": "https://stackoverflow.com/questions/48292163/retrieving-os-x-version-using-qt-c-c/48304222#48304222", "title": "Retrieving OS X version using Qt, c, c++", "body": "<p>OS X / macOS has always stored its product info in one definitive plist file, which is located at <em>/System/Library/CoreServices/SystemVersion.plist</em></p>\n\n<p>If we view this file on High Sierra, we can see the following</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;!DOCTYPE plist PUBLIC \"-//Apple//DTD PLIST 1.0//EN\" \"http://www.apple.com/DTDs/PropertyList-1.0.dtd\"&gt;\n&lt;plist version=\"1.0\"&gt;\n&lt;dict&gt;\n    &lt;key&gt;ProductBuildVersion&lt;/key&gt;\n    &lt;string&gt;17C205&lt;/string&gt;\n    &lt;key&gt;ProductCopyright&lt;/key&gt;\n    &lt;string&gt;1983-2018 Apple Inc.&lt;/string&gt;\n    &lt;key&gt;ProductName&lt;/key&gt;\n    &lt;string&gt;Mac OS X&lt;/string&gt;\n    &lt;key&gt;ProductUserVisibleVersion&lt;/key&gt;\n    &lt;string&gt;10.13.2&lt;/string&gt;\n    &lt;key&gt;ProductVersion&lt;/key&gt;\n    &lt;string&gt;10.13.2&lt;/string&gt;\n&lt;/dict&gt;\n&lt;/plist&gt;\n</code></pre>\n\n<p>As it's a plist, use Qt's <code>QSettings</code> to read any value, according to the given key</p>\n\n<pre><code>#include &lt;QSettings&gt;\nQString getSysVersion()\n{\n    QSettings settings(\"/System/Library/CoreServices/SystemVersion.plist\", QSettings::NativeFormat);\n    return settings.value(\"ProductUserVisibleVersion\").toString();\n}\n</code></pre>\n\n<p>Now we have the version in a <code>QString</code>, we can obtain major, minor and build components</p>\n\n<pre><code>QString version = getSysVersion();\nQStringList components = version.split(\".\");\nint maj = components[0].toInt();\nint min = components[1].toInt();\nint build = components[2].toInt();\n</code></pre>\n"}], "owner": {"reputation": 1858, "user_id": 599484, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/38907a1ff475a70dc71663370685a1a1?s=128&d=identicon&r=PG", "display_name": "fyngyrz", "link": "https://stackoverflow.com/users/599484/fyngyrz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 744, "favorite_count": 0, "accepted_answer_id": 48296398, "answer_count": 2, "score": 1, "last_activity_date": 1516201806, "creation_date": 1516150807, "last_edit_date": 1516197041, "question_id": 48292163, "link": "https://stackoverflow.com/questions/48292163/retrieving-os-x-version-using-qt-c-c", "title": "Retrieving OS X version using Qt, c, c++", "body": "<p><strong>Build Environment:</strong> <code>QT 4.7</code>, <code>OS X 10.6</code><br>\n<strong>Run Environment:</strong> <code>OS X 10.6</code> through <code>OS X 10.13</code>, <code>Windows XP</code> and later</p>\n\n<p>I'm working in a very large, highly graphics-intensive QT app. I need to find out what version of <code>OS X</code> / <code>MacOS</code> I am running on - 10.6... 10.10... 10.12 etc.</p>\n\n<p>I am looking for a <strong>c</strong> or <strong>c++</strong> function in OS X I can call live; this is a runtime issue. It needs to work from 10.6 onwards. I am writing in <strong>c++</strong> so I can use a <strong>c</strong> solution as conveniently as <strong>c++</strong>.</p>\n\n<p>I have this:</p>\n\n<pre><code>#ifdef Q_OS_WIN\n    QApplication::setGraphicsSystem(\"raster\");\n#else\n    QApplication::setGraphicsSystem(\"native\");\n#endif\n</code></pre>\n\n<p>The above works to determine if it's windows or OS X I am building for. Inside the <code>else</code> in the above fragment I need to do some further checking; I don't need the \"native\" graphics system except in <code>OS X 10.12</code>, where the QT \"raster\" system has problems. I <em>prefer</em> the \"raster\" system because it is much faster, but later machines are faster too and so if I can only call for the \"native\" system on a modern machine running recent OS's, that should work out.</p>\n\n<p>I have users - large numbers of them - running under earlier versions of OS X, consequently whatever is used here has to be general enough to work on all versions of the OS 10.6 and up. QT 4.7 itself seems to be clueless about OS versions it doesn't explicitly know about; using <code>QSysInfo::MacVersion</code>, it just reports \"Unknown OS version.\"</p>\n\n<p>Ideally, I imagine something of the following form:</p>\n\n<pre><code>int v = majorOSRevision();\nint r = minorOSRevision();\nint s = stepOSRevision();\n</code></pre>\n\n<p>Are there such direct, simple calls within the OS X API?</p>\n"}, {"tags": ["c", "naming-conventions", "header-files", "naming"], "comments": [{"owner": {"reputation": 2449, "user_id": 500276, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/200bf76976f24add540182f5c3a42788?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Benningfield", "link": "https://stackoverflow.com/users/500276/mark-benningfield"}, "edited": false, "score": 0, "creation_date": 1516149836, "post_id": 48292020, "comment_id": 83569157, "body": "&quot;It may be a little off-topic, and also heavily opinion-based&quot; -- you&#39;re right."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1516150315, "post_id": 48292020, "comment_id": 83569293, "body": "Paraphrase: &quot;I know for a fact that the question is inappropriate for this forum, but I&#39;m going to pose it anyway.&quot;  Seriously?"}, {"owner": {"reputation": 485, "user_id": 4379569, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2cd1afc7f1977ac402af0d97e4665bbe?s=128&d=identicon&r=PG", "display_name": "Sasszem", "link": "https://stackoverflow.com/users/4379569/sasszem"}, "edited": false, "score": 1, "creation_date": 1516150477, "post_id": 48292020, "comment_id": 83569334, "body": "Found <a href=\"https://stackoverflow.com/questions/26278185/naming-convention-for-private-modules\" title=\"naming convention for private modules\">stackoverflow.com/questions/26278185/&hellip;</a> which also askns about naming, so it may not be THAT inappropriate."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1516154830, "post_id": 48292020, "comment_id": 83570357, "body": "Yes - this is a very good approach.  Also <code>extern int save_SomeObject</code> and <code>save_SomeType</code>.  For a large project you need some name convention management."}], "answers": [{"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1516155072, "post_id": 48292401, "comment_id": 83570406, "body": "Interesting idea"}, {"owner": {"reputation": 485, "user_id": 4379569, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2cd1afc7f1977ac402af0d97e4665bbe?s=128&d=identicon&r=PG", "display_name": "Sasszem", "link": "https://stackoverflow.com/users/4379569/sasszem"}, "edited": false, "score": 1, "creation_date": 1516323505, "post_id": 48292401, "comment_id": 83650918, "body": "<code>static struct {void (*foo_visible)(void);} FooModule ={.foo_visible=&amp;_foo_implemented};</code> - looks like working."}, {"owner": {"reputation": 17958, "user_id": 1971013, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/EtqFE.jpg?s=128&g=1", "display_name": "meaning-matters", "link": "https://stackoverflow.com/users/1971013/meaning-matters"}, "reply_to_user": {"reputation": 485, "user_id": 4379569, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2cd1afc7f1977ac402af0d97e4665bbe?s=128&d=identicon&r=PG", "display_name": "Sasszem", "link": "https://stackoverflow.com/users/4379569/sasszem"}, "edited": false, "score": 1, "creation_date": 1516350676, "post_id": 48292401, "comment_id": 83658818, "body": "@Sasszem Thanks for letting me know."}], "tags": [], "owner": {"reputation": 17958, "user_id": 1971013, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/EtqFE.jpg?s=128&g=1", "display_name": "meaning-matters", "link": "https://stackoverflow.com/users/1971013/meaning-matters"}, "is_accepted": true, "score": 4, "last_activity_date": 1516153057, "last_edit_date": 1516153057, "creation_date": 1516152721, "answer_id": 48292401, "question_id": 48292020, "link": "https://stackoverflow.com/questions/48292020/c-naming-sub-module-functions/48292401#48292401", "title": "C naming sub-module functions", "body": "<p>One idea would be to create a (<code>static</code>) <code>struct</code> per sub-module that has function pointers as elements. A call would look something like:</p>\n\n<pre><code>fileSave.load_savefile()\n</code></pre>\n\n<p>In this way you're moving a little bit in the direction of C++. You could of course also decide to use C++ in a light way, and create classes.</p>\n"}], "owner": {"reputation": 485, "user_id": 4379569, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2cd1afc7f1977ac402af0d97e4665bbe?s=128&d=identicon&r=PG", "display_name": "Sasszem", "link": "https://stackoverflow.com/users/4379569/sasszem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 187, "favorite_count": 0, "closed_date": 1516171773, "accepted_answer_id": 48292401, "answer_count": 1, "score": 0, "last_activity_date": 1516153057, "creation_date": 1516149591, "question_id": 48292020, "link": "https://stackoverflow.com/questions/48292020/c-naming-sub-module-functions", "closed_reason": "Opinion-based", "title": "C naming sub-module functions", "body": "<p>It may be a little off-topic, and also heavily opinion-based, but I think the following problem deserves discussion:</p>\n\n<p>Let say you are working on a bigger project, which consist of multiple files and multiple headers. For example you have a file(sub-module) which does save management, the other handles drawing and so on. What do you think is the best way of naming the functions inside a sub-module?</p>\n\n<p>I would like something that I can see from that which file was the function declared/implemented in, which would help a lot during development and bugfixing.</p>\n\n<p>My current approach:</p>\n\n<ul>\n<li>Prefix every function with the name of the header it was declared in, example(functions declared in header <code>save.h</code>): <code>save_load_savefile();</code>, <code>save_save_game();</code>,etc.</li>\n</ul>\n\n<p>Do you know any other, possibly better alternatives?</p>\n"}, {"tags": ["c", "multithreading"], "comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 2, "creation_date": 1516149561, "post_id": 48291991, "comment_id": 83569081, "body": "C11 draft standard n1570: <i>7.21.2 Streams 7 Each stream has an associated lock that is used to prevent data races when multiple threads of execution access a stream, and to restrict the interleaving of stream operations performed by multiple threads. Only one thread may hold this lock at a time. The lock is reentrant: a single thread may hold the lock multiple times at a given time.</i>"}, {"owner": {"reputation": 5563, "user_id": 3763545, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/242891331073a6961342bd4375c95156?s=128&d=identicon&r=PG&f=1", "display_name": "InsideLoop", "link": "https://stackoverflow.com/users/3763545/insideloop"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1516149682, "post_id": 48291991, "comment_id": 83569115, "body": "@EOF: I understand that it is in the standard. But why does anyone want to access the same file from multiple thread?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 2, "creation_date": 1516149831, "post_id": 48291991, "comment_id": 83569154, "body": "@InsideLoop, it&#39;s pretty common for writing to a log file, for example.  All stream I/O functions are thread safe on a per-call basis in part because it wouldn&#39;t work for only some of them to be.  And it absolutely could make sense, <i>especially</i> with <code>fread()</code>, for multiple threads ingesting data from the same file."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 2, "creation_date": 1516149922, "post_id": 48291991, "comment_id": 83569179, "body": "You probably want <code>stderr</code> to be thread-safe, or you&#39;ll have trouble diagnosing failures. You can also avoid locking in single-threaded code. In multi-threaded code where only one thread writes to any stream regularly, taking the lock will be pretty cheap (because the cache line with the lock will stay with the thread)."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1516149994, "post_id": 48291991, "comment_id": 83569196, "body": "Note also that how much of an impact the locking has on your program depends on its I/O patterns.  If you make many small <code>fread()</code> requests then you will be more impacted than if you make fewer, larger ones.  If you perform I/O frequently, no matter the transfer size, you will be proportionally more affected than if I/O were rare."}, {"owner": {"reputation": 5563, "user_id": 3763545, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/242891331073a6961342bd4375c95156?s=128&d=identicon&r=PG&f=1", "display_name": "InsideLoop", "link": "https://stackoverflow.com/users/3763545/insideloop"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1516150297, "post_id": 48291991, "comment_id": 83569288, "body": "@John: I don&#39;t buy the fact that it is I/O limited because fread uses an internal buffer so even though you make a lot of calls to get small chunk of data, most of them will give you some data which is already in memory and prevents any I/O."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1516150439, "post_id": 48291991, "comment_id": 83569326, "body": "@InsideLoop, I said how much of an impact <i>the locking</i> has depends on the I/O pattern.  Every call is specified to perform locking, regardless of I/O size or buffering."}, {"owner": {"reputation": 5563, "user_id": 3763545, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/242891331073a6961342bd4375c95156?s=128&d=identicon&r=PG&f=1", "display_name": "InsideLoop", "link": "https://stackoverflow.com/users/3763545/insideloop"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1516150658, "post_id": 48291991, "comment_id": 83569393, "body": "@John: Sorry, got it. I am just extremely surprised that fread has an internal buffer to make calls to get small chunks of data faster and at the same time has so many requirements that cannot make it fast. Note, that I am not sure yet that the locking is the reason why it is so slow. I need further profiling for that."}, {"owner": {"reputation": 13984, "user_id": 501126, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/839de8a602b21abf36e020bcb32959fe?s=128&d=identicon&r=PG", "display_name": "nemequ", "link": "https://stackoverflow.com/users/501126/nemequ"}, "edited": false, "score": 1, "creation_date": 1516150960, "post_id": 48291991, "comment_id": 83569478, "body": "Note that if you&#39;re on glibc you can use the <i>_unlocked variants (*e.g.</i>, <code>fread_unlocked</code>). On Windows you can define <code>_CRT_DISABLE_PERFCRIT_LOCKS</code>."}, {"owner": {"reputation": 5563, "user_id": 3763545, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/242891331073a6961342bd4375c95156?s=128&d=identicon&r=PG&f=1", "display_name": "InsideLoop", "link": "https://stackoverflow.com/users/3763545/insideloop"}, "reply_to_user": {"reputation": 13984, "user_id": 501126, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/839de8a602b21abf36e020bcb32959fe?s=128&d=identicon&r=PG", "display_name": "nemequ", "link": "https://stackoverflow.com/users/501126/nemequ"}, "edited": false, "score": 0, "creation_date": 1516151487, "post_id": 48291991, "comment_id": 83569609, "body": "@nemequ: Thank you very much. It allows me to get some speedup, but not as fast as writing my own buffer. But I can go from 270 MB/s with fread to 360 MB/s with fread_unlocked. You could put it as an answer."}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 5, "creation_date": 1516151874, "post_id": 48291991, "comment_id": 83569728, "body": "It isn&#39;t &#39;designed to be so slow&#39;. Don&#39;t be tendentious. It is designed to be thread-safe. Correctness is more important than speed. You can get the wrong answer in zero time. It&#39;s of no interest."}, {"owner": {"reputation": 5563, "user_id": 3763545, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/242891331073a6961342bd4375c95156?s=128&d=identicon&r=PG&f=1", "display_name": "InsideLoop", "link": "https://stackoverflow.com/users/3763545/insideloop"}, "reply_to_user": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1516152256, "post_id": 48291991, "comment_id": 83569830, "body": "@EJP: You are right. I work on high performance computing and it turns out that speed is often very important to me. My title was misleading and I have updated it."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1516178473, "post_id": 48291991, "comment_id": 83578097, "body": "&#39;I have implemented my own buffer and I have observed speed up by a factor of 10 on both Linux and Windows&#39;...........sounds about right."}], "answers": [{"comments": [{"owner": {"reputation": 5563, "user_id": 3763545, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/242891331073a6961342bd4375c95156?s=128&d=identicon&r=PG&f=1", "display_name": "InsideLoop", "link": "https://stackoverflow.com/users/3763545/insideloop"}, "edited": false, "score": 0, "creation_date": 1516150101, "post_id": 48292041, "comment_id": 83569225, "body": "I understand your point, but it does not make sense to read interleaving block of 5 bytes. I would understand 2 threads working on the same file with one processing the first 40 MB and the second one processing the second 40 MB. And I would have two FILE*, one for each thread."}, {"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "reply_to_user": {"reputation": 5563, "user_id": 3763545, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/242891331073a6961342bd4375c95156?s=128&d=identicon&r=PG&f=1", "display_name": "InsideLoop", "link": "https://stackoverflow.com/users/3763545/insideloop"}, "edited": false, "score": 1, "creation_date": 1516150247, "post_id": 48292041, "comment_id": 83569270, "body": "@InsideLoop Except there are plenty of times when smaller blocks make sense, like the pixels mentioned as an example here. And what if the image is coming in over a pipe?"}, {"owner": {"reputation": 11238, "user_id": 7594711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7872c871b0431b72df6350dd0394bea?s=128&d=identicon&r=PG&f=1", "display_name": "SoronelHaetir", "link": "https://stackoverflow.com/users/7594711/soronelhaetir"}, "edited": false, "score": 0, "creation_date": 1516150651, "post_id": 48292041, "comment_id": 83569391, "body": "I chock this up to the standard library being an &#39;okay&#39; solution for &#39;general cases&#39;, if you are doing something odd (as would seem the case with reading small unevenly sized blocks from multiple threads) there is likely a better way."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 5563, "user_id": 3763545, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/242891331073a6961342bd4375c95156?s=128&d=identicon&r=PG&f=1", "display_name": "InsideLoop", "link": "https://stackoverflow.com/users/3763545/insideloop"}, "edited": false, "score": 0, "creation_date": 1516150779, "post_id": 48292041, "comment_id": 83569421, "body": "You&#39;re quibbling over the details, @InsideLoop.  The case presented in this answer could be as well addressed by each thread reading 100 5-byte blocks at a time, or more.  The point is that yes, it can make sense for multiple threads to interleave read operations on the same file."}, {"owner": {"reputation": 5563, "user_id": 3763545, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/242891331073a6961342bd4375c95156?s=128&d=identicon&r=PG&f=1", "display_name": "InsideLoop", "link": "https://stackoverflow.com/users/3763545/insideloop"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1516151080, "post_id": 48292041, "comment_id": 83569507, "body": "@John: I understand your point, but I am still puzzled because it turns out that I often write signal processing which works with data coming in real-time such as a pipe, and I have yet to see 2 threads trying to read the same stream."}, {"owner": {"reputation": 62, "user_id": 2255376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acabaf5fe864b369c8297444db9b20da?s=128&d=identicon&r=PG", "display_name": "droperto", "link": "https://stackoverflow.com/users/2255376/droperto"}, "reply_to_user": {"reputation": 5563, "user_id": 3763545, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/242891331073a6961342bd4375c95156?s=128&d=identicon&r=PG&f=1", "display_name": "InsideLoop", "link": "https://stackoverflow.com/users/3763545/insideloop"}, "edited": false, "score": 0, "creation_date": 1516151089, "post_id": 48292041, "comment_id": 83569509, "body": "@InsideLoop Does not matter if it&#39;s 4 bytes at a time or 40MB. Have you considered just using <code>getc()</code>? It should be much faster to make a quick loop if you don&#39;t need all the extra from <code>fread()</code>"}, {"owner": {"reputation": 5563, "user_id": 3763545, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/242891331073a6961342bd4375c95156?s=128&d=identicon&r=PG&f=1", "display_name": "InsideLoop", "link": "https://stackoverflow.com/users/3763545/insideloop"}, "edited": false, "score": 0, "creation_date": 1516151603, "post_id": 48292041, "comment_id": 83569654, "body": "@droperto: I read binary files whereas <code>getc()</code> is text-driven."}, {"owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "reply_to_user": {"reputation": 5563, "user_id": 3763545, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/242891331073a6961342bd4375c95156?s=128&d=identicon&r=PG&f=1", "display_name": "InsideLoop", "link": "https://stackoverflow.com/users/3763545/insideloop"}, "edited": false, "score": 0, "creation_date": 1516152544, "post_id": 48292041, "comment_id": 83569883, "body": "@InsideLoop: Without locking, how can you 1. Check if the buffer can satisfy a read, 2. If it can, update the position within the buffer while safely pulling the data, 3. If not, coordinate which thread reads the next block of data into the buffer? And these cases overlap; you might think #2 could be solved with atomics to update the buffer pointer while caching the previous value, then <code>memcpy</code>, but if another thread goes to case #3, the buffer might be overwritten between pointer update and <code>memcpy</code>. There&#39;s no reasonable way to maintain consistent state for the file object without a lock."}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "reply_to_user": {"reputation": 5563, "user_id": 3763545, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/242891331073a6961342bd4375c95156?s=128&d=identicon&r=PG&f=1", "display_name": "InsideLoop", "link": "https://stackoverflow.com/users/3763545/insideloop"}, "edited": false, "score": 0, "creation_date": 1516152569, "post_id": 48292041, "comment_id": 83569890, "body": "@InsideLoop The standard requires <code>fread</code> to behave exactly as if it was calling <code>fgetc</code> in a loop."}, {"owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "edited": false, "score": 0, "creation_date": 1516152716, "post_id": 48292041, "comment_id": 83569921, "body": "If you&#39;re on Linux, you can always <a href=\"https://linux.die.net/man/3/fread_unlocked\" rel=\"nofollow noreferrer\">use <code>fread_unlocked</code></a> to bypass the lock; if you have some external locking you&#39;ll be fine. Or you might be fine by accident for a while, until you race and everything blows up in your face. It&#39;s a terrible idea, but you&#39;re welcome to play with it for learning purposes."}, {"owner": {"reputation": 5563, "user_id": 3763545, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/242891331073a6961342bd4375c95156?s=128&d=identicon&r=PG&f=1", "display_name": "InsideLoop", "link": "https://stackoverflow.com/users/3763545/insideloop"}, "reply_to_user": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "edited": false, "score": 0, "creation_date": 1516152904, "post_id": 48292041, "comment_id": 83569961, "body": "@ShadowRanger: I agree with you. I would personally have designed <code>fread</code> without any requirement on thread safety. I write a lot of multithreaded code and I don&#39;t have a single data structure that is thread safe. I just avoid doing thread-unsafe things on those data structures. It might be a different habit, but locks are prohibited in high performance computing because of the performance penalty. For instance it is very common in HPC to give the same array to 2 different threads and make those threads work on the different parts of the same array."}, {"owner": {"reputation": 5563, "user_id": 3763545, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/242891331073a6961342bd4375c95156?s=128&d=identicon&r=PG&f=1", "display_name": "InsideLoop", "link": "https://stackoverflow.com/users/3763545/insideloop"}, "reply_to_user": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "edited": false, "score": 0, "creation_date": 1516153347, "post_id": 48292041, "comment_id": 83570064, "body": "@ShadowRanger: In this case, I would be more concerned about opening the same file from 2 different threads which seems to be not allowed by the standard even for reading. I don&#39;t know of any mechanism to help you avoid that. This is a real problem and locks won&#39;t help you here."}], "tags": [], "owner": {"reputation": 62, "user_id": 2255376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acabaf5fe864b369c8297444db9b20da?s=128&d=identicon&r=PG", "display_name": "droperto", "link": "https://stackoverflow.com/users/2255376/droperto"}, "is_accepted": false, "score": 0, "last_activity_date": 1516149849, "creation_date": 1516149849, "answer_id": 48292041, "question_id": 48291991, "link": "https://stackoverflow.com/questions/48291991/why-fread-does-have-thread-safe-requirements-which-slows-down-its-call/48292041#48292041", "title": "Why fread does have thread safe requirements which slows down its call", "body": "<p>Imagine you have a file where each 5 bytes can be processed in parallel (let's say, pixel by pixel in an image):</p>\n\n<p>123456789A</p>\n\n<p>One thread needs to pick 5 bytes \"12345\", the next one the next 5 bytes \"6789A\".</p>\n\n<p>If it was not thread-safe different threads could pick-up wrong chunks. For example: \"12367\" and \"4589A\" or even worst (unexpected behaviour, repeated bytes or worst).</p>\n"}, {"tags": [], "owner": {"reputation": 5563, "user_id": 3763545, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/242891331073a6961342bd4375c95156?s=128&d=identicon&r=PG&f=1", "display_name": "InsideLoop", "link": "https://stackoverflow.com/users/3763545/insideloop"}, "is_accepted": false, "score": 0, "last_activity_date": 1516152345, "creation_date": 1516152345, "answer_id": 48292359, "question_id": 48291991, "link": "https://stackoverflow.com/questions/48291991/why-fread-does-have-thread-safe-requirements-which-slows-down-its-call/48292359#48292359", "title": "Why fread does have thread safe requirements which slows down its call", "body": "<p>As suggested by <code>nemequ</code>:</p>\n\n<p>Note that if you're on glibc you can use the _unlocked variants (*e.g., fread_unlocked). On Windows you can define _CRT_DISABLE_PERFCRIT_LOCKS</p>\n"}, {"tags": [], "owner": {"reputation": 1247, "user_id": 9107647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a43594ef3d74c11a31be7f9d5ebddc0?s=128&d=identicon&r=PG&f=1", "display_name": "Humphrey Winnebago", "link": "https://stackoverflow.com/users/9107647/humphrey-winnebago"}, "is_accepted": false, "score": 0, "last_activity_date": 1516174023, "creation_date": 1516174023, "answer_id": 48295716, "question_id": 48291991, "link": "https://stackoverflow.com/questions/48291991/why-fread-does-have-thread-safe-requirements-which-slows-down-its-call/48295716#48295716", "title": "Why fread does have thread safe requirements which slows down its call", "body": "<p>Stream I/O is already as slow as molasses. Programmers think that a read from main memory (1000x longer than a CPU cycle) is ages. A read from the physical disk or a network may as well be eternity. </p>\n\n<p>I don't know if that's the #1 reason why the library implementers were ok with adding the lock overhead, but I guarantee it played a significant part.</p>\n\n<p>Yes, it slows it down, but as you discovered, you can manually buffer the read and use your own handling to increase the speed when performance really matters. (That's the key--when you absolutely must read the data as fast as possible. Don't bother manually buffering in the general case.)</p>\n\n<p>That's <em>a</em> rationalization. I'm sure you could think of more!</p>\n"}], "owner": {"reputation": 5563, "user_id": 3763545, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/242891331073a6961342bd4375c95156?s=128&d=identicon&r=PG&f=1", "display_name": "InsideLoop", "link": "https://stackoverflow.com/users/3763545/insideloop"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 864, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1516174023, "creation_date": 1516149336, "last_edit_date": 1516152147, "question_id": 48291991, "link": "https://stackoverflow.com/questions/48291991/why-fread-does-have-thread-safe-requirements-which-slows-down-its-call", "title": "Why fread does have thread safe requirements which slows down its call", "body": "<p>I am writing a function to read binary files that are organized as a succession of (key, value) pairs where keys are small ASCII strings and value are int or double stored in binary format.</p>\n\n<p>If implemented naively, this function makes a lot of call to fread to read very small amount of data (usually no more than 10 bytes). Even though fread internally uses a buffer to read the file, I have implemented my own buffer and I have observed speed up by a factor of 10 on both Linux and Windows. The buffer size used by fread is large enough and the function call cannot be responsible for such a slowdown. So I went and dug into the GNU implementation of fread and discovered some lock on the file, and many other things such as verifying that the file is open with read access and so on. No wonder why fread is so slow.</p>\n\n<p>But what is the rationale behind fread being thread-safe where it seems that multiple thread can call fread on the <em>same</em> file which is mind boggling to me. These requirements make it slow as hell. What are the advantages?</p>\n"}, {"tags": ["c", "arrays", "struct", "syntax-error"], "comments": [{"owner": {"reputation": 613, "user_id": 3112926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b33809c5d0f78b110e8613c9e5972dd5?s=128&d=identicon&r=PG&f=1", "display_name": "JGroven", "link": "https://stackoverflow.com/users/3112926/jgroven"}, "edited": false, "score": 1, "creation_date": 1516146811, "post_id": 48291642, "comment_id": 83568350, "body": "Can you show the code for the weapon struct?"}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 3, "creation_date": 1516146835, "post_id": 48291642, "comment_id": 83568356, "body": "Obviously your player_inventory and weapon types aren&#39;t defined as you expect, and we can&#39;t possibly fix that without seeing the definitions."}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 7, "creation_date": 1516146914, "post_id": 48291642, "comment_id": 83568378, "body": "Is there a macro <code>weight</code> defined somewhere in the problematic source file? E.g <code>#define weight 42</code>"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 1, "creation_date": 1516146955, "post_id": 48291642, "comment_id": 83568391, "body": "Better yet, please provide <a href=\"http://stackoverflow.com/help/mcve\"><b>A Minimal, Complete, and Verifiable example</b></a>"}, {"owner": {"reputation": 65, "user_id": 7821100, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5607a08059d692da9d50aa8e9cb77019?s=128&d=identicon&r=PG&f=1", "display_name": "octagonlord69", "link": "https://stackoverflow.com/users/7821100/octagonlord69"}, "reply_to_user": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1516147256, "post_id": 48291642, "comment_id": 83568465, "body": "@AnT thanks that was the problem. Just gonna change the code..."}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 2, "creation_date": 1516147348, "post_id": 48291642, "comment_id": 83568491, "body": "@octagonlord69: Well... Avoid by all costs defining sneaky macros with such innocent-looking names. Macro names should stand out. &quot;All caps&quot; is a popular convention."}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 1, "creation_date": 1516147838, "post_id": 48291642, "comment_id": 83568623, "body": "One way to avoid this sort of problem is to make your macro definitions be in CAPS. Another way to avoid the problem is to let your structure members have some distinguishing prefix or suffix (like <code>w_name</code>, <code>w_type</code>, ..., <code>w_weight</code>)."}], "owner": {"reputation": 65, "user_id": 7821100, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5607a08059d692da9d50aa8e9cb77019?s=128&d=identicon&r=PG&f=1", "display_name": "octagonlord69", "link": "https://stackoverflow.com/users/7821100/octagonlord69"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 117, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1516147069, "creation_date": 1516146611, "last_edit_date": 1516146729, "question_id": 48291642, "link": "https://stackoverflow.com/questions/48291642/expected-identifier-before-token", "title": "Expected identifier before &#39;=&#39; token", "body": "<pre><code>void give_weapon(int adr, int type, int material, int item, int condition)\n{\n    player_inventory.weapon[adr].type = type;\n    player_inventory.weapon[adr].material = material;\n    player_inventory.weapon[adr].item = item;\n    player_inventory.weapon[adr].condition = condition;\n    define_weapon_name(adr);\n    player_inventory.weapon[adr].gold_val = define_weapon_gold_value(adr);\n    player_inventory.weapon[adr].weight = define_weapon_weight(adr);\n}\n</code></pre>\n\n<p>The function in simple. Send information about the weapon you want to give to the player as function arguments and the address (array index) of where you want the weapon to be stored in.\nWhen I execute this code in the source file, it works fine, but because this is another c source file that I had linked, things are somehow different.</p>\n\n<p>The last line, <code>player_inventory.weapon[adr].weight = define_weapon_weight(adr);</code>, gives me an error saying <code>expected identifier before '=' token</code>. I checked the spelling, the return type of the function I am calling and the structure itself that I am calling - everything is fine.</p>\n\n<p>What could be causing this problem?</p>\n"}, {"tags": ["c", "arrays", "sorting", "matrix"], "comments": [{"owner": {"reputation": 194, "user_id": 4955118, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-FSFY-mD9PLU/AAAAAAAAAAI/AAAAAAAAALs/ZyLLxe1hayM/photo.jpg?sz=128", "display_name": "Shahe Ansar", "link": "https://stackoverflow.com/users/4955118/shahe-ansar"}, "edited": false, "score": 0, "creation_date": 1516146289, "post_id": 48291562, "comment_id": 83568196, "body": "If you can&#39;t put the code directly, at least use a paste service like pastebin, and put it on here"}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 1, "creation_date": 1516146311, "post_id": 48291562, "comment_id": 83568203, "body": "Welcome to Stack Overflow, please take the <a href=\"https://stackoverflow.com/tour\">tour</a> and read <a href=\"https://stackoverflow.com/help/how-to-ask\">How to ask a good question</a>. Stack Overflow is not a coding service, you cannot just post your homework assignment and expect us to do your homework. Do it yourself, if you have trouble with something, then you can ask about that. See also <a href=\"https://stackoverflow.com/help/mcve\">How to create a Minimal, Complete, and Verifiable example</a>"}, {"owner": {"reputation": 1853, "user_id": 6232665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41eeea507e28cddc2bc1efc3b2b73c45?s=128&d=identicon&r=PG&f=1", "display_name": "zenwraight", "link": "https://stackoverflow.com/users/6232665/zenwraight"}, "edited": false, "score": 0, "creation_date": 1516146321, "post_id": 48291562, "comment_id": 83568207, "body": "Also there can be many answers to this problem... it won&#39;t have a single solution... u might need to frame the quesiton in a better way"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1516154048, "post_id": 48291562, "comment_id": 83570223, "body": "It would probably be better to print the message about \u201cMatrix after sorting\u201d after the sorting code."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1516158626, "post_id": 48291562, "comment_id": 83571118, "body": "Were it my code, there\u2019d be three separate sort functions, one each for the diagonal, the upper and the lower triangles.  I\u2019d probably also have two or three comparison functions, one for the diagonal and probably one each for the upper and lower triangles. The comparisons would probably be <code>static inline</code> to get maximum benefit. I haven\u2019t yet sat down and worked through the index sequencing for the triangles; the diagonal is easy, though."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1516306405, "post_id": 48291562, "comment_id": 83644848, "body": "I&#39;ll observe in passing that <code>for</code> loops are almost invariably better style for matrix work than <code>while</code> loops.  All the control information is at the top of the loop; you don&#39;t have to scan the body of the loop to find out where and how the loop controls are set.  The loop conditions are normally of the style <code>for (int i = lo; i &lt; hi; i++) { \u2026 }</code> (where <code>lo</code> is often <code>0</code> and <code>hi</code> is often the dimension of the array)."}, {"owner": {"reputation": 25, "user_id": 9105272, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-E0rdkiilklM/AAAAAAAAAAI/AAAAAAAAAFk/nCK11Fi4Ybs/photo.jpg?sz=128", "display_name": "Petar Aleksovski", "link": "https://stackoverflow.com/users/9105272/petar-aleksovski"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1516405774, "post_id": 48291562, "comment_id": 83688947, "body": "Thank you very much @JonathanLeffler , you helped me a lot. I&#39;m new in C and i got this task on my college . But this code that you wrote is confusing to me . I am trying now to understand what you did . :D"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1516406139, "post_id": 48291562, "comment_id": 83689059, "body": "Yes, the code is a bit hairy.  If you want the non-hairy code \u2014 less hairy code \u2014 then poke around in my GitHub repository (<a href=\"https://github.com/jleffler/soq/tree/master/src/so-4829-1562\" rel=\"nofollow noreferrer\">src/so-4829-1562</a>). In particular, time.sort2d-97.c is pretty elegant, though still potentially confusing if you aren&#39;t used to function pointers \u2014 it makes use of quite a lot of them. The resulting code is fairly neat, though. I&#39;m currently running the timing test (it takes a while to sort a 90,000 x 90,000 matrix using your rules (about 1000s using the system <code>qsort()</code> \u2014 &#39;forever&#39; using the sorts below)."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1516406616, "post_id": 48291562, "comment_id": 83689203, "body": "The code shown sorts the upper triangle (UT) and lower triangle (LT) in place. There has to be a way to map a simple array index [0..m) into a (row,col) pair in the full matrix.3 The <code>ut</code> and <code>lt</code> matrices help with that; the entry in <code>ut[i][0]</code> contains the row index, and <code>ut[i][1]</code> contains the column index, for the value at position <code>i</code> in the UT. That is, <code>matrix[ut[i][0]][ut[i][1]]</code> is the value at position <code>i</code>. The multiple indexing is spit out over several lines in the code (that really isn&#39;t easily readable). The UT and LT arrays exist because this sort uses the information repeatedly."}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 9105272, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-E0rdkiilklM/AAAAAAAAAAI/AAAAAAAAAFk/nCK11Fi4Ybs/photo.jpg?sz=128", "display_name": "Petar Aleksovski", "link": "https://stackoverflow.com/users/9105272/petar-aleksovski"}, "edited": false, "score": 0, "creation_date": 1516414085, "post_id": 48296187, "comment_id": 83690604, "body": "Is there a more simple way to do this task, someone that the beginner as I could fully understand ? In these examples you wrote to me, I do not understand a lot of things. I don&#39;t need program to be effective,for now    ( maybe I could make later when I figure out ), I want to write a program that the beginner understands .  :) Anyway, thank you for your efforts"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 25, "user_id": 9105272, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-E0rdkiilklM/AAAAAAAAAAI/AAAAAAAAAFk/nCK11Fi4Ybs/photo.jpg?sz=128", "display_name": "Petar Aleksovski", "link": "https://stackoverflow.com/users/9105272/petar-aleksovski"}, "edited": false, "score": 0, "creation_date": 1516414636, "post_id": 48296187, "comment_id": 83690696, "body": "Multiple questions are going to be needed to work out how to make it simpler. First, do you understand the need to split the operation into three separate sorts?  Next, have you ever used <code>qsort()</code> before?  That may explain whether you can understand the comparator functions. The trick to the diagonal sorting is to realize that every even number must compare smaller than any odd number.  Only if both numbers are odd or both are even do you actually compare them for size."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 25, "user_id": 9105272, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-E0rdkiilklM/AAAAAAAAAAI/AAAAAAAAAFk/nCK11Fi4Ybs/photo.jpg?sz=128", "display_name": "Petar Aleksovski", "link": "https://stackoverflow.com/users/9105272/petar-aleksovski"}, "edited": false, "score": 0, "creation_date": 1516414877, "post_id": 48296187, "comment_id": 83690738, "body": "Hmm; it occurs to me that the code doesn\u2019t handle degenerate cases. Size 0 and 1 are always fully sorted. Size 2 only needs to sort the diagonal.  Size 3 and up needs the full treatment."}, {"owner": {"reputation": 25, "user_id": 9105272, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-E0rdkiilklM/AAAAAAAAAAI/AAAAAAAAAFk/nCK11Fi4Ybs/photo.jpg?sz=128", "display_name": "Petar Aleksovski", "link": "https://stackoverflow.com/users/9105272/petar-aleksovski"}, "edited": false, "score": 0, "creation_date": 1516415963, "post_id": 48296187, "comment_id": 83690888, "body": "I understand that I need 3 separate sorts and i used qsort() . But I never used pointers before . :/"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 25, "user_id": 9105272, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-E0rdkiilklM/AAAAAAAAAAI/AAAAAAAAAFk/nCK11Fi4Ybs/photo.jpg?sz=128", "display_name": "Petar Aleksovski", "link": "https://stackoverflow.com/users/9105272/petar-aleksovski"}, "edited": false, "score": 0, "creation_date": 1516418506, "post_id": 48296187, "comment_id": 83691304, "body": "I&#39;m not sure how you use <code>qsort()</code> without using pointers. Maybe someone provided you with the comparator function? However, that&#39;s not crucial. If you were asked to sort an array of M integers in ascending order, what would you do? What about descending order? Would you create or use a single function that could sort either way, or would you need to create two functions? Or would you write two blocks of code inside <code>main()</code> to do the two jobs? The key to solving this, it seems to me, is to copy each triangular portion of the matrix into a simple (1D) vector, sort it, and copy the vector back."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 25, "user_id": 9105272, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-E0rdkiilklM/AAAAAAAAAAI/AAAAAAAAAFk/nCK11Fi4Ybs/photo.jpg?sz=128", "display_name": "Petar Aleksovski", "link": "https://stackoverflow.com/users/9105272/petar-aleksovski"}, "edited": false, "score": 0, "creation_date": 1516418839, "post_id": 48296187, "comment_id": 83691357, "body": "How would you go about identifying the cells that are in the upper triangular (UT) and lower triangular (LT) sections of the matrix?  This will be a crucial part of any solution.  Although it doesn&#39;t matter which order you copy the data out of the UT or LT section into a vector before sorting, it is crucial that when you copy the results back, you do so in the correct sequence.  There&#39;s a diagram/comment in my code that shows how I thought about it (the one with D0..D4 on the diagonal, L0..L9 in the LT section, and U0..U9 in the UT section).  How would you go about that?"}, {"owner": {"reputation": 25, "user_id": 9105272, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-E0rdkiilklM/AAAAAAAAAAI/AAAAAAAAAFk/nCK11Fi4Ybs/photo.jpg?sz=128", "display_name": "Petar Aleksovski", "link": "https://stackoverflow.com/users/9105272/petar-aleksovski"}, "edited": false, "score": 0, "creation_date": 1516450914, "post_id": 48296187, "comment_id": 83698677, "body": "How can I make those maps for Diagonal ,UT and LT ? How to copy triangular portion of the matrix in vector ? I m confused ... I need to read more about those things first and then I will ask what will not be clear to me."}, {"owner": {"reputation": 25, "user_id": 9105272, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-E0rdkiilklM/AAAAAAAAAAI/AAAAAAAAAFk/nCK11Fi4Ybs/photo.jpg?sz=128", "display_name": "Petar Aleksovski", "link": "https://stackoverflow.com/users/9105272/petar-aleksovski"}, "edited": false, "score": 0, "creation_date": 1517606079, "post_id": 48296187, "comment_id": 84179104, "body": "I made one code above , but thing is that it won&#39;t work in all situations ."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 25, "user_id": 9105272, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-E0rdkiilklM/AAAAAAAAAAI/AAAAAAAAAFk/nCK11Fi4Ybs/photo.jpg?sz=128", "display_name": "Petar Aleksovski", "link": "https://stackoverflow.com/users/9105272/petar-aleksovski"}, "edited": false, "score": 0, "creation_date": 1517624168, "post_id": 48296187, "comment_id": 84183799, "body": "See the update to the answer \u2014 you were close, and I think the code there is closer still.  The new material is also in my GitHub repo."}], "tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": true, "score": 1, "last_activity_date": 1517624113, "last_edit_date": 1517624113, "creation_date": 1516176035, "answer_id": 48296187, "question_id": 48291562, "link": "https://stackoverflow.com/questions/48291562/sorting-2d-array-matrix-in-c/48296187#48296187", "title": "Sorting 2d array (matrix) in C", "body": "<p>It's an intriguing problem.  As I outlined in a <a href=\"https://stackoverflow.com/questions/48291562/sorting-2d-array-matrix-in-c#comment83571118_48291562\">comment</a>, I think the solution has to be tackled in three separate sorting operations:</p>\n\n<ul>\n<li>Sorting the diagonal</li>\n<li>Sorting the upper triangle</li>\n<li>Sorting the lower triangle</li>\n</ul>\n\n<p>The sequence in which those operations occur is immaterial.  Indeed, if you want to run the three sorts in parallel with threads, you could do that.</p>\n\n<p>The trick to sorting the diagonal is to write a comparison function that ensures that all even numbers come before all odd numbers (so every even number is deemed smaller than any odd number), but when two even numbers are compared, they're sorted in ascending order whereas when two odd numbers are compared, they're sorted in descending order.  The <code>cmp_aeod()</code> function (<strong>a</strong>scending <strong>e</strong>ven <strong>o</strong>dd <strong>d</strong>escending) function achieves this.</p>\n\n<p>It would be possible to work with just one of the <code>cmp_asc()</code> and <code>cmp_dsc()</code> functions, but it is more straight-forward to have both.  The <code>(x &gt; y) - (x &lt; y)</code> idiom does two comparison always, but if <code>x</code> is bigger than <code>y</code>, the first term is <code>1</code>, the second <code>0</code>, and the result is <code>1</code>.  If <code>x</code> is smaller than <code>y</code>, the first term is <code>0</code>, the second is <code>1</code>, and the result is <code>-1</code>.  If <code>x</code> is equal to <code>y</code>, of course, both terms are <code>0</code> and the result is also <code>0</code>.</p>\n\n<p>The key to sorting the triangles is to note that sorting algorithms work on contiguous arrays, but the data in the triangles is not contiguous.  The solution shown is to number the elements in the triangle from <code>0</code> to <code>m</code>, where <code>m = (n * (n - 1)) / 2</code>, given that the square matrix is an <code>n</code> by <code>n</code> one.  The code then needs to be able to identify which indexes in the <code>matrix</code> should be accessed for the corresponding element number, and this mapping is done by the <code>ut</code> or <code>lt</code> matrix in the triangle-sorting functions.  I couldn't work out a non-iterative formula to convert the sequence number in the triangle into a row/col pair, so I created the map matrix.  This gives an auxilliary storage requirement of size O(N<sup>2</sup>).</p>\n\n<p>The sort algorithm used is a simple quadratic sort; you can change it for a more sophisticated algorithm (quicksort or whatever) as you wish.</p>\n\n<pre><code>/*\n**  + Enter a square matrix of dimensions n .\n**  + Elements below main diagonal sort in ascending order.\n**  + Elements above main diagonal sort in descending order.\n**  + Elements on main diagonal sort :\n**    - first even numbers in ascending order.\n**    - then odd numbers in descending order.\n*/\n\nstatic inline int cmp_asc(int x, int y) { return (x &gt; y) - (x &lt; y); }\nstatic inline int cmp_dsc(int x, int y) { return (x &lt; y) - (x &gt; y); }\nstatic inline int cmp_eaod(int x, int y)\n{\n    int px = x &amp; 1;\n    int py = y &amp; 1;\n    if (px != py)\n        return px - py;\n    if (px == 1)\n        return cmp_dsc(x, y);\n    return cmp_asc(x, y);\n}\n\n#include &lt;stdio.h&gt;\n\nstatic void print_matrix(const char *tag, size_t r, size_t c, int matrix[r][c])\n{\n    printf(\"%s:\\n\", tag);\n    for (size_t i = 0; i &lt; r; i++)\n    {\n        for (size_t j = 0; j &lt; c; j++)\n            printf(\"%3d\", matrix[i][j]);\n        putchar('\\n');\n    }\n}\n\nstatic void sort_diagonal(size_t n, int matrix[n][n])\n{\n    for (size_t i = 0; i &lt; n; i++)\n    {\n        for (size_t j = i + 1; j &lt; n; j++)\n        {\n            if (cmp_eaod(matrix[i][i], matrix[j][j]) &gt; 0)\n            {\n                int t = matrix[i][i];\n                matrix[i][i] = matrix[j][j];\n                matrix[j][j] = t;\n            }\n        }\n    }\n}\n\n/*\n**   D0  U0  U1  U2  U3\n**   L0  D1  U4  U5  U6\n**   L1  L2  D3  U7  U8\n**   L3  L4  L5  D4  U9\n**   L6  L7  L8  L9  D5\n**\n** D0 = (0, 0); U0 = (0, 1); U1 = (0, 2); U2 = (0, 3); U3 = (0, 4);\n** L0 = (1, 0); D1 = (1, 1); U4 = (1, 2); U5 = (1, 3); U6 = (1, 4);\n** L1 = (2, 0); L2 = (2, 1); D2 = (2, 2); U7 = (2, 3); U8 = (2, 4);\n** L3 = (3, 0); L4 = (3, 1); L5 = (3, 2); D3 = (3, 3); U9 = (3, 4);\n** L6 = (4, 0); L7 = (4, 1); L8 = (4, 2); L9 = (4, 3); D4 = (4, 4); \n*/\n\n/*\n** It is probably best to create an array that does the mapping from an\n** index to the row/column, with one such mapping for the lower\n** triangle; one for the upper triangle.\n*/\n\nstatic void sort_lt(size_t n, int matrix[n][n])\n{\n    size_t m = (n * (n - 1)) / 2;\n    int lt[m][2];\n    size_t r = 1;\n    size_t c = 0;\n    for (size_t i = 0; i &lt; m; i++)\n    {\n        lt[i][0] = r;\n        lt[i][1] = c++;\n        if (c == r)\n        {\n            r++;\n            c = 0;\n        }\n    }\n    //print_matrix(\"LT map\", m, 2, lt);\n\n    for (size_t i = 0; i &lt; m; i++)\n    {\n        size_t xi = lt[i][0];\n        size_t yi = lt[i][1];\n        for (size_t j = i + 1; j &lt; m; j++)\n        {\n            size_t xj = lt[j][0];\n            size_t yj = lt[j][1];\n            if (cmp_asc(matrix[xi][yi], matrix[xj][yj]) &gt; 0)\n            {\n                int t = matrix[xi][yi];\n                matrix[xi][yi] = matrix[xj][yj];\n                matrix[xj][yj] = t;\n            }\n        }\n    }\n}\n\nstatic void sort_ut(size_t n, int matrix[n][n])\n{\n    size_t m = (n * (n - 1)) / 2;\n    int ut[m][2];\n    size_t r = 0;\n    size_t c = 0;\n    for (size_t i = 0; i &lt; m; i++)\n    {\n        ut[i][0] = r;\n        ut[i][1] = ++c;\n        if (c == n - 1)\n        {\n            r++;\n            c = r;\n        }\n    }\n    //print_matrix(\"UT map\", m, 2, ut);\n\n    for (size_t i = 0; i &lt; m; i++)\n    {\n        size_t xi = ut[i][0];\n        size_t yi = ut[i][1];\n        for (size_t j = i + 1; j &lt; m; j++)\n        {\n            size_t xj = ut[j][0];\n            size_t yj = ut[j][1];\n            if (cmp_dsc(matrix[xi][yi], matrix[xj][yj]) &gt; 0)\n            {\n                int t = matrix[xi][yi];\n                matrix[xi][yi] = matrix[xj][yj];\n                matrix[xj][yj] = t;\n            }\n        }\n    }\n}\n\nstatic void test_matrix(const char *tag, size_t n, int matrix[n][n])\n{\n    char buffer[64];\n    snprintf(buffer, sizeof(buffer), \"Matrix %s (%zux%zu) - before\", tag, n, n);\n    print_matrix(buffer, n, n, matrix);\n    //print_matrix(\"Before sorting diagonal\", n, n, matrix);\n    sort_diagonal(n, matrix);\n    //print_matrix(\"After sorting diagonal\", n, n, matrix);\n    sort_lt(n, matrix);\n    //print_matrix(\"After sorting lower triangle\", n, n, matrix);\n    sort_ut(n, matrix);\n    //print_matrix(\"After sorting upper triangle\", n, n, matrix);\n    snprintf(buffer, sizeof(buffer), \"Matrix %s (%zux%zu) - after\", tag, n, n);\n    print_matrix(buffer, n, n, matrix);\n}\n\nint main(void)\n{\n    int matrix1[5][5] =\n    {\n        { 1, 5, 4, 7, 2 },\n        { 4, 8, 5, 9, 0 },\n        { 2, 7, 6, 5, 3 },\n        { 3, 1, 7, 4, 9 },\n        { 2, 5, 1, 7, 3 },\n    };\n    test_matrix(\"SAMPLE1\", 5, matrix1);\n\n    // gen_matrix -i -n matrix2 -r 10 -c 10 -L 10 -H 99\n    int matrix2[10][10] =\n    {\n        { 87, 32, 98, 58, 60, 71, 46, 81, 70, 14, },\n        { 22, 92, 15, 98, 51, 26, 94, 67, 46, 56, },\n        { 71, 89, 86, 16, 20, 89, 97, 89, 45, 92, },\n        { 63, 13, 76, 19, 75, 19, 66, 89, 58, 41, },\n        { 82, 68, 75, 26, 58, 20, 89, 87, 65, 66, },\n        { 74, 83, 68, 92, 10, 98, 90, 21, 39, 63, },\n        { 24, 65, 23, 68, 62, 44, 48, 22, 27, 59, },\n        { 26, 27, 71, 71, 51, 31, 43, 69, 92, 10, },\n        { 54, 19, 41, 50, 10, 89, 42, 52, 94, 54, },\n        { 42, 50, 79, 48, 77, 18, 29, 40, 61, 63, },\n    };\n    test_matrix(\"SAMPLE 2\", 10, matrix2);\n\n    return 0;\n}\n</code></pre>\n\n<p>When run, the output is:</p>\n\n<pre><code>Matrix SAMPLE1 (5x5) - before:\n  1  5  4  7  2\n  4  8  5  9  0\n  2  7  6  5  3\n  3  1  7  4  9\n  2  5  1  7  3\nMatrix SAMPLE1 (5x5) - after:\n  4  9  9  7  5\n  1  6  5  5  4\n  1  2  8  3  2\n  2  3  4  3  0\n  5  7  7  7  1\nMatrix SAMPLE 2 (10x10) - before:\n 87 32 98 58 60 71 46 81 70 14\n 22 92 15 98 51 26 94 67 46 56\n 71 89 86 16 20 89 97 89 45 92\n 63 13 76 19 75 19 66 89 58 41\n 82 68 75 26 58 20 89 87 65 66\n 74 83 68 92 10 98 90 21 39 63\n 24 65 23 68 62 44 48 22 27 59\n 26 27 71 71 51 31 43 69 92 10\n 54 19 41 50 10 89 42 52 94 54\n 42 50 79 48 77 18 29 40 61 63\nMatrix SAMPLE 2 (10x10) - after:\n 48 98 98 97 94 92 92 90 89 89\n 10 58 89 89 87 81 75 71 70 67\n 10 13 86 66 66 65 63 60 59 58\n 18 19 22 92 58 56 54 51 46 46\n 23 24 26 26 94 45 41 39 32 27\n 27 29 31 40 41 98 26 22 21 20\n 42 42 43 44 48 50 87 20 19 16\n 50 51 52 54 61 62 63 69 15 14\n 65 68 68 68 71 71 71 74 63 10\n 75 76 77 79 82 83 89 89 92 19\n</code></pre>\n\n<p>The 'SAMPLE1 - before' data corresponds to the input in the question, and the 'SAMPLE 1 - after' output corresponds to the desired output.  The bigger matrix result seems to match the requirements too.</p>\n\n<p>I developed the diagonal sort first because it is by far the easiest; the even ascending, odd descending order is a problem I'd solved before.  I then developed one of the triangle sorts, and debugged that.  Getting the second triangle sorted was then very straight-forward.  Making sure that I had a good flexible matrix printing function also helped.  The commented out calls were all used at some point during the development.</p>\n\n<hr>\n\n<h3>Timing tests</h3>\n\n<p>The 'sort in place' code shown becomes very slow as the matrix grows.  There's an alternative method \u2014 copy the data out of the matrix into a 1D vector; sort the vector; copy the data back into the matrix.  I did some timing tests.  With a matrix size of 10x10, the times were comparable (15\u00b5s for the basic sort code shown above; 12\u00b5s for code using extract, quicksort, insert).  When the matrix size was 20x20, the performance was firmly in favour of the extract, quicksort, insert: 172\u00b5s vs 32\u00b5s in favour of quicksort, and by 900x900, the basic sort was taking 285s vs 0.054s for quicksort.  The discrepancy is growing faster than a quadratic sort can account for.  The trouble is the very complex access path to get to the elements being sorted.  The code for creating the <code>lt</code> and <code>ut</code> matrices remains useful.  The <code>lt</code> and <code>ut</code> matrices tell you which cells to collect the data from for sorting the triangle (order doesn't much matter while extracting the data since it is about to be sorted anyway), but also (crucially) tells you where to place each element in the sorted data.</p>\n\n<p>You can find my code on GitHub in my <a href=\"https://github.com/jleffler/soq\" rel=\"nofollow noreferrer\">SOQ</a> (Stack\nOverflow Questions) repository in the\n<a href=\"https://github.com/jleffler/soq/tree/master/src/so-4829-1562\" rel=\"nofollow noreferrer\">src/so-4829-1562</a>\nsub-directory.  (Note that at the moment, the code uses VLAs for intermediate matrices; it crashes at around 1000x1000 on a Mac.  I need to change it to use dynamic memory allocation in the sort code as well as in the data generation code.  It may get fixed, sooner or later.  Also, I'm not convinced there's enough time between refreshes of hardware to use the basic sort on 10000x10000 size matrices, though I think the quick sort code would still be usable.)</p>\n\n<p>Another interesting test would be to adapt the 'basic sort' to use extract, quadratic sort, insert when sorting the triangles.  I'm pretty sure it would vastly outpace the 'basic sort' code, though it would still lose out to the O(NlogN) quick sort code as the arrays got bigger.  The copying time becomes negligible compared to the sorting time.</p>\n\n<h3>Using <code>qsort()</code> etc</h3>\n\n<pre><code>/* SO 4829-1562 */\n\n#include \"time.sort2d-31.h\"\n#include \"emalloc.h\"\n\n/*\n**  + Enter a square matrix of dimensions n .\n**  + Elements below main diagonal sort in ascending order.\n**  + Elements above main diagonal sort in descending order.\n**  + Elements on main diagonal sort :\n**    - first even numbers in ascending order.\n**    - then odd numbers in descending order.\n*/\n\n/* Variation 4: Use system qsort() and common code to coordinate sorting of triangles */\n/* Avoids two matrices lt and ut, thereby reducing the extra data space needed. */\n\nstatic inline int cmp_asc(int x, int y) { return (x &gt; y) - (x &lt; y); }\nstatic inline int cmp_dsc(int x, int y) { return (x &lt; y) - (x &gt; y); }\nstatic inline int cmp_eaod(int x, int y)\n{\n    int px = x &amp; 1;\n    int py = y &amp; 1;\n    if (px != py)\n        return px - py;\n    if (px == 1)\n        return cmp_dsc(x, y);\n    return cmp_asc(x, y);\n}\n\nstatic int qs_cmp_int_asc(const void *v1, const void *v2)\n{\n    int i1 = *(const int *)v1;\n    int i2 = *(const int *)v2;\n    return cmp_asc(i1, i2);\n}\n\nstatic int qs_cmp_int_dsc(const void *v1, const void *v2)\n{\n    int i1 = *(const int *)v1;\n    int i2 = *(const int *)v2;\n    return cmp_dsc(i1, i2);\n}\n\nstatic int qs_cmp_int_eaod(const void *v1, const void *v2)\n{\n    int i1 = *(const int *)v1;\n    int i2 = *(const int *)v2;\n    return cmp_eaod(i1, i2);\n}\n\nstatic void sort_diagonal(size_t n, int matrix[n][n])\n{\n    int data[n];\n    for (size_t i = 0; i &lt; n; i++)\n        data[i] = matrix[i][i];\n    qsort(data, n, sizeof(data[0]), qs_cmp_int_eaod);\n    for (size_t i = 0; i &lt; n; i++)\n        matrix[i][i] = data[i];\n}\n\n/*\n**   D0  U0  U1  U2  U3\n**   L0  D1  U4  U5  U6\n**   L1  L2  D3  U7  U8\n**   L3  L4  L5  D4  U9\n**   L6  L7  L8  L9  D5\n**\n** D0 = (0, 0); U0 = (0, 1); U1 = (0, 2); U2 = (0, 3); U3 = (0, 4);\n** L0 = (1, 0); D1 = (1, 1); U4 = (1, 2); U5 = (1, 3); U6 = (1, 4);\n** L1 = (2, 0); L2 = (2, 1); D2 = (2, 2); U7 = (2, 3); U8 = (2, 4);\n** L3 = (3, 0); L4 = (3, 1); L5 = (3, 2); D3 = (3, 3); U9 = (3, 4);\n** L6 = (4, 0); L7 = (4, 1); L8 = (4, 2); L9 = (4, 3); D4 = (4, 4); \n*/\n\ntypedef void (*Copier)(int *val1, int *val2);\n\nstatic void copy_a_to_b(int *val1, int *val2) { *val2 = *val1; }\nstatic void copy_b_to_a(int *val1, int *val2) { *val1 = *val2; }\n\nstatic void copy_lt_data(size_t n, int matrix[n][n], int vector[], Copier copy)\n{\n    size_t m = (n * (n - 1)) / 2;\n    size_t r = 1;\n    size_t c = 0;\n    for (size_t i = 0; i &lt; m; i++)\n    {\n        (*copy)(&amp;matrix[r][c++], &amp;vector[i]);\n        if (c == r)\n        {\n            r++;\n            c = 0;\n        }\n    }\n}\n\nstatic void copy_ut_data(size_t n, int matrix[n][n], int vector[], Copier copy)\n{\n    size_t m = (n * (n - 1)) / 2;\n    size_t r = 0;\n    size_t c = 0;\n    for (size_t i = 0; i &lt; m; i++)\n    {\n        (*copy)(&amp;matrix[r][++c], &amp;vector[i]);\n        if (c == n - 1)\n        {\n            r++;\n            c = r;\n        }\n    }\n}\n\ntypedef void (*Mapper)(size_t n, int matrix[n][n], int vector[], Copier copy);\ntypedef int (*Comparator)(const void *v1, const void *v2);\n\nstatic void sort_triangle(size_t n, int matrix[n][n], Mapper mapper, Comparator cmp)\n{\n    size_t m = (n * (n - 1)) / 2;\n    int *data = MALLOC(m * sizeof(*data));\n\n    (*mapper)(n, matrix, data, copy_a_to_b);\n    qsort(data, m, sizeof(data[0]), cmp);\n    (*mapper)(n, matrix, data, copy_b_to_a);\n\n    FREE(data);\n}\n\nvoid quick_sort(size_t n, int matrix[n][n])\n{\n    sort_diagonal(n, matrix);\n    sort_triangle(n, matrix, copy_lt_data, qs_cmp_int_asc);\n    sort_triangle(n, matrix, copy_ut_data, qs_cmp_int_dsc);\n}\n</code></pre>\n\n<p>I also put a timing test together \u2014 see GitHub for the source code.  The results were:</p>\n\n<pre><code>Basic sort (10x10) - elapsed:    0.000010\nClean sort (10x10) - elapsed:    0.000008\nQuick sort (10x10) - elapsed:    0.000015\nBasic sort (20x20) - elapsed:    0.000153\nClean sort (20x20) - elapsed:    0.000112\nQuick sort (20x20) - elapsed:    0.000026\nBasic sort (30x30) - elapsed:    0.000800\nClean sort (30x30) - elapsed:    0.000645\nQuick sort (30x30) - elapsed:    0.000060\nBasic sort (40x40) - elapsed:    0.002661\nClean sort (40x40) - elapsed:    0.002057\nQuick sort (40x40) - elapsed:    0.000106\nBasic sort (50x50) - elapsed:    0.006347\nClean sort (50x50) - elapsed:    0.005038\nQuick sort (50x50) - elapsed:    0.000175\nBasic sort (60x60) - elapsed:    0.014120\nClean sort (60x60) - elapsed:    0.009732\nQuick sort (60x60) - elapsed:    0.000258\nBasic sort (70x70) - elapsed:    0.023101\nClean sort (70x70) - elapsed:    0.016593\nQuick sort (70x70) - elapsed:    0.000360\nBasic sort (80x80) - elapsed:    0.035169\nClean sort (80x80) - elapsed:    0.027466\nQuick sort (80x80) - elapsed:    0.000445\nBasic sort (90x90) - elapsed:    0.053590\nClean sort (90x90) - elapsed:    0.039012\nQuick sort (90x90) - elapsed:    0.000665\nBasic sort (100x100) - elapsed:    0.074192\nClean sort (100x100) - elapsed:    0.053694\nQuick sort (100x100) - elapsed:    0.000797\nBasic sort (200x200) - elapsed:    0.656721\nClean sort (200x200) - elapsed:    0.478688\nQuick sort (200x200) - elapsed:    0.002313\nBasic sort (300x300) - elapsed:    2.826153\nClean sort (300x300) - elapsed:    2.126663\nQuick sort (300x300) - elapsed:    0.004871\nBasic sort (400x400) - elapsed:    8.384908\nClean sort (400x400) - elapsed:    6.374244\nQuick sort (400x400) - elapsed:    0.008324\nBasic sort (500x500) - elapsed:   22.083337\nClean sort (500x500) - elapsed:   16.124325\nQuick sort (500x500) - elapsed:    0.014953\nBasic sort (600x600) - elapsed:   43.233985\nClean sort (600x600) - elapsed:   31.362548\nQuick sort (600x600) - elapsed:    0.019563\nBasic sort (700x700) - elapsed:   85.463261\nClean sort (700x700) - elapsed:   60.488744\nQuick sort (700x700) - elapsed:    0.027003\nBasic sort (800x800) - elapsed:  148.358024\nClean sort (800x800) - elapsed:  102.991679\nQuick sort (800x800) - elapsed:    0.038143\nBasic sort (900x900) - elapsed:  253.434539\nClean sort (900x900) - elapsed:  150.658682\nQuick sort (900x900) - elapsed:    0.045815\n\nQuick sort (10x10) - elapsed:    0.000007\nQuick sort (20x20) - elapsed:    0.000025\nQuick sort (30x30) - elapsed:    0.000057\nQuick sort (40x40) - elapsed:    0.000104\nQuick sort (50x50) - elapsed:    0.000196\nQuick sort (60x60) - elapsed:    0.000245\nQuick sort (70x70) - elapsed:    0.000397\nQuick sort (80x80) - elapsed:    0.000435\nQuick sort (90x90) - elapsed:    0.000538\nQuick sort (100x100) - elapsed:    0.000676\nQuick sort (200x200) - elapsed:    0.002780\nQuick sort (300x300) - elapsed:    0.005868\nQuick sort (400x400) - elapsed:    0.009393\nQuick sort (500x500) - elapsed:    0.016258\nQuick sort (600x600) - elapsed:    0.024982\nQuick sort (700x700) - elapsed:    0.031137\nQuick sort (800x800) - elapsed:    0.042561\nQuick sort (900x900) - elapsed:    0.052450\nQuick sort (1000x1000) - elapsed:    0.061720\nQuick sort (2000x2000) - elapsed:    0.229984\nQuick sort (3000x3000) - elapsed:    0.480724\nQuick sort (4000x4000) - elapsed:    0.826916\nQuick sort (5000x5000) - elapsed:    1.308370\nQuick sort (6000x6000) - elapsed:    1.890218\nQuick sort (7000x7000) - elapsed:    2.559171\nQuick sort (8000x8000) - elapsed:    3.346258\nQuick sort (9000x9000) - elapsed:    4.359553\nQuick sort (10000x10000) - elapsed:    5.345243\nQuick sort (20000x20000) - elapsed:   22.189061\nQuick sort (30000x30000) - elapsed:   51.385711\nQuick sort (40000x40000) - elapsed:   97.543689\nQuick sort (50000x50000) - elapsed:  177.373366\nQuick sort (60000x60000) - elapsed:  315.083561\nQuick sort (70000x70000) - elapsed:  476.135379\nQuick sort (80000x80000) - elapsed:  756.888114\nQuick sort (90000x90000) - elapsed: 1002.540185\n</code></pre>\n\n<p>At the very smallest sizes (10x10 or less), it is possible that the <code>qsort()</code> code is slower than the others \u2014 the difference is tiny (a few microseconds) but fairly consistent.  By the time you've reached 20x20, the <code>qsort()</code> code is persistently faster, and the discrepancy grows.  Note that the size, N, used for O(NlogN) or O(N<sup>2</sup>), corresponds to the square of the size of the matrix \u2014 so the amount of data to be sorted in a 20x20 matrix is four times the amount of data to be sorted in a 10x10 matrix.  The performance of the basic sort or 'clean sort' is so bad that a 90k x 90k matrix doesn't bear thinking about, but the <code>qsort()</code> code sorts it in a time comparable to the time taken by the others to sort a 900 x 900 matrix (1/10,000<sup>th</sup> the size).</p>\n\n<h3>Fixing the code added 2018-02-02</h3>\n\n<p>The code added to the question on 2018-02-02 is a good attempt at solving the problem in a different way.\nAs noted by the OP, it sometimes fails to sort the data correctly.</p>\n\n<p>The problem is that the code in the lower triangle</p>\n\n<p>Here's the code fixed so it produces the correct output on the two sample matrices used previously.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main(void)\n{\n    static int a[500][500];\n    int i, j, l, k, m, b, n, t, d, c;\n\n    printf(\"Unesite n kvadratne matrice:\\n\");\n    scanf(\"%d\", &amp;n);\n    printf(\"Matrica pre sortiranja\\n\\n\");\n\n    for (i = 0; i &lt; n; i++)\n    {\n        for (j = 0; j &lt; n; j++)\n        {\n            scanf(\"%d\", &amp;a[i][j]);\n        }\n    }\n\n    for (i = 0; i &lt; n; i++)\n    {\n        for (j = 0; j &lt; n; j++)\n            printf(\"%3d\", a[i][j]);\n        printf(\"\\n\");\n    }\n\n    for (i = 0; i &lt; n; i++)\n    {\n        for (j = 0; j &lt; n; j++)\n        {\n            if (i &gt; j) // ispod dijagonale (LT)\n            {\n                int s = j + 1;                                          // JL\n                for (l = i; l &lt; n; l++)\n                {\n                    //for (k = j; k &lt; l; k++)                           // OP\n                    for (k = s; k &lt; l; k++)                             // JL\n                    {\n                        //printf(\"a[%d][%d] = %d &lt;=&gt; a[%d][%d] %d\\n\",   // JL\n                        //    i, j, a[i][j], l, k, a[l][k]);            // JL\n                        //if (a[i][j] &gt; a[l][k] &amp;&amp; k &lt; l)               // OP\n                        if (a[i][j] &gt; a[l][k])                          // JL\n                        {\n                            t = a[i][j];\n                            a[i][j] = a[l][k];\n                            a[l][k] = t;\n                        }\n                    }\n                    s = 0;                                              // JL\n                }\n            }\n            if (i &lt; j) // iznad dijagonale (UT)\n            {\n                int s = j + 1;                                          // JL\n                for (m = i; m &lt; n; m++)\n                {\n                    //for (b = j; b &lt; n; b++)                           // OP\n                    for (b = s; b &lt; n; b++)                             // JL\n                    {\n                        //printf(\"a[%d][%d] = %d &lt;=&gt; a[%d][%d] %d\\n\",   // JL\n                        //    i, j, a[i][j], m, b, a[m][b]);            // JL\n                        //if (a[i][j] &lt; a[m][b] &amp;&amp; m &lt; b)               // OP\n                        if (a[i][j] &lt; a[m][b])                          // JL\n                        {\n                            t = a[i][j];\n                            a[i][j] = a[m][b];\n                            a[m][b] = t;\n                        }\n                    }\n                    s = m + 2;                                          // JL\n                }\n            }\n            if (i == j) // dijagonala\n            {\n                for (d = i; d &lt; n; d++)\n                {\n                    for (c = d + 1; c &lt; n; c++)\n                    {\n                        if (a[d][d] % 2 != 0 &amp;&amp; a[c][c] % 2 == 0)\n                        {\n                            t = a[d][d];\n                            a[d][d] = a[c][c];\n                            a[c][c] = t;\n                        }\n                    }\n                }\n                for (d = i; d &lt; n; d++)\n                {\n                    for (c = d + 1; c &lt; n; c++)\n                    {\n                        if (a[d][d] % 2 == 0 &amp;&amp; a[c][c] % 2 == 0\n                            &amp;&amp; a[d][d] &gt; a[c][c])\n                        {\n                            t = a[d][d];\n                            a[d][d] = a[c][c];\n                            a[c][c] = t;\n                        }\n                        else if (a[d][d] % 2 != 0 &amp;&amp; a[c][c] % 2\n                                 != 0 &amp;&amp; a[d][d] &lt; a[c][c])\n                        {\n                            t = a[d][d];\n                            a[d][d] = a[c][c];\n                            a[c][c] = t;\n                        }\n                    }\n                }\n            }\n        }\n    }\n\n    printf(\"Posle sortiranja:\\n\");\n    for (i = 0; i &lt; n; i++)\n    {\n        for (j = 0; j &lt; n; j++)\n            printf(\"%3d\", a[i][j]);\n        printf(\"\\n\");\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>The commented out printing operations were crucial to seeing what the trouble was.</p>\n\n<p><strong>Sample output</strong></p>\n\n<p>This program was <code>sort2d-mk2-73</code>.</p>\n\n<pre><code>$ sort2d-mk2-73 &lt; example-2.in\nUnesite n kvadratne matrice:\nMatrica pre sortiranja\n\n 87 32 98 58 60 71 46 81 70 14\n 22 92 15 98 51 26 94 67 46 56\n 71 89 86 16 20 89 97 89 45 92\n 63 13 76 19 75 19 66 89 58 41\n 82 68 75 26 58 20 89 87 65 66\n 74 83 68 92 10 98 90 21 39 63\n 24 65 23 68 62 44 48 22 27 59\n 26 27 71 71 51 31 43 69 92 10\n 54 19 41 50 10 89 42 52 94 54\n 42 50 79 48 77 18 29 40 61 63\nPosle sortiranja:\n 48 98 98 97 94 92 92 90 89 89\n 10 58 89 89 87 81 75 71 70 67\n 10 13 86 66 66 65 63 60 59 58\n 18 19 22 92 58 56 54 51 46 46\n 23 24 26 26 94 45 41 39 32 27\n 27 29 31 40 41 98 26 22 21 20\n 42 42 43 44 48 50 87 20 19 16\n 50 51 52 54 61 62 63 69 15 14\n 65 68 68 68 71 71 71 74 63 10\n 75 76 77 79 82 83 89 89 92 19\n$ sort2d-mk2-73 &lt; example-1.in\nUnesite n kvadratne matrice:\nMatrica pre sortiranja\n\n  1  5  4  7  2\n  4  8  5  9  0\n  2  7  6  5  3\n  3  1  7  4  9\n  2  5  1  7  3\nPosle sortiranja:\n  4  9  9  7  5\n  1  6  5  5  4\n  1  2  8  3  2\n  2  3  4  3  0\n  5  7  7  7  1\n$\n</code></pre>\n\n<p>For comparison, the code posted in the question (<code>sort2d-mk2-67</code>) generated:</p>\n\n<pre><code>$ sort2d-mk2-67 &lt; example-2.in\nUnesite n kvadratne matrice : \nMatrica pre sortiranja \n\nPosle sortiranja : \n    48      98      98      97      94      92      92      90      89      66  \n\n    10      58      89      89      89      87      81      75      70      63  \n\n    10      13      86      71      67      66      65      60      59      56  \n\n    18      19      22      92      58      58      54      51      46      46  \n\n    23      24      26      29      94      45      41      39      32      27  \n\n    26      27      31      40      41      98      26      22      21      20  \n\n    42      42      43      44      48      50      87      20      19      16  \n\n    50      51      52      54      61      62      63      69      15      14  \n\n    65      68      68      68      71      71      71      76      63      10  \n\n    74      75      77      79      82      83      89      89      92      19  \n\n$ sort2d-mk2-67 &lt; example-1.in\nUnesite n kvadratne matrice : \nMatrica pre sortiranja \n\nPosle sortiranja : \n    4      9      9      7      5  \n\n    1      6      5      5      3  \n\n    1      2      8      4      2  \n\n    2      3      5      3      0  \n\n    4      7      7      7      1  \n\n$\n</code></pre>\n\n<p>One of the changes between <code>sort2d-mk2-67.c</code> and <code>sort2d-mk2-73.c</code> was compressing the printing; another change was to print the matrix before and after the sorting operation.</p>\n\n<p>In the smaller matrix, you can see that the <code>3</code> in row 1 column 4 (counting from 0) should be the <code>4</code> in row 2 column 3.\nSimilarly, the <code>5</code> in row 3 column 2 should be the <code>4</code> in row 4 column 1.\nThe fixed code is OK.</p>\n\n<p>I've not benchmarked this code (yet).</p>\n"}], "owner": {"reputation": 25, "user_id": 9105272, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-E0rdkiilklM/AAAAAAAAAAI/AAAAAAAAAFk/nCK11Fi4Ybs/photo.jpg?sz=128", "display_name": "Petar Aleksovski", "link": "https://stackoverflow.com/users/9105272/petar-aleksovski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1189, "favorite_count": 0, "accepted_answer_id": 48296187, "answer_count": 1, "score": -1, "last_activity_date": 1517624113, "creation_date": 1516146069, "last_edit_date": 1517601615, "question_id": 48291562, "link": "https://stackoverflow.com/questions/48291562/sorting-2d-array-matrix-in-c", "title": "Sorting 2d array (matrix) in C", "body": "<p>I have a task to sort a 2d array but it is really hard for me. I can't figure out where I'm making a mistake.</p>\n\n<p><strong>It will be good to use while loop instead of for loop</strong></p>\n\n<p>Here is the task: </p>\n\n<ol>\n<li>Enter a square matrix of dimensions n.</li>\n<li>Elements below main diagonal sort in ascending order.</li>\n<li>Elements above main diagonal sort in descending order.</li>\n<li>Elements on main diagonal sort:\n\n<ul>\n<li>first even numbers in ascending order.</li>\n<li>then odd numbers in descending order.</li>\n</ul></li>\n</ol>\n\n<p>Matrix before sorting:</p>\n\n<pre><code>1  5  4  7  2\n\n4  8  5  9  0\n\n2  7  6  5  3\n\n3  1  7  4  9\n\n2  5  1  7  3\n</code></pre>\n\n<p>Matrix after sorting :</p>\n\n<pre><code>4  9  9  7  5\n\n1  6  5  5  4 \n\n1  2  8  3  2 \n\n2  3  4  3  0\n\n5  7  7  7  1\n</code></pre>\n\n<p>Here is the code: </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main () {\n\n    int n, i, j, a, k, l, o;\n    int m[50][50];\n\n    printf (\"Enter n of square matrix : \\n\");\n    scanf (\"%d\", &amp;n);\n\n    printf (\"Enter rows and columns numbers n :\\n\");\n\n    i = 0;\n    while (i &lt; n) {\n        j = 0;\n        while (j &lt; n) {\n            scanf (\"%d\", &amp;m[i][j]);\n            j++;\n        }\n        i++;\n    }\n    printf (\"Matrix before sorting \\n\");\n    i = 0;\n    while (i &lt; n) {\n        j = 0;\n        while (j &lt; n) {\n            printf (\"%d  \", m[i][j]);\n            j++;\n        }\n        printf (\"\\n\");\n        i++;\n    }\n    printf (\"Matrix after sorting \\n\");\n\n    i = 0;\n    while (i &lt; n) {\n        j = 0;\n        while (j &lt; n) {\n            if (i &lt; j) {\n                k = j + 1;\n                while (k &lt; (n - 1)) {\n                    if (m[i][k] &lt; m[i][k + 1]) {\n                        a = m[i][k];\n                        m[i][k] = m[i][k + 1];\n                        m[i][k + 1] = a;\n                    }\n                    k++;\n                }\n            } \n            else if (i &gt; j) {\n                l = i + 1;\n                while (l &lt; (n - 1)) {\n                    if (m[l][j] &gt; m[l + 1][j]) {\n                        a = m[l][j];\n                        m[l][j] = m[l + 1][j];\n                        m[l + 1][j] = a;\n                    }\n                    l++;\n                }\n            } \n            else {\n                if (m[i][j] % 2 == 0 &amp;&amp; m[i + 1][j + 1] % 2 == 0) {\n                    if (m[i][j] &gt; m[i + 1][j + 1]) {\n                        a = m[i][j];\n                        m[i][j] = m[i + 1][j + 1];\n                        m[i + 1][j + 1] = a;\n                    }\n                }\n                if (m[i][j] % 2 != 0 &amp;&amp; m[i + 1][j + 1] % 2 != 0) {\n                    if (m[i][j] &lt; m[i + 1][j + 1]) {\n                        a = m[i][j];\n                        m[i][j] = m[i + 1][j + 1];\n                        m[i + 1][j + 1] = a;\n                    }\n                }\n            }\n            j++;\n        }\n        i++;\n    }\n\n    i = 0;\n    while (i &lt; n) {\n        j = 0;\n        while (j &lt; n) {\n            printf (\"%d  \", m[i][j]);\n            j++;\n        }\n        printf (\"\\n\");\n        i++;\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p><strong>CHANGES MADE ON 02/02/2018</strong> </p>\n\n<p>I need to make simple code , without things like size_t,buffer and pointers etc...</p>\n\n<p>I made some code but when i use odd n number of matrix it wont work properly (for example 5x5) I don't know where i m making mistake .</p>\n\n<pre><code> #include &lt;stdio.h&gt;\n #include &lt;stdlib.h&gt;\n\n int main()\n {\nstatic int a[500][500];\nint i,j,l,k,m,b,n,t,d,c;\n\nprintf(\"Unesite n kvadratne matrice : \\n\");\nscanf(\"%d\" , &amp;n);\nprintf(\"Matrica pre sortiranja \\n \\n\");\n\nfor ( i = 0; i &lt; n; i++)\n{\n    for ( j = 0; j &lt; n ; j++)\n    {\n        scanf(\"%d\",&amp;a[ i ][ j ]);\n    }\n}\n\n\nfor ( i = 0; i &lt; n; i++)\n{\n    for ( j = 0; j &lt; n; j++)\n    {\n        if ( i &gt; j )  // ispod dijagonale\n        {\n                for ( l = i ; l &lt; n ; l++)\n            {\n                for ( k = j ; k &lt; l  ; k++ )\n                {\n                    if ( a[ i ][ j ] &gt; a[ l ][ k ] &amp;&amp; k  &lt; l )\n                    {\n                    t = a[ i ][ j ];\n                    a[ i ][ j ] = a[ l ][ k ];\n                    a[ l ][ k ] = t ;\n                    }\n                }\n            }\n        }\n        if ( i &lt; j ) // iznad dijagonale\n        {\n            for ( m = i ; m &lt; n  ; m++)\n            {\n                for ( b = j ; b &lt; n ; b++)\n                {\n                    if ( a[ i ][ j ] &lt; a[ m ][ b ] &amp;&amp; m &lt; b )\n                    {\n                    t = a[ i ][ j ];\n                    a[ i ][ j ] = a[ m ][ b ];\n                    a[ m ][ b ] = t ;\n                    }\n                }\n            }\n        }\n        if ( i == j ) // dijagonala\n        {\n            for (d = i ; d &lt; n ; d++)\n                {\n                for ( c = d + 1 ; c &lt; n ; c++)\n                    {\n                    if ( a[ d ] [ d ] % 2 != 0 &amp;&amp; a[ c ] [ c]%2 == 0 )\n                        {\n                        t = a[ d ] [ d ] ;\n                         a[ d ] [ d ] = a[ c ] [ c] ;\n                         a[ c ] [ c] = t ;\n                        }\n                    }\n                }\n                for (d = i ; d &lt; n ; d++)\n                    {\n                    for ( c = d + 1 ; c &lt; n ; c++)\n                        {\n                             if ( a[ d ][ d ] %2 == 0 &amp;&amp; a[ c ][ c ] %2 ==0 \n       &amp;&amp; a[ d ][ d ] &gt; a [ c ][ c ])\n                            {\n                            t = a[ d ] [ d ] ;\n                            a[ d ] [ d ] = a[ c ] [ c] ;\n                            a[ c ] [ c] = t ;\n                            }\n                            else if ( a[ d ][ d ] %2 != 0 &amp;&amp; a[ c ][ c ] %2 \n   !=0 &amp;&amp; a[ d ][ d ] &lt; a [ c ][ c ])\n                            {\n                            t = a[ d ] [ d ] ;\n                            a[ d ] [ d ] = a[ c ] [ c] ;\n                            a[ c ] [ c] = t ;\n                            }\n                        }\n                    }\n        }\n    }\n  }\n\n    printf(\"Posle sortiranja : \\n\");\n    for ( i = 0; i &lt; n; i++)\n    {\n        for ( j = 0; j &lt; n;j++)\n        {\n        printf(\"    %d  \",a[i][j]);\n        }\n    printf(\"\\n \\n\");\n    }\n  return 0;\n }\n</code></pre>\n"}, {"tags": ["c", "scanf", "language-lawyer"], "answers": [{"comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 1, "creation_date": 1516146149, "post_id": 48291547, "comment_id": 83568170, "body": "Counterpoint: The result of converting 1025 to <code>unsigned char</code> is 1 (6.3.1.3/2). 1 can be represented in <code>u</code>."}, {"owner": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1516146240, "post_id": 48291547, "comment_id": 83568188, "body": "@melpomene: Yeah, I thought of that after posting, so now I&#39;m trying to see if there&#39;s anything more explicit in the standard."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 2, "creation_date": 1516146289, "post_id": 48291547, "comment_id": 83568197, "body": "@melpomene: I believe the word &quot;conversion&quot; is being used differently here. Yes, a type conversion of the value <code>1025</code> to <code>unsigned char</code> yields <code>1</code> (assuming, e.g., <code>CHAR_BIT==8</code>). But the &quot;conversion&quot; being discussed here is from an input item (a sequence of characters) to the target type. The result of that conversion (of the string <code>&quot;1025&quot;</code> to an integer) is 1025, which cannot be represented in an <code>unsigned char</code> object."}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 2, "creation_date": 1516146320, "post_id": 48291547, "comment_id": 83568206, "body": "@melpomene: I agree there is some ambiguity and underspecification here, but I think the conclusion is correct. There is no language to suggest that the conversion takes place first by conversion from a character sequence to an arbitrary-precision integer, then as if by a conversion of integer types. It&#39;s suggested (but not clearly stated) that the conversion happens as if by <code>strtol</code>-family functions (which don&#39;t exist for all types); in that case out-of-bounds values produce errors, not wrapping."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "reply_to_user": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 1, "creation_date": 1516146621, "post_id": 48291547, "comment_id": 83568296, "body": "@R.. The <code>strtol</code> stuff only describes the format of the input (in particular, the &quot;subject sequence&quot; of strto(u)l), not the actual conversion/mapping."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "reply_to_user": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1516147245, "post_id": 48291547, "comment_id": 83568459, "body": "@KeithThompson I&#39;m inclined to agree with you (6.3 &quot;Conversions&quot; doesn&#39;t apply here). But that means any use of a <code>scanf</code> directive (other than <code>%%</code> and <code>%*...</code>) has undefined behavior, because this &quot;conversion&quot; is not defined anywhere (&quot;<i>the input item [...] is converted to a type appropriate to the conversion specifier</i>&quot; and &quot;<i>An input item is defined as the longest sequence of input characters [...]</i>&quot;). It&#39;s not a number-&gt;number or pointer-&gt;number conversion. As far as I can tell, its semantics aren&#39;t defined anywhere."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1516147569, "post_id": 48291547, "comment_id": 83568549, "body": "@melpomene: I seems to me that the conversions are defined in 7.21.6.2 (fscanf). For example a <code>d</code> conversion specifier &quot;Matches an optionally signed decimal integer, whose format is the same as expected for the subject sequence of the <code>strtol</code> function with the value 10 for the <code>base</code> argument.&quot; It may be that some aspects are not defined explicitly, but the meaning seems clear enough."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "reply_to_user": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 1, "creation_date": 1516148017, "post_id": 48291547, "comment_id": 83568674, "body": "@KeithThompson That gives a sort of arbitrary precision semantics, but it doesn&#39;t clarify what &quot;conversion&quot; means in that context. Specifically, in this case we&#39;d have to know how some abstract mathematical integer (which doesn&#39;t even have a C type) is converted to an <code>unsigned char</code> (or <code>unsigned int</code>, etc.). If it is reduced modulo MAX+1 (as usual for unsigned integers), all values are representable; if not, we get UB."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1516148570, "post_id": 48291547, "comment_id": 83568835, "body": "@melpomene: Reduction modulo MAX+1 is relevant only for type conversions. Since no type conversions occur here, only &quot;conversions&quot; of character sequences to the values they represent, I&#39;d say that an out-of-range value causes UB even for unsigned types. (It might have been helpful if the standard had uses a word other than &quot;conversion&quot;.)"}, {"owner": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 0, "creation_date": 1516149180, "post_id": 48291547, "comment_id": 83568996, "body": "Another thing to consider: &quot;the input item ... is converted to a type appropriate to the conversion specifier&quot;. The conversion specifier is specifically the <code>u</code> character, and does not include the <code>hh</code>. This may be interpreted as saying that the input item is converted to unsigned int, even when the conversion specification is <code>%hhu</code>. The result of that conversion would then be <code>1025u</code>, a value that cannot be represented in an 8-bit unsigned char."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1516149686, "post_id": 48291547, "comment_id": 83569116, "body": "@user2357112 Ah, but in <code>%hhu</code> the <code>hh</code> modifier specifies that the <code>u</code> conversion specifier takes an <code>unsigned char</code>, not an <code>unsigned int</code> (somehow the meaning of <code>u</code> is mutable and <code>hh</code> affects it). However, ambiguities like this just lend more support to my interpretation that any non-trivial use of <code>scanf</code> has undefined behavior. :-["}, {"owner": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 0, "creation_date": 1516158271, "post_id": 48291547, "comment_id": 83571055, "body": "I suppose it wouldn&#39;t make much sense for <code>%llu</code> to convert to unsigned int and try to store into an unsigned long long either."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1516469941, "post_id": 48291547, "comment_id": 83705048, "body": "This is one of the major reasons why I go around saying &quot;never use scanf, it&#39;s broken as specified&quot;."}, {"owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "reply_to_user": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1516739189, "post_id": 48291547, "comment_id": 83810074, "body": "@zwol: seems like <code>scanf</code> cannot be used safely even for simple cases of reading in integral values from &quot;unknown&quot; input; I always thought <code>scanf</code> to be a widely used function..."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "reply_to_user": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "edited": false, "score": 0, "creation_date": 1516743798, "post_id": 48291547, "comment_id": 83812326, "body": "@StephanLechner &quot;Widely used&quot; does not contradict &quot;<i>should not</i> ever be used&quot;."}], "tags": [], "owner": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "is_accepted": true, "score": 6, "last_activity_date": 1516145962, "creation_date": 1516145962, "answer_id": 48291547, "question_id": 48291505, "link": "https://stackoverflow.com/questions/48291505/given-an-hhu-and-an-input-1025-which-part-is-mapped-to-an-unsigned-char/48291547#48291547", "title": "given an %hhu and an input 1025, which part is mapped to an unsigned char?", "body": "<p>Undefined. See <a href=\"http://port70.net/~nsz/c/c11/n1570.html#7.21.6.2p10\" rel=\"noreferrer\">one section up:</a></p>\n\n<blockquote>\n  <p>10 Except in the case of a % specifier, the input item (or, in the case of a %n directive, the count of input characters) is converted to a type appropriate to the conversion specifier. If the input item is not a matching sequence, the execution of the directive fails: this condition is a matching failure. Unless assignment suppression was indicated by a *, the result of the conversion is placed in the object pointed to by the first argument following the format argument that has not already received a conversion result. If this object does not have an appropriate type, <strong>or if the result of the conversion cannot be represented in the object, the behavior is undefined</strong>.</p>\n</blockquote>\n"}], "owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 704, "favorite_count": 1, "accepted_answer_id": 48291547, "answer_count": 1, "score": 3, "last_activity_date": 1516145962, "creation_date": 1516145696, "last_edit_date": 1516145938, "question_id": 48291505, "link": "https://stackoverflow.com/questions/48291505/given-an-hhu-and-an-input-1025-which-part-is-mapped-to-an-unsigned-char", "title": "given an %hhu and an input 1025, which part is mapped to an unsigned char?", "body": "<p>Is the output of the following programm <code>1</code> or <code>0</code>, or is it undefined behaviour?</p>\n\n<pre><code>int main() {\n  unsigned char u = 10;\n  sscanf(\"1025\",\"%hhu\",&amp;u);\n  printf(\"u, is it 0 or is it 1? u's value is ... %hhu\", u);\n}\n</code></pre>\n\n<p>According to <code>fscanf</code> <a href=\"http://port70.net/~nsz/c/c11/n1570.html#7.21.6.2p12\" rel=\"nofollow noreferrer\">conversion specifier</a> <code>%u</code> with <a href=\"http://port70.net/~nsz/c/c11/n1570.html#7.21.6.2p11\" rel=\"nofollow noreferrer\">length modifier</a> <code>hh</code> (i.e. <code>%hhu</code>), semantics is defined based on that of <code>strtoul</code> function and a mapping to type pointer to unsigned char:</p>\n\n<blockquote>\n  <p>12) The conversion specifiers and their meanings are:</p>\n  \n  <p><strong>\"u\"</strong>\n  Matches an optionally signed decimal integer, whose format is the same\n  as expected for the subject sequence of the strtoul function with the\n  value 10 for the base argument. The corresponding argument shall be a\n  pointer to unsigned integer.</p>\n  \n  <p>11) The length modifiers and their\n  meanings are:</p>\n  \n  <p><strong>\"hh\"</strong> Specifies that a following d, i, o, u, x,\n  X, or n conversion specifier applies to an argument with type pointer\n  to signed char or unsigned char.</p>\n</blockquote>\n\n<p>But what happens if an input sequence represents an integral value exceeding 8 bits, which part of the integral value is mapped to the 8 bits of an unsigned char? Is it defined that it has to be the least significant part, does it depend on endianess, is it unspecified, or does it even yield undefined behaviour?</p>\n\n<p>I cannot believe that it is undefined or unspecified behaviour. This would mean that user input might introduce such behaviour in a program using <code>scanf(\"%hhu\",&amp;u)</code>, and checking user input before every use of <code>scanf</code> looks absurd to me.</p>\n"}, {"tags": ["c", "recursion"], "comments": [{"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 1, "creation_date": 1516145727, "post_id": 48291471, "comment_id": 83568065, "body": "Why are you using <code>ZERO</code> instead of 0, and <code>ONE</code> instead if 1? You have to do the recursion for every digit, and do <code>count + 1</code> only if the current digit is odd. Also your end condition should be <code>num == 0</code>, there is no way that a positive integer divided by 10 is going to be negative."}], "answers": [{"comments": [{"owner": {"reputation": 17958, "user_id": 1971013, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/EtqFE.jpg?s=128&g=1", "display_name": "meaning-matters", "link": "https://stackoverflow.com/users/1971013/meaning-matters"}, "edited": false, "score": 0, "creation_date": 1516146127, "post_id": 48291535, "comment_id": 83568164, "body": "Great answer. Yet, I&#39;d put the second <code>return</code> in an <code>else</code> clause because it&#39;s a symmetrical situation."}, {"owner": {"reputation": 15145, "user_id": 4271923, "user_type": "registered", "profile_image": "https://graph.facebook.com/543414580/picture?type=large", "display_name": "Ped7g", "link": "https://stackoverflow.com/users/4271923/ped7g"}, "reply_to_user": {"reputation": 17958, "user_id": 1971013, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/EtqFE.jpg?s=128&g=1", "display_name": "meaning-matters", "link": "https://stackoverflow.com/users/1971013/meaning-matters"}, "edited": false, "score": 0, "creation_date": 1516146359, "post_id": 48291535, "comment_id": 83568223, "body": "@meaning-matters hmm.. you mean <code>else</code> to the previous <code>return 0;</code> path? I can understand that, but I prefer my way, in more complex source the early <code>if (..) return early something;</code> without <code>else { }</code> avoid excessive indentation. It makes reading code flow a bit harder as multiple exit paths exist in single function, but in case of the simple terminal conditions from my experience it is easier to read+maintain multi-return brevity code with limited blocks, than single return path with lot of nested blocks."}, {"owner": {"reputation": 13984, "user_id": 501126, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/839de8a602b21abf36e020bcb32959fe?s=128&d=identicon&r=PG", "display_name": "nemequ", "link": "https://stackoverflow.com/users/501126/nemequ"}, "edited": false, "score": 0, "creation_date": 1516146465, "post_id": 48291535, "comment_id": 83568252, "body": "<code>return (num != 0) ? countOdd(num &#47; 10, count + (num &amp; 1)) : count;</code>"}, {"owner": {"reputation": 15145, "user_id": 4271923, "user_type": "registered", "profile_image": "https://graph.facebook.com/543414580/picture?type=large", "display_name": "Ped7g", "link": "https://stackoverflow.com/users/4271923/ped7g"}, "reply_to_user": {"reputation": 13984, "user_id": 501126, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/839de8a602b21abf36e020bcb32959fe?s=128&d=identicon&r=PG", "display_name": "nemequ", "link": "https://stackoverflow.com/users/501126/nemequ"}, "edited": false, "score": 0, "creation_date": 1516146528, "post_id": 48291535, "comment_id": 83568268, "body": "@nemequ I don&#39;t have two arguments input on <code>countOdd</code>... feel free to post your own answer with own variant of course, this comment is just question what you  mean, as I can&#39;t see how that relates to my example. (even if I would use the excessive second <code>count</code> argument, your code basically doesn&#39;t bring any significant advantage, as it will assemble into roughly same machine code)."}, {"owner": {"reputation": 15145, "user_id": 4271923, "user_type": "registered", "profile_image": "https://graph.facebook.com/543414580/picture?type=large", "display_name": "Ped7g", "link": "https://stackoverflow.com/users/4271923/ped7g"}, "edited": false, "score": 0, "creation_date": 1516146891, "post_id": 48291535, "comment_id": 83568371, "body": "I mean, the two argument design is wrong, as it is clearly not needed in this case, and every additional argument on recursion means bigger stack memory usage per calling depth (not that it matters in this case, as <code>int</code> can have only 10 digits at most, so this is like tickling the stack on surface), but IMO the OP function signature design is worse than my (worse by a &quot;league&quot;, not just cosmetically)."}, {"owner": {"user_type": "does_not_exist", "display_name": "user7847469"}, "edited": false, "score": 0, "creation_date": 1516146896, "post_id": 48291535, "comment_id": 83568373, "body": "what is that? (num&amp;1) bitwise operator? @Ped7g"}, {"owner": {"reputation": 15145, "user_id": 4271923, "user_type": "registered", "profile_image": "https://graph.facebook.com/543414580/picture?type=large", "display_name": "Ped7g", "link": "https://stackoverflow.com/users/4271923/ped7g"}, "edited": false, "score": 0, "creation_date": 1516147065, "post_id": 48291535, "comment_id": 83568417, "body": "@AlexAlex integer numbers in computers are usually stored in binary encoding, in the &quot;bits&quot;. An <code>int</code> type in C on most of the current common target platforms is 32 bits &quot;wide&quot;. If you will check how values are encoded in binary, you will see that the lowest bit is set to 1 iff the value is odd. And when value is odd, it&#39;s last digit is odd (in base 10 &quot;human&quot; formatting). So I use the lowest bit value to add count of odd digits at last position (either one or zero), then by doing <code>&#47;10</code> I remove that digit and continue recursively with shortened value to count odd digits on remaining positions"}, {"owner": {"user_type": "does_not_exist", "display_name": "user7847469"}, "edited": false, "score": 0, "creation_date": 1516147202, "post_id": 48291535, "comment_id": 83568450, "body": "is there a way to do that without this operand? &amp;1 because I&#39;m not allowed to use that to solve this problem (school)"}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1516147362, "post_id": 48291535, "comment_id": 83568495, "body": "@alex In this case the <code>(num&amp;1)</code> part could be written as <code>(num % 2)</code>"}, {"owner": {"reputation": 15145, "user_id": 4271923, "user_type": "registered", "profile_image": "https://graph.facebook.com/543414580/picture?type=large", "display_name": "Ped7g", "link": "https://stackoverflow.com/users/4271923/ped7g"}, "edited": false, "score": 0, "creation_date": 1516147374, "post_id": 48291535, "comment_id": 83568498, "body": "is there a way? Yes, there&#39;re are millions of ways. You are doing <code>temp % 2</code> which any sane compiler will assemble as <code>temp&amp;1</code> anyway, so you are actually using it too, you just don&#39;t see it, nor you don&#39;t demonstrate that you understand binary numbers and CPU performance characteristics. Forcing you to write odd-ness test by <code>% 2</code> even when you understand what <code>&amp; 1</code> does is cruel joke, and I would object with lector. Keep in mind that every time somebody writes <code>x % 2</code> in C source, a kitten dies, which is very cruel and irresponsible. (the exact replacement is <code>(x&amp;1)</code> &lt;=&gt; <code>(x % 2)</code>  (fixed)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user7847469"}, "edited": false, "score": 1, "creation_date": 1516147521, "post_id": 48291535, "comment_id": 83568538, "body": "Haha I&#39;m very sorry but I&#39;m a beginner and this what the teacher demands, I actually do understand the bit wise a bit and I do understand your point, I promise when I will write my own code I will use it, thank you!"}], "tags": [], "owner": {"reputation": 15145, "user_id": 4271923, "user_type": "registered", "profile_image": "https://graph.facebook.com/543414580/picture?type=large", "display_name": "Ped7g", "link": "https://stackoverflow.com/users/4271923/ped7g"}, "is_accepted": false, "score": 4, "last_activity_date": 1516145896, "creation_date": 1516145896, "answer_id": 48291535, "question_id": 48291471, "link": "https://stackoverflow.com/questions/48291471/recursion-not-getting-me-the-output-i-need/48291535#48291535", "title": "Recursion not getting me the output I need", "body": "<p>whatever non-negative value divided by 10 will be again non-negative.</p>\n\n<p>But your recursion termination condition is <code>if (num&lt;ZERO)return count;</code>, that will never happen.</p>\n\n<p>A fixed variant of your code may look like this (still using recursion for your educational reasons, otherwise non recursive code would be better):</p>\n\n<pre><code>int countOdd(int num) {\n    if (num &lt;= 0) return 0;\n    return (num&amp;1) + countOdd(num/10);\n}\n</code></pre>\n\n<p>Also don't use <code>printf</code> for debugging your code, use proper debugger.</p>\n"}, {"comments": [{"owner": {"reputation": 15145, "user_id": 4271923, "user_type": "registered", "profile_image": "https://graph.facebook.com/543414580/picture?type=large", "display_name": "Ped7g", "link": "https://stackoverflow.com/users/4271923/ped7g"}, "edited": false, "score": 0, "creation_date": 1516150158, "post_id": 48291954, "comment_id": 83569236, "body": "Nice catch with the missing returns, I actually completely overlooked it. IMO it&#39;s very good OP can now see also fixed code which looks almost identical to his original one, as my variant is (intentionally) completely different almost in every aspect."}], "tags": [], "owner": {"reputation": 710, "user_id": 3788270, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83e3fed9f9ac097afe784d86ab44692d?s=128&d=identicon&r=PG&f=1", "display_name": "Ove", "link": "https://stackoverflow.com/users/3788270/ove"}, "is_accepted": false, "score": 1, "last_activity_date": 1516149114, "creation_date": 1516149114, "answer_id": 48291954, "question_id": 48291471, "link": "https://stackoverflow.com/questions/48291471/recursion-not-getting-me-the-output-i-need/48291954#48291954", "title": "Recursion not getting me the output I need", "body": "<p>As you said, you're supposed to return something. So make sure you return something, i.e., add the missing return statements. Also terminate the recursion when you reach zero, or you'll have an infinite loop.</p>\n\n<pre><code>int countOdd(int num, int count)\n{\n    int temp;\n    printf(\"num\\n%d\", num);\n    if (num&lt;=ZERO) return count;\n    temp = num % 10;\n    if ((temp % 2) != 0) return countOdd(num / 10, count + ONE);\n    printf(\"test\");\n    return countOdd(num / 10, count);\n}\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user7847469"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1516149114, "creation_date": 1516145471, "question_id": 48291471, "link": "https://stackoverflow.com/questions/48291471/recursion-not-getting-me-the-output-i-need", "title": "Recursion not getting me the output I need", "body": "<p>I'm new to programing and I'm doing recursion exercises, and one of them was to count how many odd numbers I have inside a number:</p>\n\n<p>this is my code:</p>\n\n<pre><code>int countOdd(int num, int count)\n{\n    int temp;\n    printf(\"num\\n%d\", num);\n    if (num&lt;ZERO)return count;\n    temp = num % 10;\n    if ((temp % 2) != 0) countOdd(num / 10, count + ONE);\n    printf(\"test\");\n    countOdd(num / 10, count);\n\n\n}\n</code></pre>\n\n<p>its suppose to get the number and count how many odd number there is and return it as a value, could someone explain to me why it isn't working, tips and ideas will be highly appreciated.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 44000, "user_id": 535275, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/Ft2Mw.jpg?s=128&g=1", "display_name": "Scott Hunter", "link": "https://stackoverflow.com/users/535275/scott-hunter"}, "edited": false, "score": 0, "creation_date": 1516145112, "post_id": 48291385, "comment_id": 83567892, "body": "Maybe something is wrong with <code>add_dictionary_first</code>?"}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1516145166, "post_id": 48291385, "comment_id": 83567911, "body": "@uan J. Mart  The pointer word points to the same local array word = strtok(line, exeption);"}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1516145283, "post_id": 48291385, "comment_id": 83567942, "body": "Show us your <code>add_dictionary_first</code>"}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1516145399, "post_id": 48291385, "comment_id": 83567973, "body": "<i>The pointer word points to the same local array <code>word = strtok(line, exeption);</code></i> yes but <code>strtok</code> also modifies the buffer, putting <code>\\0</code> at the end of the first token. It depends how <code>add_dictionary_first</code> copies the word, if it just a pointer assignment then that&#39;s a problem, it needs to do a <code>strcpy</code>"}, {"owner": {"reputation": 27, "user_id": 9226807, "user_type": "registered", "profile_image": "https://graph.facebook.com/1696038770418248/picture?type=large", "display_name": "Juan J. Mart", "link": "https://stackoverflow.com/users/9226807/juan-j-mart"}, "edited": false, "score": 0, "creation_date": 1516146054, "post_id": 48291385, "comment_id": 83568140, "body": "already add the function."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1516148008, "post_id": 48291385, "comment_id": 83568671, "body": "<code>dictionary *load_word(blabalabal)</code> <b>what is</b> dictionary?"}], "answers": [{"tags": [], "owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "is_accepted": true, "score": 1, "last_activity_date": 1516147780, "last_edit_date": 1516147780, "creation_date": 1516147181, "answer_id": 48291707, "question_id": 48291385, "link": "https://stackoverflow.com/questions/48291385/save-first-word-a-file-in-c/48291707#48291707", "title": "Save first word a file in c", "body": "<p>The problem lies within this line (as Vlad from Moscow posted in the comments):</p>\n\n<pre><code>D-&gt;Distribution[D-&gt;size-1]-&gt;value = value;\n</code></pre>\n\n<p>This is just pointer assignment. That's not wrong per se, but depending on the\ncontext, it is not what you want.</p>\n\n<pre><code>while (fgets(line, LONG_MAX_LINE, date ) != NULL)\n{   \n    word = strtok(line, exeption); /*first word*/\n    add_dictionary_first(D_first, j, word);\n    ...\n}\n</code></pre>\n\n<p>Here you call <code>add_dictionary_first</code> always with the same variable <code>line</code>. It is\nan array but arrays decay into pointers when passing them as arguments to\nfunctions. That means that all your <code>D-&gt;Distribution[D-&gt;size-1]-&gt;value</code> point to\nthe same location. The last line in your input file begins with <code>to</code> and that's why you get only\n<code>to</code>.</p>\n\n<p>You need to copy the string with <code>strcpy</code>.</p>\n\n<blockquote>\n  <p><em>man strcpy</em></p>\n\n<pre><code>#include &lt;string.h&gt;\n\nchar *strcpy(char *dest, const char *src);\n</code></pre>\n  \n  <p>The <code>strcpy()</code>  function  copies  the  string pointed to by <code>src</code>, including the terminating\n  null byte (<code>'\\0'</code>), to the buffer pointed to by\n  <code>dest</code>. The strings may not overlap, and the destination string <code>dest</code> must be\n  large enough to receive the copy.</p>\n</blockquote>\n\n<p>Because you haven't posted the structure I can only guess that <code>value</code> is\ndeclared as <code>char*</code> (if it were <code>char[]</code> the compiler would have complained).</p>\n\n<p><strong>Option 1</strong></p>\n\n<pre><code>D-&gt;Distribution[D-&gt;size-1]-&gt;value = malloc(strlen(value) + 1); // note the +1 here\nif(D-&gt;Distribution[D-&gt;size-1]-&gt;value == NULL)\n{\n    // error handling\n}\nstrcpy(D-&gt;Distribution[D-&gt;size-1]-&gt;value, value);\n</code></pre>\n\n<p><strong>Option 2</strong></p>\n\n<p>If <code>strdup</code> is available in your system</p>\n\n<pre><code>D-&gt;Distribution[D-&gt;size-1]-&gt;value = strdup(value);\nif(D-&gt;Distribution[D-&gt;size-1]-&gt;value == NULL)\n{\n    // error handling\n}\n</code></pre>\n\n<p>In either case you would have to free the memory later.</p>\n"}], "owner": {"reputation": 27, "user_id": 9226807, "user_type": "registered", "profile_image": "https://graph.facebook.com/1696038770418248/picture?type=large", "display_name": "Juan J. Mart", "link": "https://stackoverflow.com/users/9226807/juan-j-mart"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 135, "favorite_count": 0, "accepted_answer_id": 48291707, "answer_count": 1, "score": 1, "last_activity_date": 1516147780, "creation_date": 1516144946, "last_edit_date": 1592644375, "question_id": 48291385, "link": "https://stackoverflow.com/questions/48291385/save-first-word-a-file-in-c", "title": "Save first word a file in c", "body": "<p>I have a problem with this part of my code, I'm trying to read the lines of a file and cut only the first word of each line and then save it in an array.</p>\n<p><strong>Example:</strong></p>\n<blockquote>\n<p>two roads diverged in a yellow wood</p>\n<p>and sorry i could not travel both</p>\n<p>and be one traveler long i stood</p>\n<p>and looked down one as far as i could</p>\n<p>to where it bent in the undergrowth</p>\n</blockquote>\n<p>and as a result I expect a vector like this: &quot;two, and, and, and, to&quot;</p>\n<p>but I get this: &quot;to, to, to, to, to&quot;.</p>\n<p><strong>My code</strong></p>\n<pre><code>dictionary *load_word(int autor, dictionary *D_first)\n{\n  FILE *date;\n  char line[LONG_MAX_LINE];\n  char exeption[4] = &quot; \\n\\t&quot;;\n  char *word;\n  int j=0;\n  if (autor == 1)\n  {\n     if ((date = fopen(&quot;test.txt&quot;, &quot;r&quot;)) == NULL)\n     {\n        perror(&quot;robert_frost.txt&quot;);\n\n     }\n     while (fgets(line, LONG_MAX_LINE, date ) != NULL)\n     {   \n        word = strtok(line, exeption); /*first word*/\n        add_dictionary_first(D_first, j, word);\n       j++;\n     }\n\n    fclose(date);\n  }\n  return D_first;  \n}\n\nvoid add_dictionary_first(dictionary *D, int cont, const char *value)\n{\n  expand_dictionary(&amp;D, 1);\n  D-&gt;Distribution[D-&gt;size-1]-&gt;cont = cont;\n  D-&gt;Distribution[D-&gt;size-1]-&gt;value = value;\n}\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "c", "user-interface"], "comments": [{"owner": {"reputation": 194, "user_id": 4955118, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-FSFY-mD9PLU/AAAAAAAAAAI/AAAAAAAAALs/ZyLLxe1hayM/photo.jpg?sz=128", "display_name": "Shahe Ansar", "link": "https://stackoverflow.com/users/4955118/shahe-ansar"}, "edited": false, "score": 0, "creation_date": 1516144572, "post_id": 48291303, "comment_id": 83567738, "body": "Why not simply use a wrapper around the `` syntax for ruby, and execute the programs from there? You should be able to create the hooks in ruby."}, {"owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "edited": false, "score": 0, "creation_date": 1516173885, "post_id": 48291303, "comment_id": 83575824, "body": "The common way is to have C simple command programs that take their parameters from the command line, and then to have GUI tools that build the command parameters and simply execute an external command. But your current question is rather broad..."}, {"owner": {"reputation": 23, "user_id": 8974331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df4b8c154fab8525b73bb0491f92fa2d?s=128&d=identicon&r=PG&f=1", "display_name": "Yof", "link": "https://stackoverflow.com/users/8974331/yof"}, "reply_to_user": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "edited": false, "score": 0, "creation_date": 1516296498, "post_id": 48291303, "comment_id": 83639557, "body": "@SergeBallesta is what you&#39;re talking about suppose to work on a web framework (ruby on rails)? my question is not very broad. I have a C program that currently uses a simple looking GUI from CVI lab windows. I want to build a nicer looking GUI using Ruby On Rails and asking for the best way to do so. shahe Ansar Thanks, I&#39;ll look in to it."}], "owner": {"reputation": 23, "user_id": 8974331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df4b8c154fab8525b73bb0491f92fa2d?s=128&d=identicon&r=PG&f=1", "display_name": "Yof", "link": "https://stackoverflow.com/users/8974331/yof"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 86, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1516144310, "creation_date": 1516144310, "question_id": 48291303, "link": "https://stackoverflow.com/questions/48291303/using-ruby-on-rails-to-write-a-gui-for-c-project", "title": "Using Ruby On Rails to write a GUI for C project", "body": "<p>I have large programs written in C that provide an interface for various hardware chips and devices (over SPI mainly). I want to create GUI for these C programs using Ruby On Rails on browser. Meaning, whenever I connect my hardware, press an exe file (on windows) and then redirect to a ROR web app that would control the chip parameters (the same thing that's done by CVI lab in .uir file only way nicer).</p>\n\n<p>I've seen a few ways to integrate Ruby code in C programs and vice versa. Is there a simple way to use ROR apps and create hooks to C variables? is there a simpler way to write ROR code in a C program as is (I've seen Swig and Ruby on C API)?  </p>\n\n<p>Thanks!</p>\n"}, {"tags": ["c", "sdl-2"], "comments": [{"owner": {"reputation": 9112, "user_id": 2721883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5c8448407184c2a90cc46db06c159ca?s=128&d=identicon&r=PG&f=1", "display_name": "clcto", "link": "https://stackoverflow.com/users/2721883/clcto"}, "edited": false, "score": 0, "creation_date": 1516144460, "post_id": 48291260, "comment_id": 83567692, "body": "Is your question why were these particular values chosen for the enumeration values? Or why they are not just strictly increasing from 0 or 1?"}, {"owner": {"reputation": 998, "user_id": 8993709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f79d970224ae145b6b546107f6b572?s=128&d=identicon&r=PG&f=1", "display_name": "papillon", "link": "https://stackoverflow.com/users/8993709/papillon"}, "reply_to_user": {"reputation": 9112, "user_id": 2721883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5c8448407184c2a90cc46db06c159ca?s=128&d=identicon&r=PG&f=1", "display_name": "clcto", "link": "https://stackoverflow.com/users/2721883/clcto"}, "edited": false, "score": 0, "creation_date": 1516171577, "post_id": 48291260, "comment_id": 83574758, "body": "the latter, and it has been nicely answered"}], "answers": [{"tags": [], "owner": {"reputation": 32078, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "is_accepted": true, "score": 8, "last_activity_date": 1516144776, "last_edit_date": 1516144776, "creation_date": 1516144456, "answer_id": 48291319, "question_id": 48291260, "link": "https://stackoverflow.com/questions/48291260/why-do-sdl2-enumerations-have-high-unexpected-values/48291319#48291319", "title": "Why do SDL2 enumerations have high unexpected values?", "body": "<p>If you look at <code>SDL_events.h</code> then you'll see something like:</p>\n\n<pre><code>/* Window events */\nSDL_WINDOWEVENT    = 0x200, /**&lt; Window state change */\nSDL_SYSWMEVENT,             /**&lt; System specific event */\n\n/* Keyboard events */\nSDL_KEYDOWN        = 0x300, /**&lt; Key pressed */\nSDL_KEYUP,                  /**&lt; Key released */\n</code></pre>\n\n<p>So they are just defined with such spread values. The rationale behind this is to allow adding new values without breaking backwards compatibility while keeping certain enumerator values grouped.</p>\n"}, {"tags": [], "owner": {"reputation": 165, "user_id": 9214270, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5015413cdd23101b12239a68dfffc89?s=128&d=identicon&r=PG", "display_name": "CookiePLMonster", "link": "https://stackoverflow.com/users/9214270/cookieplmonster"}, "is_accepted": false, "score": 0, "last_activity_date": 1516144548, "creation_date": 1516144548, "answer_id": 48291334, "question_id": 48291260, "link": "https://stackoverflow.com/questions/48291260/why-do-sdl2-enumerations-have-high-unexpected-values/48291334#48291334", "title": "Why do SDL2 enumerations have high unexpected values?", "body": "<p>You seem to be misusing events. In your case:</p>\n\n<pre><code>if (event.type == SDL_QUIT || event.key.keysym.sym == SDLK_ESCAPE)\n</code></pre>\n\n<p>However, <code>event</code> is basically a huge union and fields inside <code>event.key</code> are only valid when <code>event.type</code> is one of key-related events.</p>\n\n<p>Maybe here lies your problem? To me that sounds like you misinterpreting what <code>SDL_PollEvent</code> returns.</p>\n\n<p>EDIT:\nThe person before me seems to be more on topic, however my point still stands. Admitedly, not exactly what you're asking about but you might still watch out for that.</p>\n"}], "owner": {"reputation": 998, "user_id": 8993709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f79d970224ae145b6b546107f6b572?s=128&d=identicon&r=PG&f=1", "display_name": "papillon", "link": "https://stackoverflow.com/users/8993709/papillon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 146, "favorite_count": 0, "accepted_answer_id": 48291319, "answer_count": 2, "score": 0, "last_activity_date": 1516144776, "creation_date": 1516144045, "question_id": 48291260, "link": "https://stackoverflow.com/questions/48291260/why-do-sdl2-enumerations-have-high-unexpected-values", "title": "Why do SDL2 enumerations have high unexpected values?", "body": "<p>I came across difficulties in debugging a SDL2 program: when I printed the values of enumerations such as <code>SDL_EventType</code> or <code>SDL_Keycode</code>, the values displayed were incredibly high and different from each other. For example, the event type <code>SDL_KEYDOWN</code> corresponded to 768 - and there aren't 769 elements in the enumeration <code>SDL_EventType</code>!</p>\n\n<p>I made a little test to see if this strange behaviour was due to my program, but the behaviour was still there:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include \"SDL.h\"\n\nint main(int argc, char *argv[])\n{\n  SDL_Init(SDL_INIT_VIDEO);\n  SDL_Event event;\n  SDL_Window *wind = SDL_CreateWindow(\"ee\", 700, 100, 300, 300, 0);\n  while (SDL_PollEvent == 1)\n    SDL_PollEvent(&amp;event);\n  while (1)\n  {\n    SDL_PollEvent(&amp;event);\n    if (event.type == SDL_QUIT || event.key.keysym.sym == SDLK_ESCAPE)\n      break;\n    fprintf(stderr, \"type = %d\\n\", event.type);\n    event.type = 0;\n    SDL_Delay(15);\n  }\n  printf(\"%d\\n\", SDL_GetTicks());\n  SDL_Quit();\n    return 0;\n}\n</code></pre>\n\n<p>Printing <code>SDLK_DOWN</code>, <code>SDL_MOUSEMOTION</code> or such keywords outputs the same result than the previous program, which is coherent. But why are these values not coherent with the enumeration type?</p>\n"}, {"tags": ["c", "malloc"], "comments": [{"owner": {"reputation": 27697, "user_id": 4433386, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/hbHEL.png?s=128&g=1", "display_name": "Marcus M&#252;ller", "link": "https://stackoverflow.com/users/4433386/marcus-m%c3%bcller"}, "edited": false, "score": 3, "creation_date": 1516142130, "post_id": 48290878, "comment_id": 83566925, "body": "<code>nums_to_read = bufsize &#47; 4</code>: Am I missing something or did you just define you just want to fill the first fourth?"}, {"owner": {"reputation": 4328, "user_id": 920069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd39f0db1f22e1314746491df063602a?s=128&d=identicon&r=PG", "display_name": "Retired Ninja", "link": "https://stackoverflow.com/users/920069/retired-ninja"}, "reply_to_user": {"reputation": 27697, "user_id": 4433386, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/hbHEL.png?s=128&g=1", "display_name": "Marcus M&#252;ller", "link": "https://stackoverflow.com/users/4433386/marcus-m%c3%bcller"}, "edited": false, "score": 4, "creation_date": 1516142162, "post_id": 48290878, "comment_id": 83566937, "body": "Your code doesn&#39;t compile. You might consider actually making a short complete example, headers, main, etc. What does the data in your file look like? How was the file created? Allocating an extra byte and null terminating a buffer of integers seems a little silly. As @MarcusM&#252;ller mentioned, you would need to use <code>sizeof(int)</code> as the size of an individual element in your fread call rather than 1 in order to read the right amount of data."}, {"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "reply_to_user": {"reputation": 27697, "user_id": 4433386, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/hbHEL.png?s=128&g=1", "display_name": "Marcus M&#252;ller", "link": "https://stackoverflow.com/users/4433386/marcus-m%c3%bcller"}, "edited": false, "score": 2, "creation_date": 1516142354, "post_id": 48290878, "comment_id": 83567006, "body": "@MarcusM&#252;ller: the problem lies in the combination of that number with <code>fread</code>. <code>bufsize&#47;4</code> is the number of elements but come <code>fread</code>, OP changed his mind and wants to read 1-byte elements."}, {"owner": {"reputation": 27697, "user_id": 4433386, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/hbHEL.png?s=128&g=1", "display_name": "Marcus M&#252;ller", "link": "https://stackoverflow.com/users/4433386/marcus-m%c3%bcller"}, "reply_to_user": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 0, "creation_date": 1516142382, "post_id": 48290878, "comment_id": 83567014, "body": "@usr2564301 obviously, yes. I was assuming that was clear from the context."}, {"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "reply_to_user": {"reputation": 27697, "user_id": 4433386, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/hbHEL.png?s=128&g=1", "display_name": "Marcus M&#252;ller", "link": "https://stackoverflow.com/users/4433386/marcus-m%c3%bcller"}, "edited": false, "score": 0, "creation_date": 1516142435, "post_id": 48290878, "comment_id": 83567029, "body": "@MarcusM&#252;ller: from the same context, it was obviously not that clear to OP :)"}, {"owner": {"reputation": 27697, "user_id": 4433386, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/hbHEL.png?s=128&g=1", "display_name": "Marcus M&#252;ller", "link": "https://stackoverflow.com/users/4433386/marcus-m%c3%bcller"}, "reply_to_user": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 0, "creation_date": 1516142514, "post_id": 48290878, "comment_id": 83567061, "body": "@usr2564301 yeah, that might very well be the case."}, {"owner": {"reputation": 1471, "user_id": 8276973, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/96a6954bd630cf29b8529b41d9ce66fc?s=128&d=identicon&r=PG&f=1", "display_name": "RTC222", "link": "https://stackoverflow.com/users/8276973/rtc222"}, "reply_to_user": {"reputation": 4328, "user_id": 920069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd39f0db1f22e1314746491df063602a?s=128&d=identicon&r=PG", "display_name": "Retired Ninja", "link": "https://stackoverflow.com/users/920069/retired-ninja"}, "edited": false, "score": 0, "creation_date": 1516142590, "post_id": 48290878, "comment_id": 83567080, "body": "@Retired Ninja -- you are correct.  Changing the file read line to size_t newLen = fread(buffer1, sizeof(int), nums_to_read, fp); corrected the problem and now it reads the entire file.  Thank you very much."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1516144509, "post_id": 48290878, "comment_id": 83567712, "body": "<code>size_t newLen = fread(buffer1, 1, bufsize, fp);</code> or <code>size_t newLen = fread(buffer1, sizeof *buf, nums_to_read, fp);</code>"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1516145086, "post_id": 48290878, "comment_id": 83567888, "body": "How is <code>(abc &lt; 0)</code> ever true when <i>&quot;the file contains 1000 random integers in the range 5 to 1000.&quot;</i>?"}], "answers": [{"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1516143105, "post_id": 48291073, "comment_id": 83567270, "body": "Code is still broken with <code>buffer1[++newLen] = &#39;\\0&#39;;</code>.  Suggest <code>buffer1[newLen] = &#39;\\0&#39;;</code>"}, {"owner": {"reputation": 1471, "user_id": 8276973, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/96a6954bd630cf29b8529b41d9ce66fc?s=128&d=identicon&r=PG&f=1", "display_name": "RTC222", "link": "https://stackoverflow.com/users/8276973/rtc222"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1516143200, "post_id": 48291073, "comment_id": 83567297, "body": "@chux 1 -- it makes no difference; works just the same either way."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1516143377, "post_id": 48291073, "comment_id": 83567365, "body": "<code>buffer1[++newLen]</code> can cause <i>undefined behavior</i> and so your results that way are moot.  Good code does not access outside the allocated memory: use <code>buffer1[newLen]</code>.  Review carefully what <code>buffer1[++newLen] = &#39;\\0&#39;;</code> attempts.  It is -off-by-1"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1516143718, "post_id": 48291073, "comment_id": 83567462, "body": "On review, even <code>buffer1[newLen]</code> may be a problem as <code>malloc(bufsize + 1);</code> may be too small.  To append an <code>int</code> zero, code should use <code>malloc(bufsize + sizeof(int))</code>.  IAC, that appended zero, does not appear to be used in the following code so no need to allocate for it nor assign it."}, {"owner": {"reputation": 1471, "user_id": 8276973, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/96a6954bd630cf29b8529b41d9ce66fc?s=128&d=identicon&r=PG&f=1", "display_name": "RTC222", "link": "https://stackoverflow.com/users/8276973/rtc222"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1516144463, "post_id": 48291073, "comment_id": 83567693, "body": "@chux In this case it doesn&#39;t matter because I instruct it to iterate over the first 1000 elements.  However, for complete safety your solution is intuitively correct.  I changed those lines to:  buffer1 = malloc(bufsize + sizeof(int)); buffer1[newLen+1] = &#39;\\0&#39;;"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1516144545, "post_id": 48291073, "comment_id": 83567727, "body": "Why the +1 in <code>buffer1[newLen+1] = &#39;\\0&#39;</code>?  Certainly <code>buffer1[newLen] = &#39;\\0&#39;</code> is what you want.  For simplicity, consider <code>bufsize == 0</code>,<code>sizeof(int)==4</code>.  <code>buffer1 = malloc(4); buffer1[1] = &#39;\\0&#39;;</code> accesses outside allocated memory."}, {"owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "edited": false, "score": 1, "creation_date": 1516174303, "post_id": 48291073, "comment_id": 83576017, "body": "You should accept one of the answers (the one that helped more, or yours if none of the others is acceptable for you) to clearly state that you need no longer help with this question."}, {"owner": {"reputation": 1471, "user_id": 8276973, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/96a6954bd630cf29b8529b41d9ce66fc?s=128&d=identicon&r=PG&f=1", "display_name": "RTC222", "link": "https://stackoverflow.com/users/8276973/rtc222"}, "edited": false, "score": 0, "creation_date": 1516293549, "post_id": 48291073, "comment_id": 83637797, "body": "All three had good ideas.  My own answer solved the problem, but Chux gave additional useful details, so I chose his as best.  Thanks to everyone who answered."}], "tags": [], "owner": {"reputation": 1471, "user_id": 8276973, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/96a6954bd630cf29b8529b41d9ce66fc?s=128&d=identicon&r=PG&f=1", "display_name": "RTC222", "link": "https://stackoverflow.com/users/8276973/rtc222"}, "is_accepted": false, "score": 0, "last_activity_date": 1516143111, "last_edit_date": 1516143111, "creation_date": 1516142877, "answer_id": 48291073, "question_id": 48290878, "link": "https://stackoverflow.com/questions/48290878/c-function-fread-does-not-read-entire-file/48291073#48291073", "title": "C function fread() does not read entire file", "body": "<p>I answered this in the final comment above, but to make this post appear as an answered question, I am posting this here too.  Changing the fread line to <code>size_t newLen = fread(buffer1, sizeof(int), nums_to_read, fp);</code> corrected the problem and now it reads the entire file. </p>\n\n<p>Thanks very much to <a href=\"https://stackoverflow.com/questions/48290878/c-function-fread-does-not-read-entire-file#comment83566937_48290878\">@Retired Ninja</a> and the others who replied to this question.</p>\n"}, {"comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1516146677, "post_id": 48291540, "comment_id": 83568319, "body": "Only tweak would be <code>if (fseek(fp, 0, SEEK_END) == -1) { &#47;* handle error *&#47;}</code>. Other than that, I still don&#39;t see how <code>if (abc &lt; 0)</code> could ever be true with values of <code>5 - 1000</code>?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1516149559, "post_id": 48291540, "comment_id": 83569080, "body": "@DavidC.Rankin True about <code>fseek()</code>, yet its failure rate is like <code>fclose()</code>.  Re: <code>if (abc &lt; 0)</code> likely just placeholder code for a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": true, "score": 1, "last_activity_date": 1516146247, "last_edit_date": 1516146247, "creation_date": 1516145915, "answer_id": 48291540, "question_id": 48290878, "link": "https://stackoverflow.com/questions/48290878/c-function-fread-does-not-read-entire-file/48291540#48291540", "title": "C function fread() does not read entire file", "body": "<p>Code has various problems and weaknesses, the biggest was a <a href=\"http://www.dictionary.com/browse/scant\" rel=\"nofollow noreferrer\">scant</a>  read. <a href=\"https://stackoverflow.com/questions/48290878/c-function-fread-does-not-read-entire-file/48291540#comment83566925_48290878\">@Marcus M\u00fcller</a> <a href=\"https://stackoverflow.com/questions/48290878/c-function-fread-does-not-read-entire-file/48291540#comment83566937_48290878\">@Retired Ninja</a><br>\n1 was too small an element size</p>\n\n<pre><code>// fread(buffer1, 1, nums_to_read, fp);\n// read nums_to_read elements\n// Each elements has the size of `sizeof buffer[0]`\nfread(buffer1, sizeof buffer[0], nums_to_read, fp);\n</code></pre>\n\n<p>Other improvements in code.  <code>Handle_Error()</code> is some error handling code to be written.</p>\n\n<pre><code>char FileA [] = \"C:/C_Projects/Data_A\";\n// FILE *pRead;  // not used here\nFILE *fp = fopen(FileA, \"rb\");\nif (fp == NULL) Handle_Error();\n// FILE *ptr_test;  // not used here\n\nfseek(fp, 0, SEEK_END);\nlong bufsize = ftell(fp);\nif (bufsize == -1) Handle_Error();\n\nint *buffer1 = malloc(bufsize + sizeof *buffer1);\nif (buffer1 == NULL) Handle_Error();\n\n// fseek(fp, 0, SEEK_SET);\nrewind(fp);  // rewind is sufficient and more clear\n\n// int nums_to_read = bufsize / 4;\nsize_t nums_to_read = (size_t) bufsize / sizeof *buffer1;\n\nsize_t newLen = fread(buffer1, sizeof buffer[0], nums_to_read, fp);\nif (newLen != nums_to_read) Handle_Error();\n\n// buffer1[++newLen] = '\\0';\nbuffer1[newLen] = 0;\nfclose(fp);\n\nint bcd = 1; // likely should have a default value\n// Iterate\n// for (int i = 0; i &lt; (size_t) bufsize / 4; i++) {\nfor (size_t i = 0; i &lt; newLen; i++) {\n    int abc = buffer1[i];\n\n    if (abc &lt; 0) {\n        bcd = 0;\n    }\n    if (i &gt;= 200) {\n        bcd = 0;\n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1471, "user_id": 8276973, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/96a6954bd630cf29b8529b41d9ce66fc?s=128&d=identicon&r=PG&f=1", "display_name": "RTC222", "link": "https://stackoverflow.com/users/8276973/rtc222"}, "edited": false, "score": 0, "creation_date": 1516147949, "post_id": 48291656, "comment_id": 83568653, "body": "that&#39;s right -- in my answer posted above we changed that line to size_t newLen = fread(buffer1, sizeof(int), nums_to_read, fp);"}], "tags": [], "owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "is_accepted": false, "score": 0, "last_activity_date": 1516146724, "creation_date": 1516146724, "answer_id": 48291656, "question_id": 48290878, "link": "https://stackoverflow.com/questions/48290878/c-function-fread-does-not-read-entire-file/48291656#48291656", "title": "C function fread() does not read entire file", "body": "<p>the error is here</p>\n\n<pre><code>int nums_to_read = bufsize / 4;\nsize_t newLen = fread(buffer1, 1, nums_to_read, fp);\n</code></pre>\n\n<p>the second param to fread is the size of the elements to read. the third is how many to read. It seems you intent is to read 4 bytes numbers (since you divieded the length by 4). So you should say</p>\n\n<pre><code>int nums_to_read = bufsize / 4;\nsize_t newLen = fread(buffer1, 4, nums_to_read, fp);\n</code></pre>\n\n<p>This skip over the whole issue of - are your ints 4 bytes. And is the file really raw 4 bytes ints.</p>\n"}], "owner": {"reputation": 1471, "user_id": 8276973, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/96a6954bd630cf29b8529b41d9ce66fc?s=128&d=identicon&r=PG&f=1", "display_name": "RTC222", "link": "https://stackoverflow.com/users/8276973/rtc222"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1250, "favorite_count": 0, "accepted_answer_id": 48291540, "answer_count": 3, "score": 1, "last_activity_date": 1516146724, "creation_date": 1516141892, "last_edit_date": 1516142156, "question_id": 48290878, "link": "https://stackoverflow.com/questions/48290878/c-function-fread-does-not-read-entire-file", "title": "C function fread() does not read entire file", "body": "<p>In C, I am reading the entire contents of the file Data_A into a buffer created with malloc().  The file contains 1000 random integers in the range 5 to 1000.  </p>\n\n<p>When I read the file, the newLen variable (see below) shows that the read size is 1001.  When I iterate over it as shown below, I get valid numbers (each number correctly corresponds to what's in the file), until it reaches 250 where it returns a negative number.  Obviously it read only 251 integers from a file of 1000 integers, but I don't know why.  Here's the code:</p>\n\n<pre><code>char FileA [] = \"C:/C_Projects/Data_A\";\nint *buffer1 = NULL;\nFILE *pRead;\nFILE *fp = fopen(FileA, \"rb\");\nFILE *ptr_test;\n\nfseek(fp, 0L, SEEK_END);\nlong bufsize = ftell(fp);\nbuffer1 = malloc(bufsize + 1);\nfseek(fp, 0, SEEK_SET);\nint nums_to_read = bufsize / 4;\nsize_t newLen = fread(buffer1, 1, nums_to_read, fp);\nbuffer1[++newLen] = '\\0';\n\nfclose(fp);\n\n// Iterate\nint i;\nint abc;\nint bcd;\n\nfor (i = 0; i &lt; bufsize / 4; i++)\n{\n    abc = buffer1[i];\n\n    if (abc &lt; 0)\n    {\n        bcd = 0;\n    }\n    if (i &gt;= 200)\n    {\n        bcd = 0;\n    }\n}\n</code></pre>\n\n<p>As I said, all numbers in the file are positive numbers between 5 and 1000; there are no zeroes or negative numbers.  So I don't understand why it's not reading all 1000 integers.  The variable bufsize confirms that the buffer is 4000 bytes.  </p>\n\n<p>Any ideas will be most appreciated.  </p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 32078, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 1, "creation_date": 1516141873, "post_id": 48290855, "comment_id": 83566821, "body": "<code>char command[strlen(argv[1])+4];</code> is not legal in C++ as it does not support dynamic-size arrays on stack. garbage is printed because you forgot about terminating null character."}, {"owner": {"reputation": 14702, "user_id": 1918561, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/uRU2O.jpg?s=128&g=1", "display_name": "Gereon", "link": "https://stackoverflow.com/users/1918561/gereon"}, "edited": false, "score": 0, "creation_date": 1516141970, "post_id": 48290855, "comment_id": 83566866, "body": "Strings must be 0-terminated, and you&#39;re not making sure that&#39;s the case."}, {"owner": {"reputation": 21, "user_id": 7881748, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/e643f41a907b79910276af63e0710161?s=128&d=identicon&r=PG&f=1", "display_name": "felipX", "link": "https://stackoverflow.com/users/7881748/felipx"}, "edited": false, "score": 0, "creation_date": 1516142006, "post_id": 48290855, "comment_id": 83566879, "body": "It&#39;s in C, I tagged C++ because I guess that people who know C++, maybe know how to solve this."}, {"owner": {"reputation": 21, "user_id": 7881748, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/e643f41a907b79910276af63e0710161?s=128&d=identicon&r=PG&f=1", "display_name": "felipX", "link": "https://stackoverflow.com/users/7881748/felipx"}, "edited": false, "score": 0, "creation_date": 1516142080, "post_id": 48290855, "comment_id": 83566908, "body": "I got it, how can I do this?"}, {"owner": {"reputation": 32078, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 1, "creation_date": 1516142082, "post_id": 48290855, "comment_id": 83566910, "body": "It is not legal in C either, unless you use something like C11 or whatever standard added support for VLA that later become optional."}, {"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 2, "creation_date": 1516142234, "post_id": 48290855, "comment_id": 83566967, "body": "Maybe people who know jQuery also happen to know what the problem is. But you should not tag <code>jquery</code> for pretty much the same reason as I am deleting <code>c++</code>."}, {"owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "reply_to_user": {"reputation": 32078, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 0, "creation_date": 1516143305, "post_id": 48290855, "comment_id": 83567337, "body": "@VTT: VLAs were added in C99, which is old enough at this point that I wouldn&#39;t feel bad calling VLAs part of C. C11 is when they backpedaled and made them optional (though most compilers support them)."}, {"owner": {"reputation": 32078, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "reply_to_user": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "edited": false, "score": 0, "creation_date": 1516144037, "post_id": 48290855, "comment_id": 83567569, "body": "@ShadowRanger Still, it is a good idea to never utilize new language features added after C89. Actually they shouldn&#39;t have touched core language features at all since then. Updating library a bit would be fine, but VLA is no good."}, {"owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "reply_to_user": {"reputation": 32078, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 0, "creation_date": 1516144905, "post_id": 48290855, "comment_id": 83567835, "body": "@VTT: In general, or under the plain <code>c</code> tag? In general, I understand avoiding VLAs (though in this particular case it&#39;s fairly innocuous; command line length limits on basically every OS would prevent the array from occupying more than a few dozen KB even if the user intentionally tried to break things), but avoiding <i>anything</i> from C99 or later is tying one hand behind your back for no reason. Especially since avoiding C11 means tons of modern programming tools (threading, atomics) can&#39;t be used in a portable manner without third party libraries."}], "answers": [{"comments": [{"owner": {"reputation": 32078, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "reply_to_user": {"reputation": 21, "user_id": 7881748, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/e643f41a907b79910276af63e0710161?s=128&d=identicon&r=PG&f=1", "display_name": "felipX", "link": "https://stackoverflow.com/users/7881748/felipx"}, "edited": false, "score": 1, "creation_date": 1516142794, "post_id": 48290916, "comment_id": 83567158, "body": "@felipX This is actually wrong because the result of <code>snprintf</code> must be inspected to determine whether supplied buffer was sufficient."}, {"owner": {"reputation": 5358, "user_id": 3171657, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/J3bKr.png?s=128&g=1", "display_name": "Turn", "link": "https://stackoverflow.com/users/3171657/turn"}, "reply_to_user": {"reputation": 32078, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 0, "creation_date": 1516143349, "post_id": 48290916, "comment_id": 83567350, "body": "@VTT Do you mean if the cmd buffer is of sufficient size to hold <code>argv[1]</code>?"}, {"owner": {"reputation": 32078, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 0, "creation_date": 1516143497, "post_id": 48290916, "comment_id": 83567402, "body": "Yes. Allocating string buffers on stack is only acceptable if stored string length is limited by some convention and recursion is limited by some convention as well."}, {"owner": {"reputation": 5358, "user_id": 3171657, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/J3bKr.png?s=128&g=1", "display_name": "Turn", "link": "https://stackoverflow.com/users/3171657/turn"}, "edited": false, "score": 0, "creation_date": 1516143568, "post_id": 48290916, "comment_id": 83567426, "body": "Yeah, you&#39;re right, I was taking a short cut. I&#39;ll update."}], "tags": [], "owner": {"reputation": 5358, "user_id": 3171657, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/J3bKr.png?s=128&g=1", "display_name": "Turn", "link": "https://stackoverflow.com/users/3171657/turn"}, "is_accepted": false, "score": 3, "last_activity_date": 1516144202, "last_edit_date": 1516144202, "creation_date": 1516142023, "answer_id": 48290916, "question_id": 48290855, "link": "https://stackoverflow.com/questions/48290855/argv-contain-a-lot-of-characters-than-expected/48290916#48290916", "title": "**argv contain a lot of characters than expected", "body": "<p>The reason you're running into problems is that you aren't terminating your <code>command</code> string with <code>NULL</code>.  But you really want to use <code>sprintf</code> (or even better to use <code>snprintf</code>) for something like this. It works similarly to <code>printf</code> but outputs to memory instead of <code>stdout</code> and handles the terminating <code>NULL</code> for you. E.g:</p>\n\n<pre><code>char cmd[80];\n\nsnprintf(cmd, 80, \"vim %s\", argv[1])\nsystem(cmd);\n</code></pre>\n\n<p>As @VTT points out, this simplified code assumes that the value in <code>argv[1]</code> will be less than 75 characters (80 minus 4 for \"vim \" minus 1 for the NULL character). One safer option would be to verify this assumption first and throw an error if it isn't the case. To be more flexible you could dynamically allocate the <code>cmd</code> buffer:</p>\n\n<pre><code>char *cmd = \"vim \";\nchar *buf = malloc(strlen(argv[1]) + strlen(cmd) + 1);\n\nsprintf(buf, \"%s%s\", cmd, argv[1]);\nsystem(buf);\nfree(buf);\n</code></pre>\n\n<p>Of course you should also check to be sure argc > 1.</p>\n"}, {"comments": [{"owner": {"reputation": 21, "user_id": 7881748, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/e643f41a907b79910276af63e0710161?s=128&d=identicon&r=PG&f=1", "display_name": "felipX", "link": "https://stackoverflow.com/users/7881748/felipx"}, "edited": false, "score": 0, "creation_date": 1516142268, "post_id": 48290932, "comment_id": 83566979, "body": "Humm, it was really what I needed to know, thank you!"}], "tags": [], "owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "is_accepted": false, "score": 4, "last_activity_date": 1516142078, "creation_date": 1516142078, "answer_id": 48290932, "question_id": 48290855, "link": "https://stackoverflow.com/questions/48290855/argv-contain-a-lot-of-characters-than-expected/48290932#48290932", "title": "**argv contain a lot of characters than expected", "body": "<p>You need to <code>NUL</code> terminate your C-style strings, and that includes allocating enough memory to hold the <code>NUL</code>.</p>\n\n<p>Your array is a byte short (must be <code>char command[strlen(argv[1])+4+1];</code> to leave space for <code>NUL</code>), and you should probably just use something like <code>sprintf</code> to fill it in, e.g.:</p>\n\n<pre><code> sprintf(command, \"vim %s\", argv[1]);`\n</code></pre>\n\n<p>That's simpler than manual loops, and it also fills in the <code>NUL</code> for you.</p>\n\n<p>The garbage you see is caused by the search for the <code>NUL</code> byte (which terminates the string) wandering off into unrelated (and undefined for that matter) memory that happens to occur after the buffer.</p>\n"}, {"comments": [{"owner": {"reputation": 21, "user_id": 7881748, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/e643f41a907b79910276af63e0710161?s=128&d=identicon&r=PG&f=1", "display_name": "felipX", "link": "https://stackoverflow.com/users/7881748/felipx"}, "edited": false, "score": 0, "creation_date": 1516145640, "post_id": 48291257, "comment_id": 83568042, "body": "Oh dude, thanks for this deep explanation, you really made things more clearer. Thank&#39;s for your time !"}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "reply_to_user": {"reputation": 21, "user_id": 7881748, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/e643f41a907b79910276af63e0710161?s=128&d=identicon&r=PG&f=1", "display_name": "felipX", "link": "https://stackoverflow.com/users/7881748/felipx"}, "edited": false, "score": 0, "creation_date": 1516145883, "post_id": 48291257, "comment_id": 83568104, "body": "@felipX that&#39;s ok, but the comment system in Stack Overflow should be used to add comments that enhance the question/answer. If you really want to thank somebody, then do it by upvoting/accepting the questions/answers. Note that I&#39;m not telling you to upvote mine, it&#39;s just a general recommendation for the future, it&#39;s the way we say thank you to the people that help us."}], "tags": [], "owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "is_accepted": false, "score": 0, "last_activity_date": 1516144030, "creation_date": 1516144030, "answer_id": 48291257, "question_id": 48290855, "link": "https://stackoverflow.com/questions/48290855/argv-contain-a-lot-of-characters-than-expected/48291257#48291257", "title": "**argv contain a lot of characters than expected", "body": "<p>I know that there are already good answers here, but I'd like to expand them a little bit.</p>\n\n<p>I often see this kind of code</p>\n\n<pre><code>system(\"vim %s\",argv[1]); //Error:\n</code></pre>\n\n<p>and beginners often wonder, why that is not working.</p>\n\n<p>The reason for that is that <code>\"%s\", some_string</code> is <strong>not</strong> a feature of the C\nlanguage, the sequence of characters <code>%s</code> has no special meaning, in fact it is\nas meaningful as the sequence <code>mickey mouse</code>.</p>\n\n<p>The reason why that works with <code>printf</code> (and the other members of the\n<code>printf</code>-family) is because <code>printf</code> <strong>was designed</strong> to replace sequences like\n<code>%s</code> with a value passed as an argument. It's <code>printf</code> which make <code>%s</code> special,\nnot the C language.</p>\n\n<p>As you may have noticed, doing <code>\"hallo\" + \" world\"</code> doesn't do string\nconcatenation. C doesn't have a native string type that behaves like C++'s\n<code>std::string</code> or Python's <code>String</code>. In C a string is just a sequence of\ncharacters that happen to have a byte with value of 0 at the end (also called\nthe <code>'\\0'</code>-terminating byte).</p>\n\n<p>That's why you pass to <code>printf</code> a format as the first argument. It tells\n<code>printf</code> that it should print character by character unless it finds a <code>%</code>,\nwhich tells <code>printf</code> that the next character(s)<sup>1</sup> is/are special and\nmust substitute them with the value passed as subsequent arguments to <code>printf</code>.</p>\n\n<p>The <code>%x</code> are called conversion specifiers and the <a href=\"https://linux.die.net/man/3/printf\" rel=\"nofollow noreferrer\">documentation of <code>printf</code></a>\nwill list all of them and how to use them.</p>\n\n<p>Other functions like the <code>scanf</code> family use a similar strategy, but that doesn't\nmean that all functions in C that expect strings, will work the same way. In\nfact the vast majority of C functions that expect strings, do not work in that\nway.</p>\n\n<blockquote>\n  <p><em>man system</em></p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n\nint system(const char *command);\n</code></pre>\n</blockquote>\n\n<p>Here you see that <code>system</code> is a function that expects <strong>one</strong> argument only.\nThat's why your compiler complains with a line like this: <code>system(\"vim %s\",argv[1]);</code>.\nThat's where functions like <code>sprintf</code> or <code>snprintf</code> come in handy.</p>\n\n<hr>\n\n<p><sup>1</sup>If you take a look at the <code>printf</code> documentation you will see that\nthe conversion specifier together with length modifiers can be longer than 1\ncharacter.</p>\n"}], "owner": {"reputation": 21, "user_id": 7881748, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/e643f41a907b79910276af63e0710161?s=128&d=identicon&r=PG&f=1", "display_name": "felipX", "link": "https://stackoverflow.com/users/7881748/felipx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 301, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1516144202, "creation_date": 1516141779, "last_edit_date": 1516142239, "question_id": 48290855, "link": "https://stackoverflow.com/questions/48290855/argv-contain-a-lot-of-characters-than-expected", "title": "**argv contain a lot of characters than expected", "body": "<p>First, I need to execute two commands with system(), for example, I receive an string and open this string with an text editor, like this:</p>\n\n<pre><code>$ ./myprogram string1\n</code></pre>\n\n<p>And the output should be a command like this:</p>\n\n<pre><code>$ vim string1\n</code></pre>\n\n<p>But, I cannot find a way to do this like this pseudo code:</p>\n\n<pre><code>system(\"vim %s\",argv[1]); //Error:\n\ntest.c:23:3: error: too many arguments to function 'system'\n   system(\"vim %s\",argv[1]);\n</code></pre>\n\n<p>Therefore, my solution is store the argv[1] on a char array that already initialized with four characters, like this:</p>\n\n<pre><code>char command[strlen(argv[1])+4];\ncommand[0] = 'v'; command [1] = 'i'; command[2] = 'm'; command[3] = ' ';\n</code></pre>\n\n<p>And assign the argv[1] to my new char array:</p>\n\n<pre><code>for(int i = 0; i &lt; strlen(argv[1]) ; i++)\n    command[i+4] = argv[1][i];\n</code></pre>\n\n<p>And finally:</p>\n\n<pre><code>system(command);\n</code></pre>\n\n<p>But, if the arguments given to my program has less than 3 characters, its works fine, but if not, some weird characters that I do not expect appear in the output, like this:</p>\n\n<pre><code>./myprogramg 1234\n</code></pre>\n\n<p>And the output is:</p>\n\n<pre><code>$ vim 12348\ufffdM\ufffd\n</code></pre>\n\n<p>How can I solve this bug and why does this happen? </p>\n\n<p>The full code is:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n int main (int argc,char **argv) {\n\n    char command[strlen(argv[1])+4];\n    command[0] = 'v'; command [1] = 'i'; command[2] = 'm'; command[3] = ' ';\n\n    for(int i = 0; i &lt; strlen(argv[1]) ; i++)\n        command[i+4] = argv[1][i];\n\n        system(command);\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "pointers"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1516141606, "post_id": 48290730, "comment_id": 83566706, "body": "<code>*array2D</code> is equivalent to <code>array2D[0]</code> and of type <code>int[2]</code>. It&#39;s all about types."}, {"owner": {"reputation": 642, "user_id": 3117817, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/100005414859585/picture?type=large", "display_name": "deadcode", "link": "https://stackoverflow.com/users/3117817/deadcode"}, "edited": false, "score": 0, "creation_date": 1516141689, "post_id": 48290730, "comment_id": 83566735, "body": "What do you mean by &#39;why i need here &amp; and above in the function not&#39; ?"}, {"owner": {"reputation": 23, "user_id": 8765385, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/5a11479e7f034ac9d0d5ca76e1b63d52?s=128&d=identicon&r=PG&f=1", "display_name": "Newuser1234567", "link": "https://stackoverflow.com/users/8765385/newuser1234567"}, "reply_to_user": {"reputation": 642, "user_id": 3117817, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/100005414859585/picture?type=large", "display_name": "deadcode", "link": "https://stackoverflow.com/users/3117817/deadcode"}, "edited": false, "score": 0, "creation_date": 1516142063, "post_id": 48290730, "comment_id": 83566901, "body": "@deadcode above we didnt use any of adress operator &amp; for running through the element (look function(int*array) why i do need this in this example?"}, {"owner": {"reputation": 642, "user_id": 3117817, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/100005414859585/picture?type=large", "display_name": "deadcode", "link": "https://stackoverflow.com/users/3117817/deadcode"}, "edited": false, "score": 0, "creation_date": 1516142244, "post_id": 48290730, "comment_id": 83566971, "body": "Ok I get your question now and Pablo explains it well."}], "answers": [{"tags": [], "owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "is_accepted": false, "score": 4, "last_activity_date": 1516144082, "last_edit_date": 1516144082, "creation_date": 1516142250, "answer_id": 48290963, "question_id": 48290730, "link": "https://stackoverflow.com/questions/48290730/the-difference-between-pointer-in-2d-and-1d-array/48290963#48290963", "title": "The difference between pointer in 2D and 1D array", "body": "<p>The first line</p>\n\n<pre><code>function(*array2D);\n</code></pre>\n\n<p>is equivalent to</p>\n\n<pre><code>function(array2D[0]);\n</code></pre>\n\n<p>So you are passing the first array <code>[1,2]</code>. In C an array decays into a pointer\nwhen it is passed to a function.</p>\n\n<p>However, your <code>function</code> function<sup>1</sup> should also get the number of\nelements of the array.</p>\n\n<pre><code>void function(int *arr, size_t len)\n{\n    size_t i;\n    for(i = 0; i &lt; len; ++i)\n        printf(\"%d\\n\", arr[i]);\n}\n</code></pre>\n\n<p>Then you can call it<sup>2</sup></p>\n\n<pre><code>int array2D[2][2] = { { 1,2} ,{3,4}};\nint array1D[3] = {1,2,3};\n\nfunction(*array2D, sizeof *array2D / sizeof **array2D);\nfunction(array1D, sizeof array1D / sizeof *array1D);\n</code></pre>\n\n<hr>\n\n<blockquote>\n<pre><code>  disp (&amp;arr[i]); // why i need here &amp; and above in the function not\n</code></pre>\n</blockquote>\n\n<p>Because <code>arr[i]</code> would give you the value stored at the position <code>i</code>, <code>disp</code>\nexpects a pointer, so you use the <code>&amp;</code>-operator which returns the address of the\narray at the position <code>i</code>, which is also equivalent to <code>arr + i</code>.</p>\n\n<hr>\n\n<p><sup>1</sup>Don't call your functions <code>function</code>. Technically that is valid name, but it\nwould be better if you give your function more explicit names so that just by\nreading the name, you know what the functions does.</p>\n\n<p><sup>2</sup>Note that <code>sizeof array / sizeof *array</code> only works with arrays. If you have a\nfunction and you expect an array, you will get only a pointer to the array.\nIn this case you also would need to pass the length of the array.</p>\n"}, {"tags": [], "owner": {"reputation": 166, "user_id": 9166558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/478cc3ab8ce513fa5e43f931f104cd7a?s=128&d=identicon&r=PG&f=1", "display_name": "T W Bennet", "link": "https://stackoverflow.com/users/9166558/t-w-bennet"}, "is_accepted": false, "score": 0, "last_activity_date": 1516168415, "creation_date": 1516168415, "answer_id": 48294405, "question_id": 48290730, "link": "https://stackoverflow.com/questions/48290730/the-difference-between-pointer-in-2d-and-1d-array/48294405#48294405", "title": "The difference between pointer in 2D and 1D array", "body": "<p>We're used to the fact that <code>int mike[10]</code> decays to <code>int *</code>, which points to the first thing in the array.  So it seems like <code>int sam[5][10]</code> might also decay to <code>int * </code> pointing to the first element of the array.  But <code>int sam[5][10]</code> is not a \"two-dimensional array of int\" that decays to an int pointer, it's an array of five arrays of ten integers.  The first thing in <code>sam</code> is the first of the five arrays, so <code>sam</code> decays to a pointer to an array of ten integers, which type is written <code>int (*)[10]</code>, though it rarely <i>is</i> written.</p>\n\n<p>So your array2D decays to a different type than integer pointer, which is why your call <code>function(array2D);</code> creates a type mismatch.  But your call <code>function(*array2D);</code> does work because (as noted above) <code>*array2D</code> is the same as <code>array2D[0]</code>, which is an array of integers, and does decay to <code>int *</code>. </p>\n\n<p>For your second case, <code>arr</code> is an array, but <code>arr[i]</code> is an <code>int</code>, since it is just one position in the array.  The ampersand operator makes a pointer of what it operates, so <code>&amp;arr[i]</code> is a pointer, and the call works.</p>\n"}], "owner": {"reputation": 23, "user_id": 8765385, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/5a11479e7f034ac9d0d5ca76e1b63d52?s=128&d=identicon&r=PG&f=1", "display_name": "Newuser1234567", "link": "https://stackoverflow.com/users/8765385/newuser1234567"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 224, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1516168415, "creation_date": 1516141113, "last_edit_date": 1516142064, "question_id": 48290730, "link": "https://stackoverflow.com/questions/48290730/the-difference-between-pointer-in-2d-and-1d-array", "title": "The difference between pointer in 2D and 1D array", "body": "<p>I practiced today some C code, especially array with return function and pointers.\nAnd I found some code which were really confusing and want to know why it is.</p>\n\n<p>So I have first a function which print all elements out of the array.</p>\n\n<pre><code>void function(int *arr)\n{\n    ...\n    printf(\"%d, arr[i]);\n}\n</code></pre>\n\n<p>Now in main I have a 2D array and a 1D array.</p>\n\n<pre><code>int array2D[2][2] = {{1,2}, {3,4}};\nint array1D[3] = {1,2,3};\n\nfunction(*array2D); // Why do I need here the derefernce pointer\nfunction(array1D);  // why I don't need here the deference pointer\n</code></pre>\n\n<p>And in another case:</p>\n\n<pre><code>void disp( int *num)\n{\n    printf(\"%d \", *num);\n}\n\nint main()\n{\n    int arr[] = {1, 2, 3, 4, 5, 6, 7, 8, 9, 0};\n    for (int i=0; i&lt;10; i++)\n    {\n        /* Passing addresses of array elements*/\n        disp(&amp;arr[i]); // why i need here &amp; and above in the function not\n    }\n}\n</code></pre>\n\n<p>This is really confusing me right now.  Can someone explain me this?</p>\n"}, {"tags": ["mysql", "c", "mariadb"], "comments": [{"owner": {"reputation": 11736, "user_id": 1987838, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2tIuS.jpg?s=128&g=1", "display_name": "Hackerman", "link": "https://stackoverflow.com/users/1987838/hackerman"}, "edited": false, "score": 0, "creation_date": 1516971811, "post_id": 48290358, "comment_id": 83916609, "body": "One question, did the <code>&#47;tmp&#47;mysql.sock</code> exists...if not, then try to create a new one with <code>touch &#47;tmp&#47;mysql.sock</code> and then try to run again your app."}, {"owner": {"reputation": 4143, "user_id": 400048, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/c8282b525f39ea9cb9e1c2d78474339a?s=128&d=identicon&r=PG", "display_name": "zcourts", "link": "https://stackoverflow.com/users/400048/zcourts"}, "reply_to_user": {"reputation": 11736, "user_id": 1987838, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2tIuS.jpg?s=128&g=1", "display_name": "Hackerman", "link": "https://stackoverflow.com/users/1987838/hackerman"}, "edited": false, "score": 0, "creation_date": 1516994649, "post_id": 48290358, "comment_id": 83929970, "body": "Creating the file does change the error msg from: <code>Can&#39;t connect to local MySQL server through socket &#39;&#47;tmp&#47;mysql.sock&#39; (2)</code> to <code>Can&#39;t connect to local MySQL server through socket &#39;&#47;tmp&#47;mysql.sock&#39; (38)</code>. Not much else I&#39;m afraid."}, {"owner": {"reputation": 2449, "user_id": 500276, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/200bf76976f24add540182f5c3a42788?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Benningfield", "link": "https://stackoverflow.com/users/500276/mark-benningfield"}, "edited": false, "score": 0, "creation_date": 1517011626, "post_id": 48290358, "comment_id": 83936463, "body": "@zcourts: Are you linking with libmysqlclient.a or with libmysqld.a ?"}, {"owner": {"reputation": 4143, "user_id": 400048, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/c8282b525f39ea9cb9e1c2d78474339a?s=128&d=identicon&r=PG", "display_name": "zcourts", "link": "https://stackoverflow.com/users/400048/zcourts"}, "edited": false, "score": 0, "creation_date": 1517013126, "post_id": 48290358, "comment_id": 83936801, "body": "<code>libmariadb.dylib</code>, which is not the client if the file name is anything to go by."}, {"owner": {"reputation": 2449, "user_id": 500276, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/200bf76976f24add540182f5c3a42788?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Benningfield", "link": "https://stackoverflow.com/users/500276/mark-benningfield"}, "edited": false, "score": 0, "creation_date": 1517071395, "post_id": 48290358, "comment_id": 83949171, "body": "@zcourts: Do you have <code>libmysqld.a</code> on your system?"}, {"owner": {"reputation": 4143, "user_id": 400048, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/c8282b525f39ea9cb9e1c2d78474339a?s=128&d=identicon&r=PG", "display_name": "zcourts", "link": "https://stackoverflow.com/users/400048/zcourts"}, "edited": false, "score": 0, "creation_date": 1517098232, "post_id": 48290358, "comment_id": 83956750, "body": "Yes there is. <code>\u279c  ~ find &#47;usr&#47;local&#47;lib -name &quot;libmysqld.*&quot;</code> results in <code>&#47;usr&#47;local&#47;lib&#47;libmysqld.a</code> as one of the results"}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1517152938, "post_id": 48290358, "comment_id": 83968642, "body": "<code>Can&#39;t connect to local MySQL server through socket &#39;&#47;tmp&#47;mysql.sock&#39; (2)</code> tells you that the UNIX domain socket <code>&#47;tmp&#47;mysql.sock</code> is not around. <code>Can&#39;t connect to local MySQL server through socket &#39;&#47;tmp&#47;mysql.sock&#39; (38)</code> tells you that <code>&#47;tmp&#47;mysql.sock</code> is not a (UNIX domain) socket, which makes sense if you created it via <code>touch</code>, because <code>touch</code> creates a file, not a (UNIX domain) socket."}, {"owner": {"reputation": 2449, "user_id": 500276, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/200bf76976f24add540182f5c3a42788?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Benningfield", "link": "https://stackoverflow.com/users/500276/mark-benningfield"}, "edited": false, "score": 0, "creation_date": 1517171560, "post_id": 48290358, "comment_id": 83975016, "body": "@zcourts: Did you try linking to <code>libmysqld.a</code> (as in <code>-lmysqld</code>)?"}, {"owner": {"reputation": 4143, "user_id": 400048, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/c8282b525f39ea9cb9e1c2d78474339a?s=128&d=identicon&r=PG", "display_name": "zcourts", "link": "https://stackoverflow.com/users/400048/zcourts"}, "reply_to_user": {"reputation": 2449, "user_id": 500276, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/200bf76976f24add540182f5c3a42788?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Benningfield", "link": "https://stackoverflow.com/users/500276/mark-benningfield"}, "edited": false, "score": 0, "creation_date": 1517416083, "post_id": 48290358, "comment_id": 84089513, "body": "@MarkBenningfield - I&#39;ve updated the post after linking to <code>libmysqld.a</code> instead of <code>libmariadb</code>"}, {"owner": {"reputation": 2449, "user_id": 500276, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/200bf76976f24add540182f5c3a42788?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Benningfield", "link": "https://stackoverflow.com/users/500276/mark-benningfield"}, "edited": false, "score": 0, "creation_date": 1517417743, "post_id": 48290358, "comment_id": 84090690, "body": "@zcourts: The image you posted looks like the abort is a result of an OS error when creating a file. Did you try building and running the simple test code that is posted in your OP?"}, {"owner": {"reputation": 4143, "user_id": 400048, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/c8282b525f39ea9cb9e1c2d78474339a?s=128&d=identicon&r=PG", "display_name": "zcourts", "link": "https://stackoverflow.com/users/400048/zcourts"}, "reply_to_user": {"reputation": 2449, "user_id": 500276, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/200bf76976f24add540182f5c3a42788?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Benningfield", "link": "https://stackoverflow.com/users/500276/mark-benningfield"}, "edited": false, "score": 0, "creation_date": 1517419431, "post_id": 48290358, "comment_id": 84091844, "body": "@MarkBenningfield I&#39;m running the simple test from the OP mostly unmodified. The only change is the includes I have are #include &lt;mysql/mysql.h&gt; #include &lt;cstdlib&gt; #include &lt;cstdio&gt;"}, {"owner": {"reputation": 2449, "user_id": 500276, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/200bf76976f24add540182f5c3a42788?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Benningfield", "link": "https://stackoverflow.com/users/500276/mark-benningfield"}, "edited": false, "score": 2, "creation_date": 1517420439, "post_id": 48290358, "comment_id": 84092442, "body": "@zcourts: Well, we&#39;re about to run out of room on this comment thread (comments are not meant for extended discussion). Set a breakpoint in the debugger and make sure the connection is created. If it is, then you know that the server is live, and that the problem is in creating the file, which is really up to the OS, not the server."}, {"owner": {"reputation": 243, "user_id": 3358586, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4JHYj.jpg?s=128&g=1", "display_name": "Nord", "link": "https://stackoverflow.com/users/3358586/nord"}, "edited": false, "score": 0, "creation_date": 1517530906, "post_id": 48290358, "comment_id": 84144562, "body": "@zcourts: I read all your question sorry about the previous misunderstandings. I read the other example and your problem is while linking the library can you post CMakeLists.txt"}], "answers": [{"comments": [{"owner": {"reputation": 4143, "user_id": 400048, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/c8282b525f39ea9cb9e1c2d78474339a?s=128&d=identicon&r=PG", "display_name": "zcourts", "link": "https://stackoverflow.com/users/400048/zcourts"}, "edited": false, "score": 0, "creation_date": 1517586501, "post_id": 48574409, "comment_id": 84169358, "body": "Nord, thanks for the detailed answer. Can I ask which OS did you try this on? It builds as in my example but still exits with code 6. Following @Mark&#39;s last comment <code>mysql_library_init</code> is where the exit happens and the dir is /tmp so I don&#39;t think it&#39;s a file/permission issue. My next step will be to try building in a VM Centos/Ubuntu etc so if you let me know which OS you used, I&#39;ll try to use the same."}, {"owner": {"reputation": 243, "user_id": 3358586, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4JHYj.jpg?s=128&g=1", "display_name": "Nord", "link": "https://stackoverflow.com/users/3358586/nord"}, "reply_to_user": {"reputation": 4143, "user_id": 400048, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/c8282b525f39ea9cb9e1c2d78474339a?s=128&d=identicon&r=PG", "display_name": "zcourts", "link": "https://stackoverflow.com/users/400048/zcourts"}, "edited": false, "score": 0, "creation_date": 1517588960, "post_id": 48574409, "comment_id": 84170908, "body": "I did it in OS X Sierra, I don&#39;t remember the exact build but will update it as soon as I am on my mobile computer. I changed the directory to one I had privileges with my user for example /Users/&lt;usename&gt;/tmp/embbeded and it worked. it send a warning but ended with exitcode 0. The table is created at the directory I specified. I don&#39;t remember how I installed MariaDB. Maybe it has something to do with your installation of MariDB."}, {"owner": {"reputation": 4143, "user_id": 400048, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/c8282b525f39ea9cb9e1c2d78474339a?s=128&d=identicon&r=PG", "display_name": "zcourts", "link": "https://stackoverflow.com/users/400048/zcourts"}, "edited": false, "score": 0, "creation_date": 1517589230, "post_id": 48574409, "comment_id": 84171079, "body": "I&#39;m using Sierra as well. Did you link to the actual MySQL or MariaDB? Was it installed with homebrew or some other means?"}, {"owner": {"reputation": 243, "user_id": 3358586, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4JHYj.jpg?s=128&g=1", "display_name": "Nord", "link": "https://stackoverflow.com/users/3358586/nord"}, "reply_to_user": {"reputation": 4143, "user_id": 400048, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/c8282b525f39ea9cb9e1c2d78474339a?s=128&d=identicon&r=PG", "display_name": "zcourts", "link": "https://stackoverflow.com/users/400048/zcourts"}, "edited": false, "score": 1, "creation_date": 1517590064, "post_id": 48574409, "comment_id": 84171610, "body": "I remember now. I used MySQL since installing MariaDB in OS X was a hassle. I have &quot;myql Ver 14.14 Distrib 5.6.23, for osx10.8 (x84_64) using EditLine wrapper&quot; but it should be the same I checked the MariaDB documentation. OS X High Sierra 10.13.2."}, {"owner": {"reputation": 4143, "user_id": 400048, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/c8282b525f39ea9cb9e1c2d78474339a?s=128&d=identicon&r=PG", "display_name": "zcourts", "link": "https://stackoverflow.com/users/400048/zcourts"}, "edited": false, "score": 1, "creation_date": 1517603877, "post_id": 48574409, "comment_id": 84178265, "body": "ok. I got it working. I went through my <code>&#47;usr&#47;local</code> and manually deleted all libs it depends on, as well as clearing out all header files from <code>includes</code>. rebuilt your version and it failed with exit code 6 as before, then I created the data dir and chmod it (reflecting on @ MarkBenningfield&#39;s comments then your version worked. I went back, made sure the dir exists and tried my original and that also worked. Ultimately I think I had a messed up lib installed. The data dir definitely existed before after Mark&#39;s comments and I still got exit code 6. Works now though, thanks again!"}], "tags": [], "owner": {"reputation": 243, "user_id": 3358586, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4JHYj.jpg?s=128&g=1", "display_name": "Nord", "link": "https://stackoverflow.com/users/3358586/nord"}, "is_accepted": true, "score": 5, "last_activity_date": 1517537690, "last_edit_date": 1517537690, "creation_date": 1517534966, "answer_id": 48574409, "question_id": 48290358, "link": "https://stackoverflow.com/questions/48290358/embedded-mariadb-c-c-api/48574409#48574409", "title": "Embedded MariaDB C/C++ API", "body": "<p>Ok first a little explanation about your example. The user is using gcc to compile and I can see you are using cmake.\nFirst what does -lz and <code>mysql_config --include --libmysqld-libs</code> means. The first is link zlib to link zlib in cmake you can refer to <a href=\"https://stackoverflow.com/questions/6173915/need-help-trying-to-make-cmake-find-third-party-libraries\">this answer</a>, but long story short:</p>\n\n<pre><code>find_package( ZLIB REQUIRED )\nif ( ZLIB_FOUND )\n    include_directories( ${ZLIB_INCLUDE_DIRS} )\n    target_link_libraries( sql_fn ${ZLIB_LIBRARIES} )\nendif( ZLIB_FOUND )\n</code></pre>\n\n<p>Then you need the mariaDB library and that is the second part. <code>mysql_config --include --libmysqld-libs</code> this means execute the command mysql_config --include --libmysqld-libs which will return a string with the link options so execute the command:</p>\n\n<pre><code>$mysql_config --include --libmysqld-libs\n-I/usr/local/mysql/include\n-L/usr/local/mysql/lib  -lmysqld\n</code></pre>\n\n<p>And you should get an output like the one above. The -I is to look for headers in a given directory and the -L is to search a library in a directory, the -l is to link a given library it serves the same purpose as -lz only you are adding -lmysqld.</p>\n\n<p>Well now that all is explained you need only include the -I -L and -l options with mysql however this is not such a standard library so you need to include directories and libraries through a script as explained in <a href=\"https://stackoverflow.com/questions/35068444/add-and-link-mysql-libraries-in-a-cmakelist-txt\">this anwer</a>. So again long story short there is no bullet proof for this for example my library is in /usr/local/mysql/lib and yours is in /usr/local/lib. Since that is the case it will be easier to use the second method.</p>\n\n<pre><code>execute_process(COMMAND mysql_config --include\n    OUTPUT_VARIABLE MYSQL_INCLUDE)\nexecute_process(COMMAND mysql_config --libmysqld-libs\n    OUTPUT_VARIABLE MYSQL_LIBS)\n\ntarget_compile_options(sql_fn PUBLIC ${MYSQL_INCLUDE})\ntarget_link_libraries(sql_fn ${MYSQL_LIBS})\n</code></pre>\n\n<p>And that is all the required information you need. Now we are glad we have Cmake to make things easier for us don't we. ;)\nHere is my CMakeLists.txt</p>\n\n<pre><code>cmake_minimum_required(VERSION 3.6)\nproject(embedded_mysql)\n\nset(CMAKE_CXX_STANDARD 14)\n\nset(SOURCE_FILES main.cpp)\nadd_executable(embedded_mysql ${SOURCE_FILES})\n\nfind_package( ZLIB REQUIRED )\nif ( ZLIB_FOUND )\n    include_directories( ${ZLIB_INCLUDE_DIRS} )\n    target_link_libraries( embedded_mysql ${ZLIB_LIBRARIES} )\nendif( ZLIB_FOUND )\n\nexecute_process(COMMAND mysql_config --include\n        OUTPUT_VARIABLE MYSQL_INCLUDE)\nexecute_process(COMMAND mysql_config --libmysqld-libs\n        OUTPUT_VARIABLE MYSQL_LIBS)\n\nstring(STRIP ${MYSQL_LIBS} MYSQL_LIBS)\n\ntarget_compile_options(embedded_mysql PUBLIC ${MYSQL_INCLUDE})\ntarget_link_libraries(embedded_mysql ${MYSQL_LIBS})\n</code></pre>\n\n<p>You can see the code in github <a href=\"https://github.com/norbertot/embedded_mysql\" rel=\"nofollow noreferrer\">here</a></p>\n"}], "owner": {"reputation": 4143, "user_id": 400048, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/c8282b525f39ea9cb9e1c2d78474339a?s=128&d=identicon&r=PG", "display_name": "zcourts", "link": "https://stackoverflow.com/users/400048/zcourts"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2243, "favorite_count": 2, "accepted_answer_id": 48574409, "answer_count": 1, "score": 9, "last_activity_date": 1517537690, "creation_date": 1516139264, "last_edit_date": 1517416018, "question_id": 48290358, "link": "https://stackoverflow.com/questions/48290358/embedded-mariadb-c-c-api", "title": "Embedded MariaDB C/C++ API", "body": "<p>I'm trying to get an embedded MariaDB (i.e. not connecting to running server) setup going but I'm failing to get any of the examples I find to work.</p>\n\n<p>The most recent example I have is from this post <a href=\"https://stackoverflow.com/a/24548826/400048\">https://stackoverflow.com/a/24548826/400048</a></p>\n\n<p>When the app runs it produces:\n<code>Can't connect to local MySQL server through socket '/tmp/mysql.sock' (2)</code>\nThe docs <a href=\"https://mariadb.com/kb/en/library/embedded-mariadb-interface/\" rel=\"noreferrer\">https://mariadb.com/kb/en/library/embedded-mariadb-interface/</a> isn't much help on this.</p>\n\n<p>For convenience the code from that StackOverflow post is:</p>\n\n<pre><code>#include &lt;my_global.h&gt;\n#include &lt;mysql.h&gt;\n\nint main(int argc, char **argv) {  \n    static char *server_options[] = {\n                                   \"mysql_test\", // An unused string \n                                    \"--datadir=/tmp/mysql_embedded_data\", // Your data dir\n                                    NULL };\n    int num_elements = (sizeof(server_options) / sizeof(char *)) - 1;\n\n    static char *server_groups[] = { \"libmysqld_server\",\n                                     \"libmysqld_client\", NULL };\n\n\n    // Init MySQL lib and connection    \n    mysql_library_init(num_elements, server_options, server_groups);\n    MYSQL *con = mysql_init(NULL);\n\n    if (con == NULL) {\n        fprintf(stderr, \"%s\\n\", mysql_error(con));\n        exit(1);\n    }\n\n    mysql_options(con, MYSQL_READ_DEFAULT_GROUP, \"libmysqld_client\");\n    mysql_options(con, MYSQL_OPT_USE_EMBEDDED_CONNECTION, NULL);\n\n    // Connect to no host/port -&gt; Embedded mode\n    if (mysql_real_connect(con, NULL, NULL, NULL, NULL, 0, NULL, 0) == NULL) {\n        fprintf(stderr, \"%s\\n\", mysql_error(con));\n        mysql_close(con);\n        exit(1);\n    }\n\n    // Create a sample empty DB, named \"aNewDatabase\"\n    if (mysql_query(con, \"CREATE DATABASE aNewDatabase\")) {\n        fprintf(stderr, \"%s\\n\", mysql_error(con));\n        mysql_close(con);\n        exit(1);\n    }\n\n    // Close connection\n    mysql_close(con);\n    exit(0);\n}\n</code></pre>\n\n<p>I had a cursory look at <a href=\"https://github.com/MariaDB/server\" rel=\"noreferrer\">https://github.com/MariaDB/server</a> but didn't know where to really look...or in fact what I was looking for.\nHow does one go about getting an embedded mariadb going?\nI'm running on Mac OS High Sierra, MariaDB was installed with <code>brew install mariadb --with-embedded</code>. </p>\n\n<p><strong>UPDATE:</strong></p>\n\n<p>I'm fairly certain I'm linking to the correct lib.</p>\n\n<p><code>ls /usr/local/lib | grep maria</code></p>\n\n<p><a href=\"https://i.stack.imgur.com/j4PAN.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/j4PAN.png\" alt=\"MariaDB\"></a></p>\n\n<pre><code>FIND_LIBRARY(mariadb mariadb)\nMESSAGE(FATAL_ERROR \"BOOM ${mariadb}\")\n</code></pre>\n\n<p>Output of which is:\n<code>BOOM /usr/local/lib/libmariadb.dylib</code></p>\n\n<p><strong>UPDATE 2</strong></p>\n\n<p>I'm now linking to the following. Note that I started with just libmysqld and added libraries until all link errors went away. The trouble here is I may not have all the correct libs or versions.</p>\n\n<pre><code>TARGET_LINK_LIBRARIES(sql_fn /usr/local/lib/libmysqld.a)\nTARGET_LINK_LIBRARIES(sql_fn /usr/local/opt/openssl/lib/libcrypto.a)\nTARGET_LINK_LIBRARIES(sql_fn /usr/local/opt/openssl/lib/libssl.a)\nTARGET_LINK_LIBRARIES(sql_fn /usr/local/opt/bzip2/lib/libbz2.a)\nTARGET_LINK_LIBRARIES(sql_fn /usr/local/lib/liblz4.a)\nTARGET_LINK_LIBRARIES(sql_fn /usr/local/opt/zlib/lib/libz.a)\nTARGET_LINK_LIBRARIES(sql_fn /usr/local/opt/xz/lib/liblzma.a)\nTARGET_LINK_LIBRARIES(sql_fn /usr/local/lib/libsnappy.a)\n</code></pre>\n\n<p>It now compiles but exits with code 6\n<a href=\"https://i.stack.imgur.com/gK3AF.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/gK3AF.png\" alt=\"CLion Debugger of exit stack\"></a></p>\n\n<p><code>Process finished with exit code 6</code>\nLooking at <a href=\"https://stackoverflow.com/a/7495907/400048\">https://stackoverflow.com/a/7495907/400048</a> if it's points to the same thing/is still true then exit code 6 means <code>EX_ILLEGAL_TABLE 6</code>, unfortunately I don't know what table that would be. The <code>mysql_test</code> and datadir strings passed in are valid identifiers/path. </p>\n"}, {"tags": ["c", "pointers", "visual-studio-2015"], "comments": [{"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 4, "creation_date": 1516138591, "post_id": 48290192, "comment_id": 83565448, "body": "Do not describe error, quote it full and verbatim."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 3, "creation_date": 1516138614, "post_id": 48290192, "comment_id": 83565460, "body": "Also identify the line the error refers to, by adding a comment."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1516138681, "post_id": 48290192, "comment_id": 83565494, "body": "I do not really believe &quot;i&#39;ve left only the relevant part of my code&quot;. A real <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> I would estimate at a third of the length."}, {"owner": {"reputation": 13, "user_id": 9226468, "user_type": "registered", "profile_image": "https://graph.facebook.com/1735120699841681/picture?type=large", "display_name": "Gal", "link": "https://stackoverflow.com/users/9226468/gal"}, "reply_to_user": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1516139360, "post_id": 48290192, "comment_id": 83565814, "body": "&quot;expression must have arithmetic type&quot; second line from the end."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1516139864, "post_id": 48290192, "comment_id": 83566035, "body": "Functions <code>quick_sort</code> and <code>input_array_dyn</code> are unknown. The definition <code>main()</code> is obsolete but backward-compatible."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1516139888, "post_id": 48290192, "comment_id": 83566048, "body": "Thanks for the additional info, but with &quot;by adding a comment&quot; I meant to <a href=\"https://stackoverflow.com/posts/48290192/edit\">edit</a> the code in your question, adding a C-comment <code>&#47;* error here *&#47;</code>. And while editing, take the opportunity to add the full and verbatim error message. Also, taking the <a href=\"https://stackoverflow.com/tour\">tour</a> would probably help you find your way at StackOverflow."}, {"owner": {"reputation": 13, "user_id": 9226468, "user_type": "registered", "profile_image": "https://graph.facebook.com/1735120699841681/picture?type=large", "display_name": "Gal", "link": "https://stackoverflow.com/users/9226468/gal"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1516140188, "post_id": 48290192, "comment_id": 83566156, "body": "@WeatherVane It was my bad for not displaying the whole code, but  <code>size2</code> has been initialized in a function."}, {"owner": {"reputation": 13, "user_id": 9226468, "user_type": "registered", "profile_image": "https://graph.facebook.com/1735120699841681/picture?type=large", "display_name": "Gal", "link": "https://stackoverflow.com/users/9226468/gal"}, "reply_to_user": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1516140276, "post_id": 48290192, "comment_id": 83566191, "body": "@Yunnosch Thank you, I&#39;ll be sure to have a look at it."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1516140297, "post_id": 48290192, "comment_id": 83566204, "body": "Yeah, I saw that and edited the previous comment. But it is good practice to initialise local variables to a manageable default value, especially when set by a function whose return value is not checked."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1516317600, "post_id": 48290192, "comment_id": 83649505, "body": "the posted code causes the compiler to output a long long string of warning messages.  When compiling, always enable the warnings, then fix those warnings.  ( for <code>gcc</code>, at a minimum use: <code>-Wall -Wextra -Wconversion -pedantic -std=gnu11 )</code>   You could start with inserting the statement: <code>#include &lt;assert.h&gt;</code>  to expose the <code>assert()</code> function."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1516317986, "post_id": 48290192, "comment_id": 83649608, "body": "regarding: <code>int quick_sort(int *arr, int low, int high)</code>   This states that the function returns an <code>int</code>, however, the body of the function NEVER ever returns anything.  Suggest either rewriting the function -or- change the return type to <code>void</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1516318176, "post_id": 48290192, "comment_id": 83649665, "body": "when calling any of the <code>scanf()</code> family of functions, always check the returned value (not the parameter values) to assure the operation was successful."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1516318384, "post_id": 48290192, "comment_id": 83649707, "body": "when calling any of the heap allocation functions: ( malloc, calloc, realloc ) 1) the return type is <code>void*</code> which can be assigned to any pointer.  Casting just clutters the code, making it more difficult to understand, debug, etc.  2) calling <code>assert()</code> to check for a failure of the function is not a good idea.,  much better to check (!=NULL) the returned value and if NULL, call <code>perror()</code> so a error message and the reason the system thinks the function failed are output to <code>stderr</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1516318528, "post_id": 48290192, "comment_id": 83649747, "body": "never trust the user.  even if that user is yourself.  so this statement: <code>scanf(&quot;%d&quot;, n);</code> (which allows a input of 0 or even &lt;0 values should be followed by a check that the value input is &gt;0"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1516318611, "post_id": 48290192, "comment_id": 83649766, "body": "for ease of readability and understanding: 1) insert an appropriate space: inside parens, after commas, after semicolons, around C operators"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1516318829, "post_id": 48290192, "comment_id": 83649835, "body": "variable names (and function parameters) should indicate <code>content</code> or <code>usage</code> (or better, both).  names like <code>SA</code>, <code>SB</code>, etc are meaningless, even in the current context."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1516318881, "post_id": 48290192, "comment_id": 83649850, "body": "for ease of readability and understanding: 1) consistently indent the code. Indent after every opening brace &#39;{&#39;. Unindent before every closing brace &#39;}&#39;. Suggest each indent level be 4 spaces. 2) separate code blocks ( &#39;for&#39; if else while do...while switch case default ) via a single blank line. 3) separate functions by 2 or 3 blank lines (be consistent)   4) follow the axiom: <i>only one statement per line and (at most) one variable declaration per statement.</i>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1516319093, "post_id": 48290192, "comment_id": 83649897, "body": "regarding this function: <code>int input_array_dyn(int*n)</code>  the body of the function returns a <code>int*</code>, not a <code>int</code>.   so the signature of the function should be: <code>int *input_array_dyn( int *n )</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1516319341, "post_id": 48290192, "comment_id": 83649970, "body": "regarding: `    int *arr3 = calloc(size2, sizeof(int)); arr3= find_intersection(arr1, arr2, arr3, size1, size2, &amp;counter);`  results in a memory leak as the call to <code>find_intersection()</code> will overlay the pointer placed in <code>arr3</code> via the call to <code>calloc()</code>  and it fails to check if the call to <code>calloc()</code> was successful."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1516319653, "post_id": 48290192, "comment_id": 83650048, "body": "regarding: <code>int size1, size2, *counter, i=0;</code>   The variable <code>counter</code> is never set to point to any specific memory that the application owns, so it contains what ever trash is on the stack at its&#39; location.  Strongly suggest modifying it to: <code>int size1, size2, counter, i=0;</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1516319854, "post_id": 48290192, "comment_id": 83650099, "body": "Notice: the parameter to <code>calloc()</code>, <code>malloc()</code> and <code>realloc()</code>  is a <code>size_t</code>, not a <code>int</code>.  While the <code>implicit conversion</code> feature of C will &#39;usually&#39; save you, you should not depend on that feature."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1516320115, "post_id": 48290192, "comment_id": 83650165, "body": "when calling <code>realloc()</code>, always save the returned value into a temporary variable, so when the function fails, the original pointer is not lost.  Otherwise a memory leak will occur.  Also, <code>counter</code> is a pointer to a value. Suggest: <code>int *temp = realloc(arr3, (*counter)*sizeof(int));  if( !temp ) { perror( &quot;realloc failed&quot; );  &#47;&#47; clean up then exit( EXIT_FAILURE ); }   &#47;&#47; implied else, realloc successful  arr3 = temp;</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1516320408, "post_id": 48290192, "comment_id": 83650233, "body": "regarding: <code>a = calloc(*n, sizeof(double));</code>  the array <code>a[]</code> is an array of integers, so the statement should be: <code>a = calloc(*n, sizeof(int));</code>"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 9226468, "user_type": "registered", "profile_image": "https://graph.facebook.com/1735120699841681/picture?type=large", "display_name": "Gal", "link": "https://stackoverflow.com/users/9226468/gal"}, "edited": false, "score": 0, "creation_date": 1516139890, "post_id": 48290230, "comment_id": 83566049, "body": "So, I&#39;ve changed all the  <code>counter</code> to <code>*counter</code> and it worked. Thanks!"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1516140827, "post_id": 48290230, "comment_id": 83566395, "body": "@GalYacobi <a href=\"https://stackoverflow.com/help/someone-answers\">stackoverflow.com/help/someone-answers</a> You are explicitly not required to do anything, but please confirm that you are aware of this. And while you are reading anyway, please take the <a href=\"https://stackoverflow.com/tour\">tour</a>."}], "tags": [], "owner": {"reputation": 17958, "user_id": 1971013, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/EtqFE.jpg?s=128&g=1", "display_name": "meaning-matters", "link": "https://stackoverflow.com/users/1971013/meaning-matters"}, "is_accepted": true, "score": 5, "last_activity_date": 1516138692, "creation_date": 1516138692, "answer_id": 48290230, "question_id": 48290192, "link": "https://stackoverflow.com/questions/48290192/expression-must-have-arithmetic-type/48290230#48290230", "title": "Expression must have arithmetic type", "body": "<p>In <code>find_intersection()</code> <code>counter</code> is a pointer to an <code>int</code>. To change it's value you need to use <code>*counter</code> instead of <code>counter</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 32078, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "is_accepted": false, "score": 2, "last_activity_date": 1516138711, "creation_date": 1516138711, "answer_id": 48290235, "question_id": 48290192, "link": "https://stackoverflow.com/questions/48290192/expression-must-have-arithmetic-type/48290235#48290235", "title": "Expression must have arithmetic type", "body": "<p><code>return arr3;</code> attempts to return a pointer to <code>int</code> while function is declared to return just <code>int</code>. <code>counter</code> is a pointer to an <code>int</code> while you are using it as an regular <code>int</code> setting to 0 and so on.</p>\n"}], "owner": {"reputation": 13, "user_id": 9226468, "user_type": "registered", "profile_image": "https://graph.facebook.com/1735120699841681/picture?type=large", "display_name": "Gal", "link": "https://stackoverflow.com/users/9226468/gal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8268, "favorite_count": 0, "accepted_answer_id": 48290230, "answer_count": 2, "score": 1, "last_activity_date": 1516140879, "creation_date": 1516138501, "last_edit_date": 1516140879, "question_id": 48290192, "link": "https://stackoverflow.com/questions/48290192/expression-must-have-arithmetic-type", "title": "Expression must have arithmetic type", "body": "<p>While trying to write a code to find the intersection of two arrays,I came across a problem. I can't seem to modify a pointer inside a function.\nInside my find_intersection I get the error while doing the realloc function,compiler states that \"counter\" has no arithmetic value.\nAny explanation on what went wrong here?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint quick_sort(int*, int, int);\nvoid swap(int*, int*);\nint partition(int *, int, int);\nint input_array_dyn(int*n);\nint *find_intersection(int*, int*, int*, int, int,int *);\n\nmain()\n{\nint size1, size2, *counter, i=0;\nint *arr1 = input_array_dyn(&amp;size1);\nint *arr2 = input_array_dyn(&amp;size2);\n\nquick_sort(arr1, 0, size1 - 1);\nquick_sort(arr2, 0, size2 - 1);\n\nint *arr3 = (int*)calloc(size2, sizeof(int));\narr3= find_intersection(arr1, arr2, arr3, size1, size2, &amp;counter);\n\nprintf(\"The size of the new array is:%d\\n\", counter);\nwhile (i &lt; counter)\n{\n    printf(\"%d\\n\", arr3[i]);\n    i++;\n}\nfree(arr1);\nfree(arr2);\nfree(arr3);\n}\n\nint *find_intersection(int *arr1, int *arr2, int *arr3, int SA, int SB, int *counter)\n{\nint i = 0, j = 0, n = 0;\n*counter = 0;\n\nwhile (i &lt; SA &amp;&amp;j &lt; SB)\n{\n    if (arr1[i] &lt; arr2[j])\n        i++;\n    else if (arr2[j] &lt; arr1[i])\n        j++;\n    else\n    {\n        arr3[n] = arr1[i];\n        i++;\n        n++;\n        j++;\n    }\n}\ncounter = n;\narr3 = (int*)realloc(arr3, counter*sizeof(int));/*error here*/\n\nreturn arr3;\n}\n\nint input_array_dyn(int*n)\n{\nint i;\nint *a;\nprintf(\"Enter the size of the array:\\n\");\nscanf(\"%d\", n);\na = (int*)calloc(*n, sizeof(double));\nassert(a);\nprintf(\"Enter the array elements:%d.\\n\", *n);\nfor (i = 0; i &lt; *n; i++)\n    scanf(\"%d\", a + i);\nreturn a;\n}\nvoid swap(int* a, int* b)\n{\nint t = *a;\n*a = *b;\n*b = t;\n}\nint partition(int *arr, int low, int high)\n{\nint pivot = arr[high];\nint i = (low - 1);\n\nfor (int j = low; j &lt;= high - 1; j++)\n{\n    if (arr[j] &lt;= pivot)\n    {\n        i++;\n        swap(&amp;arr[i], &amp;arr[j]);\n    }\n}\nswap(&amp;arr[i + 1], &amp;arr[high]);\nreturn (i + 1);\n}\n\nint quick_sort(int *arr, int low, int high)\n{\nif (low &lt; high)\n{\n    int pi = partition(arr, low, high);\n\n    quick_sort(arr, low, pi - 1);\n    quick_sort(arr, pi + 1, high);\n}\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1516137458, "post_id": 48289963, "comment_id": 83564932, "body": "<code>fgets</code>, then take the first character..."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1516137797, "post_id": 48289963, "comment_id": 83565087, "body": "Oops - <code>scanf(&quot;%s&quot;, &amp;players);</code> but you have <code>int players</code> which requires <code>%d</code> format spec."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1516138217, "post_id": 48289963, "comment_id": 83565285, "body": "Please don&#39;t correct the code posted in response to comments. Rolled back."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1516138284, "post_id": 48289963, "comment_id": 83565308, "body": "It is essential to check a function&#39;s return value for <b>all</b> user input, besides validating the value entered. Does <code>getchar</code> return <code>EOF</code> (aside: <code>char gameType;</code> should be <code>int gameType;</code>)? Does <code>scanf</code> return the numbers of successful inputs which you expect?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1516138364, "post_id": 48289963, "comment_id": 83565339, "body": "You also have <code>printf(&quot;%c players\\n&quot;, players);</code> and again - wrong format specifier."}, {"owner": {"reputation": 53, "user_id": 9226464, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eeacc142f8a2fa4f48a0ffa1f694783d?s=128&d=identicon&r=PG&f=1", "display_name": "Jacob Stephenson", "link": "https://stackoverflow.com/users/9226464/jacob-stephenson"}, "edited": false, "score": 0, "creation_date": 1516138672, "post_id": 48289963, "comment_id": 83565490, "body": "Sorry about the edit, didn&#39;t know. The number of players does come back correctly from what was input (after changing specifier)."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1516138812, "post_id": 48289963, "comment_id": 83565564, "body": "The question should be edited only to clarify etc. \u2013 otherwise you will end up with perfect code that baffles why the question was asked."}, {"owner": {"reputation": 53, "user_id": 9226464, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eeacc142f8a2fa4f48a0ffa1f694783d?s=128&d=identicon&r=PG&f=1", "display_name": "Jacob Stephenson", "link": "https://stackoverflow.com/users/9226464/jacob-stephenson"}, "edited": false, "score": 0, "creation_date": 1516139291, "post_id": 48289963, "comment_id": 83565785, "body": "If the input is multiple characters that start with either C,c,S, or S it skips the scanf statement, and prints 0 players, not sure why."}], "answers": [{"tags": [], "owner": {"reputation": 51, "user_id": 2993049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e85a8967f5e8641585aa2bedd5a5f982?s=128&d=identicon&r=PG&f=1", "display_name": "mrjaso", "link": "https://stackoverflow.com/users/2993049/mrjaso"}, "is_accepted": true, "score": 1, "last_activity_date": 1516138791, "creation_date": 1516138791, "answer_id": 48290254, "question_id": 48289963, "link": "https://stackoverflow.com/questions/48289963/taking-first-character-of-user-input-discarding-the-rest-in-c/48290254#48290254", "title": "Taking first character of user input, discarding the rest in c", "body": "<p>You can clear the input at the start of your else block before the printf.</p>\n\n<pre><code>while ( (gameType = getchar()) != '\\n' &amp;&amp; gameType != EOF ) { }\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 9226464, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eeacc142f8a2fa4f48a0ffa1f694783d?s=128&d=identicon&r=PG&f=1", "display_name": "Jacob Stephenson", "link": "https://stackoverflow.com/users/9226464/jacob-stephenson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 236, "favorite_count": 0, "accepted_answer_id": 48290254, "answer_count": 1, "score": 2, "last_activity_date": 1516138791, "creation_date": 1516137359, "last_edit_date": 1516138226, "question_id": 48289963, "link": "https://stackoverflow.com/questions/48289963/taking-first-character-of-user-input-discarding-the-rest-in-c", "title": "Taking first character of user input, discarding the rest in c", "body": "<p>In my current code, If the user inputs a string not starting with c or s, it will check every character in the string, and keep outputting the printf. How would I make it so it only checks the first character and lets the user type a new string to check.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\nint main()\n{\n//Declare Variables\nint players, P1, P2, P3, P4, loop, loop2;\nchar gameType;\nchar c;\n//Initialize Variables\nplayers = 0;\nP1 = 0;\nP2 = 0;\nP3 = 0;\nP4 = 0;\nloop = 1;\nloop2 = 1;\n\n//Figure out what game type\nprintf(\"Commander or Standard?\\n\"); \ngameType = getchar();\n    while (loop == 1)\n    {   \n        if (gameType == 'C' || gameType == 'c')\n        {\n            P1 = 40, P2 = 40, P3 = 40, P4 = 40;\n            loop = 0;   \n            printf(\"How many players?\\n\");\n            scanf(\"%s\", &amp;players);\n            printf(\"%c players\\n\", players);\n        }\n        else if (gameType == 'S' || gameType == 's')\n        {\n            P1 = 20, P2 = 20;\n            printf(\"Player 1 HP: %d\\n\", P1);        \n            printf(\"Player 2 HP: %d\\n\", P2);\n            loop = 0;                   \n        }\n        else \n        {\n            printf(\"Please enter either Commander or Standard\\n\");\n            loop = 1;\n            gameType = getchar();\n        }\n    }\n\nreturn 0;\n}   \n</code></pre>\n"}, {"tags": ["c", "linux", "linux-kernel"], "comments": [{"owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "edited": false, "score": 2, "creation_date": 1516137306, "post_id": 48289812, "comment_id": 83564878, "body": "What&#39;s the <i>exact</i> error message you are getting from the compiler?"}, {"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 1, "creation_date": 1516139874, "post_id": 48289812, "comment_id": 83566040, "body": "You&#39;ve told us there is an error on compiling, but have not stated the error, nor supplied any code from which the error originates.  Very hard to psychic debug this one."}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1516143798, "post_id": 48289812, "comment_id": 83567490, "body": "&quot;I&#39;ve been going through the kernel source files via elixir.free-electrons.com/linux/latest/source/kernel in the hopes of locating these properties&quot; - Why didn&#39;t you do that before asking the question? <code>struct arch_spinlock_t</code> <a href=\"http://elixir.free-electrons.com/linux/v4.10/ident/arch_spinlock_t%E2%80%8C%E2%80%8B\" rel=\"nofollow noreferrer\">has no longer x86-specific specialization</a>, and <a href=\"http://elixir.free-electrons.com/linux/v4.10/source/include/asm-generic/qspinlock_types.h#L33\" rel=\"nofollow noreferrer\">uses generic specialization</a> without <code>.tickets</code> field and its concepts. So, what do you want from us?"}, {"owner": {"reputation": 1, "user_id": 9226441, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aea8bf81df3b425dc273804053467307?s=128&d=identicon&r=PG&f=1", "display_name": "Robert Heras", "link": "https://stackoverflow.com/users/9226441/robert-heras"}, "edited": false, "score": 0, "creation_date": 1516144862, "post_id": 48289812, "comment_id": 83567818, "body": "I&#39;ve been doing that but haven&#39;t been getting anywhere so thought I&#39;d ask cause I&#39;m lost and new to this. I didn&#39;t realize tickets field and its concepts were no longer used."}], "owner": {"reputation": 1, "user_id": 9226441, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aea8bf81df3b425dc273804053467307?s=128&d=identicon&r=PG&f=1", "display_name": "Robert Heras", "link": "https://stackoverflow.com/users/9226441/robert-heras"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 89, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1516140763, "creation_date": 1516136701, "last_edit_date": 1516140763, "question_id": 48289812, "link": "https://stackoverflow.com/questions/48289812/locating-kernel-properties-in-linux-via-c-driver", "title": "Locating kernel properties in Linux via C driver", "body": "<p>so I'm doing research for my thesis but I've run into an issue. I'm using a driver my mentor has given me to analyze memory and extract features from a running process. The driver is written in C and I'm running it in Ubuntu 16.04 and the error I'm having is when I compile. My current kernel version is 4.10.0-42-generic.</p>\n\n<p>The following are the three lines are giving an error because they are not found.</p>\n\n<ul>\n<li>(*task->active_mm).page_table_lock.rlock.raw_lock.tickets.head</li>\n<li>(*task->active_mm).shared_vm</li>\n<li>task->alloc_lock.rlock.raw_lock.tickets.head</li>\n</ul>\n\n<p>For the first, the error starts on tickets I think. For the second shared_vm isn't found and for the last tickets is also where the error begins. My understanding is that the properties are no found.</p>\n\n<p>I've been going through the kernel source files via <a href=\"https://elixir.free-electrons.com/linux/latest/source/kernel\" rel=\"nofollow noreferrer\">https://elixir.free-electrons.com/linux/latest/source/kernel</a> in the hopes of locating these properties but if anyone knows where they are or can help me locate them that would be very helpful. I'm new to all this so again any help is really appreciated.</p>\n\n<p>Edit: The specific errors are: has no member named 'tickets', has no member named shared_vm, and has no member named 'tickets' for each respective line of code. Unfortunately I can't share any more code due to my professors request. <a href=\"https://i.stack.imgur.com/6ThNd.png\" rel=\"nofollow noreferrer\">Screenshot of when I try to 'make'</a></p>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 1, "creation_date": 1516136272, "post_id": 48289686, "comment_id": 83564424, "body": "Have you thought about reading the manual page for <code>printf</code> - i.e. <a href=\"https://linux.die.net/man/3/printf\" rel=\"nofollow noreferrer\">here</a>"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 3, "creation_date": 1516136338, "post_id": 48289686, "comment_id": 83564457, "body": "a lot of UB here.*"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1516136464, "post_id": 48289686, "comment_id": 83564520, "body": "I would say that <code>%llu</code> consumes too much bytes, which &quot;shifts&quot; further readings. which probably explains why the last value is the same: it&#39;s reading arguments out of the argument area."}, {"owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "edited": false, "score": 0, "creation_date": 1516136528, "post_id": 48289686, "comment_id": 83564550, "body": "Using any conversion specifier other than <code>%u</code> to print pointer values leads to undefined behavior.  Replace that call with <code>printf( &quot;%p\\n&quot;, a + i );</code> and see if that doesn&#39;t give you the results you expect."}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 2, "creation_date": 1516137034, "post_id": 48289686, "comment_id": 83564773, "body": "Consider using a compiler that will warn you if your <code>printf</code> arguments do not match the expected types in the format specifiers."}], "answers": [{"tags": [], "owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "is_accepted": false, "score": 5, "last_activity_date": 1516136456, "creation_date": 1516136456, "answer_id": 48289754, "question_id": 48289686, "link": "https://stackoverflow.com/questions/48289686/output-of-variable-address-in-printf/48289754#48289754", "title": "Output of variable address in printf", "body": "<p>Your code causes <a href=\"https://stackoverflow.com/a/4105123/1505939\">undefined behaviour</a> by using the wrong format specifiers. The results are meaningless. </p>\n\n<p>It is up to the programmer to use the correct format specifier for the argument provided, there is no intermediate \"compiler magic\" in C. If you don't follow the rules then your program is no longer covered by any of said rules and anything can happen, which in your case manifested itself as unexpected output.</p>\n"}, {"tags": [], "owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "is_accepted": false, "score": 3, "last_activity_date": 1516137982, "last_edit_date": 1516137982, "creation_date": 1516136654, "answer_id": 48289799, "question_id": 48289686, "link": "https://stackoverflow.com/questions/48289686/output-of-variable-address-in-printf/48289799#48289799", "title": "Output of variable address in printf", "body": "<p>let's dump the first argument in hex:</p>\n\n<pre><code>&gt;&gt;&gt; hex(31519768560270096 )\n'0x6ffb10006ffb10'  &lt;=== twice the same 0x6ffb10 32-bit value\n&gt;&gt;&gt; hex(31519785740139284 )\n'0x6ffb14006ffb14'  &lt;=== same here, increased by 4\n</code></pre>\n\n<p>as you see, using the first argument wrong format specifier makes <code>printf</code> read too much from the variable argument area, so the second argument is actually the third argument (they have the same value), but in the end the last argument (the pointer) reads <em>outside</em> the variable argument area. That's why it's not varying</p>\n\n<p>Anyway, that's just to explain what happens behind the scenes for your particular compiler implementation, but don't do that <em>ever</em> because it's undefined behaviour.</p>\n"}, {"comments": [{"owner": {"reputation": 11894, "user_id": 68304, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/476cd7b5710793b8c90f5b469820a1ed?s=128&d=identicon&r=PG", "display_name": "Donotalo", "link": "https://stackoverflow.com/users/68304/donotalo"}, "edited": false, "score": 0, "creation_date": 1516137856, "post_id": 48289966, "comment_id": 83565114, "body": "Thanks for the explanation. I was just playing with pointers and came up with the code above. I didn&#39;t know that <code>%llu</code> would consume 8 bytes. But not knowing it causes several negative votes. :) Anyway, it&#39;s a good lesson."}, {"owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "reply_to_user": {"reputation": 11894, "user_id": 68304, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/476cd7b5710793b8c90f5b469820a1ed?s=128&d=identicon&r=PG", "display_name": "Donotalo", "link": "https://stackoverflow.com/users/68304/donotalo"}, "edited": false, "score": 0, "creation_date": 1516138031, "post_id": 48289966, "comment_id": 83565200, "body": "@Donotalo: Beware, that behaviour is not mandated per standard and is no more than the one of a specific compiler with specific options. That&#39;s why I said ensure that the printf formatter and the value to print agree on the type..."}], "tags": [], "owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "is_accepted": true, "score": 4, "last_activity_date": 1516137372, "creation_date": 1516137372, "answer_id": 48289966, "question_id": 48289686, "link": "https://stackoverflow.com/questions/48289686/output-of-variable-address-in-printf/48289966#48289966", "title": "Output of variable address in printf", "body": "<p>Oups! You are trying to print with %llu something that is not a long long. This is enough to invoke Undefined Behaviour, and you can no longer expect that your program gives correct output.</p>\n\n<p>Under the hood, common compilers implementation push parameters on the stack, and the <code>printf</code> function gets them from there. On a 32 bit architecture, pointers use only 4 bytes, so your call actually pushes 12 bytes onto the stack. </p>\n\n<p>But the <code>%llu</code> uses 8 bytes, <em>eating</em> 2 of the passed parameters. So the <code>%u</code> correctly displays last one, and %p prints what comes after in the stack. It begins even more evident if you convert the long long unsigned into hexadecimal: 31519768560270096 is 0x006FFB10006FFB10, which is in fact the 2 initial parameters having 0x6FFB10 or in decimal 7338768</p>\n\n<p>TL/DR: NEVER use anything but <code>%p</code> to print addresses, unless you really know why (and even in that case, try to refrain...)</p>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 2, "last_activity_date": 1516141699, "creation_date": 1516141699, "answer_id": 48290841, "question_id": 48289686, "link": "https://stackoverflow.com/questions/48289686/output-of-variable-address-in-printf/48290841#48290841", "title": "Output of variable address in printf", "body": "<p>Use matching types for each printf specifier.  As OP's code does not do this,the result is <em>undefined behavior</em> (UB).  Explaining UB is often not nearly so valuable as learning how to avoid it.  </p>\n\n<p><a href=\"https://stackoverflow.com/questions/48289686/output-of-variable-address-in-printf/48290841#comment83564773_48289686\">@jxh</a> advice is sound, use a better compiler or options.</p>\n\n<pre><code>printf(\"%llu %u %p\\n\",\n   // a + i, a + i, a + i);\n   (unsigned long long) (a + i), (unsigned) (a + i), (void*) (a + i));\n</code></pre>\n\n<p>This may not print the same text for the 3 <code>(a+i)</code>.  I would expect the <code>%u</code> to be a truncated value, but at least these is no UB, just <em>implementation defined behavior</em>.</p>\n\n<p>Use the last form for the best result when printing the value of <em>object pointers</em>.</p>\n\n<pre><code>printf(\"%p\\n\", (void*) (a + i));\n</code></pre>\n"}], "owner": {"reputation": 11894, "user_id": 68304, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/476cd7b5710793b8c90f5b469820a1ed?s=128&d=identicon&r=PG", "display_name": "Donotalo", "link": "https://stackoverflow.com/users/68304/donotalo"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 1, "closed_date": 1516150260, "accepted_answer_id": 48289966, "answer_count": 4, "score": -4, "last_activity_date": 1516141699, "creation_date": 1516136160, "last_edit_date": 1516137912, "question_id": 48289686, "link": "https://stackoverflow.com/questions/48289686/output-of-variable-address-in-printf", "closed_reason": "Not suitable for this site", "title": "Output of variable address in printf", "body": "<p>If I build and run the following program in Visual C++ 2017:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main()\n{\n    int a[3] = { 0 };\n\n    for (int i = 0; i &lt; 3; i++)\n    {\n        printf(\"%llu %u %p\\n\", a + i, a + i, a + i);\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>I see output like as follows:</p>\n\n<pre><code>31519768560270096 7338768 000F1055\n31519785740139284 7338772 000F1055\n31519802920008472 7338776 000F1055\n</code></pre>\n\n<p>That I cannot relate.</p>\n\n<p>Why the output of <code>%llu</code> are so different? <code>sizeof(int)</code> on my platform is 4.</p>\n\n<p>Why the output of <code>%p</code> are all same? They are address of different variables.</p>\n\n<p>Only the output of <code>%u</code> seems to be consistent - consecutive memory location of 3 array elements each having 4 bytes. But these output matches with neither <code>%llu</code> nor <code>%p</code>.</p>\n"}, {"tags": ["c", "strict-aliasing", "restrict"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 4, "creation_date": 1516136007, "post_id": 48289616, "comment_id": 83564310, "body": "<i>Hence my understanding was that without restrict keyword, output of the program will be 40 and with &#39;restrict&#39; output will be 30</i> - No. With <code>restrict</code> it will be undefined."}, {"owner": {"reputation": 324, "user_id": 5420223, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1899173098022a1cbaa366f11b7f1afd?s=128&d=identicon&r=PG&f=1", "display_name": "NeilB", "link": "https://stackoverflow.com/users/5420223/neilb"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1516136247, "post_id": 48289616, "comment_id": 83564410, "body": "@EugeneSh.By using restrict, are we not telling compiler that a and b are not pointing towards same memory? so it can optimize without worry?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 3, "creation_date": 1516136321, "post_id": 48289616, "comment_id": 83564447, "body": "It can optimize but does not have to. You are promising the compiler something, but then you break your promise. These things are not working well."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1516137059, "post_id": 48289616, "comment_id": 83564788, "body": "You cheat your compiler so what you expect as a result. It the perfect axample if the language abuse, C language allows a lot comparing to another languages. But do not worry too much. All beginners go through it."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1516137211, "post_id": 48289616, "comment_id": 83564844, "body": "BTW, it has little (like nothing) to do with <i>strict aliasing</i>."}], "answers": [{"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": true, "score": 3, "last_activity_date": 1516137117, "creation_date": 1516137117, "answer_id": 48289903, "question_id": 48289616, "link": "https://stackoverflow.com/questions/48289616/understanding-restrict-keyword/48289903#48289903", "title": "Understanding restrict keyword", "body": "<p>You observe:</p>\n\n<blockquote>\n  <p>In this case, same memory location is referenced by two pointers.\n  [...] my\n  understanding was that without restrict keyword, output of the program\n  will be 40 and with 'restrict' output will be 30 (as 'a' does not need\n  to be read from memory after \"*b += *a\").</p>\n</blockquote>\n\n<p>But your expectation is directly contrary to the C standard, which specifies:</p>\n\n<blockquote>\n  <p>The intended use of the <code>restrict</code> qualifier [...] is to <em>promote</em>\n  optimization, and <strong><em>deleting all instances of the qualifier from all\n  preprocessing translation units composing a conforming program does\n  not change its meaning</em></strong> (i.e., observable behavior).</p>\n</blockquote>\n\n<p>(<a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.7.3p8\" rel=\"nofollow noreferrer\">C2011 6.7.3/8</a>; emphasis added)</p>\n\n<p>Furthermore, 6.7.3/8 also says,</p>\n\n<blockquote>\n  <p>An object that is accessed through a restrict-qualified pointer has a\n  special association with that pointer. This association, defined in\n  6.7.3.1 below, requires that all accesses to that object use, directly or indirectly, the value of that particular pointer.</p>\n</blockquote>\n\n<p>and without going into the details, 6.7.3.1 explicitly specifies that when its provisions are not satisfied by a given program, the behavior is undefined.  Your program triggers this provision, and you are anticipating a particular manifestation of the resulting undefined behavior.  Nothing in the C language justifies that.</p>\n\n<blockquote>\n  <p>However even with restrict,\n  output is 40. why the optimization is not happening?</p>\n</blockquote>\n\n<p>The C language never <em>requires</em> either optimization in general or any specific optimization to be performed.</p>\n"}], "owner": {"reputation": 324, "user_id": 5420223, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1899173098022a1cbaa366f11b7f1afd?s=128&d=identicon&r=PG&f=1", "display_name": "NeilB", "link": "https://stackoverflow.com/users/5420223/neilb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 456, "favorite_count": 0, "accepted_answer_id": 48289903, "answer_count": 1, "score": 1, "last_activity_date": 1528289658, "creation_date": 1516135823, "last_edit_date": 1528289658, "question_id": 48289616, "link": "https://stackoverflow.com/questions/48289616/understanding-restrict-keyword", "title": "Understanding restrict keyword", "body": "<p>To understand strict-aliasing and the usage of restrict keyword, I am trying the program shown below. In this case, same memory location is referenced by two pointers. Hence without user explicitly telling, compiler can't do any optimization (i.e. without using restrict keyword). Hence my understanding was that without restrict keyword, output of the program will be 40 and with 'restrict' output will be 30 (as 'a' does not need to be read from memory after \"*b += *a\"). However even with restrict, output is 40. why the optimization is not happening?  </p>\n\n<p>I am following \"<a href=\"https://stackoverflow.com/questions/98650/what-is-the-strict-aliasing-rule/47960435?noredirect=1#comment83550252_47960435\">What is the strict aliasing rule?</a>\" for understanding. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid merge_two_ints(int * restrict a, int * restrict b) {\n  *b += *a;\n  *a += *b;\n}\n\nint\nmain(void)\n{\n    int x = 10;\n    int *a = &amp;x;\n    int *b = &amp;x;\n    merge_two_ints(a, b);\n    printf(\"%d\\n\", x);\n    return 0;\n}\n</code></pre>\n\n<p>bash-3.2$ gcc -Wall -O3 -fstrict-aliasing -std=c99 strict_alias2.c</p>\n\n<p>bash-3.2$ ./a.out\n40</p>\n"}, {"tags": ["c", "for-loop", "scanf"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 3, "creation_date": 1516135090, "post_id": 48289442, "comment_id": 83563815, "body": "Hint: What does the U in <code>%u</code> stand for?"}, {"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 0, "creation_date": 1516135102, "post_id": 48289442, "comment_id": 83563822, "body": "Perhaps read the <a href=\"https://linux.die.net/man/3/scanf\" rel=\"nofollow noreferrer\">manual page</a> and get the right format"}, {"owner": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "edited": false, "score": 1, "creation_date": 1516135149, "post_id": 48289442, "comment_id": 83563847, "body": "The format specifier <code>%u</code> is for <code>unsigned</code>, so how do you expect to read signed numbers?"}], "answers": [{"comments": [{"owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "edited": false, "score": 1, "creation_date": 1516135821, "post_id": 48289474, "comment_id": 83564203, "body": "Make sure <code>val</code> is declared as a plain <code>int</code> as well; if you try to read a negative value into an <code>unsigned</code> object, you&#39;re not going to get what you expect."}], "tags": [], "owner": {"reputation": 11238, "user_id": 7594711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7872c871b0431b72df6350dd0394bea?s=128&d=identicon&r=PG&f=1", "display_name": "SoronelHaetir", "link": "https://stackoverflow.com/users/7594711/soronelhaetir"}, "is_accepted": false, "score": 4, "last_activity_date": 1516137261, "last_edit_date": 1516137261, "creation_date": 1516135155, "answer_id": 48289474, "question_id": 48289442, "link": "https://stackoverflow.com/questions/48289442/c-reading-negative-numbers-with-scanf/48289474#48289474", "title": "c: reading negative numbers with scanf()", "body": "<p>Use the <code>%d</code> specifier instead of <code>%u</code>, %u expects unsigned values only.</p>\n"}], "owner": {"reputation": 11, "user_id": 9174661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9b7178e1365aa357d8b9735c0148f71?s=128&d=identicon&r=PG&f=1", "display_name": "book", "link": "https://stackoverflow.com/users/9174661/book"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4058, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1516137261, "creation_date": 1516134999, "question_id": 48289442, "link": "https://stackoverflow.com/questions/48289442/c-reading-negative-numbers-with-scanf", "title": "c: reading negative numbers with scanf()", "body": "<p>I'm trying to read a list of input integers with scanf() separated by spaces into an array, but it breaks every time there's a negative number passed. How do I get it to read negative numbers as well? </p>\n\n<pre><code>for (int i = 0; scanf(\"%u\", &amp;val)==1; i++)\n</code></pre>\n\n<p>stdin: </p>\n\n<pre><code>1 2 -4 5\n</code></pre>\n\n<p>It will only put 1 and 2 into the array and then stop reading the rest of the numbers (I think because of the '-'?). How would I fix this? </p>\n"}, {"tags": ["c", "linux", "bash", "shell"], "comments": [{"owner": {"reputation": 2841, "user_id": 2545194, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ab05c442f50628acfcca2c70174f23e7?s=128&d=identicon&r=PG", "display_name": "Jdamian", "link": "https://stackoverflow.com/users/2545194/jdamian"}, "edited": false, "score": 0, "creation_date": 1516133895, "post_id": 48289135, "comment_id": 83563260, "body": "What does this question have to do with <code>bash</code>?"}, {"owner": {"reputation": 11, "user_id": 8978954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83c9a95f89b9e7909deb8e0a0bc2ec74?s=128&d=identicon&r=PG&f=1", "display_name": "John Smith", "link": "https://stackoverflow.com/users/8978954/john-smith"}, "reply_to_user": {"reputation": 2841, "user_id": 2545194, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ab05c442f50628acfcca2c70174f23e7?s=128&d=identicon&r=PG", "display_name": "Jdamian", "link": "https://stackoverflow.com/users/2545194/jdamian"}, "edited": false, "score": 0, "creation_date": 1516133995, "post_id": 48289135, "comment_id": 83563314, "body": "I&#39;m a beginner, I don&#39;t understand a lot of things, so I don&#39;t know what my problem is related to... so sorry if it doesn&#39;t have anything to do with bash."}, {"owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "edited": false, "score": 0, "creation_date": 1516134004, "post_id": 48289135, "comment_id": 83563320, "body": "What are the permissions of <code>shell.c</code> and the current directory? Who&#39;s their owner and are you logged in as that user? Does <code>shell</code> already exist and, if so, what are its permissions and owner? When you say that have &quot;already tried to use chmod or sudo&quot;, what exactly have you tried?"}, {"owner": {"reputation": 32078, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 0, "creation_date": 1516134034, "post_id": 48289135, "comment_id": 83563337, "body": "maybe <code>shell</code> is still running and therefore file is locked? You should also start using version control systems such as mercurial to avoid &quot;deleted days of work by accident&quot;."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 2, "creation_date": 1516134276, "post_id": 48289135, "comment_id": 83563435, "body": "Step 1: <b>Install a version control system</b> so you can check in your work as you go and any disasters are short-term, you can just pull down your code if you ever mess up or revert if you ever break it too badly to fix it."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1516134511, "post_id": 48289135, "comment_id": 83563537, "body": "(a) Copy the entire command and output and paste it into your question. (b) Check whether <code>shell</code> exists; execute <code>file shell</code> and <code>ls -ld shell</code>. (Consider that it might be a directory, not a regular file.) (c) Create a new file <code>x.c</code> and try <code>gcc -o x x.c</code> and report the results. (d) If (c) fails, try that in a different directory."}, {"owner": {"reputation": 11, "user_id": 8978954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83c9a95f89b9e7909deb8e0a0bc2ec74?s=128&d=identicon&r=PG&f=1", "display_name": "John Smith", "link": "https://stackoverflow.com/users/8978954/john-smith"}, "edited": false, "score": 0, "creation_date": 1516134563, "post_id": 48289135, "comment_id": 83563558, "body": "Well, shell.c is made directly in codeblocks and saved, so I guess it has normal permissions. The folder is C:\\Users\\Clevo\\AppData\\Local\\lxss\\home\\user... i don&#39;t know the permissions of it, but I guess it&#39;s ok if i could copy in it. I tried chmod u+x filename.c and the equivalent with sudo. Shell is not still running. Thanks for the advice to prevent disasters :D"}, {"owner": {"reputation": 11, "user_id": 8978954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83c9a95f89b9e7909deb8e0a0bc2ec74?s=128&d=identicon&r=PG&f=1", "display_name": "John Smith", "link": "https://stackoverflow.com/users/8978954/john-smith"}, "edited": false, "score": 0, "creation_date": 1516134910, "post_id": 48289135, "comment_id": 83563717, "body": "tried everything at (a)... shell does not exist, just the shell.c i put there. I tried with x.c and it works... it compiles a simple hello world program without any problem. But that was made in shell with nano, if I make it outside the shell, in codeblocks, I get the same error."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 2, "creation_date": 1516135363, "post_id": 48289135, "comment_id": 83563956, "body": "Try <code>gcc -o x shell.c</code>. If that works, try <code>mv x shell</code>."}, {"owner": {"reputation": 11, "user_id": 8978954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83c9a95f89b9e7909deb8e0a0bc2ec74?s=128&d=identicon&r=PG&f=1", "display_name": "John Smith", "link": "https://stackoverflow.com/users/8978954/john-smith"}, "edited": false, "score": 0, "creation_date": 1516135661, "post_id": 48289135, "comment_id": 83564113, "body": "nevermind... I found a solution with this... I tried to modify the permissions of the file with sudo, but I didn&#39;t try to compile it with sudo, that worked, and now the shell is created and I can run it with ./shell command... Thank you all for your time."}, {"owner": {"reputation": 233489, "user_id": 14122, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5e2861b08f37fa306fbf5384994af688?s=128&d=identicon&r=PG", "display_name": "Charles Duffy", "link": "https://stackoverflow.com/users/14122/charles-duffy"}, "edited": false, "score": 3, "creation_date": 1516137015, "post_id": 48289135, "comment_id": 83564768, "body": "Using sudo to compile <i>anything</i> is a bad idea. Instead, you should fix permissions such that you don&#39;t <i>need</i> sudo to access your own files."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1516137117, "post_id": 48289135, "comment_id": 83564817, "body": "You should only need to use <code>sudo</code> to install your final fully debugged (for now\u2014 until you find the next bug) shell. Until then, you should be inning the compiler and the shell-under-debug as an ordinary user and not use elevated privileges (<code>sudo</code>) at all."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 2, "creation_date": 1516137241, "post_id": 48289135, "comment_id": 83564855, "body": "Don&#39;t put the solution in the question, it should be posted as an answer. But you shouldn&#39;t need to use <code>sudo</code> to compile files in your own directory."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1516140431, "post_id": 48289135, "comment_id": 83566255, "body": "Hang on, did you literally type <code>gcc -o shell shell.c,</code> <i>with the comma</i>?"}, {"owner": {"reputation": 11, "user_id": 8978954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83c9a95f89b9e7909deb8e0a0bc2ec74?s=128&d=identicon&r=PG&f=1", "display_name": "John Smith", "link": "https://stackoverflow.com/users/8978954/john-smith"}, "reply_to_user": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1516143382, "post_id": 48289135, "comment_id": 83567369, "body": "@zwol no, no comma"}, {"owner": {"reputation": 11, "user_id": 8978954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83c9a95f89b9e7909deb8e0a0bc2ec74?s=128&d=identicon&r=PG&f=1", "display_name": "John Smith", "link": "https://stackoverflow.com/users/8978954/john-smith"}, "reply_to_user": {"reputation": 233489, "user_id": 14122, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5e2861b08f37fa306fbf5384994af688?s=128&d=identicon&r=PG", "display_name": "Charles Duffy", "link": "https://stackoverflow.com/users/14122/charles-duffy"}, "edited": false, "score": 0, "creation_date": 1516143553, "post_id": 48289135, "comment_id": 83567421, "body": "@Charles Duffy I guess it&#39;s not the best solution, but I really needed it to work, because I had to test it and submit it an hour ago for a school project, so I was low on time and any solution was good. I still don&#39;t know what I should do for it to work without sudo, if anyone has an idea, I would be grateful!"}, {"owner": {"reputation": 233489, "user_id": 14122, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5e2861b08f37fa306fbf5384994af688?s=128&d=identicon&r=PG", "display_name": "Charles Duffy", "link": "https://stackoverflow.com/users/14122/charles-duffy"}, "edited": false, "score": 0, "creation_date": 1516145163, "post_id": 48289135, "comment_id": 83567910, "body": "You&#39;d need to provide more details. Editing the output of <code>ls -ld . shell.c shell</code> into the question would be a place to start."}, {"owner": {"reputation": 11, "user_id": 8978954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83c9a95f89b9e7909deb8e0a0bc2ec74?s=128&d=identicon&r=PG&f=1", "display_name": "John Smith", "link": "https://stackoverflow.com/users/8978954/john-smith"}, "reply_to_user": {"reputation": 233489, "user_id": 14122, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5e2861b08f37fa306fbf5384994af688?s=128&d=identicon&r=PG", "display_name": "Charles Duffy", "link": "https://stackoverflow.com/users/14122/charles-duffy"}, "edited": false, "score": 0, "creation_date": 1516148204, "post_id": 48289135, "comment_id": 83568733, "body": "@CharlesDuffy done"}, {"owner": {"reputation": 233489, "user_id": 14122, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5e2861b08f37fa306fbf5384994af688?s=128&d=identicon&r=PG", "display_name": "Charles Duffy", "link": "https://stackoverflow.com/users/14122/charles-duffy"}, "edited": false, "score": 1, "creation_date": 1516153465, "post_id": 48289135, "comment_id": 83570093, "body": "So, there are two problems here. One is that <code>root</code> owns the output file; the other is that absolutely nobody has permission to read the input file (except root, which is exempt from the permission system). The easy answer is to just delete the output file, and to fix permissions on the input file with something like <code>chmod 644 shell.c</code> (no <code>sudo</code> needed)."}, {"owner": {"reputation": 233489, "user_id": 14122, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5e2861b08f37fa306fbf5384994af688?s=128&d=identicon&r=PG", "display_name": "Charles Duffy", "link": "https://stackoverflow.com/users/14122/charles-duffy"}, "edited": false, "score": 0, "creation_date": 1516153548, "post_id": 48289135, "comment_id": 83570108, "body": "(and btw, as Barmar said -- don&#39;t edit solutions into questions; instead, use the button to add an answer to add an answer as a separate item. It&#39;s only when you&#39;ve accepted an answer that your question will be marked solved)."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1516153750, "post_id": 48289135, "comment_id": 83570151, "body": "@JohnSmith I have revised my answer in light of the new information you have given us."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 1, "creation_date": 1516156503, "post_id": 48289135, "comment_id": 83570684, "body": "The problem isn&#39;t the difference between &quot;Permission&quot; and &quot;permission&quot;. The problem is that the actual error message almost certainly referred to <code>shell.c</code>, but the version of that message in the question omitted that information. It&#39;s the difference between &quot;<code>cc1: fatal error: Permission denied</code>&quot; and <code>&quot;cc1: fatal error: shell.c: Permission denied&quot;</code>."}, {"owner": {"reputation": 11, "user_id": 8978954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83c9a95f89b9e7909deb8e0a0bc2ec74?s=128&d=identicon&r=PG&f=1", "display_name": "John Smith", "link": "https://stackoverflow.com/users/8978954/john-smith"}, "reply_to_user": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1516156959, "post_id": 48289135, "comment_id": 83570766, "body": "@KeithThompson yeah, I have deleted my comment, I&#39;m too tired, I saw it way too late, sorry"}, {"owner": {"reputation": 233489, "user_id": 14122, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5e2861b08f37fa306fbf5384994af688?s=128&d=identicon&r=PG", "display_name": "Charles Duffy", "link": "https://stackoverflow.com/users/14122/charles-duffy"}, "edited": false, "score": 0, "creation_date": 1516244604, "post_id": 48289135, "comment_id": 83612175, "body": "BTW, with respect to using &quot;Codeblocks&quot; or other native Windows applications to edit files -- see the official Microsoft blog article titled <a href=\"https://blogs.msdn.microsoft.com/commandline/2016/11/17/do-not-change-linux-files-using-windows-apps-and-tools/\" rel=\"nofollow noreferrer\">Do not change Linux files using Windows apps or tools</a>."}, {"owner": {"reputation": 11, "user_id": 8978954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83c9a95f89b9e7909deb8e0a0bc2ec74?s=128&d=identicon&r=PG&f=1", "display_name": "John Smith", "link": "https://stackoverflow.com/users/8978954/john-smith"}, "reply_to_user": {"reputation": 233489, "user_id": 14122, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5e2861b08f37fa306fbf5384994af688?s=128&d=identicon&r=PG", "display_name": "Charles Duffy", "link": "https://stackoverflow.com/users/14122/charles-duffy"}, "edited": false, "score": 0, "creation_date": 1516458023, "post_id": 48289135, "comment_id": 83700971, "body": "@CharlesDuffy thank you!"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 8978954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83c9a95f89b9e7909deb8e0a0bc2ec74?s=128&d=identicon&r=PG&f=1", "display_name": "John Smith", "link": "https://stackoverflow.com/users/8978954/john-smith"}, "edited": false, "score": 0, "creation_date": 1516135053, "post_id": 48289314, "comment_id": 83563796, "body": "What is strange is that with other programms made in shell with nano it works. But, with programms made in codeblocks and then copied in that directory, those don&#39;t work."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1516135461, "post_id": 48289314, "comment_id": 83564017, "body": "OP has since reported that <code>gcc -o x x.c</code> works. So the compiler installation is not outright broken. That makes me wonder if there is some bug where it internally attempts to execute some <code>shell</code> command, which fails if there is a <code>shell</code> file in the current directory."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1516137291, "post_id": 48289314, "comment_id": 83564872, "body": "I think the problem is simply that the output file <code>shell</code> was owned by <code>root</code>, so he couldn&#39;t write to it."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1516137585, "post_id": 48289314, "comment_id": 83564984, "body": "@Barmar Inability to write to the output file should have produced a different error message."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1516137739, "post_id": 48289314, "comment_id": 83565058, "body": "You&#39;re right. When I try that on my Mac, I get &quot;ld: can&#39;t write output file&quot;."}, {"owner": {"reputation": 233489, "user_id": 14122, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5e2861b08f37fa306fbf5384994af688?s=128&d=identicon&r=PG", "display_name": "Charles Duffy", "link": "https://stackoverflow.com/users/14122/charles-duffy"}, "edited": false, "score": 0, "creation_date": 1516154416, "post_id": 48289314, "comment_id": 83570281, "body": "Shouldn&#39;t need <code>sudo rm</code> -- if you own the directory, you can delete files no matter who owns them."}, {"owner": {"reputation": 11, "user_id": 8978954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83c9a95f89b9e7909deb8e0a0bc2ec74?s=128&d=identicon&r=PG&f=1", "display_name": "John Smith", "link": "https://stackoverflow.com/users/8978954/john-smith"}, "edited": false, "score": 0, "creation_date": 1516155090, "post_id": 48289314, "comment_id": 83570411, "body": "Thank you, it worked! I&#39;m sorry, I&#39;m a beginner, I did not realise the difference from p to P is so big. And yes, indeed, my codeblocks editor is a native Windows program."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1516156138, "post_id": 48289314, "comment_id": 83570623, "body": "... uh, the important difference is that one of them says &quot;shell.c&quot; in it and the other doesn&#39;t ..."}, {"owner": {"reputation": 11, "user_id": 8978954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83c9a95f89b9e7909deb8e0a0bc2ec74?s=128&d=identicon&r=PG&f=1", "display_name": "John Smith", "link": "https://stackoverflow.com/users/8978954/john-smith"}, "edited": false, "score": 0, "creation_date": 1516156656, "post_id": 48289314, "comment_id": 83570713, "body": "Pff, I&#39;m blind... I&#39;m sorry, haven&#39;t sleeped in a while, got a lot of projects... I was so sure that shell.c was not in there, but indeed it was, even when I read it from the terminal... I&#39;m really sorry I wasted your time. Thank you for your help!"}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "reply_to_user": {"reputation": 11, "user_id": 8978954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83c9a95f89b9e7909deb8e0a0bc2ec74?s=128&d=identicon&r=PG&f=1", "display_name": "John Smith", "link": "https://stackoverflow.com/users/8978954/john-smith"}, "edited": false, "score": 0, "creation_date": 1516157196, "post_id": 48289314, "comment_id": 83570817, "body": "@JohnSmith You didn&#39;t waste my time. You provided an ideal jumping-off point for me to write an answer about why it&#39;s so important to read every word of an error message."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "reply_to_user": {"reputation": 11, "user_id": 8978954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83c9a95f89b9e7909deb8e0a0bc2ec74?s=128&d=identicon&r=PG&f=1", "display_name": "John Smith", "link": "https://stackoverflow.com/users/8978954/john-smith"}, "edited": false, "score": 1, "creation_date": 1516157380, "post_id": 48289314, "comment_id": 83570862, "body": "@JohnSmith Also, a word of friendly advice from someone who was once a sleep-deprived student himself: get more sleep! It has been scientifically proven that a full eight hours of sleep every night will help your grades <i>more</i> than any extra homework/study time you gain by not sleeping."}, {"owner": {"reputation": 11, "user_id": 8978954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83c9a95f89b9e7909deb8e0a0bc2ec74?s=128&d=identicon&r=PG&f=1", "display_name": "John Smith", "link": "https://stackoverflow.com/users/8978954/john-smith"}, "edited": false, "score": 0, "creation_date": 1516157541, "post_id": 48289314, "comment_id": 83570894, "body": "Thank you! I will try :D"}], "tags": [], "owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "is_accepted": true, "score": 2, "last_activity_date": 1516157136, "last_edit_date": 1516157136, "creation_date": 1516134563, "answer_id": 48289314, "question_id": 48289135, "link": "https://stackoverflow.com/questions/48289135/permission-denied-when-trying-to-compile-own-shell-in-linux-what-can-i-do/48289314#48289314", "title": "Permission denied when trying to compile own shell in linux, what can I do?", "body": "<pre><code>cc1: fatal error: permission denied\n</code></pre>\n\n<p>Are you <em>certain</em> that this is the exact text of the error message?  Could it have instead been this?</p>\n\n<pre><code>cc1: fatal error: shell.c: permission denied\n</code></pre>\n\n<p>Every single word counts in Unix-style error messages.  The error message you <em>said</em> you got doesn't refer to <code>shell.c</code> at all.  It seems to be reporting a permissions problem affecting <code>cc1</code>, which is an internal component of the compiler, which is why the previous version of this answer said \"your installation of GCC is broken\".  But if that were your problem, you would not be able to compile <em>anything</em>, and you say you can compile other things besides <code>shell.c</code>.</p>\n\n<p>The modified error message, on the other hand, is reporting a permissions problem <em>detected</em> by <code>cc1</code> but <em>affecting</em> <code>shell.c</code>, which is consistent with the claim that only <code>shell.c</code> can't be compiled, and is also consistent with your <code>ls</code> output:</p>\n\n<pre><code>---------- 1 Lightning Lightning 17310 Jan 16 23:35 shell.c\n</code></pre>\n\n<p>That leading string of dashes stands for access \"mode\" 000, which means \"cannot be read, written, or executed by <em>anyone</em>, except <code>root</code>.\"  (One of <code>root</code>'s many privileges is that it bypasses all access controls.)</p>\n\n<p>If this is indeed your problem, running the commands</p>\n\n<pre><code>chmod 644 shell.c\nsudo rm -f shell\n</code></pre>\n\n<p>from the directory containing <code>shell.c</code> should make a subsequent <code>gcc shell.c -o shell</code> work.  These commands deserve a little explanation: <code>chmod</code> is the Unix command to change access permissions. <code>chmod 644</code> sets the permissions to <code>-rw-r--r--</code> (read and write by owning user, read-only by all others), which is almost always the right set of permissions for ordinary files.  (You can also say <code>chmod u=rw,go=r shell.c</code>, but once you get a little practice with them, you will find the octal permissions easier to read and write!)  It's also necessary to delete <code>shell</code>, as <code>root</code>, because currently <code>root</code> owns that file and the compiler running as an ordinary user won't be allowed to overwrite it.</p>\n\n<p>The remaining question is: how on earth did your <code>shell.c</code> get its mode set to 000 in the first place?  That is an extremely bizarre thing to have happen.  My best guess would be that your \"codeblocks\" editor is a native Windows program instead of a Ubuntu-for-Windows program and it isn't interacting properly with the nested Unix environment, but there are several other possibilities, and I don't think I can help you any further.</p>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 8978954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83c9a95f89b9e7909deb8e0a0bc2ec74?s=128&d=identicon&r=PG&f=1", "display_name": "John Smith", "link": "https://stackoverflow.com/users/8978954/john-smith"}, "edited": false, "score": 0, "creation_date": 1516150716, "post_id": 48291938, "comment_id": 83569409, "body": "I understand that sudo should not be used, but the thing is I did not used sudo before and I got that error. I used sudo to solve that problem! I did not get the error after I used sudo. And like I said in some comments, simple <code>gcc shell.c</code> is not working... the problem is not with the shell file..."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 11, "user_id": 8978954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83c9a95f89b9e7909deb8e0a0bc2ec74?s=128&d=identicon&r=PG&f=1", "display_name": "John Smith", "link": "https://stackoverflow.com/users/8978954/john-smith"}, "edited": false, "score": 0, "creation_date": 1516151160, "post_id": 48291938, "comment_id": 83569522, "body": "@JohnSmith: Then you haven&#39;t given us enough information to solve the problem. The <code>ls -ld</code> output you show us is clearly from <i>after</i> you tried the <code>sudo</code> command. Using <code>sudo</code> likely didn&#39;t solve your problem, it just worked around it. If <code>gcc -o shell shell.c</code> gave you a &quot;permission denied&quot; error, then you probably had a file named <code>shell</code> that you didn&#39;t have permission to overwrite. If you had that problem before using <code>sudo</code>, then there&#39;s no way for us to tell how it happened."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 11, "user_id": 8978954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83c9a95f89b9e7909deb8e0a0bc2ec74?s=128&d=identicon&r=PG&f=1", "display_name": "John Smith", "link": "https://stackoverflow.com/users/8978954/john-smith"}, "edited": false, "score": 0, "creation_date": 1516151162, "post_id": 48291938, "comment_id": 83569525, "body": "Try removing the <code>shell</code> file (<code>sudo rm shell</code>) rerun the <code>ls</code> command, then run <code>gcc -o shell shell.c</code>. If that fails, show us the output of the <code>ls</code> and <code>gcc</code> commands."}, {"owner": {"reputation": 11, "user_id": 8978954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83c9a95f89b9e7909deb8e0a0bc2ec74?s=128&d=identicon&r=PG&f=1", "display_name": "John Smith", "link": "https://stackoverflow.com/users/8978954/john-smith"}, "edited": false, "score": 0, "creation_date": 1516151514, "post_id": 48291938, "comment_id": 83569623, "body": "If the problem is with the shell file... why <code>gcc shell.c</code> still gives me that error? It should work and I should be able to run it with <code>.&#47;a.out</code>."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 11, "user_id": 8978954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83c9a95f89b9e7909deb8e0a0bc2ec74?s=128&d=identicon&r=PG&f=1", "display_name": "John Smith", "link": "https://stackoverflow.com/users/8978954/john-smith"}, "edited": false, "score": 0, "creation_date": 1516152827, "post_id": 48291938, "comment_id": 83569940, "body": "@JohnSmith: I don&#39;t know. Maybe you also have an existing <code>a.out</code> file in that directory? Please try what I asked you to try."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 11, "user_id": 8978954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83c9a95f89b9e7909deb8e0a0bc2ec74?s=128&d=identicon&r=PG&f=1", "display_name": "John Smith", "link": "https://stackoverflow.com/users/8978954/john-smith"}, "edited": false, "score": 1, "creation_date": 1516154356, "post_id": 48291938, "comment_id": 83570268, "body": "@JohnSmith: I see from more recent comments that I missed something critical in your <code>ls</code> output. Your <code>shell.c</code> file has <code>000</code> permissions, so nothing can read it. As somebody else mentioned, the compiler error message would have referred to the name of the input file. <b>Always</b> copy-and-paste error messages. A seemingly minor omission like this can lead everyone on a wild goose chase. If we had seen &quot;<code>cc1: fatal error: shell.c: Permission denied</code>&quot;, we could probably have answered your question much sooner."}], "tags": [], "owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "is_accepted": false, "score": 0, "last_activity_date": 1516154435, "last_edit_date": 1516154435, "creation_date": 1516149015, "answer_id": 48291938, "question_id": 48289135, "link": "https://stackoverflow.com/questions/48289135/permission-denied-when-trying-to-compile-own-shell-in-linux-what-can-i-do/48291938#48291938", "title": "Permission denied when trying to compile own shell in linux, what can I do?", "body": "<p><strong>UPDATE</strong>: My answer was based on incomplete information. I believe <a href=\"https://stackoverflow.com/a/48289314/827263\">zwol's answer</a> is the correct one.</p>\n\n<p>When you made the mistake of running:</p>\n\n<pre><code>sudo gcc -o shell shell.c\n</code></pre>\n\n<p>it created an executable file named <code>shell</code>, owned by <code>root</code>. When you then tried again without the <code>sudo</code> command:</p>\n\n<pre><code>gcc -o shell shell.c\n</code></pre>\n\n<p>it tried to overwrite the <code>shell</code> executable file, but it failed because you don't have permission to clobber a file owned by <code>root</code>. (Permissions are more complex than that, but that's the general idea.)</p>\n\n<p>Don't use <code>sudo</code> to compile. In general, don't use <code>sudo</code>, or root access of any kind, to do anything that doesn't actually need to be done by the <code>root</code> account. (You might need to use <code>sudo</code> to <em>install</em> something to a location outside your home directory tree.)</p>\n"}, {"comments": [{"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1516149074, "post_id": 48291940, "comment_id": 83568977, "body": "<code>chmod 777</code> is overkill; it allows any user on the system to modify the file. Just don&#39;t compile as root."}, {"owner": {"reputation": 11, "user_id": 8978954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83c9a95f89b9e7909deb8e0a0bc2ec74?s=128&d=identicon&r=PG&f=1", "display_name": "John Smith", "link": "https://stackoverflow.com/users/8978954/john-smith"}, "edited": false, "score": 0, "creation_date": 1516149618, "post_id": 48291940, "comment_id": 83569099, "body": "even if shell does not exist I still can&#39;t compile, I mean, even if I write <code>gcc shell.c</code> it still won&#39;t let me do it..."}, {"owner": {"reputation": 185, "user_id": 674044, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/0ca2fe5e9b9c98836f7ae38029838bc9?s=128&d=identicon&r=PG", "display_name": "Ryan", "link": "https://stackoverflow.com/users/674044/ryan"}, "edited": false, "score": 0, "creation_date": 1516150537, "post_id": 48291940, "comment_id": 83569354, "body": "(I can&#39;t seem to figure out how to format a block of text as code; apologies) It seems you would get a different error message, at least with <code>gcc</code> v6.3.0: <code>&#47;usr&#47;bin&#47;ld: cannot open output file shell: Permission denied</code> <code>collect2: error: ld returned 1 exit status</code>"}, {"owner": {"reputation": 11, "user_id": 8978954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83c9a95f89b9e7909deb8e0a0bc2ec74?s=128&d=identicon&r=PG&f=1", "display_name": "John Smith", "link": "https://stackoverflow.com/users/8978954/john-smith"}, "edited": false, "score": 0, "creation_date": 1516150739, "post_id": 48291940, "comment_id": 83569415, "body": "Yes, I get the same error... and I don&#39;t mean the one in your second message, I don&#39;t get that..."}], "tags": [], "owner": {"reputation": 185, "user_id": 674044, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/0ca2fe5e9b9c98836f7ae38029838bc9?s=128&d=identicon&r=PG", "display_name": "Ryan", "link": "https://stackoverflow.com/users/674044/ryan"}, "is_accepted": false, "score": 0, "last_activity_date": 1516149025, "creation_date": 1516149025, "answer_id": 48291940, "question_id": 48289135, "link": "https://stackoverflow.com/questions/48289135/permission-denied-when-trying-to-compile-own-shell-in-linux-what-can-i-do/48291940#48291940", "title": "Permission denied when trying to compile own shell in linux, what can I do?", "body": "<p>With you given command line option of <code>-o shell</code>, you are indicating that you want gcc to store the built output in a file named <code>shell</code>. From your directory listing, this file is owned by the owner.group combination <code>root.root</code>, and only the user <code>root</code> has write permissions to that file.</p>\n\n<p>Assuming you are running <code>gcc</code> as the user <code>Lightning</code> (the owner of <code>shell.c</code>), then the error message is understandable: <code>gcc</code> does not have permission to overwrite the output file you've specified.</p>\n\n<p>As a workaround, you should be able to specify a different output file such as <code>shell2</code> via <code>gcc -o shell2 shell.c</code> and it should produce the executable file <code>shell2</code>.</p>\n\n<p>A longer term solution if you really want the executable to be named <code>shell</code> would be to delete the file <code>shell</code> or change its permissions such that other users can write to it (<code>chmod 777 shell</code>); either of these operations must be performed as the user <code>root</code>.</p>\n"}], "owner": {"reputation": 11, "user_id": 8978954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83c9a95f89b9e7909deb8e0a0bc2ec74?s=128&d=identicon&r=PG&f=1", "display_name": "John Smith", "link": "https://stackoverflow.com/users/8978954/john-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7602, "favorite_count": 0, "accepted_answer_id": 48289314, "answer_count": 3, "score": -2, "last_activity_date": 1516157136, "creation_date": 1516133773, "last_edit_date": 1516156717, "question_id": 48289135, "link": "https://stackoverflow.com/questions/48289135/permission-denied-when-trying-to-compile-own-shell-in-linux-what-can-i-do", "title": "Permission denied when trying to compile own shell in linux, what can I do?", "body": "<p>I know this question was asked before, but I already tried to use chmod or sudo and it's still not working. So the thing is this:</p>\n\n<p>I have bash on ubuntu on windows installed on my windows 10. I wrote my own shell in terminal but I did something wrong and deleted days of work by accident... So to be sure I started and wrote it again in codeblocks and just copied the c file in the directory so that i can see the file when i do the command ls.</p>\n\n<p>The problem is when I try to do this: </p>\n\n<pre><code>gcc -o shell shell.c\n</code></pre>\n\n<p>I get </p>\n\n<blockquote>\n  <p>cc1: fatal error: shell.c: Permission denied</p>\n</blockquote>\n\n<p>What can I do?</p>\n\n<p>When I type <code>ls -ld . shell.c shell</code> I get: </p>\n\n<pre><code>drwxr-xr-x 0 Lightning Lightning   512 Jan 16 23:35 .\n-rwxr-xr-x 1 root      root      19576 Jan 16 23:35 shell\n---------- 1 Lightning Lightning 17310 Jan 16 23:35 shell.c\n</code></pre>\n\n<p>And to clarify as a lot of you understand that I used sudo and that the shell file is the problem. It is not! Sudo solved my problem (I understand that it's not the best solution, that's why I'm trying to find another one), but I had the problem before I used sudo. And when I use the code:</p>\n\n<pre><code> gcc shell.c\n</code></pre>\n\n<p>I still get permission denied!</p>\n"}, {"tags": ["c", "struct", "initialization", "designated-initializer"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 4, "creation_date": 1516132770, "post_id": 48288853, "comment_id": 83562737, "body": "This is a pure undefined behavior. There is no sequence point between the fields initialization and the order of initialization is not defined. And seriously, I hope not to encounter such a code in my life."}], "answers": [{"comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1516135830, "post_id": 48288958, "comment_id": 83564208, "body": "And C2011 contains equivalent provisions at <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.7.9p23\" rel=\"nofollow noreferrer\">6.7.9/23</a> and footnote 152."}], "tags": [], "owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "is_accepted": true, "score": 10, "last_activity_date": 1516132921, "creation_date": 1516132921, "answer_id": 48288958, "question_id": 48288853, "link": "https://stackoverflow.com/questions/48288853/esoteric-c-designated-initializer-failure-compiler-bug-or-feature/48288958#48288958", "title": "esoteric C designated initializer failure, compiler bug or feature?", "body": "<p>C99 standard allows side effects to be applied in any order:</p>\n\n<blockquote>\n  <p>6.7.8.23: The order in which any side effects occur among the initialization list expressions is unspecified.</p>\n</blockquote>\n\n<p>A footnote provides further clarification:</p>\n\n<blockquote>\n  <p>In particular, the evaluation order need not be the same as the order of subobject initialization.</p>\n</blockquote>\n"}], "owner": {"reputation": 45, "user_id": 3630480, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8dd6eb4d9939610687c334b13a5e3e25?s=128&d=identicon&r=PG&f=1", "display_name": "Burt Wagner", "link": "https://stackoverflow.com/users/3630480/burt-wagner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 1, "accepted_answer_id": 48288958, "answer_count": 1, "score": 4, "last_activity_date": 1516132921, "creation_date": 1516132443, "last_edit_date": 1516132644, "question_id": 48288853, "link": "https://stackoverflow.com/questions/48288853/esoteric-c-designated-initializer-failure-compiler-bug-or-feature", "title": "esoteric C designated initializer failure, compiler bug or feature?", "body": "<p>I just spent until about 1AM tracking down a bug in my code and what I found really surprised me.  The actual code is very complex involving unions of structures containing unions of structures, etc. but I have distilled the issue down to the following simplified failing case.</p>\n\n<p>What is happening is that the compiler [gcc 5.4.0] is changing the order of the execution of the designated initializers to match the order they appear in the structure.  This does not cause any issues as long as you are initializing the structure with constants or variables that have no order dependency.  Check out this following code.  It shows that the compiler clearly reorders the designated initializers:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\ntypedef const struct {\n    const size_t First_setToOne;\n    const size_t Second_setToThree;\n    const size_t Third_setToTwo;\n    const size_t Fourth_setToFour;\n} MyConstStruct;\n\nstatic void Broken(void)\n{\n    size_t i = 0;\n\n    const MyConstStruct myConstStruct = {\n        .First_setToOne     = ++i,\n        .Third_setToTwo     = ++i,\n        .Second_setToThree  = ++i,\n        .Fourth_setToFour   = ++i,\n    };\n\n    printf(\"\\nBroken:\\n\");\n    printf(\"First_setToOne    should be 1, is %zd\\n\", myConstStruct.First_setToOne   );\n    printf(\"Second_setToThree should be 3, is %zd\\n\", myConstStruct.Second_setToThree);\n    printf(\"Third_setToTwo    should be 2, is %zd\\n\", myConstStruct.Third_setToTwo   );\n    printf(\"Fourth_setToFour  should be 4, is %zd\\n\", myConstStruct.Fourth_setToFour );\n}\n\nstatic void Fixed(void)\n{\n    size_t i = 0;\n\n    const size_t First_setToOne     = ++i;\n    const size_t Third_setToTwo     = ++i;\n    const size_t Second_setToThree  = ++i;\n    const size_t Fourth_setToFour   = ++i;\n\n    const MyConstStruct myConstStruct = {\n        .First_setToOne     = First_setToOne   ,\n        .Third_setToTwo     = Third_setToTwo   ,\n        .Second_setToThree  = Second_setToThree,\n        .Fourth_setToFour   = Fourth_setToFour ,\n    };\n\n    printf(\"\\nFixed:\\n\");\n    printf(\"First_setToOne    should be 1, is %zd\\n\", myConstStruct.First_setToOne   );\n    printf(\"Second_setToThree should be 3, is %zd\\n\", myConstStruct.Second_setToThree);\n    printf(\"Third_setToTwo    should be 2, is %zd\\n\", myConstStruct.Third_setToTwo   );\n    printf(\"Fourth_setToFour  should be 4, is %zd\\n\", myConstStruct.Fourth_setToFour );\n}\n\nint main (int argc, char *argv[])\n{\n    (void)argc;\n    (void)argv;\n\n    Broken();\n    Fixed();\n\n    return(0);\n}\n</code></pre>\n\n<p>The output is as follows:</p>\n\n<pre><code>Broken:\nFirst_setToOne    should be 1, is 1\nSecond_setToThree should be 3, is 2\nThird_setToTwo    should be 2, is 3\nFourth_setToFour  should be 4, is 4\n\nFixed:\nFirst_setToOne    should be 1, is 1\nSecond_setToThree should be 3, is 3\nThird_setToTwo    should be 2, is 2\nFourth_setToFour  should be 4, is 4\n</code></pre>\n\n<p>I suspected the optimizer but I tried the same code using every possible optimization level and the reordering still occurs.  So this issue is in the base compiler.</p>\n\n<p>I have a solution so this is more of a warning for others and a general question.</p>\n\n<p>Has anyone else ever see or noticed this issue?</p>\n\n<p>Is this the expected/specified behavior?</p>\n"}, {"tags": ["c", "ascii", "sdl", "sdl-2"], "comments": [{"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 0, "creation_date": 1516131273, "post_id": 48288527, "comment_id": 83561962, "body": "Sounds good to me, just do it?"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 2, "creation_date": 1516131276, "post_id": 48288527, "comment_id": 83561964, "body": "Your proposal sounds quite adequate. Asking how to do it is however too broad. In my opinion (probably not objective, do not worry) ASCII art implies more finesse than replacing pixels by ASCII with different &quot;gray values&quot;. But do implement a program which acts as described. If you get stuck with a specific problem describe that and you will most likely find people happily helping you. Oh, and welcome to StackOverflow! Take the <a href=\"https://stackoverflow.com/tour\">tour</a> at your leisure."}, {"owner": {"reputation": 1, "user_id": 9226055, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13f9ec762aa2904556eb75d0ee946ad4?s=128&d=identicon&r=PG&f=1", "display_name": "Rosca Radu", "link": "https://stackoverflow.com/users/9226055/rosca-radu"}, "edited": false, "score": 0, "creation_date": 1516131553, "post_id": 48288527, "comment_id": 83562093, "body": "Thank you very much for the help and for the warm welcome . I will do my best!"}, {"owner": {"reputation": 509, "user_id": 8857328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a43855efb44db02b57d0f7253394882?s=128&d=identicon&r=PG&f=1", "display_name": "VladP", "link": "https://stackoverflow.com/users/8857328/vladp"}, "edited": false, "score": 0, "creation_date": 1516142486, "post_id": 48288527, "comment_id": 83567051, "body": "There have been some questions like this: <a href=\"https://stackoverflow.com/questions/394882/how-do-ascii-art-image-conversion-algorithms-work\" title=\"how do ascii art image conversion algorithms work\">stackoverflow.com/questions/394882/&hellip;</a>. Basically, you have to group greyed pixels into blocks and each block should be replaced by the symbol. Mapping of blocks to symbol is more complicated."}, {"owner": {"reputation": 2449, "user_id": 500276, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/200bf76976f24add540182f5c3a42788?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Benningfield", "link": "https://stackoverflow.com/users/500276/mark-benningfield"}, "edited": false, "score": 0, "creation_date": 1516149764, "post_id": 48288527, "comment_id": 83569136, "body": "If there are no restrictions from your instructor regarding ASCII character mapping, I would just try it with several different maps and see which one looked the best."}, {"owner": {"reputation": 1, "user_id": 9226055, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13f9ec762aa2904556eb75d0ee946ad4?s=128&d=identicon&r=PG&f=1", "display_name": "Rosca Radu", "link": "https://stackoverflow.com/users/9226055/rosca-radu"}, "edited": false, "score": 0, "creation_date": 1516156787, "post_id": 48288527, "comment_id": 83570738, "body": "I have changed all the pixels in the picture with a character of approximate intensity and added them in a 2D Char array . Now im trying to find a way of outputting the values on a text file or render them down on a image. Plus I&#39;ll try to raise the area that im calculating the intensity on the image to the size of the mono spaced font I&#39;m using so i don&#39;t have to print out thousands of symbols but (widthofimage/widthoffont)*(heightofimage/heightoffont) which is smaller and keeps the proportions of the image. Problem is I have no clue on how to do that."}], "answers": [{"tags": [], "owner": {"reputation": 64564, "user_id": 302139, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1ea13e6d50c94ba30296c4e5326e1634?s=128&d=identicon&r=PG", "display_name": "Edwin Buck", "link": "https://stackoverflow.com/users/302139/edwin-buck"}, "is_accepted": false, "score": 0, "last_activity_date": 1516208397, "creation_date": 1516208397, "answer_id": 48306332, "question_id": 48288527, "link": "https://stackoverflow.com/questions/48288527/image-to-ascii-art-using-sdl/48306332#48306332", "title": "Image to ASCII-art using SDL?", "body": "<p>You need to dissect your image into areas that have the same horizontal and vertical proportions as a fixed-width character.  Let's call this dimension a \"cell\".</p>\n\n<p>You will also need a map of each character, but rendered as an image into the same \"cell\". </p>\n\n<p>Then you will need to do a fuzzy match of the cell of the image to the character cells.  The one that matches most closely is selected for the output.  There are multiple ways of matching things, and this gets related to AI visual research.</p>\n\n<p>The most powerful techniques detect edges, and reduce the complexity of the image to permit a better line representation of the image before attempting a character match.  This is because the best ascii art is more aligned to line art, rather than photo type art.</p>\n"}], "owner": {"reputation": 1, "user_id": 9226055, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13f9ec762aa2904556eb75d0ee946ad4?s=128&d=identicon&r=PG&f=1", "display_name": "Rosca Radu", "link": "https://stackoverflow.com/users/9226055/rosca-radu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 205, "favorite_count": 1, "answer_count": 1, "score": -1, "last_activity_date": 1516208397, "creation_date": 1516131015, "last_edit_date": 1516207167, "question_id": 48288527, "link": "https://stackoverflow.com/questions/48288527/image-to-ascii-art-using-sdl", "title": "Image to ASCII-art using SDL?", "body": "<p>I need to make a program in C using SDL2 that converts images to ASCII art.  I uploaded the image in the program, raised the contrast a bit and turned it into grayscale.</p>\n\n<p>What should I do now? Should I create an array with a few ASCII characters (.+xo0%@#) ranging in \"Intensity\" then replace the pixels with the characters of similar intensity?</p>\n"}, {"tags": ["c", "regex", "gtk", "glib", "gtktreeview"], "answers": [{"tags": [], "owner": {"reputation": 4022, "user_id": 2931197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31e3379958588750196bc49f6925ab62?s=128&d=identicon&r=PG&f=1", "display_name": "Philip Withnall", "link": "https://stackoverflow.com/users/2931197/philip-withnall"}, "is_accepted": true, "score": 1, "last_activity_date": 1516133944, "creation_date": 1516133944, "answer_id": 48289166, "question_id": 48288265, "link": "https://stackoverflow.com/questions/48288265/markup-matches-and-escape-special-characters-outside-the-matches-at-the-same-tim/48289166#48289166", "title": "Markup matches and escape special characters outside the matches at the same time", "body": "<p>Probably the way to do this is to not use <code>g_regex_replace_eval()</code>, but rather to use <code>g_regex_match_all()</code> to get the list of matches for a string. Then you need to step through the string character-by-character (do this using the <code>g_utf8_*()</code> functions, since this has to be Unicode-aware). If you get to a character which needs to be escaped (<code>&lt;</code>, <code>&gt;</code>, <code>&amp;</code>, <code>\"</code>, <code>'</code>), output the escaped entity for it. When you get to a match position, output the correct markup for it.</p>\n"}, {"comments": [{"owner": {"reputation": 609, "user_id": 1874373, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/2b5e19800ac8954500ecdcc5a46971f9?s=128&d=identicon&r=PG&f=1", "display_name": "GTK 1.2.6 fanboy", "link": "https://stackoverflow.com/users/1874373/gtk-1-2-6-fanboy"}, "edited": false, "score": 0, "creation_date": 1516186281, "post_id": 48297684, "comment_id": 83583039, "body": "I had thought about that, too, but the problem seems to me that <code>father &amp; mother</code> will have been converted to <code>father &amp;amp; mother</code> when <code>g_regex_replace_eval</code> is called, and a search on the letter &#39;a&#39; will then also match the &#39;a&#39; in <code>&amp;amp;</code>."}, {"owner": {"reputation": 10263, "user_id": 518853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IjKPw.png?s=128&g=1", "display_name": "liberforce", "link": "https://stackoverflow.com/users/518853/liberforce"}, "reply_to_user": {"reputation": 609, "user_id": 1874373, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/2b5e19800ac8954500ecdcc5a46971f9?s=128&d=identicon&r=PG&f=1", "display_name": "GTK 1.2.6 fanboy", "link": "https://stackoverflow.com/users/1874373/gtk-1-2-6-fanboy"}, "edited": false, "score": 0, "creation_date": 1516195001, "post_id": 48297684, "comment_id": 83588619, "body": "Then maybe you could additionnaly modify the regexp so it won&#39;t match text inside entities?"}, {"owner": {"reputation": 609, "user_id": 1874373, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/2b5e19800ac8954500ecdcc5a46971f9?s=128&d=identicon&r=PG&f=1", "display_name": "GTK 1.2.6 fanboy", "link": "https://stackoverflow.com/users/1874373/gtk-1-2-6-fanboy"}, "edited": false, "score": 0, "creation_date": 1516205899, "post_id": 48297684, "comment_id": 83596112, "body": "Yes, modifying the regexp was something I had in mind, too. Philip&#39;s suggestion above seems to involve less fumbling and to be a more clean solution, even if it means some work to implement this. I&#39;ll keep the modified regexp as a kind of fallback option in mind, though."}], "tags": [], "owner": {"reputation": 10263, "user_id": 518853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IjKPw.png?s=128&g=1", "display_name": "liberforce", "link": "https://stackoverflow.com/users/518853/liberforce"}, "is_accepted": false, "score": 0, "last_activity_date": 1516181425, "creation_date": 1516181425, "answer_id": 48297684, "question_id": 48288265, "link": "https://stackoverflow.com/questions/48288265/markup-matches-and-escape-special-characters-outside-the-matches-at-the-same-tim/48297684#48297684", "title": "Markup matches and escape special characters outside the matches at the same time", "body": "<p>I'd escape the whole text first using <code>g_markup_escape_text</code>, then escape the text to search and use it in <code>g_regex_replace_eval</code>. This way escaped text can be matched, and text not matched is already escaped.</p>\n"}], "owner": {"reputation": 609, "user_id": 1874373, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/2b5e19800ac8954500ecdcc5a46971f9?s=128&d=identicon&r=PG&f=1", "display_name": "GTK 1.2.6 fanboy", "link": "https://stackoverflow.com/users/1874373/gtk-1-2-6-fanboy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 354, "favorite_count": 0, "accepted_answer_id": 48289166, "answer_count": 2, "score": 1, "last_activity_date": 1610311915, "creation_date": 1516129867, "last_edit_date": 1610311915, "question_id": 48288265, "link": "https://stackoverflow.com/questions/48288265/markup-matches-and-escape-special-characters-outside-the-matches-at-the-same-tim", "title": "Markup matches and escape special characters outside the matches at the same time", "body": "<p>I have a search functionality for a treeview that highlights all matches, incl. distinction between caseless and case-sensitive, as well as distinction between regular expression and literal. However, I have a problem when the current cell contains special characters that are not part of the matches. Consider the following text inside a treeview cell:</p>\n<pre><code>father &amp; mother\n</code></pre>\n<p>Now I want to do for example a search on the whole treeview for the letter 'e'. For highlighting the matches only and not the whole cell, I need to use markup. To achieve this, I use <code>g_regex_replace_eval</code> and its callback function <a href=\"https://developer.gnome.org/glib/stable/glib-Perl-compatible-regular-expressions.html#g-regex-replace-eval\" rel=\"nofollow noreferrer\">in the way as stated inside the GLib documentation</a>. The resulting new marked up text for the cell would be like this:</p>\n<pre><code>fath&lt;span background='yellow' foreground='black'&gt;e&lt;/span&gt;r &amp; \nmoth&lt;span background='yellow' foreground='black'&gt;e&lt;/span&gt;r\n</code></pre>\n<p>If there are special characters inside the matches, they are escaped before being added to the hashtable that is used by the eval function. So special characters <strong>inside</strong> matches are no problem.</p>\n<p>But I have the '&amp;' now <strong>outside</strong> the markup parts, and it has to be changed to <code>&amp;amp;</code>, otherwise the markup won't show up in the cell and a warning</p>\n<pre><code>Failed to set text from markup due to error parsing markup: Error on line x: Entity did not end with a semicolon; most likely you used an ampersand character without intending to start an entity - escape ampersand as &amp;\n</code></pre>\n<p>will be shown inside the terminal.</p>\n<p>If I use <code>g_markup_escape_text</code> on the new cell text, it will obviously not only escape the '&amp;', but also the '&lt;' and '&gt;' of the markup, so this is no solution.</p>\n<p>Is there a reasonable way to put markup around the matches and escape special characters outside the markup at the same time or with a view steps? Everything I could imagine so far is much too complicated, if it would work at all.</p>\n<p>Even though I had already considered Philip's suggestion in most of its parts before asking my question, I had not touched yet the subject of utf8, so he gave an important hint for the solution. The following is the core of a working implementation:</p>\n<pre><code>gchar *counter_char = original_cell_txt; // counter_char will move through all the characters of original_cell_txt.\ngint counter;\n\ngunichar unichar;\ngchar utf8_char[6]; // Six bytes is the buffer size needed later by g_unichar_to_utf8 (). \ngint utf8_length;\ngchar *utf8_escaped;\n\nenum { START_POS, END_POS };\nGArray *positions[2];\npositions[START_POS] = g_array_new (FALSE, FALSE, sizeof (gint));\npositions[END_POS] = g_array_new (FALSE, FALSE, sizeof (gint));\ngint start_position, end_position;\n\ntxt_with_markup = g_string_new (&quot;&quot;);    \n\ng_regex_match (regex, original_cell_txt, 0, &amp;match_info);\n\nwhile (g_match_info_matches (match_info)) {\n    g_match_info_fetch_pos (match_info, 0, &amp;start_position, &amp;end_position);\n    g_array_append_val (positions[START_POS], start_position);\n    g_array_append_val (positions[END_POS], end_position);\n    g_match_info_next (match_info, NULL);\n}\n\ndo {\n    unichar = g_utf8_get_char (counter_char);\n    counter = counter_char - original_cell_txt; // pointer arithmetic\n\n    if (counter == g_array_index (positions[END_POS], gint, 0)) {\n        txt_with_markup = g_string_append (txt_with_markup, &quot;&lt;/span&gt;&quot;);\n        // It's simpler to always access the first element instead of looping through the whole array.\n        g_array_remove_index (positions[END_POS], 0);\n     }\n     /*\n         No &quot;else if&quot; is used here, since if there is a search for a single character going on and  \n         such a character appears double as 'm' in &quot;command&quot;, between both m's a span tag has to be \n         closed and opened at the same position.\n     */\n     if (counter == g_array_index (positions[START_POS], gint, 0)) {\n         txt_with_markup = g_string_append (txt_with_markup, &quot;&lt;span background='yellow' foreground='black'&gt;&quot;);\n         // See the comment for the similar instruction above.\n         g_array_remove_index (positions[START_POS], 0);\n     }\n\n     utf8_length = g_unichar_to_utf8 (unichar, utf8_char);\n     /*\n         Instead of using a switch statement to check whether the current character needs to be escaped, \n         for simplicity the character is sent to the escape function regardless of whether there will be \n         any escaping done by it or not.\n     */\n     utf8_escaped = g_markup_escape_text (utf8_char, utf8_length);\n\n     txt_with_markup = g_string_append (txt_with_markup, utf8_escaped);\n\n     // Cleanup\n     g_free (utf8_escaped);\n\n     counter_char = g_utf8_find_next_char (counter_char, NULL);\n} while (*counter_char != '\\0');\n\n/*\n    There is a '&lt;/span&gt;' to set at the end; because the end position is one position after the string size\n    this couldn't be done inside the preceding loop.\n*/            \nif (positions[END_POS]-&gt;len) {\n    g_string_append (txt_with_markup, &quot;&lt;/span&gt;&quot;);\n}\n\ng_object_set (txt_renderer, &quot;markup&quot;, txt_with_markup-&gt;str, NULL);\n\n// Cleanup\ng_regex_unref (regex);\ng_match_info_free (match_info);\ng_array_free (positions[START_POS], TRUE);\ng_array_free (positions[END_POS], TRUE);\n</code></pre>\n"}, {"tags": ["c", "null-pointer"], "comments": [{"owner": {"reputation": 25744, "user_id": 2089675, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/sBz5q.jpg?s=128&g=1", "display_name": "smac89", "link": "https://stackoverflow.com/users/2089675/smac89"}, "edited": false, "score": 1, "creation_date": 1516129682, "post_id": 48288191, "comment_id": 83561203, "body": "Pointers point to memory address. 0 is a valid invalid memory address"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1516129763, "post_id": 48288191, "comment_id": 83561246, "body": "&quot;it is possible to assign an integer 0 to a pointer&quot; Yes for <i>object</i> pointers. Uncertain about function pointers - they have some different rules."}, {"owner": {"reputation": 54296, "user_id": 128397, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/22b05e50077230ba919b240af4bc13cd?s=128&d=identicon&r=PG", "display_name": "Daniel Pryden", "link": "https://stackoverflow.com/users/128397/daniel-pryden"}, "edited": false, "score": 0, "creation_date": 1516129863, "post_id": 48288191, "comment_id": 83561284, "body": "Doesn&#39;t the standard say that a literal of <code>0</code>, when converted into a pointer, must be converted into the bit pattern that represents a null pointer, whatever its representation on the platform may be? This implies that a function like <code>malloc</code> could return you a pointer to address zero, but you couldn&#39;t make one yourself with the <code>0</code> literal."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1516129908, "post_id": 48288191, "comment_id": 83561301, "body": "&quot;from the beginning&quot; --&gt; do you mean C89 or pre-standard? (Fairly wild back then)"}, {"owner": {"reputation": 54296, "user_id": 128397, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/22b05e50077230ba919b240af4bc13cd?s=128&d=identicon&r=PG", "display_name": "Daniel Pryden", "link": "https://stackoverflow.com/users/128397/daniel-pryden"}, "edited": false, "score": 2, "creation_date": 1516129957, "post_id": 48288191, "comment_id": 83561324, "body": "In practice on any modern hardware and OS I know of, the page of memory starting at address 0 is intentionally unmapped in the MMU so that any attempt to dereference a pointer there will always generate a page fault, which will generally get mapped into a fatal error at the OS level."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 54296, "user_id": 128397, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/22b05e50077230ba919b240af4bc13cd?s=128&d=identicon&r=PG", "display_name": "Daniel Pryden", "link": "https://stackoverflow.com/users/128397/daniel-pryden"}, "edited": false, "score": 1, "creation_date": 1516129970, "post_id": 48288191, "comment_id": 83561334, "body": "@DanielPryden Minor: Standard does not call <code>0</code> a <i>literal</i>, but a <i>constant</i>"}, {"owner": {"reputation": 25744, "user_id": 2089675, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/sBz5q.jpg?s=128&g=1", "display_name": "smac89", "link": "https://stackoverflow.com/users/2089675/smac89"}, "edited": false, "score": 0, "creation_date": 1516130005, "post_id": 48288191, "comment_id": 83561350, "body": "<a href=\"https://github.com/gcc-mirror/gcc/blob/master/gcc/ginclude/stddef.h#L405\" rel=\"nofollow noreferrer\">github.com/gcc-mirror/gcc/blob/master/gcc/ginclude/&hellip;</a>. In C, GCC defines <code>NULL</code> as <code>0</code>"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1516130367, "post_id": 48288191, "comment_id": 83561533, "body": "Reopened because this question clearly asks for history, not definition or clarification of the differences between <code>NULL</code> and a zero constant expression. Please do not mark questions as duplicates unless they are actual duplicates. Overlapping subject matter does not make a duplicate."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 54296, "user_id": 128397, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/22b05e50077230ba919b240af4bc13cd?s=128&d=identicon&r=PG", "display_name": "Daniel Pryden", "link": "https://stackoverflow.com/users/128397/daniel-pryden"}, "edited": false, "score": 2, "creation_date": 1516130800, "post_id": 48288191, "comment_id": 83561757, "body": "@DanielPryden: Modern OSes mark address 0 unmapped in <b>user space</b>. That is not necessarily so in <b>kernel space</b>. And C supports \u201cfreestanding environments\u201d (special circumstances) as well as \u201chosted environments\u201d (normal user programs). I know that memory being mapped at zero has been a problem for some kernel code. Address zero is not used for any C object, so it satisfies the rules that a null pointer be distinguishable from a pointer to a valid object, but it means that incorrect dereferencing of a null pointer does not crash, making some bugs hard to find."}], "answers": [{"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1516130070, "post_id": 48288292, "comment_id": 83561382, "body": "Good answer to the main question. Your thoughts on &quot;Has this been a feature of C from the beginning or was it relaxed&quot;?"}, {"owner": {"reputation": 8002, "user_id": 1143850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2927fac544c9960cd5433688fe4cae1d?s=128&d=identicon&r=PG", "display_name": "Serge", "link": "https://stackoverflow.com/users/1143850/serge"}, "edited": false, "score": 1, "creation_date": 1516130581, "post_id": 48288292, "comment_id": 83561642, "body": "it was not an advertised feature of &#39;c&#39;, at least in early versions. Though it worked in majority of cases. There fore NULL was defined to make it completely portable."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 8002, "user_id": 1143850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2927fac544c9960cd5433688fe4cae1d?s=128&d=identicon&r=PG", "display_name": "Serge", "link": "https://stackoverflow.com/users/1143850/serge"}, "edited": false, "score": 1, "creation_date": 1516131640, "post_id": 48288292, "comment_id": 83562131, "body": "@Serge: What makes you think it was not a feature of early versions of C? How early? It seems to have been in <a href=\"http://port70.net/~nsz/c/c89/c89-draft.html#3.2.2.3\" rel=\"nofollow noreferrer\">C 1989</a> and, per my answer, in K&amp;R 1978."}, {"owner": {"reputation": 8002, "user_id": 1143850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2927fac544c9960cd5433688fe4cae1d?s=128&d=identicon&r=PG", "display_name": "Serge", "link": "https://stackoverflow.com/users/1143850/serge"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1516136464, "post_id": 48288292, "comment_id": 83564519, "body": "@EricPostpischil this was my recollection. As far as i remember there were some platforms where NULL was not defined to be <code>(void*)0</code>."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 8002, "user_id": 1143850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2927fac544c9960cd5433688fe4cae1d?s=128&d=identicon&r=PG", "display_name": "Serge", "link": "https://stackoverflow.com/users/1143850/serge"}, "edited": false, "score": 0, "creation_date": 1516142111, "post_id": 48288292, "comment_id": 83566919, "body": "@Serge  The definition of <code>NULL</code> is not relevant to &quot;is possible to assign an integer 0 to a pointer&quot;  <code>NULL</code> may differ <i>numerically</i> and/or <i>type</i> from <code>0</code> (per your and mine memory) yet both <code>ptr1 = 0; ptr2 = NULL;</code> assigned a <i>null pointer</i>.  The <i>null pointers</i> assigned may have different bit patterns, but they compare equally as pointers."}], "tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 4, "last_activity_date": 1516129971, "creation_date": 1516129971, "answer_id": 48288292, "question_id": 48288191, "link": "https://stackoverflow.com/questions/48288191/assigning-0-vs-null-to-a-pointer-in-c/48288292#48288292", "title": "Assigning 0 vs NULL to a pointer in C", "body": "<p>According to the C Standard (6.3.2.3 Pointers)</p>\n\n<blockquote>\n  <p>3 <strong>An integer constant expression with the value 0</strong>, or such an\n  expression cast to type void *, <strong>is called a null pointer\n  constant</strong>.66) If a null pointer constant is converted to a pointer\n  type, the resulting pointer, called a null pointer, is guaranteed to\n  compare unequal to a pointer to any object or function.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": false, "score": 7, "last_activity_date": 1516130494, "creation_date": 1516130494, "answer_id": 48288405, "question_id": 48288191, "link": "https://stackoverflow.com/questions/48288191/assigning-0-vs-null-to-a-pointer-in-c/48288405#48288405", "title": "Assigning 0 vs NULL to a pointer in C", "body": "<p>Per <em>The C Programming Language</em> by Kernighan and Ritchie, 1978, page 192:</p>\n\n<blockquote>\n  <p>However, it is guaranteed that assignment of the constant 0 to a pointer will produce a null pointer distinguishable from a pointer to any object.</p>\n</blockquote>\n\n<p>I cannot speak to the history before that.</p>\n"}, {"tags": [], "owner": {"reputation": 37256, "user_id": 736308, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/o5EqQ.jpg?s=128&g=1", "display_name": "cdarke", "link": "https://stackoverflow.com/users/736308/cdarke"}, "is_accepted": false, "score": 0, "last_activity_date": 1516134198, "creation_date": 1516134198, "answer_id": 48289228, "question_id": 48288191, "link": "https://stackoverflow.com/questions/48288191/assigning-0-vs-null-to-a-pointer-in-c/48289228#48289228", "title": "Assigning 0 vs NULL to a pointer in C", "body": "<p>In K&amp;R first edition (pre-ANSI), page 97-98 we have some example code with:</p>\n\n<pre><code>#define NULL 0 /* pointer value for error report */\n</code></pre>\n\n<p><em>\"C guarantees that no pointer that validly points at data will contain \nzero, so a return value of zero can be used to signal an abnormal event...  We write NULL instead of zero, however, to indicate more clearly that this is a special value for a pointer. In general, integers cannot meaningfully be assigned to pointers.\"</em></p>\n\n<p>Clearly here <code>0</code>, and therefore <code>NULL</code>, is not typed as a pointer but an <code>int</code>.  It's worth noting that <code>void *</code> was not introduced until edition 2 (ANSI).</p>\n"}], "owner": {"reputation": 55, "user_id": 6562673, "user_type": "registered", "profile_image": "https://graph.facebook.com/1217384428272212/picture?type=large", "display_name": "Douglas Quaid", "link": "https://stackoverflow.com/users/6562673/douglas-quaid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1455, "favorite_count": 1, "answer_count": 3, "score": 1, "last_activity_date": 1516134198, "creation_date": 1516129559, "question_id": 48288191, "link": "https://stackoverflow.com/questions/48288191/assigning-0-vs-null-to-a-pointer-in-c", "title": "Assigning 0 vs NULL to a pointer in C", "body": "<p>I wondered today about that it is possible to assign an integer 0 to a pointer, i.e. doing the same like assigning NULL. Until today I assumed, this was new with C++. Has this been a feature of C from the beginning or was it relaxed with a more recent language-standard?</p>\n"}]