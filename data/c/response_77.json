[{"tags": ["ruby-on-rails", "c", "ruby", "windows"], "comments": [{"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 1, "creation_date": 1467247000, "post_id": 38111894, "comment_id": 63657936, "body": "see <a href=\"http://stackoverflow.com/questions/32751824/how-do-i-install-byebug-for-ruby-on-windows\">how-do-i-install-byebug-for-ruby-on-windows</a>"}], "answers": [{"tags": [], "owner": {"reputation": 12705, "user_id": 483040, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Ux8AH.jpg?s=128&g=1", "display_name": "jaydel", "link": "https://stackoverflow.com/users/483040/jaydel"}, "is_accepted": false, "score": 0, "last_activity_date": 1467290198, "last_edit_date": 1495540348, "creation_date": 1467290198, "answer_id": 38123314, "question_id": 38111894, "link": "https://stackoverflow.com/questions/38111894/error-message-make-sure-that-gem-install-debug-inspector-v-0-0-2-succeeds/38123314#38123314", "title": "Error message: Make sure that `gem install debug_inspector -v &#39;0.0.2&#39;` succeeds before bundling", "body": "<p>When you see the message:</p>\n\n<pre><code>Gem::Ext::BuildError: ERROR: Failed to build gem native extension.\n</code></pre>\n\n<p>it is likely that the native extensions cannot be built because some missing system library issue, or even your version of the Ruby/DevKit.</p>\n\n<p>I am unfamiliar with Ruby on Windows, having made the switch to OSX when I first started working with Rails.</p>\n\n<p>In your case I found a similar <a href=\"https://stackoverflow.com/questions/26601184/gemextbuilderror-error-failed-to-build-gem-native-extension-bcrypt-ruby\">question</a> that <em>might</em> help you. </p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6529934"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 410, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1467290198, "creation_date": 1467244385, "question_id": 38111894, "link": "https://stackoverflow.com/questions/38111894/error-message-make-sure-that-gem-install-debug-inspector-v-0-0-2-succeeds", "title": "Error message: Make sure that `gem install debug_inspector -v &#39;0.0.2&#39;` succeeds before bundling", "body": "<p>I am new to programming, and I have begun the process of installing Ruby on Rails. I have just tried creating my first project. \n  However I am getting the message in the title whenever I try to bundle install in my project. I am using Windows.</p>\n\n<p><strong>When i attempt bundle install</strong></p>\n\n<pre><code>Installing byebug 9.0.5 with native extensions\n\nGem::Ext::BuildError: ERROR: Failed to build gem native extension.\n\n    current directory: C:/Ruby23/lib/ruby/gems/2.3.0/gems/byebug-9.0.5/ext/byebug\nC:/Ruby23/bin/ruby.exe -r ./siteconf20160630-6484-1le1k81.rb extconf.rb\ncreating Makefile\n\ncurrent directory: C:/Ruby23/lib/ruby/gems/2.3.0/gems/byebug-9.0.5/ext/byebug\nmake \"DESTDIR=\" clean\n\ncurrent directory: C:/Ruby23/lib/ruby/gems/2.3.0/gems/byebug-9.0.5/ext/byebug\nmake \"DESTDIR=\"\ngenerating byebug-i386-mingw32.def\ncompiling breakpoint.c\nIn file included from c:/Ruby23/include/ruby-2.3.0/ruby.h:33:0,\n                 from byebug.h:4,\n                 from breakpoint.c:1:\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:124:14: error: size of array 'ruby_check_sizeof_voidp' is negative\nIn file included from c:/Ruby23/include/ruby-2.3.0/ruby.h:33:0,\n                 from byebug.h:4,\n                 from breakpoint.c:1:\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h: In function 'rb_obj_freeze_inline':\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:1353:9: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:1354:2: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:1355:6: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:1355:27: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h: In function 'rb_data_object_get':\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:1393:13: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h: In function 'rb_data_object_make':\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:1407:5: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h: In function 'rb_data_typed_object_make':\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:1414:5: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h: In function 'rb_num2char_inline':\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:1580:9: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:1580:9: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:1580:9: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:1580:41: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:1580:41: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:1580:41: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:1581:9: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:1581:9: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:1581:9: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h: In function 'rb_class_of':\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:1942:12: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h: In function 'rb_type':\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:1959:12: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nIn file included from c:/Ruby23/include/ruby-2.3.0/ruby.h:33:0,\n                 from byebug.h:4,\n                 from breakpoint.c:1:\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h: In function 'rb_clone_setup':\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:1990:56: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:1991:33: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:1992:9: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:1992:9: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h: In function 'rb_dup_setup':\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:1998:42: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:1999:9: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:1999:9: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h: In function 'rb_array_len':\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:2005:13: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:2006:2: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:2006:24: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h: In function 'rb_array_const_ptr':\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:2020:12: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:2020:12: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:2020:12: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h: In function 'rb_struct_len':\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:2027:13: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:2028:2: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:2028:26: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h: In function 'rb_struct_const_ptr':\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:2034:12: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:2034:12: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nc:/Ruby23/include/ruby-2.3.0/ruby/ruby.h:2034:12: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nbreakpoint.c: In function 'filename_cmp_impl':\nbreakpoint.c:288:11: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nbreakpoint.c:288:11: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nbreakpoint.c:288:11: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nbreakpoint.c:292:16: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nbreakpoint.c:292:16: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nbreakpoint.c:292:16: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nbreakpoint.c: In function 'find_breakpoint_by_pos':\nbreakpoint.c:458:10: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nbreakpoint.c:458:10: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nbreakpoint.c:458:10: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]\nmake: *** [breakpoint.o] Error 1\n\nmake failed, exit code 2\n\nGem files will remain installed in C:/Ruby23/lib/ruby/gems/2.3.0/gems/byebug-9.0.5 for inspection.\nResults logged to C:/Ruby23/lib/ruby/gems/2.3.0/extensions/x86-mingw32/2.3.0/byebug-9.0.5/gem_make.out\nUsing coffee-script-source 1.10.0\nUsing execjs 2.7.0\nUsing thor 0.19.1\nUsing concurrent-ruby 1.0.2\nUsing multi_json 1.12.1\nUsing mysql2 0.4.4\nUsing sass 3.4.22\nUsing tilt 2.0.5\nUsing rdoc 4.2.2\nUsing tzinfo 1.2.2\nUsing nokogiri 1.6.8\nUsing rack-test 0.6.3\nUsing mime-types 3.1\nAn error occurred while installing debug_inspector (0.0.2), and Bundler cannot\ncontinue.\nMake sure that `gem install debug_inspector -v '0.0.2'` succeeds before\nbundling.\n</code></pre>\n\n<p><strong>When i attempt installing debug_inspector</strong></p>\n\n<pre><code>C:\\Users\\User\\Documents\\Sites&gt;gem install debug_inspector\nTemporarily enhancing PATH to include DevKit...\nBuilding native extensions.  This could take a while...\nERROR:  Error installing debug_inspector:\n    ERROR: Failed to build gem native extension.\n</code></pre>\n\n<p>Sorry if I made any mistakes posting this. Thanks!</p>\n"}, {"tags": ["c", "windows-10", "codeblocks", "ncurses"], "comments": [{"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 0, "creation_date": 1467247647, "post_id": 38111856, "comment_id": 63658098, "body": "Have you tried compiling with MinGW ? (Code Blocks is an IDE not a compiler)"}], "answers": [{"tags": [], "owner": {"reputation": 45838, "user_id": 1362568, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/EAFi0.jpg?s=128&g=1", "display_name": "Mike Kinghan", "link": "https://stackoverflow.com/users/1362568/mike-kinghan"}, "is_accepted": true, "score": 2, "last_activity_date": 1467312978, "creation_date": 1467312978, "answer_id": 38131197, "question_id": 38111856, "link": "https://stackoverflow.com/questions/38111856/how-to-download-add-ncurses-to-codeblocks-16-01-ide-for-windows-10/38131197#38131197", "title": "How to download , add NCurses to Code::Blocks 16.01 IDE for Windows 10", "body": "<p><a href=\"https://en.wikipedia.org/wiki/Ncurses\" rel=\"nofollow\"><code>ncurses</code></a> is a text-based graphics library for C that is\nsupported on unix-like OSes, not on Windows. So you can use\nit if you're writing C on a unix-like OS (such as Linux). Your choice of IDE doesn't matter.</p>\n\n<p>On Windows, you could use it under a unix-like environment such as <a href=\"https://www.cygwin.com/\" rel=\"nofollow\">Cygwin</a>\nor <a href=\"https://sourceforge.net/projects/msys2/\" rel=\"nofollow\">MSYS2</a>, but you would hardly want to\ngo to that length <em>merely</em> for the sake of writing <code>ncurses</code> programs.</p>\n\n<p>There is a very similar library, <a href=\"http://pdcurses.sourceforge.net/\" rel=\"nofollow\">PDCurses</a>\nthat is supported on Windows, and also a <a href=\"http://www.projectpluto.com/win32a.htm\" rel=\"nofollow\">Project Pluto fork of PDCurses</a>\nThe first of those provides a <a href=\"https://sourceforge.net/projects/pdcurses/files/\" rel=\"nofollow\">binary distibution</a>,\nbut it dates from 2008. In both cases, there are links to GitHub repositories hosting\nthe latest source code, from which you may build the library yourself, following the instructions you will find in the project's <code>README.md</code> file. </p>\n"}], "owner": {"reputation": 9150, "user_id": 6365112, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5U4o6.png?s=128&g=1", "display_name": "Yahya", "link": "https://stackoverflow.com/users/6365112/yahya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4500, "favorite_count": 0, "accepted_answer_id": 38131197, "answer_count": 1, "score": 2, "last_activity_date": 1508845309, "creation_date": 1467244130, "last_edit_date": 1508845309, "question_id": 38111856, "link": "https://stackoverflow.com/questions/38111856/how-to-download-add-ncurses-to-codeblocks-16-01-ide-for-windows-10", "title": "How to download , add NCurses to Code::Blocks 16.01 IDE for Windows 10", "body": "<p>I cannot find <code>NCurses</code> for my <strong>Code::Blocks</strong> 16.01 IDE for Windows 10.\nI found <a href=\"http://invisible-island.net/ncurses/\" rel=\"nofollow noreferrer\">this</a> , but did not know how to use it even I tried to link it in the linker setting in <strong>Code::Blocks</strong>. Also I don't know if it's suitable for Windows or it's specifically for Linux.</p>\n"}, {"tags": ["c", "openssl", "bignum"], "answers": [{"tags": [], "owner": {"reputation": 5562, "user_id": 1946679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed74e2cdc59d058b76a76c90dd3c3bdc?s=128&d=identicon&r=PG", "display_name": "Matt Caswell", "link": "https://stackoverflow.com/users/1946679/matt-caswell"}, "is_accepted": true, "score": 1, "last_activity_date": 1467282706, "last_edit_date": 1467282706, "creation_date": 1467278454, "answer_id": 38118854, "question_id": 38111293, "link": "https://stackoverflow.com/questions/38111293/define-a-constant-bignum-in-openssl/38118854#38118854", "title": "Define a constant BIGNUM in OpenSSL", "body": "<p>Yes and no.</p>\n\n<p>In OpenSSL 1.0.2/1.0.1 this is possible (caveat: code completely untested!)</p>\n\n<pre><code>/*\n * I made up the numbers...too lazy to figure out what the real ones are!\n * Note that, the BN_ULONG values here are in little endian form,\n * so this represents:\n * D3FBF564FEB008A3\n */\n#if BN_BITS2 == 64\nstatic const BN_ULONG data[] = {\n    0xA308B0FE64F5FBD3ULL\n};\n#else\nstatic const BN_ULONG data[] = {\n    0x64F5FBD3, 0xA308B0FE\n};\n#endif\n\nstatic const BIGNUM threshold = {\n    (BN_ULONG *) data,\n    sizeof(data)/sizeof(BN_ULONG),\n    sizeof(data)/sizeof(BN_ULONG),\n    0,\n    BN_FLG_STATIC_DATA\n};\n</code></pre>\n\n<p>In OpenSSL 1.1.0 (not yet released) things are not so easy. For very good reasons the BIGNUM structure has been made opaque so you can no longer statically initialise the data.</p>\n\n<p>You <em>can</em> do something like this:</p>\n\n<pre><code>static CRYPTO_ONCE threshold_once = CRYPTO_ONCE_STATIC_INIT;\nstatic BIGNUM *threshold = NULL;\n\nstatic void thresholdcleanup(void)\n{\n    BN_free(threshold);\n}\nstatic void thresholdinit(void)\n{\n    threshold = BN_new();\n    /* Do stuff to set threshold to the right value */\n    OPENSSL_atexit(thresholdcleanup);\n}\n\nstatic void my_func(void)\n{\n    CRYPTO_THREAD_run_once(&amp;threshold_once, threshholdinit);\n\n    /* Use threshold here */\n}\n</code></pre>\n"}], "owner": {"reputation": 722, "user_id": 4854062, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/8ef4517def80967a55df56522c17789c?s=128&d=identicon&r=PG&f=1", "display_name": "sava", "link": "https://stackoverflow.com/users/4854062/sava"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 755, "favorite_count": 0, "accepted_answer_id": 38118854, "answer_count": 1, "score": 1, "last_activity_date": 1467282706, "creation_date": 1467240622, "last_edit_date": 1467242720, "question_id": 38111293, "link": "https://stackoverflow.com/questions/38111293/define-a-constant-bignum-in-openssl", "title": "Define a constant BIGNUM in OpenSSL", "body": "<p>Is there a way to define a constant of type BIGNUM* and value <code>2^512</code> in C that would be the equivalent of Java: </p>\n\n<pre><code>private static final BigInteger THRESHOLD = BigInteger.valueOf(2).pow(512);\n</code></pre>\n\n<p>In a local scope I achieve this by doing the following:</p>\n\n<pre><code>BN_CTX *ctx = BN_CTX_new();\n\nBIGNUM *two = BN_new();\nBN_set_word(two, 2);\n\nBIGNUM *pow = BN_new();\nBN_set_word(pow, 512);\n\nBIGNUM * threshold = BN_new();\nBN_exp(threshold, two, pow, ctx);\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 2, "creation_date": 1467240325, "post_id": 38111229, "comment_id": 63656037, "body": "You didn&#39;t assign anything to <code>stats[7]</code> though"}, {"owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "edited": false, "score": 0, "creation_date": 1467240363, "post_id": 38111229, "comment_id": 63656048, "body": "Please show the rest of your program, you are probably populating a different <code>stats</code> array, or whatever you populate gets out of scope."}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 1, "creation_date": 1467240400, "post_id": 38111229, "comment_id": 63656065, "body": "Post all the code including the declaration of <code>stats</code>, otherwise there is no point to anyone else speculating about it."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1467240453, "post_id": 38111229, "comment_id": 63656087, "body": "Given that <code>rand()</code> cannot return negative values, the <code>abs()</code> call only makes sense in the somewhat unintuitive case where <code>max</code> is negative."}, {"owner": {"reputation": 871, "user_id": 4304844, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vSjQh.jpg?s=128&g=1", "display_name": "tsandy", "link": "https://stackoverflow.com/users/4304844/tsandy"}, "edited": false, "score": 2, "creation_date": 1467240650, "post_id": 38111229, "comment_id": 63656153, "body": "The format specifier <code>%d</code> only works if the <code>stats[0]</code> values are <code>int</code>s. If they&#39;re declared as a different type, the table <a href=\"http://en.cppreference.com/w/cpp/io/c/fprintf\" rel=\"nofollow noreferrer\">here</a> explains which one to use."}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 0, "creation_date": 1467240687, "post_id": 38111229, "comment_id": 63656168, "body": "Did your class advise to loop until <code>counter &lt; lastElement</code> and writing <code>counter = counter + 1</code>? The former misses out an element, and the latter is so non-idiomatic that I can&#39;t remember the last time I ever saw it in C code. So I would hope not."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1467240731, "post_id": 38111229, "comment_id": 63656178, "body": "Please show us an MCVE (<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>).  Also show how <code>max</code> is defined and set."}, {"owner": {"reputation": 1, "user_id": 5180162, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/539211a8cfcddebcf855d6b6213574d1?s=128&d=identicon&r=PG&f=1", "display_name": "Wintermute", "link": "https://stackoverflow.com/users/5180162/wintermute"}, "edited": false, "score": 0, "creation_date": 1467242343, "post_id": 38111229, "comment_id": 63656726, "body": "yeah, the abs() is leftover from when i was testing for the cause, thinking that maybe it was just giving me the same negative number. The &lt; instead of &lt;= was because when I had &lt;=, none of them would be assigned. However, @Mike has answered it. I can&#39;t see how to mark it as answer though. Thanks for all the helps"}, {"owner": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "reply_to_user": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 0, "creation_date": 1467247651, "post_id": 38111229, "comment_id": 63658101, "body": "@tkausl your comment about not assigning to <code>stats[7]</code> is exactly wrong -- that&#39;s the only thing assigned to! (see the accepted answer)."}], "answers": [{"comments": [{"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 0, "creation_date": 1467240844, "post_id": 38111331, "comment_id": 63656224, "body": "Ahhh, so then the assignment happens to the post-loop index, <code>[7]</code>. Well spotted! (Shame about the rest of us ;-)"}, {"owner": {"reputation": 5091, "user_id": 2077386, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/49bce27bde92d6ee5970ef7259c09bb3?s=128&d=identicon&r=PG", "display_name": "rrauenza", "link": "https://stackoverflow.com/users/2077386/rrauenza"}, "edited": false, "score": 2, "creation_date": 1467240939, "post_id": 38111331, "comment_id": 63656255, "body": "Wow!  Good eyes!  And only the &quot;last&quot; one gets filled in because <code>counter</code> is 7 <i>after</i> the loop exits.  @Wintermute Please note the counter will <i>never</i> be 7 <i>inside</i> the loop."}], "tags": [], "owner": {"reputation": 7180, "user_id": 2666212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/874561e399041a45c82c2ca6652400b6?s=128&d=identicon&r=PG", "display_name": "Mike", "link": "https://stackoverflow.com/users/2666212/mike"}, "is_accepted": true, "score": 9, "last_activity_date": 1467240798, "creation_date": 1467240798, "answer_id": 38111331, "question_id": 38111229, "link": "https://stackoverflow.com/questions/38111229/only-last-element-of-c-array-saving/38111331#38111331", "title": "Only last element of C array saving", "body": "<p>You have a semi-colon at the end of your for loop line.</p>\n\n<pre><code>for (counter = 0; counter &lt; 7; counter = counter + 1);\n                                                     ^^^^\n</code></pre>\n\n<p>that makes the following block afterwards execute only once. as it is not in the for loop.</p>\n"}], "owner": {"reputation": 1, "user_id": 5180162, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/539211a8cfcddebcf855d6b6213574d1?s=128&d=identicon&r=PG&f=1", "display_name": "Wintermute", "link": "https://stackoverflow.com/users/5180162/wintermute"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "accepted_answer_id": 38111331, "answer_count": 1, "score": -1, "last_activity_date": 1467251053, "creation_date": 1467240236, "last_edit_date": 1467251053, "question_id": 38111229, "link": "https://stackoverflow.com/questions/38111229/only-last-element-of-c-array-saving", "title": "Only last element of C array saving", "body": "<p>I'm pretty new to C, and I was screwing around with some things that we were doing in class. But I've run across a problem:</p>\n\n<pre><code>srand(time(NULL));\nfor (counter = 0; counter &lt; 7; counter = counter + 1);\n{\n    stats[counter] = abs(rand() % max); \n}\n</code></pre>\n\n<p>When I go to print these elements, however, only the last one makes any sense, everything else is <code>-858993460</code></p>\n\n<pre><code>printf(\"Health:                 %d\\n\", stats[0]);\nprintf(\"Armor:                  %d\\n\", stats[1]);\nprintf(\"Damage:                 %d\\n\", stats[2]);\nprintf(\"Critical Strike Shance: %d\\n\", stats[3]);\nprintf(\"Critical Strike Damage: %d\\n\", stats[4]);\nprintf(\"Dexterity:              %d\\n\", stats[5]);\nprintf(\"Strength:               %d\\n\", stats[6]);\nprintf(\"Luck:                   %d\\n\", stats[7]);\n</code></pre>\n\n<p>Can anyone help?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["c", "multithreading", "circular-buffer"], "comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1467240674, "post_id": 38111220, "comment_id": 63656159, "body": "C11 draft standard n1570; <i>5.1.2.4 Multi-threaded executions and data races 4 Two expression evaluations conflict if one of them modifies a memory location and the other one reads or modifies the same memory location. 25 The execution of a program contains a data race if it contains two conflicting actions in different threads, at least one of which is not atomic, and neither happens before the other. Any such data race results in undefined behavior.</i>"}, {"owner": {"reputation": 231, "user_id": 5998622, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/eba0f3aba1aea1bc3b62cae3f92d8c14?s=128&d=identicon&r=PG&f=1", "display_name": "Luke", "link": "https://stackoverflow.com/users/5998622/luke"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1467240889, "post_id": 38111220, "comment_id": 63656239, "body": "@EOF The purpose for my circular buffer implementation is to avoid such race because write and read to the buffer always access different memory."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 1, "creation_date": 1467240952, "post_id": 38111220, "comment_id": 63656261, "body": "Both <code>push()</code> and <code>pop()</code> modify <code>buf -&gt; valid_items</code>, and you pass the same <code>buf</code> to both of them. Race condition, undefined behavior."}, {"owner": {"reputation": 231, "user_id": 5998622, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/eba0f3aba1aea1bc3b62cae3f92d8c14?s=128&d=identicon&r=PG&f=1", "display_name": "Luke", "link": "https://stackoverflow.com/users/5998622/luke"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1467241025, "post_id": 38111220, "comment_id": 63656292, "body": "@EOF I think this is the answer!"}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1467241130, "post_id": 38111220, "comment_id": 63656328, "body": "Well, it&#39;s <i>an answer</i>. I&#39;m quite sure you could find half a dozen race conditions in your code if you spent a bit of time looking for them. Unfortunately I don&#39;t feel like doing that, so a definitive answer won&#39;t be coming from me."}], "answers": [{"tags": [], "owner": {"reputation": 713, "user_id": 4880288, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OycAQxKvySg/AAAAAAAAAAI/AAAAAAAAEQ0/nM_F7pKQCgQ/photo.jpg?sz=128", "display_name": "mgarey", "link": "https://stackoverflow.com/users/4880288/mgarey"}, "is_accepted": true, "score": 1, "last_activity_date": 1467244495, "last_edit_date": 1467244495, "creation_date": 1467243387, "answer_id": 38111756, "question_id": 38111220, "link": "https://stackoverflow.com/questions/38111220/circular-buffer-implementation-in-c-testing-issue/38111756#38111756", "title": "Circular buffer implementation in C testing issue", "body": "<p>Luke, like EOF said, you're going to have race conditions in your code (probably several). Here are a few thoughts I had when I saw your code:</p>\n\n<p>When threads share memory, you need to have protections on that memory so that only one thread can access it at a time. You can do this with a mutex (see pthread_mutex_lock and pthread_mutex_unlock).</p>\n\n<p>Also, I noticed that your if statements in your read and write threads check the result of push and pop to see if a character was actually pushed or popped. While that might work, you should probably use semaphores to synchronize your threads instead. Here's what I mean by that: When your write thread writes to the buffer, you should have something like <code>sem_post(&amp;buff_count_sem);</code>. Then, before your read thread reads a character, you should have <code>sem_wait(&amp;buff_count_sem);</code> so that you know there is at least one character in the buffer.</p>\n\n<p>The same principle applies to the read thread. I suggest the read thread having <code>sem_post(&amp;space_left_sem)</code> just after popping a byte from the buffer and the write thread having <code>sem_wait(&amp;space_left_sem)</code> just before pushing to the buffer to ensure that there is room in the buffer for the byte you are trying to write.</p>\n\n<p>Here are my suggested changes to your code (not tested):</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;pthread.h&gt;\n#include &lt;time.h&gt;\n#include &lt;unistd.h&gt;\n\n#define MAX_NUM_ITEM 10000\n#define HASH_SIZE 32\n\nlong write_count = 0;\nlong read_count = 0;\npthread_mutex_t buff_mutex;\nsem_t buff_count_sem;\nsem_t space_left_sem;\n\nstruct cBuf {\n    int first;\n    int last;\n    int max_items;\n    int item_size;\n    int valid_items;\n    unsigned char *buffer;\n};\n\n\nvoid init_cBuf(struct cBuf *buf, int max_items, int item_size) {\n    buf -&gt; first = 0;\n    buf -&gt; last = 0;\n    buf -&gt; max_items = max_items;\n    buf -&gt; item_size = item_size;\n    buf -&gt; valid_items = 0;\n    buf -&gt; buffer = calloc(max_items, item_size);\n    return;\n}\n\n\nint isEmpty(struct cBuf *buf) {\n    if (buf -&gt; valid_items == 0) {\n        return 1;\n    }\n    else {\n        return 0;\n    }\n}\n\nint push(struct cBuf *buf, unsigned char *data) {\n    pthread_mutex_lock(&amp;buff_mutex);\n    if (buf -&gt; valid_items &gt;= buf -&gt; max_items) {\n        // buffer full\n        pthread_mutex_unlock(&amp;buff_mutex);\n        return -1;\n    }\n    else {\n        // push data into the buffer\n        memcpy(buf -&gt; buffer + (buf -&gt; last) * (buf -&gt; item_size), data, buf -&gt; item_size);\n\n        // update cBuf info\n        buf -&gt; valid_items++;\n        buf -&gt; last = (buf -&gt; last + 1) % (buf -&gt; max_items);  \n        pthread_mutex_unlock(&amp;buff_mutex);\n        return 0;\n    }\n}\n\nint pop(struct cBuf *buf, unsigned char *new_buf) {\n    phthread_mutex_lock(&amp;buff_mutex);\n    if (isEmpty(buf)) {\n        // buffer empty\n        pthread_mutex_unlock(&amp;buff_mutex);\n        return -1;\n    }\n    else {\n        // read data\n        memcpy(new_buf, buf -&gt; buffer + (buf -&gt; first) * (buf -&gt; item_size), buf -&gt; item_size);\n\n        // update cBuf info\n        buf -&gt; first = (buf -&gt; first + 1) % (buf -&gt; max_items);\n        buf -&gt; valid_items--;\n        pthread_mutex_unlock(&amp;buff_mutex);\n        return 0;\n    }\n}\n\nvoid *write_hash(void *ptr) {\n    struct cBuf *buf = (struct cBuf *)(ptr);\n\n    while (1) {\n        unsigned char *hash = malloc(HASH_SIZE); // for simplicity I just create some data with 32-byte.\n\n        sem_wait(&amp;space_left_sem);\n        push(buf, hash);\n        write_count++;\n        sem_post(&amp;buff_count_sem);\n        free(hash);\n        if (write_count == MAX_NUM_ITEM) {\n            break;\n        }\n    }\n\n    printf (\"  thread id  = %lu\\n\", (long unsigned) (pthread_self ()));\n    printf (\"  total write = %lu\\n\\n\", write_count);\n    return NULL;\n}\n\nvoid *read_hash(void *ptr) {\n\n    struct cBuf *buf = (struct cBuf *)(ptr);\n    unsigned char *new_buf = malloc(HASH_SIZE);\n    while (1) {\n\n        sem_wait(&amp;buff_count_sem);\n        pop(buf, new_buf);\n        read_count++;\n        sem_post(&amp;space_left_sem);\n\n        if (read_count == MAX_NUM_ITEM) {\n            break;\n        }\n    }\n    free(new_buf);\n\n    printf (\"  thread id  = %lu\\n\", (long unsigned) (pthread_self ()));\n    printf (\"  total read = %lu\\n\\n\", read_count);\n\n}\n\nint main(int argc, char const *argv[]) {\n\n    struct cBuf buf;\n    init_cBuf(&amp;buf, 200, HASH_SIZE);\n\n    pthread_t write_thd, read_thd;\n\n    pthread_mutex_init(&amp;buff_mutex);\n    sem_init(&amp;buff_count_sem, 0, 0); // the last parameter is the initial value - initially 0 if no data is in the buffer\n    sem_init(&amp;space_left_sem, 0, buf.max_items);\n\n    double diff = 0.0, t1 = 0.0, t2 = 0.0;\n    t1 = clock ();\n\n    pthread_create(&amp;read_thd, NULL, read_hash, &amp;buf);\n    pthread_create(&amp;write_thd, NULL, write_hash, &amp;buf);\n\n    pthread_join(write_thd, NULL);\n    pthread_join(read_thd, NULL);\n\n\n    t2 = clock ();\n    diff = (double)((t2 - t1) / CLOCKS_PER_SEC);\n\n    printf (\"----------------\\nTotal time: %lf second\\n\", diff);\n    printf (\"Total write: %lu\\n\", write_count);\n    printf (\"write per-second: %lf\\n\\n\", write_count / diff);\n\n    return 0;\n}\n</code></pre>\n\n<p>I suggest reading up on how to properly use threads.</p>\n\n<p>UPDATE:\n1. Fixed a typo.\n2. You'll also want to have mutex_lock and mutex_unlock in isEmpty and any other functions that you write for your circular buffers where multiple threads might access the same buffer.</p>\n"}], "owner": {"reputation": 231, "user_id": 5998622, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/eba0f3aba1aea1bc3b62cae3f92d8c14?s=128&d=identicon&r=PG&f=1", "display_name": "Luke", "link": "https://stackoverflow.com/users/5998622/luke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 650, "favorite_count": 0, "accepted_answer_id": 38111756, "answer_count": 1, "score": 0, "last_activity_date": 1467244495, "creation_date": 1467240200, "last_edit_date": 1467240958, "question_id": 38111220, "link": "https://stackoverflow.com/questions/38111220/circular-buffer-implementation-in-c-testing-issue", "title": "Circular buffer implementation in C testing issue", "body": "<p>I implemented my own circular buffer. I want to use two threads to test it. One thread continuously writing to the buffer while the other continuously reading it. When certain amount of data are read, print out the benchmark.</p>\n\n<p>The purpose of this circular buffer is write and read never access the same memory so there won't incur a race.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;pthread.h&gt;\n#include &lt;time.h&gt;\n#include &lt;unistd.h&gt;\n\n#define MAX_NUM_ITEM 10000\n#define HASH_SIZE 32\n\nlong write_count = 0;\nlong read_count = 0;\n\nstruct cBuf {\n    int first;\n    int last;\n    int max_items;\n    int item_size;\n    int valid_items;\n    unsigned char *buffer;\n};\n\n\nvoid init_cBuf(struct cBuf *buf, int max_items, int item_size) {\n    buf -&gt; first = 0;\n    buf -&gt; last = 0;\n    buf -&gt; max_items = max_items;\n    buf -&gt; item_size = item_size;\n    buf -&gt; valid_items = 0;\n    buf -&gt; buffer = calloc(max_items, item_size);\n    return;\n}\n\n\nint isEmpty(struct cBuf *buf) {\n    if (buf -&gt; valid_items == 0) {\n        return 1;\n    }\n    else {\n        return 0;\n    }\n}\n\nint push(struct cBuf *buf, unsigned char *data) {\n    if (buf -&gt; valid_items &gt;= buf -&gt; max_items) {\n        // buffer full\n        return -1;\n    }\n    else {\n        // push data into the buffer\n        memcpy(buf -&gt; buffer + (buf -&gt; last) * (buf -&gt; item_size), data, buf -&gt; item_size);\n\n        // update cBuf info\n        buf -&gt; valid_items++;\n        buf -&gt; last = (buf -&gt; last + 1) % (buf -&gt; max_items);  \n        return 0;\n    }\n}\n\nint pop(struct cBuf *buf, unsigned char *new_buf) {\n    if (isEmpty(buf)) {\n        // buffer empty\n        return -1;\n    }\n    else {\n        // read data\n        memcpy(new_buf, buf -&gt; buffer + (buf -&gt; first) * (buf -&gt; item_size), buf -&gt; item_size);\n\n        // update cBuf info\n        buf -&gt; first = (buf -&gt; first + 1) % (buf -&gt; max_items);\n        buf -&gt; valid_items--;\n        return 0;\n    }\n}\n\nvoid *write_hash(void *ptr) {\n    struct cBuf *buf = (struct cBuf *)(ptr);\n\n    while (1) {\n        unsigned char *hash = malloc(HASH_SIZE); // for simplicity I just create some data with 32-byte.\n        if (push(buf, hash) == 0) {\n            write_count++;\n            //printf(\"put %lu items into the buffer. valid_items: %d\\n\", write_count, buf -&gt; valid_items);\n        }\n        free(hash);\n        if (write_count == MAX_NUM_ITEM) {\n            break;\n        }\n    }\n\n    printf (\"  thread id  = %lu\\n\", (long unsigned) (pthread_self ()));\n    printf (\"  total write = %lu\\n\\n\", write_count);\n    return NULL;\n}\n\nvoid *read_hash(void *ptr) {\n\n    struct cBuf *buf = (struct cBuf *)(ptr);\n    unsigned char *new_buf = malloc(HASH_SIZE);\n    while (1) {\n        if (pop(buf, new_buf) == 0) {\n            read_count++;\n            //printf(\"pop %lu items from the buffer. valid_items: %d\\n\", read_count, buf -&gt; valid_items);\n        }\n        if (read_count == MAX_NUM_ITEM) {\n            break;\n        }\n    }\n    free(new_buf);\n\n    printf (\"  thread id  = %lu\\n\", (long unsigned) (pthread_self ()));\n    printf (\"  total read = %lu\\n\\n\", read_count);\n\n}\n\nint main(int argc, char const *argv[]) {\n\n    struct cBuf buf;\n    init_cBuf(&amp;buf, 200, HASH_SIZE);\n\n    pthread_t write_thd, read_thd;\n\n    double diff = 0.0, t1 = 0.0, t2 = 0.0;\n    t1 = clock ();\n\n    pthread_create(&amp;read_thd, NULL, read_hash, &amp;buf);\n    pthread_create(&amp;write_thd, NULL, write_hash, &amp;buf);\n\n    pthread_join(write_thd, NULL);\n    pthread_join(read_thd, NULL);\n\n\n    t2 = clock ();\n    diff = (double)((t2 - t1) / CLOCKS_PER_SEC);\n\n    printf (\"----------------\\nTotal time: %lf second\\n\", diff);\n    printf (\"Total write: %lu\\n\", write_count);\n    printf (\"write per-second: %lf\\n\\n\", write_count / diff);\n\n    return 0;\n}\n</code></pre>\n\n<p>It is very weird that the program never terminates if I left the \"printf\" in function \"write_hash\" and \"read_hash\" commented. If I uncommented these two \"printf\"s, the program will print out all push and pop info till the end and eventually the program exit successfully.</p>\n\n<p>Please help me to find if it's because something wrong with my circular buffer implementation, or somewhere else.</p>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1467240182, "post_id": 38111194, "comment_id": 63655990, "body": "There is no value at <code>vowels[5]</code>; your array is indexed from 0 to 4.  So, you invoke undefined behaviour and anything can happen.  You will either need to write a loop to search through the list of characters, or change the definition to <code>char vowels[] = &quot;AEIOU&quot;;</code> and then use an appropriate string scan function to see whether the letter is in the list of vowels."}], "answers": [{"tags": [], "owner": {"reputation": 534, "user_id": 6503620, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/f6qzk.png?s=128&g=1", "display_name": "lexx9999", "link": "https://stackoverflow.com/users/6503620/lexx9999"}, "is_accepted": false, "score": 0, "last_activity_date": 1467240473, "creation_date": 1467240473, "answer_id": 38111267, "question_id": 38111194, "link": "https://stackoverflow.com/questions/38111194/compare-character-with-array/38111267#38111267", "title": "Compare character with array", "body": "<p>It think the problem is the comparison <code>toupper(letter) == vowels[5]</code>? vowels[5] is always out of array, but other vowels aren't checked.\nYou would need to add a loop like:</p>\n\n<pre><code>char upr=toupper(letter);\nfor(int i=0; i&lt;5; i++) \n  if(vowels[i]==c)\n  { cont++;      \n    break;\n  }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 764, "user_id": 6301103, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bf0769f719c19bc3497f3472c18fed8?s=128&d=identicon&r=PG&f=1", "display_name": "jaaq", "link": "https://stackoverflow.com/users/6301103/jaaq"}, "is_accepted": false, "score": 0, "last_activity_date": 1467241046, "creation_date": 1467241046, "answer_id": 38111376, "question_id": 38111194, "link": "https://stackoverflow.com/questions/38111194/compare-character-with-array/38111376#38111376", "title": "Compare character with array", "body": "<p>You should write a small function for this comparison</p>\n\n<pre><code>int checkforVowels(char tobechecked)\n{\n  //this only get vowels in CAPSLOCK tho... so dont forget toupper\n  char vowels[5] = {'A','E','I','O','U'};\n  int hasvowel = 0;\n  for(int i = 0; i &lt; 5; i++)\n  {\n    if(tobechecked == vowels[i])\n    {\n      hasvowel = 1;\n      break;\n    }\n  }\n  return hasvowel;\n}\n</code></pre>\n\n<p>so you can have it like that</p>\n\n<pre><code>if(checkforVowels(toupper(letter))\n</code></pre>\n\n<p>HTH</p>\n"}], "owner": {"reputation": 814, "user_id": 2352665, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b7eaa37741dcbba9e1e8afcec8ef49b2?s=128&d=identicon&r=PG", "display_name": "Alejandro Caro", "link": "https://stackoverflow.com/users/2352665/alejandro-caro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 208, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1467253339, "creation_date": 1467239963, "last_edit_date": 1467253339, "question_id": 38111194, "link": "https://stackoverflow.com/questions/38111194/compare-character-with-array", "title": "Compare character with array", "body": "<p>I want to make a program that counts the vowels in a sentence entered by the user.\nFor that compare a character that capitalizes with the vowel arrangement, but although they do not pulls error, do not type the correct output.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;ctype.h&gt;\n#include &lt;conio.h&gt;\n\n//Program EJER004\nint main(){\n    char vowels[5] = {'A','E','I','O','U'};\n    int count;\n    char letter;\n\n    count = 0;\n\n    printf(\"Enter a phrase, ending with a point\\n\");\n\n    do{\n        letter=getchar();\n        if (toupper(letter) == vowels[5]) /*attempt ask if is a vowel the letter introduced*/\n           count++;     \n    }while (letter != '.');\n\n    printf(\"\\n\");\n    printf(\"\\n\");\n    printf(\"The number of vowels in the phrase introduced is% d\", count);       \n    getch(); \n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "storage-class-specifier"], "comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 1, "creation_date": 1467239696, "post_id": 38111073, "comment_id": 63655834, "body": "Block-scope objects are <code>auto</code> by default, so the specifier is entirely useless. <code>register</code> only matters on lobotomized compilers."}, {"owner": {"reputation": 4268, "user_id": 5768335, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/FVCGA.jpg?s=128&g=1", "display_name": "amanuel2", "link": "https://stackoverflow.com/users/5768335/amanuel2"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1467239866, "post_id": 38111073, "comment_id": 63655894, "body": "And why does it matter only on lobotomized compilers? And what does that even mean? @EOF"}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 1, "creation_date": 1467240086, "post_id": 38111073, "comment_id": 63655962, "body": "If you use a modern compiler like <code>gcc</code>, <code>icc</code> or <code>clang</code> and enable even modest optimization settings, the compiler will assign objects that do not have their address taken (or the address doesn&#39;t escape the function) to be kept in cpu-registers regardless of whether you declared them as <code>register</code>."}, {"owner": {"reputation": 530, "user_id": 2394541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f9b9b9399b329591f7be92da1c5e442?s=128&d=identicon&r=PG", "display_name": "tim18", "link": "https://stackoverflow.com/users/2394541/tim18"}, "edited": false, "score": 0, "creation_date": 1467240258, "post_id": 38111073, "comment_id": 63656017, "body": "register forbids address or reference operator so may preserve more opportunities for optimization."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 530, "user_id": 2394541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f9b9b9399b329591f7be92da1c5e442?s=128&d=identicon&r=PG", "display_name": "tim18", "link": "https://stackoverflow.com/users/2394541/tim18"}, "edited": false, "score": 0, "creation_date": 1467240433, "post_id": 38111073, "comment_id": 63656078, "body": "@tim18: It doesn&#39;t forbid reference operators in C -- or rather, C itself does so."}], "answers": [{"comments": [{"owner": {"reputation": 4268, "user_id": 5768335, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/FVCGA.jpg?s=128&g=1", "display_name": "amanuel2", "link": "https://stackoverflow.com/users/5768335/amanuel2"}, "edited": false, "score": 0, "creation_date": 1467240278, "post_id": 38111215, "comment_id": 63656024, "body": "First off.. Did we meet? Are you the person in the Assembly chat room? Second off.... Hmm, i have heard the last comment somewhere i somehow forgot sorry.  Thanks a lot for your anwser :)"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 4268, "user_id": 5768335, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/FVCGA.jpg?s=128&g=1", "display_name": "amanuel2", "link": "https://stackoverflow.com/users/5768335/amanuel2"}, "edited": false, "score": 0, "creation_date": 1467240398, "post_id": 38111215, "comment_id": 63656064, "body": "@Dsafds: No, I&#39;m not in the Assembly chat room (not sure what that is). And you&#39;re welcome."}, {"owner": {"reputation": 4268, "user_id": 5768335, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/FVCGA.jpg?s=128&g=1", "display_name": "amanuel2", "link": "https://stackoverflow.com/users/5768335/amanuel2"}, "edited": false, "score": 0, "creation_date": 1467240462, "post_id": 38111215, "comment_id": 63656090, "body": "One quick question Keith, why would we even use the auto keyword? dosent it jsut default to it? And ughh sorry i thought we met, someones avatar is the same as yours or looks very alike i guess."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 4268, "user_id": 5768335, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/FVCGA.jpg?s=128&g=1", "display_name": "amanuel2", "link": "https://stackoverflow.com/users/5768335/amanuel2"}, "edited": false, "score": 0, "creation_date": 1467240639, "post_id": 38111215, "comment_id": 63656150, "body": "In C, there is no reason to use the <code>auto</code> keyword. It&#39;s another holdover. In very old versions of C, variables were implicitly of type <code>int</code> if you didn&#39;t specify a type, so <code>auto n;</code> was equivalent to <code>int n;</code> within a function. Since at least 1989, you have to specify the type. (C++ has removed the old meaning of <code>auto</code> and created a new one; <code>auto var = expr;</code> sets the type of <code>var</code> to the type of the expression, which turns out to be more useful in C++ than in C.)"}, {"owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "reply_to_user": {"reputation": 4268, "user_id": 5768335, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/FVCGA.jpg?s=128&g=1", "display_name": "amanuel2", "link": "https://stackoverflow.com/users/5768335/amanuel2"}, "edited": false, "score": 0, "creation_date": 1467240788, "post_id": 38111215, "comment_id": 63656205, "body": "@Dsafds: You would very rarely see the <code>auto</code> keyword in C code, if ever, since like you say it&#39;s the default storage class.  But it&#39;s also very rare for WG14 (the ISO committee responsible for the C language standard) to remove anything from the language for fear of breaking code, no matter how old or crufty. <code>gets()</code> is pretty much the only example of a feature being removed from the language, even though doing so had the potential to break a lot of code - it was that pathological."}, {"owner": {"reputation": 4268, "user_id": 5768335, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/FVCGA.jpg?s=128&g=1", "display_name": "amanuel2", "link": "https://stackoverflow.com/users/5768335/amanuel2"}, "edited": false, "score": 0, "creation_date": 1467240793, "post_id": 38111215, "comment_id": 63656206, "body": "Hmm yea while ive done C++ before C, i have learned that in C++ the auto keyword is basically so it can be of variable any type when it gets declared as so <code>auto x;</code>. but if it gets initalized it will be the type its initalized as so: <code>auto x = 3; &#47;&#47;x is now of type int</code>; I was thinking C Had the same purpose as this, but guess not. (Yet another reason why people shouldnt use the word &#39;C/C++&#39; C is not C++!!!!)"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 4268, "user_id": 5768335, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/FVCGA.jpg?s=128&g=1", "display_name": "amanuel2", "link": "https://stackoverflow.com/users/5768335/amanuel2"}, "edited": false, "score": 1, "creation_date": 1467240990, "post_id": 38111215, "comment_id": 63656274, "body": "@Dsafds: <code>auto x;</code> is illegal in both C and C++. It doesn&#39;t specify a type, and there is no default."}, {"owner": {"reputation": 4268, "user_id": 5768335, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/FVCGA.jpg?s=128&g=1", "display_name": "amanuel2", "link": "https://stackoverflow.com/users/5768335/amanuel2"}, "edited": false, "score": 0, "creation_date": 1467241056, "post_id": 38111215, "comment_id": 63656303, "body": "Oh @KeithThompson so you have to initalize it if it is a auto in C++?"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "edited": false, "score": 1, "creation_date": 1467241086, "post_id": 38111215, "comment_id": 63656309, "body": "@JohnBode: Implicit <code>int</code> (for functions, not for objects) was removed by C99. BTW, <code>auto</code> is the default only within a function definition (i.e., within a block). Outside a function definition, the default storage duration is static -- and the <code>auto</code> keyword is illegal. So depending on the context, <code>auto</code> is either redundant or forbidden."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 4268, "user_id": 5768335, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/FVCGA.jpg?s=128&g=1", "display_name": "amanuel2", "link": "https://stackoverflow.com/users/5768335/amanuel2"}, "edited": false, "score": 1, "creation_date": 1467241194, "post_id": 38111215, "comment_id": 63656358, "body": "@Dsafds: Yes, that&#39;s how it determines the type. In C++ you can write <code>auto it = container.begin();</code> and <code>it</code> will be of the correct iterator type; you don&#39;t have to specify the (possibly quite verbose) name of the iterator type, and you don&#39;t have to change the declaration if the type of <code>container</code> changes."}, {"owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "edited": false, "score": 1, "creation_date": 1467241220, "post_id": 38111215, "comment_id": 63656369, "body": "@KeithThompson: as usual, posting before thinking.  I know all this stuff, really."}], "tags": [], "owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "is_accepted": true, "score": 4, "last_activity_date": 1467240336, "last_edit_date": 1467240336, "creation_date": 1467240159, "answer_id": 38111215, "question_id": 38111073, "link": "https://stackoverflow.com/questions/38111073/register-vs-auto-storage-class/38111215#38111215", "title": "Register vs Auto Storage class?", "body": "<p>The <code>register</code> storage class does not imply that the object will be stored in a register. The standard says:</p>\n\n<blockquote>\n  <p>A declaration of an identifier for an object with storage-class\n  specifier <strong><code>register</code></strong> suggests that access to the object be as fast\n  as possible. The extent to which such suggestions are effective is\n  implementation-defined.</p>\n</blockquote>\n\n<p>(The quotation is from the <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf\" rel=\"nofollow\">N1570</a> draft of the ISO C standard, section 6.7.1 paragraph 6.)</p>\n\n<p>Storing the object in a CPU register rather than in memory is one way to accomplish that, but not the only one.</p>\n\n<p>Modern compilers (at least according to the common wisdom) are probably better than you are at deciding which variables should be stored in registers for speed, so using the <code>register</code> keyword probably won't do anything other than interfere with the compiler's optimization.</p>\n\n<p><code>register</code> also makes it illegal to take the address of the object (even if it's stored in memory).</p>\n\n<p>It's basically a holdover from early compilers (1970s) that didn't perform the sophisticated optimizations modern compilers do. For such a compiler <code>register</code> could significantly improve performance.</p>\n\n<p>(Modern compilers, I believe, start by assuming that all variables can be allocated in registers, and \"spill\" them to memory only when necessary, either because the variable's address is needed or because there aren't enough registers available.)</p>\n"}], "owner": {"reputation": 4268, "user_id": 5768335, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/FVCGA.jpg?s=128&g=1", "display_name": "amanuel2", "link": "https://stackoverflow.com/users/5768335/amanuel2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 963, "favorite_count": 0, "accepted_answer_id": 38111215, "answer_count": 1, "score": 0, "last_activity_date": 1527138685, "creation_date": 1467239235, "last_edit_date": 1527138685, "question_id": 38111073, "link": "https://stackoverflow.com/questions/38111073/register-vs-auto-storage-class", "title": "Register vs Auto Storage class?", "body": "<p>right now im learning about storage classes <a href=\"https://www.youtube.com/watch?v=Xe7xLSBlMV4&amp;index=73&amp;list=PLfVsf4Bjg79CZ5kHTiQHcm-l2q8j06ofd\" rel=\"nofollow\">here</a>. And he seems to explain the same thing for the auto storage class and the register storage class. The only thing he diffrenciated between the two is that the register storage class is stored in CPU Register.. Are there any diffrences between these storage classes? Any uses of the register storage class? Is Register keyword thier by default on some C Compilers?</p>\n\n<pre><code>register int x = 5;\nauto int y = 3;\n</code></pre>\n"}, {"tags": ["c", "boolean-expression"], "comments": [{"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 5, "creation_date": 1467237022, "post_id": 38110631, "comment_id": 63654775, "body": "How long did you spend searching for an answer to this question?"}, {"owner": {"reputation": 1431, "user_id": 1258302, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r06hH.jpg?s=128&g=1", "display_name": "yellowantphil", "link": "https://stackoverflow.com/users/1258302/yellowantphil"}, "edited": false, "score": 0, "creation_date": 1467237112, "post_id": 38110631, "comment_id": 63654810, "body": "Consult your trusty K&amp;R book. If you don&#39;t have one, get it. It&#39;s the best programming book I ever read, and it&#39;s short."}, {"owner": {"reputation": 41440, "user_id": 3887516, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/62e0310897139a10f3293022b6eb7054?s=128&d=identicon&r=PG&f=1", "display_name": "Amit", "link": "https://stackoverflow.com/users/3887516/amit"}, "edited": false, "score": 1, "creation_date": 1467237119, "post_id": 38110631, "comment_id": 63654813, "body": "How difficult is this for you to <b>test this out yourself</b>?"}, {"owner": {"reputation": 42460, "user_id": 642626, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/fedc5e6b7fef29a8b539e20da8c85971?s=128&d=identicon&r=PG", "display_name": "Bryan Chen", "link": "https://stackoverflow.com/users/642626/bryan-chen"}, "edited": false, "score": 0, "creation_date": 1467237136, "post_id": 38110631, "comment_id": 63654818, "body": "in case you don&#39;t know what to google: <code>short circuit evaluation in c</code>"}, {"owner": {"reputation": 1431, "user_id": 1258302, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r06hH.jpg?s=128&g=1", "display_name": "yellowantphil", "link": "https://stackoverflow.com/users/1258302/yellowantphil"}, "reply_to_user": {"reputation": 41440, "user_id": 3887516, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/62e0310897139a10f3293022b6eb7054?s=128&d=identicon&r=PG&f=1", "display_name": "Amit", "link": "https://stackoverflow.com/users/3887516/amit"}, "edited": false, "score": 0, "creation_date": 1467237147, "post_id": 38110631, "comment_id": 63654825, "body": "@Amit He doesn&#39;t even need to do that. You never know if your compiler is just being lazy, but this is specified in the standard."}, {"owner": {"reputation": 41440, "user_id": 3887516, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/62e0310897139a10f3293022b6eb7054?s=128&d=identicon&r=PG&f=1", "display_name": "Amit", "link": "https://stackoverflow.com/users/3887516/amit"}, "reply_to_user": {"reputation": 1431, "user_id": 1258302, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r06hH.jpg?s=128&g=1", "display_name": "yellowantphil", "link": "https://stackoverflow.com/users/1258302/yellowantphil"}, "edited": false, "score": 0, "creation_date": 1467237223, "post_id": 38110631, "comment_id": 63654851, "body": "@yellowantphil - ha?? lazy compiler?? let me quote (your answer): &quot;<i>this is specified in the standard</i>&quot; - so.. a standard compliant compiler will do what it should"}, {"owner": {"reputation": 1431, "user_id": 1258302, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r06hH.jpg?s=128&g=1", "display_name": "yellowantphil", "link": "https://stackoverflow.com/users/1258302/yellowantphil"}, "reply_to_user": {"reputation": 41440, "user_id": 3887516, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/62e0310897139a10f3293022b6eb7054?s=128&d=identicon&r=PG&f=1", "display_name": "Amit", "link": "https://stackoverflow.com/users/3887516/amit"}, "edited": false, "score": 3, "creation_date": 1467237293, "post_id": 38110631, "comment_id": 63654891, "body": "@Amit My point is that if you don&#39;t read the standard but just try it in your compiler, you don&#39;t know if your compiler is doing its own optimization or following the standard. Just trying it in your compiler is not enough."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1467237395, "post_id": 38110631, "comment_id": 63654938, "body": "Although many will say <code>No</code>, I believe the answer is deeper.  If the compiler can determine that the second function has no impact then  it could be called, but since it has no impact on the <i>state</i> of the code, it make no difference,  This allows certain optimizations so both halves can evaluate in parallel or in either sequence.  But this is a very limited optimization as the compiler must be able to determine the 2nd half does not change the code <i>state</i>."}, {"owner": {"reputation": 41440, "user_id": 3887516, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/62e0310897139a10f3293022b6eb7054?s=128&d=identicon&r=PG&f=1", "display_name": "Amit", "link": "https://stackoverflow.com/users/3887516/amit"}, "reply_to_user": {"reputation": 1431, "user_id": 1258302, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r06hH.jpg?s=128&g=1", "display_name": "yellowantphil", "link": "https://stackoverflow.com/users/1258302/yellowantphil"}, "edited": false, "score": 0, "creation_date": 1467237397, "post_id": 38110631, "comment_id": 63654939, "body": "@yellowantphil - if you use a stable version of a standard compiler, it does what the standard says - that&#39;s as good as reading anything, but simpler."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 1431, "user_id": 1258302, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r06hH.jpg?s=128&g=1", "display_name": "yellowantphil", "link": "https://stackoverflow.com/users/1258302/yellowantphil"}, "edited": false, "score": 1, "creation_date": 1467237451, "post_id": 38110631, "comment_id": 63654967, "body": "@yellowantphil: Exactly. It&#39;s easy to imagine a C-like language in which the right operand of <code>&amp;&amp;</code> <i>may or may not</i> be evaluated if the LHS is false. Testing will not tell the OP that C is not such a language. Similarly, testing can&#39;t tell you that <code>printf(&quot;%d %d\\n&quot;, i++, i++)</code> has undefined behavior."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1467237521, "post_id": 38110631, "comment_id": 63654997, "body": "@chux Why should a function with no impact called? Just because it won&#39;t be noticed?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1467237705, "post_id": 38110631, "comment_id": 63655066, "body": "@ Eugene Sh. Consider <code>int a,b,c,d; ... a = b + c; if (d || a+1)...</code>  Evaluation of <code>a+1</code> may happen before <code>d</code> is read as the previous line of code has <code>a</code> at the ready.  Some compilers well understand the effect of library functions and can do this at a functional level."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 41440, "user_id": 3887516, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/62e0310897139a10f3293022b6eb7054?s=128&d=identicon&r=PG&f=1", "display_name": "Amit", "link": "https://stackoverflow.com/users/3887516/amit"}, "edited": false, "score": 0, "creation_date": 1467237733, "post_id": 38110631, "comment_id": 63655074, "body": "@Amit people following this philosophy are coming here with question like &quot;why ` i++ + i++` return <code>x</code> and not <code>y</code> as expected&quot;."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1467237884, "post_id": 38110631, "comment_id": 63655137, "body": "@chux OK, got it. Even simpler example would be if the second operand is a constant expression."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1467238320, "post_id": 38110631, "comment_id": 63655323, "body": "@Eugene Sh. Unfortunately I have not found in the C spec that words that allow this apparent violation of C11, 6.5.13.  Compiler optimizations and processor pipelining are very tricky these days."}, {"owner": {"reputation": 41440, "user_id": 3887516, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/62e0310897139a10f3293022b6eb7054?s=128&d=identicon&r=PG&f=1", "display_name": "Amit", "link": "https://stackoverflow.com/users/3887516/amit"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1467239278, "post_id": 38110631, "comment_id": 63655696, "body": "@EugeneSh. - Asking <i>why</i> something happens is entirely different from asking <i>what will</i> happen. If you want to know what will happen, test it. If you want to know why that happened, read or ask. If you suspect 2 &quot;simple&quot; function calls on either sides of an operator might trigger UB, then you probably never saw a single program, but read or ask."}], "answers": [{"tags": [], "owner": {"reputation": 249903, "user_id": 2422776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2353050223ebecb113741c29458de4b2?s=128&d=identicon&r=PG", "display_name": "Mureinik", "link": "https://stackoverflow.com/users/2422776/mureinik"}, "is_accepted": false, "score": 1, "last_activity_date": 1467237151, "creation_date": 1467237151, "answer_id": 38110666, "question_id": 38110631, "link": "https://stackoverflow.com/questions/38110631/does-c-check-the-second-boolean-statement-in-an-statement/38110666#38110666", "title": "Does C check the second boolean statement in an &amp;&amp; statement", "body": "<p>The short answer: no. <a href=\"/questions/tagged/c\" class=\"post-tag\" title=\"show questions tagged &#39;c&#39;\" rel=\"tag\">c</a> uses short circuit evaluation, so if the left hand argument of an <code>&amp;&amp;</code> operator is <code>FALSE</code>, it's obvious there's no way the entire expression can be anything but <code>FALSE</code>, and the right hand argument isn't even evaluated.</p>\n"}, {"tags": [], "owner": {"reputation": 14411, "user_id": 52724, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c1e5bf4421007b7cfe4dba5ecb24f777?s=128&d=identicon&r=PG", "display_name": "Karl Nicoll", "link": "https://stackoverflow.com/users/52724/karl-nicoll"}, "is_accepted": true, "score": 1, "last_activity_date": 1467237188, "creation_date": 1467237188, "answer_id": 38110679, "question_id": 38110631, "link": "https://stackoverflow.com/questions/38110631/does-c-check-the-second-boolean-statement-in-an-statement/38110679#38110679", "title": "Does C check the second boolean statement in an &amp;&amp; statement", "body": "<p>If <code>check_value_1(value)</code> returns <code>FALSE</code>, the second portion of the if-statement will be skipped and will not execute. This is known as <a href=\"https://en.wikipedia.org/wiki/Short-circuit_evaluation\" rel=\"nofollow\">short circuit evaluation</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 963, "user_id": 1431184, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/e0161e23d2a5c46f9b1e319731249510?s=128&d=identicon&r=PG", "display_name": "printfmyname", "link": "https://stackoverflow.com/users/1431184/printfmyname"}, "is_accepted": false, "score": 1, "last_activity_date": 1467237194, "creation_date": 1467237194, "answer_id": 38110683, "question_id": 38110631, "link": "https://stackoverflow.com/questions/38110631/does-c-check-the-second-boolean-statement-in-an-statement/38110683#38110683", "title": "Does C check the second boolean statement in an &amp;&amp; statement", "body": "<p>No, C does a lazy evaluation and return FALSE.</p>\n\n<p>read more about it <a href=\"https://en.wikipedia.org/wiki/Short-circuit_evaluation\" rel=\"nofollow\">https://en.wikipedia.org/wiki/Short-circuit_evaluation</a></p>\n"}], "owner": {"reputation": 3144, "user_id": 1363270, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/01dbx.jpg?s=128&g=1", "display_name": "Rob Avery IV", "link": "https://stackoverflow.com/users/1363270/rob-avery-iv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 136, "favorite_count": 0, "closed_date": 1467237254, "accepted_answer_id": 38110679, "answer_count": 3, "score": 0, "last_activity_date": 1467237357, "creation_date": 1467236990, "question_id": 38110631, "link": "https://stackoverflow.com/questions/38110631/does-c-check-the-second-boolean-statement-in-an-statement", "closed_reason": "Duplicate", "title": "Does C check the second boolean statement in an &amp;&amp; statement", "body": "<p>So, let's say, I have this piece of code:</p>\n\n<pre><code>int value = 256;\nif( check_value_1(value) &amp;&amp; check_value_2(value) )\n{\n    // .. do stuff ..\n}\n</code></pre>\n\n<p>If function <code>check_value_1()</code> returns <code>FALSE</code> will <code>check_value_2()</code> be called?</p>\n"}, {"tags": ["c", "parsing", "ragel"], "answers": [{"tags": [], "owner": {"reputation": 347, "user_id": 1088191, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vjAdZ.png?s=128&g=1", "display_name": "RichTBreak", "link": "https://stackoverflow.com/users/1088191/richtbreak"}, "is_accepted": true, "score": 3, "last_activity_date": 1504191144, "last_edit_date": 1504191144, "creation_date": 1471531929, "answer_id": 39021351, "question_id": 38110628, "link": "https://stackoverflow.com/questions/38110628/ragel-alternative-to-fbreak-but-without-advance-to-next-symbol/39021351#39021351", "title": "Ragel alternative to fbreak; but without advance to next symbol?", "body": "<p>I believe you need to make an <code>fhold</code> call preceding your <code>fbreak</code>.</p>\n\n<p>Quoting the Ragel user guide:</p>\n\n<blockquote>\n  <p><code>fhold;</code> -- Do not advance over the current character. If processing data in multiple buffer blocks, the <code>fhold</code> statement should only be used once in the set of actions executed on a character. Multiple calls may result in backing up over the beginning of the buffer block.\n  The <code>fhold</code> statement does not imply any transfer of control. It is equivalent to the <code>p--;</code> statement.</p>\n</blockquote>\n"}], "owner": {"reputation": 203, "user_id": 512932, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/62bdbe7c30e4e9724078259e88d8d2c7?s=128&d=identicon&r=PG", "display_name": "Amdei", "link": "https://stackoverflow.com/users/512932/amdei"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 162, "favorite_count": 0, "accepted_answer_id": 39021351, "answer_count": 1, "score": 2, "last_activity_date": 1504191144, "creation_date": 1467236981, "question_id": 38110628, "link": "https://stackoverflow.com/questions/38110628/ragel-alternative-to-fbreak-but-without-advance-to-next-symbol", "title": "Ragel alternative to fbreak; but without advance to next symbol?", "body": "<p>I'm writing a program what parses HTML to extract URLs from there using Ragel.<br>\nAfter finding URL I need to perform some actions on it, and then ready to process next URL.<br>\nSo I need to stop executing main loop at the URL end, execute some actions outside of parser, and then start from where I broke.</p>\n\n<p><code>fbreak</code> seems to be a good varinat, but unfortunatelly it ate next symbol in buffer. The issue here, besides there could be already buffer end, is that we effectively skip one symbol in input stream.</p>\n\n<p>Is there is a way to break execution without advance to the next symbol in input stream, as <code>fbreak</code> does?<br>\nSo far I figure out only dirty hack to write <code>goto _out;</code> instead of fbreak.</p>\n"}, {"tags": ["c++", "c", "fft", "convolution", "fftw"], "comments": [{"owner": {"reputation": 1884, "user_id": 3078414, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b1180f5e68d3542488d66de14ff53964?s=128&d=identicon&r=PG&f=1", "display_name": "user3078414", "link": "https://stackoverflow.com/users/3078414/user3078414"}, "edited": false, "score": 2, "creation_date": 1467234497, "post_id": 38109836, "comment_id": 63653653, "body": "<code>44100</code> looks like some kind of audio sampling rate. Normally sizes of <code>fft</code> arrays have nothing to do with sampling rates and are power-of-two. Usually input and output array sizes match because of the mathematical requirement. If size of real input data doesn&#39;t match array size, there are techniques of windowing and zero-padding to fix this. There&#39;s enough good literature on this subject."}, {"owner": {"reputation": 1810, "user_id": 3018243, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/469fdc7e2f05894b3c6d98a389c869ab?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Cox", "link": "https://stackoverflow.com/users/3018243/steve-cox"}, "edited": false, "score": 1, "creation_date": 1467236469, "post_id": 38109836, "comment_id": 63654543, "body": "others have already mentioned that the input and output length must match. maybe you could give a bit more context on what you&#39;re trying to do. based on that magic number it looks like you&#39;re trying to estimate the power spectrum with 1 bin per Hz (probably). If that&#39;s the case you just need to zero pad your input up to 44100 samples and apply a window function (try hanning) to the block of input you have to smooth out the spectrum."}], "answers": [{"comments": [{"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 1, "creation_date": 1467235098, "post_id": 38110062, "comment_id": 63653932, "body": "Is a linear interpolation the best thing you can do?  I mean, suppose you took the samples, produced a sum of sinusodials that best approximated the signal, then used that to interpolate?  That corresponds to a relatively simple transformation in the frequency domain, and might be a better method?"}, {"owner": {"reputation": 5676, "user_id": 5023438, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uvlov.jpg?s=128&g=1", "display_name": "alter igel", "link": "https://stackoverflow.com/users/5023438/alter-igel"}, "reply_to_user": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 0, "creation_date": 1467235569, "post_id": 38110062, "comment_id": 63654134, "body": "@Yakk wouldn&#39;t that accomplish the same thing, just not in n*log(n) time?"}, {"owner": {"reputation": 1810, "user_id": 3018243, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/469fdc7e2f05894b3c6d98a389c869ab?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Cox", "link": "https://stackoverflow.com/users/3018243/steve-cox"}, "edited": false, "score": 2, "creation_date": 1467235998, "post_id": 38110062, "comment_id": 63654327, "body": "you can&#39;t just stretch the input, that will cause obvious artifacts. if you actually need to interpolate (i don&#39;t see why you would do that at all here, given that it changes the bin meaning entirely) you should do it against a nyquist limited pulse shape. If you care about performance you should do this in the frequency domain, since its cheaper (single tap). if you&#39;re really worried about artifacts in the frequency domain pad out the transform to turn the circular convolution into a normal one, same as overlap&amp;save method"}, {"owner": {"reputation": 5676, "user_id": 5023438, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uvlov.jpg?s=128&g=1", "display_name": "alter igel", "link": "https://stackoverflow.com/users/5023438/alter-igel"}, "reply_to_user": {"reputation": 1810, "user_id": 3018243, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/469fdc7e2f05894b3c6d98a389c869ab?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Cox", "link": "https://stackoverflow.com/users/3018243/steve-cox"}, "edited": false, "score": 0, "creation_date": 1467236085, "post_id": 38110062, "comment_id": 63654370, "body": "@SteveCox I believe you know much more about convolution than I do :) you should provide an answer too, or feel free to edit mine"}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 0, "creation_date": 1467239716, "post_id": 38110062, "comment_id": 63655847, "body": "@tim no, a linear interpolation has a rather complex frequency response (it is like convolving with a triangle, which is obviously not simple in the frequency domain).  (My knowledge of this field is abstract, not practical, so I do not know the best answer, I can just spot issues)"}], "tags": [], "owner": {"reputation": 5676, "user_id": 5023438, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uvlov.jpg?s=128&g=1", "display_name": "alter igel", "link": "https://stackoverflow.com/users/5023438/alter-igel"}, "is_accepted": false, "score": 3, "last_activity_date": 1467234503, "creation_date": 1467234503, "answer_id": 38110062, "question_id": 38109836, "link": "https://stackoverflow.com/questions/38109836/c-how-can-i-fourier-transform-an-array-into-an-other-array-of-different-size/38110062#38110062", "title": "c++ : how can I fourier transform an array into an other array of different size using fftw3", "body": "<p>The discrete fourier transform will always produce an output with the same size as its input, as a basic mathematical premise of the algorithm, and this is reflected in FFTW by only taking in one size parameter. This is because for an array of N discrete values in the time domain, there are exactly N possible unique frequencies at play, from 0 to N-1 cycles per unit of time (this unit being the length in time of your input).</p>\n\n<p>You could scale your input up or down in size to 44100 values, by essentially stretching the input and interpolating its values to create a new array that fits the required length, and then perform the fourier transform. I recommend you perform this stretching on the input time domain and not on the frequency domain to avoid undesirable artifacts.</p>\n"}], "owner": {"reputation": 19, "user_id": 6530364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ebff6368a03146f7dddeb4ac92018da?s=128&d=identicon&r=PG&f=1", "display_name": "Matze .H", "link": "https://stackoverflow.com/users/6530364/matze-h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 638, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1467234503, "creation_date": 1467233609, "question_id": 38109836, "link": "https://stackoverflow.com/questions/38109836/c-how-can-i-fourier-transform-an-array-into-an-other-array-of-different-size", "title": "c++ : how can I fourier transform an array into an other array of different size using fftw3", "body": "<p>I need to fourier transform an array with integer-values to the frequency domain (in order to multiply it with another one later). The output array must have the size of 44100 but the input array will vary. </p>\n\n<p>I think fftw3 is a good tool for that. But how do I create a 'plan' with different array-sizes for input and output?</p>\n\n<p>here is the function I wrote:</p>\n\n<pre><code>fftw_complex* fourier( int* samples, int numberOfSamples ){\n\n    fftw_complex* input;\n    fftw_complex* output;\n    fftw_plan plan;\n    input = (fftw_complex*)fftw_malloc( sizeof(fftw_complex)*numberOfSamples );\n    output = (fftw_complex*)fftw_malloc( sizeof(fftw_complex)*44100 );                  //cd-quality\n\n    plan = fftw_plan_dft_1d( 44100, input, output, FFTW_FORWARD, FFTW_ESTIMATE );\n    // here is the problem because  ^this\n    // array has a different size than\n    //                                     ^this array\n\n    for( size_t index = 0; index &lt; numberOfSamples; index++ ){\n        input[index][0] = (double)(samples[index]);\n        input[index][1] = 0;\n    }\n    fftw_execute(plan);\n    fftw_destroy_plan(plan);\n    fftw_free(input);\n    return output;\n}\n</code></pre>\n\n<p>thanks a lot for answering</p>\n"}, {"tags": ["c", "arrays", "do-while"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1467235275, "post_id": 38109814, "comment_id": 63654010, "body": "Note that in C, all the &#39;prototypes&#39; except the one for <code>convertC()</code> are simply function declarations and not prototypes. They say the fiction exists, but nothing about the argument list (except that it isn&#39;t a variable list).  To make a prototype, you need to include <code>void</code> inside the parentheses: <code>void askTemp(void);</code> etc."}], "answers": [{"tags": [], "owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "is_accepted": true, "score": 0, "last_activity_date": 1467233749, "creation_date": 1467233749, "answer_id": 38109867, "question_id": 38109814, "link": "https://stackoverflow.com/questions/38109814/storing-values-in-array-in-while-loop/38109867#38109867", "title": "Storing values in array in while loop", "body": "<p>You declare an array of 1000 <code>float</code> like this:</p>\n\n<pre><code>float saved_temperatures[1000];\n</code></pre>\n\n<p>You store a value in it by indexing into the array, and using it like a variable.</p>\n\n<pre><code>saved_temperatures[i] = temp;\n++i;\n</code></pre>\n\n<p><code>i</code> is an indexing variable, and you should make sure it starts at zero and is always less than 1000. The valid index range for <code>saved_temperatures</code> is 0..999.</p>\n\n<pre><code>for (int i = 0; i &lt; 1000; ++i) {\n    printf(\"index %d temperature %f\\n\", i, saved_temperatures[i]);\n}\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 6369189, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f083b19973fc26f54eea4edd174546f5?s=128&d=identicon&r=PG&f=1", "display_name": "Pastelitos Slim", "link": "https://stackoverflow.com/users/6369189/pastelitos-slim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 634, "favorite_count": 0, "accepted_answer_id": 38109867, "answer_count": 1, "score": -1, "last_activity_date": 1467233749, "creation_date": 1467233523, "question_id": 38109814, "link": "https://stackoverflow.com/questions/38109814/storing-values-in-array-in-while-loop", "title": "Storing values in array in while loop", "body": "<p>So the program is supposed to calculate the temperature from an initial temp given by the user which is then changed based on wind, humidity, and condition. first get a starting temperature from the user, then display a menu of choices that consist of entering wind speed, entering humidity, entering the condition, displaying the current temperature, displaying the last 1000 temperatures after the initial temp has been modified and displaying the sum of all temperatures. </p>\n\n<p>I have done most of it but I'm having problems with how to store and display the last 1000 temperatures. I'm supposed to use an array in this program but I'm not sure how to use it to get what I need. Help, please.</p>\n\n<pre><code>#define _CRT_SECURE_NO_WARNINGS\n#define CLS system(\"cls\")\n#define PAUSE system(\"pause\")\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n// PROTOTYPING FUNCTIONS\nvoid askTemp();\nfloat convertC(float f);\nvoid displayMenu();\nchar getChoice();\nchar getCondChoice();\nfloat getHumid();\nfloat getTemp();\nfloat getWind();\n\nmain() {\n    // INITIALIZE VARIABLES\n    float temp;\n    float wind = 5;\n    float humid = 20;\n    int trump = 0;\n    char choice = 'A';\n    int num;\n    char cond = 'S';\n    char condChoice;\n    float celsius;\n    int i = 0;\n    int j = 0;\n    int k = 0;\n    float temp2 = 0;\n    float wind2 = 0;\n    float humid2 = 0;\n    int x = 0;\n\n    askTemp();\n    temp = getTemp();\n\n    do{\n        displayMenu();\n        choice = getChoice();\n\n        switch (choice){\n        case 'W': // Get Wind\n            wind = getWind();\n            break;\n        case 'H': // Get the humidity\n            humid = getHumid();\n            break;\n        case 'C': // Enter subswitch statement to get condition\n            condChoice = getCondChoice();\n            switch (condChoice){ // gets condition \n            case 'S':\n                cond = 'S';\n                break;\n            case 'C':\n                cond = 'C';\n                break;\n            case 'R':\n                cond = 'R';\n                break;\n            }// END SWITCH\n        case 'T': // display current temperature\n\n            if (temp != temp2 || wind != wind2 || humid != humid2){ // apply degree changes based on humid, wind, and cond\n                if (wind &gt; 100)\n                    temp = temp - (temp * .03);\n                if (wind &lt; 10)\n                    temp = temp + (temp * .025);\n                if (humid &gt; 75)\n                    temp = temp + (temp * .058933);\n                if (humid &lt; 20)\n                    temp = temp - (temp * .0162);\n                if (cond == 'S' &amp;&amp; wind &gt; 30)\n                    temp = temp + (temp * .01);\n                if (cond == 'S' &amp;&amp; wind == 0)\n                    temp = temp + (temp * .005);\n                if (cond == 'R')\n                    temp = temp - (temp * .02);\n                if (cond == 'C' &amp;&amp; humid &gt; 75)\n                    temp = temp + (temp * .01);\n                if (cond == 'C' &amp;&amp; humid &lt; 75)\n                    temp = temp + (temp * .005);\n                if (wind &gt; 30 &amp;&amp; humid &gt; 75 &amp;&amp; cond == 'S')\n                    temp = temp;\n                wind2 = wind;     // assigned variables so program does not apply condition changes multiple times for same temp\n                humid2 = humid;\n                temp2 = temp;\n            }// END IF\n        celsius = convertC(temp2);\n        printf(\"The Current temperature is %.1ff/%.1fc degrees Celsius\\n\", temp2, celsius);\n        PAUSE;\n        break;\n    case 'P': // Display previous 1000 temperatures\n\n        break;\n    case 'A': // Display average of all temps entered\n        break;\n    }// END SWITCH\n\n} while (choice != 'Q');\n\n\n\n} // END MAIN\n\nvoid askTemp(){\n    printf(\"What is the current temperature: \\n\");\n    return;\n}// end askTemp\n\nvoid displayMenu(){\n    CLS;\n    printf(\"W. Enter Wind Speed\\n\");\n    printf(\"H. Enter Humidity\\n\");\n    printf(\"C. conditions\\n\");\n    printf(\"T. Current Temperature\\n\");\n    printf(\"P. Previous Temps\\n\");\n    printf(\"A. Average Temperature\\n\");\n    printf(\"Q. Quit\\n\");\n    return;\n} // end currentTemp\n\nchar getChoice(){\n    char result;\n    scanf(\"%c\", &amp;result);\n    result = toupper(result);\n    return result;\n}// end getChoice\n\nchar getCond(){\n    char result;\n\n\n}// end getCond\n\nchar getCondChoice(){\n    char result;\n    printf(\"S for sunny, C for cloudy, R for rainy\\n\");\n    scanf(\" %c\", &amp;result);\n    result = toupper(result);\n    do{\n        if (result != 'S' &amp;&amp; result != 'C' &amp;&amp; result != 'R'){\n            printf(\"Invalid input try again\\n\");\n            scanf(\" %c\", &amp;result);\n            result = toupper(result);\n        }\n    } while (result != 'S' &amp;&amp; result != 'C' &amp;&amp; result != 'R');\n    return result;\n}// end getCond\n\nfloat getHumid(){\n    float result;\n    scanf(\"%f\", &amp;result);\n    return result;\n}// end getHumid\n\nfloat getTemp(){\n    float result;\n    scanf(\"%f\", &amp;result);\n    do{\n\n        if (result &lt; -50 || result &gt; 150){\n            printf(\"Invalid temperature try again\\n\");\n            scanf(\"%f\", &amp;result);\n        }\n    } while (result &lt; -50 || result &gt; 150);\n    return result;\n}// end getTemp\n\nfloat getWind(){\n    float result;\n    scanf(\"%f\", &amp;result);\n    return result;\n}// end getWind\n\nfloat convertC(float f){\n    float t;\n    t = (f - 32) / 1.8;\n    return(t);\n}// end convert\n</code></pre>\n"}, {"tags": ["c", "arrays", "pointers", "memcpy"], "answers": [{"comments": [{"owner": {"reputation": 159, "user_id": 2705419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd243a67e90feef63bae69e441801836?s=128&d=identicon&r=PG&f=1", "display_name": "Bob", "link": "https://stackoverflow.com/users/2705419/bob"}, "edited": false, "score": 0, "creation_date": 1467233178, "post_id": 38109550, "comment_id": 63652988, "body": "What I need is a string that can be any size, because the value of slope can have anywhere from 3 to 8 digits of precesion. I was using <a href=\"http://stackoverflow.com/questions/8732325/how-to-declare-strings-in-c\" title=\"how to declare strings in c\">stackoverflow.com/questions/8732325/how-to-declare-strings-i&zwnj;&#8203;n-c</a> for my declaration. How do I declare a pointer which I can change the contents of?"}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "reply_to_user": {"reputation": 159, "user_id": 2705419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd243a67e90feef63bae69e441801836?s=128&d=identicon&r=PG&f=1", "display_name": "Bob", "link": "https://stackoverflow.com/users/2705419/bob"}, "edited": false, "score": 0, "creation_date": 1467233244, "post_id": 38109550, "comment_id": 63653011, "body": "@Bob, you can make it easier for you by using <code>char mystring[50];</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user3235832"}, "edited": false, "score": 0, "creation_date": 1467233326, "post_id": 38109550, "comment_id": 63653073, "body": "That&#39;s the point of dynamic allocation - you can use <code>malloc</code> to allocate whatever size you want (within machine / OS limits); also don&#39;t forget to allocate one extra character space to store the zero delimiter character"}, {"owner": {"reputation": 159, "user_id": 2705419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd243a67e90feef63bae69e441801836?s=128&d=identicon&r=PG&f=1", "display_name": "Bob", "link": "https://stackoverflow.com/users/2705419/bob"}, "edited": false, "score": 0, "creation_date": 1467233832, "post_id": 38109550, "comment_id": 63653330, "body": "Why is it that you dont need to declare that sprintf is writing the value to the target of the pointer mystring? Wouldn&#39;t the way you have it write the value of slope*1000 to the stored memory address of mystring?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user3235832"}, "edited": false, "score": 0, "creation_date": 1467233923, "post_id": 38109550, "comment_id": 63653379, "body": "What do you mean? Look at the manual for <code>sprintf</code> - by passing <code>mystring</code> to the first argument you <i>are</i> declaring that <code>sprintf</code> should write the integer to <code>mystring</code>"}, {"owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "reply_to_user": {"reputation": 159, "user_id": 2705419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd243a67e90feef63bae69e441801836?s=128&d=identicon&r=PG&f=1", "display_name": "Bob", "link": "https://stackoverflow.com/users/2705419/bob"}, "edited": false, "score": 0, "creation_date": 1467234033, "post_id": 38109550, "comment_id": 63653438, "body": "@Bob: You&#39;re better off statically declaring an array of fixed size, large enough for the longest possble string plus 1 extra character for the 0 terminator.  Since the value of slope can be anywhere from 3 to 8 digits, declare <code>mystring</code> as an <i>array</i> of <code>char</code> like so - <code>char mystring[9];</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user3235832"}, "reply_to_user": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "edited": false, "score": 0, "creation_date": 1467234174, "post_id": 38109550, "comment_id": 63653512, "body": "@JohnBode the size of <code>long</code> is at least 32 bits on modern platforms, so you&#39;d need 11 (9 for the billionth digit, 10 for the minus sign) - just to be on the safe side."}, {"owner": {"reputation": 159, "user_id": 2705419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd243a67e90feef63bae69e441801836?s=128&d=identicon&r=PG&f=1", "display_name": "Bob", "link": "https://stackoverflow.com/users/2705419/bob"}, "edited": false, "score": 0, "creation_date": 1467234206, "post_id": 38109550, "comment_id": 63653525, "body": "int sprintf(char *str, const char *format, ...) Doesnt that mean I need to declare the target of the pointer so it doesnt mess up the memory location?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user3235832"}, "reply_to_user": {"reputation": 159, "user_id": 2705419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd243a67e90feef63bae69e441801836?s=128&d=identicon&r=PG&f=1", "display_name": "Bob", "link": "https://stackoverflow.com/users/2705419/bob"}, "edited": false, "score": 0, "creation_date": 1467234253, "post_id": 38109550, "comment_id": 63653555, "body": "@Bob the pointer <i>is</i> the target (or represents the target). that&#39;s the <i>point</i> of its existence. ( get it? :] )"}, {"owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "edited": false, "score": 1, "creation_date": 1467234549, "post_id": 38109550, "comment_id": 63653680, "body": "@willywonkadailyblah: In the first comment, the OP claimed that the value of <code>slope</code> can have anywhere from 3 to 8 digits of precision; I&#39;m just taking him at his word.  Of course, if you want to cover the max number of decimal digits that can be represented in a 32 bit integral type plus the sign. then yes, you&#39;d need an 11- or 12-element array to store it."}, {"owner": {"reputation": 159, "user_id": 2705419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd243a67e90feef63bae69e441801836?s=128&d=identicon&r=PG&f=1", "display_name": "Bob", "link": "https://stackoverflow.com/users/2705419/bob"}, "edited": false, "score": 0, "creation_date": 1467234761, "post_id": 38109550, "comment_id": 63653778, "body": "Ok I think I got it. Now I just have to figure out why char* mystring = (char*)malloc(21); exploded my compiler"}, {"owner": {"user_type": "does_not_exist", "display_name": "user3235832"}, "reply_to_user": {"reputation": 159, "user_id": 2705419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd243a67e90feef63bae69e441801836?s=128&d=identicon&r=PG&f=1", "display_name": "Bob", "link": "https://stackoverflow.com/users/2705419/bob"}, "edited": false, "score": 0, "creation_date": 1467234823, "post_id": 38109550, "comment_id": 63653795, "body": "@Bob really? give us the error message. did you include <code>stdlib.h</code> ?"}, {"owner": {"reputation": 159, "user_id": 2705419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd243a67e90feef63bae69e441801836?s=128&d=identicon&r=PG&f=1", "display_name": "Bob", "link": "https://stackoverflow.com/users/2705419/bob"}, "edited": false, "score": 0, "creation_date": 1467235212, "post_id": 38109550, "comment_id": 63653980, "body": "I did include stdlib.h My error is &quot;calibrate.c:53:1: error: initializer element is not constant&quot;."}, {"owner": {"user_type": "does_not_exist", "display_name": "user3235832"}, "reply_to_user": {"reputation": 159, "user_id": 2705419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd243a67e90feef63bae69e441801836?s=128&d=identicon&r=PG&f=1", "display_name": "Bob", "link": "https://stackoverflow.com/users/2705419/bob"}, "edited": false, "score": 0, "creation_date": 1467235282, "post_id": 38109550, "comment_id": 63654015, "body": "@Bob apologies it was partly my fault. you need to do <code>malloc</code> and other kinds of dynamic initialization <i>inside</i> a function, not outside; see edit"}, {"owner": {"reputation": 159, "user_id": 2705419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd243a67e90feef63bae69e441801836?s=128&d=identicon&r=PG&f=1", "display_name": "Bob", "link": "https://stackoverflow.com/users/2705419/bob"}, "edited": false, "score": 0, "creation_date": 1467235376, "post_id": 38109550, "comment_id": 63654061, "body": "Why is that? Does that mean you cannot make a dynamic variable global?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user3235832"}, "reply_to_user": {"reputation": 159, "user_id": 2705419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd243a67e90feef63bae69e441801836?s=128&d=identicon&r=PG&f=1", "display_name": "Bob", "link": "https://stackoverflow.com/users/2705419/bob"}, "edited": false, "score": 0, "creation_date": 1467235531, "post_id": 38109550, "comment_id": 63654115, "body": "@Bob you can make variables global anytime, but you can&#39;t <i>allocate them dynamically</i> outside functions; generally you can&#39;t call a function outside a function in C"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user3235832"}, "is_accepted": true, "score": 12, "last_activity_date": 1467235305, "last_edit_date": 1467235305, "creation_date": 1467232415, "answer_id": 38109550, "question_id": 38109517, "link": "https://stackoverflow.com/questions/38109517/compiler-errors-calling-sprintf-expected-char-but-argument-is-of-type-cha/38109550#38109550", "title": "Compiler errors calling sprintf: &quot;expected &#39;char *&#39; but argument is of type &#39;char&#39;&quot;", "body": "<p><code>mystring</code> is already a pointer. <code>*mystring</code> de-references it to give the first character. You want to just pass in <code>mystring</code>.</p>\n\n<p>You must also allocation some memory for <code>mystring</code>, either statically or dynamically using <code>malloc</code>.</p>\n\n<pre><code>float slope = 0.0626;\nchar* mystring;\n/* char mystring[50]; */ // or just do this, as Sahu and John suggested\nint8_t    LCDline1[20];\n\nvoid myfunction(){\n    mystring = (char*)malloc(mystring_size); // set this to any size\n    sprintf(mystring, \"%ld\", (long)(slope * 10000));\n    memcpy(LCDline1, mystring, strlen(mystring)+1);\n}\n</code></pre>\n\n<p>NB whenever you are allocating memory for the string, make sure to allocate <em>one more</em> than the string's length, to store the zero-delimiter character (<code>strlen</code> and many other functions need this)</p>\n"}, {"comments": [{"owner": {"reputation": 159, "user_id": 2705419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd243a67e90feef63bae69e441801836?s=128&d=identicon&r=PG&f=1", "display_name": "Bob", "link": "https://stackoverflow.com/users/2705419/bob"}, "edited": false, "score": 0, "creation_date": 1467233324, "post_id": 38109566, "comment_id": 63653071, "body": "I am tying to understand pointers better, taking the sprintf function you wrote, wouldnt that write the value of slope*1000 into the pointer of mystring, rather than its target?"}, {"owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "reply_to_user": {"reputation": 159, "user_id": 2705419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd243a67e90feef63bae69e441801836?s=128&d=identicon&r=PG&f=1", "display_name": "Bob", "link": "https://stackoverflow.com/users/2705419/bob"}, "edited": false, "score": 0, "creation_date": 1467234233, "post_id": 38109566, "comment_id": 63653541, "body": "@Bob: No, <code>sprintf</code> assumes that pointer is the starting address of a buffer, and will write the resulting string to that buffer."}], "tags": [], "owner": {"reputation": 14401, "user_id": 1730261, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/m57hO.jpg?s=128&g=1", "display_name": "Rushy Panchal", "link": "https://stackoverflow.com/users/1730261/rushy-panchal"}, "is_accepted": false, "score": 2, "last_activity_date": 1467232481, "creation_date": 1467232481, "answer_id": 38109566, "question_id": 38109517, "link": "https://stackoverflow.com/questions/38109517/compiler-errors-calling-sprintf-expected-char-but-argument-is-of-type-cha/38109566#38109566", "title": "Compiler errors calling sprintf: &quot;expected &#39;char *&#39; but argument is of type &#39;char&#39;&quot;", "body": "<p>You are incorrectly using pointers. A \"string\" is defined as an array of characters, and so when you write <code>char *mystring</code>, you are declaring a pointer to a character array (or a string).</p>\n\n<p>Now, if you dereference <code>mystring</code> using <code>*mystring</code> in your code, you are getting the first element of that array, which is just a character. As the warnings say, those functions accept <code>char*</code> parameters, not <code>char</code>.</p>\n\n<p>So, just pass in the pointer, without dereferencing:</p>\n\n<pre><code>void myfunction(){\n    sprintf(mystring, \"%ld\", (long)(slope * 10000));\n    memcpy(LCDline1, mystring, strlen(mystring)+1);\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 99, "user_id": 9452003, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-nQOSEWdh8ys/AAAAAAAAAAI/AAAAAAAAEE4/iXLuTyvomP0/photo.jpg?sz=128", "display_name": "Joseph", "link": "https://stackoverflow.com/users/9452003/joseph"}, "is_accepted": false, "score": 0, "last_activity_date": 1528783487, "creation_date": 1528783487, "answer_id": 50810205, "question_id": 38109517, "link": "https://stackoverflow.com/questions/38109517/compiler-errors-calling-sprintf-expected-char-but-argument-is-of-type-cha/50810205#50810205", "title": "Compiler errors calling sprintf: &quot;expected &#39;char *&#39; but argument is of type &#39;char&#39;&quot;", "body": "<pre><code>Char *c;\n</code></pre>\n\n<p>This can be starting address of array to store characters but,</p>\n\n<pre><code>c //is the pointer to array\n*c // will give starting character of array\n</code></pre>\n"}], "owner": {"reputation": 159, "user_id": 2705419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd243a67e90feef63bae69e441801836?s=128&d=identicon&r=PG&f=1", "display_name": "Bob", "link": "https://stackoverflow.com/users/2705419/bob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 25577, "favorite_count": 0, "accepted_answer_id": 38109550, "answer_count": 3, "score": 4, "last_activity_date": 1590589549, "creation_date": 1467232295, "last_edit_date": 1590589549, "question_id": 38109517, "link": "https://stackoverflow.com/questions/38109517/compiler-errors-calling-sprintf-expected-char-but-argument-is-of-type-cha", "title": "Compiler errors calling sprintf: &quot;expected &#39;char *&#39; but argument is of type &#39;char&#39;&quot;", "body": "<p>I am trying to program a microchip in C. Right now my I'm working to update a line on an LCD screen but it doesnt work correctly. Can anyone shed some light on this?</p>\n\n<pre><code>float slope = 0.0626;\nchar *mystring;\nint8_t    LCDline1[20];\n\nvoid myfunction(){\n    sprintf(*mystring, \"%ld\", (long)(slope * 10000));\n    memcpy(LCDline1, *mystring, strlen(*mystring)+1);\n}\n</code></pre>\n\n<p>When I run compile code I get the following three errors.</p>\n\n<pre><code>calibrate.c:60:5: warning: passing argument 1 of 'sprintf' makes\npointer from integer without a cast. note: expected 'char *'\nbut argument is of type 'char'\n\ncalibrate.c:61:5: warning: passing argument 1 of 'strlen' makes\npointer from integer without a cast.  note: expected 'const char *'\nbut argument is of type 'char'\n\ncalibrate.c:61:5: warning: passing argument 2 of 'memcpy' makes\npointer from integer without a cast. note: expected 'const void *' but\nargument is of type 'char'\n</code></pre>\n\n<p>I am not sure what I am doing wrong, I am using the following definitions for my starting point</p>\n\n<pre><code>void *memcpy(void *str1, const void *str2, size_t n)\nsize_t strlen(const char *str)\nchar *p = \"String\";\n</code></pre>\n"}, {"tags": ["c", "post-increment"], "comments": [{"owner": {"reputation": 27385, "user_id": 1382251, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/17622c39e8ead537a0944c767551b2fe?s=128&d=identicon&r=PG", "display_name": "barak manos", "link": "https://stackoverflow.com/users/1382251/barak-manos"}, "edited": false, "score": 0, "creation_date": 1467231553, "post_id": 38109228, "comment_id": 63652198, "body": "Function <code>esta</code> will be called with argument <code>c</code> equal <code>0</code> forever... Since you&#39;re using recursion, this will pretty quickly result with a stack overflow."}, {"owner": {"reputation": 3495, "user_id": 6282011, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95b77715e47dc5e168ba0f573529099a?s=128&d=identicon&r=PG&f=1", "display_name": "Juan Tomas", "link": "https://stackoverflow.com/users/6282011/juan-tomas"}, "reply_to_user": {"reputation": 27385, "user_id": 1382251, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/17622c39e8ead537a0944c767551b2fe?s=128&d=identicon&r=PG", "display_name": "barak manos", "link": "https://stackoverflow.com/users/1382251/barak-manos"}, "edited": false, "score": 0, "creation_date": 1467231710, "post_id": 38109228, "comment_id": 63652267, "body": "@barak But that&#39;s just the question.  As written, <code>c</code> should equal zero forever, but for some reason it doesn&#39;t (or seems not to).  The recursion collapses normally instead of overflowing the stack."}, {"owner": {"reputation": 27385, "user_id": 1382251, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/17622c39e8ead537a0944c767551b2fe?s=128&d=identicon&r=PG", "display_name": "barak manos", "link": "https://stackoverflow.com/users/1382251/barak-manos"}, "edited": false, "score": 2, "creation_date": 1467231783, "post_id": 38109228, "comment_id": 63652296, "body": "The <code>s+c</code> expression may be evaluated before or after the <code>c++</code> expression. I think that the language standard does not define which expression inside a function-call will be evaluated first. In your case, it is probably evaluated after (<code>c++</code> and then <code>s+c</code>). But in any case, my comment above is wrong, because although argument <code>c</code> is always <code>0</code>, argument <code>s</code> <b>is</b> incremented, so the code will complete successfully. Replace <code>c++</code> with <code>c+1</code> if you want to avoid this kind of undefined behavior."}], "answers": [{"comments": [{"owner": {"reputation": 3495, "user_id": 6282011, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95b77715e47dc5e168ba0f573529099a?s=128&d=identicon&r=PG&f=1", "display_name": "Juan Tomas", "link": "https://stackoverflow.com/users/6282011/juan-tomas"}, "edited": false, "score": 1, "creation_date": 1467231859, "post_id": 38109328, "comment_id": 63652325, "body": "Not sure why this got downvoted.  It actually makes sense."}, {"owner": {"reputation": 8445, "user_id": 929459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e420841bacccb72fb934f80069c11d0b?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/929459/dmitri"}, "edited": false, "score": 0, "creation_date": 1467233866, "post_id": 38109328, "comment_id": 63653356, "body": "Additionally, there&#39;s no sequence point between the evaluation of the two arguments -- only one after all the arguments are evaluated but before the actual function call; so there&#39;s undefined behaviour for that reason too, as there would be with eg. <code>x = c + c++;</code>.  Hypothetically, the arguments could be evaluated right to left and still have the <code>s + c</code> argument mean either <code>s + 0</code> <i>or</i> <code>s + 1</code> (the side effect of the increment might happen after both arguments are evaluated, or earlier)."}], "tags": [], "owner": {"reputation": 871, "user_id": 4304844, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vSjQh.jpg?s=128&g=1", "display_name": "tsandy", "link": "https://stackoverflow.com/users/4304844/tsandy"}, "is_accepted": false, "score": 7, "last_activity_date": 1467231601, "creation_date": 1467231601, "answer_id": 38109328, "question_id": 38109228, "link": "https://stackoverflow.com/questions/38109228/use-of-post-increment-in-recursion/38109328#38109328", "title": "Use of post-increment in recursion", "body": "<p>The order in which arguments are evaluated is undefined, so the compiler can choose any order it wants to. It seems in your case, it's first evaluating <code>c++</code> to 0, and then <code>s+c</code> evaluates to <code>s+1</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 2558, "user_id": 655436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98da4e7757d5f0e8596fd832bebee3d0?s=128&d=identicon&r=PG", "display_name": "fukanchik", "link": "https://stackoverflow.com/users/655436/fukanchik"}, "is_accepted": true, "score": 2, "last_activity_date": 1467232754, "last_edit_date": 1592644375, "creation_date": 1467232754, "answer_id": 38109632, "question_id": 38109228, "link": "https://stackoverflow.com/questions/38109228/use-of-post-increment-in-recursion/38109632#38109632", "title": "Use of post-increment in recursion", "body": "<p>See wikipedia <a href=\"https://en.wikipedia.org/wiki/Sequence_point\" rel=\"nofollow noreferrer\">Sequence point</a>. In particular item #4 gives full explanation:</p>\n<blockquote>\n<p>A sequence point defines any point in a computer program's execution at which it is guaranteed that all side effects of previous evaluations will <strong>have been performed</strong>, and no side effects from subsequent evaluations have yet been performed.</p>\n<ol start=\"4\">\n<li>Before a function is entered in a function call. The <strong>order</strong> in which the arguments are evaluated <strong>is not specified</strong>, but this sequence point means that all of their side effects are complete before the function is entered.\nIn the expression f(i++) + g(j++) + h(k++), f is called with a parameter of the <strong>original value of i</strong>, but i is incremented <strong>before</strong> entering the body of f.</li>\n</ol>\n</blockquote>\n<p>In other words: compiler is assigned to do a tough job here. It must pass the original value which was there <em>before</em> POST-increment (because it is how <em>POST</em>-increment works) and at the same time perform all side effects BEFORE entering the function <code>esta</code>. Among these side effects is increment the value of <code>c</code>. And, since the order in which the arguments are evaluated <em>is not specified</em> it happens so that your compiler evaluates <code>c++</code> first, and then does <code>s+c</code> which in this case means <code>s+1</code>. Hence your line is shorter and shorter and eventually <code>strlen(s)==0</code> when you exit from the recursion and print string remainders at each iteration.</p>\n"}], "owner": {"reputation": 33, "user_id": 6446665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcaa252fa591b2b870950ff396424391?s=128&d=identicon&r=PG&f=1", "display_name": "Juampi", "link": "https://stackoverflow.com/users/6446665/juampi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 344, "favorite_count": 0, "closed_date": 1467233106, "accepted_answer_id": 38109632, "answer_count": 2, "score": 2, "last_activity_date": 1467232754, "creation_date": 1467231166, "question_id": 38109228, "link": "https://stackoverflow.com/questions/38109228/use-of-post-increment-in-recursion", "closed_reason": "Duplicate", "title": "Use of post-increment in recursion", "body": "<p>I'm new in this community, and I'm trying to understand why this recursive function not get a stack overflow,when I use the post increment (c++) in the call of the function, this passes a value of 0 (i see that when i debug), but when the next function is called, it have a value of 1.\nI dont understand when the post increment is applied, and why if im passing to the function the value of 0 , in the first argument is doing s+1;</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#define LARGO 20\n\nchar *esta (char s[], int c){\n if(strlen(s))\n    printf(\"\\n %s\", esta(s+c,c++));\n return s;\n}\n\nint main()\n{\n char cad[LARGO]= {\"hello\"};\n int c=0;\n printf(\"\\n %s\", esta(cad,c++));\n}\n</code></pre>\n\n<p><strong>P.S. :</strong> Sorry if my english is not the best, It isn't my main language and i try to explain as well i could; and if it is something is not clear tell me and i change it.</p>\n"}, {"tags": ["c", "makefile"], "answers": [{"comments": [{"owner": {"reputation": 4778, "user_id": 1917363, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/112f39ececafcaf7321fcfc67be141dd?s=128&d=identicon&r=PG", "display_name": "applecrusher", "link": "https://stackoverflow.com/users/1917363/applecrusher"}, "edited": false, "score": 0, "creation_date": 1467234420, "post_id": 38109688, "comment_id": 63653613, "body": "It&#39;s returning this now:  cc -o sia-gpu-miner sia-gpu-miner.o network.o -lOpenCL -lcurl /usr/bin/ld: cannot find -lOpenCL collect2: error: ld returned 1 exit status"}, {"owner": {"reputation": 83283, "user_id": 3937, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/e27f554e9ed800bca61642acaba29452?s=128&d=identicon&r=PG", "display_name": "Lou Franco", "link": "https://stackoverflow.com/users/3937/lou-franco"}, "reply_to_user": {"reputation": 4778, "user_id": 1917363, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/112f39ececafcaf7321fcfc67be141dd?s=128&d=identicon&r=PG", "display_name": "applecrusher", "link": "https://stackoverflow.com/users/1917363/applecrusher"}, "edited": false, "score": 0, "creation_date": 1467290639, "post_id": 38109688, "comment_id": 63678317, "body": "It&#39;s the same problem with library paths. Somewhere there should be an OpenCL library -- it might be named something like libOpenCL.a or .so -- look for what else installing OpenCL put on your drive.  Then add <code>-L &#47;the&#47;dir&#47;where&#47;libOpenCLis</code> to LDLIBS. Read <code>man ld</code> to learn about this option."}, {"owner": {"reputation": 4778, "user_id": 1917363, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/112f39ececafcaf7321fcfc67be141dd?s=128&d=identicon&r=PG", "display_name": "applecrusher", "link": "https://stackoverflow.com/users/1917363/applecrusher"}, "edited": false, "score": 1, "creation_date": 1467585526, "post_id": 38109688, "comment_id": 63777137, "body": "An easier way is to symbolic link it using ln -s if you don&#39;t want to edit the actual file"}], "tags": [], "owner": {"reputation": 83283, "user_id": 3937, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/e27f554e9ed800bca61642acaba29452?s=128&d=identicon&r=PG", "display_name": "Lou Franco", "link": "https://stackoverflow.com/users/3937/lou-franco"}, "is_accepted": true, "score": 0, "last_activity_date": 1467232971, "creation_date": 1467232971, "answer_id": 38109688, "question_id": 38109108, "link": "https://stackoverflow.com/questions/38109108/add-opencl-cl-cl-h-path-to-existing-make-file/38109688#38109688", "title": "Add OpenCL CL/cl.h path to existing Make file", "body": "<p>Try changing </p>\n\n<pre><code> CFLAGS += -c -std=c11 -Wall -pedantic -O2\n</code></pre>\n\n<p>to</p>\n\n<pre><code> CFLAGS += -c -std=c11 -Wall -pedantic -O2 -I /usr/include/nvidia-361\n</code></pre>\n"}], "owner": {"reputation": 4778, "user_id": 1917363, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/112f39ececafcaf7321fcfc67be141dd?s=128&d=identicon&r=PG", "display_name": "applecrusher", "link": "https://stackoverflow.com/users/1917363/applecrusher"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 433, "favorite_count": 0, "accepted_answer_id": 38109688, "answer_count": 1, "score": 0, "last_activity_date": 1467245835, "creation_date": 1467230719, "last_edit_date": 1467245835, "question_id": 38109108, "link": "https://stackoverflow.com/questions/38109108/add-opencl-cl-cl-h-path-to-existing-make-file", "title": "Add OpenCL CL/cl.h path to existing Make file", "body": "<p>I am trying to successful execute a make file that comes from a new crytpo-coin called Sia Coin. It can be found here <a href=\"https://github.com/NebulousLabs/Sia-GPU-Miner\" rel=\"nofollow\">Sia Coin GPU Miner</a>. It's relatively new and so some stuff requires more manual installation. I was getting the following error on Ubuntu 16.04 when using the make file. <code>CL/cl.h</code> was missing, and I was able to install and it is located at <code>/usr/include/nvidia-361/CL/cl.h</code>. However, when I ran the make file I still get errors so I think I need to include this path someone in the Make file, the problem is I am not familiar with make files at all. Below is the Make file I need to edit to include the path for compilation:</p>\n\n<pre><code>ifeq ($(shell uname -s),Darwin)\n    CC ?= clang\n    LDLIBS += -lcurl -framework OpenCL\nelse\n    CC ?= gcc\n    LDLIBS += -lOpenCL -lcurl\nendif\n\nCFLAGS += -c -std=c11 -Wall -pedantic -O2\n\nTARGET = sia-gpu-miner\n\nSOURCES = sia-gpu-miner.c network.c\n\nOBJECTS = $(patsubst %.c,%.o,$(SOURCES))\n\nall: $(TARGET)\n\n%.o: %.c\n    $(CC) $(CFLAGS) -o $@ $&lt;\n\n$(TARGET): $(OBJECTS)\n    $(CC) -o $@ $^ $(LDLIBS)\n\nclean:\n    rm -f $(TARGET) $(OBJECTS)\n\n.PHONY: all clean\n</code></pre>\n\n<p>Any help toward solving this problem is greatly appreciated.</p>\n\n<p>Edit:\nA new message I am getting  now adding </p>\n\n<pre><code>CFLAGS += -c -std=c11 -Wall -pedantic -O2 -I /usr/include/nvidia-361\n</code></pre>\n\n<p>is now:</p>\n\n<pre><code>-lOpenCL -lcurl /usr/bin/ld: cannot find -lOpenCL collect2: error: ld returned 1 exit status\n</code></pre>\n\n<p>Two files did compile:</p>\n\n<pre><code>sia-gpu-miner.c\nnetwork.c\n</code></pre>\n\n<p>But I don't know enough to know why the -lOpenCL is not found. No ld directory exists in that directory location in the error if that helps.</p>\n"}, {"tags": ["c", "windows", "gcc", "dll", "mingw"], "comments": [{"owner": {"reputation": 1516, "user_id": 2768172, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/c0aa1896ab14d2afa69d0e13d1bcad2b?s=128&d=identicon&r=PG&f=1", "display_name": "pathoren", "link": "https://stackoverflow.com/users/2768172/pathoren"}, "reply_to_user": {"reputation": 26606, "user_id": 4603670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7eabc1427aa3c8185153cc81978289a?s=128&d=identicon&r=PG&f=1", "display_name": "Barmak Shemirani", "link": "https://stackoverflow.com/users/4603670/barmak-shemirani"}, "edited": false, "score": 0, "creation_date": 1467279091, "post_id": 38108846, "comment_id": 63670344, "body": "Thank you for your comment.  They are indeed built with VS ( I did that myself with CMAKE, VS and msbuild).  However as far as I know I did it in exactly the same way on my other computer (i.e. building the source with CMAKE and VS) and it works there.  I didn&#39;t manage to get CMAKe to work with gcc, which is why I used VS.  For the file Im trying to compile above I&#39;d like to use gcc since the compile command is easy to transfer between Win and Linux.  Maybe the easiest way is to ditch Windows and move to Linux :p"}, {"owner": {"reputation": 26606, "user_id": 4603670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7eabc1427aa3c8185153cc81978289a?s=128&d=identicon&r=PG&f=1", "display_name": "Barmak Shemirani", "link": "https://stackoverflow.com/users/4603670/barmak-shemirani"}, "edited": false, "score": 0, "creation_date": 1467305872, "post_id": 38108846, "comment_id": 63689608, "body": "Sorry I didn&#39;t read your question right, my previous comment doesn&#39;t even make sense. I removed it."}], "owner": {"reputation": 1516, "user_id": 2768172, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/c0aa1896ab14d2afa69d0e13d1bcad2b?s=128&d=identicon&r=PG&f=1", "display_name": "pathoren", "link": "https://stackoverflow.com/users/2768172/pathoren"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 203, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1467229706, "creation_date": 1467229706, "question_id": 38108846, "link": "https://stackoverflow.com/questions/38108846/linking-with-gcc-on-windows", "title": "Linking with gcc on Windows:", "body": "<p>I'm trying to link a c-file (<code>cvode.c</code>) towards a set of .dll files.  I run the following two lines in a cmd:</p>\n\n<pre><code>&gt;&gt;&gt; gcc -c -I C:\\sundials\\inst2\\include cvode.c\n\n&gt;&gt;&gt; gcc -shared -o cvode_lib.dll cvode.o -L. C:\\sundials\\inst2\\lib\\sundials_cvode.dll -L. C:\\sundials\\inst2\\lib\\sundials_nvecserial.dll\n</code></pre>\n\n<p>The first command does not give any errors but the second one gives the following error message:</p>\n\n<pre><code>C:\\sundials\\inst2\\lib\\sundials_cvode.dll: file not recognized: File format not recognized\ncollect2.exe: error: ld returned 1 exit status\n</code></pre>\n\n<p>If I try to import the dll-files with ipython it works perfect, and the same two lines (with the same source files) works perfectly on my second computer running the same OS (windows 10 64bit) with the same version of gcc (installed with the latest Mingw64-installer).  I've also tried to install cygwin64 and compile with its gcc-version, without success.  The file compiles perfectly fine on an Ubuntu computer as well.</p>\n\n<p>I have also tried to link vs the corresponding <code>&lt;sundials&gt;</code>.lib-files but that is not working either.</p>\n\n<p>Googling for solutions has not been successful, maybe because I am not too familiar with c or gcc.  However since it runs perfect on my other Win10 PC I fear it might be something deeper... </p>\n"}, {"tags": ["c", "arrays", "embedded"], "comments": [{"owner": {"reputation": 241, "user_id": 5731628, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-VjD-gt13QCQ/AAAAAAAAAAI/AAAAAAAAAHs/fb3YMM5Ta_c/photo.jpg?sz=128", "display_name": "c_mnon", "link": "https://stackoverflow.com/users/5731628/c-mnon"}, "edited": false, "score": 2, "creation_date": 1467227672, "post_id": 38108068, "comment_id": 63650175, "body": "From your question it seemslike you want to read tha array out when it is full...? Why cant you use a simple flag then.. ?"}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1467227994, "post_id": 38108068, "comment_id": 63650368, "body": "Off the top of my head: use a doubled buffer and fill half part per time. While interrupt writes the second half you can read the first one and so on. You tagged it as embedded, so you can think to use DMAs with two threshold: half and final."}, {"owner": {"reputation": 182, "user_id": 3824857, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/4bnov.png?s=128&g=1", "display_name": "Harry Wright", "link": "https://stackoverflow.com/users/3824857/harry-wright"}, "edited": false, "score": 0, "creation_date": 1467228073, "post_id": 38108068, "comment_id": 63650413, "body": "Apart from the initial period when there is no full array, after the array has been filled once, the readArray will always be full as the pointer just keeps getting swapped when a new array of data is available. I need to know how it&#39;s possible to stop the pointers getting swapped in the middle of a read."}, {"owner": {"reputation": 4888, "user_id": 5785362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a786fd81952576dc07942023bf8830b?s=128&d=identicon&r=PG", "display_name": "tofro", "link": "https://stackoverflow.com/users/5785362/tofro"}, "edited": false, "score": 1, "creation_date": 1467230358, "post_id": 38108068, "comment_id": 63651551, "body": "Actually, I don&#39;t see the point of waiting until the array is fully traversed by the interrupt routine. As long as you make sure your read pointer always <i>stays behind</i> the write pointer, all is well (just busy-wait in your read routine if you come close to the write pointer). This looks like a classical case of a ring buffer (without the ring). This would also allow you much more time to read and copy data."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1467230499, "post_id": 38108068, "comment_id": 63651632, "body": "Presumably the read routine can process the inputs faster than they are written to. It&#39;s usually not good to have one routine try to interfere with another. You could use two buffers (or a 2-d buffer) and when one is full, you can flag the reading part and swap to the other buffer."}, {"owner": {"reputation": 4888, "user_id": 5785362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a786fd81952576dc07942023bf8830b?s=128&d=identicon&r=PG", "display_name": "tofro", "link": "https://stackoverflow.com/users/5785362/tofro"}, "edited": false, "score": 0, "creation_date": 1467230586, "post_id": 38108068, "comment_id": 63651673, "body": "I think that would be overly cautious. Any keyboard or serial buffer is normally programmed that way and I&#39;d say that&#39;s basic tooling in embedded. It&#39;s much more dangerous when the read is not done yet and an interrupt comes in - the interrupt routine can&#39;t simply busy wait."}, {"owner": {"reputation": 3107, "user_id": 3423234, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/49Nfn.gif?s=128&g=1", "display_name": "mfro", "link": "https://stackoverflow.com/users/3423234/mfro"}, "edited": false, "score": 0, "creation_date": 1467233955, "post_id": 38108068, "comment_id": 63653393, "body": "Use a double buffer as already recommended. And, btw., your code will not work with any decent compiler unless you declare your arrays and pointers volatile."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "reply_to_user": {"reputation": 4888, "user_id": 5785362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a786fd81952576dc07942023bf8830b?s=128&d=identicon&r=PG", "display_name": "tofro", "link": "https://stackoverflow.com/users/5785362/tofro"}, "edited": false, "score": 0, "creation_date": 1467293245, "post_id": 38108068, "comment_id": 63680220, "body": "@tofro : What he has illustrated is a &quot;ping-pong&quot; buffer rather than a ring buffer, and not that uncommon.  Often used for DMA buffering and block sampling in signal processing.  We don&#39;t know the application so while a ring buffer is a valid suggestion, it may not match the access pattern.  The pseudocode suggests perhaps the access pattern is random access rather than sequential access."}], "answers": [{"tags": [], "owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "is_accepted": false, "score": 1, "last_activity_date": 1467246465, "last_edit_date": 1467246465, "creation_date": 1467234495, "answer_id": 38110060, "question_id": 38108068, "link": "https://stackoverflow.com/questions/38108068/writing-and-reading-to-arrays-simultaneously/38110060#38110060", "title": "Writing and Reading to arrays simultaneously", "body": "<p>You can use 3 arrays. One that is being written. One that is ready for reading. One that is actually being read. When the reader has consumed its array, it swaps its array for the one that is ready for reading. When the writer has filled an array, it swaps its array for the one that is ready for reading.</p>\n\n<pre><code>int arrayA[128];\nint arrayB[128];\nint arrayC[128];\n\nint *writePointer = arrayA;\nint *readPointer = arrayB;\nint *readReady = arrayC;\n\n/* producer */\nvoid on_interrupt () {\n    int is_full = fill(writePointer);\n    if (is_full) {\n        swap(writePointer, readReady);\n        ready_to_read_set(true);\n        activate_reader();\n    }\n}\n\n/* consumer */\nvoid reader () {\n    swap(readPointer, readReady);\n    ready_to_read_set(false);\n    drain(readPointer);\n}\n</code></pre>\n\n<p>This assumes that if a filled array in ready for reading has not been read yet, there is no problem with swapping it out with a newly filled array.</p>\n\n<p>Your sample doesn't show how the reader waits for input, but whatever mechanism is present can be adapted with this approach at the point the writer swaps in an array that is ready for reading.</p>\n"}, {"tags": [], "owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "is_accepted": false, "score": 1, "last_activity_date": 1467317138, "last_edit_date": 1467317138, "creation_date": 1467282136, "answer_id": 38120329, "question_id": 38108068, "link": "https://stackoverflow.com/questions/38108068/writing-and-reading-to-arrays-simultaneously/38120329#38120329", "title": "Writing and Reading to arrays simultaneously", "body": "<p>I can suggest five patterns (at least) that might suit depending on how you need to access the data, and the data rate.</p>\n\n<ul>\n<li><strong>Disable the interrupt during a read operation</strong> - simple brute force. Minimal changes to your existing code.  Risks loosing data if the read access is too long.</li>\n<li><strong>Spin-lock data consistency</strong> - read the data from the current read buffer and after, check that the read buffer has not been switched - if it has, read again until the read buffer at the start is the same as that at the end.</li>\n<li><strong>Spin-lock synchronisation</strong> - poll a flag that is set at the buffer switch, and read the data at than after time rather than an asynchronous delay.</li>\n<li>If the data is also <em>read</em> sequentially <strong>use a ring buffer</strong>.</li>\n<li>Deploy a preemptive scheduling kernel and <strong>block on a semaphore</strong> that is given by the interrupt when the buffer is ready.  This is similar to the spin-lock synchronisation option but gives you the opportunity to do useful work in other threads while waiting for the data.  In fact the availability of a scheduler (typically an RTOS) provides opportunities for other solutions such as a message queue, but is perhaps a somewhat heavyweight solution in this case.</li>\n</ul>\n\n<p>You can also simplify the interrupt by using a single buffer that is twice the size, and simply assign the read/write pointers to the start and middle of that buffer.  The interrupt can be further optimised by exploiting the length being a power of two.</p>\n\n<h2><strong>Example Spin-lock data consistency:</strong></h2>\n\n<pre><code>#include &lt;stdint.h&gt;\n#include &lt;stdbool.h&gt;\n\n#define BUFFER_LEN (1u&lt;&lt;8) // Ensure a power of two \n#define BUFFER_MODULO_MASK (BUFFER_LEN - 1u)\nvolatile int buffer_array[256];\nvolatile int* buffer[2] = { &amp;buffer_array[0], &amp;buffer_array[BUFFER_LEN / 2] ;\n\ntypedef uint8_t atomic_int_t ;  // Use a type for which read/write is uninterruptable on your target\nvolatile atomic_int_t read_buffer_select = 1 ;\n\nint main()\n{\n    for(;;)\n    {\n        bool data_read = false ;\n        atomic_int_t current_buffer_select = read_buffer_select ;\n        do\n        {\n            // Read operation attempt\n            readfrom( buffer[current_buffer_select] ) ; \n\n            if( current_buffer_select == read_buffer_select )\n            {\n                // Read buffer consistent during read - comeplete\n                data_read = true ;\n            }\n            else\n            {\n                // Read bufer changed during read - try again\n                current_buffer_select = read_buffer_select   \n            }\n\n        } while( !data_read ) ;\n\n        delay(100);\n    }\n}\n\n_interrupt rx() \n{\n    static int index = 0;\n    buffer_array[index] = readVal();\n    index++ ;\n    index &amp;= BUFFER_MODULO_MASK ;\n    if( index == 0 || index == BUFFER_LEN / 2 )\n    { \n        read_buffer_select == 0 ? 1 : 0 ;\n    }\n}\n</code></pre>\n\n<h2><strong>Example spin-lock synchronisation</strong></h2>\n\n<p>As above except for the main loop:</p>\n\n<pre><code>    for(;;)\n    {\n        // Synchronise to buffer completion\n        atomic_int_t current_buffer_select = read_buffer_select ;\n        while( current_buffer_select == read_buffer_select )\n        {\n            // do nothing\n        }\n\n        // Optimum time to read data\n        readfrom( buffer[read_buffer_select] ) ; \n    }\n</code></pre>\n\n<p>Here instead of having an asynchronous delay, the loop waits until the interrupt switched buffers giving you the maximum amount of time possible to read and process the data.</p>\n\n<p>The synchronised method has less potential for data loss - if data loss is an issue, the data-consistency method relies on the delay length being small enough to avoid data loss but long enough to avoid reading the same data twice.  Unless data loss is not an issue, the synchronised method should be preferred.</p>\n\n<p>You can of course combine the two; synchronise the read and then check the read/processing did not take longer than the buffering.  That is perhaps unnecessary - the buffer length should be selected to avoid that.</p>\n\n<p>The other two methods are perhaps more complex in implementation (but more flexible) and it is not clear that they are relevant in this case, so I have not provided an example.</p>\n"}], "owner": {"reputation": 182, "user_id": 3824857, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/4bnov.png?s=128&g=1", "display_name": "Harry Wright", "link": "https://stackoverflow.com/users/3824857/harry-wright"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 198, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1467317138, "creation_date": 1467226946, "question_id": 38108068, "link": "https://stackoverflow.com/questions/38108068/writing-and-reading-to-arrays-simultaneously", "title": "Writing and Reading to arrays simultaneously", "body": "<p>I am currently working on project in which I am using an interrupt to fill an array of 128 values. Each interrupt sequentially updates one value in the array. When the array is full, there will be a short delay, then the process will begin with a batch of new values to fill the array with. The problem comes in that I need to read this array, and I don't want to read it when I am part way through updating the array. \nI have attempted to achieve this in the pseudo-code below, but there is still the problem that the pointers could get swapped halfway through a read.\nDoes anyone have any ideas on a good way to achieve this?</p>\n\n<pre><code>int arrayA[128];\nint arrayB[128];\n\nint *readPointer;\nint *writePointer;\n\nreadPointer = arrayA;\nwritePointer = arrayB;\n\nvoid while(1) {\n   read();\n   delay(100);\n}\n\n_interrupt rx() {\n   static int index = 0;\n   *(writePointer+index) = readVal();\n   index++;\n   if(index==128) {\n      index = 0;\n      temp = writePointer;\n      writePointer = readPointer;\n      readPointer  = temp;\n   }\n}\n\nvoid read() {\n     int myVal = anyValueInArray;\n   }\n}\n</code></pre>\n"}, {"tags": ["c", "optimization"], "comments": [{"owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "edited": false, "score": 1, "creation_date": 1467225871, "post_id": 38107710, "comment_id": 63649105, "body": "Chances are, it would. You wouldn&#39;t expect the compiler to figure it out on its own, do you?"}, {"owner": {"reputation": 398, "user_id": 2351345, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/UqNe3.png?s=128&g=1", "display_name": "CHess", "link": "https://stackoverflow.com/users/2351345/chess"}, "edited": false, "score": 2, "creation_date": 1467226015, "post_id": 38107710, "comment_id": 63649188, "body": "This a simple matter of bench marking the application. My initial thoughts would be that it would be negligible except when N is substantial. Or as Amin Negm-Awad has pointed out in the answer, it would be irrelevant, as the compiler might have done it for you, so long as you have enabled the optimization flags."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1467226101, "post_id": 38107710, "comment_id": 63649250, "body": "What the assembly code has to do with this?"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1467226442, "post_id": 38107710, "comment_id": 63649474, "body": "The <code>(float)</code> casts are unnecessary. Removing them will have no effect on the generated code. However, declaring <code>puls</code> as a <code>float</code> will definitely reduce the accuracy of your results."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1467226579, "post_id": 38107710, "comment_id": 63649545, "body": "You can do much more here. For example calculate <code>i*puls</code> just once per loop. Use a <code>sincos</code> function calculating sine and cosine in the same shot (if available). Replace sine/cosine calculation with a lookup table and so on. But what is the question?"}, {"owner": {"reputation": 1884, "user_id": 3078414, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b1180f5e68d3542488d66de14ff53964?s=128&d=identicon&r=PG&f=1", "display_name": "user3078414", "link": "https://stackoverflow.com/users/3078414/user3078414"}, "edited": false, "score": 1, "creation_date": 1467230396, "post_id": 38107710, "comment_id": 63651570, "body": "Optimization is a rather exact action, dealing with measurement of time and CPU resources consumed and rewriting code with the aim of economizing them. Another point is <i>good programing practice</i>, which would avoid casts and multiplication of constants inside loops. Also, unless dealing with specific real-time code (such as audio) using native format <code>float</code>, use <code>double</code>."}], "answers": [{"comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1467226265, "post_id": 38107817, "comment_id": 63649362, "body": "The example above <i>is not</i> a pre-mature optimization."}, {"owner": {"reputation": 15921, "user_id": 676558, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/PbWyu.png?s=128&g=1", "display_name": "Amin Negm-Awad", "link": "https://stackoverflow.com/users/676558/amin-negm-awad"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1467226309, "post_id": 38107817, "comment_id": 63649394, "body": "You cannot say that, because you do not know, whether it is necessary."}, {"owner": {"reputation": 32686, "user_id": 10396, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ddbfebb47432f6599da361df6a135c7c?s=128&d=identicon&r=PG", "display_name": "AShelly", "link": "https://stackoverflow.com/users/10396/ashelly"}, "edited": false, "score": 0, "creation_date": 1467226401, "post_id": 38107817, "comment_id": 63649454, "body": "And you can not say that it is not, @AminNegm-Awad, because you do not know what the OP has measured."}, {"owner": {"reputation": 15921, "user_id": 676558, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/PbWyu.png?s=128&g=1", "display_name": "Amin Negm-Awad", "link": "https://stackoverflow.com/users/676558/amin-negm-awad"}, "reply_to_user": {"reputation": 32686, "user_id": 10396, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ddbfebb47432f6599da361df6a135c7c?s=128&d=identicon&r=PG", "display_name": "AShelly", "link": "https://stackoverflow.com/users/10396/ashelly"}, "edited": false, "score": 0, "creation_date": 1467226531, "post_id": 38107817, "comment_id": 63649515, "body": "<i>This</i> is correct. @AShelly And that is the reason, why my answer do not stop with this part. I did <i>not</i> say, that it is premature optimization. (However, I said that it is likely, because the compiler detects invariants.) What Eugen said, was definitely wrong. This is the original quotation: <i>Programmers waste enormous amounts of time thinking about, or worrying about, the speed of noncritical parts of their programs, \u2026</i>"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1467226641, "post_id": 38107817, "comment_id": 63649577, "body": "Taking a common factor out of the brackets is a premature optimization?? It is a common sense."}, {"owner": {"reputation": 4516, "user_id": 1937198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b97a3ec92aed1c16e35c1bf532465d6b?s=128&d=identicon&r=PG", "display_name": "user1937198", "link": "https://stackoverflow.com/users/1937198/user1937198"}, "edited": false, "score": 0, "creation_date": 1467226680, "post_id": 38107817, "comment_id": 63649602, "body": "The optimization is invalid given the guarantees major compilers make about floating point, so the compiler will probably not optimize it."}, {"owner": {"reputation": 15921, "user_id": 676558, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/PbWyu.png?s=128&g=1", "display_name": "Amin Negm-Awad", "link": "https://stackoverflow.com/users/676558/amin-negm-awad"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1467226792, "post_id": 38107817, "comment_id": 63649675, "body": "@EugeneSh. Whether something is a premature optimization does not depend on what you are doing. It is premature, if you do it before measuring whether it is necessary."}, {"owner": {"reputation": 15921, "user_id": 676558, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/PbWyu.png?s=128&g=1", "display_name": "Amin Negm-Awad", "link": "https://stackoverflow.com/users/676558/amin-negm-awad"}, "reply_to_user": {"reputation": 4516, "user_id": 1937198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b97a3ec92aed1c16e35c1bf532465d6b?s=128&d=identicon&r=PG", "display_name": "user1937198", "link": "https://stackoverflow.com/users/1937198/user1937198"}, "edited": false, "score": 0, "creation_date": 1467226816, "post_id": 38107817, "comment_id": 63649695, "body": "@user1937198 Yes, this is a good point as I commented in your answer."}, {"owner": {"reputation": 4888, "user_id": 5785362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a786fd81952576dc07942023bf8830b?s=128&d=identicon&r=PG", "display_name": "tofro", "link": "https://stackoverflow.com/users/5785362/tofro"}, "edited": false, "score": 1, "creation_date": 1467731844, "post_id": 38107817, "comment_id": 63838179, "body": "When the OP writes &quot;<i>As a first step i dumped my executable file in order to see the assembler code.</i>&quot; - I would consider that a definitive sign of pre-mature optimization."}], "tags": [], "owner": {"reputation": 15921, "user_id": 676558, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/PbWyu.png?s=128&g=1", "display_name": "Amin Negm-Awad", "link": "https://stackoverflow.com/users/676558/amin-negm-awad"}, "is_accepted": false, "score": 0, "last_activity_date": 1467226112, "creation_date": 1467226112, "answer_id": 38107817, "question_id": 38107710, "link": "https://stackoverflow.com/questions/38107710/c-code-optimization/38107817#38107817", "title": "C code optimization", "body": "<p><em>The root of all evil is premature optimization</em>\n\u2013 Donald Knuth</p>\n\n<p>You should optimize, if you have a problem with execution duration. There are tools that record the duration of every single statement or at least function call.</p>\n\n<p>I think that most compilers detect such constant expressions in a loop and there is nothing to optimize, because it is already optimized.</p>\n"}, {"tags": [], "owner": {"reputation": 163, "user_id": 5216757, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152564319627325/picture?type=large", "display_name": "Oded Har-Tal", "link": "https://stackoverflow.com/users/5216757/oded-har-tal"}, "is_accepted": false, "score": -1, "last_activity_date": 1467226210, "creation_date": 1467226210, "answer_id": 38107849, "question_id": 38107710, "link": "https://stackoverflow.com/questions/38107710/c-code-optimization/38107849#38107849", "title": "C code optimization", "body": "<p>This probably won't change your code performance, since this a standard loop invariants optimization that is performed by any standard compiler (assuming optimizations aren't turned off)..</p>\n"}, {"tags": [], "owner": {"reputation": 4516, "user_id": 1937198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b97a3ec92aed1c16e35c1bf532465d6b?s=128&d=identicon&r=PG", "display_name": "user1937198", "link": "https://stackoverflow.com/users/1937198/user1937198"}, "is_accepted": false, "score": 3, "last_activity_date": 1467226920, "last_edit_date": 1467226920, "creation_date": 1467226258, "answer_id": 38107866, "question_id": 38107710, "link": "https://stackoverflow.com/questions/38107710/c-code-optimization/38107866#38107866", "title": "C code optimization", "body": "<p>The problem is that it is a floating point expression and floating point operations are not commutative. So the optimization is invalid in general for any compiler that follows IEEE 754. So either you have to do this optimization manually, or you have to tell the compiler to treat floating point as commutative for optimization purposes (in gcc and clang you use <code>-ffast-math</code> to do this). This will introduce slight changes in the resulting values.</p>\n\n<p>For comparison of the assembly:</p>\n\n<ul>\n<li><a href=\"https://gcc.godbolt.org/#compilers:!((compiler:g492,options:&#39;-O3&#39;,source:&#39;%23include+%3Cmath.h%3E%0A%0A%23define+ELEMENTS_HALF+2048%0Astruct+%7B%0A+++float+re%3B%0A+++float+im%3B%0A%7D+twiddle_table%5BELEMENTS_HALF%5D%3B%0A%0Avoid+init_twiddle(int+N)%0A%7B%0A++int+i%3D0%3B%0A++for(i%3D0%3B+i%3CELEMENTS_HALF%3B+i%2B%2B)%0A++%7B++++%0A+++++twiddle_table%5Bi%5D.re+%3D+(float)+++cos((float)i+*+2.0+*+M_PI+/+(float)N)%3B%0A+++++twiddle_table%5Bi%5D.im+%3D+(float)+-+sin((float)i+*+2.0+*+M_PI+/+(float)N)%3B%0A++%7D%0A%7D&#39;)),filterAsm:(commentOnly:!t,directives:!t,intel:!t,labels:!t),version:3\" rel=\"nofollow\">Without -ffast-math</a></li>\n<li><a href=\"https://gcc.godbolt.org/#compilers:!((compiler:g492,options:&#39;-O3+-ffast-math&#39;,source:&#39;%23include+%3Cmath.h%3E%0A%0A%23define+ELEMENTS_HALF+2048%0Astruct+%7B%0A+++float+re%3B%0A+++float+im%3B%0A%7D+twiddle_table%5BELEMENTS_HALF%5D%3B%0A%0Avoid+init_twiddle(int+N)%0A%7B%0A++int+i%3D0%3B%0A++for(i%3D0%3B+i%3CELEMENTS_HALF%3B+i%2B%2B)%0A++%7B++++%0A+++++twiddle_table%5Bi%5D.re+%3D+(float)+++cos((float)i+*+2.0+*+M_PI+/+(float)N)%3B%0A+++++twiddle_table%5Bi%5D.im+%3D+(float)+-+sin((float)i+*+2.0+*+M_PI+/+(float)N)%3B%0A++%7D%0A%7D&#39;)),filterAsm:(commentOnly:!t,directives:!t,intel:!t,labels:!t),version:3\" rel=\"nofollow\">With -ffast-math</a></li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 4516, "user_id": 1937198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b97a3ec92aed1c16e35c1bf532465d6b?s=128&d=identicon&r=PG", "display_name": "user1937198", "link": "https://stackoverflow.com/users/1937198/user1937198"}, "edited": false, "score": 0, "creation_date": 1467226788, "post_id": 38108002, "comment_id": 63649673, "body": "If you use the right flags, the compiler can optimise this, including using sincos, and vectorizing."}, {"owner": {"reputation": 38606, "user_id": 23771, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/NeuGc.jpg?s=128&g=1", "display_name": "Mike Dunlavey", "link": "https://stackoverflow.com/users/23771/mike-dunlavey"}, "reply_to_user": {"reputation": 4516, "user_id": 1937198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b97a3ec92aed1c16e35c1bf532465d6b?s=128&d=identicon&r=PG", "display_name": "user1937198", "link": "https://stackoverflow.com/users/1937198/user1937198"}, "edited": false, "score": 0, "creation_date": 1467226840, "post_id": 38108002, "comment_id": 63649720, "body": "@user1937198: Maybe so, and maybe not. Why tempt fate?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 4516, "user_id": 1937198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b97a3ec92aed1c16e35c1bf532465d6b?s=128&d=identicon&r=PG", "display_name": "user1937198", "link": "https://stackoverflow.com/users/1937198/user1937198"}, "edited": false, "score": 1, "creation_date": 1467226928, "post_id": 38108002, "comment_id": 63649772, "body": "@user1937198 Let the compiler do the non-obvious stuff. Do the obvious yourself."}, {"owner": {"reputation": 4516, "user_id": 1937198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b97a3ec92aed1c16e35c1bf532465d6b?s=128&d=identicon&r=PG", "display_name": "user1937198", "link": "https://stackoverflow.com/users/1937198/user1937198"}, "edited": false, "score": 0, "creation_date": 1467226972, "post_id": 38108002, "comment_id": 63649800, "body": "@MikeDunlavey Because how can you write vectorized code in standard C?"}, {"owner": {"reputation": 38606, "user_id": 23771, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/NeuGc.jpg?s=128&g=1", "display_name": "Mike Dunlavey", "link": "https://stackoverflow.com/users/23771/mike-dunlavey"}, "reply_to_user": {"reputation": 4516, "user_id": 1937198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b97a3ec92aed1c16e35c1bf532465d6b?s=128&d=identicon&r=PG", "display_name": "user1937198", "link": "https://stackoverflow.com/users/1937198/user1937198"}, "edited": false, "score": 0, "creation_date": 1467227064, "post_id": 38108002, "comment_id": 63649852, "body": "@user1937198: Hey, if the compiler wants to vectorize, let &#39;er rip. My preference is to ease the burden on the optimizer if it&#39;s practically free."}], "tags": [], "owner": {"reputation": 38606, "user_id": 23771, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/NeuGc.jpg?s=128&g=1", "display_name": "Mike Dunlavey", "link": "https://stackoverflow.com/users/23771/mike-dunlavey"}, "is_accepted": false, "score": 0, "last_activity_date": 1467226796, "last_edit_date": 1467226796, "creation_date": 1467226695, "answer_id": 38108002, "question_id": 38107710, "link": "https://stackoverflow.com/questions/38107710/c-code-optimization/38108002#38108002", "title": "C code optimization", "body": "<p>First of all, use <code>double</code>, not <code>float</code>. In C, library routines are all in <code>double</code>, so you're just doing a lot of converting.</p>\n\n<p>Second, calculate the angle once and put it in a variable, not twice.\nMaybe the compiler recognizes that it can do this for you, but I prefer not to tempt the compiler not to.</p>\n\n<p>Third, is there a <code>sincos</code> function? The sine and cosine functions are closely related, so one can be calculated at the same time as the other.</p>\n\n<p>Fourth, when thinking about performance, switch your brain to thinking in <em>percent of total time</em>, not doing something \"thousands of times\". That way, you will concentrate on what has the greatest overall benefit, not things that might well be irrelevant.</p>\n"}, {"comments": [{"owner": {"reputation": 85, "user_id": 4777353, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10205388417563546/picture?type=large", "display_name": "Anoir Nechi", "link": "https://stackoverflow.com/users/4777353/anoir-nechi"}, "edited": false, "score": 0, "creation_date": 1467227328, "post_id": 38108143, "comment_id": 63649985, "body": "@ tofro your answer look more logical to me. and this is what i will do"}], "tags": [], "owner": {"reputation": 4888, "user_id": 5785362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a786fd81952576dc07942023bf8830b?s=128&d=identicon&r=PG", "display_name": "tofro", "link": "https://stackoverflow.com/users/5785362/tofro"}, "is_accepted": true, "score": 5, "last_activity_date": 1467227202, "creation_date": 1467227202, "answer_id": 38108143, "question_id": 38107710, "link": "https://stackoverflow.com/questions/38107710/c-code-optimization/38108143#38108143", "title": "C code optimization", "body": "<p>Unfortunately, your <em>first step</em> was already kindof wrong.</p>\n\n<p>Don't blindly walk through your code optimizing arbitrary loops which might or (more probably) might not affect performance (maybe because that code is so rarely called that it doesn't really use any run-time). </p>\n\n<p>Optimizing means: You need to find out first <em>where is the time spent in my program</em>? Use timing measurements to narrow down where your program spends most of its time (you can use homegrown logging using us timers or a profiling application for that). Without at least some figures you wouldn't even see where the compiler has already helped you and maybe has already maxed out all possibilities, even if your code looks like it has some potential left for being faster (modern compilers are really very good at that). </p>\n\n<p>Only if you know the hot spots in your application you should start optimizing those.</p>\n"}, {"comments": [{"owner": {"reputation": 38606, "user_id": 23771, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/NeuGc.jpg?s=128&g=1", "display_name": "Mike Dunlavey", "link": "https://stackoverflow.com/users/23771/mike-dunlavey"}, "edited": false, "score": 0, "creation_date": 1467227477, "post_id": 38108183, "comment_id": 63650056, "body": "Your answer is better than mine because you could see what the user was trying to do. No need to call built-in functions more than once."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1467227545, "post_id": 38108183, "comment_id": 63650096, "body": "Well, there are numerous ways to optimize it, if the question is about it. Like calculating a single quadrant only while using the identities like <code>sin(pi&#47;2+x)=cos(x)</code> and so on."}], "tags": [], "owner": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "is_accepted": false, "score": 2, "last_activity_date": 1467227377, "creation_date": 1467227377, "answer_id": 38108183, "question_id": 38107710, "link": "https://stackoverflow.com/questions/38107710/c-code-optimization/38108183#38108183", "title": "C code optimization", "body": "<p>You can do this much faster, indeed you need only 1 sine and 1 cosine (which are disastrously slow). What you're actually doing is calculating the coordinates of a little vector that you spin around the origin, the alternative way to do it is by actually spinning that vector around the origin, one step at the time. The rotation matrix for a single step is what costs the single sine and cosine.</p>\n\n<p>Of course this may be a bit less accurate, but no significant trouble should build up if you make a a reasonable number of steps.</p>\n"}], "owner": {"reputation": 85, "user_id": 4777353, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10205388417563546/picture?type=large", "display_name": "Anoir Nechi", "link": "https://stackoverflow.com/users/4777353/anoir-nechi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 635, "favorite_count": 0, "accepted_answer_id": 38108143, "answer_count": 6, "score": 2, "last_activity_date": 1467227377, "creation_date": 1467225698, "question_id": 38107710, "link": "https://stackoverflow.com/questions/38107710/c-code-optimization", "title": "C code optimization", "body": "<p>I'm trying to optimize some C code, and it's my first time.\nAs a first step i dumped my executable file in order to see the assembler code.\nFor example for this function:</p>\n\n<pre><code>void init_twiddle(int N)\n{\n  int i=0;\n  for(i=0; i&lt;ELEMENTS_HALF; i++)\n  {    \n     twiddle_table[i].re = (float)   cos((float)i * 2.0 * PI / (float)N);\n     twiddle_table[i].im = (float) - sin((float)i * 2.0 * PI / (float)N);\n  }\n}\n</code></pre>\n\n<p>wouldn't be better if i do this instead:</p>\n\n<pre><code>    void init_twiddle(int N)\n{\n  int i=0;\n  float puls = 2.0 * PI / (float)N;\n  for(i=0; i&lt;ELEMENTS_HALF; i++)\n  {    \n     twiddle_table[i].re = (float)   cos((float)i * puls);\n     twiddle_table[i].im = (float) - sin((float)i * puls);\n  }\n</code></pre>\n\n<p>in order to avoid mult and div operation of being repeated thousands of times?\n    }</p>\n"}, {"tags": ["c", "malloc"], "comments": [{"owner": {"reputation": 27690, "user_id": 362589, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/125a471032cdef6e8de28ff6d54c7324?s=128&d=identicon&r=PG", "display_name": "Dani", "link": "https://stackoverflow.com/users/362589/dani"}, "edited": false, "score": 8, "creation_date": 1467224215, "post_id": 38107216, "comment_id": 63648115, "body": "If it&#39;s not in the manual it&#39;s undefined. Why do you ask?"}], "answers": [{"tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": false, "score": 6, "last_activity_date": 1467225725, "last_edit_date": 1467225725, "creation_date": 1467224397, "answer_id": 38107312, "question_id": 38107216, "link": "https://stackoverflow.com/questions/38107216/understanding-a-part-a-the-definition-of-realloc-in-malloc3/38107312#38107312", "title": "Understanding a part a the definition of realloc in malloc(3)", "body": "<p>From <a href=\"http://en.cppreference.com/w/c/memory/realloc\" rel=\"nofollow\">http://en.cppreference.com/w/c/memory/realloc</a> (emphasis mine):</p>\n\n<blockquote>\n  <p>Reallocates the given area of memory. It must be previously allocated by <code>malloc()</code>, <code>calloc()</code> or <code>realloc()</code> and not yet freed with a call to <code>free</code> or <code>realloc</code>.<strong>Otherwise, the results are undefined</strong>.</p>\n</blockquote>\n\n<p>From the C99 standard (emphasis mine):</p>\n\n<blockquote>\n  <p><strong>7.20.3.4 The <code>realloc</code> function</strong></p>\n  \n  <p>3 If <code>ptr</code> is a null pointer, the <code>realloc</code> function behaves like the <code>malloc</code> function for the specified size. Otherwise, if <code>ptr</code> does not match a pointer earlier returned by the <code>calloc</code>, <code>malloc</code>, or <code>realloc</code> function, or if the space has been deallocated by a call to the <code>free</code> or <code>realloc</code> function, <strong>the behavior is undefined</strong>.</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 124, "user_id": 5777040, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7de14ea61424d14535ecaed5d91beae6?s=128&d=identicon&r=PG&f=1", "display_name": "shaul boyer", "link": "https://stackoverflow.com/users/5777040/shaul-boyer"}, "edited": false, "score": 0, "creation_date": 1467227463, "post_id": 38107801, "comment_id": 63650050, "body": "&quot;Because that isn&#39;t there, anything can happen.&quot;. Probably it isn&#39;t there, in case the &quot;illegal&quot; pointer is to the area of the heap, it might be there, and I believe that this is the reason why the behavior is undefined as quoted from C99 in the first answer."}, {"owner": {"reputation": 4888, "user_id": 5785362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a786fd81952576dc07942023bf8830b?s=128&d=identicon&r=PG", "display_name": "tofro", "link": "https://stackoverflow.com/users/5785362/tofro"}, "reply_to_user": {"reputation": 124, "user_id": 5777040, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7de14ea61424d14535ecaed5d91beae6?s=128&d=identicon&r=PG&f=1", "display_name": "shaul boyer", "link": "https://stackoverflow.com/users/5777040/shaul-boyer"}, "edited": false, "score": 0, "creation_date": 1467227690, "post_id": 38107801, "comment_id": 63650184, "body": "@shaulboyer In computer memory, <i>there&#39;s always something there</i> - The dangerous case is when the <i>something</i> is interpreted as something it wasn&#39;t meant to. And that is what happens."}, {"owner": {"reputation": 124, "user_id": 5777040, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7de14ea61424d14535ecaed5d91beae6?s=128&d=identicon&r=PG&f=1", "display_name": "shaul boyer", "link": "https://stackoverflow.com/users/5777040/shaul-boyer"}, "edited": false, "score": 0, "creation_date": 1467228179, "post_id": 38107801, "comment_id": 63650471, "body": "True, this is what I meant, and we can see that in the definition of realloc in C99 that I just glanced at. &quot;if ... or if the space has been deallocated by a call to the free or realloc function, the behavior is undefined.&quot;"}], "tags": [], "owner": {"reputation": 4888, "user_id": 5785362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a786fd81952576dc07942023bf8830b?s=128&d=identicon&r=PG", "display_name": "tofro", "link": "https://stackoverflow.com/users/5785362/tofro"}, "is_accepted": false, "score": 0, "last_activity_date": 1467226738, "last_edit_date": 1467226738, "creation_date": 1467226051, "answer_id": 38107801, "question_id": 38107216, "link": "https://stackoverflow.com/questions/38107216/understanding-a-part-a-the-definition-of-realloc-in-malloc3/38107801#38107801", "title": "Understanding a part a the definition of realloc in malloc(3)", "body": "<p>What happens behind the scene if you hand over a pointer to <code>realloc()</code> or <code>free()</code> that was never given to you my <code>malloc()</code> is that your C library will make some assumptions like maybe being able to find and interpret some memory <em>before</em> the pointer as a block header telling it the length of the block, amongst other things. Because that isn't there, <em>anything</em> can happen.</p>\n\n<p>Memory management will also <em>assume this memory is mine now</em> - If you don't get an immediate crash, you might be getting that stray pointer back from the next <code>malloc()</code> and have to deal with it...</p>\n\n<p>Glibc will normally just barf at you because it tries to detect such cases (But the barfing is part of the undefined behavior as well).</p>\n"}, {"tags": [], "owner": {"reputation": 1884, "user_id": 3078414, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b1180f5e68d3542488d66de14ff53964?s=128&d=identicon&r=PG&f=1", "display_name": "user3078414", "link": "https://stackoverflow.com/users/3078414/user3078414"}, "is_accepted": false, "score": 0, "last_activity_date": 1467231784, "last_edit_date": 1495540349, "creation_date": 1467227378, "answer_id": 38108184, "question_id": 38107216, "link": "https://stackoverflow.com/questions/38107216/understanding-a-part-a-the-definition-of-realloc-in-malloc3/38108184#38108184", "title": "Understanding a part a the definition of realloc in malloc(3)", "body": "<blockquote>\n  <p>And what if we call realloc with ptr that is not NUL, but also, was not returned by an earlier call to malloc(), calloc() or realloc()?</p>\n</blockquote>\n\n<p>It is plainly wrong.</p>\n\n<p>A common beginner's error is attempting to use <code>realloc()</code> on objects, <em>pointers to the first element of which</em> weren't returned by a previous call to a function of the <code>malloc()</code> family. A typical example is passing an automatic array to a function which is supposed to modify its contents, possibly resize it as well by passing object's pointer to <code>realloc</code>. The code would compile, but the program would likely abort. <code>lldb</code> debugger would issue a message such as:</p>\n\n<pre><code>`malloc:  error for object 0x7fff6fbb16d6: pointer being realloc'd was not allocated`\n</code></pre>\n\n<p><code>gdb</code> debugger would issue a similar, though slightly more complex message, such as:</p>\n\n<pre><code>`malloc.c:2869: mremap_chunk: Assertion `((size + offset) &amp; (GLRO (dl_pagesize) - 1)) == 0' failed. `\n`Aborted (core dumped)` \n</code></pre>\n\n<p>This is still a better case. By the book, behavior inferred by such calls is undefined. You may take a look at <code>malloc.c</code> of any operating system. Please, also see <a href=\"https://stackoverflow.com/questions/37989722/using-realloc-to-concat-strings/37990068\">this SO post</a>. This <a href=\"https://en.wikibooks.org/wiki/C_Programming/C_Reference/stdlib.h/malloc\" rel=\"nofollow noreferrer\">reference link</a> may also be worth reading.</p>\n"}], "owner": {"reputation": 124, "user_id": 5777040, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7de14ea61424d14535ecaed5d91beae6?s=128&d=identicon&r=PG&f=1", "display_name": "shaul boyer", "link": "https://stackoverflow.com/users/5777040/shaul-boyer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 174, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1467231784, "creation_date": 1467224084, "last_edit_date": 1467225861, "question_id": 38107216, "link": "https://stackoverflow.com/questions/38107216/understanding-a-part-a-the-definition-of-realloc-in-malloc3", "title": "Understanding a part a the definition of realloc in malloc(3)", "body": "<p>I quote a part of the definition of <code>realloc</code> in malloc(3) \n(<a href=\"http://man.he.net/?topic=malloc&amp;section=all\" rel=\"nofollow\">http://man.he.net/?topic=malloc&amp;section=all</a>) </p>\n\n<blockquote>\n  <p>Unless ptr is NULL, it must have been returned by an earlier call to \n  malloc(),  calloc()  or  realloc().</p>\n</blockquote>\n\n<p>And what if we call <code>realloc</code> with <code>ptr</code> that is not <code>NULL</code>, but also, was not returned by an earlier call to <code>malloc()</code>,  <code>calloc()</code>  or  <code>realloc()</code>?</p>\n\n<p>The behavior of realloc is undefined? Is there another answer? </p>\n"}, {"tags": ["c++", "c", "instantiation"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1467222476, "post_id": 38106718, "comment_id": 63647023, "body": "C and C++ are <b>different</b> languages . C for examples has no <code>new</code> operator. It is not clear what you plan. And C also does not support OOP, i.e. instantiation. Please read a C book."}, {"owner": {"reputation": 31, "user_id": 6520232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/662da92182ee1aa5f4953fad30420613?s=128&d=identicon&r=PG&f=1", "display_name": "user10326", "link": "https://stackoverflow.com/users/6520232/user10326"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1467222531, "post_id": 38106718, "comment_id": 63647059, "body": "And hence the point of my question. Then how do I create a non-dynamically allocated object from C, that is defined in a C++ library?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1467222570, "post_id": 38106718, "comment_id": 63647083, "body": "You cannot. Write a C++ wrapper instead."}, {"owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "edited": false, "score": 0, "creation_date": 1467222586, "post_id": 38106718, "comment_id": 63647096, "body": "@user10326 Why do you assume that you should be able to? They are different languages, after all."}, {"owner": {"reputation": 2771, "user_id": 4163321, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZrgsU.gif?s=128&g=1", "display_name": "Lukas Thomsen", "link": "https://stackoverflow.com/users/4163321/lukas-thomsen"}, "edited": false, "score": 2, "creation_date": 1467222612, "post_id": 38106718, "comment_id": 63647111, "body": "Why don&#39;t you provide a C function within your C++ library which creates the object and returns a <code>void *</code> to it? This hides the <code>new</code> operator to C..."}, {"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 2, "creation_date": 1467222626, "post_id": 38106718, "comment_id": 63647121, "body": "You need to write C++ wrapper functions with C linkage to allow you to <code>new</code> and <code>delete</code> objects."}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 4, "creation_date": 1467222644, "post_id": 38106718, "comment_id": 63647132, "body": "@user10326 <i>&quot;I have found several websites explaining how to create and use wrappers to access the C++ class methods.&quot;</i> And these weren&#39;t giving you sufficient answers?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 2771, "user_id": 4163321, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZrgsU.gif?s=128&g=1", "display_name": "Lukas Thomsen", "link": "https://stackoverflow.com/users/4163321/lukas-thomsen"}, "edited": false, "score": 0, "creation_date": 1467222649, "post_id": 38106718, "comment_id": 63647135, "body": "@LukasThomsen: That would still be a C++ function. Just with a C interface."}, {"owner": {"reputation": 14999, "user_id": 8999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ZD5Uo.jpg?s=128&g=1", "display_name": "Fabio Ceconello", "link": "https://stackoverflow.com/users/8999/fabio-ceconello"}, "edited": false, "score": 0, "creation_date": 1467222679, "post_id": 38106718, "comment_id": 63647153, "body": "You only can do that if you have a C++ compiler to compile the module containing the class. Since IAR EWARM, as you stated, is C only, what will you use to compile the C++ module? Is it g++?"}, {"owner": {"reputation": 2771, "user_id": 4163321, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZrgsU.gif?s=128&g=1", "display_name": "Lukas Thomsen", "link": "https://stackoverflow.com/users/4163321/lukas-thomsen"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1467222684, "post_id": 38106718, "comment_id": 63647155, "body": "@Olaf: Yes but it&#39;ll do the trick... you won&#39;t be able to use the object though..."}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1467228758, "post_id": 38106718, "comment_id": 63650767, "body": "You need to take special care that your C++ library is linked to all the required C++ runtime libraries. Also, a C program normally will not run the C++ runtime code, so you may need to link your C program with the C++ compiler if you need C++ runtime behavior (such as global constructors)."}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 6520232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/662da92182ee1aa5f4953fad30420613?s=128&d=identicon&r=PG&f=1", "display_name": "user10326", "link": "https://stackoverflow.com/users/6520232/user10326"}, "edited": false, "score": 0, "creation_date": 1467223360, "post_id": 38106835, "comment_id": 63647572, "body": "Hi, this is helpful, and thanks. In the calling C program, what do I cast the void pointer to, since my C program doesn&#39;t know about the class? (sorry if that&#39;s a dumb question)"}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "reply_to_user": {"reputation": 31, "user_id": 6520232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/662da92182ee1aa5f4953fad30420613?s=128&d=identicon&r=PG&f=1", "display_name": "user10326", "link": "https://stackoverflow.com/users/6520232/user10326"}, "edited": false, "score": 0, "creation_date": 1467223472, "post_id": 38106835, "comment_id": 63647628, "body": "@user10326 For any operations in the c++ class, you provide c API functions that take the handle, as mentioned. I&#39;ll add a small example."}, {"owner": {"reputation": 4888, "user_id": 5785362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a786fd81952576dc07942023bf8830b?s=128&d=identicon&r=PG", "display_name": "tofro", "link": "https://stackoverflow.com/users/5785362/tofro"}, "edited": false, "score": 3, "creation_date": 1467223606, "post_id": 38106835, "comment_id": 63647715, "body": "An opaque structure pointer would probably be a better choice than a simple <code>void*</code> - You would at least have <i>some</i> type checking."}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "reply_to_user": {"reputation": 4888, "user_id": 5785362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a786fd81952576dc07942023bf8830b?s=128&d=identicon&r=PG", "display_name": "tofro", "link": "https://stackoverflow.com/users/5785362/tofro"}, "edited": false, "score": 1, "creation_date": 1467224069, "post_id": 38106835, "comment_id": 63648001, "body": "@tofro How should it look like? <code>typedef void* scrnDevPtr;</code>? Or using an empty <code>struct</code> as base?"}, {"owner": {"reputation": 4888, "user_id": 5785362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a786fd81952576dc07942023bf8830b?s=128&d=identicon&r=PG", "display_name": "tofro", "link": "https://stackoverflow.com/users/5785362/tofro"}, "edited": false, "score": 0, "creation_date": 1467224651, "post_id": 38106835, "comment_id": 63648390, "body": "simply <code>struct scrnDev; struct scrnDevPtr *ptr;</code> in the C part. There&#39;s nothing more that needs to be known there. The C++ part doesn&#39;t need to be knowing anything more as well, as it&#39;s <code>static_cast</code>ing away the type anyways."}, {"owner": {"reputation": 31, "user_id": 6520232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/662da92182ee1aa5f4953fad30420613?s=128&d=identicon&r=PG&f=1", "display_name": "user10326", "link": "https://stackoverflow.com/users/6520232/user10326"}, "edited": false, "score": 0, "creation_date": 1467225151, "post_id": 38106835, "comment_id": 63648673, "body": "All great information, thanks. One further question with respect to overloaded operators. I have a method with overloaded operators, by number and type of variables. Would each of these methods require a static cast as in the example earlier in this post?"}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "reply_to_user": {"reputation": 31, "user_id": 6520232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/662da92182ee1aa5f4953fad30420613?s=128&d=identicon&r=PG&f=1", "display_name": "user10326", "link": "https://stackoverflow.com/users/6520232/user10326"}, "edited": false, "score": 0, "creation_date": 1467225305, "post_id": 38106835, "comment_id": 63648775, "body": "@user10326 Yes, the static cast is necessary to access any members of the underlying c++ class."}, {"owner": {"reputation": 31, "user_id": 6520232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/662da92182ee1aa5f4953fad30420613?s=128&d=identicon&r=PG&f=1", "display_name": "user10326", "link": "https://stackoverflow.com/users/6520232/user10326"}, "edited": false, "score": 0, "creation_date": 1467225776, "post_id": 38106835, "comment_id": 63649049, "body": "Thanks to everyone who took the time to answer! There is adequate information here to help understand and take a try on it. 8)"}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "reply_to_user": {"reputation": 31, "user_id": 6520232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/662da92182ee1aa5f4953fad30420613?s=128&d=identicon&r=PG&f=1", "display_name": "user10326", "link": "https://stackoverflow.com/users/6520232/user10326"}, "edited": false, "score": 0, "creation_date": 1467225955, "post_id": 38106835, "comment_id": 63649155, "body": "@user10326 De nada ;-). I&#39;ve already earned 50 fake internet points of reputation writing that answer. Well, I think your question is useful for future research."}], "tags": [], "owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "is_accepted": false, "score": 7, "last_activity_date": 1467228558, "last_edit_date": 1495539855, "creation_date": 1467222810, "answer_id": 38106835, "question_id": 38106718, "link": "https://stackoverflow.com/questions/38106718/instantiate-c-object-from-c-using-operator-new/38106835#38106835", "title": "Instantiate C++ object from C using operator new", "body": "<p>The usual way is to create some c++ function that can be called from c and returns a <code>void*</code> handle for the class allocated internally:</p>\n\n<pre><code>extern \"C\" {\n     void* createScrnDev() {\n          return new scrnDev(); \n     } \n}\n</code></pre>\n\n<p>Other functions in this wrapper API would take the handle, and cast it back to the original object instance:</p>\n\n<pre><code>extern \"C\" {\n     void blink(void* scrnDev_) {\n          static_cast&lt;scrnDev*&gt;(scrnDev_)-&gt;blink(); \n     } \n}\n</code></pre>\n\n<p>Finally you'll need a <code>destroy()</code> function to call <code>delete</code> properly:</p>\n\n<pre><code>extern \"C\" {\n     void destroyScrnDev(void* scrnDev_) {\n          delete static_cast&lt;scrnDev*&gt;(scrnDev_); \n     } \n}\n</code></pre>\n\n<hr>\n\n<p>As mentioned in comments you can also use an <a href=\"https://en.wikipedia.org/wiki/Opaque_pointer\" rel=\"nofollow noreferrer\">opaque pointer</a>, that uses a <code>struct</code> declaration  used in both languages:</p>\n\n<p><strong><code>scrnDev.h</code></strong>:</p>\n\n<pre><code> struct scrnDevHandle;\n\n scrnDevHandle* createScrnDev();\n void blink(scrnDevHandle* scrnDev_);\n void destroyScrnDev(scrnDevHandle* scrnDev_);\n</code></pre>\n\n<p><strong><code>scrnDev.cpp</code></strong>:</p>\n\n<pre><code>class scrnDev : public scrnDevHandle {\npublic:\n    scrnDev() {}\n    blink() {\n        // ...\n    }\n};\n\nextern \"C\" {\n     scrnDevHandle * createScrnDev() {\n          return new scrnDev(); \n     } \n     void blink(scrnDevHandle* scrnDev_) {\n          static_cast&lt;scrnDev*&gt;(scrnDev_)-&gt;blink(); \n     } \n     void destroyScrnDev(scrnDevHandle* scrnDev_) {\n          delete static_cast&lt;scrnDev*&gt;(scrnDev_); \n     } \n}\n</code></pre>\n\n<hr>\n\n<p><sub>You might be interested to read some more details about the <code>extern \"C\" {}</code> interfacing <a href=\"https://stackoverflow.com/questions/37927388/shall-external-c-enclose-the-declaration-or-definition-of-a-c-function/37927500#37927500\"><strong>here</strong></a></sub></p>\n"}], "owner": {"reputation": 31, "user_id": 6520232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/662da92182ee1aa5f4953fad30420613?s=128&d=identicon&r=PG&f=1", "display_name": "user10326", "link": "https://stackoverflow.com/users/6520232/user10326"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 848, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1467228667, "creation_date": 1467222403, "last_edit_date": 1467228667, "question_id": 38106718, "link": "https://stackoverflow.com/questions/38106718/instantiate-c-object-from-c-using-operator-new", "title": "Instantiate C++ object from C using operator new", "body": "<p>I have created a C++ program and class, and plan to compile it to a library. I have found several websites explaining how to create and use wrappers to access the C++ class methods.</p>\n\n<p>My environment is IAR EWARM which in my case I need to use standard C. To create class instantiated objects, I am using (or will need to use) operator \"new\", i.e., for class \"scrnDev\": bLink1 = new( scrnDev );    </p>\n\n<p>I have been searching for information on how to instantiate objects using the \"new\" operator from a C program, but unable to find how this can be accomplished.</p>\n"}, {"tags": ["c", "casting"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1467222374, "post_id": 38106479, "comment_id": 63646944, "body": "Please see <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> and provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}], "answers": [{"comments": [{"owner": {"reputation": 177, "user_id": 5583837, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/32b8d999a8d834c1200b21f8445147ae?s=128&d=identicon&r=PG&f=1", "display_name": "man_in_green_shirt", "link": "https://stackoverflow.com/users/5583837/man-in-green-shirt"}, "edited": false, "score": 0, "creation_date": 1467222009, "post_id": 38106566, "comment_id": 63646732, "body": "I&#39;ve tried that but then I get a complaint that <code>u&gt;&gt;16</code> doesn&#39;t fit the range of <code>uint8_t</code> (sorry, there was a typo in the original question)"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 177, "user_id": 5583837, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/32b8d999a8d834c1200b21f8445147ae?s=128&d=identicon&r=PG&f=1", "display_name": "man_in_green_shirt", "link": "https://stackoverflow.com/users/5583837/man-in-green-shirt"}, "edited": false, "score": 0, "creation_date": 1467222121, "post_id": 38106566, "comment_id": 63646794, "body": "What compiler and version are you using?"}, {"owner": {"reputation": 177, "user_id": 5583837, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/32b8d999a8d834c1200b21f8445147ae?s=128&d=identicon&r=PG&f=1", "display_name": "man_in_green_shirt", "link": "https://stackoverflow.com/users/5583837/man-in-green-shirt"}, "edited": false, "score": 0, "creation_date": 1467222225, "post_id": 38106566, "comment_id": 63646849, "body": "I&#39;m writing this in Visual Studio Professional 2012"}, {"owner": {"reputation": 177, "user_id": 5583837, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/32b8d999a8d834c1200b21f8445147ae?s=128&d=identicon&r=PG&f=1", "display_name": "man_in_green_shirt", "link": "https://stackoverflow.com/users/5583837/man-in-green-shirt"}, "edited": false, "score": 0, "creation_date": 1467222478, "post_id": 38106566, "comment_id": 63647026, "body": "Though am running a verification software on the code, which is giving the error, so the problem is probably in the software rather than in the compiler, seeing as the code you suggested is what I&#39;d written. Thanks for your help!"}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 1, "last_activity_date": 1467221875, "creation_date": 1467221875, "answer_id": 38106566, "question_id": 38106479, "link": "https://stackoverflow.com/questions/38106479/type-casting-involving-bit-vector-operations/38106566#38106566", "title": "Type casting involving bit-vector operations", "body": "<p>You need to cast each element to <code>uint8_t</code>:</p>\n\n<pre><code>uint8_t data[3] = {(uint8_t)(u &gt;&gt; 16), (uint8_t)(u &gt;&gt; 8), (uint8_t)(u &amp; 0xff) };\n</code></pre>\n"}], "owner": {"reputation": 177, "user_id": 5583837, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/32b8d999a8d834c1200b21f8445147ae?s=128&d=identicon&r=PG&f=1", "display_name": "man_in_green_shirt", "link": "https://stackoverflow.com/users/5583837/man-in-green-shirt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 23, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1467221978, "creation_date": 1467221539, "last_edit_date": 1467221978, "question_id": 38106479, "link": "https://stackoverflow.com/questions/38106479/type-casting-involving-bit-vector-operations", "title": "Type casting involving bit-vector operations", "body": "<p>Here's my code:</p>\n\n<pre><code>uint8_t data[3] = {u &gt;&gt; 16, u &gt;&gt; 8, u &amp; 0xff };\n</code></pre>\n\n<p><code>u</code> is originally a <code>uint32_t</code>.</p>\n\n<p>How can I cast the right hand side to be uint8_t? I've tried writing <code>(uint8_t)(u &gt;&gt; 16)</code>, but then I get a complaint that <code>u&gt;&gt;16</code> doesn't fit the range of <code>uint8_t</code>.</p>\n"}, {"tags": ["c", "multithreading", "semaphore"], "comments": [{"owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "edited": false, "score": 0, "creation_date": 1467220125, "post_id": 38106018, "comment_id": 63645591, "body": "I think you&#39;re over-thinking it, and not letting <code>main()</code> do its part. At least I would just block each thread and let <code>main()</code> do the signalling."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 5, "creation_date": 1467220180, "post_id": 38106018, "comment_id": 63645635, "body": "There is no reason to use threads this way. If you need to do things sequentially, don&#39;t use threads."}, {"owner": {"reputation": 666, "user_id": 5335013, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/8d9a3be22e0e835073acbb95f14ce945?s=128&d=identicon&r=PG&f=1", "display_name": "Midhun", "link": "https://stackoverflow.com/users/5335013/midhun"}, "edited": false, "score": 0, "creation_date": 1467220453, "post_id": 38106018, "comment_id": 63645808, "body": "Its right that i need not use threads if sequential execution  is needed. But that&#39;s the challenge."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1467220700, "post_id": 38106018, "comment_id": 63645964, "body": "Start by initialising the semaphores."}], "answers": [{"tags": [], "owner": {"reputation": 13767, "user_id": 2413201, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/rxfuw.jpg?s=128&g=1", "display_name": "Armali", "link": "https://stackoverflow.com/users/2413201/armali"}, "is_accepted": false, "score": 0, "last_activity_date": 1469008102, "creation_date": 1469008102, "answer_id": 38477836, "question_id": 38106018, "link": "https://stackoverflow.com/questions/38106018/how-to-change-execution-order-of-two-threads-on-the-basis-of-odd-or-even-number/38477836#38477836", "title": "How to change execution order of two threads on the basis of odd or even number in C?", "body": "<p>You forgot to declare the shared variable <code>cnt</code> as <code>volatile</code>:</p>\n\n<pre><code>volatile int cnt=1;\n</code></pre>\n\n<p>Without <code>volatile</code>, the compiler was allowed to generate code where the variable value is held in a register, and changes by the other thread might not be seen.</p>\n"}], "owner": {"reputation": 666, "user_id": 5335013, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/8d9a3be22e0e835073acbb95f14ce945?s=128&d=identicon&r=PG&f=1", "display_name": "Midhun", "link": "https://stackoverflow.com/users/5335013/midhun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 79, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1469008102, "creation_date": 1467219993, "question_id": 38106018, "link": "https://stackoverflow.com/questions/38106018/how-to-change-execution-order-of-two-threads-on-the-basis-of-odd-or-even-number", "title": "How to change execution order of two threads on the basis of odd or even number in C?", "body": "<p>I have two threads <code>thread1</code>,<code>thread2</code> with routines <code>func1</code>,<code>func2</code> respectively . Now, on the basis of a variable <code>cnt</code> i want to change the execution order of these two threads. That is, if <code>cnt</code> is even then execute <code>func1</code> then <code>func2</code> else if <code>cnt</code> is odd then execute <code>func2</code> then <code>func1</code>.I have to do it when <code>cnt</code> is from 1 to 100.</p>\n\n<p>I have to achieve through the use of semaphores only. I have attempted to solve it using following code. But the code is not good enough.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;pthread.h&gt;\n#include&lt;semaphore.h&gt;\n\nint cnt=1;\nsem_t e_lock,o_lock;\n\nvoid* func1()\n{\n  while(cnt&lt;=100)\n   {\n    if(cnt%2==0)        //if even exec then p1\n    {\n        printf(\"value of count: %d\\n\",cnt);\n        sem_wait(&amp;e_lock);\n        printf(\"even execution, process 1 first\\n\");\n    }else \n    {\n        sem_post(&amp;o_lock);\n        printf(\"odd execution, process 1 second\\n\");\n        cnt++;\n    }\n  }\n}\n\nvoid* func2()\n{\n  while(cnt&lt;=100)\n  {\n    if(cnt%2!=0)        //if odd exec then p1\n    {\n        printf(\"value of count: %d\\n\",cnt);\n        sem_wait(&amp;o_lock);\n        printf(\"odd execution, process 2 first\\n\");\n    }else \n    {\n        sem_post(&amp;e_lock);\n        printf(\"even execution, process 2 second\\n\");\n        cnt++;\n    }\n  }\n}\n void main()\n  {\n\n     pthread_t thread1,thread2;\n\n     pthread_create(&amp;thread1,NULL,func1,NULL);\n     pthread_create(&amp;thread2,NULL,func2,NULL);\n\n     pthread_join(thread1,NULL);\n     pthread_join(thread2,NULL);\n  }\n</code></pre>\n\n<p>Please explain the changes.</p>\n"}, {"tags": ["python", "c", "algorithm", "performance", "optimization"], "comments": [{"owner": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 0, "creation_date": 1467218972, "post_id": 38105132, "comment_id": 63644892, "body": "&quot;implement my own algorithm in C&quot; - yeah, that could be pretty fast if you do it right. &quot;port it to python&quot; - wait, what? <i>Port</i> it? I hope you&#39;re just using the wrong term here, because a Python port would be slow as hell. Optimizing Python is very different from optimizing C."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1467218991, "post_id": 38105132, "comment_id": 63644902, "body": "Minor point: Rather than <code>double* tmp = (double*)malloc(IMG_DIM * RESULT_DIM * sizeof(double));</code>, recommend <code>double* tmp = malloc(sizeof *tmp * IMG_DIM * RESULT_DIM);</code>  1) cast not needed 2) <code>*tmp</code> easier to maintain than <code>double</code> 3) No <code>int</code> overflow issues."}, {"owner": {"reputation": 5746, "user_id": 583570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17472ad659a41e48c4574e01d2312807?s=128&d=identicon&r=PG", "display_name": "markgz", "link": "https://stackoverflow.com/users/583570/markgz"}, "edited": false, "score": 1, "creation_date": 1467220579, "post_id": 38105132, "comment_id": 63645880, "body": "Have you tried using gcc options <code>-march</code> and <code>-mtune</code>?"}, {"owner": {"reputation": 268334, "user_id": 4909087, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/LmD3e.png?s=128&g=1", "display_name": "cs95", "link": "https://stackoverflow.com/users/4909087/cs95"}, "reply_to_user": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 0, "creation_date": 1467220868, "post_id": 38105132, "comment_id": 63646058, "body": "@user2357112 What I mean by &quot;porting&quot; it isn&#39;t a duplication of code in Python, I&#39;ll just be calling the C code through some sort of interface, like types. What&#39;s the right terminology for that?"}, {"owner": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 0, "creation_date": 1467221247, "post_id": 38105132, "comment_id": 63646288, "body": "Yeah, that&#39;s not porting. I&#39;m not sure if there&#39;s a specific term for that; I&#39;d just say &quot;accessing it from Python&quot;. If there was some work on the library&#39;s side to provide a Python interface, I&#39;d say &quot;providing Python bindings&quot;."}, {"owner": {"reputation": 268334, "user_id": 4909087, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/LmD3e.png?s=128&g=1", "display_name": "cs95", "link": "https://stackoverflow.com/users/4909087/cs95"}, "reply_to_user": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 0, "creation_date": 1467223027, "post_id": 38105132, "comment_id": 63647351, "body": "@user2357112: Thanks for letting me know! I&#39;ve edited that part."}, {"owner": {"reputation": 268334, "user_id": 4909087, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/LmD3e.png?s=128&g=1", "display_name": "cs95", "link": "https://stackoverflow.com/users/4909087/cs95"}, "reply_to_user": {"reputation": 5746, "user_id": 583570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17472ad659a41e48c4574e01d2312807?s=128&d=identicon&r=PG", "display_name": "markgz", "link": "https://stackoverflow.com/users/583570/markgz"}, "edited": false, "score": 0, "creation_date": 1467223111, "post_id": 38105132, "comment_id": 63647398, "body": "@markgz: What are those flags? I can&#39;t find anything on the internet about those."}, {"owner": {"reputation": 5746, "user_id": 583570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17472ad659a41e48c4574e01d2312807?s=128&d=identicon&r=PG", "display_name": "markgz", "link": "https://stackoverflow.com/users/583570/markgz"}, "edited": false, "score": 1, "creation_date": 1467308613, "post_id": 38105132, "comment_id": 63691106, "body": "See <a href=\"https://gcc.gnu.org/onlinedocs/gcc/x86-Options.html#index-march-2850\" rel=\"nofollow noreferrer\">gcc.gnu.org/onlinedocs/gcc/x86-Options.html#index-march-2850</a>"}, {"owner": {"reputation": 3723, "user_id": 3731622, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/34ed93a2cf922f7064184109e4b9c16a?s=128&d=identicon&r=PG&f=1", "display_name": "user3731622", "link": "https://stackoverflow.com/users/3731622/user3731622"}, "edited": false, "score": 0, "creation_date": 1487982942, "post_id": 38105132, "comment_id": 72044895, "body": "Depending on your needs it might be worth testing <a href=\"https://docs.scipy.org/doc/scipy-0.16.1/reference/generated/scipy.ndimage.filters.convolve.html#scipy.ndimage.filters.convolve\" rel=\"nofollow noreferrer\">scipy.ndimage.filters.convolve</a> or <a href=\"https://docs.scipy.org/doc/scipy-0.16.1/reference/generated/scipy.signal.fftconvolve.html\" rel=\"nofollow noreferrer\">scipy.signal.fftconvolve</a>.  From some tests I&#39;ve done, both of these can outperform scipy.signal.convolve2d, but it will depend on the size of the two arrays being convolved."}], "answers": [{"comments": [{"owner": {"reputation": 268334, "user_id": 4909087, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/LmD3e.png?s=128&g=1", "display_name": "cs95", "link": "https://stackoverflow.com/users/4909087/cs95"}, "edited": false, "score": 0, "creation_date": 1467217868, "post_id": 38105227, "comment_id": 63644250, "body": "Thanks! I&#39;ll have to read up on SSE, because I haven&#39;t worked with it before. Would you also happen to know of any BLAS/LAPACK routines that can be applied here?"}, {"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "reply_to_user": {"reputation": 268334, "user_id": 4909087, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/LmD3e.png?s=128&g=1", "display_name": "cs95", "link": "https://stackoverflow.com/users/4909087/cs95"}, "edited": false, "score": 0, "creation_date": 1467217937, "post_id": 38105227, "comment_id": 63644298, "body": "Not BLAS/LAPACK, but you might want to look at other libraries, e.g. Intel&#39;s IPP (commercial), or OpenCV (free)."}, {"owner": {"reputation": 268334, "user_id": 4909087, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/LmD3e.png?s=128&g=1", "display_name": "cs95", "link": "https://stackoverflow.com/users/4909087/cs95"}, "edited": false, "score": 0, "creation_date": 1467228664, "post_id": 38105227, "comment_id": 63650722, "body": "So will I have to explicitly write code with SSE? I looked around and it seems gcc automatically generates SSE code with the -O3 flag set."}, {"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "reply_to_user": {"reputation": 268334, "user_id": 4909087, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/LmD3e.png?s=128&g=1", "display_name": "cs95", "link": "https://stackoverflow.com/users/4909087/cs95"}, "edited": false, "score": 1, "creation_date": 1467228847, "post_id": 38105227, "comment_id": 63650802, "body": "gcc and other compilers can <i>sometimes</i> auto-vectorise - it&#39;s even possible that your code is already being vectorised (check the generated code). Humans can generally do better though, especially if the compiler fails to vectorise at all."}], "tags": [], "owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "is_accepted": true, "score": 2, "last_activity_date": 1467219965, "last_edit_date": 1495542717, "creation_date": 1467217441, "answer_id": 38105227, "question_id": 38105132, "link": "https://stackoverflow.com/questions/38105132/fast-2d-convolution-in-c/38105227#38105227", "title": "Fast 2D Convolution in C", "body": "<p>If you're running on x86 only then consider using SSE or AVX SIMD optimisation. For <code>double</code> data the throughput improvement will be modest, but if you can switch to <code>float</code> then you may be able to get to around 4x improvement with SSE or 8x with AVX. There are a number of questions and answers about this very topic on StackOverflow already from which you may be able to get some ideas on the implementation. Alternatively there are also many libraries available which include high performance 2D convolution (filtering) routines, and these typically exploit SIMD for performance, e.g. Intel's IPP (commercial), or OpenCV (free).</p>\n\n<p>Another possibility is to exploit multiple cores - split your image into blocks and run each block in its own thread. E.g. if you have a 4 core CPU then split your image into 4 blocks. (See <a href=\"http://linux.die.net/man/3/pthread_create\" rel=\"nofollow noreferrer\">pthreads</a>).</p>\n\n<p>You can of course combine both of the above ideas, if you really want to fully optimise this operation.</p>\n\n<hr>\n\n<p>Some small optimisations which you can apply to your current code, and to any future implementations (e.g. SIMD):</p>\n\n<ul>\n<li><p>if your kernels are symmetric (or odd-symmetric) then you can reduce the number of operations by adding (subtracting) symmetric input values and performing one multiply rather than two</p></li>\n<li><p>for the separable case, rather than allocating a full frame temporary buffer, consider using a \"strip-mining\" approach - allocate a smaller buffer, which is full width, but a relatively small number of rows, then process your image in \"strips\", alternately applying the horizontal kernel and the vertical kernel. The advantage of this is that you have a much more cache-friendly access pattern and a smaller memory footprint.</p></li>\n</ul>\n\n<hr>\n\n<p>A few comments on coding style:</p>\n\n<ul>\n<li><p>the <code>register</code> keyword has been redundant for many years, and modern compilers will emit a warning if you try to you use it - save yourself some noise (and some typing) by ditching it</p></li>\n<li><p>casting the result of <code>malloc</code> in C is frowned upon - it's <a href=\"https://stackoverflow.com/q/605845/253056\">redundant and potentially dangerous</a>.</p></li>\n<li><p>make any input parameters <code>const</code> (i.e. read-only) and use <code>restrict</code> for any parameters which can never be aliased (e.g. <code>a</code> and <code>result</code>) - this can not only help to avoid programming errors (at least in the case of <code>const</code>), but in some cases it can help the compiler to generate better optimised code (particularly in the case of potentially aliased pointers). </p></li>\n</ul>\n"}], "owner": {"reputation": 268334, "user_id": 4909087, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/LmD3e.png?s=128&g=1", "display_name": "cs95", "link": "https://stackoverflow.com/users/4909087/cs95"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3720, "favorite_count": 1, "accepted_answer_id": 38105227, "answer_count": 1, "score": 5, "last_activity_date": 1467222994, "creation_date": 1467217139, "last_edit_date": 1592644375, "question_id": 38105132, "link": "https://stackoverflow.com/questions/38105132/fast-2d-convolution-in-c", "title": "Fast 2D Convolution in C", "body": "<p>I'm trying to implement a convolutional neural network in Python. Originally, I was using scipy.signal's convolve2d function to do the convolution, but it has a lot of overhead, and it would be faster to just implement my own algorithm in C and call it from python, since I know what my input looks like.</p>\n<p>I've implemented 2 functions:</p>\n<ol>\n<li>Convolving a matrix with a non-separable kernel</li>\n<li>Convolving a matrix with a separable kernel (For now I've assumed python does the rank checking and splitting before passing it onto C)</li>\n</ol>\n<p>Neither of these functions has padding since I require dimensionality reduction.</p>\n<h3>Non-separable 2D Convolution</h3>\n<pre><code>// a - 2D matrix (as a 1D array), w - kernel\ndouble* conv2(double* a, double* w, double* result)\n{\n    register double acc;\n    register int i; \n    register int j;\n    register int k1, k2;\n    register int l1, l2;\n    register int t1, t2;\n\n    for(i = 0; i &lt; RESULT_DIM; i++) \n    {\n        t1 = i * RESULT_DIM; // loop invariants\n        for(j = 0; j &lt; RESULT_DIM; j++) \n        {   \n            acc = 0.0;\n            for(k1 = FILTER_DIM - 1, k2 = 0; k1 &gt;= 0; k1--, k2++)\n            {\n                t2 = k1 * FILTER_DIM;  // loop invariants\n                for(l1 = FILTER_DIM - 1, l2 = 0; l1 &gt;= 0; l1--, l2++)\n                {\n                    acc += w[t2 + l1] * a[(i + k2) * IMG_DIM + (j + l2)];\n                }\n            }\n            result[t1 + j] = acc;\n        }\n    }\n\n    return result;\n}\n</code></pre>\n<h3>Separable 2D Convolution</h3>\n<pre><code>// a - 2D matrix, w1, w2 - the separated 1D kernels\ndouble* conv2sep(double* a, double* w1, double* w2, double* result)\n{\n    register double acc;\n    register int i; \n    register int j;\n    register int k1, k2;\n    register int t;\n    double* tmp = (double*)malloc(IMG_DIM * RESULT_DIM * sizeof(double));\n\n    for(i = 0; i &lt; RESULT_DIM; i++) // convolve with w1 \n    {\n        t = i * RESULT_DIM;\n        for(j = 0; j &lt; IMG_DIM; j++)\n        {\n            acc = 0.0;\n            for(k1 = FILTER_DIM - 1, k2 = 0; k1 &gt;= 0; k1--, k2++)\n            {\n                acc += w1[k1] * a[k2 * IMG_DIM + t + j];\n            }\n            tmp[t + j] = acc;\n        }\n    }\n\n    for(i = 0; i &lt; RESULT_DIM; i++) // convolve with w2\n    {\n        t = i * RESULT_DIM;\n        for(j = 0; j &lt; RESULT_DIM; j++)\n        {\n            acc = 0.0;\n            for(k1 = FILTER_DIM - 1, k2 = 0; k1 &gt;= 0; k1--, k2++)\n            {\n                acc += w2[k1] * tmp[t + (j + k2)];\n            }\n\n            result[t + j] = acc;\n        }\n    }\n\n    free(tmp);\n    return result;\n}\n</code></pre>\n<p>Compiling with gcc's -O3 flag and testing on a 2.7GHz Intel i7, using a 4000x4000 matrix and 5x5 kernel, I get respectively (avg of 5):</p>\n<pre><code>271.21900 ms\n127.32000 ms\n</code></pre>\n<p>This is still a considerable improvement over scipy.signal's convolve2d which takes around 2 seconds for the same operation, but I need more speed since I'll be calling this function thousands of times. Changing the data type to float isn't an option at the moment, even though it'd cause a considerable speedup.</p>\n<p>Is there a way I can optimise these algorithms further? Can I apply any cache tricks or routines to speed it up?</p>\n<p>Any suggestions would be appreciated.</p>\n"}, {"tags": ["c++", "c", "xcode", "image-processing", "tesseract"], "comments": [{"owner": {"reputation": 3134, "user_id": 5475209, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QRBxV.jpg?s=128&g=1", "display_name": "terence hill", "link": "https://stackoverflow.com/users/5475209/terence-hill"}, "edited": false, "score": 0, "creation_date": 1467219369, "post_id": 38104795, "comment_id": 63645130, "body": "It&#39;s hard to answer without details, how do you installed tesseract (binary or source?). What is the exact command line? Which is the example you are trying? And the exact error that is throwing? It&#39;s always better to provide an <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1467222158, "post_id": 38104795, "comment_id": 63646810, "body": "Post the <i>exact</i> errors. Not your interpretation of them."}, {"owner": {"reputation": 133, "user_id": 4605379, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/be7c802cb14bb1a4fc26448fafa5abc0?s=128&d=identicon&r=PG&f=1", "display_name": "koushik v", "link": "https://stackoverflow.com/users/4605379/koushik-v"}, "edited": false, "score": 0, "creation_date": 1467275873, "post_id": 38104795, "comment_id": 63668177, "body": "I installed tesseract on my system using macports and i tried the simple terminal command &quot;tesseract imagename outputfile&quot; and it worked fine.Now, i need to perform the same from my project.The project is a command line project using c++ language in Xcode. I am trying to implement the example given in the link below   [link]<a href=\"https://github.com/tesseract-ocr/tesseract/wiki/APIExample#compiling-c-api-programs-on-linux\" rel=\"nofollow noreferrer\">github.com/tesseract-ocr/tesseract/wiki/&hellip;</a>"}, {"owner": {"reputation": 133, "user_id": 4605379, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/be7c802cb14bb1a4fc26448fafa5abc0?s=128&d=identicon&r=PG&f=1", "display_name": "koushik v", "link": "https://stackoverflow.com/users/4605379/koushik-v"}, "edited": false, "score": 0, "creation_date": 1467276296, "post_id": 38104795, "comment_id": 63668458, "body": "The error i got is many people said different ways to add the library files to to the project. The simplest one was #include &quot;baseapi.h&quot; but when i include the same, it asks for new file called platform.h.Hence,i downloaded the total project from github and added the platform.h but kept the number of files required kept on increasing. Hence,i wondered similar to opencv,i can add the dylib file which comprises of all files.I found the dylib and added to the project. I referenced the library files using #include &lt;Tesseract\\baseapi.h&gt; but it throws an error stating &quot;tesseract\\baseapi.h&quot; not found"}], "owner": {"reputation": 133, "user_id": 4605379, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/be7c802cb14bb1a4fc26448fafa5abc0?s=128&d=identicon&r=PG&f=1", "display_name": "koushik v", "link": "https://stackoverflow.com/users/4605379/koushik-v"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 328, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1467216237, "creation_date": 1467216237, "question_id": 38104795, "link": "https://stackoverflow.com/questions/38104795/tesseract-in-xcode-c-project", "title": "Tesseract in Xcode C++ project", "body": "<p>I installed tesseract on my mac and i have the libtesseract.3.dylib and libtesseract.a.I added these files to the C++ command line project and added the header # include or just #include \"baseapi.h\". It is throwing errors in both the cases. The error is file not found in the former and some other library files are missing in the latter.I added all the header files in the xcode but still it is difficult.Can someone please tell how to include tesseract in Xcode and work with it?</p>\n"}, {"tags": ["c", "simulink", "generated-code"], "comments": [{"owner": {"reputation": 35987, "user_id": 2732801, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YEZ8S.png?s=128&g=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/2732801/daniel"}, "edited": false, "score": 0, "creation_date": 1467366343, "post_id": 38104786, "comment_id": 63714103, "body": "I am not sure what you are asking for. Are you unable to find the place where the actual &quot;or&quot; is evaluated? Maybe replace it with some other operation which is easier to track, for example a multiplication with 123456. You will find probably only one such operation."}, {"owner": {"reputation": 338, "user_id": 4403387, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/27f0c2a1d75348c9fa14a598f8694df1?s=128&d=identicon&r=PG&f=1", "display_name": "Rethipher", "link": "https://stackoverflow.com/users/4403387/rethipher"}, "reply_to_user": {"reputation": 35987, "user_id": 2732801, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YEZ8S.png?s=128&g=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/2732801/daniel"}, "edited": false, "score": 0, "creation_date": 1467422055, "post_id": 38104786, "comment_id": 63740374, "body": "Yes, I can&#39;t find where the or statement is evaluated."}], "owner": {"reputation": 338, "user_id": 4403387, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/27f0c2a1d75348c9fa14a598f8694df1?s=128&d=identicon&r=PG&f=1", "display_name": "Rethipher", "link": "https://stackoverflow.com/users/4403387/rethipher"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1467216205, "creation_date": 1467216205, "question_id": 38104786, "link": "https://stackoverflow.com/questions/38104786/simulink-c-code-generationed-logic", "title": "Simulink C-Code Generationed logic", "body": "<p>simple question here. I would like to examine the generated c code after it has been generated from Simulink. The problem is, I cannot find any of the logic code, or variables from the model. I've looked through the internet for a solution, but there's nothing that really points me in the right direction. Can anybody elaborate on what kind of structure is used when creating auto-generated c code from Simulink? I'd like to look at how the actual logic was created. I made a simple comparison model with three inputs and an or block, and a to-workspace block. Any help is greatly appreciated.</p>\n"}, {"tags": ["c", "parallel-processing", "fork"], "comments": [{"owner": {"reputation": 2505, "user_id": 3118401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c066b73af214d8e7cf6b52f6ef75314a?s=128&d=identicon&r=PG", "display_name": "marcolz", "link": "https://stackoverflow.com/users/3118401/marcolz"}, "edited": false, "score": 0, "creation_date": 1467216116, "post_id": 38104683, "comment_id": 63643088, "body": "Since you do not verify the return value of <code>fork()</code>, I will assume that you will have hit your maximum number of processes."}], "answers": [{"comments": [{"owner": {"reputation": 70793, "user_id": 28128, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/4e974a514f0764fdfe99a8915f192002?s=128&d=identicon&r=PG", "display_name": "David Grayson", "link": "https://stackoverflow.com/users/28128/david-grayson"}, "edited": false, "score": 0, "creation_date": 1467217042, "post_id": 38105003, "comment_id": 63643734, "body": "So to make your program more predicatable, call <code>fflush(stdout);</code> right after each call to <code>printf</code>.  That way, nothing is left in the standard output buffer of your process when you go to fork.  Then you should get 14 As every time."}], "tags": [], "owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "is_accepted": true, "score": 6, "last_activity_date": 1467216777, "creation_date": 1467216777, "answer_id": 38105003, "question_id": 38104683, "link": "https://stackoverflow.com/questions/38104683/a-fork-command/38105003#38105003", "title": "A fork() command", "body": "<p>The reason for the different number of A's is line buffering.</p>\n\n<p>The first version does not print a new-line, so the printf is not actually written out until the program exits.</p>\n\n<p>Since the fork() call duplicates the entire running process it also duplicates the buffered line of A's.</p>\n\n<p>Then as each process exits it flushes its buffers to output.</p>\n\n<p>The second version of the program flushes its output with every printf call because of the new-line and the fact that most C implementations flush the buffers on new-line, if you are printing to a terminal. (It doesn't flush if you're printing to a file or network socket.)</p>\n"}, {"tags": [], "owner": {"reputation": 101, "user_id": 6525127, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hioSo.jpg?s=128&g=1", "display_name": "Apoorva K H", "link": "https://stackoverflow.com/users/6525127/apoorva-k-h"}, "is_accepted": false, "score": 0, "last_activity_date": 1467216867, "creation_date": 1467216867, "answer_id": 38105034, "question_id": 38104683, "link": "https://stackoverflow.com/questions/38104683/a-fork-command/38105034#38105034", "title": "A fork() command", "body": "<p>This happens due to the fact that <em>printf</em> is <em>line-buffered</em> ,  i.e., its buffer gets flushed only upon encountering a new-line.</p>\n\n<p>In the second case, you have put a '\\n' , and thus the expected behavior happens as each time the buffer is getting cleared.</p>\n\n<p>In the first case,</p>\n\n<p>After first fork() : </p>\n\n<pre><code>  Buffer : A\n</code></pre>\n\n<p>After second fork() :</p>\n\n<pre><code>  Buffer : AA\n</code></pre>\n\n<p>After third fork() :</p>\n\n<pre><code>  Buffer : AAA ( 3 A's exist in the buffer )\n</code></pre>\n\n<p>Thus, finally as you have 8 processes totally, 8 * 3 = 24. Therefore 24 A's</p>\n"}], "owner": {"reputation": 55, "user_id": 5806196, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ffb726c7a2468f74fbaab0aed8d4626?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/5806196/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 1, "closed_date": 1467217121, "accepted_answer_id": 38105003, "answer_count": 2, "score": 2, "last_activity_date": 1467216883, "creation_date": 1467215938, "question_id": 38104683, "link": "https://stackoverflow.com/questions/38104683/a-fork-command", "closed_reason": "Duplicate", "title": "A fork() command", "body": "<p>A question was aked about how many A's are to be printed after running the following code in C:</p>\n\n<pre><code>int i;\nfor (i=1;i&lt;4;i++){\n     fork();\n     printf(\"A\");\n}\n</code></pre>\n\n<p>I counted 14 on my own. However, after running it the asnwer turned out to be 24.\nLater I ran an altered version: </p>\n\n<pre><code> int i;\n for (i=1;i&lt;4;i++){\n      fork();\n       printf(\"A\\n\");\n }\n</code></pre>\n\n<p>Which printed 14 A's. I'd love someone to explain this to me. </p>\n"}, {"tags": ["c", "if-statement", "comparison"], "comments": [{"owner": {"reputation": 168120, "user_id": 102937, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1233ec65168f4aae4d939ae8fe6cde1e?s=128&d=identicon&r=PG", "display_name": "Robert Harvey", "link": "https://stackoverflow.com/users/102937/robert-harvey"}, "edited": false, "score": 2, "creation_date": 1467215594, "post_id": 38104445, "comment_id": 63642746, "body": "I rather like your last code example.  It&#39;s very clear what is happening there."}, {"owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "edited": false, "score": 1, "creation_date": 1467215613, "post_id": 38104445, "comment_id": 63642759, "body": "Is it &quot;hackish&quot; just because the work is done after the <code>default</code> label rather than in the fall-throughs? I wouldn&#39;t agree."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1467217047, "post_id": 38104445, "comment_id": 63643740, "body": "With such questions as to what is &quot;most&quot; or &quot;best&quot;,  the best code style, best to maintain style, simplest source code, most portable, fastest, least source code, least executable code, least memory are competing factors.  Being explicit in term of coding goals helps arrive at the best answer.  &quot;Most succinct&quot; sounds like <a href=\"http://codegolf.stackexchange.com\">code golf</a> which I am sure was not the intent."}, {"owner": {"reputation": 4888, "user_id": 5785362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a786fd81952576dc07942023bf8830b?s=128&d=identicon&r=PG", "display_name": "tofro", "link": "https://stackoverflow.com/users/5785362/tofro"}, "edited": false, "score": 1, "creation_date": 1467221119, "post_id": 38104445, "comment_id": 63646211, "body": "I like your second example more as well. Given you provide a &quot;do nothing&quot; comment in the &quot;excludes cases&quot; (which you didn&#39;t) it&#39;s very clear what is going on - Not the least bit of &#39;hackish&#39; IMHO."}, {"owner": {"reputation": 393, "user_id": 5447681, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-x4eEo97ObZI/AAAAAAAAAAI/AAAAAAAABds/FAWIiYKmkjs/photo.jpg?sz=128", "display_name": "Eric Schnipke", "link": "https://stackoverflow.com/users/5447681/eric-schnipke"}, "reply_to_user": {"reputation": 4888, "user_id": 5785362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a786fd81952576dc07942023bf8830b?s=128&d=identicon&r=PG", "display_name": "tofro", "link": "https://stackoverflow.com/users/5785362/tofro"}, "edited": false, "score": 0, "creation_date": 1467221759, "post_id": 38104445, "comment_id": 63646593, "body": "Thanks @tofro, I&#39;ve added your suggestion to improve the question clarity."}], "answers": [{"comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1467215879, "post_id": 38104627, "comment_id": 63642932, "body": "Note, that by default GCC is warning about <code>cases</code> without <code>break</code>."}, {"owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1467216011, "post_id": 38104627, "comment_id": 63643029, "body": "@EugeneSh. Even if it ends with a <code>return</code>? Are you sure?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1467216213, "post_id": 38104627, "comment_id": 63643152, "body": "Umm.. Let me check."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1467216593, "post_id": 38104627, "comment_id": 63643416, "body": "Yeah, you are right, it is not. Was referring to a related issue, when you want to fall-through <i>after</i> doing some case-specific job, like <code>case A: doA(); case B: doB(); break;</code> instead of <code>case A: doAandB(); break; case B: doB(); break;</code>"}, {"owner": {"reputation": 393, "user_id": 5447681, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-x4eEo97ObZI/AAAAAAAAAAI/AAAAAAAABds/FAWIiYKmkjs/photo.jpg?sz=128", "display_name": "Eric Schnipke", "link": "https://stackoverflow.com/users/5447681/eric-schnipke"}, "edited": false, "score": 0, "creation_date": 1467216598, "post_id": 38104627, "comment_id": 63643422, "body": "Thanks for the response @unwind!  I think your solution is very elegant and particularly like the way you expanded the idea to anticipate large comparison sets in your note at the end.  Thanks, again!"}, {"owner": {"reputation": 4888, "user_id": 5785362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a786fd81952576dc07942023bf8830b?s=128&d=identicon&r=PG", "display_name": "tofro", "link": "https://stackoverflow.com/users/5785362/tofro"}, "edited": false, "score": 0, "creation_date": 1467223282, "post_id": 38104627, "comment_id": 63647521, "body": "I like your <code>bsearch()</code> approach for a large number of deflection cases. It does, however have the disadvantage over the <code>switch...case</code> approach that you cannot put the most probable deflection cases (if you have a probability) towards the beginning for speed. In such a case you would want to simply iterate through the array sorted by probability."}, {"owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "reply_to_user": {"reputation": 4888, "user_id": 5785362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a786fd81952576dc07942023bf8830b?s=128&d=identicon&r=PG", "display_name": "tofro", "link": "https://stackoverflow.com/users/5785362/tofro"}, "edited": false, "score": 0, "creation_date": 1467271877, "post_id": 38104627, "comment_id": 63665817, "body": "@tofro I don&#39;t think there&#39;s such a guarantee, that labels closer to the top of the <code>switch</code> will be reached faster. In practice perhaps, for certain compilers etc."}, {"owner": {"reputation": 4888, "user_id": 5785362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a786fd81952576dc07942023bf8830b?s=128&d=identicon&r=PG", "display_name": "tofro", "link": "https://stackoverflow.com/users/5785362/tofro"}, "edited": false, "score": 0, "creation_date": 1467274710, "post_id": 38104627, "comment_id": 63667470, "body": "Nope, the standard makes no guarantee on that, right. Experience with various compilers, however, tells me it&#39;s most often the case (and actually, I can&#39;t see a lot of reasons why a compiler should re-shuffle the order of cases.) Supporting fall-thru obviously <i>requires</i> the compiler to keep the order, though. The proposed variation of your solution (iteration through an array sorted by priority), however, can never be changed by a compiler."}], "tags": [], "owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "is_accepted": true, "score": 8, "last_activity_date": 1467216867, "last_edit_date": 1467216867, "creation_date": 1467215783, "answer_id": 38104627, "question_id": 38104445, "link": "https://stackoverflow.com/questions/38104445/c-most-succinct-way-to-check-if-a-variable-is-none-of-many-options/38104627#38104627", "title": "C - Most succinct way to check if a variable is *none* of many options?", "body": "<p>I think the latter is fine.</p>\n\n<p>You can formalize it better, though:</p>\n\n<pre><code>static bool in_sprawling_set(int data)\n{\n  switch ( data )\n  {\n    case 125:\n    case 500:\n    case 750:\n        return true;\n  }\n  return false;\n}\n</code></pre>\n\n<p>and then where you want to do the work:</p>\n\n<pre><code>if(!in_sprawling_set(data))\n{\n  /* do the work, not in set */\n}\n</code></pre>\n\n<p>This puts the \"in set\" logic in a function of its own, makes it mildly self-documenting, and the actual use-place much cleaner since the <code>!</code> becomes more prominent and the final <code>if</code> is very readable (\"if not in sprawling set\").</p>\n\n<p>Note: if the number of values is really large, I'd probably go for using a pre-sorted array and a binary search, rather than a huge <code>switch</code>. I realize a sufficiently clever compiler can do that transform by itself, but the readability of a huge <code>switch</code> would be rather low (especially if you like to put only one <code>case</code> per line). There's <code>bsearch()</code> for the searching:</p>\n\n<pre><code>static int cmp_int(const void *ap, const void *bp)\n{\n  const int a = *(const int *) ap, b = *(const int *) bp;\n  return a &lt; b ? -1 : a &gt; b;\n}\n\nstatic bool in_sprawling_set(int data)\n{\n  static const int values[] = { 125, 500, 750 };\n  return bsearch(&amp;data, values, sizeof values / sizeof *values, sizeof *values, cmp_int) != 0;\n}\n</code></pre>\n\n<p>There's quite a lot of boilerplate going on, but you can see how the part that lists the actual values (the only thing that'll grow as more values are added) is more compact.</p>\n"}, {"comments": [{"owner": {"reputation": 393, "user_id": 5447681, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-x4eEo97ObZI/AAAAAAAAAAI/AAAAAAAABds/FAWIiYKmkjs/photo.jpg?sz=128", "display_name": "Eric Schnipke", "link": "https://stackoverflow.com/users/5447681/eric-schnipke"}, "edited": false, "score": 0, "creation_date": 1467217131, "post_id": 38104852, "comment_id": 63643795, "body": "Very interesting alternative @chux.  This made me think more deeply about optimizing conditional speed and the implications for my project.  Thanks for the response!"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1467217321, "post_id": 38104852, "comment_id": 63643916, "body": "What would be an advantage over the <i>compare+or</i> approach? I see none. Same number of terms and operators. In addition, the multiplication is not (necessarily) short-circuiting."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 393, "user_id": 5447681, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-x4eEo97ObZI/AAAAAAAAAAI/AAAAAAAABds/FAWIiYKmkjs/photo.jpg?sz=128", "display_name": "Eric Schnipke", "link": "https://stackoverflow.com/users/5447681/eric-schnipke"}, "edited": false, "score": 0, "creation_date": 1467217431, "post_id": 38104852, "comment_id": 63643999, "body": "@Eric Schnipke When speed is important, then one should also consider the set of typical values of <code>data</code>.  Various approaches can be optimized to that set.  Are <code>125,500,750</code> rare or common?  I re-call <a href=\"https://en.wikipedia.org/wiki/GNU_bison\" rel=\"nofollow noreferrer\">bison</a> as tool to make fast parsers"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1467217894, "post_id": 38104852, "comment_id": 63644273, "body": "@Eugene Sh. By &quot; compare+or&quot; I suppose you mean <code>(data == 125) || (data == 500) || (data == 750)</code> - that code can well cause multiple branches - this can be slow on pipelined processors.  Same with  <code>(data == 125) | (data == 500) | (data == 750)</code>. On pipelined processors, lack of short-circuiting is often faster. As in previous comment, speed comparison are affected by the set distribution of `data.  In the end - sometime a smart compiler will make optimal code given various source code."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1467218504, "post_id": 38104852, "comment_id": 63644615, "body": "@Eugene and Eric:  For speed on advanced processors, consider <a href=\"http://stackoverflow.com/a/11227902/2410359\">stackoverflow.com/a/11227902/2410359</a>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 424, "user_id": 6417527, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11b8872b39c0da12993c80aece9a672a?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Smith", "link": "https://stackoverflow.com/users/6417527/michael-smith"}, "edited": false, "score": 0, "creation_date": 1467220302, "post_id": 38104852, "comment_id": 63645708, "body": "@Michael Smith Curious you find <code>if ( (data - 125) * (data - 500) * (data - 750) )</code> quite a bit more overhead than <code>switch ( data ) {     case 125:     case 500:     case 750:         break;      default:         &#47;* ... do stuff ...*&#47;         break;  }</code>  OP&#39; &quot;Most succinct&quot; could be taken as a request for a high performance solution versus a code golf.  Consider a non-branching solution adds value as commented by <a href=\"http://stackoverflow.com/questions/38104445/c-most-succinct-way-to-check-if-a-variable-is-none-of-many-options/38104852?noredirect=1#comment63643795_38104852\">OP</a>"}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": -1, "last_activity_date": 1467216333, "creation_date": 1467216333, "answer_id": 38104852, "question_id": 38104445, "link": "https://stackoverflow.com/questions/38104445/c-most-succinct-way-to-check-if-a-variable-is-none-of-many-options/38104852#38104852", "title": "C - Most succinct way to check if a variable is *none* of many options?", "body": "<blockquote>\n  <p>Is there a more succinct way to check if a single variable is none of many options?</p>\n</blockquote>\n\n<p>The <code>switch()</code> statement is certainly a fine solution.</p>\n\n<p>As an alternative, if the product does not over flow, code could use a single branch test:</p>\n\n<pre><code>unsigned data = foo();\nif ( (data - 125) * (data - 500) * (data - 750) ) {\n  /* ... do stuff as long as data is not 125, 500  or 750 ...*/\n}\n</code></pre>\n\n<p>If it more clear - not really,  Is it faster than <code>switch()</code>? <em>it has potential</em>.</p>\n"}, {"tags": [], "owner": {"reputation": 6192, "user_id": 2041317, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/58b0m.png?s=128&g=1", "display_name": "cup", "link": "https://stackoverflow.com/users/2041317/cup"}, "is_accepted": false, "score": 1, "last_activity_date": 1467221978, "creation_date": 1467221978, "answer_id": 38106608, "question_id": 38104445, "link": "https://stackoverflow.com/questions/38104445/c-most-succinct-way-to-check-if-a-variable-is-none-of-many-options/38106608#38106608", "title": "C - Most succinct way to check if a variable is *none* of many options?", "body": "<p>Instead of negating the condition, you can always use De-morgans laws to simplify the expression</p>\n\n<pre><code>if (data != 125 &amp;&amp; data != 500 &amp;&amp; data != 750) ...\n</code></pre>\n"}], "owner": {"reputation": 393, "user_id": 5447681, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-x4eEo97ObZI/AAAAAAAAAAI/AAAAAAAABds/FAWIiYKmkjs/photo.jpg?sz=128", "display_name": "Eric Schnipke", "link": "https://stackoverflow.com/users/5447681/eric-schnipke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 166, "favorite_count": 0, "accepted_answer_id": 38104627, "answer_count": 3, "score": 4, "last_activity_date": 1467221978, "creation_date": 1467215247, "last_edit_date": 1495542151, "question_id": 38104445, "link": "https://stackoverflow.com/questions/38104445/c-most-succinct-way-to-check-if-a-variable-is-none-of-many-options", "title": "C - Most succinct way to check if a variable is *none* of many options?", "body": "<p><strong>Background:</strong></p>\n\n<p>Often, we developers must check if a single variable is at least one of many options. For example,</p>\n\n<pre><code>if ( (data == 125) || (data == 500) || (data == 750) )\n{\n    /* ... do stuff ...*/\n}\n</code></pre>\n\n<p>The suggestion <a href=\"https://stackoverflow.com/questions/2356949/comparing-a-variable-to-multiple-values\">here</a> (albeit written in C#), provides an elegant solution to use a <code>switch</code> statement like so,</p>\n\n<pre><code>switch ( data )\n{\n    case 125:\n    case 500:\n    case 750:\n        /* ... do stuff ...*/\n        break;\n\n    default:\n        /* ... do nothing ... */\n        break;\n}\n</code></pre>\n\n<p>This works well for \"or\" conditionals, but is ugly for negated \"or\" conditionals like the following,</p>\n\n<pre><code>if ( !( (data == 125) || (data == 500) || (data == 750) ) )\n{\n    /* ... do stuff ...*/\n}\n</code></pre>\n\n<p>which could be written as</p>\n\n<pre><code>switch ( data )\n{\n    case 125:\n    case 500:\n    case 750:\n        /* ... do nothing ... */\n        break;\n\n    default:\n        /* ... do stuff ...*/\n        break;\n\n}\n</code></pre>\n\n<p>and seems a bit hackish.</p>\n\n<p><strong>Question:</strong></p>\n\n<p>Is there a more succinct way to check if a single variable is <em>none</em> of many options, like the negated \"or\" conditional above?</p>\n\n<p><strong>References:</strong></p>\n\n<ul>\n<li><a href=\"https://stackoverflow.com/questions/15181579/c-most-efficient-way-to-compare-a-variable-to-multiple-values\">C++ Most efficient way to compare a variable to multiple values?</a></li>\n<li>C# <a href=\"https://stackoverflow.com/questions/2356949/comparing-a-variable-to-multiple-values\">Comparing a variable to multiple values</a></li>\n</ul>\n"}, {"tags": ["c", "linux", "pipe", "ipc"], "comments": [{"owner": {"reputation": 6192, "user_id": 2041317, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/58b0m.png?s=128&g=1", "display_name": "cup", "link": "https://stackoverflow.com/users/2041317/cup"}, "edited": false, "score": 0, "creation_date": 1467222175, "post_id": 38104214, "comment_id": 63646817, "body": "Try using named pipes.  You can open different named pipes between the parent and as many children as you like."}], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 6495327, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/23622141cf4257866755d5f0e1286e29?s=128&d=identicon&r=PG&f=1", "display_name": "vinwin", "link": "https://stackoverflow.com/users/6495327/vinwin"}, "edited": false, "score": 0, "creation_date": 1467263278, "post_id": 38104295, "comment_id": 63661855, "body": "ya but if I close them, then I read that the EOF won&#39;t be received and hence the receiving end won&#39;t know what is the end point of the input. Right?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 55, "user_id": 6495327, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/23622141cf4257866755d5f0e1286e29?s=128&d=identicon&r=PG&f=1", "display_name": "vinwin", "link": "https://stackoverflow.com/users/6495327/vinwin"}, "edited": false, "score": 0, "creation_date": 1467268661, "post_id": 38104295, "comment_id": 63664016, "body": "@infoseeker If you close the write-end then the read-end will have <code>read</code> return <code>0</code> (which means &quot;other end closed the file/pipe/connection&quot;). If you close the read-end then the write-end will get a <code>SIGPIPE</code> signal, or if you ignore it then <code>write</code> will return <code>-1</code> with <code>errno</code> set to <code>EPIPE</code>."}], "tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": true, "score": 3, "last_activity_date": 1467215752, "last_edit_date": 1467215752, "creation_date": 1467214883, "answer_id": 38104295, "question_id": 38104214, "link": "https://stackoverflow.com/questions/38104214/c-continously-communicate-between-two-child-processes-using-pipes/38104295#38104295", "title": "c - continously communicate between two child processes using pipes", "body": "<p>Right now both the parent and child creates their own pair of pipes, that the other process have no knowledge about.</p>\n\n<p>The pipe should be created in the parent process <strong><em>before</em></strong> the fork.</p>\n\n<p>Also, you close the reading/writing ends of the pipe <em>in the loops</em>, when you should close them after the loop, when all the communication has been done.</p>\n\n<hr>\n\n<p>And a small unrelated issue...</p>\n\n<p>In the reader you should really loop while <code>read</code> doesn't return <code>0</code> (then the write-end of the pipe is closed) or <code>-1</code> (if there's an error).</p>\n"}, {"tags": [], "owner": {"reputation": 23, "user_id": 4786720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/129b2c6d73d6b3f308a445e987f39ded?s=128&d=identicon&r=PG", "display_name": "Khawar", "link": "https://stackoverflow.com/users/4786720/khawar"}, "is_accepted": false, "score": 0, "last_activity_date": 1484777677, "creation_date": 1484777677, "answer_id": 41730402, "question_id": 38104214, "link": "https://stackoverflow.com/questions/38104214/c-continously-communicate-between-two-child-processes-using-pipes/41730402#41730402", "title": "c - continously communicate between two child processes using pipes", "body": "<p>It would be great if you use the shared memory approach. In this approach the parent will allocate a memory area which will be shared among all the processes. Use locks to secure your resource i.e. shared memory. You can also visit this <a href=\"https://www.quora.com/How-do-processes-communicate-with-each-other/answer/Josh-Levine-6?srid=uUVZ\" rel=\"nofollow noreferrer\">answer</a> which details what is the concept behind. Also remember that in shared memory approach the communication can be many-to-many. But in case of pipes it is one-to-one.\nCheers,\nK.\nInfoginx.com</p>\n"}], "owner": {"reputation": 55, "user_id": 6495327, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/23622141cf4257866755d5f0e1286e29?s=128&d=identicon&r=PG&f=1", "display_name": "vinwin", "link": "https://stackoverflow.com/users/6495327/vinwin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1987, "favorite_count": 0, "accepted_answer_id": 38104295, "answer_count": 2, "score": 1, "last_activity_date": 1484777677, "creation_date": 1467214660, "last_edit_date": 1495541338, "question_id": 38104214, "link": "https://stackoverflow.com/questions/38104214/c-continously-communicate-between-two-child-processes-using-pipes", "title": "c - continously communicate between two child processes using pipes", "body": "<p>Just started learning about pipes (IPC in general). After I went through some man pages, websites and few SO questions like <a href=\"https://stackoverflow.com/questions/5225810/is-it-possible-to-have-pipe-between-two-child-processes-created-by-same-parent\">this</a>, <a href=\"https://stackoverflow.com/questions/5225810/is-it-possible-to-have-pipe-between-two-child-processes-created-by-same-parent\">This</a> and few others. I got to know the basic and I see that this communication is done only once, i.e., parent writes to child and child reads it or parent and child reads and writes to each other just once and then the pipe closes.</p>\n\n<p>What I want is keep this communication between the processes without the pipe closing, i.e.,\nsay, my program has 2 child processes where 1st child process is running something in a while loop and the 2nd is running a timer continuously. At certain intervals, my 2nd process sends some 'signal' to 1st child and my 1st stops and prints something at that instant and restarts again for next timer stop. (&lt;-This I have done using threads)</p>\n\n<p>This is the program that I tried just as a sample. But I'm not able to keep the communication continuous.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/types.h&gt;\n\nint main(void)\n{\n    int     fd[2], nbytes, count = 5;\n    pid_t   childpid;\n    char    string[] = \"Hello, world!\\n\";\n    char    readbuffer[80];\n\n    if((childpid = fork()) == -1)\n    {\n            perror(\"fork\");\n            exit(1);\n    }\n\n    if(childpid == 0)\n    {\n            /* Child process closes up input side of pipe */\n\n\n            /* Send \"string\" through the output side of pipe */\n            while(count--)\n            {\n                pipe(fd);\n                close(fd[0]);\n                write(fd[1], string, (strlen(string)+1));\n                close(fd[1]);\n            }\n            exit(0);\n    }\n    else\n    {\n            /* Parent process closes up output side of pipe */\n            while(count--)\n            {\n                pipe(fd);\n                close(fd[1]);\n\n            /* Read in a string from the pipe */\n            nbytes = read(fd[0], readbuffer, sizeof(readbuffer));\n            printf(\"Received string: %s\\n\", readbuffer);\n            close(fd[0]);\n            close(fd[1]);\n            }\n    }\n    int status;\n    waitpid(getppid(), &amp;status, 0);\n\n    printf(\"Done!\\n\");\n\n    return(0);\n</code></pre>\n\n<p>}</p>\n\n<p>From those example, I inferred that the pipe get's closed after each send/read.\nI tried opening new pipe every time, still I could't get it.</p>\n\n<p>Can anyone please help me what am I missing or what should I do?</p>\n"}, {"tags": ["c", "linux", "schedule"], "comments": [{"owner": {"reputation": 18493, "user_id": 388661, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/61df8d728c699c39c4c73507da598712?s=128&d=identicon&r=PG", "display_name": "davmac", "link": "https://stackoverflow.com/users/388661/davmac"}, "edited": false, "score": 0, "creation_date": 1467215678, "post_id": 38104127, "comment_id": 63642799, "body": "There&#39;s no standard way to do this that works across all Linux distributions. You would need to programmatically set up either a Systemd service or an Sysv init script or OpenRC script or whatever else depending on the system in use."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1467217586, "post_id": 38104127, "comment_id": 63644086, "body": "By your definition of the use case the code to start-up the program in question needs to be outside of the program itself. Also you might like to explain why using the cron-daemon could not help you?"}, {"owner": {"reputation": 4046, "user_id": 4971422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4abf51a937ddda51cc6813445605c50?s=128&d=identicon&r=PG&f=1", "display_name": "FredK", "link": "https://stackoverflow.com/users/4971422/fredk"}, "edited": false, "score": 0, "creation_date": 1467218237, "post_id": 38104127, "comment_id": 63644475, "body": "You could have the user optionally add the execution command to their .profile file. Possibly wrap in an if-block to check if it is already running and owned by that user."}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 0, "creation_date": 1467270615, "post_id": 38104127, "comment_id": 63665077, "body": "There are at least three different stages at which processes can be launched automatically. 1) the system startup, or service level, which happens before any users are logged in. Normally, human-owned processes are not started yet, only general services. 2) GUI login, when a human user logs in to a graphical desktop environment. The programs that are started at this point is usually called <i>&quot;the session&quot;</i> or <i>&quot;X session&quot;</i>. If you always see e.g. an open browser when you logged in, that browser is in your session. 3) when logging in via a shell (terminal, SSH), applications can be run ..."}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 0, "creation_date": 1467270806, "post_id": 38104127, "comment_id": 63665184, "body": "... as part of that user&#39;s shell startup scripts. (There are several options, ranging from running whenever a new shell is started, to only running if the shell is interactive, to only running if the shell is a login shell.) All of these are dependent on the Linux distribution (desktop environment, set of support services and applications used), so there is little sense in doing this &quot;programmatically&quot;. I suspect (2) is the most likely one for you here; the best solution would be to tell the user to add your program to <i>&quot;startup applications&quot;</i> or the <i>&quot;x session&quot;</i>."}], "answers": [{"tags": [], "owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "is_accepted": true, "score": 1, "last_activity_date": 1467215508, "creation_date": 1467215508, "answer_id": 38104528, "question_id": 38104127, "link": "https://stackoverflow.com/questions/38104127/start-application-at-startup-linux-programmatically/38104528#38104528", "title": "Start application at startup linux Programmatically", "body": "<blockquote>\n  <p>if the user selected auto-startup, then (code I am looking for)</p>\n</blockquote>\n\n<p>One way is to add a cron job to that user's crontab with special time specification <code>@reboot</code>.</p>\n"}], "owner": {"reputation": 220, "user_id": 5520336, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4b051c0e210cafeec4d3d07c17fa5edb?s=128&d=identicon&r=PG&f=1", "display_name": "richerarc", "link": "https://stackoverflow.com/users/5520336/richerarc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 130, "favorite_count": 0, "accepted_answer_id": 38104528, "answer_count": 1, "score": 0, "last_activity_date": 1468059897, "creation_date": 1467214450, "last_edit_date": 1468059897, "question_id": 38104127, "link": "https://stackoverflow.com/questions/38104127/start-application-at-startup-linux-programmatically", "title": "Start application at startup linux Programmatically", "body": "<p>I'm making a program in C that has the option (for the user) to launch automatically at Linux startup. I'm looking for a code snippet or something helpful. The way I want to do it, is programmatically <code>if the user selected auto-startup, then (code I am looking for)</code></p>\n\n<p>I saw many thing about cron jobs and <code>/etc/rd.somethings</code>, but it doesn't seems to be what I'm looking for.</p>\n"}, {"tags": ["c", "linux"], "comments": [{"owner": {"reputation": 7787, "user_id": 1257035, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WHLC8.png?s=128&g=1", "display_name": "a3f", "link": "https://stackoverflow.com/users/1257035/a3f"}, "edited": false, "score": 0, "creation_date": 1467214302, "post_id": 38103994, "comment_id": 63641800, "body": "What&#39;s the value of <code>errno</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 6427196, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63dcf5ddca5e6d9d3c3b3f41b7d98fc0?s=128&d=identicon&r=PG&f=1", "display_name": "yapy horenfeld", "link": "https://stackoverflow.com/users/6427196/yapy-horenfeld"}, "edited": false, "score": 1, "creation_date": 1467216714, "post_id": 38104853, "comment_id": 63643510, "body": "<code>grep CONFIG_USER_NS &#47;boot&#47;config-$(uname -r)</code> return nothing , and <code>unshare</code>  seems like it&#39;s work..."}, {"owner": {"reputation": 1585, "user_id": 421550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e7a2292ef4ad3674b556df31e81efce?s=128&d=identicon&r=PG", "display_name": "domen", "link": "https://stackoverflow.com/users/421550/domen"}, "edited": false, "score": 0, "creation_date": 1497279317, "post_id": 38104853, "comment_id": 75998668, "body": "@P.P could you confirm this: I believe there&#39;s a typo in your post. CLONE_NEWUSER depends on CONFIG_USER_NS being enabled, so I think there&#39;s a &quot;not&quot; missing there."}, {"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "reply_to_user": {"reputation": 1585, "user_id": 421550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e7a2292ef4ad3674b556df31e81efce?s=128&d=identicon&r=PG", "display_name": "domen", "link": "https://stackoverflow.com/users/421550/domen"}, "edited": false, "score": 0, "creation_date": 1497280300, "post_id": 38104853, "comment_id": 75999342, "body": "@domen Indeed. Corrected it. Thanks."}], "tags": [], "owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "is_accepted": false, "score": 2, "last_activity_date": 1497280284, "last_edit_date": 1497280284, "creation_date": 1467216338, "answer_id": 38104853, "question_id": 38103994, "link": "https://stackoverflow.com/questions/38103994/why-unshareclone-newuser-return-error-linux/38104853#38104853", "title": "Why unshare(CLONE_NEWUSER) return error? (linux)", "body": "<p>Most likely because your kernel is not configured to support <code>CONFIG_USER_NS</code>.</p>\n\n<p>I reckon running the command:</p>\n\n<pre><code>unshare -U\n</code></pre>\n\n<p>also produces the same error on your machine. </p>\n\n<p>You can verify that with the command:</p>\n\n<pre><code>grep CONFIG_USER_NS /boot/config-$(uname -r)\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 6427196, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63dcf5ddca5e6d9d3c3b3f41b7d98fc0?s=128&d=identicon&r=PG&f=1", "display_name": "yapy horenfeld", "link": "https://stackoverflow.com/users/6427196/yapy-horenfeld"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1645, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1541564402, "creation_date": 1467214128, "last_edit_date": 1541564402, "question_id": 38103994, "link": "https://stackoverflow.com/questions/38103994/why-unshareclone-newuser-return-error-linux", "title": "Why unshare(CLONE_NEWUSER) return error? (linux)", "body": "<p>This is my fairly simple code:</p>\n\n<pre><code> #define _GNU_SOURCE\n #include &lt;sched.h&gt;\n #include &lt;errno.h&gt;\n #include &lt;stdio.h&gt;\n\n int main(){\n   int res= unshare(CLONE_NEWUSER);\n   printf(\"res:%d\\n\",res);\n   perror(\"error\");\n   return 0;\n}\n</code></pre>\n\n<p>Why does the code always fail (return -1)? </p>\n\n<p>I'm on <code>Ubunto 13.04</code> this is my kernel version and other details:</p>\n\n<pre><code>Linux ubuntu 3.10.37-031037-generic #201404141035 SMP Mon Apr 14 14:55:40 UTC 2014 i686 i686 i686 GNU/Linux\n</code></pre>\n\n<ul>\n<li>errno returns <code>Invalid argument</code></li>\n</ul>\n\n<p>this is the output of the program :</p>\n\n<pre><code>res:-1\nerror: Invalid argument\n</code></pre>\n"}, {"tags": ["c", "list", "sorting", "bubble-sort"], "comments": [{"owner": {"reputation": 31113, "user_id": 112079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3ccb721ddaf2f6e7dccc66262f406b1?s=128&d=identicon&r=PG&f=1", "display_name": "fvu", "link": "https://stackoverflow.com/users/112079/fvu"}, "edited": false, "score": 0, "creation_date": 1467211825, "post_id": 38103032, "comment_id": 63640016, "body": "In it&#39;s present form this is a &quot;why isn&#39;t this code working&quot; type question, which should be closed as offtopic. Did you try running the code in a debugger to see why it stops?"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 6330642, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207761269443939/picture?type=large", "display_name": "Francesco Ficara", "link": "https://stackoverflow.com/users/6330642/francesco-ficara"}, "edited": false, "score": 0, "creation_date": 1467213715, "post_id": 38103486, "comment_id": 63641349, "body": "sorry I can&#39;t understand that. Corr is l-&gt;head at the beginning of the inner loop, then it change to the next element of the list and so on.. After that I reset corr=l-&gt;head at the beginning of every while(scambio==1) loop. What am I missing?"}, {"owner": {"reputation": 21, "user_id": 6330642, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207761269443939/picture?type=large", "display_name": "Francesco Ficara", "link": "https://stackoverflow.com/users/6330642/francesco-ficara"}, "edited": false, "score": 0, "creation_date": 1467214626, "post_id": 38103486, "comment_id": 63642008, "body": "I understood what you were saying and I added &quot;if (corr==l-&gt;head) l-&gt;head=succ;&quot; at the beginning of the inner loop but it doesn&#39;t change anything."}, {"owner": {"reputation": 83283, "user_id": 3937, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/e27f554e9ed800bca61642acaba29452?s=128&d=identicon&r=PG", "display_name": "Lou Franco", "link": "https://stackoverflow.com/users/3937/lou-franco"}, "reply_to_user": {"reputation": 21, "user_id": 6330642, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207761269443939/picture?type=large", "display_name": "Francesco Ficara", "link": "https://stackoverflow.com/users/6330642/francesco-ficara"}, "edited": false, "score": 0, "creation_date": 1467225625, "post_id": 38103486, "comment_id": 63648959, "body": "It&#39;s more than that -- When you swap corr and succ, the element that used to point to corr needs to have its next set to succ.  I pointed out the l-&gt;head case, but it applies generally to corr&#39;s previous element (it needs to be reset to succ when swapping)"}], "tags": [], "owner": {"reputation": 83283, "user_id": 3937, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/e27f554e9ed800bca61642acaba29452?s=128&d=identicon&r=PG", "display_name": "Lou Franco", "link": "https://stackoverflow.com/users/3937/lou-franco"}, "is_accepted": false, "score": 0, "last_activity_date": 1467226781, "last_edit_date": 1467226781, "creation_date": 1467212797, "answer_id": 38103486, "question_id": 38103032, "link": "https://stackoverflow.com/questions/38103032/c-list-sort-code-not-working/38103486#38103486", "title": "C: List sort code not working", "body": "<p>When you are swapping, if <code>corr</code> is <code>l-&gt;head</code> then you need to reset <code>l-&gt;head</code> to <code>succ</code>. If you don't, then the next time through the loop, the sort will start from wherever <code>l-&gt;head</code> ended up after the first pass.</p>\n\n<p>Also, you will be losing (and leaking) part of the list.</p>\n\n<p>EDIT: More from comments</p>\n\n<p>It applies generally to <code>corr</code>'s previous element (it needs to be reset to <code>succ</code> when swapping)</p>\n"}, {"tags": [], "owner": {"reputation": 22874, "user_id": 3282056, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/IXonK.jpg?s=128&g=1", "display_name": "rcgldr", "link": "https://stackoverflow.com/users/3282056/rcgldr"}, "is_accepted": false, "score": 0, "last_activity_date": 1467243016, "creation_date": 1467243016, "answer_id": 38111708, "question_id": 38103032, "link": "https://stackoverflow.com/questions/38103032/c-list-sort-code-not-working/38111708#38111708", "title": "C: List sort code not working", "body": "<p>There's no need to allocate an instance of elem_t. When swapping elements, there's an issue if one of the elements is the first one in the list, or if the elements are adjacent elements. Using pointers to pointer to element can reduce the number of if statements. A pointer to pointer could be the address of head or the address of a nodes next pointer.</p>\n\n<p>To implement a swap, first swap whatever points to the two nodes (could be head or a node next pointer), then swap the two nodes next pointers. This will take care of the adjacent versus not adjacent node issue.</p>\n"}], "owner": {"reputation": 21, "user_id": 6330642, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207761269443939/picture?type=large", "display_name": "Francesco Ficara", "link": "https://stackoverflow.com/users/6330642/francesco-ficara"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 82, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1467243016, "creation_date": 1467211633, "last_edit_date": 1467212813, "question_id": 38103032, "link": "https://stackoverflow.com/questions/38103032/c-list-sort-code-not-working", "title": "C: List sort code not working", "body": "<p>I cannot figure out why my code to sort the elements of a list does not work, it sort the first 5 element of the list and then just stop. I know it may be a stupid problem but I checked the loop a lot of time and can't understand why it reach the exit before the end of the list.  </p>\n\n<pre><code>typedef enum { NOTORD=0, TIME=1, POSITION=2  } ord_t;\n\n\ntypedef struct elem {\n  double position;\n  double time;\n  flag_t flag;\n  struct elem * next;\n} elem_t;\n\ntypedef struct {\n  elem_t * head;\n  int nelem; \n  ord_t ord; \n} lista_t;\n\n\nvoid set_ordinata_time (lista_t * l) \n{\nif (l-&gt;ord!=TIME) {\n    elem_t * aux, *corr, *succ;\n    int scambio;\n    corr=l-&gt;head;\n    succ=l-&gt;head-&gt;next;\n    aux=malloc(sizeof(elem_t));\n    scambio=1;\n    while(scambio==1)\n    {\n        corr=l-&gt;head;\n        succ=l-&gt;head-&gt;next;\n        scambio=0;\n        while(succ != NULL)\n        {\n            if (corr-&gt;time &gt; succ-&gt;time)\n            {\n                aux=corr;\n                aux-&gt;next=succ-&gt;next;\n                corr=succ;\n                succ=aux;\n                corr-&gt;next=succ;\n                scambio=1;\n            }\n            corr=succ; succ=succ-&gt;next;\n        }\n    }\n    l-&gt;ord=TIME;\n}\n\n}\n</code></pre>\n"}, {"tags": ["c", "deadlock", "semaphore", "shared-memory", "posix-api"], "answers": [{"comments": [{"owner": {"reputation": 1073, "user_id": 3025555, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/3ccd8b728b1fcaef8ad6b4526dec433a?s=128&d=identicon&r=PG&f=1", "display_name": "Adiel", "link": "https://stackoverflow.com/users/3025555/adiel"}, "edited": false, "score": 0, "creation_date": 1467213857, "post_id": 38102769, "comment_id": 63641465, "body": "that did the trick. i thought sem_unlink only unlinks the name itself, waiting for any child processes to exit before destroying the semaphore. More interesting - how come <b>sem_wait</b> is just blocked, and not returning error with <i>errno</i> set to EINVAL ??"}, {"owner": {"reputation": 755, "user_id": 5295802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b667253d9b84a8154a93254e7050c72?s=128&d=identicon&r=PG&f=1", "display_name": "Sander", "link": "https://stackoverflow.com/users/5295802/sander"}, "reply_to_user": {"reputation": 1073, "user_id": 3025555, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/3ccd8b728b1fcaef8ad6b4526dec433a?s=128&d=identicon&r=PG&f=1", "display_name": "Adiel", "link": "https://stackoverflow.com/users/3025555/adiel"}, "edited": false, "score": 0, "creation_date": 1467279755, "post_id": 38102769, "comment_id": 63670828, "body": "EINVAL would make more sense here. The sem_unlink/sem_wait manpages are not exactly clear on this, but my guess is that the sem_t struct that shared_sem_name is pointing to is undefined after sem_unlink() (i.e. anything can be in there and it should no longer be trusted), and that this memory block is still making up a valid semaphore struct."}, {"owner": {"reputation": 1073, "user_id": 3025555, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/3ccd8b728b1fcaef8ad6b4526dec433a?s=128&d=identicon&r=PG&f=1", "display_name": "Adiel", "link": "https://stackoverflow.com/users/3025555/adiel"}, "edited": false, "score": 0, "creation_date": 1467472429, "post_id": 38102769, "comment_id": 63751358, "body": "After switching to posix memory mapping (but still using sem_open etc) the problem persists unfortunately  Hoping maybe you&#39;ve got another idea?"}], "tags": [], "owner": {"reputation": 755, "user_id": 5295802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b667253d9b84a8154a93254e7050c72?s=128&d=identicon&r=PG&f=1", "display_name": "Sander", "link": "https://stackoverflow.com/users/5295802/sander"}, "is_accepted": false, "score": 2, "last_activity_date": 1467210932, "creation_date": 1467210932, "answer_id": 38102769, "question_id": 38102482, "link": "https://stackoverflow.com/questions/38102482/deadlock-using-named-semaphore/38102769#38102769", "title": "Deadlock using named semaphore", "body": "<p>In the function init_procedure() after opening the semaphore, there is a function call </p>\n\n<pre><code>sem_unlink(shared_sem_name);\n</code></pre>\n\n<p>which is always executed, destroying the semaphore immediately after its creation. You want this line in your error handling block. </p>\n"}, {"tags": [], "owner": {"reputation": 1073, "user_id": 3025555, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/3ccd8b728b1fcaef8ad6b4526dec433a?s=128&d=identicon&r=PG&f=1", "display_name": "Adiel", "link": "https://stackoverflow.com/users/3025555/adiel"}, "is_accepted": true, "score": 1, "last_activity_date": 1467477882, "creation_date": 1467477882, "answer_id": 38162368, "question_id": 38102482, "link": "https://stackoverflow.com/questions/38102482/deadlock-using-named-semaphore/38162368#38162368", "title": "Deadlock using named semaphore", "body": "<p><strong>Solution found</strong>:</p>\n\n<p>When creating named semaphore in main file, permissions were set to 0644,\nwhich given the process group only read permission.</p>\n\n<p>After changing to the following :</p>\n\n<pre><code>sem_open(semaphore_name, O_CREAT, S_IRUSR | S_IWUSR | S_IRGRP | S_IWGRP, 1)\n</code></pre>\n\n<p>The problem seems to be solved!\nApparently if sem_wait is called without having read\\write permissions on the semaphore (which happend in child process - they used the semaphore with READ permission only) behaviour is undefined</p>\n"}], "owner": {"reputation": 1073, "user_id": 3025555, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/3ccd8b728b1fcaef8ad6b4526dec433a?s=128&d=identicon&r=PG&f=1", "display_name": "Adiel", "link": "https://stackoverflow.com/users/3025555/adiel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 731, "favorite_count": 0, "accepted_answer_id": 38162368, "answer_count": 2, "score": 0, "last_activity_date": 1467477882, "creation_date": 1467210205, "last_edit_date": 1467472338, "question_id": 38102482, "link": "https://stackoverflow.com/questions/38102482/deadlock-using-named-semaphore", "title": "Deadlock using named semaphore", "body": "<p>i'm trying my first run with shared memory and named semaphore to sync access to it.</p>\n\n<p>My program had 3 processes - Parent one, and two childs, all must use the same\nshared memory. in order to sync between them, i'm using named sempahore.\nthe resource which they share is a 3 integers array, when <strong>array[0] - exit flag location</strong>, which the child process read before they operate in order to determine if parent process wants to exit.\n<strong>array[1], array[2] - are used to communicate with parent process</strong> , each process places a message in his own array cell, and the parent process reads it, and places an <strong>ACK</strong> message in respone.</p>\n\n<p>I'm trying to get a basic work flow of my code - make all necessary resources, make parent sleep for 3 seconds, and then initiate the exit_procedure.</p>\n\n<p>My problem is, when getting to the <em>exit_procedure</em>, the main process blocks forever on <strong>sem_wait() operation</strong> - apparently deadlock.\nI'm trying to figure out the problem and can't seem to pin point it.\nI'm new to process synchronization - until this code i've synced threads only.</p>\n\n<p><strong>UPDATE</strong>:\nI've switched using POSIX memory mapping, and now i've got the same deadlock issue. relevant methods in process_api.h can't get a hold of the lock, they just block forever. i don't know what am i doing wrong. \nCan some please assist?</p>\n\n<p>My code:</p>\n\n<p><strong>main file:</strong></p>\n\n<pre><code>int *shmem_p;       //!&lt; Shared variable to be used across different proccesses\nint shmem_fd;       //!&lt; Shared memory id\nsem_t *sem_p;       //!&lt; Sempahore for syncronizing access to shared memory\n\nvolatile sig_atomic_t done;         //!&lt; An atomic flag to signal this process threads they are done\nvolatile sig_atomic_t signal_rcvd;  //!&lt; Indication to exit procedure if a signal caused termination\n\n/**\n * @brief Exit procedure to be called when program is done\n */\nstatic void exit_procedure()\n{\n    block_all_signals();            /* Block all signals - we're already existing */\n\n    if(signal_rcvd == SIGTERM) {    /* SIGTERM is manually raised by us when a thread terminates, thus not handled in signal handler */\n        write(STDERR_FILENO, \"Error occured - thread terminated\\n\", 33);\n    }\n\n    if( !signal_rcvd ) {            /* We got here normally, or by thread termination - set done flag */\n        done = true;\n    }\n\n    /* Free all relevant resources */\n    sem_unlink(\"/shmemory\");\n    sem_close(sem_p);\n\n    munmap(shmem_p, TOTAL_PROC_NUM*sizeof(int));\n    shm_unlink(\"/shmemory\");\n\n    sem_p = NULL;\n    shmem_p = NULL;\n}\n\nstatic void signal_handler(int sig_num) {\n    switch(sig_num) {\n    case SIGCHLD:\n        write(STDERR_FILENO, \"Error occured - Child process terminated\\n\", 43);\n        break;\n\n    case SIGALRM:\n        write(STDOUT_FILENO, \"Successfully finished sim\\n\", 28);\n        break;\n\n    default:\n        fprintf(stderr, \"Error - Signal %s has been raised\", strsignal(sig_num));\n        fflush(stderr);\n        break;\n    }\n\n    done = true;\n    signal_rcvd = true;\n}\n\nstatic status_t init_procedure()\n{\n    done = false;\n    signal_rcvd = false;\n    size_t size = TOTAL_PROC_NUM*sizeof(int);\n\n    /* Initialize shared memory to be used as an exit flag to be used by all processes */\n\n    shmem_fd = shm_open(\"/shmemory\", O_CREAT | O_TRUNC | O_RDWR, 0644);\n    if(shmem_fd &lt; 0) {\n        error_and_exit(\"shm_open() failed, err = \", errno);\n    }\n\n    if(ftruncate(shmem_fd, size)) {\n        shm_unlink(\"/shmemory\");\n        error_and_exit(\"ftruncate() failed, err = \", errno);\n    }\n\n    shmem_p = (int *)mmap(NULL, size, PROT_READ | PROT_WRITE, MAP_SHARED, shmem_fd, 0);\n    if(shmem_p == MAP_FAILED) {\n        shm_unlink(\"/shmemory\");\n        error_and_exit(\"mmap() failed, err = \", errno);\n    }\n\n    close(shmem_fd);    /* No longer needed */\n    memset(shmem_p, 0, size);\n\n    /* Initialize a named sempahore for the procceses shared memory */\n    sem_p = sem_open(\"/shsemaphore\", O_CREAT | O_RDWR, 0644, 1);\n    if(SEM_FAILED == sem_p) {\n        error(\"sem_open() failed, err = \", errno);\n        munmap(shmem_p, size);\n        shm_unlink(\"/shmemory\");\n    }\n\n    /* Initialize memory access invokers processes */\n    if(processes_init() != SUCCESS) {\n        error(\"init_processes() failed\\n\", ERR);\n        munmap(shmem_p, size);\n        shm_unlink(\"/shmemory\");\n        sem_close(sem_p);\n        return FAILURE;\n    }\n\n    /* Handle Signals - Ignore SIGINT, SIGQUIT, handle SIGCHLD &amp; SIGALRM */\n\n    struct sigaction sig_handler;\n    sig_handler.sa_flags = 0;\n\n    if(sigfillset(&amp;sig_handler.sa_mask)) {  /* Mask all other signals inside the handler */\n        error(\"sigemptyset() failed, err = \", errno);\n        exit_procedure();\n        return FAILURE;\n    }\n\n    sig_handler.sa_handler = signal_handler;\n    if(sigaction(SIGCHLD, &amp;sig_handler, NULL) || sigaction(SIGALRM, &amp;sig_handler, NULL)) {  /* Set the signal handler for SIGCHLD &amp; SIGALRM */\n        error(\"sigaction() failed, err = \", errno);\n        exit_procedure();\n        return FAILURE;\n    }\n\n    sig_handler.sa_handler = SIG_IGN;\n    if(sigaction(SIGINT, &amp;sig_handler, NULL) || sigaction(SIGQUIT, &amp;sig_handler, NULL)) {   /* Ignore ctrl+c and ctrl+z */\n        error(\"sigaction() failed, err = \", errno);\n        exit_procedure();\n        return FAILURE;\n    }\n\n    return SUCCESS;\n}\n\nint main(int argc, char *argv[])\n{\n    if(argc != 1) {\n        fprintf(stderr, \"usage: %s (no arguments allowed)\\n\", argv[0]);\n        exit(EXIT_FAILURE);\n    }\n\n    if(SUCCESS != init_procedure()) {\n        error_and_exit(\"init_procedure() failed\\n\", ERR);\n    }\n\n    sleep(5);\n    exit_procedure();\n\n    return EXIT_SUCCESS;\n}\n</code></pre>\n\n<p><strong>process handler:</strong></p>\n\n<pre><code>#define WR_RATE (0.8)               //!&lt; Writing probabilty when invoking memory access\n#define WR_RATE_INT (WR_RATE*10)    //!&lt; WR_RATE as an int value between 1 and 10\n#define INTER_MEM_ACCS_T (100000)   //!&lt; Waiting time between memory accesses\n\nstatic pid_t child_pids[CHILD_PROC_NUM];\n\nint process_cnt;                    //!&lt; Determines the index of the process, for child processes\nextern sem_t *sem_p;\n\nstatic bool is_ack_received(int *mem_p, off_t size)\n{\n    bool ack;\n\n    /*********************************************************/\n    /**                 Critical Section start              **/\n    if((sem_wait(sem_p) != 0) &amp;&amp; (errno != EINTR)) {\n        munmap(mem_p, size);\n        shm_unlink(\"/shmemory\");\n        error_and_Exit(\"sem_wait() failed, err = \", errno);\n    }\n\n    ack = (mem_p[process_cnt] == MSG_ACK);\n\n    if(ack) {// TODO - Remove\n        fprintf(stdout, \"Process %d received ACK\\n\", process_cnt);\n        fflush(stdout);\n    }\n\n    if((sem_post(sem_p) != 0) &amp;&amp; (errno != EINTR)) {\n        munmap(mem_p, size);\n        shm_unlink(\"/shmemory\");\n        error_and_Exit(\"sem_post() failed, err = \", errno);\n    }\n    /**                 Critical Section end                **/\n    /*********************************************************/\n\n    return ack;\n}\n\nstatic void invoke_memory_access(int *mem_p, off_t size)\n{\n    msg_e send_msg = MSG_READ;\n    if(rand_range(1, 10) &lt;= WR_RATE_INT) {  /* Write Memory */\n        send_msg = MSG_WRITE;\n    }\n\n    /*********************************************************/\n    /**                 Critical Section start              **/\n    if((sem_wait(sem_p) != 0) &amp;&amp; (errno != EINTR)) {  \n        munmap(mem_p, size);\n        shm_unlink(\"/shmemory\");\n        error_and_Exit(\"sem_wait() failed, err = \", errno);\n    }\n\n    mem_p[process_cnt] = send_msg;\n    fprintf(stdout, \"Process %d sent MSG_%d in mem_address: %p\\n\", process_cnt, send_msg, &amp;mem_p[process_cnt]); // TODO - Remove\n    fflush(stdout);\n\n    if((sem_post(sem_p) != 0) &amp;&amp; (errno != EINTR)) {\n        munmap(mem_p, size);\n        shm_unlink(\"/shmemory\");\n        error_and_Exit(\"sem_post() failed, err = \", errno);\n    }\n    /**                 Critical Section end                **/\n    /*********************************************************/\n}\n\nstatic void main_loop()\n{\n    int shmem_fd = shm_open(\"/shmemory\", O_RDWR, 0);\n    if(shmem_fd &lt; 0) {\n        error_and_Exit(\"shm_open() failed, err = \", errno);\n    }\n\n    struct stat mem_stat;\n    fstat(shmem_fd, &amp;mem_stat);\n\n    int *child_memory_p = (int *)mmap(NULL, mem_stat.st_size, PROT_READ | PROT_WRITE, MAP_SHARED, shmem_fd, 0);\n    if(child_memory_p == MAP_FAILED) {\n        shm_unlink(\"/shmemory\");\n        error_and_Exit(\"mmap() failed, err = \", errno);\n    }\n\n    close(shmem_fd);    /* No longer needed */\n\n    bool first_run = true;\n    bool ack = false;\n    const struct timespec ns_wait = {.tv_sec = 0, .tv_nsec = INTER_MEM_ACCS_T};\n\n    while(child_memory_p[0] != MSG_EXIT) {\n        if( !first_run ) {                  /* Not the first run, check for ack */\n            ack = is_ack_received(child_memory_p, mem_stat.st_size);\n        }\n\n        nanosleep(&amp;ns_wait, NULL);\n\n        if( !first_run &amp;&amp; !ack ) {  /* No ack received for latest call, nothing to be done */\n            continue;\n        }\n\n        invoke_memory_access(child_memory_p, mem_stat.st_size);\n\n        if(first_run) {             /* First run is over.. */\n            first_run = false;\n        }\n    }\n\n    fprintf(stdout, \"PROCCESS %d EXIT!\\n\", process_cnt); // TODO Remove this\n    fflush(stdout);\n\n    munmap(child_memory_p, mem_stat.st_size);\n    shm_unlink(\"/shmemory\");\n\n    child_memory_p = NULL;\n\n    _Exit(EXIT_SUCCESS);\n}\n\nstatus_t processes_init()\n{\n    pid_t pid;\n    process_cnt = 1;    /* Will be used for child processes to determine their order creation */\n    int i;\n    for(i = 0; i &lt; CHILD_PROC_NUM; ++i) {\n        pid = fork();\n\n        if(ERR == pid) {\n            error(\"fork() failed, err = \", errno);\n            return FAILURE;\n        } else if(pid != 0) {           /* Parent process */\n            child_pids[i] = pid;\n            process_cnt++;\n        } else {                        /* Child process */\n            block_all_signals();        /* Only main process responsible for indicate exit to its child*/\n            main_loop();\n        }\n    }\n\n    return SUCCESS;\n}\n\nvoid processes_deinit(int **mem_p)\n{\n    (*mem_p)[0] = MSG_EXIT;\n    fprintf(stdout, \"EXIT wrriten to address %p\\n\", *mem_p);\n\n    /* Wait for all child processes to terminate */\n    int i;\n    write(STDOUT_FILENO, \"Waiting for children to exit\\n\", 29); // TODO Remove this\n    for(i = 0; i &lt; CHILD_PROC_NUM; ++i) {\n        if((ERR == waitpid(child_pids[i], NULL, 0)) &amp;&amp; (ECHILD != errno)) {\n            error(\"waitpid() failed, err = \", errno);\n        }\n    }\n\n    fprintf(stdout, \"PROCCESS DEINIT DONE!\\n\"); // TODO Remove this\n    fflush(stdout);\n}\n</code></pre>\n\n<p>Can someone please explain what am i'm doing wrong?</p>\n\n<p><strong>I've tried:</strong></p>\n\n<ol>\n<li><p>passing sem_t pointer from main process as *sem_t **semaphore_p* to <em>processes_init</em> method, and have every child use the real pointer to the semaphore (Even if child will copy the pointer upon COW mecanishm, he'll still use the actual addres\nThanks</p></li>\n<li><p>Declaring the sem_t pointer as extern in the <em>process handler</em></p></li>\n<li><p>Opening each child process (in the <em>main_loop</em> method) a \"copy\" of the named semaphore using <strong>sem_open(\"/shsemaphore\", O_RDWR)</strong></p></li>\n</ol>\n\n<p>None of these worked. i'm going crazy over here guys, please help me :(</p>\n"}, {"tags": ["c", "linux", "cmd", "cgi"], "comments": [{"owner": {"reputation": 2592, "user_id": 2963819, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bcc08ce2a4490cf3496020812fe10ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Ishay Peled", "link": "https://stackoverflow.com/users/2963819/ishay-peled"}, "edited": false, "score": 0, "creation_date": 1467210296, "post_id": 38102403, "comment_id": 63638804, "body": "Put aside the fact that it is <i>extremely</i> dangerous to run things like <code>insmod</code> from CGI context, the CGI daemon user probably doesn&#39;t have the required permissions to execute. Why do you want to do this?"}, {"owner": {"reputation": 973, "user_id": 2681245, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b94bf2509faa4d8e67e99fc550722f04?s=128&d=identicon&r=PG&f=1", "display_name": "Rocoder", "link": "https://stackoverflow.com/users/2681245/rocoder"}, "reply_to_user": {"reputation": 2592, "user_id": 2963819, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bcc08ce2a4490cf3496020812fe10ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Ishay Peled", "link": "https://stackoverflow.com/users/2963819/ishay-peled"}, "edited": false, "score": 0, "creation_date": 1467210528, "post_id": 38102403, "comment_id": 63638984, "body": "@IshayPeled  Need to update some of storage drivers of the server. I have cmd line utility which does the same. But, I need to achieve same using browser also. I chose CGI script  but stuck here."}, {"owner": {"reputation": 973, "user_id": 2681245, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b94bf2509faa4d8e67e99fc550722f04?s=128&d=identicon&r=PG&f=1", "display_name": "Rocoder", "link": "https://stackoverflow.com/users/2681245/rocoder"}, "reply_to_user": {"reputation": 2592, "user_id": 2963819, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bcc08ce2a4490cf3496020812fe10ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Ishay Peled", "link": "https://stackoverflow.com/users/2963819/ishay-peled"}, "edited": false, "score": 0, "creation_date": 1467210745, "post_id": 38102403, "comment_id": 63639147, "body": "Utility generates xml file which contains driver&#39;s information. But, when I am trying to generate same xml using CGI script. I am getting issues."}, {"owner": {"reputation": 2592, "user_id": 2963819, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bcc08ce2a4490cf3496020812fe10ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Ishay Peled", "link": "https://stackoverflow.com/users/2963819/ishay-peled"}, "edited": false, "score": 0, "creation_date": 1467211644, "post_id": 38102403, "comment_id": 63639861, "body": "In that case I would <i>STRONGLY</i> recommend abstracting your logic - don&#39;t allow excessive priviliges to the CGI script runner, rather use a server run as root on your system, accepting requests to do only the specific actions you need and communicate with that server with your CGI script"}, {"owner": {"reputation": 973, "user_id": 2681245, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b94bf2509faa4d8e67e99fc550722f04?s=128&d=identicon&r=PG&f=1", "display_name": "Rocoder", "link": "https://stackoverflow.com/users/2681245/rocoder"}, "reply_to_user": {"reputation": 2592, "user_id": 2963819, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bcc08ce2a4490cf3496020812fe10ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Ishay Peled", "link": "https://stackoverflow.com/users/2963819/ishay-peled"}, "edited": false, "score": 0, "creation_date": 1467212565, "post_id": 38102403, "comment_id": 63640561, "body": "As I said, I have cmd line utility say <b>du</b> which accepts some arguments. which will list down all drivers and write into xml . Again I am reading the xml and showing in web-browser. currently, Failing to generate xml file using <b>du</b> cmd."}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1467288947, "post_id": 38102403, "comment_id": 63677078, "body": "<code>popen(3)</code> <b>MUST BE CLOSED</b> with <code>pclose(3)</code>, that <code>wait(2)</code>s for the child process to finish."}, {"owner": {"reputation": 973, "user_id": 2681245, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b94bf2509faa4d8e67e99fc550722f04?s=128&d=identicon&r=PG&f=1", "display_name": "Rocoder", "link": "https://stackoverflow.com/users/2681245/rocoder"}, "edited": false, "score": 0, "creation_date": 1467289669, "post_id": 38102403, "comment_id": 63677636, "body": "Yes !! That is mistake !! Actual code contains <code>pclose</code>"}], "answers": [{"comments": [{"owner": {"reputation": 2592, "user_id": 2963819, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bcc08ce2a4490cf3496020812fe10ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Ishay Peled", "link": "https://stackoverflow.com/users/2963819/ishay-peled"}, "edited": false, "score": 0, "creation_date": 1467211694, "post_id": 38102928, "comment_id": 63639894, "body": "<code>lsblk</code> is not privileged, did <code>insmod</code> work for you?"}, {"owner": {"reputation": 973, "user_id": 2681245, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b94bf2509faa4d8e67e99fc550722f04?s=128&d=identicon&r=PG&f=1", "display_name": "Rocoder", "link": "https://stackoverflow.com/users/2681245/rocoder"}, "edited": false, "score": 0, "creation_date": 1467212174, "post_id": 38102928, "comment_id": 63640237, "body": "It works for me as well !! But I face issue when I try the same using web-browser. Apache(webserver) will not have all permission."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1467212325, "post_id": 38102928, "comment_id": 63640362, "body": "you can easily modify the <code>main()</code> function to retrieve parameters sent from the browser and use those parameters rather than the hardcoded command used in the answer."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1467212487, "post_id": 38102928, "comment_id": 63640504, "body": "The setup/configuration files for the server will have a &quot;very&quot; limited number of external commands that are allowed to be executed.  This is to protect the server (and its&#39; environment) from attack."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1467212707, "post_id": 38102928, "comment_id": 63640649, "body": "I&#39;m not going to run <code>insmod()</code> as I do not want to be inserting any module into my kernel."}, {"owner": {"reputation": 973, "user_id": 2681245, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b94bf2509faa4d8e67e99fc550722f04?s=128&d=identicon&r=PG&f=1", "display_name": "Rocoder", "link": "https://stackoverflow.com/users/2681245/rocoder"}, "edited": false, "score": 0, "creation_date": 1467212927, "post_id": 38102928, "comment_id": 63640786, "body": "I dont want to run insmod and lsblk directly.  It will be taken care by some other utility (cmd line). In order to run the utility, I face the issue. I too tried same in Ubuntu and it worked for me but actual requirement is in Rhel."}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1467288997, "post_id": 38102928, "comment_id": 63677112, "body": "<code>popen(3)</code> <b>MUST BE CLOSED</b> with <code>pclose(3)</code>, that <code>wait(2)</code>s for the child process to finish."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "reply_to_user": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1467295716, "post_id": 38102928, "comment_id": 63682270, "body": "@LuisColorado,  Your right, my oversight.  I&#39;ll edit my answer."}], "tags": [], "owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "is_accepted": false, "score": 0, "last_activity_date": 1467296261, "last_edit_date": 1467296261, "creation_date": 1467211350, "answer_id": 38102928, "question_id": 38102403, "link": "https://stackoverflow.com/questions/38102403/calling-system-cmd-using-popen-in-cgi-script/38102928#38102928", "title": "Calling system cmd using popen in CGI script", "body": "<p>After modifying your posted code:</p>\n\n<ol>\n<li>so it cleanly compiles</li>\n<li>and adding error checking</li>\n<li>EDIT: changed <code>fclose()</code> to <code>pclose()</code></li>\n<li>EDIT: added call to <code>wait()</code> for child process to finish</li>\n</ol>\n\n<p>This is the result:</p>\n\n<pre><code>#include &lt;stdio.h&gt;   // printf(), popen(), pclose(), fread()\n#include &lt;stdlib.h&gt;  // exit(), EXIT_FAILURE\n\n// EDIT: added next two header files for 'wait()'\n#include &lt;sys/types.h&gt;\n#include &lt;sys/wait.h&gt;\n\n\n\n\nvoid cmd_execute(char *cmd, char *buff, size_t len)\n{\n    FILE *f = popen(cmd,\"r\");\n    if (NULL == f)\n    { // then popen failed\n        perror( \"popen failed\" );\n        exit( EXIT_FAILURE );\n    }\n\n    size_t byteCount = fread(buff,len,1,f);\n    if( 0 &gt;= byteCount )\n    { // then fread failed\n        perror( \"fread failed\" );\n        pclose(f);\n        wait( NULL );\n        exit( EXIT_FAILURE );\n    }\n\n    pclose(f);\n    wait( NULL );\n\n    printf(\"&lt;p&gt; buff: %s\\n&lt;\\\\p&gt;\",buff);\n} // end function: cmd_execute\n\n\nint main( void )\n{\n    char *command= \"lsblk\";\n    char buffer[100];\n\n    cmd_execute( command, buffer, 100 );\n} // end function: main\n</code></pre>\n\n<p>I then ran it on my system:</p>\n\n<p>ubuntu linux 14.04</p>\n\n<p>Which outputs:</p>\n\n<pre><code>&lt;p&gt; buff: NAME   MAJ:MIN RM   SIZE RO TYPE MOUNTPOINT\nsda      8:0    0 931.5G  0 disk \n\u251c\u2500sda1   8:1    0 \n&lt;\\p&gt;\n</code></pre>\n\n<p>Note: the third line of the output does contain some 'non ascii' characters which may be creating a problem with your browser.</p>\n\n<p>You may want to add a call to <code>printf()</code> after each call to <code>perror()</code> to display error messages on the browser window.</p>\n"}, {"comments": [{"owner": {"reputation": 973, "user_id": 2681245, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b94bf2509faa4d8e67e99fc550722f04?s=128&d=identicon&r=PG&f=1", "display_name": "Rocoder", "link": "https://stackoverflow.com/users/2681245/rocoder"}, "edited": false, "score": 0, "creation_date": 1467289838, "post_id": 38122925, "comment_id": 63677760, "body": "I tried giving permission to <code>apache</code>  using <code>visudo</code> and tried to run the command but I get the error <i>&quot;unable to change to sudoers gid: Operation not permitted&quot;</i>"}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "reply_to_user": {"reputation": 973, "user_id": 2681245, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b94bf2509faa4d8e67e99fc550722f04?s=128&d=identicon&r=PG&f=1", "display_name": "Rocoder", "link": "https://stackoverflow.com/users/2681245/rocoder"}, "edited": false, "score": 0, "creation_date": 1467739621, "post_id": 38122925, "comment_id": 63842549, "body": "Check the doc of sudo.  It has plenty of possibilities."}], "tags": [], "owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "is_accepted": false, "score": 0, "last_activity_date": 1467289215, "creation_date": 1467289215, "answer_id": 38122925, "question_id": 38102403, "link": "https://stackoverflow.com/questions/38102403/calling-system-cmd-using-popen-in-cgi-script/38122925#38122925", "title": "Calling system cmd using popen in CGI script", "body": "<p><code>Su(1)</code> is a command that must be run interactively.  It opens <code>/dev/tty</code> to be able to ask for a password, and, as you are running it in a session without control terminal (all daemon sessions are non-terminal) the <code>open(2)</code> of <code>/dev/tty</code> fails (with that precise error)</p>\n\n<p>The solution is to use other means of passing the password to <code>su(1)</code>. Read its documentation to see if there's an alternative way to pass it the right password. Or to command it to not ask for a password.</p>\n\n<p>By the way, and unrelated to this, but <code>popen(3)</code> <strong>must be closed with <code>pclose(3)</code></strong> and not with <code>fclose(3)</code>. This is because pclose kills the child and waits for it to terminate, instead of letting it run with the communication channel closed.</p>\n\n<p>One last thing: I don't know the case of your container, but some don't allow you to spawn new processes, so be careful.  I think this is not your case.</p>\n"}], "owner": {"reputation": 973, "user_id": 2681245, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b94bf2509faa4d8e67e99fc550722f04?s=128&d=identicon&r=PG&f=1", "display_name": "Rocoder", "link": "https://stackoverflow.com/users/2681245/rocoder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 511, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1485278372, "creation_date": 1467209958, "last_edit_date": 1485278372, "question_id": 38102403, "link": "https://stackoverflow.com/questions/38102403/calling-system-cmd-using-popen-in-cgi-script", "title": "Calling system cmd using popen in CGI script", "body": "<p>Trying to execute the <code>CGI script</code> which contains <code>popen()</code> to execute the cmd. Even though <code>popen</code> return valid pointer but it fails to do desired operation. </p>\n\n<p>Command I want to execute <code>lsblk</code>,<code>insmod</code> etc</p>\n\n<pre><code>void cmd_execute(char *cmd, char *buff, int len)\n{\n    FILE *f = popen(cmd,\"r\");\n    if (NULL == f){\n        printf(\"&lt;p&gt; popen failed\");\n        return;\n    }\n    fread(buff,len,1,f);\n    pclose(f);\n\n    printf(\"&lt;p&gt; buff: %s\",buff);\n}\n</code></pre>\n\n<p><strong>HTML Content:</strong> </p>\n\n<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;body bgcolor=\"#4a7d49\"&gt;\n&lt;form ACTION=\"http://localhost/cgi-bin/run.cgi\" METHOD=\"POST\" target=\"display_page\"&gt;\n&lt;input type=\"submit\" value=\"List Drivers\"&gt;&lt;/form&gt;\n&lt;br /&gt;&lt;br /&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p>When I tried the same for <code>ls</code> cmd I got the desired result. But other commands are failing. I am trying this in <code>rhel6.4</code>. I tried changing permission using <code>su -s</code> and <code>runuser -l</code> in <strong>cmd argument</strong> but it doesn't help. I was getting error like <strong><em>could not open session</em></strong>. Let me know if there are better ways to do same.    </p>\n"}, {"tags": ["c", "hash", "hex", "byte", "sha256"], "comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 1, "creation_date": 1467209205, "post_id": 38102044, "comment_id": 63637932, "body": "<code>fflush(stdout);</code>?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1467209491, "post_id": 38102044, "comment_id": 63638170, "body": "Print the newline only after the last byte, not after each.  Or flush the output stream."}], "answers": [{"comments": [{"owner": {"reputation": 175, "user_id": 1328667, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/35883a3e5bd2e0d88b65586736a86bf1?s=128&d=identicon&r=PG", "display_name": "Merlijn", "link": "https://stackoverflow.com/users/1328667/merlijn"}, "edited": false, "score": 0, "creation_date": 1467210552, "post_id": 38102227, "comment_id": 63639006, "body": "Thanks for the solution. It works when I use fflush(). Printing the newline after the for loop didn&#39;t work. It just prints a new line without the hash. Mind you I am doing this in an emulator, so maybe there lies the problem."}], "tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": true, "score": 4, "last_activity_date": 1467209501, "creation_date": 1467209501, "answer_id": 38102227, "question_id": 38102044, "link": "https://stackoverflow.com/questions/38102044/printing-a-hash-in-c/38102227#38102227", "title": "Printing a hash in C", "body": "<p>Standard output is (typically) line-buffered, which means output won't be flushed to the terminal until the buffer is full <em>or</em> you send a newline <em>or</em> you flush the stream manually with <code>fflush()</code>.  </p>\n\n<p>The easiest thing to do is print the newline after the loop:</p>\n\n<pre><code>for(x = 0; x &lt; SHA256_DIGEST_LENGTH; x++)\n        printf(\"%02x\", digest[x]);\nputchar( '\\n' );\n</code></pre>\n"}], "owner": {"reputation": 175, "user_id": 1328667, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/35883a3e5bd2e0d88b65586736a86bf1?s=128&d=identicon&r=PG", "display_name": "Merlijn", "link": "https://stackoverflow.com/users/1328667/merlijn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2983, "favorite_count": 0, "accepted_answer_id": 38102227, "answer_count": 1, "score": 2, "last_activity_date": 1467209501, "creation_date": 1467209104, "last_edit_date": 1467209362, "question_id": 38102044, "link": "https://stackoverflow.com/questions/38102044/printing-a-hash-in-c", "title": "Printing a hash in C", "body": "<p>I am trying to print a SHA256 hash in C but when I use the for loop shown below, the only way the hash is printed is when I add the newline to printf. Ideally I want to print it all on one line. </p>\n\n<pre><code>void enclave_main()\n{\n    char string[] = \"Hello World\";\n    int x;\n\n    unsigned char digest[SHA256_DIGEST_LENGTH];\n    SHA256_CTX sha256;\n    SHA256_Init(&amp;sha256);\n    SHA256_Update(&amp;sha256, string, strlen(string));\n    SHA256_Final(digest, &amp;sha256);\n\n    for(x = 0; x &lt; SHA256_DIGEST_LENGTH; x++)\n        printf(\"%02x\\n\", digest[x]);\n\n    sgx_exit(NULL);\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "qt", "compiler-errors", "linker"], "comments": [{"owner": {"reputation": 1934, "user_id": 4932834, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cb44dcd4ebddfea3ede8c6d46b02795?s=128&d=identicon&r=PG&f=1", "display_name": "PcAF", "link": "https://stackoverflow.com/users/4932834/pcaf"}, "edited": false, "score": 0, "creation_date": 1467209236, "post_id": 38101954, "comment_id": 63637953, "body": "use <code>extern C ...</code>"}, {"owner": {"reputation": 133, "user_id": 5741155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/532edc2504aa69209c532cc3f20f2527?s=128&d=identicon&r=PG&f=1", "display_name": "vigilanum", "link": "https://stackoverflow.com/users/5741155/vigilanum"}, "reply_to_user": {"reputation": 1934, "user_id": 4932834, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cb44dcd4ebddfea3ede8c6d46b02795?s=128&d=identicon&r=PG&f=1", "display_name": "PcAF", "link": "https://stackoverflow.com/users/4932834/pcaf"}, "edited": false, "score": 1, "creation_date": 1467209380, "post_id": 38101954, "comment_id": 63638081, "body": "From what I see the header of the library has <code>extern C</code> defined in line 12 (<a href=\"https://github.com/elanthis/gamepad/blob/master/gamepad.h#L12\" rel=\"nofollow noreferrer\">github.com/elanthis/gamepad/blob/master/gamepad.h#L12</a>). Or am I missing something?"}, {"owner": {"reputation": 1934, "user_id": 4932834, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cb44dcd4ebddfea3ede8c6d46b02795?s=128&d=identicon&r=PG&f=1", "display_name": "PcAF", "link": "https://stackoverflow.com/users/4932834/pcaf"}, "edited": false, "score": 0, "creation_date": 1467209716, "post_id": 38101954, "comment_id": 63638359, "body": "Maybe you forgot to link it."}, {"owner": {"reputation": 133, "user_id": 5741155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/532edc2504aa69209c532cc3f20f2527?s=128&d=identicon&r=PG&f=1", "display_name": "vigilanum", "link": "https://stackoverflow.com/users/5741155/vigilanum"}, "reply_to_user": {"reputation": 1934, "user_id": 4932834, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cb44dcd4ebddfea3ede8c6d46b02795?s=128&d=identicon&r=PG&f=1", "display_name": "PcAF", "link": "https://stackoverflow.com/users/4932834/pcaf"}, "edited": false, "score": 0, "creation_date": 1467209938, "post_id": 38101954, "comment_id": 63638534, "body": "That exactly is what I need to now, like how can I link it? Do I really need to create a DLL file from the given source files or is there any other way to just include them? Even with a .dll/.a I got the same error after including the library using the Qt GUI dialog to add an existing library."}, {"owner": {"reputation": 2037, "user_id": 1468415, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/wx7N9.png?s=128&g=1", "display_name": "mvidelgauz", "link": "https://stackoverflow.com/users/1468415/mvidelgauz"}, "edited": false, "score": 1, "creation_date": 1467211252, "post_id": 38101954, "comment_id": 63639518, "body": "It looks like yes, you need to build that project to get dll (and also .lib) files, because it is distributed only in source, I can&#39;t see pre-built binaries there"}, {"owner": {"reputation": 133, "user_id": 5741155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/532edc2504aa69209c532cc3f20f2527?s=128&d=identicon&r=PG&f=1", "display_name": "vigilanum", "link": "https://stackoverflow.com/users/5741155/vigilanum"}, "reply_to_user": {"reputation": 2037, "user_id": 1468415, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/wx7N9.png?s=128&g=1", "display_name": "mvidelgauz", "link": "https://stackoverflow.com/users/1468415/mvidelgauz"}, "edited": false, "score": 0, "creation_date": 1467212474, "post_id": 38101954, "comment_id": 63640494, "body": "@mvidelgauz Alright, I had to build the library with Visual Studio. Now it works. Thanks!"}], "owner": {"reputation": 133, "user_id": 5741155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/532edc2504aa69209c532cc3f20f2527?s=128&d=identicon&r=PG&f=1", "display_name": "vigilanum", "link": "https://stackoverflow.com/users/5741155/vigilanum"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "closed_date": 1467212234, "answer_count": 0, "score": 0, "last_activity_date": 1467211872, "creation_date": 1467208920, "question_id": 38101954, "link": "https://stackoverflow.com/questions/38101954/using-a-c-library-in-a-c-application-with-qt", "closed_reason": "Duplicate", "title": "Using a C library in a C++ application with Qt", "body": "<p>I'd like to use this gamepad library (<a href=\"https://github.com/elanthis/gamepad/\" rel=\"nofollow\">https://github.com/elanthis/gamepad/</a>) written in C in my C++ application. Unfortunately I can't get it to work.</p>\n\n<p>So far I've tried to create a shared library and link it using Qt's GUI. When trying to run my C++ program I still get the error <strong>\"main.cpp:89: Error: undefined reference to `_imp__GamepadInit'\"</strong> which seems to tell me that the library wasn't properly linked yet.</p>\n\n<p>My main application looks like this:</p>\n\n<pre><code>#include \"gamepad.h\"\n\nint main(int argc, char *argv[]) {\n    GamepadInit();\n    return 0;\n}\n</code></pre>\n\n<p>As I'm pretty clueless my question is: what would be the basic steps to use functions of this library (given the .c &amp; .h files) when working with Qt Creator/MinGW?</p>\n"}, {"tags": ["c", "gcc"], "comments": [{"owner": {"reputation": 61304, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 4, "creation_date": 1467208992, "post_id": 38101943, "comment_id": 63637745, "body": "I cant find the errors, because it is full of warnings"}, {"owner": {"reputation": 2034, "user_id": 2486496, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Rpd3r.jpg?s=128&g=1", "display_name": "gravity", "link": "https://stackoverflow.com/users/2486496/gravity"}, "edited": false, "score": 0, "creation_date": 1467209088, "post_id": 38101943, "comment_id": 63637825, "body": "Are you able to do <code>gcc --version</code> on both systems for a comparison?"}, {"owner": {"reputation": 966, "user_id": 2831106, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/tA8Qw.png?s=128&g=1", "display_name": "lewiatan", "link": "https://stackoverflow.com/users/2831106/lewiatan"}, "edited": false, "score": 0, "creation_date": 1467209202, "post_id": 38101943, "comment_id": 63637926, "body": "There is no error in what you provided.. Only warnings.. Can you emphasize the error you are talking about?"}, {"owner": {"reputation": 37, "user_id": 6116114, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a0fbbd68420090ebe00ec80448df9aab?s=128&d=identicon&r=PG&f=1", "display_name": "Lily Sharpton", "link": "https://stackoverflow.com/users/6116114/lily-sharpton"}, "edited": false, "score": 0, "creation_date": 1467210017, "post_id": 38101943, "comment_id": 63638597, "body": "Okay, Yes the warnings. Apologies, may be I am saying it wrong. How do I proceed with the compilation in this case then?"}, {"owner": {"reputation": 37, "user_id": 6116114, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a0fbbd68420090ebe00ec80448df9aab?s=128&d=identicon&r=PG&f=1", "display_name": "Lily Sharpton", "link": "https://stackoverflow.com/users/6116114/lily-sharpton"}, "edited": false, "score": 0, "creation_date": 1467210084, "post_id": 38101943, "comment_id": 63638655, "body": "I don&#39;t have my older system now but gcc --version  on the newer one is this: gcc (Ubuntu 5.3.1-14ubuntu2) 5.3.1 20160413"}, {"owner": {"reputation": 19253, "user_id": 657267, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1dcf516021abb964aecd6ae2386fd59d?s=128&d=identicon&r=PG", "display_name": "user657267", "link": "https://stackoverflow.com/users/657267/user657267"}, "edited": false, "score": 0, "creation_date": 1467210719, "post_id": 38101943, "comment_id": 63639126, "body": "Your question is unrelated to make, if you actually have errors then post them, if not then you might want to change your question title."}, {"owner": {"reputation": 37, "user_id": 6116114, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a0fbbd68420090ebe00ec80448df9aab?s=128&d=identicon&r=PG&f=1", "display_name": "Lily Sharpton", "link": "https://stackoverflow.com/users/6116114/lily-sharpton"}, "edited": false, "score": 0, "creation_date": 1467211484, "post_id": 38101943, "comment_id": 63639721, "body": "Okay Thanks. I don&#39;t have errors, I just have these warnings but I am unable to proceed with the code because of these warnings. Any help is appreciated"}, {"owner": {"reputation": 8326, "user_id": 53089, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/525dac0c4812e8e8753935590b40ddb6?s=128&d=identicon&r=PG", "display_name": "Rob K", "link": "https://stackoverflow.com/users/53089/rob-k"}, "edited": false, "score": 0, "creation_date": 1467212692, "post_id": 38101943, "comment_id": 63640639, "body": "This is C, not C++"}, {"owner": {"reputation": 2345, "user_id": 4511585, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/IC7eZ.jpg?s=128&g=1", "display_name": "albttx", "link": "https://stackoverflow.com/users/4511585/albttx"}, "edited": false, "score": 0, "creation_date": 1467212887, "post_id": 38101943, "comment_id": 63640761, "body": "You have to <code>cast</code> few variable, nothing to worried"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1467213276, "post_id": 38101943, "comment_id": 63641028, "body": "Some versions use <code>#define NULL 0</code>, some use <code>#define NULL ((void *)0)</code>.  Your new compiler has something similar to the latter, so places where you used to pass zero (<code>0</code>) via <code>NULL</code> are now passing a pointer instead \u2014 hence the warnings about converting from pointer to integer.  The type warning on the <code>printf()</code> is because you&#39;re passing the address of an array to a function that expects a <code>char *</code>.  Remove the <code>&amp;</code>."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "reply_to_user": {"reputation": 2345, "user_id": 4511585, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/IC7eZ.jpg?s=128&g=1", "display_name": "albttx", "link": "https://stackoverflow.com/users/4511585/albttx"}, "edited": false, "score": 0, "creation_date": 1467221707, "post_id": 38101943, "comment_id": 63646559, "body": "@PandaCool: Using the casting-hammer is probably the worst approach to fix those warnings ... :-/"}], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 6116114, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a0fbbd68420090ebe00ec80448df9aab?s=128&d=identicon&r=PG&f=1", "display_name": "Lily Sharpton", "link": "https://stackoverflow.com/users/6116114/lily-sharpton"}, "edited": false, "score": 0, "creation_date": 1467212245, "post_id": 38103150, "comment_id": 63640295, "body": "Thanks Jesper. I tried doing that but it is not running. I ignored the warnings but now it does not run and core dumped segmentation fault. The problem is, that I am new to c coding. I use python mostly so don&#39;t have much idea how to fix these warnings"}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "reply_to_user": {"reputation": 37, "user_id": 6116114, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a0fbbd68420090ebe00ec80448df9aab?s=128&d=identicon&r=PG&f=1", "display_name": "Lily Sharpton", "link": "https://stackoverflow.com/users/6116114/lily-sharpton"}, "edited": false, "score": 0, "creation_date": 1467212293, "post_id": 38103150, "comment_id": 63640338, "body": "Time to fix the warnings then and do some debugging if the warnings don&#39;t actually point to the crash bug. But fix the warnings first, they may likely be pointing at your bug."}, {"owner": {"reputation": 37, "user_id": 6116114, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a0fbbd68420090ebe00ec80448df9aab?s=128&d=identicon&r=PG&f=1", "display_name": "Lily Sharpton", "link": "https://stackoverflow.com/users/6116114/lily-sharpton"}, "edited": false, "score": 0, "creation_date": 1467212375, "post_id": 38103150, "comment_id": 63640407, "body": "Ahh! okay :( Well Thanks anyways!"}], "tags": [], "owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "is_accepted": false, "score": 2, "last_activity_date": 1467211963, "creation_date": 1467211963, "answer_id": 38103150, "question_id": 38101943, "link": "https://stackoverflow.com/questions/38101943/warnings-in-compilation/38103150#38103150", "title": "Warnings in compilation", "body": "<p>Unless you are using the <code>-Werror</code> flag to turn warnings into errors then the compiler will still have produced an executable that you can run.</p>\n\n<p>The warnings are probably due to the fact that your new system has a newer compiler that is better at detecting problems in your code.</p>\n\n<p>My suggestion would be to fix the warnings if you can/have time. Otherwise just run the program and ignore the warnings (for now, but fix them eventually).</p>\n"}, {"comments": [{"owner": {"reputation": 37, "user_id": 6116114, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a0fbbd68420090ebe00ec80448df9aab?s=128&d=identicon&r=PG&f=1", "display_name": "Lily Sharpton", "link": "https://stackoverflow.com/users/6116114/lily-sharpton"}, "edited": false, "score": 0, "creation_date": 1467214798, "post_id": 38103992, "comment_id": 63642119, "body": "Yes Shadowfen, Thats exactly the problem. The older computer was 32 bit."}, {"owner": {"reputation": 395, "user_id": 6505628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84aae402113911f642697ec19a65f924?s=128&d=identicon&r=PG&f=1", "display_name": "Shadowfen", "link": "https://stackoverflow.com/users/6505628/shadowfen"}, "reply_to_user": {"reputation": 37, "user_id": 6116114, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a0fbbd68420090ebe00ec80448df9aab?s=128&d=identicon&r=PG&f=1", "display_name": "Lily Sharpton", "link": "https://stackoverflow.com/users/6116114/lily-sharpton"}, "edited": false, "score": 0, "creation_date": 1467215119, "post_id": 38103992, "comment_id": 63642351, "body": "Common problems with 32bit C code trying to compile on 64bit: 1. Pointers are not the same size as ints, 2. functions that take varargs (such as scarf and printf) must use the appropriate size of specifier in the format string, and 3. NULL != 0 - particularly important when passing in varargs parameters that expect the last arg to be NULL to denote the end of the arg list."}, {"owner": {"reputation": 37, "user_id": 6116114, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a0fbbd68420090ebe00ec80448df9aab?s=128&d=identicon&r=PG&f=1", "display_name": "Lily Sharpton", "link": "https://stackoverflow.com/users/6116114/lily-sharpton"}, "edited": false, "score": 0, "creation_date": 1467215178, "post_id": 38103992, "comment_id": 63642403, "body": "Is there a way I can get around this problem without having to change/edit the code much?"}, {"owner": {"reputation": 395, "user_id": 6505628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84aae402113911f642697ec19a65f924?s=128&d=identicon&r=PG&f=1", "display_name": "Shadowfen", "link": "https://stackoverflow.com/users/6505628/shadowfen"}, "reply_to_user": {"reputation": 37, "user_id": 6116114, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a0fbbd68420090ebe00ec80448df9aab?s=128&d=identicon&r=PG&f=1", "display_name": "Lily Sharpton", "link": "https://stackoverflow.com/users/6116114/lily-sharpton"}, "edited": false, "score": 0, "creation_date": 1467215599, "post_id": 38103992, "comment_id": 63642751, "body": "You might take a look at How to compile 32bit on 64bit systems: <a href=\"http://www.cyberciti.biz/tips/compile-32bit-application-using-gcc-64-bit-linux.html\" rel=\"nofollow noreferrer\">cyberciti.biz/tips/&hellip;</a>"}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "reply_to_user": {"reputation": 37, "user_id": 6116114, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a0fbbd68420090ebe00ec80448df9aab?s=128&d=identicon&r=PG&f=1", "display_name": "Lily Sharpton", "link": "https://stackoverflow.com/users/6116114/lily-sharpton"}, "edited": false, "score": 1, "creation_date": 1467221605, "post_id": 38103992, "comment_id": 63646498, "body": "&quot;<i>without having to change/edit the code much</i>&quot; Fixing those apx 40 warnings should not take longer then max. an hour. @LilySharpton"}], "tags": [], "owner": {"reputation": 395, "user_id": 6505628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84aae402113911f642697ec19a65f924?s=128&d=identicon&r=PG&f=1", "display_name": "Shadowfen", "link": "https://stackoverflow.com/users/6505628/shadowfen"}, "is_accepted": false, "score": 0, "last_activity_date": 1467214126, "creation_date": 1467214126, "answer_id": 38103992, "question_id": 38101943, "link": "https://stackoverflow.com/questions/38101943/warnings-in-compilation/38103992#38103992", "title": "Warnings in compilation", "body": "<p>Is your new computer 64 bit? \nIs your older computer 32 bit? \nThe types of warnings I see suggest that you have 32 bit code that you might be trying to compile on a 64 bit computer (as well as the compiler being a much newer version).</p>\n"}], "owner": {"reputation": 37, "user_id": 6116114, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a0fbbd68420090ebe00ec80448df9aab?s=128&d=identicon&r=PG&f=1", "display_name": "Lily Sharpton", "link": "https://stackoverflow.com/users/6116114/lily-sharpton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 142, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1467214126, "creation_date": 1467208892, "last_edit_date": 1467212722, "question_id": 38101943, "link": "https://stackoverflow.com/questions/38101943/warnings-in-compilation", "title": "Warnings in compilation", "body": "<p>I am trying to compile a simple program written in c on my new desktop. It installed completely normally without any error on my older machine but for some reason it is giving me lots of compilation warnings when I am trying to compile it here. I installed gcc, g++, xpm and xlib which are the pre requisites of this program. Could it be that I am missing some library or something on my new machine?\nHere are the warnings I get:</p>\n\n<pre><code>gcc -o view_qsfr qsfr_2005a_tool_box.c -lX11 -lm -lc -L/usr/X11R6/lib -lXpm\nIn file included from qsfr_2005a_tool_box.c:44:0:\nqsfr_2005a_readQSFR.c: In function \u2018Read_QSFR\u2019:\nqsfr_2005a_readQSFR.c:706:19: warning: format \u2018%s\u2019 expects argument of type \u2018char *\u2019, but argument 2 has type \u2018char (*)[201]\u2019 [-Wformat=]\n             scanf(\"%s\",&amp;fname_extra);\n                   ^\nIn file included from qsfr_2005a_graphics.c:8:0,\n                 from qsfr_2005a_tool_box.c:45:\nrotated.c: In function \u2018XRotPaintAlignedString\u2019:\nrotated.c:450:9: warning: return makes integer from pointer without a cast [-Wint-conversion]\n  return NULL;\n         ^\nrotated.c:453:36: warning: passing argument 3 of \u2018XCreateGC\u2019 makes integer from pointer without a cast [-Wint-conversion]\n     my_gc=XCreateGC(dpy, drawable, NULL, 0);\n                                    ^\nIn file included from qsfr_2005a_graphics.c:7:0,\n                 from qsfr_2005a_tool_box.c:45:\n/usr/include/X11/Xlib.h:1584:11: note: expected \u2018long unsigned int\u2019 but argument is of type \u2018void *\u2019\n extern GC XCreateGC(\n           ^\nIn file included from qsfr_2005a_graphics.c:8:0,\n                 from qsfr_2005a_tool_box.c:45:\nrotated.c:510:45: warning: passing argument 3 of \u2018XCreateGC\u2019 makes integer from pointer without a cast [-Wint-conversion]\n  depth_one_gc=XCreateGC(dpy, empty_stipple, NULL, 0);\n                                             ^\nIn file included from qsfr_2005a_graphics.c:7:0,\n                 from qsfr_2005a_tool_box.c:45:\n/usr/include/X11/Xlib.h:1584:11: note: expected \u2018long unsigned int\u2019 but argument is of type \u2018void *\u2019\n extern GC XCreateGC(\n           ^\nIn file included from qsfr_2005a_graphics.c:8:0,\n                 from qsfr_2005a_tool_box.c:45:\nrotated.c:566:43: warning: passing argument 3 of \u2018XCreateGC\u2019 makes integer from pointer without a cast [-Wint-conversion]\n   depth_one_gc=XCreateGC(dpy, new_bitmap, NULL, 0);\n                                           ^\nIn file included from qsfr_2005a_graphics.c:7:0,\n                 from qsfr_2005a_tool_box.c:45:\n/usr/include/X11/Xlib.h:1584:11: note: expected \u2018long unsigned int\u2019 but argument is of type \u2018void *\u2019\n extern GC XCreateGC(\n           ^\nIn file included from qsfr_2005a_graphics.c:8:0,\n                 from qsfr_2005a_tool_box.c:45:\nrotated.c: In function \u2018XRotDrawHorizontalString\u2019:\nrotated.c:670:36: warning: passing argument 3 of \u2018XCreateGC\u2019 makes integer from pointer without a cast [-Wint-conversion]\n     my_gc=XCreateGC(dpy, drawable, NULL, 0);\n                                    ^\nIn file included from qsfr_2005a_graphics.c:7:0,\n                 from qsfr_2005a_tool_box.c:45:\n/usr/include/X11/Xlib.h:1584:11: note: expected \u2018long unsigned int\u2019 but argument is of type \u2018void *\u2019\n extern GC XCreateGC(\n           ^\nIn file included from qsfr_2005a_graphics.c:8:0,\n                 from qsfr_2005a_tool_box.c:45:\nrotated.c: In function \u2018XRotCreateTextItem\u2019:\nrotated.c:982:36: warning: passing argument 3 of \u2018XCreateGC\u2019 makes integer from pointer without a cast [-Wint-conversion]\n     font_gc=XCreateGC(dpy, canvas, NULL, 0);\n                                    ^\nIn file included from qsfr_2005a_graphics.c:7:0,\n                 from qsfr_2005a_tool_box.c:45:\n/usr/include/X11/Xlib.h:1584:11: note: expected \u2018long unsigned int\u2019 but argument is of type \u2018void *\u2019\n extern GC XCreateGC(\n           ^\nIn file included from qsfr_2005a_graphics.c:8:0,\n                 from qsfr_2005a_tool_box.c:45:\nrotated.c: In function \u2018XRotAddToLinkedList\u2019:\nrotated.c:1240:18: warning: format \u2018%ld\u2019 expects argument of type \u2018long int\u2019, but argument 4 has type \u2018int\u2019 [-Wformat=]\n     DEBUG_PRINT4(\"current cache size=%ld, new item=%ld, limit=%ld\\n\",\n                  ^\nrotated.c:66:53: note: in definition of macro \u2018DEBUG_PRINT4\u2019\n #define DEBUG_PRINT4(a, b, c, d) if (debug) printf (a, b, c, d)\n                                                     ^\nrotated.c:1253:15: warning: format \u2018%d\u2019 expects argument of type \u2018int\u2019, but argument 2 has type \u2018long int\u2019 [-Wformat=]\n  DEBUG_PRINT2(\"Removed %d bytes\\n\", i1-&gt;size);\n               ^\nrotated.c:64:47: note: in definition of macro \u2018DEBUG_PRINT2\u2019\n #define DEBUG_PRINT2(a, b) if (debug) printf (a, b)\n                                               ^\nIn file included from qsfr_2005a_tool_box.c:45:0:\nqsfr_2005a_graphics.c: In function \u2018initX\u2019:\nqsfr_2005a_graphics.c:48:27: warning: passing argument 3 of \u2018XCreateGC\u2019 makes integer from pointer without a cast [-Wint-conversion]\n  gc=XCreateGC(display,win,NULL,NULL);\n                           ^\nIn file included from qsfr_2005a_graphics.c:7:0,\n                 from qsfr_2005a_tool_box.c:45:\n/usr/include/X11/Xlib.h:1584:11: note: expected \u2018long unsigned int\u2019 but argument is of type \u2018void *\u2019\n extern GC XCreateGC(\n           ^\nIn file included from qsfr_2005a_tool_box.c:45:0:\nqsfr_2005a_graphics.c: In function \u2018Plot_Correlation_Matrix\u2019:\nqsfr_2005a_graphics.c:748:10: warning: implicit declaration of function \u2018XpmWriteFileFromPixmap\u2019 [-Wimplicit-function-declaration]\n          XpmWriteFileFromPixmap(display, fname_out, pix, 0, NULL);\n          ^\nqsfr_2005a_tool_box.c: At top level:\nqsfr_2005a_tool_box.c:413:4: warning: return type defaults to \u2018int\u2019 [-Wimplicit-int]\n    main(int argc, char **argv)\n    ^\nphysics@XPHYS9G7XGC2LLT:~/Desktop/viewQSFR/viewQSFR$ sudo make\ngcc -o view_qsfr qsfr_2005a_tool_box.c -lX11 -lm -lc -L/usr/X11R6/lib -lXpm\nIn file included from qsfr_2005a_tool_box.c:44:0:\nqsfr_2005a_readQSFR.c: In function \u2018Read_QSFR\u2019:\nqsfr_2005a_readQSFR.c:706:19: warning: format \u2018%s\u2019 expects argument of type \u2018char *\u2019, but argument 2 has type \u2018char (*)[201]\u2019 [-Wformat=]\n             scanf(\"%s\",&amp;fname_extra);\n                   ^\nIn file included from qsfr_2005a_graphics.c:8:0,\n                 from qsfr_2005a_tool_box.c:45:\nrotated.c: In function \u2018XRotPaintAlignedString\u2019:\nrotated.c:450:9: warning: return makes integer from pointer without a cast [-Wint-conversion]\n  return NULL;\n         ^\nrotated.c:453:36: warning: passing argument 3 of \u2018XCreateGC\u2019 makes integer from pointer without a cast [-Wint-conversion]\n     my_gc=XCreateGC(dpy, drawable, NULL, 0);\n                                    ^\nIn file included from qsfr_2005a_graphics.c:7:0,\n                 from qsfr_2005a_tool_box.c:45:\n/usr/include/X11/Xlib.h:1584:11: note: expected \u2018long unsigned int\u2019 but argument is of type \u2018void *\u2019\n extern GC XCreateGC(\n           ^\nIn file included from qsfr_2005a_graphics.c:8:0,\n                 from qsfr_2005a_tool_box.c:45:\nrotated.c:510:45: warning: passing argument 3 of \u2018XCreateGC\u2019 makes integer from pointer without a cast [-Wint-conversion]\n  depth_one_gc=XCreateGC(dpy, empty_stipple, NULL, 0);\n                                             ^\nIn file included from qsfr_2005a_graphics.c:7:0,\n                 from qsfr_2005a_tool_box.c:45:\n/usr/include/X11/Xlib.h:1584:11: note: expected \u2018long unsigned int\u2019 but argument is of type \u2018void *\u2019\n extern GC XCreateGC(\n           ^\nIn file included from qsfr_2005a_graphics.c:8:0,\n                 from qsfr_2005a_tool_box.c:45:\nrotated.c:566:43: warning: passing argument 3 of \u2018XCreateGC\u2019 makes integer from pointer without a cast [-Wint-conversion]\n   depth_one_gc=XCreateGC(dpy, new_bitmap, NULL, 0);\n                                           ^\nIn file included from qsfr_2005a_graphics.c:7:0,\n                 from qsfr_2005a_tool_box.c:45:\n/usr/include/X11/Xlib.h:1584:11: note: expected \u2018long unsigned int\u2019 but argument is of type \u2018void *\u2019\n extern GC XCreateGC(\n           ^\nIn file included from qsfr_2005a_graphics.c:8:0,\n                 from qsfr_2005a_tool_box.c:45:\nrotated.c: In function \u2018XRotDrawHorizontalString\u2019:\nrotated.c:670:36: warning: passing argument 3 of \u2018XCreateGC\u2019 makes integer from pointer without a cast [-Wint-conversion]\n     my_gc=XCreateGC(dpy, drawable, NULL, 0);\n                                    ^\nIn file included from qsfr_2005a_graphics.c:7:0,\n                 from qsfr_2005a_tool_box.c:45:\n/usr/include/X11/Xlib.h:1584:11: note: expected \u2018long unsigned int\u2019 but argument is of type \u2018void *\u2019\n extern GC XCreateGC(\n           ^\nIn file included from qsfr_2005a_graphics.c:8:0,\n                 from qsfr_2005a_tool_box.c:45:\nrotated.c: In function \u2018XRotCreateTextItem\u2019:\nrotated.c:982:36: warning: passing argument 3 of \u2018XCreateGC\u2019 makes integer from pointer without a cast [-Wint-conversion]\n     font_gc=XCreateGC(dpy, canvas, NULL, 0);\n                                    ^\nIn file included from qsfr_2005a_graphics.c:7:0,\n                 from qsfr_2005a_tool_box.c:45:\n/usr/include/X11/Xlib.h:1584:11: note: expected \u2018long unsigned int\u2019 but argument is of type \u2018void *\u2019\n extern GC XCreateGC(\n           ^\nIn file included from qsfr_2005a_graphics.c:8:0,\n                 from qsfr_2005a_tool_box.c:45:\nrotated.c: In function \u2018XRotAddToLinkedList\u2019:\nrotated.c:1240:18: warning: format \u2018%ld\u2019 expects argument of type \u2018long int\u2019, but argument 4 has type \u2018int\u2019 [-Wformat=]\n     DEBUG_PRINT4(\"current cache size=%ld, new item=%ld, limit=%ld\\n\",\n                  ^\nrotated.c:66:53: note: in definition of macro \u2018DEBUG_PRINT4\u2019\n #define DEBUG_PRINT4(a, b, c, d) if (debug) printf (a, b, c, d)\n                                                     ^\nrotated.c:1253:15: warning: format \u2018%d\u2019 expects argument of type \u2018int\u2019, but argument 2 has type \u2018long int\u2019 [-Wformat=]\n  DEBUG_PRINT2(\"Removed %d bytes\\n\", i1-&gt;size);\n               ^\nrotated.c:64:47: note: in definition of macro \u2018DEBUG_PRINT2\u2019\n #define DEBUG_PRINT2(a, b) if (debug) printf (a, b)\n                                               ^\nIn file included from qsfr_2005a_tool_box.c:45:0:\nqsfr_2005a_graphics.c: In function \u2018initX\u2019:\nqsfr_2005a_graphics.c:48:27: warning: passing argument 3 of \u2018XCreateGC\u2019 makes integer from pointer without a cast [-Wint-conversion]\n  gc=XCreateGC(display,win,NULL,NULL);\n                           ^\nIn file included from qsfr_2005a_graphics.c:7:0,\n                 from qsfr_2005a_tool_box.c:45:\n/usr/include/X11/Xlib.h:1584:11: note: expected \u2018long unsigned int\u2019 but argument is of type \u2018void *\u2019\n extern GC XCreateGC(\n           ^\nIn file included from qsfr_2005a_tool_box.c:45:0:\nqsfr_2005a_graphics.c: In function \u2018Plot_Correlation_Matrix\u2019:\nqsfr_2005a_graphics.c:748:10: warning: implicit declaration of function \u2018XpmWriteFileFromPixmap\u2019 [-Wimplicit-function-declaration]\n          XpmWriteFileFromPixmap(display, fname_out, pix, 0, NULL);\n          ^\nqsfr_2005a_tool_box.c: At top level:\nqsfr_2005a_tool_box.c:413:4: warning: return type defaults to \u2018int\u2019 [-Wimplicit-int]\n    main(int argc, char **argv)\n</code></pre>\n"}, {"tags": ["c++", "c"], "comments": [{"owner": {"reputation": 10300, "user_id": 2469027, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/b62ce55f4f1a0eff6775e7863850a912?s=128&d=identicon&r=PG", "display_name": "Edward Karak", "link": "https://stackoverflow.com/users/2469027/edward-karak"}, "edited": false, "score": 1, "creation_date": 1467208683, "post_id": 38101762, "comment_id": 63637424, "body": "The inline keyword increases the chances of a function getting inlined. The reason why <code>inline</code> is a suggestion, is that it can often increase the executable size, if the function is too long."}, {"owner": {"reputation": 59891, "user_id": 1207195, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Q3P4g.jpg?s=128&g=1", "display_name": "Adriano Repetti", "link": "https://stackoverflow.com/users/1207195/adriano-repetti"}, "edited": false, "score": 3, "creation_date": 1467208735, "post_id": 38101762, "comment_id": 63637483, "body": "If you really know what you&#39;re doing then you may <i>force</i> compiler to use your <i>suggestion</i>. However you may also need to use inline just to put function body in your header file. Note that newest C and C++ differs about this (in particular in which compilation unit the <i>body</i> of inlined function is placed)"}, {"owner": {"reputation": 221394, "user_id": 366904, "user_type": "moderator", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3f8912af19fe86b7b34a0b011a962460?s=128&d=identicon&r=PG", "display_name": "Cody Gray", "link": "https://stackoverflow.com/users/366904/cody-gray"}, "edited": false, "score": 1, "creation_date": 1467208798, "post_id": 38101762, "comment_id": 63637552, "body": "It is essentially pointless these days to use this meaning for the <code>inline</code> keyword. Now, it is used almost exclusively as a means to bypass the one-definition rule (ODR). Let the compiler worry about when to (or not to) inline your code."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1467208808, "post_id": 38101762, "comment_id": 63637564, "body": "Also see: <a href=\"http://stackoverflow.com/questions/1759300/when-should-i-write-the-keyword-inline-for-a-function-method\" title=\"when should i write the keyword inline for a function method\">stackoverflow.com/questions/1759300/&hellip;</a>"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1467208878, "post_id": 38101762, "comment_id": 63637628, "body": "If you don&#39;t provide the code for the inline function to the compiler, it can&#39;t inline it \u2014 it has to make a function call.  In C, if you have a <code>static</code> function then the compiler may (and quite often will) inline it even without the <code>inline</code> keyword. If the function is not <code>static</code>, it must be created as a referenceable function because code in another file might need to call it.  So, providing the inline function allows the compiler to optimize when otherwise it might not."}, {"owner": {"reputation": 140, "user_id": 6492077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/217a514a2dfa23d1810cc1982d62b38c?s=128&d=identicon&r=PG&f=1", "display_name": "mkal", "link": "https://stackoverflow.com/users/6492077/mkal"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1467210056, "post_id": 38101762, "comment_id": 63638629, "body": "@NathanOliver linked to by far the best answer for this question."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1467212112, "post_id": 38101762, "comment_id": 63640200, "body": "C and C++ are different languages. They differ in this subject. Pick one!"}], "owner": {"reputation": 1, "user_id": 6528609, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gSY6c.png?s=128&g=1", "display_name": "Ethan Coeytaux", "link": "https://stackoverflow.com/users/6528609/ethan-coeytaux"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 203, "favorite_count": 0, "closed_date": 1467208757, "answer_count": 0, "score": 0, "last_activity_date": 1467208518, "creation_date": 1467208518, "question_id": 38101762, "link": "https://stackoverflow.com/questions/38101762/why-should-i-use-inline-functions-when-its-up-to-compiler", "closed_reason": "Duplicate", "title": "Why should I use inline functions when it&#39;s up to compiler?", "body": "<p>I know how inline functions work, but I've read they are only a suggestion to the compiler, and the compiler may decide to make an inline function non-inline and make a non-inline function inline.  Since compilers know what they are doing far better than I do, why should I even bother making a function inline if the compiler is going to do what it thinks is best?  How much do compilers listen to my \"suggestions\"?</p>\n"}, {"tags": ["c", "compiler-errors", "ternary-operator", "conditional-operator"], "answers": [{"comments": [{"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 51, "user_id": 5520094, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jFFqt.jpg?s=128&g=1", "display_name": "EmZo Stark", "link": "https://stackoverflow.com/users/5520094/emzo-stark"}, "edited": false, "score": 0, "creation_date": 1467287076, "post_id": 38101672, "comment_id": 63675864, "body": "@EmZoStark No at all.:)"}], "tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 7, "last_activity_date": 1467208316, "creation_date": 1467208316, "answer_id": 38101672, "question_id": 38101550, "link": "https://stackoverflow.com/questions/38101550/getting-error-lvalue-required-as-left-operand-of-assignment/38101672#38101672", "title": "Getting error &quot;lvalue required as left operand of assignment&quot;", "body": "<p>This operator</p>\n\n<pre><code>i==3 ? a=4 : a = 10;\n</code></pre>\n\n<p>is equivalent to</p>\n\n<pre><code>( i==3 ? a=4 : a ) = 10;\n</code></pre>\n\n<p>Use instead</p>\n\n<pre><code>i==3 ? a=4 : ( a = 10 );\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2034, "user_id": 4688321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d5b21d8c934125839996c5eac897fc1?s=128&d=identicon&r=PG&f=1", "display_name": "kiner_shah", "link": "https://stackoverflow.com/users/4688321/kiner-shah"}, "is_accepted": false, "score": 2, "last_activity_date": 1545383577, "last_edit_date": 1545383577, "creation_date": 1467208465, "answer_id": 38101747, "question_id": 38101550, "link": "https://stackoverflow.com/questions/38101550/getting-error-lvalue-required-as-left-operand-of-assignment/38101747#38101747", "title": "Getting error &quot;lvalue required as left operand of assignment&quot;", "body": "<pre><code>a = (i == 3 ? 4 : 10);\n</code></pre>\n\n<p>Try this! :-)</p>\n"}, {"tags": [], "owner": {"reputation": 87, "user_id": 6386218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad0d3cb9b60dbbbf6ebfaad936fbcdb0?s=128&d=identicon&r=PG&f=1", "display_name": "Beka", "link": "https://stackoverflow.com/users/6386218/beka"}, "is_accepted": false, "score": 1, "last_activity_date": 1467208921, "creation_date": 1467208921, "answer_id": 38101955, "question_id": 38101550, "link": "https://stackoverflow.com/questions/38101550/getting-error-lvalue-required-as-left-operand-of-assignment/38101955#38101955", "title": "Getting error &quot;lvalue required as left operand of assignment&quot;", "body": "<p>Try this</p>\n\n<pre><code>if (i==3) a = 4; else a = 10;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 10300, "user_id": 2469027, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/b62ce55f4f1a0eff6775e7863850a912?s=128&d=identicon&r=PG", "display_name": "Edward Karak", "link": "https://stackoverflow.com/users/2469027/edward-karak"}, "is_accepted": false, "score": 2, "last_activity_date": 1467209079, "creation_date": 1467209079, "answer_id": 38102023, "question_id": 38101550, "link": "https://stackoverflow.com/questions/38101550/getting-error-lvalue-required-as-left-operand-of-assignment/38102023#38102023", "title": "Getting error &quot;lvalue required as left operand of assignment&quot;", "body": "<p>You need to assign outside the ternary operator, not inside of it, because the ternary operator binds tighter than assignment. So you should write</p>\n\n<pre><code>a = ((i == 3) ? 4 : 10);\n</code></pre>\n\n<p>What you wrote is equal to</p>\n\n<pre><code>(i == 3 ? a = 4 : a ) = 10;\n</code></pre>\n\n<p>In this code, an rvalue is being assigned to. This is the same error as writing</p>\n\n<pre><code>myfunc() = 16;\n</code></pre>\n\n<p>Cosmetic note: In this case it is better to use an if else statement instead of a conditional operator, because it is more clear here.</p>\n\n<pre><code>if (i == 3)\n    a = 4;\nelse\n    a = 10;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 348, "user_id": 6518677, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-CB_YA9-tCBY/AAAAAAAAAAI/AAAAAAAAAA8/okkXHjvnMY8/photo.jpg?sz=128", "display_name": "Neel Patel", "link": "https://stackoverflow.com/users/6518677/neel-patel"}, "is_accepted": false, "score": 2, "last_activity_date": 1467210114, "last_edit_date": 1467210114, "creation_date": 1467209722, "answer_id": 38102321, "question_id": 38101550, "link": "https://stackoverflow.com/questions/38101550/getting-error-lvalue-required-as-left-operand-of-assignment/38102321#38102321", "title": "Getting error &quot;lvalue required as left operand of assignment&quot;", "body": "<p>?: is a ternary operator.<br>\nternary operator have higher precedence than '=' operator.<br>\nso 9th line of your code work like this..</p>\n\n<pre><code>    (i == 3 ? a = 4 : a) = 10;\n</code></pre>\n\n<p>you have to use parenthesis or modify your sentence.<br>\nyou can replace your 9th line with either of following line..</p>\n\n<pre><code>    i == 3 ? a = 4 : (a = 10);\n\n    a = i == 3 ? 4 : 10;\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user8084014"}, "is_accepted": false, "score": 0, "last_activity_date": 1496244056, "last_edit_date": 1496244056, "creation_date": 1496112809, "answer_id": 44252690, "question_id": 38101550, "link": "https://stackoverflow.com/questions/38101550/getting-error-lvalue-required-as-left-operand-of-assignment/44252690#44252690", "title": "Getting error &quot;lvalue required as left operand of assignment&quot;", "body": "<p>The ternary operator does not work like this. You should use parenthesis to give higher priority to the equality operator. Check the priority precedence. By default, equality operators have least priority.</p>\n"}], "owner": {"reputation": 51, "user_id": 5520094, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jFFqt.jpg?s=128&g=1", "display_name": "EmZo Stark", "link": "https://stackoverflow.com/users/5520094/emzo-stark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 364, "favorite_count": 0, "answer_count": 6, "score": 3, "last_activity_date": 1545383577, "creation_date": 1467208063, "last_edit_date": 1467218113, "question_id": 38101550, "link": "https://stackoverflow.com/questions/38101550/getting-error-lvalue-required-as-left-operand-of-assignment", "title": "Getting error &quot;lvalue required as left operand of assignment&quot;", "body": "<p>I am a novice in C and having the following problem while compiling a simple code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main()\n{\n    int i, a, b;\n    i = 3;\n    a = b = 0;\n\n    printf(\"Before: \");\n    printf(\"%d %d\\n\", a, b);\n    i == 3 ? a = 4 : a = 10; /* Line 9 */\n\n    printf(\"After: \");\n    printf(\"%d %d\\n\", a, b);\n    return 0;\n}\n</code></pre>\n\n<p>Gives me error:</p>\n\n<pre><code>#gcc some.c\nIn function \u2018main\u2019:\nsome.c:9: error: lvalue required as left operand of assignment\n</code></pre>\n\n<p>I cannot understand it. What am i doing wrong?</p>\n"}, {"tags": ["c", "linux", "header", "include", "kernel"], "answers": [{"tags": [], "owner": {"reputation": 87, "user_id": 6386218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad0d3cb9b60dbbbf6ebfaad936fbcdb0?s=128&d=identicon&r=PG&f=1", "display_name": "Beka", "link": "https://stackoverflow.com/users/6386218/beka"}, "is_accepted": false, "score": 2, "last_activity_date": 1467209131, "creation_date": 1467209131, "answer_id": 38102058, "question_id": 38101480, "link": "https://stackoverflow.com/questions/38101480/cant-include-linux-cred-h-header-file-no-such-file-or-directory/38102058#38102058", "title": "cant include linux/cred.h header file: &quot;No such file or directory&quot;", "body": "<p>Find required file cred.h and put in the folders the compiler will search for it.</p>\n\n<pre><code>gcc ..... -I&lt;include folder&gt; .....\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6528686, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77127d1d07400dd515c5915b1e5cb56f?s=128&d=identicon&r=PG&f=1", "display_name": "desperateHacker", "link": "https://stackoverflow.com/users/6528686/desperatehacker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 860, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1467218477, "creation_date": 1467207881, "last_edit_date": 1467218477, "question_id": 38101480, "link": "https://stackoverflow.com/questions/38101480/cant-include-linux-cred-h-header-file-no-such-file-or-directory", "title": "cant include linux/cred.h header file: &quot;No such file or directory&quot;", "body": "<p>im currently trying to include the cred.h header file because I want to rewrite the uid, guid, ... which are inside the struct cred. But the include fails with the error message \"fatal error: linux/cred.h: No such file or directory\". I guess this happens because I cant include kernel header files to a user space program. Is there any way to solve this problem?</p>\n\n<hr>\n\n<p>Update:</p>\n\n<p>ah I forgot to mention that I want to compile it using the android ndk-build command, but there is a similiar optionn\nthe find command gives this output:  </p>\n\n<pre><code>sudo find / -name cred.h\n/tmp/mozilla_alex0/cred.h\n/home/alex/Android/Sdk/goldfish/include/linux/cred.h\n/usr/src/linux-headers-4.4.0-24/include/linux/cred.h\n/usr/src/linux-headers-4.4.0-21/include/linux/cred.h\n</code></pre>\n\n<p>now I tried the following:  </p>\n\n<pre><code>$ ndk-build -I /usr/src/linux-headers-4.4.0-21/include/linux/ \n[armeabi] Compile thumb  : futex_exploit &lt;= exploit.c\n/home/alex/Android/libfutex_exploit-master/libfutex_exploit-master/jni/exploit.c:34:18: fatal error: cred.h: No such file or directory\n #include &lt;cred.h&gt;\n                  ^\ncompilation terminated.\n</code></pre>\n\n<p>when try to compile the file with gcc I get the same error:</p>\n\n<pre><code>$ gcc -I/usr/src/linux-headers-4.4.0-21/include/linux/ exploit.c -o exploit\nIn file included from /usr/include/stdio.h:33:0,\n                 from exploit.c:21:\n/usr/src/linux-headers-4.4.0-21/include/linux/stddef.h:4:31: fatal error: uapi/linux/stddef.h: No such file or directory\ncompilation terminated.\n</code></pre>\n"}, {"tags": ["c", "arrays", "pointers"], "comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1467208126, "post_id": 38101390, "comment_id": 63636958, "body": "Also see <a href=\"http://stackoverflow.com/questions/37549594/why-do-i-get-a-mysterious-crash-or-segmentation-fault-when-i-copy-data-to-an-u\">Why do I get a mysterious crash or \u201csegmentation fault\u201d when I copy data to an uninitialized pointer?</a>."}], "answers": [{"tags": [], "owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "is_accepted": false, "score": 0, "last_activity_date": 1467207929, "last_edit_date": 1495535333, "creation_date": 1467207929, "answer_id": 38101509, "question_id": 38101390, "link": "https://stackoverflow.com/questions/38101390/inconsistent-array-contents-in-c/38101509#38101509", "title": "Inconsistent array contents in c", "body": "<p>The problem is that you are inserting pointers to memory inside a local array <code>command</code> into <code>user_input</code> without making a proper copy. This leads to undefined behavior.</p>\n\n<p>When you do this</p>\n\n<pre><code>word = strtok (user_command,\" \");\n</code></pre>\n\n<p><code>word</code> gets a pointer that points inside <code>char user_command[10]</code>. If you want to insert it into <code>user_input[word_counter]</code>, duplicate the string.</p>\n\n<p>If <code>strdup</code> is available, and you don't mind using it, a simple solution would be</p>\n\n<pre><code>user_input[word_counter] = strdup(word); // You need to do it in two places\n</code></pre>\n\n<p>You can also use your own <code>strdup</code> as described in <a href=\"https://stackoverflow.com/a/252802/335858\">this Q&amp;A</a>.</p>\n"}], "owner": {"reputation": 185, "user_id": 5299052, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/503755266454502/picture?type=large", "display_name": "Haziq Nordin", "link": "https://stackoverflow.com/users/5299052/haziq-nordin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 81, "favorite_count": 0, "closed_date": 1467208106, "answer_count": 1, "score": 0, "last_activity_date": 1467207929, "creation_date": 1467207676, "question_id": 38101390, "link": "https://stackoverflow.com/questions/38101390/inconsistent-array-contents-in-c", "closed_reason": "Duplicate", "title": "Inconsistent array contents in c", "body": "<p>I'm trying to split user input into an array of strings in C. It works 40% of the time. Sometimes, users will input a string and all will be as predicted. Sometimes, the same string will be inputted, and the content of the arrays will be different. I cannot figure out why.</p>\n\n<pre><code>void run_game(struct board *made_board){\n    char **user_command;\n\n    user_command = (char **)malloc(sizeof(char *)*4);\n    user_command = split_string(user_command);\n\n    printf(\"Input1: %s\\n\", user_command[0]);\n    printf(\"Input2: %s\\n\", user_command[1]);\n    printf(\"Input3: %s\\n\", user_command[2]);\n}\n\nchar** split_string(char **user_input){\n    char user_command[10];\n    char *word;\n    int word_counter = 0;\n\n    fgets(user_command, 10, stdin);\n    while(strlen(user_command)&gt;9){\n        fgets(user_command, 10, stdin);\n    }\n\n    word = strtok (user_command,\" \");\n    user_input[word_counter] = word;\n    word_counter++;\n\n    while (word != NULL){\n        word = strtok (NULL, \" \");\n        user_input[word_counter] = word;\n        word_counter++;\n    }\n    return user_input;\n}\n</code></pre>\n\n<p>Input1, Input2 and Input3 sometimes will be what comes in from fgets, sometimes it will be random characters. That's two different behaviour for the exact same input.</p>\n"}, {"tags": ["c", "segmentation-fault", "dynamic-memory-allocation", "bit-fields", "sieve-of-eratosthenes"], "comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1467207306, "post_id": 38100985, "comment_id": 63636214, "body": "<i>Where</i> in your code do you get SIGSEGV?"}, {"owner": {"reputation": 175, "user_id": 6519765, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4bb37d1eec3217a29c53814d3b35e171?s=128&d=identicon&r=PG&f=1", "display_name": "Matthias", "link": "https://stackoverflow.com/users/6519765/matthias"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1467207476, "post_id": 38100985, "comment_id": 63636378, "body": "@AndrewHenle I wrote a comment."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1467207996, "post_id": 38100985, "comment_id": 63636849, "body": "You say you&#39;re using a <i>bit</i> array, but you seem actually to be using a <i>byte</i> array.  Maybe.  Your code is a bit hard to follow.  If you indeed intend to use bit arrays, then it would be better to factor out your test and set operations into macros."}, {"owner": {"reputation": 2592, "user_id": 2963819, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bcc08ce2a4490cf3496020812fe10ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Ishay Peled", "link": "https://stackoverflow.com/users/2963819/ishay-peled"}, "edited": false, "score": 0, "creation_date": 1467208030, "post_id": 38100985, "comment_id": 63636866, "body": "I don&#39;t know too much about what your code is doing, but the reason it crashed  is you&#39;re trying to access elements beyond the size of array sieve"}, {"owner": {"reputation": 2592, "user_id": 2963819, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bcc08ce2a4490cf3496020812fe10ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Ishay Peled", "link": "https://stackoverflow.com/users/2963819/ishay-peled"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1467208126, "post_id": 38100985, "comment_id": 63636959, "body": "@MichaelWalz It is provided minimal, complete and verifiable. I just ran his code"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1467208471, "post_id": 38100985, "comment_id": 63637248, "body": "<code>prime * prime</code> is apparently a larger value than <code>upperLimit</code>, simple as that? Use a debugger and check."}, {"owner": {"reputation": 27385, "user_id": 1382251, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/17622c39e8ead537a0944c767551b2fe?s=128&d=identicon&r=PG", "display_name": "barak manos", "link": "https://stackoverflow.com/users/1382251/barak-manos"}, "edited": false, "score": 1, "creation_date": 1467208510, "post_id": 38100985, "comment_id": 63637275, "body": "I&#39;m betting that <code>prime * prime</code> overflows 64 bits."}, {"owner": {"reputation": 175, "user_id": 6519765, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4bb37d1eec3217a29c53814d3b35e171?s=128&d=identicon&r=PG&f=1", "display_name": "Matthias", "link": "https://stackoverflow.com/users/6519765/matthias"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1467208558, "post_id": 38100985, "comment_id": 63637321, "body": "@Lundin As I wrote in the comment, this occurs for prime == 2."}, {"owner": {"reputation": 175, "user_id": 6519765, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4bb37d1eec3217a29c53814d3b35e171?s=128&d=identicon&r=PG&f=1", "display_name": "Matthias", "link": "https://stackoverflow.com/users/6519765/matthias"}, "reply_to_user": {"reputation": 27385, "user_id": 1382251, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/17622c39e8ead537a0944c767551b2fe?s=128&d=identicon&r=PG", "display_name": "barak manos", "link": "https://stackoverflow.com/users/1382251/barak-manos"}, "edited": false, "score": 0, "creation_date": 1467208575, "post_id": 38100985, "comment_id": 63637332, "body": "@barakmanos As I wrote in the comment, the error occurs for prime == 2."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1467208728, "post_id": 38100985, "comment_id": 63637472, "body": "@Matthias it&#39;s an index out of bounds problem when accessing <code>sieve[x]</code>. You can easily check this by putting some <code>assert</code>s in your code."}, {"owner": {"reputation": 175, "user_id": 6519765, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4bb37d1eec3217a29c53814d3b35e171?s=128&d=identicon&r=PG&f=1", "display_name": "Matthias", "link": "https://stackoverflow.com/users/6519765/matthias"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1467208766, "post_id": 38100985, "comment_id": 63637517, "body": "@MichaelWalz That was my guess as well, but I was hoping for an explanation."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1467215870, "post_id": 38100985, "comment_id": 63642925, "body": "@Matthias that&#39;s easy to find out yourself. Just check if the index is within bounds before each access (just for debugging purposes)."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1467239555, "post_id": 38100985, "comment_id": 63655784, "body": "The posted code causes the compiler <code>gcc</code> to output two warning messages about 1) the <code>while</code> loop with the <code>++prime</code> operation and 2) the <code>while</code> loop with the <code>--number</code> operation.  Strongly suggest you fix those two problems."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1467240052, "post_id": 38100985, "comment_id": 63655951, "body": "the posted code is allocating memory from the <code>heap</code> via the call to <code>calloc()</code>, but  failing to pass the pointer returned from <code>calloc()</code> to the function: <code>free()</code>."}], "answers": [{"comments": [{"owner": {"reputation": 175, "user_id": 6519765, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4bb37d1eec3217a29c53814d3b35e171?s=128&d=identicon&r=PG&f=1", "display_name": "Matthias", "link": "https://stackoverflow.com/users/6519765/matthias"}, "edited": false, "score": 0, "creation_date": 1467208366, "post_id": 38101604, "comment_id": 63637150, "body": "Because I only need one bit per prime not a whole <code>prime_t</code>."}, {"owner": {"reputation": 2505, "user_id": 3118401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c066b73af214d8e7cf6b52f6ef75314a?s=128&d=identicon&r=PG", "display_name": "marcolz", "link": "https://stackoverflow.com/users/3118401/marcolz"}, "reply_to_user": {"reputation": 175, "user_id": 6519765, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4bb37d1eec3217a29c53814d3b35e171?s=128&d=identicon&r=PG&f=1", "display_name": "Matthias", "link": "https://stackoverflow.com/users/6519765/matthias"}, "edited": false, "score": 0, "creation_date": 1467208425, "post_id": 38101604, "comment_id": 63637205, "body": "You current implementation uses 1 <i>byte</i>, not one bit."}, {"owner": {"reputation": 175, "user_id": 6519765, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4bb37d1eec3217a29c53814d3b35e171?s=128&d=identicon&r=PG&f=1", "display_name": "Matthias", "link": "https://stackoverflow.com/users/6519765/matthias"}, "edited": false, "score": 0, "creation_date": 1467208487, "post_id": 38101604, "comment_id": 63637262, "body": "Where does it use one <i>byte</i>? I set single bits with <code>sieve[number&#47;sizeof(prime_t)] |= (((prime_t) 1) &lt;&lt; (number % sizeof(prime_t)));</code>"}, {"owner": {"reputation": 2375, "user_id": 3985859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34af6d164c53c629e625c11a3d11bbcc?s=128&d=identicon&r=PG&f=1", "display_name": "Karsten Koop", "link": "https://stackoverflow.com/users/3985859/karsten-koop"}, "edited": false, "score": 2, "creation_date": 1467208528, "post_id": 38101604, "comment_id": 63637296, "body": "<code>sizeof</code> returns bytes, not bits"}, {"owner": {"reputation": 2505, "user_id": 3118401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c066b73af214d8e7cf6b52f6ef75314a?s=128&d=identicon&r=PG", "display_name": "marcolz", "link": "https://stackoverflow.com/users/3118401/marcolz"}, "edited": false, "score": 1, "creation_date": 1467208549, "post_id": 38101604, "comment_id": 63637312, "body": "Ok, so in every byte you set exactly 1 bit, true. You divide by <code>sizeof(prime_t)</code> instead of <code>(sizeof(prime_t) * 8)</code> when indexing."}, {"owner": {"reputation": 175, "user_id": 6519765, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4bb37d1eec3217a29c53814d3b35e171?s=128&d=identicon&r=PG&f=1", "display_name": "Matthias", "link": "https://stackoverflow.com/users/6519765/matthias"}, "edited": false, "score": 0, "creation_date": 1467208675, "post_id": 38101604, "comment_id": 63637413, "body": "See <a href=\"http://stackoverflow.com/questions/2525310/how-to-define-and-work-with-an-array-of-bits-in-c\">this</a> to verify that my implementation is a valid bit array."}, {"owner": {"reputation": 175, "user_id": 6519765, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4bb37d1eec3217a29c53814d3b35e171?s=128&d=identicon&r=PG&f=1", "display_name": "Matthias", "link": "https://stackoverflow.com/users/6519765/matthias"}, "edited": false, "score": 0, "creation_date": 1467208853, "post_id": 38101604, "comment_id": 63637599, "body": "@marcolz Oh I see, thank you really much! I would be happy if you&#39;d add this as an answer."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 175, "user_id": 6519765, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4bb37d1eec3217a29c53814d3b35e171?s=128&d=identicon&r=PG&f=1", "display_name": "Matthias", "link": "https://stackoverflow.com/users/6519765/matthias"}, "edited": false, "score": 0, "creation_date": 1467209244, "post_id": 38101604, "comment_id": 63637962, "body": "@Matthias I&#39;ve just verified that the bug is that you don&#39;t allocate enough memory. Overall, the algorithm is needlessly obscure, with those real ugly while loops. I suspect you have lost track of what your own program does somewhere among those messy loops. Try to split the silly one-liners into several lines."}], "tags": [], "owner": {"reputation": 2505, "user_id": 3118401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c066b73af214d8e7cf6b52f6ef75314a?s=128&d=identicon&r=PG", "display_name": "marcolz", "link": "https://stackoverflow.com/users/3118401/marcolz"}, "is_accepted": false, "score": 2, "last_activity_date": 1467208996, "last_edit_date": 1467208996, "creation_date": 1467208172, "answer_id": 38101604, "question_id": 38100985, "link": "https://stackoverflow.com/questions/38100985/c-bitarray-segmentation-fault/38101604#38101604", "title": "C - BitArray Segmentation Fault", "body": "<p>You allocate X <strong>bytes</strong> with <code>calloc</code>, dividing the total by sizeof(prime_t), yet act as if you have room for X prime_t elements later on.</p>\n\n<p>Edit: Or actually even, you are allocating an array of <em>1</em> element with size X.</p>\n\n<p>If you want to do it the way you are using it now, you should do:</p>\n\n<p><code>calloc(X, sizeof(prime_t))</code> instead.</p>\n\n<p>Edit: The major other issue in your code is that you are using byte-level indexing instead of bit-level.</p>\n\n<p>Note that there are <code>sizeof(prime_t) * 8</code> bits in a <code>prime_t</code>, so in every byte you set exactly 1 bit, true. You divide by <code>sizeof(prime_t)</code> instead of <code>(sizeof(prime_t) * 8)</code> when indexing.</p>\n"}, {"comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 175, "user_id": 6519765, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4bb37d1eec3217a29c53814d3b35e171?s=128&d=identicon&r=PG&f=1", "display_name": "Matthias", "link": "https://stackoverflow.com/users/6519765/matthias"}, "edited": false, "score": 0, "creation_date": 1467209164, "post_id": 38101965, "comment_id": 63637894, "body": "@Matthias, no, you allocated more bytes than you need by a factor of <code>CHAR_BIT</code> (which is normally 8)."}, {"owner": {"reputation": 175, "user_id": 6519765, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4bb37d1eec3217a29c53814d3b35e171?s=128&d=identicon&r=PG&f=1", "display_name": "Matthias", "link": "https://stackoverflow.com/users/6519765/matthias"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1467209209, "post_id": 38101965, "comment_id": 63637936, "body": "@JohnBollinger Thank you really much!"}, {"owner": {"reputation": 175, "user_id": 6519765, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4bb37d1eec3217a29c53814d3b35e171?s=128&d=identicon&r=PG&f=1", "display_name": "Matthias", "link": "https://stackoverflow.com/users/6519765/matthias"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1467209704, "post_id": 38101965, "comment_id": 63638353, "body": "@Lundin Do you know a readable line of code to do the some (not wasting 8x memory)?"}, {"owner": {"reputation": 175, "user_id": 6519765, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4bb37d1eec3217a29c53814d3b35e171?s=128&d=identicon&r=PG&f=1", "display_name": "Matthias", "link": "https://stackoverflow.com/users/6519765/matthias"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1467209908, "post_id": 38101965, "comment_id": 63638510, "body": "@JohnBollinger Quick question: What happens on exotic machines, where <i>CHAR_BIT</i> is not 8? What does <code>sizeof(uint64_t)</code> return? Because it then can&#39;t return an even number like 8... What is the better way to allocate (<code>number&#47;(sizeof(prime_t)*8)</code> or <code>#define BITS_IN_PRIME_T 64</code> and then <code>number&#47;BITS_IN_PRIME_T</code>)"}, {"owner": {"reputation": 175, "user_id": 6519765, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4bb37d1eec3217a29c53814d3b35e171?s=128&d=identicon&r=PG&f=1", "display_name": "Matthias", "link": "https://stackoverflow.com/users/6519765/matthias"}, "edited": false, "score": 0, "creation_date": 1467210222, "post_id": 38101965, "comment_id": 63638757, "body": "What will <code>sizeof(uint64_t)</code> return with <code>CHAR_BIT</code> != 8?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 175, "user_id": 6519765, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4bb37d1eec3217a29c53814d3b35e171?s=128&d=identicon&r=PG&f=1", "display_name": "Matthias", "link": "https://stackoverflow.com/users/6519765/matthias"}, "edited": false, "score": 0, "creation_date": 1467210278, "post_id": 38101965, "comment_id": 63638795, "body": "@Matthias every type&#39;s representation consists of an integral number of units comprising <code>CHAR_BIT</code> bits each.  However, these bits may include <i>padding</i> bits.  If <code>CHAR_BIT</code> were, say, 12, and the system provided <code>uint64_t</code> at all, then <code>sizeof(uint64_t)</code> would be an integer greater than or equal to 6, and the representation of <code>uint64_t</code> would include some padding bits."}, {"owner": {"reputation": 175, "user_id": 6519765, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4bb37d1eec3217a29c53814d3b35e171?s=128&d=identicon&r=PG&f=1", "display_name": "Matthias", "link": "https://stackoverflow.com/users/6519765/matthias"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1467210392, "post_id": 38101965, "comment_id": 63638891, "body": "@JohnBollinger Thank you for the clarification! I leant really much in this question :)"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1467210436, "post_id": 38101965, "comment_id": 63638920, "body": "@Mattias, so in fact, I&#39;m not quite correct to say that you&#39;re off by a factor of <code>CHAR_BIT</code> instead of 8, and dbush is not quite correct to use <code>sizeof(prime_t)*8</code>.  For elements of type <code>uint32_t</code>, one ought to use plain 32.  But in practice, you are unlikely to run into a machine where it makes a difference."}, {"owner": {"reputation": 175, "user_id": 6519765, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4bb37d1eec3217a29c53814d3b35e171?s=128&d=identicon&r=PG&f=1", "display_name": "Matthias", "link": "https://stackoverflow.com/users/6519765/matthias"}, "edited": false, "score": 0, "creation_date": 1467211859, "post_id": 38101965, "comment_id": 63640028, "body": "I&#39;m still curious about the allocation: Lets consider <code>upperLimit</code> to be 64. Then we allocate <code>(upperLimit + 1) * sizeof(prime_t) &#47; 8</code> = <code>65 * 8&#47;8</code> = 65 bytes, which seems wrong to me (Shouldn&#39;t we want to allocate 8 or 16 bytes?)."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 175, "user_id": 6519765, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4bb37d1eec3217a29c53814d3b35e171?s=128&d=identicon&r=PG&f=1", "display_name": "Matthias", "link": "https://stackoverflow.com/users/6519765/matthias"}, "edited": false, "score": 0, "creation_date": 1467212497, "post_id": 38101965, "comment_id": 63640515, "body": "@Matthias Good catch.  I edited the part on how much to allocate."}, {"owner": {"reputation": 175, "user_id": 6519765, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4bb37d1eec3217a29c53814d3b35e171?s=128&d=identicon&r=PG&f=1", "display_name": "Matthias", "link": "https://stackoverflow.com/users/6519765/matthias"}, "edited": false, "score": 0, "creation_date": 1467213884, "post_id": 38101965, "comment_id": 63641489, "body": "Your current edit won&#39;t always be a multiple of <code>sizeof(prime_t)</code> - consider <code>upperLimit</code> to be <i>56</i> your current code will resolve in 56/8 + 8 = 15 which isn&#39;t a multiple of <code>sizeof(prime_t)</code> and therefore won&#39;t return a valid pointer to a <code>prime_t</code>-array. This is what I&#39;m thinking of - next comment (Please bear with me):"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 175, "user_id": 6519765, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4bb37d1eec3217a29c53814d3b35e171?s=128&d=identicon&r=PG&f=1", "display_name": "Matthias", "link": "https://stackoverflow.com/users/6519765/matthias"}, "edited": false, "score": 0, "creation_date": 1467214012, "post_id": 38101965, "comment_id": 63641588, "body": "@Matthias That&#39;s ok, it doesn&#39;t need to be a multiple.  You&#39;ll get at most <code>sizeof(prime_t)</code> more bytes than you need, which is negligible."}, {"owner": {"reputation": 175, "user_id": 6519765, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4bb37d1eec3217a29c53814d3b35e171?s=128&d=identicon&r=PG&f=1", "display_name": "Matthias", "link": "https://stackoverflow.com/users/6519765/matthias"}, "edited": false, "score": 0, "creation_date": 1467214078, "post_id": 38101965, "comment_id": 63641641, "body": "<code>((upperLimit&#47;CHAR_BIT + sizeof(prime_t) - 1)&#47;sizeof(prime_t)) * sizeof(prime_t)</code>. I&#39;m thinking this way: The final result needs to be a multiple of <code>sizeof(prime_t)</code> - therefore the trailing <code>* sizeof(prime_t)</code>. The question is how many of this <code>sizeof(prime_t)</code> sized blocks will be needed. We have <code>upperLimit</code> numbers so we&#39;ll need <i>at least</i> <code>upperLimit&#47;CHAR_BIT</code> bytes. Since we want not the number of bytes, but the number of <code>sizeof(prime_t)</code> sized blocks, I need to divide by <code>sizeof(prime_t)</code>. But if <code>upperLimit&#47;CHAR_BIT</code> is less than <code>sizeof(prime_t)</code> the expression will be round down."}, {"owner": {"reputation": 175, "user_id": 6519765, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4bb37d1eec3217a29c53814d3b35e171?s=128&d=identicon&r=PG&f=1", "display_name": "Matthias", "link": "https://stackoverflow.com/users/6519765/matthias"}, "edited": false, "score": 0, "creation_date": 1467214176, "post_id": 38101965, "comment_id": 63641713, "body": "Therefore I add <code>(sizeof(prime_t) - 1)</code> to be sure, that always enough space is alloced. You may wonder why I end with <code>...&#47;sizeof(prime_t)) * sizeof(prime_t)</code>, which can see pretty much like <code>* 1&#47;1</code>, but the parentheses are important - the parentheses are used to floor. I really hope this makes sense."}, {"owner": {"reputation": 175, "user_id": 6519765, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4bb37d1eec3217a29c53814d3b35e171?s=128&d=identicon&r=PG&f=1", "display_name": "Matthias", "link": "https://stackoverflow.com/users/6519765/matthias"}, "edited": false, "score": 0, "creation_date": 1467214413, "post_id": 38101965, "comment_id": 63641881, "body": "But when only 15 bytes are allocated and I access <code>sieve[1]</code> I&#39;ll access 16 bytes and therefore memory which I does not own, don&#39;t I?"}, {"owner": {"reputation": 175, "user_id": 6519765, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4bb37d1eec3217a29c53814d3b35e171?s=128&d=identicon&r=PG&f=1", "display_name": "Matthias", "link": "https://stackoverflow.com/users/6519765/matthias"}, "edited": false, "score": 0, "creation_date": 1467214916, "post_id": 38101965, "comment_id": 63642198, "body": "Oh, I see since we only wanted 56 bits we&#39;ll never access <code>sieve[1]</code>..."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 175, "user_id": 6519765, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4bb37d1eec3217a29c53814d3b35e171?s=128&d=identicon&r=PG&f=1", "display_name": "Matthias", "link": "https://stackoverflow.com/users/6519765/matthias"}, "edited": false, "score": 0, "creation_date": 1467215040, "post_id": 38101965, "comment_id": 63642284, "body": "@Matthias If you wanted to be more exact you could use <code>ceil(ceil((double)upperLimit &#47; sizeof(prime_t)) &#47; 8) * sizeof(prime_t)</code>, but a few extra bytes won&#39;t hurt."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 175, "user_id": 6519765, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4bb37d1eec3217a29c53814d3b35e171?s=128&d=identicon&r=PG&f=1", "display_name": "Matthias", "link": "https://stackoverflow.com/users/6519765/matthias"}, "edited": false, "score": 0, "creation_date": 1467267357, "post_id": 38101965, "comment_id": 63663421, "body": "@Matthias I can&#39;t be bothered to decipher this, but there is zero relation between the number of lines of source code and memory used. There is no performance what-so-ever gained from squeezing in all these operations on a single line of code. I&#39;d recommend studying assembler and how the compiler actually translates C code into machine code. Once you got this program up and running, you could also post it at <a href=\"http://codereview.stackexchange.com/\">codereview.stackexchange.com</a> for advise how to rewrite it properly."}, {"owner": {"reputation": 175, "user_id": 6519765, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4bb37d1eec3217a29c53814d3b35e171?s=128&d=identicon&r=PG&f=1", "display_name": "Matthias", "link": "https://stackoverflow.com/users/6519765/matthias"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1467288799, "post_id": 38101965, "comment_id": 63676993, "body": "@Lundin I was never talking about the line of code and that it couldn&#39;t get split up. I thought you were talking about the <i>and</i>&#39;s and bit shifts. I&#39;m well aware of that the lines of code written don&#39;t correlate with the memory use... My code is actually split up into <code>blockIndex</code> and <code>blockBit</code>, which I think greatly supports the reader. <i>codereview</i> is a great idea though :)"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 175, "user_id": 6519765, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4bb37d1eec3217a29c53814d3b35e171?s=128&d=identicon&r=PG&f=1", "display_name": "Matthias", "link": "https://stackoverflow.com/users/6519765/matthias"}, "edited": false, "score": 0, "creation_date": 1467288948, "post_id": 38101965, "comment_id": 63677079, "body": "@Matthias What he means is don&#39;t try to be too clever with your code.  By breaking out the increment/decrement into a separate line from the bit checking, it makes your code easier to read and maintain.  It might also be a good idea to create macros for getting/setting a bit to make it more readable."}, {"owner": {"reputation": 175, "user_id": 6519765, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4bb37d1eec3217a29c53814d3b35e171?s=128&d=identicon&r=PG&f=1", "display_name": "Matthias", "link": "https://stackoverflow.com/users/6519765/matthias"}, "edited": false, "score": 0, "creation_date": 1467289058, "post_id": 38101965, "comment_id": 63677153, "body": "@dbush You are right. I actually had to do so otherwise this would be a case of <a href=\"http://stackoverflow.com/questions/3852768/unsequenced-value-computations-a-k-a-sequence-points\">unsequenced modification</a>."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 4, "last_activity_date": 1467212476, "last_edit_date": 1467212476, "creation_date": 1467208942, "answer_id": 38101965, "question_id": 38100985, "link": "https://stackoverflow.com/questions/38100985/c-bitarray-segmentation-fault/38101965#38101965", "title": "C - BitArray Segmentation Fault", "body": "<p>You're not getting the correct bit number:</p>\n\n<pre><code>sieve[number/sizeof(prime_t)] |= (((prime_t) 1) &lt;&lt; (number % sizeof(prime_t)));\n</code></pre>\n\n<p>When you do the division and mod, you need to divide/mod by the number of <em>bits</em>, not the number of <em>bytes</em>:</p>\n\n<pre><code>sieve[number/(sizeof(prime_t)*8)] |= (((prime_t) 1) &lt;&lt; (number % (sizeof(prime_t)*8)));\n</code></pre>\n\n<p>And similarly:</p>\n\n<pre><code>while ((sieve[++prime/(sizeof(prime_t)*8)] &amp; (prime_t)1 &lt;&lt; (prime % (sizeof(prime_t)*8))) != 0)\n\n...\n\nwhile ((sieve[--number/(sizeof(prime_t)*8)] &amp; (((prime_t)1) &lt;&lt; (number % (sizeof(prime_t)*8)))) != 0)\n</code></pre>\n\n<p>EDIT:</p>\n\n<p>You're also not allocating the right amount of memory.  You need a number of bytes equal to the limit <em>divided by the number of bits</em>, plus 1 <code>sizeof(prime_t)</code> to round up.</p>\n\n<pre><code>prime_t *sieve = calloc(1, (upperLimit / 8) + sizeof(prime_t));\n</code></pre>\n\n<p>As it right now, you're allocating twice the bytes you need.</p>\n\n<p>Also, if you want to defend against cases where there are more or less than 8 bits to a byte, use <code>CHAR_BIT</code> in the above code in place of <code>8</code>.  Whatever <code>sizeof(uint64_t)</code> evaluates to shouldn't matter, as you'll still get the proper number of bits required.</p>\n"}], "owner": {"reputation": 175, "user_id": 6519765, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4bb37d1eec3217a29c53814d3b35e171?s=128&d=identicon&r=PG&f=1", "display_name": "Matthias", "link": "https://stackoverflow.com/users/6519765/matthias"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 133, "favorite_count": 0, "accepted_answer_id": 38101965, "answer_count": 2, "score": 1, "last_activity_date": 1467212476, "creation_date": 1467206767, "question_id": 38100985, "link": "https://stackoverflow.com/questions/38100985/c-bitarray-segmentation-fault", "title": "C - BitArray Segmentation Fault", "body": "<p>I'm currently trying to implement the Sieve of Eratosthenes in C using a BitSet, but I get a segmentation fault, when I try to sieve the primes up to 1,000,000 (1 million) - 100,000 (100 thousand) is still working though and I can't figure out why I get the seg-fault.</p>\n\n<p>This is the code I use (I marked the line, in which the error occurs):</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdint.h&gt;\n#include &lt;inttypes.h&gt;\n\nvoid eSieve(uint64_t upperLimit);\nint main(int argc, char *argv[]) {\n  uint64_t upperLimit;\n\n  if (argc == 2) {\n    upperLimit = (uint64_t) atoll(argv[1]);\n    printf(\"Using custom limit: %\" PRIu64 \"\\n\", upperLimit);\n  } else {\n    upperLimit = 1000;\n    printf(\"Using default limit: %\" PRIu64 \"\\n\", upperLimit);\n  }\n\n  eSieve(upperLimit);\n\n  return 0;\n}\n\ntypedef uint32_t prime_t;\n\nvoid eSieve(uint64_t upperLimit) {\n  if (upperLimit &lt; 2) {\n    printf(\"FAILURE: Bad upper limit.\\n\");\n    return;\n  }\n\n  prime_t *sieve = calloc(1, (upperLimit + sizeof(prime_t) - 1)/sizeof(prime_t));\n\n  if (!sieve) {\n    printf(\"FAILURE: Could not initialize sieve.\\n\");\n    return;\n  }\n\n  sieve[0] |= 3;    // Set first and second bit (representing 0 and 1)\n\n  uint64_t prime, number;\n  for (prime = 2; prime * prime &lt; upperLimit; ) {\n    for (number = prime * prime; number &lt; upperLimit; number += prime) {\n      // Segmentation fault for prime = 2 and number = 258048\n      sieve[number/sizeof(prime_t)] |= (((prime_t) 1) &lt;&lt; (number % sizeof(prime_t)));\n    }\n\n    while ((sieve[++prime/sizeof(prime_t)] &amp; (prime_t)1 &lt;&lt; (prime % sizeof(prime_t))) != 0)\n      ;\n  }\n\n  number = upperLimit;\n  while ((sieve[--number/sizeof(prime_t)] &amp; (((prime_t)1) &lt;&lt; (number % sizeof(prime_t)))) != 0)\n    ;\n\n  printf(\"Greatest prime-number below %\" PRIu64 \": %\" PRIu64 \"\\n\", \n      upperLimit, number);\n}\n</code></pre>\n\n<p>Does anybody know why the error occurs? I'm guessing that now enough space is allocated (somehow), but I can't see how this would be possible at the moment...</p>\n"}, {"tags": ["c", "memory-leaks", "malloc", "free"], "comments": [{"owner": {"reputation": 2104, "user_id": 4635537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cad50ed18dff8aaff0ff427ea7b1067d?s=128&d=identicon&r=PG", "display_name": "sameerkn", "link": "https://stackoverflow.com/users/4635537/sameerkn"}, "edited": false, "score": 0, "creation_date": 1467207802, "post_id": 38100933, "comment_id": 63636675, "body": "The moment you did <code>payload=&amp;dati.data;</code> in <code>update function</code> you lost memory allocate for <code>payload</code>."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1467207844, "post_id": 38100933, "comment_id": 63636713, "body": "At a brief glance, your whole program looks like one big memory leak. If you don&#39;t free what you allocate, you get leaks... For every call to malloc there needs to be a call to free."}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 6504373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae0ddb26a052f85d1f07009b4bdf3033?s=128&d=identicon&r=PG&f=1", "display_name": "Flank", "link": "https://stackoverflow.com/users/6504373/flank"}, "edited": false, "score": 0, "creation_date": 1467207939, "post_id": 38101313, "comment_id": 63636801, "body": "if i use the free at the end of the function i have a error: 00bf8000-00c19000 rw-p 00000000 00:00 0                                  [heap] 7f4e3c000000-7f4e3c021000 rw-p 00000000 00:00 0  7f4e3c021000-7f4e40000000 ---p 00000000 00:00 0  7f4e44000000-7f4e44021000 rw-p 00000000 00:00 0  7f4e44021000-7f4e48000000 ---p 00000000 00:00 0  7f4e48d37000-7f4e48d4d000 r-xp 00000000 08:01 15205453                   /lib/x86_64-linux-gnu/libgcc_s.so.1 7f4e48d4d000-7f4e48f4c000 ---p 00016000 08:01 15205453                   /lib/x86_64-linux-gnu/libgcc_s.so.1"}, {"owner": {"reputation": 2500, "user_id": 6499716, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/L11cU.jpg?s=128&g=1", "display_name": "Shiro", "link": "https://stackoverflow.com/users/6499716/shiro"}, "reply_to_user": {"reputation": 41, "user_id": 6504373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae0ddb26a052f85d1f07009b4bdf3033?s=128&d=identicon&r=PG&f=1", "display_name": "Flank", "link": "https://stackoverflow.com/users/6504373/flank"}, "edited": false, "score": 0, "creation_date": 1467207989, "post_id": 38101313, "comment_id": 63636844, "body": "Please specify which function and what kind of error you are receiving?"}, {"owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "edited": false, "score": 0, "creation_date": 1467208218, "post_id": 38101313, "comment_id": 63637031, "body": "<code>malldati</code> is being added to the hash structure, so he should <i>not</i> <code>free</code> it before the function exits.  <code>key1</code> is a bit more problematic."}, {"owner": {"reputation": 2500, "user_id": 6499716, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/L11cU.jpg?s=128&g=1", "display_name": "Shiro", "link": "https://stackoverflow.com/users/6499716/shiro"}, "reply_to_user": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "edited": false, "score": 0, "creation_date": 1467208477, "post_id": 38101313, "comment_id": 63637253, "body": "@JohnBode Thank you. I just updated my post. Also found a mistake in code."}], "tags": [], "owner": {"reputation": 2500, "user_id": 6499716, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/L11cU.jpg?s=128&g=1", "display_name": "Shiro", "link": "https://stackoverflow.com/users/6499716/shiro"}, "is_accepted": false, "score": 0, "last_activity_date": 1467208297, "last_edit_date": 1467208297, "creation_date": 1467207512, "answer_id": 38101313, "question_id": 38100933, "link": "https://stackoverflow.com/questions/38100933/c-memory-leak-why/38101313#38101313", "title": "C- Memory leak, why?", "body": "<p>For every <code>malloc</code> you need to <code>free</code> once.</p>\n\n<p>In <code>put</code>: You need to <code>free</code> <code>key1</code> just before <code>put</code> ends.</p>\n\n<p>In <code>update</code>: You need to <code>free</code> <code>payload</code> just before <code>updates</code> ends.</p>\n\n<p>Also:  <code>payload=&amp;dati.data; // you set payload to point to a new address, memory will be lost</code> </p>\n\n<pre><code>void put(message_t dati, op_t *err){\n     message_data_t payload=dati.data;\n     message_t *key1=malloc(sizeof(message_t));\n    *key1=dati.hdr;\n     message_data_t *malldati=(message_data_t *)malloc(sizeof(message_data_t));\n     malldati-&gt;len=payload.len;\n     malldati-&gt;buf=payload.buf;\n     if((icl_hash_insert(hash,(void *)&amp;key1-&gt;key,malldati))==NULL){\n         *err=13;\n         free(chiave);\n     }else{\n\n          *err=11;\n       }\n       free(key1);\n       free(malldati);\n  }\n\n\nvoid update(message_t dati, op_t *err){\n\n     message_data_t *exist;\n     message_data_t *payload=(message_data_t *) malloc(sizeof(message_data_t));\n     payload=&amp;dati.data; // you set payload to point to a new address, memory will be lost \n     message_hdr_t key1=dati.hdr;\n\n     exist=icl_hash_find(hash, &amp;key1.key);\n\n     if(exist == NULL){\n         *err=20;\n     }else{\n        if(exist-&gt;len!=payload-&gt;len){\n            *err=19;\n\n         }else{\n            exist=payload;\n            *err=11;\n\n         }\n    }\n    free(payload);\n }\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 41, "user_id": 6504373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae0ddb26a052f85d1f07009b4bdf3033?s=128&d=identicon&r=PG&f=1", "display_name": "Flank", "link": "https://stackoverflow.com/users/6504373/flank"}, "edited": false, "score": 0, "creation_date": 1467211317, "post_id": 38101823, "comment_id": 63639574, "body": "thaks for help!  no memory leaks!"}, {"owner": {"reputation": 41, "user_id": 6504373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae0ddb26a052f85d1f07009b4bdf3033?s=128&d=identicon&r=PG&f=1", "display_name": "Flank", "link": "https://stackoverflow.com/users/6504373/flank"}, "edited": false, "score": 0, "creation_date": 1467211504, "post_id": 38101823, "comment_id": 63639737, "body": "but i other memory leakes caused by the thread, i have edit the post"}], "tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": true, "score": 1, "last_activity_date": 1467208635, "creation_date": 1467208635, "answer_id": 38101823, "question_id": 38100933, "link": "https://stackoverflow.com/questions/38100933/c-memory-leak-why/38101823#38101823", "title": "C- Memory leak, why?", "body": "<p>This has me concerned:</p>\n\n<pre><code>message_t *key1=malloc(sizeof(message_t));\n*key1=dati.hdr;\n...\nif((icl_hash_insert(hash,(void *)&amp;key1-&gt;key,malldati))==NULL){\n</code></pre>\n\n<p>You're dynamically allocating a whole new object of <code>message_t</code>, but only saving the address of one of its members.  Unless <code>hdr</code> is the first member of <code>message_t</code> and <code>key</code> is the first member of <code>hdr</code>, the address you save in the hash is <em>not</em> the same as the address of the dynamically allocated object.  That means you won't be able to <code>free</code> that memory later on.  </p>\n\n<p>Based on these snippets, it seems to me like you'd only want to make a copy of the <em>key</em> to save in the hash, not the entire <code>message_t</code> struct, like so:<pre><code><em>T</em> *key1 = malloc( sizeof *key1 ); // replace <em>T</em> with the actual key type\n*key1 = dati.hdr.key;\n...\nif(( icl_hash_insert( hash, key1, malldati )) == NULL ){\n</code></pre></p>\n\n<p>I'm assuming that keys and data items are <code>free</code>d when they are removed from the hash.  </p>\n"}], "owner": {"reputation": 41, "user_id": 6504373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae0ddb26a052f85d1f07009b4bdf3033?s=128&d=identicon&r=PG&f=1", "display_name": "Flank", "link": "https://stackoverflow.com/users/6504373/flank"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 143, "favorite_count": 0, "accepted_answer_id": 38101823, "answer_count": 2, "score": 0, "last_activity_date": 1498617138, "creation_date": 1467206664, "last_edit_date": 1498617138, "question_id": 38100933, "link": "https://stackoverflow.com/questions/38100933/c-memory-leak-why", "title": "C- Memory leak, why?", "body": "<p>I found the following functions with <code>valgrind</code> me that tells me:</p>\n\n<pre><code>  LEAK SUMMARY:\n ==3120==    definitely lost: 7,968 bytes in 377 blocks\n ==3120==    indirectly lost: 0 bytes in 0 blocks\n ==3120==      possibly lost: 1,904 bytes in 7 blocks\n ==3120==    still reachable: 224 bytes in 7 blocks\n ==3120==         suppressed: 0 bytes in 0 blocks\n ==3120== Reachable blocks (those to which a pointer was found) are not shown.\n ==3120== To see them, rerun with: --leak-check=full --show-leak-kinds=all\n ==3120== \n ==3120== For counts of detected and suppressed errors, rerun with: -v\n ==3120== Use --track-origins=yes to see where uninitialised values come from\n ==3120== ERROR SUMMARY: 644 errors from 6 contexts (suppressed: 0 from 0)\n</code></pre>\n\n<p>the functions are:</p>\n\n<pre><code> void put(message_t dati, op_t *err){\n     message_data_t payload=dati.data;\n     message_t *key1=malloc(sizeof(message_t));\n    *key1=dati.hdr;\n     message_data_t *malldati=(message_data_t *)malloc(sizeof(message_data_t));\n     malldati-&gt;len=payload.len;\n     malldati-&gt;buf=payload.buf;\n     if((icl_hash_insert(hash,(void *)&amp;key1-&gt;key,malldati))==NULL){\n         *err=13;\n         free(chiave);\n     }else{\n\n          *err=11;\n       }\n  }\n</code></pre>\n\n<p>If I add the free in the else the program don't work.</p>\n\n<pre><code> void update(message_t dati, op_t *err){\n\n     message_data_t *exist;\n     message_data_t *payload=(message_data_t *) malloc(sizeof(message_data_t));\n     payload=&amp;dati.data;\n     message_hdr_t key1=dati.hdr;\n\n     exist=icl_hash_find(hash, &amp;key1.key);\n\n     if(exist == NULL){\n         *err=20;\n     }else{\n        if(exist-&gt;len!=payload-&gt;len){\n            *err=19;\n\n         }else{\n            exist=payload;\n            *err=11;\n\n         }\n    }\n }\n\n\nprototypes icl_hash_insert icl_hash_find and functions are:\n\nicl_entry_t * icl_hash_insert(icl_hash_t *, void*, void *);\n\nvoid * icl_hash_find(icl_hash_t *, void* );\n</code></pre>\n\n<p>The problem are in the key1 (put) and payload (update)\nHow I can fix the code?\nThanks for help!</p>\n\n<p>UPDATE: Thanks for the answer, now I have another memory leak caused by the thread. <code>Valgrind</code> report:</p>\n\n<pre><code> ==6111== HEAP SUMMARY:\n ==6111==     in use at exit: 1,904 bytes in 7 blocks\n ==6111==   total heap usage: 1,168 allocs, 1,161 frees, 8,042,496 bytes allocated\n ==6111== \n ==6111== Thread 1:\n ==6111== 1,904 bytes in 7 blocks are possibly lost in loss record 1 of 1\n ==6111==    at 0x4C2FB55: calloc (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)\n ==6111==    by 0x40136D4: allocate_dtv (dl-tls.c:322)\n ==6111==    by 0x40136D4: _dl_allocate_tls (dl-tls.c:539)\n ==6111==    by 0x4E422AE: allocate_stack (allocatestack.c:588)\n ==6111==    by 0x4E422AE: pthread_create@@GLIBC_2.2.5 (pthread_create.c:539)\n ==6111==    by 0x40243D: main (membox.c:642)\n ==6111== \n ==6111== LEAK SUMMARY:\n ==6111==    definitely lost: 0 bytes in 0 blocks\n ==6111==    indirectly lost: 0 bytes in 0 blocks\n ==6111==      possibly lost: 1,904 bytes in 7 blocks\n ==6111==    still reachable: 0 bytes in 0 blocks\n ==6111==         suppressed: 0 bytes in 0 blocks\n ==6111== \n ==6111== For counts of detected and suppressed errors, rerun with: -v\n ==6111== Use --track-origins=yes to see where uninitialised values come from\n ==6111== ERROR SUMMARY: 641 errors from 3 contexts (suppressed: 0 from 0)\n</code></pre>\n\n<p>What's the problem?</p>\n"}, {"tags": ["c", "linux", "multithreading", "linux-kernel", "locks"], "answers": [{"tags": [], "owner": {"reputation": 10901, "user_id": 1076479, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/eLQUX.jpg?s=128&g=1", "display_name": "Gil Hamilton", "link": "https://stackoverflow.com/users/1076479/gil-hamilton"}, "is_accepted": false, "score": 4, "last_activity_date": 1467213541, "creation_date": 1467213541, "answer_id": 38103769, "question_id": 38100734, "link": "https://stackoverflow.com/questions/38100734/in-the-linux-kernel-does-spin-lock-irqsave-protect-me-from-signal-handlers-p/38103769#38103769", "title": "In the Linux kernel, does spin_lock_irqsave() protect me from signal handlers, page faults, calls to schedule()?", "body": "<p><code>spin_lock_irqsave</code> takes a lock and disables (temporarily masks) interrupts. You will not experience an interrupt until you release the lock (or otherwise re-enable interrupts -- which you shouldn't do). Likewise, you will not and cannot be preempted since preemption requires an interrupt in order to cause a transfer of control.</p>\n\n<p>An interrupt is a signal from an external device indicating that it needs attention. The CPU hardware supports a mechanism allowing automatic transfer of control to an \"interrupt handler\" when the interrupt signal is asserted (but this can be temporarily masked which is what <code>spin_lock_irqsave</code> does).</p>\n\n<p>Exceptions are similar to interrupts except they are caused by the program execution not by external hardware/devices. So this includes divide-by-zero, illegal instructions, page faults. In all but the most unusual cases, your code should ensure there are no exceptions. For example, you should not be causing a page fault when you hold a spin lock. This will result in a kernel OOPS.</p>\n\n<p>Signal handlers are primarily a user-mode concept. Signals sent to a process are checked for explicitly by the kernel at times when it's appropriate to do so, and either cause an action directly (like process termination) or cause the next return to user mode in that process to vector to the user code signal handler. You should not access any code that would do that while you hold the spin lock. </p>\n\n<p>Likewise, you may not call <code>schedule</code> while you hold a spin lock, because...</p>\n\n<p>Spin locks are intended to be held for very short periods of time to protect against simultaneous access to data structures that are shared across multiple processors. The reason interrupts are disabled is so that you can <em>assure</em> that the task holding the spin lock <em>doesn't</em> get preempted -- because if it did, other CPUs could be left spinning for a long time or even forever.</p>\n\n<p>... and <code>schedule</code> is specifically intended to allow you to give up control to another task.</p>\n\n<p>See also this article. Specific details are probably outdated but all the concepts are still valid. <a href=\"https://www.kernel.org/pub/linux/kernel/people/rusty/kernel-locking/\" rel=\"nofollow\">https://www.kernel.org/pub/linux/kernel/people/rusty/kernel-locking/</a></p>\n"}], "owner": {"reputation": 29, "user_id": 4257604, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ee766e65a036812d7d0316b69c3e41a?s=128&d=identicon&r=PG&f=1", "display_name": "loulan", "link": "https://stackoverflow.com/users/4257604/loulan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1017, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1467213541, "creation_date": 1467206135, "question_id": 38100734, "link": "https://stackoverflow.com/questions/38100734/in-the-linux-kernel-does-spin-lock-irqsave-protect-me-from-signal-handlers-p", "title": "In the Linux kernel, does spin_lock_irqsave() protect me from signal handlers, page faults, calls to schedule()?", "body": "<p>I'm a bit confused as to what constitutes an interrupt in the Linux kernel. From what I understand, spin_lock_irqsave() / spin_lock_irqrestore() ensure that my critical section won't be preempted by an interrupt handler. Fair enough.</p>\n\n<p>But I'm a bit confused by what constitutes an interrupt handler. First, I'm not 100% sure that I'm also protected from preemption from softirqs. Is this the case?</p>\n\n<p>What about exceptions? From what I understand, they're the same thing as interrupts, but not really. Am I protected from preemption by a page fault handler when I use spin_lock_irqsave() for instance? What precisely happens when a page fault occurs, is the mechanism used to handle them the exact same thing as interrupts?</p>\n\n<p>What about signal handlers? I don't get how those are implemented. What if I send a signal a SIGTERM, SIGINT, or SIGKILL signal? Is this implemented with a soft IRQ? something else? Can such a signal preempt my critical section when I use spin_lock_irqsave()? Or not at all because those signals are handled exclusively in user space?</p>\n\n<p>What about calls to schedule()? Can those preempt me at any time, even in my critical sections when I use spin_lock_irqsave()?</p>\n\n<p>I guess what I'd really like to know is what exactly can preempt me when I use spin_lock_irqsave(). Nobody who uses the same lock as me, and no interrupt handlers, for sure. What about all these other things? What about softirqs/tasklets/work queues?</p>\n\n<p>Finally, is spin_lock_irqsave() stronger than spin_lock_bh()? I.e., does spin_lock_irqsave() prevent preemption from bottom halves (i.e., softirqs, tasklets, and work queues)?</p>\n\n<p>I've been Googling all of this quite a bit, but I find it hard to find clear answers.</p>\n"}, {"tags": ["c", "windows", "bash", "cunit"], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 5102259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8943afc3c3a3656600131813b4146bc?s=128&d=identicon&r=PG&f=1", "display_name": "jhj", "link": "https://stackoverflow.com/users/5102259/jhj"}, "edited": false, "score": 0, "creation_date": 1467206184, "post_id": 38100328, "comment_id": 63635329, "body": "Ah really? that&#39;s strange. I just opened the Bash terminal in the library&#39;s home directory and executed that command you said. Do I need to do something else?"}, {"owner": {"reputation": 1, "user_id": 6523542, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60294d9f28d6d6dff63a590fdd534a1d?s=128&d=identicon&r=PG&f=1", "display_name": "kiokoman", "link": "https://stackoverflow.com/users/6523542/kiokoman"}, "reply_to_user": {"reputation": 41, "user_id": 5102259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8943afc3c3a3656600131813b4146bc?s=128&d=identicon&r=PG&f=1", "display_name": "jhj", "link": "https://stackoverflow.com/users/5102259/jhj"}, "edited": false, "score": 0, "creation_date": 1467216992, "post_id": 38100328, "comment_id": 63643700, "body": "i don&#39;t know, i downloaded the archive out of curiosity, usually you have to launch the command &quot;make&quot; and &quot;make install&quot;"}, {"owner": {"reputation": 41, "user_id": 5102259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8943afc3c3a3656600131813b4146bc?s=128&d=identicon&r=PG&f=1", "display_name": "jhj", "link": "https://stackoverflow.com/users/5102259/jhj"}, "edited": false, "score": 0, "creation_date": 1467218516, "post_id": 38100328, "comment_id": 63644625, "body": "when I run the command you said it completes successfully but when I go onto to run the <code>make</code> command I get <code>bash: make: command not found</code>. Have you got any suggestions on what I could do to get it working?"}], "tags": [], "owner": {"reputation": 1, "user_id": 6523542, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60294d9f28d6d6dff63a590fdd534a1d?s=128&d=identicon&r=PG&f=1", "display_name": "kiokoman", "link": "https://stackoverflow.com/users/6523542/kiokoman"}, "is_accepted": false, "score": 0, "last_activity_date": 1467205164, "creation_date": 1467205164, "answer_id": 38100328, "question_id": 38100038, "link": "https://stackoverflow.com/questions/38100038/how-to-install-cunit-on-windows/38100328#38100328", "title": "How to install CUnit on Windows", "body": "<p>CUnit-2.1-3.tar.bz2 ? configure is missing from the archive :)\nthere is a file called \"bootstrap\"\ntry \nchmod +x bootstrap\n./bootstrap</p>\n"}], "owner": {"reputation": 41, "user_id": 5102259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8943afc3c3a3656600131813b4146bc?s=128&d=identicon&r=PG&f=1", "display_name": "jhj", "link": "https://stackoverflow.com/users/5102259/jhj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1767, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1467205164, "creation_date": 1467204490, "last_edit_date": 1495541305, "question_id": 38100038, "link": "https://stackoverflow.com/questions/38100038/how-to-install-cunit-on-windows", "title": "How to install CUnit on Windows", "body": "<p>I've downloaded the library to my desktop but when I try and install it by running the <code>./configure</code> command I get an error:</p>\n\n<p><code>bash: ./configure: No such file or directory</code></p>\n\n<p>I've looked at 2 existing questions on SO (<a href=\"https://stackoverflow.com/questions/12514408/building-cunit-on-windows\">link1</a> and <a href=\"https://stackoverflow.com/questions/29891151/building-cunit-with-cygwin-on-windows\">link2</a>) but they didn't solve my problem. Have I downloaded it correctly? I downloaded and extracted the folder to my desktop then opened the <strong>Bash terminal</strong> in the library's home directory and executed the <code>./configure</code> command.</p>\n\n<p>Would be very grateful if someone could help, I'm out of ideas!</p>\n"}, {"tags": ["c++", "c", "parsing", "format", "translation"], "comments": [{"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 0, "creation_date": 1467203597, "post_id": 38099546, "comment_id": 63633410, "body": "If the user-defined format has well-defined lexical and grammar rules, flex/bison would be appropriate. If, on the other hand, the user-defined format doesn&#39;t fit nicely into the lexical and LALR(1) buckets, a handmade parser would be the option of last resort."}, {"owner": {"reputation": 41, "user_id": 6497579, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/998a6fd2c9d8feb9aa38d29b53d75824?s=128&d=identicon&r=PG&f=1", "display_name": "Franconet", "link": "https://stackoverflow.com/users/6497579/franconet"}, "reply_to_user": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 0, "creation_date": 1467204014, "post_id": 38099546, "comment_id": 63633712, "body": "user defined format has well defined lexical and grammar rules. If I use flex/bison, I am obliged to work in c, right?"}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 0, "creation_date": 1467205065, "post_id": 38099546, "comment_id": 63634513, "body": "I&#39;ve written a similar program in python that generated c++ code from xml dtd document. I don&#39;t know whether it is better or worse than some other way. Of course, in that case a parser already existed."}, {"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 0, "creation_date": 1467206605, "post_id": 38099546, "comment_id": 63635614, "body": "Both flex and bison have options to generate C++ code. See their respective documentation for more information."}, {"owner": {"reputation": 41, "user_id": 6497579, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/998a6fd2c9d8feb9aa38d29b53d75824?s=128&d=identicon&r=PG&f=1", "display_name": "Franconet", "link": "https://stackoverflow.com/users/6497579/franconet"}, "edited": false, "score": 0, "creation_date": 1467206947, "post_id": 38099546, "comment_id": 63635902, "body": "Sorry I didn&#39;t express my concern about c  in a proper way. I think that writing a format translator using C is not a great idea because strings manipulation in C  is not so easy. Whit flex and bison I can only write a C parser right?"}, {"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 0, "creation_date": 1467212840, "post_id": 38099546, "comment_id": 63640726, "body": "As I wrote: with the appropriate options, flex and bison will generate a C++ parser, instead of the default parser."}, {"owner": {"reputation": 41, "user_id": 6497579, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/998a6fd2c9d8feb9aa38d29b53d75824?s=128&d=identicon&r=PG&f=1", "display_name": "Franconet", "link": "https://stackoverflow.com/users/6497579/franconet"}, "edited": false, "score": 0, "creation_date": 1467215193, "post_id": 38099546, "comment_id": 63642413, "body": "ok I got it, thank you.."}], "answers": [{"tags": [], "owner": {"reputation": 54044, "user_id": 3723423, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a2c916310a1261b53773de75fc83e5ad?s=128&d=identicon&r=PG&f=1", "display_name": "Christophe", "link": "https://stackoverflow.com/users/3723423/christophe"}, "is_accepted": false, "score": 0, "last_activity_date": 1467235992, "last_edit_date": 1495540349, "creation_date": 1467206156, "answer_id": 38100742, "question_id": 38099546, "link": "https://stackoverflow.com/questions/38099546/from-propietary-format-to-c-classes/38100742#38100742", "title": "From propietary format to c++ classes", "body": "<p>It all depends on the complextity of your language and the transformations you intend.  </p>\n\n<p><strong>Option 1: hand-crafted ad-hoc processing</strong></p>\n\n<p>If your transformations are simple and mostly convert some tokens from your source language into the target language (e.g \"type\" into \"struct\" and \"&lt;>\" into \"{}\"), you could think of a hand-crafted parsing using string operations or <a href=\"https://regex101.com/r/eS4kK7/1\" rel=\"nofollow noreferrer\">regexes</a> using <a href=\"http://www.cplusplus.com/reference/regex/\" rel=\"nofollow noreferrer\"><code>std::regex</code></a>. </p>\n\n<p>But this is not sufficient here:  you must identify statements in your source langage to generate semi-column separated c and c++ statements. Furhtermore, you must related the <code>[]</code> to the right element.  Furthermore, to generate correct getter/setter your code must get understanding of the statement content. </p>\n\n<p>So yes, here you'll need a lexer and a parser.</p>\n\n<p><strong>Option 2: hand-crafted parser</strong></p>\n\n<p>For \"simple\" languages, you could craft easily <a href=\"https://en.wikipedia.org/wiki/Recursive_descent_parser\" rel=\"nofollow noreferrer\">a recursive descent parser</a>. What does \"simple\" mean ?  It means that the language which can be described with a LL(1) grammar. Without entering now too much in compiler theory, it's more or less languages where one token ahead uniquely determine which grammar construct you have.  </p>\n\n<p>Note that you have a very simple calculator example designed this way in the \"<em>C++ Programming language</em>\" from Bjarne Stroustrup. </p>\n\n<p><strong>Option 3: use a compiler generator</strong></p>\n\n<p>While lexical scanners and recursive descent parsers are relatively easy to code, it's still somehow reinventing the wheel.  And for languages which are not LL(1) compliant, you have no other choice than using a compiler generator.  </p>\n\n<p>Flex/bison is then a very reasonable and widely supported choice. But you have to become familiar with its logic, grammar files, and code templates.  It's not something that you could master in a couple of hours.   </p>\n\n<p>If you have to support a custom language professionally, it's really worth the investment.  If it's a small project, the learning curve could play against you.  </p>\n\n<p><strong>Option 4: lightweight boost alternative</strong></p>\n\n<p>Another, lighter, approach could be to use <a href=\"http://www.boost.org/doc/libs/1_61_0/libs/spirit/doc/html/index.html\" rel=\"nofollow noreferrer\">boost spirit</a>, which bases itself on c++ and is easier to learn: you express the grammar rule directly in C++.  There are too main components: <a href=\"http://www.boost.org/doc/libs/1_61_0/libs/spirit/doc/html/spirit/lex/tutorials/lexer_quickstart2.html\" rel=\"nofollow noreferrer\">Lex</a> for lexical scanner and <a href=\"http://www.boost.org/doc/libs/1_61_0/libs/spirit/doc/html/spirit/qi/tutorials/employee___parsing_into_structs.html\" rel=\"nofollow noreferrer\">Qi</a> for parsers. </p>\n\n<p>It's ok for small to medium parsers (like a data definition language), but it has <a href=\"https://stackoverflow.com/a/438532/3723423\">some serious limitations</a> if you have a full language.  And by the way, as far as I know, it's limited to LL(k) grammars. </p>\n"}], "owner": {"reputation": 41, "user_id": 6497579, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/998a6fd2c9d8feb9aa38d29b53d75824?s=128&d=identicon&r=PG&f=1", "display_name": "Franconet", "link": "https://stackoverflow.com/users/6497579/franconet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1467235992, "creation_date": 1467203298, "question_id": 38099546, "link": "https://stackoverflow.com/questions/38099546/from-propietary-format-to-c-classes", "title": "From propietary format to c++ classes", "body": "<p>Given an input like this (USER DEFINED FORMAT): </p>\n\n<pre><code>type dog&lt;\nint years\nchar[] name\n&gt;\n</code></pre>\n\n<p>How can I generate 2 or more differents files like these:</p>\n\n<pre><code>file1.c\n------------\nstruct dog{\nint years\nchar name\n}\n\nfile2.cpp\n-------------\nclass dog{\nint years\nstring name\n%get and set methods\n}\n</code></pre>\n\n<p>Is a parser generator like flex and bison the best way? Or are there better way?</p>\n"}, {"tags": ["c", "arrays", "string", "reverse"], "comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 2, "creation_date": 1467200556, "post_id": 38098344, "comment_id": 63631285, "body": "Start by reading the chapter about strings in your C programming book."}, {"owner": {"reputation": 95, "user_id": 5886767, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2872859675ecdd716ede9e84a3b279b5?s=128&d=identicon&r=PG", "display_name": "Mrs.Brightside", "link": "https://stackoverflow.com/users/5886767/mrs-brightside"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1467200917, "post_id": 38098344, "comment_id": 63631581, "body": "I have but I wanted a simple explanation. My textbook doesn&#39;t explain well."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 6, "creation_date": 1467201041, "post_id": 38098344, "comment_id": 63631670, "body": "Then get a new book. Any beginner-level book which doesn&#39;t mention nul termination of C strings is bad."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1467220329, "post_id": 38098344, "comment_id": 63645725, "body": "Related: <a href=\"http://programmers.stackexchange.com/q/181505/35384\">programmers.stackexchange.com/q/181505/35384</a>"}], "answers": [{"tags": [], "owner": {"reputation": 2988, "user_id": 452414, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/rDMfs.png?s=128&g=1", "display_name": "babon", "link": "https://stackoverflow.com/users/452414/babon"}, "is_accepted": false, "score": 2, "last_activity_date": 1467200720, "last_edit_date": 1467200720, "creation_date": 1467200228, "answer_id": 38098430, "question_id": 38098344, "link": "https://stackoverflow.com/questions/38098344/what-is-with-the-null-character-in-reverse-string-program/38098430#38098430", "title": "What is with the null character in reverse string program?", "body": "<p>In C, a string always has a <code>\\0</code> at the end. Read <a href=\"https://en.wikipedia.org/wiki/Null-terminated_string\" rel=\"nofollow\">why</a> and <a href=\"http://c-faq.com/~scs/cclass/notes/sx8.html\" rel=\"nofollow\">how</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 39, "user_id": 6508988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0d040a4f6df31dcdf1c28be4e18309f?s=128&d=identicon&r=PG&f=1", "display_name": "Dareg", "link": "https://stackoverflow.com/users/6508988/dareg"}, "is_accepted": false, "score": 2, "last_activity_date": 1467200556, "last_edit_date": 1467200556, "creation_date": 1467200316, "answer_id": 38098464, "question_id": 38098344, "link": "https://stackoverflow.com/questions/38098344/what-is-with-the-null-character-in-reverse-string-program/38098464#38098464", "title": "What is with the null character in reverse string program?", "body": "<p>The <code>\\0</code> is not really a character. It's the way a <a href=\"/questions/tagged/c\" class=\"post-tag\" title=\"show questions tagged &#39;c&#39;\" rel=\"tag\">c</a> program mark the end of a string. So if you only want to reverse a string you don't have to move this character at the begining of the reversed string.</p>\n\n<pre><code>original string: hello\\0\nreverse string : olleh\\0\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 95, "user_id": 5886767, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2872859675ecdd716ede9e84a3b279b5?s=128&d=identicon&r=PG", "display_name": "Mrs.Brightside", "link": "https://stackoverflow.com/users/5886767/mrs-brightside"}, "edited": false, "score": 1, "creation_date": 1467200723, "post_id": 38098490, "comment_id": 63631435, "body": "Thank You! So basically it&#39;s marking the end of the string instead of it going until the end of array size?"}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 95, "user_id": 5886767, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2872859675ecdd716ede9e84a3b279b5?s=128&d=identicon&r=PG", "display_name": "Mrs.Brightside", "link": "https://stackoverflow.com/users/5886767/mrs-brightside"}, "edited": false, "score": 1, "creation_date": 1467201017, "post_id": 38098490, "comment_id": 63631648, "body": "@nedst3r Yes. Function strlen used in your program searches the terminating zero and counts the number of characters before the terminating zero. For example if you have an array char s[10] = &quot;Hello&quot;; then strlen will return 5 though the array has 10 characters."}, {"owner": {"reputation": 2592, "user_id": 2963819, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bcc08ce2a4490cf3496020812fe10ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Ishay Peled", "link": "https://stackoverflow.com/users/2963819/ishay-peled"}, "reply_to_user": {"reputation": 95, "user_id": 5886767, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2872859675ecdd716ede9e84a3b279b5?s=128&d=identicon&r=PG", "display_name": "Mrs.Brightside", "link": "https://stackoverflow.com/users/5886767/mrs-brightside"}, "edited": false, "score": 0, "creation_date": 1467202494, "post_id": 38098490, "comment_id": 63632682, "body": "@nedst3r There is no end of array size, if you omit the terminating null and try to print the string it will just keep accessing sequential memory until a segfault will occur"}, {"owner": {"reputation": 1884, "user_id": 3078414, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b1180f5e68d3542488d66de14ff53964?s=128&d=identicon&r=PG&f=1", "display_name": "user3078414", "link": "https://stackoverflow.com/users/3078414/user3078414"}, "edited": false, "score": 0, "creation_date": 1467225185, "post_id": 38098490, "comment_id": 63648689, "body": "@VladfromMoscow what a brilliant and educational answer - many C textbooks would wish to have such explanations (including the elegant call of <code>printf()</code> as optional argument to <code>printf()</code>. Yet, with all the due respect to your indisputable work and reputation, please don&#39;t mind my asking: would it be more legitimate naming the terminating <code>&#39;\\0&#39;</code> character <i>nul character</i> or <i>zero character</i> ? AFAIK, <i>zero character</i> is just <code>&#39;0&#39;</code>."}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 1884, "user_id": 3078414, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b1180f5e68d3542488d66de14ff53964?s=128&d=identicon&r=PG&f=1", "display_name": "user3078414", "link": "https://stackoverflow.com/users/3078414/user3078414"}, "edited": false, "score": 0, "creation_date": 1467287218, "post_id": 38098490, "comment_id": 63675939, "body": "@user3078414 Maybe it could be said terminating zero-character.:)"}], "tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": true, "score": 8, "last_activity_date": 1467204962, "last_edit_date": 1467204962, "creation_date": 1467200392, "answer_id": 38098490, "question_id": 38098344, "link": "https://stackoverflow.com/questions/38098344/what-is-with-the-null-character-in-reverse-string-program/38098490#38098490", "title": "What is with the null character in reverse string program?", "body": "<p>If you want that a character array would contain a string then it has to have the terminating zero.</p>\n\n<p>For example function <code>strlen</code> that is used in your program counts characters in a character array before the terminating zero.</p>\n\n<p>Also function <code>printf</code> used with the format specifier <code>%s</code> outputs characters from a character array until the terminating zero will be encountered.</p>\n\n<p>For example if you have an array like this</p>\n\n<pre><code>char s[10] = \"Hello\";\n</code></pre>\n\n<p>then the call <code>strlen( s )</code> returns 5 instead of 10. And call printf( \"%s\\n\", s ); outputs 6 characters (including the new line character).</p>\n\n<p>Consider this demonstrative program</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void) \n{\n    char s[10] = \"Hello\";\n\n    printf( \"%d\\n\", printf( \"%s\\n\", s ) );\n\n    return 0;\n}\n</code></pre>\n\n<p>Its output is</p>\n\n<pre><code>Hello\n6\n</code></pre>\n\n<p>This initialization</p>\n\n<pre><code>char s[10] = \"Hello\";\n</code></pre>\n\n<p>is fully equivalent to</p>\n\n<pre><code>char s[10] = { 'H', 'e', 'l', 'l', 'o', '\\0', '\\0', '\\0', '\\0', '\\0'};\n</code></pre>\n\n<p>If you need to reverse the string stored in the array it is obvious that you need to reverse characters before the first terminating zero. And if you want to copy the string in the reversed order to another character array you need to append the destination array with the terminating zero.</p>\n\n<p>This loop</p>\n\n<pre><code>for (i = length - 1, j= 0; i &gt;= 0; i--, j++)\n    reverse[j] = original[i];\n</code></pre>\n\n<p>copies in the reversed order all characters except the terminating zero from the original character array starting with the last character before the terminating zero to the destination character array. You need to append the destination character array with the terminating zero</p>\n\n<pre><code>reverse[j] = '\\0';\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 1, "creation_date": 1467219067, "post_id": 38103168, "comment_id": 63644954, "body": "&quot;<i>This will help to mark</i>&quot;, it does not  just &quot;<i>help</i>&quot; it &quot;<b><i>is</i></b>&quot; the mark."}, {"owner": {"reputation": 484, "user_id": 6490242, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26613036fd92e6ee9e1ce9b64037069d?s=128&d=identicon&r=PG&f=1", "display_name": "Twinkle", "link": "https://stackoverflow.com/users/6490242/twinkle"}, "reply_to_user": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1467219318, "post_id": 38103168, "comment_id": 63645103, "body": "Corrected :).  Thanks"}], "tags": [], "owner": {"reputation": 484, "user_id": 6490242, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26613036fd92e6ee9e1ce9b64037069d?s=128&d=identicon&r=PG&f=1", "display_name": "Twinkle", "link": "https://stackoverflow.com/users/6490242/twinkle"}, "is_accepted": false, "score": 0, "last_activity_date": 1467219255, "last_edit_date": 1467219255, "creation_date": 1467212002, "answer_id": 38103168, "question_id": 38098344, "link": "https://stackoverflow.com/questions/38098344/what-is-with-the-null-character-in-reverse-string-program/38103168#38103168", "title": "What is with the null character in reverse string program?", "body": "<p>\\0 is for null terminating the string. This will mark the end of the string. If it is not null terminated, the data in the succeeding locations will also wrongly treat as part of string.</p>\n"}], "owner": {"reputation": 95, "user_id": 5886767, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2872859675ecdd716ede9e84a3b279b5?s=128&d=identicon&r=PG", "display_name": "Mrs.Brightside", "link": "https://stackoverflow.com/users/5886767/mrs-brightside"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1157, "favorite_count": 1, "accepted_answer_id": 38098490, "answer_count": 4, "score": 2, "last_activity_date": 1467219255, "creation_date": 1467199986, "last_edit_date": 1467201779, "question_id": 38098344, "link": "https://stackoverflow.com/questions/38098344/what-is-with-the-null-character-in-reverse-string-program", "title": "What is with the null character in reverse string program?", "body": "<p>I had to make a simple program to reverse a string. I eventually got this code from my own understanding but also help from google since I couldn't originally get it to work. It runs fine and outputs as it should and I understand all of it except for the <code>reverse[j] = '\\0'</code> statement. \nI kept getting symbols in my output when I didn't state it but I want to know how this works. Can anyone explain please?</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n\nint main(void)\n{\n    char original[20], reverse[20];\n    int length, i, j;\n\n    printf(\"Enter a string:\\n\");\n    gets(original); \n\n    length = strlen(original);\n\n    for (i = length - 1, j= 0; i &gt;= 0; i--, j++)\n        reverse[j] = original[i];\n\n    reverse[j] = '\\0';  //I don't know what this statement does exactly\n\n    printf(\"The string reversed is:\\n %s\\n\", reverse);\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "file", "structure"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1467199303, "post_id": 38096766, "comment_id": 63630378, "body": "Once you invoked undefined behaviour, anything can happen. <code>fflush(stdin)</code> does invoke undefined behaviour. Before asking here remove all known cases of undefined behaviour. As you seem not to really know what undefined behaviour implies, learn about it!"}, {"owner": {"reputation": 188, "user_id": 5055425, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/29afabdb454bb1f93f07e153a4e249e9?s=128&d=identicon&r=PG&f=1", "display_name": "ram619", "link": "https://stackoverflow.com/users/5055425/ram619"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1467203374, "post_id": 38096766, "comment_id": 63633269, "body": "@Olaf All occurences of <code>fflush(stdin)</code> removed. Please check it now."}], "answers": [{"comments": [{"owner": {"reputation": 188, "user_id": 5055425, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/29afabdb454bb1f93f07e153a4e249e9?s=128&d=identicon&r=PG&f=1", "display_name": "ram619", "link": "https://stackoverflow.com/users/5055425/ram619"}, "edited": false, "score": 0, "creation_date": 1467198644, "post_id": 38097275, "comment_id": 63629952, "body": "Yes this works but, why do we need to do this <code>fseek(f, 0, SEEK_CUR);</code> because after writing the <code>fwrite</code> makes the file pointer point to next entry on it&#39;s own ? So the loop should continue from next entry on it&#39;s own ?"}, {"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 3, "creation_date": 1467203531, "post_id": 38097275, "comment_id": 63633368, "body": "See <a href=\"http://port70.net/~nsz/c/c11/n1570.html#7.21.5.3p7\" rel=\"nofollow noreferrer\">Standard 7.21.5.3p7</a>: &quot;... output/input shall not be directly followed by input/output without an intervening call to the fflush function ...&quot;"}, {"owner": {"reputation": 188, "user_id": 5055425, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/29afabdb454bb1f93f07e153a4e249e9?s=128&d=identicon&r=PG&f=1", "display_name": "ram619", "link": "https://stackoverflow.com/users/5055425/ram619"}, "reply_to_user": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 0, "creation_date": 1467206710, "post_id": 38097275, "comment_id": 63635695, "body": "@pmg &quot;output shall not be directly followed by input without an intervening call to the <code>fflush</code> function or to a file positioning function <code>(fseek, fsetpos, or rewind)</code> &quot; So as per this if we use <code>fflush()</code> then it would be done over <code>stdout</code>?"}, {"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 2, "creation_date": 1467207276, "post_id": 38097275, "comment_id": 63636182, "body": "if you use <code>fflush()</code> you must use it for the <code>FILE *</code> you are using for freads and fwrites. If that file is a input file, or a input/output file for which the last operation was input, <code>fflush()</code> causes Undefined Behaviour (except, as far as I know, in <a href=\"https://msdn.microsoft.com/en-us/library/9yky46tz.aspx\" rel=\"nofollow noreferrer\">Microsoft Windows library</a>)"}], "tags": [], "owner": {"reputation": 184, "user_id": 6509186, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-l8b6KGNZ3jI/AAAAAAAAAAI/AAAAAAAAASM/WVZyKMHGyM0/photo.jpg?sz=128", "display_name": "Giochi Blu", "link": "https://stackoverflow.com/users/6509186/giochi-blu"}, "is_accepted": true, "score": 2, "last_activity_date": 1467197020, "creation_date": 1467197020, "answer_id": 38097275, "question_id": 38096766, "link": "https://stackoverflow.com/questions/38096766/all-content-of-file-get-duplicated-while-modifying-a-specific-entry/38097275#38097275", "title": "All content of file get duplicated while modifying a specific entry", "body": "<p>I think it's a problem between <code>fread()</code> and <code>fwrite()</code>.\nAfter you use fwrite() to modify the <code>emp</code>, you continue the <code>while</code> loop without using <code>fseek()</code>.\nIn fact, before, you used fseek() to go back and it was OK.\nNow you have to place another fseek() which doesn't move, like this:</p>\n\n<pre><code>fseek(f, 0, SEEK_CUR);\n</code></pre>\n\n<p>Now you can remove the break and your <code>Modify()</code> function would seems like this:</p>\n\n<pre><code>void modify(FILE *f)\n{\n    char user[20];\n    printf(\"\\nEnter name to modify\\n\");\n    scanf(\"%s\",user);\n    fflush(stdin);\n    rewind(f);\n\n    while(fread(&amp;e,sizeof(struct emp),1,f)==1)\n    {\n        if(strcmp(e.name,user)==0)\n        {\n            printf(\"\\nEnter new name id salary\\n\");\n            scanf(\"%s %d %f\",e.name,&amp;e.id,&amp;e.sal);\n            fflush(stdin);\n\n            fseek(f,-sizeof(struct emp),SEEK_CUR);\n            if(fwrite(&amp;e,sizeof(struct emp),1,f)==1)\n            {\n                printf(\"\\nModified successfull!!\\n\");\n                //break; //This can be removed\n\n                fseek(f, 0, SEEK_CUR); //Place this here\n            }\n            else\n            {\n                printf(\"\\nError while modifying\\n\");\n            }\n        }\n        else\n        {\n            printf(\"\\n\\nstring not matched\\n\\n\");\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 188, "user_id": 5055425, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/29afabdb454bb1f93f07e153a4e249e9?s=128&d=identicon&r=PG&f=1", "display_name": "ram619", "link": "https://stackoverflow.com/users/5055425/ram619"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 1, "accepted_answer_id": 38097275, "answer_count": 1, "score": 0, "last_activity_date": 1467203323, "creation_date": 1467195594, "last_edit_date": 1467203323, "question_id": 38096766, "link": "https://stackoverflow.com/questions/38096766/all-content-of-file-get-duplicated-while-modifying-a-specific-entry", "title": "All content of file get duplicated while modifying a specific entry", "body": "<p>This code read/write data to/from binary file. Here <code>modify()</code> will take input from user, search for it in the file. If found, will prompt user to give new entry and the older entry would be replaced.</p>\n\n<p>The question is, in <code>modify()</code> after <code>fwrite()</code> if I <code>break</code> the <code>while</code> loop then everything would be fine but, if I don't then the entry would still be modified but along with that the content of the file would be duplicated, why so ?</p>\n\n<p>As in the beginning there are no duplicate entries in the file. <strong>So what I expect is,</strong> that even if I don't use <code>break</code> the loop should go on and finally terminate when whole file has been read. Here, the <code>if(strcmp(e.name,user)==0)</code> would only be true for one entry therefore the control should enter only once in this <code>if</code> block. Then how the entries are getting duplicated ?</p>\n\n<pre><code>    #include&lt;stdio.h&gt;\n    #include&lt;stdlib.h&gt;\n    #include&lt;string.h&gt;\n\n    void add(FILE *);\n    void list(FILE *);\n    void modify(FILE *);\n\n    struct emp\n    {\n        char name[20];\n        int id;\n        float sal;\n    }e;\n\n    void add(FILE *f)\n    {\n        char *p=NULL;\n\n        printf(\"\\nEnter name id sal\\n\");\n        scanf(\" %s %d %f\", e.name,&amp;e.id,&amp;e.sal);\n\n        fseek(f,0,SEEK_END);\n        if((fwrite(&amp;e,sizeof(struct emp),1,f))==1)\n        {\n            printf(\"\\nAdded Successfully\\n\");\n        }\n        else\n        {\n            printf(\"\\nError wrting to file in ADD func\\n\");\n        }\n    }\n\n    void list(FILE *f)\n    {\n        rewind(f);\n        while(fread(&amp;e,sizeof(struct emp),1,f)&gt;0)\n        {\n            printf(\"\\nRead %s %d %f\\n\",e.name,e.id,e.sal);\n        }\n    }\n\n    void modify(FILE *f)\n    {\n        char user[20];\n        char *p=NULL;\n\n        printf(\"\\nEnter name to modify\\n\");\n        scanf(\" %s\", user);\n\n        rewind(f);\n\n        while(fread(&amp;e,sizeof(struct emp),1,f)==1)\n        {\n            //printf(\"\\n        --------------- %s %d %f\\n\",e.name,e.id,e.sal);\n            if(strcmp(e.name,user)==0)\n            {\n                //fseek(f,-sizeof(struct emp),SEEK_CUR);\n                printf(\"\\nEnter new name id salary\\n\");\n                scanf(\" %s %d %f\", e.name,&amp;e.id,&amp;e.sal);\n\n                fseek(f,-sizeof(struct emp),SEEK_CUR);\n                if(fwrite(&amp;e,sizeof(struct emp),1,f)==1)\n                {\n                    printf(\"\\nModified successfull!!\\n\");\n                    //break;\n                }\n                else\n                {\n                    printf(\"\\nError while modifying\\n\");\n                }\n            }\n            else\n            {\n                printf(\"\\n\\nstring not matched\\n\\n\");\n            }\n        }\n\n    }\n\n    int main()\n    {\n        char val='T';\n        FILE *fp=NULL;\n\n        if((fp=fopen(\"database.dat\",\"rb+\"))==NULL)\n        {\n            if((fp=fopen(\"database.dat\",\"wb+\"))==NULL)\n            {\n                printf(\"\\nError opening file in wb+ mode\\n\");\n                exit(0);\n            }\n        }\n\n        do\n        {\n            printf(\"\\nEnter a to add, l to list, d to delete, m to modify and e to exit\\n\");\n            scanf(\" %c\", &amp;val);\n\n            switch(val)\n            {\n                case 'a':\n                        add(fp);\n                        break;\n                case 'l':\n                        list(fp);\n                        break;\n                case 'm':\n                        modify(fp);\n                        break;\n                case 'd':\n    //                    del(fp);\n                        break;\n                case 'e':\n                        fclose(fp);\n                        exit(0);\n                        break;\n                default:\n                        printf(\"\\nInvalid Input\\n\");\n                        break;\n            }\n\n        }\n        while(1);\n\n    }\n</code></pre>\n"}, {"tags": ["c", "linux", "memory", "malloc", "solaris"], "comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1467199759, "post_id": 38096292, "comment_id": 63630709, "body": "I&#39;ve never seen one.  Probably because it&#39;s not useful functionality.  If you <i>need</i> that level of control over memory usage, <code>malloc_trim()</code> is not sufficient since it&#39;s not guaranteed to do anything.  And if you don&#39;t need that much control over memory usage, you don&#39;t need it."}, {"owner": {"reputation": 2073, "user_id": 357403, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RpSGe.jpg?s=128&g=1", "display_name": "Koshinae", "link": "https://stackoverflow.com/users/357403/koshinae"}, "edited": false, "score": 0, "creation_date": 1467200278, "post_id": 38096292, "comment_id": 63631080, "body": "<code>malloc_trim</code> is a GNU extension. What compiler do you use on Solaris?"}, {"owner": {"reputation": 2484, "user_id": 645127, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/c60f7fda09932752502455be62069611?s=128&d=identicon&r=PG", "display_name": "Arne", "link": "https://stackoverflow.com/users/645127/arne"}, "reply_to_user": {"reputation": 2073, "user_id": 357403, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RpSGe.jpg?s=128&g=1", "display_name": "Koshinae", "link": "https://stackoverflow.com/users/357403/koshinae"}, "edited": false, "score": 0, "creation_date": 1467203738, "post_id": 38096292, "comment_id": 63633504, "body": "@Koshinae gcc. but the manual of gnulib says that malloc_trim is unavailable on solaris, osx and other platforms."}], "owner": {"reputation": 2484, "user_id": 645127, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/c60f7fda09932752502455be62069611?s=128&d=identicon&r=PG", "display_name": "Arne", "link": "https://stackoverflow.com/users/645127/arne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 147, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1467194373, "creation_date": 1467194373, "question_id": 38096292, "link": "https://stackoverflow.com/questions/38096292/is-there-something-akin-to-malloc-trim-under-solaris", "title": "Is there something akin to malloc_trim under Solaris?", "body": "<p>With GNU/Linux I can call malloc_trim to try and shrink the heap. Is there a similar function available on Solaris (10 in my case, but 11 is fine as well)?</p>\n"}, {"tags": ["c", "unit-testing"], "comments": [{"owner": {"reputation": 3872, "user_id": 126125, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0b05bafd1f78ff005920c8df7f4f8246?s=128&d=identicon&r=PG", "display_name": "Markon", "link": "https://stackoverflow.com/users/126125/markon"}, "edited": false, "score": 0, "creation_date": 1467194500, "post_id": 38096275, "comment_id": 63627265, "body": "have a look at this: <a href=\"http://stackoverflow.com/questions/65820/unit-testing-c-code?rq=1\" title=\"unit testing c code\">stackoverflow.com/questions/65820/unit-testing-c-code?rq=1</a> it contains good advice"}, {"owner": {"reputation": 41, "user_id": 5102259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8943afc3c3a3656600131813b4146bc?s=128&d=identicon&r=PG&f=1", "display_name": "jhj", "link": "https://stackoverflow.com/users/5102259/jhj"}, "reply_to_user": {"reputation": 3872, "user_id": 126125, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0b05bafd1f78ff005920c8df7f4f8246?s=128&d=identicon&r=PG", "display_name": "Markon", "link": "https://stackoverflow.com/users/126125/markon"}, "edited": false, "score": 1, "creation_date": 1467194667, "post_id": 38096275, "comment_id": 63627382, "body": "thanks, but is using a testing framework essential?"}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 2, "creation_date": 1467194878, "post_id": 38096275, "comment_id": 63627515, "body": "Just use functions and asserts."}, {"owner": {"reputation": 41, "user_id": 5102259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8943afc3c3a3656600131813b4146bc?s=128&d=identicon&r=PG&f=1", "display_name": "jhj", "link": "https://stackoverflow.com/users/5102259/jhj"}, "edited": false, "score": 0, "creation_date": 1467195020, "post_id": 38096275, "comment_id": 63627596, "body": "Do you know of a simple example using functions and asserts?"}, {"owner": {"reputation": 41, "user_id": 5102259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8943afc3c3a3656600131813b4146bc?s=128&d=identicon&r=PG&f=1", "display_name": "jhj", "link": "https://stackoverflow.com/users/5102259/jhj"}, "edited": false, "score": 0, "creation_date": 1467195650, "post_id": 38096275, "comment_id": 63628018, "body": "Yes, but how would I perform asserts on an input file? i.e. checking if the output in <code>file x</code> is equal to some number?"}, {"owner": {"reputation": 41, "user_id": 5102259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8943afc3c3a3656600131813b4146bc?s=128&d=identicon&r=PG&f=1", "display_name": "jhj", "link": "https://stackoverflow.com/users/5102259/jhj"}, "edited": false, "score": 0, "creation_date": 1467196055, "post_id": 38096275, "comment_id": 63628309, "body": "Thanks for that example. How would I specify which parts of the input file the assert should check? I don&#39;t want to hard code the program to look at line x for example as the input file may vary in contents.."}, {"owner": {"reputation": 41, "user_id": 5102259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8943afc3c3a3656600131813b4146bc?s=128&d=identicon&r=PG&f=1", "display_name": "jhj", "link": "https://stackoverflow.com/users/5102259/jhj"}, "edited": false, "score": 0, "creation_date": 1467196638, "post_id": 38096275, "comment_id": 63628669, "body": "So basically assume that the assert should perform on line 7 of a file? What would be the solution to avoid hard coding this? My aim is to receive files from students where I can then perform unit tests on to check if the correct output(s) are given.."}, {"owner": {"reputation": 2592, "user_id": 2963819, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bcc08ce2a4490cf3496020812fe10ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Ishay Peled", "link": "https://stackoverflow.com/users/2963819/ishay-peled"}, "edited": false, "score": 0, "creation_date": 1467202234, "post_id": 38096275, "comment_id": 63632506, "body": "@jhj For this purpose I&#39;d just compare results from a working program to your students output"}], "owner": {"reputation": 41, "user_id": 5102259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8943afc3c3a3656600131813b4146bc?s=128&d=identicon&r=PG&f=1", "display_name": "jhj", "link": "https://stackoverflow.com/users/5102259/jhj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 96, "favorite_count": 0, "closed_date": 1467197483, "answer_count": 0, "score": 3, "last_activity_date": 1467194469, "creation_date": 1467194317, "last_edit_date": 1467194469, "question_id": 38096275, "link": "https://stackoverflow.com/questions/38096275/how-to-write-unit-tests-in-c", "closed_reason": "Duplicate", "title": "How to write unit tests in C", "body": "<p>I need to write a <em>simple unit test</em> that executes on a given <code>.c file</code>. I can't seem to find simple explanations or examples on the web to help me accomplish this. I've seen examples where unit testing frameworks such as <code>cUnit</code> are used.. but is this a necessity? Also, I need the unit test to be executable without using any IDE. </p>\n"}, {"tags": ["c", "memory-management"], "comments": [{"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 3, "creation_date": 1467194415, "post_id": 38096143, "comment_id": 63627200, "body": "Heap allocation is done by specific functions: <a href=\"http://linux.die.net/man/3/malloc\" rel=\"nofollow noreferrer\">malloc, realloc, calloc</a>... so the coder is responsible for allocation and for release (<code>free</code>) the memory. Stack it is done at runtime, by assembler code generated by compiler at compile time."}, {"owner": {"reputation": 2988, "user_id": 452414, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/rDMfs.png?s=128&g=1", "display_name": "babon", "link": "https://stackoverflow.com/users/452414/babon"}, "edited": false, "score": 2, "creation_date": 1467195152, "post_id": 38096143, "comment_id": 63627678, "body": "The compiler is not involved in any way when the program is running."}, {"owner": {"reputation": 13195, "user_id": 3777958, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/Cjiij.jpg?s=128&g=1", "display_name": "Destructor", "link": "https://stackoverflow.com/users/3777958/destructor"}, "reply_to_user": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1467197926, "post_id": 38096143, "comment_id": 63629504, "body": "@LPs: you are right, post it as an answer !!!"}, {"owner": {"reputation": 1331, "user_id": 6006584, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/5ab44f4eee6188113ae91adc8719d666?s=128&d=identicon&r=PG&f=1", "display_name": "ddor254", "link": "https://stackoverflow.com/users/6006584/ddor254"}, "reply_to_user": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1467199253, "post_id": 38096143, "comment_id": 63630346, "body": "@LPs , the assembler coder meaning the OS?  and i know that the coder is responsible for heap allocation , my question is: do the compiler in any way involved during run time?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1467199451, "post_id": 38096143, "comment_id": 63630486, "body": "There is neither a heap nor a stack mandated by the C language. They are implementation details and alternative approaches can be used (and are used)."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1467199543, "post_id": 38096143, "comment_id": 63630546, "body": "<i>Compiler</i> and <i>runtime</i> are incompatible words. I mean that the compiling step is something done before you have something to execute."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "reply_to_user": {"reputation": 13195, "user_id": 3777958, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/Cjiij.jpg?s=128&g=1", "display_name": "Destructor", "link": "https://stackoverflow.com/users/3777958/destructor"}, "edited": false, "score": 1, "creation_date": 1467199684, "post_id": 38096143, "comment_id": 63630647, "body": "@Destructor thanks, but an answer to this question must be more detailed and must be explained more in depth which takes time I haven&#39;t right now. ;)"}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1467199897, "post_id": 38096143, "comment_id": 63630800, "body": "About the stack, it depends on the OS you are using. As an High overview you can assume that he OS that starts the program gives to it a memory space called stack where that the program can use to allocate function local  scoped variables, if no <code>static</code>. <i>do the compiler in any way involved during run time?</i> simple answer is: no, it isn&#39;t."}, {"owner": {"reputation": 1331, "user_id": 6006584, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/5ab44f4eee6188113ae91adc8719d666?s=128&d=identicon&r=PG&f=1", "display_name": "ddor254", "link": "https://stackoverflow.com/users/6006584/ddor254"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1467200437, "post_id": 38096143, "comment_id": 63631201, "body": "LPs Thanks.   @Olaf can you explain it deeper and with more detail because i failed to understand the variety of answers given.  i will try to explain better:  each process have Code,Data ,Stack : the global var&#39; are in Data,and the heap is also there, and there is stack .  my question is : during run time of program who is responsible for allocating and managing the memory stack,heap ? who allocate new memory and update the SP ? who update the heap size?   the process ? the OS?"}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1467201862, "post_id": 38096143, "comment_id": 63632243, "body": "Small answer, Olaf will give you a detailed one I think. Who change SP: CPU, MCU or whatever is in charge to manage it. Mostly you have MSP (Main Stack Pointer) and PSP (Process Stack Pointer). Heap size is not managed but it is, mainly, pre allocated by OS. Heap is managed, as already commented, by specific function that make all the actions. The whole heap, mainly, is allocated for the process by OS. You should also think about small system without OS, so linker scripts helps to define those sections."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1467210837, "post_id": 38096143, "comment_id": 63639220, "body": "@LPs: It is actually more a matter of the Processor used. The OS managing it follows from the requirements/capabilities of the hardware."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1467211092, "post_id": 38096143, "comment_id": 63639389, "body": "I will not give a comprehensive answer, as that is not the place nor the site. Read the C standard (maybe start with a good book) to get a gasp on what the standard mandates and what not. Then some processor (CPU, DSP, etc.) reference manuals and some compiler manuals, too (for some CPUs there might even be different approaches) to learn which alternatives there are. Just takes some years to master (whihc is the reason I will not further discuss this)."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1467211522, "post_id": 38096143, "comment_id": 63639754, "body": "To add: it completely depends on the target who allocates what. There can be a scenario where the compiler allocates all, the linker, an OS, a run-time. Or a mixture thereof. (Yes, I know this leaves you not better informed, but maybe a bit wiser)."}, {"owner": {"reputation": 1331, "user_id": 6006584, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/5ab44f4eee6188113ae91adc8719d666?s=128&d=identicon&r=PG&f=1", "display_name": "ddor254", "link": "https://stackoverflow.com/users/6006584/ddor254"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1467275199, "post_id": 38096143, "comment_id": 63667780, "body": "@Olaf and LPs , thank you for your quick and detailed answers. it was very informative and helpful"}], "answers": [{"comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 2, "creation_date": 1467199659, "post_id": 38097636, "comment_id": 63630632, "body": "Most C programs run on systems without a full-grown OS. And quite some don&#39;t even have a stack for variables."}, {"owner": {"reputation": 23612, "user_id": 147407, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/65f858d8a973f4ee8d97517a21a17e7d?s=128&d=identicon&r=PG", "display_name": "Andrejs Cainikovs", "link": "https://stackoverflow.com/users/147407/andrejs-cainikovs"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1467201018, "post_id": 38097636, "comment_id": 63631649, "body": "I would say this depends, really. The full answer should include various scenarios, explaining hardware differences, libc for barebones (like avr-libc) or linux, etc. I agree with @Olaf - it is wrong to assume that <i>all</i> the hardware runs OS, yet the source code might use dynamic allocation. Here, malloc without OS: <a href=\"http://www.nongnu.org/avr-libc/user-manual/malloc.html\" rel=\"nofollow noreferrer\">nongnu.org/avr-libc/user-manual/malloc.html</a>"}], "tags": [], "owner": {"reputation": 157, "user_id": 3840356, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/b2bb034b0842a98e31b4a7929d053946?s=128&d=identicon&r=PG&f=1", "display_name": "corei11", "link": "https://stackoverflow.com/users/3840356/corei11"}, "is_accepted": false, "score": 4, "last_activity_date": 1467199521, "last_edit_date": 1467199521, "creation_date": 1467197979, "answer_id": 38097636, "question_id": 38096143, "link": "https://stackoverflow.com/questions/38096143/dynamic-and-stack-memory-allocation-done-by-the-compiler/38097636#38097636", "title": "dynamic and stack memory allocation done by the compiler?", "body": "<p>OS is responsible for stack and heap memory allocation.</p>\n\n<p>The OS allocate stack memory for every thread and the language runtime calls the OS for allocate heap memory.</p>\n"}, {"tags": [], "owner": {"reputation": 262, "user_id": 5922090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d1d2b771811c40c95f3f7b2172cb221?s=128&d=identicon&r=PG&f=1", "display_name": "Vaibhav N Naik", "link": "https://stackoverflow.com/users/5922090/vaibhav-n-naik"}, "is_accepted": false, "score": -1, "last_activity_date": 1467261311, "creation_date": 1467261311, "answer_id": 38114064, "question_id": 38096143, "link": "https://stackoverflow.com/questions/38096143/dynamic-and-stack-memory-allocation-done-by-the-compiler/38114064#38114064", "title": "dynamic and stack memory allocation done by the compiler?", "body": "<p>Compiler is not involved in running a program. Its job is to build the program to a stage from where the linker can take it to create an executable or take to a engine that executes the code in case of a dynamic builder. It only checks for some protocols that have to be followed for a particular language.</p>\n\n<p>Static allocation (storage space) depends on the files that are being linked to and the storage required by the static structures and variables in the code.</p>\n\n<p>Dynamic allocation is taken by the memory management unit where the resources are been allocated to the task that is in the memory and that is where the heap allocation takes place during the runtime.</p>\n"}], "owner": {"reputation": 1331, "user_id": 6006584, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/5ab44f4eee6188113ae91adc8719d666?s=128&d=identicon&r=PG&f=1", "display_name": "ddor254", "link": "https://stackoverflow.com/users/6006584/ddor254"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 182, "favorite_count": 1, "answer_count": 2, "score": 2, "last_activity_date": 1467275257, "creation_date": 1467194001, "last_edit_date": 1467275257, "question_id": 38096143, "link": "https://stackoverflow.com/questions/38096143/dynamic-and-stack-memory-allocation-done-by-the-compiler", "title": "dynamic and stack memory allocation done by the compiler?", "body": "<p>I know there are several types of memory allocation. Taking C as language example, we have static allocation, stack allocation, heap allocation.</p>\n\n<p>I understand that the static allocation is done by compiler, but the other two takes place on run time. Who is responsible for that, is it the Compiler, Process or the Operating System?</p>\n\n<p>I'm basically asking if the compiler is involved in running a program?</p>\n"}, {"tags": ["c", "variables"], "comments": [{"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 1, "creation_date": 1467193503, "post_id": 38095928, "comment_id": 63626558, "body": "It depends on the storage class of the variable."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1467193597, "post_id": 38095928, "comment_id": 63626620, "body": "It also depends on where you define the variables. And possibly on if they are initialized at the definition or not."}, {"owner": {"reputation": 10050, "user_id": 3512538, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/6Om7A.png?s=128&g=1", "display_name": "CIsForCookies", "link": "https://stackoverflow.com/users/3512538/cisforcookies"}, "edited": false, "score": 1, "creation_date": 1467193676, "post_id": 38095928, "comment_id": 63626676, "body": "read about heap &amp; stack here: <a href=\"http://stackoverflow.com/questions/79923/what-and-where-are-the-stack-and-heap\" title=\"what and where are the stack and heap\">stackoverflow.com/questions/79923/&hellip;</a>"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1467197295, "post_id": 38095928, "comment_id": 63629089, "body": "<a href=\"http://electronics.stackexchange.com/questions/237740/what-resides-in-the-different-memory-types-of-a-microcontroller/237759#237759\">This</a> might help. It is about microcontrollers, but the same applies pretty much universally, with the difference that PC computers have no flash."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 10050, "user_id": 3512538, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/6Om7A.png?s=128&g=1", "display_name": "CIsForCookies", "link": "https://stackoverflow.com/users/3512538/cisforcookies"}, "edited": false, "score": 0, "creation_date": 1467199753, "post_id": 38095928, "comment_id": 63630703, "body": "@noob: Neither stack nor heap are mandated by the C standard. And there are platforms which have none at all for variables."}], "answers": [{"comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1467199885, "post_id": 38097856, "comment_id": 63630792, "body": "Most modern computers don&#39;t have a cache, nor exessive RAM. Most comouters have a MCU with very limited RAM/Flash. They outnumber the computers with full-growm OS by decades."}], "tags": [], "owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "is_accepted": false, "score": 0, "last_activity_date": 1467198579, "creation_date": 1467198579, "answer_id": 38097856, "question_id": 38095928, "link": "https://stackoverflow.com/questions/38095928/where-exactly-are-the-variables-stored-in-a-c-program/38097856#38097856", "title": "Where exactly are the variables stored in a C program?", "body": "<p>The way you've asked the question suggests you expect a single answer.   That is simply not the case.</p>\n\n<p>In a rough sense, all variables will exist in memory while your program is being executed.   The memory your variables exist in depends both on several things.</p>\n\n<p>Modern computer hardware often has quite a complex physical memory architecture - with multiple levels of cache (in both the CPU, and various peripheral devices), a number of CPU registers, shared memory, different types of RAM, storage devices, EEPROMs, etc.   Different systems have these types of memory - and more types - in different proportions.</p>\n\n<p>Operating systems may make memory available to your program in different ways.  For example, it may provide virtual memory, using a combination of RAM and reserved hard drive space (and managing mappings, so your program can't tell the difference).    This can allow your program to use more memory than is physically available as RAM, but also affects performance, since the operating system must swap memory usage of your program between RAM and the hard drive (which is typically orders of magnitude slower).</p>\n\n<p>A lot of compilers and libraries are implemented to maximise your programs performance (by various measures) - compiler optimisation of your code (which can cause some variables in your code to not even exist when your program is run), library functions crafted for performance, etc.   One consequence of this is that the compiler, or library, may use memory in different ways (e.g. some implementations may embed code in your executable to detect memory resources available when the program is run, others may simply assume a fixed amount of RAM), and the usage may even vary over time.</p>\n"}], "owner": {"reputation": 9, "user_id": 6527663, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72185d2345155d2876d648239962faa1?s=128&d=identicon&r=PG&f=1", "display_name": "Jay", "link": "https://stackoverflow.com/users/6527663/jay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 636, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1467198579, "creation_date": 1467193475, "question_id": 38095928, "link": "https://stackoverflow.com/questions/38095928/where-exactly-are-the-variables-stored-in-a-c-program", "title": "Where exactly are the variables stored in a C program?", "body": "<p>I am new to computer programming. I was studying about variables and came across a definition on the internet:</p>\n\n<blockquote>\n  <p>Variables are the names you give to computer memory locations which are used to store values in a computer program.</p>\n</blockquote>\n\n<p>What are these memory locations? Do these locations refer to the actual computer memory or this is just a dump in the program itself from where it calls those variables later when we need them?\nAlso there are other terms that I encountered here on stack overflow like heap and stack. I could not get my head around these. Please help.</p>\n"}, {"tags": ["c", "video", "encoding", "effect"], "owner": {"reputation": 109, "user_id": 6310915, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/1cd5e34be45a93bbe910651b545caa40?s=128&d=identicon&r=PG&f=1", "display_name": "AlecGamble", "link": "https://stackoverflow.com/users/6310915/alecgamble"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1467192341, "creation_date": 1467192341, "question_id": 38095496, "link": "https://stackoverflow.com/questions/38095496/daala-implementing-intra-paint-c-as-a-video-encoder", "title": "Daala - Implementing intra_paint.c as a video encoder", "body": "<p>I've been looking at rendering visual effects lately and I stumbled across this: <a href=\"https://people.xiph.org/~jm/daala/paint_demo/\" rel=\"nofollow\">https://people.xiph.org/~jm/daala/paint_demo/</a></p>\n\n<p>It's an effect I really like and I'd like to implement it as a command line tool where I can pass in a video (in .ogv or .y4m format as per the examples in the git or any other format to be honest).</p>\n\n<p>So I've cloned: <a href=\"https://github.com/jmvalin/daala/commits/exp_paint_deringing4\" rel=\"nofollow\">https://github.com/jmvalin/daala/commits/exp_paint_deringing4</a> and extracted it and from what I understand I need to be looking at the intra_paint.c and intra_paint_enc.c files but I'm not sure how to implement them into a command line tool similar to the encoder_example.c file in the examples directory. I imagine it would be pretty simple but I'm pretty new to this and I can't really see how to do it.</p>\n\n<p>Could anybody point me in the right direction as to what I should be attempting to do to utilise this?</p>\n"}, {"tags": ["c", "c-preprocessor", "compiler-warnings"], "comments": [{"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 2, "creation_date": 1467192526, "post_id": 38095494, "comment_id": 63625839, "body": "Is that your actual macro?"}, {"owner": {"reputation": 19, "user_id": 6527583, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f5ee6c60f56ebb631cce8fa46cc587d?s=128&d=identicon&r=PG&f=1", "display_name": "mjht", "link": "https://stackoverflow.com/users/6527583/mjht"}, "reply_to_user": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1467192769, "post_id": 38095494, "comment_id": 63626043, "body": "Yes i have defined this macro to load some dll ,i haven&#39;t added definition here but it has defination as well"}, {"owner": {"reputation": 962, "user_id": 6492540, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yQDfs.jpg?s=128&g=1", "display_name": "buld0zzr", "link": "https://stackoverflow.com/users/6492540/buld0zzr"}, "edited": false, "score": 0, "creation_date": 1467192795, "post_id": 38095494, "comment_id": 63626062, "body": "Looks like cast is missing, but without the actual macro it&#39;s hard to tell"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1467192952, "post_id": 38095494, "comment_id": 63626180, "body": "Please read on <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 19, "user_id": 6527583, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f5ee6c60f56ebb631cce8fa46cc587d?s=128&d=identicon&r=PG&f=1", "display_name": "mjht", "link": "https://stackoverflow.com/users/6527583/mjht"}, "edited": false, "score": 0, "creation_date": 1467193306, "post_id": 38095494, "comment_id": 63626432, "body": "Yes it&#39;s a casting problem i guess ,not related with definition of macro"}, {"owner": {"reputation": 19, "user_id": 6527583, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f5ee6c60f56ebb631cce8fa46cc587d?s=128&d=identicon&r=PG&f=1", "display_name": "mjht", "link": "https://stackoverflow.com/users/6527583/mjht"}, "edited": false, "score": 0, "creation_date": 1467193350, "post_id": 38095494, "comment_id": 63626459, "body": "Is it possible to pass function pointers of different type in __func_proto parameter of macro?"}], "answers": [{"tags": [], "owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "is_accepted": false, "score": 1, "last_activity_date": 1467193675, "creation_date": 1467193675, "answer_id": 38096009, "question_id": 38095494, "link": "https://stackoverflow.com/questions/38095494/how-do-i-resolve-this-warning-about-passing-a-function-pointer-to-a-macro-in-c/38096009#38096009", "title": "How do I resolve this warning about passing a function pointer to a macro in C?", "body": "<p>You need to add casts, since <code>void *</code> doesn't convert to/from function pointers automatically. In fact it's non-portable to assume that function pointers can be expressed as <code>void *</code> at all.</p>\n\n<p>Of course, if you're on a system that has <code>dlopen()</code> and friends, it can be a sure assumption that that platform supports this conversion.</p>\n\n<p>Also, it sounds very strange to do the whole <code>dlopen()</code>/<code>dlsym()</code>/<code>dlclose()</code> dance <em>per call</em>, usually you buffer the pointers.</p>\n"}, {"comments": [{"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1467203790, "post_id": 38096239, "comment_id": 63633536, "body": "Nitpicking: The snippet you show does not <i>cast</i> to <code>void*</code>."}], "tags": [], "owner": {"reputation": 7481, "user_id": 2527795, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/8359590ce3a66e5c58407ae5c83c9bbe?s=128&d=identicon&r=PG&f=1", "display_name": "vll", "link": "https://stackoverflow.com/users/2527795/vll"}, "is_accepted": false, "score": 3, "last_activity_date": 1467195238, "last_edit_date": 1592644375, "creation_date": 1467194233, "answer_id": 38096239, "question_id": 38095494, "link": "https://stackoverflow.com/questions/38095494/how-do-i-resolve-this-warning-about-passing-a-function-pointer-to-a-macro-in-c/38096239#38096239", "title": "How do I resolve this warning about passing a function pointer to a macro in C?", "body": "<p><a href=\"http://pubs.opengroup.org/onlinepubs/009695399/functions/dlsym.html\" rel=\"nofollow noreferrer\">Documentation of dlsym</a> suggests you should cast the function pointer to <code>void*</code> before you assign its return value to the pointer:</p>\n<pre><code>*(void **)(&amp;__func_proto) = dlsym(dll_handle, func_name);\n</code></pre>\n<p>Rationale is described behind the link:</p>\n<blockquote>\n<p>The ISO C standard does not require that pointers to functions can be cast back and forth to pointers to data. Indeed, the ISO C standard does not require that an object of type void * can hold a pointer to a function. Implementations supporting the XSI extension, however, do require that an object of type void * can hold a pointer to a function.</p>\n<p>Note that compilers conforming to the ISO C standard are required to generate a warning if a conversion from a void * pointer to a function pointer is attempted as in:</p>\n<p>fptr = (int (*)(int))dlsym(handle, &quot;my_function&quot;);</p>\n</blockquote>\n"}], "owner": {"reputation": 19, "user_id": 6527583, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f5ee6c60f56ebb631cce8fa46cc587d?s=128&d=identicon&r=PG&f=1", "display_name": "mjht", "link": "https://stackoverflow.com/users/6527583/mjht"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 134, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1467294959, "creation_date": 1467192339, "last_edit_date": 1467294934, "question_id": 38095494, "link": "https://stackoverflow.com/questions/38095494/how-do-i-resolve-this-warning-about-passing-a-function-pointer-to-a-macro-in-c", "title": "How do I resolve this warning about passing a function pointer to a macro in C?", "body": "<p>I have a macro defined as: </p>\n\n<pre><code>#define _call(func_name, __func_proto, ...)        {       \\\n void *_handle;                                           \\\n int result = !CERR_V_SUCCESS;                               \\\n                                                              \\\n  _handle = dlopen(_DLL_NAME,GLOBAL); \\\n  if (_handle) {                                           \\\n      __func_proto = dlsym(dll_handle, func_name);            \\\n      if (__func_proto) {                                     \\\n          result = (*__func_proto)(__VA_ARGS__);              \\\n     }                                                       \\\n      (void)dlclose(_handle);                              \\\n  }                                                           \\\n  return (result);                                            \\\n}\n</code></pre>\n\n<p>I am calling this macro with different function pointers like this: </p>\n\n<pre><code>_call(\"download\",_download,src,dst);\n_call(\"upload\",_upload,src,dst);\n_call(\"test\",_test,file);\n</code></pre>\n\n<p>and the function pointers are defined as</p>\n\n<pre><code>int (*_download )(int *,int *);\nint (*_upload)(int *,int*);\nint (*_test)(int *,char*);\n</code></pre>\n\n<p>This results in a warning <code>a value of type \"void *\" cannot be assigned to an entity of type \"int (*)(int*,int*)\"</code>.</p>\n\n<p>How can I resolve this warning?</p>\n"}, {"tags": ["c", "assembly", "avr", "avr-gcc"], "comments": [{"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 1, "creation_date": 1467193291, "post_id": 38095389, "comment_id": 63626423, "body": "What are you trying to achieve by doing this?"}, {"owner": {"reputation": 43, "user_id": 6527511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/880b643fe13d644b916dfc46e0fa6ab0?s=128&d=identicon&r=PG&f=1", "display_name": "tuzojil", "link": "https://stackoverflow.com/users/6527511/tuzojil"}, "reply_to_user": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1467193499, "post_id": 38095389, "comment_id": 63626553, "body": "The loop polls a pin of a mico controller. To ensure that the pin is polled in regular intervals the runtime of the loop should be the same no matter what branches are taken."}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1467193588, "post_id": 38095389, "comment_id": 63626614, "body": "I don&#39;t think the compiler can do what you want. It might be a better idea to use an interrupt-driven approach or to rewrite your code so it is branch-free. If you show us your code, I can try to help you rewrite it so that it doesn&#39;t branch."}, {"owner": {"reputation": 43, "user_id": 6527511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/880b643fe13d644b916dfc46e0fa6ab0?s=128&d=identicon&r=PG&f=1", "display_name": "tuzojil", "link": "https://stackoverflow.com/users/6527511/tuzojil"}, "reply_to_user": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1467193821, "post_id": 38095389, "comment_id": 63626799, "body": "Is there not always a branch when I use if ?"}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1467193895, "post_id": 38095389, "comment_id": 63626854, "body": "Yes. But often it is possible to get rid of most if statements using bit-fiddling and other tricks. This depends on your code though."}, {"owner": {"reputation": 43, "user_id": 6527511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/880b643fe13d644b916dfc46e0fa6ab0?s=128&d=identicon&r=PG&f=1", "display_name": "tuzojil", "link": "https://stackoverflow.com/users/6527511/tuzojil"}, "reply_to_user": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1467194066, "post_id": 38095389, "comment_id": 63626977, "body": "That sounds like it would make the code hard to understand. Which I can not afford in this project."}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1467194147, "post_id": 38095389, "comment_id": 63627028, "body": "If this is about writing code that is easy to understand, consider using an interrupt-driven approach for the polling. Set a timer to interrupt you at a fixed rate and do the polling in the interrupt handler. Adding random nops is both complicated and fragile as other compilers/future gcc versions may optimize your code differently causing the nops to be in all the wrong places."}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 2, "creation_date": 1467194169, "post_id": 38095389, "comment_id": 63627043, "body": "Also, different instructions take different time to execute so you need to account for that when adding your nops."}, {"owner": {"reputation": 43, "user_id": 6527511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/880b643fe13d644b916dfc46e0fa6ab0?s=128&d=identicon&r=PG&f=1", "display_name": "tuzojil", "link": "https://stackoverflow.com/users/6527511/tuzojil"}, "reply_to_user": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1467194383, "post_id": 38095389, "comment_id": 63627184, "body": "Ok I will try that"}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 4, "creation_date": 1467195205, "post_id": 38095389, "comment_id": 63627714, "body": "no reason to assume with each compiler or each version of gcc that you will get the same compiled results, so you will be hand tuning this on a regular basis if you are trying to use number of instructions and time per instruction to make each path the same length.  easier to just use a timer at the end to keep them the same number of clocks or a timer based interrupt.  So long as no compiled path is too long that will give you the best results.  dont understand why each path would need to be the same length, my guess is you are making something harder than it needs to be."}, {"owner": {"reputation": 15145, "user_id": 4271923, "user_type": "registered", "profile_image": "https://graph.facebook.com/543414580/picture?type=large", "display_name": "Ped7g", "link": "https://stackoverflow.com/users/4271923/ped7g"}, "edited": false, "score": 0, "creation_date": 1467195999, "post_id": 38095389, "comment_id": 63628265, "body": "If this would be security measure (to make harder brute forcing secret by measuring response time, so your code response is stable for both valid and invalid key bits), you should not use plain <code>nop</code> to sync the branch timing. That would still affect EMF emitted by CPU and the timing of <code>nop</code> is something I don&#39;t believe into much. It&#39;s better to write the code without if-s (something like ternary operator in C/Java), so it&#39;s basically doing all the same <i>ops</i> always, just some <code>MOVcc</code> will make the resulting <i>value</i> different. Showing the code would make it easier to decide if that&#39;s possible"}, {"owner": {"reputation": 15145, "user_id": 4271923, "user_type": "registered", "profile_image": "https://graph.facebook.com/543414580/picture?type=large", "display_name": "Ped7g", "link": "https://stackoverflow.com/users/4271923/ped7g"}, "edited": false, "score": 0, "creation_date": 1467196226, "post_id": 38095389, "comment_id": 63628419, "body": "But you shouldn&#39;t be so much afraid of code written in that way - being less understandable. Actually for human following all possible branch paths is not easy either, if a bit more complex ternary operator line can save you whole big branch, it&#39;s often the opposite, and easier to read (especially if you get used to it)."}, {"owner": {"reputation": 33092, "user_id": 5801661, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D8ENZ.jpg?s=128&g=1", "display_name": "Margaret Bloom", "link": "https://stackoverflow.com/users/5801661/margaret-bloom"}, "reply_to_user": {"reputation": 15145, "user_id": 4271923, "user_type": "registered", "profile_image": "https://graph.facebook.com/543414580/picture?type=large", "display_name": "Ped7g", "link": "https://stackoverflow.com/users/4271923/ped7g"}, "edited": false, "score": 2, "creation_date": 1467198393, "post_id": 38095389, "comment_id": 63629800, "body": "@Ped7g <a href=\"https://godbolt.org/g/Azqam6\" rel=\"nofollow noreferrer\">Ternary operator is just an handy if</a>. Also the OP is working on AVR (though not tagged as it yet)."}, {"owner": {"reputation": 2572, "user_id": 5784350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1be79d2a9a367e3b66c42928c0b095a7?s=128&d=identicon&r=PG&f=1", "display_name": "Tommylee2k", "link": "https://stackoverflow.com/users/5784350/tommylee2k"}, "edited": false, "score": 0, "creation_date": 1467380394, "post_id": 38095389, "comment_id": 63723438, "body": "if the code inside the if-block is only doing calculations, you can simply replace them by &quot;abusing&quot; the int values of boolean expression, to get expressions with equal run-time in either case.  <code>if (a&gt;b) c+=8;</code> e.g. could be replaced by &#39;c+=(a&gt;b)*8&#39; , or <code>if (a&gt;b) c=3; else c=7; </code> would be <code>c=7-4*(a&gt;b)</code> or <code>c=3+4*(a&lt;b)</code> (mind the &#39;&lt;&#39; ! ) ... this looks weired, but it&#39;s easy once you got the idea. But: why not use an timer interrupt, and wait for the timer, before polling the pin the next time ?"}, {"owner": {"reputation": 43, "user_id": 6527511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/880b643fe13d644b916dfc46e0fa6ab0?s=128&d=identicon&r=PG&f=1", "display_name": "tuzojil", "link": "https://stackoverflow.com/users/6527511/tuzojil"}, "edited": false, "score": 0, "creation_date": 1467704430, "post_id": 38095389, "comment_id": 63819980, "body": "The interrupt takes 5 cycles to jump into the service routine has to save several registes and then return which is again 5 cycles. Unfortunately that is too much"}], "answers": [{"tags": [], "owner": {"reputation": 397, "user_id": 6549302, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mMMhS.png?s=128&g=1", "display_name": "Frazzo", "link": "https://stackoverflow.com/users/6549302/frazzo"}, "is_accepted": true, "score": 3, "last_activity_date": 1467810321, "creation_date": 1467810321, "answer_id": 38224784, "question_id": 38095389, "link": "https://stackoverflow.com/questions/38095389/balancing-branches-in-regard-to-cycles-used/38224784#38224784", "title": "Balancing branches in regard to cycles used", "body": "<p>Well you didn't specify whether you are coding in asm or in c, since you use branches but you call \"asm()\"... If using C, you can call millis() at the beginning of your loop, and call it at the end too. You have to calculate the maximum duration of the loop. So subtract the two millis values and compare the difference with the maximum duration of the loop. Yea lilbit confusing, here the code:</p>\n\n<pre><code>#define MAX_DURATION 1000 //let's say 1 second, but you should calculate it\nwhile(yourcondition) {\n  temp1 = millis();\n  //do your branches\n\n  temp2 = millis();\n  delay(MAX_DURATION-(temp2-temp1));\n}\n</code></pre>\n\n<p>While if you are coding in asm, you have at first to disable interrupts in order not to have longer loops. Then you can setup a 16bit timer, if your processor has any, with the greatest prescaler and then checking the timer value instead of millis and make a delay function, easily done as:</p>\n\n<pre><code>delay: ;put the millisecond to wait in r17:r16\n  ldi r18, 200\n  ldi r19, 26 ;200*26* (3 cicles each little loop) = 1 millisecond of delay with a 16MHz oscillator\n  mov r20, r17\n  delay_loop:\n       dec r19\n       brne delay_loop\n      ldi r19, 26\n      dec r18\n      brne delay_loop\n     ldi r18, 200\n     dec r17\n     brne delay_loop\n    mov r17, r20\n    dec r16\n    brne delay_loop\n  ret\n</code></pre>\n\n<p>Hoping that your instrunction set is similar to mine. Next time specify what code are you using and What processor are you targeting</p>\n"}], "owner": {"reputation": 43, "user_id": 6527511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/880b643fe13d644b916dfc46e0fa6ab0?s=128&d=identicon&r=PG&f=1", "display_name": "tuzojil", "link": "https://stackoverflow.com/users/6527511/tuzojil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 38224784, "answer_count": 1, "score": 4, "last_activity_date": 1467885530, "creation_date": 1467192122, "last_edit_date": 1467885530, "question_id": 38095389, "link": "https://stackoverflow.com/questions/38095389/balancing-branches-in-regard-to-cycles-used", "title": "Balancing branches in regard to cycles used", "body": "<p>I have a loop with several conditional branches in it.\nThe loop is supposed to always run the same amount of cycles no matter what branches are taken. </p>\n\n<p>To achieve this I filled the shorter branches with <code>NOP</code>s (using <code>asm(\"nop\")</code>) until they were of equal length to the longer branches. This achieved what I wanted.</p>\n\n<p>Now I have a lot more branches and want to automatically balance the branches. I am compiling with avr-gcc.</p>\n\n<p>Is there a way to do this?</p>\n\n<p>As requested:\nI am using an ATmega 1284p and avr-gcc for my implementation.</p>\n"}, {"tags": ["c", "data-structures", "thread-safety", "mutex", "race-condition"], "comments": [{"owner": {"reputation": 8847, "user_id": 3484570, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/r5BRZ.png?s=128&g=1", "display_name": "nwp", "link": "https://stackoverflow.com/users/3484570/nwp"}, "edited": false, "score": 2, "creation_date": 1467192130, "post_id": 38095242, "comment_id": 63625566, "body": "Assuming the other implementations are correct the queue is still thread-safe. &quot;Race condition&quot; is used in the logical sense, from a C standard point of view there is no race condition there. You will have the same issue with a <code>queue_get_size()</code> function. While it returns the size at the time, is may change at any moment."}, {"owner": {"reputation": 8847, "user_id": 3484570, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/r5BRZ.png?s=128&g=1", "display_name": "nwp", "link": "https://stackoverflow.com/users/3484570/nwp"}, "edited": false, "score": 1, "creation_date": 1467192235, "post_id": 38095242, "comment_id": 63625630, "body": "Queuing <code>const void *</code> and dequeuing <code>void *</code> looks like an error."}, {"owner": {"reputation": 2379, "user_id": 5045375, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/17ed0af705e0449fe49b74d8814a8ce2?s=128&d=identicon&r=PG", "display_name": "Filip Allberg", "link": "https://stackoverflow.com/users/5045375/filip-allberg"}, "reply_to_user": {"reputation": 8847, "user_id": 3484570, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/r5BRZ.png?s=128&g=1", "display_name": "nwp", "link": "https://stackoverflow.com/users/3484570/nwp"}, "edited": false, "score": 0, "creation_date": 1467195299, "post_id": 38095242, "comment_id": 63627789, "body": "@nwp I appreciate you pointing that out, I have somehow forgotten that <code>const</code> is a valid qualifier even when specifying the type of a return value."}], "answers": [{"comments": [{"owner": {"reputation": 121669, "user_id": 56778, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/34b152ef95a49568ce45df38cd87e54b?s=128&d=identicon&r=PG", "display_name": "Jim Mischel", "link": "https://stackoverflow.com/users/56778/jim-mischel"}, "edited": false, "score": 0, "creation_date": 1467220837, "post_id": 38095349, "comment_id": 63646044, "body": "... or remove data from the queue at any moment."}], "tags": [], "owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "is_accepted": false, "score": 2, "last_activity_date": 1467192033, "creation_date": 1467192033, "answer_id": 38095349, "question_id": 38095242, "link": "https://stackoverflow.com/questions/38095242/thread-safe-implementation-of-is-empty-in-a-queue-datastructure/38095349#38095349", "title": "Thread-safe implementation of is_empty in a queue datastructure", "body": "<p>Basically, your function is already correct. It's just that the result is outdated the moment you release the lock. In a multi-threaded program, asking whether a concurrent queue is empty is pretty pointless as another thread could enter data into the queue any moment.</p>\n"}, {"comments": [{"owner": {"reputation": 2379, "user_id": 5045375, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/17ed0af705e0449fe49b74d8814a8ce2?s=128&d=identicon&r=PG", "display_name": "Filip Allberg", "link": "https://stackoverflow.com/users/5045375/filip-allberg"}, "edited": false, "score": 0, "creation_date": 1467195422, "post_id": 38095866, "comment_id": 63627868, "body": "These are excellent suggestions that I will take to heart. I haven&#39;t really decided what, if anything, it is good for, I am essentially porting an earlier queue implementation of mine that was for single-threaded use and therefore I &quot;inherited&quot; the API."}], "tags": [], "owner": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "is_accepted": true, "score": 2, "last_activity_date": 1467193336, "creation_date": 1467193336, "answer_id": 38095866, "question_id": 38095242, "link": "https://stackoverflow.com/questions/38095242/thread-safe-implementation-of-is-empty-in-a-queue-datastructure/38095866#38095866", "title": "Thread-safe implementation of is_empty in a queue datastructure", "body": "<p>You've just discovered the reason why locking, threading and concurrency in general is hard. It's easy to create a few wrapper functions that obtain and release locks and prevent crashes from data corruption, it's actually hard to get locking right when you depend on state from earlier accesses.</p>\n\n<p>I'd argue that the function <code>queue_is_empty</code> is incorrect because it exists at all. It cannot possibly return a useful value because, as you discovered, the return value is stale before you return it. Since the function cannot return a useful return value it should not exist. And this is where you need to think hard about the API you provide.</p>\n\n<p>One option is to make the locking the responsibility of the callers. The caller could have something like:</p>\n\n<pre><code>queue_lock(q);\nif (!queue_is_empty(q))\n    do_something(q);\nqueue_unlock(q);\n</code></pre>\n\n<p>You will then run into issues with error handling and returns from functions, lock state changes around functions not part of the queue interface, etc. And as soon as you have more than one of those locks you need to manage lock ordering to prevent deadlocks.</p>\n\n<p>Another option is to reduce the API to only provide safe operations. Enqueue and dequeue work correctly. Do you actually need is_empty? What is it good for? Is it just to avoid waiting for a queue element when the queue is empty? Can you not solve it with <code>dequeue_without_waiting</code> instead? Etc.</p>\n"}], "owner": {"reputation": 2379, "user_id": 5045375, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/17ed0af705e0449fe49b74d8814a8ce2?s=128&d=identicon&r=PG", "display_name": "Filip Allberg", "link": "https://stackoverflow.com/users/5045375/filip-allberg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 356, "favorite_count": 1, "accepted_answer_id": 38095866, "answer_count": 2, "score": 1, "last_activity_date": 1467193336, "creation_date": 1467191798, "question_id": 38095242, "link": "https://stackoverflow.com/questions/38095242/thread-safe-implementation-of-is-empty-in-a-queue-datastructure", "title": "Thread-safe implementation of is_empty in a queue datastructure", "body": "<p>I am trying to create a thread-safe queue, and while the bulk of the operations</p>\n\n<pre><code> queue *queue_create_empty(void);\n void queue_enqueue(queue *q, const void *value, const size_t value_size);\n void *queue_dequeue(queue *q);\n void queue_destroy(queue *q, void (*freefunc)(void *value));\n</code></pre>\n\n<p>I am finding one to be particularily elusive,</p>\n\n<pre><code> bool queue_is_empty(const queue *q);\n</code></pre>\n\n<p>In particular if the function definition is</p>\n\n<pre><code> bool queue_is_empty(const queue *q) {\n     assert(q);\n\n     pthread_mutex_lock(q-&gt;mutex);\n     bool ret = q-&gt;is_empty;\n     pthread_mutex_unlock(q-&gt;mutex);\n\n     /* \n      * Here there is a possibility of a race condition, the queue may actually\n      * be empty at this point, and therefore the return value is misleading\n      */\n     return ret;\n }\n</code></pre>\n\n<p>then there is a possibility of a race-condition. The last comment</p>\n\n<blockquote>\n  <p>Here there is a possibility of a race condition, the queue may actually\n  be empty at this point, and therefore the return value is misleading</p>\n</blockquote>\n\n<p>describes the issue.</p>\n\n<p>I have defined my datastructure as such,</p>\n\n<pre><code> typedef struct queue {\n     element *head;\n     element *tail;\n\n     /* Lock for all read/write operations */\n     pthread_mutex_t *mutex;\n\n     /* Condition variable for whether or not the queue is empty */\n     /* Negation in variable names is poor practice but it is the */\n     /* only solution here considering the conditional variable API */\n     /* (signal/broadcast) */\n     pthread_cond_t *not_empty;\n\n     /* Flag used to gauge when to wait on the not_empty condition variable */\n     bool is_empty;\n\n     /* A flag to set whenever the queue is about to be destroyed */\n     bool cancel;\n } queue;\n</code></pre>\n\n<p>And for the implementation of the other functions I have worked around\nthe inadequate <code>queue_is_empty</code> function by only checking the value of\n<code>q-&gt;is_empty</code> since I have already taken a lock on the structure before checking the value.</p>\n\n<p>The <code>queue_dequeue</code> function serves as an example of where one would want to know if the queue is empty. See the first <code>if</code>-statement.</p>\n\n<pre><code> void *queue_dequeue(queue *q) {\n     assert(q);\n\n     void *value = NULL;\n     pthread_mutex_lock(q-&gt;mutex);\n\n     /* We have a mutex-lock here, so we can atomically check this flag */\n     if (q-&gt;is_empty) {\n         /* We do not have to check the cancel flag here, if the thread is awoken */\n         /* in a destruction context the waiting thread will be awoken, the later */\n         /* if statement checks the flag before modification of the queue */\n\n         /* This allows other threads to access the lock, thus signalling this thread */\n         /* When this thread is awoken by this wait the queue will not be empty, or */\n         /* the queue is about to be destroyed */\n         pthread_cond_wait(q-&gt;not_empty, q-&gt;mutex);\n     }\n\n     /* We have a mutex lock again so we may atomically check both flags */\n     if (!q-&gt;cancel &amp;&amp; !q-&gt;is_empty) {\n         value = q-&gt;head-&gt;value;\n         if (q-&gt;head-&gt;next) {            \n             q-&gt;head = q-&gt;head-&gt;next;\n             free(q-&gt;head-&gt;previous);\n\n             /* Make dereferencing dangling pointers crash the program */\n             q-&gt;head-&gt;previous = NULL;\n         } else {\n             free(q-&gt;head);\n             q-&gt;head = NULL;\n             q-&gt;is_empty = true;\n         }        \n     }\n\n     pthread_mutex_unlock(q-&gt;mutex);\n     return value; \n }\n</code></pre>\n\n<p>How do I expose a thread-safe <code>queue_is_empty</code> function?</p>\n"}, {"tags": ["c", "pointers"], "answers": [{"comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 4, "creation_date": 1467192464, "post_id": 38095518, "comment_id": 63625806, "body": "Functor objects and operator overloading won&#39;t work well in C though."}], "tags": [], "owner": {"reputation": 962, "user_id": 6492540, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yQDfs.jpg?s=128&g=1", "display_name": "buld0zzr", "link": "https://stackoverflow.com/users/6492540/buld0zzr"}, "is_accepted": false, "score": -2, "last_activity_date": 1467193203, "last_edit_date": 1467193203, "creation_date": 1467192394, "answer_id": 38095518, "question_id": 38095166, "link": "https://stackoverflow.com/questions/38095166/funtion-pointer-to-function-returning-pointer-to-said-function-type/38095518#38095518", "title": "Funtion pointer to function returning pointer to said function type", "body": "<p>There's an ugly solution which relies on casting</p>\n\n<pre><code>typedef void* (*FunctionType)(int);\nvoid* func(int a){\n    return (void*)func;\n}\n\nint main(void){\n    FunctionType p = (FunctionType)func(3);\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1467193632, "post_id": 38095858, "comment_id": 63626642, "body": "I think this is about as undefined as the <code>void*</code> solution. And for good reasons: I&#39;m pretty sure this could would mess up the code that picks the appropriate calling convention on many systems."}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1467193740, "post_id": 38095858, "comment_id": 63626723, "body": "@Lundin It is defined: <i>A pointer to a function of one type may be converted to a pointer to a function of another type and back again; the result shall compare equal to the original pointer. If a converted pointer is used to call a function whose type is not compatible with the referenced type, the behavior is undefined.</i>"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1467193880, "post_id": 38095858, "comment_id": 63626842, "body": "Yeah I am aware of that text. The thing is, the compiler expects a function of return type void and you give it a function pointer return type, or vice versa. So it seems likely that the types are not compatible indeed, in which case you invoke undefined behavior and the compiler generates an incorrect calling convention."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1467193953, "post_id": 38095858, "comment_id": 63626897, "body": "@user694733 No they are not. In practice, they most likely have the same representation (just a number like any pointer), but the <i>calling convention</i> generated for the function call may differ depending on the function type. The actual function pointer copy/assignment is not the problem, calling the function is."}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1467193969, "post_id": 38095858, "comment_id": 63626905, "body": "@Lundin I don&#39;t follow. A function pointer is converted to a function pointer of a different type and then back to the original type. This is defined in the Standard. If you&#39;re suggesting that an implementation doesn&#39;t follow that, then it isn&#39;t conforming."}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1467194378, "post_id": 38095858, "comment_id": 63627182, "body": "@Lundin No, the function call is done with the type: <code>type</code>, as you can see in the assignment: <code>type* function = ( type* )Function( 55 ) ;</code>"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1467194432, "post_id": 38095858, "comment_id": 63627215, "body": "Yeah nevermind that, I confused which type that was the return type."}], "tags": [], "owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "is_accepted": false, "score": 1, "last_activity_date": 1467193901, "last_edit_date": 1467193901, "creation_date": 1467193320, "answer_id": 38095858, "question_id": 38095166, "link": "https://stackoverflow.com/questions/38095166/funtion-pointer-to-function-returning-pointer-to-said-function-type/38095858#38095858", "title": "Funtion pointer to function returning pointer to said function type", "body": "<p>Have the function return a pointer to a function and then cast it to the correct type:</p>\n\n<pre><code>typedef void( plain )( void );\ntypedef plain*( type )( int );\n\nplain* Function2( int value );\n\nplain* Function( int value )\n{\n    return ( plain* )&amp;Function2 ;\n}\n\nint main( void )\n{\n    type* function = ( type* )Function( 55 ) ;\n}\n</code></pre>\n\n<p>This is very error prone, so you should probably change your approach to the solution and not use this.</p>\n"}, {"comments": [{"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1467194550, "post_id": 38095918, "comment_id": 63627297, "body": "I&#39;m assuming you didn&#39;t flag the comment. Do you think it was automatically removed because it contained the word <code>Upvoted</code> ? Strange. Anyway, this is much better because you don&#39;t have to cast and can&#39;t make a mistake."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1467197125, "post_id": 38095918, "comment_id": 63628982, "body": "@2501 Not quite sure what you are talking about. I haven&#39;t flagged any comments."}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1467197314, "post_id": 38095918, "comment_id": 63629104, "body": "A positive comment was removed."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1467207529, "post_id": 38095918, "comment_id": 63636418, "body": "@2501 Maybe it was a false positive? :P"}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1467207752, "post_id": 38095918, "comment_id": 63636628, "body": "That&#39;s pretty funny."}], "tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": true, "score": 4, "last_activity_date": 1467193703, "last_edit_date": 1467193703, "creation_date": 1467193456, "answer_id": 38095918, "question_id": 38095166, "link": "https://stackoverflow.com/questions/38095166/funtion-pointer-to-function-returning-pointer-to-said-function-type/38095918#38095918", "title": "Funtion pointer to function returning pointer to said function type", "body": "<p>First of all, the need to do really obscure things like this <em>always</em> originate from muddy program design. You are trying to solve problem X, and you think that method Y will do it. So you ask us how to get Y working, even though it was most likely not the correct solution to begin with. The root of the problem might be that X is incorrectly designed.</p>\n\n<p>That being said, you can do this by using a struct as wrapper and thereby taking advantage of incomplete struct types:</p>\n\n<pre><code>typedef struct func_wrapper_t\n{\n  struct func_wrapper_t (*func) (int);\n} func_t;\n\n...\n\nfunc_t some_function (int x)\n{\n  ...\n  return (func_t){ some_function };\n}\n\n...\n\nint main(void)\n{\n  func_t f = some_function(0);\n\n  return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 95, "user_id": 6527528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff405acb88a3f9f88b8eaa83943e66d4?s=128&d=identicon&r=PG&f=1", "display_name": "Tobi", "link": "https://stackoverflow.com/users/6527528/tobi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 1, "accepted_answer_id": 38095918, "answer_count": 3, "score": 4, "last_activity_date": 1467193901, "creation_date": 1467191600, "last_edit_date": 1467192660, "question_id": 38095166, "link": "https://stackoverflow.com/questions/38095166/funtion-pointer-to-function-returning-pointer-to-said-function-type", "title": "Funtion pointer to function returning pointer to said function type", "body": "<p>For an implementation of a finite state machine, I would like to achieve something like this:</p>\n\n<pre><code>currentFunction = currentFunction(int arg);\n</code></pre>\n\n<p>with <code>currentFunction</code> being a function pointer to a function that returns a function pointer of the same function type.</p>\n\n<p>Is this possible in C? How?</p>\n"}, {"tags": ["c++", "c", "arrays", "gcc", "g++"], "comments": [{"owner": {"reputation": 61304, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 2, "creation_date": 1467191529, "post_id": 38095046, "comment_id": 63625144, "body": "C or C++ ? use <code>std::vector</code> if it is C++"}, {"owner": {"reputation": 880, "user_id": 4515030, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/3EsAY.jpg?s=128&g=1", "display_name": "izaak_pyzaak", "link": "https://stackoverflow.com/users/4515030/izaak-pyzaak"}, "edited": false, "score": 0, "creation_date": 1467191598, "post_id": 38095046, "comment_id": 63625195, "body": "Before you even begin solving for algorithmic functionality. Maybe it&#39;s best to read some books on c++ basics; there are many syntax errors in the code"}, {"owner": {"reputation": 880, "user_id": 4515030, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/3EsAY.jpg?s=128&g=1", "display_name": "izaak_pyzaak", "link": "https://stackoverflow.com/users/4515030/izaak-pyzaak"}, "edited": false, "score": 0, "creation_date": 1467191666, "post_id": 38095046, "comment_id": 63625249, "body": "Too many to reasonably answers in one question, to not make the answer and question off topic . If possible break the snippet down and report :)"}, {"owner": {"reputation": 61304, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1467192393, "post_id": 38095046, "comment_id": 63625751, "body": "I dont want to be too pedantic, but this code wont compile (there is at least one missing <code>;</code>). Please post real code that produces the error"}, {"owner": {"reputation": 61304, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "reply_to_user": {"reputation": 880, "user_id": 4515030, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/3EsAY.jpg?s=128&g=1", "display_name": "izaak_pyzaak", "link": "https://stackoverflow.com/users/4515030/izaak-pyzaak"}, "edited": false, "score": 0, "creation_date": 1467192457, "post_id": 38095046, "comment_id": 63625800, "body": "@izaak_pyzaak what &quot;many&quot; syntax errors do you mean? I can spot one, but thats enough to know that this code does not produce the output OP claims"}, {"owner": {"reputation": 880, "user_id": 4515030, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/3EsAY.jpg?s=128&g=1", "display_name": "izaak_pyzaak", "link": "https://stackoverflow.com/users/4515030/izaak-pyzaak"}, "edited": false, "score": 0, "creation_date": 1467192677, "post_id": 38095046, "comment_id": 63625977, "body": "Plus your last comment, there is &quot;rowA&quot; which I can&#39;t see an initialization for."}, {"owner": {"reputation": 61304, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "reply_to_user": {"reputation": 880, "user_id": 4515030, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/3EsAY.jpg?s=128&g=1", "display_name": "izaak_pyzaak", "link": "https://stackoverflow.com/users/4515030/izaak-pyzaak"}, "edited": false, "score": 0, "creation_date": 1467192797, "post_id": 38095046, "comment_id": 63626064, "body": "@izaak_pyzaak which means the OP doesnt show a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> but thats probably not a syntax error. It might be a global variable"}, {"owner": {"reputation": 880, "user_id": 4515030, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/3EsAY.jpg?s=128&g=1", "display_name": "izaak_pyzaak", "link": "https://stackoverflow.com/users/4515030/izaak-pyzaak"}, "edited": false, "score": 0, "creation_date": 1467193077, "post_id": 38095046, "comment_id": 63626269, "body": "Agreed, but as its supposed to safely bound arrayA, for the outer loop seems a little strange why it is neither k-1, not 3. But yeah, fair nuf"}], "answers": [{"tags": [], "owner": {"reputation": 1402, "user_id": 6554747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Xlzqs.png?s=128&g=1", "display_name": "progyammer", "link": "https://stackoverflow.com/users/6554747/progyammer"}, "is_accepted": false, "score": 0, "last_activity_date": 1467870172, "creation_date": 1467870172, "answer_id": 38238241, "question_id": 38095046, "link": "https://stackoverflow.com/questions/38095046/shifting-array-elements-by-n-positions/38238241#38238241", "title": "Shifting array elements by n positions", "body": "<p>To insert <code>n</code> elements at index <code>k</code> of an array, try this <strong>logic</strong>:  </p>\n\n<p>Initialize an <strong>original</strong> array having the elements. Now, take the values of <code>n</code>, <code>k</code> in the variables and the <strong>n</strong> elements to insert in another array (let's say <strong>to_add[]</strong>) from the user. Now, initialize a <strong>second</strong> array of length = <strong>length of main array</strong> + <strong>n</strong>.<br>\n<strong>(1)</strong> Having all the required values and arrays initialized, run a loop from index = <code>0</code> to index = <code>k-1</code> of the main array and copy those elements to the the second array.<br>\n<strong>(2)</strong> Now, run a second loop from index = <code>k</code> to index = <code>k  + n - 1</code> for the second array and copy all the elements for the index = <code>index - k</code> of the to_add array into the second array.<br>\n<strong>(3)</strong> Lastly, run a third loop from index = <code>k + n</code> to index = <code>(length of second array) - 1</code> of the second array and copy all the elements for index = <code>index - n</code> of the main array into the second array.  </p>\n\n<p>Here's the C++ code for the above logic.  </p>\n\n<pre><code>int k,n;\nint main_array[x] = { /* elements of the original array */ };\n/* display the main array */\ncout &lt;&lt; \"Enter index position at which to enter elements \\n\" ;\ncin &gt;&gt; k;\ncout &lt;&lt; \"\\n How many elements do you want to enter? \\n\" ;\ncin &gt;&gt; n;\nint to_add[n];\nint final_array[x+n];\n/* accept elements to be added into the to_add array */\n\n//first loop\nfor(int i = 0; i &lt; k; i++){\n    final_array[i] = main_array[i];\n}\n\n//second loop\nfor(int i = k; i &lt; k+n; i++){\n    final_array[i] = to_add[i-k];\n}\n\n//last loop\nfor(int i = k+n; i &lt; x+n; i++){\n    final_array[i] = main_array[i-n];\n}\n\n/* display the final_array */\n</code></pre>\n\n<p>I hope you understand it and it solves your problem.</p>\n"}], "owner": {"reputation": 1, "user_id": 6527492, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25607011227529c7e3580377d0eb0b86?s=128&d=identicon&r=PG&f=1", "display_name": "shree", "link": "https://stackoverflow.com/users/6527492/shree"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 424, "favorite_count": 1, "answer_count": 1, "score": -3, "last_activity_date": 1467870172, "creation_date": 1467191280, "last_edit_date": 1467191567, "question_id": 38095046, "link": "https://stackoverflow.com/questions/38095046/shifting-array-elements-by-n-positions", "title": "Shifting array elements by n positions", "body": "<p>I have basic knowledge in C, C++ and im trying to insert n elements at k positions in an array and shift the k+1 element in the array.\nI have used two for loops  for this</p>\n\n<pre><code>void insert(int n,int k)\n{\n  int temp=arrayA[k][4];\n\n  for(int u=k+1;u&lt;=rowA;u++)\n  {\n    arrayA[k+n][4]=arrayA[k+1][4];\n    arrayA[k+n][3]=Bigradius;\n    arrayA[k+n][2]=arrayA[k+1][2];\n    arrayA[k+n][1]=arrayA[k+1][1];\n    arrayA[k+n][0]=arrayA[k+1][0];\n  }\n\n  for(int pos=k;pos&lt;=k+n-1;pos++,)\n  {   \n    arrayA[pos][4]=temp;\n    arrayA[pos][3]=B\n    arrayA[pos][2]=s1;\n    arrayA[pos][1]=s2;\n    arrayA[pos][0]=s3;  \n  }  \n}\n</code></pre>\n\n<p>where n is no of new elements,k is the position where new elements are inserted,s1,s2,s3..are some values</p>\n\n<p>if initial file is\n   0.74172455 0.03613250 0.82822931 0.03121938 0\n   0.45620244 0.33476580 0.92169053 0.03121938 1\n   0.13701758 0.74540644 0.56569663 0.03121938 2\n   0.94162524 0.13094005 0.62107182 0.03121938 3</p>\n\n<p>but in output if im inserting 3 elements in position 0,then elements at position 1,2 are missing</p>\n\n<pre><code>-0.0104065  0.0312194 0.0728452 0.0104065      0 \n 0.0104065 -0.0312194 0.0520323 0.0104065      0 \n 0.0104065 -0.0312194 0.0520323 0.0312194      0 \n 0.941625   0.13094   0.621072  0.0312194      3 \n</code></pre>\n"}, {"tags": ["c", "pic", "microchip", "xc8"], "comments": [{"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1467190058, "post_id": 38094426, "comment_id": 63624180, "body": "what is the expected value and what was returned?"}, {"owner": {"reputation": 31, "user_id": 4124726, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/235297a1f3fdc6b072e60185a5cab74a?s=128&d=identicon&r=PG&f=1", "display_name": "M Curry", "link": "https://stackoverflow.com/users/4124726/m-curry"}, "edited": false, "score": 0, "creation_date": 1467190981, "post_id": 38094426, "comment_id": 63624772, "body": "Compiler message is the title of this question &quot;Error: (195) expression syntax&quot; and occurs on the second line.  It is not an issue of wrong value returned, it is that the compiler will not accept that line - I included the line before due to previous questions asked about the error actually stem from missing semi-colons on the line before etc."}, {"owner": {"reputation": 8169, "user_id": 759558, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/kz2la.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/759558/neil"}, "edited": false, "score": 0, "creation_date": 1467190987, "post_id": 38094426, "comment_id": 63624775, "body": "I presume ssc_sr_1 is uint8_t or other 8-bit value?  If not, potentially the compiler could be detecting an invalid operation."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1467191664, "post_id": 38094426, "comment_id": 63625245, "body": "Probably one of the compilers can&#39;t find the <code>stdint.h</code> types. Did you include that header and do both compilers support C99? Are both compilers configured to compile as C99?"}, {"owner": {"reputation": 31, "user_id": 4124726, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/235297a1f3fdc6b072e60185a5cab74a?s=128&d=identicon&r=PG&f=1", "display_name": "M Curry", "link": "https://stackoverflow.com/users/4124726/m-curry"}, "edited": false, "score": 1, "creation_date": 1467191743, "post_id": 38094426, "comment_id": 63625289, "body": "With the filter_pressure_left = line commented out, the code compiles, so it shouldn&#39;t be a stdint issue."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1467191829, "post_id": 38094426, "comment_id": 63625354, "body": "@MCurry It could be a C99 issue though. Maybe it doesn&#39;t like C99 <code>&#47;&#47;</code> comments. Please verify that your compiler is compiling the code as C99. Older versions of GCC compile as &quot;gnu90&quot; by default, which is C90 + misc non-standard extensions."}, {"owner": {"reputation": 48421, "user_id": 1196549, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/fa597bf0dc47449a25e1f7f5b57e3ef1?s=128&d=identicon&r=PG", "display_name": "Yves Daoust", "link": "https://stackoverflow.com/users/1196549/yves-daoust"}, "edited": false, "score": 0, "creation_date": 1467191948, "post_id": 38094426, "comment_id": 63625430, "body": "If the defines are as you say, I guarantee that there is no syntax error on the second line."}, {"owner": {"reputation": 31, "user_id": 4124726, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/235297a1f3fdc6b072e60185a5cab74a?s=128&d=identicon&r=PG&f=1", "display_name": "M Curry", "link": "https://stackoverflow.com/users/4124726/m-curry"}, "edited": false, "score": 0, "creation_date": 1467192045, "post_id": 38094426, "comment_id": 63625510, "body": "Edit2 to Q includes more explicit definition of problem per comments here. With the #defines changed to <code>&#47;* comments *&#47;</code>, there is no difference. There are other #define constants defined in the same header file that work with no problem."}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 4124726, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/235297a1f3fdc6b072e60185a5cab74a?s=128&d=identicon&r=PG&f=1", "display_name": "M Curry", "link": "https://stackoverflow.com/users/4124726/m-curry"}, "edited": false, "score": 1, "creation_date": 1467193282, "post_id": 38095620, "comment_id": 63626416, "body": "For completeness, <code>(MAX_PRESSURE_PA-MIN_PRESSURE_PA)</code> precompiles to <code>(249--249)</code>, which is syntactically very ambiguous, hence the error."}], "tags": [], "owner": {"reputation": 31, "user_id": 4124726, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/235297a1f3fdc6b072e60185a5cab74a?s=128&d=identicon&r=PG&f=1", "display_name": "M Curry", "link": "https://stackoverflow.com/users/4124726/m-curry"}, "is_accepted": true, "score": 2, "last_activity_date": 1467192635, "creation_date": 1467192635, "answer_id": 38095620, "question_id": 38094426, "link": "https://stackoverflow.com/questions/38094426/error-195-expression-syntax/38095620#38095620", "title": "Error: (195) expression syntax", "body": "<p>Spaces spaces spaces!</p>\n\n<p>Changing the second line to:</p>\n\n<pre><code>filter_pressure_left = (uint16_t)(MIN_PRESSURE_PA + (rawPressure - MIN_PRESSURE_RAW) * (MAX_PRESSURE_PA - MIN_PRESSURE_PA) / (MAX_PRESSURE_RAW - MIN_PRESSURE_RAW));\n</code></pre>\n\n<p>compiles without error.</p>\n\n<p>For reference to people coming across this in the future - split your equation to multiple lines to identify exactly which portion is failing - in my case <code>(MAX_PRESSURE_PA-MIN_PRESSURE_PA)</code> caused the error and absent-mindedly adding spaces and re-compiling cured it.</p>\n"}], "owner": {"reputation": 31, "user_id": 4124726, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/235297a1f3fdc6b072e60185a5cab74a?s=128&d=identicon&r=PG&f=1", "display_name": "M Curry", "link": "https://stackoverflow.com/users/4124726/m-curry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1581, "favorite_count": 0, "accepted_answer_id": 38095620, "answer_count": 1, "score": 1, "last_activity_date": 1467192635, "creation_date": 1467189597, "last_edit_date": 1467191885, "question_id": 38094426, "link": "https://stackoverflow.com/questions/38094426/error-195-expression-syntax", "title": "Error: (195) expression syntax", "body": "<p>I have a codebase that compiles for both a PIC18 and PIC24.</p>\n\n<p>Whilst writing a driver for a new sensor on the PIC24, I recompiled for the PIC18 and the calculation of pressure fails:</p>\n\n<pre><code>{\n    // Normal operation, valid data\n    uint32_t rawPressure = ((ssc_sr_1[0] &amp; 0x3F) &lt;&lt; 8) + ssc_sr_2[0];\n    filter_pressure_left = (uint16_t)(MIN_PRESSURE_PA + (rawPressure - MIN_PRESSURE_RAW)*(MAX_PRESSURE_PA-MIN_PRESSURE_PA)/(MAX_PRESSURE_RAW-MIN_PRESSURE_RAW));\n}\n</code></pre>\n\n<p>On compile, the error <code>i2c.c:546: error: (195) expression syntax</code> (where line 546 is the <code>filter_pressure_left =</code> line) is thrown.</p>\n\n<p>I cannot see anything syntactically wrong to throw this error, which is backed up by it not being thrown when compiling with xc16-gcc.</p>\n\n<p>Compiler Versions:</p>\n\n<ul>\n<li>XC16-GCC V1.23</li>\n<li>XC8 V1.33</li>\n</ul>\n\n<p>Additional information requested surrounding values used:</p>\n\n<pre><code>DECLARE unsigned char ssc_sr_1[2];\nDECLARE unsigned char ssc_sr_2[2];\n#define MAX_PRESSURE_PA                 249\n#define MIN_PRESSURE_PA                 -249\n#define MAX_PRESSURE_RAW                14745   // 90% of 2^14\n#define MIN_PRESSURE_RAW                1638    // 10% of 2^14\n</code></pre>\n"}, {"tags": ["c", "arrays", "dynamic", "struct"], "answers": [{"tags": [], "owner": {"reputation": 4398, "user_id": 3697264, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/5adc5afbd7a1145fdd762d872b4b43bb?s=128&d=identicon&r=PG", "display_name": "SPlatten", "link": "https://stackoverflow.com/users/3697264/splatten"}, "is_accepted": false, "score": 1, "last_activity_date": 1467189629, "creation_date": 1467189629, "answer_id": 38094439, "question_id": 38094379, "link": "https://stackoverflow.com/questions/38094379/assiging-data-to-character-array-of-a-structure-member-using-pointer/38094439#38094439", "title": "Assiging data to character array of a structure member using pointer", "body": "<p>In your example 'c' is an array of 20 bytes, so you could use strcpy:</p>\n\n<pre><code>    strcpy(struct_pointer-&gt;c, \"hellos\");\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 80, "user_id": 2851510, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000328348894/picture?type=large", "display_name": "Hung Minh Tran", "link": "https://stackoverflow.com/users/2851510/hung-minh-tran"}, "is_accepted": false, "score": -1, "last_activity_date": 1467190957, "creation_date": 1467190957, "answer_id": 38094908, "question_id": 38094379, "link": "https://stackoverflow.com/questions/38094379/assiging-data-to-character-array-of-a-structure-member-using-pointer/38094908#38094908", "title": "Assiging data to character array of a structure member using pointer", "body": "<p>Remember that \"hellos\" is not the same type with char[20], so you should try this:</p>\n\n<pre><code>strcpy(struct_pointer-&gt;c, \"hellos\");\n</code></pre>\n\n<p>instead of assignment a <code>const char*</code> to <code>char[20]</code> variable</p>\n"}, {"tags": [], "owner": {"reputation": 962, "user_id": 6492540, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yQDfs.jpg?s=128&g=1", "display_name": "buld0zzr", "link": "https://stackoverflow.com/users/6492540/buld0zzr"}, "is_accepted": false, "score": 1, "last_activity_date": 1467191090, "creation_date": 1467191090, "answer_id": 38094960, "question_id": 38094379, "link": "https://stackoverflow.com/questions/38094379/assiging-data-to-character-array-of-a-structure-member-using-pointer/38094960#38094960", "title": "Assiging data to character array of a structure member using pointer", "body": "<p>Your code</p>\n\n<pre><code>struct_pointer-&gt;c=\"hellos\"\n</code></pre>\n\n<p>actually tells compiler to do the following - allocate memory for string <code>\"hellos\"</code> plus null terminator and assign the pointer to this memory to <code>struct_pointer-&gt;c</code>, which is already allocated, thus compiler complaint is perfectly valid. In C you can't just assign a char array to another array, you need to use any type of memory copy function, for example</p>\n\n<pre><code>strcpy(struct_pointer-&gt;c, \"hellos\")\n</code></pre>\n\n<blockquote>\n  <p>In my code I know that an array uses static memory allocation and pointer uses malloc for dynamic memory allocation</p>\n</blockquote>\n\n<p>It's not like that, in C you don't get automatic dynamic memory allocation unless you call <code>malloc</code> or its variants explicitly. Memory for <code>\"hellos\"</code> is also allocated on the stack</p>\n"}], "owner": {"reputation": 7, "user_id": 6191391, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d83f765d13cb40aa421b50471d207cb7?s=128&d=identicon&r=PG&f=1", "display_name": "MD GHOUSE", "link": "https://stackoverflow.com/users/6191391/md-ghouse"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "answer_count": 3, "score": -2, "last_activity_date": 1467191090, "creation_date": 1467189478, "question_id": 38094379, "link": "https://stackoverflow.com/questions/38094379/assiging-data-to-character-array-of-a-structure-member-using-pointer", "title": "Assiging data to character array of a structure member using pointer", "body": "<p>I was trying to experiment with structures and came up with a problem When I am,assign data to a character array of a structure member using  a pointer the compiler is throwing an error: \"assignment to expression with array type\". In my code I know that an array uses static memory allocation and pointer uses malloc for dynamic memory allocation. Can some body tell me how to resolve the issue.<a href=\"http://i.stack.imgur.com/tdeV6.jpg\" rel=\"nofollow\">Code for passing the structure pointer to a function to print the structure data</a></p>\n"}, {"tags": ["c++", "c", "multithreading"], "comments": [{"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "edited": false, "score": 0, "creation_date": 1467188420, "post_id": 38093889, "comment_id": 63623109, "body": "I don&#39;t see it either. Are you sure <i>this</i> is the code that prints <code>0</code> for <code>which_prime</code>?"}, {"owner": {"reputation": 8978, "user_id": 2223579, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/wQuP6.jpg?s=128&g=1", "display_name": "BlackMamba", "link": "https://stackoverflow.com/users/2223579/blackmamba"}, "reply_to_user": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "edited": false, "score": 0, "creation_date": 1467188472, "post_id": 38093889, "comment_id": 63623145, "body": "@P.P. Yes, i am sure, you can try."}, {"owner": {"reputation": 4939, "user_id": 6292621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a024e1125c7f69a49d7f1a4861d7b63?s=128&d=identicon&r=PG&f=1", "display_name": "lorro", "link": "https://stackoverflow.com/users/6292621/lorro"}, "edited": false, "score": 0, "creation_date": 1467188571, "post_id": 38093889, "comment_id": 63623197, "body": "<a href=\"https://ideone.com/UCHLzi\" rel=\"nofollow noreferrer\">ideone.com/UCHLzi</a> Output: The 5000 th prime number is 48611."}, {"owner": {"reputation": 735, "user_id": 2568434, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/2aDtk.jpg?s=128&g=1", "display_name": "dear_tzvi", "link": "https://stackoverflow.com/users/2568434/dear-tzvi"}, "edited": false, "score": 0, "creation_date": 1467188584, "post_id": 38093889, "comment_id": 63623206, "body": "Did you check what value is being set for &#39;n&#39;? it seems that this is a memory address, not the actual value. it should be ** because args is a pointer, and it points on which_prime address"}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1467189094, "post_id": 38093889, "comment_id": 63623544, "body": "This is undefined behavior. Start by printing the pointers by using the correct printf specifier."}], "answers": [{"comments": [{"owner": {"reputation": 8978, "user_id": 2223579, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/wQuP6.jpg?s=128&g=1", "display_name": "BlackMamba", "link": "https://stackoverflow.com/users/2223579/blackmamba"}, "edited": false, "score": 0, "creation_date": 1467188577, "post_id": 38094062, "comment_id": 63623202, "body": "I am confuised about <code>void *prime_result;, prime = (int)prime_result;</code>, the type of <code>prime_result</code> is <code>void*</code>, how can it convert to <code>int</code>, is it ok?"}, {"owner": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "reply_to_user": {"reputation": 8978, "user_id": 2223579, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/wQuP6.jpg?s=128&g=1", "display_name": "BlackMamba", "link": "https://stackoverflow.com/users/2223579/blackmamba"}, "edited": false, "score": 1, "creation_date": 1467188919, "post_id": 38094062, "comment_id": 63623431, "body": "@BlackMamba It&#39;s not very good C, but will work on all POSIX architectures which is where pthreads exist. The key here is to have the right types."}, {"owner": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "edited": false, "score": 3, "creation_date": 1467189144, "post_id": 38094062, "comment_id": 63623585, "body": "Personally, I rarely return anything but NULL from threads and instead pass a struct through pthread_create which contains both the &quot;request&quot; that the thread will execute and the results that the thread stores after it&#39;s done. It&#39;s cleaner from the point of view of allocations and casts. But it&#39;s a matter of style."}], "tags": [], "owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "is_accepted": false, "score": 2, "last_activity_date": 1467188454, "creation_date": 1467188454, "answer_id": 38094062, "question_id": 38093889, "link": "https://stackoverflow.com/questions/38093889/how-the-run-function-of-pthread-modify-the-external-variable/38094062#38094062", "title": "How the run function of `pthread` modify the external variable?", "body": "<p>This:</p>\n\n<pre><code>pthread_join(thread, (void**)&amp;prime);\n</code></pre>\n\n<p>is incorrect and leads to undefined behaviour. <code>&amp;prime</code> is not a <code>void**</code> because <code>prime</code> is not a <code>void*</code>. Note that <code>void**</code> is <strong>not</strong> a \"generic pointer-to-pointer\" - it's a normal pointer, to a <code>void*</code>.</p>\n\n<p>Instead, you should do this:</p>\n\n<pre><code>void *prime_result;\npthread_join(thread, &amp;prime_result);\nprime = (int)prime_result;\n</code></pre>\n\n<p>Most likely, <code>void*</code> and <code>int</code> are different sizes on your system and so trying to access <code>*(void**)&amp;prime</code> results in memory corruption.</p>\n"}], "owner": {"reputation": 8978, "user_id": 2223579, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/wQuP6.jpg?s=128&g=1", "display_name": "BlackMamba", "link": "https://stackoverflow.com/users/2223579/blackmamba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1467188454, "creation_date": 1467187901, "last_edit_date": 1467188454, "question_id": 38093889, "link": "https://stackoverflow.com/questions/38093889/how-the-run-function-of-pthread-modify-the-external-variable", "title": "How the run function of `pthread` modify the external variable?", "body": "<p>Here is my code:</p>\n\n<pre><code>#include &lt;pthread.h&gt;\n#include &lt;iostream&gt;\nusing namespace std;\n\nvoid* compute_prime (void* args) \n{\n  int candidate = 2;\n  int n = *((int*)args);\n\n  while(1) {\n    int factor;\n    int is_prime = 1;\n    for (factor = 2; factor &lt; candidate; ++factor)\n      if(candidate % factor == 0) {\n    is_prime = 0;\n    break;\n      }\n    if(is_prime){\n      if(--n == 0)\n    return (void*)candidate;\n    }\n    ++candidate;\n  }\n  return NULL;\n}\n\nint main()\n{\n  pthread_t thread;\n  int which_prime = 5000;\n  int prime;\n  pthread_create (&amp;thread, NULL, &amp;compute_prime, &amp;which_prime);\n\n  pthread_join(thread, (void**)&amp;prime);\n  printf(\"The %d th prime number is %d.\\n\", which_prime, prime);\n};\n</code></pre>\n\n<p><strong>the output is:</strong>\n<code>The 0 th prime number is 48611.</code></p>\n\n<p>What my confuse is \"why <code>which_prime</code> becomes <code>0</code> in the main thread\".</p>\n\n<p>I think in function <code>void* compute_prime (void* args)</code>, the <code>n</code> is a copy of <code>which_prime</code>, then the modify is for <code>n</code>, not for <code>which_prime</code>, so what's the reason?</p>\n"}, {"tags": ["c", "build", "linux-kernel", "kernel-module", "kbuild"], "answers": [{"comments": [{"owner": {"reputation": 255, "user_id": 4932023, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/923048974424001/picture?type=large", "display_name": "\u0418\u0432\u043e \u0421\u0442\u0440\u0430\u0442\u0435\u0432", "link": "https://stackoverflow.com/users/4932023/%d0%98%d0%b2%d0%be-%d0%a1%d1%82%d1%80%d0%b0%d1%82%d0%b5%d0%b2"}, "edited": false, "score": 0, "creation_date": 1467189559, "post_id": 38094268, "comment_id": 63623860, "body": "no I&#39;ve added that printk cuz it just generates error when called outside of stack so I can prove that the CNC_controller.c is compiled second time but note first (when there is dependency, the first time it just get&#39;s linked ...)"}], "tags": [], "owner": {"reputation": 3566, "user_id": 4325010, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/048bff2cd5cae6d0a93ecd485f6690ad?s=128&d=identicon&r=PG&f=1", "display_name": "users at 4325010", "link": "https://stackoverflow.com/users/4325010/users-at-4325010"}, "is_accepted": false, "score": 1, "last_activity_date": 1467189101, "creation_date": 1467189101, "answer_id": 38094268, "question_id": 38093642, "link": "https://stackoverflow.com/questions/38093642/main-file-not-compiling-when-compiling-kernel-module-from-multiple-files/38094268#38094268", "title": "Main file not compiling when compiling kernel module from multiple files", "body": "<p>According to the error message, you call a function on top level. Which comes to show that there is a call outside main or another function.</p>\n\n<p>More precisely <code>printk(KERN_INFO \"CNC_controller.c\\n\");</code>. </p>\n\n<p>On a side note <code>#define KERN_SOH \"\\001\"</code> can act only as a stopper, because <code>'\\0'</code> is the terminating character. I leave to you to say if that is what you have intended.</p>\n"}, {"tags": [], "owner": {"reputation": 1959, "user_id": 1452310, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a068ce0823035b675b7a78b01a66e8b?s=128&d=identicon&r=PG", "display_name": "Alexandre Belloni", "link": "https://stackoverflow.com/users/1452310/alexandre-belloni"}, "is_accepted": true, "score": 4, "last_activity_date": 1467189676, "creation_date": 1467189676, "answer_id": 38094458, "question_id": 38093642, "link": "https://stackoverflow.com/questions/38093642/main-file-not-compiling-when-compiling-kernel-module-from-multiple-files/38094458#38094458", "title": "Main file not compiling when compiling kernel module from multiple files", "body": "<p>You have two issues:</p>\n\n<ul>\n<li>you can't use printk from global scope. This has to be moved to a function.</li>\n<li><p>You can't have a C file that has the same name as the module when trying to build a multiple file module. That is, either rename CNC_controller.c or the .ko\nFor example, rename <code>CNC_controller.c</code> <code>CNC_controller_main.c</code> and use:</p>\n\n<p>CNC_controller-objs := CNC_controller_main.c axis_controller/axis_controller.o</p></li>\n</ul>\n"}], "owner": {"reputation": 255, "user_id": 4932023, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/923048974424001/picture?type=large", "display_name": "\u0418\u0432\u043e \u0421\u0442\u0440\u0430\u0442\u0435\u0432", "link": "https://stackoverflow.com/users/4932023/%d0%98%d0%b2%d0%be-%d0%a1%d1%82%d1%80%d0%b0%d1%82%d0%b5%d0%b2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1024, "favorite_count": 0, "accepted_answer_id": 38094458, "answer_count": 2, "score": 1, "last_activity_date": 1467189676, "creation_date": 1467187136, "last_edit_date": 1467187573, "question_id": 38093642, "link": "https://stackoverflow.com/questions/38093642/main-file-not-compiling-when-compiling-kernel-module-from-multiple-files", "title": "Main file not compiling when compiling kernel module from multiple files", "body": "<p>First I want to say that I have been searching for similar problems and what is the solution. And I found that it is:</p>\n\n<pre><code>obj-m := module.o\nmodule-objs := extra.o\n</code></pre>\n\n<p>But it dosen't work for me ...</p>\n\n<p>Here is the whole project source:</p>\n\n<p>axis_controller.h:</p>\n\n<pre><code>#ifndef _AXIS_CONTROLLER_H\n#define _AXIS_CONTROLLER_H\n\n#include &lt;linux/kernel.h&gt;\n#include &lt;linux/module.h&gt;\n#include &lt;linux/hrtimer.h&gt;\n#include &lt;linux/ktime.h&gt;\n\nstruct axis_controller {\n    struct hrtimer timer;\n    int state;\n};\n\nstatic inline struct hrtimer* axis_controller_get_timer(struct axis_controller* axis_controller);\n\nstatic inline void axis_controller_reset_state(struct axis_controller* axis_controller);\n\ninline void axis_controller_init(struct axis_controller* axis_controller, enum hrtimer_restart (*function)(struct hrtimer *));\n\ninline int axis_controller_clean(struct axis_controller* axis_controller);\n\ninline void axis_controller_change_state(struct axis_controller* axis_controller, unsigned long sec, unsigned long nano_sec);\n\ninline void axis_controller_controll(struct axis_controller* axis_controller);\n\n#endif\n</code></pre>\n\n<p>axis_controller.c:</p>\n\n<pre><code>#include \"axis_controller.h\"\n\nMODULE_LICENSE(\"GPL v2\");\n\nstruct hrtimer* axis_controller_get_timer(struct axis_controller* axis_controller) {\n    return &amp;(axis_controller-&gt;timer);\n}\n\nvoid axis_controller_reset_state(struct axis_controller* axis_controller) {\n    axis_controller-&gt;state = 0;\n}\n\nvoid axis_controller_init(struct axis_controller* axis_controller, enum hrtimer_restart (*function)(struct hrtimer *)) {\n    hrtimer_init(axis_controller_get_timer(axis_controller), CLOCK_MONOTONIC, HRTIMER_MODE_REL);\n    axis_controller-&gt;timer.function = function;\n    axis_controller_reset_state(axis_controller);\n}\n\nint axis_controller_clean(struct axis_controller* axis_controller) {\n    return hrtimer_try_to_cancel(axis_controller_get_timer(axis_controller));\n}\nvoid axis_controller_change_state(struct axis_controller* axis_controller, unsigned long sec, unsigned long nano_sec) {\n    axis_controller-&gt;state = !axis_controller-&gt;state;\n    hrtimer_start(axis_controller_get_timer(axis_controller), ktime_set(sec, nano_sec), HRTIMER_MODE_REL);\n}\nvoid axis_controller_controll(struct axis_controller* axis_controller) {\n    axis_controller_reset_state(axis_controller);\n    axis_controller-&gt;timer.function(axis_controller_get_timer(axis_controller));\n}\n\n//printk(KERN_INFO \"axis_controller.c\\n\");\n</code></pre>\n\n<p>CNC_controller.c:</p>\n\n<pre><code>#include &lt;linux/kernel.h&gt;\n#include &lt;linux/module.h&gt;\n#include \"axis_controller/axis_controller.h\"\n\nMODULE_LICENSE(\"GPL v2\");\nMODULE_AUTHOR(\"Ivo Stratev (NoHomey)\");\nMODULE_DESCRIPTION(\"CNC Controller\");\n\nprintk(KERN_INFO \"CNC_controller.c\\n\");\n\nstatic int return_value;\nstatic struct axis_controller test;\n\nstatic enum hrtimer_restart my_callback(struct hrtimer *timer) {\n  printk(KERN_INFO \"my_hrtimer_callback called\\n\");\n  return HRTIMER_NORESTART;\n}\n\nstatic int __init on_load(void) {\n  printk(\"on_load\\n\");\n  axis_controller_init(&amp;test, my_callback);\n\n  axis_controller_controll(&amp;test);\n\n  return 0;\n}\n\nstatic void on_unload(void) {\n  printk(\"on_unload\\n\");\n  axis_controller_clean(&amp;test);\n  return;\n}\n\nmodule_init(on_load);\nmodule_exit(on_unload);\n</code></pre>\n\n<p>Makefile:</p>\n\n<pre><code>__name__ = CNC_controller\n__major__ = 243\n__ioctl_header__ = /usr/include/$(__name__)_ioctl.h\nmake_module_action = make -C /lib/modules/$(shell uname -r)/build M=$(PWD)\nobj-m := $(__name__).o\nCNC_controller-objs := axis_controller/axis_controller.o\n\nall: clean\n    $(make_module_action) modules\n\nclean:\n    $(make_module_action) clean\n\nload:\n    insmod $(__name__).ko\n\nunload:\n    rmmod -f $(__name__)\n\ndevice:\n    mknod /dev/$(__name__) c $(__major__) 0\n    chmod 777 /dev/$(__name__)\n\nremove:\n    rm -f /dev/$(__name__)\n\nheader:\n    rm -f $(__ioctl_header__)\n    cp $(__name__).h $(__ioctl_header__)\n    chmod 555 $(__ioctl_header__)\n</code></pre>\n\n<p>This is the build process:</p>\n\n<pre><code>ivo@ivo-Inspiron-5558:~/CNC-Controller$ make\nmake -C /lib/modules/4.4.0-28-generic/build M=/home/ivo/CNC-Controller clean\nmake[1]: Entering directory '/usr/src/linux-headers-4.4.0-28-generic'\nCLEAN   /home/ivo/CNC-Controller/.tmp_versions\nCLEAN   /home/ivo/CNC-Controller/Module.symvers\nmake[1]: Leaving directory '/usr/src/linux-headers-4.4.0-28-generic'\nmake -C /lib/modules/4.4.0-28-generic/build M=/home/ivo/CNC-Controller modules\nmake[1]: Entering directory '/usr/src/linux-headers-4.4.0-28-generic'\nCC [M]  /home/ivo/CNC-Controller/axis_controller/axis_controller.o\nLD [M]  /home/ivo/CNC-Controller/CNC_controller.o\nBuilding modules, stage 2.\nMODPOST 1 modules\nCC      /home/ivo/CNC-Controller/CNC_controller.mod.o\nLD [M]  /home/ivo/CNC-Controller/CNC_controller.ko\nmake[1]: Leaving directory '/usr/src/linux-headers-4.4.0-28-generic'\nivo@ivo-Inspiron-5558:~/CNC-Controller$ \n</code></pre>\n\n<p>When I remove the line</p>\n\n<pre><code>CNC_controller-objs := axis_controller/axis_controller.o\n</code></pre>\n\n<p>The building process is:</p>\n\n<pre><code>ivo@ivo-Inspiron-5558:~/CNC-Controller$ make\nmake -C /lib/modules/4.4.0-28-generic/build M=/home/ivo/CNC-Controller clean\nmake[1]: Entering directory '/usr/src/linux-headers-4.4.0-28-generic'\nCLEAN   /home/ivo/CNC-Controller/.tmp_versions\nCLEAN   /home/ivo/CNC-Controller/Module.symvers\nmake[1]: Leaving directory '/usr/src/linux-headers-4.4.0-28-generic'\nmake -C /lib/modules/4.4.0-28-generic/build M=/home/ivo/CNC-Controller modules\nmake[1]: Entering directory '/usr/src/linux-headers-4.4.0-28-generic'\nCC [M]  /home/ivo/CNC-Controller/CNC_controller.o\nIn file included from include/linux/printk.h:6:0,\n                from include/linux/kernel.h:13,\n                from /home/ivo/CNC-Controller/CNC_controller.c:2:\ninclude/linux/kern_levels.h:4:18: error: expected declaration specifiers or \u2018...\u2019 before string constant\n#define KERN_SOH \"\\001\"  /* ASCII Start Of Header */\n                ^\ninclude/linux/kern_levels.h:13:19: note: in expansion of macro \u2018KERN_SOH\u2019\n#define KERN_INFO KERN_SOH \"6\" /* informational */\n                ^\n/home/ivo/CNC-Controller/CNC_controller.c:10:8: note: in expansion of macro \u2018KERN_INFO\u2019\nprintk(KERN_INFO \"CNC_controller.c\\n\");\n        ^\nIn file included from /home/ivo/CNC-Controller/CNC_controller.c:4:0:\n/home/ivo/CNC-Controller/axis_controller/axis_controller.h:14:31: warning: \u2018axis_controller_get_timer\u2019 declared \u2018static\u2019 but never defined [-Wunused-function]\nstatic inline struct hrtimer* axis_controller_get_timer(struct axis_controller* axis_controller);\n                            ^\n/home/ivo/CNC-Controller/axis_controller/axis_controller.h:16:20: warning: \u2018axis_controller_reset_state\u2019 declared \u2018static\u2019 but never defined [-Wunused-function]\nstatic inline void axis_controller_reset_state(struct axis_controller* axis_controller);\n                    ^\nscripts/Makefile.build:264: recipe for target '/home/ivo/CNC-Controller/CNC_controller.o' failed\nmake[2]: *** [/home/ivo/CNC-Controller/CNC_controller.o] Error 1\nMakefile:1403: recipe for target '_module_/home/ivo/CNC-Controller' failed\nmake[1]: *** [_module_/home/ivo/CNC-Controller] Error 2\nmake[1]: Leaving directory '/usr/src/linux-headers-4.4.0-28-generic'\nMakefile:10: recipe for target 'all' failed\nmake: *** [all] Error 2\nivo@ivo-Inspiron-5558:~/CNC-Controller$ \n</code></pre>\n\n<p>And this is why I think it isn't compiling because it logs the printk error:</p>\n\n<pre><code>include/linux/kern_levels.h:4:18: error: expected declaration specifiers or \u2018...\u2019 before string constant\n    #define KERN_SOH \"\\001\"  /* ASCII Start Of Header *\n</code></pre>\n\n<p>Any clue what I do wrong? because I do what I have seen others are doing ... </p>\n"}, {"tags": ["c", "bitwise-operators", "misra"], "comments": [{"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 2, "creation_date": 1467187057, "post_id": 38093490, "comment_id": 63622230, "body": "<code>val = (val |=0xf0) &amp; ~(1&lt;&lt;0);</code> --&gt; <code>val = (val |0xf0) &amp; ~(1&lt;&lt;0);</code>"}, {"owner": {"reputation": 16785, "user_id": 3355476, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/YdMWy.jpg?s=128&g=1", "display_name": "Codor", "link": "https://stackoverflow.com/users/3355476/codor"}, "edited": false, "score": 0, "creation_date": 1467187059, "post_id": 38093490, "comment_id": 63622232, "body": "I&#39;m not sure if I understood the question; if some codings standards don&#39;t permit the one-line solution, it can&#39;t be done. Why is there a need for a shorter formulation? The presented solution seems to solve the problem well."}, {"owner": {"reputation": 344, "user_id": 3698997, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/e4f8753e591440f2dbf829da96acd0d2?s=128&d=identicon&r=PG&f=1", "display_name": "Harish", "link": "https://stackoverflow.com/users/3698997/harish"}, "edited": false, "score": 0, "creation_date": 1467187308, "post_id": 38093490, "comment_id": 63622401, "body": "can I have better logic if possible I tried the logic what you gave.Thanks for quick reply."}, {"owner": {"reputation": 22818, "user_id": 509868, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/83450238b4ee0eddbf54d7ce5a3a64e4?s=128&d=identicon&r=PG", "display_name": "anatolyg", "link": "https://stackoverflow.com/users/509868/anatolyg"}, "edited": false, "score": 2, "creation_date": 1467187583, "post_id": 38093490, "comment_id": 63622577, "body": "You should specify what is wrong in your code, e.g. quote a rule that your code violates, in addition to any other rules that you think are relevant. Simply asking for &quot;better&quot; code is meaningless if you don&#39;t define what &quot;better&quot; means."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1467188202, "post_id": 38093490, "comment_id": 63622967, "body": "&quot;to be framed in 1 logic&quot; What is this supposed to mean? There&#39;s nothing called &quot;logic&quot; in C programming. Do you mean expression? Line? <b>Why eactly would you want to merge this into one expression/line?</b> The code is readable now, if you merge it into a messy one-liner, it will turn unreadable. And where does MISRA come in? None of this code is MISRA compliant, neither the original code nor the one-liner."}, {"owner": {"reputation": 27385, "user_id": 1382251, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/17622c39e8ead537a0944c767551b2fe?s=128&d=identicon&r=PG", "display_name": "barak manos", "link": "https://stackoverflow.com/users/1382251/barak-manos"}, "edited": false, "score": 0, "creation_date": 1467188335, "post_id": 38093490, "comment_id": 63623051, "body": "You haven&#39;t addressed the size of <code>int</code> here. The 4 MSB bits are not <code>0xf0</code> on every platform. In fact, they are <code>0xf0000000</code> on most platforms."}, {"owner": {"reputation": 27385, "user_id": 1382251, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/17622c39e8ead537a0944c767551b2fe?s=128&d=identicon&r=PG", "display_name": "barak manos", "link": "https://stackoverflow.com/users/1382251/barak-manos"}, "edited": false, "score": 0, "creation_date": 1467188348, "post_id": 38093490, "comment_id": 63623059, "body": "So use <code>val = val | (((1&lt;&lt;4)-1)&lt;&lt;(sizeof(int)*CHAR_BIT-4-1)) &amp; ~(1&lt;&lt;0)</code> instead."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 27385, "user_id": 1382251, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/17622c39e8ead537a0944c767551b2fe?s=128&d=identicon&r=PG", "display_name": "barak manos", "link": "https://stackoverflow.com/users/1382251/barak-manos"}, "edited": false, "score": 0, "creation_date": 1467188377, "post_id": 38093490, "comment_id": 63623082, "body": "@barakmanos MISRA-C would take care of that. Unfortunately, this code is not MISRA compliant, so there&#39;s potential for bugs."}, {"owner": {"reputation": 27385, "user_id": 1382251, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/17622c39e8ead537a0944c767551b2fe?s=128&d=identicon&r=PG", "display_name": "barak manos", "link": "https://stackoverflow.com/users/1382251/barak-manos"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1467188458, "post_id": 38093490, "comment_id": 63623135, "body": "@Lundin: How exactly would MISRA (whoever that is) change <code>0xf0</code>into <code>0xf0000000</code>?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 27385, "user_id": 1382251, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/17622c39e8ead537a0944c767551b2fe?s=128&d=identicon&r=PG", "display_name": "barak manos", "link": "https://stackoverflow.com/users/1382251/barak-manos"}, "edited": false, "score": 0, "creation_date": 1467188601, "post_id": 38093490, "comment_id": 63623221, "body": "@barakmanos MISRA has a rule that you must always cast the result of <code>~</code> to the intended type, to avoid accidental garbage in the most significant bytes."}, {"owner": {"reputation": 27385, "user_id": 1382251, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/17622c39e8ead537a0944c767551b2fe?s=128&d=identicon&r=PG", "display_name": "barak manos", "link": "https://stackoverflow.com/users/1382251/barak-manos"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1467189195, "post_id": 38093490, "comment_id": 63623615, "body": "@Lundin: I don&#39;t see any <code>~</code> in <code>val |=0xf0</code>."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 27385, "user_id": 1382251, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/17622c39e8ead537a0944c767551b2fe?s=128&d=identicon&r=PG", "display_name": "barak manos", "link": "https://stackoverflow.com/users/1382251/barak-manos"}, "edited": false, "score": 1, "creation_date": 1467189290, "post_id": 38093490, "comment_id": 63623686, "body": "@barakmanos Reading your comment twice, I now see that you were referring to some text in the OP&#39;s question about the code supposedly setting the MSB. That doesn&#39;t make sense indeed. <code>int</code> can never be 8 bits."}, {"owner": {"reputation": 27385, "user_id": 1382251, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/17622c39e8ead537a0944c767551b2fe?s=128&d=identicon&r=PG", "display_name": "barak manos", "link": "https://stackoverflow.com/users/1382251/barak-manos"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1467189962, "post_id": 38093490, "comment_id": 63624101, "body": "@Lundin: Yes, I should probably fix that comment a little bit (from &quot;not <code>0xf0</code> on every platform&quot; to &quot;not <code>0xf0</code> on any platform). Since the question specifies &quot;4 MSB bits&quot;, it is either <code>0xf000</code> or <code>0xf00000000</code>, and I don&#39;t see how MISRA can take care of that."}], "answers": [{"comments": [{"owner": {"reputation": 7787, "user_id": 1257035, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WHLC8.png?s=128&g=1", "display_name": "a3f", "link": "https://stackoverflow.com/users/1257035/a3f"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1467188583, "post_id": 38093667, "comment_id": 63623205, "body": "@Lundin ups.. :D Fixed."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1467189555, "post_id": 38093667, "comment_id": 63623855, "body": "For MISRA compliance you should use a fixed-width integer type. And then the expression turns more complex, if you suspect that <code>int</code> could be larger than that type. The current code dodges multiple MISRA rules just because it contains no implicit conversions."}], "tags": [], "owner": {"reputation": 7787, "user_id": 1257035, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WHLC8.png?s=128&g=1", "display_name": "a3f", "link": "https://stackoverflow.com/users/1257035/a3f"}, "is_accepted": false, "score": 1, "last_activity_date": 1467188579, "last_edit_date": 1467188579, "creation_date": 1467187221, "answer_id": 38093667, "question_id": 38093490, "link": "https://stackoverflow.com/questions/38093490/bitwise-logic-framing/38093667#38093667", "title": "bitwise Logic framing", "body": "<pre><code>unsigned val = whatever();\nval = (val | 0xF0u) &amp; ~1u;\n</code></pre>\n\n<p>The nested assignment is unnecessary. I don't have a MISRA copy handy, but I think this should pass. The use of unsigned literals and types is because MISRA disallows bitwise operations on signed integers.</p>\n"}, {"tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 2, "last_activity_date": 1467188983, "creation_date": 1467188983, "answer_id": 38094231, "question_id": 38093490, "link": "https://stackoverflow.com/questions/38093490/bitwise-logic-framing/38094231#38094231", "title": "bitwise Logic framing", "body": "<p>It is entirely unclear what you mean, so here's some MISRA code review:</p>\n\n<ul>\n<li><code>int</code> is not MISRA compliant. Use a fixed-width integer type, preferably from <code>stdint.h</code>.</li>\n<li><code>0x0f</code> literals like these are not MISRA compliant. All literals need to have an <code>u</code> or <code>U</code> suffix, even hexadecimal ones.</li>\n<li><code>val |=0xf0;</code> is not MISRA compliant. You aren't allowed to use bit-wise operators on signed types.</li>\n<li><code>val &amp;=~(1&lt;&lt;0)</code> is not MISRA compliant. There is an important MISRA rule stating that the result of the <code>~</code> operator must always be cast to the intended type (called underlying type or effective type depending on MISRA version). Furthermore, MISRA does not allow you to use shift operators on signed types.</li>\n<li><code>printf</code> is not MISRA compliant. MISRA doesn't allow <code>stdio.h</code> in production code.</li>\n</ul>\n\n<p>Otherwise, the code is readable and clear. Apart from the fact that <code>int</code> is not 8 bits wide, so your talk about setting the MSBs doesn't make any sense.</p>\n\n<p>Naturally, if you try to merge this non-compliant readable code into an unreadable one-liner, it will remain non-compliant. You have to start by making the original code MISRA compliant. Might be wise to actually run it through your static analyser.</p>\n"}], "owner": {"reputation": 344, "user_id": 3698997, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/e4f8753e591440f2dbf829da96acd0d2?s=128&d=identicon&r=PG&f=1", "display_name": "Harish", "link": "https://stackoverflow.com/users/3698997/harish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 0, "answer_count": 2, "score": -3, "last_activity_date": 1467188983, "creation_date": 1467186713, "last_edit_date": 1467187290, "question_id": 38093490, "link": "https://stackoverflow.com/questions/38093490/bitwise-logic-framing", "title": "bitwise Logic framing", "body": "<p>Hi I have one requirement to be done like example first bit of register should be made 0(reset ) and MSB 4 bits need to be made 1 every time.</p>\n\n<p>I can do this in two steps using :</p>\n\n<pre><code>int val=0x0f;\nval |=0xf0;\nval &amp;=~(1&lt;&lt;0);\nprintf(\"val is %d\\n\",val);\n</code></pre>\n\n<p>I am expecting two lines of code to be framed in 1 logic.I am trying but looking for some good logic from experts.\nI got one logic like <code>val = (val |=0xf0) &amp; ~(1&lt;&lt;0);</code> but cant use this type of logic since some coding standards used are MISRA.\nPlease can any one give me some better logic.</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["c++", "c", "x11", "keyboard-events", "xlib"], "comments": [{"owner": {"reputation": 9720, "user_id": 6371123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f90991c1b06c79ae4c6e79fb616d608?s=128&d=identicon&r=PG", "display_name": "G.M.", "link": "https://stackoverflow.com/users/6371123/g-m"}, "edited": false, "score": 0, "creation_date": 1467196357, "post_id": 38093372, "comment_id": 63628493, "body": "It&#39;s not quite clear to me but, are you expecting the X11 servers view of the keyboard modifiers state to be affected by the events you send?"}, {"owner": {"reputation": 141, "user_id": 903819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/706f3d724e72364775cfd239f34b26c3?s=128&d=identicon&r=PG", "display_name": "Walter Berggren", "link": "https://stackoverflow.com/users/903819/walter-berggren"}, "reply_to_user": {"reputation": 9720, "user_id": 6371123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f90991c1b06c79ae4c6e79fb616d608?s=128&d=identicon&r=PG", "display_name": "G.M.", "link": "https://stackoverflow.com/users/6371123/g-m"}, "edited": false, "score": 0, "creation_date": 1467204134, "post_id": 38093372, "comment_id": 63633815, "body": "Yes, I&#39;m expecting that to happen."}], "answers": [{"tags": [], "owner": {"reputation": 141, "user_id": 903819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/706f3d724e72364775cfd239f34b26c3?s=128&d=identicon&r=PG", "display_name": "Walter Berggren", "link": "https://stackoverflow.com/users/903819/walter-berggren"}, "is_accepted": false, "score": 0, "last_activity_date": 1467204622, "creation_date": 1467204622, "answer_id": 38100114, "question_id": 38093372, "link": "https://stackoverflow.com/questions/38093372/xsendevent-does-not-change-modifier-key-state/38100114#38100114", "title": "XSendEvent does not change modifier key state", "body": "<p>Solved the problem by using the method <code>int XTestFakeButtonEvent(display, button, is_press, delay)</code> from the library <code>&lt;X11/extensions/XTest.h&gt;</code>. For some reason, this causes the keyboard modifier state to change when sending a modifier key (as I wanted), while the above-mentioned method does not.</p>\n"}, {"tags": [], "owner": {"reputation": 442, "user_id": 7362458, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K8V4G.jpg?s=128&g=1", "display_name": "gatis paeglis", "link": "https://stackoverflow.com/users/7362458/gatis-paeglis"}, "is_accepted": false, "score": 0, "last_activity_date": 1515532364, "creation_date": 1515532364, "answer_id": 48176714, "question_id": 38093372, "link": "https://stackoverflow.com/questions/38093372/xsendevent-does-not-change-modifier-key-state/48176714#48176714", "title": "XSendEvent does not change modifier key state", "body": "<p>From xsendevent man pages:</p>\n\n<p>\"The contents of the event are otherwise unaltered and unchecked by the X server except except to force send_event to True in the forwarded event and to set the serial number in the event correctly.\"</p>\n\n<p>I assume that you copied createKeyEvent() from the following place: <a href=\"http://www.doctort.org/adam/nerd-notes/x11-fake-keypress-event.html\" rel=\"nofollow noreferrer\">http://www.doctort.org/adam/nerd-notes/x11-fake-keypress-event.html</a></p>\n\n<p>And if you also copied the way this function is called:</p>\n\n<p>createKeyEvent(display, winFocus, winRoot, false, KEYCODE, 0);</p>\n\n<p>then it makes sense that \"modifier\" is not set to anything, as the last argument is \"0\". According to documentation you need to set the modifier state yourself.</p>\n\n<p>I did not verify this information. If it does not work as documented, that it might be a documentation bug or a bug in X server's implementation. </p>\n"}], "owner": {"reputation": 141, "user_id": 903819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/706f3d724e72364775cfd239f34b26c3?s=128&d=identicon&r=PG", "display_name": "Walter Berggren", "link": "https://stackoverflow.com/users/903819/walter-berggren"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 477, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1515532364, "creation_date": 1467186377, "last_edit_date": 1467205021, "question_id": 38093372, "link": "https://stackoverflow.com/questions/38093372/xsendevent-does-not-change-modifier-key-state", "title": "XSendEvent does not change modifier key state", "body": "<p>I'm trying to send key events by creating a XKeyEvent and sending it using XSendEvent (inspired by <a href=\"http://www.doctort.org/adam/nerd-notes/x11-fake-keypress-event.html\" rel=\"nofollow\" title=\"this\">this</a> post). The XKeyEvents are prepared as follows:</p>\n\n<pre><code>XKeyEvent createKeyEvent(Display *display, Window win, Window winRoot, _Bool press, int keycode, int modifiers) {\n    XKeyEvent event;\n\n    event.display     = display;\n    event.window      = win;\n    event.root        = winRoot;\n    event.subwindow   = None;\n    event.time        = CurrentTime;\n    event.x           = 1;\n    event.y           = 1;\n    event.x_root      = 1;\n    event.y_root      = 1;\n    event.same_screen = True;\n    event.keycode     = keycode;\n    event.state       = modifiers;\n\n    if (press) {\n        event.type = KeyPress;\n    } else {\n        event.type = KeyRelease;\n    }\n\n    return event;\n}\n</code></pre>\n\n<p>Then they are sent with <code>XSendEvent(event.display, event.window, 1, KeyPressMask, (XEvent *)&amp;event);</code></p>\n\n<p>The key events are sent and the target program receives them (letters are entered, arrow keys work etc.). However, problems arise with modifier keys. Let's say the program sends a key-down event for the opt/alt key. In this scenario, the text in the menu bar is underlined until a key-up event is sent (indicating that the X-server has received and processed the key-down event).</p>\n\n<p>However, when retrieving the the current state of the modifier keys, the modifier keys do not appear to be pressed at all. When calling <code>XQueryPointer(self-&gt;display, winFocus, &amp;root_return, &amp;child_return, &amp;root_x_return, &amp;root_y_return, &amp;win_x_return, &amp;win_y_return, &amp;keyboard_state_mask);</code>, the keyboard_state_mask is 0. Checking the keyboard with <code>xev</code> gives the same result. Physically pressing the modifier keys does change the state mask, both in <code>xev</code> and in my code.</p>\n\n<p>How do I properly change the current modifier-key state? </p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 2, "creation_date": 1467186142, "post_id": 38093275, "comment_id": 63621690, "body": "<code>if(n&lt;=0);</code> &lt;== lose the semi-colon. I have no idea what you hope <code>(n&gt;=1 &amp;&amp; n&lt;=17);</code> is accomplishing. <a href=\"https://stackoverflow.com/questions/562303/the-definitive-c-book-guide-and-list?s=1|5.9428\">Perhaps a good book on the C language</a> may be helpful."}, {"owner": {"reputation": 11, "user_id": 6527119, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b52524a4ea1895f8b9223799e352be2f?s=128&d=identicon&r=PG&f=1", "display_name": "NeoArcadia", "link": "https://stackoverflow.com/users/6527119/neoarcadia"}, "reply_to_user": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1467186737, "post_id": 38093275, "comment_id": 63622042, "body": "Thank you for the suggestion! I&#39;m trying to make a code for an age gate (eligibility to vote)  the (n&gt;=1 &amp;&amp; n&lt;=17); is to show the message (&quot;you&#39;re too young! you&#39;re not qualified!&quot;) when someone inputted ages 1 - 17.   Unless I coded it wrong though, which is likely.  Thank you! :)"}, {"owner": {"reputation": 1884, "user_id": 3078414, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b1180f5e68d3542488d66de14ff53964?s=128&d=identicon&r=PG&f=1", "display_name": "user3078414", "link": "https://stackoverflow.com/users/3078414/user3078414"}, "edited": false, "score": 0, "creation_date": 1467188479, "post_id": 38093275, "comment_id": 63623152, "body": "Please, bear in mind that &#39;semicolon&#39; (<code>;</code>) can also be interpreted as an <i>empty statement</i> ( if <code>n</code> is less or equal <code>0</code>, fine, we&#39;re done with condition checking ), so your <code>else</code> is left without its <code>if</code> that it depends on.   <code>else</code> without <code>if</code> doesn&#39;t exist in a valid C statement. (-:"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 6527119, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b52524a4ea1895f8b9223799e352be2f?s=128&d=identicon&r=PG&f=1", "display_name": "NeoArcadia", "link": "https://stackoverflow.com/users/6527119/neoarcadia"}, "edited": false, "score": 0, "creation_date": 1467186445, "post_id": 38093309, "comment_id": 63621875, "body": "It worked! I removed the semicolon, thanks to your answer. So, there should always be no semicolon on &quot;if&quot; statements?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 11, "user_id": 6527119, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b52524a4ea1895f8b9223799e352be2f?s=128&d=identicon&r=PG&f=1", "display_name": "NeoArcadia", "link": "https://stackoverflow.com/users/6527119/neoarcadia"}, "edited": false, "score": 0, "creation_date": 1467186706, "post_id": 38093309, "comment_id": 63622025, "body": "@NeoArcadia Not after the condition no."}, {"owner": {"reputation": 11, "user_id": 6527119, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b52524a4ea1895f8b9223799e352be2f?s=128&d=identicon&r=PG&f=1", "display_name": "NeoArcadia", "link": "https://stackoverflow.com/users/6527119/neoarcadia"}, "edited": false, "score": 0, "creation_date": 1467186977, "post_id": 38093309, "comment_id": 63622186, "body": "Alright, I&#39;ll keep that in mind. Thank you kind sir ! :)"}], "tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": false, "score": 1, "last_activity_date": 1467186208, "creation_date": 1467186208, "answer_id": 38093309, "question_id": 38093275, "link": "https://stackoverflow.com/questions/38093275/how-to-fix-line-15-error-expected-expression-before-else/38093309#38093309", "title": "How to fix Line 15: error: expected expression before &#39;else&#39;", "body": "<p>When you do e.g.</p>\n\n<pre><code>if(n&lt;=0);\n</code></pre>\n\n<p>you have a single <code>if</code> statement that does <em>nothing</em>. And then the <code>else</code> is a stray keyword out of context. </p>\n\n<p>The format of an <code>if</code> statement is</p>\n\n<pre><code>if (condition) statement\n</code></pre>\n\n<p>or</p>\n\n<pre><code>if (condition) statement else statement\n</code></pre>\n\n<p>Note that there is no semicolon after the condition, instead it's part of <code>statement</code>.</p>\n\n<p>In your case with <code>if(n&lt;=0);</code> the semicolon at the end is the <code>statement</code>, an empty statement.</p>\n"}, {"tags": [], "owner": {"reputation": 11494, "user_id": 1795279, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/4TEag.jpg?s=128&g=1", "display_name": "Haris", "link": "https://stackoverflow.com/users/1795279/haris"}, "is_accepted": false, "score": 0, "last_activity_date": 1467186338, "creation_date": 1467186338, "answer_id": 38093357, "question_id": 38093275, "link": "https://stackoverflow.com/questions/38093275/how-to-fix-line-15-error-expected-expression-before-else/38093357#38093357", "title": "How to fix Line 15: error: expected expression before &#39;else&#39;", "body": "<p>To clear things out some more, your <code>if</code> statement would look something like this</p>\n\n<pre><code>if(n&lt;=0)\n    ;\n</code></pre>\n\n<p>That is an <code>if</code> with a blank line after that, hence nothing gets executed.</p>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 6527119, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b52524a4ea1895f8b9223799e352be2f?s=128&d=identicon&r=PG&f=1", "display_name": "NeoArcadia", "link": "https://stackoverflow.com/users/6527119/neoarcadia"}, "edited": false, "score": 0, "creation_date": 1467186555, "post_id": 38093408, "comment_id": 63621951, "body": "Question, what does /* */ mean? Thank you! :)"}, {"owner": {"reputation": 1916, "user_id": 5037341, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/ckryF.gif?s=128&g=1", "display_name": "Destrif", "link": "https://stackoverflow.com/users/5037341/destrif"}, "reply_to_user": {"reputation": 11, "user_id": 6527119, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b52524a4ea1895f8b9223799e352be2f?s=128&d=identicon&r=PG&f=1", "display_name": "NeoArcadia", "link": "https://stackoverflow.com/users/6527119/neoarcadia"}, "edited": false, "score": 0, "creation_date": 1467186609, "post_id": 38093408, "comment_id": 63621974, "body": "It is used to add comment in the code. It will not be compiled and not executed. /* */ or begin line like //"}, {"owner": {"reputation": 4677, "user_id": 519348, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/TIdre.jpg?s=128&g=1", "display_name": "TZHX", "link": "https://stackoverflow.com/users/519348/tzhx"}, "edited": false, "score": 0, "creation_date": 1467186715, "post_id": 38093408, "comment_id": 63622029, "body": "It seems more likely they want it to be an else if condition, then a statement that does nothing."}], "tags": [], "owner": {"reputation": 1916, "user_id": 5037341, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/ckryF.gif?s=128&g=1", "display_name": "Destrif", "link": "https://stackoverflow.com/users/5037341/destrif"}, "is_accepted": false, "score": 0, "last_activity_date": 1467186458, "creation_date": 1467186458, "answer_id": 38093408, "question_id": 38093275, "link": "https://stackoverflow.com/questions/38093275/how-to-fix-line-15-error-expected-expression-before-else/38093408#38093408", "title": "How to fix Line 15: error: expected expression before &#39;else&#39;", "body": "<pre><code>    #include&lt;stdio.h&gt;\n\n    int n;\n    main()\n    {\n        printf(\"Enter your age for qualification:\");\n        scanf(\"%d\",&amp;n);\n\n      if (n&gt;=0 &amp;&amp; n&lt;=100)\n      {\n        if (n&lt;=0)\n        {\n            printf(\"you're still in your mother's womb!\");\n        }\n        else\n        {\n            /*(n&gt;=1 &amp;&amp; n&lt;=17);*/\n            printf(\"you're too young! you're not qualified!\");\n        }\n        if(n&gt;=18 &amp;&amp; n&lt;=100)\n        {\n            printf(\"you're qualified to vote\");\n        }\n        else\n        {\n             /*(n&gt;=121);*/\n             printf(\"that's impossible! you're already dead!\");\n        }\n      }\n\n      return 0;  \n    }\n</code></pre>\n\n<p>What your code should looks like, for example</p>\n"}], "owner": {"reputation": 11, "user_id": 6527119, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b52524a4ea1895f8b9223799e352be2f?s=128&d=identicon&r=PG&f=1", "display_name": "NeoArcadia", "link": "https://stackoverflow.com/users/6527119/neoarcadia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 158, "favorite_count": 0, "answer_count": 3, "score": -1, "last_activity_date": 1467186827, "creation_date": 1467186082, "last_edit_date": 1467186827, "question_id": 38093275, "link": "https://stackoverflow.com/questions/38093275/how-to-fix-line-15-error-expected-expression-before-else", "title": "How to fix Line 15: error: expected expression before &#39;else&#39;", "body": "<p>I'm new to C language and would like to ask help on how to fix the said error on Line 15: error: expected expression before 'else'.</p>\n\n<p>Thank You!</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n\nint n;\n\nmain()\n{\n    printf(\"Enter your age for qualification:\");\n    scanf(\"%d\", &amp;n);\n\n    if (n &gt;= 0 &amp;&amp; n &lt;= 100);\n    {\n        if (n &lt;= 0);\n        {\n            printf(\"you're still in your mother's womb!\");\n        }\n        else\n        {\n            (n &gt;= 1 &amp;&amp; n &lt;= 17);\n            printf(\"you're too young! you're not qualified!\");\n        }\n        if (n &gt;= 18 &amp;&amp; n &lt;= 100) {\n            printf(\"you're qualified to vote\");\n        } else {\n            (n &gt;= 121);\n            printf(\"that's impossible! you're already dead!\");\n        }\n    }\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "gtk3"], "comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1467186570, "post_id": 38092558, "comment_id": 63621961, "body": "If I understand the issue, you have an external keypad that you are using for input in your GTK app and need a <code>tab</code> key. This is probably a case where you will need to write a custom input handler that will translate whatever key you are pressing on the keypad into a <code>tab</code> or other key capable of moving the focus around your form. You can search <i>gtk custom input key handler</i> and turn up a number of examples for both gtk2 and gtk3."}, {"owner": {"reputation": 23, "user_id": 4977555, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh5.googleusercontent.com/-I7nbXCGbaDw/AAAAAAAAAAI/AAAAAAAABbc/ej7-AlhEb-k/photo.jpg?sz=128", "display_name": "Mohammadreza Rezaei", "link": "https://stackoverflow.com/users/4977555/mohammadreza-rezaei"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1467187365, "post_id": 38092558, "comment_id": 63622435, "body": "@DavidC.Rankin I already handled all the keys I need somehow. the only thing not working is just this tab key, and I guess there are better and quicker ways to do what I want."}], "answers": [{"tags": [], "owner": {"reputation": 101, "user_id": 8052613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7b8e56a342f31b4e128f425c3a9abf3?s=128&d=identicon&r=PG&f=1", "display_name": "M.Shah", "link": "https://stackoverflow.com/users/8052613/m-shah"}, "is_accepted": false, "score": 2, "last_activity_date": 1499183773, "creation_date": 1499183773, "answer_id": 44910158, "question_id": 38092558, "link": "https://stackoverflow.com/questions/38092558/gtk-c-simulating-tab-key-from-code/44910158#44910158", "title": "gtk+ c simulating tab key from code", "body": "<p>make sure that GtkWindow is TOP LEVEL type , because for top level window you can access widgets within that window using keyboard TAB key without doing any addition in code for using TAB.\nPost your code for more accurate solution.</p>\n"}], "owner": {"reputation": 23, "user_id": 4977555, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh5.googleusercontent.com/-I7nbXCGbaDw/AAAAAAAAAAI/AAAAAAAABbc/ej7-AlhEb-k/photo.jpg?sz=128", "display_name": "Mohammadreza Rezaei", "link": "https://stackoverflow.com/users/4977555/mohammadreza-rezaei"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 235, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1499183773, "creation_date": 1467183826, "last_edit_date": 1467184336, "question_id": 38092558, "link": "https://stackoverflow.com/questions/38092558/gtk-c-simulating-tab-key-from-code", "title": "gtk+ c simulating tab key from code", "body": "<p>I'm trying to build a Gtk C GUI application and I can't use the mouse or keyboard for it. My input device is an external keypad connected to the application with serial port.</p>\n\n<p>My problem is that I want to switch between some GtkButtons in my form when a key on my keypad is pressed (like when using the <kbd>Tab</kbd> key in a GUI applications).</p>\n\n<p>Here's what I tried so far:</p>\n\n<pre><code>      GTK_WIDGET_GET_CLASS(widget)-&gt;move_focus(widget,GTK_DIR_TAB_FORWARD);\n</code></pre>\n\n<p>But the problem is that the focus is not visible until I actually press the <kbd>Tab</kbd> key on my keyboard. When I run the application, it seems as if nothing is happening, but when I press <kbd>Tab</kbd> once, I see that focus is changing.</p>\n\n<p>What am I doing wrong?</p>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1467184361, "post_id": 38092539, "comment_id": 63620560, "body": "<code>{&#39;\\0&#39;}</code> is not a valid expression in C. You probably want <code>g_device-&gt;name1[0] = &#39;\\0&#39;;</code> (note, place <code>&#39;\\0&#39;</code> in the beginning)."}], "answers": [{"tags": [], "owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "is_accepted": true, "score": 3, "last_activity_date": 1467185428, "last_edit_date": 1467185428, "creation_date": 1467184210, "answer_id": 38092681, "question_id": 38092539, "link": "https://stackoverflow.com/questions/38092539/char-array-error-expected-an-expression-error/38092681#38092681", "title": "Char array error, expected an expression, error", "body": "<p>You cannot assign arrays in C, plus the types don't match anyway, <code>g_device-&gt;name1[NAME_LENGTH-1]</code> is a <code>char</code> and  <code>{'\\0'}</code> is a <code>char[1]</code>.</p>\n\n<p>Use strcpy:</p>\n\n<pre><code>strcpy( g_device-&gt;name1 , \"\" );\n</code></pre>\n\n<p>or manually terminate the array:</p>\n\n<pre><code>g_device-&gt;name1[0] = '\\0';\n</code></pre>\n\n<p>Notice that you should set the first character to 0, not the last.</p>\n\n<p>The above two examples will of course leave other elements uninitialized, so if you wanted to initialized them to 0, use memset or a loop:</p>\n\n<pre><code>memset( g_device-&gt;name , '\\0' , NAME_LENGTH * sizeof( char ) );\n</code></pre>\n\n<p>or:</p>\n\n<pre><code>for( size_t index = 0 ; index &lt; NAME_LENGTH * sizeof( *g_device-&gt;name ) ; index++ )\n{\n    g_device-&gt;name[index] = '\\0';\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 12533, "user_id": 931027, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lWhaB.jpg?s=128&g=1", "display_name": "Kusalananda", "link": "https://stackoverflow.com/users/931027/kusalananda"}, "edited": false, "score": 1, "creation_date": 1467184733, "post_id": 38092830, "comment_id": 63620796, "body": "Zeroes, not <code>NULL</code>. And the zeroes are interpreted like <code>nul</code> (<code>\\0</code>). (nitpick)"}, {"owner": {"reputation": 1022, "user_id": 1862728, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f11fb8c2aa0e5f1a476b0cb2a5311d59?s=128&d=identicon&r=PG", "display_name": "sb9", "link": "https://stackoverflow.com/users/1862728/sb9"}, "reply_to_user": {"reputation": 12533, "user_id": 931027, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lWhaB.jpg?s=128&g=1", "display_name": "Kusalananda", "link": "https://stackoverflow.com/users/931027/kusalananda"}, "edited": false, "score": 0, "creation_date": 1467185057, "post_id": 38092830, "comment_id": 63621004, "body": "You&#39;re right, my answer was imprecise at this point. I adapted the answer"}], "tags": [], "owner": {"reputation": 1022, "user_id": 1862728, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f11fb8c2aa0e5f1a476b0cb2a5311d59?s=128&d=identicon&r=PG", "display_name": "sb9", "link": "https://stackoverflow.com/users/1862728/sb9"}, "is_accepted": false, "score": 0, "last_activity_date": 1467184971, "last_edit_date": 1467184971, "creation_date": 1467184632, "answer_id": 38092830, "question_id": 38092539, "link": "https://stackoverflow.com/questions/38092539/char-array-error-expected-an-expression-error/38092830#38092830", "title": "Char array error, expected an expression, error", "body": "<p>You can also use calloc to allocate the buffer, i.e.</p>\n\n<pre><code>g_device = calloc(1, sizeof(device_t));\n</code></pre>\n\n<p>This will allocate a buffer, which is completly filled with Zeroes, i.e. there's no need for further initialization of the character array.</p>\n"}], "owner": {"reputation": 2335, "user_id": 963182, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/82b8397cc8b711c38b1f1a4dee765af9?s=128&d=identicon&r=PG", "display_name": "Invictus", "link": "https://stackoverflow.com/users/963182/invictus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 466, "favorite_count": 1, "accepted_answer_id": 38092681, "answer_count": 2, "score": 1, "last_activity_date": 1467185428, "creation_date": 1467183775, "last_edit_date": 1467184337, "question_id": 38092539, "link": "https://stackoverflow.com/questions/38092539/char-array-error-expected-an-expression-error", "title": "Char array error, expected an expression, error", "body": "<p>I have the following code,  I want to initialize the char array to NULL.</p>\n\n<p>getting the following error</p>\n\n<p><strong>error: \nexpected an expression\ng_device->name1[NAME_LENGTH-1] = {'\\0'};</strong></p>\n\n<pre><code>typedef struct device_ {\n\n    uint32_t id;\n    char name1[NAME_LENGTH];\n    char name2[NAME_LENGTH];\n\n} device_t;\n\ndevice_t  *g_device = NULL;\n\n\nvoid init_device(void)\n{\n\n    g_device = malloc(sizeof(device_t));\n    g_device-&gt;id = 0;\n    g_device-&gt;name1[NAME_LENGTH-1] = {'\\0'};\n    g_device-&gt;name2[NAME_LENGTH-1] = {'\\0'};\n}\n</code></pre>\n"}, {"tags": ["c", "winapi", "dialog", "childwindow", "createwindow"], "comments": [{"owner": {"reputation": 33827, "user_id": 506413, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1a474f3be606bcc6f964913b523626e9?s=128&d=identicon&r=PG", "display_name": "Jonathan Potter", "link": "https://stackoverflow.com/users/506413/jonathan-potter"}, "edited": false, "score": 1, "creation_date": 1467183527, "post_id": 38092129, "comment_id": 63620078, "body": "<code>IsDialogMessage</code> needs to be passed the <code>HWND</code> of the candidate dialog, not the window the message is targeted at."}, {"owner": {"reputation": 30593, "user_id": 27491, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/48cc12ad73f816bc5b115a9ca6965328?s=128&d=identicon&r=PG", "display_name": "Chris Becke", "link": "https://stackoverflow.com/users/27491/chris-becke"}, "edited": false, "score": 0, "creation_date": 1467183755, "post_id": 38092129, "comment_id": 63620204, "body": "Well, it should be given the <code>HWND</code> of the window that has the <code>WS_EX_CONTROLPARENT</code> style, and which is the parent of the other dialogs."}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 2, "creation_date": 1467186230, "post_id": 38092129, "comment_id": 63621738, "body": "On creation you need to manually set the input focus, otherwise keyboard navigation won&#39;t work. I&#39;m not entirely convinced that this can be made to work reliably. Why aren&#39;t you creating regular windows instead?"}, {"owner": {"reputation": 2622, "user_id": 575491, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/HplcM.png?s=128&g=1", "display_name": "bkausbk", "link": "https://stackoverflow.com/users/575491/bkausbk"}, "reply_to_user": {"reputation": 33827, "user_id": 506413, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1a474f3be606bcc6f964913b523626e9?s=128&d=identicon&r=PG", "display_name": "Jonathan Potter", "link": "https://stackoverflow.com/users/506413/jonathan-potter"}, "edited": false, "score": 0, "creation_date": 1467187293, "post_id": 38092129, "comment_id": 63622394, "body": "@JonathanPotter It also didn&#39;t work. I tested both, IsDialogMessage was only called for the container window, and I tested also to call it for the dialog windows. Both didn&#39;t work."}, {"owner": {"reputation": 10424, "user_id": 3408572, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0f3a08b145553b98749d3d0572d01265?s=128&d=identicon&r=PG&f=1", "display_name": "andlabs", "link": "https://stackoverflow.com/users/3408572/andlabs"}, "edited": false, "score": 0, "creation_date": 1467210657, "post_id": 38092129, "comment_id": 63639084, "body": "Shot in the dark: do the dialogs have <code>WS_EX_CONTROLPARENT</code> too?"}, {"owner": {"reputation": 2622, "user_id": 575491, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/HplcM.png?s=128&g=1", "display_name": "bkausbk", "link": "https://stackoverflow.com/users/575491/bkausbk"}, "edited": false, "score": 0, "creation_date": 1467210794, "post_id": 38092129, "comment_id": 63639183, "body": "Yes I also tried to add this <code>WS_EX_CONTROLPARENT</code> style to dialog windows, without any changes in the described behavior."}, {"owner": {"reputation": 10424, "user_id": 3408572, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0f3a08b145553b98749d3d0572d01265?s=128&d=identicon&r=PG&f=1", "display_name": "andlabs", "link": "https://stackoverflow.com/users/3408572/andlabs"}, "edited": false, "score": 1, "creation_date": 1467218560, "post_id": 38092129, "comment_id": 63644648, "body": "Er oh, your <code>IsDialogMessage()</code> call is still wrong. You don&#39;t want to call <code>IsDialogMessage()</code> only when the message is sent to the dialog. You want to call it for <b>all</b> messages, passing the HWND of the topmost window that contains the sub-dialogs \u2014 in your case, of the Win32AppDemo1 window."}, {"owner": {"reputation": 10424, "user_id": 3408572, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0f3a08b145553b98749d3d0572d01265?s=128&d=identicon&r=PG&f=1", "display_name": "andlabs", "link": "https://stackoverflow.com/users/3408572/andlabs"}, "edited": false, "score": 0, "creation_date": 1467218671, "post_id": 38092129, "comment_id": 63644696, "body": "(Also <a href=\"https://blogs.msdn.microsoft.com/oldnewthing/20050408-41/?p=35943\" rel=\"nofollow noreferrer\"><code>TranslateAccelerator()</code> goes before <code>IsDialogMessage()</code></a>.)"}, {"owner": {"reputation": 2622, "user_id": 575491, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/HplcM.png?s=128&g=1", "display_name": "bkausbk", "link": "https://stackoverflow.com/users/575491/bkausbk"}, "reply_to_user": {"reputation": 10424, "user_id": 3408572, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0f3a08b145553b98749d3d0572d01265?s=128&d=identicon&r=PG&f=1", "display_name": "andlabs", "link": "https://stackoverflow.com/users/3408572/andlabs"}, "edited": false, "score": 0, "creation_date": 1467268990, "post_id": 38092129, "comment_id": 63664180, "body": "@andlabs Thanks a lot, passing the top level window really worked. So I&#39;m a bit confused now since in the www almost all information about how to call this <code>IsDialogMessage</code> seems to be wrong."}, {"owner": {"reputation": 10424, "user_id": 3408572, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0f3a08b145553b98749d3d0572d01265?s=128&d=identicon&r=PG&f=1", "display_name": "andlabs", "link": "https://stackoverflow.com/users/3408572/andlabs"}, "edited": false, "score": 0, "creation_date": 1467292771, "post_id": 38092129, "comment_id": 63679868, "body": "Can you link the references you&#39;ve found? I&#39;d like to see them as well."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user13947011"}, "edited": false, "score": 0, "creation_date": 1610196891, "post_id": 38248708, "comment_id": 116058893, "body": "Precisely, which window handles in this example should have <code>WS_EX_CONTROLPARENT</code> extended style? I tried setting it for every window, yet it doesn&#39;t recurse."}], "tags": [], "owner": {"reputation": 10424, "user_id": 3408572, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0f3a08b145553b98749d3d0572d01265?s=128&d=identicon&r=PG&f=1", "display_name": "andlabs", "link": "https://stackoverflow.com/users/3408572/andlabs"}, "is_accepted": true, "score": 2, "last_activity_date": 1467903246, "creation_date": 1467903246, "answer_id": 38248708, "question_id": 38092129, "link": "https://stackoverflow.com/questions/38092129/embedding-modeless-dialogs-as-child-window-with-windows-api/38248708#38248708", "title": "Embedding modeless dialogs as child window with Windows API", "body": "<p>You are not using <code>IsDialogMessage()</code> correctly, and you said you learned from some bad tutorials. I don't know which tutorials you saw, so I can't tell you what they got wrong; all I can do is say how to use it correctly.</p>\n\n<p><code>IsDialogMessage()</code> takes two parameters: the message itself, and the window handle of the <strong>toplevel window</strong>. This bit in bold is the important part: the <code>IsDialogMessage()</code> function needs to know which dialog to work with in the event of tab navigation or Enter/Esc handling.</p>\n\n<p>You don't want to pass <code>msg.hwnd</code>; that's the control itself.</p>\n\n<p>And in the case of nested child dialogs like you have here, you don't want to pass in the child dialog's handle; that would confine <code>IsDialogMessage()</code> to that dialog.</p>\n\n<p>So in your screenshot, you want to pass in the handle of the main window, that is, the window called <code>Win32ApiDemo1</code>.</p>\n\n<p>Also make sure all the child dialogs and your custom expander control have <code>WS_EX_CONTROLPARENT</code> so tab navigation can recurse.</p>\n"}], "owner": {"reputation": 2622, "user_id": 575491, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/HplcM.png?s=128&g=1", "display_name": "bkausbk", "link": "https://stackoverflow.com/users/575491/bkausbk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 833, "favorite_count": 1, "accepted_answer_id": 38248708, "answer_count": 1, "score": 1, "last_activity_date": 1467963363, "creation_date": 1467182518, "last_edit_date": 1467963363, "question_id": 38092129, "link": "https://stackoverflow.com/questions/38092129/embedding-modeless-dialogs-as-child-window-with-windows-api", "title": "Embedding modeless dialogs as child window with Windows API", "body": "<p>I know, there must be a way to embed an (modeless) dialog as child of a window created with <code>CreateWindow</code>. In my case I want to embed them into an scroll-able container window, whereby this container windows it self is a child of the main window (see picture).</p>\n\n<p><a href=\"https://i.stack.imgur.com/qHUdP.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qHUdP.png\" alt=\"Embedded Dialogs\"></a></p>\n\n<p>The first problem that I encounter is, that I still want be able to use TAB keys and other dialog specific navigation. But how?</p>\n\n<p>My message loop:</p>\n\n<pre><code>while (GetMessage(&amp;msg, NULL, 0, 0)) {\n    if (IsDialogMessage(msg.hwnd, &amp;msg)) continue;\n    if (!TranslateAccelerator(msg.hwnd, hAccelTable, &amp;msg)) {\n        TranslateMessage(&amp;msg);\n        DispatchMessage(&amp;msg);\n    }\n}\n</code></pre>\n\n<p><strong>Edit:</strong> For testing purpose I modified the loop:</p>\n\n<pre><code>while (GetMessage(&amp;msg, NULL, 0, 0)) {\n    if (IsEmbeddedDialogWindow(msg.hwnd)) {\n        if (IsDialogMessage(msg.hwnd, &amp;msg)) continue;\n    }\n    if (!TranslateAccelerator(msg.hwnd, hAccelTable, &amp;msg)) {\n        TranslateMessage(&amp;msg);\n        DispatchMessage(&amp;msg);\n    }\n}\n\nwhile (GetMessage(&amp;msg, NULL, 0, 0)) {\n    if (IsScrollableContainerWindow(msg.hwnd)) {\n        if (IsDialogMessage(msg.hwnd, &amp;msg)) continue;\n    }\n    if (!TranslateAccelerator(msg.hwnd, hAccelTable, &amp;msg)) {\n        TranslateMessage(&amp;msg);\n        DispatchMessage(&amp;msg);\n    }\n}\n</code></pre>\n\n<p>More information how to make it the right way can be found here: <a href=\"https://blogs.msdn.microsoft.com/oldnewthing/20131009-00/?p=2983\" rel=\"nofollow noreferrer\">Using the TAB key to navigate in non-dialogs, redux</a></p>\n\n<p>With this message loop, nothing happens if I want to enter some dialog texts as if the message is not handled. If <code>IsDialogMessage</code> is removed, I can enter some text into an edit control in one of the embedded dialogs, however dialog navigation doesn't work as intended. Of course, <code>WS_TABSTOP</code> style is set for dialog child controls.</p>\n\n<p>The scroll-able container is created with <code>CreateWindowEx</code> with styles \n<code>WS_CHILD, WS_VISIBLE, WS_VSCROLL, WS_TABSTOP, WS_EX_CONTROLPARENT</code> and dialogs are created as children of this container.</p>\n\n<pre><code>    HWND hWndContainer = GroupBarPanelCreate(WS_CHILD | WS_VISIBLE | WS_VSCROLL | WS_TABSTOP, WS_EX_CONTROLPARENT, hWndMain, 0, 0, 400, 400);\n    GROUPBAR_PANEL* GroupBarPanel = (GROUPBAR_PANEL*) GetWindowLongPtr(hWndContainer, 0);\n    // Test embedding dialogs\n    for (unsigned int i = 0; i &lt; 10; i++) {\n        HWND hWndDlg = CreateDialogParam(hInst, MAKEINTRESOURCE(IDD_ABOUTBOX), hWndContainer, About, 0);\n        GroupBarPanelInternalAddLast(GroupBarPanel, hWndChild, hWndDlg, nullptr);\n    }\n</code></pre>\n\n<p>My <code>GroupBarPanelInternalAddLast</code> modify modeless dialog styles by removing caption and borders, and ensures that <code>WS_CHILD</code>, <code>WS_VISIBLE</code> and <code>WS_TABSTOP</code> is set (<code>SetWindowLong(hWndDlg, GWL_STYLE, ...)</code>). (Also tested <code>WS_EX_CONTROLPARENT</code> style) With <code>SetParent(hWndDlg, hWndContainer)</code> modeless dialogs parent is changed.</p>\n\n<p><a href=\"https://i.stack.imgur.com/91BYL.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/91BYL.png\" alt=\"Working Demo\"></a></p>\n\n<p>So what am I missing here? As I found out, neither the container window procedure nor the embedded (for testing purpose subclassed) dialog procedure almost never gets <code>WM_SETFOCUS</code> or <code>WM_KILLFOCUS</code> messages for example, but why that?</p>\n\n<p><strong>Solution:</strong> Calling IsDialogMessage for the top level window.</p>\n\n<pre><code>while (GetMessage(&amp;msg, NULL, 0, 0)) {\n    if (!TranslateAccelerator(msg.hwnd, hAccelTable, &amp;msg)) {\n        if (IsDialogMessage(hWndTopLevel, &amp;msg)) {\n            continue;\n        }\n        TranslateMessage(&amp;msg);\n        DispatchMessage(&amp;msg);\n    }\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "pthreads"], "comments": [{"owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 0, "creation_date": 1467181713, "post_id": 38091751, "comment_id": 63619099, "body": "Without using <code>pthread_join</code> the program probably exits before the threads run"}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1467185513, "post_id": 38091751, "comment_id": 63621301, "body": "Looking into your history you got the answer as well with <a href=\"http://stackoverflow.com/questions/38090256/is-pthread-join-a-must-when-using-pthread-in-linux\">your previous question</a>"}], "answers": [{"comments": [{"owner": {"reputation": 484, "user_id": 6490242, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26613036fd92e6ee9e1ce9b64037069d?s=128&d=identicon&r=PG&f=1", "display_name": "Twinkle", "link": "https://stackoverflow.com/users/6490242/twinkle"}, "edited": false, "score": 1, "creation_date": 1467183049, "post_id": 38091872, "comment_id": 63619799, "body": "Also if you call pthread_exit() from main(), it will allow the spawned threads to continue execution, terminating only the main thread.  If you end main with pthread_exit() your are saying explicitly that you want the other threads to continue."}, {"owner": {"reputation": 8978, "user_id": 2223579, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/wQuP6.jpg?s=128&g=1", "display_name": "BlackMamba", "link": "https://stackoverflow.com/users/2223579/blackmamba"}, "edited": false, "score": 0, "creation_date": 1467184356, "post_id": 38091872, "comment_id": 63620558, "body": "when the main thread is killed by <code>pthread_exit</code>, what about the process which own the main thread? is it killed?"}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "reply_to_user": {"reputation": 8978, "user_id": 2223579, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/wQuP6.jpg?s=128&g=1", "display_name": "BlackMamba", "link": "https://stackoverflow.com/users/2223579/blackmamba"}, "edited": false, "score": 0, "creation_date": 1467191577, "post_id": 38091872, "comment_id": 63625182, "body": "@BlackMamba: <code>pthread_exit()</code> does not &quot;kill&quot; a thread, it exits it in a well defined manner."}], "tags": [], "owner": {"reputation": 484, "user_id": 6490242, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26613036fd92e6ee9e1ce9b64037069d?s=128&d=identicon&r=PG&f=1", "display_name": "Twinkle", "link": "https://stackoverflow.com/users/6490242/twinkle"}, "is_accepted": false, "score": 3, "last_activity_date": 1467183390, "last_edit_date": 1467183390, "creation_date": 1467181665, "answer_id": 38091872, "question_id": 38091751, "link": "https://stackoverflow.com/questions/38091751/why-there-is-no-output-for-pthread/38091872#38091872", "title": "why there is no output for `pthread`?", "body": "<p>You need to call <code>pthread_join()</code>or <code>pthread_exit()</code> after <code>pthread_create()</code>, otherwise the <code>main()</code> will return killing the spawned threads as well. So  no output will get print.</p>\n"}, {"comments": [{"owner": {"reputation": 8978, "user_id": 2223579, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/wQuP6.jpg?s=128&g=1", "display_name": "BlackMamba", "link": "https://stackoverflow.com/users/2223579/blackmamba"}, "edited": false, "score": 0, "creation_date": 1467182177, "post_id": 38091895, "comment_id": 63619323, "body": "<a href=\"http://stackoverflow.com/questions/3756882/detached-vs-joinable-posix-threads\" title=\"detached vs joinable posix threads\">stackoverflow.com/questions/3756882/&hellip;</a>, in this link, it says <code>pthread_join</code> is not necessary."}, {"owner": {"reputation": 484, "user_id": 6490242, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26613036fd92e6ee9e1ce9b64037069d?s=128&d=identicon&r=PG&f=1", "display_name": "Twinkle", "link": "https://stackoverflow.com/users/6490242/twinkle"}, "edited": false, "score": 2, "creation_date": 1467182368, "post_id": 38091895, "comment_id": 63619432, "body": "Here it is needed, because when the main() returns the application will close. So it has to wait till the threads complete execution"}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "reply_to_user": {"reputation": 484, "user_id": 6490242, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26613036fd92e6ee9e1ce9b64037069d?s=128&d=identicon&r=PG&f=1", "display_name": "Twinkle", "link": "https://stackoverflow.com/users/6490242/twinkle"}, "edited": false, "score": 0, "creation_date": 1467182672, "post_id": 38091895, "comment_id": 63619583, "body": "As already stated by @Twinkle when the main finish, the application is close and terminates all threads."}, {"owner": {"reputation": 484, "user_id": 6490242, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26613036fd92e6ee9e1ce9b64037069d?s=128&d=identicon&r=PG&f=1", "display_name": "Twinkle", "link": "https://stackoverflow.com/users/6490242/twinkle"}, "edited": false, "score": 1, "creation_date": 1467183003, "post_id": 38091895, "comment_id": 63619771, "body": "Also if you call pthread_exit() from main, it will allow the spawned threads to continue execution, terminating only the main thread.  If you end main with pthread_exit() your are saying explicitly that you want the other threads to continue."}, {"owner": {"reputation": 8978, "user_id": 2223579, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/wQuP6.jpg?s=128&g=1", "display_name": "BlackMamba", "link": "https://stackoverflow.com/users/2223579/blackmamba"}, "reply_to_user": {"reputation": 484, "user_id": 6490242, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26613036fd92e6ee9e1ce9b64037069d?s=128&d=identicon&r=PG&f=1", "display_name": "Twinkle", "link": "https://stackoverflow.com/users/6490242/twinkle"}, "edited": false, "score": 0, "creation_date": 1467183381, "post_id": 38091895, "comment_id": 63619980, "body": "@Twinkle I want to know, which situation is needed, which is not needed? i am very confused."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1467183814, "post_id": 38091895, "comment_id": 63620234, "body": "Basically it is always necessary into the main function that launch the first thread. Could not be necessary if you launch a <code>thread2</code> within another <code>thread1</code> that was launched by main that is blocked by <code>pthread_join(thread1)</code> function."}, {"owner": {"reputation": 484, "user_id": 6490242, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26613036fd92e6ee9e1ce9b64037069d?s=128&d=identicon&r=PG&f=1", "display_name": "Twinkle", "link": "https://stackoverflow.com/users/6490242/twinkle"}, "reply_to_user": {"reputation": 8978, "user_id": 2223579, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/wQuP6.jpg?s=128&g=1", "display_name": "BlackMamba", "link": "https://stackoverflow.com/users/2223579/blackmamba"}, "edited": false, "score": 0, "creation_date": 1467183991, "post_id": 38091895, "comment_id": 63620342, "body": "@BlackMamba. You need either pthread_join() or pthread_exit() for the spawned threads to complete execution. If you are using pthread_exit(), it will terminate the main thread allowing the spawned ones to continue execution. If you use pthread_join(), main thread will wait till the spawned threads complete execution. If you use neither of this entire application will close once the main returns."}], "tags": [], "owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "is_accepted": false, "score": 2, "last_activity_date": 1467184308, "last_edit_date": 1467184308, "creation_date": 1467181742, "answer_id": 38091895, "question_id": 38091751, "link": "https://stackoverflow.com/questions/38091751/why-there-is-no-output-for-pthread/38091895#38091895", "title": "why there is no output for `pthread`?", "body": "<p>You should add <code>pthread_join</code> calls to ensure your <code>main</code> function waits for the other threads to complete:</p>\n\n<pre><code>int main()\n{\n    pthread_t thread1;\n    pthread_t thread2;\n    thread_char_para para1 = {'x', 30000};\n    thread_char_para para2 = {'o', 30000};\n\n    pthread_create(&amp;thread1, NULL, char_print, &amp;para1);\n    pthread_create(&amp;thread2, NULL, char_print, &amp;para2);\n\n    pthread_join(thread1, NULL);  // &lt;--\\ add these\n    pthread_join(thread2, NULL);  // &lt;--/   two lines.\n\n    return 0;\n}\n</code></pre>\n\n<p>To give you an example on when a pthread_join can be avoided take a look at the followin code</p>\n\n<pre><code>#include &lt;pthread.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n\ntypedef struct thread_char_para {\n    char character;\n    int count;\n} thread_char_para;\n\nvoid* char_print (void* parameter)\n{\n    thread_char_para* p = (thread_char_para*)parameter;\n    int i;\n\n    if (p-&gt;character == 'x')\n    {\n        pthread_t thread2;\n        thread_char_para para2 = {'o', 30000};\n        pthread_create(&amp;thread2, NULL, char_print, &amp;para2);\n\n        for (i = 0; i &lt; 5; ++i)\n        {\n            sleep(1);\n        }\n    }\n    else\n    {\n        for (i = 0; i &lt; p-&gt;count; ++i)\n            fputc(p-&gt;character, stderr);\n    }\n    return NULL;\n}\nint main()\n{\n    pthread_t thread1;\n    thread_char_para para1 = {'x', 30000};\n\n    pthread_create(&amp;thread1, NULL, char_print, &amp;para1);\n\n    pthread_join(thread1, NULL);\n\n    return 0;\n}\n</code></pre>\n\n<p>As you can see <code>main</code> launches <code>pthread1</code> and waits for <code>pthread1</code> completion. <code>pthread1</code> starts another <code>thread2</code> an loops for 5 seconds while the <code>pthread2</code> is doing its job. In this case <code>pthread_join</code> is not used. </p>\n"}, {"tags": [], "owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "is_accepted": false, "score": 2, "last_activity_date": 1467182615, "creation_date": 1467182615, "answer_id": 38092151, "question_id": 38091751, "link": "https://stackoverflow.com/questions/38091751/why-there-is-no-output-for-pthread/38092151#38092151", "title": "why there is no output for `pthread`?", "body": "<p>As an alternative to joining the two threads one could treat the <code>main()</code>-thread like any other thread and have it exit using <code>pthread_exit()</code>.</p>\n\n<p>Doing so would prevent the process along with <em>all</em> its threads from being ended the moment <code>main()</code> returns.</p>\n"}, {"tags": [], "owner": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "is_accepted": false, "score": 1, "last_activity_date": 1467188678, "last_edit_date": 1467188678, "creation_date": 1467186542, "answer_id": 38093440, "question_id": 38091751, "link": "https://stackoverflow.com/questions/38091751/why-there-is-no-output-for-pthread/38093440#38093440", "title": "why there is no output for `pthread`?", "body": "<p>Returning from the <code>main</code> function is equivalent to calling <code>exit</code>. It kills the process <em>and all its threads</em>. So your program kills the threads before they have a chance to run. <code>pthread_create</code> doesn't mean that the thread executes inside <code>pthread_create</code>, it means that the thread will execute at some point in the future and the first thing you do after creating the thread is to kill them which makes it more than likely that they haven't gotten any chance to start running yet.</p>\n\n<p>You can solve this in various ways. As others have mentioned you can wait until the threads have finished running with <code>pthread_join</code>, you can have the threads indicate to main that they are done through a pipe, semaphore, barrier, condition variables and dozens of other ways. You just have to make sure that <code>main</code> can't return until the threads are done otherwise you'll most likely just kill them before they had a chance to run.</p>\n\n<p><code>pthread_join</code> is not necessary as the answer you refer to says. It's just the easiest way in your case to wait for the threads to finish running. Strictly speaking, you don't even need to wait for the threads to finish running, you just need them to indicate to the main thread that they are done doing what you want them to do and the threads finishing is the easiest way to know that they have started at all.</p>\n"}], "owner": {"reputation": 8978, "user_id": 2223579, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/wQuP6.jpg?s=128&g=1", "display_name": "BlackMamba", "link": "https://stackoverflow.com/users/2223579/blackmamba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 768, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1467188678, "creation_date": 1467181198, "last_edit_date": 1495539855, "question_id": 38091751, "link": "https://stackoverflow.com/questions/38091751/why-there-is-no-output-for-pthread", "title": "why there is no output for `pthread`?", "body": "<pre><code>#include &lt;pthread.h&gt;\n#include &lt;stdio.h&gt;\n\ntypedef struct thread_char_para {\n    char character;\n    int count;\n} thread_char_para;\n\nvoid* char_print (void* parameter)\n{\n    thread_char_para* p = (thread_char_para*)parameter;\n    int i;\n    for (i = 0; i &lt; p-&gt;count; ++i)\n        fputc(p-&gt;character, stderr);\n    return NULL;\n}\nint main()\n{\n    pthread_t thread1;\n    pthread_t thread2;\n    thread_char_para para1 = {'x', 30000};\n    thread_char_para para2 = {'o', 30000};\n\n    pthread_create(&amp;thread1, NULL, char_print, &amp;para1);\n    pthread_create(&amp;thread2, NULL, char_print, &amp;para2);\n\n    return 0;\n}\n</code></pre>\n\n<p>Why there is no any output?</p>\n\n<p>I alse find some links to read: <a href=\"https://stackoverflow.com/questions/3756882/detached-vs-joinable-posix-threads\">Detached vs. Joinable POSIX threads</a></p>\n\n<p>in this link, it says <code>pthread_join</code> is not necessary. So, i am wondering.</p>\n"}, {"tags": ["c", "string", "obfuscation", "abort"], "comments": [{"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1467296571, "post_id": 38091414, "comment_id": 63682963, "body": "for readability and ease of understanding by us humans: 1) consistently indent the code.  Indent after every opening brace &#39;{&#39;.  Unindent before every closing brace &#39;}&#39;.  2)  separate code blocks (for, if, else, while, do...while, switch, case, default) via a blank line."}], "answers": [{"tags": [], "owner": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "is_accepted": true, "score": 2, "last_activity_date": 1467180237, "last_edit_date": 1495535371, "creation_date": 1467180237, "answer_id": 38091510, "question_id": 38091414, "link": "https://stackoverflow.com/questions/38091414/error-abort-trap-6-string-obfuscation/38091510#38091510", "title": "Error: Abort trap 6 - String obfuscation", "body": "<p>In the <code>readLine_str_test_encrypt</code> you are returning a pointer to variable <code>output</code>. This variable is a local variable and goes out of scope when the function exits.</p>\n\n<p>Change it to </p>\n\n<pre><code>static char output[9];  \n</code></pre>\n\n<p>and the error goes away. </p>\n\n<p>Read more as to why you should not return a local variable <a href=\"https://stackoverflow.com/questions/4824342/returning-a-local-variable-from-function-in-c\">here</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "is_accepted": false, "score": 2, "last_activity_date": 1467302174, "creation_date": 1467302174, "answer_id": 38128110, "question_id": 38091414, "link": "https://stackoverflow.com/questions/38091414/error-abort-trap-6-string-obfuscation/38128110#38128110", "title": "Error: Abort trap 6 - String obfuscation", "body": "<p>the posted code is:</p>\n\n<ol>\n<li>including a header file those contents are not used</li>\n<li>trying to 'sprintf()` a 3 char integer into a single byte</li>\n<li>returning pointers to local variables</li>\n<li>is not terminating the strings to be printed with a NUL byte</li>\n</ol>\n\n<p>Note: <code>size_t</code> is a well known definition for <code>unsigned long int</code></p>\n\n<p>The following suggested code corrects all of the above problems and a few others.</p>\n\n<pre><code>#include &lt;stdio.h&gt;   // printf()\n#include &lt;stdlib.h&gt;  // exit(), EXIT_FAILURE, malloc(), free()\n//#include &lt;math.h&gt;\n#include &lt;string.h&gt;  // strlen()\n\nchar* readLine_str_test_encrypt( char *, size_t );\nchar* readLine_str_test_decrypt( char *, size_t );\n\n\nint main ( void )\n{ //body\n    char string[] = \"readLine\";\n\n    char * encryptedString = readLine_str_test_encrypt( string, strlen(string) );\n    // Note: the encrypted string may not be printable\n    printf(\"%s\\n\", encryptedString );\n\n    char * decryptedString = readLine_str_test_decrypt( encryptedString, strlen(string) );\n    printf( \"%s\\n\", decryptedString );\n\n    free( encryptedString );\n    free( decryptedString );\n} // end function: main\n\n\nchar* readLine_str_test_decrypt( char *encryptedString, size_t length)\n{\n    char *string = NULL;\n\n    if( NULL == ( string = malloc( length +1) ) )\n    {// then malloc failed\n        perror( \"malloc for decrypted string failed\" );\n        exit( EXIT_FAILURE );\n    }\n\n    // implied else, malloc successful\n\n    for ( size_t i=0; encryptedString[i]; ++i )\n    {\n        string[i] = encryptedString[i] ^22;\n    }\n\n    string[length] = '\\0';\n\n    return string;\n} // end function: readLine_str_test_decrypt\n\n\nchar* readLine_str_test_encrypt( char *stringToEncrypt, size_t length )\n{\n    char *output = NULL;\n\n    if( NULL == (output = malloc( length+1 ) ) )\n    { // then, malloc failed\n        perror( \"malloc for work area failed\" );\n        exit( EXIT_FAILURE );\n    }\n\n    // implied else, malloc successful\n\n    for( size_t i=0; stringToEncrypt[i]; ++i)\n    {\n        output[i] = stringToEncrypt[i] ^22;\n    }\n\n    output[length] = '\\0';\n\n    return output;\n} // end function: readLine_str_test_encrypt\n</code></pre>\n\n<p>the output from the above code is:</p>\n\n<pre><code>dswrZxs\nreadLine\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 6507468, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh6.googleusercontent.com/-_4j78H5avfY/AAAAAAAAAAI/AAAAAAAAAyU/5S29-KazpRQ/photo.jpg?sz=128", "display_name": "Mayank Vijh", "link": "https://stackoverflow.com/users/6507468/mayank-vijh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 182, "favorite_count": 0, "accepted_answer_id": 38091510, "answer_count": 2, "score": 0, "last_activity_date": 1486657240, "creation_date": 1467179800, "last_edit_date": 1486657240, "question_id": 38091414, "link": "https://stackoverflow.com/questions/38091414/error-abort-trap-6-string-obfuscation", "title": "Error: Abort trap 6 - String obfuscation", "body": "<p>I am trying to write code for String Obfuscation but it gives me Abort trap: 6 error while running. Any ideas are much appreciated:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\n#include &lt;string.h&gt;\n\nchar* readLine_str_test_encrypt();\nchar* readLine_str_test_decrypt();\n\nint main () { //body \n\nprintf(\"%s\\n\", readLine_str_test_encrypt());\n\nprintf(\"%s\\n\", readLine_str_test_decrypt());\n\n\n}\n\nchar* readLine_str_test_decrypt() {\nstatic unsigned char string[9] = {100, 115, 119, 114, 90, 127, 120, 115, 22};\n\nstatic int i = 0;\n\nfor (; i &lt; 9; ++i) {\n    string[i] ^= 22;\n}\n\nreturn (char*)string;\n}\n\nchar* readLine_str_test_encrypt()\n{\nstatic unsigned char string[9] = \"readLine\";\nchar output[9];\nchar* output_start=output;\nstatic int i =0;\nfor(; i &lt; 9; ++i)\n{\n    //string[i] = string[i]^22;\n    output_start += sprintf(output_start,\"%d\",string[i]^22);\n\n}\n\nreturn output_start;\n}\n</code></pre>\n\n<p>My decrypt function is running successfully.</p>\n"}, {"tags": ["c", "signals", "openmp"], "comments": [{"owner": {"reputation": 3715, "user_id": 1241334, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fCjAE.jpg?s=128&g=1", "display_name": "Jonny Henly", "link": "https://stackoverflow.com/users/1241334/jonny-henly"}, "edited": false, "score": 0, "creation_date": 1467180713, "post_id": 38091388, "comment_id": 63618601, "body": "You&#39;re going about this the wrong way, the number of threads cannot be redefined inside of a parallel section. You need to exit the parallel section, change the number of threads, then re-enter the parallel section using some type of nested loop setup."}, {"owner": {"reputation": 29002, "user_id": 2542702, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fW5ka.jpg?s=128&g=1", "display_name": "Z boson", "link": "https://stackoverflow.com/users/2542702/z-boson"}, "edited": false, "score": 0, "creation_date": 1467181443, "post_id": 38091388, "comment_id": 63618962, "body": "Why do you want to change the number of threads in a parallel region?  You can control which threads in a parallel region do work and the remaining threads idle so I don&#39;t think you need to reduce the number of threads as long as you have enough to start with."}, {"owner": {"reputation": 75, "user_id": 3844734, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4d0acf55549ead53d5ab78d4be62a4c?s=128&d=identicon&r=PG&f=1", "display_name": "Chinnu", "link": "https://stackoverflow.com/users/3844734/chinnu"}, "edited": false, "score": 0, "creation_date": 1467181767, "post_id": 38091388, "comment_id": 63619114, "body": "I have to use such a scenario for one of my projects.For this i am writing a sample application like above.Are there any otherways to control these threads inside a parallel region"}, {"owner": {"reputation": 75, "user_id": 3844734, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4d0acf55549ead53d5ab78d4be62a4c?s=128&d=identicon&r=PG&f=1", "display_name": "Chinnu", "link": "https://stackoverflow.com/users/3844734/chinnu"}, "reply_to_user": {"reputation": 3715, "user_id": 1241334, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fCjAE.jpg?s=128&g=1", "display_name": "Jonny Henly", "link": "https://stackoverflow.com/users/1241334/jonny-henly"}, "edited": false, "score": 0, "creation_date": 1467362214, "post_id": 38091388, "comment_id": 63711511, "body": "@Jonny Henly, how can I exit from parallel section.do u mean to exit from the entire process and restart it again??I have to control threads without interrupting the current execution"}, {"owner": {"reputation": 3715, "user_id": 1241334, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fCjAE.jpg?s=128&g=1", "display_name": "Jonny Henly", "link": "https://stackoverflow.com/users/1241334/jonny-henly"}, "edited": false, "score": 0, "creation_date": 1467879154, "post_id": 38091388, "comment_id": 63902018, "body": "@Chinnu are you still having trouble with this? If so I can post an answer with an example of the scenario I mentioned above."}, {"owner": {"reputation": 75, "user_id": 3844734, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4d0acf55549ead53d5ab78d4be62a4c?s=128&d=identicon&r=PG&f=1", "display_name": "Chinnu", "link": "https://stackoverflow.com/users/3844734/chinnu"}, "reply_to_user": {"reputation": 3715, "user_id": 1241334, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fCjAE.jpg?s=128&g=1", "display_name": "Jonny Henly", "link": "https://stackoverflow.com/users/1241334/jonny-henly"}, "edited": false, "score": 0, "creation_date": 1467881416, "post_id": 38091388, "comment_id": 63903345, "body": "@Jonny Henly.I have trouble with controlling number of  threads at the run time .I read that I can&#39;t change the nu_thread value at run time.But I am need of such a thing.is there any other way to accomplish this.please post your example"}], "owner": {"reputation": 75, "user_id": 3844734, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4d0acf55549ead53d5ab78d4be62a4c?s=128&d=identicon&r=PG&f=1", "display_name": "Chinnu", "link": "https://stackoverflow.com/users/3844734/chinnu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 718, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1467180395, "creation_date": 1467179654, "last_edit_date": 1467180395, "question_id": 38091388, "link": "https://stackoverflow.com/questions/38091388/how-to-dynamically-set-number-of-threads-using-openmp", "title": "How to dynamically set number of threads using OpenMp", "body": "<p>I am trying to control running threads using OpenMp. What I need is to set number of running threads according to certain condition. I am using signal handler to control the thread. I have written the following code:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;signal.h&gt;\n#include&lt;unistd.h&gt;\n#include&lt;omp.h&gt;\n\nint i;\nint num_threads = 4;\n\nvoid sig_handler(int signo) {\n  if (signo == SIGUSR1) {\n    printf(\"\\n receivd signal\\n\");\n    omp_set_num_threads(2);\n  } else if (signo == SIGKILL)\n    printf(\"received SIGKILL\\n\");\n  else if (signo == SIGSTOP)\n    printf(\"received SIGSTOP\\n\");\n}\n\nint main(void) {\n  i = 0;\n\n  if (signal(SIGUSR1, sig_handler) == SIG_ERR)\n    printf(\"\\ncan't catch SIGUSR1\\n\");\n\n  if (signal(SIGKILL, sig_handler) == SIG_ERR)\n    printf(\"\\ncan't catch SIGKILL\\n\");\n\n  if (signal(SIGSTOP, sig_handler) == SIG_ERR)\n    printf(\"\\ncan't catch SIGSTOP\\n\");\n\n  omp_set_num_threads(num_threads);\n\n  #pragma omp parallel \n  while(1) {\n    i++;\n    printf(\"OPENMP USING SIGHANDLER::%d\\n\",i);\n    sleep(1);\n  }\n  return 0;\n}\n</code></pre>\n\n<p>Here I compiled the code with <code>gcc filename.c -o file -fopenmp</code>. Since I set 4 threads initially I can see 4 threads running. Then during runtime I raise a signal using <code>kill -USR1 process_id</code> .Here my program received the signal,after that I have to change number of threads from 4 to 2.But this time I am getting initial 4 threads .I cant change or control the threads inside <code>omp_parallel</code> construct. Please suggest a solution.</p>\n"}, {"tags": ["c", "string", "file"], "comments": [{"owner": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "edited": false, "score": 2, "creation_date": 1467179841, "post_id": 38091373, "comment_id": 63618197, "body": "can you give an example, of the input file, actual output and expected output."}, {"owner": {"reputation": 2104, "user_id": 4635537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cad50ed18dff8aaff0ff427ea7b1067d?s=128&d=identicon&r=PG", "display_name": "sameerkn", "link": "https://stackoverflow.com/users/4635537/sameerkn"}, "edited": false, "score": 0, "creation_date": 1467179943, "post_id": 38091373, "comment_id": 63618243, "body": "String is a set of words. So if your file has just 1 word which is a pure number {3422} like <code>this is nub1234 3422 hello rock</code> then what&#39;s the count you are expecting?"}, {"owner": {"reputation": 293, "user_id": 6526722, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/64068fcdc02ecad329ca6f487670c4ac?s=128&d=identicon&r=PG", "display_name": "204", "link": "https://stackoverflow.com/users/6526722/204"}, "edited": false, "score": 0, "creation_date": 1467180128, "post_id": 38091373, "comment_id": 63618322, "body": "I am trying to count the number of pure strings. In my input there are NO mixed letters and numbers. For the given input the output expected : 4 { this,is,hello,rock}"}], "answers": [{"tags": [], "owner": {"reputation": 767708, "user_id": 14860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vXG1F.png?s=128&g=1", "display_name": "paxdiablo", "link": "https://stackoverflow.com/users/14860/paxdiablo"}, "is_accepted": true, "score": 1, "last_activity_date": 1467254199, "last_edit_date": 1467254199, "creation_date": 1467180191, "answer_id": 38091501, "question_id": 38091373, "link": "https://stackoverflow.com/questions/38091373/counting-the-number-of-strings-in-a-text-file-containing-numbers-as-well/38091501#38091501", "title": "counting the number of strings in a text file containing numbers as well", "body": "<p>Well, first up, using the <code>temp</code> pointer without having backing storage for it is going to cause you a world of pain.</p>\n\n<p>I'd suggest, as a start, using something like <code>char temp[1000]</code> instead, keeping in mind that's still a bit risky if you have words more than a thousand or so characters long (that's a <em>different</em> issue to the one you're asking about so I'll mention it but not spend <em>too</em> much time on fixing it).</p>\n\n<p>Secondly, it appears you want to count words with numbers (like <code>alpha7</code> or <code>pi/2</code>). If that's the case, you simply need to check <code>temp</code> after reading the \"word\" and increment <code>count</code> only if it matches a \"non-numeric\" pattern.</p>\n\n<p>That <em>could</em> be as simple as just not incrementing if the word consists only of digits, or it could be complicated if you want to handle decimals, exponential formats and so on.</p>\n\n<p>But the bottom line remains the same:</p>\n\n<pre><code>while(fscanf(fp,\"%s\",temp) != EOF )\n{\n    if (! isANumber(temp))\n        count++;\n}\n</code></pre>\n\n<p>with a suitable definition of <code>isANumber</code>. For example, for unsigned integers only, something like this would be a good start:</p>\n\n<pre><code>int isANumber (char *str) {\n    // Empty string is not a number.\n\n    if (*str == '\\0')\n        return 0;\n\n    // Check every character.\n\n    while (*str != '\\0') {\n        // If non-digit, it's not a number.\n\n        if (! isdigit (*str))\n            return 0;\n        str++;\n    }\n\n    // If all characters were digits, it was a number.\n\n    return 1;\n}\n</code></pre>\n\n<p>For more complex checking, you can use the <code>strto*</code> calls in C, giving them the <code>temp</code> buffer and ensuring you use the <code>endptr</code> method to ensure the entire string is scanned. Off the top of my head, so not <em>well</em> tested, that would go something like:</p>\n\n<pre><code>int isANumber (char *str) {\n    // Empty string is not a number.\n\n    if (*str == '\\0')\n        return 0;\n\n    // Use strtod to get a double.\n\n    char *endPtr;\n    long double d = strtold (str, &amp;endPtr);\n\n    // Characters unconsumed, not number (things like 42b).\n\n    if (*endPtr != '\\0')\n        return 0;\n\n    // Was a long double, so number.\n\n    return 1;\n}\n</code></pre>\n\n<p>The only thing you need to watch out for there is that certain strings like <code>NaN</code> or <code>+Inf</code> are considered a number by <code>strtold</code> so you may need extra checks for that.</p>\n"}, {"tags": [], "owner": {"reputation": 7241, "user_id": 6473435, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/eYyse.jpg?s=128&g=1", "display_name": "Dane", "link": "https://stackoverflow.com/users/6473435/dane"}, "is_accepted": false, "score": 0, "last_activity_date": 1467180446, "creation_date": 1467180446, "answer_id": 38091558, "question_id": 38091373, "link": "https://stackoverflow.com/questions/38091373/counting-the-number-of-strings-in-a-text-file-containing-numbers-as-well/38091558#38091558", "title": "counting the number of strings in a text file containing numbers as well", "body": "<p>inside your while loop, loop through the string to check if any of its characters are digits. Something like:</p>\n\n<pre><code>while(*temp != '\\0'){\n       if(isnumber(*temp))\n           break;\n}\n</code></pre>\n\n<p>[dont copy exact same code]</p>\n"}, {"comments": [{"owner": {"reputation": 767708, "user_id": 14860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vXG1F.png?s=128&g=1", "display_name": "paxdiablo", "link": "https://stackoverflow.com/users/14860/paxdiablo"}, "edited": false, "score": 0, "creation_date": 1467249033, "post_id": 38091887, "comment_id": 63658391, "body": "The behaviour of <code>wc</code> regarding lines is <i>arguably</i> correct if you define a line as zero or more characters terminated with a newline character (i.e., a complete line). In addition, consider the case where you had two such files <code>a</code> and <code>b</code>. If you consider the last non-newlined line to be an actual line then the sum of the line count of the individuals files (<code>wc -l &lt;a</code> plus <code>wc -l &lt;b</code>) is not equal to the line count of the files joined together (<code>cat a b | wc -l</code>). Not saying your way is either right <i>or</i> wrong, just that it&#39;s nuanced. In any case, it doesn&#39;t affect the core of your answer."}, {"owner": {"reputation": 767708, "user_id": 14860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vXG1F.png?s=128&g=1", "display_name": "paxdiablo", "link": "https://stackoverflow.com/users/14860/paxdiablo"}, "edited": false, "score": 0, "creation_date": 1467249317, "post_id": 38091887, "comment_id": 63658439, "body": "And, since I was curious, I checked the man page to see what was intended. It quite explicitly states for <code>-l</code>: <code>print the newline counts</code>.  So, whether you agree with the behaviour or not, it&#39;s working exactly as specified. Maybe we should raise a feature request for <code>--lines-including-final-possibly-non-terminated-one</code> :-)"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 767708, "user_id": 14860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vXG1F.png?s=128&g=1", "display_name": "paxdiablo", "link": "https://stackoverflow.com/users/14860/paxdiablo"}, "edited": false, "score": 0, "creation_date": 1467253186, "post_id": 38091887, "comment_id": 63659302, "body": "Yes, it is a curious choice made in how <code>wc -l</code> reports lines. I guess that is why we have a definition for a POSIX line ending. An equally interesting revelation is snapping to why <code>while (fgets (...))</code> and <code>while (getline (...) != -1)</code> report the number of lines differently depending on the POSIX line ending. It&#39;s so obvious it smacks you in the face, but that doesn&#39;t prevent scratching your head for a few minutes before the light-bulb winks on (at least for me)."}], "tags": [], "owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "is_accepted": false, "score": 0, "last_activity_date": 1467182763, "last_edit_date": 1467182763, "creation_date": 1467181715, "answer_id": 38091887, "question_id": 38091373, "link": "https://stackoverflow.com/questions/38091373/counting-the-number-of-strings-in-a-text-file-containing-numbers-as-well/38091887#38091887", "title": "counting the number of strings in a text file containing numbers as well", "body": "<p>I find <code>strpbrk</code> to be one of the most helpful function to search for several <em>needles</em> in a <em>haystack</em>. Your set of <em>needles</em> being the numeric characters <code>\"0123456789\"</code> which if present in a line read from your file will count as a line. I also prefer POSIX <code>getline</code> for a line count do to its proper handling of files with non-POSIX line endings for the last line (both <code>fgets</code> and <code>wc -l</code> omit text (and a count) of the last line if it does not contain a POSIX line end (<code>'\\n'</code>).  That said, a small function that searches a line for characters contained in a <code>trm</code> passed as a parameter could be written as:</p>\n\n<pre><code>/** open and read each line in 'fn' returning the number of lines\n *  continaing any of the characters in 'trm'.\n */\nsize_t nlines (char *fn, char *trm)\n{\n    if (!fn) return 0;\n\n    size_t lines = 0, n = 0;\n    char *buf = NULL;\n    FILE *fp = fopen (fn, \"r\");\n\n    if (!fp) return 0;\n\n    while (getline (&amp;buf, &amp;n, fp) != -1)\n        if (strpbrk (buf, trm))\n            lines++;\n\n    fclose (fp);\n    free (buf);\n\n    return lines;\n}\n</code></pre>\n\n<p>Simply pass the filename of interest and the terms to search for in each line. A short test code with a default term of <code>\"0123456789\"</code> that takes the filename as the first parameter and the term as the second could be written as follows:</p>\n\n<pre><code>#include &lt;stdio.h&gt;      /* printf */\n#include &lt;stdlib.h&gt;     /* free   */\n#include &lt;string.h&gt;     /* strlen, strrchr */\n\nsize_t nlines (char *fn, char *trm);\n\nint main (int argc, char **argv) {\n\n    char *fn   = argc &gt; 1 ? argv[1] : NULL;\n    char *srch = argc &gt; 2 ? argv[2] : \"0123456789\";\n    if (!fn) return 1;\n\n    printf (\"%zu %s\\n\", nlines (fn, srch), fn);\n\n    return 0;\n}\n\n/** open and read each line in 'fn' returning the number of lines\n *  continaing any of the characters in 'trm'.\n */\nsize_t nlines (char *fn, char *trm)\n{\n    if (!fn) return 0;\n\n    size_t lines = 0, n = 0;\n    char *buf = NULL;\n    FILE *fp = fopen (fn, \"r\");\n\n    if (!fp) return 0;\n\n    while (getline (&amp;buf, &amp;n, fp) != -1)\n        if (strpbrk (buf, trm))\n            lines++;\n\n    fclose (fp);\n    free (buf);\n\n    return lines;\n}\n</code></pre>\n\n<p>Give it a try and see if this is what you are expecting, if not, just let me know and I am glad to help further.</p>\n\n<p><strong>Example Input File</strong></p>\n\n<pre><code>$ cat dat/linewno.txt\nThe quick brown fox\njumps over 3 lazy dogs\nwho sleep in the sun\nwith a temp of 101\n</code></pre>\n\n<p><strong>Example Use/Output</strong></p>\n\n<pre><code>$ ./bin/getline_nlines_nums dat/linewno.txt\n2 dat/linewno.txt\n\n$ wc -l dat/linewno.txt\n4 dat/linewno.txt\n</code></pre>\n"}], "owner": {"reputation": 293, "user_id": 6526722, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/64068fcdc02ecad329ca6f487670c4ac?s=128&d=identicon&r=PG", "display_name": "204", "link": "https://stackoverflow.com/users/6526722/204"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 170, "favorite_count": 1, "accepted_answer_id": 38091501, "answer_count": 3, "score": 1, "last_activity_date": 1467254199, "creation_date": 1467179601, "question_id": 38091373, "link": "https://stackoverflow.com/questions/38091373/counting-the-number-of-strings-in-a-text-file-containing-numbers-as-well", "title": "counting the number of strings in a text file containing numbers as well", "body": "<p>I wanted to only count the number of strings in a text file, containing numbers as well. But the code below, counts even the numbers in the file as strings. How do I rectify the problem?</p>\n\n<pre><code>int count;\nchar *temp;\nFILE *fp;\n\n fp = fopen(\"multiplexyz.txt\" ,\"r\" );\n\n while(fscanf(fp,\"%s\",temp) != EOF )\n {\n     count++;\n }\n\n printf(\"%d \",count);\n return 0;\n</code></pre>\n\n<p>}</p>\n"}, {"tags": ["c", "pointers", "linked-list"], "comments": [{"owner": {"reputation": 419, "user_id": 1767890, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d81032b1f022720d48309e368fc36539?s=128&d=identicon&r=PG", "display_name": "Ben Braun", "link": "https://stackoverflow.com/users/1767890/ben-braun"}, "edited": false, "score": 0, "creation_date": 1467177501, "post_id": 38090856, "comment_id": 63617275, "body": "If you are compiling with warnings, the line &quot;printf(&quot;%d\\n&quot;, *curr);&quot; should print a warning since struct node is not an integer. While there is a reason you see this behavior, it&#39;s a bit complicated and has to do with how varargs are handled in C. Probably you should just avoid doing this so that the behavior is more understandable."}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 3, "creation_date": 1467177503, "post_id": 38090856, "comment_id": 63617277, "body": "<code>printf(&quot;%d\\n&quot;, *curr);</code> is undefined behaviour because <code>*curr</code> is not an int."}, {"owner": {"reputation": 818, "user_id": 4449542, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9aab40e761d370d2ee5919821a9d224c?s=128&d=identicon&r=PG&f=1", "display_name": "wolfsgang", "link": "https://stackoverflow.com/users/4449542/wolfsgang"}, "edited": false, "score": 1, "creation_date": 1467177697, "post_id": 38090856, "comment_id": 63617341, "body": "In addition to the what the above comments correctly pointed out, for reference, accessing elements with  <code>(*curr).val</code> is same as <code>curr-&gt;val</code>"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 1, "creation_date": 1467178320, "post_id": 38090856, "comment_id": 63617582, "body": "<code>warning: format \u2018%d\u2019 expects argument of type \u2018int\u2019, but argument 2 has type \u2018item\u2019 [-Wformat=]  printf(&quot;%d\\n&quot;, *curr);</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user707650"}, "edited": false, "score": 0, "creation_date": 1467178376, "post_id": 38090856, "comment_id": 63617603, "body": "Related: <a href=\"http://stackoverflow.com/questions/32597425/are-struct-names-pointers-to-first-element\" title=\"are struct names pointers to first element\">stackoverflow.com/questions/32597425/&hellip;</a> and <a href=\"http://stackoverflow.com/questions/19776731/why-use-address-of-first-element-of-struct-rather-than-struct-itself\" title=\"why use address of first element of struct rather than struct itself\">stackoverflow.com/questions/19776731/&hellip;</a> ."}, {"owner": {"user_type": "does_not_exist", "display_name": "user707650"}, "edited": false, "score": 1, "creation_date": 1467178422, "post_id": 38090856, "comment_id": 63617616, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/7312555/in-c-does-a-pointer-to-a-structure-always-point-to-its-first-member\">In C, does a pointer to a structure always point to its first member?</a>"}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1467179492, "post_id": 38090856, "comment_id": 63618053, "body": "<a href=\"http://stackoverflow.com/q/605845/995714\">Don&#39;t cast the result of <code>malloc</code> in C</a>"}, {"owner": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "edited": false, "score": 0, "creation_date": 1467179780, "post_id": 38090856, "comment_id": 63618177, "body": "Try <code>printf(&quot;%d %s\\n&quot;, cur-&gt;val, &quot;hello&quot;)</code> vs <code>printf(&quot;%d %s\\n&quot;, *curr, &quot;hello&quot;);</code> if you think they&#39;re the same."}], "answers": [{"comments": [{"owner": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "edited": false, "score": 1, "creation_date": 1467179870, "post_id": 38091231, "comment_id": 63618212, "body": "You say that the code is undefined behavior, but later say that &quot;if there was any other data type than <code>int</code>... it would have given an undefined output&quot;. Surely if it&#39;s undefined behavior the output is already undefined, no matter the type?"}, {"owner": {"reputation": 818, "user_id": 4449542, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9aab40e761d370d2ee5919821a9d224c?s=128&d=identicon&r=PG&f=1", "display_name": "wolfsgang", "link": "https://stackoverflow.com/users/4449542/wolfsgang"}, "reply_to_user": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "edited": false, "score": 0, "creation_date": 1467179996, "post_id": 38091231, "comment_id": 63618265, "body": "@PaulHankin True, I wrote that just to clarify about the correct output in this case, and how it will not carry for other cases."}], "tags": [], "owner": {"reputation": 818, "user_id": 4449542, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9aab40e761d370d2ee5919821a9d224c?s=128&d=identicon&r=PG&f=1", "display_name": "wolfsgang", "link": "https://stackoverflow.com/users/4449542/wolfsgang"}, "is_accepted": false, "score": 0, "last_activity_date": 1467179496, "last_edit_date": 1467179496, "creation_date": 1467178947, "answer_id": 38091231, "question_id": 38090856, "link": "https://stackoverflow.com/questions/38090856/why-are-curr-and-curr-val-the-same-value/38091231#38091231", "title": "Why are *curr and curr-&gt;val the same value?", "body": "<p>This is undefined behaviour and will give you warnings.</p>\n\n<p><code>printf</code> gets the type of argument being passed to it with the help of format specifiers. In your case the first element of the structure is a <code>int</code>and hence has a <code>int</code> at the top of the stack. Hence when <code>printf</code> looks for a <code>int</code> it finds one and gives the correct output, even though you passed the entire structure. </p>\n\n<p>If there was any other data type than <code>int</code> as the first element of your structure, it would have given an undefined output.\nHence as I mentioned in the comments, the correct ways to access the structure elements are with <code>(*curr).value</code> or as you have used <code>curr-&gt;value</code>. </p>\n"}, {"comments": [{"owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "edited": false, "score": 1, "creation_date": 1467190583, "post_id": 38091310, "comment_id": 63624531, "body": "<code>curr</code> does point to <code>&amp;(curr-&gt;val)</code> but <code>*curr</code> is <b>not</b> <code>curr-&gt;val</code> it just starts with <code>curr-&gt;val</code> but it is longer. See my answer for more details"}], "tags": [], "owner": {"reputation": 3566, "user_id": 4325010, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/048bff2cd5cae6d0a93ecd485f6690ad?s=128&d=identicon&r=PG&f=1", "display_name": "users at 4325010", "link": "https://stackoverflow.com/users/4325010/users-at-4325010"}, "is_accepted": true, "score": -2, "last_activity_date": 1467197083, "last_edit_date": 1495540411, "creation_date": 1467179293, "answer_id": 38091310, "question_id": 38090856, "link": "https://stackoverflow.com/questions/38090856/why-are-curr-and-curr-val-the-same-value/38091310#38091310", "title": "Why are *curr and curr-&gt;val the same value?", "body": "<p>Here</p>\n\n<pre><code>curr-&gt;val = i;  \ncurr-&gt;next = head;\nhead = curr;\n</code></pre>\n\n<p>first you set <code>(*curr).val</code> to <code>i</code>. Then you make <code>curr-&gt;next</code> point to <code>head</code>. At this time still <code>NULL</code>. Then you make <code>head</code> point to <code>curr</code>. And here the interesting part, <code>curr</code> points to its beginning and <code>*curr</code> dereferences it which is essentially <code>curr-&gt;val</code>, because from there starts the struct <code>curr</code>. </p>\n\n<p>As per Standard and this <a href=\"https://stackoverflow.com/questions/7312555/in-c-does-a-pointer-to-a-structure-always-point-to-its-first-member\">answer</a></p>\n\n<blockquote>\n  <p>(C1x \u00a76.7.2.1.13: \"A pointer to a structure object, suitably converted, points to its initial member ... and vice versa. There may be unnamed padding within as structure object, but not at its beginning.\")</p>\n</blockquote>\n\n<p>Which means that there isn't any space (padding) (or also e.g. some <code>HEAD</code> information) between the actual structure start and the start of its first element.</p>\n\n<p>EDIT:<br>\nI don't say anything about UB, not because I don't see it. OP asked for something else. It should be pointed out, but not be THE answer! That's why we have Comments Section!</p>\n"}, {"tags": [], "owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "is_accepted": false, "score": 9, "last_activity_date": 1467184225, "last_edit_date": 1467184225, "creation_date": 1467180562, "answer_id": 38091588, "question_id": 38090856, "link": "https://stackoverflow.com/questions/38090856/why-are-curr-and-curr-val-the-same-value/38091588#38091588", "title": "Why are *curr and curr-&gt;val the same value?", "body": "<p>First as a beginner, you should try to write correct code that raises no warning before trying to understand what happens under the hood and why some incorrect expressions still give correct results.</p>\n\n<p>C is a very permissive language, that is as long as the compiler can translate what it reads it generally assumes that the programmer knows why he wrote it. It's what happens here.</p>\n\n<p>In C, the address of a <code>struct</code> can be cast to an address to its first element. So <code>(void *) &amp;curr</code> is the same as <code>(void *) &amp;(curr-&gt;val)</code>. Here I cast everything to <code>void *</code> to make sure to have compatible pointer types.</p>\n\n<p>That means that <code>*((int *) curr)</code> is a perfectly defined C expression and its value is indeed <code>curr-&gt;val</code>. But it is correct, because I wrote an explicit pointer cast.</p>\n\n<p>What you wrote <em>works</em> only by accident, because as <code>curr</code> is an aggregate type; you pass an <code>int</code> and an <code>item *</code> to <code>printf</code> and use only its first value - this is <strong>no longer</strong> standard C and I can only assume a <em>classic</em> implementation to guess that. But just replace your print commands by that:</p>\n\n<pre><code>printf(\"%d - %d\\n\", curr-&gt;val, 12);\nprintf(\"%d - %d\\n\", *curr, 15);\n</code></pre>\n\n<p>You should see garbage in the second <code>printf</code>, because with <code>%d</code> you declare that you pass a simple <code>int</code> and actually pass an aggregate. Here again, nothing is explicitly mandated per standard, but common implementation should give this result.</p>\n\n<p><strong>TL;DR:</strong> As <code>*curr</code> is not an <code>int</code>, <code>printf(\"%d\\n\", *curr);</code> is Undefined Behaviour. This means that anything can happen, even the expected result, but a different version of same compiler, or another compiler, or even a change in compilation parameters could give a different result, as could a minor change in the code.</p>\n\n<p>And C allows automatic pointer cast to and from <code>void *</code> and you should never cast the return value of <code>malloc</code> as it can hide bugs. Please write:</p>\n\n<pre><code>curr = malloc(sizeof(item));\n</code></pre>\n\n<p>It is no longer C++ compatible, but is it correct C.</p>\n"}], "owner": {"reputation": 141, "user_id": 6223008, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6e6fa59df7645a742e500cccfaade7c0?s=128&d=identicon&r=PG&f=1", "display_name": "vancake", "link": "https://stackoverflow.com/users/6223008/vancake"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 311, "favorite_count": 0, "accepted_answer_id": 38091310, "answer_count": 3, "score": 5, "last_activity_date": 1467226866, "creation_date": 1467177175, "last_edit_date": 1467226866, "question_id": 38090856, "link": "https://stackoverflow.com/questions/38090856/why-are-curr-and-curr-val-the-same-value", "title": "Why are *curr and curr-&gt;val the same value?", "body": "<p>Consider:</p>\n\n<pre><code>#include&lt;stdlib.h&gt;\n#include&lt;stdio.h&gt;\n\nstruct node {\n    int val;\n    struct node *next;\n};\n\ntypedef struct node item;\n\nvoid main() {\n    item * curr, *head;\n    int i;\n\n    head = NULL;\n    for (i = 1; i &lt;= 10; i++) {\n        curr = (item *)malloc(sizeof(item));\n\n        curr-&gt;val = i;\n        curr-&gt;next = head;\n        head = curr;\n    }\n\n   curr = head;\n   while (curr) {\n        printf(\"%d\\n\", curr-&gt;val);\n        printf(\"%d\\n\", *curr);\n        curr = curr-&gt;next;\n   }\n\n   getchar();\n}\n</code></pre>\n\n<hr>\n\n<p>As I print out, <code>*curr</code> and <code>curr-&gt;val</code> are the same. Why?</p>\n\n<p>I am confused about <code>*curr</code>. I think <code>*curr</code> is the value <code>&amp;curr</code> points to. (I am newbie in C.)</p>\n"}, {"tags": ["c", "linux", "pthreads"], "comments": [{"owner": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "edited": false, "score": 0, "creation_date": 1467174290, "post_id": 38090256, "comment_id": 63616213, "body": "The answer to your second question: uh, those two look completely and utterly different to me.  My recommendation is to use <code>reinterpret_cast&lt;void *&gt;(i)</code>, since this is C++ and not C as the question was tagged."}, {"owner": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "edited": false, "score": 0, "creation_date": 1467174353, "post_id": 38090256, "comment_id": 63616230, "body": "Here&#39;s a discussion of passing values to <code>pthread_create</code>: <a href=\"http://stackoverflow.com/questions/8487380/how-to-cast-an-integer-to-void-pointer/8487738#8487738\" title=\"how to cast an integer to void pointer\">stackoverflow.com/questions/8487380/&hellip;</a>"}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1467176928, "post_id": 38090256, "comment_id": 63617082, "body": "A thread is &quot;freed&quot; either when you join it, or when it finishes if it&#39;s detached. If it&#39;s not detached and you don&#39;t join it, you&#39;re leaking it."}, {"owner": {"reputation": 161, "user_id": 3464942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11b7789f9d2b3ef8e7a16368807d14c1?s=128&d=identicon&r=PG&f=1", "display_name": "Fara Importanta", "link": "https://stackoverflow.com/users/3464942/fara-importanta"}, "edited": false, "score": 1, "creation_date": 1467184353, "post_id": 38090256, "comment_id": 63620555, "body": "1. <code>pthread_join</code> is a must because the main thread (the one that creates the other threads) may finish execution before the created threads finish, and you will usually create threads for lengthy tasks. It is also a way to synchronize threads.     2. You don&#39;t really need valPt (and you are also leaking valPt[t] right now)."}], "answers": [{"comments": [{"owner": {"reputation": 973, "user_id": 1734032, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/69zJo.jpg?s=128&g=1", "display_name": "mckenzm", "link": "https://stackoverflow.com/users/1734032/mckenzm"}, "edited": false, "score": 0, "creation_date": 1489118647, "post_id": 38093921, "comment_id": 72541377, "body": "So calling exit() in one of the parallel threads will terminate main and the siblings die a &quot;dirty&quot; death ? but pthread_exit() allows them to run on, possibly terminating gracefully and early if they are aware the parent is gone? More importantly the parent may not be main ?"}], "tags": [], "owner": {"reputation": 484, "user_id": 6490242, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26613036fd92e6ee9e1ce9b64037069d?s=128&d=identicon&r=PG&f=1", "display_name": "Twinkle", "link": "https://stackoverflow.com/users/6490242/twinkle"}, "is_accepted": false, "score": 1, "last_activity_date": 1467188010, "creation_date": 1467188010, "answer_id": 38093921, "question_id": 38090256, "link": "https://stackoverflow.com/questions/38090256/is-pthread-join-a-must-when-using-pthread-in-linux/38093921#38093921", "title": "Is pthread_join a must when using pthread in linux?", "body": "<p>It is not. But you need either <code>pthread_exit()</code> or <code>pthread_join()</code>.\nHere you called <code>pthread_exit()</code>, thats why the child threads continue execution even after the main thread terminates.\nIf there is any need for the main thread to wait till the child threads complete execution, you can use <code>pthread_join()</code>.</p>\n"}], "owner": {"reputation": 8978, "user_id": 2223579, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/wQuP6.jpg?s=128&g=1", "display_name": "BlackMamba", "link": "https://stackoverflow.com/users/2223579/blackmamba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 410, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1467188010, "creation_date": 1467173637, "last_edit_date": 1467174020, "question_id": 38090256, "link": "https://stackoverflow.com/questions/38090256/is-pthread-join-a-must-when-using-pthread-in-linux", "title": "Is pthread_join a must when using pthread in linux?", "body": "<p>I an learning <code>pthread</code> and I have a few questions.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>#include &lt;pthread.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;iostream&gt;\n#define NUM_THREADS 10\n\nusing namespace std;\n\nvoid *PrintHello(void *threadid)\n{\n   int* tid;\n   tid = (int*)threadid;\n   for(int i = 0; i &lt; 5; i++){\n     printf(\"Hello, World (thread %d)\\n\", *tid);\n   }\n   pthread_exit(NULL);\n}\n\nint main (int argc, char *argv[])\n{\n   pthread_t threads[NUM_THREADS];\n   int rc;\n   int t;\n   int* valPt[NUM_THREADS]; \n\n   for(t=0; t &lt; NUM_THREADS; t++){\n      printf(\"In main: creating thread %d\\n\", t);\n      valPt[t] = new int();\n      *valPt[t] = t;\n      rc = pthread_create(&amp;threads[t], NULL, PrintHello, (void *)valPt[t]);\n      if (rc){\n         printf(\"ERROR; return code from pthread_create() is %d\\n\", rc);\n         exit(-1);\n      }\n   }\n   /* Last thing that main() should do */\n   pthread_exit(NULL);\n}\n</code></pre>\n\n<p>The code runs well and I don't call <code>pthread_join</code>. So I want to know, is <code>pthread_join</code> a must?</p>\n\n<hr>\n\n<p>Another issue, is:</p>\n\n<pre><code>valPt[t] = new int();\n*valPt[t] = t;\nrc = pthread_create(&amp;threads[t], NULL, PrintHello, (void *)valPt[t]);\n</code></pre>\n\n<p>equal to:</p>\n\n<pre><code>rc = pthread_create(&amp;threads[t], NULL, PrintHello, &amp;i);\n</code></pre>\n"}, {"tags": ["c#", "php", "c++", "c", "performance"], "comments": [{"owner": {"reputation": 1409, "user_id": 1935753, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/069c9c1b8c31ac76cbe4b362f13ccbe5?s=128&d=identicon&r=PG", "display_name": "Hele", "link": "https://stackoverflow.com/users/1935753/hele"}, "edited": false, "score": 1, "creation_date": 1467174308, "post_id": 38090253, "comment_id": 63616221, "body": "Dear user who voted to close, care to explain why? The question meets all the suggestions at <a href=\"https://stackoverflow.com/help/how-to-ask\">stackoverflow.com/help/how-to-ask</a> and is clear and has an answer."}], "answers": [{"tags": [], "owner": {"reputation": 104432, "user_id": 53212, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e0fbce15f81d6308656931250db267a1?s=128&d=identicon&r=PG", "display_name": "thomasrutter", "link": "https://stackoverflow.com/users/53212/thomasrutter"}, "is_accepted": true, "score": 2, "last_activity_date": 1467174663, "creation_date": 1467174663, "answer_id": 38090418, "question_id": 38090253, "link": "https://stackoverflow.com/questions/38090253/fastest-access-of-intensive-function-from-php/38090418#38090418", "title": "Fastest access of intensive function from PHP?", "body": "<p>The two most obvious solutions to me seem absent from your set of options:</p>\n\n<ul>\n<li>Use PHP's GD extension.</li>\n<li>Use imagemagick.</li>\n</ul>\n\n<p>Whether these are practical options depends on what exactly you have to do with the image.  If they are just static images you don't need anything, just serve them up as files from your web server.  The fact you need some code to generate the image implies that the image is dynamically generated.</p>\n\n<p>If neither of these suit, then I would say: your last (4th) solution would be the fastest, but a modified version of your 3rd solution would be simplest: write a command-line program that returns the image data to stdout, and call that from PHP.</p>\n"}], "owner": {"reputation": 1409, "user_id": 1935753, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/069c9c1b8c31ac76cbe4b362f13ccbe5?s=128&d=identicon&r=PG", "display_name": "Hele", "link": "https://stackoverflow.com/users/1935753/hele"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27, "favorite_count": 1, "accepted_answer_id": 38090418, "answer_count": 1, "score": 1, "last_activity_date": 1467174663, "creation_date": 1467173631, "last_edit_date": 1467174346, "question_id": 38090253, "link": "https://stackoverflow.com/questions/38090253/fastest-access-of-intensive-function-from-php", "title": "Fastest access of intensive function from PHP?", "body": "<p><strong>Background</strong>:<br>\nI have a PHP server hosting a RESTful API that returns an image when a function <em>/api/GenerateImage</em> is called. I need the fastest and lowest memory using method to achieve this.</p>\n\n<p><strong>Ideas</strong>:<br>\n  I can think of a few ways of achieving this:</p>\n\n<ol>\n<li>Write it entirely in PHP - Image requires a lot of byte manipulation and it feels bad to do this in PHP.</li>\n<li>Write a continually running C# program and use an API to generate the image and copy the response stream to the client via PHP - Need to avoid overhead of unnecessary socket connections.</li>\n<li>Write a C/C++ command line program that, when called, generates and stores the image in a file, which PHP reads and sends - Need to avoid overhead due to starting a program, writing to a file and then reading to it.</li>\n<li>Write it in C/C++ and use a PHP library wrapper to call the function directly from PHP - Seems to be the fastest, but most difficult for a single function.</li>\n</ol>\n"}, {"tags": ["c++", "c", "matrix", "sse", "simd"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 6526372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a7e9030fc8e5e7aa55687928eb3546b?s=128&d=identicon&r=PG&f=1", "display_name": "Lvargas", "link": "https://stackoverflow.com/users/6526372/lvargas"}, "edited": false, "score": 0, "creation_date": 1467174553, "post_id": 38090223, "comment_id": 63616286, "body": "i think i m having problems understanding the code, what should a proper input be?"}, {"owner": {"reputation": 30170, "user_id": 5231607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QzGsq.jpg?s=128&g=1", "display_name": "1201ProgramAlarm", "link": "https://stackoverflow.com/users/5231607/1201programalarm"}, "reply_to_user": {"reputation": 3, "user_id": 6526372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a7e9030fc8e5e7aa55687928eb3546b?s=128&d=identicon&r=PG&f=1", "display_name": "Lvargas", "link": "https://stackoverflow.com/users/6526372/lvargas"}, "edited": false, "score": 1, "creation_date": 1467175014, "post_id": 38090223, "comment_id": 63616419, "body": "@Lvargas a 4x4 matrix will have 16 elements in it.  Your float arrays in main should be, for example, <code>float C[16];</code> with more initializers for <code>A</code> and <code>B</code>.  Alternatively, you can use <code>float C[4][4]</code> to get a <code>C[row][col]</code> notation."}, {"owner": {"reputation": 29002, "user_id": 2542702, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fW5ka.jpg?s=128&g=1", "display_name": "Z boson", "link": "https://stackoverflow.com/users/2542702/z-boson"}, "reply_to_user": {"reputation": 3, "user_id": 6526372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a7e9030fc8e5e7aa55687928eb3546b?s=128&d=identicon&r=PG&f=1", "display_name": "Lvargas", "link": "https://stackoverflow.com/users/6526372/lvargas"}, "edited": false, "score": 2, "creation_date": 1467180613, "post_id": 38090223, "comment_id": 63618556, "body": "@Lvargas, use <code>float A[16], float B[16], float C[16];</code> But if you have to ask this question then it&#39;s too early for you to be using intrinsics. Start with standard C code."}, {"owner": {"reputation": 3, "user_id": 6526372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a7e9030fc8e5e7aa55687928eb3546b?s=128&d=identicon&r=PG&f=1", "display_name": "Lvargas", "link": "https://stackoverflow.com/users/6526372/lvargas"}, "edited": false, "score": 0, "creation_date": 1467209632, "post_id": 38090223, "comment_id": 63638288, "body": "thanks! do you know if the only way yo scale this is just creating more vectors? if i want to multiply 100x100 how can i scale these?"}, {"owner": {"reputation": 30170, "user_id": 5231607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QzGsq.jpg?s=128&g=1", "display_name": "1201ProgramAlarm", "link": "https://stackoverflow.com/users/5231607/1201programalarm"}, "reply_to_user": {"reputation": 3, "user_id": 6526372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a7e9030fc8e5e7aa55687928eb3546b?s=128&d=identicon&r=PG&f=1", "display_name": "Lvargas", "link": "https://stackoverflow.com/users/6526372/lvargas"}, "edited": false, "score": 0, "creation_date": 1467264842, "post_id": 38090223, "comment_id": 63662401, "body": "@Lvargas That is not a trivial change.  The 4x4 code features several optimizations, including loop unrolling.  If you&#39;re going to be using 100x100 or 500x500 matrices you are probably better off using an existing matrix library that will be able to handle those large sizes efficiently."}], "tags": [], "owner": {"reputation": 30170, "user_id": 5231607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QzGsq.jpg?s=128&g=1", "display_name": "1201ProgramAlarm", "link": "https://stackoverflow.com/users/5231607/1201programalarm"}, "is_accepted": true, "score": 4, "last_activity_date": 1467173455, "creation_date": 1467173455, "answer_id": 38090223, "question_id": 38090188, "link": "https://stackoverflow.com/questions/38090188/matrix-multiplication-using-sse/38090223#38090223", "title": "Matrix Multiplication Using SSE", "body": "<p>The arrays you declare in <code>main</code> have 4 elements each, but your multiplication code reads and writes <strong>16</strong> elements each.  Writing past the allocated space (elements 4 and later, in the second iteration of your <code>i</code> loop) will clobber the stack resulting in the error you see.</p>\n"}], "owner": {"reputation": 3, "user_id": 6526372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a7e9030fc8e5e7aa55687928eb3546b?s=128&d=identicon&r=PG&f=1", "display_name": "Lvargas", "link": "https://stackoverflow.com/users/6526372/lvargas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2650, "favorite_count": 0, "accepted_answer_id": 38090223, "answer_count": 1, "score": 0, "last_activity_date": 1467658847, "creation_date": 1467173204, "last_edit_date": 1495542166, "question_id": 38090188, "link": "https://stackoverflow.com/questions/38090188/matrix-multiplication-using-sse", "title": "Matrix Multiplication Using SSE", "body": "<p>I am trying to get a working example of multiplying 2 matrix using SIMD because i need to compare the time of the algorithm with a \"normal\" one.\nHere is why i tried doing <a href=\"https://stackoverflow.com/questions/18499971/efficient-4x4-matrix-multiplication-c-vs-assembly?rq=1\">Efficient 4x4 matrix multiplication (C vs assembly)</a> .</p>\n\n<pre><code>#include &lt;xmmintrin.h&gt;\n#include &lt;stdio.h&gt;\n\n\nvoid M4x4_SSE(float *A, float *B, float *C) {\n    __m128 row1 = _mm_load_ps(&amp;B[0]);\n    __m128 row2 = _mm_load_ps(&amp;B[4]);\n    __m128 row3 = _mm_load_ps(&amp;B[8]);\n    __m128 row4 = _mm_load_ps(&amp;B[12]);\n    for(int i=0; i&lt;4; i++) {\n        __m128 brod1 = _mm_set1_ps(A[4*i + 0]);\n        __m128 brod2 = _mm_set1_ps(A[4*i + 1]);\n        __m128 brod3 = _mm_set1_ps(A[4*i + 2]);\n        __m128 brod4 = _mm_set1_ps(A[4*i + 3]);\n        __m128 row = _mm_add_ps(\n                    _mm_add_ps(\n                        _mm_mul_ps(brod1, row1),\n                        _mm_mul_ps(brod2, row2)),\n                    _mm_add_ps(\n                        _mm_mul_ps(brod3, row3),\n                        _mm_mul_ps(brod4, row4)));\n        _mm_store_ps(&amp;C[4*i], row);\n    }\n}\n\n\nint main(){\n\n  float A[4] __attribute__((aligned(16))) = {1,2,3,4};\n  float B[4] __attribute__((aligned(16))) = {5,6,7,8};\n  float C[4] __attribute__((aligned(16)));\n\n  M4x4_SSE(A,B,C);\n\n}\n</code></pre>\n\n<p>I am not familiar with c or c++ so it has been difficult, i get:</p>\n\n<pre><code>*** stack smashing detected ***: ./prueba terminated\nAborted (core dumped)\n</code></pre>\n\n<p>when i run my program. I need to scale to a 500x500 matrix at least.\nThanks</p>\n"}, {"tags": ["c", "recursion", "fibonacci"], "comments": [{"owner": {"reputation": 1163, "user_id": 1447013, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/28LZ2.jpg?s=128&g=1", "display_name": "Daniel Rudy", "link": "https://stackoverflow.com/users/1447013/daniel-rudy"}, "edited": false, "score": 0, "creation_date": 1467172903, "post_id": 38090131, "comment_id": 63615873, "body": "This seems like homework to me.  We&#39;re not against helping people with homework, just tag it as homework so we know how to guide you."}, {"owner": {"reputation": 14088, "user_id": 4642212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f858afc6f98f72ca7d617da224a28db7?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastian Simon", "link": "https://stackoverflow.com/users/4642212/sebastian-simon"}, "reply_to_user": {"reputation": 1163, "user_id": 1447013, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/28LZ2.jpg?s=128&g=1", "display_name": "Daniel Rudy", "link": "https://stackoverflow.com/users/1447013/daniel-rudy"}, "edited": false, "score": 0, "creation_date": 1467173287, "post_id": 38090131, "comment_id": 63615965, "body": "@DanielRudy The [homework] tag is not supposed to be used anymore."}, {"owner": {"reputation": 1163, "user_id": 1447013, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/28LZ2.jpg?s=128&g=1", "display_name": "Daniel Rudy", "link": "https://stackoverflow.com/users/1447013/daniel-rudy"}, "reply_to_user": {"reputation": 14088, "user_id": 4642212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f858afc6f98f72ca7d617da224a28db7?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastian Simon", "link": "https://stackoverflow.com/users/4642212/sebastian-simon"}, "edited": false, "score": 0, "creation_date": 1467173411, "post_id": 38090131, "comment_id": 63615999, "body": "@Xufox I was not aware of that.  Well, if it is homework, it should be mentioned in the post."}], "answers": [{"tags": [], "owner": {"reputation": 80, "user_id": 2851510, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000328348894/picture?type=large", "display_name": "Hung Minh Tran", "link": "https://stackoverflow.com/users/2851510/hung-minh-tran"}, "is_accepted": true, "score": 2, "last_activity_date": 1467173062, "creation_date": 1467173062, "answer_id": 38090172, "question_id": 38090131, "link": "https://stackoverflow.com/questions/38090131/unable-to-print-recursive-fibonacci-sequence-correctly/38090172#38090172", "title": "Unable to print recursive fibonacci sequence correctly", "body": "<pre><code>if (n == 0)\n</code></pre>\n\n<p>not</p>\n\n<pre><code>if (n=0)\n</code></pre>\n\n<p>check your syntax careful.</p>\n"}, {"comments": [{"owner": {"reputation": 405, "user_id": 3857670, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/542831519/picture?type=large", "display_name": "Shay Gold", "link": "https://stackoverflow.com/users/3857670/shay-gold"}, "edited": false, "score": 1, "creation_date": 1467179215, "post_id": 38090173, "comment_id": 63617942, "body": "if (0 == n) is even better. This way if you use = instead of == it won&#39;t compile."}], "tags": [], "owner": {"reputation": 27792, "user_id": 1830293, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6prVF.jpg?s=128&g=1", "display_name": "DAXaholic", "link": "https://stackoverflow.com/users/1830293/daxaholic"}, "is_accepted": false, "score": 1, "last_activity_date": 1467173072, "creation_date": 1467173072, "answer_id": 38090173, "question_id": 38090131, "link": "https://stackoverflow.com/questions/38090131/unable-to-print-recursive-fibonacci-sequence-correctly/38090173#38090173", "title": "Unable to print recursive fibonacci sequence correctly", "body": "<p>You use a single equal sign and so you assign a value instead of doing a comparison</p>\n\n<pre><code>if (n == 0)\n    return 0;\nif (n == 1)\n    return 1;\n...\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 30168, "user_id": 5612562, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/gzBQY.jpg?s=128&g=1", "display_name": "msc", "link": "https://stackoverflow.com/users/5612562/msc"}, "is_accepted": false, "score": 0, "last_activity_date": 1467173955, "creation_date": 1467173955, "answer_id": 38090301, "question_id": 38090131, "link": "https://stackoverflow.com/questions/38090131/unable-to-print-recursive-fibonacci-sequence-correctly/38090301#38090301", "title": "Unable to print recursive fibonacci sequence correctly", "body": "<p>You can try this logic : </p>\n\n<pre><code>int Fibonacci (int n)\n{\n    if(n &lt; 2)\n       return n;\n    else\n       return Fibonacci(n- 1) + Fibonacci(n- 2);\n}\n</code></pre>\n\n<p>Here <code>n&lt;2</code> means the recursion will terminate when number of terms are <code>&lt; 2</code> because we know the first two terms of fibonacci series are <code>0</code> and <code>1</code>.</p>\n"}], "owner": {"reputation": 86, "user_id": 5593234, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfdec5643c0c11871fe68edef3e14276?s=128&d=identicon&r=PG&f=1", "display_name": "infinity-1", "link": "https://stackoverflow.com/users/5593234/infinity-1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 1, "accepted_answer_id": 38090172, "answer_count": 3, "score": -7, "last_activity_date": 1467173955, "creation_date": 1467172716, "question_id": 38090131, "link": "https://stackoverflow.com/questions/38090131/unable-to-print-recursive-fibonacci-sequence-correctly", "title": "Unable to print recursive fibonacci sequence correctly", "body": "<p>I am trying to write a recursive Fibonacci generator that prints each term in C. The number of terms is user-specified; I have developed the algorithm. When I try to print, it only prints ones. Can anyone point me in the direction of where I am going wrong?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint Fibonacci (int n)\n{\n    if (n = 0)\n        return 0;\n    if (n = 1)\n        return 1;\n    else\n        return (Fibonacci(n-1) + Fibonacci(n-2));\n}\n\nint main()\n{\n    int terms;\n    printf(\"Enter the number of terms: \");\n    scanf(\"%d\", &amp;terms);\n\n\n    printf(\"\\nThe Fibonacci sequence containing %d terms is:\\n\", terms);\n\n    int i = 0;\n    for (i; i &lt; terms; i++)\n    {\n        printf(\"%d \", Fibonacci(i));\n    }\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4710450"}, "edited": false, "score": 0, "creation_date": 1467168469, "post_id": 38089452, "comment_id": 63614877, "body": "It was a better idea you created a separate function named <code>reverse_array</code> ..."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "is_accepted": true, "score": 0, "last_activity_date": 1467174331, "last_edit_date": 1467174331, "creation_date": 1467171678, "answer_id": 38089988, "question_id": 38089452, "link": "https://stackoverflow.com/questions/38089452/c-visual-debug-error-run-time-check-failure-2-s/38089988#38089988", "title": "C_(visual)_Debug Error_ Run-Time Check Failure #2 -S", "body": "<p>Array index starts from 0  in C and your array has 5 elements so arr[4] is the last element but your code:  </p>\n\n<pre><code>j = size - i;\narr[j];\n</code></pre>\n\n<p>when <code>i=0</code> access to  arr[5], this is your code error: <strong>Array index out of bound</strong>.  </p>\n\n<p>you should use <code>j = size - i-1;</code> to point to the last element of array,  not <code>j = size - i;</code><br>\nsee this working sample (your sample code with some edit):    </p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint main()\n{\n    int arr[] = { 1, 2, 3, 4, 5 };\n    int size, i, j;\n    int temp = 0;\n    size = sizeof(arr) / sizeof(arr[0]); //use this for changing size\n    printf(\"first_array :\");\n    for (i = 0; i &lt; size; i++)\n    {\n        printf(\"%d \", arr[i]);\n    }\n    printf(\"\\n\");\n    for (i = 0; i &lt;= (size / 2); i++)\n    {\n        j = size - i - 1;\n        temp = arr[i];\n        arr[i] = arr[j];\n        arr[j] = temp;\n    }\n    printf(\"Riv_array :\");\n    for (i = 0; i &lt; size; i++)\n    {\n        printf(\"%d \", arr[i]);\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>another way to reverse array using pointers:  </p>\n\n<pre><code>#include &lt;stdio.h&gt;\nvoid reverse(int* p, int count){\n    int temp;\n    int* q = p + count - 1; // point to the end\n    count /= 2;\n    while (count--) {\n        temp = *p;\n        *p++ = *q;\n        *q-- = temp;\n    }\n}\nvoid print_array(int *p, int count){\n    while (count--) printf(\"%d \", *p++);\n    printf(\"\\n\");\n}\nint main()\n{\n    int arr[] = { 1, 2, 3, 4, 5 };\n    int count = ((&amp;arr)[1] - arr);\n    print_array(arr, count); \n    reverse(arr, count);\n    print_array(arr, count);\n    return 0;\n}\n</code></pre>\n\n<p>output:  </p>\n\n<pre><code>1 2 3 4 5\n5 4 3 2 1\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 6526218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09df358904f94c57dcc7eebf5cc228a3?s=128&d=identicon&r=PG&f=1", "display_name": "Jongmin_Lee", "link": "https://stackoverflow.com/users/6526218/jongmin-lee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 940, "favorite_count": 1, "accepted_answer_id": 38089988, "answer_count": 1, "score": 0, "last_activity_date": 1475657145, "creation_date": 1467167974, "last_edit_date": 1475657145, "question_id": 38089452, "link": "https://stackoverflow.com/questions/38089452/c-visual-debug-error-run-time-check-failure-2-s", "title": "C_(visual)_Debug Error_ Run-Time Check Failure #2 -S", "body": "<p>I want to reverse numbers of array,\nbut I can't understand why it didn't run.</p>\n\n<p>Thanks for explaining what does <code>Debug Error_ Run-Time Check Failure #2 -S</code> mean..</p>\n\n<p>Thanks,</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main()\n{\n    int arr[] = { 1,2,3,4,5 };\n    int size, i, j;\n    int temp = 0;\n    size = sizeof(arr) / sizeof(arr[0]); //use this for changing size\n    printf(\"first_array :\");\n    for (i = 0; i &lt; size; i++)\n    {\n        printf(\"%d\", arr[i]);\n    }\n    printf(\"\\n\");\n    for (i = 0; i &lt;= (size / 2); i++)\n    {\n        j = size - i;\n        temp = arr[i];\n        arr[i] = arr[j];\n        arr[j] = temp;\n    }\n    printf(\"Riv_array :\");\n    for (i = 0; i &lt; size; i++)\n    {\n        printf(\"%d\", arr[i]);\n    }\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "makefile"], "comments": [{"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1467171330, "post_id": 38089410, "comment_id": 63615508, "body": "What is the error message you get?"}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1467198442, "post_id": 38089410, "comment_id": 63629823, "body": "You don&#39;t have any targets in that makefile - what did you expect to happen?"}, {"owner": {"reputation": 75, "user_id": 6159781, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/061f05b9868774cb3e73e1e6db0aa734?s=128&d=identicon&r=PG&f=1", "display_name": "NutellaFan", "link": "https://stackoverflow.com/users/6159781/nutellafan"}, "edited": false, "score": 0, "creation_date": 1467221037, "post_id": 38089410, "comment_id": 63646160, "body": "@ Toby Speight Sorry for being unclear, I do have targets and different rules for .cpp and .c files in my real makefile.  This was just a toy example to get at the core problem -- the inability to generate the .o&#39;s from both .cpp and .c files correctly (generating from one is simple)."}], "answers": [{"comments": [{"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1467198204, "post_id": 38090296, "comment_id": 63629676, "body": "&quot;Here&#39;s my makefile&quot; doesn&#39;t contain much educational value for the OP, who would benefit more from <i>why</i> yours works where the one presented does not.  Please <a href=\"https://stackoverflow.com/posts/38090296/edit\">edit</a> your answer to clarify what&#39;s wrong in the original and what you did to fix it."}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1467198330, "post_id": 38090296, "comment_id": 63629765, "body": "BTW, I noticed that the rule <code>run: clean build execute</code> has targets with no order dependency, so a multithreaded make may start the <code>execute</code> target before the <code>clean</code> target has even finished..."}, {"owner": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "reply_to_user": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1467211635, "post_id": 38090296, "comment_id": 63639850, "body": "@TobySpeight, thank you for the input. I didn&#39;t notice the dependency part, I&#39;ll edit shortly. As for explaining, often I see <code>makefile</code> as a prerequisite for a project, like a compiler, having something that works should do, knowing why it works is nice but isn&#39;t important... but you&#39;re right too. I&#39;ll add a few words about why this allows C++ and C to mix. However, I doubt I&#39;ll explain possible issues with the OP&#39;s makefile, considering no error data was posted."}, {"owner": {"reputation": 75, "user_id": 6159781, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/061f05b9868774cb3e73e1e6db0aa734?s=128&d=identicon&r=PG&f=1", "display_name": "NutellaFan", "link": "https://stackoverflow.com/users/6159781/nutellafan"}, "edited": false, "score": 0, "creation_date": 1467221096, "post_id": 38090296, "comment_id": 63646199, "body": "@Myst The combination of foreach, basename, addsuffix was exactly what I was looking for .. thanks!"}], "tags": [], "owner": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "is_accepted": true, "score": 1, "last_activity_date": 1467213242, "last_edit_date": 1467213242, "creation_date": 1467173927, "answer_id": 38090296, "question_id": 38089410, "link": "https://stackoverflow.com/questions/38089410/substitution-reference-with-cpp-and-c-files/38090296#38090296", "title": "Substitution reference with .cpp and .c files", "body": "<p>In order to have a <code>makefile</code> work for both C and C++, you need separate rules for each language - although some rules are the same.</p>\n\n<p>Another issue would be the linker. A C only project will use one linker and not the other.</p>\n\n<p>I'm dumping my makefile here (it's from <a href=\"https://github.com/boazsegev/c-server-tools\" rel=\"nofollow\">this project</a>).</p>\n\n<p>As you can see from this example, there are two different build rules, one for objects created with C file and another for objects created with C++. When the first one fails, the second one is attempted, so sharing a list of objects is made possible.</p>\n\n<p>Also, you might notice that the C++ rule has this line <code>$(eval CCL = $(CPP))</code> which sets the linker variable (<code>CCL</code>) to the C++ linker in projects where C++ is used. This way, when the build rule is called, it uses the correct linker.</p>\n\n<p>Another thing to look at is the way this code deals with lists and extension substitution. Notice the use of the <code>foreach</code>, <code>addsuffix</code> and <code>basename</code> functions... this is distinctly more complex then the <code>$(CSRCS:.c=.o)</code> you suggested.</p>\n\n<p>I would recommend you add a rule that displays the make variables, so you can debug any that have gone astray (see the demo), it a great way to learn as well as resolve issues.</p>\n\n<p>A few words of warning about the <code>makefile</code> I'm pasting here...</p>\n\n<p>It works for both C and C++ (mixed) projects and it's almost \"plug and play\", but you <strong>must</strong> to change the folder names and target files to fit your folder structure.</p>\n\n<p>Also, notice that it will <strong>delete</strong> the whole of your project <em><strong>if</strong></em> you define the temporary folder as the project folder (it's defined as <code>tmp</code> for a reason, as it makes cleanup real easy).</p>\n\n<p>In the future I might update it so any <code>src</code> subfolders are automatically added, but at the moment I need that extra control to exclude some folders.</p>\n\n<p>This makefile is mostly a work of laziness... I hate updating makefiles all the time, so I have a low-cost makefile that mostly calculates everything on it's own... unless I change the project's folder structure or need different libraries.</p>\n\n<pre><code>NAME=demo\n\nOUT_ROOT=./tmp\nTMP_ROOT=./tmp\nSRC_ROOT=.\n\nSRC_EXTRA_FOLDERS=src src/http\n\nLIBS=-pthread -lssl -lcrypto\nINCLUDE=/usr/local/include\n\nCC=@gcc\nCPP=@g++\nDB=@lldb\nOPTIMIZATION=O3\n\n#auto computed values\nBIN = $(OUT_ROOT)/$(NAME)\nSRCDIR = $(SRC_ROOT) $(foreach dir, $(SRC_EXTRA_FOLDERS), $(addsuffix /,$(basename $(SRC_ROOT)))$(dir))\nSRC = $(foreach dir, $(SRCDIR), $(wildcard $(addsuffix /, $(basename $(dir)))*.c*))\nBUILDTREE =$(foreach dir, $(SRCDIR), $(addsuffix /, $(basename $(TMP_ROOT)))$(basename $(dir)))\nOBJS = $(foreach source, $(SRC), $(addprefix $(TMP_ROOT)/, $(addsuffix .o, $(basename $(source)))))\nCCL = $(CC)\n\n# the C flags\nCFLAGS=-Wall -g -$(OPTIMIZATION) -std=c11 $(foreach dir,$(INCLUDE),$(addprefix -I, $(dir))) $(foreach dir,$(SRCDIR),$(addprefix -I, $(dir)))\nCPPFLAGS= -Wall -$(OPTIMIZATION) -std=c++11 $(foreach dir,$(INCLUDE),$(addprefix -I, $(dir))) $(foreach dir,$(SRCDIR),$(addprefix -I, $(dir)))\n\n$(NAME): build\n\nbuild: $(OBJS)\n    $(CCL) -o $(BIN) $^ -$(OPTIMIZATION) $(LIBS)\n\n$(TMP_ROOT)/%.o: %.c\n    $(CC) -o $@ -c $^ $(CFLAGS)\n\n$(TMP_ROOT)/%.o: %.cpp\n    $(CPP) -o $@ -c $^ $(CPPFLAGS)\n    $(eval CCL = $(CPP))\n\nclean:\n    -@rm $(BIN)\n    -@rm -R $(TMP_ROOT)\n    -@mkdir -p $(BUILDTREE)\n\nexecute:\n    @$(BIN)\n\nrun: | clean build execute\n\ndb: | clean build\n    $(DB) $(BIN)\n\nvars:\n    @echo \"BIN: $(BIN)\"\n    @echo \"\"\n    @echo \"SRCDIR: $(SRCDIR)\"\n    @echo \"\"\n    @echo \"SRC: $(SRC)\"\n    @echo \"\"\n    @echo \"BUILDTREE: $(BUILDTREE)\"\n    @echo \"\"\n    @echo \"OBJS: $(OBJS)\"\n    @echo \"\"\n    @echo \"CFLAGS: $(CFLAGS)\"\n    @echo \"\"\n    @echo \"CPPFLAGS: $(CPPFLAGS)\"\n</code></pre>\n\n<p>As par Toby Speight's suggestion, I added the pipe sign (<code>|</code>) to mark the prerequisites as ordered, for all the concurrency people out there.</p>\n"}], "owner": {"reputation": 75, "user_id": 6159781, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/061f05b9868774cb3e73e1e6db0aa734?s=128&d=identicon&r=PG&f=1", "display_name": "NutellaFan", "link": "https://stackoverflow.com/users/6159781/nutellafan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 312, "favorite_count": 0, "closed_date": 1467257430, "accepted_answer_id": 38090296, "answer_count": 1, "score": -2, "last_activity_date": 1467213242, "creation_date": 1467167725, "last_edit_date": 1495540349, "question_id": 38089410, "link": "https://stackoverflow.com/questions/38089410/substitution-reference-with-cpp-and-c-files", "closed_reason": "Not suitable for this site", "title": "Substitution reference with .cpp and .c files", "body": "<p>I know there a lot of questions about mixing .cpp and .c files into one makefile, but I haven't seen the issue of mixed substitution reference addressed.  I am having issues with it.</p>\n\n<p>My makefile is structure is based on <a href=\"https://stackoverflow.com/questions/11608463/make-substitution-references-on-a-variable-more-than-once\" title=\"this answer\">this answer</a>:</p>\n\n<pre><code>LIB=mylib.so\nCPPSRCS += hello.cpp\nCSRCS += goodbye.c\n\nOBJS = $(CSRCS:.c=.o) $(CPPSRCS:.cpp=.o)\n\n# Separate rules for .cpp and .c files, link together to form library.\n# All pretty standard stuff and I am sure it will work if we goodbye.o and    \n# hello.o are present.\n</code></pre>\n\n<p>This doesn't work, and I get the old no rule to make target error.  What am I doing wrong?  How can I do substitution reference on two types of files into one variable? </p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1467167790, "post_id": 38089385, "comment_id": 63614722, "body": "As large as necessary the <code>char type[2];</code>"}, {"owner": {"reputation": 2405, "user_id": 2216129, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/U0xqx.jpg?s=128&g=1", "display_name": "Topological Sort", "link": "https://stackoverflow.com/users/2216129/topological-sort"}, "edited": false, "score": 2, "creation_date": 1467167935, "post_id": 38089385, "comment_id": 63614754, "body": "What&#39;s your input?  And is it all on one line?  I also suggest you provide an <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> -- it can be very helpful, especially with these hard to trace errors."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1467242015, "post_id": 38089385, "comment_id": 63656629, "body": "when calling any of the <code>scanf()</code> family of functions, always check the returned value (not the parameter values)  to assure the operation was successful.    In the posted code the returned value should be 3,  Any other value indicates an error.   When using the &#39;%s&#39; format specifier, ALWAYS include a max-length modifier (that is one less that the length of the input buffer)"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1467242121, "post_id": 38089385, "comment_id": 63656660, "body": "these nested loops: <code>for(i=0; i&lt;30;i++){             for(j=0; j&lt;30;j++){             grid[i][j]=&#39;.&#39;;         }     }</code>  can be completely eliminated by changing this line: <code>int grid[30][30];</code> to: <code>int grid[30][30] = {{&#39;.&#39;}};</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1467242375, "post_id": 38089385, "comment_id": 63656736, "body": "regarding this line: <code>grid[x_coord][y_coord]=type[1];</code>   what will be set into the <code>grid[][]</code> will be a NUL byte (&#39;\\0&#39;)  Probably not what you want.  Also, what happens when the user enters values for <code>x_coord</code> and/or <code>y_coord</code> that are &gt;= 30?   What if the user enters a negative number?   I.E. never trust the user to do the right thing, always check anything a user enters."}], "answers": [{"tags": [], "owner": {"reputation": 4425, "user_id": 6277831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c21010f99314f291650d4cd9e3b2735?s=128&d=identicon&r=PG", "display_name": "lostbard", "link": "https://stackoverflow.com/users/6277831/lostbard"}, "is_accepted": false, "score": 1, "last_activity_date": 1467168768, "creation_date": 1467168768, "answer_id": 38089571, "question_id": 38089385, "link": "https://stackoverflow.com/questions/38089385/scanf-not-reading-second-arguement/38089571#38089571", "title": "scanf not reading second arguement", "body": "<p>Assuming you are entrering @X for the string, where X is some single character, scanf is going to attempt to fill type with '@' 'X' and '\\0'  (null byte added by scanf to mark the end of the string)</p>\n\n<p>That's 3 bytes being stored in array that is only big enough for two.</p>\n"}, {"tags": [], "owner": {"reputation": 720, "user_id": 5620762, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/N2xaP.jpg?s=128&g=1", "display_name": "Nutan", "link": "https://stackoverflow.com/users/5620762/nutan"}, "is_accepted": true, "score": 2, "last_activity_date": 1467170242, "creation_date": 1467170242, "answer_id": 38089786, "question_id": 38089385, "link": "https://stackoverflow.com/questions/38089385/scanf-not-reading-second-arguement/38089786#38089786", "title": "scanf not reading second arguement", "body": "<p>As you declared <code>char type[2];</code> and you are first entering <code>@</code> and then new character suppose <code>X</code> so in type it will go like this </p>\n\n<p><code>type[0] = @</code></p>\n\n<p><code>type [1]='\\0'</code></p>\n\n<p>so you should declare <code>char type[3];</code> this way \nso that</p>\n\n<p><code>type[0] = @</code></p>\n\n<p><code>type [1]='X'</code></p>\n\n<p><code>type [2]='\\0'</code></p>\n\n<p>it will stored this way and you can get X by accessing <code>type [1]</code></p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6501070"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 1, "accepted_answer_id": 38089786, "answer_count": 2, "score": 0, "last_activity_date": 1467170242, "creation_date": 1467167522, "last_edit_date": 1467169855, "question_id": 38089385, "link": "https://stackoverflow.com/questions/38089385/scanf-not-reading-second-arguement", "title": "scanf not reading second arguement", "body": "<p>I have the following code which I am trying to run. </p>\n\n<p>I want the <code>scanf</code> function to take in three different inputs, with the first two being integers between <code>0</code> and <code>30</code>, and the third a string beginning with <code>@</code>. </p>\n\n<p>The program compiles fine, but when I attempt to input the coordinates and the associated <code>@</code>symbol, I get a <code>0</code> in the <code>y</code> coordinate's place. </p>\n\n<p>Does anyone know why this is happening or what I can do to fix it? \nBelow is the code</p>\n\n<hr>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(){ \n    int grid[30][30];\n    int i, j;\n\n    for(i=0; i&lt;30;i++){    \n        for(j=0; j&lt;30;j++){\n            grid[i][j]='.';\n        }\n    }    \n\n    int x_coord;\n    int y_coord;\n    char type[2]; \n\n    scanf(\"%d %d %s\",&amp;x_coord,&amp;y_coord,type);\n\n    /*added extra whitespace*/\n    printf(\"%i  %i %s\",x_coord,y_coord,type);\n    printf(\"\\n\");\n\n    grid[x_coord][y_coord]=type[1];\n    //end outer loop \n\n    for(i=0; i&lt;30;i++){\n\n        for(j=0; j&lt;30;j++){\n            printf(\"%c\",grid[i][j]);\n        }\n        printf(\"\\n\");\n    }\n\n    return(0);\n}//end main\n</code></pre>\n"}, {"tags": ["python", "c", "swig"], "comments": [{"owner": {"reputation": 81653, "user_id": 168175, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/qxeUf.jpg?s=128&g=1", "display_name": "Flexo", "link": "https://stackoverflow.com/users/168175/flexo"}, "edited": false, "score": 0, "creation_date": 1467268478, "post_id": 38089206, "comment_id": 63663930, "body": "Pretty sure <code>%exception</code> is a red-herring for your use case and you want to do it all inside either <code>%typemap(out)</code> or even <code>%pythoncode</code> instead. I&#39;ll try and remember to write up a proper answer for you if nobody beats me to it."}, {"owner": {"reputation": 5, "user_id": 4914560, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-d1feBy5IiFY/AAAAAAAAAAI/AAAAAAAAAAA/uWnesr2e_zg/photo.jpg?sz=128", "display_name": "Jake Miller", "link": "https://stackoverflow.com/users/4914560/jake-miller"}, "reply_to_user": {"reputation": 81653, "user_id": 168175, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/qxeUf.jpg?s=128&g=1", "display_name": "Flexo", "link": "https://stackoverflow.com/users/168175/flexo"}, "edited": false, "score": 0, "creation_date": 1467327738, "post_id": 38089206, "comment_id": 63700150, "body": "Thanks Flexo. I&#39;ve tried <code>typemap(out)</code> and the problem with that is I have to re-implement the type handling, which I don&#39;t want to do for the <code>get_something</code> case. For the <code>get_something</code> case I just want to handle the exception but still process the type as it were."}, {"owner": {"reputation": 81653, "user_id": 168175, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/qxeUf.jpg?s=128&g=1", "display_name": "Flexo", "link": "https://stackoverflow.com/users/168175/flexo"}, "edited": false, "score": 0, "creation_date": 1467354436, "post_id": 38089206, "comment_id": 63707176, "body": "I see what you&#39;re concerned about, I&#39;ll have a think about it and show a few solutions then."}, {"owner": {"reputation": 81653, "user_id": 168175, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/qxeUf.jpg?s=128&g=1", "display_name": "Flexo", "link": "https://stackoverflow.com/users/168175/flexo"}, "edited": false, "score": 0, "creation_date": 1467662914, "post_id": 38089206, "comment_id": 63808719, "body": "Random comment: are you trying to emulate OO behaviour with this series of functions with an implicit <code>this</code> parameter as the first argument on all of them? There&#39;s probably something neater you could do in your Python interface to save Python developers even caring that C isn&#39;t really OO if you wanted. (But that would be another question)"}, {"owner": {"reputation": 5, "user_id": 4914560, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-d1feBy5IiFY/AAAAAAAAAAI/AAAAAAAAAAA/uWnesr2e_zg/photo.jpg?sz=128", "display_name": "Jake Miller", "link": "https://stackoverflow.com/users/4914560/jake-miller"}, "reply_to_user": {"reputation": 81653, "user_id": 168175, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/qxeUf.jpg?s=128&g=1", "display_name": "Flexo", "link": "https://stackoverflow.com/users/168175/flexo"}, "edited": false, "score": 0, "creation_date": 1467759783, "post_id": 38089206, "comment_id": 63851882, "body": "@Flexo Not exactly. My application here is that I have a C API that uses objects underneath. The important part is that I want to present the C API with an almost as-is usage to Python. Python will use <a href=\"https://docs.python.org/2/c-api/capsule.html\" rel=\"nofollow noreferrer\">PyCapsule</a>s to pass this opaque object back and forth between the C API and Python layers. All functions will be <a href=\"https://en.wikipedia.org/wiki/Mutator_method\" rel=\"nofollow noreferrer\">mutator/accessor</a> methods to maintain the opaqueness. So I want this as-is-ness with the ability to use the <a href=\"https://en.wikiquote.org/wiki/Grace_Hopper\" rel=\"nofollow noreferrer\">EAFP</a> principle."}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 4914560, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-d1feBy5IiFY/AAAAAAAAAAI/AAAAAAAAAAA/uWnesr2e_zg/photo.jpg?sz=128", "display_name": "Jake Miller", "link": "https://stackoverflow.com/users/4914560/jake-miller"}, "edited": false, "score": 0, "creation_date": 1467815978, "post_id": 38191420, "comment_id": 63875487, "body": "Thanks! This is exactly what I needed. Your last &quot;typemap by hand&quot; is what I like the best. I&#39;m glad there&#39;s a way to get all that information through the automatic variables. Thanks for providing the alternatives as well; they will most definitely come in handy. Amazing answer!"}], "tags": [], "owner": {"reputation": 81653, "user_id": 168175, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/qxeUf.jpg?s=128&g=1", "display_name": "Flexo", "link": "https://stackoverflow.com/users/168175/flexo"}, "is_accepted": true, "score": 0, "last_activity_date": 1467661847, "creation_date": 1467661847, "answer_id": 38191420, "question_id": 38089206, "link": "https://stackoverflow.com/questions/38089206/how-do-i-use-swig-to-return-specific-exceptions-based-on-c-function-return-type/38191420#38191420", "title": "How do I use SWIG to return specific exceptions based on C function return type?", "body": "<p>To help answer this question I took your functions and created the following test.h file that included enough real code to actually illustrate the problem:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>struct object { int bar; };\n\nstatic int do_something(struct object *with_this) { \n  errno = EACCES;\n  return -1; \n}\n\nstatic struct object *get_something(struct object *from_this) {\n  errno = EAGAIN;\n  return NULL;\n}\n</code></pre>\n\n<p>I'm fairly sure that <code>%typemap(out)</code> is the place to write this code in, not <code>%exception</code>, because the behaviour you want is determined by the return type, not the name of the function called. The fact that you also care about the value of the return further backs this up. You can to some degree avoid repetition using <code>$typemap</code> to reference other typemaps within yours.</p>\n\n<p>So I wrote a little SWIG interface to illustrate this:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>%module test\n\n%{\n#include &lt;errno.h&gt;\n#include \"test.h\"\n%}\n\n%typemap(out) int do_something %{\n  if ($1 &lt; 0) {\n    PyErr_SetFromErrno(PyExc_RuntimeError);\n    SWIG_fail;    \n  }\n  $result = Py_None; // Return only controls exception\n  Py_INCREF($result);\n%}\n\n%typemap(out) struct object *get_something %{\n  if (!$1) {\n    PyErr_SetFromErrno(PyExc_RuntimeError);\n    SWIG_fail; \n  }\n\n  // Return passed through unless NULL\n  $typemap(out,$1_ltype);\n%}\n\n%include \"test.h\"\n</code></pre>\n\n<p>Which worked when tested:</p>\n\n<pre><code>Python 2.7.6 (default, Jun 22 2015, 17:58:13) \n[GCC 4.8.2] on linux2\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\n&gt;&gt;&gt; import test\n&gt;&gt;&gt; test.do_something(None)\nTraceback (most recent call last):\n  File \"&lt;stdin&gt;\", line 1, in &lt;module&gt;\nRuntimeError: (13, 'Permission denied')\n&gt;&gt;&gt; test.get_something(None)\nTraceback (most recent call last):\n  File \"&lt;stdin&gt;\", line 1, in &lt;module&gt;\nRuntimeError: (11, 'Resource temporarily unavailable')\n&gt;&gt;&gt; \n</code></pre>\n\n<p>This only worked though because I explicitly named <code>do_something</code> when matching the typemap, so the fallback without the named function is fine. If you just try to remove that restriction you'll get an error about recursive typemaps. You can work around that using <code>%apply</code>, e.g. </p>\n\n<pre class=\"lang-c prettyprint-override\"><code>%typemap(out) struct object * MY_NULL_OR_ERRNO %{\n  if (!$1) {\n    PyErr_SetFromErrno(PyExc_RuntimeError);\n    SWIG_fail;\n  }\n\n  $typemap(out,$1_ltype);\n%}\n\n%apply struct object * MY_NULL_OR_ERRNO { struct object *get_something, struct object *some_other_function };\n</code></pre>\n\n<p>If that's too painful you can of course just write the typemap by hand:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>%typemap(out) struct object * %{\n  if (!$1) {\n    PyErr_SetFromErrno(PyExc_RuntimeError);\n    SWIG_fail;\n  }\n\n  $result = SWIG_NewPointerObj(SWIG_as_voidptr($1), $1_descriptor, $owner);\n%}\n</code></pre>\n\n<p>Which seems the simplest option if you really want that <em>everywhere</em> a <code>struct object*</code> gets returned.</p>\n\n<p>There are other possible solutions using <code>%pythoncode</code> or <code>%pythonappend</code>, but neither of them are really improvements over the above in my view.</p>\n"}], "owner": {"reputation": 5, "user_id": 4914560, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-d1feBy5IiFY/AAAAAAAAAAI/AAAAAAAAAAA/uWnesr2e_zg/photo.jpg?sz=128", "display_name": "Jake Miller", "link": "https://stackoverflow.com/users/4914560/jake-miller"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 212, "favorite_count": 0, "accepted_answer_id": 38191420, "answer_count": 1, "score": 0, "last_activity_date": 1467661847, "creation_date": 1467166251, "question_id": 38089206, "link": "https://stackoverflow.com/questions/38089206/how-do-i-use-swig-to-return-specific-exceptions-based-on-c-function-return-type", "title": "How do I use SWIG to return specific exceptions based on C function return type?", "body": "<p>Here are examples of functions in my C API:</p>\n\n<pre><code>int do_something(struct object *with_this)\nstruct object *get_something(struct object *from_this)\n</code></pre>\n\n<p><code>do_something</code> will return <code>0</code> for success or <code>-1</code> and set <code>errno</code> for failure. <code>get_something</code> will return a valid pointer on success or <code>NULL</code> and set <code>errno</code> for failure.</p>\n\n<p>I'm using to SWIG 2.0 to generate python bindings. For the <code>do_something</code> binding I'd like it to return an exception based on <code>errno</code> if it fails and return the Python <code>None</code> object if it succeeds. For the <code>get_something</code> binding I'd like it to return an exception based on <code>errno</code> if it fails and the opaque object if it succeeds.</p>\n\n<p>The question is how do I get SWIG to do all of this magic for me?</p>\n\n<p>Currently I'm using SWIG 2.0.</p>\n\n<p>I can use <code>%exception</code> and define different exceptions per symbol, but I'd like it to be based on return type. I'll have a lot of the API functions and I don't want to list them out. So I can do this for each symbol:</p>\n\n<pre><code>%exception do_something {\n    $action\n    if (result &lt; 0) {\n        return PyErr_SetFromErrno(PyExc_RuntimeError);\n    }\n}\n\n%exception get_something {\n    $action\n    if (result == NULL) {\n        return PyErr_SetFromErrno(PyExc_RuntimeError);\n    }\n}\n</code></pre>\n\n<p>It would be a lot better if I could do something like this (like you can do with <code>%typemap</code>):</p>\n\n<pre><code>%exception int {\n    $action\n    if (result &lt; 0) {\n        return PyErr_SetFromErrno(PyExc_RuntimeError);\n    }\n}\n\n%exception struct object * {\n    $action\n    if (result == NULL) {\n        return PyErr_SetFromErrno(PyExc_RuntimeError);\n    }\n}\n</code></pre>\n\n<p>Can I do something like this? If I had something like this, then that would take care of the exceptions. And I believe my <code>get_something</code> binding would be perfect.</p>\n\n<p>My <code>do_something</code> binding would still need something like this to get it to return the Python None object if I use <code>%typemap</code>:</p>\n\n<pre><code>%typemap(out) int {\n    $result = Py_BuildValue(\"\");\n}\n</code></pre>\n\n<p>Does the magic I'm looking for exist or am I going about this all wrong? Is there a better way to do this?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 33990, "user_id": 14768, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/b6aMa.png?s=128&g=1", "display_name": "Joshua", "link": "https://stackoverflow.com/users/14768/joshua"}, "edited": false, "score": 1, "creation_date": 1467165898, "post_id": 38089066, "comment_id": 63614266, "body": "what function is size()?"}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1467165905, "post_id": 38089066, "comment_id": 63614270, "body": "What does the debugger tell you when you step through the code?"}, {"owner": {"reputation": 715, "user_id": 6393524, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54040f367d9a215baf4dc960df2119b9?s=128&d=identicon&r=PG&f=1", "display_name": "Peter M.", "link": "https://stackoverflow.com/users/6393524/peter-m"}, "edited": false, "score": 3, "creation_date": 1467166249, "post_id": 38089066, "comment_id": 63614343, "body": "Try some test cases with strings like 123456 and 12345. Use both odd and even lengths of strings and think how the loop should proceed in either case. Check that the size() function call is giving the right result. Or is there a more reliable call like strlen(). At first glance that first access of temp = str[k] in the loop doesn&#39;t look right, if k is the number of chars in the string and the array access is zero based. The last element should be k-1."}, {"owner": {"reputation": 2988, "user_id": 452414, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/rDMfs.png?s=128&g=1", "display_name": "babon", "link": "https://stackoverflow.com/users/452414/babon"}, "edited": false, "score": 0, "creation_date": 1467176045, "post_id": 38089066, "comment_id": 63616775, "body": "Is <code>size()</code> working as expected? If I have <code>str = &quot;adam&quot;</code>, does your <code>size()</code> function return <code>3</code>? It seems you are using the return value of <code>size()</code> to index into <code>str</code>."}], "answers": [{"tags": [], "owner": {"reputation": 33990, "user_id": 14768, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/b6aMa.png?s=128&g=1", "display_name": "Joshua", "link": "https://stackoverflow.com/users/14768/joshua"}, "is_accepted": false, "score": 3, "last_activity_date": 1467165956, "creation_date": 1467165956, "answer_id": 38089163, "question_id": 38089066, "link": "https://stackoverflow.com/questions/38089066/so-i-am-having-trouble-reversing-my-string-it-reverses-everything-but-something/38089163#38089163", "title": "So I am having trouble reversing my string, it reverses everything but something weird happens in the middle", "body": "<p>The problem is here:</p>\n\n<pre><code>     if(len==k){\n       break;\n        }\n</code></pre>\n\n<p>This breaks the loop one cycle too soon.</p>\n"}, {"tags": [], "owner": {"reputation": 1163, "user_id": 1447013, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/28LZ2.jpg?s=128&g=1", "display_name": "Daniel Rudy", "link": "https://stackoverflow.com/users/1447013/daniel-rudy"}, "is_accepted": false, "score": 0, "last_activity_date": 1467168272, "creation_date": 1467168272, "answer_id": 38089494, "question_id": 38089066, "link": "https://stackoverflow.com/questions/38089066/so-i-am-having-trouble-reversing-my-string-it-reverses-everything-but-something/38089494#38089494", "title": "So I am having trouble reversing my string, it reverses everything but something weird happens in the middle", "body": "<p>An alternative way would be this:</p>\n\n<pre><code>void reverse(char *str)\n  {\n    char temp;      /* Temp Variable */\n    int i;          /* Loop Counter */\n    int ltc;        /* Loop Terminus Count */\n    int len;        /* String Length */\n\n    len = strlen(str);\n    ltc = len &gt;&gt; 1;\n    len--;\n\n    for (i = 0; i &lt; ltc; i++)\n      {\n        temp = str[i];\n        str[i] = str[len - i];\n        str[len - i] = temp;\n      }\n  }\n</code></pre>\n\n<p>This will work.  I use this exact code when I need to reverse a string for some reason.  The reason for <code>len--</code> is so that you don't swap the NULL byte.  The line <code>ltc = len &gt;&gt; 1</code> is a quick and dirty divide by 2, without using an actual divide, but a shift left.</p>\n\n<p>As for your code, you don't really need the if statement there because the loop will already terminate when it reaches halfway down the string, same with mine.</p>\n"}, {"tags": [], "owner": {"reputation": 484, "user_id": 6490242, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26613036fd92e6ee9e1ce9b64037069d?s=128&d=identicon&r=PG&f=1", "display_name": "Twinkle", "link": "https://stackoverflow.com/users/6490242/twinkle"}, "is_accepted": false, "score": 0, "last_activity_date": 1467175285, "creation_date": 1467175285, "answer_id": 38090533, "question_id": 38089066, "link": "https://stackoverflow.com/questions/38089066/so-i-am-having-trouble-reversing-my-string-it-reverses-everything-but-something/38090533#38090533", "title": "So I am having trouble reversing my string, it reverses everything but something weird happens in the middle", "body": "<p>This will work</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nvoid reverse(char* str);\n\nint main()\n{\n    reverse(\"Hello, World!\\n\");\n    return 0;\n}\n\nvoid reverse(char* str)\n{\n   char temp;\n   int i = 0;\n   int j = strlen(str) - 1;\n\n   while (i &lt; j) {\n      temp = str[i];\n      str[i] = str[j];\n      str[j] = temp;\n      i++;\n      j--;\n   }\n    printf(\"%s\\n\", str);\n    return;\n }//reverse\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 4744215, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6fe3b07748ff80d2fe1e33903b666b73?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Soto", "link": "https://stackoverflow.com/users/4744215/christian-soto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1467175285, "creation_date": 1467165372, "last_edit_date": 1467167997, "question_id": 38089066, "link": "https://stackoverflow.com/questions/38089066/so-i-am-having-trouble-reversing-my-string-it-reverses-everything-but-something", "title": "So I am having trouble reversing my string, it reverses everything but something weird happens in the middle", "body": "<pre><code>void reverse(char str[]){\n    char temp;\n    int i;\n    int k = size(str);\n    int len = size(str)/2;\n\n    for(i= 0; i&lt;len; i++){\n         temp = str[k];\n         str[k] = str[i];\n         str[i] = temp;\n         k--;\n         if(len==k){\n           break;\n            }\n    }//for loop\n    printf(\"%s\\n\", str);\n }//reverse\n</code></pre>\n\n<p>for string\n\"Chrisitian is my name\"\nI keep getting\n\"eman ym s inaitsirhC\"</p>\n\n<p>the problem is with the space and 'i' in \"is\".</p>\n\n<p>It might be the way i am reading in the string or my for loops.</p>\n\n<p>size(str[]) just returns the size of the string.</p>\n"}, {"tags": ["c", "pointers", "malloc"], "comments": [{"owner": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "edited": false, "score": 3, "creation_date": 1467165113, "post_id": 38088732, "comment_id": 63614058, "body": "This only works if <code>aligned</code> is a power of 2 and it assumes your alignment is at least as large as required for <code>void*</code>."}, {"owner": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "edited": false, "score": 2, "creation_date": 1467165667, "post_id": 38088732, "comment_id": 63614219, "body": "Also: <code>size_t</code> (in the  line that sets <code>p2</code>) should be <code>uintptr_t</code>. There&#39;s no guarantee that <code>size_t</code> is large enough to represent pointer values."}, {"owner": {"reputation": 1163, "user_id": 1447013, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/28LZ2.jpg?s=128&g=1", "display_name": "Daniel Rudy", "link": "https://stackoverflow.com/users/1447013/daniel-rudy"}, "edited": false, "score": 0, "creation_date": 1467170124, "post_id": 38088732, "comment_id": 63615236, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/227897/how-to-allocate-aligned-memory-only-using-the-standard-library\">How to allocate aligned memory only using the standard library?</a>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 1163, "user_id": 1447013, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/28LZ2.jpg?s=128&g=1", "display_name": "Daniel Rudy", "link": "https://stackoverflow.com/users/1447013/daniel-rudy"}, "edited": false, "score": 0, "creation_date": 1467208270, "post_id": 38088732, "comment_id": 63637067, "body": "@Daniel Rudy  Proposed duplicate does well answer how to <i>allocate</i> aligned memory.  It does not address nor answer how to free that memory like this code attempts to do.  In the proposed dupe, free&#39;ing is done with the original pointer and its storage is not detailed.  Here, code attempts to save/recover the original pointer in the allocated block."}, {"owner": {"reputation": 3198, "user_id": 1636521, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/2116626f42d8a2f87ee420ecefb1ec0c?s=128&d=identicon&r=PG", "display_name": "flashburn", "link": "https://stackoverflow.com/users/1636521/flashburn"}, "reply_to_user": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "edited": false, "score": 0, "creation_date": 1467223869, "post_id": 38088732, "comment_id": 63647873, "body": "@PaulHankin In your first comment you said:  <code>it assumes your alignment is at least as large as required for void*</code>. I&#39;m not sure I understand this statement. Can you elaborate more?"}, {"owner": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "edited": false, "score": 0, "creation_date": 1467243682, "post_id": 38088732, "comment_id": 63657139, "body": "@flashburn The line <code>p2[-1] = p1</code> requires that <code>p2</code> is aligned to whatever value is required to write <code>void*</code> values through it. But looking at the code again, I think I was mistaken that this alignment breaks if <code>aligned</code> is less than this value: <code>p2</code> always ends up with the same alignment guarantees as <code>malloc</code>."}], "answers": [{"comments": [{"owner": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "edited": false, "score": 1, "creation_date": 1467165397, "post_id": 38089003, "comment_id": 63614145, "body": "It can be useful: aligning data with cache lines, and preparing data for weird hardware (eg: some specialist graphics hardware) are two that I&#39;ve seen in the real world."}, {"owner": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "edited": false, "score": 3, "creation_date": 1467165535, "post_id": 38089003, "comment_id": 63614183, "body": "You might note in 2 that <code>alignment</code> must be a power of 2. Personally, I&#39;d just use <code>%</code> rather than bit-twiddling here -- <code>malloc</code> is already relatively expensive and an extra divide isn&#39;t going to make any performance difference."}], "tags": [], "owner": {"reputation": 205167, "user_id": 4323, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/qqgFU.png?s=128&g=1", "display_name": "John Zwinck", "link": "https://stackoverflow.com/users/4323/john-zwinck"}, "is_accepted": false, "score": 13, "last_activity_date": 1467206897, "last_edit_date": 1467206897, "creation_date": 1467165021, "answer_id": 38089003, "question_id": 38088732, "link": "https://stackoverflow.com/questions/38088732/explanation-to-aligned-malloc-implementation/38089003#38089003", "title": "explanation to aligned malloc implementation", "body": "<ol>\n<li><p>You need an offset if you want to support alignments beyond what your system's <code>malloc()</code> does.  For example if your system <code>malloc()</code> aligns to 8 byte boundaries, and you want to align to 16 bytes, you ask for 15 bytes extra so you know for sure you can shift the result around to align it as requested.  You also add <code>sizeof(void*)</code> to the size you pass to <code>malloc()</code> to leave room for bookkeeping.</p></li>\n<li><p><code>~(alignment - 1)</code> is what guarantees the alignment.  For example if alignment is 16, then subtract 1 to get 15, aka 0xF, then negating it makes 0xFF..FF0 which is the mask you need to satisfy the alignment for any returned pointer from <code>malloc()</code>.  Note that this trick assumes alignment is a power of 2 (which practically it normally would be, but there really should be a check).</p></li>\n<li><p>It's a <code>void**</code>.  The function returns <code>void*</code>.  This is OK because a pointer to void is \"A pointer to any type,\" and in this case that type is <code>void*</code>.  In other words, converting <code>void*</code> to and from other pointer types is allowed, and a double-pointer is still a pointer.</p></li>\n<li><p>The overall scheme here is to store the original pointer before the one that's returned to the caller.  Some implementations of standard <code>malloc()</code> do the same thing: stash bookkeeping information before the returned block.  This makes it easy to know how much space to reclaim when <code>free()</code> is called.</p></li>\n</ol>\n\n<p>All that said, this sort of thing is usually not useful, because the standard <code>malloc()</code> returns the largest alignment on the system.  If you need alignment beyond that, there may be other solutions, including compiler-specific attributes.</p>\n"}, {"comments": [{"owner": {"reputation": 3198, "user_id": 1636521, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/2116626f42d8a2f87ee420ecefb1ec0c?s=128&d=identicon&r=PG", "display_name": "flashburn", "link": "https://stackoverflow.com/users/1636521/flashburn"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1467218104, "post_id": 38089104, "comment_id": 63644396, "body": "@chux What does UB abbreviation mean?"}, {"owner": {"reputation": 3198, "user_id": 1636521, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/2116626f42d8a2f87ee420ecefb1ec0c?s=128&d=identicon&r=PG", "display_name": "flashburn", "link": "https://stackoverflow.com/users/1636521/flashburn"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1467224144, "post_id": 38089104, "comment_id": 63648056, "body": "@chux Do you mind elaborating more on why void** needs to be aligned. Why for this case it needs to be aligned? I think a concrete example might help."}, {"owner": {"reputation": 3198, "user_id": 1636521, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/2116626f42d8a2f87ee420ecefb1ec0c?s=128&d=identicon&r=PG", "display_name": "flashburn", "link": "https://stackoverflow.com/users/1636521/flashburn"}, "edited": false, "score": 0, "creation_date": 1467224316, "post_id": 38089104, "comment_id": 63648201, "body": "@James K. Lowden I&#39;m still unclear why returning a double pointer from a function that should return only a single pointer is not causing an error. Do  you mind elaborating more on this. It looks like I&#39;m missing something crucial about C but I can&#39;t quite understand what it is."}, {"owner": {"reputation": 3198, "user_id": 1636521, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/2116626f42d8a2f87ee420ecefb1ec0c?s=128&d=identicon&r=PG", "display_name": "flashburn", "link": "https://stackoverflow.com/users/1636521/flashburn"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1467226338, "post_id": 38089104, "comment_id": 63649414, "body": "@chux I don&#39;t even get it if it is aligned for <code>char **</code> Can you elaborate why it needs to be aligned for <code>char **</code>"}, {"owner": {"reputation": 3198, "user_id": 1636521, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/2116626f42d8a2f87ee420ecefb1ec0c?s=128&d=identicon&r=PG", "display_name": "flashburn", "link": "https://stackoverflow.com/users/1636521/flashburn"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1467229559, "post_id": 38089104, "comment_id": 63651166, "body": "@chux <code>That value must be aligned for a char *</code>. Can you explain why <code>char *</code> should be aligned? Why not <code>int *</code> or just <code>int</code> or why not <code>short *</code>, why specifically <code>char *</code>?"}, {"owner": {"reputation": 3198, "user_id": 1636521, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/2116626f42d8a2f87ee420ecefb1ec0c?s=128&d=identicon&r=PG", "display_name": "flashburn", "link": "https://stackoverflow.com/users/1636521/flashburn"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1467229734, "post_id": 38089104, "comment_id": 63651251, "body": "@chux to move a discussion to chat we need to be prompted to do that. I&#39;m not sure how to do it without it. I guess we could post more messages and then simply delete them."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 3198, "user_id": 1636521, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/2116626f42d8a2f87ee420ecefb1ec0c?s=128&d=identicon&r=PG", "display_name": "flashburn", "link": "https://stackoverflow.com/users/1636521/flashburn"}, "edited": false, "score": 0, "creation_date": 1467233359, "post_id": 38089104, "comment_id": 63653096, "body": "@flashburn Chat in <a href=\"http://chat.stackoverflow.com/rooms/116018/alignment-requirements-in-c\">chat.stackoverflow.com/rooms/116018/alignment-requirements-i&zwnj;&#8203;n-c</a>"}], "tags": [], "owner": {"reputation": 6544, "user_id": 451601, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/164602d512ce01f188e5a50593b46c5f?s=128&d=identicon&r=PG", "display_name": "James K. Lowden", "link": "https://stackoverflow.com/users/451601/james-k-lowden"}, "is_accepted": false, "score": 2, "last_activity_date": 1467165627, "creation_date": 1467165627, "answer_id": 38089104, "question_id": 38088732, "link": "https://stackoverflow.com/questions/38088732/explanation-to-aligned-malloc-implementation/38089104#38089104", "title": "explanation to aligned malloc implementation", "body": "<blockquote>\n  <p>implementation does work</p>\n</blockquote>\n\n<p>Perhaps, but I wouldn't be too sure.  IMO you'd be better off working from first principles.  Right off the bat, </p>\n\n<pre><code>p1 = (void*)malloc\n</code></pre>\n\n<p>is a red flag.  <code>malloc</code> returns <code>void</code>.  In C, any pointer can be assigned from <code>void *</code>.  Casting from <code>malloc</code> is usually considered bad form because any effect it has can only be bad.   </p>\n\n<blockquote>\n  <p>Why we need an offset</p>\n</blockquote>\n\n<p>The offset provides room to stash the pointer returned by <code>malloc</code>, used later by <code>free</code>.  </p>\n\n<p><code>p1</code> is retrieved from <code>malloc</code>.  Later, it has to be provide to <code>free</code> to be released.  <code>aligned_malloc</code> reserves <code>sizeof(void*)</code> bytes at <code>p1</code>, stashes <code>p1</code> there, and returns <code>p2</code> (the first \"aligned\" address in the block that <code>p1</code> points to).  Later, when the caller passes <code>p2</code> to <code>aligned_free</code>, it converts <code>p2</code> in effect to <code>void *p2[]</code>, and fetches the original <code>p1</code> using -1 as an index.  </p>\n\n<blockquote>\n  <p>What does anding with ~(alignment - 1) accomplish</p>\n</blockquote>\n\n<p>It's what puts <code>p2</code> on the boundary.  Say alignment is 16; <code>alignment -1</code> is 15, 0xF.  <code>~OxF</code> is all bits on except the last 4.  For any pointer <code>P</code>, <code>P &amp; ~0xF</code> will be a multiple of 16.  </p>\n\n<blockquote>\n  <p><code>p2</code> is a double pointer.</p>\n</blockquote>\n\n<p>pointer <em>schmointer</em>.  <code>malloc</code> returns <code>void*</code>.  It's a block of memory; you address it as you will.  You wouldn't blink at </p>\n\n<pre><code>char **args = calloc(7, sizeof(char*));\n</code></pre>\n\n<p>to allocate an array of 7 <code>char *</code> pointers, would you?  The code picks some \"aligned\" location at least <code>sizeof(void*)</code> bytes from <code>p1</code> and, for the purposes of <code>free</code>, treats it as <code>void **</code>.  </p>\n\n<blockquote>\n  <p>What is the general approach</p>\n</blockquote>\n\n<p>There is no one answer.  Best is probably to use a standard (or popular) library.  If you build atop <code>malloc</code>, allocating enough to keep the \"real\" pointer and returning an aligned one is pretty standard, although I would code it differently.  The syscall <code>mmap</code> returns a page-aligned pointer, which will satisfy most criteria for \"aligned\".  Depending on need, that might be better or worse than piggybacking on <code>malloc</code>.  </p>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1467207679, "post_id": 38089747, "comment_id": 63636560, "body": "Code uses <code>free(((void**)p)[-1]);</code> to find the original pointer.  If &quot;do not cast free&quot; is followed, how would you code <code>aligned_free()</code>?"}, {"owner": {"reputation": 1163, "user_id": 1447013, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/28LZ2.jpg?s=128&g=1", "display_name": "Daniel Rudy", "link": "https://stackoverflow.com/users/1447013/daniel-rudy"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1578339620, "post_id": 38089747, "comment_id": 105399373, "body": "@chux-ReinstateMonica The way that I have done it is subtract the header size from the pointer to repoint it to the house keeping data block.  Then you can switch it to the free list using normal list routines."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1578340479, "post_id": 38089747, "comment_id": 105399724, "body": "How did code &quot;subtract the header size from the pointer&quot; without a cast?  Subtracting from <code>void *</code> is UB."}], "tags": [], "owner": {"reputation": 1163, "user_id": 1447013, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/28LZ2.jpg?s=128&g=1", "display_name": "Daniel Rudy", "link": "https://stackoverflow.com/users/1447013/daniel-rudy"}, "is_accepted": false, "score": 1, "last_activity_date": 1467170044, "last_edit_date": 1495541769, "creation_date": 1467170044, "answer_id": 38089747, "question_id": 38088732, "link": "https://stackoverflow.com/questions/38088732/explanation-to-aligned-malloc-implementation/38089747#38089747", "title": "explanation to aligned malloc implementation", "body": "<p>I have a few issues with this code.  I have compiled them into the below list:</p>\n\n<ol>\n<li><code>p1 = (void*)malloc</code>  You do not cast the return value of malloc.</li>\n<li><code>free(((void**)p)[-1]);</code>  You do not cast free.</li>\n<li><code>if ((p1 = (void*)malloc(required_bytes + offset)) == NULL)</code> Do not put an assignment inside the comparison of an if statement.  I know a lot of people do this, but in my mind, that is just bad form and makes the code more difficult to read.</li>\n</ol>\n\n<p>What they are doing here is storing the original pointer inside the allocated block.  That means that only the aligned pointer gets returned to the user.  The actual pointer that is returned by malloc, the user never sees.  You have to keep that pointer though because free needs it to unlink the block from the allocated list and put it on the free list.  At the head of every memory block, malloc puts some housekeeping information there.  Things such and next/prev pointers, size, allocation status, etc....  Some debug versions of malloc use guard words to check if something overflowed the buffer.  The alignment that is passed to the routine <strong>MUST</strong> be a power of 2.</p>\n\n<p>When I wrote my own version of malloc for use in a pooled memory allocator, the minimum block size that I used was 8 bytes.  So including the header for a 32-bit system, the total was 28 bytes (20 bytes for the header).  On a 64-bit system, it was 40 bytes (32 bytes for the header).  Most systems have increased performance when data is aligned to some address value (either 4 or 8 bytes on modern computer systems).  The reason for this is because the machine can grab the entire word in one bus cycle if it is aligned.  If not, then it requires two bus cycles to get the entire word, then it has to construct it.  This is why compilers align variables on either 4 or 8 bytes.  This means that the last 2 or 3 bits of the address bus are zero.</p>\n\n<p>I know that there are some hardware constraints which requires more alignment than the default 4 or 8.  Nvidia's CUDA system, if I remember correctly, requires things aligned to 256 bytes...and that's a hardware requirement.</p>\n\n<p>This has been asked before though.  See: <a href=\"https://stackoverflow.com/questions/227897/how-to-allocate-aligned-memory-only-using-the-standard-library\">How to allocate aligned memory only using the standard library?</a></p>\n\n<p>Hope this helps.</p>\n"}, {"tags": [], "owner": {"reputation": 3883, "user_id": 530424, "user_type": "registered", "accept_rate": 17, "profile_image": "https://i.stack.imgur.com/Xv2CA.jpg?s=128&g=1", "display_name": "elhadi dp \u0131p\u0250\u0265\u05df\u01dd", "link": "https://stackoverflow.com/users/530424/elhadi-dp-%c4%b1p%c9%90%c9%a5%d7%9f%c7%9d"}, "is_accepted": false, "score": 2, "last_activity_date": 1576589947, "last_edit_date": 1576589947, "creation_date": 1555513423, "answer_id": 55730709, "question_id": 38088732, "link": "https://stackoverflow.com/questions/38088732/explanation-to-aligned-malloc-implementation/55730709#55730709", "title": "explanation to aligned malloc implementation", "body": "<p>Suppose we need SZ bytes of aligned memory, let:</p>\n\n<pre><code>A is the alignment.\nW is the CPU word size.\nP is the memory returned by malloc.\nSZ is the requested number of bytes to be allocated.\n</code></pre>\n\n<p>we will return <strong>(P + Y)</strong> in which <strong>(P + Y) mod A = 0</strong></p>\n\n<p>So, we should save the original pointer <em>P</em> to be able to free the memory later.\nIn this case, we should allocate <strong>(SZ + W)</strong> bytes, but to let memory aligned, we will substruct <em>Z bytes</em> in which <strong>(P % A = Z)  => (Z \u2208 [0, A-1])</strong></p>\n\n<pre><code>So the total memory to be allocated is:  SZ + W + MAX(Z) = SZ + W + A - 1\n</code></pre>\n\n<p>The pointer to be returned is <strong>P + Y = P + W + MAX(Z) - (P + W + MAX(Z)) mod A</strong></p>\n\n<p><strong>WE HAVE: X - X mod A =  INT(X / A) * A = X &amp; ~(A - 1)</strong></p>\n\n<p>SO we can replace <strong>P + W + MAX(Z) - (P + W + MAX(Z)) mod A</strong> by <strong>(P + W + MAX(Z)) &amp; ~(A - 1)</strong></p>\n\n<pre><code>The memory to be returned is: (P + W + MAX(Z)) &amp; ~(A - 1) = (P + W + A - 1) &amp; ~(A - 1)\n</code></pre>\n"}], "owner": {"reputation": 3198, "user_id": 1636521, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/2116626f42d8a2f87ee420ecefb1ec0c?s=128&d=identicon&r=PG", "display_name": "flashburn", "link": "https://stackoverflow.com/users/1636521/flashburn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 19402, "favorite_count": 6, "answer_count": 4, "score": 15, "last_activity_date": 1576589947, "creation_date": 1467162823, "last_edit_date": 1495541308, "question_id": 38088732, "link": "https://stackoverflow.com/questions/38088732/explanation-to-aligned-malloc-implementation", "title": "explanation to aligned malloc implementation", "body": "<p>This is not homework, this is purely for my own personal education.</p>\n\n<p>I couldn't figure out how to implement an aligned malloc so looked online and found <a href=\"https://sites.google.com/site/ruslancray/lab/bookshelf/interview/ci/low-level/write-an-aligned-malloc-free-function\" rel=\"noreferrer\">this website</a>. For the ease of reading I will post the code below:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n\nvoid* aligned_malloc(size_t required_bytes, size_t alignment)\n{\n    void* p1; // original block\n    void** p2; // aligned block\n    int offset = alignment - 1 + sizeof(void*);\n    if ((p1 = (void*)malloc(required_bytes + offset)) == NULL)\n    {\n       return NULL;\n    }\n    p2 = (void**)(((size_t)(p1) + offset) &amp; ~(alignment - 1));\n    p2[-1] = p1;\n    return p2;\n}\n\nvoid aligned_free(void *p)\n{\n    free(((void**)p)[-1]);\n}\n\nvoid main (int argc, char *argv[])\n{\n    char **endptr;\n    int *p = aligned_malloc (100, strtol(argv[1], endptr, 10));\n\n    printf (\"%s: %p\\n\", argv[1], p);\n    aligned_free (p);\n}\n</code></pre>\n\n<p>The implementation does work, but I honestly can't figure out how it works.</p>\n\n<p>Here is what I can't understand:</p>\n\n<ol>\n<li>Why we need an offset?</li>\n<li>What does anding with <code>~(alignment - 1)</code> accomplish</li>\n<li><code>p2</code> is a double pointer. How come we can return it from a function that is supposed to return only a single pointer?</li>\n<li>What is the general approach to solve this problem?</li>\n</ol>\n\n<p>Any help is really appreciated.</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>This is not a duplicate of <a href=\"https://stackoverflow.com/questions/227897/how-to-allocate-aligned-memory-only-using-the-standard-library\">How to allocate aligned memory only using the standard library?</a> because I also need to know how to free aligned memory.</p>\n"}, {"tags": ["c++", "c", "macros", "variadic-macros"], "comments": [{"owner": {"reputation": 3771, "user_id": 5386374, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/fGuXb.png?s=128&g=1", "display_name": "Justin Time - Reinstate Monica", "link": "https://stackoverflow.com/users/5386374/justin-time-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1467163859, "post_id": 38088599, "comment_id": 63613784, "body": "I believe the syntax for using the GCC <code>##</code> comma-removal thing is as follows: <code>#define MACRO(X, ...) expansion(X, ##__VA_ARGS__)</code>.  It has to follow a comma, prefix <code>__VA_ARGS__</code> or named equivalent, and not be part of a stand-alone macro.  See <a href=\"https://gcc.gnu.org/onlinedocs/cpp/Variadic-Macros.html\" rel=\"nofollow noreferrer\">the documentation</a>."}, {"owner": {"reputation": 3771, "user_id": 5386374, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/fGuXb.png?s=128&g=1", "display_name": "Justin Time - Reinstate Monica", "link": "https://stackoverflow.com/users/5386374/justin-time-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1467164194, "post_id": 38088599, "comment_id": 63613853, "body": "Also, depending on the way the preprocessor views it, I would guess that <code>FUNCTION_WRAPPER is expanded before </code>VA_LIST`, so from its perspective it actually sees <i>zero</i> variadic argument lists."}, {"owner": {"reputation": 3771, "user_id": 5386374, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/fGuXb.png?s=128&g=1", "display_name": "Justin Time - Reinstate Monica", "link": "https://stackoverflow.com/users/5386374/justin-time-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1467164652, "post_id": 38088599, "comment_id": 63613958, "body": "Not sure if it&#39;s a valid approach (hence not posting an answer), but <a href=\"http://stackoverflow.com/a/13442057/5386374\">C requires the preprocessor to be capable of making a minimum of 4,095 passes</a>, so it should be entirely within any modern C/C++ compiler&#39;s ability to handle."}, {"owner": {"reputation": 4939, "user_id": 6292621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a024e1125c7f69a49d7f1a4861d7b63?s=128&d=identicon&r=PG&f=1", "display_name": "lorro", "link": "https://stackoverflow.com/users/6292621/lorro"}, "edited": false, "score": 0, "creation_date": 1467186887, "post_id": 38088599, "comment_id": 63622133, "body": "Suggested reading / #including: <a href=\"http://saadahmad.ca/cc-preprocessor-metaprogramming-lists-and-for_each/\" rel=\"nofollow noreferrer\">saadahmad.ca/cc-preprocessor-metaprogramming-lists-and-for_e&zwnj;&#8203;ach</a>"}], "owner": {"reputation": 538, "user_id": 1695375, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ae7204d93a1242e7c8c0d0c87ec90693?s=128&d=identicon&r=PG", "display_name": "doc07b5", "link": "https://stackoverflow.com/users/1695375/doc07b5"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 480, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1467161768, "creation_date": 1467161768, "question_id": 38088599, "link": "https://stackoverflow.com/questions/38088599/what-are-options-to-get-multiple-variable-lists-in-a-variadic-macro", "title": "What are options to get multiple variable lists in a variadic macro?", "body": "<p>I have been trying to use variadic macros to reduce redundant code in some SFINAE patterns I am using. Specifically, I would like to generate function definitions using variadic macros. (This question is not about SFINAE). For my application, I would like write a wrapper function that calls an existing member function. The actual application requires that I produce a templated struct with SFINAE specialization so there is some repetitive stuff that would be great to just have a macro take care of generating the struct and function. OK that is the motivation. </p>\n\n<p>The following example dispenses with all of the SFINAE stuff and simply defines a struct with three static functions (f0, f1, f2) with different parameter lists, and tries to call these functions through global macro generated function. Why would you want to do this?? You wouldn't. But this is just to illustrate the problem that I was having for the SFINAE application.</p>\n\n<pre><code>#include&lt;iostream&gt;\n\nstruct Foo\n{\n  static void f0()\n  {\n    std::cout&lt;&lt;\"f0() called\"&lt;&lt;std::endl;\n  }\n\n  static void f1(int a)\n  {\n    std::cout&lt;&lt;\"f1(\"&lt;&lt;a&lt;&lt;\") called\"&lt;&lt;std::endl;\n  }\n\n  static double f2(int a, double b)\n  {\n    std::cout&lt;&lt;\"f2(\"&lt;&lt;a&lt;&lt;\",\"&lt;&lt;b&lt;&lt;\") called\"&lt;&lt;std::endl;\n    return a*b;\n  }\n\n};\n\n#define VA_LIST(...) __VA_ARGS__\n\n#define FUNCTION_WRAPPER(NAME,RTYPE,PARAMS,ARGS)\\\nRTYPE NAME(PARAMS)\\\n{\\\n  return Foo::NAME(ARGS);\\\n}\n\nFUNCTION_WRAPPER(f0,void,VA_LIST(),VA_LIST())\nFUNCTION_WRAPPER(f1,void,VA_LIST(int a),VA_LIST(a))\nFUNCTION_WRAPPER(f2,double,VA_LIST(int a, double b), VA_LIST(a, b))\n\nint main()\n{\n  f0();\n  f1(1);\n  f2(1,4.2);\n  return 0;\n}\n</code></pre>\n\n<p>OK. So the <code>VA_LIST(...) __VA_ARGS__</code> enables the creation of a single variable list. The call:</p>\n\n<pre><code>FUNCTION_WRAPPER(f2,double,VA_LIST(int a, double b), VA_LIST(a, b))\n</code></pre>\n\n<p>utilizes to variable lists as argument 3 and 3. Note that the Parameter list and the Argument list have to be consistent with each other (i.e. variables passed in the Argument list better be declared in the Parameter list.</p>\n\n<p>This seems to work for this example, although there are issues if we were to try to add an fixed argument to beginning of the call (e.g. Foo::NAME(fixedArg, ARGS) ). It appears that the ##__VA_ARGS trick to swallow the comma if the variable list is empty doesn't work with this approach.</p>\n\n<p>So the questions I have is:</p>\n\n<ol>\n<li>While this approach seems to work properly on both gcc and clang, I can't find any similar examples that uses multiple variable lists in this manner...which makes me a little nervous. Is this a valid approach?</li>\n<li>So what is actually happening in this approach? How is the FUNCTION_WRAPPER  macro able to handle two variable lists? Are the PARAMS and ARGS macro arguments simply being expanded in the body of the macro, or is there something more complex happening here?</li>\n<li>Is there a way to use the ## trick to swallow preceding commas? Placing the ## preceding the PARAMS and ARGS values in the macro body result in a compilation error, as does placing the ## in the VA_LIST.</li>\n</ol>\n\n<p>Sample code for this last case is:</p>\n\n<pre><code>#define VA_LIST2(...) __VA_ARGS__\n#define FUNCTION_WRAPPER2(NAME,RTYPE,PARAMS,ARGS)\\\nRTYPE NAME##_2(PARAMS)\\\n{\\\n  return Foo::NAME(1,ARGS);\\\n}\nFUNCTION_WRAPPER2(f2,double,VA_LIST2(double b), VA_LIST2(b))\n</code></pre>\n\n<p>The error for the insertion of ## into the FUNCTION_WRAPPER body is</p>\n\n<pre><code> error: pasting \",\" and \"VA_LIST\" does not give a valid preprocessing token\n   return Foo::NAME(1,##ARGS);\\\n</code></pre>\n\n<p>The compilation error for the insertion of ## into the VA_LIST macro body is:</p>\n\n<pre><code>error: '##' cannot appear at either end of a macro expansion\n #define VA_LIST2(...) ##__VA_ARGS__\n                     ^\n</code></pre>\n"}, {"tags": ["c", "linux", "keyboard", "ioctl", "ubuntu-16.04"], "comments": [{"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 0, "creation_date": 1467266974, "post_id": 38088404, "comment_id": 63663266, "body": "Does <code>sudo evtest &#47;dev&#47;input&#47;event7</code> work? If it does, run <code>sudo strace evtest &#47;dev&#47;input&#47;event7 2&gt;&amp;1 | grep -e EVIOC</code> to see whether the ioctl also fails for <code>evtest</code>. It should not fail. The differences between <code>evtest</code> and your test program or <code>evmuxd</code> would be informative. If there are none, then there is something wonky with the actual in-kernel event device driver; in that case, the files <code>&#47;sys&#47;class&#47;input&#47;event7&#47;device&#47;name</code>, <code>&#47;sys&#47;class&#47;input&#47;event7&#47;device&#47;phys</code>, and <code>&#47;sys&#47;class&#47;input&#47;event7&#47;device&#47;uevent</code> would be helpful in describing the problematic input device."}], "owner": {"reputation": 2779, "user_id": 2500806, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/RZjRl.jpg?s=128&g=1", "display_name": "Khamidulla", "link": "https://stackoverflow.com/users/2500806/khamidulla"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1596, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1467160196, "creation_date": 1467160196, "question_id": 38088404, "link": "https://stackoverflow.com/questions/38088404/inappropriate-ioctl-eviocgrab-for-keyboard-device", "title": "Inappropriate ioctl (EVIOCGRAB) for &#39;keyboard&#39; device", "body": "<p>I am trying to debug <code>evmuxd</code> tool (physical keyboard multiplexer with switching support) from following <a href=\"https://github.com/lkundrak/btkbdd\" rel=\"nofollow\">github source.</a>I installed bluez library and successfully compiled source code. However when I try to run as man page suggest I am getting following error:</p>\n\n<pre><code>sudo evmuxd /dev/input/event7\nCould not grab keyboard for exclusive use: Inappropriate ioctl for device\n</code></pre>\n\n<p>From code below you can see that <code>ioctl (fd, EVIOCGRAB, 1)</code> returns error</p>\n\n<pre><code>#include &lt;linux/input.h&gt;\n#include &lt;linux/uinput.h&gt;\n\n#include &lt;fcntl.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;string.h&gt;\n\n#define UINPUT \"/dev/uinput\"\n\nstatic int\nopen_uinput (const char *name)\n{\n    int fd;\n    struct uinput_user_dev dev = { 0, };\n    int i;\n\n    fd = open (UINPUT, O_WRONLY | O_NDELAY);\n    if (fd == -1) {\n        perror (UINPUT);\n        return -1;\n    }\n\n    if (ioctl(fd, UI_SET_EVBIT, EV_KEY) == -1) {\n        perror (\"Could not enable key events\");\n        goto fail;\n    }\n\n    for (i = 0; i &lt; KEY_CNT; i++) {\n        if (ioctl(fd, UI_SET_KEYBIT, i) == -1) {\n            perror (\"Could not enable a key event\");\n            goto fail;\n        }\n    }\n\n    if (ioctl(fd, UI_SET_EVBIT, EV_REP) == -1) {\n        perror (\"Could not enable autorepeat events\");\n        goto fail;\n    }\n\n    strncpy (dev.name, name, UINPUT_MAX_NAME_SIZE);\n    dev.id.bustype = BUS_VIRTUAL;\n    dev.id.vendor  = 0x0666;\n    dev.id.product = 0x8086;\n    dev.id.version = 1;\n\n    if (write (fd, &amp;dev, sizeof (dev)) != sizeof (dev)) {\n        perror (UINPUT);\n        goto fail;\n    }\n\n    if (ioctl(fd, UI_DEV_CREATE) == -1) {\n        perror (\"Could not create the virtual keyboard\");\n        goto fail;\n    }\n\n    return fd;\nfail:\n    close (fd);\n    return -1;\n}\n\nstatic int\nopen_input (char *dev)\n{\n    int version;\n    int features;\n    int fd;\n    int norepeat[2] = { 0, 0 };\n\n    fd = open (dev, O_RDWR);\n    if (fd == -1) {\n        perror (dev);\n        return -1;\n    }\n\n    if (ioctl (fd, EVIOCGVERSION, &amp;version) == -1) {\n        perror (\"Could not read input protocol version\");\n        goto fail;\n    }\n    if (version &gt;&gt; 16 != EV_VERSION &gt;&gt; 16) {\n        fprintf (stderr, \"Bad input subsystem version\");\n        goto fail;\n    }\n\n    if (ioctl (fd, EVIOCGBIT(0, EV_MAX), &amp;features) == -1) {\n        perror (\"Could query device for supported features\");\n        goto fail;\n    }\n    if (!(features &amp; EV_KEY)) {\n        fprintf (stderr, \"Device not capable of producing key press event.\");\n        goto fail;\n    }\n\n    if (ioctl (fd, EVIOCGRAB, 1) == -1) {\n        perror (\"Could not grab keyboard for exclusive use\");\n        goto fail;\n    }\n\n    if (ioctl (fd, EVIOCSREP, norepeat) == -1) {\n        perror (\"Could not disable autorepeat\");\n        goto fail;\n    }\n\n    return fd;\nfail:\n    close (fd);\n    return -1;\n}\n\nint\nmain (int argc, char *argv[])\n{\n    int uinput[2], input;\n    struct input_event event;\n    int active = 0;\n    int switching = 0;\n\n    if (argc != 2) {\n        fprintf (stderr, \"Usage: %s /dev/input/event&lt;n&gt;\\n\", argv[0]);\n        return 1;\n    }\n\n    input = open_input (argv[1]);\n    if (input == -1)\n        return 1;\n\n    uinput[0] = open_uinput (\"evmuxd primary\");\n    if (uinput[0] == -1)\n        return 1;\n\n    uinput[1] = open_uinput (\"evmuxd secondary\");\n    if (uinput[1] == -1)\n        return 1;\n\n    while (1) {\n        switch (read (input, &amp;event, sizeof(event))) {\n        case -1:\n            perror (\"Error reading from event device\");\n            return 1;\n        case sizeof(event):\n            break;\n        default:\n            fprintf (stderr, \"Short read from the event device.\\n\");\n            return 1;\n        }\n\n        switch (write (uinput[active], &amp;event, sizeof(event))) {\n        case -1:\n            perror (\"Error forwarding the event\");\n            return 1;\n        case sizeof(event):\n            break;\n        default:\n            fprintf (stderr, \"Short write forwarding the event.\\n\");\n            return 1;\n        }\n\n        if (event.type == EV_KEY\n            &amp;&amp; event.code == KEY_SCROLLLOCK\n            &amp;&amp; event.value == 0) {\n            switching = 1;\n        }\n        if (event.type == EV_SYN &amp;&amp; switching) {\n            switching = 0;\n            active = !active;\n        }\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>So what is the problem and how I can fix it?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1467156044, "post_id": 38087590, "comment_id": 63611876, "body": "<a href=\"http://ideone.com/GbsQ3q\" rel=\"nofollow noreferrer\">ideone.com/GbsQ3q</a>"}, {"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 0, "creation_date": 1467158236, "post_id": 38087590, "comment_id": 63612438, "body": "1. Please sort out the indentation. 2, Use3 braces liberally - saves future problems"}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1467158652, "post_id": 38087590, "comment_id": 63612529, "body": "Do you know the difference between <code>*p = i;</code> and <code>p = &amp;i;</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 597, "user_id": 2558056, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0549be54a5ca0ad7babefe1271d7a681?s=128&d=identicon&r=PG", "display_name": "engineer14", "link": "https://stackoverflow.com/users/2558056/engineer14"}, "edited": false, "score": 0, "creation_date": 1467251532, "post_id": 38087701, "comment_id": 63658934, "body": "that would assign the same memory location to all of them, which would mean that later in that function, when he is trying to give them different values, he&#39;ll need to create a new memory location for each of those pointers."}, {"owner": {"reputation": 203, "user_id": 6524939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66c08308e85fe4e732ca7278a75ada7?s=128&d=identicon&r=PG&f=1", "display_name": "Robert", "link": "https://stackoverflow.com/users/6524939/robert"}, "reply_to_user": {"reputation": 597, "user_id": 2558056, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0549be54a5ca0ad7babefe1271d7a681?s=128&d=identicon&r=PG", "display_name": "engineer14", "link": "https://stackoverflow.com/users/2558056/engineer14"}, "edited": false, "score": 0, "creation_date": 1467333609, "post_id": 38087701, "comment_id": 63701677, "body": "If you look at his assignment, he writes  <code>max = p</code>. max and min will simply point to the max and min values in the array. Although after returning, big and small won&#39;t have changed at all, so I guess I did mess that up"}], "tags": [], "owner": {"reputation": 203, "user_id": 6524939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66c08308e85fe4e732ca7278a75ada7?s=128&d=identicon&r=PG&f=1", "display_name": "Robert", "link": "https://stackoverflow.com/users/6524939/robert"}, "is_accepted": false, "score": -3, "last_activity_date": 1467155867, "last_edit_date": 1467155867, "creation_date": 1467155345, "answer_id": 38087701, "question_id": 38087590, "link": "https://stackoverflow.com/questions/38087590/why-i-keep-getting-segfault-11-while-im-using-a-pointer-to-track-the-current-po/38087701#38087701", "title": "Why I keep getting Segfault 11 while I&#39;m using a pointer to track the current position in an array?", "body": "<p>In line two of <code>max_min</code> change your code to</p>\n\n<pre><code>max = min = p = a;\n</code></pre>\n\n<p>Memory's like a long row of lockers. When you declare <code>int *max;</code>, the variable <code>max</code> simply contains a locker number, the variable <code>*max</code> contains everything in this locker (which in this case is an int). An array is like a big row of lockers, <code>a[0]</code> is locker number a+0, <code>a[1]</code> is locker number a+1, and so on. You want to give p the value of a so when you increment it you get the next array index.</p>\n"}, {"tags": [], "owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "is_accepted": false, "score": 0, "last_activity_date": 1467158137, "last_edit_date": 1467158137, "creation_date": 1467157471, "answer_id": 38088020, "question_id": 38087590, "link": "https://stackoverflow.com/questions/38087590/why-i-keep-getting-segfault-11-while-im-using-a-pointer-to-track-the-current-po/38088020#38088020", "title": "Why I keep getting Segfault 11 while I&#39;m using a pointer to track the current position in an array?", "body": "<p>Okay, there were a few bugs. I've produced two versions. One annotated with the bugs and a second with things cleaned up.</p>\n\n<p>Here's the annotated version [please pardon the gratuitous style cleanup]:</p>\n\n<pre><code>/* Finds the largest and smallest elements in an array */\n#include &lt;stdio.h&gt;\n#define N 10\n\nvoid max_min(int a[], int n, int *max, int *min);\n\nint\nmain(void)\n{\n    int b[N],\n     i,\n    *big,\n    *small;\n\n    printf(\"Enter %d numbers: \", N);\n    for (i = 0; i &lt; N; i++)\n        scanf(\"%d\", &amp;b[i]);\n\n    // BUG1: big/small have not been initialized to point to anything\n    max_min(b, N, big, small);\n\n    printf(\"Largest: %d\\n\", *big);\n    printf(\"Smallest: %d\\n\", *small);\n\n    return 0;\n}\n\nvoid\nmax_min(int a[], int n, int *max, int *min)\n{\n    int *p;\n\n    // BUG2: because of BUG1 above, this will segfault\n    // BUG3: because p is never initialized, dereferencing it (via \"*p\") will\n    // segfault\n    *max = *min = *p = a[0];\n\n    // BUG4: this will run past the end of the \"a\" array because there is\n    // no guarantee of a matching sentinel value (i.e. EOF/-1)\n    // in fact, using a sentinel is wrong because the \"a\" array can have _any_\n    // value (i.e. there is _no_ sentinel value that can be used)\n    while (*p != EOF) {\n        // BUG5: when max or min gets set, we're changing what they point to\n        // but this will _not_ change caller's values\n        if (*p &gt; *max)\n            max = p;\n        else if (*p &lt; *min)\n            min = p;\n        p++;\n    }\n}\n</code></pre>\n\n<p>Here's a cleaned up and working version. In particular, note the change of <code>big/small</code> in main from <code>int *</code> to <code>int</code> with a corresponding change in the call to <code>max_min</code>:</p>\n\n<pre><code>/* Finds the largest and smallest elements in an array */\n#include &lt;stdio.h&gt;\n#define N 10\n\nvoid max_min(int a[], int n, int *max, int *min);\n\nint\nmain(void)\n{\n    int b[N],\n     i,\n    big,\n    small;\n\n    printf(\"Enter %d numbers: \", N);\n    for (i = 0; i &lt; N; i++)\n        scanf(\"%d\", &amp;b[i]);\n\n    max_min(b, N, &amp;big, &amp;small);\n\n    printf(\"Largest: %d\\n\", big);\n    printf(\"Smallest: %d\\n\", small);\n\n    return 0;\n}\n\nvoid\nmax_min(int a[], int n, int *max, int *min)\n{\n    int *p;\n    int val;\n\n    p = &amp;a[0];\n    *max = *min = *p;\n\n    for (int i = 0;  i &lt; n;  ++i, ++p) {\n        val = *p;\n        if (val &gt; *max)\n            *max = val;\n        else if (val &lt; *min)\n            *min = val;\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 6525750, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-38ElGaNu3hs/AAAAAAAAAAI/AAAAAAAACIE/PxaO00EGIas/photo.jpg?sz=128", "display_name": "Zhou", "link": "https://stackoverflow.com/users/6525750/zhou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1467158137, "creation_date": 1467154664, "question_id": 38087590, "link": "https://stackoverflow.com/questions/38087590/why-i-keep-getting-segfault-11-while-im-using-a-pointer-to-track-the-current-po", "title": "Why I keep getting Segfault 11 while I&#39;m using a pointer to track the current position in an array?", "body": "<p>I'm writing a program to find the max and mix value of a int array, and I', trying to avoid using a int to track the current position, but the program keeps throwing segfault 11. It won't go through the loop. What's the reason? </p>\n\n<pre><code>/* Finds the largest and smallest elements in an array */\n#include &lt;stdio.h&gt;\n#define N 10\n\nvoid max_min(int a[], int n, int *max, int *min);\n\nint main(void){\nint b[N], i, *big, *small;\nprintf(\"Enter %d numbers: \", N);\nfor (i = 0; i &lt; N; i++)\n   scanf(\"%d\", &amp;b[i]);\nmax_min(b, N, big, small);\nprintf(\"Largest: %d\\n\", *big);\nprintf(\"Smallest: %d\\n\", *small);\nreturn 0;\n}\n\nvoid max_min(int a[], int n, int *max, int *min){\n    int *p;\n    *max = *min = *p = a[0]; \n    while (*p != EOF) {\n        if (*p &gt; *max)\n           max = p;\n        else if (*p &lt; *min)\n           min = p;\n        p++;\n    } \n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1467154174, "post_id": 38087457, "comment_id": 63611338, "body": "<code>if(*x == &quot;ne&quot;)</code> is comparing the <code>char</code> <code>*x</code> to the address of <code>&quot;ne&quot;</code>.  Code needs to compare <code>char</code> to <code>char</code>, one at a time."}, {"owner": {"reputation": 242, "user_id": 3521385, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/unLde.jpg?s=128&g=1", "display_name": "Module", "link": "https://stackoverflow.com/users/3521385/module"}, "edited": false, "score": 0, "creation_date": 1467154203, "post_id": 38087457, "comment_id": 63611345, "body": "char * actually represents the memory address of the first character in each string. So you don&#39;t really want to be comparing the values of the pointers, but the contents they point to."}, {"owner": {"reputation": 1853, "user_id": 3029274, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/678505a60d20e850fb26b7bc12a440a0?s=128&d=identicon&r=PG&f=1", "display_name": "Maddy", "link": "https://stackoverflow.com/users/3029274/maddy"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1467154328, "post_id": 38087457, "comment_id": 63611387, "body": "@chux: I have been trying to do that. I have looked at articles online and they suggested me to use a loop. I understand I need to compare each character but I am not sure how to do so."}], "answers": [{"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": true, "score": 2, "last_activity_date": 1467155327, "last_edit_date": 1467155327, "creation_date": 1467154946, "answer_id": 38087643, "question_id": 38087457, "link": "https://stackoverflow.com/questions/38087457/comparing-char-to-string-without-strcmp/38087643#38087643", "title": "Comparing char* to string without strcmp", "body": "<p>OP's code nicely iterates through <code>x</code> ...</p>\n\n<pre><code>for(x; *x !='\\0'; x++){\n</code></pre>\n\n<p>... but then attempts to compare each <code>char</code> of <code>x</code> to the address of <code>\"ne\"</code>.</p>\n\n<pre><code>if(*x == \"ne\"){  // bad code\n</code></pre>\n\n<p>To compare the strings pointed by 2 <code>char *</code>, could make your own <code>strcmp()</code>.<br>\nNote the real <code>strcmp()</code> returns 0 when strings match or positive or negative values depending on which is \"greater\".  OP's seems to only need an equal or not comparison.</p>\n\n<pre><code>// Return 1 if the same\nint my_streq(const char *s1, const char *s2) {\n  while (*s1 == *s2 &amp;&amp; *s1) {\n    s1++;\n    s2++;\n  }\n  return *s1 == *s2;\n}\n\n\nint readinput(char * x) {\n  ....\n  if (my_streq(x, \"ne\")) {\n    printf(\"%d\",1);\n    return 0;\n  }\n  ....\n}\n</code></pre>\n"}], "owner": {"reputation": 1853, "user_id": 3029274, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/678505a60d20e850fb26b7bc12a440a0?s=128&d=identicon&r=PG&f=1", "display_name": "Maddy", "link": "https://stackoverflow.com/users/3029274/maddy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 314, "favorite_count": 0, "accepted_answer_id": 38087643, "answer_count": 1, "score": 0, "last_activity_date": 1467155749, "creation_date": 1467153857, "last_edit_date": 1467155749, "question_id": 38087457, "link": "https://stackoverflow.com/questions/38087457/comparing-char-to-string-without-strcmp", "title": "Comparing char* to string without strcmp", "body": "<p>I am trying to compare contents of char* to a string. I am able to print out the content but not able to compare them. </p>\n\n<pre><code>#include&lt;stdio.h&gt;\n\nint input(char * x){\n    int i,j = 0;\n    char myArray[10];\n    x = myArray;\n    scanf(\"%s\", x);\n\n    for(x; *x !='\\0'; x++){\n        if(*x == \"ne\"){\n            printf(\"%d\",1);\n            return 0;\n        }\n    } \n}\n</code></pre>\n"}, {"tags": ["c", "linux", "linux-device-driver", "dma", "iommu"], "comments": [{"owner": {"reputation": 80303, "user_id": 196561, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6836267883ea7234253b2100f222dbbc?s=128&d=identicon&r=PG", "display_name": "osgx", "link": "https://stackoverflow.com/users/196561/osgx"}, "edited": false, "score": 0, "creation_date": 1467156782, "post_id": 38087417, "comment_id": 63612079, "body": "What is your CPU and south bridge model? Are you sure they have IOMMU? Is IOMMU enabled for your device (Intel&#39;s VT-d may be enabled only for some ports)?"}, {"owner": {"reputation": 203, "user_id": 6524939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66c08308e85fe4e732ca7278a75ada7?s=128&d=identicon&r=PG&f=1", "display_name": "Robert", "link": "https://stackoverflow.com/users/6524939/robert"}, "reply_to_user": {"reputation": 80303, "user_id": 196561, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6836267883ea7234253b2100f222dbbc?s=128&d=identicon&r=PG", "display_name": "osgx", "link": "https://stackoverflow.com/users/196561/osgx"}, "edited": false, "score": 0, "creation_date": 1467157644, "post_id": 38087417, "comment_id": 63612311, "body": "The device has an iommu group assigned sometime during boot. Is there something else I need to check to make sure iommu is enabled for the device?"}, {"owner": {"reputation": 80303, "user_id": 196561, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6836267883ea7234253b2100f222dbbc?s=128&d=identicon&r=PG", "display_name": "osgx", "link": "https://stackoverflow.com/users/196561/osgx"}, "edited": false, "score": 0, "creation_date": 1467159782, "post_id": 38087417, "comment_id": 63612824, "body": "Robert, still, what is your HW? What about enabling pd_debug of <code>drivers&#47;iommu&#47;iommu.c</code> file? Why not <code>PFN_PHYS</code> but &lt;&lt;?"}, {"owner": {"reputation": 203, "user_id": 6524939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66c08308e85fe4e732ca7278a75ada7?s=128&d=identicon&r=PG&f=1", "display_name": "Robert", "link": "https://stackoverflow.com/users/6524939/robert"}, "reply_to_user": {"reputation": 80303, "user_id": 196561, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6836267883ea7234253b2100f222dbbc?s=128&d=identicon&r=PG", "display_name": "osgx", "link": "https://stackoverflow.com/users/196561/osgx"}, "edited": false, "score": 0, "creation_date": 1467160329, "post_id": 38087417, "comment_id": 63612968, "body": "CPUs a Haswell Xeon, not sure about the southbridge. Do you mean pr_debug? It&#39;s enabled and I&#39;m not getting anything in dmesg. And I didn&#39;t know about pfn_phys until just now"}, {"owner": {"reputation": 157, "user_id": 3657748, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e58ffd59014cd6d78cd04fb22cfda72d?s=128&d=identicon&r=PG&f=1", "display_name": "Chaitanya Lala", "link": "https://stackoverflow.com/users/3657748/chaitanya-lala"}, "edited": false, "score": 2, "creation_date": 1467165374, "post_id": 38087417, "comment_id": 63614136, "body": "Do you see DMAR related messaged in dmesg ?  Did you pass intel_iommu=on on the kernel command line?"}, {"owner": {"reputation": 203, "user_id": 6524939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66c08308e85fe4e732ca7278a75ada7?s=128&d=identicon&r=PG&f=1", "display_name": "Robert", "link": "https://stackoverflow.com/users/6524939/robert"}, "edited": false, "score": 0, "creation_date": 1467219040, "post_id": 38087417, "comment_id": 63644938, "body": "I didn&#39;t notice those DMAR messages before. I added them to the post and looking into them myself"}], "answers": [{"tags": [], "owner": {"reputation": 145, "user_id": 3484350, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7c1da111e5d6deaefcbd157b5e323758?s=128&d=identicon&r=PG&f=1", "display_name": "anshkun", "link": "https://stackoverflow.com/users/3484350/anshkun"}, "is_accepted": false, "score": 0, "last_activity_date": 1502983939, "creation_date": 1502983939, "answer_id": 45739348, "question_id": 38087417, "link": "https://stackoverflow.com/questions/38087417/using-the-linux-iommu-api-with-userspace-addresses/45739348#45739348", "title": "Using the Linux IOMMU API with userspace addresses", "body": "<p>Such operations are privileged because it is accessing page tables or may be data structures maintained inside task structure.</p>\n\n<p>Please check how hypervisor do this stuff or Virtual machines handles such calls. There may be some driver interface which sets the IOMMU paging unit from Guest OS via hypervisor.</p>\n\n<p>Hypervisor also executes in privileged mode.  </p>\n"}], "owner": {"reputation": 203, "user_id": 6524939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66c08308e85fe4e732ca7278a75ada7?s=128&d=identicon&r=PG&f=1", "display_name": "Robert", "link": "https://stackoverflow.com/users/6524939/robert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1315, "favorite_count": 1, "answer_count": 1, "score": 5, "last_activity_date": 1575347253, "creation_date": 1467153634, "last_edit_date": 1467238717, "question_id": 38087417, "link": "https://stackoverflow.com/questions/38087417/using-the-linux-iommu-api-with-userspace-addresses", "title": "Using the Linux IOMMU API with userspace addresses", "body": "<p>I've got a pci device driver that currently uses <code>dma_map_page</code> to map a userspace address to a dma address. This is working fine but I'm trying to port this to the iommu api to get some of the benefits using groups and domains give.</p>\n\n<p>Current Code: This works fine</p>\n\n<pre><code>ret = get_user_pages_fast(user_addr, one_page, flags, page);\ndma_addr = dma_map_page(dev, off, size, *page, DMA_BIDIRECTIONAL);\n</code></pre>\n\n<p>IOMMU Code: This doesn't work</p>\n\n<pre><code>ret = get_user_pages_fast(...);\npfn = page_to_pfn(*page);\ngroup = iommu_group_get(dev);\ndomain = iommu_domain_alloc(dev-&gt;bus);\niommu_attach_device(domain, dev);\niommu_attach_group(domain, group);\niommu_map(domain, iova, pfn &lt;&lt; PAGE_SHIFT, size, IOMMU_READ|IOMMU_WRITE);\n</code></pre>\n\n<p>All functions return successfully, but when I pass the iova to the device the device can't use it. Has anyone worked with the iommu before and know where my problem is or where I can look? I haven't been able to find much on Linux's iommu implementation anywhere.</p>\n\n<p><strong>Edit</strong>:\nThere were some entries in dmesg that I missed the first time around:</p>\n\n<pre><code>DEBUG: phys addr 0x7738de000\nDEBUG: iova 0xdeadb000\nDMAR: DRHD: handling fault status reg 2\nDMAR: DMAR:[DMA Read] Request device [50:00.0] fault addr 1fdaee4000 \nDMAR:[fault reason 06] PTE Read access is not set\n</code></pre>\n"}, {"tags": ["c", "for-loop", "printf", "scanf", "strcmp"], "comments": [{"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 5, "creation_date": 1467153312, "post_id": 38087312, "comment_id": 63611026, "body": "<code>scanf(&quot;%99[^\\n]%*c&quot;, useranswer); </code>"}, {"owner": {"reputation": 8445, "user_id": 929459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e420841bacccb72fb934f80069c11d0b?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/929459/dmitri"}, "edited": false, "score": 1, "creation_date": 1467153640, "post_id": 38087312, "comment_id": 63611144, "body": "The <code>[...]</code> isn&#39;t an add-on for the <code>s</code> specifier... it&#39;s a different format specifier on its own.  <code>%s</code> reads the next string of non-whitespace characters, and <code>%[^\\n]</code> (<i>not</i> <code>%s[^\\n]</code>) reads a string of any chars except <code>\\n</code> -- so the code you have just reads each word one at a time (one per loop)."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 3, "creation_date": 1467154393, "post_id": 38087312, "comment_id": 63611413, "body": "<code>&quot;%s[^\\n]&quot;</code> is not a valid <code>scanf()</code> format.  Suggest using <code>fgets(useranser, sizeof useranswer, stdin)</code> instead."}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1467159664, "post_id": 38087312, "comment_id": 63612796, "body": "@chux Why is it not valid?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1467160057, "post_id": 38087312, "comment_id": 63612902, "body": "@immibis  Ahhh yes <code>&quot;%s[^\\n]&quot;</code> <i>is</i> valid, but certainly not useful nor certainly not what OP hoped for.  <code>&quot;%s[^\\n]&quot;</code> Would 1a) scan for white-space - throw them away, 1b) scan for non-white-space - save result in <code>useranswer</code>, possible over filling it, 1c) encounter an EOF or  white-space and put that back into <code>stdin</code> 2) scan and attempt to match <code>[</code> with the previous whitespace and fail, ending the scan.  Good catch."}, {"owner": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "edited": false, "score": 0, "creation_date": 1467160374, "post_id": 38087312, "comment_id": 63612981, "body": "<code>scanf</code> is behaving as described by the manual... hmmm, who&#39;d have thought?! I can&#39;t understand the manual, though, so I&#39;ll keep focusing on learning the other parts of C and come back to learn about <code>scanf</code> once I&#39;ve learnt those."}, {"owner": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "edited": false, "score": 0, "creation_date": 1467173734, "post_id": 38087312, "comment_id": 63616080, "body": "<code>int x = scanf(&quot;%99[^\\n]&quot;, useranswer);</code> This first operation might cause <code>scanf</code> to return so it can&#39;t be merged with the discarding operation: <code>scanf(&quot;%*[^\\n]&quot;); getchar();</code> the former reading and discarding any excess characters beyond the 99 up to <code>&#39;\\n&#39;</code> and the latter reading and discarding the newline itself. Again, these two operations cannot be merged into one <code>scanf</code> invocation because the left-most operations might cause failure meaning the operations following don&#39;t execute. BE CAREFUL with <code>scanf</code>! Knowledge is power, and it comes from the manpages in this case..."}, {"owner": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "edited": false, "score": 0, "creation_date": 1467174256, "post_id": 38087312, "comment_id": 63616205, "body": "Also, following on from that example you&#39;d want to write some logic using <code>x</code>... the manual section for <code>scanf</code> will tell you, in this case <code>x</code> can be <code>EOF</code>, <code>0</code> or <code>1</code> and you&#39;ll likely only want to use <code>useranswer</code> when <code>x</code> is <code>1</code> because the others correspond to read errors, end of file and empty fields."}, {"owner": {"reputation": 33, "user_id": 6438317, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cc15671a79432dcee6de46bf62379b4?s=128&d=identicon&r=PG&f=1", "display_name": "blarpsplat", "link": "https://stackoverflow.com/users/6438317/blarpsplat"}, "reply_to_user": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1467180618, "post_id": 38087312, "comment_id": 63618560, "body": "Thank you everybody, @BLUEPIXY &#39;s solution worked... Much appreciated."}, {"owner": {"reputation": 33, "user_id": 6438317, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cc15671a79432dcee6de46bf62379b4?s=128&d=identicon&r=PG&f=1", "display_name": "blarpsplat", "link": "https://stackoverflow.com/users/6438317/blarpsplat"}, "edited": false, "score": 0, "creation_date": 1467180641, "post_id": 38087312, "comment_id": 63618574, "body": "I changed the logic to follow @Bob suggestions as well, thank you again."}], "answers": [{"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1467156483, "post_id": 38087591, "comment_id": 63611999, "body": "Consider <a href=\"http://stackoverflow.com/a/28462221/2410359\">stackoverflow.com/a/28462221/2410359</a>  or <a href=\"http://stackoverflow.com/a/27729970/2410359\">stackoverflow.com/a/27729970/2410359</a> to remove the potential <code>&#39;\\n&#39;</code>.  <code>if ( useranswer[lstr - 1] == &#39;\\n&#39;)</code> is not safe."}, {"owner": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "reply_to_user": {"reputation": 8445, "user_id": 929459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e420841bacccb72fb934f80069c11d0b?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/929459/dmitri"}, "edited": false, "score": 0, "creation_date": 1467156590, "post_id": 38087591, "comment_id": 63612020, "body": "@Dmitri if the user enters a longer string, the first part of the condition <code>lstr == strlen(phrase)</code> will be false. I followed OP&#39;s use of <code>strncmp</code> but note that he used <code>15</code> as a magic number."}, {"owner": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1467156754, "post_id": 38087591, "comment_id": 63612067, "body": "@chux yes I didn&#39;t check for empty lines, my bad."}, {"owner": {"reputation": 8445, "user_id": 929459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e420841bacccb72fb934f80069c11d0b?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/929459/dmitri"}, "edited": false, "score": 0, "creation_date": 1467157172, "post_id": 38087591, "comment_id": 63612177, "body": "ok... but why not just use <code>strcmp()</code>, which won&#39;t indicate a match when the lengths differ anyway?  Not sure why one would prefer <code>strncmp()</code> unless he needs to match on only part of the string.."}, {"owner": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "reply_to_user": {"reputation": 8445, "user_id": 929459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e420841bacccb72fb934f80069c11d0b?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/929459/dmitri"}, "edited": false, "score": 0, "creation_date": 1467157850, "post_id": 38087591, "comment_id": 63612359, "body": "@dmitri In this case both strings are well formed (as far as I can tell following the logic of the code) so it wouldn&#39;t be necessary to limit the comparison. As I said, I only used the same function used by OP trying to point out his error (the use of fixed and arbitrary number), but again, I agree it isn&#39;t necessary."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1467167224, "post_id": 38087591, "comment_id": 63614570, "body": "Detail: When reading an &quot;empty line&quot;, <code>useranswer[0]</code> will have <code>&#39;\\n&#39;</code> in it and <code>lstr == 1</code>.  For <code>useranswer[0]</code> to have <code>&#39;\\0&#39;</code> in it occurs when the first text character read is a null character.  This uncommon event is a hacker exploit."}], "tags": [], "owner": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "is_accepted": false, "score": 3, "last_activity_date": 1467234331, "last_edit_date": 1495540349, "creation_date": 1467154681, "answer_id": 38087591, "question_id": 38087312, "link": "https://stackoverflow.com/questions/38087312/scanf-isnt-executing-on-every-loop-iteration/38087591#38087591", "title": "scanf isn&#39;t executing on every loop iteration", "body": "<p>In comments you could find why your format specifier in <code>scanf</code> doesn't work.</p>\n\n<p>An alternative is to use <a href=\"http://linux.die.net/man/3/fgets\" rel=\"nofollow noreferrer\"><code>fgets</code></a> instead, maybe in an helper function which takes care of some of the corner cases that can arise while reading user input:</p>\n\n<pre><code>#include &lt;ctype.h&gt;\n\nchar *read_line( char *buf, size_t n, FILE *pfin )\n{\n    ssize_t length = 0;\n    int ch;\n\n    if ( !buf || n == 0 )\n        return NULL;\n    /*  Consume trailing control characters, like '\\0','\\n', '\\r', '\\f'...\n        but also '\\t'. Note that ' ' is not skipped. */\n    while ( (ch = fgetc(pfin)) != EOF  &amp;&amp;  iscntrl(ch) ) { }\n    if ( ch == EOF )\n        return NULL;\n    /*  At least one char is printable  */\n    *buf = ch;\n    ++length;\n\n    /*  Read from file till a newline or up to n-2 chars. The remaining chars\n        are left in the stream buffer. Return NULL if no char is read.      */\n    if ( fgets(buf + 1, n - 1, pfin) )\n    {\n        /*  Trim the string to the first control character                  */\n        while ( !iscntrl(buf[length]) ) \n        {\n            ++length;\n        }\n        buf[length] = '\\0';       \n    }\n    return buf;\n}\n</code></pre>\n\n<p>I'd change the following logic too. OP uses <code>strncmp(useranswer, phrase, 15)</code> multiple times, but that magic number <code>15</code> is lower then <code>phrase</code>'s size so it ends up comparing only a substring.</p>\n\n<pre><code>while ( tries &lt;= 3 ) {\n    printf(\"YOUR ANSWER:\");\n    if ( !read_line(useranswer, sizeof useranswer, stdin) ) {\n        printf(\"Error: Unexpected end of input.\\n\");\n        exit(EXIT_FAILURE);\n    }\n    if( strcmp(useranswer, phrase) == 0 ) {\n        printf(\"Damn, you're good.  Well done.\\n\");\n        score += 10;\n        break;\n    } else {\n        printf (\"Nope, try again!\\n\");\n        printf(\"You have used %d out of 3 tries!\\n\", tries);\n        if (tries == 2) {\n            printf(\"Here's your final hint:xxx...\\n\");\n        }\n        if (tries == 3) {\n            printf(\"You didn't get it. The answer is: our favorite saying!\\n\");\n        }\n        tries++;\n    }\n}\n</code></pre>\n\n<p><hr/>\nAs a final note, I found OP declaration of <code>phrase</code> a bit weird (maybe a typo): </p>\n\n<pre><code>const char *phrase = {\"our favorite saying\\0\"};\n//            string literals are already ^^ null terminated...\n</code></pre>\n\n<p>While we can use a simple array declaration, like:</p>\n\n<pre><code>const char phrase[] = \"our favorite saying\";\n</code></pre>\n\n<p>Consider also what values <code>sizeof phrase</code> returns in those two different cases.</p>\n\n<p><hr/> \nThanks to <strong>@chux</strong> for all the valuable hints and the interesting links provided:<br/>\n<a href=\"https://stackoverflow.com/a/27729970/4944425\">https://stackoverflow.com/a/27729970/4944425</a>  <br/>\n<a href=\"https://stackoverflow.com/a/28462221/4944425\">https://stackoverflow.com/a/28462221/4944425</a>  <br/>\nAnd to <strong>@Dmitri</strong> for having pointed out in his comment that once we are sure that both the strings are null terminated, we can use <code>strcmp</code> instead of <code>strncmp</code>.</p>\n"}], "owner": {"reputation": 33, "user_id": 6438317, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cc15671a79432dcee6de46bf62379b4?s=128&d=identicon&r=PG&f=1", "display_name": "blarpsplat", "link": "https://stackoverflow.com/users/6438317/blarpsplat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 363, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1467234331, "creation_date": 1467152927, "last_edit_date": 1467154539, "question_id": 38087312, "link": "https://stackoverflow.com/questions/38087312/scanf-isnt-executing-on-every-loop-iteration", "title": "scanf isn&#39;t executing on every loop iteration", "body": "<p>I am writing a program for fun (not for school), and am having a hard time figuring out why the <code>scanf</code> function isn't executing on every iteration of my loop - I've toyed with both 'for' loops and 'while' loops.  </p>\n\n<p>I know that depending on how I write the <code>scanf</code> function (i.e. <code>scanf(\"%s\", &amp;variablename);</code> VS <code>scanf(\"%99[^\\n]s\", &amp;variablename);</code>) makes a difference, but I have tried everything and I'm desperate!</p>\n\n<p>When I do a <code>printf</code> check on my input from the <code>scanf</code>, on every iteration it is only intaking one string per iteration, so if I enter two words in my first input, then it takes two iterations to process - one word per.  Here is the segment of code I'm describing:</p>\n\n<pre><code>int main(void){\n    int tries = 0;\n    int score = 0;\n    char question[100];\n    char useranswer[100];\n    const char *phrase = {\"our favorite saying\\0\"};\n\n    printf(\"\\nQuestion #3 (10 points): What is our secret saying?\\n\");\n        sleep(1);\n        tries = 1;\n\n    while (tries&lt;=3){\n        printf(\"YOUR ANSWER:\");\n        scanf(\"%s[^\\n]\", useranswer); \n\n        if(strncmp(useranswer, phrase, 15) != 0){\n            printf (\"Nope, try again!\\n\");\n            printf(\"You have used %d out of 3 tries!\\n\", tries);\n            if (tries == 2){\n                printf(\"Here's your final hint:xxx...\\n\");\n            }\n            if (tries == 3){\n            printf(\"You didn't get it. The answer is: our favorite saying!\\n\");\n            }\n            tries++;\n        }   \n        if (strncmp(useranswer, phrase, 15) == 0){\n            printf(\"Damn, you're good.  Well done.\\n\");\n            score += 10;\n            break;\n        }\n    }   \n</code></pre>\n\n<p>The output of this code is:</p>\n\n<pre><code>Question #3 (10 points): What is our secret saying?\nYOUR ANSWER:our favorite saying\nNope, try again!\nYou have used 1 out of 3 tries!\nYOUR ANSWER:Nope, try again!\nYou have used 2 out of 3 tries!\nHere's your final hint:xxx...\nYOUR ANSWER:Nope, try again!\nYou have used 3 out of 3 tries!\nYou didn't get it. The answer is: our favorite saying!\n</code></pre>\n\n<p>(It only allowed me to input once, and I typed \"our favorite saying\".)</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 3, "creation_date": 1467149930, "post_id": 38086712, "comment_id": 63609707, "body": "Welcome to Stack Overflow! It sounds like you may need to learn how to use a debugger to step through your code. With a good debugger, you can execute your program line by line and see where it is deviating from what you expect. This is an essential tool if you are going to do any programming. Further reading: <a href=\"http://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">How to debug small programs</a>."}, {"owner": {"reputation": 88499, "user_id": 650405, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5cdee2abea51e91756076032f0053081?s=128&d=identicon&r=PG", "display_name": "Karoly Horvath", "link": "https://stackoverflow.com/users/650405/karoly-horvath"}, "edited": false, "score": 4, "creation_date": 1467150077, "post_id": 38086712, "comment_id": 63609778, "body": "Please use comments, don&#39;t split the code."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1467153841, "post_id": 38086712, "comment_id": 63611209, "body": "It would be helpful to show a suitable sample (non-square) matrix as input and the expected output (see how to create an MCVE (<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>)).  Are you spiralling clockwise or anticlockwise?  Are you starting at top-left, bottom-right, or one of the other corners?  (Where is element <code>m[0][0]</code> \u2014 bottom-left, top-left, somewhere else?)  It looks as though you are using <code>m[0][0]</code> as top left corner and you are starting at top-left and spiralling clockwise \u2014 judging from the comments.  But clarifying such details help people help you get the answer you want."}, {"owner": {"reputation": 3, "user_id": 6525495, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3161c1b5532b8570b0d3c5927cf0041b?s=128&d=identicon&r=PG&f=1", "display_name": "Saumittra Saxena", "link": "https://stackoverflow.com/users/6525495/saumittra-saxena"}, "edited": false, "score": 0, "creation_date": 1467189890, "post_id": 38086712, "comment_id": 63624047, "body": "thank you for the advice..Will keep it in mind next time.."}], "answers": [{"tags": [], "owner": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "is_accepted": true, "score": 0, "last_activity_date": 1467152111, "creation_date": 1467152111, "answer_id": 38087166, "question_id": 38086712, "link": "https://stackoverflow.com/questions/38086712/print-elements-of-2d-array-in-spiral-manner/38087166#38087166", "title": "print elements of 2d array in spiral manner", "body": "<p>To accomplish the task there's no need of using variable <code>dir</code> and checking its value as all the steps are repeated in the same order.</p>\n\n<p>There was also an error in the last loop's condition: <code>k &lt;= t</code> should be <code>k &gt;= t</code>.</p>\n\n<p>Here is a possible working implementation:</p>\n\n<pre><code>void spiral(int n,int m,int arr[][m])\n{\n    int top = 0,            \n        right = m - 1,      \n        bottom = n - 1,     \n        left = 0, \n        k;  \n\n    while( top &lt;= bottom  &amp;&amp;  left &lt;= right )\n    {\n        //print top row\n        for ( k = left; k &lt;= right; k++ )\n        {\n            printf(\"%d  \",arr[top][k]);\n        }\n        ++top;\n\n        //print right column\n        for( k = top; k &lt;= bottom; k++ )\n        {\n            printf(\"%d   \",arr[k][right]);\n        }\n        --right;\n\n        //print bottom row\n        for( k = right; k &gt;= left; k-- )\n        {\n            printf(\"%d   \",arr[bottom][k]);\n        }\n        --bottom;\n\n        //print left column\n        for( k = bottom; k &gt;= top; k-- )\n        // this was wrong ^^^^^^ in OP's code\n        {\n            printf(\"%d   \",arr[k][left]);\n        }\n        ++left;\n    }\n}\n</code></pre>\n\n<p>Live example <a href=\"https://ideone.com/xLnf2z\" rel=\"nofollow\">HERE</a></p>\n"}], "owner": {"reputation": 3, "user_id": 6525495, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3161c1b5532b8570b0d3c5927cf0041b?s=128&d=identicon&r=PG&f=1", "display_name": "Saumittra Saxena", "link": "https://stackoverflow.com/users/6525495/saumittra-saxena"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 133, "favorite_count": 1, "accepted_answer_id": 38087166, "answer_count": 1, "score": 0, "last_activity_date": 1467154706, "creation_date": 1467149765, "last_edit_date": 1467154706, "question_id": 38086712, "link": "https://stackoverflow.com/questions/38086712/print-elements-of-2d-array-in-spiral-manner", "title": "print elements of 2d array in spiral manner", "body": "<p>i am trying to print elements of an array in a spiral manner..cant figure out the logical error in my code..</p>\n\n<pre><code>void spiral(int n,int m,int arr[][m])\n{\n    int t=0,r=m-1,b=n-1,l=0,dir=0; /* t-&gt;top b-&gt;bottom l-&gt;left r-&gt;right */\n    int k,j;  \n    // above parameters to manage the matrix.    \n\n    // exit condition from loop\n    while (t&lt;=b &amp;&amp; l&lt;=r)\n    {\n        // print top row\n        if (dir==0)                        \n        {\n\n            for (k=l;k&lt;=r;k++)\n            {\n                printf(\"%d  \",arr[t][k]);\n\n            }\n            dir=1;\n            t++;\n\n        }\n\n        // print right column\n        else if (dir==1)          \n        {\n\n            for (k=t;k&lt;=b;k++)\n            {\n                printf(\"%d   \",arr[k][r]);\n\n            }\n            dir=2;\n            r--;\n\n        }\n\n        // print bottom row\n        else if (dir==2)             \n        {\n\n            for (k=r;k&gt;=l;k--)\n            {\n                printf(\"%d   \",arr[b][k]);\n\n            }\n            dir=3;\n            b--;\n\n        }\n\n        // print left column\n        else if (dir==3)         \n        {\n\n            for (k=b;k&lt;=t;k--)\n            {\n                printf(\"%d   \",arr[k][l]);\n\n            }\n            dir=0;\n            l++;\n\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "function", "return"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1467146486, "post_id": 38085872, "comment_id": 63608141, "body": "Post the code that &quot;use the return value in another function&quot;.  Neither of these 2 functions call each other.  Or show that &quot; another function &quot;. or maybe the code that did the printing."}, {"owner": {"reputation": 1884, "user_id": 3078414, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b1180f5e68d3542488d66de14ff53964?s=128&d=identicon&r=PG&f=1", "display_name": "user3078414", "link": "https://stackoverflow.com/users/3078414/user3078414"}, "edited": false, "score": 1, "creation_date": 1467146495, "post_id": 38085872, "comment_id": 63608145, "body": "What do you mean returning <code>float Financing</code> from a function <code>getFinanceAmt()</code> which is supposed to return an <code>int</code>?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1467146615, "post_id": 38085872, "comment_id": 63608214, "body": "If code needs to convert a <code>float</code> to the nearest whole number value, do not use <code>(int)</code>, but <code>roundf(x)</code>."}], "answers": [{"comments": [{"owner": {"reputation": 73, "user_id": 5340304, "user_type": "registered", "accept_rate": 18, "profile_image": "https://i.stack.imgur.com/MZ7eS.jpg?s=128&g=1", "display_name": "Kyle Steward", "link": "https://stackoverflow.com/users/5340304/kyle-steward"}, "edited": false, "score": 0, "creation_date": 1467146887, "post_id": 38085925, "comment_id": 63608350, "body": "Surprisingly I completely overlooked that. Changed but still prints 0."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 73, "user_id": 5340304, "user_type": "registered", "accept_rate": 18, "profile_image": "https://i.stack.imgur.com/MZ7eS.jpg?s=128&g=1", "display_name": "Kyle Steward", "link": "https://stackoverflow.com/users/5340304/kyle-steward"}, "edited": false, "score": 0, "creation_date": 1467146927, "post_id": 38085925, "comment_id": 63608378, "body": "@KyleSteward and how do you print the return value? <code>%f</code>, sure?"}, {"owner": {"reputation": 73, "user_id": 5340304, "user_type": "registered", "accept_rate": 18, "profile_image": "https://i.stack.imgur.com/MZ7eS.jpg?s=128&g=1", "display_name": "Kyle Steward", "link": "https://stackoverflow.com/users/5340304/kyle-steward"}, "edited": false, "score": 0, "creation_date": 1467147148, "post_id": 38085925, "comment_id": 63608503, "body": "The code isn&#39;t suppose to print but I&#39;m printing for testing purposes, but yes, I&#39;m using &#39;%f&#39;."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 73, "user_id": 5340304, "user_type": "registered", "accept_rate": 18, "profile_image": "https://i.stack.imgur.com/MZ7eS.jpg?s=128&g=1", "display_name": "Kyle Steward", "link": "https://stackoverflow.com/users/5340304/kyle-steward"}, "edited": false, "score": 0, "creation_date": 1467147208, "post_id": 38085925, "comment_id": 63608540, "body": "@KyleSteward You mind creating a <a href=\"http://stackoverflow.com/help/mcve\"><b><i>MCVE</i></b></a>? Where do you see 0?"}, {"owner": {"reputation": 73, "user_id": 5340304, "user_type": "registered", "accept_rate": 18, "profile_image": "https://i.stack.imgur.com/MZ7eS.jpg?s=128&g=1", "display_name": "Kyle Steward", "link": "https://stackoverflow.com/users/5340304/kyle-steward"}, "edited": false, "score": 0, "creation_date": 1467147504, "post_id": 38085925, "comment_id": 63608688, "body": "It seems that Doug fixed it above by simply calling the function down and adjusting the parameters. I figured that was the way but didn&#39;t know the correct syntactical way to go about it. But thanks for the help and pointing out that in/float mistake! Appreciate it!"}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 0, "last_activity_date": 1467146896, "last_edit_date": 1467146896, "creation_date": 1467146524, "answer_id": 38085925, "question_id": 38085872, "link": "https://stackoverflow.com/questions/38085872/using-a-return-value-of-one-function-in-another-c/38085925#38085925", "title": "Using a return value of one function in another (C)", "body": "<p>No, as I see, you don't <em>need</em> a pointer here. In your case, there's mismatch in your <em>intention</em> and your code.</p>\n\n<p><code>Financing</code> and <code>interest</code> are of type <code>float</code> but the function returning them are having the return type as <code>int</code>. You may want to change the function return types to <code>float</code> to make them compatible.</p>\n"}, {"comments": [{"owner": {"reputation": 73, "user_id": 5340304, "user_type": "registered", "accept_rate": 18, "profile_image": "https://i.stack.imgur.com/MZ7eS.jpg?s=128&g=1", "display_name": "Kyle Steward", "link": "https://stackoverflow.com/users/5340304/kyle-steward"}, "edited": false, "score": 0, "creation_date": 1467146946, "post_id": 38085949, "comment_id": 63608391, "body": "Changed but it still prints 0."}], "tags": [], "owner": {"reputation": 468, "user_id": 3900052, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003647185275/picture?type=large", "display_name": "Efe Omoregie Elijah", "link": "https://stackoverflow.com/users/3900052/efe-omoregie-elijah"}, "is_accepted": false, "score": 1, "last_activity_date": 1467146599, "creation_date": 1467146599, "answer_id": 38085949, "question_id": 38085872, "link": "https://stackoverflow.com/questions/38085872/using-a-return-value-of-one-function-in-another-c/38085949#38085949", "title": "Using a return value of one function in another (C)", "body": "<p>You have a return type mismatch. change your return types to <code>float</code> and it should run fine</p>\n"}, {"tags": [], "owner": {"reputation": 140, "user_id": 6524683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83b69284584bab4fa7c148613486119b?s=128&d=identicon&r=PG&f=1", "display_name": "Doug", "link": "https://stackoverflow.com/users/6524683/doug"}, "is_accepted": false, "score": 1, "last_activity_date": 1467147023, "creation_date": 1467147023, "answer_id": 38086064, "question_id": 38085872, "link": "https://stackoverflow.com/questions/38085872/using-a-return-value-of-one-function-in-another-c/38086064#38086064", "title": "Using a return value of one function in another (C)", "body": "<p>First, in getFinanceAmt it looks like the function is declared to return an int, but later is returning a float. So first update getFinanceAmt to:</p>\n\n<pre><code>float getFinanceAmt(float cost, float deposit)\n{\n    float financing;\n    financing = cost - deposit;\n        printf(\"%f\\n\", financing);\n\n    return financing;\n}\n</code></pre>\n\n<p>Same thing is going on in the other function. But more importantly, you need to actually call the first function by name, and give it the needed parameters that we declared above. I would recommend just taking in three parameters in getInterest, then using them internally to call getFinanceAmt.</p>\n\n<pre><code>float getInterest(float cost, float deposit, float interestRate)\n{\n    float interest;\n    interest = getFinanceAmt(cost, deposit) * interestRate;\n        printf(\"%f\\n\", interest);\n\n    return interest;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 12533, "user_id": 931027, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lWhaB.jpg?s=128&g=1", "display_name": "Kusalananda", "link": "https://stackoverflow.com/users/931027/kusalananda"}, "is_accepted": false, "score": 1, "last_activity_date": 1467147137, "creation_date": 1467147137, "answer_id": 38086106, "question_id": 38085872, "link": "https://stackoverflow.com/questions/38085872/using-a-return-value-of-one-function-in-another-c/38086106#38086106", "title": "Using a return value of one function in another (C)", "body": "<p>Fixing the issue with the wrong return type for the two funtions, you could do something like this to use the value returned from one as the argument for the other:</p>\n\n<pre><code>float getFinanceAmt(float Cost, float Deposit)\n{\n    return Cost - Deposit;\n}\n\nfloat getInterest(float Financing, float interestRate)\n{\n    return Financing * interestRate;\n}\n\nvoid foo()\n{\n    float cost, deposit, rate;\n\n    /* more code here, which initializes the above variables */\n\n    printf(\"Interest is %f\\n\", getInterest(getFinanceAmt(cost, deposit), rate));\n}\n</code></pre>\n"}], "owner": {"reputation": 73, "user_id": 5340304, "user_type": "registered", "accept_rate": 18, "profile_image": "https://i.stack.imgur.com/MZ7eS.jpg?s=128&g=1", "display_name": "Kyle Steward", "link": "https://stackoverflow.com/users/5340304/kyle-steward"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 841, "favorite_count": 0, "answer_count": 4, "score": -4, "last_activity_date": 1467147137, "creation_date": 1467146364, "question_id": 38085872, "link": "https://stackoverflow.com/questions/38085872/using-a-return-value-of-one-function-in-another-c", "title": "Using a return value of one function in another (C)", "body": "<p>I'm trying to figure out this issue but I can't find any answer regarding the C language. The issue is that when I try to use the return value in another function, that value isn't coming through and it's coming out as '0' when printed. </p>\n\n<pre><code>int getFinanceAmt(float Cost, float Deposit){\n    float Financing;\n    Financing = Cost - Deposit;\n        printf(\"%f\\n\", Financing);\n\nreturn Financing;}\n</code></pre>\n\n<p>So the goal is to utilize that return value and plug in into an equation inside of this function:</p>\n\n<pre><code>int getInterest(float Financing, float interestRate){\n    float interest;\n    interest = Financing * interestRate;\n        printf(\"%f\\n\", interest);\n\nreturn interest;}\n</code></pre>\n\n<p>I have to do this in another function as well which is where 'interestRate' came from. That is also in another function. Is it right that I need some sort of pointer?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1467146405, "post_id": 38085858, "comment_id": 63608085, "body": "Rather use some profiling tool, that allows you to inject such code at compile time."}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 0, "creation_date": 1467149409, "post_id": 38085858, "comment_id": 63609468, "body": "I strongly suggest renaming your thread to accurately reflect your main question, rather than the secondary one that you introduce in the final paragraph and quickly dismiss as probably not feasible."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1467241251, "post_id": 38085858, "comment_id": 63656384, "body": "the C language does not have a &#39;namespace&#39; facility"}], "answers": [{"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 1, "last_activity_date": 1467149103, "creation_date": 1467149103, "answer_id": 38086569, "question_id": 38085858, "link": "https://stackoverflow.com/questions/38085858/removing-functions-included-from-a-header-from-scope-of-the-next-files/38086569#38086569", "title": "Removing functions included from a header from scope of the next files", "body": "<p>You have several options, none of them wonderful.</p>\n\n<ul>\n<li>if you have the sources of the legacy software, so that you can recompile it, you can just change the names of the API functions to make room for the wrapper functions.  If you additionally make the original functions <code>static</code> and put the wrappers in the same source files, then you can ensure that the originals are called only via the wrappers.  Example:</li>\n</ul>\n\n\n\n<pre><code>static int api_func_real(int arg);\n\nint api_func(int arg) {\n    // ... instrumentation ...\n    int result = api_func_real(arg);\n    // ... instrumentation ...\n    return result;\n}\n\nstatic int api_func_real(int arg) {\n    // ...\n}\n</code></pre>\n\n<p>The preprocessor can help you with that, but I hesitate to recommend specifics without any details to work with.</p>\n\n<ul>\n<li>if you do not have sources for the legacy software, or if otherwise you are unwilling to modify it, then you need to make all the callers call your wrappers instead of the original functions.  In this case you can modify the headers or include an additional header before that uses #define to change each of the original function names.  <em>That header must not be included in the source files containing the API function implementations</em>, nor in those providing the wrapper function implementations.  Each define would be of the form:</li>\n</ul>\n\n\n\n<pre><code>#define api_func api_func_wrapper\n</code></pre>\n\n<p>You would then implement the various <code>api_func_wrapper()</code> functions.</p>\n\n<p>Among the ways those cases differ is that if you change the legacy function names, then internal calls among those functions will go through the wrappers bearing the original names (unless you change the calls, too), but if you implement wrappers with new names then they will be used only when called explicitly, which will not happen for internal calls within the legacy code (unless, again, you modify those calls).</p>\n"}, {"comments": [{"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 0, "creation_date": 1467149884, "post_id": 38086644, "comment_id": 63609680, "body": "Your function prototypes are invalid C syntax.  You must include a type specifier for each argument, not just the first."}], "tags": [], "owner": {"reputation": 4888, "user_id": 5785362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a786fd81952576dc07942023bf8830b?s=128&d=identicon&r=PG", "display_name": "tofro", "link": "https://stackoverflow.com/users/5785362/tofro"}, "is_accepted": false, "score": 1, "last_activity_date": 1467151847, "last_edit_date": 1467151847, "creation_date": 1467149453, "answer_id": 38086644, "question_id": 38085858, "link": "https://stackoverflow.com/questions/38085858/removing-functions-included-from-a-header-from-scope-of-the-next-files/38086644#38086644", "title": "Removing functions included from a header from scope of the next files", "body": "<p>You can do something like</p>\n\n<p>[your wrapper's include file]</p>\n\n<pre><code>int origFunc1 (int x);\nint origFunc2 (int x, int y);\n\n#ifndef WRAPPER_IMPL\n#define origFunc1 wrappedFunc1\n#define origFunc2 wrappedFunc2\n#else\nint wrappedFunc1(int x);\nint wrappedFunc2(int x, int y);\n#endif\n</code></pre>\n\n<p>[your wrapper implementation]</p>\n\n<pre><code>#define WRAPPER_IMPL\n#include \"wrapper.h\"\n\nint wrapperFunc1 (...) {\n   printf(\"Wrapper1 called\\n\");\n   origFunc1(...);\n}\n</code></pre>\n\n<p>Your wrapper's C file obviously needs to <code>#define</code> <code>WRAPPER_IMPL</code> <em>before</em> including the header.  </p>\n\n<p>That is neither nice nor clean (and if someone wants to cheat, he could simply define <code>WRAPPER_IMPL</code>), but at least <em>some</em> way to go.</p>\n"}, {"tags": [], "owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "is_accepted": false, "score": 1, "last_activity_date": 1467241696, "creation_date": 1467241696, "answer_id": 38111499, "question_id": 38085858, "link": "https://stackoverflow.com/questions/38085858/removing-functions-included-from-a-header-from-scope-of-the-next-files/38111499#38111499", "title": "Removing functions included from a header from scope of the next files", "body": "<p>There are two ways to wrap or override C functions in Linux:</p>\n\n<pre><code>Using LD_PRELOAD: \nThere is a shell environment variable in Linux called LD_PRELOAD, \nwhich can be set to a path of a shared library, \nand that library will be loaded before any other library (including glibc).\n\nUsing \u2018ld --wrap=symbol\u2018: \nThis can be used to use a wrapper function for symbol. \nAny further reference to symbol will be resolved to the wrapper function. \n</code></pre>\n\n<p>a complete writeup can be found at:\n<code>http://samanbarghi.com/blog/2014/09/05/how-to-wrap-a-system-call-libc-function-in-linux/</code></p>\n"}], "owner": {"reputation": 435, "user_id": 5451820, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/3Me0j.jpg?s=128&g=1", "display_name": "Kira", "link": "https://stackoverflow.com/users/5451820/kira"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1467241696, "creation_date": 1467146312, "last_edit_date": 1467146722, "question_id": 38085858, "link": "https://stackoverflow.com/questions/38085858/removing-functions-included-from-a-header-from-scope-of-the-next-files", "title": "Removing functions included from a header from scope of the next files", "body": "<p>In my project we are heavily using a C header which provides an API to comunicate to an external software. Long story short, in our project's bugs show up more often on the calling of the functions defined in those headers (it is an old and ugly legacy code).</p>\n\n<p>I would like to implement an indirection on the calling of those functions, so I could include some profiling before calling the actual implementation.</p>\n\n<p>Because I'm not the only person working on this project, I would like to make those wrappers in a such way that if someone uses the original implementations directly it should cause a compile error.</p>\n\n<p>If those headers were C++ sources, I would be able to simply make a <code>namespace</code>, wrap the included files in it, and implement my functions using it (the other developers would be able to use the original implementation using the <code>::</code> operator, but just not being able to call it directly is enough encapsulation to me). However the headers are C sources (which I have to include with <code>extern \"C\"</code> directive to include), so namespaces won't help me AFAIK.</p>\n\n<p>I tried to play around with <code>define</code>s, but with no luck, like this:</p>\n\n<pre><code>#define my_func api_func\n#define api_func NULL\n</code></pre>\n\n<p>What I wanted with the above code is to make <code>my_func</code> to be translated to <code>api_func</code> during the preprocessing, while making a direct call to <code>api_func</code> give a compile error, but that won't work because it will actually make <code>my_func</code> to be translated to <code>NULL</code> too.</p>\n\n<p>So, basically, I would like to make a wrapper, and make sure the only way to access the API is through this wrapper (unless the other developers make some workaround, but this is inevitable).\nPlease note that I need to wrap hundreds of functions, which show up spread in the whole code several times.</p>\n\n<p>My wrapper necessarily will have to include those C headers, but I would like to make them leave scope outside the file of my wrapper, and make them to be unavailable to every other file who includes my wrapper, but I guess this is not possible in C/C++.</p>\n"}, {"tags": ["c", "string", "string-literals", "strcat"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1467145817, "post_id": 38085720, "comment_id": 63607782, "body": "You can&#39;t do this: <code>header2=strcat(&quot;&#47;usr&#47;include&#47;&quot;,header);</code>. The first parameter has to be the destination buffer."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1467145877, "post_id": 38085720, "comment_id": 63607811, "body": "Check the result <code>header</code> from <code>strtok</code> before using it."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1467146211, "post_id": 38085720, "comment_id": 63607991, "body": "After all the other problems are fixed, you&#39;ll still need to check the return value from the second <code>fopen</code>."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1467146287, "post_id": 38085720, "comment_id": 63608023, "body": "You are not opening <code>f2</code>, but re-opening <code>f</code> with a different file name (without closing the first opening)."}], "answers": [{"comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1467145886, "post_id": 38085738, "comment_id": 63607815, "body": "string literals also aren&#39;t modifiable."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1467145972, "post_id": 38085738, "comment_id": 63607851, "body": "@Barmar Right, that&#39;s also a valid point, connsidered the null-substitution, let me add."}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 2, "last_activity_date": 1467146305, "last_edit_date": 1495539855, "creation_date": 1467145798, "answer_id": 38085738, "question_id": 38085720, "link": "https://stackoverflow.com/questions/38085720/what-is-causing-this-segmentation-fault-in-string-concatenation/38085738#38085738", "title": "What is causing this segmentation fault in string concatenation?", "body": "<p>The major problem is in</p>\n\n<pre><code>header2=strcat(\"/usr/include/\",header);\n</code></pre>\n\n<p>as you're supplying a <a href=\"https://en.wikipedia.org/wiki/String_literal\" rel=\"nofollow noreferrer\">string literal</a> as the <em>destination</em>. This does not have any space to hold the concatenated string. So, you're essentially trying to access invalid memory which  invokes <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">undefined behavior</a>.</p>\n\n<p>That said, for <a href=\"http://linux.die.net/man/3/strcat\" rel=\"nofollow noreferrer\"><code>strcat()</code></a>, the behavior is, (<em>emphasis mine</em>)</p>\n\n<blockquote>\n  <p>The <code>strcat()</code> function appends the <code>src</code> string to the <code>dest</code> string, <strong>overwriting the terminating null byte</strong> (<code>'\\0'</code>) at the end of <code>dest</code>, [...]</p>\n</blockquote>\n\n<p>which, in your case, involves an attempt to modify a string literal, which again, invokes UB. </p>\n\n<p>Then, there are more to point out, like</p>\n\n<ul>\n<li><p><code>strlen()</code> does not count the terminating null-byte for a <em>string</em>, so using <code>strlen()</code> for allocating memory should contain a <code>+1</code> as the size to get the space for the null-termination.</p></li>\n<li><p><a href=\"https://stackoverflow.com/q/605845/2173917\">Please see this discussion on why not to cast the return value of <code>malloc()</code> and family in <code>C</code>.</a>.</p></li>\n<li>Always check the return value of library calls like <code>fopen()</code> for success before using the return value.</li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 303, "user_id": 6346849, "user_type": "registered", "accept_rate": 44, "profile_image": "https://lh4.googleusercontent.com/-51PLF6nGBIQ/AAAAAAAAAAI/AAAAAAAAAEI/aY81bGsZQ9I/photo.jpg?sz=128", "display_name": "Febin Sunny", "link": "https://stackoverflow.com/users/6346849/febin-sunny"}, "edited": false, "score": 0, "creation_date": 1467147152, "post_id": 38085815, "comment_id": 63608510, "body": "<code>sprintf</code> is like <code>printf</code>, but it puts the result in a string instead of printing it."}], "tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": false, "score": 3, "last_activity_date": 1467146094, "creation_date": 1467146094, "answer_id": 38085815, "question_id": 38085720, "link": "https://stackoverflow.com/questions/38085720/what-is-causing-this-segmentation-fault-in-string-concatenation/38085815#38085815", "title": "What is causing this segmentation fault in string concatenation?", "body": "<p>You can't use a string literal as the target of <code>strcat</code> -- string literals are not modifiable, and it doesn't have enough space to hold the concatenated string. A better way to combine the variable with a prefix is with <code>sprintf</code>.</p>\n\n<pre><code>header2 = malloc(strlen(\"/usr/include/\")+strlen(header)+1);\nsprintf(header2, \"/usr/include/%s\", header);\n</code></pre>\n\n<p>Note that you need to add 1 to the combined lengths when calling <code>malloc()</code>, to allow space for the trailing null byte.</p>\n\n<p>You could also use <code>strcpy</code> followed by <code>strcat</code>:</p>\n\n<pre><code>strcpy(header2, \"/usr/include/\");\nstrcat(header2, header);\n</code></pre>\n"}], "owner": {"reputation": 303, "user_id": 6346849, "user_type": "registered", "accept_rate": 44, "profile_image": "https://lh4.googleusercontent.com/-51PLF6nGBIQ/AAAAAAAAAAI/AAAAAAAAAEI/aY81bGsZQ9I/photo.jpg?sz=128", "display_name": "Febin Sunny", "link": "https://stackoverflow.com/users/6346849/febin-sunny"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1467146609, "creation_date": 1467145718, "last_edit_date": 1467146609, "question_id": 38085720, "link": "https://stackoverflow.com/questions/38085720/what-is-causing-this-segmentation-fault-in-string-concatenation", "title": "What is causing this segmentation fault in string concatenation?", "body": "<p>I am doing an exercise in C to brush myself up on the topic. I am trying to use my program to manipulate header files; but the program returns \"Segmentation fault\". I have isolated the issue to the following segment of code. Can any one help me see what exactly is wrong with it ?</p>\n\n<pre><code>    header=strtok(st,\"\\\"\");\n    header=strtok(NULL,\"\\\"\");\n    f=fopen(header,\"r\");\n    if(f)\n    {\n            while((ch=fgetc(f))!=EOF)\n            fputc(ch,f2);\n\n            fclose(f);\n    }\n    else\n    {\n            header2=(char *)malloc(strlen(\"/usr/include\")+strlen(header));\n            header2=strcat(\"/usr/include/\",header);\n            f=fopen(header2,\"r\");\n\n            printf(\"%s\\n\",header2);\n\n            while((ch=fgetc(f))!=EOF)\n            fputc(ch,f2);\n\n            fclose(f);\n   }\n</code></pre>\n\n<p>I have noted that the issue occurs only when I am trying to access the /usr/include/ location. Some sort of authentication issue ? If so, how to over come it ? Thanks in advance. :)</p>\n"}, {"tags": ["c#", "c", "unity3d", "port"], "comments": [{"owner": {"reputation": 13866, "user_id": 54200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6261c8ab215b8069e8290516c80445d8?s=128&d=identicon&r=PG", "display_name": "KevinDTimm", "link": "https://stackoverflow.com/users/54200/kevindtimm"}, "edited": false, "score": 1, "creation_date": 1467145511, "post_id": 38085447, "comment_id": 63607619, "body": "Generic answer - find out where the library is, find out where the program is attempting to locate the library, move the library to the expected directory or point the program to look in the correct directory.  You haven&#39;t given us enough to advise more than this."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 4367139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BRZyw.jpg?s=128&g=1", "display_name": "AtticusMarkane", "link": "https://stackoverflow.com/users/4367139/atticusmarkane"}, "is_accepted": false, "score": 0, "last_activity_date": 1467147396, "creation_date": 1467147396, "answer_id": 38086163, "question_id": 38085447, "link": "https://stackoverflow.com/questions/38085447/how-can-i-get-liblz4-dll/38086163#38086163", "title": "How can I get liblz4.dll", "body": "<p>Remember that your application is compiled by Unity so you will need to include the library within your unity project. Check out the answer posted here for more info: <a href=\"http://answers.unity3d.com/questions/458300/how-to-use-a-external-dll.html\" rel=\"nofollow\">http://answers.unity3d.com/questions/458300/how-to-use-a-external-dll.html</a></p>\n"}], "owner": {"reputation": 1, "user_id": 6525246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a3ee4c10bb49fcb243a14057d2e3910?s=128&d=identicon&r=PG&f=1", "display_name": "Robert Kerbin", "link": "https://stackoverflow.com/users/6525246/robert-kerbin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 361, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1467147473, "creation_date": 1467144786, "last_edit_date": 1467147473, "question_id": 38085447, "link": "https://stackoverflow.com/questions/38085447/how-can-i-get-liblz4-dll", "title": "How can I get liblz4.dll", "body": "<p>I am working with Unity3D.\nThere I am going to use LZ4 library.\nSo I typed as this.</p>\n\n<pre><code>[DllImport(\"liblz4\", EntryPoint = \"LZ4DecompressFile\")]\ninternal static extern int LZ4DecompressFile(string inFile, string outFile, IntPtr bytes, IntPtr FileBuffer, int fileBufferLength);\n</code></pre>\n\n<p>But when call this function, I get the error </p>\n\n<blockquote>\n  <p>\"DllNotFoundException: liblz4\"</p>\n</blockquote>\n\n<p>Where can I find liblz4?</p>\n"}, {"tags": ["c", "casting", "bit-shift", "memory-efficient", "bitarray"], "comments": [{"owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "edited": false, "score": 0, "creation_date": 1467143589, "post_id": 38084901, "comment_id": 63606591, "body": "Do <i>not</i> rewrite the division and modulo to be &quot;clever&quot;; the compiler is certainly clever enough to already do those optimizations for you. Also consider using <code>CHAR_BIT * sizeof bArr[0]</code> instead of <code>64</code>, to avoid magic numbers."}, {"owner": {"reputation": 175, "user_id": 6519765, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4bb37d1eec3217a29c53814d3b35e171?s=128&d=identicon&r=PG&f=1", "display_name": "Matthias", "link": "https://stackoverflow.com/users/6519765/matthias"}, "reply_to_user": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "edited": false, "score": 0, "creation_date": 1467143635, "post_id": 38084901, "comment_id": 63606619, "body": "@unwind Thanks for the tip. I&#39;ll test it with my code. This is probably the case though."}, {"owner": {"reputation": 4888, "user_id": 5785362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a786fd81952576dc07942023bf8830b?s=128&d=identicon&r=PG", "display_name": "tofro", "link": "https://stackoverflow.com/users/5785362/tofro"}, "edited": false, "score": 0, "creation_date": 1467152683, "post_id": 38084901, "comment_id": 63610798, "body": "If you&#39;re looking for speed, provide a <code>const uint64_t</code> table with the 64 different ULL constants (1 pre-shifted into all possible places) and index into that."}], "answers": [{"tags": [], "owner": {"reputation": 4691, "user_id": 1061433, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/QVsc7.png?s=128&g=1", "display_name": "amaurea", "link": "https://stackoverflow.com/users/1061433/amaurea"}, "is_accepted": false, "score": 1, "last_activity_date": 1467143115, "creation_date": 1467143115, "answer_id": 38085031, "question_id": 38084901, "link": "https://stackoverflow.com/questions/38084901/c-bitarray-set-single-bit-of-uint64-t/38085031#38085031", "title": "C - BitArray - Set single bit of uint64_t", "body": "<p>If I understand you correctly, you want a literal 1 that is at least 64 bits long. You can <a href=\"https://stackoverflow.com/questions/2835746/how-do-you-specify-a-64-bit-unsigned-int-const-0x8000000000000000-in-vs2008\">get this</a> without any casts by writing <code>1ull</code> instead of just <code>1</code>. This creates an <code>unsigned long long</code> literal with the value 1. However, the type is not guaranteed not to be longer than 64-bits, so if you rely on it being exactly 64-bits you may need a cast after all.</p>\n"}, {"comments": [{"owner": {"reputation": 175, "user_id": 6519765, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4bb37d1eec3217a29c53814d3b35e171?s=128&d=identicon&r=PG&f=1", "display_name": "Matthias", "link": "https://stackoverflow.com/users/6519765/matthias"}, "edited": false, "score": 0, "creation_date": 1467143487, "post_id": 38085041, "comment_id": 63606544, "body": "Oh, you again :) So as you&#39;ll probably remember this is pretty much your code (only with <code>uint64_t</code>). Also do you know what size is probably the best to use for the array <code>uint64_t</code>, <code>uint32_t</code>, <code>uint16_t</code> or even <code>uint8_t</code>? I&#39;m having L1/L2 cache size in my mind, but don&#39;t know much about it..."}, {"owner": {"reputation": 133646, "user_id": 1119701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d4bef9fe12d776629b204d4e650c2e0?s=128&d=identicon&r=PG", "display_name": "ouah", "link": "https://stackoverflow.com/users/1119701/ouah"}, "edited": false, "score": 0, "creation_date": 1467144083, "post_id": 38085041, "comment_id": 63606865, "body": "<i>a cast [...] is a compile time construct that tells the compiler the type of an expression</i>  it&#39;s not correct to say a cast is a compile time construct when in most cases it&#39;s not."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 3, "last_activity_date": 1467143147, "creation_date": 1467143147, "answer_id": 38085041, "question_id": 38084901, "link": "https://stackoverflow.com/questions/38084901/c-bitarray-set-single-bit-of-uint64-t/38085041#38085041", "title": "C - BitArray - Set single bit of uint64_t", "body": "<p>A cast in and of itself does not affect performance.  It's a compile time construct that tells the compiler the type of an expression.  </p>\n\n<p>In this case, they're all integer casts and expressions, so there should be no performance impact.</p>\n"}, {"comments": [{"owner": {"reputation": 175, "user_id": 6519765, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4bb37d1eec3217a29c53814d3b35e171?s=128&d=identicon&r=PG&f=1", "display_name": "Matthias", "link": "https://stackoverflow.com/users/6519765/matthias"}, "edited": false, "score": 0, "creation_date": 1467143592, "post_id": 38085117, "comment_id": 63606594, "body": "Great to know, that this happens at compile time and won&#39;t affect performance (only uglifies the code)..."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1467143786, "post_id": 38085117, "comment_id": 63606699, "body": "Detail <code>unsigned long long</code> is at least 64-bit, so <code>bArr[index&#47;64] |= 1ULL &lt;&lt;(index%64);</code> will certainly work.  Assuming <code>unsigned long long</code> is 64-bit is not needed."}, {"owner": {"reputation": 175, "user_id": 6519765, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4bb37d1eec3217a29c53814d3b35e171?s=128&d=identicon&r=PG&f=1", "display_name": "Matthias", "link": "https://stackoverflow.com/users/6519765/matthias"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1467144257, "post_id": 38085117, "comment_id": 63606968, "body": "@chux Will it break when <code>unsigned long long</code> is greater than 64-bit? I&#39;m not exactly sure what is happening. Could you try to explain, what happens without a cast? I saw the wrong output and was assuming it had to do something with the width (and therefore successfully tried the cast). I would like to know, why the code broke ..."}, {"owner": {"reputation": 133646, "user_id": 1119701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d4bef9fe12d776629b204d4e650c2e0?s=128&d=identicon&r=PG", "display_name": "ouah", "link": "https://stackoverflow.com/users/1119701/ouah"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1467144305, "post_id": 38085117, "comment_id": 63607005, "body": "@chux you are right, it was actually to make the point in my last sentence that three expressions are equivalent (but for this I should also mention <code>uint_least64_t</code> can be different than <code>unsigned long long</code>)."}, {"owner": {"reputation": 133646, "user_id": 1119701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d4bef9fe12d776629b204d4e650c2e0?s=128&d=identicon&r=PG", "display_name": "ouah", "link": "https://stackoverflow.com/users/1119701/ouah"}, "reply_to_user": {"reputation": 175, "user_id": 6519765, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4bb37d1eec3217a29c53814d3b35e171?s=128&d=identicon&r=PG&f=1", "display_name": "Matthias", "link": "https://stackoverflow.com/users/6519765/matthias"}, "edited": false, "score": 1, "creation_date": 1467144546, "post_id": 38085117, "comment_id": 63607131, "body": "@Matthias it will work the same if <code>unsigned long long</code> width is greater than 64-bit."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1467144808, "post_id": 38085117, "comment_id": 63607256, "body": "The only down-side to using <code>1ULL</code> vs. <code>UINT64_C(1)</code> I see, in a more complex expression, is that <code>1ULL</code>  may go  to a wider type than <code>uint64_t</code> and create issues like <a href=\"http://stackoverflow.com/a/19453213/2410359\">here</a>.  Certainly rare in 2016 as <code>unsigned long long</code> is commonly 64-bit."}, {"owner": {"reputation": 133646, "user_id": 1119701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d4bef9fe12d776629b204d4e650c2e0?s=128&d=identicon&r=PG", "display_name": "ouah", "link": "https://stackoverflow.com/users/1119701/ouah"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1467145110, "post_id": 38085117, "comment_id": 63607406, "body": "@chux nice example. When dealing with <code>uint64_t</code> objects for example, I would prefer <code>(uint64_t) 1</code> so I&#39;m sure the computations will be done using the exact same type."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1467145848, "post_id": 38085117, "comment_id": 63607798, "body": "Agreed.  For robust code I prefer <code>((uint64_t)1)</code> over <code>1ULL</code> to insure the desired type too.  Yet with simple <code>bArr[index&#47;64] |= 1ull &lt;&lt;(index%64);</code>, Using <code>ULL</code> is appealing.  <code>INT64_C(1)</code> is best for portability as <code>uint64_t</code> need not exist, yet <code>int_leastN_t</code> will.  But that <code>uint64_t</code> is assumed to exist in OP&#39;s example."}], "tags": [], "owner": {"reputation": 133646, "user_id": 1119701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d4bef9fe12d776629b204d4e650c2e0?s=128&d=identicon&r=PG", "display_name": "ouah", "link": "https://stackoverflow.com/users/1119701/ouah"}, "is_accepted": true, "score": 4, "last_activity_date": 1467143444, "creation_date": 1467143444, "answer_id": 38085117, "question_id": 38084901, "link": "https://stackoverflow.com/questions/38084901/c-bitarray-set-single-bit-of-uint64-t/38085117#38085117", "title": "C - BitArray - Set single bit of uint64_t", "body": "<p>The result type of <code>&lt;&lt;</code> operator is the type of the left operand (after integer promotions) that's why you need to use the correct type: <code>1</code> is of type <code>int</code> but you need type <code>uint64_t</code>.</p>\n\n<p>You can use either:</p>\n\n<pre><code>(uint64_t) 1\n</code></pre>\n\n<p>or </p>\n\n<pre><code>UINT64_C(1)  /* you have to include &lt;stdint.h&gt; */\n</code></pre>\n\n<p>or</p>\n\n<pre><code>1ULL  \n</code></pre>\n\n<p>(for the last one assuming <code>unsigned long long</code> is 64-bit in your system which is very likely).</p>\n\n<p>But they are all equivalent: all these expressions are integer constant expressions and their value is computed at compile time and not at run time.   </p>\n"}, {"comments": [{"owner": {"reputation": 175, "user_id": 6519765, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4bb37d1eec3217a29c53814d3b35e171?s=128&d=identicon&r=PG&f=1", "display_name": "Matthias", "link": "https://stackoverflow.com/users/6519765/matthias"}, "edited": false, "score": 0, "creation_date": 1467143719, "post_id": 38085160, "comment_id": 63606661, "body": "Nice macro, thanks for the tip :) In this case casting should be fine, since I always working on <code>uin64_t</code> right?"}, {"owner": {"reputation": 7787, "user_id": 1257035, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WHLC8.png?s=128&g=1", "display_name": "a3f", "link": "https://stackoverflow.com/users/1257035/a3f"}, "edited": false, "score": 0, "creation_date": 1467145764, "post_id": 38085160, "comment_id": 63607759, "body": "Is there any benefit in choosing <code>INT64_C</code> over a cast to <code>(int64_t)</code>?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 7787, "user_id": 1257035, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WHLC8.png?s=128&g=1", "display_name": "a3f", "link": "https://stackoverflow.com/users/1257035/a3f"}, "edited": false, "score": 1, "creation_date": 1467146073, "post_id": 38085160, "comment_id": 63607911, "body": "@a3f  Answer edited to address a benefit.  When N is &gt;= <code>unsigned&#47;int</code> width and <code>(u)intN_t</code> exist, certainly <code>INTN_C()</code> and casting <code>(intN_t)</code> behave alike."}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 3, "last_activity_date": 1467145944, "last_edit_date": 1467145944, "creation_date": 1467143610, "answer_id": 38085160, "question_id": 38084901, "link": "https://stackoverflow.com/questions/38084901/c-bitarray-set-single-bit-of-uint64-t/38085160#38085160", "title": "C - BitArray - Set single bit of uint64_t", "body": "<p>C offer macros for this which will expand the integer constant to the type <code>int_leastN_t</code>.</p>\n\n<pre><code>INTN_C(value)\nUINTN_C(value)\n</code></pre>\n\n<p>Example</p>\n\n<pre><code>#include &lt;stdint.h&gt;.\nbArr[index/64] |= UINT64_C(1) &lt;&lt; (index%64);\n</code></pre>\n\n<p>In <em>general</em> it is better to avoid casting.  Sometimes casting unexpectedly make the expression <em>narrower</em> than hoped.</p>\n\n<hr>\n\n<p>Benefit of <code>UINT64_C</code>: <code>uint_least_64_t/int_least_64_t</code> types must exist (C99).  <code>int64_t/uint64_t</code> are optional.</p>\n"}], "owner": {"reputation": 175, "user_id": 6519765, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4bb37d1eec3217a29c53814d3b35e171?s=128&d=identicon&r=PG&f=1", "display_name": "Matthias", "link": "https://stackoverflow.com/users/6519765/matthias"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1239, "favorite_count": 0, "accepted_answer_id": 38085117, "answer_count": 4, "score": 6, "last_activity_date": 1467145944, "creation_date": 1467142674, "question_id": 38084901, "link": "https://stackoverflow.com/questions/38084901/c-bitarray-set-single-bit-of-uint64-t", "title": "C - BitArray - Set single bit of uint64_t", "body": "<p>I'm currently working on a project, in which I need bit sets. I'm using an array of <code>uint64_t</code>'s for the bitset.</p>\n\n<p>My current problem is, that whenever I want to set or check a bit I need to do an operation like this:</p>\n\n<pre><code>uint64_t index = 42;\nbArr[index/64] |= (((uint64_t)1)&lt;&lt;(index%64)); \n</code></pre>\n\n<p>I can rewrite the division and modulo with some clever <em>and</em> and <em>bitshift</em> operations as well, but I'm concerned about the cast of <code>1</code>. I need this cast, since otherwise the <code>1</code> is seen as a 32-bit unit. As seen in this example - you get wrong output without a cast:</p>\n\n<pre><code>uint64_t bArr[4];                           // 256 bits \nbArr[0] = bArr[1] = bArr[2] = bArr[3] = 0;  // Set to 0\n\nuint64_t i = 255;\nbArr[i/64] = (bArr[i/64] | (((uint64_t)1)&lt;&lt;(i%64))); \n\nuint32_t i2;\nfor (i2 = 0; i2 &lt; 256; i2++) {\n  if ((bArr[i2/64] &amp; (((uint64_t)1)&lt;&lt;(i2%64))) != 0) {\n    printf(\"bArray[%\" PRIu32 \"] = 1\\n\", i2);\n  }\n}\n</code></pre>\n\n<p>Can I get around this cast in a clever way? I was thinking that the performance is probably suffering from a cast at <em>every</em> read/write... </p>\n"}, {"tags": ["c", "regex", "while-loop"], "answers": [{"comments": [{"owner": {"reputation": 312, "user_id": 6214696, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/94cfece03b9514f2bab016e83988bb46?s=128&d=identicon&r=PG", "display_name": "Alisson Linneker", "link": "https://stackoverflow.com/users/6214696/alisson-linneker"}, "edited": false, "score": 0, "creation_date": 1467142844, "post_id": 38084924, "comment_id": 63606135, "body": "How to use regular expressions?"}, {"owner": {"reputation": 83283, "user_id": 3937, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/e27f554e9ed800bca61642acaba29452?s=128&d=identicon&r=PG", "display_name": "Lou Franco", "link": "https://stackoverflow.com/users/3937/lou-franco"}, "edited": false, "score": 0, "creation_date": 1467144786, "post_id": 38084924, "comment_id": 63607243, "body": "It should be <code>&amp;cod</code>, not <code>%cod</code>"}, {"owner": {"reputation": 312, "user_id": 6214696, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/94cfece03b9514f2bab016e83988bb46?s=128&d=identicon&r=PG", "display_name": "Alisson Linneker", "link": "https://stackoverflow.com/users/6214696/alisson-linneker"}, "reply_to_user": {"reputation": 83283, "user_id": 3937, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/e27f554e9ed800bca61642acaba29452?s=128&d=identicon&r=PG", "display_name": "Lou Franco", "link": "https://stackoverflow.com/users/3937/lou-franco"}, "edited": false, "score": 0, "creation_date": 1467144875, "post_id": 38084924, "comment_id": 63607286, "body": "@LouFranco I have line, example <code>5   123460   Food5 Good</code>, how to get 3 elements? id, cod, food name"}, {"owner": {"reputation": 83283, "user_id": 3937, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/e27f554e9ed800bca61642acaba29452?s=128&d=identicon&r=PG", "display_name": "Lou Franco", "link": "https://stackoverflow.com/users/3937/lou-franco"}, "edited": false, "score": 0, "creation_date": 1467145423, "post_id": 38084924, "comment_id": 63607577, "body": "You can&#39;t really do that with fscanf because it breaks on spaces. The easiest thing to do is to write your own parse function that does that and pass in the line."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 83283, "user_id": 3937, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/e27f554e9ed800bca61642acaba29452?s=128&d=identicon&r=PG", "display_name": "Lou Franco", "link": "https://stackoverflow.com/users/3937/lou-franco"}, "edited": false, "score": 0, "creation_date": 1467145644, "post_id": 38084924, "comment_id": 63607696, "body": "@LouFranco  Thanks.  Fixed."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 3, "last_activity_date": 1467145626, "last_edit_date": 1467145626, "creation_date": 1467142743, "answer_id": 38084924, "question_id": 38084858, "link": "https://stackoverflow.com/questions/38084858/while-file-data-with-regex/38084924#38084924", "title": "While file data with regex", "body": "<p>The <code>scanf</code> function does not accept regular expressions.  It has its own syntax similar to <code>printf</code>.</p>\n\n<p>Try this instead:</p>\n\n<pre><code>while(fscanf(file, \"%d %d %s\", &amp;id, &amp;cod, name) == 3)\n</code></pre>\n"}], "owner": {"reputation": 312, "user_id": 6214696, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/94cfece03b9514f2bab016e83988bb46?s=128&d=identicon&r=PG", "display_name": "Alisson Linneker", "link": "https://stackoverflow.com/users/6214696/alisson-linneker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1467306431, "creation_date": 1467142546, "last_edit_date": 1467306431, "question_id": 38084858, "link": "https://stackoverflow.com/questions/38084858/while-file-data-with-regex", "title": "While file data with regex", "body": "<p>I have problem on while file data on get only regular expession. I would get only the sorted data table.</p>\n\n<p><strong>My file:</strong></p>\n\n<pre><code>Foods list test.\nCheck all foods:\n1   123456   Food Name 1\n2   123457   Food Name 2\n3   123458   Food Name 3\n4   123459   Food Name 4\n5   123460   Food Name 5\nblablabla blablabla\n...\nfile foods done\n</code></pre>\n\n<blockquote>\n  <p>ID\\tCOD\\t(SPACE)NAME</p>\n</blockquote>\n\n<p><strong>My code:</strong></p>\n\n<pre><code>int id, cod;\nchar name[64];\nFILE *file;\nfile = fopen(\"foods.txt\", \"r\")\nwhile(fscanf(file, \"(\\d+)\\t(\\d+)\\t (.*)\", &amp;id, &amp;cod, name) != EOF)\n    printf(\"ID: %d - Code: %d - Name: %s\\n\", id, cod, nome);\n</code></pre>\n\n<p>Is not working as it should, why? You are entering an endless loop.</p>\n"}, {"tags": ["c", "windows", "allegro5"], "comments": [{"owner": {"reputation": 593, "user_id": 1955945, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qt3vW.png?s=128&g=1", "display_name": "rlam12", "link": "https://stackoverflow.com/users/1955945/rlam12"}, "edited": false, "score": 0, "creation_date": 1467563726, "post_id": 38084700, "comment_id": 63771200, "body": "Well I dont really see why the code does not compile, you could try asking the devs directly on the allegro.cc forums. They usually like to help new users :)"}, {"owner": {"reputation": 1, "user_id": 2233858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1edb261004410e3fffb71ed835298f5?s=128&d=identicon&r=PG", "display_name": "unlink", "link": "https://stackoverflow.com/users/2233858/unlink"}, "reply_to_user": {"reputation": 593, "user_id": 1955945, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qt3vW.png?s=128&g=1", "display_name": "rlam12", "link": "https://stackoverflow.com/users/1955945/rlam12"}, "edited": false, "score": 0, "creation_date": 1467653428, "post_id": 38084700, "comment_id": 63805081, "body": "Seems like a good idea :) Thanks"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 2233858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1edb261004410e3fffb71ed835298f5?s=128&d=identicon&r=PG", "display_name": "unlink", "link": "https://stackoverflow.com/users/2233858/unlink"}, "edited": false, "score": 0, "creation_date": 1467148197, "post_id": 38085452, "comment_id": 63608972, "body": "Yes I am, I added a code example as an edit in the main question."}], "tags": [], "owner": {"reputation": 1118, "user_id": 6373949, "user_type": "registered", "accept_rate": 64, "profile_image": "https://lh4.googleusercontent.com/-EYY_IdaEeaU/AAAAAAAAAAI/AAAAAAAAAfs/feCbMbQ8tZ4/photo.jpg?sz=128", "display_name": "Aipi", "link": "https://stackoverflow.com/users/6373949/aipi"}, "is_accepted": false, "score": 0, "last_activity_date": 1467144795, "creation_date": 1467144795, "answer_id": 38085452, "question_id": 38084700, "link": "https://stackoverflow.com/questions/38084700/allegro-5-2-compilation-errors/38085452#38085452", "title": "Allegro 5.2 compilation errors", "body": "<p>Are using <code>al_map_rgb_f()</code> function to mapping the color, like this: <code>al_clear_to_color(al_map_rgb(255, 255, 255));</code>? </p>\n\n<p>Can you insert your code here?</p>\n\n<p>Sorry, it shouldn't be an answer, for while I don't have a reputation to comment it. </p>\n"}, {"comments": [{"owner": {"reputation": 3727, "user_id": 4084574, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/cgyc0.jpg?s=128&g=1", "display_name": "mhatch", "link": "https://stackoverflow.com/users/4084574/mhatch"}, "edited": false, "score": 0, "creation_date": 1478012012, "post_id": 40361974, "comment_id": 67978132, "body": "This might be better as a comment"}], "tags": [], "owner": {"reputation": 11, "user_id": 4214512, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NnFhZ.jpg?s=128&g=1", "display_name": "kraxie", "link": "https://stackoverflow.com/users/4214512/kraxie"}, "is_accepted": false, "score": 0, "last_activity_date": 1478009997, "creation_date": 1478009997, "answer_id": 40361974, "question_id": 38084700, "link": "https://stackoverflow.com/questions/38084700/allegro-5-2-compilation-errors/40361974#40361974", "title": "Allegro 5.2 compilation errors", "body": "<p>I can see in your linker settings that you both link the monolith version and all modules separately. The monolith version is all other modules combined into one, making you only not need all the other allegro_* libraries. Maybe there's a conflict there? Other than that, check the log and check if the issue is both with Debug and Release.</p>\n"}, {"tags": [], "owner": {"reputation": 199, "user_id": 4883238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbdd8a03ea95fc24d6fd7087fc215c26?s=128&d=identicon&r=PG&f=1", "display_name": "BugSquasher", "link": "https://stackoverflow.com/users/4883238/bugsquasher"}, "is_accepted": false, "score": 0, "last_activity_date": 1553272231, "creation_date": 1553272231, "answer_id": 55304002, "question_id": 38084700, "link": "https://stackoverflow.com/questions/38084700/allegro-5-2-compilation-errors/55304002#55304002", "title": "Allegro 5.2 compilation errors", "body": "<p>Your linker settings are all messed up. You're mixing both dynamic and static libraries, as well as monolithic and non-monolithic libraries.</p>\n\n<p>Libraries ending in .dll.a are import archives. Libraries ending in just .a are static library archives. When you link to the dynamic allegro monolith, you do not need to link to anything else.</p>\n\n<p>When you link to the static allegro libraries, you must link their dependencies as well.</p>\n\n<p>As an aside, I generally don't recommend using the 'link libraries' pane in the Code Blocks project linker settings. Set the linker include directores and the linker options instead. It allows you to change your link directory at will without changing any library link options. That way, you can upgrade your allegro and other libraries at will. Otherwise you have to remove and re-add all the link libraries.</p>\n"}], "owner": {"reputation": 1, "user_id": 2233858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1edb261004410e3fffb71ed835298f5?s=128&d=identicon&r=PG", "display_name": "unlink", "link": "https://stackoverflow.com/users/2233858/unlink"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 251, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1553272231, "creation_date": 1467141990, "last_edit_date": 1467148579, "question_id": 38084700, "link": "https://stackoverflow.com/questions/38084700/allegro-5-2-compilation-errors", "title": "Allegro 5.2 compilation errors", "body": "<p>I've been trying to work with Allegro version 5.2, but for some reason I cannot get it to compile on my System (running Windows 10 64 bit) using MinGW.</p>\n\n<p><a href=\"http://i.stack.imgur.com/Ntv3U.png\" rel=\"nofollow\">My Linker Settings</a></p>\n\n<p>here's what I'm trying to link. According to the wiki this should be right, but whenever I try to compile sample code I get errors such as</p>\n\n<pre><code>src\\game.c|13|undefined reference to `al_clear_to_color'|\n</code></pre>\n\n<p>This function should be present for all I know.</p>\n\n<p>I really appreciate any help :)</p>\n\n<p>Here's an example of code that won't compile</p>\n\n<pre><code>#include\"../include/init.h\"\n\n#include \"allegro5/allegro5.h\"\n#include\"allegro5/allegro_audio.h\"\n#include\"allegro5/allegro_acodec.h\"\n#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n\nconst float fps = 30;\nconst int width = 256;\nconst int height = 240;\n\nint init() {\n    running = 1;\n\n    if(!al_init()) {\n        fprintf(stderr, \"failed to initialize allegro!\\n\");\n        return -1;\n    }\n\n    timer = al_create_timer(1.0 / fps);\n    if(!timer) {\n        fprintf(stderr, \"failed to create timer!\\n\");\n        return -1;\n    }\n\n    display = al_create_display(width, height);\n    if(!display) {\n        fprintf(stderr, \"failed to create display!\\n\");\n        return -1;\n    }\n\n    event_queue = al_create_event_queue();\n    if(!event_queue) {\n        fprintf(stderr, \"failed to create event_queue!\\n\");\n        return -1;\n    }\n\n    /*if(!al_install_audio()){\n        fprintf(stderr, \"failed to initialize audio!\\n\");\n        return -1;\n    }\n\n    if(!al_install_keyboard()) {\n        fprintf(stderr, \"failed to initialize the keyboard!\\n\");\n        return -1;\n    }\n\n    if(!al_init_acodec_addon()){\n        fprintf(stderr, \"failed to initialize audio codecs!\\n\");\n        return -1;\n    }\n\n    if (!al_reserve_samples(1)){\n        fprintf(stderr, \"failed to reserve samples!\\n\");\n        return -1;\n    }*/\n\n    if(!al_init_primitives_addon()) {\n        fprintf(stderr, \"failed to create primitives addon\");\n        return -1;\n    }\n\n\n    al_register_event_source(event_queue, al_get_display_event_source(display));\n\n    // register timer event for max fps\n    al_register_event_source(event_queue, al_get_timer_event_source(timer));\n    //al_register_event_source(event_queue, al_get_keyboard_event_source());\n\n    al_clear_to_color(al_map_rgb(0,0,0));\n\n    al_flip_display();\n\n    al_start_timer(timer);\n\n    return 1;\n}\n</code></pre>\n"}, {"tags": ["php", "c", "crc"], "comments": [{"owner": {"reputation": 339644, "user_id": 118068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/077db5466d3b58e7bbbd498dca173f04?s=128&d=identicon&r=PG", "display_name": "Marc B", "link": "https://stackoverflow.com/users/118068/marc-b"}, "edited": false, "score": 2, "creation_date": 1467141287, "post_id": 38084462, "comment_id": 63605262, "body": "don&#39;t forget that php&#39;s ints are always 32bit or 64bit internally. bit overflows that can occur with a 16bit C int won&#39;t happen in php because there&#39;s plenty of &quot;extra&quot; bits to hold that overflow."}, {"owner": {"reputation": 139130, "user_id": 141172, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Vuodg.jpg?s=128&g=1", "display_name": "Eric J.", "link": "https://stackoverflow.com/users/141172/eric-j"}, "edited": false, "score": 2, "creation_date": 1467141394, "post_id": 38084462, "comment_id": 63605326, "body": "Have you considered using the built-in CRC computation? <a href=\"http://php.net/manual/en/function.crc32.php\" rel=\"nofollow noreferrer\">php.net/manual/en/function.crc32.php</a>"}, {"owner": {"reputation": 490, "user_id": 3877184, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bXn5B.jpg?s=128&g=1", "display_name": "fkupper", "link": "https://stackoverflow.com/users/3877184/fkupper"}, "reply_to_user": {"reputation": 139130, "user_id": 141172, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Vuodg.jpg?s=128&g=1", "display_name": "Eric J.", "link": "https://stackoverflow.com/users/141172/eric-j"}, "edited": false, "score": 0, "creation_date": 1467141784, "post_id": 38084462, "comment_id": 63605535, "body": "@EricJ. Yes, but I can&#39;t because I must run in compatibility with a the C algorithm, which I can&#39;t change."}], "answers": [{"comments": [{"owner": {"reputation": 490, "user_id": 3877184, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bXn5B.jpg?s=128&g=1", "display_name": "fkupper", "link": "https://stackoverflow.com/users/3877184/fkupper"}, "edited": false, "score": 0, "creation_date": 1467144779, "post_id": 38084654, "comment_id": 63607237, "body": "Nice! If my input is a 16 base string and I replace (ord($data[$a]) for intval($data[$a].$data[$a++],16) it should work, right?"}, {"owner": {"reputation": 21326, "user_id": 1679849, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpvxY.png?s=128&g=1", "display_name": "r3mainer", "link": "https://stackoverflow.com/users/1679849/r3mainer"}, "reply_to_user": {"reputation": 490, "user_id": 3877184, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bXn5B.jpg?s=128&g=1", "display_name": "fkupper", "link": "https://stackoverflow.com/users/3877184/fkupper"}, "edited": false, "score": 0, "creation_date": 1467148627, "post_id": 38084654, "comment_id": 63609160, "body": "No, that won&#39;t work. Did you mean <code>$data[$a].$data[$a+1]</code> (followed by <code>$a += 2</code>)? I expect <code>hex2bin()</code> would be a faster way of converting hexadecimal data to binary."}, {"owner": {"reputation": 490, "user_id": 3877184, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bXn5B.jpg?s=128&g=1", "display_name": "fkupper", "link": "https://stackoverflow.com/users/3877184/fkupper"}, "edited": false, "score": 0, "creation_date": 1467201104, "post_id": 38084654, "comment_id": 63631716, "body": "Yes, I mean it. Good, I&#39;ll try it with hex2bin! Thanks."}, {"owner": {"reputation": 490, "user_id": 3877184, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bXn5B.jpg?s=128&g=1", "display_name": "fkupper", "link": "https://stackoverflow.com/users/3877184/fkupper"}, "edited": false, "score": 0, "creation_date": 1467208183, "post_id": 38084654, "comment_id": 63637000, "body": "Just edited the quesiton based on your help. Glad if you could take a second look at this."}], "tags": [], "owner": {"reputation": 21326, "user_id": 1679849, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpvxY.png?s=128&g=1", "display_name": "r3mainer", "link": "https://stackoverflow.com/users/1679849/r3mainer"}, "is_accepted": true, "score": 2, "last_activity_date": 1467141837, "creation_date": 1467141837, "answer_id": 38084654, "question_id": 38084462, "link": "https://stackoverflow.com/questions/38084462/translate-crc-alrgorythm-from-c-to-php/38084654#38084654", "title": "Translate CRC alrgorythm from C to PHP", "body": "<p>Your code isn't working because you're computing XOR products of integers and string variables:</p>\n\n<pre><code>$i = (($crc &gt;&gt; 12) ^ ($data[$a] &gt;&gt; 4));\n</code></pre>\n\n<p>Here <code>$data[$a]</code> is a substring of the input data. You should use <code>ord()</code> to convert this to an integer:</p>\n\n<pre><code>$i = (($crc &gt;&gt; 12) ^ (ord($data[$a]) &gt;&gt; 4));\n</code></pre>\n\n<p>(<strong>Edit:</strong> With this change to your PHP code, the string <code>Hello, world!</code> hashes to 31454 in both functions.)</p>\n"}], "owner": {"reputation": 490, "user_id": 3877184, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bXn5B.jpg?s=128&g=1", "display_name": "fkupper", "link": "https://stackoverflow.com/users/3877184/fkupper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 137, "favorite_count": 0, "accepted_answer_id": 38084654, "answer_count": 1, "score": 0, "last_activity_date": 1467223755, "creation_date": 1467141149, "last_edit_date": 1467223755, "question_id": 38084462, "link": "https://stackoverflow.com/questions/38084462/translate-crc-alrgorythm-from-c-to-php", "title": "Translate CRC alrgorythm from C to PHP", "body": "<h2><strong>SOLVED</strong></h2>\n\n<p>I have the following code on C and I have to write it on PHP</p>\n\n<pre><code>const U16 crc_table[16] = {\n    0x0000, 0x1021, 0x2042, 0x3063, 0x4084, 0x50a5, 0x60c6, 0x70e7,\n    0x8108, 0x9129, 0xa14a, 0xb16b, 0xc18c, 0xd1ad, 0xe1ce, 0xf1ef\n};\n\nU16 CalculateCrc(char *data, U32 len) {\n    U32 i;\n    U16 crc = 0;\n\n    while (len--) {\n        i = (crc &gt;&gt; 12) ^ (*data &gt;&gt; 4);\n        crc = crc_table[i &amp; 0x0F] ^ (crc &lt;&lt; 4);\n        i = (crc &gt;&gt; 12) ^ (*data &gt;&gt; 0);\n        crc = crc_table[i &amp; 0x0F] ^ (crc &lt;&lt; 4);\n        data++;\n    }\n    return (crc &amp; 0xFFFF);\n}\n</code></pre>\n\n<p>In a basic logic translation, I did this so far:</p>\n\n<pre><code>public function crc($data){\n\n        $i = 0;\n        $crc = 0;\n\n        /* @var $crc_table array */\n        $crc_table = array\n            (\n                0x0000, 0x1021, 0x2042, 0x3063, 0x4084, 0x50a5, 0x60c6, 0x70e7,\n                0x8108, 0x9129, 0xa14a, 0xb16b, 0xc18c, 0xd1ad, 0xe1ce, 0xf1ef\n            );\n\n        for($a = 0; $a &lt; strlen($data); $a++){\n            $i = (($crc &gt;&gt; 12) ^ ($data[$a] &gt;&gt; 4));\n            $crc = ($crc_table[$i &amp; 0x0F] ^ ($crc &lt;&lt; 4));\n            $i = (($crc &gt;&gt; 12) ^ $data[$a]);\n            $crc = ($crc_table[$i &amp; 0x0F] ^ ($crc &lt;&lt; 4));\n        }\n\n\n\n        return ($crc &amp; 0xFFFF);\n\n    }\n</code></pre>\n\n<p>The results are not matching by no means and I'm no expert on this kind of thing. Any suggestion?</p>\n\n<hr>\n\n<p><strong>EDIT</strong></p>\n\n<p>Thanks \"squeamish ossifrage\"!\nBased on your help, I'm using to this function now:</p>\n\n<pre><code>private function crc($data){\n\n        $i = 0;\n        $crc = 0;\n\n        $crc_table = array\n            (\n                0x0000, 0x1021, 0x2042, 0x3063, 0x4084, 0x50a5, 0x60c6, 0x70e7,\n                0x8108, 0x9129, 0xa14a, 0xb16b, 0xc18c, 0xd1ad, 0xe1ce, 0xf1ef\n            );\n\n        $data = hex2bin($data);\n        $l = 0;\n        while($l &lt; strlen($data)){\n\n            $byte = $data[$l];\n            $i = (($crc &gt;&gt; 12) ^ (ord($byte) &gt;&gt; 4));\n            $crc = ($crc_table[$i &amp; 0x0F] ^ ($crc &lt;&lt; 4));\n            $i = (($crc &gt;&gt; 12) ^ (ord($byte) &gt;&gt; 4));\n            $crc = ($crc_table[$i &amp; 0x0F] ^ ($crc &lt;&lt; 4));\n            $l++;\n        }\n\n        return ($crc &amp; 0xFFFF);\n\n    }\n</code></pre>\n\n<p>I'm testing it with \"Hello world\" as hex \"48656C6C6F20776F726C64\".\nOn C I get 37278 and on php function above 56062.</p>\n\n<p>Any clues now?</p>\n\n<hr>\n\n<p>EDIT</p>\n\n<p>Ok, my bad...the problem was already solved but I have confused myself after so many tests.</p>\n\n<p>This is my first version of the code with the suggested correction by \"squeamish ossifrage\":</p>\n\n<pre><code>$byte = $data[$l];\n$i = (($crc &gt;&gt; 12) ^ (ord($byte) &gt;&gt; 4));\n$crc = ($crc_table[$i &amp; 0x0F] ^ ($crc &lt;&lt; 4));\n$i = (($crc &gt;&gt; 12) ^ **ord($byte));**\n$crc = ($crc_table[$i &amp; 0x0F] ^ ($crc &lt;&lt; 4));\n$l++;\n</code></pre>\n\n<p>Thanks!</p>\n"}, {"tags": ["c", "opengl", "transparency", "sdl-2"], "answers": [{"tags": [], "owner": {"reputation": 38487, "user_id": 2327517, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0Bulc.jpg?s=128&g=1", "display_name": "derhass", "link": "https://stackoverflow.com/users/2327517/derhass"}, "is_accepted": true, "score": 4, "last_activity_date": 1467140401, "creation_date": 1467140401, "answer_id": 38084229, "question_id": 38083917, "link": "https://stackoverflow.com/questions/38083917/cannot-set-alpha-channel-to-0-in-opengl-sdl2/38084229#38084229", "title": "Cannot set Alpha channel to 0 in OpenGL + SDL2", "body": "<p>By default, SDL will not explictely request a framebuffer with an alpha channel. You'll have to call</p>\n\n<pre><code>SDL_GL_SetAttribute(SDL_GL_ALPHA_SIZE, 1);\n</code></pre>\n\n<p>before you create the window to make sure that you actually get an alpha buffer. Note that this conceptually requests at least 1 bit alpha. Usually, GL implementations provide pixel formats/visuals with either 0 or 8 bits of alpha per pixel. If you want to make sure to get at least 8 bits, you could also request that explicitely. </p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4085386"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 271, "favorite_count": 1, "accepted_answer_id": 38084229, "answer_count": 1, "score": 3, "last_activity_date": 1467235159, "creation_date": 1467139361, "last_edit_date": 1467235159, "question_id": 38083917, "link": "https://stackoverflow.com/questions/38083917/cannot-set-alpha-channel-to-0-in-opengl-sdl2", "title": "Cannot set Alpha channel to 0 in OpenGL + SDL2", "body": "<p>I am trying to save <code>OpenGL rendered screen</code> to <code>PNG</code> image with transparent background. But all I am getting in the 4th channel is all <code>255</code> values.</p>\n\n<p>Even before drawing anything on screen and just clearing does not help.</p>\n\n<p>What I have done in OpenGL for initialization to get the transparent background is roughly the following:</p>\n\n<pre><code>gWindow = SDL_CreateWindow(\"View\", SDL_WINDOWPOS_UNDEFINED, \n         SDL_WINDOWPOS_UNDEFINED, width, height,\n         SDL_WINDOW_OPENGL|SDL_WINDOW_SHOWN|SDL_WINDOW_RESIZABLE);\ngContext = SDL_GL_CreateContext(gWindow);\nGLfloat clear_col[4] = {0.0, 0.0, 0.0, 0.0};\n\nglMatrixMode(GL_PROJECTION);\nglLoadIdentity();\ngluPerspective(fov, width/(float)height, nearplane, farplane);\nglMatrixMode(GL_MODELVIEW);\nglLoadIdentity();\nglEnable(GL_BLEND);\nglBlendFunc(GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA);\nglClearColor(clear_col[0], clear_col[1], clear_col[2], clear_col[3]);\nglEnable(GL_DEPTH_TEST);\nglDepthFunc(GL_LESS);\nglShadeModel(GL_FLAT);\nglClear(GL_COLOR_BUFFER_BIT|GL_DEPTH_BUFFER_BIT);\npixels = (unsigned char*) malloc(width*height*4);\nglReadPixels(0, 0, width, height, GL_RGBA, GL_UNSIGNED_BYTE, pixels);\n// checking the values\nFILE*ffp = fopen(\"saved.bin\", \"wb\");\nfwrite(pixels, width*height*4, 1, ffp);\nfclose(ffp);\n</code></pre>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 4, "creation_date": 1467139282, "post_id": 38083852, "comment_id": 63604169, "body": "So the username is entered using <code>getchar</code> and terminated with <code>\\n</code>, but the password is entered with <code>getch</code> and terminated with <code>\\r</code>... Hmm... interesting."}, {"owner": {"reputation": 7787, "user_id": 1257035, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WHLC8.png?s=128&g=1", "display_name": "a3f", "link": "https://stackoverflow.com/users/1257035/a3f"}, "edited": false, "score": 1, "creation_date": 1467139346, "post_id": 38083852, "comment_id": 63604201, "body": "Also, how do you think <code>strcmp</code> knows how many characters to compare?"}, {"owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "edited": false, "score": 2, "creation_date": 1467139606, "post_id": 38083852, "comment_id": 63604335, "body": "Please consider using <code>fgets()</code> on <code>stdin</code> to read in a whole line (remember that the <code>&#39;\\n&#39;</code> will be included) rather than re-implementing it yourself."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1467139678, "post_id": 38083852, "comment_id": 63604371, "body": "Curious use of <code>float ret1; ... ret1 = strcmp(...)</code>. suggest <code>int ret1;</code>."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 5202956, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9Fcqp.jpg?s=128&g=1", "display_name": "F.And", "link": "https://stackoverflow.com/users/5202956/f-and"}, "edited": false, "score": 0, "creation_date": 1467139829, "post_id": 38083938, "comment_id": 63604468, "body": "Thanks, but if I write \\r instead of \\n I have problem (I have to press enter many times). So what should I write?"}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "reply_to_user": {"reputation": 11, "user_id": 5202956, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9Fcqp.jpg?s=128&g=1", "display_name": "F.And", "link": "https://stackoverflow.com/users/5202956/f-and"}, "edited": false, "score": 0, "creation_date": 1467140499, "post_id": 38083938, "comment_id": 63604832, "body": "@F.And, are you talking about the program, or entering input for the program?"}, {"owner": {"reputation": 11, "user_id": 5202956, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9Fcqp.jpg?s=128&g=1", "display_name": "F.And", "link": "https://stackoverflow.com/users/5202956/f-and"}, "edited": false, "score": 0, "creation_date": 1467142570, "post_id": 38083938, "comment_id": 63605973, "body": "@R Sahu I am talking about the part of the programm you mentioned. If you run it you will see the problem. I can&#39;t explain it."}, {"owner": {"reputation": 11, "user_id": 5202956, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9Fcqp.jpg?s=128&g=1", "display_name": "F.And", "link": "https://stackoverflow.com/users/5202956/f-and"}, "edited": false, "score": 0, "creation_date": 1467144776, "post_id": 38083938, "comment_id": 63607235, "body": "@R Sahu Should I do the same for the password?"}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "reply_to_user": {"reputation": 11, "user_id": 5202956, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9Fcqp.jpg?s=128&g=1", "display_name": "F.And", "link": "https://stackoverflow.com/users/5202956/f-and"}, "edited": false, "score": 0, "creation_date": 1467144927, "post_id": 38083938, "comment_id": 63607310, "body": "@F.And, definitely yes."}, {"owner": {"reputation": 11, "user_id": 5202956, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9Fcqp.jpg?s=128&g=1", "display_name": "F.And", "link": "https://stackoverflow.com/users/5202956/f-and"}, "edited": false, "score": 0, "creation_date": 1467145493, "post_id": 38083938, "comment_id": 63607611, "body": "@R Sahu Ok. Thank you very much! So after this is it supposed to run correctly?"}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "reply_to_user": {"reputation": 11, "user_id": 5202956, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9Fcqp.jpg?s=128&g=1", "display_name": "F.And", "link": "https://stackoverflow.com/users/5202956/f-and"}, "edited": false, "score": 0, "creation_date": 1467145705, "post_id": 38083938, "comment_id": 63607731, "body": "@F.And, it should."}, {"owner": {"reputation": 11, "user_id": 5202956, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9Fcqp.jpg?s=128&g=1", "display_name": "F.And", "link": "https://stackoverflow.com/users/5202956/f-and"}, "edited": false, "score": 0, "creation_date": 1467201135, "post_id": 38083938, "comment_id": 63631742, "body": "Where should I insert the command \u201cputchar (&#39;<i>&#39;);\u201d so the password is hidden? I tried in many ways but I couldn\u2019t sort it out. Do I need to change \u201cgetchar\u201d to \u201cgetch\u201d?\t      for(i=0; i&lt;MAX_PASSWORD_LENGTH;){     int d = getchar();      if ( d == &#39;\\r&#39; )     {         // Ignore it.         // Don&#39;t increment i for this.     }     else if ( d == &#39;\\n&#39;)     {         break;     }     else     {         // Store the character and increment i.         password_entered[i] = d;         i++;     }     putchar (&#39;</i>&#39;);     }     password_entered[i] = &#39;\\0&#39;;"}], "tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": true, "score": 4, "last_activity_date": 1467143742, "last_edit_date": 1467143742, "creation_date": 1467139442, "answer_id": 38083938, "question_id": 38083852, "link": "https://stackoverflow.com/questions/38083852/c-why-it-cant-run-correctly-i-am-new-to-c/38083938#38083938", "title": "C - Why it can&#39;t run correctly? I am new to C", "body": "<p>I see couple of problems.</p>\n\n<ol>\n<li>You are including the <code>'\\n'</code> in the name when accepting user input.</li>\n<li>You are <em>not</em> terminating the name with a null character.</li>\n</ol>\n\n<p>Tweak your code a little bit to fix those.</p>\n\n<pre><code>for(i=0; i&lt;MAX_USERNAME_LENGTH; /* i++ Increment i only in one branch */){\n   int c = getchar();\n   if ( c == '\\r' )\n   {\n      // Ignore it.\n      // Don't increment i for this.\n   }\n   else if ( c == '\\n')\n   {\n      break;\n   }\n   else\n   {\n      // Store the character and increment i.\n      username_entered[i] = c;\n      i++;\n   }\n}\nusername_entered[i] = '\\0';\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5202956, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9Fcqp.jpg?s=128&g=1", "display_name": "F.And", "link": "https://stackoverflow.com/users/5202956/f-and"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "accepted_answer_id": 38083938, "answer_count": 1, "score": -1, "last_activity_date": 1467201203, "creation_date": 1467139101, "last_edit_date": 1467139304, "question_id": 38083852, "link": "https://stackoverflow.com/questions/38083852/c-why-it-cant-run-correctly-i-am-new-to-c", "title": "C - Why it can&#39;t run correctly? I am new to C", "body": "<p>The following code is running, but when I enter the username and the correct password it is always printing \"<em>The username doesn't exist. Try again with another username please.</em>\" Why?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#define MAX_PASSWORD_LENGTH 10\n#define MAX_USERNAME_LENGTH 10\n#define MAX_USERS 15\n\nint main(void) {\n\n  char usernames[MAX_USERS][MAX_USERNAME_LENGTH + 1] = { \"nnikolaou\", \"stakis\",\n      \"sanitsaki\" };\n\n  char passwords[MAX_USERS][MAX_PASSWORD_LENGTH + 1] = { \"n32\", \"s4343\",\n      \"s5343\" };\n\n  char user_access_rights[MAX_USERS] = { 'r', 'a', 's' };\n\n  int i;\n  char username_entered[MAX_USERNAME_LENGTH + 1];\n\n  char password_entered[MAX_PASSWORD_LENGTH + 1];\n\n  float ret1;\n\n  int abc;\n\n  int username_position;\n\n  abc = 0;\n\n  printf(\"Enter username please, with a maximum length of %ld characters:\",\n      MAX_USERNAME_LENGTH);\n\n  for (i = 0; i &lt; MAX_USERNAME_LENGTH; i++) {\n    username_entered[i] = getchar();\n    if (username_entered[i] == '\\n') {\n      break;\n    }\n  }\n  printf(\"Enter password please, with a maximum length of %ld characters:\",\n      MAX_PASSWORD_LENGTH);\n  for (i = 0; i &lt; MAX_PASSWORD_LENGTH; i++) {\n\n    password_entered[i] = getch();\n    if (password_entered[i] == '\\r') {\n      break;\n    }\n\n    putchar('*');\n  }\n\n  for (i = 0; i &lt; MAX_USERS; i++) {\n    ret1 = strcmp(username_entered, usernames[i]);\n\n    if (ret1 == 0) {\n      username_position = i;\n      abc = 1;\n      printf(\"\\n\");\n      printf(\"The username has been found.\");\n    } else {\n      if (i == MAX_USERS + 1) {\n        abc = 0;\n      }\n    }\n  }\n\n  if (abc == 0) {\n    printf(\"\\n\");\n    printf(\n        \"The username doesn't exist. Try again with another username please.\");\n    printf(\"\\n\");\n    return 1;\n  }\n\n  return 0;\n}\n</code></pre>\n\n<p>I believe that it is problem of <strong>strcmp</strong>. It should be written in this way, using strcmp.</p>\n"}, {"tags": ["c", "nginx"], "comments": [{"owner": {"reputation": 18613, "user_id": 818182, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/89b420763192c3b763f4cffa789fe39f?s=128&d=identicon&r=PG", "display_name": "Austin Brunkhorst", "link": "https://stackoverflow.com/users/818182/austin-brunkhorst"}, "edited": false, "score": 0, "creation_date": 1467138782, "post_id": 38083714, "comment_id": 63603866, "body": "I think a better solution may be to only apply the rewrite if the requested filename doesn&#39;t exist. <a href=\"http://stackoverflow.com/questions/595005/redirect-requests-only-if-the-file-is-not-found\">Take a look at this question</a>."}, {"owner": {"reputation": 775, "user_id": 4114983, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/c1b7b7b028fede548b2a11789a23a879?s=128&d=identicon&r=PG&f=1", "display_name": "Romulus", "link": "https://stackoverflow.com/users/4114983/romulus"}, "reply_to_user": {"reputation": 18613, "user_id": 818182, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/89b420763192c3b763f4cffa789fe39f?s=128&d=identicon&r=PG", "display_name": "Austin Brunkhorst", "link": "https://stackoverflow.com/users/818182/austin-brunkhorst"}, "edited": false, "score": 1, "creation_date": 1467139127, "post_id": 38083714, "comment_id": 63604078, "body": "@AustinBrunkhorst I would be willing to use that solution, but it seems to be for apache and my issue is getting the syntax right. Ill look for nginx solutions like that"}], "answers": [{"tags": [], "owner": {"reputation": 775, "user_id": 4114983, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/c1b7b7b028fede548b2a11789a23a879?s=128&d=identicon&r=PG&f=1", "display_name": "Romulus", "link": "https://stackoverflow.com/users/4114983/romulus"}, "is_accepted": false, "score": 1, "last_activity_date": 1467139538, "last_edit_date": 1495542778, "creation_date": 1467139538, "answer_id": 38083976, "question_id": 38083714, "link": "https://stackoverflow.com/questions/38083714/simple-nginx-if-statement-in-c/38083976#38083976", "title": "simple nginx if statement in C", "body": "<p>After following the apache solution suggested in this comment:</p>\n\n<p>\"I think a better solution may be to only apply the rewrite if the requested filename doesn't exist. Take a look at this question. <a href=\"https://stackoverflow.com/questions/595005/redirect-requests-only-if-the-file-is-not-found\">Redirect requests only if the file is not found?</a> \"</p>\n\n<p>I converted that functionality to nginx and got:</p>\n\n<pre><code>location / {\n    try_files $uri $uri/ =404;\n    if (-f $request_filename) {\n            break;\n    }\n    rewrite ^/(.*)/(.*) /search.php?name=$1&amp;last=$2\n}\n</code></pre>\n\n<p>This makes the url rewrite only if there is no file found at the given directory path</p>\n"}], "owner": {"reputation": 775, "user_id": 4114983, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/c1b7b7b028fede548b2a11789a23a879?s=128&d=identicon&r=PG&f=1", "display_name": "Romulus", "link": "https://stackoverflow.com/users/4114983/romulus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1467139538, "creation_date": 1467138583, "question_id": 38083714, "link": "https://stackoverflow.com/questions/38083714/simple-nginx-if-statement-in-c", "title": "simple nginx if statement in C", "body": "<p>I have this line of code in my /etc/nginx/sites-available/default page:</p>\n\n<pre><code>rewrite ^/(.*)/(.*) /search.php?name=$1&amp;last=$2\n</code></pre>\n\n<p>It accomplished what I wanted: cleaner urls for linking</p>\n\n<p>example.com/john/smith is forwarded properly to the PHP GET.</p>\n\n<p>But, it also destroyed all my styling and image links.</p>\n\n<p>So I would like the rewrite to occur only if the first word is neither css nor image.</p>\n\n<p>But I can only find if statements for GET arguments in the url not for directoies in the url like this:</p>\n\n<pre><code>if ($args ~* \"/?param1=val1&amp;param2=val2&amp;\") {\n      rewrite ^ http://www.example.com/newparam/$arg_param1/$arg_param2? last;\n}\n</code></pre>\n"}, {"tags": ["c", "pgm"], "comments": [{"owner": {"reputation": 2682, "user_id": 4072843, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tKkUM.jpg?s=128&g=1", "display_name": "Castaglia", "link": "https://stackoverflow.com/users/4072843/castaglia"}, "edited": false, "score": 0, "creation_date": 1467138126, "post_id": 38083527, "comment_id": 63603467, "body": "What sort of code/approaches have you already tried?"}, {"owner": {"reputation": 4418, "user_id": 5264388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/160f1b756f3f4a0ba9a2a58f4cce911b?s=128&d=identicon&r=PG", "display_name": "owacoder", "link": "https://stackoverflow.com/users/5264388/owacoder"}, "edited": false, "score": 0, "creation_date": 1467138138, "post_id": 38083527, "comment_id": 63603472, "body": "To open as binary just use <code>fopen(filename, &quot;wb&quot;)</code>."}], "owner": {"reputation": 1, "user_id": 6524863, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d4e375f477ea7758bfa550d71d53c43?s=128&d=identicon&r=PG&f=1", "display_name": "JaneGolly", "link": "https://stackoverflow.com/users/6524863/janegolly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 76, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1467137906, "creation_date": 1467137906, "question_id": 38083527, "link": "https://stackoverflow.com/questions/38083527/how-to-create-a-or-modify-an-existing-pgm-5-file-in-c", "title": "How to create a (or modify an existing) pgm 5 file in C?", "body": "<p>For example say I want to create a 100x100 pgm file, how do I proceed? It's different than creating and modifying a text file as I'll have to open it as binary.</p>\n"}]