[{"tags": ["c"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1556150602, "post_id": 55839995, "comment_id": 98343666, "body": "Don&#39;t mix <code>fgets</code> with <code>fscanf</code> and please see <a href=\"http://stackoverflow.com/questions/5431941/why-is-while-feof-file-always-wrong\">Why is <code>while ( !feof (file) )</code> always wrong?</a>"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1556150730, "post_id": 55839995, "comment_id": 98343681, "body": "If you want to use <code>fgets</code>, then you should read <i>every</i> line with <code>fgets</code>. You can use <code>sscanf</code> to extract the contents from a line."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1556150829, "post_id": 55839995, "comment_id": 98343692, "body": "<a href=\"https://stackoverflow.com/questions/5431941\">Also, you should never use <code>feof</code></a>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1556151930, "post_id": 55839995, "comment_id": 98343863, "body": "Curious: Who or what text suggested using <code>feof()</code>?"}, {"owner": {"reputation": 1, "user_id": 10947881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ac691bc2dc3018e40efb1a9bc786518?s=128&d=identicon&r=PG&f=1", "display_name": "Ely Meyers", "link": "https://stackoverflow.com/users/10947881/ely-meyers"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1556152192, "post_id": 55839995, "comment_id": 98343905, "body": "@user3386109 I&#39;d rather just use fscanf but as I posted in my edit above, there&#39;s obviously some other additional problem I&#39;m having, but I&#39;m not sure what it is."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1556154011, "post_id": 55839995, "comment_id": 98344216, "body": "You can do <a href=\"https://stackoverflow.com/questions/55839397/\">something like this</a>."}], "answers": [{"tags": [], "owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "is_accepted": false, "score": 2, "last_activity_date": 1556178750, "last_edit_date": 1556178750, "creation_date": 1556152943, "answer_id": 55840332, "question_id": 55839995, "link": "https://stackoverflow.com/questions/55839995/error-populating-an-array-from-a-txt-file/55840332#55840332", "title": "Error populating an array from a txt file", "body": "<p>It is easier to control the input and data extraction by using <code>fgets</code> and <code>sscanf</code> than with <code>fscanf</code>, like this, with some other commented changes and additions.</p>\n\n<pre><code>#define _CRT_SECURE_NO_WARNINGS\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n\n#define RECORDS 200             // better not to hard-code inline\n#define NAMELEN 99\n\ntypedef struct employee {\n    char name[NAMELEN+1];       // employee's name - last, first\n    char title;                 // title 'B' or 'M'\n    double hours_worked;        // total number of hours worked\n    double payrate;             // pay rate per hour\n    double payment;             // total payment for the pay period \n} Employee;\n\nint main(void)\n{\n    char instr[256];\n    Employee payroll[RECORDS];\n    int records = 0;                            // `i` was a poor choice of name\n    FILE *infile;\n    infile = fopen(\"payroll.txt\", \"r\");\n    if(infile == NULL) {\n        perror(\"Could not open file\");\n        exit(1);                                // check file opened\n    }\n\n    // loop that will fill payroll array with data from file\n    while(fgets(instr, sizeof instr, infile) != NULL) {\n        // name\n        if(records &gt;= RECORDS) {\n            perror(\"Too many records\");\n            exit(1);\n        }\n        instr[ strcspn(instr, \"\\r\\n\") ] = 0;    // remove trailing newline etc\n        instr[NAMELEN] = 0;                     // truncate long name \n        strcpy(payroll[records].name, instr);\n\n        // title\n        if(fgets(instr, sizeof instr, infile) == NULL) {\n            perror(\"Incomplete data\");\n            exit(1);\n        }\n        payroll[records].title = instr[0];\n\n        // hours worked\n        if(fgets(instr, sizeof instr, infile) == NULL) {\n            perror(\"Incomplete data\");\n            exit(1);\n        }\n        if(sscanf(instr, \"%lf\", &amp;payroll[records].hours_worked) != 1) {\n            perror(\"Error in hours worked\");\n            exit(1);\n        }\n\n        // pay rate\n        if(fgets(instr, sizeof instr, infile) == NULL) {\n            perror(\"Incomplete data\");\n            exit(1);\n        }\n        if(sscanf(instr, \"%lf\", &amp;payroll[records].payrate) != 1) {\n            perror(\"Error in pay rate\");\n            exit(1);\n        }\n\n        ++records;\n    }\n    printf(\"%d records\\n\", records);\n\n    //loop that tests to make sure array was correctly filled\n    for (int i = 0; i &lt; records; ++i) {                 // use the variable\n        printf(\"%s\\n\", payroll[i].name);\n        printf(\"%c\\n\", payroll[i].title);\n        printf(\"%.2f\\n\", payroll[i].hours_worked);      // %f not %lf\n        printf(\"%.2f\\n\", payroll[i].payrate);           // specify dec places\n        printf(\"\\n\");\n    }\n\n    fclose(infile);\n    return 0;\n}\n</code></pre>\n\n<p>Program output:\n<PRE>\n4 records\nSmith,Susan\nB\n80.00\n17.76<BR>\nSanders,Fred\nM\n87.25\n23.45<BR>\nKerr,Heidi\nM\n80.00\n47.86<BR>\nRusso,Rick\nB\n83.75\n12.15\n</PRE></p>\n\n<p>Note that <code>feof</code> does not check for end-of-file. It checks whether you made an error by previously reading past the end-of-file (where there is no data).\n<HR>\nEdit: Alternatively, if you do want the solution to use <code>fscanf</code> here is</p>\n\n<pre><code>#define _CRT_SECURE_NO_WARNINGS\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n\n#define RECORDS 200             // better not to hard-code inline\n#define NAMELEN 99\n\ntypedef struct employee {\n    char name[NAMELEN+1];       // employee's name - last, first\n    char title;                 // title 'B' or 'M'\n    double hours_worked;        // total number of hours worked\n    double payrate;             // pay rate per hour\n    double payment;             // total payment for the pay period \n} Employee;\n\nint main(void)\n{\n    Employee payroll[RECORDS];\n    int records = 0;                                // `i` was a poor choice of name\n    FILE *infile;\n    infile = fopen(\"payroll.txt\", \"r\");\n    if(infile == NULL) {\n        perror(\"Could not open file\");\n        exit(1);                                    // check file opened\n    }\n\n    // loop that will fill payroll array with data from file\n    while(fscanf(infile, \" %99[^\\n] %c%lf%lf\",      // spaces remove the newlines\n             payroll[records].name,                 // no `&amp;`\n            &amp;payroll[records].title,\n            &amp;payroll[records].hours_worked, \n            &amp;payroll[records].payrate) == 4) {\n        ++records;\n    }\n    printf(\"%d records\\n\", records);\n\n    //loop that tests to make sure array was correctly filled\n    for (int i = 0; i &lt; records; ++i) {             // use the variable\n        printf(\"%s\\n\", payroll[i].name);\n        printf(\"%c\\n\", payroll[i].title);\n        printf(\"%.2f\\n\", payroll[i].hours_worked);  // %f not %lf\n        printf(\"%.2f\\n\", payroll[i].payrate);       // specify dec places\n        printf(\"\\n\");\n    }\n\n    fclose(infile);\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10947881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ac691bc2dc3018e40efb1a9bc786518?s=128&d=identicon&r=PG&f=1", "display_name": "Ely Meyers", "link": "https://stackoverflow.com/users/10947881/ely-meyers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1556178750, "creation_date": 1556149874, "last_edit_date": 1556152581, "question_id": 55839995, "link": "https://stackoverflow.com/questions/55839995/error-populating-an-array-from-a-txt-file", "title": "Error populating an array from a txt file", "body": "<p>I'm having trouble populating an array with data I'm trying to read from a txt file. So I used the following code to try and read from the following txt file.</p>\n\n<p>txt file:</p>\n\n<pre><code>Smith, Susan\nB\n80.0\n17.76\n\nSanders, Fred\nM\n87.25\n23.45\n\nKerr, Heidi\nM\n80.0\n47.86\n\nRusso, Rick\nB\n83.75\n12.15\n\n</code></pre>\n\n<p>code i used:</p>\n\n<pre><code>\n#define _CRT_SECURE_NO_WARNINGS\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n\n\ntypedef struct employee\n\n{\n\n    char name[100];      // employee's name - last, first\n\n    char title;          // title 'B' or 'M'\n\n    double hours_worked; // total number of hours worked\n\n    double payrate;      // pay rate per hour\n\n    double payment;      // total payment for the pay period \n\n} Employee;\n\nint main()\n{\n    Employee payroll[200];\n    int i = 0;\n    FILE*infile;\n    infile = fopen(\"payroll.txt\", \"r\");\n    //fscanf loop that will fill payroll array with data from file\n    while (!feof(infile))\n    {\n\n        fscanf(infile, \" %s\", &amp;payroll[i].name); //Reading name\n        fscanf(infile, \"%c\", &amp;payroll[i].title); //Reading title\n        fscanf(infile, \"%lf\", &amp;payroll[i].hours_worked); //Reading hours worked\n        fscanf(infile, \"%lf\", &amp;payroll[i].payrate); //Reading pay rate\n        ++i;\n    }\n    printf(\"%d\\n\", i);\n//loop that tests to make sure array was correctly filled\n    for (i = 0; i &lt; 4; ++i)\n    {\n        printf(\"%s\\n\", payroll[i].name);\n        printf(\"%c\\n\", payroll[i].title);\n        printf(\"%lf\\n\", payroll[i].hours_worked);\n        printf(\"%lf\\n\", payroll[i].payrate);\n\n    }\n\n\n\n\n\n    fclose(infile);\n    system(\"pause\");\n    return 0;\n}\n</code></pre>\n\n<p>So I realized that my issue had to be the first fscanf that's reading the string name because fscanf is stopping once it reads the white space where it reads the names so I switched to fgets():</p>\n\n<pre><code>\n        fgets(payroll[i].name, 100, infile);\n\n\n</code></pre>\n\n<p>But that still doesn't give me a correct result. </p>\n\n<p>Please help</p>\n\n<p>edit: So there's obviously something else wrong with my fscanfs because If I edited the txt file to this to eliminate the whitespace so fscanf can be used:</p>\n\n<pre><code>\nSmith,Susan\nB\n80.0\n17.76\nSanders,Fred\nM\n87.25\n23.45\nKerr,Heidi\nM\n80.0\n47.86\nRusso,Rick\nB\n83.75\n12.15\n</code></pre>\n\n<p>where I'm using this code: </p>\n\n<pre><code>\nwhile (!feof(infile))\n    {   \n        fscanf(infile, \" %s\", &amp;payroll[i].name); //Reading name\n        fscanf(infile, \"%c\", &amp;payroll[i].title); //Reading title\n        fscanf(infile, \"%lf\", &amp;payroll[i].hours_worked); //Reading hours worked\n        fscanf(infile, \"%lf\", &amp;payroll[i].payrate); //Reading pay rate\n        ++i;\n    }\n</code></pre>\n\n<p>I'll still get an error where the printresults are something crazy like this:\n<a href=\"https://i.stack.imgur.com/x6l7a.png\" rel=\"nofollow noreferrer\">https://i.stack.imgur.com/x6l7a.png</a></p>\n"}, {"tags": ["c++", "c", "windows", "winapi"], "comments": [{"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1556152768, "post_id": 55839993, "comment_id": 98343998, "body": "Which language, C or C++?  They are distinct languages.  For example, C++ has <code>std::string</code> and <code>std::transform</code>.  In C, you can have a variable or function called <code>class</code>."}], "answers": [{"tags": [], "owner": {"reputation": 8787, "user_id": 6601582, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd0a2f69702729da5aaa628bc58811a7?s=128&d=identicon&r=PG&f=1", "display_name": "Rita Han", "link": "https://stackoverflow.com/users/6601582/rita-han"}, "is_accepted": true, "score": 1, "last_activity_date": 1556164675, "creation_date": 1556164675, "answer_id": 55841600, "question_id": 55839993, "link": "https://stackoverflow.com/questions/55839993/copy-security-information/55841600#55841600", "title": "Copy Security information", "body": "<p>You can use <a href=\"https://docs.microsoft.com/en-us/windows/desktop/api/aclapi/nf-aclapi-getnamedsecurityinfoa\" rel=\"nofollow noreferrer\">GetNamedSecurityInfo</a>() to get all information you need like owner/group and access control(DACL/SACL) from the old file then Creating a Security Descriptor using information you've got and set the security descriptor when you create a new file (<a href=\"https://docs.microsoft.com/en-us/windows/desktop/api/fileapi/nf-fileapi-createfilea\" rel=\"nofollow noreferrer\">CreateFile</a>()).</p>\n\n<p>There are \"<a href=\"https://docs.microsoft.com/en-us/windows/desktop/SecAuthZ/modifying-the-acls-of-an-object-in-c--\" rel=\"nofollow noreferrer\">Modifying the ACLs of an Object in C++</a>\" and \"<a href=\"https://docs.microsoft.com/en-us/windows/desktop/SecAuthZ/creating-a-security-descriptor-for-a-new-object-in-c--\" rel=\"nofollow noreferrer\">Creating a Security Descriptor for a New Object in C++</a>\" you can refer to.</p>\n"}], "owner": {"reputation": 13, "user_id": 11401954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edcc9cdc697ad5c5c1921e406eb8d9ad?s=128&d=identicon&r=PG&f=1", "display_name": "J. Doe", "link": "https://stackoverflow.com/users/11401954/j-doe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 0, "accepted_answer_id": 55841600, "answer_count": 1, "score": 0, "last_activity_date": 1556164675, "creation_date": 1556149849, "last_edit_date": 1556152290, "question_id": 55839993, "link": "https://stackoverflow.com/questions/55839993/copy-security-information", "title": "Copy Security information", "body": "<p>Using C/C++ on Win32, I'm creating a new file <code>A</code> but I want to copy the exact security information from an old file <code>B</code>.  By security information, I mean groups/names and corresponding permissions. For example:</p>\n\n<p><a href=\"https://i.stack.imgur.com/b5XZU.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/b5XZU.png\" alt=\"Security Information (screenshot)\"></a></p>\n\n<p>What kind of <a href=\"https://docs.microsoft.com/en-us/windows/desktop/SecAuthZ/security-information\" rel=\"nofollow noreferrer\"><code>SECURITY_INFORMATION</code></a> do I need to copy?</p>\n"}, {"tags": ["c", "continue"], "comments": [{"owner": {"reputation": 528, "user_id": 4890944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6584bf69ef530c04cc2f2abc2bba08e3?s=128&d=identicon&r=PG&f=1", "display_name": "\u6c38\u52ab\u56de\u5e30", "link": "https://stackoverflow.com/users/4890944/%e6%b0%b8%e5%8a%ab%e5%9b%9e%e5%b8%b0"}, "edited": false, "score": 0, "creation_date": 1556151481, "post_id": 55839967, "comment_id": 98343793, "body": "Your question is unclear. Do you mean that you want a code with the same behavior without using a continue statement?"}, {"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 0, "creation_date": 1556152135, "post_id": 55839967, "comment_id": 98343898, "body": "Since the code for <code>a == 15</code> does exactly the same thing to <code>a</code> (i.e. increments it), but doesn&#39;t print it,  <code>while (a &lt; 20) {if (a != 15) print(&quot;%d&quot;, a&quot;);  ++a;}</code> will do it."}, {"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 1, "creation_date": 1556152658, "post_id": 55839967, "comment_id": 98343976, "body": "To emulate <code>continue</code>, you could use <code>goto</code> (not recommended) or a properly scoped <code>if else</code> statement."}], "answers": [{"comments": [{"owner": {"reputation": 57967, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "edited": false, "score": 0, "creation_date": 1556152531, "post_id": 55840266, "comment_id": 98343954, "body": "&quot;<code>continue</code> has no effect at all in your code&quot; false. It most definitely has an effect."}, {"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1556152635, "post_id": 55840266, "comment_id": 98343972, "body": "While I didn&#39;t downvote, I&#39;m unclear how both &quot;continue has no effect&quot; and &quot;15 doesn&#39;t print&quot; statements can be true."}, {"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 3, "creation_date": 1556153493, "post_id": 55840266, "comment_id": 98344139, "body": "I won&#39;t down vote - but does this answer the real question of &quot;What really is the <code>continue</code> doing so that I understand it well enough to replace it?&quot;  Yes, your code is simpler and executes how OP wants his code to run, but does it demonstrate a simple replacement for continue?"}, {"owner": {"reputation": 2449, "user_id": 500276, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/200bf76976f24add540182f5c3a42788?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Benningfield", "link": "https://stackoverflow.com/users/500276/mark-benningfield"}, "edited": false, "score": 0, "creation_date": 1556171540, "post_id": 55840266, "comment_id": 98347851, "body": "This answer solves the computational problem, but doesn&#39;t address the OP&#39;s question."}, {"owner": {"reputation": 4562, "user_id": 9254539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b45538511384660bfaef5092e30b7ea?s=128&d=identicon&r=PG&f=1", "display_name": "BessieTheCookie", "link": "https://stackoverflow.com/users/9254539/bessiethecookie"}, "edited": false, "score": 1, "creation_date": 1556600213, "post_id": 55840266, "comment_id": 98482631, "body": "In this case, the observable behavior of the code just happens to be the same both with and without the <code>continue</code>, but the way you said it is misleading and makes it seems like it does absolutely nothing."}, {"owner": {"reputation": 461, "user_id": 5741218, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-_8TKs_U1Ss4/AAAAAAAAAAI/AAAAAAAAABc/UN5oOyx9hT4/photo.jpg?sz=128", "display_name": "Nadim Baraky", "link": "https://stackoverflow.com/users/5741218/nadim-baraky"}, "reply_to_user": {"reputation": 4562, "user_id": 9254539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b45538511384660bfaef5092e30b7ea?s=128&d=identicon&r=PG&f=1", "display_name": "BessieTheCookie", "link": "https://stackoverflow.com/users/9254539/bessiethecookie"}, "edited": false, "score": 0, "creation_date": 1556832038, "post_id": 55840266, "comment_id": 98572392, "body": "@FeiXiang I totally agree; thanks for understanding my point. I totally recognize its importance and how it comes handy and helpful. But as we said, with or without it, it is the same in this case!"}], "tags": [], "owner": {"reputation": 461, "user_id": 5741218, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-_8TKs_U1Ss4/AAAAAAAAAAI/AAAAAAAAABc/UN5oOyx9hT4/photo.jpg?sz=128", "display_name": "Nadim Baraky", "link": "https://stackoverflow.com/users/5741218/nadim-baraky"}, "is_accepted": false, "score": -2, "last_activity_date": 1556152315, "creation_date": 1556152315, "answer_id": 55840266, "question_id": 55839967, "link": "https://stackoverflow.com/questions/55839967/how-to-write-a-program-for-continue-using-c/55840266#55840266", "title": "How to write a program for continue; using C", "body": "<p><code>continue</code> has no effect at all in your code.\nAnd your print function should be <code>printf</code>.</p>\n\n<p>The only number not being printed is 15.\nSo you can do this:</p>\n\n<pre><code>while(a &lt; 20) {\n     if(a != 15) printf(\"%d\", a);\n     a++; \n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "is_accepted": false, "score": 1, "last_activity_date": 1556152910, "creation_date": 1556152910, "answer_id": 55840326, "question_id": 55839967, "link": "https://stackoverflow.com/questions/55839967/how-to-write-a-program-for-continue-using-c/55840326#55840326", "title": "How to write a program for continue; using C", "body": "<p>Notice that the <code>else</code> statement here with proper scope emulates what a continue statement would do (which is to skip to the end of the while loop).  I have purposely left the rest of your code unchanged.</p>\n\n<pre><code>int a = 10;\nwhile(a &lt; 20){\n  if(a == 15){\n    a = a+1;\n//    continue;   \n  } else {\n    print (\"%d\", a);\n    a++;\n  }\n}\n</code></pre>\n\n<p>or if you want to invoke the wrath of the C gods</p>\n\n<pre><code>int a = 10;\nwhile(a &lt; 20){\n  if(a == 15){\n    a = a+1;\n//    continue;   \n    goto next;  // Really - don't do this...\n  }\n  print (\"%d\", a);\n  a++;\nnext:\n  }\n}\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 11194293, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ruRVQc0HwgI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcH8GNvwJa2kP2SUeAdXeCVznV9Yw/mo/photo.jpg?sz=128", "display_name": "Moey mnm", "link": "https://stackoverflow.com/users/11194293/moey-mnm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1556152910, "creation_date": 1556149591, "last_edit_date": 1556151308, "question_id": 55839967, "link": "https://stackoverflow.com/questions/55839967/how-to-write-a-program-for-continue-using-c", "title": "How to write a program for continue; using C", "body": "<p>How to execute the code without actually using the continue statement.\nIn other words, <strong>How can I write a program for continue; statement</strong> without using \"continue;\" (definition for continue;).</p>\n\n<p>Thanks in advance </p>\n\n<pre><code>int a = 10;\nwhile(a &lt; 20){\n  if(a == 15){\n    a = a+1;\n    continue;   \n  }\n  print (\"%d\", a);\n  a++;\n}\n</code></pre>\n"}, {"tags": ["c", "pointers", "linked-list", "segmentation-fault", "singly-linked-list"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1556149556, "post_id": 55839938, "comment_id": 98343509, "body": "Why do you need an extra node for the head of the list? <code>Node *nod</code> already is the head, so <code>createList()</code> is redundant. A simple linked list is like a LIFO stack: that&#39;s why the print is in reverse order."}, {"owner": {"reputation": 151, "user_id": 10657662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cfa0a1165083ad7395f279623532dc3?s=128&d=identicon&r=PG&f=1", "display_name": "Rami Raghfan", "link": "https://stackoverflow.com/users/10657662/rami-raghfan"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1556149804, "post_id": 55839938, "comment_id": 98343553, "body": "<code>createList()</code> serves as Init at the same time, are you suggesting this approach is causing me the issues?  I started from head with the printing though, i don&#39;t understand why it&#39;s reverse..."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1556150015, "post_id": 55839938, "comment_id": 98343577, "body": "Oh, I see, you are trying to add each item to the tail of the list. In a simple list, you add each new item at the front. The whole thing seems over complicated."}, {"owner": {"reputation": 151, "user_id": 10657662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cfa0a1165083ad7395f279623532dc3?s=128&d=identicon&r=PG&f=1", "display_name": "Rami Raghfan", "link": "https://stackoverflow.com/users/10657662/rami-raghfan"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1556150386, "post_id": 55839938, "comment_id": 98343636, "body": "Adding to tail of list doesn&#39;t work? IIRC all simply linked lists in labs at my college added from head to tail. This work is a little test for me because I&#39;ve been working with ready-made-fill-in-blanks .h files, complete with a big test .c file. Needed something fresh."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1556150499, "post_id": 55839938, "comment_id": 98343652, "body": "To me, it&#39;s defeating the point of a linked list if you have to parse the entire list to add a new item. If you want them the other way round, insert them the other way round."}, {"owner": {"reputation": 528, "user_id": 4890944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6584bf69ef530c04cc2f2abc2bba08e3?s=128&d=identicon&r=PG&f=1", "display_name": "\u6c38\u52ab\u56de\u5e30", "link": "https://stackoverflow.com/users/4890944/%e6%b0%b8%e5%8a%ab%e5%9b%9e%e5%b8%b0"}, "edited": false, "score": 0, "creation_date": 1556150608, "post_id": 55839938, "comment_id": 98343667, "body": "The head pointer <code>nod</code> at the beginning and at the end does not point to the same place."}, {"owner": {"reputation": 151, "user_id": 10657662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cfa0a1165083ad7395f279623532dc3?s=128&d=identicon&r=PG&f=1", "display_name": "Rami Raghfan", "link": "https://stackoverflow.com/users/10657662/rami-raghfan"}, "reply_to_user": {"reputation": 528, "user_id": 4890944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6584bf69ef530c04cc2f2abc2bba08e3?s=128&d=identicon&r=PG&f=1", "display_name": "\u6c38\u52ab\u56de\u5e30", "link": "https://stackoverflow.com/users/4890944/%e6%b0%b8%e5%8a%ab%e5%9b%9e%e5%b8%b0"}, "edited": false, "score": 0, "creation_date": 1556150820, "post_id": 55839938, "comment_id": 98343691, "body": "@\u6c38\u52ab\u56de\u5e30  i dont follow, would you kindly point out in more detail where?"}], "answers": [{"comments": [{"owner": {"reputation": 151, "user_id": 10657662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cfa0a1165083ad7395f279623532dc3?s=128&d=identicon&r=PG&f=1", "display_name": "Rami Raghfan", "link": "https://stackoverflow.com/users/10657662/rami-raghfan"}, "edited": false, "score": 1, "creation_date": 1556151203, "post_id": 55840102, "comment_id": 98343746, "body": "Thank you! I was able to fix it. I just copied head when creating the list before adding any nodes."}, {"owner": {"reputation": 151, "user_id": 10657662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cfa0a1165083ad7395f279623532dc3?s=128&d=identicon&r=PG&f=1", "display_name": "Rami Raghfan", "link": "https://stackoverflow.com/users/10657662/rami-raghfan"}, "edited": false, "score": 0, "creation_date": 1556151657, "post_id": 55840102, "comment_id": 98343817, "body": "Sorry for revoking accept, I was too quick to accept and got an issue. but it turns out it was just my fault. Thanks again!"}], "tags": [], "owner": {"reputation": 528, "user_id": 4890944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6584bf69ef530c04cc2f2abc2bba08e3?s=128&d=identicon&r=PG&f=1", "display_name": "\u6c38\u52ab\u56de\u5e30", "link": "https://stackoverflow.com/users/4890944/%e6%b0%b8%e5%8a%ab%e5%9b%9e%e5%b8%b0"}, "is_accepted": true, "score": 2, "last_activity_date": 1556151256, "last_edit_date": 1556151256, "creation_date": 1556150905, "answer_id": 55840102, "question_id": 55839938, "link": "https://stackoverflow.com/questions/55839938/why-arent-nodes-adding-properly-and-why-is-it-printing-in-reverse-singly-link/55840102#55840102", "title": "Why aren&#39;t nodes adding properly and why is it printing in reverse? (singly linked list)", "body": "<p>In this snippet of the function <code>addNode</code> </p>\n\n<pre class=\"lang-c prettyprint-override\"><code>if(adaugat == 0)\n    {\n        Node **aux = node;\n        while((*aux)-&gt;next != NULL)\n        {\n            *aux = (*aux)-&gt;next;\n        }\n        (*aux)-&gt;next = newNode(info);\n        adaugat = 1;\n    }\n</code></pre>\n\n<p>more precisely on the line <code>*aux = (*aux)-&gt;next;</code> you are shifting the list at the same time you are walking through it because of the <code>Node ** aux</code>. Hence it will always look like your list has two elements.</p>\n\n<p>If you want to add an element at the end of the list, you have to traverse the list without modifying it, that is,</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>if(adaugat == 0)\n    {\n        Node *aux = *node;\n        while(aux-&gt;next != NULL)\n        {\n            aux = aux-&gt;next;\n        }\n        aux-&gt;next = newNode(info);\n        adaugat = 1;\n    }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 7437154, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-_3_9WuANLr0/AAAAAAAAAAI/AAAAAAAAAJE/LyWb3OmdMjA/photo.jpg?sz=128", "display_name": "Matthew Budish", "link": "https://stackoverflow.com/users/7437154/matthew-budish"}, "is_accepted": false, "score": 1, "last_activity_date": 1556151132, "creation_date": 1556151132, "answer_id": 55840127, "question_id": 55839938, "link": "https://stackoverflow.com/questions/55839938/why-arent-nodes-adding-properly-and-why-is-it-printing-in-reverse-singly-link/55840127#55840127", "title": "Why aren&#39;t nodes adding properly and why is it printing in reverse? (singly linked list)", "body": "<p>The problem lies in the following block of code</p>\n\n<pre><code>    if(adaugat == 0)\n    {\n        Node **aux = node;\n        while((*aux)-&gt;next != NULL)\n        {\n            *aux = (*aux)-&gt;next;\n        }\n        (*aux)-&gt;next = newNode(info);\n        adaugat = 1;\n    }\n</code></pre>\n\n<p>The variable <code>node</code> is not getting dereferenced and using a double pointer here is unnecessary. Changing that part to the following will give you the desired output...</p>\n\n<pre><code>\n    if(adaugat == 0)\n    {\n        Node *aux = *node;\n        while(aux-&gt;next != NULL)\n        {\n            aux = aux-&gt;next;\n        }\n        aux-&gt;next = newNode(info);\n        adaugat = 1;\n    }\n</code></pre>\n\n<p>Hope this helps.</p>\n"}], "owner": {"reputation": 151, "user_id": 10657662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cfa0a1165083ad7395f279623532dc3?s=128&d=identicon&r=PG&f=1", "display_name": "Rami Raghfan", "link": "https://stackoverflow.com/users/10657662/rami-raghfan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 55840102, "answer_count": 2, "score": 2, "last_activity_date": 1556153560, "creation_date": 1556149264, "last_edit_date": 1556153560, "question_id": 55839938, "link": "https://stackoverflow.com/questions/55839938/why-arent-nodes-adding-properly-and-why-is-it-printing-in-reverse-singly-link", "title": "Why aren&#39;t nodes adding properly and why is it printing in reverse? (singly linked list)", "body": "<p><strong>SOLVED</strong></p>\n\n<p>The problem could also be solved by copying the head into another variable after adding new nodes. \nA more logical solution would be to do as the answer says. </p>\n\n<hr>\n\n<hr>\n\n<p>I'm practicing on a simple linked list implementation, wanted to explore pointers more too. why doesn't my code add nodes properly? </p>\n\n<pre><code>typedef struct Node{\n\n    int info;\n\n    struct Node* next;\n\n}Node;\n\nvoid createList(Node** node, int info){\n\n        *node = calloc(1, sizeof(Node));\n        (*node)-&gt;info = info;\n        (*node)-&gt;next = NULL;\n\n}\nNode* newNode(int info)\n{\n    Node* newNode;\n    newNode = calloc(1, sizeof(Node));\n    newNode-&gt;info = info;\n    newNode-&gt;next = NULL;\n\n    return newNode;\n}\n\nvoid addNode(Node** node, int info){\n    int adaugat = 0;\n\n\n    if(*node == NULL){\n\n        createList(node, info);\n        adaugat = 1; \n    }\n\n    if(adaugat == 0)\n    {\n        Node **aux = node;\n        while((*aux)-&gt;next != NULL)\n        {\n            *aux = (*aux)-&gt;next;\n        }\n        (*aux)-&gt;next = newNode(info);\n        adaugat = 1;\n    }\n\n}\nvoid printList(Node* node){\n    int i = 1;\n    Node* aux;\n    aux = node;\n    while(aux != NULL)\n    {\n        printf(\"%d_[%d]--\",i, aux-&gt;info );\n        i++;\n        aux = aux-&gt;next;\n    }\n}\nint main(int argc, char const *argv[])\n{\n    Node *nod = NULL;\n    int key = 5;\n\n    createList(&amp;nod, key);\n\n    addNode(&amp;nod, 5);\n    addNode(&amp;nod, 3);\n    addNode(&amp;nod, 4);\n    addNode(&amp;nod, 1);\n\n    printList(nod);\n\n    return 0;\n}\n</code></pre>\n\n<p>I've attempted shifting around with pointers and function calling inputs in main() but all I got were more warnings and segfaults. \nThe output here from main() is <code>1_[4]--2_[1]--</code> when it should have been </p>\n\n<pre><code>1_[5]--2_[3]--3_[4]--4_[1]--\n</code></pre>\n"}, {"tags": ["c", "memory", "struct", "conventions"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1556149190, "post_id": 55839916, "comment_id": 98343449, "body": "Passing a <code>struct</code> of any size around by value is a lot of dead weight to carry."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1556157031, "post_id": 55839916, "comment_id": 98344756, "body": "@WeatherVane Disagree.  Passing around a <code>struct</code> that is small, maybe even smaller than a pointer is not dead weight."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1556178024, "post_id": 55839916, "comment_id": 98350683, "body": "@chux of course. My emphasis was intended to be &quot;of any <i>size</i>&quot;, not &quot;of <i>any</i> size&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 11251, "user_id": 3284878, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/d324c610856d2626e9b719eb4135b3cb?s=128&d=identicon&r=PG&f=1", "display_name": "Aviv Cohn", "link": "https://stackoverflow.com/users/3284878/aviv-cohn"}, "edited": false, "score": 0, "creation_date": 1556213947, "post_id": 55840798, "comment_id": 98371134, "body": "Thanks for answering. So as I understand what you&#39;re saying, we should pass <code>struct</code>s by value when they&#39;re small or represent some scalar numeric value. Otherwise, pass by pointer. Is that essentialy your point?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 11251, "user_id": 3284878, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/d324c610856d2626e9b719eb4135b3cb?s=128&d=identicon&r=PG&f=1", "display_name": "Aviv Cohn", "link": "https://stackoverflow.com/users/3284878/aviv-cohn"}, "edited": false, "score": 0, "creation_date": 1556229482, "post_id": 55840798, "comment_id": 98377527, "body": "@AvivCohn That is a good first order conclusion.  Yet not a hard rule as circumstances will push for the other now and then or perhaps other approaches."}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 2, "last_activity_date": 1556157610, "creation_date": 1556157610, "answer_id": 55840798, "question_id": 55839916, "link": "https://stackoverflow.com/questions/55839916/passing-and-returning-structs-by-value-or-by-pointer-are-there-default-guideli/55840798#55840798", "title": "Passing and returning structs by value or by pointer - are there default guidelines?", "body": "<blockquote>\n  <p>Passing and returning structs by value or by pointer guidelines</p>\n</blockquote>\n\n<p>1) Small size.  When the <code>struct</code> is small - I'd say &lt;= twice the size of a pointer, there is little to be lost, size wise, when passing by <code>struct</code> by value rather than by a pointer to the <code>struct</code>. Simplicity of passing an object by value is gained.</p>\n\n<p>2) Large size.  When the <code>struct</code> is large, certainly passing a <code>pointer to a</code>struct is more efficient.</p>\n\n<p>3) Numeric object.  When the <code>struct</code> has fixed sized allocations and represents a <em>number</em>, passing by value just seem to work better.</p>\n\n<p>4) Hiding.  Opaque points to <code>struct</code> are a good way to hide the innards of a <code>struct</code> and promote object oriented code.</p>\n\n<p>For others cases, I'd say code for clarity - which usually means use a pointer to the <code>struct</code> as the that is C idiomatic.</p>\n\n<hr>\n\n<p>For general usage, I find retuning a pointer to a <code>struct</code> of little value - aside form one important case: forming a set of functions where the <em>init</em> function(s) return an allocated pointer to a <code>struct</code>.</p>\n"}], "owner": {"reputation": 11251, "user_id": 3284878, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/d324c610856d2626e9b719eb4135b3cb?s=128&d=identicon&r=PG&f=1", "display_name": "Aviv Cohn", "link": "https://stackoverflow.com/users/3284878/aviv-cohn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1556157610, "creation_date": 1556149035, "question_id": 55839916, "link": "https://stackoverflow.com/questions/55839916/passing-and-returning-structs-by-value-or-by-pointer-are-there-default-guideli", "title": "Passing and returning structs by value or by pointer - are there default guidelines?", "body": "<p>So I've been looking for rule-of-thumb guidelines on two topics:</p>\n\n<ul>\n<li>When to <strong>return</strong> a struct by value, vs. when to return it by pointer (in the case where the called function has created the struct). E.g:</li>\n</ul>\n\n<pre class=\"lang-c prettyprint-override\"><code>MyThing make_my_thing() { MyThing m; /* ... */ ; return m; }\n// Vs.\nMyThing* make_my_thing() { MyThing* m = malloc(sizeof(MyThing)); /* ... */ ; return m; }\n</code></pre>\n\n<ul>\n<li>When to <strong>pass</strong> a struct by value, vs. when to pass it by pointer</li>\n</ul>\n\n<pre class=\"lang-c prettyprint-override\"><code>// Assume do_something() doesn't need to mutate m\nvoid do_something(MyThing m) { /* ... */ }  \n// Vs.\nvoid do_something(MyThing* m) { /* ... */ }\n</code></pre>\n\n<p>The rule-of-thumb I'm looking for isn't supposed to fit all cases, but should be the default I'm going with in a general case, where the struct isn't very big.</p>\n\n<p>Please note I'm aware different cases may require different solutions - but nonetheless am looking for a basic 'default' convention most developers follow, if one exists.</p>\n\n<p>I have read many questions and answers on this site, and have come up with the following guidelines:</p>\n\n<ul>\n<li>Default is to <strong>return a struct by value</strong>. Otherwise, we'd have to <code>malloc</code> it and mess with its lifecycle management.</li>\n<li>Default is to <strong>pass a struct by pointer</strong> - no need to worry about lifecycle management any more than we already are, and no unnecessary copying of data.</li>\n</ul>\n\n<p>Are these guidelines widely accepted among C programmers? If not, what would be the more generally accepted conventions?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1556146641, "post_id": 55839573, "comment_id": 98342978, "body": "Post your compiler errors/warnings.  Example: Review <code>printf(&quot;%c \\n&quot;, (char*)(arr+i));</code>.  <code>%c</code> expect a char` or <code>int</code>, not a pointer."}, {"owner": {"reputation": 8445, "user_id": 929459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e420841bacccb72fb934f80069c11d0b?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/929459/dmitri"}, "edited": false, "score": 1, "creation_date": 1556146721, "post_id": 55839573, "comment_id": 98343000, "body": "You&#39;re not dereferencing the pointers, and you&#39;re doing the pointer arithmetic on the uncast pointer and casting the result.  Try eg. <code>((int *)arr)[i]</code> instead of <code>(int*)(arr+i)</code>"}, {"owner": {"reputation": 8445, "user_id": 929459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e420841bacccb72fb934f80069c11d0b?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/929459/dmitri"}, "edited": false, "score": 0, "creation_date": 1556146813, "post_id": 55839573, "comment_id": 98343029, "body": "You also might want to consider using an enum for the types..."}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1556147934, "post_id": 55839573, "comment_id": 98343239, "body": "You&#39;re using a compiler that allows pointer arithmetic on <code>void*</code>, like gcc. Those that do, consider the distance between &quot;elements&quot; to be 1."}], "answers": [{"comments": [{"owner": {"reputation": 1537, "user_id": 968000, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/tU8sw.jpg?s=128&g=1", "display_name": "user968000", "link": "https://stackoverflow.com/users/968000/user968000"}, "edited": false, "score": 0, "creation_date": 1556146961, "post_id": 55839672, "comment_id": 98343061, "body": "utilities.c:11:47: error: operand of type &#39;void&#39; where arithmetic or pointer type is required                 printf(&quot;Integer %d \\n&quot;, (int*)arr[i]);"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 1537, "user_id": 968000, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/tU8sw.jpg?s=128&g=1", "display_name": "user968000", "link": "https://stackoverflow.com/users/968000/user968000"}, "edited": false, "score": 0, "creation_date": 1556147030, "post_id": 55839672, "comment_id": 98343073, "body": "@user968000 Your comment does not include the <code>()</code> of the answer. Use <code>((int*)arr)[i]</code> to insure proper evaluation.  <code>(int*)arr[i]</code> is like <code>(int*)(arr[i])</code> which is invalid."}, {"owner": {"reputation": 1537, "user_id": 968000, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/tU8sw.jpg?s=128&g=1", "display_name": "user968000", "link": "https://stackoverflow.com/users/968000/user968000"}, "edited": false, "score": 1, "creation_date": 1556147457, "post_id": 55839672, "comment_id": 98343145, "body": "works now : printf(&quot;Integer %d \\n&quot;, ((int*)arr)[i]); thanks"}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 0, "last_activity_date": 1556147195, "last_edit_date": 1556147195, "creation_date": 1556146822, "answer_id": 55839672, "question_id": 55839573, "link": "https://stackoverflow.com/questions/55839573/incorrect-output-when-printing-an-integer-array/55839672#55839672", "title": "Incorrect output when printing an integer array", "body": "<p>A general print array function is prone to <em>undefined behavior</em> (UB) unless the data reference is aligned properly and of a valid value.</p>\n\n<p>Having said that, try </p>\n\n<pre><code>//printf(\"Integer %d  %d\\n\", (int*)(arr+i));\n//              vv-------- print a `%`\nprintf(\"Integer %%d  %d\\n\", ((int*)arr)[i]);\n//                          ^---------^ form a `int *` and then use [i]\n</code></pre>\n\n<p>Adding <code>i</code> to a <code>void*</code> is UB.  Cast the <code>void *</code> pointer <em>first</em> to the desired pointer type, then use the index <code>[i]</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "is_accepted": false, "score": 3, "last_activity_date": 1556147862, "last_edit_date": 1556147862, "creation_date": 1556147295, "answer_id": 55839725, "question_id": 55839573, "link": "https://stackoverflow.com/questions/55839573/incorrect-output-when-printing-an-integer-array/55839725#55839725", "title": "Incorrect output when printing an integer array", "body": "<p>You are using pointer arithmetic on <code>void*</code> type, whose size is unknown. You must cast the pointer <em>before</em> doing the arithmetc, but it is clearer to use array notation anyway.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid print_array(void *arr, int length, int type){\n    int i = 0;\n\n    for(i=0;i&lt;length;i++){\n        switch(type) {\n            case 0:\n                printf(\"int %d\\n\", ((int*)arr)[i]);\n                break;\n            case 1:\n                printf(\"char %c\\n\", ((char*)arr)[i]);\n                break;\n            case 2:\n                printf(\"string %s \\n\", ((char**)arr)[i]);\n                break;\n            case 3:\n                printf(\"hex %X\\n\", ((unsigned*)arr)[i]);\n                break;\n            default:\n                printf(\"Format not supported yet. %d \\n\",type);\n                return;\n\n        }\n    }\n}\n\nvoid test_int_array(){\n    int int_arr[3] = {0, 1, 2};\n    print_array(int_arr, 3, 0);\n\n}\n\nvoid test_char_array(){\n    char char_arr[3] = {'x', 'y', 'z'};\n    print_array(char_arr, 3, 1);\n\n}\n\nvoid test_str_array(){\n    char *str_arr[3] = {\"one\", \"two\", \"three\"};\n    print_array(str_arr, 3, 2);\n\n}\n\nvoid test_uns_array(){\n    unsigned uns_arr[3] = {26, 27, 28};\n    print_array(uns_arr, 3, 3);\n\n}\n\nint main(){\n    test_int_array();\n    test_char_array();\n    test_str_array();\n    test_uns_array();\n    return 0;\n}\n</code></pre>\n\n<p>Program output:\n<PRE>\nint 0\nint 1\nint 2\nchar x\nchar y\nchar z\nstring one \nstring two \nstring three \nhex 1A\nhex 1B\nhex 1C\n</PRE></p>\n"}], "owner": {"reputation": 1537, "user_id": 968000, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/tU8sw.jpg?s=128&g=1", "display_name": "user968000", "link": "https://stackoverflow.com/users/968000/user968000"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1556147862, "creation_date": 1556146199, "question_id": 55839573, "link": "https://stackoverflow.com/questions/55839573/incorrect-output-when-printing-an-integer-array", "title": "Incorrect output when printing an integer array", "body": "<p>I wanted to create a general print array function. This function would print array elements based on the data type.</p>\n\n<pre><code>#include \"utilities.h\"\n\n//type : 0 -&gt;int\n//     : 1-&gt;char\nvoid print_array(void *arr, int length, int type){\n    int i = 0;\n\n    for(i=0;i&lt;length;i++){\n        switch(type) {\n            case 0:\n                printf(\"Integer %d  %d\\n\", (int*)(arr+i));\n                break;\n            case 1:\n               printf(\"%c \\n\", (char*)(arr+i));\n               break;\n            case 2:\n                printf(\"%s \\n\", (char*)(arr+i));\n                break;\n            case 3:\n                printf(\"%x \\n\", (int*)(arr+i));\n                break;\n            default:\n                printf(\"Format not supported yet. %d \\n\",type);\n                return;\n\n        }\n    }\n}\n\n\nvoid test_print_array(){\n    int int_arr[3] = {0,1,2};\n    print_array(int_arr,3,0);\n\n}\n\nint main(){\n    test_print_array();\n    return 0;\n}\n</code></pre>\n\n<p>Output I am getting is </p>\n\n<p>Integer -486474964</p>\n\n<p>Integer -486474963 </p>\n\n<p>Integer -486474962 </p>\n\n<p>Instead of 0,1,2</p>\n\n<p>I also tried using arr[i] instead of (int*)(arr+i) but I am getting compiler errors on that.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1556146303, "post_id": 55839561, "comment_id": 98342899, "body": "Why do you pass <code>map</code> to the <code>allocate</code> function, but you don&#39;t use the value? You also have the wrong type. It expects <code>char ***</code>, but you pass <code>char **</code>. You should be getting type warnings about that."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1556146359, "post_id": 55839561, "comment_id": 98342913, "body": "You need to reread the chapter on pointers and <code>malloc</code> in your textbook or tutorial. You&#39;re really confused about how many <code>*</code> you need."}, {"owner": {"reputation": 3, "user_id": 9605042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f0ea81ad3dfddcb98d0b465ddd4b2fe?s=128&d=identicon&r=PG&f=1", "display_name": "Jo&#227;o Mazag&#227;o", "link": "https://stackoverflow.com/users/9605042/jo%c3%a3o-mazag%c3%a3o"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1556146722, "post_id": 55839561, "comment_id": 98343002, "body": "But, the first * is to allocate an vector, the ** is to allocate an matrix, the *** is to allocate my string value, this is wrong? @Barmar"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 9605042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f0ea81ad3dfddcb98d0b465ddd4b2fe?s=128&d=identicon&r=PG&f=1", "display_name": "Jo&#227;o Mazag&#227;o", "link": "https://stackoverflow.com/users/9605042/jo%c3%a3o-mazag%c3%a3o"}, "edited": false, "score": 0, "creation_date": 1556147547, "post_id": 55839726, "comment_id": 98343163, "body": "Thank you man, in my homework i need to allocate an matrix for a .txt file, and this  is my salvation. Thank&#39;s"}], "tags": [], "owner": {"reputation": 188, "user_id": 6445050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8441d014228619a2251abaf7178d6ea3?s=128&d=identicon&r=PG", "display_name": "Andy Thomason", "link": "https://stackoverflow.com/users/6445050/andy-thomason"}, "is_accepted": true, "score": 0, "last_activity_date": 1556147304, "creation_date": 1556147304, "answer_id": 55839726, "question_id": 55839561, "link": "https://stackoverflow.com/questions/55839561/im-try-to-allocate-um-string-matrix-with-malloc-but-returns-segmantation-fault/55839726#55839726", "title": "I&#39;m try to allocate um String matrix with malloc, but returns segmantation fault, whats happen?", "body": "<p>I guess you mean something like the following.</p>\n\n<p>Note the \"const\" as a string is a \"const char *\" not a \"char *\".</p>\n\n<pre><code>#include &lt;malloc.h&gt;\n#include &lt;stdio.h&gt;\n\nconst char ***allocate(int lin, int col){\n    int index = lin;\n\n    const char ***map = (const char*** ) malloc(sizeof(char**) * lin);\n\n    for(int i = 0; i &lt; index; i++){\n        map[i] = (const char**) malloc(sizeof(char*) * col);\n    }\n\n    return map;\n}\n\nvoid **fill(const char ***map, int index){\n\n    printf(\"index: %d\\n\", index);\n\n    for(int i = 0; i &lt; index; ++i){\n        for (int j = 0; j &lt; index; ++j){\n          map[i][j] = \"aaaaaaaaa\";\n          printf(\"%s \", map[i][j]);\n        }\n        printf(\"\\n\");\n    }\n\n}\n\n\n\nint main(){\n    const char ***map = allocate(5,5);\n    printf(\"\\n\");\n    fill(map,5);\n    return 0;\n}\n</code></pre>\n\n<p>Calling malloc this many times and having such a high level of indirection\nmakes for very inefficient coding.</p>\n\n<p>It is sufficient in this case to make a constant 5x5 array of const char *</p>\n\n<pre><code>int main() {\n  const char *map[5][5];\n  for (int i = 0; i != 5; ++i) {\n    for (int j = 0; j != 5; ++j) {\n      map[i][j] = \"I should write my own assignment.\";\n    }\n  }\n}\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9605042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f0ea81ad3dfddcb98d0b465ddd4b2fe?s=128&d=identicon&r=PG&f=1", "display_name": "Jo&#227;o Mazag&#227;o", "link": "https://stackoverflow.com/users/9605042/jo%c3%a3o-mazag%c3%a3o"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 23, "favorite_count": 0, "accepted_answer_id": 55839726, "answer_count": 1, "score": 0, "last_activity_date": 1556147304, "creation_date": 1556146095, "question_id": 55839561, "link": "https://stackoverflow.com/questions/55839561/im-try-to-allocate-um-string-matrix-with-malloc-but-returns-segmantation-fault", "title": "I&#39;m try to allocate um String matrix with malloc, but returns segmantation fault, whats happen?", "body": "<p>I'm try to allocate an string matrix, but, in the last line mt code returns Segmentation Fault, how can i fix it?</p>\n\n<pre><code>char **allocate(char ***map, int lin, int col){\n    int index = lin;\n\n    map = (char*** ) malloc(sizeof(char) * lin);\n\n    for(int i = 0; i &lt; index; i++){\n        map[i] = (char**) malloc(sizeof(char) * col);\n    }\n\n    return (char**) map;\n}\n\nvoid **fill(char ***map, int index){\n\n    printf(\"index: %d\\n\", index);\n\n    for(int i = 0; i &lt;index; ++i){\n        for (int j = 0; j &lt; index; ++j){\n          map[i][j] = \"aaaaaaaaa\";\n          printf(\"%s \", map[i][j]);\n        }\n        printf(\"\\n\");\n    }\n\n}\n\n\n\nint main(){\n    char **map = NULL;\n    map = allocate(map,5,5);\n    printf(\"\\n\");\n    fill(map,5);\n    return 0;\n}\n</code></pre>\n\n<p>I expect only to show the last line of my matrix.</p>\n"}, {"tags": ["c", "arrays", "pointers", "memcpy"], "comments": [{"owner": {"reputation": 44820, "user_id": 4492932, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e8938ef2681650e100bc9f83434ef272?s=128&d=identicon&r=PG", "display_name": "DYZ", "link": "https://stackoverflow.com/users/4492932/dyz"}, "edited": false, "score": 1, "creation_date": 1556143417, "post_id": 55839190, "comment_id": 98342187, "body": "You have not allocated memory for the vectors."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 2, "creation_date": 1556143418, "post_id": 55839190, "comment_id": 98342188, "body": "You callocated memory for <code>vectors_left</code> and <code>vectors_right</code>, but you didn&#39;t allocate any memory for the arrays that they point to, <code>vectors_left[u]</code> and <code>vectors_right[u]</code>."}], "answers": [{"tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": false, "score": 0, "last_activity_date": 1556143824, "creation_date": 1556143824, "answer_id": 55839257, "question_id": 55839190, "link": "https://stackoverflow.com/questions/55839190/why-am-i-getting-invalid-write-valgrind-with-memcpy/55839257#55839257", "title": "Why am I getting Invalid Write (Valgrind) with memcpy()?", "body": "<p>You need to allocate memory for the vectors that you're copying into.</p>\n\n<p>You also shouldn't take the address of <code>vectors_left[u]</code>. <code>vectors_left</code> is an array of pointers, so <code>vectors_left[u]</code> is a pointer.</p>\n\n<pre><code>  for (int u = 0; u &lt; count; u++)\n  {\n      if (u &lt; count_right - 1) {\n          vectors_left[u] = malloc(sizeof(Vector));\n          memcpy(vectors_left[u], &amp;vectors[u], sizeof(Vector));\n      } else {\n          vectors_right[u - count_right + 1] = malloc(sizeof(Vector));\n          memcpy(vectors_right[u - count_right + 1], &amp;vectors[u], sizeof(Vector));\n      }\n  }\n</code></pre>\n\n<p>Without seeing the declaration of <code>vectors</code>, I don't know if <code>&amp;vectors[u]</code> is right or wrong.</p>\n\n<p>I also wouldn't do this as a loop with an <code>if</code> statement, I'd do it as two loops, since there's no overlap between the two cases.</p>\n\n<pre><code>for (int u = 0; u &lt; count_right - 1; u++) {\n    vectors_left[u] = malloc(sizeof(Vector));\n    memcpy(vectors_left[u], &amp;vectors[u], sizeof(Vector));\n}\nfor (int u = count_right - 1; u &lt; count; u++) {\n    vectors_right[u - count_right + 1] = malloc(sizeof(Vector));\n    memcpy(vectors_right[u - count_right + 1], &amp;vectors[u], sizeof(Vector));\n}\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 7922511, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VHn0D.png?s=128&g=1", "display_name": "Franco M&#233;ndez", "link": "https://stackoverflow.com/users/7922511/franco-m%c3%a9ndez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 134, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1556143824, "creation_date": 1556143318, "last_edit_date": 1556143474, "question_id": 55839190, "link": "https://stackoverflow.com/questions/55839190/why-am-i-getting-invalid-write-valgrind-with-memcpy", "title": "Why am I getting Invalid Write (Valgrind) with memcpy()?", "body": "<p>I have three arrays of type <code>Vector**</code>: <code>vectors</code>, <code>vectors_left</code> and <code>vectors_right</code>. I'm trying to assign values from <code>vectors</code> in order to split it into this two arrays.\n<strong>Valgrind</strong> says that the <strong>Invalid Write</strong> is at <code>memcpy()</code> lines.</p>\n\n<p>I've tried different combinations removing the <code>&amp;</code> and adding <code>*</code> to the <code>sizeof()</code> argument.</p>\n\n<pre><code>  int count_left = count / 2;\n  int count_right = is_even(count) ? (count / 2) : (count / 2) + 1;\n  Vector** vectors_left = malloc(sizeof(Vector*) * count_left);\n  Vector** vectors_right = malloc(sizeof(Vector*) * count_right);\n\n  for (int u = 0; u &lt; count; u++)\n  {\n      if (u &lt; count_right - 1) {\n          memcpy(&amp;vectors_left[u], &amp;vectors[u], sizeof(Vector));\n      } else {\n          memcpy(&amp;vectors_right[u - count_right + 1], &amp;vectors[u], sizeof(Vector));\n      }\n  }\n</code></pre>\n\n<p>My code works fine, but I'm getting this kind of leaks.</p>\n"}, {"tags": ["python", "c", "python-c-api"], "comments": [{"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 0, "creation_date": 1556144592, "post_id": 55839131, "comment_id": 98342501, "body": "Where&#39;s the Python code showing how you want to call it? Have you been through any tutorials, such as this one: <a href=\"https://www.tutorialspoint.com/python/python_further_extensions.htm\" rel=\"nofollow noreferrer\">Python - Extension Programming With C</a>?"}, {"owner": {"reputation": 441, "user_id": 7032246, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7aa264c13fb5bdf1acd0a1e5033ba043?s=128&d=identicon&r=PG&f=1", "display_name": "c00der", "link": "https://stackoverflow.com/users/7032246/c00der"}, "reply_to_user": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 0, "creation_date": 1556164418, "post_id": 55839131, "comment_id": 98346139, "body": "Yes I did. I have done extensions that return simple values, like ints or floats, but couldn&#39;t find a way to return an array"}, {"owner": {"reputation": 23048, "user_id": 4657412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4915a27d01efa79d81d322511ee517a9?s=128&d=identicon&r=PG&f=1", "display_name": "DavidW", "link": "https://stackoverflow.com/users/4657412/davidw"}, "edited": false, "score": 0, "creation_date": 1556185169, "post_id": 55839131, "comment_id": 98354555, "body": "I think you need to show the C function you want to call (to show how the return type is allocated, etc). At the moment you just have a nonsensical recursive call to <code>_get_array</code>. It&#39;s basically pretty easy - you create a Python list and iterate through it to fill it with Python strings - but the details do depend on code you don&#39;t show"}, {"owner": {"reputation": 441, "user_id": 7032246, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7aa264c13fb5bdf1acd0a1e5033ba043?s=128&d=identicon&r=PG&f=1", "display_name": "c00der", "link": "https://stackoverflow.com/users/7032246/c00der"}, "reply_to_user": {"reputation": 23048, "user_id": 4657412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4915a27d01efa79d81d322511ee517a9?s=128&d=identicon&r=PG&f=1", "display_name": "DavidW", "link": "https://stackoverflow.com/users/4657412/davidw"}, "edited": false, "score": 0, "creation_date": 1556203749, "post_id": 55839131, "comment_id": 98365903, "body": "@DavidW, sorry for the delay. Just added. My concern is, there can be a lot of items in the array that is returned and don&#39;t want to use a Python list because of the overhead. I would much prefer using a pure C array instead. Somewhere I read you can use Numpy arrays but I am confused whether I can return a pure C array or need to use Python or Numpy specfic array implementation"}, {"owner": {"reputation": 23048, "user_id": 4657412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4915a27d01efa79d81d322511ee517a9?s=128&d=identicon&r=PG&f=1", "display_name": "DavidW", "link": "https://stackoverflow.com/users/4657412/davidw"}, "edited": false, "score": 1, "creation_date": 1556205533, "post_id": 55839131, "comment_id": 98367064, "body": "You definitely can&#39;t return a pure C array. Numpy string arrays would work fine, but the strings must be of fixed length (which it looks like these are). Python lists are better than you think. I&#39;ll post a proper answer if/when I can (and if no one else does it first)"}, {"owner": {"reputation": 441, "user_id": 7032246, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7aa264c13fb5bdf1acd0a1e5033ba043?s=128&d=identicon&r=PG&f=1", "display_name": "c00der", "link": "https://stackoverflow.com/users/7032246/c00der"}, "edited": false, "score": 0, "creation_date": 1556212460, "post_id": 55839131, "comment_id": 98370474, "body": "Thanks, since I don&#39;t know, why can&#39;t a pure C array be returned? Is it because Python can&#39;t interpret what that is? Also, when you use a Python list, can C long long still be used or should they be Python_ints?"}, {"owner": {"reputation": 23048, "user_id": 4657412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4915a27d01efa79d81d322511ee517a9?s=128&d=identicon&r=PG&f=1", "display_name": "DavidW", "link": "https://stackoverflow.com/users/4657412/davidw"}, "edited": false, "score": 0, "creation_date": 1556224781, "post_id": 55839131, "comment_id": 98375867, "body": "Yes - it&#39;s that Python doesn&#39;t know what it is. If I understand what you want correctly, the Python list would be of strings rather than ints, but you could definitely make the string from a C long long like you do here."}], "answers": [{"tags": [], "owner": {"reputation": 23048, "user_id": 4657412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4915a27d01efa79d81d322511ee517a9?s=128&d=identicon&r=PG&f=1", "display_name": "DavidW", "link": "https://stackoverflow.com/users/4657412/davidw"}, "is_accepted": true, "score": 1, "last_activity_date": 1556266026, "creation_date": 1556266026, "answer_id": 55863354, "question_id": 55839131, "link": "https://stackoverflow.com/questions/55839131/return-a-c-string-array-from-a-c-extension/55863354#55863354", "title": "Return a C String Array from a C Extension", "body": "<p>You can't return your <code>char**</code> directly Python since Python only understands objects of type <code>PyObject*</code> (since this contains the information needed to handle reference counting and identifying the type). You therefore have to create a suitable Python object. The simplest option would be a list of strings. The next simplest you be a numpy array using the string type (you can do this easily because all your strings are the same length). Neither of these have a direct <code>Py_BuildValue</code> conversion so you have to write loops yourself.</p>\n\n<hr>\n\n<p>For a list of strings you simply create the list with <code>PyList_New</code> then go through element by element with <code>PyList_SetItem</code>:</p>\n\n<pre><code>char** array = get_array(value, init_level, final_level);\nPyObject* list = PyList_New(1 &lt;&lt; (4* (final_level - init_level)));\nif (!list) return NULL;\n\nfor (int i=0; i&lt;(1 &lt;&lt; (4* (final_level - init_level))); ++i) {\n    PyObject* item = PyBytes_FromStringAndSize(array[i],(4+final_level));\n    if (!item) goto failed;\n\n    if (PyList_SetItem(list,i,item) != 0) {\n        Py_DECREF(item);\n        goto failed;\n    }\n\n    free(array[i]); // deallocate array as we go\n}\nfree(array);\n\n// returning the array as a Python object by o\nreturn list;\n\nfailed:\nPy_DECREF(list);\n// also deallocate the rest of array?\nreturn NULL;\n</code></pre>\n\n<p>Note that I haven't finalised memory management of failure so you'll leak <code>array</code>.</p>\n\n<hr>\n\n<p>For the numpy array you allocate an array with the correct string type, and then copy the data into it</p>\n\n<pre><code>char** array = get_array(value, init_level, final_level);\n\n// create an \"Sx\" dtype, where x is a suitable number\nPyArray_Descr *desc = PyArray_DescrNewFromType(NPY_STRING);\ndesc-&gt;elsize = (4+final_level);\n\nnpy_intp array_length[] = {1 &lt;&lt; (4* (final_level - init_level))};\nPyObject* nparray = PyArray_SimpleNewFromDescr(1,array_length,desc);\nif (!nparray) return NULL; // clean up array too\n\nfor (int i=0; i&lt;(1 &lt;&lt; (4* (final_level - init_level))); ++i) {\n    char* data = PyArray_GETPTR1((PyArrayObject*)nparray,i);\n\n    // copy data\n    for (int j=0; j&lt;(4+final_level); ++j) {\n        data[j] = array[i][j];\n    }\n\n    free(array[i]); // deallocate array as we go\n}\nfree(array);\n\n// returning the array as a Python object by o\nreturn nparray;\n</code></pre>\n\n<p>Again, not all the error handling is perfect. For this example to work you <em>must</em> call  <code>import_array()</code> in your module init function.</p>\n\n<hr>\n\n<p>In both cases you might be better not allocating memory in <code>get_array</code> but instead writing directly into your Python objects.</p>\n"}], "owner": {"reputation": 441, "user_id": 7032246, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7aa264c13fb5bdf1acd0a1e5033ba043?s=128&d=identicon&r=PG&f=1", "display_name": "c00der", "link": "https://stackoverflow.com/users/7032246/c00der"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 461, "favorite_count": 0, "accepted_answer_id": 55863354, "answer_count": 1, "score": 0, "last_activity_date": 1556266026, "creation_date": 1556142979, "last_edit_date": 1556203612, "question_id": 55839131, "link": "https://stackoverflow.com/questions/55839131/return-a-c-string-array-from-a-c-extension", "title": "Return a C String Array from a C Extension", "body": "<p>I have a C function that returns an array of strings. How can I call it in the form of a Python C extension which will return the array back to a calling Python function? (I am new to Python C extensions and have minimal experience with the extensions)</p>\n\n<p>This is the definition I tried:</p>\n\n<pre><code>static PyObject* _get_array(PyObject* self, PyObject* args)\n{\n    int64_t value;\n    int init_level;\n    int final_level;\n\n    if(!PyArg_ParseTuple(args, \"Lii\", &amp;value, &amp;init_level, &amp;final_level))\n        return NULL;\n\n    // returning the array as a Python object by o\n    return Py_BuildValue(\"o\", _get_array(value, init_level, final_level));\n}\n</code></pre>\n\n<p>and the method def:</p>\n\n<pre><code>static PyMethodDef array_methods[] = {\n    { \"get_array\", _get_array, METH_VARARGS, \"Returns a string array\"},\n    { NULL, NULL, 0, NULL }\n};\n</code></pre>\n\n<p><strong>Update</strong></p>\n\n<p>get_array function:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdint.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;Python.h&gt;\n\nchar **get_array(int64_t value, int init_level, int final_level) {\n\n  int SHIFTS []= {44, 40, 36, 32, 28, 24, 20, 16, 12, 8, 4, 0};\n\n  long count =  1 &lt;&lt; (4* (final_level - init_level));\n  char** t_array;\n  t_array = malloc(sizeof(char*)*count);\n\n  int shift_coff = 11 -(final_level-init_level);\n  int64_t base = (value &lt;&lt; SHIFTS[shift_coff]);\n\n  for (long i=0; i &lt; count; i++){\n    t_array[i] = malloc((4+final_level)*sizeof(char));\n    sprintf(t_array[i], \"%llX\", (base + i));\n  }\n\n  return t_array;\n}\n</code></pre>\n"}, {"tags": ["c", "function", "variables", "coding-style"], "answers": [{"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 0, "last_activity_date": 1556144367, "creation_date": 1556144367, "answer_id": 55839332, "question_id": 55839129, "link": "https://stackoverflow.com/questions/55839129/is-there-any-specific-reason-that-a-function-call-should-not-be-used-for-a-varia/55839332#55839332", "title": "Is there any specific reason that a function call should not be used for a variable initializer in C", "body": "<blockquote>\n  <p>Is there a technical reason that function calls should not be used when initializing data?</p>\n</blockquote>\n\n<p>Function calls not only should not, but <em>cannot</em> be used to initialize static variables or variables declared at file scope.  They can, however, be used to initialize automatic variables inside functions.  The semantics of doing this are well defined, so I don't think there is a <em>technical</em> reason why such initializations should be avoided.</p>\n\n<p>I take the rationale behind this style rule to be given by the first sentence of the quotation:</p>\n\n<blockquote>\n  <p>Be careful not to obfuscate the code by initializing variables in the declarations.</p>\n</blockquote>\n\n<p>The authors of the style guide evidently consider use of initializers to be potentially obfuscatory, and I take their emphasis in the last sentence to indicate that they think using function calls for initialization to be definitely obfuscatory.</p>\n\n<p>For what it's worth, I disagree with those style guidelines.  According to me, variables generally <em>should</em> be initialized in their declarations if in fact there is a meaningful, semantically correct value for them at that point, and if that value can be conveniently expressed via an initializer.  I also have no general objection to function calls in initializers.  In particular, I would typically revise this:</p>\n\n<pre><code>void foo(void) {\n    int result;\n    result = do_something();\n    // ...\n}\n</code></pre>\n\n<p>to this:</p>\n\n<pre><code>void foo(void) {\n    int result = do_something();\n    // ...\n}\n</code></pre>\n\n<p>.  I think the latter is actually slightly clearer, and I value that it has one fewer line.</p>\n"}, {"comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1556147722, "post_id": 55839542, "comment_id": 98343193, "body": "I&#39;m not seeing how a prohibition on functions being called by initializers (in C) can be about code that runs before <code>main()</code>.  You don&#39;t need any kind of style rule for that, since the language itself does not permit function calls in the initializers of any other than automatic variables (and those don&#39;t run before <code>main()</code>)."}], "tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": false, "score": 0, "last_activity_date": 1556145958, "creation_date": 1556145958, "answer_id": 55839542, "question_id": 55839129, "link": "https://stackoverflow.com/questions/55839129/is-there-any-specific-reason-that-a-function-call-should-not-be-used-for-a-varia/55839542#55839542", "title": "Is there any specific reason that a function call should not be used for a variable initializer in C", "body": "<p>This is just the language rule from its creators. They just did not like this, and they were thinking that the code executed before the main will be too complicated and too long. </p>\n\n<p>BTW many implementations provide mechanisms to execute some user code before main. gcc it is <code>__attribute__((constructor))</code>, but of course it is an extension.</p>\n"}], "owner": {"reputation": 145, "user_id": 6005566, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d61ab614455a652a3880d1d6d5c14ed?s=128&d=identicon&r=PG&f=1", "display_name": "Zeno of Elea", "link": "https://stackoverflow.com/users/6005566/zeno-of-elea"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1556145958, "creation_date": 1556142969, "question_id": 55839129, "link": "https://stackoverflow.com/questions/55839129/is-there-any-specific-reason-that-a-function-call-should-not-be-used-for-a-varia", "title": "Is there any specific reason that a function call should not be used for a variable initializer in C", "body": "<p>I am reading multiple style guides trying to standardize my programming style. While reading the FreeBSD and OpenBSD style guides on KNF, I noticed the following paragraph to be rather confusing.</p>\n\n<blockquote>\n  <p>Be careful not to obfuscate the code by initializing variables in the declarations. Use this feature only thoughtfully. DO NOT use function calls in initializers!</p>\n</blockquote>\n\n<p>Is there a technical reason that function calls should not be used when initializing data?</p>\n"}, {"tags": ["c", "file", "multidimensional-array", "char", "strtok"], "comments": [{"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 2, "creation_date": 1556143776, "post_id": 55839122, "comment_id": 98342285, "body": "<code>orders[i][j] = token;</code>--&gt;&gt; <code>orders[i][j] = strdup(token);</code>"}, {"owner": {"reputation": 327, "user_id": 4440179, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/93bb014ad50558b70c94cfb756e14f3a?s=128&d=identicon&r=PG&f=1", "display_name": "JimS", "link": "https://stackoverflow.com/users/4440179/jims"}, "reply_to_user": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1556143991, "post_id": 55839122, "comment_id": 98342357, "body": "@wildplasser That fixed it, thanks a lot. But can you explain the mistake to me?"}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 4, "creation_date": 1556144128, "post_id": 55839122, "comment_id": 98342389, "body": "<code>getline(&amp;line</code> - strtok operates on <code>line</code>. It does not have itself memory, it operates on <code>line</code>. It overwrites <code>line</code> and returns pointers to <code>line</code>. If you read the next <code>line</code>, the last one is invalid. You have to duplicate memory."}, {"owner": {"reputation": 327, "user_id": 4440179, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/93bb014ad50558b70c94cfb756e14f3a?s=128&d=identicon&r=PG&f=1", "display_name": "JimS", "link": "https://stackoverflow.com/users/4440179/jims"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1556146387, "post_id": 55839122, "comment_id": 98342920, "body": "@KamilCuk Oh I understand now. Thanks for the explanation."}], "owner": {"reputation": 327, "user_id": 4440179, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/93bb014ad50558b70c94cfb756e14f3a?s=128&d=identicon&r=PG&f=1", "display_name": "JimS", "link": "https://stackoverflow.com/users/4440179/jims"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 23, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1556142925, "creation_date": 1556142925, "question_id": 55839122, "link": "https://stackoverflow.com/questions/55839122/array-of-strings-gets-scrambled-after-exiting-strtok-loop-c", "title": "Array of strings gets scrambled after exiting strtok loop - C", "body": "<p>I have a text file like this:</p>\n\n<pre><code>word 1;word 2;word 3;word 4\nword 5;word 6;word 7;word 8\nword 9;word 10;word 11;word 12\nword 13;word 14;word 15;word 16\n</code></pre>\n\n<p>And I want to export this file into a 2d string array in C. Here is my code:</p>\n\n<pre><code>char* orders[LineCounter][4];\nint i = 0, j;\nf = fopen(\"test.txt\",\"r\");\nprintf(\"Inside the loop\\n\");\nwhile (getline(&amp;line, &amp;len, f) != -1) {\n    j = 0;\n    char* token = strtok(line,\";\\n\");\n    while (token != NULL){\n          orders[i][j] = token;\n          printf(\"%s\\n\", orders[i][j]);\n          token = strtok(NULL,\";\\n\");\n          j++;\n    }\n    i++;     \n}\nprintf(\"\\n\\nOutside the loop\\n\");\n    for (int k=0;k&lt;LineCounter;k++){\n        for (int l=0;l&lt;4;l++){\n            printf(\"%s \", orders[k][l]);\n        }\n        printf(\"\\n\");\n    }\n    fclose(f);\n</code></pre>\n\n<p>As you can see I print the contents of the array two times. One time while inside the strtok loop and one time after the everything is finished. The first time everything is printed fine but when I print the array after the I am done parsing the file, the contents are scrambled like this:</p>\n\n<pre><code>Inside the loop\n\nword 1\nword 2\nword 3\nword 4\nword 5\nword 6\nword 7\nword 8\nword 9\nword 10\nword 11\nword 12\nword 13\nword 14\nword 15\nword 16\n\n\nOutside the loop\nword 13  4 15 \nword 13  4 15 \nword 13    \nword 13 word 14 word 15 word 16 \n</code></pre>\n\n<p>As you can see part of the content is empty or the \"word\" is cut off. Am I missing something?</p>\n"}, {"tags": ["c", "io", "eof", "ansi-c"], "comments": [{"owner": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 2, "creation_date": 1556145235, "post_id": 55838916, "comment_id": 98342654, "body": "When you hit the end of the file, scanf returns EOF.  <code>!EOF</code> evaluates to false, so ..."}, {"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 0, "creation_date": 1556145353, "post_id": 55838916, "comment_id": 98342685, "body": "You aren&#39;t checking <code>fscanf</code> return properly for EOF. So you can&#39;t say it&#39;s not detected. See the <a href=\"http://man7.org/linux/man-pages/man3/scanf.3.html\" rel=\"nofollow noreferrer\">manual page for <code>fscanf</code></a>. <code>if(feof(stdin))</code> is definitely not going to work."}], "owner": {"reputation": 34, "user_id": 7910089, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d49001258689fbad8e4c86b606cb38d?s=128&d=identicon&r=PG&f=1", "display_name": "P.Diddy", "link": "https://stackoverflow.com/users/7910089/p-diddy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1556144432, "creation_date": 1556141805, "last_edit_date": 1556144432, "question_id": 55838916, "link": "https://stackoverflow.com/questions/55838916/eof-not-detected-using-scanf", "title": "EOF not detected using scanf", "body": "<p>I created a function which should read some integers from file to an array. The function should also catch cases where there aren't enough integers to fill the array, and terminate (i.e. EOF reached while filling the array).</p>\n\n<p>My problem: the function doesn't seem to catch the eof case, with <code>scanf</code> reusing already scanned values. So, for example, the input <code>12 22</code> for a size 4 array will fill the array as <code>12 22 22 22</code>.</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>int fillArray(int* array, int size) {\n    int temp = 0, i;\n\n    for (i = 0; i&lt;size; ++i) {\n        if(!scanf(\"%d\", &amp;temp) || !(temp &gt; 0)) {\n            if(feof(stdin)) {\n                printf(\"Error: not enough numbers\"); /* Should be EOF */\n                return 1;\n            }\n            printf(\"Error: positive numbers only\");\n            return 1;\n        } else {\n            heapArray[i] = temp;\n        }\n    }\n    return 0;\n}\n</code></pre>\n\n<p>I expected that after the second iteration, <code>scanf</code> should return <code>0</code> after a conversion failure, entering into the larger <code>if</code> block. At that point <code>feof(stdin)</code> should be true, terminating the function and printing the error message.</p>\n\n<p>However, it seems the conversion failure for <code>scanf</code> doesn't happen.</p>\n"}, {"tags": ["c", "pointers", "stack", "heap"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 3, "creation_date": 1556141663, "post_id": 55838865, "comment_id": 98341656, "body": "They can be allocated anywhere. The caller decides where they&#39;re located."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1556141681, "post_id": 55838865, "comment_id": 98341661, "body": "<a href=\"https://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc\">don&#39;t cast malloc</a>"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1556141855, "post_id": 55838865, "comment_id": 98341725, "body": "&quot;<i>arguments are allocated in stack</i>&quot; - not necessarily.  The language does not specify, and in many calling conventions, at least some arguments are passed in registers rather than on the stack.  But that&#39;s anyway about the location of the <i>pointers</i> <code>a</code> and <code>b</code>, not about the data to which they point."}], "answers": [{"tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": false, "score": 3, "last_activity_date": 1556141883, "creation_date": 1556141883, "answer_id": 55838935, "question_id": 55838865, "link": "https://stackoverflow.com/questions/55838865/passing-pointers-as-argument/55838935#55838935", "title": "Passing pointers as argument", "body": "<p>The pointers are local variables in the <code>tomato</code> function, just like <code>foo</code>.</p>\n\n<p>The values that they point to can be allocated anywhere. For instance, you can call it like this:</p>\n\n<pre><code>int foo = 1;\nint *bar = malloc(sizeof(int));\n*bar = 3;\nint *result = tomato(&amp;foo, bar);\n</code></pre>\n\n<p><code>a</code> will point to a the <code>foo</code> variable, while <code>b</code> will point to the memory allocated by <code>malloc</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 9104639, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-jSHy_f2q2JY/AAAAAAAAAAI/AAAAAAAAAAA/imS86ce4pv0/photo.jpg?sz=128", "display_name": "Thiago Turchetti Maia", "link": "https://stackoverflow.com/users/9104639/thiago-turchetti-maia"}, "is_accepted": false, "score": 1, "last_activity_date": 1556144198, "creation_date": 1556144198, "answer_id": 55839308, "question_id": 55838865, "link": "https://stackoverflow.com/questions/55838865/passing-pointers-as-argument/55839308#55839308", "title": "Passing pointers as argument", "body": "<p>Parameters in C are not necessarily allocated in the stack (*), but their <strong>scope</strong> will necessarily be restricted to the <code>tomato</code> function block, and they will necessarily be <strong>passed by value</strong>.</p>\n\n<p>When you dereference <code>a</code> and <code>b</code> in the assignment <code>*foo = *a + *b</code>, you are interpreting the memory address stored in pointers <code>a</code> and <code>b</code> as integers, summing them, and writing the result in the memory address stored in pointer <code>foo</code> (which, in your example, happens to be in the heap).</p>\n\n<p>After the assignment, you could change <code>a</code> and <code>b</code> at will by assigning different memory addresses to them (i.e. pointers), and there would be no consequence to any external memory references as their scope is limited to the function block (e.g. <code>a = foo</code>). If, however, you changed the memory contents referred by them (e.g. <code>*a = 0</code>), this would become visible outside the scope of the function as you would be writing on a memory space (stack or heap) allocated somewhere else.</p>\n\n<p>(*) Parameters may not be passed in memory (i.e. stack) to functions. Depending on the compiler/architecture, they may be directly assigned to a processor register. Either way, this is a transparent compiler optimization and you don't have to worry about it... the parameters will behave just the same.</p>\n"}], "owner": {"reputation": 1415, "user_id": 1326868, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/orO1q.gif?s=128&g=1", "display_name": "nihulus", "link": "https://stackoverflow.com/users/1326868/nihulus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1556144198, "creation_date": 1556141485, "question_id": 55838865, "link": "https://stackoverflow.com/questions/55838865/passing-pointers-as-argument", "title": "Passing pointers as argument", "body": "<pre><code>int *tomato(int *a, int *b) {\n    int *foo = (int*)malloc(sizeof(int));\n    *foo = *a + *b;\n    return foo;\n}\n</code></pre>\n\n<p>In this function I have foo that is allocated in heap and returns a pointer to <code>int</code>, but are the pointers <code>*a</code> and <code>*b</code> in the function arguments also allocated in heap? I am a bit confused here, generally, arguments are allocated in stack.</p>\n"}, {"tags": ["c", "stm32", "stm32f7"], "comments": [{"owner": {"reputation": 3116, "user_id": 2498790, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/991601e5d41d9d84ab7e196382ea8108?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/2498790/alex"}, "edited": false, "score": 1, "creation_date": 1556141298, "post_id": 55838534, "comment_id": 98341534, "body": "In this case I would just declare addressMap as an array of pointers to integers <code>int * addressMap[2];</code> (no cast needed then)"}, {"owner": {"reputation": 1175, "user_id": 1233925, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/25756ac145befc85b688d81731a8dad1?s=128&d=identicon&r=PG", "display_name": "Johann Horvat", "link": "https://stackoverflow.com/users/1233925/johann-horvat"}, "reply_to_user": {"reputation": 3116, "user_id": 2498790, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/991601e5d41d9d84ab7e196382ea8108?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/2498790/alex"}, "edited": false, "score": 0, "creation_date": 1556141734, "post_id": 55838534, "comment_id": 98341686, "body": "Tried that also, same warning..."}], "answers": [{"comments": [{"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "reply_to_user": {"reputation": 1175, "user_id": 1233925, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/25756ac145befc85b688d81731a8dad1?s=128&d=identicon&r=PG", "display_name": "Johann Horvat", "link": "https://stackoverflow.com/users/1233925/johann-horvat"}, "edited": false, "score": 2, "creation_date": 1556141969, "post_id": 55838891, "comment_id": 98341762, "body": "@JohannHorvat you welcome. The less you have cast in code and warnings because of the code, the better it is. I encourage you to compile asking the compiler to produce the max warning level, for instance using <i>gcc</i> do <code>gcc -pedantic -Wall -Wextra ...</code>"}], "tags": [], "owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "is_accepted": true, "score": 3, "last_activity_date": 1556141658, "creation_date": 1556141658, "answer_id": 55838891, "question_id": 55838534, "link": "https://stackoverflow.com/questions/55838534/stm32-storing-a-map-of-addresses-in-an-array/55838891#55838891", "title": "STM32: storing a map of addresses in an array", "body": "<blockquote>\n  <p>How may I write my code without this warning?</p>\n</blockquote>\n\n<p>as the warning says just add a cast doing</p>\n\n<pre><code>int* c = (int*) addressMap[0];\n</code></pre>\n\n<p>to avoid the warning <code>initialization makes pointer from integer without a cast [-Wint-conversion]</code> </p>\n\n<p>But, I recommend you to not use <code>intptr_t</code> but directely <code>int*</code> if the goal of <em>addressMap</em> is to contains pointers to <em>int</em> , thanks to that you do not need cast at all :</p>\n\n<pre><code>int * addressMap[2];\n\nint* a=NULL;\nint* b=NULL;\n\n*a=10;\n*b=20;\n\naddressMap[0] = a;\naddressMap[1] = b;\n\nint* c = addressMap[0];\n</code></pre>\n"}], "owner": {"reputation": 1175, "user_id": 1233925, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/25756ac145befc85b688d81731a8dad1?s=128&d=identicon&r=PG", "display_name": "Johann Horvat", "link": "https://stackoverflow.com/users/1233925/johann-horvat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 214, "favorite_count": 0, "accepted_answer_id": 55838891, "answer_count": 1, "score": 1, "last_activity_date": 1556141658, "creation_date": 1556139923, "question_id": 55838534, "link": "https://stackoverflow.com/questions/55838534/stm32-storing-a-map-of-addresses-in-an-array", "title": "STM32: storing a map of addresses in an array", "body": "<p>I'm trying to store a map of addresses in an array.</p>\n\n<p>The following code snippet works as expected on my STM32F767ZI, but compiles with a warning...</p>\n\n<pre><code>intptr_t addressMap[2];\n\nint* a=NULL;\nint* b=NULL;\n\n*a=10;\n*b=20;\n\naddressMap[0]=(intptr_t) a;\naddressMap[1]=(intptr_t) b;\n\nint* c=addressMap[0];\n</code></pre>\n\n<p>compiles with a warning:</p>\n\n<pre><code>initialization makes pointer from integer without a cast [-Wint-conversion]\n</code></pre>\n\n<p>at the last line (<code>int* c=addressMap[0];</code>).</p>\n\n<p>I also tried <code>uint32_t</code> and <code>int32_t</code> as the data type of the <code>addressMap</code> array. Same warning.</p>\n\n<p>According to this document (<a href=\"http://www.keil.com/support/man/docs/armcc/armcc_chr1359125009502.htm\" rel=\"nofollow noreferrer\">http://www.keil.com/support/man/docs/armcc/armcc_chr1359125009502.htm</a>)\naddresses are 32 bit wide (as expected).</p>\n\n<p>How may I write my code without this warning?</p>\n"}, {"tags": ["c", "string", "memcpy", "strcpy"], "comments": [{"owner": {"reputation": 25637, "user_id": 6243352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/715f60f9edc65642a6805752cfeebb27?s=128&d=identicon&r=PG&f=1", "display_name": "ggorlen", "link": "https://stackoverflow.com/users/6243352/ggorlen"}, "edited": false, "score": 2, "creation_date": 1556139902, "post_id": 55838504, "comment_id": 98341064, "body": "Why not <code>strlen(source_str)</code>, then you can alloc the exact size? Also, you don&#39;t need to cast the result of <code>malloc</code>."}, {"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 1, "creation_date": 1556139987, "post_id": 55838504, "comment_id": 98341095, "body": "Add +1 for null"}, {"owner": {"reputation": 4654, "user_id": 332733, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BR7yE.jpg?s=128&g=1", "display_name": "Mgetz", "link": "https://stackoverflow.com/users/332733/mgetz"}, "edited": false, "score": 0, "creation_date": 1556140818, "post_id": 55838504, "comment_id": 98341367, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/1021021/access-element-beyond-the-end-of-an-array-in-c\">Access element beyond the end of an array in C</a>"}], "answers": [{"tags": [], "owner": {"reputation": 20275, "user_id": 887836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UmvnY.jpg?s=128&g=1", "display_name": "Alexander Oh", "link": "https://stackoverflow.com/users/887836/alexander-oh"}, "is_accepted": false, "score": 1, "last_activity_date": 1556140519, "last_edit_date": 1556140519, "creation_date": 1556139983, "answer_id": 55838542, "question_id": 55838504, "link": "https://stackoverflow.com/questions/55838504/c-memcpy-with-char-with-length-greater-than-source-string-length/55838542#55838542", "title": "C - memcpy with char * with length greater than source string length", "body": "<p>memcpy is used to copy fixed blocks of memory, so if you want to copy something shorter that is terminated by <code>'\\n'</code> you don't want to use memcpy.</p>\n\n<p>There is other functions like strncpy or strlcpy that do similar things. \nBest to check what the implementations do. I removed the optimized versions from the original source code for the sake of readability.</p>\n\n<p>This is an example memcpy implementation: <a href=\"https://git.musl-libc.org/cgit/musl/tree/src/string/memcpy.c\" rel=\"nofollow noreferrer\">https://git.musl-libc.org/cgit/musl/tree/src/string/memcpy.c</a></p>\n\n<pre><code>void *memcpy(void *restrict dest, const void *restrict src, size_t n)\n{\n    unsigned char *d = dest;\n    const unsigned char *s = src;\n    for (; n; n--) *d++ = *s++;\n    return dest;\n}\n</code></pre>\n\n<p>It's clear that here, both pieces of memory are visited for n times. regardless of the size of source or destination string, which causes copying of memory past your string if it was shorter. Which is bad and can cause various unwanted behavior.</p>\n\n<p>this is strlcpy from: <a href=\"https://git.musl-libc.org/cgit/musl/tree/src/string/strlcpy.c\" rel=\"nofollow noreferrer\">https://git.musl-libc.org/cgit/musl/tree/src/string/strlcpy.c</a></p>\n\n<pre><code>size_t strlcpy(char *d, const char *s, size_t n)\n{\n    char *d0 = d;\n    size_t *wd;\n\n    if (!n--) goto finish;\n    for (; n &amp;&amp; (*d=*s); n--, s++, d++);\n    *d = 0;\nfinish:\n    return d-d0 + strlen(s);\n}\n</code></pre>\n\n<p>The trick here is that <code>n &amp;&amp; (*d = 0)</code> evaluates to false and will break the looping condition and exit early.</p>\n\n<p>Hence this gives you the wanted behaviour.</p>\n"}, {"tags": [], "owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "is_accepted": false, "score": 2, "last_activity_date": 1556140963, "last_edit_date": 1556140963, "creation_date": 1556140064, "answer_id": 55838564, "question_id": 55838504, "link": "https://stackoverflow.com/questions/55838504/c-memcpy-with-char-with-length-greater-than-source-string-length/55838564#55838564", "title": "C - memcpy with char * with length greater than source string length", "body": "<blockquote>\n  <p>The scenario is that target_str is initialized with 50 bytes. source_str is a string of length 20.</p>\n  \n  <p>If I want to copy the source_str to target_str i use memcpy() as above with length 50, which is the size of target_str. </p>\n</blockquote>\n\n<p>currently you ask for <em>memcpy</em> to read 30 characters after the end of the source string because it does not care of a possible null terminator on the source, this is an undefined behavior</p>\n\n<p>because you copy a string you can use <em>strcpy</em> rather than <em>memcpy</em></p>\n\n<p>but the problem of size can be reversed, I mean the target can be smaller than the source, and without protection you will have again a undefined behavior</p>\n\n<p>so you can use <em>strncpy</em> giving the length of the target, just take care of the necessity to add a final null character in case the target is smaller than the source :</p>\n\n<pre><code>int length = 50\nchar *target_str = (char*) malloc(length);\nchar *source_str = read_string_from_somewhere(); // length unknown\n\nstrncpy(target_str, source_str, length - 1); // -1 to let place for \\0\ntarget_str[length - 1] = 0; // force the presence of a null character at end in case\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "is_accepted": false, "score": 1, "last_activity_date": 1556140106, "creation_date": 1556140106, "answer_id": 55838573, "question_id": 55838504, "link": "https://stackoverflow.com/questions/55838504/c-memcpy-with-char-with-length-greater-than-source-string-length/55838573#55838573", "title": "C - memcpy with char * with length greater than source string length", "body": "<blockquote>\n  <p>Now, if I want to copy till length of source_str based on its terminating character ('\\0'), even if memcpy length is more than the index of terminating character, is the above code a right way to do it? </p>\n</blockquote>\n\n<p>No; you'd be copying the entire content of <code>source_str</code>, even past the null-terminator if it occurs before the end of the allocated space for the string it is pointing to.</p>\n\n<p>If your concern is minimizing the auxiliary space used by your program, what you could do is use <code>strlen</code> to determine the length of <code>source_str</code>, and allocate <code>target_str</code> based on that. Also, <code>strcpy</code> is similar to <code>memcpy</code> but is specifically intended for null-terminated strings (observe that it has no \"size\" or \"length\" parameter):</p>\n\n<pre><code>char *target_str = NULL;\nchar *source_str = read_string_from_somewhere();\nsize_t len = strlen(source_str);\n\ntarget_str = malloc(len + 1);\n\nstrcpy(target_str, source_str);\n\n// ...\n\nfree(target_str);\ntarget_str = NULL;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 2, "last_activity_date": 1556140516, "creation_date": 1556140516, "answer_id": 55838662, "question_id": 55838504, "link": "https://stackoverflow.com/questions/55838504/c-memcpy-with-char-with-length-greater-than-source-string-length/55838662#55838662", "title": "C - memcpy with char * with length greater than source string length", "body": "<blockquote>\n  <p>If I want to copy the source_str to target_str i use memcpy() as above\n  with length 50, which is the size of target_str. The reason I use\n  length in memcpy is that, the source_str can have a max value of\n  length but is usually less than that (in the above example its 20).</p>\n</blockquote>\n\n<p>It is crucially important to distinguish between</p>\n\n<ul>\n<li>the size of the array to which <code>source_str</code> points, and</li>\n<li>the length of the string, if any, to which <code>source_str</code> points (+/- the terminator).</li>\n</ul>\n\n<p>If <code>source_str</code> is certain to point to an array of length 50 or more then the <code>memcpy()</code> approach you present is ok.  If not, then it produces undefined behavior when <code>source_str</code> in fact points to a shorter array. Any result within the power of your C implementation may occur.</p>\n\n<p>If <code>source_str</code> is certain to point to a (properly-terminated) C string of no more than <code>length - 1</code> characters, and if it is its string value that you want to copy, then <code>strcpy()</code> is more natural than <code>memcpy()</code>.  It will copy all the string contents, up to and including the terminator.  This presents no problem when <code>source_str</code> points to an array shorter than <code>length</code>, so long as it contains a string terminator.</p>\n\n<p>If neither of those cases is certain to hold, then it's not clear what you want to do.    The <code>strncpy()</code> function may cover some of those cases, but it does not cover all of them.</p>\n"}], "owner": {"reputation": 296, "user_id": 5621098, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/4bd4d1e7f59f4588d039441a17c4ebf3?s=128&d=identicon&r=PG&f=1", "display_name": "abisheksampath", "link": "https://stackoverflow.com/users/5621098/abisheksampath"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1511, "favorite_count": 0, "answer_count": 4, "score": 3, "last_activity_date": 1556140963, "creation_date": 1556139755, "question_id": 55838504, "link": "https://stackoverflow.com/questions/55838504/c-memcpy-with-char-with-length-greater-than-source-string-length", "title": "C - memcpy with char * with length greater than source string length", "body": "<p>I have the following code in C now</p>\n\n<pre><code>int length = 50\nchar *target_str = (char*) malloc(length);\nchar *source_str = read_string_from_somewhere() // read a string from somewhere\n                                                //    with length, say 20\nmemcpy(target_str, source_str, length);\n</code></pre>\n\n<p>The scenario is that <code>target_str</code> is initialized with 50 bytes. <code>source_str</code> is a string of length 20. </p>\n\n<p>If I want to copy the <code>source_str</code> to <code>target_str</code> i use <em>memcpy()</em> as above with length 50, which is the size of <code>target_str</code>. The reason I use <code>length</code> in memcpy is that, the <code>source_str</code> can have a max value of <code>length</code> but is usually less than that (in the above example its 20). </p>\n\n<p>Now, if I want to copy till length of <code>source_str</code> based on its terminating character (<code>'\\0'</code>), even if memcpy length is more than the index of terminating character, is the above code a right way to do it? or is there an alternative suggestion.</p>\n\n<p>Thanks for any help.</p>\n"}, {"tags": ["c++", "c", "function", "syntax"], "comments": [{"owner": {"reputation": 14474, "user_id": 2064761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GoIUL.png?s=128&g=1", "display_name": "Michael Kenzel", "link": "https://stackoverflow.com/users/2064761/michael-kenzel"}, "edited": false, "score": 0, "creation_date": 1556138962, "post_id": 55838330, "comment_id": 98340682, "body": "Are you familiar with the concept of pointers to begin with?"}, {"owner": {"reputation": 2019, "user_id": 10035556, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86cea073655558939d961937095efc80?s=128&d=identicon&r=PG&f=1", "display_name": "Mayur", "link": "https://stackoverflow.com/users/10035556/mayur"}, "edited": false, "score": 0, "creation_date": 1556139028, "post_id": 55838330, "comment_id": 98340712, "body": "have you used <code>qsort</code> from <code>stdlib.h</code>?"}, {"owner": {"reputation": 5676, "user_id": 5023438, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uvlov.jpg?s=128&g=1", "display_name": "alter igel", "link": "https://stackoverflow.com/users/5023438/alter-igel"}, "edited": false, "score": 3, "creation_date": 1556139077, "post_id": 55838330, "comment_id": 98340733, "body": "A callback is a programming idiom, and a fairly general pattern for performing custom work within the context of some larger system whose details are typically hidden to you. A function pointer on the other hand is a concrete tool, and merely a way of referring to a function; you can use it for a callback, but you can use it for lots of other things too."}, {"owner": {"reputation": 380, "user_id": 1663215, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/YWa3V.jpg?s=128&g=1", "display_name": "Can Bayar", "link": "https://stackoverflow.com/users/1663215/can-bayar"}, "edited": false, "score": 0, "creation_date": 1556139214, "post_id": 55838330, "comment_id": 98340778, "body": "I am familiar with pointers, just never really needed the function pointers so far. I used sort functions too, I know how to pass a comparison function as a callback."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1556139374, "post_id": 55838330, "comment_id": 98340842, "body": "A function pointer is just a variable that can hold a pointer to an arbitrary function. When you pass a callback to a function like <code>qsort</code>, the parameter variable is a function pointer."}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 1, "creation_date": 1556139384, "post_id": 55838330, "comment_id": 98340849, "body": "There is a good discussion here about <i><a href=\"https://stackoverflow.com/questions/840501/how-do-function-pointers-in-c-work\">function pointers</a></i>."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1556140115, "post_id": 55838330, "comment_id": 98341133, "body": "The distinction between function pointers and callbacks is clearer in c++ where callbacks are usually provided as template arguments or encapsulated in <code>std::function</code> objects. In c callbacks are usually function pointers so the distinction may be harder to see."}], "answers": [{"comments": [{"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 1, "creation_date": 1556139611, "post_id": 55838421, "comment_id": 98340938, "body": "@ryyker It is not.  Converting to/from a <code>void *</code> can be done freely without a cast."}, {"owner": {"reputation": 380, "user_id": 1663215, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/YWa3V.jpg?s=128&g=1", "display_name": "Can Bayar", "link": "https://stackoverflow.com/users/1663215/can-bayar"}, "edited": false, "score": 0, "creation_date": 1556139631, "post_id": 55838421, "comment_id": 98340946, "body": "So I can use a function pointer to pass a callback, but they also have other uses? Is this a correct inference?"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1556139837, "post_id": 55838421, "comment_id": 98341031, "body": "@dbush Converting <i>to</i> <code>void*</code> implicitly is allowed. Converting <i>from</i> <code>void*</code> requires a cast. Edit : In c++. I didn&#39;t notice this had both tags."}, {"owner": {"reputation": 380, "user_id": 1663215, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/YWa3V.jpg?s=128&g=1", "display_name": "Can Bayar", "link": "https://stackoverflow.com/users/1663215/can-bayar"}, "edited": false, "score": 0, "creation_date": 1556140231, "post_id": 55838421, "comment_id": 98341182, "body": "Thank you, that clarifies it for me. I will keep the conversation open for a while in order to see if people give more feedbacks. :)"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1556141239, "post_id": 55838421, "comment_id": 98341511, "body": "I would go so far as to say that function pointers have few, if any, legitimate uses cases that cannot reasonably be cast in terms of callbacks.  Callbacks are a design idiom.  Function pointers are the C mechanism for implementing that idiom."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 6, "last_activity_date": 1556139930, "last_edit_date": 1556139930, "creation_date": 1556139357, "answer_id": 55838421, "question_id": 55838330, "link": "https://stackoverflow.com/questions/55838330/what-is-the-relationship-between-callbacks-and-function-pointers/55838421#55838421", "title": "What is the relationship between callbacks and function pointers?", "body": "<p>Function pointers are often used to implement callbacks.  A classic example is the <code>qsort</code> function:</p>\n\n<pre><code>void qsort(void *base, size_t nmemb, size_t size,\n           int (*compar)(const void *, const void *));\n</code></pre>\n\n<p>The 4th argument to this function is a function pointer.  This will typically point to a function you wrote yourself that the <code>qsort</code> function will call.  Here's an example of how it's used:</p>\n\n<pre><code>int cmp(const void *v1, const void *v2)\n{\n    const int *i1 = v1;    // C++ requires cast, C doesn't\n    const int *i2 = v2;    // C++ requires cast, C doesn't\n    if (*i1 &lt; *i2) {\n        return -1;\n    } else if (*i1 &gt; *i2) {\n        return 1;\n    } else {\n        return 0;\n    }\n}\n\nint main()\n{\n    int array[] = { 3, 7, 5, 1, 2, 9, 0, 4 };\n    qsort(array, 8, sizeof(int), cmp);\n}\n</code></pre>\n\n<p>In this example, <code>cmp</code> is used to tell the <code>qsort</code> function how the elements of the list are to be ordered.</p>\n\n<p>Another example of function pointers that is not a callback is if you want to call a particular type of function based on some flag.  For example:</p>\n\n<pre><code>void foo(int case_sensitive)\n{\n    int (*cmpfunc)(const char *, const char *);\n    if (case_sensitive) { \n        cmpfunc = strcmp;\n    } else {\n        cmpfunc = strcasecmp;\n    }\n\n    ...\n    // set strings str1 and str2\n    ...\n    if (cmpfunc(str1, str2) == 0)) {\n        printf(\"strings are equal\\n\");\n    } else {\n        printf(\"strings are not equal\\n\");\n    }\n    ...\n    // set strings str3 and str4\n    ...\n    if (cmpfunc(str3, str4) == 0)) {\n        printf(\"strings are equal\\n\");\n    } else {\n        printf(\"strings are not equal\\n\");\n    }\n    ...\n}\n</code></pre>\n"}], "owner": {"reputation": 380, "user_id": 1663215, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/YWa3V.jpg?s=128&g=1", "display_name": "Can Bayar", "link": "https://stackoverflow.com/users/1663215/can-bayar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 1, "accepted_answer_id": 55838421, "answer_count": 1, "score": 3, "last_activity_date": 1556140536, "creation_date": 1556138869, "last_edit_date": 1556140536, "question_id": 55838330, "link": "https://stackoverflow.com/questions/55838330/what-is-the-relationship-between-callbacks-and-function-pointers", "title": "What is the relationship between callbacks and function pointers?", "body": "<p>I am a little bit confused about this subject. I know what callback is but function pointers are a little bit more confusing to me. Can they mean the same thing (at least in C/C++ context)? Or is one of them including the other, like function pointers can be used as a callback or vice versa.</p>\n\n<p>Is there a relationship between function pointers and callbacks, or are they completely different subjects? </p>\n"}, {"tags": ["c"], "answers": [{"comments": [{"owner": {"reputation": 101, "user_id": 4230851, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08002238056b07d265fc80aa95648378?s=128&d=identicon&r=PG&f=1", "display_name": "ZYX", "link": "https://stackoverflow.com/users/4230851/zyx"}, "edited": false, "score": 0, "creation_date": 1556139432, "post_id": 55838348, "comment_id": 98340867, "body": "2LLU*10248428203192896360LLU&gt;0LLU-1LLU YES a little :)"}], "tags": [], "owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "is_accepted": true, "score": 1, "last_activity_date": 1556138964, "creation_date": 1556138964, "answer_id": 55838348, "question_id": 55838309, "link": "https://stackoverflow.com/questions/55838309/unsigned-long-long-diffrent-results/55838348#55838348", "title": "Unsigned long long diffrent results", "body": "<p>The integer value</p>\n\n<pre><code>2LLU * 10248428203192896360LLU\n</code></pre>\n\n<p>overflows 64 bits, and the compiler should warn about that.  The first is correct</p>\n\n<pre><code>10248428203192896360LLU / 594823321LLU * 2LLU \n</code></pre>\n\n<p>because the division is exact with no remainder, so it does not matter about doubling after the division was made.</p>\n"}], "owner": {"reputation": 101, "user_id": 4230851, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08002238056b07d265fc80aa95648378?s=128&d=identicon&r=PG&f=1", "display_name": "ZYX", "link": "https://stackoverflow.com/users/4230851/zyx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 28, "favorite_count": 0, "accepted_answer_id": 55838348, "answer_count": 1, "score": 0, "last_activity_date": 1556139558, "creation_date": 1556138744, "last_edit_date": 1556139558, "question_id": 55838309, "link": "https://stackoverflow.com/questions/55838309/unsigned-long-long-diffrent-results", "title": "Unsigned long long diffrent results", "body": "<p>Why I got:</p>\n\n<p>34458730320</p>\n\n<p>3446590374</p>\n\n<p>if I run:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main()\n{\n    printf(\"%llu\\n\",10248428203192896360LLU/594823321LLU*2LLU);\n    printf(\"%llu\\n\",2LLU*10248428203192896360LLU/594823321LLU);\n    return 0;\n}\n</code></pre>\n\n<p>I expected that the second is correct (checked in Mathematica, Matlab).</p>\n"}, {"tags": ["c", "signals", "multiple-processes", "sigprocmask"], "comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 3, "creation_date": 1556139406, "post_id": 55838182, "comment_id": 98340859, "body": "You can&#39;t safely call <code>printf()</code> in a signal handler.  Per <a href=\"https://port70.net/~nsz/c/c11/n1570.html#7.1.4p4\" rel=\"nofollow noreferrer\"><b>7.1.4 Use of library functions</b>, paragraph 4 of the C standard</a>: <i>The functions in the standard library are not guaranteed to be reentrant and may modify objects with static or thread storage duration.</i> and <a href=\"https://port70.net/~nsz/c/c11/n1570.html#note188\" rel=\"nofollow noreferrer\">footnote 188</a>: <i>Thus, a signal handler cannot, in general, call standard library functions.</i>  POSIX allows the calling of &quot;async-signal-safe&quot; functions from a signal handler, and provides a list.  <code>printf()</code> is not on that list."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 3, "creation_date": 1556139662, "post_id": 55838182, "comment_id": 98340959, "body": "A blocking call to <code>waitpid()</code> in a signal handler, such as with <code>waitpid(-1, NULL, 0)</code>, is also a bad idea.  <code>while ((pid = waitpid(-1, NULL, WNOHANG)) &gt; 0);</code> is much better - that will reap all child processes that have exited without hanging indefinitely waiting for any child that hasn&#39;t exited.  If there are child processes that haven&#39;t exited, your signal handler will hang until they all have exited."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 3, "creation_date": 1556139867, "post_id": 55838182, "comment_id": 98341048, "body": "Unblocking in the child has no effect on the parent."}], "answers": [{"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": true, "score": 1, "last_activity_date": 1556142613, "creation_date": 1556142613, "answer_id": 55839053, "question_id": 55838182, "link": "https://stackoverflow.com/questions/55838182/should-child-processes-also-be-unblocking-blocked-sigchld-signals/55839053#55839053", "title": "Should child processes also be unblocking blocked SIGCHLD signals?", "body": "<blockquote>\n  <p>However, why would we unblock the signal in the child? Doesn't that\n  just eliminate the whole point of blocking by immediately unblocking\n  it, allowing the child to delete before the parent adds?</p>\n</blockquote>\n\n<p>No.  Each process has its own signal mask.  A new process inherits its parent's signal mask, but only in the same sense that it inherits the contents of the parent's memory -- the child gets what amounts to an independent copy.  Its modifications to that copy are not reflected in the parent's copy, nor <em>vise versa</em> after the child starts.  If this were not the case, then all processes in the system would share a single signal mask.</p>\n\n<p>It is only the parent that must not receive <code>SIGCLD</code> too soon, so only the parent needs to have that signal blocked.</p>\n\n<blockquote>\n  <p>[...] The textbook states:</p>\n  \n  <blockquote>\n    <p>\"Notice that children inherit the blocked set of their parents, so we must be careful to unblock the SIGCHLD signal in the child before\n    calling execve.\"</p>\n  </blockquote>\n  \n  <p>But that still seems to me like the unblocking would result in the\n  handler being called.</p>\n</blockquote>\n\n<p>Again, \"inherit\" in the sense of inheriting a copy, not in the sense of sharing the same mask.</p>\n\n<blockquote>\n  <p>What exactly does this line do?</p>\n</blockquote>\n\n<p>It unblocks <code>SIGCLD</code> in the child -- again, having no effect on the parent -- in case it being blocked would interfere with the behavior of <code>/bin/date</code>, which the child is about to exec.</p>\n"}], "owner": {"reputation": 83, "user_id": 8061021, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/4013dcaa321db12b27d73fd2a252ce30?s=128&d=identicon&r=PG&f=1", "display_name": "Evan", "link": "https://stackoverflow.com/users/8061021/evan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 714, "favorite_count": 0, "accepted_answer_id": 55839053, "answer_count": 1, "score": 2, "last_activity_date": 1556142613, "creation_date": 1556138196, "last_edit_date": 1556138834, "question_id": 55838182, "link": "https://stackoverflow.com/questions/55838182/should-child-processes-also-be-unblocking-blocked-sigchld-signals", "title": "Should child processes also be unblocking blocked SIGCHLD signals?", "body": "<p>I'm trying to understand how blocking and unblocking signals work and I'm trying to understand the following piece of code. Specifically I am looking at line 28 (commented in the code): <code>int a = sigprocmask(SIG_UNBLOCK, &amp;mask, NULL);</code>, aka where the signal is unblocked in the child.</p>\n\n<p>The textbook I got the code from says that the code uses signal blocking in order to ensure that the program performs its add function (simplified to <code>printf(\"adding %d\\n\", pid);</code>) before its delete function (simplified to <code>printf(\"deleting %d\\n\", pid);</code>). This makes sense to me; by blocking the <code>SIGCHLD</code> signal, then unblocking it after we perform the add function, we ensure that handler isn't called until we perform the add function. However, why would we unblock the signal in the child? Doesn't that just eliminate the whole point of blocking by immediately unblocking it, allowing the child to delete before the parent adds?</p>\n\n<p>However, the output (described after the code) is identical whether or not I have the line commented out or not, meaning that is clearly not what happens. The textbook states:</p>\n\n<blockquote>\n  <p>\"Notice that children inherit the blocked set of their parents, so we must be careful to unblock the <code>SIGCHLD</code> signal in the child before calling <code>execve</code>.\" </p>\n</blockquote>\n\n<p>But that still seems to me like the unblocking would result in the handler being called. What exactly does this line do? </p>\n\n<pre><code>void handler(int sig) {\n    pid_t pid;\n    printf(\"here\\n\");\n    while ((pid = waitpid(-1, NULL, 0)) &gt; 0); /* Reap a zombie child */\n    printf(\"deleting %d\\n\", pid); /* Delete the child from the job list */\n}\n\nint main(int argc, char **argv) {\n    int pid;\n    sigset_t mask;\n    signal(SIGCHLD, handler);\n    sigemptyset(&amp;mask);\n    sigaddset(&amp;mask, SIGCHLD);\n    sigprocmask(SIG_BLOCK, &amp;mask, NULL); /* Block SIGCHLD */\n\n    pid = fork();\n    if (pid == 0) {\n        printf(\"in child\\n\");\n\n        int a = sigprocmask(SIG_UNBLOCK, &amp;mask, NULL); // LINE 28\n\n        printf(\"a is %d\\n\",a);\n        execve(\"/bin/date\", argv, NULL);\n        exit(0);\n    }\n\n    printf(\"adding %d\\n\", pid);/* Add the child to the job list */\n    sleep(5);\n    printf(\"awake\\n\");\n\n    int b = sigprocmask(SIG_UNBLOCK, &amp;mask, NULL);\n    printf(\"b is %d\\n\", b);\n    sleep(3);\n\n    exit(0);\n}\n</code></pre>\n\n<p>Outputs:</p>\n\n<pre><code>adding 652\n\nin child\n\na is 0\n\nWed Apr 24 20:18:04 UTC 2019\n\nawake\n\nhere\n\ndeleting -1\n\nb is 0\n</code></pre>\n"}, {"tags": ["c++", "c", "arduino"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1556138634, "post_id": 55838136, "comment_id": 98340571, "body": "Sorry, my mistake"}, {"owner": {"reputation": 1084, "user_id": 2186074, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7rMRz.png?s=128&g=1", "display_name": "Jona", "link": "https://stackoverflow.com/users/2186074/jona"}, "edited": false, "score": 0, "creation_date": 1556139033, "post_id": 55838136, "comment_id": 98340714, "body": "This might help you : <a href=\"https://github.com/arduino/Arduino/wiki/Build-Process\" rel=\"nofollow noreferrer\">github.com/arduino/Arduino/wiki/Build-Process</a>"}, {"owner": {"reputation": 1428, "user_id": 2819922, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/e61964f3e5cdcde3dc90370e0cdfe2d4?s=128&d=identicon&r=PG&f=1", "display_name": "datafiddler", "link": "https://stackoverflow.com/users/2819922/datafiddler"}, "edited": false, "score": 0, "creation_date": 1556139042, "post_id": 55838136, "comment_id": 98340718, "body": "You don&#39;t seem to use the Arduino IDE to compile your project. How do you force <code>SketchWiFi.c</code> to be one of your source files ? Add a <code>SketchWiFi.cpp</code> to your project with that code."}, {"owner": {"reputation": 980, "user_id": 10185183, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-oUA_ZF9CW5c/AAAAAAAAAAI/AAAAAAAACX0/TLhc82gWtsI/photo.jpg?sz=128", "display_name": "arsdever", "link": "https://stackoverflow.com/users/10185183/arsdever"}, "edited": false, "score": 0, "creation_date": 1556139358, "post_id": 55838136, "comment_id": 98340837, "body": "are you using Arduino IDE to build?"}, {"owner": {"reputation": 466, "user_id": 3216326, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/c2OLN.png?s=128&g=1", "display_name": "PKonstant", "link": "https://stackoverflow.com/users/3216326/pkonstant"}, "edited": false, "score": 0, "creation_date": 1556139799, "post_id": 55838136, "comment_id": 98341009, "body": "Yes.  I have compiled in both environments, Visual Studio 2017 and Arduino IDE."}, {"owner": {"reputation": 466, "user_id": 3216326, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/c2OLN.png?s=128&g=1", "display_name": "PKonstant", "link": "https://stackoverflow.com/users/3216326/pkonstant"}, "edited": false, "score": 0, "creation_date": 1556140423, "post_id": 55838136, "comment_id": 98341255, "body": "I have updated my original post to include screenshots of my project structure in Visual Studio 2017 and Arduino IDE."}], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 2629907, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9635cf0045ed8b1ee086cd25bba56840?s=128&d=identicon&r=PG", "display_name": "julovi", "link": "https://stackoverflow.com/users/2629907/julovi"}, "edited": false, "score": 0, "creation_date": 1602684805, "post_id": 55839203, "comment_id": 113799018, "body": "could you show how the .h, and .c files were modified?"}], "tags": [], "owner": {"reputation": 466, "user_id": 3216326, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/c2OLN.png?s=128&g=1", "display_name": "PKonstant", "link": "https://stackoverflow.com/users/3216326/pkonstant"}, "is_accepted": false, "score": 2, "last_activity_date": 1556143984, "last_edit_date": 1556143984, "creation_date": 1556143418, "answer_id": 55839203, "question_id": 55838136, "link": "https://stackoverflow.com/questions/55838136/how-to-compile-a-simple-arduino-program/55839203#55839203", "title": "How to compile a simple Arduino program?", "body": "<p>Per a suggestion posted, I read on GitHub the following:</p>\n\n<p><strong>No pre-processing is done to files in a sketch with any extension other than .ino. Additionally, .h files in the sketch are not automatically #included from the main sketch file.</strong> Further, if you want to call functions defined in a .c file from a .cpp file (like one generated from your sketch), you'll need to wrap its declarations in an 'extern \"C\" {}' block that is defined only inside of C++ files.</p>\n\n<p>So that explains my problem.  I enclosed my simple function 'WiFi_Setup()' with in a class and now it compiles successfully.</p>\n\n<pre><code>class WifiNetwork\n{\nprotected:\n\npublic:\n    void WiFi_Setup();\n};\n</code></pre>\n\n<p>It seems Arduino wants everything to live in classes.</p>\n"}], "owner": {"reputation": 466, "user_id": 3216326, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/c2OLN.png?s=128&g=1", "display_name": "PKonstant", "link": "https://stackoverflow.com/users/3216326/pkonstant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 204, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1556143984, "creation_date": 1556137978, "last_edit_date": 1556140336, "question_id": 55838136, "link": "https://stackoverflow.com/questions/55838136/how-to-compile-a-simple-arduino-program", "title": "How to compile a simple Arduino program?", "body": "<p>I am starting to learn / program the Arduino and I don't understand why I am getting syntax errors upon compiling my program in Visual Studio 2017 with Visual Micro or with the Arduino IDE.</p>\n\n<h2>Compiling output error from Visual Studio 2017:</h2>\n\n<pre><code>sketch\\SketchIncomeEligible.ino.cpp.o:(.text.setup+0x0): undefined reference to `WiFi_Setup()'\n\nsketch\\SketchIncomeEligible.ino.cpp.o: In function `setup':\n\nC:\\Users\\C113850\\source\\repos\\Income_Eligible_Price_Display\\src\\SketchIncomeEligible\\SketchIncomeEligible/SketchIncomeEligible.ino:6: undefined reference to `WiFi_Setup()'\n\ncollect2.exe: error: ld returned 1 exit status\n\nexit status 1\nError compiling for board Adafruit Feather HUZZAH ESP8266.\n</code></pre>\n\n<h2>Compiling error from Arduino IDE:</h2>\n\n<pre><code>Arduino: 1.8.9 (Windows 10), Board: \"Adafruit Feather HUZZAH ESP8266, 80 MHz, Flash, 4M (1M SPIFFS), v2 Lower Memory, Disabled, None, Only Sketch, 115200\"\n\nsketch\\SketchIncomeEligible.ino.cpp.o:(.text.setup+0x0): undefined reference to `WiFi_Setup()'\n\nsketch\\SketchIncomeEligible.ino.cpp.o: In function `setup':\n\nC:\\Users\\C113850\\source\\repos\\Income_Eligible_Price_Display\\src\\SketchIncomeEligible\\SketchIncomeEligible/SketchIncomeEligible.ino:6: undefined reference to `WiFi_Setup()'\n\ncollect2.exe: error: ld returned 1 exit status\n\nexit status 1\nError compiling for board Adafruit Feather HUZZAH ESP8266.\n\nThis report would have more information with\n\"Show verbose output during compilation\"\noption enabled in File -&gt; Preferences.\n</code></pre>\n\n<p>The following is my code:</p>\n\n<h2>SketchWiFi.h file:</h2>\n\n<pre><code>#ifndef _SKETCHWIFI_h\n#define _SKETCHWIFI_h\n\nint WiFi_Setup();\n\n#endif\n</code></pre>\n\n<h2>SketchWiFi.c file:</h2>\n\n<pre><code>#include \"SketchWiFi.h\"\n\nint WiFi_Setup()\n{\n  // put your setup code here, to run once:\n\n  return 1; // Successful\n}\n</code></pre>\n\n<h2>Sketch.ino file:</h2>\n\n<pre><code>#include \"SketchWiFi.h\"\n\nvoid setup() {\n  Serial.begin(115200);\n  Serial.println(\"Begin setup\");\n\n  WiFi_Setup();\n\n  Serial.println(\"End setup\");\n}\n\nvoid loop() {\n  // put your main code here, to run repeatedly:\n}\n</code></pre>\n\n<p><strong>Directory structure:</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/kVrZj.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/kVrZj.jpg\" alt=\"enter image description here\"></a></p>\n\n<p><strong>Project Structure in Visual Studio 2017</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/NyIRs.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/NyIRs.jpg\" alt=\"enter image description here\"></a></p>\n\n<p><strong>Project structure in Arduino IDE</strong>\n<a href=\"https://i.stack.imgur.com/TTGrJ.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/TTGrJ.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["c", "semaphore"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1556137953, "post_id": 55838043, "comment_id": 98340260, "body": "Depending on how often and how long you&#39;re locking for you could use a <a href=\"https://en.wikipedia.org/wiki/Spinlock\" rel=\"nofollow noreferrer\">spinlock</a> with atomic variables, presumably."}, {"owner": {"reputation": 59, "user_id": 8167610, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f359ca40c08f59ff4742257178dce87?s=128&d=identicon&r=PG&f=1", "display_name": "jdodle", "link": "https://stackoverflow.com/users/8167610/jdodle"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1556138177, "post_id": 55838043, "comment_id": 98340376, "body": "This will be used as part of a pipeline so there isn&#39;t an limit on how long I might be waiting"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1556138495, "post_id": 55838043, "comment_id": 98340510, "body": "Semaphores are just one way to coordinate, you could also use mutexes. In any case, you need to wait for all of those semaphores to flip, so waiting in parallel or waiting in series has no change on the outcome. Either they&#39;re all clear or there&#39;s a block."}, {"owner": {"reputation": 59, "user_id": 8167610, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f359ca40c08f59ff4742257178dce87?s=128&d=identicon&r=PG&f=1", "display_name": "jdodle", "link": "https://stackoverflow.com/users/8167610/jdodle"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1556139182, "post_id": 55838043, "comment_id": 98340767, "body": "&quot;waiting in parallel or waiting in series has no change on the outcome&quot; that depends on what type of resource the semaphore is synchronizing. For my purposes the outcome would change and waiting in parallel is simply not an option. I need the resources to be allocated to threads in a contiguous manner. waiting for individual resources in parallel with other threads would provide sparsely located resources. If there isn&#39;t anything built-in that is fine, I just thought I remembered using something like this a while back but couldn&#39;t find anything so I thought I would reach out here to check."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1556139312, "post_id": 55838043, "comment_id": 98340816, "body": "The biggest problem with serially acquiring the semaphore multiple times is not how time consuming it might be, but rather a pretty significant deadlock risk.  Suppose there are six resources total, and two threads are each trying to acquire four of them.  If they manage to acquire three each at the same time, then neither will ever be able to proceed.  The resource acquisition needs to be atomic in order to avoid this kind of problem."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1556139317, "post_id": 55838043, "comment_id": 98340818, "body": "If it&#39;s sequenced, then great, that makes your life easier. You just grab one after the next and release when they&#39;re no longer required. This question read, initially, that you needed to grab <i>N</i> semaphores in any particular order."}], "answers": [{"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": true, "score": 1, "last_activity_date": 1556138848, "creation_date": 1556138848, "answer_id": 55838326, "question_id": 55838043, "link": "https://stackoverflow.com/questions/55838043/is-there-a-built-in-semaphore-structure-that-allows-for-waiting-on-more-than-one/55838326#55838326", "title": "Is there a built-in semaphore structure that allows for waiting on more than one resource?", "body": "<p>You are presently using POSIX semaphores.  They do not directly afford the possibility of atomically changing the semaphore value by more than one, except when creating a new semaphore.</p>\n\n<p>System V semaphores (<code>semget</code> / <code>semctl</code> / <code>semop</code>) are generally considered inferior, but they do have some features that the POSIX flavor lacks, and this is one of them.  Specifically, you can use <code>semop()</code> to <em>atomically</em> deduct any positive number from the semaphore's value, blocking until this can be done without reducing the value below zero.</p>\n\n<p>But System V IPC is enough of a pain overall that I'd suggest instead setting up a shared variable representing the number of resources presently available, and using a mutex + condition variable instead of a semaphore.  That would look something like this:</p>\n\n<pre><code>unsigned resources_available = ALL_RESOURCES;\npthread_mutex_t resource_mutex = PTHREAD_MUTEX_INITIALIZER;\npthread_cond_t resource_cv = PTHREAD_COND_INITIALIZER;\n\n// ...\n\nint acquire_resources(unsigned resources_wanted) {\n    int result;\n\n    // ...\n\n    result = pthread_mutex_lock(resource_mutex);\n    // handle errors ...\n    while (resources_available &lt; resources_wanted) {\n        result = pthread_cond_wait(resource_cv, resource_mutex);\n        // handle errors ...\n    }\n    resources_available -= resources_wanted;\n    result = pthread_mutex_unlock(resource_mutex);\n    // ...\n}\n\nint release_resources(unsigned resources_released) {\n    int result;\n\n    // ...\n\n    result = pthread_mutex_lock(resource_mutex);\n    // handle errors ...\n    resources_available += resources_released;\n    result = pthread_cond_broadcast(resource_cv);\n    // handle errors ...\n    result = pthread_mutex_unlock(resource_mutex);\n    // ...\n}\n</code></pre>\n"}], "owner": {"reputation": 59, "user_id": 8167610, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f359ca40c08f59ff4742257178dce87?s=128&d=identicon&r=PG&f=1", "display_name": "jdodle", "link": "https://stackoverflow.com/users/8167610/jdodle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 176, "favorite_count": 0, "accepted_answer_id": 55838326, "answer_count": 1, "score": 0, "last_activity_date": 1556138848, "creation_date": 1556137562, "question_id": 55838043, "link": "https://stackoverflow.com/questions/55838043/is-there-a-built-in-semaphore-structure-that-allows-for-waiting-on-more-than-one", "title": "Is there a built-in semaphore structure that allows for waiting on more than one resource?", "body": "<p>I would like to be able wait/post more than one resource at a time. Is there a built-in c structure and interface that allows for this?</p>\n\n<p>Currently I am using <code>semaphore.h</code> however this interface has the limitation that it can only request a single resource at a time.</p>\n\n<p>I could do something like this:</p>\n\n<pre><code>for (int i = 0; i &lt; resources; i++)\n    sem_wait(my_sem);\n</code></pre>\n\n<p>But this would be time consuming if <code>resources</code> is large and I would also need to add another lock before this so that I am guaranteed that the requester has priority over other threads that may be requesting resources.\nIt would end up looking something like this:</p>\n\n<pre><code>sem_wait(my_lock);\nfor (int i = 0; i &lt; resources; i++)\n    sem_wait(my_sem);\nsem_post(my_lock);\n</code></pre>\n\n<p>not to mention extra error checks that would need to happen.</p>\n\n<p>What I would like to be able to do is something like this:</p>\n\n<pre><code>sem_wait(my_lock, resources);\n</code></pre>\n\n<p>This would simply wait until all resources are available and then return after decrementing the semaphore by the requested number of resources. I feel like I've seen something like this a while back but can't seem to figure it out.</p>\n"}, {"tags": ["c", "udp", "sleep", "nonblocking"], "comments": [{"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 1, "creation_date": 1556133115, "post_id": 55837011, "comment_id": 98338301, "body": "Remove the sleep()?"}, {"owner": {"reputation": 91, "user_id": 10836046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8697be77607f34a8134fcd574b5da31c?s=128&d=identicon&r=PG&f=1", "display_name": "Julien", "link": "https://stackoverflow.com/users/10836046/julien"}, "reply_to_user": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1556133245, "post_id": 55837011, "comment_id": 98338349, "body": "I want to print the message &quot;Hello World&quot; each 5 seconds."}, {"owner": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "edited": false, "score": 2, "creation_date": 1556133285, "post_id": 55837011, "comment_id": 98338368, "body": "Have you considered using <a href=\"http://www.tutorialspoint.com/unix_system_calls/_newselect.htm\" rel=\"nofollow noreferrer\"><code>select()</code></a> for your UDP communication?"}, {"owner": {"reputation": 91, "user_id": 10836046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8697be77607f34a8134fcd574b5da31c?s=128&d=identicon&r=PG&f=1", "display_name": "Julien", "link": "https://stackoverflow.com/users/10836046/julien"}, "edited": false, "score": 0, "creation_date": 1556134220, "post_id": 55837011, "comment_id": 98338721, "body": "I have. I used <code>select()</code> a first time to receive packages. I tried to use another select to execute my function, but it didn&#39;t work. I set all the fd_set arguments to NULL. But the second select seemed to block the first select."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 1, "creation_date": 1556134960, "post_id": 55837011, "comment_id": 98339000, "body": "It would do.  You should use only one select() call and write your app as an event-driven state machine.  That is the cost of avoiding the kernel-managed state machine of multiple  threads."}, {"owner": {"reputation": 6899, "user_id": 1212012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gmBY7.png?s=128&g=1", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1212012/mathieu"}, "edited": false, "score": 0, "creation_date": 1556135181, "post_id": 55837011, "comment_id": 98339092, "body": "You could use alarm <a href=\"https://linux.die.net/man/2/alarm\" rel=\"nofollow noreferrer\">signal</a> to schedule the hello world print."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "reply_to_user": {"reputation": 6899, "user_id": 1212012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gmBY7.png?s=128&g=1", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1212012/mathieu"}, "edited": false, "score": 2, "creation_date": 1556135529, "post_id": 55837011, "comment_id": 98339232, "body": "@Mathieu printf() is not signal-safe:("}, {"owner": {"reputation": 91, "user_id": 10836046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8697be77607f34a8134fcd574b5da31c?s=128&d=identicon&r=PG&f=1", "display_name": "Julien", "link": "https://stackoverflow.com/users/10836046/julien"}, "reply_to_user": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1556139614, "post_id": 55837011, "comment_id": 98340940, "body": "@MartinJames As I am going to use two timeouts, how is it possible to use only one select() ?"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1556185481, "post_id": 55837011, "comment_id": 98354741, "body": "You build the timeouts into your state machine and set the select() timeout to the nearest timeout-time."}], "owner": {"reputation": 91, "user_id": 10836046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8697be77607f34a8134fcd574b5da31c?s=128&d=identicon&r=PG&f=1", "display_name": "Julien", "link": "https://stackoverflow.com/users/10836046/julien"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 68, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1556132949, "creation_date": 1556132949, "question_id": 55837011, "link": "https://stackoverflow.com/questions/55837011/non-blocking-function-for-udp-chat", "title": "Non blocking function for UDP chat", "body": "<p>In my UDP chat, I receive and parse successfully the packages.\nRight after parsing a package, I want to execute a function <code>func()</code> :</p>\n\n<pre><code>void func(){\n  for(int i = 0; i &lt; 10; i++){\n     printf(\"Hello World\");\n     sleep(5);\n }\n}\n</code></pre>\n\n<p>As <code>sleep()</code>is a blocking timer, I can't receive packages while <code>func()</code>is executed. I am trying to build a UDP chat without threads. How can I make <code>func()</code>non blocking so I can receive packages and execute <code>func()</code>simultaneously ? </p>\n"}, {"tags": ["c", "sdl"], "comments": [{"owner": {"reputation": 2449, "user_id": 500276, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/200bf76976f24add540182f5c3a42788?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Benningfield", "link": "https://stackoverflow.com/users/500276/mark-benningfield"}, "edited": false, "score": 0, "creation_date": 1556133083, "post_id": 55836850, "comment_id": 98338282, "body": "Is there some specific reason you&#39;re using SDL1 instead of SDL2 ?"}, {"owner": {"reputation": 89, "user_id": 1212623, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56967a86d71a05dd246e028db1148f5f?s=128&d=identicon&r=PG", "display_name": "Sebastian", "link": "https://stackoverflow.com/users/1212623/sebastian"}, "reply_to_user": {"reputation": 2449, "user_id": 500276, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/200bf76976f24add540182f5c3a42788?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Benningfield", "link": "https://stackoverflow.com/users/500276/mark-benningfield"}, "edited": false, "score": 0, "creation_date": 1556133221, "post_id": 55836850, "comment_id": 98338341, "body": "Yes - SDL2 has not been ported to the platform I&#39;m coding for"}, {"owner": {"reputation": 2449, "user_id": 500276, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/200bf76976f24add540182f5c3a42788?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Benningfield", "link": "https://stackoverflow.com/users/500276/mark-benningfield"}, "edited": false, "score": 0, "creation_date": 1556133302, "post_id": 55836850, "comment_id": 98338377, "body": "Which platform is that?"}, {"owner": {"reputation": 89, "user_id": 1212623, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56967a86d71a05dd246e028db1148f5f?s=128&d=identicon&r=PG", "display_name": "Sebastian", "link": "https://stackoverflow.com/users/1212623/sebastian"}, "reply_to_user": {"reputation": 2449, "user_id": 500276, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/200bf76976f24add540182f5c3a42788?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Benningfield", "link": "https://stackoverflow.com/users/500276/mark-benningfield"}, "edited": false, "score": 0, "creation_date": 1556133706, "post_id": 55836850, "comment_id": 98338531, "body": "Platform is Nintendo 3DS"}, {"owner": {"reputation": 2449, "user_id": 500276, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/200bf76976f24add540182f5c3a42788?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Benningfield", "link": "https://stackoverflow.com/users/500276/mark-benningfield"}, "edited": false, "score": 0, "creation_date": 1556134199, "post_id": 55836850, "comment_id": 98338707, "body": "You&#39;re not checking the return values of <code>BlitSurface</code> or <code>Flip</code> for errors, so that&#39;s the first thing to do. Also make sure your version of SDL_Image is correct."}, {"owner": {"reputation": 89, "user_id": 1212623, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56967a86d71a05dd246e028db1148f5f?s=128&d=identicon&r=PG", "display_name": "Sebastian", "link": "https://stackoverflow.com/users/1212623/sebastian"}, "reply_to_user": {"reputation": 2449, "user_id": 500276, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/200bf76976f24add540182f5c3a42788?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Benningfield", "link": "https://stackoverflow.com/users/500276/mark-benningfield"}, "edited": false, "score": 0, "creation_date": 1556136946, "post_id": 55836850, "comment_id": 98339822, "body": "Both functions <code>BlitSurface</code> and <code>Flip</code> are returning 0. SDL_image version is 1.2.12, SDL version is 1.2.15"}, {"owner": {"reputation": 2449, "user_id": 500276, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/200bf76976f24add540182f5c3a42788?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Benningfield", "link": "https://stackoverflow.com/users/500276/mark-benningfield"}, "edited": false, "score": 0, "creation_date": 1556137535, "post_id": 55836850, "comment_id": 98340073, "body": "Well, I can&#39;t actually run the code, since I don&#39;t have an older version of SDL and I don&#39;t have a Nintendo dev platform, but it looks like a pixel format problem. You&#39;re sure your PNG image is 24-bit color format? 32-bit is more common."}, {"owner": {"reputation": 47449, "user_id": 44729, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tyWaU.png?s=128&g=1", "display_name": "genpfault", "link": "https://stackoverflow.com/users/44729/genpfault"}, "edited": false, "score": 0, "creation_date": 1556139056, "post_id": 55836850, "comment_id": 98340724, "body": "Can you repro on the bottom screen?"}, {"owner": {"reputation": 89, "user_id": 1212623, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56967a86d71a05dd246e028db1148f5f?s=128&d=identicon&r=PG", "display_name": "Sebastian", "link": "https://stackoverflow.com/users/1212623/sebastian"}, "edited": false, "score": 0, "creation_date": 1556182458, "post_id": 55836850, "comment_id": 98352996, "body": "The PNG is 24 bit color and I can reproduce on the bottom screen. I did some more research and turns out that the image pixels look correct - also the screen pixels after the blit. Seems that rendering of the screen surface to the physical screen is where the issue can be found. AFAIK, this part of the SDL-code is platform specific. Will get in touch with the port author to get this checked"}], "answers": [{"tags": [], "owner": {"reputation": 89, "user_id": 1212623, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56967a86d71a05dd246e028db1148f5f?s=128&d=identicon&r=PG", "display_name": "Sebastian", "link": "https://stackoverflow.com/users/1212623/sebastian"}, "is_accepted": true, "score": 0, "last_activity_date": 1557386121, "creation_date": 1557386121, "answer_id": 56054058, "question_id": 55836850, "link": "https://stackoverflow.com/questions/55836850/sdl-blitsurface-always-blurry-what-am-i-doing-wrong/56054058#56054058", "title": "SDL_BlitSurface always blurry. What am I doing wrong?", "body": "<p>The issue was SDL implementation platform specific and thus not valid for SDL in general</p>\n"}], "owner": {"reputation": 89, "user_id": 1212623, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56967a86d71a05dd246e028db1148f5f?s=128&d=identicon&r=PG", "display_name": "Sebastian", "link": "https://stackoverflow.com/users/1212623/sebastian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 56054058, "answer_count": 1, "score": 1, "last_activity_date": 1557386121, "creation_date": 1556132269, "question_id": 55836850, "link": "https://stackoverflow.com/questions/55836850/sdl-blitsurface-always-blurry-what-am-i-doing-wrong", "title": "SDL_BlitSurface always blurry. What am I doing wrong?", "body": "<p>With my code, I simply want to display a png-image on the screen using SDL 1.2.15, no scaling involved. However, the image shown on the screen with the code below always comes out blurry and the colors are off (see attached image). What am I doing wrong?</p>\n\n<pre><code>SDL_Init(SDL_INIT_VIDEO);\nSDL_Surface *screen = SDL_SetVideoMode(400, 240, 24, SDL_HWSURFACE);\nSDL_Surface *image = IMG_Load ( \"/image.png\" );\nSDL_BlitSurface ( image, NULL, screen, NULL );\nSDL_Flip(screen);\n</code></pre>\n\n<p>The image below shows the original image within the grey box (enlarged - each black stripe is one pixel wide, original dimensions are 11x11px) on the left and what the screen shows after executing the code above on the right.</p>\n\n<p><a href=\"https://i.stack.imgur.com/kd1DP.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/kd1DP.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["c", "server", "document-root"], "comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 2, "creation_date": 1556132546, "post_id": 55836809, "comment_id": 98338041, "body": "Are you looking for <a href=\"http://man7.org/linux/man-pages/man3/realpath.3.html\" rel=\"nofollow noreferrer\">the <code>realpath()</code> function</a>?  It is specified by POSIX, not C itself, but you&#39;ll not find anything for this in C itself, because C doesn&#39;t specify or depend on any of the details of file names and paths."}], "answers": [{"tags": [], "owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "is_accepted": true, "score": 2, "last_activity_date": 1556132575, "creation_date": 1556132575, "answer_id": 55836930, "question_id": 55836809, "link": "https://stackoverflow.com/questions/55836809/how-do-i-make-sure-nobody-gets-access-to-files-out-of-my-document-root-in-my-web/55836930#55836930", "title": "How do I make sure nobody gets access to files out of my document root in my websever", "body": "<p>Use <a href=\"http://man7.org/linux/man-pages/man3/realpath.3.html\" rel=\"nofollow noreferrer\">realpath</a>:</p>\n\n<blockquote>\n  <p>realpath - return the canonicalized absolute pathname</p>\n</blockquote>\n\n<p>It will return the absolute pathname, with all symlinks, all <code>./</code> and all <code>/../</code> resolved. Store your \"document root\" after resolving it with <code>realpath</code> too. After that you can simply <code>memcmp</code> or <code>strcmp</code> resolved path to document root with the resolved pathname to the path you want to test..</p>\n"}], "owner": {"reputation": 43, "user_id": 10632775, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad8b65f0d8898c00108cbbc640d3618b?s=128&d=identicon&r=PG&f=1", "display_name": "Halsi", "link": "https://stackoverflow.com/users/10632775/halsi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 28, "favorite_count": 0, "accepted_answer_id": 55836930, "answer_count": 1, "score": 0, "last_activity_date": 1556132575, "creation_date": 1556132110, "question_id": 55836809, "link": "https://stackoverflow.com/questions/55836809/how-do-i-make-sure-nobody-gets-access-to-files-out-of-my-document-root-in-my-web", "title": "How do I make sure nobody gets access to files out of my document root in my websever", "body": "<p>I'm currently working on a webserver in C.\nI want to make sure that it's impossible to access files that are outside of my document root and I need to write a function that checks the request file / path to that file (for example /index.html) and makes sure there is no way to get out of my document root(for example /../ would make it go out of document root). I was thinking about just checking for ../ and removing that, but then somebody could request ....//, which would be ../ again if we remove ../ out of it. Is there some clever way to do this that I'm not thinking about?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1556129504, "post_id": 55836154, "comment_id": 98336674, "body": "<code>i</code> is your array index.  How do you expect to get the desired element without it?"}, {"owner": {"reputation": 11619, "user_id": 5346306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BsACH.jpg?s=128&g=1", "display_name": "Achal", "link": "https://stackoverflow.com/users/5346306/achal"}, "edited": false, "score": 0, "creation_date": 1556129944, "post_id": 55836154, "comment_id": 98336883, "body": "<i>How to rewrite the following function to use pointer arithmetic instead of array subscripting. ?</i> Pass the array beginning and last element address to <code>sum_array()</code> function and rotate loop until <code>begin</code> not reaches to <code>end</code>."}, {"owner": {"reputation": 588, "user_id": 7067224, "user_type": "registered", "profile_image": "https://graph.facebook.com/1307022785978070/picture?type=large", "display_name": "Gabriel Pellegrino", "link": "https://stackoverflow.com/users/7067224/gabriel-pellegrino"}, "edited": false, "score": 0, "creation_date": 1556130205, "post_id": 55836154, "comment_id": 98337004, "body": "<code>#include &lt;stdio.h&gt;  int sum_array(int *a, int *end) {     int sum = 0;     for (; a != end; a += 1)         sum += *a;     return sum; }  int main(void) {      int x[3] = {10, 20, 30};      printf(&quot;%d\\n&quot;, sum_array(x, x+3));     return 0; }</code>"}, {"owner": {"reputation": 11619, "user_id": 5346306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BsACH.jpg?s=128&g=1", "display_name": "Achal", "link": "https://stackoverflow.com/users/5346306/achal"}, "reply_to_user": {"reputation": 588, "user_id": 7067224, "user_type": "registered", "profile_image": "https://graph.facebook.com/1307022785978070/picture?type=large", "display_name": "Gabriel Pellegrino", "link": "https://stackoverflow.com/users/7067224/gabriel-pellegrino"}, "edited": false, "score": 1, "creation_date": 1556130374, "post_id": 55836154, "comment_id": 98337080, "body": "@GabrielPellegrino <code>x+3</code> is out of array bound &amp; will cause <i>U.B</i> and wrong results."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 11619, "user_id": 5346306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BsACH.jpg?s=128&g=1", "display_name": "Achal", "link": "https://stackoverflow.com/users/5346306/achal"}, "edited": false, "score": 0, "creation_date": 1556130494, "post_id": 55836154, "comment_id": 98337125, "body": "@Achal <code>x+3</code> is actually fine since it points to one element past the end of the array and is not dereferenced, so no UB."}, {"owner": {"reputation": 11619, "user_id": 5346306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BsACH.jpg?s=128&g=1", "display_name": "Achal", "link": "https://stackoverflow.com/users/5346306/achal"}, "reply_to_user": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1556130743, "post_id": 55836154, "comment_id": 98337240, "body": "Agree @dbush its fine only if <code>x+3</code> is not deferenced in calling function. But instead of this why don&#39;t just pass <code>(x + num_ele) - 1</code>"}, {"owner": {"reputation": 1037, "user_id": 6342463, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/STRPB.jpg?s=128&g=1", "display_name": "Jabberwock", "link": "https://stackoverflow.com/users/6342463/jabberwock"}, "edited": false, "score": 0, "creation_date": 1556136363, "post_id": 55836154, "comment_id": 98339610, "body": "An alternative that keeps the same inputs as the original: int sum_array(const int *a, int n) {     int sum;      for (sum = 0 ; n &gt; 0 ; n--)         sum += *a++;     return sum; }"}], "owner": {"reputation": 25, "user_id": 11047444, "user_type": "registered", "profile_image": "https://graph.facebook.com/1578478365553650/picture?type=large", "display_name": "Akki Ala", "link": "https://stackoverflow.com/users/11047444/akki-ala"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 202, "favorite_count": 0, "closed_date": 1556129512, "answer_count": 0, "score": 0, "last_activity_date": 1556129315, "creation_date": 1556129315, "question_id": 55836154, "link": "https://stackoverflow.com/questions/55836154/how-to-use-pointer-arithmetic-instead-of-array-subscripting", "closed_reason": "Duplicate", "title": "How to use pointer arithmetic instead of array subscripting?", "body": "<p>How to rewrite the following function to use pointer arithmetic instead of array subscripting. In other words, I want to eliminate the variable \"i\" and all uses of the [] operator. </p>\n\n<pre><code>int sum_array(const int a[], int n) {\n    int i, sum;\n    sum = 0;\n    for (i = 0; i &lt; n; i++)\n        sum += a[i];\n    return sum;\n}\n</code></pre>\n\n<p>Don't mind I'm new to stack flow ignore if my question or my code is in the wrong format and please help me. Thanks in advance.</p>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1556129062, "post_id": 55836028, "comment_id": 98336483, "body": "You are trying to initialise <code>int c[2][3]</code> with the given data."}, {"owner": {"reputation": 1036, "user_id": 2875210, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/9f0e694b06dfa81e1586010531c075aa?s=128&d=identicon&r=PG&f=1", "display_name": "mzoz", "link": "https://stackoverflow.com/users/2875210/mzoz"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1556129226, "post_id": 55836028, "comment_id": 98336559, "body": "Hi Weather, <code>c</code> is a 2-element array of pointers, you can <code>gcc -S</code> to check the assembly implementation compared with <code>int cc[2][3]</code>."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1556129331, "post_id": 55836028, "comment_id": 98336603, "body": "I meant: the data as provided, would be for <code>int c[2][3]</code>"}], "answers": [{"comments": [{"owner": {"reputation": 1036, "user_id": 2875210, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/9f0e694b06dfa81e1586010531c075aa?s=128&d=identicon&r=PG&f=1", "display_name": "mzoz", "link": "https://stackoverflow.com/users/2875210/mzoz"}, "edited": false, "score": 0, "creation_date": 1556129886, "post_id": 55836080, "comment_id": 98336856, "body": "Thanks dbush, but why does compiler say the code is initializing <code>int *</code> with <code>int</code>? Does initializer have the type of <code>int</code>?"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 1036, "user_id": 2875210, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/9f0e694b06dfa81e1586010531c075aa?s=128&d=identicon&r=PG&f=1", "display_name": "mzoz", "link": "https://stackoverflow.com/users/2875210/mzoz"}, "edited": false, "score": 1, "creation_date": 1556130008, "post_id": 55836080, "comment_id": 98336919, "body": "@mzoz Each value in the initializer list is an <code>int</code>, so that&#39;s what it attempts to assign to the elements of <code>c</code>.  The extra braces don&#39;t make the initializer an array."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 3, "last_activity_date": 1556129647, "last_edit_date": 1556129647, "creation_date": 1556129060, "answer_id": 55836080, "question_id": 55836028, "link": "https://stackoverflow.com/questions/55836028/gcc-warning-about-assigning-a-pointer-variable-with-an-array/55836080#55836080", "title": "GCC warning about assigning a pointer variable with an array?", "body": "<p>Bracketed initializers are not arrays, and so cannot undergo decay to a pointer type.  And because <code>c</code> is an array of <code>int *</code>, each initializer needs to be of that type.  Nested initializers only work with actual arrays (not pointers) or structs.</p>\n\n<p>What you can do however is use <strong>compound literals</strong> in the initializer which do have an array type.</p>\n\n<pre><code>int *c[2] = {(int []){1,2,3}, (int []){4,5,6}};\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1036, "user_id": 2875210, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/9f0e694b06dfa81e1586010531c075aa?s=128&d=identicon&r=PG&f=1", "display_name": "mzoz", "link": "https://stackoverflow.com/users/2875210/mzoz"}, "edited": false, "score": 0, "creation_date": 1556129877, "post_id": 55836134, "comment_id": 98336852, "body": "Thanks John, but why does compiler say the code is initializing <code>int *</code> with <code>int</code>? Does initializer have the type of <code>int</code>?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 1036, "user_id": 2875210, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/9f0e694b06dfa81e1586010531c075aa?s=128&d=identicon&r=PG&f=1", "display_name": "mzoz", "link": "https://stackoverflow.com/users/2875210/mzoz"}, "edited": false, "score": 0, "creation_date": 1556130010, "post_id": 55836134, "comment_id": 98336920, "body": "The first element of <code>{1, 2, 3}</code> does, and that&#39;s what the compiler is looking at.  The initializer for a scalar (including a pointer) can optionally be enclosed in <code>{}</code>.  GCC has diagnosed a small-picture item instead of recognizing and diagnosing the larger issue, and it is understandable that it does so."}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 1, "last_activity_date": 1556129225, "creation_date": 1556129225, "answer_id": 55836134, "question_id": 55836028, "link": "https://stackoverflow.com/questions/55836028/gcc-warning-about-assigning-a-pointer-variable-with-an-array/55836134#55836134", "title": "GCC warning about assigning a pointer variable with an array?", "body": "<blockquote>\n  <p>I suppose array {1,2,3} would decay to pointer so the assignment be legit?</p>\n</blockquote>\n\n<p>No.  <code>{1, 2, 3}</code> is not an array, and no decay applies to it.  It is an initializer suitable for initializing an array of three or more elements of arithmetic type, but you are trying to use it to initialize a pointer.  You could do something like this, instead:</p>\n\n<pre><code>static int x[] = { 1, 2, 3 };\nstatic int y[] = { 4, 5, 6 };\nint *c[] = { x, y };\n</code></pre>\n\n<p>Or you could use compound literals to avoid declaring variables <code>x</code> and <code>y</code>, as another answer suggests.  In either of these cases, the initializer elements <em>are</em> arrays, and they <em>do</em> decay to pointers.</p>\n"}], "owner": {"reputation": 1036, "user_id": 2875210, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/9f0e694b06dfa81e1586010531c075aa?s=128&d=identicon&r=PG&f=1", "display_name": "mzoz", "link": "https://stackoverflow.com/users/2875210/mzoz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "accepted_answer_id": 55836080, "answer_count": 2, "score": 2, "last_activity_date": 1556129647, "creation_date": 1556128858, "last_edit_date": 1556129605, "question_id": 55836028, "link": "https://stackoverflow.com/questions/55836028/gcc-warning-about-assigning-a-pointer-variable-with-an-array", "title": "GCC warning about assigning a pointer variable with an array?", "body": "<p>code snippet:</p>\n\n<pre><code>int *c[2] = {{1,2,3}, {4,5,6}};\n</code></pre>\n\n<p>gives warning: </p>\n\n<pre><code>warning: incompatible integer to pointer conversion initializing 'int *' with an expression of type 'int'\n      [-Wint-conversion]\n    int *c[2] = {{1,2,3}, {4,5,6}};\n                  ^\nwarning: excess elements in scalar initializer\n    int *c[2] = {{1,2,3}, {4,5,6}};\n                    ^\n</code></pre>\n\n<p>I suppose array <code>{1,2,3}</code> would decay to pointer so the assignment be legit?</p>\n\n<p>Further more, according to the warning, why does the compiler think i'm trying to assign <code>int</code> to <code>int *</code>? instead of <code>int array type</code> to <code>int *</code>?  Thanks in advance!</p>\n"}, {"tags": ["c", "file", "structure"], "comments": [{"owner": {"reputation": 4024, "user_id": 3307686, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5dd8d815759c23dd52428c7cc0c35324?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Holt", "link": "https://stackoverflow.com/users/3307686/mike-holt"}, "edited": false, "score": 3, "creation_date": 1556127043, "post_id": 55835510, "comment_id": 98335583, "body": "You are passing an <code>int *</code> as the first argument to <code>fopen</code>. This is wrong. The <code>fopen</code> function takes a <code>char *</code> pointing to a null-terminated filename string as its first argument, not an <code>int *</code>."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 3, "creation_date": 1556127099, "post_id": 55835510, "comment_id": 98335614, "body": "The file name has to be a string: <code>char file_name[1024]; scanf(&quot;%1023s&quot;, file_name); FILE *fin = fopen(file_name , &quot;w&quot;);</code>"}, {"owner": {"reputation": 1, "user_id": 11301964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11f93ab29e38c78d2075c2a4073dd690?s=128&d=identicon&r=PG&f=1", "display_name": "Exciless", "link": "https://stackoverflow.com/users/11301964/exciless"}, "edited": false, "score": 0, "creation_date": 1556132297, "post_id": 55835510, "comment_id": 98337924, "body": "I want to record and display user&#39;s informations but not working please help this is my term project  [1]: <a href=\"https://i.hizliresim.com/4j4Mzp.png\" rel=\"nofollow noreferrer\">i.hizliresim.com/4j4Mzp.png</a> &quot;ScreenShot&quot;"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1556228825, "post_id": 55835510, "comment_id": 98377332, "body": "copy/paste the text contents of the linked file into your question.  We cannot access the linked .PNG file, the result of trying to access it is:  <code>403 Forbidden</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1556228928, "post_id": 55835510, "comment_id": 98377361, "body": "I would suggest using: <code>open()</code> to create the file, as you then have control over its&#39; access permissions, etc"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11301964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11f93ab29e38c78d2075c2a4073dd690?s=128&d=identicon&r=PG&f=1", "display_name": "Exciless", "link": "https://stackoverflow.com/users/11301964/exciless"}, "edited": false, "score": 0, "creation_date": 1556132277, "post_id": 55835706, "comment_id": 98337916, "body": "I want to record and display user&#39;s informations but not working please help this is my term project  [1]: <a href=\"https://i.hizliresim.com/4j4Mzp.png\" rel=\"nofollow noreferrer\">i.hizliresim.com/4j4Mzp.png</a> &quot;ScreenShot&quot;"}, {"owner": {"reputation": 11619, "user_id": 5346306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BsACH.jpg?s=128&g=1", "display_name": "Achal", "link": "https://stackoverflow.com/users/5346306/achal"}, "reply_to_user": {"reputation": 1, "user_id": 11301964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11f93ab29e38c78d2075c2a4073dd690?s=128&d=identicon&r=PG&f=1", "display_name": "Exciless", "link": "https://stackoverflow.com/users/11301964/exciless"}, "edited": false, "score": 1, "creation_date": 1556132437, "post_id": 55835706, "comment_id": 98337992, "body": "Please edit the question &amp; paste in question itself. I can&#39;see it in my system."}, {"owner": {"reputation": 1, "user_id": 11301964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11f93ab29e38c78d2075c2a4073dd690?s=128&d=identicon&r=PG&f=1", "display_name": "Exciless", "link": "https://stackoverflow.com/users/11301964/exciless"}, "edited": false, "score": 0, "creation_date": 1556135856, "post_id": 55835706, "comment_id": 98339383, "body": "please can you share your email adress to me ? because \u0131 can&#39;t paste codes here."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1556229060, "post_id": 55835706, "comment_id": 98377411, "body": "any/everybody can post text into their own question.  So post the text into your question."}], "tags": [], "owner": {"reputation": 11619, "user_id": 5346306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BsACH.jpg?s=128&g=1", "display_name": "Achal", "link": "https://stackoverflow.com/users/5346306/achal"}, "is_accepted": false, "score": 1, "last_activity_date": 1556128345, "last_edit_date": 1556128345, "creation_date": 1556127521, "answer_id": 55835706, "question_id": 55835510, "link": "https://stackoverflow.com/questions/55835510/how-to-write-a-c-program-to-create-a-file/55835706#55835706", "title": "How to write a c program to create a file?", "body": "<p>Here</p>\n\n<pre><code>FILE *fin;\nfin = fopen(&amp;file_name , \"w\"); /* this is wrong, since &amp;file_name is of int* type */\n</code></pre>\n\n<p><code>fopen()</code> expects first argument of <code>char*</code> type but you have provided as of <code>int*</code> type which is wrong, and which has been reported by compiler correctly as</p>\n\n<blockquote>\n  <p><strong>error</strong>: incompatible pointer types passing\n        <code>'int *'</code> to parameter of type <code>'const char *'</code>\n        [-Wincompatible-pointer-types]</p>\n</blockquote>\n\n<p>if you could have compiled with flag like\n<code>-Wall -Wpedantic -Werror</code>. From the manual page of <a href=\"http://man7.org/linux/man-pages/man3/fopen.3.html\" rel=\"nofollow noreferrer\">fopen()</a></p>\n\n<blockquote>\n  <p>FILE *fopen(const char *pathname, const char *mode);</p>\n</blockquote>\n\n<p>Declare <code>file_name</code> as <em>array of characters</em> &amp; store the name of file into it. </p>\n\n<pre><code>char file_name[1024]; /* take a char array to store file name */\n/* @TODO : store actual file name into file_name array */\nFILE *fin = fopen(file_name , \"w\");\nif(fin == NULL) {\n  /* @TODO : error handling */\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11301964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11f93ab29e38c78d2075c2a4073dd690?s=128&d=identicon&r=PG&f=1", "display_name": "Exciless", "link": "https://stackoverflow.com/users/11301964/exciless"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1556132822, "creation_date": 1556126766, "last_edit_date": 1556132822, "question_id": 55835510, "link": "https://stackoverflow.com/questions/55835510/how-to-write-a-c-program-to-create-a-file", "title": "How to write a c program to create a file?", "body": "<p>I want to create a file by importing the file name from the user, please help</p>\n\n<pre><code>int file_name;\nprintf(\"Enter ID NUMBER : \");\nscanf(\"%d\",&amp;file_name);\nFILE *fin;\nfin = fopen(&amp;file_name , \"w\");\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1556127410, "post_id": 55835314, "comment_id": 98335775, "body": "You didn\u2019t specify the third argument to <code>open()</code> which is required with <code>O_CREAT</code>.  The third argument specifies the permissions, which will be modified by the <code>umask</code> value."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1556127447, "post_id": 55835314, "comment_id": 98335789, "body": "<code>open()</code> will set the file mode only if it creates the file.  Are you sure you&#39;re not seeing modes set when the earlier, buggy version of your program created them?  Be sure you remove the files before running the program to see the modes that will be set when they are created."}, {"owner": {"reputation": 528, "user_id": 7377486, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/1924497324448845/picture?type=large", "display_name": "Danial Ahmed", "link": "https://stackoverflow.com/users/7377486/danial-ahmed"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1556127758, "post_id": 55835314, "comment_id": 98335931, "body": "@JohnBollinger I am positive I am removed them. I wrote a simple program again and I get same permissions. I added my program in post."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1556128062, "post_id": 55835314, "comment_id": 98336065, "body": "No, as far as I can tell you <i>didn&#39;t</i> update the question to contain your program.  But we do need you to provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>.  Perhaps your whole program would suit, if it is very simple, but in any case please do try to present something minimal that nevertheless demonstrates the problem."}, {"owner": {"reputation": 528, "user_id": 7377486, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/1924497324448845/picture?type=large", "display_name": "Danial Ahmed", "link": "https://stackoverflow.com/users/7377486/danial-ahmed"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1556128170, "post_id": 55835314, "comment_id": 98336111, "body": "@JohnBollinger Sorry. I just updated it. Thanks"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1556128394, "post_id": 55835314, "comment_id": 98336214, "body": "The program you&#39;ve presented behaves for me exactly as I would expect (on CentOS Linux 7).  When it creates a new file, it assigns a mode formed by applying the process&#39;s umask to the specified mode.  In my case, that produces an actual mode of 0644."}, {"owner": {"reputation": 528, "user_id": 7377486, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/1924497324448845/picture?type=large", "display_name": "Danial Ahmed", "link": "https://stackoverflow.com/users/7377486/danial-ahmed"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1556128646, "post_id": 55835314, "comment_id": 98336320, "body": "@JohnBollinger is it creating file with rw-rw-rw permission?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1556128646, "post_id": 55835314, "comment_id": 98336321, "body": "Are you sure you&#39;re running the version of the program you present?  You did not, for example, forget to recompile after updating the source?"}, {"owner": {"reputation": 528, "user_id": 7377486, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/1924497324448845/picture?type=large", "display_name": "Danial Ahmed", "link": "https://stackoverflow.com/users/7377486/danial-ahmed"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1556128709, "post_id": 55835314, "comment_id": 98336346, "body": "@JohnBollinger Yes I am running the program I posted here."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1556128748, "post_id": 55835314, "comment_id": 98336364, "body": "For me, your program is creating the file with the expected permissions.  As I said, the process&#39;s umask factors in to that, so in my particular case, my expectation is 0644 (rw-r--r--), and that&#39;s what I see."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1556128856, "post_id": 55835314, "comment_id": 98336398, "body": "Add the <code>O_EXCL</code> flag - <code>open(argv[1],O_WRONLY | O_TRUNC | O_CREAT | O_EXCL, 0666);</code> and emit an error message that either uses <code>perror()</code> or includes <code>errno</code> and/or the output from <code>strerror()</code> if the <code>open()</code> fails."}, {"owner": {"reputation": 528, "user_id": 7377486, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/1924497324448845/picture?type=large", "display_name": "Danial Ahmed", "link": "https://stackoverflow.com/users/7377486/danial-ahmed"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1556128889, "post_id": 55835314, "comment_id": 98336415, "body": "@JohnBollinger Thank you. You were right I was using 666 instead of 0666. Thank you so much!"}, {"owner": {"reputation": 528, "user_id": 7377486, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/1924497324448845/picture?type=large", "display_name": "Danial Ahmed", "link": "https://stackoverflow.com/users/7377486/danial-ahmed"}, "reply_to_user": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "edited": false, "score": 0, "creation_date": 1556128998, "post_id": 55835314, "comment_id": 98336460, "body": "@P.P. Yes, because I think I didnt press ctrl+s correctly"}], "answers": [{"tags": [], "owner": {"reputation": 528, "user_id": 7377486, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/1924497324448845/picture?type=large", "display_name": "Danial Ahmed", "link": "https://stackoverflow.com/users/7377486/danial-ahmed"}, "is_accepted": false, "score": 0, "last_activity_date": 1556129050, "creation_date": 1556129050, "answer_id": 55836078, "question_id": 55835314, "link": "https://stackoverflow.com/questions/55835314/open-creating-file-with-weird-permissionss/55836078#55836078", "title": "Open creating file with weird permissionss", "body": "<p>As pointed by @JohnBollinger in comment I didnt save the file correctly and I was using 666 instead of 0666</p>\n"}], "owner": {"reputation": 528, "user_id": 7377486, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/1924497324448845/picture?type=large", "display_name": "Danial Ahmed", "link": "https://stackoverflow.com/users/7377486/danial-ahmed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1556129050, "creation_date": 1556125881, "last_edit_date": 1556128607, "question_id": 55835314, "link": "https://stackoverflow.com/questions/55835314/open-creating-file-with-weird-permissionss", "title": "Open creating file with weird permissionss", "body": "<p>At first I was using </p>\n\n<pre><code>fd = open(outputfile,O_WRONLY | O_TRUNC | O_CREAT);\n</code></pre>\n\n<p>which was giving me random file permissions but now I am using</p>\n\n<pre><code>fd = open(outputfile,O_WRONLY | O_TRUNC | O_CREAT, 0666);\n</code></pre>\n\n<p>this code is produces file exact same file permissions but they are weird.\nI actually want -rw-rw-rw- but I am getting:</p>\n\n<pre><code>--w---x--T 1 root root    21 Apr 24 13:02 fasdfas\n</code></pre>\n\n<p>and on one of the other system:</p>\n\n<pre><code>--w--wx--T 1 s8771-26 s8771-26    21 Apr 24 22:09 test1\n--w--wx--T 1 s8771-26 s8771-26    21 Apr 24 22:09 test2\n--w--wx--T 1 s8771-26 s8771-26    21 Apr 24 22:09 test3\n--w--wx--T 1 s8771-26 s8771-26    21 Apr 24 22:09 test4\n\n\n#include &lt;stdio.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/stat.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;unistd.h&gt;\n\nint main(int argc, char ** argv)\n{\n    int fd = open(argv[1],O_WRONLY | O_TRUNC | O_CREAT, 0666);\n    dup2(fd,1);\n    printf(\"TEST\");\n    return 0;\n}\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/IiqsS.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/IiqsS.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["c", "microcontroller", "spi", "atmega"], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 11367967, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c28dec41b9f58f30788124fc26da0a87?s=128&d=identicon&r=PG&f=1", "display_name": "sss", "link": "https://stackoverflow.com/users/11367967/sss"}, "edited": false, "score": 0, "creation_date": 1556183851, "post_id": 55844432, "comment_id": 98353774, "body": "Thank you for noting that, unfortunately it was me who did a bad job of asking the question. I had these lines already. I also have SPCR = (1&lt;&lt;SPE) | (1&lt;&lt;MSTR) | (1&lt;&lt;CPOL);"}], "tags": [], "owner": {"reputation": 3648, "user_id": 4931630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4290ddd0630dd0091e3b9713a23c3434?s=128&d=identicon&r=PG&f=1", "display_name": "AterLux", "link": "https://stackoverflow.com/users/4931630/aterlux"}, "is_accepted": false, "score": 0, "last_activity_date": 1556180280, "last_edit_date": 1556180280, "creation_date": 1556178980, "answer_id": 55844432, "question_id": 55835248, "link": "https://stackoverflow.com/questions/55835248/why-is-not-my-spi-communication-working-atmega644/55844432#55844432", "title": "Why is not my SPI communication working? (Atmega644)", "body": "<p>There is no SPI initialization in your code. </p>\n\n<p>add into <code>main()</code></p>\n\n<pre><code>SPSR = (1 &lt;&lt; SPI2X);  // double speed (to get maximum of 8MHz output)\nSPCR = (1 &lt;&lt; SPE)  | (1 &lt;&lt; MSTR); // 1:1 prescaler, master mode, SPI mode 0, SPI enable\n</code></pre>\n\n<p>Also several remarks to your code:</p>\n\n<p>use <code>sei()</code> only after all initializations are done, to avoid interrupts happened on uninitialized peripheral.</p>\n\n<p>better first set PB4 high then setup it as output to avoid PB output low between two commands:</p>\n\n<pre><code>PORTB = (1 &lt;&lt; PINB4) //active low on SS.\nDDRB = 0b10110000; //Set MOSI, SCK and SS as output.\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 45, "user_id": 11367967, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c28dec41b9f58f30788124fc26da0a87?s=128&d=identicon&r=PG&f=1", "display_name": "sss", "link": "https://stackoverflow.com/users/11367967/sss"}, "edited": false, "score": 0, "creation_date": 1556193004, "post_id": 55846190, "comment_id": 98359025, "body": "Why would the SPDR set that? Can&#39;t I just connect the SHDN to the 5V rail instead?"}, {"owner": {"reputation": 1130, "user_id": 2368681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f80488f6f8c93ca4aeab533a7b125153?s=128&d=identicon&r=PG", "display_name": "pm101", "link": "https://stackoverflow.com/users/2368681/pm101"}, "reply_to_user": {"reputation": 45, "user_id": 11367967, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c28dec41b9f58f30788124fc26da0a87?s=128&d=identicon&r=PG&f=1", "display_name": "sss", "link": "https://stackoverflow.com/users/11367967/sss"}, "edited": false, "score": 0, "creation_date": 1556193485, "post_id": 55846190, "comment_id": 98359295, "body": "The datasheet states <code>The user can shut down the device using a software command (&lt;SHDN&gt; = 0) or SHDN pin. During shutdown mode, most of the internal circuits, including the output amplifier, are turned off for power savings</code>"}, {"owner": {"reputation": 45, "user_id": 11367967, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c28dec41b9f58f30788124fc26da0a87?s=128&d=identicon&r=PG&f=1", "display_name": "sss", "link": "https://stackoverflow.com/users/11367967/sss"}, "edited": false, "score": 0, "creation_date": 1556194561, "post_id": 55846190, "comment_id": 98359912, "body": "But that is not sent through the SPDR right? That is if I were to give the SHDN pin on the MCP4811 a designated pin on my MCU and set it to low?"}, {"owner": {"reputation": 1130, "user_id": 2368681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f80488f6f8c93ca4aeab533a7b125153?s=128&d=identicon&r=PG", "display_name": "pm101", "link": "https://stackoverflow.com/users/2368681/pm101"}, "reply_to_user": {"reputation": 45, "user_id": 11367967, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c28dec41b9f58f30788124fc26da0a87?s=128&d=identicon&r=PG&f=1", "display_name": "sss", "link": "https://stackoverflow.com/users/11367967/sss"}, "edited": false, "score": 0, "creation_date": 1556194890, "post_id": 55846190, "comment_id": 98360128, "body": "See MCP4801/4811/4821 datasheet (DS22244B) page 22. <code>&quot;WRITE COMMAND REGISTER FOR MCP4811 (10-BIT DAC)&quot;</code> The &#172;SHDN bit is sent as part of the <code>WRITE REGISTER</code> command.&#172;SHDN pin must be HIGH and &#172;SHDN bit on DAC register must also be 1 otherwise there will be no analog output on Vout pin. <code>The device will remain in Shutdown mode until the &lt;SHDN&gt; bit = 1 is latched into the device or SHDN pin is changed to logic high</code>. Please try first if this is the problem, as it may be not (its not difficult to change one bit)"}, {"owner": {"reputation": 45, "user_id": 11367967, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c28dec41b9f58f30788124fc26da0a87?s=128&d=identicon&r=PG&f=1", "display_name": "sss", "link": "https://stackoverflow.com/users/11367967/sss"}, "edited": false, "score": 0, "creation_date": 1556199060, "post_id": 55846190, "comment_id": 98362839, "body": "This was the answer, in combination with setting SHDN to 5V rail. Thank you!"}], "tags": [], "owner": {"reputation": 1130, "user_id": 2368681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f80488f6f8c93ca4aeab533a7b125153?s=128&d=identicon&r=PG", "display_name": "pm101", "link": "https://stackoverflow.com/users/2368681/pm101"}, "is_accepted": true, "score": 0, "last_activity_date": 1556185088, "creation_date": 1556185088, "answer_id": 55846190, "question_id": 55835248, "link": "https://stackoverflow.com/questions/55835248/why-is-not-my-spi-communication-working-atmega644/55846190#55846190", "title": "Why is not my SPI communication working? (Atmega644)", "body": "<p>Your line here</p>\n\n<p><code>SPDR = (char) ((audio_out &gt;&gt; 6) &amp; 0x000f); //byte 1 0 0 0 0 b9 b8 b7 b6</code></p>\n\n<p>Will set \u00acSHDN to 0 which will shutdown the DAC</p>\n\n<p><code>0 = Shutdown the device. Analog output is not available. VOUT pin is connected to 500 kohm typical)</code></p>\n\n<p>Set bit 12 to 1 instead</p>\n\n<p><code>SPDR = (char) ((audio_out &gt;&gt; 6) &amp; 0x0f)|0x10; //byte 1 0 0 0 1 b9 b8 b7 b6</code></p>\n\n<p>from datasheet</p>\n\n<p><code>1 = Active mode operation. VOUT is available.</code></p>\n"}], "owner": {"reputation": 45, "user_id": 11367967, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c28dec41b9f58f30788124fc26da0a87?s=128&d=identicon&r=PG&f=1", "display_name": "sss", "link": "https://stackoverflow.com/users/11367967/sss"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "accepted_answer_id": 55846190, "answer_count": 2, "score": 0, "last_activity_date": 1556185088, "creation_date": 1556125584, "last_edit_date": 1556184321, "question_id": 55835248, "link": "https://stackoverflow.com/questions/55835248/why-is-not-my-spi-communication-working-atmega644", "title": "Why is not my SPI communication working? (Atmega644)", "body": "<p>I'm building a drum machine, and I have stored a sample header file with a kick sound which takes values between 0 and 170. I want to send it over SPI to a 10-bit MCP4811 DAC which then outputs it to a 3.5mm audio jack.</p>\n\n<p>I have my MISO,MOSI,SCK and RESET pins connected to my USB programmer as well as the DAC.</p>\n\n<p>Here is a snippet of the audio file stored in \"samples.h\"</p>\n\n<pre><code>unsigned const char sample_1[2221] PROGMEM = {0, 0, 0, 1, 1, 1, 2, 2, 2, 3, 3, 4, 4, 4, 5, 5, 5, 6, 6, ...}\nunsigned int sample_len[1] = {2221}\n</code></pre>\n\n<p>So it is a sample of 2221 bits. This I want to send to the DAC using SPI with freq = 22 kHz.</p>\n\n<p>I'm using a 16 MHz Crystal, so I set the fuses accordingly to use it.</p>\n\n<p>I am using a Timer which overflows 22 kHz.</p>\n\n<pre><code>volatile unsigned int sample_count[1] = {0};\nvolatile unsigned int audio_out = 0;\nvolatile unsigned char spi_junk;\n\nint main (void)\nsei();\nDDRB = 0b10110000; //Set MOSI, SCK and SS as output.\nPORTB = (1 &lt;&lt; PINB4) //active low on SS.\n\nTIMSK1 = (1&lt;&lt;OCIE1A); //Enable interrupt\nTCCR1B = (1&lt;&lt;WGM12) | (1&lt;&lt;CS11); // set CTC mode and divide clk by 8 \nOCR1A = 91; //16 MHz/(8*91) ~ 22068 Hz\n\n//SPI Init\nSPCR = (1&lt;&lt;SPE) | (1&lt;&lt;MSTR);  //master, 8 MHz\nSPSR = (1&lt;&lt;SPI2X);\n\nISR (TIMER1_COMPA_vect) {\n    audio_out = 0;\n\n//If play_track == 1, then the sound should be played back.\nif (play_track &amp;&amp; sample_count[0] &lt; sample_len[0]){\n   audio_out += (pgm_read_byte(&amp;(sample_1[sample_count[0]++)));\n\n// send audio_out to 10-bit DAC on SPI\nPORTB &amp;= ~(1&lt;&lt;PINB4); // B.4 (DAC /CS)\nSPDR = (char) ((audio_out &gt;&gt; 6) &amp; 0x000f); //byte 1 0 0 0 0 b9 b8 b7 b6\nwhile (!(SPSR &amp; (1&lt;&lt;SPIF)));\nspi_junk = SPDR;\n\nSPDR = (char) ((audio_out &amp; 0x003f) &lt;&lt; 2); //byte 2 b5 b4 b3 b2 b1 b0 0 0\nwhile (!(SPSR &amp; (1&lt;&lt;SPIF)));\nspi_junk = SPDR;\nPORTB |= (1&lt;&lt;PINB4);\n}\n</code></pre>\n\n<p>My PIN set up is. </p>\n\n<p>Atmega644 -> DAC</p>\n\n<pre><code>MOSI -&gt; SDI\n\nSCK -&gt; SCK\n\nSS -&gt; /CS\n</code></pre>\n\n<p>On MCP4811</p>\n\n<pre><code>Vdd -&gt; 5V\n\nVss -&gt; GND\n\nV_out -&gt; Audio jack.\n</code></pre>\n\n<p>The rest of the pins on the MCP4811 are not connected to anything.</p>\n\n<p>I have seen that the audio_out is working as expected, by displaying the audio_out value on a LCD screen. But nothing is being output to the DAC. Anyone see what could be wrong?</p>\n\n<p>EDIT: Added the SPI init which I had missed to add.</p>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 3, "creation_date": 1556122677, "post_id": 55834509, "comment_id": 98333521, "body": "Is is assigned the <code>NULL</code> pointer value. Aside: the format specifier to use with <code>sizeof</code> is <code>%zu</code>."}, {"owner": {"reputation": 11619, "user_id": 5346306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BsACH.jpg?s=128&g=1", "display_name": "Achal", "link": "https://stackoverflow.com/users/5346306/achal"}, "edited": false, "score": 1, "creation_date": 1556122749, "post_id": 55834509, "comment_id": 98333557, "body": "<i>what is assigned to pVoid in second line. ?</i> Its <code>NULL</code>. Side note, in standard C library, <code>NULL</code> is defined as <code>(void*)0</code>."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1556122947, "post_id": 55834509, "comment_id": 98333660, "body": "<a href=\"https://softwareengineering.stackexchange.com/a/128447/30872\">softwareengineering.stackexchange.com/a/128447/30872</a>"}], "answers": [{"comments": [{"owner": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "edited": false, "score": 0, "creation_date": 1556135573, "post_id": 55835013, "comment_id": 98339252, "body": "This is only one possible implementation of <code>NULL</code>, unfortunately."}, {"owner": {"reputation": 2503, "user_id": 7442673, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/iTfit.jpg?s=128&g=1", "display_name": "m.raynal", "link": "https://stackoverflow.com/users/7442673/m-raynal"}, "reply_to_user": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "edited": false, "score": 0, "creation_date": 1556151322, "post_id": 55835013, "comment_id": 98343763, "body": "Could you develop ? Including <code>stdlib.h</code> at the top of all my <code>.c</code> files has become such a reflex that I don&#39;t know of any other definition, I&#39;d like to learn something."}, {"owner": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "edited": false, "score": 1, "creation_date": 1556173860, "post_id": 55835013, "comment_id": 98348687, "body": "Yes, this is what you are supposed to use. The defintion in the C standard is just a null pointer constant. Other values that are commonly used are <code>0</code> or <code>0L</code>, for example. Only because your platform uses a certain value, doesn&#39;t mean that other platforms have to use the same."}], "tags": [], "owner": {"reputation": 2503, "user_id": 7442673, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/iTfit.jpg?s=128&g=1", "display_name": "m.raynal", "link": "https://stackoverflow.com/users/7442673/m-raynal"}, "is_accepted": false, "score": 2, "last_activity_date": 1556203077, "last_edit_date": 1556203077, "creation_date": 1556124623, "answer_id": 55835013, "question_id": 55834509, "link": "https://stackoverflow.com/questions/55834509/void-pointer-and-its-assignment-to-the-void-datatype/55835013#55835013", "title": "void pointer and its assignment to the void datatype", "body": "<p>Copied directly from the <a href=\"https://clc-wiki.net/wiki/C_standard_library:stdlib.h:NULL\" rel=\"nofollow noreferrer\">standard library wiki</a>:</p>\n\n<blockquote>\n  <p>Defined in stddef.h, locale.h, stdio.h, stdlib.h, string.h,\n  time.h.</p>\n  \n  <p>In standard C, this can be implemented as:</p>\n\n<pre><code>#if !defined(NULL)\n    #define NULL ((void*)0)\n#endif\n</code></pre>\n</blockquote>\n\n<p>So <code>pVoid</code> get assigned exactly what it would get assigned with <code>NULL</code> on the second line.</p>\n\n<p><strong>Edit</strong>: as mentioned by @Jens Gustedt in comments, it is good to note that this implementation of <code>NULL</code> is not unique, and can be platform-dependent.</p>\n"}, {"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 1, "last_activity_date": 1556203588, "creation_date": 1556203588, "answer_id": 55852059, "question_id": 55834509, "link": "https://stackoverflow.com/questions/55834509/void-pointer-and-its-assignment-to-the-void-datatype/55852059#55852059", "title": "void pointer and its assignment to the void datatype", "body": "<p><code>pVoid</code> is assigned the value <code>NULL</code>.  This is because the expression <code>(void*)0</code> is defined as a <strong>null pointer constant</strong>.</p>\n\n<p>Section 6.3.2.3p3 of the <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf\" rel=\"nofollow noreferrer\">C standard</a> states:</p>\n\n<blockquote>\n  <p>An  integer  constant  expression  with  the  value  0,  or  such  an \n  expression  cast  to  type <code>void *</code> , is called a <em>null pointer constant</em>\n  .  If a null pointer constant is converted to a pointer type, the\n  resulting pointer, called a <em>null pointer</em>, is guaranteed to compare\n  unequal to a pointer to any object or function.</p>\n</blockquote>\n"}], "owner": {"reputation": 17, "user_id": 9591574, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2019bf7a864fdbc1fbe427fe1a913f01?s=128&d=identicon&r=PG&f=1", "display_name": "Yatharth", "link": "https://stackoverflow.com/users/9591574/yatharth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 139, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1556203588, "creation_date": 1556122626, "last_edit_date": 1556124038, "question_id": 55834509, "link": "https://stackoverflow.com/questions/55834509/void-pointer-and-its-assignment-to-the-void-datatype", "title": "void pointer and its assignment to the void datatype", "body": "<p>The problem is using void datatype and assigning some value to the void variable.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\nint main()\n{\n void *pVoid;\n pVoid = (void*)0;\n printf(\"%lu\",sizeof(pVoid));\n return 0;\n}\n</code></pre>\n\n<p>what is assigned to pVoid in second line.</p>\n"}, {"tags": ["c", "string", "constants"], "comments": [{"owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "edited": false, "score": 4, "creation_date": 1556121891, "post_id": 55834245, "comment_id": 98333106, "body": "What <code>a[i]</code> <i>points to</i> is immutable, but <code>a[i]</code> is not.  <code>a[i]</code> is a <i>pointer to <code>const char</code></i>.  The pointer can be changed to point to a different <code>const char</code> object."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1556122194, "post_id": 55834245, "comment_id": 98333275, "body": "it is : <code>declare a as array of pointer to const char</code> . So this one will not compile a[0][0] = &#39;x&#39;;"}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 1, "creation_date": 1556122236, "post_id": 55834245, "comment_id": 98333304, "body": "wrong dupe - it is something different"}], "owner": {"reputation": 11251, "user_id": 3284878, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/d324c610856d2626e9b719eb4135b3cb?s=128&d=identicon&r=PG&f=1", "display_name": "Aviv Cohn", "link": "https://stackoverflow.com/users/3284878/aviv-cohn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "closed_date": 1556121927, "answer_count": 0, "score": 3, "last_activity_date": 1556121778, "creation_date": 1556121778, "question_id": 55834245, "link": "https://stackoverflow.com/questions/55834245/why-am-i-able-to-modify-this-const-char-array", "closed_reason": "Duplicate", "title": "Why am I able to modify this const char* array?", "body": "<p>Why does this work? It seems to me assigning <code>a[0] = \"X\"</code> should fail because <code>const</code> should make the data in the array immutable. However it compiles and runs fine, with and without <code>const</code>.</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>const char* a[] = {\"a\", \"b\", \"c\"};\na[0] = \"X\";\nprintf(\"%s\\n\", a[0]);\n</code></pre>\n"}, {"tags": ["c", "double-pointer", "undirected-graph"], "answers": [{"tags": [], "owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "is_accepted": true, "score": 0, "last_activity_date": 1556123391, "creation_date": 1556123391, "answer_id": 55834714, "question_id": 55834210, "link": "https://stackoverflow.com/questions/55834210/implementing-undirected-graph-with-adjacency-matrix/55834714#55834714", "title": "Implementing undirected graph with adjacency matrix", "body": "<p>Here:</p>\n\n<pre><code>g-&gt;matrix = malloc(sizeof(int*) * g-&gt;verNum * g-&gt;verNum);\n</code></pre>\n\n<p>you allocate a flat, one-dimensional array of size <em>V</em>&times;<em>V</em>. You access that array as if it were a two-domensional array: <code>g-&gt;matrix[i][j].adj</code>.</p>\n\n<p>Representing the adjacency matrix as two-dimensional array is a good idea, but your allocation must then also be two-dimensional: Allocate an array of <em>V</em> pointers to <code>int</code>, then make each of that pointers a handle to an array of <em>V</em> ints:</p>\n\n<pre><code>g-&gt;matrix = malloc(g-&gt;verNum * sizeof(*g-&gt;matrix));\n\nfor (int i = 0; i &lt; g-&gt;verNum; i++) {\n    g-&gt;matrix[i] = calloc(g-&gt;verNum, sizeof(*g-&gt;matrix[i]));    \n}\n</code></pre>\n\n<p>Things to note:</p>\n\n<ul>\n<li><code>calloc(n, size)</code> is like <code>malloc(n*size)</code>, but it zeroes out the memory first, so that you start with an unconnected graph.</li>\n<li><code>p = malloc(n * sizeof(*p))</code> is a useful idiom that infers the type from <code>p</code> rather than specifying the type explicitly.</li>\n<li>There are other ways to get a two-dimensional array. For example, you could allocate a flat array of dimension <em>V</em>&times;<em>V</em> as you did and then make <code>matrix</code> an array of pointers into that array, so that <code>matrix[i]</code> represents a row in the flat array. I think for learning purposes, the approach above is better, because it is more straightforward.</li>\n<li>Of course you must <code>free</code> the allocated memory later. Do this in the reverse order: Free the <code>matrix[i]</code> first, then the <code>matrix</code> proper.</li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 1, "creation_date": 1556124991, "post_id": 55834768, "comment_id": 98334654, "body": "&quot;<i>it is not safe to assume that <code>sizeof(int *)</code> is the same as <code>sizeof(vernode *)</code></i>&quot;  ? the size of a pointer is always the same and does not depend on the pointed type, fortunately"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1556126581, "post_id": 55834768, "comment_id": 98335348, "body": "That is often the case, @bruno, systematically so in many implementations, but in fact it is <i>not</i> guaranteed."}, {"owner": {"reputation": 343, "user_id": 10905279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c67005ead86ba8a7ad9d464e879fbb5e?s=128&d=identicon&r=PG&f=1", "display_name": "Liu", "link": "https://stackoverflow.com/users/10905279/liu"}, "edited": false, "score": 0, "creation_date": 1556200931, "post_id": 55834768, "comment_id": 98364098, "body": "Thank you very much"}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 0, "last_activity_date": 1556123617, "creation_date": 1556123617, "answer_id": 55834768, "question_id": 55834210, "link": "https://stackoverflow.com/questions/55834210/implementing-undirected-graph-with-adjacency-matrix/55834768#55834768", "title": "Implementing undirected graph with adjacency matrix", "body": "<p>You have declared <code>graph.matrix</code> as a <code>vernode **</code>.  You have allocated memory for the particular instance <code>g-&gt;matrix</code>, apparently successfully.  <code>*g-&gt;matrix</code> designates a <code>vernode *</code> appearing at the beginning of that space (and given that you intend to use the space as an array, it would be more conventional to designate that element as <code>g-&gt;matrix[0]</code>, which is equivalent).  <em>But you never assigned a value to that object</em>.  Its value is indeterminate, and you invoke undefined behavior by attempting to access it.</p>\n\n<p>Overall, it looks like you've munged together aspects of multiple different approaches.  This allocation ...</p>\n\n<pre><code>g-&gt;matrix=malloc(sizeof(int*)*g-&gt;verNum*g-&gt;verNum);\n</code></pre>\n\n<p>... is wrong in the first place because it is not safe to assume that <code>sizeof(int *)</code> is the same as <code>sizeof(vernode *)</code>, and the latter is what you actually need given the declared type of <code>g-&gt;matrix</code>.  It seems to be wrong also because you are allocating much more space than I would expect for a double-pointer-based approach.  One would normally allocate one pointer for each row, not one per element, and then separately allocate memory for the elements of each row.  This would then support double indexing as if you had a <em>bona fide</em> 2D array: <code>g-&gt;matrix[i][j].adj = 0;</code>.</p>\n\n<p>You <em>can</em> use just a single allocation for all the vertices, but then you would want a <em>single</em> pointer (<code>vernode *matrix;</code>), and you would need to use different index calculations: <code>g-&gt;matrix[i * g-&gt;verNum + j].adj = 0;</code>.</p>\n"}], "owner": {"reputation": 343, "user_id": 10905279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c67005ead86ba8a7ad9d464e879fbb5e?s=128&d=identicon&r=PG&f=1", "display_name": "Liu", "link": "https://stackoverflow.com/users/10905279/liu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 55834714, "answer_count": 2, "score": 0, "last_activity_date": 1556123617, "creation_date": 1556121666, "question_id": 55834210, "link": "https://stackoverflow.com/questions/55834210/implementing-undirected-graph-with-adjacency-matrix", "title": "Implementing undirected graph with adjacency matrix", "body": "<p>I was trying to implement an undirected graph with adjacency matrix.<br/> The type of vertex value is integer. And I use double pointer to represent the adjacency matrix.<br/></p>\n\n<p>The question is right after I inputed all the value of vertices as how I <br/>programmed from the code I posted below, the run-time error <br/>occurred . I then added the comment at the line with the error content <br/>from which the error occurs. I know the cause must be the double pointer<br/> I malloced. But I really have no idea about how to debug it.<br/> Can someone help me out? Thank you!</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\ntypedef struct node\n{\n    int adj;\n}verNode;\ntypedef struct graph\n{\n    verNode **matrix;\n    int* verList;\n    int verNum;\n    int edgeNum;\n}graph;\ngraph* createGraph(int v)\n{\n    graph *g=malloc(sizeof(graph));\n    if(!g) exit(-1);\n    g-&gt;matrix=NULL;\n    g-&gt;verList=malloc(sizeof(verNode)*v);\n    if(!g-&gt;verList) exit(-1);\n    g-&gt;verNum=v;\n    printf(\"Enter the value of vertices:\\n\");\n    for(int i=0;i&lt;g-&gt;verNum;i++)\n    {\n        printf(\"Enter the value of vertex %d:\\n\",i);\n        scanf(\"%d\",g-&gt;verList);\n    }\n    return g;\n}\nverNode** createMatrix(graph *g)\n{\n    if(!g) exit(-1);\n    g-&gt;matrix=malloc(sizeof(int*)*g-&gt;verNum*g-&gt;verNum);\n    if(!g-&gt;matrix) exit(-1);\n    for(int i=0;i&lt;g-&gt;verNum;i++)\n    {\n        for(int j=0;j&lt;g-&gt;verNum;j++)\n        {\n            (*g-&gt;matrix)-&gt;adj=0; //error:EXC_BAD_ACCESS (code=1,           //address=0x0)\n        }\n    }\n    return g-&gt;matrix;\n}\nvoid addEdge(graph *g,int v)\n{\n    if(!g||!g-&gt;matrix||!g-&gt;verList) exit(-1);\n    int ver1,ver2;\n    g-&gt;edgeNum=v;\n    printf(\"Enter the indexes of the vertices:\\n\");\n    for(int i=0;i&lt;g-&gt;edgeNum;i++)\n    {\n        printf(\"Enter the index of vertex 1:\\n\");\n        scanf(\"%d\",&amp;ver1);\n        printf(\"Enter the index of vertex 2:\\n\");\n        scanf(\"%d\",&amp;ver2);\n        if(ver1&gt;g-&gt;verNum-1||ver2&gt;g-&gt;verNum-1) exit(-1);\n        g-&gt;matrix[ver1][ver2].adj=1;\n        g-&gt;matrix[ver2][ver1].adj=1;\n    }\n}\nvoid printMatrix(graph *g)\n{\n    if(!g||!g-&gt;matrix||!g-&gt;verList) exit(-1);\n    printf(\"Print the adjacency matrix:\");\n    for(int i=0;i&lt;g-&gt;verNum;i++)\n    {\n        for(int j=0;j&lt;g-&gt;verNum;j++)\n        {\n            printf(\"%d \",g-&gt;matrix[i][j].adj);\n        }\n        printf(\"\\n\");\n    }\n}\nint main() {\n    graph *g=createGraph(5);\n    verNode **matrix =createMatrix(g);\n    g-&gt;matrix=matrix;\n    addEdge(g,7);\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c"], "answers": [{"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 3, "last_activity_date": 1556121401, "creation_date": 1556121401, "answer_id": 55834147, "question_id": 55834068, "link": "https://stackoverflow.com/questions/55834068/how-do-i-continuously-generate-a-name-for-a-file-which-is-increasing-for-examp/55834147#55834147", "title": "How do I continuously generate a name for a file which is increasing ? For example: book1.txt, book2.txt etc", "body": "<p>You can use <code>sprintf</code> to build the filename:</p>\n\n<pre><code>sprintf(filename, \"book%03d.txt\", num);\n</code></pre>\n\n<p>This will create files named booknnn.txt, where <em>nnn</em> is the number in question padded with 0's, ex. book001.txt, book002.txt.</p>\n"}], "owner": {"reputation": 106, "user_id": 10581510, "user_type": "registered", "profile_image": "https://graph.facebook.com/1208266182538525/picture?type=large", "display_name": "Pakito Gama", "link": "https://stackoverflow.com/users/10581510/pakito-gama"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 24, "favorite_count": 0, "accepted_answer_id": 55834147, "answer_count": 1, "score": 0, "last_activity_date": 1556121401, "creation_date": 1556121125, "question_id": 55834068, "link": "https://stackoverflow.com/questions/55834068/how-do-i-continuously-generate-a-name-for-a-file-which-is-increasing-for-examp", "title": "How do I continuously generate a name for a file which is increasing ? For example: book1.txt, book2.txt etc", "body": "<p>So I am trying to write a begginers program in which it is necessary to create a series of files, depending on the users choosing option, and where the first file created should be name by for example \"book1.txt\" and second one \"book2.txt\" etc...</p>\n\n<pre><code>FILE *fnew;\nint num;  //i do have a lot of code before to get the 'num' value from where I want, don't bother it;\n\nchar filename[]= \"bookX.txt\";\nfilename[4]=num+1;\n\nfnew = fopen(filename,\"w\");\nfclose(fnew);\n</code></pre>\n"}, {"tags": ["c"], "answers": [{"comments": [{"owner": {"reputation": 19601, "user_id": 1620779, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/dlgGb.png?s=128&g=1", "display_name": "sjsam", "link": "https://stackoverflow.com/users/1620779/sjsam"}, "edited": false, "score": 0, "creation_date": 1556120253, "post_id": 55833800, "comment_id": 98332162, "body": "oops ! that was easy.. Sorry for the trouble folks and thanks for the time. Taking your second suggestion too."}], "tags": [], "owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "is_accepted": true, "score": 4, "last_activity_date": 1556120266, "last_edit_date": 1556120266, "creation_date": 1556120138, "answer_id": 55833800, "question_id": 55833758, "link": "https://stackoverflow.com/questions/55833758/how-to-access-a-typedefed-object-outside-its-translation-unit/55833800#55833800", "title": "How to access a typedefed object outside its translation unit", "body": "<p>Wrong syntax; should be</p>\n\n<pre><code> extern FPTR funcptr;\n</code></pre>\n\n<p>because an <code>extern</code> <a href=\"https://en.cppreference.com/w/c/language/declarations\" rel=\"nofollow noreferrer\">declaration</a> still needs to mention a type.</p>\n\n<p>And you'll better call it with <code>(*funcptr)()</code> which is at least more readable.</p>\n"}], "owner": {"reputation": 19601, "user_id": 1620779, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/dlgGb.png?s=128&g=1", "display_name": "sjsam", "link": "https://stackoverflow.com/users/1620779/sjsam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 26, "favorite_count": 0, "accepted_answer_id": 55833800, "answer_count": 1, "score": -1, "last_activity_date": 1556120266, "creation_date": 1556120017, "question_id": 55833758, "link": "https://stackoverflow.com/questions/55833758/how-to-access-a-typedefed-object-outside-its-translation-unit", "title": "How to access a typedefed object outside its translation unit", "body": "<p><strong>test.h</strong></p>\n\n<pre><code>#ifndef TEST_H_INCLUDED\n#define TEST_H_INCLUDED\n\nint func(void);\ntypedef int (*FPTR)(void);\n\n#endif // TEST_H_INCLUDED\n</code></pre>\n\n<p><strong>func.c</strong></p>\n\n<pre><code>#include \"test.h\"\n\nstatic int x = 22; // persistent with external linkage.\n\nint func(void)\n{\n  extern int x; // Referencing declaration\n  static int count = 0; // persistent within block\n  printf(\"%d : %d\\n\",++count,++x);\nreturn 1;\n}\n\nFPTR funcptr = func; // persistent with external linkage. ??\n</code></pre>\n\n<p><strong>main.c</strong></p>\n\n<pre><code>#include \"test.h\"\n\n#include &lt;stdio.h&gt;\n\nextern funcptr; // referencing declaration ??\n\nint main(void)\n{\nfunc();\nfuncptr(); // Compile Time Error Here\nreturn 0;\n}\n</code></pre>\n\n<p>This fails with error <code>called object \u2018funcptr\u2019 is not a function or function pointer</code>.</p>\n\n<p>Am I breaking any cardinal rules here ?</p>\n"}, {"tags": ["c", "java-native-interface", "reverse-engineering"], "comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1556121279, "post_id": 55833701, "comment_id": 98332761, "body": "Terminology: C does not have <i>methods</i>, it has <i>functions</i>."}], "answers": [{"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 1, "last_activity_date": 1556122022, "creation_date": 1556122022, "answer_id": 55834325, "question_id": 55833701, "link": "https://stackoverflow.com/questions/55833701/how-to-track-jni-method-from-java-to-c/55834325#55834325", "title": "How to track JNI method from Java to C?", "body": "<p>The name of the native function that a corresponds to particular Java native method is deterministically related to the Java method name, the fully-qualified name of the class in which it resides, and its argument types if it is overloaded.  The specifics are described in <a href=\"https://docs.oracle.com/javase/7/docs/technotes/guides/jni/spec/design.html\" rel=\"nofollow noreferrer\">chapter 2 of the JNI specification</a>, but rather than sorting through that, it might be easier to just use <code>javac -h</code> (JDK 8 or later) or the <a href=\"https://docs.oracle.com/javase/9/tools/javah.htm\" rel=\"nofollow noreferrer\"><code>javah</code></a> tool (deprecated since JDK 8, but still present at least in JDK 9) to generate it for you, in the form of a C or C++ header file.</p>\n"}, {"tags": [], "owner": {"reputation": 52300, "user_id": 192373, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/83a45711c4c32eeeb3826d279e50f8ab?s=128&d=identicon&r=PG", "display_name": "Alex Cohn", "link": "https://stackoverflow.com/users/192373/alex-cohn"}, "is_accepted": false, "score": 1, "last_activity_date": 1556132410, "creation_date": 1556132410, "answer_id": 55836885, "question_id": 55833701, "link": "https://stackoverflow.com/questions/55833701/how-to-track-jni-method-from-java-to-c/55836885#55836885", "title": "How to track JNI method from Java to C?", "body": "<p>Look for the list of exported functions of your DLL or so file. If it doesn't have a number of functions with <code>Java_com\u2026</code> prefix, but has <code>JNI_OnLoad</code> instead, your native library then uses <a href=\"https://docs.oracle.com/javase/7/docs/technotes/guides/jni/spec/functions.html#wp5833\" rel=\"nofollow noreferrer\">RegisterNatives()</a>, and you must find the relevant table of <code>JNINativeMethod</code> structures that maps of the native methods to C functions.</p>\n"}], "owner": {"reputation": 619, "user_id": 9542076, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Carol Ward", "link": "https://stackoverflow.com/users/9542076/carol-ward"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 133, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1556132410, "creation_date": 1556119787, "question_id": 55833701, "link": "https://stackoverflow.com/questions/55833701/how-to-track-jni-method-from-java-to-c", "title": "How to track JNI method from Java to C?", "body": "<p>So I'm trying to reverse engineer an application.</p>\n\n<p>I'm tracking a JNI method called Test_Method that calls a C method from the shared object,</p>\n\n<p>In the shared object, I can see that the method name Test_Method exists, but it doesn't have any cross-reference.</p>\n\n<p>How do I find the method from the shared object that the JNI method from Java is calling to?</p>\n"}, {"tags": ["c", "winapi", "64-bit", "driver", "ioctl"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 2490578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44953a58ccf3747e61f8511c137ed02e?s=128&d=identicon&r=PG", "display_name": "Thomas Andersen", "link": "https://stackoverflow.com/users/2490578/thomas-andersen"}, "edited": false, "score": 0, "creation_date": 1556126176, "post_id": 55833899, "comment_id": 98335158, "body": "Thank you for an answer and for solution. I need to use long long type variable to store address on a application side?"}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1556186635, "post_id": 55833899, "comment_id": 98355469, "body": "<code>PEPROCESS</code> is a pointer type (a pointer to an <code>EPROCESS</code> structure). To print a pointer type, use the <code>p</code> <a href=\"https://docs.microsoft.com/en-us/cpp/c-runtime-library/format-specification-syntax-printf-and-wprintf-functions\" rel=\"nofollow noreferrer\">format specifier</a>. <code>long long</code> (as well as <code>%llx</code>) is wrong for 2 reasons: <code>long long</code> is signed (a pointer isn&#39;t), and it has the wrong size on a 32-bit build."}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "reply_to_user": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1556200054, "post_id": 55833899, "comment_id": 98363484, "body": "@IInspectable - I should have had my coffee before answering yesterday!  Thank you for pointing out my error.  It has been corrected."}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "reply_to_user": {"reputation": 3, "user_id": 2490578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44953a58ccf3747e61f8511c137ed02e?s=128&d=identicon&r=PG", "display_name": "Thomas Andersen", "link": "https://stackoverflow.com/users/2490578/thomas-andersen"}, "edited": false, "score": 0, "creation_date": 1556200625, "post_id": 55833899, "comment_id": 98363883, "body": "@ThomasAndersen - Please note the correction to this answer.  <code>%llx</code> is <i>not</i> the right way to print an address pointer variable.  Sorry for that mistake."}], "tags": [], "owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "is_accepted": true, "score": 0, "last_activity_date": 1556199941, "last_edit_date": 1556199941, "creation_date": 1556120540, "answer_id": 55833899, "question_id": 55833628, "link": "https://stackoverflow.com/questions/55833628/zwqueryinformationprocess-strange-behavior-when-processbasicinformation-requeqst/55833899#55833899", "title": "ZwQueryInformationProcess strange behavior when ProcessBasicInformation requeqsted", "body": "<p><strong><em>Corrected:</em></strong><br>\nTo address the <em>I get only lower part of PEB address</em> part of your question,<br>\nbecause <code>pProcess</code> is a pointer, use the pointer format specifier: <code>%p</code>.</p>\n\n<pre><code>ntStatus = PsLookupProcessByProcessId(PID, &amp;pProcess);\n// your error handling code\nprintf(\"PsLookupProcessByProcessId: 0x%p\\n\", pProcess);\n</code></pre>\n\n<p>The <code>\"%p\"</code> <em><a href=\"https://stackoverflow.com/a/2369593/645128\">pointer format specifier</a></em> displays the argument as a hexadecimal address.</p>\n"}], "owner": {"reputation": 3, "user_id": 2490578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44953a58ccf3747e61f8511c137ed02e?s=128&d=identicon&r=PG", "display_name": "Thomas Andersen", "link": "https://stackoverflow.com/users/2490578/thomas-andersen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 265, "favorite_count": 0, "accepted_answer_id": 55833899, "answer_count": 1, "score": 0, "last_activity_date": 1556199941, "creation_date": 1556119553, "question_id": 55833628, "link": "https://stackoverflow.com/questions/55833628/zwqueryinformationprocess-strange-behavior-when-processbasicinformation-requeqst", "title": "ZwQueryInformationProcess strange behavior when ProcessBasicInformation requeqsted", "body": "<p>I have this peace of code as part of driver. This driver is for Windows 7 x64, so it executes on the same system.</p>\n\n<pre><code>PVOID GetProcessInformation(ULONG PID)\n{\n    NTSTATUS ntStatus = STATUS_UNSUCCESSFUL;\n\n    HANDLE hProcess;\n    PEPROCESS pProcess = NULL;\n\n    PVOID pProcInfo = NULL;\n\n    ULONG ulRet = 0;\n\n    if ((pProcInfo = ExAllocatePoolWithTag(NonPagedPool, sizeof(PROCESS_BASIC_INFORMATION), 'QPI')) == NULL)\n    {\n        DbgPrint(\"ExAllocatePoolWithTag failed\");\n        return NULL;\n    }\n    ntStatus = PsLookupProcessByProcessId(PID, &amp;pProcess);\n    if (!NT_SUCCESS(ntStatus))\n    {\n        DbgPrint(\"PsLookupProcessByProcessId Returned: 0x%08x\\n\", ntStatus);\n        ExFreePool(pProcInfo);\n        return NULL;\n    }\n    ntStatus = ObOpenObjectByPointer(pProcess, 0, NULL, 0, 0, KernelMode, &amp;hProcess);\n    if (!NT_SUCCESS(ntStatus))\n    {\n        DbgPrint(\"ObOpenObjectByPointer sReturned: 0x%08x\\n\", ntStatus);\n        ExFreePool(pProcInfo);\n        return NULL;\n    }\n\n    ObDereferenceObject(pProcess);\n    ntStatus = ZwQueryInformationProcess(hProcess, ProcessBasicInformation, pProcInfo, sizeof(PROCESS_BASIC_INFORMATION), &amp;ulRet);\n    if (!NT_SUCCESS(ntStatus))\n    {\n        DbgPrint(\"ZwQueryInformationProcess Returned: 0x%08x\\n\", ntStatus);\n        ExFreePool(pProcInfo);\n        return NULL;\n    }\n    if (ulRet != sizeof(PROCESS_BASIC_INFORMATION))\n        DbgPrint(\"Warning : ZwQueryInformationProcess Returned Length is different than ProcessInformationLength\");\n\n    return pProcInfo;\n}\n</code></pre>\n\n<p>PROCESS_BASIC_INFORMATION defined in ntddk. PID value is correct. But result of ZwQueryInformationProcess is odd. I get only lower part of PEB address (PPEB part in PROCESS_BASIC_INFORMATION structure). For example, another tool says PPEB is equal to 0x000007FFFFFDC000. My drivers knows only  0xFFFDC000.\nAlso i try PsGetprocessPeb(...) function, with the same result. ZwQueryInformationProcess function is successed.</p>\n"}, {"tags": ["c", "ipc", "message-queue", "shared-memory"], "answers": [{"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": true, "score": 1, "last_activity_date": 1556120813, "creation_date": 1556120813, "answer_id": 55833978, "question_id": 55833470, "link": "https://stackoverflow.com/questions/55833470/accessing-key-t-generated-by-ipc-private/55833978#55833978", "title": "Accessing key_t generated by IPC_PRIVATE", "body": "<blockquote>\n  <p>I know IPC_PRIVATE will generate a unique key when calling shmget() to create it</p>\n</blockquote>\n\n<p>No, you misunderstand.  <code>IPC_PRIVATE</code> does not <em>generate</em> a <code>key_t</code>, it <em>is</em> a <code>key_t</code>.  This special <code>key_t</code> elicits the special behavior from <code>shmget()</code> of always creating a new segment, ignoring all bits of the flags except the mode bits.</p>\n\n<blockquote>\n  <p>if I then need that key to open that region somewhere in other processes, how can I access that generated key_t value so that I can send it to the other process?</p>\n</blockquote>\n\n<p>Since you always get a new segment with <code>IPC_PRIVATE</code>, you cannot share memory between processes by each one independently obtaining a shared-memory segment via that key.  Instead, for two or more processes to communicate via such a segment, they must all have inherited it from a common ancestor process that created it (or <em>be</em> the process that created it).  Processes that do not have such a relationship with each other cannot use the <code>IPC_PRIVATE</code> key to access the same segment.</p>\n\n<blockquote>\n  <p>Do I have no other options but try luck with ftok() and some random files? Do I have to choose a different file for each block of different shared memory I wish to create?</p>\n</blockquote>\n\n<p>Since you're using System-V shared memory, you do have the alternative of using <code>ftok()</code> to generate keys based on an existing path, but it doesn't have to be an <em>arbitrary</em> file.  You can use the path to a file that is characteristic of the particular group of cooperating processes -- an input file, a working directory, or similar.  Moreover, <code>ftok()</code> also uses an integer \"project id\" with which you can discriminate between unrelated runs, or between multiple distinct keys serving different purpose, or similar.  You could choose some designated process's process id there if you have no other good way to discriminate.</p>\n\n<p>Do note, by the way, that the System-V IPC interfaces are pretty clunky.  They do have a couple of distinguishing features that may occasionally make them preferable, but the newer POSIX interfaces (<code>shm_open()</code>, etc.) are usually the better choice.  The POSIX versions don't offer a particularly better solution to the problem you've asked about, however.</p>\n"}], "owner": {"reputation": 3, "user_id": 10761048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cda8f44f6c0f0fe98a15ccf7ac5158de?s=128&d=identicon&r=PG&f=1", "display_name": "Antonio O.", "link": "https://stackoverflow.com/users/10761048/antonio-o"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 534, "favorite_count": 0, "accepted_answer_id": 55833978, "answer_count": 1, "score": 0, "last_activity_date": 1556120813, "creation_date": 1556119094, "question_id": 55833470, "link": "https://stackoverflow.com/questions/55833470/accessing-key-t-generated-by-ipc-private", "title": "Accessing key_t generated by IPC_PRIVATE", "body": "<p>I'm trying to synchronize and make a few threads/processes communicate for a project and I'd ideally like to access some shared memory blocks between them, without having them clash with other processes/resources.</p>\n\n<p>I know IPC_PRIVATE will generate a unique key when calling shmget() to create it, but if I then need that key to open that region somewhere in other processes, how can I access that generated key_t value so that I can send it to the other process?</p>\n\n<p>I'm currenty sending data through IPC message-queues, and so I can send the shmid value, but as far as I know that doesn't work since the shmid value is unique for each process.</p>\n\n<p>Do I have no other options but try luck with ftok() and some random files?\nDo I have to choose a different file for each block of different shared memory I wish to create?</p>\n\n<p>Thank you for your time.</p>\n"}, {"tags": ["c", "makefile"], "comments": [{"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1556118576, "post_id": 55833266, "comment_id": 98331144, "body": "You should <b>read the <a href=\"https://www.gnu.org/software/make/manual/html_node/index.html\" rel=\"nofollow noreferrer\">documentation of GNU make</a></b>, since you need to add your own rules, and be aware of builtin rules (run <code>make -p</code>). You could consider using <a href=\"http://bashdb.sourceforge.net/remake/\" rel=\"nofollow noreferrer\">remake</a> to debug your <code>Makefile</code>"}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1556118657, "post_id": 55833266, "comment_id": 98331192, "body": "Without some <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> your question is off-topic here."}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1556118701, "post_id": 55833266, "comment_id": 98331216, "body": "BTW, for a large project, I would consider migrating to <a href=\"http://ninja-build.org/\" rel=\"nofollow noreferrer\">ninja</a> instead of the old GNU <code>make</code> (since <code>ninja</code> is <i>designed</i> for huge project builds)"}, {"owner": {"reputation": 7205, "user_id": 9288200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f1c4dc5d3f7433e18f4aa04319ebaec?s=128&d=identicon&r=PG&f=1", "display_name": "Ondrej K.", "link": "https://stackoverflow.com/users/9288200/ondrej-k"}, "edited": false, "score": 2, "creation_date": 1556119171, "post_id": 55833266, "comment_id": 98331522, "body": "Well. the <code>control.po</code> either needs to be there. Or make needs to know how to build / generate it. By either having an explicit rule, or pattern rule telling it how to. However, the question does not seem to make that immediately clear what the mechanics of generating the file should be."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11406022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ed4c94ac96185b1af3388189af0f60a?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Riddle", "link": "https://stackoverflow.com/users/11406022/mike-riddle"}, "edited": false, "score": 0, "creation_date": 1556120265, "post_id": 55833434, "comment_id": 98332177, "body": "As posted .. bad assumption, I failed to add a vpath"}], "tags": [], "owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "is_accepted": true, "score": 0, "last_activity_date": 1556119884, "last_edit_date": 1556119884, "creation_date": 1556118966, "answer_id": 55833434, "question_id": 55833266, "link": "https://stackoverflow.com/questions/55833266/how-to-tell-gnu-make-to-treat-po-files-like-h-files/55833434#55833434", "title": "How to tell GNU MAKE to treat .po files like .h files?", "body": "<blockquote>\n  <p>I am ASSUMING there is some implied rule about .po files.</p>\n</blockquote>\n\n<p>Wrong assumption. The builtin rules are obtained with <code>make -p</code> and they don't mention <code>.po</code></p>\n\n<hr>\n\n<p>As I told in comments:</p>\n\n<ul>\n<li><p>when building a large project, <a href=\"https://ninja-build.org/\" rel=\"nofollow noreferrer\">ninja</a> is more suitable (it runs by default in parallel, like <code>make -j</code> and it runs faster). If you are migrating from a proprietary build system, it probably would be better. You'll need to write or find your <code>build.ninja</code> generator (e.g. with your Python script generating it, with <a href=\"https://mesonbuild.com/\" rel=\"nofollow noreferrer\">meson</a>, etc...).</p></li>\n<li><p>If you stay with GNU <code>make</code>, you should add your own recipes and rules for your <code>.po</code> suffix (assuming that your <code>foo.po</code> is generated from some <code>foo.src</code>). So <strong>read the <a href=\"https://www.gnu.org/software/make/manual/html_node/index.html\" rel=\"nofollow noreferrer\">documentation of GNU <code>make</code></a></strong> and you may want some <a href=\"https://www.gnu.org/software/make/manual/html_node/Rules.html#Rules\" rel=\"nofollow noreferrer\">rule</a> like</p>\n\n<pre><code>%.po: %.src\n   # how to build a .po from some .src fle\n</code></pre></li>\n<li><p>You could find useful to use <a href=\"http://bashdb.sourceforge.net/remake/\" rel=\"nofollow noreferrer\">remake</a> with <code>-x</code> for debugging your <code>Makefile</code></p></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 11406022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ed4c94ac96185b1af3388189af0f60a?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Riddle", "link": "https://stackoverflow.com/users/11406022/mike-riddle"}, "is_accepted": false, "score": -1, "last_activity_date": 1556120206, "creation_date": 1556120206, "answer_id": 55833812, "question_id": 55833266, "link": "https://stackoverflow.com/questions/55833266/how-to-tell-gnu-make-to-treat-po-files-like-h-files/55833812#55833812", "title": "How to tell GNU MAKE to treat .po files like .h files?", "body": "<p>the generated include files are in a different directory and I failed to add an vpath entry for .po files..</p>\n\n<p>VPATH_INCLUDE_LIST  = ../include:../../include:../../../include:../../../../include</p>\n\n<p>vpath %h $(VPATH_INCLUDE_LIST)\nvpath %.do $(VPATH_INCLUDE_LIST)\nvpath %.fo $(VPATH_INCLUDE_LIST)\nvpath %.to $(VPATH_INCLUDE_LIST)\nvpath %.ro $(VPATH_INCLUDE_LIST)\nvpath %.go $(VPATH_INCLUDE_LIST)\nvpath %.po $(VPATH_INCLUDE_LIST)</p>\n"}], "owner": {"reputation": 1, "user_id": 11406022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ed4c94ac96185b1af3388189af0f60a?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Riddle", "link": "https://stackoverflow.com/users/11406022/mike-riddle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 55833434, "answer_count": 2, "score": 0, "last_activity_date": 1556120206, "creation_date": 1556118444, "last_edit_date": 1556118886, "question_id": 55833266, "link": "https://stackoverflow.com/questions/55833266/how-to-tell-gnu-make-to-treat-po-files-like-h-files", "title": "How to tell GNU MAKE to treat .po files like .h files?", "body": "<p>I have a .c file that is dependent on a generated include file named control.po but when it is included in the dependencies, make thinks it needs to build it.</p>\n\n<p><code>make[1]: *** No rule to make target `control.po', needed by `proccmd.o'.  Stop.</code></p>\n\n<pre><code>proccmd.o:  ddemsgid.do ddelen.do control.po tprecs.ro tlktp.h comtrac.h basmsg.fo \\\n        tiop.h\n</code></pre>\n\n<p>If I copy control.po to control.fo and change the dependency control.po, it compiles.</p>\n\n<p>I have tried changing .SUFFIXES\nthis way</p>\n\n<pre><code>.SUFFIXES:\n.SUFFIXES: .c .o .h .po\n</code></pre>\n\n<p>and this</p>\n\n<pre><code>.SUFFIXES:\n.SUFFIXES: .c .o .h\n</code></pre>\n\n<p>with the same result.</p>\n\n<p>I am ASSUMING there is some implied rule about .po files.</p>\n\n<p>I am converting a large project from a proprietary build to gnu make, so I cannot easily change the file extensions of the generated files.</p>\n"}, {"tags": ["c", "unit-testing", "testing", "cmocka"], "comments": [{"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1556119317, "post_id": 55832949, "comment_id": 98331610, "body": "It appears, at least to me that there are too many unknowns to answer.  I did find <i><a href=\"https://stackoverflow.com/a/42156202/645128\">this converstion/answer</a></i> that may help with part of what you are doing."}], "answers": [{"tags": [], "owner": {"reputation": 57, "user_id": 8040888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc16379f21d8bc2c6963b7a33386391f?s=128&d=identicon&r=PG&f=1", "display_name": "Joshua", "link": "https://stackoverflow.com/users/8040888/joshua"}, "is_accepted": false, "score": 0, "last_activity_date": 1556183053, "creation_date": 1556183053, "answer_id": 55845581, "question_id": 55832949, "link": "https://stackoverflow.com/questions/55832949/how-could-i-mock-void-type-function/55845581#55845581", "title": "How could I mock void type function?", "body": "<p>I've came up with this solution.</p>\n\n<pre><code>static void test_dpl_insert_empty_list(void **state)                                                                                                                                                       \n {                                                                                                                                                                                                          \n     (void) state; /* unused */                                                                                                                                                                             \n     t_list **ret;                                                                                                                                                                                          \n     t_list *beg;                                                                                                                                                                                           \n     int count, data;                                                                                                                                                                                       \n\n     count = 0;                                                                                                                                                                                             \n\n     will_return(__wrap_dpl_create, malloc(sizeof(t_list)));                                                                                                                                                \n     ret = dpl_create();                                                                                                                                                                                    \n     dpl_insert(ret, (void*)1);                                                                                                                                                                             \n     dpl_insert(ret, (void*)2);                                                                                                                                                                             \n     dpl_insert(ret, (void*)3);                                                                                                                                                                             \n\n     beg = *ret;                                                                                                                                                                                            \n     while(beg != NULL)                                                                                                                                                                                     \n     {                                                                                                                                                                                                      \n         data = (intptr_t)beg-&gt;data;                                                                                                                                                                        \n         assert_int_equal(++count, data);                                                                                                                                                                   \n         beg = beg-&gt;next;                                                                                                                                                                                   \n     }                                                                                                                                                                                                      \n } \n</code></pre>\n\n<p>Instead of using the <code>__wrap_dpl_insert()</code> I used the original function <code>dpl_insert()</code>. I'm wondering if this is the best approach to do it.</p>\n"}], "owner": {"reputation": 57, "user_id": 8040888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc16379f21d8bc2c6963b7a33386391f?s=128&d=identicon&r=PG&f=1", "display_name": "Joshua", "link": "https://stackoverflow.com/users/8040888/joshua"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 119, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1556183053, "creation_date": 1556117482, "question_id": 55832949, "link": "https://stackoverflow.com/questions/55832949/how-could-i-mock-void-type-function", "title": "How could I mock void type function?", "body": "<p>I have a void insert function and I want to test if it inserts correctly. I'm using CMocka framework for testing.</p>\n\n<p>I've tried to do <code>dpl_insert(ret, \"mock_value\")</code> instead of the <code>will_return()</code> but it seems that no value is appended to the list.</p>\n\n<pre><code>t_list **dpl_create();\nint ft_list_size(t_list *self);\n\nvoid __wrap_dpl_insert(t_list **self, void *data)\n{\n   check_expected(self);\n   check_expected(data);\n}\n\nstatic void test_dpl_insert_empty_list(void **state)\n{\n    (void) state;\n    t_list **ret = dpl_create(); //Initialization of an empty struct.\n    int ret_size;\n\n    expect_value(__wrap_dpl_insert, self, ret);\n    expect_value(__wrap_dpl_insert, data, \"mock_value\");\n\n    will_return(__wrap_dpl_insert, XXX); //PROBLEM RESIDES HERE.\n\n    ret_size = ft_list_size(*ret);\n    fprintf(stderr, \"Size of the list=&gt;%d\\n\", ret_size);\n}\n</code></pre>\n\n<p>With <code>dpl_insert(ret, \"mock_value\")</code> the <code>fprintf()</code> prints 0, like if no element was added.</p>\n\n<p>My objective is to obtain 1 from <code>fprintf()</code>.</p>\n"}, {"tags": ["c", "linux", "operating-system", "execv", "environ"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1556117467, "post_id": 55832791, "comment_id": 98330516, "body": "Since <code>strtok()</code> chops up a string, you should not use it on the value returned by <code>getenv()</code> \u2014 you are chopping up the environment variable PATH that the child process will receive.  Make a copy and chop the copy.  Note that <code>PATH=:&#47;bin::&#47;usr&#47;bin</code> has the current directory <code>.</code> implicitly specified 3 times \u2014 before the first colon, between the adjacent colons, and after the last colon.  You should check that the memory allocations are successful."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1556117509, "post_id": 55832791, "comment_id": 98330549, "body": "See <a href=\"https://stackoverflow.com/questions/1694036/why-is-the-gets-function-dangerous-why-should-it-not-be-used\">Why <code>gets()</code> is so dangerous it should never be used</a>."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1556117667, "post_id": 55832791, "comment_id": 98330649, "body": "You only use a path-based search for the command if there is no <code>&#47;</code> anywhere in it.  It doesn&#39;t have to start with <code>.&#47;</code> or <code>..&#47;</code> to be a relative path (though if it does, it <i>is</i> a relative path).  For example, <code>subdir&#47;program</code> is a relative path and the command should not be searched for using <code>$PATH</code>."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1556117799, "post_id": 55832791, "comment_id": 98330722, "body": "If you use <code>execv()</code>, the environment is automatically inherited.  You can demonstrate that by running <code>env</code> (type it as the command name).  It will print out the environment it receives.  Or you can run a program of your own devising to print the environment \u2014 it&#39;s not hard, and there are several ways to do it."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1556118066, "post_id": 55832791, "comment_id": 98330856, "body": "The sequence <code>commandPath = libs[i];                     strcat(commandPath, &quot;&#47;&quot;);                     strcat(commandPath, params[0]);</code> is not going to work well.  You have not allocated space for the command name, and you mangle the elements of <code>libs</code>.  You need to allocate separate space for the command path.  You are leaking memory; you don&#39;t free the parameters from the previous command when you go back for the next command."}, {"owner": {"reputation": 1, "user_id": 7416298, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f88a284f4c9fdf103a1c1ffdc5b1a4c8?s=128&d=identicon&r=PG&f=1", "display_name": "itzik ben shitrit", "link": "https://stackoverflow.com/users/7416298/itzik-ben-shitrit"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1556118642, "post_id": 55832791, "comment_id": 98331181, "body": "thank you for the answer. I&#39;ll change the mistakes. What about the environ variable how should I use it. do I need to allocate memory for those strings. what data should be in the environment (program name/filename/arguments) ? I Mean what should I expect to see when i execute <code>env</code>"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1556125775, "post_id": 55832791, "comment_id": 98335007, "body": "Unless you&#39;ve got to add to the environment, you won&#39;t need to mess with <code>environ</code>. If you do need to add to the environment, use <code>setenv()</code> \u2014 not <code>putenv()</code> unless you&#39;re desparate \u2014 and still don&#39;t need <code>environ</code>. When you run <code>env</code> at the command line with no arguments, it prints out the environment it was given by your shell. Similarly inside your shell-like program \u2014 if you type <code>env</code> and that runs <code>env</code>, then you should see the environment that your program is giving its children. Further, usually if you run <code>env</code> several times , you should see the same output \u2014 else you have bugs."}], "owner": {"reputation": 1, "user_id": 7416298, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f88a284f4c9fdf103a1c1ffdc5b1a4c8?s=128&d=identicon&r=PG&f=1", "display_name": "itzik ben shitrit", "link": "https://stackoverflow.com/users/7416298/itzik-ben-shitrit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 80, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1556116954, "creation_date": 1556116954, "question_id": 55832791, "link": "https://stackoverflow.com/questions/55832791/check-if-environment-has-passed-to-execv", "title": "Check if environment has passed to execv", "body": "<p>I try to do some homework exercise about creating a process with execv in linux.\nI need to take an input string from the user, and check if there is a program with same name on the machine.\nI need to try to execute the given program string with the PATH variable directories\nI have to use the execv function ONLY to execute the program.\nThe input seperated by space when the first word is the file of the program and the other words are the arguments.\nAnd they also ask me to validate that the environment has passed to the execv.\nHow do i check that?\nI found out that I need to use the <code>environ</code> variable and fill it</p>\n\n<p>I Have tried this so far:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\n#define MYCOMMAND_LEN   1000\n#define MYNUM_OF_PARAMS 500\n\nextern char **environ;\n\nint main()\n{\n    int i = 0, j, pid, stat, amountOfLib;\n    char command[MYCOMMAND_LEN];\n    char *params[MYNUM_OF_PARAMS];\n    char *path, *lastStr;\n    char *libs[100];\n    int numberOflib = 0, numOfParams;\n    char *commandPath;\n\n    //cut path\n    path = getenv(\"PATH\");\n    lastStr = strtok(path, \":\");\n    libs[0] = (char*)malloc(sizeof(char)*strlen(lastStr) + 1);\n    strcpy(libs[0], lastStr);\n    i = 1;\n    while (lastStr = strtok(NULL, \":\")) {\n        libs[i] = (char*)malloc(sizeof(char)*strlen(lastStr) + 1);\n        strcpy(libs[i], lastStr);\n        i++;\n        numberOflib = i;\n    }\n    numberOflib = i;\n\n\n    puts(\"Please Enter Command: \");\n    gets(commandPath);\n\n    //loop until leave {\n    while (strcmp(command, \"leave\") != 0) {\n\n        //cut command\n        lastStr = strtok(command, \" \");\n        params[0] = (char*)malloc(sizeof(char)*(strlen(lastStr) + 1));\n        strcpy(params[0], lastStr);\n        i = 1;\n        while ((lastStr = strtok(NULL, \" \")) != NULL)\n        {\n            params[i] = (char*)malloc(sizeof(char)*(strlen(lastStr) + 1));\n            strcpy(params[i], lastStr);\n            i++;\n        }\n        params[i] = NULL;\n        numOfParams = i;\n\n        //check if first is relative\n        if ((pid = fork()) == 0) {\n            if (params[0][0] == '/' ||\n                (strlen(params[0]) &gt;= 2 &amp;&amp;\n                    params[0][0] == '.' &amp;&amp;\n                    params[0][1] == '/'\n                    ) ||\n                    (strlen(params[0]) &gt;= 3 &amp;&amp;\n                        params[0][0] == '.' &amp;&amp;\n                        params[0][1] == '.' &amp;&amp;\n                        params[0][2] == '/'\n                        )\n                ) execv(params[0], params);\n            // if command like \"man ls\"\n            else {\n                for (i = 0; i &lt; amountOfLib; i++) {\n                    commandPath = libs[i];\n                    strcat(commandPath, \"/\");\n                    strcat(commandPath, params[0]);\n\n                    for (j = 0; j &lt; numOfParams; j++) {\n                         environ[j] = params[j]; //last environ also get the null\n                    }\n\n                    execv(commandPath, NULL);\n                }\n                puts(\"command not found in PATH\");\n                exit(1);\n            }\n        } else {\n            wait(&amp;stat);\n        }\n        puts(\"Please Enter Command: \");\n        gets(commandPath);\n    }\n    //}\n\n}\n</code></pre>\n\n<p>some inputs like 'ls' reply that the argv vector is empty.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 947, "user_id": 1873862, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aYZa7.jpg?s=128&g=1", "display_name": "petrch", "link": "https://stackoverflow.com/users/1873862/petrch"}, "edited": false, "score": 0, "creation_date": 1556114916, "post_id": 55832010, "comment_id": 98328713, "body": "char str[100] is a pointer. You do not want to dereference it. You can (I don&#39;t say you should) switch between the array / pointer syntax on the same variable."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 947, "user_id": 1873862, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aYZa7.jpg?s=128&g=1", "display_name": "petrch", "link": "https://stackoverflow.com/users/1873862/petrch"}, "edited": false, "score": 5, "creation_date": 1556115004, "post_id": 55832010, "comment_id": 98328774, "body": "@petrch An array and a pointer are <b>not</b> the same.  One can decay to the other, but they are distinct."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 11371483, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-9Fo0c_lEnAg/AAAAAAAAAAI/AAAAAAAABug/zfSq6sBQO0E/photo.jpg?sz=128", "display_name": "ashish_anand_93", "link": "https://stackoverflow.com/users/11371483/ashish-anand-93"}, "edited": false, "score": 0, "creation_date": 1556115121, "post_id": 55832064, "comment_id": 98328865, "body": "and in case of  &quot;*p&quot; it is taking value..!!  in case of string it is expecting char * and in case of &quot;p&quot; it is expecting &quot;int&quot; why not address.."}, {"owner": {"reputation": 11, "user_id": 11371483, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-9Fo0c_lEnAg/AAAAAAAAAAI/AAAAAAAABug/zfSq6sBQO0E/photo.jpg?sz=128", "display_name": "ashish_anand_93", "link": "https://stackoverflow.com/users/11371483/ashish-anand-93"}, "edited": false, "score": 0, "creation_date": 1556115641, "post_id": 55832064, "comment_id": 98329256, "body": "so basically in &quot;scanf&quot; we always take input as &quot;addressof&quot; and in case of &quot;printf&quot; it will depend upon the &quot;type of specifier&quot;(%d or %s and so on)"}, {"owner": {"reputation": 947, "user_id": 1873862, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aYZa7.jpg?s=128&g=1", "display_name": "petrch", "link": "https://stackoverflow.com/users/1873862/petrch"}, "edited": false, "score": 0, "creation_date": 1556116720, "post_id": 55832064, "comment_id": 98330005, "body": "@dbush well you wrote in the comment that char str[100] is not a pointer, but it &quot;decays&quot; to it. I guess you maybe referring to some abstract definition, but from the practical standpoint if you do printf(&quot;%c:%c&quot;,str[0],*(str+0)) you will get exactly the same result including the interpretation in the assembler. Also char * can point anywhere, you can point to an array of integers or any place in the memory and interpret the location as a string if you want to."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 947, "user_id": 1873862, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aYZa7.jpg?s=128&g=1", "display_name": "petrch", "link": "https://stackoverflow.com/users/1873862/petrch"}, "edited": false, "score": 0, "creation_date": 1556116907, "post_id": 55832064, "comment_id": 98330138, "body": "@petrch Section 6.3.2.1 of the <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf\" rel=\"nofollow noreferrer\">C standard</a>:  <i>&quot;Except  when  it  is  the  operand  of  the sizeof operator, the _Alignof operator, or t he unary &amp; operator, or is a string  literal  used  to  initialize  an  array, an expression  that  has type \u2018\u2018array of type \u2019\u2019 is converted to an expression with type \u2018\u2018pointer to type \u2019\u2019  that  points to  the  initial  element  of  the  array  object  and  is  not  an  lvalue.&quot;</i>"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 947, "user_id": 1873862, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aYZa7.jpg?s=128&g=1", "display_name": "petrch", "link": "https://stackoverflow.com/users/1873862/petrch"}, "edited": false, "score": 0, "creation_date": 1556117008, "post_id": 55832064, "comment_id": 98330209, "body": "@petrch You <i>could</i> point a <code>char *</code> to some other object and treat it as a string, but you can&#39;t expect the result to be consistent."}, {"owner": {"reputation": 947, "user_id": 1873862, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aYZa7.jpg?s=128&g=1", "display_name": "petrch", "link": "https://stackoverflow.com/users/1873862/petrch"}, "edited": false, "score": 0, "creation_date": 1556117428, "post_id": 55832064, "comment_id": 98330483, "body": "Consistent among what? E.g. among platforms and/or compilers or where? Can you give an example?"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 947, "user_id": 1873862, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aYZa7.jpg?s=128&g=1", "display_name": "petrch", "link": "https://stackoverflow.com/users/1873862/petrch"}, "edited": false, "score": 0, "creation_date": 1556117915, "post_id": 55832064, "comment_id": 98330772, "body": "@petrch If you point a <code>char *</code> to an <code>int</code> in an attempt to print it as a string, you&#39;ll get different output depending on the byte ordering (big/little endian) or character encoding (ASCII, EBCDIC), and undefined behavior if the representation doesn&#39;t contain a byte with 0."}, {"owner": {"reputation": 947, "user_id": 1873862, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aYZa7.jpg?s=128&g=1", "display_name": "petrch", "link": "https://stackoverflow.com/users/1873862/petrch"}, "edited": false, "score": 0, "creation_date": 1556119021, "post_id": 55832064, "comment_id": 98331423, "body": "Yes, that&#39;s a common sense. Like you need to understand what is going on on the memory/assembly level before you jump into this, but assuming you know what you are doing, I think it is reasonably predictable."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 8, "last_activity_date": 1556115350, "last_edit_date": 1556115350, "creation_date": 1556114825, "answer_id": 55832064, "question_id": 55832010, "link": "https://stackoverflow.com/questions/55832010/printf-is-behaving-in-different-ways-and-taking-address-as-well-as-value-ad/55832064#55832064", "title": "printf is behaving in different ways...and taking address as well as value....address of string and for a pointer only after dereferencing", "body": "<p>The <code>%s</code> format specifier to <code>printf</code> is used to print a string and expects a <code>char *</code> argument which points to the first element of a null-terminated character array.  The <code>%d</code> format specifier is used to print an integer in decimal format and expects an <code>int</code>.</p>\n\n<p>Since <code>str</code> is an array, when used in an expression it <em>decays</em> into a pointer to its first element.  So <code>str</code> in an expression has type <code>char *</code>, which matches what <code>%s</code> expects.</p>\n\n<p><code>*str</code> is not valid for <code>%s</code> because that has type <code>char</code> and has a value of the first character in an array.  Using the wrong format specifier for a given argument to <code>printf</code> invokes <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">undefined behavior</a>.</p>\n\n<p><code>*p</code> is valid for <code>%d</code> because <code>p</code> has type <code>int *</code>, meaning that <code>*p</code> has type <code>int</code>, which matches what <code>%d</code> expects.</p>\n"}], "owner": {"reputation": 11, "user_id": 11371483, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-9Fo0c_lEnAg/AAAAAAAAAAI/AAAAAAAABug/zfSq6sBQO0E/photo.jpg?sz=128", "display_name": "ashish_anand_93", "link": "https://stackoverflow.com/users/11371483/ashish-anand-93"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 55832064, "answer_count": 1, "score": 0, "last_activity_date": 1556115350, "creation_date": 1556114668, "last_edit_date": 1556115081, "question_id": 55832010, "link": "https://stackoverflow.com/questions/55832010/printf-is-behaving-in-different-ways-and-taking-address-as-well-as-value-ad", "title": "printf is behaving in different ways...and taking address as well as value....address of string and for a pointer only after dereferencing", "body": "<p><code>printf</code> is taking address of string and not taking after dereferencing, whereas in case of pointer it is required to dereference.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include&lt;stdio.h&gt;\n\nint main()\n{\n    char str[100];\n    int i;\n    int j=0;\n    int *p;\n\n    p=&amp;j;\n    scanf(\"%s\",str);\n    for(i=0;str[i];i++)\n    {\n        if((str[i]&gt;='A') &amp;&amp; (str[i]&lt;='Z'))\n        {\n            str[i]=str[i]+('a'-'A');\n        }\n        else\n        {\n            str[i]=str[i]-('a'-'A');\n        }\n    }\n    printf(\"%s\",str);   //it should have been printf(\"%s\",*str); here we are  passing address\n    printf(\"%d\\n\",j);\n    printf(\"%d\",*p);    //here we are passing evact value;\n\n    return 0;\n}\n</code></pre>\n\n<p>when used with <code>*</code> it crashes and if only <code>str</code> is used it works fine...</p>\n"}, {"tags": ["c", "xml", "libxml2"], "comments": [{"owner": {"reputation": 1419, "user_id": 488095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ro1E0.jpg?s=128&g=1", "display_name": "jamieguinan", "link": "https://stackoverflow.com/users/488095/jamieguinan"}, "edited": false, "score": 0, "creation_date": 1556135994, "post_id": 55831913, "comment_id": 98339458, "body": "<a href=\"http://xmlsoft.org/library.html\" rel=\"nofollow noreferrer\">It looks like</a> xmlReadMemory is used with the &quot;push&quot; method, but you could use <a href=\"http://xmlsoft.org/html/libxml-parserInternals.html#xmlCreateMemoryParserCtxt\" rel=\"nofollow noreferrer\">xmlCreateMemoryParserCtxt</a> with the &quot;pull&quot; method, that would give you an xmlParserCtxtPtr ."}, {"owner": {"reputation": 500, "user_id": 1145103, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/d970defee5e6f9ade872db0f674ce44d?s=128&d=identicon&r=PG", "display_name": "Waslap", "link": "https://stackoverflow.com/users/1145103/waslap"}, "reply_to_user": {"reputation": 1419, "user_id": 488095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ro1E0.jpg?s=128&g=1", "display_name": "jamieguinan", "link": "https://stackoverflow.com/users/488095/jamieguinan"}, "edited": false, "score": 0, "creation_date": 1556177103, "post_id": 55831913, "comment_id": 98350206, "body": "The xmlCreateMemoryParserCtx does not appear to be available to me (CentOS 7 default libxml2). There is a xmlCreateDocParserCtx and I&#39;ve changed the parsing to use this together with xmlCtxtReadDoc and then use the context with xmlParserFindNodeInfo  and the node but the result is always NULL."}], "answers": [{"tags": [], "owner": {"reputation": 500, "user_id": 1145103, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/d970defee5e6f9ade872db0f674ce44d?s=128&d=identicon&r=PG", "display_name": "Waslap", "link": "https://stackoverflow.com/users/1145103/waslap"}, "is_accepted": true, "score": 0, "last_activity_date": 1556188859, "last_edit_date": 1556188859, "creation_date": 1556188427, "answer_id": 55847273, "question_id": 55831913, "link": "https://stackoverflow.com/questions/55831913/libxml2-get-offset-into-xml-text-of-node/55847273#55847273", "title": "libxml2 get offset into XML text of node", "body": "<p>The following code worked for me (libxml2 documentation leaves little to desire, had to download source code and dig in the lib until I understood enough to hack this together). The key is:</p>\n\n<pre><code>xmlSetFeature(ctxt, \"gather line info\", (void *)&amp;v);\n</code></pre>\n\n<p>Here is some code to illustrate:</p>\n\n<pre><code>const char *xml = ...\nxmlParserCtxt *ctxt = NULL;\nxmlDoc *doc = NULL;\nif (!(ctxt = xmlCreateDocParserCtxt((const unsigned char *)xml)))\n    return -1;\nint v = 1;\nxmlSetFeature(ctxt, \"gather line info\", (void *)&amp;v);\nif (xmlParseDocument(ctxt) == -1)\n{\n    xmlFreeParserCtxt(ctxt);\n    return -1;\n}\nelse\n{\n    if ((ctxt-&gt;wellFormed) || ctxt-&gt;recovery)\n        doc = ctxt-&gt;myDoc;\n    else\n    {\n        xmlFreeParserCtxt(ctxt);\n        return -1;\n    }\n}\n\n// use doc to get a node and then xmlParserFindNodeInfo(ctxt, node)\n\u2026\n\nxmlFreeParserCtxt(ctxt);\n</code></pre>\n"}], "owner": {"reputation": 500, "user_id": 1145103, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/d970defee5e6f9ade872db0f674ce44d?s=128&d=identicon&r=PG", "display_name": "Waslap", "link": "https://stackoverflow.com/users/1145103/waslap"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "accepted_answer_id": 55847273, "answer_count": 1, "score": 0, "last_activity_date": 1556188859, "creation_date": 1556114423, "question_id": 55831913, "link": "https://stackoverflow.com/questions/55831913/libxml2-get-offset-into-xml-text-of-node", "title": "libxml2 get offset into XML text of node", "body": "<p>I need to know at which offset into an xml string a specific arbitrary node somewhere in dom can be found after xmlReadMemory was used to get dom. The problem is I can't figure out where to get the xmlParserCtxtPtr from to pass as first argument to xmlParserFindNodeInfo because my entire process of parsing yields no such context; only a xmlDoc.</p>\n"}, {"tags": ["c++", "c", "esp32"], "comments": [{"owner": {"reputation": 3213, "user_id": 3367446, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f849293d5517d4525ff6f47dc9d0486a?s=128&d=identicon&r=PG&f=1", "display_name": "Croll", "link": "https://stackoverflow.com/users/3367446/croll"}, "edited": false, "score": 0, "creation_date": 1556287738, "post_id": 55831612, "comment_id": 98398800, "body": "Why tagged c++?"}, {"owner": {"reputation": 157, "user_id": 7200139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ab71a47ac7bc3fc13e3943318577e46?s=128&d=identicon&r=PG&f=1", "display_name": "Dimfred", "link": "https://stackoverflow.com/users/7200139/dimfred"}, "reply_to_user": {"reputation": 3213, "user_id": 3367446, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f849293d5517d4525ff6f47dc9d0486a?s=128&d=identicon&r=PG&f=1", "display_name": "Croll", "link": "https://stackoverflow.com/users/3367446/croll"}, "edited": false, "score": 0, "creation_date": 1556299499, "post_id": 55831612, "comment_id": 98404681, "body": "Both languages could answer that question. Also I am programming in C++ so."}], "answers": [{"tags": [], "owner": {"reputation": 157, "user_id": 7200139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ab71a47ac7bc3fc13e3943318577e46?s=128&d=identicon&r=PG&f=1", "display_name": "Dimfred", "link": "https://stackoverflow.com/users/7200139/dimfred"}, "is_accepted": true, "score": 0, "last_activity_date": 1559126036, "last_edit_date": 1559126036, "creation_date": 1556212543, "answer_id": 55854548, "question_id": 55831612, "link": "https://stackoverflow.com/questions/55831612/udp-client-doesnt-broadcast-message-on-esp32/55854548#55854548", "title": "UDP client doesn&#39;t broadcast message on esp32", "body": "<p>So I found the problem. There is in fact no problem with the socket.</p>\n\n<p>I have bluetooth and wifi running at the same time. On esp32 both share one antenna. It seems like the BT gets a higher priority (I am running an a2dp sink). And the wifi module is unable to acquire the antenna. Hence the problem.</p>\n\n<p>The following problem (and maybe a solution), can be found here:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/55865909/acquire-a-semaphore-for-the-esp32-antenna-bluetooth-wifi-dualmode\">acquire a semaphore for the esp32 antenna (bluetooth/wifi dualmode)</a></p>\n"}], "owner": {"reputation": 157, "user_id": 7200139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ab71a47ac7bc3fc13e3943318577e46?s=128&d=identicon&r=PG&f=1", "display_name": "Dimfred", "link": "https://stackoverflow.com/users/7200139/dimfred"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 655, "favorite_count": 0, "accepted_answer_id": 55854548, "answer_count": 1, "score": 0, "last_activity_date": 1559126036, "creation_date": 1556113602, "last_edit_date": 1556287658, "question_id": 55831612, "link": "https://stackoverflow.com/questions/55831612/udp-client-doesnt-broadcast-message-on-esp32", "title": "UDP client doesn&#39;t broadcast message on esp32", "body": "<p>So I am trying to send packets via UDP as a broadcast from one ESP32 to another. The receiver is an access_point and server, the sender is a station and client.</p>\n\n<p>I already read this:\n<a href=\"https://stackoverflow.com/questions/44399443/esp32-udp-broadcaster-receiver-with-native-lwip-library\">ESP32 - UDP broadcaster/ receiver with native LwIP library</a></p>\n\n<p>But it didn't help. I know that my server works because I can send packages via terminal.\nBut for the client it seems that the packages aren't leaving the esp.</p>\n\n<p>My code:</p>\n\n<pre><code>// CLIENT: \n\nsockaddr_in _send_addr;\n_send_addr.sin_family         = AF_INET,\n_send_addr.sin_port           = htons( 5000 );\n// also tried local broadcast 192.168.4.255\n_send_addr.sin_addr.s_addr    = inet_addr( \"255.255.255.255\" ); \n_send_addr.sin_len            = sizeof( _send_addr );\n\n\nint _sock;\n_sock = socket( AF_INET, SOCK_DGRAM, IPPROTO_IP );\n\nint broadcast = 1;\nsetsockopt( _sock, SOL_SOCKET, SO_BROADCAST, &amp;broadcast, sizeof(broadcast) );\n\nvoid* data; // has some length\nsize_t len; // len of data\nsendto( _sock, data, len, 0, (const struct sockaddr*) &amp;_send_addr,\n   sizeof(_send_addr) );\n\n// SERVER:\n// server is bound to same port, and to ip \"0.0.0.0\"\n// like I said normally the server shouldn't be the problem, cause he received already\n</code></pre>\n\n<p>I skipped the checks.</p>\n\n<p>But everything is created successfully, and the sendto returns the correct number of bytes written.</p>\n\n<p>I have really no idea anymore appreciate any help.</p>\n"}, {"tags": ["c", "multithreading", "user-interface", "gtk", "gtk2"], "answers": [{"tags": [], "owner": {"reputation": 3440, "user_id": 1226843, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/txrOm.jpg?s=128&g=1", "display_name": "Matthew", "link": "https://stackoverflow.com/users/1226843/matthew"}, "is_accepted": true, "score": 1, "last_activity_date": 1556414950, "last_edit_date": 1556414950, "creation_date": 1556328714, "answer_id": 55876535, "question_id": 55831411, "link": "https://stackoverflow.com/questions/55831411/update-gtk2-text-view-widget-from-another-thread/55876535#55876535", "title": "Update Gtk+2 text view widget from another thread", "body": "<p>The solution I came up with is using the <code>g_idle_add()</code> function. I don't know if I am missing something because the solution is very simple but no one else identified it, so it makes me a bit worried.</p>\n\n<pre><code>void* messageReceived(void* data)\n{\n    struct ClientWindow* localVar = (struct ClientWindow*)data;\n    char* message = NULL;\n    int bytesRead = 0;\n    do\n    {\n\n        message = bufferedRead(localVar-&gt;socketFileDescriptor, 4, &amp;bytesRead);\n\n\n        struct UpdateGUIMessage* updateGui = malloc(sizeof(struct UpdateGUIMessage));\n        memset(updateGui, 0, sizeof(struct UpdateGUIMessage));\n\n        updateGui-&gt;clientWindow = localVar;\n        updateGui-&gt;message = message;\n        updateGui-&gt;bytesRead = bytesRead;\n\n        g_idle_add(G_SOURCE_FUNC(updateGUI), updateGui);\n\n    }while(message != NULL);\n}\n\n\n\nbool updateGUI(void* data)\n{\n    struct UpdateGUIMessage* localVar = (struct UpdateGUIMessage*)data;\n\n    GtkTextBuffer* tb = gtk_text_view_get_buffer(GTK_TEXT_VIEW(localVar-&gt;clientWindow-&gt;chatHistoryTextView));\n\n    GtkTextIter end;\n\n    gtk_text_buffer_get_end_iter(tb, &amp;end);\n    gtk_text_buffer_insert(tb, &amp;end, localVar-&gt;message, localVar-&gt;bytesRead);\n\n    free(localVar-&gt;message);\n    free(data);\n\n    return FALSE;       //So it only gets called once and then is removed\n}\n</code></pre>\n"}], "owner": {"reputation": 3440, "user_id": 1226843, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/txrOm.jpg?s=128&g=1", "display_name": "Matthew", "link": "https://stackoverflow.com/users/1226843/matthew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 152, "favorite_count": 0, "accepted_answer_id": 55876535, "answer_count": 1, "score": 1, "last_activity_date": 1556414950, "creation_date": 1556113024, "question_id": 55831411, "link": "https://stackoverflow.com/questions/55831411/update-gtk2-text-view-widget-from-another-thread", "title": "Update Gtk+2 text view widget from another thread", "body": "<p>I am writing a chat client in GTK. The client has the main GTK loop, plus a spawned thread that sits and blocks at the <code>read()</code> function waiting for input from a file descriptor connected to a socket.</p>\n\n<p>Once the read function gets past the blocking, it has a char buffer of text that I would like to append to the GTK Text View widget, however, this is in a thread that is different than the main GTK loop.</p>\n\n<p>How can I most quickly update the GUI from that other thread? In Java, I would have used the <code>SwingUtilities.invokeLater(new Runnable())</code> method to cause that method to be called from the main thread. I want similar behavior in C and using GTK.</p>\n\n<p>Here is the function that is called from the new thread...</p>\n\n<pre><code>void* messageReceived(void* data)\n{\n    struct ClientWindow* localVar = (struct ClientWindow*)data;\n\n    while(TRUE)\n    {\n        char buf[256];\n        int bytesRead = read(localVar-&gt;socketFileDescriptor, buf, 256);\n        GtkTextBuffer* tb = gtk_text_view_get_buffer(GTK_TEXT_VIEW(localVar-&gt;chatHistoryTextView));\n\n        GtkTextIter end;\n\n        //This code needs to execute in the main thread\n        gtk_text_buffer_get_end_iter(tb, &amp;end);\n        gtk_text_buffer_insert(tb, &amp;end, buf, -1);\n\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "list"], "comments": [{"owner": {"reputation": 17209, "user_id": 1055118, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/44Trt.jpg?s=128&g=1", "display_name": "doctorlove", "link": "https://stackoverflow.com/users/1055118/doctorlove"}, "edited": false, "score": 0, "creation_date": 1556111897, "post_id": 55830976, "comment_id": 98326659, "body": "How do you call it? What goes wrong?"}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1556113620, "post_id": 55830976, "comment_id": 98327813, "body": "Pretend like there are people that would truly be interested in helping.  Then consider what information would be needed to help them help you.  Little things, like a <i><a href=\"https://stackoverflow.com/help/mcve\">simplified compilable example of the problem code section</a></i>.  A statement explaining what you expect, and what you are seeing.  You might be surprised at the response."}, {"owner": {"reputation": 1, "user_id": 11405381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cfb1be3f5015088329bd7337a87814f?s=128&d=identicon&r=PG&f=1", "display_name": "user11405381", "link": "https://stackoverflow.com/users/11405381/user11405381"}, "edited": false, "score": 0, "creation_date": 1556121163, "post_id": 55830976, "comment_id": 98332688, "body": "I call it: Map map = mapCreate(copyDataChar, copyKeyInt, freeChar, freeInt,                         compareInts);     for (int i = 1; i &lt; 3; ++i) {         char j = (char) i;         ++j;         mapPut(map, &amp;i, &amp;j) ;         MAP_FOREACH(int*, itera, map) { // * Macro for iterating over a map.             printf(&quot;\\n%d&quot;, *itera);         } ---------- the result: 3 3 but it must print 1 2 3 (the key value)"}], "answers": [{"comments": [{"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "reply_to_user": {"reputation": 1, "user_id": 11405381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cfb1be3f5015088329bd7337a87814f?s=128&d=identicon&r=PG&f=1", "display_name": "user11405381", "link": "https://stackoverflow.com/users/11405381/user11405381"}, "edited": false, "score": 0, "creation_date": 1556125761, "post_id": 55831622, "comment_id": 98335000, "body": "I suggest you take a debugger to step through the function to check, for all relevant cases, if it behaves as intended."}], "tags": [], "owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "is_accepted": false, "score": 1, "last_activity_date": 1556113620, "creation_date": 1556113620, "answer_id": 55831622, "question_id": 55830976, "link": "https://stackoverflow.com/questions/55830976/what-is-the-problem-with-mapput-i-cannot-find-the-problem/55831622#55831622", "title": "What is the problem with mapPut ? I cannot find the problem", "body": "<p>You have typedefs that include a pointer, such as <code>typedef struct MapElements_t{...} *MapElements;</code> which makes the type <code>MapElements</code> a pointer.</p>\n\n<p><strong>This is discouraged</strong> and for the following reason:</p>\n\n<p>When you do </p>\n\n<pre><code>MapElements new_map_element = malloc(sizeof(new_map_element));\n</code></pre>\n\n<p>you are allocating the size of a pointer, not the size of the thing pointed to. In your case you should do:</p>\n\n<pre><code>MapElements new_map_element = malloc(sizeof(*new_map_element));\n</code></pre>\n\n<p>but preferably you would do:</p>\n\n<pre><code>typedef struct MapElements_t\n{\n    //...\n   struct MapElements_t* next;\n} MapElements;\n</code></pre>\n\n<p>so you make a variable that is a pointer to the thing have explicitly the <code>*</code>.</p>\n\n<pre><code>MapElements *new_map_element = malloc(sizeof(*new_map_element));\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 11405381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cfb1be3f5015088329bd7337a87814f?s=128&d=identicon&r=PG&f=1", "display_name": "user11405381", "link": "https://stackoverflow.com/users/11405381/user11405381"}, "is_accepted": false, "score": 0, "last_activity_date": 1556181984, "creation_date": 1556181984, "answer_id": 55845237, "question_id": 55830976, "link": "https://stackoverflow.com/questions/55830976/what-is-the-problem-with-mapput-i-cannot-find-the-problem/55845237#55845237", "title": "What is the problem with mapPut ? I cannot find the problem", "body": "<p>The fault was here; I have to replace this code:</p>\n\n<pre><code>new_map_element-&gt;data = dataElement;\nnew_map_element-&gt;key = keyElement;\n</code></pre>\n\n<p>with this code:</p>\n\n<pre><code>new_map_element-&gt;data = map-&gt;copyMapDataElements(dataElement);\nnew_map_element-&gt;key = map-&gt;copyMapKeyElements(keyElement);\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11405381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cfb1be3f5015088329bd7337a87814f?s=128&d=identicon&r=PG&f=1", "display_name": "user11405381", "link": "https://stackoverflow.com/users/11405381/user11405381"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1556181984, "creation_date": 1556111748, "last_edit_date": 1556113239, "question_id": 55830976, "link": "https://stackoverflow.com/questions/55830976/what-is-the-problem-with-mapput-i-cannot-find-the-problem", "title": "What is the problem with mapPut ? I cannot find the problem", "body": "<p>map contains   - returns whether or not a key exists inside the map.</p>\n\n<p>mapPut - Gives a specific key a given value and adding it to the map by order, if the key exists, the value is overridden.\n  mapRemove   - Removes a pair of (key, data) elements for which the key matches a given element (by the key compare function).</p>\n\n<p>mapGetFirst    - Sets the internal iterator to the first key in the map,    and returns it.</p>\n\n<pre><code>MapKeyElement mapGetFirst(Map map){\nif(map == NULL){\n    return NULL;\n}\nif (map-&gt;head == NULL){\n    return NULL;\n}\nmap-&gt;iterator = map-&gt;head;\nreturn (map-&gt;copyMapKeyElements(map-&gt;iterator-&gt;key));\n}\n</code></pre>\n\n<p>mapGetNext    - Advances the internal iterator to the next key and \n    returns it.</p>\n\n<pre><code>MapKeyElement mapGetNext(Map map){\n\nif(map == NULL){\n    return NULL;\n}\n\nif((map-&gt;iterator-&gt;next)== NULL) {\n    return NULL;\n}\nmap-&gt;iterator = map-&gt;iterator-&gt;next;\nreturn (map-&gt;copyMapKeyElements(map-&gt;iterator-&gt;key));\n} \n\ntypedef struct MapElements_t{\n\n   MapDataElement data;\n   MapKeyElement key;\n   struct MapElements_t* next;\n } *MapElements;\n\nstruct Map_t{\n   copyMapDataElements copyMapDataElements;\n   copyMapKeyElements copyMapKeyElements;\n   freeMapDataElements freeMapDataElements;\n   freeMapKeyElements freeMapKeyElements;\n   compareMapKeyElements compareMapKeyElements;\n   MapElements head;\n   MapElements iterator;\n };\n\n  /* ...... */\n\nMapResult mapPut(Map map, MapKeyElement keyElement, MapDataElement dataElement) {\n\n    if ((map == NULL) || (keyElement == NULL) || (dataElement == NULL)) {\n        return MAP_NULL_ARGUMENT;\n    }\n    if (mapContains(map, keyElement)) {\n        mapRemove(map, keyElement);\n    }\n    MapElements new_map_element = malloc(sizeof(new_map_element));\n    if (new_map_element == NULL) {\n        return MAP_OUT_OF_MEMORY;\n    }\n    new_map_element-&gt;data = dataElement;\n    new_map_element-&gt;key = keyElement;\n    new_map_element-&gt;next = NULL;\n\n    if(map-&gt;head == NULL){\n        map-&gt;head = new_map_element;\n        map-&gt;iterator = map-&gt;head;\n        return MAP_SUCCESS;\n    }\n\n    mapGetFirst(map);\n    if (map-&gt;compareMapKeyElements(keyElement, map-&gt;iterator-&gt;key) &lt; 0){\n        new_map_element-&gt;next = map-&gt;iterator;\n        map-&gt;head = new_map_element;\n        return MAP_SUCCESS;\n    }\n\n    while(map-&gt;iterator-&gt;next != NULL) {\n        if (map-&gt;compareMapKeyElements(keyElement, map-&gt;iterator-&gt;next-&gt;key) &lt; 0) {\n            new_map_element-&gt;next = map-&gt;iterator-&gt;next;\n            map-&gt;iterator = new_map_element;\n            return MAP_SUCCESS;\n        }\n        mapGetNext(map);\n    }\n\n    map-&gt;iterator-&gt;next = new_map_element;\n    return MAP_SUCCESS;\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1556110494, "post_id": 55830471, "comment_id": 98325706, "body": "Your code is fine. What is the problem you are having? If you have error messages, then please add them to your question."}, {"owner": {"reputation": 1189, "user_id": 9232218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ced53adbb0ba08d1cea65a43b124d?s=128&d=identicon&r=PG&f=1", "display_name": "Yastanub", "link": "https://stackoverflow.com/users/9232218/yastanub"}, "edited": false, "score": 0, "creation_date": 1556111551, "post_id": 55830471, "comment_id": 98326386, "body": "Im not sure if you are aware or not but keep in mind: <code>#ifdef</code>and other <b>Pre</b>processor directives are evaluated at compile time. Technically even before compile time (if you take it literally). So it is not a kind of a switch you can turn while your program runs but you need to compile your program twice to have both structures extended."}], "answers": [{"tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 3, "last_activity_date": 1556110300, "creation_date": 1556110300, "answer_id": 55830499, "question_id": 55830471, "link": "https://stackoverflow.com/questions/55830471/usage-of-ifdef-inside-structure-initialization/55830499#55830499", "title": "Usage of #ifdef inside structure initialization", "body": "<p>That general approach will work but you'll need to absorb the comma into the <code>#ifdef</code>:</p>\n\n<pre><code>{\n    10\n    ,20\n    #ifdef winters\n        ,50\n    #endif\n};\n</code></pre>\n\n<p>The reasons for wanting to do this though are questionable.</p>\n"}], "owner": {"reputation": 23, "user_id": 1382211, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/92c3c7a44a8dce0d8ed181122818b9cb?s=128&d=identicon&r=PG", "display_name": "Mudit Goyal", "link": "https://stackoverflow.com/users/1382211/mudit-goyal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 186, "favorite_count": 0, "closed_date": 1556112185, "answer_count": 1, "score": 2, "last_activity_date": 1556110300, "creation_date": 1556110199, "question_id": 55830471, "link": "https://stackoverflow.com/questions/55830471/usage-of-ifdef-inside-structure-initialization", "closed_reason": "Needs details or clarity", "title": "Usage of #ifdef inside structure initialization", "body": "<p>There are some values which are activated on certain #ifdef inside the structure. So, now on initializing and defining structure variable how will I use #ifdef inside structure initialization.</p>\n\n<pre><code>struct Godown\n{\n   int nPotatoes;\n   int nTomatoes;\n   #ifdef winters\n      int nGarlics;\n   #endif\n};\n\nGodown street1 = {10,20,\n                       #ifdef winters\n                          50\n                       #endif\n                  };\n</code></pre>\n"}, {"tags": ["c", "c99"], "comments": [{"owner": {"reputation": 11619, "user_id": 5346306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BsACH.jpg?s=128&g=1", "display_name": "Achal", "link": "https://stackoverflow.com/users/5346306/achal"}, "edited": false, "score": 0, "creation_date": 1556109261, "post_id": 55830090, "comment_id": 98324970, "body": "<code>op[i][4]</code> is of <code>char</code> type, not <code>char*</code> type. Try <code>scanf(&quot;%lf %s &quot;, &amp;in[i], op[i]);</code>"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1556109709, "post_id": 55830090, "comment_id": 98325247, "body": "Don&#39;t forget to add a character for the null terminator. If the longest op is 4 characters, you need to declare <code>char op[5][5]</code>"}, {"owner": {"reputation": 59, "user_id": 11381009, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f445c01c747b5355a94df5844883524c?s=128&d=identicon&r=PG&f=1", "display_name": "DemoVision", "link": "https://stackoverflow.com/users/11381009/demovision"}, "edited": false, "score": 0, "creation_date": 1556183147, "post_id": 55830090, "comment_id": 98353376, "body": "Hi, thanks for the tip! I thought that if the longest op is 4 chars, then [4] would be enough as it goes from 0 to 4? But probably it&#39;s the better way. Thanks"}], "answers": [{"comments": [{"owner": {"reputation": 59, "user_id": 11381009, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f445c01c747b5355a94df5844883524c?s=128&d=identicon&r=PG&f=1", "display_name": "DemoVision", "link": "https://stackoverflow.com/users/11381009/demovision"}, "edited": false, "score": 0, "creation_date": 1556183328, "post_id": 55830165, "comment_id": 98353479, "body": "Hello, thanks for the tip. So if I for example have a defined char: op[5][4] and then scan a file with op[i] then it would automatically work? I mean, without the second bracket?"}], "tags": [], "owner": {"reputation": 44000, "user_id": 535275, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/Ft2Mw.jpg?s=128&g=1", "display_name": "Scott Hunter", "link": "https://stackoverflow.com/users/535275/scott-hunter"}, "is_accepted": false, "score": 0, "last_activity_date": 1556109217, "creation_date": 1556109217, "answer_id": 55830165, "question_id": 55830090, "link": "https://stackoverflow.com/questions/55830090/is-it-possible-to-make-some-loop-which-scans-always-one-number-and-one-string-mo/55830165#55830165", "title": "Is it possible to make some loop which scans always one number and one string more than once? (Part of my homework)", "body": "<p>In a <code>scanf</code> format string, <code>%s</code> indicates you want to read a string, meaning it needs the address of where to put that string.  You are passing <code>op[i][4]</code> for it, which is a <code>char</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 11619, "user_id": 5346306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BsACH.jpg?s=128&g=1", "display_name": "Achal", "link": "https://stackoverflow.com/users/5346306/achal"}, "is_accepted": false, "score": 1, "last_activity_date": 1556109834, "creation_date": 1556109834, "answer_id": 55830342, "question_id": 55830090, "link": "https://stackoverflow.com/questions/55830090/is-it-possible-to-make-some-loop-which-scans-always-one-number-and-one-string-mo/55830342#55830342", "title": "Is it possible to make some loop which scans always one number and one string more than once? (Part of my homework)", "body": "<p>From the man page of <a href=\"http://man7.org/linux/man-pages/man3/scanf.3.html\" rel=\"nofollow noreferrer\">scanf</a> </p>\n\n<pre><code>int scanf(const char *format, ...);\n</code></pre>\n\n<p>as you can see first argument is of <code>const char *</code> type i.e you need to provide valid address.</p>\n\n<p>With this</p>\n\n<pre><code>char op[5][4]; /* 5 char array, in each char array you can have 4 char's\n                *  i.e op[row][0] to op[row][3]. There is no  op[i][4] \n                */\n</code></pre>\n\n<p>you can have</p>\n\n<pre><code>for(int i=0; i&lt;5;i++){\n   scanf(\"%s\",op[i]); /* op[i] itself address, so don't need &amp; */\n}\n</code></pre>\n\n<p>or</p>\n\n<pre><code>for(int i=0; i&lt;5;i++){ \n  for(int j=0; j&lt;4; j++) {\n   scanf(\" %c\", &amp;op[i][j]); /* storing char by char */\n  }\n}\n</code></pre>\n\n<p>Also while printing here use <code>%c</code> as <code>op[0][0]</code> is of <code>char</code> type.</p>\n\n<pre><code>printf(\"%.3f %c\", in[0], op[0][0]);\n</code></pre>\n"}], "owner": {"reputation": 59, "user_id": 11381009, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f445c01c747b5355a94df5844883524c?s=128&d=identicon&r=PG&f=1", "display_name": "DemoVision", "link": "https://stackoverflow.com/users/11381009/demovision"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1556109834, "creation_date": 1556108986, "question_id": 55830090, "link": "https://stackoverflow.com/questions/55830090/is-it-possible-to-make-some-loop-which-scans-always-one-number-and-one-string-mo", "title": "Is it possible to make some loop which scans always one number and one string more than once? (Part of my homework)", "body": "<p>so in my CS course we have to make a calculator which reads input and then calculates the result after the = sign has been read.\nInput always consists of one number followed by operator.</p>\n\n<p>I'm now struggling with the way of scanning the input. I want to use some loop which would always store it like:</p>\n\n<pre><code>scanf(\"%lf %s \", &amp;in, c);\n</code></pre>\n\n<p>Note: the calculator goes one operation after other. Thus in example below the plus sign works only for 20 and 4, and only then the result takes the division sign and gets divided by 8. Then the new result gets negated by 'neg' string.</p>\n\n<p>E.g.: Input: 20 + 4 / 8 neg =\n      Output: Result: -3</p>\n\n<p>This is how I tried to solve it. My intention was to make the loop store each number into a new \"box\" of array, and then to store each string into the new \"line\" of char array. The 4 in op array is meant to set the max length of the string, because i know that the longest string that can occur is \"sqrt\". \nI see that the '\\n' in the condition of for is probably useless but can't figure out how to do it...</p>\n\n<p>I'm thinking about using either for, or a while loop.</p>\n\n<pre><code>int main(){\n    double in[10];\n    char op[5][4];\n\n    for(int i=0; i&lt;5;i++){\n        scanf(\"%lf %s \", &amp;in[i], op[i][4]);\n    }\n\n    printf(\"%.3f %s\", in[0], op[0][0]);\n\nreturn 0;\n}\n</code></pre>\n\n<p>//just a \"skeleton\" of the code. There's more to it, but here I submitted just the part that I'm struggling with.</p>\n\n<p>For example if I run this code, I want to write a few numbers followed by operator into the input.\nI expect it to print the first number and string (just to check whether the loop works).</p>\n\n<p>But actually it does absolutely nothing and just gives me some large negative number as a return.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 24693, "user_id": 10190237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f95f50f67af8a9658c5d76df263b323?s=128&d=identicon&r=PG&f=1", "display_name": "P.W", "link": "https://stackoverflow.com/users/10190237/p-w"}, "edited": false, "score": 1, "creation_date": 1556109034, "post_id": 55830039, "comment_id": 98324830, "body": "<code>[4]</code> refers to the fifth element of the array."}, {"owner": {"reputation": 114, "user_id": 4650828, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/7c3ac75868538d3cb30249fc62145d9a?s=128&d=identicon&r=PG&f=1", "display_name": "aragon", "link": "https://stackoverflow.com/users/4650828/aragon"}, "edited": false, "score": 0, "creation_date": 1556109073, "post_id": 55830039, "comment_id": 98324851, "body": "Its time to learn about loops"}, {"owner": {"reputation": 11619, "user_id": 5346306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BsACH.jpg?s=128&g=1", "display_name": "Achal", "link": "https://stackoverflow.com/users/5346306/achal"}, "edited": false, "score": 2, "creation_date": 1556109074, "post_id": 55830039, "comment_id": 98324852, "body": "In <code>C</code> array index starts from zero. And this <code>int team1 [] = {110, 113, 112, 117};</code> allows you to use index from <code>0</code> to <code>3</code>. There is no <code>team1[4]</code>. Causing array element out of bounds is undefined behavior."}, {"owner": {"reputation": 7130, "user_id": 10239789, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YeHJm.png?s=128&g=1", "display_name": "TrebledJ", "link": "https://stackoverflow.com/users/10239789/trebledj"}, "edited": false, "score": 0, "creation_date": 1556109091, "post_id": 55830039, "comment_id": 98324868, "body": "Related: <a href=\"https://stackoverflow.com/questions/1461432/what-is-array-decaying\">What is array decaying?</a>"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 24693, "user_id": 10190237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f95f50f67af8a9658c5d76df263b323?s=128&d=identicon&r=PG&f=1", "display_name": "P.W", "link": "https://stackoverflow.com/users/10190237/p-w"}, "edited": false, "score": 4, "creation_date": 1556109122, "post_id": 55830039, "comment_id": 98324887, "body": "@P.W <i>&quot;the fifth element&quot;</i>  Multipass?"}], "answers": [{"tags": [], "owner": {"reputation": 82712, "user_id": 598696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/k1Yif.png?s=128&g=1", "display_name": "Vittorio Romeo", "link": "https://stackoverflow.com/users/598696/vittorio-romeo"}, "is_accepted": true, "score": 4, "last_activity_date": 1556109063, "creation_date": 1556109063, "answer_id": 55830116, "question_id": 55830039, "link": "https://stackoverflow.com/questions/55830039/why-is-the-argument-type-incorrect-it-is-int-when-it-should-be-int/55830116#55830116", "title": "Why is the argument type incorrect (it is int when it should be int *)?", "body": "<p><code>team1</code> is not an <code>int</code>, it is an array of <code>int</code> of size <code>4</code>. Arrays <em>\"decay\"</em> to pointers when passed to functions, which explains why you're seeing that error message.</p>\n\n<p>You need to individually print all elements, for example with a <code>for</code> loop.</p>\n\n<hr>\n\n<p>Your <code>scanf</code> calls are also incorrect - you are reading a single elements outside of the bounds of the <code>team1</code> array, which is undefined behavior. You need to scan each element with a loop.</p>\n"}], "owner": {"reputation": 25, "user_id": 11405083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c32183190a604852c9140e5a10ad77f?s=128&d=identicon&r=PG&f=1", "display_name": "llleyylllla", "link": "https://stackoverflow.com/users/11405083/llleyylllla"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 55830116, "answer_count": 1, "score": 0, "last_activity_date": 1556109063, "creation_date": 1556108787, "question_id": 55830039, "link": "https://stackoverflow.com/questions/55830039/why-is-the-argument-type-incorrect-it-is-int-when-it-should-be-int", "title": "Why is the argument type incorrect (it is int when it should be int *)?", "body": "<p>I am writing a program in C which scans values and prints the values out in order of 'team 1 value 1, team 2 value 1, team 1 value 2, team 2 value 2', etc. \nI keep getting an error on the line 'printf(\"Team 1 weighs: %i\\n\", team1);' with the message 'format specifies type int but the argument has type 'int *' and I can't figure out why. I think it might have something to do with the arrays.\nI'd appreciate any help!</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\n\nint main() {\n\n    printf(\"How many members of each team are there?\\n\");\n\n    int team1 [] = {110, 113, 112, 117};\n    int team2 [] = {106, 102, 121, 111};\n\n    scanf(\"%i\", &amp;team1[4]);\n    printf(\"How much do the players of team 1 weigh?\\n\");\n    scanf(\"%i\", &amp;team1[4]);\n\n    printf(\"Team 1 weighs: %i\\n\", team1);\n\n        return 0;\n    }\n}\n</code></pre>\n\n<p>I expect the output to print the values that I entered in when it requested user input, e.g. \"How much do the players of team 1 weigh?\" My answer: 43, 25, 64, 35.\nPrint \"Team 1 weighs: 43, 25, 64, 35\".</p>\n"}, {"tags": ["c", "openssl"], "answers": [{"comments": [{"owner": {"reputation": 4756, "user_id": 1364149, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/Y25ip.jpg?s=128&g=1", "display_name": "Shloim", "link": "https://stackoverflow.com/users/1364149/shloim"}, "edited": false, "score": 0, "creation_date": 1556116554, "post_id": 55832176, "comment_id": 98329882, "body": "That&#39;s the easy part. How do I set it as the default BIO_METHOD like in my original code?"}, {"owner": {"reputation": 5562, "user_id": 1946679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed74e2cdc59d058b76a76c90dd3c3bdc?s=128&d=identicon&r=PG", "display_name": "Matt Caswell", "link": "https://stackoverflow.com/users/1946679/matt-caswell"}, "reply_to_user": {"reputation": 4756, "user_id": 1364149, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/Y25ip.jpg?s=128&g=1", "display_name": "Shloim", "link": "https://stackoverflow.com/users/1364149/shloim"}, "edited": false, "score": 0, "creation_date": 1556129505, "post_id": 55832176, "comment_id": 98336676, "body": "You cannot change the default BIO_METHOD returned by BIO_s_socket(). You just need to ensure that wherever you call BIO_s_socket() in your code now, you replace it with some function that returns your newly created custom BIO_METHOD. If you never do this, because you are using SSL_set_fd/SSL_set_wfd/SSL_set_rfd to set a file descriptor directly into the SSL object then swap instead to using SSL_set0_rbio() and SSL_set0_wbio()."}], "tags": [], "owner": {"reputation": 5562, "user_id": 1946679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed74e2cdc59d058b76a76c90dd3c3bdc?s=128&d=identicon&r=PG", "display_name": "Matt Caswell", "link": "https://stackoverflow.com/users/1946679/matt-caswell"}, "is_accepted": false, "score": 0, "last_activity_date": 1556115155, "creation_date": 1556115155, "answer_id": 55832176, "question_id": 55829616, "link": "https://stackoverflow.com/questions/55829616/migration-of-default-bio-method-from-openssl-1-0-2-to-1-1-1/55832176#55832176", "title": "Migration of default BIO_METHOD from OpenSSL 1.0.2 to 1.1.1", "body": "<blockquote>\n  <p>I'm trying to port my application code from OpenSSL 1.0.2 to 1.1.0</p>\n</blockquote>\n\n<p>Firstly I recommend you move to 1.1.1 not 1.1.0. 1.1.1 is a Long Term Support version (LTS) and will be supported until 2023. 1.1.0 support ends later this year.</p>\n\n<p>You need to create a custom BIO_METHOD. In brief you create one using <code>BIO_meth_new()</code> and then set custom read and write functions using <code>BIO_meth_set_read()</code> and <code>BIO_meth_set_write()</code>. Depending on what your BIO_METHOD does you may need to call other set functions. They are all documented here:</p>\n\n<p><a href=\"https://www.openssl.org/docs/man1.1.1/man3/BIO_meth_new.html\" rel=\"nofollow noreferrer\">https://www.openssl.org/docs/man1.1.1/man3/BIO_meth_new.html</a></p>\n"}], "owner": {"reputation": 4756, "user_id": 1364149, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/Y25ip.jpg?s=128&g=1", "display_name": "Shloim", "link": "https://stackoverflow.com/users/1364149/shloim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 960, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1556116687, "creation_date": 1556107356, "last_edit_date": 1556116687, "question_id": 55829616, "link": "https://stackoverflow.com/questions/55829616/migration-of-default-bio-method-from-openssl-1-0-2-to-1-1-1", "title": "Migration of default BIO_METHOD from OpenSSL 1.0.2 to 1.1.1", "body": "<p>I'm trying to port my application code from OpenSSL 1.0.2 to 1.1.1 and I came across a change I can't seem to understand.</p>\n\n<p>In 1.0.2 we have replaced the default <code>bread</code> and <code>bwrite</code> methods of <code>BIO_s_socket</code> by calling:</p>\n\n<pre><code>orig_bread = BIO_s_socket()-&gt;bread;\norig_bwrite = BIO_s_socket()-&gt;bwrite;\nBIO_s_socket()-&gt;bread = my_bread;\nBIO_s_socket()-&gt;bwrite = my_bwrite;\n</code></pre>\n\n<p>However, in OpenSSL 1.1.1 <code>BIO_s_socket()</code> is said to return <code>const BIO_METHOD*</code> instead of <code>BIO_METHOD*</code>. How can I change the default behavior in this version?</p>\n\n<p>Edit: (...and if can't do it anymore, how do I set a bread and bwrite per ssl connection?)</p>\n"}, {"tags": ["c", "list", "dynamic", "malloc", "dynamic-memory-allocation"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1556106093, "post_id": 55829150, "comment_id": 98323110, "body": "Can you please <a href=\"https://stackoverflow.com/posts/55829150/edit\">edit</a>  your question and transform your chunks of code into a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>?"}, {"owner": {"reputation": 915, "user_id": 3254536, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c4d61200a78c3d51c929553f2a3c5de8?s=128&d=identicon&r=PG&f=1", "display_name": "Neijwiert", "link": "https://stackoverflow.com/users/3254536/neijwiert"}, "edited": false, "score": 1, "creation_date": 1556106236, "post_id": 55829150, "comment_id": 98323181, "body": "You <code>free</code> a pointer and then directly after it use it?"}, {"owner": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "edited": false, "score": 2, "creation_date": 1556106253, "post_id": 55829150, "comment_id": 98323192, "body": "In <code>array_list_free</code>, you <code>free</code> <code>array</code>, but then set values in that struct."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1556106346, "post_id": 55829150, "comment_id": 98323244, "body": "<code>array_list_insert(array,8);</code> should not compile, the second parameter of <code>array_list_insert</code> expects a <code>void*</code> but you provide an <code>int</code>. Please post real code and not some chunks of code patched together."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1556106499, "post_id": 55829150, "comment_id": 98323334, "body": "Yes and no, @Jabberwocky.  The language does require an explicit conversion there, but it&#39;s a relatively common extension to perform the conversion implicitly."}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 9996446, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209189603656926/picture?type=large", "display_name": "Alfredo Pipoli", "link": "https://stackoverflow.com/users/9996446/alfredo-pipoli"}, "edited": false, "score": 0, "creation_date": 1556110051, "post_id": 55829339, "comment_id": 98325432, "body": "Thank you so much! i&#39;ve fixed the problem  (and i&#39;m so shame about that ^^&#39;&#39; )  thank you again :)"}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": true, "score": 1, "last_activity_date": 1556106380, "creation_date": 1556106380, "answer_id": 55829339, "question_id": 55829150, "link": "https://stackoverflow.com/questions/55829150/re-add-one-element-to-a-dynamic-array-list-after-deleting-it-from-memory/55829339#55829339", "title": "Re-add one element to a dynamic array list (after deleting it from memory)", "body": "<p>The problem (at least <em>a</em> problem) is is that array_list_free frees the <code>array_list_t</code> object itself, not just the internal dynamic array:</p>\n\n<pre><code>    free(array);\n</code></pre>\n\n<p>If that's not a problem in itself (which it is if that object was not dynamically allocated) then it is a problem to continue using that object afterward without allocating new space for it and initializing that space -- both in that function itself and after that function returns.</p>\n\n<p>Speaking of initialization, an initialization function is notable by its absence from those you present.  Perhaps you initialize your objects via ordinary initializers or default initialization, or perhaps you just omitted the function, but be aware that you must not rely on uninitialized objects.</p>\n"}, {"tags": [], "owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "is_accepted": false, "score": 1, "last_activity_date": 1556106800, "last_edit_date": 1556106800, "creation_date": 1556106498, "answer_id": 55829374, "question_id": 55829150, "link": "https://stackoverflow.com/questions/55829150/re-add-one-element-to-a-dynamic-array-list-after-deleting-it-from-memory/55829374#55829374", "title": "Re-add one element to a dynamic array list (after deleting it from memory)", "body": "<p>Big problem here:</p>\n\n<pre><code>void* array_list_free(array_list_t* array) {\n    free(array-&gt;array);\n    free(array);   \n    array-&gt;capacity = 0;  //&lt;&lt;&lt; oups, array points nowhere here as it has been\n    array-&gt;size = 0;      //    freed on the previous line....\n    array-&gt;array = NULL;\n}\n</code></pre>\n\n<p>remove the three lines starting with <code>array-&gt;</code> from the function.</p>\n"}, {"tags": [], "owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "is_accepted": false, "score": 1, "last_activity_date": 1556110242, "last_edit_date": 1556110242, "creation_date": 1556106560, "answer_id": 55829382, "question_id": 55829150, "link": "https://stackoverflow.com/questions/55829150/re-add-one-element-to-a-dynamic-array-list-after-deleting-it-from-memory/55829382#55829382", "title": "Re-add one element to a dynamic array list (after deleting it from memory)", "body": "<p>Without a <em><a href=\"https://stackoverflow.com/help/mcve\">minimal compilable verifiable example</a></em> included in your post this will be limited to general suggestions:  </p>\n\n<p>One potential problem is that the prototype:</p>\n\n<pre><code>void array_list_check_and_realloc(array_list_t* array);\n</code></pre>\n\n<p>Needs to be changed to accommodate a pointer to the object that needs to be given memory:</p>\n\n<pre><code>void array_list_check_and_realloc(array_list_t **array) \n</code></pre>\n\n<p>This will of coarse also change the way it is called, and the code inside that function.</p>\n\n<p>Some comments on naming:<br>\nThe struct used includes the member name <code>array</code>. \nThe following prototypes also include an argument instance of the entire struct named <code>array</code>.:</p>\n\n<pre><code>void* array_list_free(array_list_t* array);\nvoid array_list_check_and_realloc(array_list_t* array); \n</code></pre>\n\n<p>Although legal, this is confusing.   </p>\n\n<p>Using the <code>_t</code> postfix to name your struct <code>array_list_t</code> is also not recommended for the <em><a href=\"https://stackoverflow.com/a/12727104/645128\">reasons explained here</a></em>.</p>\n\n<p>Some comments on your struct construct:  </p>\n\n<p>When creating a struct that will be used for linked lists, it is common to include a structure tag, as you have done, but to also include a pointer instance of the struct as a member.  This you have not done, but you should consider it.</p>\n\n<p>For example, consider modifying your original struct from this:</p>\n\n<pre><code>typedef struct array_list{\n    void** array;\n    size_t size;\n    size_t capacity;\n}array_list_t;\n</code></pre>\n\n<p>to something more like this:  (includes eliminating '_t' postfix from typedef name.)</p>\n\n<pre><code>typedef struct array_list{\n    size_t size;\n    size_t capacity;\n    struct array_list *array //this becomes new nodes of your list. \n}ListNode;\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 9996446, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209189603656926/picture?type=large", "display_name": "Alfredo Pipoli", "link": "https://stackoverflow.com/users/9996446/alfredo-pipoli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 55829339, "answer_count": 3, "score": 0, "last_activity_date": 1556110242, "creation_date": 1556105716, "question_id": 55829150, "link": "https://stackoverflow.com/questions/55829150/re-add-one-element-to-a-dynamic-array-list-after-deleting-it-from-memory", "title": "Re-add one element to a dynamic array list (after deleting it from memory)", "body": "<p>i'm working about dynamic array lists in c.\ni've some problems when i try to re-add one element to one arraylist after the deallocation.</p>\n\n<p>Struct:</p>\n\n<pre><code>typedef struct array_list{\n    void** array;\n    size_t size;\n    size_t capacity;\n}array_list_t;\n</code></pre>\n\n<p>Free array method:</p>\n\n<pre><code>void* array_list_free(array_list_t* array) {\n    free(array-&gt;array);\n    free(array);\n    array-&gt;capacity = 0;\n    array-&gt;size = 0;\n    array-&gt;array = NULL;\n}\n</code></pre>\n\n<p>Allocate and reallocate method:</p>\n\n<pre><code>void array_list_check_and_realloc(array_list_t* array) {\n    if(!(array-&gt;capacity &gt; array-&gt;size)) {\n        if(array-&gt;capacity == 0){\n            //the problem is probably here\n            array-&gt;capacity++;\n            array-&gt;array = realloc(array-&gt;array, sizeof(void*) * array-&gt;capacity);\n        }else{\n            array-&gt;capacity *= 2;\n            array-&gt;array = realloc(array-&gt;array, sizeof(void*) * array-&gt;capacity);\n        }\n    }\n}\n</code></pre>\n\n<p>Insert element to arraylist:</p>\n\n<pre><code>void* array_list_insert(array_list_t* array, void* element) {\n    array_list_check_and_realloc(array);\n    size_t i;\n    for( i = array_list_size(array); i &gt; 0; --i ) {\n        array-&gt;array[i] = array-&gt;array[i-1];\n    }\n    array-&gt;array[i] = element;\n    array-&gt;size += 1;\n}\n</code></pre>\n\n<p>Main:</p>\n\n<pre><code>    array_list_insert(array,8);\n    array_list_free(array);\n    array_list_insert(array,8); // &lt;--- Segmentation Fault\n</code></pre>\n\n<p>When i try to run the program, i haven't any error by the terminal and seems work fine. But when i try use the debugger i can see the segmentation fault and i don't know why (i use CLion IDE)\nsorry, i'm beginner in c language ^^'</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 2687, "user_id": 5104016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2tHXG.jpg?s=128&g=1", "display_name": "zerocool", "link": "https://stackoverflow.com/users/5104016/zerocool"}, "edited": false, "score": 4, "creation_date": 1556104728, "post_id": 55828738, "comment_id": 98322247, "body": "try debugging it&#39;s the perfect time to do so!"}, {"owner": {"reputation": 190, "user_id": 7176709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e179e3c0c654ceffd3b0224a22f7a83?s=128&d=identicon&r=PG&f=1", "display_name": "awakened", "link": "https://stackoverflow.com/users/7176709/awakened"}, "edited": false, "score": 0, "creation_date": 1556104907, "post_id": 55828738, "comment_id": 98322366, "body": "Well, you should debug, but to get you started, your statement <code>if (status = STILL_ALIVE)</code> sets the value 0 to <code>status</code> and returns 0. The statements inside the <code>if</code> condition are never executed."}, {"owner": {"reputation": 1, "user_id": 11379412, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/w2P3I.jpg?s=128&g=1", "display_name": "Poi", "link": "https://stackoverflow.com/users/11379412/poi"}, "reply_to_user": {"reputation": 2687, "user_id": 5104016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2tHXG.jpg?s=128&g=1", "display_name": "zerocool", "link": "https://stackoverflow.com/users/5104016/zerocool"}, "edited": false, "score": 0, "creation_date": 1556105160, "post_id": 55828738, "comment_id": 98322513, "body": "@zerocool I am unfamiliar with the Debugging process of C, I will try. But thanks for pointing out the If statement issue!"}, {"owner": {"reputation": 203, "user_id": 8758528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/c5rcJ.jpg?s=128&g=1", "display_name": "VVish", "link": "https://stackoverflow.com/users/8758528/vvish"}, "edited": false, "score": 0, "creation_date": 1556105686, "post_id": 55828738, "comment_id": 98322840, "body": "Try debugging using gdb. It is a free tool for debugging C programs. Just compile your program with a -g flag. You can read about gdb from <a href=\"https://www.cs.cmu.edu/~gilpin/tutorial/\" rel=\"nofollow noreferrer\">cs.cmu.edu/~gilpin/tutorial</a>"}], "answers": [{"tags": [], "owner": {"reputation": 17209, "user_id": 1055118, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/44Trt.jpg?s=128&g=1", "display_name": "doctorlove", "link": "https://stackoverflow.com/users/1055118/doctorlove"}, "is_accepted": false, "score": 2, "last_activity_date": 1556104894, "creation_date": 1556104894, "answer_id": 55828871, "question_id": 55828738, "link": "https://stackoverflow.com/questions/55828738/developing-a-minesweeper-game-issues-with-my-main-function/55828871#55828871", "title": "Developing a minesweeper game -Issues with my main function", "body": "<p>You have</p>\n\n<pre><code>if (status = STILL_ALIVE) \n</code></pre>\n\n<p>which sets <code>status</code> to <code>STILL_ALIVE</code> which is zero, so it never enters the loop.\ntry </p>\n\n<pre><code>if (status == STILL_ALIVE) \n</code></pre>\n\n<p>instead.</p>\n"}], "owner": {"reputation": 1, "user_id": 11379412, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/w2P3I.jpg?s=128&g=1", "display_name": "Poi", "link": "https://stackoverflow.com/users/11379412/poi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "closed_date": 1556114285, "answer_count": 1, "score": 0, "last_activity_date": 1556104894, "creation_date": 1556104462, "question_id": 55828738, "link": "https://stackoverflow.com/questions/55828738/developing-a-minesweeper-game-issues-with-my-main-function", "closed_reason": "Not suitable for this site", "title": "Developing a minesweeper game -Issues with my main function", "body": "<p>I am currently trying to Code a minesweeper game for a project in C;\nI am given very specific functions i need to implement and conditions to be met\nI am still pretty new to c and have trouble identifying why things i believe should work, don't;</p>\n\n<p>My issue occurs when trying to call to my function that starts the game;\nit prints an initial printf but never reaches the loop for the game;</p>\n\n<p>I am required to implement these Functions within my functions.c file : </p>\n\n<pre><code> void display(int grid[][DIM], int size);\n\n void update_status(int row, int col, int scores[][4], int known[][4]);\n\n void check_found(int row, int col, struct locations bombs[], int size, bool* found);\n\n char get_user_char();\n\n void update_known_info(int row, int col, int bomb_info[][DIM], int known[][DIM]);\n\n void start_game(struct locations *   bombs, int bomb_location_info[][DIM], int size_of_grid, int players_info[][DIM], int no_of_bombs){}\n</code></pre>\n\n<p>I am also required to use this struct and other definitions:</p>\n\n<pre><code>#define DIM 4\n#define UNKNOWN -1\n#define BOMB -2\n\nstruct locations {\nint x; \nint y; \nbool found;\n};\n</code></pre>\n\n<p>As it stands; my main looks like this:</p>\n\n<pre><code>    int _of_bombs = 2;\n\nstruct locations *   bombs = (struct locations *) malloc(sizeof(struct locations) * 2);\n\n\n    int bomb_location_info[4][4] = { 1,1,1,0,\n                                     1,0,2,1,\n                                     1,1,2,0,\n                                     0,0,1,1 };\n\n    int known_location_info[4][4] = { UNKNOWN,UNKNOWN,UNKNOWN,UNKNOWN,\n                                      UNKNOWN,UNKNOWN,UNKNOWN,UNKNOWN,\n                                      UNKNOWN,UNKNOWN,UNKNOWN,UNKNOWN,\n                                      UNKNOWN,UNKNOWN,UNKNOWN,UNKNOWN };\n\n\n    bombs[0].x = 1;\n    bombs[0].y = 1;\n    bombs[0].found = false;\n\n    bombs[1].x = 2;\n    bombs[1].y = 3;\n    bombs[1].found = false;\n\n    int size = 4;\n\n    start_game(bombs, bomb_location_info, size, known_location_info, _of_bombs);\n    return 0;\n\n    free(bombs);\n</code></pre>\n\n<p>This is all written to match the specification, apart from start_game which i have tried to implement but failed to do so.</p>\n\n<p>As it stands This is my code for the Functions.c:</p>\n\n<pre><code>void display(int known_location_info[][DIM], int size) {\n\nint f = 0;\nint g = 0;\nfor (f = 0; f &lt; size; f++) {\n    g = 0;\n\n    for (g = 0; g &lt; size; g++) {\n\n\n        if (g &lt; size) {\n\n            printf(\"%d\", known_location_info[g][f] );\n\n\n        }\n    }\n    printf(\"\\n\");\n\n}\n }\n\nvoid update_known_info(int row, int col, int bomb_info[][DIM], int known[][DIM]) {\nknown[row][col] = bomb_info[row][col];\n }\n\nvoid check_found(int row, int col, struct   locations bombs[], int size, bool* found) {\n\nfor (int i = 0; i &lt; 2; i++) {\n    if (bombs[i].x == row) {\n        if (bombs[i].y == row) {\n            *found = true;\n        }\n    }\n}\n}\n\n\nvoid  get_user_char(int* a ) {\nscanf(\"%d\", a);\n\n}\n\nvoid start_game(struct locations *   bombs, int bomb_location_info[][DIM], int size_of_grid, int players_info[][DIM], int no_of_bombs) {\n enum game_status { STILL_ALIVE, GAME_OVER };\n enum game_status status = STILL_ALIVE;\n\nprintf(\"Number of moves = 5\");\nfor (int i = 0; i &lt; 6; i++) {\n    if (status = STILL_ALIVE) {\n\n        int chosenX = 0;\n        int chosenY = 0;\n        printf(\"Enter  X coordinate:\");\n        get_user_char(&amp;chosenX);\n        printf(\"Enter  Y coordinate:\");\n        get_user_char(&amp;chosenY);\n\n        bool found = false;\n        check_found(chosenX, chosenY, bombs , size_of_grid,  found);\n        if (found = true) {\n            status = GAME_OVER;\n        }\n        else {\n            update_known_info(chosenX, chosenY, bomb_location_info, players_info);\n        }\n\n    }\n}\n\n}\n</code></pre>\n\n<p>I expect it to enter the loop of game_start and prompt me to enter co-ordinates however instead, it simply displays the number of guesses and then does nothing else</p>\n\n<p>I Would not be suprised if i have a huge amount of issues in the code, any help would be appreciated, but mainly any help with explaining why it never reaches the loop would help!</p>\n"}, {"tags": ["c", "windows", "gtk", "gtksourceview"], "answers": [{"comments": [{"owner": {"reputation": 1931, "user_id": 3696914, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/oLaiN.png?s=128&g=1", "display_name": "Edenia", "link": "https://stackoverflow.com/users/3696914/edenia"}, "edited": false, "score": 0, "creation_date": 1556186972, "post_id": 55841815, "comment_id": 98355682, "body": "Hello, you are most likely the only one experienced enough in the GTK+ tool chain in the entire community. My respect. I didn&#39;t receive response from the mailing lists this time, so my plan B was stack overflow. What do you mean by &quot;With a lot of duplicated code...&quot; ? :)"}, {"owner": {"reputation": 51182, "user_id": 172999, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b2014c8170f4d16a313cfa79071fd861?s=128&d=identicon&r=PG", "display_name": "ptomato", "link": "https://stackoverflow.com/users/172999/ptomato"}, "reply_to_user": {"reputation": 1931, "user_id": 3696914, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/oLaiN.png?s=128&g=1", "display_name": "Edenia", "link": "https://stackoverflow.com/users/3696914/edenia"}, "edited": false, "score": 0, "creation_date": 1556253681, "post_id": 55841815, "comment_id": 98382294, "body": "By no means am I the best person to answer this question. If no response on the mailing lists, I would suggest trying discourse.gnome.org, or #gtksourceview IRC channel on irc.gnome.org. By &quot;with a lot of duplicated code&quot; I meant you could probably copy most of the existing code of <code>GtkSourceGutterRendererPixbuf</code>, change the name of the class, and only change the few things you need in the <code>draw</code> function."}, {"owner": {"reputation": 1931, "user_id": 3696914, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/oLaiN.png?s=128&g=1", "display_name": "Edenia", "link": "https://stackoverflow.com/users/3696914/edenia"}, "edited": false, "score": 0, "creation_date": 1556265933, "post_id": 55841815, "comment_id": 98386863, "body": "I will give it a try. I get it why they didn&#39;t add such a functionality, but I also think pixel-below-lines and similar functions should affect mark size."}], "tags": [], "owner": {"reputation": 51182, "user_id": 172999, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b2014c8170f4d16a313cfa79071fd861?s=128&d=identicon&r=PG", "display_name": "ptomato", "link": "https://stackoverflow.com/users/172999/ptomato"}, "is_accepted": false, "score": 1, "last_activity_date": 1556166668, "creation_date": 1556166668, "answer_id": 55841815, "question_id": 55828680, "link": "https://stackoverflow.com/questions/55828680/i-want-bigger-pixbufs-rendered-onto-gtksourcegutter/55841815#55841815", "title": "I want bigger pixbufs rendered onto GtkSourceGutter", "body": "<p>I think it's probably <code>GtkSourceGutterRendererPixbuf</code> itself that you have to subclass. If not that, then probably <code>GtkSourceGutterRenderer</code> with a lot of duplicated code from <code>GtkSourceGutterRendererPixbuf</code>.</p>\n"}], "owner": {"reputation": 1931, "user_id": 3696914, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/oLaiN.png?s=128&g=1", "display_name": "Edenia", "link": "https://stackoverflow.com/users/3696914/edenia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1556166668, "creation_date": 1556104240, "question_id": 55828680, "link": "https://stackoverflow.com/questions/55828680/i-want-bigger-pixbufs-rendered-onto-gtksourcegutter", "title": "I want bigger pixbufs rendered onto GtkSourceGutter", "body": "<p>It seems that the size of the source marks rendered with <code>GtkSourceGutterRenderer</code> are remotely tied up to the size of the text in the <code>GtkSourceView</code>. I want to have bigger pixbufs, without making the text font size bigger and to achieve that I concluded I have to subclass a widget and override its <code>draw</code> signal handler.</p>\n\n<p>However I have no idea which widget to subclass on. Surely one of you knows?</p>\n"}, {"tags": ["c", "fork", "exec"], "comments": [{"owner": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "edited": false, "score": 1, "creation_date": 1556102843, "post_id": 55828193, "comment_id": 98321083, "body": "The <code>exec</code> isn&#39;t used to run a command and then return, it replaces the calling process. Nothing after <code>execl</code> ever happens."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1556102993, "post_id": 55828193, "comment_id": 98321172, "body": "The first part is answered already, second part is ... what? could you copy paste the running session into the question"}], "answers": [{"comments": [{"owner": {"reputation": 317, "user_id": 2945953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3152162957b5f2b7e29a4840832cbe21?s=128&d=identicon&r=PG&f=1", "display_name": "Larry_C", "link": "https://stackoverflow.com/users/2945953/larry-c"}, "edited": false, "score": 0, "creation_date": 1608158187, "post_id": 55828436, "comment_id": 115500902, "body": "They asked for a comment on the included code - not a link to the man. Likely they already read that."}], "tags": [], "owner": {"reputation": 146, "user_id": 3367493, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uzjLN.png?s=128&g=1", "display_name": "Programmer dude", "link": "https://stackoverflow.com/users/3367493/programmer-dude"}, "is_accepted": true, "score": 1, "last_activity_date": 1556103352, "creation_date": 1556103352, "answer_id": 55828436, "question_id": 55828193, "link": "https://stackoverflow.com/questions/55828193/what-happens-to-the-child-process-after-calling-exec/55828436#55828436", "title": "What happens to the child process after calling exec?", "body": "<p>You can read about <code>execl</code> in <a href=\"https://linux.die.net/man/3/execl\" rel=\"nofollow noreferrer\">https://linux.die.net/man/3/execl</a></p>\n\n<blockquote>\n  <p>The exec() family of functions replaces the current process image with a new process image. The functions described in this manual page are front-ends for execve(2). (See the manual page for execve(2) for further details about the replacement of the current process image.)</p>\n</blockquote>\n\n<p><code>exec</code> family REPLACES the current process image with a new process image so nothing after <code>execl</code> happen.</p>\n"}], "owner": {"reputation": 39, "user_id": 8625117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14eb2cd6474da84fb316749315511501?s=128&d=identicon&r=PG&f=1", "display_name": "Farros Mufid", "link": "https://stackoverflow.com/users/8625117/farros-mufid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 885, "favorite_count": 0, "accepted_answer_id": 55828436, "answer_count": 1, "score": 1, "last_activity_date": 1556103352, "creation_date": 1556102591, "last_edit_date": 1556102816, "question_id": 55828193, "link": "https://stackoverflow.com/questions/55828193/what-happens-to-the-child-process-after-calling-exec", "title": "What happens to the child process after calling exec?", "body": "<p>I'm new to system programming and curious how the exec function works. My first question is why does the child never print \"I'm the child\" after calling exec. How does exec replace the child process? My second question is why does the program (after calling exec) continue and ask for one more command line argument before it completely terminates. I'm not sure what's going on here. Anyone could explain what is going on would be very appreciated. Here is the code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n\nint main(void) {\n\n    if(fork() == 0){\n        printf(\"Hello from child!\\n\");\n        execl(\"/usr/bin/sort\", \"sort\", \"talk.c\",NULL);\n        printf(\"I'm the child\\n\");\n    }\n    else{\n        printf(\"Hello from parent!\\n\");\n        printf(\"Iam the parent\\n\");\n    }\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "out-of-memory"], "comments": [{"owner": {"reputation": 5555, "user_id": 2927205, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/luWrX.jpg?s=128&g=1", "display_name": "Mailerdaimon", "link": "https://stackoverflow.com/users/2927205/mailerdaimon"}, "edited": false, "score": 0, "creation_date": 1556102795, "post_id": 55828189, "comment_id": 98321056, "body": "Does your programm use more than 3GB? Is your application 32Bit? Is valgrind 32Bit?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user3458"}, "edited": false, "score": 0, "creation_date": 1556102946, "post_id": 55828189, "comment_id": 98321146, "body": "From the valgrind message, it&#39;s already using 7GB+, so not likely to be 32 bits. Still, more information about the OS, the program and the valgrind would be useful. Please edit the question."}, {"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 0, "creation_date": 1556103033, "post_id": 55828189, "comment_id": 98321195, "body": "<a href=\"https://unix.stackexchange.com/questions/44985/limit-memory-usage-for-a-single-linux-process\" title=\"limit memory usage for a single linux process\">unix.stackexchange.com/questions/44985/&hellip;</a> - might be useful"}, {"owner": {"reputation": 345, "user_id": 6769374, "user_type": "registered", "accept_rate": 55, "profile_image": "https://lh3.googleusercontent.com/-mMB2WnnvgEA/AAAAAAAAAAI/AAAAAAAAABM/srrBllW45x0/photo.jpg?sz=128", "display_name": "JiangFeng", "link": "https://stackoverflow.com/users/6769374/jiangfeng"}, "edited": false, "score": 0, "creation_date": 1556103092, "post_id": 55828189, "comment_id": 98321225, "body": "Yes, it&#39;s using about 6GB. program is 64 bit, of course system is 64 bit. I don&#39;t know how to tell if valgrind is 32 bit, should it be 32 bit? I installed it by apt-get"}, {"owner": {"reputation": 345, "user_id": 6769374, "user_type": "registered", "accept_rate": 55, "profile_image": "https://lh3.googleusercontent.com/-mMB2WnnvgEA/AAAAAAAAAAI/AAAAAAAAABM/srrBllW45x0/photo.jpg?sz=128", "display_name": "JiangFeng", "link": "https://stackoverflow.com/users/6769374/jiangfeng"}, "edited": false, "score": 0, "creation_date": 1556103485, "post_id": 55828189, "comment_id": 98321437, "body": "@Arkadiy I updated question, Should I provide any more information?"}, {"owner": {"reputation": 345, "user_id": 6769374, "user_type": "registered", "accept_rate": 55, "profile_image": "https://lh3.googleusercontent.com/-mMB2WnnvgEA/AAAAAAAAAAI/AAAAAAAAABM/srrBllW45x0/photo.jpg?sz=128", "display_name": "JiangFeng", "link": "https://stackoverflow.com/users/6769374/jiangfeng"}, "reply_to_user": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 0, "creation_date": 1556103700, "post_id": 55828189, "comment_id": 98321562, "body": "@EdHeal It tells me how to limit my program, but all I want to do is free it. &gt;_&lt;"}, {"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 0, "creation_date": 1556104129, "post_id": 55828189, "comment_id": 98321835, "body": "Please check the limits - is your current set up configured to be limited? If so, you have some information on how to proceed."}, {"owner": {"reputation": 345, "user_id": 6769374, "user_type": "registered", "accept_rate": 55, "profile_image": "https://lh3.googleusercontent.com/-mMB2WnnvgEA/AAAAAAAAAAI/AAAAAAAAABM/srrBllW45x0/photo.jpg?sz=128", "display_name": "JiangFeng", "link": "https://stackoverflow.com/users/6769374/jiangfeng"}, "reply_to_user": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 0, "creation_date": 1556104255, "post_id": 55828189, "comment_id": 98321929, "body": "@EdHeal Seems not, I added no limit to program. And there is no limit inside code."}], "owner": {"reputation": 345, "user_id": 6769374, "user_type": "registered", "accept_rate": 55, "profile_image": "https://lh3.googleusercontent.com/-mMB2WnnvgEA/AAAAAAAAAAI/AAAAAAAAABM/srrBllW45x0/photo.jpg?sz=128", "display_name": "JiangFeng", "link": "https://stackoverflow.com/users/6769374/jiangfeng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 120, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1556104034, "creation_date": 1556102583, "last_edit_date": 1556104034, "question_id": 55828189, "link": "https://stackoverflow.com/questions/55828189/why-program-is-out-of-memory-when-in-os-there-is-still-plenty-of", "title": "Why program is out of memory when in OS there is still plenty of?", "body": "<p>I added some features which require a lot of memory to a C program, it crashes everytime I run it, but it works fine when reduce the memory allocation. Using GDB to debug I find some bizarre results, like assignment would change other pointers, printf doesn't work. I thought this might be memory problem, but using <code>top</code> to monitor memory usage I find there is still plenty of memory.</p>\n\n<p>Finally I used <code>Valgrind</code> to monitor memory, even valgrind ran out of memory:</p>\n\n<pre><code>==3449==     Valgrind's memory management: out of memory:\n==3449==        memcheck:allocate new SecMap's request for 16384 bytes failed.\n==3449==        7,625,605,120 bytes have already been mmap-ed ANONYMOUS.\n==3449==     Valgrind cannot continue.  Sorry.\n==3449== \n==3449==     There are several possible reasons for this.\n==3449==     - You have some kind of memory limit in place.  Look at the\n==3449==       output of 'ulimit -a'.  Is there a limit on the size of\n==3449==       virtual memory or address space?\n==3449==     - You have run out of swap space.\n==3449==     - Valgrind has a bug.  If you think this is the case or you are\n==3449==     not sure, please let us know and we'll try to fix it.\n==3449==     Please note that programs can take substantially more memory than\n==3449==     normal when running under Valgrind tools, eg. up to twice or\n==3449==     more, depending on the tool.  On a 64-bit machine, Valgrind\n==3449==     should be able to make use of up 32GB memory.  On a 32-bit\n==3449==     machine, Valgrind should be able to use all the memory available\n==3449==     to a single process, up to 4GB if that's how you have your\n==3449==     kernel configured.  Most 32-bit Linux setups allow a maximum of\n==3449==     3GB per process.\n==3449== \n==3449==     Whatever the reason, Valgrind cannot continue.  Sorry.\n</code></pre>\n\n<p>But using <code>ulimit -a</code> there is no limit on visual space:</p>\n\n<pre><code>core file size          (blocks, -c) 0\ndata seg size           (kbytes, -d) unlimited\nscheduling priority             (-e) 0\nfile size               (blocks, -f) unlimited\npending signals                 (-i) 96254\nmax locked memory       (kbytes, -l) 64\nmax memory size         (kbytes, -m) unlimited\nopen files                      (-n) 1024\npipe size            (512 bytes, -p) 8\nPOSIX message queues     (bytes, -q) 819200\nreal-time priority              (-r) 0\nstack size              (kbytes, -s) 8192\ncpu time               (seconds, -t) unlimited\nmax user processes              (-u) 96254\nvirtual memory          (kbytes, -v) unlimited\nfile locks                      (-x) unlimited\n</code></pre>\n\n<p>Using <code>top</code> can tell server memory config:</p>\n\n<pre><code>KiB Mem : 24678616 total, 13461572 free,  3457528 used,  7759516 buff/cache\nKiB Swap:        0 total,        0 free,        0 used. 20754480 avail Mem \n</code></pre>\n\n<p>So what reason may caused this result?</p>\n\n<hr>\n\n<p>update:</p>\n\n<p>OS: </p>\n\n<pre><code>Linux astl09 4.4.0-83-generic #106-Ubuntu SMP Mon Jun 26 17:54:43 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux\n</code></pre>\n\n<p>program is <a href=\"http://www.pdl.cmu.edu/DiskSim/index.shtml\" rel=\"nofollow noreferrer\">disksim 4.0</a>. I use it on some research.</p>\n\n<p>valgrind:</p>\n\n<pre><code>valgrind-3.11.0\n</code></pre>\n"}, {"tags": ["c", "uart", "cortex-m"], "comments": [{"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1556102197, "post_id": 55827949, "comment_id": 98320730, "body": "Please don&#39;t post C code on image. Please <a href=\"https://stackoverflow.com/posts/55827949/edit\">edit</a> and attach code as text."}, {"owner": {"reputation": 3902, "user_id": 10302746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t5ySG.png?s=128&g=1", "display_name": "Lev M.", "link": "https://stackoverflow.com/users/10302746/lev-m"}, "edited": false, "score": 0, "creation_date": 1556102664, "post_id": 55827949, "comment_id": 98320984, "body": "I want to make sure I understand: you want to take every 4 bytes in <code>g_rxBuff</code> and treat them like a little endian 32 bit signed integer, then copy to <code>buffer_rt_s</code>?"}, {"owner": {"reputation": 218, "user_id": 3102638, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tgTeT.jpg?s=128&g=1", "display_name": "a_bet", "link": "https://stackoverflow.com/users/3102638/a-bet"}, "reply_to_user": {"reputation": 3902, "user_id": 10302746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t5ySG.png?s=128&g=1", "display_name": "Lev M.", "link": "https://stackoverflow.com/users/10302746/lev-m"}, "edited": false, "score": 0, "creation_date": 1556103114, "post_id": 55827949, "comment_id": 98321241, "body": "I hope now the question is more clear. @Lev M. Yeah that&#39;s the Idea. It&#39;s just a test to be sure I can manipulate those numbers properly."}], "answers": [{"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 45685, "user_id": 69809, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yCVF0.jpg?s=128&g=1", "display_name": "Groo", "link": "https://stackoverflow.com/users/69809/groo"}, "edited": false, "score": 0, "creation_date": 1556108827, "post_id": 55829264, "comment_id": 98324713, "body": "@Groo Well-defined apart from endianess. Unlike C++ where it is undefined."}, {"owner": {"reputation": 218, "user_id": 3102638, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tgTeT.jpg?s=128&g=1", "display_name": "a_bet", "link": "https://stackoverflow.com/users/3102638/a-bet"}, "edited": false, "score": 0, "creation_date": 1556373909, "post_id": 55829264, "comment_id": 98421386, "body": "Thanks @Lundin for pointing me to Strict ALiasing, I learned a whole lot. Should I post my solution by editing the question?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 218, "user_id": 3102638, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tgTeT.jpg?s=128&g=1", "display_name": "a_bet", "link": "https://stackoverflow.com/users/3102638/a-bet"}, "edited": false, "score": 0, "creation_date": 1556376922, "post_id": 55829264, "comment_id": 98422197, "body": "@a_bet No but you can post it as an answer to your own question."}], "tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": true, "score": 0, "last_activity_date": 1556106118, "creation_date": 1556106118, "answer_id": 55829264, "question_id": 55827949, "link": "https://stackoverflow.com/questions/55827949/c-cortex-m4-how-to-access-uint8-t-data-sent-by-uart-vcom-as-int32-t/55829264#55829264", "title": "C CORTEX-M4: How to access uint8_t data sent by UART (vcom) as int32_t", "body": "<p>There's lots of different problems here.</p>\n\n<ul>\n<li><p>Any data protocol sent over UART or other data communication will have something referred to as \"network endianess\". This is the MS/LS byte order used by the communication protocol. By tradition, this is almost always big endian.</p>\n\n<p>Your PC is almost certainly little endian. Cortex M4 support both big and little but typically default to little endian. This is the case with LPC4370.</p>\n\n<p>You need to sort out exactly how bytes are stored in memory and in the protocol before doing anything else. </p></li>\n<li><p><code>g_rxBuff</code> is not necessarily allocated on an even address, nor is the received protocol necessarily allocating integers on even addresses. Meaning that accessing it's contents through an <code>int32_t</code> may lead to misaligned access.</p></li>\n<li>Accessing a <code>uint8_t</code> array through a <code>int32_t</code> pointer access is always a strict aliasing violation bug. (You can do the other way around, as a special case.) See <a href=\"https://stackoverflow.com/questions/98650/what-is-the-strict-aliasing-rule\">What is the strict aliasing rule?</a> </li>\n</ul>\n\n<p>To avoid the latter two problems, you can either allocate memory at specific addresses and then hardcopy all memory with memcpy. Or alternatively, use some <code>union</code>tricks:</p>\n\n<pre><code>typedef union\n{\n  uint8_t u8 [4];\n  int32_t i32;\n} i32_t;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 218, "user_id": 3102638, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tgTeT.jpg?s=128&g=1", "display_name": "a_bet", "link": "https://stackoverflow.com/users/3102638/a-bet"}, "is_accepted": false, "score": 0, "last_activity_date": 1556454246, "creation_date": 1556454246, "answer_id": 55890212, "question_id": 55827949, "link": "https://stackoverflow.com/questions/55827949/c-cortex-m4-how-to-access-uint8-t-data-sent-by-uart-vcom-as-int32-t/55890212#55890212", "title": "C CORTEX-M4: How to access uint8_t data sent by UART (vcom) as int32_t", "body": "<p>So, I post here the solution that worked for me, after following @Lundin hints.\nHere's my union declaration: this ensures for the data to be 4-bytes aligned.</p>\n\n<pre><code>#define RAW_SIZE      64\n\n/* my nt32 buff */\n__DATA(RAM) int32_t buffer_rt_s[RAW_SIZE] = {0};\n\nunion Buffer {\n    uint8_t g_rxBuff[4*RAW_SIZE];\n    int32_t g_rxBuff32[RAW_SIZE];\n};\n\n</code></pre>\n\n<p>And here's my usage of the <a href=\"https://www.nxp.com/support/developer-resources/software-development-tools/lpc-developer-resources-/lpcopen-libraries-and-examples/lpcopen-software-development-platform-lpc43xx:LPCOPEN-SOFTWARE-FOR-LPC43XX\" rel=\"nofollow noreferrer\">LPCOpen USB Driver</a></p>\n\n<pre><code>/* Union init */\nBuffer b;\n\n/* read on byte at a time*/\nvcom_bread(&amp;(b.g_rxBuff[0]), 4*RAW_SIZE);\n\n/* do something with the data */\n\nbuffer_rt_s[i]=b.g_rxBuff32[i];\n\n/* write - note that this cast is legal */\nvcom_write((uint8_t*)&amp;buffer_rt_s[0], 4*RAW_SIZE);\n</code></pre>\n\n<p>I hope this can help others in using this kind of drivers:)</p>\n"}], "owner": {"reputation": 218, "user_id": 3102638, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tgTeT.jpg?s=128&g=1", "display_name": "a_bet", "link": "https://stackoverflow.com/users/3102638/a-bet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 0, "accepted_answer_id": 55829264, "answer_count": 2, "score": 2, "last_activity_date": 1556454246, "creation_date": 1556101904, "last_edit_date": 1556103408, "question_id": 55827949, "link": "https://stackoverflow.com/questions/55827949/c-cortex-m4-how-to-access-uint8-t-data-sent-by-uart-vcom-as-int32-t", "title": "C CORTEX-M4: How to access uint8_t data sent by UART (vcom) as int32_t", "body": "<p>I'm trying to test a communication between my LPC4370 cortex-m4 micro (LPC Link2 eval board) and my computer, using the VCOM exaple provided with LPCOpen.\nI simply want to sent data from matlab, copy them in a int32_t array and send them back to host. </p>\n\n<p>Here's what I tried.\nFrom Matlab:</p>\n\n<pre><code>fwrite(serial_object,raw_data,'int32');\n</code></pre>\n\n<p>For the C part, I summarize with only relevant code: </p>\n\n<pre><code>#define RAW_SIZE      1024\nunsigned char uint8_t;\ntypedef int int32_t;\n\n// My Buffer\n__DATA(RAM) int32_t buffer_rt_s[RAW_SIZE] = {0};\n\n// VCOM-UART rx buffer\nstatic uint8_t g_rxBuff[4*RAW_SIZE];\n\nint i;\n\nint main()\n{\n  vcom_bread((uint8_t*)&amp;g_rxBuff[0], 4*RAW_SIZE);\n\n    for(i=0; i &lt; RAW_SIZE; i=i+1)\n    {\n     buffer_rt_s[i]=(int32_t*)(&amp;g_rxBuff[0]+i*4);\n    }\n    vcom_write((uint8_t*)&amp;buffer_rt_s[0], 4*RAW_SIZE);\n}\n</code></pre>\n\n<p>What I'm trying to do here </p>\n\n<pre><code>for(i=0; i &lt; RAW_SIZE; i=i+1)\n{\nbuffer_rt_s[i]=(int32_t*)(&amp;g_rxBuff[0]+i*4);\n}\n</code></pre>\n\n<p>is to access the receving buffer advancing by 4 bytes at each iteration.\nSo I ask for the address</p>\n\n<pre><code>(&amp;g_rxBuff[0]+i*4)\n</code></pre>\n\n<p>And then for the content at that location, specifying I want a 32 bit number (i.e. 4 bytes):</p>\n\n<pre><code>(int32_t*)\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/DejFE.png\" rel=\"nofollow noreferrer\">Results form Matlab plot.</a>\nTo me it seems a lot like I'm reading the addresses of the receiving buffer instead of the content. \nNotice that I already used the <i> vcom </i> functions with matlab, and I know for sure that they are working.</p>\n\n<p>Any help would be appreciated.\nAndrea</p>\n"}, {"tags": ["android", "c", "linux", "linux-kernel", "netlink"], "answers": [{"comments": [{"owner": {"reputation": 3018, "user_id": 4190159, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XWz58.jpg?s=128&g=1", "display_name": "Somdip Dey", "link": "https://stackoverflow.com/users/4190159/somdip-dey"}, "edited": false, "score": 1, "creation_date": 1556111498, "post_id": 55828216, "comment_id": 98326350, "body": "Hi @Roman thank you for your answer and reply. First you have mentioned that the updated netlink_kernel_create function accepts 3 arguments and not 4, however, your answer is passing 4 of them. Secondly, even after using you solution I am getting the following error: ./include/linux/export.h:37:21: error: passing argument 3 of &#39;netlink_kernel_create&#39; from incompatible pointer type [-Werror] kernel/sched/custom_code.h:39:14: error: too many arguments to function &#39;netlink_kernel_create&#39;"}, {"owner": {"reputation": 3018, "user_id": 4190159, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XWz58.jpg?s=128&g=1", "display_name": "Somdip Dey", "link": "https://stackoverflow.com/users/4190159/somdip-dey"}, "edited": false, "score": 1, "creation_date": 1556116345, "post_id": 55828216, "comment_id": 98329745, "body": "I have edited your anser, which now works. However, will it be possible to answer my question 2? How can I call kernel_send_nl_msg() function to actually communicate with the userspace? Thank you in advance."}, {"owner": {"reputation": 1172, "user_id": 5247040, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-QjBkAmuJPUc/AAAAAAAAAAI/AAAAAAAAAEc/XOBs1syZFqI/photo.jpg?sz=128", "display_name": "Roman Zaitsev", "link": "https://stackoverflow.com/users/5247040/roman-zaitsev"}, "reply_to_user": {"reputation": 3018, "user_id": 4190159, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XWz58.jpg?s=128&g=1", "display_name": "Somdip Dey", "link": "https://stackoverflow.com/users/4190159/somdip-dey"}, "edited": false, "score": 0, "creation_date": 1556182173, "post_id": 55828216, "comment_id": 98352843, "body": "Thanks for fixing my mistake. Check my edit to answer"}, {"owner": {"reputation": 3018, "user_id": 4190159, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XWz58.jpg?s=128&g=1", "display_name": "Somdip Dey", "link": "https://stackoverflow.com/users/4190159/somdip-dey"}, "edited": false, "score": 0, "creation_date": 1556297107, "post_id": 55828216, "comment_id": 98403687, "body": "Hi @Roman, will you interested to help me with this problem:<a href=\"https://stackoverflow.com/questions/55870596/kernel-android-to-userspace-message-multicast-error-netlink-broadcast-filtere\" title=\"kernel android to userspace message multicast error netlink broadcast filtere\">stackoverflow.com/questions/55870596/&hellip;</a> ?"}], "tags": [], "owner": {"reputation": 1172, "user_id": 5247040, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-QjBkAmuJPUc/AAAAAAAAAAI/AAAAAAAAAEc/XOBs1syZFqI/photo.jpg?sz=128", "display_name": "Roman Zaitsev", "link": "https://stackoverflow.com/users/5247040/roman-zaitsev"}, "is_accepted": true, "score": 2, "last_activity_date": 1556182146, "last_edit_date": 1556182146, "creation_date": 1556102639, "answer_id": 55828216, "question_id": 55827795, "link": "https://stackoverflow.com/questions/55827795/kernel-to-userspace-application-communication/55828216#55828216", "title": "Kernel to userspace application communication", "body": "<p>1.\nLet's check <code>netlink_kernel_create</code> function in linux kernel:</p>\n\n<pre><code>static inline struct sock *\nnetlink_kernel_create(struct net *net, int unit, struct netlink_kernel_cfg *cfg)\n{\n    return __netlink_kernel_create(net, unit, THIS_MODULE, cfg);\n}\n</code></pre>\n\n<p>from here <a href=\"https://elixir.bootlin.com/linux/v4.9.59/source/include/linux/netlink.h#L60\" rel=\"nofollow noreferrer\">https://elixir.bootlin.com/linux/v4.9.59/source/include/linux/netlink.h#L60</a>\nNotice, that this function takes only 3 arguments ( instead of 6 in your code )</p>\n\n<p>This function have been changed in kernel 3.6 ( from 6 parameters to 4 )\n<a href=\"https://elixir.bootlin.com/linux/v3.6/source/include/linux/netlink.h#L185\" rel=\"nofollow noreferrer\">https://elixir.bootlin.com/linux/v3.6/source/include/linux/netlink.h#L185</a></p>\n\n<p>And then renamed to <code>__netlink_kernel_create</code> in kernel 3.7</p>\n\n<p><code>netlink_kernel_create</code> function from 3.7 accepts 3 arguments\n<a href=\"https://elixir.bootlin.com/linux/v3.7/source/include/linux/netlink.h#L48\" rel=\"nofollow noreferrer\">https://elixir.bootlin.com/linux/v3.7/source/include/linux/netlink.h#L48</a></p>\n\n<p>Try change this</p>\n\n<pre><code>socket = netlink_kernel_create(&amp;init_net, NETLINK_USERSOCK, 1, nl_receive_callback, NULL, THIS_MODULE);\n</code></pre>\n\n<p>to this</p>\n\n<pre><code>struct netlink_kernel_cfg cfg = {\n    .input  = nl_receive_callback,\n    .groups = 1,\n};\nsocket = netlink_kernel_create(&amp;init_net, NETLINK_USERSOCK, &amp;cfg);\n</code></pre>\n\n<ol start=\"2\">\n<li>Now you can send data in direction \"kernel => application\".</li>\n</ol>\n\n<p>When you start your application, it will bind socket with <code>user_sockaddr.nl_groups = MY_GROUP; bind(sock_fd, (struct sockaddr*)&amp;user_sockaddr, sizeof(user_sockaddr));</code>. </p>\n\n<p>After this you can send data from kernel to application with <code>NETLINK_CB(socket_buff).dst_group = MY_GROUP; nlmsg_multicast(socket, socket_buff, 0, MY_GROUP, GFP_KERNEL);</code> and it will be received by application with <code>recvmsg(sock_fd, &amp;msghdr, 0);</code></p>\n\n<blockquote>\n  <p>How can I call kernel_send_nl_msg() function to actually communicate with the userspace?</p>\n</blockquote>\n\n<p>You can call it from kernel module, which you write, compile and insmod into kernel. Or you can call it directly from kernel, but for this you will need to rebuild whole kernel.</p>\n\n<p>If you want to send data in direction \"application = > kernel\", then you need to do things in reverse: bind new socket with another <code>MY_GROUP2</code> in kernel and send data from application with <code>nlmsg_multicast</code></p>\n"}], "owner": {"reputation": 3018, "user_id": 4190159, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XWz58.jpg?s=128&g=1", "display_name": "Somdip Dey", "link": "https://stackoverflow.com/users/4190159/somdip-dey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 623, "favorite_count": 0, "accepted_answer_id": 55828216, "answer_count": 1, "score": 2, "last_activity_date": 1556182146, "creation_date": 1556101366, "last_edit_date": 1556113658, "question_id": 55827795, "link": "https://stackoverflow.com/questions/55827795/kernel-to-userspace-application-communication", "title": "Kernel to userspace application communication", "body": "<p>I am trying to make Kernel (Android, kernel 4.9.59) communicate with userspace applications. I found a solution using Netlink sockets: <a href=\"https://stackoverflow.com/a/25071310/4190159\">https://stackoverflow.com/a/25071310/4190159</a></p>\n\n<p>The first issue with the solution is that struct netlink_skb_parms used in the solution does not have a member named 'pid', instead has a member named 'portid', which I believe is not the same as pid. Anyway, to compile my kernel side code/solution I used 'portid' member of struct netlink_skb_parms instead for initialization. However, now I am getting a different error.</p>\n\n<p>My <strong>Kernel</strong> side Netlink socket code as follows:</p>\n\n<pre><code>#include &lt;linux/sched.h&gt;\n//For netlink socket --&gt;\n#include &lt;net/sock.h&gt;\n//#include &lt;net/netlink.h&gt;\n#include &lt;linux/netlink.h&gt;\n#include &lt;linux/skbuff.h&gt;\n#include &lt;linux/string.h&gt;\n\n#define MY_GROUP    1 //For netlink socket\nstruct sock* socket; //For netlink socket\nstruct sk_buff* socket_buff; //For netlink socket\n\nstatic void nl_receive_callback (struct sk_buff *skb)\n{\n    nlmsg_free(skb);\n}\n\nstatic void kernel_send_nl_msg(void)\n{\n    struct nlmsghdr *nlsk_mh;\n    char* msg = \"hello from kernel\";\n\n    socket = netlink_kernel_create(&amp;init_net, NETLINK_USERSOCK, 1, nl_receive_callback, NULL, THIS_MODULE);\n\n    socket_buff = nlmsg_new(256, GFP_KERNEL);\n    nlsk_mh = nlmsg_put(socket_buff, 0, 0, NLMSG_DONE, strlen(msg), 0);\n    //NETLINK_CB(socket_buff).pid = 0;    // kernel pid is deprecated\n    NETLINK_CB(socket_buff).portid = 0;\n    NETLINK_CB(socket_buff).dst_group = MY_GROUP;\n    strcpy(nlmsg_data(nlsk_mh), msg);\n\n    nlmsg_multicast(socket, socket_buff, 0, MY_GROUP, GFP_KERNEL);\n    pr_info(\"%s\", msg);//Print out the message to kernel\n\n    return;\n}\n</code></pre>\n\n<p>My <strong>userspace</strong> application side code to intercept the message from the kernel as follows:</p>\n\n<pre><code>#include &lt;sys/socket.h&gt;\n#include &lt;linux/netlink.h&gt;\n\n#define MY_GROUP    1\n\nvoid user_recieve_nl_msg(void)\n{\n    int sock_fd;\n    struct sockaddr_nl user_sockaddr;\n    struct nlmsghdr *nl_msghdr;\n    struct msghdr msghdr;\n    struct iovec iov;\n\n    char* kernel_msg;\n\n    sock_fd = socket(PF_NETLINK, SOCK_RAW, NETLINK_USERSOCK);\n\n    memset(&amp;user_sockaddr, 0, sizeof(user_sockaddr));\n    user_sockaddr.nl_family = AF_NETLINK;\n    user_sockaddr.nl_pid = getpid();\n    user_sockaddr.nl_groups = MY_GROUP; \n\n    bind(sock_fd, (struct sockaddr*)&amp;user_sockaddr, sizeof(user_sockaddr));\n    while (1) {\n        nl_msghdr = (struct nlmsghdr*) malloc(NLMSG_SPACE(256));\n        memset(nl_msghdr, 0, NLMSG_SPACE(256));\n\n        iov.iov_base = (void*) nl_msghdr;\n        iov.iov_len = NLMSG_SPACE(256);\n\n        msghdr.msg_name = (void*) &amp;user_sockaddr;\n        msghdr.msg_namelen = sizeof(user_sockaddr);\n        msghdr.msg_iov = &amp;iov;\n        msghdr.msg_iovlen = 1;\n\n        recvmsg(sock_fd, &amp;msghdr, 0);\n\n        kernel_msg = (char*)NLMSG_DATA(nl_msghdr);\n        print(\"Kernel message: %s\\n\", kernel_msg); // print to android logs\n    }\n\n    close(sock_fd);\n}\n</code></pre>\n\n<p>When I am trying to build the android kernel I am receiving the fllowing error:</p>\n\n<blockquote>\n  <p>kernel/sched/custom_code.h:34:65: error: passing argument 3 of\n  'netlink_kernel_create' makes pointer from integer without a cast\n  [-Werror]</p>\n  \n  <p>kernel/sched/custom_code.h:34:14: error: too many arguments to\n  function 'netlink_kernel_create'</p>\n</blockquote>\n\n<p><strong>Note</strong> the code for the Kernel side is written in custom_code.h. </p>\n\n<p>My questions are as follows:</p>\n\n<ol>\n<li><p>I have checked the function 'netlink_kernel_create' and I am sending the right number of arguments then why is the aformentioned error coming up? How this error could be resolved?</p></li>\n<li><p>What should I do to establish a valid communication between the kernel and the userspace application so that messages could be passed (to and fro) between them?</p></li>\n</ol>\n"}, {"tags": ["c", "grammar", "yacc"], "comments": [{"owner": {"reputation": 301, "user_id": 10982941, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e2b6d53ddaf61d42291d03fc26c0c29?s=128&d=identicon&r=PG&f=1", "display_name": "TYFA", "link": "https://stackoverflow.com/users/10982941/tyfa"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1556101417, "post_id": 55827603, "comment_id": 98320279, "body": "@n.m. Sorry, I just edited"}], "answers": [{"tags": [], "owner": {"reputation": 1246, "user_id": 6556709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6389fba1f75367a547c52d9779902b20?s=128&d=identicon&r=PG&f=1", "display_name": "user6556709", "link": "https://stackoverflow.com/users/6556709/user6556709"}, "is_accepted": false, "score": 2, "last_activity_date": 1556101515, "creation_date": 1556101515, "answer_id": 55827840, "question_id": 55827603, "link": "https://stackoverflow.com/questions/55827603/ambiguity-in-ansi-c-yacc-grammar/55827840#55827840", "title": "Ambiguity in ANSI C YACC grammar", "body": "<p>A EBNF grammar can have multiple valid rules/states at the same time.That means in this case if it finds a conditional it can match an assignment_expression and a constant_expression at the same time. To get an unique answer the rules using these two rules must be specific enough to match a given input sequence only to a single sequence of rules or you can use priorities to select a single sequence of rules from multiple possible sequences.</p>\n"}, {"tags": [], "owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "is_accepted": true, "score": 4, "last_activity_date": 1556101584, "creation_date": 1556101584, "answer_id": 55827854, "question_id": 55827603, "link": "https://stackoverflow.com/questions/55827603/ambiguity-in-ansi-c-yacc-grammar/55827854#55827854", "title": "Ambiguity in ANSI C YACC grammar", "body": "<p>There is no ambiguity because there is no context in which both <code>assignment_expression</code> and <code>constant_expression</code> may appear. </p>\n\n<p>There is absolutely nothing wrong with having rules of the form</p>\n\n<pre><code>a: z;\nb: z;\nc: z;\n</code></pre>\n\n<p>if <code>a</code>, <code>b</code>, and <code>c</code> all appear in different contexts. If you have the following</p>\n\n<pre><code>t: a | b | c;\n</code></pre>\n\n<p>then there's a problem. But there's nothing like that for <code>conditional_expression</code>.</p>\n"}], "owner": {"reputation": 301, "user_id": 10982941, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e2b6d53ddaf61d42291d03fc26c0c29?s=128&d=identicon&r=PG&f=1", "display_name": "TYFA", "link": "https://stackoverflow.com/users/10982941/tyfa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 132, "favorite_count": 0, "accepted_answer_id": 55827854, "answer_count": 2, "score": 3, "last_activity_date": 1556101584, "creation_date": 1556100763, "last_edit_date": 1556101397, "question_id": 55827603, "link": "https://stackoverflow.com/questions/55827603/ambiguity-in-ansi-c-yacc-grammar", "title": "Ambiguity in ANSI C YACC grammar", "body": "<p>I'm watching ANSI C YACC grammar.\nAnd there is something that I don't understand.\n<a href=\"http://www.lysator.liu.se/c/ANSI-C-grammar-y.html#expression\" rel=\"nofollow noreferrer\">http://www.lysator.liu.se/c/ANSI-C-grammar-y.html#expression</a></p>\n\n<pre><code>assignment_expression\n    : conditional_expression\n    | unary_expression assignment_operator assignment_expression\n    ;\n\nconstant_expression\n    : conditional_expression\n    ;\n</code></pre>\n\n<p>Here are the rules for assignment expression and constant expression.\nMy question is that how can they both use <code>conditional_expression</code> to reduce?\nIf there is a token reduced to a conditional_expression, after the token reduced how does YACC parser know how to reduce the token next between <code>assignment_expression</code> and <code>constant_expression</code>?\nI think I'm missing something huge but I can't find that by myself.\nThank you</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1556101427, "post_id": 55827583, "comment_id": 98320287, "body": "Given that <code>cards</code> is a <code>deck_t *</code>, just what do you think <code>cards[i]</code> is?  You should probably turn on <b>all</b> compiler warnings..."}, {"owner": {"reputation": 130, "user_id": 10907398, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ab1b46b2e3a9528fb99df603d41fcc2?s=128&d=identicon&r=PG&f=1", "display_name": "H&#225;d\u0113s", "link": "https://stackoverflow.com/users/10907398/h%c3%a1d%c4%93s"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1556101529, "post_id": 55827583, "comment_id": 98320338, "body": "I have no compiler warning at all, I&#39;m compiling like this: <code>gcc main.c deck.c</code>"}, {"owner": {"reputation": 130, "user_id": 10907398, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ab1b46b2e3a9528fb99df603d41fcc2?s=128&d=identicon&r=PG&f=1", "display_name": "H&#225;d\u0113s", "link": "https://stackoverflow.com/users/10907398/h%c3%a1d%c4%93s"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1556101643, "post_id": 55827583, "comment_id": 98320407, "body": "and when I compile the current code with -Wall, all I get is unused variables, and an unused function"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 2, "creation_date": 1556102039, "post_id": 55827583, "comment_id": 98320641, "body": "The overall approach is already totally wrong. A card shouldn&#39;t be defined as a two strings (e.g. &quot;Ace&quot;, &quot;Hearts&quot;) in first place. Throw that code away, think it over and start from scratch."}, {"owner": {"reputation": 130, "user_id": 10907398, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ab1b46b2e3a9528fb99df603d41fcc2?s=128&d=identicon&r=PG&f=1", "display_name": "H&#225;d\u0113s", "link": "https://stackoverflow.com/users/10907398/h%c3%a1d%c4%93s"}, "edited": false, "score": 0, "creation_date": 1556102271, "post_id": 55827583, "comment_id": 98320769, "body": "I accept that, but I&#39;m really interested in the situation here, because books or instructors never mention that <code>malloc</code> or <code>calloc</code> can be such a mess, and affecting the previously allocate data (if that is really what&#39;s happening as my conclusion)."}, {"owner": {"reputation": 130, "user_id": 10907398, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ab1b46b2e3a9528fb99df603d41fcc2?s=128&d=identicon&r=PG&f=1", "display_name": "H&#225;d\u0113s", "link": "https://stackoverflow.com/users/10907398/h%c3%a1d%c4%93s"}, "edited": false, "score": 0, "creation_date": 1556102962, "post_id": 55827583, "comment_id": 98321155, "body": "also here a card is just a string &quot;Ace of Spades&quot;, &quot;King of Clubs&quot;, I&#39;m using an array of strings to represent a deck, sorry if the code is unreadable, its just a training project."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1556109552, "post_id": 55827583, "comment_id": 98325150, "body": "<i>books or instructors never mention that malloc or calloc can be such a mess</i>  Oh yes they do.  What you are doing is a classic buffer overflow.  It even has a Wikipedia page: <a href=\"https://en.wikipedia.org/wiki/Buffer_overflow\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Buffer_overflow</a>"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1556115464, "post_id": 55827583, "comment_id": 98329132, "body": "@AndrewHenle: A buffer overflow is more typically where an index or pointer is properly used to access parts of a buffer but overruns the end (or start). This does not match that pattern; in this case, a wrong expression was used so that the index was not properly expressing an access into a buffer but was expressing an undesired construct. In other words, the problem is not that the index was too large but that the expression it was used in was wrong."}], "answers": [{"comments": [{"owner": {"reputation": 130, "user_id": 10907398, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ab1b46b2e3a9528fb99df603d41fcc2?s=128&d=identicon&r=PG&f=1", "display_name": "H&#225;d\u0113s", "link": "https://stackoverflow.com/users/10907398/h%c3%a1d%c4%93s"}, "edited": false, "score": 0, "creation_date": 1556116090, "post_id": 55828589, "comment_id": 98329554, "body": "so you are saying, that as a pointer to a deck_t, the second index in moving as the size of a deck_t, not to the second element of the array (the second string) in it ?."}, {"owner": {"reputation": 130, "user_id": 10907398, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ab1b46b2e3a9528fb99df603d41fcc2?s=128&d=identicon&r=PG&f=1", "display_name": "H&#225;d\u0113s", "link": "https://stackoverflow.com/users/10907398/h%c3%a1d%c4%93s"}, "edited": false, "score": 0, "creation_date": 1556116166, "post_id": 55828589, "comment_id": 98329617, "body": "but when I use <code>(*card)[j]</code> I&#39;m fetching the array firstly then accessing its elements"}], "tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": true, "score": 2, "last_activity_date": 1556103881, "creation_date": 1556103881, "answer_id": 55828589, "question_id": 55827583, "link": "https://stackoverflow.com/questions/55827583/how-to-dynamically-allocate-memory-without-affecting-other-data-allocated-dynami/55828589#55828589", "title": "How to dynamically allocate memory without affecting other data allocated dynamically?", "body": "<p>The line <code>memset(*cards[i], 0, strlen(*cards[i]));</code> is wrong. First, <code>cards</code> was allocated with <code>calloc</code>, so it is filled with zero bytes, which act as empty strings. So, if <code>*cards[i]</code> pointed to something in <code>cards</code>, <code>strlen</code> returns zero, and <code>memset</code> sets zero bytes to zero.</p>\n\n<p>Unfortunately, <code>*cards[i]</code> is valid only when <code>i</code> is zero. Since <code>cards</code> is a pointer to a <code>deck_t</code>, <code>cards[0]</code> is the first <code>deck_t</code>, which is an array of array of <code>char</code>. As an array, it is automatically converted to a pointer to its first, element, an array of <code>char</code>. Then <code>*cards[0]</code> is that array of <code>char</code>. As an array, it is automatically converted to a pointer to its first element, which is passed to <code>strlen</code>. However, when <code>i</code> is one (or greater), <code>cards[i]</code> would be the second (or greater) <code>deck_t</code>. But space for only one <code>deck_t</code> was allocated. So <code>*cards[i]</code> is invalid; it attempts to access space that was not allocated.</p>\n\n<p>Since this line is not needed (due to <code>calloc</code>), remove it and the loop it is in.</p>\n\n<p>In <code>strcat(*cards[j]</code>, the same problem exists\u2014<code>*cards[j]</code> is valid only when <code>j</code> is zero. A correct expression is <code>(*cards)[j]</code>.</p>\n\n<p>In <code>(*cards)[j]</code>, <code>cards</code> is a pointer to a <code>deck_t</code>, so <code>(*cards)</code> is a <code>deck_t</code>, which is an array of array of <code>char</code>. Then <code>(*cards)[j]</code> is element <code>j</code> of that array, so it is an array of <code>char</code>.</p>\n\n<p>Similarly, in <code>print_deck</code>, change <code>*deck[i]</code> to <code>(*deck)[i]</code>.</p>\n\n<p>(The code can be changed so that <code>deck[i]</code> can be used instead of <code>(*deck)[i]</code> by changing the type of <code>deck</code> to <code>char (*MyType)[S_MAXLEN + V_MAXLEN + OFLEN]</code>. However, you may wish to make the above changes first and understand them before changing types.)</p>\n"}], "owner": {"reputation": 130, "user_id": 10907398, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ab1b46b2e3a9528fb99df603d41fcc2?s=128&d=identicon&r=PG&f=1", "display_name": "H&#225;d\u0113s", "link": "https://stackoverflow.com/users/10907398/h%c3%a1d%c4%93s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 55828589, "answer_count": 1, "score": 0, "last_activity_date": 1556103881, "creation_date": 1556100713, "last_edit_date": 1592644375, "question_id": 55827583, "link": "https://stackoverflow.com/questions/55827583/how-to-dynamically-allocate-memory-without-affecting-other-data-allocated-dynami", "title": "How to dynamically allocate memory without affecting other data allocated dynamically?", "body": "<p>Im implementing a card game using C, here's my code:</p>\n<h1>deck.h:</h1>\n<pre><code>#ifndef DECK_H\n    #define DECK_H\n    #define S_NUM 4\n    #define V_NUM 12\n    #define S_MAXLEN 9\n    #define V_MAXLEN 6\n    #define OFLEN 5\n\n    typedef char deck_t\n        [S_NUM * V_NUM]\n            [S_MAXLEN + V_MAXLEN + OFLEN];\n    \n    typedef struct {\n        deck_t *hand;\n        deck_t *remaining_cards;\n    } dealed_deck_t;\n    \n    deck_t *new_deck(void);\n    void print_deck(const deck_t *);\n    dealed_deck_t deal(const deck_t *, int);\n    void free_deck(const deck_t *);\n    \n    static void deckcpy(const deck_t *const, deck_t *, int);\n    \n#endif\n</code></pre>\n<h1>deck.c:</h1>\n<pre><code>#include &quot;deck.h&quot;\n#include &lt;assert.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n\ndeck_t *new_deck() {\n    int i, j, k;\n    deck_t *cards = calloc(1, sizeof(deck_t));\n    char suits[S_NUM][S_MAXLEN] = {\n        &quot;Spades&quot;, &quot;Diamonds&quot;,\n        &quot;Hearts&quot;, &quot;Clubs&quot;\n    };\n    char values[V_NUM][V_MAXLEN] = {\n        &quot;Ace&quot;, &quot;Two&quot;, &quot;Three&quot;,\n        &quot;Four&quot;, &quot;Five&quot;, &quot;Six&quot;,\n        &quot;Seven&quot;, &quot;Eight&quot;, &quot;Nine&quot;,\n        &quot;Jack&quot;, &quot;Queen&quot;, &quot;King&quot;\n    };\n    for (i = 0; i &lt; S_NUM * V_NUM; ++i) {\n        memset(*cards[i], 0, strlen(*cards[i]));\n    }\n    for (i = 0, j = 0; i &lt; S_NUM; ++i) {\n        for (k = 0; k &lt; V_NUM; ++k, ++j) {\n            strcat(*cards[j], values[k]);\n            strcat(*cards[j], &quot; of &quot;);\n            strcat(*cards[j], suits[i]);\n        }\n    }\n    return cards;\n}\n\nvoid print_deck(const deck_t *deck) {\n    for (int i = 0; i &lt; S_NUM * V_NUM &amp;&amp; strlen(*deck[i]); ++i) {\n        printf(&quot;%s\\n&quot;, *deck[i]);\n    }\n}\n\ndealed_deck_t deal(const deck_t *deck, int handsize) {\n    int i, j;\n    dealed_deck_t dealed_deck;\n    dealed_deck.hand = calloc(1, sizeof(deck_t));\n    dealed_deck.remaining_cards = calloc(1, sizeof(deck_t));\n    \n    // print_deck(deck);\n    \n    return dealed_deck;\n}\n\nvoid free_deck(const deck_t *deck) {\n    free((void *)deck);\n}\n\nstatic void deckcpy(const deck_t *const deck, deck_t *dest, int handsize) {\n    for (int i = 0; i &lt; handsize; ++i) {\n        char temp[strlen(*deck[i])];\n        for (int j = 0; j &lt; strlen(*deck[i]); ++j) {\n            temp[j] = (*deck[i])[j];\n            temp[j] = '\\0';\n        }\n        for (int j = 0; j &lt; strlen(temp); ++j) {\n            (*dest[i])[j] = temp[j];\n            (*dest[i])[j] = '\\0';\n        }\n    }\n}\n</code></pre>\n<h1>main.c:</h1>\n<pre><code>#include &quot;deck.h&quot;\n\nint main() {\n    deck_t *cards = new_deck();\n    deck_t *hand = deal(cards, 6).hand;\n    // print_deck(cards);\n    free_deck(cards);\n    return 0;\n}\n</code></pre>\n<p>the problem is deck.c in the deal function.\nwhen I allocate memory for <code>dealed_deck.hand</code> and <code>dealed_deck.remaining_cards</code> the data pointed to by the parameter <code>deck</code> is affected and changed, so when I comment the two lines:\n<code>dealed_deck.hand = calloc(1, sizeof(deck_t));</code> and <code>dealed_deck.remaining_cards = calloc(1, sizeof(deck_t));</code>, the data is the same, when I uncomment the data change a bit.</p>\n<p>I'm using <code>calloc</code> here because when I used malloc the data pointed to by <code>dealed_deck.hand</code> and <code>dealed_deck.remaining_cards</code> was the same as the data pointed to by <code>deck</code>,  but when I used <code>calloc</code> they were empty as I want.</p>\n<p>I need a way to allocate memory without messing the memory and data I allocated before, how to do that?</p>\n<p>I'm compiling using a MacOS and gcc.\nthanks.</p>\n"}, {"tags": ["c", "timer", "microcontroller", "clock", "atmel"], "comments": [{"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1556101755, "post_id": 55827572, "comment_id": 98320474, "body": "Why have you not just umm.. &#39;adjusted&#39; the numbers by 2 and carried on developing?"}, {"owner": {"reputation": 45, "user_id": 11367967, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c28dec41b9f58f30788124fc26da0a87?s=128&d=identicon&r=PG&f=1", "display_name": "sss", "link": "https://stackoverflow.com/users/11367967/sss"}, "reply_to_user": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 3, "creation_date": 1556102063, "post_id": 55827572, "comment_id": 98320665, "body": "Because I want to understand why it does what it does."}, {"owner": {"reputation": 45, "user_id": 11367967, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c28dec41b9f58f30788124fc26da0a87?s=128&d=identicon&r=PG&f=1", "display_name": "sss", "link": "https://stackoverflow.com/users/11367967/sss"}, "reply_to_user": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1556102089, "post_id": 55827572, "comment_id": 98320678, "body": "But I think I found the error, I had set the WGM00 &lt; 1. Which should be set to 0 to have a CTC Timer."}], "owner": {"reputation": 45, "user_id": 11367967, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c28dec41b9f58f30788124fc26da0a87?s=128&d=identicon&r=PG&f=1", "display_name": "sss", "link": "https://stackoverflow.com/users/11367967/sss"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1556101004, "creation_date": 1556100690, "last_edit_date": 1556101004, "question_id": 55827572, "link": "https://stackoverflow.com/questions/55827572/why-is-my-atmega644-timer0-running-at-half-the-speed-of-the-expected-clock-speed", "title": "Why is my Atmega644 TIMER0 running at half the speed of the expected clock speed?", "body": "<p>I am trying to build a drum machine using an Atmega644. The drum machine will have 16 LED's which will show which 16th of the beat it is at. The user should be able to set the BPM and therefore the updating of the LED will be different for different BPM. </p>\n\n<p>I have a 16 MHz Crystal set at XTAL1 and XTAL2. I used a FUSE calculator to write the FUSE bits to a \"Full Swing Oscillator\" and remove the internal clock divide 8. I then set up the TIMER0 to perform this task</p>\n\n<pre><code>#define F_CPU 16000000UL  // 1MHz internal clock\n\nunsigned int tempo = 250; // Default BPM of 120.\nvolatile unsigned int seq_timer = 0;\n\n\n//set-up timer for 0.5 ms update\nTIMSK0 = (1&lt;&lt;OCIE0A);\nTCCR0A = (1 &lt;&lt; WGM01) |(1&lt;&lt;WGM00);\nTCCR0B = (0 &lt;&lt; WGM02) | (0&lt;&lt; CS02) | (1 &lt;&lt; CS01) | (1 &lt;&lt; CS00); //divide by 64\nOCR0A = 125;\n\nISR (TIMER0_COMPA_vect) {\nif (seq_timer&gt;0) {seq_timer--;}\n}\n\n//Update which 16th note we are at.\nvoid step(void){\nupdate_led();\nstep_number = step_number &lt; 15 ? step_number +1 : 0;\n}\n\n//Shift the LED such that the LED corresponding to step_number is lit up.\nvoid update_led(void) {\nfor (int j = 16; j&gt;=0; j--)\n{\n    if ((((1 &lt;&lt; step_number))&gt;&gt;j) &amp; 0x01) {\n        PORTD |= (1 &lt;&lt; PD5); //Serial Input\n    }\n    else {\n        PORTD &amp;= ~(1 &lt;&lt; PD5);\n    }\n    PORTD |= (1 &lt;&lt; PD4); //Read clock \n    PORTD &amp;= ~(1&lt;&lt; PD4);  \n}\n    PORTD |= (1 &lt;&lt; PD3); //Shift clock \n    _delay_ms(40);\n    PORTD &amp;= ~(1 &lt;&lt; PD3);\n}\n\n\nwhile (1) \n{   \n  if ((seq_timer == 0)) {    \n     seq_timer = tempo;\n     step();\n } \n</code></pre>\n\n<p>Step functions calls a \"update_led()\" function which light up the LED corresponding to the step_number. This should according to my calculations occur (16e6 / (64*250*125)) = 8 updates/sec. But instead it does 4 updates/sec.</p>\n\n<p>Am I missing something crucial? </p>\n"}, {"tags": ["c", "multithreading", "tcmalloc", "jemalloc"], "answers": [{"tags": [], "owner": {"reputation": 82430, "user_id": 17833, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ExIEf.png?s=128&g=1", "display_name": "Petesh", "link": "https://stackoverflow.com/users/17833/petesh"}, "is_accepted": false, "score": 0, "last_activity_date": 1556102123, "creation_date": 1556102123, "answer_id": 55828023, "question_id": 55827117, "link": "https://stackoverflow.com/questions/55827117/how-do-jemalloc-and-tcmalloc-track-threads/55828023#55828023", "title": "How do jemalloc and tcmalloc track threads?", "body": "<p>I can only answer for jemalloc, but the way it works is that when the thread cache is created it is associated with the thread specific data for that thread.</p>\n\n<p>When you create thread specific data, you can give it a 'destructor', which is invoked when the thread is being destroyed. If you're using pthreads it's the <a href=\"http://pubs.opengroup.org/onlinepubs/007904975/functions/pthread_key_create.html\" rel=\"nofollow noreferrer\">pthread_key_create</a> routine, which is the C way of creating thread specific data.</p>\n\n<p>In the case of jemalloc, there is a bit of code in <code>tcache.h</code>, which hooks <code>tcache_thread_cleanup</code> with the <code>tcache</code> data (my source jemalloc-3.0.0):</p>\n\n<pre><code>143 malloc_tsd_funcs(JEMALLOC_INLINE, tcache, tcache_t *, NULL,\n144     tcache_thread_cleanup)\n</code></pre>\n\n<p>So when the thread is exited, the destructor gets called. It gets given the pointer to the cache for that thread and runs the <code>tcache_thread_cleanup</code> routine at that time.</p>\n"}], "owner": {"reputation": 1, "user_id": 11401361, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-3XJQ4nXb-9w/AAAAAAAAAAI/AAAAAAAAADc/7n_tgego1Bw/photo.jpg?sz=128", "display_name": "Viktoriia Pashchenko", "link": "https://stackoverflow.com/users/11401361/viktoriia-pashchenko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 172, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1556102123, "creation_date": 1556099204, "last_edit_date": 1556100048, "question_id": 55827117, "link": "https://stackoverflow.com/questions/55827117/how-do-jemalloc-and-tcmalloc-track-threads", "title": "How do jemalloc and tcmalloc track threads?", "body": "<p>Now I am actively studying the code of memory managers <code>jemalloc</code> and <code>tcmalloc</code>. But I can't understand how these two managers track threads.</p>\n\n<p>If I understand correctly, a new thread can be detected during memory allocation, after which a new thread cache is created. But how does <code>tcmalloc</code> / <code>jemalloc</code> detect when a thread is destroyed and the thread cache attached to it can be freed for a future use?</p>\n\n<p>Google results could not give even a minimum of any useful information.</p>\n"}, {"tags": ["c", "linux", "file"], "comments": [{"owner": {"reputation": 4251, "user_id": 4605105, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh4.googleusercontent.com/-_cFfGx1khYs/AAAAAAAAAAI/AAAAAAAAGt0/vfQ_28nwAEE/photo.jpg?sz=128", "display_name": "&#212;rel", "link": "https://stackoverflow.com/users/4605105/%c3%94rel"}, "edited": false, "score": 0, "creation_date": 1556098844, "post_id": 55826796, "comment_id": 98318830, "body": "If /sys is a sysfs partition, file are one page so 4k"}, {"owner": {"reputation": 146, "user_id": 3367493, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uzjLN.png?s=128&g=1", "display_name": "Programmer dude", "link": "https://stackoverflow.com/users/3367493/programmer-dude"}, "edited": false, "score": 1, "creation_date": 1556098970, "post_id": 55826796, "comment_id": 98318899, "body": "I think 4096 byte is &quot;size on disk&quot; of the file, not is actual size of file"}, {"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "reply_to_user": {"reputation": 146, "user_id": 3367493, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uzjLN.png?s=128&g=1", "display_name": "Programmer dude", "link": "https://stackoverflow.com/users/3367493/programmer-dude"}, "edited": false, "score": 0, "creation_date": 1556100943, "post_id": 55826796, "comment_id": 98319997, "body": "@Programmerdude Size on disk is reported by <code>du -sh</code>. Actual size is reported by <code>ls -l</code> and <code>du -sh --apparent-size</code>."}], "answers": [{"comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1556101608, "post_id": 55827067, "comment_id": 98320388, "body": "<code>fp = fopen(&quot;...&quot;, &quot;r&quot;);</code> opens the file in text mode. You can&#39;t use <code>ftell()</code> to get the size of a file in text mode. Per <a href=\"https://port70.net/~nsz/c/c11/n1570.html#7.21.9.4\" rel=\"nofollow noreferrer\"><b>7.21.9.4 The ftell function</b>, paragraph 2 of the C standard</a>:  &quot;For a text stream, its file position indicator contains unspecified information, usable by the fseek function for returning the file position indicator for the stream to its position at the time of the ftell call; <b>the difference between two such return values is not necessarily a meaningful measure of the number of characters written or read.</b>&quot;"}, {"owner": {"reputation": 134, "user_id": 11131523, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-3O9ngZPKFGo/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdeFi7656jSqPOfPxvSdL-OboBLdg/mo/photo.jpg?sz=128", "display_name": "Igor Galczak", "link": "https://stackoverflow.com/users/11131523/igor-galczak"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1556102006, "post_id": 55827067, "comment_id": 98320626, "body": "@AndrewHenle You right, i dont say this is count of <b>characters</b>, this is <b>byte size</b>. But true is open file like a text can be confusing, i`ll cange."}], "tags": [], "owner": {"reputation": 134, "user_id": 11131523, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-3O9ngZPKFGo/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdeFi7656jSqPOfPxvSdL-OboBLdg/mo/photo.jpg?sz=128", "display_name": "Igor Galczak", "link": "https://stackoverflow.com/users/11131523/igor-galczak"}, "is_accepted": false, "score": 0, "last_activity_date": 1556102019, "last_edit_date": 1556102019, "creation_date": 1556099044, "answer_id": 55827067, "question_id": 55826796, "link": "https://stackoverflow.com/questions/55826796/ftell-fseek-is-different-from-the-acutal-data-length-in-file/55827067#55827067", "title": "ftell/fseek is different from the acutal data length in file", "body": "<p>In unix system block size of the file system must be 4 kB. <br>\nI dont want duplicate answer so check this:</p>\n\n<p><a href=\"https://unix.stackexchange.com/questions/62049/why-are-text-files-4kb\">https://unix.stackexchange.com/questions/62049/why-are-text-files-4kb</a> <br>\n<a href=\"https://en.wikipedia.org/wiki/File_system#Space_management\" rel=\"nofollow noreferrer\">https://en.wikipedia.org/wiki/File_system#Space_management</a></p>\n\n<p>If you want have real byte size of file use this:</p>\n\n<pre><code>fp = fopen(\"...\", \"rb\");\nfseek(fp, 0L, SEEK_END);\nsize_t size = ftell(fp);\n</code></pre>\n\n<p>And if you want read from file reset seek to begin:</p>\n\n<pre><code>rewind(fp);\n</code></pre>\n\n<p>OR</p>\n\n<pre><code>fseek(fp, 0L, SEEK_SET);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "is_accepted": false, "score": 1, "last_activity_date": 1556108515, "last_edit_date": 1556108515, "creation_date": 1556100045, "answer_id": 55827392, "question_id": 55826796, "link": "https://stackoverflow.com/questions/55826796/ftell-fseek-is-different-from-the-acutal-data-length-in-file/55827392#55827392", "title": "ftell/fseek is different from the acutal data length in file", "body": "<p><code>/sys</code> is a special filesystem where files are generated by the kernel on demand. See <a href=\"http://man7.org/linux/man-pages/man5/sysfs.5.html\" rel=\"nofollow noreferrer\"><code>man sysfs(5)</code></a> for more details:</p>\n\n<blockquote>\n  <p>The sysfs filesystem is a pseudo-filesystem which provides an interface to kernel data structures. (More precisely, the files and directories in sysfs provide a view of the kobject structures defined internally within the kernel.) The files under sysfs provide information about devices, kernel modules, filesystems, and other kernel components.</p>\n</blockquote>\n\n<p>The size of files in <code>/sys</code> reported by <code>ls</code> is not the actual size because the contents of the files do not get generated just for the purpose of getting the file size. The contents are only generated upon <code>read</code> syscall.</p>\n\n<p>Also note, that <code>fseek</code> and <code>ftell</code> won't report the actual file size for <code>sysfs</code> either because, again, the file content is only generated in <code>read</code> syscall.</p>\n"}, {"comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1556111582, "post_id": 55828019, "comment_id": 98326408, "body": "A downvote without a comment, when the code posted in the question is <b>explicitly</b> undefined behavior because it uses <code>fseek(.., SEEK_END)</code> on a binary stream?  And gets unexpected results?"}, {"owner": {"reputation": 121, "user_id": 1255827, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f32c0bbbade512e30bb2e04bc8022ca?s=128&d=identicon&r=PG&f=1", "display_name": "John D", "link": "https://stackoverflow.com/users/1255827/john-d"}, "edited": false, "score": 0, "creation_date": 1570735604, "post_id": 55828019, "comment_id": 103017685, "body": "Very well explained. Tks!"}], "tags": [], "owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "is_accepted": false, "score": 0, "last_activity_date": 1556102114, "creation_date": 1556102114, "answer_id": 55828019, "question_id": 55826796, "link": "https://stackoverflow.com/questions/55826796/ftell-fseek-is-different-from-the-acutal-data-length-in-file/55828019#55828019", "title": "ftell/fseek is different from the acutal data length in file", "body": "<blockquote>\n  <p>What's the problem?</p>\n</blockquote>\n\n<p>The problem is <code>fseek()</code>/<code>ftell()</code> is a fundamentally unsound way to get the size of a file.</p>\n\n<p>Files can be opened in either binary or text mode.</p>\n\n<p>For binary files, <code>fseek(file, 0, SEEK_END)</code> is explicitly undefined behavior.  Per <a href=\"https://port70.net/~nsz/c/c11/n1570.html#note268\" rel=\"nofollow noreferrer\">footnote 268 of the C standard</a>:</p>\n\n<blockquote>\n  <p>Setting the file position indicator to end-of-file, as with <code>fseek(file, 0, SEEK_END)</code>, has undefined behavior for a binary stream (because of possible trailing null characters) or for any stream with state-dependent encoding that does not assuredly end in the initial shift state. </p>\n</blockquote>\n\n<p>Per <a href=\"https://port70.net/~nsz/c/c11/n1570.html#7.21.9.2p3\" rel=\"nofollow noreferrer\"><strong>7.21.9.2 The fseek function</strong>, paragraph 3</a>:</p>\n\n<blockquote>\n  <p>... A binary stream need not meaningfully support fseek calls with a whence value of SEEK_END.</p>\n</blockquote>\n\n<p>So there's no portable, standards-compliant way to seek to the end of a binary stream.</p>\n\n<p>And you can't use <code>ftell()</code> to get the size of a file opened in text mode.  Per <a href=\"https://port70.net/~nsz/c/c11/n1570.html#7.21.9.4p2\" rel=\"nofollow noreferrer\"><strong>7.21.9.4 The ftell function</strong>, paragraph 2</a>(note the bolded portions):</p>\n\n<blockquote>\n  <p>The <code>ftell</code> function obtains the current value of the file position indicator for the stream pointed to by <code>stream</code>. For a binary stream, the value is the number of characters from the beginning of the file. <strong>For a text stream, its file position indicator contains unspecified information</strong>, usable by the fseek function for returning the file position indicator for the stream to its position at the time of the ftell call; <strong>the difference between two such return values is not necessarily a meaningful measure of the number of characters written or read.</strong></p>\n</blockquote>\n\n<p>You can't seek to the end of a binary stream, and you can't use <code>ftell</code> to get the size of a text stream.</p>\n"}], "owner": {"reputation": 87, "user_id": 8547005, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed68d613e6879b0531e8a352011261d0?s=128&d=identicon&r=PG&f=1", "display_name": "Kathy.Pu", "link": "https://stackoverflow.com/users/8547005/kathy-pu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 463, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1556108515, "creation_date": 1556098229, "question_id": 55826796, "link": "https://stackoverflow.com/questions/55826796/ftell-fseek-is-different-from-the-acutal-data-length-in-file", "title": "ftell/fseek is different from the acutal data length in file", "body": "<p>embedded linux system</p>\n\n<ol>\n<li><p>ls -al /sys/class/xxxx</p>\n\n<p>-r--r--r-- 4096</p></li>\n<li><p>ftell/lstat(st_size) return 4096</p></li>\n<li><p>fread(fp, 1, 4096, buf) return 3</p></li>\n</ol>\n\n<p>Actually, there are only 3 bytes in file using vi to open it.</p>\n\n<p>What's the problem? Thank you.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 55, "user_id": 6234954, "user_type": "registered", "profile_image": "https://graph.facebook.com/985180944865174/picture?type=large", "display_name": "Louis Zwawiak", "link": "https://stackoverflow.com/users/6234954/louis-zwawiak"}, "edited": false, "score": 1, "creation_date": 1556094948, "post_id": 55825615, "comment_id": 98316456, "body": "It&#39;s duplicating post, see : <a href=\"https://stackoverflow.com/questions/12698836/counting-words-in-a-string-c-programming\">Counting words in a string - c programming</a>"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1556094976, "post_id": 55825615, "comment_id": 98316469, "body": "Please post real code. What is <code>num_word</code>? And why are you redefining <code>INT_MAX</code>?"}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 3, "creation_date": 1556095017, "post_id": 55825615, "comment_id": 98316497, "body": "Betty, your logic has errors. If you step through the program with a debugger, they will be easy to find."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 1, "creation_date": 1556095381, "post_id": 55825615, "comment_id": 98316709, "body": "Unrelated. Try not to use standard-defined names. <code>INT_MAX</code> is defined by the standard in <code>&lt;limits.h&gt;</code>. If you need it, use <i>that</i>; don&#39;t make it up."}, {"owner": {"reputation": 706, "user_id": 6761184, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/89aba8d550e80edfe0c721440d4c5a98?s=128&d=identicon&r=PG&f=1", "display_name": "Davide Visentin", "link": "https://stackoverflow.com/users/6761184/davide-visentin"}, "edited": false, "score": 0, "creation_date": 1556097682, "post_id": 55825615, "comment_id": 98318156, "body": "The number of sentences is 2 because you don&#39;t count the last one (because there is not a <code>\\n</code> after it)."}, {"owner": {"reputation": 134, "user_id": 11131523, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-3O9ngZPKFGo/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdeFi7656jSqPOfPxvSdL-OboBLdg/mo/photo.jpg?sz=128", "display_name": "Igor Galczak", "link": "https://stackoverflow.com/users/11131523/igor-galczak"}, "edited": false, "score": 0, "creation_date": 1556097740, "post_id": 55825615, "comment_id": 98318193, "body": "Some like this:  <code>if is_whitespace then { word_count++, while(is_whitespace) {if char is NL then NL_count++, get_char}}</code>"}], "owner": {"reputation": 53, "user_id": 11304604, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fd5002538bece9fadc9516eda2a9995?s=128&d=identicon&r=PG&f=1", "display_name": "User21749", "link": "https://stackoverflow.com/users/11304604/user21749"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 91, "favorite_count": 0, "closed_date": 1556177826, "answer_count": 0, "score": 1, "last_activity_date": 1556095089, "creation_date": 1556094575, "last_edit_date": 1556095089, "question_id": 55825615, "link": "https://stackoverflow.com/questions/55825615/count-the-number-of-words-using-c", "closed_reason": "Duplicate", "title": "Count the number of words using C", "body": "<p>I'm writing a program that counts the number of words and the number of lines. I tried to count spaces and tabulators but it does not work. For example if the input is:</p>\n\n<pre><code>Hello..\\n \\tI love coding!\\n Do you?\n</code></pre>\n\n<p>The output will be 2 lines 4 words</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#define INT_MAX (100000000)\n\nint is_newline(int c) {\n\n    return (c =='\\n');\n\n}\nint is_word(int c){\n    return (c == ' ' || c == '\\t');\n}\nint main(void) {\n    int ch;\n    int num_words = 0;\n    int new_line = 0;\n\n    ch = getchar();\n    while (ch != EOF) {\n        if (is_word(ch)) {\n            num_words++;\n        }else if (is_newline(ch)) {\n            new_line++;\n            num_word++;\n        }\n        ch = getchar();\n    }\n    printf(\"The number of words is: %d\", num_words);\n    printf(\"The number of line is: %d\", new_line);\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "opengl"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user8704383"}, "edited": false, "score": 0, "creation_date": 1556095055, "post_id": 55825719, "comment_id": 98316513, "body": "Can you suggest a good site to learn these things? I used docs.gl, but it isn&#39;t that good. And the other sites I tried provide incomplete documentation"}, {"owner": {"reputation": 13520, "user_id": 2315602, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/8rKPi.jpg?s=128&g=1", "display_name": "lisyarus", "link": "https://stackoverflow.com/users/2315602/lisyarus"}, "edited": false, "score": 1, "creation_date": 1556095228, "post_id": 55825719, "comment_id": 98316612, "body": "@kesarling <code>docs.gl</code> is the best online reference available, but it is still just a reference. I&#39;d suggest finding some fairly modern tutorials (not books - those are usually outdated, to my experience). A good start would be <a href=\"http://antongerdelan.net/opengl/index.html\" rel=\"nofollow noreferrer\">antongerdelan.net/opengl/index.html</a>. For a solid &amp; deep resource, have a look at <a href=\"https://www.khronos.org/opengl/wiki/Main_Page\" rel=\"nofollow noreferrer\">khronos.org/opengl/wiki/Main_Page</a>, e.g. the <code>Rendering Pipeline</code> section."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8704383"}, "edited": false, "score": 0, "creation_date": 1556095361, "post_id": 55825719, "comment_id": 98316695, "body": "Thank a lot sir :)"}, {"owner": {"reputation": 13520, "user_id": 2315602, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/8rKPi.jpg?s=128&g=1", "display_name": "lisyarus", "link": "https://stackoverflow.com/users/2315602/lisyarus"}, "edited": false, "score": 1, "creation_date": 1556096109, "post_id": 55825719, "comment_id": 98317166, "body": "@kesarling I may be wrong, but I believe they don&#39;t have any special meaning: just standardized constant values for programmers &amp; OpenGL implementations to use."}, {"owner": {"reputation": 13520, "user_id": 2315602, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/8rKPi.jpg?s=128&g=1", "display_name": "lisyarus", "link": "https://stackoverflow.com/users/2315602/lisyarus"}, "edited": false, "score": 4, "creation_date": 1556096680, "post_id": 55825719, "comment_id": 98317528, "body": "@kesarling For a good reason: the actual values should be irrelevant to you. They are included in all OpenGL implementation headers (<code>GL.h</code> or similar), so that you don&#39;t write <code>glPolygonMode(0x1B00)</code>, but <code>glPolygonMode(GL_POINT)</code>."}], "tags": [], "owner": {"reputation": 13520, "user_id": 2315602, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/8rKPi.jpg?s=128&g=1", "display_name": "lisyarus", "link": "https://stackoverflow.com/users/2315602/lisyarus"}, "is_accepted": true, "score": 5, "last_activity_date": 1556095363, "last_edit_date": 1556095363, "creation_date": 1556094926, "answer_id": 55825719, "question_id": 55825588, "link": "https://stackoverflow.com/questions/55825588/what-is-the-difference-between-gl-points-and-gl-point/55825719#55825719", "title": "What is the difference between GL_POINTS and GL_POINT", "body": "<ul>\n<li><code>GL_POINTS</code> is a primitive type: it defines how vertices are grouped together. It is the <code>mode</code> parameter in commands such as <code>glDrawArrays</code>, <code>glDrawElements</code>, and other <code>glDraw...</code></li>\n<li><code>GL_POINT</code> is a rendering mode for polygons using in <code>glPolygonMode</code>. Normally, triangles are rasterized onto the framebuffer, filling the space between vertices. If one wishes to render only triangles' vertices or edges, this can be achieved by <code>glPolygonMode(GL_POINT)</code> or <code>glPolygonMode(GL_LINE)</code>, respectively.</li>\n</ul>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user8704383"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1451, "favorite_count": 0, "accepted_answer_id": 55825719, "answer_count": 1, "score": 6, "last_activity_date": 1584985792, "creation_date": 1556094485, "question_id": 55825588, "link": "https://stackoverflow.com/questions/55825588/what-is-the-difference-between-gl-points-and-gl-point", "title": "What is the difference between GL_POINTS and GL_POINT", "body": "<p>When I hover over to GL_POINTS, it shows </p>\n\n<p><code>#define GL_POINTS 0x0000</code></p>\n\n<p>and it falls under the category of primitives</p>\n\n<p>Similarly, GL_POINT falls under 'polygons' category and \nshows the descritption:</p>\n\n<p><code>#define GL_POINT 0x1B00</code></p>\n\n<p>there is no clear documentation available for GL_POINT, though there is for GL_POINTS (reference: docs.gl)</p>\n\n<p>Similarly, replacing either doesn't work</p>\n"}, {"tags": ["python", "c"], "answers": [{"comments": [{"owner": {"reputation": 375, "user_id": 4442337, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bbe9e435fd9bda82bd4cfab668eb8a7?s=128&d=identicon&r=PG&f=1", "display_name": "Barnercart", "link": "https://stackoverflow.com/users/4442337/barnercart"}, "edited": false, "score": 0, "creation_date": 1556095469, "post_id": 55825704, "comment_id": 98316774, "body": "Ok so essentially if I want to pass to stdin a one single string (ex.: &quot;\\x90\\x90\\x90\\x90[...]\\x90\\xeb\\x1f\\x5e\\x89\\x76\\x08\\x31\\xc0\\x&zwnj;&#8203;88\\x46\\x07\\x89\\x46\\x&zwnj;&#8203;0c\\xb0\\x0b\\x89\\xf3\\x&zwnj;&#8203;8d\\x4e\\x08\\x8d\\x56\\x&zwnj;&#8203;0c\\xcd\\x80\\x31\\xdb\\x&zwnj;&#8203;89\\xd8\\x40\\xcd\\x80\\x&zwnj;&#8203;e8\\xdc\\xff\\xff\\xff/b&zwnj;&#8203;in/sh\\x48\\xbf\\xff\\xf&zwnj;&#8203;fAA[...]AA, I can put this in a txt file and then do <code>.&#47;vuln_program &lt; mytext.txt</code> ? The thing is that I can do this manually (copy&amp;paste) but it doesn&#39;t get formatted into hexadecimal format but simple text string, while with <code>python -c print(&quot;\\x blabla&quot;)</code> it does."}, {"owner": {"reputation": 1175, "user_id": 412793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f6cb5deb68f38f3f4d7527ffab3127e?s=128&d=identicon&r=PG", "display_name": "varela", "link": "https://stackoverflow.com/users/412793/varela"}, "reply_to_user": {"reputation": 375, "user_id": 4442337, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bbe9e435fd9bda82bd4cfab668eb8a7?s=128&d=identicon&r=PG&f=1", "display_name": "Barnercart", "link": "https://stackoverflow.com/users/4442337/barnercart"}, "edited": false, "score": 0, "creation_date": 1556095754, "post_id": 55825704, "comment_id": 98316933, "body": "But you can have a binary file, your print message nothing else than conversion from hex symbols representation to actual bytes. If it&#39;s hard for you to prepare, then it&#39;s better to do what @blinkofaneye suggested."}], "tags": [], "owner": {"reputation": 1175, "user_id": 412793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f6cb5deb68f38f3f4d7527ffab3127e?s=128&d=identicon&r=PG", "display_name": "varela", "link": "https://stackoverflow.com/users/412793/varela"}, "is_accepted": false, "score": 1, "last_activity_date": 1556094896, "creation_date": 1556094896, "answer_id": 55825704, "question_id": 55825546, "link": "https://stackoverflow.com/questions/55825546/how-to-use-a-script-to-control-the-programs-input/55825704#55825704", "title": "How to use a script to control the program&#39;s input?", "body": "<p>Everything generated by python will be in arguments not in stdin. If you need to pass something to stdin you need to do: <code>./vuln_program &lt; file_with_stdin_data</code>\nit doesn't need python at all to put some defined data to input stream, you can have data in normal file.</p>\n\n<p>You can use python subprocess module to communicate with your script. Then you need to create subprocess and write something to its stdin. Check for <a href=\"https://docs.python.org/2/library/subprocess.html\" rel=\"nofollow noreferrer\">python doc</a> this:</p>\n"}, {"comments": [{"owner": {"reputation": 375, "user_id": 4442337, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bbe9e435fd9bda82bd4cfab668eb8a7?s=128&d=identicon&r=PG&f=1", "display_name": "Barnercart", "link": "https://stackoverflow.com/users/4442337/barnercart"}, "edited": false, "score": 0, "creation_date": 1556096071, "post_id": 55825839, "comment_id": 98317136, "body": "Nice, this seems to be the correct path to follow. But can I do this inside gdb aswell? If i go <code>gdb vuln</code> and then, inside the debugger, <code>python print &quot;exploit code&quot; | run</code> it doesn&#39;t work."}, {"owner": {"reputation": 148, "user_id": 11395874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bae32877b583cba2ccb7a78a398511bc?s=128&d=identicon&r=PG&f=1", "display_name": "blinkofaneye", "link": "https://stackoverflow.com/users/11395874/blinkofaneye"}, "reply_to_user": {"reputation": 375, "user_id": 4442337, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bbe9e435fd9bda82bd4cfab668eb8a7?s=128&d=identicon&r=PG&f=1", "display_name": "Barnercart", "link": "https://stackoverflow.com/users/4442337/barnercart"}, "edited": false, "score": 0, "creation_date": 1556096460, "post_id": 55825839, "comment_id": 98317398, "body": "I dont think you can do that. Try: python -c &quot;code&quot; | gdb --args ./vuln -ex=run"}, {"owner": {"reputation": 375, "user_id": 4442337, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bbe9e435fd9bda82bd4cfab668eb8a7?s=128&d=identicon&r=PG&f=1", "display_name": "Barnercart", "link": "https://stackoverflow.com/users/4442337/barnercart"}, "edited": false, "score": 0, "creation_date": 1556097007, "post_id": 55825839, "comment_id": 98317725, "body": "I found it I think. Once inside gdb, it&#39;s done with &quot;Here strings&quot;. <code>r &lt;&lt;&lt; $(python -c &quot;print(&#39;exploit code&#39;)&quot;)</code>. <a href=\"https://reverseengineering.stackexchange.com/questions/18552/run-a-python-command-with-run-on-gdb\">Run a python command with \u201crun\u201d on GDB</a>"}], "tags": [], "owner": {"reputation": 148, "user_id": 11395874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bae32877b583cba2ccb7a78a398511bc?s=128&d=identicon&r=PG&f=1", "display_name": "blinkofaneye", "link": "https://stackoverflow.com/users/11395874/blinkofaneye"}, "is_accepted": true, "score": 1, "last_activity_date": 1556095321, "creation_date": 1556095321, "answer_id": 55825839, "question_id": 55825546, "link": "https://stackoverflow.com/questions/55825546/how-to-use-a-script-to-control-the-programs-input/55825839#55825839", "title": "How to use a script to control the program&#39;s input?", "body": "<p>You can do something like</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>$ python -c \"exploit code\" | ./vuln\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 375, "user_id": 4442337, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bbe9e435fd9bda82bd4cfab668eb8a7?s=128&d=identicon&r=PG&f=1", "display_name": "Barnercart", "link": "https://stackoverflow.com/users/4442337/barnercart"}, "is_accepted": false, "score": 0, "last_activity_date": 1556097880, "creation_date": 1556097880, "answer_id": 55826673, "question_id": 55825546, "link": "https://stackoverflow.com/questions/55825546/how-to-use-a-script-to-control-the-programs-input/55826673#55826673", "title": "How to use a script to control the program&#39;s input?", "body": "<p>As @blinkofaneye said, the simplest solution is using <code>$ python -c \"exploit code\" | ./vuln</code></p>\n\n<p>If you have to do it inside GDB (like me) as already suggested in this question <a href=\"https://reverseengineering.stackexchange.com/questions/18552/run-a-python-command-with-run-on-gdb\">Run a python command with \u201crun\u201d on GDB</a>, the trick is to enter GDB and than use \"Here strings\":</p>\n\n<p><code>run &lt;&lt;&lt; $(python -c \"print('exploit code')\")</code></p>\n"}], "owner": {"reputation": 375, "user_id": 4442337, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bbe9e435fd9bda82bd4cfab668eb8a7?s=128&d=identicon&r=PG&f=1", "display_name": "Barnercart", "link": "https://stackoverflow.com/users/4442337/barnercart"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 55825839, "answer_count": 3, "score": 0, "last_activity_date": 1556097880, "creation_date": 1556094338, "question_id": 55825546, "link": "https://stackoverflow.com/questions/55825546/how-to-use-a-script-to-control-the-programs-input", "title": "How to use a script to control the program&#39;s input?", "body": "<p>I need to control the input of a simple program written in C. I'm working on a Linux virtual machine (it's a computer security challenge) and I'm using GDB to find a good exploit (in this case it's a buffer overflow). \nHere's the code:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>static const char KEY[] = \"BLOCKCHAIN\";\n\nvoid vuln(){\n    int i;\n    char buffer[616];\n\n    int output = fread(buffer, 1, 4*1024, stdin);\n\n    for (i = 0; i &lt; 616; i++) {\n      buffer[i] ^= KEY[i % sizeof(KEY)];\n    }  \n\n    printf(\"%s\\n\", buffer);\n}\n\nint main(int argc, char *argv[]){\n    vuln();\n    exit(0);\n}\n</code></pre>\n\n<p>The line I want to cover is <code>int output = fread(buffer, 1, 4*1024, stdin);</code>. Is there a way to control the input of that program (so the input stream) with a simple script? I want to do something like:</p>\n\n<pre><code>./vuln_program `python -c 'print(\"\\x90\"*923+\"\\xeb\\x1f\\x5e\\x89\\x76\\x08\\x31\\xc0\\x88\\x46\\x07\\x89\\x46\\x0c\\xb0\\x0b\\x89\\xf3\\x8d\\x4e\\x08\\x8d\\x56\\x0c\\xcd\\x80\\x31\\xdb\\x89\\xd8\\x40\\xcd\\x80\\xe8\\xdc\\xff\\xff\\xff/bin/sh\"+\"\\x48\\xbf\\xff\\xff\")'`\n</code></pre>\n\n<p>This works if It were an argument of the main but unfortunately I'm inside the vuln() function and can't do this. Professors suggested to use: Python's subprocess module, or read\\write from\\to a named pipe (mkfifo), or the process module of theuse the pwntools Python library but I don't know how to use them in this scenario. </p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["c", "embedded"], "comments": [{"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 4, "creation_date": 1556094418, "post_id": 55825514, "comment_id": 98316168, "body": "may be to show explicitly nothing has to be done in the else case ? Why you do not ask them ? ;-)"}, {"owner": {"reputation": 3478, "user_id": 9061264, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TPing.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/9061264/mike"}, "edited": false, "score": 2, "creation_date": 1556094946, "post_id": 55825514, "comment_id": 98316450, "body": "It&#39;s to fullfill MISRA rule 14.10"}], "owner": {"reputation": 563, "user_id": 7864336, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/8a2d64bf3ba8d5d7bc5d961075241343?s=128&d=identicon&r=PG&f=1", "display_name": "schanti schul", "link": "https://stackoverflow.com/users/7864336/schanti-schul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "closed_date": 1556095423, "answer_count": 0, "score": 3, "last_activity_date": 1556094241, "creation_date": 1556094241, "question_id": 55825514, "link": "https://stackoverflow.com/questions/55825514/adding-else-at-the-end-of-an-if-else-statement", "closed_reason": "Duplicate", "title": "Adding &quot;else&quot; at the end of an if-else statement", "body": "<p>Some of my co-workers tend to add an empty else at the end of the if-else statement. (even though no logic is implemented there)\nLike so:</p>\n\n<pre><code>if(X)\n{\n... // some logic\n}\nelse if(Y)\n{\n... // some logic\n}\nelse if(Z)\n{\n... // some logic\n}\nelse\n{ \n;\n}\n</code></pre>\n\n<p>what is the benefit of adding the last else with ';' inside?</p>\n"}, {"tags": ["c", "gcc", "cmd", "sdl-2", "mingw-w64"], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 11058076, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Qc1a3huNEzM/AAAAAAAAAAI/AAAAAAAAADQ/deIq4BhaZno/photo.jpg?sz=128", "display_name": "Eya Osmane", "link": "https://stackoverflow.com/users/11058076/eya-osmane"}, "edited": false, "score": 0, "creation_date": 1556096357, "post_id": 55825602, "comment_id": 98317329, "body": "thank u very much it worked  and i dont fint the error anymore but i still have problem with it  because in code blocks there is indefined reference to sdl.h"}, {"owner": {"reputation": 15, "user_id": 11058076, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Qc1a3huNEzM/AAAAAAAAAAI/AAAAAAAAADQ/deIq4BhaZno/photo.jpg?sz=128", "display_name": "Eya Osmane", "link": "https://stackoverflow.com/users/11058076/eya-osmane"}, "edited": false, "score": 0, "creation_date": 1556096403, "post_id": 55825602, "comment_id": 98317363, "body": "fatal error: SDL.h: No such file or directory"}], "tags": [], "owner": {"reputation": 896, "user_id": 6659361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/200d3e89398030d70445b9a3f071c385?s=128&d=identicon&r=PG&f=1", "display_name": "Maxime B.", "link": "https://stackoverflow.com/users/6659361/maxime-b"}, "is_accepted": false, "score": 1, "last_activity_date": 1556094522, "creation_date": 1556094522, "answer_id": 55825602, "question_id": 55825488, "link": "https://stackoverflow.com/questions/55825488/sdl-goes-only-with-main-and-ignores-the-other-c-and-h-files-i-have-in-my-progr/55825602#55825602", "title": "SDL goes only with main and ignores the other .c and .h files i have in my program", "body": "<p>Your problem has nothing to do with SDL.</p>\n\n<p>You just need to pass to GCC the list of .c file your project uses. This can be done with the wildcard (*) operator.</p>\n\n<p><code>gcc src/*.c -o bin/prog -I include -L lib -lmingw32 -lSDL2main -lSDL2</code></p>\n\n<p>Or by explicitely including the files</p>\n\n<p><code>gcc src/a.c src/b.c src/main.c -o bin/prog -I include -L lib -lmingw32 -lSDL2main -lSDL2</code></p>\n"}], "owner": {"reputation": 15, "user_id": 11058076, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Qc1a3huNEzM/AAAAAAAAAAI/AAAAAAAAADQ/deIq4BhaZno/photo.jpg?sz=128", "display_name": "Eya Osmane", "link": "https://stackoverflow.com/users/11058076/eya-osmane"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "closed_date": 1556128521, "answer_count": 1, "score": -3, "last_activity_date": 1556096887, "creation_date": 1556094154, "last_edit_date": 1556096887, "question_id": 55825488, "link": "https://stackoverflow.com/questions/55825488/sdl-goes-only-with-main-and-ignores-the-other-c-and-h-files-i-have-in-my-progr", "closed_reason": "Duplicate", "title": "SDL goes only with main and ignores the other .c and .h files i have in my program", "body": "<p>i'm trying to use SDL with my c project actualy it's a multi file project connected to each other so when i installed sdl i found a problem that sdl doesn't connect with other files it only connect with main and i find this error \nC:\\Users\\EYAOSM~1\\AppData\\Local\\Temp\\ccoI9IBj.o:main.c:(.text+0x7): undefined reference to `lstcltcreer'\nwith all the functions i have outside of main in the other files</p>\n\n<p>i used this to connect sdl to main</p>\n\n<p>C:\\Users\\Eya Osmane\\Desktop\\prooooojjjjj>gcc src/*main.c -o bin/prog -I include -L lib -lmingw32 -lSDL2main -lSDL2</p>\n\n<p>this is the structure of my program</p>\n\n<p>src contains the main and the other files i wrote</p>\n\n<p>and the other files bin include lib and obj are sdl files</p>\n\n<p>and all these files are plased in projjjjj which is in my desktop</p>\n"}, {"tags": ["c", "linux", "segmentation-fault", "ncurses"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 1, "creation_date": 1556095366, "post_id": 55825477, "comment_id": 98316699, "body": "What does your debugger say? Which statement crashes?"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1556097756, "post_id": 55825477, "comment_id": 98318200, "body": "<code>set_item_userptr(my_items[i], func);</code> to be the basis of compiler complaints, e.g. <code>&quot;note: expected \u2018void *\u2019 but argument is of type \u2018void (*)(char *)&quot;</code>"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1556102469, "post_id": 55825477, "comment_id": 98320879, "body": "You are passing a function pointer where a character pointer is expected. How should this work? <code>void*</code> is only compatible to data pointers, not code."}, {"owner": {"reputation": 33, "user_id": 5735125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79258bc4c42e58eb74b8ba1390ae789f?s=128&d=identicon&r=PG&f=1", "display_name": "lgaudino", "link": "https://stackoverflow.com/users/5735125/lgaudino"}, "edited": false, "score": 0, "creation_date": 1556111310, "post_id": 55825477, "comment_id": 98326226, "body": "I&#39;m sorry, until 10 days ago I never coded anything in C. I don&#39;t know how to use a debugger, but will try. Anyway, I figured out that crash happens at line 83, at new_menu().  Compiled with <code>gcc -lmenu -lncurses</code> always compiles without errors, but if *choices contains 3 or 7 items then segfault happens. For any other size, everithing works.   Running on debian buster: <code>4.19.0-2-686 #1 SMP Debian 4.19.16-1 (2019-01-17) i686 GNU&#47;Linux</code>"}, {"owner": {"reputation": 33, "user_id": 5735125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79258bc4c42e58eb74b8ba1390ae789f?s=128&d=identicon&r=PG&f=1", "display_name": "lgaudino", "link": "https://stackoverflow.com/users/5735125/lgaudino"}, "edited": false, "score": 0, "creation_date": 1556112379, "post_id": 55825477, "comment_id": 98327041, "body": "I&#39;ve seen now that in the &quot;example 18. Menu basics&quot; on the linked page <a href=\"http://tldp.org/HOWTO/NCURSES-Programming-HOWTO/menus.html\" rel=\"nofollow noreferrer\">tldp.org</a> there is a <code>n_choices + 1</code> in the <code>calloc()</code> call:  ``` n_choices = ARRAY_SIZE(choices); my_items = (ITEM **)calloc(n_choices + 1, sizeof(ITEM *)); ```  Maybe the author had the same error and decided to allocate some extra memory? But why 3 and 7 are &quot;special&quot; size and trig the segfault?"}], "answers": [{"tags": [], "owner": {"reputation": 6899, "user_id": 1212012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gmBY7.png?s=128&g=1", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1212012/mathieu"}, "is_accepted": true, "score": 2, "last_activity_date": 1556114880, "last_edit_date": 1592644375, "creation_date": 1556114880, "answer_id": 55832084, "question_id": 55825477, "link": "https://stackoverflow.com/questions/55825477/why-a-segmentation-fault-happens-only-when-array-of-choices-is-3-or-7-elements/55832084#55832084", "title": "Why a segmentation fault happens only when array of choices is 3 or 7 elements?", "body": "<blockquote>\n<p>Maybe the author had the same error and decided to allocate some extra memory? But why 3 and 7 are &quot;special&quot; size and trig the segfault?</p>\n</blockquote>\n<p>No, this is <em>wanted</em> by <code>new_menu</code> function:</p>\n<p>The <code>new_menu</code> function expects that the <code>items</code>  list to be terminated by a <code>NULL</code> element.</p>\n<p>If you read <code>new_menu</code> documentation (<a href=\"ftp://ftp.invisible-island.net/ncurses/current/ncurses-6.1-20190302.tgz\" rel=\"nofollow noreferrer\">menu_new.3x.html</a>), you can see:</p>\n<blockquote>\n<p><strong>SYNOPSIS</strong></p>\n<p><code>#include &lt;menu.h&gt;</code> <br>\n<code>MENU *new_menu(ITEM **items);</code></p>\n<p><strong>DESCRIPTION</strong></p>\n<p><code>The  function new_menu creates a new menu connected to a specified item</code> <br>\n<code>pointer array </code><strong><code>(which must be NULL-terminated)</code></strong><code>.</code></p>\n</blockquote>\n<hr />\n<p>So the crash you see in 3 and 7 case is -I think- related to how are stored the data in memory. One thing you can do is to dump the <code>my_items</code> memory + one element to a file just before calling the <code>new_menu</code> function.</p>\n<p>I guess you will have some 0 value just after the elements but not in 3 and 7 cases. (My guess some 4-multiple callocation effect)</p>\n"}], "owner": {"reputation": 33, "user_id": 5735125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79258bc4c42e58eb74b8ba1390ae789f?s=128&d=identicon&r=PG&f=1", "display_name": "lgaudino", "link": "https://stackoverflow.com/users/5735125/lgaudino"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 176, "favorite_count": 0, "accepted_answer_id": 55832084, "answer_count": 1, "score": 2, "last_activity_date": 1556114880, "creation_date": 1556094128, "last_edit_date": 1556112903, "question_id": 55825477, "link": "https://stackoverflow.com/questions/55825477/why-a-segmentation-fault-happens-only-when-array-of-choices-is-3-or-7-elements", "title": "Why a segmentation fault happens only when array of choices is 3 or 7 elements?", "body": "<p>I'm a beginner in C and trying to develop a small software in ncurses, with menu driven interface. I have this code, that is from <a href=\"http://tldp.org/HOWTO/NCURSES-Programming-HOWTO/menus.html\" rel=\"nofollow noreferrer\">http://tldp.org/HOWTO/NCURSES-Programming-HOWTO/menus.html</a>.</p>\n\n<p>I don't understand why if I initialize an array of choices of 3 or 7 items the program goes segfault, but is fine if the array is any other size.</p>\n\n<p>Here is the code. If adding 1 to n_choices or calloc() call, then segmentation fault doesn't happen. i.e.</p>\n\n<pre><code>my_items = (ITEM **)calloc(n_choices + 1, sizeof(ITEM *));\n</code></pre>\n\n<p>Why 3 and 7 are \"special\"???</p>\n\n<pre><code>#include &lt;ncurses.h&gt;\n#include &lt;string.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;termios.h&gt;\n#include &lt;menu.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n\n#define ARRAY_SIZE(a) (sizeof(a) / sizeof(a[0]))\n\nWINDOW *mywin;\nint rows, cols, h, w, starty, startx;\nint wybeg, wxbeg, wymax, wxmax;\n\n// choices\nchar *choices[] = {\n    \"Choice 1\",\n    \"Choice 2\",\n    \"Choice 3\",\n    \"Choice 4\",\n    \"Choice 5\",\n    \"Choice 6\",\n    \"Choice 7\",\n};\nvoid func(char*);\n\nint main(int argc, char** argv)\n{\n    ITEM **my_items;\n    int c;              \n    MENU *my_menu;\n    int n_choices, i;\n    ITEM *cur_item;\n\n    initscr(); //creates stdscr\n    cbreak();\n    noecho();\n    curs_set(0);\n    keypad(stdscr, TRUE);\n\n    if(has_colors() == TRUE){\n        start_color();\n        init_pair(1,COLOR_YELLOW,COLOR_BLUE);\n    }\n\n    getmaxyx(stdscr, rows, cols);\n    h = rows-4;\n    w = cols;\n    starty = 1;\n    startx = 0;\n\n    char quitHint[] = \"&lt;Press q to exit&gt;\";\n\n    move(0,0);\n    mvprintw(LINES-1, COLS-1-strlen(quitHint), \"%s\", quitHint);\n    refresh();\n\n    mywin = newwin(h,w,starty,startx);\n    keypad(mywin,TRUE);\n    box(mywin,0,0);\n    wbkgd(mywin,COLOR_PAIR(1));\n    wrefresh(mywin);\n\n    // MENU\n    /* Create items */\n    /**************************/\n    /* FROM HERE IS THE POINT */\n    /**************************/\n    // if choices is 3 or 7 elements, segfault occurs! If adding +1 n_choices segfault doesn't occur\n    n_choices = ARRAY_SIZE(choices);\n    my_items = (ITEM **)calloc(n_choices, sizeof(ITEM *));\n    for(i = 0; i &lt; n_choices; ++i){\n        my_items[i] = new_item(choices[i], choices[i]);\n        /* Set the user pointer */\n        set_item_userptr(my_items[i], func);\n    }\n\n    mvprintw(LINES-2,2,\"sizeof(choices) = %3d | sizeof(*choices) = %3d | n_choices = %3d\", sizeof(choices), sizeof(*choices), n_choices);\n\n    /* Create menu */\n    my_menu = new_menu((ITEM **)my_items);\n\n    /* Set main window and sub window */\n    set_menu_win(my_menu, mywin);\n    set_menu_sub(my_menu, derwin(mywin, n_choices, 38, 2, 2));\n\n    /* Set menu mark to the string \" * \" */\n    set_menu_mark(my_menu, \" * \");\n    refresh();\n\n    set_menu_fore(my_menu, COLOR_PAIR(1) | A_REVERSE);  // selected\n    set_menu_back(my_menu, COLOR_PAIR(1));                          // unselected\n\n    /* Post the menu */\n    post_menu(my_menu);\n    wrefresh(mywin);\n\n    while((c = wgetch(mywin)) != 'q')\n    {\n        switch(c)\n        {   case KEY_DOWN:\n                menu_driver(my_menu, REQ_DOWN_ITEM);\n                break;\n        case KEY_UP:\n            menu_driver(my_menu, REQ_UP_ITEM);\n            break;\n        case 10: /* enter */\n        {\n            /* execute func() from item pointer */\n            ITEM *cur;\n            void (*p) (char *);\n\n            cur = current_item(my_menu);\n            p = item_userptr(cur);\n            p((char *)item_name(cur));\n            pos_menu_cursor(my_menu);\n            break;\n        }\n        }\n        wrefresh(mywin);\n    }\n\n    /* Unpost and free all the memory taken up */\n    unpost_menu(my_menu);\n    free_menu(my_menu);\n    for(i = 0; i &lt; n_choices; ++i){\n        free_item(my_items[i]);\n    }\n\n    endwin();\n    return EXIT_SUCCESS;\n}\n\nvoid func(char *local_choice){  \n    mvwprintw(mywin,h-2, 2, \"Item selected is : %s\", local_choice);\n    wclrtoeol(mywin);\n    box(mywin,0,0);\n    wrefresh(mywin);\n}   \n</code></pre>\n\n<p>Compiled with <code>gcc -lmenu -lncurses</code></p>\n\n<p>Running Debian Buster <code>4.19.0-2-686 #1 SMP Debian 4.19.16-1 (2019-01-17) i686 GNU/Linux</code></p>\n"}, {"tags": ["c", "return-value"], "comments": [{"owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "edited": false, "score": 2, "creation_date": 1556094450, "post_id": 55825473, "comment_id": 98316186, "body": "It&#39;s undefined behavior. For me, it prints <code>1</code>. Anything can happen and there&#39;s no guarantee whatsoever. What might happen is that it just takes some random rubbish value on the stack."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 2, "creation_date": 1556095381, "post_id": 55825473, "comment_id": 98316711, "body": "We do not run such programs very often because we use high warning settings with our compilers."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1556095953, "post_id": 55825473, "comment_id": 98317051, "body": "Which discloses the problem immediately telling the programmer (who is not consciously disregarding the warnings emitted by the compiler) exactly where problem areas in the code lie that should be fixed before proceeding further."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1556096129, "post_id": 55825473, "comment_id": 98317181, "body": "@n.m. Or maybe we were taught how to create undefined behavior from reading the K&amp;R book, first code example: <code>main() { printf(&quot;hello, world\\n&quot;); }</code>. This was written fom C90 so no implicit return 0..."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1556096820, "post_id": 55825473, "comment_id": 98317621, "body": "@n.m. Nope, it is special now. It wasn&#39;t when K&amp;R was written. We have to assume that the caller (OS) might use the return code from the program."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1556097297, "post_id": 55825473, "comment_id": 98317911, "body": "@Lundin it isn&#39;t undefined now, and wasn&#39;t undefined in C90. &quot;If the main function executes a return that specifies no value, the termination status returned to the host environment is undefined.&quot; This is not the same as &quot;undefined behaviour&quot;."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1556097627, "post_id": 55825473, "comment_id": 98318116, "body": "@n.m. It is. Any occurrence of the word &quot;undefined&quot; in the C standard has a special meaning, to point out undefined behavior. Same goes with unspecified and implementation-defined/&quot;defined by the implementation&quot;. These are formal terms."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1556097805, "post_id": 55825473, "comment_id": 98318230, "body": "@Lundin &quot;Any occurrence of the word &quot;undefined&quot; in the C standard has a special meaning, to point out undefined behavior&quot;. I&#39;m not sure where you are getting this from."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1556099545, "post_id": 55825473, "comment_id": 98319234, "body": "@n.m. There&#39;s an absence of defined behavior =&gt; UB."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1556100829, "post_id": 55825473, "comment_id": 98319948, "body": "@melpomene I do not subscribe to this interpretation. The intent is obviously different from making the behaviour undefined, otherwise the standard would just use the words &quot;undefined behaviour&quot; like everywhere else. It certainly was not an intent of K&amp;R to make this behaviour undefined, and the standard has codified existing practice. The termination status returned to the host environment is not a part of the abstract C machine description anyway."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1556101233, "post_id": 55825473, "comment_id": 98320176, "body": "@n.m. The description of <code>exit</code> defines the meaning of <code>0</code>, <code>EXIT_SUCCESS</code>, and <code>EXIT_FAILURE</code>. Any other value is described as implementation-defined (not &quot;undefined&quot;). I think the authors of the standard intended falling off the end of <code>main</code> to have undefined behavior, otherwise they&#39;d have said &quot;unspecified&quot;."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1556102066, "post_id": 55825473, "comment_id": 98320668, "body": "@melpomene &quot;I think the authors of the standard intended falling off the end of main to have undefined behavior&quot;. I don&#39;t think so. It is utterly irrelevant anyway because the former standard in which the wording appears is superseded by newer standards and is only of historical interest today."}], "answers": [{"tags": [], "owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "is_accepted": false, "score": 5, "last_activity_date": 1556095811, "last_edit_date": 1556095811, "creation_date": 1556095212, "answer_id": 55825810, "question_id": 55825473, "link": "https://stackoverflow.com/questions/55825473/what-happens-when-we-do-not-use-return-statement-in-the-calling-function-in-c/55825810#55825810", "title": "What happens when we do not use return statement in the calling function in C?", "body": "<p>See 6.9.1 (Function definitions) / 12 in <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf\" rel=\"nofollow noreferrer\">the C11 draft standard</a> (the same language appears in C99):</p>\n\n<blockquote>\n  <ol start=\"12\">\n  <li>If the <code>}</code> that terminates a function is reached, and the value of the function call is used by the caller, the behavior is undefined.</li>\n  </ol>\n</blockquote>\n\n<p>(In C90 there was mostly equivalent language in 6.6.6.4 (The <code>return</code> statement):</p>\n\n<blockquote>\n  <p>If a <code>return</code> statement without an expression is executed, and the value of the function call is used by the caller, the behavior is undefined. Reaching the <code>}</code> that terminates a function is equivalent to executing a <code>return</code> statement without an expression.</p>\n</blockquote>\n\n<p>The difference is that (from C99 on) having <code>return;</code> with no expression in a non-void function is an error.)</p>\n\n<p>In your case the <code>}</code> of <code>sum</code> is reached (no <code>return</code> statement was executed) and the return value is used:</p>\n\n<pre><code>res=sum(1,2);\n</code></pre>\n\n<p>Therefore your code has undefined behavior: Anything can happen, from a garbage value in <code>res</code> to an infinite loop or crash.</p>\n"}, {"tags": [], "owner": {"reputation": 33597, "user_id": 2445184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/0b51ece74c2314ba345a862c4b00d804?s=128&d=identicon&r=PG", "display_name": "cmaster - reinstate monica", "link": "https://stackoverflow.com/users/2445184/cmaster-reinstate-monica"}, "is_accepted": false, "score": 0, "last_activity_date": 1556099073, "creation_date": 1556099073, "answer_id": 55827080, "question_id": 55825473, "link": "https://stackoverflow.com/questions/55825473/what-happens-when-we-do-not-use-return-statement-in-the-calling-function-in-c/55827080#55827080", "title": "What happens when we do not use return statement in the calling function in C?", "body": "<p><a href=\"https://stackoverflow.com/a/55825810/2445184\">melpomene's answer</a> is 100% correct from the pure language point of view: Returning from a non-void function without a return value invariably results in undefined behavior. After that, all bets are off.</p>\n\n<p>I'm going to add to this, what is <em>likely</em> going to happen:</p>\n\n<p>When you call a function, the compiler has a set of rules that it follows on how the parameters and return value are passed to the callee. These rules are along the lines of \"If the first argument is an integral type, put it into register <code>eax</code> before invoking the callee\". So, if you say <code>foo(42)</code>, the compiler emits code to load <code>42</code> into the register <code>eax</code>, and then to call <code>foo</code>, which then just examines the value it finds in register <code>eax</code> to know what was passed.</p>\n\n<p>The same happens for the return value. There is a defined place where the caller expects the return value (this may be a register or a memory location on the stack), and it's the callee's obligation to actually put a sensible value there.</p>\n\n<p>So, when you forget to name a return value, <strong>the return value will simply not be set. Whatever happens to be in the respective register / memory location will be <em>interpreted</em> as the return value by the caller.</strong> What exactly is effectively \"passed back\" to the caller depends 100% on how the callee happens to be compiled, and it may be deterministic. Consider this code snippet:</p>\n\n<pre><code>int getSecret() {\n    return 42;\n}\n\nint checkSecret(int guess) {\n    int secret = getSecret();\n    //return secret == guess;\n}\n\nint main() {\n    printf(\"The secret is %d.\\n\", checkSecret(0));\n}\n</code></pre>\n\n<p>If you compile and run this code, you may find that it correct prints the secret value <code>42</code>. Why? Simple: When <code>getSecret()</code> returns the secret value, it places it where <code>checkSecret()</code> expects to find the return value. And this may happen to be the same register as where <code>main()</code> expects to find the return value of <code>checkSecret()</code>.</p>\n\n<p>From the language perspective, that's perfectly ok: When <code>checkSecret()</code> returns without setting a return value, the language allows anything to happen, including leaking the secret. <strong>This is why forgetting the return value can be a security hole</strong>. It may allow an attacker to either extract information that they are not supposed to know, or to trigger code execution paths that are impossible in correct behavior because a function \"returns\" a value that's not within the expected return value range.</p>\n"}], "owner": {"reputation": 19, "user_id": 6096811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a49ab6c02048d490b6e152984e6dca9e?s=128&d=identicon&r=PG&f=1", "display_name": "user6096811", "link": "https://stackoverflow.com/users/6096811/user6096811"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 411, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1556099073, "creation_date": 1556094106, "last_edit_date": 1556095263, "question_id": 55825473, "link": "https://stackoverflow.com/questions/55825473/what-happens-when-we-do-not-use-return-statement-in-the-calling-function-in-c", "title": "What happens when we do not use return statement in the calling function in C?", "body": "<p>I would like to know the output of the below program. Main concern is what happens when we do not use return statement in the calling function?</p>\n\n<pre><code>int sum(int x, int y)\n{\n    //return x+y; \n}\n\nint main()\n{\n    int res=0;\n    res=sum(1,2);\n    printf(\"res = %d\\n\",res);\n}\n</code></pre>\n\n<p>in the above function <code>sum()</code>, if I use <code>return x+y</code>; it will print 3 as output?</p>\n\n<p>What happens if I do not use return statement?</p>\n"}, {"tags": ["c", "linux"], "comments": [{"owner": {"reputation": 91, "user_id": 4744023, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/23353fc4a04cdfb62316ce5bd00e700d?s=128&d=identicon&r=PG&f=1", "display_name": "darude_cod3r", "link": "https://stackoverflow.com/users/4744023/darude-cod3r"}, "edited": false, "score": 1, "creation_date": 1556091438, "post_id": 55824614, "comment_id": 98314508, "body": "could you please provide a source?"}, {"owner": {"reputation": 2449, "user_id": 500276, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/200bf76976f24add540182f5c3a42788?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Benningfield", "link": "https://stackoverflow.com/users/500276/mark-benningfield"}, "edited": false, "score": 2, "creation_date": 1556097958, "post_id": 55824614, "comment_id": 98318312, "body": "Isn&#39;t the kernel up to 5.0 at last glance? If I&#39;m not mistaken, the cited version is 10 or 11 years old."}, {"owner": {"reputation": 91, "user_id": 11403803, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-52W-kOzQ7wE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rd3WHzRs9W6E_zipocqRh_48vSTHg/mo/photo.jpg?sz=128", "display_name": "SmallTiger Lin", "link": "https://stackoverflow.com/users/11403803/smalltiger-lin"}, "edited": false, "score": 3, "creation_date": 1556100190, "post_id": 55824614, "comment_id": 98319585, "body": "why not forget the kernel, and focus on &quot;why +0&quot; from the viewpoint of C programming\uff1f"}], "answers": [{"tags": [], "owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "is_accepted": false, "score": 5, "last_activity_date": 1556108054, "creation_date": 1556108054, "answer_id": 55829796, "question_id": 55824614, "link": "https://stackoverflow.com/questions/55824614/in-linux-kernel-2-6-26-i-found-define-atomic-readv-v-counter-0-why/55829796#55829796", "title": "In linux kernel 2.6.26, i found &quot;#define atomic_read(v) ((v)-&gt;counter + 0)&quot;, why &quot;+0&quot;?", "body": "<p>It prevents the result from being an lvalue, so you can't wrongly assign to it or take its address.</p>\n"}, {"tags": [], "owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "is_accepted": false, "score": 9, "last_activity_date": 1556109079, "last_edit_date": 1556109079, "creation_date": 1556108122, "answer_id": 55829820, "question_id": 55824614, "link": "https://stackoverflow.com/questions/55824614/in-linux-kernel-2-6-26-i-found-define-atomic-readv-v-counter-0-why/55829820#55829820", "title": "In linux kernel 2.6.26, i found &quot;#define atomic_read(v) ((v)-&gt;counter + 0)&quot;, why &quot;+0&quot;?", "body": "<p>If <code>+ 0</code> is not used, it would be an lvalue that you could assign to by accident, i.e. </p>\n\n<pre><code>if (atomic_read(v) = 42) {\n    ...\n}\n</code></pre>\n\n<p>would \"work\"... Instead of <code>+ 0</code> you could just use unary <code>+</code>, i.e.</p>\n\n<pre><code>(+(v)-&gt;counter)\n</code></pre>\n\n<p>However <code>+ 0</code> has <em>one</em> good advantage over <code>+</code> in generic case: <code>+</code> requires that the argument be an <em>arithmetic type</em> - but pointers are not of arithmetic type. Yet <code>+ 0</code> would work for pointers alike (and for pointers alone, you can use <code>&amp;*</code> to convert lvalue to a value of expression; this is guaranteed to work for even null pointers)</p>\n"}, {"comments": [{"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1556109325, "post_id": 55829857, "comment_id": 98325015, "body": "Unlikely, why not change the <code>v</code> to <code>val</code> or similar instead of changing the functionality"}, {"owner": {"reputation": 24693, "user_id": 10190237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f95f50f67af8a9658c5d76df263b323?s=128&d=identicon&r=PG&f=1", "display_name": "P.W", "link": "https://stackoverflow.com/users/10190237/p-w"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1556109801, "post_id": 55829857, "comment_id": 98325290, "body": "I had considered this before posting the answer and tested this on different compilers. MSVC does not complain if just the parameter is changed. See: <a href=\"https://godbolt.org/z/ybSe58\" rel=\"nofollow noreferrer\">godbolt.org/z/ybSe58</a>"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1556112130, "post_id": 55829857, "comment_id": 98326838, "body": "I am not surprised that MSV&quot;C&quot; does not give any diagnostics. C89: &quot;An identifier currently defined as a macro using lparen (a function-like macro) may be redefined by another #define preprocessing directive provided that the second definition is a function-like macro definition <b>that has the same number and spelling of parameters</b>, and the two replacement lists are identical.&quot; and that is in constraints."}], "tags": [], "owner": {"reputation": 24693, "user_id": 10190237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f95f50f67af8a9658c5d76df263b323?s=128&d=identicon&r=PG&f=1", "display_name": "P.W", "link": "https://stackoverflow.com/users/10190237/p-w"}, "is_accepted": true, "score": 6, "last_activity_date": 1556175931, "last_edit_date": 1556175931, "creation_date": 1556108236, "answer_id": 55829857, "question_id": 55824614, "link": "https://stackoverflow.com/questions/55824614/in-linux-kernel-2-6-26-i-found-define-atomic-readv-v-counter-0-why/55829857#55829857", "title": "In linux kernel 2.6.26, i found &quot;#define atomic_read(v) ((v)-&gt;counter + 0)&quot;, why &quot;+0&quot;?", "body": "<p>It is possible that the <code>+ 0</code> was added for the compiler to issue a diagnostic in case there was a redefinition of the function-like macros <code>atomic_read</code> and <code>atomic64_read</code>.</p>\n\n<p>As per the C standard it is possible to redefine an identifier which is a function-like macro if the second definition is a also function-like macro that has the same number and spelling of parameters, and the two replacement lists are identical.</p>\n\n<p>From C11 standard (n1570), section <a href=\"https://port70.net/~nsz/c/c11/n1570.html#6.10.3p2\" rel=\"nofollow noreferrer\">6.10.3/2</a>:</p>\n\n<blockquote>\n  <p>... Likewise, an identifier currently defined as a function-like macro shall not be redefined by another <code>#define</code> preprocessing directive unless the second definition is a function-like macro definition that has the same number and spelling of parameters, and the two replacement lists are identical.</p>\n</blockquote>\n\n<p>The kernel version (2.6.26) is quite old but similar prohibition on such redefinition can be found in older standards upto the C89 standard.</p>\n\n<p>Currently the macros <code>atomic_read</code> and <code>atomic64_read</code> are defined in the file <code>atomic.h</code>.</p>\n\n<p>If the user would redefine them in some source file as below:</p>\n\n<pre><code>#define atomic_read(v)      (v)-&gt;counter \n</code></pre>\n\n<p>The compiler would issue a diagnostic about the redefinition. This warning is issued because there is a <code>+ 0</code> in the definition <code>atomic_read</code> of in the <code>atomic.h</code> file. </p>\n\n<p>If it were not for the <code>+ 0</code>, the compiler would not have issued a diagnostic.</p>\n\n<p>A minimal example to demonstrate this issue:</p>\n\n<pre><code>//atomic.h\n#define atomic_read(v)      ((v)-&gt;counter + 0)\n#define atomic64_read(v)    ((v)-&gt;counter)\n\n//some source file that includes atomic.h\n#define atomic_read(v)      ((v)-&gt;counter) //redefinition error \n#define atomic64_read(v)    ((v)-&gt;counter) //no redefinition error \n</code></pre>\n\n<p>See <a href=\"https://godbolt.org/z/55Rl-u\" rel=\"nofollow noreferrer\">Demo</a></p>\n"}], "owner": {"reputation": 91, "user_id": 11403803, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-52W-kOzQ7wE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rd3WHzRs9W6E_zipocqRh_48vSTHg/mo/photo.jpg?sz=128", "display_name": "SmallTiger Lin", "link": "https://stackoverflow.com/users/11403803/smalltiger-lin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 299, "favorite_count": 4, "accepted_answer_id": 55829857, "answer_count": 3, "score": 8, "last_activity_date": 1556175931, "creation_date": 1556091200, "question_id": 55824614, "link": "https://stackoverflow.com/questions/55824614/in-linux-kernel-2-6-26-i-found-define-atomic-readv-v-counter-0-why", "title": "In linux kernel 2.6.26, i found &quot;#define atomic_read(v) ((v)-&gt;counter + 0)&quot;, why &quot;+0&quot;?", "body": "<p>I found this in linux-2.6.26 (linux-2.6.26/include/asm-alpha/atomic.h), and donot know why +0 here.</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#define atomic_read(v)      ((v)-&gt;counter + 0)\n#define atomic64_read(v)    ((v)-&gt;counter + 0)\n</code></pre>\n"}, {"tags": ["c", "recursion", "linked-list", "segmentation-fault"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1556091164, "post_id": 55824550, "comment_id": 98314375, "body": "I suggest you do some <a href=\"https://en.wikipedia.org/wiki/Rubber_duck_debugging\" rel=\"nofollow noreferrer\">rubber duck debugging of your code</a>."}, {"owner": {"reputation": 114, "user_id": 4036405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f09172a38eba3035207878fef8c221e9?s=128&d=identicon&r=PG&f=1", "display_name": "renga_in_stack", "link": "https://stackoverflow.com/users/4036405/renga-in-stack"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 1, "creation_date": 1556091329, "post_id": 55824550, "comment_id": 98314458, "body": "@KamilCuk: Shall you try run now with the updated code."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1556091676, "post_id": 55824550, "comment_id": 98314629, "body": "You have <b><i>multiple</i></b> null-pointer dereferences."}, {"owner": {"reputation": 401, "user_id": 7926640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15aaf0885ac6a86de3d42c23139abdb2?s=128&d=identicon&r=PG&f=1", "display_name": "stensal", "link": "https://stackoverflow.com/users/7926640/stensal"}, "edited": false, "score": 0, "creation_date": 1556141507, "post_id": 55824550, "comment_id": 98341612, "body": "Your code has a null pointer dereference errror. a live test of your code is here: <a href=\"https://segfault.stensal.com/a/4D4944dmmS9BarL1\" rel=\"nofollow noreferrer\">segfault.stensal.com/a/4D4944dmmS9BarL1</a>   You can fix it and test it again."}], "answers": [{"tags": [], "owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "is_accepted": false, "score": 4, "last_activity_date": 1556092738, "last_edit_date": 1556092738, "creation_date": 1556091318, "answer_id": 55824646, "question_id": 55824550, "link": "https://stackoverflow.com/questions/55824550/getting-segmentation-fault-when-trying-to-print-linked-list-data-reversely-using/55824646#55824646", "title": "Getting segmentation fault when trying to print linked list data reversely using recursion", "body": "<p>Consider you are at the last node.</p>\n\n<pre><code>//temp = temp-&gt;next; /* This and next line together*/\n//print_list_reversely(temp); /* Causing SEGFAULT */\nprintf(\"data is %c\\n\", temp-&gt;c);\n</code></pre>\n\n<p>You assign <code>tmp</code> to <code>NULL</code> and you try to print it causing <code>NULL</code> pointer dereference. </p>\n\n<hr>\n\n<p>Consider you have list as below</p>\n\n<pre><code>1-&gt;2-&gt;NULL\n</code></pre>\n\n<p>And your recurssion calls are</p>\n\n<pre><code>print_list_reversely(1)\n           tmp = [2]\n                 ---&gt;      print_list_reversely(2)\n                           tmp = [NULL]\n                                          ---&gt;      print_list_reversely(NULL)\n                                                    return;\n                           print(null-&gt;c) //Seg fault\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 114, "user_id": 4036405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f09172a38eba3035207878fef8c221e9?s=128&d=identicon&r=PG&f=1", "display_name": "renga_in_stack", "link": "https://stackoverflow.com/users/4036405/renga-in-stack"}, "edited": false, "score": 0, "creation_date": 1556091845, "post_id": 55824684, "comment_id": 98314714, "body": "But after moving temp everytime, print_list_reversely(temp) is called which do NULL check  at the beginning itself rt."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 114, "user_id": 4036405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f09172a38eba3035207878fef8c221e9?s=128&d=identicon&r=PG&f=1", "display_name": "renga_in_stack", "link": "https://stackoverflow.com/users/4036405/renga-in-stack"}, "edited": false, "score": 0, "creation_date": 1556091928, "post_id": 55824684, "comment_id": 98314763, "body": "@renga_in_stack Yes but do you do the same null-pointer check <i>after</i> the assignment <code>temp = temp-&gt;next</code>?"}, {"owner": {"reputation": 114, "user_id": 4036405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f09172a38eba3035207878fef8c221e9?s=128&d=identicon&r=PG&f=1", "display_name": "renga_in_stack", "link": "https://stackoverflow.com/users/4036405/renga-in-stack"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1556092860, "post_id": 55824684, "comment_id": 98315309, "body": "@Someprogrammerdude : I am trying to understand the logical difference between the below code: print_list_reversely(temp-&gt;next);  Vs temp = temp-&gt;next; print_list_reversely(temp);"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 114, "user_id": 4036405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f09172a38eba3035207878fef8c221e9?s=128&d=identicon&r=PG&f=1", "display_name": "renga_in_stack", "link": "https://stackoverflow.com/users/4036405/renga-in-stack"}, "edited": false, "score": 0, "creation_date": 1556093271, "post_id": 55824684, "comment_id": 98315552, "body": "@renga_in_stack The problem isn&#39;t the recursive call, the problem is the <code>printf</code> call afterwards, where you dereference a null pointer with <code>temp-&gt;c</code>. Well, that&#39;s <i>one</i> of the null-pointer dereferences you have."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 114, "user_id": 4036405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f09172a38eba3035207878fef8c221e9?s=128&d=identicon&r=PG&f=1", "display_name": "renga_in_stack", "link": "https://stackoverflow.com/users/4036405/renga-in-stack"}, "edited": false, "score": 0, "creation_date": 1556093591, "post_id": 55824684, "comment_id": 98315724, "body": "@renga_in_stack As for <code>print_list_reversely(temp-&gt;next);</code>versus <code>temp = temp-&gt;next; print_list_reversely(temp);</code>, that <i>alone</i> isn&#39;t any different."}, {"owner": {"reputation": 114, "user_id": 4036405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f09172a38eba3035207878fef8c221e9?s=128&d=identicon&r=PG&f=1", "display_name": "renga_in_stack", "link": "https://stackoverflow.com/users/4036405/renga-in-stack"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1556094830, "post_id": 55824684, "comment_id": 98316381, "body": "@Someprogrammerdude: In GDB, I am seeing two different behaviors. In Case A once temp reaches NULL, jump to previous frame temp=0x602050 is happeninng. Why that jump is not there in Case B."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 114, "user_id": 4036405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f09172a38eba3035207878fef8c221e9?s=128&d=identicon&r=PG&f=1", "display_name": "renga_in_stack", "link": "https://stackoverflow.com/users/4036405/renga-in-stack"}, "edited": false, "score": 0, "creation_date": 1556095302, "post_id": 55824684, "comment_id": 98316667, "body": "@renga_in_stack Compiler optimizations? The two short snippets you presented in the comment above are <b><i>on their own</i></b> semantically equivalent. What optimizations the compiler does with them is a very different matter."}, {"owner": {"reputation": 114, "user_id": 4036405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f09172a38eba3035207878fef8c221e9?s=128&d=identicon&r=PG&f=1", "display_name": "renga_in_stack", "link": "https://stackoverflow.com/users/4036405/renga-in-stack"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1556095885, "post_id": 55824684, "comment_id": 98317003, "body": "@Someprogrammerdude: Ok then is there any way to findout what kindof compiler optimization done in these 2 semantics."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 114, "user_id": 4036405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f09172a38eba3035207878fef8c221e9?s=128&d=identicon&r=PG&f=1", "display_name": "renga_in_stack", "link": "https://stackoverflow.com/users/4036405/renga-in-stack"}, "edited": false, "score": 1, "creation_date": 1556096009, "post_id": 55824684, "comment_id": 98317096, "body": "@renga_in_stack Look at the generated code? Using tools such as Godbolts <a href=\"https://godbolt.org\" rel=\"nofollow noreferrer\">compiler explorer</a> makes it very easy to see such differences side by side."}, {"owner": {"reputation": 114, "user_id": 4036405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f09172a38eba3035207878fef8c221e9?s=128&d=identicon&r=PG&f=1", "display_name": "renga_in_stack", "link": "https://stackoverflow.com/users/4036405/renga-in-stack"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1556096844, "post_id": 55824684, "comment_id": 98317635, "body": "@Someprogrammerdude: Great, Really useful tool.  I got this difference in CaseB  mov     QWORD PTR [rbp-8], rax  mov     rax, QWORD PTR [rbp-8]"}], "tags": [], "owner": {"reputation": 896, "user_id": 6659361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/200d3e89398030d70445b9a3f071c385?s=128&d=identicon&r=PG&f=1", "display_name": "Maxime B.", "link": "https://stackoverflow.com/users/6659361/maxime-b"}, "is_accepted": false, "score": 1, "last_activity_date": 1556091448, "creation_date": 1556091448, "answer_id": 55824684, "question_id": 55824550, "link": "https://stackoverflow.com/questions/55824550/getting-segmentation-fault-when-trying-to-print-linked-list-data-reversely-using/55824684#55824684", "title": "Getting segmentation fault when trying to print linked list data reversely using recursion", "body": "<p>Your method <code>print_list_reversely()</code> is called recursively from the first element to the last, and that's the intended behaviour.</p>\n\n<p>Seen how you defined your lists, the next element of the last will be <code>NULL</code>.</p>\n\n<p>if you uncomment your two faulty lines (EDIT: you uncommented them now), when the <code>temp = temp-&gt;next;</code> is executed on the last element, you have null. And you dereference this pointer with <code>printf(\"data is %c\\n\", temp-&gt;c);</code></p>\n\n<p>Therefore, this code is incorrect and segfault.</p>\n\n<p>You have to check that your pointer is not null before calling the function back (or dereferencing it!)</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 10611775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iHN8T.jpg?s=128&g=1", "display_name": "Eovl.Han", "link": "https://stackoverflow.com/users/10611775/eovl-han"}, "is_accepted": false, "score": 0, "last_activity_date": 1556092612, "creation_date": 1556092612, "answer_id": 55825010, "question_id": 55824550, "link": "https://stackoverflow.com/questions/55824550/getting-segmentation-fault-when-trying-to-print-linked-list-data-reversely-using/55825010#55825010", "title": "Getting segmentation fault when trying to print linked list data reversely using recursion", "body": "<p>The last pointer temp passed in the recursion is NULL, so accessing NULL must result in a segment error</p>\n\n<pre><code>Program received signal SIGSEGV, Segmentation fault.\n0x00000000004005c1 in print_list_reversely (temp=0x0) at linked_list.c:40\n40      printf(\"data is %c\\n\", temp-&gt;c);\n(gdb) bt\n#0  0x00000000004005c1 in print_list_reversely (temp=0x0) at linked_list.c:40\n#1  0x00000000004005bd in print_list_reversely (temp=0x601050) at linked_list.c:39\n#2  0x00000000004005bd in print_list_reversely (temp=0x601030) at linked_list.c:39\n</code></pre>\n"}], "owner": {"reputation": 114, "user_id": 4036405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f09172a38eba3035207878fef8c221e9?s=128&d=identicon&r=PG&f=1", "display_name": "renga_in_stack", "link": "https://stackoverflow.com/users/4036405/renga-in-stack"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1556094508, "creation_date": 1556090946, "last_edit_date": 1556094508, "question_id": 55824550, "link": "https://stackoverflow.com/questions/55824550/getting-segmentation-fault-when-trying-to-print-linked-list-data-reversely-using", "title": "Getting segmentation fault when trying to print linked list data reversely using recursion", "body": "<p>I have created linked list of nodes. And wanted to print the data of each node reversely using <strong>recursion</strong> technique. I got the working as well as segfaulted code. I am trying to understand whats actually problem in segfaulted code.</p>\n\n<p>Actually I tried debugging using GDB but I dont know exactly how to troubleshoot this. Any clues will be more helpful towards the clear understanding of recursion.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\ntypedef struct node {\n        char c;\n        struct node *next;\n} node_t;\n\nnode_t *head = NULL;\n\nvoid insert_list(node_t *node)\n{\n    static node_t *temp = NULL;\n    if (!head) {\n        head = node;\n        //temp = node;\n    }\n    else {\n        temp-&gt;next = node;\n    }\n    temp = node;\n\n}\n\nvoid create_list(char c)\n{\n    node_t *temp = NULL;\n    temp = malloc(sizeof(node_t));\n    if (temp) {\n        temp-&gt;c = c;\n        temp-&gt;next = NULL;\n        insert_list(temp);\n    }\n    else\n        return;\n}\n\nvoid print_list_reversely(node_t *temp)\n{\n    if (!temp)\n        return;\n    //print_list_reversely(temp-&gt;next); /* Working piece */\n    temp = temp-&gt;next; /* This and next line together*/\n    print_list_reversely(temp); /* Causing SEGFAULT */\n    printf(\"data is %c\\n\", temp-&gt;c);\n    return;\n}\n\nint main()\n{\n    create_list('a');   \n    create_list('b');   \n    create_list('c');\n    print_list_reversely(head);\n    return 0;\n}\n\n</code></pre>\n\n<p>After some GDB debugging got the below info:</p>\n\n<blockquote>\n  <p>A) print_list_reversely(temp->next);</p>\n</blockquote>\n\n<pre><code>Breakpoint 4, print_list_reversely (temp=0x0) at create.c:40\n40      if (!temp)\n(gdb) p temp\n$5 = (node_t *) 0x0\n(gdb) n\n41          return;\n(gdb) n\n47  }\n(gdb) n\nprint_list_reversely (temp=0x602050) at create.c:45\n45      printf(\"data is %c\\n\", temp-&gt;c);\n</code></pre>\n\n<p>=======</p>\n\n<blockquote>\n  <p>B) temp = temp->next; \n  print_list_reversely(temp);</p>\n</blockquote>\n\n<pre><code>Breakpoint 4, print_list_reversely (temp=0x0) at create.c:40\n40      if (!temp)\n(gdb) p temp\n$3 = (node_t *) 0x0\n(gdb) n\n41          return;\n(gdb) n\n47  }\n(gdb) \nprint_list_reversely (temp=0x0) at create.c:45\n45      printf(\"data is %c\\n\", temp-&gt;c);\n</code></pre>\n"}, {"tags": ["c", "algorithm", "hash", "perfect-hash"], "comments": [{"owner": {"reputation": 4956, "user_id": 2612030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iYT5V.jpg?s=128&g=1", "display_name": "ewramner", "link": "https://stackoverflow.com/users/2612030/ewramner"}, "edited": false, "score": 0, "creation_date": 1556089949, "post_id": 55824130, "comment_id": 98313809, "body": "Interesting question. The thread ids are not known in advance and can in theory be arbitrary (in practice they are not, but we can&#39;t rely on that), so I very much doubt that there is a <i>simpler</i> way than a lookup table."}, {"owner": {"reputation": 195, "user_id": 587587, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/ded5c4da8374a78e17ad9b512e93fb6c?s=128&d=identicon&r=PG", "display_name": "Anton Lahti", "link": "https://stackoverflow.com/users/587587/anton-lahti"}, "reply_to_user": {"reputation": 4956, "user_id": 2612030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iYT5V.jpg?s=128&g=1", "display_name": "ewramner", "link": "https://stackoverflow.com/users/2612030/ewramner"}, "edited": false, "score": 0, "creation_date": 1556092744, "post_id": 55824130, "comment_id": 98315246, "body": "I&#39;ve edited the question to make it clear that the all the thread ID:s are known once the hash function is generated."}, {"owner": {"reputation": 1671, "user_id": 5581045, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a1ef24e9b56127365af9bb4d319eafe?s=128&d=identicon&r=PG&f=1", "display_name": "Anatoli Klamer", "link": "https://stackoverflow.com/users/5581045/anatoli-klamer"}, "edited": false, "score": 0, "creation_date": 1556094523, "post_id": 55824130, "comment_id": 98316222, "body": "If I understand task correctly you can just basic polynomial function and set some coeffiicients to zero to compress values wide range [1111,2222, 30000, 601234]. For python NumPy can calculate coefficients for you."}, {"owner": {"reputation": 4956, "user_id": 2612030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iYT5V.jpg?s=128&g=1", "display_name": "ewramner", "link": "https://stackoverflow.com/users/2612030/ewramner"}, "edited": false, "score": 0, "creation_date": 1556095619, "post_id": 55824130, "comment_id": 98316859, "body": "That is indeed a solution, but in what way is it simpler than a lookup table? You could also generate a switch statement if the thread ids are known at compile time, but that is basically a lookup table in code."}, {"owner": {"reputation": 195, "user_id": 587587, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/ded5c4da8374a78e17ad9b512e93fb6c?s=128&d=identicon&r=PG", "display_name": "Anton Lahti", "link": "https://stackoverflow.com/users/587587/anton-lahti"}, "edited": false, "score": 0, "creation_date": 1556096302, "post_id": 55824130, "comment_id": 98317296, "body": "I want to generate the hash function during runtime. So a switch statement doesn&#39;t work."}, {"owner": {"reputation": 195, "user_id": 587587, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/ded5c4da8374a78e17ad9b512e93fb6c?s=128&d=identicon&r=PG", "display_name": "Anton Lahti", "link": "https://stackoverflow.com/users/587587/anton-lahti"}, "edited": false, "score": 0, "creation_date": 1556096707, "post_id": 55824130, "comment_id": 98317545, "body": "I&#39;ve edited the question to make it clear that the exact number of thread ID:s isn&#39;t known until runtime but is guaranteed to be small and stay fixed during the lifetime of the program."}, {"owner": {"reputation": 4956, "user_id": 2612030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iYT5V.jpg?s=128&g=1", "display_name": "ewramner", "link": "https://stackoverflow.com/users/2612030/ewramner"}, "edited": false, "score": 0, "creation_date": 1556096756, "post_id": 55824130, "comment_id": 98317582, "body": "No, but then you probably don&#39;t want to call a Python program at run time to find the right coefficients either? My original point was that the thread ids are not known in advance (compile time). As your sample code is C you need to compile the function f, so that is when it happens."}, {"owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "edited": false, "score": 0, "creation_date": 1556098271, "post_id": 55824130, "comment_id": 98318494, "body": "My opinion is that a simple and efficient way would be to sort the thread ids in an array and use a binary search on that sorted array."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1556106556, "post_id": 55824130, "comment_id": 98323363, "body": "Why do you think you <i>need</i> a perfect hash? A chained table is simpler, and walking the chain can be hidden in your <code>f()</code> function. (typical average chainlength is ~1.5 for a N=M table)"}, {"owner": {"reputation": 20860, "user_id": 2034787, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/78471a5b1bfa8b48d2056ff99a875f50?s=128&d=identicon&r=PG", "display_name": "\u05d2\u05dc\u05e2\u05d3 \u05d1\u05e8\u05e7\u05df", "link": "https://stackoverflow.com/users/2034787/%d7%92%d7%9c%d7%a2%d7%93-%d7%91%d7%a8%d7%a7%d7%9f"}, "edited": false, "score": 0, "creation_date": 1556196371, "post_id": 55824130, "comment_id": 98360992, "body": "Are we provided all &lt;64 thread_ids beforehand or are they provided/updated dynamically?"}, {"owner": {"reputation": 195, "user_id": 587587, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/ded5c4da8374a78e17ad9b512e93fb6c?s=128&d=identicon&r=PG", "display_name": "Anton Lahti", "link": "https://stackoverflow.com/users/587587/anton-lahti"}, "edited": false, "score": 0, "creation_date": 1556196447, "post_id": 55824130, "comment_id": 98361037, "body": "The threads are created at the start of the program and are fixed during its lifetime."}, {"owner": {"reputation": 20860, "user_id": 2034787, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/78471a5b1bfa8b48d2056ff99a875f50?s=128&d=identicon&r=PG", "display_name": "\u05d2\u05dc\u05e2\u05d3 \u05d1\u05e8\u05e7\u05df", "link": "https://stackoverflow.com/users/2034787/%d7%92%d7%9c%d7%a2%d7%93-%d7%91%d7%a8%d7%a7%d7%9f"}, "edited": false, "score": 0, "creation_date": 1557223608, "post_id": 55824130, "comment_id": 98684125, "body": "Sorry, I still don&#39;t understand - what is the exact universe of input and expected output for each call to <code>f</code>? (For example: any 16 bit number, an integer between 0 and 63, etc.) Why can&#39;t we provide <code>f</code> the index of the thread in thread_ids rather than the thread id itself? Please forgive my ignorance."}], "answers": [{"tags": [], "owner": {"reputation": 44632, "user_id": 382763, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/swPG1.png?s=128&g=1", "display_name": "Thomas Mueller", "link": "https://stackoverflow.com/users/382763/thomas-mueller"}, "is_accepted": false, "score": 3, "last_activity_date": 1556188711, "last_edit_date": 1556188711, "creation_date": 1556108241, "answer_id": 55829860, "question_id": 55824130, "link": "https://stackoverflow.com/questions/55824130/is-it-possible-to-create-a-minimal-perfect-hash-function-without-a-separate-look/55829860#55829860", "title": "Is it possible to create a Minimal Perfect Hash function without a separate lookup table for a small (&lt;64) set of keys?", "body": "<p>Yes, you can build a minimal perfect hash function (MPHF) at runtime. There are multiple algorithms you can use, but most of them are a bit complex to implement so I can't give you working sample code. Many are implemented in the <a href=\"http://cmph.sourceforge.net/\" rel=\"nofollow noreferrer\">cmph project</a>. </p>\n\n<p>The most simple one is probably BDZ. On a high level, lookup requires calculating 3 hash functions, and 3 memory accesses. If memory isn't an issue, you only need 2. It supports millions of keys. This algorithm requires a lookup table that is about 1.23 times the number of entries.</p>\n\n<p>There are other algorithms, one I invented myself, <a href=\"https://www.slideshare.net/ThomasMueller12/recsplit-minimal-perfect-hashing\" rel=\"nofollow noreferrer\">the RecSplit algorithm</a>, but I don't have a C implementation, only <a href=\"https://github.com/thomasmueller/minperf/blob/master/src/main/java/org/minperf/hem/recsplit/FastGenerator.java\" rel=\"nofollow noreferrer\">Java</a> right now. Basically, the algorithms finds a way to split the set into subsets (recursively), until the subset size is 1. You need to remember how you split. The most simple solution is in fact using a lookup table for \"how you split\", but the table is really small, possibly only 5 integers for 64 keys. The first one to divide into 4 subsets of 16, and 4 to map each subset to a number 0..15.</p>\n\n<p>(I added a second answer if you don't strictly need a <em>minimal</em> perfect hash function, just a <em>perfect</em> hash function. Construction is simpler and lookup is a lot faster, but requires a larger array.)</p>\n"}, {"tags": [], "owner": {"reputation": 44632, "user_id": 382763, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/swPG1.png?s=128&g=1", "display_name": "Thomas Mueller", "link": "https://stackoverflow.com/users/382763/thomas-mueller"}, "is_accepted": false, "score": 1, "last_activity_date": 1556176180, "creation_date": 1556176180, "answer_id": 55843687, "question_id": 55824130, "link": "https://stackoverflow.com/questions/55824130/is-it-possible-to-create-a-minimal-perfect-hash-function-without-a-separate-look/55843687#55843687", "title": "Is it possible to create a Minimal Perfect Hash function without a separate lookup table for a small (&lt;64) set of keys?", "body": "<p>You could build a <em>perfect</em> hash as follows, using a brute-force search. For 64 entries, the size of the target array needs to be at least 512 entries, otherwise search won't find an index within reasonable time. </p>\n\n<p>The perfect hash function is then <code>murmur(x + perfectHashIndex) &amp; (TARGET_SIZE - 1)</code></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdint.h&gt;\n#include &lt;string.h&gt;\n\nstatic uint64_t murmur64(uint64_t h) {\n    h ^= h &gt;&gt; 33;\n    h *= UINT64_C(0xff51afd7ed558ccd);\n    h ^= h &gt;&gt; 33;\n    h *= UINT64_C(0xc4ceb9fe1a85ec53);\n    h ^= h &gt;&gt; 33;\n    return h;\n}\n\n// must be a power of 2\n#define TARGET_SIZE 512\n\nstatic uint64_t findPerfectHashIndex(uint64_t *array, int size) {\n    uint64_t used[TARGET_SIZE / 64];\n    for (uint64_t index = 0; index &lt; 1000;) {\n        memset(used, 0, TARGET_SIZE / 64 * sizeof(uint64_t));\n        for (size_t i = 0; i &lt; size; i++) {\n            uint64_t x = murmur64(array[i] + index) &amp; (TARGET_SIZE - 1);\n            if (((used[x &gt;&gt; 6] &gt;&gt; (x &amp; 63)) &amp; 1) != 0) {\n                goto outer;\n            }\n            used[x &gt;&gt; 6] |= 1UL &lt;&lt; (x &amp; 63);\n        }\n        return index;\n        outer:\n        index++;\n    }\n    // not found\n    return -1;\n}\n\nint main() {\n    int size = 64;\n    uint64_t ids[size];\n    for(int i=0; i&lt;size; i++) ids[i] = 10 * i;\n    uint64_t perfectHashIndex = findPerfectHashIndex(ids, size);\n    if (perfectHashIndex == -1) {\n        printf(\"perfectHashIndex not found\\n\");\n    } else {\n        printf(\"perfectHashIndex = %lld\\n\", perfectHashIndex);\n        for(int i=0; i&lt;size; i++) {\n            printf(\"  x[%d] = %lld, murmur(x + perfectHashIndex) &amp; (TARGET_SIZE - 1) = %d\\n\", \n                i, ids[i], murmur64(ids[i] + perfectHashIndex) &amp; (TARGET_SIZE - 1));\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 195, "user_id": 587587, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/ded5c4da8374a78e17ad9b512e93fb6c?s=128&d=identicon&r=PG", "display_name": "Anton Lahti", "link": "https://stackoverflow.com/users/587587/anton-lahti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1764, "favorite_count": 4, "answer_count": 2, "score": 9, "last_activity_date": 1557310980, "creation_date": 1556089382, "last_edit_date": 1557310980, "question_id": 55824130, "link": "https://stackoverflow.com/questions/55824130/is-it-possible-to-create-a-minimal-perfect-hash-function-without-a-separate-look", "title": "Is it possible to create a Minimal Perfect Hash function without a separate lookup table for a small (&lt;64) set of keys?", "body": "<p>I recently read this article <a href=\"http://stevehanov.ca/blog/?id=119\" rel=\"nofollow noreferrer\">Throw away the keys: Easy, Minimal Perfect Hashing</a> about generating a minimal perfect hash table for a known set of keys.</p>\n\n<p>The article seems to assume that you need an intermediate table. Is there any other, simpler way to generate such a function if we assume that the set of keys is small (i.e. &lt; 64).</p>\n\n<p>In my case, I want to map a set of thread ID:s to a unique block of data within an array. The threads are started before the hash function is generated and stay constant during the running time of the program. The exact number of threads vary but stays fixed during the runtime of the program:</p>\n\n<pre><code>unsigned int thread_ids*;\nunsigned int thread_count;\nstruct {\n    /* Some thread specific data */\n}* ThreadData;\n\nint start_threads () {\n    /* Code which starts the threads and allocates the threaddata. */\n}\n\nint f(thread_id) {\n    /* return unique index into threadData */\n}\n\nint main() {\n    thread_count = 64; /* This number will be small, e.g. &lt; 64 */\n    start_threads();\n    ThreadData[f(thread_ids[0])]\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "gcc", "llvm-clang", "micro-optimization"], "comments": [{"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 1, "creation_date": 1556089430, "post_id": 55824061, "comment_id": 98313560, "body": "This <a href=\"https://stackoverflow.com/questions/7346929/what-is-the-advantage-of-gccs-builtin-expect-in-if-else-statements\">Q&amp;A</a> suggests <code>__builtin_expect</code> is exactly the tool used for this job, with <code>0</code> or <code>1</code> for arbitrary conditionals. The linux kernel even uses it to define its <code>likely</code> and <code>unlikely</code> macros"}, {"owner": {"reputation": 14958, "user_id": 678093, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/667853b27b3d9f422d6d13924ee4994a?s=128&d=identicon&r=PG", "display_name": "m.s.", "link": "https://stackoverflow.com/users/678093/m-s"}, "edited": false, "score": 4, "creation_date": 1556089504, "post_id": 55824061, "comment_id": 98313592, "body": "clang has <code>__builtin_unpredictable</code> : <a href=\"https://clang.llvm.org/docs/LanguageExtensions.html#builtin-unpredictable\" rel=\"nofollow noreferrer\">clang.llvm.org/docs/&hellip;</a>"}, {"owner": {"reputation": 9545, "user_id": 242814, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/fabed09b67201710f4cc958b4e668cb1?s=128&d=identicon&r=PG", "display_name": "Brennan Vincent", "link": "https://stackoverflow.com/users/242814/brennan-vincent"}, "reply_to_user": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 1, "creation_date": 1556089524, "post_id": 55824061, "comment_id": 98313598, "body": "@StoryTeller I&#39;m sorry, but I don&#39;t think you understood the question. (Either that, or I don&#39;t understand your comment)"}, {"owner": {"reputation": 9545, "user_id": 242814, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/fabed09b67201710f4cc958b4e668cb1?s=128&d=identicon&r=PG", "display_name": "Brennan Vincent", "link": "https://stackoverflow.com/users/242814/brennan-vincent"}, "reply_to_user": {"reputation": 14958, "user_id": 678093, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/667853b27b3d9f422d6d13924ee4994a?s=128&d=identicon&r=PG", "display_name": "m.s.", "link": "https://stackoverflow.com/users/678093/m-s"}, "edited": false, "score": 0, "creation_date": 1556089594, "post_id": 55824061, "comment_id": 98313626, "body": "@m.s. thank you! This is exactly what I was looking for."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1556089612, "post_id": 55824061, "comment_id": 98313636, "body": "In that case, maybe you are due for some inspection and revision of the question for clarity."}, {"owner": {"reputation": 9545, "user_id": 242814, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/fabed09b67201710f4cc958b4e668cb1?s=128&d=identicon&r=PG", "display_name": "Brennan Vincent", "link": "https://stackoverflow.com/users/242814/brennan-vincent"}, "reply_to_user": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1556089667, "post_id": 55824061, "comment_id": 98313667, "body": "@StoryTeller I thought it was clear in the question that we don&#39;t know whether the branch is likely or not. It could be taken exactly 50% of the time. So, what value would I pass to <code>__builtin_expect</code> ?"}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1556089693, "post_id": 55824061, "comment_id": 98313674, "body": "<i>&quot;but I do know that it&#39;s predictable (or not)&quot;</i> - So which is it?"}, {"owner": {"reputation": 9545, "user_id": 242814, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/fabed09b67201710f4cc958b4e668cb1?s=128&d=identicon&r=PG", "display_name": "Brennan Vincent", "link": "https://stackoverflow.com/users/242814/brennan-vincent"}, "edited": false, "score": 0, "creation_date": 1556089795, "post_id": 55824061, "comment_id": 98313719, "body": "You seem to be confusing &quot;predictable&quot; with likely. There are six separate cases:  &quot;Predictable, not likely&quot;, &quot;Predictable, likeliness indeterminate&quot;, &quot;Predictable, likely&quot;, &quot;Unpredictable, unlikely&quot;, &quot;Unpredictable, likeliness indeterminate&quot;, &quot;Unpredictable, likely&quot;"}, {"owner": {"reputation": 9545, "user_id": 242814, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/fabed09b67201710f4cc958b4e668cb1?s=128&d=identicon&r=PG", "display_name": "Brennan Vincent", "link": "https://stackoverflow.com/users/242814/brennan-vincent"}, "edited": false, "score": 0, "creation_date": 1556089974, "post_id": 55824061, "comment_id": 98313823, "body": "To elaborate on this: an example of predictable but of indeterminate likeliness would be generating a random bool (true or false) and then using the same bool in a condition 1000 times in a row.  There is a 50% probability a priori of taking or not taking the branch, but it will be the same 1000 times in a row, so perfectly predictable by hardware branch prediction facilities."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1556090101, "post_id": 55824061, "comment_id": 98313881, "body": "Great! But it belongs in the question, not buried in comments."}, {"owner": {"reputation": 9545, "user_id": 242814, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/fabed09b67201710f4cc958b4e668cb1?s=128&d=identicon&r=PG", "display_name": "Brennan Vincent", "link": "https://stackoverflow.com/users/242814/brennan-vincent"}, "edited": false, "score": 0, "creation_date": 1556090608, "post_id": 55824061, "comment_id": 98314127, "body": "I have added some examples, hopefully it is more comprehensible now."}, {"owner": {"reputation": 20213, "user_id": 147845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e225ff5beb684088f5c9131d3979a18?s=128&d=identicon&r=PG", "display_name": "You", "link": "https://stackoverflow.com/users/147845/you"}, "edited": false, "score": 0, "creation_date": 1556107312, "post_id": 55824061, "comment_id": 98323805, "body": "To be fair, in the first example here the variable (assuming it isn&#39;t changed) will likely be hoisted out of the loop by the optimizer. That&#39;s just data flow analysis, and has little to do with &quot;predictability&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 6533, "user_id": 1918193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b70a14318e0f417ecac47809f38fafc?s=128&d=identicon&r=PG", "display_name": "Marc Glisse", "link": "https://stackoverflow.com/users/1918193/marc-glisse"}, "edited": false, "score": 2, "creation_date": 1556090551, "post_id": 55824207, "comment_id": 98314085, "body": "But no <code>__builtin_predictable</code> for the opposite?"}, {"owner": {"reputation": 14958, "user_id": 678093, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/667853b27b3d9f422d6d13924ee4994a?s=128&d=identicon&r=PG", "display_name": "m.s.", "link": "https://stackoverflow.com/users/678093/m-s"}, "reply_to_user": {"reputation": 6533, "user_id": 1918193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b70a14318e0f417ecac47809f38fafc?s=128&d=identicon&r=PG", "display_name": "Marc Glisse", "link": "https://stackoverflow.com/users/1918193/marc-glisse"}, "edited": false, "score": 1, "creation_date": 1556114871, "post_id": 55824207, "comment_id": 98328679, "body": "@MarcGlisse I guess the &quot;default&quot; setting is predictable, and you can opt out of it using the above."}], "tags": [], "owner": {"reputation": 14958, "user_id": 678093, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/667853b27b3d9f422d6d13924ee4994a?s=128&d=identicon&r=PG", "display_name": "m.s.", "link": "https://stackoverflow.com/users/678093/m-s"}, "is_accepted": true, "score": 6, "last_activity_date": 1556089698, "creation_date": 1556089698, "answer_id": 55824207, "question_id": 55824061, "link": "https://stackoverflow.com/questions/55824061/are-there-any-builtins-to-tell-compiler-whether-a-branch-is-predictable/55824207#55824207", "title": "Are there any builtins to tell compiler whether a branch is predictable?", "body": "<p>Converting my comment into an answer:</p>\n\n<p>clang has <code>__builtin_unpredictable</code>:</p>\n\n<blockquote>\n  <p><code>__builtin_unpredictable</code> is used to indicate that a branch condition is unpredictable by hardware mechanisms such as branch prediction logic.</p>\n  \n  <p><strong>Example of use:</strong></p>\n\n<pre><code>if (__builtin_unpredictable(x &gt; 0)) {\n    foo();\n}\n</code></pre>\n</blockquote>\n\n<p><a href=\"https://clang.llvm.org/docs/LanguageExtensions.html#builtin-unpredictable\" rel=\"noreferrer\">https://clang.llvm.org/docs/LanguageExtensions.html#builtin-unpredictable</a></p>\n"}], "owner": {"reputation": 9545, "user_id": 242814, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/fabed09b67201710f4cc958b4e668cb1?s=128&d=identicon&r=PG", "display_name": "Brennan Vincent", "link": "https://stackoverflow.com/users/242814/brennan-vincent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 346, "favorite_count": 0, "accepted_answer_id": 55824207, "answer_count": 1, "score": 4, "last_activity_date": 1556090592, "creation_date": 1556089104, "last_edit_date": 1556090592, "question_id": 55824061, "link": "https://stackoverflow.com/questions/55824061/are-there-any-builtins-to-tell-compiler-whether-a-branch-is-predictable", "title": "Are there any builtins to tell compiler whether a branch is predictable?", "body": "<p>I'm not asking about things like <code>__builtin_expect</code>. I'm thinking of the case where I <em>don't know</em> that a branch will be usually true or usually false, but I <em>do</em> know that it's predictable (or not).</p>\n\n<p>I would expect the compiler, knowing a branch is predictable, to be more likely to generate branches, and knowing it's unpredictable, to be more likely to generate conditionally-executed instructions with no branches.</p>\n\n<p>Is this possible in major compilers? (Thinking specifically of gcc and clang).</p>\n\n<hr>\n\n<p>Examples explaining why \"predictable\" and \"likely\" are not the same thing</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>int x = rand()%2;\nwhile (true) {\n    if (x) {\n        // do something\n    }\n}\n</code></pre>\n\n<p>The <code>if</code> statement is neither likely or unlikely, but highly predictable.</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>while (true) {\n    if (rand()%5 &gt; 0) {\n        // do something\n    }\n}\n</code></pre>\n\n<p>In this case, the opposite is true: the branch is highly likely (taken 80% of the time), but unpredictable.</p>\n"}, {"tags": ["c", "endianness", "bit-fields"], "answers": [{"comments": [{"owner": {"reputation": 187, "user_id": 3295977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d1a1136dc914675602c270d35943e95?s=128&d=identicon&r=PG&f=1", "display_name": "richjhart", "link": "https://stackoverflow.com/users/3295977/richjhart"}, "edited": false, "score": 0, "creation_date": 1556266707, "post_id": 55825057, "comment_id": 98387291, "body": "Thanks for the detailed reply. We&#39;ve removed the bit-fields now. We are still using a struct, but with all uint8_t elements. I know that&#39;s essentially the same as using an array but with higher risk, but we feel the code is slightly more readable. When I have a few minutes I may also switch to just pulling elements from the array"}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "reply_to_user": {"reputation": 187, "user_id": 3295977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d1a1136dc914675602c270d35943e95?s=128&d=identicon&r=PG&f=1", "display_name": "richjhart", "link": "https://stackoverflow.com/users/3295977/richjhart"}, "edited": false, "score": 0, "creation_date": 1556269917, "post_id": 55825057, "comment_id": 98388878, "body": "@richjhart Structs (without bitfields) certainly work, if problems I listed are not relevant or are taken care of. Personally I like the flexibility of manual conversion, and I tend to avoid compiler extensions whenever I can to make porting easier."}], "tags": [], "owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "is_accepted": true, "score": 4, "last_activity_date": 1556092751, "creation_date": 1556092751, "answer_id": 55825057, "question_id": 55823879, "link": "https://stackoverflow.com/questions/55823879/should-i-use-bit-fields-for-mapping-incoming-serial-data/55825057#55825057", "title": "Should I use bit-fields for mapping incoming serial data?", "body": "<blockquote>\n  <p>Should I use bit-fields for mapping incoming serial data?</p>\n</blockquote>\n\n<p>No. Bit-fields have a lot of implementation specified behaviour that makes using them a nightmare.</p>\n\n<blockquote>\n  <p>Will data1 always represent the correct value as expected regardless of endianness. </p>\n</blockquote>\n\n<p>Yes, but that is because <code>uint8_t</code> is smallest possible addressable unit: a byte. For larger data types you need to take care of the byte endianness.</p>\n\n<blockquote>\n  <p>Could data2 and reserved be the wrong way around, with data2 representing the upper 4 bits instead of the lower 4 bits?</p>\n</blockquote>\n\n<p>Yes. They could also be on different bytes. Also, compiler doesn't have to support <code>uint8_t</code> for bitfields, even if it would support the type otherwise.</p>\n\n<blockquote>\n  <p>Is the bit endianness (generally) dependent on the byte endianness, or can they differ entirely?</p>\n</blockquote>\n\n<p>The least signifact bit will always be in the least significant byte, but it's impossible to determine in C <em>where</em> in the byte the bit will be.</p>\n\n<p>Bit shifting operators give reliable abstraction of the order that is good enough: For data type <code>uint8_t</code> the <code>(1u &lt;&lt; 0)</code> is always the least significant and <code>(1u &lt;&lt; 7)</code> the most significant bit, for all compilers and for all architectures. </p>\n\n<p>Bit-fields on the other hand are so poorly defined that you cannot determine the order of bits by the order of your defined fields.</p>\n\n<blockquote>\n  <p>Is the bit-endianness determined by the hardware or the compiler?</p>\n</blockquote>\n\n<p>Compiler dictates how datatypes map to actual bits, but hardware heavily influences it. For bit-fields, two different compilers for the same hardware can put fields in different order.</p>\n\n<blockquote>\n  <p>Is there a simple way to determine in the compiler which way around it is, and reserve the bit-fields entries if needed?</p>\n</blockquote>\n\n<p>Not really. It depends on your compiler how to do it, if it's possible at all.</p>\n\n<blockquote>\n  <p>Although bit-fields are the neatest way, code-wise, to map the incoming data, I suppose I am just wondering if it's a lot safer to just abandon them, and use something like:</p>\n</blockquote>\n\n<p>Definitely abandon bit-fields, but I would also recommend abandoning structures altogether for this purpose, because:</p>\n\n<ul>\n<li><p>You need to use compiler extensions or manual work to handle byte order.</p></li>\n<li><p>You need to use compiler extensions to disable padding to avoid gaps due to alignment restrictions. This affects member access performance on some systems.</p></li>\n<li><p>You cannot have variable width or optional fields.</p></li>\n<li><p>It's very easy to have strict aliasing violations if you are unaware of those issues. If you define byte array for the data frame and cast that to pointer to structure and then dereference that, you have problems in many cases.</p></li>\n</ul>\n\n<p>Instead I recommend doing it manually. Define byte array and then write each field into it manually by breaking them apart using bit shifting and masking when necessary. You can write a simple reusable conversion functions for the basic data types.</p>\n"}], "owner": {"reputation": 187, "user_id": 3295977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d1a1136dc914675602c270d35943e95?s=128&d=identicon&r=PG&f=1", "display_name": "richjhart", "link": "https://stackoverflow.com/users/3295977/richjhart"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 119, "favorite_count": 0, "accepted_answer_id": 55825057, "answer_count": 1, "score": 2, "last_activity_date": 1556092751, "creation_date": 1556088328, "question_id": 55823879, "link": "https://stackoverflow.com/questions/55823879/should-i-use-bit-fields-for-mapping-incoming-serial-data", "title": "Should I use bit-fields for mapping incoming serial data?", "body": "<p>We have data coming in over serial (Bluetooth), which maps to a particular structure. Some parts of the structure are sub-byte size, so the \"obvious\" solution is to map the incoming data to a bit-field. What I can't work out is whether the bit-endianness of the machine or compiler will affect it (which is difficult to test), and whether I should just abandon the bit-fields altogether.</p>\n\n<p>For example, we have a piece of data which is 1.5 bytes, so we used the struct:</p>\n\n<pre><code>{\n    uint8_t data1; // lsb\n    uint8_t data2:4; // msb\n    uint8_t reserved:4;\n} Data;\n</code></pre>\n\n<p>The reserved bits are always 1</p>\n\n<p>So for example, if the incoming data is 0xD2,0xF4, the value is 0x04D2, or 1234.</p>\n\n<p>The struct we have used is always working on the systems we have tested on, but we need it to be as portable as possible.</p>\n\n<p>My questions are:</p>\n\n<ul>\n<li><p>Will <code>data1</code> always represent the correct value as expected regardless of endianness (I assume yes, and that the hardware/software interface should always handle that correctly for a single, whole byte - if 0xD2 is sent, 0xD2 should be received)?</p></li>\n<li><p>Could <code>data2</code> and <code>reserved</code> be the wrong way around, with <code>data2</code> representing the upper 4 bits instead of the lower 4 bits?</p></li>\n</ul>\n\n<p>If yes:</p>\n\n<ul>\n<li><p>Is the bit endianness (generally) dependent on the byte endianness, or can they differ entirely?</p></li>\n<li><p>Is the bit-endianness determined by the hardware or the compiler? It seems all linux systems on Intel are the same - is that true for ARM as well? (If we can say we can support all Intel and ARM linux builds, we should be OK)</p></li>\n<li><p>Is there a simple way to determine in the compiler which way around it is, and reserve the bit-fields entries if needed?</p></li>\n</ul>\n\n<p>Although bit-fields are the neatest way, code-wise, to map the incoming data, I suppose I am just wondering if it's a lot safer to just abandon them, and use something like:</p>\n\n<pre><code>struct {\n    uint8_t data1; // lsb (0xFF)\n    uint8_t data2; // msb (0x0F) &amp; reserved (0xF0)\n} Data;\n\nData d;\n\nint value = (d.data2 &amp; 0x0F) &lt;&lt; 16 + d.data1\n</code></pre>\n\n<p>The reason we have not just done this in the first place is because a number of the data fields are less than 1 byte, rather than more than 1 - meaning that generally with a bit-field we don't have to do any masking and shifting, so the post-processing is simpler.</p>\n"}, {"tags": ["c++", "c", "winapi", "windows-installer", "custom-action"], "comments": [{"owner": {"reputation": 34253, "user_id": 129130, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/FJpdt.gif?s=128&g=1", "display_name": "Stein &#197;smul", "link": "https://stackoverflow.com/users/129130/stein-%c3%85smul"}, "edited": false, "score": 1, "creation_date": 1556105127, "post_id": 55823735, "comment_id": 98322492, "body": "To speed things up I like to pillage github for stuff like this (old code that can be tweaked). Saves time I think. <a href=\"https://github.com/search?q=MsiDatabaseOpenView+MsiViewExecute+MsiCloseHandle+PMSIHANDLE&amp;type=Code\" rel=\"nofollow noreferrer\">Here is a query</a>. First hit (Apress/def-guid-to-win-installer) is from Phil Wilson. MSI MVP back in the day and author of <a href=\"https://github.com/search?q=MsiDatabaseOpenView+MsiViewExecute+MsiCloseHandle+PMSIHANDLE&amp;type=Code\" rel=\"nofollow noreferrer\">The Definitive Guide to Windows Installer</a>. <a href=\"https://github.com/Apress/def-guide-to-win-installer\" rel=\"nofollow noreferrer\">Reliable information (download link)</a>."}, {"owner": {"reputation": 14021, "user_id": 7571258, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fBP6e.png?s=128&g=1", "display_name": "zett42", "link": "https://stackoverflow.com/users/7571258/zett42"}, "reply_to_user": {"reputation": 34253, "user_id": 129130, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/FJpdt.gif?s=128&g=1", "display_name": "Stein &#197;smul", "link": "https://stackoverflow.com/users/129130/stein-%c3%85smul"}, "edited": false, "score": 0, "creation_date": 1556141347, "post_id": 55823735, "comment_id": 98341545, "body": "@Stein&#197;smul Even Phil is not perfect. Actually I think <a href=\"https://github.com/Apress/def-guide-to-win-installer/blob/024a4a8657ab8135db9974a9b9b99a79b35b9da0/Chapter14/MsiStream/MsiStream.cpp\" rel=\"nofollow noreferrer\">this code</a> even leaks a handle, because he is missing a <code>MsiCloseHandle(hView)</code> at the end of the code. He is doing it right the first time at <a href=\"https://github.com/Apress/def-guide-to-win-installer/blob/024a4a8657ab8135db9974a9b9b99a79b35b9da0/Chapter14/MsiStream/MsiStream.cpp#L53\" rel=\"nofollow noreferrer\">line 53</a> though, so this seems to be a simple oversight. The <code>MsiViewClose()</code> calls are obsolete there, but they do no harm."}, {"owner": {"reputation": 34253, "user_id": 129130, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/FJpdt.gif?s=128&g=1", "display_name": "Stein &#197;smul", "link": "https://stackoverflow.com/users/129130/stein-%c3%85smul"}, "edited": false, "score": 0, "creation_date": 1556190853, "post_id": 55823735, "comment_id": 98357895, "body": "I am not a C++ expert. Not sure Phil himself has control over that repository, or else you could submit a change for him to review? Community input is how open source gets better I suppose. I use tools to help me with C++. I think there are too many things to mess up - too much to remember. Are there any online analyzers for C++ code (that are any good), like there is for <a href=\"https://validator.w3.org/\" rel=\"nofollow noreferrer\">html</a>? (not important, just came to mind)."}], "answers": [{"comments": [{"owner": {"reputation": 31026, "user_id": 23852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/179453ce28338e22260a03651e80ac44?s=128&d=identicon&r=PG", "display_name": "Rob Mensching", "link": "https://stackoverflow.com/users/23852/rob-mensching"}, "edited": false, "score": 0, "creation_date": 1556108114, "post_id": 55824953, "comment_id": 98324285, "body": "Yeah, <code>PMSIHANDLE</code> was designed back in 1995. C++ wasn&#39;t modern yet. :)"}, {"owner": {"reputation": 34253, "user_id": 129130, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/FJpdt.gif?s=128&g=1", "display_name": "Stein &#197;smul", "link": "https://stackoverflow.com/users/129130/stein-%c3%85smul"}, "edited": false, "score": 1, "creation_date": 1556109694, "post_id": 55824953, "comment_id": 98325240, "body": "&quot;<i>You were there... In the fires of mount Doom... Thousands of days ago...</i>&quot; :-)."}, {"owner": {"reputation": 14021, "user_id": 7571258, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fBP6e.png?s=128&g=1", "display_name": "zett42", "link": "https://stackoverflow.com/users/7571258/zett42"}, "reply_to_user": {"reputation": 31026, "user_id": 23852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/179453ce28338e22260a03651e80ac44?s=128&d=identicon&r=PG", "display_name": "Rob Mensching", "link": "https://stackoverflow.com/users/23852/rob-mensching"}, "edited": false, "score": 0, "creation_date": 1556139543, "post_id": 55824953, "comment_id": 98340915, "body": "@Rob I feel a bit ashamed for criticising without providing an alternative. Fixed. :)"}], "tags": [], "owner": {"reputation": 14021, "user_id": 7571258, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fBP6e.png?s=128&g=1", "display_name": "zett42", "link": "https://stackoverflow.com/users/7571258/zett42"}, "is_accepted": true, "score": 3, "last_activity_date": 1556141923, "last_edit_date": 1556141923, "creation_date": 1556092368, "answer_id": 55824953, "question_id": 55823735, "link": "https://stackoverflow.com/questions/55823735/is-msiviewclose-call-required-even-when-msiclosehandle-is-there/55824953#55824953", "title": "Is MsiViewClose call required even when MsiCloseHandle is there?", "body": "<h2>Answer</h2>\n\n<p><code>MsiViewClose()</code> is not required to close the handle. It is only required, if you want to run <code>MsiViewExecute()</code> on the same view again, which can be useful to pass different parameters to a parameterized SQL query. This is stated in the remarks of the <a href=\"https://docs.microsoft.com/en-us/windows/desktop/api/msiquery/nf-msiquery-msiviewclose\" rel=\"nofollow noreferrer\">documentation</a>:</p>\n\n<blockquote>\n  <p>The MsiViewClose function must be called before the MsiViewExecute\n  function is called again on the view, unless all rows of the result\n  set have been obtained with the MsiViewFetch function.</p>\n</blockquote>\n\n<p>In the most common use case, where you only do a single <code>MsiViewExecute()</code> call for a given view, you don't need to call <code>MsiViewClose()</code>:</p>\n\n<pre><code>PMSIHANDLE pView;\nUINT res = MsiDatabaseOpenViewW( hDatabase, L\"SELECT * FROM `File`\", &amp;pView );\nif( res == ERROR_SUCCESS )\n{\n    res = MsiViewExecute( pView, nullptr );\n}\n// Destructor of PMSIHANDLE calls MsiCloseHandle()\n</code></pre>\n\n<h2>Side Notes</h2>\n\n<p>From a modern C++ point of view, <code>PMSIHANDLE</code> appears to be badly designed. For one, it provides no protection against accidentally copying of a handle, which would result in calling <code>MsiViewClose()</code> twice on the same handle. Also while the implicit conversion to <code>MSIHANDLE*</code> can be convenient, it is also dangerous because it makes it possible to accidentally overwrite an existing handle, without closing it first.</p>\n\n<p>Here is an alternative to <code>PMSIHANDLE</code> based on C++11s <a href=\"https://en.cppreference.com/w/cpp/memory/unique_ptr\" rel=\"nofollow noreferrer\"><code>std::unique_ptr</code></a>:</p>\n\n<pre><code>// A deleter for MSIHANDLE.\nstruct MsiHandleDeleter\n{\n    // This alias enables us to actually store values of type MSIHANDLE in the unique_ptr\n    // (by default it would be MSIHANDLE*).\n    using pointer = MSIHANDLE;\n\n    void operator()( MSIHANDLE h ) const { if( h ) ::MsiCloseHandle( h ); }\n};\n\n// A RAII wrapper for MSI handle. The destructor automatically closes the handle, if not 0.\nusing UniqueMsiHandle = std::unique_ptr&lt; MSIHANDLE, MsiHandleDeleter &gt;;\n</code></pre>\n\n<p><strong>Usage example:</strong></p>\n\n<pre><code>UniqueMsiHandle record{ ::MsiCreateRecord( 1 ) };\n::MsiRecordSetInteger( record.get(), 1, 42 );\n// Destructor takes care of calling MsiCloseHandle(), just like PMSIHANDLE.\n</code></pre>\n\n<p>Compared to <code>PMSIHANDLE</code> it's more cumbersome to use it with functions that have <code>MSIHANDLE*</code> out parameters, but this can easily be remedied by creating wrapper functions or classes that work with <code>UnqiueMsiHandle</code>.</p>\n\n<p><strong>Advantages:</strong></p>\n\n<ul>\n<li>Less ways to do things wrong.</li>\n<li>Clear ownership and <a href=\"https://en.cppreference.com/w/cpp/utility/move\" rel=\"nofollow noreferrer\">moveability</a>.</li>\n<li>Everyone who is used to <code>std::unique_ptr</code> will immediately understand the semantics of <code>UniqueMsiHandle</code>.</li>\n</ul>\n"}], "owner": {"reputation": 16783, "user_id": 264325, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/q8UVK.jpg?s=128&g=1", "display_name": "Ajay", "link": "https://stackoverflow.com/users/264325/ajay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "accepted_answer_id": 55824953, "answer_count": 1, "score": 1, "last_activity_date": 1556141923, "creation_date": 1556087719, "question_id": 55823735, "link": "https://stackoverflow.com/questions/55823735/is-msiviewclose-call-required-even-when-msiclosehandle-is-there", "title": "Is MsiViewClose call required even when MsiCloseHandle is there?", "body": "<p>I open a MSI database view using <code>MsiDatabaseOpenView</code> followed by a call to <code>MsiViewExecute</code>. Then do I need to call <code>MsiViewClose</code> even if I do make a call to <code>MsiCloseHandle</code>?  Will <code>MsiCloseHandle</code> not call <code>MsiViewClose</code> (or do something to close all required handles internally)?</p>\n\n<p>The actual reason why I'm asking this:\nThere is a class <code>PMSIHANDLE</code> which is recommended instead of manually closing the handles (destructor will call <code>MsiCloseHandle</code> - source code visible in VS). So when I open the view using <code>MsiDatabaseOpenView</code> and wrap the handle in <code>PMSIHANDLE</code>, I am relieved from calling <code>MsiCloseHandle</code>, but I must(?) call <code>MsiViewClose</code>!?</p>\n"}, {"tags": ["c", "line", "fgets"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 3, "creation_date": 1556085983, "post_id": 55823341, "comment_id": 98312113, "body": "If you read just about any <code>fgets</code> documentation or reference (like e.g. <a href=\"https://en.cppreference.com/w/c/io/fgets\" rel=\"nofollow noreferrer\">this one</a>) it will tell you that if the full line was read, the last character would be a newline."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1556086103, "post_id": 55823341, "comment_id": 98312154, "body": "@Someprogrammerdude Why don&#39;t you consider that an answer?"}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 1, "creation_date": 1556086120, "post_id": 55823341, "comment_id": 98312164, "body": "In <code>exhaustedLine</code> , <code>sizeof line</code> is the size of the char pointer, so it&#39;s not what you want. If the line was not terminated by a newline, <code>line[n - 1]</code> will hold the null terminator and <code>line[n - 2]</code> will hold a non-null character other than a newline."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "reply_to_user": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 0, "creation_date": 1556086166, "post_id": 55823341, "comment_id": 98312185, "body": "@MOehm Same to you."}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "reply_to_user": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1556087087, "post_id": 55823341, "comment_id": 98312529, "body": "@Yunnosch: Yes, I know. Too late now."}, {"owner": {"reputation": 46708, "user_id": 179715, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e240f1a5bb197450dfb8934dd55d9e3a?s=128&d=identicon&r=PG", "display_name": "jamesdlin", "link": "https://stackoverflow.com/users/179715/jamesdlin"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1556087157, "post_id": 55823341, "comment_id": 98312559, "body": "@Someprogrammerdude If EOF is reached, the last line will be fully read but will not be terminated by a newline.  Some care is needed if that happens and if the last line happens to be 1 byte shorter than the buffer size."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 46708, "user_id": 179715, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e240f1a5bb197450dfb8934dd55d9e3a?s=128&d=identicon&r=PG", "display_name": "jamesdlin", "link": "https://stackoverflow.com/users/179715/jamesdlin"}, "edited": false, "score": 0, "creation_date": 1556087994, "post_id": 55823341, "comment_id": 98312926, "body": "@jamesdlin Of course that requires that the last line isn&#39;t terminated by a newline. Such text files should be banished! ;)"}], "answers": [{"comments": [{"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1556088521, "post_id": 55823434, "comment_id": 98313152, "body": "<code>strlen(line) - 1</code> is a route into disaster."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "reply_to_user": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1556089184, "post_id": 55823434, "comment_id": 98313450, "body": "@alk In general, yes; in this case <code>line</code> cannot be empty (after a successful call to <code>fgets</code>), but it shouldn&#39;t be used in a general <code>exhaustedLine</code> function."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 2, "creation_date": 1556114411, "post_id": 55823434, "comment_id": 98328376, "body": "@melpomene Agree that a line can not be empty after a successful call to <code>fgets()</code>, yet a successful read can begin will a <i>null character</i> and so <code>strlen(line) - 1</code> is a <a href=\"https://stackoverflow.com/questions/55823341/c-fgets-how-to-tell-if-line-is-greater-than-specified-size#comment98313152_55823434\">route to disaster</a> as that evaluates to <code>SIZE_MAX</code>"}, {"owner": {"reputation": 1439, "user_id": 5196093, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ovj7.png?s=128&g=1", "display_name": "Ray", "link": "https://stackoverflow.com/users/5196093/ray"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1556128082, "post_id": 55823434, "comment_id": 98336074, "body": "@chux , alk : Quite right. fgets returns NULL if it fails to read any characters, but if the input stream actually <i>contains</i> a &#39;\\0&#39;, fgets will place \\0\\0 in the buffer and return non-NULL, and strlen(line) will be 0.  I&#39;ve edited the answer accordingly."}], "tags": [], "owner": {"reputation": 1439, "user_id": 5196093, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ovj7.png?s=128&g=1", "display_name": "Ray", "link": "https://stackoverflow.com/users/5196093/ray"}, "is_accepted": false, "score": 2, "last_activity_date": 1556127678, "last_edit_date": 1556127678, "creation_date": 1556086295, "answer_id": 55823434, "question_id": 55823341, "link": "https://stackoverflow.com/questions/55823341/c-fgets-how-to-tell-if-line-is-greater-than-specified-size/55823434#55823434", "title": "C fgets() how to tell if line is greater than specified size", "body": "<p>Your problem is this bit:</p>\n\n<pre><code>line[sizeof line - 1]\n</code></pre>\n\n<p><code>line</code> in this case is a <code>char*</code>, so <code>sizeof line</code> evaluates to the size of the <em>pointer</em>, not the size of the string.  You need to do something like this:</p>\n\n<pre><code>size_t len = strlen(line);\nif (len &amp;&amp; '\\n' == line[len - 1]) ...\n</code></pre>\n\n<p>You don't need to test that <code>line[len] == '\\0'</code>; that is true for all strings.  (Not for all character arrays, mind you, but any standard library function that returns a string will return a null-terminated array.)</p>\n"}, {"comments": [{"owner": {"reputation": 1439, "user_id": 5196093, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ovj7.png?s=128&g=1", "display_name": "Ray", "link": "https://stackoverflow.com/users/5196093/ray"}, "edited": false, "score": 0, "creation_date": 1556087345, "post_id": 55823479, "comment_id": 98312645, "body": "<code>#define BUFFER_SIZE 1024</code> will also work, and is a more idiomatic way of defining constants.  But the enum approach plays better with symbolic debuggers, since the <code>BUFFER_SIZE</code> symbol exists at compile time, whereas the #define approach substitutes <code>BUFFER_SIZE</code> with the literal number during the preprocessing phase, so the debugger will not recognize the symbol."}, {"owner": {"reputation": 46708, "user_id": 179715, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e240f1a5bb197450dfb8934dd55d9e3a?s=128&d=identicon&r=PG", "display_name": "jamesdlin", "link": "https://stackoverflow.com/users/179715/jamesdlin"}, "reply_to_user": {"reputation": 1439, "user_id": 5196093, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ovj7.png?s=128&g=1", "display_name": "Ray", "link": "https://stackoverflow.com/users/5196093/ray"}, "edited": false, "score": 0, "creation_date": 1556087831, "post_id": 55823479, "comment_id": 98312850, "body": "@Ray I&#39;d say that using a <code>#define</code> is more common, but I wouldn&#39;t say it&#39;s idiomatic (or at least, I wouldn&#39;t say that it&#39;s a <i>good</i> idiom)."}, {"owner": {"reputation": 46708, "user_id": 179715, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e240f1a5bb197450dfb8934dd55d9e3a?s=128&d=identicon&r=PG", "display_name": "jamesdlin", "link": "https://stackoverflow.com/users/179715/jamesdlin"}, "edited": false, "score": 0, "creation_date": 1556087929, "post_id": 55823479, "comment_id": 98312904, "body": "<code>is_full_line</code> won&#39;t work for the last line if there&#39;s no terminating newline. (I suppose one might argue whether that&#39;s a &quot;full line&quot;.)"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "reply_to_user": {"reputation": 46708, "user_id": 179715, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e240f1a5bb197450dfb8934dd55d9e3a?s=128&d=identicon&r=PG", "display_name": "jamesdlin", "link": "https://stackoverflow.com/users/179715/jamesdlin"}, "edited": false, "score": 0, "creation_date": 1556088032, "post_id": 55823479, "comment_id": 98312946, "body": "@jamesdlin As I wrote (&quot;<i>... or we are at the end of the file and the last line was unterminated</i>&quot;), that is indeed not a full line."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1556114239, "post_id": 55823479, "comment_id": 98328247, "body": "Pedantically, the various approaches here of finding if &quot;the buffer contains a newline&quot; are broken.  A line of 8 characters <code>&quot;abc\\0xyz\\n&quot;</code> will incorrectly be assessed as not containing a <code>&#39;\\n</code>&#39;."}], "tags": [], "owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "is_accepted": true, "score": 4, "last_activity_date": 1556118692, "last_edit_date": 1556118692, "creation_date": 1556086523, "answer_id": 55823479, "question_id": 55823341, "link": "https://stackoverflow.com/questions/55823341/c-fgets-how-to-tell-if-line-is-greater-than-specified-size/55823479#55823479", "title": "C fgets() how to tell if line is greater than specified size", "body": "<p>You have the right idea: If a complete line was read, the buffer contains a newline. Otherwise the line is either longer than the buffer size or we are at the end of the file and the last line was unterminated.</p>\n\n<p>The main problem with your implementation is <code>char* line</code> ... <code>sizeof line</code>. <code>sizeof</code> yields the size of the type of its operand expression, so <code>sizeof line</code> means <code>sizeof (char *)</code>, which is the size of a pointer, not the size of the array <code>line</code> is pointing into.</p>\n\n<p>Also, if a shorter line was read, then <code>line[SIZE - 1]</code> would access uninitialized memory.</p>\n\n<p>Easiest solution:</p>\n\n<pre><code>int is_full_line(const char *line) {\n    return strchr(line, '\\n') != NULL;\n}\n</code></pre>\n\n<p>Just use <code>strchr</code> to search the string for <code>'\\n'</code>.</p>\n\n<p>To throw away the rest of an overlong line, you have several options:</p>\n\n<ul>\n<li>You could call <code>fgets</code> again in a loop.</li>\n<li>You could call <code>fgetc</code> in a loop: <code>int c; while ((c = fgetc(fp)) != EOF &amp;&amp; c != '\\n') {}</code></li>\n<li>You could use <code>fscanf</code>: <code>fscanf(fp, \"%*[^\\n]\"); fscanf(fp, \"%*1[\\n]\");</code></li>\n</ul>\n\n<hr>\n\n<p>Regarding</p>\n\n<pre><code>int const BUFFER_SIZE = 1024;\n</code></pre>\n\n<p>Note that <code>const</code> does not declare constants in C; it declares read-only variables. <code>char buf[BUFFER_SIZE]</code> is considered a variable-length array because the size is not a constant.</p>\n\n<p>To get a true integer constant in C, you need to use <code>enum</code> instead:</p>\n\n<pre><code>enum { BUFFER_SIZE = 1024 };\n</code></pre>\n"}], "owner": {"reputation": 181, "user_id": 9954397, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb3bc6745688e8113f7fe4e2c50cbfcc?s=128&d=identicon&r=PG&f=1", "display_name": "dmoini", "link": "https://stackoverflow.com/users/9954397/dmoini"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2090, "favorite_count": 0, "accepted_answer_id": 55823479, "answer_count": 2, "score": 4, "last_activity_date": 1556127678, "creation_date": 1556085835, "last_edit_date": 1556086853, "question_id": 55823341, "link": "https://stackoverflow.com/questions/55823341/c-fgets-how-to-tell-if-line-is-greater-than-specified-size", "title": "C fgets() how to tell if line is greater than specified size", "body": "<p>I am using <code>fgets()</code> to read lines from <code>popen(\"ps -ev\", \"r\")</code> and I cannot find out how to know if <code>fgets()</code> reads a line partially or fully, and if partially how to read/throw away the excess.</p>\n\n<p>When reading each line from <code>popen()</code>, I am reading in the first 1024 characters and getting the information I need from that, which works perfectly fine. The issue arises when the lines are greater than 1024 characters and then the next line I read is a continuation of the previous line, which is not in the format I need (that being the value of each column at the beginning of each line). If I can know if I only partially read a line (that being the line has 1024 or more characters, I want to read and throw away every 1024 characters until it reaches the end. Once at the end, I can call <code>fgets()</code> again and this time it will read from the beginning of the next line rather than the continuation of the previous line. </p>\n\n<p>I know that <code>fgets()</code> reads up until it either finds a newline or until it reaches the provided limit, and then continues reading the remaining part of the line. I have tried checking that the last character is '\\0' and that the second last character in the line is '\\n', but that does not work. I will post that code below in case that helps.</p>\n\n<p>If you run the code, you will see <code>LINE: num S num:num.num ...</code> (where <code>num</code> is a number) which is what each line should begin with. Some lines will instead look something like <code>LINE: AAAAAAQAAABMAAAAQAAAAAAAAAAMAAAAFAAAAEAAAAAAAAAADAAAACwAAABA...</code>. These are the lines that are excess from the previous line, and these are the ones causing the issues since they are not in the correct format. </p>\n\n<p>Any and all help is highly appreciated.</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;math.h&gt;\n\n#define NEWLINE() printf(\"\\n\");\n#define DIVIDER() printf(\"============================================================================\\n\");\n#define PL(l) printf(\"LINE: %s\\n\", l);\n\nint const MAX_PROCESSES = 20;\nint const BUFFER_SIZE = 1024;\n\nint exhaustedLine(char* line) {\n    if (line[sizeof line - 1] == '\\0' &amp;&amp; line[sizeof line - 2] != '\\n') {\n        printf(\"n:%c 0:%c\\n\", line[sizeof line - 2], line[sizeof line - 1]);\n        NEWLINE();\n        return -1;\n    }\n    return 0;   \n}\n\nint main(int argc, char const *argv[]) {\n    FILE* fp = popen(\"ps -ev\", \"r\");\n    char buf[BUFFER_SIZE];\n    char* line = (char*)1;\n\n    while (line) {\n        DIVIDER();\n        line = fgets(buf, BUFFER_SIZE, fp);\n        PL(line);\n        if (exhaustedLine(line) != 0) {\n            printf(\"END OF LINE\\n\");\n        }\n    }\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "macos"], "comments": [{"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 2, "creation_date": 1556085538, "post_id": 55823236, "comment_id": 98311948, "body": "You should call <code>srand()</code> only once, at the beginning of the program. Subsequent calls to <code>rand()</code> will change the seed and produce pseudo-trandom numbers."}], "answers": [{"tags": [], "owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "is_accepted": false, "score": 2, "last_activity_date": 1556085622, "creation_date": 1556085622, "answer_id": 55823289, "question_id": 55823236, "link": "https://stackoverflow.com/questions/55823236/rand-function-always-generation-same-number-despite-seeding-with-time/55823289#55823289", "title": "rand() function always generation same number despite seeding with time", "body": "<p>I'm guessing you're calling this function many times in a single second. Since <code>time</code> only changes once a second, you're reseeding the same value over and over.</p>\n\n<p>Don't call <code>srand</code> over and over. Call it exactly once in your <code>main</code> function, then never call it again, and <code>rand</code> will produce successive values based on that seed one at a time.</p>\n"}], "owner": {"reputation": 11, "user_id": 11403259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8646d426a4970051217596414eb33804?s=128&d=identicon&r=PG&f=1", "display_name": "marco42001", "link": "https://stackoverflow.com/users/11403259/marco42001"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "closed_date": 1556095244, "answer_count": 1, "score": 1, "last_activity_date": 1556094608, "creation_date": 1556085320, "last_edit_date": 1556094608, "question_id": 55823236, "link": "https://stackoverflow.com/questions/55823236/rand-function-always-generation-same-number-despite-seeding-with-time", "closed_reason": "Duplicate", "title": "rand() function always generation same number despite seeding with time", "body": "<p>I have this code I need to write, and I created this function. Irrelevant of what it does for the code, I need it to generate a random number (<code>a</code>) between <code>0</code> and (<code>i</code>), an integer with a previously initialized value. Somehow despite seeding, I always get the same number. </p>\n\n<p>I have tried entering a number instead of i and it works properly by giving me a different random number each time I execute. I also tried declaring a new <code>int</code> variable inside in the function and giving it the value of <code>i</code>, but it still doesn't work.</p>\n\n<pre><code>elementptr position_current(elementptr first, int i){\n  elementptr current = first;\n  int j = 1;\n\n  printf(\"%d\\n\", i);\n  srand(time(NULL));\n\n  int a = rand() % i;\n  printf(\"%d\\n\",a);\n  for(j=1;j&lt;a;j++){\n    current = current-&gt;next;\n  }\n\n  return current;\n}\n</code></pre>\n\n<p>I expect (<code>a</code>) to get a different value each Time I run the code, however it's always getting the same value(2).<br>\nCan someone tell me what could be wrong? </p>\n"}, {"tags": ["c", "visual-studio"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1556082086, "post_id": 55822686, "comment_id": 98310869, "body": "Welcome to Stack Overflow. Please read <a href=\"http://stackoverflow.com/help\">the help pages</a>, take <a href=\"http://stackoverflow.com/tour\">the SO tour</a>, read about <a href=\"http://stackoverflow.com/help/how-to-ask\">how to ask good questions</a>, as well as <a href=\"https://codeblog.jonskeet.uk/2012/11/24/stack-overflow-question-checklist/\" rel=\"nofollow noreferrer\">this question checklist</a>. Lastly please learn how to create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 26680, "user_id": 1806780, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/NCB41.jpg?s=128&g=1", "display_name": "Sami Kuhmonen", "link": "https://stackoverflow.com/users/1806780/sami-kuhmonen"}, "edited": false, "score": 2, "creation_date": 1556082642, "post_id": 55822686, "comment_id": 98311015, "body": "Also include how you run it from the command prompt and what arguments you set in Visual Studio for it"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1556082779, "post_id": 55822686, "comment_id": 98311050, "body": "You should also show the code in <code>main()</code> that calls <code>byName()</code>, and any prior argument processing code."}], "answers": [{"tags": [], "owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "is_accepted": false, "score": 1, "last_activity_date": 1556083743, "creation_date": 1556083743, "answer_id": 55822955, "question_id": 55822686, "link": "https://stackoverflow.com/questions/55822686/command-prompt-vs-passing-command-arguments-through-debugging/55822955#55822955", "title": "Command Prompt vs passing command arguments through debugging", "body": "<p>In this loop</p>\n\n<pre><code>while (strcmp(e-&gt;name, name) != 0) {//throws an exception\n    e = e-&gt;next;\n}\n</code></pre>\n\n<p>you go on forever in case <code>name</code> doesn't match any element in the list. Therefore you'll reach the end of the list and use <code>e</code> when it has the value NULL. </p>\n\n<p>Change the loop so it stops if <code>e</code> becomes NULL. Like:</p>\n\n<pre><code>while (e != NULL &amp;&amp; strcmp(e-&gt;name, name) != 0) {//throws an exception\n    e = e-&gt;next;\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11403128, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nBqBwcHGguo/AAAAAAAAAAI/AAAAAAAAAPY/ctMujE78-F0/photo.jpg?sz=128", "display_name": "Josiah Vicolo", "link": "https://stackoverflow.com/users/11403128/josiah-vicolo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 28, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1556083743, "creation_date": 1556081860, "question_id": 55822686, "link": "https://stackoverflow.com/questions/55822686/command-prompt-vs-passing-command-arguments-through-debugging", "title": "Command Prompt vs passing command arguments through debugging", "body": "<p>I am doing a homework assignment, and when I go under the projects properties page, go to debugging, and use the command arguments the program works. If i try to use the command prompt with the appropriate inputs it does not work and throws an exception at me.</p>\n\n<pre><code>void byName(char *name) {\n\n    read();\n    element_t *e = top;\n    while (strcmp(e-&gt;name, name) != 0) {//throws an exception\n        e = e-&gt;next;\n    }\n    if (e == NULL) {\n        printf(\"Error: element not found\");\n    }\n    else {\n        list(e);\n    }\n\n}\n</code></pre>\n\n<p>I don't understand how it can run through visual studios and not throw an exception, while at the same time fail to run through command prompt. It should either throw an exception both ways, or not through an exception either way, right?</p>\n"}, {"tags": ["c", "scanf"], "comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1556080424, "post_id": 55822355, "comment_id": 98310452, "body": "The <code>&#39;*&#39;</code> modifier is the <i>assignment suppression</i> operator telling <code>fscanf</code> to <i>read and discard</i> the characters that would otherwise be matched by the conversion specifier. No pointer argument is required and any characters matched and discarded are not included in the match-count returned. I would read the entire line into a buffer with <code>fgets</code> and then parse the information from the buffer with <code>sscanf</code>."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1556080638, "post_id": 55822355, "comment_id": 98310494, "body": "For further help, please provide <a href=\"http://stackoverflow.com/help/mcve\">A Minimal, Complete, and Verifiable Example (MCVE)</a>. As it sits, your question will likely be closed."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1556082465, "post_id": 55822355, "comment_id": 98310971, "body": "<code>%s</code> won&#39;t stop at a pipe symbol; <code>%[^|]</code> would."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1556082543, "post_id": 55822355, "comment_id": 98310985, "body": "I recommend using <code>fgets()</code> or POSIX <code>getline()</code> to read the line, then consider parsing the line with <code>sscanf()</code>, or maybe using ad hoc methods."}, {"owner": {"reputation": 167, "user_id": 10714273, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c06ac12dcb5e2eb9b00d2a7ee7a77dd?s=128&d=identicon&r=PG", "display_name": "cap", "link": "https://stackoverflow.com/users/10714273/cap"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1556083219, "post_id": 55822355, "comment_id": 98311173, "body": "@DavidC.Rankin so would I need 15 pointers for sscanf? I only wish to know the strings of 2/15 features."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1556083632, "post_id": 55822355, "comment_id": 98311294, "body": "No, works just the same -- but since you read with <code>fgets</code>, a failure in parsing (e.g. <i>matching</i> or <i>input</i> failure) doesn&#39;t screw up your loop control."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1556085274, "post_id": 55822355, "comment_id": 98311852, "body": "@cap, If you are still have problems, if you will edit your question and post a couple lines of sample data, I&#39;ll see if I can help you with a short example to read them and parse what you need from them."}], "answers": [{"comments": [{"owner": {"reputation": 167, "user_id": 10714273, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c06ac12dcb5e2eb9b00d2a7ee7a77dd?s=128&d=identicon&r=PG", "display_name": "cap", "link": "https://stackoverflow.com/users/10714273/cap"}, "edited": false, "score": 0, "creation_date": 1556136449, "post_id": 55823837, "comment_id": 98339646, "body": "could you explain more exactly what the format specifiers are for sscanf?"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 167, "user_id": 10714273, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c06ac12dcb5e2eb9b00d2a7ee7a77dd?s=128&d=identicon&r=PG", "display_name": "cap", "link": "https://stackoverflow.com/users/10714273/cap"}, "edited": false, "score": 0, "creation_date": 1556137240, "post_id": 55823837, "comment_id": 98339941, "body": "Sure <a href=\"http://man7.org/linux/man-pages/man3/scanf.3.html\" rel=\"nofollow noreferrer\">scanf(3) - Linux manual page</a> Take the time to read it. It will probably take an hour to digest (write sample code to test while reading), but that hour spent will save you hundreds of hours of frustration later. Basics, all conversion specifiers consume leading whitespace EXCEPT <code>&#39;%c&quot;</code> and <code>&quot;%[...]&quot;</code>. When filling arrays, ALWAYS use a <i>maximum field-width</i> modifier to protect your array bounds. <code>scanf</code> does not consume the trailing <code>&#39;\\n&#39;</code> (also whitespace) so make sure you handle that appropriately.If you are stuck, comment again."}], "tags": [], "owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "is_accepted": true, "score": 2, "last_activity_date": 1556088121, "creation_date": 1556088121, "answer_id": 55823837, "question_id": 55822355, "link": "https://stackoverflow.com/questions/55822355/using-fscanf-to-read-line-by-line-from-input-file/55823837#55823837", "title": "Using fscanf to read line by line from input file", "body": "<p>If you are still stuck, a short example may help. Looking at your attempted format string, e.g.</p>\n\n<pre><code>\"%*d|%s|%*s|%s|%*d|%*s|%*d|%*s|%*s|%*f|%*f|%*s|%*s|%*f|%*f\"\n</code></pre>\n\n<p>You appear to want to save the 2nd and 4th fields as string values in <code>name</code> and <code>state</code>.</p>\n\n<p>Immediately I suspect you use of <code>&amp;name, &amp;state</code> is incorrect, because, presuming you have declared <code>name</code> and <code>state</code> as character arrays sufficiently sized to hold the data in the 2nd and 4th fields, <code>name</code> and <code>state</code> are already pointers (see: <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.3.2.1p3\" rel=\"nofollow noreferrer\">C11 Standard - 6.3.2.1 Other Operands - Lvalues, arrays, and function designators(p3)</a>), so there is no need for an <code>'&amp;'</code> preceding the variable names. If they were not declared as character arrays (or as pointers to arrays and allocated sufficient memory), your parse would fail anyway due to incompatible types.</p>\n\n<p>Next, why it is so important to read the entire line with <code>fgets()</code> or POSIX <code>getline()</code> and then parse with <code>sscanf()</code> instead of using <code>fscanf()</code>:</p>\n\n<ol>\n<li>your read will fail if there is any <em>matching</em> or <em>input</em> failure with any one of the 15 fields; and</li>\n<li>you only care about the 2nd and 4th fields -- there is no need to make your read dependent on the successful parse of 15 fields when you only care about two of them.</li>\n</ol>\n\n<p>So rather than having to worry about a correct match of 15 fields, you only need worry about 4 -- you don't care about the rest of the line after the 4th field.</p>\n\n<p>Putting a small example together with randomly generated data (adjust the buffer sizes as needed for your data), you could do something like the following to parse the 2nd and 4th fields as strings:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\n#define FLDW   32   /* max field width */\n#define MAXC 1024   /* max chars in line */\n\nint main (int argc, char **argv) {\n\n    char buf[MAXC],     /* line buffer */\n        name[FLDW],     /* storage for name */\n        state[FLDW];    /* storage for state */\n\n    /* use filename provided as 1st argument (stdin by default) */\n    FILE *fp = argc &gt; 1 ? fopen (argv[1], \"r\") : stdin;\n\n    if (!fp) {  /* validate file open for reading */\n        perror (\"file open failed\");\n        return 1;\n    }\n\n    while (fgets (buf, MAXC, fp)) { /* read each line of input */\n        /* parse 2nd &amp; 4th fields as strings - you don't care about rest */\n        if (sscanf (buf, \"%*d|%31[^|]|%*[^|]|%31[^|]\", name, state) == 2) {\n            buf[strcspn (buf, \"\\n\")] = 0;   /* trim \\n from buf */\n            /* output line with parsed name and state to right */\n            printf (\"%s  =&gt;  name: %s, state: %s\\n\", buf, name, state);\n        }\n    }\n    if (fp != stdin) fclose (fp);   /* close file if not stdin */\n\n    return 0;\n}\n</code></pre>\n\n<p>(<strong>note:</strong> the use of a <em>field-width</em> modifier to protect the array bounds of <code>name</code> and <code>state</code> with <code>%31[^|]</code>. The use of <code>strcspn</code> was just to trim the <code>'\\n'</code> from the end of <code>buf</code> so <code>name</code> and <code>state</code> values would print on the same line following outputting <code>buf</code>. If you are not printing <code>buf</code>, then you don't need that call at all for parsing purposes)</p>\n\n<p><strong>Example Use/Output</strong></p>\n\n<p>Minimum data generated matching your format string. Parsing the 2nd and 4th values would yield the desired strings in <code>name</code> and <code>state</code>, e.g.</p>\n\n<pre><code>$ ./bin/fgetssscanf dat/field15pipes.txt\n01|8a|0b|6c|82|1d|33|5e|4f|7.|0.|4g|3h|7.|5.  =&gt;  name: 8a, state: 6c\n01|9a|5b|0c|42|1d|93|3e|9f|8.|0.|5g|4h|6.|5.  =&gt;  name: 9a, state: 0c\n01|4a|5b|7c|22|0d|23|1e|1f|7.|2.|1g|5h|7.|7.  =&gt;  name: 4a, state: 7c\n01|8a|2b|5c|72|1d|53|6e|2f|1.|1.|8g|0h|7.|6.  =&gt;  name: 8a, state: 5c\n11|4a|6b|5c|92|2d|73|0e|6f|4.|2.|2g|7h|2.|4.  =&gt;  name: 4a, state: 5c\n01|2a|6b|0c|02|1d|83|0e|2f|5.|2.|9g|4h|3.|8.  =&gt;  name: 2a, state: 0c\n31|1a|0b|0c|72|2d|13|3e|3f|9.|0.|2g|5h|6.|9.  =&gt;  name: 1a, state: 0c\n01|8a|3b|7c|92|1d|93|3e|9f|6.|1.|4g|4h|8.|3.  =&gt;  name: 8a, state: 7c\n11|1a|4b|7c|42|2d|73|0e|5f|7.|0.|0g|5h|1.|7.  =&gt;  name: 1a, state: 7c\n21|8a|6b|9c|22|2d|23|2e|1f|9.|0.|1g|6h|6.|8.  =&gt;  name: 8a, state: 9c\n</code></pre>\n\n<p>Look things over and let me know if you have questions.</p>\n"}], "owner": {"reputation": 167, "user_id": 10714273, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c06ac12dcb5e2eb9b00d2a7ee7a77dd?s=128&d=identicon&r=PG", "display_name": "cap", "link": "https://stackoverflow.com/users/10714273/cap"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 429, "favorite_count": 0, "accepted_answer_id": 55823837, "answer_count": 1, "score": 1, "last_activity_date": 1556088121, "creation_date": 1556079408, "question_id": 55822355, "link": "https://stackoverflow.com/questions/55822355/using-fscanf-to-read-line-by-line-from-input-file", "title": "Using fscanf to read line by line from input file", "body": "<p>I am reading in from a file that has 15 features separated by the '|' symbol. I am using:  <code>while(fscanf(file, \"%*d|%s|%*s|%s|%*d|%*s|%*d|%*s|%*s|%*f|%*f|%*s|%*s|%*f|%*f\", &amp;name, &amp;state)==2)</code> but when I ran gdb on it I realized it never actually entered the loop. I used <code>%*d/s</code> because it tells <code>fscanf</code> to skip over these values correct? I only want to read in 2 values of the entire line from the input, the two %s near the beginning. \nAny suggestions on how to fix? Sorry for not optimal formatting.</p>\n"}, {"tags": ["c", "r", "md5", "digest"], "comments": [{"owner": {"reputation": 656, "user_id": 9592917, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fe6504c31f4954495f952699592361a?s=128&d=identicon&r=PG&f=1", "display_name": "Bwebb", "link": "https://stackoverflow.com/users/9592917/bwebb"}, "edited": false, "score": 0, "creation_date": 1556078518, "post_id": 55822124, "comment_id": 98310088, "body": "does the uint32 wrap around?  if so then it matters, if it doesnt than the only change i could think of would be using 2 times the memory."}, {"owner": {"reputation": 1642, "user_id": 2726309, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/051f1ed22ee7660c986a1e47cf4f7040?s=128&d=identicon&r=PG&f=1", "display_name": "kennyB", "link": "https://stackoverflow.com/users/2726309/kennyb"}, "reply_to_user": {"reputation": 656, "user_id": 9592917, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fe6504c31f4954495f952699592361a?s=128&d=identicon&r=PG&f=1", "display_name": "Bwebb", "link": "https://stackoverflow.com/users/9592917/bwebb"}, "edited": false, "score": 0, "creation_date": 1556080840, "post_id": 55822124, "comment_id": 98310536, "body": "I presume that the uint32 wraps around, so that the <code>md5</code> hash (incorrectly) starts digesting the start of the object again. This is the behavior I want to avoid, of course."}], "answers": [{"comments": [{"owner": {"reputation": 1642, "user_id": 2726309, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/051f1ed22ee7660c986a1e47cf4f7040?s=128&d=identicon&r=PG&f=1", "display_name": "kennyB", "link": "https://stackoverflow.com/users/2726309/kennyb"}, "edited": false, "score": 0, "creation_date": 1556081810, "post_id": 55822246, "comment_id": 98310803, "body": "This is helpful, thanks. So, if the compiler supports C99, switching out the 32 bit integers for 64 bit integers should 1) fix the bug, and 2) not ruin anything else other than memory usage?"}, {"owner": {"reputation": 24693, "user_id": 10190237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f95f50f67af8a9658c5d76df263b323?s=128&d=identicon&r=PG&f=1", "display_name": "P.W", "link": "https://stackoverflow.com/users/10190237/p-w"}, "reply_to_user": {"reputation": 1642, "user_id": 2726309, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/051f1ed22ee7660c986a1e47cf4f7040?s=128&d=identicon&r=PG&f=1", "display_name": "kennyB", "link": "https://stackoverflow.com/users/2726309/kennyb"}, "edited": false, "score": 0, "creation_date": 1556082090, "post_id": 55822246, "comment_id": 98310872, "body": "I do not know if the bug is only due to the overflow. If it is, then it would be fixed. But then it should also be tested well before release."}, {"owner": {"reputation": 1642, "user_id": 2726309, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/051f1ed22ee7660c986a1e47cf4f7040?s=128&d=identicon&r=PG&f=1", "display_name": "kennyB", "link": "https://stackoverflow.com/users/2726309/kennyb"}, "edited": false, "score": 0, "creation_date": 1556082126, "post_id": 55822246, "comment_id": 98310880, "body": "How would one test if it&#39;s due to the overflow or not?"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 1642, "user_id": 2726309, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/051f1ed22ee7660c986a1e47cf4f7040?s=128&d=identicon&r=PG&f=1", "display_name": "kennyB", "link": "https://stackoverflow.com/users/2726309/kennyb"}, "edited": false, "score": 0, "creation_date": 1556088511, "post_id": 55822246, "comment_id": 98313147, "body": "@kennyB test if the `length parameter is larger than 32 bits?"}], "tags": [], "owner": {"reputation": 24693, "user_id": 10190237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f95f50f67af8a9658c5d76df263b323?s=128&d=identicon&r=PG&f=1", "display_name": "P.W", "link": "https://stackoverflow.com/users/10190237/p-w"}, "is_accepted": false, "score": 0, "last_activity_date": 1556078590, "creation_date": 1556078590, "answer_id": 55822246, "question_id": 55822124, "link": "https://stackoverflow.com/questions/55822124/is-swapping-uint32-for-uint64-benign-other-than-possibly-memory-usage/55822246#55822246", "title": "Is swapping uint32 for uint64 benign other than (possibly) memory usage?", "body": "<p>On a 32-bit system, a 64-bit integer is usually implemented using two 32-bit registers. \nOperations on such an integer result in two instructions for load and store. For something like addition, add with carry is used.\nThis is something the compiler takes care of. </p>\n\n<p>You should only make sure that the compiler you are using supports such a type. </p>\n\n<p>For example, the signed and unsigned versions of <code>long long int</code> (which should be at least 64 bits) were introduced in C99. So you should use a compiler has support for this feature of the C99 standard.</p>\n"}, {"comments": [{"owner": {"reputation": 1642, "user_id": 2726309, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/051f1ed22ee7660c986a1e47cf4f7040?s=128&d=identicon&r=PG&f=1", "display_name": "kennyB", "link": "https://stackoverflow.com/users/2726309/kennyb"}, "edited": false, "score": 0, "creation_date": 1556081401, "post_id": 55822532, "comment_id": 98310696, "body": "Can you make this answer a bit more constructive? e.g. how would one validate a modification of an md5 algorithm? To be clear in the above case, the <i>same</i> code disagrees across Windows (compiled with gcc 4.9.3) and Linux (compiled with a more modern gcc). How would one prevent 32-bit integer overflow if not by swapping out for longer integer types?"}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "reply_to_user": {"reputation": 1642, "user_id": 2726309, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/051f1ed22ee7660c986a1e47cf4f7040?s=128&d=identicon&r=PG&f=1", "display_name": "kennyB", "link": "https://stackoverflow.com/users/2726309/kennyb"}, "edited": false, "score": 1, "creation_date": 1556084184, "post_id": 55822532, "comment_id": 98311478, "body": "@kennyb: at a minimum, you would need to check that  the modified code computes the correct hash codes for a reasonable number of test cases. I would also want to construct a good argument that the integer overflow happens and disrupts the algorithm, which would be a lot easier for whoever wrote the code. In other words, I&#39;d be looking for a more substantive claim than &quot;with thus modification, the hashes for X and Y are now different.&quot; Certainly you would fix overflow by using a wider type, but there might also be some use of a value known to have been reduced modulo 2^32."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "reply_to_user": {"reputation": 1642, "user_id": 2726309, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/051f1ed22ee7660c986a1e47cf4f7040?s=128&d=identicon&r=PG&f=1", "display_name": "kennyB", "link": "https://stackoverflow.com/users/2726309/kennyb"}, "edited": false, "score": 0, "creation_date": 1556084536, "post_id": 55822532, "comment_id": 98311602, "body": "In other words, I don&#39;t consider myself sufficiently knowledgeable about MD5 to render public judgement about the validity of an unreviewed patch. Maybe someone else here is, but in general terms for crypto software, I&#39;d want the patch to be reviewed by the author and/or some crypto experts. There is a crypto stackexchange, fwiw."}], "tags": [], "owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "is_accepted": false, "score": 0, "last_activity_date": 1556084212, "last_edit_date": 1556084212, "creation_date": 1556080809, "answer_id": 55822532, "question_id": 55822124, "link": "https://stackoverflow.com/questions/55822124/is-swapping-uint32-for-uint64-benign-other-than-possibly-memory-usage/55822532#55822532", "title": "Is swapping uint32 for uint64 benign other than (possibly) memory usage?", "body": "<p>The MD5 hash of a string is a unique well-defined value, which is a vital feature of the MD5 hash. It allows it to be used for verification. (Although cryptographic use of MD5 has been deprecated for some time.)</p>\n\n<p>So if a particular library produces the wrong hash value, that's a bug, and a pretty serious one, and it should be reported as such to the package author. There are reference implementations of the MD5 hash which can be used to obtain the correct hash value, but the <code>md5sum</code> command is highly likely to be correct as well, which might be a simpler check.</p>\n\n<p>It is certainly possible that the bug in question, if you can verify that it is a bug, is the result of an unexpected 32-bit integer overflow. But modifying crypto libraries is not a casual acitvity, even buggy implementations of deprecated alogorithms. \"It seems to work\" is usually not an adequate algorithm validation. I would caution against using an unvalidated modification. But it's a useful hint for the library maintainer.</p>\n"}], "owner": {"reputation": 1642, "user_id": 2726309, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/051f1ed22ee7660c986a1e47cf4f7040?s=128&d=identicon&r=PG&f=1", "display_name": "kennyB", "link": "https://stackoverflow.com/users/2726309/kennyb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 84, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1556084212, "creation_date": 1556077619, "last_edit_date": 1556078786, "question_id": 55822124, "link": "https://stackoverflow.com/questions/55822124/is-swapping-uint32-for-uint64-benign-other-than-possibly-memory-usage", "title": "Is swapping uint32 for uint64 benign other than (possibly) memory usage?", "body": "<h1>Background</h1>\n\n<p>I recently found that <code>md5</code> hashes on large <code>R</code> objects using the <code>digest</code> package did not change when making small changes. This appears to be due to some 32 bit counter variables getting overflowed and the algorithm missing the changed portion of the file.</p>\n\n<p>Using the current development version of <code>digest</code> on Linux, hashes notice these small changes on large files whereas on Windows, these small changes get missed.</p>\n\n<p>I made the following changes to the current dev version, which swaps a few <code>unsigned long int</code> (<code>unit32</code>) variables for <code>unsigned long long int</code> (<code>uint64</code>) variables:</p>\n\n<p><a href=\"https://github.com/eddelbuettel/digest/compare/master...kendonB:testmd5\" rel=\"nofollow noreferrer\">https://github.com/eddelbuettel/digest/compare/master...kendonB:testmd5</a></p>\n\n<p>and now on Windows the problem is fixed and the hashes notice the changes.</p>\n\n<h1>Question</h1>\n\n<p>Is swapping out these 32-bit integer variables for 64-bit integer variables benign? Will anything get ruined on 32-bit systems? On obscure systems? Can anything go wrong?</p>\n\n<h2>Further background</h2>\n\n<p><a href=\"https://github.com/eddelbuettel/digest/issues/97\" rel=\"nofollow noreferrer\">https://github.com/eddelbuettel/digest/issues/97</a></p>\n"}, {"tags": ["c++", "c"], "comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 6, "creation_date": 1556077388, "post_id": 55822068, "comment_id": 98309868, "body": "Welcome to <i>Undefined Behavior</i> - <code>tst_struct *tst1;</code> declares an <i>uninitialized</i> pointer - it&#39;s value is indeterminate. Same for <code>tst_struct *tst2;</code>. The address held be each pointer is simply garbage until assigned a valid memory address. Answer the question &quot;What address does <code>tst1</code> hold before I attempt to print that value?&quot; If your answer is &quot;I don&#39;t know...&quot; don&#39;t print it <code>:)</code>"}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 3, "creation_date": 1556077394, "post_id": 55822068, "comment_id": 98309869, "body": "Using the values of uninitialized variables is undefined behavior. Don&#39;t try to make sense of it."}, {"owner": {"reputation": 17580, "user_id": 493106, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/48b0c7ab491edf2f69e63773181a22b5?s=128&d=identicon&r=PG", "display_name": "xaxxon", "link": "https://stackoverflow.com/users/493106/xaxxon"}, "edited": false, "score": 0, "creation_date": 1556078290, "post_id": 55822068, "comment_id": 98310033, "body": "Just always initialize your variables and don&#39;t worry about it :)"}, {"owner": {"reputation": 51, "user_id": 8923320, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec6718feae27fa914e4f214e1722e9b3?s=128&d=identicon&r=PG&f=1", "display_name": "roger taht", "link": "https://stackoverflow.com/users/8923320/roger-taht"}, "edited": false, "score": 0, "creation_date": 1556078401, "post_id": 55822068, "comment_id": 98310060, "body": "But in that case, i want to start to build a list. So for me, is necessary to start with a empty value to make a if statement like (!tst); So to do that, you guys recommend to simple after create, set tst = NULL? Cause if i try to access that, will get seg fault"}, {"owner": {"reputation": 51, "user_id": 8923320, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec6718feae27fa914e4f214e1722e9b3?s=128&d=identicon&r=PG&f=1", "display_name": "roger taht", "link": "https://stackoverflow.com/users/8923320/roger-taht"}, "edited": false, "score": 0, "creation_date": 1556078426, "post_id": 55822068, "comment_id": 98310065, "body": "on that specific projects i have a limit of 25 lines per function, so dont want to waste to much lines"}, {"owner": {"reputation": 6828, "user_id": 8990329, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f073ad236ccf499ebfbe504bc79a2096?s=128&d=identicon&r=PG&f=1", "display_name": "Some Name", "link": "https://stackoverflow.com/users/8990329/some-name"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1556081276, "post_id": 55822068, "comment_id": 98310657, "body": "@DavidC.Rankin But uninitialized variables takes unspecified values and usage of such unspecified values results in unspecified behavior, not undefined. The behavior is undefined since we have to cast <code>tst_struct *</code> to <code>void *</code> explicitly in order to use with <code>%p</code> in place of the ellipsis."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1556081607, "post_id": 55822068, "comment_id": 98310754, "body": "Well granted, we can word-smith that down to the exact language of the standard, but the result is the same whether unspecified or undefined -- the train has already fallen off the tracks. Have you made that same comment in response to R Sahu?"}, {"owner": {"reputation": 6828, "user_id": 8990329, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f073ad236ccf499ebfbe504bc79a2096?s=128&d=identicon&r=PG&f=1", "display_name": "Some Name", "link": "https://stackoverflow.com/users/8990329/some-name"}, "reply_to_user": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 0, "creation_date": 1556192701, "post_id": 55822068, "comment_id": 98358876, "body": "@RSahu Uninitialized variables take unspecified values. Usage of unspecified values is unspecified behavior, not undefined. <code>N1570, 3.4.4. Unspecified behavior</code>: <i>use of an unspecified value</i>"}], "answers": [{"comments": [{"owner": {"reputation": 17580, "user_id": 493106, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/48b0c7ab491edf2f69e63773181a22b5?s=128&d=identicon&r=PG", "display_name": "xaxxon", "link": "https://stackoverflow.com/users/493106/xaxxon"}, "edited": false, "score": 0, "creation_date": 1556078316, "post_id": 55822106, "comment_id": 98310039, "body": "Getting UB that looks like what you want is the opposite of lucky - it&#39;s the hardest bug to find."}], "tags": [], "owner": {"reputation": 6746, "user_id": 8185995, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02d69271095c22ec7a2f5cad43ea3ac0?s=128&d=identicon&r=PG&f=1", "display_name": "robthebloke", "link": "https://stackoverflow.com/users/8185995/robthebloke"}, "is_accepted": false, "score": 2, "last_activity_date": 1556077496, "creation_date": 1556077496, "answer_id": 55822106, "question_id": 55822068, "link": "https://stackoverflow.com/questions/55822068/memory-address-inside-a-function/55822106#55822106", "title": "Memory address inside a function", "body": "<p>Undefined behaviour. If the value is zero, you're lucky. You've got an uninitialised variable, and are wondering why it has a random value? You may get zero in main, or in a debug build <em>(which tends to init memory to zero)</em>, or you may not. It depends on the compiler/os/cpu, and it should never be taken for granted. It could be anything, because it's undefined.</p>\n"}, {"tags": [], "owner": {"reputation": 79, "user_id": 10616174, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82f94a59a724570eba9271e2d877ac07?s=128&d=identicon&r=PG&f=1", "display_name": "adeishs", "link": "https://stackoverflow.com/users/10616174/adeishs"}, "is_accepted": false, "score": 1, "last_activity_date": 1556079518, "last_edit_date": 1556079518, "creation_date": 1556079145, "answer_id": 55822313, "question_id": 55822068, "link": "https://stackoverflow.com/questions/55822068/memory-address-inside-a-function/55822313#55822313", "title": "Memory address inside a function", "body": "<p>Undefined behaviours here.</p>\n\n<p>First, I\u2019ll just assume that you\u2019ve included <code>&lt;stdio.h&gt;</code>.</p>\n\n<p><code>tst1</code> is uninitialised. If you try to print the value, one of the possibilities is that you get <code>0x0</code>. But, anything else can happen. Same thing with <code>tst2</code>.</p>\n\n<p>Another thing, when you use <code>%p</code> format specifier in <code>printf()</code>, to be strictly conforming, you need to supply a <code>void *</code>. Therefore, strictly speaking, you should use, for example:</p>\n\n<pre><code>printf(\"P outside function1: %p \\n\", (void *)tst1);\n</code></pre>\n\n<p>See <a href=\"https://stackoverflow.com/a/24867850/10616174\">https://stackoverflow.com/a/24867850/10616174</a></p>\n"}], "owner": {"reputation": 51, "user_id": 8923320, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec6718feae27fa914e4f214e1722e9b3?s=128&d=identicon&r=PG&f=1", "display_name": "roger taht", "link": "https://stackoverflow.com/users/8923320/roger-taht"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1556079518, "creation_date": 1556077189, "question_id": 55822068, "link": "https://stackoverflow.com/questions/55822068/memory-address-inside-a-function", "title": "Memory address inside a function", "body": "<h2>MAIN</h2>\n\n<pre><code>tst_struct *tst1;\nprintf(\"P outside function1: %p \\n\", tst1); //Output: 0x0\ntst_func(tst1);\n</code></pre>\n\n<h2>Function</h2>\n\n<pre><code>tst_struct *tst_func(tst_struct *tst1)\n{\n    printf(\"P from param: %p \\n\",tst1);  // Output 0x0\n    tst_struct *tst2;\n    printf(\"P inside function: %p \\n\", tst2); // Output 0x7ffeebcf8940\n}\n</code></pre>\n\n<p>I dont understand why that happened.</p>\n\n<p>I did the same thing in both functions.</p>\n\n<p>If i create a variable and check for address on main, without assign any value, result is 0x0.</p>\n\n<p>But if i create any variable inside another function, i receive an addresss.</p>\n\n<p>There is some difference between main and \"normal\" functions?\nThanks</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1556073981, "post_id": 55821653, "comment_id": 98309275, "body": "How would that loop exit unless <code>x</code> changes? Theoretically if you run this long enough you&#39;ll get a bit flip error from a cosmic ray, but the odds of that are really low. It could take 1000 years to happen."}, {"owner": {"reputation": 134, "user_id": 10634115, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Can &#214;zlemi\u015f", "link": "https://stackoverflow.com/users/10634115/can-%c3%96zlemi%c5%9f"}, "edited": false, "score": 0, "creation_date": 1556074145, "post_id": 55821653, "comment_id": 98309303, "body": "Please write your full source code for us to give you a better answer, Right now whatever we say will be unclear cause we have to make guesses on the code"}, {"owner": {"reputation": 23, "user_id": 10741340, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/--JwpRSvRR0Y/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-gt8-Tv2yT7t03yTuZ1kiSMEmp0yA/mo/photo.jpg?sz=128", "display_name": "ender987", "link": "https://stackoverflow.com/users/10741340/ender987"}, "edited": false, "score": 0, "creation_date": 1556075279, "post_id": 55821653, "comment_id": 98309511, "body": "thanks for the input! That was all that was available to me from the question in my homework. And I did do some research, however the stuff I came across was beyond me since I am just in my first year of c programming!"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1556077019, "post_id": 55821653, "comment_id": 98309812, "body": "This code can terminate in C! C 2018 6.5 5 says \u201cA loop that, outside of the <i>for-init-statement</i> in the case of a <code>for</code> statement, \u2014 makes no calls to library I/O functions, and \u2014 does not access or modify volatile objects, and \u2014 performs no synchronization operations (1.10) or atomic operations (Clause 29) may be assumed by the implementation to terminate.\u201d"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 10741340, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/--JwpRSvRR0Y/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-gt8-Tv2yT7t03yTuZ1kiSMEmp0yA/mo/photo.jpg?sz=128", "display_name": "ender987", "link": "https://stackoverflow.com/users/10741340/ender987"}, "edited": false, "score": 0, "creation_date": 1556075308, "post_id": 55821690, "comment_id": 98309515, "body": "Thanks for your answer, much appreciated"}], "tags": [], "owner": {"reputation": 3657, "user_id": 8170714, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/OqwAS.jpg?s=128&g=1", "display_name": "Jack", "link": "https://stackoverflow.com/users/8170714/jack"}, "is_accepted": false, "score": 1, "last_activity_date": 1556074137, "creation_date": 1556074137, "answer_id": 55821690, "question_id": 55821653, "link": "https://stackoverflow.com/questions/55821653/c-programming-is-this-an-infinite-loop/55821690#55821690", "title": "C programming, Is this an infinite loop?", "body": "<p>Yes it is an infinite loop since the condition to exit the loop will never be met: as the variable x is never changed inside the loop, the loop's condition will always be true.</p>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 10741340, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/--JwpRSvRR0Y/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-gt8-Tv2yT7t03yTuZ1kiSMEmp0yA/mo/photo.jpg?sz=128", "display_name": "ender987", "link": "https://stackoverflow.com/users/10741340/ender987"}, "edited": false, "score": 0, "creation_date": 1556075311, "post_id": 55821704, "comment_id": 98309516, "body": "Thanks for your answer, much appreciated"}], "tags": [], "owner": {"reputation": 169, "user_id": 7934027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8dcf3f4bb5884816ad8a5f28d51d791?s=128&d=identicon&r=PG&f=1", "display_name": "Alejandro Garcia", "link": "https://stackoverflow.com/users/7934027/alejandro-garcia"}, "is_accepted": false, "score": 1, "last_activity_date": 1556074238, "creation_date": 1556074238, "answer_id": 55821704, "question_id": 55821653, "link": "https://stackoverflow.com/questions/55821653/c-programming-is-this-an-infinite-loop/55821704#55821704", "title": "C programming, Is this an infinite loop?", "body": "<p>Yes, it's an infinite loop. Remember, while the condition is true the while loop will continue. As 5 will always be equal to 5 the condition will always be true, even if you don't do anything inside the while loop.</p>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 10741340, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/--JwpRSvRR0Y/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-gt8-Tv2yT7t03yTuZ1kiSMEmp0yA/mo/photo.jpg?sz=128", "display_name": "ender987", "link": "https://stackoverflow.com/users/10741340/ender987"}, "edited": false, "score": 0, "creation_date": 1556075375, "post_id": 55821721, "comment_id": 98309530, "body": "Thanks for your answer, much appreciated. I&#39;m not trying to change the value of X is was just a homework question and that was all the info given to me. Thanks for extra input though!"}], "tags": [], "owner": {"reputation": 36, "user_id": 10438278, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ezjUP4NjMg4/AAAAAAAAAAI/AAAAAAAAAUQ/e505R2csC9U/photo.jpg?sz=128", "display_name": "Taimander", "link": "https://stackoverflow.com/users/10438278/taimander"}, "is_accepted": true, "score": 1, "last_activity_date": 1556074405, "creation_date": 1556074405, "answer_id": 55821721, "question_id": 55821653, "link": "https://stackoverflow.com/questions/55821653/c-programming-is-this-an-infinite-loop/55821721#55821721", "title": "C programming, Is this an infinite loop?", "body": "<p>Yes it is, but it could actually leave the loop in some scenarios:</p>\n\n<ul>\n<li>There is a thread that changes the x variable.</li>\n<li>An external program modifies the program memory.</li>\n<li>As tadman said, a bitflip occurs on the memory itself, which is very unlikely but also a possibility.</li>\n</ul>\n\n<p>There must be other cases where the loop can end, but those are the ones I could think of. </p>\n\n<p>If you're interested, you can try to do so with Cheat Engine to change the value of x.</p>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 10741340, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/--JwpRSvRR0Y/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-gt8-Tv2yT7t03yTuZ1kiSMEmp0yA/mo/photo.jpg?sz=128", "display_name": "ender987", "link": "https://stackoverflow.com/users/10741340/ender987"}, "edited": false, "score": 0, "creation_date": 1556075951, "post_id": 55821835, "comment_id": 98309645, "body": "So we are not suppose to change the code, its a true or false. So I am not trying to fix the code. So by adding {} after the while would defeat the purpose of using the code. I appreciate your input."}, {"owner": {"reputation": 160, "user_id": 7184594, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a248c617d822f07c15f1d98ec51ee86d?s=128&d=identicon&r=PG&f=1", "display_name": "Comet", "link": "https://stackoverflow.com/users/7184594/comet"}, "reply_to_user": {"reputation": 23, "user_id": 10741340, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/--JwpRSvRR0Y/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-gt8-Tv2yT7t03yTuZ1kiSMEmp0yA/mo/photo.jpg?sz=128", "display_name": "ender987", "link": "https://stackoverflow.com/users/10741340/ender987"}, "edited": false, "score": 0, "creation_date": 1556077028, "post_id": 55821835, "comment_id": 98309813, "body": "I understand. The code above will visually show you what is happening. If your up for learning."}], "tags": [], "owner": {"reputation": 160, "user_id": 7184594, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a248c617d822f07c15f1d98ec51ee86d?s=128&d=identicon&r=PG&f=1", "display_name": "Comet", "link": "https://stackoverflow.com/users/7184594/comet"}, "is_accepted": false, "score": 0, "last_activity_date": 1556075314, "creation_date": 1556075314, "answer_id": 55821835, "question_id": 55821653, "link": "https://stackoverflow.com/questions/55821653/c-programming-is-this-an-infinite-loop/55821835#55821835", "title": "C programming, Is this an infinite loop?", "body": "<p>try:</p>\n\n<pre><code>void main() {\n    int x = 5;\n    while (x == 5){\n        printf(\"%d\\n\", x);\n    } \n}\n</code></pre>\n\n<p>Use format %d for doubles</p>\n"}], "owner": {"reputation": 23, "user_id": 10741340, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/--JwpRSvRR0Y/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-gt8-Tv2yT7t03yTuZ1kiSMEmp0yA/mo/photo.jpg?sz=128", "display_name": "ender987", "link": "https://stackoverflow.com/users/10741340/ender987"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 55821721, "answer_count": 4, "score": -2, "last_activity_date": 1556088599, "creation_date": 1556073869, "last_edit_date": 1556088599, "question_id": 55821653, "link": "https://stackoverflow.com/questions/55821653/c-programming-is-this-an-infinite-loop", "title": "C programming, Is this an infinite loop?", "body": "<p>What would happen if the follow lines were a part of a compiled program?</p>\n\n<pre><code>void main() {\n    int x = 5;\n    while (x == 5); \n}//end main\n</code></pre>\n\n<p>I believe it is, I have compiled it, and the screen just stays the same, I also tried to add after the while statement </p>\n\n<pre><code>int y = 10;\nprintf(\"%i\", y);\n</code></pre>\n\n<p>and then end main. However it never prints. So I am fairly certain that its an infinite loop but I would just like to be sure.</p>\n"}, {"tags": ["c", "powershell", "stdout"], "answers": [{"comments": [{"owner": {"reputation": 160, "user_id": 7184594, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a248c617d822f07c15f1d98ec51ee86d?s=128&d=identicon&r=PG&f=1", "display_name": "Comet", "link": "https://stackoverflow.com/users/7184594/comet"}, "edited": false, "score": 0, "creation_date": 1556583081, "post_id": 55827052, "comment_id": 98479327, "body": "Sorry mate, long week,  I&#39;ll give you props now. yes, I found running scripts instead would be wiser. cheers."}], "tags": [], "owner": {"reputation": 87, "user_id": 11312923, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-rVI03KKmp5w/AAAAAAAAAAI/AAAAAAAAMZY/bElT8ql2HpE/photo.jpg?sz=128", "display_name": "Gon&#231;alo Garrido", "link": "https://stackoverflow.com/users/11312923/gon%c3%a7alo-garrido"}, "is_accepted": true, "score": 1, "last_activity_date": 1556099800, "last_edit_date": 1556099800, "creation_date": 1556098988, "answer_id": 55827052, "question_id": 55821580, "link": "https://stackoverflow.com/questions/55821580/how-to-read-powershell-stdout/55827052#55827052", "title": "How to read PowerShell StdOut", "body": "<p>Try reading this :\n<a href=\"https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_redirection?view=powershell-6\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_redirection?view=powershell-6</a>?</p>\n\n<p>And try this: </p>\n\n<pre><code>$OutputVariable = (Shell command) | Out-String\n</code></pre>\n\n<p>or </p>\n\n<pre><code>\"$params = \"/verify $pc /domain:hosp.uhhg.org\"\nstart-process \"netdom.exe\" $params -WindowStyle Hidden -Wait\"\n</code></pre>\n"}], "owner": {"reputation": 160, "user_id": 7184594, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a248c617d822f07c15f1d98ec51ee86d?s=128&d=identicon&r=PG&f=1", "display_name": "Comet", "link": "https://stackoverflow.com/users/7184594/comet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 290, "favorite_count": 0, "accepted_answer_id": 55827052, "answer_count": 1, "score": 0, "last_activity_date": 1556099800, "creation_date": 1556073236, "last_edit_date": 1556098283, "question_id": 55821580, "link": "https://stackoverflow.com/questions/55821580/how-to-read-powershell-stdout", "title": "How to read PowerShell StdOut", "body": "<p>I have code to invoke <code>CreateProcess()</code> and get the handles for StdIn &amp; StdOut.\nI have used it with CMD and it works fine. However, I started PowerShell\nwith it and PowerShell did not play nice. It basically exploited my program\nand took over the thread.</p>\n\n<p>This led me to debug of course and I found that as soon as the <code>ReadFile()</code>\nfunction reads PowerShells output, it's all over. Interesting.</p>\n\n<p>So my question is: In what format does PowerShell send output to StdOut?</p>\n\n<p>I heard it talks in \"Objects\", but it seems to output raw machine code.</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>DWORD WINAPI threadRead(HANDLE *cmdStd_OUT_RD) {\n    char *chBuff = malloc(READ_BUFFER_SM);\n    int check = 0;\n    for (;;) {\n        dwRead = 0;  //Global Variable\n        check = 0;\n        memset(chBuff, 0, READ_BUFFER_SM);\n        puts(\"Reading..\\n\");\n        check = ReadFile(*cmdStd_OUT_RD, chBuff, READ_BUFFER_SM, &amp;dwRead, NULL);\n        if (check || dwRead &gt; 0) {\n            printf(\"Display: %s\\n\", chBuff);\n        }\n    }\n    return 0;\n}\n</code></pre>\n\n<p>Also, Is there another <code>Read</code> function that is safe for PowerShell?</p>\n\n<p><strong>Edit:</strong> I feel like it is sending bytes so might try using a <code>void</code>. Will update after.</p>\n\n<p><strong>Edit:</strong> No, it still takes over. Guess <code>ReadFile()</code> cannot read its StdOut.</p>\n"}, {"tags": ["c", "loops"], "comments": [{"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 3, "creation_date": 1556072158, "post_id": 55821428, "comment_id": 98308943, "body": "Where do you increment <code>type</code> so that it will ever have the value <code>3</code>? This would be a great time to learn to use a debugger to step through code, so you can figure out problems like this yourself."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1556223039, "post_id": 55821428, "comment_id": 98375243, "body": "@SamBh: you can accept one of the answers by clicking on the grey checkmark below its score and upvote those that helped you."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 11402721, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-8K8RjvOWnDI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcmw--aq1OO3ooVa3634zQtPCGnGA/mo/photo.jpg?sz=128", "display_name": "Sam Bh", "link": "https://stackoverflow.com/users/11402721/sam-bh"}, "edited": false, "score": 1, "creation_date": 1556072177, "post_id": 55821438, "comment_id": 98308948, "body": "Can you elaborate a bit? As in are you talking about a case 3?"}, {"owner": {"reputation": 521, "user_id": 3477144, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/9c4ac73434255026e339006f3fcbe727?s=128&d=identicon&r=PG&f=1", "display_name": "Tillson", "link": "https://stackoverflow.com/users/3477144/tillson"}, "reply_to_user": {"reputation": 21, "user_id": 11402721, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-8K8RjvOWnDI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcmw--aq1OO3ooVa3634zQtPCGnGA/mo/photo.jpg?sz=128", "display_name": "Sam Bh", "link": "https://stackoverflow.com/users/11402721/sam-bh"}, "edited": false, "score": 0, "creation_date": 1556072375, "post_id": 55821438, "comment_id": 98308979, "body": "Sure\u2013 you enter the while loop when <code>type != 3</code>, and then every time you finish the flow of your switch statement, the statement <code>type != 3</code> is still true, so the while loop executes all of the code inside it again. It keeps doing this until the statement <code>type != 3</code> is false. Because you never update the <code>type</code> variable to anything, the while loop never terminates."}, {"owner": {"reputation": 505, "user_id": 9182617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KUJN.png?s=128&g=1", "display_name": "Whooper", "link": "https://stackoverflow.com/users/9182617/whooper"}, "edited": false, "score": 1, "creation_date": 1556072485, "post_id": 55821438, "comment_id": 98309005, "body": "Each <code>case</code> in a <code>switch</code> statement needs a <code>break</code>. Therefore, those <code>break</code> in each case breaks the <code>switch</code> statement NOT your <code>while</code> loop. As @Tillson mentioned, if you want to break out of your loop too, <code>type</code> should be changed somewhere in your cases."}, {"owner": {"reputation": 21, "user_id": 11402721, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-8K8RjvOWnDI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcmw--aq1OO3ooVa3634zQtPCGnGA/mo/photo.jpg?sz=128", "display_name": "Sam Bh", "link": "https://stackoverflow.com/users/11402721/sam-bh"}, "edited": false, "score": 1, "creation_date": 1556072523, "post_id": 55821438, "comment_id": 98309013, "body": "Got in working. Thank you so much. I added a break at the end of the while loop and it worked perfectly."}, {"owner": {"reputation": 521, "user_id": 3477144, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/9c4ac73434255026e339006f3fcbe727?s=128&d=identicon&r=PG&f=1", "display_name": "Tillson", "link": "https://stackoverflow.com/users/3477144/tillson"}, "edited": false, "score": 1, "creation_date": 1556072666, "post_id": 55821438, "comment_id": 98309037, "body": "I&#39;ll also point out that this may be a case where you don&#39;t need a while loop in the first place\u2013\u2013 just checking <code>if (type != 3)</code> would suffice since your code will always break out of the while loop after its first iteration."}, {"owner": {"reputation": 505, "user_id": 9182617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KUJN.png?s=128&g=1", "display_name": "Whooper", "link": "https://stackoverflow.com/users/9182617/whooper"}, "reply_to_user": {"reputation": 21, "user_id": 11402721, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-8K8RjvOWnDI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcmw--aq1OO3ooVa3634zQtPCGnGA/mo/photo.jpg?sz=128", "display_name": "Sam Bh", "link": "https://stackoverflow.com/users/11402721/sam-bh"}, "edited": false, "score": 1, "creation_date": 1556073522, "post_id": 55821438, "comment_id": 98309194, "body": "@SamBh I would recommend using chqrlie&#39;s answer if you would want to make users go over the options again to make a new transaction after it finished doing a transaction. That would make more sense for a program emulating a marketplace. :)"}], "tags": [], "owner": {"reputation": 521, "user_id": 3477144, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/9c4ac73434255026e339006f3fcbe727?s=128&d=identicon&r=PG&f=1", "display_name": "Tillson", "link": "https://stackoverflow.com/users/3477144/tillson"}, "is_accepted": false, "score": 2, "last_activity_date": 1556072020, "creation_date": 1556072020, "answer_id": 55821438, "question_id": 55821428, "link": "https://stackoverflow.com/questions/55821428/why-is-the-loop-not-stopping/55821438#55821438", "title": "Why is the loop not stopping?", "body": "<p>You never update the <code>type</code> variable to 3, so the while loop never terminates. Although you do have a <code>break</code> statement, it is affecting the <code>switch</code> and not the <code>while</code> loop that surrounds it.</p>\n"}, {"comments": [{"owner": {"reputation": 505, "user_id": 9182617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KUJN.png?s=128&g=1", "display_name": "Whooper", "link": "https://stackoverflow.com/users/9182617/whooper"}, "edited": false, "score": 0, "creation_date": 1556073108, "post_id": 55821508, "comment_id": 98309128, "body": "I think it should be <code>&amp;&amp;</code> not <code>||</code>. Otherwise, every time that 1 is not entered, it will already break out of the loop since your if condition will be valid to break the loop."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 505, "user_id": 9182617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KUJN.png?s=128&g=1", "display_name": "Whooper", "link": "https://stackoverflow.com/users/9182617/whooper"}, "edited": false, "score": 1, "creation_date": 1556073468, "post_id": 55821508, "comment_id": 98309186, "body": "@Whooper: no,  <code>||</code> is correct. <code>scanf()</code> returns <code>1</code> if and only if the conversion is successful. The loop should end if the conversion is unsuccessful <b>or</b> if the type entered is <code>3</code>."}, {"owner": {"reputation": 505, "user_id": 9182617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KUJN.png?s=128&g=1", "display_name": "Whooper", "link": "https://stackoverflow.com/users/9182617/whooper"}, "edited": false, "score": 0, "creation_date": 1556074061, "post_id": 55821508, "comment_id": 98309288, "body": "Ahh I get it now! Didn&#39;t know scanf can be used this way as a condition. I thought it works the same way as assigning the value read from scanf to <code>type</code> first before checking if you should break the loop. Thanks for clarifying that!"}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 505, "user_id": 9182617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KUJN.png?s=128&g=1", "display_name": "Whooper", "link": "https://stackoverflow.com/users/9182617/whooper"}, "edited": false, "score": 1, "creation_date": 1556089824, "post_id": 55821508, "comment_id": 98313737, "body": "@Whooper: <code>scanf</code> returns the number of successful conversions. It is important to check that <code>scanf()</code> was indeed successful to handle unexpected input correctly."}], "tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": false, "score": 2, "last_activity_date": 1556223069, "last_edit_date": 1556223069, "creation_date": 1556072657, "answer_id": 55821508, "question_id": 55821428, "link": "https://stackoverflow.com/questions/55821428/why-is-the-loop-not-stopping/55821508#55821508", "title": "Why is the loop not stopping?", "body": "<p>Your loop logic is flawed: </p>\n\n<ul>\n<li>you should move the prompt code inside the loop.</li>\n<li>you should update <code>total</code> for each answer.</li>\n<li>you should test if <code>scanf()</code> is successful at converting user input.</li>\n</ul>\n\n<p>Here is a modified version:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdio.h&gt;\n\n#define NEWGEAR  15.0\n#define USEDGEAR  5.0\n\nint main() {\n    int type;\n    int num_items;\n    double total = 0;\n\n    printf(\"Welcome to the market\\n\");\n    for (;;) {\n        printf(\"What would you like to do\\n\");\n        printf(\"\\t1-Buy New Gear\\n\");\n        printf(\"\\t2-Buy used gear\\n\");\n        printf(\"\\t3-Quit\\n\");\n\n        if (scanf(\"%d\", &amp;type) != 1 || type == 3)\n            break;\n\n        switch (type) {\n        case 1:\n            printf(\"How many new items would you like?\\n\");\n            if (scanf(\"%d\", &amp;num_items) == 1)\n                total += num_items * 15.0;\n            break;\n\n        case 2:\n            printf(\"How many old items would you like?\\n\");\n            if (scanf(\"%d\", &amp;num_items) == 1)\n                total += num_items * USEDGEAR;\n            break;\n\n        default:\n            printf(\"Not a valid option\\n\");\n            break;\n        }\n    }\n    printf(\"Your total cost is %f\\n\", total);\n\n    return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 505, "user_id": 9182617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KUJN.png?s=128&g=1", "display_name": "Whooper", "link": "https://stackoverflow.com/users/9182617/whooper"}, "reply_to_user": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1556072869, "post_id": 55821521, "comment_id": 98309073, "body": "Take note however that this only handles your loop problem. As chqrlie mentioned in his answer, there are also some logical problems with your code but I think you can figure it out or ask another question about any issues you would encounter."}, {"owner": {"reputation": 505, "user_id": 9182617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KUJN.png?s=128&g=1", "display_name": "Whooper", "link": "https://stackoverflow.com/users/9182617/whooper"}, "reply_to_user": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 1, "creation_date": 1556072956, "post_id": 55821521, "comment_id": 98309088, "body": "@chqrlie ah yeah right since it will still enter the switch-case scenario. Thanks for pointing that out!"}], "tags": [], "owner": {"reputation": 505, "user_id": 9182617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KUJN.png?s=128&g=1", "display_name": "Whooper", "link": "https://stackoverflow.com/users/9182617/whooper"}, "is_accepted": false, "score": 2, "last_activity_date": 1556073948, "last_edit_date": 1556073948, "creation_date": 1556072752, "answer_id": 55821521, "question_id": 55821428, "link": "https://stackoverflow.com/questions/55821428/why-is-the-loop-not-stopping/55821521#55821521", "title": "Why is the loop not stopping?", "body": "<p>I think this will handle what you want to achieve.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n#define NEWGEAR 15.0\n#define USEDGEAR 5.0\n\nint main() {\n    int type = 0;\n    int num_items;\n    float total;\n\n    printf(\"Welcome to the market\\n\");\n    printf(\"What would you like to do\\n\");\n    printf(\"\\t1-Buy New Gear\\n\");\n    printf(\"\\t2-Buy used gear\\n\");\n    printf(\"\\t3-Quit\\n\");\n\n    while (type != 3) {\n      printf(\"Enter an option: \");\n      scanf(\"%d\", &amp;type);\n\n      if(type == 3)\n        break;\n\n      switch (type) {\n        case 1:\n            printf(\"How many new items would you like?\\n\");\n            scanf(\"%d\", &amp;num_items);\n            total = num_items * 15.0;\n            break;\n        case 2:\n            printf(\"How many old items would you like?\\n\");\n            scanf(\"%d\", &amp;num_items);\n            total = num_items * USEDGEAR;\n            break;\n        default:\n            printf(\"Not a valid option\\n\");\n            break;\n        }\n    }\n    printf(\"Your total cost is %f\\n\",total);\n\n    return 0;\n}\n</code></pre>\n\n<p>Basically, after your user finished doing cases 1-2 or default, your program would prompt your user for an option again if he wants to quit or perform another case 1 or 2 operation.</p>\n"}], "owner": {"reputation": 21, "user_id": 11402721, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-8K8RjvOWnDI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcmw--aq1OO3ooVa3634zQtPCGnGA/mo/photo.jpg?sz=128", "display_name": "Sam Bh", "link": "https://stackoverflow.com/users/11402721/sam-bh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 122, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1556223069, "creation_date": 1556071950, "last_edit_date": 1556072422, "question_id": 55821428, "link": "https://stackoverflow.com/questions/55821428/why-is-the-loop-not-stopping", "title": "Why is the loop not stopping?", "body": "<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n#define NEWGEAR 15.0\n#define USEDGEAR 5.0\n\nint main() {\n    int type;\n    int num_items;\n    float total;\n\n    printf(\"Welcome to the market\\n\");\n    printf(\"What would you like to do\\n\");\n    printf(\"\\t1-Buy New Gear\\n\");\n    printf(\"\\t2-Buy used gear\\n\");\n    printf(\"\\t3-Quit\\n\");\n\n    scanf(\"%d\", &amp;type);\n\n    while (type != 3) {\n        switch (type) {\n        case 1:\n            printf(\"How many new items would you like?\\n\");\n            scanf(\"%d\", &amp;num_items);\n            total = num_items * 15.0;\n            break;\n</code></pre>\n\n<p>This is where the code keeps on asking how many new items would you like?</p>\n\n<pre><code>        case 2:\n            printf(\"How many old items would you like?\\n\");\n            scanf(\"%d\", &amp;num_items);\n            total = num_items * USEDGEAR;\n            break;\n</code></pre>\n\n<p>This is where the code keeps on asking how many old items would you like?\n            case 3:\n                break;</p>\n\n<pre><code>        default:\n            printf(\"Not a valid option\\n\");\n            break;\n        }\n    }\n    printf(\"Your total cost is %f\\n\",total);\n\n    return 0;\n}\n</code></pre>\n\n<p>Both my choices are looping</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 2, "creation_date": 1556070637, "post_id": 55821235, "comment_id": 98308625, "body": "1. Do not hide pointers with typedef - leads to problems in debugging. 2. Do not cast return of malloc. <a href=\"https://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc\" title=\"do i cast the result of malloc\">stackoverflow.com/questions/605845/&hellip;</a>"}, {"owner": {"reputation": 146, "user_id": 3367493, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uzjLN.png?s=128&g=1", "display_name": "Programmer dude", "link": "https://stackoverflow.com/users/3367493/programmer-dude"}, "edited": false, "score": 0, "creation_date": 1556070711, "post_id": 55821235, "comment_id": 98308642, "body": "Change <code>trav_and_print(elementptr f);</code> to <code>trav_and_print(f);</code>. Do the same with <code>count_elems(elementptr f)</code>"}, {"owner": {"reputation": 2449, "user_id": 500276, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/200bf76976f24add540182f5c3a42788?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Benningfield", "link": "https://stackoverflow.com/users/500276/mark-benningfield"}, "edited": false, "score": 0, "creation_date": 1556071997, "post_id": 55821235, "comment_id": 98308908, "body": "Edit your question and post the code where you use the new function that isn&#39;t working."}], "owner": {"reputation": 27, "user_id": 11355688, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Zu7d3.jpg?s=128&g=1", "display_name": "Octavius", "link": "https://stackoverflow.com/users/11355688/octavius"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1556070283, "creation_date": 1556070283, "question_id": 55821235, "link": "https://stackoverflow.com/questions/55821235/syntax-for-using-a-function-to-call-other-functions-that-deal-with-linked-lists", "title": "Syntax for using a function to call other functions that deal with linked lists?", "body": "<p>A practice problem had me develop some code by following a series of steps, and is now asking that I call several of the functions from within a new function. I'm having some trouble with the syntax of the function declaration and calling the function, and could use some guidance.</p>\n\n<p><strong>The Practice Problem:</strong></p>\n\n<ul>\n<li>Modify your program to:\n\n<ul>\n<li>Add a <em>just_checkin</em> function that calls the <em>trav_and_print</em> function to print the data values, prints the number of elements in the linked list (by calling <em>count_elems</em>), and prints the values of first->data and last->data.</li>\n</ul></li>\n</ul>\n\n<p>I tried a number of approaches, such as including <code>void just_checkin(elementptr);</code> , <code>just_checkin(first);</code> in <code>main</code>, and writing the function as </p>\n\n<pre><code>void just_checkin(elementptr f) \n{\n    trav_and_print(elementptr f);\n    count_elems(elementptr f);\n}\n</code></pre>\n\n<p>Perhaps unsurprisingly, this did not work. I've also tried shifting the arguments to within the function, calling the functions by means other than feeding (elementptr) through it, and writing out the syntax in a variety of other ways, etc. I'm at a loss.</p>\n\n<p><strong>My prior code, which I'm expected to modify by adding another function:</strong></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\ntypedef struct linked_list\n{\n   int data;\n   struct linked_list *next;\n}   element;\n\ntypedef element * elementptr;\n\nvoid trav_and_print(elementptr); //prints data values\n\nint count_elems(elementptr); //counts the number of elements in the linked list\n\nint main()\n{\n   elementptr first = NULL;\n   elementptr last = NULL;\n   int var = 0;\n   int NumElems = 0;\n\n   /* Create a linked list with one element            */\n   /* NOTE: the first element is always a special case */\n\n   first = (elementptr) malloc(sizeof(element));\n   last = first;\n   last -&gt; data = 5;\n   last -&gt; next = NULL;\n\n   /* Add another element to the end of the list */\n\n   last -&gt; next = (elementptr) malloc(sizeof(element));\n   last = last -&gt; next;\n   last -&gt; data = 12;\n   last -&gt; next = NULL;\n\n   /*Add another element to the end of the list;\n   user generated number*/\n\n   last -&gt; next = (elementptr) malloc(sizeof(element));\n   last = last -&gt; next;\n   printf(\"Enter the data value to add to the linked list: \");\n   scanf(\"%d\",&amp;var);\n   last -&gt; data = var;\n   last -&gt; next = NULL;\n\n   trav_and_print(first); //prints the linked list\n\n   NumElems = count_elems(first); //traverses and counts the elements in the linked list\n\n   printf(\"Number of elements in the linked list: %d\",NumElems);\n\n   free(first);\n   free(last);\n\n   return 0;\n}\nvoid trav_and_print(elementptr f)\n{\n    elementptr current;\n\n    current = f;\n    if(current == NULL)\n        printf(\"There is no linked list!\\n\");\n    else\n        while (current != NULL)\n    {\n        printf(\"The data value is %d\\n\",current-&gt;data);\n        current = current -&gt; next;\n    }\n}\nint count_elems(elementptr f)\n{\n    int count = 0;\n    elementptr current;\n    current = f;\n    while(current != NULL)\n    {\n        current = current-&gt;next;\n        count++;\n    }\n    return count;\n}\n</code></pre>\n"}, {"tags": ["c", "assembly", "x86", "clang"], "comments": [{"owner": {"reputation": 67968, "user_id": 584192, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YBSIc.png?s=128&g=1", "display_name": "Samuel Liew", "link": "https://stackoverflow.com/users/584192/samuel-liew"}, "edited": false, "score": 0, "creation_date": 1556085899, "post_id": 55821199, "comment_id": 98312077, "body": "Comments are not for extended discussion; this conversation has been <a href=\"https://chat.stackoverflow.com/rooms/192294/discussion-on-question-by-jergp-generated-assembly-code-contains-a-series-of-jum\">moved to chat</a>."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1556203550, "post_id": 55821199, "comment_id": 98365784, "body": "Were you actually using clang, on a Mac where <code>gcc</code> is actually clang?  That&#39;s just confusing for everyone, because I&#39;m pretty sure GCC&#39;s back-end never emits code like this (even at <code>-O0</code>).  I added a <code>clang</code> tag based on Gene&#39;s answer."}, {"owner": {"reputation": 21, "user_id": 11402606, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-WMSeOhUBM4Y/AAAAAAAAAAI/AAAAAAAAABM/QidaJFBRR18/photo.jpg?sz=128", "display_name": "jergp", "link": "https://stackoverflow.com/users/11402606/jergp"}, "edited": false, "score": 0, "creation_date": 1556244439, "post_id": 55821199, "comment_id": 98380635, "body": "it is actually.  It looks like gcc is aliased to clang."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 11402606, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-WMSeOhUBM4Y/AAAAAAAAAAI/AAAAAAAAABM/QidaJFBRR18/photo.jpg?sz=128", "display_name": "jergp", "link": "https://stackoverflow.com/users/11402606/jergp"}, "edited": false, "score": 1, "creation_date": 1556078512, "post_id": 55821951, "comment_id": 98310086, "body": "I didn&#39;t think so since each jump goes to the next address which has a jump the the next jump address.  When optimized with the O3 flag it does not produce the series of jumps."}, {"owner": {"reputation": 160, "user_id": 7184594, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a248c617d822f07c15f1d98ec51ee86d?s=128&d=identicon&r=PG&f=1", "display_name": "Comet", "link": "https://stackoverflow.com/users/7184594/comet"}, "reply_to_user": {"reputation": 21, "user_id": 11402606, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-WMSeOhUBM4Y/AAAAAAAAAAI/AAAAAAAAABM/QidaJFBRR18/photo.jpg?sz=128", "display_name": "jergp", "link": "https://stackoverflow.com/users/11402606/jergp"}, "edited": false, "score": 0, "creation_date": 1556079847, "post_id": 55821951, "comment_id": 98310352, "body": "Correct me if i am wrong but it make sense as the 03 Flag enable inline-functions flag. So there is no jump to be made?"}, {"owner": {"reputation": 21, "user_id": 11402606, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-WMSeOhUBM4Y/AAAAAAAAAAI/AAAAAAAAABM/QidaJFBRR18/photo.jpg?sz=128", "display_name": "jergp", "link": "https://stackoverflow.com/users/11402606/jergp"}, "edited": false, "score": 0, "creation_date": 1556080359, "post_id": 55821951, "comment_id": 98310438, "body": "It does, however looking at the generated assembly, it jumps from one instruction address to the next unconditionally and I&#39;ve never seen that before.  all the if statements generate a compare. In basic it would look like : 10 goto 20; 20 goto 30 ect..."}, {"owner": {"reputation": 160, "user_id": 7184594, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a248c617d822f07c15f1d98ec51ee86d?s=128&d=identicon&r=PG&f=1", "display_name": "Comet", "link": "https://stackoverflow.com/users/7184594/comet"}, "reply_to_user": {"reputation": 21, "user_id": 11402606, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-WMSeOhUBM4Y/AAAAAAAAAAI/AAAAAAAAABM/QidaJFBRR18/photo.jpg?sz=128", "display_name": "jergp", "link": "https://stackoverflow.com/users/11402606/jergp"}, "edited": false, "score": 0, "creation_date": 1556080885, "post_id": 55821951, "comment_id": 98310545, "body": "<a href=\"https://stackoverflow.com/a/9971443/7184594\">stackoverflow.com/a/9971443/7184594</a> this guy show how to view both source and assembly at the same time"}, {"owner": {"reputation": 21, "user_id": 11402606, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-WMSeOhUBM4Y/AAAAAAAAAAI/AAAAAAAAABM/QidaJFBRR18/photo.jpg?sz=128", "display_name": "jergp", "link": "https://stackoverflow.com/users/11402606/jergp"}, "edited": false, "score": 0, "creation_date": 1556081129, "post_id": 55821951, "comment_id": 98310614, "body": "I&#39;m sorry my friend, I don&#39;t understand your point."}, {"owner": {"reputation": 160, "user_id": 7184594, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a248c617d822f07c15f1d98ec51ee86d?s=128&d=identicon&r=PG&f=1", "display_name": "Comet", "link": "https://stackoverflow.com/users/7184594/comet"}, "reply_to_user": {"reputation": 21, "user_id": 11402606, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-WMSeOhUBM4Y/AAAAAAAAAAI/AAAAAAAAABM/QidaJFBRR18/photo.jpg?sz=128", "display_name": "jergp", "link": "https://stackoverflow.com/users/11402606/jergp"}, "edited": false, "score": 0, "creation_date": 1556081340, "post_id": 55821951, "comment_id": 98310675, "body": "Well if you run the app and step through it youd be able to see what triggers the JMP because the source will be in front of you at the same time.  Im not at a computer right now so i cant do it sorry."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 21, "user_id": 11402606, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-WMSeOhUBM4Y/AAAAAAAAAAI/AAAAAAAAABM/QidaJFBRR18/photo.jpg?sz=128", "display_name": "jergp", "link": "https://stackoverflow.com/users/11402606/jergp"}, "edited": false, "score": 1, "creation_date": 1556086038, "post_id": 55821951, "comment_id": 98312137, "body": "<code>jmp</code> is an <i>unconditional</i> jump.  You&#39;re thinking of <code>jcc</code>, like <code>jne</code>.  But even then, there&#39;s no reason why a compiler would emit a sequence of multiple jump-next-instruction with no flag-setting insns between them.  Or even <i>one</i> jump-next-instruction, whether it&#39;s conditional or not, because that&#39;s just an expensive NOP that always goes to the next instruction.  See <a href=\"https://godbolt.org/z/0XvPJb\" rel=\"nofollow noreferrer\">godbolt.org/z/0XvPJb</a> for <code>gcc -O0</code> and <code>gcc -O3</code> code-gen for a main with 4 of your <code>if</code> clauses compiled; see what the asm <i>actually</i> looks like.  (@jergp: this answer makes no sense, but neither does your asm.)"}], "tags": [], "owner": {"reputation": 160, "user_id": 7184594, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a248c617d822f07c15f1d98ec51ee86d?s=128&d=identicon&r=PG&f=1", "display_name": "Comet", "link": "https://stackoverflow.com/users/7184594/comet"}, "is_accepted": false, "score": -1, "last_activity_date": 1556076300, "creation_date": 1556076300, "answer_id": 55821951, "question_id": 55821199, "link": "https://stackoverflow.com/questions/55821199/generated-assembly-code-contains-a-series-of-jump-commands-to-next-memory-locati/55821951#55821951", "title": "Generated assembly code contains a series of jump commands to next memory location, what is the purpose", "body": "<p>Its the list of if's as far as i know.</p>\n\n<pre><code>if (strcmp(argv[1], \"c2f\") == 0 ) {\n    printf(\"%.1f F\\n\", celciusToFarenheit( atof(argv[2])));\n}\nelse if (strcmp(argv[1], \"f2c\") == 0){\n    printf(\"%.1f C\\n\", farenheitToCelcius( atof(argv[2])));\n}\nelse if (strcmp(argv[1], \"c2k\") == 0){\n    printf(\"%.1f K\\n\", celciusToKelvin( atof(argv[2])));\n}\nelse if (strcmp(argv[1], \"f2k\") == 0){\n    printf(\"%.1f K\\n\", farenheitToKelvin( atof(argv[2])));\n}\nelse if (strcmp(argv[1], \"k2f\") == 0){\n    printf(\"%.1f F\\n\", kelvinToFarenheit( atof(argv[2])));\n}\nelse if (strcmp(argv[1], \"k2c\") ==0){\n    printf(\"%.1f C\\n\", kelvinToCelcius( atof(argv[2])));\n}\nelse if (strcmp(argv[1], \"k2m\") == 0){\n    printf(\"%.1f M\\n\", kilometersToMiles( atof(argv[2])));\n}\nelse if (strcmp(argv[1], \"m2k\") == 0){\n    printf(\"%.1f K\\n\", milesToKilometers( atof(argv[2])));\n}\nelse if (strcmp(argv[1], \"f2m\") == 0){\n    printf(\"%.1f M\\n\", feetToMeters( atof(argv[2])));\n}\nelse if ( strcmp(argv[1], \"m2f\")  == 0){\n    printf(\"%.1f F\\n\", metersToFeet( atof(argv[2])));\n}\n</code></pre>\n\n<p>8 If statement, 8 JMP's + \n1 Print, 1 JMP</p>\n"}, {"tags": [], "owner": {"reputation": 42504, "user_id": 1161878, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/0157ddd785dc01e95342e3661d34b42a?s=128&d=identicon&r=PG", "display_name": "Gene", "link": "https://stackoverflow.com/users/1161878/gene"}, "is_accepted": true, "score": 5, "last_activity_date": 1556126872, "last_edit_date": 1556126872, "creation_date": 1556088609, "answer_id": 55823941, "question_id": 55821199, "link": "https://stackoverflow.com/questions/55821199/generated-assembly-code-contains-a-series-of-jump-commands-to-next-memory-locati/55823941#55823941", "title": "Generated assembly code contains a series of jump commands to next memory location, what is the purpose", "body": "<p>LLVM/clang-1001.0.46.4 does this on my MacBook. </p>\n\n<p>This appears to be an artifact of compiling chained <code>else if</code>s without optimization. For the code</p>\n\n<pre><code>if (E == 0) A; \nelse if (F == 0) B;\nelse C;\n</code></pre>\n\n<p>the compiler is generating</p>\n\n<pre><code>  &lt;evaluate E into eax&gt;\n  cmp eax, 0\n  jne EvalF\n  &lt;code for A&gt;\n  jmp EndIfE\n\nEvalF:\n  &lt;evaluate F into eax&gt;\n  cmp eax, 0\n  jne DoC\n  &lt;code for B&gt;\n  jmp EndIfF\n\nDoC:\n  &lt;code for C&gt;\n\nEndIfF: goto EndIfE\nEndIfE: \n  &lt;rest of program&gt;\n</code></pre>\n\n<p>So here there's one useless jump. With more chained <code>if</code>s you get more of the same useless jumps.</p>\n\n<p>It's almost certain that this happens because the code generator creates an empty basic block data structure to represent the code that runs after each <code>if else</code>. For a single <code>if else</code> that basic block is eventually filled with the code that runs after the statement is complete. But when <code>if else</code>s are chained, only the outermost block contains executable code. The rest remain empty.  </p>\n\n<p>It's natural for an empty basic block to be compiled to a <code>jmp</code> instruction because every basic block ends in a branch to another basic block. (Indeed that's part of the definition.)  Here the <code>jmp</code> goes to a basic block that happens to finally be compiled to the address immediately following, but early code generation is normally not concerned with inefficiency at this level. Rather it's all about correctness, and the useless jump is not an error. </p>\n\n<p>You can learn more about basic blocks and control flow graphs in <a href=\"https://en.wikipedia.org/wiki/Control-flow_graph\" rel=\"nofollow noreferrer\">the Wikipedia page</a>. </p>\n\n<p>The compiler is running with <code>-O0</code>. No optimization. Code generation quirks like this are to be expected. If you compile with <code>-O1</code> or higher, they'll disappear. <a href=\"https://en.wikipedia.org/wiki/Jump_threading\" rel=\"nofollow noreferrer\">Jump threading</a> is a standard optimization algorithm.</p>\n"}], "owner": {"reputation": 21, "user_id": 11402606, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-WMSeOhUBM4Y/AAAAAAAAAAI/AAAAAAAAABM/QidaJFBRR18/photo.jpg?sz=128", "display_name": "jergp", "link": "https://stackoverflow.com/users/11402606/jergp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 0, "closed_date": 1556524249, "accepted_answer_id": 55823941, "answer_count": 2, "score": 1, "last_activity_date": 1556203494, "creation_date": 1556069781, "last_edit_date": 1556203494, "question_id": 55821199, "link": "https://stackoverflow.com/questions/55821199/generated-assembly-code-contains-a-series-of-jump-commands-to-next-memory-locati", "closed_reason": "Needs details or clarity", "title": "Generated assembly code contains a series of jump commands to next memory location, what is the purpose", "body": "<p>I was looking through the generated assembly from my compiler and noticed a series of jump commands that just go to the next memory address listed.  I was wondering what the heck the purpose of that is.  This was generated from gcc compiler.  I used otool to disassemble.  The snippet of assembly is toward the bottom of the list right before the functions are listed, so I'm sure it has to do with the main function and since it's just calls to printf and if else statements I can't make heads or tails of what it does... here is a link to full source:\n<a href=\"https://drive.google.com/open?id=1INI3i4ZP7dtJVQ5n4twA6RCG_sdbjVxd\" rel=\"nofollow noreferrer\">https://drive.google.com/open?id=1INI3i4ZP7dtJVQ5n4twA6RCG_sdbjVxd</a></p>\n\n<p>It has make file included, the program with take an argument such as m2k for miles to kilometers then the value you want so to convert 3 miles to kilometers the syntax would be : convert m2k 3.</p>\n\n<pre><code>0000000100000c95    cvtsd2ss    %xmm0, %xmm0\n0000000100000c99    callq   0x100000ee0\n0000000100000c9e    leaq    0x2a5(%rip), %rdi\n0000000100000ca5    cvtss2sd    %xmm0, %xmm0\n0000000100000ca9    movb    $0x1, %al\n0000000100000cab    callq   0x100000f0a\n0000000100000cb0    movl    %eax, -0x38(%rbp)\n0000000100000cb3    jmp 0x100000cb8\n0000000100000cb8    jmp 0x100000cbd\n0000000100000cbd    jmp 0x100000cc2\n0000000100000cc2    jmp 0x100000cc7\n0000000100000cc7    jmp 0x100000ccc\n0000000100000ccc    jmp 0x100000cd1\n0000000100000cd1    jmp 0x100000cd6\n0000000100000cd6    jmp 0x100000cdb\n0000000100000cdb    jmp 0x100000ce0\n0000000100000ce0    xorl    %eax, %eax\n0000000100000ce2    addq    $0x40, %rsp\n0000000100000ce6    popq    %rbp\n0000000100000ce7    retq\n</code></pre>\n"}, {"tags": ["c", "arrays", "pointers", "methods"], "comments": [{"owner": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 1, "creation_date": 1556069745, "post_id": 55821163, "comment_id": 98308448, "body": "<code>tPtr</code> in main is never modified, so it always points to the first element."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 2, "creation_date": 1556069861, "post_id": 55821163, "comment_id": 98308466, "body": "OT: <code>srand</code> should be called in <code>main</code>. If you call it in <code>turtleMove</code>, the random number will only change once per second."}], "answers": [{"comments": [{"owner": {"reputation": 79, "user_id": 10343353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0acad6fb90b4bfa777e75a781dca9d6?s=128&d=identicon&r=PG&f=1", "display_name": "RyM", "link": "https://stackoverflow.com/users/10343353/rym"}, "edited": false, "score": 0, "creation_date": 1556070327, "post_id": 55821218, "comment_id": 98308565, "body": "That makes a lot of sense. Thank you so much."}], "tags": [], "owner": {"reputation": 862, "user_id": 890897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7846a21f6ef5adf0d5bd0375b04428e?s=128&d=identicon&r=PG", "display_name": "tdk001", "link": "https://stackoverflow.com/users/890897/tdk001"}, "is_accepted": false, "score": 1, "last_activity_date": 1556070111, "creation_date": 1556070111, "answer_id": 55821218, "question_id": 55821163, "link": "https://stackoverflow.com/questions/55821163/pointer-in-c-only-updates-once-when-method-is-called/55821218#55821218", "title": "Pointer in C only updates once when method is called", "body": "<p>You are only updating the <em>local</em> value of <code>tPtr</code>.</p>\n\n<p>Your function is defined as:</p>\n\n<pre><code>void turtleMove(char raceTrack[SIZE], char *tPtr);\n</code></pre>\n\n<p>This takes a pointer to a <code>char</code> as the second argument, so anything at the address pointed to by <code>tPtr</code> can be modified and retained, but the <em>value</em> of tPtr (the address itself), cannot.</p>\n\n<p>To be able to modify the address, you need to pass a pointer to a pointer to <code>char</code>:</p>\n\n<pre><code>void turtleMove(char raceTrack[SIZE], char **tPtr);\n</code></pre>\n\n<p>Then in the function, when you want to modify the <em>character</em>, you dereference twice:</p>\n\n<pre><code>**tPtr = ' ';\n</code></pre>\n\n<p>And when you want to modify the <em>address</em>, you dereference once:</p>\n\n<pre><code>*tPtr += 3;\n</code></pre>\n\n<p>Lastly, of course, you have to fix how you are calling <code>turtleMove()</code> so that you are passing a <code>char**</code>. Fortunately, you can do this by just grabbing the address of <code>tPtr</code> as defined in <code>main()</code>:</p>\n\n<pre><code>turtleMove(raceTrack, &amp;tPtr);\n</code></pre>\n"}], "owner": {"reputation": 79, "user_id": 10343353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0acad6fb90b4bfa777e75a781dca9d6?s=128&d=identicon&r=PG&f=1", "display_name": "RyM", "link": "https://stackoverflow.com/users/10343353/rym"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1556070111, "creation_date": 1556069380, "question_id": 55821163, "link": "https://stackoverflow.com/questions/55821163/pointer-in-c-only-updates-once-when-method-is-called", "title": "Pointer in C only updates once when method is called", "body": "<p>I am doing a program to mimic the hare and turtle race. I dont understand why my pointer for the turtle movement only updates once when the condition is met multiple times. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;windows.h&gt;\n#define SIZE 70\n\nvoid turtleMove(char raceTrack[SIZE], char *tPtr);\n\nint main()\n{\n    char raceTrack[SIZE];\n    for(int i = 0; i&lt;SIZE; i++)\n    {\n        raceTrack[i] = ' ';\n    }\n\n    char *tPtr = raceTrack;\n\n    for(int i = 0; i &lt;=10; i++)\n    {\n        turtleMove(raceTrack, tPtr);\n    }\n\n}\nvoid turtleMove(char raceTrack[SIZE], char *tPtr)\n{\n    srand(time(0));\n\n    int num = rand() % 10 + 1;\n    printf(\"%d\\n\", num);\n\n    if(num &gt;= 1 &amp;&amp; num &lt;= 5)\n    {\n        printf(\"Fast plod\\n\");\n        *tPtr = ' ';\n        tPtr += 3;\n        *tPtr = 'T';\n\n        for(int i = 0; i &lt;SIZE; i++)\n        {\n            printf(\"%c,\", raceTrack[i]);\n\n        }\n        printf(\"\\n\");\n\n    }\n}\n</code></pre>\n\n<p>I want it to do this for example:</p>\n\n<p>2\nFast plod\n , , ,T, , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , ,</p>\n\n<p>5\nFast plod\n , , , , , , ,T, , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , ,\netc...</p>\n\n<p>Instead it's doing:</p>\n\n<p>2\nFast plod\n , , ,T, , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , ,</p>\n\n<p>5\nFast plod\n , , ,T, , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , ,</p>\n"}, {"tags": ["c", "shell"], "comments": [{"owner": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 0, "creation_date": 1556069372, "post_id": 55821148, "comment_id": 98308386, "body": "A shell parses a string and creates children to execute the commands in that string.  You use &quot;fork&#39; to create children.  It is the basic building block of a shell."}, {"owner": {"reputation": 23069, "user_id": 156811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/380335e95e6be9740e56b64d667279b3?s=128&d=identicon&r=PG", "display_name": "Havenard", "link": "https://stackoverflow.com/users/156811/havenard"}, "edited": false, "score": 0, "creation_date": 1556069376, "post_id": 55821148, "comment_id": 98308387, "body": "Depends on how you design your &quot;simple shell&quot;. I&#39;m sure it&#39;s not thrown there unnecessarily."}, {"owner": {"reputation": 23069, "user_id": 156811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/380335e95e6be9740e56b64d667279b3?s=128&d=identicon&r=PG", "display_name": "Havenard", "link": "https://stackoverflow.com/users/156811/havenard"}, "edited": false, "score": 0, "creation_date": 1556069516, "post_id": 55821148, "comment_id": 98308398, "body": "One characteristic of <code>fork()</code> is that, because it creates a new, isolated process, any modifications you make to it and it&#39;s environment doesn&#39;t necessarily affect the parent process, so it gives you freedom to thinker with setuid, modify environment variables etc. without rendering the shell broken once the command you ran is done."}, {"owner": {"reputation": 100758, "user_id": 1899640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47374ccb28e4b0d2454b64f7b975bc66?s=128&d=identicon&r=PG", "display_name": "that other guy", "link": "https://stackoverflow.com/users/1899640/that-other-guy"}, "edited": false, "score": 1, "creation_date": 1556074729, "post_id": 55821148, "comment_id": 98309413, "body": "Does your shell support <code>ls -lhrt</code> to show files with details and human readable sizes sorted by modification time ascending? Other people&#39;s shells do because they use <code>fork+exec</code> to start the system <code>ls</code> program instead of writing their own. Does your shell support <code>ls | grep txt | wc -l</code> to get the number of text files in the directory? Other people&#39;s shells do because they use <code>fork()</code> to create pipelines."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1556083064, "post_id": 55821148, "comment_id": 98311124, "body": "The BusyBox shell uses a lot of built-in functions to emulate system commands (like your <code>ps</code>, <code>ls</code>, <code>mkdir</code>, <code>cat</code>).  But I believe even that uses <code>fork()</code> when it comes to managing a pipeline \u2014 two or more processes connected by pipes."}], "answers": [{"tags": [], "owner": {"reputation": 6120, "user_id": 9214517, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-uHHGLaUqJK4/AAAAAAAAAAI/AAAAAAAAAAA/EMWzo-f2N9c/photo.jpg?sz=128", "display_name": "adrtam", "link": "https://stackoverflow.com/users/9214517/adrtam"}, "is_accepted": false, "score": 0, "last_activity_date": 1556069678, "creation_date": 1556069678, "answer_id": 55821181, "question_id": 55821148, "link": "https://stackoverflow.com/questions/55821148/why-should-i-use-fork-for-making-simple-shell-in-c/55821181#55821181", "title": "Why should I use fork() for making simple shell in C", "body": "<p>This is a design.</p>\n\n<p>People are not using fork(), but fork()-exec() pattern to make a new process. It sounds to me that you make your shell understand cat, cd, etc. and I have an impression that you created not a shell, but a REPL program. That is fine. Bash, for example, also have some commands working in this way (such as, functions you defined, \"bg\", etc.) but you limited the functionality to your shell to only the stuff you implemented.</p>\n\n<p>A fork-exec, however, is to allow your shell to run a program. And more importantly, the program being run will not mess with your shell. For example, no segmentation fault on the program can stop your shell from running. In my opinion, this part is the more important aspect of a shell.</p>\n"}], "owner": {"reputation": 35, "user_id": 9714886, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "hyumil", "link": "https://stackoverflow.com/users/9714886/hyumil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 181, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1556082914, "creation_date": 1556069215, "last_edit_date": 1556082914, "question_id": 55821148, "link": "https://stackoverflow.com/questions/55821148/why-should-i-use-fork-for-making-simple-shell-in-c", "title": "Why should I use fork() for making simple shell in C", "body": "<p>I don't know why I need to use the <code>fork()</code> function.</p>\n\n<p>I already make many functions like <code>cat</code>, <code>cd</code>, <code>mkdir</code>, <code>ps</code>, <code>ls</code> ...\nBut, when I saw other's code, many people use <code>fork()</code> function.\nI know what it is and how to work is. But I don't understand why this function is needed to make simple shell.\nI want to know how to use this function to make simple shell.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1556069585, "post_id": 55821117, "comment_id": 98308419, "body": "From <code>main</code> you pass NULL as the first parameter to <code>createdeck</code>. And <code>createdeck</code> passes NULL as the first parameter to <code>addcard</code>. So unless I missed something, <code>p</code> is always NULL in <code>addcard</code>."}, {"owner": {"reputation": 11, "user_id": 11402493, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-WBdijNYgHp0/AAAAAAAAAAI/AAAAAAAABkk/tk8emFVE-6c/photo.jpg?sz=128", "display_name": "gavin cloud", "link": "https://stackoverflow.com/users/11402493/gavin-cloud"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1556069743, "post_id": 55821117, "comment_id": 98308447, "body": "So how does that affect the linking?  It&#39;s always going to be the second to last card but should that affect the previous node pointer?"}, {"owner": {"reputation": 2449, "user_id": 500276, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/200bf76976f24add540182f5c3a42788?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Benningfield", "link": "https://stackoverflow.com/users/500276/mark-benningfield"}, "edited": false, "score": 0, "creation_date": 1556069834, "post_id": 55821117, "comment_id": 98308463, "body": "What is the purpose of a left and right head? Are you trying to end up with a doubly-linked list or a binary tree?"}, {"owner": {"reputation": 11, "user_id": 11402493, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-WBdijNYgHp0/AAAAAAAAAAI/AAAAAAAABkk/tk8emFVE-6c/photo.jpg?sz=128", "display_name": "gavin cloud", "link": "https://stackoverflow.com/users/11402493/gavin-cloud"}, "edited": false, "score": 0, "creation_date": 1556069871, "post_id": 55821117, "comment_id": 98308468, "body": "a doubly linked list, I used some of this off of the professor&#39;s notes, he had both heads."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "reply_to_user": {"reputation": 2449, "user_id": 500276, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/200bf76976f24add540182f5c3a42788?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Benningfield", "link": "https://stackoverflow.com/users/500276/mark-benningfield"}, "edited": false, "score": 0, "creation_date": 1556069953, "post_id": 55821117, "comment_id": 98308487, "body": "@MarkBenningfield I expect that&#39;s <code>head</code> and <code>tail</code> so you can scan the list and/or insert items starting from either end."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1556070211, "post_id": 55821117, "comment_id": 98308536, "body": "@gavincloud If <code>p</code> is always NULL, then you&#39;ll definitely never reach the <code>else</code> block. That can&#39;t be good. I&#39;m not sure what you intended there."}, {"owner": {"reputation": 11, "user_id": 11402493, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-WBdijNYgHp0/AAAAAAAAAAI/AAAAAAAABkk/tk8emFVE-6c/photo.jpg?sz=128", "display_name": "gavin cloud", "link": "https://stackoverflow.com/users/11402493/gavin-cloud"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1556070385, "post_id": 55821117, "comment_id": 98308572, "body": "@user3386109 My else is an adaptation of the professor&#39;s notes, I could cut it out I think.  I just want my nodes to connect properly."}, {"owner": {"reputation": 2449, "user_id": 500276, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/200bf76976f24add540182f5c3a42788?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Benningfield", "link": "https://stackoverflow.com/users/500276/mark-benningfield"}, "edited": false, "score": 0, "creation_date": 1556070433, "post_id": 55821117, "comment_id": 98308579, "body": "@gavincloud: Is it the case that one of these head nodes is intended to be the tail node? Because you are not maintaining a tail link either in FIFO or LIFO order."}, {"owner": {"reputation": 11, "user_id": 11402493, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-WBdijNYgHp0/AAAAAAAAAAI/AAAAAAAABkk/tk8emFVE-6c/photo.jpg?sz=128", "display_name": "gavin cloud", "link": "https://stackoverflow.com/users/11402493/gavin-cloud"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1556070610, "post_id": 55821117, "comment_id": 98308618, "body": "@user3386109 yes, my headr node should be the tail node."}, {"owner": {"reputation": 2449, "user_id": 500276, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/200bf76976f24add540182f5c3a42788?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Benningfield", "link": "https://stackoverflow.com/users/500276/mark-benningfield"}, "edited": false, "score": 1, "creation_date": 1556070914, "post_id": 55821117, "comment_id": 98308693, "body": "Then, if you are inserting at the tail, the tail node pointer has to be reassigned to the new node when it is added, and the head and tail nodes should refer to each other in one order or another, either LIFO or FIFO. Start with that."}], "owner": {"reputation": 11, "user_id": 11402493, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-WBdijNYgHp0/AAAAAAAAAAI/AAAAAAAABkk/tk8emFVE-6c/photo.jpg?sz=128", "display_name": "gavin cloud", "link": "https://stackoverflow.com/users/11402493/gavin-cloud"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1556068858, "creation_date": 1556068858, "question_id": 55821117, "link": "https://stackoverflow.com/questions/55821117/how-to-fix-doubly-linked-nodes-not-correctly-linking", "title": "How to fix doubly linked nodes not correctly linking?", "body": "<p>My doubly linked list is a deck of cards.  I have initialized them correctly but they are not connecting.  The left header points to NULL in both directions and while my right header's previous pointer points to the previous card, that card's previous pointer points to NULL.  How can I connect them?  I'm pretty sure it's not a difficult solution but I just can't figure it out for some reason.</p>\n\n<pre><code>#define _CRT_SECURE_NO_WARNINGS\n#include&lt;stdio.h&gt;\n#include&lt;math.h&gt;\n#include&lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n#define RAND_MAX 51\n\ntypedef struct card_s {\nchar suit;\nint face;\nstruct card_s *next, *previous;\n}card;\n\nvoid addcard(card *p, card **hl, card **hr, int i, char c) {\ncard *temp;\ntemp = (card *)malloc(sizeof(card)); \ntemp-&gt;face = i;\ntemp-&gt;suit = c;\nif (*hl == NULL) {\n    temp-&gt;previous = NULL;\n    temp-&gt;next = NULL;\n    *hl = temp;\n    *hr = temp;\n}\nelse if (p == NULL) {\n    p = calloc(1, sizeof(card));\n    temp-&gt;previous = p;\n    temp-&gt;next = NULL;\n    p-&gt;next = temp;\n    *hr = temp;\n}\nelse {\n    temp-&gt;next = p-&gt;next;\n    temp-&gt;previous = p;\n    p-&gt;next = temp;\n    temp-&gt;next-&gt;previous = temp;\n}\n}\n\nvoid delectecard(card *p, card **hl, card **hr) {\nif (p == *hl) {\n    *hl = p-&gt;next;\n}\nelse {\n    p-&gt;previous-&gt;next = p-&gt;next;\n}\nif (p == *hr) {\n    *hr = p-&gt;previous;\n}\nelse {\n    p-&gt;next-&gt;previous = p-&gt;previous;\n}\nfree(p);\n}\nvoid createdeck(card *p, card **hl, card **hr) {\nint i = 1;\nint j;\nwhile (i &lt;= 13) {\n    j = 1;\n    while (j &lt;= 4) {\n        if (j == 1) {\n            addcard(p, hl, hr, i, 'S');\n        }\n        if (j == 2) {\n            addcard(p, hl, hr, i, 'H');\n        }\n        if (j == 3) {\n            addcard(p, hl, hr, i, 'D');\n        }\n        if (j == 4) {\n            addcard(p, hl, hr, i, 'C');\n        }j++;\n    }\n    i++;\n}\n}\nvoid printdeck(card *currentNode) {\nwhile (currentNode != NULL) {\n    printf(\"Face: %d, Suit: %c\\n\", currentNode-&gt;face, currentNode- \n &gt;suit);\n    currentNode = currentNode-&gt;next;\n}\n}\n int main(void) {\ncard *headl = NULL, *headr = NULL;\ncreatedeck(headr, &amp;headl, &amp;headr);\nprintdeck(headl);\n }\n</code></pre>\n"}, {"tags": ["c", "uart", "xbee", "microchip", "dspic"], "comments": [{"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1556064451, "post_id": 55820938, "comment_id": 98308100, "body": "What does stepping through the code in a debugger tell you?  And why is there commented out code in your post?"}, {"owner": {"reputation": 27, "user_id": 11194032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de7f3dd22ce8cee501dd2ca22dd14a84?s=128&d=identicon&r=PG&f=1", "display_name": "dfetz", "link": "https://stackoverflow.com/users/11194032/dfetz"}, "reply_to_user": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1556064909, "post_id": 55820938, "comment_id": 98308179, "body": "It doesnt give me any errors or anything when I run through it. There is commented out code because I have been trying some new things in it and I dont want to make any &quot;permanent&quot; changes until I know things work."}, {"owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 1, "creation_date": 1556065260, "post_id": 55820938, "comment_id": 98308244, "body": "You are passing a <i>string</i> to <code>UART1_Write</code> with <code>&quot;A&quot;</code>. It is [probably] writing the first byte of the <i>address</i> of the string (which might be (e.g.) <code>0xFF123455</code>), hence the <code>FF</code>. Try (e.g.) <code>UART1_Write(&#39;A&#39;)</code> instead"}, {"owner": {"reputation": 27, "user_id": 11194032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de7f3dd22ce8cee501dd2ca22dd14a84?s=128&d=identicon&r=PG&f=1", "display_name": "dfetz", "link": "https://stackoverflow.com/users/11194032/dfetz"}, "edited": false, "score": 0, "creation_date": 1556070736, "post_id": 55820938, "comment_id": 98308655, "body": "even when I change it to UART1_Write(&#39;A&#39;) it still is only sending FE once even though it should be sending it continuously as well since its in a while(1) right?"}, {"owner": {"reputation": 656, "user_id": 9592917, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fe6504c31f4954495f952699592361a?s=128&d=identicon&r=PG&f=1", "display_name": "Bwebb", "link": "https://stackoverflow.com/users/9592917/bwebb"}, "edited": false, "score": 0, "creation_date": 1556079031, "post_id": 55820938, "comment_id": 98310180, "body": "youre not passing a uint8 to your write function.  put U1TXREG = &#39;A&quot; hardcoded in the write function, then =&#39;B&#39; etc, and see if it changes like your expecting.  You can have pins swapped on your logic analyzer thats giving you framing issues, or false edges.  If U1TXREG = &#39;A&#39; doesnt send the ascii value of &#39;A&#39; then your HW setup is wrong, if it does send &#39;A&#39; its your little test program here."}, {"owner": {"reputation": 3478, "user_id": 9061264, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TPing.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/9061264/mike"}, "edited": false, "score": 0, "creation_date": 1556084465, "post_id": 55820938, "comment_id": 98311578, "body": "check the baudrate. I can&#39;t follow your calculation."}, {"owner": {"reputation": 27, "user_id": 11194032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de7f3dd22ce8cee501dd2ca22dd14a84?s=128&d=identicon&r=PG&f=1", "display_name": "dfetz", "link": "https://stackoverflow.com/users/11194032/dfetz"}, "edited": false, "score": 0, "creation_date": 1556125889, "post_id": 55820938, "comment_id": 98335060, "body": "I will try the U1TXREG = \u2018A\u2019 as soon as I get to the lab. As far as the baud rate goes I used 40000000/(16*9600)-1"}], "answers": [{"tags": [], "owner": {"reputation": 10869, "user_id": 266392, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/173e2caa17a8522cae442e23e7879921?s=128&d=identicon&r=PG", "display_name": "tomlogic", "link": "https://stackoverflow.com/users/266392/tomlogic"}, "is_accepted": false, "score": 0, "last_activity_date": 1556173923, "creation_date": 1556173923, "answer_id": 55843122, "question_id": 55820938, "link": "https://stackoverflow.com/questions/55820938/no-matter-what-i-ask-my-system-to-send-it-only-sends-ff-and-fe/55843122#55843122", "title": "No matter what I ask my system to send, it only sends FF and FE", "body": "<p>The best thing to do is connect a logic probe or even a scope to the TX and RX lines so you can get a look at what you're actually sending.  You'll be able to look at bit times to see if you have the baud rate calculation correct.  Anything else you do will just be blind guessing.</p>\n\n<p>Does this Microchip platform have an interrupt or DMA driven UART driver you can use instead of rolling your own?  Can you test your driver with a wired serial connection to a PC instead of an XBee (which introduces another possible failure point)?</p>\n\n<p>Your <code>UART1_Write()</code> is blocking, so no need for the delay.</p>\n\n<p>Make sure you configure the XBee for the correct baud rate (I'm pretty sure <code>ATBD=3</code> for 9600).  Try sending the sequence <code>0x01, 0x03, 0x07 0x0F, 0x1F, 0x3F, 0x7F, 0xFF</code>.  That generates a sequence of 1 bits followed by 0 bits, and might help troubleshoot an error in your baud rate calculation.</p>\n"}], "owner": {"reputation": 27, "user_id": 11194032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de7f3dd22ce8cee501dd2ca22dd14a84?s=128&d=identicon&r=PG&f=1", "display_name": "dfetz", "link": "https://stackoverflow.com/users/11194032/dfetz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 126, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1556173923, "creation_date": 1556064239, "question_id": 55820938, "link": "https://stackoverflow.com/questions/55820938/no-matter-what-i-ask-my-system-to-send-it-only-sends-ff-and-fe", "title": "No matter what I ask my system to send, it only sends FF and FE", "body": "<p>I created a system that will read CANBUS data from a vehicle and transmit it wirelessly to a \"base station\". As of now, my code works in the sense that it sends things over the data line to the xbee and the xbee sends it to the receiving module except the only thing that it is sending is FF and FE no matter what I ask it to send. Any help is greatly appreciated.</p>\n\n<p>main.c</p>\n\n<pre><code>/**\n  Section: Included Files\n*/\n#include \"mcc_generated_files/clock.h\"\n#include \"mcc_generated_files/dma.h\"\n#include \"mcc_generated_files/ecan1.h\"\n#include \"mcc_generated_files/interrupt_manager.h\"\n#include \"mcc_generated_files/mcc.h\"\n#include \"mcc_generated_files/pin_manager.h\"\n#include \"mcc_generated_files/reset.h\"\n#include \"mcc_generated_files/reset_types.h\"\n#include \"mcc_generated_files/system.h\"\n#include \"mcc_generated_files/system_types.h\"\n#include \"mcc_generated_files/traps.h\"\n#include \"mcc_generated_files/uart1.h\"\n#include \"mcc_generated_files/watchdog.h\"\n#include \"string.h\"\n#include \"stdio.h\"\n#include \"stdlib.h\"\n\nvoid ms_delay (int N)\n{\n    T1CON = 0x08030;\n\n    int delay = N * 62.5;   // 1 Milisecond =&gt; .001 / (256 * (1/16,000,000)) = 62.5\n    TMR1 = 0;\n    while (TMR1 &lt; delay);\n}\n\nint main (void)\n{\n    PIN_MANAGER_Initialize();\n    CLOCK_Initialize();\n    INTERRUPT_Initialize();\n    //DMA_Initialize();\n    UART1_Initialize();\n    ECAN1_Initialize();\n    //INTERRUPT_GlobalEnable();\n    while(1)\n        {\n        UART1_Write(\"A\");\n        ms_delay(2);\n        UART1_Write(\"C\");\n        ms_delay(2);\n        UART1_Write('S');\n        ms_delay(2);\n        }\n}\n/**\n End of File\n*/\n</code></pre>\n\n<p>UART1.c</p>\n\n<pre><code>  Section: Included Files\n*/\n#include \"uart1.h\"\n\n/**\n  Section: UART1 APIs\n*/\n\nvoid UART1_Initialize(void)\n{\n/**    \n     Set the UART1 module to the options selected in the user interface.\n     Make sure to set LAT bit corresponding to TxPin as high before UART initialization\n*/\n    // STSEL 1; IREN disabled; PDSEL 8N; UARTEN enabled; RTSMD disabled; USIDL disabled; WAKE disabled; ABAUD disabled; LPBACK disabled; BRGH enabled; URXINV disabled; UEN TX_RX; \n    // Data Bits = 8; Parity = None; Stop Bits = 1;\n    U1MODE = (0x8008 &amp; ~(1&lt;&lt;15));  // disabling UARTEN bit\n    // UTXISEL0 TX_ONE_CHAR; UTXINV disabled; OERR NO_ERROR_cleared; URXISEL RX_ONE_CHAR; UTXBRK COMPLETED; UTXEN disabled; ADDEN disabled; \n    U1STA = 0x00;\n    // BaudRate = 2560.164; Frequency = 40000000 Hz; BRG 3905; \n    U1BRG = 0x19;\n\n    U1MODEbits.UARTEN = 1;  // enabling UARTEN bit\n    U1STAbits.UTXEN = 1; \n}\n\nuint8_t UART1_Read(void)\n{\n    while(!(U1STAbits.URXDA == 1))\n    {\n\n    }\n\n    if ((U1STAbits.OERR == 1))\n    {\n        U1STAbits.OERR = 0;\n    }\n\n    return U1RXREG;\n}\n\nvoid UART1_Write(uint8_t txData)\n{\n    while(U1STAbits.UTXBF)\n    {\n\n    }\n\n    U1TXREG = txData;    // Write the data byte to the USART.\n}\n\nuint16_t UART1_StatusGet (void)\n{\n    return U1STA;\n}\n\n/*int __attribute__((__section__(\".libc.write\"))) write(int handle, void *buffer, unsigned int len) {\n    int i;\n    while(U1STAbits.TRMT == 0);  \n    for (i = len; i; --i)\n    {\n        while(U1STAbits.TRMT == 0);\n        U1TXREG = *(char*)buffer++;        \n    }\n    return(len);\n}*/\n</code></pre>\n\n<p>Expected results: send YES from one module to another repeatedly\nActual results: Sends FF FE repretedly</p>\n"}, {"tags": ["c++", "c", "macros", "c-preprocessor", "string-literals"], "comments": [{"owner": {"reputation": 2336, "user_id": 3936002, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/utGjG.png?s=128&g=1", "display_name": "H Walters", "link": "https://stackoverflow.com/users/3936002/h-walters"}, "edited": false, "score": 0, "creation_date": 1556076992, "post_id": 55820900, "comment_id": 98309807, "body": "I feel like it&#39;ll take an entire answer to explain exactly how you need to clarify your question, before it can be answered.  A <i>macro</i> cannot reduce an <i>expression</i> (aka, <code>0xFFFFFF00-get_tex_unit_num(unit))</code>) to a number.  <i>The preprocessor</i> can do this, however (it requires using conditional directives, which you can&#39;t just &quot;call&quot; in a macro).  Macros <i>can</i> do math, but that requires macro-friendly forms like <code>LOGAND((F,F,F,F,F,F,0,0),SUB((3),GL_TEXTURE0))</code> where hex numbers are re-represented as <code>(x,y,z)</code> (and basically you <i>implement</i> math, so it&#39;s a lot of work)..."}, {"owner": {"reputation": 2336, "user_id": 3936002, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/utGjG.png?s=128&g=1", "display_name": "H Walters", "link": "https://stackoverflow.com/users/3936002/h-walters"}, "edited": false, "score": 0, "creation_date": 1556077075, "post_id": 55820900, "comment_id": 98309821, "body": "...so if you want an actual, working implementation, it&#39;s critical that your question is as nit picky as possible.  So... basically, you can&#39;t <i>evaluate expressions</i> using <i>macros</i>; but, do you want to <i>evaluate expressions</i> using the <i>preprocessor</i>, or <i>do arithmetic</i> using <i>macros</i>?"}, {"owner": {"reputation": 23, "user_id": 11401978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fKQJ8.jpg?s=128&g=1", "display_name": "ichster", "link": "https://stackoverflow.com/users/11401978/ichster"}, "reply_to_user": {"reputation": 2336, "user_id": 3936002, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/utGjG.png?s=128&g=1", "display_name": "H Walters", "link": "https://stackoverflow.com/users/3936002/h-walters"}, "edited": false, "score": 0, "creation_date": 1556758961, "post_id": 55820900, "comment_id": 98541761, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/1560357/can-the-c-preprocessor-perform-integer-arithmetic\">Can the C preprocessor perform integer arithmetic?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1556065069, "post_id": 55821004, "comment_id": 98308213, "body": "Note: This address only the concatenation of string literals. If there is a problem expanding <code>unit</code> to a desired string literal, that is not addressed\u2014that problem is not explained clearly in the question."}, {"owner": {"reputation": 23, "user_id": 11401978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fKQJ8.jpg?s=128&g=1", "display_name": "ichster", "link": "https://stackoverflow.com/users/11401978/ichster"}, "edited": false, "score": 0, "creation_date": 1556069141, "post_id": 55821004, "comment_id": 98308359, "body": "TY for the answer. Made some updates to the original post. I am not so much looking for a reason why my examples don&#39;t work, but rather I am having trouble using arithmetic inside macros to create a string literal."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 23, "user_id": 11401978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fKQJ8.jpg?s=128&g=1", "display_name": "ichster", "link": "https://stackoverflow.com/users/11401978/ichster"}, "edited": false, "score": 1, "creation_date": 1556082248, "post_id": 55821004, "comment_id": 98310917, "body": "@ichster: You won&#39;t be able to use arithmetic inside the macros \u2014 the preprocessor does text substitution, not arithmetic.  (It does arithmetic in <code>#if</code> and <code>#elif</code> conditions, but not otherwise.)"}, {"owner": {"reputation": 2336, "user_id": 3936002, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/utGjG.png?s=128&g=1", "display_name": "H Walters", "link": "https://stackoverflow.com/users/3936002/h-walters"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1556123044, "post_id": 55821004, "comment_id": 98333713, "body": "@JonathanLeffler You&#39;re confusing evaluating constant expressions with <a href=\"http://coliru.stacked-crooked.com/a/5233d485a50787c3\" rel=\"nofollow noreferrer\">doing arithmetic</a>."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 2336, "user_id": 3936002, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/utGjG.png?s=128&g=1", "display_name": "H Walters", "link": "https://stackoverflow.com/users/3936002/h-walters"}, "edited": false, "score": 0, "creation_date": 1556125717, "post_id": 55821004, "comment_id": 98334985, "body": "@HWalters \u2014 hmmm; I regard constant expressions as arithmetic (at least when there are arithmetic operators involved \u2014 that&#39;s a subset of the possibilities for expressions that can be evaluated by the preprocessor.  But I was commenting and giving a useful succinct abbreviated term for what goes on, not giving a definitive answer."}], "tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": true, "score": 2, "last_activity_date": 1556064895, "creation_date": 1556064895, "answer_id": 55821004, "question_id": 55820900, "link": "https://stackoverflow.com/questions/55820900/how-to-generate-a-pre-processor-definition-using-arithmetic/55821004#55821004", "title": "How to generate a pre-processor definition using arithmetic?", "body": "<p>Your first code sample should work, so it is not necessary to paste string literals together in the preprocessor. It is also not possible.</p>\n\n<p>It is not possible because <code>##</code> pastes together two preprocessing tokens, and the result must be a valid preprocessing token. A preprocessing token is a header name, identifier, preprocessing number, character constant, string literal, punctuator, or single non-white-space character. You cannot paste together two string literals and remove the two quote marks that end up between them. However, it is usually unnecessary to paste them together; simply letting them expand next to each other suffices because adjacent string literals are concatenated. </p>\n\n<p>Your first code sample, which generates results like <code>\"tex\" \"0\"</code> is fine. After preprocessing and before analysis and translation (compilation), adjacent string literals are converted to a single concatenated string literal. So there will not be any problems of precedence or other syntax and semantics. </p>\n"}, {"comments": [{"owner": {"reputation": 2336, "user_id": 3936002, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/utGjG.png?s=128&g=1", "display_name": "H Walters", "link": "https://stackoverflow.com/users/3936002/h-walters"}, "edited": false, "score": 0, "creation_date": 1556773455, "post_id": 55944424, "comment_id": 98544415, "body": "&quot;But since you can&#39;t combine a macro with this&quot; ...<a href=\"https://repl.it/repls/PeachpuffGrayAutomatedinformationsystem\" rel=\"nofollow noreferrer\">why not</a>?  (in the repl run (and feel free to examine) main.sh; this is simply a hex version of <a href=\"https://www.boost.org/doc/libs/1_70_0/libs/preprocessor/doc/ref/slot.html\" rel=\"nofollow noreferrer\">boost slots</a>; and is what I mean by &quot;evaluating expressions using the preprocessor&quot; to solve this problem)."}], "tags": [], "owner": {"reputation": 23, "user_id": 11401978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fKQJ8.jpg?s=128&g=1", "display_name": "ichster", "link": "https://stackoverflow.com/users/11401978/ichster"}, "is_accepted": false, "score": 0, "last_activity_date": 1556758725, "creation_date": 1556758725, "answer_id": 55944424, "question_id": 55820900, "link": "https://stackoverflow.com/questions/55820900/how-to-generate-a-pre-processor-definition-using-arithmetic/55944424#55944424", "title": "How to generate a pre-processor definition using arithmetic?", "body": "<p>I wanted to wrap up this question for future viewers by referencing a question that already answers this question:\n<a href=\"https://stackoverflow.com/questions/1560357/can-the-c-preprocessor-perform-integer-arithmetic\">Can the C preprocessor perform integer arithmetic?\n</a></p>\n\n<p>In short, the pre-processor can do arithmetic if it is used in when evaluating constant conditions: </p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#if 1 + 2 == 5\n#endif\n#else\n#endif\n</code></pre>\n\n<p>But since you can't combine a macro with this you can't make make string literal definitions before compiling.</p>\n"}], "owner": {"reputation": 23, "user_id": 11401978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fKQJ8.jpg?s=128&g=1", "display_name": "ichster", "link": "https://stackoverflow.com/users/11401978/ichster"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 152, "favorite_count": 0, "accepted_answer_id": 55821004, "answer_count": 2, "score": 2, "last_activity_date": 1556758725, "creation_date": 1556063977, "last_edit_date": 1556083530, "question_id": 55820900, "link": "https://stackoverflow.com/questions/55820900/how-to-generate-a-pre-processor-definition-using-arithmetic", "title": "How to generate a pre-processor definition using arithmetic?", "body": "<p>I want to dynamically create pre-proccessor literal strings where part of the string is created by some arithmetic, for example: <code>math(x) x - 0x1234</code>. The generated definitions would be made by the macro:<code>get_tex_uniform_name(unit)</code>, and the results would be the same values as the following numerically ordered definitions:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>// texture uniform naming\n#define TEX_UNIFORM_BASE_NAME       \"tex\"\n#define TEX_UNIFORM_0               TEX_UNIFORM_BASE_NAME\"0\"  // \"tex0\" and so on\n#define TEX_UNIFORM_1               TEX_UNIFORM_BASE_NAME\"1\"\n#define TEX_UNIFORM_2               TEX_UNIFORM_BASE_NAME\"2\"\n#define TEX_UNIFORM_3               TEX_UNIFORM_BASE_NAME\"3\"\n</code></pre>\n\n<p>I have tried generating the string from scratch with STRINGIFY (#):</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#define get_tex_unit_num(unit) unit - GL_TEXTURE0\n// create string literal from whatever is put in\n#define STRINGIFY(x) #x\n#define LITERAL_STRINGIFY(x) STRINGIFY(x)\n#define get_tex_uniform_name(unit) TEX_UNIFORM_BASE_NAME LITERAL_STRINGIFY(get_tex_unit_num(unit))\n\n// issue: result is \"texunit - 0x84C0\", 0x84C0 being GL_TEXTURE0\n</code></pre>\n\n<p>I have tried token pasting to work with existing definitions:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#define get_tex_unit_num(unit) unit - GL_TEXTURE0\n#define get_tex_uniform_name(unit) TEX_UNIFORM_ ## get_tex_unit_num(unit)\n\n// error: TEX_UNIFORM_get_tex_unit_num is undefined\n</code></pre>\n\n<p>And have been trying to get some sort of bit masking to work:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#define TEX_UNIFORM_BASE_NAME       \"tex\u00a0\"\n\n#define get_tex_unit_num(unit) unit - GL_TEXTURE0\n#define get_tex_uniform_name(unit) TEX_UNIFORM_BASE_NAME &amp; (0xffffff00 + (char)get_tex_unit_num(unit))\n\n// error: expression must have integral or unscoped enum type\n</code></pre>\n\n<p>I know that this could be done with functions or by just using the concatenated literal strings as defined in the first example. I am not necessarily looking for a reason why my examples don't work. I am looking for a way to get these strings dynamically, and am having trouble using arithmetic inside macros to create a string literal.</p>\n"}, {"tags": ["c++", "c", "cmake", "googletest"], "comments": [{"owner": {"reputation": 1627, "user_id": 579698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f69501fa0ff653b5a6e9466b43773d3?s=128&d=identicon&r=PG", "display_name": "Stanley F.", "link": "https://stackoverflow.com/users/579698/stanley-f"}, "edited": false, "score": 1, "creation_date": 1556080466, "post_id": 55820865, "comment_id": 98310457, "body": "If you want <code>sample_tests.cpp</code> to be compiled as part of your program, just add ist to the list of files in the <a href=\"https://cmake.org/cmake/help/latest/command/add_executable.html\" rel=\"nofollow noreferrer\"><code>add_executable</code></a> command. You also may want to have a look on the basics of CMake, e.g. see <a href=\"https://riptutorial.com/cmake/example/22391/-hello-world--with-multiple-source-files\" rel=\"nofollow noreferrer\">this tutorial</a>."}, {"owner": {"reputation": 45838, "user_id": 1362568, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/EAFi0.jpg?s=128&g=1", "display_name": "Mike Kinghan", "link": "https://stackoverflow.com/users/1362568/mike-kinghan"}, "edited": false, "score": 1, "creation_date": 1556105504, "post_id": 55820865, "comment_id": 98322732, "body": "In addition to the comment of StanleyF, the header file <code>sample_tests.h</code> serves no purpose at all. Delete it and delete <code>#include &quot;sample_tests.h&quot;</code>."}], "owner": {"reputation": 2724, "user_id": 4268602, "user_type": "registered", "accept_rate": 45, "profile_image": "https://graph.facebook.com/730410991/picture?type=large", "display_name": "Daniel Paczuski Bak", "link": "https://stackoverflow.com/users/4268602/daniel-paczuski-bak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 84, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1556063555, "creation_date": 1556063555, "question_id": 55820865, "link": "https://stackoverflow.com/questions/55820865/googletest-using-cmake-separating-tests-into-cpp-and-h-files", "title": "GoogleTest using cmake: Separating tests into .cpp and .h files", "body": "<p>I am not very familiar with C++, especially with make and building.</p>\n\n<p>In my CMakeLists.txt, I have:</p>\n\n<pre><code>add_executable(example test_runner.cpp)\ntarget_link_libraries(example gtest_main)\n\ngtest_discover_tests(example)\n</code></pre>\n\n<p>Then in <code>test_runner.cpp</code> I have:</p>\n\n<pre><code>#include &lt;iostream&gt;\n\n#include \"gtest/gtest.h\"\n#include \"sample_tests.h\"\n\n\nint main(int argc, char **argv)\n{\n    testing::InitGoogleTest(&amp;argc, argv);\n    return RUN_ALL_TESTS();\n}\n</code></pre>\n\n<p>And <code>sample_tests.h</code> is:</p>\n\n<pre><code>#ifndef PROJECTS_SAMPLE_TESTS_H\n#define PROJECTS_SAMPLE_TESTS_H\n\n\n#endif //PROJECTS_SAMPLE_TESTS_H\n</code></pre>\n\n<p>And sample_tests.cpp is:</p>\n\n<pre><code>#include &lt;iostream&gt;\n\n#include \"gtest/gtest.h\"\n#include \"sample_tests.h\"\n\nTEST(sample_test_case, sample_test)\n{\n    EXPECT_EQ(1, 2);\n}\n</code></pre>\n\n<p>So, what is clear to me is that the issue here is that test_runner.cpp imports sample_tests.h, but sample_tests.h doesn't import sample_tests.cpp. However, from my understanding, .h files can't import .cpp files. I know that <code>sample_tests.cpp</code> is supposed to be implementing <code>sample_tests.h</code>, but I can't figure out how to actually link these together.</p>\n\n<p>Is this something I need to configure in cmakelists.txt?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1556063769, "post_id": 55820848, "comment_id": 98307962, "body": "If you signed up for a C++ class it&#39;s only fair to tell you that you&#39;re not learning C++. Looks like you might be using a C++ compiler, but you&#39;re learning C."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1556064322, "post_id": 55820848, "comment_id": 98308066, "body": "<code>#define RAND_MAX 51</code> is not such a good idea. The standard library already contains  a <code>RAND_MAX</code> macro. Weirdness could result. The <code>while (j &lt;= 4)</code> depends on <code>j</code> for the exit condition, but <code>j</code> is never changed."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 1, "creation_date": 1556065423, "post_id": 55820848, "comment_id": 98308268, "body": "Gavin, I recommend drawing some pictures to help you visualize the problem. Draw the <code>cards</code> and how they need to be linked together to produce a stable list. Draw all the steps you need to go through to add an item to the list when it is empty, when it has one <code>card</code>, and for good measure when it has five <code>cards</code> to make sure you don&#39;t think your way into a freaky little bug where you can only ever add one <code>card</code>. Use the pictures to help you establish the logic you need in order to write the code. You&#39;ll probably find that <code>p</code> doesn&#39;t do anything and can be junked."}], "answers": [{"comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1556065191, "post_id": 55820958, "comment_id": 98308233, "body": "<code>p</code> is passed by value. The asker can set it to whatever they want and the most that&#39;ll happen is a memory leak when the function exits. <code>p</code> needs to be rethought from the bottom up."}], "tags": [], "owner": {"reputation": 108, "user_id": 9004851, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ULIdtpj8PUI/AAAAAAAAAAI/AAAAAAAAEMQ/YnDMtLYXbZQ/photo.jpg?sz=128", "display_name": "Arthur Green", "link": "https://stackoverflow.com/users/9004851/arthur-green"}, "is_accepted": false, "score": 1, "last_activity_date": 1556064423, "creation_date": 1556064423, "answer_id": 55820958, "question_id": 55820848, "link": "https://stackoverflow.com/questions/55820848/why-am-i-getting-the-error-exception-thrown-write-access-violation-p-was-null/55820958#55820958", "title": "Why am I getting the error &quot;Exception thrown: write access violation. p was nullptr.?", "body": "<p>In your function addcard(); You check to see if p is NULL:</p>\n\n<pre><code>else if (p == NULL) {\n    temp-&gt;previous = p;\n    temp-&gt;next = NULL;\n    p-&gt;next = temp;\n    *hr = temp;\n</code></pre>\n\n<p>Then, you try and access the NULL p in the line:</p>\n\n<pre><code> p-&gt;next = temp;\n</code></pre>\n\n<p>How can you access something which doesn't exist! That is where the null pointer exception error is coming from. </p>\n\n<p>Maybe you want to initialize p to be a new card_s struct like you did with temp. Using calloc will initialize both the next and previous pointers to NULL.</p>\n\n<pre><code>p = calloc(1, sizeof(card));\n</code></pre>\n\n<p>You are stuck in an infinite loop after this, specifically in your createdeck function. The reason is that you never increment or decrement either j or i so the loop never breaks. </p>\n\n<pre><code>while (i &lt;= 13) {\n\n    j = 1;\n    while (j &lt;= 4) {\n        if (j == 1)\n            addcard(p, hl, hr, i, 'S');\n        if (j == 2)\n            addcard(p, hl, hr, i, 'H');\n        if (j == 3)\n            addcard(p, hl, hr, i, 'D');\n        if (j == 4)\n            addcard(p, hl, hr, i, 'C');\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 11402493, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-WBdijNYgHp0/AAAAAAAAAAI/AAAAAAAABkk/tk8emFVE-6c/photo.jpg?sz=128", "display_name": "gavin cloud", "link": "https://stackoverflow.com/users/11402493/gavin-cloud"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1556064626, "creation_date": 1556063390, "last_edit_date": 1556064626, "question_id": 55820848, "link": "https://stackoverflow.com/questions/55820848/why-am-i-getting-the-error-exception-thrown-write-access-violation-p-was-null", "title": "Why am I getting the error &quot;Exception thrown: write access violation. p was nullptr.?", "body": "<p>I am coding a deck and when I try to run it to assign values to each node and then print it, I get this error when going through the <code>addcard</code> method:</p>\n\n<pre><code>exception thrown: write access violation. p was nullptr.\n</code></pre>\n\n<p>Why is it not okay to work with <code>NULL</code>?</p>\n\n<pre><code>#define _CRT_SECURE_NO_WARNINGS\n#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n\n#define RAND_MAX 51\n\ntypedef struct card_s {\n    char suit;\n    int face;\n    struct card_s *next, *previous;\n} card;\n\nvoid addcard(card *p, card **hl, card **hr, int i, char c) {\n    card *temp;\n    temp = (card *)malloc(sizeof(card)); \n    temp-&gt;face = i;\n    temp-&gt;suit = c;\n    if (*hl == NULL) {\n        temp-&gt;previous = NULL;\n        temp-&gt;next = NULL;\n        *hl = temp;\n        *hr = temp;\n    } else if (p == NULL) {\n        temp-&gt;previous = p;\n        temp-&gt;next = NULL;\n        p-&gt;next = temp;\n        *hr = temp;\n    } else {\n        temp-&gt;next = p-&gt;next;\n        temp-&gt;previous = p;\n        p-&gt;next = temp;\n        temp-&gt;next-&gt;previous = temp;\n    }\n}\n\nvoid delectecard(card *p, card **hl, card **hr) {\n    if (p == *hl) {\n        *hl = p-&gt;next;\n    } else {\n        p-&gt;previous-&gt;next = p-&gt;next;\n    }\n    if (p == *hr) {\n        *hr = p-&gt;previous;\n    } else {\n        p-&gt;next-&gt;previous = p-&gt;previous;\n    }\n    free(p);\n}\n\nvoid createdeck(card *p, card **hl, card **hr) {\n    int i = 1;\n    int j;\n    while (i &lt;= 13) {\n        j = 1;\n        while (j &lt;= 4) {\n            if (j == 1)\n                addcard(p, hl, hr, i, 'S');\n            if (j == 2)\n                addcard(p, hl, hr, i, 'H');\n            if (j == 3)\n                addcard(p, hl, hr, i, 'D');\n            if (j == 4)\n                addcard(p, hl, hr, i, 'C');\n        }\n    }\n}\n\nvoid printdeck(card *currentNode) {\n    while (currentNode != NULL) {\n        printf(\"Face: %d, Suit: %c\\n\", currentNode-&gt;face, currentNode-&gt;suit);\n        currentNode = currentNode-&gt;next;\n    }\n}\n\nint main(void) {\n    card *headl = NULL, *headr = NULL;\n    createdeck(headr, &amp;headl, &amp;headr);\n    printdeck(headl);\n}\n</code></pre>\n"}, {"tags": ["c", "cs50"], "comments": [{"owner": {"reputation": 1060, "user_id": 60694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cca9a181914a4b975f99766275db7788?s=128&d=identicon&r=PG", "display_name": "Chris White", "link": "https://stackoverflow.com/users/60694/chris-white"}, "edited": false, "score": 0, "creation_date": 1556063215, "post_id": 55820791, "comment_id": 98307855, "body": "<a href=\"https://reference.cs50.net/cs50/get_int\" rel=\"nofollow noreferrer\">reference.cs50.net/cs50/get_int</a>"}], "answers": [{"tags": [], "owner": {"reputation": 108, "user_id": 9004851, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ULIdtpj8PUI/AAAAAAAAAAI/AAAAAAAAEMQ/YnDMtLYXbZQ/photo.jpg?sz=128", "display_name": "Arthur Green", "link": "https://stackoverflow.com/users/9004851/arthur-green"}, "is_accepted": false, "score": 0, "last_activity_date": 1556063611, "last_edit_date": 1556063611, "creation_date": 1556063203, "answer_id": 55820831, "question_id": 55820791, "link": "https://stackoverflow.com/questions/55820791/trying-to-make-a-mario-pyramid-depending-on-user-input-however-having-issues-w/55820831#55820831", "title": "trying to make a mario pyramid depending on user input. However, having issues with get int can I get assistance?", "body": "<p>You don't need cs50.h. Unless get_int is a requirement for your program. I hope this solution will help you with your studies.</p>\n\n<p>EDIT: Just realized a Mario pyramid is different from a regular pyramid. My solution below is for a full pyramid. The question has already been asked and a solution can be found <a href=\"https://stackoverflow.com/questions/32303244/how-to-make-the-pyramid-cs50-mario-program-formed-by-this-code-to-be-right-ali\">here</a>.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void)\n{\n    int n, i, j, k;\n\n    printf(\"Number: \");\n    scanf(\"%d\", &amp;n);\n\n    for (i = 0; i &lt; n; i++)\n    {\n\n        for (j = 0; j &lt; n-i; j++)\n        {\n            printf(\" \");\n        }\n\n        for (k =0; k &lt;= i; k++)\n        {\n            printf(\"# \");\n        }\n\n        printf(\"\\n\");\n    }\n\n} \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 191, "user_id": 4889630, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206836010041352/picture?type=large", "display_name": "Jonathan Arley Monsalve Salaza", "link": "https://stackoverflow.com/users/4889630/jonathan-arley-monsalve-salaza"}, "is_accepted": false, "score": 0, "last_activity_date": 1556063632, "creation_date": 1556063632, "answer_id": 55820872, "question_id": 55820791, "link": "https://stackoverflow.com/questions/55820791/trying-to-make-a-mario-pyramid-depending-on-user-input-however-having-issues-w/55820872#55820872", "title": "trying to make a mario pyramid depending on user input. However, having issues with get int can I get assistance?", "body": "<p>It looks like you need to provide a string to get_int function, look here <a href=\"https://reference.cs50.net/cs50/get_int\" rel=\"nofollow noreferrer\">https://reference.cs50.net/cs50/get_int</a></p>\n\n<p>so you should have something like</p>\n\n<pre><code>#include &lt;cs50.h&gt;\n#include &lt;stdio.h&gt;\n\nint main(void)\n{\n  int n = 0;\n  do\n  {\n    int height;\n    //printf(\"Height: \");\n    n= get_int(\"Enter an int: \");\n  }\n  while (n &lt; 8 || n &gt; 1);\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11402472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CNP0z.jpg?s=128&g=1", "display_name": "J fresh", "link": "https://stackoverflow.com/users/11402472/j-fresh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 270, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1556063632, "creation_date": 1556062871, "question_id": 55820791, "link": "https://stackoverflow.com/questions/55820791/trying-to-make-a-mario-pyramid-depending-on-user-input-however-having-issues-w", "title": "trying to make a mario pyramid depending on user input. However, having issues with get int can I get assistance?", "body": "<p>trying to complete the Mario problem fast because I'm a little bit behind but cs50 sandbox like always has a problem with get int  the error says: too few arguments to function call, at least argument 'format' must\nbe specified</p>\n\n<pre><code>#include &lt;cs50.h&gt;\n#include &lt;stdio.h&gt;\n\nint main(void)\n{\nint n = 0;\ndo\n{\nint height;\n//printf(\"Height: \");\n n= get_int();\n}\nwhile (n &lt; 8 || n &gt; 1);\n\nfor (int i=0; i&lt;n; i++)\n{\n    for (int j=0; j&lt;=n; j++)\n\n    {\n       if (i+j &lt;(n=1)) \n     printf(\" \");\n        else\n     printf(\"#\");\n    }\n printf(\"\\n\");\n\n\n}\n</code></pre>\n\n<p>}</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 2, "creation_date": 1556060955, "post_id": 55820522, "comment_id": 98307345, "body": "The expression in the <code>while</code> statement is checking <code>&quot;M&quot;</code> twice. Also, to compare strings in C, use the <code>strcmp</code> function."}, {"owner": {"reputation": 8984, "user_id": 2485966, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dZj6A.jpg?s=128&g=1", "display_name": "Ruud Helderman", "link": "https://stackoverflow.com/users/2485966/ruud-helderman"}, "edited": false, "score": 1, "creation_date": 1556061027, "post_id": 55820522, "comment_id": 98307362, "body": "And use <code>&amp;&amp;</code> instead of <code>||</code>."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1556061221, "post_id": 55820522, "comment_id": 98307395, "body": "<code>&quot;%s&quot;</code> consumes leading whitespace, so the space in <code>&quot; %s&quot;</code> is not needed -- HOWEVER, you do not check the return (ignoring a manual <code>EOF</code>) and you fail to remove any extraneous characters beyond the first character (e.g. after reading <code>sex</code>, <code>int c = getchar(); while (c != &#39;\\n&#39; &amp;&amp; c != EOF) c = getchar();</code>) This beyond your mismatch in types between <code>char sex</code> and <code>&quot;%s&quot;</code> expecting a pointer to char with sufficient storage to hold the string (including the <i>nul-terminating</i> character)"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1556061792, "post_id": 55820522, "comment_id": 98307530, "body": "<b>M</b> for Male and <b>M</b> for Female (inside the loop)?  I think the ladies are entitled to feel annoyed.  The <code>return</code> inside the loop means that people get one retry, which isn&#39;t tested.  You also throw away the result of the user&#39;s input \u2014 that&#39;s not very good.  Surely you should return the selected gender?  It might be worth adding a count on the retries and stopping people from going into a loop.  Stop after 10 failed attempts, for example."}, {"owner": {"reputation": 39, "user_id": 7601950, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08565e5c12838e6100b5f684bf445856?s=128&d=identicon&r=PG&f=1", "display_name": "Angelo", "link": "https://stackoverflow.com/users/7601950/angelo"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1556070786, "post_id": 55820522, "comment_id": 98308666, "body": "@JonathanLeffler I now realize my typo but still when i change the F for female it still does the same thing."}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 1, "creation_date": 1556076278, "post_id": 55820522, "comment_id": 98309691, "body": "Can I downvote the instructor who assigned this?"}], "answers": [{"comments": [{"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 1, "creation_date": 1556068947, "post_id": 55820578, "comment_id": 98308338, "body": "Should point out when the user does enter something that is not M or F then you should read up to the new line character and dispose of that data in the stream"}], "tags": [], "owner": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "is_accepted": false, "score": 5, "last_activity_date": 1556061139, "creation_date": 1556061139, "answer_id": 55820578, "question_id": 55820522, "link": "https://stackoverflow.com/questions/55820522/is-there-a-way-to-create-a-gender-evaluation/55820578#55820578", "title": "Is there a way to create a gender evaluation", "body": "<p><code>sex</code> is a single <code>char</code> variable, but you are treating it as a pointer to a string.</p>\n\n<ol>\n<li>Change your <code>scanf</code> call to have <code>%c</code> (single character) in the format string, rather than <code>%s</code>.</li>\n<li>Change your tests for the value of <code>sex</code> to use single quotes (i.e. <code>if (sex == 'M')</code>).</li>\n</ol>\n\n<p>Note that though this code <em>should not need</em> string comparison if the variable <code>sex</code> is treated like the single <code>char</code> it is, if you were to compare strings in a future project, you would not use the operators <code>==</code> and <code>!=</code> - instead, use the function <a href=\"https://www.programiz.com/c-programming/library-function/string.h/strcmp\" rel=\"noreferrer\"><code>strcmp</code></a> in <code>&lt;string.h&gt;</code></p>\n"}, {"comments": [{"owner": {"reputation": 39, "user_id": 7601950, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08565e5c12838e6100b5f684bf445856?s=128&d=identicon&r=PG&f=1", "display_name": "Angelo", "link": "https://stackoverflow.com/users/7601950/angelo"}, "edited": false, "score": 0, "creation_date": 1556074246, "post_id": 55821102, "comment_id": 98309323, "body": "I am trying it this way  char sex;  void Gender(){      printf(&quot;\\nEnter Student Gender (example M for Male  F for Female):\\n&quot;);      scanf(&quot; %c&quot;,&amp;sex);      switch(sex){   case &#39;M&#39;:   case &#39;m&#39;:     printf(&quot;Student Sex : Male&quot;);     break;   case &#39;F&#39;:   case &#39;f&#39;:     printf(&quot;Student Sex : Female&quot;);     break;    default:     printf(&quot;\\n FALSE gender .. please enter M for Male and F for Female:\\n&quot;);   }    }"}, {"owner": {"reputation": 3971, "user_id": 2840714, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/s9vli.jpg?s=128&g=1", "display_name": "ChuckCottrill", "link": "https://stackoverflow.com/users/2840714/chuckcottrill"}, "reply_to_user": {"reputation": 39, "user_id": 7601950, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08565e5c12838e6100b5f684bf445856?s=128&d=identicon&r=PG&f=1", "display_name": "Angelo", "link": "https://stackoverflow.com/users/7601950/angelo"}, "edited": false, "score": 0, "creation_date": 1556078458, "post_id": 55821102, "comment_id": 98310074, "body": "You gotta use only one of the sexValid functions - I&#39;ve changed the names to end in &#39;c&#39; and &#39;s&#39;, and guessed which you want..."}], "tags": [], "owner": {"reputation": 3971, "user_id": 2840714, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/s9vli.jpg?s=128&g=1", "display_name": "ChuckCottrill", "link": "https://stackoverflow.com/users/2840714/chuckcottrill"}, "is_accepted": false, "score": 1, "last_activity_date": 1556078495, "last_edit_date": 1556078495, "creation_date": 1556068695, "answer_id": 55821102, "question_id": 55820522, "link": "https://stackoverflow.com/questions/55820522/is-there-a-way-to-create-a-gender-evaluation/55821102#55821102", "title": "Is there a way to create a gender evaluation", "body": "<p>Several things, I've provided an implementation with comments...</p>\n\n<p>Include <code>ctype.h</code> to use toupper(3) and allow both upper and lower case entry.\nYou can either use character comparison, or string comparison, I gave you both, pick one.</p>\n\n<pre><code>#include \"Gender.h\"\n#include &lt;stdio.h&gt;\n\n//you should really define these in your Gender.h file...\n#define MALE \"M\"\n#define FEMALE \"F\"\n//you should really define these in your Gender.h file...\nstatic const char* GenderAllowed = MALE\" for Male and \"FEMALE\" for Female\";\nstatic const char* GenderPrompt = \"Enter Student Gender\";\n\n//compare as string[1] - keep either this\n#include &lt;string.h&gt;\nint sexValidc( char* sex ) {\n    return ( (0==strncmp(sex,MALE,1)) || (0==strncmp(sex,FEMALE,1)) );\n}\n\n//compare only first character - or keep this\n#include &lt;ctype.h&gt;\nint sexValids( char* sex ) {\n    char sexch = toupper(*sex); //fold first character to upper case\n    return ( (*MALE==sexch) || (*FEMALE==sexch) );\n}\n\nchar Gender() {\n    char sex[69+1]; //since you wanted to use %s, need a buffer, your &amp;char allows stack overflow &amp; wild memory pointer-ing\n    printf(\"\\n%s (%s):\\n\",GenderPrompt,GenderAllowed); //DRY - Dont Repeat Yourself...\n    int done = 0;\n    while( !done ) {\n        scanf(\" %69s\",sex); //avoid stackoverflow :-)\n        if( !sexValidc( sex ) ) {\n//printf(\"blech, entered: %s\\n\",sex); //debugging, remove when comfortable\n            printf(\"\\n FALSE gender .. %s %s:\\n\",GenderPrompt,GenderAllowed);\n        }\n        else { //valid\n            done = 1;\n        }\n    }\n    printf(\"\\nStudent Sex :%c\\n\", *sex);\n    return *sex; //once you enter valid value, return it...\n}\n\nint main() {\n    Gender();\n}\n</code></pre>\n\n<p>Also read this about automatic allocation of buffer space, <a href=\"https://stackoverflow.com/questions/38685724/difference-between-ms-and-s-scanf\">difference between %ms and %s scanf</a></p>\n"}], "owner": {"reputation": 39, "user_id": 7601950, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08565e5c12838e6100b5f684bf445856?s=128&d=identicon&r=PG&f=1", "display_name": "Angelo", "link": "https://stackoverflow.com/users/7601950/angelo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 266, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1556078495, "creation_date": 1556060658, "last_edit_date": 1556061881, "question_id": 55820522, "link": "https://stackoverflow.com/questions/55820522/is-there-a-way-to-create-a-gender-evaluation", "title": "Is there a way to create a gender evaluation", "body": "<p>I'm trying to get the user of a C program to Enter M for Male and F for Female\nand to loop through if it doesn't meet M or F .\nBelow I have tried the following code but it loops twice giving the correct answer.\nFor instance after entering M it loops and  prints </p>\n\n<p>FALSE gender .. please enter M for Male and M for \n           Female</p>\n\n<p>is there any way to solve it .</p>\n\n<p>The goal is if the user enter M or F it will work without needing to enter it a second time.<br>\nif anything else it may ask a number of times </p>\n\n<pre><code> #include \"Gender.h\"\n #include&lt;stdio.h&gt;\n\n\n  char sex;\n  void Gender(){\n\n  printf(\"\\nEnter Student Gender ('example M for Male  F for Female):\\n\");\n\n  scanf(\" %s\",&amp;sex);\n\n\n\n      while (sex != \"M\" || sex != \"M\"){\n       printf (\"\\n FALSE gender .. please enter M for Male and M for Female:\\n\");\n        scanf(\" %s\",&amp;sex);\n        printf(\"\\nStudent Sex :%c\", sex,\"\\n\");\n        return;\n      }\n\n\n  }\n</code></pre>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 2, "creation_date": 1556059276, "post_id": 55820324, "comment_id": 98306996, "body": "<code>*ptr++</code> increments the pointer. So it no longer points to a valid location. Change that to <code>*ptr = 10;</code>"}], "answers": [{"tags": [], "owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "is_accepted": true, "score": 4, "last_activity_date": 1556059260, "creation_date": 1556059260, "answer_id": 55820339, "question_id": 55820324, "link": "https://stackoverflow.com/questions/55820324/reason-for-getting-garbage-value-in-c/55820339#55820339", "title": "Reason for getting garbage value in C", "body": "<p>You moved <code>ptr</code> with <code>ptr++</code>. Why?</p>\n\n<p>Don't do that.</p>\n"}, {"tags": [], "owner": {"reputation": 137, "user_id": 6686352, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-b6RdxYX47i4/AAAAAAAAAAI/AAAAAAAABjQ/WtRolyOje0Q/photo.jpg?sz=128", "display_name": "Mohit Jain", "link": "https://stackoverflow.com/users/6686352/mohit-jain"}, "is_accepted": false, "score": 0, "last_activity_date": 1556075793, "creation_date": 1556075793, "answer_id": 55821898, "question_id": 55820324, "link": "https://stackoverflow.com/questions/55820324/reason-for-getting-garbage-value-in-c/55821898#55821898", "title": "Reason for getting garbage value in C", "body": "<p>The statement <code>*ptr++</code> increments the pointer which could not be valid for your program.\nRewrite the statement as <code>*ptr = 10;</code></p>\n"}], "owner": {"reputation": 63, "user_id": 6519391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5137258953bfbfc41f0a8ab9f067952e?s=128&d=identicon&r=PG&f=1", "display_name": "S Mahajan", "link": "https://stackoverflow.com/users/6519391/s-mahajan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 55820339, "answer_count": 2, "score": 1, "last_activity_date": 1556075793, "creation_date": 1556059156, "question_id": 55820324, "link": "https://stackoverflow.com/questions/55820324/reason-for-getting-garbage-value-in-c", "title": "Reason for getting garbage value in C", "body": "<p>I'm running this code and getting some garbage value while printing *ptr. What could be the possible reason and how can I avoid getting that?</p>\n\n<pre><code># include &lt;stdio.h&gt;\nint main()\n{\n  int test = 1; \n  int *ptr = &amp;test;\n  *ptr++ = 10; \n  test++; \n  printf(\"\\nThe value is %d\", *ptr);\n}\n</code></pre>\n"}, {"tags": ["c", "multidimensional-array", "embedded", "pic"], "comments": [{"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1556056245, "post_id": 55819874, "comment_id": 98306181, "body": "This is commonly referred to as <b>rotating</b> a 4 byte array."}, {"owner": {"reputation": 53905, "user_id": 2864740, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/e7a05a144f218bde07b659bc98e1ca7d?s=128&d=identicon&r=PG&f=1", "display_name": "user2864740", "link": "https://stackoverflow.com/users/2864740/user2864740"}, "edited": false, "score": 0, "creation_date": 1556056255, "post_id": 55819874, "comment_id": 98306184, "body": "If it aligns on a proper boundary it might be possible to manipulate as a <code>uint32_t*</code> using a a shift | masked_shift (sometimes known as a &quot;barrel roll&quot; or &quot;circular shift&quot;). The bit patterns of the device are important (and may require a &#39;mix&#39; instead of a shift on, eg, Big Endian)."}, {"owner": {"reputation": 53905, "user_id": 2864740, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/e7a05a144f218bde07b659bc98e1ca7d?s=128&d=identicon&r=PG&f=1", "display_name": "user2864740", "link": "https://stackoverflow.com/users/2864740/user2864740"}, "edited": false, "score": 0, "creation_date": 1556056381, "post_id": 55819874, "comment_id": 98306219, "body": "<a href=\"https://stackoverflow.com/q/13289397/2864740\">stackoverflow.com/q/13289397/2864740</a> , <a href=\"https://stackoverflow.com/q/36124058/2864740\">stackoverflow.com/q/36124058/2864740</a>"}, {"owner": {"reputation": 1101, "user_id": 3958521, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GorZx.jpg?s=128&g=1", "display_name": "bigwillydos", "link": "https://stackoverflow.com/users/3958521/bigwillydos"}, "edited": false, "score": 1, "creation_date": 1556058078, "post_id": 55819874, "comment_id": 98306688, "body": "&quot;I only could do it with byte shifting, but that is not what I need&quot; ...cool, show us the code."}, {"owner": {"reputation": 65, "user_id": 9360794, "user_type": "registered", "profile_image": "https://graph.facebook.com/1767659280197731/picture?type=large", "display_name": "RytisBe", "link": "https://stackoverflow.com/users/9360794/rytisbe"}, "edited": false, "score": 0, "creation_date": 1556061521, "post_id": 55819874, "comment_id": 98307461, "body": "I edited the post and added the code."}, {"owner": {"reputation": 65, "user_id": 9360794, "user_type": "registered", "profile_image": "https://graph.facebook.com/1767659280197731/picture?type=large", "display_name": "RytisBe", "link": "https://stackoverflow.com/users/9360794/rytisbe"}, "reply_to_user": {"reputation": 53905, "user_id": 2864740, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/e7a05a144f218bde07b659bc98e1ca7d?s=128&d=identicon&r=PG&f=1", "display_name": "user2864740", "link": "https://stackoverflow.com/users/2864740/user2864740"}, "edited": false, "score": 0, "creation_date": 1556061621, "post_id": 55819874, "comment_id": 98307487, "body": "@user2864740 Thanks for the provided links, I will have a look at them."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1556090552, "post_id": 55819874, "comment_id": 98314088, "body": "&quot;... with an overlap&quot; is ambiguous - you mean &quot;rotate 4 byte array&quot;?"}, {"owner": {"reputation": 65, "user_id": 9360794, "user_type": "registered", "profile_image": "https://graph.facebook.com/1767659280197731/picture?type=large", "display_name": "RytisBe", "link": "https://stackoverflow.com/users/9360794/rytisbe"}, "reply_to_user": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1556123537, "post_id": 55819874, "comment_id": 98333946, "body": "@Clifford wraparound is what I actually ment, sorry."}], "answers": [{"comments": [{"owner": {"reputation": 65, "user_id": 9360794, "user_type": "registered", "profile_image": "https://graph.facebook.com/1767659280197731/picture?type=large", "display_name": "RytisBe", "link": "https://stackoverflow.com/users/9360794/rytisbe"}, "edited": false, "score": 0, "creation_date": 1556134764, "post_id": 55824442, "comment_id": 98338919, "body": "Thanks for your reply! I slightly modified your provided code and included in the main post. However, I observed that shifting of a single pixel say from LED_Buffer[0][0] is as expected (0b00000001 --&gt; 0b10000000), but  it then transitions to the LED_Buffer[0][3]--&gt;LED_Buffer[0][2]--&gt;LED_Buffer[0][1]. It should really go from [0][0].... to [0][3]. I tried to understand what needs to be done in order to fix this, but achieved no success."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "reply_to_user": {"reputation": 65, "user_id": 9360794, "user_type": "registered", "profile_image": "https://graph.facebook.com/1767659280197731/picture?type=large", "display_name": "RytisBe", "link": "https://stackoverflow.com/users/9360794/rytisbe"}, "edited": false, "score": 1, "creation_date": 1556143637, "post_id": 55824442, "comment_id": 98342241, "body": "@RytisBe  : It looks like the byte order as rendered on your LED array is not the same as in your diagram where I had assumed that the left-hand side was index zero.  Reverse the for loop  to run from <code>len</code> to <code>0</code> perhaps?"}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "reply_to_user": {"reputation": 65, "user_id": 9360794, "user_type": "registered", "profile_image": "https://graph.facebook.com/1767659280197731/picture?type=large", "display_name": "RytisBe", "link": "https://stackoverflow.com/users/9360794/rytisbe"}, "edited": false, "score": 0, "creation_date": 1556144196, "post_id": 55824442, "comment_id": 98342411, "body": "I would advise against changing the question to incorporate provided answers; it tends to make the answers look like nonsense.  It now reads like &quot;<i>Q: I tried X, but it does not work. A: Try X</i>&quot;.    In this case a new question may be appropriate since I think the issue is a difference between what you asked for and what you actually need."}, {"owner": {"reputation": 65, "user_id": 9360794, "user_type": "registered", "profile_image": "https://graph.facebook.com/1767659280197731/picture?type=large", "display_name": "RytisBe", "link": "https://stackoverflow.com/users/9360794/rytisbe"}, "edited": false, "score": 0, "creation_date": 1556146502, "post_id": 55824442, "comment_id": 98342947, "body": "I totaly agree with you. To be honest, you provided enough information and after spending a little bit more time I managed to modify the given function to behave the way I want it to. Thanks to you Clifford."}], "tags": [], "owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "is_accepted": true, "score": 2, "last_activity_date": 1556091645, "last_edit_date": 1556091645, "creation_date": 1556090490, "answer_id": 55824442, "question_id": 55819874, "link": "https://stackoverflow.com/questions/55819874/how-to-shift-4-byte-array-by-all-32-bits-with-a-wraparound/55824442#55824442", "title": "How to shift 4 byte array by all 32 bits with a wraparound?", "body": "<p>A specific solution for if the layer is always 4 bytes is to pack the bytes into a <code>uint32_t</code> and apply the rotation to that.</p>\n\n<p>Given:</p>\n\n<pre><code>void layer_rotate_right( uint8_t layer[4] ) \n{\n    // Pack...\n    uint32_t word = layer[0]&lt;&lt;24 | layer[1]&lt;&lt;16 | layer[2]&lt;&lt;8 | layer[3] ;\n\n    // Rotate...\n    uint32_t rotated = word &lt;&lt; 31 | word &gt;&gt; 1 ;\n\n    // Unpack...\n    layer[0] = rotated &gt;&gt; 24 ;\n    layer[1] = (rotated &gt;&gt; 16) &amp; 0xff ;\n    layer[2] = (rotated &gt;&gt; 8) &amp; 0xff ;\n    layer[3] = rotated &amp; 0xff ;\n}\n</code></pre>\n\n<p>Then:</p>\n\n<pre><code>for (int row = 0; row &lt; LAYERS; row++) \n{\n    layer_rotate_right( LED_Buffer[row] )\n}\n</code></pre>\n\n<p>The packing and unpacking is somewhat cumbersome.  Given appropriate endianness and alignment you may get away with casting, but as a solution it does not scale.</p>\n\n<p>A more general solution for any size byte array is:</p>\n\n<pre><code>void layer_rotate_right( uint8_t* layer, int len ) \n{\n    uint8_t carry = layer[len - 1] &lt;&lt; 7 ;\n    for( int i = 0; i &lt; len; i++ )\n    {   \n        uint8_t next_carry = layer[i] &lt;&lt; 7 ;\n        layer[i] = (layer[i] &gt;&gt; 1) | carry ;\n        carry = next_carry ;\n    }\n}\n</code></pre>\n\n<p>Then:</p>\n\n<pre><code>for (int row = 0; row &lt; LAYERS; row++) \n{\n    layer_rotate_right( LED_Buffer[row], BYTES )\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1101, "user_id": 3958521, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GorZx.jpg?s=128&g=1", "display_name": "bigwillydos", "link": "https://stackoverflow.com/users/3958521/bigwillydos"}, "is_accepted": false, "score": 1, "last_activity_date": 1556218611, "creation_date": 1556218611, "answer_id": 55855964, "question_id": 55819874, "link": "https://stackoverflow.com/questions/55819874/how-to-shift-4-byte-array-by-all-32-bits-with-a-wraparound/55855964#55855964", "title": "How to shift 4 byte array by all 32 bits with a wraparound?", "body": "<p>A different approach would be to use a union. For example,</p>\n\n<pre><code>typedef union{\n    uint8_t buff8[4];\n    uint32_t buff32;\n}led_buffer_t;\n</code></pre>\n\n<p>Then use this to declare <code>LED_Buffer</code> (e.g. <code>led_buffer_t LED_Buffer[LAYERS] = {0};</code>)</p>\n\n<p>And then use the circular shift answer here: <a href=\"https://stackoverflow.com/questions/13289397/circular-shift-in-c\">Circular shift in c</a></p>\n\n<p>I tried it out here: <a href=\"https://onlinegdb.com/ByfcMY1sE\" rel=\"nofollow noreferrer\">https://onlinegdb.com/ByfcMY1sE</a></p>\n"}], "owner": {"reputation": 65, "user_id": 9360794, "user_type": "registered", "profile_image": "https://graph.facebook.com/1767659280197731/picture?type=large", "display_name": "RytisBe", "link": "https://stackoverflow.com/users/9360794/rytisbe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 271, "favorite_count": 0, "accepted_answer_id": 55824442, "answer_count": 2, "score": 0, "last_activity_date": 1556218611, "creation_date": 1556056070, "last_edit_date": 1556182504, "question_id": 55819874, "link": "https://stackoverflow.com/questions/55819874/how-to-shift-4-byte-array-by-all-32-bits-with-a-wraparound", "title": "How to shift 4 byte array by all 32 bits with a wraparound?", "body": "<p>I am trying to implement an animation shifting function, that will allow me to shift all (LAYERS*BYTES) LEDS by 32 bits with an overlap. I only could do it with byte shifting, but that is not what I need. </p>\n\n<p>To better understnad the idea, the image is provided below:</p>\n\n<p><a href=\"https://i.stack.imgur.com/OS04A.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/OS04A.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>I drew it out where C is a carry bit that is moved to the start of the following byte and the last element of 4 bytes is assigned to the first element of the first byte. </p>\n\n<p>There might be a better way to implement this. I appreciate for any help in advance.</p>\n\n<p>Additional information:</p>\n\n<pre><code>void Shift_Right_Byte(void){\n    for (int row = 0; row &lt; LAYERS; row++) {\n            for (int col = 0; col &lt; BYTES; col++) {\n                LED_Buffer[row][col] = LED_Buffer[row][(col + 1) % BYTES];\n            }\n        }\n        delay(1000);\n}\n</code></pre>\n\n<p>New function:</p>\n\n<pre><code>void layer_rotate_right(void) \n{\n    for (int row = 0; row &lt; LAYERS; row++) {\n        unsigned char carry = LED_Buffer[row][BYTES - 1] &lt;&lt; 7 ;\n        for( int i = 0; i &lt; BYTES; i++ )\n        {   \n            unsigned char next_carry = LED_Buffer[row][i] &lt;&lt; 7 ;\n            LED_Buffer[row][i] = (LED_Buffer[row][i] &gt;&gt; 1) | carry ;\n            carry = next_carry ;\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "gcc"], "comments": [{"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 0, "creation_date": 1556056194, "post_id": 55819861, "comment_id": 98306157, "body": "Try installing devel files for GCC. &quot;<i>Such is the nature of Cygwin</i>&quot;"}, {"owner": {"reputation": 342, "user_id": 2884140, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zEa73.jpg?s=128&g=1", "display_name": "Ricky Divjakovski", "link": "https://stackoverflow.com/users/2884140/ricky-divjakovski"}, "reply_to_user": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 0, "creation_date": 1556056899, "post_id": 55819861, "comment_id": 98306369, "body": "@JL2210 Im currently using the devel package, ive also tried the mingw GCC with no success"}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 2, "creation_date": 1556069740, "post_id": 55819861, "comment_id": 98308445, "body": "Try installing the 32-bit versions of the packages."}], "owner": {"reputation": 342, "user_id": 2884140, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zEa73.jpg?s=128&g=1", "display_name": "Ricky Divjakovski", "link": "https://stackoverflow.com/users/2884140/ricky-divjakovski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 369, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1556055985, "creation_date": 1556055985, "question_id": 55819861, "link": "https://stackoverflow.com/questions/55819861/cygwin-bin-ld-cannot-find-lgcc-eh", "title": "cygwin/bin/ld: cannot find -lgcc_eh", "body": "<p>Im trying to compile a program on my windows machine with cygwin and im facing this error </p>\n\n<pre><code>cannot find -lgcc_eh\n</code></pre>\n\n<p>Seems like a missing dependancy or a flag issue, heres the Makefile</p>\n\n<pre><code>CC      = gcc\nSTRIP = strip -s --remove-section=.note --remove-section=.comment\nTARGET  = resource_tool\n\nHEADERS = resource_tool.h common.h\nSOURCES = resource_tool.c common.c\nOBJS    = $(SOURCES:.c=.o)\n\nCFLAGS  = -fshort-wchar -m32 -ffunction-sections -Os\nLDFLAGS = -Wl,--gc-sections -static \n\nSOURCES += tests.c\nHEADERS += tests.h\n\n%.o: %.c $(HEADERS) Makefile\n    $(CC) -c -o $@ $&lt; $(CFLAGS)\n\n$(TARGET): $(OBJS)\n    $(CC) -o $@ $(OBJS) $(CFLAGS) $(LDFLAGS) $(LIBS)\n    $(STRIP) $@\n</code></pre>\n\n<p>Ive done some research but cant find anything that has helped</p>\n"}, {"tags": ["c", "pointers", "copy", "parameter-passing", "conventions"], "comments": [{"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1556059866, "post_id": 55819785, "comment_id": 98307120, "body": "Passing pointers is always fast, passing copies might be slow. But this is actually a history question. The earliest versions of C didn&#39;t allow pass-by-value for structures. So using pointers was the only option. That has carried forward in legacy code (and legacy programmers), even though pass-by-value is now supported."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1556064248, "post_id": 55819785, "comment_id": 98308053, "body": "On a 64-bit machine, a <code>Token</code> is probably at least 24 bytes long.  While that&#39;s not very heavy, neither is it very light.  It may be that the comparator function is supposed to be usable by <code>qsort()</code> and similar functions.  In that case, it needs to take pointers to the data because <code>qsort()</code> passes pointer (though the pointer arguments should be <code>const void *</code> rather than <code>Token *</code> \u2014 but that&#39;s another discussion)."}, {"owner": {"reputation": 2449, "user_id": 500276, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/200bf76976f24add540182f5c3a42788?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Benningfield", "link": "https://stackoverflow.com/users/500276/mark-benningfield"}, "edited": false, "score": 0, "creation_date": 1556074124, "post_id": 55819785, "comment_id": 98309299, "body": "Another point is that the far-and-away most common convention is to pass pointers. Remember that code is <i>read</i> many times; only <i>written</i> once. To someone reading the code after the fact, a function that accepts a struct value rather than a pointer would seem discordant, to say the least."}, {"owner": {"reputation": 11251, "user_id": 3284878, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/d324c610856d2626e9b719eb4135b3cb?s=128&d=identicon&r=PG&f=1", "display_name": "Aviv Cohn", "link": "https://stackoverflow.com/users/3284878/aviv-cohn"}, "reply_to_user": {"reputation": 2449, "user_id": 500276, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/200bf76976f24add540182f5c3a42788?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Benningfield", "link": "https://stackoverflow.com/users/500276/mark-benningfield"}, "edited": false, "score": 0, "creation_date": 1556138591, "post_id": 55819785, "comment_id": 98340555, "body": "@MarkBenningfield So the general convention is to pass structs by pointer? I&#39;m kinda looking for a rule of thumb so I won&#39;t have to think about this too much anytime I write code (I&#39;m new to C). Thanks!"}, {"owner": {"reputation": 2449, "user_id": 500276, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/200bf76976f24add540182f5c3a42788?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Benningfield", "link": "https://stackoverflow.com/users/500276/mark-benningfield"}, "edited": false, "score": 0, "creation_date": 1556138808, "post_id": 55819785, "comment_id": 98340625, "body": "@AvivCohn: Yes, in general, unless there is a specific reason not to, you just pass a struct pointer, rather than the struct itself."}, {"owner": {"reputation": 11251, "user_id": 3284878, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/d324c610856d2626e9b719eb4135b3cb?s=128&d=identicon&r=PG&f=1", "display_name": "Aviv Cohn", "link": "https://stackoverflow.com/users/3284878/aviv-cohn"}, "reply_to_user": {"reputation": 2449, "user_id": 500276, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/200bf76976f24add540182f5c3a42788?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Benningfield", "link": "https://stackoverflow.com/users/500276/mark-benningfield"}, "edited": false, "score": 0, "creation_date": 1556146912, "post_id": 55819785, "comment_id": 98343047, "body": "@MarkBenningfield I see. However, as opposed to passing, when <i>returning</i> a struct (which was created in the called function), wouldn&#39;t you say it makes more sense to return by value? Returning a pointer would force us to <code>malloc</code> the struct and handle life cycle for it, even if it&#39;s small."}, {"owner": {"reputation": 2449, "user_id": 500276, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/200bf76976f24add540182f5c3a42788?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Benningfield", "link": "https://stackoverflow.com/users/500276/mark-benningfield"}, "edited": false, "score": 0, "creation_date": 1556169738, "post_id": 55819785, "comment_id": 98347305, "body": "@AvivCohn: The use of <code>malloc()</code> and <code>free()</code> is not a hardship to be avoided as such. Don&#39;t fear the pointer, embrace it."}], "answers": [{"comments": [{"owner": {"reputation": 11251, "user_id": 3284878, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/d324c610856d2626e9b719eb4135b3cb?s=128&d=identicon&r=PG&f=1", "display_name": "Aviv Cohn", "link": "https://stackoverflow.com/users/3284878/aviv-cohn"}, "edited": false, "score": 0, "creation_date": 1556212785, "post_id": 55822285, "comment_id": 98370620, "body": "Thanks for the answer. So would you say, <code>identifiersEqual</code> takes a pointer (the &quot;default convention&quot; for struct passing) since it&#39;s just &quot;consulting&quot; the passed structs, while <code>addLocal</code> takes the value because it copies the data somewhere, so might as well be explicit about it?"}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "reply_to_user": {"reputation": 11251, "user_id": 3284878, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/d324c610856d2626e9b719eb4135b3cb?s=128&d=identicon&r=PG&f=1", "display_name": "Aviv Cohn", "link": "https://stackoverflow.com/users/3284878/aviv-cohn"}, "edited": false, "score": 0, "creation_date": 1556223087, "post_id": 55822285, "comment_id": 98375260, "body": "@aviv: i think that&#39;s a fair summary. Parsers are infamous for creating a huge number of short-lived small dynamically allocated objects, and pretty well every parser does some kind of dance to control this overhead. Maybe that&#39;s premature optimisation but we&#39;ve all done it."}, {"owner": {"reputation": 11251, "user_id": 3284878, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/d324c610856d2626e9b719eb4135b3cb?s=128&d=identicon&r=PG&f=1", "display_name": "Aviv Cohn", "link": "https://stackoverflow.com/users/3284878/aviv-cohn"}, "edited": false, "score": 0, "creation_date": 1556233348, "post_id": 55822285, "comment_id": 98378574, "body": "So do you oppose to the approach I described?"}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "reply_to_user": {"reputation": 11251, "user_id": 3284878, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/d324c610856d2626e9b719eb4135b3cb?s=128&d=identicon&r=PG&f=1", "display_name": "Aviv Cohn", "link": "https://stackoverflow.com/users/3284878/aviv-cohn"}, "edited": false, "score": 0, "creation_date": 1556265850, "post_id": 55822285, "comment_id": 98386825, "body": "@aviv: I&#39;m very much of the &quot;whatever works best for you&quot; school of thought. The most important thing is to document your interfaces, but it doesn&#39;t hurt if the interfaces are also self-documenting. You need to design APIs based on the expected use cases, and you need to comment them well enough that if you return to the code in ten years, you will still be able to maintain it."}], "tags": [], "owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "is_accepted": false, "score": 1, "last_activity_date": 1556079582, "last_edit_date": 1592644375, "creation_date": 1556078892, "answer_id": 55822285, "question_id": 55819785, "link": "https://stackoverflow.com/questions/55819785/good-practices-when-should-a-non-mutating-function-ask-for-a-pointer-instead-of/55822285#55822285", "title": "Good practices: When should a non-mutating function ask for a pointer instead of a copy?", "body": "<p>This question is verging on asking for an opinion, so I should probablyu have avoided saying that I probably wouldn't use these two interfaces in the same program, because I try to avoid APIs where a datatype is sometimes passed by value and other times by reference. But that's just me, so I'll limit the rest of the answer to a reason why you might choose to use an interface which passes a medium-heavy object by value. If you want to hear the original coder's reasons for choosing this style, you should ask him directly.</p>\n<p>The first point is that most modern compilers will be able to avoid the copy if they have access to the body of the called function and the called function itself is lightweight enough to inline. These conditions seem to apply in the case of the functions from the referenced code, so there is probably no cost to using call-by-value. [Note 1] So if the API style provides useful information to the code reader, then it could be considered useful.</p>\n<p>Now consider the parameter prototypes <code>X const *</code> and <code>X</code>. In both cases, we know that the argument passed is not going to be modified, so we certainly don't need to make a copy of it.</p>\n<p>But there still could be a concern about the <em>lifetime</em> of the argument. If the called function takes a pointer and saves that pointer into an object which will outlive the call, then we would need to worry about ownership of the object passed. In effect, we would need to pass ownership of the object to the called function, and we would also need to ensure that the object did not have automatic lifetime. In particular, we could not call the function with a temporary, and we might feel some doubt about calling the function with an object with static lifetime (which could not be <code>free</code>d).</p>\n<p>On the other hand, a call-by-value clearly does not impose any requirements on the caller. If the called function wants to save the passed object, it is responsible for making the copy and disposing of the copy when it is no longer useful. We can pass it any object we like: a temporary, a static, or a local object which will be reused for a subsequent call.</p>\n<p>As it happens, token objects are frequently local objects which are reused in a parsing loop, rather than dynamically-allocated objects which impose a more complicated memory management regime. Most of the time, token objects passed to functions are only consulted, but sometimes they do need to be saved. The function name <code>addLocal</code> rather strongly suggests that this function will persist the passed object.</p>\n<p>In this particular case, <code>addLocal</code> does in fact save the passed object, but it saves a copy. It cannot do otherwise, because it is passed a copy and the copy will not outlive the call. Fortunately, the optimiser will almost certainly inline <code>addLocal</code>, thereby avoiding the unnecessary intermediate copy. So the use of call-by-value here has accurately communicated to the code reader that there was absolutely no need to worry about the lifetime of the object passed to <code>addLocal</code>.</p>\n<p>In the case of <code>identifiersEqual</code>, it does not seem likely that the called function will need to persist either of the passed objects, so the guarantee is perhaps less important. But, as mentioned above, I would probably have written <code>identifiersEqual</code> as call-by-value, too, for consistency, hoping that the compiler succeeded in avoiding the copy altogether. (That's a leap of faith, and it's possible that my quest for consistency here is a kind of tic.)</p>\n<hr />\n<h3>Notes</h3>\n<ol>\n<li><p>With very lightweight objects and certain compilers, it is possible that call-by-value will produce <em>better</em>  compiled code. For example, the standard 64-bit ABI allows structures which fit into eight bytes to be passed in registers, which is particularly convenient if the object is being constructed for the sole purpose of passing it to a function. I remember from the days when I wrote to OS X GUI APIs that small geometry objects were always passed small geometry objects by value, and that there was a note in the programming guide explaining that this was done for efficiency. I don't know if that's still true, but I also don't think this particular struct is lightweight enough for that to apply. Although possibly not common, there are other contexts in which making it clear to certain compilers that an object's address is never taken does allow the compiler to produce better code.</p>\n<p>In the context of this question, it is sufficient to observe that the generated code for call-by-value is (probably) no worse than call-by-reference. If it really mattered to you, you'd have to check the generated code from the compiler you cared about. I haven't done that.</p>\n</li>\n</ol>\n"}], "owner": {"reputation": 11251, "user_id": 3284878, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/d324c610856d2626e9b719eb4135b3cb?s=128&d=identicon&r=PG&f=1", "display_name": "Aviv Cohn", "link": "https://stackoverflow.com/users/3284878/aviv-cohn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1556079582, "creation_date": 1556055546, "question_id": 55819785, "link": "https://stackoverflow.com/questions/55819785/good-practices-when-should-a-non-mutating-function-ask-for-a-pointer-instead-of", "title": "Good practices: When should a non-mutating function ask for a pointer instead of a copy?", "body": "<p>Considering a data type which is pretty light, and a function which takes this type as a parameter but <em>doesn't mutate it</em> - I'm trying to understand when I would want to pass a pointer to it instead of simply copy. In terms of general C good-practices.</p>\n\n<p>It seems to me copying such a light value wouldn't be significant to performance, and a pointer may cause more confusion than a plain value.</p>\n\n<p>For example, please consider the following code (taken from Bob Nystrom \"Crafting Interpreters\" book):</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>typedef struct {\n    TokenType type;\n    const char* start;\n    int length;\n    int line;\n} Token;\n</code></pre>\n\n<p>In the following piece of code, <code>identifiersEqual</code> takes parameters of type <code>Token*</code> as opposed to pure <code>Token</code>. This might make sense - we don't have to copy <code>Token</code>.</p>\n\n<p>On the other hand, <code>addLocal</code> takes plain <code>Token</code>.</p>\n\n<p>In terms of general C good-practices - I'm trying to understand if there's a particular reason why <code>identifiersEqual</code> takes a pointer, but <code>addLocal</code> takes a copy. Both functions do not mutate the value, and once again - <code>Token</code> doesn't weigh much.</p>\n\n<p>Is there a pattern here I'm missing, or is this just by chance? In what cases should I decide this way or the other?</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>static bool identifiersEqual(Token* a, Token* b) {\n    if (a-&gt;length != b-&gt;length) return false;\n    return memcmp(a-&gt;start, b-&gt;start, a-&gt;length) == 0;\n}\n\nstatic void addLocal(Token name) {\n    if (current-&gt;localCount == UINT8_COUNT) {\n        error(\"Too many local variables in function.\");\n        return;\n    }\n\n    Local* local = &amp;current-&gt;locals[current-&gt;localCount++];\n    local-&gt;name = name;\n    local-&gt;depth = -1;\n}\n\nstatic void declareVariable() {\n    if (current-&gt;scopeDepth == 0) return;\n\n    Token* name = &amp;parser.previous;\n\n    for (int i = current-&gt;localCount - 1; i &gt;= 0; i--) {\n        Local* local = &amp;current-&gt;locals[i];\n        if (local-&gt;depth != -1 &amp;&amp; local-&gt;depth &lt; current-&gt;scopeDepth) break;\n        if (identifiersEqual(name, &amp;local-&gt;name)) {\n            error(\"Variable with this name already declared in this scope.\");\n        }\n    }\n\n    addLocal(*name);\n}\n\n</code></pre>\n"}, {"tags": ["c", "arrays", "string"], "comments": [{"owner": {"reputation": 9, "user_id": 11138102, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-N-aETxqhPK0/AAAAAAAAAAI/AAAAAAAAD4g/WWx8ZgB7BzA/photo.jpg?sz=128", "display_name": "Shai&#39;Tavia Baisy", "link": "https://stackoverflow.com/users/11138102/shaitavia-baisy"}, "edited": false, "score": 0, "creation_date": 1556055546, "post_id": 55819780, "comment_id": 98305951, "body": "Expected Output: 3 2 0 4 print.... 2 0 4------ 3 2 0 4 nothing... Error: invalid command----------- 3 2 0 4 find 2.......1------ 3 2 0 4 find 9...... not found"}, {"owner": {"reputation": 5338, "user_id": 4594973, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/USV9e.jpg?s=128&g=1", "display_name": "code_dredd", "link": "https://stackoverflow.com/users/4594973/code-dredd"}, "edited": false, "score": 0, "creation_date": 1556055783, "post_id": 55819780, "comment_id": 98306022, "body": "You should&#39;ve paid more attention to the step-by-step instructions when getting ready to ask your first question... It&#39;s not clear what you want, and it just seems to be asking for the solution to a homework assignment."}, {"owner": {"reputation": 9, "user_id": 11138102, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-N-aETxqhPK0/AAAAAAAAAAI/AAAAAAAAD4g/WWx8ZgB7BzA/photo.jpg?sz=128", "display_name": "Shai&#39;Tavia Baisy", "link": "https://stackoverflow.com/users/11138102/shaitavia-baisy"}, "reply_to_user": {"reputation": 5338, "user_id": 4594973, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/USV9e.jpg?s=128&g=1", "display_name": "code_dredd", "link": "https://stackoverflow.com/users/4594973/code-dredd"}, "edited": false, "score": 0, "creation_date": 1556055798, "post_id": 55819780, "comment_id": 98306028, "body": "Suggested Strategy: 1. after reading the array, read a string. 2. if the string is find, read integer k and perform a search. 3. if the string is print, do not read k, print the data in the array. 4. if the string is not find or print, handle the error."}, {"owner": {"reputation": 5338, "user_id": 4594973, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/USV9e.jpg?s=128&g=1", "display_name": "code_dredd", "link": "https://stackoverflow.com/users/4594973/code-dredd"}, "edited": false, "score": 0, "creation_date": 1556055960, "post_id": 55819780, "comment_id": 98306076, "body": "Out of curiosity: Your profile says you&#39;re a Psychology major... but they&#39;re making you write code in <b><i>C</i></b> of all languages?... Can you try a more forgiving language like Python? It might save you a lot of headaches."}, {"owner": {"reputation": 9, "user_id": 11138102, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-N-aETxqhPK0/AAAAAAAAAAI/AAAAAAAAD4g/WWx8ZgB7BzA/photo.jpg?sz=128", "display_name": "Shai&#39;Tavia Baisy", "link": "https://stackoverflow.com/users/11138102/shaitavia-baisy"}, "reply_to_user": {"reputation": 5338, "user_id": 4594973, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/USV9e.jpg?s=128&g=1", "display_name": "code_dredd", "link": "https://stackoverflow.com/users/4594973/code-dredd"}, "edited": false, "score": 0, "creation_date": 1556056077, "post_id": 55819780, "comment_id": 98306121, "body": "I&#39;m asking  for a explanation for what the instructions are asking and this code is for an elective."}, {"owner": {"reputation": 5338, "user_id": 4594973, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/USV9e.jpg?s=128&g=1", "display_name": "code_dredd", "link": "https://stackoverflow.com/users/4594973/code-dredd"}, "edited": false, "score": 0, "creation_date": 1556056393, "post_id": 55819780, "comment_id": 98306222, "body": "I&#39;ve fixed some typos and made some of the formatting easier to read. Please correct if I misunderstood anything. Regarding the instructions, I&#39;m not sure what&#39;s unclear to you. Can you be more specific?"}, {"owner": {"reputation": 5338, "user_id": 4594973, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/USV9e.jpg?s=128&g=1", "display_name": "code_dredd", "link": "https://stackoverflow.com/users/4594973/code-dredd"}, "edited": false, "score": 0, "creation_date": 1556056565, "post_id": 55819780, "comment_id": 98306272, "body": "Also, the <code>int x [n];</code> line won&#39;t work because <code>n</code> is a variable not known at compile time. You&#39;ll need to use <code>int *x = malloc(n * sizeof int);</code> and then <code>free(x);</code> when you no longer need to use your <code>x</code> array."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1556058742, "post_id": 55819780, "comment_id": 98306864, "body": "@codedredd <code>int x [n];</code> is a <a href=\"https://www.geeksforgeeks.org/variable-length-arrays-in-c-and-c/\" rel=\"nofollow noreferrer\"><i>variable length array</i></a> whose length is determined at run time."}, {"owner": {"reputation": 5338, "user_id": 4594973, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/USV9e.jpg?s=128&g=1", "display_name": "code_dredd", "link": "https://stackoverflow.com/users/4594973/code-dredd"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1556075176, "post_id": 55819780, "comment_id": 98309489, "body": "@WeatherVane I actually had to write code here to test that out because, in the link you posted, the examples have constant literals in place and do not ask for user input at runtime, leading me to think that the array size would&#39;ve been inferred at <i>compile</i> time instead. I was wrong."}], "answers": [{"tags": [], "owner": {"reputation": 108, "user_id": 9004851, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ULIdtpj8PUI/AAAAAAAAAAI/AAAAAAAAEMQ/YnDMtLYXbZQ/photo.jpg?sz=128", "display_name": "Arthur Green", "link": "https://stackoverflow.com/users/9004851/arthur-green"}, "is_accepted": false, "score": 0, "last_activity_date": 1556060025, "last_edit_date": 1556060025, "creation_date": 1556058973, "answer_id": 55820301, "question_id": 55819780, "link": "https://stackoverflow.com/questions/55819780/how-to-use-a-code-with-arrays-and-strings/55820301#55820301", "title": "How to use a code with arrays and strings?", "body": "<p>Shai'Tavia, I hope my answer will help you see how you may make your code work. You've got the first part down, but you will need to compare the command string given by the user to then make a decision on what to do next. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\n#define ARRAYLENGTH 8\n\nvoid printArray(int *array, int length)\n{\n    for (int i = 0; i &lt; length; i++)\n        printf(\"%d \", array[i]);\n    printf(\"\\n\");\n}\n\nvoid search(int *array, int key)\n{\n    int flag = 0;\n\n    for (int i = 0; i &lt; ARRAYLENGTH; i++)\n    {\n        if (array[i] == key &amp;&amp; flag == 0)\n        {\n            printf(\"found %d at index: %d\\n\", key, i);\n            flag = 1;\n        }\n    }\n\n    if (flag == 0)\n        printf(\"not found\\n\");\n}\n\nint main(void)\n{\n    char command[20];\n    int indx = 0;\n    int array[] = {1, 4, 6, 8, 43, 61, 34, 2};\n    int n, flag = 0;\n\n    printf(\"How many times will we run?\");\n    scanf(\"%d\", &amp;n);\n\n    if (n &lt; 1)\n    {\n        printf(\"Error: one or more values must be provided.\\n\");\n        return 1;\n    }\n\n    do\n    {\n        printf(\"Enter the command word:\");\n        scanf(\"%s\", command);\n\n        if (strcmp(command, \"find\") == 0)\n        {\n            scanf(\"%d\", &amp;n);\n            search(array, n);\n        }\n\n        else if (strcmp(command, \"print\") == 0)\n            printArray(array, ARRAYLENGTH);\n\n        else\n            printf(\"Command not found\\n\");\n\n    } while (--n &gt; 0);\n\n    printf(\"What is your final interger?\");\n    scanf(\"%d\", &amp;n);\n\n    search(array, n);\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 11138102, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-N-aETxqhPK0/AAAAAAAAAAI/AAAAAAAAD4g/WWx8ZgB7BzA/photo.jpg?sz=128", "display_name": "Shai&#39;Tavia Baisy", "link": "https://stackoverflow.com/users/11138102/shaitavia-baisy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1556060025, "creation_date": 1556055531, "last_edit_date": 1556056310, "question_id": 55819780, "link": "https://stackoverflow.com/questions/55819780/how-to-use-a-code-with-arrays-and-strings", "title": "How to use a code with arrays and strings?", "body": "<p>Here are the instructions I was given:</p>\n\n<ol>\n<li>If the command word is <code>find</code>, read an additional integer and search the data set for that integer.</li>\n<li>If the command word is <code>print</code>, print the array</li>\n<li>Any other command word is an error.</li>\n<li><p>No command word will be longer than 20 characters.</p></li>\n<li><p>After reading the <code>n+1</code> values, there will be one more integer (k) read from the keyboard.</p></li>\n<li>Search the array for the value k. If found, print the location where k was found. (1 = data value, n = last data value).</li>\n<li>If <code>k</code> is not found, print <code>not found</code>. This is not an error.</li>\n<li>If there are more than one value <code>k</code> in the data, only print the location of the first one.</li>\n</ol>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main (void) {\n   int n;\n   scanf (\"%d\", &amp;n);\n   if (n &lt; 1) {\n      printf (\"Error: one or more values must be provided.\\n\");\n      return 1;\n   }\n\n   int x [n];\n   int a;\n   a = 0;\n   while (a &lt; n) {\n      scanf (\"%d\", x [a]);\n      a = a + 1;\n   }\n\n   int k;\n   scanf (\"%d\", &amp;k);\n   int i;\n   i = 0;\n   while (i &lt;= n-1) {\n      if (x[i] == k) {\n         break;\n      }\n      i = i + 1;\n   }\n   if (i &lt; n) {\n      printf (\"%d\\n\", k+1);\n   } else {\n      printf (\"not found\\n\");\n   }\n\n   printf (\"Error: invalid command\\n\");\n   return 0;\n}\n</code></pre>\n\n<p>Suggested Strategy:</p>\n\n<ol>\n<li>After reading the array data, read a string.</li>\n<li>If the string is <code>find</code>, read integer <code>k</code> and perform a search.</li>\n<li>If the string is <code>print</code>, do not read <code>k</code>, just print the data in the array.</li>\n<li>If the string is not <code>find</code> or <code>print</code>, handle the error.</li>\n</ol>\n"}, {"tags": ["c++", "c", "decompiling", "ida"], "comments": [{"owner": {"reputation": 1199, "user_id": 3825101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yJgje.png?s=128&g=1", "display_name": "macro_controller", "link": "https://stackoverflow.com/users/3825101/macro-controller"}, "edited": false, "score": 0, "creation_date": 1556113491, "post_id": 55819647, "comment_id": 98327741, "body": "Did you rebased your code in IDA? Rebased code might show that kind of behavior."}, {"owner": {"reputation": 11, "user_id": 11399890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9944cd8748e48eff02e6924e3aa497de?s=128&d=identicon&r=PG&f=1", "display_name": "Martin Brooker", "link": "https://stackoverflow.com/users/11399890/martin-brooker"}, "reply_to_user": {"reputation": 1199, "user_id": 3825101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yJgje.png?s=128&g=1", "display_name": "macro_controller", "link": "https://stackoverflow.com/users/3825101/macro-controller"}, "edited": false, "score": 0, "creation_date": 1556113732, "post_id": 55819647, "comment_id": 98327882, "body": "@Train, not really. Just loaded it as is into ida."}], "owner": {"reputation": 11, "user_id": 11399890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9944cd8748e48eff02e6924e3aa497de?s=128&d=identicon&r=PG&f=1", "display_name": "Martin Brooker", "link": "https://stackoverflow.com/users/11399890/martin-brooker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 543, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1556083014, "creation_date": 1556054855, "last_edit_date": 1556083014, "question_id": 55819647, "link": "https://stackoverflow.com/questions/55819647/ida-pro-hexrays-decompiler-memory0x40080-error", "title": "IDA Pro Hexrays Decompiler MEMORY[0x40080] Error", "body": "<p>I'm using IDA Pro 7.0 with Hexrays plugin to decompile some C++ code.</p>\n\n<p>I very often encounter some functions that their de-compiled code just looks wrong and display them in red foreground color like so:</p>\n\n<pre><code>MEMORY[0x1008] = 1;\nif (MEMORY[0x1008])\n....\n</code></pre>\n\n<p>And very often I get at the top of my function the following red statement:\n// write access to const memory has been detected, the output may be wrong!</p>\n\n<p>My assumption that it's somewhat related to stack issues.</p>\n\n<p>How can I fix the this the de-compiled code would just look cleaner?</p>\n\n<p>TIA for any help and pointers!</p>\n"}, {"tags": ["c", "vector", "dynamic", "struct"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 11287719, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-1_XICyK64RE/AAAAAAAAAAI/AAAAAAAAAM4/v4jfIL1V0Zw/photo.jpg?sz=128", "display_name": "D C", "link": "https://stackoverflow.com/users/11287719/d-c"}, "edited": false, "score": 0, "creation_date": 1556052662, "post_id": 55819201, "comment_id": 98304849, "body": "Can u give me an exemple ? Its easier to understand. My problem is the syntax, the way i should write the code in order to use dynamic vectors in structs"}], "tags": [], "owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "is_accepted": true, "score": 0, "last_activity_date": 1595090975, "last_edit_date": 1595090975, "creation_date": 1556052505, "answer_id": 55819201, "question_id": 55819158, "link": "https://stackoverflow.com/questions/55819158/how-to-transfer-info-from-a-txt-file-to-dynamic-vectors-of-structures/55819201#55819201", "title": "How to transfer info from a txt file to dynamic vectors of structures", "body": "<p>it is an array dynamically allocated, using <em>malloc</em> then <em>realloc</em> to change (increase) its size</p>\n<p>for instance :</p>\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n\ntypedef struct Driver {\n  char * name;\n  int ID;\n  int day;\n  int month;\n  int year;\n  int weight;\n  float experience;\n  int punishment;\n} Driver;\n\nint main(int argc, char ** argv)\n{\n  if (argc != 2) {\n    printf(&quot;Usage : %s &lt;file&gt;\\n&quot;, *argv);\n    return -1;\n  }\n  \n  FILE * fp = fopen(argv[1], &quot;r&quot;);\n  \n  if (fp == NULL) {\n    fprintf(stderr, &quot;cannot open '%s'\\n&quot;, argv[1]);\n    return -1;\n  }\n  \n  char line[128];\n  Driver * drivers = malloc(0); /* initial allocation, here empty */\n  int n = 0;\n  \n  while (fgets(line, sizeof(line), fp) != NULL) {\n    /* remove \\n */\n    char * p = strchr(line, '\\n');\n    \n    if (p != NULL)\n      *p = 0;\n    \n    drivers = realloc(drivers, (n + 1) * sizeof(Driver)); /* resize to add one element */\n    \n    Driver * d = &amp;drivers[n++];\n    \n    d-&gt;name = strdup(line);\n    if ((fgets(line, sizeof(line), fp) == NULL) ||\n        (sscanf(line, &quot;%d %d %d %d %d %f %d&quot;,\n                &amp;d-&gt;ID, &amp;d-&gt;day, &amp;d-&gt;month, &amp;d-&gt;year,\n                &amp;d-&gt;weight, &amp;d-&gt;experience, &amp;d-&gt;punishment)\n        != 7)) {\n      fprintf(stderr, &quot;invalid file driver #%d\\n&quot;, n);\n      fclose(fp);\n      return -1;\n    }\n  }\n  fclose(fp);\n  \n  /* check */\n  Driver * sup = drivers + n;\n  \n  for (Driver * d = drivers; d != sup; ++d)\n    printf(&quot;%s : ID=%d birthdate=%d/%d/%d weight=%d experience=%f punishment=%d\\n&quot;,\n           d-&gt;name, d-&gt;ID,\n           d-&gt;day, d-&gt;month, d-&gt;year,\n           d-&gt;weight, d-&gt;experience, d-&gt;punishment);\n\n  return 0;\n}\n</code></pre>\n<p>Compilation and execution :</p>\n<pre><code>pi@raspberrypi:/tmp $ gcc -g -pedantic -Wextra -Wall d.c\npi@raspberrypi:/tmp $ cat f\nPaulo Andrade\n2  23  12  1995  76  0.5  0 \nFaisca\n3   1   1  1980  50  9.5  1    \nDiana Alves Pombo\n4  1  10  1990  55  4.5  0 \nAna Luisa Freitas\n7  12  7  1976  68  1.0  3\npi@raspberrypi:/tmp $ ./a.out f\nPaulo Andrade : ID=2 birthdate=23/12/1995 weight=76 experience=0.500000 punishment=0\nFaisca : ID=3 birthdate=1/1/1980 weight=50 experience=9.500000 punishment=1\nDiana Alves Pombo : ID=4 birthdate=1/10/1990 weight=55 experience=4.500000 punishment=0\nAna Luisa Freitas : ID=7 birthdate=12/7/1976 weight=68 experience=1.000000 punishment=3\npi@raspberrypi:/tmp $ \n</code></pre>\n<p>The initial <code>malloc(0)</code> can seem strange but it is needed to after use <em>realloc</em> or if you prefer do <code>Driver * drivers = NULL;</code>. I Allocate only one more entry each time, it is also possible to <em>malloc</em> more than 0 initially then <em>realloc</em> for more than one more element when necessary for better performances in case there are a lot of elements in the final array.</p>\n<p>Warning <code>drivers = realloc(drivers, ...)</code> can or not moves the allocated array to be able to find more space, but you always need to suppose its address change, this is why I reassign the result in <em>drivers</em></p>\n"}], "owner": {"reputation": 3, "user_id": 11287719, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-1_XICyK64RE/AAAAAAAAAAI/AAAAAAAAAM4/v4jfIL1V0Zw/photo.jpg?sz=128", "display_name": "D C", "link": "https://stackoverflow.com/users/11287719/d-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 55819201, "answer_count": 1, "score": -3, "last_activity_date": 1595090975, "creation_date": 1556052325, "question_id": 55819158, "link": "https://stackoverflow.com/questions/55819158/how-to-transfer-info-from-a-txt-file-to-dynamic-vectors-of-structures", "title": "How to transfer info from a txt file to dynamic vectors of structures", "body": "<p>I'm trying to transfer driver's information from a txt file to dynamic vectors of structures.\nI have a txt file like so:  </p>\n\n<pre><code>Paulo Andrade\n2  23  12  1995  76  0.5  0 \n\nFaisca\n3   1   1  1980  50  9.5  1    \n\nDiana Alves Pombo\n4  1  10  1990  55  4.5  0 \n\nAna Luisa Freitas\n7  12  7  1976  68  1.0  3\n</code></pre>\n\n<p>The first line is the name of the driver, the second is his ID, birthdate, weight, experience and punishment.</p>\n\n<p>I need to create the struct with dynamic vectors to save the info of each driver, but my problem are the dynamic vectors.\nCan someone help me with that please ?</p>\n"}]