[{"tags": ["c", "linux-kernel", "compression", "kernel-module", "lz4"], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 3457702, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003515213172/picture?type=large", "display_name": "user3457702", "link": "https://stackoverflow.com/users/3457702/user3457702"}, "edited": false, "score": 0, "creation_date": 1458321814, "post_id": 36052322, "comment_id": 59825478, "body": "Thanks! I am checking the zram codes recently, I think they are what I need. And about the stack overflow I think you are right. I had these problems before, I will check my codes and see the results, thanks!"}, {"owner": {"reputation": 31, "user_id": 3457702, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003515213172/picture?type=large", "display_name": "user3457702", "link": "https://stackoverflow.com/users/3457702/user3457702"}, "edited": false, "score": 0, "creation_date": 1458336673, "post_id": 36052322, "comment_id": 59833502, "body": "I modified my codes, they are totally work now. Thanks! It was the stack overflow problem, I just modified it to kmalloc. And the functions lz4_compress &amp; lz4_decompress can do the compression work correctly."}], "tags": [], "owner": {"reputation": 3561, "user_id": 1149797, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/cVBtb.png?s=128&g=1", "display_name": "Alex Hoppus", "link": "https://stackoverflow.com/users/1149797/alex-hoppus"}, "is_accepted": false, "score": 1, "last_activity_date": 1458192532, "creation_date": 1458192532, "answer_id": 36052322, "question_id": 36049161, "link": "https://stackoverflow.com/questions/36049161/how-to-use-lz4-compression-functions-in-kernel-modules/36052322#36052322", "title": "How to use LZ4 compression functions in kernel modules?", "body": "<p>The kernel stack size is 2 pages by default. So you initiated stack overflow. If you need example of lz4 using - look into zram, it has lz4 compression backend.\nThe stack canaries is a special mechanism of protection from buffer overflow attacks (if you are interested in)</p>\n"}], "owner": {"reputation": 31, "user_id": 3457702, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003515213172/picture?type=large", "display_name": "user3457702", "link": "https://stackoverflow.com/users/3457702/user3457702"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 939, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1458192532, "creation_date": 1458172224, "question_id": 36049161, "link": "https://stackoverflow.com/questions/36049161/how-to-use-lz4-compression-functions-in-kernel-modules", "title": "How to use LZ4 compression functions in kernel modules?", "body": "<p>I am using kernel 3.16 and trying to use LZ4 to compress data in memory. I checked kernel source tree, found the compression source file /lib/lz4.c and I used the following function:</p>\n\n<pre><code>int lz4_compress(const unsigned char *src, size_t src_len,\n            unsigned char *dst, size_t *dst_len, void *wrkmem)\n</code></pre>\n\n<p>But I got the following error:</p>\n\n<pre><code> 31.652635] Kernel panic - not syncing: stack-protector: Kernel stack is corrupted in: ffffffffc010d13a\n[   31.652635] \n[   31.653595] CPU: 0 PID: 1856 Comm: insmod Tainted: P           OE 3.16.0-30-generic #40~14.04.1-Ubuntu\n[   31.654408] Hardware name: Parallels Software International Inc. Parallels Virtual Platform/Parallels Virtual Platform, BIOS 11.1.3 (32521) 02/16/2016\n[   31.655579]  ffff8800aa33e080 ffff8801483d1c90 ffffffff81762590 ffffffff81a75d20\n[   31.656295]  ffff8801483d1d08 ffffffff8175aa62 ffff880000000010 ffff8801483d1d18\n[   31.657011]  ffff8801483d1cb8 ffffffffc01230ae ffffffffc010d13a 00000000fb25afb4\n[   31.657730] Call Trace:\n[   31.657966]  [&lt;ffffffff81762590&gt;] dump_stack+0x45/0x56\n[   31.658424]  [&lt;ffffffff8175aa62&gt;] panic+0xc8/0x1fc\n[   31.658850]  [&lt;ffffffffc01230ae&gt;] ? lz4_compress+0xae/0x1000 [lz4_compress]\n[   31.659463]  [&lt;ffffffffc010d13a&gt;] ? hello_init+0x13a/0x140 [test]\n[   31.660008]  [&lt;ffffffffc010d000&gt;] ? 0xffffffffc010cfff\n[   31.660468]  [&lt;ffffffff8106db2b&gt;] __stack_chk_fail+0x1b/0x20\n[   31.660970]  [&lt;ffffffffc010d13a&gt;] hello_init+0x13a/0x140 [test]\n[   31.661626] Kernel Offset: 0x0 from 0xffffffff81000000 (relocation range: 0xffffffff80000000-0xffffffffbfffffff)\n[   31.662512] ---[ end Kernel panic - not syncing: stack-protector: Kernel stack is corrupted in: ffffffffc010d13a\n[   31.662512] \n</code></pre>\n\n<p>My source code:</p>\n\n<pre><code>#include&lt;linux/module.h&gt;\n#include&lt;linux/slab.h&gt;\n#include&lt;linux/kernel.h&gt;\n#include&lt;linux/lz4.h&gt;\n\nstatic int hello_init(void){\n    unsigned char buf[PAGE_SIZE];\n    unsigned char data[PAGE_SIZE];\n    int i;\n    size_t comp_size;\n    unsigned char *dst;\n    dst=(unsigned char*)kmalloc(PAGE_SIZE, GFP_KERNEL);\n    memset(dst,0,PAGE_SIZE);\n    for(i=0;i&lt;PAGE_SIZE;i++)\n        data[i]=i;\n    lz4_compress(data, PAGE_SIZE, dst, &amp;comp_size, buf);\n    return 0;\n}\n\nstatic void hello_exit(void){\n    printk(\"clean up\\n\");\n}\n\nmodule_init(hello_init);\nmodule_exit(hello_exit);\n</code></pre>\n\n<p>I tried to find some examples about how LZ4 works in kernel modules, but I found nothing. I don't know if anyone has some experience about doing compression in kernel module.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["python", "c", "subprocess"], "comments": [{"owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "edited": false, "score": 0, "creation_date": 1458172242, "post_id": 36049149, "comment_id": 59746659, "body": "You invoked <i>undefined behavior</i> by using value of uninitialized variable having automatic storage duration <code>p[0]</code>, which is indeterminate."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1458172359, "post_id": 36049149, "comment_id": 59746690, "body": "Before asking how to run a program in Python, you should make sure the program runs correctly from the console."}, {"owner": {"reputation": 142870, "user_id": 8747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1ee0402d24625f555c25ea8511aad31?s=128&d=identicon&r=PG", "display_name": "Rob\u1d69", "link": "https://stackoverflow.com/users/8747/rob%e1%b5%a9"}, "edited": false, "score": 0, "creation_date": 1458172385, "post_id": 36049149, "comment_id": 59746706, "body": "You failed to check the return value of <code>scanf()</code>. I believe that it is returning <code>EOF</code>."}, {"owner": {"reputation": 142870, "user_id": 8747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1ee0402d24625f555c25ea8511aad31?s=128&d=identicon&r=PG", "display_name": "Rob\u1d69", "link": "https://stackoverflow.com/users/8747/rob%e1%b5%a9"}, "edited": false, "score": 0, "creation_date": 1458172521, "post_id": 36049149, "comment_id": 59746757, "body": "Aside: One should avoid <code>void main(void)</code>. <a href=\"http://stackoverflow.com/a/204483/8747\">stackoverflow.com/a/204483/8747</a>"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 142870, "user_id": 8747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1ee0402d24625f555c25ea8511aad31?s=128&d=identicon&r=PG", "display_name": "Rob\u1d69", "link": "https://stackoverflow.com/users/8747/rob%e1%b5%a9"}, "edited": false, "score": 0, "creation_date": 1458172538, "post_id": 36049149, "comment_id": 59746764, "body": "@Rob\u1d69: As <code>p[0] is encountered first, there is no use in meditating if </code>scanf` updates <code>p</code>. Once you encounter undefined behaviour, all bets are off."}, {"owner": {"reputation": 146, "user_id": 2127595, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/a559fc8f92ee3fae1883e0937b7f2545?s=128&d=identicon&r=PG", "display_name": "user2127595", "link": "https://stackoverflow.com/users/2127595/user2127595"}, "reply_to_user": {"reputation": 142870, "user_id": 8747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1ee0402d24625f555c25ea8511aad31?s=128&d=identicon&r=PG", "display_name": "Rob\u1d69", "link": "https://stackoverflow.com/users/8747/rob%e1%b5%a9"}, "edited": false, "score": 0, "creation_date": 1458172767, "post_id": 36049149, "comment_id": 59746846, "body": "Runs fine from the command line and using <code>subprocess.run(&quot;test.exe&quot;)</code> and entering a sequence like hi, bye, q. @Rob, you think characters are being sent other than what are listed as the input in the call to <code>communicate</code>?"}, {"owner": {"reputation": 142870, "user_id": 8747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1ee0402d24625f555c25ea8511aad31?s=128&d=identicon&r=PG", "display_name": "Rob\u1d69", "link": "https://stackoverflow.com/users/8747/rob%e1%b5%a9"}, "edited": false, "score": 0, "creation_date": 1458172929, "post_id": 36049149, "comment_id": 59746902, "body": "No, I think the stream is being closed after the first four characters are sent. The subsequent <code>scanf()</code> calls return EOF and the process never exits."}, {"owner": {"reputation": 142870, "user_id": 8747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1ee0402d24625f555c25ea8511aad31?s=128&d=identicon&r=PG", "display_name": "Rob\u1d69", "link": "https://stackoverflow.com/users/8747/rob%e1%b5%a9"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1458173070, "post_id": 36049149, "comment_id": 59746950, "body": "@Olaf - you are correct in your &quot;all bets are off&quot; assertion. I still claim it is worth contemplating what happens <i>after</i> he fixes that problem."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 142870, "user_id": 8747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1ee0402d24625f555c25ea8511aad31?s=128&d=identicon&r=PG", "display_name": "Rob\u1d69", "link": "https://stackoverflow.com/users/8747/rob%e1%b5%a9"}, "edited": false, "score": 0, "creation_date": 1458173183, "post_id": 36049149, "comment_id": 59746982, "body": "@Rob\u1d69: Yes, that is the next issue to be addressed."}, {"owner": {"reputation": 146, "user_id": 2127595, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/a559fc8f92ee3fae1883e0937b7f2545?s=128&d=identicon&r=PG", "display_name": "user2127595", "link": "https://stackoverflow.com/users/2127595/user2127595"}, "reply_to_user": {"reputation": 142870, "user_id": 8747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1ee0402d24625f555c25ea8511aad31?s=128&d=identicon&r=PG", "display_name": "Rob\u1d69", "link": "https://stackoverflow.com/users/8747/rob%e1%b5%a9"}, "edited": false, "score": 0, "creation_date": 1458176670, "post_id": 36049149, "comment_id": 59747945, "body": "@Rob\u1d69 My question is answered by using <code>ris.stdin.write</code>, but I am still curious about why checking for <code>EOF</code> doesn&#39;t seem to prevent the loop when `com = ris.communicate(&#39;bye\\n&#39;)&#39; is called."}, {"owner": {"reputation": 142870, "user_id": 8747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1ee0402d24625f555c25ea8511aad31?s=128&d=identicon&r=PG", "display_name": "Rob\u1d69", "link": "https://stackoverflow.com/users/8747/rob%e1%b5%a9"}, "edited": false, "score": 0, "creation_date": 1458179381, "post_id": 36049149, "comment_id": 59748803, "body": "You&#39;re not checking correctly. Re-read the doc for <a href=\"http://en.cppreference.com/w/c/io/fscanf\" rel=\"nofollow noreferrer\"><code>scanf</code></a> and <a href=\"http://en.cppreference.com/w/c/io/fgets\" rel=\"nofollow noreferrer\"><code>fgets</code></a>. In neither your original program nor your edited program do you check the return value of either of those calls."}], "answers": [{"comments": [{"owner": {"reputation": 146, "user_id": 2127595, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/a559fc8f92ee3fae1883e0937b7f2545?s=128&d=identicon&r=PG", "display_name": "user2127595", "link": "https://stackoverflow.com/users/2127595/user2127595"}, "edited": false, "score": 0, "creation_date": 1458173187, "post_id": 36049295, "comment_id": 59746984, "body": "I would rather not use communicate. <code>ris.stdin.write()</code> or somoething like this that can send a stream of input would be much preferable."}], "tags": [], "owner": {"reputation": 142870, "user_id": 8747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1ee0402d24625f555c25ea8511aad31?s=128&d=identicon&r=PG", "display_name": "Rob\u1d69", "link": "https://stackoverflow.com/users/8747/rob%e1%b5%a9"}, "is_accepted": true, "score": 2, "last_activity_date": 1458173300, "last_edit_date": 1458173300, "creation_date": 1458173012, "answer_id": 36049295, "question_id": 36049149, "link": "https://stackoverflow.com/questions/36049149/running-an-external-executable-in-python-interactively/36049295#36049295", "title": "Running an external executable in Python interactively", "body": "<p>In addition to the errors in your C program that have been mentioned, you are calling <code>.communicate()</code> more than once. <code>.communicate()</code> is single-use function that sends <em>all</em> of its data to the subprocess and waits for the subprocess to exit.</p>\n\n<p>If you must use <code>.communicate()</code>, use it this way:</p>\n\n<pre><code>com = ris.communicate(input='bye\\nq\\n')\n</code></pre>\n\n<p>Alternatively, you can use <code>ris.stdin.write()</code>, like so:</p>\n\n<pre><code>import subprocess\nfrom subprocess import PIPE, STDOUT\n\noutput = open(\"test.out\",\"w\")\nris = subprocess.Popen(executable=\"/tmp/test.exe\", args=\"\", stdin=PIPE,\n                       stdout=output, stderr=STDOUT,\n                       universal_newlines=True, shell=True)\ncom = ris.stdin.write('bye\\n')\ncom = ris.stdin.write('q\\n')\nris.stdin.flush()\noutput.close()\nris.wait()\n</code></pre>\n"}], "owner": {"reputation": 146, "user_id": 2127595, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/a559fc8f92ee3fae1883e0937b7f2545?s=128&d=identicon&r=PG", "display_name": "user2127595", "link": "https://stackoverflow.com/users/2127595/user2127595"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 857, "favorite_count": 0, "accepted_answer_id": 36049295, "answer_count": 1, "score": -1, "last_activity_date": 1458187522, "creation_date": 1458172142, "last_edit_date": 1458187522, "question_id": 36049149, "link": "https://stackoverflow.com/questions/36049149/running-an-external-executable-in-python-interactively", "title": "Running an external executable in Python interactively", "body": "<p>A simple C program is compiled using <code>gcc test.c -o test.exe</code>:</p>\n\n<pre><code>        /* TEST.C */\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#define TRUE 1\n\nint main (void)\n{\n  char p[256];\n  strcpy(p, \"start\\0\");\n  printf(\"Welcome!\\n\");\n  while (TRUE)\n  {\n    printf(\"Input: \");\n    if (fgets(p, 255, stdin) == NULL)  break;\n    if (p[0] == 'q')                   break;\n    printf(\"You Entered: %s\\n\", p);\n  }\n  return 0;\n}\n</code></pre>\n\n<p>The subprocess module in Python portends to start a program and grab its <code>stdin</code> and <code>stdout</code>. Simple test using the above program:</p>\n\n<pre><code>import subprocess\nfrom subprocess import PIPE, STDOUT\n\noutput = open(\"test.out\",\"w\")\nris = subprocess.Popen(executable=\"test.exe\", args=\"\", stdin=PIPE,\n                       stdout=output, stderr=STDOUT,\n                       universal_newlines=True, shell=True)  \ncom = ris.communicate(input='bye\\n')\ncom = ris.communicate(input='q\\n')\noutput.close()\n</code></pre>\n\n<p>appears to loop infinitely on the first communicate command, filling <code>test.out</code> with:</p>\n\n<pre><code>Welcome!\nYou Entered: bye\nYou Entered: bye\nYou Entered: bye\nYou Entered: bye\n.\n.\n.\n</code></pre>\n\n<p>until the user interrupts the python process. Using <code>ris.stdin.write('bye\\n')</code> instead of <code>communicate</code> does not seem to send input at all even when followed by <code>ris.stdin.flush()</code>. </p>\n\n<p>What is the proper way to interactively run an executable with <code>subprocess</code>?  The intention is to leave a single instance of the program running in the background while multiple inputs are passed in through <code>stdin</code> and the corresponding outputs are read from <code>stdout</code> or <code>stderr</code></p>\n"}, {"tags": ["c", "scope"], "comments": [{"owner": {"reputation": 62852, "user_id": 1737, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/9152c282382ec3b1f0cd18dc8ba7a5ab?s=128&d=identicon&r=PG", "display_name": "Roddy", "link": "https://stackoverflow.com/users/1737/roddy"}, "edited": false, "score": 0, "creation_date": 1458170145, "post_id": 36048758, "comment_id": 59745920, "body": "They&#39;re different <code>a</code>s. Read about variable <i>scope</i>."}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 1, "creation_date": 1458170246, "post_id": 36048758, "comment_id": 59745969, "body": "u tell us, does it print 42?"}, {"owner": {"reputation": 2552, "user_id": 5360912, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/gfQGt.png?s=128&g=1", "display_name": "TinyTheBrontosaurus", "link": "https://stackoverflow.com/users/5360912/tinythebrontosaurus"}, "edited": false, "score": 0, "creation_date": 1458170246, "post_id": 36048758, "comment_id": 59745970, "body": "BTW, it&#39;s actually defined in two functions, but only initialized in one. It&#39;s worded backwards in the question"}, {"owner": {"reputation": 11, "user_id": 6074217, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bd799725fec822763c2ae5603b7d420?s=128&d=identicon&r=PG&f=1", "display_name": "Y. W.", "link": "https://stackoverflow.com/users/6074217/y-w"}, "reply_to_user": {"reputation": 2552, "user_id": 5360912, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/gfQGt.png?s=128&g=1", "display_name": "TinyTheBrontosaurus", "link": "https://stackoverflow.com/users/5360912/tinythebrontosaurus"}, "edited": false, "score": 0, "creation_date": 1458170370, "post_id": 36048758, "comment_id": 59746024, "body": "Thanks @TinyTheBrontosaurus"}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 3, "creation_date": 1458170562, "post_id": 36048758, "comment_id": 59746083, "body": "ahh, darn. Thought this was a duplicate. Turns out not quite, what I had in mind is talking about <code>c++</code>, but I think a lot of the same principles apply here. Eric Lippert usually has great answers: <a href=\"http://stackoverflow.com/questions/6441218/can-a-local-variables-memory-be-accessed-outside-its-scope\" title=\"can a local variables memory be accessed outside its scope\">stackoverflow.com/questions/6441218/&hellip;</a>"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1458170723, "post_id": 36048758, "comment_id": 59746144, "body": "It&#39;s local vars with automatic duration.  There are so many dups that Jon Skeet cannot count them all."}, {"owner": {"reputation": 62852, "user_id": 1737, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/9152c282382ec3b1f0cd18dc8ba7a5ab?s=128&d=identicon&r=PG", "display_name": "Roddy", "link": "https://stackoverflow.com/users/1737/roddy"}, "reply_to_user": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1458171163, "post_id": 36048758, "comment_id": 59746295, "body": "@yano. Yes it&#39;s a dupe, even though c != c++"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1458173430, "post_id": 36048758, "comment_id": 59747050, "body": "You should think why these variables are called <b>local</b> variables."}], "answers": [{"comments": [{"owner": {"reputation": 62852, "user_id": 1737, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/9152c282382ec3b1f0cd18dc8ba7a5ab?s=128&d=identicon&r=PG", "display_name": "Roddy", "link": "https://stackoverflow.com/users/1737/roddy"}, "edited": false, "score": 0, "creation_date": 1458170248, "post_id": 36048782, "comment_id": 59745972, "body": "I bet even more would optimize <code>a</code> out completely from <code>foo</code>."}], "tags": [], "owner": {"reputation": 2552, "user_id": 5360912, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/gfQGt.png?s=128&g=1", "display_name": "TinyTheBrontosaurus", "link": "https://stackoverflow.com/users/5360912/tinythebrontosaurus"}, "is_accepted": true, "score": 0, "last_activity_date": 1458170478, "last_edit_date": 1458170478, "creation_date": 1458170156, "answer_id": 36048782, "question_id": 36048758, "link": "https://stackoverflow.com/questions/36048758/declare-variable-in-two-functions-but-only-initialize-one-of-them/36048782#36048782", "title": "Declare variable in two functions but only initialize one of them", "body": "<p>Oooo, that's a good one. Officially it's undefined. But I bet a lot of them would print 42 because the a's likely will use the same memory address on the stack.</p>\n\n<p>So that basics of how this works, is when a function is called the value of the PC (program counter) that the program should return to is pushed on the stack along with the parameters. In this case, both foo and bar have no parameters so just one pointer will be pushed onto the stack (so say a total of 4 bytes starting at relative address 0). </p>\n\n<p>Then when a funciton starts, its variables are pushed onto the stack. In this case, both of them have in a which will be pushed, which is again 4 bytes for each (total of 8 bytes, starting at relative address 4).</p>\n\n<p>This is a common way in C/C++ to grab data from other functions / programs that the function otherwise shouldn't be allowed to access. </p>\n"}, {"tags": [], "owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "is_accepted": false, "score": 1, "last_activity_date": 1458170424, "creation_date": 1458170424, "answer_id": 36048836, "question_id": 36048758, "link": "https://stackoverflow.com/questions/36048758/declare-variable-in-two-functions-but-only-initialize-one-of-them/36048836#36048836", "title": "Declare variable in two functions but only initialize one of them", "body": "<p>The official answer is that this</p>\n\n<pre><code>void bar() {\n    int a;\n    printf(\"%d\",a);\n}\n</code></pre>\n\n<p>invokes 'Undefined Behavior'. Anyting can happen. It could print a poem, format your hard drive, turn on the lights on white house xmas tree,... It might even print 42 and some people will tell you how that could happen is some cases.</p>\n\n<p>The fact that elsewhere you have another variable called <code>a</code> is irrelevant</p>\n"}, {"tags": [], "owner": {"reputation": 62852, "user_id": 1737, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/9152c282382ec3b1f0cd18dc8ba7a5ab?s=128&d=identicon&r=PG", "display_name": "Roddy", "link": "https://stackoverflow.com/users/1737/roddy"}, "is_accepted": false, "score": 0, "last_activity_date": 1458170868, "creation_date": 1458170868, "answer_id": 36048915, "question_id": 36048758, "link": "https://stackoverflow.com/questions/36048758/declare-variable-in-two-functions-but-only-initialize-one-of-them/36048915#36048915", "title": "Declare variable in two functions but only initialize one of them", "body": "<p>Undefined behaviour. You're printing an uninitialized variable. <code>a</code> in <code>foo</code> is conceptually a different variable to <code>a</code> in bar. </p>\n\n<p>While UB could (According to the standard) do any of all of the bizarre things suggested by @pm100, in the real world it will print out whatever happens to be in some random memory location or register. So, an undefined value.</p>\n\n<p>Will it print 42? Possibly. a: because there's a random chance that the undefined value was 42, b: because possibly the memory/register was written with 42 by <code>foo</code> and hasn't been overwritten by something else.</p>\n\n<p>Can I rely on it always printing 42? 100%, no!</p>\n"}, {"tags": [], "owner": {"reputation": 10563, "user_id": 1104328, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/df0790774838286ad0d93567ae1fcf56?s=128&d=identicon&r=PG&f=1", "display_name": "Harry", "link": "https://stackoverflow.com/users/1104328/harry"}, "is_accepted": false, "score": 0, "last_activity_date": 1458172041, "creation_date": 1458172041, "answer_id": 36049124, "question_id": 36048758, "link": "https://stackoverflow.com/questions/36048758/declare-variable-in-two-functions-but-only-initialize-one-of-them/36049124#36049124", "title": "Declare variable in two functions but only initialize one of them", "body": "<p>Undefined behavior! </p>\n\n<p>Observed behavior is both clang and gcc print 42 if optimization is off. If you add -O1 the foo function effectively vanishes and the printf then prints some garbage.</p>\n\n<p>The following program shows you that the effective address that the <b>a</b> points to is the same in both functions</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdint.h&gt;\nvoid foo();\nvoid bar();\n\nvoid foo() {\n  uint8_t a = 255;\n  uint8_t b = 255;\n  printf(\"%p\\n\",&amp;a);\n}\n\nvoid bar() {\n  uint16_t a;\n  printf(\"%p\\n\",&amp;a);\n  printf(\"%hu\\n\",a);\n}\nint main(void) {\n  foo();\n  bar();\n}\n</code></pre>\n\n<p>output is </p>\n\n<pre><code>0x7fff54dd259e\n0x7fff54dd259e\n65535\n</code></pre>\n\n<p>This is observed behavior on my machine today at this time in these weather conditions. You may of course observe flying pigs, pink elephants or any manner of <a href=\"https://en.wikipedia.org/wiki/Heisenbug\" rel=\"nofollow\">Heisenbug</a> whilst trying to observe what the above code actually does.</p>\n"}], "owner": {"reputation": 11, "user_id": 6074217, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bd799725fec822763c2ae5603b7d420?s=128&d=identicon&r=PG&f=1", "display_name": "Y. W.", "link": "https://stackoverflow.com/users/6074217/y-w"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "closed_date": 1458212494, "accepted_answer_id": 36048782, "answer_count": 4, "score": -2, "last_activity_date": 1458173394, "creation_date": 1458170049, "last_edit_date": 1458173394, "question_id": 36048758, "link": "https://stackoverflow.com/questions/36048758/declare-variable-in-two-functions-but-only-initialize-one-of-them", "closed_reason": "Not suitable for this site", "title": "Declare variable in two functions but only initialize one of them", "body": "<p>Variable a is declared in two separate functions, but only initialized in one of them. The main function calls the function that declares and initializes a, then it calls the second function which redeclares that variable without initializing it. It prints 42, even though a is initialized in a different function scope whose data should have been destroyed after the function's completion. Why is this happening?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nvoid foo() {\n    int a = 42;\n}\nvoid bar() {\n    int a;\n    printf(\"%d\",a);\n}\nmain() {\n    foo();\n    bar();\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 1, "creation_date": 1458170834, "post_id": 36048737, "comment_id": 59746186, "body": "Nope - cannot compare null-terminated char arrays like that.  It&#39;s also a multi-dup."}, {"owner": {"reputation": 1, "user_id": 6074139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5662e93016fe9199b3ef9ad436ac1d9e?s=128&d=identicon&r=PG&f=1", "display_name": "Sus", "link": "https://stackoverflow.com/users/6074139/sus"}, "reply_to_user": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1458171205, "post_id": 36048737, "comment_id": 59746307, "body": "I am still confused. like where i should make changes?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1458171566, "post_id": 36048737, "comment_id": 59746439, "body": "You have multiple errors which show some missconception. Your compiler should warn already (if not, enable warnings). Please read a C book about pointers, arrays and string literals (and the rest)."}], "answers": [{"tags": [], "owner": {"reputation": 806, "user_id": 4842585, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-oygxcJWDVYk/AAAAAAAAAAI/AAAAAAAAADU/S75I8NGFQCg/photo.jpg?sz=128", "display_name": "Sylvain GIROD", "link": "https://stackoverflow.com/users/4842585/sylvain-girod"}, "is_accepted": false, "score": 0, "last_activity_date": 1458171394, "creation_date": 1458171394, "answer_id": 36049015, "question_id": 36048737, "link": "https://stackoverflow.com/questions/36048737/string-comparison-in-if-statement-not-working/36049015#36049015", "title": "String comparison in if statement not working", "body": "<p>First of all, you can't compare strings like that in C. use <code>strcmp</code> or <code>strncmp</code> instead.</p>\n\n<p>Secondly, in your code, <code>profession</code> is a <code>char</code>, and you want to put a string (several chars) in it. It won't work. You can create a <code>char *</code> (pointer on a <code>char</code>) (without forgetting to <code>malloc()</code> it) or a <code>char []</code> (a char array). </p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 6074139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5662e93016fe9199b3ef9ad436ac1d9e?s=128&d=identicon&r=PG&f=1", "display_name": "Sus", "link": "https://stackoverflow.com/users/6074139/sus"}, "edited": false, "score": 0, "creation_date": 1458175801, "post_id": 36049100, "comment_id": 59747709, "body": "Thank you for the clarification and solution as well"}], "tags": [], "owner": {"reputation": 1, "user_id": 5763323, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153868770177558/picture?type=large", "display_name": "Gracia Rivas Duran", "link": "https://stackoverflow.com/users/5763323/gracia-rivas-duran"}, "is_accepted": false, "score": 0, "last_activity_date": 1458173588, "last_edit_date": 1458173588, "creation_date": 1458171889, "answer_id": 36049100, "question_id": 36048737, "link": "https://stackoverflow.com/questions/36048737/string-comparison-in-if-statement-not-working/36049100#36049100", "title": "String comparison in if statement not working", "body": "<p>Firstly, strings in C are array of characters, so you have to declare profession as a pointer, pointing to an array of characters. So that statement will look like this <code>char* profession</code>, secondly, you have to use a method called <code>strcmp(char* a, char* b)</code> that accepts two char pointers. This will return 0 if they are equal. I will include the answer, but I assume there are better ways of writing this code. </p>\n\n<pre><code>int main() {\n\n    char* profession;\n    char* compare = \"QA\";\n    printf(\"What is your profession?\\n\");\n\n    scanf(\" %s\", profession);\n\n    if(strcmp(profession, compare) == 0) {\n            printf(\"Go and Test\\n\");\n    } else {\n            printf(\"Do whatever you want\");\n    }\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6074139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5662e93016fe9199b3ef9ad436ac1d9e?s=128&d=identicon&r=PG&f=1", "display_name": "Sus", "link": "https://stackoverflow.com/users/6074139/sus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 121, "favorite_count": 0, "closed_date": 1458190651, "answer_count": 2, "score": -1, "last_activity_date": 1458242823, "creation_date": 1458169926, "last_edit_date": 1458242823, "question_id": 36048737, "link": "https://stackoverflow.com/questions/36048737/string-comparison-in-if-statement-not-working", "closed_reason": "Duplicate", "title": "String comparison in if statement not working", "body": "<p>I am new in C programming. Can you please advise, what's wrong with my code? It looks like the <code>if</code> statement is not working, and instead it's jumping and printing the <code>else</code> statement.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main()\n{\n    char profession;\n\n    printf(\"what is your profession? \\n\");\n    scanf(\" %s\", profession);\n\n    if(profession==\u201cQA\u201d)\n    {\n        printf(\u201cGo and Test\\n\u201c);\n    }\n    else\n    {\n        printf(\"Do whatever you want\");\n    }\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "gdb", "arguments"], "answers": [{"comments": [{"owner": {"reputation": 1601, "user_id": 948176, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/75ab604446289ecf5cea2025edb8971c?s=128&d=identicon&r=PG", "display_name": "Matt G", "link": "https://stackoverflow.com/users/948176/matt-g"}, "edited": false, "score": 0, "creation_date": 1458174068, "post_id": 36048861, "comment_id": 59747234, "body": "Since I plan for this program to be invoked from a command line, it would probably be a good idea to change the symbol used to mark that option to something else, eh? Or can I just escape it with a backslash?"}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "reply_to_user": {"reputation": 1601, "user_id": 948176, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/75ab604446289ecf5cea2025edb8971c?s=128&d=identicon&r=PG", "display_name": "Matt G", "link": "https://stackoverflow.com/users/948176/matt-g"}, "edited": false, "score": 0, "creation_date": 1458174806, "post_id": 36048861, "comment_id": 59747419, "body": "Either would work. Or you could quote that symbol: <code>&quot;#&quot;</code>. But personally I would go with using a different symbol - otherwise it&#39;s inevitable that some user of the command will get it wrong."}], "tags": [], "owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "is_accepted": true, "score": 1, "last_activity_date": 1458170604, "creation_date": 1458170604, "answer_id": 36048861, "question_id": 36048683, "link": "https://stackoverflow.com/questions/36048683/gdb-is-miscounting-args-containing/36048861#36048861", "title": "gdb is miscounting args containing &#39;#&#39;", "body": "<p>I assume you are running on Linux. gdb on Linux by default will invoke the shell to start your program. Therefore everything after the <code>#</code> is still being interpreted by the shell as a comment. You can change that behaviour in gdb by telling it not to use the shell to start the program via the <code>set startup-with-shell off</code> command.</p>\n\n<p>Here is an example program that just prints <code>argc</code>.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint main(int argc, char **argv)\n{\n    printf(\"%d\\n\", argc);\n    return 0;\n}\n</code></pre>\n\n<p>And here are the gdb runs with and without the shell receptively.</p>\n\n<pre><code>(gdb) r -b # +L -m\nStarting program: /tmp/a.out -b # +L -m\n2\n[Inferior 1 (process 28385) exited normally]\n(gdb) set startup-with-shell off\n(gdb) r -b # +L -m\nStarting program: /tmp/a.out -b # +L -m\n5\n[Inferior 1 (process 28443) exited normally]\n(gdb) \n</code></pre>\n\n<p>Refer to the <a href=\"https://sourceware.org/gdb/onlinedocs/gdb/Starting.html\" rel=\"nofollow\">gdb manual</a> for more details on program startup.</p>\n"}], "owner": {"reputation": 1601, "user_id": 948176, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/75ab604446289ecf5cea2025edb8971c?s=128&d=identicon&r=PG", "display_name": "Matt G", "link": "https://stackoverflow.com/users/948176/matt-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27, "favorite_count": 0, "accepted_answer_id": 36048861, "answer_count": 1, "score": 1, "last_activity_date": 1458170604, "creation_date": 1458169672, "question_id": 36048683, "link": "https://stackoverflow.com/questions/36048683/gdb-is-miscounting-args-containing", "title": "gdb is miscounting args containing &#39;#&#39;", "body": "<p>I run my program in gdb, withe the arguments <code>-b # +L -m</code>, but when I <code>break main</code>, argc is reported as 2 and the last argument available is <code>\"-b\"</code>. However, using <code>show args</code> in GDB gives me <code>Argument list to give program being debugged when it is started is \"-b # +L -m\"</code>, which is accurate.</p>\n\n<p><code>Starting program: /home/matt/</code>...<code>/args -b # +L -m</code></p>\n\n<p><code>Breakpoint 1, main (argc=2, argv=0x7fffffffe028) at args.c:129</code></p>\n\n<p>Is # treated specially in an argument, even in GDB (not bash)?</p>\n"}, {"tags": ["c", "assembly", "x86-64", "sse", "sse2"], "comments": [{"owner": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 6, "creation_date": 1458170101, "post_id": 36048502, "comment_id": 59745902, "body": "In 64 bit mode the calling convention already mandates SSE registers for floating point arguments and return values. Since the SSE registers are not organized as a stack, and there are more of them, it&#39;s easier for the compiler to utilize. There are scalar SSE instructions. Also, it&#39;s funny you are concerned about wasting half of the space in them - if you don&#39;t use them at all, <i>all</i> of them go to waste ;)"}, {"owner": {"reputation": 35113, "user_id": 3826372, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P0peM.png?s=128&g=1", "display_name": "Ross Ridge", "link": "https://stackoverflow.com/users/3826372/ross-ridge"}, "edited": false, "score": 1, "creation_date": 1458170783, "post_id": 36048502, "comment_id": 59746167, "body": "There are no 64-bit floating pointer registers. There&#39;s just the 80-bit floating point stack and the XMM registers. The MOVSD instruction is a scalar instruction, not a vector instruction so its use doesn&#39;t imply automatic vectorization."}, {"owner": {"reputation": 35113, "user_id": 3826372, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P0peM.png?s=128&g=1", "display_name": "Ross Ridge", "link": "https://stackoverflow.com/users/3826372/ross-ridge"}, "edited": false, "score": 1, "creation_date": 1458171424, "post_id": 36048502, "comment_id": 59746394, "body": "Those aren&#39;t floating point registers."}, {"owner": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 0, "creation_date": 1458172281, "post_id": 36048502, "comment_id": 59746666, "body": "The <code>_pd</code> stores 2 doubles (128 bits) but the <code>_sd</code> only 1 double (64 bits)."}, {"owner": {"reputation": 35113, "user_id": 3826372, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P0peM.png?s=128&g=1", "display_name": "Ross Ridge", "link": "https://stackoverflow.com/users/3826372/ross-ridge"}, "edited": false, "score": 1, "creation_date": 1458172406, "post_id": 36048502, "comment_id": 59746714, "body": "Because using a general purpose register to store a floating-point value means that compiler would have to generate additional instructions to move the value into a floating point register (either the 80-bit floating point stack or an XMM register) before performing a floating point operation on that value."}, {"owner": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 1, "creation_date": 1458172645, "post_id": 36048502, "comment_id": 59746801, "body": "No idea what you are asking. You have asked it 3 times with 3 different sets of names..."}, {"owner": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 2, "creation_date": 1458173110, "post_id": 36048502, "comment_id": 59746962, "body": "Okay, <code>_mm_storel_pd</code> generates <code>MOVLPD</code> instruction, while <code>_mm_store_sd</code> produces <code>MOVSD</code>. When writing to memory, they have equivalent functionality. At least I can&#39;t spot the difference."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 2, "creation_date": 1458181519, "post_id": 36048502, "comment_id": 59749434, "body": "@Jester: AFAICT, the only reason <code>movlpd</code> and <code>movsd</code> both exist is consistency/regularity of the encodings: <code>movlps</code> is different from <code>movss</code>, so both those instructions already existed.  SSE2 uses the same opcode with different escape bytes for the <code>double</code> instead of <code>single</code> version.  (<code>movlpd</code> is already just a waste of instruction bytes compared to <code>movlps</code> on every CPU, since AFAIK no CPUs care about single vs. double versions of any data-movement insns.  Intel has persistently kept that option open by always making single vs. double versions, up until <code>vextractf128</code> and stuff)"}, {"owner": {"reputation": 29002, "user_id": 2542702, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fW5ka.jpg?s=128&g=1", "display_name": "Z boson", "link": "https://stackoverflow.com/users/2542702/z-boson"}, "edited": false, "score": 0, "creation_date": 1458571541, "post_id": 36048502, "comment_id": 59906760, "body": "I don&#39;t think your question should have been down-voted just because of your ignorance."}], "answers": [{"comments": [{"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1458525079, "post_id": 36121889, "comment_id": 59884068, "body": "gcc targeting 32bit x86 defaults to making code that can run on any x86 CPU as far back as i686 (PPro).  Use <code>-march=native</code> if you want it to target the current host&#39;s instruction-set extensions.  Also, the 32bit ABI is defined to return FP args on the x87 stack.  See the <a href=\"http://stackoverflow.com/tags/x86/info\">x86 tag wiki info page</a> for ABI docs."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1458525640, "post_id": 36121889, "comment_id": 59884173, "body": "Most 3-operand AVX instructions just have a separate destination that isn&#39;t one of the sources.  FMA is the major exception: it still does destroy one of its operands, like an SSE instruction.  (Intel changed their mind at the last minute from FMA4 to FMA3, but didn&#39;t tell AMD, so AMD Bulldozer supports 4-operand FMA4 but not Intel-style FMA3).  Also, SSE has a some 3-operand instruction: <code>pblendvb</code> uses <code>xmm0</code> as an implicit 4th operand.  So Intel could have implemented FMA without AVX, and FMA is a bad example of how AVX reduces the need for <code>mov</code> instructions."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1458525919, "post_id": 36121889, "comment_id": 59884222, "body": "Other than that, this answer appears correct from my quick skim over most of it.  IDK how useful it will be to other beginners, since it looks a bit long and rambling.  IIRC, a lot of the history of x86 insn set extensions is already in the <a href=\"http://stackoverflow.com/tags/sse/info\">SSE tag wiki page</a>, which I tidied up several months ago."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1458531630, "post_id": 36121889, "comment_id": 59885419, "body": "I didn&#39;t find out that the tag-wiki pages often had good links for a long time, either.  It&#39;s not a well-advertised feature that the site itself points out to people, so I usually link to the x86 tag wiki on almost every newbie question I comment on or answer.  re: <code>load1_pd</code>: With SSE3, the <a href=\"https://goo.gl/8JmuCM\" rel=\"nofollow noreferrer\">broadcast-load only takes a single instruction (<code>movddup</code>)</a>, which is as cheap as a regular load on Nehalem and later.  On Core2, that insn also uses the ALU, and can&#39;t micro-fuse.  See the code on godbolt: without SSE3, it&#39;s a load &amp; shuffle separately, thus slower even on Skylake."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1458533920, "post_id": 36121889, "comment_id": 59885927, "body": "ok.  It looks like you&#39;re mixing up 3-operand AVX instructions in general with stuff that&#39;s specific to FMA.  re: <code>load1_sse3</code>: of course you didn&#39;t find it in the intrinsics guide: it&#39;s a function I wrote to demonstrate how <code>_mm_load1_pd</code> compiled with <code>-msse3</code>.  There&#39;s no reason to change your code from using <code>_mm_load1_pd</code> to <code>_mm_loaddup_pd</code> intrinsics unless you want to make sure you get a compile error if you try to compile it without <code>-msse3</code>.  That&#39;s what my godbolt link was demonstrating.  (use backticks to get code-formatting in comments, not single quotes)."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1458534690, "post_id": 36121889, "comment_id": 59886145, "body": "Right, don&#39;t use the composite intrinsics unless there&#39;s no way to do what you need with one instruction.  Just use <code>_mm_load1_pd</code>.  As my godbolt link proves, it compiles to ideal code (<code>movddup</code>) with <code>-msse3</code>.  It&#39;s a good idea to have a look over the asm output for important loops, to make sure the compiler didn&#39;t make a mess."}], "tags": [], "owner": {"reputation": 58770, "user_id": 4891738, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/kE2lh.jpg?s=128&g=1", "display_name": "\u674e\u54f2\u6e90", "link": "https://stackoverflow.com/users/4891738/%e6%9d%8e%e5%93%b2%e6%ba%90"}, "is_accepted": true, "score": 4, "last_activity_date": 1458524548, "last_edit_date": 1495540922, "creation_date": 1458524548, "answer_id": 36121889, "question_id": 36048502, "link": "https://stackoverflow.com/questions/36048502/sse-instruction-movsd-extended-floating-point-scalar-vector-operations-on-x8/36121889#36121889", "title": "SSE instruction MOVSD (extended: floating point scalar &amp; vector operations on x86, x86-64)", "body": "<p><strong>A review of floating point scalar/vector processing on modern CPUs</strong></p>\n\n<p>The idea of vector processing dates back to old time <a href=\"https://en.wikipedia.org/wiki/Vector_processor\" rel=\"nofollow noreferrer\">vector processors</a>, but these processors had been superseded by modern architectures with cache systems. So we focus on modern CPUs, especially <a href=\"https://en.wikipedia.org/wiki/X86\" rel=\"nofollow noreferrer\">x86</a> and <a href=\"https://en.wikipedia.org/wiki/X86-64\" rel=\"nofollow noreferrer\">x86-64</a>. These architectures are the <a href=\"https://en.wikipedia.org/wiki/TOP500#Architecture_and_operating_systems\" rel=\"nofollow noreferrer\">main stream in high performance scientific computing</a>.</p>\n\n<p>Since i386, Intel introduced the floating point stack where floating point numbers up to 80-bit wide can be held. This stack is commonly known as <a href=\"https://en.wikipedia.org/wiki/X87\" rel=\"nofollow noreferrer\">x87 or 387 floating point \"registers\"</a>, with a set of <a href=\"http://home.agh.edu.pl/~amrozek/x87.pdf\" rel=\"nofollow noreferrer\">x87 FPU instructions</a>. x87 stack are not real, directly addressable registers like general purpose registers, as they are on a stack. Access to register st(i) is by offsetting the stack top register %st(0) or simply %st. With help of an instruction FXCH which swaps the contents between current stack top %st and some offset register %st(i), random access can be achieved. But FXCH can impose some performance penalty, though minimized. x87 stack provides high precision computation by calculating intermediate results with 80 bits of precision by default, to minimise roundoff error in numerically unstable algorithms. However, x87 instructions are completely scalar.</p>\n\n<p>The first effort on vectorization is the <a href=\"https://en.wikipedia.org/wiki/MMX_%28instruction_set%29\" rel=\"nofollow noreferrer\">MMX instruction set</a>, which implemented <strong>integer</strong> vector operations. The vector registers under MMX are 64-bit wide registers MMX0, MMX1, ..., MMX7. Each can be used to hold either 64-bit integers, or multiple smaller integers in a \"packed\" format. A single instruction can then be applied to two 32-bit integers, four 16-bit integers, or eight 8-bit integers at once. So now there are the legacy general purpose registers for scalar integer operations, as well as new MMX for integer vector operations with no shared execution resources. But MMX shared execution resources with scalar x87 FPU operation: each MMX register corresponded to the lower 64 bits of an x87 register, and the upper 16 bits of the x87 registers is unused. These MMX registers were each directly addressable. But the aliasing made it difficult to work with floating point and integer vector operations in the same application. To maximize performance, programmers often used the processor exclusively in one mode or the other, deferring the relatively slow switch between them as long as possible.</p>\n\n<p>Later, <a href=\"https://en.wikipedia.org/wiki/Streaming_SIMD_Extensions\" rel=\"nofollow noreferrer\">SSE</a> created a separate set of 128-bit wide registers XMM0\u2013XMM7 along side of x87 stack. SSE instructions focused <strong>exclusively</strong> on single-precision floating-point operations (32-bit); integer vector operations were still performed using the MMX register and MMX instruction set. But now both operations can proceed at the same time, as they share no execution resources. <strong>It is important to know that SSE not only do floating point vector operations, but also floating point scalar operations. Essentially it provides a new place where floating operations take place, and the x87 stack is no longer prior choice to carry out floating operations. Using XMM registers for scalar floating point operations is faster than using x87 stack, as all XMM registers are easier to access, while the x87 stack can't be randomly accessed without FXCH.</strong> When I posted my question, I was clearly unaware of this fact. The other concept I was not clear about is that general purpose registers are integer/address registers. Even if they are 64-bit on x86-64, they can not hold 64-bit floating point. The main reason is that the execution unit associated with general purpose registers is ALU (arithmetic &amp; logical unit), which is not for floating point computation.</p>\n\n<p><a href=\"https://en.wikipedia.org/wiki/SSE2\" rel=\"nofollow noreferrer\">SSE2</a> is a major progress, as it extends vector data type, so SSE2 instructions, either scalar or vector, can work with all C standard data type. Such extension in fact makes MMX obsolete. Also, x87 stack is no long as important as it once was. Since there are two alternative places where floating point operations can take place, you can specify your option to the compiler. For example for GCC, compilation with flag</p>\n\n<pre><code>-mfpmath=387\n</code></pre>\n\n<p>will schedule floating point operations on the legacy x87 stack. <strong>Note that this seems to be the default for 32-bit x86, even if SSE is already available.</strong> For example, I have an Intel Core2Duo laptop made in 2007, and it was already equipped with SSE release up to version SSE4, while GCC will still by default use x87 stack, which makes scientific computations unnecessarily slower. In this case, we need compile with flag</p>\n\n<pre><code>-mfpmath=sse\n</code></pre>\n\n<p>and GCC will schedule floating point operations on XMM registers. 64-bit x86-64 user needs not worry about such configuration as this is default on x86-64. Such signal will only affect scalar floating point operation. If we have written code using vector instructions and compiler the code with flag</p>\n\n<pre><code>-msse2\n</code></pre>\n\n<p>then XMM registers will be the only place where computation can take place. In other words, this flags turns on -mfpmath=sse. For more information see <a href=\"https://gcc.gnu.org/onlinedocs/gcc-4.5.3/gcc/i386-and-x86_002d64-Options.html\" rel=\"nofollow noreferrer\">GCC's configuration of x86, x86-64</a>. For examples of writing SSE2 C code, see my other post <a href=\"https://stackoverflow.com/questions/36110591/how-to-ask-gcc-to-completely-unroll-this-loop-i-e-peel-this-loop\">How to ask GCC to completely unroll this loop (i.e., peel this loop)?</a>.</p>\n\n<p>SSE set of instructions, though very useful, are not the latest vector extensions. The AVX, <a href=\"https://en.wikipedia.org/wiki/Advanced_Vector_Extensions\" rel=\"nofollow noreferrer\">advanced vector extensions</a> enhances SSE by providing 3-operands and 4 operands instructions. See <a href=\"https://en.wikipedia.org/wiki/Instruction_set#Number_of_operands\" rel=\"nofollow noreferrer\">number of operands in instruction set</a> if you are unclear of what this means. 3-operands instruction optimizes the commonly seen <a href=\"https://en.wikipedia.org/wiki/Multiply%E2%80%93accumulate_operation\" rel=\"nofollow noreferrer\">fused multiply-add (FMA)</a> operation in scientific computing by 1) using 1 fewer register; 2) reducing the explicit amount of data movement between registers; 3) speeding up FMA computations in itself. For example of using AVX, see <a href=\"https://stackoverflow.com/a/36114098/4891738\">@Nominal Animal's answer to my post</a>.</p>\n"}], "owner": {"reputation": 58770, "user_id": 4891738, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/kE2lh.jpg?s=128&g=1", "display_name": "\u674e\u54f2\u6e90", "link": "https://stackoverflow.com/users/4891738/%e6%9d%8e%e5%93%b2%e6%ba%90"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4822, "favorite_count": 1, "accepted_answer_id": 36121889, "answer_count": 1, "score": 1, "last_activity_date": 1458524662, "creation_date": 1458168772, "last_edit_date": 1495539983, "question_id": 36048502, "link": "https://stackoverflow.com/questions/36048502/sse-instruction-movsd-extended-floating-point-scalar-vector-operations-on-x8", "title": "SSE instruction MOVSD (extended: floating point scalar &amp; vector operations on x86, x86-64)", "body": "<p>I am somehow confused by the MOVSD assembly instruction. I wrote some numerical code computing some matrix multiplication, simply using ordinary C code with no SSE intrinsics. I do not even include the header file for SSE2 intrinsics  for compilation. But when I check the assembler output, I see that:</p>\n\n<p>1) 128-bit vector registers XMM are used;\n2) SSE2 instruction MOVSD is invoked.</p>\n\n<p>I understand that MOVSD essentially operates on single double precision floating point. It only uses the lower 64-bit of an XMM register and set the upper 64-bit 0. But I just don't understand two things:</p>\n\n<p>1) I never give the compiler any hint for using SSE2. Plus, I am using GCC not intel compiler. As far as I know, intel compiler will automatically seek opportunities for vectorization, but GCC will not. So how does GCC know to use MOVSD?? Or, has this x86 instruction been around long before SSE instruction set, and the _mm_load_sd() intrinsics in SSE2 is just to provide backward compatibility for using XMM registers for scalar computation?</p>\n\n<p>2) Why does not the compiler use other floating point registers, either the 80-bit floating point stack, or 64-bit floating point registers?? Why must it take the toll using XMM register (by setting upper 64-bit 0 and essentially wasting that storage)? Does XMM do provide faster access??</p>\n\n<hr>\n\n<p>By the way, I have another question regarding SSE2. I just can't see the difference between _mm_store_sd() and _mm_storel_sd(). Both store the lower 64-bit value to an address. What is the difference? Performance difference?? Alignment difference??</p>\n\n<p>Thank you.</p>\n\n<hr>\n\n<p><strong>Update 1:</strong></p>\n\n<p>OKAY, obviously when I first asked this question, I lacked some basic knowledge on how a CPU manages floating point operations. So experts tend to think my question is non-sense. Since I did not include even the shortest sample C code, people might think this question vague as well. Here I would provide <a href=\"https://stackoverflow.com/a/36121889/4891738\">a review</a> as an answer, which hopefully will be useful to any people unclear about the floating point operations on modern CPUs.</p>\n"}, {"tags": ["c", "fgets"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 7, "creation_date": 1458168966, "post_id": 36048488, "comment_id": 59745479, "body": "Maybe the book was originally written to use <code>gets()</code> which did omit the newline (but see <a href=\"http://stackoverflow.com/questions/1694036/why-is-the-gets-function-dangerous-why-should-it-not-be-used\">Why the <code>gets()</code> function is too dangerous to use</a>), and they didn&#39;t recheck.  Yes, <code>fgets()</code> preserves the newline and since the code doesn&#39;t clean up (erase) the newline, it is broken, despite anything that they said."}, {"owner": {"reputation": 969, "user_id": 1195463, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/bb890f96dd8321ac00db3c38e176495b?s=128&d=identicon&r=PG", "display_name": "Buzu", "link": "https://stackoverflow.com/users/1195463/buzu"}, "edited": false, "score": 0, "creation_date": 1458169141, "post_id": 36048488, "comment_id": 59745554, "body": "Thanks guys. The book actaully says:  &quot;Even though fgets() is seen as a safer-to-use function than scanf(), the truth is that the older gets() function is far more dangerous than either of them. The reason? The gets() function has no limits at all:&quot;  So, I don&#39;t think they intended to use gets."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 3, "creation_date": 1458169399, "post_id": 36048488, "comment_id": 59745645, "body": "Not using the <code>const</code> qualifier for arguments not changed makes one wonder about the quality of that book."}, {"owner": {"reputation": 969, "user_id": 1195463, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/bb890f96dd8321ac00db3c38e176495b?s=128&d=identicon&r=PG", "display_name": "Buzu", "link": "https://stackoverflow.com/users/1195463/buzu"}, "edited": false, "score": 0, "creation_date": 1458169738, "post_id": 36048488, "comment_id": 59745771, "body": "I&#39;ve found the book very informative, and easy to follow. Not being experienced in C, I can&#39;t defend the quality of the book, but being the 2.5 chapter of an introductory book, I can guess they don&#39;t want to overwhelm the reader. Thanks for the tip, however. It is very welcomed."}, {"owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "edited": false, "score": 1, "creation_date": 1458172734, "post_id": 36048488, "comment_id": 59746834, "body": "<a href=\"https://ideone.com/MIttBH\" rel=\"nofollow noreferrer\">This program works</a> when the input doesn&#39;t contain any newline character."}, {"owner": {"reputation": 969, "user_id": 1195463, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/bb890f96dd8321ac00db3c38e176495b?s=128&d=identicon&r=PG", "display_name": "Buzu", "link": "https://stackoverflow.com/users/1195463/buzu"}, "reply_to_user": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "edited": false, "score": 0, "creation_date": 1458182025, "post_id": 36048488, "comment_id": 59749583, "body": "@MikeCAT, the function docs says it reads up to and including a newline character. From that, I understand that for any practical uses, the input has to have a newline character. Also, in the console, you have to press enter in order for the program to continue. Is there any way to let the program continue when using stdin without pressing enter?"}, {"owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "edited": false, "score": 1, "creation_date": 1458182166, "post_id": 36048488, "comment_id": 59749636, "body": "<code>echo -n &quot;your input&quot; | .&#47;a.out</code> Where <code>echo</code> is a command line tool that print the command line arguments to stdout and supports <code>-n</code> option that mean not to print newline character after printing the arguments, and <code>a.out</code> is your compiled program (executable binary)."}, {"owner": {"reputation": 969, "user_id": 1195463, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/bb890f96dd8321ac00db3c38e176495b?s=128&d=identicon&r=PG", "display_name": "Buzu", "link": "https://stackoverflow.com/users/1195463/buzu"}, "edited": false, "score": 0, "creation_date": 1458182751, "post_id": 36048488, "comment_id": 59749810, "body": "Man, that smart lol... I find it funny, though. I see you sitting there thinking &quot;This sh*t works because I say so&quot;. I would just upvote your comment to infinity, but I can&#39;t. However, I don&#39;t think this book expected people to do that, I think the code is faulty. Nice pipe usage there by the way."}], "answers": [{"comments": [{"owner": {"reputation": 75, "user_id": 7360004, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22e6f9f514723174cfb008ef5ec6c126?s=128&d=identicon&r=PG&f=1", "display_name": "Ghoster", "link": "https://stackoverflow.com/users/7360004/ghoster"}, "edited": false, "score": 0, "creation_date": 1486959819, "post_id": 42188923, "comment_id": 71555251, "body": "Thank you who I don&#39;t know for your modification."}], "tags": [], "owner": {"reputation": 75, "user_id": 7360004, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22e6f9f514723174cfb008ef5ec6c126?s=128&d=identicon&r=PG&f=1", "display_name": "Ghoster", "link": "https://stackoverflow.com/users/7360004/ghoster"}, "is_accepted": false, "score": 4, "last_activity_date": 1486912613, "last_edit_date": 1486912613, "creation_date": 1486910445, "answer_id": 42188923, "question_id": 36048488, "link": "https://stackoverflow.com/questions/36048488/book-mistake-head-first-c/42188923#42188923", "title": "Book mistake? (Head first C)", "body": "<p>I also encountered the error, but the newest version has corrected the error. In fact, the function <code>'char *fgets(char *s, int size, FILE *stream)</code> works like what you said. It only read up to <code>size-1</code>. If it encounters a <em>null</em> character('\\0'), it only add ('\\0') to the buffer. So when we used the fuction <code>find_track()</code>, we can't get anything because of <code>search_for</code> has contained ('\\0'). There are some solutions to handle it.</p>\n\n<ul>\n<li><code>scanf\uff08\"%79s\", search_for)</code>. Attention, don't only use <code>%s</code> because you wil encounter the same situation like <code>fgets()</code>.</li>\n<li><code>scanf(\"%79[^\\n]\", search_for)</code>, it has some difference with the former one. The advantage that you can avoid the blank problem.</li>\n</ul>\n\n<p>PS: The first one, you can add a new fuction to avoid the blank problem. Like this:</p>\n\n<pre><code>void remove_tail_newline(search_for)\n{ size_t len = strlen(str);\n   if(len &gt; 0 &amp;&amp;str[len-1] =='\\n') str[len -1] ='\\0';\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 969, "user_id": 1195463, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/bb890f96dd8321ac00db3c38e176495b?s=128&d=identicon&r=PG", "display_name": "Buzu", "link": "https://stackoverflow.com/users/1195463/buzu"}, "edited": false, "score": 0, "creation_date": 1487086829, "post_id": 42191878, "comment_id": 71620032, "body": "Thanks! I will consider this advise in future C adventures."}], "tags": [], "owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "is_accepted": false, "score": 3, "last_activity_date": 1486926041, "creation_date": 1486926041, "answer_id": 42191878, "question_id": 36048488, "link": "https://stackoverflow.com/questions/36048488/book-mistake-head-first-c/42191878#42191878", "title": "Book mistake? (Head first C)", "body": "<p>You're right; this is indeed an error in the book.</p>\n\n<p>I recommend against using <code>scanf</code> for user input. It is hard to use correctly, error detection is non-trivial (if it is possible at all), and error recovery is impossible.</p>\n\n<p>All user input should be done by reading a line first, then analyzing it afterwards (e.g. using <code>strtol</code> or <code>sscanf</code>). Reading a line can be done with <code>fgets</code>, but unfortunately there's no syntax or feature for ignoring the <code>\\n</code>.</p>\n\n<p>What you can do instead is:</p>\n\n<pre><code>if (fgets(line, sizeof line, stdin)) {\n    line[strcspn(line, \"\\n\")] = '\\0';  // remove trailing '\\n', if any\n    do_stuff_with(line);\n}\n</code></pre>\n"}], "owner": {"reputation": 969, "user_id": 1195463, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/bb890f96dd8321ac00db3c38e176495b?s=128&d=identicon&r=PG", "display_name": "Buzu", "link": "https://stackoverflow.com/users/1195463/buzu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 233, "favorite_count": 0, "answer_count": 2, "score": 4, "last_activity_date": 1486926041, "creation_date": 1458168719, "question_id": 36048488, "link": "https://stackoverflow.com/questions/36048488/book-mistake-head-first-c", "title": "Book mistake? (Head first C)", "body": "<p>In the book Head First C, fist edition, there is this progam:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nchar tracks[][80] = {\n    \"I left my hearth in Harvard Med School\",\n    \"Newark, NewarK - a wonderful town\",\n    \"Dancing with a  Dork\",\n    \"From here to maternity\",\n    \"The girl from Iwo Jima\",\n};\n\nvoid find_track(char search_for[]) {\n    int i;\n\n    for(i = 0; i &lt; 5; i++) {\n        if (strstr(tracks[i], search_for)) {\n            printf(\"Track %i: '%s'\\n\", i, tracks[i]);\n        }\n    }\n}\n\nint main() {\n    char search_for[80];\n    printf(\"Search for: \");\n    fgets(search_for, 80, stdin);\n    find_track(search_for);\n    return 0;\n}\n</code></pre>\n\n<p>However, when compiled and tested, you don't get the expected results. After breaking my head for a bit, I decided to look for the documentation for fgets, I discovered that the function reads up to an including a newline character, which is why no matter what I search for, I never get the expected result. However, in the book they say the program works when tested. Is this a book error, or am I missing something?</p>\n\n<p>PS. the error can be easily fixed using scanf, which becomes obvious once you know why the program doesn't work as expected.</p>\n\n<p>PS2. I remember C++ has some syntax to ignore the newline character. Does C have something similar?</p>\n"}, {"tags": ["c", "variables", "input", "scanf", "largenumber"], "comments": [{"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 1, "creation_date": 1458168166, "post_id": 36048235, "comment_id": 59745144, "body": "Please fix up your code indentation and general formatting so that it is readable. Not just for our sake but for your own. Here are some errors which should get you past your current problem. But there are plenty more problems. 1. typo: <code>scanf(&quot;&#47;n%c&quot;, &amp;gametype);</code> should be <code>scanf(&quot;\\n%c&quot;, &amp;gametype);</code> 2. Missing a <code>while</code> before <code>(y_n != &#39;n&#39; &amp;&amp; y_n != &#39;N&#39;);</code> (not sure how you even got that to compile)."}, {"owner": {"reputation": 1, "user_id": 6073689, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-LSnXm8NbWFU/AAAAAAAAAAI/AAAAAAAABhI/VHHOuGflqZI/photo.jpg?sz=128", "display_name": "Mariam Zaidi", "link": "https://stackoverflow.com/users/6073689/mariam-zaidi"}, "reply_to_user": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1458168871, "post_id": 36048235, "comment_id": 59745439, "body": "You are right, I apologize. This is my first time using Stack Overflow and so my format changed accidentally. I&#39;m going through and fixing it."}, {"owner": {"reputation": 1, "user_id": 6073689, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-LSnXm8NbWFU/AAAAAAAAAAI/AAAAAAAABhI/VHHOuGflqZI/photo.jpg?sz=128", "display_name": "Mariam Zaidi", "link": "https://stackoverflow.com/users/6073689/mariam-zaidi"}, "reply_to_user": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1458175185, "post_id": 36048235, "comment_id": 59747519, "body": "Do you know what could be going wrong @kaylum ?"}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1458175243, "post_id": 36048235, "comment_id": 59747539, "body": "Did you fix those two things up that were pointed out? And if so, what was the behaviour of the program after that?"}, {"owner": {"reputation": 1, "user_id": 6073689, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-LSnXm8NbWFU/AAAAAAAAAAI/AAAAAAAABhI/VHHOuGflqZI/photo.jpg?sz=128", "display_name": "Mariam Zaidi", "link": "https://stackoverflow.com/users/6073689/mariam-zaidi"}, "reply_to_user": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1458178000, "post_id": 36048235, "comment_id": 59748413, "body": "Yes, I fixed them! In order to see what the bet amount in coming out to be, I printed it out.Your current bank balance is 100. Enter the amount you want to bet:  Bet amount: -1220093680 You dont have that much money or you placed a bet less than the minimum. Please place a proper bet. You current bank roll is: 1220093780"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6073689, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-LSnXm8NbWFU/AAAAAAAAAAI/AAAAAAAABhI/VHHOuGflqZI/photo.jpg?sz=128", "display_name": "Mariam Zaidi", "link": "https://stackoverflow.com/users/6073689/mariam-zaidi"}, "edited": false, "score": 0, "creation_date": 1458170356, "post_id": 36048463, "comment_id": 59746020, "body": "I compiled the reformatted code and I am still getting a really large number for the bet amount.Your current bank balance is 100. Enter the amount you want to bet: Bet amount: -1220069104 You dont have that much money or you placed a bet less than the minimum. Please place a proper bet.Final amount is 1220069204. Your current balance is -1075269652 1220069204"}, {"owner": {"reputation": 1, "user_id": 6073689, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-LSnXm8NbWFU/AAAAAAAAAAI/AAAAAAAABhI/VHHOuGflqZI/photo.jpg?sz=128", "display_name": "Mariam Zaidi", "link": "https://stackoverflow.com/users/6073689/mariam-zaidi"}, "edited": false, "score": 0, "creation_date": 1458178198, "post_id": 36048463, "comment_id": 59748476, "body": "any ideas on what it could be @StardustGogeta"}, {"owner": {"reputation": 1, "user_id": 6073689, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-LSnXm8NbWFU/AAAAAAAAAAI/AAAAAAAABhI/VHHOuGflqZI/photo.jpg?sz=128", "display_name": "Mariam Zaidi", "link": "https://stackoverflow.com/users/6073689/mariam-zaidi"}, "edited": false, "score": 0, "creation_date": 1458178827, "post_id": 36048463, "comment_id": 59748650, "body": "Ok will do! Thanks for the suggestion"}, {"owner": {"reputation": 1, "user_id": 6073689, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-LSnXm8NbWFU/AAAAAAAAAAI/AAAAAAAABhI/VHHOuGflqZI/photo.jpg?sz=128", "display_name": "Mariam Zaidi", "link": "https://stackoverflow.com/users/6073689/mariam-zaidi"}, "edited": false, "score": 0, "creation_date": 1458185029, "post_id": 36048463, "comment_id": 59750341, "body": "I recoded everything and it works now. I think you were right about the buffer overflow. Thank you so much for your help!"}], "tags": [], "owner": {"reputation": 2616, "user_id": 5732397, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-mmdpdkr_pcc/AAAAAAAAAAI/AAAAAAAAC08/NKvQ733ixGo/photo.jpg?sz=128", "display_name": "StardustGogeta", "link": "https://stackoverflow.com/users/5732397/stardustgogeta"}, "is_accepted": false, "score": -1, "last_activity_date": 1458424586, "last_edit_date": 1458424586, "creation_date": 1458168646, "answer_id": 36048463, "question_id": 36048235, "link": "https://stackoverflow.com/questions/36048235/craps-game-scanf-automatically-input-huge-number/36048463#36048463", "title": "Craps game - scanf automatically input huge number", "body": "<p>Your formatting needs a lot of fixing to understand. However, the real issue is a buffer overflow, caused by not allocating enough memory to the <code>char</code>. Instead, I would suggest using simple <code>int</code> values like 0 and 1 to determine the player's choices.</p>\n"}], "owner": {"reputation": 1, "user_id": 6073689, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-LSnXm8NbWFU/AAAAAAAAAAI/AAAAAAAABhI/VHHOuGflqZI/photo.jpg?sz=128", "display_name": "Mariam Zaidi", "link": "https://stackoverflow.com/users/6073689/mariam-zaidi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 158, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1458424586, "creation_date": 1458167568, "last_edit_date": 1458178161, "question_id": 36048235, "link": "https://stackoverflow.com/questions/36048235/craps-game-scanf-automatically-input-huge-number", "title": "Craps game - scanf automatically input huge number", "body": "<p>The instructions for the part of the project I am having trouble with are:</p>\n\n<p>\"Playing\" the game:\nA second function playing() will be used to play a single game of craps until the player either wins or loses a bet, based upon the rules given above.  This function should be modify the current $ amount of the player's bank roll according to the game result, modify the array values of the player won or lost, and whether the player bet for or against him/herself.  Within the function, the player is asked whether s/he would like to place a bet. If so, the player must choose whether to bet \"for\" or \"against\" him/herself (see game rules above).  The player then \"rolls the dice\" (simulated by a call to the dice-rolling function rolling()).  This should be done interactively (via a key press from the player), rather than simply having the program continuously roll the dice until the game is over. After each roll, this function should report the two random dice values and the sum of the two. If, after the first roll, the game is not over, the player should be asked whether s/he would like to double the amount of the bet. When a roll causes the end of a game, the player is notified whether s/he won or lost money in that game overall, and the amount won or lost.  In all other cases, the player is notified that s/he needs to roll again. </p>\n\n<p><strong>I have to code in a craps game that asks user for a bet amount and then they play craps. They have an initial bank roll of $100. I have to scan a bet amount in using scanf but it keeps making my bet amount very large without any user input. Can someone please help me, I have this project due tonight.</strong> </p>\n\n<pre><code>#include &lt;stdio.h&gt;      /* printf, NULL */\n#include &lt;stdlib.h&gt;     /* srand, rand */\n#include &lt;time.h&gt;       \n\n\n//function prototype\nint rolling(void);\nint playing(int c_amt);//inital money $100, min bet of $5, no max except money     you have\nvoid beginning(void);\nvoid ending(void);\n\nint\nmain()\n{\nprintf(\"\\nWelcome to Craps! Get ready to play!\");\nint bank_amt = 100;\nchar y_n = 'n';\n\ndo\n{\n  bank_amt = playing(bank_amt);\n\n  if(bank_amt == 0)\n    {\n       printf(\"\\nYou bet and lost all your money! You can't play anymore.  Goodbye!\");\n       exit(0);\n    }\n  if(bank_amt != 0)\n    {\n      printf(\"\\nYour current balance is %d %d\", &amp;bank_amt, bank_amt);\n      printf(\"\\nDo you want to play again? (y/n): \");\n      scanf(\"\\n%c\", &amp;y_n);\n    }\n }\n while(y_n != 'n' &amp;&amp; y_n != 'N');\n\n }\n\n\nint\nrolling(void)\n{\n  int dice1, dice2;\n  char roll;\n  srand((int)(time(NULL))); // \"Seed\" random number gen. with system time\n\n  printf(\"\\nPress enter to roll the dice!\");\n  fflush(stdin);\n  scanf(\"%c\",&amp;roll);\n  dice1 = 1+rand()%6; // random num from 1-6\n  dice2 = 1+rand()%6; // random num from 1-6\n\n  return dice1+dice2;\n}\n\n\n  int\n  playing(int c_amt)\n  {\n    char gametype, y_n = 'n';\n    int total, point, for_u, against_u, winlose, win = 0, lose = 0;\n    int moneychange, bet_amt, final_amt;\n\n    printf(\"\\nPlease press 'f' if you are betting for yourself and 'a' if your are betting against yourself.\\n\");\n    scanf(\"\\n%c\", &amp;gametype);\n\n  do\n   {\n     printf(\"\\nYour current bank balance is %d.\", c_amt);\n     printf(\"\\nEnter the amount you want to bet: \");\n     scanf(\" %d\", &amp;bet_amt);\n     printf(\"Bet amount: %d\", bet_amt);\n\n     if(bet_amt &gt; c_amt || bet_amt &lt; 5)\n   {\n        printf(\"\\nYou dont have that much money or you placed a bet less than the minimum. Please place a proper bet.\");\n   }\n\n   }\n  while(bet_amt &gt; c_amt);\n\n    if (gametype == 'f' || gametype == 'F')\n    {\n      for_u++;\n      printf(\"\\nYou are betting for yourself!\\nLets get started!\");\n      total = rolling();\n      printf(\"\\nThe value rolled is %d.\", total);\n      if (total == 7 || total == 11)\n      {\n        printf(\"\\nGood job! You win :)\");\n        winlose = 1;\n      }\n      else if (total == 2 || total == 3 || total == 12)\n      {\n        printf(\"\\nCraps, you lose.\");\n        winlose = 0;\n      }\n    else\n    {\n      point = total;\n      printf(\"\\nYour point is %d.\", point);\n      if(bet_amt*2 &lt;= c_amt)\n        {\n          printf(\"\\nWould you like to double your bet? (y/n)\");\n          scanf(\"\\n%c\", &amp;y_n);\n        }\n          if(y_n == 'y' || y_n == 'Y')\n          {\n            bet_amt = bet_amt*2;\n          }\n\n      do\n      {\n          total = rolling();\n          if(total == point)\n            {\n              printf(\"\\nGood job! You win! :)\");\n              winlose = 1;\n              break;\n            }\n\n      }\n      while(total != 7);\n\n     if(total == 7)\n      {\n      printf(\"You rolled a seven. You lose! :(\");\n      winlose = 0;\n      }\n    }\n   }\n\n  else if (gametype == 'a' || gametype == 'A')\n   {\n    against_u++;\n    printf(\"You are betting against yourself!\\nLet\\'s get started!\");\n    total = rolling();\n    printf(\"\\nThe value rolled is %d.\", total);\n    if (total == 2 || total == 3 || total == 12\n        {\n        printf(\"Good job! You win :)\\n\");\n        }\n    else if (total == 7 || total == 11)\n        {\n        printf(\"Craps, you lose.\\n\");\n        }\n    else\n        {\n        point = total;\n        printf(\"Your point is %d.\\n\", point);\n        if(bet_amt*2 &lt;= c_amt)\n         {\n         printf(\"\\nWould you like to double your bet? (y/n)\");\n         scanf(\"\\n%c\", &amp;y_n);\n         }\n        if(y_n == 'y' || y_n == 'Y')\n         { \n         bet_amt = bet_amt*2;\n         }\n\n         do\n         {\n         total = rolling();\n         if(total == 7)\n           {\n           printf(\"\\nGood job! You win! :)\");\n           winlose=1;\n           break;\n           }\n\n         }\n         while(total != point);\n\n         if(total == 7)\n          {\n          printf(\"You rolled a seven before making your point. You lose! :(\");\n          winlose = 0;\n          }\n\n          }\n      }\n          if(winlose ==  1)\n            {\n              final_amt = bet_amt + c_amt;\n              win++;\n            }\n          else\n            {\n              final_amt = c_amt - bet_amt;\n              lose++;\n            }\n        printf(\"Final amount is %d.\", final_amt);\n        return final_amt;\n    }\n</code></pre>\n\n<p>Here is sample output:</p>\n\n<pre><code>Welcome to Craps! Get ready to play!\nPlease press 'f' if you are betting for yourself and 'a' if your are betting against yourself.\n\nYour current bank balance is 100.\nEnter the amount you want to bet: Bet amount: -1219958512\nYou dont have that much money or you placed a bet less than the minimum. Please place a proper bet.Final amount is 1219958612.\nYour current balance is -1074871812 1219958612\nDo you want to play again? (y/n): \n</code></pre>\n"}, {"tags": ["c++", "c", "gcc"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 3, "creation_date": 1458167060, "post_id": 36048089, "comment_id": 59744694, "body": "Is not it like C and C++ are different languages?"}, {"owner": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "reply_to_user": {"reputation": 11533, "user_id": 1366431, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/YBopF.png?s=128&g=1", "display_name": "Leushenko", "link": "https://stackoverflow.com/users/1366431/leushenko"}, "edited": false, "score": 1, "creation_date": 1458167270, "post_id": 36048089, "comment_id": 59744791, "body": "@Leushenko But you can&#39;t overload based on return type only. Also, g++ might compile the code as C due to the file name. Either way, it shouldn&#39;t compile."}, {"owner": {"reputation": 10055, "user_id": 2466431, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/gSQh3.png?s=128&g=1", "display_name": "JVApen", "link": "https://stackoverflow.com/users/2466431/jvapen"}, "edited": false, "score": 0, "creation_date": 1458167578, "post_id": 36048089, "comment_id": 59744918, "body": "If you want to use printf, make sure you pass the correct format string. In this case, I&#39;m guessing that the global overload is used, so <code>%lf</code> should be used instead of <code>%d</code>. However I would recommend <code>std::cout &lt;&lt; f(1)&lt;&lt; std::endl;</code> Note that gcc does notice this inconsistency and tells you it&#39;ll have problems with it and most likely a reinterpret_cast will occur for 1.0 to an int"}, {"owner": {"reputation": 65414, "user_id": 768469, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/383724e63ab04b146277912c16f27f54?s=128&d=identicon&r=PG", "display_name": "Nemo", "link": "https://stackoverflow.com/users/768469/nemo"}, "reply_to_user": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 1, "creation_date": 1458167591, "post_id": 36048089, "comment_id": 59744924, "body": "@juanchopanza: The code is wrong, but is a diagnostic actually mandated in this case?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1458167950, "post_id": 36048089, "comment_id": 59745052, "body": "What is the problem? Ruby behaves different that Rust, C than C++, Java different than Pascal, etc."}], "answers": [{"comments": [{"owner": {"reputation": 693, "user_id": 1666237, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9ae31965f7351e2e8679156cf114b3a8?s=128&d=identicon&r=PG", "display_name": "Don Slowik", "link": "https://stackoverflow.com/users/1666237/don-slowik"}, "edited": false, "score": 0, "creation_date": 1458232225, "post_id": 36048365, "comment_id": 59779131, "body": "Thank you, that does seem to explain what is happening here. So one should be careful to self-check that the function type of a function declared within a block matches that function&#39;s definition, as the compiler may not."}, {"owner": {"reputation": 65414, "user_id": 768469, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/383724e63ab04b146277912c16f27f54?s=128&d=identicon&r=PG", "display_name": "Nemo", "link": "https://stackoverflow.com/users/768469/nemo"}, "reply_to_user": {"reputation": 693, "user_id": 1666237, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9ae31965f7351e2e8679156cf114b3a8?s=128&d=identicon&r=PG", "display_name": "Don Slowik", "link": "https://stackoverflow.com/users/1666237/don-slowik"}, "edited": false, "score": 0, "creation_date": 1458232991, "post_id": 36048365, "comment_id": 59779740, "body": "@user1666237: Yes. Also, this sort of local declaration for a global name is, in my experience, very unusual... In fact I have never seen one in production code. The usual approach is to put <i>all</i> non-static declarations into header files and <code>#include</code> them as appropriate. That way, the compiler will tell you about this sort of mismatch even across translation units."}, {"owner": {"reputation": 693, "user_id": 1666237, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9ae31965f7351e2e8679156cf114b3a8?s=128&d=identicon&r=PG", "display_name": "Don Slowik", "link": "https://stackoverflow.com/users/1666237/don-slowik"}, "edited": false, "score": 0, "creation_date": 1458233619, "post_id": 36048365, "comment_id": 59780182, "body": "Agreed  (comment to &gt;15 chars)"}], "tags": [], "owner": {"reputation": 65414, "user_id": 768469, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/383724e63ab04b146277912c16f27f54?s=128&d=identicon&r=PG", "display_name": "Nemo", "link": "https://stackoverflow.com/users/768469/nemo"}, "is_accepted": true, "score": 5, "last_activity_date": 1458233077, "last_edit_date": 1458233077, "creation_date": 1458168196, "answer_id": 36048365, "question_id": 36048089, "link": "https://stackoverflow.com/questions/36048089/localblock-function-decln-vs-defn-return-type-mismatch-diagnostic-in-c/36048365#36048365", "title": "Local(Block) function decln vs. defn return type mismatch; Diagnostic in C++?", "body": "<p>I can explain this behavior for C++.</p>\n\n<p>From the C++11 spec, section 3.5 [basic.link], paragraph (7):</p>\n\n<blockquote>\n  <p>When a block scope declaration of an entity with linkage is not found to refer to some other declaration, then that entity is a member of the innermost enclosing namespace. However such a declaration does not introduce the member name in its namespace scope.</p>\n</blockquote>\n\n<p>So the <code>int f(int)</code> declaration has global linkage, but does not introduce the name into the global namespace. This might explain why GCC does not notice the conflict.</p>\n\n<p>More importantly, paragraph (10) says:</p>\n\n<blockquote>\n  <p>After all adjustments of types (during which typedefs (7.1.3) are replaced by their definitions), the types specified by all declarations referring to a given variable or function shall be identical, except that declarations for an array object can specify array types that differ by the presence or absence of a major array bound (8.3.4). A violation of this rule on type identity does not require a diagnostic.</p>\n</blockquote>\n\n<p>Your program violates the \"shall\" portion of this paragraph, so its behavior is undefined. That means anything GCC does whatsoever -- such as calling the <code>double foo(int)</code> function and treating its return value as an int -- is permitted by the spec. Moreover, no diagnostic is required.</p>\n\n<p>I do not know what C says about this case; in particular, whether the diagnostic is required.</p>\n"}], "owner": {"reputation": 693, "user_id": 1666237, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9ae31965f7351e2e8679156cf114b3a8?s=128&d=identicon&r=PG", "display_name": "Don Slowik", "link": "https://stackoverflow.com/users/1666237/don-slowik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "accepted_answer_id": 36048365, "answer_count": 1, "score": 0, "last_activity_date": 1458234123, "creation_date": 1458166970, "last_edit_date": 1458234123, "question_id": 36048089, "link": "https://stackoverflow.com/questions/36048089/localblock-function-decln-vs-defn-return-type-mismatch-diagnostic-in-c", "title": "Local(Block) function decln vs. defn return type mismatch; Diagnostic in C++?", "body": "<p>This program is in the file called localFunc.c:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n// int f(int);  // Global forward declaration.\n\nint main() {\n   int f(int);  // Local forward declaration.\n   printf(\"%d\\n\", f(1));\n}\n\ndouble f(int i) {\n   return 1.0;\n}\n</code></pre>\n\n<p>Compiling via <code>gcc localFunc.c</code> gives:</p>\n\n<pre><code>localFunc.c:10:8: error: conflicting types for \u2018f\u2019\n double f(int i) {\n        ^\nlocalFunc.c:6:7: note: previous declaration of \u2018f\u2019 was here\n    int f(int);  // Local forward declaration.\n</code></pre>\n\n<p>But compiled via <code>g++ localFunc.c</code>, there is no error and the result of running the executable is: <code>4195638</code>.</p>\n\n<p>Commenting out the Local forward declaration, and turning on the Global forward declaration of: <code>int f(int);</code>, both gcc and g++ give errors similar to the above, as expected(by me).</p>\n\n<p>So my question is, why does it appear that g++ is not seeing the conflicting types(ambiguous declaration) on locally declared functions?</p>\n\n<pre><code>don@HAL:~/UNIX/CS213$ gcc --version\ngcc (Ubuntu 5.2.1-22ubuntu2) 5.2.1 20151010\n</code></pre>\n"}, {"tags": ["c", "sockets", "process", "fork"], "comments": [{"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1458166923, "post_id": 36047712, "comment_id": 59744635, "body": "There is extra latency introduced by creating a new process. Firstly, for the actual work required to create the process and then the lag between when the process is created and when it actually gets scheduled by the OS. It doesn&#39;t really make sense to pay the cost of spawning a new process just to send a single message."}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1458168918, "post_id": 36047712, "comment_id": 59745462, "body": "Why? Creating a whole process to send one UDP datagram is a major waste and misuse of resources. Simple answer: don&#39;t."}, {"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1458175474, "post_id": 36047712, "comment_id": 59747609, "body": "No wonder it is so much faster. As Harry noticed in his answer, you keep making more processes. After you have launched about 2 per CPU core you should be a maximum system utilization. Actually a pretty good technique with UDP if you don&#39;t care about the ordering of the packets, since any process using the socket can pull a packet in any order."}, {"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1458175656, "post_id": 36047712, "comment_id": 59747673, "body": "Ah guess I didn&#39;t understand when I read it at first. I thought you said the multiprocess one was faster. It <i>would</i> be if it didn&#39;t create a new process every single time."}, {"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1458175704, "post_id": 36047712, "comment_id": 59747681, "body": "Create the socket, bind it, then use a loop to fork() about 16 of them and try that. And make sure each child <code>break</code>s out of the loop or you&#39;ll have almost 256 of them instead of 16."}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 3621499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8afbf4541d8f8db36a98625a3bfc1f47?s=128&d=identicon&r=PG&f=1", "display_name": "AskMan", "link": "https://stackoverflow.com/users/3621499/askman"}, "edited": false, "score": 0, "creation_date": 1458233431, "post_id": 36048757, "comment_id": 59780041, "body": "I wanted to &quot;recreate&quot; the behavior of servers: they listen on port 80, as soon as I client request something on port 80 they create a process to respond to the client and leave the port 80 free to listen for new requests. I don&#39;t know if what I did is similar to it... Should I fork after recvfrom?"}, {"owner": {"reputation": 10563, "user_id": 1104328, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/df0790774838286ad0d93567ae1fcf56?s=128&d=identicon&r=PG&f=1", "display_name": "Harry", "link": "https://stackoverflow.com/users/1104328/harry"}, "reply_to_user": {"reputation": 35, "user_id": 3621499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8afbf4541d8f8db36a98625a3bfc1f47?s=128&d=identicon&r=PG&f=1", "display_name": "AskMan", "link": "https://stackoverflow.com/users/3621499/askman"}, "edited": false, "score": 0, "creation_date": 1458235183, "post_id": 36048757, "comment_id": 59781282, "body": "Each child has a copy of what the parent had. This means they can also listen and accept connections on the socket. Have a look on Google for pre-forking server examples in C."}], "tags": [], "owner": {"reputation": 10563, "user_id": 1104328, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/df0790774838286ad0d93567ae1fcf56?s=128&d=identicon&r=PG&f=1", "display_name": "Harry", "link": "https://stackoverflow.com/users/1104328/harry"}, "is_accepted": true, "score": 1, "last_activity_date": 1458170038, "creation_date": 1458170038, "answer_id": 36048757, "question_id": 36047712, "link": "https://stackoverflow.com/questions/36047712/multiprocess-server-udp-socket-goes-slower-than-single-process/36048757#36048757", "title": "Multiprocess server UDP socket goes slower than single process?", "body": "<p>There are several things wrong. You've added the fork() in an infinite loop. I doubt this is what you want because you're not calling exit in the child and you're not reaping the children in the parent ie you are likely going to run out of file descriptors on the machine you're using. </p>\n\n<p>If you want to exit the child on every received message you'll need to wait on the child or you will have a lot of zombie processes use this</p>\n\n<pre><code>int status;\nwaitpid( -1, &amp;status, WNOHANG);\n</code></pre>\n\n<p>in the parent so it reaps the child and you don't run out of resources. You should also check to make sure that fork actually worked to see if you ran out of resources ie if <b>if(pid &lt; 0)</b> you have an error.</p>\n\n<p>If you fix the code and it's still slow and you know the code is correct then I'd look at process creation time. You can pass file descriptors to the child process which is what a lot of HTTP servers do ie Apache etc, this avoids the process creation overhead. Note. process creation is very cheap, using a good benchmarking tool would likely tell you exactly where the time is going.</p>\n"}], "owner": {"reputation": 35, "user_id": 3621499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8afbf4541d8f8db36a98625a3bfc1f47?s=128&d=identicon&r=PG&f=1", "display_name": "AskMan", "link": "https://stackoverflow.com/users/3621499/askman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 295, "favorite_count": 0, "accepted_answer_id": 36048757, "answer_count": 1, "score": 0, "last_activity_date": 1458170038, "creation_date": 1458165343, "last_edit_date": 1458168637, "question_id": 36047712, "link": "https://stackoverflow.com/questions/36047712/multiprocess-server-udp-socket-goes-slower-than-single-process", "title": "Multiprocess server UDP socket goes slower than single process?", "body": "<p>I've written 2 server programs to read multiple client messages and send them back using sockets via UDP; the 2 server programs differ from the management of the receiving and sending messages back; the first one simply takes the message and sends it back, the second one receives the message and creates another process to send the message back. The client sends 10000 messages to the server and I noticed that the first one resends more messages than the second one, a lot more, like 100:1;</p>\n\n<p>Here's the code for the server with only one process:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;arpa/inet.h&gt;\n#include &lt;netinet/in.h&gt;\n\n#define BUFLEN 512\n#define NPACK 10\n#define PORT 3000\n\nvoid diep(char *s)\n{\n    perror(s);\n    exit(1);\n}\n\nint main(void)\n{\n    struct sockaddr_in si_me, si_other;\n    int s, i, slen=sizeof(si_other);\n    char buf[BUFLEN], buf_to_send_back[BUFLEN];\n\n    if ((s=socket(AF_INET, SOCK_DGRAM, IPPROTO_UDP))==-1)\n        diep(\"socket\");\n    memset((char *) &amp;si_me, 0, sizeof(si_me));\n    si_me.sin_family = AF_INET;\n    si_me.sin_port = htons(PORT);\n    si_me.sin_addr.s_addr = htonl(INADDR_ANY);\n\n    if (bind(s, &amp;si_me, sizeof(si_me))==-1)\n        diep(\"bind\");\n\n    while(1)\n    {\n        //receive message\n        if (recvfrom(s, buf, BUFLEN, 0, &amp;si_other, &amp;slen)==-1)\n        {\n            diep(\"recvfrom()\");\n        } else \n        {\n            //create buffer to send it back\n            sprintf(buf_to_send_back, \"Hi %s:%d,\\nyour packet has this content: %s\\n\", inet_ntoa(si_other.sin_addr), ntohs(si_other.sin_port), buf);\n            //send a message back\n            if (sendto(s, buf_to_send_back, BUFLEN, 0, &amp;si_other, slen)==-1)\n            {\n                diep(\"sendto()\");\n            } else\n            {\n                printf(\"Response sent\\n\");\n            }\n        }\n    }\n        close(s);\n        return 0;\n}\n</code></pre>\n\n<p>And here the code I used in the second server, the one with 2 process, one to receive and one to send back:</p>\n\n<pre><code>#include &lt;arpa/inet.h&gt;\n#include &lt;netinet/in.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;signal.h&gt;\n#include &lt;stdbool.h&gt;\n\n#define BUFLEN 512\n#define NPACK 10\n#define PORT 3000\n\nvoid diep(char *s)\n{\n    perror(s);\n    exit(1);\n}\n\nint main(void)\n{\n    struct sockaddr_in si_me, si_other;\n    int s, i = 0, slen = sizeof(si_other);\n    char buf[BUFLEN], buf_to_send_back[BUFLEN];\n    pid_t pid;\n\n\n    if ((s=socket(AF_INET, SOCK_DGRAM, IPPROTO_UDP))==-1)\n        diep(\"socket\");\n    memset((char *) &amp;si_me, 0, sizeof(si_me));\n    si_me.sin_family = AF_INET;\n    si_me.sin_port = htons(PORT);\n    si_me.sin_addr.s_addr = htonl(INADDR_ANY);\n\n    if (bind(s, &amp;si_me, sizeof(si_me))==-1)\n        diep(\"bind\");\n\n\n    while(1)\n    {\n        if (recvfrom(s, buf, BUFLEN, 0, &amp;si_other, &amp;slen)!=-1)\n        {\n            pid = fork();\n            if (pid == 0)\n            {\n                //create buffer to send it back\n                sprintf(buf_to_send_back, \"Hi %s:%d,\\nyour packet has this content: %s\\n\", inet_ntoa(si_other.sin_addr), ntohs(si_other.sin_port), buf);\n                //send a message back\n                if (sendto(s, buf_to_send_back, BUFLEN, 0, &amp;si_other, slen)==-1)\n                {\n                    diep(\"sendto()\");\n                } else\n                {\n                    printf(\"Response sent\\n\");\n                }\n            } else if(pid &gt; 0)\n            {\n                printf(\"a message arrived\\n\");\n            }\n        }\n    }\n\n    close(s);\n    return 0;\n}\n</code></pre>\n\n<p>The client program I used with both is this:</p>\n\n<pre><code>#include &lt;arpa/inet.h&gt;\n#include &lt;netinet/in.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;string.h&gt;\n\n#define BUFLEN 512\n#define NPACK 10\n#define PORT 3000\n#define SERVER_IP \"127.0.0.1\"\n\nvoid diep(char *s)\n{\n    perror(s);\n    exit(1);\n}\n\nint main(void)\n{\n    struct sockaddr_in si_other;\n    int s, i, slen=sizeof(si_other);\n    char buf[BUFLEN];\n\n    if ((s=socket(AF_INET, SOCK_DGRAM, IPPROTO_UDP))==-1)\n        diep(\"socket\");\n\n    memset((char *) &amp;si_other, 0, sizeof(si_other));\n    si_other.sin_family = AF_INET;\n    si_other.sin_port = htons(PORT);\n    if (inet_aton(SERVER_IP, &amp;si_other.sin_addr) == 0)\n    {\n        fprintf(stderr, \"inet_aton() failed\\n\");\n        exit(1);\n    }\n\n    while(1)\n    {\n        printf(\"\\nInsert a message to send:\\n\");\n        scanf(\"%s\", buf);\n        for(i = 0; i &lt; 10000; i++)\n        {\n            if (sendto(s, buf, BUFLEN, 0, &amp;si_other, slen)==-1)\n            {\n                diep(\"sendto()\");\n            } else\n            {\n                printf(\"Message sent:\\n %s\\n\", buf);\n            }\n        }\n        if (recvfrom(s, buf, BUFLEN, 0, &amp;si_other, &amp;slen)==-1)\n        {\n                diep(\"recvfrom()\");\n        } else {\n            printf(\"A message has been received:\\n %s\\n\", buf);\n        }\n\n\n\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>Thanks in advance for the help!</p>\n"}, {"tags": ["c", "getchar"], "comments": [{"owner": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "edited": false, "score": 0, "creation_date": 1458164981, "post_id": 36047577, "comment_id": 59743752, "body": "Basic rule: if your input is line-based, then use line-based functions.  Look at <code>fgets</code>."}], "answers": [{"comments": [{"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 2, "creation_date": 1458164950, "post_id": 36047607, "comment_id": 59743736, "body": "If I could only have penny for every time somebody made this error :)"}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 1, "last_activity_date": 1458164957, "last_edit_date": 1458164957, "creation_date": 1458164909, "answer_id": 36047607, "question_id": 36047577, "link": "https://stackoverflow.com/questions/36047577/getchar-doesnt-work-in-c/36047607#36047607", "title": "getchar() doesn&#39;t work in C", "body": "<p>Here, <code>getchar()</code> does not <em>wait</em> because the last <code>scanf()</code> leaves a newline (<code>\\n</code>) into the input buffer due to the last ENTER key press after <code>scanf()</code> input.</p>\n\n<p>You need to clean up the buffer before you can call <code>getchar()</code> if you expect <code>getchar()</code> to <em>wait</em> for user input.</p>\n"}, {"comments": [{"owner": {"reputation": 38863, "user_id": 2415822, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zxy7G.jpg?s=128&g=1", "display_name": "JAL", "link": "https://stackoverflow.com/users/2415822/jal"}, "edited": false, "score": 0, "creation_date": 1458169798, "post_id": 36047680, "comment_id": 59745792, "body": "Please elaborate on how this answers the question."}], "tags": [], "owner": {"reputation": 735, "user_id": 4404777, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c0fc549e96e6522a9dacc477338cd292?s=128&d=identicon&r=PG&f=1", "display_name": "webpersistence", "link": "https://stackoverflow.com/users/4404777/webpersistence"}, "is_accepted": false, "score": 0, "last_activity_date": 1458165205, "creation_date": 1458165205, "answer_id": 36047680, "question_id": 36047577, "link": "https://stackoverflow.com/questions/36047577/getchar-doesnt-work-in-c/36047680#36047680", "title": "getchar() doesn&#39;t work in C", "body": "<p>Instead <code>g = getchar();</code> try <code>scanf(\"%c\",&amp;g);</code></p>\n"}], "owner": {"reputation": 11, "user_id": 5828115, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04bd32b6d3dbbf867fe21b0dd352b2d9?s=128&d=identicon&r=PG&f=1", "display_name": "Armin Javid", "link": "https://stackoverflow.com/users/5828115/armin-javid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1124, "favorite_count": 0, "closed_date": 1458165175, "answer_count": 2, "score": 0, "last_activity_date": 1458165205, "creation_date": 1458164781, "last_edit_date": 1458165189, "question_id": 36047577, "link": "https://stackoverflow.com/questions/36047577/getchar-doesnt-work-in-c", "closed_reason": "Duplicate", "title": "getchar() doesn&#39;t work in C", "body": "<p>I'm using <code>getchar()</code> to get a word in C and use switch to know what was the input, but it doesn't wait for input. Can anybody tell me why that is?</p>\n\n<p>and this is my code:<br></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\nint main()\n{\n    printf(\"Written By A.Rahbari\\n\");\n    float velocity_ratio_of_sun_and_planet ;\n    float velocity_ratio_double_gear;\n    float N_Annulus;\n    float N_Sun;\n    float N_Planet;\n    float u;\n    int x;\n    int y;\n    int i;\n    int g;\n    printf(\"Enter velocity ratio of sun and planet:\\n\");\n    scanf(\"%f\",&amp;velocity_ratio_of_sun_and_planet);\n    printf(\"Enter velocity ratio of double gear:\\n\");\n    scanf(\"%f\",&amp;velocity_ratio_double_gear);\n    printf(\"Enter sun or annulus:\");\n    g=getchar();\n    switch(g)\n    {\n\n    case '10' :\n        printf(\"your design is based on annulus\\n\");\n        printf(\"Enter range of annulus teeth per inch:\\n\");\n        scanf(\"%d%d\",&amp;x,&amp;y);\n        printf(\"Enter nember of range step:\\n\");\n        scanf(\"%d\",&amp;i);\n        for (N_Annulus=x; N_Annulus&lt;=y; N_Annulus+=i)\n        {\n            N_Sun = N_Annulus / (velocity_ratio_of_sun_and_planet - 1);\n            N_Planet=( N_Annulus - N_Sun )/2;\n            u=(N_Sun - floor(fabs(N_Sun)))+(N_Planet - floor(fabs(N_Planet)));\n            printf(\"g\");\n            if (u == 0)\n            {\n                printf(\"\\t%d\\t\\t   %d\\t\\t %d\\t\\t\\n\",N_Annulus,N_Sun,N_Planet);\n            }\n            else\n            {\n                continue;\n            }\n         }\n         break;\n\n    case 's':\n\n        break;\n    }\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "multidimensional-array", "strstr"], "comments": [{"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1458164590, "post_id": 36047394, "comment_id": 59743593, "body": "The problem is that <code>fgets</code> puts the newline character into the buffer. <a href=\"http://stackoverflow.com/a/28462221/3386109\">Here are suggestions</a> on how to remove the newline."}, {"owner": {"reputation": 21, "user_id": 4100507, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/3bfef88e5b7f762b633fc65e6751a808?s=128&d=identicon&r=PG&f=1", "display_name": "DJOwen", "link": "https://stackoverflow.com/users/4100507/djowen"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1458165728, "post_id": 36047394, "comment_id": 59744099, "body": "The hidden characters strike again, that suggestion seems to have worked.  Thanks for your help!"}], "owner": {"reputation": 21, "user_id": 4100507, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/3bfef88e5b7f762b633fc65e6751a808?s=128&d=identicon&r=PG&f=1", "display_name": "DJOwen", "link": "https://stackoverflow.com/users/4100507/djowen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "closed_date": 1458168187, "answer_count": 0, "score": 0, "last_activity_date": 1458164251, "creation_date": 1458164037, "last_edit_date": 1458164251, "question_id": 36047394, "link": "https://stackoverflow.com/questions/36047394/strstr-in-c-using-multidimensional-arrays", "closed_reason": "Duplicate", "title": "strstr in C using multidimensional arrays", "body": "<p>For background, I'm currently working on an assignment to scan Les Miserables (given to me in a <code>.txt</code> file) for character names (a list of which is given to me in a separate <code>.txt</code> file).  When a character is mentioned, write which character and which line they are mentioned in into a <code>.txt</code> file.  My code currently records the character names into <code>namesArr[66][20]</code>, and a 4-line excerpt from Les Miserables (a different file then the entire novel) into <code>fourlinesArr[4][100]</code>.  </p>\n\n<p>Now to the actual problem.  When attempting to check if a line of <code>namesArr</code> is in <code>fourlinesArr</code>, <code>strstr</code> will always return false.  If I replace <code>namesArr</code> with a single character array, it works just fine however.  Is there any way to get <code>strstr</code> to work properly with multidimensional arrays, or should I use a different function entirely? </p>\n\n<p>Entire code below: </p>\n\n<pre><code>//import statements\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint main(void) {\n\n//Read for Les-Mis-Names.txt\n//copy and pasted fileIO.c, editing where required\nconst char *NAMES_FILE_PATH = \"./Moodle Documents/Les-Mis-Names.txt\"; // location of names file\nint nameslineNum = 0;\nchar namesArr[66][20];\n\nFILE *names = fopen(NAMES_FILE_PATH,  \"r+\" );       /* open for reading */\n// This will take each row in the file and store it in namesArr.\nif (names == NULL ){      /* check does names file exist etc */\n    perror (\"Error opening names file\");\n    nameslineNum = -1; /* use this as a file not found code */\n} else {\n    // fgets returns NULL when it gets to the end of the file\n    while ( fgets(namesArr[nameslineNum], sizeof(namesArr[nameslineNum]), names ) != NULL ) {\n        nameslineNum++;\n    }\n    fclose (names);\n}\n//end of fileIO.c code \n\n//Read for Les-Mis-4-lines\n//copy and pasted fileIO.c, editing where required\nconst char *LES_MIS_4_LINES_FILE_PATH = \"./Moodle Documents/Les-Mis-4-lines\"; // location of Les-Mis-4-lines file\nint fourlineslineNum = 0;\nchar fourlinesArr[4][100];\n\nFILE *fourlines = fopen(LES_MIS_4_LINES_FILE_PATH,  \"r+\" );       /* open for reading */\n// This will take each row in the file and store it in fourlinesArr.\nif (fourlines == NULL ){      /* check does 4 lines file exist etc */\n    perror (\"Error opening 4 lines file\");\n    fourlineslineNum = -1; /* use this as a file not found code */\n} else {\n    // fgets returns NULL when it gets to the end of the file\n    while ( fgets(fourlinesArr[fourlineslineNum], sizeof(fourlinesArr[fourlineslineNum]), fourlines ) != NULL ) {\n\n        fourlineslineNum++;\n    }\n    fclose (fourlines);\n}\n//end of fileIO.c code\n\n\n//testing\nchar name[20] = \"Fabantou\";\nprintf(\"%s\\n\", namesArr[62]);\nprintf(\"%s\\n\", fourlinesArr[0]);\n\nif(strstr(fourlinesArr[0], namesArr[62]) != NULL) {\n    printf(\"Success\\n\");\n}\nelse {\n    printf(\"Failure\\n\");\n}\n\nif(strstr(fourlinesArr[0], name) != NULL) {\n    printf(\"Success\\n\");\n}\nelse {\n    printf(\"Failure\\n\");\n}\n\nreturn 0;\n}\n</code></pre>\n\n<p>Which returns: </p>\n\n<pre><code>Fabantou\n\n\"Madame Fabantou seems to me to be better,\" went on M. Leblanc, casting\n\nFailure\n\nSuccess\n</code></pre>\n"}, {"tags": ["c", "embedded"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1458164474, "post_id": 36047275, "comment_id": 59743520, "body": "There certainly is a place for creative text design. But not for program code."}, {"owner": {"reputation": 40, "user_id": 6073900, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/9971f0eb386d35844fba65855ed03c92?s=128&d=identicon&r=PG&f=1", "display_name": "Bad programmer ", "link": "https://stackoverflow.com/users/6073900/bad-programmer"}, "edited": false, "score": 0, "creation_date": 1458165375, "post_id": 36047275, "comment_id": 59743939, "body": "time2 does equal to 0, but when it equals to 0 time1 doesn&#39;t go and do its full count down from 9."}, {"owner": {"reputation": 40, "user_id": 6073900, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/9971f0eb386d35844fba65855ed03c92?s=128&d=identicon&r=PG&f=1", "display_name": "Bad programmer ", "link": "https://stackoverflow.com/users/6073900/bad-programmer"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1458165397, "post_id": 36047275, "comment_id": 59743944, "body": "@Olaf I&#39;m kind of confused by your comment"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1458165511, "post_id": 36047275, "comment_id": 59743996, "body": "As much as I am by the creative formatting of you rsource code."}, {"owner": {"reputation": 40, "user_id": 6073900, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/9971f0eb386d35844fba65855ed03c92?s=128&d=identicon&r=PG&f=1", "display_name": "Bad programmer ", "link": "https://stackoverflow.com/users/6073900/bad-programmer"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1458165795, "post_id": 36047275, "comment_id": 59744129, "body": "Mr. @Olaf If you think you can help me solve this problem that i am running into i will be more than happy to give you the entire C source code where i get the LCD_cursor() and LCD_display_value() functions."}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1458167983, "post_id": 36047275, "comment_id": 59745070, "body": "What does &quot;it skips the 10 digits&quot; mean?"}, {"owner": {"reputation": 40, "user_id": 6073900, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/9971f0eb386d35844fba65855ed03c92?s=128&d=identicon&r=PG&f=1", "display_name": "Bad programmer ", "link": "https://stackoverflow.com/users/6073900/bad-programmer"}, "reply_to_user": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1458169087, "post_id": 36047275, "comment_id": 59745532, "body": "@immibis So when ever the time goes like 2:0x it suddenly goes to 1:59. Timer1 doesn&#39;t show up at all when timer 0 is at 0."}, {"owner": {"reputation": 4011, "user_id": 1477064, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/cd12123a743db34ac0b055a6fa736788?s=128&d=identicon&r=PG", "display_name": "xvan", "link": "https://stackoverflow.com/users/1477064/xvan"}, "edited": false, "score": 0, "creation_date": 1458185951, "post_id": 36047275, "comment_id": 59750530, "body": "@Badprogrammer Next time try to provide an <a href=\"http://stackoverflow.com/help/mcve\">MCVE</a>, for your case it could have been generated by replacing the all the LCD functions with <code>printf(&quot;%d:%d%d\\n&quot;, time3, time2, time1)</code>"}, {"owner": {"reputation": 40, "user_id": 6073900, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/9971f0eb386d35844fba65855ed03c92?s=128&d=identicon&r=PG&f=1", "display_name": "Bad programmer ", "link": "https://stackoverflow.com/users/6073900/bad-programmer"}, "edited": false, "score": 0, "creation_date": 1458200189, "post_id": 36047275, "comment_id": 59755698, "body": "The thing is i do have it working in visual studios but when i transfer the file onto the PIC and use the specific libraries to display the numbers it doesn&#39;t seem to work. <code>int a = 9; int b = 3; int c = 2; int d = 3;   main() { \t \twhile (d != 1){  \t\tprintf(&quot;%d : %d %d\\n&quot;, c, b, a); \t\ta = a - 1; \t\tif (a &lt; 0){ \t\t\tb = b - 1; \t\t\ta = 9; \t\t} \t\tif (b &lt; 0){ \t\t\tc = c - 1; \t\t\tb = 5; \t\t\ta = 9; \t\t}  \t\tif (c &lt; 0) \t\t\td = 1;  \t} \tgetch(); }</code>"}], "answers": [{"comments": [{"owner": {"reputation": 40, "user_id": 6073900, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/9971f0eb386d35844fba65855ed03c92?s=128&d=identicon&r=PG&f=1", "display_name": "Bad programmer ", "link": "https://stackoverflow.com/users/6073900/bad-programmer"}, "edited": false, "score": 0, "creation_date": 1458202954, "post_id": 36051193, "comment_id": 59757223, "body": "Thanks a lot Mr. @xvan!  That works!  I understand my question wasn&#39;t as clear as i had hope and i will try to make a better effort to explain my question more clearly in the future.  Once again thank you :)"}], "tags": [], "owner": {"reputation": 4011, "user_id": 1477064, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/cd12123a743db34ac0b055a6fa736788?s=128&d=identicon&r=PG", "display_name": "xvan", "link": "https://stackoverflow.com/users/1477064/xvan"}, "is_accepted": false, "score": 0, "last_activity_date": 1458186535, "last_edit_date": 1458186535, "creation_date": 1458185615, "answer_id": 36051193, "question_id": 36047275, "link": "https://stackoverflow.com/questions/36047275/making-a-timer-for-an-lcd-screen-using-c/36051193#36051193", "title": "Making a timer for an LCD screen using C", "body": "<p>Change </p>\n\n<pre><code>if (time2 == 0)\n</code></pre>\n\n<p>to</p>\n\n<pre><code>if (time2 == 0 &amp;&amp; time1==0)\n</code></pre>\n\n<hr>\n\n<p>Rearranging your code blocks you also can fix your exit condition:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(){\n\nint time1 = 1;\nint time2 = 4;\nint time3 = 4;\n\nwhile (time1 || time2 || time3) {\n\n    if (time1 != 0)\n        time1 = time1 - 1;\n    else {\n        time2 = time2 - 1;\n        time1 = 9;\n         }\n\n    printf(\"%d:%d%d\\n\", time3, time2, time1);\n\n    if (time2 == 0 &amp;&amp; time1 == 0){\n\n        if (time3 != 0){\n            time2 = 5;\n            time3 = time3 - 1;\n            time1 = 9;\n            printf(\"inner %d:%d%d\\n\", time3, time2, time1);\n        }\n    }\n\n}\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 40, "user_id": 6073900, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/9971f0eb386d35844fba65855ed03c92?s=128&d=identicon&r=PG&f=1", "display_name": "Bad programmer ", "link": "https://stackoverflow.com/users/6073900/bad-programmer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 544, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1458186535, "creation_date": 1458163631, "last_edit_date": 1458171899, "question_id": 36047275, "link": "https://stackoverflow.com/questions/36047275/making-a-timer-for-an-lcd-screen-using-c", "title": "Making a timer for an LCD screen using C", "body": "<p>I'm trying to make a timer for an LCD screen. I don't normally program because it isn't related to my degree but I thought I would do it for fun. I am using a built in library designed by a friend.<br>\nI have designed the if loop below, just some quick info on my loop.\nThe <code>LCD_cursor</code> statement moves the cursor around the screen so I can print the letter in the correct place. \nThe <code>LCD_display_value</code> function is used to print the value of the integer.</p>\n\n<p>The problem that I have is, it prints everything fine until it gets to <code>time2</code>, then it just skips the 10 digits and carries on as normal. It works at finishing the loop at the right point.</p>\n\n<pre><code>time1 = 1; time2 = 4; time3 = 4; finish = 3;        \nwhile (finish != 1) {\n    if (time1 == 0 &amp;&amp; time2 == 0 &amp;&amp; time3 == 0)\n        finish = 1;\n    if (time1 != 0)\n        time1 = time1 - 1;\n    else {time2 = time2 - 1;\n                                    time1 = 9;}\n\n    if (time2 == 0){\n        LCD_cursor(14,0);\n        LCD_display_value(time2);\n        Delay_ms(200);\n\n        if (time3 != 0){\n            time2 = 5;\n            time3 = time3 - 1;\n            time1 = 9;\n        }\n    }\n\n    LCD_cursor(15,0);\n    LCD_display_value(time1);\n    LCD_cursor(14,0);\n    LCD_display_value(time2);\n    LCD_cursor(13,0);\n    LCD_putch(':');\n    LCD_cursor(12,0);\n    LCD_display_value(time3);\n    delay_ms(200);\n}\n</code></pre>\n"}, {"tags": ["c", "csv", "sqlite"], "comments": [{"owner": {"reputation": 157205, "user_id": 11654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/586424ca0847070dc1868aa58077003e?s=128&d=identicon&r=PG", "display_name": "CL.", "link": "https://stackoverflow.com/users/11654/cl"}, "edited": false, "score": 0, "creation_date": 1458201017, "post_id": 36046828, "comment_id": 59756141, "body": "Have a look at <a href=\"http://www.sqlite.org/cgi/src/finfo?name=src/shell.c\" rel=\"nofollow noreferrer\">how the command-line shell implements this</a>."}, {"owner": {"reputation": 33, "user_id": 6041508, "user_type": "registered", "profile_image": "https://graph.facebook.com/1670187493269943/picture?type=large", "display_name": "Anthea Huang", "link": "https://stackoverflow.com/users/6041508/anthea-huang"}, "reply_to_user": {"reputation": 157205, "user_id": 11654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/586424ca0847070dc1868aa58077003e?s=128&d=identicon&r=PG", "display_name": "CL.", "link": "https://stackoverflow.com/users/11654/cl"}, "edited": false, "score": 0, "creation_date": 1458335536, "post_id": 36046828, "comment_id": 59832931, "body": "Thanks. But it seems that C cannot import csv into SQLite."}], "answers": [{"comments": [{"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 1, "creation_date": 1458681252, "post_id": 36165138, "comment_id": 59967811, "body": "Tokenizing CVS input is non-trivial. Simple cases are simple, but I don&#39;t think there&#39;s even a universally recognized standard for, for example, how to represent fields that contain commas. See <a href=\"https://en.wikipedia.org/wiki/Comma-separated_values\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Comma-separated_values</a>"}], "tags": [], "owner": {"reputation": 2947, "user_id": 6044312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ba69e6befe938aa251519363279b4da?s=128&d=identicon&r=PG&f=1", "display_name": "Grant Shannon", "link": "https://stackoverflow.com/users/6044312/grant-shannon"}, "is_accepted": false, "score": 1, "last_activity_date": 1458720409, "last_edit_date": 1458720409, "creation_date": 1458680485, "answer_id": 36165138, "question_id": 36046828, "link": "https://stackoverflow.com/questions/36046828/how-to-use-sqlite3-c-interface-to-load-csv-file-into-a-main-memory-database/36165138#36165138", "title": "How to use SQLite3 C interface to load CSV file into a main memory database?", "body": "<p>The SQLite 3 C - API can be used to import csv into an Sqlite3 database. </p>\n\n<ul>\n<li>Your C code needs to open the CSV file, read in each line of the CSV\nfile, making sure to store the column values (in the current row) in an\nappropriate container (i.e. column boundaries determined by comma separator).</li>\n<li>These column values can be bound to parameters in a prepared\nstatement and then committed to the database.  Here is a useful link:\n<a href=\"http://blog.quibb.org/2010/08/fast-bulk-inserts-into-sqlite/\" rel=\"nofollow\">http://blog.quibb.org/2010/08/fast-bulk-inserts-into-sqlite/</a></li>\n</ul>\n"}], "owner": {"reputation": 33, "user_id": 6041508, "user_type": "registered", "profile_image": "https://graph.facebook.com/1670187493269943/picture?type=large", "display_name": "Anthea Huang", "link": "https://stackoverflow.com/users/6041508/anthea-huang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 866, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1458720409, "creation_date": 1458162061, "question_id": 36046828, "link": "https://stackoverflow.com/questions/36046828/how-to-use-sqlite3-c-interface-to-load-csv-file-into-a-main-memory-database", "title": "How to use SQLite3 C interface to load CSV file into a main memory database?", "body": "<p>I know that there is a command line \".import\" which can do this.\nBut if I want to do the same thing in C programs, what should I do?\nAnd we are using the SQLite main memory database.\nIt means we have to do all things in one program. Otherwise, the database is cancelled after the connection is closed.\nThank you.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1458161817, "post_id": 36046471, "comment_id": 59742112, "body": "Do you know the difference between &quot;a function returning a value&quot; and &quot;a process returning a value&quot;?"}, {"owner": {"reputation": 281, "user_id": 4557453, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/98021faf61dfd92a09249c9fb7aad2a1?s=128&d=identicon&r=PG&f=1", "display_name": "TheValars", "link": "https://stackoverflow.com/users/4557453/thevalars"}, "reply_to_user": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1458179887, "post_id": 36046471, "comment_id": 59748936, "body": "I believe I do. <code>myexec</code> is a function which returns no value. when running the function, it creates a process. fork creates two processes. <code>execve</code>replaces the calling child process. Whatever is returned by this new process is a process returning a value. Do correct me if i am wrong"}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1458180629, "post_id": 36046471, "comment_id": 59749149, "body": "Sure. But you said that you need the <i>process</i> to not return a value because the <i>function</i> returns void. That&#39;s a bit like asking &quot;I know I can use the volume knob on my speakers, but how can I make sure they won&#39;t go louder than 600 litres? My fridge has a volume of 600 litres.&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1458161851, "post_id": 36046519, "comment_id": 59742130, "body": "Can you provide some links to details of bugs caused by using <code>exit</code>?"}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1458162779, "post_id": 36046519, "comment_id": 59742655, "body": "After you fork but before you successfully exec you have two copies of everything that was in memory: two copies of every output stream that&#39;s about to be flushed when you exit, two copies of every cleanup function registered with <code>atexit</code> that&#39;s about to get called when you exit.  What <code>_exit</code> typically does is to exit <i>without</i> performing any of those cleanup activities."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "reply_to_user": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1458166506, "post_id": 36046519, "comment_id": 59744461, "body": "@immibis What Steve said. Imagine, for example, that the parent has written some security sensitive output to a stream and it&#39;s held in the stream buffer. The child closes that stream&#39;s file descriptor and opens a new file descriptor that gets the same number, say to a logging server. When you call <code>exit</code>, the <code>atexit</code> handler may flush the security sensitive output to the file descriptor that now points to the logging server. Oops. You just logged a secret. (Yes this has really happened.)"}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1458167056, "post_id": 36046519, "comment_id": 59744692, "body": "@DavidSchwartz I can imagine that happening; I asked if you knew of any actual vulnerabilities (well, bugs) caused by it."}], "tags": [], "owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "is_accepted": true, "score": 1, "last_activity_date": 1458160886, "creation_date": 1458160886, "answer_id": 36046519, "question_id": 36046471, "link": "https://stackoverflow.com/questions/36046471/ending-child-process-without-returning-a-value/36046519#36046519", "title": "Ending child process without returning a value", "body": "<p>Do not call <code>exit</code>. That's a serious mistake that has caused severe bugs in the past with significant security implications.</p>\n\n<p>Call <code>_exit</code>. You can pass it a zero, it doesn't matter if the parent doesn't care whether the child succeeded or failed. Since <code>_exit</code> is guaranteed not to return, you don't need to put anything else after that.</p>\n\n<pre><code>if(pid == 0)\n{\n    printf(\"executing ls\\n\");\n    char *argv[] = {\"ls\", 0};\n    int fd = open(\"myexec.txt\", O_RDWR | O_CREAT, S_IRUSR | S_IWUSR);\n    dup2(fd, 1);\n    dup2(fd, 2);\n    close(fd);\n    execve(\"/bsin/ls\", &amp;argv[0], NULL);\n    fprintf(stderr, \"Failed to execute\");\n    _exit(EXIT_FAILURE);\n}\n</code></pre>\n"}], "owner": {"reputation": 281, "user_id": 4557453, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/98021faf61dfd92a09249c9fb7aad2a1?s=128&d=identicon&r=PG&f=1", "display_name": "TheValars", "link": "https://stackoverflow.com/users/4557453/thevalars"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 36046519, "answer_count": 1, "score": 0, "last_activity_date": 1458160886, "creation_date": 1458160728, "question_id": 36046471, "link": "https://stackoverflow.com/questions/36046471/ending-child-process-without-returning-a-value", "title": "Ending child process without returning a value", "body": "<p>I am basically creating a function which calls upon a unix built in function and redirect its output to <code>\"myexec.txt\"</code>. So i called on <code>open</code> and <code>dup2</code> in the child process. They redirect the output of <code>execve</code> to <code>\"myexec.txt\"</code>. Upon calling <code>execve</code>, the child process is terminated and every other standard output after the execution of <code>execve</code> will now be directed to the terminal. I am seeking a way to terminate the child process in case of an unsuccesul call to <code>execve</code>, in order to stop the output redirection to <code>myexec.txt</code>. I know using <code>exit</code> works but is there a way to kill this process without returning a value? My function needs to return <code>void</code>.  </p>\n\n<p>Here is my code chunk. I purposely give <code>execve</code> a non existent path.</p>\n\n<pre><code>void myexec()\n{\n    pid_t pid;\n    pid = fork();\n    if(pid == 0)\n    {\n        printf(\"executing ls\\n\");\n        char *argv[] = {\"ls\", 0};\n        int fd = open(\"myexec.txt\", O_RDWR | O_CREAT, S_IRUSR | S_IWUSR);\n        dup2(fd, 1);\n        dup2(fd, 2);\n        close(fd);\n        execve(\"/bsin/ls\", &amp;argv[0], NULL);\n        fprintf(stderr, \"Failed to execute\");\n        ......\n    }\n    wait(NULL);\n    printf(\"Function execution have been attempted\");\n}\n</code></pre>\n"}, {"tags": ["c", "validation", "date", "file-handling", "stdio"], "comments": [{"owner": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 0, "creation_date": 1458164014, "post_id": 36046040, "comment_id": 59743301, "body": "&quot;Couldn&#39;t write to the file&quot; is the canonical example of a bad error message. <code>fp = fopen(path, &quot;w&quot;); if( fp == NULL) { perror(path); ...</code>"}, {"owner": {"reputation": 547, "user_id": 5960243, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/aQmHU.jpg?s=128&g=1", "display_name": "Luis Averhoff", "link": "https://stackoverflow.com/users/5960243/luis-averhoff"}, "reply_to_user": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 0, "creation_date": 1458164421, "post_id": 36046040, "comment_id": 59743493, "body": "@WilliamPursell Thanks for the tip!"}], "answers": [{"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 547, "user_id": 5960243, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/aQmHU.jpg?s=128&g=1", "display_name": "Luis Averhoff", "link": "https://stackoverflow.com/users/5960243/luis-averhoff"}, "edited": false, "score": 0, "creation_date": 1458254006, "post_id": 36046961, "comment_id": 59791811, "body": "@Luis Averhoff &quot;Couldn&#39;t you have done <code>const char *p = str;</code>&#39; --&gt; Only if <code>str</code> points to a <i>string</i>.  If it points to a <i>string</i>, there is not need for the <code>size_t strDateLength</code>.  Seeing <code>size_t strDateLength</code> in the function signature implies to me that <code>char *str</code> may only point to a a character array and not to a <i>string</i>."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 547, "user_id": 5960243, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/aQmHU.jpg?s=128&g=1", "display_name": "Luis Averhoff", "link": "https://stackoverflow.com/users/5960243/luis-averhoff"}, "edited": false, "score": 0, "creation_date": 1458275845, "post_id": 36046961, "comment_id": 59797826, "body": "@Luis Averhoff The rest is for you to clean-up"}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": true, "score": 1, "last_activity_date": 1458163889, "last_edit_date": 1458163889, "creation_date": 1458162512, "answer_id": 36046961, "question_id": 36046040, "link": "https://stackoverflow.com/questions/36046040/validating-dates-from-a-file-that-is-redirected-as-input/36046961#36046961", "title": "Validating dates from a file that is redirected as input", "body": "<blockquote>\n  <p>... it works except for cases where the year is missing and to be frank I would like to know if there is way I could make this more concise ...</p>\n</blockquote>\n\n<p>Rather than make only a single function to parse the date, create a helper function to parse each integer.</p>\n\n<p>Untested code sample:</p>\n\n<pre><code>#include &lt;ctype.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;stdlib.h&gt;\n\n// Parse 1 int and optional following delimiter\n// Return NULL on error\nstatic const char *Get_int(const char *p, int *i, int endchar) {\n  if (p) {\n    char *endptr;\n    errno = 0;\n    long y = strtol(p, &amp;endptr, 10);\n    if (errno || p == endptr) return NULL;\n    *i = y;  // Test for INT_MIN... INT_MAX if desired\n\n    // skip following white-space\n    while (isspace((unsigned char ) *endptr))\n      endptr++;\n\n    // Look for delimiter\n    if (endchar) {\n      if (*endptr != endchar) return NULL;\n      endptr++;\n    }\n    return endptr;\n  }\n  return NULL;\n}\n\nint validateDateFormat(char *str, int *month, int *days, int *year, \n    size_t strDateLength) {\n  // form string\n  char temp[strDateLength + 1];\n  memcpy(temp, str, strDateLength);\n  temp[strDateLength] = '\\0';\n  const char *p = temp;\n\n  p = Get_int(p, month, '/');\n  p = Get_int(p, days, '/');\n  p = Get_int(p, year, 0);\n  return p &amp;&amp; *p == '\\0';\n}\n</code></pre>\n\n<p>A <code>sscanf()</code> approach:</p>\n\n<p>Use <code>\"%n\"</code> to detect if entire string was scanned.</p>\n\n<pre><code>int validateDateFormat(char *str, int *month, int *days, int *year, \n    size_t strDateLength) {\n  // form string\n  char temp[strDateLength + 1];\n  memcpy(temp, str, strDateLength);\n  temp[strDateLength] = '\\0';\n\n  int n = 0;\n  sscanf(temp, \"%d /%d /%d %n\", month, days, year, &amp;n);\n  return n &gt; 0 &amp;&amp; temp[n] == '\\0';\n)\n</code></pre>\n\n<hr>\n\n<p>Hacker exploit: Notice that the below code assumes <code>strDateLength &gt; 0</code>.  <code>fgets()</code> will happily read in as the first character the null character and continue reading until a <code>'\\n'</code> is encountered.</p>\n\n<p>As <code>strDateLength</code> is a <code>size_t</code>, an unsigned type, <code>0-1</code> is a huge value and <code>buffer[strDateLength - 1]</code> will certainly cause problems.</p>\n\n<pre><code>while(fgets(buffer, BUFFERSIZE, stdin)) {\n  strDateLength = strlen(buffer);\n  if(buffer[strDateLength - 1] != ...\n</code></pre>\n\n<p>BTW, no real need to add <code>'\\n'</code> anyways.</p>\n"}], "owner": {"reputation": 547, "user_id": 5960243, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/aQmHU.jpg?s=128&g=1", "display_name": "Luis Averhoff", "link": "https://stackoverflow.com/users/5960243/luis-averhoff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 36046961, "answer_count": 1, "score": 1, "last_activity_date": 1458163889, "creation_date": 1458159289, "last_edit_date": 1458161247, "question_id": 36046040, "link": "https://stackoverflow.com/questions/36046040/validating-dates-from-a-file-that-is-redirected-as-input", "title": "Validating dates from a file that is redirected as input", "body": "<p>First and foremost, this is a homework question.</p>\n\n<p>A file with a list of dates in the format of mm/dd/yyyy are to be redirected as input from the command prompt. Here is an example ./main.out &lt; file.txt. For every single valid date that I find, I'm suppose to write it to an output file.</p>\n\n<hr>\n\n<p>My professor has given a criteria on what constitutes an invalid date.</p>\n\n<p><strong>1.)</strong> if there are any non numeric characters like 12/4A/199A5.</p>\n\n<p><strong>2.)</strong> if they are missing their forward slashes or have more than 2 forward slashes.</p>\n\n<p><strong>3.)</strong> if they are floating points like 12/4/1995.3</p>\n\n<p><strong>4.)</strong> if they are incorrect dates like 2/29/1973 because 29 means that the year is suppose to be a leap year but 1973 is not divisible by 4 or 400.</p>\n\n<p><strong>5.)</strong> if there is no date(empty string) or parts of it are missing like 4/3/.</p>\n\n<hr>\n\n<p>Here examples of valid dates.</p>\n\n<p><strong>1.)</strong> dates with leading or trailing white-spaces like 12 /23/  1694   </p>\n\n<p><strong>2.)</strong> dates with leading zeros like 004/030/2000</p>\n\n<p><strong>3.)</strong> Any date with with month number between 1 and 12, correct day length(this depends on the month) and the year can be a positive number, negative or zero.</p>\n\n<hr>\n\n<p>Here is what I have done so far with only the relevant functions that are necessary.</p>\n\n<pre><code>int writeToFile()\n{\n    FILE *outputFile;\n    char buffer[BUFFERSIZE];\n    int month = 0, days = 0, year = 0;\n    int isValidFormat = 0, isValidDate = 0;\n    size_t strDateLength;\n\n    outputFile = fopen(\"Output.dat\", \"w\");\n\n    if(outputFile == NULL)\n    {\n        fprintf(stderr, \"Couldn't write to the file.\\n\");\n        return FALSE;\n    }\n\n    while(fgets(buffer, BUFFERSIZE, stdin))\n    {\n        strDateLength = strlen(buffer);\n\n        if(buffer[strDateLength - 1] != '\\n' &amp;&amp; strDateLength &lt;  BUFFERSIZE - 1)\n        {\n            appendNewLine(buffer, strDateLength);\n        }\n\n        isValidFormat = validateDateFormat(buffer, &amp;month, &amp;days, &amp;year, strDateLength);\n\n        if(isValidFormat)\n        {\n            isValidDate = validateDate(month, days, year);\n\n            if(isValidDate)\n            {\n                fprintf(outputFile, \"%s\", buffer);\n            }\n        }\n    }\n\n    fclose(outputFile);\n    return TRUE;\n}\n\nvoid appendNewLine(char *str, size_t strLength)\n{\n    str[strLength] = '\\n';\n    str[strLength + 1] = '\\0';\n}\n\nint validateDateFormat(char *str, int *month, int *days, int *year, size_t strDateLength)\n{\n    int index, index2 = 0;\n    char temp[BUFFERSIZE];\n    int numOfForwSlashes = 0;\n\n    for(index = 0; index &lt; strDateLength; index++)\n    {\n        if(str[index] == '/')\n        {\n            if(numOfForwSlashes == 0)\n            {\n                *month = atoi(temp);\n            }\n            else if(numOfForwSlashes == 1)\n            {\n                *days = atoi(temp);\n            }\n\n            numOfForwSlashes++;\n            memset(&amp;temp[0], 0, sizeof(temp));\n            index2 = 0;\n        }\n        else if(str[index] == '\\n')\n        {\n            *year = atoi(temp);\n        }\n        else if(!isdigit(str[index]) &amp;&amp; str[index] != ' ')\n        {\n            return FALSE;\n        }\n        else\n        {\n            temp[index2] = str[index];\n            index2++;\n        }\n    }\n\n    if(numOfForwSlashes != TOTALFORWARDSLASHES) // This define is 2\n    {\n        return FALSE;\n    }\n    else\n        return TRUE;\n}\n\nint validateDate(int month, int days, int year)\n{\n    if((month &lt; JANUARY || month &gt; DECEMBER) &amp;&amp; (days &lt; 1 || days &gt; THIRTYONE))\n    {\n        return FALSE;\n    }\n\n    if(month == FEBURARY)\n    {\n        if(isLeapYear(year))\n        {\n            if(days &gt; TWENTYNINE)\n            {\n                return FALSE;\n            }\n        }\n        else\n        {\n            if(days &gt; TWENTYEIGHT)\n            {\n                return FALSE;\n            }\n        }\n    }\n    else if(month == APRIL || month == JUNE || month == SEPTEMBER || month == NOVEMBER)\n    {\n        if(days &gt; THIRTY)\n        {\n            return FALSE;\n        }\n    }\n    else\n    {\n        if(days &gt; THIRTYONE)\n        {\n            return FALSE;\n        }\n    }\n\n    return TRUE;\n}\n</code></pre>\n\n<p><strong>Problem:</strong></p>\n\n<p>For the most part it works except for cases where the year is missing and to be frank I would like to know if there is way I could make this more concise while still following the citeria. Using sscanf or scanf doesn't solve every problem I have nor does string functions like strtok help that much.</p>\n"}, {"tags": ["c", "pointers", "matrix", "segmentation-fault", "exc-bad-access"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 6, "creation_date": 1458158015, "post_id": 36045682, "comment_id": 59739852, "body": "<code>*M = (int**)malloc(n * sizeof(int));</code> obviously wrong, compare the types."}, {"owner": {"reputation": 591, "user_id": 5731819, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/MXygy.png?s=128&g=1", "display_name": "BlackBox", "link": "https://stackoverflow.com/users/5731819/blackbox"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1458158194, "post_id": 36045682, "comment_id": 59739972, "body": "M passed as reference is a int *** and I have to get its original value. This currently works on my machine. I found out this because another PC having troubles plus my mac. What would be the right line anyway?"}, {"owner": {"reputation": 39539, "user_id": 153430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a446e1fd338fb334fa68b3f7470cd65b?s=128&d=identicon&r=PG", "display_name": "Jim Lewis", "link": "https://stackoverflow.com/users/153430/jim-lewis"}, "edited": false, "score": 3, "creation_date": 1458158311, "post_id": 36045682, "comment_id": 59740047, "body": "I think Sourav is talking about <code>sizeof(int)</code> versus <code>sizeof(int *)</code> in that line."}, {"owner": {"reputation": 15165, "user_id": 1116364, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b67dfca0caba03083330d39a304b1766?s=128&d=identicon&r=PG", "display_name": "Daniel Jour", "link": "https://stackoverflow.com/users/1116364/daniel-jour"}, "edited": false, "score": 4, "creation_date": 1458158454, "post_id": 36045682, "comment_id": 59740125, "body": "I&#39;m wondering why many beginners shy away from using the possibility to return values from their functions ..."}, {"owner": {"reputation": 591, "user_id": 5731819, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/MXygy.png?s=128&g=1", "display_name": "BlackBox", "link": "https://stackoverflow.com/users/5731819/blackbox"}, "edited": false, "score": 0, "creation_date": 1458158686, "post_id": 36045682, "comment_id": 59740238, "body": "sizeof(int *) doesn&#39;t work either."}, {"owner": {"reputation": 591, "user_id": 5731819, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/MXygy.png?s=128&g=1", "display_name": "BlackBox", "link": "https://stackoverflow.com/users/5731819/blackbox"}, "edited": false, "score": 0, "creation_date": 1458158742, "post_id": 36045682, "comment_id": 59740280, "body": "But returning the matrix directly from the function currently works (so declaring it in the function)"}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1458158875, "post_id": 36045682, "comment_id": 59740347, "body": "Change <code>*(*(mat+i)+j) = j+i*R</code> to <code>mat[i][j] = j+i*R</code>  More readable, and more likely to work."}, {"owner": {"reputation": 7668, "user_id": 2554472, "user_type": "registered", "profile_image": "https://graph.facebook.com/1119155584/picture?type=large", "display_name": "Mark Plotnick", "link": "https://stackoverflow.com/users/2554472/mark-plotnick"}, "edited": false, "score": 0, "creation_date": 1458159061, "post_id": 36045682, "comment_id": 59740457, "body": "On what line does xcode say the segmentation fault occurs?"}, {"owner": {"reputation": 591, "user_id": 5731819, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/MXygy.png?s=128&g=1", "display_name": "BlackBox", "link": "https://stackoverflow.com/users/5731819/blackbox"}, "edited": false, "score": 0, "creation_date": 1458159343, "post_id": 36045682, "comment_id": 59740634, "body": "<i>M = (int*</i>)malloc(n * sizeof(int));"}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1458159593, "post_id": 36045682, "comment_id": 59740794, "body": "@BlackBox That line does no occur in the code you&#39;ve posted."}, {"owner": {"reputation": 591, "user_id": 5731819, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/MXygy.png?s=128&g=1", "display_name": "BlackBox", "link": "https://stackoverflow.com/users/5731819/blackbox"}, "edited": false, "score": 0, "creation_date": 1458159686, "post_id": 36045682, "comment_id": 59740860, "body": "<code>*M = (int*)malloc(n * sizeof(int));</code>"}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1458159944, "post_id": 36045682, "comment_id": 59741003, "body": "@BlackBox: Neither does <i>that</i> line. Also, it&#39;s <i>extremely</i> for the crash to occur on that line."}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 1, "creation_date": 1458160617, "post_id": 36045682, "comment_id": 59741394, "body": "@BlackBox have you checked that none of your <code>malloc</code>s return <code>NULL</code>?"}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1458161243, "post_id": 36045682, "comment_id": 59741751, "body": "Are you <i>sure</i> you changed <code>*M = (int**)malloc(n * sizeof(int))</code> to <code>*M = (int**)malloc(n * sizeof(int *))</code> as Sourav Ghosh originally suggested?  When I run your original code under Xcode I get a segmentation fault (signal 11) just like you did, and when I fix that bug the crash goes away."}, {"owner": {"reputation": 591, "user_id": 5731819, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/MXygy.png?s=128&g=1", "display_name": "BlackBox", "link": "https://stackoverflow.com/users/5731819/blackbox"}, "edited": false, "score": 0, "creation_date": 1458164762, "post_id": 36045682, "comment_id": 59743656, "body": "My final comment is in the answer below. Thanks to everybody for your time guys!"}], "answers": [{"comments": [{"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1458162329, "post_id": 36046628, "comment_id": 59742378, "body": "he said that doesn&#39;t work in the comments, but I completely agree. On my 64-bit Mac sizeof pointers are 8 and sizeof ints are 4"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1458163394, "post_id": 36046628, "comment_id": 59742976, "body": "@yano &quot;it doesn&#39;t work&quot; is not a useful problem description"}, {"owner": {"reputation": 591, "user_id": 5731819, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/MXygy.png?s=128&g=1", "display_name": "BlackBox", "link": "https://stackoverflow.com/users/5731819/blackbox"}, "edited": false, "score": 0, "creation_date": 1458164506, "post_id": 36046628, "comment_id": 59743539, "body": "I don&#39;t know exactly what I was doing wrong earlier not to make work that either, but now is going perfect. I realized the mistake. Unfortunately I was also issued by some recommendation of passing the matrix as return type and not as parameter. Even being (maybe) a better programming style for this job, that wasn&#39;t helping me to resolve this problem. Ty and cheers!"}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1458169513, "post_id": 36046628, "comment_id": 59745697, "body": "@M.M I agree... I assumed he meant he was still getting the seg fault with the <code>sizeof int</code> to <code>sizeof int*</code> change. No matter now, he only thought he was."}], "tags": [], "owner": {"reputation": 16587, "user_id": 177053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f6c516626d381a1ea383cedd1799486?s=128&d=identicon&r=PG", "display_name": "Vasfed", "link": "https://stackoverflow.com/users/177053/vasfed"}, "is_accepted": true, "score": 4, "last_activity_date": 1458161291, "creation_date": 1458161291, "answer_id": 36046628, "question_id": 36045682, "link": "https://stackoverflow.com/questions/36045682/segmentation-fault-11-when-allocating-a-matrix/36046628#36046628", "title": "Segmentation Fault: 11 when allocating a matrix", "body": "<p><code>sizeof(int)</code> is not guaranteed to be equal to <code>sizeof(int*)</code>, so your allocated memory block is very likely to be too small. Writing to unallocated memory is undefined behaviour, sometimes it may work as expected, sometimes not.</p>\n"}], "owner": {"reputation": 591, "user_id": 5731819, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/MXygy.png?s=128&g=1", "display_name": "BlackBox", "link": "https://stackoverflow.com/users/5731819/blackbox"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 174, "favorite_count": 0, "accepted_answer_id": 36046628, "answer_count": 1, "score": 0, "last_activity_date": 1458161291, "creation_date": 1458157961, "last_edit_date": 1458160797, "question_id": 36045682, "link": "https://stackoverflow.com/questions/36045682/segmentation-fault-11-when-allocating-a-matrix", "title": "Segmentation Fault: 11 when allocating a matrix", "body": "<p>I get segmentation fault when using an allocated matrix and I don't understand why. This code currently works and doesn't work dependently from the computer</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n\nvoid allocMatrix(int ***M, int n, int m) {\n    *M = (int**)malloc(n * sizeof(int));\n    int i = 0;\n    while(i&lt;n) {\n        (*M)[i] = malloc(m * sizeof(int));\n        i++;\n    }\n}\n\n\nint main(void) {\n    int **mat;\n\n    int R, C;\n    R = 15;\n    C = 10;\n    allocMatrix(&amp;mat, R, C);\n    int i,j;\n    for(i = 0; i &lt; R; i++) {\n        for( j = 0; j &lt; C; j++) {\n             *(*(mat+i)+j) = j+i*R;\n        }\n    }\n#ifdef WIN32\n    system(\"pause\");\n#endif\n}\n</code></pre>\n\n<p>I get <code>segmentation fault: 11 or EXC BAD ACCESS</code> in Xcode. As said, happens only to some computers</p>\n"}, {"tags": ["c", "floating-point", "cs50"], "comments": [{"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 5, "creation_date": 1458158195, "post_id": 36045657, "comment_id": 59739974, "body": "Rounding error, n is probably 419. Use <code>n = round(f*100);</code>"}, {"owner": {"reputation": 1006, "user_id": 3888756, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mPnk1.jpg?s=128&g=1", "display_name": "DigitalNinja", "link": "https://stackoverflow.com/users/3888756/digitalninja"}, "edited": false, "score": 0, "creation_date": 1458158348, "post_id": 36045657, "comment_id": 59740064, "body": "It&#39;s probably because your program is straight edge."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 3, "creation_date": 1458158545, "post_id": 36045657, "comment_id": 59740175, "body": "<code>float f;</code> is already wrong. Never use floating point if you need exact values! With a little effort you will find this problem asked here  multiple times already."}, {"owner": {"reputation": 15165, "user_id": 1116364, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b67dfca0caba03083330d39a304b1766?s=128&d=identicon&r=PG", "display_name": "Daniel Jour", "link": "https://stackoverflow.com/users/1116364/daniel-jour"}, "edited": false, "score": 4, "creation_date": 1458158564, "post_id": 36045657, "comment_id": 59740189, "body": "Variable names can be (almost) any length. Use this wisely, by giving them descriptive names!"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 15165, "user_id": 1116364, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b67dfca0caba03083330d39a304b1766?s=128&d=identicon&r=PG", "display_name": "Daniel Jour", "link": "https://stackoverflow.com/users/1116364/daniel-jour"}, "edited": false, "score": 0, "creation_date": 1458158734, "post_id": 36045657, "comment_id": 59740274, "body": "@DanielJour: Actually it&#39;s at least 63 characters (see the standard, 5.2.4.1)."}, {"owner": {"reputation": 15165, "user_id": 1116364, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b67dfca0caba03083330d39a304b1766?s=128&d=identicon&r=PG", "display_name": "Daniel Jour", "link": "https://stackoverflow.com/users/1116364/daniel-jour"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1458158821, "post_id": 36045657, "comment_id": 59740323, "body": "@Olaf I know. Long enough to be descriptive. It seems to be a common failure of tutorials as well as training courses to just use one-letter variable names without any thought."}, {"owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 3, "creation_date": 1458158852, "post_id": 36045657, "comment_id": 59740337, "body": "@Olaf: There is nothing wrong with <code>float</code> when you&#39;re required to get a <code>float</code> from the user (I assume that&#39;s what the <code>GetFloat</code> function is returning). The OP is doing the right thing by converting to <code>int</code> early on, they just forgot to account for IEEE float imprecision and didn&#39;t round prior to conversion to <code>int</code> cents."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1458158924, "post_id": 36045657, "comment_id": 59740380, "body": "Yeah, one can use <code>longDescriptiveName1, longDescriptiveName2, longDescriptiveName3</code>... :)"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "edited": false, "score": 1, "creation_date": 1458159032, "post_id": 36045657, "comment_id": 59740443, "body": "@ShadowRanger: No. It already starts with input values not being exactly representable in a floating point variable. There are other ways, e.g. simulate inputting a float by two integers. For currency input you don&#39;t need scientific notiation input."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1458159135, "post_id": 36045657, "comment_id": 59740502, "body": "@EugeneSh.: I actually prefer <code>__local_variable_nesting_level_42_i</code>, <code>__local_variable_nesting_level_23_j</code>. But everyone as she wishes."}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 1, "creation_date": 1458161413, "post_id": 36045657, "comment_id": 59741862, "body": "NEVER, NEVER, NEVER, under any circumstances, use <i>float</i> or <i>double</i> for money."}], "answers": [{"comments": [{"owner": {"reputation": 15008, "user_id": 16582, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/febff21383acf755f8b375c322e36f2b?s=128&d=identicon&r=PG", "display_name": "ravenspoint", "link": "https://stackoverflow.com/users/16582/ravenspoint"}, "edited": false, "score": 1, "creation_date": 1458159491, "post_id": 36045999, "comment_id": 59740726, "body": "It is not a matter of imprecision, but of the number base.  The user is using base 10, but the code is using base 2 which does not have an exact equivalence."}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "reply_to_user": {"reputation": 15008, "user_id": 16582, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/febff21383acf755f8b375c322e36f2b?s=128&d=identicon&r=PG", "display_name": "ravenspoint", "link": "https://stackoverflow.com/users/16582/ravenspoint"}, "edited": false, "score": 2, "creation_date": 1458159684, "post_id": 36045999, "comment_id": 59740859, "body": "@ravenspoint What you describe is the <i>reason</i> for the imprecision."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1458160066, "post_id": 36045999, "comment_id": 59741066, "body": "Better to use <code>round(f * 100);</code>  <code>f * 100 + 0.5;</code> fails for many negative numbers, <code>f</code> just less than 0.5 and many <code>f</code> whose ULP is 0.5 or 0.25."}, {"owner": {"reputation": 15008, "user_id": 16582, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/febff21383acf755f8b375c322e36f2b?s=128&d=identicon&r=PG", "display_name": "ravenspoint", "link": "https://stackoverflow.com/users/16582/ravenspoint"}, "reply_to_user": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1458161154, "post_id": 36045999, "comment_id": 59741689, "body": "@Ctx It is important to understand the reason.  If you do not know, you might think that changing from floats to doubles would help.  It wouldn&#39;t.  Although doubles are more precise, they do not have exact equivalents of base 10."}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "reply_to_user": {"reputation": 15008, "user_id": 16582, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/febff21383acf755f8b375c322e36f2b?s=128&d=identicon&r=PG", "display_name": "ravenspoint", "link": "https://stackoverflow.com/users/16582/ravenspoint"}, "edited": false, "score": 1, "creation_date": 1458161224, "post_id": 36045999, "comment_id": 59741736, "body": "@ravenspoint Yes, it was fine that you explicitely stated the reason here, it should probably even be appended to the answer above. I just didn&#39;t agree not to call it &quot;imprecision&quot;"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1458162802, "post_id": 36045999, "comment_id": 59742669, "body": "<code>round</code> should always be used. Another problem with <code>0.5</code> is failure for large numbers where the distance between adjacent floats is getting towards the magnitude of 1"}], "tags": [], "owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "is_accepted": false, "score": 3, "last_activity_date": 1458159099, "creation_date": 1458159099, "answer_id": 36045999, "question_id": 36045657, "link": "https://stackoverflow.com/questions/36045657/i-am-not-sure-why-my-code-is-producing-this-arithmetic-error/36045999#36045999", "title": "I am not sure why my code is producing this arithmetic error?", "body": "<p><a href=\"https://en.wikipedia.org/wiki/IEEE_floating_point\" rel=\"nofollow\">IEEE 754 floating point</a> is often slightly imprecise, and casting will truncate, not round. What's likely happening is that <code>4.20 * 100</code> evaluates to <code>419.999999999999994</code> (exact number is immaterial, point is, it's not quite 420), and the conversion to <code>int</code> drops the decimal portion, producing 419.</p>\n\n<p>The simple approach is to just do:</p>\n\n<pre><code>n = f * 100 + 0.5;\n</code></pre>\n\n<p>or you can use a proper function:</p>\n\n<pre><code>n = round(f * 100);\n</code></pre>\n\n<p>If the number is \"almost\" exact, either one will be fine, you'd only get discrepancies when someone passed non-integer cents (<code>\"4.195\"</code> or the like), and if you're using <code>float</code> for monetary values, you've already accepted precision issues in the margins; if you want exact numbers, you'd use the <a href=\"https://en.wikipedia.org/wiki/IEEE_floating_point#Basic_and_interchange_formats\" rel=\"nofollow\"><code>decimal</code></a> formats that have fixed precision for decimal values, and are intended for financial calculations.</p>\n"}, {"comments": [{"owner": {"reputation": 98, "user_id": 6005220, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7076643bd014e005ca669ef78dcd594b?s=128&d=identicon&r=PG&f=1", "display_name": "Ravi", "link": "https://stackoverflow.com/users/6005220/ravi"}, "edited": false, "score": 0, "creation_date": 1458161540, "post_id": 36046656, "comment_id": 59741948, "body": "@patrick-leppink-shands This is to provide 2 digit precision."}, {"owner": {"reputation": 98, "user_id": 6005220, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7076643bd014e005ca669ef78dcd594b?s=128&d=identicon&r=PG&f=1", "display_name": "Ravi", "link": "https://stackoverflow.com/users/6005220/ravi"}, "edited": false, "score": 0, "creation_date": 1458161770, "post_id": 36046656, "comment_id": 59742071, "body": "@patrick-leppink-shands, As far as the coding style is concerned use comments to explain specific parts of the code, make use of a bit more descriptive names for variables, proper indentation, use blank lines to be easy on the eyes etc."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1458162713, "post_id": 36046656, "comment_id": 59742612, "body": "This doesn&#39;t avoid the problem"}, {"owner": {"reputation": 38863, "user_id": 2415822, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zxy7G.jpg?s=128&g=1", "display_name": "JAL", "link": "https://stackoverflow.com/users/2415822/jal"}, "edited": false, "score": 0, "creation_date": 1458169872, "post_id": 36046656, "comment_id": 59745821, "body": "Adding an explanation of how this code answers the question will improve your answer for future visitors (this answer was flagged as low-quality)."}, {"owner": {"reputation": 98, "user_id": 6005220, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7076643bd014e005ca669ef78dcd594b?s=128&d=identicon&r=PG&f=1", "display_name": "Ravi", "link": "https://stackoverflow.com/users/6005220/ravi"}, "reply_to_user": {"reputation": 38863, "user_id": 2415822, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zxy7G.jpg?s=128&g=1", "display_name": "JAL", "link": "https://stackoverflow.com/users/2415822/jal"}, "edited": false, "score": 0, "creation_date": 1458172639, "post_id": 36046656, "comment_id": 59746796, "body": "@JAL, it is a tested code.  It essentially works by rounding up the precision for two digits, before assignment.  Please try it yourself.  I would highly recommend not to flag the answers without convincing yourself first."}, {"owner": {"reputation": 98, "user_id": 6005220, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7076643bd014e005ca669ef78dcd594b?s=128&d=identicon&r=PG&f=1", "display_name": "Ravi", "link": "https://stackoverflow.com/users/6005220/ravi"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1458172704, "post_id": 36046656, "comment_id": 59746822, "body": "@M.M, please clarify, how doesn&#39;t it solve/avoid the problem?"}, {"owner": {"reputation": 38863, "user_id": 2415822, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zxy7G.jpg?s=128&g=1", "display_name": "JAL", "link": "https://stackoverflow.com/users/2415822/jal"}, "edited": false, "score": 0, "creation_date": 1458173105, "post_id": 36046656, "comment_id": 59746960, "body": "@Ravi I didn&#39;t flag the answer, it came up as I was reviewing the low quality posts queue."}, {"owner": {"reputation": 98, "user_id": 6005220, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7076643bd014e005ca669ef78dcd594b?s=128&d=identicon&r=PG&f=1", "display_name": "Ravi", "link": "https://stackoverflow.com/users/6005220/ravi"}, "reply_to_user": {"reputation": 38863, "user_id": 2415822, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zxy7G.jpg?s=128&g=1", "display_name": "JAL", "link": "https://stackoverflow.com/users/2415822/jal"}, "edited": false, "score": 0, "creation_date": 1458173234, "post_id": 36046656, "comment_id": 59747001, "body": "@JAL, thanks for clarifying it. I am a new user to stack exchange/overflow and just getting acquainted with the nuances of using the features to post answers :-)"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1458173791, "post_id": 36046656, "comment_id": 59747156, "body": "If the real value is 4.1999999 for example (as shown in ShadowRanger&#39;s answer), then you do 4199.9999/10 which is still 419.999.  You are basically rolling a dice and hoping it lands on 420 instead of 419"}, {"owner": {"reputation": 98, "user_id": 6005220, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7076643bd014e005ca669ef78dcd594b?s=128&d=identicon&r=PG&f=1", "display_name": "Ravi", "link": "https://stackoverflow.com/users/6005220/ravi"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1458244414, "post_id": 36046656, "comment_id": 59786986, "body": "@M.M, I tested the code (didn&#39;t roll a dice) like I mentioned above and see my comment about 2 digit precision also. Did you try it in the first place before posting a comment?"}, {"owner": {"reputation": 98, "user_id": 6005220, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7076643bd014e005ca669ef78dcd594b?s=128&d=identicon&r=PG&f=1", "display_name": "Ravi", "link": "https://stackoverflow.com/users/6005220/ravi"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1458245291, "post_id": 36046656, "comment_id": 59787541, "body": "@M.M,  How much change do you need? 4.1999999 Value entered : 4.200000 Quarters needed : 16 Dimes needed : 2 5 Cents needed : 0 Cents needed : 0 Total coins needed : 18 Program ended with exit code: 0"}, {"owner": {"reputation": 98, "user_id": 6005220, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7076643bd014e005ca669ef78dcd594b?s=128&d=identicon&r=PG&f=1", "display_name": "Ravi", "link": "https://stackoverflow.com/users/6005220/ravi"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1458245315, "post_id": 36046656, "comment_id": 59787558, "body": "@M.M, How much change do you need? 4.20 Value entered : 4.200000 Quarters needed : 16 Dimes needed : 2 5 Cents needed : 0 Cents needed : 0 Total coins needed : 18 Program ended with exit code: 0"}, {"owner": {"reputation": 98, "user_id": 6005220, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7076643bd014e005ca669ef78dcd594b?s=128&d=identicon&r=PG&f=1", "display_name": "Ravi", "link": "https://stackoverflow.com/users/6005220/ravi"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1458245892, "post_id": 36046656, "comment_id": 59787915, "body": "@M.M, more   How much change do you need? 4.1999999 Value entered : 4.200000 f *= 1000 : 4200.000000 f /= 10 : 420.000000 n = f : 420"}, {"owner": {"reputation": 98, "user_id": 6005220, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7076643bd014e005ca669ef78dcd594b?s=128&d=identicon&r=PG&f=1", "display_name": "Ravi", "link": "https://stackoverflow.com/users/6005220/ravi"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1458245943, "post_id": 36046656, "comment_id": 59787942, "body": "@M.M, How much change do you need? 4.20 Value entered : 4.200000 f *= 1000 : 4200.000000 f /= 10 : 420.000000 n = f : 420"}, {"owner": {"reputation": 98, "user_id": 6005220, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7076643bd014e005ca669ef78dcd594b?s=128&d=identicon&r=PG&f=1", "display_name": "Ravi", "link": "https://stackoverflow.com/users/6005220/ravi"}, "edited": false, "score": 0, "creation_date": 1458246531, "post_id": 36046656, "comment_id": 59788252, "body": "@M,M, by changing float f to double f, the result is more accurate.  How much change do you need? 4.1999999 Value entered : 4.200000 f *= 1000 : 4199.999900 f /= 10 : 419.999990 n = f : 419 Quarters needed : 16 Dimes needed : 1 5 Cents needed : 1 Cents needed : 4 Total coins needed : 22  How much change do you need? 4.20 Value entered : 4.200000 f *= 1000 : 4200.000000 f /= 10 : 420.000000 n = f : 420 Quarters needed : 16 Dimes needed : 2 5 Cents needed : 0 Cents needed : 0 Total coins needed : 18"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1458248128, "post_id": 36046656, "comment_id": 59789090, "body": "@Ravi other people may get different results to you"}, {"owner": {"reputation": 98, "user_id": 6005220, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7076643bd014e005ca669ef78dcd594b?s=128&d=identicon&r=PG&f=1", "display_name": "Ravi", "link": "https://stackoverflow.com/users/6005220/ravi"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1458269999, "post_id": 36046656, "comment_id": 59796400, "body": "@M.M then, there are standards, then portability of code in C/C++ and math library and it&#39;s implementation, representation of floating/double in the processor.  So, I recommended a solution based on the test results.  One may have to experiment with their system to see how it works for them. Using round(), ceil(), floor() etc., which could resulting in entirely different results."}, {"owner": {"reputation": 230, "user_id": 5639737, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3rBEx.png?s=128&g=1", "display_name": "Jojonete", "link": "https://stackoverflow.com/users/5639737/jojonete"}, "edited": false, "score": 1, "creation_date": 1458302661, "post_id": 36046656, "comment_id": 59811921, "body": "@Ravi Trying things &quot;to see how it works for you&quot; is exactly what should be avoided. Standards are there so that all implementations behave the same way (at least to an extent), so solutions work on all systems and no trial/error is needed. For this case, the real solution is to avoid <code>float</code> or <code>double</code> data types, and if this is completely impossible then <code>round()</code> is the best one can hope for. Your solution uses <code>floor()</code> which leads exactly into the kind of problem described in the question. I don&#39;t intend to be harsher than necessary but I&#39;m adding my downvote."}, {"owner": {"reputation": 98, "user_id": 6005220, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7076643bd014e005ca669ef78dcd594b?s=128&d=identicon&r=PG&f=1", "display_name": "Ravi", "link": "https://stackoverflow.com/users/6005220/ravi"}, "reply_to_user": {"reputation": 230, "user_id": 5639737, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3rBEx.png?s=128&g=1", "display_name": "Jojonete", "link": "https://stackoverflow.com/users/5639737/jojonete"}, "edited": false, "score": 0, "creation_date": 1458312850, "post_id": 36046656, "comment_id": 59819376, "body": "@Jojonete, I think you mistook the whole point I was making. Standards are there make the code portable and so algorithms.  Rounding isn&#39;t the best option in this case. What I tried to show is that despite of using all the standards, you will still see the variations.  I would highly recommend folks who comment should make an effort to solve the problems and come with ideas and not just be happy voters.  Just think of how would you solve the problem without math library functions?"}, {"owner": {"reputation": 98, "user_id": 6005220, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7076643bd014e005ca669ef78dcd594b?s=128&d=identicon&r=PG&f=1", "display_name": "Ravi", "link": "https://stackoverflow.com/users/6005220/ravi"}, "reply_to_user": {"reputation": 230, "user_id": 5639737, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3rBEx.png?s=128&g=1", "display_name": "Jojonete", "link": "https://stackoverflow.com/users/5639737/jojonete"}, "edited": false, "score": 0, "creation_date": 1458315993, "post_id": 36046656, "comment_id": 59821636, "body": "@Jojonete, I would go one step further. Algorithms should work irrespective of programming languages.  It is the internal representation and division and multiplication operations that makes the difference.  For further background consult computer numerical analysis material and see how the imprecision accumulates over."}], "tags": [], "owner": {"reputation": 98, "user_id": 6005220, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7076643bd014e005ca669ef78dcd594b?s=128&d=identicon&r=PG&f=1", "display_name": "Ravi", "link": "https://stackoverflow.com/users/6005220/ravi"}, "is_accepted": false, "score": -2, "last_activity_date": 1458315745, "last_edit_date": 1458315745, "creation_date": 1458161367, "answer_id": 36046656, "question_id": 36045657, "link": "https://stackoverflow.com/questions/36045657/i-am-not-sure-why-my-code-is-producing-this-arithmetic-error/36046656#36046656", "title": "I am not sure why my code is producing this arithmetic error?", "body": "<p>Try this: Provides up to 2 digit precision.</p>\n\n<pre><code>//float f\ndouble f\n\nf *= 1000;\nf = floor(f);  /* optional */\nf /= 10;\nf = floor(f);  /* optional */\nn = f;\n</code></pre>\n"}], "owner": {"reputation": 69, "user_id": 6073549, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153270778427024/picture?type=large", "display_name": "Patrick Leppink-Shands", "link": "https://stackoverflow.com/users/6073549/patrick-leppink-shands"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 153, "favorite_count": 0, "answer_count": 2, "score": 4, "last_activity_date": 1470552163, "creation_date": 1458157905, "last_edit_date": 1470552163, "question_id": 36045657, "link": "https://stackoverflow.com/questions/36045657/i-am-not-sure-why-my-code-is-producing-this-arithmetic-error", "title": "I am not sure why my code is producing this arithmetic error?", "body": "<p>Hey everybody I am working on a program in c that tells you the least number of coins needed for any given amount of money. I have a program written that works for for every amount I have tested except for $4.20.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>#include &lt;cs50.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\n\nint main(void)\n{\n    float f;\n    int n, x, y, z, q, s, d, t;\n\n    do {\n        printf(\"How much change do you need?\\n\");\n        f = GetFloat();\n    } while(f &lt;= 0);\n\n    {\n        n = (f * 100);\n    }\n\n    q = (n / 25);\n    x = (n % 25);\n    y = (x / 10);\n    z = (x % 10);\n    s = (z / 5);\n    d = (z % 5);\n    t = (q + y + s + d);\n\n    {\n        printf(\"%d\\n\" ,t);\n    }\n}\n</code></pre>\n\n<p>The strange thing is when I input 4.20 the output is 22 instead of 18 (16 quarters and 2 dimes). I did some sleuthing and found that the problem is with my variable x. When I input 4.2, x gives me 19 and not 20 like it should. I tried other cases that I thought should have produced the same problem like 5.2 and 1.2 but it worked correctly in those cases. It might be a rounding issue but I would think that same error would also happen with those similar values.</p>\n\n<p>Does anyone have an idea about why this might be happening? </p>\n\n<p>PS I am fairly new to coding and I haven't gotten much formal instruction so I also welcome tips on better indentation and formatting if you see anything obvious.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user824425"}, "edited": false, "score": 3, "creation_date": 1458158178, "post_id": 36045654, "comment_id": 59739959, "body": "Your example arrays are not square."}, {"owner": {"reputation": 15165, "user_id": 1116364, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b67dfca0caba03083330d39a304b1766?s=128&d=identicon&r=PG", "display_name": "Daniel Jour", "link": "https://stackoverflow.com/users/1116364/daniel-jour"}, "edited": false, "score": 0, "creation_date": 1458158700, "post_id": 36045654, "comment_id": 59740246, "body": "Exchange the for loops, after the then inner loop set the last value of the current row to the sum."}, {"owner": {"reputation": 1, "user_id": 6073558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/770488e9fa3fb956becc42909aa8210a?s=128&d=identicon&r=PG&f=1", "display_name": "dragon222", "link": "https://stackoverflow.com/users/6073558/dragon222"}, "edited": false, "score": 0, "creation_date": 1458160401, "post_id": 36045654, "comment_id": 59741269, "body": "Can you re-explain? I think the wording is confusing me."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6073558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/770488e9fa3fb956becc42909aa8210a?s=128&d=identicon&r=PG&f=1", "display_name": "dragon222", "link": "https://stackoverflow.com/users/6073558/dragon222"}, "edited": false, "score": 0, "creation_date": 1458160667, "post_id": 36045991, "comment_id": 59741421, "body": "Thanks that makes sense"}], "tags": [], "owner": {"reputation": 3197, "user_id": 5853530, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/3b9567983f2e1d6c2315fa26202accb6?s=128&d=identicon&r=PG&f=1", "display_name": "Rajeev Singh", "link": "https://stackoverflow.com/users/5853530/rajeev-singh"}, "is_accepted": false, "score": 0, "last_activity_date": 1458159413, "last_edit_date": 1458159413, "creation_date": 1458159072, "answer_id": 36045991, "question_id": 36045654, "link": "https://stackoverflow.com/questions/36045654/c-how-do-i-add-up-numbers-in-a-row-and-then-add-them-to-the-end/36045991#36045991", "title": "C: How do I add up numbers in a row and then add them to the end?", "body": "<p>(Assuming square matrix) Modify your code like that:</p>\n\n<pre><code>void newmatrix(int array[][], int sizeofmatrix)\n{\n     int row,col; \n     int sum; \n     for(row = 0; row &lt; sizeofmatrix; row++)\n     { \n         sum=0; // sum should be initialized to 0 for each row\n         for(col = 0; col &lt; sizeofmatrix; col++)\n         {\n             sum += array[row][col];\n         } \n         array[row][col-1]=sum; // Add the sum in last col\n      } \n  } \n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6073558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/770488e9fa3fb956becc42909aa8210a?s=128&d=identicon&r=PG&f=1", "display_name": "dragon222", "link": "https://stackoverflow.com/users/6073558/dragon222"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1458159413, "creation_date": 1458157882, "question_id": 36045654, "link": "https://stackoverflow.com/questions/36045654/c-how-do-i-add-up-numbers-in-a-row-and-then-add-them-to-the-end", "title": "C: How do I add up numbers in a row and then add them to the end?", "body": "<p>So I already have a 2D (square) array of random integers, but I need to make a function to add up each row, then put that sum in the last column. \nKind of like: (Just using random number here. As I said, it generates a random matrix.) </p>\n\n<pre><code>1 2 3 4\n5 6 7 8 \n9 1 2 0 \n</code></pre>\n\n<p>Needs to be: </p>\n\n<pre><code>1 2 3 10\n5 6 7 26 \n9 1 2 12 \n</code></pre>\n\n<p>So far I have this: </p>\n\n<pre><code>void newmatrix(int array[][], int sizeofmatrix)\n{\n     int row, col; \n     int sum = 0; \n     for(col = 0; col &lt; size; col++)\n     { \n         for(row = 0; row &lt; size; row++)\n         {\n             sum += array[row][col];\n         } \n      } \n  } \n</code></pre>\n\n<p>Do I have the right idea? And how do I proceed? </p>\n"}, {"tags": ["c++", "c", "gcc", "static-libraries"], "comments": [{"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1458160229, "post_id": 36044996, "comment_id": 59741169, "body": "I added another script to do the task you want. Does it help you?"}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1458164647, "post_id": 36044996, "comment_id": 59743621, "body": "You get <code>bar</code> as undefined in <code>foo.o</code>, and <code>missing</code> as undefined in <code>bar.o</code>, both of which are correct. Unclear what you&#39;re asking for. <code>nm</code> isn&#39;t a linker."}], "answers": [{"comments": [{"owner": {"reputation": 360, "user_id": 2402092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6f86b405b842bb73a31293545c59004?s=128&d=identicon&r=PG", "display_name": "flapenguin", "link": "https://stackoverflow.com/users/2402092/flapenguin"}, "edited": false, "score": 0, "creation_date": 1458156342, "post_id": 36045066, "comment_id": 59738802, "body": "I undestand that <code>ar</code> is just and archiver, but I hoped <code>nm</code> or some other tool can &quot;match&quot; defined and undefined symbols in whole archive."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 360, "user_id": 2402092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6f86b405b842bb73a31293545c59004?s=128&d=identicon&r=PG", "display_name": "flapenguin", "link": "https://stackoverflow.com/users/2402092/flapenguin"}, "edited": false, "score": 3, "creation_date": 1458156980, "post_id": 36045066, "comment_id": 59739211, "body": "@flapenguin, nope. ar archive is not much different from zip archive. It is merely a collection of .o files (and a symbol table). And nm <b>never</b> matches anything. It works with a single file and basically prints object file structure."}], "tags": [], "owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "is_accepted": false, "score": 2, "last_activity_date": 1458155976, "creation_date": 1458155976, "answer_id": 36045066, "question_id": 36044996, "link": "https://stackoverflow.com/questions/36044996/nm-get-undefined-symbols-for-whole-archive-not-separate-object-files/36045066#36045066", "title": "nm get undefined symbols for whole archive, not separate object files", "body": "<p>The archival tool just creates ... well, an archive. It's not a linker. References are resolved by your linker, and this process will find <code>foo.o</code>'s reference to <code>bar</code> to be resolved in <code>bar.o</code>. The archiver can't do that, and <code>nm</code> won't do it either - it's just running itself over each object inside the archive, independently.</p>\n"}, {"tags": [], "owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "is_accepted": true, "score": 3, "last_activity_date": 1458223105, "last_edit_date": 1458223105, "creation_date": 1458156321, "answer_id": 36045180, "question_id": 36044996, "link": "https://stackoverflow.com/questions/36044996/nm-get-undefined-symbols-for-whole-archive-not-separate-object-files/36045180#36045180", "title": "nm get undefined symbols for whole archive, not separate object files", "body": "<p>Link the whole archive into a single object file and check that:</p>\n\n<pre><code>ar -x libfoo.a      # unpack libfoo.a\nld -r -o tmp.o *.o  # link all objects into tmp.o\nnm -u tmp.o         # find undefined symbols in tmp.o\nrm *.o              # remove tmp.o as well as the contents of libfoo.a\n</code></pre>\n\n<p>This should give the desired result as the linker resolves all symbols it can find in the partial link requested by <code>-r</code>.</p>\n\n<p>Note that the current working directory should not contain any object files for best results.</p>\n\n<p>You can use the following script for more consistent results:</p>\n\n<pre><code># use: script libfoo.a\ntmp=${TEMPDIR:-/tmp}/undefsyms.$$\nmkdir $tmp\ncp $1 $tmp/lib.a\ncd $tmp\nar -x lib.a\nld -r -o $$.o *.o\nnm -u $$.o\nrm *\ncd ..\nrmdir $tmp\n</code></pre>\n\n<p>If you feel uncomfortable unpacking and linking the library for this purpose, use this script which uses command line utilities to compute the information you need using the <code>join</code> utility:</p>\n\n<pre><code>if [ $# -lt 1 ]\nthen\n    echo Usage: $0 library.a\n    exit 1\nfi\n\nlib=$1\n\npostproc() { cut -w -f 2-3 | sort -u; }\nallsyms() { nm -g -P -A $lib | postproc; }\nundefsyms() { nm -g -P -A -u $lib | postproc; }\ndefsyms() { allsyms | grep -v 'U$'; }\n\ncomm -2 -3 &lt;(undefsyms | cut -w -f 1) &lt;(defsyms | cut -w -f 1)\n</code></pre>\n"}], "owner": {"reputation": 360, "user_id": 2402092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6f86b405b842bb73a31293545c59004?s=128&d=identicon&r=PG", "display_name": "flapenguin", "link": "https://stackoverflow.com/users/2402092/flapenguin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1350, "favorite_count": 2, "accepted_answer_id": 36045180, "answer_count": 2, "score": 4, "last_activity_date": 1458223105, "creation_date": 1458155729, "question_id": 36044996, "link": "https://stackoverflow.com/questions/36044996/nm-get-undefined-symbols-for-whole-archive-not-separate-object-files", "title": "nm get undefined symbols for whole archive, not separate object files", "body": "<p>I have two files:</p>\n\n<p><code>foo.c</code>: <code>int foo() { extern int bar(); return bar(); }</code></p>\n\n<p><code>bar.c</code>: <code>int bar() { extern int missing(); return missing() + 42; }</code></p>\n\n<p>I compile them and and compose into <code>.a</code> static lib:</p>\n\n<pre><code>$ gcc -c foo.c bar.c\n$ ar rcs libfoobar.a foo.o bar.o\n</code></pre>\n\n<p>I want to find which symbols are missing (undefined) from whole archive. But I still get <code>bar</code> as undefined, while it exists in <code>foo.o</code>:</p>\n\n<pre><code>$ nm -u libfoobar.a\nfoo.o:\n    U bar\nbar.o:\n    U missing\n</code></pre>\n\n<p>How can I omit <code>bar</code> from output and show only <code>missing</code>?</p>\n"}, {"tags": ["c++", "c"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1458155358, "post_id": 36044743, "comment_id": 59738207, "body": "You should really check for error from <i>all</i> system calls."}, {"owner": {"reputation": 119, "user_id": 3223959, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/5vkUM.jpg?s=128&g=1", "display_name": "Khacho", "link": "https://stackoverflow.com/users/3223959/khacho"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1458155381, "post_id": 36044743, "comment_id": 59738219, "body": "Ya sorry, edited. Didn&#39;t effect the output though."}, {"owner": {"reputation": 119, "user_id": 3223959, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/5vkUM.jpg?s=128&g=1", "display_name": "Khacho", "link": "https://stackoverflow.com/users/3223959/khacho"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1458155492, "post_id": 36044743, "comment_id": 59738281, "body": "Let me try. Thanks"}], "answers": [{"comments": [{"owner": {"reputation": 119, "user_id": 3223959, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/5vkUM.jpg?s=128&g=1", "display_name": "Khacho", "link": "https://stackoverflow.com/users/3223959/khacho"}, "edited": false, "score": 0, "creation_date": 1458156125, "post_id": 36044942, "comment_id": 59738664, "body": "How do I make the reader to read the pipe as soon as writer starts writing? thanks for the reply"}, {"owner": {"reputation": 33990, "user_id": 14768, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/b6aMa.png?s=128&g=1", "display_name": "Joshua", "link": "https://stackoverflow.com/users/14768/joshua"}, "reply_to_user": {"reputation": 119, "user_id": 3223959, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/5vkUM.jpg?s=128&g=1", "display_name": "Khacho", "link": "https://stackoverflow.com/users/3223959/khacho"}, "edited": false, "score": 0, "creation_date": 1458156419, "post_id": 36044942, "comment_id": 59738838, "body": "It&#39;s the other way around. The reader needs to be reading before the writer starts writing. The reader will repeatedly get EOF until the writer is attached to the pipe."}], "tags": [], "owner": {"reputation": 33990, "user_id": 14768, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/b6aMa.png?s=128&g=1", "display_name": "Joshua", "link": "https://stackoverflow.com/users/14768/joshua"}, "is_accepted": true, "score": 1, "last_activity_date": 1458155584, "creation_date": 1458155584, "answer_id": 36044942, "question_id": 36044743, "link": "https://stackoverflow.com/questions/36044743/pipe-broken-fifo-file/36044942#36044942", "title": "Pipe Broken, FIFO file", "body": "<p>Your write happens before you start your reader. When you write to a pipe and it has no reader you get SIGPIPE.</p>\n\n<p>In this particular design, you need to <em>handle</em> SIGPIPE with retry logic.</p>\n"}, {"tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": false, "score": 1, "last_activity_date": 1458155660, "creation_date": 1458155660, "answer_id": 36044969, "question_id": 36044743, "link": "https://stackoverflow.com/questions/36044743/pipe-broken-fifo-file/36044969#36044969", "title": "Pipe Broken, FIFO file", "body": "<p>The error you get is <code>EPIPE</code> and if you read a <a href=\"http://man7.org/linux/man-pages/man2/write.2.html\" rel=\"nofollow\"><code>write</code></a> manual you will see that you get <code>EPIPE</code> when</p>\n\n<blockquote>\n  <p><code>fd</code> is connected to a pipe or socket whose reading end is closed.</p>\n</blockquote>\n\n<p>You get this error because you open the reading end of the pipe in non-blocking mode, which means the <code>read</code> call will not block and wait for data to be received, instead when the <code>read</code> call immediately return you close the pipe and exit the process.</p>\n\n<p>That means when you run the writer there is no one waiting for the data you write and you get the error.</p>\n\n<p>You need to run the read and the writer in opposite order: First the writer so it writes to the pipe, and <em>then</em> the reader to read the data from the pipe.</p>\n"}], "owner": {"reputation": 119, "user_id": 3223959, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/5vkUM.jpg?s=128&g=1", "display_name": "Khacho", "link": "https://stackoverflow.com/users/3223959/khacho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1200, "favorite_count": 0, "accepted_answer_id": 36044942, "answer_count": 2, "score": 0, "last_activity_date": 1458156294, "creation_date": 1458154928, "last_edit_date": 1458156294, "question_id": 36044743, "link": "https://stackoverflow.com/questions/36044743/pipe-broken-fifo-file", "title": "Pipe Broken, FIFO file", "body": "<p>I'm trying a program to use FIFO file, but I'm getting Broken pipe as output. Here is the code - </p>\n\n<pre><code>#include&lt;iostream&gt;\n#include&lt;stdlib.h&gt;\n#include&lt;fcntl.h&gt;\n#include&lt;stdio.h&gt;\n#include&lt;string.h&gt;\n#include&lt;unistd.h&gt;\n#include&lt;sys/stat.h&gt;\n#include&lt;sys/types.h&gt;\nusing namespace std;\nint main(int argc,char *argv[])\n{\nint fd; //stores file descriptor returnd from open\nchar buf[256];\nif(argc&lt;2||argc&gt;3)\n{\n    cout&lt;&lt;\"Invalid Arguments\";\n    return 1;\n}\n\nmkfifo(argv[1],0777);\nif(argc==3)\n{   \n    cout&lt;&lt;\"Writer\\n\";\n    if((fd=open(argv[1],O_WRONLY))==-1)\n    {\n        perror(\"open\");\n        return 1;\n    }\n    write(fd,argv[2],strlen(argv[2]));\n    sleep(10);\n}\nelse\n{   cout&lt;&lt;\"Reader\\n\";\n    if((fd=open(argv[1],O_RDONLY|O_NONBLOCK))==-1)\n    {       \n        perror(\"open\");\n        return 1;\n    }\n\n    read(fd,&amp;buf,sizeof(buf));\n    cout&lt;&lt;buf;\n\n}\n close(fd);\n return 1;\n }\n</code></pre>\n\n<p>Output: \nBelow Fifo is the name of the file and Hello is the content.</p>\n\n<blockquote>\n<pre><code>./a.out fifo hello &amp;\n\nWriter\n\n./a.out fifo\nReader\n\n[1]+  Broken pipe  \n</code></pre>\n</blockquote>\n\n<p>I should get \"Hello\" as the output. Can anyone help?</p>\n"}, {"tags": ["c", "algorithm", "boolean"], "comments": [{"owner": {"reputation": 32100, "user_id": 1033581, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/e8891617e36b8d1254eb3ce1a5662da4?s=128&d=identicon&r=PG", "display_name": "C\u0153ur", "link": "https://stackoverflow.com/users/1033581/c%c5%93ur"}, "edited": false, "score": 0, "creation_date": 1487599928, "post_id": 36044674, "comment_id": 71844807, "body": "where would you place parenthesis in <code>false &amp;&amp; false &amp;&amp; false</code> to make it true?"}], "answers": [{"tags": [], "owner": {"reputation": 325120, "user_id": 501557, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e4bac7ebd5f5a06c716f508af656e24b?s=128&d=identicon&r=PG", "display_name": "templatetypedef", "link": "https://stackoverflow.com/users/501557/templatetypedef"}, "is_accepted": true, "score": 3, "last_activity_date": 1458160055, "last_edit_date": 1458160055, "creation_date": 1458155229, "answer_id": 36044844, "question_id": 36044674, "link": "https://stackoverflow.com/questions/36044674/given-an-boolean-expression-decide-where-to-place-parenthesis-so-it-becomes-true/36044844#36044844", "title": "Given an boolean expression decide where to place parenthesis so it becomes true", "body": "<p>One observation here is that if you end up with a fully-parenthesized expression, there will be some top-level operator in the overall expression. Based on that operator, the entire expression will evaluate to true if one of a number of different cases hold. For example, if the top-level operator is an AND, then the expression is true if the subexpressions to the left and right of the AND are true. If the top-level operation is an OR, the whole expression evaluates to true if either the left or right subexpressions evaluate to true. If the top-level operator is a NOT, the entire expression is true if the subexpression of the NOT is false.</p>\n\n<p>You can imagine a top-down recursive algorithm that works as follows: for each operator, temporarily assume it's the top-level operator and recursively determine whether the subexpressions in question can have the appropriate truth values. If so, the formula can be made true. If not, it can't.</p>\n\n<p>The number of possible subexpression / truth value pairs here is O(n<sup>2</sup>), since each subexpression is just a subarray of the original expression and there are only O(n<sup>2</sup>) of them. Therefore, there are going to be a lot of overlapping subproblems, so you could either compute the result top-down with memoization or bottom-up wou dynamic programming.</p>\n\n<p>This seemed like a really fun problem, so I actually coded this up in C++ (not, C, unfortunately, since that just seemed hard.):</p>\n\n<pre><code>#include &lt;string&gt;\n#include &lt;vector&gt;\n#include &lt;unordered_map&gt;\n#include &lt;utility&gt;\n#include &lt;cassert&gt;\n#include &lt;iostream&gt;\nusing namespace std;\n\n/**\n * Enumerated type: Symbol\n *\n * A type representing a symbol that can appear in a boolean expression.\n */\nenum Symbol {\n  TRUE,\n  FALSE,\n  AND,\n  OR,\n  NOT,\n  IMPLIES,\n  IFF,\n  XOR\n};\n\n/**\n * Alias: Subproblem\n *\n * A name for a type representing one of the subproblems in the memoized\n * solution. Each subproblem corresponds to a subarray (given by a start\n * and end position) and an expected truth value (either true or false.)\n */\nusing Subproblem = tuple&lt;size_t, size_t, bool&gt;;\nnamespace std {\n  template &lt;&gt; struct hash&lt;Subproblem&gt; {\n    bool operator()(const Subproblem&amp; s) const {\n      return hash&lt;size_t&gt;()(get&lt;0&gt;(s)) + 31 * hash&lt;size_t&gt;()(get&lt;1&gt;(s)) + 127 * hash&lt;bool&gt;()(get&lt;2&gt;(s));\n    }\n  };\n}\n\n/* Internal implementation. */\nnamespace {\n  /**\n   * Function: canYield(const vector&lt;Symbol&gt;&amp; formula,\n   *                    size_t start, size_t end,\n   *                    unordered_map&lt;Subproblem, bool&gt;&amp; subproblems,\n   *                    bool expected);\n   * --------------------------------------------------------------------------\n   * Determines whether the subexpression in range [start, end) of the formula\n   * given by formula can be made to evaluate to result. Memoizes its results\n   * to avoid extraneous computations.\n   */\n  bool canYield(const vector&lt;Symbol&gt;&amp; formula,\n        size_t start, size_t end,\n        unordered_map&lt;Subproblem, bool&gt;&amp; subproblems,\n        bool expected) {\n    /* Edge case check: we shouldn't have an empty range. */\n    assert (end &gt; start);\n\n    /* Begin by seeing if we've already computed this. If so, we're done!\n     * If not, we have to do some work. By the time this if statement finishes,\n     * soln should be valid.\n     */\n    const Subproblem thisSubproblem = make_tuple(start, end, expected);\n    if (!subproblems.count(thisSubproblem)) {\n      /* Base case: If this is a single-element range, it must be either\n       * to TRUE or FALSE, and we should be able to read off the answer\n       * directly.\n       */\n      if (start + 1 == end) {\n    /* This has to be TRUE or FALSE; otherwise the formula is malformed. */\n    assert (formula[start] == TRUE || formula[start] == FALSE);\n\n    /* See whether the enumerated constant matches the expected value. */\n    bool isTrue = (formula[start] == TRUE);\n    subproblems[thisSubproblem] = (isTrue == expected);\n      }\n      /* Otherwise, we have a longer range. */\n      else {\n    /* If this range begins with a NOT, one option is to parenthesize\n     * the rest of the expression to try to get the opposite of what's\n     * expected.\n     */\n    if (formula[start] == NOT &amp;&amp;\n        canYield(formula, start + 1, end, subproblems, !expected)) {\n      subproblems[thisSubproblem] = true;\n    } else {\n      /* Iterate over the range, trying to put all binary operators at\n       * the top level if possible. If any of them work, we're done!\n       */\n      for (size_t i = start; i &lt; end; i++) {\n        /* To handle AND and OR, we'll use the fact that de Morgan's laws\n         * allows us to unite a bunch of cases together.\n         */\n        if (formula[i] == AND || formula[i] == OR) {\n          /* Here's the observatino. If we're trying to make an AND true\n           * or an OR false, we need to get both subformulas to match\n           * the expected truth value. If we're trying to make an AND false\n           * or an OR true, we need to get one subformula to match the\n           * expected truth value. So we need to see the parity of the\n           * combination of AND/OR and whether we want true/false.\n           */\n          bool parity = ((formula[i] == AND) == expected);\n\n          /* If the parities match, we're either looking for an AND/true\n           * or an OR/false.\n           */\n          if (parity &amp;&amp;\n          canYield(formula, start, i, subproblems, expected) &amp;&amp;\n          canYield(formula, i+1, end, subproblems, expected)) {\n        subproblems[thisSubproblem] = true;\n        break;\n          }\n          /* If the parities disagree, we're either looking for AND/false\n           * or OR/true.\n           */\n          else if (!parity &amp;&amp;\n               (canYield(formula, start, i, subproblems, expected) ||\n            canYield(formula, i+1, end, subproblems, expected))) {\n        subproblems[thisSubproblem] = true;\n        break;          \n          }\n        }\n        /* If we see an XOR or IFF, we can similarly use a de Morgan's\n         * trick.\n         */\n        else if (formula[i] == XOR || formula[i] == IFF) {\n          /* If we're looking for an XOR/true or an IFF/false, then we\n           * need exactly one of the two subproblems to be true. If we're\n           * looking for an XOR/false or an IFF/true, then we need both\n           * of the subproblems to be true or both to be false. Let's\n           * start by determining which case we're in.\n           */\n          bool parity = ((formula[i] == XOR) == expected);\n\n          /* Fire off the four subproblems we need to consider. */\n          bool fTrue  = canYield(formula, start, i, subproblems, true);\n          bool fFalse = canYield(formula, start, i, subproblems, false);\n          bool sTrue  = canYield(formula, i+1, end, subproblems, true);\n          bool sFalse  = canYield(formula, i+1, end, subproblems, false);\n\n          /* If we have true parity, we're looking for XOR/true or IFF/\n           * false, so we want the first and second halves to disagree.\n           */\n          if (parity &amp;&amp; ((fTrue &amp;&amp; sFalse) || (fFalse &amp;&amp; sTrue))) {\n        subproblems[thisSubproblem] = true;\n        break;\n          }\n          /* Otherwise, we're looking for equal parity, so we need the\n           * first and second halves to agree.\n           */\n          else if (!parity &amp;&amp; ((fTrue &amp;&amp; sTrue) || (fFalse &amp;&amp; sFalse))) {\n        subproblems[thisSubproblem] = true;\n        break;\n          }\n        }\n        /* Implications are their own can of worms since they're so \n         * different than everything else.\n         */\n        else if (formula[i] == IMPLIES) {\n          /* For 'true,' we check if the antecedent can be made false\n           * or the consequent made true.\n           */\n          if (expected &amp;&amp;\n          (canYield(formula, start, i, subproblems, false) ||\n           canYield(formula, i+1, end, subproblems, true))) {\n        subproblems[thisSubproblem] = true;\n        break;\n          }\n          /* For 'false,' we see if the antecedent is true and the\n           * consequent is false.\n           */\n          if (!expected &amp;&amp;\n          canYield(formula, start, i, subproblems, true) &amp;&amp;\n          canYield(formula, i+1, end, subproblems, false)) {\n        subproblems[thisSubproblem] = true;\n        break;\n          }\n        }\n      }\n    }\n      }\n    }\n    /* Return the solution we found. Notice that as a cute trick, if we didn't\n     * record a true value in the course of solving the problem, then this\n     * read will default to false - which is what we wanted!\n     */\n    return subproblems[thisSubproblem];\n  }\n}\n\n/**\n * Function: canParenthesizeToYieldTrue(const vector&lt;Symbol&gt;&amp; formula);\n * Usage: if (canParentheiszeToYieldTrue({FALSE, AND, NOT, FALSE})) // false\n *        if (canParenthesizeToYieldTrue({NOT, FALSE, AND, FALSE})) // true\n * \n * ----------------------------------------------------------------------------\n * Given a boolean expression, returns whether it's possible to add parentheses\n * into the expression in a way that causes that expression to evaluate to\n * true. It is assumed that this formula is well-formed and nonempty.\n */\nbool canParenthesizeToYieldTrue(const vector&lt;Symbol&gt;&amp; formula) {\n  /* Table for memoizing whether each subproblem is solvable or not. */\n  unordered_map&lt;Subproblem, bool&gt; subproblems;\n  return canYield(formula, 0, formula.size(), subproblems, true);\n}\n\n/* Prints out an expression in a nice form. */\nvoid printExpr(const vector&lt;Symbol&gt;&amp; problem) {\n  for (Symbol s: problem) {\n    switch (s) {\n    case TRUE:    cout &lt;&lt; \"true\";     break;\n    case FALSE:   cout &lt;&lt; \"false\";    break;\n    case AND:     cout &lt;&lt; \" /\\\\ \";    break;\n    case OR:      cout &lt;&lt; \" \\\\/ \";    break;\n    case NOT:     cout &lt;&lt; \"!\";        break;\n    case XOR:     cout &lt;&lt; \" + \";      break;\n    case IFF:     cout &lt;&lt; \" &lt;-&gt; \";    break;\n    case IMPLIES: cout &lt;&lt; \" -&gt; \";     break;\n    default: assert(false);\n    }\n  }\n}\n\n/* Runs a test case to see if the program behaves as expected. */\nvoid check(const vector&lt;Symbol&gt;&amp; problem, bool expected) {\n  bool result = (canParenthesizeToYieldTrue(problem) == expected);\n  if (result) {\n    cout &lt;&lt; \"  pass: \";\n    printExpr(problem);\n    cout &lt;&lt; endl;\n  }\n  else {\n    cout &lt;&lt; \"! FAIL: \";\n    printExpr(problem);\n\n    string throwaway;\n    getline(cin, throwaway);\n  }\n}\n\nint main() {\n  /* Basic logic checks. */\n  check({TRUE}, true);\n  check({FALSE}, false);\n  check({NOT, TRUE}, false);\n  check({NOT, FALSE}, true);\n  check({TRUE, AND, TRUE}, true);\n  check({TRUE, AND, FALSE}, false);\n  check({FALSE, AND, TRUE}, false);\n  check({FALSE, AND, FALSE}, false);\n  check({TRUE, OR, TRUE}, true);\n  check({TRUE, OR, FALSE}, true);\n  check({FALSE, OR, TRUE}, true);\n  check({FALSE, OR, FALSE}, false);\n  check({TRUE, XOR, TRUE}, false);\n  check({TRUE, XOR, FALSE}, true);\n  check({FALSE, XOR, TRUE}, true);\n  check({FALSE, XOR, FALSE}, false);\n  check({TRUE, IFF, TRUE}, true);\n  check({TRUE, IFF, FALSE}, false);\n  check({FALSE, IFF, TRUE}, false);\n  check({FALSE, IFF, FALSE}, true);\n  check({TRUE, IMPLIES, TRUE}, true);\n  check({TRUE, IMPLIES, FALSE}, false);\n  check({FALSE, IMPLIES, TRUE}, true);\n  check({FALSE, IMPLIES, FALSE}, true);\n\n  /* Harder ones! */\n  check({TRUE, AND, NOT, TRUE}, false);\n  check({NOT, TRUE, AND, TRUE}, false);\n  check({FALSE, AND, NOT, FALSE}, false);\n  check({NOT, FALSE, AND, FALSE}, true);\n\n  check({TRUE, OR, NOT, TRUE}, true);\n  check({NOT, TRUE, OR, TRUE}, true);\n  check({FALSE, OR, NOT, TRUE}, false);\n  check({NOT, TRUE, OR, FALSE}, false);\n\n  check({NOT, FALSE, IMPLIES, TRUE}, true);\n  check({NOT, FALSE, IMPLIES, FALSE}, false);\n\n  check({NOT, FALSE, XOR, TRUE}, false);\n  check({NOT, FALSE, IFF, FALSE}, false);\n\n  /* Ridiculous */\n  check({NOT, NOT, FALSE, OR, FALSE, OR, FALSE}, false);\n}\n</code></pre>\n"}], "owner": {"reputation": 73, "user_id": 5463160, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f01c2d26fceaf440a6314595095310db?s=128&d=identicon&r=PG&f=1", "display_name": "Timothy Walker", "link": "https://stackoverflow.com/users/5463160/timothy-walker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "accepted_answer_id": 36044844, "answer_count": 1, "score": 0, "last_activity_date": 1487599696, "creation_date": 1458154723, "last_edit_date": 1487599696, "question_id": 36044674, "link": "https://stackoverflow.com/questions/36044674/given-an-boolean-expression-decide-where-to-place-parenthesis-so-it-becomes-true", "title": "Given an boolean expression decide where to place parenthesis so it becomes true", "body": "<p>I am thinking of creating a program that, given an boolean expression, for example, true and false xor true places parenthesis around the \"operations\" and returns the new equations that have true as a result. How would I do this, from where should I start? Is there a small algorithm in Dynamic Programming I should search for?</p>\n"}, {"tags": ["c", "arrays", "multidimensional-array", "chars"], "comments": [{"owner": {"reputation": 11, "user_id": 5844497, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N0lqb.gif?s=128&g=1", "display_name": "AaronFye", "link": "https://stackoverflow.com/users/5844497/aaronfye"}, "reply_to_user": {"reputation": 6975, "user_id": 3121023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f52448806175b9aa66c86d40cf0829f1?s=128&d=identicon&r=PG&f=1", "display_name": "user3121023", "link": "https://stackoverflow.com/users/3121023/user3121023"}, "edited": false, "score": 0, "creation_date": 1458154753, "post_id": 36044429, "comment_id": 59737841, "body": "@user3121023, this works... thanks! I had no idea that that was even a thing."}], "answers": [{"tags": [], "owner": {"reputation": 4011, "user_id": 1477064, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/cd12123a743db34ac0b055a6fa736788?s=128&d=identicon&r=PG", "display_name": "xvan", "link": "https://stackoverflow.com/users/1477064/xvan"}, "is_accepted": false, "score": 0, "last_activity_date": 1458154474, "creation_date": 1458154474, "answer_id": 36044582, "question_id": 36044429, "link": "https://stackoverflow.com/questions/36044429/how-do-i-scan-into-a-2d-char-array-without-scanning-in-the-enter-space-chars/36044582#36044582", "title": "How do I scan into a 2d char array without scanning in the enter/space chars?", "body": "<p>You could use <code>getchar()</code> and retry on <code>'\\n'</code>. <code>scanf()</code> seems an overkill.</p>\n\n<pre><code>for(i=0;i&lt;row;i++){\n\n    for(j=0;j&lt;col;j++){\n\n        while ( '\\n' == (maze[j][i]=getchar() ) );\n\n    }\n\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 5844497, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N0lqb.gif?s=128&g=1", "display_name": "AaronFye", "link": "https://stackoverflow.com/users/5844497/aaronfye"}, "is_accepted": true, "score": 1, "last_activity_date": 1458162251, "last_edit_date": 1495539910, "creation_date": 1458154807, "answer_id": 36044704, "question_id": 36044429, "link": "https://stackoverflow.com/questions/36044429/how-do-i-scan-into-a-2d-char-array-without-scanning-in-the-enter-space-chars/36044704#36044704", "title": "How do I scan into a 2d char array without scanning in the enter/space chars?", "body": "<p>Alright, so as <a href=\"https://stackoverflow.com/users/3121023/user3121023\">user3121023</a> <a href=\"https://stackoverflow.com/questions/36044429/how-do-i-scan-into-a-2d-char-array-without-scanning-in-the-enter-space-chars/36044704#comment59737510_36044429\">commented</a>, putting a space before the <code>%c</code> in<br>\n<code>scanf(\" %c\",&amp;maze[j][i]);</code> works!</p>\n\n<blockquote>\n  <p>The space before the % will skip leading whitespace such as space and enter.</p>\n</blockquote>\n"}], "owner": {"reputation": 11, "user_id": 5844497, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N0lqb.gif?s=128&g=1", "display_name": "AaronFye", "link": "https://stackoverflow.com/users/5844497/aaronfye"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 641, "favorite_count": 0, "accepted_answer_id": 36044704, "answer_count": 2, "score": 0, "last_activity_date": 1458162251, "creation_date": 1458154004, "question_id": 36044429, "link": "https://stackoverflow.com/questions/36044429/how-do-i-scan-into-a-2d-char-array-without-scanning-in-the-enter-space-chars", "title": "How do I scan into a 2d char array without scanning in the enter/space chars?", "body": "<p>So I have to make a maze program, and to start I must scan in the maze to a 2d array. The problem arises when i go to put the chars into the array, when the enter char and the space char always take up the first slot in the array...</p>\n\n<p>Here is my code:</p>\n\n<pre><code>    int main(){\n\n    int row, col;\n\n    int i,j,k,l;\n\n    scanf(\"%d\", &amp;row);\n\n    scanf(\"%d\", &amp;col);\n\n    char** maze = (char**) calloc(row, sizeof(char*));\n\n    for ( k = 0; k &lt; row; k++ )\n    {\n        maze[k] = (char*) calloc(col, sizeof(char));\n    }\n\n    for(i=0;i&lt;row;i++){\n\n        for(j=0;j&lt;col;j++){\n\n            scanf(\"%c\",&amp;maze[j][i]);\n\n        }\n\n    }\n\n    for(k=0;k&lt;row;k++){\n\n        for(l=0;l&lt;col;l++){\n\n            printf(\"%c\", maze[k][l]);\n\n        }\n\n        printf(\"\\n\");\n\n    }\n\n\n   return 0;\n}\n</code></pre>\n\n<p>And the output is:</p>\n\n<p>With the enter char:</p>\n\n<p>3</p>\n\n<p>3</p>\n\n<p>xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx</p>\n\n<p>xx</p>\n\n<p>xxx</p>\n\n<p>xxx</p>\n\n<p>With a space:</p>\n\n<p>3</p>\n\n<p>3 xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx</p>\n\n<p>xx</p>\n\n<p>xxx</p>\n\n<p>xxx</p>\n\n<p>without any thing: (this one works)</p>\n\n<p>3</p>\n\n<p>3xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx</p>\n\n<p>xxx</p>\n\n<p>xxx</p>\n\n<p>xxx</p>\n"}, {"tags": ["c", "xml", "url", "winapi", "visual-studio-2012"], "comments": [{"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1458155662, "post_id": 36044299, "comment_id": 59738386, "body": "Use websearch to answer this, here it is off topic"}], "answers": [{"comments": [{"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1458174770, "post_id": 36044733, "comment_id": 59747412, "body": "Microsoft also has its own WinInet/WinHTTP APIs for downloading data from a URL, and its own MSXML library for parsing XML. Both are usable in C, if you are not worried about supporting non-Windows platforms. The libcurl and libxml libraries are cross-platform."}], "tags": [], "owner": {"reputation": 4569, "user_id": 1282773, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/GFxGD.jpg?s=128&g=1", "display_name": "ivaigult", "link": "https://stackoverflow.com/users/1282773/ivaigult"}, "is_accepted": true, "score": 2, "last_activity_date": 1458154914, "creation_date": 1458154914, "answer_id": 36044733, "question_id": 36044299, "link": "https://stackoverflow.com/questions/36044299/read-xml-from-url-with-c-not-c-in-win32-application/36044733#36044733", "title": "Read XML from URL with C not C++ in Win32 application", "body": "<p><a href=\"https://curl.haxx.se/libcurl/\" rel=\"nofollow\">Libcurl</a> has pure C API. <a href=\"http://www.jclark.com/xml/expat.html\" rel=\"nofollow\">Expat</a> and <a href=\"http://www.xmlsoft.org/\" rel=\"nofollow\">libxml</a> are written in pure C too.</p>\n"}, {"tags": [], "owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "is_accepted": false, "score": 2, "last_activity_date": 1458222101, "creation_date": 1458222101, "answer_id": 36062313, "question_id": 36044299, "link": "https://stackoverflow.com/questions/36044299/read-xml-from-url-with-c-not-c-in-win32-application/36062313#36062313", "title": "Read XML from URL with C not C++ in Win32 application", "body": "<p>You can use <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa385331.aspx\" rel=\"nofollow\">Windows Internet (WinINet)</a> or <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa384273.aspx\" rel=\"nofollow\">Windows HTTP Services</a> for download. <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/hh227297.aspx\" rel=\"nofollow\">WinHTTP vs. WinINet</a> offers an overview to help you decide, which API to use.</p>\n\n<p>To parse XML content, you can use <a href=\"https://msdn.microsoft.com/en-us/library/ms763742.aspx\" rel=\"nofollow\">MSXML</a>. It is Microsoft's XML parser (both DOM and SAX), that is exposed as a COM interface. Using COM from C is somewhat verbose, but fairly straight forward.</p>\n\n<p>When using either of the above, you do not need to ship any additional libraries with your application.</p>\n"}], "owner": {"reputation": 169, "user_id": 6073269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/FULRz.gif?s=128&g=1", "display_name": "Mark Twain", "link": "https://stackoverflow.com/users/6073269/mark-twain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 515, "favorite_count": 0, "accepted_answer_id": 36044733, "answer_count": 2, "score": 0, "last_activity_date": 1458222101, "creation_date": 1458153593, "question_id": 36044299, "link": "https://stackoverflow.com/questions/36044299/read-xml-from-url-with-c-not-c-in-win32-application", "title": "Read XML from URL with C not C++ in Win32 application", "body": "<p>I code in C and I am little weak in C++, in my research I came across many methods to read XML from URL for my win32 application. \nI found cURL and <code>XmlTextReader</code> but it's in C++.\nIs there any function or other ways, where I can download XML from the URL and parse that XML using only C language and not C++?</p>\n\n<p>I can work with C++ as well, but I want to avoid it as it's not I am comfortable with. </p>\n"}, {"tags": ["c++", "c", "sockets", "http", "pointers"], "comments": [{"owner": {"reputation": 13384, "user_id": 451600, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/qYIUW.jpg?s=128&g=1", "display_name": "Captain Giraffe", "link": "https://stackoverflow.com/users/451600/captain-giraffe"}, "edited": false, "score": 0, "creation_date": 1458153852, "post_id": 36044266, "comment_id": 59737356, "body": "&quot;are we sure that the size of the request will not exceeds 1024?&quot; No. If I recall correctly the standard says nothing about size. The browsers has limits between 4 and 11 kBs."}, {"owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 0, "creation_date": 1458155613, "post_id": 36044266, "comment_id": 59738359, "body": "The buffer should just be for efficiency of reading. You should keep filling the buffer in a loop until the whole request has been received (or timeout/error etc)."}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 2063020, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/78dff2c5da3daf7517011cfd6f6beaa0?s=128&d=identicon&r=PG", "display_name": "jean jack", "link": "https://stackoverflow.com/users/2063020/jean-jack"}, "edited": false, "score": 0, "creation_date": 1458161130, "post_id": 36044371, "comment_id": 59741678, "body": "thanks , how can i append the new incoming data in C ? i think if i loop and read to the buffer i will overwrite the preceding data."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 33, "user_id": 2063020, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/78dff2c5da3daf7517011cfd6f6beaa0?s=128&d=identicon&r=PG", "display_name": "jean jack", "link": "https://stackoverflow.com/users/2063020/jean-jack"}, "edited": false, "score": 0, "creation_date": 1458161191, "post_id": 36044371, "comment_id": 59741710, "body": "@jeanjack, in C you would have to use something like <code>realloc</code> to keep increasing your buffer size."}], "tags": [], "owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "is_accepted": true, "score": 1, "last_activity_date": 1458160399, "last_edit_date": 1458160399, "creation_date": 1458153844, "answer_id": 36044371, "question_id": 36044266, "link": "https://stackoverflow.com/questions/36044266/how-to-read-an-http-requestan-http-proxy-server/36044371#36044371", "title": "how to read an http request(an http proxy server)", "body": "<p>Reading by a single character is terribly inefficient and slows you down tremendously. Instead, you should be reading by chunks of approriate size (1024 seems as good initial guess as any) in the loop and append read buffer to the total data read so far. It is extremely easy to do with C++ <code>std::vector</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 230, "user_id": 3430265, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a705ca50c907800e3fbe71e6ad8f556?s=128&d=identicon&r=PG&f=1", "display_name": "adam", "link": "https://stackoverflow.com/users/3430265/adam"}, "is_accepted": false, "score": 0, "last_activity_date": 1458186646, "creation_date": 1458186646, "answer_id": 36051348, "question_id": 36044266, "link": "https://stackoverflow.com/questions/36044266/how-to-read-an-http-requestan-http-proxy-server/36051348#36051348", "title": "how to read an http request(an http proxy server)", "body": "<p>Parsing an HTTP request is a quite complicated task, I think it could be easier to use a library like <a href=\"https://github.com/nodejs/http-parser\" rel=\"nofollow\">http-parser</a>, which does the parsing for you in a very efficient way.</p>\n"}], "owner": {"reputation": 33, "user_id": 2063020, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/78dff2c5da3daf7517011cfd6f6beaa0?s=128&d=identicon&r=PG", "display_name": "jean jack", "link": "https://stackoverflow.com/users/2063020/jean-jack"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 380, "favorite_count": 0, "accepted_answer_id": 36044371, "answer_count": 2, "score": 1, "last_activity_date": 1464865073, "creation_date": 1458153500, "last_edit_date": 1464865073, "question_id": 36044266, "link": "https://stackoverflow.com/questions/36044266/how-to-read-an-http-requestan-http-proxy-server", "title": "how to read an http request(an http proxy server)", "body": "<p>I have to make an http proxy. In the proxy side I have to parse the http request sent by the user.</p>\n\n<p>The question is: How to read binary data from the client such at the final I will  get an array of char that contains the full request .</p>\n\n<p>What I did is: Read 1 Byte each time.</p>\n\n<pre><code>    char c;\n    int  n = read(con,&amp;c,1);\n</code></pre>\n\n<p>I saw many implementation where we use 1024 bytes as the size of the buffer , but are we sure that the size of the request will not exceeds  1024?</p>\n\n<p>Normally in first place I have to allocate the memory for the buffer array , so how can i know the size of the request to allocate the same size of memory?</p>\n\n<p>My full methods:</p>\n\n<pre><code>void readToken(int con,char *token){\nchar c;\nint i=0;\ndo{\n    int  n = read(con,&amp;c,1);\n    *token++ = c;\n    }while(c!=' ' &amp;&amp; c!='\\n');      \n}\n\nvoid readLine(int con,char *line){\n    char c;int i=0;\n    do{\n        int  n = read(con,&amp;c,1);\n        *line++ = c;\n        }while(c!='\\n');\n\n}\nchar * handleRequest(int con){\n    char resource[30];\n    char version[5];\n    char  method[4] ;\n    //i read 4 byte to get the method tyepe \n    int n = read(con,&amp;method,4);\n    //here i read until i get a blank space\n    readToken(con,resource);\n    //readToken(con,version);\n    printf(\"the method is%s\\n\",method);\n    printf(\"the resource asked is%s\\n\",resource);\n    //printf(\"the resource asked is%s\\n\",version);\n    printf(\"the method read is %s\",firstLine);\n    readLine(con,hostLine);\n    printf(\"the method read is %s\",hostLine);       \n}\n</code></pre>\n"}, {"tags": ["c", "struct", "linked-list"], "answers": [{"tags": [], "owner": {"reputation": 13, "user_id": 6068666, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-t6NEPb591q8/AAAAAAAAAAI/AAAAAAAAA_4/3eW7yEmwT90/photo.jpg?sz=128", "display_name": "Boris Giard", "link": "https://stackoverflow.com/users/6068666/boris-giard"}, "is_accepted": false, "score": -1, "last_activity_date": 1458154584, "creation_date": 1458154584, "answer_id": 36044617, "question_id": 36044255, "link": "https://stackoverflow.com/questions/36044255/how-to-read-data-from-text-file-in-struct-with-different-number-of-words-in-line/36044617#36044617", "title": "how to read data from text file in struct with different number of words in lines in c programming?", "body": "<p>Try use getline(), strtok(), atoi() to get your data.</p>\n"}, {"comments": [{"owner": {"reputation": 53, "user_id": 5526931, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/da54222bfad72ca0b415978dda556b76?s=128&d=identicon&r=PG&f=1", "display_name": "MHR", "link": "https://stackoverflow.com/users/5526931/mhr"}, "edited": false, "score": 0, "creation_date": 1458167080, "post_id": 36044927, "comment_id": 59744706, "body": "Thanks @Sudipta Kumar Sahoo. I tried as you suggested. But, fgets, sscanf doesn&#39;t read file in struct."}], "tags": [], "owner": {"reputation": 999, "user_id": 5668691, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51b2f0199abaed8efe849372dc60bb35?s=128&d=identicon&r=PG&f=1", "display_name": "Sudipta Kumar Sahoo", "link": "https://stackoverflow.com/users/5668691/sudipta-kumar-sahoo"}, "is_accepted": false, "score": 0, "last_activity_date": 1458155535, "creation_date": 1458155535, "answer_id": 36044927, "question_id": 36044255, "link": "https://stackoverflow.com/questions/36044255/how-to-read-data-from-text-file-in-struct-with-different-number-of-words-in-line/36044927#36044927", "title": "how to read data from text file in struct with different number of words in lines in c programming?", "body": "<p>You have not defined the town name for few of the cases such as</p>\n\n<pre><code>Peter 45 4345 \nCary 56 12345\n</code></pre>\n\n<p>But when you try to read it thru <code>fscanf</code>, compiler is expecting town name to be present;</p>\n\n<pre><code>fscanf(file, \"%s %i %i %s\\n\", name, &amp;age, &amp;id, town);\n</code></pre>\n\n<p>This data will be taken from the next line and so on.</p>\n\n<p>If this is situation, then you can use <code>fgets</code>, <code>sscanf</code> instead.</p>\n\n<p>Hope this helps.</p>\n"}, {"comments": [{"owner": {"reputation": 528, "user_id": 5153946, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/J4cXX.jpg?s=128&g=1", "display_name": "George Bou", "link": "https://stackoverflow.com/users/5153946/george-bou"}, "edited": false, "score": 0, "creation_date": 1458157071, "post_id": 36045280, "comment_id": 59739272, "body": "The problem with your code was that you read the file word by word and when there was no town for your program to read, it read the next word which was the next name. You should first split the file to lines and then manipulate each line separately."}, {"owner": {"reputation": 528, "user_id": 5153946, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/J4cXX.jpg?s=128&g=1", "display_name": "George Bou", "link": "https://stackoverflow.com/users/5153946/george-bou"}, "edited": false, "score": 0, "creation_date": 1458165706, "post_id": 36045280, "comment_id": 59744081, "body": "@MHR Would you care to respond to any of our answers?"}, {"owner": {"reputation": 53, "user_id": 5526931, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/da54222bfad72ca0b415978dda556b76?s=128&d=identicon&r=PG&f=1", "display_name": "MHR", "link": "https://stackoverflow.com/users/5526931/mhr"}, "edited": false, "score": 0, "creation_date": 1458166316, "post_id": 36045280, "comment_id": 59744376, "body": "Thanks @George Bou. I am trying to read the member.txt file in struct as it is so that I can rearrange the file. My codes work if there is town name in third and fourth lines or all lines have same number of words. thanks for your afford. I don&#39;t know how to do it or if it possible at all in my way. :("}, {"owner": {"reputation": 53, "user_id": 5526931, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/da54222bfad72ca0b415978dda556b76?s=128&d=identicon&r=PG&f=1", "display_name": "MHR", "link": "https://stackoverflow.com/users/5526931/mhr"}, "edited": false, "score": 0, "creation_date": 1458166728, "post_id": 36045280, "comment_id": 59744556, "body": "by the way, I care and I appreciate everybody&#39;s answer. thanks (y) @George Bou"}], "tags": [], "owner": {"reputation": 528, "user_id": 5153946, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/J4cXX.jpg?s=128&g=1", "display_name": "George Bou", "link": "https://stackoverflow.com/users/5153946/george-bou"}, "is_accepted": false, "score": 0, "last_activity_date": 1458156649, "creation_date": 1458156649, "answer_id": 36045280, "question_id": 36044255, "link": "https://stackoverflow.com/questions/36044255/how-to-read-data-from-text-file-in-struct-with-different-number-of-words-in-line/36045280#36045280", "title": "how to read data from text file in struct with different number of words in lines in c programming?", "body": "<p>This works but only if the word of the town is not included in a line in the text.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\ntypedef struct _Member{\n    char *name;\n    int age;\n    int id;\n    char *town;\n}Member;\n\nint main() {\n\nFILE *file = fopen(\"member.txt\", \"r\");\nFILE *newFile = fopen(\"new_member.txt\", \"w\");\nchar* lines;\nlines = (char *)malloc(40*sizeof(char));\nint counter=0, line = 10;\nint i;\nMember *member = malloc(sizeof(Member)*line);\n\nfor(i=0; i&lt;line; i++){\n    int age;\n    int id;\n    while(fgets(lines, 40, file)!=NULL){\n\n        char *name = (char *)malloc(13*sizeof(char));\n        char *town = (char *)malloc(13*sizeof(char));\n        if(sscanf(lines, \"%s %i %i %s\", name, &amp;age, &amp;id, town)==4){\n            member[counter].name = name;\n            member[counter].age =age;\n            member[counter].id = id;\n            member[counter].town = town;\n            counter++;\n        }\n        else{\n            member[counter].name = name;\n            member[counter].age =age;\n            member[counter].id = id;\n            member[counter].town = \"\\0\";\n            counter++;\n        }\n    }\n}\n\nfor(i= 0; i &lt; counter; i++){\n\n    fprintf(newFile, \"%s %d %d %s\\n\", member[i].name, member[i].age, member[i].id, member[i].town);\n}\n\nfclose(file);\nfclose(newFile);\n\nprintf(\"Successful\\n\");\n\nreturn 0;\n</code></pre>\n\n<p>}</p>\n\n<p>If you want you can change this: </p>\n\n<pre><code>            else{\n            member[counter].name = name;\n            member[counter].age =age;\n            member[counter].id = id;\n            member[counter].town = \"\\0\";\n            counter++;\n            }\n</code></pre>\n\n<p>to this:</p>\n\n<pre><code>            else{\n            printf(\"The line of %s is not valid\", name);\n            }\n</code></pre>\n\n<p>and so your new text will only include valid lines.</p>\n"}], "owner": {"reputation": 53, "user_id": 5526931, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/da54222bfad72ca0b415978dda556b76?s=128&d=identicon&r=PG&f=1", "display_name": "MHR", "link": "https://stackoverflow.com/users/5526931/mhr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 77, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1458166761, "creation_date": 1458153436, "last_edit_date": 1458166761, "question_id": 36044255, "link": "https://stackoverflow.com/questions/36044255/how-to-read-data-from-text-file-in-struct-with-different-number-of-words-in-line", "title": "how to read data from text file in struct with different number of words in lines in c programming?", "body": "<p>I am trying to read data in struct from text file which I want to print same as original file.</p>\n\n<p>Here is my codes:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\ntypedef struct _Member{\n    char *name;\n    int age;\n    int id;\n    char *town;\n}Member;\n\nint main() {\n\n    FILE *file = fopen(\"member.txt\", \"r\");\n    FILE *newFile = fopen(\"new_member.txt\", \"w\");\n\n    int counter=0, line = 10;\n\n    Member *member = malloc(sizeof(Member)*line);\n\n    for(int i =0; i&lt;line; i++){\n        int len = 12;\n        char *name = malloc(sizeof(char)*(len+1));\n        name [len] = '\\0';\n        int age;\n        int id;\n        char *town = malloc(sizeof(char)*(len+1));\n        town [len] = '\\0';\n\n        fscanf(file, \"%s %i %i %s\\n\", name, &amp;age, &amp;id, town);\n\n        member[counter].name = name;\n        member[counter].age =age;\n        member[counter].id = id;\n        member[counter].town = town;\n\n        counter++;\n    }\n\n    for(int i = 0; i &lt; counter-1; i++){\n\n        fprintf(newFile, \"%s %d %d %s\\n\", member[i].name, member[i].age, member[i].id, member[i].town);\n    }\n\n    fclose(file);\n    fclose(newFile);\n\n    printf(\"Successful\\n\");\n\n    return 0;\n}\n</code></pre>\n\n<p>member.txt</p>\n\n<pre><code>John 23 3456 Edinburgh\nRobert 33 4567 London\nPeter 45 4345 \nCary 56 12345 \nDian 45 4587 Norfolk\nWill 32 3453 Essex\nPaul 56 7896 York\nAlisha 78 1234 Peterbourgh\nBrandon 45 3214 Brighton\nEli 39 5234 Oxford\n</code></pre>\n\n<p>I am getting the result.\nnew_member.txt</p>\n\n<pre><code>John 23 3456 Edinburgh\nRobert 33 4567 London\nPeter 45 4345 Cary\n56 12345 4345 \nDian 45 4587 Norfolk\nWill 32 3453 Essex\nPaul 56 7896 York\nAlisha 78 1234 Peterbourgh\nBrandon 45 3214 Brighton\n</code></pre>\n\n<p>how can I print same as orginal file? Please note; I am trying to read data in STRUCT. My struct is reading third line and taking name from fourth line as town. Any help will be appreciated. Thanks</p>\n"}, {"tags": ["c++", "c", "linux", "build", "cmake"], "comments": [{"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 1, "creation_date": 1458153668, "post_id": 36044132, "comment_id": 59737256, "body": "DId you check your $PATH? Does it have /usr/lib by any chance?"}, {"owner": {"reputation": 237067, "user_id": 325565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/342bd0a61c7081db529c856d3bcd9545?s=128&d=identicon&r=PG", "display_name": "Joe Kington", "link": "https://stackoverflow.com/users/325565/joe-kington"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1458153822, "post_id": 36044132, "comment_id": 59737339, "body": "Good point! Unfortunately, my PATH doesn&#39;t have /usr/lib in it, so that&#39;s not the fix, but I should add that information to the question, regardless."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 1, "creation_date": 1458154076, "post_id": 36044132, "comment_id": 59737465, "body": "At this point, I&#39;d try strace/ltrace - may be it will give you a hint. Not neccessary, but better than nothing. For example, if it is reading some obscure env variable, you will see <code>getenv</code> call in ltrace output."}, {"owner": {"reputation": 237067, "user_id": 325565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/342bd0a61c7081db529c856d3bcd9545?s=128&d=identicon&r=PG", "display_name": "Joe Kington", "link": "https://stackoverflow.com/users/325565/joe-kington"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1458154388, "post_id": 36044132, "comment_id": 59737648, "body": "That&#39;s a good idea.  I wouldn&#39;t have thought to use ltrace/strace for that... It will certainly give me a lot more information than I have now!"}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1458155494, "post_id": 36044132, "comment_id": 59738285, "body": "Let me know how it goes, now I am curious!"}, {"owner": {"reputation": 98, "user_id": 6005220, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7076643bd014e005ca669ef78dcd594b?s=128&d=identicon&r=PG&f=1", "display_name": "Ravi", "link": "https://stackoverflow.com/users/6005220/ravi"}, "edited": false, "score": 0, "creation_date": 1458157275, "post_id": 36044132, "comment_id": 59739394, "body": "Try finding what does CMAKE_LIBRARY_PATH is to set, if not set it to the library location."}, {"owner": {"reputation": 2971, "user_id": 4975646, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-XzXhmdjjKB0/AAAAAAAAAAI/AAAAAAAAAeg/9rsygRfbVyk/photo.jpg?sz=128", "display_name": "callyalater", "link": "https://stackoverflow.com/users/4975646/callyalater"}, "edited": false, "score": 0, "creation_date": 1458157530, "post_id": 36044132, "comment_id": 59739555, "body": "In many *nix systems, <code>&#47;usr&#47;lib</code> is a symbolic link to either <code>lib32</code> or <code>lib64</code>. Is there any chance your link is pointing to the wrong directory?"}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 0, "creation_date": 1458157882, "post_id": 36044132, "comment_id": 59739776, "body": "In short, because cmake is an awful, utterly broken tool that does not respect the toolchain&#39;s library paths but tries to impose its own hard-coded assumptions that are wrong in anything but the most vanilla configurations."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 1, "creation_date": 1458158810, "post_id": 36044132, "comment_id": 59740318, "body": "@R.., while I not neccesarily disagree with that, do you know of any better tool? Manual Makefile typing is out of the question, and configure is a hassle."}], "answers": [{"comments": [{"owner": {"reputation": 237067, "user_id": 325565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/342bd0a61c7081db529c856d3bcd9545?s=128&d=identicon&r=PG", "display_name": "Joe Kington", "link": "https://stackoverflow.com/users/325565/joe-kington"}, "edited": false, "score": 0, "creation_date": 1458161818, "post_id": 36046564, "comment_id": 59742113, "body": "Good suggestion. Sadly, it doesn&#39;t change which library is found (still finding <code>&#47;usr&#47;lib&#47;libX11.so</code>).  However, that does get me pointed in the right direction, I think."}], "tags": [], "owner": {"reputation": 771, "user_id": 6010239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19bfdc532ab497b810c268922fb76caa?s=128&d=identicon&r=PG", "display_name": "Dimitri Merejkowsky", "link": "https://stackoverflow.com/users/6010239/dimitri-merejkowsky"}, "is_accepted": false, "score": 1, "last_activity_date": 1458161048, "creation_date": 1458161048, "answer_id": 36046564, "question_id": 36044132, "link": "https://stackoverflow.com/questions/36044132/why-is-cmake-finding-32-bit-libraries-instead-of-64-bit-libs-on-a-64-bit-system/36046564#36046564", "title": "Why is cmake finding 32-bit libraries instead of 64-bit libs on a 64-bit system?", "body": "<p>You could try :</p>\n\n<p>list(INSERT 0 CMAKE_SYSTEM_LIBRARY_PATH /usr/lib64)</p>\n\n<p>The full list of variables used by find_library is available in the documentation: <a href=\"https://cmake.org/cmake/help/v3.5/command/find_library.html\" rel=\"nofollow\">https://cmake.org/cmake/help/v3.5/command/find_library.html</a></p>\n"}, {"comments": [{"owner": {"reputation": 1670, "user_id": 754534, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/567f7e1a18f931b5a6e3d88a20c27c67?s=128&d=identicon&r=PG&f=1", "display_name": "JPNotADragon", "link": "https://stackoverflow.com/users/754534/jpnotadragon"}, "edited": false, "score": 0, "creation_date": 1502548528, "post_id": 36047243, "comment_id": 78261162, "body": "Just stumbled upon this while looking for something else. I&#39;ve very little experience with Linux programming, but I&#39;m wondering: if applications are looking for <code>libX11.so.6</code>, shouldn&#39;t the CMake Find module do the same? IMHO the answer here might involve fixing the Find module."}], "tags": [], "owner": {"reputation": 237067, "user_id": 325565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/342bd0a61c7081db529c856d3bcd9545?s=128&d=identicon&r=PG", "display_name": "Joe Kington", "link": "https://stackoverflow.com/users/325565/joe-kington"}, "is_accepted": true, "score": 1, "last_activity_date": 1458163529, "creation_date": 1458163529, "answer_id": 36047243, "question_id": 36044132, "link": "https://stackoverflow.com/questions/36044132/why-is-cmake-finding-32-bit-libraries-instead-of-64-bit-libs-on-a-64-bit-system/36047243#36047243", "title": "Why is cmake finding 32-bit libraries instead of 64-bit libs on a 64-bit system?", "body": "<p>It turns out that the root problem is the version suffix and the lack of a symlink to specifically <code>/usr/lib64/libX11.so</code> on the RHEL6 side.</p>\n\n<p><code>cmake</code> looks specifically for <code>libX11.so</code> and not <code>libX11.so.6</code> or some other version-specific variant.</p>\n\n<p>In this case, making the symlink wasn't an option, but I was able to prefer the specific version by listing the filename first:</p>\n\n<pre><code>cmake_minimum_required(VERSION 2.8)\n\nfind_library(XTEST NAMES libX11.so.6 X11)\nmessage(\"Found X11 at ${XTEST}\")\n</code></pre>\n\n<p>However, there are undoubtedly a variety of better ways of handling this, and I'd be very interested to hear them if anyone has any better approaches.</p>\n"}], "owner": {"reputation": 237067, "user_id": 325565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/342bd0a61c7081db529c856d3bcd9545?s=128&d=identicon&r=PG", "display_name": "Joe Kington", "link": "https://stackoverflow.com/users/325565/joe-kington"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2004, "favorite_count": 1, "accepted_answer_id": 36047243, "answer_count": 2, "score": 3, "last_activity_date": 1458163529, "creation_date": 1458153120, "last_edit_date": 1592644375, "question_id": 36044132, "link": "https://stackoverflow.com/questions/36044132/why-is-cmake-finding-32-bit-libraries-instead-of-64-bit-libs-on-a-64-bit-system", "title": "Why is cmake finding 32-bit libraries instead of 64-bit libs on a 64-bit system?", "body": "<h1>Problem Description</h1>\n<p>I'm working on porting several codebases over from Red Hat 5 to 6, and I've run into a cmake issue that I'm completely stumped by.</p>\n<p>Cmake is consistently finding the 32-bit versions of libraries under <code>/usr/lib</code> instead of the 64-bit versions under <code>/usr/lib64</code> on an RHEL6 system, while it correctly detects the lib64 versions on the an RHEL5 system.</p>\n<h1>Minimal Example</h1>\n<p>For example, I have a very minimal <code>CMakeLists.txt</code> file:</p>\n<pre><code>cmake_minimum_required(VERSION 2.8)\n\nfind_library(XTEST X11)\nmessage(&quot;Found X11 at ${XTEST}&quot;)\n</code></pre>\n<p>On an RHEL6 system, running <code>cmake</code> on this results in:</p>\n<pre><code>$ cmake ..\n-- The C compiler identification is GNU 4.4.7\n-- The CXX compiler identification is GNU 4.4.7\n-- Check for working C compiler: /usr/bin/cc\n-- Check for working C compiler: /usr/bin/cc -- works\n-- Detecting C compiler ABI info\n-- Detecting C compiler ABI info - done\n-- Check for working CXX compiler: /usr/bin/c++\n-- Check for working CXX compiler: /usr/bin/c++ -- works\n-- Detecting CXX compiler ABI info\n-- Detecting CXX compiler ABI info - done\nFound X11 at /usr/lib/libX11.so\n-- Configuring done\n-- Generating done\n-- Build files have been written to: $HOME/software/64bit_problem/build\n</code></pre>\n<p>(The key part here is the <code>Found X11 at /usr/lib/libX11.so</code> line)</p>\n<p>However, if I do the same thing on an RHEL5 system, it correctly detects the <code>/usr/lib64/</code> version: (Note that I'm clearing out the <code>CMakeCache.txt</code> and other temporary cmake-files in between runs.)</p>\n<pre><code>$ cmake ..\n-- The C compiler identification is GNU 4.1.2\n-- The CXX compiler identification is GNU 4.1.2\n-- Check for working C compiler: /usr/bin/cc\n-- Check for working C compiler: /usr/bin/cc -- works\n-- Detecting C compiler ABI info\n-- Detecting C compiler ABI info - done\n-- Check for working CXX compiler: /usr/bin/c++\n-- Check for working CXX compiler: /usr/bin/c++ -- works\n-- Detecting CXX compiler ABI info\n-- Detecting CXX compiler ABI info - done\nFound X11 at /usr/lib64/libX11.so\n-- Configuring done\n-- Generating done\n-- Build files have been written to: $HOME/software/64bit_problem/build\n</code></pre>\n<h1>Troubleshooting Info</h1>\n<p>The <code>/usr/lib64</code> versions of the libraries exist on both systems.  Here's the listing on the RHEL6 system:</p>\n<pre><code>$ ls /usr/lib64/libX11.so*\n/usr/lib64/libX11.so.6  /usr/lib64/libX11.so.6.3.0\n</code></pre>\n<p>And on the RHEL5 system:</p>\n<pre><code>$ ls /usr/lib64/libX11.so*\n/usr/lib64/libX11.so.6  /usr/lib64/libX11.so.6.3.0\n</code></pre>\n<p>Just to confirm that <code>/usr/lib</code> is indeed the 32-bit versions (also, it's not a symlink to another location):</p>\n<pre><code>$ file /usr/lib/libX11.so*\n/usr/lib/libX11.so:       symbolic link to `libX11.so.6.3.0'\n/usr/lib/libX11.so.6:     symbolic link to `libX11.so.6.3.0'\n/usr/lib/libX11.so.6.3.0: ELF 32-bit LSB shared object, Intel 80386, version 1 (SYSV), dynamically linked, stripped\n\n$ file /usr/lib64/libX11.so*\n/usr/lib64/libX11.so.6:     symbolic link to `libX11.so.6.3.0'\n/usr/lib64/libX11.so.6.3.0: ELF 64-bit LSB shared object, x86-64, version 1 (SYSV), dynamically linked, stripped\n</code></pre>\n<p>This is probably due to an environment setting somewhere, but I'm a bit stumped as to where.  I don't have <code>LD_LIBRARY_PATH</code>, <code>LD_RUN_PATH</code>, or <code>LDFLAGS</code> set. Same for <code>CFLAGS</code> and <code>CXXFLAGS</code>.  My user environment should be identical, as my $HOME is an NFS share that's the same on both machines.</p>\n<p><code>/usr/lib</code> isn't in my <code>$PATH</code>, and regardless, limiting my path to a minimal subset doesn't seem to help:</p>\n<pre><code>$ export PATH=/bin:/usr/bin:$HOME/local/bin\n\n$ cmake ..\n&lt;snip&gt;\nFound X11 at /usr/lib/libX11.so\n-- Configuring done\n&lt;snip&gt;\n</code></pre>\n<p>@SergyA had the excellent suggestion of checking which environment variables were being accessed by using <code>ltrace</code>. <code>strace</code> didn't turn up anything diagnostic from what I could see, but <code>ltrace</code> shows the environment variable access nicely. Here's a quick summary:</p>\n<pre><code>$ ltrace -o ltrace_output cmake ..\n\n$ grep getenv ltrace_output\ngetenv(&quot;PWD&quot;)                                                    = &quot;$HOME/software/64bit_problem&quot;\ngetenv(&quot;PATH&quot;)                                                   = &quot;/bin:/usr/bin:$HOME/local/bin&quot;\ngetenv(&quot;CMAKE_ROOT&quot;)                                             = NULL\ngetenv(&quot;MAKEFLAGS&quot;)                                              = NULL\ngetenv(&quot;VERBOSE&quot;)                                                = NULL\ngetenv(&quot;CFLAGS&quot;)                                                 = NULL\ngetenv(&quot;LDFLAGS&quot;)                                                = NULL\ngetenv(&quot;LDFLAGS&quot;)                                                = NULL\ngetenv(&quot;LDFLAGS&quot;)                                                = NULL\ngetenv(&quot;CXXFLAGS&quot;)                                               = NULL\ngetenv(&quot;LDFLAGS&quot;)                                                = NULL\ngetenv(&quot;LDFLAGS&quot;)                                                = NULL\ngetenv(&quot;LDFLAGS&quot;)                                                = NULL\n</code></pre>\n<h3><code>cmake</code>-specific Trobleshooting</h3>\n<p>The cmake version is identical on both machines (in fact, it's the same executable for reasons I'll omit for brevity):</p>\n<pre><code>$ cmake --version\ncmake version 2.8.11.2\n\n$ which cmake\n$HOME/local/bin/cmake\n</code></pre>\n<p>I've tried explicitly enabling <code>FIND_LIBRARY_USE_LIB64_PATHS</code>, but this doesn't seem to make a difference:</p>\n<pre><code>cmake_minimum_required(VERSION 2.8)\n\nset_property(GLOBAL PROPERTY FIND_LIBRARY_USE_LIB64_PATHS ON)\n\nfind_library(XTEST X11)\nmessage(&quot;Found X11 at ${XTEST}&quot;)\n</code></pre>\n<p>As @Ravi mentioned, this is more likely due to some issue with <code>CMAKE_LIBRARY_PATH</code>, but it's not set, and changing it as either an environment variable or as a cmake variable doesn't seem to help.  However, I fully admit I am largely ignorant of the various cmake configuration variables, so it's very likely that I'm missing something obvious here.</p>\n<p>One key thing I've recently realized is that it's not all libraries... For example:</p>\n<pre><code>cmake_minimum_required(VERSION 2.8)\n\nfind_library(PNGTEST png)\nmessage(&quot;Found libpng at ${PNGTEST}&quot;)\n</code></pre>\n<p>Finds <code>/usr/lib64/libpng.so</code> instead of <code>/usr/lib/libpng.so</code>.</p>\n<p>This leads me to think it's something cmake-specific, at any rate.</p>\n<h3><code>find_package</code> instead of <code>find_library</code></h3>\n<p>Given the library-specific issues I mentioned above, I thought to try finding the entire X11 package instead of a single library (which is really what the codebase I was working with should have done anyway).</p>\n<p>However, I'm getting even more confusing results... It seems to be detecting a mix of 64-bit and 32-bit libraries?  For example:</p>\n<pre><code>cmake_minimum_required(VERSION 2.8)\n\nFIND_PACKAGE(X11 REQUIRED)\n\nmessage(&quot;X11_LIBRARIES: ${X11_LIBRARIES}&quot;)\n</code></pre>\n<p>We'll get:</p>\n<pre><code>$ cmake ..\n&lt;snip&gt;\n-- Looking for XOpenDisplay in /usr/lib/libX11.so;/usr/lib/libXext.so\n-- Looking for XOpenDisplay in /usr/lib/libX11.so;/usr/lib/libXext.so - not found\n&lt;snip&gt;\n-- Found X11: /usr/lib/libX11.so\nX11_LIBRARIES: /usr/lib64/libSM.so;/usr/lib64/libICE.so;/usr/lib/libX11.so;/usr/lib/libXext.so\n-- Configuring done\n&lt;snip&gt;\n</code></pre>\n<p>However, if we have a look at these specific libraries in <code>X11_LIBRARIES</code>, they're a mix of 32-bit and 64-bit versions!</p>\n<pre><code>$ file /usr/lib64/libSM.so.6.0.1\n/usr/lib64/libSM.so.6.0.1: ELF 64-bit LSB shared object, x86-64, &lt;snip&gt;\n\n$ file /usr/lib64/libICE.so.6.3.0\n/usr/lib64/libICE.so.6.3.0: ELF 64-bit LSB shared object, x86-64, &lt;snip&gt;\n\n$ file /usr/lib/libX11.so.6.3.0\n/usr/lib/libX11.so.6.3.0: ELF 32-bit LSB shared object, Intel 80386, &lt;snip&gt;\n\n$ file /usr/lib/libXext.so.6.4.0\n/usr/lib/libXext.so.6.4.0: ELF 32-bit LSB shared object, Intel 80386, &lt;snip&gt;\n</code></pre>\n<h1>In summary, what else should I try?</h1>\n<p>Am I missing a cmake-specific or possibly X11-specific configuration option?</p>\n"}, {"tags": ["c", "hex", "unsigned", "base-conversion"], "comments": [{"owner": {"reputation": 11, "user_id": 4227122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/429b1b7dc9e1952f81e2d775994aea34?s=128&d=identicon&r=PG&f=1", "display_name": "Mohammad M Moshawrab", "link": "https://stackoverflow.com/users/4227122/mohammad-m-moshawrab"}, "reply_to_user": {"reputation": 13248, "user_id": 3375713, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/fUsUA.png?s=128&g=1", "display_name": "S\u043d\u0430\u0111\u043e\u0448\u0192\u0430\u04fd", "link": "https://stackoverflow.com/users/3375713/s%d0%bd%d0%b0%c4%91%d0%be%d1%88%c6%92%d0%b0%d3%bd"}, "edited": false, "score": 0, "creation_date": 1458154273, "post_id": 36044032, "comment_id": 59737579, "body": "I tried a lot, but without any result, i prefer to have something guaranteed to test it. i cant post all what i tried"}, {"owner": {"reputation": 107760, "user_id": 451475, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a632afa4c11779c0cabd7df04eb26ba6?s=128&d=identicon&r=PG", "display_name": "zaph", "link": "https://stackoverflow.com/users/451475/zaph"}, "edited": false, "score": 0, "creation_date": 1458161545, "post_id": 36044032, "comment_id": 59741955, "body": "I think there is some confusion about what a &quot;hexadecimal array &quot; is. Perhaps you need to step back to the real problem, your encryption code."}, {"owner": {"reputation": 15260, "user_id": 1968182, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/E5nF2.jpg?s=128&g=1", "display_name": "Ulrich Eckhardt", "link": "https://stackoverflow.com/users/1968182/ulrich-eckhardt"}, "edited": false, "score": 0, "creation_date": 1458162524, "post_id": 36044032, "comment_id": 59742493, "body": "Your question has been asked and aswered hundreds of times over. You should do some research, just dump your title into a websearch and read the first few results."}, {"owner": {"reputation": 107760, "user_id": 451475, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a632afa4c11779c0cabd7df04eb26ba6?s=128&d=identicon&r=PG", "display_name": "zaph", "link": "https://stackoverflow.com/users/451475/zaph"}, "edited": false, "score": 0, "creation_date": 1458223883, "post_id": 36044032, "comment_id": 59772553, "body": "Consider accepting answers that are helpful.   To accept an answer click on the hollow checkmark next to the answer that is best, doing so will increase your reputation and allow more capabilities, See <a href=\"http://stackoverflow.com/faq#reputation\">reputation faq</a>  See <a href=\"http://meta.stackoverflow.com/questions/5234/how-does-accepting-an-answer-work\">this page</a> for more detail."}, {"owner": {"reputation": 11, "user_id": 4227122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/429b1b7dc9e1952f81e2d775994aea34?s=128&d=identicon&r=PG&f=1", "display_name": "Mohammad M Moshawrab", "link": "https://stackoverflow.com/users/4227122/mohammad-m-moshawrab"}, "edited": false, "score": 0, "creation_date": 1458238476, "post_id": 36044032, "comment_id": 59783330, "body": "i hope i could clarify my question. i rephrased it. Thanks all for your cooperation"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 4227122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/429b1b7dc9e1952f81e2d775994aea34?s=128&d=identicon&r=PG&f=1", "display_name": "Mohammad M Moshawrab", "link": "https://stackoverflow.com/users/4227122/mohammad-m-moshawrab"}, "edited": false, "score": 0, "creation_date": 1458157452, "post_id": 36044520, "comment_id": 59739505, "body": "it may seem weird. but i am trying first to convert each character to hexademical representation through this: sprintf(TempBuffer,&quot;0x%x&quot;,InText[i]); then i want to store the data of temp buffer which will be as 0x54 or 0x78 or something like this i want to store it in an unsigned character of type uint8_t which defined to be of this format. excuse my questions."}, {"owner": {"reputation": 11, "user_id": 4227122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/429b1b7dc9e1952f81e2d775994aea34?s=128&d=identicon&r=PG&f=1", "display_name": "Mohammad M Moshawrab", "link": "https://stackoverflow.com/users/4227122/mohammad-m-moshawrab"}, "edited": false, "score": 0, "creation_date": 1458238541, "post_id": 36044520, "comment_id": 59783375, "body": "Thanks for your advises. i rephrased the question all again. and i deleted the answer i had posted previously. hope i can find a solution for the point i stated above"}, {"owner": {"reputation": 13248, "user_id": 3375713, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/fUsUA.png?s=128&g=1", "display_name": "S\u043d\u0430\u0111\u043e\u0448\u0192\u0430\u04fd", "link": "https://stackoverflow.com/users/3375713/s%d0%bd%d0%b0%c4%91%d0%be%d1%88%c6%92%d0%b0%d3%bd"}, "reply_to_user": {"reputation": 11, "user_id": 4227122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/429b1b7dc9e1952f81e2d775994aea34?s=128&d=identicon&r=PG&f=1", "display_name": "Mohammad M Moshawrab", "link": "https://stackoverflow.com/users/4227122/mohammad-m-moshawrab"}, "edited": false, "score": 0, "creation_date": 1458239933, "post_id": 36044520, "comment_id": 59784235, "body": "@MohammadMMoshawrab Look at the edited answer. Hope that helps, finally!"}, {"owner": {"reputation": 11, "user_id": 4227122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/429b1b7dc9e1952f81e2d775994aea34?s=128&d=identicon&r=PG&f=1", "display_name": "Mohammad M Moshawrab", "link": "https://stackoverflow.com/users/4227122/mohammad-m-moshawrab"}, "edited": false, "score": 0, "creation_date": 1458240263, "post_id": 36044520, "comment_id": 59784445, "body": "we are a little bit far from the solution. the edit you put is very good except that the type of the array i will store the hexadecimal in is not a characters array but of type uint8_t and it can&#39;t be used in the strcpy() function.. that what is making it confusing. if it was storing in another array of characters then it will be easily handled. but unfortunately it is not the case."}, {"owner": {"reputation": 11, "user_id": 4227122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/429b1b7dc9e1952f81e2d775994aea34?s=128&d=identicon&r=PG&f=1", "display_name": "Mohammad M Moshawrab", "link": "https://stackoverflow.com/users/4227122/mohammad-m-moshawrab"}, "edited": false, "score": 0, "creation_date": 1458241585, "post_id": 36044520, "comment_id": 59785171, "body": "it seems i am not understanding the concept of uint8_t..can some body grant some help in this. i am not a C expert."}], "tags": [], "owner": {"reputation": 13248, "user_id": 3375713, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/fUsUA.png?s=128&g=1", "display_name": "S\u043d\u0430\u0111\u043e\u0448\u0192\u0430\u04fd", "link": "https://stackoverflow.com/users/3375713/s%d0%bd%d0%b0%c4%91%d0%be%d1%88%c6%92%d0%b0%d3%bd"}, "is_accepted": false, "score": 0, "last_activity_date": 1458243288, "last_edit_date": 1495541683, "creation_date": 1458154308, "answer_id": 36044520, "question_id": 36044032, "link": "https://stackoverflow.com/questions/36044032/convert-a-string-of-characters-to-an-unsigned-character-in-c/36044520#36044520", "title": "Convert a string of characters to an unsigned Character in C", "body": "<p>May be what you need is <a href=\"http://www.cplusplus.com/reference/cstdlib/atoi/\" rel=\"nofollow noreferrer\"><code>atoi</code></a> to convert your string to integer, and then some way to convert that integer in decimal to hexadecimal. Take a look <a href=\"https://stackoverflow.com/questions/3464194/how-can-i-convert-an-integer-to-a-hexadecimal-string-in-c\">this SO post</a>. To convert to hex, I prefer to use <a href=\"http://www.cplusplus.com/reference/cstdio/sprintf/\" rel=\"nofollow noreferrer\"><code>sprintf</code></a>.</p>\n\n<strong>Converting string to decimal:</strong>\n\n<pre><code>char decstr[] = \"1202\";\nint  decimal = atoi(decstr);\nprintf(\"%d\\n\", decimal);\n\n// prints 1202\n</code></pre>\n\n<strong>Converting decimal to hexadecimal:</strong>\n\n<pre><code>char hex[5];\nsprintf(hex, \"%x\", decimal);\nprintf(\"%s\\n\", hex);\n\n// prints 4b2\n</code></pre>\n\n<hr>\n\n<p><strong>Edited after OP added an example</strong></p>\n\n<p>As each hexadecimal representation in your case will have length of four, you need to define a 2d uint8_t array. Take a look below:</p>\n\n<pre><code>uint8_t TextToEncrypt[16][4];\n\nvoid ToHex(char InText[])\n{\n    int i, j;\n    char TempBuffer[4];\n\n    for(i=0; i&lt;16; i++)\n    {\n        sprintf(TempBuffer,\"0x%x\", InText[i]);\n        for (j = 0; j &lt; 4; ++j)\n            TextToEncrypt[i][j] = TempBuffer[j];\n    }\n\n    for (i = 0; i &lt; 16; ++i)\n    {\n        for(j=0; j&lt;4; ++j)\n            printf(\"%c\", TextToEncrypt[i][j]);\n        printf(\"\\n\");\n    }\n}\n</code></pre>\n\n<p>Remember to include the header <code>stdint.h</code>, if you are using <a href=\"https://stackoverflow.com/questions/8953274/unknown-type-name-uint8-t-mingw\">MinGW compiler</a></p>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 4227122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/429b1b7dc9e1952f81e2d775994aea34?s=128&d=identicon&r=PG&f=1", "display_name": "Mohammad M Moshawrab", "link": "https://stackoverflow.com/users/4227122/mohammad-m-moshawrab"}, "edited": false, "score": 0, "creation_date": 1458160278, "post_id": 36046141, "comment_id": 59741202, "body": "thanks a lot but my problem is to store the converted text in an array of unsigned integer and not in a character array. i can&#39;t encrypt an array of characters based on the algorithm i am using... any ideas"}], "tags": [], "owner": {"reputation": 107760, "user_id": 451475, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a632afa4c11779c0cabd7df04eb26ba6?s=128&d=identicon&r=PG", "display_name": "zaph", "link": "https://stackoverflow.com/users/451475/zaph"}, "is_accepted": false, "score": 0, "last_activity_date": 1464013787, "last_edit_date": 1464013787, "creation_date": 1458159565, "answer_id": 36046141, "question_id": 36044032, "link": "https://stackoverflow.com/questions/36044032/convert-a-string-of-characters-to-an-unsigned-character-in-c/36046141#36046141", "title": "Convert a string of characters to an unsigned Character in C", "body": "<p>I still don't know exactly what you want, here is another try.</p>\n\n<p>This is just to give you an idea, there are still lots of problems such as handling bad input and doing something with <code>outText</code>:</p>\n\n<pre><code>void toHex(char InText[])\n{\n    static int outInts[17];\n\n    for(int i=0; i&lt;16; i++)\n    {\n        outInts[i] = InText[i];\n    }\n    for (int i=0; i&lt;16; i++) {\n        printf(\"%i, \", outInts[i]);\n    }\n    printf(\"\\n\");\n}\n    toHex(\"abcdefghijklmnopq\");\n</code></pre>\n\n<p>Output:</p>\n\n<blockquote>\n  <p>97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112</p>\n</blockquote>\n\n<p>If this is not what you want you need to provide an example.</p>\n"}], "owner": {"reputation": 11, "user_id": 4227122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/429b1b7dc9e1952f81e2d775994aea34?s=128&d=identicon&r=PG&f=1", "display_name": "Mohammad M Moshawrab", "link": "https://stackoverflow.com/users/4227122/mohammad-m-moshawrab"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 146, "favorite_count": 0, "answer_count": 2, "score": -3, "last_activity_date": 1464013787, "creation_date": 1458152855, "last_edit_date": 1458246884, "question_id": 36044032, "link": "https://stackoverflow.com/questions/36044032/convert-a-string-of-characters-to-an-unsigned-character-in-c", "title": "Convert a string of characters to an unsigned Character in C", "body": "<p>I am searching for a way to convert a string of characters into a string of their hexadecimal representations. So the letter <code>A</code> will be represented as <code>0x41</code>.</p>\n\n<p>What I am trying to do is encrypting a text file using an algorithm that encrypts hexadecimal characters of notation 0x** where ** resembles the hexadecimal notation of the character.</p>\n\n<p>I am reading an array of 16 characters from the file to an array of characters, then I should convert them to hexadecimal notation so I can pass them to the encryption function.</p>\n\n<p>I am using the following snippet of code to convert the array of characters to hexadecimal. I created a TempBuffer to hold the hexadecimal value for each character so it will be in the notation 0x**. My problem is how to store the value in TempBuffer to an element of the Unsigned characters array. Look the code below:</p>\n\n<pre><code>static uint8_t TextToEncrypt[16]; // Declaring the array to store the hexadecimal notation\n\nvoid ToHex(char InText[]) // The Function to Convert an array of characters to hexadecimal array\n{\n    int i=0;\n    for(i=0; i&lt;16; i++)\n    {\n        char TempBuffer[4]; // Tempbuffer to hold the converted value \n        sprintf(TempBuffer,\"0x%x\",InText[i]); // converting to hexadecimal\n        // Here i need to store the value in TempBuffer which will be something like 0x41 in TextToEncrypt[i] so I can pass it to encryption\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "recursion"], "comments": [{"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 1, "creation_date": 1458152898, "post_id": 36044010, "comment_id": 59736773, "body": "did you try to step through using a debugger?"}, {"owner": {"reputation": 16237, "user_id": 2166798, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/417356917295f5176d2a3e7c21d8f9e8?s=128&d=identicon&r=PG", "display_name": "pjs", "link": "https://stackoverflow.com/users/2166798/pjs"}, "edited": false, "score": 1, "creation_date": 1458153006, "post_id": 36044010, "comment_id": 59736837, "body": "How do you plan to have your program return results for &quot;sad&quot; numbers, where the calculations repeat indefinitely?  Have you really thought this through?"}, {"owner": {"reputation": 29, "user_id": 5896090, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tOI0r.jpg?s=128&g=1", "display_name": "Spyreto", "link": "https://stackoverflow.com/users/5896090/spyreto"}, "edited": false, "score": 0, "creation_date": 1458153138, "post_id": 36044010, "comment_id": 59736919, "body": "Yes and it helps me to find a lot of bugs but nothing further..."}, {"owner": {"reputation": 999, "user_id": 5668691, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51b2f0199abaed8efe849372dc60bb35?s=128&d=identicon&r=PG&f=1", "display_name": "Sudipta Kumar Sahoo", "link": "https://stackoverflow.com/users/5668691/sudipta-kumar-sahoo"}, "edited": false, "score": 0, "creation_date": 1458153252, "post_id": 36044010, "comment_id": 59736985, "body": "@Spyreto &quot;Sad Number&quot; will eventually overflow either the heap/stack. that&#39;s why you are getting the error. the program cannot go forever."}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1458153271, "post_id": 36044010, "comment_id": 59737001, "body": "Then use it to fix those <i>lot of bugs</i> until it shows you the problem."}, {"owner": {"reputation": 29, "user_id": 5896090, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tOI0r.jpg?s=128&g=1", "display_name": "Spyreto", "link": "https://stackoverflow.com/users/5896090/spyreto"}, "edited": false, "score": 0, "creation_date": 1458153730, "post_id": 36044010, "comment_id": 59737289, "body": "The returning right now is for testing i am focusing  on functionality. I don&#39;t think that the calculations repeat indefinitely but I will check the mathematically background of the basic condition in happy faction"}, {"owner": {"reputation": 16237, "user_id": 2166798, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/417356917295f5176d2a3e7c21d8f9e8?s=128&d=identicon&r=PG", "display_name": "pjs", "link": "https://stackoverflow.com/users/2166798/pjs"}, "edited": false, "score": 0, "creation_date": 1458153923, "post_id": 36044010, "comment_id": 59737389, "body": "@Spyreto What is the point of a program which only works with already-known solutions?  At that point, it&#39;s essentially a table lookup for those solutions, and a gamble for anything else."}, {"owner": {"reputation": 29, "user_id": 5896090, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tOI0r.jpg?s=128&g=1", "display_name": "Spyreto", "link": "https://stackoverflow.com/users/5896090/spyreto"}, "reply_to_user": {"reputation": 16237, "user_id": 2166798, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/417356917295f5176d2a3e7c21d8f9e8?s=128&d=identicon&r=PG", "display_name": "pjs", "link": "https://stackoverflow.com/users/2166798/pjs"}, "edited": false, "score": 0, "creation_date": 1458154469, "post_id": 36044010, "comment_id": 59737698, "body": "@pjs  you have right I didn&#39;t  approached it enough before I post it. I will look into  better. Thanks for your time."}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 5896090, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tOI0r.jpg?s=128&g=1", "display_name": "Spyreto", "link": "https://stackoverflow.com/users/5896090/spyreto"}, "edited": false, "score": 0, "creation_date": 1458154686, "post_id": 36044249, "comment_id": 59737813, "body": "You&#39;re right, in my attempt to do it more efficiently(because tis is the main object of the problem 10s runtime and 256mb memory limit ) I did not think about it."}], "tags": [], "owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "is_accepted": false, "score": 1, "last_activity_date": 1458153404, "creation_date": 1458153404, "answer_id": 36044249, "question_id": 36044010, "link": "https://stackoverflow.com/questions/36044010/c-program-which-is-finding-happy-nums-recursively/36044249#36044249", "title": "C program which is finding &quot;happy&quot; nums recursively", "body": "<p>by the definition of your program sad numbers will cause your program to run forever</p>\n\n<blockquote>\n  <p>Conversely, if the process is repeated indefinitely</p>\n</blockquote>\n\n<p>You need to add a stopping condition, like if I have looped for 1000 times, or if you hit a well known non terminating number (like 4) (is there a definite list of these? I dont know)</p>\n"}, {"comments": [{"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 0, "creation_date": 1458198585, "post_id": 36045964, "comment_id": 59754896, "body": "Hmmm. This will mark (nearly) any number with two or more digits as happy. The single-digit happy numbers are 1 and 7; I&#39;m not sure why you test for 3, 6 and 9."}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 0, "creation_date": 1458198736, "post_id": 36045964, "comment_id": 59754973, "body": "Other points: Your function <code>happy</code> should return an integer that indicates whether a number is happy or not instead of storing that information in a global value. I&#39;ve said in my answer that you shouldn&#39;t allocate with <code>malloc</code> in the first place, but if you must allocate, dont allocate based on <code>A</code> and re-allocate; allocate based on the highest number <code>B</code> from the start."}], "tags": [], "owner": {"reputation": 29, "user_id": 5896090, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tOI0r.jpg?s=128&g=1", "display_name": "Spyreto", "link": "https://stackoverflow.com/users/5896090/spyreto"}, "is_accepted": true, "score": 0, "last_activity_date": 1458159001, "creation_date": 1458159001, "answer_id": 36045964, "question_id": 36044010, "link": "https://stackoverflow.com/questions/36044010/c-program-which-is-finding-happy-nums-recursively/36045964#36045964", "title": "C program which is finding &quot;happy&quot; nums recursively", "body": "<p>I find this solution tested and working..\nThanks for your time and I am sorry for my vagueness.\nEvery advice about this solution would be welcome </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n\nvoid happy( char * A, int n);\nint numPlaces (long n);\nint happynum = 0;\nint main(void)\n{\n    long A,B;\n    int npA;\n    char *Ap;\n    printf(\"Give 2 Numbers\\n\");\n    scanf(\"%li %li\",&amp;A,&amp;B);\n    npA = numPlaces(A);\n    Ap = malloc(npA);\n    //Search for happy numbers from A to B\n    do{\n        sprintf(Ap, \"%ld\", A);\n        happy(Ap,npA);\n        if (happynum ==1)\n        printf(\"%s\\n\",Ap);\n        A++;\n        if ( npA &lt; numPlaces(A) )\n        {\n            npA++;\n            Ap = realloc(Ap, npA);\n        }\n\n    }while( A &lt;= B);\n\n\n\n\n}\n//Finds happy numbers\nvoid happy( char * A, int n)\n    {   \n        //Basic Condition\n        if ( n == 1)\n        {\n            if (A[0] == '3' || A[0] == '6' || A[0] == '9')\n            {\n                happynum = 0;\n            }    \n            else\n            {\n                happynum = 1;\n            }\n            return;\n        }\n        long sum = 0;\n        char * sumA;\n        int nsum;\n        int Ai;\n        //Sum the squares of the current number\n        for(int i = 0 ; i &lt; n;i++)\n        {\n            Ai = (int)(A[i]-48);\n            sum = sum +  (Ai*Ai);\n        }\n        nsum = numPlaces (sum);\n        sumA = malloc(nsum);\n        sprintf(sumA, \"%li\", sum);\n        happy(sumA,nsum);\n        free(sumA);\n    }\n\n//Count digits of a number \nint numPlaces (long n) \n    {\n        if (n &lt; 0) return 0;\n        if (n &lt; 10) return 1;\n        return 1 + numPlaces (n / 10);\n    }\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 29, "user_id": 5896090, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tOI0r.jpg?s=128&g=1", "display_name": "Spyreto", "link": "https://stackoverflow.com/users/5896090/spyreto"}, "edited": false, "score": 0, "creation_date": 1458162567, "post_id": 36046483, "comment_id": 59742520, "body": "I am self-taught  ( just for hobby ), anyway I find your advices very helpful! Thank you very much for your time!"}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "reply_to_user": {"reputation": 29, "user_id": 5896090, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tOI0r.jpg?s=128&g=1", "display_name": "Spyreto", "link": "https://stackoverflow.com/users/5896090/spyreto"}, "edited": false, "score": 0, "creation_date": 1458198792, "post_id": 36046483, "comment_id": 59755002, "body": "That&#39;s okay; programming is a nice hobby. But the compiler doesn&#39;t care whether you&#39;re a hobbyist or a professional. <code>:)</code>"}], "tags": [], "owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "is_accepted": false, "score": 0, "last_activity_date": 1458160794, "creation_date": 1458160794, "answer_id": 36046483, "question_id": 36044010, "link": "https://stackoverflow.com/questions/36044010/c-program-which-is-finding-happy-nums-recursively/36046483#36046483", "title": "C program which is finding &quot;happy&quot; nums recursively", "body": "<p>Your code uses some questionable practices. Yoe may be misguided because you are concerned about performance and memory usage.</p>\n\n<ul>\n<li><p>When you allocate memory for the string, you forget to allocate one character for the null terminator. But you shouldn't be allocating, re-allocating and freeing constantly anyway. Dynamic memory allocation is expensive compared to your other operations.</p>\n\n<p>Your limits are <code>long</code>, which may be a 32-bit or 64-bit signed integer, depending on your platform. The maximum number that can be represented with e 64-bit signed integer is 9,223,372,036,854,775,807. This is a number with 19 digits. Add one for the null terminator and one for a possible minus sign, so that overflow won't hurt, you and use a buffer of 21 chars on the stack.</p></li>\n<li><p>You probably shouldn't be using strings inthe first place. Use the basic code to extract the digits: Split off the digit by taking the remainder of a division by 10. Then divide by 10 until you get zero. (And if you use strings with a fixed buffer size, as described above, you don't have to calculate the difits separately: <code>sprintf</code> returns the number of characters written to the string.</p></li>\n<li><p>Your functions shouldn't be recursive. A loop is enough. As pm100 has noted, you need a termination criterion: You must keep track of the numbers that you have already visited. Each recursive call creates a new state; it is easier to keep an array, that can be repeatedly looked at in a loop. When you see a number that you have already seen (other than 1, of course), your number is sad.</p></li>\n</ul>\n\n<p>Happy and sad numbers have this property that when your sum of squares is a number with a known happiness, the original number has this happiness, too. If you visit a known das number, the original number is sad. If you visit a known happy number, the original number is happy.</p>\n\n<p>The limits of your ranges may ba large, but the sum of square digits is not large; it can be at most the number of digits times 81. In particular:</p>\n\n<pre><code>    type                   max. number    number of max. square sum       dss\n\n    int                  2,147,483,647                1,999,999,999       730\n    uint                 4,294,967,295                3,999,999,999       738\n    long     9,223,372,036,854,775,807    8,999,999,999,999,999,999      1522\n    ulong   18,446,744,073,709,55,1616    9,999,999,999,999,999,999      1539\n</code></pre>\n\n<p>That means that when you take the sum of digit squares of an unsigned long, you will get a number that is smaller than 1540. Create an array of 1540 entries and mark all known happy numbers with 1. Then you can reduce your problem to taking the sum of digit squares once and then looking up the happiness of the number in this array.</p>\n\n<p>(You can do the precalculation of the array once when you start the program.)</p>\n"}], "owner": {"reputation": 29, "user_id": 5896090, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tOI0r.jpg?s=128&g=1", "display_name": "Spyreto", "link": "https://stackoverflow.com/users/5896090/spyreto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 162, "favorite_count": 0, "accepted_answer_id": 36045964, "answer_count": 3, "score": -2, "last_activity_date": 1458160794, "creation_date": 1458152789, "last_edit_date": 1458153669, "question_id": 36044010, "link": "https://stackoverflow.com/questions/36044010/c-program-which-is-finding-happy-nums-recursively", "title": "C program which is finding &quot;happy&quot; nums recursively", "body": "<p>Hello guys i am trying to implement a program which is finding the <strong>happy</strong> numbers were between two numbers A and B.</p>\n\n<p>Summing the squares of all the digits of the number, we replace the number with the outcome, and repeat the process. If after some steps the result is equal to 1 (and stay there), then we say that the number N is <code>**&lt;happy&gt;**</code>. Conversely, if the process is repeated indefinitely without ever showing the number 1, then we say that the number N is <code>**&lt;sad&gt;**</code>.</p>\n\n<p><em>For example, the number 7 is happy because the procedure described above leads to the following steps: 7, 49, 97, 130, 10, 1, 1, 1 ... Conversely, the number 42 is sad because the process leads to a infinite sequence 42, 20, 4, 16, 37, 58, 89, 145, 42, 20, 4, 16, 37 ...</em></p>\n\n<p>I try this right down but i am getting either segm faults or no results.\nThanks in advance.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n\nvoid happy( char * A, int n);\nint numPlaces (long n);\n\nint main(void)\n{\n    long A,B;\n    int npA;\n    char *Ap;\n    printf(\"Give 2 Numbers\\n\");\n    scanf(\"%li %li\",&amp;A,&amp;B);\n    npA = numPlaces(A);\n    Ap = malloc(npA);\n    printf(\"%ld %d\\n\",A,npA);\n    //Search for happy numbers from A to B\n    do{\n        sprintf(Ap, \"%ld\", A);\n        happy(Ap,npA);\n        A++;\n        if ( npA &lt; numPlaces(A) )\n        {\n            npA++;\n            Ap = realloc(Ap, npA);\n        }\n\n    }while( A &lt;= B);\n\n\n\n\n}\n//Finds happy numbers\nvoid happy( char * A, int n)\n    {   \n        //Basic Condition\n        if ( n == 1)\n        {\n            if (A[0] == 1 || A[0] == 7)\n            printf(\"%c\\n\",A[0]);\n            printf(\"%s\\n\",A);\n            return;\n        }\n        long sum = 0 ;\n        char * sumA;\n        int nsum;\n        int Ai;\n        //Sum the squares of the current number\n        for(int i = 0 ; i &lt; n;i++)\n        {\n            Ai = atoi(&amp;A[i]);\n            sum = sum +  (Ai*Ai);\n        }\n        nsum = numPlaces (sum);\n        sumA = malloc(nsum);\n        sprintf(sumA, \"%li\", sum);\n        happy(sumA,nsum);\n        free(sumA);\n    }\n\n//Count digits of a number \nint numPlaces (long n) \n    {\n        if (n &lt; 0) return 0;\n        if (n &lt; 10) return 1;\n        return 1 + numPlaces (n / 10);\n    }\n</code></pre>\n\n<p>Thanks for your time.   </p>\n"}, {"tags": ["c", "arrays"], "answers": [{"tags": [], "owner": {"reputation": 4011, "user_id": 1477064, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/cd12123a743db34ac0b055a6fa736788?s=128&d=identicon&r=PG", "display_name": "xvan", "link": "https://stackoverflow.com/users/1477064/xvan"}, "is_accepted": false, "score": 0, "last_activity_date": 1458155928, "last_edit_date": 1458155928, "creation_date": 1458155410, "answer_id": 36044894, "question_id": 36043856, "link": "https://stackoverflow.com/questions/36043856/character-arrays-in-c-gcc-compiler/36044894#36044894", "title": "Character arrays in C- GCC compiler", "body": "<p>C arrays aren't aware of their own size, so there's a standardised convention of using the special character <code>'\\0'</code> to  mark the end of a string.</p>\n\n<p>So if you want to implement your own <code>puts()</code> you can implement it like:</p>\n\n<pre><code>int puts(const char *s){\n   int i=0;\n   while(s[i]!='\\0'){\n      putc(s[i]);\n      i++\n   }\n   return i;\n</code></pre>\n\n<p>}</p>\n\n<p>It's just a language convention, non mandatory because the computer needs it but because the programmers need it. Otherwise you wouldn't know how to stop reading.</p>\n\n<p>When you use a character (or any other type), you know how it's size beforehand so there's no need for marking an end of string.</p>\n"}, {"tags": [], "owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "is_accepted": true, "score": 0, "last_activity_date": 1458156028, "last_edit_date": 1458156028, "creation_date": 1458155684, "answer_id": 36044977, "question_id": 36043856, "link": "https://stackoverflow.com/questions/36043856/character-arrays-in-c-gcc-compiler/36044977#36044977", "title": "Character arrays in C- GCC compiler", "body": "<p>In C, a string basically <em>is</em> an array.  And the size of that array must always be big enough for the terminating null character.  So if I have</p>\n\n<pre><code>char array[10];\n</code></pre>\n\n<p>I can do</p>\n\n<pre><code>array[0] = 'H';\n</code></pre>\n\n<p>or</p>\n\n<pre><code>array[5] = 'x';\n</code></pre>\n\n<p>but I had better stop putting in characters at <code>array[8]</code> so I can do</p>\n\n<pre><code>array[9] = '\\0';\n</code></pre>\n\n<p>at the end.</p>\n\n<p>Bottom line: I can do this:</p>\n\n<pre><code>array[0] = 'C';\narray[1] = 'a';\narray[2] = 't';\narray[3] = '\\0';\nprintf(\"%s\\n\", array);\n</code></pre>\n\n<p>or this:</p>\n\n<pre><code>array[0] = 'S';\narray[1] = 'p';\narray[2] = 'a';\narray[3] = 'g';\narray[4] = 'h';\narray[5] = 'e';\narray[6] = 't';\narray[7] = 't';\narray[8] = 'i';\narray[9] = '\\0';\nprintf(\"%s\\n\", array);\n</code></pre>\n\n<p>but not this:</p>\n\n<pre><code>array[0] = 'H';\narray[1] = 'e';\narray[2] = 'l';\narray[3] = 'i';\narray[4] = 'c';\narray[5] = 'o';\narray[6] = 'p';\narray[7] = 't';\narray[8] = 'e';\narray[9] = 'r';\narray[10] = '\\0';    /* XXX WRONG */\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 5406686, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/647e030b58ad9867592cb8bbed88072e?s=128&d=identicon&r=PG&f=1", "display_name": "VisnuGanth", "link": "https://stackoverflow.com/users/5406686/visnuganth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 36044977, "answer_count": 2, "score": 0, "last_activity_date": 1458156028, "creation_date": 1458152267, "last_edit_date": 1458155800, "question_id": 36043856, "link": "https://stackoverflow.com/questions/36043856/character-arrays-in-c-gcc-compiler", "title": "Character arrays in C- GCC compiler", "body": "<p>This may seem trivial but I am a newbie to programming. In case of a string, we are supposed to keep a space reserved for the null character, so a string of size 10 will only give us 9 memory locations to use. I was wondering whether the same happens when we input letters individually into the array.Can anyone please explain?</p>\n"}, {"tags": ["c", "pointers", "struct"], "comments": [{"owner": {"reputation": 952, "user_id": 5548598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/46ca4f3bb8b45761077cbfd9a6e9d0cf?s=128&d=identicon&r=PG&f=1", "display_name": "Taelsin", "link": "https://stackoverflow.com/users/5548598/taelsin"}, "edited": false, "score": 0, "creation_date": 1458152364, "post_id": 36043811, "comment_id": 59736430, "body": "helper_glpk is a struct, so you should use the <code>.</code> operator rather than the <code>-&gt;</code> operator"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1458152559, "post_id": 36043811, "comment_id": 59736554, "body": "The question should show the function prototype for the <code>genere_contrainte_1</code> function."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1458153812, "post_id": 36043811, "comment_id": 59737332, "body": "In response to the edit: you need to post a <a href=\"http://stackoverflow.com/help/mcve\">Minimal Complete Verifiable Example</a>. It&#39;s not clear what you mean by <i>&quot;.type doesn&#39;t save the value for use outside the function&quot;</i>. It should."}, {"owner": {"reputation": 172, "user_id": 3410991, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/bac95fc33ffe9f71e511c3cfc8d5ba69?s=128&d=identicon&r=PG&f=1", "display_name": "Hayanno", "link": "https://stackoverflow.com/users/3410991/hayanno"}, "edited": false, "score": 0, "creation_date": 1458154228, "post_id": 36043811, "comment_id": 59737554, "body": "Thanks you, I tough my problem was here but it was something else."}], "answers": [{"comments": [{"owner": {"reputation": 172, "user_id": 3410991, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/bac95fc33ffe9f71e511c3cfc8d5ba69?s=128&d=identicon&r=PG&f=1", "display_name": "Hayanno", "link": "https://stackoverflow.com/users/3410991/hayanno"}, "edited": false, "score": 0, "creation_date": 1458153270, "post_id": 36044031, "comment_id": 59737000, "body": "My problem is that I want to access the pointer to type, because I&#39;m inside a function. (I edited my post)"}], "tags": [], "owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "is_accepted": false, "score": 0, "last_activity_date": 1458152854, "creation_date": 1458152854, "answer_id": 36044031, "question_id": 36043811, "link": "https://stackoverflow.com/questions/36043811/how-to-get-pointer-on-a-struct-member-inside-a-struct/36044031#36044031", "title": "How to get pointer on a struct member inside a struct", "body": "<p>The <code>col_bounds</code> member of the <code>HelperGlpk</code> structure is being used as an array. Which is to say that </p>\n\n<pre><code>helper_glpk-&gt;col_bounds[helper_glpk-&gt;cpt_coef]\n</code></pre>\n\n<p>is an instance of the <code>Bounds</code> structure, <em>not</em> a pointer to a <code>Bounds</code> structure. </p>\n\n<p>Hence, the correct syntax uses the dot notation</p>\n\n<pre><code>helper_glpk-&gt;col_bounds[helper_glpk-&gt;cpt_coef].type = GLP_DB;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 172, "user_id": 3410991, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/bac95fc33ffe9f71e511c3cfc8d5ba69?s=128&d=identicon&r=PG&f=1", "display_name": "Hayanno", "link": "https://stackoverflow.com/users/3410991/hayanno"}, "edited": false, "score": 0, "creation_date": 1458153261, "post_id": 36044051, "comment_id": 59736991, "body": "My problem is that I want to access the pointer to type, because I&#39;m inside a function."}], "tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": false, "score": 0, "last_activity_date": 1458152931, "creation_date": 1458152931, "answer_id": 36044051, "question_id": 36043811, "link": "https://stackoverflow.com/questions/36043811/how-to-get-pointer-on-a-struct-member-inside-a-struct/36044051#36044051", "title": "How to get pointer on a struct member inside a struct", "body": "<p><code>helper_glpk-&gt;col_bounds</code> evaluates to a <code>Bounds*</code>.</p>\n\n<p><code>helper_glpk-&gt;col_bounds[helper_glpk-&gt;cpt_coef]</code> evaluates to a <code>Bounds</code>.</p>\n\n<p>Hence, you need to use:</p>\n\n<pre><code>helper_glpk-&gt;col_bounds[helper_glpk-&gt;cpt_coef].type = GLP_DB;\n                                           // ^^ Use . not -&gt;\n</code></pre>\n"}], "owner": {"reputation": 172, "user_id": 3410991, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/bac95fc33ffe9f71e511c3cfc8d5ba69?s=128&d=identicon&r=PG&f=1", "display_name": "Hayanno", "link": "https://stackoverflow.com/users/3410991/hayanno"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 28, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1458153325, "creation_date": 1458152139, "last_edit_date": 1458153325, "question_id": 36043811, "link": "https://stackoverflow.com/questions/36043811/how-to-get-pointer-on-a-struct-member-inside-a-struct", "title": "How to get pointer on a struct member inside a struct", "body": "<p>My struct are like this :</p>\n\n<pre><code>typedef struct Bounds Bounds;\nstruct Bounds\n{\n    int type;\n    double lb;\n    double ub;\n};\n\ntypedef struct HelperGlpk HelperGlpk;\nstruct HelperGlpk\n{\n    double *matrix_coefs;\n    double *obj_coefs;\n    Bounds *row_bounds;\n    Bounds *col_bounds;\n    int *column_of_coef;\n    int *row_of_coef;\n    int cpt_coef;\n    int cpt_contrainte;\n};\n</code></pre>\n\n<p>I initiliaze them that way (on my main) :</p>\n\n<pre><code>HelperGlpk helper_glpk;\n\n    helper_glpk.matrix_coefs = malloc((nbr_coefs + 1) * sizeof(double));\n    helper_glpk.matrix_coefs[0] = 0;\n\n    helper_glpk.obj_coefs = malloc((nbr_colums + 1) * sizeof(double));\n    helper_glpk.obj_coefs[0] = 0;\n\n    helper_glpk.column_of_coef = malloc((nbr_colums + 1) * sizeof(int));\n    helper_glpk.column_of_coef[0] = 0;\n\n    helper_glpk.row_of_coef = malloc((nbr_rows + 1) * sizeof(int)); \n    helper_glpk.row_of_coef[0] = 0;\n\n    helper_glpk.col_bounds = malloc((nbr_colums + 1) * sizeof(Bounds));\n    helper_glpk.row_bounds = malloc((nbr_rows + 1) * sizeof(Bounds));\n\n    helper_glpk.cpt_coef = 1;\n    helper_glpk.cpt_contrainte = 1;\n</code></pre>\n\n<p>Then, inside the function genere_contrainte_1() that I call this way : <code>genere_contrainte_1(i, j, &amp;helper_glpk, baie);</code></p>\n\n<p>I want to access to the pointer <code>helper_glpk-&gt;col_bounds[helper_glpk-&gt;cpt_coef]-&gt;type</code> but I got this error :</p>\n\n<pre><code>error: invalid type argument of \u2018-&gt;\u2019 (have \u2018Bounds {aka struct Bounds}\u2019)\n  helper_glpk-&gt;col_bounds[helper_glpk-&gt;cpt_coef]-&gt;type = GLP_DB;\n</code></pre>\n\n<p>Could you tell me what am I doing wrong ?</p>\n\n<p>Edit : I DO want to access the pointer to ->type, because .type doesn't \"save\" the value for use outside the function genere_contrainte_1()</p>\n"}, {"tags": ["c", "assembly", "x86"], "comments": [{"owner": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 2, "creation_date": 1458151637, "post_id": 36043531, "comment_id": 59735990, "body": "There is none. You will have to do bit shitfing and masking, as you would in C too. <code>x &gt;&gt; 4</code> and <code>x &amp; 0x0f</code> to get the two halves."}, {"owner": {"reputation": 1769, "user_id": 2471571, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/81ce9873b7035afc2ed8cab83da89d0e?s=128&d=identicon&r=PG", "display_name": "Peter3", "link": "https://stackoverflow.com/users/2471571/peter3"}, "reply_to_user": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 0, "creation_date": 1458151729, "post_id": 36043531, "comment_id": 59736049, "body": "Can you shift and mask in assembly?  I have only seen basic math used with commands like addl instead of a + sign"}, {"owner": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 1, "creation_date": 1458151862, "post_id": 36043531, "comment_id": 59736123, "body": "You shift and mask using the appropriate instructions :) I left that as an exercise to you. You can also shift and mask constants with the operators of your assembler, but that&#39;s not applicable here."}, {"owner": {"reputation": 22422, "user_id": 634919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f4a87fe094961af20263d8e7ff445b2?s=128&d=identicon&r=PG", "display_name": "Nate Eldredge", "link": "https://stackoverflow.com/users/634919/nate-eldredge"}, "edited": false, "score": 0, "creation_date": 1458152676, "post_id": 36043531, "comment_id": 59736631, "body": "Terminology note: they&#39;re <i>instructions</i>, not &quot;commands&quot;.  Shifts: look at the <code>shl</code> and <code>shr</code> instructions.  Masks: you have <code>and</code>, <code>or</code>, <code>xor</code>, <code>not</code>."}, {"owner": {"reputation": 1769, "user_id": 2471571, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/81ce9873b7035afc2ed8cab83da89d0e?s=128&d=identicon&r=PG", "display_name": "Peter3", "link": "https://stackoverflow.com/users/2471571/peter3"}, "edited": false, "score": 0, "creation_date": 1458153058, "post_id": 36043531, "comment_id": 59736868, "body": "Thanks for the last two comments. I will try and see what I can accomplish from here.  I should be able to mask and shift the bits to separate them. I will work on converting that one number into the binary string."}, {"owner": {"reputation": 1769, "user_id": 2471571, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/81ce9873b7035afc2ed8cab83da89d0e?s=128&d=identicon&r=PG", "display_name": "Peter3", "link": "https://stackoverflow.com/users/2471571/peter3"}, "edited": false, "score": 0, "creation_date": 1458155069, "post_id": 36043531, "comment_id": 59738036, "body": "I am supposed to return a string that would like something like 1011 1011 Ideally the function donibble would be called twice once to do the first 4 bits and write out to a string somehow a 0 or 1 to represent the hex digit in binary.  then printbin would add a space to the string and call donibble again.  I believe I have to figure out how to use the .data section to handle the string."}], "answers": [{"tags": [], "owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "is_accepted": false, "score": 1, "last_activity_date": 1458154869, "creation_date": 1458154869, "answer_id": 36044721, "question_id": 36043531, "link": "https://stackoverflow.com/questions/36043531/gas-assembly-x86-converting-char-to-binary-string/36044721#36044721", "title": "Gas Assembly x86. converting char to binary string", "body": "<p>That's a weird prototype for the function.  Are you supposed to return a pointer to a static buffer?  A more typical design would be for the caller to pass a pointer to a buffer where the function could store the string.  </p>\n\n<hr>\n\n<p>The usual way to do this is to take advantage of the fact that the shift instructions set <code>CF</code> to the last bit shifted out.  You can then use <code>setc</code> to get a zero or one, and convert that to an ascii <code>'0'</code> or <code>'1'</code>.  Another trick is <code>adc $0</code>, or <code>adc $'0'</code> to read the carry flag.</p>\n\n<p>copying a register and using <code>and</code> to get just the low bit is also viable, though.</p>\n\n<p>If you're stuck, use the search.  There have been previous SO questions about this.  Try searching within the <a href=\"/questions/tagged/x86\" class=\"post-tag\" title=\"show questions tagged &#39;x86&#39;\" rel=\"tag\">x86</a> and/or <a href=\"/questions/tagged/assembly\" class=\"post-tag\" title=\"show questions tagged &#39;assembly&#39;\" rel=\"tag\">assembly</a> tags.  Have a look at the x86 tag wiki for many good links to beginner stuff and reference material.</p>\n"}, {"comments": [{"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1458892911, "post_id": 36205880, "comment_id": 60064482, "body": "Glad you were able to get your code sorted out.  <code>returnString</code> could be in the <code>.bss</code> instead of the <code>.data</code> section, since the initial value doesn&#39;t matter (you always fully overwrite it).  Also, your <code>je zero3</code> / <code>jne one3</code> pairs are silly: just use a single branch that falls through or not.  Note that the jump target of the 2nd branch is the insn following it, so it goes to the same place whether it&#39;s taken or not.  Also note that after isolating the bit you want in <code>%dl</code> with <code>and</code>, you can <code>shr $1, %dl</code> / <code>add $0x30, %dl</code>, and then you don&#39;t need a branch."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1458893053, "post_id": 36205880, "comment_id": 60064542, "body": "<code>incl %ecx</code> is present in both sides of your branches, so you should pull it out and put it where the branches rejoin.  And again, remove the <code>jmp L4</code> that comes right before <code>L4</code>.  You don&#39;t need to jump over white-space."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1458893250, "post_id": 36205880, "comment_id": 60064605, "body": "You can also loop over the bits in a nibble using a shift, so the bit you&#39;re interested in is always in the low bit (or high bit for <code>shl</code>) of the register you&#39;re shifting.  To do even better than that, take advantage of the fact that shift instructions set the carry flag to the bit just shifted out.  So you can use <code>shl $1, %al</code> / <code>adc $0x30, %a_zeroed_reg</code> or something."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1458893410, "post_id": 36205880, "comment_id": 60064653, "body": "It&#39;s normal for beginners to write giant inefficient asm code.  As long as you understand why it works, you&#39;re learning, and will pick up tricks for writing more efficient code as you learn more."}], "tags": [], "owner": {"reputation": 1769, "user_id": 2471571, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/81ce9873b7035afc2ed8cab83da89d0e?s=128&d=identicon&r=PG", "display_name": "Peter3", "link": "https://stackoverflow.com/users/2471571/peter3"}, "is_accepted": true, "score": 0, "last_activity_date": 1458838777, "creation_date": 1458838777, "answer_id": 36205880, "question_id": 36043531, "link": "https://stackoverflow.com/questions/36043531/gas-assembly-x86-converting-char-to-binary-string/36205880#36205880", "title": "Gas Assembly x86. converting char to binary string", "body": "<p>For the record to close this out.  This was the code I ended with.  I appreciate the help from everyone.  </p>\n\n<pre><code>.text\n.globl _printbin\n\n_printbin:\n\n    pushl %ebp\n    movl %esp, %ebp\n\n    movb 8(%ebp), %dl #grabs the hex byte\n    movl $0, %eax   #sets $eax to 0\n\n    shrb $4, %dl\n    movl $returnString, %ecx\n    pushl %ebx #free up ebx\n    jmp donibble\n\nreturnFromDonibble:\n    incl %ecx\n    movb 8(%ebp), %dl\n    movb $0x0f, %al\n    andb $15, %dl\n    movb $0x39, %al\n    cmpb (%ecx), %al\n    je donibble\n    jne end\n\n\n\n\ndonibble:\n#Takes %dl and gets string and adds string to return String\n    movb %dl, %bl\n    movb $0x08, %al\n    andb $8,%dl\n    je zero\n    jne one\n\n    one:\n        movb $0x31, (%ecx)\n        incl %ecx\n        jmp L2\n    zero:\n        movb $0x30, (%ecx)\n        incl %ecx\n        jmp L2\nL2:\n    movb %bl, %dl\n    movb $0x04, %al \n    andb $4, %dl\n    je zero2\n    jne one2\n\n    one2:\n        movb $0x31, (%ecx)\n        incl %ecx\n        jmp L3\n    zero2:\n        movb $0x30, (%ecx)\n        incl %ecx\n        jmp L3\n\nL3:\n    movb %bl, %dl\n    movb $0x02, %al\n    andb $2, %dl\n    je zero3\n    jne one3\n\n    one3:\n        movb $0x31, (%ecx)\n        incl %ecx\n        jmp L4\n    zero3:\n        movb $0x30, (%ecx)\n        incl %ecx\n        jmp L4\n\nL4:\n    movb %bl, %dl\n    movb $0x01, %al\n    andb $1, %dl\n    je zero4\n    jne one4\n\n    one4:\n        movb $0x31, (%ecx)\n        incl %ecx\n        jmp returnFromDonibble\n    zero4:\n        movb $0x30, (%ecx)\n        inc %ecx\n        jmp returnFromDonibble\n\nend:\n    popl %ebx\n    movl $returnString, %eax\n    movl %ebp, %esp\n    popl %ebp\n    ret\n\n\n\n\n.data\n\nreturnString:   .asciz \"9999 9999\"\n\n.end\n</code></pre>\n"}], "owner": {"reputation": 1769, "user_id": 2471571, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/81ce9873b7035afc2ed8cab83da89d0e?s=128&d=identicon&r=PG", "display_name": "Peter3", "link": "https://stackoverflow.com/users/2471571/peter3"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1096, "favorite_count": 0, "accepted_answer_id": 36205880, "answer_count": 2, "score": 1, "last_activity_date": 1458838777, "creation_date": 1458151406, "last_edit_date": 1458158649, "question_id": 36043531, "link": "https://stackoverflow.com/questions/36043531/gas-assembly-x86-converting-char-to-binary-string", "title": "Gas Assembly x86. converting char to binary string", "body": "<p>I am new to assembly and I am trying to understand the tools at my disposal as well.  I have to create a callable assembly function for a tiny C program. The goal is for the user to type in the letter by hex value -so 41 for A.  Then the C passes this hex value as an unsigned char to the assembly function. Below is the C code </p>\n\n<pre><code>extern char *printbin(unsigned char);\n\nint main(void)\n{\n  unsigned int x;\n\n  printf(\"enter the character's ascii value in hex: \\n\");\n  scanf(\"%x\",&amp;x);\n  printf(\"The binary format for character %c is %s\\n\", \n                                 x,   printbin((unsigned char)x));\n  return 0;\n}\n</code></pre>\n\n<p>My understanding that on the stack there should be a value of 41 stored in one byte as in C chars are really just numbers as well. Is that assumption correct.  The task is to covert the input into an ouput string of two 4 digit binary numbers for each digit separated by a space so 0100 0001  My first question is how can I split up the byte in a register to just 4 bits or just the 1 or the 4? I set up a skeleton for the assembly file</p>\n\n<pre><code>.text\n.globl _printbin\n\n_printbin:\n\n        pushl %ebp\n        movl %esp, %ebp\n\n        movl 4(%ebp), %ecx  #store the char in ecx register\n        jmp end\n\ndonibble: #function to convert digit to binary\n\nend:\n        movl %ebp, %esp\n        popl %ebp\n        ret\n</code></pre>\n\n<p>However I am lost on how to proceed with grabbing just half of the byte.  I could grab just the one byte with %el to make it just 8 bits instead of the %ecx when I do \"work\" on it but I am unaware of any kind of register to grab anything fewer then just 1 byte. Any help or ideas would be greatly appreciated. </p>\n\n<p>Updated assembly code</p>\n\n<pre><code>.text\n.globl _printbin\n\n_printbin:\n\n        pushl %ebp\n        movl %esp, %ebp\n\n        movl 4(%ebp), %edx #grabs the hex byte\n        movl $0, %eax   #sets $eax to 0\n\n        shrb $4,%dl\n        jmp donibble\n        L2:\n                incl %eax\n        #       addl 0x20, %return string #add the space.\n                movl 4(%ebp), %edx\n                AND %dl, 0x0f \n                jmp donibble    \n        L3:\n                jmp end\n\ndonibble:\n#Takes %dl and gets string and adds string to return String\n        cmpb %dl, 0x0\n        je Zero\n        cmpb %dl, 0x1\n        je One\n\nZero:\n         #add 0000 to string\n jmp donibbleEnd\nOne: \n        #add 0001 to string\n\n        donibbleEnd:\n        #to send back to printbin\n                cmpb $0, %eax\n                je L2\n                jmp L3\n\n\nend:\n        movl $returnString, %eax\n        movl %ebp, %esp\n        popl %ebp\n        ret\n\n.data\n\nreturnString:\n        .asciz \"1001 1100\\n\"\n\n.end\n</code></pre>\n\n<p>Is there a way to add to my $returnString following this updated structure above? apparently addl \"0000\", $returnString doesn't work at all :)</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1458151385, "post_id": 36043482, "comment_id": 59735842, "body": "This is a feature called <i>type casting</i>."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user5585984"}, "is_accepted": false, "score": 1, "last_activity_date": 1458151520, "last_edit_date": 1458151520, "creation_date": 1458151439, "answer_id": 36043545, "question_id": 36043482, "link": "https://stackoverflow.com/questions/36043482/what-the-float-in-a-printfs-expression-means/36043545#36043545", "title": "what the float in a printf&#39;s expression means", "body": "<p>You cast integer to float with <code>(float) cold_days</code>.</p>\n\n<p>Read more about casting at <a href=\"http://www.tutorialspoint.com/cprogramming/c_type_casting.htm\" rel=\"nofollow\">this link</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 55, "user_id": 5990539, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/chpKo.jpg?s=128&g=1", "display_name": "Tomorrow&#39;s Explorer", "link": "https://stackoverflow.com/users/5990539/tomorrows-explorer"}, "is_accepted": false, "score": 1, "last_activity_date": 1458151472, "creation_date": 1458151472, "answer_id": 36043565, "question_id": 36043482, "link": "https://stackoverflow.com/questions/36043482/what-the-float-in-a-printfs-expression-means/36043565#36043565", "title": "what the float in a printf&#39;s expression means", "body": "<p>This is explicit conversion to float. See this <a href=\"http://www.tutorialspoint.com/cprogramming/c_type_casting.htm\" rel=\"nofollow\">http://www.tutorialspoint.com/cprogramming/c_type_casting.htm</a></p>\n"}, {"tags": [], "owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "is_accepted": true, "score": 1, "last_activity_date": 1458151919, "creation_date": 1458151919, "answer_id": 36043727, "question_id": 36043482, "link": "https://stackoverflow.com/questions/36043482/what-the-float-in-a-printfs-expression-means/36043727#36043727", "title": "what the float in a printf&#39;s expression means", "body": "<p>It is also worth noting that this cast is likely <strong>unneccesary</strong>. <code>100.0 * (float) cold_days / all_days</code> will be executed left to right, and since <code>100.0</code> is already floating-point number (<code>double</code>), result of <code>100.0 * cold_days</code> will also be <code>double</code>.</p>\n\n<p>And since <code>float</code> is upgraded to <code>double</code> for printf (as well as any other variadic argument function), the cast is redundant.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5767271"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 36043727, "answer_count": 3, "score": -1, "last_activity_date": 1458151919, "creation_date": 1458151263, "question_id": 36043482, "link": "https://stackoverflow.com/questions/36043482/what-the-float-in-a-printfs-expression-means", "title": "what the float in a printf&#39;s expression means", "body": "<p>I just came through the following statement:</p>\n\n<pre><code>printf(\"%d days total: %.1f%% were below freezing.\\n\",all_days, 100.0 * (float) cold_days / all_days);\n</code></pre>\n\n<p>I need an explanation over using <code>(float)</code> inside <code>printf</code> expression in the above statement. If you have any reference please link it.</p>\n"}, {"tags": ["c", "memory-management", "malloc", "free", "cpu-architecture"], "comments": [{"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1458152730, "post_id": 36043475, "comment_id": 59736666, "body": "short answer - No. You just got lucky"}], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 4195013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd0f946278fbc8999bde2ab33cb4819a?s=128&d=identicon&r=PG&f=1", "display_name": "Mohammad Mosiur", "link": "https://stackoverflow.com/users/4195013/mohammad-mosiur"}, "edited": false, "score": 0, "creation_date": 1458161794, "post_id": 36043559, "comment_id": 59742088, "body": "Thank you very much. This makes sense."}], "tags": [], "owner": {"reputation": 557, "user_id": 1364315, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c2a94bd8b815d9f30fc293b5f8cbf256?s=128&d=identicon&r=PG", "display_name": "DaKnOb", "link": "https://stackoverflow.com/users/1364315/daknob"}, "is_accepted": false, "score": 4, "last_activity_date": 1458151464, "creation_date": 1458151464, "answer_id": 36043559, "question_id": 36043475, "link": "https://stackoverflow.com/questions/36043475/c-malloc-free-and-then-again-malloc-does-work-same-always/36043559#36043559", "title": "C: malloc(), free() and then again malloc() does work same always?", "body": "<p>Modern memory allocators have several performance optimizations. They have several buckets of available memory and each time you request an amount of bytes they look and determine the best memory region available. Some memory allocators keep a pointer to the last allocation you made so if you need another piece of the same size (something that happens often), they give you the same piece back so they don't have to look for a new one, which takes time.</p>\n\n<p>You can try two calls to <code>malloc()</code> and then to <code>free()</code> and then to <code>malloc()</code> again to see what happens.</p>\n"}, {"comments": [{"owner": {"reputation": 57, "user_id": 4195013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd0f946278fbc8999bde2ab33cb4819a?s=128&d=identicon&r=PG&f=1", "display_name": "Mohammad Mosiur", "link": "https://stackoverflow.com/users/4195013/mohammad-mosiur"}, "edited": false, "score": 0, "creation_date": 1458161861, "post_id": 36043935, "comment_id": 59742135, "body": "Thanks for mentioning the Visual C case. I just tested it for gcc compiler."}], "tags": [], "owner": {"reputation": 40893, "user_id": 1386054, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/424ZW.jpg?s=128&g=1", "display_name": "Adrian McCarthy", "link": "https://stackoverflow.com/users/1386054/adrian-mccarthy"}, "is_accepted": false, "score": 3, "last_activity_date": 1458152483, "creation_date": 1458152483, "answer_id": 36043935, "question_id": 36043475, "link": "https://stackoverflow.com/questions/36043475/c-malloc-free-and-then-again-malloc-does-work-same-always/36043935#36043935", "title": "C: malloc(), free() and then again malloc() does work same always?", "body": "<p>There are no guarantees this will work.  (And, in fact, it doesn't work with a debug build in Visual Studio because the debug memory allocator will clobber the data when you free it in order to detect bugs like this.)</p>\n\n<p>You should never depend on this behavior.</p>\n\n<p>Some memory managers use LIFO (last-in, first-out) lists of freed blocks of memory. This means that the next allocation of the same size is likely to get the same block back.  Other memory managers explicitly don't use LIFO free-lists to make it harder for malware to exploit a heap management bug.</p>\n"}, {"tags": [], "owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "is_accepted": true, "score": 3, "last_activity_date": 1458153948, "creation_date": 1458153948, "answer_id": 36044407, "question_id": 36043475, "link": "https://stackoverflow.com/questions/36043475/c-malloc-free-and-then-again-malloc-does-work-same-always/36044407#36044407", "title": "C: malloc(), free() and then again malloc() does work same always?", "body": "<p>It happens in practice because re-using a just-freed chunk of memory is usually the best choice.  It's probably still hot in cache, and it means malloc's free-list can be shortened (instead of leaving that block on the free list and getting a new block from the OS).</p>\n\n<p>It also means <code>malloc</code> probably doesn't need any system calls to satisfy this request.  Small <code>free()</code> calls are typically not returned to the OS right away (because usually they can't be, because they're just part of a page).  So typical malloc implementations put them on a free-list.</p>\n\n<p>So this little experiment has told you something about the internal implementation of malloc on the particular C implementation you tried it on.  As I think you realize from the question phrasing, <strong>this is undefined behaviour and should never be relied upon</strong>.</p>\n\n<p>It's not really specific to CPU architecture.  AFAIK, GNU libc's <code>malloc</code> uses the same algorithms on every architecture.</p>\n\n<hr>\n\n<p>Even on a C implementation that does work this way, there are many ways for this to break: a signal handler could run between the free and the second malloc, and take the block.  In multithreaded code, another thread could take that block between the free and the malloc.  (Although this is less likely: each thread would usually use its own small pool).</p>\n\n<hr>\n\n<p>A large buffer usually <em>would</em> be handed back to the OS inside the <code>free()</code> call, so the next <code>malloc()</code> would have to get fresh memory from the OS again.  See <code>M_MMAP_THRESHOLD</code> in <a href=\"http://man7.org/linux/man-pages/man3/mallopt.3.html\" rel=\"nofollow\"><code>mallopt(3)</code></a> for an explanation of that tunable parameter in glibc's malloc.  <code>M_PERTURB</code> provides similar functionality to what Adrian describes for MSVC++ debug builds: breaking code that has use-after-free bugs, and breaking code that depends on <code>malloc</code>ed memory being zeroed or something  (use <code>calloc</code> to efficiently get zeroed memory).</p>\n"}], "owner": {"reputation": 57, "user_id": 4195013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd0f946278fbc8999bde2ab33cb4819a?s=128&d=identicon&r=PG&f=1", "display_name": "Mohammad Mosiur", "link": "https://stackoverflow.com/users/4195013/mohammad-mosiur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2369, "favorite_count": 0, "accepted_answer_id": 36044407, "answer_count": 3, "score": 1, "last_activity_date": 1458153948, "creation_date": 1458151240, "question_id": 36043475, "link": "https://stackoverflow.com/questions/36043475/c-malloc-free-and-then-again-malloc-does-work-same-always", "title": "C: malloc(), free() and then again malloc() does work same always?", "body": "<p>I have tried to run this code in some different machines with different processor and main memory size. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main(void)\n{\n    // your code goes here\n\n    int *a, i;\n\n    a = (int *)malloc(10*(sizeof(int)));\n\n    for(i = 0; i &lt; 10; i++)\n    {\n        a[i] = i*i;\n    }\n\n    free(a); \n\n    a = (int *)malloc(10*(sizeof(int)));\n\n    for(i = 0; i &lt; 10; i++)\n    {\n        printf(\"%d\\n\",a[i]);\n    }\n\n    free(a);\n\n    return 0;\n}\n</code></pre>\n\n<p>However, in all machines it generates the same output: </p>\n\n<pre><code>0\n1\n4\n9\n16\n25\n36\n49\n64\n81\n</code></pre>\n\n<p>My question is: should the variable 'a' always allocate use the same memory location for the execution? </p>\n\n<p>In theory, probably it is not mandatory. If my understanding is right: every malloc of 'a' can allocate a different base address. </p>\n\n<p>However, what does actually happen in practice by modern computing machines? </p>\n"}, {"tags": ["c", "missing-data"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 5767659, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/40090ee51647de0dc22227f34f04e46d?s=128&d=identicon&r=PG&f=1", "display_name": "The baron", "link": "https://stackoverflow.com/users/5767659/the-baron"}, "edited": false, "score": 0, "creation_date": 1458154337, "post_id": 36044454, "comment_id": 59737618, "body": "from some reason the buffer get wierd chars... if i make a compare it allwase return false even if its true..."}, {"owner": {"reputation": 159, "user_id": 6067873, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-hotJlb1OSZg/AAAAAAAAAAI/AAAAAAAAACw/nAOzYxfNMKc/photo.jpg?sz=128", "display_name": "Alan Ortega", "link": "https://stackoverflow.com/users/6067873/alan-ortega"}, "reply_to_user": {"reputation": 23, "user_id": 5767659, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/40090ee51647de0dc22227f34f04e46d?s=128&d=identicon&r=PG&f=1", "display_name": "The baron", "link": "https://stackoverflow.com/users/5767659/the-baron"}, "edited": false, "score": 0, "creation_date": 1458161532, "post_id": 36044454, "comment_id": 59741943, "body": "when using fgets sometimes the buffer for stdin (the keyboard in this case) keeps trash data and next time it gets called it will read the trash that is why it doesnt wait for a new entry and just reads the trash with the fflush(stdin) you are clearing all the buffer for stdin"}], "tags": [], "owner": {"reputation": 159, "user_id": 6067873, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-hotJlb1OSZg/AAAAAAAAAAI/AAAAAAAAACw/nAOzYxfNMKc/photo.jpg?sz=128", "display_name": "Alan Ortega", "link": "https://stackoverflow.com/users/6067873/alan-ortega"}, "is_accepted": false, "score": 0, "last_activity_date": 1458154331, "last_edit_date": 1458154331, "creation_date": 1458154066, "answer_id": 36044454, "question_id": 36043410, "link": "https://stackoverflow.com/questions/36043410/the-function-is-running-wrong-on-a-second-time-even-when-its-not-static/36044454#36044454", "title": "The function is running wrong on a second time even when its not static", "body": "<p>Add <code>fflush(stdin);</code> at the beginning of shapeMaker and after fgets</p>\n"}], "owner": {"reputation": 23, "user_id": 5767659, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/40090ee51647de0dc22227f34f04e46d?s=128&d=identicon&r=PG&f=1", "display_name": "The baron", "link": "https://stackoverflow.com/users/5767659/the-baron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1458154331, "creation_date": 1458151072, "last_edit_date": 1458154294, "question_id": 36043410, "link": "https://stackoverflow.com/questions/36043410/the-function-is-running-wrong-on-a-second-time-even-when-its-not-static", "title": "The function is running wrong on a second time even when its not static", "body": "<p>i have made a function of a building that create two buildings now on the second building it hops over some parameters from some reason... why?\nnow i checked the code a few times and im not using any static varbs so it should not do it... than why it remembers when there is a second run?</p>\n\n<p><strong>UPDATE</strong> i did that as said but now its only return false... any help will help</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n//defines\n#define SIZE 30\n#define Q_SIZE 4\n#define TRUE 1\n#define FALSE 0\nstruct shape\n    {\n    char name[SIZE];   /* name of the shape */\n    int edgeNum;       /* number of edges */\n    char sPol[Q_SIZE]; /* if the shape is a regular polygrom */\n    };\nint shapeMaker();\nint main(void)\n{\n    int check;\n    check = shapeMaker();\n    if (check == TRUE)\n{\n    printf(\"the two shapes are equals!\\n\");\n}\n    else if (check == FALSE)\n{\n    printf(\"the two shapes are not equals!\\n\");\n}\nsystem(\"PAUSE\");\nreturn 0;\n}\n\nint shapeMaker()\n{\nstruct shape firstShape;    \nstruct shape secondShape;\n\nprintf(\"please enter the first shape name: \");\nfgets(secondShape.name, SIZE, stdin);\nsecondShape.name[strcspn(secondShape.name, \"\\n\")] = 0;\nprintf(\"\\nnow please enter the number of Edges: \");\nscanf(\"%d\", &amp;secondShape.edgeNum);\nprintf(\"\\nis the shape is regular polygom (yes/no)? \");\nscanf(\"%s\", secondShape.sPol);\ngetchar();\nprintf(\"\\nplease enter the second  shape name: \");\nfgets(secondShape.name, SIZE, stdin);\nsecondShape.name[strcspn(secondShape.name, \"\\n\")] = 0;\nprintf(\"\\nnow please enter the number of Edges: \");\nscanf(\"%d\", &amp;secondShape.edgeNum);\nprintf(\"\\nis the shape is regular polygom (yes/no)? \");\nscanf(\"%s\", secondShape.sPol);\nif (firstShape.name == secondShape.name &amp;&amp; firstShape.edgeNum ==      secondShape.edgeNum &amp;&amp; firstShape.sPol == secondShape.sPol)\n{\n    return TRUE;\n}\nelse\n{\n    return FALSE;\n}\n} \n</code></pre>\n"}, {"tags": ["c", "arrays"], "answers": [{"tags": [], "owner": {"reputation": 137011, "user_id": 567292, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/b55da07dea89fa675c7e2894c77f8024?s=128&d=identicon&r=PG", "display_name": "ecatmur", "link": "https://stackoverflow.com/users/567292/ecatmur"}, "is_accepted": true, "score": 7, "last_activity_date": 1458150445, "creation_date": 1458150445, "answer_id": 36043191, "question_id": 36043094, "link": "https://stackoverflow.com/questions/36043094/how-to-determine-if-2-elements-are-adjacent-in-a-2d-array/36043191#36043191", "title": "How to determine if 2 elements are adjacent in a 2D array?", "body": "<p>It's less code to compute the distance under the <a href=\"https://en.wikipedia.org/wiki/Taxicab_geometry\" rel=\"noreferrer\">Manhattan metric</a>, and check whether that is equal to 1:</p>\n\n<pre><code>return (abs(x1 - x2) + abs(y1 - y2)) == 1;\n</code></pre>\n"}], "owner": {"reputation": 329, "user_id": 5670520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad27f6c9f2d78025494899d44e08a7cc?s=128&d=identicon&r=PG&f=1", "display_name": "Garrett Sitter", "link": "https://stackoverflow.com/users/5670520/garrett-sitter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1329, "favorite_count": 0, "accepted_answer_id": 36043191, "answer_count": 1, "score": 1, "last_activity_date": 1458150445, "creation_date": 1458150159, "question_id": 36043094, "link": "https://stackoverflow.com/questions/36043094/how-to-determine-if-2-elements-are-adjacent-in-a-2d-array", "title": "How to determine if 2 elements are adjacent in a 2D array?", "body": "<p>I\u2019m trying to find the best way to determine if an element is adjacent to another element in an unsorted two-dimensional array.  For example, if myArray[2,2] is passed to my comparison function, I want input equal to the elements at positions [1,2], [3,2], [2, 1], and [2,3] to return true, and any other input to return false.  This is based on user input.  </p>\n\n<p><img src=\"https://i.imgur.com/U83FdPb.png\" alt=\"array example\"></p>\n\n<p>For example, assume the target value \"13\" is stored at [2,2].  If the user inputs \"8\", the array is searched for the value \"8\", which is found at position [1, 2].  Since this is adjacent to the target value of [2,2], a true value is returned.</p>\n\n<p>I\u2019ve come up with a function to do this, but I can\u2019t help but feel that I'm overlooking a more efficient/elegant way than the conditionals I\u2019m currently using.  I\u2019m a novice with C so please excuse any mistakes.</p>\n\n<p>Currently, I\u2019m using the following function:</p>\n\n<pre><code>_Bool withinOneOf(int x1, int y1,  int x2, int y2)  //compare x,y of first array element to x,y of second array element\n{   \n    _Bool xtrue = 0, ytrue = 0;\n\n    if(x1 == x2+1 || x1 == x2-1)\n    {\n        xtrue = 1;\n    }\n\n    if(y1 == y2+1 || y1 == y2-1)\n    {\n        ytrue = 1;\n    }\n\n    if(((x1==x2) &amp;&amp; ytrue) || ((y1==y2) &amp;&amp; xtrue))  //only want tiles that are adjacent vertically and horizontally, \n    {                                               //not diagonally.\n        return 1;                        \n    } \n    else \n    {                        \n        return 0;                   \n    }\n}\n</code></pre>\n"}, {"tags": ["c", "floating-point"], "comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 6, "creation_date": 1458147745, "post_id": 36042198, "comment_id": 59733409, "body": "Why do you think you are allowed to modify <code>FLT_EVAL_METHOD</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1458228911, "post_id": 36043097, "comment_id": 59776678, "body": "Note: Some compiler settings will affect <code>FLT_EVAL_METHOD</code> - obviously compiler dependent."}], "tags": [], "owner": {"reputation": 97003, "user_id": 142434, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YGcat.jpg?s=128&g=1", "display_name": "Stephen Canon", "link": "https://stackoverflow.com/users/142434/stephen-canon"}, "is_accepted": true, "score": 7, "last_activity_date": 1458150170, "creation_date": 1458150170, "answer_id": 36043097, "question_id": 36042198, "link": "https://stackoverflow.com/questions/36042198/setting-flt-eval-method-not-working/36043097#36043097", "title": "Setting FLT_EVAL_METHOD not working", "body": "<p><code>FLT_EVAL_METHOD</code> is not a switch that the programmer uses to control the compiler.  It's a means for the compiler/platform to report to the programmer how floating-point expressions will be evaluated.  You're not supposed to change its value, and doing so is not supposed to have any effect on anything.</p>\n"}], "owner": {"reputation": 11698, "user_id": 5399734, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2162d669508364bb0c03aba1a2473aa8?s=128&d=identicon&r=PG&f=1", "display_name": "nalzok", "link": "https://stackoverflow.com/users/5399734/nalzok"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 508, "favorite_count": 0, "accepted_answer_id": 36043097, "answer_count": 1, "score": 4, "last_activity_date": 1458150170, "creation_date": 1458147504, "question_id": 36042198, "link": "https://stackoverflow.com/questions/36042198/setting-flt-eval-method-not-working", "title": "Setting FLT_EVAL_METHOD not working", "body": "<pre><code>#include &lt;stdio.h&gt;\n#include &lt;float.h&gt;\n\n#ifdef FLT_EVAL_METHOD\n    #undef FLT_EVAL_METHOD\n    #define FLT_EVAL_METHOD 1\n#else\n    #define FLT_EVAL_METHOD 1\n#endif\n\nint main(void)\n{\n    printf(\"%f\\n%f\\n\", FLT_MAX, DBL_MAX);\n    float fp = FLT_MAX;\n    printf(\"%f\\n\", fp + 1);\n    printf(\"%f\\n\", FLT_MAX + 1);\n    printf(\"%f\\n\", (float) FLT_MAX + 1);\n}\n</code></pre>\n\n<p>The expected output is:</p>\n\n<pre><code>340282346638528859811704183484516925440.000000\n179769313486231570814527423731704356798070567525844996598917476803157260780028538760589558632766878171540458953514382464234321326889464182768467546703537516986049910576551282076245490090389328944075868508455133942304583236903222948165808559332123348274797826204144723168738177180919299881250404026184124858368.000000\n340282346638528859811704183484516925441.000000\n340282346638528859811704183484516925441.000000\n340282346638528859811704183484516925441.000000\n</code></pre>\n\n<p>But the actual output is:</p>\n\n<pre><code>340282346638528859811704183484516925440.000000\n179769313486231570814527423731704356798070567525844996598917476803157260780028538760589558632766878171540458953514382464234321326889464182768467546703537516986049910576551282076245490090389328944075868508455133942304583236903222948165808559332123348274797826204144723168738177180919299881250404026184124858368.000000\n340282346638528859811704183484516925440.000000\n340282346638528859811704183484516925440.000000\n340282346638528859811704183484516925440.000000\n</code></pre>\n\n<p>Since <code>FLT_EVAL_METHOD</code> is set to 1, shouldn't all <code>float</code> expressions evaluated as <code>double</code>s? What does \"evaluate float and double as double, and long double as long double.\" mean? Are <code>float</code>s treated identical to <code>double</code>s?</p>\n"}, {"tags": ["c", "function"], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 6072872, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f7847d01de64eecbda5830a6d03f476?s=128&d=identicon&r=PG&f=1", "display_name": "timgr17", "link": "https://stackoverflow.com/users/6072872/timgr17"}, "edited": false, "score": 0, "creation_date": 1458149608, "post_id": 36042417, "comment_id": 59734693, "body": "thanks! it worked!! :)))"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4085386"}, "is_accepted": true, "score": 0, "last_activity_date": 1458149376, "last_edit_date": 1458149376, "creation_date": 1458148096, "answer_id": 36042417, "question_id": 36042178, "link": "https://stackoverflow.com/questions/36042178/c-program-function-chart-parameter/36042417#36042417", "title": "c program function chart parameter", "body": "<p>Declare at the beginning as follows:</p>\n\n<pre><code>void temperatures(float n[10][20]);\n</code></pre>\n\n<p>instead of </p>\n\n<pre><code>void temperatures(float);\n</code></pre>\n\n<p>Then call the function <code>void temperature(float n[10][20])</code> as</p>\n\n<pre><code>temperatures(array);\n</code></pre>\n\n<p>instead of </p>\n\n<pre><code>temperatures(array[10][20]);\n</code></pre>\n\n<p>Also, you have not declared variables <code>i</code> and <code>j</code> in <code>int main()</code> as</p>\n\n<pre><code>int i, j;\n</code></pre>\n\n<p>before using it.</p>\n"}], "owner": {"reputation": 5, "user_id": 6072872, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f7847d01de64eecbda5830a6d03f476?s=128&d=identicon&r=PG&f=1", "display_name": "timgr17", "link": "https://stackoverflow.com/users/6072872/timgr17"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "closed_date": 1458171966, "accepted_answer_id": 36042417, "answer_count": 1, "score": -3, "last_activity_date": 1458149376, "creation_date": 1458147445, "last_edit_date": 1458147997, "question_id": 36042178, "link": "https://stackoverflow.com/questions/36042178/c-program-function-chart-parameter", "closed_reason": "Not suitable for this site", "title": "c program function chart parameter", "body": "<p>I am new in c programming and I have a problem with my c program.\ni want to pass an 10x20 chart as a parameter to a function.\nBut i dont know how to.</p>\n\n<p>It gives me this compilation error:</p>\n\n<pre><code>prog.c:71:6: error: conflicting types for 'thermokrasies'\n void thermokrasies(float n[10][20]){\n      ^\nprog.c:2:6: note: previous declaration of 'thermokrasies' was here\n void thermokrasies(float);\n      ^\n</code></pre>\n\n<p>The code is:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nvoid temperatures(float);\nint main(void) {\n    float array[10][20];\n    array[0][0]=3.00;\n    array[0][19]=-1.50;\n    array[9][0]=3.50;\n    array[9][19]=-1.00;\n    for (i=0; i&lt;1; i++){\n        for (j=1; j&lt;19; j++){\n            array[i][j]=2.00;\n        }\n    }\n    for (i=9; i&lt;10; i++){\n        for (j=1; j&lt;19; j++){\n            array[i][j]=3.00;\n        }\n    }\n    for (j=0; j&lt;1; j++){\n        for (i=1; i&lt;9; i++){\n            array[i][j]=4.00;\n        }\n    }\n    for (j=19; j&lt;20; j++){\n        for (i=1; i&lt;9; i++){\n            array[i][j]=-5.00;\n        }\n    }\n    for (i=1; i&lt;9; i++){\n        for (j=1; j&lt;19; j++){\n            array[i][j]=1.00;\n        }\n    }\n    temperatures(array[10][20]);\n}\n\nvoid temperatures(float n[10][20]){\n    int i,j;\n    float h,k,m,p0,p1,p2,p3,p4,p5,p6,p7,p8,p9,p10;\n    h=n[0][0];\n    k=n[0][0];\n    for (i=0; i&lt;10; i++){\n        for (j=0; j&lt;20; j++){\n            if (n[i][j]&gt;h)\n                h=n[i][j];\n            else if (n[i][j]&lt;k)\n                k=n[i][j];\n            else{\n            }\n        }\n    }\n    printf(\"To megalytero stoixeio einai to %.2f kai to mikrotero to %.2f.\\n\",h,k);\n    m=(h-k)/10;\n    p0=k;\n    p1=m+p0;\n    p2=m+p1;\n    p3=m+p2;\n    p4=m+p3;\n    p5=m+p4;\n    p6=m+p5;\n    p7=m+p6;\n    p8=m+p7;\n    p9=m+p8;\n    p10=m+p9;\n    printf(\"Oi perioxes 8ermokrasiwn einai: \\n %.2f ews %.2f \\n %.2f ews %.2f \\n %.2f ews %.2f \\n %.2f ews %.2f \\n %.2f ews %.2f \\n %.2f ews %.2f \\n %.2f ews %.2f \\n %.2f ews %.2f \\n %.2f ews %.2f \\n %.2f ews %.2f\",p0,p1,p1,p2,p2,p3,p3,p4,p4,p5,p5,p6,p6,p7,p7,p8,p8,p9,p9,p10);\n}\n</code></pre>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "edited": false, "score": 7, "creation_date": 1458147150, "post_id": 36042032, "comment_id": 59732949, "body": "Indexing starts with <code>0</code> in C."}, {"owner": {"reputation": 481, "user_id": 5916150, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c209005186a84dd1820b220d7b78527e?s=128&d=identicon&r=PG&f=1", "display_name": "Arif Burhan", "link": "https://stackoverflow.com/users/5916150/arif-burhan"}, "edited": false, "score": 1, "creation_date": 1458147238, "post_id": 36042032, "comment_id": 59733018, "body": "Also <b>length</b> is not initialized."}, {"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "reply_to_user": {"reputation": 481, "user_id": 5916150, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c209005186a84dd1820b220d7b78527e?s=128&d=identicon&r=PG&f=1", "display_name": "Arif Burhan", "link": "https://stackoverflow.com/users/5916150/arif-burhan"}, "edited": false, "score": 2, "creation_date": 1458147373, "post_id": 36042032, "comment_id": 59733127, "body": "@ArifBurhan: <code>length</code> is obtained from the <code>scanf()</code> call. OP is using VLAs."}, {"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 0, "creation_date": 1458147754, "post_id": 36042032, "comment_id": 59733414, "body": "Both loops must start at <code>0</code>: <code>for (int i = 0; i &lt; length; i++)</code> and <code>for (int j = 0; j &lt; length; j++)</code>"}, {"owner": {"reputation": 31, "user_id": 5542529, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a125e8486a19de6ba9dd03adfd1570ad?s=128&d=identicon&r=PG&f=1", "display_name": "xjimix", "link": "https://stackoverflow.com/users/5542529/xjimix"}, "reply_to_user": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 0, "creation_date": 1458147911, "post_id": 36042032, "comment_id": 59733529, "body": "@pmg That prints out 9 numbers but for some reason needs 10 inputs instead of 9?"}, {"owner": {"reputation": 47447, "user_id": 1172428, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/240fe123035f1c6e184f59da2f1465d9?s=128&d=identicon&r=PG", "display_name": "FatalError", "link": "https://stackoverflow.com/users/1172428/fatalerror"}, "edited": false, "score": 5, "creation_date": 1458147948, "post_id": 36042032, "comment_id": 59733549, "body": "I&#39;m surprised it worked at all, since you didn&#39;t pass <code>&amp;array[i]</code> to <code>scanf()</code>..."}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 5542529, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a125e8486a19de6ba9dd03adfd1570ad?s=128&d=identicon&r=PG&f=1", "display_name": "xjimix", "link": "https://stackoverflow.com/users/5542529/xjimix"}, "edited": false, "score": 0, "creation_date": 1458148896, "post_id": 36042580, "comment_id": 59734207, "body": "Counting from 0 requires 10 inputs in the program instead of 9 then."}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1458148939, "post_id": 36042580, "comment_id": 59734232, "body": "no - update the code with the two fixes and repost it"}, {"owner": {"reputation": 1985, "user_id": 2080712, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/NyaqQ.jpg?s=128&g=1", "display_name": "Bernardo Meurer", "link": "https://stackoverflow.com/users/2080712/bernardo-meurer"}, "edited": false, "score": 1, "creation_date": 1458149008, "post_id": 36042580, "comment_id": 59734280, "body": "Because it will count from 0 to 9, so 0,1,2,3,4,5,6,7,8,9; which is 10 numbers."}], "tags": [], "owner": {"reputation": 1985, "user_id": 2080712, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/NyaqQ.jpg?s=128&g=1", "display_name": "Bernardo Meurer", "link": "https://stackoverflow.com/users/2080712/bernardo-meurer"}, "is_accepted": false, "score": 2, "last_activity_date": 1458149104, "last_edit_date": 1458149104, "creation_date": 1458148613, "answer_id": 36042580, "question_id": 36042032, "link": "https://stackoverflow.com/questions/36042032/saving-number-in-array-in-c/36042580#36042580", "title": "Saving number in array in C", "body": "<ol>\n<li>Arrays count from 0, not from one as we usually do ourselves. Therefore you should start your for loops at 0</li>\n<li>You should be passing <code>&amp;array[i]</code> to scanf in your first for loop.</li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 31, "user_id": 5542529, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a125e8486a19de6ba9dd03adfd1570ad?s=128&d=identicon&r=PG&f=1", "display_name": "xjimix", "link": "https://stackoverflow.com/users/5542529/xjimix"}, "edited": false, "score": 0, "creation_date": 1458150954, "post_id": 36042936, "comment_id": 59735581, "body": "Pasted the corrected code, compiled and ran it, the program still wants 11 numbers (if the length is entered as 10. I seriously don&#39;t know where am I going wrong?"}, {"owner": {"reputation": 58292, "user_id": 34824, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/ri8DI.jpg?s=128&g=1", "display_name": "abelenky", "link": "https://stackoverflow.com/users/34824/abelenky"}, "reply_to_user": {"reputation": 31, "user_id": 5542529, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a125e8486a19de6ba9dd03adfd1570ad?s=128&d=identicon&r=PG&f=1", "display_name": "xjimix", "link": "https://stackoverflow.com/users/5542529/xjimix"}, "edited": false, "score": 0, "creation_date": 1458151043, "post_id": 36042936, "comment_id": 59735628, "body": "You must show, in <b><i>exact detail</i></b> , what input you&#39;re giving your program.  It is not enough to say &quot;the program wants&quot;.  We cannot see your program; we cannot see your input.  You must provide detail."}, {"owner": {"reputation": 31, "user_id": 5542529, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a125e8486a19de6ba9dd03adfd1570ad?s=128&d=identicon&r=PG&f=1", "display_name": "xjimix", "link": "https://stackoverflow.com/users/5542529/xjimix"}, "edited": false, "score": 0, "creation_date": 1458151299, "post_id": 36042936, "comment_id": 59735786, "body": "The input is 10(which is length) then entering 1 2 3 4 5 6 7 8 9 10 11 (if I try running it with 10 numbers nothing happens, just waits until another number is entered)"}, {"owner": {"reputation": 58292, "user_id": 34824, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/ri8DI.jpg?s=128&g=1", "display_name": "abelenky", "link": "https://stackoverflow.com/users/34824/abelenky"}, "reply_to_user": {"reputation": 31, "user_id": 5542529, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a125e8486a19de6ba9dd03adfd1570ad?s=128&d=identicon&r=PG&f=1", "display_name": "xjimix", "link": "https://stackoverflow.com/users/5542529/xjimix"}, "edited": false, "score": 0, "creation_date": 1458153034, "post_id": 36042936, "comment_id": 59736854, "body": "Please edit your question to show your current, correct code.   Repeated tests with my code demonstrate that it seems to be working in all cases."}], "tags": [], "owner": {"reputation": 58292, "user_id": 34824, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/ri8DI.jpg?s=128&g=1", "display_name": "abelenky", "link": "https://stackoverflow.com/users/34824/abelenky"}, "is_accepted": false, "score": 1, "last_activity_date": 1458150079, "last_edit_date": 1458150079, "creation_date": 1458149664, "answer_id": 36042936, "question_id": 36042032, "link": "https://stackoverflow.com/questions/36042032/saving-number-in-array-in-c/36042936#36042936", "title": "Saving number in array in C", "body": "<p>See inline comments.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main()\n{\n   int length;       \n   scanf(\"%d \", &amp;length);       // You used &amp; properly here!\n   int array[length]            // You forgot a semi-colon here!\n\n   for(int i=1; i&lt;length; i++)  // Loop: for(int i=0; i&lt;length; ++i)\n   {\n      scanf(\"%d \", array[i]);   // Why didn't you use &amp; here???\n   }\n\n   for(int j=1; j&lt;length; j++)  // Loop: for(int j=0; j&lt;length; ++j)\n   {\n      printf(\"%d\\n\", array[j]);\n   }\n\n   return 0;\n}\n</code></pre>\n\n<p>Here is an <a href=\"http://ideone.com/YAOlxc\" rel=\"nofollow\"><strong><em>IDEOne link</em></strong></a> to a program, that demonstrates it is working properly with <code>length=10</code> and 10 numbers as input</p>\n\n<p>The fully corrected code is:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main()\n{\n   int length;       \n   scanf(\"%d \", &amp;length);\n   int array[length];        // Added the missing ;\n\n   for(int i=0; i&lt;length; i++) // Loop from 0\n   {\n      scanf(\"%d \", &amp;array[i]); // Used &amp; properly here.\n   }\n\n   for(int j=0; j&lt;length; j++)  // Loop from 0\n   {\n      printf(\"%d\\n\", array[j]);\n   }\n\n   return 0;\n}\n</code></pre>\n\n<p><strong><em>Input</em></strong></p>\n\n<pre><code>10\n1 2 3 4 5 6 7 8 9 10\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1389, "user_id": 4914757, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/xIqlJ.png?s=128&g=1", "display_name": "A.B.", "link": "https://stackoverflow.com/users/4914757/a-b"}, "is_accepted": true, "score": 1, "last_activity_date": 1458153188, "creation_date": 1458153188, "answer_id": 36044162, "question_id": 36042032, "link": "https://stackoverflow.com/questions/36042032/saving-number-in-array-in-c/36044162#36044162", "title": "Saving number in array in C", "body": "<p>C++/C arrays are 0-based index, If you have to access first element of the array you have to use 0 index not 1, consider this array of size 5 (i.e. five elements in it {23} {19} {6} {70} {9} )</p>\n\n<ul>\n<li>[0]->23</li>\n<li>[1]->19</li>\n<li>[2]->6</li>\n<li>[3]->70</li>\n<li>[4]->9</li>\n</ul>\n\n<p>Please be-informed that the 0 position(index) of your array is not initialized. Now bearing this mind here's explanation of your code.</p>\n\n<pre><code>int main()\n{\n    int length = 0;     //Please consider initializing it\n    scanf(\"%d \", &amp;length); //User input '10'\n\n    //Now you have an array of size 10 (10 consecutive memory locations to store int\n    int array[length];    \n\n    //Now consider the memory locations somewhat like this with raw values say 'xx'\n    //0:[xx], 1:[xx], 2:[xx], 3:[xx], 4:[xx], 5:[xx], 6:[xx], 7:[xx], 8:[xx], 9:[xx]\n    for (int i = 1; i &lt; length; i++)\n    {\n        scanf(\"%d \", &amp;array[i]); //Notice the fix here '&amp;array[i] is used.\n    }\n\n    //After providing some data the memory view is somewhat like this, \n    //notice the loop started from position/index 1 in array and went\n    //upto 9th position\n    //0:[xx], 1:[11], 2:[22], 3:[33], 4:[44], 5:[55], 6:[66], 7:[77], 8:[88], 9:[99]\n\n    for (int j = 1; j &lt; length; j++)\n    {\n        printf(\"%d\\n\", array[j]);\n    }\n\n    //The above loop started from position 1 (not 0) and loop through 9 indexes and printed this\n    //11\n    //22\n    //33\n    //44\n    //55\n    //66\n    //77\n    //88\n    //99\n\n    return 0;\n}\n</code></pre>\n\n<p>Here is the fixed code, notice the for loops starting from '0' based index.</p>\n\n<pre><code>int main()\n{\n    int length = 0;\n    scanf(\"%d \", &amp;length);\n    int array[SIZE];\n\n    for (int i = 0; i &lt; length; i++)\n    {\n        scanf(\"%d \", &amp;array[i]); //Notice the fix here '&amp;array[i] is used.\n    }\n\n    for (int j = 0; j &lt; length; j++)\n    {\n        printf(\"%d\\n\", array[j]);\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>Hope it would help you understand how arrays are handled in C++/C</p>\n"}], "owner": {"reputation": 31, "user_id": 5542529, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a125e8486a19de6ba9dd03adfd1570ad?s=128&d=identicon&r=PG&f=1", "display_name": "xjimix", "link": "https://stackoverflow.com/users/5542529/xjimix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 308, "favorite_count": 0, "closed_date": 1458158205, "accepted_answer_id": 36044162, "answer_count": 3, "score": -1, "last_activity_date": 1458153835, "creation_date": 1458147067, "last_edit_date": 1458153835, "question_id": 36042032, "link": "https://stackoverflow.com/questions/36042032/saving-number-in-array-in-c", "closed_reason": "Not suitable for this site", "title": "Saving number in array in C", "body": "<p>I'm trying to save scanned values in array. Sounds easy but here is where I'm having problems:\nHere is the edited code reported as working from other members:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main()\n{\n   int length;       \n   scanf(\"%d \", &amp;length);\n   int array[length];        // Added the missing ;\n\n   for(int i=0; i&lt;length; i++) // Loop from 0\n   {\n      scanf(\"%d \", &amp;array[i]); // Used &amp; properly here.\n   }\n\n   for(int j=0; j&lt;length; j++)  // Loop from 0\n   {\n      printf(\"%d\\n\", array[j]);\n   }\n\n   return 0;\n}\n</code></pre>\n\n<p>What I'm having problems with now is that the program still needs 11 numbers to run. So if I enter</p>\n\n<pre><code>10\n1 2 3 4 5 6 7 8 9 10\n</code></pre>\n\n<p>Nothing happens until I enter another number.</p>\n\n<p>EDIT: Finally figured out why it waits for 11th number: apparently it waits to get another whitespace so I just replaced scanf(\"%d \") with scanf(\" %d) and it's working.</p>\n"}, {"tags": ["c", "sockets", "embedded-linux"], "comments": [{"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 1, "creation_date": 1458147101, "post_id": 36041740, "comment_id": 59732898, "body": "Looking to <a href=\"https://vilimpoc.org/research/ku-latency/\" rel=\"nofollow noreferrer\">THIS</a>, it seems that <code>SO_TIMESTAMP</code> is used to set the option, not to retrieve data. You must use <a href=\"http://linux.die.net/man/2/recvmsg\" rel=\"nofollow noreferrer\">recvmsg</a> to get infos."}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1458171487, "post_id": 36041740, "comment_id": 59746406, "body": "When you get an error from a system call you should print <code>errno</code> or <code>strerror()</code> or use <code>perror()</code> to do it for you. As you have discovered, -1 doesn&#39;t tell you anything useful."}], "answers": [{"comments": [{"owner": {"reputation": 2952, "user_id": 3200088, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/WlD9X.jpg?s=128&g=1", "display_name": "Gio", "link": "https://stackoverflow.com/users/3200088/gio"}, "edited": false, "score": 0, "creation_date": 1458150232, "post_id": 36042754, "comment_id": 59735138, "body": "I&#39;m trying this now with SIOCGSTAMP, I&#39;ve set SO_TIMESTAMP option to 0 with setsockopt. However the ioctl call is still returning -1. Must I enable the SIOCGSTAMP or can it be that it is not supported by the device driver?"}, {"owner": {"reputation": 137011, "user_id": 567292, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/b55da07dea89fa675c7e2894c77f8024?s=128&d=identicon&r=PG", "display_name": "ecatmur", "link": "https://stackoverflow.com/users/567292/ecatmur"}, "reply_to_user": {"reputation": 2952, "user_id": 3200088, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/WlD9X.jpg?s=128&g=1", "display_name": "Gio", "link": "https://stackoverflow.com/users/3200088/gio"}, "edited": false, "score": 0, "creation_date": 1458151026, "post_id": 36042754, "comment_id": 59735620, "body": "@Gio what is <code>errno</code> set to? The only reason I&#39;m aware that SIOCGSTAMP would fail is if SO_TIMESTAMP is enabled, in which case it would be set to ENOENT."}, {"owner": {"reputation": 2952, "user_id": 3200088, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/WlD9X.jpg?s=128&g=1", "display_name": "Gio", "link": "https://stackoverflow.com/users/3200088/gio"}, "edited": false, "score": 0, "creation_date": 1458152928, "post_id": 36042754, "comment_id": 59736795, "body": "<code>printf(&quot;%s&quot;, strerror(errno))</code> prints  &quot;No such file or directory&quot;."}, {"owner": {"reputation": 137011, "user_id": 567292, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/b55da07dea89fa675c7e2894c77f8024?s=128&d=identicon&r=PG", "display_name": "ecatmur", "link": "https://stackoverflow.com/users/567292/ecatmur"}, "reply_to_user": {"reputation": 2952, "user_id": 3200088, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/WlD9X.jpg?s=128&g=1", "display_name": "Gio", "link": "https://stackoverflow.com/users/3200088/gio"}, "edited": false, "score": 2, "creation_date": 1458153345, "post_id": 36042754, "comment_id": 59737049, "body": "@Gio that indicates that there is no timestamp available on that socket. There&#39;s nothing obviously wrong with what you&#39;re doing - maybe try running the timestamping example from the kernel documentation <a href=\"https://www.kernel.org/doc/Documentation/networking/timestamping/timestamping.c\" rel=\"nofollow noreferrer\">kernel.org/doc/Documentation/networking/timestamping/&hellip;</a> and see if you can get any of that to work."}, {"owner": {"reputation": 2952, "user_id": 3200088, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/WlD9X.jpg?s=128&g=1", "display_name": "Gio", "link": "https://stackoverflow.com/users/3200088/gio"}, "edited": false, "score": 1, "creation_date": 1458207217, "post_id": 36042754, "comment_id": 59760051, "body": "I&#39;ve discovered why it doesn&#39;t work. SIOCGSTAMP only works for UDP packets or RAW sockets, but does not work for TCP."}, {"owner": {"reputation": 1617, "user_id": 247041, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/04e14b97476c57347bf1222cd9836964?s=128&d=identicon&r=PG&f=1", "display_name": "kirbo", "link": "https://stackoverflow.com/users/247041/kirbo"}, "reply_to_user": {"reputation": 2952, "user_id": 3200088, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/WlD9X.jpg?s=128&g=1", "display_name": "Gio", "link": "https://stackoverflow.com/users/3200088/gio"}, "edited": false, "score": 0, "creation_date": 1467625705, "post_id": 36042754, "comment_id": 63789464, "body": "@Gio Have you found a way to obtain kernel level timestamps for TCP? Thanks!"}, {"owner": {"reputation": 137011, "user_id": 567292, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/b55da07dea89fa675c7e2894c77f8024?s=128&d=identicon&r=PG", "display_name": "ecatmur", "link": "https://stackoverflow.com/users/567292/ecatmur"}, "reply_to_user": {"reputation": 1617, "user_id": 247041, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/04e14b97476c57347bf1222cd9836964?s=128&d=identicon&r=PG&f=1", "display_name": "kirbo", "link": "https://stackoverflow.com/users/247041/kirbo"}, "edited": false, "score": 1, "creation_date": 1467628747, "post_id": 36042754, "comment_id": 63791362, "body": "@kirbo it doesn&#39;t make sense to ask for timestamps for TCP, because there&#39;s no direct correlation between arriving packets and data becoming available. If you really want timestamps for TCP you&#39;ll have to use RAW sockets and implement your own TCP stack (or use a userspace TCP library)."}], "tags": [], "owner": {"reputation": 137011, "user_id": 567292, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/b55da07dea89fa675c7e2894c77f8024?s=128&d=identicon&r=PG", "display_name": "ecatmur", "link": "https://stackoverflow.com/users/567292/ecatmur"}, "is_accepted": true, "score": 8, "last_activity_date": 1458151124, "last_edit_date": 1495541308, "creation_date": 1458149111, "answer_id": 36042754, "question_id": 36041740, "link": "https://stackoverflow.com/questions/36041740/obtain-packet-timestamp-through-ioctl-call-on-socket-file-descriptor/36042754#36042754", "title": "Obtain packet timestamp through ioctl call on socket file descriptor", "body": "<p>The ioctl to retrieve the most recent timestamp on the socket is <code>SIOCGSTAMP</code>; <code>SO_TIMESTAMP</code> is a socket option, not an ioctl. Your code should read:</p>\n\n<pre><code>int error = ioctl(fd, SIOCGSTAMP, &amp;tv_ioctl);\n                      ^^^^^^^^^^\n</code></pre>\n\n<p>The alternate method to retrieve timestamps is to change <code>recv</code> to <code>recvmmsg</code> and extract the timestamp from the ancillary data. This is more efficient as it involves fewer system calls (<a href=\"https://stackoverflow.com/questions/13304672/socket-reading-and-timestamps\">Socket reading and timestamps</a>); the ioctl is simpler, though.</p>\n\n<p>Note that SIOCGSTAMP and SO_TIMESTAMP are mutually exclusive - if you're going to use SIOCGSTAMP you should <strong>disable</strong> SO_TIMESTAMP (with <code>enabled = 0</code>). This is because SO_TIMESTAMP directs the kernel to make the timestamp available via <code>recvmmsg</code> ancillary data instead of via SIOCGSTAMP.</p>\n"}], "owner": {"reputation": 2952, "user_id": 3200088, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/WlD9X.jpg?s=128&g=1", "display_name": "Gio", "link": "https://stackoverflow.com/users/3200088/gio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5978, "favorite_count": 4, "accepted_answer_id": 36042754, "answer_count": 1, "score": 8, "last_activity_date": 1458167929, "creation_date": 1458146338, "last_edit_date": 1458167929, "question_id": 36041740, "link": "https://stackoverflow.com/questions/36041740/obtain-packet-timestamp-through-ioctl-call-on-socket-file-descriptor", "title": "Obtain packet timestamp through ioctl call on socket file descriptor", "body": "<p>I'm working on a system running embedded linux. I'm trying to obtain the packet timestamp from a stream I'm receiving on a socket.</p>\n\n<p>After creating the socket, I do the following:</p>\n\n<pre><code>if (fd != -1) {\n    int enabled = 1;\n    setsockopt(fd, SOL_SOCKET, SO_TIMESTAMP, &amp;enabled, sizeof(enabled);\n}\n</code></pre>\n\n<p>After that I bind the socket, the socket is of type SOCK_STREAM. I successfully receive data on the socket, by calling the function <code>recv(fd, buf, size, 0)</code>. Now in order to obtain the timestamp of the received data, I'm currently trying the following:</p>\n\n<pre><code>ret = recv(fd, buf, size, 0);\nif (ret &gt; 0) {\n    struct timeval tv_ioctl;\n    tv_ioctl.tv_sec = 0;\n    tv_ioctl.tv_usec = 0;\n    int error = ioctl(fd, SO_TIMESTAMP, &amp;tv_ioctl);\n    printf(\"%ld.%ld - error = %d\", (long int)tv_ioctl.tv_sec, \n            (long int)tv_ioctl.tv_usec, error);\n}\n</code></pre>\n\n<p>The output of the printf statement is always the following:</p>\n\n<blockquote>\n  <blockquote>\n    <p>0.0 error = -1</p>\n  </blockquote>\n</blockquote>\n\n<p>The error = -1 indicates that the ioctl call has failed. I've performed a test with <code>getsockopt</code> to check if the SO_TIMESTAMP option is set, <code>getsockopt</code> returns 0 for the option SO_TIMESTAMP so it seems correctly set. I'm a bit lost here, how can I further investigate why the ioctl call seems to be failing?</p>\n"}, {"tags": ["c", "arrays", "multithreading"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1458145775, "post_id": 36041268, "comment_id": 59731937, "body": "An array is not a pointer (and vice-versa)!"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1458145873, "post_id": 36041268, "comment_id": 59731996, "body": "<code>sizeof()</code> yields a <code>size_t</code> which is unsigned. In general, it is a bad idea to mix signed (<code>int</code>) and unsigned integers without need. You should use <code>size_t</code> throughout your code."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1458145954, "post_id": 36041268, "comment_id": 59732045, "body": "You can <b>never ever ever</b> use semaphores in multithreading apps sharing common memory between threads."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1458146056, "post_id": 36041268, "comment_id": 59732107, "body": "@SergeyA: I guess the manpage for <code>sem_init</code> is useless then: <code>If pshared has the value 0, then the semaphore is  shared  between  the threads  of  a  process,  and should be located at some address that is visible to all threads (e.g., a global variable, or  a  variable  allocated dynamically on the heap).</code>, since you&#39;re so sure about the &quot;never ever&quot;."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1458146293, "post_id": 36041268, "comment_id": 59732271, "body": "@EOF, I was talking about different set of semaphore routines - the ones controlled with <code>semctl</code> and friends."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1458146430, "post_id": 36041268, "comment_id": 59732386, "body": "@SergeyA: Hmm, that doesn&#39;t sound like &quot;never ever ever&quot;, that sounds like, &quot;if you&#39;re unexpectedly (since you&#39;re using pthreads) using sysV semaphores in particular&quot;."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1458146500, "post_id": 36041268, "comment_id": 59732435, "body": "@EOF, to that I agree. I was too quick to jump to conclusion that OP is using those. Probably because this is a scenario I was dealing with the other day."}, {"owner": {"reputation": 11, "user_id": 6019053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d963fd66928f4085f88c292ae09c722?s=128&d=identicon&r=PG&f=1", "display_name": "GregTheTraceur", "link": "https://stackoverflow.com/users/6019053/gregthetraceur"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1458150514, "post_id": 36041268, "comment_id": 59735310, "body": "@Olaf I get that an array is not a pointer, but I don&#39;t know how to use the former properly. That&#39;s why I&#39;m here asking for help."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 6019053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d963fd66928f4085f88c292ae09c722?s=128&d=identicon&r=PG&f=1", "display_name": "GregTheTraceur", "link": "https://stackoverflow.com/users/6019053/gregthetraceur"}, "edited": false, "score": 0, "creation_date": 1458149011, "post_id": 36041353, "comment_id": 59734284, "body": "The thread allocating it is not the problem, it is the goal. ThreadB IS deferred until ThreadA sets up the buffer. The problem is that I don&#39;t know how to make ThreadA do that. Your printf statement is not relevant to the problem I am trying to solve. bufSize is properly shared between the threads. The buffer itself is not."}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "reply_to_user": {"reputation": 11, "user_id": 6019053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d963fd66928f4085f88c292ae09c722?s=128&d=identicon&r=PG&f=1", "display_name": "GregTheTraceur", "link": "https://stackoverflow.com/users/6019053/gregthetraceur"}, "edited": false, "score": 0, "creation_date": 1458149087, "post_id": 36041353, "comment_id": 59734347, "body": "i showed you how to do that, use a pointer not an array, rest is fine, realloc will do the alocate for you"}, {"owner": {"reputation": 11, "user_id": 6019053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d963fd66928f4085f88c292ae09c722?s=128&d=identicon&r=PG&f=1", "display_name": "GregTheTraceur", "link": "https://stackoverflow.com/users/6019053/gregthetraceur"}, "edited": false, "score": 0, "creation_date": 1458149873, "post_id": 36041353, "comment_id": 59734884, "body": "realloc is not getting the job done. threadB is still seeing it as 8 bytes, no matter what size I realloc it to."}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "reply_to_user": {"reputation": 11, "user_id": 6019053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d963fd66928f4085f88c292ae09c722?s=128&d=identicon&r=PG&f=1", "display_name": "GregTheTraceur", "link": "https://stackoverflow.com/users/6019053/gregthetraceur"}, "edited": false, "score": 0, "creation_date": 1458150933, "post_id": 36041353, "comment_id": 59735564, "body": "look at my second code line. sizeof(sharedbuffer) is a constant value (the size of a pointer). you must use bufsize"}], "tags": [], "owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "is_accepted": false, "score": 2, "last_activity_date": 1458145292, "creation_date": 1458145292, "answer_id": 36041353, "question_id": 36041268, "link": "https://stackoverflow.com/questions/36041268/initialize-a-char-array-after-execution-because-size-is-initially-unknown/36041353#36041353", "title": "Initialize a char array after execution because size is initially unknown", "body": "<p>just do</p>\n\n<pre><code>char *sharedBuffer=NULL;\n</code></pre>\n\n<p>and</p>\n\n<pre><code>printf(\"Size of shared buffer: %d\\n\",bufSize);\n</code></pre>\n\n<p>your problem is that thread a allocates it. YOu need to defer threadB till threadA sets up the buffer. Or do some signalling / locking</p>\n"}, {"tags": [], "owner": {"reputation": 4121, "user_id": 2098932, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/BBJGp.jpg?s=128&g=1", "display_name": "Logicrat", "link": "https://stackoverflow.com/users/2098932/logicrat"}, "is_accepted": false, "score": 0, "last_activity_date": 1458145302, "creation_date": 1458145302, "answer_id": 36041356, "question_id": 36041268, "link": "https://stackoverflow.com/questions/36041268/initialize-a-char-array-after-execution-because-size-is-initially-unknown/36041356#36041356", "title": "Initialize a char array after execution because size is initially unknown", "body": "<pre><code>char* sharedBuffer = (char *) malloc(bufSize);\n</code></pre>\n\n<p>Later use <code>free(sharedBuffer);</code> to release the memory when you are finished with it</p>\n"}, {"comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1458145737, "post_id": 36041496, "comment_id": 59731907, "body": "<code>sharedBuffer</code> is a static array. You cannot <code>realloc</code> a static variable!"}], "tags": [], "owner": {"reputation": 1, "user_id": 4965690, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AX49W.png?s=128&g=1", "display_name": "Tomas Vestelind", "link": "https://stackoverflow.com/users/4965690/tomas-vestelind"}, "is_accepted": false, "score": -2, "last_activity_date": 1458146781, "last_edit_date": 1458146781, "creation_date": 1458145670, "answer_id": 36041496, "question_id": 36041268, "link": "https://stackoverflow.com/questions/36041268/initialize-a-char-array-after-execution-because-size-is-initially-unknown/36041496#36041496", "title": "Initialize a char array after execution because size is initially unknown", "body": "<p>First of all, as your second thread is waiting for the first one to get the buffer size, you could invoke getSize() before starting the threads. After that you could then either:\n1. Dynamically allocate the buffer which is in the file scope and have the threads a point to it.\n2. Give each thread the buffer size and let them allocate their own buffers thus isolating the memory and remove the need to protect the memory with locks.</p>\n\n<p>If you go with the first option, there are mutexes in the pthread library that you could statically allocate in the file scope or send a pointer to it in each thread to handle the synchronization.</p>\n\n<p>Another issue is that you cannot realloc statically allocated memory, so you change it to a char* instead which you reassign with a pointer returned from malloc.\nIf thread B needs to know the size of the array and you go with option 1, then you should store this in a file scoped variable as well.</p>\n"}, {"comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1458145932, "post_id": 36041562, "comment_id": 59732032, "body": "You can totally <code>realloc()</code> something you allocated by <code>calloc()</code>, or <code>realloc()</code>."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1458146048, "post_id": 36041562, "comment_id": 59732100, "body": "&quot;There is also a third, huge issue in your code. Semaphores CAN NOT be used with multithreaded apps using common memory!&quot; - Huh? Please elaborate what you mean!"}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1458146346, "post_id": 36041562, "comment_id": 59732313, "body": "@Olaf, SystemV semaphores (<code>semctl</code> and friends) are not suited for this. I guess, I was to quick to assume OP is using those."}, {"owner": {"reputation": 11, "user_id": 6019053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d963fd66928f4085f88c292ae09c722?s=128&d=identicon&r=PG&f=1", "display_name": "GregTheTraceur", "link": "https://stackoverflow.com/users/6019053/gregthetraceur"}, "edited": false, "score": 0, "creation_date": 1458150247, "post_id": 36041562, "comment_id": 59735146, "body": "ThreadB doesn&#39;t actually care what the size is. It just has to be able to see the array created by ThreadA."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 11, "user_id": 6019053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d963fd66928f4085f88c292ae09c722?s=128&d=identicon&r=PG&f=1", "display_name": "GregTheTraceur", "link": "https://stackoverflow.com/users/6019053/gregthetraceur"}, "edited": false, "score": 0, "creation_date": 1458151124, "post_id": 36041562, "comment_id": 59735673, "body": "@GregTheTraceur, what are you expecting to do with an array of unknown size?"}], "tags": [], "owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "is_accepted": false, "score": -1, "last_activity_date": 1458146413, "last_edit_date": 1458146413, "creation_date": 1458145833, "answer_id": 36041562, "question_id": 36041268, "link": "https://stackoverflow.com/questions/36041268/initialize-a-char-array-after-execution-because-size-is-initially-unknown/36041562#36041562", "title": "Initialize a char array after execution because size is initially unknown", "body": "<p>You can't <code>realloc</code> something which you didn't alloc with <code>malloc</code> first!. What you need to do is make your buffer a <code>char*</code>, and than <code>malloc()</code> it in first thread. </p>\n\n<p>In the second thread you should use the size set by the first thread.</p>\n\n<p>There is also a third, possible issue in your code. Depending on type of semaphores you use, they might not be suited for multithreaded environment. The ones you obtain with <code>semctl()</code> are the ones to avoid in such scenarios. The ones you get with <code>sem_init</code> are OK.</p>\n"}], "owner": {"reputation": 11, "user_id": 6019053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d963fd66928f4085f88c292ae09c722?s=128&d=identicon&r=PG&f=1", "display_name": "GregTheTraceur", "link": "https://stackoverflow.com/users/6019053/gregthetraceur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "answer_count": 4, "score": -1, "last_activity_date": 1458150647, "creation_date": 1458145079, "last_edit_date": 1458150647, "question_id": 36041268, "link": "https://stackoverflow.com/questions/36041268/initialize-a-char-array-after-execution-because-size-is-initially-unknown", "title": "Initialize a char array after execution because size is initially unknown", "body": "<p>I'm writing a multi-threaded networking program. I need to declare a char array such that it can be seen by both threads. Only problem is that I don't know how big the array is going to be at first, since I have to wait for another computer on the network to tell me. The threads will already be created by the time I find out. It is vital that sharedBuffer be exactly the correct size. </p>\n\n<p>Pseudocode below:</p>\n\n<pre><code>int bufSize;\nchar sharedBuffer[1]; //Ideally, sharedBuffer[bufSize]\n                   //bufSize is not known yet, though.\n                   //I don't know the best thing to declare here\n\nint main(int argc, char* argv[]){\n    pthread_t ThreadA;\n    pthread_t ThreadB;\n    pthread_create(&amp;ThreadA,0,&amp;funcA,0);\n    pthread_create(&amp;ThreadB,0,&amp;funcB,0);\n}\n\nvoid *funcA(){\n    bufSize = getSize();//getSize implementation irrelevant, but working\n                        //Small numbers expected. Probably no higher than 1024\n    //Initialize sharedBuffer here\n    sharedBuffer = realloc(sharedBuffer,bufSize*sizeof(char));\n    //Instinct tells me \"sharedBuffer = new char[bufSize];\"\n    //    but I know C wont let me do that\n\n    //semaphore post\n}\n\nvoid *funcB(){\n    //semaphore wait (blocks until threadA posts)\n\n    printf(\"Size of shared buffer: %d\\n\",sizeof(sharedBuffer));\n    //needs to output bufSize\n    //actual value is irrelevant. Data just needs to be shared correctly.\n}\n</code></pre>\n\n<p>Edit: More information because no one seems to get my problem. I do not have a problem with timing and semaphores. Nor is there a problem with data being shared between threads. Nor is there a problem with thread creation. </p>\n\n<p>My problem is that I don't know how to declare the shared buffer as an array type such that it can be initialized by one thread later, such that both threads can use it. I also don't know how to do the initialization.</p>\n"}, {"tags": ["c", "string", "parsing", "memory", "fault"], "comments": [{"owner": {"reputation": 91, "user_id": 5849145, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/427223ff194d4db8a0a327d82bb3e128?s=128&d=identicon&r=PG&f=1", "display_name": "Syed Rumman", "link": "https://stackoverflow.com/users/5849145/syed-rumman"}, "edited": false, "score": 0, "creation_date": 1458145010, "post_id": 36041137, "comment_id": 59731378, "body": "I found the error. For printf(&quot;%c\\n&quot;, file[i]) not printf(&quot;%s\\n&quot;, file[i]). I believe because I am printing character by character not just one string."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1458145093, "post_id": 36041137, "comment_id": 59731449, "body": "Enable compiler warnings and watch them."}, {"owner": {"reputation": 47569, "user_id": 3255455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5993e7ece129141878cd6419d39cc26e?s=128&d=identicon&r=PG&f=1", "display_name": "gnasher729", "link": "https://stackoverflow.com/users/3255455/gnasher729"}, "edited": false, "score": 0, "creation_date": 1458145244, "post_id": 36041137, "comment_id": 59731552, "body": "Exactly: %s is for printing strings, %c is for printing characters. You should first learn to use a debugger, so at least you will find the line that crashes, not just &quot;I get segmentation fault&quot;. Second, whenever you have a problem, you need to approach it by saying: &quot;<i>I</i> made a mistake somewhere. Which mistake did I make? &quot; Never think: &quot;My code is correct, why doesn&#39;t it work&quot;. Always think: &quot;My code is wrong. Where is it wrong? &quot;"}], "answers": [{"comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1458144967, "post_id": 36041195, "comment_id": 59731340, "body": "I think the OP wants <code>printf(&quot;%c\\n&quot;, file[i]);</code>"}, {"owner": {"reputation": 91, "user_id": 5849145, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/427223ff194d4db8a0a327d82bb3e128?s=128&d=identicon&r=PG&f=1", "display_name": "Syed Rumman", "link": "https://stackoverflow.com/users/5849145/syed-rumman"}, "edited": false, "score": 0, "creation_date": 1458145045, "post_id": 36041195, "comment_id": 59731413, "body": "Thanks that makes sense. I fixed the problem my switching %s to %c in printf"}], "tags": [], "owner": {"reputation": 11494, "user_id": 1795279, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/4TEag.jpg?s=128&g=1", "display_name": "Haris", "link": "https://stackoverflow.com/users/1795279/haris"}, "is_accepted": false, "score": 2, "last_activity_date": 1458145052, "last_edit_date": 1458145052, "creation_date": 1458144882, "answer_id": 36041195, "question_id": 36041137, "link": "https://stackoverflow.com/questions/36041137/i-dont-understand-how-i-am-getting-segmentation-fault/36041195#36041195", "title": "I don&#39;t understand how I am getting segmentation fault", "body": "<p>If you want to print each character of the string, then you should use <code>%c</code> and not <code>%s</code>.</p>\n\n<pre><code>printf(\"%c\\n\", file[i]);\n</code></pre>\n\n<hr>\n\n<p>Additionally,</p>\n\n<p>When printing a string using <code>printf(\"%s\", ..)</code>, you need to pass an address where the string is residing, not the content of the address.</p>\n\n<p>So, for a <code>char* str = \"hello\"</code>, print statement would be</p>\n\n<pre><code>printf(\"%s\\n\", str);\n</code></pre>\n\n<p>and NOT</p>\n\n<pre><code>printf(\"%s\\n\", str[0]);\n</code></pre>\n"}], "owner": {"reputation": 91, "user_id": 5849145, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/427223ff194d4db8a0a327d82bb3e128?s=128&d=identicon&r=PG&f=1", "display_name": "Syed Rumman", "link": "https://stackoverflow.com/users/5849145/syed-rumman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "closed_date": 1458158129, "answer_count": 1, "score": -1, "last_activity_date": 1458145052, "creation_date": 1458144731, "question_id": 36041137, "link": "https://stackoverflow.com/questions/36041137/i-dont-understand-how-i-am-getting-segmentation-fault", "closed_reason": "Not suitable for this site", "title": "I don&#39;t understand how I am getting segmentation fault", "body": "<p>When I try to print each character of the file, I get segmentation fault. I don't understand why.   </p>\n\n<pre><code>void parseStringAndDelete(char *file)\n{\n// I a passing \"drwxr-xr-x 1 ftp ftp              0 Mar 07 12:34 A_Folder\"\n// as an argument for the function\n int i = 0;\n int k = 0;\n int len = strlen(file);\n int startIndex = 0;\n\n //printf(\"%s\\n\", file);\n //printf(\"%d\\n\", len);\n if(file[0] == 'd')\n  {\n      for(i = 0; i&lt;len; i++)\n      {\n        printf(\"%s\\n\", file[i]);\n      }\n  }\n\n}\n</code></pre>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 2, "creation_date": 1458144714, "post_id": 36040983, "comment_id": 59731170, "body": "Side note: use <code>%p</code> for pointers."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1458144993, "post_id": 36040983, "comment_id": 59731361, "body": "Using wrong argument type for a type specifier in a format string invokes undefined behaviour. Once invoked, you are out of the language - anything can happen."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 1, "creation_date": 1458145037, "post_id": 36040983, "comment_id": 59731401, "body": "C11 draft standard n1570: <code>6.5.3.2 Address and indirection operators, 3 [...] If the operand is the result of a unary * operator, neither that operator nor the &amp; operator is evaluated and the result is as if both were omitted, except that the constraints on the operators still apply and the result is not an lvalue.</code>"}, {"owner": {"reputation": 258, "user_id": 3770482, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/86eee91f12b0dc2efe98590aa351c6e2?s=128&d=identicon&r=PG&f=1", "display_name": "phong", "link": "https://stackoverflow.com/users/3770482/phong"}, "edited": false, "score": 0, "creation_date": 1458145152, "post_id": 36040983, "comment_id": 59731484, "body": "so if the mem address is : 0018F824. It will print out the &quot;24&quot; byte which means &quot;$&quot;. Ok got it. Thank you, guys."}], "answers": [{"tags": [], "owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "is_accepted": false, "score": 6, "last_activity_date": 1458145262, "last_edit_date": 1458145262, "creation_date": 1458144939, "answer_id": 36041215, "question_id": 36040983, "link": "https://stackoverflow.com/questions/36040983/what-does-char-array-mean-in-c/36041215#36041215", "title": "what does *(&amp;char_array) mean in C?", "body": "<p><code>*(&amp;char_array)</code> is equivalent to <code>char_array</code>. In this case <code>*</code> and <code>&amp;</code> nullify each other's effect.    </p>\n\n<p>C11- \u00a76.5.3.2/3: </p>\n\n<blockquote>\n  <p>The unary <code>&amp;</code> operator yields the address of its operand. If the operand has type \"type\", the result has type \"pointer to type\". If the operand is the result of a unary <code>*</code> operator, neither that operator nor the <code>&amp;</code> operator is evaluated and the result is as if both were omitted, except that the constraints on the operators still apply and the result is not an lvalue. [...]</p>\n</blockquote>\n\n<p>Note that you should have use <code>%p</code> instead of <code>%x</code> for pointer data type.</p>\n"}, {"tags": [], "owner": {"reputation": 4121, "user_id": 2098932, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/BBJGp.jpg?s=128&g=1", "display_name": "Logicrat", "link": "https://stackoverflow.com/users/2098932/logicrat"}, "is_accepted": true, "score": 2, "last_activity_date": 1458145121, "creation_date": 1458145121, "answer_id": 36041281, "question_id": 36040983, "link": "https://stackoverflow.com/questions/36040983/what-does-char-array-mean-in-c/36041281#36041281", "title": "what does *(&amp;char_array) mean in C?", "body": "<pre><code>printf(\"%x : %c\\n\", char_ptr, *char_ptr);\n</code></pre>\n\n<p>prints the character that <code>char_ptr</code> points to, which should be 'h'.</p>\n\n<pre><code>printf(\"%x : %c\\n\", &amp;char_ar, *(&amp;char_ar));\n</code></pre>\n\n<p>prints the first byte of the address of <code>char_ptr</code>, interpreted as a character, which should show up as a completely random and unpredictable character.</p>\n"}, {"tags": [], "owner": {"reputation": 7797, "user_id": 942746, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/34cf9eae5d595c0b480a7cb42f3722b1?s=128&d=identicon&r=PG", "display_name": "Brian McFarland", "link": "https://stackoverflow.com/users/942746/brian-mcfarland"}, "is_accepted": false, "score": 0, "last_activity_date": 1458145392, "last_edit_date": 1495535279, "creation_date": 1458145392, "answer_id": 36041382, "question_id": 36040983, "link": "https://stackoverflow.com/questions/36040983/what-does-char-array-mean-in-c/36041382#36041382", "title": "what does *(&amp;char_array) mean in C?", "body": "<p>haccks is absolutely correct that <code>*(&amp;char_ar)</code> is equivalent to <code>char_ar</code>, but I also wanted to add that <code>*(&amp;char_ar)</code> is NOT the same as <code>&amp;*char_ar</code>.  </p>\n\n<p>Add these two lines to see the difference:</p>\n\n<pre><code>// This is a char**\nprintf(\"%p, sizeof(&amp;*char_ar): %d\\n\", &amp;*char_ar, sizeof(&amp;*char_ar));\n\n// This is a char*[]\nprintf(\"%p, sizeof(*(&amp;char_ar)): %d\\n\", *(&amp;char_ar), sizeof(*(&amp;char_ar)));\n</code></pre>\n\n<p><a href=\"https://stackoverflow.com/a/14957134/942746\">See here for a additional explanation</a>.</p>\n\n<p>Would've posted as a comment, but it would be a bit much with code examples.</p>\n"}], "owner": {"reputation": 258, "user_id": 3770482, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/86eee91f12b0dc2efe98590aa351c6e2?s=128&d=identicon&r=PG&f=1", "display_name": "phong", "link": "https://stackoverflow.com/users/3770482/phong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 36041281, "answer_count": 3, "score": 1, "last_activity_date": 1458145392, "creation_date": 1458144315, "question_id": 36040983, "link": "https://stackoverflow.com/questions/36040983/what-does-char-array-mean-in-c", "title": "what does *(&amp;char_array) mean in C?", "body": "<p>I have this C program:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(){\n\nchar char_ar[] = \"hello world.\";\nchar* char_ptr = char_ar;\n\n/*Same thing*/\nprintf(\"*Same thing:\\n\");\nprintf(\"%x : %c\\n\", &amp;*char_ptr, *char_ptr);\nprintf(\"%x : %c\\n\", &amp;*char_ar, *char_ar);\n\n/*Not same thing*/\nprintf(\"*Not the same thing:\\n\");\nprintf(\"%x : %c\\n\", char_ptr, *char_ptr);\nprintf(\"%x : %c\\n\", &amp;char_ar, *(&amp;char_ar));\n\ngetchar();\n}\n</code></pre>\n\n<p>The last printf does not print out \"mem_address : h\".</p>\n\n<p>Instead, it prints out \"mem_address : some_random_char\"</p>\n\n<p>What does  <strong>*(&amp;char_array)</strong> in that line do so that it outputs random character?</p>\n"}, {"tags": ["c", "gcc", "global-variables"], "comments": [{"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 2, "creation_date": 1458144542, "post_id": 36040861, "comment_id": 59731035, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/7189982/two-variables-with-same-name-and-type-in-two-different-c-files-compile-with-g\">Two variables with same name and type, in two different .c files, compile with gcc</a>"}, {"owner": {"reputation": 19358, "user_id": 3049655, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/ZLzeP.jpg?s=128&g=1", "display_name": "Spikatrix", "link": "https://stackoverflow.com/users/3049655/spikatrix"}, "edited": false, "score": 0, "creation_date": 1458145351, "post_id": 36040861, "comment_id": 59731630, "body": "<a href=\"http://stackoverflow.com/q/21275992/3049655\">stackoverflow.com/q/21275992/3049655</a> ,  <a href=\"http://stackoverflow.com/questions/1490693/tentative-definitions-in-c99-and-linking\" title=\"tentative definitions in c99 and linking\">stackoverflow.com/questions/1490693/&hellip;</a>"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1458146066, "post_id": 36040861, "comment_id": 59732120, "body": "<a href=\"http://stackoverflow.com/questions/3095861/about-tentative-definition\">This SO article</a> might be helpful."}, {"owner": {"reputation": 196, "user_id": 4131224, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8091390e01ad4c8f5849509abbe9f0e9?s=128&d=identicon&r=PG&f=1", "display_name": "adam", "link": "https://stackoverflow.com/users/4131224/adam"}, "edited": false, "score": 0, "creation_date": 1545777592, "post_id": 36040861, "comment_id": 94693623, "body": "Related note, when accessing within a shared library, you can find both with dlsym(). This is what the RTLD_NEXT argument is for. I\u2019m not aware of how the order is determined, however.Probably a good practice to avoid it, or share it by defining it once and using the extern keyword in other files."}], "answers": [{"comments": [{"owner": {"reputation": 405, "user_id": 5182723, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/10205453818898510/picture?type=large", "display_name": "Marin Ver\u0161i\u0107", "link": "https://stackoverflow.com/users/5182723/marin-ver%c5%a1i%c4%87"}, "edited": false, "score": 0, "creation_date": 1458145463, "post_id": 36041041, "comment_id": 59731729, "body": "I do not believe you are correct because int var; is a variable declaration and definition. The fact that you can use it right away proves it is also a definition, does it not?"}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "reply_to_user": {"reputation": 405, "user_id": 5182723, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/10205453818898510/picture?type=large", "display_name": "Marin Ver\u0161i\u0107", "link": "https://stackoverflow.com/users/5182723/marin-ver%c5%a1i%c4%87"}, "edited": false, "score": 0, "creation_date": 1458145687, "post_id": 36041041, "comment_id": 59731874, "body": "The C99 standard calls that a &quot;tentative definition&quot;; The &quot;multiple definition&quot; error message (and I) are still using the old K&amp;R terminology."}, {"owner": {"reputation": 405, "user_id": 5182723, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/10205453818898510/picture?type=large", "display_name": "Marin Ver\u0161i\u0107", "link": "https://stackoverflow.com/users/5182723/marin-ver%c5%a1i%c4%87"}, "edited": false, "score": 0, "creation_date": 1458147422, "post_id": 36041041, "comment_id": 59733166, "body": "Yeah, that is it, as I just found out from @Cool Guy&#39;s comment"}], "tags": [], "owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "is_accepted": true, "score": 1, "last_activity_date": 1458144476, "creation_date": 1458144476, "answer_id": 36041041, "question_id": 36040861, "link": "https://stackoverflow.com/questions/36040861/multiple-definitions-of-a-global-variable/36041041#36041041", "title": "Multiple definitions of a global variable", "body": "<p>A global variable can have any number of <em>declarations</em>, but only one <em>definition</em>. An initializer makes it a definition, so it will complain about having two of those (even if they agree).</p>\n"}], "owner": {"reputation": 405, "user_id": 5182723, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/10205453818898510/picture?type=large", "display_name": "Marin Ver\u0161i\u0107", "link": "https://stackoverflow.com/users/5182723/marin-ver%c5%a1i%c4%87"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2341, "favorite_count": 0, "accepted_answer_id": 36041041, "answer_count": 1, "score": 3, "last_activity_date": 1545789199, "creation_date": 1458143999, "last_edit_date": 1592644375, "question_id": 36040861, "link": "https://stackoverflow.com/questions/36040861/multiple-definitions-of-a-global-variable", "title": "Multiple definitions of a global variable", "body": "<p>I stumbled upon this weird behaviour when compiling C programs using <strong>gcc</strong>.</p>\n<p>Let's say we have these two simple source files:</p>\n<h1>fun.c</h1>\n<pre><code>#include &lt;stdio.h&gt;\n\n// int var = 10;   Results in Gcc compiler error if global variable is initialized\nint var;\n\nvoid fun(void) {\n    printf(&quot;Fun: %d\\n&quot;, var);\n}\n</code></pre>\n<h1>main.c</h1>\n<pre><code>#include &lt;stdio.h&gt;\nint var = 10;\nint main(void) {\n    fun();\n    printf(&quot;Main: %d\\n&quot;, var);\n}\n</code></pre>\n<p>Surprisingly, when compiled as <code>gcc main.c fun.c -o main.out</code> this doesn't produce <strong>multiple definition linker error</strong>.</p>\n<p>One would expect <strong>multiple definition linker error</strong> to occur just the same, regardless of global variable initialization.\nDoes it mean that compiler makes uninitialized global variables extern by default?</p>\n"}, {"tags": ["c", "struct"], "comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 1, "creation_date": 1458144045, "post_id": 36040843, "comment_id": 59730648, "body": "<code>struct owner *own;</code> does not initialize the pointer. Using the value of this pointer is undefined behavior."}, {"owner": {"reputation": 19358, "user_id": 3049655, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/ZLzeP.jpg?s=128&g=1", "display_name": "Spikatrix", "link": "https://stackoverflow.com/users/3049655/spikatrix"}, "edited": false, "score": 0, "creation_date": 1458144201, "post_id": 36040843, "comment_id": 59730759, "body": "<code>struct owner *own;</code> \u2192 <code>struct owner data, *own = &amp;data;</code> or <code>struct owner *own = malloc(sizeof *own); &#47;* And After own&#39;s Use *&#47; free(own);</code>"}, {"owner": {"reputation": 8687, "user_id": 325117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f0766debb859466aed4b305cc915d8e?s=128&d=identicon&r=PG", "display_name": "Martin Broadhurst", "link": "https://stackoverflow.com/users/325117/martin-broadhurst"}, "edited": false, "score": 1, "creation_date": 1458144203, "post_id": 36040843, "comment_id": 59730760, "body": "Enable warnings on your compiler."}, {"owner": {"reputation": 61, "user_id": 6001176, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/2bb2b5d43387ae6056320dd191f802f8?s=128&d=identicon&r=PG&f=1", "display_name": "kahsay.k", "link": "https://stackoverflow.com/users/6001176/kahsay-k"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1458144239, "post_id": 36040843, "comment_id": 59730788, "body": "@EOF: &quot;undifined behaviour&quot; , cant access any values? can you explain?"}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1458144422, "post_id": 36040843, "comment_id": 59730931, "body": "@kahsay.k: C11 draft standard n1570, <code>3. Terms, definitions, and symbols, 3.4.3 1 undefined behavior: behavior, upon use of a nonportable or erroneous program construct or of erroneous data, for which this International Standard imposes no requirements</code>"}], "answers": [{"tags": [], "owner": {"reputation": 2619, "user_id": 4183255, "user_type": "registered", "accept_rate": 78, "profile_image": "https://graph.facebook.com/100002672903408/picture?type=large", "display_name": "Priyansh Goel", "link": "https://stackoverflow.com/users/4183255/priyansh-goel"}, "is_accepted": false, "score": 2, "last_activity_date": 1458144425, "last_edit_date": 1458144425, "creation_date": 1458144198, "answer_id": 36040930, "question_id": 36040843, "link": "https://stackoverflow.com/questions/36040843/load-data-to-struct-and-display-c/36040930#36040930", "title": "load data to struct and display, c", "body": "<p>You need to initialize    <code>struct owner *own;</code> using <code>malloc()</code> like this:</p>\n\n<p><code>own = (struct owner*) malloc(sizeof(struct owner);</code> </p>\n\n<p>and don't forget to free memory at the end: </p>\n\n<p><code>free(own);</code></p>\n\n<p>Also, in both your structs, you are making a  pointer to an integer rather than integer. I don't think you need an int*.</p>\n"}, {"tags": [], "owner": {"reputation": 124806, "user_id": 121747, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/9fcebb68b105446c0d9eebbce1146044?s=128&d=identicon&r=PG&f=1", "display_name": "Jack", "link": "https://stackoverflow.com/users/121747/jack"}, "is_accepted": false, "score": 3, "last_activity_date": 1458144405, "last_edit_date": 1458144405, "creation_date": 1458144260, "answer_id": 36040956, "question_id": 36040843, "link": "https://stackoverflow.com/questions/36040843/load-data-to-struct-and-display-c/36040956#36040956", "title": "load data to struct and display, c", "body": "<p>Yes, you are missing the fact that you declare and use a pointer to a <code>struct owner</code>, which means that you must initialize it.</p>\n\n<p>So you could do</p>\n\n<pre><code>struct owner *own = calloc(1, sizeof(struct owner));\n..\nfree(own);\n</code></pre>\n\n<p>but if you don't need to allocate it on heap then you could just allocate it on stack:</p>\n\n<pre><code>struct owner own;\nown.tdata.first_name = ...;\n</code></pre>\n\n<p>Allocating it on the stack wouldn't prevent you from getting the address and pass it to <code>display_my_output</code> function. You just need to call it through <code>display_my_output(&amp;own);</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 11698, "user_id": 5399734, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2162d669508364bb0c03aba1a2473aa8?s=128&d=identicon&r=PG&f=1", "display_name": "nalzok", "link": "https://stackoverflow.com/users/5399734/nalzok"}, "is_accepted": false, "score": 0, "last_activity_date": 1458145196, "creation_date": 1458145196, "answer_id": 36041319, "question_id": 36040843, "link": "https://stackoverflow.com/questions/36040843/load-data-to-struct-and-display-c/36041319#36041319", "title": "load data to struct and display, c", "body": "<p><code>struct owner *own;</code> declares a pointer to <code>struct owner</code>. Yes, now the compiler knows that the object <code>own</code> points to is a <code>struct owner</code>, but which <code>struct owner</code> is it pointing to? The compiler didn't know, because you didn't tell it. </p>\n\n<p>In fact, an uninitialised pointer may point to an invalid/unavailable memory address, or contain a \"trap representation\". The result of either of them is undefined behaviour, which causes <code>segfault</code> in your case.</p>\n\n<p>To fix this, write</p>\n\n<pre><code>struct owner *own = malloc(sizeof(struct owner));\n</code></pre>\n\n<p>The call to <code>malloc()</code> allocates a block of memory to hold a <code>struct owner</code> to <code>own</code>; thus it'll be pointing to valid memory.</p>\n\n<p>Also, don't forget to add <code>free(own)</code> before <code>main()</code> returns, or you will get a memory leak.</p>\n"}], "owner": {"reputation": 61, "user_id": 6001176, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/2bb2b5d43387ae6056320dd191f802f8?s=128&d=identicon&r=PG&f=1", "display_name": "kahsay.k", "link": "https://stackoverflow.com/users/6001176/kahsay-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 141, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1458145196, "creation_date": 1458143941, "last_edit_date": 1458144345, "question_id": 36040843, "link": "https://stackoverflow.com/questions/36040843/load-data-to-struct-and-display-c", "title": "load data to struct and display, c", "body": "<p>I am new to use C programming and trying to fill a structure and print the actual data stored in my struct. I'm stuck with <code>segfault</code>. see my sample code: </p>\n\n<p>main.c</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdint.h&gt;\n#include &lt;stddef.h&gt;\n\nstruct full_data \n{\n    char *first_name;               \n    char *last_name;\n    int *id_code;\n\n};\n\nstruct owner \n{\n    int *owner_code;\n    struct full_data tdata;\n};\n\nvoid display_my_output(struct owner *mydata)\n{\n    printf(\"My data should be: \\nfirst_name: %s\\nlast_name: %s\\nid_code: %d\\nowner_id: %d\\n\",mydata-&gt;tdata.first_name ,mydata-&gt;tdata.last_name,mydata-&gt;tdata.id_code,mydata-&gt;owner_code);\n}\nint main()\n{\n    int i;\n    struct owner *own;\n    for(i=0 ; i&lt;4 ; i++)\n    {\n        if(i==0)\n        {\n            own-&gt;tdata.first_name = \"PAUL\";\n        }\n        if(i==1)\n        {\n            own-&gt;tdata.last_name = \"ROOT\";\n        }\n        if(i==2)\n        {\n            own-&gt;tdata.id_code =30001;\n        }\n        if(i==3)\n        {\n            own-&gt;owner_code = 2*i;\n        }\n    }\n    display_my_output(own);\n    return 0;\n}\n</code></pre>\n\n<p>Am expecting my out put as:</p>\n\n<pre><code>My data should be:\nfirst_name: PAUL\nlast_name: ROOT\nid_code: 30001\nowner_id: 6\n</code></pre>\n\n<p>Do i miss something in my code?</p>\n"}, {"tags": ["c", "multidimensional-array", "char"], "comments": [{"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 1, "creation_date": 1458143745, "post_id": 36040595, "comment_id": 59730394, "body": "note <code>char *gets_s( char *str, rsize_t n );</code>"}, {"owner": {"reputation": 19358, "user_id": 3049655, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/ZLzeP.jpg?s=128&g=1", "display_name": "Spikatrix", "link": "https://stackoverflow.com/users/3049655/spikatrix"}, "edited": false, "score": 2, "creation_date": 1458143778, "post_id": 36040595, "comment_id": 59730423, "body": "<code>scanf_s(&quot;%f&quot;, &amp;pluviosidad[j][i]);</code> \u2192 <code>scanf_s(&quot;%f&quot;, &amp;pluviosidad[i][j]);</code>, <code>gets_s(lugares[i]);</code> \u2192 <code>gets_s(lugares[i], sizeof lugares[i]);</code>"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1458143895, "post_id": 36040595, "comment_id": 59730521, "body": "<code>fflush(stdin)</code> leads to undefined behavior."}, {"owner": {"reputation": 35, "user_id": 6072465, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9d079eaa9b3141101fd16fb46db97479?s=128&d=identicon&r=PG&f=1", "display_name": "NeptaliD", "link": "https://stackoverflow.com/users/6072465/neptalid"}, "reply_to_user": {"reputation": 19358, "user_id": 3049655, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/ZLzeP.jpg?s=128&g=1", "display_name": "Spikatrix", "link": "https://stackoverflow.com/users/3049655/spikatrix"}, "edited": false, "score": 0, "creation_date": 1458145375, "post_id": 36040595, "comment_id": 59731647, "body": "@CoolGuy it worked out changing the index order in scanf_s but how can I store the values per row? i thought that doing it in the way i posted meant like pluviosidad[0][0],pluviosidad[1][0], so it fills it up per row then goes [0][1], [1][1], [2][1],[3][1], etc"}, {"owner": {"reputation": 19358, "user_id": 3049655, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/ZLzeP.jpg?s=128&g=1", "display_name": "Spikatrix", "link": "https://stackoverflow.com/users/3049655/spikatrix"}, "edited": false, "score": 0, "creation_date": 1458145545, "post_id": 36040595, "comment_id": 59731785, "body": "@NeptaliD You forgot to interchange the loop conditions. Use <code>for (i = 0; i&lt;nDias; i++){ for (j = 0; j&lt;nLugares; j++){ scanf_s(&quot;%f&quot;, &amp;pluviosidad[j][i]); } }</code>"}, {"owner": {"reputation": 35, "user_id": 6072465, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9d079eaa9b3141101fd16fb46db97479?s=128&d=identicon&r=PG&f=1", "display_name": "NeptaliD", "link": "https://stackoverflow.com/users/6072465/neptalid"}, "reply_to_user": {"reputation": 19358, "user_id": 3049655, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/ZLzeP.jpg?s=128&g=1", "display_name": "Spikatrix", "link": "https://stackoverflow.com/users/3049655/spikatrix"}, "edited": false, "score": 0, "creation_date": 1458145861, "post_id": 36040595, "comment_id": 59731985, "body": "@CoolGuy thanks so much! it worked, i see now why that happened"}], "owner": {"reputation": 35, "user_id": 6072465, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9d079eaa9b3141101fd16fb46db97479?s=128&d=identicon&r=PG&f=1", "display_name": "NeptaliD", "link": "https://stackoverflow.com/users/6072465/neptalid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1458143290, "creation_date": 1458143290, "question_id": 36040595, "link": "https://stackoverflow.com/questions/36040595/corrupted-2d-char-array-after-cycle", "title": "Corrupted 2D Char Array After Cycle", "body": "<p>i'm writing a simple C program where i'm getting the names of the places(lugares) that have been raining, this is just a practice exercise, the thing is that somehow after the cycle where i get the amounts of pluviosity(pluviosidad) the 2d char array of places(lugares) gets corrupted and its first element loses its content and ends up with garbage, I've been thinking of why this happens in the last 4 hours trying to fix this and I don't see why it happens. Any help would be highly appreciated, thanks in advance!</p>\n\n<p>PD: As far as i'm aware of a 2D Char array works like this [sizeofthearray][lengthofeachelement] so I don't know if somehow i'm making this array unstable, since i'm just using the %-10s to format the outputs. And the lengths of its contents aren't even beyond to 12-15 characters i placed 25 just in case i need more when it gets evaluated.</p>\n\n<pre><code>const int nDias = 5;\nconst int nLugares = 3;\nint i, j;\n\n// Arrays Creation\nchar lugares[nLugares][25];\nfloat pluviosidad[nLugares][nDias];\n\n// A) Data loading\nfor (i = 0; i&lt;nLugares; i++){\n\n    printf(\"Ingrese el Nombre del Lugar %d:\\n\", i + 1);\n    gets_s(lugares[i]);\n    fflush(stdin);\n\n}\n\n// Somehow after these 2 cycles finish, the \"lugares\" 2d char array gets corrupted. (I noticed this when doing a debugging session in visual studio)\nfor (i = 0; i&lt;nLugares; i++){\n\n    system(\"cls\");\n\n    for (j = 0; j&lt;nDias; j++){\n\n        printf(\"Ingrese pluviosidad para %s en el dia %d: \", lugares[i], j + 1);\n        scanf_s(\"%f\", &amp;pluviosidad[j][i]);\n\n    }\n\n}\n\n// Output Data\n\nprintf(\"\\t\\tLugares\\n\");\nprintf(\"%-10s\", \"Dias\");\n\n// and here I try to see its contents and in this case of 3 elements on the lugares 2d char array, the first element loses its contents and ends up with garbage. \nfor (i = 0; i&lt;nLugares; i++)\n    printf(\"%-26s\", lugares[i]);\n</code></pre>\n"}, {"tags": ["c", "unions"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1458143147, "post_id": 36040364, "comment_id": 59729942, "body": "Apparently the function always returns an <code>int</code>. So why using a <code>union</code>?"}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 2, "creation_date": 1458143473, "post_id": 36040364, "comment_id": 59730194, "body": "You might be surprised if you use <code>arr</code> member: <a href=\"https://stackoverflow.com/questions/25759295/arrays-that-are-not-lvalues-and-sequence-point-restriction/25759612#25759612\" title=\"arrays that are not lvalues and sequence point restriction\">stackoverflow.com/questions/25759295/&hellip;</a> It seems ub in C99:  <a href=\"https://stackoverflow.com/questions/13755628/undefined-behavior-when-attempting-to-access-the-result-of-function-call/13755846#13755846\" title=\"undefined behavior when attempting to access the result of function call\">stackoverflow.com/questions/13755628/&hellip;</a>"}, {"owner": {"reputation": 10492, "user_id": 146377, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5b36bf29056af38269b2147d5c36b94e?s=128&d=identicon&r=PG", "display_name": "Patrick Schl&#252;ter", "link": "https://stackoverflow.com/users/146377/patrick-schl%c3%bcter"}, "edited": false, "score": 0, "creation_date": 1458143641, "post_id": 36040364, "comment_id": 59730331, "body": "Just a contrived example for the question. In my real  project the union has 3 different fields that are accessed differently in different modules. There would be no point in over complexifying the example."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 1, "creation_date": 1458144436, "post_id": 36040364, "comment_id": 59730946, "body": "@2501: C standard is C11, not C99. Do you have any idea how that is with C11? How do you mean that anyway? The function returns a <code>union</code>. The member-operator <code>.</code> then is applied like to a named union variable."}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1458144543, "post_id": 36040364, "comment_id": 59731036, "body": "@Olaf OP is asking about C99. For C11, see temporary lifetime in the second link."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1458144617, "post_id": 36040364, "comment_id": 59731094, "body": "@2501: OP asks how this is in the standard, which would be C11, not C99. Maybe he has the wrong assumption C99 still is the standard. The C tag also is clearly referencing the C standard, not some older version. That&#39;s what the c99, etc. tags are for. He should clarify."}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1458144733, "post_id": 36040364, "comment_id": 59731184, "body": "@PatrickSchl&#252;ter The second link explains this for both C99 and C11. IMO this is a duplicate of that question."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1458144755, "post_id": 36040364, "comment_id": 59731198, "body": "&quot;Is it allowed by <b>the</b> standard (C99)&quot; - C standard is currently C11, not C99. Do you ask about the <b>previous</b> standard (which is C99) or do you mean the C standard (aka C11)?"}, {"owner": {"reputation": 10492, "user_id": 146377, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5b36bf29056af38269b2147d5c36b94e?s=128&d=identicon&r=PG", "display_name": "Patrick Schl&#252;ter", "link": "https://stackoverflow.com/users/146377/patrick-schl%c3%bcter"}, "reply_to_user": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 1, "creation_date": 1458144934, "post_id": 36040364, "comment_id": 59731317, "body": "@2501, yes, I should have read the link till the end before editing my question :-) It gives exactly the answer I needed. Could you make your comment as an answer so that I can give you the &quot;right answer&quot; points?"}, {"owner": {"reputation": 10492, "user_id": 146377, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5b36bf29056af38269b2147d5c36b94e?s=128&d=identicon&r=PG", "display_name": "Patrick Schl&#252;ter", "link": "https://stackoverflow.com/users/146377/patrick-schl%c3%bcter"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1458145049, "post_id": 36040364, "comment_id": 59731415, "body": "@Olaf I asked for C99, because that is officially what our project is supposed to be conformant with, but you&#39;re right that current standard is C11."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1458145575, "post_id": 36040364, "comment_id": 59731814, "body": "So just a small recommendation: Please don&#39;t use the term &quot;the standard&quot; when not asking about <b>the</b> standard like canceled versions."}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1458145685, "post_id": 36040364, "comment_id": 59731870, "body": "@PatrickSchl&#252;ter Please vote to close as a duplicate."}], "answers": [{"comments": [{"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 1, "creation_date": 1458143007, "post_id": 36040430, "comment_id": 59729831, "body": "Out of curiosity: is it thread safe on Linux platform?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 2, "creation_date": 1458143056, "post_id": 36040430, "comment_id": 59729861, "body": "@LPs: I would expect it is as thread-safe as the long way using a named variable in-between."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1458143371, "post_id": 36040430, "comment_id": 59730112, "body": "@Olaf thx. I was asking that because of I had problems with a old compiler/OS (introlne) where struct and unions was returned in a common area."}, {"owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "reply_to_user": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 1, "creation_date": 1458143662, "post_id": 36040430, "comment_id": 59730344, "body": "@LPs; If <code>thinga</code> is private to each thread then there would be no problem."}], "tags": [], "owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "is_accepted": true, "score": 3, "last_activity_date": 1458146398, "last_edit_date": 1458146398, "creation_date": 1458142864, "answer_id": 36040430, "question_id": 36040364, "link": "https://stackoverflow.com/questions/36040364/is-it-legal-to-access-a-field-of-a-returned-union-without-a-variable/36040430#36040430", "title": "Is it legal to access a field of a returned union without a variable?", "body": "<p>This is valid and allowed by c standard and there is no undefined behavior in this code.  </p>\n\n<p><strong>EDIT:</strong> For the snippet   </p>\n\n<pre><code> int main(void)\n {\n     printf(\" thinga.integ=%d .arr=%s\\n\", f(\"1\").integ, f(\"1\").arr);\n }  \n</code></pre>\n\n<p><code>f(\"1\").arr</code> is referencing <code>arr</code> element of the union. Since <code>arr</code> is an array and as per C rule, in this context array will decay to pointer to its first element. Since <code>t</code> is local to the function (an automatic local variable and will no longer be exist once function return), accessing <code>arr</code> elements will invoke undefined behavior.</p>\n"}, {"tags": [], "owner": {"reputation": 11698, "user_id": 5399734, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2162d669508364bb0c03aba1a2473aa8?s=128&d=identicon&r=PG&f=1", "display_name": "nalzok", "link": "https://stackoverflow.com/users/5399734/nalzok"}, "is_accepted": false, "score": 0, "last_activity_date": 1458144716, "last_edit_date": 1458144716, "creation_date": 1458143543, "answer_id": 36040694, "question_id": 36040364, "link": "https://stackoverflow.com/questions/36040364/is-it-legal-to-access-a-field-of-a-returned-union-without-a-variable/36040694#36040694", "title": "Is it legal to access a field of a returned union without a variable?", "body": "<p>This is just identical to</p>\n\n<pre><code>printf(\"thinga is %d\\n\", (union thinga) {.integ = 1}.integ);\n</code></pre>\n\n<p>, which is obviously well-defined.</p>\n"}], "owner": {"reputation": 10492, "user_id": 146377, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5b36bf29056af38269b2147d5c36b94e?s=128&d=identicon&r=PG", "display_name": "Patrick Schl&#252;ter", "link": "https://stackoverflow.com/users/146377/patrick-schl%c3%bcter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 2, "closed_date": 1458220918, "accepted_answer_id": 36040430, "answer_count": 2, "score": 6, "last_activity_date": 1458148878, "creation_date": 1458142714, "last_edit_date": 1458148878, "question_id": 36040364, "link": "https://stackoverflow.com/questions/36040364/is-it-legal-to-access-a-field-of-a-returned-union-without-a-variable", "closed_reason": "Duplicate", "title": "Is it legal to access a field of a returned union without a variable?", "body": "<p>I have a function returning a <code>union</code> type. Is it allowed by the standard (C99) to access a field of a returned value directly from the call without copying the value to a variable. Here an example to illustrate what I mean:</p>\n\n<pre><code>union thinga { int integ; char arr[4]; };\n\nunion thinga f(void)\n{\n  union thinga t = {.integ = 1};\n  return t;\n}\nint main(void)\n{\n   printf(\"thinga is %d\\n\", f().integ);\n}\n</code></pre>\n\n<p>Is the call with field <code>f().integ</code> allowed? In my example it's a <code>union</code> but the issue is the same for <code>struct</code>.\nI ask the question, because I remember vividly that gcc 3.3 on Solaris  didn't like this construct and would warn like hell. Its problem was that it had to generate internally an invisible variable to be able to access the field of the <code>struct</code> or the <code>union</code>. Newer compilers seem not to mind the construct but I would like to know if there is a hidden catch (i.e. <code>undefined bevaviour</code> that I didn't think of.</p>\n\n<p>EDIT: Ok it looks like my contrived example is a bit too simple and as commenter 2501 noticed by giving links to array decaying to pointer on out of scope objects, let's see if we are in the same situation if I change a bit my code.</p>\n\n<pre><code> union thinga f(const char *val)\n {\n   union thinga t = {.integ = 0};\n   t.arr[0] = val[0];\n   return t;\n }\n\n int main(void)\n {\n     printf(\" thinga.integ=%d .arr=%s\\n\", f(\"1\").integ, f(\"1\").arr);\n }\n</code></pre>\n\n<p>is this case the same as given in <a href=\"https://stackoverflow.com/questions/25759295/arrays-that-are-not-lvalues-and-sequence-point-restriction/25759612#25759612\">arrays that are not lvalues and sequence point restriction</a> and <a href=\"https://stackoverflow.com/questions/13755628/undefined-behavior-when-attempting-to-access-the-result-of-function-call/13755846#13755846\">Undefined behavior: when attempting to access the result of function call</a> ? (the value returned are obviously impementation dependend (endiannes) but that is not the issue here).</p>\n"}, {"tags": ["c", "parallel-processing", "mpi", "openmpi"], "comments": [{"owner": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "edited": false, "score": 0, "creation_date": 1458144980, "post_id": 36040273, "comment_id": 59731351, "body": "I don&#39;t see any immediate issues. Can you reproduce that with an <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>? In general I&#39;d advise to use <a href=\"https://www.open-mpi.org/faq/?category=debugging#memchecker_what\" rel=\"nofollow noreferrer\">MPI memory checking</a> and a <a href=\"https://doc.itc.rwth-aachen.de/display/CCP/Project+MUST\" rel=\"nofollow noreferrer\">MPI correctness checker</a>."}], "owner": {"reputation": 398, "user_id": 4717097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/572f493a01cdf47f447002de1624ff5f?s=128&d=identicon&r=PG&f=1", "display_name": "max xilian", "link": "https://stackoverflow.com/users/4717097/max-xilian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 298, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1458142502, "creation_date": 1458142502, "question_id": 36040273, "link": "https://stackoverflow.com/questions/36040273/mpi-gatherv-seems-to-send-receive-wrong-values-in-c", "title": "MPI Gatherv seems to send/receive wrong values (in C)", "body": "<p>I have some trouble using MPI (with C). My program calculates the edge list of a huge network. Every process calculates a small portion of this edge list (root process 0 also does calculate an portion of this edge list). The edge list is a 1-D int array with 2*edge_count_slave elements. The edges are ordered by the number of the first node of the pair.\nIn the end I want to combine all these small edge lists to the proper complete edge list. In the first iteration of this code I only used MPI_Send and MPI_Recv, now i switched to MPI_Gather and MPI_Gatherv, but no matter how i implemented it, I get the same bug: The master/root edge list misses some edges at the end of some (but not all) of the slave edge lists and instead has some new random edges in between. I made a lot of tests but I cant find a solution to this problem.</p>\n\n<p>Here's the source code of the crucial part:</p>\n\n<pre><code>int *edge_counts=NULL;\nint *displ=NULL;\nint *edge_master=NULL;\nint edge_count_master=0;\n\nif (rank == 0){\n    edge_counts = malloc(size*sizeof(int));\n    displ = malloc(size*sizeof(int));\n    displ[0] = 0;\n}\n\n// first gather the number of edges of each process\nMPI_Gather(&amp;edge_count_slave,1,MPI_INT,edge_counts,1,MPI_INT,0,MPI_COMM_WORLD);\n\n// change from number of edges to number of elements in the array and calculate displacement\nif (rank == 0){\n    edge_counts[0]=2*edge_counts[0];\n    for (int mpi_step=1;mpi_step&lt;size;mpi_step++){\n        edge_counts[mpi_step] = 2*edge_counts[mpi_step];\n        displ[mpi_step]=displ[mpi_step-1]+edge_counts[mpi_step-1];\n    }\n    // the total number of elements over all processes\n    edge_count_master = displ[size-1] + edge_counts[size-1];\n}\n\n// looking at the results I found that process 20 misses some edges, so I print parts of the edge list to check it\nif (rank==20){\n    printf(\"checking edge list of process %i with %i elements. \\n\",rank,2*edge_count_slave);\n    for (int istep=0;istep&lt;2*edge_count_slave;istep++){\n        if ((istep % 100==0) || ((istep &lt; 100)  &amp;&amp; (istep % 2 ==0))){\n            printf(\"pr.%i: step=%i val=%i-%i \\n \",rank,istep,edge_list_slave[istep],edge_list_slave[istep+1]);\n        }\n    }\n}\n\nprintf(\"pr.%i: edge_count = %i / elements = %i \\n\",rank,edge_count_slave,2*edge_count_slave);\n\n// allocate edge list master\nif (rank == 0){\n    edge_master = (int *) malloc(edge_count_master*sizeof(int));\n    printf(\"INFORMATION ROOT PROCESS HAS\\n\");\n    for (int istep=0;istep&lt;size;istep++){\n        printf(\"pr:%i: edge_counts[%i]=%i -  displ[%i]=%i\\n\",rank,istep,edge_counts[istep],istep,displ[istep]);\n    }\n}\n\n// gather the edge lists    \nMPI_Gatherv(edge_list_slave,2*edge_count_slave,MPI_INT,edge_master,edge_counts,displ,MPI_INT,0,MPI_COMM_WORLD);\n\nif (rank==0){\n    int checkpr = 20;\n    printf(\"checking edge list of process %i with %i elements from root rank 0. \\n\",checkpr,edge_counts[checkpr]);\n\n    for (int istep=displ[checkpr];istep&lt;displ[checkpr+1];istep++){\n        if (((istep-displ[checkpr]) % 100==0) || (((istep-displ[checkpr]) &lt; 100) &amp;&amp; ((istep-displ[checkpr]) % 2 ==0))){\n            printf(\"pr.%i: step=%i/%i val=%i-%i \\n \",rank,istep,istep-displ[checkpr],edge_master[istep],edge_master[istep+1]);\n        }\n    }\n}\n\nfree(edge_list_slave);\nfree(edge_counts);\nfree(displ);\n</code></pre>\n\n<p>The problem is only strongly showing when looking at big amounts of data / big networks. Here's an output example output calculated with 32 processes. I obviously left out a lot of the printed array elements. You will see that the edge counts are correctly gathered and the displacements also correctly calculated. The edge lists printed share a lot of common elements but are different.   </p>\n\n<pre><code>pr.31: edge_count = 254213 / elements = 508426 \npr.23: edge_count = 305589 / elements = 611178 \npr.30: edge_count = 244545 / elements = 489090 \npr.19: edge_count = 288550 / elements = 577100 \npr.18: edge_count = 345579 / elements = 691158 \nchecking edge list of process 20 with 568698 elements. \npr.20: step=0 val=21860-20107 \npr.20: step=2 val=21860-20108 \npr.20: step=4 val=21860-20280 \npr.20: step=6 val=21860-20281 \npr.20: step=8 val=21860-20282 \npr.20: step=10 val=21860-20283 \npr.20: step=12 val=21860-20284 \npr.20: step=14 val=21860-20285 \npr.20: step=16 val=21860-20454 \npr.20: step=18 val=21860-20455 \npr.20: step=20 val=21860-20456 \npr.20: step=22 val=21860-20457 \npr.20: step=24 val=21860-20458 \npr.20: step=26 val=21860-20459 \npr.20: step=28 val=21860-20460 \npr.20: step=30 val=21860-20461 \npr.20: step=32 val=21860-20628 \npr.20: step=34 val=21860-20629 \npr.20: step=36 val=21860-20630 \npr.20: step=38 val=21860-20631 \npr.20: step=40 val=21860-20632 \npr.20: step=42 val=21860-20633 \npr.20: step=44 val=21860-20634 \npr.20: step=46 val=21860-20635 \npr.20: step=48 val=21860-20636 \npr.20: step=50 val=21860-20801 \npr.20: step=567700 val=22950-24858 \npr.20: step=567800 val=22951-22070 \npr.20: step=567900 val=22951-22940 \npr.20: step=568000 val=22951-23635 \npr.20: step=568100 val=22951-24334 \npr.20: step=568200 val=22951-25210 \npr.20: step=568300 val=22952-22426 \npr.20: step=568400 val=22952-23123 \npr.20: step=568500 val=22952-23819 \npr.20: step=568600 val=22952-24682 \npr.20: edge_count = 284349 / elements = 568698 \npr.22: edge_count = 286565 / elements = 573130 \npr.29: edge_count = 377078 / elements = 754156 \npr.21: edge_count = 282447 / elements = 564894 \npr.24: edge_count = 376232 / elements = 752464 \npr.14: edge_count = 513467 / elements = 1026934 \npr.13: edge_count = 645089 / elements = 1290178 \npr.17: edge_count = 416474 / elements = 832948 \npr.28: edge_count = 459254 / elements = 918508 \npr.16: edge_count = 471214 / elements = 942428 \npr.27: edge_count = 520485 / elements = 1040970 \npr.15: edge_count = 500240 / elements = 1000480 \npr.25: edge_count = 459893 / elements = 919786 \npr.26: edge_count = 523430 / elements = 1046860 \npr.12: edge_count = 864602 / elements = 1729204 \npr.11: edge_count = 1150266 / elements = 2300532 \npr.10: edge_count = 1390092 / elements = 2780184 \npr.9: edge_count = 1737284 / elements = 3474568 \npr.1: edge_count = 2206650 / elements = 4413300 \npr.8: edge_count = 2046545 / elements = 4093090 \npr.2: edge_count = 2681617 / elements = 5363234 \npr.7: edge_count = 2398441 / elements = 4796882 \npr.3: edge_count = 2954885 / elements = 5909770 \npr.6: edge_count = 2684874 / elements = 5369748 \npr.5: edge_count = 3086924 / elements = 6173848 \npr.4: edge_count = 3250719 / elements = 6501438 \npr.0: edge_count = 1786017 / elements = 3572034 \nINFORMATION ROOT PROCESS HAS\npr:0: edge_counts[0]=3572034 -  displ[0]=0\npr:0: edge_counts[1]=4413300 -  displ[1]=3572034\npr:0: edge_counts[2]=5363234 -  displ[2]=7985334\npr:0: edge_counts[3]=5909770 -  displ[3]=13348568\npr:0: edge_counts[4]=6501438 -  displ[4]=19258338\npr:0: edge_counts[5]=6173848 -  displ[5]=25759776\npr:0: edge_counts[6]=5369748 -  displ[6]=31933624\npr:0: edge_counts[7]=4796882 -  displ[7]=37303372\npr:0: edge_counts[8]=4093090 -  displ[8]=42100254\npr:0: edge_counts[9]=3474568 -  displ[9]=46193344\npr:0: edge_counts[10]=2780184 -  displ[10]=49667912\npr:0: edge_counts[11]=2300532 -  displ[11]=52448096\npr:0: edge_counts[12]=1729204 -  displ[12]=54748628\npr:0: edge_counts[13]=1290178 -  displ[13]=56477832\npr:0: edge_counts[14]=1026934 -  displ[14]=57768010\npr:0: edge_counts[15]=1000480 -  displ[15]=58794944\npr:0: edge_counts[16]=942428 -  displ[16]=59795424\npr:0: edge_counts[17]=832948 -  displ[17]=60737852\npr:0: edge_counts[18]=691158 -  displ[18]=61570800\npr:0: edge_counts[19]=577100 -  displ[19]=62261958\npr:0: edge_counts[20]=568698 -  displ[20]=62839058\npr:0: edge_counts[21]=564894 -  displ[21]=63407756\npr:0: edge_counts[22]=573130 -  displ[22]=63972650\npr:0: edge_counts[23]=611178 -  displ[23]=64545780\npr:0: edge_counts[24]=752464 -  displ[24]=65156958\npr:0: edge_counts[25]=919786 -  displ[25]=65909422\npr:0: edge_counts[26]=1046860 -  displ[26]=66829208\npr:0: edge_counts[27]=1040970 -  displ[27]=67876068\npr:0: edge_counts[28]=918508 -  displ[28]=68917038\npr:0: edge_counts[29]=754156 -  displ[29]=69835546\npr:0: edge_counts[30]=489090 -  displ[30]=70589702\npr:0: edge_counts[31]=508426 -  displ[31]=71078792\nchecking edge list of process 20 with 568698 elements from root rank 0. \npr.0: step=62839058/0 val=21860-20106 \npr.0: step=62839060/2 val=21860-20107 \npr.0: step=62839062/4 val=21860-20280 \npr.0: step=62839064/6 val=21860-20281 \npr.0: step=62839066/8 val=21860-20282 \npr.0: step=62839068/10 val=21860-20283 \npr.0: step=62839070/12 val=21860-20454 \npr.0: step=62839072/14 val=21860-20455 \npr.0: step=62839074/16 val=21860-20456 \npr.0: step=62839076/18 val=21860-20457 \npr.0: step=62839078/20 val=21860-20458 \npr.0: step=62839080/22 val=21860-20459 \npr.0: step=62839082/24 val=21860-20627 \npr.0: step=62839084/26 val=21860-20628 \npr.0: step=62839086/28 val=21860-20629 \npr.0: step=62839088/30 val=21860-20630 \npr.0: step=62839090/32 val=21860-20631 \npr.0: step=62839092/34 val=21860-20632 \npr.0: step=62839094/36 val=21860-20633 \npr.0: step=62839096/38 val=21860-20634 \npr.0: step=62839098/40 val=21860-20801 \npr.0: step=62839100/42 val=21860-20802 \npr.0: step=62839102/44 val=21860-20803 \npr.0: step=62839104/46 val=21860-20804 \npr.0: step=62839106/48 val=21860-20805 \npr.0: step=62839108/50 val=21860-20806  \npr.0: step=63406758/567700 val=22821-22989 \npr.0: step=63406858/567800 val=22821-23681 \npr.0: step=63406958/567900 val=22821-24377 \npr.0: step=63407058/568000 val=22821-25081 \npr.0: step=63407158/568100 val=22822-21945 \npr.0: step=63407258/568200 val=22822-22809 \npr.0: step=63407358/568300 val=22822-23338 \npr.0: step=63407458/568400 val=22822-24028 \npr.0: step=63407558/568500 val=22822-24725 \npr.0: step=63407658/568600 val=22822-25601 \n</code></pre>\n\n<p>I really appreciate any help you can provide.</p>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 3, "user_id": 6069746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9415193e69d475394672170f283e31e2?s=128&d=identicon&r=PG&f=1", "display_name": "Mangomeri", "link": "https://stackoverflow.com/users/6069746/mangomeri"}, "edited": false, "score": 0, "creation_date": 1458142471, "post_id": 36040242, "comment_id": 59729403, "body": "void flipper(char *a, char *b, char *c) { \tchar val = *a; \t*a = *b; *b = *c; \t*c = val; }   int main() {   \tchar word[] = &quot;abcdefg&quot;;   \tint i; \tfor (i = 0; i &lt; 5; i++) { \t\tflipper(&amp;word[i], &amp;word[i+1], &amp;word[i+2]); \t}       return 0; }"}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 1, "creation_date": 1458142635, "post_id": 36040242, "comment_id": 59729531, "body": "Can you rephrase your question (especially the first part)? I honestly do not understand it. And preferably shorten the title and put the questions into the body."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1458142652, "post_id": 36040242, "comment_id": 59729548, "body": "Please don&#39;t post an explanation in the title of the question, instead keep a short but descriptive title, and describe the code, what it&#39;s supposed to be doing, and what it actually does in the question body. You might want to <a href=\"http://stackoverflow.com/help/how-to-ask\">read about how to ask good questions</a>."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1458142722, "post_id": 36040242, "comment_id": 59729596, "body": "And don&#39;t post code as a quote (with the leading <code>&gt;</code>). Just indent all code with four spaces. See <a href=\"http://stackoverflow.com/editing-help\">the markdown formatting help</a> for help about formatting."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1458142781, "post_id": 36040242, "comment_id": 59729644, "body": "See the help for how to use markup. And don&#39;t put the question in the title!"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1458144307, "post_id": 36040242, "comment_id": 59730842, "body": "Strings are arrays of characters. A character is not a string. So <code>%s</code>... <code>word[1]</code> doesn&#39;t make any sense, because %s expects a string but you give it a character. Enable compiler warnings."}], "answers": [{"tags": [], "owner": {"reputation": 114, "user_id": 5169462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/996747fcd352ab6f714820dddf1111f4?s=128&d=identicon&r=PG&f=1", "display_name": "Matth", "link": "https://stackoverflow.com/users/5169462/matth"}, "is_accepted": false, "score": 0, "last_activity_date": 1458142600, "creation_date": 1458142600, "answer_id": 36040314, "question_id": 36040242, "link": "https://stackoverflow.com/questions/36040242/how-to-make-printf-of-each-iteration-to-see-value-in-the-char-array-wordand-als/36040314#36040314", "title": "How to make printf of each iteration to see value in the char array word?And also what means when *a=*b(when one pointer equal to another pointer)?", "body": "<p>The <code>*a = *b</code> is pointer derenferencing, it means you're giving to the value pointed at by <code>a</code> the value pointed by <code>b</code>.</p>\n\n<p>For the other part of the question I'd like some more explanation since I can't understand what you're asking.</p>\n"}, {"tags": [], "owner": {"reputation": 11454, "user_id": 646947, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/3f954319b2491c00532c2f40ca984e5d?s=128&d=identicon&r=PG", "display_name": "Cyan", "link": "https://stackoverflow.com/users/646947/cyan"}, "is_accepted": false, "score": 0, "last_activity_date": 1458142685, "creation_date": 1458142685, "answer_id": 36040350, "question_id": 36040242, "link": "https://stackoverflow.com/questions/36040242/how-to-make-printf-of-each-iteration-to-see-value-in-the-char-array-wordand-als/36040350#36040350", "title": "How to make printf of each iteration to see value in the char array word?And also what means when *a=*b(when one pointer equal to another pointer)?", "body": "<p><code>*a = *b;</code> is the same as <code>a[0] = b[0];</code></p>\n\n<p>flipper is just basically shifting 3 values : b->a, c->b, a->c</p>\n\n<p>The objective of <code>main()</code> is unclear.\nIt basically shuffles bytes around in the table <code>word</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 3197, "user_id": 5853530, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/3b9567983f2e1d6c2315fa26202accb6?s=128&d=identicon&r=PG&f=1", "display_name": "Rajeev Singh", "link": "https://stackoverflow.com/users/5853530/rajeev-singh"}, "is_accepted": false, "score": 0, "last_activity_date": 1458143226, "creation_date": 1458143226, "answer_id": 36040571, "question_id": 36040242, "link": "https://stackoverflow.com/questions/36040242/how-to-make-printf-of-each-iteration-to-see-value-in-the-char-array-wordand-als/36040571#36040571", "title": "How to make printf of each iteration to see value in the char array word?And also what means when *a=*b(when one pointer equal to another pointer)?", "body": "<p>I didn't get your first question fully,I think you want to print the state of the array after each iteration.For that add this line  <code>printf(\"%s\",word);</code> after <code>flipper(&amp;word[i], &amp;word[i+1], &amp;word[i+2]);</code> in for loop.</p>\n\n<p>when you write <code>*a=*b</code> , it means the value at which the pointer <code>b</code> is pointing to is copied to the address at which the pointer <code>a</code> is pointing.</p>\n\n<p><code>*a</code> means value at address while <code>a</code> is just the address.</p>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 6069746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9415193e69d475394672170f283e31e2?s=128&d=identicon&r=PG&f=1", "display_name": "Mangomeri", "link": "https://stackoverflow.com/users/6069746/mangomeri"}, "edited": false, "score": 0, "creation_date": 1458201419, "post_id": 36040980, "comment_id": 59756355, "body": "Thank you so much, John!How can i have contact with you?"}, {"owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "reply_to_user": {"reputation": 3, "user_id": 6069746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9415193e69d475394672170f283e31e2?s=128&d=identicon&r=PG&f=1", "display_name": "Mangomeri", "link": "https://stackoverflow.com/users/6069746/mangomeri"}, "edited": false, "score": 0, "creation_date": 1458311452, "post_id": 36040980, "comment_id": 59818378, "body": "@Mangomeri: just keep asking questions here; there are plenty of smart folks to help out.  However, do read up on <a href=\"http://stackoverflow.com/help/how-to-ask\">how to ask good questions</a>, And make sure you have good reference manuals handy - my go-to reference has always been Harbison &amp; Steele&#39;s <a href=\"http://careferencemanual.com\" rel=\"nofollow noreferrer\">C: A Reference Manual</a>."}], "tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": true, "score": 1, "last_activity_date": 1458144305, "creation_date": 1458144305, "answer_id": 36040980, "question_id": 36040242, "link": "https://stackoverflow.com/questions/36040242/how-to-make-printf-of-each-iteration-to-see-value-in-the-char-array-wordand-als/36040980#36040980", "title": "How to make printf of each iteration to see value in the char array word?And also what means when *a=*b(when one pointer equal to another pointer)?", "body": "<p><code>*a = *b</code> simply means to assign the value of the object that <code>b</code> <em>points to</em> to the object that <code>a</code> <em>points to</em>. In this case, <code>a</code> points to <code>word[i]</code> and <code>b</code> points to <code>word[i+1]</code>, so <code>*a = *b</code> means that you're assigning the value of <code>word[i+1]</code> to <code>word[i]</code>.  </p>\n\n<p>Let's walk through the first call to <code>flipper</code>.  At the beginning of the function, the following are true:</p>\n\n<pre><code>Variable      Points To        Value\n--------      ---------        -----\n     val        n/a              'a'  // val is initialized at declaration\n       a        word[0]          'a'\n       b        word[1]          'b'\n       c        word[2]          'c'\n</code></pre>\n\n<p>The <em>expression</em> <code>*a</code> is equivalent to the expression <code>word[0]</code>, which evaluates to the character value <code>'a'</code>.  </p>\n\n<p>After all the assignments have been completed, our variables now look like this:</p>\n\n<pre><code>Variable      Points To        Value\n--------      ---------        -----\n     val        n/a              'a'  // val is initialized at declaration\n       a        word[0]          'b'\n       b        word[1]          'c'\n       c        word[2]          'a'\n</code></pre>\n\n<p>We haven't changed the values of the pointers - they still point to the same objects they did at the beginning of the function.  What we've changed are the contents of the <em>pointed-to</em> objects (<code>word[0]</code>, <code>word[1]</code>, and <code>word[2]</code>).  After the first call to <code>flipper</code>, <code>word</code> looks like this: <code>\"bcadefg\"</code>.  </p>\n\n<p>As for tracking the progress in your code, just do the following:</p>\n\n<pre><code>for (i = 0; i &lt; 5; i++) \n{\n   printf( \"%d: before flip - \\\"%s\\\"\", i, word ); \n   flipper(&amp;word[i], &amp;word[i+1], &amp;word[i+2]); \n   printf( \"%d:  after flip - \\\"%s\\\"\", i, word );\n}\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 6069746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9415193e69d475394672170f283e31e2?s=128&d=identicon&r=PG&f=1", "display_name": "Mangomeri", "link": "https://stackoverflow.com/users/6069746/mangomeri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "closed_date": 1458172426, "accepted_answer_id": 36040980, "answer_count": 4, "score": -3, "last_activity_date": 1458144305, "creation_date": 1458142428, "last_edit_date": 1458143685, "question_id": 36040242, "link": "https://stackoverflow.com/questions/36040242/how-to-make-printf-of-each-iteration-to-see-value-in-the-char-array-wordand-als", "closed_reason": "Needs details or clarity", "title": "How to make printf of each iteration to see value in the char array word?And also what means when *a=*b(when one pointer equal to another pointer)?", "body": "<p>My <code>printf</code> statements are not working. There should be like <code>abcdefg</code> for the first iteration, for the second flipping words in another direction according to code etc in the char array <code>word</code>.</p>\n\n<pre><code>printf(\"first iteration %s\\n\",word[1]);\nprintf(\"second iteration %s\\n\", word[2]);\nprintf(\"second iteration %s\\n\", word[3]);\nprintf(\"second iteration %s\\n\", word[4]);\n</code></pre>\n\n<p>Code:</p>\n\n<pre><code> #include &lt;stdio.h&gt;\n\n\n void flipper(char *a, char *b, char *c) {  char val = *a;  *a = *b; *b\n = *c;  *c = val; }\n\n int main() {\n\n    char word[] = \"abcdefg\";\n\n    int i;  for (i = 0; i &lt; 5; i++) {       flipper(&amp;word[i], &amp;word[i+1],\n &amp;word[i+2]);   }\n\n    return 0; }\n</code></pre>\n"}, {"tags": ["c", "math", "geometry", "trigonometry"], "comments": [{"owner": {"reputation": 14006, "user_id": 2204926, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/FDbXT.png?s=128&g=1", "display_name": "Idos", "link": "https://stackoverflow.com/users/2204926/idos"}, "edited": false, "score": 1, "creation_date": 1458142811, "post_id": 36040209, "comment_id": 59729666, "body": "Did you try casting <code>num</code> to <code>double</code> as well?"}, {"owner": {"reputation": 443, "user_id": 5735630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a01dacc93f117afa749969161fc3a43?s=128&d=identicon&r=PG&f=1", "display_name": "IGarFieldI", "link": "https://stackoverflow.com/users/5735630/igarfieldi"}, "edited": false, "score": 3, "creation_date": 1458143176, "post_id": 36040209, "comment_id": 59729960, "body": "I don&#39;t see the problem here; the value of the variable does change, but the change itself gets smaller and smaller (the factorial rises quite fast). Have you tried printing more digits or investigated the value in the debugger?"}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1458143457, "post_id": 36040209, "comment_id": 59730180, "body": "You <i>do</i>  realize that for lim x -&gt; 0, sin(x) approaches x?"}], "answers": [{"tags": [], "owner": {"reputation": 13248, "user_id": 3375713, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/fUsUA.png?s=128&g=1", "display_name": "S\u043d\u0430\u0111\u043e\u0448\u0192\u0430\u04fd", "link": "https://stackoverflow.com/users/3375713/s%d0%bd%d0%b0%c4%91%d0%be%d1%88%c6%92%d0%b0%d3%bd"}, "is_accepted": false, "score": 0, "last_activity_date": 1458144552, "last_edit_date": 1458144552, "creation_date": 1458143680, "answer_id": 36040730, "question_id": 36040209, "link": "https://stackoverflow.com/questions/36040209/value-of-a-variable-not-changing-in-a-loop/36040730#36040730", "title": "Value of a variable not changing in a loop", "body": "<p>Your program as you have posted seems quite right IF you have your <code>factorial</code> written the right way. I have written factorial this way:</p>\n\n<pre><code>double factorial(int n) {\n    if(n &lt;= 1) {\n        return 1.0;\n    }\n    else {\n        return n * factorial(n-1);\n    }\n}\n</code></pre>\n\n<p>Try using this.</p>\n\n<p>Using <code>0.785398</code> (approx. <code>pi/4</code>) and 10 terms, I get output <code>0.707107</code>.</p>\n\n<pre><code>double d = sinx(0.785398, 10);\nprintf(\"%f\\n\", d); // prints 0.707107\n</code></pre>\n\n<p>Here are some runs:</p>\n\n<pre><code>printf(\"%.20f\\n\", sinx(3.1415926535897932, 100));\nprintf(\"%.20f\\n\", sinx(3.1415926535897932/2, 100));\nprintf(\"%.20f\\n\", sinx(3.1415926535897932/4, 100));\n</code></pre>\n\n<p>Outputs:</p>\n\n<pre><code>0.00000000000000044409\n1.00000000000000000000\n0.70710678118654746000\n</code></pre>\n\n<p>which seem accurate enough, given the pi used is only approximate.</p>\n"}, {"tags": [], "owner": {"reputation": 326, "user_id": 6038394, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a94ccf0235364955feb278203b90b0c2?s=128&d=identicon&r=PG&f=1", "display_name": "JohnDoe2991", "link": "https://stackoverflow.com/users/6038394/johndoe2991"}, "is_accepted": false, "score": 2, "last_activity_date": 1458143922, "creation_date": 1458143922, "answer_id": 36040835, "question_id": 36040209, "link": "https://stackoverflow.com/questions/36040209/value-of-a-variable-not-changing-in-a-loop/36040835#36040835", "title": "Value of a variable not changing in a loop", "body": "<p>Your code should be totally right. At least my calculator gives the same result.</p>\n\n<p>If you change your <code>printf(\"%lf\\n\", result);</code> to <code>printf(\"%.17f\\n\", result);</code> you get this output:</p>\n\n<pre><code>if\n-0.00133333333333333\nelse if\n-0.00133066666666667\nif\n-0.00133066920634921\nelse if\n-0.00133066920493827\nif\n-0.00133066920493878\nelse if\n-0.00133066920493878\n</code></pre>\n\n<p>Now you can see, that it is still changing in every loop, but very little.</p>\n"}, {"tags": [], "owner": {"reputation": 162, "user_id": 4062056, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f1144287b85c426b30d94496a0cf6b2?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander Ekzhanov", "link": "https://stackoverflow.com/users/4062056/alexander-ekzhanov"}, "is_accepted": false, "score": 2, "last_activity_date": 1458147146, "last_edit_date": 1458147146, "creation_date": 1458143922, "answer_id": 36040836, "question_id": 36040209, "link": "https://stackoverflow.com/questions/36040209/value-of-a-variable-not-changing-in-a-loop/36040836#36040836", "title": "Value of a variable not changing in a loop", "body": "<p>Really it converges fast so for double precision there is no difference between 6 and 7 terms. Here is the dump with better precision:</p>\n\n<pre><code>if\n\n-0.00133333333333333350\n\nelse if\n\n-0.00133066666666666680\n\nif\n\n-0.00133066920634920640\n\nelse if\n\n-0.00133066920493827170\n\nif\n\n-0.00133066920493878470\n\nSin(0.2, 6) = 0.19866933079506122000\nif\n\n-0.00133333333333333350\n\nelse if\n\n-0.00133066666666666680\n\nif\n\n-0.00133066920634920640\n\nelse if\n\n-0.00133066920493827170\n\nif\n\n-0.00133066920493878470\n\nelse if\n\n-0.00133066920493878450\n\nSin(0.2, 7) = 0.19866933079506122000\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 21073, "user_id": 3088138, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/114f33fdece969de35d41038fb0eeb46?s=128&d=identicon&r=PG&f=1", "display_name": "Lutz Lehmann", "link": "https://stackoverflow.com/users/3088138/lutz-lehmann"}, "edited": false, "score": 0, "creation_date": 1458222712, "post_id": 36041998, "comment_id": 59771633, "body": "You should probably lead with the line <code>if(x&lt;0) return -sin(-x,terms)</code> to not rely on that <code>mod</code> does the right thing with negative operands, for instance at <code>x=-2*pi</code>. Most implementations will give a negative remainder."}, {"owner": {"reputation": 29, "user_id": 6072560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34a44e532009aa364175fe0cf5d2088a?s=128&d=identicon&r=PG&f=1", "display_name": "zorg93", "link": "https://stackoverflow.com/users/6072560/zorg93"}, "reply_to_user": {"reputation": 21073, "user_id": 3088138, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/114f33fdece969de35d41038fb0eeb46?s=128&d=identicon&r=PG&f=1", "display_name": "Lutz Lehmann", "link": "https://stackoverflow.com/users/3088138/lutz-lehmann"}, "edited": false, "score": 0, "creation_date": 1458864121, "post_id": 36041998, "comment_id": 60057086, "body": "I always thought mod was generally calculated by a - n(floor(a/n) which will always give a +ive answer is n is +ive"}, {"owner": {"reputation": 21073, "user_id": 3088138, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/114f33fdece969de35d41038fb0eeb46?s=128&d=identicon&r=PG&f=1", "display_name": "Lutz Lehmann", "link": "https://stackoverflow.com/users/3088138/lutz-lehmann"}, "edited": false, "score": 0, "creation_date": 1458865185, "post_id": 36041998, "comment_id": 60057337, "body": "That is the mathematical way. But some/many implementations take the integer part of the quotient. This is where (unit) test should be performed."}, {"owner": {"reputation": 29, "user_id": 6072560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34a44e532009aa364175fe0cf5d2088a?s=128&d=identicon&r=PG&f=1", "display_name": "zorg93", "link": "https://stackoverflow.com/users/6072560/zorg93"}, "reply_to_user": {"reputation": 21073, "user_id": 3088138, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/114f33fdece969de35d41038fb0eeb46?s=128&d=identicon&r=PG&f=1", "display_name": "Lutz Lehmann", "link": "https://stackoverflow.com/users/3088138/lutz-lehmann"}, "edited": false, "score": 0, "creation_date": 1458865618, "post_id": 36041998, "comment_id": 60057440, "body": "Any idea why or is saving 1ns on the calculation really that important"}], "tags": [], "owner": {"reputation": 29, "user_id": 6072560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34a44e532009aa364175fe0cf5d2088a?s=128&d=identicon&r=PG&f=1", "display_name": "zorg93", "link": "https://stackoverflow.com/users/6072560/zorg93"}, "is_accepted": false, "score": 2, "last_activity_date": 1458148661, "last_edit_date": 1458148661, "creation_date": 1458146959, "answer_id": 36041998, "question_id": 36040209, "link": "https://stackoverflow.com/questions/36040209/value-of-a-variable-not-changing-in-a-loop/36041998#36041998", "title": "Value of a variable not changing in a loop", "body": "<p>Everything looks correct here. The reason the result doesn't appear to change is to do with how quickly the Taylor series for <code>sin</code> converges for small angles. If you try with a bigger number say <code>pi</code> you should see the value updating slightly more often. You may also want to include something to limit theta from <code>-pi</code> to <code>+pi</code> as sin is a periodic function. </p>\n\n<pre><code>theta = mod(theta+pi, 2*pi) - pi\n</code></pre>\n\n<p>Including this restriction will alleviate the need for more terms if you start calculating values <code>&gt; pi</code> or <code>&lt; -pi</code></p>\n\n<p>If performance is important then you can reduce some of the calculations by removing repeats in calculating the factorials and large exponents</p>\n\n<pre><code>double sin(double theta, int terms = 7)\n    {\n        theta = mod(theta+pi, 2*pi) - pi;\n        double sum = x, term = x, fact = 3;\n        for (int i = 1; i &lt; terms; i++)\n            {\n            term = -term * theta * theta /(fact * (fact - 1));\n            sum += term;\n            fact += 2;\n        }\n    return sum;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 48421, "user_id": 1196549, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/fa597bf0dc47449a25e1f7f5b57e3ef1?s=128&d=identicon&r=PG", "display_name": "Yves Daoust", "link": "https://stackoverflow.com/users/1196549/yves-daoust"}, "is_accepted": false, "score": 0, "last_activity_date": 1458293451, "last_edit_date": 1458293451, "creation_date": 1458293033, "answer_id": 36080562, "question_id": 36040209, "link": "https://stackoverflow.com/questions/36040209/value-of-a-variable-not-changing-in-a-loop/36080562#36080562", "title": "Value of a variable not changing in a loop", "body": "<p>What did you expect ?</p>\n\n<p>The third term is</p>\n\n<pre><code>0.2^5/120 = 0.000002\n</code></pre>\n\n<p>if you show the first six decimals, and the next terms are yet smaller.</p>\n\n<hr>\n\n<p><em>Side remark</em>:</p>\n\n<p>It is much more efficient and more accurate to compute a term from the previous, using the recurrence</p>\n\n<pre><code>T*= Z/(N*(N-1))\n</code></pre>\n\n<p>where <code>Z= -X*X</code> (and this way, the alternating signs are automatically handled).</p>\n"}], "owner": {"reputation": 404, "user_id": 3744782, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/95a87b42f5d7006a956bad0548d39383?s=128&d=identicon&r=PG&f=1", "display_name": "onlyforthis", "link": "https://stackoverflow.com/users/3744782/onlyforthis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 324, "favorite_count": 0, "answer_count": 5, "score": -1, "last_activity_date": 1458293451, "creation_date": 1458142356, "question_id": 36040209, "link": "https://stackoverflow.com/questions/36040209/value-of-a-variable-not-changing-in-a-loop", "title": "Value of a variable not changing in a loop", "body": "<p>I have a function that calculates the sin() of a radian angle. It takes two parameters, the value of the angle in radian and the terms. Just to make everything clear, this is how sin() is calculated:</p>\n\n<pre><code>sin(x) = x - (1/3! * X^3) + (1/5! * X^5) - (1/7! * X^7) + (1/9! * X^9) - ...\n</code></pre>\n\n<p>This is the function that do this calculation:</p>\n\n<pre><code>double sinx(double theta, int terms) //Theta is the angle x in radian\n{\n  double result = 0;//this variable holds the value and it's updated with each term.\n  int i = 1;\n  int num = 3;\n\n      while(i &lt;= terms-1)\n  {\n           if(i % 2 != 0){\n                result = result - ( (1.0/factorial(num)) * pow(theta, num) );\n                printf(\"if\\n\");//this is just for debugging \n                }\n             else if(i % 2 == 0){\n                result = result + ( (1.0/factorial(num)) * pow(theta, num) );\n                printf(\"else if\\n\");//this is for debugging too\n                }\n        printf(\"%lf\\n\", result);//debugging also\n\n        num = num + 2;\n        i = i + 1;\n  }\n\n      return theta + result; //this calculates the final term\n}\n</code></pre>\n\n<p>The problem is the variable result's value doesn't change. Which also results in the final result not changing when using different number of terms. </p>\n\n<p>Those are some outputs I get:</p>\n\n<pre><code>//with theta = 0.2 and terms = 6 ;;\nif\n-0.001333   \nelse if\n-0.001331   \nif\n-0.001331   \nelse if\n-0.001331   \nif\n-0.001331   \nComputed Sin&lt;0.200000&gt; = 0.198669. //this is the returned value. It's printed in the main\n\n//with theta = 0.2 and terms = 7\nif\n-0.001333   \nelse if\n-0.001331   \nif\n-0.001331   \nelse if\n-0.001331   \nif\n-0.001331   \nelse if\n-0.001331   \nComputed Sin&lt;0.200000&gt; = 0.198669. \n</code></pre>\n\n<p>Any ideas?</p>\n"}, {"tags": ["c", "crash", "runtime"], "comments": [{"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 1, "creation_date": 1458143332, "post_id": 36040206, "comment_id": 59730080, "body": "1) <code>strcat</code> will request the <code>char*</code> to the argument. (<code>strncat(abc, &amp;letter, 1);</code> instead of. ) 2) <code>char abcString[NUM_ABC_LET] = &quot;&quot;;</code> --&gt; <code>char abcString[NUM_ABC_LET+1] = &quot;&quot;;</code> : +1 for null-terminate."}], "answers": [{"tags": [], "owner": {"reputation": 19358, "user_id": 3049655, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/ZLzeP.jpg?s=128&g=1", "display_name": "Spikatrix", "link": "https://stackoverflow.com/users/3049655/spikatrix"}, "is_accepted": true, "score": 1, "last_activity_date": 1458143347, "last_edit_date": 1495542691, "creation_date": 1458143021, "answer_id": 36040500, "question_id": 36040206, "link": "https://stackoverflow.com/questions/36040206/i-have-a-runtime-error-in-my-code-that-i-need-to-analyse/36040500#36040500", "title": "i have a runtime error in my code that i need to analyse", "body": "<p>You need to reserve space for 26 alphabets + 1 for the NUL-terminator(<code>'\\0'</code>).</p>\n\n<p>So change</p>\n\n<pre><code>char abcString[NUM_ABC_LET] = \"\";\n</code></pre>\n\n<p>to</p>\n\n<pre><code>char abcString[NUM_ABC_LET + 1] = \"\";\n</code></pre>\n\n<p>and NUL-terminate it just after the loop in <code>makeABC</code> by using</p>\n\n<pre><code>abc[NUM_ABC_LET] = '\\0';\n</code></pre>\n\n<hr>\n\n<p>Also, as <a href=\"https://stackoverflow.com/users/971127/bluepixy\">@BLUEPIXY</a> <a href=\"https://stackoverflow.com/questions/36040206/i-have-a-runtime-error-in-my-code-that-i-need-to-analyse/36040500#comment59730080_36040206\">has mentioned in the comments</a>, <code>strcat</code> requires both its arguments to be strings(<code>char*</code>), but you pass a <code>char*</code> and a <code>char</code> and this causes things to mess up as it invokes Undefined Behavior. So, replace</p>\n\n<pre><code>strcat(abc, letter);\n</code></pre>\n\n<p>with something like</p>\n\n<pre><code>abc[letter - 'a'] = letter;\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 5767659, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/40090ee51647de0dc22227f34f04e46d?s=128&d=identicon&r=PG&f=1", "display_name": "The baron", "link": "https://stackoverflow.com/users/5767659/the-baron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 15, "favorite_count": 0, "accepted_answer_id": 36040500, "answer_count": 1, "score": 0, "last_activity_date": 1458143347, "creation_date": 1458142347, "question_id": 36040206, "link": "https://stackoverflow.com/questions/36040206/i-have-a-runtime-error-in-my-code-that-i-need-to-analyse", "title": "i have a runtime error in my code that i need to analyse", "body": "<p>i'm learning c and i got a analyse question...\ni got this code: </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\n#define NUM_ABC_LET 26\nvoid makeABC(char abc[NUM_ABC_LET]);\n\nint main()\n{\n   char abcString[NUM_ABC_LET] = \"\";\n   makeABC(abcString);\n   puts(abcString);\n   return (0);\n}\n\nvoid makeABC(char abc[NUM_ABC_LET])\n{\n    char letter;\n    for(letter = 'a'; letter &lt;= 'z'; letter++)\n    {\n        strcat(abc, letter);\n    }\n}\n</code></pre>\n\n<p>can any one tell me why will it crash all the time? and what problems it has?</p>\n"}, {"tags": ["c", "visual-studio"], "comments": [{"owner": {"reputation": 8687, "user_id": 325117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f0766debb859466aed4b305cc915d8e?s=128&d=identicon&r=PG", "display_name": "Martin Broadhurst", "link": "https://stackoverflow.com/users/325117/martin-broadhurst"}, "edited": false, "score": 0, "creation_date": 1458144920, "post_id": 36039807, "comment_id": 59731302, "body": "Your &quot;Full Code&quot; doesn&#39;t cause the error, does it? It&#39;s the code under 2) that does."}, {"owner": {"reputation": 167, "user_id": 5056376, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f04035581eb0d0f4c8710dd4b480a913?s=128&d=identicon&r=PG&f=1", "display_name": "mintbox", "link": "https://stackoverflow.com/users/5056376/mintbox"}, "reply_to_user": {"reputation": 8687, "user_id": 325117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f0766debb859466aed4b305cc915d8e?s=128&d=identicon&r=PG", "display_name": "Martin Broadhurst", "link": "https://stackoverflow.com/users/325117/martin-broadhurst"}, "edited": false, "score": 0, "creation_date": 1458145092, "post_id": 36039807, "comment_id": 59731448, "body": "Both of them causes an error sir"}, {"owner": {"reputation": 8687, "user_id": 325117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f0766debb859466aed4b305cc915d8e?s=128&d=identicon&r=PG", "display_name": "Martin Broadhurst", "link": "https://stackoverflow.com/users/325117/martin-broadhurst"}, "edited": false, "score": 0, "creation_date": 1458145155, "post_id": 36039807, "comment_id": 59731488, "body": "None of the code you&#39;ve published will produce the &quot;cannot convert from &#39;player *&#39; to &#39;record::tagField&#39;&quot; error."}, {"owner": {"reputation": 8687, "user_id": 325117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f0766debb859466aed4b305cc915d8e?s=128&d=identicon&r=PG", "display_name": "Martin Broadhurst", "link": "https://stackoverflow.com/users/325117/martin-broadhurst"}, "edited": false, "score": 0, "creation_date": 1458145300, "post_id": 36039807, "comment_id": 59731584, "body": "Neither will it produce the &quot;&quot;BATTER&quot; is undefined&quot; error. You&#39;ll need to post some code that does produce the errors you&#39;re describing."}, {"owner": {"reputation": 7273, "user_id": 2193968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1beed39f2b04409ff584a0af1d59325c?s=128&d=identicon&r=PG", "display_name": "Jerry Jeremiah", "link": "https://stackoverflow.com/users/2193968/jerry-jeremiah"}, "reply_to_user": {"reputation": 8687, "user_id": 325117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f0766debb859466aed4b305cc915d8e?s=128&d=identicon&r=PG", "display_name": "Martin Broadhurst", "link": "https://stackoverflow.com/users/325117/martin-broadhurst"}, "edited": false, "score": 0, "creation_date": 1458160338, "post_id": 36039807, "comment_id": 59741233, "body": "@MartinBroadhurst when I paste the code into ideone I get this: <code>prog.cpp: In function &#39;int main()&#39;: prog.cpp:95:43: error: &#39;BATTER&#39; was not declared in this scope          batter[i].recordInfo.playerType = BATTER;  &#47;&#47; @@@@ERROR HERE                                            ^ prog.cpp:109:44: error: &#39;PITCHER&#39; was not declared in this scope          pitcher[i].recordInfo.playerType = PITCHER; &#47;&#47;@ERROR HERE TOO                                             ^</code>"}, {"owner": {"reputation": 7273, "user_id": 2193968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1beed39f2b04409ff584a0af1d59325c?s=128&d=identicon&r=PG", "display_name": "Jerry Jeremiah", "link": "https://stackoverflow.com/users/2193968/jerry-jeremiah"}, "edited": false, "score": 1, "creation_date": 1458160564, "post_id": 36039807, "comment_id": 59741364, "body": "@mintbox if you use <code>record::BATTER</code> instead of <code>BATTER</code> and <code>record::PITCHER</code> instead of <code>PITCHER</code> it fixes #2"}, {"owner": {"reputation": 8687, "user_id": 325117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f0766debb859466aed4b305cc915d8e?s=128&d=identicon&r=PG", "display_name": "Martin Broadhurst", "link": "https://stackoverflow.com/users/325117/martin-broadhurst"}, "edited": false, "score": 0, "creation_date": 1458160676, "post_id": 36039807, "comment_id": 59741429, "body": "You&#39;re compiling it as C++. You should be compiling it as C."}], "owner": {"reputation": 167, "user_id": 5056376, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f04035581eb0d0f4c8710dd4b480a913?s=128&d=identicon&r=PG&f=1", "display_name": "mintbox", "link": "https://stackoverflow.com/users/5056376/mintbox"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 207, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1458145761, "creation_date": 1458141400, "last_edit_date": 1458145761, "question_id": 36039807, "link": "https://stackoverflow.com/questions/36039807/visual-studio-cannot-convert-from", "title": "visual studio cannot convert from", "body": "<p>I am getting an error on my visual studio:</p>\n\n<p>Error   C2440   '=': cannot convert from 'player *' to 'record::tagField'   </p>\n\n<p>However, it works fine on Xcode.</p>\n\n<p>So my questions are : </p>\n\n<p>1 : ) Why isn't this working on Visual Studio?</p>\n\n<p>2 : ) I tried to code as following :</p>\n\n<pre><code>    batter.recordInfo.playerType = BATTER;\n</code></pre>\n\n<p>however, it states \"BATTER\" is undefined. How will i change the scope of it?</p>\n\n<p>Full Code : </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;malloc.h&gt;\n\n\ntypedef struct record\n{\n    enum tagField { PITCHER, BATTER } playerType;\n    union\n    {\n        float ERA;\n        float BA;\n    }u;\n}record;\n\n\ntypedef struct player\n{\n    char name[32];\n    int count;\n    int backNumber;\n    record recordInfo;\n} player;\n\n\nvoid sortBatter(player a[], const int size)\n{\n    int i, j;\n    for (i = 0; i &lt; size; i++)\n    {\n        float min = a[i].recordInfo.u.BA;\n        int subscript = i;\n        for (j = i + 1; j &lt; size; j++)\n        {\n            if (a[j].recordInfo.u.BA &lt; min)\n            {\n                min = a[j].recordInfo.u.BA;\n                subscript = j;\n            }\n        }\n        player temp = a[i];\n        a[i] = a[subscript];\n        a[subscript] = temp;\n    }\n}\n\nvoid sortPitcher(player a[], const int size)\n{\n    int i, j;\n    for (i = 0; i &lt; size; i++)\n    {\n        float min = a[i].recordInfo.u.ERA;\n        int subscript = i;\n        for (j = i + 1; j &lt; size; j++)\n        {\n            if (a[j].recordInfo.u.ERA &lt; min)\n            {\n                min = a[j].recordInfo.u.ERA;\n                subscript = j;\n            }\n        }\n        player temp = a[i];\n        a[i] = a[subscript];\n        a[subscript] = temp;\n    }\n}\n\nint main()\n{\n    int batterSize = 5;\n    int pitcherSize = 5;\n\n\n    printf(\"Please input batter size : \\n\");\n    scanf(\"%d\", &amp;batterSize);\n    printf(\"Please input pitcher size : \\n\");\n    scanf(\"%d\", &amp;pitcherSize);\n\n\n    player * batter = (player *)malloc(batterSize*sizeof(player));\n    player * pitcher = (player *)malloc(pitcherSize*sizeof(player));\n\n\n\n    int i;\n    for (i = 0; i &lt; batterSize; i++)\n    {\n        printf(\"Please input batter %d name : \\n\", i + 1);\n        scanf(\"%s\", batter[i].name);\n        printf(\"Please input batter %d count : \\n\", i + 1);\n        scanf(\"%d\", &amp;(batter[i].count));\n        printf(\"Please input batter %d backNumber : \\n\", i + 1);\n        scanf(\"%d\", &amp;(batter[i].backNumber));\n        printf(\"Please input batter %d BA : \\n\", i + 1);\n        batter[i].recordInfo.playerType = BATTER;  // @@@@ERROR HERE\n\n        scanf(\"%f\", &amp;(batter[i].recordInfo.u.BA));\n    }\n\n    for (i = 0; i &lt; pitcherSize; i++)\n    {\n        printf(\"Please input pitcher %d name  : \\n\", i + 1);\n        scanf(\"%s\", pitcher[i].name);\n        printf(\"Please input pitcher %d count  : \\n\", i + 1);\n        scanf(\"%d\", &amp;(pitcher[i].count));\n        printf(\"Please input pitcher %d backNumber  : \\n\", i + 1);\n        scanf(\"%d\", &amp;(pitcher[i].backNumber));\n        printf(\"Please input pitcher %d ERA : \\n\", i + 1);\n        pitcher[i].recordInfo.playerType = PITCHER; //@ERROR HERE TOO\n        scanf(\"%f\", &amp;(pitcher[i].recordInfo.u.ERA));\n    }\n\n\n    sortPitcher(pitcher, pitcherSize);\n    sortBatter(batter, batterSize);\n\n\n\n    printf(\"Best Batter : \");\n    float previous1 = batter[0].recordInfo.u.BA;\n    for (i = 0; i &lt; batterSize; i++)\n    {\n        if (batter[i].recordInfo.u.BA != previous1)\n        {\n            break;\n        }\n        printf(\"\\n\\tName : %s , BA : %.2f\", batter[i].name, batter[i].recordInfo.u.BA);\n    }\n\n    printf(\"\\nBest Pitcher : \");\n    float previous2 = pitcher[0].recordInfo.u.ERA;\n    for (i = 0; i &lt; pitcherSize; i++)\n    {\n        if (pitcher[i].recordInfo.u.ERA != previous2)\n        {\n            break;\n        }\n        printf(\"\\n\\tName : %s , ERA : %.2f\", pitcher[i].name, pitcher[i].recordInfo.u.ERA);\n    }\n\n    printf(\"\\n\");\n\n}\n</code></pre>\n"}, {"tags": ["c", "static-libraries"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1458140704, "post_id": 36039459, "comment_id": 59728023, "body": "No, not always. Usually the <code>-l</code> goes for dynamic linking of <code>.so</code> files."}, {"owner": {"reputation": 2971, "user_id": 4975646, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-XzXhmdjjKB0/AAAAAAAAAAI/AAAAAAAAAeg/9rsygRfbVyk/photo.jpg?sz=128", "display_name": "callyalater", "link": "https://stackoverflow.com/users/4975646/callyalater"}, "edited": false, "score": 1, "creation_date": 1458140738, "post_id": 36039459, "comment_id": 59728048, "body": "Linking is different from header file inclusion. (<code>#include &lt;stdio.h&gt;</code> is not a linking command/statement.)"}, {"owner": {"reputation": 6675, "user_id": 854742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dc3befe29d589c7c34fd1600affc041?s=128&d=identicon&r=PG", "display_name": "Carey Gregory", "link": "https://stackoverflow.com/users/854742/carey-gregory"}, "edited": false, "score": 0, "creation_date": 1458140740, "post_id": 36039459, "comment_id": 59728049, "body": "No, static vs. dynamic linking are options you choose."}, {"owner": {"reputation": 2151, "user_id": 4089452, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/ff06d18979a4020538af1ebecbbea27b?s=128&d=identicon&r=PG&f=1", "display_name": "Alessandro Power", "link": "https://stackoverflow.com/users/4089452/alessandro-power"}, "reply_to_user": {"reputation": 2971, "user_id": 4975646, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-XzXhmdjjKB0/AAAAAAAAAAI/AAAAAAAAAeg/9rsygRfbVyk/photo.jpg?sz=128", "display_name": "callyalater", "link": "https://stackoverflow.com/users/4975646/callyalater"}, "edited": false, "score": 0, "creation_date": 1458141103, "post_id": 36039459, "comment_id": 59728338, "body": "@callyalater Doesn&#39;t <code>#include</code> essentially copy and paste the library into the source file? Maybe I&#39;m being dense but I cannot see how that wouldn&#39;t statically link the library."}, {"owner": {"reputation": 2971, "user_id": 4975646, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-XzXhmdjjKB0/AAAAAAAAAAI/AAAAAAAAAeg/9rsygRfbVyk/photo.jpg?sz=128", "display_name": "callyalater", "link": "https://stackoverflow.com/users/4975646/callyalater"}, "edited": false, "score": 0, "creation_date": 1458141338, "post_id": 36039459, "comment_id": 59728522, "body": "<code>#include</code> copies the <i>file contents</i> to the source file, but if the header is nothing more than function declarations, all that would do is tell the program that those functions are available to be called in your code. The actual implementation may be defined in another file that would need to be linked in (either statically or dynamically) to your executable. If you look at the header for <a href=\"https://www.gnu.org/software/m68hc11/examples/stdio_8h-source.html\" rel=\"nofollow noreferrer\"><code>stdio.h</code></a> you would see that it only contains function prototypes."}, {"owner": {"reputation": 2151, "user_id": 4089452, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/ff06d18979a4020538af1ebecbbea27b?s=128&d=identicon&r=PG&f=1", "display_name": "Alessandro Power", "link": "https://stackoverflow.com/users/4089452/alessandro-power"}, "reply_to_user": {"reputation": 2971, "user_id": 4975646, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-XzXhmdjjKB0/AAAAAAAAAAI/AAAAAAAAAeg/9rsygRfbVyk/photo.jpg?sz=128", "display_name": "callyalater", "link": "https://stackoverflow.com/users/4975646/callyalater"}, "edited": false, "score": 0, "creation_date": 1458141457, "post_id": 36039459, "comment_id": 59728624, "body": "@callyalater Okay that makes sense. I&#39;ll accept that explanation if you include it as an answer."}], "answers": [{"comments": [{"owner": {"reputation": 2151, "user_id": 4089452, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/ff06d18979a4020538af1ebecbbea27b?s=128&d=identicon&r=PG&f=1", "display_name": "Alessandro Power", "link": "https://stackoverflow.com/users/4089452/alessandro-power"}, "edited": false, "score": 0, "creation_date": 1458141731, "post_id": 36039899, "comment_id": 59728833, "body": "Thanks. Final question: I have a project which uses some Boost libraries. Is there a way I can tell if those libraries were statically or dynamically linked?"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 2151, "user_id": 4089452, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/ff06d18979a4020538af1ebecbbea27b?s=128&d=identicon&r=PG&f=1", "display_name": "Alessandro Power", "link": "https://stackoverflow.com/users/4089452/alessandro-power"}, "edited": false, "score": 1, "creation_date": 1458141825, "post_id": 36039899, "comment_id": 59728904, "body": "@AlessandroPower: If you&#39;re on a Unix-like system, run <code>ldd</code> on the executable."}, {"owner": {"reputation": 3483, "user_id": 3932569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bca364f93a9dfab17419b31a8a1a504?s=128&d=identicon&r=PG&f=1", "display_name": "Garf365", "link": "https://stackoverflow.com/users/3932569/garf365"}, "reply_to_user": {"reputation": 2151, "user_id": 4089452, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/ff06d18979a4020538af1ebecbbea27b?s=128&d=identicon&r=PG&f=1", "display_name": "Alessandro Power", "link": "https://stackoverflow.com/users/4089452/alessandro-power"}, "edited": false, "score": 0, "creation_date": 1458142043, "post_id": 36039899, "comment_id": 59729070, "body": "@AlessandroPower <code>boost</code> are header only library (expect some specific parts). So, there is no need of linkage for most part of boost"}, {"owner": {"reputation": 2971, "user_id": 4975646, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-XzXhmdjjKB0/AAAAAAAAAAI/AAAAAAAAAeg/9rsygRfbVyk/photo.jpg?sz=128", "display_name": "callyalater", "link": "https://stackoverflow.com/users/4975646/callyalater"}, "edited": false, "score": 1, "creation_date": 1458142044, "post_id": 36039899, "comment_id": 59729071, "body": "Most boost libraries are intended for C++ use. Because they tend to use templates for their classes and functions, they are &quot;header-only&quot; libraries that only require you to include the <code>boost_header_file.hpp</code> file in your code. Some libraries (like <code>regex</code>, <code>filesystems</code>, and <code>boost_threads</code>) require precompilation as a library before use, but you can compile them as either static or dynamic libraries (I have done both) and link them accordingly."}, {"owner": {"reputation": 2971, "user_id": 4975646, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-XzXhmdjjKB0/AAAAAAAAAAI/AAAAAAAAAeg/9rsygRfbVyk/photo.jpg?sz=128", "display_name": "callyalater", "link": "https://stackoverflow.com/users/4975646/callyalater"}, "edited": false, "score": 0, "creation_date": 1458142168, "post_id": 36039899, "comment_id": 59729178, "body": "You can read more about which libraries require precompilation on the <a href=\"http://www.boost.org/doc/libs/1_60_0/more/getting_started/unix-variants.html#header-only-libraries\" rel=\"nofollow noreferrer\">Boost official website</a>."}], "tags": [], "owner": {"reputation": 2971, "user_id": 4975646, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-XzXhmdjjKB0/AAAAAAAAAAI/AAAAAAAAAeg/9rsygRfbVyk/photo.jpg?sz=128", "display_name": "callyalater", "link": "https://stackoverflow.com/users/4975646/callyalater"}, "is_accepted": true, "score": 4, "last_activity_date": 1458141606, "creation_date": 1458141606, "answer_id": 36039899, "question_id": 36039459, "link": "https://stackoverflow.com/questions/36039459/are-libraries-in-c-statically-linked/36039899#36039899", "title": "Are libraries in C statically linked?", "body": "<p><code>#include</code> copies the <em>file contents</em> to the source file, but if the header is nothing more than function declarations, all that would do is tell the program that those functions are available to be called in your code. The actual implementation may be defined in another file that would need to be linked in (either statically or dynamically) to your executable. If you look at the header for <a href=\"https://www.gnu.org/software/m68hc11/examples/stdio_8h-source.html\" rel=\"nofollow\"><code>stdio.h</code></a> you would see that it only contains function prototypes.</p>\n\n<p>Many compilers provide options to do either static or dynamic linking for the standard libraries.</p>\n"}], "owner": {"reputation": 2151, "user_id": 4089452, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/ff06d18979a4020538af1ebecbbea27b?s=128&d=identicon&r=PG&f=1", "display_name": "Alessandro Power", "link": "https://stackoverflow.com/users/4089452/alessandro-power"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 303, "favorite_count": 1, "accepted_answer_id": 36039899, "answer_count": 1, "score": 1, "last_activity_date": 1458161210, "creation_date": 1458140608, "last_edit_date": 1495541270, "question_id": 36039459, "link": "https://stackoverflow.com/questions/36039459/are-libraries-in-c-statically-linked", "title": "Are libraries in C statically linked?", "body": "<p>I'm starting to program in Rust and one of the first things I noticed is that Rust produces large binaries. For example, Rust's \"Hello world!\" binary is ~600K large, while the equivalent C binary is ~8K large.</p>\n\n<p>After some searching I found <a href=\"https://stackoverflow.com/questions/29008127/why-are-rust-executables-so-huge\" title=\"this\">this</a> SO post which explains that Rust binaries are large because all the needed libraries are statically linked. But isn't that the case for C as well? When I write <code>#include &lt;stdio.h&gt;</code> in C, aren't I statically linking the relevant I/O libraries as well? I have always assumed that answer is 'yes' but now I am doubting myself.</p>\n"}, {"tags": ["c", "linux", "process", "ps"], "comments": [{"owner": {"reputation": 906, "user_id": 144488, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WiCn3.jpg?s=128&g=1", "display_name": "nzc", "link": "https://stackoverflow.com/users/144488/nzc"}, "edited": false, "score": 0, "creation_date": 1458140756, "post_id": 36039351, "comment_id": 59728063, "body": "Why do you want to do this?"}, {"owner": {"reputation": 1316, "user_id": 2304212, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/217cbdae046a33da5633c7982463104c?s=128&d=identicon&r=PG", "display_name": "PepeHands", "link": "https://stackoverflow.com/users/2304212/pepehands"}, "reply_to_user": {"reputation": 906, "user_id": 144488, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WiCn3.jpg?s=128&g=1", "display_name": "nzc", "link": "https://stackoverflow.com/users/144488/nzc"}, "edited": false, "score": 1, "creation_date": 1458140943, "post_id": 36039351, "comment_id": 59728213, "body": "@nzc there is such thing as <code>criu</code> (see criu.org or <a href=\"https://github.com/xemul/criu\" rel=\"nofollow noreferrer\">github.com/xemul/criu</a>) I want to add feature <code>--leave-stopped</code> in <code>criu restore</code> (it&#39;s currently only available with <code>criu dump</code>)"}, {"owner": {"reputation": 906, "user_id": 144488, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WiCn3.jpg?s=128&g=1", "display_name": "nzc", "link": "https://stackoverflow.com/users/144488/nzc"}, "edited": false, "score": 0, "creation_date": 1458141374, "post_id": 36039351, "comment_id": 59728553, "body": "I think you might get better results if you include some of those details in your question.  I think (but am not certain) that part of the issue is that you may be using job control signals in ways they weren&#39;t intended to be used.  Including the context for why you want to use them might help someone who does know, to explain why and perhaps suggest the correct approach."}], "answers": [{"comments": [{"owner": {"reputation": 1316, "user_id": 2304212, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/217cbdae046a33da5633c7982463104c?s=128&d=identicon&r=PG", "display_name": "PepeHands", "link": "https://stackoverflow.com/users/2304212/pepehands"}, "edited": false, "score": 0, "creation_date": 1458141892, "post_id": 36039570, "comment_id": 59728958, "body": "Actually I don&#39;t understand how could <code>SIGTSTP</code>, <code>SIGTTIN</code> or <code>SIGTTOU</code> occur here. In document you provided writen &quot;When a process group becomes an orphan, its processes are sent a SIGHUP signal&quot;. Does this signal cause the termination of my child program? If yes, why this signal does not terminate my program in case it&#39;s not stopped?"}, {"owner": {"reputation": 906, "user_id": 144488, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WiCn3.jpg?s=128&g=1", "display_name": "nzc", "link": "https://stackoverflow.com/users/144488/nzc"}, "reply_to_user": {"reputation": 1316, "user_id": 2304212, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/217cbdae046a33da5633c7982463104c?s=128&d=identicon&r=PG", "display_name": "PepeHands", "link": "https://stackoverflow.com/users/2304212/pepehands"}, "edited": false, "score": 1, "creation_date": 1458246533, "post_id": 36039570, "comment_id": 59788255, "body": "I think the real reason here is, &quot;stopped&quot; is a state that has meaning only if the process has &quot;job control&quot;, because then it can later be restarted.  I think that when the process loses job control, the system sends it a SIGHUP because otherwise it would just be stopped forever.  See the last line &quot;... this avoids the problem of many stopped, orphaned processes lying around the system.&quot;"}, {"owner": {"reputation": 906, "user_id": 144488, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WiCn3.jpg?s=128&g=1", "display_name": "nzc", "link": "https://stackoverflow.com/users/144488/nzc"}, "reply_to_user": {"reputation": 1316, "user_id": 2304212, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/217cbdae046a33da5633c7982463104c?s=128&d=identicon&r=PG", "display_name": "PepeHands", "link": "https://stackoverflow.com/users/2304212/pepehands"}, "edited": false, "score": 0, "creation_date": 1458739916, "post_id": 36039570, "comment_id": 59994236, "body": "Also, re-reading your comment, there is no &quot;SIGHUP&quot; sent when your process is not stopped.  The SIGHUP is sent because your process <i>is</i> stopped when it becomes an orphaned process."}], "tags": [], "owner": {"reputation": 906, "user_id": 144488, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WiCn3.jpg?s=128&g=1", "display_name": "nzc", "link": "https://stackoverflow.com/users/144488/nzc"}, "is_accepted": true, "score": 3, "last_activity_date": 1458141214, "last_edit_date": 1495542251, "creation_date": 1458140839, "answer_id": 36039570, "question_id": 36039351, "link": "https://stackoverflow.com/questions/36039351/re-parenting-stopped-process/36039570#36039570", "title": "re-parenting stopped process", "body": "<p>From <a href=\"http://www.gnu.org/software/libc/manual/html_node/Job-Control-Signals.html\" rel=\"nofollow noreferrer\">http://www.gnu.org/software/libc/manual/html_node/Job-Control-Signals.html</a></p>\n\n<blockquote>\n  <p>When a process in an orphaned process group (see Orphaned Process\n  Groups) receives a SIGTSTP, SIGTTIN, or SIGTTOU signal and does not\n  handle it, the process does not stop. Stopping the process would\n  probably not be very useful, since there is no shell program that will\n  notice it stop and allow the user to continue it. What happens instead\n  depends on the operating system you are using. Some systems may do\n  nothing; others may deliver another signal instead, such as SIGKILL or\n  SIGHUP. On GNU/Hurd systems, the process dies with SIGKILL; this\n  avoids the problem of many stopped, orphaned processes lying around\n  the system.</p>\n</blockquote>\n\n<p>See also:  <a href=\"https://stackoverflow.com/questions/11886812/whats-the-difference-between-sigstop-and-sigtstp\">What&#39;s the difference between SIGSTOP and SIGTSTP?</a></p>\n"}], "owner": {"reputation": 1316, "user_id": 2304212, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/217cbdae046a33da5633c7982463104c?s=128&d=identicon&r=PG", "display_name": "PepeHands", "link": "https://stackoverflow.com/users/2304212/pepehands"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 36039570, "answer_count": 1, "score": 4, "last_activity_date": 1458141214, "creation_date": 1458140394, "question_id": 36039351, "link": "https://stackoverflow.com/questions/36039351/re-parenting-stopped-process", "title": "re-parenting stopped process", "body": "<p>How does re-parenting of stopped process heppens? Why does stopped process just terminates after re-parenting?</p>\n\n<p>More precisely, suppose I have a code like this</p>\n\n<pre><code>#include &lt;sys/types.h&gt;\n#include &lt;sys/wait.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/user.h&gt; \n#include &lt;sys/syscall.h&gt;\n#include &lt;stdio.h&gt;\n\n\nint main(void) {\n    pid_t child;\n\n    child = fork();\n\n    if (child == 0) {\n        int t = 0;\n        while (true) {\n            printf(\"%d. I'm %d, my parent is %d\\n\", t++, getpid(), getppid());\n            sleep(1);\n        }\n    } else {\n        printf(\"I'm the parent. My pid is %d\\n\", getpid());\n        printf(\"Starting to wait for 30 seconds\\n\");\n        sleep(30);\n        printf(\"Done waiting, aborting\\n\");\n    }\n}\n</code></pre>\n\n<p>When I run this code the child process works and parent process just sleeps. After 30 seconds passed the parent process terminates and the child process now becomes a child of <code>init</code> and just continues running. Everything is normal.</p>\n\n<p>But if I run this code and in first 30 seconds of it's execution I also run</p>\n\n<p><code>kill -SIGSTOP &lt;child_pid&gt;</code></p>\n\n<p>Then the child process stops (<code>T</code> state in <code>ps xaf</code>) and the parent process sleeps. After 30 second passed the parent process returns from sleep and just terminates (as it reached the end of <code>main</code>) but the child process instead of being re-parented to <code>init</code> in stopped state just terminates. I don't see it in <code>ps xaf</code> and if run <code>lastcomm</code> I see this output:</p>\n\n<pre><code>a.out             F  X equi     pts/5      0.00 secs Wed Mar 16 17:44\n</code></pre>\n\n<p>Why is this happening that stopped process dies after re-parenting? Is it possible in linux to re-parrent stopped process?</p>\n"}, {"tags": ["c", "math", "trigonometry", "operations"], "comments": [{"owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 0, "creation_date": 1458140690, "post_id": 36039236, "comment_id": 59728013, "body": "this might help a bit : <code>double pi = acos(-1);</code>"}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1458140763, "post_id": 36039236, "comment_id": 59728069, "body": "If your degree-values have many decimal places, then yes, calculating pi*degrees/180 might lose precision. OTOH, it can&#39;t be exact anyway, I tend to believe that you won&#39;t be in trouble because of that."}, {"owner": {"reputation": 35, "user_id": 5977887, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/7fZ7P.jpg?s=128&g=1", "display_name": "Carl Chester Ragudo", "link": "https://stackoverflow.com/users/5977887/carl-chester-ragudo"}, "edited": false, "score": 0, "creation_date": 1458141923, "post_id": 36039236, "comment_id": 59728984, "body": "I don&#39;t actually need the exact values. The angles I will use are just 0, 90, 180, and 270 thus only need 0,1, and -1 as answers."}], "answers": [{"tags": [], "owner": {"reputation": 46684, "user_id": 1527, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/2180b1a962bf46e58fa9746cb4ebfb91?s=128&d=identicon&r=PG", "display_name": "Pete Kirkham", "link": "https://stackoverflow.com/users/1527/pete-kirkham"}, "is_accepted": true, "score": 1, "last_activity_date": 1458140462, "creation_date": 1458140462, "answer_id": 36039383, "question_id": 36039236, "link": "https://stackoverflow.com/questions/36039236/conversion-of-degrees-to-radians-for-use-in-trig-functions-in-c/36039383#36039383", "title": "Conversion of Degrees to Radians for use in trig functions in C", "body": "<p>They probably will affect the accuracy by the precision to which you have pi - usually one unit in the last place.  For cos and sin, |d f(x)/dx| is less than one so your value should be within the same error. For tan, |d f(x)/dx| is not bounded so a small input change can create a large change of output.</p>\n\n<p>Whether such small changes will affect the operation of your code depends largely on whether your code assumes than the results are exact or not. If your code makes faulty assumptions about floating point values, then it will fail, if it allows some small tolerance on equality comparisons, then it wont.</p>\n"}, {"comments": [{"owner": {"reputation": 35, "user_id": 5977887, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/7fZ7P.jpg?s=128&g=1", "display_name": "Carl Chester Ragudo", "link": "https://stackoverflow.com/users/5977887/carl-chester-ragudo"}, "edited": false, "score": 0, "creation_date": 1458144071, "post_id": 36039743, "comment_id": 59730661, "body": "My concern is if it will yield answers like 0.9999.. and if I use the value in a condition it may not work. i.e. cos(pi) = -0.9999 != -1."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 35, "user_id": 5977887, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/7fZ7P.jpg?s=128&g=1", "display_name": "Carl Chester Ragudo", "link": "https://stackoverflow.com/users/5977887/carl-chester-ragudo"}, "edited": false, "score": 0, "creation_date": 1458145125, "post_id": 36039743, "comment_id": 59731471, "body": "@Carl Chester Ragudo How does your code generate values near pi?"}, {"owner": {"reputation": 35, "user_id": 5977887, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/7fZ7P.jpg?s=128&g=1", "display_name": "Carl Chester Ragudo", "link": "https://stackoverflow.com/users/5977887/carl-chester-ragudo"}, "edited": false, "score": 0, "creation_date": 1458145545, "post_id": 36039743, "comment_id": 59731784, "body": "I used #define pi 3.1415926535897932"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 35, "user_id": 5977887, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/7fZ7P.jpg?s=128&g=1", "display_name": "Carl Chester Ragudo", "link": "https://stackoverflow.com/users/5977887/carl-chester-ragudo"}, "edited": false, "score": 0, "creation_date": 1458150754, "post_id": 36039743, "comment_id": 59735456, "body": "@Carl Chester Ragudo Cursios, using <code>cos(3.1415926535897932)</code>, did code return non - <code>-1</code>, or are you just concerned it <i>might</i>."}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 1, "last_activity_date": 1458141229, "last_edit_date": 1495535344, "creation_date": 1458141229, "answer_id": 36039743, "question_id": 36039236, "link": "https://stackoverflow.com/questions/36039236/conversion-of-degrees-to-radians-for-use-in-trig-functions-in-c/36039743#36039743", "title": "Conversion of Degrees to Radians for use in trig functions in C", "body": "<blockquote>\n  <p>Will this affect the operations on my code?</p>\n</blockquote>\n\n<p>When conversion is <em>exact</em> between degree/radians, not a problem.  Of course this only happens when the angle is +/- 0.0.</p>\n\n<p>To use trig function and get <em>exact</em> trig function result (or at least nearly as good as one can get) with degree arguments, insure the degree argument is reduced (<code>mod 360</code>) first and then converted to radians.  Further improvements can be had using trig identities: <a href=\"https://stackoverflow.com/a/33469683/2410359\">high precession</a> and <a href=\"https://stackoverflow.com/questions/31502120/c-sin-and-cos/31525208#31525208\">Sin and Cos</a></p>\n"}], "owner": {"reputation": 35, "user_id": 5977887, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/7fZ7P.jpg?s=128&g=1", "display_name": "Carl Chester Ragudo", "link": "https://stackoverflow.com/users/5977887/carl-chester-ragudo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 495, "favorite_count": 0, "accepted_answer_id": 36039383, "answer_count": 2, "score": 1, "last_activity_date": 1458146499, "creation_date": 1458140136, "last_edit_date": 1458146499, "question_id": 36039236, "link": "https://stackoverflow.com/questions/36039236/conversion-of-degrees-to-radians-for-use-in-trig-functions-in-c", "title": "Conversion of Degrees to Radians for use in trig functions in C", "body": "<p>I want to use the trigonometric functions of math.h to use 0,1,-1 as sign identifiers for a plane coordinate system. </p>\n\n<pre><code>cos(pi)*length = -1*length\nsin(pi)*length = 0\n</code></pre>\n\n<p>But the functions in math.h requires radian values while I have degree values. Although these can be converted in the formulas I don't know it it will affect the accuracy of the answers i.e. cos(pi) = -0.99999.. </p>\n\n<p>Will this affect the operations on my code?</p>\n\n<p>EDIT: What can I do to get my desired results?</p>\n"}, {"tags": ["c", "floating-point", "c99", "ieee-754"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1458139556, "post_id": 36038858, "comment_id": 59727101, "body": "I&#39;d suspect that depends on the implementation and the actual environment."}, {"owner": {"reputation": 75299, "user_id": 139746, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/BhJLC.png?s=128&g=1", "display_name": "Pascal Cuoq", "link": "https://stackoverflow.com/users/139746/pascal-cuoq"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1458139857, "post_id": 36038858, "comment_id": 59727347, "body": "@Olaf I have updated the question with the information that this is for a platform with IEEE 754 double-precision and FLT_EVAL_METHOD=0."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1458140176, "post_id": 36038858, "comment_id": 59727605, "body": "That does not help much. &quot;Implementation&quot; is the compiler and &quot;Environment&quot; the target platform/architecture. To show the extremes: There mit be no FPU available or the whole function can result in a single FPU instruction."}, {"owner": {"reputation": 75299, "user_id": 139746, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/BhJLC.png?s=128&g=1", "display_name": "Pascal Cuoq", "link": "https://stackoverflow.com/users/139746/pascal-cuoq"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1458140414, "post_id": 36038858, "comment_id": 59727798, "body": "@Olaf Anyone who prefers to benchmark their solution can use a Haswell processor and GCC 5.3.0. I was hoping for something that&#39;s so obviously a gain for such a wide class of platforms that it doesn&#39;t need to be benchmarked, like the original \u201ccompute mult_rd(x, y) as -mult_ru(-x, y)\u201d trick."}], "answers": [{"comments": [{"owner": {"reputation": 75299, "user_id": 139746, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/BhJLC.png?s=128&g=1", "display_name": "Pascal Cuoq", "link": "https://stackoverflow.com/users/139746/pascal-cuoq"}, "edited": false, "score": 0, "creation_date": 1458142962, "post_id": 36040272, "comment_id": 59729800, "body": "Right, at the time I was wondering about the accuracy of the FMA I had forgotten about being in RU mode. Being in RU mode means that it would do the right thing even if the error could be smaller than the smallest subnormal number. (Also I still think that the real result of (candidate * candidate - l) cannot get close to the smallest denormal number. In your illustrative formula, if eps^2 is way beyond the resolution of subnormals, 1 + eps is just 1.)"}], "tags": [], "owner": {"reputation": 47569, "user_id": 3255455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5993e7ece129141878cd6419d39cc26e?s=128&d=identicon&r=PG&f=1", "display_name": "gnasher729", "link": "https://stackoverflow.com/users/3255455/gnasher729"}, "is_accepted": false, "score": 1, "last_activity_date": 1458142500, "creation_date": 1458142500, "answer_id": 36040272, "question_id": 36038858, "link": "https://stackoverflow.com/questions/36038858/computing-rdsqrtx-with-a-fpu-in-ru-mode/36040272#36040272", "title": "Computing RD(sqrt(x)) with a FPU in RU mode", "body": "<p>fma calculates the result with infinite precision, then applies the rounding mode. </p>\n\n<p>If your candidate is too large, then the infinitely precise result is greater than 0, and since you are rounding up, it will be rounded up. Even if it is only a tiny little bit larger than zero. To verify this, first try l = 1 + 2eps, where (1 + eps) = sqrt (1 + 2eps + eps^2) is just a tiny bit too large; then scale l down by a negative power of 4 so that the eps^2 is way beyond the resolution of denormalised numbers, and check that as well. </p>\n"}, {"comments": [{"owner": {"reputation": 19034, "user_id": 780717, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/eead3a6ab011b880ca6ec354ca00f0b3?s=128&d=identicon&r=PG", "display_name": "njuffa", "link": "https://stackoverflow.com/users/780717/njuffa"}, "edited": false, "score": 2, "creation_date": 1458238835, "post_id": 36047367, "comment_id": 59783537, "body": "Did you mean to use <code>u</code> instead of <code>candidate</code>? In the current code, <code>candidate</code> is uninitialized."}, {"owner": {"reputation": 75299, "user_id": 139746, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/BhJLC.png?s=128&g=1", "display_name": "Pascal Cuoq", "link": "https://stackoverflow.com/users/139746/pascal-cuoq"}, "reply_to_user": {"reputation": 19034, "user_id": 780717, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/eead3a6ab011b880ca6ec354ca00f0b3?s=128&d=identicon&r=PG", "display_name": "njuffa", "link": "https://stackoverflow.com/users/780717/njuffa"}, "edited": false, "score": 0, "creation_date": 1458242391, "post_id": 36047367, "comment_id": 59785670, "body": "@njuffa not only that but <code>candidate</code> had no declaration. I took the liberty of fixing it."}], "tags": [], "owner": {"reputation": 7214, "user_id": 392585, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5ac7b1da0f2e9107b5020f88023a15e5?s=128&d=identicon&r=PG", "display_name": "Simon Byrne", "link": "https://stackoverflow.com/users/392585/simon-byrne"}, "is_accepted": true, "score": 4, "last_activity_date": 1458242333, "last_edit_date": 1458242333, "creation_date": 1458163945, "answer_id": 36047367, "question_id": 36038858, "link": "https://stackoverflow.com/questions/36038858/computing-rdsqrtx-with-a-fpu-in-ru-mode/36047367#36047367", "title": "Computing RD(sqrt(x)) with a FPU in RU mode", "body": "<p>I think you should be able to use:</p>\n\n<pre><code>/* assumes round-upwards */\ndouble sqrt_rd(double l) { \n  double u = sqrt(l);\n  double w = u*u;\n  if (w != l)\n    return nextafter(u, 0);\n  return u;\n}\n</code></pre>\n\n<p>The justification here being that if <code>u</code> is inexact, then it will be strictly greater than &radic;<code>l</code>, which in turn implies that <code>w</code> >= <code>u</code><sup>2</sup> > <code>l</code> (since <code>w</code> is also calculated in RU mode). And if <code>u</code> is exact, then so is <code>w</code> (since we know it must be representable as a double).</p>\n"}], "owner": {"reputation": 75299, "user_id": 139746, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/BhJLC.png?s=128&g=1", "display_name": "Pascal Cuoq", "link": "https://stackoverflow.com/users/139746/pascal-cuoq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 36047367, "answer_count": 2, "score": 3, "last_activity_date": 1458242333, "creation_date": 1458139216, "last_edit_date": 1458139817, "question_id": 36038858, "link": "https://stackoverflow.com/questions/36038858/computing-rdsqrtx-with-a-fpu-in-ru-mode", "title": "Computing RD(sqrt(x)) with a FPU in RU mode", "body": "<p>Intervals of floating-point bounds can be used to over-approximate sets of reals, as long as the upper bound of any result interval is computed in round-upwards and the lower bound in round-downwards.</p>\n\n<p>One recommended trick is to actually compute the negation of the lower bound. This allows to keep the FPU in round-upwards at all times (for instance, \u201cHandbook of Floating-Point Arithmetic\u201d, 2.9.2).</p>\n\n<p>This works well for addition and for multiplication. The square root operation, on the other hand, is not symmetrical in the ways addition and multiplication are.</p>\n\n<p>It occurs to me that in order to compute sqrt<sub>RD</sub>, for the lower bound, the following idiom, despite its complications, might be faster on an ordinary platform with IEEE 754 double-precision and <code>FLT_EVAL_METHOD</code> defined to 0 than changing the rounding mode twice:</p>\n\n<pre><code>#include &lt;fenv.h&gt;\n#include &lt;math.h&gt;\n#pragma STDC FENV_ACCESS ON\n\u2026\n/* assumes round-upwards */\ndouble sqrt_rd(double l) { \n  feclearexcept(FE_INEXACT);\n  double candidate = sqrt(l);\n  if (fetestexcept(FE_INEXACT))\n    return nextafter(candidate, 0);\n  return candidate;\n}\n</code></pre>\n\n<p>I am wondering whether this is better, and whether if it is the fastest yet. As one possible alternative, but still not necessarily the fastest, it seems to me that FMA<sub>RU</sub>(candidate, candidate, -l) might perhaps not be always exact (because of the directed rounding) but might be accurate enough around 0 for the following to work:</p>\n\n<pre><code>/* assumes round-upwards */\ndouble sqrt_rd(double l) { \n  double candidate = sqrt(l);\n  if (fma(candidate, candidate, -l) != 0.0)\n    return nextafter(candidate, 0);\n  return candidate;\n}\n</code></pre>\n\n<p>What other inexpensive ways are there to detect that <code>sqrt</code> was inexact?\nWhat combination of floating-point operations leads to the fastest computation of <code>sqrt_rd</code> on a modern FPU set to round upwards?</p>\n"}, {"tags": ["c", "cluster-analysis", "binaryfiles", "multiplexing"], "owner": {"reputation": 273, "user_id": 5919064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nJbuL.png?s=128&g=1", "display_name": "Enzo", "link": "https://stackoverflow.com/users/5919064/enzo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 81, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1458138448, "creation_date": 1458138448, "question_id": 36038552, "link": "https://stackoverflow.com/questions/36038552/c-find-and-analyze-clusters-in-a-binary-data-stream", "title": "C: Find and analyze clusters in a binary data stream", "body": "<h1>Structure of the file and description of the system</h1>\n\n<p>The stream I want to analyze (a large binary file) is composed as follows:</p>\n\n<ul>\n<li>40-bytes header</li>\n<li><p>A stream of 10-bytes signals:</p>\n\n<ul>\n<li>The first 8 bytes represent the time when the signal was registered</li>\n<li>The last 2 bytes describe the channel where the signal was registered</li>\n</ul></li>\n</ul>\n\n<p>The signal is emitted by a source which sends an impulse every <code>SIGNAL_INTERVAL</code>, and it may or may not be retrieved by the detector. If a detector counts, it sends the result to a counter's channel, which prints the count as shown above. The counter has 8 channels in total.</p>\n\n<h1>Multiplexing</h1>\n\n<p>In order to increase the number of detectors, a multiplexing approach is used. Two detectors send their counts to the same channel (say, detectors 1 and 9 are coupled on channel 1 of the counter). One of the signals (for example, 9) is delayed by <code>DELAY</code>, so that the delayed counts are shifted with respect to the non delayed ones.</p>\n\n<h1>Demultiplexing</h1>\n\n<p>The idea would be to divide the delayed data from the non delayed ones, then subtract the delay (adding 8 to the channel value so that a delayed count on channel 1 will be shown as a count on channel 9) and then rejoin the two arrays.</p>\n\n<p>If <code>SIGNAL_INTERVAL</code> is constant, this is relatively easy: I define a \"mask\" <code>[0, DELAY, SIGNAL_INTERVAL]</code> and, taking a reference timestamp value, see where every count falls in the mask.</p>\n\n<p>Trying different masks and counting which one gives the most counts, one can identify the delayed counts from the non delayed ones. This last part is done because we allow an error to the time count, so the stream will not be perfectly clustered. Moreover, it's impossible to know a priori if the first count is a delayed one, a non delayed one or even a casual count.</p>\n\n<p>This is done channel by channel, as the channels may have a different response time from each other.</p>\n\n<p>With this approach, the code is quite simple:</p>\n\n<pre><code>uint64_t maskCheck(struct count *data, int ch_num, int elements){\n\n    const int MAX_NUM = 27; // Maximum number of masks checked\n\n    int ref = 0; // The reference variable used as starting point at every cycle\n    uint64_t sing_count[2][MAX_NUM]; // The array containing the singles counts\n    uint64_t max_count; // Variable used to find the maximum in the array\n    int t = 0; // Time index for the following loop\n    uint64_t result = 0; // The final result, i.e. the index with the most singles counts\n\n// Initializing max_count (it has MAX_NUM as length, so it must be initialized after being declared)\n    for(int i = 0; i &lt; MAX_NUM; i++)sing_count[0][i] = 0;\n    for(int i = 0; i &lt; MAX_NUM; i++)sing_count[1][i] = 0;\n\n    while(getChannel(data[t])!=ch_num){\n        t++;\n        if(t == elements - 1){\n            printf(\"%s\\n\", \"Nothing found\");\n            return 0;\n        }\n    }\n    if(getChannel(data[t]) == ch_num) ref = getTimestamp(data[t]);\n    uint64_t ref_indexed = ref;\n\n    for(int index = 0; index &lt; MAX_NUM; index++){\n\n\n        sing_count[1][index] = ref + nsToBins(index) - nsToBins(MAX_NUM/2);\n        ref_indexed = sing_count[1][index];\n\n        for(t = 0; t &lt; elements; t++){\n        // Skips the counts not occurring at ch_num\n            if(getChannel(data[t]) != ch_num) {\n                continue;\n            }\n\n\n        if(longAbs(getTimestamp(data[t]), ref_indexed) % nsToBins(SIGNAL_INTERVAL) &lt;= nsToBins(MASK) + nsToBins(COUNT_ERROR) &amp;&amp;\n           longAbs(getTimestamp(data[t]), ref_indexed) % nsToBins(SIGNAL_INTERVAL) &gt;= nsToBins(MASK) - nsToBins(COUNT_ERROR)){\n            sing_count[0][index]++;\n\n        }\n        else if(longAbs(getTimestamp(data[t]), ref_indexed) % nsToBins(SIGNAL_INTERVAL) &lt;= nsToBins(COUNT_ERROR) ||\n            longAbs(getTimestamp(data[t]), ref_indexed) % nsToBins(SIGNAL_INTERVAL) &gt;= nsToBins(SIGNAL_INTERVAL) - nsToBins(COUNT_ERROR)){\n            sing_count[0][index]++; \n        }\n        }\n    }\n\n// This last part maximizes the array.\n    max_count = sing_count[0][0];\n    result = sing_count[1][0];\n\n    for(int i = 1; i &lt; MAX_NUM; i++){\n        if(sing_count[0][i] &gt; max_count)\n        {\n            max_count = sing_count[0][i];\n            result = sing_count[1][i];\n        }\n    }\n</code></pre>\n\n<p>where <code>struct count</code> is defined as a 10-byte array read by the functions <code>getTimestamp()</code> and <code>getChannel()</code>, and <code>nsToBins()</code> simply converts the time units.</p>\n\n<p>Having the \"best mask\", I can divide the array through it and then perform all the other needed operations.</p>\n\n<h1>The problem</h1>\n\n<p>Now, here comes the problem. <code>SIGNAL_INTERVAL</code> is not constant, and it's not even well determined (to give you an idea, the frequency oscillates between <code>75.6 Mhz</code> and <code>76.3 MHz</code>).\nThe above approach turns out to be very unsuccessful now:</p>\n\n<ul>\n<li><code>SIGNAL_INTERVAL</code> has an error of about <code>0.3 ns</code></li>\n<li>The measurement is performed over 30 seconds</li>\n<li>Keeping in mind that the order of magnitude of <code>SIGNAL_INTERVAL</code> is of <code>10 ns</code>, after just one second the error would be too big</li>\n<li>This results in the timestamps being incorrectly divided, affecting all the subsequent operations.</li>\n</ul>\n\n<p>What I had in mind was something to analyze the clusters in the data (<code>SIGNAL_INTERVAL</code> is not constant, but the oscillation is much smaller than <code>DELAY</code> so some clustering could in principle be observed) and find another way to divide the two arrays.</p>\n\n<p>But so far I have nothing. Any help would be appreciated.</p>\n"}, {"tags": ["c", "c-preprocessor"], "comments": [{"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 2, "creation_date": 1458138643, "post_id": 36038410, "comment_id": 59726379, "body": "Unclear for me. Do you want a preprocessor? <code>__func__</code> is not ok?"}, {"owner": {"reputation": 49, "user_id": 6072143, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be5fb689ad208fadfa6f4b108cc8f89e?s=128&d=identicon&r=PG&f=1", "display_name": "Free World", "link": "https://stackoverflow.com/users/6072143/free-world"}, "reply_to_user": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1458138747, "post_id": 36038410, "comment_id": 59726475, "body": "I want to get the Macro name from with the ifdef."}, {"owner": {"reputation": 2544, "user_id": 3374593, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b52e8f3dbba2dd84cee919766d30125d?s=128&d=identicon&r=PG&f=1", "display_name": "L&#230;rne", "link": "https://stackoverflow.com/users/3374593/l%c3%a6rne"}, "edited": false, "score": 1, "creation_date": 1458138947, "post_id": 36038410, "comment_id": 59726632, "body": "Which macro name ?  The one contained by <code>_TEST</code> ? just type <code>_TEST</code>..."}], "answers": [{"comments": [{"owner": {"reputation": 49, "user_id": 6072143, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be5fb689ad208fadfa6f4b108cc8f89e?s=128&d=identicon&r=PG&f=1", "display_name": "Free World", "link": "https://stackoverflow.com/users/6072143/free-world"}, "edited": false, "score": 0, "creation_date": 1458139414, "post_id": 36038763, "comment_id": 59726988, "body": "Thanks, got it. I was trying to find a way not to type the MACRO name again, instead use something inbuild. Just like <b>func</b>."}], "tags": [], "owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "is_accepted": true, "score": 2, "last_activity_date": 1458138941, "creation_date": 1458138941, "answer_id": 36038763, "question_id": 36038410, "link": "https://stackoverflow.com/questions/36038410/how-to-know-the-macro-context-you-are-in/36038763#36038763", "title": "How to know the Macro context you are in", "body": "<p>There is no such placeholder defined in the language standard.</p>\n\n<p>You <em>know</em> the macro you just checked, though, so I do not see how such a placeholder would be useful even if it existed.</p>\n\n<p>Also consider...</p>\n\n<pre><code>#if defined( FOO ) || defined( BAR )\n</code></pre>\n\n<p>...what should the \"context\" be named as?</p>\n"}, {"tags": [], "owner": {"reputation": 1388, "user_id": 5837095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/I7CdJ.png?s=128&g=1", "display_name": "Embedded C", "link": "https://stackoverflow.com/users/5837095/embedded-c"}, "is_accepted": false, "score": 0, "last_activity_date": 1458139182, "creation_date": 1458139182, "answer_id": 36038848, "question_id": 36038410, "link": "https://stackoverflow.com/questions/36038410/how-to-know-the-macro-context-you-are-in/36038848#36038848", "title": "How to know the Macro context you are in", "body": "<p>Asingle macro for one type of function is enough</p>\n\n<pre><code>#define FUNCTION(macroname,prefix) void macroname##prefix() {//func definition }\n#define FUNCTION(MY_TEST_FUNCTION,test)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2544, "user_id": 3374593, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b52e8f3dbba2dd84cee919766d30125d?s=128&d=identicon&r=PG&f=1", "display_name": "L&#230;rne", "link": "https://stackoverflow.com/users/3374593/l%c3%a6rne"}, "is_accepted": false, "score": 1, "last_activity_date": 1458297821, "last_edit_date": 1458297821, "creation_date": 1458139473, "answer_id": 36038957, "question_id": 36038410, "link": "https://stackoverflow.com/questions/36038410/how-to-know-the-macro-context-you-are-in/36038957#36038957", "title": "How to know the Macro context you are in", "body": "<p>You assume too much of the macro inclusion system.  A (without-variable) macro simply replace a name with a string of character.  There is not \"current macro context\", just a map of macro names with their replacement characters. There is nothing more special about the header macro protection than any macro like<code>EXIT_FAILURE</code> (in <code>stdlib.h</code>).</p>\n\n<p><code>#ifdef</code> and <code>#ifndef</code> just test whether a macro, any macro, is defined with a given name.</p>\n\n<p>So if you want to have a \"header macro context\", you have to manually set it at the beginning of the header.</p>\n\n<p>Or maybe your problem could be solve with a parameter macro.</p>\n\n<pre><code>#define function_variation( suffix ) int function_##suffix() {\\\n  ... \\\n}\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 6072143, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be5fb689ad208fadfa6f4b108cc8f89e?s=128&d=identicon&r=PG&f=1", "display_name": "Free World", "link": "https://stackoverflow.com/users/6072143/free-world"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 1, "closed_date": 1458713124, "accepted_answer_id": 36038763, "answer_count": 3, "score": 3, "last_activity_date": 1458301830, "creation_date": 1458138090, "last_edit_date": 1458301830, "question_id": 36038410, "link": "https://stackoverflow.com/questions/36038410/how-to-know-the-macro-context-you-are-in", "closed_reason": "Needs details or clarity", "title": "How to know the Macro context you are in", "body": "<p>For Example:</p>\n\n<pre><code>#define MY_TEST_FUNCTION\n#ifdef MY_TEST_FUNCTION\nvoid __MACRO_NAME##_TEST (void *)\n{\n\n}\n#endif\n</code></pre>\n\n<p>This should produce:</p>\n\n<pre><code>#ifdef MY_TEST_FUNCTION\nvoid MY_TEST_FUNCTION_TEST (void *)\n{\n\n}\n#endif\n</code></pre>\n\n<p>This is something like <strong>func</strong>, where we get the function name inside a function. Is this possible?</p>\n"}, {"tags": ["php", "c", "apache", ".htaccess"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6071990, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j3wwm.jpg?s=128&g=1", "display_name": "marita", "link": "https://stackoverflow.com/users/6071990/marita"}, "edited": false, "score": 0, "creation_date": 1458149160, "post_id": 36042668, "comment_id": 59734396, "body": "The C programm ccc is on remote server (see ls):js ccc ccc.c css exec.php img inc index.php"}, {"owner": {"reputation": 1, "user_id": 6071990, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j3wwm.jpg?s=128&g=1", "display_name": "marita", "link": "https://stackoverflow.com/users/6071990/marita"}, "edited": false, "score": 0, "creation_date": 1458149696, "post_id": 36042668, "comment_id": 59734761, "body": "The php-ini shows what is permitted or not:  ... &#39;--enable-safe-mode=yes&#39; &#39;--enable-cgi&#39; &#39;--enable-fastcgi&#39; &#39;--with-exec-dir=/opt/RZphp5/exec&#39;  &#39;--disable-force-cgi-redirect&#39;  Is there anything i can do? i so far tried everything i found."}, {"owner": {"reputation": 1, "user_id": 6071990, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j3wwm.jpg?s=128&g=1", "display_name": "marita", "link": "https://stackoverflow.com/users/6071990/marita"}, "edited": false, "score": 0, "creation_date": 1458150020, "post_id": 36042668, "comment_id": 59735002, "body": "the errors on remote server are 20160316 errors 0-6 | 0: 0 | 3: 1 | 4: 1 | 5: 1, on local server (if any) errors 0-6 | 0: 0 | 3: 5 | 4: 5 | 5: 5. is my provider to strict in safe mode? is there a way for example by htaccess?"}], "tags": [], "owner": {"reputation": 6857, "user_id": 624998, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y2CmD.jpg?s=128&g=1", "display_name": "Dwayne Towell", "link": "https://stackoverflow.com/users/624998/dwayne-towell"}, "is_accepted": false, "score": 0, "last_activity_date": 1458148891, "creation_date": 1458148891, "answer_id": 36042668, "question_id": 36038272, "link": "https://stackoverflow.com/questions/36038272/exec-on-remote-server-returns-only-return-var-1-7-ways-tried-without-success/36042668#36042668", "title": "exec() on remote server returns only return-var 1 | 7 ways tried without success", "body": "<p>Sounds like the C program is only local. The program must be on the remote server. Also the apache service must have read and execute permission to it.</p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 6071990, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j3wwm.jpg?s=128&g=1", "display_name": "marita", "link": "https://stackoverflow.com/users/6071990/marita"}, "edited": false, "score": 0, "creation_date": 1458163137, "post_id": 36047099, "comment_id": 59742842, "body": "Having just upgraded php from 5.3 (above) to 5.5, then 5.6, finally 7.0 didn&#39;t fix the issue. exec(), popen(), shell_exec(), system(), passthru() won&#39;t run the c-command ccc with more output than return_var value 1 !"}], "tags": [], "owner": {"reputation": 1, "user_id": 6071990, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j3wwm.jpg?s=128&g=1", "display_name": "marita", "link": "https://stackoverflow.com/users/6071990/marita"}, "is_accepted": false, "score": 0, "last_activity_date": 1458162933, "creation_date": 1458162933, "answer_id": 36047099, "question_id": 36038272, "link": "https://stackoverflow.com/questions/36038272/exec-on-remote-server-returns-only-return-var-1-7-ways-tried-without-success/36047099#36047099", "title": "exec() on remote server returns only return-var 1 | 7 ways tried without success", "body": "<p>Upgrading the php-version to a level above 5.4 could be an answer. Safe mode then should be turned of. That is, exec(), popen(), shell_exec(), system(), passthru() should not be blocked by php-ini-restrictions any more.   </p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 6071990, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j3wwm.jpg?s=128&g=1", "display_name": "marita", "link": "https://stackoverflow.com/users/6071990/marita"}, "edited": false, "score": 0, "creation_date": 1458309661, "post_id": 36079551, "comment_id": 59817083, "body": "When trying to execute a c-file under the updated conditions, the host returns a code &quot;137&quot;."}], "tags": [], "owner": {"reputation": 1, "user_id": 6071990, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j3wwm.jpg?s=128&g=1", "display_name": "marita", "link": "https://stackoverflow.com/users/6071990/marita"}, "is_accepted": true, "score": 0, "last_activity_date": 1458293684, "last_edit_date": 1458293684, "creation_date": 1458289949, "answer_id": 36079551, "question_id": 36038272, "link": "https://stackoverflow.com/questions/36038272/exec-on-remote-server-returns-only-return-var-1-7-ways-tried-without-success/36079551#36079551", "title": "exec() on remote server returns only return-var 1 | 7 ways tried without success", "body": "<p>The problem is the c-file, what is not a provided feature of that hoster.\nIf changing the given path of executables (in $cpath) to path obtained by exec(pwd), and changing type c-file to type perl-file, AND deleting .htaccess out of directory, then execution is correct.</p>\n"}], "owner": {"reputation": 1, "user_id": 6071990, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j3wwm.jpg?s=128&g=1", "display_name": "marita", "link": "https://stackoverflow.com/users/6071990/marita"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "accepted_answer_id": 36079551, "answer_count": 3, "score": 0, "last_activity_date": 1458469353, "creation_date": 1458137780, "last_edit_date": 1458469353, "question_id": 36038272, "link": "https://stackoverflow.com/questions/36038272/exec-on-remote-server-returns-only-return-var-1-7-ways-tried-without-success", "title": "exec() on remote server returns only return-var 1 | 7 ways tried without success", "body": "<p>On remote apache (firstly <code>PHP Version 5.3.29</code> | finally updated to 7.04 without safe mode enabled) i've tried to run a tiny 20 chars c-file \"ccc\" with</p>\n\n<pre><code> exec(), popen(), shell_exec(), system(), passthru(), backtick\n</code></pre>\n\n<p>... where 5 of 6 approaches are with local success, 0 of 6 so far with remote.</p>\n\n<p>I get a return value \"1\" in 3 of 6 cases (<code>passthru, exec, system</code>), and an empty (?) stream (if that is possible) with <code>popen</code> (see below).</p>\n\n<p><code>exec(), passthru(), system()</code> are willing run commands like ls on remote server, but give me nothing with ccc, the c-testfile with only <code>printf(\"c did\");</code>) in it. </p>\n\n<p>The server is configured (php-ini) after upgrade to <code>php-Version 7.04</code> without safe-mode.</p>\n\n<p>My file exec.php only tries to run ccc in 6 ways (shortened below)</p>\n\n<pre><code>// start source\n\nerror_reporting(E_ALL); \n\necho exec ('ls', $out0, $error0);\n\n$popen = popen ($cpath.'ccc', 'r'); \nstream_get_contents ( $popen ); \n\nshell_exec ($cpath.'ccc');\n\npassthru ($cpath.'ccc', $error3);\n\nexec ($cpath.'ccc', $out4, $error4);\n\nsystem ($cpath.'ccc', $error5);\n\n$output = `$cpath.ccc`; \n\necho '20160316 errors 0-6 | 0: '.$error0.' |  3: '.$error3.' | 4: '.$error4.' | 5: '.$error5.'&lt;br/&gt;';   \necho '20160316 outputs 0-6 | 0: '.gettype($out0).' | 1: '.get_resource_type($popen).' | 4: '.gettype($out4).';  \n\n// end source\n</code></pre>\n\n<p>The file does open the c-file without errors on local server,\nbut without output and with return 1 on remote server.</p>\n"}, {"tags": ["c", "gcc", "assembly", "locking", "mutex"], "comments": [{"owner": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 0, "creation_date": 1458135919, "post_id": 36037401, "comment_id": 59724104, "body": "No, <code>test eax, eax</code>  1) does not change eax at all and 2) only produces zero flag iff eax is zero. <code>96-107</code> is your <code>while(lock) nop</code>"}, {"owner": {"reputation": 196, "user_id": 6008146, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YbpxZ.png?s=128&g=1", "display_name": "JumpAlways", "link": "https://stackoverflow.com/users/6008146/jumpalways"}, "reply_to_user": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 0, "creation_date": 1458136462, "post_id": 36037401, "comment_id": 59724593, "body": "@Jester I don&#39;t think it&#39;s the while loop, because <code>mov (lock), %eax</code> and <code>test %eax, %eax</code> is a different condition, while the ! __sync(...) should produce <code>jne wait</code> or <code>test %eax, %eax</code>, testing %eax directly after cmpxchg, but not after have assigned it a new value."}, {"owner": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 1, "creation_date": 1458136623, "post_id": 36037401, "comment_id": 59724739, "body": "It is that while loop, but rewritten so that it jumps out of the loop if <code>lock == 0</code>. <code>mov lock, eax; test eax, eax; je</code> is an <code>if (lock == 0) break;</code> The <code>while(!__sync)</code> is at lines <code>82-90</code>."}, {"owner": {"reputation": 196, "user_id": 6008146, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YbpxZ.png?s=128&g=1", "display_name": "JumpAlways", "link": "https://stackoverflow.com/users/6008146/jumpalways"}, "reply_to_user": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 0, "creation_date": 1458136724, "post_id": 36037401, "comment_id": 59724837, "body": "@Jester <i>&quot;In the x86 assembly language, the TEST instruction performs a bitwise AND on two operands. The flags SF, ZF, PF are modified while the result of the AND is discarded. The OF and CF flags are set to 0, while AF flag is undefined. The TEST operation sets the flags CF and OF to zero. The SF is set to the most significant bit of the result of the AND. If the result of the AND is 0, the ZF is set to 1, otherwise set to 0. The parity flag is set to the bitwise XNOR of the result of the AND. The value of AF is undefined.&quot;</i> - from (<a href=\"https://en.wikipedia.org/wiki/TEST_%28x86_instruction%29\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/TEST_%28x86_instruction%29</a>)"}, {"owner": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 1, "creation_date": 1458136809, "post_id": 36037401, "comment_id": 59724908, "body": "I know what <code>test</code> does, you don&#39;t seem to :) As your quote says, it performs a bitwise AND with the <b>result discarded</b> so, as I said, <code>eax</code> is not changed. Also <code>x AND x</code> will only give zero if <code>x</code> itself is zero which is also what I said. Problem?"}, {"owner": {"reputation": 196, "user_id": 6008146, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YbpxZ.png?s=128&g=1", "display_name": "JumpAlways", "link": "https://stackoverflow.com/users/6008146/jumpalways"}, "reply_to_user": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 0, "creation_date": 1458137027, "post_id": 36037401, "comment_id": 59725096, "body": "@Jester Why it&#39;s necessary? If while(! __sync(...)) continues the loop doesn&#39;t it mean that lock wasn&#39;t 1, so was equal to 0, in this case?"}, {"owner": {"reputation": 196, "user_id": 6008146, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YbpxZ.png?s=128&g=1", "display_name": "JumpAlways", "link": "https://stackoverflow.com/users/6008146/jumpalways"}, "reply_to_user": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 0, "creation_date": 1458137520, "post_id": 36037401, "comment_id": 59725508, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/106473/discussion-between-jumpalways-and-jester\">continue this discussion in chat</a>."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1458140273, "post_id": 36037401, "comment_id": 59727686, "body": "Don&#39;t use gcc extensions if there are standard compliant alternatives. C provides atomics."}, {"owner": {"reputation": 196, "user_id": 6008146, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YbpxZ.png?s=128&g=1", "display_name": "JumpAlways", "link": "https://stackoverflow.com/users/6008146/jumpalways"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1458156205, "post_id": 36037401, "comment_id": 59738704, "body": "@Olaf I&#39;ve only found C++ atomics, but no C atomics..."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1458157479, "post_id": 36037401, "comment_id": 59739523, "body": "In C11, <code>#include &lt;stdatomic.h&gt;</code>.  See <a href=\"http://en.cppreference.com/w/c/atomic\" rel=\"nofollow noreferrer\">en.cppreference.com/w/c/atomic</a>.  (yes, cppreference.com has a C section, that&#39;s <i>not</i> a C++ link).  In your inline asm, you could get gcc to supply those values in registers for you.  But of course, it would be better to just use the C11 atomics and not write inline asm at all."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1458157770, "post_id": 36037401, "comment_id": 59739708, "body": "Also, holy crap you have a global variable called <code>i</code>?  Don&#39;t do that; everyone reading C expects <code>i</code> to be a local loop variable."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1458158149, "post_id": 36037401, "comment_id": 59739939, "body": "@JumpAlways: Just see the standard! A simple search would have shown also some links."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1458158275, "post_id": 36037401, "comment_id": 59740028, "body": "@PeterCordes: Why that? global variables are single-letter, locals something like <code>loop_counter_for_a_deeply_nested_loop_level_8</code>. So you tell me now that is not common practice?"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 2, "creation_date": 1458159205, "post_id": 36037401, "comment_id": 59740558, "body": "@Olaf: Using single-letter globals is definitely not normal in most code-bases.  I tried to google for a reference, instead of trying to explain it myself.  <a href=\"http://www.oualline.com/books.free/style/c03.html#pgfId=766\" rel=\"nofollow noreferrer\">This looks pretty sensible</a>.  <i>The variable named <code>i</code> is frequently used as a general purpose, handy dandy, local index.</i>  That&#39;s definitely the convention in C.  There&#39;s no need to use such a short non-descriptive name for a global, esp. one that will be shadowed by <code>for(int i=0; i &lt; MAX ; i++)</code> in many places."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1458164357, "post_id": 36037401, "comment_id": 59743460, "body": "@PeterCordes: Try compiling with <code>#define HUMOR 1</code> ;-)"}, {"owner": {"reputation": 6093, "user_id": 2189500, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/109f747845a9ce762a1fff72eb8cf6f3?s=128&d=identicon&r=PG", "display_name": "David Wohlferd", "link": "https://stackoverflow.com/users/2189500/david-wohlferd"}, "edited": false, "score": 0, "creation_date": 1485203522, "post_id": 36037401, "comment_id": 70818339, "body": "&quot;How should I procede?&quot; - I don&#39;t understand.  You have &#39;working&#39; code using builtins and you are asking how you should proceed?  I assume most answers are going to be &quot;Use the working code.&quot;  Perhaps you should clarify exactly what you want to know."}], "owner": {"reputation": 196, "user_id": 6008146, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YbpxZ.png?s=128&g=1", "display_name": "JumpAlways", "link": "https://stackoverflow.com/users/6008146/jumpalways"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 339, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1485182584, "creation_date": 1458135699, "last_edit_date": 1485182584, "question_id": 36037401, "link": "https://stackoverflow.com/questions/36037401/gcc-built-in-synchronization-functions-and-cmpxchg", "title": "gcc built-in synchronization functions and cmpxchg", "body": "<p>I've trying to implement a lock writing the asm code manually and since the code actually hasn't worked, I used __sync_bool_compare_and_swap to look at the disassembly. \n<br><strong>However, the built-in function seems not to work too.</strong></p>\n\n<p>I'm using Ubuntu 15.10 x64</p>\n\n<p><br>\nHere's the general structure of the program.</p>\n\n<p><strong>Global:</strong></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;pthread.h&gt;\n#include &lt;time.h&gt;\n#include &lt;stdbool.h&gt;\n#include &lt;unistd.h&gt;\n\nunsigned int randrange(unsigned int min, unsigned int max);   // custom rand function\n\n             pthread_mutex_t mutex = PTHREAD_MUTEX_INITIALIZER;   // real mutex\n__volatile__ unsigned int    lock = 1;                            // my attempt\n             unsigned int    i = 0, count = 0;\n</code></pre>\n\n<p><strong>Thread function:</strong></p>\n\n<pre><code>void *worker(void *arg)\n{\n    unsigned int loop = randrange(1000, 10000), time = randrange(10, 100);\n\n    pthread_mutex_lock(&amp;mutex);  \n    count += loop;                  // safe keep trace of number of iterations\n    pthread_mutex_unlock(&amp;mutex);\n\n    /* Acquire the custom lock */\n\n    for(int x = 0; x &lt; loop; x++)\n    {\n        i++;                // increment i by number of iterations with a step=1\n        usleep(time);       // short nap\n    }\n\n    __sync_synchronize();   // built-in full barriers\n    lock = 1;               // release the custom lock\n\n    pthread_exit((void*) true);\n}\n</code></pre>\n\n<p><strong>Main:</strong></p>\n\n<pre><code>int main()\n{\n    pthread_t       thread_id[1000];\n    pthread_attr_t  attr;\n    unsigned int    ret_thread = NULL;\n    void           *status = NULL;\n    unsigned int    args = NULL;\n    unsigned int    nthreads = 1000;\n\n    pthread_attr_init(&amp;attr);\n    pthread_attr_setdetachstate(&amp;attr, PTHREAD_CREATE_JOINABLE);\n\n    for(int i = 0; i &lt; nthreads; i++)\n    {\n        ret_thread = pthread_create(&amp;thread_id[i], &amp;attr, worker,\n                                    (void *) &amp;args);\n        if(ret_thread)\n        {\n            printf(\"Error occurred during thread creation. \\\n                    n: %i   - return code: %i\", i, ret_thread);\n            return -1;\n        }\n    }\n\n    pthread_attr_destroy(&amp;attr);\n\n    for(int i = 0; i &lt; nthreads; i++)\n    {\n        ret_thread = pthread_join(thread_id[i], &amp;status);\n        if(ret_thread)\n        {\n            printf(\"Error occurred during thread joining. \\\n                    n: %i   - return code: %i\", i, ret_thread);\n            return -1;\n        }\n    }\n\n    puts(\"\\nmain: All the threads exited normally.\\n\");\n\n    printf(\"count: %i   -   i: %i\\n\", count, i);   // core: compare the safe trace or number of iterations with the target one\n\n    puts(\"\\n\\nmain: I've finished, bye.\\n\");\n\n    pthread_mutex_destroy(&amp;mutex);\n\n    return 0;\n}\n</code></pre>\n\n<p><br><br>\nSince <code>cmpxchg source, destination</code> compares the accumulator (register A) with the destination operand, so that\n<br>if accumulator == destination then ZF is set and the source is copied into the destination and \n<br>if accumulator != destination then ZF is reset and the destination is copied into the accumulator...</p>\n\n<p><strong>My attempt:</strong></p>\n\n<pre><code>void *worker(void *arg)\n{\n    unsigned int loop = randrange(1000, 10000), time = randrange(10, 100);\n\n    pthread_mutex_lock(&amp;mutex);  \n    count += loop;                  // safe keep trace of number of iterations\n    pthread_mutex_unlock(&amp;mutex);\n\n    /* My attempt */\n\n    prepare:\n        __asm__ __volatile__      (\"xor %r8, %r8\");\n    wait:\n        __asm__ __volatile__      (\"nop                        \\n\\t\"\n                                   \"mov $0x1, %rax             \\n\\t\"\n                                   \"lock; cmpxchgq %r8, (lock)\");\n        __asm__ __volatile__ goto (\"jne %l0\" :::: wait);\n\n    /* My attempt */\n\n    for(int x = 0; x &lt; loop; x++)\n    {\n        i++;                // increment i by number of iterations with a step=1\n        usleep(time);       // short nap\n    }\n\n    __sync_synchronize();   // built-in full barriers\n    lock = 1;               // release the custom lock\n\n    pthread_exit((void*) true);\n}\n</code></pre>\n\n<p><strong>Disassembly:</strong></p>\n\n<pre><code>(gdb) disas worker\nDump of assembler code for function worker:\n   0x0000000000400c70 &lt;+0&gt;:     push   %r12\n   0x0000000000400c72 &lt;+2&gt;:     push   %rbp\n   0x0000000000400c73 &lt;+3&gt;:     mov    $0x2710,%esi\n   0x0000000000400c78 &lt;+8&gt;:     push   %rbx\n   0x0000000000400c79 &lt;+9&gt;:     mov    $0x3e8,%edi\n   0x0000000000400c7e &lt;+14&gt;:    callq  0x400c20 &lt;randrange&gt;\n   0x0000000000400c83 &lt;+19&gt;:    mov    $0x32,%esi\n   0x0000000000400c88 &lt;+24&gt;:    mov    $0x1,%edi\n   0x0000000000400c8d &lt;+29&gt;:    mov    %eax,%ebp\n   0x0000000000400c8f &lt;+31&gt;:    callq  0x400c20 &lt;randrange&gt;\n   0x0000000000400c94 &lt;+36&gt;:    mov    $0x602100,%edi\n   0x0000000000400c99 &lt;+41&gt;:    mov    %eax,%r12d\n   0x0000000000400c9c &lt;+44&gt;:    callq  0x4009d0 &lt;pthread_mutex_lock@plt&gt;\n   0x0000000000400ca1 &lt;+49&gt;:    mov    $0x602100,%edi\n   0x0000000000400ca6 &lt;+54&gt;:    add    %ebp,0x201434(%rip)      # 0x6020e0 &lt;count&gt;\n   0x0000000000400cac &lt;+60&gt;:    callq  0x400980 &lt;pthread_mutex_unlock@plt&gt;\n   0x0000000000400cb1 &lt;+65&gt;:    nopl   0x0(%rax)\n   0x0000000000400cb8 &lt;+72&gt;:    nop\n   0x0000000000400cb9 &lt;+73&gt;:    xor    %r8,%r8\n   0x0000000000400cbc &lt;+76&gt;:    mov    $0x1,%rax\n   0x0000000000400cc3 &lt;+83&gt;:    lock cmpxchg %r8,0x6020b8         # 0x6020b8 &lt;lock&gt;\n   0x0000000000400ccd &lt;+93&gt;:    jne    0x400cb8 &lt;worker+72&gt;\n   0x0000000000400ccf &lt;+95&gt;:    xor    %ebx,%ebx\n   0x0000000000400cd1 &lt;+97&gt;:    test   %ebp,%ebp\n   0x0000000000400cd3 &lt;+99&gt;:    je     0x400cee &lt;worker+126&gt;\n   0x0000000000400cd5 &lt;+101&gt;:   nopl   (%rax)\n   0x0000000000400cd8 &lt;+104&gt;:   mov    %r12d,%edi\n   0x0000000000400cdb &lt;+107&gt;:   add    $0x1,%ebx\n   0x0000000000400cde &lt;+110&gt;:   addl   $0x1,0x2013ff(%rip)        # 0x6020e4 &lt;i&gt;\n   0x0000000000400ce5 &lt;+117&gt;:   callq  0x4009f0 &lt;usleep@plt&gt;\n   0x0000000000400cea &lt;+122&gt;:   cmp    %ebp,%ebx\n   0x0000000000400cec &lt;+124&gt;:   jne    0x400cd8 &lt;worker+104&gt;\n   0x0000000000400cee &lt;+126&gt;:   mov    $0x1,%edi\n   0x0000000000400cf3 &lt;+131&gt;:   mfence \n   0x0000000000400cf6 &lt;+134&gt;:   movl   $0x1,0x2013b8(%rip)        # 0x6020b8 &lt;lock&gt;\n   0x0000000000400d00 &lt;+144&gt;:   callq  0x400990 &lt;pthread_exit@plt&gt;\nEnd of assembler dump.\n</code></pre>\n\n<p><br>\n<strong>With __sync_bool_compare_and_swap():</strong></p>\n\n<pre><code>void *worker(void *arg)\n{\n    unsigned int loop = randrange(1000, 10000), time = randrange(10, 100);\n\n    pthread_mutex_lock(&amp;mutex);  \n    count += loop;                  // safe keep trace of number of iterations\n    pthread_mutex_unlock(&amp;mutex);\n\n    /* built-in function */\n\n    while(!__sync_bool_compare_and_swap(&amp;lock, 1, 0))\n    {\n        while(lock) __asm__ __volatile__ (\"nop\");\n    }\n\n    /* built-in function */\n\n    for(int x = 0; x &lt; loop; x++)\n    {\n        i++;                // increment i by number of iterations with a step=1\n        usleep(time);       // short nap\n    }\n\n    __sync_synchronize();   // built-in full barriers\n    lock = 1;               // release the custom lock\n\n    pthread_exit((void*) true);\n}\n</code></pre>\n\n<p><strong>Disassembly:</strong></p>\n\n<pre><code>(gdb) disas worker\nDump of assembler code for function worker:\n   0x0000000000400c70 &lt;+0&gt;:     push   %r12\n   0x0000000000400c72 &lt;+2&gt;:     push   %rbp\n   0x0000000000400c73 &lt;+3&gt;:     mov    $0x2710,%esi\n   0x0000000000400c78 &lt;+8&gt;:     push   %rbx\n   0x0000000000400c79 &lt;+9&gt;:     mov    $0x3e8,%edi\n   0x0000000000400c7e &lt;+14&gt;:    callq  0x400c20 &lt;randrange&gt;\n   0x0000000000400c83 &lt;+19&gt;:    mov    $0x32,%esi\n   0x0000000000400c88 &lt;+24&gt;:    mov    $0x1,%edi\n   0x0000000000400c8d &lt;+29&gt;:    mov    %eax,%ebx\n   0x0000000000400c8f &lt;+31&gt;:    callq  0x400c20 &lt;randrange&gt;\n   0x0000000000400c94 &lt;+36&gt;:    mov    $0x602100,%edi\n   0x0000000000400c99 &lt;+41&gt;:    mov    %eax,%ebp\n   0x0000000000400c9b &lt;+43&gt;:    callq  0x4009d0 &lt;pthread_mutex_lock@plt&gt;\n   0x0000000000400ca0 &lt;+48&gt;:    mov    $0x602100,%edi\n   0x0000000000400ca5 &lt;+53&gt;:    add    %ebx,0x201435(%rip)        # 0x6020e0 &lt;count&gt;\n   0x0000000000400cab &lt;+59&gt;:    callq  0x400980 &lt;pthread_mutex_unlock@plt&gt;\n   0x0000000000400cb0 &lt;+64&gt;:    mov    $0x1,%ecx\n   0x0000000000400cb5 &lt;+69&gt;:    xor    %edx,%edx\n   0x0000000000400cb7 &lt;+71&gt;:    nopw   0x0(%rax,%rax,1)\n   0x0000000000400cc0 &lt;+80&gt;:    mov    %ecx,%eax\n   0x0000000000400cc2 &lt;+82&gt;:    lock cmpxchg %edx,0x2013ee(%rip)      # 0x6020b8 &lt;lock&gt;\n   0x0000000000400cca &lt;+90&gt;:    je     0x400cdd &lt;worker+109&gt;\n   0x0000000000400ccc &lt;+92&gt;:    nopl   0x0(%rax)\n   0x0000000000400cd0 &lt;+96&gt;:    mov    0x2013e2(%rip),%eax        # 0x6020b8 &lt;lock&gt;\n   0x0000000000400cd6 &lt;+102&gt;:   test   %eax,%eax\n   0x0000000000400cd8 &lt;+104&gt;:   je     0x400cc0 &lt;worker+80&gt;\n   0x0000000000400cda &lt;+106&gt;:   nop\n   0x0000000000400cdb &lt;+107&gt;:   jmp    0x400cd0 &lt;worker+96&gt;\n   0x0000000000400cdd &lt;+109&gt;:   xor    %r12d,%r12d\n   0x0000000000400ce0 &lt;+112&gt;:   test   %ebx,%ebx\n   0x0000000000400ce2 &lt;+114&gt;:   je     0x400cfb &lt;worker+139&gt;\n   0x0000000000400ce4 &lt;+116&gt;:   mov    %ebp,%edi\n   0x0000000000400ce6 &lt;+118&gt;:   add    $0x1,%r12d\n   0x0000000000400cea &lt;+122&gt;:   addl   $0x1,0x2013f3(%rip)        # 0x6020e4 &lt;i&gt;\n   0x0000000000400cf1 &lt;+129&gt;:   callq  0x4009f0 &lt;usleep@plt&gt;\n   0x0000000000400cf6 &lt;+134&gt;:   cmp    %ebx,%r12d\n   0x0000000000400cf9 &lt;+137&gt;:   jne    0x400ce4 &lt;worker+116&gt;\n   0x0000000000400cfb &lt;+139&gt;:   mov    $0x1,%edi\n   0x0000000000400d00 &lt;+144&gt;:   mfence \n   0x0000000000400d03 &lt;+147&gt;:   movl   $0x1,0x2013ab(%rip)        # 0x6020b8 &lt;lock&gt;\n   0x0000000000400d0d &lt;+157&gt;:   callq  0x400990 &lt;pthread_exit@plt&gt;\nEnd of assembler dump.\n</code></pre>\n\n<p><br>\nThe built-in function produce more code:</p>\n\n<pre><code>   0x0000000000400cb0 &lt;+64&gt;:    mov    $0x1,%ecx\n   0x0000000000400cb5 &lt;+69&gt;:    xor    %edx,%edx\n   0x0000000000400cb7 &lt;+71&gt;:    nopw   0x0(%rax,%rax,1)\n   0x0000000000400cc0 &lt;+80&gt;:    mov    %ecx,%eax\n   0x0000000000400cc2 &lt;+82&gt;:    lock cmpxchg %edx,0x2013ee(%rip)  # 0x6020b8 &lt;lock&gt;\n   0x0000000000400cca &lt;+90&gt;:    je     0x400cdd &lt;worker+109&gt;\n   0x0000000000400ccc &lt;+92&gt;:    nopl   0x0(%rax)\n   0x0000000000400cd0 &lt;+96&gt;:    mov    0x2013e2(%rip),%eax        # 0x6020b8 &lt;lock&gt;\n   0x0000000000400cd6 &lt;+102&gt;:   test   %eax,%eax\n   0x0000000000400cd8 &lt;+104&gt;:   je     0x400cc0 &lt;worker+80&gt;\n   0x0000000000400cda &lt;+106&gt;:   nop\n   0x0000000000400cdb &lt;+107&gt;:   jmp    0x400cd0 &lt;worker+96&gt;\n</code></pre>\n\n<p><br>\nWhat does the code between line <strong>96</strong> and <strong>107</strong> do?\n<br>I don't think the built-in function produce useless code, so I'd want to understand what I though in the wrong way.</p>\n\n<p><br>\nThe built-in function it works sometimes which means that it doesn't work at all!</p>\n\n<p><br>\n<br>\n<strong>UPDATE:</strong></p>\n\n<p>I've retested the implementation with the builtin and it works.</p>\n\n<p><br>\nHow should I procede?</p>\n"}, {"tags": ["c", "structure"], "comments": [{"owner": {"reputation": 310760, "user_id": 12711, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c330bdee507c95c603a93ca91d9145a9?s=128&d=identicon&r=PG", "display_name": "Michael Burr", "link": "https://stackoverflow.com/users/12711/michael-burr"}, "edited": false, "score": 3, "creation_date": 1458136028, "post_id": 36037332, "comment_id": 59724201, "body": "You can use the <code>offsetof()</code> macro in a test program to see how the compiler layouts various structures.  Note that the specific details  technically are implementation dependent. For example, you may see differences depending on whether <code>long</code> is a 64 bit type or a 32-bit type."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1458136032, "post_id": 36037332, "comment_id": 59724207, "body": "<code>var1</code> is just another member inside the structure <code>tag1</code>., and is just like <code>a</code> in the same structure. That <code>var1</code> is a structure doesn&#39;t really matter. So of you want to do a &quot;memory layout example&quot; for the second example with the nested structure, just place the nested structure where <code>var1</code> is just like you placed <code>b</code> in the first example, with the difference being that you have <code>long var1.b</code> instead."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 2, "creation_date": 1458136664, "post_id": 36037332, "comment_id": 59724776, "body": "Just apply the rules recursively."}, {"owner": {"reputation": 615, "user_id": 3845853, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/88940dcd987189687693481451b946bb?s=128&d=identicon&r=PG&f=1", "display_name": "sakthi", "link": "https://stackoverflow.com/users/3845853/sakthi"}, "edited": false, "score": 0, "creation_date": 1458136674, "post_id": 36037332, "comment_id": 59724788, "body": "Thank you sir. The size of the structure is 16 bytes in gcc. Explain me sir."}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 1, "creation_date": 1458136850, "post_id": 36037332, "comment_id": 59724949, "body": "The size of the struct includes the size of each member <i>and</i> alignment padding.  and as implied in other comments, padding can be affected by how you set up your compiler.  (with pragma pack macro)"}], "answers": [{"tags": [], "owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "is_accepted": false, "score": 6, "last_activity_date": 1458330883, "last_edit_date": 1495541728, "creation_date": 1458138907, "answer_id": 36038749, "question_id": 36037332, "link": "https://stackoverflow.com/questions/36037332/memory-layout-for-nested-structure-in-c/36038749#36038749", "title": "Memory layout for nested structure in c", "body": "<p>As noted in comments, the exact layout of a struct in memory is implementation specific.  Also generally true, layout is affected by member types, memory addressing (32bit or 64bit) and <code>pragma pack</code> calls that adjust the way alignment occurs along memory boundaries.  </p>\n\n<p><strong><em>An example</em></strong> of what I see on my system when I place two instances of your original struct as sub-struct members into yet another struct (for context, and to force contiguous memory assignment), then assigned values to an instance of that struct to provide distinguishable (non-zero) content in the memory layout:<br>\n(32bit addressing, with no pragma statements) </p>\n\n<pre><code>typedef struct tag1{\n      int a;\n      struct tag2{\n          long b;\n      }var1;\n}var2;\n\ntypedef struct {\n    var2 s1;\n    var2 s2;\n}S;\n</code></pre>\n\n<p>In main:</p>\n\n<pre><code> S x = {0};\n\n  x.s1.a = 1;\n  x.s1.var1.b = 2;\n  x.s2.a = 3;\n  x.s2.var1.b = 4;\n</code></pre>\n\n<p>Memory for <code>struct S</code> depicted on first line of image:</p>\n\n<p><a href=\"https://i.stack.imgur.com/lahFn.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/lahFn.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Note there is no additional memory usage required <em>directly</em> due to the struct or even sub-struct constructs. But <em>indirectly</em>, there can be (and often will be) additional memory required for <em><a href=\"https://en.wikipedia.org/wiki/Data_structure_alignment\" rel=\"nofollow noreferrer\">alignment padding</a></em>.  This occurs when data types contained in the struct definition are of differing sizes and do not align naturally along addressing boundaries.  When this occurs, padding <em>will</em> effect the computed <code>sizeof</code> a <code>struct</code>.</p>\n\n<p>You can see that the size of each instance of your original struct is 8, (16 for two instances) and because <code>int</code> and <code>long</code> both align perfectly (and are the same size) in this instance, there appears to be no padding.  If<code>long</code> were replaced with <code>long long</code> this would no longer be the case.  Padding would almost certainly be required.</p>\n\n<p>To provide context for the information below, relevant data sizes on my machine (compiled for 32bit) are:</p>\n\n<pre><code>int sizeChar = sizeof(char);     //1 (always)\nint sizeInt  = sizeof(int);      //4\nint sizeLong = sizeof(long);     //4\nint sizeLL   = sizeof(long long);//8\n</code></pre>\n\n<p>There will be more visible evidence of padding and the effects of pragma using a wider range of types.  The following struct contains 4 data types:</p>\n\n<pre><code> typedef struct tag1 {\n      char a;\n      int b;\n      long c;\n      long long d;\n  }var1;\n</code></pre>\n\n<p>Using this struct definition, it is interesting to view the difference in padding caused by using <code>pragma pack</code> calls.  On my machine, and compiling for 32bit memory mapping, here is what I see:</p>\n\n<p><a href=\"https://i.stack.imgur.com/JxmvT.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/JxmvT.jpg\" alt=\"enter image description here\"></a>  </p>\n\n<p>By the way, there is a discussion <em><a href=\"https://stackoverflow.com/q/26568630/645128\">here</a></em> covering related points in this topic.</p>\n"}, {"tags": [], "owner": {"reputation": 105, "user_id": 3541425, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/1UCN7.png?s=128&g=1", "display_name": "Kumar2080", "link": "https://stackoverflow.com/users/3541425/kumar2080"}, "is_accepted": false, "score": 2, "last_activity_date": 1458156658, "creation_date": 1458156658, "answer_id": 36045286, "question_id": 36037332, "link": "https://stackoverflow.com/questions/36037332/memory-layout-for-nested-structure-in-c/36045286#36045286", "title": "Memory layout for nested structure in c", "body": "<p><strong>How the nested structure is stored in memory?</strong></p>\n\n<pre><code>struct tag1{\n      int a;\n      struct tag2{\n          long b;\n      }var1;\n  }var2;\n</code></pre>\n\n<p>First of all you need to check the machine word size (i.e either 32-bit/64-bit) &amp; on which gcc compiler is installed. Depending upon the architectures, the variables memory allocation will be varying.\n<strong>sizeof</strong> operator will return the variables size according to system specific. </p>\n\n<p>For example(with padding) variables stored in memory</p>\n\n<p>in 32-bit machines int &amp; long both are allocating 4-bytes. </p>\n\n<p>|var2.var1.b|==>0x601058</p>\n\n<p>|   var2.a  |==>0x601054</p>\n\n<p>in 64-bit machines int allocates 4-bytes &amp; long allocates 8-bytes.</p>\n\n<p>|var2.var1.b|==>0x601058</p>\n\n<p>|   var2.a  |==>0x601050</p>\n\n<p>Memory alignment of structure members is explained here <a href=\"https://wr.informatik.uni-hamburg.de/_media/teaching/wintersemester_2013_2014/epc-14-haase-svenhendrik-alignmentinc-paper.pdf\" rel=\"nofollow\">Alignment in c</a></p>\n"}, {"tags": [], "owner": {"reputation": 11698, "user_id": 5399734, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2162d669508364bb0c03aba1a2473aa8?s=128&d=identicon&r=PG&f=1", "display_name": "nalzok", "link": "https://stackoverflow.com/users/5399734/nalzok"}, "is_accepted": false, "score": 0, "last_activity_date": 1458319645, "creation_date": 1458319645, "answer_id": 36089903, "question_id": 36037332, "link": "https://stackoverflow.com/questions/36037332/memory-layout-for-nested-structure-in-c/36089903#36089903", "title": "Memory layout for nested structure in c", "body": "<p>To figure out how the nested structure is stored in memory, you can run the code below:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;limits.h&gt;\n#include &lt;stddef.h&gt;\n\nstruct tag1{\n    int a;\n    struct tag2{\n        long b;\n    } var1;\n} var2;\n\nint main(void){\n    printf(\"CHAR_BIT is\\t\\t\\t\\t%d\\n\", CHAR_BIT);\n    puts(\"\");\n    printf(\"sizeof var2 is\\t\\t\\t\\t%zu\\n\", sizeof var2);\n    printf(\"sizeof var2.var1 is\\t\\t\\t%zu\\n\", sizeof var2.var1);\n    printf(\"sizeof var2.var1.b is\\t\\t\\t%zu\\n\", sizeof var2.var1.b);\n    puts(\"\");\n    printf(\"offsetof(struct tag1, a) is\\t\\t%zu\\n\", offsetof(struct tag1, a));\n    printf(\"offsetof(struct tag1, var1) is\\t\\t%zu\\n\", offsetof(struct tag1, var1));\n    printf(\"offsetof(struct tag1, var1.b) is\\t%zu\\n\", offsetof(struct tag1, var1.b));\n    printf(\"offsetof(struct tag2, b) is\\t\\t%zu\\n\", offsetof(struct tag2, b));\n    return 0;\n}\n</code></pre>\n\n<p>I'm asking you to run this code on your implementation, rather than giving you an direct answer, because:</p>\n\n<ol>\n<li>sizeof T is implementation-define. What if you have <code>sizeof (long) == 1</code> and <code>CHAR_BIT == 32</code>?</li>\n<li>There might be padding bits/bytes in a struct.</li>\n<li>Other factors. For example, the use of <code>#pragma pack(n)</code></li>\n</ol>\n\n<p>On my implementation (clang under OS X), the output is:</p>\n\n<pre><code>CHAR_BIT is             8\n\nsizeof var2 is              16\nsizeof var2.var1 is         8\nsizeof var2.var1.b is           8\n\noffsetof(struct tag1, a) is     0\noffsetof(struct tag1, var1) is      8\noffsetof(struct tag1, var1.b) is    8\noffsetof(struct tag2, b) is     0\n</code></pre>\n\n<p>Well, it does not seem neat here, but it's nicely-formatted when showing up on my screen.</p>\n\n<p>So (for my implementation) the memory layout of <code>struct tag1</code> will be like this:</p>\n\n<pre><code> -----------------------\n|  |  |  |  |  |  |  |  | ---&gt; int a (8 bytes are used)\n -----------------------\n|  |  |  |  |  |  |  |  | ---&gt; struct tag2 / long b (8 bytes are used)\n -----------------------\n</code></pre>\n"}], "owner": {"reputation": 615, "user_id": 3845853, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/88940dcd987189687693481451b946bb?s=128&d=identicon&r=PG&f=1", "display_name": "sakthi", "link": "https://stackoverflow.com/users/3845853/sakthi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1966, "favorite_count": 0, "answer_count": 3, "score": 8, "last_activity_date": 1458330883, "creation_date": 1458135541, "last_edit_date": 1458215612, "question_id": 36037332, "link": "https://stackoverflow.com/questions/36037332/memory-layout-for-nested-structure-in-c", "title": "Memory layout for nested structure in c", "body": "<p>I understand the structure's concept in C. I also understand how the structure is stored in memory. So I have created follwoing stuff:</p>\n\n<pre><code>  struct tag1 {\n      char a;\n      int b;\n  }var1;\n</code></pre>\n\n<p>The size of the structure is 8 bytes(in gcc).</p>\n\n<p>Memory layout example.</p>\n\n<pre><code> -----------\n|  |  |  |  | ---&gt; char a (only 1 byte is used and remaining 3 bytes are padding)\n -----------\n|  |  |  |  | ---&gt; int b (4 byte is used)\n -----------\n</code></pre>\n\n<p>Now i have some doubt in this sample program. How the nested structure is    stored in memory.</p>\n\n<pre><code>  struct tag1{\n      int a;\n      struct tag2{\n          long b;\n      }var1;\n  }var2;\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1458136485, "post_id": 36037200, "comment_id": 59724613, "body": "Please show a <a href=\"http://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable example</a>."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1458137215, "post_id": 36037200, "comment_id": 59725251, "body": "<code>getfield()</code> may return <code>NULL</code>.  Need to test for that before calling <code>atof()</code>."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6052523, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c615f4aff39c814fdc1642ca91d1a15?s=128&d=identicon&r=PG&f=1", "display_name": "night hunter", "link": "https://stackoverflow.com/users/6052523/night-hunter"}, "edited": false, "score": 0, "creation_date": 1458135707, "post_id": 36037293, "comment_id": 59723923, "body": "still getting a segfault :("}, {"owner": {"reputation": 1, "user_id": 6052523, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c615f4aff39c814fdc1642ca91d1a15?s=128&d=identicon&r=PG&f=1", "display_name": "night hunter", "link": "https://stackoverflow.com/users/6052523/night-hunter"}, "edited": false, "score": 0, "creation_date": 1458135843, "post_id": 36037293, "comment_id": 59724032, "body": "shouldn&#39;t be initialization  automatically  ?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 1, "user_id": 6052523, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c615f4aff39c814fdc1642ca91d1a15?s=128&d=identicon&r=PG&f=1", "display_name": "night hunter", "link": "https://stackoverflow.com/users/6052523/night-hunter"}, "edited": false, "score": 2, "creation_date": 1458135862, "post_id": 36037293, "comment_id": 59724052, "body": "For automatic (local) variables? No."}, {"owner": {"reputation": 1, "user_id": 6052523, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c615f4aff39c814fdc1642ca91d1a15?s=128&d=identicon&r=PG&f=1", "display_name": "night hunter", "link": "https://stackoverflow.com/users/6052523/night-hunter"}, "edited": false, "score": 0, "creation_date": 1458136067, "post_id": 36037293, "comment_id": 59724239, "body": "tried initializing the variables to zero, no avail thou."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 1, "user_id": 6052523, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c615f4aff39c814fdc1642ca91d1a15?s=128&d=identicon&r=PG&f=1", "display_name": "night hunter", "link": "https://stackoverflow.com/users/6052523/night-hunter"}, "edited": false, "score": 2, "creation_date": 1458136264, "post_id": 36037293, "comment_id": 59724419, "body": "Then you have additional problems. For example you never check your file has no more than 300 lines. Also you don&#39;t check each line is correct format. You should add some error-handling. And I would avoid composite constructs negation/predecrement and the token manipulation inside the <code>for</code> statement."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 1, "user_id": 6052523, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c615f4aff39c814fdc1642ca91d1a15?s=128&d=identicon&r=PG&f=1", "display_name": "night hunter", "link": "https://stackoverflow.com/users/6052523/night-hunter"}, "edited": false, "score": 0, "creation_date": 1458136847, "post_id": 36037293, "comment_id": 59724944, "body": "I am sure there are libraries out there. Never used on though.. <code>libcsv</code> is the first google result."}], "tags": [], "owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "is_accepted": false, "score": 2, "last_activity_date": 1458135790, "last_edit_date": 1458135790, "creation_date": 1458135446, "answer_id": 36037293, "question_id": 36037200, "link": "https://stackoverflow.com/questions/36037200/parsing-csv-with-c/36037293#36037293", "title": "Parsing csv with c", "body": "<p>You never initialize the variable <code>ver</code>. For example you might want to change </p>\n\n<pre><code>for (int ver; ver&lt;20;ver++)\n</code></pre>\n\n<p>to </p>\n\n<pre><code>for (int ver=0; ver&lt;20;ver++)\n</code></pre>\n\n<p><strong>Update</strong> The same with <code>horz</code>..</p>\n"}], "owner": {"reputation": 1, "user_id": 6052523, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c615f4aff39c814fdc1642ca91d1a15?s=128&d=identicon&r=PG&f=1", "display_name": "night hunter", "link": "https://stackoverflow.com/users/6052523/night-hunter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 406, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1458135790, "creation_date": 1458135196, "question_id": 36037200, "link": "https://stackoverflow.com/questions/36037200/parsing-csv-with-c", "title": "Parsing csv with c", "body": "<p>I have the following to parse a csv file, and it works fine until i changed      </p>\n\n<pre><code>(getfield(tmp, 12));\n</code></pre>\n\n<p>to</p>\n\n<pre><code>(getfield(tmp, ver));\n</code></pre>\n\n<p>Is the problem in function declaration   ?</p>\n\n<p>here is the code :   </p>\n\n<pre><code>const char* getfield(char* line, int num)\n{\n    const char* tok;\n    for (tok = strtok(line, \";\");\n            tok &amp;&amp; *tok;\n            tok = strtok(NULL, \";\\n\"))\n    {\n        if (!--num)\n            return tok;\n    }\n    return NULL;\n}\nint main() {\n    double frame_index[40][300];\n    int horz;\n    FILE* fp = fopen(\"output.txt\", \"r\");\n    char line[1024];\n\n        for (int ver; ver&lt;20;ver++) {\n            while (fgets(line, 1024, fp))  {\n                char* tmp = strdup(line);\n                frame_index[ver][horz] = atof(getfield(tmp, ver));  \n                // works if \"ver\" was explicitly defined\n                printf(\"AA %f\\n\", frame_index[ver][horz]);\n                free(tmp);\n                horz++;     \n        }   \n         rewind(fp);\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "string"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1458134623, "post_id": 36036864, "comment_id": 59722919, "body": "Not related, but you are missing <code>#include &lt;stdio.h&gt;</code>. Compile with all warnings enabled."}, {"owner": {"reputation": 27385, "user_id": 1382251, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/17622c39e8ead537a0944c767551b2fe?s=128&d=identicon&r=PG", "display_name": "barak manos", "link": "https://stackoverflow.com/users/1382251/barak-manos"}, "edited": false, "score": 1, "creation_date": 1458134739, "post_id": 36036864, "comment_id": 59723035, "body": "Change <code>i &lt;= strlen(str)</code> to <code>i &lt; strlen(str)</code> and add the null character at the end of each word."}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 0, "creation_date": 1458134950, "post_id": 36036864, "comment_id": 59723248, "body": "Or better yet, don&#39;t call <code>strlen</code> of the constant source string in the loop. Check for the termonating null char: <code>for (i = 0; str[i] ; i++)</code>."}], "answers": [{"comments": [{"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "reply_to_user": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "edited": false, "score": 1, "creation_date": 1458134853, "post_id": 36036969, "comment_id": 59723142, "body": "@DevSolar: Why not? It sets all chars to null and provided the string doesn&#39;t overflow (which the OP doesn&#39;t check) will leave a proper null-terminated string."}, {"owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "reply_to_user": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 0, "creation_date": 1458134958, "post_id": 36036969, "comment_id": 59723258, "body": "@MOehm: That &quot;and all the remaining elements&quot; zero initialization keeps getting me on the wrong foot. Comment deleted, downvote retracted."}], "tags": [], "owner": {"reputation": 1761, "user_id": 2641959, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/4c6d8336fe8a675f9f20f519faec5fc0?s=128&d=identicon&r=PG&f=1", "display_name": "Mohan", "link": "https://stackoverflow.com/users/2641959/mohan"}, "is_accepted": false, "score": 1, "last_activity_date": 1458135494, "last_edit_date": 1458135494, "creation_date": 1458134573, "answer_id": 36036969, "question_id": 36036864, "link": "https://stackoverflow.com/questions/36036864/making-2-words-uppercase-and-lowercase-from-1-word/36036969#36036969", "title": "Making 2 words (uppercase and lowercase) from 1 word", "body": "<p>This happen because of not doing null termination so ,\nDo initialization for </p>\n\n<pre><code> char smallStr[SIZE] = {0} , bigStr[SIZE] = {0}; \n</code></pre>\n\n<p><strong>or</strong> </p>\n\n<p>Do the null termination after loop completed at end of loop do </p>\n\n<pre><code>smallStr[ countsmall ] = '\\0';\nbigStr[ countbig ] = '\\0';\n</code></pre>\n\n<p>You will get correct result. </p>\n"}, {"tags": [], "owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "is_accepted": false, "score": 3, "last_activity_date": 1458134622, "creation_date": 1458134622, "answer_id": 36036991, "question_id": 36036864, "link": "https://stackoverflow.com/questions/36036864/making-2-words-uppercase-and-lowercase-from-1-word/36036991#36036991", "title": "Making 2 words (uppercase and lowercase) from 1 word", "body": "<pre><code>puts( smallStr );\n</code></pre>\n\n<p>This keeps on writing whatever <code>smallStr</code> is pointing to, until it hits a null byte (<code>'\\0'</code>).</p>\n\n<p>You never write a null byte into either <code>smallStr</code> or <code>bigStr</code>, so you see the garbled output you are observing. (Be happy the program did not crash, as it is accessing memory it should not.)</p>\n\n<p>At the end of the loop, terminate the strings:</p>\n\n<pre><code>smallStr[ countsmall ] = '\\0';\nbigStr[ countbig ] = '\\0';\n</code></pre>\n\n<p>That should help.</p>\n"}, {"comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1458134778, "post_id": 36037015, "comment_id": 59723060, "body": "When answering you should indent the code correctly."}, {"owner": {"reputation": 720, "user_id": 5620762, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/N2xaP.jpg?s=128&g=1", "display_name": "Nutan", "link": "https://stackoverflow.com/users/5620762/nutan"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1458134899, "post_id": 36037015, "comment_id": 59723187, "body": "is it fine  Michael ?"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1458135387, "post_id": 36037015, "comment_id": 59723639, "body": "It&#39;s fine now, except the last line where the <code>}</code> is not aligned correctly. Also the indent size is not constant.  Remember, consistent formatting of your code is most important for readability."}], "tags": [], "owner": {"reputation": 720, "user_id": 5620762, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/N2xaP.jpg?s=128&g=1", "display_name": "Nutan", "link": "https://stackoverflow.com/users/5620762/nutan"}, "is_accepted": false, "score": 1, "last_activity_date": 1458134786, "last_edit_date": 1458134786, "creation_date": 1458134690, "answer_id": 36037015, "question_id": 36036864, "link": "https://stackoverflow.com/questions/36036864/making-2-words-uppercase-and-lowercase-from-1-word/36037015#36037015", "title": "Making 2 words (uppercase and lowercase) from 1 word", "body": "<p>Try this code </p>\n\n<pre><code>   #include &lt;stdlib.h&gt;\n   #include &lt;string.h&gt;\n   #define SIZE 10\n\n    int main()\n    {\n         int i = 0;\n         int countbig = 0 , countsmall = 0;\n         char str[] = \"SHaddOW\";\n         char smallStr[SIZE] , bigStr[SIZE]; \n         for (i = 0; i &lt; strlen(str) ; i++)\n         {\n             if (str[i]&gt;= 'A' &amp;&amp; str[i]&lt;='Z')\n             {\n               bigStr[countbig] = str[i];\n               countbig++;\n             }\n             else if (str[i] &gt;= 'a' &amp;&amp; str[i] &lt;= 'z')\n             {\n              smallStr[countsmall] = str[i];\n              countsmall++;\n             }\n         }\n         bigStr[countbig]='\\0';\n         smallStr[countsmall] = '\\0';\n\n         puts(smallStr);\n         puts(bigStr);\n         system(\"PAUSE\");\n         return 0;\n  }\n</code></pre>\n\n<p>You should add <code>\\0</code> to end the string and only travel till <code>i</code> is less than length of the string.</p>\n"}, {"tags": [], "owner": {"reputation": 401, "user_id": 4377391, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Nk8IR.jpg?s=128&g=1", "display_name": "rabi shaw", "link": "https://stackoverflow.com/users/4377391/rabi-shaw"}, "is_accepted": false, "score": 0, "last_activity_date": 1458134768, "creation_date": 1458134768, "answer_id": 36037035, "question_id": 36036864, "link": "https://stackoverflow.com/questions/36036864/making-2-words-uppercase-and-lowercase-from-1-word/36037035#36037035", "title": "Making 2 words (uppercase and lowercase) from 1 word", "body": "<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#define SIZE 10\n\nint main()\n{\n    int i = 0;\n    int countbig = 0 , countsmall = 0;\n    char str[] = \"SHaddOW\";\n    char smallStr[SIZE] , bigStr[SIZE]; \n    for (i = 0; i &lt;= strlen(str) ; i++)\n    {\n        if (str[i]&gt;= 'A' &amp;&amp; str[i]&lt;='Z')\n        {\n            bigStr[countbig] = str[i];\n            countbig++;\n        }\n        if (str[i] &gt;= 'a' &amp;&amp; str[i] &lt;= 'z')\n        {\n            smallStr[countsmall] = str[i];\n            countsmall++;\n        }\n    }\n        bigStr[countbig] ='\\0'; //you need to add null character at the end \n        smallStr[countsmall] = '\\0';//you need to add null character at the end\n    puts(smallStr);\n    puts(bigStr);\n    system(\"PAUSE\");\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 5798202, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/f098e65e8e1e88e034008000cc3ad65d?s=128&d=identicon&r=PG&f=1", "display_name": "danielwinzard", "link": "https://stackoverflow.com/users/5798202/danielwinzard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1458635183, "creation_date": 1458134309, "last_edit_date": 1458635183, "question_id": 36036864, "link": "https://stackoverflow.com/questions/36036864/making-2-words-uppercase-and-lowercase-from-1-word", "title": "Making 2 words (uppercase and lowercase) from 1 word", "body": "<p>I did a program which gets the word <strong>\"SHaddOW\"</strong> and dividing it to 2 words: <code>SHOW</code> and <code>add</code>.</p>\n\n<p>That is one word of uppercase characters and the other word of lowercase chars. But I have some problem when I'm running the program.</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#define SIZE 10\n\nint main()\n{\n    int i = 0;\n    int countbig = 0 , countsmall = 0;\n    char str[] = \"SHaddOW\";\n    char smallStr[SIZE] , bigStr[SIZE]; \n    for (i = 0; i &lt;= strlen(str) ; i++)\n    {\n        if (str[i]&gt;= 'A' &amp;&amp; str[i]&lt;='Z')\n        {\n            bigStr[countbig] = str[i];\n            countbig++;\n        }\n        else if (str[i] &gt;= 'a' &amp;&amp; str[i] &lt;= 'z')\n        {\n            smallStr[countsmall] = str[i];\n            countsmall++;\n        }\n    }\n    puts(smallStr);\n    puts(bigStr);\n    system(\"PAUSE\");\n    return 0;\n}\n</code></pre>\n\n<p>When I'm running the program its showing that:</p>\n\n<p><a href=\"https://i.stack.imgur.com/ymcae.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ymcae.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["c", "arrays", "gcc"], "comments": [{"owner": {"reputation": 47569, "user_id": 3255455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5993e7ece129141878cd6419d39cc26e?s=128&d=identicon&r=PG&f=1", "display_name": "gnasher729", "link": "https://stackoverflow.com/users/3255455/gnasher729"}, "edited": false, "score": 0, "creation_date": 1458134078, "post_id": 36036715, "comment_id": 59722448, "body": "One cell? I see zero cells."}, {"owner": {"reputation": 27069, "user_id": 2307070, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/l8ha6.jpg?s=128&g=1", "display_name": "Thomas Ayoub", "link": "https://stackoverflow.com/users/2307070/thomas-ayoub"}, "edited": false, "score": 2, "creation_date": 1458134082, "post_id": 36036715, "comment_id": 59722452, "body": "<i>array of one cell</i> =&gt; Where?"}, {"owner": {"reputation": 1347, "user_id": 3952386, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/80b567d762b8c3a4ce0aa57db32a3430?s=128&d=identicon&r=PG&f=1", "display_name": "craken", "link": "https://stackoverflow.com/users/3952386/craken"}, "edited": false, "score": 0, "creation_date": 1458134213, "post_id": 36036715, "comment_id": 59722554, "body": "ok. SO, why i can use ts_factory.reserved[0]=12; for example. And i can use this cell. The compiler affect the value with no error."}, {"owner": {"reputation": 6196, "user_id": 5822075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1ba9afcd0c36d9685e3e1b5f2f82be2?s=128&d=identicon&r=PG&f=1", "display_name": "e0k", "link": "https://stackoverflow.com/users/5822075/e0k"}, "edited": false, "score": 0, "creation_date": 1458134224, "post_id": 36036715, "comment_id": 59722562, "body": "In <code>uint8_t reserved[0]</code>, the <code>0</code> is not the index of the last element, but the size of the array.  If you assign <code>reserved[0] = 12</code>, you are referring to the element with index <code>0</code>.  In a <i>declaration</i>, the number given is the size of the array, not an index. For example, a declaration <code>uint8_t a[10]</code> would have 10 elements, but <code>a[10]</code> would be an invalid index since the array is indexed from 0 through 9 (10 elements)."}, {"owner": {"reputation": 1347, "user_id": 3952386, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/80b567d762b8c3a4ce0aa57db32a3430?s=128&d=identicon&r=PG&f=1", "display_name": "craken", "link": "https://stackoverflow.com/users/3952386/craken"}, "edited": false, "score": 0, "creation_date": 1458134461, "post_id": 36036715, "comment_id": 59722770, "body": "If you say that the array don&#39;t have any cell and his size is size . HOw can i access on cell with index 0 . It should be compiler error . no ?"}, {"owner": {"reputation": 6196, "user_id": 5822075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1ba9afcd0c36d9685e3e1b5f2f82be2?s=128&d=identicon&r=PG&f=1", "display_name": "e0k", "link": "https://stackoverflow.com/users/5822075/e0k"}, "edited": false, "score": 0, "creation_date": 1458134474, "post_id": 36036715, "comment_id": 59722784, "body": "The compiler will not complain if you try to index an array out of the range of memory allocated for it. It will happily perform undefined behaviour. It is your responsibility to make sure you don&#39;t access beyond its range."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1458134519, "post_id": 36036715, "comment_id": 59722832, "body": "<i>SO, why i can use ts_factory.reserved[0]=12;</i>: because in C no out of bounds control is done. <code>ts_factory.reserved[0]=12</code> is undefined behaviour."}, {"owner": {"reputation": 1347, "user_id": 3952386, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/80b567d762b8c3a4ce0aa57db32a3430?s=128&d=identicon&r=PG&f=1", "display_name": "craken", "link": "https://stackoverflow.com/users/3952386/craken"}, "edited": false, "score": 0, "creation_date": 1458134739, "post_id": 36036715, "comment_id": 59723034, "body": "If this undefined behavior. So, i should see a garbage value if i do ts_factory.reserved[0]=12. But when i do printf is can receive the correct 12 value. More explanation please"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1458134869, "post_id": 36036715, "comment_id": 59723161, "body": "@MarwenBkh &quot;undefined behaviour&quot; means &quot;undefined behaviour&quot;, it doesn&#39;t mean &quot;displays garbage&quot;."}, {"owner": {"reputation": 1347, "user_id": 3952386, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/80b567d762b8c3a4ce0aa57db32a3430?s=128&d=identicon&r=PG&f=1", "display_name": "craken", "link": "https://stackoverflow.com/users/3952386/craken"}, "edited": false, "score": 0, "creation_date": 1458135064, "post_id": 36036715, "comment_id": 59723354, "body": "What&#39;s mean undefined behavior ?"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1458135089, "post_id": 36036715, "comment_id": 59723373, "body": "@MarwenBkh following may happen: <code>factory.reserved[0]=12</code> puts 12 in a memory location that does not belong to your array but belongs to something else. Then you read <code>factory.reserved[0]</code> and you find 12, this is very likely to happen, but in the meantime you have overwritten memory that does not belong to the array, which can have all kinds of nasty consequences, but you also may get away with it. You may get away with it on platform A, but you may get a crash on platform B, and may on platform C you get away with it 100 times and the 101th time you get a crash. Google &quot;undefined behaviour&quot;."}, {"owner": {"reputation": 1347, "user_id": 3952386, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/80b567d762b8c3a4ce0aa57db32a3430?s=128&d=identicon&r=PG&f=1", "display_name": "craken", "link": "https://stackoverflow.com/users/3952386/craken"}, "edited": false, "score": 0, "creation_date": 1458135365, "post_id": 36036715, "comment_id": 59723624, "body": "&quot;you find 12, this is very likely to happen ... &quot;. I run my code many times, and i always find the 12 value !"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1458136631, "post_id": 36036715, "comment_id": 59724747, "body": "@MarwenBkh sigh... it&#39;s <b>undefined behaviour</b>. maybe on <i>your</i> platform it works every time by chance, but on another platform it may not work at all or crash the program or...."}, {"owner": {"reputation": 1347, "user_id": 3952386, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/80b567d762b8c3a4ce0aa57db32a3430?s=128&d=identicon&r=PG&f=1", "display_name": "craken", "link": "https://stackoverflow.com/users/3952386/craken"}, "edited": false, "score": 0, "creation_date": 1458136809, "post_id": 36036715, "comment_id": 59724910, "body": "OK. I will keep this in mind but not convinced yet."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1458137204, "post_id": 36036715, "comment_id": 59725241, "body": "Zero-sized arrays are an obsolete and deprecated gcc extension. The C standard introduced <i>flexible array members</i> with ISO9899:1999 (C99). Use them!"}], "answers": [{"tags": [], "owner": {"reputation": 36141, "user_id": 4354477, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/SuxtS.gif?s=128&g=1", "display_name": "ForceBru", "link": "https://stackoverflow.com/users/4354477/forcebru"}, "is_accepted": false, "score": 2, "last_activity_date": 1458134026, "creation_date": 1458134026, "answer_id": 36036745, "question_id": 36036715, "link": "https://stackoverflow.com/questions/36036715/c-programming-sizeof-an-array/36036745#36036745", "title": "C programming - Sizeof an array", "body": "<p>The compiler is correct: you've got an array of size <em>zero</em> (<code>uint8_t reserved[0]</code>) as the only member of your struct, so <code>sizeof</code> gives you zero. Why allocate memory for a zero-sized object?</p>\n"}, {"tags": [], "owner": {"reputation": 401, "user_id": 4377391, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Nk8IR.jpg?s=128&g=1", "display_name": "rabi shaw", "link": "https://stackoverflow.com/users/4377391/rabi-shaw"}, "is_accepted": false, "score": 4, "last_activity_date": 1458134792, "last_edit_date": 1458134792, "creation_date": 1458134202, "answer_id": 36036807, "question_id": 36036715, "link": "https://stackoverflow.com/questions/36036715/c-programming-sizeof-an-array/36036807#36036807", "title": "C programming - Sizeof an array", "body": "<p><code>uint8_t reserved[0];</code> It is an array of size <code>0</code></p>\n\n<p>so the sizeof will be zero.</p>\n"}, {"comments": [{"owner": {"reputation": 1347, "user_id": 3952386, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/80b567d762b8c3a4ce0aa57db32a3430?s=128&d=identicon&r=PG&f=1", "display_name": "craken", "link": "https://stackoverflow.com/users/3952386/craken"}, "edited": false, "score": 0, "creation_date": 1458135463, "post_id": 36036930, "comment_id": 59723700, "body": "Yes. I know this . But i wan to understand, why the compiler accept the association of a value for an array index otherwise is not allocated for it and i can see the value associated correctly."}, {"owner": {"reputation": 1388, "user_id": 5837095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/I7CdJ.png?s=128&g=1", "display_name": "Embedded C", "link": "https://stackoverflow.com/users/5837095/embedded-c"}, "reply_to_user": {"reputation": 1347, "user_id": 3952386, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/80b567d762b8c3a4ce0aa57db32a3430?s=128&d=identicon&r=PG&f=1", "display_name": "craken", "link": "https://stackoverflow.com/users/3952386/craken"}, "edited": false, "score": 0, "creation_date": 1458136280, "post_id": 36036930, "comment_id": 59724436, "body": "@MarwenBkh updated my answer hope it helps"}, {"owner": {"reputation": 1347, "user_id": 3952386, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/80b567d762b8c3a4ce0aa57db32a3430?s=128&d=identicon&r=PG&f=1", "display_name": "craken", "link": "https://stackoverflow.com/users/3952386/craken"}, "edited": false, "score": 0, "creation_date": 1458136668, "post_id": 36036930, "comment_id": 59724779, "body": "I you say that reserved[0] =10 is illegal. You should try it first because the compiler accept it and display correctly his associated value."}, {"owner": {"reputation": 1388, "user_id": 5837095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/I7CdJ.png?s=128&g=1", "display_name": "Embedded C", "link": "https://stackoverflow.com/users/5837095/embedded-c"}, "reply_to_user": {"reputation": 1347, "user_id": 3952386, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/80b567d762b8c3a4ce0aa57db32a3430?s=128&d=identicon&r=PG&f=1", "display_name": "craken", "link": "https://stackoverflow.com/users/3952386/craken"}, "edited": false, "score": 1, "creation_date": 1458137109, "post_id": 36036930, "comment_id": 59725166, "body": "@MarwenBkh my compiler does not accept it. you can <a href=\"http://codepad.org/yuRUsoEA\" rel=\"nofollow noreferrer\">codepad.org/yuRUsoEA</a> check this"}, {"owner": {"reputation": 1347, "user_id": 3952386, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/80b567d762b8c3a4ce0aa57db32a3430?s=128&d=identicon&r=PG&f=1", "display_name": "craken", "link": "https://stackoverflow.com/users/3952386/craken"}, "edited": false, "score": 0, "creation_date": 1458137481, "post_id": 36036930, "comment_id": 59725475, "body": "Thanks for your help. I should try my code on a differents gcc version on different machine."}, {"owner": {"reputation": 1388, "user_id": 5837095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/I7CdJ.png?s=128&g=1", "display_name": "Embedded C", "link": "https://stackoverflow.com/users/5837095/embedded-c"}, "reply_to_user": {"reputation": 1347, "user_id": 3952386, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/80b567d762b8c3a4ce0aa57db32a3430?s=128&d=identicon&r=PG&f=1", "display_name": "craken", "link": "https://stackoverflow.com/users/3952386/craken"}, "edited": false, "score": 0, "creation_date": 1458137912, "post_id": 36036930, "comment_id": 59725821, "body": "You are welcome @MarwenBkh"}], "tags": [], "owner": {"reputation": 1388, "user_id": 5837095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/I7CdJ.png?s=128&g=1", "display_name": "Embedded C", "link": "https://stackoverflow.com/users/5837095/embedded-c"}, "is_accepted": true, "score": 2, "last_activity_date": 1458136256, "last_edit_date": 1458136256, "creation_date": 1458134484, "answer_id": 36036930, "question_id": 36036715, "link": "https://stackoverflow.com/questions/36036715/c-programming-sizeof-an-array/36036930#36036930", "title": "C programming - Sizeof an array", "body": "<p>The compiler is correct as the size of the array is <code>0</code>, you need to change the size of the array in your code as much you need.<br>\n<code>uint8_t reserved[N];</code> <br>\n<code>N</code> is size of array you need.<br></p>\n\n<blockquote>\n  <p><strong>How compiler accepted this:</strong> Everything has a unique identity, i.e. a unique address, which implies a non-zero length.It is legal to\n  allocate a zero-sized array. You simply can't do anything useful with\n  it since there is no valid data for you to access.But <code>reserved[0] =\n  10;</code> is illegal.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "is_accepted": false, "score": 1, "last_activity_date": 1458134923, "creation_date": 1458134923, "answer_id": 36037089, "question_id": 36036715, "link": "https://stackoverflow.com/questions/36036715/c-programming-sizeof-an-array/36037089#36037089", "title": "C programming - Sizeof an array", "body": "<p>It's a gcc extension, and invalid in standard C since 1999.</p>\n\n<p>Look at <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Zero-Length.html\" rel=\"nofollow\">https://gcc.gnu.org/onlinedocs/gcc/Zero-Length.html</a></p>\n\n<p>It was a hack that existed in 1989 standard C, and in earlier (pre-standard) C.   Which is probably the reason gcc supports it as an extension.</p>\n"}], "owner": {"reputation": 1347, "user_id": 3952386, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/80b567d762b8c3a4ce0aa57db32a3430?s=128&d=identicon&r=PG&f=1", "display_name": "craken", "link": "https://stackoverflow.com/users/3952386/craken"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 129, "favorite_count": 0, "closed_date": 1458201765, "accepted_answer_id": 36036930, "answer_count": 4, "score": -2, "last_activity_date": 1458201823, "creation_date": 1458133955, "last_edit_date": 1458201823, "question_id": 36036715, "link": "https://stackoverflow.com/questions/36036715/c-programming-sizeof-an-array", "closed_reason": "Duplicate", "title": "C programming - Sizeof an array", "body": "<p>I have an array of zero cell and i want to dispay his size.\nmy code is:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdint.h&gt;\n\ntypedef struct ts_ff {\n\n    uint8_t reserved[0];\n} TS_fact;\n\nint main(void) {\n    TS_fact ts_factory;\n    printf(\"size of reserved is %zu Bytes\\n\",sizeof(ts_factory));\n\n   return 0;\n}\n</code></pre>\n\n<p>But the return of this code return 0 Bytes not 1 Byte for this array cell.</p>\n\n<pre><code>size of reserved is 0 Bytes\n</code></pre>\n\n<p>Why the compiler do this ?</p>\n"}, {"tags": ["c", "unions", "bit-fields"], "comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1458134485, "post_id": 36036495, "comment_id": 59722795, "body": "Declaring a bitfield within a struct with only a single range of bits is rather pointless, (e.g. <code>int d : 3;</code>, could simply be <code>int d;</code>) A bitfield allows designation of <i>multiple</i> ranges within a single <i>unsigned</i> type."}, {"owner": {"reputation": 11, "user_id": 2080699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80ef17c0a571bcc5cda4da9807e25f95?s=128&d=identicon&r=PG", "display_name": "dante", "link": "https://stackoverflow.com/users/2080699/dante"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1458146885, "post_id": 36036495, "comment_id": 59732717, "body": "@DavidC.Rankin I know there is no point in doing something like this but I am practicing for a competition where things that don&#39;t make much sense show up."}], "answers": [{"comments": [{"owner": {"reputation": 4011, "user_id": 1477064, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/cd12123a743db34ac0b055a6fa736788?s=128&d=identicon&r=PG", "display_name": "xvan", "link": "https://stackoverflow.com/users/1477064/xvan"}, "edited": false, "score": 1, "creation_date": 1458134348, "post_id": 36036737, "comment_id": 59722684, "body": "Undefined doesn&#39;t equal pointless. It&#39;s undefined behaviour because it&#39;s architecture dependant. (mostly because of endianess and memory alignment). On x86 it&#39;s perfectly predictable, can be and is used."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 4011, "user_id": 1477064, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/cd12123a743db34ac0b055a6fa736788?s=128&d=identicon&r=PG", "display_name": "xvan", "link": "https://stackoverflow.com/users/1477064/xvan"}, "edited": false, "score": 0, "creation_date": 1458134423, "post_id": 36036737, "comment_id": 59722742, "body": "@xvan: IMHO your helpful comment does have a certain legitimacy: citing the undefinedness of union read and write always attracts attention. But it&#39;s the role of the compiler to decide what to do, not the architecture. Seriously, don&#39;t risk it. The <code>memcpy</code> approach is no more complex and is the correct thing to do."}, {"owner": {"reputation": 4121, "user_id": 2098932, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/BBJGp.jpg?s=128&g=1", "display_name": "Logicrat", "link": "https://stackoverflow.com/users/2098932/logicrat"}, "reply_to_user": {"reputation": 4011, "user_id": 1477064, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/cd12123a743db34ac0b055a6fa736788?s=128&d=identicon&r=PG", "display_name": "xvan", "link": "https://stackoverflow.com/users/1477064/xvan"}, "edited": false, "score": 0, "creation_date": 1458134551, "post_id": 36036737, "comment_id": 59722852, "body": "@xvan I disagree. I learned this lesson the hard way when I ported some code from one compiler to a different compiler on the same machine and got different behavior. The issue turned out to be that the two compilers took different approaches to aligning fields within unions and structures. Both were entirely valid."}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 1, "creation_date": 1458134619, "post_id": 36036737, "comment_id": 59722916, "body": "Please provide a citation for the first paragraph. The latest standard allows type punning with certain caveats."}, {"owner": {"reputation": 4011, "user_id": 1477064, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/cd12123a743db34ac0b055a6fa736788?s=128&d=identicon&r=PG", "display_name": "xvan", "link": "https://stackoverflow.com/users/1477064/xvan"}, "reply_to_user": {"reputation": 4121, "user_id": 2098932, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/BBJGp.jpg?s=128&g=1", "display_name": "Logicrat", "link": "https://stackoverflow.com/users/2098932/logicrat"}, "edited": false, "score": 0, "creation_date": 1458135223, "post_id": 36036737, "comment_id": 59723484, "body": "@Logicrat  That shouldn&#39;t happen under C99 &lt;citation&gt;section 6.7.2.1 [...] A pointer to a union object, suitably converted, points to each of its members (or if a member is a bitfield, then to the unit in which it resides), and vice versa."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1458135500, "post_id": 36036737, "comment_id": 59723744, "body": "This accepted answer <a href=\"http://stackoverflow.com/questions/11373203/accessing-inactive-union-member-undefined-behavior\" title=\"accessing inactive union member undefined behavior\">stackoverflow.com/questions/11373203/&hellip;</a> seems informative. Note the question is tagged as C++ but the answer covers C too."}], "tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 0, "last_activity_date": 1458134011, "creation_date": 1458134011, "answer_id": 36036737, "question_id": 36036495, "link": "https://stackoverflow.com/questions/36036495/c-union-bitfields-casting/36036737#36036737", "title": "C union bitfields casting", "body": "<p>The behaviour on setting a <code>union</code> via one member and reading back a different <code>union</code> member is <em>undefined</em> in C.</p>\n\n<p>It's therefore pointless trying to analyse the behaviour in this specific case.</p>\n\n<p>You ought to rebuild using a solution based around a <code>memcpy</code>: at least then the output will be analysable.</p>\n\n<p>Also, note that <code>%zu</code> is an appropriate format specifier for a <code>sizeof</code> value: currently the <code>printf</code> behaviour is also undefined due to your using <code>%lu</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 1, "creation_date": 1458134244, "post_id": 36036792, "comment_id": 59722581, "body": "Plus one for your last sentence in particular."}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 1, "creation_date": 1458134539, "post_id": 36036792, "comment_id": 59722845, "body": "Please provide a citation for the second paragraph. The latest standard allows type punning with certain caveats."}, {"owner": {"reputation": 3107, "user_id": 3423234, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/49Nfn.gif?s=128&g=1", "display_name": "mfro", "link": "https://stackoverflow.com/users/3423234/mfro"}, "edited": false, "score": 2, "creation_date": 1458135768, "post_id": 36036792, "comment_id": 59723972, "body": "its not <i>undefined</i>, its <i>unspecified</i> (mentioned in annex J that deals with portabilty issues). <i>Unspecified</i> is later explained as <i>implementation defined</i> (which is something completely different)."}, {"owner": {"reputation": 11, "user_id": 2080699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80ef17c0a571bcc5cda4da9807e25f95?s=128&d=identicon&r=PG", "display_name": "dante", "link": "https://stackoverflow.com/users/2080699/dante"}, "edited": false, "score": 0, "creation_date": 1458147660, "post_id": 36036792, "comment_id": 59733344, "body": "What I do not understand is how is this handled in memory, and which parts are read when casting. I put 182 in x.data which in binary is 10110110. x.data, x.m and x.d give expected results to me, but why does for example (unsigned char)x.d return 254? Why doesn&#39;t it return 182 since x.data and x.d are in the same memory location and i casted x.d to be unsigned char which is same type as x.data is."}, {"owner": {"reputation": 4121, "user_id": 2098932, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/BBJGp.jpg?s=128&g=1", "display_name": "Logicrat", "link": "https://stackoverflow.com/users/2098932/logicrat"}, "reply_to_user": {"reputation": 11, "user_id": 2080699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80ef17c0a571bcc5cda4da9807e25f95?s=128&d=identicon&r=PG", "display_name": "dante", "link": "https://stackoverflow.com/users/2080699/dante"}, "edited": false, "score": 0, "creation_date": 1458151119, "post_id": 36036792, "comment_id": 59735670, "body": "@dante Because you have explicitly stated that both <code>d</code> and <code>m</code> are bitfields with only 3 bits. Therefore, your data in those fields is only the bits &#39;110&#39;. That can be interpreted as either 6 or -2 depending on whether it&#39;s signed. And if you cast it to (unsigned char), it will first be sign-extended, and then reported as an unsigned char 11111110, which in decimal is 254."}, {"owner": {"reputation": 11, "user_id": 2080699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80ef17c0a571bcc5cda4da9807e25f95?s=128&d=identicon&r=PG", "display_name": "dante", "link": "https://stackoverflow.com/users/2080699/dante"}, "edited": false, "score": 0, "creation_date": 1458152347, "post_id": 36036792, "comment_id": 59736421, "body": "@Logicrat Just one more thing, why does (unsigned char)x.m return 6, we have &#39;110&#39; so shouldn&#39;t it be extended as &#39;11111110&#39; since the first bit is 1? As well as (signed char)x.m = 6? Does this mean that sign extension isn&#39;t done by looking the first bit, rather the compiler sees that originally x.m is an unsigned char so it extends it with all zeroes? So we have 00000110 in both cases? If so could you update your answer with this info and I will accept this."}, {"owner": {"reputation": 4121, "user_id": 2098932, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/BBJGp.jpg?s=128&g=1", "display_name": "Logicrat", "link": "https://stackoverflow.com/users/2098932/logicrat"}, "reply_to_user": {"reputation": 11, "user_id": 2080699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80ef17c0a571bcc5cda4da9807e25f95?s=128&d=identicon&r=PG", "display_name": "dante", "link": "https://stackoverflow.com/users/2080699/dante"}, "edited": false, "score": 0, "creation_date": 1458159401, "post_id": 36036792, "comment_id": 59740668, "body": "@dante <code>m</code> is declared as <code>unsigned</code>, so it doesn&#39;t get sign-extended. <code>d</code> is signed, so it does."}], "tags": [], "owner": {"reputation": 4121, "user_id": 2098932, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/BBJGp.jpg?s=128&g=1", "display_name": "Logicrat", "link": "https://stackoverflow.com/users/2098932/logicrat"}, "is_accepted": true, "score": 0, "last_activity_date": 1458134154, "creation_date": 1458134154, "answer_id": 36036792, "question_id": 36036495, "link": "https://stackoverflow.com/questions/36036495/c-union-bitfields-casting/36036792#36036792", "title": "C union bitfields casting", "body": "<p><code>x.d</code> and <code>x.m</code> show no change by casting, which is to be expected. <code>x.d</code> has the same bit pattern in either case but is interpreted as -2 when it is considered signed, and 254 when those same bits are interpreted as unsigned.</p>\n\n<p>The fact that these variables are grouped in a union will save space if you read and write one variable within the union, but is undefined behavior when you write one variable and read another.</p>\n"}], "owner": {"reputation": 11, "user_id": 2080699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80ef17c0a571bcc5cda4da9807e25f95?s=128&d=identicon&r=PG", "display_name": "dante", "link": "https://stackoverflow.com/users/2080699/dante"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 181, "favorite_count": 0, "accepted_answer_id": 36036792, "answer_count": 2, "score": 0, "last_activity_date": 1458147806, "creation_date": 1458133362, "last_edit_date": 1458147806, "question_id": 36036495, "link": "https://stackoverflow.com/questions/36036495/c-union-bitfields-casting", "title": "C union bitfields casting", "body": "<p>I don't understand what happens when casting a bitfield.</p>\n\n<p>Let's say we have this union and an example:</p>\n\n<pre><code>union {\n  unsigned char data;\n  int d : 3;\n  unsigned char m : 3;\n}x;\n\nint main() {\n  x.data = 182;\n  // 182 (binary) -&gt; 1 0 1 1 0 1 1 0\n  printf(\"sizeof(x) = %lu\\n\", sizeof(x));\n  printf(\"x.data = %d\\n\", x.data);\n  printf(\"x.d = %d\\n\", x.d);\n  printf(\"x.m = %d\\n\", x.m);\n  printf(\"(unsigned char)x.d = %d\\n\", (unsigned char)x.d);\n  printf(\"(signed char)x.d = %d\\n\", (signed char)x.d);\n  printf(\"(signed char)x.m = %d\\n\", (signed char)x.m);\n  printf(\"(unsigned char)x.m = %d\\n\", (unsigned char)x.m);\n  return 0;\n}\n</code></pre>\n\n<p>This is the output:</p>\n\n<pre><code>/*\nsizeof(x) = 4\nx.data = 182\nx.d = -2\nx.m = 6\n(unsigned char)x.d = 254 //?\n(signed char)x.d = -2    //?\n(signed char)x.m = 6     //?\n(unsigned char)x.m = 6   //?\n*/\n</code></pre>\n\n<p>Now, I understand <code>x.data</code>, <code>x.d</code>, and <code>x.m</code> output, but what i don't understand is the result we get when casting.</p>\n\n<p>What does happen in memory when casting? Why do we get these results:</p>\n\n<ul>\n<li><code>(unsigned char)x.d</code> = 254</li>\n<li><code>(signed char)x.d</code> = -2</li>\n<li><code>(signed char)x.m</code> = 6</li>\n<li><code>(unsigned char)x.m</code> = 6</li>\n</ul>\n\n<p>EDIT:\nWhat I do not understand is how is this handled in memory, and which parts are read when casting. I put 182 in x.data which in binary is 10110110. x.data, x.m and x.d give expected results to me, but why does for example (unsigned char)x.d return 254? Why doesn't it return 182 since x.data and x.d are in the same memory location and i casted x.d to be unsigned char which is same type as x.data is. </p>\n"}, {"tags": ["c", "ld", "exitstatus"], "comments": [{"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 2, "creation_date": 1458133477, "post_id": 36036395, "comment_id": 59721942, "body": "Could you post the compiler command? Are you sure you are compiling fib.c too and then link fib.o to your output?"}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 3, "creation_date": 1458133517, "post_id": 36036395, "comment_id": 59721982, "body": "Side note: <code>int fibonacci(int );</code> should be placed between <code>#define FIB_H_INCLUDED</code> and <code>#endif</code>"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1458133551, "post_id": 36036395, "comment_id": 59722007, "body": "Probably <code>fib.o</code> is not linked."}, {"owner": {"reputation": 33, "user_id": 6071484, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-zlT5Cia1Kp4/AAAAAAAAAAI/AAAAAAAAAIc/Z-O_qVEz5T0/photo.jpg?sz=128", "display_name": "alexioloruxo", "link": "https://stackoverflow.com/users/6071484/alexioloruxo"}, "edited": false, "score": 0, "creation_date": 1458140439, "post_id": 36036395, "comment_id": 59727817, "body": "I&#39;m using code block on windows with MinGW, i do not use the compiler terminal commands"}], "answers": [{"comments": [{"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1458136781, "post_id": 36037140, "comment_id": 59724892, "body": "I&#39;d add <code>-Wall</code>, always."}, {"owner": {"reputation": 33, "user_id": 6071484, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-zlT5Cia1Kp4/AAAAAAAAAAI/AAAAAAAAAIc/Z-O_qVEz5T0/photo.jpg?sz=128", "display_name": "alexioloruxo", "link": "https://stackoverflow.com/users/6071484/alexioloruxo"}, "edited": false, "score": 0, "creation_date": 1458142271, "post_id": 36037140, "comment_id": 59729257, "body": "i use windows and MinGW, but with your command + .exe  at the end of the string it works from the prompt"}, {"owner": {"reputation": 581, "user_id": 5863848, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s3w85.jpg?s=128&g=1", "display_name": "NishanthSpShetty", "link": "https://stackoverflow.com/users/5863848/nishanthspshetty"}, "reply_to_user": {"reputation": 33, "user_id": 6071484, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-zlT5Cia1Kp4/AAAAAAAAAAI/AAAAAAAAAIc/Z-O_qVEz5T0/photo.jpg?sz=128", "display_name": "alexioloruxo", "link": "https://stackoverflow.com/users/6071484/alexioloruxo"}, "edited": false, "score": 0, "creation_date": 1458145886, "post_id": 36037140, "comment_id": 59732002, "body": "@alexioloruxo , it is not a CodeBlock&#39;s error. You haven&#39;t provided the file additional to compile it seems. Compile fib.c first, then go to linker setting-&gt;Other Linker Option add &quot;Path_to_&quot;/fib.o and compile main program. It will work fine."}, {"owner": {"reputation": 33, "user_id": 6071484, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-zlT5Cia1Kp4/AAAAAAAAAAI/AAAAAAAAAIc/Z-O_qVEz5T0/photo.jpg?sz=128", "display_name": "alexioloruxo", "link": "https://stackoverflow.com/users/6071484/alexioloruxo"}, "edited": false, "score": 0, "creation_date": 1458213469, "post_id": 36037140, "comment_id": 59764601, "body": "@NishanthShetty, i just tried but still not work, same build error"}], "tags": [], "owner": {"reputation": 581, "user_id": 5863848, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s3w85.jpg?s=128&g=1", "display_name": "NishanthSpShetty", "link": "https://stackoverflow.com/users/5863848/nishanthspshetty"}, "is_accepted": true, "score": 2, "last_activity_date": 1458135065, "creation_date": 1458135065, "answer_id": 36037140, "question_id": 36036395, "link": "https://stackoverflow.com/questions/36036395/ld-returned-1-exit-status-fibonacci-search/36037140#36037140", "title": "ld returned 1 exit status, fibonacci search", "body": "<p>Its a linker error.\nYou have provided declaration (prototype) of the function to the main program but the definition is not provided. You need to compile both the file and provide the object files to the linker (ld).\nIn linux, compile together as follows</p>\n\n<blockquote>\n  <p>gcc main.c fib.c -o fib</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 33, "user_id": 6071484, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-zlT5Cia1Kp4/AAAAAAAAAAI/AAAAAAAAAIc/Z-O_qVEz5T0/photo.jpg?sz=128", "display_name": "alexioloruxo", "link": "https://stackoverflow.com/users/6071484/alexioloruxo"}, "edited": false, "score": 0, "creation_date": 1458140447, "post_id": 36038016, "comment_id": 59727825, "body": "it&#39;s a typing error, i&#39;m italian and &quot;posizione&quot; is &quot;position&quot; i rewrite the variables&#39; name in english when i write the  question and i made a little mistake"}], "tags": [], "owner": {"reputation": 61, "user_id": 5659926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb46664ab4db51f8a857194321941f91?s=128&d=identicon&r=PG&f=1", "display_name": "shanglun", "link": "https://stackoverflow.com/users/5659926/shanglun"}, "is_accepted": false, "score": 1, "last_activity_date": 1458137139, "creation_date": 1458137139, "answer_id": 36038016, "question_id": 36036395, "link": "https://stackoverflow.com/questions/36036395/ld-returned-1-exit-status-fibonacci-search/36038016#36038016", "title": "ld returned 1 exit status, fibonacci search", "body": "<p>In Fib.c, you're checking a \"posizione\" variable, which is not declared anywhere. Once you change that, you should be able to rebuild the module and after that, the project.  </p>\n\n<p>As a side note, I'd recommend checking the include guard in fib.h. Normally, you'd put declarations in the ifdef block to make sure the variables are only declared once per file. </p>\n"}, {"tags": [], "owner": {"reputation": 33, "user_id": 6071484, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-zlT5Cia1Kp4/AAAAAAAAAAI/AAAAAAAAAIc/Z-O_qVEz5T0/photo.jpg?sz=128", "display_name": "alexioloruxo", "link": "https://stackoverflow.com/users/6071484/alexioloruxo"}, "is_accepted": false, "score": 0, "last_activity_date": 1458142948, "creation_date": 1458142948, "answer_id": 36040459, "question_id": 36036395, "link": "https://stackoverflow.com/questions/36036395/ld-returned-1-exit-status-fibonacci-search/36040459#36040459", "title": "ld returned 1 exit status, fibonacci search", "body": "<p>the code is correct, i used the command prompt and the code</p>\n\n<pre><code>gcc main.c fib.c -o fib.exe\n</code></pre>\n\n<p>and it works, so i think it's a CodeBlocks' error. What could be the problem?</p>\n"}], "owner": {"reputation": 33, "user_id": 6071484, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-zlT5Cia1Kp4/AAAAAAAAAAI/AAAAAAAAAIc/Z-O_qVEz5T0/photo.jpg?sz=128", "display_name": "alexioloruxo", "link": "https://stackoverflow.com/users/6071484/alexioloruxo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 233, "favorite_count": 0, "accepted_answer_id": 36037140, "answer_count": 3, "score": 3, "last_activity_date": 1458142948, "creation_date": 1458133055, "last_edit_date": 1458133599, "question_id": 36036395, "link": "https://stackoverflow.com/questions/36036395/ld-returned-1-exit-status-fibonacci-search", "title": "ld returned 1 exit status, fibonacci search", "body": "<p>i think my \"dear\" code has a problem, i'm using code block and when i try to compile, the compiler show me this error: \"ld returned 1 exit status\"</p>\n\n<p>main.c</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include \"C:\\Users\\alexl_000\\Desktop\\fibmodnopoin\\fib.h\"\n\nint main(){\n    int position;\n    int *fib_ptr,fib=2;\n    char confirm='y';\n    fib_ptr = &amp;fib;\n\nprintf(\"find Fibonacci's number by it's position \\n\");\n\nwhile(confirm=='y'){\n    printf(\"insert position:\");\n    scanf(\"%d\", &amp;position);\n    printf(\"%d \\n\",position);\n    fib=fibonacci(position);\n    printf(\"%d \\n\", *fib_ptr);\n    printf(\"find new number?\");\n    scanf(\"%s\", &amp;confirm);\n}\nreturn 0;\n}\n</code></pre>\n\n<p>fib.h</p>\n\n<pre><code>#ifndef FIB_H_INCLUDED\n#define FIB_H_INCLUDED\n#endif // FIB_H_INCLUDED\n\nint fibonacci(int );\n</code></pre>\n\n<p>fib.c</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n\nint fibonacci(int position){\n\n    int fib1=1, fib2=1, count=3, fib;\n\n    if (posizione==0)\n      fib=0;\n\n    else if (position==1||2 )\n      fib=1;\n\n    if (position&gt;2){\n      while(count &lt;=  position){\n         count++;\n         fib=fib1+fib2;\n         fib2=fib1;\n         fib1=fib;\n        }\n    }\n    return fib ;\n}\n</code></pre>\n\n<p>compiler</p>\n\n<pre><code>||=== Build: Debug in fibmodnopoin (compiler: GNU GCC Compiler) ===|\n||error: ld returned 1 exit status|\n||=== Build failed: 1 error(s), 0 warning(s) (0 minute(s), 0 second(s)) ===|\n</code></pre>\n\n<p>before there were a linking problem due to \"debug\" and \"release\" box not checked</p>\n\n<pre><code>reference not defined to \"fibonacci\"\n</code></pre>\n\n<p>but i solve it: right click to <code>fib.c</code> or\\and <code>fib.h</code>, properties->build </p>\n\n<p>i really do not find a way to solve the first problem...</p>\n\n<p>Thank you for the attention</p>\n"}, {"tags": ["c"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 6071570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cad09e70e1cb0d51c94b42c413097386?s=128&d=identicon&r=PG&f=1", "display_name": "Akshay.Dewnarain", "link": "https://stackoverflow.com/users/6071570/akshay-dewnarain"}, "edited": false, "score": 1, "creation_date": 1458144207, "post_id": 36036467, "comment_id": 59730762, "body": "So that did fix the problem! But i still don&#39;t understand how it got fixed. Could you explain it in more details?"}, {"owner": {"reputation": 29294, "user_id": 2659313, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9828b91aef4c2b3cf14f3501e0a20e33?s=128&d=identicon&r=PG", "display_name": "Mohit Jain", "link": "https://stackoverflow.com/users/2659313/mohit-jain"}, "reply_to_user": {"reputation": 13, "user_id": 6071570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cad09e70e1cb0d51c94b42c413097386?s=128&d=identicon&r=PG&f=1", "display_name": "Akshay.Dewnarain", "link": "https://stackoverflow.com/users/6071570/akshay-dewnarain"}, "edited": false, "score": 0, "creation_date": 1458144263, "post_id": 36036467, "comment_id": 59730800, "body": "I am glad it worked for you. I will try to edit my answer to explain further."}, {"owner": {"reputation": 13, "user_id": 6071570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cad09e70e1cb0d51c94b42c413097386?s=128&d=identicon&r=PG&f=1", "display_name": "Akshay.Dewnarain", "link": "https://stackoverflow.com/users/6071570/akshay-dewnarain"}, "edited": false, "score": 0, "creation_date": 1458144771, "post_id": 36036467, "comment_id": 59731213, "body": "Thanks for the efforts! But now i&#39;m stuck on one thing with putting the -1 in the matrix. Its supposed to be &quot;-&quot; character and not -1."}, {"owner": {"reputation": 2097, "user_id": 2086502, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/fb2b01622bb09a6608bdc5a27803d1a7?s=128&d=identicon&r=PG", "display_name": "BoilingLime", "link": "https://stackoverflow.com/users/2086502/boilinglime"}, "edited": false, "score": 1, "creation_date": 1458145459, "post_id": 36036467, "comment_id": 59731724, "body": "You can&#39;t store a char &#39;-&#39; in an int array. So you have to replace it by an integer value. Otherwise, if you want to store &#39;-&#39;, you must store everything in an char array, and store 1 and 0 as char not as int."}, {"owner": {"reputation": 29294, "user_id": 2659313, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9828b91aef4c2b3cf14f3501e0a20e33?s=128&d=identicon&r=PG", "display_name": "Mohit Jain", "link": "https://stackoverflow.com/users/2659313/mohit-jain"}, "reply_to_user": {"reputation": 2097, "user_id": 2086502, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/fb2b01622bb09a6608bdc5a27803d1a7?s=128&d=identicon&r=PG", "display_name": "BoilingLime", "link": "https://stackoverflow.com/users/2086502/boilinglime"}, "edited": false, "score": 0, "creation_date": 1458145543, "post_id": 36036467, "comment_id": 59731783, "body": "@BoilingLime Correctly mentioned. A workaround during print is to change your <code>printf</code> as: <code>if(matrix[a][b] &lt; 0) printf(&quot;-&quot;); else printf(&quot;%d&quot;, matrix[a][b]);</code> `"}], "tags": [], "owner": {"reputation": 29294, "user_id": 2659313, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9828b91aef4c2b3cf14f3501e0a20e33?s=128&d=identicon&r=PG", "display_name": "Mohit Jain", "link": "https://stackoverflow.com/users/2659313/mohit-jain"}, "is_accepted": true, "score": 0, "last_activity_date": 1458144553, "last_edit_date": 1458144553, "creation_date": 1458133257, "answer_id": 36036467, "question_id": 36036392, "link": "https://stackoverflow.com/questions/36036392/reading-a-matrix-text-file-into-a-array-in-c/36036467#36036467", "title": "Reading a matrix text file into a array in c", "body": "<p>Initialize the matrix</p>\n\n<pre><code>int matrix[10][10] = {0};\n</code></pre>\n\n<p>Handle input other than 0 and 1</p>\n\n<p>What else do we need to handle:</p>\n\n<ol>\n<li>Hyphen or <code>-</code> input: Save some other number for ex: 2 or -1</li>\n<li>EOF or end of file: End the program or similar handling</li>\n<li>New line, trailing space or other unknown character: Ignore the character and read again</li>\n</ol>\n\n\n\n<pre><code>c = fgetc(filename);\nif(c == '1')\n{\n   matrix[i][j] = 1;\n}\nelse if(c == '0')\n{\n    matrix[i][j] = 0;\n}\nelse if(c == '-')\n{\n    matrix[i][j] = -1;  /* Special number for - */\n}\nelse if(c == EOF)\n{\n    return -1; /* End of file handling */\n}\nelse\n{\n   --j; /* Ignore this character and enter into loop again */\n   /* Although modifying loop controlling var inside is not a good habit */\n   /* For this small module, it should be fine */\n}\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 6071570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cad09e70e1cb0d51c94b42c413097386?s=128&d=identicon&r=PG&f=1", "display_name": "Akshay.Dewnarain", "link": "https://stackoverflow.com/users/6071570/akshay-dewnarain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 460, "favorite_count": 0, "accepted_answer_id": 36036467, "answer_count": 1, "score": 1, "last_activity_date": 1458144553, "creation_date": 1458133051, "last_edit_date": 1458135253, "question_id": 36036392, "link": "https://stackoverflow.com/questions/36036392/reading-a-matrix-text-file-into-a-array-in-c", "title": "Reading a matrix text file into a array in c", "body": "<p>I have started learning to code in C, and I am stuck at a assignment where I'm supposed to read a file, put the contents in a matrix, and finally print the matrix.</p>\n\n<p>The input file contains:</p>\n\n<pre><code>    ------01-1\n    1--------1\n    --0-1-----\n    ----0-----\n    ------0--1\n    -----1--1-\n    ------0--0\n    0---------\n    --11-----1\n    0-1-----0-\n</code></pre>\n\n<p>This is the code that I have written so far:</p>\n\n<pre><code>int main()\n{   \n    FILE *filename = fopen(\"file.txt\",\"r\");\n    int matrix[10][10];\n    int c;\n\n    for(int i =0; i &lt; 10; i++)\n    {\n        for(int j=0; j&lt;10; j++)\n        {\n            c = fgetc(filename);\n            if(c == '1')\n            {\n                matrix[i][j] = 1;\n            }\n            else if(c == '0')\n            {\n                matrix[i][j] = 0;\n            }\n        }\n    }\n\n    for(int a = 0; a &lt; 10; a++)\n    {\n        for(int  b = 0; b &lt; 10; b++)\n        {\n            printf(\"%d\", matrix[a][b]);\n        }\n        printf(\"\\n\");\n    }\n\n}\n</code></pre>\n\n<p>the output:</p>\n\n<pre><code>-520092443803-520092443-12480181\n2686620131463841127199806539638031616085\n1316435226866683164344001-520092443011\n51119868016113146336314633624404833019927382943080192\n26869241998418816-1123324798-2268660019980688424308334426866161992765860\n0019927658711830833442686648199276586030801920\n1-8756571168119980461561998099927-13626866284\n0175821461101992769785308335604200816026866681992735205\n199343520826867321992749998819927700401992769850-875656752419907241990720\n11268674426869241992847904-1121896548-2119927710210\n\nPress any key to continue.\n</code></pre>\n\n<p>My guess with the output is that it doesn't add the <code>c</code> value into the matrix. So it prints a \"empty\" array; the empty array leads to weird numbers?</p>\n\n<p>I know that I'm reading characters from the text file. So I need to convert them to <code>int</code> values.</p>\n\n<p>But why does my code go wrong and where does it go wrong?</p>\n"}, {"tags": ["c", "linked-list", "free"], "comments": [{"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 2, "creation_date": 1458132770, "post_id": 36036210, "comment_id": 59721402, "body": "UB, and multi-dup :("}, {"owner": {"reputation": 401, "user_id": 4377391, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Nk8IR.jpg?s=128&g=1", "display_name": "rabi shaw", "link": "https://stackoverflow.com/users/4377391/rabi-shaw"}, "edited": false, "score": 0, "creation_date": 1458133244, "post_id": 36036210, "comment_id": 59721779, "body": "when you do a malloc() memory will be allocated from heap for your program .. once you free the memory using free() the memory will be given back to the available chunk so that other program can use that memory. It will not destroy the data written to that memory until and unless it will be over written by some other program."}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1458133380, "post_id": 36036210, "comment_id": 59721881, "body": "You are probably being irritated why temp-&gt;data seems to be zeroed while temp-&gt;next isn&#39;t. This is just due to meta-data being written to the (data-part) of the allocated memory chunk on <code>free()</code> (the so-called <i>free-list</i>). and is <i>not</i> a mechanism of destroying the data systematically on free."}], "answers": [{"comments": [{"owner": {"reputation": 7061, "user_id": 5389107, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/769c1f4253eca239d400ce3226d801b4?s=128&d=identicon&r=PG&f=1", "display_name": "user308386", "link": "https://stackoverflow.com/users/5389107/user308386"}, "edited": false, "score": 0, "creation_date": 1458134205, "post_id": 36036586, "comment_id": 59722547, "body": "Why do you answer a very obvious duplicate?"}, {"owner": {"reputation": 935, "user_id": 5394409, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "OmarL", "link": "https://stackoverflow.com/users/5394409/omarl"}, "reply_to_user": {"reputation": 7061, "user_id": 5389107, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/769c1f4253eca239d400ce3226d801b4?s=128&d=identicon&r=PG&f=1", "display_name": "user308386", "link": "https://stackoverflow.com/users/5389107/user308386"}, "edited": false, "score": 0, "creation_date": 1458134733, "post_id": 36036586, "comment_id": 59723026, "body": "The question has not been marked as a duplicate. Did I go wrong?"}, {"owner": {"reputation": 7061, "user_id": 5389107, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/769c1f4253eca239d400ce3226d801b4?s=128&d=identicon&r=PG&f=1", "display_name": "user308386", "link": "https://stackoverflow.com/users/5389107/user308386"}, "edited": false, "score": 0, "creation_date": 1458134952, "post_id": 36036586, "comment_id": 59723254, "body": "If you take a gander at the comments underneath it, you&#39;ll see that its been discussed before. The question is currently sitting at 4 close votes (1 more to close as dupe)(although you cant see that). In such cases where multiple people point out that its a duplicate you should abstain from answering."}, {"owner": {"reputation": 935, "user_id": 5394409, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "OmarL", "link": "https://stackoverflow.com/users/5394409/omarl"}, "reply_to_user": {"reputation": 7061, "user_id": 5389107, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/769c1f4253eca239d400ce3226d801b4?s=128&d=identicon&r=PG&f=1", "display_name": "user308386", "link": "https://stackoverflow.com/users/5389107/user308386"}, "edited": false, "score": 0, "creation_date": 1458135548, "post_id": 36036586, "comment_id": 59723787, "body": "All right, now I know. Thanks"}], "tags": [], "owner": {"reputation": 935, "user_id": 5394409, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "OmarL", "link": "https://stackoverflow.com/users/5394409/omarl"}, "is_accepted": true, "score": 2, "last_activity_date": 1458133633, "creation_date": 1458133633, "answer_id": 36036586, "question_id": 36036210, "link": "https://stackoverflow.com/questions/36036210/working-of-free-in-c/36036586#36036586", "title": "Working of free() in C", "body": "<p>The problem is with your assumption that:</p>\n\n<blockquote>\n  <p>If the first node was freed, then all the data and the next pointer\n  should have been deleted.</p>\n</blockquote>\n\n<p>You can free the first node, and that memory will return to the heap. It doesn't (necessarily) get modified in any way. In your example, the pointer to the second node happened to remain intact, so that you were still able to iterate to it. This is how you were able to print the first and second number in the list.</p>\n\n<p>Basically, all free() does is to say \"This process doesn't care about this block of memory any more\". And then the operating system or something else can use it. Next time you use malloc(), it might give you this same block of memory back again. </p>\n\n<p>This is all undefined behaviour, of course. That means it'll happily run, until it doesn't.</p>\n"}], "owner": {"reputation": 307, "user_id": 5231693, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-MrZ75MNgrTs/AAAAAAAAAAI/AAAAAAAAE5E/VnzdVMgdOhE/photo.jpg?sz=128", "display_name": "Ranjan Srinivas", "link": "https://stackoverflow.com/users/5231693/ranjan-srinivas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "closed_date": 1458135787, "accepted_answer_id": 36036586, "answer_count": 1, "score": 0, "last_activity_date": 1458133633, "creation_date": 1458132645, "question_id": 36036210, "link": "https://stackoverflow.com/questions/36036210/working-of-free-in-c", "closed_reason": "Duplicate", "title": "Working of free() in C", "body": "<p>I have some trouble understanding on how the free() function in C works. What is think free() does is, as the name says, free the memory at the address which was passed as an argument. Then i tried the following code:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n\n#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n\nstruct node\n{\n    int data;\n    struct node *next;\n};\n\nint main()\n{\n    struct node *first, *second, *temp;\n    first = malloc(sizeof(struct node));\n    second = malloc(sizeof(struct node));\n    temp = first;\n    first-&gt;data = 1;\n    first-&gt;next = second;\n    second-&gt;data = 2;\n    second-&gt;next = NULL;\n    free(first);\n    while(temp!=NULL)\n    {\n        printf(\"%d\\n\", temp-&gt;data);\n        temp = temp-&gt;next;\n    }\n    return 0;\n}\n</code></pre>\n\n<p>The above is a very basic implementation of linked list. I created two nodes, namely first and second, fed in the data, and linked them together. I then 'freed' the first node, and attempted to print the linked list.\nI got the following output:</p>\n\n<p><b>\n0 <br>\n2\n</b></p>\n\n<p>So, here is my question, why is the second node being printed? If the first node was freed, then all the data and the next pointer should have been deleted. Even if I did</p>\n\n<pre><code>temp = first;\n</code></pre>\n\n<p>I just copied the address from first to temp. When I free first, whatever was stored there should be destroyed, including the address of the second node. So how am I still able to print the second node?</p>\n"}, {"tags": ["c", "arrays", "function", "pointers", "scanf"], "comments": [{"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 0, "creation_date": 1458132623, "post_id": 36036166, "comment_id": 59721299, "body": "<code>pArr</code> or <code>ptr</code>? Also, in your loop <code>k</code> will be <code>size</code>in the last pass, which isn&#39;t a valid index for an array of size <code>size</code>."}, {"owner": {"reputation": 4751, "user_id": 5649326, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/a82Se.jpg?s=128&g=1", "display_name": "Marievi", "link": "https://stackoverflow.com/users/5649326/marievi"}, "edited": false, "score": 0, "creation_date": 1458132727, "post_id": 36036166, "comment_id": 59721370, "body": "Where is the definition of pArr?"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1458132745, "post_id": 36036166, "comment_id": 59721379, "body": "<code>for (k=0; k&lt;sizeArr; k++) {     printf(&quot;please enter element number %d\\n&quot;, k);     scanf(&quot;%d&quot;, ptr+k); }</code>"}, {"owner": {"reputation": 133, "user_id": 3916251, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9f06f811ce0f2a9f32636846d86ba4ff?s=128&d=identicon&r=PG&f=1", "display_name": "Bruce Strafford", "link": "https://stackoverflow.com/users/3916251/bruce-strafford"}, "edited": false, "score": 0, "creation_date": 1458133629, "post_id": 36036166, "comment_id": 59722065, "body": "Edited it. It should&#39;ve been *(ptr+k)..but as you guys explained: just ptr+k."}], "answers": [{"comments": [{"owner": {"reputation": 133, "user_id": 3916251, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9f06f811ce0f2a9f32636846d86ba4ff?s=128&d=identicon&r=PG&f=1", "display_name": "Bruce Strafford", "link": "https://stackoverflow.com/users/3916251/bruce-strafford"}, "edited": false, "score": 0, "creation_date": 1458133692, "post_id": 36036263, "comment_id": 59722118, "body": "Hi. Thanks for the explanation and for the link. I&#39;m just learning C and pointers and arrays are taking a while to ge tused to."}], "tags": [], "owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "is_accepted": false, "score": 1, "last_activity_date": 1458133112, "last_edit_date": 1495540389, "creation_date": 1458132775, "answer_id": 36036263, "question_id": 36036166, "link": "https://stackoverflow.com/questions/36036166/update-array-elements-access-using-pointers-using-scanf-inputs-in-function/36036263#36036263", "title": "Update array elements (access using pointers) using scanf inputs in function", "body": "<p><code>ptr</code> is a pointer to <code>int</code>.</p>\n\n<p><code>(ptr + k)</code> is still a pointer to (a different) int. <code>*(ptr + k)</code> is an <code>int</code>.</p>\n\n<p><code>scanf( \"%d\", &lt;some_int&gt; )</code> will interpret the <em>number</em> stored in that <code>int</code> <em>as an address</em>, and try to write whatever the user entered to that \"address\".</p>\n\n<p>Which is undefined behaviour.</p>\n\n<p><strong>You probably want to omit the <code>*</code> turning the pointer into an <code>int</code>; the statement would be well-formed then.</strong></p>\n\n<p>Generally speaking, <strong>recommended reading</strong>: <a href=\"https://stackoverflow.com/questions/35178520/how-to-read-parse-input-in-c-the-faq\">How to read / parse input in C</a>.</p>\n\n<ul>\n<li>Check the return value of <code>scanf()</code>, as the user might have entered something that is not a number.</li>\n<li>Cater for not-a-number input still waiting in the input buffer by reading up to the next newline, or subsequent <code>scanf( \"%d\", ... )</code> will fail as well.</li>\n<li>Better yet, read <strong>lines</strong> of input (with <code>fgets()</code>), and parse them in-memory (with <code>strtol()</code>), which allows you to recover from faulty input more gracefully.</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 4751, "user_id": 5649326, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/a82Se.jpg?s=128&g=1", "display_name": "Marievi", "link": "https://stackoverflow.com/users/5649326/marievi"}, "is_accepted": true, "score": 1, "last_activity_date": 1458133191, "last_edit_date": 1458133191, "creation_date": 1458132811, "answer_id": 36036282, "question_id": 36036166, "link": "https://stackoverflow.com/questions/36036166/update-array-elements-access-using-pointers-using-scanf-inputs-in-function/36036282#36036282", "title": "Update array elements (access using pointers) using scanf inputs in function", "body": "<p>Modify the way you read elements by changing </p>\n\n<pre><code>scanf(\"%d\", *(ptr+k));\n</code></pre>\n\n<p>with </p>\n\n<pre><code>scanf(\"%d\", (ptr+k));\n</code></pre>\n\n<p>Scanf needs a pointer next to the specifier, but <code>ptr</code> is already a pointer (and so is <code>ptr+k</code> ) so by using the asterisk you imply the contents of the pointer and not the pointer itself.</p>\n"}, {"comments": [{"owner": {"reputation": 133, "user_id": 3916251, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9f06f811ce0f2a9f32636846d86ba4ff?s=128&d=identicon&r=PG&f=1", "display_name": "Bruce Strafford", "link": "https://stackoverflow.com/users/3916251/bruce-strafford"}, "edited": false, "score": 0, "creation_date": 1458133847, "post_id": 36036299, "comment_id": 59722262, "body": "Thanks for the explanation."}], "tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": false, "score": 1, "last_activity_date": 1458133542, "last_edit_date": 1458133542, "creation_date": 1458132847, "answer_id": 36036299, "question_id": 36036166, "link": "https://stackoverflow.com/questions/36036166/update-array-elements-access-using-pointers-using-scanf-inputs-in-function/36036299#36036299", "title": "Update array elements (access using pointers) using scanf inputs in function", "body": "<p>For any pointer (or array) <code>pArr</code> and index <code>k</code> the expression <code>*(pArr + k)</code> is equivalent to <code>pArr[i]</code>.</p>\n\n<p>The problem with that is that <code>pArr[i]</code> (and therefore <code>*(pArr + k)</code>) is not a pointer, which is required by <code>scanf</code> to work.</p>\n\n<p>There are two solutions: The first is to continue using pointer arithmetic and then simply drop the dereference operator (so you pass only <code>pArr + k</code> to <code>scanf</code>); Or you use \"normal\" array indexing and add the address-of operator (as in <code>&amp;pArr[k]</code>).</p>\n\n<hr>\n\n<p>A little explanation about the alternatives. The expression <code>pArr[k]</code> gives you the value at index <code>k</code> in the array, to get a pointer to that value we add the address-of operator <code>&amp;</code> and get <code>&amp;pArr[k]</code>.</p>\n\n<p>And since <code>pArr[k]</code> is equivalent to <code>*(pArr + k)</code> then <code>&amp;pArr[k]</code> would be equivalent to <code>&amp;*(pArr + k)</code>, but the address-of and dereference operator cancels each other out leaving you with <code>pArr + k</code>.</p>\n\n<hr>\n\n<p>What is happening now with the code as shown in the question is that you get the value at index <code>k</code> (i.e. <code>pArr[k]</code>) and the compiler converts it to a pointer (it should give you a warning about it though) and then <code>scanf</code> write to the memory pointed to by that value. Since <code>pArr[k]</code> is not a valid pointer, it may even be uninitialized (and therefore have an <em>indeterminate</em> value) you will have <em>undefined behavior</em>.</p>\n"}], "owner": {"reputation": 133, "user_id": 3916251, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9f06f811ce0f2a9f32636846d86ba4ff?s=128&d=identicon&r=PG&f=1", "display_name": "Bruce Strafford", "link": "https://stackoverflow.com/users/3916251/bruce-strafford"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 655, "favorite_count": 0, "accepted_answer_id": 36036282, "answer_count": 3, "score": 1, "last_activity_date": 1458133919, "creation_date": 1458132513, "last_edit_date": 1458133919, "question_id": 36036166, "link": "https://stackoverflow.com/questions/36036166/update-array-elements-access-using-pointers-using-scanf-inputs-in-function", "title": "Update array elements (access using pointers) using scanf inputs in function", "body": "<p>So I have a pointer and a size of the array that gets passed down to a function that asks for user input and stores user input as array elements. </p>\n\n<p>So the function looks like this:</p>\n\n<pre><code>int addElements(int * ptr, int sizeArr) {\n\nint k=0;\nfor (k=0; k&lt;=size; k++) {\n    printf(\"please enter element number %d\\n\", k);\n    scanf(\"%d\", *(ptr+k));\n}\n\nreturn pArr;\n</code></pre>\n\n<p>}</p>\n\n<p>It returns a pointer because I need to work further with the array. </p>\n\n<p>I get </p>\n\n<pre><code>Segmentation fault (Core dumped)\n</code></pre>\n\n<p>error when inputting the elements to the array. </p>\n\n<p>What am I doing wrong here? I can update the array elements (from random/automatic values ) to 0 just fine it's just the scanf that can't write to the array.</p>\n"}, {"tags": ["c", "pointers", "gcc", "language-lawyer", "compiler-optimization"], "comments": [{"owner": {"reputation": 1365, "user_id": 929668, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/219fcd6acd2770ee252cc4c08aa13bf6?s=128&d=identicon&r=PG", "display_name": "Timothy Miller", "link": "https://stackoverflow.com/users/929668/timothy-miller"}, "edited": false, "score": 0, "creation_date": 1458131747, "post_id": 36035782, "comment_id": 59720587, "body": "Have you tried printing out the pointer values, just to see if you can figure out what&#39;s going on?  Also, try dumping the symbol table (using &#39;nm&#39;) to see how it&#39;s allocating them.  Maybe the optimization is just changing the memory ordering.  BTW, don&#39;t be surprised if the printf changes the behavior, because the compiler won&#39;t optimize around functions it can&#39;t control."}, {"owner": {"reputation": 2093, "user_id": 3153883, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/xVr3z.jpg?s=128&g=1", "display_name": "LawfulEvil", "link": "https://stackoverflow.com/users/3153883/lawfulevil"}, "edited": false, "score": 0, "creation_date": 1458131766, "post_id": 36035782, "comment_id": 59720601, "body": "Because check((uintptr_t)p == (uintptr_t)&amp;b); always returns true, they must have the same value.   Maybe its using the wrong == operator above?"}, {"owner": {"reputation": 1365, "user_id": 929668, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/219fcd6acd2770ee252cc4c08aa13bf6?s=128&d=identicon&r=PG", "display_name": "Timothy Miller", "link": "https://stackoverflow.com/users/929668/timothy-miller"}, "edited": false, "score": 0, "creation_date": 1458131879, "post_id": 36035782, "comment_id": 59720689, "body": "If you can tell us why this pointer math is important to your problem, maybe we can help you solve it a different way.  Why does the memory ordering matter?"}, {"owner": {"reputation": 12286, "user_id": 1607442, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/18451ad16ed8ad45b0a18bf70b2aa002?s=128&d=identicon&r=PG", "display_name": "Ivan Aksamentov - Drop", "link": "https://stackoverflow.com/users/1607442/ivan-aksamentov-drop"}, "edited": false, "score": 0, "creation_date": 1458131881, "post_id": 36035782, "comment_id": 59720693, "body": "You assume <code>&amp;a + 1</code> points to <code>b</code>. Is this guaranteed? I think that even the order of <code>a</code> and <code>b</code> in memory depends on linkage order."}, {"owner": {"reputation": 468, "user_id": 1266963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae1051036e07e42ee389b4d255645115?s=128&d=identicon&r=PG", "display_name": "Yuri Syro", "link": "https://stackoverflow.com/users/1266963/yuri-syro"}, "reply_to_user": {"reputation": 1365, "user_id": 929668, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/219fcd6acd2770ee252cc4c08aa13bf6?s=128&d=identicon&r=PG", "display_name": "Timothy Miller", "link": "https://stackoverflow.com/users/929668/timothy-miller"}, "edited": false, "score": 1, "creation_date": 1458132058, "post_id": 36035782, "comment_id": 59720827, "body": "@TimothyMiller yes, I printed them with printf(%p), the difference between &amp;a and &amp;b is really sizeof(int). Please notice (uintptr_t)p == (uintptr_t)&amp;b."}, {"owner": {"reputation": 26917, "user_id": 1892179, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/umfON.jpg?s=128&g=1", "display_name": "Theodoros Chatzigiannakis", "link": "https://stackoverflow.com/users/1892179/theodoros-chatzigiannakis"}, "edited": false, "score": 0, "creation_date": 1458132075, "post_id": 36035782, "comment_id": 59720844, "body": "Keep in mind that the behavior of pointer comparison is defined only for a few specific cases and undefined for all others."}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1458132098, "post_id": 36035782, "comment_id": 59720866, "body": "<i>Any pointer type may be converted to an integer type. Except as previously specified, the result is implementation-defined.</i>"}, {"owner": {"reputation": 468, "user_id": 1266963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae1051036e07e42ee389b4d255645115?s=128&d=identicon&r=PG", "display_name": "Yuri Syro", "link": "https://stackoverflow.com/users/1266963/yuri-syro"}, "reply_to_user": {"reputation": 2093, "user_id": 3153883, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/xVr3z.jpg?s=128&g=1", "display_name": "LawfulEvil", "link": "https://stackoverflow.com/users/3153883/lawfulevil"}, "edited": false, "score": 0, "creation_date": 1458132134, "post_id": 36035782, "comment_id": 59720893, "body": "@LawfulEvil yes, they must, and they have. But optimizer thinks they can&#39;t."}, {"owner": {"reputation": 1365, "user_id": 929668, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/219fcd6acd2770ee252cc4c08aa13bf6?s=128&d=identicon&r=PG", "display_name": "Timothy Miller", "link": "https://stackoverflow.com/users/929668/timothy-miller"}, "edited": false, "score": 0, "creation_date": 1458132238, "post_id": 36035782, "comment_id": 59720982, "body": "@CheeseRussian We still don&#39;t know why you&#39;re doing this.  Can you make a single global array that&#39;s extern&#39;d in other files?  The compiler can reason over pointers within the same array, while it&#39;s making an assumption about what it thinks are independent variables."}, {"owner": {"reputation": 468, "user_id": 1266963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae1051036e07e42ee389b4d255645115?s=128&d=identicon&r=PG", "display_name": "Yuri Syro", "link": "https://stackoverflow.com/users/1266963/yuri-syro"}, "reply_to_user": {"reputation": 1365, "user_id": 929668, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/219fcd6acd2770ee252cc4c08aa13bf6?s=128&d=identicon&r=PG", "display_name": "Timothy Miller", "link": "https://stackoverflow.com/users/929668/timothy-miller"}, "edited": false, "score": 0, "creation_date": 1458132321, "post_id": 36035782, "comment_id": 59721055, "body": "@TimothyMiller I&#39;m working on an in-house C testing framework which uses values placement for automatic discovery of tests."}, {"owner": {"reputation": 1365, "user_id": 929668, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/219fcd6acd2770ee252cc4c08aa13bf6?s=128&d=identicon&r=PG", "display_name": "Timothy Miller", "link": "https://stackoverflow.com/users/929668/timothy-miller"}, "edited": false, "score": 0, "creation_date": 1458132384, "post_id": 36035782, "comment_id": 59721112, "body": "If this is for functional testing, can you do most of the testing with -O0 ?"}, {"owner": {"reputation": 468, "user_id": 1266963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae1051036e07e42ee389b4d255645115?s=128&d=identicon&r=PG", "display_name": "Yuri Syro", "link": "https://stackoverflow.com/users/1266963/yuri-syro"}, "reply_to_user": {"reputation": 12286, "user_id": 1607442, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/18451ad16ed8ad45b0a18bf70b2aa002?s=128&d=identicon&r=PG", "display_name": "Ivan Aksamentov - Drop", "link": "https://stackoverflow.com/users/1607442/ivan-aksamentov-drop"}, "edited": false, "score": 0, "creation_date": 1458132428, "post_id": 36035782, "comment_id": 59721151, "body": "@Drop I don&#39;t think it is guaranteed by standard, but in this example this fact is proven by the third check."}, {"owner": {"reputation": 468, "user_id": 1266963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae1051036e07e42ee389b4d255645115?s=128&d=identicon&r=PG", "display_name": "Yuri Syro", "link": "https://stackoverflow.com/users/1266963/yuri-syro"}, "reply_to_user": {"reputation": 12286, "user_id": 1607442, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/18451ad16ed8ad45b0a18bf70b2aa002?s=128&d=identicon&r=PG", "display_name": "Ivan Aksamentov - Drop", "link": "https://stackoverflow.com/users/1607442/ivan-aksamentov-drop"}, "edited": false, "score": 0, "creation_date": 1458132502, "post_id": 36035782, "comment_id": 59721204, "body": "@Drop linkage order is fixed."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1458132601, "post_id": 36035782, "comment_id": 59721280, "body": "<code>uintptr_t</code> is only guaranteed to convert from/to a pointer to the same type correctly. There is no guarantee the integer values compare equal."}, {"owner": {"reputation": 12286, "user_id": 1607442, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/18451ad16ed8ad45b0a18bf70b2aa002?s=128&d=identicon&r=PG", "display_name": "Ivan Aksamentov - Drop", "link": "https://stackoverflow.com/users/1607442/ivan-aksamentov-drop"}, "edited": false, "score": 0, "creation_date": 1458132623, "post_id": 36035782, "comment_id": 59721298, "body": "Dump both disassembly then ;) What&#39;s your architecture BTW?"}, {"owner": {"reputation": 468, "user_id": 1266963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae1051036e07e42ee389b4d255645115?s=128&d=identicon&r=PG", "display_name": "Yuri Syro", "link": "https://stackoverflow.com/users/1266963/yuri-syro"}, "reply_to_user": {"reputation": 1365, "user_id": 929668, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/219fcd6acd2770ee252cc4c08aa13bf6?s=128&d=identicon&r=PG", "display_name": "Timothy Miller", "link": "https://stackoverflow.com/users/929668/timothy-miller"}, "edited": false, "score": 0, "creation_date": 1458132652, "post_id": 36035782, "comment_id": 59721321, "body": "@TimothyMiller I&#39;m building the global array in compile time, only by linking files containing <code>struct test_info</code> instances."}, {"owner": {"reputation": 468, "user_id": 1266963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae1051036e07e42ee389b4d255645115?s=128&d=identicon&r=PG", "display_name": "Yuri Syro", "link": "https://stackoverflow.com/users/1266963/yuri-syro"}, "reply_to_user": {"reputation": 1365, "user_id": 929668, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/219fcd6acd2770ee252cc4c08aa13bf6?s=128&d=identicon&r=PG", "display_name": "Timothy Miller", "link": "https://stackoverflow.com/users/929668/timothy-miller"}, "edited": false, "score": 0, "creation_date": 1458132705, "post_id": 36035782, "comment_id": 59721350, "body": "@TimothyMiller it&#39;s not my code, it has been working for years, but broke on GCC 5.2."}, {"owner": {"reputation": 468, "user_id": 1266963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae1051036e07e42ee389b4d255645115?s=128&d=identicon&r=PG", "display_name": "Yuri Syro", "link": "https://stackoverflow.com/users/1266963/yuri-syro"}, "reply_to_user": {"reputation": 1365, "user_id": 929668, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/219fcd6acd2770ee252cc4c08aa13bf6?s=128&d=identicon&r=PG", "display_name": "Timothy Miller", "link": "https://stackoverflow.com/users/929668/timothy-miller"}, "edited": false, "score": 0, "creation_date": 1458132841, "post_id": 36035782, "comment_id": 59721465, "body": "@TimothyMiller About -O0: I want to know the salt of this problem and write the code working on any optimization level."}, {"owner": {"reputation": 468, "user_id": 1266963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae1051036e07e42ee389b4d255645115?s=128&d=identicon&r=PG", "display_name": "Yuri Syro", "link": "https://stackoverflow.com/users/1266963/yuri-syro"}, "reply_to_user": {"reputation": 12286, "user_id": 1607442, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/18451ad16ed8ad45b0a18bf70b2aa002?s=128&d=identicon&r=PG", "display_name": "Ivan Aksamentov - Drop", "link": "https://stackoverflow.com/users/1607442/ivan-aksamentov-drop"}, "edited": false, "score": 0, "creation_date": 1458132954, "post_id": 36035782, "comment_id": 59721531, "body": "@Drop I looked to the disasm, at -O1 compiler cuts comparison out."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1458132978, "post_id": 36035782, "comment_id": 59721548, "body": "There is no array declaration. So the compiler is free to assume the pointers cannot compare equal. For the <code>uintptr_t</code> comparisons, see my other comment. The different sections might also be relevant. The code is definitively broken. Fix it, don&#39;t even think about &quot;solving&quot; by removing an optimisation. UB is UB."}, {"owner": {"reputation": 26917, "user_id": 1892179, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/umfON.jpg?s=128&g=1", "display_name": "Theodoros Chatzigiannakis", "link": "https://stackoverflow.com/users/1892179/theodoros-chatzigiannakis"}, "edited": false, "score": 0, "creation_date": 1458133015, "post_id": 36035782, "comment_id": 59721593, "body": "Why can&#39;t you figure out which optimization triggered this? Did you try manually adding all optimizations of the -O1 level and then removing them one-by-one?"}, {"owner": {"reputation": 468, "user_id": 1266963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae1051036e07e42ee389b4d255645115?s=128&d=identicon&r=PG", "display_name": "Yuri Syro", "link": "https://stackoverflow.com/users/1266963/yuri-syro"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1458133202, "post_id": 36035782, "comment_id": 59721747, "body": "@Olaf Is there any flag to GCC to show all possible UB?"}, {"owner": {"reputation": 1365, "user_id": 929668, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/219fcd6acd2770ee252cc4c08aa13bf6?s=128&d=identicon&r=PG", "display_name": "Timothy Miller", "link": "https://stackoverflow.com/users/929668/timothy-miller"}, "edited": false, "score": 0, "creation_date": 1458133358, "post_id": 36035782, "comment_id": 59721867, "body": "@CheeseRussian Here&#39;s another question.  Why is it important to do this pointer comparison at compile time?  You&#39;ve obviously found a way to cast pointers so that they do compare correctly.  Why not use that?  Another thing you can do (since this is just a testing framework) is to cast all pointers you&#39;re comparing to &quot;unsigned long&quot;."}, {"owner": {"reputation": 468, "user_id": 1266963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae1051036e07e42ee389b4d255645115?s=128&d=identicon&r=PG", "display_name": "Yuri Syro", "link": "https://stackoverflow.com/users/1266963/yuri-syro"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1458133422, "post_id": 36035782, "comment_id": 59721907, "body": "@Olaf Oh, I see. Pointer arithmetic only must work inside arrays. Could you repeat it as an answer?"}, {"owner": {"reputation": 468, "user_id": 1266963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae1051036e07e42ee389b4d255645115?s=128&d=identicon&r=PG", "display_name": "Yuri Syro", "link": "https://stackoverflow.com/users/1266963/yuri-syro"}, "reply_to_user": {"reputation": 1365, "user_id": 929668, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/219fcd6acd2770ee252cc4c08aa13bf6?s=128&d=identicon&r=PG", "display_name": "Timothy Miller", "link": "https://stackoverflow.com/users/929668/timothy-miller"}, "edited": false, "score": 0, "creation_date": 1458133491, "post_id": 36035782, "comment_id": 59721958, "body": "@TimothyMiller currently, I fixed it with <code>volatile</code>, but I want to be sure."}, {"owner": {"reputation": 468, "user_id": 1266963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae1051036e07e42ee389b4d255645115?s=128&d=identicon&r=PG", "display_name": "Yuri Syro", "link": "https://stackoverflow.com/users/1266963/yuri-syro"}, "reply_to_user": {"reputation": 26917, "user_id": 1892179, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/umfON.jpg?s=128&g=1", "display_name": "Theodoros Chatzigiannakis", "link": "https://stackoverflow.com/users/1892179/theodoros-chatzigiannakis"}, "edited": false, "score": 0, "creation_date": 1458133602, "post_id": 36035782, "comment_id": 59722044, "body": "@TheodorosChatzigiannakis I tried. <code>--help=optimizers</code> and man gcc show different sets of optimizations for -O1. But both can&#39;t help. This behavior is triggered be something else."}, {"owner": {"reputation": 1365, "user_id": 929668, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/219fcd6acd2770ee252cc4c08aa13bf6?s=128&d=identicon&r=PG", "display_name": "Timothy Miller", "link": "https://stackoverflow.com/users/929668/timothy-miller"}, "edited": false, "score": 1, "creation_date": 1458133876, "post_id": 36035782, "comment_id": 59722287, "body": "@Cheese Hey, volatile is a good solution."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 2, "creation_date": 1458135580, "post_id": 36035782, "comment_id": 59723818, "body": "@Cheese: <code>volatile</code> is definitively the wrong approach. That also does not fix anything, but breaks the code even more (can there be more UB?). You just might push the border a bit further; a future gcc, a more agressive optimisation (why not use <code>-O3</code>?) or using a different compiler like clang can very well result in more subtle problems you will not detect that easy."}, {"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1458138541, "post_id": 36035782, "comment_id": 59726286, "body": "Out of curiosity: What happens if the two variables are in the same translation unit?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1458142603, "post_id": 36035782, "comment_id": 59729502, "body": "@PeterA.Schneider: That should not matter. If the compiler can prove the pointers point to different arrays (a single variable is treated here as an 1-entry array), it is free to do whatever it wants. There is no use in researching what a specific implementation does."}, {"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1458151269, "post_id": 36035782, "comment_id": 59735758, "body": "@Olaf Sorry, I find it interesting."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1458158085, "post_id": 36035782, "comment_id": 59739893, "body": "@PeterA.Schneider: So if it works with a specific compiler, on a specific time of compilation and execution, what does that say for a different compiler/other optimizer settings, a different time of day, rainy weather, etc.? - Nothing! It is undefined behaviour. Different from other UB, which can be explained by architectural requirements, this one cannot. In the contraire, it is quite obvious there are good reasons to generate different results even for the same target. So no, no knowledge gained."}, {"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1458308952, "post_id": 36035782, "comment_id": 59816573, "body": "After some discussion with M.M and reading the standard I have made a case why it is a bug. Cf. my edited post below."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1461630987, "post_id": 36035782, "comment_id": 61275654, "body": "This issue is being addressed by the standards committee as <a href=\"http://www.open-std.org/JTC1/SC22/WG14/www/docs/n2012.htm\" rel=\"nofollow noreferrer\">N2012</a> - see section &quot;Pointer provenance / Q2&quot;. Have updated my answer."}, {"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1465443629, "post_id": 36035782, "comment_id": 62905957, "body": "@Olaf No, volatile blocks some optimizations, by definition. If a future compiler breaks volatile, then you can&#39;t use it: it&#39;s broken."}, {"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1465444230, "post_id": 36035782, "comment_id": 62906092, "body": "@Olaf &quot;<i>Nothing! It is undefined behaviour</i>&quot; Prove it."}, {"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "edited": false, "score": 0, "creation_date": 1465444800, "post_id": 36035782, "comment_id": 62906227, "body": "See also <a href=\"http://stackoverflow.com/questions/32043795/dereferencing-an-out-of-bound-pointer-that-contains-the-address-of-an-object-ar\" title=\"dereferencing an out of bound pointer that contains the address of an object ar\">stackoverflow.com/questions/32043795/&hellip;</a>"}, {"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1465447869, "post_id": 36035782, "comment_id": 62907102, "body": "@Olaf &quot;<i>There is no guarantee the integer values compare equal.</i>&quot; no, but they do compare equal!"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "edited": false, "score": 0, "creation_date": 1465479236, "post_id": 36035782, "comment_id": 62926343, "body": "@curiousguy: It is not clear what your problem is with <code>volatile</code>. The behaviour is clearly specified. Also there is a defect report for the standard which clarifies the behaviour of current implementations is the correct one. It is expected to be included in the next version of the standard or some correction update. But even if not, it is the current expected behaviour. No discussion necessary. For the rest, see the link  M.M. posted, you had enough time already. To repeat: just because a specific impolementation works does not mean it is <b>not</b> UB!"}, {"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1465489152, "post_id": 36035782, "comment_id": 62933780, "body": "@Olaf I don&#39;t have a problem with volatile, I am sure it would fix the pointer comparison problem. Until the DR has been approved, validated, integrated in a TC, the implementations are non conforming. I am not sure where you are getting the idea this behavior where <code>==</code> isn&#39;t an equality is &quot;expected&quot; by users."}, {"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1465489630, "post_id": 36035782, "comment_id": 62934078, "body": "@Olaf I am not sure which DR you are talking about anyway. Anyway, it isn&#39;t a &quot;clarification&quot; when the solution proposed contradicts the reasonable (and only in this case) interpretation of a non crazy part of the standard. You are essentially claiming &quot;nothing to see, move along&quot; just in front of a major semantic crash. Not very credible!"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "edited": false, "score": 0, "creation_date": 1465492474, "post_id": 36035782, "comment_id": 62935738, "body": "@curiousguy: A DR typically already means the issue has been accepted and the corrected behaviour in the report should be implemented. Even more, as it clearly states all major compilers (at least) implement the correct behaviour as the standard&#39;s is clearly wrong. Btw, there is only one DR about <code>volatile</code>, so it should be clear which one. I&#39;ll leave it at that, because you seem not to be able to discuss without offending."}, {"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1465501101, "post_id": 36035782, "comment_id": 62940882, "body": "@Olaf &quot;<i>Even more, as it clearly states all major compilers (at least) implement the correct behaviour as the standard&#39;s is clearly wrong.</i>&quot; Hug? What is the correct behavior and how could the standard be &quot;clearly&quot; wrong when it states that <code>==</code> is an equality relation?"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1504133254, "post_id": 36035782, "comment_id": 78900737, "body": "I believe that gcc&#39;s behavior in this area is buggy, though the gcc maintainers disagree. <a href=\"https://gcc.gnu.org/bugzilla/show_bug.cgi?id=63611\" rel=\"nofollow noreferrer\">gcc.gnu.org/bugzilla/show_bug.cgi?id=63611</a> <a href=\"https://gcc.gnu.org/bugzilla/show_bug.cgi?id=61502\" rel=\"nofollow noreferrer\">gcc.gnu.org/bugzilla/show_bug.cgi?id=61502</a> There is a similar bug report for Clang, and it was fixed: <a href=\"https://bugs.llvm.org/show_bug.cgi?id=21327\" rel=\"nofollow noreferrer\">bugs.llvm.org/show_bug.cgi?id=21327</a>"}], "answers": [{"comments": [{"owner": {"reputation": 69264, "user_id": 256138, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ed9e8c0ff767e38f8fade11f5af00a45?s=128&d=identicon&r=PG", "display_name": "rubenvb", "link": "https://stackoverflow.com/users/256138/rubenvb"}, "edited": false, "score": 0, "creation_date": 1458133879, "post_id": 36036619, "comment_id": 59722288, "body": "Note that comparing the cast-to-integer-pointer value comparison is technically undefined behaviour."}, {"owner": {"reputation": 1365, "user_id": 929668, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/219fcd6acd2770ee252cc4c08aa13bf6?s=128&d=identicon&r=PG", "display_name": "Timothy Miller", "link": "https://stackoverflow.com/users/929668/timothy-miller"}, "edited": false, "score": 0, "creation_date": 1458133932, "post_id": 36036619, "comment_id": 59722338, "body": "Yes, it&#39;s &quot;technically undefined&quot; but works for most architectures.  That being said, making it &quot;volatile&quot; is probably better."}, {"owner": {"reputation": 17608, "user_id": 3650362, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fqdi1.jpg?s=128&g=1", "display_name": "trentcl", "link": "https://stackoverflow.com/users/3650362/trentcl"}, "edited": false, "score": 0, "creation_date": 1458134953, "post_id": 36036619, "comment_id": 59723256, "body": "Are these quotes from the standard or are they your own words?"}, {"owner": {"reputation": 26917, "user_id": 1892179, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/umfON.jpg?s=128&g=1", "display_name": "Theodoros Chatzigiannakis", "link": "https://stackoverflow.com/users/1892179/theodoros-chatzigiannakis"}, "reply_to_user": {"reputation": 17608, "user_id": 3650362, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fqdi1.jpg?s=128&g=1", "display_name": "trentcl", "link": "https://stackoverflow.com/users/3650362/trentcl"}, "edited": false, "score": 0, "creation_date": 1458135078, "post_id": 36036619, "comment_id": 59723362, "body": "@trentcl Anything that&#39;s in a quote box is directly from the standard (I forgot to mention that in the answer, editing)."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 1365, "user_id": 929668, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/219fcd6acd2770ee252cc4c08aa13bf6?s=128&d=identicon&r=PG", "display_name": "Timothy Miller", "link": "https://stackoverflow.com/users/929668/timothy-miller"}, "edited": false, "score": 0, "creation_date": 1458135255, "post_id": 36036619, "comment_id": 59723519, "body": "@TimothyMiller: For a 64 bit architecture, not all 64 bits are typically used for the address. So there can be bits used for other purposes. Or take old 16 bit x86/real mode: A 32 bit far pointer consisted of two fields (segment:offset)  with different combinations resulting in the same physical address. Comparing two pointers can respect this, comparing two integer conversions of the pointer likely will not."}, {"owner": {"reputation": 17608, "user_id": 3650362, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fqdi1.jpg?s=128&g=1", "display_name": "trentcl", "link": "https://stackoverflow.com/users/3650362/trentcl"}, "edited": false, "score": 0, "creation_date": 1458136410, "post_id": 36036619, "comment_id": 59724544, "body": "@TheodorosChatzigiannakis Thanks!"}], "tags": [], "owner": {"reputation": 26917, "user_id": 1892179, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/umfON.jpg?s=128&g=1", "display_name": "Theodoros Chatzigiannakis", "link": "https://stackoverflow.com/users/1892179/theodoros-chatzigiannakis"}, "is_accepted": false, "score": 8, "last_activity_date": 1458348618, "last_edit_date": 1495542869, "creation_date": 1458133703, "answer_id": 36036619, "question_id": 36035782, "link": "https://stackoverflow.com/questions/36035782/why-does-the-compiler-assume-that-these-seemingly-equal-pointers-differ/36036619#36036619", "title": "Why does the compiler assume that these seemingly equal pointers differ?", "body": "<p><code>p == &amp;b</code> is a <em>pointer</em> comparison and is subject to the following rules from the C Standard (<em>6.5.9 Equality operators, point 4</em>):</p>\n\n<blockquote>\n  <p>Two pointers compare equal if and only if both are null pointers, both are pointers to the same object (including a pointer to an object and a subobject at its beginning) or function, both are pointers to one past the last element of the same array object, or one is a pointer to one past the end of one array object and the other is a pointer to the start of a different array object that happens to immediately follow the first array object in the address space.</p>\n</blockquote>\n\n<p><code>(uintptr_t)p == (uintptr_t)&amp;b</code> is an <em>arithmetic</em> comparison and is subject to the following rules (<em>6.5.9 Equality operators, point 6</em>):</p>\n\n<blockquote>\n  <p>If both of the operands have arithmetic type, the usual arithmetic conversions are performed. Values of complex types are equal if and only if both their real parts are equal and also their imaginary parts are equal. Any two values of arithmetic types from different type domains are equal if and only if the results of their conversions to the (complex) result type determined by the usual arithmetic conversions are equal.</p>\n</blockquote>\n\n<p>These two excerpts require very different things from the implementation. And it is clear that the C specification places no requirement on an implementation to mimic the behavior of the former kind of comparison in cases where the latter kind is invoked and vice versa. <s>The implementation is only required to follow this rule (<em>7.18.1.4 Integer types capable of holding object pointers</em> in C99 or <em>7.20.1.4</em> in C11):</p>\n\n<blockquote>\n  <p>The [<code>uintptr_t</code>] type designates an unsigned integer type with the property that any valid pointer to void can be converted to this type, then converted back to pointer to void, and the result will compare equal to the original pointer.</s></p>\n</blockquote>\n\n<p><em>(Addendum: The above quote isn't applicable in this case, because the conversion from <code>int*</code> to <code>uintptr_t</code> does not involve <code>void*</code> as an intermediate step. See <a href=\"https://stackoverflow.com/a/36073020/1892179\">Hadi's answer for an explanation and citation on this</a>. Still, the conversion in question is implementation-defined and the two comparisons you are attempting are not required to exhibit the same behavior, which is the main takeaway here.)</em></p>\n\n<p>As an example of the difference, consider two pointers that point at the same address of two different address spaces. Comparing them as pointers shouldn't return true, but comparing them as unsigned integers might.</p>\n\n<p><code>&amp;a + 1</code> is an integer added to a pointer, which is subject to the following rules (<em>6.5.6 Additive operators, point 8</em>):</p>\n\n<blockquote>\n  <p>When an expression that has integer type is added to or subtracted from a pointer, the\n  result has the type of the pointer operand. If the pointer operand points to an element of\n  an array object, and the array is large enough, the result points to an element offset from\n  the original element such that the difference of the subscripts of the resulting and original\n  array elements equals the integer expression. In other words, if the expression P points to\n  the i-th element of an array object, the expressions (P)+N (equivalently, N+(P)) and\n  (P)-N (where N has the value n) point to, respectively, the i+n-th and i\u2212n-th elements of\n  the array object, provided they exist. Moreover, if the expression P points to the last\n  element of an array object, the expression (P)+1 points one past the last element of the\n  array object, and if the expression Q points one past the last element of an array object,\n  the expression (Q)-1 points to the last element of the array object. If both the pointer\n  operand and the result point to elements of the same array object, or one past the last\n  element of the array object, the evaluation shall not produce an overflow; otherwise, the\n  behavior is undefined. If the result points one past the last element of the array object, it\n  shall not be used as the operand of a unary * operator that is evaluated.</p>\n</blockquote>\n\n<p>I believe that this excerpt shows that pointer addition (and subtraction) is defined only for pointers within the same array object or one past the last element. <s>And because (1) <code>a</code> is not an array and (2) <code>a</code> and <code>b</code> aren't members of the same array object, it seems to me that your pointer math operation invokes undefined behavior and your compiler takes advantage of it to assume that the pointer comparison returns false.</s> Again as pointed out in <a href=\"https://stackoverflow.com/a/36073020/1892179\">Hadi's answer</a> (and in contrast to what my original answer assumed at this point), pointers to non-array objects can be considered pointers to array objects of length one, and thus adding one to your pointer to the scalar <em>does</em> qualify as pointing to one past the end of the array.</p>\n\n<p>Therefore your case seems to fall under the last part of the first excerpt mentioned in this answer, making your comparison well-defined to evaluate to true if and only if the two variables are linked in sequence and in ascending order. Whether this is true for your program is left unspecified by the standard and it's up to the implementation.</p>\n"}, {"comments": [{"owner": {"reputation": 59687, "user_id": 951890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01c3ef0adae5153378a3f602ca068a03?s=128&d=identicon&r=PG", "display_name": "Vaughn Cato", "link": "https://stackoverflow.com/users/951890/vaughn-cato"}, "edited": false, "score": 3, "creation_date": 1458134555, "post_id": 36036714, "comment_id": 59722856, "body": "I believe aspect 1 is implementation-defined behavior, and not undefined behavior."}, {"owner": {"reputation": 26917, "user_id": 1892179, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/umfON.jpg?s=128&g=1", "display_name": "Theodoros Chatzigiannakis", "link": "https://stackoverflow.com/users/1892179/theodoros-chatzigiannakis"}, "edited": false, "score": 1, "creation_date": 1458134875, "post_id": 36036714, "comment_id": 59723168, "body": "+1, code that breaks when an optimization is turned on should be fixed. The fact that it broke across different GCC versions is even more of a red flag that it should not be ignored."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 59687, "user_id": 951890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01c3ef0adae5153378a3f602ca068a03?s=128&d=identicon&r=PG", "display_name": "Vaughn Cato", "link": "https://stackoverflow.com/users/951890/vaughn-cato"}, "edited": false, "score": 0, "creation_date": 1458134897, "post_id": 36036714, "comment_id": 59723183, "body": "@VaughnCato: If it was implementation defined, the standard would state it and an implementation had to document it. Nevertheless there are some aspects of the conversion <b>specific</b> to the implementation, of course. Maybe you can mask-out bits not used for a pointer before comparison. But that still would leave the UB of the other code. UB means <b>anything</b> can happen - from nothing bad (worst case) to forced termination on the error (best case) and your computer jumping out of the window."}, {"owner": {"reputation": 59687, "user_id": 951890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01c3ef0adae5153378a3f602ca068a03?s=128&d=identicon&r=PG", "display_name": "Vaughn Cato", "link": "https://stackoverflow.com/users/951890/vaughn-cato"}, "edited": false, "score": 4, "creation_date": 1458135787, "post_id": 36036714, "comment_id": 59723990, "body": "My reading is that <code>(uintptr_t)p == (uintptr_t)&amp;b</code> involves two things.  One is a conversion from pointer to integer type, which has implementation-defined behavior (6.3.2.3/6), and the other is a comparison of two values of integer type, which is well-defined behavior.  I don&#39;t see what is undefined."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 59687, "user_id": 951890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01c3ef0adae5153378a3f602ca068a03?s=128&d=identicon&r=PG", "display_name": "Vaughn Cato", "link": "https://stackoverflow.com/users/951890/vaughn-cato"}, "edited": false, "score": 0, "creation_date": 1458136147, "post_id": 36036714, "comment_id": 59724306, "body": "@VaughnCato: Point taken. I left out one step. Edited my answer. There might just be unspecified bits in the converted integer."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1458139118, "post_id": 36036714, "comment_id": 59726763, "body": "Disagree/unclear with &quot;uintptr_t is guaranteed to convert from a pointer to the same type then back unchanged&quot;  pointer --&gt; <code>uintptr_t</code> --&gt; pointer results in an equivalent pointer - not necessarily the same pointer bit pattern."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1458139384, "post_id": 36036714, "comment_id": 59726957, "body": "@chux: After converting to, them from <code>uintptr_t</code> the value must compare equal. That&#39;s what I mean with unchanged. Notice the &quot;(briefly)&quot; and see the standard I referenced."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 3, "creation_date": 1458260015, "post_id": 36036714, "comment_id": 59793870, "body": "You write &quot;Your code does not have an array&quot;, however see 6.5.9/7 &quot;For the purposes of these operators, a pointer to an object that is not an element of an array behaves the same as a pointer to the first element of an array of length one with the type of the object as its element type&quot;"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1458270975, "post_id": 36036714, "comment_id": 59796659, "body": "@M.M: Yes,but only for a pointer to the object itself (i.e. the first element). But OP increments the pointer, thus it does not point to the first element, but past it. While this is allowed for an array, it is not for a single variable according to the section you cite. I don&#39;t think your downvote is justified."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 6, "creation_date": 1458275587, "post_id": 36036714, "comment_id": 59797754, "body": "Your answer reaches a wrong conclusion; <code>&amp;a + 1 == &amp;b</code> may be true. So I feel the vote is justified.   Your statement &quot;While this is allowed for an array, it is not for a single variable&quot; is rubbish because the standard clearly says the exact opposite: &quot;For the purposes of these operators, a pointer to an object that is not an element of an array behaves the same as a pointer to the first element of an array of length one with the type of the object as its element type&quot;"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1458277174, "post_id": 36036714, "comment_id": 59798188, "body": "@M.M: I just tried to clarify what I mean, but have trouble formulating. I have a stong feeling gcc is correctly optimising. I&#39;m just not sure how to phrase and fortify it with the standard understandably. Problem is <code>p</code> does <b>not</b> point to an object, but one past an object. Imo that makes p7 obsolete. In fact, I see one of the constraints unsatisfied -&gt; UB. We all forgot about those. ..."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1458277189, "post_id": 36036714, "comment_id": 59798191, "body": "@M.M: ... Problem is, the contraints don&#39;t use &quot;pointer to objects of ...&quot;, but &quot;pointers to ... versions of ...&quot;. I&#39;m not sure if this refers to objects, but how can pointers which are neither null pointers, nor point to an object nor point past an array be compared at all? - I&#39;ll have to sleep it over."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1458282446, "post_id": 36036714, "comment_id": 59800057, "body": "@Olaf &quot;pointer to object <i>type</i>&quot; means a pointer which is not a pointer to function type  (nothing to do with what it might currently be pointing at). <i>compatible type</i> is simliar. The constraints are certainly satisfied; points 6 and 7 are just for deciding whether the result is <code>1</code> or <code>0</code>  .   In C++ this same situation is <i>unspecified</i> which places lower demand on the optimizer, I agree that it is a bit annoying that the optimizer needs to check <code>&amp;a + 1</code> in case another object is just after, but this rule is useful if both objects were a struct member for example."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1458311150, "post_id": 36036714, "comment_id": 59818178, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/106729/discussion-between-olaf-and-m-m\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "is_accepted": true, "score": 12, "last_activity_date": 1458408564, "last_edit_date": 1458408564, "creation_date": 1458133953, "answer_id": 36036714, "question_id": 36035782, "link": "https://stackoverflow.com/questions/36035782/why-does-the-compiler-assume-that-these-seemingly-equal-pointers-differ/36036714#36036714", "title": "Why does the compiler assume that these seemingly equal pointers differ?", "body": "<p>There are three aspects in your code which result in general problems:</p>\n\n<ol>\n<li><p>Conversion of a pointer to an integer is <em>implementation defined</em>. There is no guarantee conversion of two pointers to have all bits identical.</p></li>\n<li><p><code>uintptr_t</code> is guaranteed to convert from a pointer to the same type then back unchanged (i.e. compare equal to the original pointer). But nothing more. The integer values <strong>themselves</strong> are not guaranteed to compare equal. E.g. there could be unused bits with arbitrary value. See the standard, <a href=\"http://port70.net/~nsz/c/c11/n1570.html#7.20.1.4\" rel=\"nofollow\">7.20.1.4</a>.</p></li>\n<li><p>And (briefly) two pointers <strong>can</strong> only compare equal if they point into the same array or right behind it (last entry plus one) or at least one is a <em>null pointer</em>. For any other constellation, they compare unequal. For the exact details, see the standard, <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.5.9p6\" rel=\"nofollow\">6.5.9p6</a>.</p></li>\n</ol>\n\n<p>Finally, there is no guarantee how variables are placed in memory by the toolchain (typically the linker for static variables, the compiler for automatic variables). Only an array or a <code>struct</code> (i.e. composite types) guarantee the ordering of its elements.</p>\n\n<p>For your example, 6.5.9p7 also applies. It basically treats a pointer to a non-array object for comparision like on to the first entry of an array of size <code>1</code>. This does <strong>not</strong> cover an incremented pointer <strong>past</strong> the object like <code>&amp;a + 1</code>. Relevant is the object the pointer is based on. That is object <code>a</code> for pointer <code>p</code> and <code>b</code> for pointer <code>&amp;b</code>. The rest can be found in paragraph 6.</p>\n\n<p>None of your variables is an array (last part of paragraph 6), so the pointers need not compare equal, even for <code>&amp;a + 1 == &amp;b</code>. The last \"TRUE\" might arise from gcc assuming the <code>uintptr_t</code> comparison returning true.</p>\n\n<p>gcc is known to agressively optimise while strictly following the standard. Other compilers are more conservative, but that results in less optimised code. <strong>Please</strong> don't try \"solving\" this by disabling optimisation or other hacks, but fix it using well-defined behaviour. It is a bug in the code.</p>\n"}, {"comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1458136274, "post_id": 36037276, "comment_id": 59724425, "body": "The language make actually an anti-guarantee."}, {"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1458136329, "post_id": 36037276, "comment_id": 59724478, "body": "@Olaf Well, &quot;undefined&quot; doesn&#39;t <i>guarantee</i> doom. It just doesn&#39;t make <i>any</i> guarantee."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1458136580, "post_id": 36037276, "comment_id": 59724702, "body": "Well, that&#39;s what I mean with &quot;anti-guarantee&quot;: It guarantees if you rely on it, you are outside the standard. Prepare for nasal daemons."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1458259164, "post_id": 36037276, "comment_id": 59793605, "body": "There is no undefined behaviour in <code>p == &amp;b</code>  .  Conceivably there is undefined behaviour in the cast to <code>uintptr_t</code> although that seems unlikely."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1458273658, "post_id": 36037276, "comment_id": 59797279, "body": "@PeterA.Schneider: gcc is well within the standard when agressively optimising. Actually I prefer such a compiler to one which pads every statement in soft cushions before optimizing. It might not be beginner-friendly, but that is not gcc&#39;s fault, but the C language itself. Luckily other compilers (notably from the embedded field) seem to start following gcc . Also note that gcc provides a large set of disagnostics to report quite some potential problems (but not all)."}, {"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1458278656, "post_id": 36037276, "comment_id": 59798679, "body": "@M.M. Thanks for pointing that out. Interesting -- the other relational operators are undefined. Any idea why that is so? Btw, a strict reading of the standard would make it undefined to test &amp;b-1 == &amp;a, even if &amp;a+1 == &amp;b (you can peek behind an array, but not in front...)"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1458282520, "post_id": 36037276, "comment_id": 59800079, "body": "<code>a &lt; b</code> is difficult to test on a segmented architecture,  or something. There might not even be an absolute ordering of all possible pointers."}, {"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1458291239, "post_id": 36037276, "comment_id": 59804445, "body": "@M.M Difficult: Hm (byte by byte? How do you test for equality?). No Ordering: Sure; but that makes it unspecified (the standard could explicitly void any of the usual guarantees), or implementation defined, but won&#39;t crash."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1460574474, "post_id": 36037276, "comment_id": 60811667, "body": "If the number of possible values for a uint64_t exceeds the number of possible different pointers, there&#39;s no requirement that p==q implies (uintptr_t)(void*)p == (uintptr_t)(void*)q.  If an implementation never uses bit 57 of a pointer, for example, it would be legal for an implementation to arbitrarily store a zero or one when converting that pointer to a uintptr_t, provided that the value of that bit in the uint64_t is ignored when converting back to a pointer."}, {"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "reply_to_user": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1460619532, "post_id": 36037276, "comment_id": 60829672, "body": "@supercat I said that much (equal pointers can conceivably convert to unequal <code>uint64_t</code> values) in the last paragraph of my post. Note that that is the opposite of the OP&#39;s problem: <i>His</i> integers compare already equal, but the pointers don&#39;t."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1460646850, "post_id": 36037276, "comment_id": 60850455, "body": "@PeterA.Schneider: Would an implementation be under any obligation to ensure that pointer-to-integer conversions of distinct pointers yield unique numbers if code never actually converted any of the numbers back to pointers?  I would expect any implementation that wasn&#39;t being deliberately obtuse should do so, but if code never converts any numbers to pointers would there be anything illegitimate about a compiler making all pointer-to-uintptr_t conversions yield 42?"}, {"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "reply_to_user": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1460647421, "post_id": 36037276, "comment_id": 60850894, "body": "@supercat That would be actively malicious."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1460647927, "post_id": 36037276, "comment_id": 60851337, "body": "@PeterA.Schneider: Of course it would be deliberately obtuse, but probably no more harmful than a lot of other deliberately-obtuse optimizations that have become fashionable, like assuming that <code>void set_float_bits(float *fp, unsigned u) { (int*)fp=u; }</code> won&#39;t modify any object of type <code>float</code> [note that <code>memcpy(&amp;fp, &amp;u, sizeof f);</code> will often yield inferior performance on almost any compiler that can&#39;t figure out where <code>fp</code> came from, since it the memcpy version could legitimately alias anything, rather than being limited to <code>float</code> or integer types.]"}, {"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "reply_to_user": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1460648633, "post_id": 36037276, "comment_id": 60851846, "body": "@supercat Breaking the aliasing rules is explicitly listed as UB; converting values isn&#39;t. It is not even indeterminate. The conversion chain pointer -&gt; void pointer -&gt; integer  and back has clearly defined semantics layed out in the relevant sections of the standard. Just because somebody doesn&#39;t go all the way doesn&#39;t void the intention. That&#39;s a big difference to the aliasing issues."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1460649415, "post_id": 36037276, "comment_id": 60852374, "body": "@PeterA.Schneider: The stated purpose of the aliasing rules was to avoid requiring compilers to treat every pointer of unknown origin as poitentially aliasing everything whose address has been exposed to outside code; it describes cases where a compiler must recognize aliasing <i>even though the compiler would have no reason to expect it</i>.  The rule is horribly written [the widespread confusion over what it means is prima facie evidence of that] but I see no reason to believe it was ever intended to allow a non-obtuse compiler writer to ignore aliasing in obvious cases like the above."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1460649929, "post_id": 36037276, "comment_id": 60852684, "body": "@PeterA.Schneider: It would have been perfectly easy in 1990 for compiler writers refrain from flushing register-cached <code>float</code> values before executing a statement which casts a <code>float*</code> to an <code>int*</code> and dereferences it; had they done so, there would have been immediate outrage and the rules would be recognized as horribly deficient.  Instead, compiler writers used common sense to recognize allowable usage patterns beyond those mandated by the Standard, and it is only because of hyper-modernist revisionism that sensible code needs to be replaced with code that is harder to read and slower."}], "tags": [], "owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "is_accepted": false, "score": 1, "last_activity_date": 1458308906, "last_edit_date": 1458308906, "creation_date": 1458135396, "answer_id": 36037276, "question_id": 36035782, "link": "https://stackoverflow.com/questions/36035782/why-does-the-compiler-assume-that-these-seemingly-equal-pointers-differ/36037276#36037276", "title": "Why does the compiler assume that these seemingly equal pointers differ?", "body": "<p>Re-reading your program I see that you are (understandably) baffled by the fact that in the optimized version</p>\n\n<pre><code>p == &amp;b\n</code></pre>\n\n<p>is false, while </p>\n\n<pre><code>(uintptr_t)p == (uintptr_t)&amp;b;\n</code></pre>\n\n<p>is true. The last line indicates that the numerical values are indeed identical; how can <code>p == &amp;b</code> then be false?? </p>\n\n<p>I must admit that I have no idea. I am convinced that it is a gcc bug.</p>\n\n<p>After a discussion with M.M I think I can make the following case if the conversion to <code>uintptr_t</code> goes  through an intermediate  void pointer (you should include that in your program and see whether it changes anything):</p>\n\n<p>Because both steps in the conversion chain <code>int*</code> -> <code>void*</code> -> <code>uintptr_t</code> are guaranteed to be reversible, <strong>unequal <code>int</code> pointers can logically not result in equal <code>uintptr_t</code> values.</strong><sup>1</sup> (Those equal uintptr_t values would have to convert back to equal int pointers, altering at least one of them and thus violating the value-preserving conversion rule.) In code (I'm not aiming for equality here, just demonstrating the conversions and comparisons):</p>\n\n<pre><code>int a,b, *ap=&amp;a, *bp = &amp;b;\n\nassert(ap != bp);\n\nvoid *avp = ap, *bvp bp;\n\nuintptr_t ua = (uintptr_t)avp, ub = (uintptr_t)bvp;\n\n// Now the following holds:\n// if ap != bp then *necessarily* ua != ub. \n// This is violated by the OP's case (sans the void* step).\n\nassert((int *)(void *)ua == (int*)(void*)ub);\n</code></pre>\n\n<hr>\n\n<p><sup>1</sup>This assumes that the uintptr_t doesn't carry hidden information in the form of padding bits which are not evaluated in an arithmetic comparison but possibly in a type conversion. One can check that through CHAR_BIT, UINTPTR_MAX, sizeof(uintptr_t) and some bit fiddling.&mdash;<br> \nFor a similar reason it's conceivable that two uintptr_t values compare <em>different</em> but convert back to the same pointer (namely if there are bits in uintptr_t not used for storing a pointer value, and the conversion does not zero them). But that is the opposite of the OP's problem.</p>\n"}, {"comments": [{"owner": {"reputation": 18599, "user_id": 4230618, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KRWgI.jpg?s=128&g=1", "display_name": "Hadi Brais", "link": "https://stackoverflow.com/users/4230618/hadi-brais"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1458261229, "post_id": 36073020, "comment_id": 59794177, "body": "@M.M Indeed. I think you&#39;re referring to the relative order of <code>a</code> and <code>b</code>. I meant implementation-dependent. I&#39;ll clarify."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1458273977, "post_id": 36073020, "comment_id": 59797363, "body": "p7 only treats the case of taking the pointer to the object itself. Not comparing an incremented version thereof. p6 is very clear about adjascent <b>arrays</b>, not scalars. (Btw: I corrected the flaw with the UB for comparing unrelated object pointers. It really was badly worded)."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1458277920, "post_id": 36073020, "comment_id": 59798445, "body": "If the constraints are not met, comparing pointers can very well be UB. <code>p</code> does not point to any object. There is no &quot;next <code>int</code>&quot; after <code>a</code> in the abstract machine."}, {"owner": {"reputation": 18599, "user_id": 4230618, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KRWgI.jpg?s=128&g=1", "display_name": "Hadi Brais", "link": "https://stackoverflow.com/users/4230618/hadi-brais"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 3, "creation_date": 1458301445, "post_id": 36073020, "comment_id": 59811114, "body": "@Olaf p6 says &quot;Two pointers compare equal if and only if...&quot;. This wording is extremely important. The &quot;if and only if&quot; part says that if any of the mentioned constraints are met then the result of the pointer equality is TRUE and if none of the constraints are met then the result of the equality must be FALSE (they cannot compare equal). In addition, p6 covers all pointers including invalid pointers (see the wording of 7.20.1.4 for comparison of wording). Finally, p6 says no where that UB is possible (see 6.5.6p8 for comparison of wording). Therefore, comparing pointers using == never..."}, {"owner": {"reputation": 18599, "user_id": 4230618, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KRWgI.jpg?s=128&g=1", "display_name": "Hadi Brais", "link": "https://stackoverflow.com/users/4230618/hadi-brais"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 2, "creation_date": 1458301455, "post_id": 36073020, "comment_id": 59811120, "body": "...results in UB. Please see 6.5.8p5 for when might this happen."}, {"owner": {"reputation": 18599, "user_id": 4230618, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KRWgI.jpg?s=128&g=1", "display_name": "Hadi Brais", "link": "https://stackoverflow.com/users/4230618/hadi-brais"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1458303262, "post_id": 36073020, "comment_id": 59812333, "body": "@Olaf Also by &quot;next <code>int</code>&quot; I mean &quot;a pointer to one past the end of one array object&quot;. That&#39;s what <code>p</code> is according to the standard in the standard&#39;s words. However, because the location of <code>b</code> is unspecified (implementation-dependent), whether the constraints mentioned in p6 are met or not is implementation-dependent. If the linker placed <code>b</code> right after <code>a</code>, the constraint that says &quot;both are pointers to one past the last element of the same array object&quot; applies. Overall, no UB."}, {"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1458306495, "post_id": 36073020, "comment_id": 59814703, "body": "That &quot;the results of check(p == &amp;b) and check((uintptr_t)p == (uintptr_t)&amp;b) are implementation-dependent&quot; does not mean they are <i>unrelated</i>: Because the back-and-forth conversion int* -&gt; void* -&gt; uintptr_t -&gt; void* -&gt; int* is guaranteed to to result in the same int* value, the uintptr_t values cannot compare equal for unequal int* values, at least not if uintptr_t has no padding bits. (Back-converting the same uintptr_t value will necessarily result in the same int* value because no other information is present.) This means the OP describes a gcc bug."}, {"owner": {"reputation": 18599, "user_id": 4230618, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KRWgI.jpg?s=128&g=1", "display_name": "Hadi Brais", "link": "https://stackoverflow.com/users/4230618/hadi-brais"}, "reply_to_user": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1458310346, "post_id": 36073020, "comment_id": 59817606, "body": "@PeterA.Schneider Yes, they might be related and yes it might be a bug (we&#39;ll have to know the version of gcc to get to the bottom of this). However, irrespective of whether there is a bug or not, the behavior of this program as far as the standard is concerned is NOT UB."}, {"owner": {"reputation": 18599, "user_id": 4230618, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KRWgI.jpg?s=128&g=1", "display_name": "Hadi Brais", "link": "https://stackoverflow.com/users/4230618/hadi-brais"}, "reply_to_user": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1458310553, "post_id": 36073020, "comment_id": 59817759, "body": "@PeterA.Schneider I would like to add that the conversion from <code>int*</code> to <code>uintptr_t</code> doesn&#39;t go through <code>void*</code>. The standard discusses this and my answer emphasizes it."}, {"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1458311501, "post_id": 36073020, "comment_id": 59818407, "body": "You are right, it didn&#39;t go through <code>void*</code> in the OP, but it should in order to be more meaningful (and my &quot;they are related&quot; was meant when doing the two-step conversion). Not that it should matter in practice... But we are deep in standard land. I have detailed this argument that this is a bug in my edited answer below."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1458313639, "post_id": 36073020, "comment_id": 59819975, "body": "@HadiBrais: see 6.5.9p2! If these constraints are not met, you <b>do</b> very well invoke UB."}, {"owner": {"reputation": 26917, "user_id": 1892179, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/umfON.jpg?s=128&g=1", "display_name": "Theodoros Chatzigiannakis", "link": "https://stackoverflow.com/users/1892179/theodoros-chatzigiannakis"}, "edited": false, "score": 1, "creation_date": 1458338666, "post_id": 36073020, "comment_id": 59834356, "body": "You are right, I completely missed the part about one-length arrays (and it makes a lot of sense, if I take a few steps back). I&#39;ve amended my answer at the places where you spotted the errors."}, {"owner": {"reputation": 18599, "user_id": 4230618, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KRWgI.jpg?s=128&g=1", "display_name": "Hadi Brais", "link": "https://stackoverflow.com/users/4230618/hadi-brais"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1458347563, "post_id": 36073020, "comment_id": 59837067, "body": "@Olaf Yes. But in this case, the second constrain &quot;both operands are pointers to qualified or unqualified versions of compatible types;&quot; applies. Both operands <code>p</code> and <code>&amp;b</code> are pointers to unqualified type <code>int</code>. Therefore, no UB. Note that no where it says that the pointers have to be valid."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1458356336, "post_id": 36073020, "comment_id": 59838622, "body": "@HadiBrais: Problem is, <code>p</code> neither points to a single object (p7) nor past or into an array (p6)."}, {"owner": {"reputation": 18599, "user_id": 4230618, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KRWgI.jpg?s=128&g=1", "display_name": "Hadi Brais", "link": "https://stackoverflow.com/users/4230618/hadi-brais"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1458387239, "post_id": 36073020, "comment_id": 59845352, "body": "@Olaf <code>p=&amp;a+1</code> The pointer <code>&amp;a</code> points to an object and by 6.5.6p7 it points to the first element of an array of length one. Now by 6.5.6p8, the expression <code>&amp;a+1</code> is a pointer to one past the last element of the array. This is all carefully mentioned in my answer. In addition, even if <code>p</code> doesn&#39;t point to an object, 6.5.9p7 doesn&#39;t stipulate that the pointer must point to an object, it says if the pointer points to an object then it is treated as a pointer to an array. That&#39;s it. 6.5.9p6 does NOT say &quot;Two  valid pointers compare equal if and only if...&quot; It says..."}, {"owner": {"reputation": 18599, "user_id": 4230618, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KRWgI.jpg?s=128&g=1", "display_name": "Hadi Brais", "link": "https://stackoverflow.com/users/4230618/hadi-brais"}, "edited": false, "score": 0, "creation_date": 1458387275, "post_id": 36073020, "comment_id": 59845361, "body": "...  &quot;Two pointers compare equal if and only if...&quot; That is, any two pointers. To put it all together, the constraints are only on the types of the pointers as specified in their declarations. But they can point to anything. This is different from other relational operators discussed in 6.5.8."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1458403058, "post_id": 36073020, "comment_id": 59850083, "body": "@HadiBrais: Not sure why you bring in 6.5.6 here. I never doubted the addition operation as such increments as expected. We talk about &amp;p` here. Problem is 6.5.9p7, which <b>requires</b> a pointer pointing to a non-array object, not one past it. Interestingly, it very well applies to <code>&amp;b</code>."}, {"owner": {"reputation": 18599, "user_id": 4230618, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KRWgI.jpg?s=128&g=1", "display_name": "Hadi Brais", "link": "https://stackoverflow.com/users/4230618/hadi-brais"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1458406068, "post_id": 36073020, "comment_id": 59851059, "body": "@Olaf Exactly right. 6.5.9p7 doesn&#39;t apply to <code>p</code> which is according to the standard one past the last element of the array. Also 6.5.9p7 applies to <code>&amp;b</code>. Therefore, the only way <code>p == &amp;b</code> to be TRUE is when the last condition in 6.5.9p6 is satisfied. That is: one is a pointer to one past the end of one array object and the other is a pointer to the start of a different array object that happens to immediately follow the first array object in the address space."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1458406603, "post_id": 36073020, "comment_id": 59851216, "body": "@HadiBrais: Problem is <code>a</code> is <b>not</b> an array, but a scalar. My problem is actually not the optimised code, but the not optimised. But I very well see the practical problems. I suspect the standard should just make such situations unspecified behaviour to allow for optimisations. That would also be logical. Maybe I/we just missread the constraints."}, {"owner": {"reputation": 18599, "user_id": 4230618, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KRWgI.jpg?s=128&g=1", "display_name": "Hadi Brais", "link": "https://stackoverflow.com/users/4230618/hadi-brais"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1458406864, "post_id": 36073020, "comment_id": 59851302, "body": "@Olaf That&#39;s why I mentioned 6.5.6p7 to you. It says that <code>a</code> is to be treated as if it was an array. And by 6.5.6p8, <code>p</code> is one past the last element of the array."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1458407022, "post_id": 36073020, "comment_id": 59851369, "body": "@HadiBrais: Again: 6.5.6 is about the addition operators! It describes hot such a pointer is to be treated for addition/subtraction. Once that operation is done, you have another pointer - done. For the comparison of <b>that</b> resulting pointer&#39;s value 6.5.9 <b>only</b> applies."}, {"owner": {"reputation": 18599, "user_id": 4230618, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KRWgI.jpg?s=128&g=1", "display_name": "Hadi Brais", "link": "https://stackoverflow.com/users/4230618/hadi-brais"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1458407526, "post_id": 36073020, "comment_id": 59851523, "body": "@Olaf This is a minor disagreement between us (it would be great if someone can help us settle this). But the major disagreement is that you say in your answer that the program invokes UB. I think you are referring to pointer comparison. I&#39;m trying to explain that pointer comparison using == never results in UB as long as one of the constraints in 6.5.9p2 is met which is the case here. It doesn&#39;t matter what these pointers are pointing to."}, {"owner": {"reputation": 18599, "user_id": 4230618, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KRWgI.jpg?s=128&g=1", "display_name": "Hadi Brais", "link": "https://stackoverflow.com/users/4230618/hadi-brais"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1458407994, "post_id": 36073020, "comment_id": 59851692, "body": "@Olaf Yes. It says at the end &quot;Please don&#39;t try &quot;solving&quot; this by disabling optimisation or other hacks, but fix it by removing the UB. It is a bug in the code.&quot;"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1458408613, "post_id": 36073020, "comment_id": 59851917, "body": "@HadiBrais: Uh, I have overlooked that during my edits. Anyway, changed."}], "tags": [], "owner": {"reputation": 18599, "user_id": 4230618, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KRWgI.jpg?s=128&g=1", "display_name": "Hadi Brais", "link": "https://stackoverflow.com/users/4230618/hadi-brais"}, "is_accepted": false, "score": 4, "last_activity_date": 1458387867, "last_edit_date": 1458387867, "creation_date": 1458254635, "answer_id": 36073020, "question_id": 36035782, "link": "https://stackoverflow.com/questions/36035782/why-does-the-compiler-assume-that-these-seemingly-equal-pointers-differ/36073020#36073020", "title": "Why does the compiler assume that these seemingly equal pointers differ?", "body": "<p>While one of the answers has already been accepted, the accepted answer (and all other answers for that matter) are critically wrong as I'll explain and then answer the question. I'll be quoting from the same C standard, namely n1570.</p>\n\n<p>Let's start with <code>&amp;a + 1</code>. In contrast to what @Theodoros and @Peter has stated,  this expression has defined behavior. To see this, consider section 6.5.6 paragraph 7 \"Additive operators\" which states:</p>\n\n<blockquote>\n  <p>For the purposes of these operators, a pointer to an object that is\n  not an element of an array behaves the same as a pointer to the first\n  element of an array of length one with the type of the object as its\n  element type.</p>\n</blockquote>\n\n<p>and paragraph 8 (in particular, the emphasized part):</p>\n\n<blockquote>\n  <p>When an expression that has integer type is added to or subtracted\n  from a pointer, the result has the type of the pointer operand. If the\n  pointer operand points to an element of an array object, and the array\n  is large enough, the result points to an element offset from the\n  original element such that the difference of the subscripts of the\n  resulting and original array elements equals the integer expression.\n  In other words, if the expression P points to the i-th element of an\n  array object, the expressions (P)+N (equivalently, N+(P)) and (P)-N\n  (where N has the value n) point to, respectively, the i+n-th and\n  i\u2212n-th elements of the array object, provided they exist. Moreover, <strong>if\n  the expression P points to the last element of an array object, the\n  expression (P)+1 points one past the last element of the array object</strong>,\n  and if the expression Q points one past the last element of an array\n  object, the expression (Q)-1 points to the last element of the array\n  object. If both the pointer operand and the result point to elements\n  of the same array object, or one past the last element of the array\n  object, the evaluation shall not produce an overflow; otherwise, the\n  behavior is undefined. If the result points one past the last element\n  of the array object, it shall not be used as the operand of a unary *\n  operator that is evaluated.</p>\n</blockquote>\n\n<p>The expression <code>(uintptr_t)p == (uintptr_t)&amp;b</code> has two parts. The conversion from a pointer to an <code>uintptr_t</code> is <strong>NOT</strong> defined by section 7.20.1.4 (in contrast to what @Olaf and @Theodoros have said):</p>\n\n<blockquote>\n  <p>The following type designates an unsigned integer type with the\n  property that any valid pointer to void can be converted to this type,\n  then converted back to pointer to void, and the result will compare\n  equal to the original pointer:</p>\n  \n  <p>uintptr_t</p>\n</blockquote>\n\n<p>It's important to recognize that this rule applies only to valid pointers to <code>void</code>. However, in this case, we have a valid pointer to <code>int</code>. A relevant paragraph can be found in section 6.3.2.3 paragraph 1:</p>\n\n<blockquote>\n  <p>A pointer to void may be converted to or from a pointer to any object\n  type. A pointer to any object type may be converted to a pointer to\n  void and back again; the result shall compare equal to the original\n  pointer.</p>\n</blockquote>\n\n<p>This means that <code>(uintptr_t)(void*)p</code> is allowed according to this paragraph and  7.20.1.4. But <code>(uintptr_t)p</code> and <code>(uintptr_t)&amp;b</code> are ruled by section 6.3.2.3 paragraph 6:</p>\n\n<blockquote>\n  <p>Any pointer type may be converted to an integer type. Except as\n  previously specified, the result is implementation-defined. If the\n  result cannot be represented in the integer type, the behavior is\n  undefined. The result need not be in the range of values of any\n  integer type.</p>\n</blockquote>\n\n<p>Note that <code>uintptr_t</code> is an integer type as stated in section 7.20.1.4 mentioned above and therefore this rule applies.</p>\n\n<p>The second part of <code>(uintptr_t)p == (uintptr_t)&amp;b</code> is comparing for equality. As previously discussed, since the result of conversion is implementation-defined, the result of equality is also implementation defined. This applies irrespective of whether the pointers themselves are equal or not.</p>\n\n<p>Now I'll discuss <code>p == &amp;b</code>. The third point in @Olaf's answer is wrong and @Theodoros's answer is incomplete regarding this expression. Section 6.5.9 \"Equality operators\" paragraph 7:</p>\n\n<blockquote>\n  <p>For the purposes of these operators, a pointer to an object that is\n  not an element of an array behaves the same as a pointer to the first\n  element of an array of length one with the type of the object as its\n  element type.</p>\n</blockquote>\n\n<p>and paragraph 6:</p>\n\n<blockquote>\n  <p>Two pointers compare equal if and only if both are null pointers,\n  both are pointers to the same object (including a pointer to an object\n  and a subobject at its beginning) or function, both are pointers to\n  one past the last element of the same array object, or one is a\n  pointer to one past the end of one array object and the other is a\n  pointer to the start of a different array object that happens to\n  immediately follow the first array object in the address space.)</p>\n</blockquote>\n\n<p>In contrast what @Olaf have said, comparing pointers using the <code>==</code> operator never results in undefined behavior (which may occur only when using relational operators such as <code>&lt;=</code> according to section 6.5.8 paragraph 5 which I'll omit here for brevity). Now since <code>p</code> points to the next <code>int</code> relative to <code>a</code>, it will be equal to <code>&amp;b</code> only when the linker has placed <code>b</code> in that location in the binary. Otherwise, there are unequal. So this is implementation-dependent (the relative order of <code>a</code> and <code>b</code> is unspecified by the standard). Since the declarations of <code>a</code> and <code>b</code> use a language extension, namely <code>__attribute__((section(\"test\")))</code>, the relative locations is indeed implementation-dependent by J.5 and 3.4.2 (omitted for brevity).</p>\n\n<p>We conclude that the results of <code>check(p == &amp;b)</code> and <code>check((uintptr_t)p == (uintptr_t)&amp;b)</code> are implementation-dependent. So the answer depends on which version of which compiler you are using. I'm using gcc 4.8 and by compiling with default options except for the level of optimization, the output I get in both -O0 and -O1 cases is all TRUE.</p>\n"}, {"comments": [{"owner": {"reputation": 18599, "user_id": 4230618, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KRWgI.jpg?s=128&g=1", "display_name": "Hadi Brais", "link": "https://stackoverflow.com/users/4230618/hadi-brais"}, "edited": false, "score": 0, "creation_date": 1458262170, "post_id": 36073898, "comment_id": 59794433, "body": "Using a language extension doesn&#39;t make the program to have undefined behavior. It just makes it NOT strictly conforming (call it loosely conforming). See appendix J and section 4."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 18599, "user_id": 4230618, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KRWgI.jpg?s=128&g=1", "display_name": "Hadi Brais", "link": "https://stackoverflow.com/users/4230618/hadi-brais"}, "edited": false, "score": 0, "creation_date": 1458262382, "post_id": 36073898, "comment_id": 59794494, "body": "@HadiBrais J.4 in C11 is &quot;Locale-specific behaviour&quot;, I guess you mean J.5 &quot;Common extensions&quot;, but nevertheless, the standard cannot define the behaviour of any such extension."}, {"owner": {"reputation": 18599, "user_id": 4230618, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KRWgI.jpg?s=128&g=1", "display_name": "Hadi Brais", "link": "https://stackoverflow.com/users/4230618/hadi-brais"}, "edited": false, "score": 1, "creation_date": 1458262792, "post_id": 36073898, "comment_id": 59794603, "body": "Yes but that doesn&#39;t make it UB. It&#39;s OK and reliable to use a language extension."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 18599, "user_id": 4230618, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KRWgI.jpg?s=128&g=1", "display_name": "Hadi Brais", "link": "https://stackoverflow.com/users/4230618/hadi-brais"}, "edited": false, "score": 0, "creation_date": 1458262869, "post_id": 36073898, "comment_id": 59794612, "body": "Anything not defined is undefined. For example no conclusions can be drawn about OP&#39;s program because the meaning of <code>__attribute__((section(&quot;test&quot;))</code> could involve changes to the results of pointer comparisons involving that pointer.  (Whether or not the compiler documents as much)."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1458271909, "post_id": 36073898, "comment_id": 59796864, "body": "&quot;The test p == &amp;b must give 1 if a and b are adjacent in the address space&quot; - By which criterion of the cited paragraphs? They both point to different objects. p7 clearly only refers to the object itself, i.e. <code>&amp;a</code>, but not past the object (<code>&amp;a + 1</code>). That is only allowed for an array. Additionally, The pointers are to different objects. Assuming <code>a</code> was an array of length <code>1</code>, <code>p</code> would still be related to object <code>a</code>, not <code>b</code>. Thus comparing the pointers is undefined behaviour."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 2, "creation_date": 1458275464, "post_id": 36073898, "comment_id": 59797721, "body": "@Olaf there is no rule that using equality operators (6.5.9) with pointers to different objects is undefined behaviour. You are thinking of relational operators (6.5.8).  &quot;By which criterion&quot; - the sentence in 6.5.9/6 ending with &quot;that happens to immediately follow the first array object in the address space&quot;. &quot;not one past the object&quot; - p7 clearly says that the object behaves like the first element of an array of length 1, and 6.5.6/8 covers adding <code>1</code> to the address of the first element of an array of length 1 (or any other length)."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1458277801, "post_id": 36073898, "comment_id": 59798389, "body": "@M.M: Yes, sorry, I&#39;m lacking the proof for UB in the comment. See the comment at my own answer. I still suspect UB, but not from these paragraphs. It is a weaker than weak argument, but I have a feeling gcc is correctly exploiting UB here; just not sure how to prove it with the standard. Feel fre to drop me a comment if you find something enlighting in either direction."}, {"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1458279819, "post_id": 36073898, "comment_id": 59799042, "body": "Can you explain how, if uintptr_t is big enough, the conversion to and comparison of uintptr_t  can be <i>true</i> if the pointer comparison isn&#39;t? I could make a theoretical (but insane) case for unused bits in uintptr_t which make such a comparison <i>wrong</i>..."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1458282686, "post_id": 36073898, "comment_id": 59800148, "body": "@PeterA.Schneider see Olaf or Hadi&#39;s answers for discussion of uintptr_t. Also note that <code>uintptr_t</code> might not even exist"}, {"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1458289907, "post_id": 36073898, "comment_id": 59803745, "body": "@M.M I have read that; I understand that the language does not make assumptions about the representation of pointers as uintptr_t and consequently about the result of operations on  such values. But even if an implementation would in practice leave bits uninitialized (unlikely) it could lead to a <i>false negative</i> equality, not to a <i>&quot;false positive&quot;</i> as in the OP&#39;s example. The same uintptr_t value would necessarily convert back to the same void pointer, which would violate the &quot;Back and forth preservation guarantee&quot; the standard makes if they were originally different. (ctd.)"}, {"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1458290328, "post_id": 36073898, "comment_id": 59803939, "body": "... The same connection can be made for <code>int *</code> to <code>void *</code> and back. I understand that the language possibly doesn&#39;t make a guarantee that after conversion to <code>void *</code> to formerly unequal pointers still <i>compare</i> unequal. But there still must be a (possibly hidden) difference because they must covert back differently, and the difference must be carried through a conversion to uintptr_t because it must also be reversable preserving the original inequality. Since we are comparing integers with uintptr_t, equality is well defined: the bits are equal. There is no room for hidden unequal bits.)"}, {"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1458290565, "post_id": 36073898, "comment_id": 59804059, "body": "As a clarification: The equality of the two uintptr_t is actually <i>not</i> false positive; as the OP says, the compiler (wrongly, as we have established) just doesn&#39;t perform the actual pointer comparison and emits false there with optimization on. The uintptr_t comparison is proper (that&#39;s why I put the &quot;false positive&quot; in double quotes. It&#39;s true positive)."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1458290978, "post_id": 36073898, "comment_id": 59804288, "body": "@PeterA.Schneider I mean, I don&#39;t want to discuss uintptr_t in these comments as it is mainly addressed by the other answers, so to keep things tidy discuss it there; my answer focuses on just the <code>p == &amp;b</code> test"}, {"owner": {"reputation": 18599, "user_id": 4230618, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KRWgI.jpg?s=128&g=1", "display_name": "Hadi Brais", "link": "https://stackoverflow.com/users/4230618/hadi-brais"}, "edited": false, "score": 0, "creation_date": 1458348447, "post_id": 36073898, "comment_id": 59837221, "body": "@M.M Regarding language extensions, you&#39;re missing the point here. Locale-specific behavior (3.4.2) is separate and different from undefined behavior (3.4.3). In fact, one of the main goals of introducing locale-specific behavior in the standard is to support language extensions without triggering UB. Section 3.4.2 clearly states that the behavior must be documented by the implementor."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 18599, "user_id": 4230618, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KRWgI.jpg?s=128&g=1", "display_name": "Hadi Brais", "link": "https://stackoverflow.com/users/4230618/hadi-brais"}, "edited": false, "score": 0, "creation_date": 1460575082, "post_id": 36073898, "comment_id": 60812025, "body": "@HadiBrais: One point of sloppiness in the Standard is that it does not make clear in what cases an implementations&#39;s specification of behavior in one situation where the Standard would otherwise impose no requirements implicitly defines behavior in related situations.  I don&#39;t think gcc&#39;s optimization here is legitimate, since even if no means existed by which a programmer could deliberately cause variables to be adjacent, gcc has no reason to believe that they couldn&#39;t be adjacent by chance, and a programmer would be entitled to expect the behavior of p==&amp;b to be consistent."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 18599, "user_id": 4230618, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KRWgI.jpg?s=128&g=1", "display_name": "Hadi Brais", "link": "https://stackoverflow.com/users/4230618/hadi-brais"}, "edited": false, "score": 0, "creation_date": 1460575295, "post_id": 36073898, "comment_id": 60812157, "body": "@HadiBrais: If e.g. one of the variables were an <code>extern</code> whose address was in the middle of the stack, I think gcc might be somewhat more entitled to assume that it can&#39;t equal the address of an automatic variable if neither that variable nor the one immediately below has ever had its address taken, on the basis that the pointer in question cannot possibly be a valid pointer to a live object, and the compiler is under no obligation to treat consistently any comparisons between pointers to dead and live objects."}, {"owner": {"reputation": 18599, "user_id": 4230618, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KRWgI.jpg?s=128&g=1", "display_name": "Hadi Brais", "link": "https://stackoverflow.com/users/4230618/hadi-brais"}, "reply_to_user": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1460577854, "post_id": 36073898, "comment_id": 60813709, "body": "@supercat Agreed. That&#39;s why I think all of the answers including my answer are incomplete. They fail to explain exactly why gcc is exhibiting this apparently unjustified inconsistency. It could be a bug in gcc."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 18599, "user_id": 4230618, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KRWgI.jpg?s=128&g=1", "display_name": "Hadi Brais", "link": "https://stackoverflow.com/users/4230618/hadi-brais"}, "edited": false, "score": 0, "creation_date": 1460590942, "post_id": 36073898, "comment_id": 60819646, "body": "@HadiBrais my answer lays out a route to removing some possible confounding factors and establishing that it is a gcc bug"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 18599, "user_id": 4230618, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KRWgI.jpg?s=128&g=1", "display_name": "Hadi Brais", "link": "https://stackoverflow.com/users/4230618/hadi-brais"}, "edited": false, "score": 1, "creation_date": 1461631325, "post_id": 36073898, "comment_id": 61275716, "body": "@HadiBrais it seems that this is intentional non-compliance by gcc, and there is a paper recommending that the standard be changed"}], "tags": [], "owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "is_accepted": false, "score": 2, "last_activity_date": 1461630934, "last_edit_date": 1461630934, "creation_date": 1458259782, "answer_id": 36073898, "question_id": 36035782, "link": "https://stackoverflow.com/questions/36035782/why-does-the-compiler-assume-that-these-seemingly-equal-pointers-differ/36073898#36073898", "title": "Why does the compiler assume that these seemingly equal pointers differ?", "body": "<p>According to C11 6.5.9/6 and C11 6.5.9/7, the test <code>p == &amp;b</code> must give <code>1</code> if <code>a</code> and <code>b</code> are adjacent in the address space. </p>\n\n<p>Your example shows that GCC appears to not fulfill this requirement of the Standard.</p>\n\n<hr>\n\n<p><strong>Update 26/Apr/2016:</strong> My original answer contained suggestions about modifying the code to remove other potential sources of UB and isolate this one condition. </p>\n\n<p>However, it's since come to light that the issues raised by this thread are <a href=\"http://www.open-std.org/JTC1/SC22/WG14/www/docs/n2012.htm\" rel=\"nofollow\">under review - N2012</a>.  </p>\n\n<p>One of their recommendations is that <code>p == &amp;b</code> should be unspecified, and they acknowledge that GCC does in fact not implement the ISO C11 requirement. </p>\n\n<p>So I have the remaining text from my answer, as it is no longer necessary to prove a \"compiler bug\", since the non-conformance (whether you want to call it a bug or not) has been established.</p>\n"}], "owner": {"reputation": 468, "user_id": 1266963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae1051036e07e42ee389b4d255645115?s=128&d=identicon&r=PG", "display_name": "Yuri Syro", "link": "https://stackoverflow.com/users/1266963/yuri-syro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 894, "favorite_count": 2, "accepted_answer_id": 36036714, "answer_count": 5, "score": 12, "last_activity_date": 1461630934, "creation_date": 1458131496, "last_edit_date": 1458388269, "question_id": 36035782, "link": "https://stackoverflow.com/questions/36035782/why-does-the-compiler-assume-that-these-seemingly-equal-pointers-differ", "title": "Why does the compiler assume that these seemingly equal pointers differ?", "body": "<p>Looks like GCC with some optimization thinks two pointers from different translation units can never be same even if they are actually the same.</p>\n\n<p>Code:</p>\n\n<p><strong>main.c</strong></p>\n\n<pre><code>#include &lt;stdint.h&gt;\n#include &lt;stdio.h&gt;\n\nint a __attribute__((section(\"test\")));\nextern int b;\n\nvoid check(int cond) { puts(cond ? \"TRUE\" : \"FALSE\"); }\n\nint main() {\n    int * p = &amp;a + 1;\n    check(\n        (p == &amp;b)\n        ==\n        ((uintptr_t)p == (uintptr_t)&amp;b)\n    );\n    check(p == &amp;b);\n    check((uintptr_t)p == (uintptr_t)&amp;b);\n    return 0;\n}\n</code></pre>\n\n<p><strong>b.c</strong></p>\n\n<pre><code>int b __attribute__((section(\"test\")));\n</code></pre>\n\n<p>If I compile it with -O0, it prints</p>\n\n<pre><code>TRUE\nTRUE\nTRUE\n</code></pre>\n\n<p>But with -O1</p>\n\n<pre><code>FALSE\nFALSE\nTRUE\n</code></pre>\n\n<p>So <code>p</code> and <code>&amp;b</code> are actually the same value, but the compiler optimized out their comparison assuming they can never be equal.</p>\n\n<p>I can't figure out, which optimization made this.</p>\n\n<p>It doesn't look like strict aliasing, because pointers are of one type, and <code>-fstrict-aliasing</code> option doesn't make this effect.</p>\n\n<p>Is this the documented behavour? Or is this a bug?</p>\n"}, {"tags": ["c", "caching", "double", "memory-alignment"], "comments": [{"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 0, "creation_date": 1458131654, "post_id": 36035705, "comment_id": 59720519, "body": "Unless you have some special requirement (e.g. using SIMD, or you need every last percent of available performance) then the default 8 byte alignment is fine."}, {"owner": {"reputation": 659, "user_id": 2463540, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/Rk0PU.jpg?s=128&g=1", "display_name": "Gaurav Saxena", "link": "https://stackoverflow.com/users/2463540/gaurav-saxena"}, "reply_to_user": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 0, "creation_date": 1458131980, "post_id": 36035705, "comment_id": 59720775, "body": "@PaulR : Yes I would like to use SIMD vectorisation, maximise performance and very importantly understand data alignment. Thanks for your reply."}, {"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 1, "creation_date": 1458132071, "post_id": 36035705, "comment_id": 59720840, "body": "OK, so 16 byte alignment for SSE then, 32 byte alignment for AVX, AVX2 (not required, but it makes life easier and can make a small difference in performance)."}, {"owner": {"reputation": 659, "user_id": 2463540, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/Rk0PU.jpg?s=128&g=1", "display_name": "Gaurav Saxena", "link": "https://stackoverflow.com/users/2463540/gaurav-saxena"}, "reply_to_user": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 0, "creation_date": 1458132150, "post_id": 36035705, "comment_id": 59720908, "body": "@PaulR: That means alignment is always processor dictated. Thanks !"}, {"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 0, "creation_date": 1458132264, "post_id": 36035705, "comment_id": 59721005, "body": "More or less - I would say it&#39;s dictated more by overall <i>architecture</i>, assuming you&#39;re looking at performance as well as absolute requirements."}], "answers": [{"tags": [], "owner": {"reputation": 13767, "user_id": 2413201, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/rxfuw.jpg?s=128&g=1", "display_name": "Armali", "link": "https://stackoverflow.com/users/2413201/armali"}, "is_accepted": false, "score": 0, "last_activity_date": 1464089453, "creation_date": 1464089453, "answer_id": 37412319, "question_id": 36035705, "link": "https://stackoverflow.com/questions/36035705/is-memory-alignment-processor-dependent-or-data-dependent-or-cache-line-length-d/37412319#37412319", "title": "Is memory alignment processor dependent or data dependent or cache line length dependent?", "body": "<p>OK, so 16 byte alignment for SSE then, 32 byte alignment for AVX, AVX2 (not required, but it makes life easier and can make a small difference in performance). \u2013 Paul R</p>\n"}], "owner": {"reputation": 659, "user_id": 2463540, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/Rk0PU.jpg?s=128&g=1", "display_name": "Gaurav Saxena", "link": "https://stackoverflow.com/users/2463540/gaurav-saxena"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1464089453, "creation_date": 1458131306, "question_id": 36035705, "link": "https://stackoverflow.com/questions/36035705/is-memory-alignment-processor-dependent-or-data-dependent-or-cache-line-length-d", "title": "Is memory alignment processor dependent or data dependent or cache line length dependent?", "body": "<p>I am dynamically declaring an <code>array of doubles</code> in <code>C</code> targeted for <code>Intel Sandy Bridge E5-2670</code> processor which has a <code>cache line size of 64 bytes</code> using <code>_mm_malloc()</code>.</p>\n\n<p>My questions are:</p>\n\n<ol>\n<li>Should the array be <code>8 byte aligned</code> (i.e. size of double) ? </li>\n<li>Should the array be <code>64 byte aligned</code> because of cache line size of 64 bytes ?</li>\n<li>Should the array be <code>32 byte aligned</code> (mentioned in a paper by <em>Saini et. al.</em> for AVX instructions) ?</li>\n</ol>\n"}, {"tags": ["c", "struct", "scanf"], "comments": [{"owner": {"reputation": 2887, "user_id": 5845470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/606531753afd42de16d82a1199fc4d45?s=128&d=identicon&r=PG&f=1", "display_name": "jdarthenay", "link": "https://stackoverflow.com/users/5845470/jdarthenay"}, "edited": false, "score": 1, "creation_date": 1458130166, "post_id": 36034973, "comment_id": 59719426, "body": "I would prefer to avoid using sqrt() when it&#39;s not necessary, and I would compare d&#178; with (x1-x2)&#178; + (y1-y2)&#178;. This would be more efficient if you need to test if a lot of points are inside the circle because you will need to compute d&#178; only once."}], "answers": [{"comments": [{"owner": {"reputation": 1542, "user_id": 2659892, "user_type": "registered", "accept_rate": 74, "profile_image": "https://graph.facebook.com/675312914/picture?type=large", "display_name": "Ilan Aizelman WS", "link": "https://stackoverflow.com/users/2659892/ilan-aizelman-ws"}, "edited": false, "score": 0, "creation_date": 1458129387, "post_id": 36035005, "comment_id": 59718881, "body": "To all variables except string sir.?"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 1542, "user_id": 2659892, "user_type": "registered", "accept_rate": 74, "profile_image": "https://graph.facebook.com/675312914/picture?type=large", "display_name": "Ilan Aizelman WS", "link": "https://stackoverflow.com/users/2659892/ilan-aizelman-ws"}, "edited": false, "score": 0, "creation_date": 1458129452, "post_id": 36035005, "comment_id": 59718919, "body": "@IlanAizelmanWS if you meant <i>string type</i> (not literal) in previous comment, then, yes."}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": true, "score": 1, "last_activity_date": 1458129497, "last_edit_date": 1458129497, "creation_date": 1458129332, "answer_id": 36035005, "question_id": 36034973, "link": "https://stackoverflow.com/questions/36034973/check-whether-a-point-inside-or-outside-a-circle-implementation-with-structs-on/36035005#36035005", "title": "Check whether a point inside or outside a circle (implementation with structs only)", "body": "<p>For <code>scanf()</code>, you need to pass the address of the variables as the argument to the supplied conversion specifiers, like</p>\n\n<pre><code>scanf(\"%f %f\", &amp;(Coordinates.x), &amp;(Coordinates.y));\n               ^                 ^\n</code></pre>\n\n<p>and for the other usage(s).</p>\n\n<p>That said, it is essential that you check the return value of <code>scanf()</code> call to ensure the success.</p>\n"}, {"tags": [], "owner": {"reputation": 401, "user_id": 4377391, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Nk8IR.jpg?s=128&g=1", "display_name": "rabi shaw", "link": "https://stackoverflow.com/users/4377391/rabi-shaw"}, "is_accepted": false, "score": 0, "last_activity_date": 1458130538, "last_edit_date": 1458130538, "creation_date": 1458129609, "answer_id": 36035101, "question_id": 36034973, "link": "https://stackoverflow.com/questions/36034973/check-whether-a-point-inside-or-outside-a-circle-implementation-with-structs-on/36035101#36035101", "title": "Check whether a point inside or outside a circle (implementation with structs only)", "body": "<pre><code>/*i think this piece of code will help you*/\n\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\ntypedef struct {\n        float x;\n        float y;\n}Point;\n\ntypedef struct {\n        Point center;\n        float radius;\n}Circle;\n\nint main()\n{\n        Point Coordinates;\n        Coordinates.x = 0;\n        Coordinates.y = 0;\n        Circle insideCircle;\n        float distance;\n        printf(\"Please enter the coordinates of your point: \");\n        scanf(\"%f %f\", &amp;(Coordinates.x), &amp;(Coordinates.y) ); //scanf requires &amp;\n        printf(\"Please enter your center coordinate and your radius: \");\n        scanf(\"%f %f %f\", &amp;(insideCircle.radius), &amp;(insideCircle.center.x), &amp;(insideCircle.center.y) );//scanf requires &amp;\n        printf(\"%f %f %f %f %f\", Coordinates.x, Coordinates.y, insideCircle.radius, insideCircle.center.x, insideCircle.center.y);\n\n        //More code for checking if distance &gt; or &lt; or = to radius to be added.\n}\n</code></pre>\n"}], "owner": {"reputation": 1542, "user_id": 2659892, "user_type": "registered", "accept_rate": 74, "profile_image": "https://graph.facebook.com/675312914/picture?type=large", "display_name": "Ilan Aizelman WS", "link": "https://stackoverflow.com/users/2659892/ilan-aizelman-ws"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 0, "accepted_answer_id": 36035005, "answer_count": 2, "score": 0, "last_activity_date": 1458130538, "creation_date": 1458129251, "last_edit_date": 1458129658, "question_id": 36034973, "link": "https://stackoverflow.com/questions/36034973/check-whether-a-point-inside-or-outside-a-circle-implementation-with-structs-on", "title": "Check whether a point inside or outside a circle (implementation with structs only)", "body": "<p>First, I've given a task to implement this with structs only.</p>\n\n<p>I need to check whether a point is inside/outside a circle.</p>\n\n<p>Input: Coordinates of the point, center of circle, radius.</p>\n\n<p>Output: Is the point inside/outside the circle.</p>\n\n<p>Well, I need to use the distance formula <code>d = sqrt( (x_1-x_2)^2 + (y_1 - y_2)^2 )</code> and then check if it is bigger/smaller/equals to the radius.</p>\n\n<p>I know the logic, but I fail with struct's syntax. can you guys help me?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;conio.h&gt;\n\ntypedef struct {\n    float x;\n    float y;\n}Point;\n\ntypedef struct {\n    Point center;\n    float radius;\n}Circle;\n\nint main()\n{\n    Point Coordinates;\n    Coordinates.x = 0; //Is this initialization necessary?\n    Coordinates.y = 0; //Is this initialization necessary?\n    Circle insideCircle;\n    float distance;\n    printf(\"Please enter the coordinates of your point: \");\n    scanf(\"%f %f\", Coordinates.x, Coordinates.y); //after input, throws error.\n    printf(\"Please enter your center coordinate and your radius: \"); \n    scanf(\"%f %f\", insideCircle.radius, insideCircle.center.x, insideCircle.center.y);\n    printf(\"%f %f %f %f %f\", Coordinates.x, Coordinates.y, insideCircle.radius, insideCircle.center.x, insideCircle.center.y);\n\n//More code for checking if distance &gt; or &lt; or = to radius to be added.\n    getch();\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "for-loop", "openmp"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 2, "creation_date": 1458129228, "post_id": 36034921, "comment_id": 59718763, "body": "Are you sure it&#39;s not the issue with missing <code>-std=c99</code> or equivalent?"}, {"owner": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "edited": false, "score": 1, "creation_date": 1458129979, "post_id": 36034921, "comment_id": 59719302, "body": "Please also define <i>will fail</i> and <i>run correctly</i>."}], "answers": [{"comments": [{"owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "edited": false, "score": 1, "creation_date": 1458130909, "post_id": 36035091, "comment_id": 59719929, "body": "Not exactly. You can declare local variables inside a loop (first instructions immediately after the <code>{</code> opening a block). Simply the loop variable must have been declared before the loop. Said differently <code>for (int i=...)</code> is rejected as a syntactic error. And Visual Studio syntax is not that old... do you remember the original K&amp;R one? :-)"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "edited": false, "score": 0, "creation_date": 1458134900, "post_id": 36035091, "comment_id": 59723191, "body": "@SergeBallesta Obviously I refer to the OPs code. But I can clarify the answer. A compiler that has not been updated even to a 17 year old standard is terribly old."}, {"owner": {"reputation": 29002, "user_id": 2542702, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fW5ka.jpg?s=128&g=1", "display_name": "Z boson", "link": "https://stackoverflow.com/users/2542702/z-boson"}, "edited": false, "score": 0, "creation_date": 1458135889, "post_id": 36035091, "comment_id": 59724084, "body": "I think technically it&#39;s called a <a href=\"http://stackoverflow.com/q/23229872/2542702\">loop initial declaration (at least that&#39;s what GCC calls it)</a>."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 29002, "user_id": 2542702, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fW5ka.jpg?s=128&g=1", "display_name": "Z boson", "link": "https://stackoverflow.com/users/2542702/z-boson"}, "edited": false, "score": 1, "creation_date": 1458136398, "post_id": 36035091, "comment_id": 59724539, "body": "@Zboson No, it is technically called <i>clause-1</i> or <i>clause-1 declaration</i>, see 6.8.5.3."}, {"owner": {"reputation": 29002, "user_id": 2542702, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fW5ka.jpg?s=128&g=1", "display_name": "Z boson", "link": "https://stackoverflow.com/users/2542702/z-boson"}, "reply_to_user": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "edited": false, "score": 0, "creation_date": 1458136537, "post_id": 36035091, "comment_id": 59724665, "body": "@SergeBallesta, was the K&amp;R syntax in this particularity case any different?"}], "tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 4, "last_activity_date": 1458134912, "last_edit_date": 1458134912, "creation_date": 1458129575, "answer_id": 36035091, "question_id": 36034921, "link": "https://stackoverflow.com/questions/36034921/why-cant-define-data-type-in-for-loop-when-i-used-openmp-in-c/36035091#36035091", "title": "why can&#39;t define data type in for-loop when I used openMP in C?", "body": "<p>To declare variables inside the first clause of a for loop, you must either use a C++ compiler or a C compiler which isn't older than 17 years. Before the year 1999, you couldn't declare variables inside a loop in C.</p>\n\n<p>Visual Studio set as C compiler is only somewhat compliant with a 26 years old C standard. It is not compliant with the current nor with the previous C standard from 1999.</p>\n\n<p>Solve this by using a modern C compiler instead.</p>\n"}], "owner": {"reputation": 11, "user_id": 5333250, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cCBbw.jpg?s=128&g=1", "display_name": "yazoo", "link": "https://stackoverflow.com/users/5333250/yazoo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1458134912, "creation_date": 1458129113, "question_id": 36034921, "link": "https://stackoverflow.com/questions/36034921/why-cant-define-data-type-in-for-loop-when-i-used-openmp-in-c", "title": "why can&#39;t define data type in for-loop when I used openMP in C?", "body": "<p>Firstly, I use Visual Studio 2015, and I have already configured the openMP environment.(I promise it's right).</p>\n\n<pre><code>#pragma omp parallel for\nfor(int i= 0; i &lt; 10; i++)\n    printf(\"%d \", i);\nprintf(\"\\n\");\n</code></pre>\n\n<p>the codes above will fail,but if I modify a litte like this:</p>\n\n<pre><code>int i;\n#pragma omp parallel for\nfor(i= 0; i &lt; 10; i++)\n    printf(\"%d \", i);\nprintf(\"\\n\");\n</code></pre>\n\n<p>the program will run correctly.</p>\n\n<p>what'a more, when I use C++(modify the first codes as .cpp), the program can alse run normally.</p>\n\n<p>why does this happen??</p>\n"}, {"tags": ["c", "arrays", "pointers"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1458128930, "post_id": 36034783, "comment_id": 59718579, "body": "Start by checking the type of <code>m1</code> or <code>m2</code>....."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 3, "creation_date": 1458128988, "post_id": 36034783, "comment_id": 59718609, "body": "2d array is not a pointer to pointer..."}, {"owner": {"reputation": 825, "user_id": 2388930, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/84b8da7e65c988dea872c9f44610cdcd?s=128&d=identicon&r=PG", "display_name": "Dimpl", "link": "https://stackoverflow.com/users/2388930/dimpl"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1458129820, "post_id": 36034783, "comment_id": 59719176, "body": "@SouravGhosh I didn&#39;t think you could get a string out of typeof()...?"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1458129893, "post_id": 36034783, "comment_id": 59719229, "body": "@Dimpl Please look at LP&#39;s comment. And sometimes just try to think before implementing., that helps. Meh."}, {"owner": {"reputation": 825, "user_id": 2388930, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/84b8da7e65c988dea872c9f44610cdcd?s=128&d=identicon&r=PG", "display_name": "Dimpl", "link": "https://stackoverflow.com/users/2388930/dimpl"}, "edited": false, "score": 0, "creation_date": 1458130354, "post_id": 36034783, "comment_id": 59719562, "body": "A 2d array is not a pointer to a pointer... except that it kind of is. See <a href=\"http://stackoverflow.com/questions/26454022/storing-and-accessing-a-2d-array-in-a-struct\" title=\"storing and accessing a 2d array in a struct\">stackoverflow.com/questions/26454022/&hellip;</a>. I asked this question as that answer doesn&#39;t address the situation where all values for the 2d array are assigned in one statement."}, {"owner": {"reputation": 825, "user_id": 2388930, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/84b8da7e65c988dea872c9f44610cdcd?s=128&d=identicon&r=PG", "display_name": "Dimpl", "link": "https://stackoverflow.com/users/2388930/dimpl"}, "edited": false, "score": 0, "creation_date": 1458131320, "post_id": 36034783, "comment_id": 59720258, "body": "To clarify, a pointer to a pointer can be used to represent a 2d array."}, {"owner": {"reputation": 825, "user_id": 2388930, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/84b8da7e65c988dea872c9f44610cdcd?s=128&d=identicon&r=PG", "display_name": "Dimpl", "link": "https://stackoverflow.com/users/2388930/dimpl"}, "edited": false, "score": 0, "creation_date": 1458135937, "post_id": 36034783, "comment_id": 59724118, "body": "I would appreciate the explanations for vote downs - I have received great answers, so the question is most definitely solvable."}, {"owner": {"reputation": 7107, "user_id": 2675154, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/81fd07359983790419b7ecf5a1098e6c?s=128&d=identicon&r=PG&f=1", "display_name": "honk", "link": "https://stackoverflow.com/users/2675154/honk"}, "edited": false, "score": 0, "creation_date": 1460881783, "post_id": 36034783, "comment_id": 60939001, "body": "@Dimpl: Maybe this answer helps a bit in understanding the differences between arrays and pointers: <a href=\"http://stackoverflow.com/a/1641963/2675154\">stackoverflow.com/a/1641963/2675154</a>"}, {"owner": {"reputation": 7107, "user_id": 2675154, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/81fd07359983790419b7ecf5a1098e6c?s=128&d=identicon&r=PG&f=1", "display_name": "honk", "link": "https://stackoverflow.com/users/2675154/honk"}, "edited": false, "score": 0, "creation_date": 1460882182, "post_id": 36034783, "comment_id": 60939081, "body": "@Dimpl: Regarding the <a href=\"http://stackoverflow.com/q/26454022/2675154\">question you linked</a>: I think, the line where the 2D array is assigned in one statement is: <code>Spiral spiral = generateSpiral(size);</code>"}, {"owner": {"reputation": 825, "user_id": 2388930, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/84b8da7e65c988dea872c9f44610cdcd?s=128&d=identicon&r=PG", "display_name": "Dimpl", "link": "https://stackoverflow.com/users/2388930/dimpl"}, "reply_to_user": {"reputation": 7107, "user_id": 2675154, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/81fd07359983790419b7ecf5a1098e6c?s=128&d=identicon&r=PG&f=1", "display_name": "honk", "link": "https://stackoverflow.com/users/2675154/honk"}, "edited": false, "score": 0, "creation_date": 1460892682, "post_id": 36034783, "comment_id": 60941970, "body": "@honk I believe I understand the difference between arrays and pointers. When I said above that it &quot;kind of is&quot;, I was referring to the fact that a 2d array data may be located by a double pointer, as a double pointer may be dereferenced using 2d array syntax. Many responses/comments have said &quot;2d array is not a pointer to pointer&quot;. While this statement is not strictly false, it is misleading as it implies that a double pointer shouldn&#39;t be used with 2d array data."}, {"owner": {"reputation": 825, "user_id": 2388930, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/84b8da7e65c988dea872c9f44610cdcd?s=128&d=identicon&r=PG", "display_name": "Dimpl", "link": "https://stackoverflow.com/users/2388930/dimpl"}, "edited": false, "score": 0, "creation_date": 1460892807, "post_id": 36034783, "comment_id": 60942000, "body": "I linked <a href=\"http://stackoverflow.com/questions/26454022/storing-and-accessing-a-2d-array-in-a-struct#answer-26454082\">that question</a> as it demonstrated that 2d array data may be stored in a double pointer. However, at the time, I did not understand malloc, so that answer was not sufficient."}], "answers": [{"comments": [{"owner": {"reputation": 825, "user_id": 2388930, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/84b8da7e65c988dea872c9f44610cdcd?s=128&d=identicon&r=PG", "display_name": "Dimpl", "link": "https://stackoverflow.com/users/2388930/dimpl"}, "edited": false, "score": 0, "creation_date": 1458129530, "post_id": 36034988, "comment_id": 59718977, "body": "This is satisfactory, though not optimal, as I would prefer to use [i][j] than [(i*3)+j]."}, {"owner": {"reputation": 825, "user_id": 2388930, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/84b8da7e65c988dea872c9f44610cdcd?s=128&d=identicon&r=PG", "display_name": "Dimpl", "link": "https://stackoverflow.com/users/2388930/dimpl"}, "edited": false, "score": 0, "creation_date": 1458135110, "post_id": 36034988, "comment_id": 59723392, "body": "Thank you, this is very good. In my application, I only access the matrix in 1 library function, so Peter A. Schneider&#39;s answer works better, but i would accept this solution too if I could."}], "tags": [], "owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "is_accepted": false, "score": 2, "last_activity_date": 1458131913, "last_edit_date": 1458131913, "creation_date": 1458129297, "answer_id": 36034988, "question_id": 36034783, "link": "https://stackoverflow.com/questions/36034783/pointer-to-existing-2d-array-of-unknown-size/36034988#36034988", "title": "Pointer to existing 2d array of unknown size?", "body": "<p>A matrix, as you declared, is not a pointer to pointer. Use a simple pointer to point its element.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nstruct matrix {\n    int h;\n    int w;\n    int* data;\n};\n\nint m1[2][2] = {\n    {1, 2},\n    {3, 4}\n};\n\nint m2[3][3] = {\n    {1, 2, 3},\n    {4, 5, 6},\n    {7, 8, 9}\n};\n\nstruct matrix matrix1 = {2, 2, &amp;m1[0][0]};\nstruct matrix matrix2 = {3, 3, &amp;m2[0][0]};\n\nint main(int argc, char **argv)\n{\n   int i, j;\n\n   for (i=0; i&lt;matrix2.h; i++)\n      for(j=0; j&lt;matrix2.w; j++)\n         printf(\"%d \", matrix2.data[(i*matrix2.h)+j]);\n\n    printf(\"\\n\");\n}\n</code></pre>\n\n<p><strong>EDIT</strong></p>\n\n<p>To answer to the comment, you can use compound literal as below. In this way you could access it with <code>[i][j]</code></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nstruct matrix {\n    int h;\n    int w;\n    int** data;\n};\n\nint *m2[3] = {\n    (int[]){1, 2, 3},\n    (int[]){4, 5, 6},\n    (int[]){7, 8, 9}\n};\n\nstruct matrix matrix2 = {3, 3, m2};\n\nint main(int argc, char **argv)\n{\n    int i, j;\n\n    for (i=0; i&lt;matrix2.h; i++)\n        for(j=0; j&lt;matrix2.w; j++)\n            printf(\"%d \", matrix2.data[i][j]);\n\n    printf(\"\\n\");\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 825, "user_id": 2388930, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/84b8da7e65c988dea872c9f44610cdcd?s=128&d=identicon&r=PG", "display_name": "Dimpl", "link": "https://stackoverflow.com/users/2388930/dimpl"}, "edited": false, "score": 0, "creation_date": 1458131711, "post_id": 36035437, "comment_id": 59720549, "body": "I can&#39;t get my head around what&#39;s going on with <code>int (*matp)[matrix2.w] = matrix2.data;</code>, but it works! I&#39;ve never seen the variable name bracketed before."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1458131747, "post_id": 36035437, "comment_id": 59720586, "body": "I think this is the least bad version. Disadvantages are that you have to cast to and from the array pointer and void pointer, and that the void pointer is not type safe. I started to write an answer which created a struct with VLA through a macro, but it was far less readable. Another alternative would be some array of pointers solution, but that&#39;s not pretty either."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 825, "user_id": 2388930, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/84b8da7e65c988dea872c9f44610cdcd?s=128&d=identicon&r=PG", "display_name": "Dimpl", "link": "https://stackoverflow.com/users/2388930/dimpl"}, "edited": false, "score": 1, "creation_date": 1458131843, "post_id": 36035437, "comment_id": 59720663, "body": "@Dimpl It creates an array pointer to a 1D array of size <code>w</code>. Then uses pointer arithmetic on such a pointer type to access each array in the 2D array. <code>matp[i][j]</code> means &quot;give me array <code>i</code>, and in that array give me item <code>j</code>&quot;."}, {"owner": {"reputation": 825, "user_id": 2388930, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/84b8da7e65c988dea872c9f44610cdcd?s=128&d=identicon&r=PG", "display_name": "Dimpl", "link": "https://stackoverflow.com/users/2388930/dimpl"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1458132171, "post_id": 36035437, "comment_id": 59720921, "body": "@Lundin Thanks. I tend to use int* for declaration and *matp for dereferencing, so got a bit mixed up."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1458132277, "post_id": 36035437, "comment_id": 59721014, "body": "Perhaps a macro could be used for the matrix pointer declaration though, to make the code more generic. <code>#define declare_matrix_ptr(name, matrix) int(*name)[matrix.w] = matrix.data</code> Not pretty but less chance for typos."}], "tags": [], "owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "is_accepted": false, "score": 2, "last_activity_date": 1458130576, "creation_date": 1458130576, "answer_id": 36035437, "question_id": 36034783, "link": "https://stackoverflow.com/questions/36034783/pointer-to-existing-2d-array-of-unknown-size/36035437#36035437", "title": "Pointer to existing 2d array of unknown size?", "body": "<p>2d array is not a pointer to pointer.</p>\n\n<p>How to use the void *.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nstruct matrix {\n    int h;\n    int w;\n    void *data;\n};\n\nint m1[2][2] = {\n    {1, 2},\n    {3, 4}\n};\n\nint m2[3][3] = {\n    {1, 2, 3},\n    {4, 5, 6},\n    {7, 8, 9}\n};\n\nstruct matrix matrix1 = {2, 2, m1};\nstruct matrix matrix2 = {3, 3, m2};\n\nint main(void){\n    int i, j;\n\n    int (*matp)[matrix2.w] = matrix2.data;//Back from the void* to pointer to array\n\n    for (i=0; i&lt;matrix2.h; i++){\n        for(j=0; j&lt;matrix2.w; j++)\n            printf(\"%d \", matp[i][j]);\n        puts(\"\");\n    }\n    printf(\"\\n\");\n\n    return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 825, "user_id": 2388930, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/84b8da7e65c988dea872c9f44610cdcd?s=128&d=identicon&r=PG", "display_name": "Dimpl", "link": "https://stackoverflow.com/users/2388930/dimpl"}, "edited": false, "score": 0, "creation_date": 1458135672, "post_id": 36035842, "comment_id": 59723890, "body": "Thank you for your answer! I am passing matrix (or matrix*, to be precise) as a parameter. Is there a way to cast inline? I tried (int(*)[mat.w])mat.data[r][c], but this didn&#39;t work."}, {"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "reply_to_user": {"reputation": 825, "user_id": 2388930, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/84b8da7e65c988dea872c9f44610cdcd?s=128&d=identicon&r=PG", "display_name": "Dimpl", "link": "https://stackoverflow.com/users/2388930/dimpl"}, "edited": false, "score": 1, "creation_date": 1458136039, "post_id": 36035842, "comment_id": 59724215, "body": "Try <code>((int(*)[mat.w])(mat.data))[r][c]</code>. <code>[]</code> and <code>.</code> have <a href=\"http://en.cppreference.com/w/c/language/operator_precedence\" rel=\"nofollow noreferrer\">higher precedence</a> than  the cast. You only want to cast <code>mat.data</code>, not <code>mat.data[r][c]</code>. That said,  <code>((int(*)[mat.w])mat.data)[r][c]</code> should do."}], "tags": [], "owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "is_accepted": true, "score": 2, "last_activity_date": 1458134057, "last_edit_date": 1458134057, "creation_date": 1458131662, "answer_id": 36035842, "question_id": 36034783, "link": "https://stackoverflow.com/questions/36034783/pointer-to-existing-2d-array-of-unknown-size/36035842#36035842", "title": "Pointer to existing 2d array of unknown size?", "body": "<p>You may be interested in the variable length arrays of C99. This solution does not directly answer your question about how to initialize the structure with a properly typed <code>data</code> (one can't); but you can use a simple pointer to store the array's address and then cast to the variable length array pointer when using <code>struct matrix</code>. </p>\n\n<p>The user side would just call functions like <code>printFroMat()</code> which receive a single argument of type <code>struct matrix</code>; the code <em>inside</em> these functions (so to speak, the library implementation) would perform the somewhat unsightly casts, as demonstrated. The <code>typedef</code> makes the cast perhaps a little more understandable because it demonstrates where the variable name in a declaration would go.</p>\n\n<p>Note that the funny <code>sizeof(m2)/sizeof(*m2)</code> etc. are not strictly necessary, you can just say <code>3</code>. But the <code>sizeof</code> expression automatically stays in sync with the actual matrix size, which quickly becomes a real asset.</p>\n\n<p>You can pass \"arrays\" (in fact: still just addresses, but of a known array type) together with their dimensions as parameters to functions, and index them the normal way (below in <code>printMatrix</code>). Example:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;string.h&gt;\n\n\nstruct matrix {\n    int h;\n    int w;\n    int *data; // first element of matrix\n};\n\nint m2[4][3] = {\n    {1, 2, 3},\n    {4, 5, 6},\n    {7, 8, 9},\n    {10, 11, 12}\n};\n\nvoid printMatrix(int dim1, int dim2, int mat[][dim2] )\n{\n    printf(\"Address of matrix: %p\\n\", (void *)mat);\n\n    for(int i1=0; i1&lt;dim1; i1++)\n    {\n        for(int i2=0; i2&lt;dim2; i2++)\n        {\n            printf(\"%d \", mat[i1][i2]);\n        }\n        putchar('\\n');\n    }\n}\n\nvoid printFromMat(struct matrix mat)\n{\n    printMatrix(mat.h, mat.w, (int (*)[mat.w])mat.data);\n\n    // or:\n    typedef int (*mT)[mat.w];\n    printMatrix(mat.h, mat.w, (mT)mat.data);\n}\n\nint main() \n{\n\n    printMatrix(   sizeof(m2) /sizeof(*m2),   // number of highest-order elements\n                   sizeof(*m2)/sizeof(**m2),  // number of second-order elements per highest-order\n                   m2  );                     // address of the first sub-array\n\n    struct matrix mat = { sizeof(m2) /sizeof(*m2), sizeof(*m2)/sizeof(**m2), *m2 };\n\n    printFromMat(mat);\n\n\n    return 0;\n}\n</code></pre>\n\n<p>Sample session:</p>\n\n<pre><code>$ gcc -std=c99 -Wall -o 2d-matrix 2d-matrix.c &amp;&amp; ./2d-matrix\nAddress of matrix: 0x100402020\n1 2 3\n4 5 6\n7 8 9\n10 11 12\nAddress of matrix: 0x100402020\n1 2 3\n4 5 6\n7 8 9\n10 11 12\nAddress of matrix: 0x100402020\n1 2 3\n4 5 6\n7 8 9\n10 11 12\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 825, "user_id": 2388930, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/84b8da7e65c988dea872c9f44610cdcd?s=128&d=identicon&r=PG", "display_name": "Dimpl", "link": "https://stackoverflow.com/users/2388930/dimpl"}, "edited": false, "score": 0, "creation_date": 1458134490, "post_id": 36035869, "comment_id": 59722802, "body": "This somewhat covers it, but I&#39;m looking for a shallow copy."}], "tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 0, "last_activity_date": 1458131748, "creation_date": 1458131748, "answer_id": 36035869, "question_id": 36034783, "link": "https://stackoverflow.com/questions/36034783/pointer-to-existing-2d-array-of-unknown-size/36035869#36035869", "title": "Pointer to existing 2d array of unknown size?", "body": "<p>You may not initialize the structure such a way like</p>\n\n<pre><code>struct matrix matrix1 = {2, 2, m1};\nstruct matrix matrix2 = {3, 3, m2};\n</code></pre>\n\n<p>because there is no conversion from types <code>int ( * )[2]</code> and <code>int ( * )[3]</code> to type <code>int **</code></p>\n\n<p>I suggest to allocate memory for copies of the arrays dynamically.</p>\n\n<p>The approach can look the following way as it is shown in the demonstrative program</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n\nstruct matrix \n{\n    size_t h;\n    size_t w;\n    int **data;\n};\n\nint m1[2][2] = \n{\n    { 1, 2 },\n    { 3, 4 }\n};\n\nint m2[3][3] = \n{\n    { 1, 2, 3 },\n    { 4, 5, 6 },\n    { 7, 8, 9 }\n};\n\nstruct matrix init( size_t h, size_t w, int a[h][w] )\n{\n    struct matrix matrix = { 0 };\n\n    matrix.data = malloc( h * sizeof( int * ) );\n\n    if ( matrix.data )\n    {\n        matrix.h = h;\n        matrix.w = w;\n        for ( size_t i = 0; i &lt; h; i++ ) \n        {            \n            matrix.data[i] = malloc( w * sizeof( int ) );\n            if ( matrix.data[i] )\n            {                \n                for ( size_t j = 0; j &lt; w; j++ ) matrix.data[i][j] = a[i][j];\n            }\n        }\n    }        \n\n    return matrix;\n}\n\nint main( void ) \n{\n    struct matrix matrix1 = init( 2, 2, m1 );\n    struct matrix matrix2 = init( 3, 3, m2 );\n\n    for ( size_t i = 0; i &lt; matrix1.h; i++ )\n    {\n        for ( size_t j = 0; j &lt; matrix1.w; j++ ) printf( \"%d \", matrix1.data[i][j] );\n        printf( \"\\n\" );\n    }\n    printf( \"\\n\" );\n\n    for ( size_t i = 0; i &lt; matrix2.h; i++ )\n    {\n        for ( size_t j = 0; j &lt; matrix2.w; j++ ) printf( \"%d \", matrix2.data[i][j] );\n        printf( \"\\n\" );\n    }\n    printf( \"\\n\" );\n\n    // free allocated arrays of matrix1 and matrix2\n}    \n</code></pre>\n\n<p>The program output is</p>\n\n<pre><code>1 2 \n3 4 \n\n1 2 3 \n4 5 6 \n7 8 9 \n</code></pre>\n\n<p>You need also to write a function that will free the allocated memory for the structure.</p>\n\n<p>The compiler must support variable length arrays.</p>\n"}], "owner": {"reputation": 825, "user_id": 2388930, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/84b8da7e65c988dea872c9f44610cdcd?s=128&d=identicon&r=PG", "display_name": "Dimpl", "link": "https://stackoverflow.com/users/2388930/dimpl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 909, "favorite_count": 0, "accepted_answer_id": 36035842, "answer_count": 4, "score": 3, "last_activity_date": 1458134057, "creation_date": 1458128763, "last_edit_date": 1458129632, "question_id": 36034783, "link": "https://stackoverflow.com/questions/36034783/pointer-to-existing-2d-array-of-unknown-size", "title": "Pointer to existing 2d array of unknown size?", "body": "<p>I have the following:</p>\n\n<pre><code>struct matrix {\n    int h;\n    int w;\n    int** data;\n};\n\nint m1[2][2] = {\n    {1, 2},\n    {3, 4}\n};\n\nint m2[3][3] = {\n    {1, 2, 3},\n    {4, 5, 6},\n    {7, 8, 9}\n};\n\nstruct matrix matrix1 = {2, 2, m1};\nstruct matrix matrix2 = {3, 3, m2};\n</code></pre>\n\n<p>This gives the error 'initialisation from incompatible pointer type'. What pointer type should I be using?</p>\n"}, {"tags": ["c", "windows", "io-redirection", "createprocess"], "comments": [{"owner": {"reputation": 15221, "user_id": 1023911, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Wln26.jpg?s=128&g=1", "display_name": "Werner Henze", "link": "https://stackoverflow.com/users/1023911/werner-henze"}, "edited": false, "score": 0, "creation_date": 1458130966, "post_id": 36034476, "comment_id": 59719981, "body": "From STARTUPINFO documentation: <i>If this flag is specified when calling one of the process creation functions, the handles must be inheritable and the function&#39;s bInheritHandles parameter must be set to TRUE. For more information, see Handle Inheritance.</i> Both requirements are not fulfilled by your code."}, {"owner": {"reputation": 59, "user_id": 4545980, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/29e66970bac96e8ef97994343f2f7076?s=128&d=identicon&r=PG", "display_name": "Nico Cnd", "link": "https://stackoverflow.com/users/4545980/nico-cnd"}, "reply_to_user": {"reputation": 15221, "user_id": 1023911, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Wln26.jpg?s=128&g=1", "display_name": "Werner Henze", "link": "https://stackoverflow.com/users/1023911/werner-henze"}, "edited": false, "score": 0, "creation_date": 1458134440, "post_id": 36034476, "comment_id": 59722753, "body": "Aaaaand I can&#39;t read... Thanks for that !"}], "answers": [{"tags": [], "owner": {"reputation": 59, "user_id": 4545980, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/29e66970bac96e8ef97994343f2f7076?s=128&d=identicon&r=PG", "display_name": "Nico Cnd", "link": "https://stackoverflow.com/users/4545980/nico-cnd"}, "is_accepted": true, "score": 0, "last_activity_date": 1458135341, "last_edit_date": 1458135341, "creation_date": 1458134679, "answer_id": 36037010, "question_id": 36034476, "link": "https://stackoverflow.com/questions/36034476/windows-createprocess-and-output-redirection/36037010#36037010", "title": "Windows CreateProcess and output redirection", "body": "<p>As pointed out in the comment, handles must be inheritable, which means replacing the <code>CreatePipe</code> like this :</p>\n\n<pre><code>SECURITY_ATTRIBUTES pipeAttrib;\nmemset(&amp;pipeAttrib, 0, sizeof(pipeAttrib));\n\npipeAttrib.nLength = sizeof(SECURITY_ATTRIBUTES);\npipeAttrib.bInheritHandle = NULL;\npipeAttrib.bInheritHandle = TRUE;\n\nif (!CreatePipe(&amp;StdOutHandles[0], &amp;StdOutHandles[1],&amp;pipeAttrib, 4096)) {\n    printf(\"Create pipe error %d\\n\", GetLastError());\n    return NULL;\n}\n</code></pre>\n\n<p>And setting <code>CreateProcess</code> 5th parameter (<code>bInheritHandles</code>) to <code>TRUE</code> instead of <code>FALSE</code>.</p>\n"}], "owner": {"reputation": 59, "user_id": 4545980, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/29e66970bac96e8ef97994343f2f7076?s=128&d=identicon&r=PG", "display_name": "Nico Cnd", "link": "https://stackoverflow.com/users/4545980/nico-cnd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 739, "favorite_count": 0, "accepted_answer_id": 36037010, "answer_count": 1, "score": 0, "last_activity_date": 1458135341, "creation_date": 1458127918, "last_edit_date": 1458131171, "question_id": 36034476, "link": "https://stackoverflow.com/questions/36034476/windows-createprocess-and-output-redirection", "title": "Windows CreateProcess and output redirection", "body": "<p>I'm working in a C project, windows environment using WinAPI.\nMy function execs a command <code>(e.g. : \"dir C:\\Users\")</code> it received as a param, and returns its output.<br>\nIt is ran from a DLL so it must not spawn a <code>cmd.exe</code> windows, which means I can't use <code>_popen</code>. So I use <code>CreateProcessA</code>, and a pipe to catch stdout.</p>\n\n<p><strong>Here is the code :</strong></p>\n\n<pre><code>char *runExec(char *command, int *contentLen) {\n    char *ret=NULL,*tmp=NULL;\n    DWORD readBytes;\n    int size=0;\n    char buffer[128],cmdBuf[4096];\n    HANDLE StdOutHandles[2];\n\n    CreatePipe(&amp;StdOutHandles[0], &amp;StdOutHandles[1], NULL, 4096);\n\n    STARTUPINFOA si;   \n    memset(&amp;si, 0, sizeof(si));\n    si.cb = sizeof(si);\n    si.dwFlags = STARTF_USESHOWWINDOW | STARTF_USESTDHANDLES;\n    si.wShowWindow = SW_HIDE;\n    si.hStdOutput = StdOutHandles[1];\n    si.hStdError = StdOutHandles[1];\n    PROCESS_INFORMATION pi;\n\n    snprintf(cmdBuf,4096,\"cmd /C %s\", command);\n    if (!CreateProcessA(NULL, cmdBuf, NULL, NULL, FALSE, CREATE_NO_WINDOW | DETACHED_PROCESS, NULL, NULL, &amp;si, &amp;pi)) {\n        printf(\"Error createProcess : %d\\n\",GetLastError());\n        return NULL;\n    }\n\n\n    CloseHandle(StdOutHandles[1]);\n    printf(\"Before read\\n\");\n    while (ReadFile(StdOutHandles[0], buffer, 127, &amp;readBytes, NULL)){\n        printf(\"IN WHILE\\n\");\n        buffer[readBytes] = 0;\n        printf(\"read %d bytes\\n\", readBytes);\n        size += readBytes;\n        tmp = (char *)realloc(ret, size + 1);\n        if (tmp == NULL) {\n            free(ret);\n            return NULL;\n        }\n        ret = tmp;\n        strncpy(ret + (size - readBytes), buffer, readBytes);\n        ret[size] = 0;\n    }\n    printf(\"Readfile returned with %d, read %d\\n\", GetLastError(),readBytes);\n\n    CloseHandle(pi.hProcess);\n    CloseHandle(pi.hThread);\n    CloseHandle(StdOutHandles[0]);\n    printf(\"#%s#\\n\", ret);\n\n    return ret;\n}\n</code></pre>\n\n<p><strong>And the output is :</strong></p>\n\n<pre><code>Before read\nReadfile returned with 109, read 0\n#(null)#\n</code></pre>\n\n<p><strong>So from that I understand that :</strong><br>\n - My loop isn't even executed once<br>\n - ReadFile reads nothing and returns Broken Pipe immediately  </p>\n\n<p>I have read various stackoverflow and MSDN pages, but I can't seem to make it work.</p>\n"}, {"tags": ["c", "data-structures", "linked-list", "queue"], "comments": [{"owner": {"reputation": 401, "user_id": 4377391, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Nk8IR.jpg?s=128&g=1", "display_name": "rabi shaw", "link": "https://stackoverflow.com/users/4377391/rabi-shaw"}, "edited": false, "score": 0, "creation_date": 1458126580, "post_id": 36033452, "comment_id": 59716988, "body": "can you please compile like this--&gt; gcc list.c queue.c main.c -o main.exe"}], "answers": [{"tags": [], "owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "is_accepted": false, "score": 0, "last_activity_date": 1458127471, "last_edit_date": 1458127471, "creation_date": 1458125946, "answer_id": 36033672, "question_id": 36033452, "link": "https://stackoverflow.com/questions/36033452/implementing-a-queue-using-an-existing-implementation-of-a-linked-list-bad-file/36033672#36033672", "title": "Implementing a queue using an existing implementation of a linked list: Bad File Number error", "body": "<p>This is not exclusively about a C programming problem but about the compiler commande not invoked correctly.</p>\n\n<p>Your compile commands are incomplete.</p>\n\n<p>Use this:</p>\n\n<pre><code>gcc -c list.c\ngcc -c queue.c\ngcc -c main.c\ngcc list.o main.o queue.o -o main.exe\n./main.exe\n</code></pre>\n\n<p>Explanation:</p>\n\n<pre><code>gcc -c list.c                           produces list.o\ngcc -c queue.c                          produces queue.o\ngcc -c main.c                           produces main.o\ngcc list.o main.o queue.o -o main.exe   invokes the linker that links the .o files\n                                        together producing main.exe\n\n./main.exe                              run the program\n</code></pre>\n\n<p>There may be other programming related issues in your C code.</p>\n"}, {"comments": [{"owner": {"reputation": 1713, "user_id": 3989939, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/530734853101ecc62e278406ed5b9065?s=128&d=identicon&r=PG&f=1", "display_name": "JavascriptLoser", "link": "https://stackoverflow.com/users/3989939/javascriptloser"}, "edited": false, "score": 0, "creation_date": 1458130261, "post_id": 36033955, "comment_id": 59719505, "body": "I went ahead and changed the <code>enqueue</code> function but it still doesn&#39;t add elements to the queue. Can you see the issue?"}, {"owner": {"reputation": 32098, "user_id": 646887, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YJ0Ye.jpg?s=128&g=1", "display_name": "Klas Lindb&#228;ck", "link": "https://stackoverflow.com/users/646887/klas-lindb%c3%a4ck"}, "reply_to_user": {"reputation": 1713, "user_id": 3989939, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/530734853101ecc62e278406ed5b9065?s=128&d=identicon&r=PG&f=1", "display_name": "JavascriptLoser", "link": "https://stackoverflow.com/users/3989939/javascriptloser"}, "edited": false, "score": 0, "creation_date": 1458132351, "post_id": 36033955, "comment_id": 59721087, "body": "When the first element is added the head of the queses changes from <code>NULL</code> to the first Queue item. You need to update the queue pointer somehow. I suggested that you return the new address, but you haven&#39;t done so, so in <code>main</code> the value of <code>q</code> never changes from the initial <code>NULL</code> value."}], "tags": [], "owner": {"reputation": 32098, "user_id": 646887, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YJ0Ye.jpg?s=128&g=1", "display_name": "Klas Lindb&#228;ck", "link": "https://stackoverflow.com/users/646887/klas-lindb%c3%a4ck"}, "is_accepted": false, "score": 0, "last_activity_date": 1458126625, "creation_date": 1458126625, "answer_id": 36033955, "question_id": 36033452, "link": "https://stackoverflow.com/questions/36033452/implementing-a-queue-using-an-existing-implementation-of-a-linked-list-bad-file/36033955#36033955", "title": "Implementing a queue using an existing implementation of a linked list: Bad File Number error", "body": "<p>Your <code>enqueue</code> function breaks the contract of the <code>push</code> method.</p>\n\n<p>The <code>push</code>method returns the new head.</p>\n\n<p>You would need:</p>\n\n<pre><code>Queue enqueue(Queue q, void *data){\n    return push(q, data);\n}\n</code></pre>\n\n<p>And in your call:</p>\n\n<pre><code>for (i = 0; i &lt; 10; i++){ \n    q = enqueue(q, &amp;i); \n}\n</code></pre>\n\n<p>Note, however that this will push the same pointer every iteration. If you change <code>i</code> you will change the value of every node in the Queue. This is probably not what you want!</p>\n\n<p>Also note that queueing the adress of a local (auto) variable is probably a bad thing and can lead to stack problems when the variable goes out of scope. (In your case <code>i</code> is declared in <code>main</code>, so it won't go out of scope until the program ends.)</p>\n"}], "owner": {"reputation": 1713, "user_id": 3989939, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/530734853101ecc62e278406ed5b9065?s=128&d=identicon&r=PG&f=1", "display_name": "JavascriptLoser", "link": "https://stackoverflow.com/users/3989939/javascriptloser"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 295, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1458130213, "creation_date": 1458125352, "last_edit_date": 1458130213, "question_id": 36033452, "link": "https://stackoverflow.com/questions/36033452/implementing-a-queue-using-an-existing-implementation-of-a-linked-list-bad-file", "title": "Implementing a queue using an existing implementation of a linked list: Bad File Number error", "body": "<p>I have been given some existing C code (a header file and some source code) for an implementation of a linked list and have been given a task to use that to implement a queue.</p>\n\n<p>Here is part of the header file I have been given with relevant function descriptions:</p>\n\n<pre><code>/* List is a pointer to a list_t struct */\ntypedef struct list_t* List;\n\nstruct list_t {\n    void *data;\n    List next;\n};\n\n/* Pushes data as the new head of list. May be used to create a new list:\n * new_list = push(NULL, data) */\nextern List push(List list, void *data);\n\n/* Pop the head off the list */\nextern void *pop(List *list);\n\n/* Return the length of the list */\nextern int len(List list);\n\n/* Returns a reversed copy of list */\nList reverse(List list);\n\n/* Prepend data to list and update list */\nextern List prepend(List *list, void *data);\n\n/* Append l1 to the end of l2 */\nvoid append(List l1, List *l2);\n\n/* Inserts data into the tail of list */\nvoid insert(void *data, List *list);\n\n/* Inserts data into the tail of list or position equal to the next element     */\nvoid insert_by(bool (*eq)(void *data, void *node), void *data, List *list);\n\n/* Inserts data into the tail of list. Returns true if sucessful,\n * false if it finds an element already equal to data */\nbool insert_if(bool (*eq)(void *data, void *node), void *data, List *list);\n\n/* Returns the node equal to aim in list, returns NULL if not found */\nextern List find(bool (*eq)(void *aim, void *node), void *aim, List list);\n\n/* Removes and returns the element equal to aim in list,\n * returns NULL if not found */\nextern void *del(bool (*eq)(void *aim, void *node), void *aim, List *list);\n\n/* Returns a new list that passes the predicate p */\nList filter(bool (*p)(void *data), List list);\n\n/* Print list to f by applying print to each node that is not NULL */\nextern void print_list(void (*print)(FILE *f, void *data), FILE *f, List node);\n\n/* Free the memory allocated to each list node */\nextern void free_list(List node);\n</code></pre>\n\n<p>I know that in order to implement a queue, I need at minimum two functions, <code>enqueue()</code> and <code>dequeue()</code>. I went ahead and created my own header file with these functions and a typedef for the queue, using the List type from the above header file:</p>\n\n<pre><code>//Queue.h\n#include \"list.h\"\n\ntypedef List Queue;\n\n//Add item to queue...\nvoid enqueue(Queue q, void *data);\n\n//removes and returns an item from the queue...\nvoid dequeue(Queue *q);\n</code></pre>\n\n<p>I then went ahead and implemented the source code in <code>queue.c</code>. I only implemented <code>enqueue</code> for now since I wanted to make sure that it worked before moving on:</p>\n\n<pre><code>#include \"queue.h\"\n\nvoid enqueue(Queue q, void *data){\n    if (q == NULL){\n        q = push(q, data);\n    }\n    else {\n        insert(data, &amp;q);\n    }\n}\n</code></pre>\n\n<p>Really simple, I know. I planned to use the following file, <code>main.c</code> to test the queue:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include \"queue.h\"\n\nint main(int argc, char **argv){\n    Queue q = NULL;\n    int i;\n    for (i = 0; i &lt; 10; i++){ enqueue(q, &amp;i); } //one line for brevity\n    return 0;\n}\n</code></pre>\n\n<p>At this point I didn't expect to see any output when I ran <code>main.c</code>, all I expected was for the program to run with no errors and then stop. Everything compiled fine, however when I ran <code>main.c</code> all I got was:</p>\n\n<pre><code>sh: ./main.exe: bad file number\n</code></pre>\n\n<p>What does this mean and can anybody pinpoint what could be causing this problem?</p>\n\n<p>EDIT: Source code was compiled as such:</p>\n\n<pre><code>gcc -c list.c\ngcc -c queue.c\ngcc -c main.c -o main.exe\n</code></pre>\n"}, {"tags": ["java", "c", "sockets", "network-programming", "file-transfer"], "comments": [{"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 1, "creation_date": 1458123448, "post_id": 36032595, "comment_id": 59714782, "body": "You&#39;re sending one byte at a time? Why?"}, {"owner": {"reputation": 2165, "user_id": 5460216, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/v3Z3y.png?s=128&g=1", "display_name": "7_R3X", "link": "https://stackoverflow.com/users/5460216/7-r3x"}, "reply_to_user": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1458123641, "post_id": 36032595, "comment_id": 59714929, "body": "How do you send the entire file at once? I don&#39;t know of any such function in C++ that could transfer entire file at once."}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1458166830, "post_id": 36032595, "comment_id": 59744594, "body": "(1) The opposite of sending a byte at a time is sending more than a byte at a time, not necessarily the entire file at once, but (2) there is <code>sendfile()</code>, since you ask."}], "answers": [{"comments": [{"owner": {"reputation": 2165, "user_id": 5460216, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/v3Z3y.png?s=128&g=1", "display_name": "7_R3X", "link": "https://stackoverflow.com/users/5460216/7-r3x"}, "edited": false, "score": 0, "creation_date": 1458124059, "post_id": 36032829, "comment_id": 59715231, "body": "Sorry, I forgot to mention that the client running on the other end is programmed in Java. The counterpart of send ie recv function cannot be used at client."}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "reply_to_user": {"reputation": 2165, "user_id": 5460216, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/v3Z3y.png?s=128&g=1", "display_name": "7_R3X", "link": "https://stackoverflow.com/users/5460216/7-r3x"}, "edited": false, "score": 1, "creation_date": 1458128226, "post_id": 36032829, "comment_id": 59718152, "body": "@7_R3X That doesn&#39;t make the slightest difference to how you should send. Unclear why you would think otherwise."}], "tags": [], "owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "is_accepted": false, "score": 2, "last_activity_date": 1458164219, "last_edit_date": 1458164219, "creation_date": 1458123732, "answer_id": 36032829, "question_id": 36032595, "link": "https://stackoverflow.com/questions/36032595/file-sending-stuck-in-the-middlesocket-programming/36032829#36032829", "title": "File sending stuck in the middle[Socket Programming]", "body": "<blockquote>\n  <p>File sending stuck</p>\n</blockquote>\n\n<p>You are sending faster than the receiver is receiving. All the intermediate socket buffers have filled up, and TCP flow control is stalling the sender.</p>\n\n<p>To solve this you would have to post the receiving code. However, I have no idea why you're sending one byte at a time. This is poor practice. Terrible. The normal way to send a file is as follows:</p>\n\n<pre><code>char buffer[8192]; // or more\nint count;\nwhile ((count = read(fileFD, buffer, sizeof buffer)) &gt; 0)\n{\n    if (send(socketFD, buffer, count, 0) &lt; 0)\n    {\n        perror(\"send\");\n        break;\n    }\n}\n</code></pre>\n\n<blockquote>\n  <p>Edit : The client at the other end is programmed in Java.</p>\n</blockquote>\n\n<p>Irrelevant.</p>\n\n<blockquote>\n  <p>The counterpart of send ie recv function cannot be used at client.</p>\n</blockquote>\n\n<p>The Java counterpart of <code>recv()</code> is <code>InputStream.read()</code>, which can be used at the client, in any of its three overloads, and there is also <code>DataInputStream.readFully()</code>.</p>\n\n<blockquote>\n  <p>This is why I'm forced to send 1 byte of file at a time.</p>\n</blockquote>\n\n<p><em>Non sequitur.</em> There is nothing here or anywhere else that forces you to send a byte at a time. </p>\n"}], "owner": {"reputation": 2165, "user_id": 5460216, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/v3Z3y.png?s=128&g=1", "display_name": "7_R3X", "link": "https://stackoverflow.com/users/5460216/7-r3x"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "closed_date": 1458330036, "answer_count": 1, "score": -2, "last_activity_date": 1458164219, "creation_date": 1458123194, "last_edit_date": 1458128300, "question_id": 36032595, "link": "https://stackoverflow.com/questions/36032595/file-sending-stuck-in-the-middlesocket-programming", "closed_reason": "Needs details or clarity", "title": "File sending stuck in the middle[Socket Programming]", "body": "<p>The following is a code snippet that I'm using to send a file to connection. The odd thing I'm facing is that the loop gets stuck in the middle for long files while the code works perfectly for small files. I transfered a file of 17636 bytes successfully however when I tried it for a file of size 1368622 bytes, the loop gets stuck at around 323850 bytes. Any idea?</p>\n\n<pre><code>f1.seekg(0,ios::beg);\n            for(i=0;i&lt;val;i++)\n            {\n                f1.get(ch);\n                uch=(unsigned char)ch;\n                nret=send(lsocket[index_control],(char*)&amp;uch,sizeof(uch),0);\n                if(nret&lt;0)\n                {\n                    cout&lt;&lt;\"\\nlsocket[\"&lt;&lt;index_control&lt;&lt;\"] : Network Connection Error.\";\n                    cout&lt;&lt;\"\\nlsocket[\"&lt;&lt;index_control&lt;&lt;\"] : Socket Is Now UnBound.\";\n                    cout&lt;&lt;\"\\nlsocket[\"&lt;&lt;index_control&lt;&lt;\"] : Abnormal termination of lsocket[\"&lt;&lt;index_control&lt;&lt;\"]\";\n                    close(lsocket[index_control]);\n                    pthread_exit(0);\n                }\n                cout&lt;&lt;\"i=\"&lt;&lt;i&lt;&lt;\"ch=\"&lt;&lt;ch;\n            }\n            cout&lt;&lt;\"\\nlsocket[\"&lt;&lt;index_control&lt;&lt;\"] : File Sent Successfully\";\n</code></pre>\n\n<p><strong>Edit</strong> : The client at the other end is programmed in Java. The counterpart of send ie recv function cannot be used at client. This is why I'm forced to send 1 byte of file at a time.</p>\n"}, {"tags": ["c", "file", "menu", "binary"], "answers": [{"comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 3, "creation_date": 1458123832, "post_id": 36032648, "comment_id": 59715071, "body": "<code>if (fp=fopen (&quot;writing.data&quot;,&quot;ab&quot;)==NULL)</code>  That&#39;s a perfect example of why trying to do too much in one line of code is a bad idea.  Two lines such as <code>fp=fopen(&quot;writing.data&quot;,&quot;ab&quot;); if (fp==NULL)...</code> is easier to understand and <i>much</i> less bug-prone."}], "tags": [], "owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "is_accepted": false, "score": 0, "last_activity_date": 1458123296, "creation_date": 1458123296, "answer_id": 36032648, "question_id": 36032428, "link": "https://stackoverflow.com/questions/36032428/binary-file-menu-writing-and-reading-in-c-issue/36032648#36032648", "title": "Binary file- menu writing and reading, in c issue", "body": "<p>This is wrong:</p>\n\n<pre><code>if (fp=fopen (\"writing.data\",\"rb\")==NULL)\n</code></pre>\n\n<p>You forgot to place the parenthesis corretly. Replace it by:</p>\n\n<pre><code>if ((fp=fopen (\"writing.data\",\"rb\"))==NULL)\n</code></pre>\n\n<p>Compile with all warnings enabled and your compiler should give you a warning.</p>\n\n<p>There are other issues, for example:</p>\n\n<pre><code>if ((fp=fopen (\"writing.data\",\"rb\")) == NULL)\n{\n    printf(\"Couldnt open the file\\n\");\n    // you should exit here, it's pointless to continue\n}\n...\n</code></pre>\n\n<p>If you continue execution when <code>fp</code> is <code>NULL</code>, you end up with an <code>fread</code> where the file pointer is <code>NULL</code> which leads to undefined behaviour (most likely your program will crash).</p>\n"}], "owner": {"reputation": 9, "user_id": 5545737, "user_type": "registered", "profile_image": "https://graph.facebook.com/981182381925237/picture?type=large", "display_name": "Dimitar Bochev", "link": "https://stackoverflow.com/users/5545737/dimitar-bochev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 88, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1458329015, "creation_date": 1458122754, "last_edit_date": 1458329015, "question_id": 36032428, "link": "https://stackoverflow.com/questions/36032428/binary-file-menu-writing-and-reading-in-c-issue", "title": "Binary file- menu writing and reading, in c issue", "body": "<p>I have to write a program for writing and reading a binary file. There should be a menu for the choice. The file should have indentification number, an article with name, parameters, etc and a price. So it has to be int|sizeof char|char|double.</p>\n\n<p>I have some issues with the code. It compiles. I open the file and write in it. But it \"dont want\" to read itself. When I remove the double slash comments to make the check the program prints the errors. I need help.</p>\n\n<p>This is the code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid writing();\nvoid reading();\nint main ()\n{\n    char choice;\n\n    /* do\n    {\n        printf(\"Enter 1 for writening in file and 2 for reading!\\n\");\n        scanf(\"%c\", &amp;choice);\n       // choice=getchar();\n        fflush(stdin);\n    }\n    while(choice!='1'&amp;&amp;choice!='2');\n    switch(choice)\n    {\n        case '1':writing(); break;\n        case '2':reading(); break;\n    } */\n\n    for (;;)\n    {\n        printf(\"Enter a number\\n\");\n        printf(\"Choose 1 for writening and 2 for reading\\n\");\n       //choice=getchar();\n        scanf(\"%c\", &amp;choice);\n        fflush(stdin);\n       if (choice=='1'||choice=='2')\n       break;\n    }\n        switch(choice)\n        {\n\n        case '1': writing (); break;\n        case '2': reading (); break;\n        }\n\n\n    return 0;\n}\nvoid writing ()\n{\n    int j,i; // size of article\n    int number;\n    char article[50];\n    double price;\n\n    FILE*fp;\n\n    printf(\"Enter a string less than 50\\n\");\n    gets(article);\n\n    //scanf(\"%c\", &amp;article);\n\n    j=(sizeof (article));\n\n    printf(\"Enter a number:\\n\");\n    scanf(\"%d\", &amp;number);\n\n    printf(\"Enter a price:\\n\");\n    scanf(\"%lf\", &amp;price);\n\n    if (fp=fopen (\"writing.data\",\"ab\")==NULL)\n    {\n        printf(\"Couldnt open the file\\n\");\n    }\n\n    fwrite(&amp;number,sizeof (int),1,fp);\n\n   /* if(fwrite(&amp;number,sizeof (int),1,fp)!=1)\n    {\n       printf(\"Error\\n\");\n    } */\n    fwrite(&amp;j,sizeof(int),1,fp);\n\n    /* if(fwrite(&amp;j,sizeof (int),1,fp)!=1)\n    {\n       printf(\"Error\\n\");\n    } */\n      fwrite(article,sizeof (article),1,fp);\n\n    /*  if(fwrite(article,sizeof (article),1,fp)!=1)\n    {\n       printf(\"Error\\n\");\n    } */\n\n    fwrite(&amp;price,sizeof (double),1,fp);\n\n    /*if(fwrite(&amp;price,sizeof (double),1,fp)!=1)\n    {\n       printf(\"Error\\n\");\n    } */\n\n    fclose(fp);\n}\n\nvoid reading()\n{\n    int i; // size of article\n    int number;\n    int number1;\n    char article[50];\n    double price;\n\n    FILE*fp;\n\n    printf(\"Enter a number to start the reading:\");\n    scanf(\"%d\", &amp;number1);\n    if (fp=fopen (\"writing.data\",\"rb\")==NULL)\n    {\n        printf(\"Couldnt open the file\\n\");\n    }\n    for (;;)\n    {\n       fread(&amp;number,sizeof(int),1,fp);\n\n      /*  if(fread(&amp;number,sizeof(int),1,fp)!=1)\n        {\n            printf(\"Error\");\n            break;\n        } */\n\n        fread(&amp;i,sizeof(int),1,fp);\n\n       /* if(fread(&amp;i,sizeof(int),1,fp)!=1)\n        {\n            printf(\"Error\");\n            exit(1);\n        } */\n\n        fread(article,sizeof(article),1,fp);\n\n       /* if(fread(article,sizeof(article),1,fp)!=1)\n        {\n            printf(\"Error\");\n            exit(2);\n        } */\n\n        fread(&amp;price,sizeof (double),1,fp);\n\n        /* if(fread(&amp;price,sizeof (double),1,fp)!=1)\n        {\n            printf(\"Error\");\n            exit(3);\n        } */\n\n        if(number==number1)\n        {\n            printf(\"%d\", number);\n            printf(article);\n            printf(\"%lf\", price);\n\n        }\n}\n fclose(fp);\n\n}\n</code></pre>\n\n<p>Ok, so i edited the parenthesis and it works. But without the checks. Thats the reason i commended them. It seems i have problem with them, can u give me more info about the checks in C and help me get these ones work.\nThese are the warnings <a href=\"http://i.stack.imgur.com/STbmd.jpg\" rel=\"nofollow\">warnings</a></p>\n\n<p>*Edit2\nI typed the code from the zero again and it works. I fixed the checks.</p>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"reputation": 190, "user_id": 4116439, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh5.googleusercontent.com/-vGAFBJS6CO4/AAAAAAAAAAI/AAAAAAAAABs/5Wa-rojSacU/photo.jpg?sz=128", "display_name": "payman", "link": "https://stackoverflow.com/users/4116439/payman"}, "edited": false, "score": 0, "creation_date": 1458122769, "post_id": 36032326, "comment_id": 59714268, "body": "No, you must have size info of the array."}, {"owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "edited": false, "score": 4, "creation_date": 1458122779, "post_id": 36032326, "comment_id": 59714279, "body": "There is no way until and unless there is a sentinel at the end of the array of strings (or whatever is the data structure)."}, {"owner": {"reputation": 1589, "user_id": 5944798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7532aec0ae828a8c2e98970b40fd1cc7?s=128&d=identicon&r=PG&f=1", "display_name": "Julien Lopez", "link": "https://stackoverflow.com/users/5944798/julien-lopez"}, "edited": false, "score": 1, "creation_date": 1458123222, "post_id": 36032326, "comment_id": 59714608, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/20358986/print-an-array-without-knowing-the-size\">Print an array, without knowing the size</a>"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1458123547, "post_id": 36032326, "comment_id": 59714856, "body": "There is no array in your code, let alone any array sizes."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 6070614, "user_type": "registered", "profile_image": "https://graph.facebook.com/690458607763196/picture?type=large", "display_name": "Magnus S&#246;rensen", "link": "https://stackoverflow.com/users/6070614/magnus-s%c3%b6rensen"}, "edited": false, "score": 0, "creation_date": 1458124755, "post_id": 36032567, "comment_id": 59715696, "body": "The second method is a god solution I&#39;m going to use it. Thanks =)"}], "tags": [], "owner": {"reputation": 19358, "user_id": 3049655, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/ZLzeP.jpg?s=128&g=1", "display_name": "Spikatrix", "link": "https://stackoverflow.com/users/3049655/spikatrix"}, "is_accepted": false, "score": 3, "last_activity_date": 1458123131, "creation_date": 1458123131, "answer_id": 36032567, "question_id": 36032326, "link": "https://stackoverflow.com/questions/36032326/printing-a-unknown-2d-array-in-c/36032567#36032567", "title": "printing a unknown 2D array in c", "body": "<p><strong>No</strong></p>\n\n<p>Other options:</p>\n\n<ol>\n<li><p>Pass the address of a variable to the function and set it to the number of elements in the array from the function:</p>\n\n<pre><code>char **table = NULL;\nsize_t n;\ntable = myfunc(&amp;n);\n</code></pre>\n\n<p>Then, the conditon could be:</p>\n\n<pre><code>while(i &lt; n) { \u2026 }\n</code></pre></li>\n<li><p>Mark the end of the array with some special value, say, <code>NULL</code>:</p>\n\n<pre><code>char **table = NULL;\ntable = myfunc(); // Table now contains something like {\"Merry\",\"Leo\",\"Linus\", \u2026, NULL}\n</code></pre>\n\n<p>Then, the conditon could be:</p>\n\n<pre><code>while(table[i]) { \u2026 }\n</code></pre></li>\n</ol>\n\n<p>Note: In both these alternatives, don't forget to make <code>i</code> a <code>size_t</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 21, "user_id": 6070614, "user_type": "registered", "profile_image": "https://graph.facebook.com/690458607763196/picture?type=large", "display_name": "Magnus S&#246;rensen", "link": "https://stackoverflow.com/users/6070614/magnus-s%c3%b6rensen"}, "edited": false, "score": 0, "creation_date": 1458124619, "post_id": 36032750, "comment_id": 59715613, "body": "God point. I&#39;m going to add a safety feature to the function."}], "tags": [], "owner": {"reputation": 3483, "user_id": 3932569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bca364f93a9dfab17419b31a8a1a504?s=128&d=identicon&r=PG&f=1", "display_name": "Garf365", "link": "https://stackoverflow.com/users/3932569/garf365"}, "is_accepted": false, "score": 0, "last_activity_date": 1458123540, "creation_date": 1458123540, "answer_id": 36032750, "question_id": 36032326, "link": "https://stackoverflow.com/questions/36032326/printing-a-unknown-2d-array-in-c/36032750#36032750", "title": "printing a unknown 2D array in c", "body": "<p>You can use sentinel. Modify your <code>myfunc</code> to add an <code>NULL</code> after the last element. Your array looks like <code>{\"Merry\", \"Leo\", ...., NULL}</code></p>\n\n<p>Now, you can iterate like that :</p>\n\n<pre><code>int i = 0;\n\nwhile (table[i] != NULL)\n{\n    printf(\"%s\", table[i]);\n    i++;\n}\n</code></pre>\n\n<p>Be careful, with solutions based on sentinels, you can have some trouble, like with string: Are you sure the sentinel are correctly set, <em>ie</em> is the data source is safe? If not, I encourage you to add a limit : <code>while(i &lt; MAX &amp;&amp; table[i] != NULL)</code>. </p>\n"}, {"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 0, "last_activity_date": 1458126046, "last_edit_date": 1458126046, "creation_date": 1458125183, "answer_id": 36033397, "question_id": 36032326, "link": "https://stackoverflow.com/questions/36032326/printing-a-unknown-2d-array-in-c/36033397#36033397", "title": "printing a unknown 2D array in c", "body": "<p>You can use the model that is used by the C Standard in function main.</p>\n\n<p>The standard declaration of the main is</p>\n\n<pre><code>int main( int argc, char * argv[] )\n{\n   //...\n}\n</code></pre>\n\n<p><code>argv[argc]</code> is always equal to NULL. Using this fact you can for example output all parameters of the main the following way</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main( int argc, char * argv[] )\n{\n    while ( *argv ) puts( *argv++ );\n}\n</code></pre>\n\n<p>So what you need for your program is that the array of strings has the last element equal to <code>NULL</code>.</p>\n\n<p>In this case you can write</p>\n\n<pre><code>   char **table = NULL;\n   table = myfunc();\n\n   for ( char **p = table; *p; ++p ) puts( *p );\n</code></pre>\n\n<p>Another way is to write the function such a way that it would also report the number of elements in the array. In this case the function can be declared either like</p>\n\n<pre><code>size_t myFunc( char ***table );\n</code></pre>\n\n<p>or like</p>\n\n<pre><code>char ** myFunc( size_t *n );\n</code></pre>\n\n<p>and called like</p>\n\n<pre><code>size_t n = myFunc( &amp;table );\n</code></pre>\n\n<p>or</p>\n\n<pre><code>size_t n;\n\ntable = myFunc( &amp;n );\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 6070614, "user_type": "registered", "profile_image": "https://graph.facebook.com/690458607763196/picture?type=large", "display_name": "Magnus S&#246;rensen", "link": "https://stackoverflow.com/users/6070614/magnus-s%c3%b6rensen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1458126046, "creation_date": 1458122510, "question_id": 36032326, "link": "https://stackoverflow.com/questions/36032326/printing-a-unknown-2d-array-in-c", "title": "printing a unknown 2D array in c", "body": "<p>I'm new to stackoverflow. </p>\n\n<p>I have a 2D array of strings with unknown size like this.</p>\n\n<pre><code>   char **table = NULL;\n   table = myfunc();   // Table now contains something like {\"Merry\",\"Leo\",\"Linus\"...} \n</code></pre>\n\n<p>Is there a way to print this array with a loop like this?</p>\n\n<pre><code>   int i = 0;\n   while(????){   // Is there a condition i can use here to loop the list? \n        printf(\"%s\", table[i]);\n        i++;\n   }\n</code></pre>\n\n<p>So i get the output below.</p>\n\n<pre><code>Merry\nLeo\nLinus\n</code></pre>\n\n<p>Thanks in advance. </p>\n"}, {"tags": ["c", "exit"], "comments": [{"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "edited": false, "score": 0, "creation_date": 1458122536, "post_id": 36032305, "comment_id": 59714094, "body": "<code>close(fd[1])</code> no, <code>close(fd[0])</code> maybe? in your code"}, {"owner": {"reputation": 10045, "user_id": 1433971, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/23a2620e16748ab95ad876b1dddf4556?s=128&d=identicon&r=PG", "display_name": "Zagorax", "link": "https://stackoverflow.com/users/1433971/zagorax"}, "reply_to_user": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "edited": false, "score": 0, "creation_date": 1458123032, "post_id": 36032305, "comment_id": 59714483, "body": "@gsamaras isn&#39;t <code>fd[0]</code> the reading end of the pipe which I&#39;m supposed to use in the parent process to read from the pipe?"}, {"owner": {"reputation": 2887, "user_id": 5845470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/606531753afd42de16d82a1199fc4d45?s=128&d=identicon&r=PG&f=1", "display_name": "jdarthenay", "link": "https://stackoverflow.com/users/5845470/jdarthenay"}, "edited": false, "score": 0, "creation_date": 1458123650, "post_id": 36032305, "comment_id": 59714935, "body": "You can <code>close(fd[1]);</code>after you duplicated it, it seems a bit cleaner to me, but I doubt this will change anything to your program&#39;s behavior."}, {"owner": {"reputation": 15165, "user_id": 1116364, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b67dfca0caba03083330d39a304b1766?s=128&d=identicon&r=PG", "display_name": "Daniel Jour", "link": "https://stackoverflow.com/users/1116364/daniel-jour"}, "edited": false, "score": 0, "creation_date": 1458123764, "post_id": 36032305, "comment_id": 59715017, "body": "What is <code>errno</code> telling you?"}, {"owner": {"reputation": 10045, "user_id": 1433971, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/23a2620e16748ab95ad876b1dddf4556?s=128&d=identicon&r=PG", "display_name": "Zagorax", "link": "https://stackoverflow.com/users/1433971/zagorax"}, "reply_to_user": {"reputation": 15165, "user_id": 1116364, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b67dfca0caba03083330d39a304b1766?s=128&d=identicon&r=PG", "display_name": "Daniel Jour", "link": "https://stackoverflow.com/users/1116364/daniel-jour"}, "edited": false, "score": 0, "creation_date": 1458123933, "post_id": 36032305, "comment_id": 59715143, "body": "@DanielJour after <code>dup</code>? It says <code>Success</code>. I stripped all debugging information, but all calls lile <code>pipe</code>, <code>fork</code> and <code>dup2</code> succeed."}, {"owner": {"reputation": 15165, "user_id": 1116364, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b67dfca0caba03083330d39a304b1766?s=128&d=identicon&r=PG", "display_name": "Daniel Jour", "link": "https://stackoverflow.com/users/1116364/daniel-jour"}, "edited": false, "score": 0, "creation_date": 1458124122, "post_id": 36032305, "comment_id": 59715272, "body": "After <code>read</code> I meant. Also: <code>text[p+1] = &quot;\\0&quot;;</code> Your compiler must be spitting a warning about that line. Your probably meant to use single quotes."}, {"owner": {"reputation": 15165, "user_id": 1116364, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b67dfca0caba03083330d39a304b1766?s=128&d=identicon&r=PG", "display_name": "Daniel Jour", "link": "https://stackoverflow.com/users/1116364/daniel-jour"}, "edited": false, "score": 0, "creation_date": 1458124357, "post_id": 36032305, "comment_id": 59715452, "body": "Also you want to use <code>p</code> as index for the null terminator, otherwise you&#39;ll get one uninitialised element."}, {"owner": {"reputation": 10045, "user_id": 1433971, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/23a2620e16748ab95ad876b1dddf4556?s=128&d=identicon&r=PG", "display_name": "Zagorax", "link": "https://stackoverflow.com/users/1433971/zagorax"}, "reply_to_user": {"reputation": 15165, "user_id": 1116364, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b67dfca0caba03083330d39a304b1766?s=128&d=identicon&r=PG", "display_name": "Daniel Jour", "link": "https://stackoverflow.com/users/1116364/daniel-jour"}, "edited": false, "score": 0, "creation_date": 1458124536, "post_id": 36032305, "comment_id": 59715567, "body": "@DanielJour Yeah, you&#39;re right. Fixed p and single quotes. Still, after the read call errno is still set to <code>Success</code>, therefore the behaviour of the program is unchanged."}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 2, "creation_date": 1458124672, "post_id": 36032305, "comment_id": 59715646, "body": "Call <code>exit</code> instead of <code>_exit</code>."}, {"owner": {"reputation": 15165, "user_id": 1116364, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b67dfca0caba03083330d39a304b1766?s=128&d=identicon&r=PG", "display_name": "Daniel Jour", "link": "https://stackoverflow.com/users/1116364/daniel-jour"}, "reply_to_user": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1458124824, "post_id": 36032305, "comment_id": 59715749, "body": "@kaylum is correct. That solves it at least on my machine. Adding <code>fflush(stdout)</code> also worked, I&#39;d assume that <code>exit</code> is doing this."}, {"owner": {"reputation": 10045, "user_id": 1433971, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/23a2620e16748ab95ad876b1dddf4556?s=128&d=identicon&r=PG", "display_name": "Zagorax", "link": "https://stackoverflow.com/users/1433971/zagorax"}, "reply_to_user": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1458125141, "post_id": 36032305, "comment_id": 59715961, "body": "@kaylum thank you very much. That solved my problem. @DanielJour, unfortunately I had tried with <code>fflush(stdout)</code> as well and that didn&#39;t work on my machine. According to man pages, <code>exit</code> is killing the process while <code>_exit</code> is killing the calling process, but still this behaviour is unclear to me, as the parent process (if I add more code) was still being executed (and eventually hang at the read call)."}, {"owner": {"reputation": 10045, "user_id": 1433971, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/23a2620e16748ab95ad876b1dddf4556?s=128&d=identicon&r=PG", "display_name": "Zagorax", "link": "https://stackoverflow.com/users/1433971/zagorax"}, "reply_to_user": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1458125468, "post_id": 36032305, "comment_id": 59716202, "body": "@kaylum can you explain while <code>exit</code> instead of <code>_exit</code> works? I searched for the difference between the two, and this answer actually suggest to use <code>_exit</code> in child processes: <a href=\"http://stackoverflow.com/a/5423108/1433971\">stackoverflow.com/a/5423108/1433971</a> Thank you!"}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 2, "creation_date": 1458126637, "post_id": 36032305, "comment_id": 59717034, "body": "<code>_exit</code> may or may not flush standard IO streams (it&#39;s implementation dependent). <code>exit</code> is guaranteed to flush standard IO streams."}], "answers": [{"comments": [{"owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "edited": false, "score": 0, "creation_date": 1458127168, "post_id": 36033967, "comment_id": 59717409, "body": "Note: Disabling buffering for <code>stdout</code> can dramatically slow performance if you&#39;re producing any meaningful amount of output. The real solution is usually &quot;call <code>exit</code> instead&quot;; <code>_exit</code> is only for very limited use cases."}, {"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "reply_to_user": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "edited": false, "score": 0, "creation_date": 1458128091, "post_id": 36033967, "comment_id": 59718048, "body": "@ShadowRanger There are cases where <code>_exit()</code> is useful (such as creating a daemon) or when you don&#39;t want the exit handlers to run when forking etc. So, what&#39;s ideal (<code>exit()</code> or ``fflush(stdout)` + <code>_exit()</code>) depends on the situation. But I agree disabling the buffering is the least preferred/useful option (except, may be, for &quot;realtime&quot; output -- otherwise, where a repeated call to fflush would be needed)."}], "tags": [], "owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "is_accepted": true, "score": 8, "last_activity_date": 1458127756, "last_edit_date": 1458127756, "creation_date": 1458126662, "answer_id": 36033967, "question_id": 36032305, "link": "https://stackoverflow.com/questions/36032305/why-is-this-simple-code-working-with-exit-and-is-not-working-with-exit/36033967#36033967", "title": "Why is this simple code working with `exit` and is not working with `_exit`?", "body": "<p><code>exit()</code> flushes all the open streams as part its termination whereas <code>_exit()</code> doesn't flush - so any buffered output is lost when calling <code>_exit()</code>.</p>\n\n<p>You can make it \"work\" either:</p>\n\n<p>1) by calling <code>fflush(stdout);</code> to flush the buffered output <em>before</em> the call to <code>_exit()</code> or<br>\n2) disabling the buffering for stdout with: <code>setbuf(stdout, 0);</code> at the beginning of the main().</p>\n\n<p>POSIX requires that streams are flushed by <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/exit.html\" rel=\"nofollow\"><code>exit()</code></a>:</p>\n\n<blockquote>\n  <p>The exit() function shall then flush all open streams with unwritten\n  buffered data and close all open streams. Finally, the process shall\n  be terminated [CX]   with the same consequences as described in\n  Consequences of Process Termination.</p>\n</blockquote>\n\n<p>Similarly, requires that streams are <em>not</em> flushed by <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/_Exit.html\" rel=\"nofollow\"><code>_exit()</code></a>:</p>\n\n<blockquote>\n  <p>The _Exit() [CX]   and _exit()  functions shall not call functions\n  registered with atexit() nor any registered signal handlers. [CX]\n  Open streams shall not be flushed.   Whether open streams are closed\n  (without flushing) is implementation-defined. Finally, the calling\n  process shall be terminated with the consequences described below.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 5718, "user_id": 15068, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7f2aa13cefa67afd0c908bf3b58a5aa8?s=128&d=identicon&r=PG&f=1", "display_name": "Friedrich", "link": "https://stackoverflow.com/users/15068/friedrich"}, "is_accepted": false, "score": 0, "last_activity_date": 1458126773, "creation_date": 1458126773, "answer_id": 36034015, "question_id": 36032305, "link": "https://stackoverflow.com/questions/36032305/why-is-this-simple-code-working-with-exit-and-is-not-working-with-exit/36034015#36034015", "title": "Why is this simple code working with `exit` and is not working with `_exit`?", "body": "<p>Usually _ is reserved for implementations. _Exit was introtuced with C99, so you probably have to use a switch to make your coompiler conform to C99.</p>\n"}, {"tags": [], "owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "is_accepted": false, "score": 2, "last_activity_date": 1458127212, "last_edit_date": 1458127212, "creation_date": 1458126838, "answer_id": 36034047, "question_id": 36032305, "link": "https://stackoverflow.com/questions/36032305/why-is-this-simple-code-working-with-exit-and-is-not-working-with-exit/36034047#36034047", "title": "Why is this simple code working with `exit` and is not working with `_exit`?", "body": "<p><code>_exit</code> terminates the process without performing the usual cleanup steps that <code>exit</code> (or returning from <code>main</code>) does. It's suggested for use in child processes for certain circumstances because it avoids performing incorrect or unnecessary cleanup; when forking a worker to perform a short task, the parent task might have unflushed I/O buffers, and using <code>_exit</code> prevents the same buffered data from being written by both the parent and the child, mysteriously duplicating output. It also prevents <code>atexit</code> handlers and the like from executing.</p>\n\n<p>In a C++ program, <a href=\"http://www.cplusplus.com/reference/cstdlib/_Exit/\" rel=\"nofollow\">it also bypasses stack unwinding, so RAII cleanup (destructor invocation) doesn't occur either</a>; mostly meaningless for purely local resources (the child exits a little quicker, but that usually doesn't matter), but important if the cleanup affects externally visible state.</p>\n"}, {"tags": [], "owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "is_accepted": false, "score": 1, "last_activity_date": 1458128086, "creation_date": 1458128086, "answer_id": 36034554, "question_id": 36032305, "link": "https://stackoverflow.com/questions/36032305/why-is-this-simple-code-working-with-exit-and-is-not-working-with-exit/36034554#36034554", "title": "Why is this simple code working with `exit` and is not working with `_exit`?", "body": "<p><code>exit</code> is a C-level function that flushes and then closes every C-level streams (stdin, stdout and stderr are C-level streams).</p>\n\n<p><code>_exit</code> is a POSIX-level function that closes every system-level streams (descriptors like 0, 1, 2, etc are system-level streams). In this case, buffering is an system internal concern.</p>\n\n<p>You've made a redirection to let <code>printf</code> (C-level function) finally writes to descriptor 1 (system-level), but <code>printf</code> buffers while buffer is not full and the C-string does not contains <code>\\n</code> (it is your case). Then terminating by a call to <code>_exit</code> will simply lost the unflushed buffer content.</p>\n\n<p>On POSIX systems, <code>exit</code> flushes every C-stream and then call <code>_exit</code> (which in turn closes every system-stream before really terminating the execution).</p>\n"}], "owner": {"reputation": 10045, "user_id": 1433971, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/23a2620e16748ab95ad876b1dddf4556?s=128&d=identicon&r=PG", "display_name": "Zagorax", "link": "https://stackoverflow.com/users/1433971/zagorax"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 226, "favorite_count": 2, "accepted_answer_id": 36033967, "answer_count": 4, "score": 3, "last_activity_date": 1458128086, "creation_date": 1458122453, "last_edit_date": 1458126299, "question_id": 36032305, "link": "https://stackoverflow.com/questions/36032305/why-is-this-simple-code-working-with-exit-and-is-not-working-with-exit", "title": "Why is this simple code working with `exit` and is not working with `_exit`?", "body": "<p>Please, have a look at this sample code which is using a very well established programming pattern to redirect <code>stdout</code> to a pipe.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n\nint main(int argc, char **argv)\n{\n    int fd[2];\n    pipe(fd);\n\n    pid_t pid = fork();\n    if (pid == 0) {\n        close(fd[0]);\n        dup2(fd[1], 1);\n        printf(\"A string\");\n        _exit(0);\n    }\n\n    close(fd[1]);\n    char text[1000];\n    size_t size;\n    int p = 0;\n    while ((size = read(fd[0], text+p, 1)) == 1) {\n        p++;\n    }\n    close(fd[0]);\n    text[p] = '\\0';\n    printf(\"%s\", text);\n\n    return 0;\n}\n</code></pre>\n\n<p>The code, as it is, is not working. As correctly suggested in a comment by @kaylum, calling <code>exit</code> instead of <code>_exit</code> in the child process makes the code working properly.</p>\n"}, {"tags": ["c", "fwrite", "fread"], "comments": [{"owner": {"reputation": 115745, "user_id": 119527, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lTjBL.png?s=128&g=1", "display_name": "Jonathon Reinhart", "link": "https://stackoverflow.com/users/119527/jonathon-reinhart"}, "edited": false, "score": 6, "creation_date": 1458121703, "post_id": 36031891, "comment_id": 59713490, "body": "You&#39;re not checking for errors. You&#39;re not printing errno. You haven&#39;t confirmed that the exists on disk with the correct contents. C&#39;mon, basic debugging here..."}, {"owner": {"reputation": 62800, "user_id": 391161, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/fb76d8bcc69144a3ee4c893ece7fc588?s=128&d=identicon&r=PG&f=1", "display_name": "merlin2011", "link": "https://stackoverflow.com/users/391161/merlin2011"}, "edited": false, "score": 1, "creation_date": 1458121741, "post_id": 36031891, "comment_id": 59713518, "body": "Where are you allocating memory?"}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 1, "creation_date": 1458122087, "post_id": 36031891, "comment_id": 59713770, "body": "Do you have an <code>fclose</code> or <code>fflush</code> after the <code>fwrite</code> and before the <code>fread</code>?"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 3, "creation_date": 1458122132, "post_id": 36031891, "comment_id": 59713805, "body": "Please provide a <a href=\"http://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable example</a>."}], "answers": [{"comments": [{"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 1, "creation_date": 1458122188, "post_id": 36032109, "comment_id": 59713842, "body": "All good information. But it is not clear how that explains <code>fread</code> returning 0 after the <code>fwrite</code>. Could you address that in your answer?"}, {"owner": {"reputation": 15165, "user_id": 1116364, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b67dfca0caba03083330d39a304b1766?s=128&d=identicon&r=PG", "display_name": "Daniel Jour", "link": "https://stackoverflow.com/users/1116364/daniel-jour"}, "reply_to_user": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1458122533, "post_id": 36032109, "comment_id": 59714092, "body": "@kaylum Good point, tried to address this, though this is highly guessing since any form of error checking seems to be  missing."}], "tags": [], "owner": {"reputation": 15165, "user_id": 1116364, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b67dfca0caba03083330d39a304b1766?s=128&d=identicon&r=PG", "display_name": "Daniel Jour", "link": "https://stackoverflow.com/users/1116364/daniel-jour"}, "is_accepted": false, "score": 3, "last_activity_date": 1458123504, "last_edit_date": 1495541729, "creation_date": 1458121939, "answer_id": 36032109, "question_id": 36031891, "link": "https://stackoverflow.com/questions/36031891/different-result-in-different-os/36032109#36032109", "title": "Different result in different OS", "body": "<p>C <code>struct</code>s are representations of data that are intended to be used <em>only</em> in memory. As soon as your data \"leaves\" memory in any way, you need to employ <a href=\"https://en.wikipedia.org/wiki/Marshalling_(computer_science)\" rel=\"nofollow noreferrer\">marshalling</a> (or often also called serialization, the differences are not worth discussing here).</p>\n\n<p>In order to do so, you need to convert your data into a format suitable for the medium you transfer it to, the disk in this case.</p>\n\n<p>A <code>struct</code> is not suitable because of mostly these issues:</p>\n\n<ul>\n<li><a href=\"https://stackoverflow.com/q/4306186/1116364\">Padding</a>. Structures are padded to align members to addresses where they can be accessed faster, or to make access even possible (on some architectures).</li>\n<li><a href=\"https://en.wikipedia.org/wiki/Endianness\" rel=\"nofollow noreferrer\">Endianness</a>. The way data that is longer than a single byte is store. This varies between architectures.</li>\n</ul>\n\n<p>I've written an answer with C code example that clearly addresses these issues, <a href=\"https://stackoverflow.com/a/35161110/1116364\">see here</a>.</p>\n\n<p>For this reasons, <strong>the whole approach using <code>fread</code> and <code>fwrite</code> in this situation is flawed</strong>. You can employ this style of data storage to disk to <em>temporarily</em> while your program is still running. As soon as the data could be shared / exchanged with different systems (versions of the same system, different machines, operating systems, libraries, ...) or is stored between consecutive runs of your program you <strong>need</strong> to employ correct marshalling.</p>\n\n<p>Concerning your specific case: The call to <code>fread</code> <em>probably</em> returns 0 because it is not able to read a complete item. <code>sizeof(Database)</code> might be different between these environments.</p>\n\n<p>Though this is only guessing, because you seem to have no error checking, especially for opening the files, in place. Also you could take a look at what <code>errno</code> (consider using <a href=\"http://linux.die.net/man/3/strerror\" rel=\"nofollow noreferrer\"><code>strerror</code></a>) provides.</p>\n\n<p>A very good point brought up by <a href=\"https://stackoverflow.com/users/3121023/user3121023\">user3121023</a> and Peter is the open mode: On Windows, there are some transformations done to the data you read from or write to a file if the file isn't opened in a so called binary mode. This, for example, means that if your data contains a byte equal to <code>'\\n'</code>, then Windows <a href=\"https://stackoverflow.com/q/229924/1116364\">will add an additional</a> <code>'\\r'</code> (carriage return).</p>\n"}, {"comments": [{"owner": {"reputation": 15165, "user_id": 1116364, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b67dfca0caba03083330d39a304b1766?s=128&d=identicon&r=PG", "display_name": "Daniel Jour", "link": "https://stackoverflow.com/users/1116364/daniel-jour"}, "edited": false, "score": 0, "creation_date": 1458123674, "post_id": 36032566, "comment_id": 59714961, "body": "Good point about formatted IO. This has also the benefit that the stored data is (to some extend) readable without using the program."}, {"owner": {"reputation": 385, "user_id": 4818351, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/76cbfe0925f1bd17aecb96b39493257e?s=128&d=identicon&r=PG&f=1", "display_name": "mingpepe", "link": "https://stackoverflow.com/users/4818351/mingpepe"}, "edited": false, "score": 0, "creation_date": 1458179135, "post_id": 36032566, "comment_id": 59748744, "body": "Open the file for binary I/O works! But the results of sizeof(Database) are the same in this code. I am still curious about what is the reason for different behaviors in different environments"}, {"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 0, "creation_date": 1458211015, "post_id": 36032566, "comment_id": 59762851, "body": "Look up the meaning that terms like &quot;implementation defined&quot; have in the C standards."}], "tags": [], "owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "is_accepted": false, "score": 2, "last_activity_date": 1458123130, "creation_date": 1458123130, "answer_id": 36032566, "question_id": 36031891, "link": "https://stackoverflow.com/questions/36031891/different-result-in-different-os/36032566#36032566", "title": "Different result in different OS", "body": "<p>Firstly, you need to open the file for binary I/O (include a <code>'b'</code> character in the mode string given to <code>fopen()</code>).  Without that, the file is opened in text mode which, among other things, translates characters like newlines differently between systems.</p>\n\n<p>Second, and more significant, is hinted by the fact you need to use <code>sizeof()</code>.   The result yielded by <code>sizeof</code> is implementation defined, for anything for the <code>char</code> types which have size <code>1</code> by definition.   <code>sizeof int</code> is implementation defined.   <code>sizeof</code> also yields different values for <code>struct</code> types, since there may be padding between members of different types, to meet alignment requirements for all the <code>struct</code> members.   A consequence of these things being implementation defined, in the C standard, is that they vary between implementations (i.e. between compilers and host systems).</p>\n\n<p>That explains why you are getting different sizes between systems - different amounts of data are being written or read by each operation, on different systems.</p>\n\n<p>To deal with those things, you either need to use techniques to ensure everything is the same size (which is often possible with care, but difficult because some of the properties of some types (like <code>int</code> and <code>struct</code> padding) can be changed by compilation options on some compilers) or do some marshalling (translate the <code>struct</code> types in memory to some consistent binary format for output)and unmarshelling (the reverse process).   The input process needs to be the reverse of the output process (suck in data from file as array of characters, and interpret the data to reconstruct your <code>struct</code>).</p>\n\n<p>Even if two systems have the same sizes (for everything), there are concerns of how basic types (like <code>int</code>) are represented in memory e.g. endianness.   That also needs to be handled with the method of input and output.</p>\n\n<p>One simpler way is to use text mode files and formatted I/O.  That has the advantage of the files being (largely) transportable, but also means a larger file.</p>\n"}], "owner": {"reputation": 385, "user_id": 4818351, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/76cbfe0925f1bd17aecb96b39493257e?s=128&d=identicon&r=PG&f=1", "display_name": "mingpepe", "link": "https://stackoverflow.com/users/4818351/mingpepe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1458178452, "creation_date": 1458121462, "last_edit_date": 1458178452, "question_id": 36031891, "link": "https://stackoverflow.com/questions/36031891/different-result-in-different-os", "title": "Different result in different OS", "body": "<p>[<strong>Update 2016.03.17</strong>]\nSorry for that I skipped the error checking for simplicity. I had check the errors, here is the complete code.</p>\n\n<pre><code>#define MAX_DATA 512\n#define MAX_ROWS 100\ntypedef struct Database {\n    Address rows[MAX_ROWS];\n    int num; // Number of record in the DB.\n} Database;\n\ntypedef struct Address {\n    int id;\n    int set;\n    char name[MAX_DATA];\n    char email[MAX_DATA];\n} Address;\n\nDatabase *db_ptr;\nFILE *file;\nint return_value;\n// Write to file\ndb_ptr = (Database*)malloc(sizeof(Database));\nif(!db_ptr) {\n    printf(\"Memory error!\\n\");\n}\nfor(int i = 0; i &lt; MAX_ROWS; i++) {\n    db_ptr-&gt;rows[i].id = i;\n    db_ptr-&gt;rows[i].set = 0;\n}\nchar *filename = \"test.db\";\nfile = fopen(filename, \"w\");\nif(!file) {\n    printf(\"Open(w) %s fail!\\n\", filename);\n}\nreturn_value = fwrite(db_ptr, sizeof(Database), 1, file);\nprintf(\"The return value from fwrite = %d\\n\", return_value);\nfree(db_ptr);\nfclose(file);\n// Read from file\ndb_ptr = (Database*)malloc(sizeof(Database));\nif(!db_ptr) {\n    printf(\"Memory error!\\n\");\n}\nfile = fopen(filename, \"r+\");\nif(!file) {\n    printf(\"Open(r+) %s fail!\\n\", filename);\n}\nreturn_value = fread(db_ptr, sizeof(Database), 1, file);\nprintf(\"(1)The return value from fread = %d\\n\", return_value);\nrewind(file);\nreturn_value = fread(db_ptr, 1, sizeof(Database), file);\nprintf(\"(2)The return value from fread = %d\\n\", return_value);\nprintf(\"Sizeof(Database) = %lu\\n\", sizeof(Database));\nfree(db_ptr);\nfclose(file);\n</code></pre>\n\n<p>The results are</p>\n\n<pre><code>\"The return value from fwrite = 1\"\n\"(1)The return value from fread = 1\"\n\"(2)The return value from fread = 103204\"\n\"Sizeof(Database) = 103204\"\n</code></pre>\n\n<p>in Ubuntu15.04(64-bits) using gcc with -std=c99, and</p>\n\n<pre><code>\"The return value from fwrite = 1\"\n\"(1)The return value from fread = 0\"\n\"(2)The return value from fread = 26832\"\n\"Sizeof(Database) = 103204\"\n</code></pre>\n\n<p>in Windows7(64-bits) using MinGW with -std=c99.</p>\n\n<p>The size of the test.db are 103204 bytes in Ubuntu and 103205 bytes in Windows.\nIt seems fail to read the whole structure of Database.</p>\n\n<p>My question is that how this program has different behavior in different environment?</p>\n"}, {"tags": ["c", "date"], "answers": [{"tags": [], "owner": {"reputation": 22751, "user_id": 2399879, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UxMS5.jpg?s=128&g=1", "display_name": "Crowman", "link": "https://stackoverflow.com/users/2399879/crowman"}, "is_accepted": false, "score": 2, "last_activity_date": 1458123748, "last_edit_date": 1458123748, "creation_date": 1458123589, "answer_id": 36032774, "question_id": 36031757, "link": "https://stackoverflow.com/questions/36031757/interpretation-of-tm-isdst-field-in-struct-tm/36032774#36032774", "title": "Interpretation of tm_isdst field in struct tm", "body": "<ol>\n<li><p>It should be <code>1</code> (or a positive value), because, as you say, DST is in effect.</p></li>\n<li><p>It should be <code>0</code>, because, as you say, DST is not in effect.</p></li>\n<li><p>It should be <code>0</code>, because DST was not in effect at that time. </p></li>\n<li><p>You can use <code>localtime()</code> to populate a <code>struct tm</code> for a given time, and then check what the value of that flag is. That's primarily why it's there.</p></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": true, "score": 4, "last_activity_date": 1458166386, "last_edit_date": 1458166386, "creation_date": 1458165200, "answer_id": 36047676, "question_id": 36031757, "link": "https://stackoverflow.com/questions/36031757/interpretation-of-tm-isdst-field-in-struct-tm/36047676#36047676", "title": "Interpretation of tm_isdst field in struct tm", "body": "<p>The key issue is that a <code>struct tm</code> represents a time-stamp and its fields are <em>not</em> limited to 24 hours, 12 months 60 minutes, etc.  The DST field does not have to match what clocks use in that timezone for that date.  Of course, setting to not-the-usual values needs rectification for many applications. </p>\n\n<p>For a local time-stamp, simple set all the fields (except <code>tm_yday</code> and <code>tm_wday</code> need not be set) and call <code>mktime()</code>.  It will adjust <em>all</em> the fields to the <em>usual</em> range, including setting <code>tm_isdst</code> to 0 or 1.</p>\n\n<hr>\n\n<ol>\n<li><p>For date(YYYY-MM-DD) 2016-03-16 (when DST is in effect), should tm_isdst be 1? or 0?</p>\n\n<pre><code>// set to 1 to indicate DST\ntm.tm_isdst = 1;\n</code></pre></li>\n<li><p>For date(YYYY-MM-DD) 2016-01-16 (when DST was not in effect), should tm_isdst be 1? or 0?</p>\n\n<pre><code>// set to 0 to indicate standard time\ntm.tm_isdst = 0;\n</code></pre></li>\n<li><p>Daylight Saving Time (United States) 2016 began at 2:00 AM on Sunday, March 13. So at say 1:45AM on March 13, what would be value of tm_isdst? Who sets this value of flag and how?  </p>\n\n<p>Call <code>mktime()</code> with <code>tm.tm_isdst = -1;</code> when unsure of DST setting.  If code <em>knows</em> the <code>struct tm</code> is a standard time, set the <code>tm_isdst</code> field to 0.  It makes <em>no difference</em> what time of year it is.  Like-wise for DST, if code knows it is a DST timestamp, set the field to 1.  Calling <code>mktime()</code> will adjust the field to the usually setting for the local timezone.  </p>\n\n<p>Of course 1:45AM (with <code>tm_isdst &lt; 0</code>) can be interpreted either way and <code>mktime()</code> will typically select 0 or 1.</p>\n\n<pre><code>// set to 1 to indicate DST\n// set to 0 to indicate standard time\n// set to -1 to indicate DST is not known\ntm.tm_isdst = -1;\nmktime(&amp;tm);  // This will adjust all the fields including tm_isdst\n</code></pre></li>\n<li><p>Is there any way to check when DST was in effect from some system call?</p>\n\n<p>Yes.  To determine if a <code>struct tm</code> should have <code>tm_isdst</code> as 0 or 1, call <code>mktime()</code></p>\n\n<pre><code>mktime(&amp;tm);  // This will adjust the fields including tm_isdst\nprintf(\"%d\\n\", tm.tm_isdst);\n</code></pre></li>\n</ol>\n\n<p>BTW: robust code checks the return value of <code>mktime()</code></p>\n\n<pre><code>if (mktime(&amp;tm) == -1) puts(\"Oops\");\n</code></pre>\n"}], "owner": {"reputation": 6643, "user_id": 2032021, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/c1c31bca855c458b3f218ef6a303184d?s=128&d=identicon&r=PG", "display_name": "Dr. Debasish Jana", "link": "https://stackoverflow.com/users/2032021/dr-debasish-jana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4854, "favorite_count": 1, "accepted_answer_id": 36047676, "answer_count": 2, "score": 4, "last_activity_date": 1458166386, "creation_date": 1458121171, "last_edit_date": 1458122930, "question_id": 36031757, "link": "https://stackoverflow.com/questions/36031757/interpretation-of-tm-isdst-field-in-struct-tm", "title": "Interpretation of tm_isdst field in struct tm", "body": "<p>Time structure (struct tm) contains a calendar date and time broken down into its components. The structure contains nine members of type int (in any order), which are:</p>\n\n<pre><code>Member  Type    Meaning Range\ntm_sec  int seconds after the minute    0-61*\ntm_min  int minutes after the hour  0-59\ntm_hour int hours since midnight    0-23\ntm_mday int day of the month    1-31\ntm_mon  int months since January    0-11\ntm_year int years since 1900    \ntm_wday int days since Sunday   0-6\ntm_yday int days since January 1    0-365\ntm_isdst    int Daylight Saving Time flag\n</code></pre>\n\n<p>The Daylight Saving Time flag (tm_isdst) is greater than zero if Daylight Saving Time is in effect, zero if Daylight Saving Time is not in effect, and less than zero if the information is not available.</p>\n\n<p>My Specific Questions related to tm_isdst are as follows:</p>\n\n<p>(1) For date(YYYY-MM-DD) 2016-03-16 (when DST is in effect), should tm_isdst be 1? or 0?</p>\n\n<p>(2) For date(YYYY-MM-DD) 2016-01-16 (when DST was not in effect), should tm_isdst be 1? or 0?</p>\n\n<p>(3) Daylight Saving Time (United States) 2016 began at 2:00 AM on\nSunday, March 13. So at say 1:45AM on March 13, what would be value of tm_isdst? Who sets this value of flag and how?</p>\n\n<p>(4) Is there any way to check when DST was in effect from some system call?</p>\n"}, {"tags": ["c", "macros", "c-preprocessor"], "comments": [{"owner": {"reputation": 2145, "user_id": 4849573, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/096fb4358973b1d406f85d2b0eeec9c2?s=128&d=identicon&r=PG&f=1", "display_name": "ckruczek", "link": "https://stackoverflow.com/users/4849573/ckruczek"}, "edited": false, "score": 0, "creation_date": 1458120881, "post_id": 36031581, "comment_id": 59712864, "body": "Without seeing your macro code we are not able to help you"}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1458121179, "post_id": 36031581, "comment_id": 59713083, "body": "Do it the other way around. Conditionally <code>#define MOD_COMPILE_CALL(x)</code> to expand to either <code>x</code> or <code>0</code> depending on <code>MODULE_XXX_COMPILE</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user824425"}, "edited": false, "score": 0, "creation_date": 1458121592, "post_id": 36031581, "comment_id": 59713406, "body": "Isn&#39;t is easier to let the build system choose between a full or a stub version of the module? That way, all the calls remain as if all modules are enabled, but the module functions do nothing when the stub is selected. Don&#39;t worry about the neglible performance cost until you can measure it."}], "answers": [{"tags": [], "owner": {"reputation": 3177, "user_id": 1221236, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/230d4a82674b9e02c0b95e4ecf7468ae?s=128&d=identicon&r=PG", "display_name": "dragosht", "link": "https://stackoverflow.com/users/1221236/dragosht"}, "is_accepted": true, "score": 6, "last_activity_date": 1458121727, "last_edit_date": 1458121727, "creation_date": 1458121166, "answer_id": 36031755, "question_id": 36031581, "link": "https://stackoverflow.com/questions/36031581/skipping-function-call-if-not-defined/36031755#36031755", "title": "Skipping function call if not defined", "body": "<p>Instead of using <code>#if</code> inside your macro, which will probably not work you could just take it out:</p>\n\n<pre><code>#if MODULE_XXX_COMPILE == 1\n    #define MOD_COMPILE_CALL(fcall) (fcall)\n#else\n    #define MOD_COMPILE_CALL(fcall) (0)\n#endif\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11698, "user_id": 5399734, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2162d669508364bb0c03aba1a2473aa8?s=128&d=identicon&r=PG&f=1", "display_name": "nalzok", "link": "https://stackoverflow.com/users/5399734/nalzok"}, "is_accepted": false, "score": 1, "last_activity_date": 1458122055, "last_edit_date": 1458122055, "creation_date": 1458121247, "answer_id": 36031790, "question_id": 36031581, "link": "https://stackoverflow.com/questions/36031581/skipping-function-call-if-not-defined/36031790#36031790", "title": "Skipping function call if not defined", "body": "<p>Here is an example to do what you want:</p>\n\n<pre><code>#if MODULE_XXX_COMPILE == 1\n    #define MOD_COMPILE_CALL(x) (x)\n#else\n    #define MOD_COMPILE_CALL(x) (0)\n#endif\n</code></pre>\n\n<p>If <code>MODULE_XXX_COMPILE</code> is defined as 1, <code>MOD_COMPILE_CALL(module_func(...));</code> expands to <code>(module_func(...))</code>. Otherwise, it's just <code>0</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 3483, "user_id": 3932569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bca364f93a9dfab17419b31a8a1a504?s=128&d=identicon&r=PG&f=1", "display_name": "Garf365", "link": "https://stackoverflow.com/users/3932569/garf365"}, "edited": false, "score": 0, "creation_date": 1458121484, "post_id": 36031809, "comment_id": 59713324, "body": "Really good answer, when default return is defined at call instead of hard writing in macro!"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2512323"}, "is_accepted": false, "score": 3, "last_activity_date": 1458121288, "creation_date": 1458121288, "answer_id": 36031809, "question_id": 36031581, "link": "https://stackoverflow.com/questions/36031581/skipping-function-call-if-not-defined/36031809#36031809", "title": "Skipping function call if not defined", "body": "<p>Yes, it's possible.</p>\n\n<p>Define <code>IF_MOD_XXX</code>:</p>\n\n<pre><code>#if MODULE_XXX_COMPILE\n#define IF_MOD_XXX(mod_enabled, mod_disabled) mod_enabled\n#else\n#define IF_MOD_XXX(mod_enabled, mod_disabled) mod_disabled\n#endif\n</code></pre>\n\n<p>Use it:</p>\n\n<pre><code>int ret = IF_MOD_XXX(module_func(), 0);\n</code></pre>\n"}], "owner": {"reputation": 469, "user_id": 6012315, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d7f2484ba51df08ea30569f351afe958?s=128&d=identicon&r=PG&f=1", "display_name": "Schafwolle", "link": "https://stackoverflow.com/users/6012315/schafwolle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 166, "favorite_count": 0, "accepted_answer_id": 36031755, "answer_count": 3, "score": 3, "last_activity_date": 1458122055, "creation_date": 1458120734, "last_edit_date": 1458121685, "question_id": 36031581, "link": "https://stackoverflow.com/questions/36031581/skipping-function-call-if-not-defined", "title": "Skipping function call if not defined", "body": "<p>I have a program consisting out of different modules. The modules are interconnected via function calls. E.g. State Init calls the init function of every module. It shall be possible to disable modules (exclude from compilation). The easiest way would be using preprocessor defines. But this generates massive amount of code:</p>\n\n<pre><code>#IF MODULE_XXX_COMPILE\n     ret = module_func(...);\n#ELSE\n     ret = 0;\n#ENDIF\n</code></pre>\n\n<p>I would like to get a macro like this:</p>\n\n<pre><code>ret = MOD_COMPILE_CALL(module_func(...));\n</code></pre>\n\n<p>So the macro checks if the define is 1 if yes it executes the functions else it skips the execution and returns 0.\nThe problem is that my compiler is telling me that its not possible to use <code>#IF</code> in a macro. Is there a way around it? </p>\n"}, {"tags": ["c", "lua", "tostring"], "comments": [{"owner": {"reputation": 20428, "user_id": 1847592, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/OvYt2.png?s=128&g=1", "display_name": "Egor Skriptunoff", "link": "https://stackoverflow.com/users/1847592/egor-skriptunoff"}, "edited": false, "score": 0, "creation_date": 1458120016, "post_id": 36031078, "comment_id": 59712242, "body": "It depends on Lua version."}], "answers": [{"comments": [{"owner": {"reputation": 7126, "user_id": 1560774, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e5c7d8e9733ac6dee89d29d0cd0123f4?s=128&d=identicon&r=PG", "display_name": "Virus721", "link": "https://stackoverflow.com/users/1560774/virus721"}, "edited": false, "score": 0, "creation_date": 1458120116, "post_id": 36031329, "comment_id": 59712305, "body": "Thanks I will try this. Isn&#39;t there an official documentation about the lua&#39;s tostring function ? I&#39;ve been searching but the information is really sparse and you have to read the whole book everytime you want a piece of info..."}, {"owner": {"reputation": 3809, "user_id": 518500, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/853a5fb8148dc8e1678c983f0a4cbaf5?s=128&d=identicon&r=PG", "display_name": "codingbunny", "link": "https://stackoverflow.com/users/518500/codingbunny"}, "reply_to_user": {"reputation": 7126, "user_id": 1560774, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e5c7d8e9733ac6dee89d29d0cd0123f4?s=128&d=identicon&r=PG", "display_name": "Virus721", "link": "https://stackoverflow.com/users/1560774/virus721"}, "edited": false, "score": 0, "creation_date": 1458120197, "post_id": 36031329, "comment_id": 59712355, "body": "all I could find was <a href=\"http://www.lua.org/pil/2.4.html\" rel=\"nofollow noreferrer\">lua.org/pil/2.4.html</a>  and <a href=\"http://www.lua.org/manual/5.1/manual.html#lua_tostring\" rel=\"nofollow noreferrer\">lua.org/manual/5.1/manual.html#lua_tostring</a>"}, {"owner": {"reputation": 7126, "user_id": 1560774, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e5c7d8e9733ac6dee89d29d0cd0123f4?s=128&d=identicon&r=PG", "display_name": "Virus721", "link": "https://stackoverflow.com/users/1560774/virus721"}, "edited": false, "score": 0, "creation_date": 1458120325, "post_id": 36031329, "comment_id": 59712449, "body": "Well as I suspected, if number == (int) number, it prints an int. I can&#39;t beleive there is no official documentation of these basic functions. Thanks for the help anyway."}], "tags": [], "owner": {"reputation": 3809, "user_id": 518500, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/853a5fb8148dc8e1678c983f0a4cbaf5?s=128&d=identicon&r=PG", "display_name": "codingbunny", "link": "https://stackoverflow.com/users/518500/codingbunny"}, "is_accepted": false, "score": 2, "last_activity_date": 1458120557, "last_edit_date": 1458120557, "creation_date": 1458120031, "answer_id": 36031329, "question_id": 36031078, "link": "https://stackoverflow.com/questions/36031078/lua-number-to-string-behaviour/36031329#36031329", "title": "Lua - Number to string behaviour", "body": "<p>Lua converts the numbers as is:</p>\n\n<pre><code>print(tostring(10)) =&gt; \"10\"\nprint(tostring(10.0)) =&gt; \"10.0\"\nprint(tostring(10.1)) =&gt; \"10.1\"\n</code></pre>\n\n<p>If you want to play around with them, there's a small online parser for simple commands like this : <a href=\"http://www.lua.org/cgi-bin/demo\" rel=\"nofollow\">http://www.lua.org/cgi-bin/demo</a>\nThis uses Lua 5.3.1</p>\n\n<p><strong>edit</strong>\nI must support Egor's comment, it's version dependent.\nI ran this locally on my system:</p>\n\n<pre><code>Lua 5.2.4  Copyright (C) 1994-2015 Lua.org, PUC-Rio\n&gt; print(tostring(10))\n10\n&gt; print(tostring(10.0)) \n10\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 7126, "user_id": 1560774, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e5c7d8e9733ac6dee89d29d0cd0123f4?s=128&d=identicon&r=PG", "display_name": "Virus721", "link": "https://stackoverflow.com/users/1560774/virus721"}, "edited": false, "score": 0, "creation_date": 1458121128, "post_id": 36031506, "comment_id": 59713042, "body": "Thanks for your help. So it&#39;s not as easy as I expected. I&#39;m using 5.3.2 and not planning to use another version."}], "tags": [], "owner": {"reputation": 110733, "user_id": 1009479, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/wlrC5.jpg?s=128&g=1", "display_name": "Yu Hao", "link": "https://stackoverflow.com/users/1009479/yu-hao"}, "is_accepted": true, "score": 40, "last_activity_date": 1458120559, "creation_date": 1458120559, "answer_id": 36031506, "question_id": 36031078, "link": "https://stackoverflow.com/questions/36031078/lua-number-to-string-behaviour/36031506#36031506", "title": "Lua - Number to string behaviour", "body": "<p>In Lua 5.2 or earlier, both <code>tostring(10)</code> and <code>tostring(10.0)</code> result as the string <code>\"10\"</code>.</p>\n\n<p>In Lua 5.3, this has changed:</p>\n\n<pre><code>print(tostring(10)) -- \"10\"\nprint(tostring(10.0)) -- \"10.0\"\n</code></pre>\n\n<p>That's because Lua 5.3 introduced the integer subtype. From <a href=\"http://www.lua.org/manual/5.3/manual.html#8.1\" rel=\"noreferrer\">Changes in the Language</a>:</p>\n\n<blockquote>\n  <p>The conversion of a float to a string now adds a <code>.0</code> suffix to the result if it looks like an integer. (For instance, the float <code>2.0</code> will be printed as <code>2.0</code>, not as <code>2</code>.) You should always use an explicit format when you need a specific format for numbers.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 2747, "user_id": 3979429, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/6eKDH.gif?s=128&g=1", "display_name": "warspyking", "link": "https://stackoverflow.com/users/3979429/warspyking"}, "is_accepted": false, "score": 0, "last_activity_date": 1458147714, "creation_date": 1458147714, "answer_id": 36042280, "question_id": 36031078, "link": "https://stackoverflow.com/questions/36031078/lua-number-to-string-behaviour/36042280#36042280", "title": "Lua - Number to string behaviour", "body": "<p>In Lua 5.3, due to the integer type, <code>tostring</code> on a float (although it's Numeric value may be equivalent to an integer) will add a <code>\"'.0'</code> suffix, but that doesn't mean you can't shorten it!</p>\n\n<pre><code>local str = tostring(n)\nif str:sub(-2) == \".0\" then\n    str = str:sub(1,-3)\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 406, "user_id": 2262111, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b0c8268647c49196448993f271a3763?s=128&d=identicon&r=PG", "display_name": "user2262111", "link": "https://stackoverflow.com/users/2262111/user2262111"}, "is_accepted": false, "score": 3, "last_activity_date": 1588161635, "last_edit_date": 1588161635, "creation_date": 1513832168, "answer_id": 47918172, "question_id": 36031078, "link": "https://stackoverflow.com/questions/36031078/lua-number-to-string-behaviour/47918172#47918172", "title": "Lua - Number to string behaviour", "body": "<p>If you are using 5.3.4 and you need a quick hotfix, use math.floor - it casts it to an int-number. This beats @warspyking answer in efficiency, but lacks the coolness that is bunches of code.</p>\n\n<pre><code>&gt;tostring(math.floor(54.0))\n54\n&gt;tostring(54.0)\n54.0\n&gt;type(math.floor(54.0))\ninteger\n&gt;type(54.0)\nnumber\n</code></pre>\n"}], "owner": {"reputation": 7126, "user_id": 1560774, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e5c7d8e9733ac6dee89d29d0cd0123f4?s=128&d=identicon&r=PG", "display_name": "Virus721", "link": "https://stackoverflow.com/users/1560774/virus721"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86984, "favorite_count": 1, "accepted_answer_id": 36031506, "answer_count": 4, "score": 20, "last_activity_date": 1588161635, "creation_date": 1458119325, "last_edit_date": 1458120984, "question_id": 36031078, "link": "https://stackoverflow.com/questions/36031078/lua-number-to-string-behaviour", "title": "Lua - Number to string behaviour", "body": "<p>I would like to know how Lua handles the number to string conversions using the <code>tostring()</code> function.</p>\n\n<p>It is going to convert to an int (as string) if the number is round (i.e if <code>number == (int) number</code>) or is it always going to output a real (as string) like <code>10.0</code> ?</p>\n\n<p>I need to mimic the exact behaviour of Lua's <code>tostring</code> in C, without using the Lua C API since, in this case, I'm not using a <code>lua_State</code>.</p>\n"}, {"tags": ["c++", "c", "pointers"], "comments": [{"owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "edited": false, "score": 8, "creation_date": 1458118842, "post_id": 36030781, "comment_id": 59711470, "body": "You invoked <i>undefined behavior</i> by passing data having wrong type to <code>printf()</code>. The correct statement to print will be <code>printf(&quot;%p %p %zu %td\\n&quot;, (void*)one, (void*)two, sizeof(int), two - one);</code>"}, {"owner": {"reputation": 5574, "user_id": 536874, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/00yFk.jpg?s=128&g=1", "display_name": "Johannes", "link": "https://stackoverflow.com/users/536874/johannes"}, "edited": false, "score": 1, "creation_date": 1458119114, "post_id": 36030781, "comment_id": 59711630, "body": "I do not have a citation. Pointer arithmetic is based on integer arithmetic and that is well defined. So I think <code>two - one</code> is well defined. even if the pointers are not packed like a reasonable person would expect. On the other hand - do not do this, no one will spot this in your codebase."}, {"owner": {"reputation": 3106, "user_id": 1102380, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b9ad1342298e967b5b98801456eef169?s=128&d=identicon&r=PG", "display_name": "Thomas", "link": "https://stackoverflow.com/users/1102380/thomas"}, "edited": false, "score": 3, "creation_date": 1458121232, "post_id": 36030781, "comment_id": 59713121, "body": "Even just holding that pointer <code>two</code> in your program is invalid as the pointer does not satisfy the alignment constraints for <code>int</code> (though in practice on most hardware it won&#39;t trigger a fault until you actually try and dereference it on a processor that doesn&#39;t correct for unaligned memory access like ARM)"}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "reply_to_user": {"reputation": 5574, "user_id": 536874, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/00yFk.jpg?s=128&g=1", "display_name": "Johannes", "link": "https://stackoverflow.com/users/536874/johannes"}, "edited": false, "score": 0, "creation_date": 1458122323, "post_id": 36030781, "comment_id": 59713937, "body": "@Johannes <code>two - one</code> returns <code>ptrdiff_t</code> which may not be the same size as <code>int</code>, therefore printing it with <code>%d</code> invokes undefined behavior. It must be printed with <code>%td</code>. Similarly, <code>size_t</code> must be printed using <code>%zu</code>"}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 1, "creation_date": 1458122553, "post_id": 36030781, "comment_id": 59714105, "body": "<code>int* two = (int*)((char*)p + 7);</code> might seem to run in x86 but it&#39;ll give you segfault on most other architectures"}, {"owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "reply_to_user": {"reputation": 5574, "user_id": 536874, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/00yFk.jpg?s=128&g=1", "display_name": "Johannes", "link": "https://stackoverflow.com/users/536874/johannes"}, "edited": false, "score": 0, "creation_date": 1458124495, "post_id": 36030781, "comment_id": 59715538, "body": "@Johannes: No, pointer arithmetic isn&#39;t defined on integer arithmetic. (Proof: you can&#39;t add two pointers). It&#39;s defined so that arrays work. In particular, <code>a[n]</code> is <code>*(a+n)</code>."}], "answers": [{"comments": [{"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 5, "creation_date": 1458119121, "post_id": 36030938, "comment_id": 59711635, "body": "This is true, but UB happens the first time in <code>(int*)((char*)p + 7)</code>."}, {"owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "reply_to_user": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1458119854, "post_id": 36030938, "comment_id": 59712117, "body": "@user694733 Are you sure that an invalid cast causes UB even without a dereference? I was trying to find something to this effect in the standard, but I didn&#39;t find a definitive answer."}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1458120211, "post_id": 36030938, "comment_id": 59712366, "body": "You are allowed to convert pointer from malloc to any builtin pointer type. However, for <code>(char*)p + 7</code> it no longer holds, conversion from <code>char*</code> to <code>int*</code> is invalid."}, {"owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "edited": false, "score": 7, "creation_date": 1458124635, "post_id": 36030938, "comment_id": 59715625, "body": "@dasblinkenlight: You probably know that the C standard accomodates hardware which traps on merely loading unaligned pointers into a register."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "edited": false, "score": 1, "creation_date": 1458144893, "post_id": 36030938, "comment_id": 59731284, "body": "@MSalters: More significantly, if a pointer of a type requiring alignment is passed directly or indirectly to memcpy, a compiler is entitled to generate code that will fail if the pointer in question is not properly aligned; the justification for such compiler behavior comes from the fact that generating the improperly-aligned pointer invoked UB, since memcpy() itself would have no other legitimate reason to impose alignment requirements."}], "tags": [], "owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "is_accepted": true, "score": 21, "last_activity_date": 1458205669, "last_edit_date": 1458205669, "creation_date": 1458118953, "answer_id": 36030938, "question_id": 36030781, "link": "https://stackoverflow.com/questions/36030781/subtraction-of-non-divisible-pointer-addresses/36030938#36030938", "title": "Subtraction of non-divisible pointer addresses", "body": "<p>This is undefined behavior according to 5.7.6:</p>\n\n<blockquote>\n  <p>When two pointers to elements of the same array object are subtracted, the result is the difference of the subscripts of the two array elements. [...] Unless both pointers point to elements of the same array object, or\n  one past the last element of the array object, the behavior is undefined.</p>\n</blockquote>\n\n<p>In your code, pointer <code>two</code> is not pointing to an element of the same <code>int</code> array as pointer <code>one</code>. In fact, it is not pointing to any array element of <code>p</code>, because it points to the \"middle\" of one of the elements (which in itself is an undefined behavior).</p>\n"}, {"comments": [{"owner": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "edited": false, "score": 1, "creation_date": 1458122462, "post_id": 36031399, "comment_id": 59714037, "body": "I can&#39;t find chapter and verse at the moment, but the same is going to be true of C++.  The calculation of <code>two</code> will be undefined behaviour.  (Imagine a word based machine with special registers for pointers.  Calculating <code>two</code> will go through one of these registers, and it might barf at the misaligned pointer - such machines have existed in the past.)"}], "tags": [], "owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "is_accepted": false, "score": 19, "last_activity_date": 1471439174, "last_edit_date": 1471439174, "creation_date": 1458120258, "answer_id": 36031399, "question_id": 36030781, "link": "https://stackoverflow.com/questions/36030781/subtraction-of-non-divisible-pointer-addresses/36031399#36031399", "title": "Subtraction of non-divisible pointer addresses", "body": "<p>Under some assumptions<sup>1</sup>, in C the third line:</p>\n\n<pre><code>int* two = (int*)((char*)p + 7);\n</code></pre>\n\n<p>already causes undefined behavior, because the pointer p isn't correctly aligned for the type it is referencing<sup>2</sup>.</p>\n\n<hr>\n\n<p><sup>1</sup> The assumption is that alignment requirements for type int are be higher than for type char. This is true on most moderns architectures. Since all alignments must be powers of two<sup>3</sup> and the value 7 isn't, the addition of that value to the pointer p cannot produce a pointer with an alignment that is as strict as is the alignment requirement for type int.</p>\n\n<p><sup>2</sup> (Quoted from: ISO/IEC 9899:201x 6.3.2.3 Pointers 7.)<br>\nA pointer to an object type may be converted to a pointer to a different object type. If the\nresulting pointer is not correctly aligned for the referenced type, the behavior is\nundefined.</p>\n\n<p><sup>3</sup> (Quoted from: ISO/IEC 9899:201x 6.2.8 Alignment of objects 4.)<br>\nEvery valid\nalignment value shall be a nonnegative integral power of two.</p>\n"}], "owner": {"reputation": 4026, "user_id": 2604492, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/Ned8X.png?s=128&g=1", "display_name": "Paul", "link": "https://stackoverflow.com/users/2604492/paul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1039, "favorite_count": 1, "accepted_answer_id": 36030938, "answer_count": 2, "score": 19, "last_activity_date": 1471439174, "creation_date": 1458118559, "question_id": 36030781, "link": "https://stackoverflow.com/questions/36030781/subtraction-of-non-divisible-pointer-addresses", "title": "Subtraction of non-divisible pointer addresses", "body": "<p>Is subtraction of non-divisible pointer addresses defined in C? In C++?</p>\n\n<p>Here's an example:</p>\n\n<pre><code>void* p = malloc(64);\n\nint* one = (int*)((char*)p);\nint* two = (int*)((char*)p + 7);\n\nprintf(\"%x %x %d %d\\n\", one, two, sizeof(int), two - one);\n</code></pre>\n\n<p><a href=\"http://ideone.com/qHUk6N\" rel=\"noreferrer\">Ideone link</a>.</p>\n\n<p>I get the output <code>8a94008 8a9400f 4 1</code>, so it seems like it does the division and truncates the remainder. Is the behavior defined?</p>\n"}, {"tags": ["c", "arrays", "parsing"], "comments": [{"owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "edited": false, "score": 3, "creation_date": 1458115881, "post_id": 36029983, "comment_id": 59709712, "body": "&quot;It doesn&#39;t get the operator.&quot; A small, self-contained, compilable example would be nice so we could see exactly what you are seeing. Actually, <i>not</i> providing such an example is one of the reasons to &quot;vote for close&quot;...."}, {"owner": {"reputation": 8178, "user_id": 2920343, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/dbfe32738597d61775971cab5efebb67?s=128&d=identicon&r=PG&f=1", "display_name": "CompuChip", "link": "https://stackoverflow.com/users/2920343/compuchip"}, "edited": false, "score": 0, "creation_date": 1458116536, "post_id": 36029983, "comment_id": 59710087, "body": "Are you sure you entered <code>equation = &quot;4+4&quot;</code> and not <code>&quot;4 + 4&quot;</code> (note the additional spaces)?"}, {"owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "edited": false, "score": 2, "creation_date": 1458116681, "post_id": 36029983, "comment_id": 59710182, "body": "I also took the liberty of changing the C++ tag into a C tag, as this is C. If you&#39;re doing C++, please use <code>&lt;string&gt;</code> instead of <code>char[]</code>, and C++ iostreams instead of <code>*scanf()</code>."}], "answers": [{"comments": [{"owner": {"reputation": 237, "user_id": 2315320, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/f7398c089cc151e770f2070c2654e234?s=128&d=identicon&r=PG", "display_name": "Rimantas Rad\u017ei\u016bnas", "link": "https://stackoverflow.com/users/2315320/rimantas-rad%c5%bei%c5%abnas"}, "edited": false, "score": 0, "creation_date": 1458116554, "post_id": 36030099, "comment_id": 59710098, "body": "Thank you, everything went as expected."}], "tags": [], "owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "is_accepted": true, "score": 7, "last_activity_date": 1458117511, "last_edit_date": 1495540785, "creation_date": 1458116157, "answer_id": 36030099, "question_id": 36029983, "link": "https://stackoverflow.com/questions/36029983/char-array-to-mathematical-equation/36030099#36030099", "title": "Char array to mathematical equation", "body": "<p>Turning this into an <a href=\"https://stackoverflow.com/help/mcve\">MCVE</a>...    </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main()\n{\n    char * equation = \"4+4\";\n    long number1, number2;\n    char oper;\n    int rc = sscanf( equation, \"%d%c%d\", &amp;number1, &amp;oper, &amp;number2 );\n    printf( \"%d\\n\", rc );\n    if ( rc == 3 )\n    {\n        printf( \"%d - %c - %d\\n\", number1, oper, number2 );\n    }\n    return 0;\n}\n</code></pre>\n\n<p>...gives...</p>\n\n<pre><code>3\n4 - + - 4\n</code></pre>\n\n<p>Works as intended. <strong>Voting to close the question</strong>, please read the link I gave at the beginning of my answer.</p>\n\n<p>Also:</p>\n\n<ul>\n<li><a href=\"https://stackoverflow.com/questions/35178520/how-to-read-parse-input-in-c-the-faq\">How to read / parse input in C?</a>, sections:\n\n<ul>\n<li>Do not use *scanf() for potentially malformed input</li>\n<li>When *scanf() does not work as expected (for if your input string contains spaces)</li>\n</ul></li>\n</ul>\n\n<p>If you actually <em>want</em> to use C++ (as your original tag indicated), there's <a href=\"http://www.boost.org/doc/libs/release/libs/spirit/doc/html/index.html\" rel=\"nofollow noreferrer\">Boost.Spirit</a> for your parsing needs.</p>\n"}, {"comments": [{"owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "edited": false, "score": 0, "creation_date": 1458117536, "post_id": 36030318, "comment_id": 59710680, "body": "Char arrays, <code>iostream::getline</code>, rather Java-esque API... I am not sure I like this one."}], "tags": [], "owner": {"reputation": 962, "user_id": 1891266, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83ed20378bcbcf07ccc4969c6bf9874b?s=128&d=identicon&r=PG", "display_name": "vcp", "link": "https://stackoverflow.com/users/1891266/vcp"}, "is_accepted": false, "score": 3, "last_activity_date": 1458117029, "creation_date": 1458117029, "answer_id": 36030318, "question_id": 36029983, "link": "https://stackoverflow.com/questions/36029983/char-array-to-mathematical-equation/36030318#36030318", "title": "Char array to mathematical equation", "body": "<p>If you want to write a simple <a href=\"https://en.wikipedia.org/wiki/Lexical_analysis\" rel=\"nofollow\">lexer</a> in C++, here is one I adapted <a href=\"https://gist.github.com/DmitrySoshnikov/85a6a3e46e81b4ac3d48\" rel=\"nofollow\">math-expr-lexer.cpp</a> (Author: Dmitry Soshnikov), to make it work on MS Windows OS.</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;vector&gt;\n#include &lt;ctype.h&gt;\n#include &lt;cstring&gt;\n\n#define NL std::endl   \n\nclass Lexer {\n\nprivate:\n    char* m_source;\n    int   m_sourceLength;\n    int   m_cursor;\n    char  m_currentChar;\n\n    void  readNextChar();\n    void  skipWhiteSpaces();\n    char* readNumber();\n    char* readSymbol();\n\npublic:\n    Lexer(char* source);\n\n    bool isEOF();\n    char* readNextToken();\n    static std::vector&lt;char*&gt; tokenize(char*);\n};\n\n// ---------------------------------\n// Lexer implementation.\n// ---------------------------------\n\nLexer::Lexer(char* source) {\n    m_source = source;\n    m_sourceLength = strlen(source);\n    m_cursor = 0;\n\n    readNextChar();\n}\n\nbool Lexer::isEOF() {\n    return m_cursor &gt; m_sourceLength;\n}\n\n/**\n * Reads next char advancing cursor.\n */\nvoid Lexer::readNextChar() {\n    skipWhiteSpaces();\n\n    if (isEOF()) {\n        m_currentChar = '\\0';\n        return;\n    }\n\n    m_currentChar = m_source[m_cursor++];\n}\n\n/**\n * Reads next token: a number or a symbol.\n */\nchar* Lexer::readNextToken() {\n    if (isdigit(m_currentChar))\n        return readNumber();\n\n    return readSymbol();\n}\n\n/**\n * Reds a number containing digits.\n */\nchar* Lexer::readNumber() {\n    char* number = new char[20];\n    int i = 0;\n    while (isdigit(m_currentChar)) {\n        number[i++] = m_currentChar;\n        readNextChar();\n    }\n    number[i] = '\\0';\n    return number;\n}\n\n/**\n * Reads a symbol (operator or grouping).\n */\nchar* Lexer::readSymbol() {\n    char* symbol = new char[2];\n    symbol[0] = m_currentChar;\n    symbol[1] = '\\0';\n    readNextChar();\n    return symbol;\n}\n\nvoid Lexer::skipWhiteSpaces() {\n    while (isspace(m_source[m_cursor]))\n        m_cursor++;\n}\n\n/**\n* Tokenizes a source expression, returns\n* a vector with the tokens.\n*/\nstd::vector&lt;char*&gt; Lexer::tokenize(char* source) {\n    std::vector&lt;char*&gt; tokens;\n    Lexer lexer(source);\n    do {\n        tokens.push_back(lexer.readNextToken());\n    } while (!lexer.isEOF());\n    return tokens;\n}\n\nvoid printTokens(std::vector&lt;char*&gt; tokens) {\n    std::cout &lt;&lt; \"Tokens: [\";\n    unsigned int size = tokens.size();\n    for (unsigned int k = 0; k &lt; size; k++) {\n        std::cout &lt;&lt; '\"' &lt;&lt; tokens[k] &lt;&lt; '\"';\n        if (k &lt; size - 1) std::cout &lt;&lt; \", \";\n    }\n    std::cout &lt;&lt; \"]\" &lt;&lt; NL &lt;&lt; NL;\n}\n\nint main()\n{ \n    char* expression = new char[100];\n    std::cout &lt;&lt; \"Enter expression: \";\n    std::cin.getline(expression, 100);\n    printTokens(Lexer::tokenize(expression));\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 237, "user_id": 2315320, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/f7398c089cc151e770f2070c2654e234?s=128&d=identicon&r=PG", "display_name": "Rimantas Rad\u017ei\u016bnas", "link": "https://stackoverflow.com/users/2315320/rimantas-rad%c5%bei%c5%abnas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1020, "favorite_count": 0, "closed_date": 1458117439, "accepted_answer_id": 36030099, "answer_count": 2, "score": -3, "last_activity_date": 1458117511, "creation_date": 1458115732, "last_edit_date": 1458117393, "question_id": 36029983, "link": "https://stackoverflow.com/questions/36029983/char-array-to-mathematical-equation", "closed_reason": "Not suitable for this site", "title": "Char array to mathematical equation", "body": "<p>I'm trying to parse out mathematical equation from given char array, for example <code>char equation[255] = \"4+4\";</code> and I want to copy first number to <code>long number1</code>, operator to <code>char oper</code> and second number to <code>long number2</code>. </p>\n\n<p>I've tried <code>sscanf(equation, \"%d%c%d\", &amp;number1, &amp;oper, &amp;number2);</code> but it just gets first number and fails to extract operator and second number.</p>\n\n<p>Tried this method:</p>\n\n<pre><code>while (isdigit(equation[k]))\n    {\n        k++;\n    }                   \noper = equation[k];\n</code></pre>\n\n<p>and still it doesn't get the operator. Is there more simple way to parse out equation in c++?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1458115845, "post_id": 36029872, "comment_id": 59709690, "body": "Post your code. BTW you cannot dereference <code>void *</code>. Use a different pointer type."}], "answers": [{"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1458116672, "post_id": 36030026, "comment_id": 59710173, "body": "So just cast to <code>uint8_t</code> and then this answers the question. Though array notation is easier to read. <code>x[i&#47;8]</code> and so on"}], "tags": [], "owner": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "is_accepted": false, "score": 2, "last_activity_date": 1458120306, "last_edit_date": 1458120306, "creation_date": 1458115867, "answer_id": 36030026, "question_id": 36029872, "link": "https://stackoverflow.com/questions/36029872/using-a-void-pointer-to-store-a-128-bit-number-in-c/36030026#36030026", "title": "Using a void pointer to store a 128 bit number in c", "body": "<p>To set a bit at position <code>i</code></p>\n\n<pre><code>*((uint8_t*)x + i/8) |= (1 &lt;&lt; (i%8))\n</code></pre>\n\n<p>To clear it</p>\n\n<pre><code>*((uint8_t*)x + i/8) &amp;= ~(1 &lt;&lt; (i%8))\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "reply_to_user": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 1, "creation_date": 1458118157, "post_id": 36030133, "comment_id": 59711004, "body": "@Aconcagua If <code>CHAR_BIT</code> might not be 8, you might as well make sure to handle all cases and round upwards: <code>malloc((128+CHAR_BIT-1)&#47;CHAR_BIT)</code>"}, {"owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "edited": false, "score": 1, "creation_date": 1458120091, "post_id": 36030133, "comment_id": 59712293, "body": "Actually, <i>only</i> <code>unsigned char</code> is guaranteed to not have any trap representation, i.e. the only &quot;safe&quot; type."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "reply_to_user": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1458120473, "post_id": 36030133, "comment_id": 59712540, "body": "@user694733: Actually true... So far, however, I&#39;ve never seen a system (still in use) not having a multiple of 8 as CHAR_BIT, so I did not have these in mind... But I&#39;ve seen one or another 16-bit processor, so..."}], "tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": true, "score": 9, "last_activity_date": 1458116628, "last_edit_date": 1458116628, "creation_date": 1458116295, "answer_id": 36030133, "question_id": 36029872, "link": "https://stackoverflow.com/questions/36029872/using-a-void-pointer-to-store-a-128-bit-number-in-c/36030133#36030133", "title": "Using a void pointer to store a 128 bit number in c", "body": "<p>The C standard is surprisingly (although logically) inflexible when it comes to casting of pointer types, although you can cast the result of <code>malloc</code> to any pointer type you want.</p>\n\n<p>In order to perform bit and byte analsysis, a safe type to use is <code>char*</code> or <code>unsigned char*</code>:</p>\n\n<p><code>unsigned char* x = malloc(16);</code></p>\n\n<p>(I'd always pick the <code>unsigned char</code> since some platforms have a 1's complement signed <code>char</code> type which, crudely put, is a pain in the neck).</p>\n\n<p>Then you can use <em>pointer arithmetic</em> on <code>x</code> to manipulate the memory block on a byte by byte basis. Note that the standard states that <code>sizeof(char)</code> and <code>sizeof(unsigned char)</code> is 1, so pointer arithmetic on such a type <em>will</em> traverse the entire memory block without omitting any bits of it.</p>\n\n<p>As for examining bit by bit, the standards-defined <code>CHAR_BIT</code> will tell you how many bits there are in a byte. (It's normally 8 but it would be unwise to assume that.)</p>\n\n<p>Finally, don't forget to call <code>free(x)</code> at some point.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5798303"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 493, "favorite_count": 0, "accepted_answer_id": 36030133, "answer_count": 2, "score": 3, "last_activity_date": 1458120466, "creation_date": 1458115381, "last_edit_date": 1458120466, "question_id": 36029872, "link": "https://stackoverflow.com/questions/36029872/using-a-void-pointer-to-store-a-128-bit-number-in-c", "title": "Using a void pointer to store a 128 bit number in c", "body": "<p>I am learning c. As an experiment I am trying to implement 128-bit addition and multiplication.  </p>\n\n<p>I want to do this using a void pointer as follows:</p>\n\n<pre><code>void* x = malloc(16);\nmemset(x, 0, 16);\n</code></pre>\n\n<p>Is it possible to read and write the ith bit of x? I understand how to do this using bitwise operations on standard data types but the compiler complains about invalid operands when I try and use bitwise operations on a void pointer. In general, I am interested in whether it is possible to malloc an arbitraryly sized block of memory and then manipulated each individual bit in c? </p>\n"}, {"tags": ["c", "function", "pointers", "multidimensional-array"], "comments": [{"owner": {"reputation": 6980, "user_id": 5647037, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aJ0h1.jpg?s=128&g=1", "display_name": "Vucko", "link": "https://stackoverflow.com/users/5647037/vucko"}, "edited": false, "score": 1, "creation_date": 1458115620, "post_id": 36029843, "comment_id": 59709564, "body": "pass it like this: <code>GetPointer1(&amp;p1);</code>"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1458117812, "post_id": 36029843, "comment_id": 59710826, "body": "It should be noted that a function like <code>void GetPointer1(uint8_t *p) {     p = &amp;SrcArray[0][0]; }</code> is bad programming practice. First of all, the function is completely superfluous. Second, using functions to modify a global variable which is not one of the parameters is almost always a bad idea, since it is very poor design. <i>Unless</i> these functions are part of an API and <code>SrcArray</code> is declared as a local <code>static</code> inside some library, then it could possibly even be good programming practice. And in multi-process systems, keep in mind that none of this code is re-entrant."}, {"owner": {"reputation": 1027, "user_id": 3380131, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/a630d03d28d31cd843455580a7735828?s=128&d=identicon&r=PG&f=1", "display_name": "bitsmack", "link": "https://stackoverflow.com/users/3380131/bitsmack"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1458148797, "post_id": 36029843, "comment_id": 59734138, "body": "@Lundin Thanks, you called it right. I have a static multidimensional array. I am making an API and I want to return a pointer to a specific row of the array. And it&#39;s for a bare-metal microcontroller."}], "answers": [{"tags": [], "owner": {"reputation": 239, "user_id": 5981113, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/402d54df630177d975611af7cc741f9b?s=128&d=identicon&r=PG&f=1", "display_name": "ABuckau", "link": "https://stackoverflow.com/users/5981113/abuckau"}, "is_accepted": false, "score": 0, "last_activity_date": 1458115874, "creation_date": 1458115874, "answer_id": 36030030, "question_id": 36029843, "link": "https://stackoverflow.com/questions/36029843/why-cant-i-pass-a-pointer-as-an-argument/36030030#36030030", "title": "Why can&#39;t I pass a pointer as an argument?", "body": "<p>\" But if I pass the address of the pointer to the function.\" But you're not passing the address of the pointer, you're passing a copy of the pointer; changing the copy (as you noticed), doesn't change the original. If you actually pass in the &amp;p (address of p) like you intended, you will be able to modify it - I'm unsure of syntax.  edit: void GetPointer1(uint8_t **p) maybe?</p>\n"}, {"comments": [{"owner": {"reputation": 1027, "user_id": 3380131, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/a630d03d28d31cd843455580a7735828?s=128&d=identicon&r=PG&f=1", "display_name": "bitsmack", "link": "https://stackoverflow.com/users/3380131/bitsmack"}, "edited": false, "score": 0, "creation_date": 1458148599, "post_id": 36030031, "comment_id": 59734001, "body": "Thanks; that is what I was missing!"}], "tags": [], "owner": {"reputation": 443, "user_id": 5735630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a01dacc93f117afa749969161fc3a43?s=128&d=identicon&r=PG&f=1", "display_name": "IGarFieldI", "link": "https://stackoverflow.com/users/5735630/igarfieldi"}, "is_accepted": true, "score": 7, "last_activity_date": 1458115878, "creation_date": 1458115878, "answer_id": 36030031, "question_id": 36029843, "link": "https://stackoverflow.com/questions/36029843/why-cant-i-pass-a-pointer-as-an-argument/36030031#36030031", "title": "Why can&#39;t I pass a pointer as an argument?", "body": "<p>That is because the pointer you have in the function signature of GetPointer1(uint8_t *p) is passed by value. If you want to modify the pointer itself, you have to pass a pointer to a pointer:</p>\n\n<pre><code>void GetPointer1(uint8_t **p) {\n    *p = &amp;SrcArray[0][0];\n}\n</code></pre>\n\n<p>Otherwise, you may modify the piece memory to which the pointer points, but not the pointer itself.</p>\n"}, {"tags": [], "owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "is_accepted": false, "score": 1, "last_activity_date": 1458116270, "creation_date": 1458116270, "answer_id": 36030127, "question_id": 36029843, "link": "https://stackoverflow.com/questions/36029843/why-cant-i-pass-a-pointer-as-an-argument/36030127#36030127", "title": "Why can&#39;t I pass a pointer as an argument?", "body": "<p>You have a variable p1 that is pointing to something. Then you pass it to a function GetPointer1. What happens there is that the value of the variable p1 (this is the address of the value it is pointing to!!!) is <strong>copied (!)</strong> to the function stack. This means that you can modify the pointed value (<code>*p1</code>), but not the original pointer (<code>p1</code>) itself, as you only have a copy of it. If you want to be able to modify the original pointer, then you have to retrieve the address of the pointer and pass this one to the function, i. e. you need a pointer to the pointer. You get this via the address-of operator &amp;. So you need this:</p>\n\n<pre><code>getPointer1(uint8_t** p) { *p = /*...*/; }\n</code></pre>\n\n<p>and call it via</p>\n\n<pre><code>getPointer1(&amp;p1);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 0, "creation_date": 1458129850, "post_id": 36030243, "comment_id": 59719202, "body": "To make this a useful answer you should explain what you&#39;ve changed and why."}], "tags": [], "owner": {"reputation": 401, "user_id": 4377391, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Nk8IR.jpg?s=128&g=1", "display_name": "rabi shaw", "link": "https://stackoverflow.com/users/4377391/rabi-shaw"}, "is_accepted": false, "score": 1, "last_activity_date": 1458130166, "last_edit_date": 1458130166, "creation_date": 1458116700, "answer_id": 36030243, "question_id": 36029843, "link": "https://stackoverflow.com/questions/36029843/why-cant-i-pass-a-pointer-as-an-argument/36030243#36030243", "title": "Why can&#39;t I pass a pointer as an argument?", "body": "<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdint.h&gt;\n\nint SrcArray[2][3] = {{11,12,13},{21,22,23}};\nint *p1;\nint *p2;\n\nvoid GetPointer1(int **p);\nint* GetPointer2(void);\n\nint main()\n{\n    printf (\"&amp;SrcArray[0][0]: %d\\n\", SrcArray[0][0]);\n\n    GetPointer1(&amp;p1); /*&lt;-- passing the reference of pointer p1 */\n    p2 = GetPointer2();\n\n    printf (\"p1: %d\\n\",*p1);\n    printf (\"p2: %d\\n\",*p2);\n\n    return 0;\n}\n\nvoid GetPointer1(int **p) /*&lt;-- using double pointer */\n{\n    *p = &amp;SrcArray[0][0];\n}\n\nint* GetPointer2(void)\n{\n    return &amp;SrcArray[0][0];\n}\n\no/p\nrabi@rabi-VirtualBox:~/rabi/c$ gcc -g stack3.c \nrabi@rabi-VirtualBox:~/rabi/c$ ./a.out \n&amp;SrcArray[0][0]: 11\np1: 11\np2: 11\nrabi@rabi-VirtualBox:~/rabi/c$\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1711, "user_id": 3171693, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/b3f51428576d48dd6bc1a5851faa717a?s=128&d=identicon&r=PG&f=1", "display_name": "Dilip Kumar", "link": "https://stackoverflow.com/users/3171693/dilip-kumar"}, "is_accepted": false, "score": 2, "last_activity_date": 1458117270, "last_edit_date": 1458117270, "creation_date": 1458116935, "answer_id": 36030289, "question_id": 36029843, "link": "https://stackoverflow.com/questions/36029843/why-cant-i-pass-a-pointer-as-an-argument/36030289#36030289", "title": "Why can&#39;t I pass a pointer as an argument?", "body": "<p>Its is local to function <code>GetPointer1</code> because it is a local variable which is passed as an value not as an address.\nHere is the output details of your code for better understanding</p>\n\n<pre><code>inside main: &amp;SrcArray[0][0]: 6295616\nvalue of pointer p1: 0\naddress of pointer p1: 6295640\ninside GetPointer1: 0\nvalue of pointer p: 0 //which ur taking to a pointer p and modifying p whihc is local to that function.\naddress of pointer p: 64030024\ninside GetPointer1 after assignment:value of pointer p: 6295616\naddress of pointer p: 64030024\n</code></pre>\n\n<p>If you want to pass address you need to use <code>&amp;</code> before the  variable say <code>&amp;p1</code>. \nAlso as mentioned in one of the answer by IGarFieldI you can use pointer to a pointer.</p>\n\n<pre><code>void GetPointer1(uint8_t **p) {\n    *p = &amp;SrcArray[0][0];\n}\n</code></pre>\n\n<p>One more point since <code>P1</code> is global variable, its accessible to all the functions you can directly use <code>P1=SrcArray;</code> which is allowed and does the same task.\n<code>ScrArray</code> is equivalent <code>&amp;ScrArray[][]</code> both gives the address of the array.</p>\n"}], "owner": {"reputation": 1027, "user_id": 3380131, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/a630d03d28d31cd843455580a7735828?s=128&d=identicon&r=PG&f=1", "display_name": "bitsmack", "link": "https://stackoverflow.com/users/3380131/bitsmack"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 143, "favorite_count": 0, "accepted_answer_id": 36030031, "answer_count": 5, "score": 2, "last_activity_date": 1458130166, "creation_date": 1458115314, "question_id": 36029843, "link": "https://stackoverflow.com/questions/36029843/why-cant-i-pass-a-pointer-as-an-argument", "title": "Why can&#39;t I pass a pointer as an argument?", "body": "<p>I am attempting to retrieve a pointer via a function in c.  If the pointer is a return value from the function then it works.  But if I pass the address of the pointer to the function, I can't update the dereferenced pointer value (which should be the address stored in the pointer) from within the function.</p>\n\n<p>Please see the code and the output.  Why don't I get the same results with both <code>GetPointer1()</code> and <code>GetPointer2()</code>?  What am I missing?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdint.h&gt;\n\nuint8_t SrcArray[2][3] = {{11,12,13},{21,22,23}};\nuint8_t *p1;\nuint8_t *p2;\n\nvoid GetPointer1(uint8_t *p);\nuint8_t* GetPointer2(void);\n\nint main()\n{\n    printf (\"&amp;SrcArray[0][0]: %d\\n\", &amp;SrcArray[0][0]);\n\n    GetPointer1(p1);\n    p2 = GetPointer2();\n\n    printf (\"p1: %d\\n\",p1);\n    printf (\"p2: %d\\n\",p2);\n\n    return 0;\n}\n\nvoid GetPointer1(uint8_t *p)\n{\n    p = &amp;SrcArray[0][0];\n}\n\nuint8_t* GetPointer2(void)\n{\n    return &amp;SrcArray[0][0];\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>&amp;SrcArray[0][0]: 6295604\np1: 0\np2: 6295604\n</code></pre>\n"}, {"tags": ["c", "file", "pointers"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 2, "creation_date": 1458114265, "post_id": 36029226, "comment_id": 59708830, "body": "Show what you have tried, even if you think it&#39;s wrong."}, {"owner": {"reputation": 401, "user_id": 4377391, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Nk8IR.jpg?s=128&g=1", "display_name": "rabi shaw", "link": "https://stackoverflow.com/users/4377391/rabi-shaw"}, "edited": false, "score": 0, "creation_date": 1458114536, "post_id": 36029226, "comment_id": 59708971, "body": "you can open a single file using a file pointer. you can reuse the file pointer to open another file but after closing the previous opened file. so the steps will be like this  1. open the file using a file pointer  2. close the file using the file pointer 3. again reuse the file pointer to open another file."}, {"owner": {"reputation": 1, "user_id": 5176614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65138f27d6a927d0a8ea12701244092d?s=128&d=identicon&r=PG&f=1", "display_name": "Krishanu Pal", "link": "https://stackoverflow.com/users/5176614/krishanu-pal"}, "edited": false, "score": 0, "creation_date": 1458119849, "post_id": 36029226, "comment_id": 59712108, "body": "@ rabi shaw i have done it.But it gives segmentation fault."}, {"owner": {"reputation": 1, "user_id": 5176614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65138f27d6a927d0a8ea12701244092d?s=128&d=identicon&r=PG&f=1", "display_name": "Krishanu Pal", "link": "https://stackoverflow.com/users/5176614/krishanu-pal"}, "edited": false, "score": 0, "creation_date": 1458123920, "post_id": 36029226, "comment_id": 59715127, "body": "@  Michael Walz  can you suggest me alternative solution regarding this problem?"}], "answers": [{"comments": [{"owner": {"reputation": 166, "user_id": 5819794, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba3e2fb00d94ad98d4c8df18a3b3e532?s=128&d=identicon&r=PG&f=1", "display_name": "Ash", "link": "https://stackoverflow.com/users/5819794/ash"}, "reply_to_user": {"reputation": 1, "user_id": 5176614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65138f27d6a927d0a8ea12701244092d?s=128&d=identicon&r=PG&f=1", "display_name": "Krishanu Pal", "link": "https://stackoverflow.com/users/5176614/krishanu-pal"}, "edited": false, "score": 1, "creation_date": 1458122559, "post_id": 36029274, "comment_id": 59714109, "body": "collect the return values for fopen and read functions, read() is having only two arguments in your code, but it should have three arguments."}, {"owner": {"reputation": 1, "user_id": 5176614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65138f27d6a927d0a8ea12701244092d?s=128&d=identicon&r=PG&f=1", "display_name": "Krishanu Pal", "link": "https://stackoverflow.com/users/5176614/krishanu-pal"}, "edited": false, "score": 0, "creation_date": 1458123761, "post_id": 36029274, "comment_id": 59715012, "body": "@ Ash but still I get segmentation fault without read functions. Whenever fopen and fclose are present segmentation fault occur."}, {"owner": {"reputation": 166, "user_id": 5819794, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba3e2fb00d94ad98d4c8df18a3b3e532?s=128&d=identicon&r=PG&f=1", "display_name": "Ash", "link": "https://stackoverflow.com/users/5819794/ash"}, "reply_to_user": {"reputation": 1, "user_id": 5176614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65138f27d6a927d0a8ea12701244092d?s=128&d=identicon&r=PG&f=1", "display_name": "Krishanu Pal", "link": "https://stackoverflow.com/users/5176614/krishanu-pal"}, "edited": false, "score": 1, "creation_date": 1458125686, "post_id": 36029274, "comment_id": 59716364, "body": "If the file you are trying to open is not there, the gh will be NULL, then fclose(NULL) will give you segmentation fault, so print the file name on console, and check whether they are present are not."}, {"owner": {"reputation": 1, "user_id": 5176614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65138f27d6a927d0a8ea12701244092d?s=128&d=identicon&r=PG&f=1", "display_name": "Krishanu Pal", "link": "https://stackoverflow.com/users/5176614/krishanu-pal"}, "edited": false, "score": 0, "creation_date": 1458126218, "post_id": 36029274, "comment_id": 59716739, "body": "@  Ash yes file names are present in buffer1 array. Also total number of files present in that directory is also correct"}, {"owner": {"reputation": 166, "user_id": 5819794, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba3e2fb00d94ad98d4c8df18a3b3e532?s=128&d=identicon&r=PG&f=1", "display_name": "Ash", "link": "https://stackoverflow.com/users/5819794/ash"}, "reply_to_user": {"reputation": 1, "user_id": 5176614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65138f27d6a927d0a8ea12701244092d?s=128&d=identicon&r=PG&f=1", "display_name": "Krishanu Pal", "link": "https://stackoverflow.com/users/5176614/krishanu-pal"}, "edited": false, "score": 0, "creation_date": 1458126600, "post_id": 36029274, "comment_id": 59717005, "body": "check the return value for fopen and then do your operations and close the file if is is valid. if(!gh) fclose(gh); Hope this will remove the segmentation fault"}, {"owner": {"reputation": 1, "user_id": 5176614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65138f27d6a927d0a8ea12701244092d?s=128&d=identicon&r=PG&f=1", "display_name": "Krishanu Pal", "link": "https://stackoverflow.com/users/5176614/krishanu-pal"}, "edited": false, "score": 0, "creation_date": 1458127768, "post_id": 36029274, "comment_id": 59717829, "body": "@ Ash fopen returns NULL value after it open 1st file. How to avoid this problem ?"}, {"owner": {"reputation": 166, "user_id": 5819794, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba3e2fb00d94ad98d4c8df18a3b3e532?s=128&d=identicon&r=PG&f=1", "display_name": "Ash", "link": "https://stackoverflow.com/users/5819794/ash"}, "reply_to_user": {"reputation": 1, "user_id": 5176614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65138f27d6a927d0a8ea12701244092d?s=128&d=identicon&r=PG&f=1", "display_name": "Krishanu Pal", "link": "https://stackoverflow.com/users/5176614/krishanu-pal"}, "edited": false, "score": 0, "creation_date": 1458130364, "post_id": 36029274, "comment_id": 59719568, "body": "so clearly the filepath is wrong, check whether you are getting the exact file path are not"}, {"owner": {"reputation": 1, "user_id": 5176614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65138f27d6a927d0a8ea12701244092d?s=128&d=identicon&r=PG&f=1", "display_name": "Krishanu Pal", "link": "https://stackoverflow.com/users/5176614/krishanu-pal"}, "edited": false, "score": 0, "creation_date": 1458131715, "post_id": 36029274, "comment_id": 59720555, "body": "@ Ash but it can process 1st file and process it. And buffer1 gives all the  required file names. f_name creates the path for each file."}, {"owner": {"reputation": 166, "user_id": 5819794, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba3e2fb00d94ad98d4c8df18a3b3e532?s=128&d=identicon&r=PG&f=1", "display_name": "Ash", "link": "https://stackoverflow.com/users/5819794/ash"}, "reply_to_user": {"reputation": 1, "user_id": 5176614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65138f27d6a927d0a8ea12701244092d?s=128&d=identicon&r=PG&f=1", "display_name": "Krishanu Pal", "link": "https://stackoverflow.com/users/5176614/krishanu-pal"}, "edited": false, "score": 0, "creation_date": 1458134328, "post_id": 36029274, "comment_id": 59722671, "body": "fopen will set the errno if error occurs, so check the errno what was set"}, {"owner": {"reputation": 1, "user_id": 5176614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65138f27d6a927d0a8ea12701244092d?s=128&d=identicon&r=PG&f=1", "display_name": "Krishanu Pal", "link": "https://stackoverflow.com/users/5176614/krishanu-pal"}, "edited": false, "score": 0, "creation_date": 1458195868, "post_id": 36029274, "comment_id": 59753739, "body": "@ Ash thanks error number was 2  so I changed my code if(gh !=NULL){ data[total]=read(gh,data[i]);  fclose(gh);  }.  Now  segmentation fault does not occur but read function does not work."}, {"owner": {"reputation": 1, "user_id": 5176614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65138f27d6a927d0a8ea12701244092d?s=128&d=identicon&r=PG&f=1", "display_name": "Krishanu Pal", "link": "https://stackoverflow.com/users/5176614/krishanu-pal"}, "edited": false, "score": 0, "creation_date": 1458198423, "post_id": 36029274, "comment_id": 59754842, "body": "@ Ash i changed my code and it worked. But i can handle up to 10 files. I have tried also with multiple file pointer and i saw this problem  here <a href=\"http://stackoverflow.com/questions/35987093/open-multiple-files-for-reading-in-c\">stackoverflow</a>. So  i think  i have less var . After processing my files terminal displays &quot;KILLED&quot;. Thanks for your help."}], "tags": [], "owner": {"reputation": 166, "user_id": 5819794, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba3e2fb00d94ad98d4c8df18a3b3e532?s=128&d=identicon&r=PG&f=1", "display_name": "Ash", "link": "https://stackoverflow.com/users/5819794/ash"}, "is_accepted": false, "score": -1, "last_activity_date": 1458113470, "creation_date": 1458113470, "answer_id": 36029274, "question_id": 36029226, "link": "https://stackoverflow.com/questions/36029226/open-multiple-files-using-single-file-pointer/36029274#36029274", "title": "Open multiple files using single file pointer", "body": "<p>Yes, you can open multiple files using single file pointer, but before opening one file close the file using fclose() which was previously opened.</p>\n\n<p>So in the loop first open the file and after doing operations close it before the loop ends.</p>\n"}], "owner": {"reputation": 1, "user_id": 5176614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65138f27d6a927d0a8ea12701244092d?s=128&d=identicon&r=PG&f=1", "display_name": "Krishanu Pal", "link": "https://stackoverflow.com/users/5176614/krishanu-pal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2071, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1458121253, "creation_date": 1458113292, "last_edit_date": 1458119303, "question_id": 36029226, "link": "https://stackoverflow.com/questions/36029226/open-multiple-files-using-single-file-pointer", "title": "Open multiple files using single file pointer", "body": "<p>Can I open multiple file using a single file pointer in one loop?. I have an array of strings which contains 50 file names.It shows only one file name, then segmentation fault occur.  Please suggest.</p>\n\n<pre><code>int main()\n{\n  DIR *dir;\n struct dirent *pq;\n char f_name[40];\n const char *buffer[2000],*buffer1[2000];\n int count=0;\n if ((dir = opendir (\"/home/student/storage\")) != NULL)\n  {\n  /* print all the files and directories within directory */\n  while ((pq = readdir (dir)) != NULL)\n     {\n       buffer[count]=pq-&gt;d_name;\n       //printf(\"%s\\n\",pq-&gt;d_name);\n       count++;\n     }\n  closedir (dir);\n  }\n else\n    {\n  /* could not open directory */\n    perror (\"\");\n    return EXIT_FAILURE;\n    }\n /*creating file name and removing unwanted names*/\n FILE *gh;\n  char *s;\n int total=0,i;\n   for(i=0;i&lt;count;i++)\n     {\n      s = strstr(buffer[i],\".txt\");\n      if (s !=NULL)\n      {\n       printf(\"%s\\n\",buffer[i]);\n       buffer1[total]=buffer[i];//buffer1 contains all the required file name\n       sprintf(f_name,\"/home/student/storage/%s\",buffer1[i]);\n       //gh=fopen(f_name,\"r\");\n       //data[total]=read(gh,data[i]);\n       total++;\n       //fclose(gh);\n       }\n }\n      printf(\"total=%d\\n\",total);\n     return 0;\n}\n\n`\n</code></pre>\n"}, {"tags": ["c", "arrays", "scanf"], "comments": [{"owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "edited": false, "score": 6, "creation_date": 1458113427, "post_id": 36029200, "comment_id": 59708396, "body": "It&#39;s <code>&#39;\\n&#39;</code> that is left in the buffer after reading an <code>int</code>. Add space before <code>%c</code> (use <code>&quot; %c&quot;</code>) and try again."}, {"owner": {"reputation": 9, "user_id": 6070028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7db5792a31362b967f6ff556aa8fd10d?s=128&d=identicon&r=PG&f=1", "display_name": "Francisco Vasquez", "link": "https://stackoverflow.com/users/6070028/francisco-vasquez"}, "reply_to_user": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "edited": false, "score": 0, "creation_date": 1458113740, "post_id": 36029200, "comment_id": 59708558, "body": "wooooowww thank you so much! i feel like an idiot"}, {"owner": {"reputation": 19358, "user_id": 3049655, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/ZLzeP.jpg?s=128&g=1", "display_name": "Spikatrix", "link": "https://stackoverflow.com/users/3049655/spikatrix"}, "edited": false, "score": 0, "creation_date": 1458113814, "post_id": 36029200, "comment_id": 59708594, "body": "You can use <code>float list[numbers];</code> just after <code>scanf (&quot;%d&quot;, &amp;numbers);</code> to get rid of <code>if(numbers &gt; Max_Numbers){ \u2026 }</code>. And functions <code>Maximum</code> and <code>Minimum</code> should be designed to handle <code>float</code>s, not <code>int</code>s."}, {"owner": {"reputation": 2887, "user_id": 5845470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/606531753afd42de16d82a1199fc4d45?s=128&d=identicon&r=PG&f=1", "display_name": "jdarthenay", "link": "https://stackoverflow.com/users/5845470/jdarthenay"}, "edited": false, "score": 2, "creation_date": 1458114038, "post_id": 36029200, "comment_id": 59708703, "body": "<code>scanf(&quot;%d&quot;, &amp;list[idx]);</code> won&#39;t work as you wish as list[idx] is not an int."}, {"owner": {"reputation": 19358, "user_id": 3049655, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/ZLzeP.jpg?s=128&g=1", "display_name": "Spikatrix", "link": "https://stackoverflow.com/users/3049655/spikatrix"}, "edited": false, "score": 0, "creation_date": 1458114166, "post_id": 36029200, "comment_id": 59708770, "body": "So, change the return type of those functions as well as the type of <code>maximum</code> and <code>minimum</code> to <code>float</code> and initialize them to <code>FLT_MIN</code> and <code>FLT_MAX</code> respectively after including <code>limits.h</code>."}, {"owner": {"reputation": 19358, "user_id": 3049655, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/ZLzeP.jpg?s=128&g=1", "display_name": "Spikatrix", "link": "https://stackoverflow.com/users/3049655/spikatrix"}, "edited": false, "score": 0, "creation_date": 1458114234, "post_id": 36029200, "comment_id": 59708814, "body": "&quot;<i><code>&#47;&#47;Is this the proper way to put those                                                                         &#47;&#47;values in the new array?</code></i>&quot; -- Yes."}, {"owner": {"reputation": 9, "user_id": 6070028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7db5792a31362b967f6ff556aa8fd10d?s=128&d=identicon&r=PG&f=1", "display_name": "Francisco Vasquez", "link": "https://stackoverflow.com/users/6070028/francisco-vasquez"}, "edited": false, "score": 0, "creation_date": 1458114438, "post_id": 36029200, "comment_id": 59708920, "body": "thank you all so much. i did the changes you guys said, althought the minimum function is returning zero each time as well, max and avg worked, i still need to check stand dev"}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1458115329, "post_id": 36029200, "comment_id": 59709393, "body": "Post the corrected code."}], "owner": {"reputation": 9, "user_id": 6070028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7db5792a31362b967f6ff556aa8fd10d?s=128&d=identicon&r=PG&f=1", "display_name": "Francisco Vasquez", "link": "https://stackoverflow.com/users/6070028/francisco-vasquez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "closed_date": 1458117525, "answer_count": 0, "score": 0, "last_activity_date": 1458113216, "creation_date": 1458113216, "question_id": 36029200, "link": "https://stackoverflow.com/questions/36029200/scanf-before-the-switch-case-wont-work", "closed_reason": "Duplicate", "title": "Scanf before the switch/case won&#39;t work.", "body": "<p>The scanf before the switch/case function is never used and it completely stops the program.\n    Althought I'm also not sure if the functions work since i haven't been able to properly run the program. I just want for the scanf to work properly. It is probably some dumb mistake like always but if you anyone could help me find out why it wont even prompt for an input then i would be very grateful. Any other corrections to the rest of the code would also be greatly appreciated. </p>\n\n<pre><code>    #include &lt;stdio.h&gt;\n    #include &lt;math.h&gt;\n    #define Max_Numbers 50//defined max array size\n\n    float CalcAverage(float list[],  int numbers);//function to calulate average\n    int Minimum(float list[], int numbers);//calculates minimum\n    int Maximum(float list[], int numbers);//calculate max\n    float StandDev(float list[], int numbers);//calculates standard deviation\n\n\n    int main()\n    {\n        int numbers;\n        float output;\n        int idx;\n        char option;\n        float list[Max_Numbers];\n        printf(\"Enter the amount of numbers you wish to input:\\n\");\n        scanf (\"%d\", &amp;numbers);//prompting for size of array\n        if(numbers &gt; Max_Numbers)\n        {\n            printf(\"Too many numbers\\n\");// im not really sure how to get this to work as well\n            return -1;\n        }\n        for (idx = 0; idx &lt; numbers; idx++)//counter for entered values\n        {\n            printf(\"Enter a number\\n\");\n            scanf(\"%d\", &amp;list[idx]);\n        }\n\n        printf(\"What would you like to do?\\n\");\n        printf(\"(1): Calculate Average\\n\");          //menu options to determine which \n        printf(\"(2): Calculate Maximum\\n\");          //function will be used\n        printf(\"(3): Calculate Minimum\\n\");\n        printf(\"(4): Calculate Standard Deviation\\n\");\n        printf(\"Enter menu option:\\n\");\n\n        scanf(\"%c\", &amp;option);//scanf for menu options, program stops before this scanf\n\n        switch (option)//I believe the program is breaking at this switch\n        {\n            case ('1'):\n                output = CalcAverage(list, numbers);//calls to CalcAverage\n                break;\n            case ('2'):\n                output = Maximum(list, numbers);//calls to Maximum\n                break;\n            case ('3'):\n                output = Minimum(list, numbers);//Calls to minimum\n                break;\n            case ('4'):\n                output = StandDev(list, numbers);//calls to StandDev\n                break;\n            default:\n                printf(\"Invalid menu option\\n\");\\\\default option in case wrong value entered\n                break;\n        }\n        printf(\"The result is %.2f\", output);// the result \n    }\n\n    float CalcAverage(float list[],  int numbers)//function definition for average\n    {\n        int idx;\n        float sum = 0;\n        float result;\n        for(idx = 0; idx &lt; numbers; idx++)//counter used to add all values\n        {\n            sum = sum + list[idx];\n        }\n        result = (float) sum / numbers;\n        return result;\n    }\n    int Maximum(float list[], int numbers)//function def. for max\n    {\n        int idx;\n        int maximum = 0;\n        for(idx = 0; idx &lt; numbers; idx++)//counter used to compare values\n        {\n            if (maximum &lt; list[idx])      //im not sure if i wrote some of \n            {                             //these functions correctly\n                maximum = list[idx];      //The main problem i have is\n            }                             //that scanf that breaks the \n        }                                 //program\n        return maximum;\n\n    }\n    int Minimum(float list[], int numbers)//fun def. for min\n     {\n        int idx;\n        int minimum = 0;\n        for(idx = 0; idx &lt; numbers; idx++)\n        {\n            if (minimum &gt; list[idx])\n            {\n                minimum = list[idx];\n            }\n        }\n        return minimum;\n\n    }\n    float StandDev(float list[], int numbers)//function def. for standard deviation\n    {\n       int idx;\n      float avg;\n      float newlist[numbers];\n      float newavg;\n      avg = CalcAverage(list, numbers);\n     for(idx = 0; idx &lt; numbers; idx++)\n       {\n           newlist[idx] = (list[idx] - avg) * (list[idx] - avg);//Is this the proper way to put those            \n       }                                                        //values in the new array?\n\n       newavg = CalcAverage(newlist, numbers);\n       return sqrt(newavg);\n\n    }\n</code></pre>\n"}, {"tags": ["c", "multithreading"], "answers": [{"tags": [], "owner": {"reputation": 56858, "user_id": 131930, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/91536fe27d32713b8a154a0bf42f6748?s=128&d=identicon&r=PG", "display_name": "Jeremy Friesner", "link": "https://stackoverflow.com/users/131930/jeremy-friesner"}, "is_accepted": false, "score": 1, "last_activity_date": 1458114740, "last_edit_date": 1495542227, "creation_date": 1458113333, "answer_id": 36029238, "question_id": 36029117, "link": "https://stackoverflow.com/questions/36029117/pselect-does-not-return-on-signal-when-called-from-a-separate-thread-but-works-f/36029238#36029238", "title": "pselect does not return on signal when called from a separate thread but works fine in single thread program", "body": "<blockquote>\n  <p>After sending SIGUSR1 to this program I see that it remains blocked in\n  the pselect call. When the code in mythread function is moved back\n  into main and not spawning any thread from main, it works perfectly.</p>\n</blockquote>\n\n<p>That's to be expected -- there is no guarantee that a signal will be delivered to the \"right\" thread, since there is no well-defined notion of what the \"right\" thread would be.</p>\n\n<p>Signals and multithreading don't mix particularly well, but if you want to do it, I suggest getting rid of the exit_request flag (note: the volatile keyword <a href=\"https://stackoverflow.com/questions/2484980/why-is-volatile-not-considered-useful-in-multithreaded-c-or-c-programming/2485177#2485177\">isn't sufficient to work reliably in multithreaded scenarios</a> anyway), and instead create a connected pair of file descriptors (by calling either the <a href=\"http://linux.die.net/man/2/pipe\" rel=\"nofollow noreferrer\">pipe</a>() function or the <a href=\"http://man7.org/linux/man-pages/man2/socketpair.2.html\" rel=\"nofollow noreferrer\">socketpair</a>() function).  All your signal handler function (hdl()) needs to do is write a byte into one of the two file descriptors.  Have your thread include the other file descriptor in its read-socket-set (fds) so that when the byte is written that will cause pselect() to return and then your subsequent call to FD_ISSET(theSecondFileDescriptorOfThePair, &amp;fds) will return true, which is how your thread will know it's time to exit now.</p>\n"}, {"tags": [], "owner": {"reputation": 1211, "user_id": 871359, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9fc62495ffcf1837859b2fdeeae2d11?s=128&d=identicon&r=PG", "display_name": "majie", "link": "https://stackoverflow.com/users/871359/majie"}, "is_accepted": false, "score": 1, "last_activity_date": 1458572725, "creation_date": 1458572725, "answer_id": 36134641, "question_id": 36029117, "link": "https://stackoverflow.com/questions/36029117/pselect-does-not-return-on-signal-when-called-from-a-separate-thread-but-works-f/36134641#36134641", "title": "pselect does not return on signal when called from a separate thread but works fine in single thread program", "body": "<p>The signal is delivered to the main thread, other than the thread blocking on the <code>pselect()</code> call. If there are multiple threads that have the signal unblocked, the signal can be delivered to any one of the threads.</p>\n\n<p>Since you didn't specify your platform, first I'm quoting from the <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/\" rel=\"nofollow\">POSIX standard</a> (System Interfaces volume, 2.4.1 Signal Generation and Delivery).</p>\n\n<blockquote>\n  <p><strong>Signals generated for the process shall be delivered to exactly one of those threads</strong> within the process <strong>which</strong> is in a call to a sigwait() function selecting that signal or <strong>has not blocked delivery of the signal</strong>.</p>\n</blockquote>\n\n<p>You can also see similar statements in Linux manpage <a href=\"http://man7.org/linux/man-pages/man7/signal.7.html\" rel=\"nofollow\"><code>signal(7)</code></a>.</p>\n\n<blockquote>\n  <p>A process-directed signal may be delivered to any\n         one of the threads that does not currently have the signal blocked.\n         If more than one of the threads has the signal unblocked, then the\n         kernel chooses an arbitrary thread to which to deliver the signal.</p>\n</blockquote>\n\n<p>And FreeBSD manpage <a href=\"https://www.freebsd.org/cgi/man.cgi?query=sigaction&amp;manpath=FreeBSD%2010.2-RELEASE\" rel=\"nofollow\"><code>sigaction(2)</code></a>.</p>\n\n<blockquote>\n  <p>For signals directed at the process, if the\n       signal is not currently blocked by all threads then it is delivered to\n       one thread that does not have it blocked (the selection of which is\n       unspecified).</p>\n</blockquote>\n\n<p>So what you can do is to block <code>SIGUSR1</code> for all the threads in the process except for the one that calls <code>pselect()</code>. Luckily when a new thread is created, it inherits the signal mask from its creator.</p>\n\n<p>From the same POSIX section above,</p>\n\n<blockquote>\n  <p>The signal mask for a thread shall be initialized from that of its parent or creating thread....</p>\n</blockquote>\n\n<p>Linux <a href=\"http://man7.org/linux/man-pages/man3/pthread_sigmask.3.html\" rel=\"nofollow\"><code>pthread_sigmask(3)</code></a>,</p>\n\n<blockquote>\n  <p>A new thread inherits a copy of its creator's signal mask.</p>\n</blockquote>\n\n<p>FreeBSD <code>sigaction(2)</code>,</p>\n\n<blockquote>\n  <p>The signal mask for a thread is initialized from that of its parent (normally empty).</p>\n</blockquote>\n\n<p>You can make the following changes to your code. In <code>main()</code>, before creating any threads, block <code>SIGUSR1</code>. In the thread, pass a signal mask that has <code>SIGUSR1</code> unblocked into <code>pselect()</code>.</p>\n\n<pre><code>--- old.c   Mon Mar 21 22:48:52 2016\n+++ new.c   Mon Mar 21 22:53:54 2016\n@@ -56,14 +56,14 @@\n         return NULL;\n     }\n\n-    sigemptyset (&amp;mask);\n-    sigaddset (&amp;mask, SIGUSR1);\n-\n-    if (pthread_sigmask(SIG_BLOCK, &amp;mask, &amp;orig_mask) &lt; 0) {\n+    sigemptyset(&amp;orig_mask);\n+    if (pthread_sigmask(SIG_BLOCK, NULL, &amp;orig_mask) &lt; 0) {\n         perror (\"pthread_sigmask\");\n         return NULL;\n     }\n\n+    sigdelset(&amp;orig_mask, SIGUSR1);\n+\n     lfd = socket (AF_INET, SOCK_STREAM, 0);\n     if (lfd &lt; 0) {\n         perror (\"socket\");\n@@ -126,6 +126,15 @@\n {\n     void * res;\n     pthread_t mythr_h;\n+    sigset_t mask;\n+\n+    sigemptyset (&amp;mask);\n+    sigaddset (&amp;mask, SIGUSR1);\n+\n+    if (pthread_sigmask(SIG_BLOCK, &amp;mask, NULL) != 0) {\n+        return 1;\n+    }\n+\n     pthread_create(&amp;mythr_h, (pthread_attr_t *)NULL, mythread, NULL);\n     pthread_join(mythr_h, &amp;res);\n     return 0;\n</code></pre>\n\n<p>Last thing is off topic. <code>printf()</code> is not an <code>async-signal-safe</code> function, so should not be called in the signal handler.</p>\n"}], "owner": {"reputation": 11, "user_id": 2617336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7532c3bfabf18975324075df4bb9c4e2?s=128&d=identicon&r=PG", "display_name": "user2617336", "link": "https://stackoverflow.com/users/2617336/user2617336"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 735, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1458572725, "creation_date": 1458112908, "last_edit_date": 1458116863, "question_id": 36029117, "link": "https://stackoverflow.com/questions/36029117/pselect-does-not-return-on-signal-when-called-from-a-separate-thread-but-works-f", "title": "pselect does not return on signal when called from a separate thread but works fine in single thread program", "body": "<p>I am learning how to use pselect. I took an example code which worked fine and modified it to call the same code from a thread which is spawned from main and it does not work (pselect remains blocked forever)</p>\n\n<pre><code>#include &lt;sys/select.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;sys/stat.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;netinet/in.h&gt;\n#include &lt;netinet/ip.h&gt;\n#include &lt;arpa/inet.h&gt;\n#include &lt;signal.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;errno.h&gt;\n\n/* Flag that tells the daemon to exit. */\nstatic volatile int exit_request = 0;\n\n/* Signal handler. */\nstatic void hdl (int sig)\n{\n    exit_request = 1;\n    printf(\"sig=%d\\n\", sig);\n}\n\n/* Accept client on listening socket lfd and close the connection\n * immediatelly. */\nstatic void handle_client (int lfd)\n{\n    int sock = accept (lfd, NULL, 0);\n    if (sock &lt; 0) {\n        perror (\"accept\");\n        exit (1);\n    }\n\n    puts (\"accepted client\");\n\n    close (sock);\n}\n\nvoid *mythread(void *arg  __attribute__ ((unused)))\n{\n    int lfd;\n    struct sockaddr_in myaddr;\n    int yes = 1;\n    sigset_t mask;\n    sigset_t orig_mask;\n    struct sigaction act;\n\n    memset (&amp;act, 0, sizeof(act));\n    act.sa_handler = hdl;\n\n    /* This server should shut down on SIGUSR1. */\n    if (sigaction(SIGUSR1, &amp;act, 0)) {\n        perror (\"sigaction\");\n        return NULL;\n    }\n\n    sigemptyset (&amp;mask);\n    sigaddset (&amp;mask, SIGUSR1);\n\n    if (pthread_sigmask(SIG_BLOCK, &amp;mask, &amp;orig_mask) &lt; 0) {\n        perror (\"pthread_sigmask\");\n        return NULL;\n    }\n\n    lfd = socket (AF_INET, SOCK_STREAM, 0);\n    if (lfd &lt; 0) {\n        perror (\"socket\");\n        return NULL;\n    }\n\n    if (setsockopt(lfd, SOL_SOCKET, SO_REUSEADDR,\n                &amp;yes, sizeof(int)) == -1) {\n        perror (\"setsockopt\");\n        return NULL;\n    }\n\n    memset (&amp;myaddr, 0, sizeof(myaddr));\n    myaddr.sin_family = AF_INET;\n    myaddr.sin_addr.s_addr = INADDR_ANY;\n    myaddr.sin_port = htons (10000);\n\n    if (bind(lfd, (struct sockaddr *)&amp;myaddr, sizeof(myaddr)) &lt; 0) {\n        perror (\"bind\");\n        return NULL;\n    }\n\n    if (listen(lfd, 5) &lt; 0) {\n        perror (\"listen\");\n        return NULL;\n    }\n\n    while (!exit_request) {\n        fd_set fds;\n        int res;\n\n        /* BANG! we can get SIGUSR1 at this point, but it will be\n         * delivered while we are in pselect(), because now\n         * we block SIGUSR1.\n         */\n\n        FD_ZERO (&amp;fds);\n        FD_SET (lfd, &amp;fds);\n\n        res = pselect (lfd + 1, &amp;fds, NULL, NULL, NULL, &amp;orig_mask);\n        if (res &lt; 0 &amp;&amp; errno != EINTR) {\n            perror (\"select\");\n            return NULL;\n        }\n        else if (exit_request) {\n            puts (\"exited\");\n            break;\n        }\n        else if (res == 0)\n            continue;\n\n        if (FD_ISSET(lfd, &amp;fds)) {\n            handle_client (lfd);\n        }\n    }\n\n    return NULL;\n}\nint main (int argc, char *argv[])\n{\n    void * res;\n    pthread_t mythr_h;\n    pthread_create(&amp;mythr_h, (pthread_attr_t *)NULL, mythread, NULL);\n    pthread_join(mythr_h, &amp;res);\n    return 0;\n}\n</code></pre>\n\n<p><strong>strong text</strong></p>\n\n<p>After sending SIGUSR1 to this program I see that it remains blocked in the pselect call. When the code in mythread function is moved back into main and not spawning any thread from main, it works perfectly. </p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1458122412, "post_id": 36032243, "comment_id": 59714003, "body": "That is why you should check the return value of <code>scanf()</code>...."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 3, "creation_date": 1458122471, "post_id": 36032243, "comment_id": 59714042, "body": "remove the <code>;</code> after <code>while(ans[0]==&#39;N&#39;);</code>"}], "answers": [{"tags": [], "owner": {"reputation": 57967, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "is_accepted": false, "score": 2, "last_activity_date": 1458122911, "last_edit_date": 1458122911, "creation_date": 1458122544, "answer_id": 36032347, "question_id": 36032243, "link": "https://stackoverflow.com/questions/36032243/writing-simple-base-code-for-a-program-that-keeps-track-of-my-work-hours-and-pay/36032347#36032347", "title": "Writing simple base code for a program that keeps track of my work hours and pay in C", "body": "<pre><code>char ans[]=\"No\";\n...\nscanf(\"%s\", ans);\n</code></pre>\n\n<p><code>ans</code> can hold only a string of length 2. You should make <code>ans</code> larger, to be able to hold any reasonable input, e.g.:</p>\n\n<pre><code>char ans[200] = \"No\";\n</code></pre>\n\n<hr>\n\n<p>Another problem is the <code>;</code> after the while:</p>\n\n<pre><code>while(ans[0]=='N');\n                  ^\n</code></pre>\n\n<p>Remove it. It makes an empty instruction the only thing the <code>while</code> repeats.</p>\n\n<hr>\n\n<p>Another thing: when dealing with user input, be it stdin or file input, you should check if the read was done successfully, in you case you should check the return value of <a href=\"http://en.cppreference.com/w/cpp/io/c/fscanf\" rel=\"nofollow\">scanf</a></p>\n"}, {"tags": [], "owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "is_accepted": false, "score": 3, "last_activity_date": 1458141949, "last_edit_date": 1458141949, "creation_date": 1458122782, "answer_id": 36032441, "question_id": 36032243, "link": "https://stackoverflow.com/questions/36032243/writing-simple-base-code-for-a-program-that-keeps-track-of-my-work-hours-and-pay/36032441#36032441", "title": "Writing simple base code for a program that keeps track of my work hours and pay in C", "body": "<p>You have put a <code>;</code> after the <code>while</code> condition. Therefore your while loop is empty and will run forever.</p>\n\n<p>The more readable equivalent of <em>your</em> program is this:</p>\n\n<pre><code>int main()\n{\n   float work;\n   work=0;\n   char ans[]=\"No\";\n   while(ans[0]=='N')  \n   {\n    // empty loop thAT will run forever\n   }\n\n   // we never get here\n\n   printf(\"Hours worked today \");\n   scanf(\"%f\", &amp;work);\n   printf(\"Is that all? \");\n   scanf(\"%s\", ans);\n\n   return 0;\n}\n</code></pre>\n\n<p>In your program juste change</p>\n\n<pre><code>while(ans[0]=='N');\n</code></pre>\n\n<p>to</p>\n\n<pre><code>while(ans[0]=='N')\n</code></pre>\n\n<p>and it will work.</p>\n"}, {"tags": [], "owner": {"reputation": 11698, "user_id": 5399734, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2162d669508364bb0c03aba1a2473aa8?s=128&d=identicon&r=PG&f=1", "display_name": "nalzok", "link": "https://stackoverflow.com/users/5399734/nalzok"}, "is_accepted": false, "score": 0, "last_activity_date": 1458122949, "creation_date": 1458122949, "answer_id": 36032501, "question_id": 36032243, "link": "https://stackoverflow.com/questions/36032243/writing-simple-base-code-for-a-program-that-keeps-track-of-my-work-hours-and-pay/36032501#36032501", "title": "Writing simple base code for a program that keeps track of my work hours and pay in C", "body": "<p>Simply change</p>\n\n<pre><code>while(ans[0]=='N');\n</code></pre>\n\n<p>to</p>\n\n<pre><code>while(ans[0]=='N')\n</code></pre>\n\n<p>, because the former is identical to </p>\n\n<pre><code>while(ans[0]=='N')\n{\n    ;\n}\n</code></pre>\n\n<p>,which will never end.</p>\n"}], "migrated_from": {"other_site": {"markdown_extensions": ["MathJax", "Prettify"], "launch_date": 1436881020, "open_beta_date": 1296068400, "closed_beta_date": 1295463600, "site_state": "normal", "high_resolution_icon_url": "https://cdn.sstatic.net/Sites/codereview/Img/apple-touch-icon@2.png", "twitter_account": "StackCodeReview", "favicon_url": "https://cdn.sstatic.net/Sites/codereview/Img/favicon.ico", "icon_url": "https://cdn.sstatic.net/Sites/codereview/Img/apple-touch-icon.png", "audience": "peer programmer code reviews", "site_url": "https://codereview.stackexchange.com", "api_site_parameter": "codereview", "logo_url": "https://cdn.sstatic.net/Sites/codereview/Img/logo.png", "name": "Code Review", "site_type": "main_site"}, "on_date": 1458122310, "question_id": 122982}, "owner": {"reputation": 11, "user_id": 6070339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd12aa4386b413bcff67bdecb32877e2?s=128&d=identicon&r=PG&f=1", "display_name": "bayame", "link": "https://stackoverflow.com/users/6070339/bayame"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "answer_count": 3, "score": -1, "last_activity_date": 1458141949, "creation_date": 1458112689, "question_id": 36032243, "link": "https://stackoverflow.com/questions/36032243/writing-simple-base-code-for-a-program-that-keeps-track-of-my-work-hours-and-pay", "title": "Writing simple base code for a program that keeps track of my work hours and pay in C", "body": "<p>When I compile my code it says that everything checks out but when I run it nothing happens. The program just runs until I kill the terminal.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\nint main()\n{\n    float work;\n    work=0;\n    char ans[]=\"No\";\n    while(ans[0]=='N');\n    {\n        printf(\"Hours worked today \");\n        scanf(\"%f\", &amp;work);\n        printf(\"Is that all? \");\n        scanf(\"%s\", ans);\n    }\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "while-loop"], "comments": [{"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 6, "creation_date": 1458112572, "post_id": 36028985, "comment_id": 59707928, "body": "<code>scanf(&quot;%d&quot;, m);</code> --&gt; <code>scanf(&quot;%d&quot;, &amp;m);</code> also initialize <code>m</code> E.g <code>int m=0;</code>"}, {"owner": {"reputation": 19358, "user_id": 3049655, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/ZLzeP.jpg?s=128&g=1", "display_name": "Spikatrix", "link": "https://stackoverflow.com/users/3049655/spikatrix"}, "edited": false, "score": 0, "creation_date": 1458112748, "post_id": 36028985, "comment_id": 59708014, "body": "Use a <code>do...while</code> loop instead of a <code>while</code> loop."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1458113143, "post_id": 36028985, "comment_id": 59708250, "body": "Voting to close as simple typo, as yet another &quot;forgot &amp; in scanf&quot; question doesn&#39;t add anything of value to the site. I&#39;d close as duplicate but can&#39;t be bothered to look for one."}], "answers": [{"tags": [], "owner": {"reputation": 4751, "user_id": 5649326, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/a82Se.jpg?s=128&g=1", "display_name": "Marievi", "link": "https://stackoverflow.com/users/5649326/marievi"}, "is_accepted": false, "score": 4, "last_activity_date": 1458135538, "last_edit_date": 1458135538, "creation_date": 1458112633, "answer_id": 36029026, "question_id": 36028985, "link": "https://stackoverflow.com/questions/36028985/while-loop-doesnt-break-no-matter-what-i-do/36029026#36029026", "title": "While loop doesn&#39;t break no matter what I do", "body": "<p>Try the following corrections :</p>\n\n<p>1) Initialize <code>m</code> (to something different than 1, if you want the while loop to execute).</p>\n\n<p>2) Change <code>scanf(\"%d\", m);</code> to <code>scanf(\"%d\", &amp;m);</code> in order to read in the same variable you use in the condition.</p>\n"}, {"tags": [], "owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "is_accepted": false, "score": 4, "last_activity_date": 1458119011, "last_edit_date": 1495540386, "creation_date": 1458112639, "answer_id": 36029027, "question_id": 36028985, "link": "https://stackoverflow.com/questions/36028985/while-loop-doesnt-break-no-matter-what-i-do/36029027#36029027", "title": "While loop doesn&#39;t break no matter what I do", "body": "<p>Two problems there: </p>\n\n<ul>\n<li>You are using <code>m</code> uninitialized.  </li>\n<li>Last statement <code>scanf(\"%d\", m);</code> should be <code>scanf(\"%d\", &amp;m);</code>. Note the <code>&amp;</code> before <code>m</code>.   </li>\n</ul>\n\n<p>Any one of them alone will cause undefined behavior. But, a possible reason for the loop to be infinite is <code>scanf(\"%d\", m);</code> storing the input to the address <code>m</code> not at the address of <code>m</code>. So, <code>m</code> can have indeterminate value which may not be equal to <code>1</code> and causing the expression <code>m != 1</code> to be <code>true</code> always.</p>\n\n<hr>\n\n<p>Suggested reading: <a href=\"https://stackoverflow.com/questions/34557160/what-will-happen-if-is-not-put-in-a-scanf-statement-in-c/34557290#34557290\">What will happen if '&amp;' is not put in a 'scanf' statement in C?</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "is_accepted": false, "score": 5, "last_activity_date": 1458112654, "creation_date": 1458112654, "answer_id": 36029035, "question_id": 36028985, "link": "https://stackoverflow.com/questions/36028985/while-loop-doesnt-break-no-matter-what-i-do/36029035#36029035", "title": "While loop doesn&#39;t break no matter what I do", "body": "<p>Change:</p>\n\n<pre><code>scanf(\"%d\", m);\n</code></pre>\n\n<p>to:</p>\n\n<pre><code>scanf(\"%d\", &amp;m);\n</code></pre>\n\n<p>The way it was, <code>m</code> wasn't changing (and it was writing to some unsafe address in memory).</p>\n\n<p>Your compiler should have warning about this, so make sure you have enabled compiler warnings.</p>\n\n<p>Also, you need to assign an initial value to <code>m</code>, probably zero, to force the loop to be entered the first time.</p>\n"}, {"tags": [], "owner": {"reputation": 201, "user_id": 5684924, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c08165bc265ff7e964401a909e7ccce?s=128&d=identicon&r=PG&f=1", "display_name": "Minh", "link": "https://stackoverflow.com/users/5684924/minh"}, "is_accepted": false, "score": 3, "last_activity_date": 1458112889, "creation_date": 1458112889, "answer_id": 36029107, "question_id": 36028985, "link": "https://stackoverflow.com/questions/36028985/while-loop-doesnt-break-no-matter-what-i-do/36029107#36029107", "title": "While loop doesn&#39;t break no matter what I do", "body": "<p>I think this line has problem</p>\n\n<pre><code>scanf(\"%d\", m);\n</code></pre>\n\n<p>This will be set the value into address with value m instead of set value to m.</p>\n\n<p>The correct should be </p>\n\n<pre><code>scanf(\"%d\", &amp;m);\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 6070108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e01ce8347c2cba145c78590649088dca?s=128&d=identicon&r=PG&f=1", "display_name": "Patricio", "link": "https://stackoverflow.com/users/6070108/patricio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 293, "favorite_count": 0, "closed_date": 1458120069, "answer_count": 4, "score": 0, "last_activity_date": 1458135538, "creation_date": 1458112480, "question_id": 36028985, "link": "https://stackoverflow.com/questions/36028985/while-loop-doesnt-break-no-matter-what-i-do", "closed_reason": "Not suitable for this site", "title": "While loop doesn&#39;t break no matter what I do", "body": "<p>I have this code, the problem is no matter what value I give to \"m\" the while keeps looping and I don't know why</p>\n\n<p>Here is the code</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\n#include &lt;conio.h&gt;\n\nint main(void){\n    float ur, N, h1, h2, h3, l1, l2, l3, uo, w, V, i, lc1, lc2, A1, A2, A3, A4, R1, R2, R3, R4, Req, fl, P;\n    int m;\n    uo = 4*M_PI*(pow(10, -7));\n    printf(\"\\n-- Inicio del Problema --\");\n    printf(\"\\n-- Para conocer las variables revise la imagen en la parte trasera de la portada del disco --\");\n    while (m != 1){\n        printf(\"\\n-- Introduzca Permeabilidad magnetica relativa\\t\");\n        scanf(\"%f\", &amp;ur);\n        printf(\"\\n-- Introduzca voltaje en volts\\t\");\n        scanf(\"%f\", &amp;V);\n        printf(\"\\n-- Introduzca corriente en amperes\\t\");\n        scanf(\"%f\", &amp;i);\n        printf(\"\\n-- Introduzca el n\u00famero de espiras\\t\");\n        scanf(\"%f\", &amp;N);\n        printf(\"\\n-- Introduzca las alturas en metros (h1, h2 y h3 separados por espacio)\\t\");\n        scanf(\"%f %f %f\", &amp;h1, &amp;h2, &amp;h3);\n        printf(\"\\n-- Introduzca los largos en metros (l1, l2, y l3 separados por espacio)\\t\");\n        scanf(\"%f %f %f\", &amp;l1, &amp;l2, &amp;l3);\n        printf(\"\\n-- Introduzca la anchura en metros (w)\\t\");\n        scanf(\"%f\", &amp;w);\n        printf(\"\\nur = %f \\t V = %f V \\t I = %f A \\t N = %f espiras \\nh1 = %f m \\t h2 = %f m \\t h3 = %f m \\nl1 = %f m \\t l2 = %f m \\t l3 = %f m \\t w = %f m\", ur, V, i, N, h1, h2, h3, l1, l2, l3, w);\n        printf(\"\\nHa introducido correctamente los datos (si = 1, no = 2)? \\t\");\n        scanf(\"%d\", m);     \n    }\n    lc1 = l2+(l1/2)+(l3/2);\n    lc2 = h2+(h1/2)+(h3/2);\n    A1 = h1*w;\n    A2 = l3*w;\n    A3 = h3*w;\n    A4 = l1*w;\n    R1 = lc1/(ur*uo*A1);\n    R2 = lc2/(ur*uo*A2);\n    R3 = lc1/(ur*uo*A3);\n    R4 = lc2/(ur*uo*A4);\n    Req = R1+R2+R3+R4;\n    fl = (N*i)/Req;\n    P = V*i;\n    printf(\"\\n-- Las \u00e1reas son: \\nA1 = %f m^2 \\nA2 = %f m^2 \\nA3 = %f m^2 \\nA4 = %f m^2\", A1, A2, A3, A4);\n    printf(\"\\n-- Las reluctancias son: \\nR1 = %f A*V/wb \\nR2 = %f A*V/wb \\nR3 = %f A*V/wb \\nR4 = %f A*V/wb\", R1, R2, R3, R4);\n    printf(\"\\n-- La reluctancia equivalente es: \\nReq = %f A*V/wb\", Req);\n    printf(\"\\n-- El flujo magnetomotriz es: \\nF = %f wb\", fl);\n    printf(\"\\n-- La potencia del sistema es: \\nP = %f watts\", P);\n    getch(); \n    return 0;\n}\n</code></pre>\n\n<p>I've tried changing to \"m == 2\", doing a do-while. No matter what I do is either breaks with any answer or doesn't brake with any answer.</p>\n\n<p>I've also tried putting an if/break inside the loop, both while and do-while, but still has the same problems</p>\n\n<p>If you point me to the problem I'd really appreciate it</p>\n"}, {"tags": ["c", "linux", "linux-kernel", "linux-device-driver"], "comments": [{"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1458112925, "post_id": 36028374, "comment_id": 59708126, "body": "Did you try to put some <code>printk</code> into <a href=\"http://lxr.free-electrons.com/source/drivers/pci/msi.c?v=3.12#L829\" rel=\"nofollow noreferrer\">pci_enable_msi_block</a> to understand what is failing?"}, {"owner": {"reputation": 95, "user_id": 6069943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02f3c5de12c3c2b9501ce18bd5dd0ab4?s=128&d=identicon&r=PG&f=1", "display_name": "malik12", "link": "https://stackoverflow.com/users/6069943/malik12"}, "reply_to_user": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1458113006, "post_id": 36028374, "comment_id": 59708171, "body": "&quot;Did you try to pot some printk into pci_enable_msi_block to understand what is failing?&quot; can you tell how i should do that as this function is from the built in linux driver?"}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1458113014, "post_id": 36028374, "comment_id": 59708174, "body": "Are you using a Specific Vendor Kernel?"}, {"owner": {"reputation": 95, "user_id": 6069943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02f3c5de12c3c2b9501ce18bd5dd0ab4?s=128&d=identicon&r=PG&f=1", "display_name": "malik12", "link": "https://stackoverflow.com/users/6069943/malik12"}, "reply_to_user": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1458113097, "post_id": 36028374, "comment_id": 59708224, "body": "Yes it is from ti arago project"}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1458113191, "post_id": 36028374, "comment_id": 59708277, "body": "You are on an embedded system. I supposed you have recompiled your kernel source code for your platform. At least to create your specific DTB files, if kernel support them."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1458113279, "post_id": 36028374, "comment_id": 59708325, "body": "Ok, I found out <a href=\"http://stackoverflow.com/questions/24332667/using-pci-enable-msi-block\">THIS</a>. Could be a kernel bug..."}, {"owner": {"reputation": 95, "user_id": 6069943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02f3c5de12c3c2b9501ce18bd5dd0ab4?s=128&d=identicon&r=PG&f=1", "display_name": "malik12", "link": "https://stackoverflow.com/users/6069943/malik12"}, "reply_to_user": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1458113364, "post_id": 36028374, "comment_id": 59708365, "body": "yes i did update the dtb file"}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1458113463, "post_id": 36028374, "comment_id": 59708418, "body": "If you did that, you&#39;d modify other source code also."}, {"owner": {"reputation": 95, "user_id": 6069943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02f3c5de12c3c2b9501ce18bd5dd0ab4?s=128&d=identicon&r=PG&f=1", "display_name": "malik12", "link": "https://stackoverflow.com/users/6069943/malik12"}, "reply_to_user": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1458113471, "post_id": 36028374, "comment_id": 59708424, "body": "yes most probably if this is so how can i correct it, i am new to linux"}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 1, "creation_date": 1458113798, "post_id": 36028374, "comment_id": 59708581, "body": "Ask to your vendor support. I&#39;m sorry, I&#39;m not a TI expert."}, {"owner": {"reputation": 95, "user_id": 6069943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02f3c5de12c3c2b9501ce18bd5dd0ab4?s=128&d=identicon&r=PG&f=1", "display_name": "malik12", "link": "https://stackoverflow.com/users/6069943/malik12"}, "reply_to_user": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1458113822, "post_id": 36028374, "comment_id": 59708602, "body": "i did not make any changes to the source code, the steps i followed were to install the linux devkit and then upload the kernel file .bin and the device  tree dtb to the device"}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1458114090, "post_id": 36028374, "comment_id": 59708728, "body": "Take a look <a href=\"http://e2e.ti.com/support/embedded/linux/f/354/p/424995/1530132\" rel=\"nofollow noreferrer\">HERE</a>. Maybe your case."}, {"owner": {"reputation": 95, "user_id": 6069943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02f3c5de12c3c2b9501ce18bd5dd0ab4?s=128&d=identicon&r=PG&f=1", "display_name": "malik12", "link": "https://stackoverflow.com/users/6069943/malik12"}, "reply_to_user": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1458191273, "post_id": 36028374, "comment_id": 59752105, "body": "Yes this is exactly the same problem i am having however the solution they present to call pci_enable_msi_block multiple times seems incorrect as it will only update the pdev-&gt;irq with the interrupt number whereas the requirement is to allocate pdev-&gt;irq+1 to pdev-&gt;irq+count -1 if my understanding of pci_enable_msi_block is correct..."}], "answers": [{"tags": [], "owner": {"reputation": 26, "user_id": 2989191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4402efb3bc9bc7f19ab0e3fa990b6f02?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Minga", "link": "https://stackoverflow.com/users/2989191/matt-minga"}, "is_accepted": true, "score": 0, "last_activity_date": 1478099464, "creation_date": 1478099464, "answer_id": 40383407, "question_id": 36028374, "link": "https://stackoverflow.com/questions/36028374/custom-linux-pcie-driver-msi-interrupts/40383407#40383407", "title": "Custom linux pcie driver MSI interrupts", "body": "<p>You will need to check your configuration registers to determine how many MSI are available to be allocated. The PCIe device determines this. </p>\n\n<p>You will need to probe configuration registers. Take the LSB of the DWORD to obtain the command register. This controls legacy interrupts. Take the MSB of address 0x50 to determine the message control. This controls the MSI. </p>\n\n<p>Make sure that legacy interrupts are disabled and bus master enabled in the command register. Use 0x50 (MSB) to determine how many MSI can be allocated. bits 4:6 determine this and bit 0 enables MSI.</p>\n\n<p>I ran into a similar problem but it turned out that my endpoint was only capable of a single MSI and I was unable to change that due to vendor limitations.</p>\n"}], "owner": {"reputation": 95, "user_id": 6069943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02f3c5de12c3c2b9501ce18bd5dd0ab4?s=128&d=identicon&r=PG&f=1", "display_name": "malik12", "link": "https://stackoverflow.com/users/6069943/malik12"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 990, "favorite_count": 0, "accepted_answer_id": 40383407, "answer_count": 1, "score": 4, "last_activity_date": 1478099464, "creation_date": 1458110198, "last_edit_date": 1458110533, "question_id": 36028374, "link": "https://stackoverflow.com/questions/36028374/custom-linux-pcie-driver-msi-interrupts", "title": "Custom linux pcie driver MSI interrupts", "body": "<p>I am writing a custom linux PCIe driver for an embedded device. For this purpose I need to enable multiple MSI vectors. When I use the function <code>pci_enable_msi(pdev)</code> the code works properly. However when I use <code>pci_enable_msi_block(pdev,4);</code> the function returns 1 meaning it can only allocate 1 interrupt. If I use <code>pci_enable_msi_block(pdev,32);</code> the function returns 16 upon which I use <code>pci_enable_msi_block(pdev,16);</code> but the return value is again 1.</p>\n\n<p>I tried to check the return value for all possible arguments and the result was as below:</p>\n\n<pre><code>for(i=2;i&lt;33;i++)\n    {\n       ret = pci_enable_msi_block(pdev,i);\n       printk(KERN_DEBUG \"For request i=%d the return value is=%d\\n\",i, ret);\n    }\n</code></pre>\n\n<p><br></p>\n\n<pre><code>[   89.421184] For request i=2 the return value is=1\n[   89.421196] For request i=3 the return value is=1\n[   89.421208] For request i=4 the return value is=1\n[   89.421220] For request i=5 the return value is=1\n[   89.421232] For request i=6 the return value is=1\n[   89.421243] For request i=7 the return value is=1\n[   89.421255] For request i=8 the return value is=1\n[   89.421266] For request i=9 the return value is=1\n[   89.421278] For request i=10 the return value is=1\n[   89.421290] For request i=11 the return value is=1\n[   89.421301] For request i=12 the return value is=1\n[   89.421313] For request i=13 the return value is=1\n[   89.421325] For request i=14 the return value is=1\n[   89.421336] For request i=15 the return value is=1\n[   89.421348] For request i=16 the return value is=1\n[   89.421353] For request i=17 the return value is=16\n[   89.421359] For request i=18 the return value is=16\n[   89.421364] For request i=19 the return value is=16\n[   89.421369] For request i=20 the return value is=16\n[   89.421374] For request i=21 the return value is=16\n[   89.421380] For request i=22 the return value is=16\n[   89.421385] For request i=23 the return value is=16\n[   89.421390] For request i=24 the return value is=16\n[   89.421395] For request i=25 the return value is=16\n[   89.421401] For request i=26 the return value is=16\n[   89.421406] For request i=27 the return value is=16\n[   89.421411] For request i=28 the return value is=16\n[   89.421416] For request i=29 the return value is=16\n[   89.421422] For request i=30 the return value is=16\n[   89.421427] For request i=31 the return value is=16\n[   89.421432] For request i=32 the return value is=16\n</code></pre>\n\n<p>the function call is successful (returns 0) only when <code>pci_enable_msi_block(pdev,1)</code> is used. </p>\n\n<p>I have also tried to use the <code>pci_enable_msi_exact</code> and <code>pci_enable_msi_range</code> functions but then the code does not compile and gives an implicit function declaration error.</p>\n\n<p>Kindly provide suggestions on how to resolve this issue so that I can use four MSI vectors.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 2703, "user_id": 2049333, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3de211d5b26ab932c16ab465d1791018?s=128&d=identicon&r=PG", "display_name": "mschuett", "link": "https://stackoverflow.com/users/2049333/mschuett"}, "edited": false, "score": 4, "creation_date": 1458109750, "post_id": 36028198, "comment_id": 59706609, "body": "You need to write your own function. Here is a start <a href=\"http://stackoverflow.com/questions/699968/display-the-binary-representation-of-a-number-in-c\" title=\"display the binary representation of a number in c\">stackoverflow.com/questions/699968/&hellip;</a>"}, {"owner": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 4, "creation_date": 1458109907, "post_id": 36028198, "comment_id": 59706669, "body": "&quot;I know that in C, the ints are stored in Two&#39;s comp&quot; - not actually guaranteed! Other representations are also allowed, such as one&#39;s complement and sign-magnitude. Two&#39;s complement is just the most common format used by modern hardware."}, {"owner": {"reputation": 931, "user_id": 1012111, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kfkKn.jpg?s=128&g=1", "display_name": "Gehan Fernando", "link": "https://stackoverflow.com/users/1012111/gehan-fernando"}, "edited": false, "score": 0, "creation_date": 1458109918, "post_id": 36028198, "comment_id": 59706674, "body": "Refer following link  <a href=\"http://stackoverflow.com/questions/21837008/how-to-convert-from-sign-magnitude-to-twos-complement\" title=\"how to convert from sign magnitude to twos complement\">stackoverflow.com/questions/21837008/&hellip;</a>"}, {"owner": {"reputation": 641, "user_id": 2177940, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/75d09add217c7e8caeada95bbebac831?s=128&d=identicon&r=PG", "display_name": "Thahleel Abid", "link": "https://stackoverflow.com/users/2177940/thahleel-abid"}, "edited": false, "score": 0, "creation_date": 1458110045, "post_id": 36028198, "comment_id": 59706731, "body": "I need it to work for the modern hardware scenario"}, {"owner": {"reputation": 3560, "user_id": 1303846, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da3b47c80b3c9d6f9e37a88b2ca51e6a?s=128&d=identicon&r=PG", "display_name": "Remember Monica", "link": "https://stackoverflow.com/users/1303846/remember-monica"}, "edited": false, "score": 0, "creation_date": 1555698607, "post_id": 36028198, "comment_id": 98206776, "body": "Too bad this question is wrongly marked as a duplicate, because the linked question most certainly is not a duplicate. Also, the answers here are either confusing or misleading, in fact, the answer is simply to convert the signed integer to an unsigned integer - C guarantees that the resulting unsigned value has the same bit pattern as the two&#39;s complement representation, even on machines where integers use other representations, because the unsigned conversion is defined by adding UINT_MAX + 1 until the result is positive, which results in the two&#39;s complement bit pattern of the signed value"}, {"owner": {"reputation": 3560, "user_id": 1303846, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da3b47c80b3c9d6f9e37a88b2ca51e6a?s=128&d=identicon&r=PG", "display_name": "Remember Monica", "link": "https://stackoverflow.com/users/1303846/remember-monica"}, "edited": false, "score": 0, "creation_date": 1555698861, "post_id": 36028198, "comment_id": 98206863, "body": "i.e. for your 9 bit example, this would work: 0x1ffU &amp; -254"}], "answers": [{"comments": [{"owner": {"reputation": 641, "user_id": 2177940, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/75d09add217c7e8caeada95bbebac831?s=128&d=identicon&r=PG", "display_name": "Thahleel Abid", "link": "https://stackoverflow.com/users/2177940/thahleel-abid"}, "edited": false, "score": 0, "creation_date": 1458109921, "post_id": 36028287, "comment_id": 59706676, "body": "As suggested in my example, the ints are signed, hence the complication"}, {"owner": {"reputation": 17723, "user_id": 733077, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/db1bf62fae51d5bafb8f1db7fb677176?s=128&d=identicon&r=PG", "display_name": "luser droog", "link": "https://stackoverflow.com/users/733077/luser-droog"}, "reply_to_user": {"reputation": 641, "user_id": 2177940, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/75d09add217c7e8caeada95bbebac831?s=128&d=identicon&r=PG", "display_name": "Thahleel Abid", "link": "https://stackoverflow.com/users/2177940/thahleel-abid"}, "edited": false, "score": 0, "creation_date": 1458110453, "post_id": 36028287, "comment_id": 59706921, "body": "cast the variables inside the expression and cast on the way out. If its not a 2s comp machine, it won&#39;t be the right <code>int</code> but it&#39;s still &quot;the 2s complement&quot;...[as interpreted by the machine after the implementation-defined conversion]."}], "tags": [], "owner": {"reputation": 17723, "user_id": 733077, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/db1bf62fae51d5bafb8f1db7fb677176?s=128&d=identicon&r=PG", "display_name": "luser droog", "link": "https://stackoverflow.com/users/733077/luser-droog"}, "is_accepted": false, "score": 5, "last_activity_date": 1575509818, "last_edit_date": 1575509818, "creation_date": 1458109873, "answer_id": 36028287, "question_id": 36028198, "link": "https://stackoverflow.com/questions/36028198/how-to-get-twos-complement-of-an-int-in-c/36028287#36028287", "title": "How to get two&#39;s complement of an int in C?", "body": "<p>If you're operating on <code>unsigned int</code>s then you can invert the bits <code>~</code> and add <code>1</code> to yield the 2s complement value. <code>x=(~y)+1;</code> If your machine uses a 2s complement representation for <code>signed int</code> then this should convert (by the implementation's definition) to the proper <code>signed int</code> value.</p>\n\n<p>The C language itself is a little vague in its guarantees in this area. To work portably on the bitwise representation of an object you should use an <code>unsigned</code> type.</p>\n"}, {"comments": [{"owner": {"reputation": 6223, "user_id": 2726892, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/DE8Dn.png?s=128&g=1", "display_name": "MooseBoys", "link": "https://stackoverflow.com/users/2726892/mooseboys"}, "edited": false, "score": 0, "creation_date": 1458110109, "post_id": 36028315, "comment_id": 59706762, "body": "This is not a good idea."}, {"owner": {"reputation": 8159, "user_id": 1091784, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/cIHz9.png?s=128&g=1", "display_name": "riteshtch", "link": "https://stackoverflow.com/users/1091784/riteshtch"}, "edited": false, "score": 0, "creation_date": 1458110170, "post_id": 36028315, "comment_id": 59706794, "body": "<code>itoa</code> is not standardized and not present for <code>gcc</code>"}, {"owner": {"reputation": 1, "user_id": 6053288, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VQRIs.png?s=128&g=1", "display_name": "hamzamuhammad", "link": "https://stackoverflow.com/users/6053288/hamzamuhammad"}, "edited": false, "score": 0, "creation_date": 1458110276, "post_id": 36028315, "comment_id": 59706840, "body": "...and as it says in the link that I posted, if you need to have portability you can use sprintf()."}], "tags": [], "owner": {"reputation": 1, "user_id": 6053288, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VQRIs.png?s=128&g=1", "display_name": "hamzamuhammad", "link": "https://stackoverflow.com/users/6053288/hamzamuhammad"}, "is_accepted": false, "score": -2, "last_activity_date": 1458110011, "creation_date": 1458110011, "answer_id": 36028315, "question_id": 36028198, "link": "https://stackoverflow.com/questions/36028198/how-to-get-twos-complement-of-an-int-in-c/36028315#36028315", "title": "How to get two&#39;s complement of an int in C?", "body": "<p>Actually, there is an easy way to do this. Simply convert your number to a binary string, and convert that string back to an integer.</p>\n\n<p>Use <code>itoa</code>, which converts a number to its given base in string form.</p>\n\n<p><a href=\"http://www.cplusplus.com/reference/cstdlib/itoa/\" rel=\"nofollow\">http://www.cplusplus.com/reference/cstdlib/itoa/</a></p>\n\n<p>Then, simply use the familiar atoi that converts it back to an int.</p>\n"}, {"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 2, "creation_date": 1458113542, "post_id": 36028321, "comment_id": 59708456, "body": "<code>0x80000000</code> is an unsigned literal so this code is bugged. Never use bitwise operators on signed types to begin with."}], "tags": [], "owner": {"reputation": 931, "user_id": 1012111, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kfkKn.jpg?s=128&g=1", "display_name": "Gehan Fernando", "link": "https://stackoverflow.com/users/1012111/gehan-fernando"}, "is_accepted": false, "score": -1, "last_activity_date": 1458110030, "creation_date": 1458110030, "answer_id": 36028321, "question_id": 36028198, "link": "https://stackoverflow.com/questions/36028198/how-to-get-twos-complement-of-an-int-in-c/36028321#36028321", "title": "How to get two&#39;s complement of an int in C?", "body": "<p>You can convert signed-magnitude to two's complement by subtracting the number from 0x80000000 if the number is negative. This will work for a 32-bit integer on a machine using two's complement to represent negative values, but if the value is positive this will result in a two's complement negation. A right shift of a two's complement negative number will shift in one's, we can utilize this to make a mask to select between the original value, or the conversion of a signed-magnitude negative value to a two's complement negative value.</p>\n\n<pre><code>int sm2tc(int x) {\n  int m = x &gt;&gt; 31;\n  return (~m &amp; x) | (((x &amp; 0x80000000) - x) &amp; m);\n}\n</code></pre>\n\n<p>Original Code posted by <strong>Apriori</strong></p>\n"}, {"tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 6, "last_activity_date": 1458114286, "creation_date": 1458114286, "answer_id": 36029507, "question_id": 36028198, "link": "https://stackoverflow.com/questions/36028198/how-to-get-twos-complement-of-an-int-in-c/36029507#36029507", "title": "How to get two&#39;s complement of an int in C?", "body": "<blockquote>\n  <p>know that in C, the ints are stored in Two's comp</p>\n</blockquote>\n\n<p>Not guaranteed, but in practice every computer uses two's complement.</p>\n\n<blockquote>\n  <p>Is there any way to pull out the Two's complement value from the integer variable</p>\n</blockquote>\n\n<p>It is already in two's complement format, so it is unclear what you are asking. It would seem you are asking how to print a variable in binary format?</p>\n\n<pre><code>int data = -254;\nconst size_t BITS = 8*sizeof(data);\nchar bin_str[BITS+1];\n\nfor(unsigned int i=0; i&lt;BITS; i++)\n{\n  unsigned int mask = 1u &lt;&lt; (BITS - 1 - i);\n  bin_str[i] = (data &amp; mask) ? '1' : '0';\n}\nbin_str[BITS] = '\\0';\n</code></pre>\n"}], "owner": {"reputation": 641, "user_id": 2177940, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/75d09add217c7e8caeada95bbebac831?s=128&d=identicon&r=PG", "display_name": "Thahleel Abid", "link": "https://stackoverflow.com/users/2177940/thahleel-abid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50499, "favorite_count": 3, "closed_date": 1458119690, "answer_count": 4, "score": 3, "last_activity_date": 1575509818, "creation_date": 1458109506, "question_id": 36028198, "link": "https://stackoverflow.com/questions/36028198/how-to-get-twos-complement-of-an-int-in-c", "closed_reason": "Duplicate", "title": "How to get two&#39;s complement of an int in C?", "body": "<p>How do you get the Two's complement for a int in C?</p>\n\n<p>Say for example I had an int such as -254, how would I go about converting this to 100000010?</p>\n\n<p>Is there any way to pull out the Two's complement value from the integer variable, as I know that in C, the ints are stored in Two's comp?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 27279, "user_id": 857132, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4fd51ed5980999c7c6ce3729d6cb2184?s=128&d=identicon&r=PG", "display_name": "John3136", "link": "https://stackoverflow.com/users/857132/john3136"}, "edited": false, "score": 1, "creation_date": 1458106810, "post_id": 36027553, "comment_id": 59705486, "body": "Types of <code>l_limit</code> and <code>u_limit</code>? Why do you think you need <code>&amp;&amp;</code> and not just <code>&amp;</code> ?"}, {"owner": {"reputation": 11494, "user_id": 1795279, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/4TEag.jpg?s=128&g=1", "display_name": "Haris", "link": "https://stackoverflow.com/users/1795279/haris"}, "edited": false, "score": 1, "creation_date": 1458106923, "post_id": 36027553, "comment_id": 59705525, "body": "I think you should show some more code. The calling function and the variable definitions."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 1, "creation_date": 1458107351, "post_id": 36027553, "comment_id": 59705673, "body": "<code>void swap(void *p1, void *p2, size_t obj_size);</code>"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 3, "creation_date": 1458107459, "post_id": 36027553, "comment_id": 59705725, "body": "This is not a generic swap function. This is a function to swap two void pointers. It will not swap two integers or strings or enums even if you are able to form pointers to these things. Pointers don&#39;t work this way. For some insight on how they do work, consider <code>memcpy</code>. It can be viewed as a generic assignment function. Now a generic swap would need three generic assignments in it, wouldn&#39;t it?"}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1458111467, "post_id": 36027553, "comment_id": 59707384, "body": "What problem are you attempting to solve?"}, {"owner": {"reputation": 825, "user_id": 2388930, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/84b8da7e65c988dea872c9f44610cdcd?s=128&d=identicon&r=PG", "display_name": "Dimpl", "link": "https://stackoverflow.com/users/2388930/dimpl"}, "edited": false, "score": 0, "creation_date": 1458121884, "post_id": 36027553, "comment_id": 59713621, "body": "What I was trying to do is to swap a and b by swapping the memory addresses associated with a and b, rather than swapping the values. This isn&#39;t necessary for integers, but could be for structs or arrays."}, {"owner": {"reputation": 825, "user_id": 2388930, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/84b8da7e65c988dea872c9f44610cdcd?s=128&d=identicon&r=PG", "display_name": "Dimpl", "link": "https://stackoverflow.com/users/2388930/dimpl"}, "reply_to_user": {"reputation": 27279, "user_id": 857132, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4fd51ed5980999c7c6ce3729d6cb2184?s=128&d=identicon&r=PG", "display_name": "John3136", "link": "https://stackoverflow.com/users/857132/john3136"}, "edited": false, "score": 0, "creation_date": 1458121997, "post_id": 36027553, "comment_id": 59713701, "body": "@John3136 Passing <code>&amp;a</code> and <code>&amp;b</code> won&#39;t work, as this just passes the values of the memory locations. After leaving the scope of the function, the variables a and b would be unchanged."}, {"owner": {"reputation": 825, "user_id": 2388930, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/84b8da7e65c988dea872c9f44610cdcd?s=128&d=identicon&r=PG", "display_name": "Dimpl", "link": "https://stackoverflow.com/users/2388930/dimpl"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1458122259, "post_id": 36027553, "comment_id": 59713902, "body": "@n.m. my thought process assumes that the pointers would be cast to void pointers automatically, in the same way that an int is cast to a double when the two are used in a binary operation. As the value is not used in the function, only the memory location, this use should be valid?"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1458123453, "post_id": 36027553, "comment_id": 59714786, "body": "You cannot swap two houses by swapping two pieces of paper with their street addresses written on them. You need to physically move bricks from place to place."}, {"owner": {"reputation": 825, "user_id": 2388930, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/84b8da7e65c988dea872c9f44610cdcd?s=128&d=identicon&r=PG", "display_name": "Dimpl", "link": "https://stackoverflow.com/users/2388930/dimpl"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1458126902, "post_id": 36027553, "comment_id": 59717215, "body": "@n.m. I disagree. You only need to swap the house numbers in order to divert traffic originally meant for each house to the other."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1458130265, "post_id": 36027553, "comment_id": 59719506, "body": "It&#39;s your approach that is not working, not mine. What do you mean by &quot;swapping the house numbers&quot;? Physically affixing new plagues with numbers to the houses? This may not work very well if everyone expects Main Street 40  to be right next to Main Street 42. Do you think every byte in your computer have a little plaque with an address which you can set at will? It doesn&#39;t work like that."}, {"owner": {"reputation": 825, "user_id": 2388930, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/84b8da7e65c988dea872c9f44610cdcd?s=128&d=identicon&r=PG", "display_name": "Dimpl", "link": "https://stackoverflow.com/users/2388930/dimpl"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1458130771, "post_id": 36027553, "comment_id": 59719845, "body": "@n.m. I&#39;m sorry, I don&#39;t think you understand. I have discovered that you cannot manually set the memory location of a variable (<code>&amp;a = &amp;b</code>), but, as a newcomer to c, this is not immediately apparent. I can&#39;t see a logical flaw in saying &#39;I want variable a to refer to the value in the memory location currently referenced by <code>b</code>. However, this is not supported by the language."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1458131383, "post_id": 36027553, "comment_id": 59720316, "body": "<code>you cannot manually set the memory location of a variable</code> Yes, that&#39;s exactly the problem. You cannot manually set the memory location of a variable. It is an inherent property of a variable. This is why your idea of affixing a new number to a house doesn&#39;t quite translate to memory addresses."}], "answers": [{"comments": [{"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1458107994, "post_id": 36027643, "comment_id": 59705917, "body": "@n.m. Fair enough. I am <i>guessing</i> he needs them."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1458108086, "post_id": 36027643, "comment_id": 59705958, "body": "A <i>generic</i> swap function."}, {"owner": {"reputation": 825, "user_id": 2388930, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/84b8da7e65c988dea872c9f44610cdcd?s=128&d=identicon&r=PG", "display_name": "Dimpl", "link": "https://stackoverflow.com/users/2388930/dimpl"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1458122411, "post_id": 36027643, "comment_id": 59714002, "body": "@n.m. as opposed to implementing swap_int(int*, int*), swap_double(double*, double*), etc. for each type"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 825, "user_id": 2388930, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/84b8da7e65c988dea872c9f44610cdcd?s=128&d=identicon&r=PG", "display_name": "Dimpl", "link": "https://stackoverflow.com/users/2388930/dimpl"}, "edited": false, "score": 0, "creation_date": 1458124233, "post_id": 36027643, "comment_id": 59715363, "body": "@Dimpl yes, I understand what you are trying to do."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 825, "user_id": 2388930, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/84b8da7e65c988dea872c9f44610cdcd?s=128&d=identicon&r=PG", "display_name": "Dimpl", "link": "https://stackoverflow.com/users/2388930/dimpl"}, "edited": false, "score": 1, "creation_date": 1458130553, "post_id": 36027643, "comment_id": 59719695, "body": "@Dimpl To reiterate, this answer shows how to swap ptr1 and ptr2, which is very different from swapping l_limit and u_limit. Do you really want that?"}, {"owner": {"reputation": 825, "user_id": 2388930, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/84b8da7e65c988dea872c9f44610cdcd?s=128&d=identicon&r=PG", "display_name": "Dimpl", "link": "https://stackoverflow.com/users/2388930/dimpl"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1458131238, "post_id": 36027643, "comment_id": 59720195, "body": "@n.m. No, I don&#39;t. I accepted this answer as it essentially stated that &amp;l_limit is read-only, so the approach I am trying to take is doomed to fail. This is the next best thing."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 825, "user_id": 2388930, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/84b8da7e65c988dea872c9f44610cdcd?s=128&d=identicon&r=PG", "display_name": "Dimpl", "link": "https://stackoverflow.com/users/2388930/dimpl"}, "edited": false, "score": 0, "creation_date": 1458131543, "post_id": 36027643, "comment_id": 59720437, "body": "@Dimpl The answer by muXXmit2X is exactly the generic swap routine you wanted to write. You may want to accept it instead, or perhaps just read and understand how it works."}, {"owner": {"reputation": 825, "user_id": 2388930, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/84b8da7e65c988dea872c9f44610cdcd?s=128&d=identicon&r=PG", "display_name": "Dimpl", "link": "https://stackoverflow.com/users/2388930/dimpl"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1458132561, "post_id": 36027643, "comment_id": 59721252, "body": "@n.m. I&#39;m not familiar with memcpy, but I believe muXXmit2X&#39;s solution copies the values between the memory locations, rather than changing which location is being referred to. I don&#39;t think the question is solvable due to restrictions of the language."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 825, "user_id": 2388930, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/84b8da7e65c988dea872c9f44610cdcd?s=128&d=identicon&r=PG", "display_name": "Dimpl", "link": "https://stackoverflow.com/users/2388930/dimpl"}, "edited": false, "score": 0, "creation_date": 1458133123, "post_id": 36027643, "comment_id": 59721685, "body": "@Dimpl That&#39;s what the generic swap is supposed to do. It&#39;s not &quot;a restriction of a language&quot; as you put it, but rather an inherent property of current computer architectures."}], "tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": false, "score": 6, "last_activity_date": 1458107321, "last_edit_date": 1458107321, "creation_date": 1458107119, "answer_id": 36027643, "question_id": 36027553, "link": "https://stackoverflow.com/questions/36027553/swapping-values-by-pointer/36027643#36027643", "title": "Swapping values by pointer", "body": "<p>You cannot use <code>swap(&amp;(&amp;l_limit), &amp;(&amp;u_limit))</code> since <code>&amp;l_limit</code> evaluates to a temporary rvalue pointer whose address cannot be taken. Same problem exists for <code>&amp;&amp;u_limit</code> also.</p>\n\n<p>You need to use:</p>\n\n<pre><code>void* ptr1 = &amp;l_limit;\nvoid* ptr2 = &amp;u_limit;\nswap(&amp;ptr1, &amp;ptr2);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 329, "user_id": 6021924, "user_type": "registered", "accept_rate": 63, "profile_image": "https://lh6.googleusercontent.com/-7W2UshWawos/AAAAAAAAAAI/AAAAAAAAABY/cI2CZIET0nk/photo.jpg?sz=128", "display_name": "Vitalii Paprotskyi", "link": "https://stackoverflow.com/users/6021924/vitalii-paprotskyi"}, "is_accepted": false, "score": 0, "last_activity_date": 1458119446, "last_edit_date": 1458119446, "creation_date": 1458107898, "answer_id": 36027813, "question_id": 36027553, "link": "https://stackoverflow.com/questions/36027553/swapping-values-by-pointer/36027813#36027813", "title": "Swapping values by pointer", "body": "<pre><code>int varA = 5, varB = 10;\nint *pA = &amp;varA;\nint *pB = &amp;varB;\nswap((void**)&amp;pA, (void**)&amp;pA);\n</code></pre>\n\n<p>Now <code>pA</code> points to <code>varB</code> and <code>pB</code> points to <code>varA</code></p>\n"}, {"tags": [], "owner": {"reputation": 2575, "user_id": 4711812, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/87100b6114369140256e64e7ebab7ec9?s=128&d=identicon&r=PG&f=1", "display_name": "muXXmit2X", "link": "https://stackoverflow.com/users/4711812/muxxmit2x"}, "is_accepted": false, "score": 3, "last_activity_date": 1458128159, "last_edit_date": 1458128159, "creation_date": 1458111821, "answer_id": 36028791, "question_id": 36027553, "link": "https://stackoverflow.com/questions/36027553/swapping-values-by-pointer/36028791#36028791", "title": "Swapping values by pointer", "body": "<p>As n.m. pointed out, to get a real generic swap function you should consider using <code>memcpy</code>. It can be used as a generic assignement.</p>\n\n<p>Your <code>swap</code> will then look like this:</p>\n\n<pre><code>void swap(void *a, void *b, size_t s)\n{\n    void *tmp = malloc(s);\n    if (tmp) \n    {\n        memcpy(tmp, a, s);\n        memcpy(a, b, s);\n        memcpy(b, tmp, s);\n    }\n    free(tmp);\n}\n</code></pre>\n\n<p>And can be used like so:</p>\n\n<pre><code>#define MAX 256\n\nint main()\n{\n    // works for primitive types\n    int a = 4, b = 5;\n    swap( &amp;a, &amp;b, sizeof(int));\n    printf(\"%d %d\\n\", a , b);\n\n    // as well as for pointers\n    char cA[MAX] = \"World!\";\n    char cB[MAX] = \"Hello \";\n    swap( &amp;cA, &amp;cB, MAX); \n    printf(\"%s%s\\n\", cA, cB); \n}\n</code></pre>\n\n<p>This will safely swap the values without the need of pointers to pointers. </p>\n"}, {"comments": [{"owner": {"reputation": 825, "user_id": 2388930, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/84b8da7e65c988dea872c9f44610cdcd?s=128&d=identicon&r=PG", "display_name": "Dimpl", "link": "https://stackoverflow.com/users/2388930/dimpl"}, "edited": false, "score": 0, "creation_date": 1458128888, "post_id": 36034748, "comment_id": 59718552, "body": "I know, which is why I was trying to use &amp;(&amp;a) and &amp;(&amp;b). However, from the feedback to this thread, it looks like this kind of behaviour is not possible."}], "tags": [], "owner": {"reputation": 48421, "user_id": 1196549, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/fa597bf0dc47449a25e1f7f5b57e3ef1?s=128&d=identicon&r=PG", "display_name": "Yves Daoust", "link": "https://stackoverflow.com/users/1196549/yves-daoust"}, "is_accepted": false, "score": 1, "last_activity_date": 1458128648, "creation_date": 1458128648, "answer_id": 36034748, "question_id": 36027553, "link": "https://stackoverflow.com/questions/36027553/swapping-values-by-pointer/36034748#36034748", "title": "Swapping values by pointer", "body": "<p>You are right on one point: this probably isn't the best idea.</p>\n\n<p>You are not swapping two pieces of data, you are swapping the values two pointers that happen to point to them, but the data stays in place.</p>\n\n<p>Assume for instance</p>\n\n<pre><code>int a= 3, b= 5;\nint* pa= &amp;a, * qa= &amp;a, * pb= &amp;b, * qb= &amp;b;\n</code></pre>\n\n<p>After your \"swap\" is called with <code>pa</code> and <code>pb</code>, <code>a</code> and <code>b</code> still contain <code>3</code> and <code>5</code>, <code>pa</code> points to <code>5</code> and <code>pb</code> to <code>3</code>, but <code>qa</code> still points to <code>3</code> and <code>qb</code> to <code>5</code>.</p>\n\n<p>Also note that without two properly initialized pointer variables, you just <em>can't</em> call your swap.</p>\n"}], "owner": {"reputation": 825, "user_id": 2388930, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/84b8da7e65c988dea872c9f44610cdcd?s=128&d=identicon&r=PG", "display_name": "Dimpl", "link": "https://stackoverflow.com/users/2388930/dimpl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 260, "favorite_count": 0, "answer_count": 4, "score": 1, "last_activity_date": 1458129320, "creation_date": 1458106692, "last_edit_date": 1458129320, "question_id": 36027553, "link": "https://stackoverflow.com/questions/36027553/swapping-values-by-pointer", "title": "Swapping values by pointer", "body": "<p>I feel like this probably isn't the best idea, but I've implemented a generic swap function in C like so:</p>\n\n<pre><code>void swap(void** p1, void** p2) {\n    void* temp = *p1;\n    *p1 = *p2;\n    *p2 = temp;\n}\n</code></pre>\n\n<p>However, I am having difficulties calling this function. <code>swap(&amp;&amp;a, &amp;&amp;b)</code> for integers a and b doesn't work as '&amp;&amp;' is the label operator, and <code>swap(&amp;(&amp;a), &amp;(&amp;b))</code> gives the error 'lvalue required as unary '&amp;' operand'. How should I call this function?</p>\n\n<p>Edit: changed variable names for clarity</p>\n\n<p>Edit: I'm trying to do the following, but, as &amp;a and &amp;b seem to be read-only ('lvalue required as left operand of assignment'), it doesn't work:</p>\n\n<pre><code>int a = 5;\nint b = 3;\nint* temp = &amp;a;\n&amp;a = &amp;b;\n&amp;b = temp;\nassert(a == 3);\nassert(b == 5);\n</code></pre>\n"}, {"tags": ["python", "c", "makefile", "pkg-config"], "comments": [{"owner": {"reputation": 312231, "user_id": 2225682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4958f4712d94ab82fe55fa471308e4b5?s=128&d=identicon&r=PG", "display_name": "falsetru", "link": "https://stackoverflow.com/users/2225682/falsetru"}, "edited": false, "score": 0, "creation_date": 1458106905, "post_id": 36027482, "comment_id": 59705513, "body": "Try <code>pkg-config --list-all | grep ^python</code>"}, {"owner": {"reputation": 2739, "user_id": 1044984, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/AIvXx.png?s=128&g=1", "display_name": "ComputerLocus", "link": "https://stackoverflow.com/users/1044984/computerlocus"}, "reply_to_user": {"reputation": 312231, "user_id": 2225682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4958f4712d94ab82fe55fa471308e4b5?s=128&d=identicon&r=PG", "display_name": "falsetru", "link": "https://stackoverflow.com/users/2225682/falsetru"}, "edited": false, "score": 0, "creation_date": 1458157319, "post_id": 36027482, "comment_id": 59739421, "body": "@falsetru No results.  Not including grep on that it is a fairly short list and I can manually also see no results. I do have python 2 and python 3 installed yet nothing. They were installed via <code>apt-get</code>. My <code>python3 --version</code> output gives me: <code>Python 3.4.3+</code>"}], "answers": [{"tags": [], "owner": {"reputation": 2739, "user_id": 1044984, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/AIvXx.png?s=128&g=1", "display_name": "ComputerLocus", "link": "https://stackoverflow.com/users/1044984/computerlocus"}, "is_accepted": false, "score": 3, "last_activity_date": 1458168540, "creation_date": 1458168540, "answer_id": 36048441, "question_id": 36027482, "link": "https://stackoverflow.com/questions/36027482/python3-pc-file-not-found-with-pkg-config/36048441#36048441", "title": "Python3.pc file not found with pkg-config", "body": "<p>To resolve the problem it looks like I needed to get the <code>python3-dev</code> package.</p>\n\n<p>Simply ran:</p>\n\n<pre><code>sudo apt-get install python3-dev\n</code></pre>\n"}], "owner": {"reputation": 2739, "user_id": 1044984, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/AIvXx.png?s=128&g=1", "display_name": "ComputerLocus", "link": "https://stackoverflow.com/users/1044984/computerlocus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3820, "favorite_count": 2, "answer_count": 1, "score": 1, "last_activity_date": 1458168540, "creation_date": 1458106317, "question_id": 36027482, "link": "https://stackoverflow.com/questions/36027482/python3-pc-file-not-found-with-pkg-config", "title": "Python3.pc file not found with pkg-config", "body": "<p>I am on a Ubuntu 14.04 machine that have python3 installed. In a make file I have flags that looks like this:</p>\n\n<pre><code>CFLAGS = -Wall -std=c11 -g -DNDEBUG `pkg-config --cflags python3`\n</code></pre>\n\n<p>I am getting the error when I run my make file:</p>\n\n<pre><code>gcc -Wall -std=c11 -g -DNDEBUG `pkg-config --cflags python3` -fPIC   -c -o calmodule.o calmodule.c\nPackage python3 was not found in the pkg-config search path.\nPerhaps you should add the directory containing `python3.pc'\nto the PKG_CONFIG_PATH environment variable\nNo package 'python3' found\ngcc -shared  calmodule.o calutil.o -o Cal.so\n</code></pre>\n\n<p>I checked the pkg-config folder and found nothing for python in there:</p>\n\n<pre><code>  % la /usr/lib/pkgconfig\ntotal 20K\n-rw-r--r-- 1 root root 288 Jul 22  2015 dbus-python.pc\n-rw-r--r-- 1 root root 452 Jul 22  2015 ibus-table.pc\n-rw-r--r-- 1 root root 245 Jul 12  2014 libquvi-scripts.pc\n-rw-r--r-- 1 root root 379 Jul 10  2014 pm-utils.pc\n-rw-r--r-- 1 root root 366 Sep 30 08:02 valgrind.pc\n</code></pre>\n\n<p>Shouldn't there be a <code>python3.pc</code> file in there? Or at the very least a specific one like <code>python3.4.pc</code> ?</p>\n\n<p>Or am I doing something wrong here?</p>\n"}, {"tags": ["c", "recursion", "iteration", "tree-traversal", "inorder"], "answers": [{"comments": [{"owner": {"reputation": 188, "user_id": 4551632, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh3.googleusercontent.com/---rDiBSumPU/AAAAAAAAAAI/AAAAAAAAABo/prSaA_6ufps/photo.jpg?sz=128", "display_name": "Rin Minase", "link": "https://stackoverflow.com/users/4551632/rin-minase"}, "edited": false, "score": 0, "creation_date": 1458106856, "post_id": 36027503, "comment_id": 59705500, "body": "Thank you for your answer. Correction, shouldn&#39;t the binary tree be, 4 and 5 under 3? (Not 4 and 5 under 2)"}, {"owner": {"reputation": 6422, "user_id": 4178170, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/xNv46.jpg?s=128&g=1", "display_name": "Humoyun Ahmad", "link": "https://stackoverflow.com/users/4178170/humoyun-ahmad"}, "reply_to_user": {"reputation": 188, "user_id": 4551632, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh3.googleusercontent.com/---rDiBSumPU/AAAAAAAAAAI/AAAAAAAAABo/prSaA_6ufps/photo.jpg?sz=128", "display_name": "Rin Minase", "link": "https://stackoverflow.com/users/4551632/rin-minase"}, "edited": false, "score": 0, "creation_date": 1458107052, "post_id": 36027503, "comment_id": 59705574, "body": "As you told it is binary tree, not binary search tree, if it is bst, your statement holds, but you did not mention about type of tree in your question :)"}, {"owner": {"reputation": 188, "user_id": 4551632, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh3.googleusercontent.com/---rDiBSumPU/AAAAAAAAAAI/AAAAAAAAABo/prSaA_6ufps/photo.jpg?sz=128", "display_name": "Rin Minase", "link": "https://stackoverflow.com/users/4551632/rin-minase"}, "edited": false, "score": 0, "creation_date": 1458107169, "post_id": 36027503, "comment_id": 59705612, "body": "Ohhh. Sorry. I forgot. This is a binary tree. Not a binary search tree. Thank you for your answer :)"}], "tags": [], "owner": {"reputation": 6422, "user_id": 4178170, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/xNv46.jpg?s=128&g=1", "display_name": "Humoyun Ahmad", "link": "https://stackoverflow.com/users/4178170/humoyun-ahmad"}, "is_accepted": true, "score": 6, "last_activity_date": 1458106384, "creation_date": 1458106384, "answer_id": 36027503, "question_id": 36027399, "link": "https://stackoverflow.com/questions/36027399/in-order-tree-traversal-recursion-to-iterative/36027503#36027503", "title": "In-Order Tree Traversal Recursion to Iterative", "body": "<p>Here is the algorithm for in-order traversal without recursion:   </p>\n\n<pre><code>1) Create an empty stack S.\n2) Initialize current node as root\n3) Push the current node to S and set current = current-&gt;left until current is NULL\n4) If current is NULL and stack is not empty then \n     a) Pop the top item from stack.\n     b) Print the popped item, set current = popped_item-&gt;right \n     c) Go to step 3.\n5) If current is NULL and stack is empty then we are done.\n</code></pre>\n\n<p>Let us consider the below tree for example</p>\n\n<pre><code>            1\n          /   \\\n        2      3\n      /  \\\n    4     5\n\nStep 1 Creates an empty stack: S = NULL\n\nStep 2 sets current as address of root: current -&gt; 1\n\nStep 3 Pushes the current node and set current = current-&gt;left until current is NULL\n     current -&gt; 1\n     push 1: Stack S -&gt; 1\n     current -&gt; 2\n     push 2: Stack S -&gt; 2, 1\n     current -&gt; 4\n     push 4: Stack S -&gt; 4, 2, 1\n     current = NULL\n\nStep 4 pops from S\n     a) Pop 4: Stack S -&gt; 2, 1\n     b) print \"4\"\n     c) current = NULL /*right of 4 */ and go to step 3\nSince current is NULL step 3 doesn't do anything. \n\nStep 4 pops again.\n     a) Pop 2: Stack S -&gt; 1\n     b) print \"2\"\n     c) current -&gt; 5/*right of 2 */ and go to step 3\n\nStep 3 pushes 5 to stack and makes current NULL\n     Stack S -&gt; 5, 1\n     current = NULL\n\nStep 4 pops from S\n     a) Pop 5: Stack S -&gt; 1\n     b) print \"5\"\n     c) current = NULL /*right of 5 */ and go to step 3\nSince current is NULL step 3 doesn't do anything\n\nStep 4 pops again.\n     a) Pop 1: Stack S -&gt; NULL\n     b) print \"1\"\n     c) current -&gt; 3 /*right of 5 */  \n\nStep 3 pushes 3 to stack and makes current NULL\n     Stack S -&gt; 3\n     current = NULL\n\nStep 4 pops from S\n     a) Pop 3: Stack S -&gt; NULL\n     b) print \"3\"\n     c) current = NULL /*right of 3 */  \n\nTraversal is done now as stack S is empty and current is NULL. \n</code></pre>\n\n<p>Implementation: </p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n#define bool int\n\n/* A binary tree tNode has data, pointer to left child\n   and a pointer to right child */\nstruct tNode\n{\n   int data;\n   struct tNode* left;\n   struct tNode* right;\n};\n\n/* Structure of a stack node. Linked List implementation is used for \n   stack. A stack node contains a pointer to tree node and a pointer to \n   next stack node */\nstruct sNode\n{\n  struct tNode *t;\n  struct sNode *next;\n};\n\n/* Stack related functions */\nvoid push(struct sNode** top_ref, struct tNode *t);\nstruct tNode *pop(struct sNode** top_ref);\nbool isEmpty(struct sNode *top);\n\n/* Iterative function for inorder tree traversal */\nvoid inOrder(struct tNode *root)\n{\n  /* set current to root of binary tree */\n  struct tNode *current = root;\n  struct sNode *s = NULL;  /* Initialize stack s */\n  bool done = 0;\n\n  while (!done)\n  {\n    /* Reach the left most tNode of the current tNode */\n    if(current !=  NULL)\n    {\n      /* place pointer to a tree node on the stack before traversing \n        the node's left subtree */\n      push(&amp;s, current);                                               \n      current = current-&gt;left;  \n    }\n\n    /* backtrack from the empty subtree and visit the tNode \n       at the top of the stack; however, if the stack is empty,\n      you are done */\n    else                                                             \n    {\n      if (!isEmpty(s))\n      {\n        current = pop(&amp;s);\n        printf(\"%d \", current-&gt;data);\n\n        /* we have visited the node and its left subtree.\n          Now, it's right subtree's turn */\n        current = current-&gt;right;\n      }\n      else\n        done = 1; \n    }\n  } /* end of while */ \n}     \n\n/* UTILITY FUNCTIONS */\n/* Function to push an item to sNode*/\nvoid push(struct sNode** top_ref, struct tNode *t)\n{\n  /* allocate tNode */\n  struct sNode* new_tNode =\n            (struct sNode*) malloc(sizeof(struct sNode));\n\n  if(new_tNode == NULL)\n  {\n     printf(\"Stack Overflow \\n\");\n     getchar();\n     exit(0);\n  }            \n\n  /* put in the data  */\n  new_tNode-&gt;t  = t;\n\n  /* link the old list off the new tNode */\n  new_tNode-&gt;next = (*top_ref);   \n\n  /* move the head to point to the new tNode */\n  (*top_ref)    = new_tNode;\n}\n\n/* The function returns true if stack is empty, otherwise false */\nbool isEmpty(struct sNode *top)\n{\n   return (top == NULL)? 1 : 0;\n}   \n\n/* Function to pop an item from stack*/\nstruct tNode *pop(struct sNode** top_ref)\n{\n  struct tNode *res;\n  struct sNode *top;\n\n  /*If sNode is empty then error */\n  if(isEmpty(*top_ref))\n  {\n     printf(\"Stack Underflow \\n\");\n     getchar();\n     exit(0);\n  }\n  else\n  {\n     top = *top_ref;\n     res = top-&gt;t;\n     *top_ref = top-&gt;next;\n     free(top);\n     return res;\n  }\n}\n\n/* Helper function that allocates a new tNode with the\n   given data and NULL left and right pointers. */\nstruct tNode* newtNode(int data)\n{\n  struct tNode* tNode = (struct tNode*)\n                       malloc(sizeof(struct tNode));\n  tNode-&gt;data = data;\n  tNode-&gt;left = NULL;\n  tNode-&gt;right = NULL;\n\n  return(tNode);\n}\n\n/* Driver program to test above functions*/\nint main()\n{\n\n  /* Constructed binary tree is\n            1\n          /   \\\n        2      3\n      /  \\\n    4     5\n  */\n  struct tNode *root = newtNode(1);\n  root-&gt;left        = newtNode(2);\n  root-&gt;right       = newtNode(3);\n  root-&gt;left-&gt;left  = newtNode(4);\n  root-&gt;left-&gt;right = newtNode(5); \n\n  inOrder(root);\n\n  getchar();\n  return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 188, "user_id": 4551632, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh3.googleusercontent.com/---rDiBSumPU/AAAAAAAAAAI/AAAAAAAAABo/prSaA_6ufps/photo.jpg?sz=128", "display_name": "Rin Minase", "link": "https://stackoverflow.com/users/4551632/rin-minase"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1189, "favorite_count": 1, "closed_date": 1458118032, "accepted_answer_id": 36027503, "answer_count": 1, "score": 0, "last_activity_date": 1458107180, "creation_date": 1458105865, "question_id": 36027399, "link": "https://stackoverflow.com/questions/36027399/in-order-tree-traversal-recursion-to-iterative", "closed_reason": "Needs details or clarity", "title": "In-Order Tree Traversal Recursion to Iterative", "body": "<p>I am having a problem converting this recursive In-Order Tree Traversal method to iterative.</p>\n\n<pre><code>typedef struct node {\n    int data;\n    struct node *left, *right;\n} node;\n\nvoid inOrder(node *temp) {  \n    if (temp != NULL){\n        inOrder(temp-&gt;left);\n        printf(\"%d, \", temp-&gt;data);\n        inOrder(temp-&gt;right);\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "linux", "multithreading", "linux-kernel", "header-files"], "comments": [{"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1458105959, "post_id": 36027285, "comment_id": 59705185, "body": "Are you trying to write a kernel module?"}, {"owner": {"reputation": 196, "user_id": 6008146, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YbpxZ.png?s=128&g=1", "display_name": "JumpAlways", "link": "https://stackoverflow.com/users/6008146/jumpalways"}, "reply_to_user": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1458106495, "post_id": 36027285, "comment_id": 59705369, "body": "@DavidSchwartz I&#39;m try to understand barriers. I wrote a simple program where each thread do some operations on a shared var. Without barries, I saw, for example calling a thread function that only increment the critical var, that after thousands of loops the value is &lt; than the loops. Now, I&#39;m trying to use the built-in barriers function to acquire and release semantics correctly to do safe operations on this shared var, and I&#39;d want to look at the disassembly to notice the differences. Later, I&#39;d want to implement a mutex on my own. The point is the headers seem to be messed up."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 1, "creation_date": 1458107488, "post_id": 36027285, "comment_id": 59705738, "body": "Barriers won&#39;t make a difference. The issue with increments is interleaving of read/modify/write operations. Barriers don&#39;t fix that. In fact, if anything they&#39;ll make it worse by slowing the operations down and enlarging the race window."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1458107619, "post_id": 36027285, "comment_id": 59705791, "body": "If you want to experiment in user space, you should use a user space library like boost atomics or GCC intrinsics."}, {"owner": {"reputation": 196, "user_id": 6008146, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YbpxZ.png?s=128&g=1", "display_name": "JumpAlways", "link": "https://stackoverflow.com/users/6008146/jumpalways"}, "reply_to_user": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1458108512, "post_id": 36027285, "comment_id": 59706114, "body": "@DavidSchwartz Why can&#39;t I use kernel defined mb(), rmb(), wrb()?"}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 1, "creation_date": 1458109493, "post_id": 36027285, "comment_id": 59706485, "body": "For the very reason that caused you to ask this question. They&#39;re just not hooked up that way."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1458134491, "post_id": 36027285, "comment_id": 59722803, "body": "Why are you set on using kernel routines? They are not for the weak of hearts. gcc provides a nice set of intrinsics to work with atomic - <a href=\"https://gcc.gnu.org/onlinedocs/gcc-4.4.5/gcc/Atomic-Builtins.html\" rel=\"nofollow noreferrer\">gcc.gnu.org/onlinedocs/gcc-4.4.5/gcc/Atomic-Builtins.html</a>"}], "owner": {"reputation": 196, "user_id": 6008146, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YbpxZ.png?s=128&g=1", "display_name": "JumpAlways", "link": "https://stackoverflow.com/users/6008146/jumpalways"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 880, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1458106668, "creation_date": 1458105141, "last_edit_date": 1458106668, "question_id": 36027285, "link": "https://stackoverflow.com/questions/36027285/memory-barriers-problems-with-linux-headers", "title": "Memory barriers - problems with linux headers", "body": "<p>To understand better locks and semaphores I've started reading about memory barriers and built-in functions used to acquire and relase semantics and I've a simple multithreading program in C to test them, but the compiler can't find the headers.</p>\n\n<p><code>asm/system.h</code> no longer exists, I've found out <code>barrier.h</code> has to used instead, but in <code>/usr/src/linux-headers-4.2.0.*/include</code> there's no <code>asm</code> directory and I've found <code>asm-generic</code> instead, and this one contains <code>atomic.h</code>, <code>atomic64.h</code>, <code>barrier.h</code>, <code>cmpxchg.h</code> and the other useful headers.\n<br>The point is that <code>asm-generic/atomic.h</code> try to include itself headers from <code>asm</code>:</p>\n\n<pre><code>&gt; cat \"/usr/src/linux-headers-4.2.0-34/include/asm-generic/atomic.h\"\n\n#ifndef __ASM_GENERIC_ATOMIC_H\n#define __ASM_GENERIC_ATOMIC_H\n\n#include &lt;asm/cmpxchg.h&gt;\n#include &lt;asm/barrier.h&gt;\n\n#ifdef CONFIG_SMP\n\n/* we can build all atomic primitives from cmpxchg */\n\n#define ATOMIC_OP(op, c_op)                     \\\nstatic inline void atomic_##op(int i, atomic_t *v)          \\\n{                                   \\\n    int c, old;                         \\\n                                    \\\n    c = v-&gt;counter;                         \\\n    while ((old = cmpxchg(&amp;v-&gt;counter, c, c c_op i)) != c)      \\\n        c = old;                        \\\n}\n...\n</code></pre>\n\n<p>...and <code>barrier.h</code> try to include <code>linux/compiler.h</code> wich gcc can't find, even though <code>compiler.h</code> is actually in <code>/usr/src/linux-headers-4.2.0-34/include/linux</code>...</p>\n\n<p><br>\nI don't understand why and how to make the compiler (GCC) recognizes the right path, in fact if I try to <code>#include &lt;asm-generic/atomic.h&gt;</code> it returns:</p>\n\n<pre><code>membarriers.c:9:32: fatal error: asm-generic/atomic.h: No such file or directory\ncompilation terminated.\n</code></pre>\n\n<p><br>\nI'm using Ubuntu 15.10 x64, Kenel version 4.2.0-34.</p>\n\n<p>Suggestions?</p>\n"}, {"tags": ["c", "visual-studio", "assembly", "stack"], "comments": [{"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1458104535, "post_id": 36026794, "comment_id": 59704740, "body": "asked about a zillion times on this site..."}, {"owner": {"reputation": 3765, "user_id": 459615, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73f4c8c6dee5c7decf6434296f0fce47?s=128&d=identicon&r=PG", "display_name": "Kurt Stutsman", "link": "https://stackoverflow.com/users/459615/kurt-stutsman"}, "reply_to_user": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1458104599, "post_id": 36026794, "comment_id": 59704757, "body": "@dwelch That&#39;s not helfpful unless you actually provide a link."}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1458104661, "post_id": 36026794, "comment_id": 59704780, "body": "too many links, the OP didnt bother to look, should look first."}, {"owner": {"reputation": 3765, "user_id": 459615, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73f4c8c6dee5c7decf6434296f0fce47?s=128&d=identicon&r=PG", "display_name": "Kurt Stutsman", "link": "https://stackoverflow.com/users/459615/kurt-stutsman"}, "reply_to_user": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1458104769, "post_id": 36026794, "comment_id": 59704817, "body": "@dwelch I just tried to do a search and couldn&#39;t find anything that explained why the compiler is allocating extra space. Not saying the question doesn&#39;t exist, but it&#39;s not that easy to find either. I will admit that there are a number of them showing up as related on the side."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1458114578, "post_id": 36026794, "comment_id": 59708996, "body": "Google &quot;stack frames&quot; for the given OS."}, {"owner": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "edited": false, "score": 0, "creation_date": 1458152276, "post_id": 36026794, "comment_id": 59736387, "body": "One thing I recommend is not reviewing debug builds. I assume this is a debug build with incremental linking on (and/or edit and continue). As long as data is aligned on the stack appropriately it doesn&#39;t matter how much space is allocated (as long as the stack remains on a 4-byte boundary before a function call). As long as the data is placed into the local stack space at proper alignments the size of the space allocated doesn&#39;t much matter. In your case you have incremental linking on so stack space is reserved via internal MSVC logic to handle that."}, {"owner": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "edited": false, "score": 0, "creation_date": 1458152343, "post_id": 36026794, "comment_id": 59736418, "body": "If you review a release build (which generally isn&#39;t compiled for incremental building) you might get a better idea of how the stack is allocated without the fluff."}], "answers": [{"tags": [], "owner": {"reputation": 3765, "user_id": 459615, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73f4c8c6dee5c7decf6434296f0fce47?s=128&d=identicon&r=PG", "display_name": "Kurt Stutsman", "link": "https://stackoverflow.com/users/459615/kurt-stutsman"}, "is_accepted": false, "score": 1, "last_activity_date": 1458104422, "last_edit_date": 1458104422, "creation_date": 1458103860, "answer_id": 36027031, "question_id": 36026794, "link": "https://stackoverflow.com/questions/36026794/understanding-space-allocation-for-variables-on-stack/36027031#36027031", "title": "Understanding space allocation for variables on stack", "body": "<p>The compiler is free to allocate as much extra storage as it wants. The C standard does not dictate constraints on the stack allocation. </p>\n\n<p>EDIT:</p>\n\n<p>I did some experimentation on <a href=\"http://gcc.godbolt.org\" rel=\"nofollow\">godbolt</a> with the ICC compiler, the only compiler that generates code like your example. I disproved myself about the arguments to main thing I mentioned before. I also tried creating some character arrays and found that the stack will always allocate in increments of 16 bytes. A char array of 1-16 bytes all cause a 16-byte allocation. Next 17-32 will cause a 32-byte allocation and so on.</p>\n"}], "owner": {"reputation": 1, "user_id": 6059396, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef45916e6ba1f0c5cefc27dc6dd9f380?s=128&d=identicon&r=PG&f=1", "display_name": "Sandy", "link": "https://stackoverflow.com/users/6059396/sandy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1458106635, "creation_date": 1458102434, "last_edit_date": 1458106635, "question_id": 36026794, "link": "https://stackoverflow.com/questions/36026794/understanding-space-allocation-for-variables-on-stack", "title": "Understanding space allocation for variables on stack", "body": "<p>I want to understand how space allocation is done for variables on stack.</p>\n\n<p>Here for this C program with no variables</p>\n\n<pre><code>main() { return 0; }\n</code></pre>\n\n<p>It's disassembly is</p>\n\n<pre><code>push ebp\nmov ebp, esp\nsub esp, 0c0h      \n\n\nmain() {\nint i = 10; }\n</code></pre>\n\n<p>The dis-assembly for this program is</p>\n\n<pre><code>push ebp \nmov ebp, esp \nsub esp, 0cch\n</code></pre>\n\n<p>I am initializing an INT variable, whose size is 4 bytes. But in the above dis-assembly compiler is allocating 12 bytes (0cc-0c0).</p>\n\n<p>For the following program </p>\n\n<pre><code>main() { long long int i = 10LL; } \n</code></pre>\n\n<p>The disassembly is </p>\n\n<pre><code>push ebp \nmov ebp, esp \nsub esp, 0D0h\n</code></pre>\n\n<p>In the above disassembly compiler is allocating 16 bytes(0D0 - 0C0) for long long int, whose size is 8 bytes.</p>\n\n<p>Why is compiler assigning 12 bytes(4 bytes extra allocated. It should be 8 byte or 16 byte aligned) for INT, whose size is 4 bytes and 16 bytes for LONG LONG INT, whose size is 8 bytes?</p>\n\n<p>Can someone please clarify this.</p>\n\n<p>Thanks.</p>\n"}]