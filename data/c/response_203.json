[{"tags": ["c", "linux", "sockets", "networking", "epoll"], "comments": [{"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1543459855, "post_id": 53529855, "comment_id": 93930502, "body": "regarding: <code>#include &lt;iostream&gt;</code>  in the server.  This is a C++ header file.  Why is it being included in a C file?"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1543460300, "post_id": 53529855, "comment_id": 93930591, "body": "When compiling. always enable the warnings then fix those warnings.   for <code>gcc</code>, at a minimum use: <code>-Wall -Wextra -Werror -Wconversion -pedantic -std-gnu11</code>"}, {"owner": {"reputation": 81087, "user_id": 104458, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/cc46b8a10ecb92e61aaeb1efe436a0c8?s=128&d=identicon&r=PG", "display_name": "selbie", "link": "https://stackoverflow.com/users/104458/selbie"}, "edited": false, "score": 1, "creation_date": 1543460757, "post_id": 53529855, "comment_id": 93930684, "body": "Where is your code &quot;grinded to a halt&quot; at.  Is it blocked on &quot;accept&quot; or spinning in a loop.  That will be very valuable information for debuggin"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1543460932, "post_id": 53529855, "comment_id": 93930711, "body": "never access beyond <code>argv[0]</code> without first checking <code>argc</code> to assure the command line parameter(s) actually exist"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1543461348, "post_id": 53529855, "comment_id": 93930793, "body": "why are statements like: <code>(listenfd = tcpipv4_createfd_bind(rp));</code> enclosed in parens?"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1543461680, "post_id": 53529855, "comment_id": 93930848, "body": "regarding statements like: <code>fprintf(stderr, &quot;failed to bind socket %d\\n&quot;, sfd);</code>  it would be much better to call <code>perror()</code> so the reason the system thinks the function failed would also be output to <code>stderr</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1543462102, "post_id": 53529855, "comment_id": 93930929, "body": "regarding: <code>Vevents = (struct epoll_event*)calloc(MAXEVENTS, sizeof(struct epoll_event));</code>  1) when calling any of the heap allocation functions, always check (!=NULL) the returned value to assure the operation was successful.  2) in C, the returned type is <code>void*</code> which can be assigned to any pointer.  Casting just clutters the code, making it more difficult to understand, debug, etc"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1543462467, "post_id": 53529855, "comment_id": 93930993, "body": "one of the major problems with the posted code is everything is being handled serially.  The posted code could handle MANY more events if each connection event is passed to a thread (preferably in a thread pool), so the main program can continue to handle the connection (accept()) events."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1543462907, "post_id": 53529855, "comment_id": 93931086, "body": "The posted code fails to release the client when a call to <code>read()</code> returns 0 (I.E. the client has hung up)"}, {"owner": {"reputation": 81087, "user_id": 104458, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/cc46b8a10ecb92e61aaeb1efe436a0c8?s=128&d=identicon&r=PG", "display_name": "selbie", "link": "https://stackoverflow.com/users/104458/selbie"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1543467445, "post_id": 53529855, "comment_id": 93932092, "body": "@user3629249 - the value of epoll is that you can multiple a lot of connections on a single thread. (Higher performance than select/poll calls).  But you are correct, more threads would enable higher scalability. But I think the OP needs to get his single-threaded version debugged first before adding more threads."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user9330225"}, "edited": false, "score": 0, "creation_date": 1543511401, "post_id": 53531391, "comment_id": 93955108, "body": "I had already increased the system file ulimits to 65536 - but good looking out"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9330225"}, "edited": false, "score": 0, "creation_date": 1543511512, "post_id": 53531391, "comment_id": 93955168, "body": "changing the listen socket to Level triggered solved the problem. what are the implications of this for a listener socket? will it keep my event loop spinning since its always being notified?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9330225"}, "edited": false, "score": 0, "creation_date": 1543511539, "post_id": 53531391, "comment_id": 93955174, "body": "And what are the implications to setting the listen socket to nonblocking? that didnt have any impact in this exercise."}, {"owner": {"user_type": "does_not_exist", "display_name": "user9330225"}, "edited": false, "score": 0, "creation_date": 1543514337, "post_id": 53531391, "comment_id": 93956541, "body": "By the way, connections seem to be accepted in batches of 200, usually per second. Is this normal?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9330225"}, "edited": false, "score": 0, "creation_date": 1543514721, "post_id": 53531391, "comment_id": 93956744, "body": "...and after around 10k clients, things speed up and the batching stops.  I see the same behaviour when testing with a different server. Leading me to think this is system related"}, {"owner": {"reputation": 81087, "user_id": 104458, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/cc46b8a10ecb92e61aaeb1efe436a0c8?s=128&d=identicon&r=PG", "display_name": "selbie", "link": "https://stackoverflow.com/users/104458/selbie"}, "edited": false, "score": 1, "creation_date": 1543515617, "post_id": 53531391, "comment_id": 93957150, "body": "@localhost - Changing the listen socket to level triggered is perfectly fine.  epoll_wait will return whenever there&#39;s a incoming connection.  Edge Triggering is very difficult to get right - you have to make sure that you drain the queue. Honestly, I don&#39;t think you get much of a performance benefit of edge-triggering unless you are trying to do something clever."}, {"owner": {"reputation": 81087, "user_id": 104458, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/cc46b8a10ecb92e61aaeb1efe436a0c8?s=128&d=identicon&r=PG", "display_name": "selbie", "link": "https://stackoverflow.com/users/104458/selbie"}, "edited": false, "score": 1, "creation_date": 1543515895, "post_id": 53531391, "comment_id": 93957308, "body": "You are welcome to look at my source for an EPOLL based STUN server and the polling abstraction for poll/epoll.  It&#39;s a simple protocol. I originally had it as Edge Triggered. But then I extended it to allow for multiple sessions on the same connection, it got too bothersome to keep with ET.  source <a href=\"https://github.com/jselbie/stunserver/blob/master/server/tcpserver.cpp\" rel=\"nofollow noreferrer\">here</a> and <a href=\"https://github.com/jselbie/stunserver/blob/master/networkutils/polling.cpp\" rel=\"nofollow noreferrer\">here</a>"}], "tags": [], "owner": {"reputation": 81087, "user_id": 104458, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/cc46b8a10ecb92e61aaeb1efe436a0c8?s=128&d=identicon&r=PG", "display_name": "selbie", "link": "https://stackoverflow.com/users/104458/selbie"}, "is_accepted": true, "score": 0, "last_activity_date": 1543478934, "last_edit_date": 1543478934, "creation_date": 1543461789, "answer_id": 53531391, "question_id": 53529855, "link": "https://stackoverflow.com/questions/53529855/epoll-tcp-server-grinds-to-a-halt-when-accepting-connections/53531391#53531391", "title": "Epoll tcp server grinds to a halt when accepting connections", "body": "<p>Start with this:</p>\n\n<ul>\n<li><p>Remove the <code>EPOLLET</code> flags from the listen socket registration.  You\nmight want to remove it from the client connection sockets too.</p></li>\n<li><p>Set your listen socket to non-blocking similar to how the client\nconnection sockets returned from <code>accept</code> are set.</p></li>\n</ul>\n\n<p>There's all kinds of edge cases with the listen sockets.  I'm not sure, but it appears you aren't fully draining the accept queue when epoll_ctl comes back to indicate that the listen socket has a connection ready. (Think: multiple incoming connections on one edge trigger). It's possible you are blocking on accept and/or stuck on epoll_wait.</p>\n\n<p><strong>Update:</strong></p>\n\n<ul>\n<li>Another thing you could be hitting are the system limits for the maximum number of files handles per process.  Read up <a href=\"https://stackoverflow.com/questions/3734932/max-open-files-for-working-process\">here</a>.</li>\n</ul>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9330225"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 406, "favorite_count": 0, "accepted_answer_id": 53531391, "answer_count": 1, "score": 0, "last_activity_date": 1543478934, "creation_date": 1543449077, "question_id": 53529855, "link": "https://stackoverflow.com/questions/53529855/epoll-tcp-server-grinds-to-a-halt-when-accepting-connections", "title": "Epoll tcp server grinds to a halt when accepting connections", "body": "<p>I'm trying to connect 10,000+ tcp clients to my tcp server below. After 1-5 seconds I'm able to get between 200 and 5000 clients connected before the code grinds to a halt and hangs without terminating. I cant find any further documentation on this and the gprof profiler isnt able to collect any data.</p>\n\n<p>Server:</p>\n\n<pre><code>#include &lt;unistd.h&gt;\n#include &lt;assert.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;arpa/inet.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;sys/epoll.h&gt;\n#include &lt;netdb.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;iostream&gt;\n\n#ifndef MAXEVENTS\n#define MAXEVENTS 64\n#endif\n#ifndef TX_BUF_SIZE\n#define TX_BUF_SIZE (65535)\n#endif\n#ifndef RX_BUF_SIZE\n#define RX_BUF_SIZE (65535)\n#endif\n\nchar buf[RX_BUF_SIZE];\n\nvoid user_recv_handler(int efd, int fd, char * buf, int len)\n{\n    int s = -1;\n    struct epoll_event ev;\n    ev.data.fd = fd;\n    ev.events = EPOLLOUT | EPOLLET;\n    s = epoll_ctl(efd, EPOLL_CTL_MOD, fd, &amp;ev);\n    //assert(s!=-1);\n    if(s==-1)\n    {\n        fprintf(stderr, \"epoll out error.\\n\");\n        return;\n    }\n}\n\nstruct addrinfo* tcpipv4_getaddrinfo(char* port)\n{\n    struct addrinfo hints;\n    struct addrinfo *res;\n    int s;\n\n    bzero(&amp;hints, sizeof(struct addrinfo));\n    hints.ai_family = AF_INET; // ipv4 addrs \n    hints.ai_socktype = SOCK_STREAM; // TCP\n    hints.ai_flags = AI_PASSIVE;\n    s = getaddrinfo(NULL, port, &amp;hints, &amp;res);\n    //assert(s==0);\n    if (s)\n    {\n        fprintf(stderr, \"failed to getaddrinfo: %s\\n\", gai_strerror(s));\n        return NULL;\n    }\n    return res;\n}\n\n\nstruct addrinfo* tcpipv6_getaddrinfo(char* port)\n{\n    struct addrinfo hints;\n    struct addrinfo *res;\n    int s;\n\n    bzero(&amp;hints, sizeof(struct addrinfo));\n    hints.ai_family = AF_INET6; // ipv4 addrs \n    hints.ai_socktype = SOCK_STREAM; // TCP\n    hints.ai_flags = AI_PASSIVE;\n    s = getaddrinfo(NULL, port, &amp;hints, &amp;res);\n    //assert(s==0);\n    if (s)\n    {\n        fprintf(stderr, \"failed to getaddrinfo-ipv6: %s\\n\", gai_strerror(s));\n        return NULL;\n    }\n    return res;\n}\n\nint set_nonblock(int fd)\n{\n    int flags = -1;\n    if(-1 == (flags = fcntl(fd, F_GETFL, 0)))\n    {\n        return -1;\n    }\n    flags |= O_NONBLOCK;\n    if( fcntl(fd, F_SETFL, flags) == -1 )\n    {\n        return -1;\n    }\n    return 0;\n}\n\nint tcpipv4_createfd_bind(struct addrinfo* rp)\n{\n    int flags = -1;\n    int s;\n    // create socket \n    int sfd = socket(rp-&gt;ai_family, rp-&gt;ai_socktype, rp-&gt;ai_protocol);\n    //assert(sfd!=-1);\n    if (sfd == -1) \n    {\n        fprintf(stderr, \"failed to create socket\\n\");\n        return -1;\n    }\n    // bind\n    s = bind(sfd, rp-&gt;ai_addr, rp-&gt;ai_addrlen);\n    //assert(s==0);\n    if(s!=0)\n    {\n        fprintf(stderr, \"failed to bind socket %d\\n\", sfd);\n        return -1;\n    }\n    // nonblock\n    s = set_nonblock(sfd);\n    //assert(s != -1);\n    if (s == -1)\n    {\n        fprintf(stderr, \"failed to set nonblocking socket %d\\n\", sfd);\n        return -1;\n    }\n    return sfd;\n}\n\nint writen(int fd, char * buf, size_t len)\n{\n    char * cur = buf;\n    int n = -1;\n    while(len&gt;0)\n    {\n        n = write(fd, cur, len);\n        if (n&lt;=0)\n        {\n            if(errno == EINTR) continue;\n            else return -1;\n        }\n        len -= n;\n        cur += n;\n    }\n    return 0;\n}\n\nint readn(int fd, char* buf, size_t len)\n{\n    char *cur = buf;\n    int n = -1;\n    while (len&gt;0)\n    {\n        n = read(fd, cur, len);\n        if (n == -1)\n        {\n            if (errno == EINTR)\n                continue;\n            else break;\n        }\n        else if (n == 0)\n            break;\n        cur += n; len -= n;\n    }\n    return (int)(cur-buf);\n}\n\nvoid accept_handler(int efd, int listenfd)\n{\n    struct epoll_event event;\n    int s;\n    while(1)\n    {\n        struct sockaddr in_addr;\n        socklen_t in_addrlen = sizeof(struct sockaddr);\n        int infd = -1;\n        char hbuf[NI_MAXHOST], sbuf[NI_MAXSERV];\n\n        infd = accept(listenfd, &amp;in_addr, &amp;in_addrlen);\n        //assert(infd != -1);\n        if(infd == -1)\n        {\n            if(errno == EAGAIN || errno == EWOULDBLOCK)\n                ;\n            else\n                perror(\"failed to accept\\n\");\n            return;\n        }\n        s = getnameinfo(&amp;in_addr, in_addrlen, \n                hbuf, sizeof(hbuf), \n                sbuf, sizeof(sbuf),\n                NI_NUMERICHOST | NI_NUMERICSERV);\n        //assert(s == 0);\n        if(s == 0)\n        {\n            printf(\"Accept fd %d host %s port %s\\n\", infd, hbuf, sbuf);\n            s = set_nonblock(infd);\n            //assert(s!=-1);\n            event.data.fd = infd;\n            event.events = EPOLLIN | EPOLLET;\n            s = epoll_ctl(efd, EPOLL_CTL_ADD, infd, &amp;event);\n            //assert(s != -1);\n            return;\n        }\n    }\n    return;\n}\n\nvoid read_handler(int efd, int fd)\n{\n    //do sonething with buf.\n    int s = -1;\n    s=readn(fd, buf, sizeof(buf));\n    buf[s] = 0;\n    //printf(\"recv %d bytes: %s\", s, buf);\n    if(s &lt; 0)\n    {\n        close(fd);\n        if(-1 == epoll_ctl(efd, EPOLL_CTL_DEL, fd, NULL) )\n            fprintf(stderr, \"failed to del event of %d\\n\", fd);\n        printf(\"close conection on fd %d\", fd);\n    }\n    else if(s &gt; 0)\n    {\n        //std::cout &lt;&lt; buf &lt;&lt; std::endl;\n        //do sonething with buf.\n        user_recv_handler(efd, fd, buf, s);\n    }\n}\n\n\nvoid write_handler(int efd, int fd)\n{\n    writen(fd, buf, strlen(buf));\n    if(-1 == epoll_ctl(efd, EPOLL_CTL_DEL, fd, NULL) )\n        fprintf(stderr, \"failed to del event of %d\\n\", fd);\n//  close(fd);\n}\n\nint main(int argc, char ** argv)\n{\n    char* port = NULL;\n    int listenfd = -1;\n    struct addrinfo* hostaddr=NULL; \n    struct addrinfo* rp = NULL;\n    struct epoll_event event;\n    struct epoll_event * events, *cur_ev;\n    int efd = -1;\n    int num_ev = -1;\n    int s;\n\n    port = argv[1];\n    // get server ipv4 address by getaddrinfo\n    (rp = hostaddr = tcpipv4_getaddrinfo(port));\n    // create and bind listening socket\n    for(; rp; rp = rp-&gt;ai_next)\n    {\n        (listenfd = tcpipv4_createfd_bind(rp));\n        if(-1 == listenfd)\n            continue;\n    }\n    freeaddrinfo(hostaddr); \n    //assert(listenfd!=-1);\n    if(listenfd==-1)\n        exit(EXIT_FAILURE);\n    //start listening \n    (s = listen(listenfd, SOMAXCONN));\n    //assert(s!=-1);\n    if(s == -1)\n        exit(EXIT_FAILURE);\n    // create epoll\n    efd = epoll_create(MAXEVENTS);\n    //assert(efd != -1);\n    if(efd == -1)\n        exit(EXIT_FAILURE);\n\n    event.data.fd = listenfd;\n    // epoll: read, ET\n    event.events = EPOLLIN | EPOLLET;\n    s = epoll_ctl(efd, EPOLL_CTL_ADD, listenfd, &amp;event);\n    //assert(s!=-1);\n    if(s==-1)\n        exit(EXIT_FAILURE);\n\n    events = (struct epoll_event*)calloc(MAXEVENTS, sizeof(struct epoll_event));\n\n    // event loop;\n    while (1)\n    {\n        num_ev = epoll_wait(efd, events, MAXEVENTS, -1);\n        // for each active event: \n        while(num_ev--)\n        {\n            cur_ev = events+num_ev;\n            // close the fd if error (ERR) or hang up (HUP)\n            if(cur_ev-&gt;events &amp; EPOLLERR || \n                cur_ev-&gt;events &amp; EPOLLHUP)\n            {\n                fprintf(stderr, \"epoll get event error\\n\");\n                close(cur_ev-&gt;data.fd);\n                continue;\n            }\n            // one or more new connections (fd = listenfd)\n            else if(cur_ev-&gt;data.fd == listenfd)\n            {\n                accept_handler(efd, listenfd);\n                continue;\n            }\n            else if(cur_ev-&gt;events &amp; EPOLLIN)\n            {\n                // since the registered event is EPOLLIN, \n                // here we have data on fd waiting for reading.     \n                read_handler(efd, cur_ev-&gt;data.fd);\n            }\n            else if (cur_ev-&gt;events &amp; EPOLLOUT)\n            {\n                write_handler(efd, cur_ev-&gt;data.fd);\n            }\n        }\n    }\n    free(events); events = NULL;\n    close(listenfd);\n    exit(EXIT_SUCCESS);\n}\n</code></pre>\n\n<p>Client:</p>\n\n<pre><code>int connected_count=0;\nint i=0;\nstruct timespec tstart={0,0}, tend={0,0};\nclock_gettime(CLOCK_MONOTONIC, &amp;tstart);\nfor(; i!=10000; i++)\n{\n    int sockfd;\n    int portno = 4000;\n    ssize_t n;\n    struct sockaddr_in serveraddr;\n    struct hostent* server;\n    char hostname[] = \"127.0.0.1\";\n    sockfd = socket(AF_INET, SOCK_STREAM, 0);\n    if(sockfd &lt; 0)\n    {\n        printf(\"ERROR opening socket\");\n        printf(\"error %d\",errno);\n        test_function_killall(NULL);\n        return;\n    }\n    server = gethostbyname(hostname);\n    if(server == NULL)\n    {\n        fprintf(stderr,\"ERROR, no such host as %s\\n\", hostname);\n        test_function_killall(NULL);\n        return;\n    }\n    bzero((char*)&amp;serveraddr, sizeof(serveraddr));\n    serveraddr.sin_family = AF_INET;\n    bcopy((char*)server-&gt;h_addr, (char*)&amp;serveraddr.sin_addr.s_addr, server-&gt;h_length);\n    serveraddr.sin_port = htons(portno);\n    if(connect(sockfd, (struct sockaddr*)&amp;serveraddr, sizeof(serveraddr)) &lt; 0) \n    {\n        printf(\"ERROR connecting\");\n        test_function_killall(NULL);\n        return;\n    }\n    else\n    {\n        std::cout &lt;&lt; \"active connections \" &lt;&lt; connected_count++ &lt;&lt; std::endl;\n    }\n    set_nonblock(sockfd);\n}   \nif(connected_count==10000)\n{       \n    printf(\"complete\");\n}\n</code></pre>\n"}, {"tags": ["c", "floating-point"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1543445354, "post_id": 53529251, "comment_id": 93927285, "body": "Step 1 when viewing FP values as part of debug.  Do not use <code>printf(&quot;value: %f\\n&quot;, data);</code>,  Use <code>&quot;%e&quot;</code> or <code>&quot;%a&quot;</code>.  They are more informative."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1543445518, "post_id": 53529251, "comment_id": 93927332, "body": "&quot;Why doesn&#39;t my initial code give this value?&quot;  It depends on endian of the float (and other factors: encoding, width, etc.).  Try reversing the bytes of the float, then print."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1543446067, "post_id": 53529251, "comment_id": 93927478, "body": "Are you <i>sure</i> you need to send the data in floating-point form?  Chances are good that an integer-based fixed-point representation would serve your needs at least as well, and be easier to work with to boot."}, {"owner": {"reputation": 11, "user_id": 10184198, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e61fea6cace8909369190f5b2c3c27ec?s=128&d=identicon&r=PG&f=1", "display_name": "NewComer", "link": "https://stackoverflow.com/users/10184198/newcomer"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1543452185, "post_id": 53529251, "comment_id": 93928919, "body": "@chux Thanks for the %e and %a suggestion. I&#39;ll use that. And is there any standard function which would reverse the bits for me? A google search won&#39;t produce any good results."}, {"owner": {"reputation": 11, "user_id": 10184198, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e61fea6cace8909369190f5b2c3c27ec?s=128&d=identicon&r=PG&f=1", "display_name": "NewComer", "link": "https://stackoverflow.com/users/10184198/newcomer"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1543452300, "post_id": 53529251, "comment_id": 93928948, "body": "@JohnBollinger yes, your suggestion makes sense. Thank you! But as I mentioned, the input is generated by a hardware meter. And I cannot find any settings where I could set this in it. So I&#39;d have to stick with floating points at least for the time being."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1543457991, "post_id": 53529251, "comment_id": 93930131, "body": "@NewComer Research <i>reverse bytes</i> as <a href=\"https://stackoverflow.com/questions/53529251/interpreting-binary-data-as-float?noredirect=1#comment93927332_53529251\">suggested</a>, not <i>reverse bits</i>."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1543507548, "post_id": 53529251, "comment_id": 93952987, "body": "@NewComer What were your expected results and actual results when using <code>&quot;%e&quot;</code> and <code>&quot;%a&quot;</code>?"}], "owner": {"reputation": 11, "user_id": 10184198, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e61fea6cace8909369190f5b2c3c27ec?s=128&d=identicon&r=PG&f=1", "display_name": "NewComer", "link": "https://stackoverflow.com/users/10184198/newcomer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 68, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1543445189, "creation_date": 1543445189, "question_id": 53529251, "link": "https://stackoverflow.com/questions/53529251/interpreting-binary-data-as-float", "title": "Interpreting binary data as float", "body": "<p>I have an external hardware meter that would send measured voltage values through a TCP connection as a floating point value. I am writing a C code to capture this data. The first code I wrote is as follows:</p>\n\n<pre><code>#include &lt;netinet/in.h&gt; \n#include &lt;string.h&gt; \n#include &lt;arpa/inet.h&gt;\n#include &lt;unistd.h&gt;\n\n#define PORT 5843 \n\n\nint main(int argc, char const *argv[]){ \n\nstruct sockaddr_in address; \nint sock = 0;\nint valread; \n\nstruct sockaddr_in serv_addr; \n    //data_points* data = malloc(sizeof(data_points)); \nif ((sock = socket(AF_INET, SOCK_STREAM, 0)) &lt; 0) { \n    printf(\"\\n Socket creation error \\n\"); \n    return -1; \n} \n\nmemset(&amp;serv_addr, '0', sizeof(serv_addr)); \n\nserv_addr.sin_family = AF_INET; \nserv_addr.sin_port = htons(PORT); \n\nif(inet_pton(AF_INET, \"130.127.88.141\", &amp;serv_addr.sin_addr)&lt;=0){ \n    printf(\"\\nInvalid address/ Address not supported \\n\"); \n    return -1; \n} \n\nif (connect(sock, (struct sockaddr *)&amp;serv_addr, sizeof(serv_addr)) &lt; 0){ \n    printf(\"\\nConnection Failed \\n\"); \n    return -1; \n} \n\nfloat data;\nvalread = read( sock , (void*) &amp;data, sizeof(float));\nprintf(\"value: %f\\n\", data);\n\nreturn 0; \n}\n</code></pre>\n\n<p>This code is an almost copy of <a href=\"https://www.geeksforgeeks.org/socket-programming-cc/\" rel=\"nofollow noreferrer\">this geek-to-geek</a> code. But when I run this code I get a value as follows:</p>\n\n<pre><code> ./client \n value: -0.000000\n</code></pre>\n\n<p>Which is an unacceptable value. So to test the value I get, I modified the data receiving part as follows:</p>\n\n<pre><code>unsigned char data[4];\nvalread = read( sock , (void*) data, sizeof(float)); \nprintf(\"%d, %d, %d, %d\\n\", data[0], data[1], data[2], data[3]);\n</code></pre>\n\n<p>Which prints:</p>\n\n<pre><code>./client \n65, 49, 110, 152\n</code></pre>\n\n<p>This I converted into a float value manually as follows:</p>\n\n<pre><code> 65  = 01000001\n 49  = 00110001\n 110 = 01101110\n 152 = 10011000\n</code></pre>\n\n<p>concatenating them together gives:</p>\n\n<pre><code>01000001001100010110111010011000\n</code></pre>\n\n<p>which, when interpreted as a IEEE 754 float gives 11.0895 which is the actual value the meter sends. \nWhy doesn't my initial code give this value? How do I convert it? Any help would be appreciated. </p>\n"}, {"tags": ["c", "arrays", "struct"], "comments": [{"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1543445269, "post_id": 53529220, "comment_id": 93927263, "body": "In ReadPol you need a test that order &gt; 0 and order &lt; N_MAX."}], "answers": [{"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 2, "last_activity_date": 1543445203, "creation_date": 1543445203, "answer_id": 53529253, "question_id": 53529220, "link": "https://stackoverflow.com/questions/53529220/how-to-set-all-0s-into-an-array-declared-through-structure-c/53529253#53529253", "title": "How to set all 0s into an array declared through structure (C)?", "body": "<p>The syntax for initializing a struct is similar to how an array is initialized.  You specify the initializers in order, putting braces around any nested initializers:</p>\n\n<pre><code>Pol p1 = { { 0 }, 0 };\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 407, "user_id": 2235468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3811eb9dbd96a4078c61f641545de1a1?s=128&d=identicon&r=PG", "display_name": "Roel Balink", "link": "https://stackoverflow.com/users/2235468/roel-balink"}, "edited": false, "score": 0, "creation_date": 1543489089, "post_id": 53529259, "comment_id": 93942320, "body": "Just wondering, why is this downvoted? Is this bad practice to do?"}], "tags": [], "owner": {"reputation": 871, "user_id": 8357969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d947836b34ed6238d065fd26bf75662?s=128&d=identicon&r=PG&f=1", "display_name": "fstop_22", "link": "https://stackoverflow.com/users/8357969/fstop-22"}, "is_accepted": false, "score": -1, "last_activity_date": 1543445730, "last_edit_date": 1543445730, "creation_date": 1543445235, "answer_id": 53529259, "question_id": 53529220, "link": "https://stackoverflow.com/questions/53529220/how-to-set-all-0s-into-an-array-declared-through-structure-c/53529259#53529259", "title": "How to set all 0s into an array declared through structure (C)?", "body": "<p>You can initialize each byte of variable with memset. </p>\n\n<pre><code>memset(&amp;p1, 0, sizeof(Pol))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 2, "last_activity_date": 1543458230, "last_edit_date": 1543458230, "creation_date": 1543447385, "answer_id": 53529605, "question_id": 53529220, "link": "https://stackoverflow.com/questions/53529220/how-to-set-all-0s-into-an-array-declared-through-structure-c/53529605#53529605", "title": "How to set all 0s into an array declared through structure (C)?", "body": "<blockquote>\n  <p>... want to set all the elements of the array to 0</p>\n</blockquote>\n\n<p>To initialize (assign at declaration time), various choices.</p>\n\n<pre><code>Pol pol1 = { .order = 0, .coefficients = { 0 } };    // Declare members in desired order\nPol pol2 = { .coefficients = { 0 }, .order = 0 };\nPol pol3 = { .order = 0, .coefficients = { 0.0f } }; // A float constant for clarity\nPol pol4 = { { 0.0f }, 0 };                          // Order matches declaration \nPol pol5 = { 0 };                                    // All set to 0\n</code></pre>\n\n<p>Note that with partial explicit initializers, remaining members/array elements get a 0 value.  (0 for integer types, 0.0 for FP, types, some <em>null pointer</em> for pointer types.)   </p>\n\n<p>In C, there is no partial initialization, all or nothing.</p>\n\n<hr>\n\n<p>To <em>assign</em>, a direct solution is to use a loop.</p>\n\n<pre><code>pol-&gt;order = 0;\nfor(i = 0; i &lt; N_MAX; i++) {\n  pol-&gt;coefficients[i] = 0.0f;\n}\n</code></pre>\n\n<hr>\n\n<p>But why? All code needs is </p>\n\n<pre><code>pol-&gt;order = 0;\npol-&gt;coefficients[0] = 0.0f;\n</code></pre>\n\n<p>The point of having a <code>.order</code> member is to scale the work to the used size of the array as well done in <code>readPol(Pol* pol)</code> and <code>println(int n)</code>. Not spend time assigning unused array members.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user10719579"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1543458230, "creation_date": 1543445032, "question_id": 53529220, "link": "https://stackoverflow.com/questions/53529220/how-to-set-all-0s-into-an-array-declared-through-structure-c", "title": "How to set all 0s into an array declared through structure (C)?", "body": "<p>while I was practicing with C programming I found a problem about arrays with structs.\nIn particular, I'm going to make a program to operate with different polynomials; so I declared a struct \"Pol\" which contains the variable \"order\" and the array \"coefficients\".\nThen I'm going to make soe operations with polynomials (for example the sum between two of them).\nThe problem is about how to declare the array \"coefficients\" in the structure, because when I want to sum two polynomials I want to set all the elements of the array to 0 (to solve the problem about the sum of two polynomials with differents orders).\nI know how to set 0s into an array declared in main function (setting a single value to 0, and then all the others are automatically set to 0).\nBut how can I do the same with the structure?</p>\n\n<p>Thank you in advance to all people who are going to help me.</p>\n\n<p>I public the code (not finished) below:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\n\n#define N_MAX 100\n\ntypedef struct\n{\n  float coefficients[N_MAX];\n  int order;\n} Pol;\n\nvoid println(int n);\nvoid readPol(Pol* pol);\n\nint main(int argc, char const *argv[])\n{\n  Pol p1, p2, pS;\n\n  readPol(&amp;p1);\n  return 0;\n}\n\nvoid readPol(Pol* pol)\n{\n  printf(\"Polynomial order: \");\n  scanf(\"%d\", &amp;pol-&gt;order);\n  println(1);\n\n  for(int i = pol-&gt;order; i &gt;= 0; i--)\n    {\n      printf(\"Coefficient of x^[%d]: \", i);\n      scanf(\"%f\", &amp;pol-&gt;coefficients[i]);\n    }\n}\n\nvoid println(int n)\n{\n  for(; n &gt; 0; n--)\n    printf(\"\\n\");\n}\n</code></pre>\n"}, {"tags": ["c", "segmentation-fault"], "comments": [{"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 3, "creation_date": 1543445050, "post_id": 53529199, "comment_id": 93927198, "body": "doesnt sound like a &#39;C Dummy&#39; project at all."}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1543445139, "post_id": 53529199, "comment_id": 93927226, "body": "<a href=\"https://stackoverflow.com/questions/2663456/how-to-write-a-signal-handler-to-catch-sigsegv\" title=\"how to write a signal handler to catch sigsegv\">stackoverflow.com/questions/2663456/&hellip;</a>"}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 1, "creation_date": 1543445261, "post_id": 53529199, "comment_id": 93927259, "body": "the siginfo_t passed to the handler has a ton of info in it <a href=\"http://man7.org/linux/man-pages/man2/sigaction.2.html\" rel=\"nofollow noreferrer\">man7.org/linux/man-pages/man2/sigaction.2.html</a>"}, {"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1543445600, "post_id": 53529199, "comment_id": 93927359, "body": "If your SIGSEGV handler returns, you enter the world of undefined behavior..."}], "answers": [{"comments": [{"owner": {"reputation": 73, "user_id": 9519075, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-4oPeA2qpSD4/AAAAAAAAAAI/AAAAAAAAAFE/yxLNj2ot3uU/photo.jpg?sz=128", "display_name": "Zirui Bai", "link": "https://stackoverflow.com/users/9519075/zirui-bai"}, "edited": false, "score": 0, "creation_date": 1543447382, "post_id": 53529285, "comment_id": 93927779, "body": "Hello, I cannot find si_addr in my *info structure, there are only _sifields, si_code, si_errno, and si_signo."}, {"owner": {"reputation": 73, "user_id": 9519075, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-4oPeA2qpSD4/AAAAAAAAAAI/AAAAAAAAAFE/yxLNj2ot3uU/photo.jpg?sz=128", "display_name": "Zirui Bai", "link": "https://stackoverflow.com/users/9519075/zirui-bai"}, "edited": false, "score": 0, "creation_date": 1543447623, "post_id": 53529285, "comment_id": 93927830, "body": "Hello, I found the si_addr under _sifields-&gt;_sigfault-&gt;si_addr."}, {"owner": {"reputation": 73, "user_id": 9519075, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-4oPeA2qpSD4/AAAAAAAAAAI/AAAAAAAAAFE/yxLNj2ot3uU/photo.jpg?sz=128", "display_name": "Zirui Bai", "link": "https://stackoverflow.com/users/9519075/zirui-bai"}, "edited": false, "score": 0, "creation_date": 1543448659, "post_id": 53529285, "comment_id": 93928132, "body": "Hello, now I am in another trouble: when I try to compile my handler prototype says &quot;unknown type name \u2018siginfo_t\u2019&quot;. Also, when I try to assign my handler function like this:       &quot;act.__sigaction_handler.sa_sigaction = handler_function;&quot; I got the error:  &quot;\u2018union &lt;anonymous&gt;\u2019 has no member named \u2018__sigaction_handler\u2019&quot;  Is there anyway to solve this? Thanks!"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "reply_to_user": {"reputation": 73, "user_id": 9519075, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-4oPeA2qpSD4/AAAAAAAAAAI/AAAAAAAAAFE/yxLNj2ot3uU/photo.jpg?sz=128", "display_name": "Zirui Bai", "link": "https://stackoverflow.com/users/9519075/zirui-bai"}, "edited": false, "score": 0, "creation_date": 1543448693, "post_id": 53529285, "comment_id": 93928137, "body": "@ZiruiBai 1) What OS are you on? 2) What happens when you try my code?"}, {"owner": {"reputation": 73, "user_id": 9519075, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-4oPeA2qpSD4/AAAAAAAAAAI/AAAAAAAAAFE/yxLNj2ot3uU/photo.jpg?sz=128", "display_name": "Zirui Bai", "link": "https://stackoverflow.com/users/9519075/zirui-bai"}, "edited": false, "score": 0, "creation_date": 1543448868, "post_id": 53529285, "comment_id": 93928184, "body": "1. ubuntu 16.04.               2. your code won&#39;t work on my machine, I have to use act.__sigaction_handler.sa_sigaction to assign handler function and use info-&gt;_sifields._sigfault.si_addr to get fault address."}, {"owner": {"reputation": 73, "user_id": 9519075, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-4oPeA2qpSD4/AAAAAAAAAAI/AAAAAAAAAFE/yxLNj2ot3uU/photo.jpg?sz=128", "display_name": "Zirui Bai", "link": "https://stackoverflow.com/users/9519075/zirui-bai"}, "edited": false, "score": 0, "creation_date": 1543449047, "post_id": 53529285, "comment_id": 93928228, "body": "won&#39;t compile, showing error &quot;unknown type name \u2018siginfo_t\u2019&quot;"}, {"owner": {"reputation": 73, "user_id": 9519075, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-4oPeA2qpSD4/AAAAAAAAAAI/AAAAAAAAAFE/yxLNj2ot3uU/photo.jpg?sz=128", "display_name": "Zirui Bai", "link": "https://stackoverflow.com/users/9519075/zirui-bai"}, "edited": false, "score": 0, "creation_date": 1543449122, "post_id": 53529285, "comment_id": 93928247, "body": "I changed my code as the same with yours now, and this is the only error when compile."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "reply_to_user": {"reputation": 73, "user_id": 9519075, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-4oPeA2qpSD4/AAAAAAAAAAI/AAAAAAAAAFE/yxLNj2ot3uU/photo.jpg?sz=128", "display_name": "Zirui Bai", "link": "https://stackoverflow.com/users/9519075/zirui-bai"}, "edited": false, "score": 0, "creation_date": 1543449157, "post_id": 53529285, "comment_id": 93928257, "body": "@ZiruiBai Can you post your source file and compilation options somewhere?"}, {"owner": {"reputation": 73, "user_id": 9519075, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-4oPeA2qpSD4/AAAAAAAAAAI/AAAAAAAAAFE/yxLNj2ot3uU/photo.jpg?sz=128", "display_name": "Zirui Bai", "link": "https://stackoverflow.com/users/9519075/zirui-bai"}, "edited": false, "score": 0, "creation_date": 1543449364, "post_id": 53529285, "comment_id": 93928305, "body": "Hello: I kind of found the reason. when I put prototype within .c file associated with my code it will compile, but when I put this into .h file associated with my code it won&#39;t work."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "reply_to_user": {"reputation": 73, "user_id": 9519075, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-4oPeA2qpSD4/AAAAAAAAAAI/AAAAAAAAAFE/yxLNj2ot3uU/photo.jpg?sz=128", "display_name": "Zirui Bai", "link": "https://stackoverflow.com/users/9519075/zirui-bai"}, "edited": false, "score": 0, "creation_date": 1543449438, "post_id": 53529285, "comment_id": 93928327, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/184439/discussion-between-melpomene-and-zirui-bai\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "is_accepted": true, "score": 3, "last_activity_date": 1543445706, "last_edit_date": 1543445706, "creation_date": 1543445402, "answer_id": 53529285, "question_id": 53529199, "link": "https://stackoverflow.com/questions/53529199/is-there-a-way-to-return-the-address-which-caused-sigsegv-in-c/53529285#53529285", "title": "Is there a way to return the address which caused SIGSEGV in C?", "body": "<p>At least on Linux the answer is yes.</p>\n\n<p>You use <a href=\"http://man7.org/linux/man-pages/man2/sigaction.2.html\" rel=\"nofollow noreferrer\"><code>sigaction</code></a> to register your signal handler, and you set the <code>SA_SIGINFO</code> flag and set a <code>sa_sigaction</code> handler.</p>\n\n<p>This gives you access to a <code>siginfo_t</code> (second argument to your signal handler), which (among other things) contains a <code>void *si_addr;</code> field that (for <code>SIGSEGV</code>) contains the faulting address.</p>\n\n<pre><code>#define _POSIX_C_SOURCE 199309L\n#include &lt;signal.h&gt;\n\nvoid my_handler(int sig, siginfo_t *info, void *ucontext) {\n    ... info-&gt;si_addr ...\n}\n\n...\nstruct sigaction act = {0};\nact.sa_sigaction = my_handler;\nact.sa_flags = SA_SIGINFO;\nsigaction(SIGSEGV, &amp;act, NULL);\n</code></pre>\n\n<p>See <code>man 2 sigaction</code> for details.</p>\n"}], "owner": {"reputation": 73, "user_id": 9519075, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-4oPeA2qpSD4/AAAAAAAAAAI/AAAAAAAAAFE/yxLNj2ot3uU/photo.jpg?sz=128", "display_name": "Zirui Bai", "link": "https://stackoverflow.com/users/9519075/zirui-bai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 792, "favorite_count": 0, "accepted_answer_id": 53529285, "answer_count": 1, "score": 5, "last_activity_date": 1543446020, "creation_date": 1543444890, "last_edit_date": 1543446020, "question_id": 53529199, "link": "https://stackoverflow.com/questions/53529199/is-there-a-way-to-return-the-address-which-caused-sigsegv-in-c", "title": "Is there a way to return the address which caused SIGSEGV in C?", "body": "<p>I am a C dummy and working on a C project which asked me to write a signal handler to catch SIGSEGV signal and perform some operations.</p>\n\n<p>Basically, the main program will try to access a memory chunk that is neither readable or writable. When the main program access this chunk of memory it will raise a SIGSEGV signal, and in my signal handler function I will catch the signal and use mprotect() to convert that memory chunk into readable &amp; writable. </p>\n\n<p>But I don't know is there any way to get the address which caused SIGSEGV when signal is catched by my signal handler. I cannot do anything if I don't have the actual address which caused SIGSEGV. And I am not allowed to grab address from main into my signal handler.</p>\n\n<p>can someone help me? Thanks!</p>\n"}, {"tags": ["c", "stack", "prefix"], "comments": [{"owner": {"reputation": 2272, "user_id": 3574481, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-jW3nCe2wOlU/AAAAAAAAAAI/AAAAAAAAVu4/a4SSbax7jbo/photo.jpg?sz=128", "display_name": "peeebeee", "link": "https://stackoverflow.com/users/3574481/peeebeee"}, "edited": false, "score": 1, "creation_date": 1543441208, "post_id": 53528479, "comment_id": 93925792, "body": "What data type are you using for your operands? It sounds like you&#39;re over / underflowing a signed 8-bit type."}, {"owner": {"reputation": 735, "user_id": 6106763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb5326862aea0afa1b0c4a8206e53c1e?s=128&d=identicon&r=PG&f=1", "display_name": "contrapants", "link": "https://stackoverflow.com/users/6106763/contrapants"}, "edited": false, "score": 0, "creation_date": 1543441282, "post_id": 53528479, "comment_id": 93925820, "body": "You should post your code, but it sounds like you used an <code>int8_t</code> (or a <code>char</code>) as your data type."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 8885891, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-yCDeB0h7ZaE/AAAAAAAAAAI/AAAAAAAAAQo/VPDAO96Xz7s/photo.jpg?sz=128", "display_name": "i dont know much about algebra", "link": "https://stackoverflow.com/users/8885891/i-dont-know-much-about-algebra"}, "edited": false, "score": 0, "creation_date": 1543442138, "post_id": 53528562, "comment_id": 93926144, "body": "I posted the code, hope it helps! I used int with my stack, and when pushing the number (in the code it&#39;s &#39;broj&#39;)  to the stack, the number is also int."}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1543443450, "post_id": 53528562, "comment_id": 93926622, "body": "Please don&#39;t post answers like this. The first paragraph should be in a comment The second paragraph could be a comment. It could also be an answer but only AFTER op posted the code. Answers are not for guessing."}], "tags": [], "owner": {"reputation": 455, "user_id": 7829467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bc7e2bb834f1b83651d824d57525bb6?s=128&d=identicon&r=PG&f=1", "display_name": "Gold Dragon", "link": "https://stackoverflow.com/users/7829467/gold-dragon"}, "is_accepted": false, "score": 0, "last_activity_date": 1543441353, "creation_date": 1543441353, "answer_id": 53528562, "question_id": 53528479, "link": "https://stackoverflow.com/questions/53528479/code-stops-working-after-pushing-any-number-over-127-on-stack-top/53528562#53528562", "title": "Code stops working after pushing any number over 127 on Stack Top", "body": "<p>The rules say to post a code snippet for good reason: it's hard to identify the issue without seeing the code. In the future, ALWAYS post SOMETHING to look at (and follow the rules for code snippets).</p>\n\n<p>But in this case, even without that, I have a pretty good guess at what is going on: signed overflow of an 8-bit type. Either your stack uses the <code>signed char</code> (or equivalent) data type, or you are casting to such a value somewhere. Possibly the integer parsing you use?</p>\n"}, {"tags": [], "owner": {"reputation": 735, "user_id": 6106763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb5326862aea0afa1b0c4a8206e53c1e?s=128&d=identicon&r=PG&f=1", "display_name": "contrapants", "link": "https://stackoverflow.com/users/6106763/contrapants"}, "is_accepted": true, "score": 2, "last_activity_date": 1543441997, "creation_date": 1543441997, "answer_id": 53528698, "question_id": 53528479, "link": "https://stackoverflow.com/questions/53528479/code-stops-working-after-pushing-any-number-over-127-on-stack-top/53528698#53528698", "title": "Code stops working after pushing any number over 127 on Stack Top", "body": "<p>You may be storing the values as an <code>int</code>, but they are being truncated to <code>char</code> values as you put them in and out of the stack.</p>\n\n<pre><code>void StPush(stack *Sp, char d)\nchar StTop(stack S)\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 8885891, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-yCDeB0h7ZaE/AAAAAAAAAAI/AAAAAAAAAQo/VPDAO96Xz7s/photo.jpg?sz=128", "display_name": "i dont know much about algebra", "link": "https://stackoverflow.com/users/8885891/i-dont-know-much-about-algebra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 53528698, "answer_count": 2, "score": -1, "last_activity_date": 1543441997, "creation_date": 1543440956, "last_edit_date": 1543441748, "question_id": 53528479, "link": "https://stackoverflow.com/questions/53528479/code-stops-working-after-pushing-any-number-over-127-on-stack-top", "title": "Code stops working after pushing any number over 127 on Stack Top", "body": "<p>Program in C!</p>\n\n<p>For my homework I had to make a program that finds the value of arithmetic expression given in prefix, by using ADT Stack. The input is a string, for example '- + 5 12 * 7 3', and the output would be '-4'.</p>\n\n<p>I solved my homework and I thought that everything worked fine. But for some reason, when I push the number on top of the stack and if the number is over or equal to 128, or lower or equal to -128, the number completely changes once pushed on the Stack. For example, if I push 129 on the stack, when I retrieve the number from the top, it has changed into -127.</p>\n\n<p>The program has over 150 lines of code so I don't know how helpful would it be if I posted it here, I'm just curious if somebody has an idea why is this happening. </p>\n\n<p>(Here's a brief idea of my program: input is a string where numbers and operaters are separated with blanks.</p>\n\n<p>The program that evaluates the infix goes like this: start from the char at the end of the string, and go from end to start. If char is number, first find the whole number (until the blank) and then push it on stack(as int, not as char). If char is operater, remove last two numbers from stack and do the operation on them, and then push it back on stack. The last number on stack is the result.</p>\n\n<p>I know this is really vague so if the whole program would help more, I will post it. All the operations are correct, I checked it, the problem specifically arises once I put them on stack. Also, I implemented string using pointers.)</p>\n\n<p>EDIT: Instead of '4' for output, I changed it into '-4'. My bad!</p>\n\n<p>EDIT: The code: (Also, I used int for my data type.)</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n#include&lt;ctype.h&gt;\n\ntypedef struct _element{\n    int c;\n    struct _element *next;\n}element;\n\ntypedef element *stack;\n\nvoid StMakeNull(stack *Sp){\n    *Sp=NULL;\n}\n\nint StEmpty(stack S){\n    if(S==NULL) return 1;\n    else return 0;\n}\n\nvoid StPush(stack *Sp, char d){\n    element *temp;\n    temp=(*Sp);\n    (*Sp)=(element*)malloc(sizeof(element));\n    (*Sp)-&gt;c=d;\n    (*Sp)-&gt;next=temp;\n}\n\nvoid StPop(stack *Sp){\n    if(StEmpty(*Sp)) exit(202);\n    else{\n        element *temp;\n        temp=(*Sp);\n        (*Sp)=(*Sp)-&gt;next;\n        free(temp);\n    }\n}\n\nchar StTop(stack S){\n    if(StEmpty(S)) exit(202);\n    return S-&gt;c;\n}\n\nint Jel_broj(char c){\n    int d=c;\n    if(d&gt;=48 &amp;&amp; d&lt;=57)\n        return 1;\n    return 0;\n}\n\nint Jel_operator(char c){\n    if(c=='+') return 1;\n    else if(c=='-') return 2;\n    else if(c=='*') return 3;\n    else if(c=='/') return 4;\n    else if(c=='^') return 5;\n    return 0;\n}\n\nint pot(int n, int k){\n    int l=1;\n    while(k&gt;0){\n        l*=n;\n        k--;\n    }\n    return l;\n}\n\nvoid izracunaj(char* niz, int n){\n    int broj=0, pomocni, j, nn, b1, b2;\n    stack S;\n    StMakeNull(&amp;S);\n    while(n&gt;=0){\n        if(Jel_broj(niz[n])){\n            broj=0; j=0; nn=n;\n            while(Jel_broj(niz[nn])){\n                j++;\n                nn--;\n            }\n            nn=j;\n            while(Jel_broj(niz[n-j+1])){\n                pomocni=niz[n-j+1];\n                broj=broj*10+(pomocni-'0');\n                j--;\n            }\n            StPush(&amp;S, broj);\n            n=n-nn+1;\n        }\n        else if(Jel_operator(niz[n])){\n            if(Jel_operator(niz[n])==1){\n                b1=StTop(S);\n                StPop(&amp;S);\n                b2=StTop(S);\n                StPop(&amp;S);\n                StPush(&amp;S, b1+b2);\n            }\n            else if(Jel_operator(niz[n])==2){\n                b1=StTop(S);\n                StPop(&amp;S);\n                b2=StTop(S);\n                StPop(&amp;S);\n                StPush(&amp;S, b1-b2);\n            }\n            else if(Jel_operator(niz[n])==3){\n                b1=StTop(S);\n                StPop(&amp;S);\n                b2=StTop(S);\n                StPop(&amp;S);\n                StPush(&amp;S, b1*b2);\n            }\n            else if(Jel_operator(niz[n])==4){\n                b1=StTop(S);\n                StPop(&amp;S);\n                b2=StTop(S);\n                StPop(&amp;S);\n                StPush(&amp;S, b1/b2);\n            }\n            else if(Jel_operator(niz[n])==5){\n                b1=StTop(S);\n                StPop(&amp;S);\n                b2=StTop(S);\n                StPop(&amp;S);\n                StPush(&amp;S, pot(b1,b2));\n            }\n        }\n        n--;\n    }\n    printf(\"%d\", StTop(S));\n}\n\nint main(){\n    char *niz=NULL;\n    int n=0;\n    char c;\n    while(1){\n        scanf(\"%c\", &amp;c);\n        if(c=='\\n'){\n            niz=(char*)realloc(niz, (++n)*sizeof(char));\n            niz[n-1]='\\0';\n            break;\n        }\n        niz=(char*)realloc(niz, (++n)*sizeof(char));\n        niz[n-1]=c;\n    }\n    izracunaj(niz,n-2);\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "linux", "ssl"], "comments": [{"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1543454407, "post_id": 53528388, "comment_id": 93929407, "body": "Please show the relevant code. Also see <a href=\"http://stackoverflow.com/help/mcve\">How to create a Minimal, Complete, and Verifiable example</a>."}], "owner": {"reputation": 1, "user_id": 10719322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15197cc26b041923698457ac80a7e364?s=128&d=identicon&r=PG&f=1", "display_name": "user10719322", "link": "https://stackoverflow.com/users/10719322/user10719322"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1500, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1543441451, "creation_date": 1543440467, "last_edit_date": 1543441451, "question_id": 53528388, "link": "https://stackoverflow.com/questions/53528388/error14089086ssl-routinesssl3-get-client-certificatecertificate-verify-fail", "title": "error:14089086:SSL routines:ssl3_get_client_certificate:certificate verify fail", "body": "<p>I have a basic ssl server and client.\nBoth server and client use self signed certificates however client cert does not have a CA where server cert includes:</p>\n\n<p>X509v# Basic Constraints:\nCA:TRUE</p>\n\n<p>Now, client connects successfully the first time server starts.</p>\n\n<p>If I stop the client, regenerate the certificate and connect again, server gives\n<strong>SSL_ERROR_SSL with error 336105606\nas \nerror:14089086:SSL routines:ssl3_get_client_certificate:certificate verify fail</strong>.</p>\n\n<p>I am using below to verify client cert:</p>\n\n<ol>\n<li><p>SSL_CTX_load_verify_locations(server.ctx, \"/certpath/client.crt\", NULL ) </p>\n\n<ul>\n<li>client cert location at server whenever client regenerates the client cert and send over</li>\n</ul></li>\n<li>SSL_CTX_set_client_CA_list(server.ctx, SSL_load_client_CA_file(\"/certpath/client.crt\")\n\n<ul>\n<li>CA from client cert location at server whenever client regenerates the client cert and send over</li>\n</ul></li>\n<li>SSL_CTX_set_verify(server.ctx, SSL_VERIFY_PEER|SSL_VERIFY_FAIL_IF_NO_PEER_CERT, NULL );</li>\n<li>SSL_CTX_set_verify_depth(server.ctx, 0);</li>\n</ol>\n"}, {"tags": ["c", "xcode"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1543441329, "post_id": 53528332, "comment_id": 93925841, "body": "You don&#39;t check whether the member <code>next</code> is <code>NULL</code> (which I suppose the last element of a linked list could be) before dereferencing it. Also you have made it hard to read the poorly formatted code, but I notice in function <code>swap</code> you have a memory leak. Why do you need dynamic memory for <code>temp</code> when you could use a local <code>struct</code>?"}, {"owner": {"reputation": 13, "user_id": 10719376, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-8gmEC0xWX3s/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-gkwjJ3IEUZ6grfW_vXzaA62uH2_g/mo/photo.jpg?sz=128", "display_name": "James Harrison", "link": "https://stackoverflow.com/users/10719376/james-harrison"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1543448863, "post_id": 53528332, "comment_id": 93928183, "body": "This is the first time I have taken a coding class and the first time posting on stack overflow, I&#39;m sorry if the code is poorly formatted. I honetly don&#39;t know how I would implement a local struct. For my future refence how would I more properlly format my code? Also the spacing is weird in my code becuase I copied and pasted it onto here, maybe that is why."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1543516465, "post_id": 53528332, "comment_id": 93957583, "body": "In function <code>swap</code> you could define the local variable <code>card temp;</code> and then <code>temp.value = temp1-&gt;value;</code> etc. But in function <code>addCard</code> you still need to allocate memory for the new node because a local variable goes out of scope when the function returns and does not persist."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1543516547, "post_id": 53528332, "comment_id": 93957616, "body": ". . . as for code formatting, the compiler doesn&#39;t care, but code is more readable (by its author too) if consistent whitespace and indentation are used."}], "answers": [{"comments": [{"owner": {"reputation": 1149, "user_id": 2472827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t5rYY.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/2472827/neil"}, "edited": false, "score": 0, "creation_date": 1543441491, "post_id": 53528457, "comment_id": 93925903, "body": "You might want to use an <code>#include &lt;assert.h&gt; . . . assert(i != j);</code> if you believe this cannot happen; debug mode in <code>xCode</code> is pretty painless, I find."}, {"owner": {"reputation": 13, "user_id": 10719376, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-8gmEC0xWX3s/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-gkwjJ3IEUZ6grfW_vXzaA62uH2_g/mo/photo.jpg?sz=128", "display_name": "James Harrison", "link": "https://stackoverflow.com/users/10719376/james-harrison"}, "edited": false, "score": 0, "creation_date": 1543448253, "post_id": 53528457, "comment_id": 93928020, "body": "I hadn&#39;t thought of that, if they were both pointing to the same destination would it cuase that problem? Could I convert I and J into temp variables in the swap function and then have an if statement that did something like if(i == j) { j = j+1;}"}, {"owner": {"reputation": 13, "user_id": 10719376, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-8gmEC0xWX3s/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-gkwjJ3IEUZ6grfW_vXzaA62uH2_g/mo/photo.jpg?sz=128", "display_name": "James Harrison", "link": "https://stackoverflow.com/users/10719376/james-harrison"}, "edited": false, "score": 0, "creation_date": 1543448517, "post_id": 53528457, "comment_id": 93928094, "body": "I made it so I and J can&#39;t be the same, and it fixed it. Thank you so much. Is there any way that you could explain why it breaks if they are the same? I&#39;m having a little bit of a hard time in figuring it out."}, {"owner": {"reputation": 32686, "user_id": 10396, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ddbfebb47432f6599da361df6a135c7c?s=128&d=identicon&r=PG", "display_name": "AShelly", "link": "https://stackoverflow.com/users/10396/ashelly"}, "edited": false, "score": 0, "creation_date": 1543450763, "post_id": 53528457, "comment_id": 93928594, "body": "The exact answer is because the standard says they shouldn&#39;t be the same: <code>The strcpy() function shall copy the string pointed to by s2 (including the terminating null byte) into the array pointed to by s1. If copying takes place between objects that overlap, the behavior is undefined.</code> .   The practical reason is because libraries are free to implement strcpy any way they want. There&#39;s no guarantee that it won&#39;t modify part of the destination before it is read."}], "tags": [], "owner": {"reputation": 32686, "user_id": 10396, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ddbfebb47432f6599da361df6a135c7c?s=128&d=identicon&r=PG", "display_name": "AShelly", "link": "https://stackoverflow.com/users/10396/ashelly"}, "is_accepted": true, "score": 2, "last_activity_date": 1543440828, "creation_date": 1543440828, "answer_id": 53528457, "question_id": 53528332, "link": "https://stackoverflow.com/questions/53528332/c-code-compiler-xcode-detected-source-and-destination-buffer-overlap/53528457#53528457", "title": "C code, compiler Xcode, detected source and destination buffer overlap", "body": "<p>You have an error message saying \"detected source and destination buffer overlap\", near a string copy function, which copies data from a source to a destination...</p>\n\n<p>Are there any instances of <code>strcpy</code> where the source and dest might point to the same memory?</p>\n\n<p>I see these two lines:</p>\n\n<pre><code>card *temp1 = pt, *temp2 = pt;  //creates temperaries that start from the head left\n//advance `temp1` `i` times, and `temp2` `j` times\n... \nstrcpy(temp1-&gt;suit, temp2-&gt;suit);\n</code></pre>\n\n<p>What happens when <code>i</code> and <code>j</code> are the same value?</p>\n"}], "owner": {"reputation": 13, "user_id": 10719376, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-8gmEC0xWX3s/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-gkwjJ3IEUZ6grfW_vXzaA62uH2_g/mo/photo.jpg?sz=128", "display_name": "James Harrison", "link": "https://stackoverflow.com/users/10719376/james-harrison"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 201, "favorite_count": 0, "accepted_answer_id": 53528457, "answer_count": 1, "score": 0, "last_activity_date": 1543440828, "creation_date": 1543440187, "question_id": 53528332, "link": "https://stackoverflow.com/questions/53528332/c-code-compiler-xcode-detected-source-and-destination-buffer-overlap", "title": "C code, compiler Xcode, detected source and destination buffer overlap", "body": "<p>I'm doing a project for school in which I have to create a program that plays go fish. In which a deck of cards is in a doubly linked list. I read the cards from a file in the function Addcard. I have a function to print the cards and a function that is supposed to shuffle the cards. I have ot use the parameters of the struct to implement the cards. I sometimes see the error \"detected source and destination buffer overlap\" when I run the shuffle function, sometimes not. When the error comes up it says Thread 1: signal SIGABRT next to a string copy function. I believe it has something to do with the buffer size of some kind of allocated memory being too small, but I don't really know how to fix it. Any help would be more then appreciated. Here is an excerpt of the code I have written.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;math.h&gt;\n#include &lt;time.h&gt;\n\ntypedef struct card_s{\nchar suit[7];\nint value;\nstruct card_s *next, *previous;\n}card;\n\nint rand_gen(int count){\n    double frac;\n    frac = (double)rand()/((double)RAND_MAX+1);\n    return floor(count * frac); //random number in [0, count]\n}\n\n\n\nvoid addCard(card *p, card **hl, card **hr, FILE *inp){\n\ncard *temp; // pointer to a node_t\ntemp = (card *)malloc(sizeof (card)); // new node creation\n\n       fscanf(inp, \"%d\", &amp;temp-&gt;value);\nfscanf(inp, \"%s\", temp-&gt;suit);\n\n\n                    if (*hl == NULL){ // if left head is null, i.e., list is empty\n                        temp-&gt;previous = NULL;\n                        temp-&gt;next = NULL;\n                        *hl = temp;\n                        *hr = temp;\n                    }\n                    else if (p-&gt;next == NULL){ // if adding at the end of list\n                          temp-&gt;previous = p;\n                        temp-&gt;next = NULL;\n                        p-&gt;next = temp;\n                        *hr = temp;\n                    }\n                    else{     // if adding to the middle of the list\n                        temp-&gt;next = p-&gt; next;\n                        temp-&gt;previous = p;\n                        p-&gt;next = temp;\n                        temp-&gt;next-&gt;previous = temp;\n                    }\n                    }\n\nvoid Print(card **headl)  { //this function prints from left to right only\n    card *temp;\n    temp = (*headl);\n    while(temp != NULL) {\n        printf(\"|\");\n        printf(\"%d\", temp-&gt;value);\n        if(strcmp(temp-&gt;suit,\"hea\")==0) {\n            printf(\"\u2665\");\n        }\n        if(strcmp(temp-&gt;suit,\"clu\")==0) {\n            printf(\"\u2663\");\n        }\n        if(strcmp(temp-&gt;suit,\"spa\")==0) {\n            printf(\"\u2660\");\n        }\n        if(strcmp(temp-&gt;suit,\"dia\")==0) {\n            printf(\"\u2666\");\n        }\n        printf(\"|\");\n        //printf(\"%s \", temp-&gt;suit);\n        temp = temp-&gt;next;\n    }\n}\nvoid Print1(card **headl)  { //this function prints from left to right only\ncard *temp;\ntemp = (*headl);\nwhile(temp != NULL) {\n    for(int i = 0; i &lt; 13; i++) {\n    printf(\"|\");\n        if(temp-&gt;value == 11){\n           printf(\"J\");\n        }\n        else if(temp-&gt;value == 12) {\n            printf(\"Q\");\n        }\n        else if(temp-&gt;value == 13) {\n            printf(\"K\");\n        }\n        else if(temp-&gt;value == 14) {\n            printf(\"A\");\n        }\n        else {\n            printf(\"%d\", temp-&gt;value);\n        }\n\n    if(strcmp(temp-&gt;suit,\"h\")==0) {\n        printf(\"\u2665\");\n    }\n    if(strcmp(temp-&gt;suit,\"c\")==0) {\n        printf(\"\u2663\");\n    }\n    if(strcmp(temp-&gt;suit,\"s\")==0) {\n        printf(\"\u2660\");\n    }\n    if(strcmp(temp-&gt;suit,\"d\")==0) {\n        printf(\"\u2666\");\n    }\n    printf(\"|\");\n\n    //printf(\"%s \", temp-&gt;suit);\n    temp = temp-&gt;next;\n    }\n    printf(\"\\n\");\n}\n}\n\nvoid swap(card *pt, int i, int j) {\n\ncard *temp;\ntemp = (card *)malloc(sizeof(card));\ncard *temp1 = pt, *temp2 = pt;  //creates temperaries that start from the head left\n\nfor(int x = 0; x &lt; i; x++) { //counts the number of nodes until i\n    temp1 = temp1-&gt;next;\n}\n\nfor(int x = 0; x &lt; j; x++) { //counts the number of nodes until j\n    temp2 = temp2-&gt;next;\n}\ntemp-&gt;value = temp1-&gt;value;  //swaps the information not the nodes\nstrcpy(temp-&gt;suit,temp1-&gt;suit);\ntemp1-&gt;value = temp2-&gt;value;\nstrcpy(temp1-&gt;suit, temp2-&gt;suit);\ntemp2-&gt;value = temp-&gt;value;\nstrcpy(temp2-&gt;suit, temp-&gt;suit);\n\n}\n\n\n\n\nint main(void)  {\nFILE *inp = NULL;\ninp = fopen(\"cards.txt\", \"r\");\nsrand((int)time(NULL));\ncard *headl = NULL, *headr = NULL;\n\nfor(int i = 0; i &lt; 52; i++) {\n    addCard(headr, &amp;headl, &amp;headr, inp);\n}\n\nif(inp == NULL) {\n    printf(\"No file found\");\n    return -1;\n}\n\nprintIntro();\n\nprintf(\"\\n\");\n\nPrint1(&amp;headl);\n\nprintf(\"\\n\");\nprintf(\"\\n\");\n\n\nfor(int i = 0; i &lt;= 45; i++) {  //does the swap function swap number times\n        swap(headl, rand_gen(52), rand_gen(52));\n       }\n\nPrint1(&amp;headl);\n\n\nreturn(0);\n}\n</code></pre>\n"}, {"tags": ["c", "segmentation-fault"], "comments": [{"owner": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "edited": false, "score": 0, "creation_date": 1543439747, "post_id": 53528184, "comment_id": 93925189, "body": "Please provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 735, "user_id": 6106763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb5326862aea0afa1b0c4a8206e53c1e?s=128&d=identicon&r=PG&f=1", "display_name": "contrapants", "link": "https://stackoverflow.com/users/6106763/contrapants"}, "edited": false, "score": 1, "creation_date": 1543439770, "post_id": 53528184, "comment_id": 93925198, "body": "What do you mean by <code>some_fixed_address</code>? Is this for an embedded system?"}, {"owner": {"reputation": 720, "user_id": 10696884, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-TZLhm3qAv5U/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-gTJ8AUH3mkzlYyEQgF0K4AqDVXLw/mo/photo.jpg?sz=128", "display_name": "Thomas Lang", "link": "https://stackoverflow.com/users/10696884/thomas-lang"}, "edited": false, "score": 6, "creation_date": 1543439922, "post_id": 53528184, "comment_id": 93925259, "body": "If <code>some_fixed_address</code> is null, then you create a null pointer and try to dereference it, thus the segmentation fault."}, {"owner": {"reputation": 1809, "user_id": 7339171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e618ef1f932f57ce1008799082f8db29?s=128&d=identicon&r=PG&f=1", "display_name": "CoffeeTableEspresso", "link": "https://stackoverflow.com/users/7339171/coffeetableespresso"}, "edited": false, "score": 0, "creation_date": 1543439935, "post_id": 53528184, "comment_id": 93925266, "body": "He said that <code>some_fixed_address</code> stores <code>0</code>."}, {"owner": {"reputation": 1809, "user_id": 7339171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e618ef1f932f57ce1008799082f8db29?s=128&d=identicon&r=PG&f=1", "display_name": "CoffeeTableEspresso", "link": "https://stackoverflow.com/users/7339171/coffeetableespresso"}, "edited": false, "score": 0, "creation_date": 1543439957, "post_id": 53528184, "comment_id": 93925274, "body": "I think he has provided enough information to answer correctly"}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 1, "creation_date": 1543440806, "post_id": 53528184, "comment_id": 93925623, "body": "It is highly probably that the error is not in the code you provided. More context to this code and a MCVE would be relevant. This is a good opportunity to learn on how to use a debugger and step through your code."}, {"owner": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1543441889, "post_id": 53528184, "comment_id": 93926041, "body": "@KamilCuk Well, OP&#39;s snippet (given what&#39;s stated in the question) looks a lot like <code>void *p = 0; if (!p) *(int *)p = 42;</code>. That&#39;s enough to spot an error IMHO, but yes, an MCVE is always needed."}, {"owner": {"reputation": 735, "user_id": 6106763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb5326862aea0afa1b0c4a8206e53c1e?s=128&d=identicon&r=PG&f=1", "display_name": "contrapants", "link": "https://stackoverflow.com/users/6106763/contrapants"}, "edited": false, "score": 0, "creation_date": 1543442279, "post_id": 53528184, "comment_id": 93926204, "body": "Why are you casting <code>some_fixed_address</code> to an <code>unsigned long *</code>, then assigning that to a <code>void *</code>, then casting that again to an <code>unsigned long *</code>?"}, {"owner": {"reputation": 79, "user_id": 10683425, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-dEc7BdYYk8s/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-hYGj7JGhuwzN6uks7VrKEc8gdzwQ/mo/photo.jpg?sz=128", "display_name": "dipankar", "link": "https://stackoverflow.com/users/10683425/dipankar"}, "reply_to_user": {"reputation": 1809, "user_id": 7339171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e618ef1f932f57ce1008799082f8db29?s=128&d=identicon&r=PG&f=1", "display_name": "CoffeeTableEspresso", "link": "https://stackoverflow.com/users/7339171/coffeetableespresso"}, "edited": false, "score": 0, "creation_date": 1543444900, "post_id": 53528184, "comment_id": 93927146, "body": "@CoffeeTableEspresso I have added a MCVE."}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1543450261, "post_id": 53528184, "comment_id": 93928505, "body": "ok now you have clarified. As my answer says, this code is guaranteed to fail. You cannot deference a NULL pointer (0 in most modern CPUs) and your code explicitly (if somewhat indirectly) tries to do that"}], "answers": [{"comments": [{"owner": {"reputation": 44820, "user_id": 4492932, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e8938ef2681650e100bc9f83434ef272?s=128&d=identicon&r=PG", "display_name": "DYZ", "link": "https://stackoverflow.com/users/4492932/dyz"}, "edited": false, "score": 0, "creation_date": 1543439990, "post_id": 53528246, "comment_id": 93925285, "body": "What is <code>bitwise NULL</code> and why do you mention NULL at all? There is no NULL in the OP."}, {"owner": {"reputation": 735, "user_id": 6106763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb5326862aea0afa1b0c4a8206e53c1e?s=128&d=identicon&r=PG&f=1", "display_name": "contrapants", "link": "https://stackoverflow.com/users/6106763/contrapants"}, "edited": false, "score": 0, "creation_date": 1543440234, "post_id": 53528246, "comment_id": 93925399, "body": "<code>if (!curr)</code> is analogous to <code>if (curr == NULL)</code>"}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1543440314, "post_id": 53528246, "comment_id": 93925432, "body": "I do not think <code>some_fixed_address == 0</code>, I think question means <code>*some_fixed_address==0</code> (in OP&#39;s mind)"}, {"owner": {"reputation": 1809, "user_id": 7339171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e618ef1f932f57ce1008799082f8db29?s=128&d=identicon&r=PG&f=1", "display_name": "CoffeeTableEspresso", "link": "https://stackoverflow.com/users/7339171/coffeetableespresso"}, "reply_to_user": {"reputation": 44820, "user_id": 4492932, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e8938ef2681650e100bc9f83434ef272?s=128&d=identicon&r=PG", "display_name": "DYZ", "link": "https://stackoverflow.com/users/4492932/dyz"}, "edited": false, "score": 0, "creation_date": 1543440884, "post_id": 53528246, "comment_id": 93925651, "body": "@DYZ I meant to type &#39;bitwise equal to 0`, meaning that every bit in a NULL pointer is a 0."}, {"owner": {"reputation": 1809, "user_id": 7339171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e618ef1f932f57ce1008799082f8db29?s=128&d=identicon&r=PG&f=1", "display_name": "CoffeeTableEspresso", "link": "https://stackoverflow.com/users/7339171/coffeetableespresso"}, "reply_to_user": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1543440977, "post_id": 53528246, "comment_id": 93925691, "body": "@pm100 rereading, I think you might be right, but it&#39;s very unclear. Hoping that OP can clarify for us so I can update this accordingly."}, {"owner": {"reputation": 79, "user_id": 10683425, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-dEc7BdYYk8s/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-hYGj7JGhuwzN6uks7VrKEc8gdzwQ/mo/photo.jpg?sz=128", "display_name": "dipankar", "link": "https://stackoverflow.com/users/10683425/dipankar"}, "edited": false, "score": 0, "creation_date": 1543444920, "post_id": 53528246, "comment_id": 93927151, "body": "I have clarified my question."}, {"owner": {"reputation": 1809, "user_id": 7339171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e618ef1f932f57ce1008799082f8db29?s=128&d=identicon&r=PG&f=1", "display_name": "CoffeeTableEspresso", "link": "https://stackoverflow.com/users/7339171/coffeetableespresso"}, "reply_to_user": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1543445026, "post_id": 53528246, "comment_id": 93927188, "body": "@pm100 looks like I interpreted the original post correctly."}, {"owner": {"reputation": 1809, "user_id": 7339171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e618ef1f932f57ce1008799082f8db29?s=128&d=identicon&r=PG&f=1", "display_name": "CoffeeTableEspresso", "link": "https://stackoverflow.com/users/7339171/coffeetableespresso"}, "reply_to_user": {"reputation": 79, "user_id": 10683425, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-dEc7BdYYk8s/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-hYGj7JGhuwzN6uks7VrKEc8gdzwQ/mo/photo.jpg?sz=128", "display_name": "dipankar", "link": "https://stackoverflow.com/users/10683425/dipankar"}, "edited": false, "score": 0, "creation_date": 1543445042, "post_id": 53528246, "comment_id": 93927193, "body": "@dipankar looks like I interpreted the original post correctly. This answer should explain everything. Let me know if you have any trouble understanding anything, or except my answer if it solves your problem."}, {"owner": {"reputation": 79, "user_id": 10683425, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-dEc7BdYYk8s/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-hYGj7JGhuwzN6uks7VrKEc8gdzwQ/mo/photo.jpg?sz=128", "display_name": "dipankar", "link": "https://stackoverflow.com/users/10683425/dipankar"}, "edited": false, "score": 0, "creation_date": 1543445436, "post_id": 53528246, "comment_id": 93927312, "body": "@CoffeeTableEspresso But all I am trying to do is to initialize the value of <code>curr</code> pointer to some value <code>a^b</code>. How can modify my code to achieve this?"}, {"owner": {"reputation": 1809, "user_id": 7339171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e618ef1f932f57ce1008799082f8db29?s=128&d=identicon&r=PG&f=1", "display_name": "CoffeeTableEspresso", "link": "https://stackoverflow.com/users/7339171/coffeetableespresso"}, "reply_to_user": {"reputation": 79, "user_id": 10683425, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-dEc7BdYYk8s/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-hYGj7JGhuwzN6uks7VrKEc8gdzwQ/mo/photo.jpg?sz=128", "display_name": "dipankar", "link": "https://stackoverflow.com/users/10683425/dipankar"}, "edited": false, "score": 0, "creation_date": 1543445737, "post_id": 53528246, "comment_id": 93927396, "body": "@dipankar do you want <code>curr</code> to point to a memory location storing <code>a^b</code>? It&#39;s very unclear what you&#39;re trying to do"}], "tags": [], "owner": {"reputation": 1809, "user_id": 7339171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e618ef1f932f57ce1008799082f8db29?s=128&d=identicon&r=PG&f=1", "display_name": "CoffeeTableEspresso", "link": "https://stackoverflow.com/users/7339171/coffeetableespresso"}, "is_accepted": false, "score": 3, "last_activity_date": 1543440845, "last_edit_date": 1543440845, "creation_date": 1543439890, "answer_id": 53528246, "question_id": 53528184, "link": "https://stackoverflow.com/questions/53528184/why-does-this-c-code-throw-a-segmentation-fault/53528246#53528246", "title": "Why does this C code throw a segmentation fault?", "body": "<p>On your machine, <code>NULL</code> is probably bitwise equal to <code>0</code> (although the standard doesn't require this).</p>\n\n<p>So when you convert <code>some_fixed_address</code> to a pointer, you end up with a pointer full of <code>0</code>, which is the <code>NULL</code> pointer.</p>\n\n<p><code>!curr</code> then checks that <code>curr</code> is <code>NULL</code>. You then try to dereference <code>curr</code> in the body of the <code>if</code> statement, which causes a SEGFAULT.</p>\n"}, {"tags": [], "owner": {"reputation": 5091, "user_id": 2077386, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/49bce27bde92d6ee5970ef7259c09bb3?s=128&d=identicon&r=PG", "display_name": "rrauenza", "link": "https://stackoverflow.com/users/2077386/rrauenza"}, "is_accepted": false, "score": 2, "last_activity_date": 1543441142, "creation_date": 1543441142, "answer_id": 53528524, "question_id": 53528184, "link": "https://stackoverflow.com/questions/53528184/why-does-this-c-code-throw-a-segmentation-fault/53528524#53528524", "title": "Why does this C code throw a segmentation fault?", "body": "<p>The only logical explanation given what you have shown us is that <code>some_fixed_address</code> is zero, which is not addressable, hence the segfault.</p>\n\n<p>Your <code>if (!curr) { ... }</code> couldn't execute otherwise -- it <em>only</em> executes if <code>curr</code> is <code>0</code>.</p>\n\n<p>I wonder if you got your <code>if</code> statement's logic backwards.  (Or you haven't provided enough information and your bug lies elsewhere.)</p>\n"}, {"tags": [], "owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "is_accepted": false, "score": 1, "last_activity_date": 1543441804, "creation_date": 1543441804, "answer_id": 53528656, "question_id": 53528184, "link": "https://stackoverflow.com/questions/53528184/why-does-this-c-code-throw-a-segmentation-fault/53528656#53528656", "title": "Why does this C code throw a segmentation fault?", "body": "<p>well this code makes no sense</p>\n\n<pre><code>void *curr = (unsigned long *)some_fixed_address;\nif (!curr) {*(unsigned long *)curr = a^b;} &lt;&lt;&lt; only if curr is null then try to do something with it\n</code></pre>\n\n<p>I think you mean</p>\n\n<pre><code>void *curr = (unsigned long *)some_fixed_address;\nif (curr) {*(unsigned long *)curr = a^b;} &lt;&lt;&lt;&lt; if curr is not null then try to do something\n</code></pre>\n\n<p>However the fact that you were getting the error on that line strongly suggests that some_fixed_address is 0. So the 'corrected' code above will run, but will do nothing.</p>\n"}], "owner": {"reputation": 79, "user_id": 10683425, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-dEc7BdYYk8s/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-hYGj7JGhuwzN6uks7VrKEc8gdzwQ/mo/photo.jpg?sz=128", "display_name": "dipankar", "link": "https://stackoverflow.com/users/10683425/dipankar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 1, "answer_count": 3, "score": -3, "last_activity_date": 1543444850, "creation_date": 1543439634, "last_edit_date": 1543444850, "question_id": 53528184, "link": "https://stackoverflow.com/questions/53528184/why-does-this-c-code-throw-a-segmentation-fault", "title": "Why does this C code throw a segmentation fault?", "body": "<p>I have the following <code>c</code> code </p>\n\n<pre><code>void *curr = (unsigned long *)some_fixed_address;\nif (!curr) {*(unsigned long *)curr = a^b;}\n</code></pre>\n\n<p>where <code>some_fixed_address</code> stores long integer <code>0</code>, and <code>a</code> and <code>b</code> are some predefined integers. When I run this code I get an error</p>\n\n<pre><code>Program received signal SIGSEGV, Segmentation fault.\n</code></pre>\n\n<p>Is there any reason why this might be the case?</p>\n\n<p>Update: </p>\n\n<p>Here is the minimal verifiable example:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main()\n{\n    size_t start = 0;\n    size_t a = 5;\n    size_t b = 100;\n    void *curr = (char *)start;\n    if (!curr) {*(unsigned long *)curr = a^b;}\n    printf(\"%d\", *(int *)curr);\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 2427, "user_id": 4983398, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc9ed33d775a17d6965fd2efbfe4b52?s=128&d=identicon&r=PG", "display_name": "Gardener", "link": "https://stackoverflow.com/users/4983398/gardener"}, "edited": false, "score": 0, "creation_date": 1543439434, "post_id": 53528082, "comment_id": 93925051, "body": "Thank you for posting a question, and for including a main() function.  Please whittle this down to a smaller example that is a <a href=\"https://stackoverflow.com/help/mcve\">Compilable, Minimal, Complete, and Verifiable Example</a>.  Thank you!"}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1543440239, "post_id": 53528082, "comment_id": 93925403, "body": "step through using your debugger"}, {"owner": {"reputation": 374, "user_id": 2723242, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a76ac150167a44573b4b2ea5fdd6b892?s=128&d=identicon&r=PG&f=1", "display_name": "Yarden", "link": "https://stackoverflow.com/users/2723242/yarden"}, "edited": false, "score": 0, "creation_date": 1543440501, "post_id": 53528082, "comment_id": 93925510, "body": "Few general tips, don&#39;t use gotos in your code in unnecessary places, usually it makes the code harder to understand (goto ask can be replaced with continue). Also you use scanf with &quot;%s&quot; to get a string, but you save it in a variable with a type of char (only one character)"}], "answers": [{"tags": [], "owner": {"reputation": 509, "user_id": 3487040, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qS36g.jpg?s=128&g=1", "display_name": "eapetcho", "link": "https://stackoverflow.com/users/3487040/eapetcho"}, "is_accepted": false, "score": -1, "last_activity_date": 1543439864, "creation_date": 1543439864, "answer_id": 53528242, "question_id": 53528082, "link": "https://stackoverflow.com/questions/53528082/for-loop-seems-to-become-infinite/53528242#53528242", "title": "For loop seems to become infinite", "body": "<p>@user1930693. It seems clear that you're wrongly scanning (reading) the user input to decide whether to continue or not. You can change <code>scanf(\"%s\", cont)</code> or <code>scanf(\"&gt;&gt;%s&lt;&lt;\", cont)</code> by <code>scanf(\"%c\", &amp;cont)</code> which properly matches your initial declaration of <code>cont</code> (<code>char cont</code>)</p>\n"}, {"comments": [{"owner": {"reputation": 43, "user_id": 1930693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19b4e7f25db8930d7e6f719fd9befdd?s=128&d=identicon&r=PG", "display_name": "user1930693", "link": "https://stackoverflow.com/users/1930693/user1930693"}, "edited": false, "score": 0, "creation_date": 1543464220, "post_id": 53528381, "comment_id": 93931376, "body": "Thanks, yep, the problem was %c, actually I tried using it From the get go, but the input part was always skipped so I switched to %s. It really weird you have to use &quot; %c&quot; to get it work. Also I removed the goto statement and used continue as instructed. I know how bad the goto statement is, our lecturer insists on using it though. Actually he left a few requirements for the project, one being use a goto statement. I&#39;ll use it elsewhere where it&#39;s less complicated."}], "tags": [], "owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "is_accepted": true, "score": 2, "last_activity_date": 1543440440, "creation_date": 1543440440, "answer_id": 53528381, "question_id": 53528082, "link": "https://stackoverflow.com/questions/53528082/for-loop-seems-to-become-infinite/53528381#53528381", "title": "For loop seems to become infinite", "body": "<pre><code>char cont;\n...\nscanf(\"%s\", &amp;cont);\n</code></pre>\n\n<p><code>%s</code> scanf modifier scanf for an array of characters which get's terminated by a null character. You specified the second argument of <code>scanf</code> function as a pointer to memory only with one single character. I would highly discourage scanning for user input of arbitrarily length using scanf, as it's easy to get stack overflow and out of bound array access, as it happens in your case. <code>scanf</code> just writes to memory at addresses <code>(&amp;cont)+1</code>, <code>(&amp;cont)+2</code> and so on, causing undefined behaviour to happen. That's why <em>always</em> specify the lenght of the string inside the <code>%s</code> scanf modifier. So you can do this:</p>\n\n<pre><code>char cont[512];\nscanf\"%511s\", cont);\n</code></pre>\n\n<p>if your intention is to scan up to 511 (not 512, strings are null terminated, you need one more character for the '\\0', so 511) characters from the user.\nYou can do this:</p>\n\n<pre><code>char cont;\nscanf(\" %c\", &amp;conf);\n</code></pre>\n\n<p>if your intention is to scan for a single character inputted from user ignoring leading white-space character.</p>\n\n<p>It would be good to read about <code>scanf</code> modifiers <code>%s</code> and <code>%c</code>, documentation can be found for example on <a href=\"https://en.cppreference.com/w/c/io/fscanf\" rel=\"nofollow noreferrer\">cppreference</a>. And never type <code>%s</code> in <code>scanf</code>, always <code>%&lt;number&gt;s</code>.</p>\n"}], "owner": {"reputation": 43, "user_id": 1930693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19b4e7f25db8930d7e6f719fd9befdd?s=128&d=identicon&r=PG", "display_name": "user1930693", "link": "https://stackoverflow.com/users/1930693/user1930693"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 53528381, "answer_count": 2, "score": 0, "last_activity_date": 1543440440, "creation_date": 1543439194, "question_id": 53528082, "link": "https://stackoverflow.com/questions/53528082/for-loop-seems-to-become-infinite", "title": "For loop seems to become infinite", "body": "<pre><code>#include &lt;stdio.h&gt;\n\n// DEFINITION FOR THE PRICES. CHANGE/REMOVE if needed. Currently can be used for testing\n#define pepsi 2.00\n#define l_tea 1.50\n\n\n// Menu function prototype for testing\n// TODO: Replace with actual menu fucntion\nvoid menu();\nvoid inquire();\nvoid calculate_price();\nvoid order();\n\nfloat total_price;\nfloat price_per[3];\n\n// Required for the Inquire function. **total_menu** can be moved inside function. Keep variable **choice** as is. DO NOT REMOVE.\n// TODO: Change **total_menu** variable value to ACTUAL value\nint choice[3] = {0,0,0};\nint total_menu = 2; // &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt; CHANGE\n\nint main()\n{\n    inquire();\n    order();\n\n    return 0;\n}\n\nvoid inquire()\n{\n    char cont;\n\n    // Start by giving instructions\n    printf(\"Max 3 drinks. Input in NUMBER.\\nChoose your drink(s):\\n\");\n\n    // Implementation of menu function. Change name as seen fit.\n    menu();\n\n    for (int i = 0; i + 1 &lt;= 3; i++)\n    {\n        // Ask for response\nask:\n        printf(\"\\n\\n &gt;&gt;&gt; \");\n        scanf(\"%d\", &amp;choice[i]);\n\n        // Check if in menu\n        if ((int)choice[i] &gt; total_menu)\n        {\n            printf(\"\\nNot in menu. Please choose again!\");\n            goto ask;\n        }\n        printf(\"%d\", i);\n        // Ask if user wants to continue\n        // Y for Yes, N for No.\n        if (i + 1 &lt; 3)\n        {\n            printf(\"\\nDo you want to continue? (y/n) &gt;&gt; \");\n            scanf(\"%s\", &amp;cont);\n\n            switch (cont)\n            {\n                case 'y':\n                    printf(\"\\nChoose your drink %d: \", i + 2);\n                    break;\n                case 'n':\n                    i = 4;\n                    break;\n                default:\n                    printf(\"\\nChoose your drink %d: \", i + 2);\n            }\n        }\n    }\n\n    // Testing array implementation. Delete before final program\n    for (int i = 0; i + 1 &lt;= 3; i++)\n        printf(\"\\n%d) %d\", i+1, choice[i]);\n}\n\n// Menu definition FOR TESTING. Replace with actual menu function\n// TODO: REPLACE with actual MENU FUNCTION\nvoid menu()\n{\n    printf(\"1) Pepsi \\t RM%.2f\\n\", pepsi);\n    printf(\"2) Lemon Tea \\t RM%.2f\", l_tea);\n}\n\n// Calculate price FOR TESTING. Replace with actual calculate function\n// TODO: REPLACE with actual CALCULATE FUNCTION\nvoid calculate_price()\n{\n    total_price = 0.00;\n\n    for (int i = 0; i &lt;= 2; i++)\n    {\n        switch(choice[i])\n        {\n            // CASE BASED ON MENU\n            case 1:\n                price_per[i] = pepsi;\n                total_price += pepsi;\n                break;\n            case 2:\n                price_per[i] = l_tea;\n                total_price += l_tea;\n                break;\n            default:\n                total_price += 0;\n                break;\n        }\n    }\n\n}\n\nvoid order()\n{\n    char cont;\n\n    calculate_price();\n\n    printf(\"\\n\\nTotal price -&gt; RM%.2f:\\n\", total_price);\n\n    for (int i = 0; i &lt; 3; i++)\n        printf(\"\\tItem %d -&gt; RM%f\\n\", choice[i], price_per[i]);\n\n    printf(\"\\nInsert Money? (y/n)\");\n    scanf(\"&gt;&gt; %s &lt;&lt;\", cont);\n\n    // No more testing needed.....\n}\n</code></pre>\n\n<p>With the above code my for loop in inquire function seems to go into a infinite loop if I type 'y' once. The only way to break away is to type 'n' or exit the program. I've spent more time on this then I would like to confess. I did have a working version of it but I probably meddled with something leading to this.</p>\n\n<p>I need some help please.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 2, "creation_date": 1543438016, "post_id": 53527749, "comment_id": 93924439, "body": "How about returning a value from your function?"}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 5, "creation_date": 1543438161, "post_id": 53527749, "comment_id": 93924524, "body": "Turn on compiler warnings and read them."}, {"owner": {"reputation": 4508, "user_id": 1766544, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d74d9adb2fe5c3bf8fc5d10c504ca155?s=128&d=identicon&r=PG", "display_name": "Kenny Ostrom", "link": "https://stackoverflow.com/users/1766544/kenny-ostrom"}, "edited": false, "score": 3, "creation_date": 1543438215, "post_id": 53527749, "comment_id": 93924550, "body": "You can use iteration (for loop) or you can use recursion to make your code do all the numbers it is supposed to. I think you are trying to do both at the same time."}, {"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1543438556, "post_id": 53527749, "comment_id": 93924688, "body": "<a href=\"https://medium.com/launch-school/recursive-fibonnaci-method-explained-d82215c5498e\" rel=\"nofollow noreferrer\">Recursive Fibonacci Method Explained</a>"}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 8, "creation_date": 1543438948, "post_id": 53527749, "comment_id": 93924856, "body": "@ryyker nonsense. <code>if (a==1 || a==2)</code> does exactly what is naturally expected, it  is true if a is either 1 or 2."}], "answers": [{"comments": [{"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1543501141, "post_id": 53528034, "comment_id": 93949009, "body": "Nice answer, but I believe your statement that <i>Fib(0) is the same as Fib(1)</i> is not necessarily true.  Optionally, the zeroth term can be <code>0</code>.  If user desired to implement algorithm for zeroth term == 0, the fix would be to change the exit criteria to: <code>if (k == 0 || k == 1) return k;</code>. ( <i><a href=\"https://en.wikipedia.org/wiki/Fibonacci_number\" rel=\"nofollow noreferrer\">referring to this site</a></i>. )"}], "tags": [], "owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "is_accepted": false, "score": 2, "last_activity_date": 1543440650, "last_edit_date": 1543440650, "creation_date": 1543438908, "answer_id": 53528034, "question_id": 53527749, "link": "https://stackoverflow.com/questions/53527749/fibonacci-sequence-using-recursion-in-c/53528034#53528034", "title": "Fibonacci sequence using recursion in C", "body": "<p>Fibonacci numbers are often used as an intro into recursion because they are naturally recursive. In fact, implementing them recursively is trivial in any language. On a side note, it is usually not the best way to implement Fibonacci sequence for practical purposes.</p>\n\n<p>By definition, Fib(X) = Fib(X - 1) + Fib(X - 2). This is recursion right there. The only thing which is missing is how we stop the recursion, and we know that Fib(0) is the same as Fib(1) and is 1.</p>\n\n<p>How do we translate this to the C language? Very simple, almost one-to-one mapping!</p>\n\n<pre><code>unsigned int fib(unsigned int k) {\n    // First, check our exit (stop) conditions:\n    if (k == 0 || k == 1) return 1;\n\n    // Now recursive part  \n    return fib(k - 1) + fib(k - 2);\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4116, "user_id": 9039646, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/t6Slz.jpg?s=128&g=1", "display_name": "DINA TAKLIT", "link": "https://stackoverflow.com/users/9039646/dina-taklit"}, "is_accepted": false, "score": 2, "last_activity_date": 1543457460, "last_edit_date": 1543457460, "creation_date": 1543457085, "answer_id": 53530814, "question_id": 53527749, "link": "https://stackoverflow.com/questions/53527749/fibonacci-sequence-using-recursion-in-c/53530814#53530814", "title": "Fibonacci sequence using recursion in C", "body": "<p>Almost every recursion function contains two part : the particular part and then the recursive part.</p>\n\n<p>So to write this function your algorithm will look like this </p>\n\n<pre><code> if (condition_separate_particular_part) \n    {\n        //here the code for part\n    }\nelse \n    {\n         //the recursive part \n    }\n</code></pre>\n\n<p>Now to determine the recursive part you will try to find how to explain the element \"i\" using it's predecessor elements \"i-1\" \"i-2\" ....</p>\n\n<p>Like this it will be easy for you every time.</p>\n\n<p>Note that sometimes it's useful to start to find iterative way to make it easy for your self.</p>\n\n<p>I'm damn sure that you are new so that's why you feel lost a bit. But trust me you will habit soon if you exercise more. Try and you gonna see. ;).</p>\n\n<p>Let me know if you find difficulties to find more exercises/examples. I will try to help you :).</p>\n\n<p><a href=\"https://www.w3resource.com/c-programming-exercises/recursion/index.php\" rel=\"nofollow noreferrer\">Here</a> is and example. Just type Exercise with solution for recursive functions on C and you will find a lot to exercise ;).</p>\n\n<p>Now here both recursive and iterative code </p>\n\n<p>Recursive</p>\n\n<pre><code> int fib(int n){\n      if (n &lt; 2) // here is particular case\n        return n;\n      else  // here is the recursion \n        return fib(n-1) + fib(n-2);\n    }\n\nprintf(\"%d\\n\", fib(10));\n</code></pre>\n\n<p>iterative</p>\n\n<pre><code>int fib(int n) {\n  int first = 0, second = 1;\n\n  int tmp;\n  while (n--) {\n    tmp = first+second;\n    first = second;\n    second = tmp;\n  }\n  return first;\n}\n</code></pre>\n"}], "owner": {"reputation": 69, "user_id": 10656882, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae2721445be8becdf0706104f7f4b9fa?s=128&d=identicon&r=PG&f=1", "display_name": "C Dummy ", "link": "https://stackoverflow.com/users/10656882/c-dummy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 267, "favorite_count": 1, "closed_date": 1543474358, "answer_count": 2, "score": -2, "last_activity_date": 1543457460, "creation_date": 1543437657, "last_edit_date": 1543438465, "question_id": 53527749, "link": "https://stackoverflow.com/questions/53527749/fibonacci-sequence-using-recursion-in-c", "closed_reason": "Not suitable for this site", "title": "Fibonacci sequence using recursion in C", "body": "<p>I am trying (and failing) to print the fibonacci sequence using recursion. I'm sure this is very very basic but I can't seem to get it. \nPlease tell me what I am doing wrong, thanks!</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint fib(int a, int i)\n{\n    int nextnum, num1 = nextnum - 1, num2 = nextnum - 2;\n    for (i = 0; i &gt;= a; i++) {\n        nextnum = num1 + num2;\n        printf(\"%d\", nextnum);\n        i++;\n        fib(a, i);\n    }\n}\n\nint main(void)\n{\n    int a, i = 0;\n\n    printf(\"Enter a number for fib series: \");\n    scanf(\"%d\", &amp;a);\n\n    if (a == 1 || a == 2) {\n        printf(\"Enter higher number please!\\n\");\n    }\n    else {\n        fib(a, i);\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "tcl", "reader"], "comments": [{"owner": {"reputation": 119001, "user_id": 301832, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/965220a70d38e6a29466f44cdb4f804e?s=128&d=identicon&r=PG", "display_name": "Donal Fellows", "link": "https://stackoverflow.com/users/301832/donal-fellows"}, "edited": false, "score": 0, "creation_date": 1543485560, "post_id": 53527470, "comment_id": 93940093, "body": "The types <code>Tcl_Mutex</code> and <code>Tcl_Condition</code> are basically wrappers round <code>mutex_t</code> and <code>cond_t</code> to make them cross-platform (i.e., they&#39;re implemented differently on different platforms but your code doesn&#39;t need to know the details to be portable) and a bit easier to use."}, {"owner": {"reputation": 169, "user_id": 8747958, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213838581739934/picture?type=large", "display_name": "ms_stud", "link": "https://stackoverflow.com/users/8747958/ms-stud"}, "reply_to_user": {"reputation": 119001, "user_id": 301832, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/965220a70d38e6a29466f44cdb4f804e?s=128&d=identicon&r=PG", "display_name": "Donal Fellows", "link": "https://stackoverflow.com/users/301832/donal-fellows"}, "edited": false, "score": 0, "creation_date": 1543489891, "post_id": 53527470, "comment_id": 93942721, "body": "great!  I also thought that they just wrappers but wasn&#39;t quiet sure about this. Thanks!"}], "owner": {"reputation": 169, "user_id": 8747958, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213838581739934/picture?type=large", "display_name": "ms_stud", "link": "https://stackoverflow.com/users/8747958/ms-stud"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1543485445, "creation_date": 1543436348, "last_edit_date": 1543485445, "question_id": 53527470, "link": "https://stackoverflow.com/questions/53527470/implementing-readers-writers-problem-using-tcl-c-api", "title": "Implementing readers - writers problem using Tcl C APi", "body": "<p>I have the following problem (readers writers problem) :</p>\n\n<p>Suppose I created a <code>Tcl_Channel</code> that is controlling the <code>stdout</code> channel , meaning everything that is printed to <code>stdout</code> channel is going through <code>my_output_function</code> that is part of my <code>Tcl_Channel</code>.<br>\nNow suppose I'm putting <code>Tcl_Mutex</code> on this part of the code of this function so this code will be a critical code.\nIn this code I'm copying the buffer that I got on this channel to some buffer queue in my system and then unlocking the <code>Tcl_Mutex</code>.</p>\n\n<p>Now I want to send the queue with the copied buffers to my printers (can be many but for now it is just one) and to print the strings in this queue one by one by those printers.</p>\n\n<p>This problem is similar to readers-writers problem that is very common.<br>\nNow , I'm not so expert in Tcl C Api but I saw there are some Tcl C structs that are probably will help me like <code>Tcl_Condition</code> (instead of using <code>cond_t</code>) and <code>Tcl_Notify</code>.</p>\n\n<p>My questions are :</p>\n\n<ol>\n<li>is there some good reference code or website that I can see that implementing something similar to this?   </li>\n<li>my code is in C and C++ only (I used the Tcl C API only for consistency to the rest of my code and because I redirected the stdout using <code>Tcl_Channel</code>) so is it better to implement it using C/C++ types (using it with <code>mutex_t</code> and <code>cond_t</code> etc.)   </li>\n<li>(I think the most important) how can I make the writer always be on waiting condition for the next input? If I create two threads one for input and the other for output will it work or maybe it is better for the thread that is receiving the input also call the printer function.</li>\n</ol>\n"}, {"tags": ["c", "allegro5"], "comments": [{"owner": {"reputation": 5163, "user_id": 1435461, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/05f6236ee5ec04b27e27f504ebdd3744?s=128&d=identicon&r=PG", "display_name": "rcorre", "link": "https://stackoverflow.com/users/1435461/rcorre"}, "edited": false, "score": 0, "creation_date": 1543496143, "post_id": 53527454, "comment_id": 93946180, "body": "Can you explain what you&#39;re expecting to happen, vs what actually happens? It&#39;s unclear from the small example you provided."}], "answers": [{"tags": [], "owner": {"reputation": 199, "user_id": 4883238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbdd8a03ea95fc24d6fd7087fc215c26?s=128&d=identicon&r=PG&f=1", "display_name": "BugSquasher", "link": "https://stackoverflow.com/users/4883238/bugsquasher"}, "is_accepted": false, "score": 0, "last_activity_date": 1553281809, "last_edit_date": 1553281809, "creation_date": 1553264639, "answer_id": 55301720, "question_id": 53527454, "link": "https://stackoverflow.com/questions/53527454/enabling-mouse-in-allegro5/55301720#55301720", "title": "Enabling mouse in Allegro5", "body": "<p>I can only guess what was wrong, but there is no answer yet, so I will provide some tips about the possible problem. Your thread is titled enabling the mouse in allegro 5, so I can only assume you're not getting mouse input.</p>\n\n<p>1) You need to install the mouse driver before you will get any mouse input :</p>\n\n<p><code>if (!al_install_mouse()) {Fail();}</code></p>\n\n<p>2) The mouse needs to be registered with your event queue.</p>\n\n<p><code>al_register_event_source(event_queue , al_get_mouse_event_source());</code></p>\n\n<p>In a typical GUI, most buttons are only considered 'pressed' if they receive both a mouse button down event over their click area, AND a mouse button up event over the same area. This way you don't get a button press when you click on something else, move the mouse over your button and release it. You also prevent button events from pressing the mouse, moving it off the click area and releasing it.</p>\n"}], "owner": {"reputation": 11, "user_id": 10719138, "user_type": "registered", "profile_image": "https://graph.facebook.com/2388495607844812/picture?type=large", "display_name": "Isadora Queiroz", "link": "https://stackoverflow.com/users/10719138/isadora-queiroz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1553281809, "creation_date": 1543436284, "last_edit_date": 1543436759, "question_id": 53527454, "link": "https://stackoverflow.com/questions/53527454/enabling-mouse-in-allegro5", "title": "Enabling mouse in Allegro5", "body": "<p>I am starting using Allegro in my program in C, but I'm having difficulties creating the buttons. I am using this kind of logic:</p>\n\n<pre><code>if (event.type == ALLEGRO_EVENT_MOUSE_BUTTON_UP)\n{\n      if ((event.mouse.x &gt;= 442) &amp;&amp;(event.mouse.x &lt;= 471) &amp;&amp;(event.mouse.y &gt;= 202) &amp;&amp;(event.mouse.y &lt;= 238))\n            {\n                dig = '1';\n                entr = 1;\n            }\n</code></pre>\n\n<p>But this spaces defined by the axis are non 'clickable'.Somebody here has some tip about the typo of command I should use? </p>\n"}, {"tags": ["c", "linux", "multithreading", "pthreads", "mutex"], "comments": [{"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1543436320, "post_id": 53527328, "comment_id": 93923701, "body": "You should check the thread functions return values for errors."}, {"owner": {"reputation": 302, "user_id": 7385563, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1b0de256c4248ee6476c47ae34b6352?s=128&d=identicon&r=PG&f=1", "display_name": "afsara_ben", "link": "https://stackoverflow.com/users/7385563/afsara-ben"}, "reply_to_user": {"reputation": 61409, "user_id": 485343, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e18b024a122df74275dd2c4486e8a2b4?s=128&d=identicon&r=PG", "display_name": "rustyx", "link": "https://stackoverflow.com/users/485343/rustyx"}, "edited": false, "score": 0, "creation_date": 1543437436, "post_id": 53527328, "comment_id": 93924172, "body": "@rustyx yes, i intentionally did that. If I uncomment it, only the <code>main thread</code> runs, and the <code>thread_function</code> never gets to execute. This is according to the output I got."}], "answers": [{"comments": [{"owner": {"reputation": 302, "user_id": 7385563, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1b0de256c4248ee6476c47ae34b6352?s=128&d=identicon&r=PG&f=1", "display_name": "afsara_ben", "link": "https://stackoverflow.com/users/7385563/afsara-ben"}, "edited": false, "score": 0, "creation_date": 1543440398, "post_id": 53528006, "comment_id": 93925461, "body": "Even if I don&#39;t  use any <code>pthread_mutex</code> statements, the critical region executes within only one thread at a given time, because of the <code>semaphore</code>. Does this mean encapsulating a <code>semaphore</code> within a <code>pthread_mutex</code> is redundant?"}, {"owner": {"reputation": 61409, "user_id": 485343, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e18b024a122df74275dd2c4486e8a2b4?s=128&d=identicon&r=PG", "display_name": "rustyx", "link": "https://stackoverflow.com/users/485343/rustyx"}, "reply_to_user": {"reputation": 302, "user_id": 7385563, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1b0de256c4248ee6476c47ae34b6352?s=128&d=identicon&r=PG&f=1", "display_name": "afsara_ben", "link": "https://stackoverflow.com/users/7385563/afsara-ben"}, "edited": false, "score": 0, "creation_date": 1543440523, "post_id": 53528006, "comment_id": 93925520, "body": "Yes, it is redundant."}], "tags": [], "owner": {"reputation": 61409, "user_id": 485343, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e18b024a122df74275dd2c4486e8a2b4?s=128&d=identicon&r=PG", "display_name": "rustyx", "link": "https://stackoverflow.com/users/485343/rustyx"}, "is_accepted": true, "score": 1, "last_activity_date": 1543439422, "last_edit_date": 1543439422, "creation_date": 1543438781, "answer_id": 53528006, "question_id": 53527328, "link": "https://stackoverflow.com/questions/53527328/why-is-another-thread-say-b-running-when-pthread-mutex-is-being-locked-and-unlo/53528006#53528006", "title": "Why is another thread, say B running when pthread_mutex is being locked and unlocked inside thread A?", "body": "<p>A mutex <em>is</em> a mechanism for implementing critical sections.</p>\n\n<p>Any code between <code>pthread_mutex_lock(x)</code> and <code>pthread_mutex_unlock(x)</code> calls will execute in only one thread at any given time. That's all.</p>\n\n<p>So ...</p>\n\n<blockquote>\n  <p><em>1. Can the other thread concurrently run when mtx is locked?</em></p>\n</blockquote>\n\n<p>If it didn't lock the mtx, then of course.</p>\n\n<blockquote>\n  <p><em>2. What is the use of line 2 since newThread can only unlock mtx when line 4 has been executed, and thus makes line 2 redundant?</em></p>\n</blockquote>\n\n<p>The mutex becomes useless, and you also get <a href=\"https://linux.die.net/man/3/pthread_mutex_unlock\" rel=\"nofollow noreferrer\">UB</a> since you're unlocking it in the thread that didn't lock it:</p>\n\n<blockquote>\n  <p>If the mutex type is <code>PTHREAD_MUTEX_DEFAULT</code>...<br>\n  Attempting to unlock the mutex if it was not locked by the calling thread results in undefined behavior.</p>\n</blockquote>\n\n<p>(By default you get mutex type <code>PTHREAD_MUTEX_DEFAULT</code>)</p>\n\n<blockquote>\n  <p><em>3. What would happen if line 1 is uncommented?</em></p>\n</blockquote>\n\n<p>You get <a href=\"https://stackoverflow.com/questions/12685112/pthreads-thread-starvation-caused-by-quick-re-locking\">thread</a> <a href=\"https://stackoverflow.com/questions/6449732/fair-critical-section-linux\">starvation</a>, since the mutex is locked almost all the time and is immediately re-locked after unlocking (POSIX doesn't guarantee mutex fairness).</p>\n\n<p>A POSIX <a href=\"http://pubs.opengroup.org/onlinepubs/009695399/functions/sem_post.html\" rel=\"nofollow noreferrer\">semaphore</a> does provide fairness in some cases (when you use <code>SCHED_FIFO</code> or <code>SCHED_RR</code> schedulers), but is <a href=\"https://stackoverflow.com/questions/62814/difference-between-binary-semaphore-and-mutex\">heavier</a>.</p>\n\n<p>I don't quite understand what you're trying to achieve (the application looks contrived). In a real application there's probably some logical ordering to the actions that either thread needs to take. So if the semaphore works for you, I'd keep it at that and remove the mutex.</p>\n"}], "owner": {"reputation": 302, "user_id": 7385563, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1b0de256c4248ee6476c47ae34b6352?s=128&d=identicon&r=PG&f=1", "display_name": "afsara_ben", "link": "https://stackoverflow.com/users/7385563/afsara-ben"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 53528006, "answer_count": 1, "score": 0, "last_activity_date": 1543439422, "creation_date": 1543435711, "question_id": 53527328, "link": "https://stackoverflow.com/questions/53527328/why-is-another-thread-say-b-running-when-pthread-mutex-is-being-locked-and-unlo", "title": "Why is another thread, say B running when pthread_mutex is being locked and unlocked inside thread A?", "body": "<p>According to the man pages</p>\n\n<blockquote>\n  <p>pthread_mutex_lock locks the given mutex. If the mutex is currently unlocked, it becomes locked  and  owned  by  the  calling  thread,  and\n         pthread_mutex_lock  returns  immediately.  If the mutex is already locked by another thread, pthread_mutex_lock suspends the calling thread\n         until the mutex is unlocked.</p>\n</blockquote>\n\n<p>What I understood is when <code>line 3</code> executes the <code>main thread</code> has ownership of the <code>mtx</code>. It then performs its critcal region actions and then reaches <code>line 4</code> and unlocks <code>mtx</code>. My question is -</p>\n\n<ol>\n<li>Can the other thread concurrently run when <code>mtx</code> is locked?</li>\n<li>What is the use of <code>line 2</code> since <code>newThread</code> can only unlock <code>mtx</code> when <code>line 4</code> has been executed, and thus makes <code>line 2</code> redundant?</li>\n<li><p>What would happen if <code>line 1</code> is uncommented?</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;pthread.h&gt;\n#include&lt;semaphore.h&gt;\n#include&lt;unistd.h&gt;\n\n\nsem_t bin_sem;\npthread_mutex_t mtx;\nchar message[100];\n\n\nvoid * thread_function(void * arg)\n{   \n    int x;\n    char message2[10];\n    while(1)\n    {   \n\n//      pthread_mutex_lock(&amp;mtx); //line 1\n        printf(\"thread2 : waiting..\\n\\n\");\n        sem_wait(&amp;bin_sem);     \n        printf(\"hi i am the new thread waiting inside critical..\\n\");\n        scanf(\"%s\",message);\n        printf(\"You entered in newthread:%s\\n\\n\",message);\n        sem_post(&amp;bin_sem);\n        pthread_mutex_unlock(&amp;mtx); //line 2\n\n    }\n\n}\n\nint main(void)\n{\n    pthread_t athread;\n    pthread_attr_t ta;\n    char message2[10];\n    int x;\n\n    sem_init(&amp;bin_sem,0,1);\n\n    pthread_mutex_init(&amp;mtx,NULL);\n\n    pthread_attr_init(&amp;ta);\n    pthread_attr_setschedpolicy(&amp;ta,SCHED_RR);                                                                                                                                                                                                       \n\n    pthread_create(&amp;athread,&amp;ta,thread_function,NULL);\n    while(1)\n    {   \n        pthread_mutex_lock(&amp;mtx); //line 3\n        printf(\"main waiting..\\n\\n\");\n        sem_wait(&amp;bin_sem); \n        printf(\"hi i am the main thread waiting inside critical..\\n\");\n        scanf(\"%s\",message);\n        printf(\"You entered in main:%s\\n\\n\",message);\n        sem_post(&amp;bin_sem);\n        pthread_mutex_unlock(&amp;mtx); //line 4\n    }\n    sleep(5);       \n}\n</code></pre></li>\n</ol>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 3693, "user_id": 5494721, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WHK5j.png?s=128&g=1", "display_name": "OznOg", "link": "https://stackoverflow.com/users/5494721/oznog"}, "edited": false, "score": 0, "creation_date": 1543435287, "post_id": 53527066, "comment_id": 93923242, "body": "what compiler do you use? gcc with no special flag already gives a lot of warnings..."}, {"owner": {"reputation": 2647, "user_id": 9829403, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RvgmsYSS48c/AAAAAAAAAAI/AAAAAAAAAAw/pUPnPAhmDec/photo.jpg?sz=128", "display_name": "Tim Randall", "link": "https://stackoverflow.com/users/9829403/tim-randall"}, "edited": false, "score": 0, "creation_date": 1543436154, "post_id": 53527066, "comment_id": 93923636, "body": "If you aren&#39;t sure what effect a <code>#define</code> has, you can often use your code editor&#39;s Search and Replace feature to achieve the same effect. It requires you to be smart if it&#39;s a define that takes parameters, but you can replace all <code>tc1</code> with <code>{1,2}</code> and the code will compile <i>exactly</i> the same (assuming you remove the line that defined <code>tc1</code>)."}], "answers": [{"comments": [{"owner": {"reputation": 293, "user_id": 2391611, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/530ce0f87b9b06feb507105cf313b9d6?s=128&d=identicon&r=PG", "display_name": "Min Gao", "link": "https://stackoverflow.com/users/2391611/min-gao"}, "edited": false, "score": 0, "creation_date": 1543445878, "post_id": 53527215, "comment_id": 93927432, "body": "I see. So the compiler can not automatically treat string initializer {1,2} as an array, and arrange/allocate space for it."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 1, "last_activity_date": 1543435215, "creation_date": 1543435215, "answer_id": 53527215, "question_id": 53527066, "link": "https://stackoverflow.com/questions/53527066/difference-between-global-define-and-global-variable-declaration/53527215#53527215", "title": "Difference between global define and global variable declaration", "body": "<p>When applying the macro substitution, this:</p>\n\n<pre><code>const int *arr4[2][2] = {{tc1, tc2}, {tc3, tc4}};\n</code></pre>\n\n<p>Becomes:</p>\n\n<pre><code>const int *arr4[2][2] = {{{1,2}, {2,3}}, {{3,4}, {4,5}}};\n</code></pre>\n\n<p><code>arr4</code> is a 2D array of <code>int *</code>, but you assign something like <code>{1,2}</code> to each element which is not a <code>int *</code>.  This <em>could</em> work if you use a compound literal:</p>\n\n<pre><code>const int *arr4[2][2] = {{(int [])tc1, (int [])tc2}, {(int [])tc3, (int [])tc4}};\n</code></pre>\n\n<p>Which becomes:</p>\n\n<pre><code>const int *arr4[2][2] = {{(int []){1,2}, (int []){2,3}}, {(int []){3,4}, (int []){4,5}}};\n</code></pre>\n\n<p>Then you assign an actual array, which decays into a pointer to its first element, to each element of <code>arr4</code>.</p>\n\n<p>This works:</p>\n\n<pre><code>const int *arr2[2][2] = {{ts1, ts2}, {ts3, ts4}};\n</code></pre>\n\n<p>Because <code>ts1</code>, <code>ts2</code>, <code>ts3</code>, and <code>ts4</code> are arrays of type <code>int</code>, so using them here results in them decaying to a pointer to their first elements.</p>\n"}], "owner": {"reputation": 293, "user_id": 2391611, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/530ce0f87b9b06feb507105cf313b9d6?s=128&d=identicon&r=PG", "display_name": "Min Gao", "link": "https://stackoverflow.com/users/2391611/min-gao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 1, "accepted_answer_id": 53527215, "answer_count": 1, "score": 1, "last_activity_date": 1543435215, "creation_date": 1543434624, "question_id": 53527066, "link": "https://stackoverflow.com/questions/53527066/difference-between-global-define-and-global-variable-declaration", "title": "Difference between global define and global variable declaration", "body": "<p>I'm trying to understand the mix use of pointer and array in an array declaration. The usage of the global variable declaration and define directive makes me a little confused. The code snippet is shown below.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nconst int ts1[2] = {(1), (2)};\nconst int ts2[2] = {(2), (3)};\nconst int ts3[2] = {(3), (4)};\nconst int ts4[2] = {(4), (5)};\n#define tc1 {1,2}\n#define tc2 {2,3}\n#define tc3 {3,4}\n#define tc4 {4,5}\n\nint main()\n{\n    const int arr1[][2][2] = {{{(1), (2)}, {(2), (3)}}, {{(3), (4)}, {(4), (5)}}};\n    const int *arr2[2][2] = {{ts1, ts2}, {ts3, ts4}};\n    const int arr3[][2][2] = {{tc1, tc2}, {tc3, tc4}};\n    const int *arr4[2][2] = {{tc1, tc2}, {tc3, tc4}};\n\n    printf(\"%d\\n\", arr2[1][1][1]);\n    printf(\"%d\\n\", arr3[1][0][1]);\n    printf(\"%d\\n\", arr4[1][0][1]);\n    return 0;\n}\n</code></pre>\n\n<p>arr1 is a normal way of declaring an array.\narr2 w/ global var decl and arr3 w/ define directive works fine as well. However, arr4 w/ define directive issues me a seg fault while running. Considering define directive simply replace whatever it defines into arr4's intialized list, why arr2 can work but arr4 can not?</p>\n"}, {"tags": ["c", "memory-leaks", "valgrind"], "comments": [{"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1543435269, "post_id": 53527042, "comment_id": 93923236, "body": "Instead of doing realloc correctly maybe look into using <a href=\"https://github.com/boyerjohn/rapidstring\" rel=\"nofollow noreferrer\">github.com/boyerjohn/rapidstring</a> or <a href=\"https://github.com/websnarf/bstrlib\" rel=\"nofollow noreferrer\">github.com/websnarf/bstrlib</a>"}], "answers": [{"tags": [], "owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "is_accepted": false, "score": 2, "last_activity_date": 1543434931, "creation_date": 1543434931, "answer_id": 53527139, "question_id": 53527042, "link": "https://stackoverflow.com/questions/53527042/valgrind-crashes-and-gives-me-this-invalid-realloc-warning/53527139#53527139", "title": "Valgrind crashes and gives me this invalid realloc warning", "body": "<p>After your first call to <code>realloc</code> you have freed <code>str</code>. It's been replaced with a new allocation. And then your function returns without storing the new value of <code>str</code> anywhere.</p>\n\n<p>So yes you are using invalid values of <code>str</code> after <code>recTreeToStr</code> returns.</p>\n"}, {"comments": [{"owner": {"reputation": 369, "user_id": 2036120, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/f98d00bac2d98cd1f97b7215c899067e?s=128&d=identicon&r=PG&f=1", "display_name": "Andrea Ciceri", "link": "https://stackoverflow.com/users/2036120/andrea-ciceri"}, "edited": false, "score": 0, "creation_date": 1543435684, "post_id": 53527161, "comment_id": 93923423, "body": "Yes, you are right, now it works.About the problem of including &#39;(&#39; and &#39;)&#39; that you say if you look carefully you can see that I correctly increment nLen. Anyway thanks."}], "tags": [], "owner": {"reputation": 11764, "user_id": 279130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5855748ea447bb6797fb04ccb6aa70bb?s=128&d=identicon&r=PG", "display_name": "jwismar", "link": "https://stackoverflow.com/users/279130/jwismar"}, "is_accepted": true, "score": 1, "last_activity_date": 1543435295, "last_edit_date": 1543435295, "creation_date": 1543434992, "answer_id": 53527161, "question_id": 53527042, "link": "https://stackoverflow.com/questions/53527042/valgrind-crashes-and-gives-me-this-invalid-realloc-warning/53527161#53527161", "title": "Valgrind crashes and gives me this invalid realloc warning", "body": "<p>In order to successfully reallocate your char* you're actually going to need to pass around a char**. The char* you have in your method is a copy of the real pointer you think you're reallocating.</p>\n\n<p>Something like:</p>\n\n<pre><code>int recTreeToStr(t_syntaxTree* t, char** str, int len) {\n...\n    *str = realloc(*str, sizeof(char) * nLen);\n...\n}\n</code></pre>\n\n<p>and </p>\n\n<pre><code>recTreeToStr(tree, &amp;str, 1);\n</code></pre>\n\n<p>I'm also concerned that you're allocating memory for the existing string + the length of the node name, but then also including '(' and ')' and ' ' and not allocating space for those. (Unless I'm blind.)</p>\n"}], "owner": {"reputation": 369, "user_id": 2036120, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/f98d00bac2d98cd1f97b7215c899067e?s=128&d=identicon&r=PG&f=1", "display_name": "Andrea Ciceri", "link": "https://stackoverflow.com/users/2036120/andrea-ciceri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 0, "accepted_answer_id": 53527161, "answer_count": 2, "score": 0, "last_activity_date": 1543435295, "creation_date": 1543434516, "question_id": 53527042, "link": "https://stackoverflow.com/questions/53527042/valgrind-crashes-and-gives-me-this-invalid-realloc-warning", "title": "Valgrind crashes and gives me this invalid realloc warning", "body": "<p><code>t_syntaxTree</code> is a struct defined as:</p>\n\n<pre><code>typedef struct t_syntaxTree {\n    char nodeName[16];\n    int nodesLen;\n    struct t_syntaxTree** nodes;\n} t_syntaxTree;\n</code></pre>\n\n<p>I wrote the function <code>treeToStr</code> to transformate a syntax tree in a string, the code should be self explanatory. The output string format is lisp-like, for example an output string can be <code>(or (and true true) (&gt; b 3))</code>.\nThe following code works but if I execute the program with valgrind it crashes with a segmentation fault.\nFurthermore, before the crash, valgrind tells me that some of my realloc calls are invalid.</p>\n\n<pre><code>int recTreeToStr(t_syntaxTree* t, char* str, int len) {\n    if (t-&gt;nodesLen == 0) {\n        int nLen = len + strlen(t-&gt;nodeName);\n        str = realloc(str, sizeof(char) * nLen);\n        strcat(str, t-&gt;nodeName);\n        return nLen;\n    }\n    else {\n        int nLen = len + strlen(t-&gt;nodeName) + 1;\n        str = realloc(str, sizeof(char) * nLen);\n        strcat(str, \"(\");\n        strcat(str, t-&gt;nodeName);\n\n        for (int i=0; i&lt;t-&gt;nodesLen; i++) {\n            nLen++;\n            str = realloc(str, sizeof(char) * nLen);\n            strcat(str, \" \");\n            nLen = recTreeToStr(t-&gt;nodes[i], str, nLen);\n        }\n\n        nLen++;\n        str = realloc(str, sizeof(char) * nLen);\n        strcat(str, \")\");\n\n        return nLen;\n    }\n}\n\nchar* treeToStr(t_syntaxTree* tree) {\n    char* str=malloc(sizeof(char));\n    str[0] = '\\0';\n    recTreeToStr(tree, str, 1);\n    return str;\n}\n</code></pre>\n\n<p>This is the valgrind report before the crash (immediatly after this message the program crash with a segmentation fault error):</p>\n\n<pre><code>==26561== Invalid free() / delete / delete[] / realloc()\n==26561==    at 0x4839D7B: realloc (vg_replace_malloc.c:826)\n==26561==    by 0x10B3C4: recTreeToStr (cooper.c:443)\n==26561==    by 0x10B420: recTreeToStr (cooper.c:445)\n==26561==    by 0x10B420: recTreeToStr (cooper.c:445)\n==26561==    by 0x10B420: recTreeToStr (cooper.c:445)\n==26561==    by 0x10B4C0: treeToStr (cooper.c:459)\n==26561==    by 0x10B4F2: cooper (cooper.c:467)\n==26561==    by 0x10922E: main (test.c:6)\n==26561==  Address 0x4a6aee0 is 0 bytes inside a block of size 15 free'd\n==26561==    at 0x4839D7B: realloc (vg_replace_malloc.c:826)\n==26561==    by 0x10B310: recTreeToStr (cooper.c:431)\n==26561==    by 0x10B420: recTreeToStr (cooper.c:445)\n==26561==    by 0x10B420: recTreeToStr (cooper.c:445)\n==26561==    by 0x10B420: recTreeToStr (cooper.c:445)\n==26561==    by 0x10B420: recTreeToStr (cooper.c:445)\n==26561==    by 0x10B4C0: treeToStr (cooper.c:459)\n==26561==    by 0x10B4F2: cooper (cooper.c:467)\n==26561==    by 0x10922E: main (test.c:6)\n==26561==  Block was alloc'd at\n==26561==    at 0x4839D7B: realloc (vg_replace_malloc.c:826)\n==26561==    by 0x10B3C4: recTreeToStr (cooper.c:443)\n==26561==    by 0x10B420: recTreeToStr (cooper.c:445)\n==26561==    by 0x10B420: recTreeToStr (cooper.c:445)\n==26561==    by 0x10B420: recTreeToStr (cooper.c:445)\n==26561==    by 0x10B4C0: treeToStr (cooper.c:459)\n==26561==    by 0x10B4F2: cooper (cooper.c:467)\n==26561==    by 0x10922E: main (test.c:6)\n==26561== \n==26561== Invalid read of size 1\n==26561==    at 0x10B3DF: recTreeToStr (cooper.c:444)\n==26561==    by 0x10B420: recTreeToStr (cooper.c:445)\n==26561==    by 0x10B420: recTreeToStr (cooper.c:445)\n==26561==    by 0x10B420: recTreeToStr (cooper.c:445)\n==26561==    by 0x10B4C0: treeToStr (cooper.c:459)\n==26561==    by 0x10B4F2: cooper (cooper.c:467)\n==26561==    by 0x10922E: main (test.c:6)\n==26561==  Address 0x0 is not stack'd, malloc'd or (recently) free'd\n==26561== \n==26561== \n==26561== Process terminating with default action of signal 11 (SIGSEGV): dumping core\n==26561==  Access not within mapped region at address 0x0\n==26561==    at 0x10B3DF: recTreeToStr (cooper.c:444)\n==26561==    by 0x10B420: recTreeToStr (cooper.c:445)\n==26561==    by 0x10B420: recTreeToStr (cooper.c:445)\n==26561==    by 0x10B420: recTreeToStr (cooper.c:445)\n==26561==    by 0x10B4C0: treeToStr (cooper.c:459)\n==26561==    by 0x10B4F2: cooper (cooper.c:467)\n==26561==    by 0x10922E: main (test.c:6)\n==26561==  If you believe this happened as a result of a stack\n==26561==  overflow in your program's main thread (unlikely but\n==26561==  possible), you can try to increase the size of the\n==26561==  main thread stack using the --main-stacksize= flag.\n==26561==  The main thread stack size used in this run was 8388608.\n==26561== \n==26561== HEAP SUMMARY:\n==26561==     in use at exit: 1,249 bytes in 46 blocks\n==26561==   total heap usage: 224 allocs, 178 frees, 21,257 bytes allocated\n==26561== \n==26561== 17 bytes in 1 blocks are definitely lost in loss record 2 of 11\n==26561==    at 0x4839D7B: realloc (vg_replace_malloc.c:826)\n==26561==    by 0x10B310: recTreeToStr (cooper.c:431)\n==26561==    by 0x10B420: recTreeToStr (cooper.c:445)\n==26561==    by 0x10B420: recTreeToStr (cooper.c:445)\n==26561==    by 0x10B420: recTreeToStr (cooper.c:445)\n==26561==    by 0x10B420: recTreeToStr (cooper.c:445)\n==26561==    by 0x10B4C0: treeToStr (cooper.c:459)\n==26561==    by 0x10B4F2: cooper (cooper.c:467)\n==26561==    by 0x10922E: main (test.c:6)\n==26561== \n==26561== LEAK SUMMARY:\n==26561==    definitely lost: 17 bytes in 1 blocks\n==26561==    indirectly lost: 0 bytes in 0 blocks\n==26561==      possibly lost: 0 bytes in 0 blocks\n==26561==    still reachable: 1,232 bytes in 45 blocks\n==26561==         suppressed: 0 bytes in 0 blocks\n==26561== Reachable blocks (those to which a pointer was found) are not shown.\n==26561== To see them, rerun with: --leak-check=full --show-leak-kinds=all\n==26561== \n==26561== For counts of detected and suppressed errors, rerun with: -v\n==26561== ERROR SUMMARY: 3 errors from 3 contexts (suppressed: 0 from 0)\n</code></pre>\n"}, {"tags": ["c", "algorithm", "loops"], "comments": [{"owner": {"reputation": 56117, "user_id": 845092, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=128&d=identicon&r=PG", "display_name": "Mooing Duck", "link": "https://stackoverflow.com/users/845092/mooing-duck"}, "edited": false, "score": 0, "creation_date": 1543434292, "post_id": 53526960, "comment_id": 93922760, "body": "Are you aware that there&#39;s only 8 possible win conditions?"}, {"owner": {"reputation": 368279, "user_id": 1288, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/fc763c6ff6c160ddad05741e87e517b6?s=128&d=identicon&r=PG", "display_name": "Bill the Lizard", "link": "https://stackoverflow.com/users/1288/bill-the-lizard"}, "edited": false, "score": 0, "creation_date": 1543434510, "post_id": 53526960, "comment_id": 93922881, "body": "This is already gridSize^2. If you repeat this for columns, it will be 2 x gridSize^2, which is still gridSize^2. This will be very fast, even for large arrays."}, {"owner": {"reputation": 368279, "user_id": 1288, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/fc763c6ff6c160ddad05741e87e517b6?s=128&d=identicon&r=PG", "display_name": "Bill the Lizard", "link": "https://stackoverflow.com/users/1288/bill-the-lizard"}, "edited": false, "score": 0, "creation_date": 1543435295, "post_id": 53526960, "comment_id": 93923245, "body": "<a href=\"https://stackoverflow.com/q/22188851/1288\">Why is constant always dropped from big O analysis?</a>"}, {"owner": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 0, "creation_date": 1543435881, "post_id": 53526960, "comment_id": 93923519, "body": "Hint: check only the neighbours of the last move."}], "answers": [{"tags": [], "owner": {"reputation": 70549, "user_id": 4785185, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ChR5h.jpg?s=128&g=1", "display_name": "Prune", "link": "https://stackoverflow.com/users/4785185/prune"}, "is_accepted": true, "score": 2, "last_activity_date": 1543435232, "creation_date": 1543435232, "answer_id": 53527220, "question_id": 53526960, "link": "https://stackoverflow.com/questions/53526960/most-efficient-way-to-check-for-a-win-in-a-variable-size-tic-tac-toe-grid/53527220#53527220", "title": "Most efficient way to check for a win in a variable size tic-tac-toe grid?", "body": "<p>Make this easier: iterate once through the loops, keeping a count of X vs O in each of your combinations:</p>\n\n<pre><code>int row[gridSize], col[gridSize], diag1, diag2\n\nfor(int y = 0; y &lt; gridSize; y++)\nint lineTotal = 0;\n{\n    for(int x = 0; x &lt; gridSize; x++)\n    {\n        if (grid[x][y] == 'X') {\n            row[x]++\n            col[y]++\n            if (x == y)          diag1++\n            if (x+y == gridSize) diag2++\n        }\n        else if (grid[x][y] == 'XO {\n            row[x]--\n            col[y]--\n            if (x == y)          diag1--\n            if (x+y == gridSize) diag2--\n        }\n    }\n}\n</code></pre>\n\n<p>Now, just check your totals; if any of them reached gridSize, <code>X</code> wins; if -gridSize, <code>O</code> wins.</p>\n\n<p>Perhaps even easier, keep these as running sums through the game.  For instance, when <code>X</code> moves into cell x, y:</p>\n\n<pre><code>if (row[x]++ == gridSize)  `X` wins\nif (col[x]++ == gridSize)  `X` wins\nif (x == y &amp;&amp; diag1[x]++ == gridSize)  `X` wins\nif (x+y == gridSize and diag[x]++ == gridSize)  `X` wins\n</code></pre>\n\n<p>Also, note that the first one, especially, is easier if you code the grid with -1, 1, and 0 for X, O, and empty.</p>\n"}], "owner": {"reputation": 37, "user_id": 5377973, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-kjD2wluwD1g/AAAAAAAAAAI/AAAAAAAAANo/pgeg-kHiq_s/photo.jpg?sz=128", "display_name": "Ambidextroid", "link": "https://stackoverflow.com/users/5377973/ambidextroid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 340, "favorite_count": 0, "accepted_answer_id": 53527220, "answer_count": 1, "score": 0, "last_activity_date": 1543438813, "creation_date": 1543434187, "last_edit_date": 1543438813, "question_id": 53526960, "link": "https://stackoverflow.com/questions/53526960/most-efficient-way-to-check-for-a-win-in-a-variable-size-tic-tac-toe-grid", "title": "Most efficient way to check for a win in a variable size tic-tac-toe grid?", "body": "<p>I'm writing a tic-tac-toe game in C where the user chooses the size of the grid. The grid is a 2D array.</p>\n\n<p>I'm having trouble efficiently checking for a win. This is my current idea:</p>\n\n<pre><code>for(int y = 0; y &lt; gridSize; y++)\n{\n    int lineTotal = 0;\n    for(int x = 0; x &lt; gridSize; x++)\n    {\n        if (grid[x][y] == grid[0][y])\n        {\n            lineTotal++;\n            if (lineTotal == gridSize &amp;&amp; grid[x][y] == playersLetter)\n            {\n                return 1;\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>Which checks every row for a full line. If I want to check each column, I have to swap <code>x</code> and <code>y</code> re-do each loop. I also have to do another loop to check the diagonals, though that's not too hard seeing as there are only two.</p>\n\n<p>My problem is I want to limit the amount of iterations of all the loops to <code>gridSize^2</code>.</p>\n"}, {"tags": ["c", "linux", "gcc"], "comments": [{"owner": {"reputation": 3693, "user_id": 5494721, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WHK5j.png?s=128&g=1", "display_name": "OznOg", "link": "https://stackoverflow.com/users/5494721/oznog"}, "edited": false, "score": 1, "creation_date": 1543435011, "post_id": 53526956, "comment_id": 93923118, "body": "can you be more specific with your problem? there several problems with your code, but the worse is probably char *nChild; wich is being written without allocation and shared by children"}, {"owner": {"reputation": 2354, "user_id": 9428851, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-MBhDff_bdY0/AAAAAAAAAAI/AAAAAAAACAY/lx7DUTjS350/photo.jpg?sz=128", "display_name": "Victor Gubin", "link": "https://stackoverflow.com/users/9428851/victor-gubin"}, "edited": false, "score": 0, "creation_date": 1543435016, "post_id": 53526956, "comment_id": 93923121, "body": "Use <a href=\"https://linux.die.net/man/2/waitpid\" rel=\"nofollow noreferrer\">waitpid</a> instead wait"}, {"owner": {"reputation": 13191, "user_id": 4990642, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/xY0PD.jpg?s=128&g=1", "display_name": "snr", "link": "https://stackoverflow.com/users/4990642/snr"}, "edited": false, "score": 1, "creation_date": 1543436787, "post_id": 53526956, "comment_id": 93923910, "body": "<b>By the way,</b> I see your some other posts in which there are well answers. <b>You should accept if an answer is helpful by clicking tick icon on the left side</b>"}, {"owner": {"reputation": 361, "user_id": 9216763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f82db8ba356c594ea3b37011d6e66161?s=128&d=identicon&r=PG&f=1", "display_name": "miimote", "link": "https://stackoverflow.com/users/9216763/miimote"}, "reply_to_user": {"reputation": 13191, "user_id": 4990642, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/xY0PD.jpg?s=128&g=1", "display_name": "snr", "link": "https://stackoverflow.com/users/4990642/snr"}, "edited": false, "score": 0, "creation_date": 1543440334, "post_id": 53526956, "comment_id": 93925438, "body": "No @snr , the other posts don&#39;t resolve the problem because they don&#39;t use a for loop in the parent process to create child processes. My problem with that code raises when I use the loop in the loop."}, {"owner": {"reputation": 361, "user_id": 9216763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f82db8ba356c594ea3b37011d6e66161?s=128&d=identicon&r=PG&f=1", "display_name": "miimote", "link": "https://stackoverflow.com/users/9216763/miimote"}, "reply_to_user": {"reputation": 3693, "user_id": 5494721, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WHK5j.png?s=128&g=1", "display_name": "OznOg", "link": "https://stackoverflow.com/users/5494721/oznog"}, "edited": false, "score": 0, "creation_date": 1543444295, "post_id": 53526956, "comment_id": 93926932, "body": "The problem was no allocation of *nChild. Thanks @OznOg"}], "answers": [{"tags": [], "owner": {"reputation": 13191, "user_id": 4990642, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/xY0PD.jpg?s=128&g=1", "display_name": "snr", "link": "https://stackoverflow.com/users/4990642/snr"}, "is_accepted": false, "score": 2, "last_activity_date": 1543526857, "last_edit_date": 1543526857, "creation_date": 1543436382, "answer_id": 53527474, "question_id": 53526956, "link": "https://stackoverflow.com/questions/53526956/fork-and-exec-several-children-in-linux/53527474#53527474", "title": "Fork and exec several children in linux", "body": "<p>You need to make parent wait for all child processes to finish. If not, assume that 1 child waited for is done and then parent exits. What about the other 2 children? They become orphan since their parent doesn't wait for them.</p>\n\n<pre><code>pid_t wpid;\nint status = 0;\n.\n.\nwhile ((wpid = wait(&amp;status)) &gt; 0); // the parent waits for all the child processes \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 361, "user_id": 9216763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f82db8ba356c594ea3b37011d6e66161?s=128&d=identicon&r=PG&f=1", "display_name": "miimote", "link": "https://stackoverflow.com/users/9216763/miimote"}, "is_accepted": true, "score": 0, "last_activity_date": 1543445952, "creation_date": 1543445952, "answer_id": 53529381, "question_id": 53526956, "link": "https://stackoverflow.com/questions/53526956/fork-and-exec-several-children-in-linux/53529381#53529381", "title": "Fork and exec several children in linux", "body": "<p>This code did the job</p>\n\n<pre><code>/* daddy.c */\n#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;sys/wait.h&gt;\n#include &lt;string.h&gt;\nint main(void)\n{\n        int status=0;\n        char nChild[16];\n        pid_t wpid;\n        for (int i=0; i&lt;3;i++){\n            sprintf(nChild, \"%d\", i);\n            int pid = fork();\n            if (pid == 0)\n            {\n                printf(\"%s\\n\", nChild);\n                char *const arguments[]={\"child\", nChild, NULL};\n                fflush(NULL);\n                execv(\"child\",arguments);\n                printf(\"\\nNo , you can't print!\\n\");\n            }else if (pid == -1){\n                    printf(\"%d\\n\", getpid());\n                    exit(0);\n            }\n        }\n        while ((wpid=wait(&amp;status)) &gt;0);\n        printf(\"Dad %d went out!\\n\", getpid());\n        exit(0);\n}\n</code></pre>\n\n<p>As @OnzOg said in the comments of the question, allocation of <code>nChild</code> was the main problem. Also <code>execv</code> need pass child name twice, one as argument.\nAnd finally, to improve the code, parent process needs to wait all processes to finish.</p>\n"}], "owner": {"reputation": 361, "user_id": 9216763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f82db8ba356c594ea3b37011d6e66161?s=128&d=identicon&r=PG&f=1", "display_name": "miimote", "link": "https://stackoverflow.com/users/9216763/miimote"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 152, "favorite_count": 1, "accepted_answer_id": 53529381, "answer_count": 2, "score": 1, "last_activity_date": 1543526857, "creation_date": 1543434170, "last_edit_date": 1543437540, "question_id": 53526956, "link": "https://stackoverflow.com/questions/53526956/fork-and-exec-several-children-in-linux", "title": "Fork and exec several children in linux", "body": "<p>I want to fork and exec several processes from another.\nMy parent code is</p>\n\n<pre><code>/*Daddy.c*/\n#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;sys/wait.h&gt;\n    int main(void)\n{\n        int status;\n        char *nChild;\n\n        for (int i=0; i&lt;3;i++){\n            int pid = fork();\n            if (pid == 0)\n            {\n                sprintf(nChild, \"%d\", i);\n                printf(\"%d\\n\", i);\n                char *const arguments[]={nChild, NULL};\n                fflush(NULL);\n                execv(\"child\",arguments);\n                printf(\"\\nNo , you can't print!\\n\");\n            }else if (pid == -1){\n                    printf(\"%d\\n\", getpid());\n                    exit(0);\n            }\n        }\n        wait(&amp;status);\n        printf(\"Dad %d went out!\\n\", getpid());\n        exit(0);\n}\n</code></pre>\n\n<p>and my child process is</p>\n\n<pre><code>    /*child.c*/\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n\nint main(int args, char **argv){\n        if( args !=2){\n                printf(\"Child going away!\\n\");\n                exit(1);\n        }\n        printf(\"Child %s: %d going away stylishly!\\n\", argv[1], getpid());\n\n        exit(0);\n}\n</code></pre>\n\n<p>When I don\u00b4t create three forks, but one, I know how to create the child, do some work and exit from child and parent. But, in this case, with several children it seems like the child never executes.\nBecause of the line <code>wait(&amp;status)</code> I did hope that when the first child exits, the parent also exits but, any child prints any message.\n<a href=\"https://stackoverflow.com/questions/42685719/fork-and-exec-two-child-processes\">Some relevant previous questions</a> didn\u00b4t help.</p>\n"}, {"tags": ["c", "compilation"], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2201041"}, "is_accepted": false, "score": 1, "last_activity_date": 1543434732, "creation_date": 1543434732, "answer_id": 53527091, "question_id": 53526950, "link": "https://stackoverflow.com/questions/53526950/information-lost-with-type-conversion-in-c/53527091#53527091", "title": "Information lost with type conversion in C", "body": "<p>C standard <a href=\"https://stackoverflow.com/questions/2054939/is-char-signed-or-unsigned-by-default\">does not specify whether char is signed or unsigned</a>. In fact, assigning a char type a value outside of the basic execution character set is implementation defined. You can probably use the macros in <a href=\"https://www.tutorialspoint.com/c_standard_library/limits_h.htm\" rel=\"nofollow noreferrer\"><code>&lt;limits.h&gt;</code></a> to verify.</p>\n\n<p>I suspect on your system <code>char</code> is signed, which makes the max value 127. <a href=\"https://stackoverflow.com/questions/18195715/why-is-unsigned-integer-overflow-defined-behavior-but-signed-integer-overflow-is\">Signed interger overflow is undefined</a>. So no guarantess on the output. In this case, it looks like it wraps around.</p>\n"}, {"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 1, "last_activity_date": 1543434883, "creation_date": 1543434883, "answer_id": 53527125, "question_id": 53526950, "link": "https://stackoverflow.com/questions/53526950/information-lost-with-type-conversion-in-c/53527125#53527125", "title": "Information lost with type conversion in C", "body": "<p>Assuming a <code>char</code> is signed and 8 bits, its range is -128 to 127 which means the value 128 is out of range for a <code>char</code>.  So the value is converted in a implementation-defined manner.  In the case of gcc, the result is reduced modulo 2<sup>8</sup> to become in range.</p>\n\n<p>What this basically means is that the low-order byte of the <code>int</code> value 128 is assigned to the <code>char</code> variable.  128 in hex as 32-bit is 0x00000080, so 0x80 is assigned to <code>y</code>.  Assuming 2's compliment representation, this represents the value -128.  When this value is then assigned to <code>z</code>, which is an <code>int</code>, that value <em>can</em> be represented in an <code>int</code>, so that's what gets assigned to it, and its representation is 0xffffff80.</p>\n"}], "owner": {"reputation": 137, "user_id": 7943248, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UqAYj.jpg?s=128&g=1", "display_name": "HadesZazif", "link": "https://stackoverflow.com/users/7943248/hadeszazif"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "closed_date": 1543434907, "answer_count": 2, "score": 1, "last_activity_date": 1543434883, "creation_date": 1543434162, "question_id": 53526950, "link": "https://stackoverflow.com/questions/53526950/information-lost-with-type-conversion-in-c", "closed_reason": "Duplicate", "title": "Information lost with type conversion in C", "body": "<pre><code>#include &lt;stdio.h&gt;\n\nint main(int argc, char const *argv[])\n{\n    int x = 128;\n    char y = x;\n    int z = y;\n    printf(\"%d\\n\", z);\n    return 0;\n}\n</code></pre>\n\n<p>i don't understand why this program prints -128.\ni have tried to convert 128 in binary base but i'm still confused on how the C compiler convert int to char and char to int.</p>\n\n<p><strong>Note : in my machine sizeof(char) = 1 and sizeof(int) = 4</strong></p>\n"}, {"tags": ["c", "arrays", "pointers", "matrix", "reversi"], "comments": [{"owner": {"reputation": 305833, "user_id": 68587, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/7d9fd158e03cbde94f7e0b33b78222af?s=128&d=identicon&r=PG", "display_name": "John Kugelman", "link": "https://stackoverflow.com/users/68587/john-kugelman"}, "edited": false, "score": 0, "creation_date": 1543432321, "post_id": 53526319, "comment_id": 93921866, "body": "When you compile do you get any warnings? You should, and it&#39;s important you read and fix them."}], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 10718819, "user_type": "registered", "profile_image": "https://graph.facebook.com/1877315318984116/picture?type=large", "display_name": "Rotem Heinig", "link": "https://stackoverflow.com/users/10718819/rotem-heinig"}, "edited": false, "score": 0, "creation_date": 1543432447, "post_id": 53526459, "comment_id": 93921922, "body": "alright , that&#39;s definitely the answer. thank you, wasn&#39;t paying attention :)"}, {"owner": {"reputation": 7, "user_id": 10718819, "user_type": "registered", "profile_image": "https://graph.facebook.com/1877315318984116/picture?type=large", "display_name": "Rotem Heinig", "link": "https://stackoverflow.com/users/10718819/rotem-heinig"}, "edited": false, "score": 0, "creation_date": 1543432735, "post_id": 53526459, "comment_id": 93922048, "body": "Now that I have changed the type, it appears that I have a problem with the reset board function. mind trying to help me with it ? :)"}, {"owner": {"reputation": 152, "user_id": 4841399, "user_type": "registered", "profile_image": "https://graph.facebook.com/926659647354258/picture?type=large", "display_name": "Jakub Hubert", "link": "https://stackoverflow.com/users/4841399/jakub-hubert"}, "reply_to_user": {"reputation": 7, "user_id": 10718819, "user_type": "registered", "profile_image": "https://graph.facebook.com/1877315318984116/picture?type=large", "display_name": "Rotem Heinig", "link": "https://stackoverflow.com/users/10718819/rotem-heinig"}, "edited": false, "score": 0, "creation_date": 1543433174, "post_id": 53526459, "comment_id": 93922245, "body": "It seems you are you forgot to use one * before board variable in your inner loop. It should look like this: <code>*((*board) + (i * Size + j)) = &#39;x&#39;;</code> because your board variable is of type pointer to pointer."}], "tags": [], "owner": {"reputation": 152, "user_id": 4841399, "user_type": "registered", "profile_image": "https://graph.facebook.com/926659647354258/picture?type=large", "display_name": "Jakub Hubert", "link": "https://stackoverflow.com/users/4841399/jakub-hubert"}, "is_accepted": true, "score": 4, "last_activity_date": 1543432437, "last_edit_date": 1543432437, "creation_date": 1543432103, "answer_id": 53526459, "question_id": 53526319, "link": "https://stackoverflow.com/questions/53526319/using-pointers-to-change-a-matrix/53526459#53526459", "title": "Using pointers to change a matrix", "body": "<p>I think there may be problem with initialization of your board as type of char and working with pointers and array of type int in your functions. Char has size of 1 byte and int has bigger size depending on platform (4 bytes most of the times). This will cause memory problems with manipulation and looping over your array.</p>\n\n<p>In your case, it looks like you have looped over whole allocated memory after 2 rows because you used pointers of type int. Int is in your case probably 4 times bigger than char resulting in looping over whole of your data structure of type char 4 times quicker as you expected.</p>\n"}, {"comments": [{"owner": {"reputation": 7, "user_id": 10718819, "user_type": "registered", "profile_image": "https://graph.facebook.com/1877315318984116/picture?type=large", "display_name": "Rotem Heinig", "link": "https://stackoverflow.com/users/10718819/rotem-heinig"}, "edited": false, "score": 0, "creation_date": 1543432631, "post_id": 53526520, "comment_id": 93921998, "body": "Hey, thank you for trying to help. I accidentally used the wrong type on the function, as Jakub said :)"}, {"owner": {"reputation": 7, "user_id": 10718819, "user_type": "registered", "profile_image": "https://graph.facebook.com/1877315318984116/picture?type=large", "display_name": "Rotem Heinig", "link": "https://stackoverflow.com/users/10718819/rotem-heinig"}, "edited": false, "score": 0, "creation_date": 1543433381, "post_id": 53526520, "comment_id": 93922340, "body": "@AndersCedronius thank you very much !! rly helped me. we haven&#39;t yet learned the memset func, so I will be glad for an explanation about it if you can, or another way to do it"}, {"owner": {"reputation": 1876, "user_id": 2353816, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/t5smr.jpg?s=128&g=1", "display_name": "Anders Cedronius", "link": "https://stackoverflow.com/users/2353816/anders-cedronius"}, "reply_to_user": {"reputation": 7, "user_id": 10718819, "user_type": "registered", "profile_image": "https://graph.facebook.com/1877315318984116/picture?type=large", "display_name": "Rotem Heinig", "link": "https://stackoverflow.com/users/10718819/rotem-heinig"}, "edited": false, "score": 0, "creation_date": 1543433627, "post_id": 53526520, "comment_id": 93922464, "body": "@RotemHeinig memset basically works like this... memset (a_pointer, the_value_to_set, number_of_bytes_to_set). just write &#39;man memset&#39; in your terminal for more verbose information.  memset(void *b, int c, size_t len);  DESCRIPTION      The memset() function writes len bytes of value c (converted to an      unsigned char) to the string b."}, {"owner": {"reputation": 152, "user_id": 4841399, "user_type": "registered", "profile_image": "https://graph.facebook.com/926659647354258/picture?type=large", "display_name": "Jakub Hubert", "link": "https://stackoverflow.com/users/4841399/jakub-hubert"}, "edited": false, "score": 0, "creation_date": 1543433864, "post_id": 53526520, "comment_id": 93922568, "body": "Interesting thing to notice is, that when you use functions like malloc or memset to allocate your data structure, it is allocated in heap part of memory. If you use static allocation of array like you did: <code>char Board[Size][Size] = { {&quot; &quot;} };</code> - it is allocated in stack memory."}, {"owner": {"reputation": 1876, "user_id": 2353816, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/t5smr.jpg?s=128&g=1", "display_name": "Anders Cedronius", "link": "https://stackoverflow.com/users/2353816/anders-cedronius"}, "reply_to_user": {"reputation": 152, "user_id": 4841399, "user_type": "registered", "profile_image": "https://graph.facebook.com/926659647354258/picture?type=large", "display_name": "Jakub Hubert", "link": "https://stackoverflow.com/users/4841399/jakub-hubert"}, "edited": false, "score": 0, "creation_date": 1543434208, "post_id": 53526520, "comment_id": 93922709, "body": "@JakubHubert and RotemHeinig... Added a memset alternative and if you want a more dynamic memory allocation model."}], "tags": [], "owner": {"reputation": 1876, "user_id": 2353816, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/t5smr.jpg?s=128&g=1", "display_name": "Anders Cedronius", "link": "https://stackoverflow.com/users/2353816/anders-cedronius"}, "is_accepted": false, "score": 1, "last_activity_date": 1544687027, "last_edit_date": 1544687027, "creation_date": 1543432310, "answer_id": 53526520, "question_id": 53526319, "link": "https://stackoverflow.com/questions/53526319/using-pointers-to-change-a-matrix/53526520#53526520", "title": "Using pointers to change a matrix", "body": "<p>You got a bunch of errors in your code. See inline comments.</p>\n\n<pre><code>    //Use all capitals for defines\n#define BOARD_SIZE 8\n\n//Just reset the whole array to spaces.. No need to traverse byte by byte.\nvoid resetBoard(char* board) {\n    //memset version\n    //memset(board, ' ', (BOARD_SIZE*BOARD_SIZE)*sizeof(char));\n\n    //non memset version\n    for (int i=0; i&lt;(BOARD_SIZE*BOARD_SIZE); i++) *board++='x';\n}\n\nvoid printBoard(char *board) {\n    for (int i = 0; i &lt; BOARD_SIZE; i++){\n        for (int j = 0; j &lt; BOARD_SIZE; j++){\n            //Access the 2D array like this (y * width of array + x)\n            printf(\"%c\", board[i*BOARD_SIZE+j]);\n            printf(\" \");\n        }\n        printf(\"\\n\");\n    }\n}\n\n//Don't start a name using capitals.. Later when you program c++ or similar you will understand :-)\nint main()\n{\n    //This is a more dynamic memory model and is not allocated on the stack.. (free when done!!)\n    char *board=(char*)malloc(BOARD_SIZE*BOARD_SIZE);\n    //there are several ways of working with arrays.. No need to complicate stuff if not needed.\n    //Just point out the first byte of the array.. (See the methods takes a char pointer and that is what's passed the methods)\n    if (board) {\n        resetBoard(board);\n        //Test to see if it works\n        board[1*BOARD_SIZE+2]='0';\n        printBoard(board);\n        free(board);\n    } else {\n        printf(\"Out of memory!\\n\");\n        return EXIT_FAILURE;\n    }\n    return EXIT_SUCCESS;\n}\n</code></pre>\n\n<p>Or bling it like it's 2020!</p>\n\n<pre><code>#define B 16 //Define the size of the 2d matrix\nvoid printMatrix(char*b){for(int i=-1;i&lt;B*B-1;(++i+1)%B?printf(\"%c \",b[i%B*B+i/B]):printf(\"%c\\n\",b[i%B*B+i/B])){}} //Print the 2d matrix\nint main(){\n    char b[B*B]={[0 ...B*B-1]='x'}; //Reserve the 2d matrix space and set all entries to 'x'\n    printMatrix(&amp;b[0]); //pass the pointer to the print 2d matrix method\n    return 0; //Done!\n}\n</code></pre>\n\n<p>Or 2021 ;-) (A 2d array)</p>\n\n<pre><code>#define B 32\nvoid p(char b[B][B]){for(int i=-1;i&lt;B*B-1;(++i+1)%B?printf(\"%c \",b[i%B][i/B]):printf(\"%c\\n\",b[i%B][i/B])){}}\nint main(){\n    char b[B][B]={[0 ...B-1][0 ...B-1]='x'};\n    p(&amp;b[0]);\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 7, "user_id": 10718819, "user_type": "registered", "profile_image": "https://graph.facebook.com/1877315318984116/picture?type=large", "display_name": "Rotem Heinig", "link": "https://stackoverflow.com/users/10718819/rotem-heinig"}, "edited": false, "score": 0, "creation_date": 1543433921, "post_id": 53526855, "comment_id": 93922599, "body": "Hey mate, thanks for answering. The answers to this exercise should be with pointers, as the teacher said. thanks for helping!"}], "tags": [], "owner": {"reputation": 509, "user_id": 3487040, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qS36g.jpg?s=128&g=1", "display_name": "eapetcho", "link": "https://stackoverflow.com/users/3487040/eapetcho"}, "is_accepted": false, "score": 1, "last_activity_date": 1543433805, "creation_date": 1543433805, "answer_id": 53526855, "question_id": 53526319, "link": "https://stackoverflow.com/questions/53526319/using-pointers-to-change-a-matrix/53526855#53526855", "title": "Using pointers to change a matrix", "body": "<p>@RotemHeinig. Your code has many deficiencies. Bellow is an example reformating your example. Maybe, it will give you an idea of how to improve to work:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n\n#define Size 8\n\nvoid resetBoard(char board[][Size]);\nvoid printBoard(char board[][Size]);\n\nint main()\n{\n    char Board[Size][Size];\n    resetBoard(Board);\n    printBoard(Board);\n    printf(\"\\n\");\n\n    return 0;\n}\n\nvoid resetBoard(char board[][Size])\n{\n    for (size_t i = 0; i &lt; Size; i++)\n    {\n        for (size_t j = 0; j &lt; Size; j++)\n        {\n            board[i][j] = 'x';\n        }\n    }\n }\n\n void printBoard(char board[][Size])\n {\n     for (size_t i = 0; i &lt; Size; i++)\n     {\n         for (size_t j = 0; j &lt; Size; j++)\n         {\n              printf(\"%c \", board[i][j]);\n              printf(\" \");\n         }\n         printf(\"\\n\");\n     }\n  }\n</code></pre>\n\n<p>Compiling this code using <strong>gcc</strong> on my machine looks like:</p>\n\n<pre><code>gcc -std=c11 -Wall reversi.c -o a.out\n</code></pre>\n\n<p>And the execution gives:</p>\n\n<pre><code>./a.out\nx x x x x x x x\nx x x x x x x x\nx x x x x x x x\nx x x x x x x x\nx x x x x x x x\nx x x x x x x x\nx x x x x x x x\nx x x x x x x x\n</code></pre>\n\n<p>I hope you find inspiration from here on.</p>\n"}, {"comments": [{"owner": {"reputation": 7, "user_id": 10718819, "user_type": "registered", "profile_image": "https://graph.facebook.com/1877315318984116/picture?type=large", "display_name": "Rotem Heinig", "link": "https://stackoverflow.com/users/10718819/rotem-heinig"}, "edited": false, "score": 0, "creation_date": 1543437712, "post_id": 53527704, "comment_id": 93924304, "body": "Thank you mate ! Much appreciated."}], "tags": [], "owner": {"reputation": 509, "user_id": 3487040, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qS36g.jpg?s=128&g=1", "display_name": "eapetcho", "link": "https://stackoverflow.com/users/3487040/eapetcho"}, "is_accepted": false, "score": 1, "last_activity_date": 1543437466, "creation_date": 1543437466, "answer_id": 53527704, "question_id": 53526319, "link": "https://stackoverflow.com/questions/53526319/using-pointers-to-change-a-matrix/53527704#53527704", "title": "Using pointers to change a matrix", "body": "<p>below is the <em>pointer</em> version of my previous suggestion:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n\n#define Size 8\n\nvoid resetBoard(char *board, int size);\nvoid printBoard(char *board, int size);\n\nint main()\n{\n    char *Board = (char *)malloc(Size*Size*sizeof(char));\n    resetBoard(Board, Size);\n    printBoard(Board, Size);\n    printf(\"\\n\");\n   free(Board);\n\n    return 0;\n}\n\nvoid resetBoard(char *board, int size)\n{\n    for (size_t i = 0; i &lt; size; i++)\n    {\n        for (size_t j = 0; j &lt; size; j++)\n        {\n            *(board +i*size + j) = 'x';\n        }\n    }\n }\n\n void printBoard(char *board, int size)\n {\n      for (size_t i = 0; i &lt; size; i++)\n      {\n           for (size_t j = 0; j &lt; size; j++)\n           {\n                printf(\"%c \", *(board +i*size + j));\n           }\n           printf(\"\\n\");\n      }\n  }\n</code></pre>\n\n<p>The compile (on my machine) looks again, like:</p>\n\n<pre><code>gcc -std=c11 -Wall reversi.c -o a.out\n</code></pre>\n\n<p>and the execution gives:</p>\n\n<pre><code>./a.out\nx x x x x x x x\nx x x x x x x x \nx x x x x x x x\nx x x x x x x x\nx x x x x x x x\nx x x x x x x x\nx x x x x x x x\nx x x x x x x x\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 10718819, "user_type": "registered", "profile_image": "https://graph.facebook.com/1877315318984116/picture?type=large", "display_name": "Rotem Heinig", "link": "https://stackoverflow.com/users/10718819/rotem-heinig"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 198, "favorite_count": 0, "accepted_answer_id": 53526459, "answer_count": 4, "score": 0, "last_activity_date": 1544687027, "creation_date": 1543431516, "last_edit_date": 1543432168, "question_id": 53526319, "link": "https://stackoverflow.com/questions/53526319/using-pointers-to-change-a-matrix", "title": "Using pointers to change a matrix", "body": "<p>In our c course, the teacher has given us a mini project to build a \"Reversi\" game. I'm having trouble building the board.</p>\n\n<pre><code>#define Size 8\nint main()\n{\n    char Board[Size][Size] = { {\" \"} };\n    resetBoard(Board);\n    printBoard(Board);\n    printf(\"\\n\");\n    getch();\n}\nvoid resetBoard(int** board)\n{\n    for (size_t i = 0; i &lt; Size; i++)\n    {\n        for (size_t j = 0; j &lt; Size; j++)\n        {\n            *(board + (i * Size + j)) = 'x';\n        }\n    }\n}\nvoid printBoard(int board[Size][Size])\n{\n    for (size_t i = 0; i &lt; Size; i++)\n    {\n        for (size_t j = 0; j &lt; Size; j++)\n        {\n            printf(\"%c\", board[i][j]);\n            printf(\" \");\n        }\n        printf(\"\\n\");\n    }\n}\n</code></pre>\n\n<p>I've checked the program and the program gets:</p>\n\n<blockquote>\n  <p>Run-time check failure #2 - Stack around the variable 'Board' was corrupted</p>\n</blockquote>\n\n<p>when it changes the first X on the third row.\nFor example, if I run the program till the end of the 2d row (16),\nI wont get this error.</p>\n"}, {"tags": ["c", "linked-list", "linux-kernel"], "comments": [{"owner": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "edited": false, "score": 0, "creation_date": 1543432466, "post_id": 53526254, "comment_id": 93921931, "body": "Are you saying that when you call <code>LIST_REMOVE</code> it can&#39;t find the element at the head of the list?"}, {"owner": {"reputation": 32686, "user_id": 10396, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ddbfebb47432f6599da361df6a135c7c?s=128&d=identicon&r=PG", "display_name": "AShelly", "link": "https://stackoverflow.com/users/10396/ashelly"}, "edited": false, "score": 0, "creation_date": 1543433978, "post_id": 53526254, "comment_id": 93922626, "body": "You are not showing any of the code for deletion, which makes this hard to debug.  However, since the head of a list is generally not stored in a list node, but in an indepenent location, it takes special handling to delete it.  See for example <a href=\"https://stackoverflow.com/q/8281335/10396\">this question</a>."}, {"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1543436157, "post_id": 53526254, "comment_id": 93923638, "body": "kernel lists expect you to keep one extra list_head for each list.  Every element is also a list_head so a list of N has N+1 list_heads.  Deleting the 1st element is no different from deleting one in the middle."}, {"owner": {"reputation": 47, "user_id": 10027580, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-LJSXu_hg-x0/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq12lbowKhQv81AF9Y60L-pkAqz28g/mo/photo.jpg?sz=128", "display_name": "computerengineer", "link": "https://stackoverflow.com/users/10027580/computerengineer"}, "reply_to_user": {"reputation": 32686, "user_id": 10396, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ddbfebb47432f6599da361df6a135c7c?s=128&d=identicon&r=PG", "display_name": "AShelly", "link": "https://stackoverflow.com/users/10396/ashelly"}, "edited": false, "score": 0, "creation_date": 1543469922, "post_id": 53526254, "comment_id": 93932797, "body": "@AShelly when we implement our design, we did not know the information about the storage of the head of the list. We have used another approach to the the task. Thank you for the information. Additionally, thanks for other people they try to hepl me."}, {"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1543493996, "post_id": 53526254, "comment_id": 93944928, "body": "When writing kernel code I would advise you to strictly adhere to the style of the other device drivers."}, {"owner": {"reputation": 3561, "user_id": 2511795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30c869f55cbcf82a7bc4536d563daa0a?s=128&d=identicon&r=PG", "display_name": "0andriy", "link": "https://stackoverflow.com/users/2511795/0andriy"}, "edited": false, "score": 0, "creation_date": 1543658584, "post_id": 53526254, "comment_id": 94004186, "body": "It\u2019s not the answer, rather material to understand <a href=\"https://stackoverflow.com/questions/33850930/correct-way-to-join-two-double-linked-list/33853454#33853454\" title=\"correct way to join two double linked list\">stackoverflow.com/questions/33850930/&hellip;</a>"}], "owner": {"reputation": 47, "user_id": 10027580, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-LJSXu_hg-x0/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq12lbowKhQv81AF9Y60L-pkAqz28g/mo/photo.jpg?sz=128", "display_name": "computerengineer", "link": "https://stackoverflow.com/users/10027580/computerengineer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 281, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1543431295, "creation_date": 1543431295, "question_id": 53526254, "link": "https://stackoverflow.com/questions/53526254/deleting-the-head-of-the-list-in-linux-kernel", "title": "Deleting The Head of The List in Linux Kernel", "body": "<p>We are developing a kernel device. There is a list in a device that keeps the messages. We want to delete the head of the list. The related part of the code is below:</p>\n\n<p>Device Message and Device Struct:</p>\n\n<pre><code>typedef struct dev_message\n{\n    char *data;\n    int *message_count;\n    struct list_head list;\n}device_message;\n\n\ntypedef struct queue_dev\n{\n    device_message *message_head;\n    struct semaphore sem;\n    struct cdev cdev;\n}queue_device;\n</code></pre>\n\n<p>Adding to head of the list is done with</p>\n\n<pre><code>INIT_LIST_HEAD(&amp;(dev-&gt;message_head-&gt;list));\n</code></pre>\n\n<p>and adding the other entries are done with</p>\n\n<pre><code>list_add_tail(&amp;newMsg-&gt;list,&amp;dev-&gt;message_head-&gt;list);\n</code></pre>\n\n<p>We can delete every element of the list except the head of the list. How can we delete the only head of the list?\nSincerely. </p>\n"}, {"tags": ["c", "linked-list", "doubly-linked-list", "insertion-sort"], "comments": [{"owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 4, "creation_date": 1543431739, "post_id": 53526190, "comment_id": 93921560, "body": "We need to see <i>all</i> the functions related to list insertion/deletion. What you&#39;ve shown doesn&#39;t illustrate the problem you&#39;re having. Please edit your question and post your entire program [in a single code block]. It should compile cleanly and we should be able to download it, compile it, and run it [possibly under <code>gdb</code>] if we so choose. See: <a href=\"https://stackoverflow.com/help/mcve\">stackoverflow.com/help/mcve</a>"}], "answers": [{"tags": [], "owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "is_accepted": false, "score": 1, "last_activity_date": 1543449042, "last_edit_date": 1543449042, "creation_date": 1543446132, "answer_id": 53529413, "question_id": 53526190, "link": "https://stackoverflow.com/questions/53526190/insertion-sort-algorithm-using-doubly-linked-lists-in-c-inserting-nodes/53529413#53529413", "title": "Insertion sort algorithm using doubly-linked lists in c - inserting nodes", "body": "<p>I think you're doing a lot of unnecessary alloc/free.</p>\n\n<p>When taking an item off the original list, it doesn't need to be deallocated, just adjust the <code>head</code> pointer.</p>\n\n<p>When the insertion point is found, this node can be inserted directly into the destination list.</p>\n\n<p>This simplifies the code quite a bit. But, your base list primitives aren't suitable for this type of node transfer from list to list.</p>\n\n<p>I've coded up a few functions that can work directly on insertion of <em>existing</em> node pointers into a list.</p>\n\n<p>I also refactored the sort function to use these.</p>\n\n<p>NOTE: Because you didn't post <em>all</em> of your code, I didn't have a convenient way to test this. It will compile, but otherwise, no guarantees. Hopefully, it will help you get further.</p>\n\n<pre><code>void\ninsert_list_tail(LinkedList *list,Node *new)\n{\n    Node *prev;\n\n    prev = list-&gt;tail;\n\n    if (prev != NULL)\n        prev-&gt;next = new;\n\n    new-&gt;next = NULL;\n    new-&gt;prev = prev;\n\n    list-&gt;tail = new;\n\n    if (list-&gt;head == prev)\n        list-&gt;head = new;\n}\n\nvoid\ninsert_list_head(LinkedList *list,Node *new)\n{\n    Node *next;\n\n    next = list-&gt;head;\n\n    if (next != NULL)\n        next-&gt;prev = new;\n\n    new-&gt;prev = NULL;\n    new-&gt;next = next;\n\n    list-&gt;head = new;\n\n    if (list-&gt;tail == next)\n        list-&gt;tail = new;\n}\n\nvoid\ninsert_list_before(LinkedList *list,Node *cur,Node *new)\n{\n    Node *next;\n    Node *prev;\n\n    do {\n        // we got to the end of the list without an insert before point, so\n        // append to tail of list\n        if (cur == NULL) {\n            insert_list_tail(list,new);\n            break;\n        }\n\n        // we do insert after [internally here] so get the previous node\n        cur = cur-&gt;prev;\n\n        // with no previous node insert at head of list\n        if (cur == NULL) {\n            insert_list_head(list,new);\n            break;\n        }\n\n        prev = cur-&gt;prev;\n        next = cur-&gt;next;\n\n        if (prev != NULL)\n            prev-&gt;next = new;\n        else\n            list-&gt;head = new;\n\n        if (next != NULL)\n            next-&gt;prev = new;\n        else\n            list-&gt;tail = new;\n\n        new-&gt;prev = prev;\n        new-&gt;next = next;\n    } while (0);\n}\n\nvoid\ninsertion_sort(LinkedList *slist, int (*compare)(void *,void *))\n{\n    LinkedList list;\n    LinkedList *dlist = &amp;list;\n    Node *src;\n    Node *dst;\n\n    if (slist == NULL)\n        return;\n\n    if (slist-&gt;head == NULL)\n        return;\n\n    dlist-&gt;head = NULL;\n    dlist-&gt;tail = NULL;\n\n    // grab first source node and insert it at destination list head\n    src = slist-&gt;head;\n    slist-&gt;head = src-&gt;next;\n    insert_list_head(dlist,src);\n\n    while (1) {\n        src = slist-&gt;head;\n        if (src == NULL)\n            break;\n\n        slist-&gt;head = src-&gt;next;\n\n        // find node to do an insertion before (i.e. find the first destination\n        // node that is higher than the source node)\n        for (dst = dlist-&gt;head;  dst != NULL;  dst = dst-&gt;next) {\n            if (compare(dst-&gt;data,src-&gt;data) &gt; 0)\n                break;\n        }\n\n        insert_list_before(dlist,dst,src);\n    }\n\n    slist-&gt;head = dlist-&gt;head;\n    slist-&gt;tail = dlist-&gt;tail;\n}\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10718712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8998b18d82f2522e06936331fb29ff94?s=128&d=identicon&r=PG&f=1", "display_name": "Quar", "link": "https://stackoverflow.com/users/10718712/quar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 642, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1543449042, "creation_date": 1543431040, "last_edit_date": 1543433108, "question_id": 53526190, "link": "https://stackoverflow.com/questions/53526190/insertion-sort-algorithm-using-doubly-linked-lists-in-c-inserting-nodes", "title": "Insertion sort algorithm using doubly-linked lists in c - inserting nodes", "body": "<p>I am very new to coding and I'm trying to write a function in C using the insertion sort algorithm on a doubly linked list. The function takes an element off the old list and inserts it in alphabetical order on a new list. </p>\n\n<p>I'm having problems looping the function when an element is greater than (ie further along in the alphabet) the first element in the new/sorted list. Right now it is only adding elements that can be appended or prepended. Why is this? \nHere is my function:</p>\n\n<pre><code>    #include \"sort.h\"\n    #include &lt;stdio.h&gt;\n    #include &lt;stdlib.h&gt;\n    #include \"linked_list.h\"\n\n/* sort linked list *list using merge insertion sort. */\n/* upon success, the elements in *list will be sorted. */\n/* return silently if *list is uninitialised or empty. */\n/* the compare argument is a pointer to a function which returns */\n/* less than 0, 0, or greater than 0 if first argument is */\n/* less than, equal to, or greater than second argument respectively. */\nvoid insertion_sort(LinkedList *list, int (*compare)(void *, void *))\n{\n    void *d, *B_node_data;\n    LinkedList *B;\n    Node *B_node, *new_node;\n\n    if(!list)\n        return;\n\n    if(!list-&gt;head)\n        return;\n\n    B = initialise_linked_list();\n    d = list-&gt;head-&gt;data;\n    remove_head_linked_list(list);\n    prepend_linked_list(B, d);\n\n\n    while(list-&gt;head)\n    {\n        d = list-&gt;head-&gt;data;\n        B_node = B-&gt;head;\n        remove_head_linked_list(list);\n\n        while(B_node)\n        {\n        B_node_data = B_node-&gt;data;\n            if((*compare)(d, B_node_data) &lt;= 0)\n            {\n                if(B_node-&gt;prev)\n                {\n                    new_node = initialise_node();\n                    new_node-&gt;next = B_node;\n                    new_node-&gt;prev = B_node-&gt;prev;\n                    new_node-&gt;data = d;\n                    break;\n                }\n                if(B-&gt;head-&gt;data == B_node_data)\n                {\n                    prepend_linked_list(B, d);\n                    break;\n                }\n            }                    \n            if(!B_node-&gt;next)\n                append_linked_list(B, d);\n        else{\n                B_node = B_node-&gt;next;\n            }\n        }\n    } \nlist-&gt;head = B-&gt;head; \nlist-&gt;tail = B-&gt;tail;\n\nB-&gt;head = NULL;\nB-&gt;tail = NULL;\nfree_linked_list(B);\n\n\n}\n</code></pre>\n\n<p>here is the definitions of the functions i called from another file:</p>\n\n<pre><code>    #include \"linked_list.h\"\n\n    #include &lt;stdio.h&gt;\n    #include &lt;stdlib.h&gt;\n    #include &lt;string.h&gt;\n\nNode *initialise_node(void)\n{\n    Node *node;\n\n    if(!(node = (Node *) malloc(sizeof(Node)))) {\n        fprintf(stderr, \"error: unable to initialise node.\\n\");\n        exit(EXIT_FAILURE);\n    }\n    node-&gt;next = node-&gt;prev = node-&gt;data = NULL;\n\n    return node;\n}\n\nvoid free_node(Node *node)\n{\n    if(!node)\n        return;\n    free(node);\n}\n\nLinkedList *initialise_linked_list(void)\n{\n    LinkedList *list;\n\n    if(!(list = (LinkedList *) malloc(sizeof(LinkedList)))) {\n        fprintf(stderr, \"error: unable to initialise linked list.\\n\");\n        exit(EXIT_FAILURE);\n    }\n    list-&gt;head = list-&gt;tail = NULL;\n\n    return list;\n}\n\nvoid free_linked_list(LinkedList *list)\n{\n    Node *next;\n\n    while(list-&gt;head) {\n        next = list-&gt;head-&gt;next;\n        free_node(list-&gt;head);\n        list-&gt;head = next;\n    }\n    free(list);\n}\n\nvoid append_linked_list(LinkedList *list, void *data)\n{\n    Node *node;\n\n    node = initialise_node();\n\n    node-&gt;data = data;\n    node-&gt;prev = list-&gt;tail;\n    if(list-&gt;tail) {\n        list-&gt;tail-&gt;next = node;\n    }\n    list-&gt;tail = node;\n    if(!list-&gt;head)\n        list-&gt;head = node;\n}\n\nvoid prepend_linked_list(LinkedList *list, void *data)\n{\n    Node *node;\n\n    node = initialise_node();\n\n    node-&gt;data = data;\n    node-&gt;next = list-&gt;head;\n    if(list-&gt;head) {\n        list-&gt;head-&gt;prev = node;\n    }\n    list-&gt;head = node;\n    if(!list-&gt;tail)\n        list-&gt;tail = node;\n}\n\nvoid remove_head_linked_list(LinkedList *list)\n{\n    Node *head;\n\n    if(!list-&gt;head)\n        return;\n    head = list-&gt;head-&gt;next;\n    free(list-&gt;head);\n    list-&gt;head = head;\n    if(list-&gt;head)\n        list-&gt;head-&gt;prev = NULL;\n    else\n        list-&gt;tail = NULL;\n\n}\n\nvoid remove_tail_linked_list(LinkedList *list)\n{\n    Node *tail;\n\n    if(!list-&gt;tail)\n        return;\n    tail = list-&gt;tail-&gt;prev;\n    free_node(list-&gt;tail);\n    list-&gt;tail = tail;\n    if(list-&gt;tail)\n        list-&gt;tail-&gt;next = NULL;\n    else\n        list-&gt;head = NULL;\n}\n</code></pre>\n\n<p>here is my output</p>\n\n<pre><code>==942== Command: ./task1_test harmonious pencil push naive jittery \ngreedy billowy practise lock star appear record precede pen lace\n==942== \nappear\nbillowy\ngreedy\nharmonious\npencil\npush\nstar\n==942== \n==942== HEAP SUMMARY:\n==942==     in use at exit: 264 bytes in 11 blocks\n==942==   total heap usage: 35 allocs, 24 frees, 824 bytes allocated\n==942== \n==942== 264 bytes in 11 blocks are definitely lost in loss record 1 of 1\n==942==    at 0x4C29C23: malloc (vg_replace_malloc.c:299)\n==942==    by 0x40084E: initialise_node (linked_list.c:11)\n==942==    by 0x400CF1: insertion_sort (sort.c:43)\n==942==    by 0x400815: main (task1_test.c:33)\n==942== \n==942== LEAK SUMMARY:\n==942==    definitely lost: 264 bytes in 11 blocks\n==942==    indirectly lost: 0 bytes in 0 blocks\n==942==      possibly lost: 0 bytes in 0 blocks\n==942==    still reachable: 0 bytes in 0 blocks\n==942==         suppressed: 0 bytes in 0 blocks\n==942== \n</code></pre>\n"}, {"tags": ["c", "arrays", "multidimensional-array", "primes"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1543430809, "post_id": 53526125, "comment_id": 93921088, "body": "Step 1: An <code>isPrime()</code> function."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1543430871, "post_id": 53526125, "comment_id": 93921124, "body": "You need to get a handle on your indentation here because it&#39;s bordering on total anarchy. Consistent indentation is extremely important in a language like C where tiny syntax mistakes can result in program behaviour extremely divergent from your actual goals."}, {"owner": {"reputation": 2647, "user_id": 9829403, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RvgmsYSS48c/AAAAAAAAAAI/AAAAAAAAAAw/pUPnPAhmDec/photo.jpg?sz=128", "display_name": "Tim Randall", "link": "https://stackoverflow.com/users/9829403/tim-randall"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1543431091, "post_id": 53526125, "comment_id": 93921244, "body": "@tadman An <code>isPrime()</code> function that takes an <code>int</code> as a parameter. Then, make sure you&#39;re passing an <code>int</code> and not an array of them."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1543431172, "post_id": 53526125, "comment_id": 93921273, "body": "C provides arithmetic operations only for scalars.  You cannot, in that sense, perform arithmetic on arrays.  On the other hand, there&#39;s nothing special about performing arithmetic on scalar array <i>elements</i>.  Hint: to get a scalar element from a 2D array, you need to supply <i>two</i> indices."}], "answers": [{"tags": [], "owner": {"reputation": 455, "user_id": 7829467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bc7e2bb834f1b83651d824d57525bb6?s=128&d=identicon&r=PG&f=1", "display_name": "Gold Dragon", "link": "https://stackoverflow.com/users/7829467/gold-dragon"}, "is_accepted": false, "score": 0, "last_activity_date": 1543433410, "creation_date": 1543433410, "answer_id": 53526773, "question_id": 53526125, "link": "https://stackoverflow.com/questions/53526125/c-find-prime-numbers-in-randomly-generated-2d-array/53526773#53526773", "title": "C - find prime numbers in randomly generated 2d array", "body": "<p>The issue is that <code>A[i]</code> is one entire row of the 2D array and is therefore itself a standard (1D) array (which decays to <code>int*</code> when used in most ways, hence the message).</p>\n\n<p>You want to use <code>A[i][j]</code> to get the <code>int</code> value of the specific cell.</p>\n\n<p>But while this allows your code to compile, it still won't work properly. Here is a list of further problems to fix:</p>\n\n<ul>\n<li>Nested loops both iterating on <code>i</code>. This is clearly a mistake, and will produce unexpected results.</li>\n<li>Using the uninitialized automatic variables <code>n</code>, <code>sum</code>, and <code>count</code>. The latter two should be initialized to <code>0</code>; you need to do this explicitly. I'm not sure what <code>n</code> is trying to do.</li>\n<li>Code style. While this won't cause your code to fail directly, the mess of inconsistent indent and lack of encapsulation present makes it much easier to make mistakes.</li>\n</ul>\n"}], "owner": {"reputation": 1, "user_id": 10718762, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-fAq_ZGak78E/AAAAAAAAAAI/AAAAAAAAAKo/jCIQvNuPBQ0/photo.jpg?sz=128", "display_name": "Jimmy G", "link": "https://stackoverflow.com/users/10718762/jimmy-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 409, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1543433410, "creation_date": 1543430768, "question_id": 53526125, "link": "https://stackoverflow.com/questions/53526125/c-find-prime-numbers-in-randomly-generated-2d-array", "title": "C - find prime numbers in randomly generated 2d array", "body": "<p>In C, I have a randomly generated 20x20 array. I can sort and display it fine, but I need to take the prime numbers from each row and put them into their own array. It needs to be done with a function outside of main. </p>\n\n<p>Problem is, no matter what I try I can't find the correct syntax to perform the arithmetic on the array to find the prime numbers, I always get \"invalid operands to binary % (have 'int *' and 'int')\" error. I'm not sure if there's a way to dereference the array to perform arithmetic on it. Here's some code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n#define TOTAL_ROWS 20\n#define TOTAL_COLUMNS 20\n\nvoid fillMatrix(int A[TOTAL_ROWS][TOTAL_COLUMNS], int *set_rows, int *set_columns)\n{\n    int rows = 20, columns = 20;\n    for(int i = 0; i &lt; rows; i++)\n        for(int j = 0; j &lt; columns; j++)\n            A[i][j] = rand() % 500;\n\n    *set_rows = rows;\n    *set_columns = columns;\n}\n\n\n\n\nvoid sortMatrix(int A[TOTAL_ROWS][TOTAL_COLUMNS], int rowsize, int colsize)\n{\n    for(int r = 0; r &lt; rowsize; r++)\n        qsort(A[r], colsize, sizeof(int), compare);\n    }\n\n\n\nvoid displayArray(int A[TOTAL_ROWS][TOTAL_COLUMNS], int rows, int columns)\n{\n    for(int i = 0; i &lt; rows; i++)\n    {\n        for(int j = 0; j &lt; columns; j++)\n            printf(\"%3i \", A[i][j]);\n        printf(\"\\n\");\n    }\n}\n\nvoid findPrimes(int A[TOTAL_ROWS][TOTAL_COLUMNS], int rows, int columns)  \n{\nint n,c,sum,count;\n    for(int i = 0; i &lt; rows; i++)\n        {\n            for(int j = 0; j &lt; columns; j++){\n                for(i=0;i&lt;n;i++)\n                    {\n                        c=0;\n                        for(j=2;j&lt;A[i];j++)\n                        {\n                            if(A[i]%j==0) //where \"invalid operands to binary % (have 'int *' and 'int')\" happens \n                            {\n                                   c=1;\n                                   break;\n                            }\n                        }\n                         if(c==0)\n                         {\n                            printf(\"%d\\t\",A[i]);\n                            sum=sum+A[i];\n                            count++;\n                         }\n                    }\n            }\n        }\n}\n\n\n\nint main(void)\n{\n    int A[TOTAL_ROWS][TOTAL_COLUMNS];\n    int rows, columns;\n    fillMatrix(A, &amp;rows, &amp;columns);\n    sortMatrix(A, rows, columns);\n    displayArray(A, rows, columns);\n    findPrimes(A, rows, columns);\n    return  0;\n}\n</code></pre>\n"}, {"tags": ["c", "openmp", "pragma"], "comments": [{"owner": {"reputation": 77, "user_id": 7635717, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-i9itriOPVL8/AAAAAAAAAAI/AAAAAAAAAFE/2kgwaX31rXE/photo.jpg?sz=128", "display_name": "Carlos Martel Lamas", "link": "https://stackoverflow.com/users/7635717/carlos-martel-lamas"}, "reply_to_user": {"reputation": 2621, "user_id": 722238, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/52ad57e08b18f75e6aaaddd9a0cd59dc?s=128&d=identicon&r=PG&f=1", "display_name": "fbynite", "link": "https://stackoverflow.com/users/722238/fbynite"}, "edited": false, "score": 0, "creation_date": 1543429732, "post_id": 53525759, "comment_id": 93920571, "body": "Code already posted."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 2, "creation_date": 1543430329, "post_id": 53525759, "comment_id": 93920848, "body": "Why?  I mean, I don&#39;t see how, in your sample code, you could detect whether the threads waited as you describe or not.  Seems like an X-Y problem to me."}, {"owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 3, "creation_date": 1543430644, "post_id": 53525759, "comment_id": 93921011, "body": "We&#39;d need to see some more of your code. Particularly, how <code>partialSum</code> and <code>v</code> are used elsewhere. The usual way to do this is [sum an array of values] is: <code>#pragma omp parallel for reduction(+:totalSum) for (i = 0; i &lt; 100; ++i) totalSum += array[i];</code>"}, {"owner": {"reputation": 1480, "user_id": 10450594, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae4c6a0ca94b3094b25f18e66d8368ff?s=128&d=identicon&r=PG&f=1", "display_name": "Brice", "link": "https://stackoverflow.com/users/10450594/brice"}, "edited": false, "score": 1, "creation_date": 1543488088, "post_id": 53525759, "comment_id": 93941698, "body": "At the moment, what you are trying to achieve is far from clear. The context is important because there may be algorithms that achieve the same result while being better suited to parallelization. Having to rely on heavy synchronization while doing relatively easy tasks is a performance killer."}, {"owner": {"reputation": 77, "user_id": 7635717, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-i9itriOPVL8/AAAAAAAAAAI/AAAAAAAAAFE/2kgwaX31rXE/photo.jpg?sz=128", "display_name": "Carlos Martel Lamas", "link": "https://stackoverflow.com/users/7635717/carlos-martel-lamas"}, "edited": false, "score": 0, "creation_date": 1543488739, "post_id": 53525759, "comment_id": 93942098, "body": "Sorry for this late response, I will try to reply to all of you in this message. -@JohnBollinger the only thing I want to know if there is any option to make a thread wait for a condition (just like a semaphore does). -@CraigEstey After this part I only print those variables via <code>printf</code>. -@Brice It&#39;s a parallelization excersice for one of my subjects. Nothing to do with any business task or so."}, {"owner": {"reputation": 1480, "user_id": 10450594, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae4c6a0ca94b3094b25f18e66d8368ff?s=128&d=identicon&r=PG&f=1", "display_name": "Brice", "link": "https://stackoverflow.com/users/10450594/brice"}, "edited": false, "score": 0, "creation_date": 1543568003, "post_id": 53525759, "comment_id": 93973635, "body": "There is a lock mechanism implemented in openMP. See the lock routined in this <a href=\"https://www.openmp.org/wp-content/uploads/OpenMP-4.0-C.pdf\" rel=\"nofollow noreferrer\">reference card</a>. There is also the <code>ordered</code> clause that can guarantee that some line in a for loop will be executed in an orderly fashion."}], "owner": {"reputation": 77, "user_id": 7635717, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-i9itriOPVL8/AAAAAAAAAAI/AAAAAAAAAFE/2kgwaX31rXE/photo.jpg?sz=128", "display_name": "Carlos Martel Lamas", "link": "https://stackoverflow.com/users/7635717/carlos-martel-lamas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 854, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1543429701, "creation_date": 1543429280, "last_edit_date": 1543429701, "question_id": 53525759, "link": "https://stackoverflow.com/questions/53525759/omp-making-a-thread-wait-for-a-condition", "title": "OMP making a thread wait for a condition", "body": "<p>I have to make an odd thread (ex 1,3,5,...) wait for an even thread (ex 0,2,4,...) to finish before the first one.</p>\n\n<p>I thought I could use <code>pragma omp barrier</code> but it doesn't work the way I want.</p>\n\n<p>Is there any way to make threads wait for a condition to accomplish in order to keep them going? </p>\n\n<p>Part of the code: </p>\n\n<pre><code>#pragma omp parallel reduction(+:totalSum) private(i, tn)\n{\n    tn = omp_get_thread_num();\n    int lim = 0;\n    #pragma omp for\n    for(i = 0; i &lt; 100; i++){\n        v[i] = i+1;\n        lim = lim + 1;\n        partialSum[tn] = partialSum[tn] + v[i];\n\n        if(lim == 20){\n            //make odd threads wait for an even thread to finish before they can finish\n            totalSum += partialSum[tn]; \n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 3, "creation_date": 1543428893, "post_id": 53525655, "comment_id": 93920182, "body": "Please indent your code. This is <b>very</b> important. And what is your question?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1543429001, "post_id": 53525655, "comment_id": 93920240, "body": "A string ends in <code>&#39;\\0&#39;</code> by definition, otherwise it is a plain <code>char</code> array."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 3, "creation_date": 1543429014, "post_id": 53525655, "comment_id": 93920246, "body": "I don&#39;t understand what you mean by &quot;Why it came to an end &#39;\\0&#39;&quot; or &quot;how it should look int main () for two strings of characters&quot;.  Could you please be more specific about what you are asking?"}, {"owner": {"reputation": 1, "user_id": 10694064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80569abf12401f555f4bf2404a5cb003?s=128&d=identicon&r=PG&f=1", "display_name": "Jeryy1994", "link": "https://stackoverflow.com/users/10694064/jeryy1994"}, "edited": false, "score": 0, "creation_date": 1543429276, "post_id": 53525655, "comment_id": 93920367, "body": "I want to make a main in which to read two strings   to use the function above me and I do not understand why after while it appears at the end d [i] = &#39;\\ 0&#39;"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 4, "creation_date": 1543429531, "post_id": 53525655, "comment_id": 93920485, "body": "@Jeryy1994 In C, a <i>string</i> must always end with a <i>null character</i>, else it is not a string.  <code>d[i]=&#39;\\0&#39;;</code> insures <code>d</code> points to a string."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 2, "creation_date": 1543429614, "post_id": 53525655, "comment_id": 93920525, "body": "@Jeryy1994 you should read the chapter dealing with strings in your c text book."}, {"owner": {"reputation": 1, "user_id": 10694064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80569abf12401f555f4bf2404a5cb003?s=128&d=identicon&r=PG&f=1", "display_name": "Jeryy1994", "link": "https://stackoverflow.com/users/10694064/jeryy1994"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1543429806, "post_id": 53525655, "comment_id": 93920612, "body": "Thanks @chux    , i understand ,can you give me an example of int main to call this function?"}, {"owner": {"reputation": 1, "user_id": 10694064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80569abf12401f555f4bf2404a5cb003?s=128&d=identicon&r=PG&f=1", "display_name": "Jeryy1994", "link": "https://stackoverflow.com/users/10694064/jeryy1994"}, "edited": false, "score": 0, "creation_date": 1543430548, "post_id": 53525655, "comment_id": 93920967, "body": "How do i call it in int main ? :))"}, {"owner": {"reputation": 2647, "user_id": 9829403, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RvgmsYSS48c/AAAAAAAAAAI/AAAAAAAAAAw/pUPnPAhmDec/photo.jpg?sz=128", "display_name": "Tim Randall", "link": "https://stackoverflow.com/users/9829403/tim-randall"}, "edited": false, "score": 1, "creation_date": 1543431421, "post_id": 53525655, "comment_id": 93921394, "body": "Question. If your source string is empty (meaning that the first character is zero) would you expect a zero to be written into the first character of the destination string?"}, {"owner": {"reputation": 2647, "user_id": 9829403, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RvgmsYSS48c/AAAAAAAAAAI/AAAAAAAAAAw/pUPnPAhmDec/photo.jpg?sz=128", "display_name": "Tim Randall", "link": "https://stackoverflow.com/users/9829403/tim-randall"}, "edited": false, "score": 0, "creation_date": 1543433667, "post_id": 53525655, "comment_id": 93922483, "body": "Since you&#39;re going to want to copy the first character whether or not it is a zero, you can rewrite the <code>while</code> loop as a <code>do-while</code> loop \u2014 in other words, a loop that stops <i>after</i> copying a zero \u2014 and then you don&#39;t need to explicitly put in the zero value on the end of the destination string."}], "answers": [{"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1543431318, "post_id": 53526195, "comment_id": 93921353, "body": "Minor: To closer mimic C&#39;s <code>strcpy()</code>, could use <code>char *s</code> --&gt; <code>const char *s</code>."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1543431766, "post_id": 53526195, "comment_id": 93921577, "body": "@chux,  We could also modify the code to move much larger numbers of bytes at each iteration; however, that means a lot of complexity is moving the first few and last few bytes."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1543432302, "post_id": 53526195, "comment_id": 93921856, "body": "True, <a href=\"https://stackoverflow.com/users/3629249/user3629249\">that</a> would be a <i>performance</i> enhancement.   The <code>const</code> idea is a <i>functional</i> improvement as it increase applicability: allows a <code>const char *</code> as a source."}], "tags": [], "owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "is_accepted": false, "score": 2, "last_activity_date": 1543431057, "creation_date": 1543431057, "answer_id": 53526195, "question_id": 53525655, "link": "https://stackoverflow.com/questions/53525655/the-equivalent-of-the-strcpy-function-in-c-int-main-and-some-interpretations/53526195#53526195", "title": "The equivalent of the strcpy function in c, int main and some interpretations", "body": "<p>the posted code contains a lot of unnecessary statements.</p>\n\n<p>Suggest:</p>\n\n<pre><code>char *myStrcpy( char *d, char *s)\n{\n    char *dest = d;\n\n    while( *d++ = *s++ );\n\n    return dest;\n} \n</code></pre>\n\n<p>How to call it:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main( void )\n{\n    char destination[1024];\n    char source[] = \"source string\";\n\n    myStrcpy( destination, source );\n\n    puts( destination );\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10694064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80569abf12401f555f4bf2404a5cb003?s=128&d=identicon&r=PG&f=1", "display_name": "Jeryy1994", "link": "https://stackoverflow.com/users/10694064/jeryy1994"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 161, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1543433391, "creation_date": 1543428831, "last_edit_date": 1543433391, "question_id": 53525655, "link": "https://stackoverflow.com/questions/53525655/the-equivalent-of-the-strcpy-function-in-c-int-main-and-some-interpretations", "title": "The equivalent of the strcpy function in c, int main and some interpretations", "body": "<p>The equivalent of function <code>strpcy()</code> would be:</p>\n\n<pre><code>char *strcpy(char *d, char *s)\n{\n    int i = 0;\n    while (s[i]) {\n        d[i] = s[i];\n        i++;\n    }\n    d[i] = '\\0'; // or d[i] = 0;\n    return d;\n}   \n</code></pre>\n\n<p>Why it came to an end <code>'\\0'</code>?<br>\nAnd how it should look int main () for two strings of characters?</p>\n"}, {"tags": ["c", "function", "struct"], "comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 1, "creation_date": 1543428452, "post_id": 53525466, "comment_id": 93919986, "body": "<code>fflush(stdin);</code> = wrong; the standard only defines behavior for flushing <i>out</i> streams. And <code>&quot;%c&quot;</code> should be <code>&quot; %c&quot;</code> due to the remaining whitespace in the input stream after your read-segment input logic. <a href=\"https://stackoverflow.com/questions/20306659/the-program-doesnt-stop-on-scanfc-ch-line-why\">See this question for reasons why</a>."}, {"owner": {"reputation": 9056, "user_id": 318964, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/f2df406df36a856e16aa7f75b7185550?s=128&d=identicon&r=PG", "display_name": "KT.", "link": "https://stackoverflow.com/users/318964/kt"}, "edited": false, "score": 0, "creation_date": 1543428910, "post_id": 53525466, "comment_id": 93920192, "body": "The problem of the question author has nothing to do with stream flushing, however. There is a simple bug in the code."}], "answers": [{"comments": [{"owner": {"reputation": 2621, "user_id": 722238, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/52ad57e08b18f75e6aaaddd9a0cd59dc?s=128&d=identicon&r=PG&f=1", "display_name": "fbynite", "link": "https://stackoverflow.com/users/722238/fbynite"}, "edited": false, "score": 0, "creation_date": 1543429174, "post_id": 53525618, "comment_id": 93920322, "body": "Why not make specific examples of what could be improved in his code instead of bashing him for trying to learn - poor style on your part."}, {"owner": {"reputation": 9056, "user_id": 318964, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/f2df406df36a856e16aa7f75b7185550?s=128&d=identicon&r=PG", "display_name": "KT.", "link": "https://stackoverflow.com/users/318964/kt"}, "reply_to_user": {"reputation": 2621, "user_id": 722238, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/52ad57e08b18f75e6aaaddd9a0cd59dc?s=128&d=identicon&r=PG&f=1", "display_name": "fbynite", "link": "https://stackoverflow.com/users/722238/fbynite"}, "edited": false, "score": 0, "creation_date": 1543429964, "post_id": 53525618, "comment_id": 93920682, "body": "Unnecessary flush of the stdin. Unnecessary re-creation of data structures inside the calculate_segment function. Unnecessary atan declaration. Unreasonable &quot;functional&quot; style of passing itself by value and returning. Lack of easy to read logical structure. Ugly code formatting (fixed by an edit to the question now). It is hard to point out all the flaws - the best would be to rewrite the code completely, but this is not what the author asked and this would not fix anything, if the problem stems from the current learning path. Hence I suggested to use a proper textbook or a course."}, {"owner": {"reputation": 9, "user_id": 10691344, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/298ad9312376a5a8fe3153a7389afb75?s=128&d=identicon&r=PG&f=1", "display_name": "Oof", "link": "https://stackoverflow.com/users/10691344/oof"}, "edited": false, "score": 0, "creation_date": 1543430886, "post_id": 53525618, "comment_id": 93921132, "body": "thanks for the help, im learning this in university, you could tell me where to improve tho :)"}, {"owner": {"reputation": 2621, "user_id": 722238, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/52ad57e08b18f75e6aaaddd9a0cd59dc?s=128&d=identicon&r=PG&f=1", "display_name": "fbynite", "link": "https://stackoverflow.com/users/722238/fbynite"}, "edited": false, "score": 0, "creation_date": 1543430912, "post_id": 53525618, "comment_id": 93921150, "body": "re-write 50 lines of code, lol - that&#39;s a mighty fine high-horse you&#39;re on."}, {"owner": {"reputation": 9056, "user_id": 318964, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/f2df406df36a856e16aa7f75b7185550?s=128&d=identicon&r=PG", "display_name": "KT.", "link": "https://stackoverflow.com/users/318964/kt"}, "reply_to_user": {"reputation": 9, "user_id": 10691344, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/298ad9312376a5a8fe3153a7389afb75?s=128&d=identicon&r=PG&f=1", "display_name": "Oof", "link": "https://stackoverflow.com/users/10691344/oof"}, "edited": false, "score": 0, "creation_date": 1543431300, "post_id": 53525618, "comment_id": 93921339, "body": "@Oof, then just find an experienced friend or a professor to go over this code with you."}, {"owner": {"reputation": 9056, "user_id": 318964, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/f2df406df36a856e16aa7f75b7185550?s=128&d=identicon&r=PG", "display_name": "KT.", "link": "https://stackoverflow.com/users/318964/kt"}, "reply_to_user": {"reputation": 2621, "user_id": 722238, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/52ad57e08b18f75e6aaaddd9a0cd59dc?s=128&d=identicon&r=PG&f=1", "display_name": "fbynite", "link": "https://stackoverflow.com/users/722238/fbynite"}, "edited": false, "score": 0, "creation_date": 1543431483, "post_id": 53525618, "comment_id": 93921422, "body": "@fbynite Not sure what horses have to do with this. Rewriting 50 lines of code takes time, solves no one&#39;s problem without detailed in-person explanations, and won&#39;t even be noted by anyone in this downvoted answer to a pseudo-duplicate question. If you disagree, feel free to contribute your own answer, of course!"}, {"owner": {"reputation": 9, "user_id": 10691344, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/298ad9312376a5a8fe3153a7389afb75?s=128&d=identicon&r=PG&f=1", "display_name": "Oof", "link": "https://stackoverflow.com/users/10691344/oof"}, "edited": false, "score": 0, "creation_date": 1543432145, "post_id": 53525618, "comment_id": 93921773, "body": "idk why you&#39;d be flaming my code if you won&#39;t tell me whats wrong thats just bs"}, {"owner": {"reputation": 9056, "user_id": 318964, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/f2df406df36a856e16aa7f75b7185550?s=128&d=identicon&r=PG", "display_name": "KT.", "link": "https://stackoverflow.com/users/318964/kt"}, "reply_to_user": {"reputation": 9, "user_id": 10691344, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/298ad9312376a5a8fe3153a7389afb75?s=128&d=identicon&r=PG&f=1", "display_name": "Oof", "link": "https://stackoverflow.com/users/10691344/oof"}, "edited": false, "score": 0, "creation_date": 1543432400, "post_id": 53525618, "comment_id": 93921899, "body": "@Oof please, read the second comment to this answer for a tentative list of things, that are wrong with the code. I do not &quot;flame your code&quot;, whatever it means. I simply suggested you consider sitting down with someone more experienced to go over it with you. I do not mean to offend, this is a sincere advice which, I am convinced, would help you more than simply fixing the bug with the <code>return</code> statement."}, {"owner": {"reputation": 2653, "user_id": 1028434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a340b89a8b4efdb83da69d6cc93caac7?s=128&d=identicon&r=PG", "display_name": "fdk1342", "link": "https://stackoverflow.com/users/1028434/fdk1342"}, "reply_to_user": {"reputation": 9, "user_id": 10691344, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/298ad9312376a5a8fe3153a7389afb75?s=128&d=identicon&r=PG&f=1", "display_name": "Oof", "link": "https://stackoverflow.com/users/10691344/oof"}, "edited": false, "score": 0, "creation_date": 1543447514, "post_id": 53525618, "comment_id": 93927804, "body": "@Oof Some of the criticisms is based on things that may not have been covered yet in class (assuming that I understood correctly).  Usually structs are passed as pointers (reducing the number of variables that are used).  Also structs can be assigned to each other instead of assigning each element.  I would suggest that compiling with warnings enabled (i.e. -Wall with gcc) would be beneficial because it would have caught the missing return statement.  In practice you also need to check the return values of the stdio functions (scanf) to ensure they are working correctly / as expected."}], "tags": [], "owner": {"reputation": 9056, "user_id": 318964, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/f2df406df36a856e16aa7f75b7185550?s=128&d=identicon&r=PG", "display_name": "KT.", "link": "https://stackoverflow.com/users/318964/kt"}, "is_accepted": false, "score": -1, "last_activity_date": 1543429197, "last_edit_date": 1543429197, "creation_date": 1543428665, "answer_id": 53525618, "question_id": 53525466, "link": "https://stackoverflow.com/questions/53525466/c-structs-in-calculations/53525618#53525618", "title": "C Structs in calculations", "body": "<p>There is a bug in your code. Add</p>\n\n<pre><code>return s;\n</code></pre>\n\n<p>to the end of your <code>calculate_segment_v1</code> function to fix it.</p>\n\n<p>PS: I can't help but digress to note that the code you have posted is rather bad in a number of respects besides this particular bug. If this is something that you have written while learning to code, please consider changing the learning path you have been taking so far.</p>\n"}], "owner": {"reputation": 9, "user_id": 10691344, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/298ad9312376a5a8fe3153a7389afb75?s=128&d=identicon&r=PG&f=1", "display_name": "Oof", "link": "https://stackoverflow.com/users/10691344/oof"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 170, "favorite_count": 0, "closed_date": 1543428657, "answer_count": 1, "score": 0, "last_activity_date": 1543429197, "creation_date": 1543428008, "last_edit_date": 1543428662, "question_id": 53525466, "link": "https://stackoverflow.com/questions/53525466/c-structs-in-calculations", "closed_reason": "Duplicate", "title": "C Structs in calculations", "body": "<p>I've got my Functions set up and Running, when i run the programm it just skips forward to the End, if i press Enter it asks me to enter values but calculates everything as 0.00.</p>\n\n<p>Im quiet certain its either within my\n       \"struct SEGMENT calculate_segment_v1(struct SEGMENT s)\" Function\nor the Function where one should enter the Values.</p>\n\n<p>Any help appreciated!</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\n\ndouble atan(double x);\n\nstruct POINT {\n    double x;\n    double y;\n};\n\nstruct SEGMENT {\n    struct POINT p1;\n    struct POINT p2;\n    double length;\n    double angle;\n};\n\ndouble distance_of_points(struct POINT p1, struct POINT p2)\n{\n    double length;\n    length = sqrt(pow((p1.x - p2.x), 2) + pow((p1.y - p2.y), 2));\n    return length;\n};\n\ndouble angle_x(struct POINT p1, struct POINT p2)\n{\n    double angle;\n    double berechnung;\n    berechnung=(pow((p1.x - p2.x), 2)/(pow((p1.y - p2.y), 2)));\n    angle = atan(berechnung);\n    return angle;\n}\n\nvoid print_segment(struct SEGMENT s)\n{\n    printf(\"\\n--&gt; Die Strecke verbindet die Punkte\"\n           \" (%.2f,%.2f) und (%.2f,%.2f);\\n\"\n           \"--&gt; Sie hat eine Laenge von %.4f;\\n\"\n           \"--&gt; Der Winkel betraegt: %.2f Grad.\\n\\n\",\n           s.p1.x, s.p1.y, s.p2.x, s.p2.y, s.length, s.angle);\n}\n\nstruct SEGMENT read_segment_v1()\n{\n    struct SEGMENT s;\n    printf(\"&gt;&gt; Bitte Koordinaten x,y des ersten\"\n           \" Punktes der Strecke eingeben: \");\n    scanf (\"%lf%lf\", &amp;s.p1.x, &amp;s.p1.y);\n    printf(\"&gt;&gt; Bitte Koordinaten x,y des zweiten\"\n           \" Punktes der Strecke eingeben: \");\n    scanf (\"%lf%lf\", &amp;s.p2.x, &amp;s.p2.y);\n    return s;\n}\n\nstruct SEGMENT calculate_segment_v1(struct SEGMENT s)\n{\n    struct POINT X={s.p1.x, s.p1.y}, Y={s.p2.x ,s.p2.y};\n    s.length = distance_of_points(X, Y);\n    s.angle = angle_x(X, Y);\n}\n\nint main(void)\n{\n    struct SEGMENT S;\n    char c;\n    double l;\n\n    while (1) {\n        printf(\"Bitte # eingeben fuer Programmende: \");\n        fflush(stdin);\n        scanf (\"%c\", &amp;c);\n\n        if (c=='#') break;\n\n        S = read_segment_v1();\n        S = calculate_segment_v1(S);\n        print_segment(S);\n    }\n\n    printf(\"Ende des Programms\\n\");\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "sockets", "networking", "packet", "bsd"], "comments": [{"owner": {"reputation": 1189, "user_id": 9232218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ced53adbb0ba08d1cea65a43b124d?s=128&d=identicon&r=PG&f=1", "display_name": "Yastanub", "link": "https://stackoverflow.com/users/9232218/yastanub"}, "edited": false, "score": 3, "creation_date": 1543426748, "post_id": 53525113, "comment_id": 93919219, "body": "Please provide a <a href=\"https://stackoverflow.com/help/mcve\">Minimal Complete and verificable example</a>. If you know where the error might be isolate that piece of code and do not post the whole wall in here."}, {"owner": {"reputation": 1440, "user_id": 7973906, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/54a6d0e27146b174dd6a6c3cb5e54392?s=128&d=identicon&r=PG&f=1", "display_name": "j3141592653589793238", "link": "https://stackoverflow.com/users/7973906/j3141592653589793238"}, "reply_to_user": {"reputation": 1189, "user_id": 9232218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ced53adbb0ba08d1cea65a43b124d?s=128&d=identicon&r=PG&f=1", "display_name": "Yastanub", "link": "https://stackoverflow.com/users/9232218/yastanub"}, "edited": false, "score": 0, "creation_date": 1543426809, "post_id": 53525113, "comment_id": 93919249, "body": "I thought about that. And I really don&#39;t know where the error might be. I didn&#39;t post the whole piece of code. But when searching the web for the sendto error msg, I already read about everything. Might have to do with the socket creation or with the packet itself, and that&#39;s nearly everything. In other words, if you have an idea how to narrow down the potential problem, please let me know."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 3, "creation_date": 1543428409, "post_id": 53525113, "comment_id": 93919971, "body": "No, it&#39;s not a good idea to define sockaddr_ll in your own code. If your system doesn&#39;t provide a definition, it is probably not supported."}, {"owner": {"reputation": 1189, "user_id": 9232218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ced53adbb0ba08d1cea65a43b124d?s=128&d=identicon&r=PG&f=1", "display_name": "Yastanub", "link": "https://stackoverflow.com/users/9232218/yastanub"}, "edited": false, "score": 0, "creation_date": 1543428506, "post_id": 53525113, "comment_id": 93920011, "body": "Okay i looked a bit around and maybe your problem is your custom <code>sockaddr_ll</code> structure? I do not know very much about POSIX sockets and such but wherefrom  does <code>sendto</code> know how to evaluate your data? <a href=\"http://pubs.opengroup.org/onlinepubs/7908799/xns/syssocket.h.html\" rel=\"nofollow noreferrer\">Here</a> it says what minimum data should be included in a <code>sockaddr</code> structure"}, {"owner": {"reputation": 1440, "user_id": 7973906, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/54a6d0e27146b174dd6a6c3cb5e54392?s=128&d=identicon&r=PG&f=1", "display_name": "j3141592653589793238", "link": "https://stackoverflow.com/users/7973906/j3141592653589793238"}, "reply_to_user": {"reputation": 1189, "user_id": 9232218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ced53adbb0ba08d1cea65a43b124d?s=128&d=identicon&r=PG&f=1", "display_name": "Yastanub", "link": "https://stackoverflow.com/users/9232218/yastanub"}, "edited": false, "score": 0, "creation_date": 1543429259, "post_id": 53525113, "comment_id": 93920358, "body": "@Yastanub Shouldn&#39;t that work anyways? I&#39;m now casting a <i>sockaddr_dl</i> to a <i>sockaddr</i>. Their first member is an unsigned char, then follows the family (see above)."}, {"owner": {"reputation": 23069, "user_id": 156811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/380335e95e6be9740e56b64d667279b3?s=128&d=identicon&r=PG", "display_name": "Havenard", "link": "https://stackoverflow.com/users/156811/havenard"}, "edited": false, "score": 0, "creation_date": 1543430475, "post_id": 53525113, "comment_id": 93920930, "body": "Why is the destination and source MAC the same? I don&#39;t think something like this would actually go through the network adapter, perhaps you should try packeting a different device. Also, is <code>sock_r</code> valid? As you should know <code>SOCK_RAW</code> requires root access, perhaps your code is failing not at the <code>sendto()</code> where you finally decide to check errors, but at the very first thing you do."}, {"owner": {"reputation": 1440, "user_id": 7973906, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/54a6d0e27146b174dd6a6c3cb5e54392?s=128&d=identicon&r=PG&f=1", "display_name": "j3141592653589793238", "link": "https://stackoverflow.com/users/7973906/j3141592653589793238"}, "reply_to_user": {"reputation": 23069, "user_id": 156811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/380335e95e6be9740e56b64d667279b3?s=128&d=identicon&r=PG", "display_name": "Havenard", "link": "https://stackoverflow.com/users/156811/havenard"}, "edited": false, "score": 0, "creation_date": 1543430618, "post_id": 53525113, "comment_id": 93921001, "body": "<code>I run the program with sudo rights.</code> <code>Don&#39;t worry about error checking, I left that out due to the piece of code already being very large</code>. Yes, the socket is valid and I just removed the error checking from this piece of code. Changing the destination did not change anything. @Havenard"}, {"owner": {"reputation": 23069, "user_id": 156811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/380335e95e6be9740e56b64d667279b3?s=128&d=identicon&r=PG", "display_name": "Havenard", "link": "https://stackoverflow.com/users/156811/havenard"}, "edited": false, "score": 1, "creation_date": 1543431079, "post_id": 53525113, "comment_id": 93921231, "body": "Have you tried to dump the packet you generated and compare it with a sample of the real thing you captured with Wireshark to see if you spot anything missing?  For example, <code>saddr_dl</code> has quite a few properties that you are not bothering to set, like <code>sdl_type</code>, <code>sdl_nlen</code> and <code>sdl_slen</code>."}, {"owner": {"reputation": 1440, "user_id": 7973906, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/54a6d0e27146b174dd6a6c3cb5e54392?s=128&d=identicon&r=PG&f=1", "display_name": "j3141592653589793238", "link": "https://stackoverflow.com/users/7973906/j3141592653589793238"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1543432378, "post_id": 53525113, "comment_id": 93921885, "body": "@user3629249 Sure it doesn&#39;t. It&#39;s just an excerpt. F.ex., I left out the header files as I stated in the question. Please don&#39;t denounce me before at least having read the whole question. How does this comment help anyone? Do you want me to post the whole program with all its pieces?"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1543432716, "post_id": 53525113, "comment_id": 93922037, "body": "for us to help you, we need to be able to reproduce the problem.  We are not mind readers (at least most of us are not) so we can only guess as to the parts of the code that you have not posted."}, {"owner": {"reputation": 1440, "user_id": 7973906, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/54a6d0e27146b174dd6a6c3cb5e54392?s=128&d=identicon&r=PG&f=1", "display_name": "j3141592653589793238", "link": "https://stackoverflow.com/users/7973906/j3141592653589793238"}, "edited": false, "score": 0, "creation_date": 1543433006, "post_id": 53525113, "comment_id": 93922163, "body": "I still don&#39;t get you. This program is intended to run on OSX. Usually, one only posts the relevant lines of code to provide a minimal complete and verifiable example. At least that&#39;s what stackoverflow recommends. So are you complaining about the missing include statements only? Do you miss the error checking? Doesn&#39;t that even quite depend on the OS?"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1543433032, "post_id": 53525113, "comment_id": 93922179, "body": "regarding: <code>packet = (unsigned char *) malloc(PKT_SIZ);     memset(packet, 0, PKT_SIZ);</code>  1) in C,  the returned type is <code>void*</code> which can be assigned to any pointer.  Casting just clutters the code, making it more difficult to understand, debug, etc.  2) always check (!=NULL) the returned value to assure the operation was successful.  3) much better to use the heap allocation function: <code>calloc()</code> as that both allocates the memory and sets it to 0x00."}, {"owner": {"reputation": 1440, "user_id": 7973906, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/54a6d0e27146b174dd6a6c3cb5e54392?s=128&d=identicon&r=PG&f=1", "display_name": "j3141592653589793238", "link": "https://stackoverflow.com/users/7973906/j3141592653589793238"}, "edited": false, "score": 0, "creation_date": 1543433349, "post_id": 53525113, "comment_id": 93922321, "body": "Sorry, but how serious are you? How unclear is a sentence like <code>Don&#39;t worry about error checking, I left that out due to the piece of code already being very large.</code>. Why is it much better to use calloc instead of malloc? Just below <code>malloc</code>, I use memset to ensure everything is set to 0."}, {"owner": {"reputation": 1440, "user_id": 7973906, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/54a6d0e27146b174dd6a6c3cb5e54392?s=128&d=identicon&r=PG&f=1", "display_name": "j3141592653589793238", "link": "https://stackoverflow.com/users/7973906/j3141592653589793238"}, "reply_to_user": {"reputation": 23069, "user_id": 156811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/380335e95e6be9740e56b64d667279b3?s=128&d=identicon&r=PG", "display_name": "Havenard", "link": "https://stackoverflow.com/users/156811/havenard"}, "edited": false, "score": 0, "creation_date": 1543434873, "post_id": 53525113, "comment_id": 93923049, "body": "@Havenard Thanks, I now compared a real packet with my own one, the only thing missing is the UDP checksum."}, {"owner": {"reputation": 1440, "user_id": 7973906, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/54a6d0e27146b174dd6a6c3cb5e54392?s=128&d=identicon&r=PG&f=1", "display_name": "j3141592653589793238", "link": "https://stackoverflow.com/users/7973906/j3141592653589793238"}, "edited": false, "score": 0, "creation_date": 1543437688, "post_id": 53525113, "comment_id": 93924293, "body": "Even after calculating the checksum and setting the missing properties, I still get an &quot;Invalid argument&quot; error."}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 2, "creation_date": 1543482844, "post_id": 53525113, "comment_id": 93938389, "body": "<code>socket(PF_INET, SOCK_RAW, IPPROTO_RAW);</code> gives you access to IP level.  To access the ethernet level, in linux, you need to use <code>PF_PACKET</code> and  get a socket of type <code>socket(PF_PACKET, SOCK_RAW, SOCK_DATAGRAM);</code>.  I&#39;m afraid you are formatting an ethernet packet on top of an IP datagram.  See <b>packet(7)</b> for documentation on this kind of sockets.  Also, checking for errors in <b>every</b> system call is a good idea."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1543496760, "post_id": 53525113, "comment_id": 93946490, "body": "Do you have any working program that can produce such packets? Try to <code>strace</code> it and your program side by side and see if calls to <code>sendo</code> differ. (May or may not work)"}, {"owner": {"reputation": 1440, "user_id": 7973906, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/54a6d0e27146b174dd6a6c3cb5e54392?s=128&d=identicon&r=PG&f=1", "display_name": "j3141592653589793238", "link": "https://stackoverflow.com/users/7973906/j3141592653589793238"}, "edited": false, "score": 0, "creation_date": 1543499046, "post_id": 53525113, "comment_id": 93947800, "body": "I, unfortunately, don&#39;t have such a program afaik."}], "answers": [{"comments": [{"owner": {"reputation": 1440, "user_id": 7973906, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/54a6d0e27146b174dd6a6c3cb5e54392?s=128&d=identicon&r=PG&f=1", "display_name": "j3141592653589793238", "link": "https://stackoverflow.com/users/7973906/j3141592653589793238"}, "edited": false, "score": 0, "creation_date": 1543489371, "post_id": 53535470, "comment_id": 93942457, "body": "Thanks for your efforts; I edited my question again to provide a complete example which is working out of the box. I hesitated to post the complete example because of the first comment that told me somehow to narrow the problem which seemed comprehensible to me. However, the socket is definitely created successfully, I don&#39;t just assume that the call went fine, I just didn&#39;t include the error checking in the question. <code>PF_PACKET</code> is not defined on FreeBSD/OSX systems and creating a socket with <code>AF_LINK</code> and <code>SOCK_DGRAM</code> as protocol does not work either (EAFNOSUPPORT)."}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "reply_to_user": {"reputation": 1440, "user_id": 7973906, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/54a6d0e27146b174dd6a6c3cb5e54392?s=128&d=identicon&r=PG&f=1", "display_name": "j3141592653589793238", "link": "https://stackoverflow.com/users/7973906/j3141592653589793238"}, "edited": false, "score": 0, "creation_date": 1543492303, "post_id": 53535470, "comment_id": 93943993, "body": "Well, there&#39;s no <code>PF_PACKET</code> in FreeBSD because that socket type is not supported in FreeBSD.  You need to look for an alternative (try using a <code>tun</code> or <code>tap</code> interface."}, {"owner": {"reputation": 1440, "user_id": 7973906, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/54a6d0e27146b174dd6a6c3cb5e54392?s=128&d=identicon&r=PG&f=1", "display_name": "j3141592653589793238", "link": "https://stackoverflow.com/users/7973906/j3141592653589793238"}, "edited": false, "score": 0, "creation_date": 1543493640, "post_id": 53535470, "comment_id": 93944750, "body": "Uh, I can&#39;t access the Ethernet layer in C on Mac OSX?"}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "reply_to_user": {"reputation": 1440, "user_id": 7973906, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/54a6d0e27146b174dd6a6c3cb5e54392?s=128&d=identicon&r=PG&f=1", "display_name": "j3141592653589793238", "link": "https://stackoverflow.com/users/7973906/j3141592653589793238"}, "edited": false, "score": 1, "creation_date": 1543564561, "post_id": 53535470, "comment_id": 93972297, "body": "yes, you can, but I think you cannot from the socket interface.  You need to inject the packets through other, different means.  I&#39;ll check and comeback if I find the way."}, {"owner": {"reputation": 1440, "user_id": 7973906, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/54a6d0e27146b174dd6a6c3cb5e54392?s=128&d=identicon&r=PG&f=1", "display_name": "j3141592653589793238", "link": "https://stackoverflow.com/users/7973906/j3141592653589793238"}, "edited": false, "score": 1, "creation_date": 1543594618, "post_id": 53535470, "comment_id": 93988038, "body": "I actually just found a solution using BPF (<a href=\"https://en.wikipedia.org/wiki/Berkeley_Packet_Filter\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Berkeley_Packet_Filter</a>). I&#39;ll post my solution as it works correctly, currently having problems with the Ethernet checksum calculation. I kind of followed this article: <a href=\"https://www.vankuik.nl/2012-02-09_Writing_ethernet_packets_on_OS_X_and_BSD\" rel=\"nofollow noreferrer\">vankuik.nl/2012-02-09_Writing_ethernet_packets_on_OS_X_and_B&zwnj;&#8203;SD</a>"}, {"owner": {"reputation": 1440, "user_id": 7973906, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/54a6d0e27146b174dd6a6c3cb5e54392?s=128&d=identicon&r=PG&f=1", "display_name": "j3141592653589793238", "link": "https://stackoverflow.com/users/7973906/j3141592653589793238"}, "edited": false, "score": 0, "creation_date": 1543681143, "post_id": 53535470, "comment_id": 94009815, "body": "Still having problems with calculating the FCS checksum. I am using the CRC32 function from here <a href=\"http://www.hackersdelight.org/hdcodetxt/crc.c.txt\" rel=\"nofollow noreferrer\">hackersdelight.org/hdcodetxt/crc.c.txt</a>. I pass the whole <code>packet</code> as parameter. UDP and IP checksums are calculated <i>before</i> the FCS. My FCS result is <code>0x0ef1ee1e</code>, Wireshark tells me this is incorrect and provides the following FCS: <code>0x8bc02121</code>. This is the packet (whole ethernet frame as hex stream): <code>e0d55ec6529a784f4360b7f108004510002127d90000401152e4c0a8b217&zwnj;&#8203;c0a8b2255b9b5b9c000d&zwnj;&#8203;b214aabbccddee000000&zwnj;&#8203;00000000000000000000&zwnj;&#8203;0ef1ee1e</code>. I don&#39;t know where the issue is. @LuisColorado"}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "reply_to_user": {"reputation": 1440, "user_id": 7973906, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/54a6d0e27146b174dd6a6c3cb5e54392?s=128&d=identicon&r=PG&f=1", "display_name": "j3141592653589793238", "link": "https://stackoverflow.com/users/7973906/j3141592653589793238"}, "edited": false, "score": 0, "creation_date": 1543709580, "post_id": 53535470, "comment_id": 94016697, "body": "@T.Meyer, the ethernet addresses of you sample avobe don&#39;t match the addresses you use in the source code... Is that right?  Above you use <code>e0:d5:5e:c6:52:9a</code> and <code>78:4f:43:60:b7:f1</code>.  Can be this?  where is the code you use to calculate the CRC?  Why do you ask me about the CRC? I have said nothing about the CRC calculation."}], "tags": [], "owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "is_accepted": false, "score": 1, "last_activity_date": 1543483969, "last_edit_date": 1543483969, "creation_date": 1543483060, "answer_id": 53535470, "question_id": 53525113, "link": "https://stackoverflow.com/questions/53525113/why-does-sendto-return-invalid-argument/53535470#53535470", "title": "Why does sendto() return &#39;Invalid argument&#39;?", "body": "<p><code>socket(PF_INET, SOCK_RAW, IPPROTO_RAW);</code> gives you access to IP level.  To access the ethernet level, in linux, you need to use <code>PF_PACKET</code> and  get a socket of type <code>socket(PF_PACKET, SOCK_RAW, SOCK_DATAGRAM);</code>.  </p>\n\n<p>I'm afraid you are formatting an ethernet packet on top of an IP datagram.  See <strong>packet(7)</strong> for documentation on this kind of sockets. </p>\n\n<p>Also, checking for errors in <strong>every</strong> system call is definitely a good idea.  This can be a good way for you to get what is going on underneath.</p>\n\n<p>Also, if you send a packet to you (dest ethernet address is the same as source ethernet address) you'll never get your packet back to you.  The software should detect that the target and source addresses are the same before sending this kind of packet.  As all systems try to not consume bandwidth, normally ethernet cards will broadcast your packet out.  But not so many ethernets listen to the ethernet while they are sending packets.  You can finish deceived by such a behaviour, but that's the common way of doing things (don't send out a packet that is directed to you).</p>\n\n<p>The most probable cause for the <code>EINVAL</code> error, is probably that you are pasing <code>-1</code> as the socket parameter, just because you assume your <code>socket(2)</code> call went fine, but it didn't, and you think you don't need to check errors there.  But you are formatting an ethernet packet in the payload of an IP pdu.  There are many things that can go wrong with that.  Probably the <code>sockaddr</code> you are passing to the socket interface are invalid, wrong length, wrong internal format.  All of this departs from an invalid protocol family, that makes you to receive a wrong socket type, or even worse, an error.</p>\n\n<p>Another thing: don't hesitate to post a <a href=\"https://stackoverflow.com/help/mcve\">complete (with all the headers you used) and <em><strong>out of the box</strong></em> verifiable example</a>.  This is a must to follow.  You can have used the wrong header files, and that can be a source or errors, but we will not know, if you cut them before posting.  Better if you add even the <code>Makefile</code> used to build the example.  This way no one can say <em>Well, I tried your example code, but it doesn't even compile</em>.  And you save work to all of us, that have first to repair your code into some kind of usable code, probably correcting your mistake in the way.  You are assuming in your explanation that you have done all things right, so you think you don't need to post uninteresting data, like header files, or the like, and you are adding mistakes over mistakes, making debugging your code completely impossible.</p>\n"}, {"tags": [], "owner": {"reputation": 1440, "user_id": 7973906, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/54a6d0e27146b174dd6a6c3cb5e54392?s=128&d=identicon&r=PG&f=1", "display_name": "j3141592653589793238", "link": "https://stackoverflow.com/users/7973906/j3141592653589793238"}, "is_accepted": false, "score": 1, "last_activity_date": 1544539095, "creation_date": 1544539095, "answer_id": 53726439, "question_id": 53525113, "link": "https://stackoverflow.com/questions/53525113/why-does-sendto-return-invalid-argument/53726439#53726439", "title": "Why does sendto() return &#39;Invalid argument&#39;?", "body": "<p>After having problems with calculating the checksums, I finally found a solution using <a href=\"https://en.wikipedia.org/wiki/Berkeley_Packet_Filter\" rel=\"nofollow noreferrer\">Berkeley Packet Filters</a>. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;         \n#include &lt;stdbool.h&gt;        \n#include &lt;string.h&gt;         \n#include &lt;stdint.h&gt;\n#include &lt;sys/socket.h&gt;    \n#include &lt;sys/types.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;netinet/in.h&gt;    \n#include &lt;netinet/ip.h&gt;\n#include &lt;netinet/ip_icmp.h&gt;\n#include &lt;netinet/in_systm.h&gt;\n#include &lt;arpa/inet.h&gt;\n#include &lt;netdb.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;netinet/if_ether.h&gt;\n#include &lt;sys/sockio.h&gt;\n#include &lt;net/if.h&gt;\n#include &lt;sys/ioctl.h&gt;\n#include &lt;net/if_dl.h&gt;\n#include &lt;ifaddrs.h&gt;\n#include &lt;net/ethernet.h&gt;\n#include &lt;net/bpf.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;sys/stat.h&gt;\n#include &lt;netinet/udp.h&gt;\n\n#define INTERFACE   \"en0\"\n#define DESTMAC     \"ED:5B:B6:29:43:D5\"\n#define SRCMAC      \"5E:F1:28:36:5E:DB\"\n#define DESTIP      \"192.168.178.27\" \n#define DESTPORT    23455\n#define SRCPORT     23456\n</code></pre>\n\n<h2>Checksum functions</h2>\n\n<pre><code>uint32_t crc32(const void *m, size_t len) \n{\n    const unsigned char *message = m;\n    size_t i;\n    int j;\n    unsigned int byte, crc, mask;\n\n    i = 0;\n    crc = 0xFFFFFFFF;\n    while (i &lt; len) {\n        byte = message[i];            // Get next byte.\n        crc = crc ^ byte;\n        for (j = 7; j &gt;= 0; j--) {    // Do eight times.\n            mask = -(crc &amp; 1);\n            crc = (crc &gt;&gt; 1) ^ (0xEDB88320 &amp; mask);\n        }\n        i = i + 1;\n    }\n    return ~crc;\n}\nuint32_t eth_cks(const void *data, size_t frame_len)\n{\n    if (data == NULL) return 0;\n    const unsigned char * const eth_frame = data;\n    char str[(frame_len - 4) * 2 + 1];      // +1 for null terminator.\n    memset(str, 0, (frame_len - 4) * 2 + 1);\n    for (int i = 0; i &lt; (frame_len - 4) * 2; i += 2)\n        sprintf(&amp;str[i], \"%02x\", eth_frame[i / 2]);\n    size_t len = strlen(str), len2 = (len + 1) / 2;\n    unsigned char arr2[len2];\n    for (size_t i = 0; i &lt; len; i += 2)\n        arr2[i / 2] = strtoul((char[3]) {str[i], str[i + 1], '\\0'}, 0, 16);\n    return crc32(arr2, len2);\n}\n\nuint16_t ip4_cks(const void *vdata, size_t length) \n{\n    // Cast the data pointer to one that can be indexed.\n    char* data = (char *)vdata;\n\n    // Initialise the accumulator.\n    uint64_t acc = 0xffff;\n\n    // Handle any partial block at the start of the data.\n    unsigned int offset = ((uintptr_t)data)&amp;3;\n    if (offset) \n    {\n        size_t count = 4 - offset;\n        if (count &gt; length) count = length;\n        uint32_t word = 0;\n        memcpy(offset + (char *)&amp;word, data, count);\n        acc += ntohl(word);\n        data += count;\n        length -= count;\n    }\n\n    // Handle any complete 32-bit blocks.\n    char* data_end = data + (length &amp;~3);\n    while (data != data_end) \n    {\n        uint32_t word;\n        memcpy(&amp;word, data, 4);\n        acc += ntohl(word);\n        data += 4;\n    }\n    length &amp;= 3;\n\n    // Handle any partial block at the end of the data.\n    if (length) \n    {\n        uint32_t word = 0;\n        memcpy(&amp;word, data, length);\n        acc += ntohl(word);\n    }\n\n    // Handle deferred carries.\n    acc = (acc &amp; 0xffffffff) + (acc &gt;&gt; 32);\n    while (acc &gt;&gt; 16) \n        acc = (acc &amp; 0xffff) + (acc &gt;&gt; 16);\n\n    // If the data began at an odd byte address\n    // then reverse the byte order to compensate.\n    if (offset&amp;1)\n        acc = ((acc &amp; 0xff00) &gt;&gt; 8) | ((acc &amp; 0x00ff) &lt;&lt; 8);\n\n    // Return the checksum in network byte order.\n    return htons(~acc);\n}\n\nuint16_t udp_cks(struct udphdr *p_udp_header, size_t len, uint32_t src_addr, uint32_t dest_addr)\n{\n    const uint16_t *buf = (const uint16_t *)p_udp_header;\n    uint16_t *ip_src = (void *)&amp;src_addr, *ip_dst = (void *)&amp;dest_addr;\n    uint32_t sum;\n    size_t length = len;\n\n    // Calculate the sum\n    sum = 0;\n    while (len &gt; 1)\n    {\n        sum += *buf++;\n        if (sum &amp; 0x80000000)\n            sum = (sum &amp; 0xFFFF) + (sum &gt;&gt; 16);\n        len -= 2;\n    }\n\n    if (len &amp; 1)\n        // Add the padding if the packet lenght is odd\n        sum += *((uint8_t*)buf);\n\n    // Add the pseudo-header\n    sum += *(ip_src++);\n    sum += *ip_src;\n\n    sum += *(ip_dst++);\n    sum += *ip_dst;\n\n    sum += htons(IPPROTO_UDP);\n    sum += htons(length);\n\n    // Add the carries\n    while (sum &gt;&gt; 16)\n        sum = (sum &amp; 0xFFFF) + (sum &gt;&gt; 16);\n\n    // Return the one's complement of sum\n    return (uint16_t)~sum;\n}\n</code></pre>\n\n<h2>We'll create the packet in our main function.</h2>\n\n<pre><code>int main(int argc, char **argv)\n{\n    int bpf_f = 0;\n    struct ifreq ifreq_ip = { {0} }, ifreq_bpf = { {0} };\n    unsigned char *packet;\n    struct ether_header *eth;\n    struct ifaddrs *ifaddr = NULL;\n    unsigned int pckt_len = 0, if_c = 0;\n    uint32_t *fcs;\n\n    if (!(packet = malloc(PKT_SIZ)))\n    {\n        perror(\"Could not allocate memory for packet\");\n        exit(EXIT_FAILURE);\n    }\n    memset(packet, 0, PKT_SIZ);\n    fcs = (uint32_t *)(packet + PKT_SIZ - SIZEOF_UINT32_T);\n</code></pre>\n\n<p>We now search for an available <em>bpf</em> device that is both <em>readable</em> and <em>writable</em>.</p>\n\n<pre><code>    char buf[11] = { 0 };\n    for (int ext = 1; ext &lt; 99; ++ext)\n    {\n        sprintf(buf, \"/dev/bpf%i\", ext);\n        if ((bpf_f = open(buf, O_RDWR)) != -1)\n            break;\n    }\n    if (!bpf_f) \n    {\n        fprintf(stderr, \"Could not open BPF device.\\n\");\n        exit(EXIT_FAILURE);\n    }\n\n    // Bind BPF to physical device.\n    // Copy the interface name to the request.\n    strcpy(ifreq_bpf.ifr_name, ifaddr-&gt;ifa_name);\n    if (ioctl(bpf_f, BIOCSETIF, &amp;ifreq_bpf) == -1) \n    {\n        perror(\"Could not bind BPF to physical device\");\n        exit(EXIT_FAILURE);\n    }\n</code></pre>\n\n<p>Now, one could also disable the automatic header completion of the source MAC address. In order to do so, have a look at the <em>IOCTLs</em> of <em>bpf</em> (especially <code>BIOCGHDRCMPLT</code> and it's <em>set</em> counterpart).</p>\n\n<h2>Ethernet Header Construction</h2>\n\n<pre><code>    eth = (struct ether_header *)packet;\n\n    // Copy the Source (local) NIC MAC address to the packet (ethernet header). It's already in network format. \n    memcpy(eth-&gt;ether_shost, ether_aton(SRCMAC)-&gt;octet, ETHER_ADDR_LEN);\n\n    // Copy the destination NIC MAC address to the packet (ethernet header). \n    // ether_aton converts a human-readable NIC MAC to network format.\n</code></pre>\n\n<p>At the time, this only works for local addresses. We don't check whether the specified IP address is part of the subnet.</p>\n\n<pre><code>    memcpy(eth-&gt;ether_dhost, ether_aton(DESTMAC)-&gt;octet, ETHER_ADDR_LEN);\n\n    // Specifiy the ethernet overlaying type.\n    eth-&gt;ether_type = htons(ETHERTYPE_IP);\n\n    printf(\"Source MAC: %s\\n\", ether_ntoa((const struct ether_addr *)eth-&gt;ether_shost));\n    printf(\"Desti. MAC: %s\\n\", ether_ntoa((const struct ether_addr *)eth-&gt;ether_dhost));\n    printf(\"Eth Type: 0x%x%s\\n\", ntohs(eth-&gt;ether_type), ntohs(eth-&gt;ether_type) == ETHERTYPE_IP ? \" (IP)\" : \"\");\n\n    // Get IF assigned IP address. \n    strncpy(ifreq_ip.ifr_name, ifreq_bpf.ifr_name, IFNAMSIZ - 1);\n\n    in_socket_t sock; \n    if ((sock = socket(AF_INET, SOCK_DGRAM, 0)) == -1) \n    {\n        perror(\"Could not create socket\");\n        exit(EXIT_FAILURE);\n    }\n#if defined(SIOCGIFADDR)\n    if (ioctl(sock, SIOCGIFADDR, &amp;ifreq_ip) == -1)\n    {\n        fprintf(stderr, \"Could not get IP address for interface %s: %s\\n\", ifreq_ip.ifr_name, strerror(errno));\n    }\n#else \n#error \"Not yet implemented\"\n#endif\n    close(sock);\n\n    pckt_len += sizeof(*eth);\n</code></pre>\n\n<h2>IP Header Construction</h2>\n\n<pre><code>    struct ip *iph = (struct ip *)(packet + pckt_len);\n    iph-&gt;ip_hl = sizeof(struct ip) &gt;&gt; 2;\n    iph-&gt;ip_v = IPVERSION;      // 4\n    iph-&gt;ip_tos = 16;\n    iph-&gt;ip_id = htons(10201);  // any unique ID.\n    iph-&gt;ip_ttl = 64;\n    iph-&gt;ip_p = IPPROTO_UDP;     // UDP (User datagram protocol)\n    iph-&gt;ip_src.s_addr = ((struct sockaddr_in *)&amp;ifreq_ip.ifr_ifru.ifru_addr)-&gt;sin_addr.s_addr;\n    if (!inet_aton(DESTIP, &amp;iph-&gt;ip_dst)) \n    {\n        perror(\"Could not interpret destination IP address\");\n        exit(EXIT_FAILURE);\n    }\n\n\n    // Calculate total packet length. \n    pckt_len += sizeof(*iph);\n\n    printf(\"Header length: %i\\n\", iph-&gt;ip_hl);\n    printf(\"Version      : %i%s\\n\", iph-&gt;ip_v, iph-&gt;ip_v == IPVERSION ? \" (IPv4)\" : \"\");\n    printf(\"Type of Serv.: %i\\n\", iph-&gt;ip_tos);\n    printf(\"Identificati.: %i\\n\", ntohs(iph-&gt;ip_id));\n    printf(\"Time to live : %i\\n\", iph-&gt;ip_ttl);\n    printf(\"Protocol     : %i%s\\n\", iph-&gt;ip_p, iph-&gt;ip_p == IPPROTO_UDP ? \" (UDP)\" : \"\");\n    printf(\"Source Addre.: %s%s\\n\", inet_ntoa(iph-&gt;ip_src), \" (local IP)\");\n    printf(\"Dest. Address: %s\\n\", inet_ntoa(iph-&gt;ip_dst));\n</code></pre>\n\n<h2>UDP Header Construction</h2>\n\n<pre><code>    struct udphdr *udph = (struct udphdr *)(packet + pckt_len);\n    udph-&gt;uh_sport = htons(SRCPORT);\n    udph-&gt;uh_dport = htons(DESTPORT);\n    udph-&gt;uh_sum = 0;\n\n    // Calculate total packet length. \n    pckt_len += sizeof(*udph);\n\n    // Actual UDP Payload: \n    packet[pckt_len++] = 0xAA;\n    packet[pckt_len++] = 0xBB;\n    packet[pckt_len++] = 0xCC;\n    packet[pckt_len++] = 0xDD;\n    packet[pckt_len++] = 0xEE;\n\n    // Fill out remaining length header fields: \n    // UDP length field\n    udph-&gt;uh_ulen = htons(pckt_len - sizeof(*iph) - sizeof(*eth));\n    // IP length field\n    iph-&gt;ip_len = htons(pckt_len - sizeof(*eth));\n</code></pre>\n\n<h2>Checksum calculations</h2>\n\n<pre><code>    // Finally, calculate the checksum.\n    iph-&gt;ip_sum = ip4_cks(packet + sizeof(*eth), sizeof(*iph));\n    udph-&gt;uh_sum = udp_cks(udph, ntohs(udph-&gt;uh_ulen), iph-&gt;ip_src.s_addr, iph-&gt;ip_dst.s_addr);\n    *fcs = eth_cks(packet, PKT_SIZ);\n\n    if (write(bpf_f, packet, PKT_SIZ) == -1) \n    {\n        perror(\"Could not write to bpf\");\n        exit(EXIT_FAILURE);\n    }\n\n    free(packet);\n    packet = NULL;\n    close(bpf_f);\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 1440, "user_id": 7973906, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/54a6d0e27146b174dd6a6c3cb5e54392?s=128&d=identicon&r=PG&f=1", "display_name": "j3141592653589793238", "link": "https://stackoverflow.com/users/7973906/j3141592653589793238"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1013, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1544539095, "creation_date": 1543426506, "last_edit_date": 1543490389, "question_id": 53525113, "link": "https://stackoverflow.com/questions/53525113/why-does-sendto-return-invalid-argument", "title": "Why does sendto() return &#39;Invalid argument&#39;?", "body": "<p>I wrote a tiny test program in order to send an own packet over a raw socket. <br>\nI'd like to create the packet from scratch. <br>\nThe target OS is FreeBSD/Mac OSX x86_64. <br>\nMy compiler is gcc with Apple LLVM 10.<br>\nI run the program with sudo rights. </p>\n\n<p>For some reason, sendto() always returns an \"Invalid argument\" error and I don't know why. I'd love to fix that issue. </p>\n\n<p>I set the <code>IP_HDRINCL</code> flag and bound to a specific network interface with a <code>bind</code> call. However, sendto does not seems to be happy with what it receives as packet. </p>\n\n<p>Anyways, this is how my piece of code looks so far: </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;         // EXIT_FAILURE EXIT_SUCCESS\n#include &lt;stdbool.h&gt;        // bool\n#include &lt;string.h&gt;         // strlen(), memcpy()\n#include &lt;sys/socket.h&gt;     // socket()\n#include &lt;sys/types.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;netinet/in.h&gt;     // IPPROTO_TCP\n#include &lt;netinet/ip.h&gt;\n#include &lt;netinet/ip_icmp.h&gt;\n#include &lt;netinet/in_systm.h&gt;\n#include &lt;arpa/inet.h&gt;\n#include &lt;netdb.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;netinet/if_ether.h&gt;\n#include &lt;sys/sockio.h&gt;\n#include &lt;net/if.h&gt;\n#include &lt;sys/ioctl.h&gt;\n#include &lt;net/if_dl.h&gt;\n#include &lt;ifaddrs.h&gt;\n#include &lt;net/ethernet.h&gt;\n#include &lt;netinet/udp.h&gt;\n\n\n#define DESTMAC     \"ed:5b:b6:29:43:d5\" \n#define DESTIP      \"192.168.178.25\" \n#define DESTPORT    23452\n#define SRCPORT     23451\n#define PKT_SIZ     64\n\n#ifndef AF_PACKET\n#   ifdef PF_LINK\n#       define AF_PACKET PF_LINK\n#   elif defined (AF_LINK)\n#       define AF_PACKET AF_LINK\n#   endif\n#endif\n\n\n\ntypedef int in_socket_t;\n\nuint16_t udp_checksum(struct udphdr *p_udp_header, size_t len, uint32_t src_addr, uint32_t dest_addr)\n{\n    const uint16_t *buf = (const uint16_t*)p_udp_header;\n    uint16_t *ip_src = (void*)&amp;src_addr, *ip_dst = (void*)&amp;dest_addr;\n    uint32_t sum;\n    size_t length = len;\n\n    // Calculate the sum\n    sum = 0;\n    while (len &gt; 1)\n    {\n        sum += *buf++;\n        if (sum &amp; 0x80000000)\n            sum = (sum &amp; 0xFFFF) + (sum &gt;&gt; 16);\n        len -= 2;\n    }\n\n    if (len &amp; 1)\n        // Add the padding if the packet lenght is odd\n        sum += *((uint8_t*)buf);\n\n    // Add the pseudo-header\n    sum += *(ip_src++);\n    sum += *ip_src;\n\n    sum += *(ip_dst++);\n    sum += *ip_dst;\n\n    sum += htons(IPPROTO_UDP);\n    sum += htons(length);\n\n    // Add the carries\n    while (sum &gt;&gt; 16)\n        sum = (sum &amp; 0xFFFF) + (sum &gt;&gt; 16);\n\n    // Return the one's complement of sum\n    return (uint16_t)~sum;\n}\n\nunsigned short checksum(unsigned short *buf, int _16bitword)\n{\n    unsigned long sum; \n    for (sum = 0; _16bitword &gt; 0; _16bitword--)\n        sum += htons(*(buf)++);\n    sum = ((sum &gt;&gt; 16) + (sum &amp; 0xFFFF));\n    sum += (sum &gt;&gt; 16);\n    return (unsigned short)~sum;\n}\n\nint main(int argc, const char **argv)\n{\n    in_socket_t sock_r;\n    struct ifreq ifreq_i = { 0 }, ifreq_c = { 0 }, ifreq_ip = { 0 };\n    unsigned char *packet = NULL;\n    struct ether_header *eth = NULL;\n    struct ifaddrs *ifaddr = NULL;\n    unsigned int if_c = 0, pckt_len = 0;\n    struct ether_addr *eth_daddr;\n    ssize_t send_len;\n    const int on_f = 1;\n\n    if ((packet = (unsigned char *) malloc(PKT_SIZ)) == NULL)\n    {\n        perror(\"Could not allocate packet memory\");\n        exit(EXIT_FAILURE);\n    }\n    memset(packet, 0, PKT_SIZ);\n\n    /// 1. Ethernet Header Construction\n    puts(\"PHASE 1: Ethernet Header Construction\");\n    eth = (struct ether_header *)packet;\n\n    if ((sock_r = socket(PF_INET, SOCK_RAW, IPPROTO_RAW)) == -1)\n    {\n        perror(\"Could not create socket\");\n        exit(EXIT_FAILURE);\n    }\n\n    if (setsockopt(sock_r, IPPROTO_IP, IP_HDRINCL, &amp;on_f, sizeof(on_f)) == -1)\n    {\n        perror(\"Could not request manually including header within data\");\n        exit(EXIT_FAILURE);\n    }\n\n    // Get IF Index\n    strncpy(ifreq_i.ifr_name, \"en7\", IFNAMSIZ - 1);\n#if !defined(SIOCGIFNAME)\n    if (!(ifreq_i.ifr_intval = if_nametoindex(ifreq_i.ifr_name)))\n    {\n        fprintf(stderr, \"Could not get interface name for interface %s: %s\\n\", ifreq_i.ifr_name, strerror(errno));\n        exit(EXIT_FAILURE);\n    }\n#else \n#error \"Not yet implemented.\"\n#endif\n\n    // Get IF MAC Address.\n    strncpy(ifreq_c.ifr_name, ifreq_i.ifr_name, IFNAMSIZ - 1);\n#ifndef SIOCGIFHWADDR\n    if (getifaddrs(&amp;ifaddr) == -1)\n    {\n        perror(\"Could not get interface address\");\n        exit(EXIT_FAILURE);\n    }\n    for (; ifaddr-&gt;ifa_next; ifaddr = ifaddr-&gt;ifa_next, if_c++)\n    {\n        if (!strcmp(ifaddr-&gt;ifa_name, ifreq_c.ifr_name) &amp;&amp; ifaddr-&gt;ifa_addr &amp;&amp; ifaddr-&gt;ifa_addr-&gt;sa_family == AF_PACKET)\n        {\n            // Copy the Source (local) NIC MAC address to the packet (ethernet header). It's already in network format.\n            memcpy(eth-&gt;ether_shost, (unsigned char *) LLADDR((struct sockaddr_dl *) ifaddr-&gt;ifa_addr), ETHER_ADDR_LEN);\n        }\n    }\n    freeifaddrs(ifaddr - if_c);\n#elif defined(SIOCGIFHWADDR)\n    if (ioctl(sock_r, SIOCGIFHWADDR, &amp;ifreq_c) == -1)\n    {\n        fprintf(stderr, \"Could not get MAC address for interface %s: %s\\n\", ifreq_c.ifr_name, strerror(errno));\n        exit(EXIT_FAILURE);\n    }\n#else\n#error \"Not yet implemented.\"\n#endif\n\n    // Get IF assigned IP Address.\n    strncpy(ifreq_ip.ifr_name, ifreq_c.ifr_name, IFNAMSIZ - 1);\n#if defined(SIOCGIFADDR)\n    if (ioctl(sock_r, SIOCGIFADDR, &amp;ifreq_ip) == -1)\n    {\n        fprintf(stderr, \"Could not get IP address for interface %s: %s\\n\", ifreq_ip.ifr_name, strerror(errno));\n        exit(EXIT_FAILURE);\n    }\n#else\n#error \"Not yet implemented.\"\n#endif\n    // Copy the destination NIC MAC address to the packet (ethernet header). \n    // ether_aton converts a human-readable NIC MAC to network format.\n    // TODO: Remember that we don't want to have a fixed destination NIC MAC, we'll probably receive it with an ARP request in the future. \n    if ((eth_daddr = ether_aton(DESTMAC)) == NULL)\n    {\n        perror(\"Could not convert destination NIC MAC address to network format\");\n        exit(EXIT_FAILURE);\n    }\n    memcpy(eth-&gt;ether_dhost, eth_daddr-&gt;octet, ETHER_ADDR_LEN);\n\n    eth-&gt;ether_type = htons(ETHERTYPE_IP);\n\n    // Calculate total packet length. \n    pckt_len += sizeof(*eth);\n\n    printf(\"Source Host: %s\\n\", ether_ntoa((const struct ether_addr *)eth-&gt;ether_shost));\n    printf(\"Desti. Host: %s\\n\", ether_ntoa((const struct ether_addr *)eth-&gt;ether_dhost));\n    printf(\"Ether. Type: 0x%0x%s\\n\", ntohs(eth-&gt;ether_type), ntohs(eth-&gt;ether_type) == 0x800 ? \" (IP)\" : \"\");\n\n\n    if (bind(sock_r, (struct sockaddr *)ifaddr-&gt;ifa_addr, sizeof(struct sockaddr)) == -1) \n    {\n        perror(\"Could not bind to specific interface\");\n        exit(EXIT_FAILURE);\n    }\n\n\n    /// 2. IP Header Construction\n    puts(\"\\nPHASE 2: IP Header Construction\");\n    struct ip *iph = (struct ip *)(packet + pckt_len);\n    // printf(\"IP Header %p (eth hdr siz: %i) begins at %p.\\n\", packet, pckt_len, packet + pckt_len);\n    iph-&gt;ip_hl = sizeof(struct ip) &gt;&gt; 2;\n    iph-&gt;ip_v = IPVERSION;      // 4\n    iph-&gt;ip_tos = 16;\n    iph-&gt;ip_id = htons(10201);  // any unique ID.\n    iph-&gt;ip_ttl = 64;\n    iph-&gt;ip_p = IPPROTO_UDP;     // UDP (User datagram protocol)\n    iph-&gt;ip_src.s_addr = ((struct sockaddr_in *)&amp;ifreq_ip.ifr_ifru.ifru_addr)-&gt;sin_addr.s_addr;\n    if (!inet_aton(DESTIP, &amp;iph-&gt;ip_dst)) \n    {\n        perror(\"Could not interpret destination IP address\");\n        exit(EXIT_FAILURE);\n    }\n\n    // Calculate total packet length. \n    pckt_len += sizeof(*iph);\n\n    printf(\"Header length: %i\\n\", iph-&gt;ip_hl);\n    printf(\"Version      : %i%s\\n\", iph-&gt;ip_v, iph-&gt;ip_v == IPVERSION ? \" (IPv4)\" : \"\");\n    printf(\"Type of Serv.: %i\\n\", iph-&gt;ip_tos);\n    printf(\"Identificati.: %i\\n\", ntohs(iph-&gt;ip_id));\n    printf(\"Time to live : %i\\n\", iph-&gt;ip_ttl);\n    printf(\"Protocol     : %i%s\\n\", iph-&gt;ip_p, iph-&gt;ip_p == IPPROTO_UDP ? \" (UDP)\" : \"\");\n    printf(\"Source Addre.: %s%s\\n\", inet_ntoa(iph-&gt;ip_src), \" (local IP)\");\n    printf(\"Dest. Address: %s\\n\", inet_ntoa(iph-&gt;ip_dst));\n\n\n\n    /// 3. UDP Header Construction\n    struct udphdr *udph = (struct udphdr *)(packet + pckt_len);\n    udph-&gt;uh_sport = htons(SRCPORT);\n    udph-&gt;uh_dport = htons(DESTPORT);\n    udph-&gt;uh_sum = 0;\n\n    // Calculate total packet length. \n    pckt_len += sizeof(*udph);\n\n    // Actual UDP Payload: \n    packet[pckt_len++] = 0xAA;\n    packet[pckt_len++] = 0xBB;\n    packet[pckt_len++] = 0xCC;\n    packet[pckt_len++] = 0xDD;\n    packet[pckt_len++] = 0xEE;\n\n    // Fill out remaining length header fields: \n    // UDP length field\n    udph-&gt;uh_ulen = htons(pckt_len - sizeof(*iph) - sizeof(*eth));\n    // IP length field\n    iph-&gt;ip_len = htons(pckt_len - sizeof(*eth));\n\n    // Finally, calculate the checksum.\n    iph-&gt;ip_sum = checksum((unsigned short *)(packet + sizeof(*eth)), sizeof(*iph) / 2);\n    udph-&gt;uh_sum = udp_checksum(udph, pckt_len, iph-&gt;ip_src.s_addr, iph-&gt;ip_dst.s_addr);\n\n    struct sockaddr_dl saddr_dl = { 0 };\n    memset(&amp;saddr_dl, 0, sizeof(struct sockaddr_dl));\n    saddr_dl.sdl_index = ifreq_i.ifr_intval;\n    saddr_dl.sdl_family = AF_LINK;\n    saddr_dl.sdl_type = IFRTYPE_FUNCTIONAL_WIRED; // APPLE_IF_FAM_ETHERNET\n    saddr_dl.sdl_nlen = strlen(ifreq_i.ifr_name);\n    saddr_dl.sdl_len = sizeof(struct sockaddr_dl);\n    saddr_dl.sdl_alen = ETHER_ADDR_LEN;\n    memcpy(saddr_dl.sdl_data, eth_daddr-&gt;octet, ETHER_ADDR_LEN);\n\n    puts(\"\\nPHASE 4: SENDING PACKET\");\n    printf(\"Packet length: %i\\n\", pckt_len);\n    printf(\"Interface index: %i; %i\\n\", saddr_dl.sdl_index, ifreq_i.ifr_intval);\n\n    // Send the packet.\n    if ((send_len = sendto(sock_r, packet, PKT_SIZ, 0, (const struct sockaddr *)&amp;saddr_dl, sizeof(saddr_dl))) == -1) \n    {\n        perror(\"Could not send packet\");\n        exit(EXIT_FAILURE);\n    }\n    printf(\"Successfully sent packet with data length: %lu\\n\", send_len);\n\n    return 0;\n}\n</code></pre>\n\n<p>Don't worry about error checking, I left that out due to the piece of code already being very large.</p>\n\n<p>This is one of the results: </p>\n\n<pre><code>PHASE 1: Ethernet Header Construction\nSource Host: 5E:F1:28:36:5E:DB\nDesti. Host: ED:5B:B6:29:43:D5\nEther. Type: 0x800\n\nPHASE 2: IP Header Construction\nIP Header 0x5fcde63019a0 (eth hdr siz: 14) begins at 0x5fcde63019ae.\nHeader length: 5\nVersion      : 4 (IPv4)\nType of Serv.: 16\nIdentificati.: 10201\nTime to live : 68\nProtocol     : 17 (UDP)\nSource Addre.: 192.168.178.21 (local IP)\nDest. Address: 192.168.178.25\n\nPHASE 4: SENDING PACKET\nInterface Index: 7\nPacket length: 47\nDestination mac: ed:5b:b6:29:43:d5\nCould not send packet: Invalid argument\n</code></pre>\n\n<h3>Edit</h3>\n\n<p>I'm casting a sockaddr_dl structure to a sockaddr. They're both defined in their header files like following:</p>\n\n<pre><code>struct sockaddr {\n    __uint8_t   sa_len;     /* total length */\n    sa_family_t sa_family;  /* [XSI] address family */\n    char        sa_data[14];    /* [XSI] addr value (actually larger) */\n};\nstruct sockaddr_dl {\n    u_char  sdl_len;    /* Total length of sockaddr */\n    u_char  sdl_family; /* AF_LINK */\n    u_short sdl_index;  /* if != 0, system given index for interface */\n    u_char  sdl_type;   /* interface type */\n    u_char  sdl_nlen;   /* interface name length, no trailing 0 reqd. */\n    u_char  sdl_alen;   /* link level address length */\n    u_char  sdl_slen;   /* link layer selector length */\n    char    sdl_data[12];   /* minimum work area, can be larger;\n                   contains both if name and ll address */\n};\n</code></pre>\n"}, {"tags": ["c", "gcc", "bit-manipulation"], "answers": [{"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 2, "last_activity_date": 1543426851, "creation_date": 1543426851, "answer_id": 53525189, "question_id": 53525111, "link": "https://stackoverflow.com/questions/53525111/gcc-bitwise-odd-behavior/53525189#53525189", "title": "gcc bitwise odd behavior", "body": "<p>Your <code>byte_to_binary</code> function returns a pointer to a static array.  You then call <code>printf</code>, passing the return value of this function multiple times, and each of those calls returns the <strong>same</strong> pointer, so whichever invocation of the function happens to come last will be the one the results are printed for in all cases.</p>\n\n<p>You need to either split up your <code>printf</code> calls so that <code>byte_to_binary</code> is only called once each time, or copy off the result into temporaries and print those.  You're doing the latter in the second <code>printf</code> call, so just use that and remove the third.</p>\n"}, {"comments": [{"owner": {"reputation": 37414, "user_id": 204883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba29060be0758fa6537ff3d768a91757?s=128&d=identicon&r=PG", "display_name": "Arkku", "link": "https://stackoverflow.com/users/204883/arkku"}, "edited": false, "score": 0, "creation_date": 1543427642, "post_id": 53525190, "comment_id": 93919616, "body": "Note that &quot;the last result&quot; here means whichever result happens to be the last; the order in which function arguments are evaluated is unspecified by the C standard. However, they will all be evaluated before passing to <code>printf</code> (and <i>not</i>, for example, only when used by <code>printf</code>)."}], "tags": [], "owner": {"reputation": 37414, "user_id": 204883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba29060be0758fa6537ff3d768a91757?s=128&d=identicon&r=PG", "display_name": "Arkku", "link": "https://stackoverflow.com/users/204883/arkku"}, "is_accepted": false, "score": 2, "last_activity_date": 1543426858, "creation_date": 1543426858, "answer_id": 53525190, "question_id": 53525111, "link": "https://stackoverflow.com/questions/53525111/gcc-bitwise-odd-behavior/53525190#53525190", "title": "gcc bitwise odd behavior", "body": "<p>You are returning a pointer to the same <code>static</code> buffer from every call to <code>byte_to_binary</code>, so by the time the <code>printf</code> reads them they have (or rather, it has) only the last result.</p>\n"}, {"comments": [{"owner": {"reputation": 31, "user_id": 6938571, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b738d3c2eebda9f05f9e7cf382f623d?s=128&d=identicon&r=PG&f=1", "display_name": "Douglas Marsh", "link": "https://stackoverflow.com/users/6938571/douglas-marsh"}, "edited": false, "score": 0, "creation_date": 1543435070, "post_id": 53525363, "comment_id": 93923144, "body": "Thank you all very much, that makes tons of sense."}, {"owner": {"reputation": 37414, "user_id": 204883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba29060be0758fa6537ff3d768a91757?s=128&d=identicon&r=PG", "display_name": "Arkku", "link": "https://stackoverflow.com/users/204883/arkku"}, "edited": false, "score": 0, "creation_date": 1543448961, "post_id": 53525363, "comment_id": 93928208, "body": "A stylistic nitpick: I would stay away from defining the length of an array argument of a function since it obfuscates the fact that it becomes a pointer argument regardless, and gives the false impression that, for example, <code>sizeof</code> could be used on it to determine the array size."}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "reply_to_user": {"reputation": 37414, "user_id": 204883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba29060be0758fa6537ff3d768a91757?s=128&d=identicon&r=PG", "display_name": "Arkku", "link": "https://stackoverflow.com/users/204883/arkku"}, "edited": false, "score": 0, "creation_date": 1543476664, "post_id": 53525363, "comment_id": 93935335, "body": "@Arkku I maybe really though that too for some time and was against the new 15 principle in the new <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n2086.htm\" rel=\"nofollow noreferrer\">C2x chapter</a>. Once you start using it, doing <code>array_do_smth(size_t len, arrtype_t arr[static len]);</code> (ok, I don&#39;t use static keyword there that much) it gets really verbose to see how big the size of an array is. But true, it maybe is sometimes misleading for the <code>sizeof</code> and the type of the address-of operator. Anyway, I am against such a stylistic nitpick, but don&#39;t really care if someone uses pointers."}, {"owner": {"reputation": 37414, "user_id": 204883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba29060be0758fa6537ff3d768a91757?s=128&d=identicon&r=PG", "display_name": "Arkku", "link": "https://stackoverflow.com/users/204883/arkku"}, "edited": false, "score": 0, "creation_date": 1543505924, "post_id": 53525363, "comment_id": 93952002, "body": "Both your example in the comment and the one in the principle 15 have the VLA syntax. I personally find that more acceptable since <code>len</code> is given as a separate argument, which also removes the temptation to use <code>sizeof</code> to determine it. However, the magic constant <code>9</code> I would avoid, especially if it would then have to be duplicated inside the function (e.g., <code>i &lt; 9</code>, although that doesn&#39;t appear in this particular case). Something like <code>b[CHAR_BIT + 1]</code> would be less objectionable."}], "tags": [], "owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "is_accepted": false, "score": 0, "last_activity_date": 1543427589, "creation_date": 1543427589, "answer_id": 53525363, "question_id": 53525111, "link": "https://stackoverflow.com/questions/53525111/gcc-bitwise-odd-behavior/53525363#53525363", "title": "gcc bitwise odd behavior", "body": "<pre><code>const char *byte_to_binary(int x)\n{\n    static char b[9];\n    ...\n    return b;\n}\n</code></pre>\n\n<p>This function is not reentrant and returns a pointer to local value. So using it like : <code>byte_to_binary(ch), byte_to_binary(ch &amp; a)</code> will yield the same result twice, as the pointer value is the same(!).</p>\n\n<p>But you can pass allocated space to your function:</p>\n\n<pre><code>const char *byte_to_binary(int x, char b[9]) { \n   ...\n   return b; \n}\n</code></pre>\n\n<p>And call using constant literal:</p>\n\n<pre><code>byte_to_binary(ch, (char[9]){0}), byte_to_binary(ch &amp; a, (char[9]){0}),\n</code></pre>\n\n<p>This will allocate needed 9 chars on each function call. You can make that a macro:</p>\n\n<pre><code>const char *byte_to_binary_in(int x, char b[9]) { \n   ...\n   return b; \n}\n#define byte_to_binary(x)  byte_to_binary_in(x, (char[9]){0})\n</code></pre>\n\n<p>And have stay with the same interface, while your function stays reentrant.</p>\n\n<p>Keep in mind however, that compound literals stop existing when exiting from a block, ie. after <code>}</code>.</p>\n\n<p>P.S. Have fun and see my small function <code>printbinary</code> and macro <code>PRINTBINARY_t(...)</code>, <a href=\"https://gitlab.com/Kamcuk/kamillibc/blob/master/src/lib/printex.h#L16\" rel=\"nofollow noreferrer\">header</a> and <a href=\"https://gitlab.com/Kamcuk/kamillibc/blob/master/src/lib/printex.c#L18\" rel=\"nofollow noreferrer\">src</a>. However there are maaany solution over the net for printing binary numbers.</p>\n"}], "owner": {"reputation": 31, "user_id": 6938571, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b738d3c2eebda9f05f9e7cf382f623d?s=128&d=identicon&r=PG&f=1", "display_name": "Douglas Marsh", "link": "https://stackoverflow.com/users/6938571/douglas-marsh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1543427589, "creation_date": 1543426503, "question_id": 53525111, "link": "https://stackoverflow.com/questions/53525111/gcc-bitwise-odd-behavior", "title": "gcc bitwise odd behavior", "body": "<p>I'm getting back to C after a long absence and I'm trying to learn the bitwise operators. I wrote this little program to demonstrate my confusion. The first printf works (after the header), but not the second. Is this some kind of order of operations thing or what?</p>\n\n<pre><code>#include &lt;ctype.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;time.h&gt;\n\nconst char *byte_to_binary(int x)\n{\n    static char b[9];\n    b[0] = '\\0';\n\n    int z;\n    for (z = 128; z &gt; 0; z &gt;&gt;= 1)\n        {\n        strcat(b, ((x &amp; z) == z) ? \"1\" : \"0\");\n        }\n\n    return b;\n}\n\nint main(int argc, char *argv[])\n{\n    unsigned int ch = atoi(argv[1]);\n    unsigned int a = atoi(argv[2]);\n    int chA;\n    int chB;\n    int chC;\n    int chD;\n    int chE;\n    int chF;\n    chA = ch &amp; a;\n    chB = ch | a;\n    chC = ch ^ a;\n    chD = ~ch;\n    chE = ch &lt;&lt; 2;\n    chF = ch &gt;&gt; 2;\n    char chAS[16];\n    char chBS[16];\n    char chCS[16];\n    char chDS[16];\n    char chES[16];\n    char chFS[16];\n    strcpy(chAS, byte_to_binary(chA));\n    strcpy(chBS, byte_to_binary(chB));\n    strcpy(chCS, byte_to_binary(chC));\n    strcpy(chDS, byte_to_binary(chD));\n    strcpy(chES, byte_to_binary(chE));\n    strcpy(chFS, byte_to_binary(chF));\n\n    printf(\"[c][%%d ][%%o ][%%x][   %%s  ][   &amp;    ][   |    ][   ^    ][   ~    ][  &lt;&lt;    ][   &gt;&gt;   ]\\n\");\n    printf(\"[%c][%03d][%03o][%02x][%s][%s][%s][%s][%s][%s][%s]\\n\", isprint(ch) ? ch : ' ', ch, ch, ch, byte_to_binary(ch), chAS, chBS, chCS, chDS, chES, chFS);\n    printf(\"[%c][%03d][%03o][%02x][%s][%s][%s][%s][%s][%s][%s]\\n\", isprint(ch) ? ch : ' ', ch, ch, ch, byte_to_binary(ch), byte_to_binary(ch &amp; a), byte_to_binary(ch | a), byte_to_binary(ch ^ a), byte_to_binary(~ch), byte_to_binary(ch &lt;&lt; 2), byte_to_binary(ch &gt;&gt; 2));\n\n    return (0);\n}\n</code></pre>\n"}, {"tags": ["c", "function", "pointers", "struct", "malloc"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2201041"}, "edited": false, "score": 0, "creation_date": 1543426731, "post_id": 53525094, "comment_id": 93919212, "body": "Arrays decay to pointers when you pass them to functions"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9016680"}, "edited": false, "score": 0, "creation_date": 1543426834, "post_id": 53525094, "comment_id": 93919261, "body": "@JETM im sorry what do you mean by that?"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1543427371, "post_id": 53525094, "comment_id": 93919492, "body": "The code as posted (with the missing <code>;</code> before the <code>return</code> fixed) gives the expected results.  Make sure that you recompile your code, and that you copy and paste the <b>exact</b> code you&#39;re compiling.  Don&#39;t try to retype anything."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2201041"}, "edited": false, "score": 0, "creation_date": 1543427401, "post_id": 53525094, "comment_id": 93919508, "body": "<a href=\"https://stackoverflow.com/questions/1461432/what-is-array-decaying\" title=\"what is array decaying\">stackoverflow.com/questions/1461432/what-is-array-decaying</a> I&#39;m not sure whether it makes a difference in your specific case, but it&#39;s the first suspicious thing I saw."}, {"owner": {"user_type": "does_not_exist", "display_name": "user9016680"}, "reply_to_user": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1543427551, "post_id": 53525094, "comment_id": 93919581, "body": "@dbush I did, got exactly nothing."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1543427624, "post_id": 53525094, "comment_id": 93919608, "body": "@K.Welch What you currently have posted is not the exact code you&#39;re running because it does not compile.  Post your <b>real</b> code via copy/paste."}, {"owner": {"user_type": "does_not_exist", "display_name": "user9016680"}, "reply_to_user": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1543427858, "post_id": 53525094, "comment_id": 93919711, "body": "@dbush look again i edited it"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1543427867, "post_id": 53525094, "comment_id": 93919718, "body": "Your code as it stands here now works fine. Are you sure the code you run is the code you compile as it stands in the question?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9016680"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1543427986, "post_id": 53525094, "comment_id": 93919772, "body": "Yeah, it keeps saying the zeros and blanks. Could it be my compiler, I gotta GCC 4.9.2 @Jabberwocky"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1543428170, "post_id": 53525094, "comment_id": 93919864, "body": "@K.Welch No, it&#39;s not your compiler, gcc works fine. I insist, your code is OK: look here: <a href=\"https://www.ideone.com/dePJNe\" rel=\"nofollow noreferrer\">ideone.com/dePJNe</a>. How do you compile and run your code?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9016680"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1543428245, "post_id": 53525094, "comment_id": 93919906, "body": "@Jabberwocky gcc -o name name.c and then ./name"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1543428374, "post_id": 53525094, "comment_id": 93919959, "body": "@K.Welch put <code>printf(&quot;Hello Workd\\n&quot;);</code> at the very beginning of the <code>main</code> function, compile, run and check the output."}, {"owner": {"user_type": "does_not_exist", "display_name": "user9016680"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1543428556, "post_id": 53525094, "comment_id": 93920027, "body": "@Jabberwocky I got nothing"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1543428644, "post_id": 53525094, "comment_id": 93920070, "body": "@K.Welch you mean <code>Hello World</code> is not printed? If this is the case then you&#39;re somehow not running the program you compile or the program compiles with errors and you&#39;re running the previous version"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9016680"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1543428802, "post_id": 53525094, "comment_id": 93920143, "body": "@Jabberwocky Got it working, you just came up with it. I just made a new file!"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1543428875, "post_id": 53525094, "comment_id": 93920179, "body": "I&#39;m voting to close this question as off-topic because the code was fine, OP wasn&#39;t running the program that he compiled."}], "owner": {"user_type": "does_not_exist", "display_name": "user9016680"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1543427752, "creation_date": 1543426420, "last_edit_date": 1543427752, "question_id": 53525094, "link": "https://stackoverflow.com/questions/53525094/using-struct-functions-and-pointers-in-c", "title": "Using Struct Functions and Pointers in C", "body": "<p>What I am trying to do is use a struct function that takes the values that are contained in the student struct, create a student struct, and then return a student pointer. So basically: </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\ntypedef struct student_struct\n{\n    char name[16];\n    int age;\n    float gpa;\n\n}Student;\n\n\nStudent *makeStudent(char name[16], int age, float gpa)\n{\n    Student *s = (Student *) malloc(sizeof(Student));\n    //FIXME: Make your code changes here....\n    strcpy(s-&gt;name, name);\n    s-&gt;age=age;\n    s-&gt;gpa=gpa;\n    return s;\n\n}\n\n//Display the values of all students in the class\nvoid displayClass(Student classArray[], int size)\n{\n    int i;\n    for(i=0;i&lt;size;i++){\n        printf(\"  %s, %d, %.1f\\n\", classArray[i].name, classArray[i].age, classArray[i].gpa);\n    }\n}\n\nint main()\n{\n    //FIXME: Implement make student function\n    Student *adam = makeStudent(\"adam\", 18, 2.0);\n    Student *beth = makeStudent(\"beth\", 19, 3.2);\n    Student *chris = makeStudent(\"chris\", 18, 3.6);\n    Student *daphney = makeStudent(\"daphney\", 20, 3.9);\n    Student *erin = makeStudent(\"erin\", 19, 2.6);\n\n    const int CLASS_SIZE = 5;\n    Student classArray[CLASS_SIZE];\n    classArray[0] = *adam;\n    classArray[1] = *beth;\n    classArray[2] = *chris;\n    classArray[3] = *daphney;\n    classArray[4] = *erin;\n\n    displayClass(classArray, CLASS_SIZE);\n\n    //deallocate memory\n    free(adam);\n    free(beth);\n    free(chris);\n    free(daphney);\n    free(erin);\n\n    return 0;\n}\n</code></pre>\n\n<p>And the output I would like to get is:</p>\n\n<pre><code>adam, 18, 2.0\nbeth, 19, 3.2\nchris, 18, 3.6\n.... (continues from there)\n</code></pre>\n\n<p>But instead, what I get is:</p>\n\n<pre><code> , 0, 0.0\n , 0, 0.0\n , 0, 0.0\n , 0, 0.0\n , 0, 0.0\n</code></pre>\n\n<p>I think it has to do with the </p>\n\n<pre><code>Student *makeStudent(char name[16], int age, float gpa)\n</code></pre>\n\n<p>function but I am not so sure. Any hints? Not looking for the answer!</p>\n"}, {"tags": ["c", "linux", "parallel-processing", "openmp", "parallel-for"], "comments": [{"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1543427669, "post_id": 53525059, "comment_id": 93919626, "body": "You can&#39;t nest parallel blocks."}, {"owner": {"reputation": 73919, "user_id": 44309, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iL4TW.png?s=128&g=1", "display_name": "High Performance Mark", "link": "https://stackoverflow.com/users/44309/high-performance-mark"}, "edited": false, "score": 2, "creation_date": 1543428281, "post_id": 53525059, "comment_id": 93919927, "body": "There are a lot of questions and answers here on SO on the topic of <i>OpenMP nested loops</i>.  Do a little more research, you may conclude that parallelisation of just the outer loop is the right way to go."}, {"owner": {"reputation": 11, "user_id": 10718474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17f23cc9d54843ac7af7d92b590f03ac?s=128&d=identicon&r=PG&f=1", "display_name": "Sim0n", "link": "https://stackoverflow.com/users/10718474/sim0n"}, "edited": false, "score": 0, "creation_date": 1543428566, "post_id": 53525059, "comment_id": 93920031, "body": "I know that I can&#39;t nest blocks, but I want to do two options where  - one: paralalize only outer loop - two: paralalize only inner loop. And I have problem with the second one"}, {"owner": {"reputation": 1480, "user_id": 10450594, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae4c6a0ca94b3094b25f18e66d8368ff?s=128&d=identicon&r=PG&f=1", "display_name": "Brice", "link": "https://stackoverflow.com/users/10450594/brice"}, "edited": false, "score": 0, "creation_date": 1543489158, "post_id": 53525059, "comment_id": 93942352, "body": "You will need to implement a reduction scheme to parallelize the inner loop. See for instance <a href=\"https://stackoverflow.com/questions/53410585/openmp-c-program-run-slower-than-sequential-code/53412396#53412396\">there</a>. As mentioned, there are <i>many</i> questions on the subject."}], "answers": [{"tags": [], "owner": {"reputation": 495, "user_id": 1418283, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1BxYN.jpg?s=128&g=1", "display_name": "Gabriel Garcia", "link": "https://stackoverflow.com/users/1418283/gabriel-garcia"}, "is_accepted": false, "score": 0, "last_activity_date": 1544049061, "creation_date": 1544049061, "answer_id": 53641758, "question_id": 53525059, "link": "https://stackoverflow.com/questions/53525059/openmp-loops-parallelization/53641758#53641758", "title": "OpenMP loops parallelization", "body": "<p>Parallelizing the inner loop should be enough to consume all available threads. If you parallelize both it would only generate overhead.</p>\n"}], "owner": {"reputation": 11, "user_id": 10718474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17f23cc9d54843ac7af7d92b590f03ac?s=128&d=identicon&r=PG&f=1", "display_name": "Sim0n", "link": "https://stackoverflow.com/users/10718474/sim0n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 55, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1544049061, "creation_date": 1543426254, "last_edit_date": 1543491299, "question_id": 53525059, "link": "https://stackoverflow.com/questions/53525059/openmp-loops-parallelization", "title": "OpenMP loops parallelization", "body": "<p>I am trying to parallelize both loops of this fragment of code:</p>\n\n<pre><code>for ( j = 0 ; j &lt; nt2 ; j++ ) {\n   dm = MAX_LON + 1;\n\n   for ( i = 0 ; i &lt; nt1 ; i++ ) {\n      d = distancia(tabla1[i],tabla2[j]);     \n      if ( d &lt; dm ) {\n         dm = d;\n         im = i;\n      }\n   }\n   ps[j] = im;\n}\n</code></pre>\n\n<p>Parallelizing of outer loop succeed:</p>\n\n<pre><code>#pragma omp parallel for private(i,d,dm,im)\n</code></pre>\n\n<p>But I still have a problem with the inner one. I tried with e.g. private(d,m) and reduction(max:im), but it doesn't work with any combination. The closest to sequencial results I've got with private(d). Any ideas?\nThanks!</p>\n"}, {"tags": ["c", "linux", "process", "io", "nice"], "comments": [{"owner": {"reputation": 608, "user_id": 9502067, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/261b06a0bd237491cbf6130b573b1a2e?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander Pane", "link": "https://stackoverflow.com/users/9502067/alexander-pane"}, "edited": false, "score": 0, "creation_date": 1543424275, "post_id": 53524268, "comment_id": 93917866, "body": "I would firstly use a semaphore when calling the printf (and probably include the timestamp inside). The printf function is not atomic and can lead to undefined output in a multi process program."}, {"owner": {"reputation": 608, "user_id": 9502067, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/261b06a0bd237491cbf6130b573b1a2e?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander Pane", "link": "https://stackoverflow.com/users/9502067/alexander-pane"}, "edited": false, "score": 0, "creation_date": 1543425038, "post_id": 53524268, "comment_id": 93918284, "body": "It would also be useful if you provide the input for your program in order to reenact your test your reported"}, {"owner": {"reputation": 41, "user_id": 7241935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5497f60b332e1253dd825310b36ce96f?s=128&d=identicon&r=PG&f=1", "display_name": "Nikolskyy", "link": "https://stackoverflow.com/users/7241935/nikolskyy"}, "reply_to_user": {"reputation": 608, "user_id": 9502067, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/261b06a0bd237491cbf6130b573b1a2e?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander Pane", "link": "https://stackoverflow.com/users/9502067/alexander-pane"}, "edited": false, "score": 0, "creation_date": 1543425782, "post_id": 53524268, "comment_id": 93918736, "body": "Ok, I added the makefile and the execution command in the EDIT of the post"}], "answers": [{"tags": [], "owner": {"reputation": 608, "user_id": 9502067, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/261b06a0bd237491cbf6130b573b1a2e?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander Pane", "link": "https://stackoverflow.com/users/9502067/alexander-pane"}, "is_accepted": false, "score": 0, "last_activity_date": 1543500762, "creation_date": 1543500762, "answer_id": 53540940, "question_id": 53524268, "link": "https://stackoverflow.com/questions/53524268/measuring-time-of-n-processes/53540940#53540940", "title": "Measuring time of n processes", "body": "<p>A simple flush of the <code>stdout</code> buffer after the <code>printf</code> should do the trick:</p>\n\n<pre><code>printf(\"%i;%lu\\n\", i, diff);\nfflush(stdout);\n</code></pre>\n\n<p>Anyhow I would also suggest a lock on the file, in case there is a context switching during this procedure:</p>\n\n<pre><code>flock(fileno(stdout), LOCK_SH);\nprintf(\"%i;%lu\\n\", i, diff);\nfflush(stdout);\nflock(fileno(stdout), LOCK_UN);\n</code></pre>\n\n<p>Another way would also be to use a mutex.</p>\n\n<p>This gave me a correct output, but it appears to always switch between processes. So your output will have a different process printing in each line (or 2 or 3 lines depends on the switching).</p>\n"}], "owner": {"reputation": 41, "user_id": 7241935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5497f60b332e1253dd825310b36ce96f?s=128&d=identicon&r=PG&f=1", "display_name": "Nikolskyy", "link": "https://stackoverflow.com/users/7241935/nikolskyy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 55, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1543500762, "creation_date": 1543423455, "last_edit_date": 1543425752, "question_id": 53524268, "link": "https://stackoverflow.com/questions/53524268/measuring-time-of-n-processes", "title": "Measuring time of n processes", "body": "<p>So I am up to measure time for n processes depending of their nice values.\nI fork the n processes from the parent process and all they have to do is to count a counter from 0 to X in an endless loop, each time printing the time that they needed for one count from 0 to X.</p>\n\n<p>I guess it is a standard exercise in system programming labs.</p>\n\n<p>I am saving the output of this experiment to a csv file to work out things like the avarege time of a process but.. I have broken output.</p>\n\n<p>My code:</p>\n\n<pre><code>  #include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;sys/resource.h&gt;\n#include &lt;time.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;wait.h&gt;\n\n\nint exitSTATUS=0;\nint *t = NULL;\n\n\n\nvoid inputWarning() { printf(\"Falsche Eingabe\"); }\n\nlong to_us(const struct timespec *spec) {\n  // inversion of to_spec from above ^\n  return spec-&gt;tv_sec * 1000000 + spec-&gt;tv_nsec / 1000;\n}\n\nvoid handleSIGINT_child(int sig){\n  exitSTATUS=1;\n}\nvoid handleSIGINT_parent(int sig){\n  if(t!= NULL)\n          free(t);\n}\n\nvoid testTime(int n, int *t, int X) {\n  pid_t pid;\n  int i;\n  for (i = 0; i &lt; n; i++) {\n    pid = fork();\n\n    if (pid &lt; 0) {\n      // TODO: Errer handling\n    } else if (pid == 0) {\n\n      signal(SIGINT,handleSIGINT_child);\n\n      setpriority(PRIO_PROCESS, 0, t[i]);\n\n      while (1) {\n        if(exitSTATUS&gt;0) exit(0);\n        struct timespec delta = {0, 0};\n        long current_us = 0;\n        // clock for higher precision on difference\n        clock_gettime(CLOCK_REALTIME, &amp;delta);\n        current_us = to_us(&amp;delta);\n\n        int j;\n        for (j = 0; j &lt; X; j++) {\n        }\n           clock_gettime(CLOCK_REALTIME, &amp;delta);\n        long diff = to_us(&amp;delta) - current_us;\n\n        printf(\"%i;%lu\\n\", i, diff);\n      }\n    }\n  }\n  if (pid &gt; 0) {\n    signal(SIGINT,handleSIGINT_parent);\n    wait(NULL);\n  }\n};\n\nint main(int argc, char *argv[]) {\n  if (argc &gt;= 4) {\n    int n = strtol((argv)[1], NULL, 10);\n    t = malloc(n*sizeof(int));\n    if (n &gt;= 0 &amp;&amp; argc &gt;= n + 3) {\n      int i;\n      for (i = 0; i &lt; n; i++) {\n        int niceval =\n            strtol(argv[i + 2], NULL, 10); // TODO : Auf parseError pr\u00fcfen\n        t[i] = niceval;\n      }\n      int X = strtol(argv[n + 2], NULL, 10);\n      testTime(n, t, X);\n      free(t);\n      return 0;\n    }\n  }\n  inputWarning();\n  if (t != NULL) {\n    free(t);\n  }\n  return 0;\n}\n</code></pre>\n\n<p>in the output I get strange things like</p>\n\n<pre><code>1;4287\n1;4366\n1;4774\n1;4243\n1;4492\n10;8539\n0;5856\n0;6558\n0;6462\n0;5886\n</code></pre>\n\n<p>The 10 in the 6th line is wrong because i have only three processes.\nI guess the 1 is left from the output of the 1st process and 0 is the output of the 0th process. </p>\n\n<p>I have two ideas concerning the reason for this.\n1. The program is terminated by sigint. This causes an abrupt cut in the output.\n2. The change between processes causes that cut.</p>\n\n<p>In any case I just want to get my output nice and clean to work with it.</p>\n\n<p>Any help would be appreciated. :)</p>\n\n<p>EDIT:</p>\n\n<p>just for reproducing: </p>\n\n<p>the makefile:</p>\n\n<pre><code>OBJ=main.o\nCC=gcc\nCFLAGS=-g -Wall -Wextra -std=gnu11\n\napp: $(OBJ)\n        $(CC) $(CFLAGS) -o $@ $(OBJ)\n\n%.o: %.c\n        $(CC) $(CFLAGS) -c -o $@ $&lt;\n\nclean:\n        rm -f *.o app\n</code></pre>\n\n<p>and the run command</p>\n\n<pre><code>./app 3 19 0 0 2000000 &gt; output.csv\n</code></pre>\n"}, {"tags": ["c", "printf", "buffer"], "comments": [{"owner": {"reputation": 4431, "user_id": 4739488, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q8m1k.png?s=128&g=1", "display_name": "Flydog57", "link": "https://stackoverflow.com/users/4739488/flydog57"}, "edited": false, "score": 1, "creation_date": 1543423352, "post_id": 53524213, "comment_id": 93917350, "body": "What&#39;s this have to do with <code>C#</code>?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1543423541, "post_id": 53524213, "comment_id": 93917451, "body": "First of all, always end output using <code>printf</code> with a newline, to make sure the output is flushed (or explicitly <a href=\"http://en.cppreference.com/w/cpp/io/c/fflush\" rel=\"nofollow noreferrer\">flush</a> <code>stdout</code>). Secondly, calling <code>rewind</code> on a forward-only stream like <code>stdin</code> doesn&#39;t make much sense."}], "answers": [{"tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": false, "score": 0, "last_activity_date": 1543423779, "creation_date": 1543423779, "answer_id": 53524361, "question_id": 53524213, "link": "https://stackoverflow.com/questions/53524213/double-buffering-and-printf/53524361#53524361", "title": "Double buffering and printf", "body": "<p>As for your problem, by \"then it immediately disappears\" I assume that the console window disappears quickly?</p>\n\n<p>That's because the program exits.</p>\n\n<p>You need to flush the input buffer connected to <code>stdin</code> to remove all key presses you made (by <em>reading</em> from <code>stdin</code>) and then call <code>getchar</code> one extra time to get a a kind of confirmation that the user wants to exit.</p>\n"}], "owner": {"reputation": 1, "user_id": 10718197, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-GHAYq4HOyNc/AAAAAAAAAAI/AAAAAAAAAEA/qWZndB29gfU/photo.jpg?sz=128", "display_name": "ato", "link": "https://stackoverflow.com/users/10718197/ato"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 181, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1543423779, "creation_date": 1543423247, "last_edit_date": 1543423383, "question_id": 53524213, "link": "https://stackoverflow.com/questions/53524213/double-buffering-and-printf", "title": "Double buffering and printf", "body": "<p>I am having trouble with getting my other basic functions to work with double buffer.</p>\n\n<p>for example in the code below, it runs and I can press either down or up to move my cursor, and when I press enter I am supposed to get a printf saying either making a new char, load, or goodbye.</p>\n\n<p>It shows up for a split second but then it immediately disappears. In these situations rewind(stdin) and getchar(); solves this issue but for this code, nothing seems to work.</p>\n\n<p>Please help.</p>\n\n<pre><code>#define _CRT_SECURE_NO_WARNINGS\n#include \"conioex.h\"\n#include \"DblBuffer.h\"\n\nenum // \n{\n    NEW_GAME = 20,\n    LOAD,\n    EXIT,\n    MAX_NUM\n};\n\nvoid main (void)\n{\n    DblBuffer db;\n    int Cursor_X, Cursor_Y; // cursorlocation\n    bool Key_flag = false;  // pressandtrue\n    int type = NEW_GAME;    // type\n    Cursor_X = 20;\n    Cursor_Y = 1;\n    int flag = 1;\n    while (flag)\n    {\n        for (int i = 1; i &lt;= 3; i++)\n        {\n            db.setCursorPos(20,i);\n            db.write(\" \");\n        }\n        db.setCursorPos(25,1);\n        db.write(\"New Game\\n\");\n        db.setCursorPos(25,2);\n        db.write(\"Load\\n\");\n        db.setCursorPos(25,3);\n        db.write(\"Exit\\n\");\n\n        if (inport(PK_DOWN))\n        {\n            if (Key_flag == false)\n            {\n                Cursor_Y = Cursor_Y + 1;\n                type = type + 1;\n                Key_flag = true;\n            }\n        }\n        else if (inport(PK_UP))\n        {\n            if (Key_flag == false)\n            {\n                Cursor_Y = Cursor_Y - 1;\n                type = type - 1;\n                Key_flag = true;\n            }\n        }\n        else if (inport(PK_ENTER))\n        {\n            flag = 0;\n            break;\n        }\n        else\n        {\n            Key_flag = false;\n        }\n\n        if (Cursor_Y &lt; 1)\n        {\n            Cursor_Y = 1;\n        }\n        if (Cursor_Y &gt; 3)\n        {\n            Cursor_Y = 3;\n        }\n\n        if (type &lt; NEW_GAME)\n        {\n            type = NEW_GAME;\n        }\n        if (type &gt;= MAX_NUM)\n        {\n            type = MAX_NUM - 1;\n        }\n\n        db.setCursorPos(Cursor_X, Cursor_Y);\n        db.write(\"\u2192\");\n        db.swap();\n    }\n\n    if(type == NEW_GAME)\n    {\n        printf(\"making a new game\");\n    }\n    if (type == LOAD)\n    {\n        printf(\"will load\");\n    }\n    if (type == EXIT)\n    {\n        printf(\"goodbye\");\n    }\n\n    rewind(stdin);\n    getchar();\n}\n</code></pre>\n"}, {"tags": ["c", "c99", "c11", "subobject"], "comments": [{"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 0, "creation_date": 1543424002, "post_id": 53523932, "comment_id": 93917740, "body": "What about <a href=\"https://ideone.com/e1LQjZ\" rel=\"nofollow noreferrer\"><code>struct foo FOO_INITIALIZER(bar);</code></a>"}, {"owner": {"reputation": 91, "user_id": 4191745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/150f1ca10d4663f8d862538b9b46e507?s=128&d=identicon&r=PG&f=1", "display_name": "Nathan Hjelm", "link": "https://stackoverflow.com/users/4191745/nathan-hjelm"}, "reply_to_user": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 0, "creation_date": 1543433761, "post_id": 53523932, "comment_id": 93922528, "body": "Very similar to above though it does have one benefit: not needing to put the name twice. It looks like that is the best that can be done with current C (or future C as I doubt WG14 will add self-referencing to the standard)."}], "answers": [{"comments": [{"owner": {"reputation": 91, "user_id": 4191745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/150f1ca10d4663f8d862538b9b46e507?s=128&d=identicon&r=PG&f=1", "display_name": "Nathan Hjelm", "link": "https://stackoverflow.com/users/4191745/nathan-hjelm"}, "edited": false, "score": 0, "creation_date": 1543433813, "post_id": 53524379, "comment_id": 93922547, "body": "Thats what I thought. Thanks for confirming. Figured I would ask stackoverflow before I give up on the macro syntax I was after."}], "tags": [], "owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "is_accepted": false, "score": 1, "last_activity_date": 1543423843, "creation_date": 1543423843, "answer_id": 53524379, "question_id": 53523932, "link": "https://stackoverflow.com/questions/53523932/c99-c11-self-referencing-sub-object-initialization-possible/53524379#53524379", "title": "C99/C11 Self-referencing Sub-object Initialization possible?", "body": "<p>There is no way to achieve what you want in the standard C language. You can either continue passing a name (but this does not work well for nested objects) or store offsets instead of pointers if this makes sense (highly dependent on the application) via <code>offsetof</code>.</p>\n"}], "owner": {"reputation": 91, "user_id": 4191745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/150f1ca10d4663f8d862538b9b46e507?s=128&d=identicon&r=PG&f=1", "display_name": "Nathan Hjelm", "link": "https://stackoverflow.com/users/4191745/nathan-hjelm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1543423843, "creation_date": 1543422247, "question_id": 53523932, "link": "https://stackoverflow.com/questions/53523932/c99-c11-self-referencing-sub-object-initialization-possible", "title": "C99/C11 Self-referencing Sub-object Initialization possible?", "body": "<p>I should first say I don't think what I want to do is possible (having read what I think are the relevant parts of the ISO C99) but here is rough idea of what I have now:</p>\n\n<pre><code>struct foo {\n    int x;\n    int *y;\n};\n\n#define FOO_INITIALIZER(name) \\\n{                             \\\n    .x = 1,                   \\\n    .y = &amp;(name).x,           \\\n}\n\nstruct foo bar = FOO_INITIALIZER(bar);\n</code></pre>\n\n<p>This works in C99/C11 but what I really want is to drop the name parameter to the FOO_INITIALIZER macro. Is that possible?</p>\n\n<p>I know this doesn't work:</p>\n\n<pre><code>#define FOO_INITIALIZER       \\\n{                             \\\n    .x = 1,                   \\\n    .y = &amp;.x,                 \\\n}\n</code></pre>\n\n<p>If it is possible what section of ISO/IEC 9899:TC3 should I be looking in?</p>\n"}, {"tags": ["c", "windows", "cygwin", "eof", "getchar"], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 10122451, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mR7Qi.jpg?s=128&g=1", "display_name": "Ewan", "link": "https://stackoverflow.com/users/10122451/ewan"}, "edited": false, "score": 0, "creation_date": 1543428054, "post_id": 53525377, "comment_id": 93919802, "body": "Thanks! didn&#39;t notice that."}, {"owner": {"reputation": 5, "user_id": 10122451, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mR7Qi.jpg?s=128&g=1", "display_name": "Ewan", "link": "https://stackoverflow.com/users/10122451/ewan"}, "edited": false, "score": 0, "creation_date": 1543428194, "post_id": 53525377, "comment_id": 93919875, "body": "Ctrl+D still does nothing though. None of my original code has that typo :)"}, {"owner": {"reputation": 735, "user_id": 6106763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb5326862aea0afa1b0c4a8206e53c1e?s=128&d=identicon&r=PG&f=1", "display_name": "contrapants", "link": "https://stackoverflow.com/users/6106763/contrapants"}, "reply_to_user": {"reputation": 5, "user_id": 10122451, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mR7Qi.jpg?s=128&g=1", "display_name": "Ewan", "link": "https://stackoverflow.com/users/10122451/ewan"}, "edited": false, "score": 0, "creation_date": 1543435102, "post_id": 53525377, "comment_id": 93923158, "body": "Ctrl+D works for me with the example code you provided. I&#39;m also using Cygwin on Windows 7."}, {"owner": {"reputation": 5, "user_id": 10122451, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mR7Qi.jpg?s=128&g=1", "display_name": "Ewan", "link": "https://stackoverflow.com/users/10122451/ewan"}, "edited": false, "score": 0, "creation_date": 1543451429, "post_id": 53525377, "comment_id": 93928742, "body": "Can I ask if you are using MinGW?"}, {"owner": {"reputation": 735, "user_id": 6106763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb5326862aea0afa1b0c4a8206e53c1e?s=128&d=identicon&r=PG&f=1", "display_name": "contrapants", "link": "https://stackoverflow.com/users/6106763/contrapants"}, "reply_to_user": {"reputation": 5, "user_id": 10122451, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mR7Qi.jpg?s=128&g=1", "display_name": "Ewan", "link": "https://stackoverflow.com/users/10122451/ewan"}, "edited": false, "score": 0, "creation_date": 1543496656, "post_id": 53525377, "comment_id": 93946449, "body": "I&#39;m using gcc 7.3.0 (x86_64-pc-cygwin). It&#39;s not MinGW."}], "tags": [], "owner": {"reputation": 735, "user_id": 6106763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb5326862aea0afa1b0c4a8206e53c1e?s=128&d=identicon&r=PG&f=1", "display_name": "contrapants", "link": "https://stackoverflow.com/users/6106763/contrapants"}, "is_accepted": true, "score": 0, "last_activity_date": 1543427646, "creation_date": 1543427646, "answer_id": 53525377, "question_id": 53523925, "link": "https://stackoverflow.com/questions/53523925/cygwin-controld-on-windows-7-doesnt-give-eof-signal/53525377#53525377", "title": "Cygwin Control+D on Windows 7 doesn&#39;t give EOF signal", "body": "<p>It's still Ctrl+D. You have a typo in your code. You are not assigning the return value of <code>getchar</code> to <code>c</code>. Remove an equals sign.</p>\n\n<pre><code>while ((c = getchar()) != EOF)\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 10122451, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mR7Qi.jpg?s=128&g=1", "display_name": "Ewan", "link": "https://stackoverflow.com/users/10122451/ewan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 0, "closed_date": 1543435406, "accepted_answer_id": 53525377, "answer_count": 1, "score": 0, "last_activity_date": 1543617983, "creation_date": 1543422214, "last_edit_date": 1543617983, "question_id": 53523925, "link": "https://stackoverflow.com/questions/53523925/cygwin-controld-on-windows-7-doesnt-give-eof-signal", "closed_reason": "Duplicate", "title": "Cygwin Control+D on Windows 7 doesn&#39;t give EOF signal", "body": "<p>I recently installed Cygwin64 and I am trying to run a C program which takes input from the keyboard using getchar</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n// copies input to output\n\nint main()\n{\n    int c;\n\n    while ((c = getchar()) != EOF)\n        putchar(c);\n}\n</code></pre>\n\n<p>I have used stty -a to check what keyboard signals do what and EOF is correctly mapped to ctrl+D however it does nothing</p>\n\n<p><a href=\"https://github.com/mintty/mintty/issues/577\" rel=\"nofollow noreferrer\">I have read that there may be a conflict with MinGW which I am also using</a></p>\n\n<p>My solution is switching to using the Cygwin terminal inside VS Code which instead uses windows keyboard signals </p>\n"}, {"tags": ["c++", "c", "sockets", "udp", "winsock"], "comments": [{"owner": {"reputation": 6578, "user_id": 10524386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe8a1950a1d7e1eccd4cff228c5420ea?s=128&d=identicon&r=PG", "display_name": "grapes", "link": "https://stackoverflow.com/users/10524386/grapes"}, "edited": false, "score": 0, "creation_date": 1543422081, "post_id": 53523822, "comment_id": 93916625, "body": "8304 or 8034? Maybe this is a problem?"}, {"owner": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 1, "creation_date": 1543422100, "post_id": 53523822, "comment_id": 93916632, "body": "Your code binds to port 8034, not 8304. Also check that your bind() call succeeds. If it does, you might not be using &quot;packet sender&quot; correctly."}, {"owner": {"reputation": 116, "user_id": 10620492, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e82cf6813a5d77475d81c6f63bd5b9?s=128&d=identicon&r=PG&f=1", "display_name": "HappyKeyboard", "link": "https://stackoverflow.com/users/10620492/happykeyboard"}, "edited": false, "score": 1, "creation_date": 1543425127, "post_id": 53523822, "comment_id": 93918333, "body": "check the return value of <code>bind</code>, and if it fails, <code>errno</code> is set.. you could print it for detailed debug info"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 116, "user_id": 10620492, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e82cf6813a5d77475d81c6f63bd5b9?s=128&d=identicon&r=PG&f=1", "display_name": "HappyKeyboard", "link": "https://stackoverflow.com/users/10620492/happykeyboard"}, "edited": false, "score": 1, "creation_date": 1543465922, "post_id": 53523822, "comment_id": 93931724, "body": "@HappyKeyboard this is on Windows, so the error code is returned by <code>WSAGetLastError()</code>, not <code>errno</code>. But your point is valid."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1543466041, "post_id": 53523822, "comment_id": 93931756, "body": "@Alophind on a side note, <code>buffer</code> is not null-terminated, but you are treating it like it were. <code>recvfrom()</code> returns the number of bytes actually read, so change <code>cout &lt;&lt; buffer</code> to <code>cout.write(buffer, rc)</code>. Also, you should exit your code if any of the socket functions fail, but you are not doing that."}, {"owner": {"reputation": 812, "user_id": 837741, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/1S5NG.gif?s=128&g=1", "display_name": "Alophind", "link": "https://stackoverflow.com/users/837741/alophind"}, "reply_to_user": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 0, "creation_date": 1543476990, "post_id": 53523822, "comment_id": 93935508, "body": "@nos I&#39;ve noticed I did write 8304 and not 8034 but this was typo , It still didnt work"}, {"owner": {"reputation": 812, "user_id": 837741, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/1S5NG.gif?s=128&g=1", "display_name": "Alophind", "link": "https://stackoverflow.com/users/837741/alophind"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1543477274, "post_id": 53523822, "comment_id": 93935625, "body": "@RemyLebeau Can I just null terminate it using buffer[rc] = &#39;\\0&#39;; ? (my buffer size is +1 long than message size)"}, {"owner": {"reputation": 812, "user_id": 837741, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/1S5NG.gif?s=128&g=1", "display_name": "Alophind", "link": "https://stackoverflow.com/users/837741/alophind"}, "reply_to_user": {"reputation": 116, "user_id": 10620492, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e82cf6813a5d77475d81c6f63bd5b9?s=128&d=identicon&r=PG&f=1", "display_name": "HappyKeyboard", "link": "https://stackoverflow.com/users/10620492/happykeyboard"}, "edited": false, "score": 0, "creation_date": 1543477610, "post_id": 53523822, "comment_id": 93935759, "body": "@HappyKeyboard Last error after bind is 0  , and I know the Packet sender is ok because I see when using Port Listenr on 8034 , that I get the ascii string"}, {"owner": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 1, "creation_date": 1543482439, "post_id": 53523822, "comment_id": 93938121, "body": "You&#39;ve suppressed the error from recvfrom() (when rc &lt; 0), are you sure your recvfrom() call does not fail ?"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1543501463, "post_id": 53523822, "comment_id": 93949197, "body": "@Alophind you <i>can</i> null-terminate the <code>buffer</code> (you would have to use <code>sizeof(buffer)-1</code> in <code>recvfrom()</code> to make sure you don&#39;t overwrite a valid byte read), but there is really no need to. If you null-terminate, you are making the system have to re-calculate the size you already have in <code>rc</code>. Best to use that size instead of ignore it"}], "owner": {"reputation": 812, "user_id": 837741, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/1S5NG.gif?s=128&g=1", "display_name": "Alophind", "link": "https://stackoverflow.com/users/837741/alophind"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 65, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1543477059, "creation_date": 1543421856, "last_edit_date": 1543477059, "question_id": 53523822, "link": "https://stackoverflow.com/questions/53523822/recvfrom-doesnt-get-any-udp-messages", "title": "recvfrom() doesn&#39;t get any UDP messages", "body": "<p>I'm trying to get UDP messages that are being sent from different applications on my machine.</p>\n\n<p>I created a socket and bind it to an address. When I send UDP messages using Packet Sender, nothing arrives. I tried disabling the firewall just to be sure, and still nothing happens.</p>\n\n<p>I send messages to 127.0.0.1 port 8034.</p>\n\n<p>I tried binding to both 127.0.0.1 and INADDR_ANY, neither work.</p>\n\n<p>This is the code I'm using to listen :</p>\n\n<pre><code>SOCKET SendSocket = INVALID_SOCKET;\nsockaddr_in RecvAddr, ClientAddr;\nWSADATA wsaData;\nstruct sockaddr_in serv, client;\nint l = sizeof(client);\nchar buffer[256];\n\nint iResult = WSAStartup(MAKEWORD(2, 2), &amp;wsaData);\nif (iResult != NO_ERROR) {\n    wprintf(L\"WSAStartup failed with error: %d\\n\", iResult);\n}\n\nSendSocket = socket(AF_INET, SOCK_DGRAM, IPPROTO_UDP);\nif (SendSocket == INVALID_SOCKET) {\n    wprintf(L\"socket failed with error: %ld\\n\", WSAGetLastError());\n    WSACleanup();\n}\n\nClientAddr.sin_addr.S_un.S_addr = htonl(INADDR_ANY);\nClientAddr.sin_family = AF_INET;\nClientAddr.sin_port = htons(8034);\n\nbind(SendSocket, (struct sockaddr *) &amp;ClientAddr, sizeof(ClientAddr));\n\nbool valid = true;\n\nwhile( valid )\n{\n    //cout &lt;&lt; \"\\ngoing to recv\\n\";\n    int rc = recvfrom(SendSocket, buffer, sizeof(buffer), 0, (struct sockaddr *)&amp;client, &amp;l);\n    if (rc &lt; 0)\n    {\n        //cout &lt;&lt; \"ERROR READING FROM SOCKET\";\n    }\n    else\n    {\n        cout &lt;&lt; \"\\n the message received is : \" &lt;&lt; buffer &lt;&lt; endl;\n    }\n\n    DoPostDrawTask( valid );\n}\n</code></pre>\n"}, {"tags": ["c", "char", "int", "scanf"], "comments": [{"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 1, "creation_date": 1543422002, "post_id": 53523783, "comment_id": 93916570, "body": "You want to read base 16 numbers? Did you read <a href=\"https://en.cppreference.com/w/c/io/fscanf\" rel=\"nofollow noreferrer\">the documentation</a>?"}], "answers": [{"tags": [], "owner": {"reputation": 28, "user_id": 6261633, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ryQdXUhYGxY/AAAAAAAAAAI/AAAAAAAAAJg/O3xk3JEOrYg/photo.jpg?sz=128", "display_name": "mato0", "link": "https://stackoverflow.com/users/6261633/mato0"}, "is_accepted": false, "score": 0, "last_activity_date": 1543422463, "creation_date": 1543422463, "answer_id": 53523995, "question_id": 53523783, "link": "https://stackoverflow.com/questions/53523783/how-to-scanf-if-there-could-be-a-char-or-int-in-the-same-input-position/53523995#53523995", "title": "How to scanf if there could be a char or int in the same input position", "body": "<p>Firstly, you can store everything you scanned in <code>int</code> and also as <code>char</code>.\nWhen you want to print it after scanning. You can do it from both types.</p>\n"}, {"tags": [], "owner": {"reputation": 2244, "user_id": 5520680, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/C1jQH.png?s=128&g=1", "display_name": "Tom&#39;s", "link": "https://stackoverflow.com/users/5520680/toms"}, "is_accepted": false, "score": 0, "last_activity_date": 1543423436, "creation_date": 1543423436, "answer_id": 53524259, "question_id": 53523783, "link": "https://stackoverflow.com/questions/53523783/how-to-scanf-if-there-could-be-a-char-or-int-in-the-same-input-position/53524259#53524259", "title": "How to scanf if there could be a char or int in the same input position", "body": "<p>You can do something like that :</p>\n\n<pre><code>int main(void)\n{\n    char *line[] = {\"10 3 128\", \"16 2 F\", NULL};\n    int  nb1;\n    int  nb2;\n    int  nb3;\n    char letter;\n    char end;\n\n\n    for (size_t i = 0; line[i]; ++i) {\n\n        if (end = EOF, sscanf(line[i], \"%d %d %d%c\", &amp;nb1, &amp;nb2, &amp;nb3, &amp;end) == 3 &amp;&amp; end == EOF) {\n            printf(\"number number number : %d %d %d\\n\", nb1, nb2, nb3);\n        } else if (end = EOF, sscanf(line[i], \"%d %d %c%c\", &amp;nb1, &amp;nb2, &amp;letter, &amp;end) == 3 &amp;&amp; end == EOF) {\n            printf(\"number number letter : %d %d %c\\n\", nb1, nb2, letter);\n        } else {\n            printf(\"format line not supported : %s\\n\", line[i]);\n        }\n    }\n\n    return (0);\n}\n</code></pre>\n\n<p>Be really warry that le \"%c\" will accept any character, like '1', so maybe you will want to restrict the value get in %c at something you consider a letter.</p>\n"}], "owner": {"reputation": 41, "user_id": 10420311, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-R7pDlKGJeLY/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DUR71w3sA3njK7LzXOTQYzJev0NKA/mo/photo.jpg?sz=128", "display_name": "Stan Marsh", "link": "https://stackoverflow.com/users/10420311/stan-marsh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1543423436, "creation_date": 1543421706, "question_id": 53523783, "link": "https://stackoverflow.com/questions/53523783/how-to-scanf-if-there-could-be-a-char-or-int-in-the-same-input-position", "title": "How to scanf if there could be a char or int in the same input position", "body": "<p>For example, if I have an input that looks like this : 10 3 128, but also have a second input that looks like this: 16 2 F</p>\n\n<p>How can i scan these values?\nI've tried reading it as a string and then trying to convert it to an int or leaving it as a char if needed.</p>\n\n<pre><code>fscanf(in, \"%d %d %c or %d, from, to, numorhex);\n</code></pre>\n\n<p>My program is basically a numeral system converter, and i'd like to know how to scan hex characters as well as ints.</p>\n"}, {"tags": ["c", "linux"], "comments": [{"owner": {"reputation": 1, "user_id": 156458, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/3PCjR.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/156458/tim"}, "edited": false, "score": 0, "creation_date": 1543434595, "post_id": 53523675, "comment_id": 93922930, "body": "I just found <a href=\"https://unix.stackexchange.com/questions/315812/why-does-argv-include-the-program-name\" title=\"why does argv include the program name\">unix.stackexchange.com/questions/315812/&hellip;</a>"}, {"owner": {"reputation": 1, "user_id": 156458, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/3PCjR.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/156458/tim"}, "edited": false, "score": 0, "creation_date": 1543435459, "post_id": 53523675, "comment_id": 93923320, "body": "and <a href=\"https://unix.stackexchange.com/questions/484734/is-argv-0-of-execve-required-to-be-the-same-as-the-basename-component-of\" title=\"is argv 0 of execve required to be the same as the basename component of\">unix.stackexchange.com/questions/484734/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 156458, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/3PCjR.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/156458/tim"}, "edited": false, "score": 0, "creation_date": 1543423262, "post_id": 53523720, "comment_id": 93917294, "body": "Thanks. could you be specific about &quot;BusyBox uses links to provide different functionality based on the name with which the executable is called&quot;?"}, {"owner": {"reputation": 26680, "user_id": 1806780, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/NCB41.jpg?s=128&g=1", "display_name": "Sami Kuhmonen", "link": "https://stackoverflow.com/users/1806780/sami-kuhmonen"}, "reply_to_user": {"reputation": 1, "user_id": 156458, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/3PCjR.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/156458/tim"}, "edited": false, "score": 0, "creation_date": 1543423891, "post_id": 53523720, "comment_id": 93917685, "body": "@Tim BusyBox is kind of \u201call shell tools in one binary.\u201d There\u2019s only one executable on disk and tools like ls, cp etc are links to the binary. When it\u2019s run by ls the binary can check from the argument list that it was run as ls and should provide that functionality. When as cp it will function as cp. So regardless of the actual binary file the executed program can have different \u201cname\u201d for how it was being run."}], "tags": [], "owner": {"reputation": 26680, "user_id": 1806780, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/NCB41.jpg?s=128&g=1", "display_name": "Sami Kuhmonen", "link": "https://stackoverflow.com/users/1806780/sami-kuhmonen"}, "is_accepted": true, "score": 3, "last_activity_date": 1543421540, "creation_date": 1543421540, "answer_id": 53523720, "question_id": 53523675, "link": "https://stackoverflow.com/questions/53523675/do-the-first-two-arguments-in-exec-functions-contain-redundant-information/53523720#53523720", "title": "Do the first two arguments in exec* functions contain redundant information?", "body": "<p>They often do have the same information but it\u2019s not redundant. The first is the name of the executable, but the second is what the executable sees as the name. For example, BusyBox uses links to provide different functionality based on the name with which the executable is called. So sometimes you want to give a different name to the called binary than the one on disk. </p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 156458, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/3PCjR.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/156458/tim"}, "edited": false, "score": 0, "creation_date": 1543450199, "post_id": 53523734, "comment_id": 93928497, "body": "Thanks. Out of curiosity, is <code>execl()</code> your favourite out of the exec* family, in cases when several of them are applicable?"}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 2, "last_activity_date": 1543421593, "creation_date": 1543421593, "answer_id": 53523734, "question_id": 53523675, "link": "https://stackoverflow.com/questions/53523675/do-the-first-two-arguments-in-exec-functions-contain-redundant-information/53523734#53523734", "title": "Do the first two arguments in exec* functions contain redundant information?", "body": "<p>By convention, the first argument to a program (i.e. <code>argv[0]</code>) is the name of the program being executed, however it doesn't necessarily have to be.</p>\n\n<p>For example:</p>\n\n<pre><code>execl(\"/bin/ls\", \"ls\", \"-l\", (void *)NULL);\n</code></pre>\n\n<p>In this case, the program to run is the full path to the executable, while the first argument is just the executable name without the path.</p>\n"}, {"tags": [], "owner": {"reputation": 2244, "user_id": 5520680, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/C1jQH.png?s=128&g=1", "display_name": "Tom&#39;s", "link": "https://stackoverflow.com/users/5520680/toms"}, "is_accepted": false, "score": 2, "last_activity_date": 1543421918, "last_edit_date": 1543421918, "creation_date": 1543421609, "answer_id": 53523739, "question_id": 53523675, "link": "https://stackoverflow.com/questions/53523675/do-the-first-two-arguments-in-exec-functions-contain-redundant-information/53523739#53523739", "title": "Do the first two arguments in exec* functions contain redundant information?", "body": "<p>You can give anything you want as arg (the second argument).\nEven \"nothing\" (arg = [NULL]).</p>\n\n<p>The only effect it will have is that the program called will have as argv exactly what you give it throught arg.</p>\n\n<p>However, some program expect to always have argv[0] and doesn't check if argv[0] is NULL or not. If you give nothing, you can break the program called.</p>\n\n<p>Other than that, it should not cause any problem has any sane program will check his argument.</p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 156458, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/3PCjR.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/156458/tim"}, "edited": false, "score": 0, "creation_date": 1543450291, "post_id": 53524252, "comment_id": 93928513, "body": "Thanks. Is <code>execvp</code> the only one out of the exec* family which you can apply the workaround? ( I guess yes)"}], "tags": [], "owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "is_accepted": false, "score": 1, "last_activity_date": 1543423390, "creation_date": 1543423390, "answer_id": 53524252, "question_id": 53523675, "link": "https://stackoverflow.com/questions/53523675/do-the-first-two-arguments-in-exec-functions-contain-redundant-information/53524252#53524252", "title": "Do the first two arguments in exec* functions contain redundant information?", "body": "<p>If you feel you won't ever want the first array member to differ from the first argument, you can always wrap the function to avoid the repetion:</p>\n\n<pre><code>int my_execvp(char const *argv) { return execvp(argv[0],argv); }\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 156458, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/3PCjR.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/156458/tim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 0, "accepted_answer_id": 53523720, "answer_count": 4, "score": 3, "last_activity_date": 1543423390, "creation_date": 1543421394, "last_edit_date": 1543421792, "question_id": 53523675, "link": "https://stackoverflow.com/questions/53523675/do-the-first-two-arguments-in-exec-functions-contain-redundant-information", "title": "Do the first two arguments in exec* functions contain redundant information?", "body": "<p>I seem to miss something about those exec* functions. </p>\n\n<p>The first argument is the filename or pathname of  the executable to be executed. </p>\n\n<p>The second argument (when <code>l</code>) or the first element of the second argument (when <code>v</code>) is also something similar. For example, <a href=\"https://stackoverflow.com/q/53522695/156458\">here</a>.</p>\n\n<p>Do we really need to repeatedly duplicate redundancy? Thanks.</p>\n"}, {"tags": ["c", "function", "static", "initialization"], "comments": [{"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 1, "creation_date": 1543420473, "post_id": 53523325, "comment_id": 93915555, "body": "Static variables are initialized at compile time."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 1, "creation_date": 1543420531, "post_id": 53523325, "comment_id": 93915597, "body": "Besides, at which invocation of the function should the assignment with n occur?"}, {"owner": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 1, "creation_date": 1543420567, "post_id": 53523325, "comment_id": 93915626, "body": "Do you want <code>number = n</code> on only the very first call of <code>function()</code> , or on every call (in which case you don&#39;t need it to be static) ?"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 2, "creation_date": 1543420599, "post_id": 53523325, "comment_id": 93915653, "body": "@PaulOgilvie I wont say during compile time, rather, just before starting the execution."}], "answers": [{"comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 2, "creation_date": 1543420681, "post_id": 53523383, "comment_id": 93915709, "body": "@Luke seems like a problem in your design, if you have to initalize it in every call, why&#39;d you need <code>static</code>?"}, {"owner": {"reputation": 3723, "user_id": 1169091, "user_type": "registered", "accept_rate": 9, "profile_image": "https://i.stack.imgur.com/5vE4L.jpg?s=128&g=1", "display_name": "nicomp", "link": "https://stackoverflow.com/users/1169091/nicomp"}, "edited": false, "score": 2, "creation_date": 1543420692, "post_id": 53523383, "comment_id": 93915714, "body": "You haven&#39;t provided enough information to discuss a workaround. What are you trying to accomplish?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9885271"}, "edited": false, "score": 0, "creation_date": 1543421005, "post_id": 53523383, "comment_id": 93915936, "body": "I&#39;m calling this function in a while loop with always the same argument. So I want to initialize it only once, and whenever the function is called I want to work with the modified static value."}, {"owner": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 0, "creation_date": 1543421293, "post_id": 53523383, "comment_id": 93916116, "body": "@luke <code>static int number  = 0; if (number == 0) { number = n;};</code> could be enough. However you should rather return the modified <code>number</code> and pass it back in as an argument on the next invocation , so you avoid a whole class of potential issues."}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 4, "last_activity_date": 1543420823, "last_edit_date": 1543420823, "creation_date": 1543420469, "answer_id": 53523383, "question_id": 53523325, "link": "https://stackoverflow.com/questions/53523325/initialize-static-variable-with-the-argument-of-a-function/53523383#53523383", "title": "Initialize static variable with the argument of a function", "body": "<p>You cannot.</p>\n\n<p>Quoting the <code>C11</code> standard, chapter \u00a76.7.9/P4</p>\n\n<blockquote>\n  <p>All the expressions in an initializer for an object that has <code>static</code> or thread storage duration\n  shall be constant expressions or string literals.</p>\n</blockquote>\n\n<p>To elaborate, the objects with <code>static</code> storage duration are initialized only once, prior to the execution to the program. Thereby, it is not possible to use a run-time value to be used as the explicit initializer.</p>\n\n<p>Related, from chapter \u00a76.2.4</p>\n\n<blockquote>\n  <p>An object whose identifier is declared [...] with the storage-class\n  specifier <code>static</code>, has static storage duration. Its lifetime is the entire execution of the\n  program and its stored value is initialized only once, prior to program startup.</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 352, "user_id": 2565746, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/EZssQ.jpg?s=128&g=1", "display_name": "dragonxlwang", "link": "https://stackoverflow.com/users/2565746/dragonxlwang"}, "edited": false, "score": 0, "creation_date": 1610409457, "post_id": 53523640, "comment_id": 116119060, "body": "It&#39;s initialized at first time <code>function</code> is being called: <a href=\"https://en.cppreference.com/w/cpp/language/storage_duration#Static_local_variables\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/language/&hellip;</a> re initialized the first time control passes through their declaration (unless their initialization is zero- or constant-initialization, which can be performed before the block is first entered). On all further calls, the declaration is skipped. the OP&#39;s code looks legit to me although it doesn&#39;t really useful in practice;"}], "tags": [], "owner": {"reputation": 61409, "user_id": 485343, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e18b024a122df74275dd2c4486e8a2b4?s=128&d=identicon&r=PG", "display_name": "rustyx", "link": "https://stackoverflow.com/users/485343/rustyx"}, "is_accepted": true, "score": 4, "last_activity_date": 1543423767, "last_edit_date": 1543423767, "creation_date": 1543421249, "answer_id": 53523640, "question_id": 53523325, "link": "https://stackoverflow.com/questions/53523325/initialize-static-variable-with-the-argument-of-a-function/53523640#53523640", "title": "Initialize static variable with the argument of a function", "body": "<p>If you want to initialize the static variable to <code>n</code> during the first invocation of the function, you can do it like this:</p>\n\n<pre><code>void function(int n)\n{\n    static int initialized = 0;\n    static int number;\n\n    if (!initialized) {\n        number = n;\n        initialized = 1;\n    }\n    .\n    .\n    .\n}\n</code></pre>\n\n<p>You can't initialize <code>number</code> to <code>n</code> directly since <code>number</code> is initialized at compile time, while <code>n</code> is known only at run time.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9885271"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 857, "favorite_count": 0, "accepted_answer_id": 53523640, "answer_count": 2, "score": 1, "last_activity_date": 1543423767, "creation_date": 1543420266, "question_id": 53523325, "link": "https://stackoverflow.com/questions/53523325/initialize-static-variable-with-the-argument-of-a-function", "title": "Initialize static variable with the argument of a function", "body": "<p>How can I do something like this?</p>\n\n<pre><code>void function(int n)\n{\n    static int number = n;\n    .\n    .\n    .\n}\n</code></pre>\n"}, {"tags": ["c", "struct", "typedef"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 4, "creation_date": 1543419982, "post_id": 53523167, "comment_id": 93915219, "body": "<code>typedef</code> works on types, not variables."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1543419995, "post_id": 53523167, "comment_id": 93915227, "body": "Just to spare some keystrokes?"}, {"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 4, "creation_date": 1543420084, "post_id": 53523167, "comment_id": 93915286, "body": "No, you can&#39;t do that in C. <code>my_foo.a</code>, for instance, isn&#39;t a type, so it can&#39;t be <code>typedef</code>ed. Nor is <code>protocol</code>, the way you want to use it, a &quot;type&quot;. What are you trying to accomplish? Looks like perhaps you should use macros. <i>E.g.</i>, <code>#define protocol my_foo.a</code>, then you could write <code>protocol = ...</code>. Or you could <code>#define a protocol</code> and write <code>my_foo.protocol = ...</code>. Be careful about such shortcuts, though, as they may seem convenient at the time, but can lead to a lot of confusion later for a reader of the code."}, {"owner": {"reputation": 1775, "user_id": 3715151, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/8gMtb.png?s=128&g=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/3715151/daniel"}, "edited": false, "score": 0, "creation_date": 1543420390, "post_id": 53523167, "comment_id": 93915492, "body": "&quot;Just to spare some keystrokes?&quot; --- To satisfy my curiosity."}, {"owner": {"reputation": 1775, "user_id": 3715151, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/8gMtb.png?s=128&g=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/3715151/daniel"}, "reply_to_user": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 1, "creation_date": 1543420515, "post_id": 53523167, "comment_id": 93915588, "body": "@lurker Your comment works as an answer for me. Thanks. (If you answer with it I&#39;ll be happy to accept it.)"}, {"owner": {"reputation": 15221, "user_id": 1023911, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Wln26.jpg?s=128&g=1", "display_name": "Werner Henze", "link": "https://stackoverflow.com/users/1023911/werner-henze"}, "edited": false, "score": 0, "creation_date": 1543429538, "post_id": 53523167, "comment_id": 93920489, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/48182676/c-equivalent-to-c-decltype\">C equivalent to C++ decltype</a>"}], "owner": {"reputation": 1775, "user_id": 3715151, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/8gMtb.png?s=128&g=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/3715151/daniel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1543419781, "creation_date": 1543419781, "question_id": 53523167, "link": "https://stackoverflow.com/questions/53523167/typedef-members-of-a-struct-in-c", "title": "Typedef members of a struct in C", "body": "<p><strong>Question:</strong> Can we create an alias for a member of a struct?</p>\n\n<p>Assume we have the following structure with not so helpful variable names (which could themselves be other structures):</p>\n\n<pre><code>struct foo {\n    type a;\n    type b;\n    type c;\n};\n</code></pre>\n\n<p>Is there a way to essentially do (inside a function) for a specific <code>struct foo</code> or all <code>struct foo</code>:</p>\n\n<pre><code>struct foo my_foo;\n\ntypedef my_foo.a protocol;\ntypedef my_foo.b local;\ntypedef my_foo.c remote;\n\n// or\n\ntypedef (struct foo).a protocol;\n</code></pre>\n\n<p>To use directly as:</p>\n\n<pre><code>protocol = ...        // instead of my_foo.a\n\nor\n\nmy_foo.protocol = ... // instead of my_foo.a and similar my_bar.a\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 54921, "user_id": 294949, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/3326427b9c2edc60ad293fdf51c5ba4c?s=128&d=identicon&r=PG&f=1", "display_name": "danh", "link": "https://stackoverflow.com/users/294949/danh"}, "edited": false, "score": 5, "creation_date": 1543419842, "post_id": 53523147, "comment_id": 93915099, "body": "clang? and on which line?"}, {"owner": {"reputation": 1, "user_id": 10717935, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ksy3OSjffWA/AAAAAAAAAAI/AAAAAAAANaE/x6PW7kOxyN8/photo.jpg?sz=128", "display_name": "infinite8", "link": "https://stackoverflow.com/users/10717935/infinite8"}, "reply_to_user": {"reputation": 54921, "user_id": 294949, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/3326427b9c2edc60ad293fdf51c5ba4c?s=128&d=identicon&r=PG&f=1", "display_name": "danh", "link": "https://stackoverflow.com/users/294949/danh"}, "edited": false, "score": 0, "creation_date": 1543419979, "post_id": 53523147, "comment_id": 93915217, "body": "The compiler doesn&#39;t specify, sadly"}, {"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 1, "creation_date": 1543420613, "post_id": 53523147, "comment_id": 93915660, "body": "What compiler doesn&#39;t at the very least report what line an error is on?"}, {"owner": {"reputation": 1, "user_id": 10717935, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ksy3OSjffWA/AAAAAAAAAAI/AAAAAAAANaE/x6PW7kOxyN8/photo.jpg?sz=128", "display_name": "infinite8", "link": "https://stackoverflow.com/users/10717935/infinite8"}, "edited": false, "score": 0, "creation_date": 1543420934, "post_id": 53523147, "comment_id": 93915877, "body": "It&#39;s an independent compiler for Android, It just doesn&#39;t &#175;\\_(\u30c4)_/&#175;"}, {"owner": {"reputation": 1189, "user_id": 9232218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ced53adbb0ba08d1cea65a43b124d?s=128&d=identicon&r=PG&f=1", "display_name": "Yastanub", "link": "https://stackoverflow.com/users/9232218/yastanub"}, "edited": false, "score": 0, "creation_date": 1543421064, "post_id": 53523147, "comment_id": 93915989, "body": "Is it capable of compiling C code? <code>#include &quot;stdio.h&quot;</code> looks strange did you just copy paste the header in or why are you using <code>&quot;&quot;</code> instead of <code>&lt;&gt;</code>? Or does the preprocessor demands that?"}, {"owner": {"reputation": 1, "user_id": 10717935, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ksy3OSjffWA/AAAAAAAAAAI/AAAAAAAANaE/x6PW7kOxyN8/photo.jpg?sz=128", "display_name": "infinite8", "link": "https://stackoverflow.com/users/10717935/infinite8"}, "edited": false, "score": 0, "creation_date": 1543421129, "post_id": 53523147, "comment_id": 93916030, "body": "&quot; &quot; works just fine and I typed the code myself"}, {"owner": {"reputation": 1189, "user_id": 9232218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ced53adbb0ba08d1cea65a43b124d?s=128&d=identicon&r=PG&f=1", "display_name": "Yastanub", "link": "https://stackoverflow.com/users/9232218/yastanub"}, "edited": false, "score": 0, "creation_date": 1543421222, "post_id": 53523147, "comment_id": 93916087, "body": "Maybe it would be useful to tell which compiler you are using since this seems to be a compiler problem."}, {"owner": {"reputation": 1, "user_id": 10717935, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ksy3OSjffWA/AAAAAAAAAAI/AAAAAAAANaE/x6PW7kOxyN8/photo.jpg?sz=128", "display_name": "infinite8", "link": "https://stackoverflow.com/users/10717935/infinite8"}, "edited": false, "score": 0, "creation_date": 1543421287, "post_id": 53523147, "comment_id": 93916111, "body": "It was called &quot;C4Droid&quot; the last time I checked, so.."}, {"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 0, "creation_date": 1543421827, "post_id": 53523147, "comment_id": 93916464, "body": "comment 1 line and recompile; if the same error persists assume it&#39;s because it&#39;s on a different line, so repeat until you find the &#39;guilty&#39; line. If the same error exists on more than 1 line, this will not find the error :("}, {"owner": {"reputation": 1, "user_id": 10717935, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ksy3OSjffWA/AAAAAAAAAAI/AAAAAAAANaE/x6PW7kOxyN8/photo.jpg?sz=128", "display_name": "infinite8", "link": "https://stackoverflow.com/users/10717935/infinite8"}, "edited": false, "score": 0, "creation_date": 1543421957, "post_id": 53523147, "comment_id": 93916539, "body": "Thank you, I&#39;ll try that in a bit"}, {"owner": {"reputation": 6072, "user_id": 2142950, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bZGrD.png?s=128&g=1", "display_name": "Klaus G&#252;tter", "link": "https://stackoverflow.com/users/2142950/klaus-g%c3%bctter"}, "edited": false, "score": 0, "creation_date": 1543427718, "post_id": 53523147, "comment_id": 93919640, "body": "Google for &quot;C4Droid illegal instruction&quot;, you will get several hits"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10717935, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ksy3OSjffWA/AAAAAAAAAAI/AAAAAAAANaE/x6PW7kOxyN8/photo.jpg?sz=128", "display_name": "infinite8", "link": "https://stackoverflow.com/users/10717935/infinite8"}, "edited": false, "score": 0, "creation_date": 1543423981, "post_id": 53524049, "comment_id": 93917730, "body": "I&#39;ve done plenty of coding on the compiler but never once saw this error, I even tried using &quot;&lt;&gt;&quot; but to no avail."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1543424196, "post_id": 53524049, "comment_id": 93917825, "body": "While using ` #include &quot;stdio.h&quot;` instead of ` #include &lt;stdio.h&gt;` is unusual, it is most likely not the problem here."}, {"owner": {"reputation": 380, "user_id": 7369171, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DvM0o.png?s=128&g=1", "display_name": "LeedMx", "link": "https://stackoverflow.com/users/7369171/leedmx"}, "edited": false, "score": 0, "creation_date": 1543424855, "post_id": 53524049, "comment_id": 93918182, "body": "The problem is not related to c but to a specific compiler and its libraries implementation. It needed to be pointed out."}, {"owner": {"reputation": 1, "user_id": 10717935, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ksy3OSjffWA/AAAAAAAAAAI/AAAAAAAANaE/x6PW7kOxyN8/photo.jpg?sz=128", "display_name": "infinite8", "link": "https://stackoverflow.com/users/10717935/infinite8"}, "edited": false, "score": 0, "creation_date": 1543458893, "post_id": 53524049, "comment_id": 93930306, "body": "I really have no idea on what the problem is here"}], "tags": [], "owner": {"reputation": 380, "user_id": 7369171, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DvM0o.png?s=128&g=1", "display_name": "LeedMx", "link": "https://stackoverflow.com/users/7369171/leedmx"}, "is_accepted": false, "score": 0, "last_activity_date": 1543424701, "last_edit_date": 1543424701, "creation_date": 1543422621, "answer_id": 53524049, "question_id": 53523147, "link": "https://stackoverflow.com/questions/53523147/compiler-says-illegal-instruction-to-a-piece-of-simple-code/53524049#53524049", "title": "Compiler says &quot;Illegal Instruction&quot; to a piece of simple code", "body": "<p>When you use </p>\n\n<pre><code> #include \"stdio.h\"\n</code></pre>\n\n<p>You are indicating that the compiler should look for the stdio.h in a specific location known to the compiler (usually the source file directory but it can vary depending on the compiler), the illegal instruction migth be due to either a faulty (badly implemented library) or simply a non existent stdio.h  </p>\n\n<p>This is why compilers usually have their standard libraries on their own known location and it's referred to by using </p>\n\n<pre><code> #include &lt;stdio.h&gt;\n</code></pre>\n\n<p>Since the compiler you're using does not provide details, there's no way to know where is the error originating</p>\n\n<p>Edit: You could test your code in incremental steps avoiding the use of printf and scanf, this can be accomplished by using test variables and return values. As I've said there's no way to know exactly where the faulty instruction is being generated due to a non-standard stdio.h implementation but my guess is the scanf return signature which means an uncompilable for loop. Test your code</p>\n"}], "owner": {"reputation": 1, "user_id": 10717935, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ksy3OSjffWA/AAAAAAAAAAI/AAAAAAAANaE/x6PW7kOxyN8/photo.jpg?sz=128", "display_name": "infinite8", "link": "https://stackoverflow.com/users/10717935/infinite8"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 93, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1543424701, "creation_date": 1543419721, "last_edit_date": 1543420815, "question_id": 53523147, "link": "https://stackoverflow.com/questions/53523147/compiler-says-illegal-instruction-to-a-piece-of-simple-code", "title": "Compiler says &quot;Illegal Instruction&quot; to a piece of simple code", "body": "<p>It's just a simple code for checking if a number is prime or not, I don't know if it is the compiler or the code which is the problem here.\nA bit of help would be greatly appreciated.</p>\n\n<p>Here is the code:</p>\n\n<pre><code>#include \"stdio.h\"\nint main()\n{\n    int n,i,c=0;\n    printf (\"\\n Enter a Number:\");\n    scanf (\"%d\",&amp;n);\n    for (i=1;i&lt;=n;i++)\n    {\n         if (n%i==0)\n         {\n             c++;\n         }\n     }\n     if (c==2)\n     {\n         printf (\"\\n Prime Number\");\n     }\n     else\n     {\n         printf (\"\\n Not a Prime Number\");\n     }\n     return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "pointers", "for-loop", "struct"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 2, "creation_date": 1543419572, "post_id": 53523086, "comment_id": 93914907, "body": "Error message came with a line number, inn&#39;it?"}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 1, "creation_date": 1543419576, "post_id": 53523086, "comment_id": 93914911, "body": "And where does this error occur?"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1543419654, "post_id": 53523086, "comment_id": 93914966, "body": "Also, I dont think, <code>Savings</code> and <code>AccNo</code> need to be arrays."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1543419674, "post_id": 53523086, "comment_id": 93914982, "body": "<code>temp = (ptr + y)-&gt;Savings;</code> is wrong: <code>temp</code> is <code>long long</code> but the r-side is <code>struct Data *</code>."}, {"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 0, "creation_date": 1543419676, "post_id": 53523086, "comment_id": 93914984, "body": "<code>scanf(&quot;%[^\\n]s&quot;</code> will attempt to read a literal factual <code>&#39;s&#39;</code>. The &#39;s&#39; does not belong in the conversion string"}, {"owner": {"reputation": 13, "user_id": 10464602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c98d4f5f8207b6ad1eaf38f1b4505e2d?s=128&d=identicon&r=PG&f=1", "display_name": "SALOMO", "link": "https://stackoverflow.com/users/10464602/salomo"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1543419722, "post_id": 53523086, "comment_id": 93915016, "body": "The error occur in <code>(ptr + y)-&gt;Savings = (ptr + y + 1)-&gt;Savings;</code> and <code>(ptr + y + 1)-&gt;Savings = temp;</code> @PaulOgilvie"}, {"owner": {"reputation": 4522, "user_id": 5157478, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bBcym.png?s=128&g=1", "display_name": "Frankie_C", "link": "https://stackoverflow.com/users/5157478/frankie-c"}, "edited": false, "score": 0, "creation_date": 1543420096, "post_id": 53523086, "comment_id": 93915298, "body": "In the bubble-sort algorithm you&#39;re trying to assign the array <code>long long int Savings[100]</code> to a simple <code>long long int temp</code>. Surely the bubble-sort example you used as base for your code worked with object pointers, assigning pointers to pointers, but you are mixing arrays and single variables."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 10464602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c98d4f5f8207b6ad1eaf38f1b4505e2d?s=128&d=identicon&r=PG&f=1", "display_name": "SALOMO", "link": "https://stackoverflow.com/users/10464602/salomo"}, "edited": false, "score": 1, "creation_date": 1543420972, "post_id": 53523302, "comment_id": 93915908, "body": "Thank you very much!  I really appreciate it."}, {"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "reply_to_user": {"reputation": 13, "user_id": 10464602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c98d4f5f8207b6ad1eaf38f1b4505e2d?s=128&d=identicon&r=PG&f=1", "display_name": "SALOMO", "link": "https://stackoverflow.com/users/10464602/salomo"}, "edited": false, "score": 0, "creation_date": 1543421427, "post_id": 53523302, "comment_id": 93916212, "body": "@SALOMO welcome to Stackoverflow! You posted a question with an MCVE, which is a very good thing! Next time, indent your code, too, +1! ;)"}], "tags": [], "owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "is_accepted": true, "score": 0, "last_activity_date": 1543422126, "last_edit_date": 1543422126, "creation_date": 1543420212, "answer_id": 53523302, "question_id": 53523086, "link": "https://stackoverflow.com/questions/53523086/assignment-to-expression-with-array-type-error/53523302#53523302", "title": "Assignment to expression with array type error", "body": "<ol>\n<li>You need to compile your code with warnings enabled, the will guide\nyou through debugging step by step. Try to eliminate one, and\ncompile again. In GCC for example, you would use <code>-Wall</code> flag.</li>\n<li>The numerical fields of your struct should be just numbers, not\narrays. Moreover, having their type as <code>long long int</code> seems a bit\ntoo much, but I leave that on you.</li>\n<li>Having <code>(ptr + y)-&gt;Savings</code> to access the <code>y</code>-th element of an array\nof structs and the its field names <code>Savings</code> is technically correct,\nbut it's much more cleaner (thus increases readability and\nmaintainability) to write <code>ptr[y].Savings</code>. That is a general rule,\napplying to the rest of your code.</li>\n<li>I believe the above led you to make two syntactical errors when you\nwere reading the numerical data of the customers with <code>scanf()</code>,\nsince you know that an integer in general needs the <code>&amp;</code> operator. If\nyou had used the clean approach from the start, you wouldn't made\nthose, I believe.</li>\n<li>For <code>long long int</code> use the <code>%lld</code> format specifier, not just <code>%d</code>.</li>\n<li>In Bubblesort, when you find elements that need to be swapped, then\nswap the whole elements, not just their <code>Savings</code>s. I recommend\ncreating a function to do that.</li>\n<li><code>scanf(\"%[^\\n]s\"</code> doesn't make much sense, I would change it to\n<code>scanf(\"%99s\"</code>, where 99 is the maximum size of your string, minus\none. Read more in the 2nd paragraph in <a href=\"https://stackoverflow.com/a/40536900/2411320\">scanf(\u201c%[^\\n]s\u201d,a) question</a>.</li>\n</ol>\n\n<p>Putting everything together, we get:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nstruct Data {\n    long long int Savings, AccNo; // these should be numbers, not arrays\n    char Name[100];\n};\n\nvoid swap(struct Data* a, struct Data* b) {\n    struct Data tmp;\n    tmp.Savings = a-&gt;Savings;\n    tmp.AccNo = a-&gt;AccNo;\n    strcpy(tmp.Name, a-&gt;Name);\n\n    a-&gt;Savings = b-&gt;Savings;\n    a-&gt;AccNo = b-&gt;AccNo;\n    strcpy(a-&gt;Name, b-&gt;Name);\n\n    b-&gt;Savings = tmp.Savings;\n    b-&gt;AccNo = tmp.AccNo;\n    strcpy(b-&gt;Name, tmp.Name);\n}\n\nint main() {\n    struct Data *ptr;\n    int n, i, x, y;\n\n    printf(\"Enter number of customer(s) : \");\n    scanf(\"%d\", &amp;n);\n\n    ptr = malloc (n * sizeof(struct Data)); // do not cast malloc\n\n    for(i=0; i&lt;n; i++) {\n        printf(\"Enter customer %d\", i+1);\n        printf(\"\\nName : \");\n        getchar();\n        scanf(\"%99s\", ptr[i].Name); // ptr is a pointer, but now you want to actually use it as an array, so use '.'\n        printf(\"Savings : \");\n        scanf(\"%lld\", &amp;ptr[i].Savings); // needs &amp;, just like you did for 'n'. USe `%lld' for long lont int as the format specifier.\n        printf(\"Account Number : \");\n        scanf(\"%lld\", &amp;ptr[i].AccNo);   // needs &amp;, just like you did for 'n'. USe `%lld' for long lont int as the format specifier.\n        printf(\"\\n\");\n    }\n\n    //Sorting bubblesort\n    for (x = 0; x &lt; n; x++)\n    {\n        for (y = 0; y &lt; n - x - 1; y++) // you don't need paranetheses in the stop condition\n        {\n            if (ptr[y].Savings &gt; ptr[y + 1].Savings)\n            {\n                swap(&amp;ptr[y], &amp;ptr[y + 1]); // swap the whole element, not just its savings\n            }\n        }\n    }\n\n    //Print sorted\n    printf(\"\\nSorted customers are:\\n\");\n    for(i=0; i&lt;n; ++i)\n    {\n        printf(\"%s\\n\", (ptr+i)-&gt;Name);\n        printf(\"%lld\\n\", (ptr+i)-&gt;Savings);\n    }\n    free(ptr);\n    return 0;\n}\n</code></pre>\n\n<p>Output (with relevant input):</p>\n\n<pre><code>Sorted customers are:\nGeorge\n1\nBabis\n3\nTheodor\n20\n</code></pre>\n\n<p>PS: <a href=\"https://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc\">Do I cast the result of malloc?</a> No!</p>\n"}], "owner": {"reputation": 13, "user_id": 10464602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c98d4f5f8207b6ad1eaf38f1b4505e2d?s=128&d=identicon&r=PG&f=1", "display_name": "SALOMO", "link": "https://stackoverflow.com/users/10464602/salomo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1511, "favorite_count": 0, "accepted_answer_id": 53523302, "answer_count": 1, "score": 1, "last_activity_date": 1543422126, "creation_date": 1543419521, "last_edit_date": 1543421529, "question_id": 53523086, "link": "https://stackoverflow.com/questions/53523086/assignment-to-expression-with-array-type-error", "title": "Assignment to expression with array type error", "body": "<p>in this program I try to sort customer savings descendingly. And I've tried to compile the code. And I'm still not to understand about pointer. There is an error with message \"Assignment to expression with array type error\". The target output of this program is tend to be the sorted customers(with their names, and account numbers). I've search in the internet about that error. But I still don't get the solution. Can someone help me to solve the error? Thanks.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nstruct Data\n{\n  long long int Savings[100], AccNo[100];\n  char Name[100];\n};\n\nint main ()\n{\n  struct Data *ptr;\n  int n, i, j, swap = 1, x, y;\n  long long int max, min, temp;\n\n  printf (\"Enter number of customer(s) : \");\n  scanf (\"%d\", &amp;n);\n\n  ptr = (struct Data *) malloc (n * sizeof (struct Data));\n\n  for (i = 0; i &lt; n; i++)\n    {\n      printf (\"Enter customer %d\", i + 1);\n      printf (\"\\nName : \");\n      getchar ();\n      scanf (\"%[^\\n]s\", &amp;(ptr + i)-&gt;Name);\n      printf (\"Savings : \");\n      scanf (\"%d\", &amp;(ptr + i)-&gt;Savings);\n      printf (\"Account Number : \");\n      scanf (\"%d\", &amp;(ptr + i)-&gt;AccNo);\n      printf (\"\\n\");\n    }\n\n  //Sorting bubblesort\n  for (x = 0; x &lt; n; x++)\n    {\n      for (y = 0; y &lt; (n - x - 1); y++)\n    {\n      if ((ptr + y)-&gt;Savings &gt; (ptr + y + 1)-&gt;Savings)\n        {\n          temp = (ptr + y)-&gt;Savings;\n          (ptr + y)-&gt;Savings = (ptr + y + 1)-&gt;Savings;\n          (ptr + y + 1)-&gt;Savings = temp;\n        }\n    }\n    }\n\n  //Print sorted\n  printf (\"\\n Sorted customers are (:\\n\");\n  for (i = 0; i &lt; n; ++i)\n    {\n      printf (\"%s\\n\", (ptr + i)-&gt;Name);\n      printf (\"%d\\n\", (ptr + i)-&gt;Savings);\n    }\n  free (ptr);\n  return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "webkitgtk", "webkit2"], "comments": [{"owner": {"reputation": 2621, "user_id": 722238, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/52ad57e08b18f75e6aaaddd9a0cd59dc?s=128&d=identicon&r=PG&f=1", "display_name": "fbynite", "link": "https://stackoverflow.com/users/722238/fbynite"}, "edited": false, "score": 0, "creation_date": 1543428017, "post_id": 53522964, "comment_id": 93919787, "body": "you post some code, that&#39;s what you do."}, {"owner": {"reputation": 901, "user_id": 550292, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f007116df8b3b452c8a2fc45e816eb69?s=128&d=identicon&r=PG", "display_name": "Anschel Schaffer-Cohen", "link": "https://stackoverflow.com/users/550292/anschel-schaffer-cohen"}, "reply_to_user": {"reputation": 2621, "user_id": 722238, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/52ad57e08b18f75e6aaaddd9a0cd59dc?s=128&d=identicon&r=PG&f=1", "display_name": "fbynite", "link": "https://stackoverflow.com/users/722238/fbynite"}, "edited": false, "score": 0, "creation_date": 1543446888, "post_id": 53522964, "comment_id": 93927678, "body": "@fbynite Thanks, added. I look forward to reading your suggestions now that the question is more clear."}], "owner": {"reputation": 901, "user_id": 550292, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f007116df8b3b452c8a2fc45e816eb69?s=128&d=identicon&r=PG", "display_name": "Anschel Schaffer-Cohen", "link": "https://stackoverflow.com/users/550292/anschel-schaffer-cohen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 22, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1543446854, "creation_date": 1543419155, "last_edit_date": 1543446854, "question_id": 53522964, "link": "https://stackoverflow.com/questions/53522964/how-do-i-get-the-image-title-attribute-for-the-image-under-the-cursor-in-webkit2", "title": "How do I get the image title attribute for the image under the cursor in WebKit2GTK", "body": "<p>This seems like a really dumb question, but I can't figure out what to Google. I want the xkcd hovertext, which is the <code>title</code> attribute of the <code>img</code> tag. <code>WebKitHitTestResult</code> has <code>get_link_uri</code>, <code>get_link_title</code>, and <code>get_image_uri</code>, but not <code>get_image_title</code>. What do I do?</p>\n\n<p>EDIT: Here is the existing code, from the source for the <code>surf</code> browser, which grabs the link, image, or media URI but ignores the title attribute, if any</p>\n\n<pre><code>void\nmousetargetchanged(WebKitWebView *v, WebKitHitTestResult *h, guint modifiers,\n    Client *c)\n{\n    WebKitHitTestResultContext hc = webkit_hit_test_result_get_context(h);\n\n    /* Keep the hit test to know where is the pointer on the next click */\n    c-&gt;mousepos = h;\n\n    if (hc &amp; OnLink)\n        c-&gt;targeturi = webkit_hit_test_result_get_link_uri(h);\n    else if (hc &amp; OnImg)\n        c-&gt;targeturi = webkit_hit_test_result_get_image_uri(h);\n    else if (hc &amp; OnMedia)\n        c-&gt;targeturi = webkit_hit_test_result_get_media_uri(h);\n    else\n        c-&gt;targeturi = NULL;\n\n    c-&gt;overtitle = c-&gt;targeturi;\n    updatetitle(c);\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "pointers"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1543419136, "post_id": 53522907, "comment_id": 93914592, "body": "<code>tblPtr = &amp;tbl;</code> not a very good conversion - I must say."}, {"owner": {"reputation": 6578, "user_id": 10524386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe8a1950a1d7e1eccd4cff228c5420ea?s=128&d=identicon&r=PG", "display_name": "grapes", "link": "https://stackoverflow.com/users/10524386/grapes"}, "edited": false, "score": 0, "creation_date": 1543419281, "post_id": 53522907, "comment_id": 93914714, "body": "Hard mix of static and dynamic arrays, specially void genTbl(unsigned int encodeTbl[][2])"}, {"owner": {"reputation": 6578, "user_id": 10524386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe8a1950a1d7e1eccd4cff228c5420ea?s=128&d=identicon&r=PG", "display_name": "grapes", "link": "https://stackoverflow.com/users/10524386/grapes"}, "edited": false, "score": 0, "creation_date": 1543419331, "post_id": 53522907, "comment_id": 93914752, "body": "try tblPtr= tbl"}, {"owner": {"reputation": 225, "user_id": 8122162, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208981872692154/picture?type=large", "display_name": "jonnyx", "link": "https://stackoverflow.com/users/8122162/jonnyx"}, "reply_to_user": {"reputation": 6578, "user_id": 10524386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe8a1950a1d7e1eccd4cff228c5420ea?s=128&d=identicon&r=PG", "display_name": "grapes", "link": "https://stackoverflow.com/users/10524386/grapes"}, "edited": false, "score": 0, "creation_date": 1543419575, "post_id": 53522907, "comment_id": 93914909, "body": "@grapes, why dynamic, it is basically defined at compile time how big the table is..."}], "answers": [{"comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 225, "user_id": 8122162, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208981872692154/picture?type=large", "display_name": "jonnyx", "link": "https://stackoverflow.com/users/8122162/jonnyx"}, "edited": false, "score": 0, "creation_date": 1543419471, "post_id": 53523006, "comment_id": 93914832, "body": "@jonnyx You have got the same problem in function2 also."}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": true, "score": 2, "last_activity_date": 1543420333, "last_edit_date": 1543420333, "creation_date": 1543419287, "answer_id": 53523006, "question_id": 53522907, "link": "https://stackoverflow.com/questions/53522907/pointer-on-2d-array-segfaults/53523006#53523006", "title": "Pointer on 2D array segfaults", "body": "<p>In your <code>function1()</code>, you already invoked <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">undefined behaviour</a>.</p>\n\n<p>You have defined the array like <code>static unsigned int tbl[3][2];</code>, so the valid access would be <code>tbl[i][j];</code>, where <code>0&lt;i&lt;3</code> and <code>0&lt;j&lt;2</code>. Thus, in the code</p>\n\n<pre><code>return (tbl[2][2]);\n</code></pre>\n\n<p>is using memory out of bounds, it's <a href=\"https://en.wikipedia.org/wiki/Off-by-one_error\" rel=\"nofollow noreferrer\">off-by-one</a>. You have the same problem also in <code>function2()</code> also.</p>\n\n<p>That said, the statement</p>\n\n<pre><code> tblPtr = &amp;tbl; \n</code></pre>\n\n<p>is invalid, and it is a constraint violation. Any conorming  compiler with proper warnings enabled will warn you about the statement. YOu need to change the type of <code>tblPtr</code> to be a pointer to an array of 2 <code>int</code>s, something like</p>\n\n<pre><code> unsigned int (*tblPtr)[2];  \n</code></pre>\n\n<p>and then, the assignment would stand valid.</p>\n"}, {"comments": [{"owner": {"reputation": 225, "user_id": 8122162, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208981872692154/picture?type=large", "display_name": "jonnyx", "link": "https://stackoverflow.com/users/8122162/jonnyx"}, "edited": false, "score": 0, "creation_date": 1543421067, "post_id": 53523305, "comment_id": 93915992, "body": "well when i put it outside of my function, it will be in program memory and not lying in stack... I have to few space available for that."}], "tags": [], "owner": {"reputation": 153, "user_id": 10701729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cee22930db17f383d9df2488deb8696d?s=128&d=identicon&r=PG&f=1", "display_name": "Leonardo Silvagni", "link": "https://stackoverflow.com/users/10701729/leonardo-silvagni"}, "is_accepted": false, "score": 0, "last_activity_date": 1543420215, "creation_date": 1543420215, "answer_id": 53523305, "question_id": 53522907, "link": "https://stackoverflow.com/questions/53522907/pointer-on-2d-array-segfaults/53523305#53523305", "title": "Pointer on 2D array segfaults", "body": "<p>Declare tblPtr as a user defined type with \n</p>\n\n<pre><code>typedef unsigned int myType[3][2];\nmyType **tblPtr;          //pointer to table\n</code></pre>\n\n<p>With this method you declare it explicitly as a pointer to a bidimensional array of unsigned ints.\nAnd then put <code>static unsigned int tbl[3][2]</code> outside of function 1</p>\n"}], "owner": {"reputation": 225, "user_id": 8122162, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208981872692154/picture?type=large", "display_name": "jonnyx", "link": "https://stackoverflow.com/users/8122162/jonnyx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 53523006, "answer_count": 2, "score": 0, "last_activity_date": 1543420889, "creation_date": 1543418994, "last_edit_date": 1543420889, "question_id": 53522907, "link": "https://stackoverflow.com/questions/53522907/pointer-on-2d-array-segfaults", "title": "Pointer on 2D array segfaults", "body": "<p>I have the following minimal example where my main function calls two different functions <code>function1()</code> and <code>function2()</code>. They both want to work on a table, which needs to be generated in the first run of <code>function1()</code>. In my actual program the table is much bigger, that is why I don't want it hard-coded in the program memory as a global variable but calculated in the first round of the code. I declared the table static, such that it keeps the assigned values when the functions are leaved. I am not sure if the <code>tblPtr</code> needs to be <code>static</code> too. Why do I get a SEGFAULT here?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nstatic void genTbl(unsigned int encodeTbl[][2])\n{\n    int nn,mm;\n    for (nn=0; nn &lt; 3;nn++){\n        for (mm=0; mm &lt; 2; mm++){\n            encodeTbl[nn][mm] = nn+mm; //some example\n        }\n    }\n}\nunsigned int **tblPtr;          //pointer to table\nstatic unsigned int function1()\n{\n    static int t1=0;\n    static unsigned int tbl[3][2];\n    if(t1==0){ //only gen table in first round\n        t1++;\n        genTbl(tbl);\n        tblPtr = &amp;tbl; //assign pointer \n        t1++;\n    }\n    return (tbl[2][2]);\n}\nstatic unsigned int function2()\n{\n   //also wants to work with tbl\n   return (tblPtr[2][2]);   //SEGFAULT\n}\n\nint main()\n{\n    int cnt=0;\n    while(cnt&lt;5){\n        int f1 = function1();\n        printf(\"function1 return: %d\\n\", f1);\n        int f2 = function2();\n        printf(\"function1 return: %d\\n\", f2);\n        cnt++;\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "struct"], "comments": [{"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 5, "creation_date": 1543418687, "post_id": 53522768, "comment_id": 93914278, "body": "It is not clear what you are asking. Seems you are doing fine. What&#39;s the problem?"}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1543418812, "post_id": 53522768, "comment_id": 93914377, "body": "The <code>;</code> after <code>distance_of_points</code> will not compile. Typo?"}, {"owner": {"reputation": 9, "user_id": 10691344, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/298ad9312376a5a8fe3153a7389afb75?s=128&d=identicon&r=PG&f=1", "display_name": "Oof", "link": "https://stackoverflow.com/users/10691344/oof"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1543418821, "post_id": 53522768, "comment_id": 93914383, "body": "The function doesn&#39;t calculate the distance, and im not quiet sure why it isnt"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1543418851, "post_id": 53522768, "comment_id": 93914398, "body": "You know, <code>POINT</code> is not a type, <code>struct POINT</code> is. That said, <code>pow((POINT p1)</code> should better be <code>pow((p1)...</code>, most likely."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 2, "creation_date": 1543418930, "post_id": 53522768, "comment_id": 93914460, "body": "1) <code>pow</code> does not take a <code>POINT</code> as argument. 2) You cannot pass a type name in a function call: remove the word <code>POINT</code>. Turn warnings of your compiler on; a walhala of information will be bestowed upon you."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1543419068, "post_id": 53522768, "comment_id": 93914551, "body": "Lookup in your math how to calculate the distance between points in a 2d plane."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1543419245, "post_id": 53522768, "comment_id": 93914689, "body": "Check in the spec which types <code>pow()</code> expects. Generally it won&#39;t be one you have defined yourself."}], "answers": [{"comments": [{"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1543419462, "post_id": 53523037, "comment_id": 93914826, "body": "Is distance absolute?"}, {"owner": {"reputation": 9, "user_id": 10691344, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/298ad9312376a5a8fe3153a7389afb75?s=128&d=identicon&r=PG&f=1", "display_name": "Oof", "link": "https://stackoverflow.com/users/10691344/oof"}, "edited": false, "score": 0, "creation_date": 1543419573, "post_id": 53523037, "comment_id": 93914908, "body": "sry, i had them turned on, but I didn&#39;t really knew/learned how to use Structs b4 :| But thanks for the fast reply, now ik how its done!  *(ik what was wrong now^^)  i somehow suspected it had to do with my decleration of the point within the function but i didnt quiet knew what was wrong"}], "tags": [], "owner": {"reputation": 259, "user_id": 2710319, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c62e82d1d25764466572d0aa49b0b2c5?s=128&d=identicon&r=PG", "display_name": "HeLLo", "link": "https://stackoverflow.com/users/2710319/hello"}, "is_accepted": false, "score": 1, "last_activity_date": 1543419380, "creation_date": 1543419380, "answer_id": 53523037, "question_id": 53522768, "link": "https://stackoverflow.com/questions/53522768/how-to-link-struct-to-the-function/53523037#53523037", "title": "How to Link struct to the Function?", "body": "<pre><code>double distance_of_points(struct POINT p1, struct POINT p2)\n{\n    return sqrt(pow((p1.x - p2.x), 2) + pow((p1.y - p2.y), 2));\n};\n</code></pre>\n\n<p>Turn on your compiler warnings!</p>\n"}], "owner": {"reputation": 9, "user_id": 10691344, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/298ad9312376a5a8fe3153a7389afb75?s=128&d=identicon&r=PG&f=1", "display_name": "Oof", "link": "https://stackoverflow.com/users/10691344/oof"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1543419380, "creation_date": 1543418515, "last_edit_date": 1543419069, "question_id": 53522768, "link": "https://stackoverflow.com/questions/53522768/how-to-link-struct-to-the-function", "title": "How to Link struct to the Function?", "body": "<p>I don't quite know how the function works together with the concept of structs.<br>\nCould somebody explain or show me how it can be done?</p>\n\n<p>Code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\n\nstruct POINT {\n    double x;\n    double y;\n};\n\ndouble distance_of_points(struct POINT p1, struct POINT p2)\n{\n    return sqrt(pow((POINT p1), 2) + pow((POINT p2), 2));\n};\n\n\nint main(void)\n{\n    struct POINT X={1., 1.}, Y={2., 2.}, Z={-2., -1};\n    printf(\"Die Entfernung von X und Y betraegt: %.2f\\n\", distance_of_points(X, Y) );\n    printf(\"Die Entfernung von X und Z betraegt: %.2f\\n\", distance_of_points(X, Z) );\n    printf(\"Die Entfernung von Y und Z betraegt: %.2f\\n\", distance_of_points(Z, Y) );\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "libsndfile"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1543418169, "post_id": 53522618, "comment_id": 93913914, "body": "What have you tried? What problems did you encounter?"}, {"owner": {"reputation": 1444, "user_id": 7105378, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BcC0z.jpg?s=128&g=1", "display_name": "alpereira7", "link": "https://stackoverflow.com/users/7105378/alpereira7"}, "edited": false, "score": 0, "creation_date": 1543996267, "post_id": 53522618, "comment_id": 94114767, "body": "This might help: <a href=\"https://stackoverflow.com/a/53298543/7105378\">stackoverflow.com/a/53298543/7105378</a>."}], "owner": {"reputation": 11, "user_id": 10717864, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-lT14xeYggFg/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-iEnl49A_laoeKuAoLjVpBpzNLVPA/mo/photo.jpg?sz=128", "display_name": "started", "link": "https://stackoverflow.com/users/10717864/started"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 21, "favorite_count": 0, "closed_date": 1543435420, "answer_count": 0, "score": 0, "last_activity_date": 1543418242, "creation_date": 1543418087, "last_edit_date": 1543418242, "question_id": 53522618, "link": "https://stackoverflow.com/questions/53522618/can-you-help-me-to-set-up-libsndfile-to-visual-studio", "closed_reason": "Duplicate", "title": "Can you help me to set up Libsndfile to Visual Studio", "body": "<p>I've just started to learn C for 3 month and now I need to use that library. I downloaded Libsndfile from <a href=\"http://mega-nerd.com/libsndfile\" rel=\"nofollow noreferrer\">http://mega-nerd.com/libsndfile</a>. Now I don't know what to do.</p>\n"}, {"tags": ["c", "macros", "printf", "variadic-macros"], "comments": [{"owner": {"reputation": 45460, "user_id": 1670129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32370783314a7efabe09b6cfadb11b12?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Tandetnik", "link": "https://stackoverflow.com/users/1670129/igor-tandetnik"}, "edited": false, "score": 5, "creation_date": 1543418077, "post_id": 53522586, "comment_id": 93913854, "body": "<code>LogPrintf(&quot;N=%d\\n&quot;)</code> looks like undefined behavior. Where does <code>4</code> come from?"}, {"owner": {"reputation": 45460, "user_id": 1670129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32370783314a7efabe09b6cfadb11b12?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Tandetnik", "link": "https://stackoverflow.com/users/1670129/igor-tandetnik"}, "edited": false, "score": 1, "creation_date": 1543418234, "post_id": 53522586, "comment_id": 93913964, "body": "Have <code>LogPrintf</code> call your own helper function which in turn calls <code>vprintf</code>. That helper can output whatever you want before and/or after."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1543418235, "post_id": 53522586, "comment_id": 93913966, "body": "And I do hope you&#39;re not using <code>stdout</code> for actual logging.  What happens when you need to rotate your log file, or the log file happens to fill up your filesystem?"}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1543418311, "post_id": 53522586, "comment_id": 93914021, "body": "This is not C++ code."}], "answers": [{"comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1543419300, "post_id": 53522818, "comment_id": 93914734, "body": "<i>why not doing it in 3 steps?</i>  One reason could be ensuring that a multithreaded process doesn&#39;t have log entries from different threads jumbled together.  But if the process is single-threaded, that&#39;s not applicable."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1543419672, "post_id": 53522818, "comment_id": 93914979, "body": "as much as I wanted to do that in one printf, that sounded difficult. And 3 calls to printf or one call to printf doesn&#39;t change a thing thread-wise. you can have mixed lines with 2 concurrent printfs already, unless you use mutexes."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1543422425, "post_id": 53522818, "comment_id": 93916805, "body": "Not quite so, @Jean-Fran&#231;oisFabre.  Output to the same file from individual <code>fprintf</code> calls in different threads will not be mixed.  See <a href=\"http://port70.net/~nsz/c/c11/n1570.html#7.21.2p7\" rel=\"nofollow noreferrer\">paragraphs 7.21.2/7-8</a> of the standard.  But output from <i>multiple</i> calls in different threads may be interleaved on a per-call basis."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1543422909, "post_id": 53522818, "comment_id": 93917084, "body": "@JohnBollinger The lock requirement you allude to is C11 (and presumably later) and is missing from <a href=\"https://port70.net/~nsz/c/c99/n1256.html#7.19.2\" rel=\"nofollow noreferrer\">the C99 standard</a>.  There are likely still many running systems out there with C runtime libraries that don&#39;t implement that lock."}], "tags": [], "owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "is_accepted": false, "score": 5, "last_activity_date": 1543418673, "creation_date": 1543418673, "answer_id": 53522818, "question_id": 53522586, "link": "https://stackoverflow.com/questions/53522586/variadic-macro-calling-fprintf-how-to-add-arguments-to-va-args/53522818#53522818", "title": "Variadic Macro calling fprintf: how to add arguments to __VA_ARGS__?", "body": "<p>why not doing it in 3 steps?</p>\n\n<pre><code>#define LogPrintf(f_, ...)   do { fprintf(stdout, \"%s: \",__FUNCTION__); \\\n                                  fprintf(stdout, (f_), ##__VA_ARGS__); \\\n                                  fprintf(stdout,\"\\n\"); } while(0)\n</code></pre>\n\n<p>this does 3 prints, but at least it's simple and does what you want. the <code>do</code> <code>while(0)</code> trick makes sure this is one only block (when using <code>if</code> without braces) and requires semicolon.</p>\n"}, {"comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1543420876, "post_id": 53523139, "comment_id": 93915832, "body": "With respect to the title question, note in particular that prepending or appending arguments to <code>__VA_ARGS__</code> is simple, provided that you rely upon and abide by the requirement of standard C that it always correspond to at least one actual argument.  You can just do it, as my first alternative shows."}, {"owner": {"reputation": 537, "user_id": 2025015, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/6a02fc0716593735b5782f89f9e62cec?s=128&d=identicon&r=PG", "display_name": "Parduz", "link": "https://stackoverflow.com/users/2025015/parduz"}, "edited": false, "score": 0, "creation_date": 1543489003, "post_id": 53523139, "comment_id": 93942271, "body": "Thanks! Your first example worked perfectly, and the other parts of your answer are well explained and useful to learn!"}, {"owner": {"reputation": 537, "user_id": 2025015, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/6a02fc0716593735b5782f89f9e62cec?s=128&d=identicon&r=PG", "display_name": "Parduz", "link": "https://stackoverflow.com/users/2025015/parduz"}, "edited": false, "score": 0, "creation_date": 1543489229, "post_id": 53523139, "comment_id": 93942394, "body": "About the <code>##</code> in <code>##__VA_ARGS__</code>, is the GCC way to handle the trailing &quot;,&quot; if i use just one argument. I can&#39;t find the question from when i picked the original macro, but it is explained also here: <a href=\"https://stackoverflow.com/questions/37206118/va-args-not-swallowing-comma-when-zero-args-under-c99\">link</a>"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 537, "user_id": 2025015, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/6a02fc0716593735b5782f89f9e62cec?s=128&d=identicon&r=PG", "display_name": "Parduz", "link": "https://stackoverflow.com/users/2025015/parduz"}, "edited": false, "score": 0, "creation_date": 1543499875, "post_id": 53523139, "comment_id": 93948317, "body": "I know what the <code>##</code> is for, @Parduz.  I&#39;m just pointing out that the behavior you describe is an <i>extension</i>, not part of standard C, as is calling a variadic macro without at least one variable argument.  Only you can decide whether it&#39;s important to you that your code will not be portable in this regard."}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": true, "score": 2, "last_activity_date": 1543420575, "last_edit_date": 1543420575, "creation_date": 1543419708, "answer_id": 53523139, "question_id": 53522586, "link": "https://stackoverflow.com/questions/53522586/variadic-macro-calling-fprintf-how-to-add-arguments-to-va-args/53523139#53523139", "title": "Variadic Macro calling fprintf: how to add arguments to __VA_ARGS__?", "body": "<p>If you're willing to rely on the first argument to <code>LogPrintf</code> being a string literal, then you should be able to use string concatenation to achieve your objective:</p>\n\n<pre><code>// Assumes f_ always corresponds to a string literal:\n#define LogPrintf(f_, ...)    fprintf(stdout, \"%s: \" f_ \"\\n\", __FUNCTION__, ##__VA_ARGS__)\n</code></pre>\n\n<p>Note, however, that in standard C, the <code>LogPrintf</code> macro requires at least <em>two</em> arguments, and the <code>##</code> has no place.  I keep it here only because you use it in your original code.</p>\n\n<p>If you must accept format string expressions other than string literals, however, then your simplest alternative is to perform multiple I/O calls,  as another answer also suggests:</p>\n\n<pre><code>#define LogPrintf(f_, ...)    do {         \\\n    fprintf(stdout, \"%s: \", __FUNCTION__); \\\n    fprintf(stdout, (f_), ##__VA_ARGS__);  \\\n    fputc('\\n', stdout);                   \\\n} while (0)\n</code></pre>\n\n<p>Note that in this case, the macro expands to a <em>statement</em> (sans trailing semicolon), whereas in the other, the macro expands to an <em>expression</em>.  If you want the return value(s) of any of the I/O functions, then you'll have to make special provisions for that in this case.</p>\n\n<p>If that doesn't work for you either, then the ultimate alternative is to write and use a helper function, as was suggested in comments:</p>\n\n<pre><code>#define LogPrintf(f_, ...)    log_printf_impl(stdout, __FUNCTION__, (f_), ##__VA_ARGS__)\n\nint log_printf_impl(FILE *f, const char *func, const char *fmt, ...) {\n    static const char prefix[] = \"%s: \";\n    size_t flen = strlen(fmt);\n    va_list args;\n    int result = -1;\n    char *aug_fmt = malloc(sizeof(prefix) + strlen(fmt) + 1);\n\n    if (aug_fmt) {\n        va_start(args, fmt);\n        sprintf(aug_fmt, \"%s%s\\n\", prefix, fmt);\n        result = vfprintf(f, aug_fmt, func, args);\n        va_end(args);\n        free(aug_fmt);\n    }\n\n    return result;\n}\n</code></pre>\n"}], "owner": {"reputation": 537, "user_id": 2025015, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/6a02fc0716593735b5782f89f9e62cec?s=128&d=identicon&r=PG", "display_name": "Parduz", "link": "https://stackoverflow.com/users/2025015/parduz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 443, "favorite_count": 0, "accepted_answer_id": 53523139, "answer_count": 2, "score": 3, "last_activity_date": 1543420575, "creation_date": 1543417985, "last_edit_date": 1543418819, "question_id": 53522586, "link": "https://stackoverflow.com/questions/53522586/variadic-macro-calling-fprintf-how-to-add-arguments-to-va-args", "title": "Variadic Macro calling fprintf: how to add arguments to __VA_ARGS__?", "body": "<p>I have two macros:</p>\n\n<pre><code> #define LogFunction(str)       fprintf(stdout, \"%s: %s\\n\",__FUNCTION__,(str))\n #define LogPrintf(f_, ...)     fprintf(stdout, (f_), ##__VA_ARGS__)\n</code></pre>\n\n<p>So i can use them this way:</p>\n\n<pre><code>void MyFunction()\n{\n    int N=4;\n    LogFunction(\"START\");      // Outputs \"MyFunction: START\"\n    LogPrintf(\"N=%d\\n\", N);    // Outputs \"N=4\"\n}\n</code></pre>\n\n<p>What I would like to change is to</p>\n\n<ol>\n<li>add <strong>FUNCTION</strong> at the start of the LogPrintf as it is in LogFunction</li>\n<li>add \"\\n\" at the end of the LogPrintf without having to remember to put it in myself</li>\n</ol>\n\n<p>so in the end i could have just one macro for my outputs.</p>\n\n<p>I've tried to understand if <a href=\"https://stackoverflow.com/questions/4054085/appending-to-va-args\">Appending to __VA_ARGS__</a> could've been useful, but i admit that i've not understood if it is related to my case :(</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["c", "linux"], "comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 3, "creation_date": 1543416316, "post_id": 53521966, "comment_id": 93912682, "body": "<code>*exec*()</code> is not a shell. You could <code>*exec*(&quot;bash -c [whatever]&quot;)</code>."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1543416337, "post_id": 53521966, "comment_id": 93912699, "body": "You could run your string with <code>system()</code>.  To use <code>execvp()</code>, you\u2019ll need to parse it and create  pipes and deal with word expansion on the file name and do the I/O redirection."}], "answers": [{"tags": [], "owner": {"reputation": 2244, "user_id": 5520680, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/C1jQH.png?s=128&g=1", "display_name": "Tom&#39;s", "link": "https://stackoverflow.com/users/5520680/toms"}, "is_accepted": true, "score": 1, "last_activity_date": 1543416616, "creation_date": 1543416616, "answer_id": 53522161, "question_id": 53521966, "link": "https://stackoverflow.com/questions/53521966/execute-a-concatenation-command-with-execvp/53522161#53522161", "title": "Execute a concatenation command with execvp", "body": "<p>You can't use execvp (or any exec* function family) like that.\nFirst of all, the first argument must be the path to the executable file.\nI doubt you have an 'ls | tee ~/outputfile.txt' executable somewhere on your computer.\nYou have 'ls' or 'tee' probably, but not 'ls | tee ~/outputfile.txt'.</p>\n\n<p>Secondly : exec* function family can't do nativly piping (the '|' part) : you have to do it yourself.</p>\n\n<p>An example is the following :</p>\n\n<pre><code>#include &lt;unistd.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main(void)\n{\n    char *const cmd[] = {\"ls\", \"/home\", NULL};\n    execvp(cmd[0], cmd);\n    perror(\"Return from execvp() not expected\");\n\n    exit(EXIT_FAILURE);\n}\n</code></pre>\n\n<p>That will do a ls in \"/home\".\nIt's up to you to pipe it in another execve : <a href=\"https://stackoverflow.com/questions/33884291/pipes-dup2-and-exec\">this</a> can greatly help you.</p>\n\n<p>If you just want to execute your command line wthout any regard for security, you can use \"<a href=\"http://man7.org/linux/man-pages/man3/system.3.html\" rel=\"nofollow noreferrer\">system</a>\"</p>\n"}], "owner": {"reputation": 312, "user_id": 7249301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KZcNT.jpg?s=128&g=1", "display_name": "Ido Segal", "link": "https://stackoverflow.com/users/7249301/ido-segal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 142, "favorite_count": 0, "accepted_answer_id": 53522161, "answer_count": 1, "score": -2, "last_activity_date": 1543416616, "creation_date": 1543416088, "question_id": 53521966, "link": "https://stackoverflow.com/questions/53521966/execute-a-concatenation-command-with-execvp", "title": "Execute a concatenation command with execvp", "body": "<p>How can I execute the following command using execvp, if it's possible:</p>\n\n<blockquote>\n  <p>\"ls | tee ~/outputfile.txt\"</p>\n</blockquote>\n\n<p>I've tried to run the following code but got this message: execvp() not expected: No such file or directory\nI'm not sure for the cause of this issue,\nI can't execute this command because this is concatenation command ?</p>\n\n<pre><code>#include &lt;unistd.h&gt; // execvp()\n#include &lt;stdio.h&gt;  // perror()\n#include &lt;stdlib.h&gt; // EXIT_SUCCESS, EXIT_FAILURE\n\n\nint main(void) {\nchar *const cmd[] = {\"ls | tee ~/outputfile.txt\", NULL};\nexecvp(cmd[0], cmd);\nperror(\"Return from execvp() not expected\");\n\nexit(EXIT_FAILURE);\n}\n</code></pre>\n\n<p>In the bottom line, want to write the output of the command 'ls' to a file in my code.</p>\n\n<p>Thank you in advance!</p>\n"}, {"tags": ["c", "c-strings"], "comments": [{"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1543413536, "post_id": 53521060, "comment_id": 93910917, "body": "You need to do some research on how strings work in C and how they are terminated. You also need to understand the difference between then length of a string and the size of the array the string exists in."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 3, "creation_date": 1543413793, "post_id": 53521060, "comment_id": 93911066, "body": "This is wrong <code>strncpy(dest, src, sizeof(src));</code> It is useless to use the size of the source as a limit. The size of the destination is what matters. <code>dest</code> can only hold strings up to 11 characters while <code>src</code> can hold strings up to a length of 39 characters. As <code>src</code> holds a string longer than 11 characters, you have a buffer overflow which causes undefined behaviour."}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "reply_to_user": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1543414373, "post_id": 53521060, "comment_id": 93911458, "body": "@Gerhardh It&#39;s not so useless, since OP wants the string string length. One way to accomplish this AND protect against buffer overflow is <code>strncpy(dest, src, min(strlen(src), sizeof(dest)-1))</code>"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 1, "creation_date": 1543414471, "post_id": 53521060, "comment_id": 93911522, "body": "Not quite so, @Gerhardh.  If the length parameter to <code>strncpy()</code> is no greater than the source string&#39;s actual length, then <code>strncpy()</code> does not copy the terminator, which is exactly what the OP wants."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "reply_to_user": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1543414481, "post_id": 53521060, "comment_id": 93911529, "body": "@Broman Both <code>src</code> and <code>src2</code> are larger than <code>dest</code>. You need to take minimum length of <code>src</code> and <code>dest</code>"}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "reply_to_user": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1543414538, "post_id": 53521060, "comment_id": 93911567, "body": "@Gerhardh My bad. Fixed."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1543414583, "post_id": 53521060, "comment_id": 93911595, "body": "@JohnBollinger You are right. But it can still overflow the destination buffer."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1543414847, "post_id": 53521060, "comment_id": 93911797, "body": "Yes, @Gerhardh.  So?  Protecting from overflow does not appear to be the purpose for using <code>strncpy</code> here.  And <code>strncpy</code> isn&#39;t exactly intended for that sort of thing anyway.  It has a rather more specific reason for being, which is also reflected by the fact that when the source string is shorter than the specified length, <code>strncpy</code> zero-fills the trailing bytes in the destination, up to the specified total number of bytes."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1543415064, "post_id": 53521060, "comment_id": 93911922, "body": "@JohnBollinger Please note that I are refering to the first call. What other purpose might be there? But I agree, that is not really what the function is intented to be used."}], "answers": [{"comments": [{"owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "reply_to_user": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 1, "creation_date": 1543413687, "post_id": 53521153, "comment_id": 93911008, "body": "@Broman : unless I misunderstood the problem, it does. Have you tried it ?"}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1543413738, "post_id": 53521153, "comment_id": 93911033, "body": "Yes, I tried your code. The output is &quot;ring is a string&quot;"}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 1, "creation_date": 1543413913, "post_id": 53521153, "comment_id": 93911142, "body": "Which is exactly what I did, and since we&#39;re getting different result your code contains undefined behavior."}, {"owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "reply_to_user": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1543413966, "post_id": 53521153, "comment_id": 93911183, "body": "@Broman : good observation - although the undefined behavior is in the original code (buffer overrun). I&#39;ll adjust my answer accordingly."}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1543414023, "post_id": 53521153, "comment_id": 93911216, "body": "No need to adjust. dbush has already given a proper answer. If you have nothing to add to that, better just delete this one."}, {"owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "reply_to_user": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1543415010, "post_id": 53521153, "comment_id": 93911893, "body": "@Broman : while the buffer overrun is an issue worth pointing out, I don&#39;t see it as integral to answering the question as asked (it was probably introduced when creating the mcve)."}], "tags": [], "owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "is_accepted": false, "score": 2, "last_activity_date": 1543414383, "last_edit_date": 1543414383, "creation_date": 1543413534, "answer_id": 53521153, "question_id": 53521060, "link": "https://stackoverflow.com/questions/53521060/how-to-overwrite-part-of-a-string-in-c/53521153#53521153", "title": "How to overwrite part of a string in C?", "body": "<p><code>sizeof(src2)</code> is <code>40</code> (it's the size of the entire array) - you probably meant <code>strlen(src2)</code> (which is just the amount of characters used for the string) :</p>\n\n<pre><code>strncpy(dest, src2, strlen(src2));\n</code></pre>\n\n<p>Note btw that your code has a buffer overrun issue : The <code>dest</code> array is not big enough to hold the resulting string. It needs to be at least 17 characters large to accomodate the <code>\"This is a string\"</code> string. You'll also want to use :</p>\n\n<pre><code>strncpy(dest, src, strlen(src));\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 33, "user_id": 6432041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ff2dc6ea28335521ccadb784785000?s=128&d=identicon&r=PG&f=1", "display_name": "spiderwebdev", "link": "https://stackoverflow.com/users/6432041/spiderwebdev"}, "edited": false, "score": 0, "creation_date": 1543414543, "post_id": 53521222, "comment_id": 93911571, "body": "Great thank you! changing from &quot;sizeof&quot; to &quot;strlen&quot; is what I needed"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 33, "user_id": 6432041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ff2dc6ea28335521ccadb784785000?s=128&d=identicon&r=PG&f=1", "display_name": "spiderwebdev", "link": "https://stackoverflow.com/users/6432041/spiderwebdev"}, "edited": false, "score": 1, "creation_date": 1543414711, "post_id": 53521222, "comment_id": 93911689, "body": "@spiderwebdev Don&#39;t forget to make <code>dest</code> big enough to hold the string."}, {"owner": {"reputation": 2427, "user_id": 4983398, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc9ed33d775a17d6965fd2efbfe4b52?s=128&d=identicon&r=PG", "display_name": "Gardener", "link": "https://stackoverflow.com/users/4983398/gardener"}, "edited": false, "score": 0, "creation_date": 1543416155, "post_id": 53521222, "comment_id": 93912572, "body": "All of this logic assumes that sizeof(dest) - 1 &gt;= strlen(src) &gt;= strlen(src2). As you know the lengths of src and src2, there is no need to call <code>memset()</code>.  Modifying the first strncpy to a strcpy eliminates the redundant call to memset.  However, if this is a mental exercise to prepare for a more general purpose function, then some of the logic is too naive."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 8, "last_activity_date": 1543422121, "last_edit_date": 1543422121, "creation_date": 1543413747, "answer_id": 53521222, "question_id": 53521060, "link": "https://stackoverflow.com/questions/53521060/how-to-overwrite-part-of-a-string-in-c/53521222#53521222", "title": "How to overwrite part of a string in C?", "body": "<p>There are a few issues here.</p>\n\n<p>First, <code>dest</code> is only 12 bytes long, which is too short to hold \"This is a string\".  Trying to copy that string into <code>dest</code> will overrun the buffer.  This invokes <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">undefined behavior</a>.  Make it at least 20 bytes.</p>\n\n<p>Second <code>sizeof(src)</code> gives you the size of the whole array, which is 40, not the length of the string.  This will also give undefined behavior if the destination buffer is not big enough.  Use <code>strlen</code> instead.  The same goes for <code>sizeof(src2)</code>.</p>\n\n<p>With those changes, you should have this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main() {\n    char src[40];\n    char src2[40];\n    char dest[20];\n\n    memset(dest, '\\0', sizeof(dest));\n    strcpy(src, \"This is a string\");\n    strcpy(src2, \"That\");\n    strncpy(dest, src, strlen(src));\n    strncpy(dest, src2, strlen(src2));\n\n    printf(\"Final copied string : %s\\n\", dest);\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2427, "user_id": 4983398, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc9ed33d775a17d6965fd2efbfe4b52?s=128&d=identicon&r=PG", "display_name": "Gardener", "link": "https://stackoverflow.com/users/4983398/gardener"}, "is_accepted": false, "score": 1, "last_activity_date": 1543415663, "creation_date": 1543415663, "answer_id": 53521829, "question_id": 53521060, "link": "https://stackoverflow.com/questions/53521060/how-to-overwrite-part-of-a-string-in-c/53521829#53521829", "title": "How to overwrite part of a string in C?", "body": "<p>I am confused and a little concerned about the <code>memset()</code> call.  The <code>memset</code> call allows the use of strncpy() without worrying about the terminating '\\0'.  Such a call assumes that this logic will be used in a general purpose function that will be called from a higher level function.</p>\n\n<p>If that is not the case, then the first strncpy() should be replaced with a strcpy and the memset should be abandoned:</p>\n\n<pre class=\"lang-c++ prettyprint-override\"><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main() {\n    char src[40];\n    char src2[40];\n    char dest[20];\n\n    /* memset(dest, '\\0', sizeof(dest)); -- No need for this */\n    strcpy(src, \"This is a string\");\n    strcpy(src2, \"That\");\n    strcpy(dest, src, strlen(src)); /* strcpy will put a '\\0' at the end */\n    strncpy(dest, src2, strlen(src2));\n\n    printf(\"Final copied string : %s\\n\", dest);\n}\n</code></pre>\n\n\n\n<p>However, if this will be called from a higher level function, then we really need to check for the lengths of the incoming strings and/or malloc the dest buffer and free it.  The memset() is the elephant in the room that suggests that there is more logic to come which should be considered.  Otherwise, just replace the first strncpy() with a strcpy().</p>\n"}, {"tags": [], "owner": {"reputation": 593, "user_id": 9658875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/841f55a02830a8f0655c07654401670f?s=128&d=identicon&r=PG&f=1", "display_name": "GermanNerd", "link": "https://stackoverflow.com/users/9658875/germannerd"}, "is_accepted": false, "score": 1, "last_activity_date": 1543419085, "creation_date": 1543419085, "answer_id": 53522942, "question_id": 53521060, "link": "https://stackoverflow.com/questions/53521060/how-to-overwrite-part-of-a-string-in-c/53522942#53522942", "title": "How to overwrite part of a string in C?", "body": "<p>Expanding on the answer by @dbush:</p>\n\n<p>I think the code is still quite fragile.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main() {\n    char src[40];\n    char src2[40];\n    char dest[20];\n</code></pre>\n\n<p>Here the first pitfall is created: dest is smaller than both sources. While that can be handled, it requires much more diligence in the subsequent code. It would be better to make the destination <strong>always</strong> large enough to hold the source(s).</p>\n\n<pre><code>memset(dest, '\\0', sizeof(dest)); //Good\n</code></pre>\n\n<p>But it is also a good idea to initialize the other arrays with 0 as well.</p>\n\n<pre><code>memset(src, '\\0', sizeof(src));\nmemset(src2, '\\0', sizeof(src2));\n</code></pre>\n\n<p>Side note: Of course you could save the trouble of memset by just using the array initialization syntax:</p>\n\n<pre><code>    char src[40] = {0};\n    char src2[40] = {0};\n    char dest[20] = {0};\n</code></pre>\n\n<p>The two next lines are potentially dangerous, provided that IRL the two strings might not be string constants. (And even then!) No length checking is provided... Better:</p>\n\n<pre><code>//    strcpy(src, \"This is a string\");\n//    strcpy(src2, \"That\");\n\nstrncpy(src, \"This is a string\", sizeof(src)- 1);\nstrncpy(src2, \"That\", sizeof(src2) -1);\n</code></pre>\n\n<p>That way we make sure we don't cause any overflow.\nWe also make sure that the strings in src and src2 are properly null-terminated.</p>\n\n<p>Now, the copying of src/src2 to dest is also dangerous. We must ensure not to overflow dest.</p>\n\n<pre><code>//strncpy(dest, src, strlen(src));\n//strncpy(dest, src2, strlen(src2));\n</code></pre>\n\n<p>Better:</p>\n\n<pre><code>strncpy(dest, src, sizeof(dest) - 1);\nstrncpy(dest, \"That is a long rubbish string that easily could overflow dest\", sizeof(dest) -1);\n</code></pre>\n\n<p>We only copy as much as dest can hold and preserve the null terminator.</p>\n\n<p>Now to the replacement of the first X characters. Again, we must make sure no overflow occurs. We use strlen to determine the actual size of the null-terminated string in src2, but need to use/evaluate the maximum size of dest. Therefore the mixture of strlen and sizeof.</p>\n\n<p>memcpy just for the fun of it. You could use strncpy just as well.</p>\n\n<pre><code>memcpy(dest, src2, strlen(src2) &lt; sizeof(dest) ? strlen(src2) : sizeof(dest));\n\nprintf(\"Final copied string : %s\\n\", dest);\n</code></pre>\n\n<p>}</p>\n\n<p>So the whole, secure implementation looks like this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main() {\n    char src[40] = {0};\n    char src2[40] = {0};\n    char dest[20] = {0};\n\n\n    strncpy(src, \"This is a string\", sizeof(src)- 1);\n\n    strncpy(src2, \"That is a long rubbish string and sooooooooooooooooooooooooo much more\", sizeof(src2) -1);\n\n    strncpy(dest, src, sizeof(dest) - 1);\n\n    memcpy(dest, src2, strlen(src2) &lt; sizeof(dest) ? strlen(src2) : sizeof(dest));\n\n    printf(\"Final copied string : %s\\n\", dest);\n}\n</code></pre>\n\n<p>Please note that the use of sizeof is only seemingly equivalent to strlen; on char types that works, on other types you need to do more.</p>\n"}], "owner": {"reputation": 33, "user_id": 6432041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ff2dc6ea28335521ccadb784785000?s=128&d=identicon&r=PG&f=1", "display_name": "spiderwebdev", "link": "https://stackoverflow.com/users/6432041/spiderwebdev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 429, "favorite_count": 0, "accepted_answer_id": 53521222, "answer_count": 4, "score": 3, "last_activity_date": 1543422121, "creation_date": 1543413275, "last_edit_date": 1543417280, "question_id": 53521060, "link": "https://stackoverflow.com/questions/53521060/how-to-overwrite-part-of-a-string-in-c", "title": "How to overwrite part of a string in C?", "body": "<p>I have for instance a string. And I only want to change the beginning few characters of the string and leave the rest as they are. What is the best way to do this in C?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main() {\n    char src[40];\n    char src2[40];\n    char dest[12];\n\n    memset(dest, '\\0', sizeof(dest));\n    strcpy(src, \"This is a string\");\n    strcpy(src2, \"That\");\n    strncpy(dest, src, sizeof(src));\n    strncpy(dest, src2, sizeof(src2));\n\n    printf(\"Final copied string : %s\\n\", dest);\n}\n</code></pre>\n\n<p>I would like the string to be changed from <code>\"This is a string\"</code> to <code>\"That is a string\"</code>.</p>\n\n<p>Is there an easy way to accomplish this that I am missing?</p>\n"}, {"tags": ["c", "arrays", "string"], "comments": [{"owner": {"reputation": 145, "user_id": 10005890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba54ee97219486045c6176419b2ad21c?s=128&d=identicon&r=PG&f=1", "display_name": "DDBE", "link": "https://stackoverflow.com/users/10005890/ddbe"}, "reply_to_user": {"reputation": 55, "user_id": 2732791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3465ede38f49f8101ac3d1252937509b?s=128&d=identicon&r=PG&f=1", "display_name": "bhanu7k", "link": "https://stackoverflow.com/users/2732791/bhanu7k"}, "edited": false, "score": 0, "creation_date": 1543413380, "post_id": 53520967, "comment_id": 93910812, "body": "This is what I get:   &quot;Complete string.: AB01 String before first digit.: AB&quot;"}, {"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 0, "creation_date": 1543413409, "post_id": 53520967, "comment_id": 93910834, "body": "Use <a href=\"https://pubs.opengroup.org/onlinepubs/9699919799/functions/strcspn.html\" rel=\"nofollow noreferrer\"><code>strcspn()</code></a> -- <a href=\"https://ideone.com/77chzf\" rel=\"nofollow noreferrer\">see https://ideone.com/77chzf</a>"}, {"owner": {"reputation": 145, "user_id": 10005890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba54ee97219486045c6176419b2ad21c?s=128&d=identicon&r=PG&f=1", "display_name": "DDBE", "link": "https://stackoverflow.com/users/10005890/ddbe"}, "edited": false, "score": 0, "creation_date": 1543414434, "post_id": 53520967, "comment_id": 93911500, "body": "@ pmg Great! thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 145, "user_id": 10005890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba54ee97219486045c6176419b2ad21c?s=128&d=identicon&r=PG&f=1", "display_name": "DDBE", "link": "https://stackoverflow.com/users/10005890/ddbe"}, "edited": false, "score": 0, "creation_date": 1543414451, "post_id": 53521100, "comment_id": 93911509, "body": "@ Mathieu Bunel  Thanks!"}], "tags": [], "owner": {"reputation": 6899, "user_id": 1212012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gmBY7.png?s=128&g=1", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1212012/mathieu"}, "is_accepted": true, "score": 3, "last_activity_date": 1543413375, "creation_date": 1543413375, "answer_id": 53521100, "question_id": 53520967, "link": "https://stackoverflow.com/questions/53520967/get-string-until-first-digit/53521100#53521100", "title": "Get string until first digit", "body": "<p>The function <a href=\"https://linux.die.net/man/3/strcspn\" rel=\"nofollow noreferrer\">strcspn</a> can do it for you:</p>\n\n<blockquote>\n  <p>The strcspn() function calculates the length of the initial segment of s which consists entirely of bytes not in reject. </p>\n</blockquote>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main() {\n\n    char temp[128] = {0};\n    char str_active[128] = {0};\n\n    sprintf(temp, \"%s\", \"AB01\");\n    printf(\"Complete string.: %s\\n\", temp);\n\n    strncpy(str_active, temp, strcspn(temp, \"0123456789\"));\n    printf(\"String before first digit.: %s\\n\", str_active);\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 145, "user_id": 10005890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba54ee97219486045c6176419b2ad21c?s=128&d=identicon&r=PG&f=1", "display_name": "DDBE", "link": "https://stackoverflow.com/users/10005890/ddbe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 53521100, "answer_count": 1, "score": 1, "last_activity_date": 1543415817, "creation_date": 1543413013, "last_edit_date": 1543415817, "question_id": 53520967, "link": "https://stackoverflow.com/questions/53520967/get-string-until-first-digit", "title": "Get string until first digit", "body": "<p>I need to get all the characters before the first digit from an array.\nI did this and it seems to work correctly:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main() {\n    char temp[128] = {0};\n    char str_active[128] = {0};\n\n    sprintf(temp, \"%s\", \"AB01\");\n    printf(\"Complete string.: %s\\n\", temp);\n\n    int len = sizeof(temp) / sizeof(char);\n    int index = 0;\n    while (index &lt; len) {\n        if (isdigit(temp[index])) {\n            break;\n        } else {\n            index++;\n        }\n    }\n    snprintf(str_active, index + 1, \"%s\\n\", temp);\n    printf(\"String before first digit.: %s\\n\", str_active);\n\n    return 0;\n}\n</code></pre>\n\n<p>I'm wondering if I could do the same with less instructions, so in a better way.</p>\n"}, {"tags": ["c", "windows", "winapi", "icons"], "comments": [{"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1543412005, "post_id": 53520513, "comment_id": 93909862, "body": "Try closing Explorer or have it look at another directory. It might be that the file or directory is considered in use."}, {"owner": {"reputation": 1, "user_id": 2047124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e39b96b4bfe0beb5b78fd15251aa8ad8?s=128&d=identicon&r=PG&f=1", "display_name": "kword", "link": "https://stackoverflow.com/users/2047124/kword"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1543412840, "post_id": 53520513, "comment_id": 93910453, "body": "I tried difference directories, old as well as newly created ones, and also tried to set the attributes on a different pc, always the same result. Please have a look at it, too, you will see that it takes its time. And: I want to have the explorer opened or better said the desktop visible (with the icon placed on it) when its visibility changes."}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1543413502, "post_id": 53520513, "comment_id": 93910897, "body": "To be clear, is your issue simply that this is taking on the order of 1 to 2 seconds?  Almost anything with the Windows file system is subject to layers of sludge such as <i><a href=\"https://answers.microsoft.com/en-us/windows/forum/windows8_1-performance/file-explorer-is-super-slow-when-i-ask-for/762e8393-e4cd-4157-b8ed-bd86a6a95f80\" rel=\"nofollow noreferrer\">for example third party context menu handlers</a></i>, or just plain old low process prioritization.  Also (probably not the cause of what you are seeing) the Windows settings for Explorer (Tools-&gt;Folder options-&gt;view) can affect how a file appears within the Explorer app."}, {"owner": {"reputation": 1, "user_id": 2047124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e39b96b4bfe0beb5b78fd15251aa8ad8?s=128&d=identicon&r=PG&f=1", "display_name": "kword", "link": "https://stackoverflow.com/users/2047124/kword"}, "edited": false, "score": 0, "creation_date": 1543413867, "post_id": 53520513, "comment_id": 93911116, "body": "Yes, imho it should only take the amount of time it needs to process the manual operation executed via properties and the selection of &#39;Hidden&#39;. Why should my process/c code have to take nearly 2 seconds? I also tried to set its priority to highest in task manager, but without success."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 1, "creation_date": 1543414624, "post_id": 53520513, "comment_id": 93911628, "body": "is exactly single call to <code>SetFileAttributes</code> take this time ? how you measure this ?"}, {"owner": {"reputation": 1, "user_id": 2047124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e39b96b4bfe0beb5b78fd15251aa8ad8?s=128&d=identicon&r=PG&f=1", "display_name": "kword", "link": "https://stackoverflow.com/users/2047124/kword"}, "edited": false, "score": 0, "creation_date": 1543414843, "post_id": 53520513, "comment_id": 93911793, "body": "Yep, you can see it with your eyes. I go onto my desktop having multiple icons and folders, then I open the command prompt to start my c code from within. After pressing ENTER it takes nearly 2 seconds, until the folder icon is visible as hidden. I need this effect to be visible in a few ms instead."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 3, "creation_date": 1543415216, "post_id": 53520513, "comment_id": 93912038, "body": "no. i ask how many time take call <code>SetFileAttributes</code>. look like you even not measure this"}, {"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 2, "creation_date": 1543415845, "post_id": 53520513, "comment_id": 93912406, "body": "Explorer probably only checks for or otherwise gets notified of changes to file metadata that need to be reflected in its display every few seconds."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 4, "creation_date": 1543415869, "post_id": 53520513, "comment_id": 93912421, "body": "I think it takes 2 seconds <i>until the Explorer view is updated</i>, not until the attribute was set. Try a <code>GetFileAttributes</code> after the Set."}, {"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1543416054, "post_id": 53520513, "comment_id": 93912516, "body": "And that code doesn&#39;t give an error or at least warning? You&#39;re assigning a wide string literal to a <code>char *</code> variable. And then not using the wide char version of the Win32 syscall... How is that even working?"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 2047124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e39b96b4bfe0beb5b78fd15251aa8ad8?s=128&d=identicon&r=PG&f=1", "display_name": "kword", "link": "https://stackoverflow.com/users/2047124/kword"}, "is_accepted": false, "score": 0, "last_activity_date": 1543476650, "creation_date": 1543476650, "answer_id": 53533878, "question_id": 53520513, "link": "https://stackoverflow.com/questions/53520513/winapi-setfileattributes-slow-motion-call/53533878#53533878", "title": "WinApi SetFileAttributes slow-motion call", "body": "<p>First of all: Thanks for your suggestions. You were right, the explorer view / the desktop gets only updated after the time I did mention. </p>\n\n<p>I was able to solve the slowmotion issue by using the winapi call SHChangeNotify. It is important to combine the uFlags part with SHCNF_FLUSH, then the change is visible instantly.</p>\n"}], "owner": {"reputation": 1, "user_id": 2047124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e39b96b4bfe0beb5b78fd15251aa8ad8?s=128&d=identicon&r=PG&f=1", "display_name": "kword", "link": "https://stackoverflow.com/users/2047124/kword"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 70, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1543476650, "creation_date": 1543411533, "question_id": 53520513, "link": "https://stackoverflow.com/questions/53520513/winapi-setfileattributes-slow-motion-call", "title": "WinApi SetFileAttributes slow-motion call", "body": "<p>Today I did some testing with the SetFileAttributes method and encountered a phenomenon I am not able to explain logically:</p>\n\n<p>I wrote a short C program:</p>\n\n<pre><code>    #include &lt;stdio.h&gt;\n    #include &lt;windows.h&gt;\n\n    int main()\n    {\n        char* strFile = L\"C:\\\\test.txt\";\n\n        if (SetFileAttributes(strFile, FILE_ATTRIBUTE_HIDDEN)) \n        {\n            printf(\"File attribute changed.\\n\");\n        }\n\n        printf(\"%d\", GetLastError());\n\n    }\n</code></pre>\n\n<p>It is a test program that hides a folder or icon, and I want to do it fast, but unfortunately the process takes 1-2s.\nIf I hide the icon manually via properties and the checkbox selection 'Hidden', the icon is hidden promptly.</p>\n\n<p>So, what makes the winapi call take so many time? Is there a way to optimize the call?</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["c", "variables"], "answers": [{"comments": [{"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1543411002, "post_id": 53520308, "comment_id": 93909252, "body": "maybe a macro to be able to insert <code>volatile</code> or not."}, {"owner": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1543411046, "post_id": 53520308, "comment_id": 93909281, "body": "Maybe in some configuration OP didn&#39;t show, perhaps."}, {"owner": {"reputation": 391, "user_id": 5210526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79010974262f4745683afe71c20107fc?s=128&d=identicon&r=PG&f=1", "display_name": "Vect0rZ", "link": "https://stackoverflow.com/users/5210526/vect0rz"}, "edited": false, "score": 1, "creation_date": 1543411250, "post_id": 53520308, "comment_id": 93909405, "body": "A good example of this practice is Microsoft&#39;s SAL (Source Code Annotiation Language), where they mark the input parameters as <code>_In_</code> and the output as <code>_Out_</code>"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "reply_to_user": {"reputation": 391, "user_id": 5210526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79010974262f4745683afe71c20107fc?s=128&d=identicon&r=PG&f=1", "display_name": "Vect0rZ", "link": "https://stackoverflow.com/users/5210526/vect0rz"}, "edited": false, "score": 1, "creation_date": 1543411714, "post_id": 53520308, "comment_id": 93909668, "body": "@Vect0rZ inout is cool to differentiate from out when passing a pointer to some data. for in and out you can use <code>const</code> pointer or not."}], "tags": [], "owner": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "is_accepted": true, "score": 7, "last_activity_date": 1543410822, "creation_date": 1543410822, "answer_id": 53520308, "question_id": 53520289, "link": "https://stackoverflow.com/questions/53520289/what-does-this-mean-by-variable-define-in-c/53520308#53520308", "title": "What does this mean by variable define in C", "body": "<p>This is just a macro <code>Privileged_Data</code> doing nothing. The compiler will not even see it after the preprocessor pass.</p>\n\n<p>It's probably a readability or company standards decision to tag some variables like this.</p>\n"}, {"comments": [{"owner": {"reputation": 593, "user_id": 9658875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/841f55a02830a8f0655c07654401670f?s=128&d=identicon&r=PG&f=1", "display_name": "GermanNerd", "link": "https://stackoverflow.com/users/9658875/germannerd"}, "edited": false, "score": 0, "creation_date": 1543412674, "post_id": 53520352, "comment_id": 93910343, "body": "Q: Is this considered good practise? To me as an old-timer C guy, it seems like abuse of a language feature."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 593, "user_id": 9658875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/841f55a02830a8f0655c07654401670f?s=128&d=identicon&r=PG&f=1", "display_name": "GermanNerd", "link": "https://stackoverflow.com/users/9658875/germannerd"}, "edited": false, "score": 1, "creation_date": 1543413085, "post_id": 53520352, "comment_id": 93910631, "body": "@GermanNerd I would tend to agree.  There are other ways to document code."}, {"owner": {"reputation": 593, "user_id": 9658875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/841f55a02830a8f0655c07654401670f?s=128&d=identicon&r=PG&f=1", "display_name": "GermanNerd", "link": "https://stackoverflow.com/users/9658875/germannerd"}, "edited": false, "score": 0, "creation_date": 1543413733, "post_id": 53520352, "comment_id": 93911028, "body": "Nice to hear that. And thank you for your answer; initially this (ab)use of the #define directive had me really puzzled - like &#39;Is that something new in c99/c11/cxx....?&#39;"}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 2, "last_activity_date": 1543411020, "creation_date": 1543411020, "answer_id": 53520352, "question_id": 53520289, "link": "https://stackoverflow.com/questions/53520289/what-does-this-mean-by-variable-define-in-c/53520352#53520352", "title": "What does this mean by variable define in C", "body": "<p>A preprocessor macro can be defined without an associated value.  When that is the case, the macro is substituted with nothing after preprocessing.</p>\n\n<p>So given this:</p>\n\n<pre><code>#define Privileged_Data\n</code></pre>\n\n<p>Then this:</p>\n\n<pre><code>Privileged_Data static int dVariable\n</code></pre>\n\n<p>Becomes this after preprocessing:</p>\n\n<pre><code>static int dVariable\n</code></pre>\n\n<p>So this particular macro has no effect on the program, and was probably put in place for documentation purposes.</p>\n"}], "owner": {"reputation": 21, "user_id": 10717171, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-xY7juxyYflo/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-glHrpa8oWI22TMX1wydWjUdhPEqA/mo/photo.jpg?sz=128", "display_name": "VNN", "link": "https://stackoverflow.com/users/10717171/vnn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 152, "favorite_count": 0, "closed_date": 1543411248, "accepted_answer_id": 53520308, "answer_count": 2, "score": 1, "last_activity_date": 1543411311, "creation_date": 1543410743, "last_edit_date": 1543410813, "question_id": 53520289, "link": "https://stackoverflow.com/questions/53520289/what-does-this-mean-by-variable-define-in-c", "closed_reason": "Duplicate", "title": "What does this mean by variable define in C", "body": "<p>can you guys tell me, what does this mean in C?</p>\n\n<pre><code> #define Privileged_Data\n Privileged_Data static int dVariable\n</code></pre>\n\n<p>Is it specific meaningful for Compiler to address variable?</p>\n"}, {"tags": ["c", "arrays", "debugging", "scanf"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 4, "creation_date": 1543410688, "post_id": 53520234, "comment_id": 93909063, "body": "Using <code>!feof(fp)</code> to control a loop is always wrong.  Using <code>||</code> instead of <code>&amp;&amp;</code> is wrong too."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 3, "creation_date": 1543410810, "post_id": 53520234, "comment_id": 93909140, "body": "You have a stray <code>;</code> at the end of your <code>for</code>.  VTC as a typo."}, {"owner": {"reputation": 27, "user_id": 10657248, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c218efd82d078ed97ed9706b8d0324c6?s=128&d=identicon&r=PG&f=1", "display_name": "partynextdoor18", "link": "https://stackoverflow.com/users/10657248/partynextdoor18"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1543410864, "post_id": 53520234, "comment_id": 93909166, "body": "@JonathanLeffler Would using while(!feof(fp)) and having j increment within it be best?"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 1, "creation_date": 1543410865, "post_id": 53520234, "comment_id": 93909169, "body": "modern compilers usually warn about this semicolon typo"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1543410904, "post_id": 53520234, "comment_id": 93909193, "body": "@partynextdoor18 first remove the &quot;;&quot; after the &quot;for&quot;. The rest is detail in comparison"}, {"owner": {"reputation": 27, "user_id": 10657248, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c218efd82d078ed97ed9706b8d0324c6?s=128&d=identicon&r=PG&f=1", "display_name": "partynextdoor18", "link": "https://stackoverflow.com/users/10657248/partynextdoor18"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1543411088, "post_id": 53520234, "comment_id": 93909314, "body": "@Jean- Done. Ugh didn&#39;t notice it. Silly mistake. I&#39;m using C-Free 4.0 as my IDE... not sure why it didn&#39;t warn."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1543411141, "post_id": 53520234, "comment_id": 93909351, "body": "because the level of warnings should be at <code>-Wall -Wextra -Werror</code> (possibly <code>-pedantic</code>) and aren&#39;t. When starting C, always set this setting (and afterwards too). The compiler never warns for nothing. Also <a href=\"https://stackoverflow.com/posts/53520234/edit\">edit</a> your post to remove the &quot;;&quot; in the question so we can focus on the second issue"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1543411144, "post_id": 53520234, "comment_id": 93909353, "body": "It would be best not to use <code>feof()</code> at all.  Test whether the input operation succeeds. Check the result from <code>fscanf()</code> directly. Most experienced C programmers hardly ever use <code>feof()</code> at all."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 1, "creation_date": 1543411161, "post_id": 53520234, "comment_id": 93909358, "body": "As a style suggestion, always put the opening brace of a block statement on the same line as the statement that starts it.  Doing so greatly reduces if not eliminates this kind of bug."}, {"owner": {"reputation": 27, "user_id": 10657248, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c218efd82d078ed97ed9706b8d0324c6?s=128&d=identicon&r=PG&f=1", "display_name": "partynextdoor18", "link": "https://stackoverflow.com/users/10657248/partynextdoor18"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1543411515, "post_id": 53520234, "comment_id": 93909557, "body": "@Jon Could you elaborate further? I&#39;ve been taught to use <code>!feof()</code> in class, so I&#39;m not sure what else I could have as a control besides <code>EOF == NULL</code> and maybe <code>feof()</code> (?)"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1543411735, "post_id": 53520234, "comment_id": 93909682, "body": "I\u2019m sorry that your teacher is teaching you appallingly awful habits. Please send your tutor on a remedial C course.  There\u2019s a standard question on why not to use it; it\u2019s easy to locate it on a laptop browser but not in the iPhone app."}, {"owner": {"reputation": 27, "user_id": 10657248, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c218efd82d078ed97ed9706b8d0324c6?s=128&d=identicon&r=PG&f=1", "display_name": "partynextdoor18", "link": "https://stackoverflow.com/users/10657248/partynextdoor18"}, "reply_to_user": {"reputation": 1924, "user_id": 2669042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c66a47707c3d1748c9977727ddfa4d50?s=128&d=identicon&r=PG", "display_name": "xing", "link": "https://stackoverflow.com/users/2669042/xing"}, "edited": false, "score": 0, "creation_date": 1543411736, "post_id": 53520234, "comment_id": 93909684, "body": "@xing I want to have multiple strings of the same variable, would having just a 1d array work?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1543411902, "post_id": 53520234, "comment_id": 93909797, "body": "Try <a href=\"https://stackoverflow.com/q/5431941/15168\">stackoverflow.com/q/5431941/15168</a>"}, {"owner": {"reputation": 27, "user_id": 10657248, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c218efd82d078ed97ed9706b8d0324c6?s=128&d=identicon&r=PG&f=1", "display_name": "partynextdoor18", "link": "https://stackoverflow.com/users/10657248/partynextdoor18"}, "reply_to_user": {"reputation": 1924, "user_id": 2669042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c66a47707c3d1748c9977727ddfa4d50?s=128&d=identicon&r=PG", "display_name": "xing", "link": "https://stackoverflow.com/users/2669042/xing"}, "edited": false, "score": 0, "creation_date": 1543412517, "post_id": 53520234, "comment_id": 93910238, "body": "@xing Ah my bad. The data types. So for everything else other than a string I would leave it to just the number of rows..."}, {"owner": {"reputation": 27, "user_id": 10657248, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c218efd82d078ed97ed9706b8d0324c6?s=128&d=identicon&r=PG&f=1", "display_name": "partynextdoor18", "link": "https://stackoverflow.com/users/10657248/partynextdoor18"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1543412840, "post_id": 53520234, "comment_id": 93910452, "body": "@Jonathan Thanks, I was already on it. Can you recommend any online resources I could refer to to learn programming logic in general, and not just C? I&#39;ve been given the site automatetheboringstuff.com by a friend to learn Python, but I&#39;m planning on looking into it just to learn logic."}, {"owner": {"reputation": 27, "user_id": 10657248, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c218efd82d078ed97ed9706b8d0324c6?s=128&d=identicon&r=PG&f=1", "display_name": "partynextdoor18", "link": "https://stackoverflow.com/users/10657248/partynextdoor18"}, "reply_to_user": {"reputation": 1924, "user_id": 2669042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c66a47707c3d1748c9977727ddfa4d50?s=128&d=identicon&r=PG", "display_name": "xing", "link": "https://stackoverflow.com/users/2669042/xing"}, "edited": false, "score": 0, "creation_date": 1543412887, "post_id": 53520234, "comment_id": 93910487, "body": "@xing Yes sorry a mistake. Will edit it."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1543413018, "post_id": 53520234, "comment_id": 93910585, "body": "Whe I was learning to program, the web didn\u2019t exist. I\u2019ve not gone looking for such sites.  I don\u2019t have any recommendations \u2014 other than SO but it doesn\u2019t give a coherent ordered tutorial presentation."}, {"owner": {"reputation": 186, "user_id": 8657938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7924493761f5c1e272185206b329bfe2?s=128&d=identicon&r=PG&f=1", "display_name": "Krassi Em", "link": "https://stackoverflow.com/users/8657938/krassi-em"}, "edited": false, "score": 0, "creation_date": 1543740265, "post_id": 53520234, "comment_id": 94020974, "body": "Regarding the feof function usage, I am not going to comment if it&#39;s OK to avoid it. However, if you want to use it, then make sure that no logic errors are made. here is what I mean. j &lt;= 50 || !feof(f3);  What you are doing here is, as long as j &lt;= 50, you will skip the feof function check!! This is a serious problem. Instead, the condition should be j &lt;= 50 &amp;&amp; !feof(f3)  Or, skip feof altogether and verify fscanf, like already suggested by other comments."}, {"owner": {"reputation": 1669, "user_id": 7508077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b4193888717f50e77805498af1435b9?s=128&d=identicon&r=PG&f=1", "display_name": "EsmaeelE", "link": "https://stackoverflow.com/users/7508077/esmaeele"}, "edited": false, "score": 0, "creation_date": 1545845027, "post_id": 53520234, "comment_id": 94710351, "body": "change two functions in for to: <code>fscanf(f3, &quot;%s%f&quot;, date_with[j], amount_with[j]);        printf(&quot;%d %s RM %.2f&quot;, j+1, date_with[j], *amount_with[j]);</code>"}, {"owner": {"reputation": 1669, "user_id": 7508077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b4193888717f50e77805498af1435b9?s=128&d=identicon&r=PG&f=1", "display_name": "EsmaeelE", "link": "https://stackoverflow.com/users/7508077/esmaeele"}, "edited": false, "score": 0, "creation_date": 1545845123, "post_id": 53520234, "comment_id": 94710371, "body": "Compiling your code with gcc flags like this lead to that change: <code>gcc -Wall -Wextra -pedantic-errors code.c -o code</code>"}], "owner": {"reputation": 27, "user_id": 10657248, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c218efd82d078ed97ed9706b8d0324c6?s=128&d=identicon&r=PG&f=1", "display_name": "partynextdoor18", "link": "https://stackoverflow.com/users/10657248/partynextdoor18"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1543412918, "creation_date": 1543410562, "last_edit_date": 1543412918, "question_id": 53520234, "link": "https://stackoverflow.com/questions/53520234/c-unwanted-output-involving-fscanf", "title": "C - unwanted output involving fscanf", "body": "<p>I'm doing my school assignment and I've got issues with fscanf, file management so to speak. I've been at this for hours, looking up various functions and fscanf itself, and I'm still unable to solve this problem.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n\nint main()\n{\n    FILE *f3;\n    float amount_with[100][30];\n    int j;\n    char date_with[100][30];\n\n    f3 = fopen(\"withdrawals.txt\", \"r\");\n    if (f3 == NULL)\n    {\n        printf(\"ERROR! File could not be opened.\\n\");\n    }\n\n    for(j=0; j &lt;= 50 || !feof(f3); j++)\n    {\n       fscanf(f3, \"%s %f\", date_with[j], &amp;amount_with[j]);\n       printf(\"%d %s RM %.2f\", j+1, date_with[j], amount_with[j]);\n    }\n}\n</code></pre>\n\n<p>I want to feed into the program a line of data of floats, integers and strings. (eg. 18/11/18 200.00 within this program) from a text file via fscanf, or any other possible way. However when I execute the code, the program hangs and I am unable to do anything within it other than CTRL+C.</p>\n\n<p>Thanks for any help.</p>\n"}, {"tags": ["c", "microchip", "pwm", "pic18"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1543409684, "post_id": 53519913, "comment_id": 93908463, "body": "There are two ways of &quot;dimming&quot; a LED: Control the voltage to it, or make it blink in different frequencies (the quicker the blink, the brighter it will seem). Which of these methods can you use?"}, {"owner": {"reputation": 648, "user_id": 3405686, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/922978be2e4e18b9987e629e943b9779?s=128&d=identicon&r=PG&f=1", "display_name": "shas", "link": "https://stackoverflow.com/users/3405686/shas"}, "edited": false, "score": 0, "creation_date": 1543409959, "post_id": 53519913, "comment_id": 93908629, "body": "3rd for loop executes?"}, {"owner": {"reputation": 3478, "user_id": 9061264, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TPing.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/9061264/mike"}, "edited": false, "score": 1, "creation_date": 1543410933, "post_id": 53519913, "comment_id": 93909210, "body": "where is main()?"}, {"owner": {"reputation": 1, "user_id": 5692684, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MH8de.jpg?s=128&g=1", "display_name": "Underi", "link": "https://stackoverflow.com/users/5692684/underi"}, "edited": false, "score": 0, "creation_date": 1543422165, "post_id": 53519913, "comment_id": 93916669, "body": "Ah sorry. This code is inside the main function."}, {"owner": {"reputation": 1, "user_id": 5692684, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MH8de.jpg?s=128&g=1", "display_name": "Underi", "link": "https://stackoverflow.com/users/5692684/underi"}, "edited": false, "score": 0, "creation_date": 1543422247, "post_id": 53519913, "comment_id": 93916721, "body": "I&#39;m supposed to use this for loop to dim and brighten the LED. With this setup it only increases the time it&#39;s off and decreases the time it&#39;s off, until it goes off completely and then starts the loop all over again."}], "answers": [{"tags": [], "owner": {"reputation": 394, "user_id": 3264375, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc3958029becfe0d27b76e56aa3371c3?s=128&d=identicon&r=PG", "display_name": "erenbasturk", "link": "https://stackoverflow.com/users/3264375/erenbasturk"}, "is_accepted": false, "score": 1, "last_activity_date": 1543410332, "creation_date": 1543410332, "answer_id": 53520160, "question_id": 53519913, "link": "https://stackoverflow.com/questions/53519913/how-to-make-this-for-loop-both-dim-and-brighten-the-led/53520160#53520160", "title": "How to make this for loop both dim and brighten the LED?", "body": "<p>You can use PWM to set the brightness or You can set the dim and brighten with this way. The second way is you can use this with software like that.</p>\n\n<p>You can play with the ms variable and you can set the brightness. </p>\n\n<pre><code>#define MAX_DELAY 1000;\nint ms=0;\n\nwhile(1) {\nLED=0;\ndelayMs(ms);\nLED1(1)\ndelayMs(MAX_DELAY-ms);  \n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5692684, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MH8de.jpg?s=128&g=1", "display_name": "Underi", "link": "https://stackoverflow.com/users/5692684/underi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 208, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1543413715, "creation_date": 1543409471, "last_edit_date": 1543413715, "question_id": 53519913, "link": "https://stackoverflow.com/questions/53519913/how-to-make-this-for-loop-both-dim-and-brighten-the-led", "title": "How to make this for loop both dim and brighten the LED?", "body": "<p>I have a for loop made by my teacher that dims (or brightens) an LED connected to a PIC18F2455. I have to make the code do both, first brighten, then dim it, but my C skills aren't good enough for this. How can I make this happen?</p>\n\n<pre><code>int count=500;\nwhile(1){\n    for (int i=0; i&lt;count;i++){\n        LED = 0;\n        for(int j=0;j&lt;i;j++);\n            LED = 1;\n        for (int j=0;j&lt;count-i;j++);\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "libpng"], "comments": [{"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 1, "creation_date": 1543408778, "post_id": 53519598, "comment_id": 93907905, "body": "line 434: <code># include &quot;pnglibconf.h&quot;</code> and line 457: <code>#  include &quot;pngconf.h&quot;</code> ... start by looking there -- rather than post on StackOverflow :)"}], "answers": [{"comments": [{"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 0, "creation_date": 1543408732, "post_id": 53519677, "comment_id": 93907876, "body": ".. at line 449."}], "tags": [], "owner": {"reputation": 6578, "user_id": 10524386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe8a1950a1d7e1eccd4cff228c5420ea?s=128&d=identicon&r=PG", "display_name": "grapes", "link": "https://stackoverflow.com/users/10524386/grapes"}, "is_accepted": true, "score": 7, "last_activity_date": 1543408680, "creation_date": 1543408680, "answer_id": 53519677, "question_id": 53519598, "link": "https://stackoverflow.com/questions/53519598/what-is-the-declaration-of-data-type-png-byte-in-png-h-library-c/53519677#53519677", "title": "What is the declaration of data type &quot;png_byte&quot; in png.h library C?", "body": "<p>It is in <code>pngconf.h</code></p>\n\n<pre><code>typedef unsigned char png_byte;\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 3622770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/996f11d68408327839be88f4eeedc36f?s=128&d=identicon&r=PG&f=1", "display_name": "user3622770", "link": "https://stackoverflow.com/users/3622770/user3622770"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1183, "favorite_count": 0, "accepted_answer_id": 53519677, "answer_count": 1, "score": -1, "last_activity_date": 1543415919, "creation_date": 1543408467, "last_edit_date": 1543415919, "question_id": 53519598, "link": "https://stackoverflow.com/questions/53519598/what-is-the-declaration-of-data-type-png-byte-in-png-h-library-c", "title": "What is the declaration of data type &quot;png_byte&quot; in png.h library C?", "body": "<p>Here, at the GitHub repo png.h library source code is given (<a href=\"https://github.com/LuaDist/libpng/blob/master/png.h\" rel=\"nofollow noreferrer\">https://github.com/LuaDist/libpng/blob/master/png.h</a>).\nBut there also, directly they use the data type <code>png_byte</code>. I am looking for the declaration of this data type. </p>\n"}, {"tags": ["c", "memory-management"], "comments": [{"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 1, "creation_date": 1543406585, "post_id": 53518957, "comment_id": 93906596, "body": "Your braces don&#39;t match."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1543406642, "post_id": 53518957, "comment_id": 93906639, "body": "<code>for( i=0;i&lt;2..</code> should be <code>for( i=0;i&lt;n...</code>"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 1, "creation_date": 1543406702, "post_id": 53518957, "comment_id": 93906674, "body": "<code>char *Names;</code> is a pointer to a character which might be the first of an array of characters. It is not suitable to hold an array of pointers to strings."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "reply_to_user": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1543406790, "post_id": 53518957, "comment_id": 93906731, "body": "As @Gerhardh says, change to <code>char **Names;</code>"}, {"owner": {"reputation": 5950, "user_id": 3991211, "user_type": "registered", "profile_image": "https://graph.facebook.com/1042922965/picture?type=large", "display_name": "Garr Godfrey", "link": "https://stackoverflow.com/users/3991211/garr-godfrey"}, "edited": false, "score": 0, "creation_date": 1543406839, "post_id": 53518957, "comment_id": 93906754, "body": "And don&#39;t dereference Names when assigning to it. Use Names= not *Names ="}, {"owner": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 0, "creation_date": 1543406908, "post_id": 53518957, "comment_id": 93906799, "body": "<code>char (*Names)[100000] = malloc(n * sizeof *Names);</code> should do the whole job."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 1, "creation_date": 1543406922, "post_id": 53518957, "comment_id": 93906811, "body": "To get useful help, please be a bit more precise about &quot;I have tried this but this is wrong&quot;."}, {"owner": {"reputation": 3898, "user_id": 1755628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a05ce71f3fb8e71b8a3d6bc9c3198a88?s=128&d=identicon&r=PG", "display_name": "MikeW", "link": "https://stackoverflow.com/users/1755628/mikew"}, "edited": false, "score": 0, "creation_date": 1543407116, "post_id": 53518957, "comment_id": 93906932, "body": "Look up the definition of scanf (eg on <a href=\"https://linux.die.net/man/3/scanf\" rel=\"nofollow noreferrer\">linux.die.net/man/3/scanf</a> ) - it is wise to consider the return value of such functions, especially when learning about them. You will also see that the first call to scanf in your program should use &amp;n rather than n . Rather than allocating a fixed number of fixed-size string locations, it might be preferable to read each string first into a single local string array, find its length, then use malloc() to assign a Names item that is just big enough (eg Names[i] = malloc(strlen(input_name) + 1) - but also check for NULL return !)."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1543408554, "post_id": 53518957, "comment_id": 93907758, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/42094465/correctly-allocating-multi-dimensional-arrays\">Correctly allocating multi-dimensional arrays</a>"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1543408611, "post_id": 53518957, "comment_id": 93907802, "body": "Note that what you are allocating is <b>not</b> a &quot;two-dimensional array&quot;.  It&#39;s an array of pointers to a bunch of separately-allocated one-dimensional arrays.  It&#39;s about the most inefficient way to dynamically allocate such data structures as possible.  It&#39;s almost trivial to replace the multiple <code>malloc()</code> calls in the <code>for</code> loop with a single call to <code>malloc()</code> and then fill in the pointers in the array of pointers used to access the actual data elements."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1543408760, "post_id": 53518957, "comment_id": 93907893, "body": "The correct way to allocate a 2D array is: <code>char (*Names)[100000] = malloc(n * sizeof *Names);</code>"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1543408791, "post_id": 53518957, "comment_id": 93907916, "body": "The real question here is what you need. If you need a 2d array, this method is wrong. If you need string table with strings of variable length, it can be the correct method."}], "answers": [{"comments": [{"owner": {"reputation": 3898, "user_id": 1755628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a05ce71f3fb8e71b8a3d6bc9c3198a88?s=128&d=identicon&r=PG", "display_name": "MikeW", "link": "https://stackoverflow.com/users/1755628/mikew"}, "edited": false, "score": 0, "creation_date": 1543407226, "post_id": 53519177, "comment_id": 93907006, "body": "But was this a homework question ?"}, {"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "reply_to_user": {"reputation": 3898, "user_id": 1755628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a05ce71f3fb8e71b8a3d6bc9c3198a88?s=128&d=identicon&r=PG", "display_name": "MikeW", "link": "https://stackoverflow.com/users/1755628/mikew"}, "edited": false, "score": 1, "creation_date": 1543407386, "post_id": 53519177, "comment_id": 93907097, "body": "@MikeW I don&#39;t know. The professor should be able to see if the student copied, in case it&#39;s HW. Moreover, if it&#39;s HW, then the OP should be inspired by the answer, rather than copy paste it."}], "tags": [], "owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "is_accepted": false, "score": 1, "last_activity_date": 1543408079, "last_edit_date": 1543408079, "creation_date": 1543407040, "answer_id": 53519177, "question_id": 53518957, "link": "https://stackoverflow.com/questions/53518957/how-to-make-an-2d-array-using-dynamic-allocation-of-memory/53519177#53519177", "title": "How to make an (2d) array using dynamic allocation of memory", "body": "<p>You want to dynamically allocate a 2D array, but you use a single pointer. With your approach, you need to use a <em>double pointer</em>.</p>\n\n<p>This method allocates dynamically a matrix of characters, with dimensions N x M:</p>\n\n<pre><code>char **get(int N, int M)\n{\n    /* TODO: Check if allocation succeeded. (check for NULL pointer) */\n    char **table;\n    table = malloc(N*sizeof(char *));\n    for(int i = 0 ; i &lt; N ; i++)\n        table[i] = malloc( M*sizeof(char) );\n    return table;\n}\n</code></pre>\n\n<p>You would call it like this:</p>\n\n<pre><code>scanf(\"%d\", &amp;n);\nchar **names = get(n, 100000);\n</code></pre>\n\n<p>Notice how I used <code>&amp;n</code> instead of <code>n</code>, since <a href=\"http://www.cplusplus.com/reference/cstdio/scanf/\" rel=\"nofollow noreferrer\"><code>scanf()</code></a> expects a pointer as its parameter.</p>\n\n<p>Note: Do not forget to free the memory when are done with it. I had an example in <a href=\"https://gsamaras.wordpress.com/code/2d-dynamic-array-c/\" rel=\"nofollow noreferrer\">2D dynamic array</a>, if you are not sure how to.</p>\n\n<hr>\n\n<p>PS: <a href=\"https://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc\">Do I cast the result of malloc?</a> No!</p>\n"}, {"comments": [{"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "edited": false, "score": 1, "creation_date": 1543407326, "post_id": 53519233, "comment_id": 93907064, "body": "Hey Garr, thank for helping, but casting <code>malloc()</code>, really doesn&#39;t help. Check the link in the post note of my answer, if you are not sure why! :)"}, {"owner": {"reputation": 3898, "user_id": 1755628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a05ce71f3fb8e71b8a3d6bc9c3198a88?s=128&d=identicon&r=PG", "display_name": "MikeW", "link": "https://stackoverflow.com/users/1755628/mikew"}, "edited": false, "score": 1, "creation_date": 1543407626, "post_id": 53519233, "comment_id": 93907228, "body": "And in any case, it&#39;s good practice to check the return value from malloc() in case it&#39;s NULL."}, {"owner": {"reputation": 5950, "user_id": 3991211, "user_type": "registered", "profile_image": "https://graph.facebook.com/1042922965/picture?type=large", "display_name": "Garr Godfrey", "link": "https://stackoverflow.com/users/3991211/garr-godfrey"}, "edited": false, "score": 0, "creation_date": 1543407643, "post_id": 53519233, "comment_id": 93907242, "body": "I know many people have that opinion, but it doesn&#39;t really hurt either and it was in OP code so I left it."}, {"owner": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 0, "creation_date": 1543407783, "post_id": 53519233, "comment_id": 93907313, "body": "BTW, <code>sizeof(char) == 1</code>, by definition."}, {"owner": {"reputation": 3898, "user_id": 1755628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a05ce71f3fb8e71b8a3d6bc9c3198a88?s=128&d=identicon&r=PG", "display_name": "MikeW", "link": "https://stackoverflow.com/users/1755628/mikew"}, "edited": false, "score": 0, "creation_date": 1543407851, "post_id": 53519233, "comment_id": 93907352, "body": "Casting the return from malloc where ISO C pointer is not in use, avoids a compiler warning and helps static checkers like Lint and so on."}, {"owner": {"reputation": 5950, "user_id": 3991211, "user_type": "registered", "profile_image": "https://graph.facebook.com/1042922965/picture?type=large", "display_name": "Garr Godfrey", "link": "https://stackoverflow.com/users/3991211/garr-godfrey"}, "reply_to_user": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 0, "creation_date": 1543408049, "post_id": 53519233, "comment_id": 93907466, "body": "@Bob__  yeah, but then when you decide to port it to use wide characters you make it especially hard to do. I usually keep sizeof(char) in place, it gets optimized out."}, {"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "edited": false, "score": 0, "creation_date": 1543408055, "post_id": 53519233, "comment_id": 93907471, "body": "@GarrGodfrey <a href=\"https://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc\">casting malloc can hide an error in some cases</a>."}, {"owner": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 0, "creation_date": 1543416094, "post_id": 53519233, "comment_id": 93912538, "body": "Fair enough, although I&#39;d use <code>sizeof **Names</code> to be safe."}], "tags": [], "owner": {"reputation": 5950, "user_id": 3991211, "user_type": "registered", "profile_image": "https://graph.facebook.com/1042922965/picture?type=large", "display_name": "Garr Godfrey", "link": "https://stackoverflow.com/users/3991211/garr-godfrey"}, "is_accepted": true, "score": 2, "last_activity_date": 1543407243, "creation_date": 1543407243, "answer_id": 53519233, "question_id": 53518957, "link": "https://stackoverflow.com/questions/53518957/how-to-make-an-2d-array-using-dynamic-allocation-of-memory/53519233#53519233", "title": "How to make an (2d) array using dynamic allocation of memory", "body": "<p>This should correct most of the errors you had, most of which were pointed out in the comments.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main(void)\n{\n    int n,i;\n    /* Declare as char** */\n    char **Names;\n\n    /* Use &amp;n to read into the address of n, otherwise you crash here */\n    scanf(\"%d\",&amp;n);\n    /* don't deference during the assignment, and you are allocating n char*, so use sizeof(char*)  */\n    Names=(char **)malloc(sizeof(char *)*n);\n\n    /* Use sizeof(char) not sizeof(char *), since here we want to store 100000 chars not 100000 pointers to char */\n    for( i=0;i&lt;n;i++)\n        Names[i]=(char*)malloc(sizeof(char)*100000);\n\n    for( i=0;i&lt;n;i++)\n        scanf(\"%s\",Names[i]);\n\n    /* remove extra } that was here */\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 593, "user_id": 9658875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/841f55a02830a8f0655c07654401670f?s=128&d=identicon&r=PG&f=1", "display_name": "GermanNerd", "link": "https://stackoverflow.com/users/9658875/germannerd"}, "is_accepted": false, "score": 0, "last_activity_date": 1543413033, "creation_date": 1543413033, "answer_id": 53520974, "question_id": 53518957, "link": "https://stackoverflow.com/questions/53518957/how-to-make-an-2d-array-using-dynamic-allocation-of-memory/53520974#53520974", "title": "How to make an (2d) array using dynamic allocation of memory", "body": "<p>Strictly speaking, you are not creating an array, but just a pointer to some allocated memory that you can access with the array syntax. However, it is <strong>not</strong> an array. The difference within what you attempt to do might seem superficial, but it is not.</p>\n\n<p>a) a true array cannot be reseated.\nb) were it an array, you would not have to free() the memory later. (Applies to both fixed size arrays and VLAs.)\nc) You cannot get the size of the whole array by sizeof when using dynamic allocation.</p>\n"}], "owner": {"reputation": 2351, "user_id": 10224590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/y3EE6.jpg?s=128&g=1", "display_name": "PranavElric", "link": "https://stackoverflow.com/users/10224590/pranavelric"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "closed_date": 1543431093, "accepted_answer_id": 53519233, "answer_count": 3, "score": 0, "last_activity_date": 1543413033, "creation_date": 1543406266, "last_edit_date": 1543407191, "question_id": 53518957, "link": "https://stackoverflow.com/questions/53518957/how-to-make-an-2d-array-using-dynamic-allocation-of-memory", "closed_reason": "Not suitable for this site", "title": "How to make an (2d) array using dynamic allocation of memory", "body": "<p>I want to make an (2d) array of names using dynamic allocation of memory, where length of each name is 1&lt;=name&lt;=1000000.</p>\n\n<p>I have tried this but this is wrong could you help me </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main(void)\n{\n    int n,i;\n    char *Names;\n\n    scanf(\"%d\",n);\n    *Names=(char **)malloc(sizeof(char **)*n);\n\n    for( i=0;i&lt;n;i++)\n        (*Names+i)=(char*)malloc(sizeof(char *)*100000);\n\n    for(int i=0;i&lt;n;i++)\n        scanf(\"%s\",Names[i]);\n}\nreturn 0;\n}\n</code></pre>\n\n<p>Sample output:</p>\n\n<pre><code>/*\n  kirito\n  asuna\n  pranav\n*/\n</code></pre>\n"}, {"tags": ["c", "scanf"], "comments": [{"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 1, "creation_date": 1543405643, "post_id": 53518613, "comment_id": 93906044, "body": "Turn on your compiler warnings, amd <b>mind them</b>! (Hint: <code>name</code> is used without a valid assignment (or initialization))."}, {"owner": {"reputation": 57963, "user_id": 968261, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/16f69ca344773bd6c34970b2f6186d61?s=128&d=identicon&r=PG", "display_name": "Alexey Frunze", "link": "https://stackoverflow.com/users/968261/alexey-frunze"}, "edited": false, "score": 0, "creation_date": 1543405657, "post_id": 53518613, "comment_id": 93906055, "body": "You must (try to) read before you can call <code>feof()</code>. Fix this one first."}, {"owner": {"reputation": 57963, "user_id": 968261, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/16f69ca344773bd6c34970b2f6186d61?s=128&d=identicon&r=PG", "display_name": "Alexey Frunze", "link": "https://stackoverflow.com/users/968261/alexey-frunze"}, "edited": false, "score": 0, "creation_date": 1543406295, "post_id": 53518613, "comment_id": 93906426, "body": "What&#39;s in <code>name[]</code> on the first iteration through the loop?"}, {"owner": {"reputation": 1949, "user_id": 8467909, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-4O0CDuIKrcY/AAAAAAAAAAI/AAAAAAAAAAk/zVf2aTbzfnw/photo.jpg?sz=128", "display_name": "John Smith", "link": "https://stackoverflow.com/users/8467909/john-smith"}, "reply_to_user": {"reputation": 57963, "user_id": 968261, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/16f69ca344773bd6c34970b2f6186d61?s=128&d=identicon&r=PG", "display_name": "Alexey Frunze", "link": "https://stackoverflow.com/users/968261/alexey-frunze"}, "edited": false, "score": 0, "creation_date": 1543406801, "post_id": 53518613, "comment_id": 93906735, "body": "@AlexeyFrunze On the first iteration for &quot;Mickey Mouse&quot;, name[] is either &quot;\\31 Mickey&quot; or &quot;Mickey&quot;"}, {"owner": {"reputation": 1949, "user_id": 8467909, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-4O0CDuIKrcY/AAAAAAAAAAI/AAAAAAAAAAk/zVf2aTbzfnw/photo.jpg?sz=128", "display_name": "John Smith", "link": "https://stackoverflow.com/users/8467909/john-smith"}, "reply_to_user": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 0, "creation_date": 1543406816, "post_id": 53518613, "comment_id": 93906742, "body": "@pmg <code>name[0] = &#39;\\0&#39;;</code> seems to have fixed it, or at least it produced the right output for 20+ times in a row. I did not think I have to set any of its elements to anything - I thought it&#39;s some random garbage that I&#39;ll be overwriting anyway. Where can I read more about it? Why what was happening was actually happening?"}, {"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 0, "creation_date": 1543407031, "post_id": 53518613, "comment_id": 93906878, "body": "Only <code>static</code> and global variables are automatically initialized (and you should avoid them while you&#39;re learning C). You have to initialize (or assign a value later but before you use the variable) all other kinds of variables."}], "answers": [{"comments": [{"owner": {"reputation": 1949, "user_id": 8467909, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-4O0CDuIKrcY/AAAAAAAAAAI/AAAAAAAAAAk/zVf2aTbzfnw/photo.jpg?sz=128", "display_name": "John Smith", "link": "https://stackoverflow.com/users/8467909/john-smith"}, "edited": false, "score": 0, "creation_date": 1543407151, "post_id": 53519110, "comment_id": 93906951, "body": "Do you know why the added characters were persistently <code>\\31</code> <code>\\12</code> and so on, over and over again? Set aside the fact that&#39;s UB, any guesses why were they added at all? Even if I knew I have to initialize first, I&#39;d think in this case I&#39;m simply using a block of memory that is not assigned to anything yet and can be overwritten by anything at any time, but why specifically those characters?"}, {"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "reply_to_user": {"reputation": 1949, "user_id": 8467909, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-4O0CDuIKrcY/AAAAAAAAAAI/AAAAAAAAAAk/zVf2aTbzfnw/photo.jpg?sz=128", "display_name": "John Smith", "link": "https://stackoverflow.com/users/8467909/john-smith"}, "edited": false, "score": 0, "creation_date": 1543407239, "post_id": 53519110, "comment_id": 93907016, "body": "Garbage values that were already there @JohnSmith, I <i>guess</i>, which is what happens with UB!"}, {"owner": {"reputation": 1949, "user_id": 8467909, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-4O0CDuIKrcY/AAAAAAAAAAI/AAAAAAAAAAk/zVf2aTbzfnw/photo.jpg?sz=128", "display_name": "John Smith", "link": "https://stackoverflow.com/users/8467909/john-smith"}, "edited": false, "score": 0, "creation_date": 1543429458, "post_id": 53519110, "comment_id": 93920454, "body": "Does <code>char name[255] = (char *)malloc(255*sizeof(char));</code> do the trick as well? That is, does initializing an array via setting one of its elements to &#39;\\0&#39; automatically call <code>malloc()</code>?"}, {"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "reply_to_user": {"reputation": 1949, "user_id": 8467909, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-4O0CDuIKrcY/AAAAAAAAAAI/AAAAAAAAAAk/zVf2aTbzfnw/photo.jpg?sz=128", "display_name": "John Smith", "link": "https://stackoverflow.com/users/8467909/john-smith"}, "edited": false, "score": 0, "creation_date": 1543431019, "post_id": 53519110, "comment_id": 93921206, "body": "No @JohnSmith this is very wrong! Malloc is used to dynamically allocate memory. In your case, name array has already memory for it, since it&#39;s an array of fixed size, hope that helps.."}], "tags": [], "owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "is_accepted": true, "score": 1, "last_activity_date": 1543406751, "creation_date": 1543406751, "answer_id": 53519110, "question_id": 53518613, "link": "https://stackoverflow.com/questions/53518613/multiple-randomly-chosen-outputs-across-different-launches-of-the-same-program/53519110#53519110", "title": "Multiple (randomly chosen) outputs across different launches of the same program. Random characters added when fscanf&#39;ing", "body": "<p>Your code invokes <em>Undefined Behavior</em> (UB), since it uses <code>name</code> uninitialized. Read more in <a href=\"https://stackoverflow.com/questions/19020504/what-is-undefined-behaviour-in-c\">What is Undefined Behaviour in C?</a></p>\n\n<p>We will initialize it, and make sure the null terminator is there. Standard string functions, like <code>strlen()</code>, depend on the null terminator to mark the end of the string.</p>\n\n<p>Then, you need to make sure that you read something before you call <code>feof()</code>. Moreover, it's a good idea to check what <a href=\"http://www.cplusplus.com/reference/cstdio/fscanf/\" rel=\"nofollow noreferrer\"><code>fscanf()</code></a> returns, which denotes the number of items read.</p>\n\n<p>Putting all together, we get:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint main() \n{\n    char input_file_name[255];\n    FILE * input_file;\n    char name[255] = \"\\0\"; // initialize it so that is has a  null terminator\n    input_file = fopen (\"a.txt\",\"r\");\n    do\n    {       \n        if (strlen(name) != 0 )\n            name[strlen(name)] = ' ';\n    } while (fscanf (input_file, \"%s \",  name + strlen(name) * sizeof(char)) == 1 &amp;&amp; !feof(input_file));\n    fclose (input_file);\n    printf(\"Name:%s\\n\", name);\n    return 0;\n}\n</code></pre>\n\n<p>Output (for \"georgios samaras\"):</p>\n\n<blockquote>\n  <p>georgios samaras</p>\n</blockquote>\n"}], "owner": {"reputation": 1949, "user_id": 8467909, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-4O0CDuIKrcY/AAAAAAAAAAI/AAAAAAAAAAk/zVf2aTbzfnw/photo.jpg?sz=128", "display_name": "John Smith", "link": "https://stackoverflow.com/users/8467909/john-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "accepted_answer_id": 53519110, "answer_count": 1, "score": 0, "last_activity_date": 1543408079, "creation_date": 1543405249, "last_edit_date": 1543408079, "question_id": 53518613, "link": "https://stackoverflow.com/questions/53518613/multiple-randomly-chosen-outputs-across-different-launches-of-the-same-program", "title": "Multiple (randomly chosen) outputs across different launches of the same program. Random characters added when fscanf&#39;ing", "body": "<p>Simple program: reads a name and a surname (John Smith) from a .txt file via fscanf, adds spaces, prints the name in the console (just as it's written in the .txt).</p>\n\n<p>If compiled and ran on Win10 via </p>\n\n<blockquote>\n  <p>Microsoft (R) C/C++ Optimizing Compiler Version 19.14.26433 for x86</p>\n</blockquote>\n\n<p>the following code does not produce the same output for the same input across different .exe launches (no recompiling). For each input it seems to have multiple outputs avaialble, between which the program decides at random.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint main() \n{\n    char input_file_name[255];\n    FILE * input_file;\n    char name[255];\n    input_file = fopen (\"a.txt\",\"r\");\n    do\n    {       \n        if (strlen(name) != 0 )\n            name[strlen(name)] = ' ';\n\n        fscanf (input_file, \"%s\", name + strlen(name) * sizeof(char));\n    }while(!feof(input_file));\n    fclose (input_file);\n    printf(\"Name:%s\\n\", name);\n    system(\"pause\");\n    return 0;\n}\n</code></pre>\n\n<p>I will list a couple of inputs and outputs for them. As not all characters are printable, I will type type them as \\ascii_code instead, such as \\97 = a.\nThe most common anomalies are \\31 (Unit Separator) added at the very front of the string and \\12 (NP form feed, new page) or \\17 (device control 1) right before the surname (after the first space).</p>\n\n<ol>\n<li><p>For \"John Smith\":</p>\n\n<ul>\n<li>\"John Smith\" (proper output)</li>\n<li>\"\\31 John Smith\"</li>\n</ul></li>\n<li><p>For \"Atoroco Coco\"</p>\n\n<ul>\n<li>\"Atoroco \\12Coco\"</li>\n<li>\"\\31 Atoroco \\16Coco\"</li>\n</ul></li>\n<li><p>For \"Mickey Mouse\"</p>\n\n<ul>\n<li>\"Mickey Mouse\" (proper)</li>\n<li>\"\\31 Mickey\\81Mouse\" (There is a \\32 (space) in the string right before the \\81, but the console doesn't show the space?!)</li>\n</ul></li>\n</ol>\n\n<p>If compiled a different machine (MacOS, compiler unknown) it seems to work properly each time, that is it prints simply the .txt's contents.</p>\n\n<p>Why are there multiple outputs produced, seemingly at random?\nWhy are these characters (\\31, \\12 etc) in particular added, and no other?</p>\n"}, {"tags": ["c", "linux", "debugging", "gdb"], "comments": [{"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 0, "creation_date": 1543406122, "post_id": 53518565, "comment_id": 93906336, "body": "Couple hints: 1. Compile with all warnings on; 2. compile with different optimization switches; 3. look for casts in code (they are often wrong and silence the warnings)"}, {"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1543406357, "post_id": 53518565, "comment_id": 93906456, "body": "Have you tried running your code with valgrind? That might show up where your code is corrupting the pointer"}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 1, "creation_date": 1543406383, "post_id": 53518565, "comment_id": 93906473, "body": "You don&#39;t show enough code to really help you. But it seems some code is overwriting the pointer. If you look at the data (variables) <i>before</i> the struct, there is a good chance the code that manipulates that variable has the error."}, {"owner": {"reputation": 474, "user_id": 10178858, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8DOGg.jpg?s=128&g=1", "display_name": "gacopu", "link": "https://stackoverflow.com/users/10178858/gacopu"}, "reply_to_user": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 0, "creation_date": 1543407826, "post_id": 53518565, "comment_id": 93907338, "body": "@pmg tried, not work"}, {"owner": {"reputation": 474, "user_id": 10178858, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8DOGg.jpg?s=128&g=1", "display_name": "gacopu", "link": "https://stackoverflow.com/users/10178858/gacopu"}, "reply_to_user": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1543407877, "post_id": 53518565, "comment_id": 93907368, "body": "@ChrisTurner if running it with valgrind, its too slow, the bug just does not happens"}, {"owner": {"reputation": 474, "user_id": 10178858, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8DOGg.jpg?s=128&g=1", "display_name": "gacopu", "link": "https://stackoverflow.com/users/10178858/gacopu"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1543407916, "post_id": 53518565, "comment_id": 93907400, "body": "@PaulOgilvie it&#39;s a big project, impossible to show the code..."}, {"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 0, "creation_date": 1543408127, "post_id": 53518565, "comment_id": 93907511, "body": "launch your program under the debugger, set a break pointer for when the pointer is <code>&quot;0000 0000 0000 0000 0000 0000 0000 0001 1110 1010 0110 1011 0100 1000 0000 0000&quot;</code> then look around"}, {"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 0, "creation_date": 1543408533, "post_id": 53518565, "comment_id": 93907743, "body": "Is, maybe, this a typo??? You have <code>commond</code> in the code and <code>command</code> in the question text ..."}], "answers": [{"comments": [{"owner": {"reputation": 474, "user_id": 10178858, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8DOGg.jpg?s=128&g=1", "display_name": "gacopu", "link": "https://stackoverflow.com/users/10178858/gacopu"}, "edited": false, "score": 0, "creation_date": 1543451573, "post_id": 53523094, "comment_id": 93928766, "body": "Thank you very much, let me try these methods"}], "tags": [], "owner": {"reputation": 162629, "user_id": 50617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YFykQ.png?s=128&g=1", "display_name": "Employed Russian", "link": "https://stackoverflow.com/users/50617/employed-russian"}, "is_accepted": false, "score": 0, "last_activity_date": 1543419545, "creation_date": 1543419545, "answer_id": 53523094, "question_id": 53518565, "link": "https://stackoverflow.com/questions/53518565/pointer-is-parially-tampered-why-is-that-and-how-to-debug/53523094#53523094", "title": "Pointer is parially tampered, why is that and how to debug?", "body": "<p>Since you are running on Linux, and apparently <code>x86_64</code>, your very first step should be to rebuild your binary with <a href=\"https://github.com/google/sanitizers/wiki/AddressSanitizer\" rel=\"nofollow noreferrer\">Address Sanitizer</a> (<code>gcc -fsanitize=address ...</code>).</p>\n\n<p>Unlike (already suggested) Valgrind, Address Sanitizer catches overflows in global and stack variables (in addition to heap). It's also significantly faster.</p>\n\n<blockquote>\n  <p>It only happens under some load, and happens randomly.</p>\n</blockquote>\n\n<p>These in general suggest that you are accessing dangling memory. That is, you are using a pointer to <code>struct command</code> that has already been <code>free</code>d. Sometimes that memory is still sitting in the free pool, waiting to be allocated to something else, and other times that memory has already been allocated and overwritten.</p>\n\n<p>If you can't find the bug with sanitizer, another approach is to find all places where <code>struct command</code> is being <code>free</code>d, and replace them with:</p>\n\n<pre><code>memset(p, 0xCD, sizeof(*p));\nfree(p);\n</code></pre>\n\n<p>That should make the bug significantly easier to reproduce and narrow down (if my guess about its nature is correct).</p>\n"}], "owner": {"reputation": 474, "user_id": 10178858, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8DOGg.jpg?s=128&g=1", "display_name": "gacopu", "link": "https://stackoverflow.com/users/10178858/gacopu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1543419545, "creation_date": 1543405060, "last_edit_date": 1543409813, "question_id": 53518565, "link": "https://stackoverflow.com/questions/53518565/pointer-is-parially-tampered-why-is-that-and-how-to-debug", "title": "Pointer is parially tampered, why is that and how to debug?", "body": "<p>I was assigned to develop a chat server which is written in C because the developer quit and I know a little of C.</p>\n\n<p>I came across a bug these weeks, and was struggling with it for almost 2 weeks. I cannot even sleep now, please don't delete and Please help.</p>\n\n<p>The chat server is using a event loop, every time a request come, it will create a <code>command</code> struct along with some other structs.</p>\n\n<p>The <code>command</code> struct is</p>\n\n<pre><code>struct {\n  struct {\n    char *message;\n    int length;\n  } response;\n  long count;\n  int status;\n} command;\n</code></pre>\n\n<p>Sometimes the <code>message</code> pointer is partially tampered, the normal pointer likes <code>0x00003fffxxxxxxxx</code> the binary is for example:</p>\n\n<pre><code>0000 0000 0000 0000 0110 1111 1111 1111 BBBBBBBBBBBBBBBB  (pointerA)\n</code></pre>\n\n<p>and the corrupted pointer is always</p>\n\n<pre><code>0000 0000 0000 0000 0000 0000 0000 0001 BBBBBBBBBBBBBBBB  (pointerB)\n</code></pre>\n\n<p>lower 33 bits of the pointer are always same, and higer 31 bits are always set to 0.</p>\n\n<p>So if the <code>message</code> pointer is pointerB, and if I change the higher 31 bits to <code>0110 1111 1111 1111</code> so I get pointerB, if I print the content of <code>pointerB</code> in gdb, the content is correct. </p>\n\n<p>It only happens under some load, and happens randomly. How can I debug this?</p>\n"}, {"tags": ["c", "fftw", "pde", "dft"], "comments": [{"owner": {"reputation": 208794, "user_id": 229044, "user_type": "moderator", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/591426cbbacd4025d920467bad356911?s=128&d=identicon&r=PG&f=1", "display_name": "meagar", "link": "https://stackoverflow.com/users/229044/meagar"}, "edited": false, "score": 0, "creation_date": 1544200946, "post_id": 53518451, "comment_id": 94204747, "body": "Comments are not for extended discussion; this conversation has been <a href=\"https://chat.stackoverflow.com/rooms/184888/discussion-on-question-by-francesco-boccardo-why-is-fft-of-ab-different-from\">moved to chat</a>."}], "answers": [{"comments": [{"owner": {"reputation": 2815, "user_id": 1462295, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/ts6jy.jpg?s=128&g=1", "display_name": "BurnsBA", "link": "https://stackoverflow.com/users/1462295/burnsba"}, "edited": false, "score": 2, "creation_date": 1544447718, "post_id": 53706304, "comment_id": 94267371, "body": "I was kind of hoping there was a complicated explanation for your problem, but I&#39;m glad you got it figured out at least."}, {"owner": {"reputation": 4522, "user_id": 5157478, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bBcym.png?s=128&g=1", "display_name": "Frankie_C", "link": "https://stackoverflow.com/users/5157478/frankie-c"}, "edited": false, "score": 1, "creation_date": 1544454292, "post_id": 53706304, "comment_id": 94271184, "body": "Good! So of the 3 possible causes it was a wrong algorithm. The less probable for you. L&#39;importante &#232; arrivarci..."}, {"owner": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 1, "creation_date": 1544456210, "post_id": 53706304, "comment_id": 94272243, "body": "Your compiler is (almost) surely already doing that, but why, for the sake of readability, aren&#39;t <i>you</i> writing all those loops as <code>for ( k = 0; k &lt; Nx * Ny; ++k ) { whatever[k][0] = \u2026; whatever[k][1] = \u2026;}</code>?"}, {"owner": {"reputation": 1208, "user_id": 9104884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sVPmy.png?s=128&g=1", "display_name": "Tropilio", "link": "https://stackoverflow.com/users/9104884/tropilio"}, "reply_to_user": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 0, "creation_date": 1544457206, "post_id": 53706304, "comment_id": 94272779, "body": "@Bob__ Hmm, good point! I guess I do it because, in general, I might want to take first derivatives, and that would mean doing operations using <code>qx[i]</code> and <code>qy[j]</code>. But yes, you are absolutely right, in this particular example I could simplify the writing as you suggest."}, {"owner": {"reputation": 149158, "user_id": 524368, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/oZ8Up.png?s=128&g=1", "display_name": "datenwolf", "link": "https://stackoverflow.com/users/524368/datenwolf"}, "edited": false, "score": 0, "creation_date": 1544521817, "post_id": 53706304, "comment_id": 94296355, "body": "When I&#39;ve read your explanation <code>I set the imaginary part of h(x,y), which is dh[i*Ny+j][1] in the code, to 0, since it is a real function.</code> my spidey sense was tickling. Hadn&#39;t you already figured it out yourself, that&#39;d be my first hunch to investigate. For those reading along: Whenever you&#39;re running into a numerical problem with weird instabilities, which vanish when you rearrange the terms using some form identity, then the most likely cause is, that the identity is not conserved, by &quot;leaking&quot;. If there&#39;s a coercion happening, you must make sure, that you renormalize."}], "tags": [], "owner": {"reputation": 1208, "user_id": 9104884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sVPmy.png?s=128&g=1", "display_name": "Tropilio", "link": "https://stackoverflow.com/users/9104884/tropilio"}, "is_accepted": true, "score": 23, "last_activity_date": 1544522022, "last_edit_date": 1544522022, "creation_date": 1544447146, "answer_id": 53706304, "question_id": 53518451, "link": "https://stackoverflow.com/questions/53518451/why-is-fft-of-ab-different-from-ffta-fftb/53706304#53706304", "title": "Why is FFT of (A+B) different from FFT(A) + FFT(B)?", "body": "<p>I solved it!!\nThe problem was the calculation of the <code>Nonl</code> term:</p>\n\n<pre><code>  Nonl[i*Ny+j][0] = dh[i*Ny+j][0]*dh[i*Ny+j][0]*dh[i*Ny+j][0];\n  Nonl[i*Ny+j][1] = 0.0;\n</code></pre>\n\n<p>That needs to be changed to:</p>\n\n<pre><code>  Nonl[i*Ny+j][0] = dh[i*Ny+j][0]*dh[i*Ny+j][0]*dh[i*Ny+j][0] -3.0*dh[i*Ny+j][0]*dh[i*Ny+j][1]*dh[i*Ny+j][1];\n  Nonl[i*Ny+j][1] = -dh[i*Ny+j][1]*dh[i*Ny+j][1]*dh[i*Ny+j][1] +3.0*dh[i*Ny+j][0]*dh[i*Ny+j][0]*dh[i*Ny+j][1];\n</code></pre>\n\n<p>In other words: I need to consider <code>dh</code> as a complex function (even though it should be real).</p>\n\n<p>Basically, because of stupid rounding errors, <strong>the IFT of the FT of a real function</strong> (in my case <code>dh</code>), <strong>is NOT purely real</strong>, but will have a very small imaginary part. By setting <code>Nonl[i*Ny+j][1] = 0.0</code> I was completely ignoring this imaginary part. \nThe issue, then, was that I was recursively summing FT(<code>dh</code>), <code>dhft</code>, and an object obtained using the IFT(FT(<code>dh</code>)), this is <code>Nonlft</code>, but ignoring the residual imaginary parts!</p>\n\n<pre><code>Nonlft[i*Ny+j][0] = -Q2[i*Ny+j]*(Nonlft[i*Ny+j][0] -dhft[i*Ny+j][0]);\nNonlft[i*Ny+j][1] = -Q2[i*Ny+j]*(Nonlft[i*Ny+j][1] -dhft[i*Ny+j][1]);\n</code></pre>\n\n<p>Obviously, calculating <code>Nonlft</code> as <code>dh</code>^3 <code>-dh</code> and then doing</p>\n\n<pre><code>Nonlft[i*Ny+j][0] = -Q2[i*Ny+j]* Nonlft[i*Ny+j][0]; \nNonlft[i*Ny+j][1] = -Q2[i*Ny+j]* Nonlft[i*Ny+j][1];\n</code></pre>\n\n<p>Avoided the problem of doing this \"mixed\" sum.</p>\n\n<p>Phew... such a relief! I wish I could assign the bounty to myself! :P</p>\n\n<p>EDIT: I'd like to add that, before using the <code>fftw_plan_dft_2d</code> functions, I was using <code>fftw_plan_dft_r2c_2d</code> and <code>fftw_plan_dft_c2r_2d</code> (real-to-complex and complex-to-real), and I was seeing the same bug. However, I suppose that I couldn't have solved it if I didn't switch to <code>fftw_plan_dft_2d</code>, since the <code>c2r</code> function automatically \"chops off\" the residual imaginary part coming from the IFT. <strong>If this is the case and I'm not missing something, I think that this should be written somewhere on the FFTW website, to prevent users from running into problems like this.</strong> Something like \"<code>r2c</code> and <code>c2r</code> transforms are not good to implement pseudospectral methods\".</p>\n\n<p>EDIT: I found <a href=\"https://stackoverflow.com/questions/6847708/numerical-instability-fftw-matlab\">another SO question</a> that addresses <strong>exactly</strong> the same problem.</p>\n"}], "owner": {"reputation": 1208, "user_id": 9104884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sVPmy.png?s=128&g=1", "display_name": "Tropilio", "link": "https://stackoverflow.com/users/9104884/tropilio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1083, "favorite_count": 6, "accepted_answer_id": 53706304, "answer_count": 1, "score": 48, "last_activity_date": 1545010843, "creation_date": 1543404613, "last_edit_date": 1544197492, "question_id": 53518451, "link": "https://stackoverflow.com/questions/53518451/why-is-fft-of-ab-different-from-ffta-fftb", "title": "Why is FFT of (A+B) different from FFT(A) + FFT(B)?", "body": "<p>I have been fighting with a very weird bug for almost a month. Asking you guys is my last hope. I wrote a program in C that integrates the 2d <a href=\"https://en.wikipedia.org/wiki/Cahn%E2%80%93Hilliard_equation\" rel=\"noreferrer\">Cahn\u2013Hilliard equation</a> using the Implicit Euler (IE) scheme in Fourier (or reciprocal) space:</p>\n\n<p><a href=\"https://i.stack.imgur.com/McXGf.gif\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/McXGf.gif\" alt=\"IE method\"></a></p>\n\n<p>Where the \"hats\" mean that we are in Fourier space: h_q(t_n+1) and h_q(t_n) are the FTs of h(x,y) at times t_n and t_(n+1), N[h_q] is the nonlinear operator applied to h_q, in Fourier space, and L_q is the linear one, again in Fourier space. I don't want to go too much into the details of the numerical method I am using, since I am sure that the problem is not coming from there (I tried using other schemes).</p>\n\n<p>My code is actually quite simple. Here is the beginning, where basically I declare variables, allocate memory and create the plans for the FFTW routines.</p>\n\n<pre><code># include &lt;stdlib.h&gt;\n# include &lt;stdio.h&gt;\n# include &lt;time.h&gt;\n# include &lt;math.h&gt;\n# include &lt;fftw3.h&gt;\n# define pi M_PI\n\nint main(){\n\n// define lattice size and spacing\nint Nx = 150;         // n of points on x\nint Ny = 150;         // n of points on y\ndouble dx = 0.5;      // bin size on x and y\n\n// define simulation time and time step\nlong int Nt = 1000;   // n of time steps\ndouble dt = 0.5;      // time step size\n\n// number of frames to plot (at denominator)\nlong int nframes = Nt/100;\n\n// define the noise\ndouble rn, drift = 0.05;   // punctual drift of h(x)\nsrand(666);                // seed the RNG\n\n// other variables\nint i, j, nt;    // variables for space and time loops\n\n// declare FFTW3 routine\nfftw_plan FT_h_hft;   // routine to perform  fourier transform\nfftw_plan FT_Nonl_Nonlft;\nfftw_plan IFT_hft_h;  // routine to perform  inverse fourier transform\n\n// declare and allocate memory for real variables\ndouble *Linft = fftw_alloc_real(Nx*Ny);\ndouble *Q2 = fftw_alloc_real(Nx*Ny);\ndouble *qx = fftw_alloc_real(Nx);\ndouble *qy = fftw_alloc_real(Ny);\n\n// declare and allocate memory for complex  variables\nfftw_complex *dh = fftw_alloc_complex(Nx*Ny);\nfftw_complex *dhft = fftw_alloc_complex(Nx*Ny);\nfftw_complex *Nonl = fftw_alloc_complex(Nx*Ny);\nfftw_complex *Nonlft = fftw_alloc_complex(Nx*Ny);\n\n// create the FFTW plans\nFT_h_hft = fftw_plan_dft_2d ( Nx, Ny, dh, dhft, FFTW_FORWARD, FFTW_ESTIMATE );\nFT_Nonl_Nonlft = fftw_plan_dft_2d ( Nx, Ny, Nonl, Nonlft, FFTW_FORWARD, FFTW_ESTIMATE );\nIFT_hft_h = fftw_plan_dft_2d ( Nx, Ny, dhft, dh, FFTW_BACKWARD, FFTW_ESTIMATE );\n\n// open file to store the data\nchar acstr[160];\nFILE *fp;\nsprintf(acstr, \"CH2d_IE_dt%.2f_dx%.3f_Nt%ld_Nx%d_Ny%d_#f%.ld.dat\",dt,dx,Nt,Nx,Ny,Nt/nframes);\n</code></pre>\n\n<p>After this preamble, I initialise my function h(x,y) with a uniform random noise, and I also take the FT of it. I set the imaginary part of h(x,y), which is <code>dh[i*Ny+j][1]</code> in the code, to 0, since it is a real function. Then I calculate the wavevectors <code>qx</code> and <code>qy</code>, and with them, I compute the linear operator of my equation in Fourier space, which is <code>Linft</code> in the code. I consider only the - fourth derivative of h as the linear term, so that the FT of the linear term is simply -q^4... but again, I don't want to go into the details of my integration method. The question is not about it.</p>\n\n<pre><code>// generate h(x,y) at initial time\nfor ( i = 0; i &lt; Nx; i++ ) {\n  for ( j = 0; j &lt; Ny; j++ ) {\n    rn = (double) rand()/RAND_MAX;    // extract a random number between 0 and 1\n    dh[i*Ny+j][0] = drift-2.0*drift*rn;    // shift of +-drift\n    dh[i*Ny+j][1] = 0.0;\n  }\n}\n\n// execute plan for the first time\nfftw_execute (FT_h_hft);\n\n// calculate wavenumbers\nfor (i = 0; i &lt; Nx; i++) { qx[i] = 2.0*i*pi/(Nx*dx); }\nfor (i = 0; i &lt; Ny; i++) { qy[i] = 2.0*i*pi/(Ny*dx); }\nfor (i = 1; i &lt; Nx/2; i++) { qx[Nx-i] = -qx[i]; }\nfor (i = 1; i &lt; Ny/2; i++) { qy[Ny-i] = -qy[i]; }\n\n// calculate the FT of the linear operator\nfor ( i = 0; i &lt; Nx; i++ ) {\n  for ( j = 0; j &lt; Ny; j++ ) {\n    Q2[i*Ny+j] = qx[i]*qx[i] + qy[j]*qy[j];\n    Linft[i*Ny+j] = -Q2[i*Ny+j]*Q2[i*Ny+j];\n  }\n}\n</code></pre>\n\n<p>Then, finally, it comes the time loop. Essentially, what I do is the following:</p>\n\n<ul>\n<li><p>Every once in a while, I save the data to a file and print some information on the terminal. In particular, I print the highest value of the FT of the Nonlinear term. I also check if h(x,y) is diverging to infinity (it shouldn't happen!),</p></li>\n<li><p>Calculate h^3 in direct space (that is simply <code>dh[i*Ny+j][0]*dh[i*Ny+j][0]*dh[i*Ny+j][0]</code>). Again, the imaginary part is set to 0,</p></li>\n<li><p>Take the FT of h^3,</p></li>\n<li><p>Obtain the complete Nonlinear term in reciprocal space (that is N[h_q] in the IE algorithm written above) by computing -q^2*(FT[h^3] - FT[h]). In the code, I am referring to the lines <code>Nonlft[i*Ny+j][0] = -Q2[i*Ny+j]*(Nonlft[i*Ny+j][0] -dhft[i*Ny+j][0])</code> and the one below, for the imaginary part. I do this because:</p></li>\n</ul>\n\n<p><a href=\"https://i.stack.imgur.com/830y6.gif\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/830y6.gif\" alt=\"enter image description here\"></a></p>\n\n<ul>\n<li>Advance in time using the IE method, transform back in direct space, and then normalise.</li>\n</ul>\n\n<p>Here is the code:</p>\n\n<pre><code>for(nt = 0; nt &lt; Nt; nt++) {\n\nif((nt % nframes)== 0) {\n  printf(\"%.0f %%\\n\",((double)nt/(double)Nt)*100);\n  printf(\"Nonlft   %.15f \\n\",Nonlft[(Nx/2)*(Ny/2)][0]);\n\n  // write data to file\n  fp = fopen(acstr,\"a\");\n  for ( i = 0; i &lt; Nx; i++ ) {\n    for ( j = 0; j &lt; Ny; j++ ) {\n      fprintf(fp, \"%4d  %4d  %.6f\\n\", i, j, dh[i*Ny+j][0]);\n      }\n  }\n  fclose(fp);\n\n}\n\n// check if h is going to infinity\nif (isnan(dh[1][0])!=0) {\n  printf(\"crashed!\\n\");\n  return 0;\n}\n\n// calculate nonlinear term h^3 in direct space\nfor ( i = 0; i &lt; Nx; i++ ) {\n  for ( j = 0; j &lt; Ny; j++ ) {\n      Nonl[i*Ny+j][0] = dh[i*Ny+j][0]*dh[i*Ny+j][0]*dh[i*Ny+j][0];\n      Nonl[i*Ny+j][1] = 0.0;\n  }\n}\n\n// Fourier transform of nonlinear term\nfftw_execute (FT_Nonl_Nonlft);\n\n// second derivative in Fourier space is just multiplication by -q^2\nfor ( i = 0; i &lt; Nx; i++ ) {\n  for ( j = 0; j &lt; Ny; j++ ) {\n    Nonlft[i*Ny+j][0] = -Q2[i*Ny+j]*(Nonlft[i*Ny+j][0] -dhft[i*Ny+j][0]);\n    Nonlft[i*Ny+j][1] = -Q2[i*Ny+j]*(Nonlft[i*Ny+j][1] -dhft[i*Ny+j][1]);\n  }\n}\n\n// Implicit Euler scheme in Fourier space\n for ( i = 0; i &lt; Nx; i++ ) {\n    for ( j = 0; j &lt; Ny; j++ ) {\n      dhft[i*Ny+j][0] = (dhft[i*Ny+j][0] + dt*Nonlft[i*Ny+j][0])/(1.0 - dt*Linft[i*Ny+j]);\n      dhft[i*Ny+j][1] = (dhft[i*Ny+j][1] + dt*Nonlft[i*Ny+j][1])/(1.0 - dt*Linft[i*Ny+j]);\n    }\n}\n\n// transform h back in direct space\nfftw_execute (IFT_hft_h);\n\n// normalize\nfor ( i = 0; i &lt; Nx; i++ ) {\n  for ( j = 0; j &lt; Ny; j++ ) {\n      dh[i*Ny+j][0] = dh[i*Ny+j][0] / (double) (Nx*Ny);\n      dh[i*Ny+j][1] = dh[i*Ny+j][1] / (double) (Nx*Ny);\n  }\n}\n\n}\n</code></pre>\n\n<p>Last part of the code: empty the memory and destroy FFTW plans.</p>\n\n<pre><code>// terminate the FFTW3 plan and free memory\nfftw_destroy_plan (FT_h_hft);\nfftw_destroy_plan (FT_Nonl_Nonlft);\nfftw_destroy_plan (IFT_hft_h);\n\nfftw_cleanup();\n\nfftw_free(dh);\nfftw_free(Nonl);\nfftw_free(qx);\nfftw_free(qy);\nfftw_free(Q2);\nfftw_free(Linft);\nfftw_free(dhft);\nfftw_free(Nonlft);\n\nreturn 0;\n\n}\n</code></pre>\n\n<p>If I run this code, I obtain the following output:</p>\n\n<pre><code>0 %\nNonlft   0.0000000000000000000\n1 %\nNonlft   -0.0000000000001353512\n2 %\nNonlft   -0.0000000000000115539\n3 %\nNonlft   0.0000000001376379599\n\n...\n\n69 %\nNonlft   -12.1987455309071730625\n70 %\nNonlft   -70.1631962517720353389\n71 %\nNonlft   -252.4941743351609204637\n72 %\nNonlft   347.5067875825179726235\n73 %\nNonlft   109.3351142318568633982\n74 %\nNonlft   39933.1054502610786585137\ncrashed!\n</code></pre>\n\n<p>The code crashes before reaching the end and we can see that the Nonlinear term is diverging.</p>\n\n<p>Now, the thing that doesn't make sense to me is that if I change the lines in which I calculate the FT of the Nonlinear term in the following way:</p>\n\n<pre><code>// calculate nonlinear term h^3 -h in direct space\nfor ( i = 0; i &lt; Nx; i++ ) {\n  for ( j = 0; j &lt; Ny; j++ ) {\n      Nonl[i*Ny+j][0] = dh[i*Ny+j][0]*dh[i*Ny+j][0]*dh[i*Ny+j][0] -dh[i*Ny+j][0];\n      Nonl[i*Ny+j][1] = 0.0;\n  }\n}\n\n// Fourier transform of nonlinear term\nfftw_execute (FT_Nonl_Nonlft);\n\n// second derivative in Fourier space is just multiplication by -q^2\nfor ( i = 0; i &lt; Nx; i++ ) {\n  for ( j = 0; j &lt; Ny; j++ ) {\n    Nonlft[i*Ny+j][0] = -Q2[i*Ny+j]* Nonlft[i*Ny+j][0]; \n    Nonlft[i*Ny+j][1] = -Q2[i*Ny+j]* Nonlft[i*Ny+j][1];\n  }\n}\n</code></pre>\n\n<p>Which means that I am using this definition: </p>\n\n<p><a href=\"https://i.stack.imgur.com/xvB2Y.gif\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/xvB2Y.gif\" alt=\"enter image description here\"></a></p>\n\n<p>instead of this one: </p>\n\n<p><a href=\"https://i.stack.imgur.com/M9ayh.gif\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/M9ayh.gif\" alt=\"enter image description here\"></a></p>\n\n<p>Then the code is perfectly stable and no divergence happens! Even for billions of time steps! <strong>Why does this happen, since the two ways of calculating <code>Nonlft</code> should be equivalent?</strong></p>\n\n<p>Thank you very much to anyone who will take the time to read all of this and give me some help!</p>\n\n<p>EDIT: To make things even more weird, I should point out that this bug does NOT happen for the same system in 1D. In 1D both methods of calculating <code>Nonlft</code> are stable.</p>\n\n<p>EDIT: I add a short animation of what happens to the function h(x,y) just before crashing. Also: I quickly re-wrote the code in MATLAB, which uses Fast Fourier Transform functions based on the FFTW library, and the bug is NOT happening... the mystery deepens.\n<a href=\"https://i.stack.imgur.com/G2PSv.gif\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/G2PSv.gif\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["c", "file", "indexing", "fetch"], "comments": [{"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 1, "creation_date": 1543403846, "post_id": 53518168, "comment_id": 93904996, "body": "15k is not too much. Just use an array and read it all in: <code>struct data { char code[11]; int quantity; }; struct data data[20000]; &#47;* some latitude *&#47; int ndata; &#47;* keep count *&#47;</code>"}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 1, "creation_date": 1543403851, "post_id": 53518168, "comment_id": 93904997, "body": "15 K is not that many. Why don&#39;t you load that file into memory (in a suitable data structure) and do the searches in memory? I cannot imagine any faster method in C."}, {"owner": {"reputation": 3350, "user_id": 7332147, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e4GFL.png?s=128&g=1", "display_name": "linuxfan says Reinstate Monica", "link": "https://stackoverflow.com/users/7332147/linuxfan-says-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1543404563, "post_id": 53518168, "comment_id": 93905412, "body": "Your idea is not bad, and reading the whole file in memory is slower than reading (and parsing) only what needed. BTW: what do you with &quot;index&quot;? You described none."}, {"owner": {"reputation": 169, "user_id": 6744246, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZcHwm.png?s=128&g=1", "display_name": "fusiled", "link": "https://stackoverflow.com/users/6744246/fusiled"}, "edited": false, "score": 0, "creation_date": 1543404919, "post_id": 53518168, "comment_id": 93905622, "body": "Grammar Hint: You shouldn&#39;t write dataS but just data: <a href=\"https://language-boutique.com/lost-in-translation-full-reader/these-data-are-or-this-data-is-.html\" rel=\"nofollow noreferrer\">https://language-boutique.com/lost-in-translation-full-reade&zwnj;&#8203;r/these-data-are-or-&zwnj;&#8203;this-data-is-.html</a>"}, {"owner": {"reputation": 87, "user_id": 5611428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f80bbb797b5262a8237aa5741e1d1f80?s=128&d=identicon&r=PG&f=1", "display_name": "Jos B", "link": "https://stackoverflow.com/users/5611428/jos-b"}, "reply_to_user": {"reputation": 3350, "user_id": 7332147, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e4GFL.png?s=128&g=1", "display_name": "linuxfan says Reinstate Monica", "link": "https://stackoverflow.com/users/7332147/linuxfan-says-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1543405720, "post_id": 53518168, "comment_id": 93906094, "body": "Hi @linuxfan I was wondering if there is a way to retrieve the line wanted using the code as index. Is the process I described really faster than reading the whole file in memory, and then browsing the memory to find the line wanted ? I forgot to mention that the program is gonna search through data multiple times not just once."}, {"owner": {"reputation": 3350, "user_id": 7332147, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e4GFL.png?s=128&g=1", "display_name": "linuxfan says Reinstate Monica", "link": "https://stackoverflow.com/users/7332147/linuxfan-says-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1543405835, "post_id": 53518168, "comment_id": 93906145, "body": "About index: this is not possible. If the program will search multiple times, then of course is better to cache data in ram (provided you have enough)."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1543410520, "post_id": 53518168, "comment_id": 93908952, "body": "Are the code numbers all the same length?  Are the quantities always 4 digits?  In other words, are the data entries all the same length?   And are the codes stored in a sorted order?  You have some searching options available if the codes are in sorted order that are not available if they\u2019re in an indeterminate order."}, {"owner": {"reputation": 87, "user_id": 5611428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f80bbb797b5262a8237aa5741e1d1f80?s=128&d=identicon&r=PG&f=1", "display_name": "Jos B", "link": "https://stackoverflow.com/users/5611428/jos-b"}, "edited": false, "score": 0, "creation_date": 1543410809, "post_id": 53518168, "comment_id": 93909139, "body": "The code numbers are all the same length and the quantity isn&#39;t always 4 digits, and the codes are stored in ascending order"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1543428370, "post_id": 53518168, "comment_id": 93919953, "body": "Given that the code numbers are stored in sorted order and there are 15k of them, you might find that a binary search on the file works.  You have to read enough data to be sure you&#39;ve got a complete record to work with; that would be at least two times the longest line (biggest quantity) plus the newlines.  You can then work through the file to find the right record in the usual binary search mode."}], "owner": {"reputation": 87, "user_id": 5611428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f80bbb797b5262a8237aa5741e1d1f80?s=128&d=identicon&r=PG&f=1", "display_name": "Jos B", "link": "https://stackoverflow.com/users/5611428/jos-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1543405102, "creation_date": 1543403684, "last_edit_date": 1543405102, "question_id": 53518168, "link": "https://stackoverflow.com/questions/53518168/a-good-way-to-fetch-data-in-a-file", "title": "A good way to fetch data in a file", "body": "<p>I'm working on a program which needs to get a code from an user input, and fetch data from a file with this code.</p>\n\n<p>The file contains 15k lines in this format:</p>\n\n<pre><code>code-quantity\n3014627896-1050\n8015627493-1920\n</code></pre>\n\n<p>So I need to find the code in the file and then extract the quantity next to it.\nAt first I was thinking about browsing the file with <code>fgets()</code>, extract the code from each line and test if the user input is matching the current code.</p>\n\n<p>I'm worried that it might be too slow, is there a better way to fetch data with an index in C? Thanks</p>\n"}, {"tags": ["c", "arrays", "string", "hex", "octal"], "comments": [{"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 1, "creation_date": 1543403642, "post_id": 53518084, "comment_id": 93904879, "body": "Just to be sure: you <i>do</i> know that there is a standard library function that does what you coded here as well as what you want to add?"}, {"owner": {"reputation": 25, "user_id": 9888624, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68212bfcca4c15359097d4411db67e24?s=128&d=identicon&r=PG&f=1", "display_name": "Trikalium", "link": "https://stackoverflow.com/users/9888624/trikalium"}, "reply_to_user": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 0, "creation_date": 1543403722, "post_id": 53518084, "comment_id": 93904925, "body": "Yes im aware of the strtol mehtod, but i dont want to use any librarys"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1543403761, "post_id": 53518084, "comment_id": 93904953, "body": "You already know how to check for negative numbers. What makes you think that checking for the <code>&#39;0&#39;</code> prefix (possibly followed by <code>&#39;x&#39;</code> or <code>&#39;X&#39;</code>) would be much different?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1543403838, "post_id": 53518084, "comment_id": 93904992, "body": "&quot;[I] dont want to use any librarys&quot;... Why? Is this part of an assignment? If not, then the standard library is <i>standard</i> and <code>strtol</code> will be available everywhere."}, {"owner": {"reputation": 25, "user_id": 9888624, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68212bfcca4c15359097d4411db67e24?s=128&d=identicon&r=PG&f=1", "display_name": "Trikalium", "link": "https://stackoverflow.com/users/9888624/trikalium"}, "edited": false, "score": 0, "creation_date": 1543403904, "post_id": 53518084, "comment_id": 93905036, "body": "I guess i would be able to handle those with some if statements, but im unsure how to change my calculation based on the fact that i have an octal or hexal value. Could i change my base of 10 to 8 or 16 depending on the case of octal or hexal values?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1543404018, "post_id": 53518084, "comment_id": 93905100, "body": "The <code>10</code> in the expression <code>n * 10</code> is for the base. Use a variable for the base. Then add special cases for <code>&#39;A&#39;</code> to <code>&#39;F&#39;</code> (<a href=\"https://en.cppreference.com/w/c/string/byte/isalpha\" rel=\"nofollow noreferrer\"><code>isalpha</code></a> is very useful for that) if <code>base == 16</code>. You could also add a check for <code>8</code> and <code>9</code> if <code>base == 8</code>."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1543404190, "post_id": 53518084, "comment_id": 93905191, "body": "Oh and note that while <code>str[i] - &#39;0&#39;</code> is well-defined for digits, the corresponding for characters (e.g. <code>str[i] - &#39;A&#39;</code>) is <i>not</i> defined by the C standard (though it works for ASCII which is arguably the only encoding you will probably encounter anyway)."}, {"owner": {"reputation": 25, "user_id": 9888624, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68212bfcca4c15359097d4411db67e24?s=128&d=identicon&r=PG&f=1", "display_name": "Trikalium", "link": "https://stackoverflow.com/users/9888624/trikalium"}, "edited": false, "score": 0, "creation_date": 1543406325, "post_id": 53518084, "comment_id": 93906432, "body": "I have implemented the functionality now and its running well for decimal and octal values but hexal values are still a problem. 0xA gets converted to 72 decimal, while it should be 10. This happens because the char &#39;A&#39; has the decimal value 65 in the ASCII table. Now that 65 - the &#39;0&#39; (which is 48 in ASCII) I get the value 17. So if I have a char in hexal i need to substratct not by &#39;0&#39;, but by 65 to get the desired decimal value. My question now is how can I change this during the calculation, because with 0x1A i first need -&#39;0&#39; for the 1, and then I need -&#39;A&#39; for the A."}, {"owner": {"reputation": 22818, "user_id": 509868, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/83450238b4ee0eddbf54d7ce5a3a64e4?s=128&d=identicon&r=PG", "display_name": "anatolyg", "link": "https://stackoverflow.com/users/509868/anatolyg"}, "edited": false, "score": 1, "creation_date": 1543406996, "post_id": 53518084, "comment_id": 93906859, "body": "I&#39;m voting to close this question as off-topic because the code was updated and now doesn&#39;t contain errors"}, {"owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "reply_to_user": {"reputation": 22818, "user_id": 509868, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/83450238b4ee0eddbf54d7ce5a3a64e4?s=128&d=identicon&r=PG", "display_name": "anatolyg", "link": "https://stackoverflow.com/users/509868/anatolyg"}, "edited": false, "score": 0, "creation_date": 1543407138, "post_id": 53518084, "comment_id": 93906942, "body": "@anatolyg it surely contains errors.  A to F is not been handled for hex numbers."}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 9888624, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68212bfcca4c15359097d4411db67e24?s=128&d=identicon&r=PG&f=1", "display_name": "Trikalium", "link": "https://stackoverflow.com/users/9888624/trikalium"}, "edited": false, "score": 0, "creation_date": 1543407468, "post_id": 53518304, "comment_id": 93907144, "body": "Im not sure if I get that notation. So the first part (str[i] &gt; =&#39;A&#39; &amp;&amp; stri[i]&lt;=&#39;B&#39;)? checks the condition and based on the outcome it takes either (str[i]-&#39;A&#39;+10) or (str[i]-&#39;0&#39;)."}, {"owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "reply_to_user": {"reputation": 25, "user_id": 9888624, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68212bfcca4c15359097d4411db67e24?s=128&d=identicon&r=PG&f=1", "display_name": "Trikalium", "link": "https://stackoverflow.com/users/9888624/trikalium"}, "edited": false, "score": 0, "creation_date": 1543407839, "post_id": 53518304, "comment_id": 93907344, "body": "Yes. I had typo just corrected it <code>(str[i] &gt; =&#39;A&#39; &amp;&amp; stri[i]&lt;=&#39;B&#39;)</code> --&gt; <code>(str[i] &gt; =&#39;A&#39; &amp;&amp; stri[i]&lt;=&#39;F&#39;)</code>"}], "tags": [], "owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "is_accepted": false, "score": 0, "last_activity_date": 1543407774, "last_edit_date": 1543407774, "creation_date": 1543404130, "answer_id": 53518304, "question_id": 53518084, "link": "https://stackoverflow.com/questions/53518084/stringtoint-conversion-with-octal-and-hexal/53518304#53518304", "title": "stringTOint conversion with octal and hexal", "body": "<p>You are not handling the cases <code>A</code> to <code>F</code> for hexa decimal values.</p>\n\n<pre><code>   for (i = offset; str[i] != '\\0'; i++) {\n       int value = (str[i] &gt; ='A' &amp;&amp; stri[i]&lt;='F')? (str[i]-'A'+10):(str[i]-'0');\n       n = n * base + value;\n    }\n</code></pre>\n\n<p>That is if char is <code>A</code> to <code>F</code>, just subtract <code>A</code> from <code>char</code> and add <code>10</code> to get the hexa decimal representation.</p>\n\n<p>Note: You need to use <code>%X</code> or <code>%x</code> to print in hexadecimal notation.</p>\n"}, {"comments": [{"owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "edited": false, "score": 0, "creation_date": 1543407277, "post_id": 53519186, "comment_id": 93907040, "body": "Checkout my below answer it tells you how to handle."}], "tags": [], "owner": {"reputation": 25, "user_id": 9888624, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68212bfcca4c15359097d4411db67e24?s=128&d=identicon&r=PG&f=1", "display_name": "Trikalium", "link": "https://stackoverflow.com/users/9888624/trikalium"}, "is_accepted": false, "score": -1, "last_activity_date": 1543407323, "last_edit_date": 1543407323, "creation_date": 1543407053, "answer_id": 53519186, "question_id": 53518084, "link": "https://stackoverflow.com/questions/53518084/stringtoint-conversion-with-octal-and-hexal/53519186#53519186", "title": "stringTOint conversion with octal and hexal", "body": "<p>My idea was to check the current char in the array if it is a decimal(so 0-9), or if it is an letter(so A-F) and then change the -'0' to -'A' and  if it is a letter and vice versa if it is a decimal number.</p>\n\n<pre><code>for (i = offset; str[i] != '\\0'; i++) {\n    if(str[i]==/*ABCDEF*/) {\n     c = 'A';\n} else if( str[i]==/*0123456789*/) {\n        c = '0';\n    }\n    n = n * base + str[i] - c;\n}\n</code></pre>\n\n<p>But I am unsure how to check the current character, because it only needs to be ONE of those and there should be a better way then to do 9 if statements and combine them with logical or.</p>\n"}, {"comments": [{"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 0, "creation_date": 1543416700, "post_id": 53519791, "comment_id": 93912937, "body": "Curiously, this will not cause an error on <code>0xX0</code>. Fortunately, OP is broad enough with that question to not have considered bad input <i>at all</i>. So a plus of such a badly stated question is that you are free to interpret such side effects any which way you want!"}, {"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 0, "creation_date": 1543416778, "post_id": 53519791, "comment_id": 93912979, "body": ".. Although limiting a string to <code>0x</code> to <i>lowercase</i> hex and <code>0X</code> to <i>uppercase</i> hex is going too far! I&#39;ve retracted my previous upvote for that."}], "tags": [], "owner": {"reputation": 1924, "user_id": 2669042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c66a47707c3d1748c9977727ddfa4d50?s=128&d=identicon&r=PG", "display_name": "xing", "link": "https://stackoverflow.com/users/2669042/xing"}, "is_accepted": false, "score": 0, "last_activity_date": 1543418820, "last_edit_date": 1543418820, "creation_date": 1543409060, "answer_id": 53519791, "question_id": 53518084, "link": "https://stackoverflow.com/questions/53518084/stringtoint-conversion-with-octal-and-hexal/53519791#53519791", "title": "stringTOint conversion with octal and hexal", "body": "<p>Another approach is to have an array of valid digits. Use <code>strchr</code> to check if the digit is valid. If valid, the difference between the pointers is the value to add without having to subtract character constants.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint stringTOint(char *str, int *number) {\n    char *digits = \"0123456789\";//pointer to string literal\n    char *valid = NULL;\n    char add = 0;\n    int sign = 1;\n    int base = 10;\n\n    *number = 0;\n    while ( ' ' == *str || '\\t' == *str) {\n        str++;//skip leading spaces tabs\n    }\n    if ( '-' == *str || '+' == *str) {\n        if ( '-' == *str) {\n            sign = -1;\n        }\n        str++;\n    }\n    if ( '0' == *str) {\n        digits = \"01234567\";//assign pointer to different string literal\n        base = 8;\n        str++;\n        if ( 'x' == *str) {//lowercase\n            digits = \"0123456789abcdef\";\n            base = 16;\n            str++;\n        }\n        if ( 'X' == *str &amp;&amp; '0' == *(str - 1)) {//uppercase\n            digits = \"0123456789ABCDEF\";\n            base = 16;\n            str++;\n        }\n    }\n    while (*str) {//not at terminating zero\n        if ( ( valid = strchr ( digits, *str))) {//is a valid digit\n            add = valid - digits;//value to add is difference between pointers\n            *number = *number * base + add;\n            str++;\n        }\n        else {\n            *number = 0;\n            return 0;//not a valid digit\n        }\n    }\n\n    *number = *number * sign;\n    return 1;\n}\n\nint main ( void) {\n    char text[100] = \"\";\n    int value = 0;\n\n    do {\n        printf ( \"enter an integer\\n\\t(leading 0 octal or leading 0x hexal)\\n\\tor enter done\\n\");\n        if ( fgets ( text, sizeof text, stdin)) {\n            if ( '\\n' == text[0]) {\n                break;//exit on empty line\n            }\n            text[strcspn ( text, \"\\n\")] = 0;//remove newline\n            if ( stringTOint ( text, &amp;value)) {\n                printf ( \"decimal value = %d\\n\", value);\n            }\n            else {\n                printf ( \"\\n\\tinput problem [%s]\\n\\n\", text);\n            }\n        }\n        else {\n            fprintf ( stderr, \"fgets EOF\\n\");\n            return 0;\n        }\n    } while ( strcmp ( text, \"done\"));//exit if input is done\n    return 0;\n}\n</code></pre>\n\n<p>Add</p>\n\n<pre><code>    if ( 'b' == *str) {\n        digits = \"01\";//assign pointer to different string literal\n        base = 2;\n        str++;\n    }\n</code></pre>\n\n<p>before</p>\n\n<pre><code>    while (*str) {//not at terminating zero\n</code></pre>\n\n<p>and binary value may be processeed using an input such as <code>b1101</code></p>\n\n<p>To allow for a mix of upper and lower case in hexal values, remove the entire <code>if</code> block for uppercase, include <code>ctype.h</code> and change  </p>\n\n<pre><code>if ( 'x' == *str) {\n</code></pre>\n\n<p>to</p>\n\n<pre><code>if ( 'x' == *str || 'X' == *str) {\n</code></pre>\n\n<p>and change</p>\n\n<pre><code>if ( ( valid = strchr ( digits, *str))) {\n</code></pre>\n\n<p>to</p>\n\n<pre><code>if ( ( valid = strchr ( digits, tolower ( *str)))) {\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 9888624, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68212bfcca4c15359097d4411db67e24?s=128&d=identicon&r=PG&f=1", "display_name": "Trikalium", "link": "https://stackoverflow.com/users/9888624/trikalium"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 109, "favorite_count": 0, "answer_count": 3, "score": -2, "last_activity_date": 1543418820, "creation_date": 1543403412, "last_edit_date": 1543406356, "question_id": 53518084, "link": "https://stackoverflow.com/questions/53518084/stringtoint-conversion-with-octal-and-hexal", "title": "stringTOint conversion with octal and hexal", "body": "<p>I have implemented a method that converts a given array of characters into a decimal integer. The method takes every character out of the array, calculates its decimal value and multiplys it with 10^n, where n gets incremeted with every iteration.</p>\n\n<blockquote>\n  <p>So for example the array 4711 would be converted like this.\n  1*10^0 + 1*10^1 + 7*10^2 + 4*10^3 = 4711 as decimal value.</p>\n</blockquote>\n\n<p>My question now is how to extend the functionality so the stringTOint method is also able to handle octal and hexal values, e.g. 023 or 0x1A.</p>\n\n<pre><code>/** Converts the given array of characters into a decimal integer */\nint stringTOint(char str[]) {\nint i, flag, offset, n,base;\nflag = 0;\nbase = 10;\nchar c = '0';\n/*if the first char in the array is '-', the minus flag gets set */\nif (str[0] == '-') {\n    flag = -1;\n}\nif (flag == -1) {\n    offset = 1;\n} else {\n    offset = 0;\n}\nif(offset == 0) {\n    if (str[0] == '0' &amp;&amp; (str[1] != 'x' &amp;&amp; str[1] != 'X') ) {\n        base = 8;  // Octal\n    } else if (str[0] == '0' &amp;&amp; (str[1] == 'x' || str[1] == 'X')) {\n        base = 16; // Hexadecimal\n        offset = offset + 2;\n    }\n}else if(offset == 1) {\n    if (str[1] == '0' &amp;&amp; (str[2] != 'x' &amp;&amp; str[2] != 'X') ) {\n        base = 8;  // Octal\n    } else if (str[1] == '0' &amp;&amp; (str[2] == 'x' || str[2] == 'X')) {\n        base = 16; // Hexadecimal\n        offset = offset + 2;\n    }\n}\nn = 0;\n/*Loop runs until terminating NULL gets found in array */\nfor (i = offset; str[i] != '\\0'; i++) {\n    n = n * base + str[i] - c;\n}\n/*value becomes negative if the negative flag was set */\nif (flag == -1) {\n    n = -n;\n}\n/* n gets returned */\nreturn n;\n}\n</code></pre>\n"}, {"tags": ["c", "linux"], "answers": [{"tags": [], "owner": {"reputation": 8652, "user_id": 2040863, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IspsC.jpg?s=128&g=1", "display_name": "John Hascall", "link": "https://stackoverflow.com/users/2040863/john-hascall"}, "is_accepted": true, "score": 3, "last_activity_date": 1543400859, "creation_date": 1543400859, "answer_id": 53517260, "question_id": 53517162, "link": "https://stackoverflow.com/questions/53517162/how-to-set-fifo-permissions-so-that-file-can-be-created/53517260#53517260", "title": "How to set fifo permissions so that file can be created", "body": "<p>Unless you are root (e.g. sudo 'd) you do not have permissions to create anything, including a fifo in the / directory suggest you choose a dir you do have write permission to.  Changing the permissions on / is not recommended. </p>\n"}], "owner": {"reputation": 45, "user_id": 9945448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90a32652da4dc3b48e6f6dcbac24f801?s=128&d=identicon&r=PG&f=1", "display_name": "Toope", "link": "https://stackoverflow.com/users/9945448/toope"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 448, "favorite_count": 0, "accepted_answer_id": 53517260, "answer_count": 1, "score": 3, "last_activity_date": 1543400859, "creation_date": 1543400540, "last_edit_date": 1543400598, "question_id": 53517162, "link": "https://stackoverflow.com/questions/53517162/how-to-set-fifo-permissions-so-that-file-can-be-created", "title": "How to set fifo permissions so that file can be created", "body": "<p>I am doing a school project in which I have to buplicate the syslog daemon. I am trying to write for the syslog daemon via a named pipe which is opened with command </p>\n\n<pre><code>char * fdfifo = \"/fifo\";\nmkfifo(fdfifo, 0666);\n</code></pre>\n\n<p>However when I try to open the pipe, i get an error message from errno:</p>\n\n<pre><code>Value of errno: 13\nError printed by perror: Permission denied\nError opening file: Permission denied\n</code></pre>\n\n<p>when I run the application as sudo, the file is created as it should be. And the problem is only encountered when the file, in which I am trying to store the file descriptor doesn't exist and I have to create the file.</p>\n\n<p>Here is my full code until the point of the error:</p>\n\n<pre><code>pthread_mutex_t lock2;\nchar * logName;\nint fd[2];\n\nstatic volatile int keepRunning = 1;\n\nvoid intHandler(int dummy) {\n    keepRunning = 0;\n}\n\nint openLog(char* logname, pthread_mutex_t lock, pthread_t tid){\n    signal(SIGINT, intHandler);\n    lock2=lock;\n    logName = logname;\n//    FILE *f;\n    pid_t pid;\n\n    /* Fork off the parent process */\n    pid = fork();\n\n    /* An error occurred */\n    if (pid &lt; 0)\n        exit(EXIT_FAILURE);\n\n    /* Success: Let the parent terminate */\n    if (pid &gt; 0)\n        return 0;\n\n    /* On success: The child process becomes session leader */\n    if (setsid() &lt; 0)\n        exit(EXIT_FAILURE);\n\n    /* Catch, ignore and handle signals */\n    //TODO: Implement a working signal handler */\n    signal(SIGCHLD, SIG_IGN);\n    signal(SIGHUP, SIG_IGN);\n\n    /* Fork off for the second time*/\n    pid = fork();\n\n    /* An error occurred */\n    if (pid &lt; 0)\n        exit(EXIT_FAILURE);\n\n    /* Success: Let the parent terminate */\n    if (pid &gt; 0){\n        exit(EXIT_SUCCESS);\n    }\n    /* Set new file permissions */\n    umask(0);\n    char * fdfifo = \"/fifo\";\n    mkfifo(fdfifo, 0666);\n    int errnum;\n    errnum = errno;\n    fprintf(stderr, \"Value of errno: %d\\n\", errno);\n    perror(\"Error printed by perror\");\n    fprintf(stderr, \"Error opening file: %s\\n\", strerror( errnum ));\n</code></pre>\n"}, {"tags": ["c", "arrays", "string", "file-management"], "comments": [{"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 1, "creation_date": 1543398397, "post_id": 53516420, "comment_id": 93901772, "body": "<code>date_trans[i][j]</code> is a <code>char</code>, not a <code>char *</code>"}, {"owner": {"reputation": 27, "user_id": 10657248, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c218efd82d078ed97ed9706b8d0324c6?s=128&d=identicon&r=PG&f=1", "display_name": "partynextdoor18", "link": "https://stackoverflow.com/users/10657248/partynextdoor18"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1543398931, "post_id": 53516420, "comment_id": 93902093, "body": "@PaulOgilvie Hi, thanks for commenting. Could you elaborate on why date_trans[i] is a char* but date_trans[i][j] is not?"}, {"owner": {"reputation": 3478, "user_id": 9061264, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TPing.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/9061264/mike"}, "edited": false, "score": 0, "creation_date": 1543399001, "post_id": 53516420, "comment_id": 93902142, "body": "you need brackets for the &#39;else&#39; statement. Identation ist not enough!"}, {"owner": {"reputation": 667, "user_id": 3666039, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca2861e66b0757e5f6198b974afe0993?s=128&d=identicon&r=PG&f=1", "display_name": "simon3270", "link": "https://stackoverflow.com/users/3666039/simon3270"}, "edited": false, "score": 0, "creation_date": 1543400038, "post_id": 53516420, "comment_id": 93902776, "body": "And brackets in the &quot;for j&quot; loop to enclose the fgets and printf statements. This isn&#39;t Python!"}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1543406127, "post_id": 53516420, "comment_id": 93906339, "body": "<code>date_trans</code> is an array of strings. <code>date_trans[i]</code> is one string and so points to the chars that make up the string. The compiler interprets it as a pointer to char."}], "answers": [{"tags": [], "owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "is_accepted": false, "score": 0, "last_activity_date": 1543398298, "creation_date": 1543398298, "answer_id": 53516460, "question_id": 53516420, "link": "https://stackoverflow.com/questions/53516420/c-file-management-unable-to-obtain-desired-output/53516460#53516460", "title": "C - File management, unable to obtain desired output", "body": "<p>Change this</p>\n\n<pre><code>    fgets(date_trans[i][j], 15, stdin);\n    printf(\"%s\", date_trans[i][j]);\n</code></pre>\n\n<p>to </p>\n\n<pre><code>    fgets(date_trans[i], 15, stdin);\n    printf(\"%s\", date_trans[i]);\n</code></pre>\n\n<p><code>date_trans[i][j]</code> is <code>char</code> type not <code>char *</code>. Also you don't need <code>j</code> for loop.</p>\n"}, {"comments": [{"owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "edited": false, "score": 0, "creation_date": 1543398545, "post_id": 53516496, "comment_id": 93901872, "body": "<code>fgets(data_trans[i], sizeof data_trans[i], f1);</code> --&gt; <code>fgets(data_trans[i], sizeof data_trans[i], stdin);</code> OP intended to read in from <code>stdin</code>."}, {"owner": {"reputation": 27, "user_id": 10657248, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c218efd82d078ed97ed9706b8d0324c6?s=128&d=identicon&r=PG&f=1", "display_name": "partynextdoor18", "link": "https://stackoverflow.com/users/10657248/partynextdoor18"}, "edited": false, "score": 0, "creation_date": 1543398880, "post_id": 53516496, "comment_id": 93902060, "body": "Thanks but I really don&#39;t get it still. I just read that char* is a pointer to a char so I don&#39;t understand why a 2d would be a char type instead of a char* type. It&#39;s really important that it is a 2d array as I need to read multiple strings."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 27, "user_id": 10657248, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c218efd82d078ed97ed9706b8d0324c6?s=128&d=identicon&r=PG&f=1", "display_name": "partynextdoor18", "link": "https://stackoverflow.com/users/10657248/partynextdoor18"}, "edited": false, "score": 0, "creation_date": 1543399100, "post_id": 53516496, "comment_id": 93902210, "body": "@partynextdoor18 <code>data_trans</code> is of type <code>char [100][15]</code>. <code>data_trans[i]</code> is of type <code>char [15]</code>. And <code>data_trans[i][j]</code> is of type <code>char</code>. I.e. <code>data_trans[i][j]</code> isn&#39;t a &quot;string&quot;, it&#39;s a single character."}, {"owner": {"reputation": 27, "user_id": 10657248, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c218efd82d078ed97ed9706b8d0324c6?s=128&d=identicon&r=PG&f=1", "display_name": "partynextdoor18", "link": "https://stackoverflow.com/users/10657248/partynextdoor18"}, "edited": false, "score": 0, "creation_date": 1543399966, "post_id": 53516496, "comment_id": 93902726, "body": "@Someprogrammerdude Yes, I&#39;m aware of that. If so, how would I go about having an array of 100 rows 15 columns ([100][15]), so 100 strings with up to 15 characters each if not the method I employed in the main post?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 27, "user_id": 10657248, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c218efd82d078ed97ed9706b8d0324c6?s=128&d=identicon&r=PG&f=1", "display_name": "partynextdoor18", "link": "https://stackoverflow.com/users/10657248/partynextdoor18"}, "edited": false, "score": 0, "creation_date": 1543401100, "post_id": 53516496, "comment_id": 93903398, "body": "@partynextdoor18 Like I said in my answer: Don&#39;t have the inner loop, and the shown <code>fgets</code> call instead."}, {"owner": {"reputation": 27, "user_id": 10657248, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c218efd82d078ed97ed9706b8d0324c6?s=128&d=identicon&r=PG&f=1", "display_name": "partynextdoor18", "link": "https://stackoverflow.com/users/10657248/partynextdoor18"}, "edited": false, "score": 0, "creation_date": 1543405195, "post_id": 53516496, "comment_id": 93905773, "body": "@Someprogrammerdude I see, thanks. Could you give advice on my 2nd problem? I just added it to the post."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 27, "user_id": 10657248, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c218efd82d078ed97ed9706b8d0324c6?s=128&d=identicon&r=PG&f=1", "display_name": "partynextdoor18", "link": "https://stackoverflow.com/users/10657248/partynextdoor18"}, "edited": false, "score": 0, "creation_date": 1543405281, "post_id": 53516496, "comment_id": 93905810, "body": "@partynextdoor18 That&#39;s a very different problem and should be asked as a different question. And please take <a href=\"http://stackoverflow.com/tour\">the SO tour</a>, read about <a href=\"http://stackoverflow.com/help/how-to-ask\">how to ask good questions</a>, as well as <a href=\"https://codeblog.jonskeet.uk/2012/11/24/stack-overflow-question-checklist/\" rel=\"nofollow noreferrer\">this question checklist</a>. Lastly learn how to create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}], "tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": true, "score": 3, "last_activity_date": 1543398583, "last_edit_date": 1543398583, "creation_date": 1543398377, "answer_id": 53516496, "question_id": 53516420, "link": "https://stackoverflow.com/questions/53516420/c-file-management-unable-to-obtain-desired-output/53516496#53516496", "title": "C - File management, unable to obtain desired output", "body": "<p>I see <strong><em>two</em></strong> problems with the code you show:</p>\n\n<ol>\n<li>The warning you get, because <code>date_trans[i][j]</code> is a <code>char</code>, not a <code>char *</code></li>\n<li>Your inner loop goes from <code>0</code> to <code>20</code> (inclusive) and you use that as index into an array with 15 elements (i.e. indexes from <code>0</code> to <code>14</code> inclusive).</li>\n</ol>\n\n<p>To solve both problems, don't have the inner loop, instead in the outer do</p>\n\n<pre><code>fgets(data_trans[i], sizeof data_trans[i], stdin);\n</code></pre>\n\n<p>Problem number 1 also exists in the <code>printf</code> call, where you pass a single <code>char</code> to a format that expects a <code>char *</code>.</p>\n\n<p>Lastly a note about your requirement of strings containing 15 characters: Don't forget the null-terminator, and its need for a space in the array as well. That means you currently have place for <strong><em>14</em></strong> characters plus the terminator.</p>\n"}], "owner": {"reputation": 27, "user_id": 10657248, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c218efd82d078ed97ed9706b8d0324c6?s=128&d=identicon&r=PG&f=1", "display_name": "partynextdoor18", "link": "https://stackoverflow.com/users/10657248/partynextdoor18"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 53516496, "answer_count": 2, "score": 0, "last_activity_date": 1543404591, "creation_date": 1543398166, "last_edit_date": 1543404591, "question_id": 53516420, "link": "https://stackoverflow.com/questions/53516420/c-file-management-unable-to-obtain-desired-output", "title": "C - File management, unable to obtain desired output", "body": "<p>I am working on my school assignment and I've come across my first major hurdle... I am unable to write to a file or even retrieve input using scanf and fgets. </p>\n\n<p>Problem 1:</p>\n\n<pre><code>FILE *f1;\nchar date_trans[100][15];\n    f1 = fopen(\"test.txt\", \"w\");\n\nif (f1 == NULL)\n    printf(\"File could not be opened.\\n\");\n\nelse\n    printf(\"Enter details (sender, receiver, amount.)\\n\");\n\n    for(i = 0; i &lt;= element; i++)\n    {\n        for(j = 0; j &lt;= 20; j++)\n            fgets(date_trans[i][j], 15, stdin);\n            printf(\"%s\", date_trans[i][j]);\n    }\n    fclose(f1);  \n</code></pre>\n\n<p>This is a small snippet; with the above code I am unable to retrieve the input entered and print it out on display/to a file. </p>\n\n<p>My intent is to have 100 strings and up to 15 characters each.</p>\n\n<p>So say if I were to enter a date like 18/12/15 or like 18-12-15, or a word like \"Daniel\", the program stops abruptly for a few seconds after I press enter and then proceeds to display \"Press any key...\".</p>\n\n<p>I also receive this error...</p>\n\n<p><code>[Warning] ...\\assignment\\test.c:22: warning: passing arg 1 of `fgets' makes pointer from integer without a cast</code></p>\n\n<p>which I really do not understand as the variable date_trans is a string/an 2d array of characters, not an integer, right?</p>\n\n<hr>\n\n<p>Edit:</p>\n\n<p>Problem 2:</p>\n\n<pre><code>    for (j=0; j &lt;= 50 || !feof(f1); j++); // f1 opened in 'r' mode.\n        {\n            fscanf(f1, \"%s %d %s %d %s %f\", date_trans[j], &amp;accsend[j], accnames[j],\n            &amp;accreceive[j], accnamer[j], &amp;amount_trans[j]);\n            printf(\"%d %s %d %s %d %s %.2f\\n\", j+1, date_trans[j], accsend[j], accnames[j], \n            accreceive[j], accnamer[j], amount_trans[j]); \n        }\n</code></pre>\n\n<p>In the code above, I am trying to input data through the stream f1 with function fscanf, which was opened in read mode. However the output makes the program hang and I am also unable to type or do any actions within the program.</p>\n\n<p>As well, please advise whether my usage of !feof is correct/appropriate.</p>\n\n<p>Thanks for any help.</p>\n"}, {"tags": ["c++", "c", "makefile", "linker", "legacy"], "comments": [{"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 2, "creation_date": 1543397924, "post_id": 53516322, "comment_id": 93901445, "body": "Some some <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> please, and explain <i>all</i> your compilation commands. So <a href=\"https://stackoverflow.com/posts/53516322/edit\">edit</a> your question to improve it"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1543397975, "post_id": 53516322, "comment_id": 93901481, "body": "To build your C++ source you need to use <code>g++</code>. Continue to use <code>gcc</code> to build the C sources."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1543398067, "post_id": 53516322, "comment_id": 93901552, "body": "<code>gcc -std=c++0x -lstdc++ -std=c++11</code> How is gcc supposed to stick to two different C++ standards at a time?"}, {"owner": {"reputation": 429, "user_id": 10209003, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8d9d1dd420c5e9381d2978720c47940?s=128&d=identicon&r=PG&f=1", "display_name": "Korni", "link": "https://stackoverflow.com/users/10209003/korni"}, "edited": false, "score": 3, "creation_date": 1543398070, "post_id": 53516322, "comment_id": 93901558, "body": "seems like your error has nothing to do with the <code>extern &quot;C&quot;</code>, the type of <code>init</code> is missing, see <code>.&#47;sortcodes&#47;oci.c:188:25: error: \u2018init\u2019 does not name a type static init=TRUE;</code>"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1543398144, "post_id": 53516322, "comment_id": 93901610, "body": "You forgot to show us the code where the error is reported. Looking at pieces that do not trigger an error message won&#39;t help."}, {"owner": {"reputation": 429, "user_id": 10209003, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8d9d1dd420c5e9381d2978720c47940?s=128&d=identicon&r=PG&f=1", "display_name": "Korni", "link": "https://stackoverflow.com/users/10209003/korni"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1543398279, "post_id": 53516322, "comment_id": 93901688, "body": "@Someprogrammerdude <code>gcc</code> is totally fine, since gnu automatically determines the language by the file extensions <code>.c</code> , <code>.cpp</code> ..."}, {"owner": {"reputation": 13, "user_id": 5872481, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cQLUp.jpg?s=128&g=1", "display_name": "Nikolay Sosnin", "link": "https://stackoverflow.com/users/5872481/nikolay-sosnin"}, "edited": false, "score": 0, "creation_date": 1543398325, "post_id": 53516322, "comment_id": 93901715, "body": "Basile, unfortunately I cannot include such an example as both the C and the C++ codes are massive. In the example of compilation with g++, there are errors coming from every single .c file included in the program."}, {"owner": {"reputation": 13, "user_id": 5872481, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cQLUp.jpg?s=128&g=1", "display_name": "Nikolay Sosnin", "link": "https://stackoverflow.com/users/5872481/nikolay-sosnin"}, "edited": false, "score": 0, "creation_date": 1543398386, "post_id": 53516322, "comment_id": 93901764, "body": "The example of an error I gave is triggered by this line: static init=TRUE;"}, {"owner": {"reputation": 429, "user_id": 10209003, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8d9d1dd420c5e9381d2978720c47940?s=128&d=identicon&r=PG&f=1", "display_name": "Korni", "link": "https://stackoverflow.com/users/10209003/korni"}, "edited": false, "score": 1, "creation_date": 1543398396, "post_id": 53516322, "comment_id": 93901771, "body": "@NikolaySosnin seems like an syntax error in that file and has nothing to do with external linkage. <code>static init=TRUE;</code> is just plain wrong, since the type is missing, change that to <code>static int init=TRUE;</code> or some other type"}, {"owner": {"reputation": 13, "user_id": 5872481, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cQLUp.jpg?s=128&g=1", "display_name": "Nikolay Sosnin", "link": "https://stackoverflow.com/users/5872481/nikolay-sosnin"}, "reply_to_user": {"reputation": 429, "user_id": 10209003, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8d9d1dd420c5e9381d2978720c47940?s=128&d=identicon&r=PG&f=1", "display_name": "Korni", "link": "https://stackoverflow.com/users/10209003/korni"}, "edited": false, "score": 0, "creation_date": 1543398458, "post_id": 53516322, "comment_id": 93901817, "body": "@Korni, I would agree, but the program compiles well if I remove the C++ bits and just compile it as normal C."}, {"owner": {"reputation": 3531, "user_id": 10553341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba6a76c909bfdb760607076ee5aad83c?s=128&d=identicon&r=PG&f=1", "display_name": "Damien", "link": "https://stackoverflow.com/users/10553341/damien"}, "edited": false, "score": 1, "creation_date": 1543398599, "post_id": 53516322, "comment_id": 93901902, "body": "@NikolaySosnin You could provide a short working example by extracting only needed information from your code"}, {"owner": {"reputation": 429, "user_id": 10209003, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8d9d1dd420c5e9381d2978720c47940?s=128&d=identicon&r=PG&f=1", "display_name": "Korni", "link": "https://stackoverflow.com/users/10209003/korni"}, "edited": false, "score": 0, "creation_date": 1543398610, "post_id": 53516322, "comment_id": 93901906, "body": "@NikolaySosnin there is a flag in the compiler called <code>default-int</code>, if the type specifier is missing in the source code <code>int</code> is assumed. C++  does not support <code>default-int</code>"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 429, "user_id": 10209003, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8d9d1dd420c5e9381d2978720c47940?s=128&d=identicon&r=PG&f=1", "display_name": "Korni", "link": "https://stackoverflow.com/users/10209003/korni"}, "edited": false, "score": 2, "creation_date": 1543398657, "post_id": 53516322, "comment_id": 93901934, "body": "@Korni <i>Except</i> that it doesn&#39;t add the path for the C++ standard library header files. Which is one of the problems the OP have."}, {"owner": {"reputation": 13, "user_id": 5872481, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cQLUp.jpg?s=128&g=1", "display_name": "Nikolay Sosnin", "link": "https://stackoverflow.com/users/5872481/nikolay-sosnin"}, "reply_to_user": {"reputation": 429, "user_id": 10209003, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8d9d1dd420c5e9381d2978720c47940?s=128&d=identicon&r=PG&f=1", "display_name": "Korni", "link": "https://stackoverflow.com/users/10209003/korni"}, "edited": false, "score": 0, "creation_date": 1543398693, "post_id": 53516322, "comment_id": 93901959, "body": "@Korni, I have also suspected that line and I did re-declare it as static bool init = TRUE; This has worked to remove that particular error, but it does also mean that the original program is not handled in the same way as if I didn&#39;t include the C++ function, which seems suspicious to me and I cannot re-write all the C++ changes to all the C codes."}, {"owner": {"reputation": 429, "user_id": 10209003, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8d9d1dd420c5e9381d2978720c47940?s=128&d=identicon&r=PG&f=1", "display_name": "Korni", "link": "https://stackoverflow.com/users/10209003/korni"}, "edited": false, "score": 0, "creation_date": 1543398871, "post_id": 53516322, "comment_id": 93902055, "body": "@NikolaySosnin the most clean and consitent way is to fix <code>.&#47;sortcodes&#47;oci.c</code>, using <code>default-int</code> is bad coding behaviour imo. You&#39;ll maybe face other issue with the <code>&#236;nt</code> to <code>bool</code> workaround."}, {"owner": {"reputation": 429, "user_id": 10209003, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8d9d1dd420c5e9381d2978720c47940?s=128&d=identicon&r=PG&f=1", "display_name": "Korni", "link": "https://stackoverflow.com/users/10209003/korni"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1543398959, "post_id": 53516322, "comment_id": 93902116, "body": "@Someprogrammerdude your&#39;re right I missed that ;)"}], "answers": [{"comments": [{"owner": {"reputation": 429, "user_id": 10209003, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8d9d1dd420c5e9381d2978720c47940?s=128&d=identicon&r=PG&f=1", "display_name": "Korni", "link": "https://stackoverflow.com/users/10209003/korni"}, "edited": false, "score": 0, "creation_date": 1543398334, "post_id": 53516410, "comment_id": 93901724, "body": "Thats wrong, as I stated in the comments above: <code>gcc</code> is totally fine, since gnu automatically determines the language by the file extensions .c , .cpp"}, {"owner": {"reputation": 3980, "user_id": 8769985, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72402fe064285d9e3e85fd3ca5900e5a?s=128&d=identicon&r=PG&f=1", "display_name": "francesco", "link": "https://stackoverflow.com/users/8769985/francesco"}, "reply_to_user": {"reputation": 429, "user_id": 10209003, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8d9d1dd420c5e9381d2978720c47940?s=128&d=identicon&r=PG&f=1", "display_name": "Korni", "link": "https://stackoverflow.com/users/10209003/korni"}, "edited": false, "score": 0, "creation_date": 1543398612, "post_id": 53516410, "comment_id": 93901908, "body": "@Korni Sure, <code>gcc</code> and <code>g++</code> are <i>essentially</i> the same software, but if you use <code>gcc</code> you will need to explicitly link against the standard template library. It is easier to simply use <code>g++</code> or <code>clang++</code>. My answer emphasizes that <code>c++</code> code has to be compiled by <code>c++</code> compilers..."}, {"owner": {"reputation": 13, "user_id": 5872481, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cQLUp.jpg?s=128&g=1", "display_name": "Nikolay Sosnin", "link": "https://stackoverflow.com/users/5872481/nikolay-sosnin"}, "edited": false, "score": 0, "creation_date": 1543398906, "post_id": 53516410, "comment_id": 93902079, "body": "I have tried compiling with g++. But I have added external &quot;C&quot; to all the C codes. Should it be in the .cpp?"}, {"owner": {"reputation": 3980, "user_id": 8769985, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72402fe064285d9e3e85fd3ca5900e5a?s=128&d=identicon&r=PG&f=1", "display_name": "francesco", "link": "https://stackoverflow.com/users/8769985/francesco"}, "reply_to_user": {"reputation": 13, "user_id": 5872481, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cQLUp.jpg?s=128&g=1", "display_name": "Nikolay Sosnin", "link": "https://stackoverflow.com/users/5872481/nikolay-sosnin"}, "edited": false, "score": 0, "creation_date": 1543399089, "post_id": 53516410, "comment_id": 93902206, "body": "@NikolaySosnin In the c++ source you have to <i>declare</i> <code>extern C</code> only the c++ functions you want to use in the C code. Then in the C code you have to provide a declaration (without <code>extern C</code>). Please have a look at the link."}, {"owner": {"reputation": 13, "user_id": 5872481, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cQLUp.jpg?s=128&g=1", "display_name": "Nikolay Sosnin", "link": "https://stackoverflow.com/users/5872481/nikolay-sosnin"}, "edited": false, "score": 0, "creation_date": 1543425933, "post_id": 53516410, "comment_id": 93918822, "body": "@francesco The link has helped a lot, thanks! Moving the extern &quot;C&quot; to .cpp and declaring it at the top of the C code that used it has solved the compilation problems."}], "tags": [], "owner": {"reputation": 3980, "user_id": 8769985, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72402fe064285d9e3e85fd3ca5900e5a?s=128&d=identicon&r=PG&f=1", "display_name": "francesco", "link": "https://stackoverflow.com/users/8769985/francesco"}, "is_accepted": true, "score": 2, "last_activity_date": 1543399217, "last_edit_date": 1543399217, "creation_date": 1543398148, "answer_id": 53516410, "question_id": 53516322, "link": "https://stackoverflow.com/questions/53516322/calling-a-c-function-from-c-program/53516410#53516410", "title": "Calling a C++ Function from C Program", "body": "<p>First, to compile the c++ code you have to use a c++ compiler like g++ or clang++. Then, you need to declare the desidered c++ function with <code>extern \"C\"</code> linkage. At this point you can call the function from the C code.\nRefer to <a href=\"https://isocpp.org/wiki/faq/mixing-c-and-cpp#call-cpp\" rel=\"nofollow noreferrer\">How do I call a C++ function from C</a> for a concrete example.</p>\n"}], "owner": {"reputation": 13, "user_id": 5872481, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cQLUp.jpg?s=128&g=1", "display_name": "Nikolay Sosnin", "link": "https://stackoverflow.com/users/5872481/nikolay-sosnin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 139, "favorite_count": 0, "accepted_answer_id": 53516410, "answer_count": 1, "score": 1, "last_activity_date": 1543399217, "creation_date": 1543397845, "question_id": 53516322, "link": "https://stackoverflow.com/questions/53516322/calling-a-c-function-from-c-program", "title": "Calling a C++ Function from C Program", "body": "<p>I am working on adding a function written in C++ to a large program written in C.</p>\n\n<p>I have tried to surround all of the codes included in the C program in extern \"C\" blocks, but when I compile with g++, I still get the errors coming from compiler trying to compile C as C++. I have added the extern \"C\" blocks to all the headers and .c files as follows:</p>\n\n<pre><code>#ifdef __cplusplus\nextern \"C\"\n{\n#endif\n\n//C code here\n\n#ifdef __cplusplus\n}\n#endif\n</code></pre>\n\n<p>The errors look like this:</p>\n\n<blockquote>\n  <p>./sortcodes/oci.c: In function \u2018int GetSpecList(ClientData,\n  Tcl_Interp*, int, Tcl_Obj* const*)\u2019: ./sortcodes/oci.c:188:25: error:\n  \u2018init\u2019 does not name a type\n           static init=TRUE;</p>\n</blockquote>\n\n<p>These errors do not occur if I remove my C++ function call and just compile the C program with gcc. </p>\n\n<p>If I remove the extern \"C\" blocks and compile using options</p>\n\n<blockquote>\n  <p>gcc -std=c++0x -lstdc++ -std=c++11</p>\n</blockquote>\n\n<p>I get errors like the one below, where C++ flags were obviously ignored</p>\n\n<blockquote>\n  <p>./Event_Reader.cpp:9:20: fatal error: iostream: No such file or directory\n   #include </p>\n</blockquote>\n\n<p>Are there any options that I am missing or misinterpreting? Any advice would be appreciated.</p>\n"}, {"tags": ["c++", "c", "algorithm", "huffman-code"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1543397024, "post_id": 53516000, "comment_id": 93900905, "body": "Please read about <a href=\"http://stackoverflow.com/help/how-to-ask\">how to ask good questions</a>, as well as <a href=\"https://codeblog.jonskeet.uk/2012/11/24/stack-overflow-question-checklist/\" rel=\"nofollow noreferrer\">this question checklist</a>. And of course please learn how to create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. Lastly, please pick <i>one</i> language. C and C++ are two <i>very</i> different languages."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 2, "creation_date": 1543397367, "post_id": 53516000, "comment_id": 93901113, "body": "Which 3 bit CPU did you have in mind to use for this?"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1543397472, "post_id": 53516000, "comment_id": 93901171, "body": "Use a bit-field , if you wish!!"}, {"owner": {"reputation": 65718, "user_id": 844416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e39c2364935265593d76247ddc6d07c?s=128&d=identicon&r=PG", "display_name": "MBo", "link": "https://stackoverflow.com/users/844416/mbo"}, "edited": false, "score": 0, "creation_date": 1543397931, "post_id": 53516000, "comment_id": 93901451, "body": "It seems you need to study Huffman coding  algorithm in some book or good article, then try to implement. Note that length of codes is variable, so you cannot guarantee 3 bits length (excluding case of 5 possible chars)"}, {"owner": {"reputation": 2026, "user_id": 1406083, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1gC8p.jpg?s=128&g=1", "display_name": "Billy Brown", "link": "https://stackoverflow.com/users/1406083/billy-brown"}, "edited": false, "score": 0, "creation_date": 1543398328, "post_id": 53516000, "comment_id": 93901720, "body": "This sounds a lot like a homework assignment. A good way to do this is to separate your code into two pieces: the first returns lists of 1s and 0s, which the second then compresses into actual bits. Use the left-shift operator <code>&lt;&lt;</code> and OR assignment operator <code>|=</code> to push bits onto a variable. <a href=\"https://en.wikipedia.org/wiki/Bitwise_operations_in_C\" rel=\"nofollow noreferrer\">C Bitwise Operations</a>"}, {"owner": {"reputation": 703, "user_id": 9999814, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D0vR5.jpg?s=128&g=1", "display_name": "AmanSharma", "link": "https://stackoverflow.com/users/9999814/amansharma"}, "reply_to_user": {"reputation": 2026, "user_id": 1406083, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1gC8p.jpg?s=128&g=1", "display_name": "Billy Brown", "link": "https://stackoverflow.com/users/1406083/billy-brown"}, "edited": false, "score": 0, "creation_date": 1543403706, "post_id": 53516000, "comment_id": 93904917, "body": "@BillyBrown Actually i created minor project and built hoffman codes  and i want to built its real model like a compressor but how to reduce size of file that is main hurdle. Can u help me to do that?"}, {"owner": {"reputation": 703, "user_id": 9999814, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D0vR5.jpg?s=128&g=1", "display_name": "AmanSharma", "link": "https://stackoverflow.com/users/9999814/amansharma"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1543403962, "post_id": 53516000, "comment_id": 93905064, "body": "@SouravGhosh Thanks mate, but how to specify it during runtime."}, {"owner": {"reputation": 2026, "user_id": 1406083, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1gC8p.jpg?s=128&g=1", "display_name": "Billy Brown", "link": "https://stackoverflow.com/users/1406083/billy-brown"}, "edited": false, "score": 0, "creation_date": 1543406474, "post_id": 53516000, "comment_id": 93906521, "body": "@AmanSharma Ok, I was just checking, as I had it as an assignment at university. I have an answer that, when given an array of 1 and 0 ints, compresses them into bits, but I cannot yet post it."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1543407798, "post_id": 53516000, "comment_id": 93907322, "body": "You manufacture a stream of bits out of some integer type (<code>unsigned char</code>, <code>unsigned int</code>, or other type you choose). As you produce new bits, you append them to your stream, using bit operations to position them within the larger integer type. At times this will require splitting them across multiple units. For example, the first three bits would go into bits 7 to 5 of an <code>unsigned char</code>, then the next four in bits 4 to 1, then the next three in bit 0 of the first <code>unsigned char</code> and bits 7 to 6 of a new <code>unsigned char</code>. You will have to write code to implement this."}, {"owner": {"reputation": 36328, "user_id": 5483526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec50563f80bacd2a7fed69bd31d0c810?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Timmermans", "link": "https://stackoverflow.com/users/5483526/matt-timmermans"}, "edited": false, "score": 0, "creation_date": 1543412239, "post_id": 53516000, "comment_id": 93910033, "body": "Sorry about all the downvotes.  This is a fine question.  To make a variable that holds a variable number of bits, we just use use the lower bits of one <code>unsigned int</code> to store the bits, and use another <code>unsigned int</code> to remember how many bits we have stored.  When writing out a Huffman-compressed file, we wait until we have at least 8 bits stored.  Then we write out a <code>char</code> using the top 8 bits and subtract 8 from the stored bit count."}, {"owner": {"reputation": 703, "user_id": 9999814, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D0vR5.jpg?s=128&g=1", "display_name": "AmanSharma", "link": "https://stackoverflow.com/users/9999814/amansharma"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1543413936, "post_id": 53516000, "comment_id": 93911153, "body": "@EricPostpischil Thanx for this technique  but if you can proved a link to some code using this technique it would be a great help."}, {"owner": {"reputation": 703, "user_id": 9999814, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D0vR5.jpg?s=128&g=1", "display_name": "AmanSharma", "link": "https://stackoverflow.com/users/9999814/amansharma"}, "reply_to_user": {"reputation": 36328, "user_id": 5483526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec50563f80bacd2a7fed69bd31d0c810?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Timmermans", "link": "https://stackoverflow.com/users/5483526/matt-timmermans"}, "edited": false, "score": 0, "creation_date": 1543413965, "post_id": 53516000, "comment_id": 93911181, "body": "@matttimmermans I thank You Sir for support and i actually couldnt get why people downvoted.Also can you suggest me some code using that technique i would be indebted to You for YOur effort."}, {"owner": {"reputation": 2026, "user_id": 1406083, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1gC8p.jpg?s=128&g=1", "display_name": "Billy Brown", "link": "https://stackoverflow.com/users/1406083/billy-brown"}, "edited": false, "score": 0, "creation_date": 1543415836, "post_id": 53516000, "comment_id": 93912402, "body": "@AmanSharma <a href=\"https://gist.github.com/Druid-of-Luhn/6229cdbbc4bd2bc879a68e615a40ed60\" rel=\"nofollow noreferrer\">here is a gist</a> that will compress an array of bits into <code>char</code>s, and pad the right-hand-side with 0s if the data doesn&#39;t fit cleanly."}], "answers": [{"tags": [], "owner": {"reputation": 36328, "user_id": 5483526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec50563f80bacd2a7fed69bd31d0c810?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Timmermans", "link": "https://stackoverflow.com/users/5483526/matt-timmermans"}, "is_accepted": false, "score": 3, "last_activity_date": 1543420852, "creation_date": 1543420852, "answer_id": 53523505, "question_id": 53516000, "link": "https://stackoverflow.com/questions/53516000/how-to-do-memory-implementation-of-huffman-agorithm/53523505#53523505", "title": "How to do memory implementation of Huffman Agorithm?", "body": "<p>Now that this question is re-opened...</p>\n\n<p>To make a variable that holds a variable number of bits, we just use use the lower bits of one <code>unsigned int</code> to store the bits, and use another <code>unsigned int</code> to remember how many bits we have stored.</p>\n\n<p>When writing out a Huffman-compressed file, we wait until we have at least 8 bits stored. Then we write out a <code>char</code> using the top 8 bits and subtract 8 from the stored bit count.</p>\n\n<p>Finally, at the end if you have any bits left to write out, you round up to an even multiple of 8 and write chars.</p>\n\n<p>In C++, it's useful to encapsulate the output in some kind of <code>BitOutputStream</code> class, like:</p>\n\n<pre><code>class BitOutputStream\n{\n    std::ostream m_out;\n    unsigned m_bitsPending;\n    unsigned m_numPending;\n\n    public:\n    BitOutputStream(const char *fileName)\n        :m_out(... /* you can do this part */)\n    {\n        m_bitsPending = 0;\n        m_numPending = 0;\n    }\n\n    // write out the lower &lt;count&gt; bits of &lt;bits&gt;\n    void write(unsigned bits, unsigned count)\n    {\n       if (count &gt; 16)\n       {\n           //do it in two steps to prevent overflow\n           write(bits&gt;&gt;16, count-16);\n           count=16;\n       }\n       //make space for new bits\n       m_numPending += count;\n       m_bitsPending &lt;&lt;= count;\n\n       //store new bits\n       m_bitsPending |= (bits &amp; ((1&lt;&lt;count)-1));\n\n       //write out any complete bytes\n       while(m_numPending &gt;= 8)\n       {\n           m_numPending-=8;\n           m_out.put((char)(m_bitsPending &gt;&gt; m_numPending));\n       }\n    }\n\n    //write out any remaining bits\n    void flush()\n    {\n        if (m_numPending &gt; 0)\n        {\n            m_out.put((char)(m_bitsPending &lt;&lt; (8-m_numPending)));\n        }\n        m_bitsPending = m_numPending = 0;\n        m_out.flush();\n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 1, "creation_date": 1543425220, "post_id": 53523691, "comment_id": 93918384, "body": "Mixing floating-point into code just to calculate an integer ceiling is not good. It incurs unnecessary costs of conversion to floating-point, floating-point division, and conversion back. Unless there is a danger of overflow, one can simply calculate <code>(code_length + BYTE_SIZE - 1) &#47; BYTE_SIZE</code>, which should compile to an integer add and a shift."}], "tags": [], "owner": {"reputation": 2026, "user_id": 1406083, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1gC8p.jpg?s=128&g=1", "display_name": "Billy Brown", "link": "https://stackoverflow.com/users/1406083/billy-brown"}, "is_accepted": false, "score": 1, "last_activity_date": 1543426695, "last_edit_date": 1543426695, "creation_date": 1543421453, "answer_id": 53523691, "question_id": 53516000, "link": "https://stackoverflow.com/questions/53516000/how-to-do-memory-implementation-of-huffman-agorithm/53523691#53523691", "title": "How to do memory implementation of Huffman Agorithm?", "body": "<p>If your Huffman coder returns an array of 1s and 0s representing the bits that should and should not be set in the output, you can shift these bits onto an <code>unsigned char</code>. Every eight shifts, you start writing to the next character, ultimately outputting an array of <code>unsigned char</code>. The number of these compressed characters that you will output is equal to the number of bits divided by eight, rounded up to the nearest natural number.</p>\n\n<p>In C, this is a relatively simple function, consisting of a left shift (<code>&lt;&lt;</code>) and a bitwise OR (<code>|</code>). Here is the function, with an example to make it runnable. To see it with more extensive comments, please refer to <a href=\"https://gist.github.com/Druid-of-Luhn/6229cdbbc4bd2bc879a68e615a40ed60\" rel=\"nofollow noreferrer\">this GitHub gist</a>.</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n\n#define BYTE_SIZE 8\n\nsize_t compress_code(const int *code, const size_t code_length, unsigned char **compressed)\n{\n    if (code == NULL || code_length == 0 || compressed == NULL) {\n        return 0;\n    }\n    size_t compressed_length = (code_length + BYTE_SIZE - 1) / BYTE_SIZE;\n    *compressed = calloc(compressed_length, sizeof(char));\n    for (size_t char_counter = 0, i = 0; char_counter &lt; compressed_length &amp;&amp; i &lt; code_length; ++i) {\n        if (i &gt; 0 &amp;&amp; (i % BYTE_SIZE) == 0) {\n            ++char_counter;\n        }\n        // Shift the last bit to be set left by one\n        (*compressed)[char_counter] &lt;&lt;= 1;\n        // Put the next bit onto the end of the unsigned char\n        (*compressed)[char_counter] |= (code[i] &amp; 1);\n    }\n    // Pad the remaining space with 0s on the right-hand-side\n    (*compressed)[compressed_length - 1] &lt;&lt;= compressed_length * BYTE_SIZE - code_length;\n    return compressed_length;\n}\n\nint main(void)\n{\n    const int code[] = { 0, 1, 0, 0, 0, 0, 0, 1,   // 65: A\n                         0, 1, 0, 0, 0, 0, 1, 0 }; // 66: B\n    const size_t code_length = 16;\n    unsigned char *compressed = NULL;\n    size_t compressed_length = compress_code(code, code_length, &amp;compressed);\n    for (size_t i = 0; i &lt; compressed_length; ++i) {\n        printf(\"%c\\n\", compressed[i]);\n    }\n    return 0;\n}\n</code></pre>\n\n<p>You can then just write the characters in the array to a file, or even copy the array's memory directly to a file, to write the compressed output.</p>\n\n<p>Reading the compressed characters into bits, which will allow you to traverse your Huffman tree for decoding, is done with right shifts (<code>&gt;&gt;</code>) and checking the rightmost bit with bitwise AND (<code>&amp;</code>).</p>\n"}], "owner": {"reputation": 703, "user_id": 9999814, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D0vR5.jpg?s=128&g=1", "display_name": "AmanSharma", "link": "https://stackoverflow.com/users/9999814/amansharma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 133, "favorite_count": 0, "answer_count": 2, "score": -6, "last_activity_date": 1543446481, "creation_date": 1543396911, "last_edit_date": 1543446481, "question_id": 53516000, "link": "https://stackoverflow.com/questions/53516000/how-to-do-memory-implementation-of-huffman-agorithm", "title": "How to do memory implementation of Huffman Agorithm?", "body": "<p>I have a Huffman code algorithm that compresses characters into sequences of bits of arbitrary length, smaller than the default size of a <code>char</code> (8 bits on most modern platforms)\n<a href=\"https://i.stack.imgur.com/HkzvC.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/HkzvC.png\" alt=\"HuffmanCodes\"></a></p>\n\n<p>If the Huffman Code compresses an 8-bit character into 3 bits, how do I represent that 3-bit value in memory? To take this further, how do I combine multiple compressed characters into a compressed representation?</p>\n\n<p>For example consider <code>l</code> which is \"00000\" (5x8 bits since 0 is also character). How do I represent <code>l</code> with 00000 (5 bits) instead of a character sequence?</p>\n\n<p>A C or C++ implementation is preferred.</p>\n"}, {"tags": ["c", "macros", "compiler-warnings", "pragma", "keil"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1543397530, "post_id": 53515996, "comment_id": 93901206, "body": "Well, then Keil cannot do that."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1543398262, "post_id": 53515996, "comment_id": 93901674, "body": "The whole point of using <code>#pragma</code> is to write <i>non-standard</i>, <i>non-portable</i> things specific to one particular compiler."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1543411444, "post_id": 53515996, "comment_id": 93909516, "body": "<code>#pragma message</code> is not standard. It may be fairly common, but it isn\u2019t formally standardized."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1543422994, "post_id": 53515996, "comment_id": 93917134, "body": "Are you sure <code>#warning</code> (parallel to <code>#error</code>, which is standardized) isn&#39;t more common than <code>#pragma message</code>?"}], "owner": {"reputation": 3, "user_id": 4650459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ab0e89fc6f50ca838796ef4c57dbf93?s=128&d=identicon&r=PG&f=1", "display_name": "user4650459", "link": "https://stackoverflow.com/users/4650459/user4650459"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 110, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1543397496, "creation_date": 1543396902, "last_edit_date": 1543397496, "question_id": 53515996, "link": "https://stackoverflow.com/questions/53515996/keil-armcc-warning-macro", "title": "Keil ARMCC Warning Macro", "body": "<p>I want to write an all inclusive compiler warning message macro. How can you define such a macro to write out a warning given a certain compiler. </p>\n\n<p>The standard for writing warnings is <code>#pragma message \"warning\"</code> which you can define in a macro using _Pragma, but when it comes to something like Keil you have to use <code>#warning</code> and a macro cannot be defined using <code>_Pragma</code> seeing as <code>#pragma</code> will precede the macro argument and Keil does not recognise <code>#prama warning</code>.</p>\n\n<pre><code>#if defined(__GNUC__)\n#define PRAGMA(x) _Pragma(#x)\n#define COMP_MSG(msg)\\\nPRAGMA(message msg)\n#elif defined(__ARMCC_VERSION)\n// need code here\n#endif\n\nCOMP_MSG(\"WARNING\")\n</code></pre>\n"}, {"tags": ["c", "pointers", "data-structures", "queue", "double-pointer"], "answers": [{"tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": true, "score": 1, "last_activity_date": 1543396089, "creation_date": 1543396089, "answer_id": 53515747, "question_id": 53515608, "link": "https://stackoverflow.com/questions/53515608/double-pointers-queue-dequeue-enqueue/53515747#53515747", "title": "Double Pointers Queue, deQueue, enQueue", "body": "<p>the variable <code>rear</code> is a pointer to an <code>int</code>. With <code>*rear</code> you get the value of that <code>int</code>. That value is then used as index.</p>\n\n<p>It's equivalent to e.g.</p>\n\n<pre><code>int index = *rear;\nqueue[index] = new_node;\nindex++;\n*rear = index;\n</code></pre>\n\n<p>It copies the value of the variable <code>new_node</code> (i.e. the address of where the pointer is pointing) into <code>queue[index]</code>. From this point onward, both <code>new_node</code> and <code>queue[index]</code> points to the same thing.</p>\n\n<p>I hope that makes it clearer what's happening.</p>\n"}, {"tags": [], "owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "is_accepted": false, "score": 2, "last_activity_date": 1543396867, "last_edit_date": 1543396867, "creation_date": 1543396452, "answer_id": 53515860, "question_id": 53515608, "link": "https://stackoverflow.com/questions/53515608/double-pointers-queue-dequeue-enqueue/53515860#53515860", "title": "Double Pointers Queue, deQueue, enQueue", "body": "<p>Here <code>queue</code> is pointer to pointer to array of <code>struct Node pointers</code>.</p>\n\n<p>Where each <code>node</code> pointer inside the array will point to NewNodes.</p>\n\n<pre><code>              node 1              node2\n               ^                  ^\n               |       ....       |\n           +--------+---------+--------+\n  queue --&gt;| node * | node *  |node *  |\n           +--------+---------+--------+\n</code></pre>\n\n<p>When you do</p>\n\n<pre><code>       queue[*rear] = new_node; \n</code></pre>\n\n<p>You assign the <code>node *</code> at the <code>*rear</code> position inside the <code>queue</code> array to <code>NewNode</code></p>\n\n<p>Only reason I can think of for maintaining the <code>Node *</code> array is to avoid the copying the content of <code>NewNode</code>.</p>\n"}], "owner": {"reputation": 101, "user_id": 10386511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7833999934c66347d7f3b34cf234df5c?s=128&d=identicon&r=PG&f=1", "display_name": "MangoKitty", "link": "https://stackoverflow.com/users/10386511/mangokitty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 333, "favorite_count": 0, "accepted_answer_id": 53515747, "answer_count": 2, "score": 0, "last_activity_date": 1543396867, "creation_date": 1543395613, "question_id": 53515608, "link": "https://stackoverflow.com/questions/53515608/double-pointers-queue-dequeue-enqueue", "title": "Double Pointers Queue, deQueue, enQueue", "body": "<p>Currently preparing for exams and can't figure out the reasoning behind the queue[rear*] = new_node in this example code.</p>\n\n<p>are you not putting the address of new_node in rather than the value? </p>\n\n<p>Also, is the queue a Node ** queue because it is a pointer to a list of node pointers?</p>\n\n<p>Thanks so much, I really appreciate it, no matter how many hours i spend on double pointers, they always crop up and retest my understanding i thought i finally had!</p>\n\n<pre><code>void enQueue(struct node **queue, int *rear, struct node *new_node) \n{ \nqueue[*rear] = new_node; \n(*rear)++; \n} \n\nstruct node *deQueue(struct node **queue, int *front) \n{ \n(*front)++; \nreturn queue[*front - 1]; \n} \n</code></pre>\n"}, {"tags": ["c", "linux-kernel", "linux-device-driver", "embedded-linux", "i2c"], "comments": [{"owner": {"reputation": 1879, "user_id": 1586929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f75b3597330a3d6854efc6f1578fc595?s=128&d=identicon&r=PG", "display_name": "Krzysztof Adamski", "link": "https://stackoverflow.com/users/1586929/krzysztof-adamski"}, "edited": false, "score": 0, "creation_date": 1543425784, "post_id": 53515362, "comment_id": 93918737, "body": "Can you check your logs for non working case and grep it for informations from driver &quot;at24&quot;?"}, {"owner": {"reputation": 21, "user_id": 7442287, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211146775695871/picture?type=large", "display_name": "rozmanro", "link": "https://stackoverflow.com/users/7442287/rozmanro"}, "reply_to_user": {"reputation": 1879, "user_id": 1586929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f75b3597330a3d6854efc6f1578fc595?s=128&d=identicon&r=PG", "display_name": "Krzysztof Adamski", "link": "https://stackoverflow.com/users/1586929/krzysztof-adamski"}, "edited": false, "score": 0, "creation_date": 1543474265, "post_id": 53515362, "comment_id": 93934361, "body": "The only thing that is printed is the 1-0052 device that was scanned and added by the i2c. As my scrennshot of &quot;kernel prints on startup the i2c device scan result:&quot; shows just without the needed 1-0050 line..."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 1, "creation_date": 1543599850, "post_id": 53515362, "comment_id": 93990466, "body": "I think the probe function (<code>at24_probe</code> in &quot;drivers/misc/eeprom/at24.c&quot; is being called because the device is listed in the device tree. But <code>at24_probe</code> tests whether the EEPROM is actually present on the I2C bus and returns a <code>-ENODEV</code> error if it is not detected. If some operating system trigger (e.g. in UDEV) occurs when you insert the SFP module, you could use that to load a device tree overlay containing the EEPROM device."}, {"owner": {"reputation": 3561, "user_id": 2511795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30c869f55cbcf82a7bc4536d563daa0a?s=128&d=identicon&r=PG", "display_name": "0andriy", "link": "https://stackoverflow.com/users/2511795/0andriy"}, "edited": false, "score": 1, "creation_date": 1543656606, "post_id": 53515362, "comment_id": 94003793, "body": "I2C is not a hotpluggable bus. Though you may try Device Tree overlay technique or reprobe  manually via <i>bind</i> file in sysfs."}], "answers": [{"comments": [{"owner": {"reputation": 3561, "user_id": 2511795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30c869f55cbcf82a7bc4536d563daa0a?s=128&d=identicon&r=PG", "display_name": "0andriy", "link": "https://stackoverflow.com/users/2511795/0andriy"}, "edited": false, "score": 0, "creation_date": 1543656671, "post_id": 53539018, "comment_id": 94003802, "body": "It quite unlikely will reprobe device."}], "tags": [], "owner": {"reputation": 21, "user_id": 7442287, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211146775695871/picture?type=large", "display_name": "rozmanro", "link": "https://stackoverflow.com/users/7442287/rozmanro"}, "is_accepted": false, "score": 0, "last_activity_date": 1543494263, "creation_date": 1543494263, "answer_id": 53539018, "question_id": 53515362, "link": "https://stackoverflow.com/questions/53515362/i2c-eeprom-file-missing-in-user-space-sfp-module/53539018#53539018", "title": "I2c eeprom file missing in user-space - SFP module", "body": "<p>A possible workaround for this issue was found.</p>\n\n<p>to use the <strong>ethtool -m</strong> interface.</p>\n\n<p>from ethtool man page:</p>\n\n<p>-m --dump-module-eeprom\nRetrieves and if possible decodes the EEPROM from plugin modules, e.g SFP+, QSFP</p>\n"}], "owner": {"reputation": 21, "user_id": 7442287, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211146775695871/picture?type=large", "display_name": "rozmanro", "link": "https://stackoverflow.com/users/7442287/rozmanro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 888, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1543494263, "creation_date": 1543394713, "last_edit_date": 1592644375, "question_id": 53515362, "link": "https://stackoverflow.com/questions/53515362/i2c-eeprom-file-missing-in-user-space-sfp-module", "title": "I2c eeprom file missing in user-space - SFP module", "body": "<p>I have some linux kernel &amp; SFP/I2C driver issue.</p>\n<p>I am using a buildroot linux kernel for an embedded board.</p>\n<p><strong>I need to be able to read the eeprom file of the SFP i2c device.</strong></p>\n<p><strong>1. working case:</strong></p>\n<p>When SFP module is inserted in my development unit board from the start (before the kernel loads up) then when startup completed i can see and read the eeprom file in the path: /sys/class/i2c-adapter/i2c-1/1-0050/eeprom</p>\n<p><a href=\"https://i.stack.imgur.com/IXg5S.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/IXg5S.png\" alt=\"eeprom file exists\" /></a></p>\n<ul>\n<li>kernel prints on startup the i2c device scan result:</li>\n</ul>\n<p><a href=\"https://i.stack.imgur.com/ThXxW.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ThXxW.png\" alt=\"enter image description here\" /></a></p>\n<p><strong>2. not working case:</strong></p>\n<p>If there is no SFP module inserted on startup,and kernel completes the boot procces, then when i'm inserting the SFP module in,i observe that the path:</p>\n<p>/sys/class/i2c-adapter/i2c-1/1-0050/ <strong>DOESN'T include the eeprom file.</strong></p>\n<p><a href=\"https://i.stack.imgur.com/e0x8q.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/e0x8q.png\" alt=\"eeprom file missing\" /></a></p>\n<ul>\n<li>The device tree part of the sfp-eeprom code:</li>\n</ul>\n<p><a href=\"https://i.stack.imgur.com/yNfmY.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/yNfmY.png\" alt=\"enter image description here\" /></a></p>\n<p>My guess is the SFP driver is responsible for that trigger that should happen once the SFP module is inserted, and should trigger the creation of eeprom file.</p>\n<p>Would like to ask you what am i missing ?\nsome binding code from sfp driver to trigger the i2c scan or something?</p>\n<p>Any suggestion?</p>\n<p>Thanks in advance.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 2, "creation_date": 1543394709, "post_id": 53515337, "comment_id": 93899560, "body": "<code>mtrand32.h</code> is not standard C header. You probably need to install a library for this. Or some embedded compiler tool chain. Where did you get this code?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1543394771, "post_id": 53515337, "comment_id": 93899598, "body": "For future questions, please read about <a href=\"http://stackoverflow.com/help/how-to-ask\">how to ask good questions</a>, as well as <a href=\"https://codeblog.jonskeet.uk/2012/11/24/stack-overflow-question-checklist/\" rel=\"nofollow noreferrer\">this question checklist</a>. Lastly learn how to create a <a href=\"https://stackoverflow.com/help/mcve\"><b><i>Minimal</i></b>, Complete, and Verifiable Example</a>."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "reply_to_user": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1543394773, "post_id": 53515337, "comment_id": 93899599, "body": "<code>mtrand32.h</code> very likely stands for 32-bit Mersenne Twister random number generator. And as @Gerhardh said."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1543394794, "post_id": 53515337, "comment_id": 93899613, "body": "Your code is way too long. For a minimum example you only need the <code>#include</code> and a variable definition of the affected types."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 1, "creation_date": 1543394883, "post_id": 53515337, "comment_id": 93899674, "body": "You should also decide what language you want to use. If it is C, don&#39;t put it in an .cpp file. If you compile a .cpp file, your compiler will treat is as C++ which is a very different language."}], "owner": {"reputation": 1, "user_id": 10715813, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-TbPBTjeWsCE/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-h0gMy2baPYSZpyiIoaQGmyDPHvrA/mo/photo.jpg?sz=128", "display_name": "Salmaan Ali", "link": "https://stackoverflow.com/users/10715813/salmaan-ali"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1543401994, "creation_date": 1543394609, "last_edit_date": 1543401994, "question_id": 53515337, "link": "https://stackoverflow.com/questions/53515337/cant-seem-to-figure-out-this-header-file-mtrand32-h", "title": "cant seem to figure out this header file mtrand32.h", "body": "<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdint.h&gt;\n#include &lt;time.h&gt;\n#include &lt;mtrand32.h&gt;\n\n#define OPERATOR_ADD '+'\n#define OPERATOR_SUBTRACT '-'\n#define OPERATOR_MULTIPLY '*'\n#define OPERATOR_DIVIDE '/'\n#define WORD_BITS 32U\n#define STREAMS_N 4U\n\ntypedef struct\n{\n    unsigned int *words;\n    unsigned int ones;\n}\n\nstream_t;\n\nint random_bit(unsigned int, unsigned int, stream_t *, unsigned int, \nunsigned int);\nvoid add_one(stream_t *, unsigned int, unsigned int);\nvoid print_stream(int, stream_t *, unsigned int, int);\nvoid next_bit(unsigned int, unsigned int *, unsigned int *);\n\nint main(void)\n{\n    unsigned int w_bits, a_ones, b_ones, oper, s_ones, stream_words_n, \n    *words, stream_idx, q, word_idx, weight, bit;\n    stream_t *streams;\n    if (scanf(\"%u\", &amp;w_bits) != 1 || w_bits &lt; 1)\n    {\n        fprintf(stderr, \"Invalid w_bits\\n\");\n        fflush(stderr);\n        return EXIT_FAILURE;\n    }\n    if (scanf(\"%u\", &amp;a_ones) != 1 || a_ones &gt; w_bits)\n    {\n        fprintf(stderr, \"Invalid a_ones\\n\");\n        fflush(stderr);\n        return EXIT_FAILURE;\n    }\n    if (scanf(\"%u\", &amp;b_ones) != 1 || b_ones &gt; w_bits)\n    {\n        fprintf(stderr, \"Invalid b_ones\\n\");\n        fflush(stderr);\n        return EXIT_FAILURE;\n    }\n    getchar();\n    oper = getchar();\n    switch (oper)\n    {\n         case OPERATOR_ADD:\n         case OPERATOR_SUBTRACT:\n         case OPERATOR_MULTIPLY:\n         case OPERATOR_DIVIDE:\n         break;\n         default:\n         fprintf(stderr, \"Invalid operator\\n\");\n         fflush(stderr);\n         return EXIT_FAILURE;\n   }\n   s_ones = w_bits/2;\n   stream_words_n = (w_bits-1)/WORD_BITS+1;\n   words = (unsigned int*)calloc(stream_words_n*STREAMS_N, sizeof(unsigned \n   int));\n   if (!words) {\n      fprintf(stderr, \"Could not allocate memory for words\\n\");\n      fflush(stderr);\n      return EXIT_FAILURE;\n   }\n   streams = (stream_t*)malloc(sizeof(stream_t)*STREAMS_N);\n   if (!streams) {\n      fprintf(stderr, \"Could not allocate memory for streams\\n\");\n      fflush(stderr);\n      free(words);\n      return EXIT_FAILURE;\n   }\n   for (stream_idx = 0; stream_idx &lt; STREAMS_N; stream_idx++) {\n      streams[stream_idx].words = words+stream_words_n*stream_idx;\n      streams[stream_idx].ones = 0;\n  }\n  smtrand32((unsigned int)time(NULL));\n  q = 0;\n  word_idx = 0;\n  weight = 1;\n  for (bit = 0; bit &lt; w_bits; bit++) {\n     int bit_a = random_bit(w_bits, a_ones, streams, word_idx, weight), \n     bit_b = random_bit(w_bits, b_ones, streams+1U, word_idx, weight);\n     switch (oper) {\n        int bit_s;\n        case OPERATOR_ADD:\n        bit_s = random_bit(w_bits, s_ones, streams+2, word_idx, weight);\n        if ((bit_a &amp;&amp; bit_s) || (bit_b &amp;&amp; !bit_s)) {\n            add_one(streams+3, word_idx, weight);\n        }\n        break;\n        case OPERATOR_SUBTRACT:\n        bit_s = random_bit(w_bits, s_ones, streams+2, word_idx, weight);\n        if ((bit_a &amp;&amp; bit_s) || (!bit_b &amp;&amp; !bit_s)) {\n            add_one(streams+3, word_idx, weight);\n        }\n        break;\n        case OPERATOR_MULTIPLY:\n        if (bit_a &amp;&amp; bit_b) {\n            add_one(streams+3, word_idx, weight);\n        }\n        break;\n        case OPERATOR_DIVIDE:\n        if (bit_a) {\n            if (bit_b) {\n                q = !q;\n                if (q) {\n                    add_one(streams+3, word_idx, weight);\n                }\n            }\n            else {\n                q = 1;\n                add_one(streams+3, word_idx, weight);\n            }\n        }\n        else\n        {\n            if (bit_b)\n            {\n                q = 0;\n            }\n            else {\n                if (q)\n                {\n                    add_one(streams+3, word_idx, weight);\n                }\n            }\n        }\n        break;\n        default:\n        break;\n    }\n    next_bit(bit, &amp;word_idx, &amp;weight);\n}\nif (oper == OPERATOR_ADD || oper == OPERATOR_SUBTRACT) {\n    print_stream('a', streams, w_bits, 1);\n    print_stream('b', streams+1, w_bits, 1);\n    print_stream('s', streams+2, w_bits, 0);\n    print_stream('y', streams+3, w_bits, 1);\n}\nelse {\n    print_stream('a', streams, w_bits, 0);\n    print_stream('b', streams+1, w_bits, 0);\n    print_stream('y', streams+3, w_bits, 0);\n}\nfflush(stdout);\nfree(streams);\nfree(words);\nreturn EXIT_SUCCESS;\n}\n\nint random_bit(unsigned int w_bits, unsigned int x_ones, stream_t *stream, \nunsigned int word_idx, unsigned int weight)\n{\n    if ((unsigned int)(mtrand32()/(UINT32_MAX+1.0)*w_bits) &lt; x_ones)\n    {\n        add_one(stream, word_idx, weight);\n        return 1;\n    }\n    return 0;\n}\n\nvoid add_one(stream_t *stream, unsigned int word_idx, unsigned int weight)\n{\n     stream-&gt;words[word_idx] += weight;\n     stream-&gt;ones++;\n}\n\n void print_stream(int symbol, stream_t *stream, unsigned int w_bits, int \n bipolar)\n {\n      unsigned int word_idx, weight, bit;\n       printf(\"%c = \", symbol);\n       word_idx = 0;\n        weight = 1;\n       for (bit = 0; bit &lt; w_bits; bit++)\n      {\n           if (stream-&gt;words[word_idx] &amp; weight)\n           {\n                  putchar('1');\n           }\n           else\n           {\n                  putchar('0');\n           }\n           next_bit(bit, &amp;word_idx, &amp;weight);\n      }\n      printf(\" (\");\n      if (bipolar)\n      {\n              printf(\"%d\", (int32_t)stream-&gt;ones*2-(int32_t)w_bits);\n       }\n      else\n      {\n           printf(\"%u\", stream-&gt;ones);\n       }\n      printf(\"/%u)\\n\", w_bits);\n }\n\n  void next_bit(unsigned int bit, unsigned int *word, unsigned int *weight)\n {\n      if (bit%WORD_BITS == WORD_BITS-1)\n     {\n            *word += 1;\n            *weight = 1;\n     }\n     else\n     {\n              *weight *= 2;\n     }\n }\n</code></pre>\n\n<p><strong>There are the errors that i am facing :</strong> </p>\n\n<blockquote>\n  <p>[Error] G:\\Stochastic Computing Machine\\Stochastic.cpp:5:22:\n  mtrand32.h: No such file or directory</p>\n  \n  <p>[Error] G:\\Stochastic Computing Machine\\Stochastic.cpp:82: error:\n  `smtrand32' was not declared in this scope</p>\n  \n  <p>[Error] G:\\Stochastic Computing Machine\\Stochastic.cpp:158: error:\n  `mtrand32' was not declared in this scope</p>\n  \n  <p>[Error] G:\\Stochastic Computing Machine\\Stochastic.cpp:158: error:\n  `UINT32_MAX' was not declared in this scope</p>\n</blockquote>\n\n<p>i searched for <code>mtrand32.h</code> but couldn't find it</p>\n"}, {"tags": ["c", "windows", "visual-studio-code", "windows-subsystem-for-linux"], "comments": [{"owner": {"reputation": 1911, "user_id": 8928481, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/orscP.png?s=128&g=1", "display_name": "Biswapriyo", "link": "https://stackoverflow.com/users/8928481/biswapriyo"}, "edited": false, "score": 0, "creation_date": 1543410452, "post_id": 53515291, "comment_id": 93908915, "body": "Need some modification before using."}], "answers": [{"tags": [], "owner": {"reputation": 136, "user_id": 13687805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c719059606b69c7a947e75e624a782f?s=128&d=identicon&r=PG&f=1", "display_name": "Ozicom23", "link": "https://stackoverflow.com/users/13687805/ozicom23"}, "is_accepted": true, "score": 1, "last_activity_date": 1591432450, "creation_date": 1591432450, "answer_id": 62229262, "question_id": 53515291, "link": "https://stackoverflow.com/questions/53515291/linux-native-c-libraries-how-to-configure-visual-studio-code-to-work-with-them/62229262#62229262", "title": "Linux-native C libraries: How to configure Visual Studio Code to work with them on Windows?", "body": "<blockquote>\n  <p>But I wonder does the Windows Subsystem for Linux come with those\n  libraries?</p>\n</blockquote>\n\n<p>Yes compiler in WSL will contain these headers.</p>\n\n<blockquote>\n  <p>If so, how do I configure Visual Studio Code work with WSL?</p>\n</blockquote>\n\n<p>You need to enable WSL in Windows features, install linux distro you like via Microsoft Store, install \"Remote - WSL\" extension in VS Code.\nMore information can be found here: <a href=\"https://code.visualstudio.com/docs/remote/wsl\" rel=\"nofollow noreferrer\">https://code.visualstudio.com/docs/remote/wsl</a></p>\n\n<p>Keep in mind though, that applications that you will compile in this setup will be linux applications. They will only be able to operate under linux or WSL.\nThere is no way you can compile applications using these libs for Windows. These libs are platform depended.</p>\n"}], "owner": {"reputation": 69, "user_id": 5579667, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18bb77d00b8aefea916dc354567cb55?s=128&d=identicon&r=PG&f=1", "display_name": "karmstr7", "link": "https://stackoverflow.com/users/5579667/karmstr7"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 1, "accepted_answer_id": 62229262, "answer_count": 1, "score": 3, "last_activity_date": 1591432450, "creation_date": 1543394466, "question_id": 53515291, "link": "https://stackoverflow.com/questions/53515291/linux-native-c-libraries-how-to-configure-visual-studio-code-to-work-with-them", "title": "Linux-native C libraries: How to configure Visual Studio Code to work with them on Windows?", "body": "<p>total noob here.</p>\n\n<p>There are a few a few C libraries I would like to use, like unistd.h and sys/time.h, in a Windows machine. I have found many threads discussing is it simply not possible without using alternative packages. But I wonder does the Windows Subsystem for Linux come with those libraries? If so, how do I configure Visual Studio Code work with WSL?</p>\n"}, {"tags": ["c", "temporary-files", "temporary"], "comments": [{"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 3, "creation_date": 1543394886, "post_id": 53515274, "comment_id": 93899676, "body": "You are basically saying that you believe a temporary file is not a real file, but something else. Why do you think that?"}, {"owner": {"reputation": 11, "user_id": 10557508, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-oGxzbgaGj6c/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbCqDgE4uQl0qS147hCxKsl716z0-w/mo/photo.jpg?sz=128", "display_name": "Cha", "link": "https://stackoverflow.com/users/10557508/cha"}, "reply_to_user": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 0, "creation_date": 1543409913, "post_id": 53515274, "comment_id": 93908591, "body": "OK I know what you mean. thanks"}], "answers": [{"tags": [], "owner": {"reputation": 6578, "user_id": 10524386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe8a1950a1d7e1eccd4cff228c5420ea?s=128&d=identicon&r=PG", "display_name": "grapes", "link": "https://stackoverflow.com/users/10524386/grapes"}, "is_accepted": false, "score": 2, "last_activity_date": 1543394801, "creation_date": 1543394801, "answer_id": 53515389, "question_id": 53515274, "link": "https://stackoverflow.com/questions/53515274/how-many-temporary-files-can-i-open-simultaneously-in-c-program/53515389#53515389", "title": "How many temporary files can I open simultaneously in C program?", "body": "<p>It is not written explicitly, but it seems the limitation is the same, no matter if file is temporary or not.</p>\n\n<p><a href=\"https://www.opennet.ru/man.shtml?topic=tmpfile&amp;category=3&amp;russian=5\" rel=\"nofollow noreferrer\">https://www.opennet.ru/man.shtml?topic=tmpfile&amp;category=3&amp;russian=5</a></p>\n\n<p>See error code for <code>tmpfile()</code>:</p>\n\n<pre><code>EMFILE\n{FOPEN_MAX} streams are currently open in the calling process.\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10557508, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-oGxzbgaGj6c/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbCqDgE4uQl0qS147hCxKsl716z0-w/mo/photo.jpg?sz=128", "display_name": "Cha", "link": "https://stackoverflow.com/users/10557508/cha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1543394801, "creation_date": 1543394403, "question_id": 53515274, "link": "https://stackoverflow.com/questions/53515274/how-many-temporary-files-can-i-open-simultaneously-in-c-program", "title": "How many temporary files can I open simultaneously in C program?", "body": "<p>I have one question of temporary file open in C program.</p>\n\n<p>I know there is FOPEN_MAX in stdio.h. As far as I know, FOPEN_MAX is the number of files(not temporary) can be opened simultaneously in C program. But, If I make temporary file using 'tmpfile()', does the number of temporary files included in FOPEN_MAX ?</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["c", "permission-denied", "pam", "setuid"], "comments": [{"owner": {"reputation": 2222, "user_id": 1640308, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/0BoKw.png?s=128&g=1", "display_name": "arash kordi", "link": "https://stackoverflow.com/users/1640308/arash-kordi"}, "edited": false, "score": 0, "creation_date": 1543399071, "post_id": 53515251, "comment_id": 93902189, "body": "looks like some security module doesnt like your program, check systemd logs"}, {"owner": {"reputation": 11, "user_id": 10715804, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7ce58153fe20197ebde0445b92191dd?s=128&d=identicon&r=PG&f=1", "display_name": "Christoph", "link": "https://stackoverflow.com/users/10715804/christoph"}, "reply_to_user": {"reputation": 2222, "user_id": 1640308, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/0BoKw.png?s=128&g=1", "display_name": "arash kordi", "link": "https://stackoverflow.com/users/1640308/arash-kordi"}, "edited": false, "score": 0, "creation_date": 1543406530, "post_id": 53515251, "comment_id": 93906558, "body": "@arash kordi: Do you mean something like SELinux or AppArmor? I had apparmor enabled before, but when first the problems with my program occurred, I disabled it - did not help."}], "owner": {"reputation": 11, "user_id": 10715804, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7ce58153fe20197ebde0445b92191dd?s=128&d=identicon&r=PG&f=1", "display_name": "Christoph", "link": "https://stackoverflow.com/users/10715804/christoph"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 196, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1543394338, "creation_date": 1543394338, "question_id": 53515251, "link": "https://stackoverflow.com/questions/53515251/permission-problems-in-setuid-root-program", "title": "Permission problems in setuid-root program", "body": "<p>I have written a program, compiled it, copied it to /usr/local/bin/ and gave it setuid-root file permission.</p>\n\n<p>Unfortunately, I cannot get the program to run as desired because of permission problems - that is, it runs well when I call it as a non-privileged user from the command line, but it throws errors when I call it as a non-privileged user from PAM module pam_exec - and that is the how I want to use it in the end. </p>\n\n<p>So far, I had the following differences between calling it from the command line and calling it from pam_exec:</p>\n\n<ol>\n<li><p>When I do not give the setuid-root file permission to the program, but give it the Linux cap_setuid capability instead, that works from the command line, but with pam_exec the program is not run at all, with error \"Operation not permitted\".</p></li>\n<li><p>For further execution of the program, not only the effective, but also the real UID hast to be 0. From the command line, this works when I use setuid(0) in the program code, but with pam_exec, setuid(0) fails to change the real UID and I have to use setreuid(0,0) instead.</p></li>\n<li><p>Though real and effective UID are 0, I still get errors like \"Permission denied\" and \"Operation not permitted\" when the program is called from pam_exec. First, this happened when executing external command lvcreate from my setuid-root program, and after I solved that now by using lvm dbus library calls instead, I even get an \"Operation not permitted\" when doing a simple chown() on a directory in the local filesystem. Of course, this all works perfectly when I start my program from the command line.</p></li>\n</ol>\n\n<p>Any idea about possible reasons why a program with setuid-root file permission (or a program with special Linux capabilities), when it is called by an unprivileged user from PAM module pam_exec, behaves very different from when it is called by an unprivileged user from the command line? Or how it is possible at all that \"Operation not permitted\" and \"Permission denied\" errors occur though both getuid() and geteuid() return 0?</p>\n\n<p>Regards\n  Christoph</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1543392917, "post_id": 53514870, "comment_id": 93898664, "body": "Assigning a new value to a function&#39;s parameter has no effect outside of that function. (What do you expect to happen if you call <code>get(ComputerNameDnsHostname, 0)</code>? Would the value of <code>0</code> change?)"}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 2, "creation_date": 1543392967, "post_id": 53514870, "comment_id": 93898678, "body": "There can&#39;t be a race condition with synchronous calls in a single-threaded program."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1543393049, "post_id": 53514870, "comment_id": 93898720, "body": "Look at the signature of <code>realloc</code> closely. Note how it returns a new pointer. Have you ever wondered why it&#39;s needed?"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "reply_to_user": {"reputation": 2055, "user_id": 6564148, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u3HL5.png?s=128&g=1", "display_name": "George", "link": "https://stackoverflow.com/users/6564148/george"}, "edited": false, "score": 0, "creation_date": 1543393433, "post_id": 53514870, "comment_id": 93898893, "body": "@George &quot;<i>The length of the name may be greater than <code>MAX_COMPUTERNAME_LENGTH</code> characters because DNS allows longer names. To ensure that this buffer is large enough, set this parameter to <code>NULL</code> and use the required buffer size returned in the <code>lpnSize</code> parameter.</i>&quot;"}, {"owner": {"reputation": 121, "user_id": 7741979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0630bd102880a29245667370b78c0188?s=128&d=identicon&r=PG&f=1", "display_name": "sangho", "link": "https://stackoverflow.com/users/7741979/sangho"}, "edited": false, "score": 0, "creation_date": 1543394948, "post_id": 53514870, "comment_id": 93899712, "body": "is second GetComputerNameExW function and realloc For Exception Handling? example memory leak or don&#39;t believe win api.. I don&#39;t understand"}], "answers": [{"comments": [{"owner": {"reputation": 113, "user_id": 8807932, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9858abf46f35cb7cb47666ab28c4feb4?s=128&d=identicon&r=PG&f=1", "display_name": "MadsRC", "link": "https://stackoverflow.com/users/8807932/madsrc"}, "edited": false, "score": 0, "creation_date": 1543394355, "post_id": 53514928, "comment_id": 93899354, "body": "So when passing in WCHAR* t as WCHAR* c in get, I&#39;m just passing in the address of t as c and then later replacing said address with the address of WCHAR* tmp (Which, now that I think of it, I know...)  So using a pointer to a pointer would fix it, as I&#39;d just replace the second-level pointer that the first-level pointer points to... I could live with that..."}, {"owner": {"reputation": 6751, "user_id": 1417063, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Mwy5e.jpg?s=128&g=1", "display_name": "Davide Spataro", "link": "https://stackoverflow.com/users/1417063/davide-spataro"}, "reply_to_user": {"reputation": 113, "user_id": 8807932, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9858abf46f35cb7cb47666ab28c4feb4?s=128&d=identicon&r=PG&f=1", "display_name": "MadsRC", "link": "https://stackoverflow.com/users/8807932/madsrc"}, "edited": false, "score": 1, "creation_date": 1543394424, "post_id": 53514928, "comment_id": 93899399, "body": "Correct, but <code>t</code> itself is never modified."}], "tags": [], "owner": {"reputation": 6751, "user_id": 1417063, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Mwy5e.jpg?s=128&g=1", "display_name": "Davide Spataro", "link": "https://stackoverflow.com/users/1417063/davide-spataro"}, "is_accepted": true, "score": 1, "last_activity_date": 1543393051, "creation_date": 1543393051, "answer_id": 53514928, "question_id": 53514870, "link": "https://stackoverflow.com/questions/53514870/reassigning-output-pointer-in-function/53514928#53514928", "title": "Reassigning output pointer in function", "body": "<p>You are simply modifying the parameter copy of main's <code>t</code> pointer within the <code>get(COMPUTER_NAME_FORMAT f, WCHAR* c)</code> function.</p>\n\n<p>The effect is not propagated outside <code>get</code>.\nYou are assigning the value of tmp to a temporary pointer that is lost after <code>get</code> returns.</p>\n\n<p>Pass <code>c</code> as <code>WCHAR** c</code> in <code>get</code> as follows:</p>\n\n<pre><code>BOOL get(COMPUTER_NAME_FORMAT f, WCHAR** c){\n  //stuff\n  tmp = (WCHAR*)realloc(tmp, sizeof(WCHAR) * s);\n  *c=tmp;\n  //other stuff\n}\n</code></pre>\n"}], "owner": {"reputation": 113, "user_id": 8807932, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9858abf46f35cb7cb47666ab28c4feb4?s=128&d=identicon&r=PG&f=1", "display_name": "MadsRC", "link": "https://stackoverflow.com/users/8807932/madsrc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "closed_date": 1543393017, "accepted_answer_id": 53514928, "answer_count": 1, "score": 0, "last_activity_date": 1543393051, "creation_date": 1543392774, "question_id": 53514870, "link": "https://stackoverflow.com/questions/53514870/reassigning-output-pointer-in-function", "closed_reason": "Duplicate", "title": "Reassigning output pointer in function", "body": "<p>I'm wondering why, when I run the following code, the value of <code>t</code> is the same after the call to <code>get</code> as it was before.</p>\n\n<p>I have a feeling that the issue is the reassignment in line 11, at <code>c = tmp</code> - But hopefully someone can point me in the right direction?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;tchar.h&gt;\n#include &lt;windows.h&gt;\n\nBOOL get(COMPUTER_NAME_FORMAT f, WCHAR* c) {\n    DWORD s = 0;\n    WCHAR* tmp = NULL;\n    GetComputerNameExW(f, tmp, &amp;s);\n    tmp = (WCHAR*)realloc(tmp, sizeof(WCHAR) * s);\n    GetComputerNameExW(f, tmp, &amp;s);\n    c = tmp;\n    return TRUE;\n}\n\nvoid _tmain(int argc, _TCHAR* argv[])\n{\n\n    WCHAR* t = TEXT(\"thisisatest\");\n    BOOL res = get(ComputerNameDnsHostname, t);\n    printf(\"%Ls\\n\", t);\n}\n</code></pre>\n\n<p>The above code have, for the sake of brevity, been stripped of error handling code. Also, I suspect there's a race condition between the 2 calls to GetComputerNameExW().</p>\n"}, {"tags": ["c", "string", "character", "non-repetitive"], "comments": [{"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1543391329, "post_id": 53514453, "comment_id": 93897954, "body": "you&#39;ve got it backwards. <i>when</i> reversing the string, check if the character is already in the reversed, and if it is, don&#39;t add it there."}], "answers": [{"tags": [], "owner": {"reputation": 165, "user_id": 10569552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a19bab13980743df8c0947d5969894d?s=128&d=identicon&r=PG&f=1", "display_name": "anand", "link": "https://stackoverflow.com/users/10569552/anand"}, "is_accepted": false, "score": 0, "last_activity_date": 1543395083, "creation_date": 1543395083, "answer_id": 53515460, "question_id": 53514453, "link": "https://stackoverflow.com/questions/53514453/how-to-remove-duplicate-characters-that-repeats-many-times-at-the-end-of-a-strin/53515460#53515460", "title": "How to remove duplicate characters that repeats many times at the end of a string in C language?", "body": "<p>In below line, k will stay at end to same character twice. if k is 4 and end is 5 both 4th and 5th characters will be same. One problem is when k is at null character, k + 1 will overwrite null character.</p>\n\n<pre><code> reverse_string[k] = reverse_string[k + 1];\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 4031464, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Vrabii Daniel", "link": "https://stackoverflow.com/users/4031464/vrabii-daniel"}, "edited": false, "score": 0, "creation_date": 1543396971, "post_id": 53515941, "comment_id": 93900878, "body": "Thank you very much, that is really helpful."}], "tags": [], "owner": {"reputation": 162, "user_id": 10395587, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2b548dbfa2977701ebe0b35d9ed8207?s=128&d=identicon&r=PG&f=1", "display_name": "manoliar", "link": "https://stackoverflow.com/users/10395587/manoliar"}, "is_accepted": true, "score": 0, "last_activity_date": 1543396701, "creation_date": 1543396701, "answer_id": 53515941, "question_id": 53514453, "link": "https://stackoverflow.com/questions/53514453/how-to-remove-duplicate-characters-that-repeats-many-times-at-the-end-of-a-strin/53515941#53515941", "title": "How to remove duplicate characters that repeats many times at the end of a string in C language?", "body": "<p>Here is your code.\nThe main problem was the j++. You must stay in the same j until reverse_string[j] != reverse_string[i].\nThe second problem was that you did not terminated the string.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\nint main()\n{\nchar word[20];\nchar reverse_string[20];\nprintf(\"type a string: \");\nscanf(\"%s\", word);\n\nfor(int i = strlen(word)-1; i&gt;=0; i--)\n{\n    // 5 - 5 = 0\n    // 5- 4 = 1\n    // 5- 3 = 2\n    // 5- 2 = 3\n    // 5- 1 = 4\n    // 5- 0 = 5\n    reverse_string[(strlen(word)-1)-i] = word[i];\n  }\n  reverse_string[strlen(word)] = '\\0'; //add string termination\n  printf(\"%s\\n\",reverse_string);\n\n\n for(int i = 0; i&lt; strlen(reverse_string)-1;i++)\n {\n    for(int j = i+1; reverse_string[j] != '\\0';) //j++ was moved. \n    {\n        if(reverse_string[j] == reverse_string[i])\n        {\n\n            for(int k = j; reverse_string[k] != '\\0'; k++)\n            {\n                //printf(\"%c\\n\", reverse_string[k+1]);\n                reverse_string[k] = reverse_string[k + 1];\n            }\n\n        }\n        else\n            j++; //j++ was moved here \n    }\n  }\n   printf(\"%s\\n\", reverse_string);\n\nreturn 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 4031464, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Vrabii Daniel", "link": "https://stackoverflow.com/users/4031464/vrabii-daniel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 53515941, "answer_count": 2, "score": -1, "last_activity_date": 1543405158, "creation_date": 1543391010, "last_edit_date": 1543405158, "question_id": 53514453, "link": "https://stackoverflow.com/questions/53514453/how-to-remove-duplicate-characters-that-repeats-many-times-at-the-end-of-a-strin", "title": "How to remove duplicate characters that repeats many times at the end of a string in C language?", "body": "<p>I am trying to learn how to work with strings in C and I have this problem, I need to reverse a string and print it without any repetitive characters. I have tried the code below and it worked but if I add many repetitive characters of the same type it does not work. </p>\n\n<p>For example: <strong>dodon - nodod - nod</strong> but with the string <strong>dodoneeee - eeeenodod - eenod</strong>. The <strong>e</strong> is still repeated.</p>\n\n<p>The code is below:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\nint main(){\nchar word[20];\nchar reverse_string[20];\nprintf(\"type a string: \");\nscanf(\"\\n%s\", word);       \nfor(int i = strlen(word)-1; i&gt;=0; i--)\n{\n    // 5 - 5 = 0\n    // 5- 4 = 1\n    // 5- 3 = 2\n    // 5- 2 = 3\n    // 5- 1 = 4\n    // 5- 0 = 5\n    reverse_string[(strlen(word)-1)-i] = word[i];         \n  }\n  printf(\"%s\\n\",reverse_string);     \n for(int i = 0; i&lt; strlen(reverse_string)-1;i++)\n {\n    for(int j = i+1; reverse_string[j] != '\\0';j++)\n    {\n        if(reverse_string[j] == reverse_string[i])\n        {\n            for(int k = j; reverse_string[k] != '\\0'; k++)\n            {\n                //printf(\"%c\\n\", reverse_string[k+1]);\n                reverse_string[k] = reverse_string[k + 1];\n            }                \n        }           \n    }        \n  }\n   printf(\"%s\\n\", reverse_string);    \nreturn 0;\n}\n</code></pre>\n"}, {"tags": ["c", "linux-kernel", "scheduling", "preemption"], "owner": {"reputation": 53, "user_id": 2818825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3e2cd19e18288d184179d456e7eac63?s=128&d=identicon&r=PG&f=1", "display_name": "user2818825", "link": "https://stackoverflow.com/users/2818825/user2818825"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1543413731, "creation_date": 1543389428, "last_edit_date": 1543413731, "question_id": 53514056, "link": "https://stackoverflow.com/questions/53514056/undesired-latency-when-kernel-thread-does-more-communication-work", "title": "Undesired latency when kernel thread does more communication work", "body": "<p>We have developed a kernel module that acts basically like a wired communication traffic (eth, ...) - WiFi bridge. It forwards periodically incoming wired data to WiFi and vice versa. The system consists of two devices running the same kernel module. Under certain conditions we are experiencing undesired latency.</p>\n\n<p>The module starts a kernel thread which basically performs:</p>\n\n<pre><code>while(1) {\n    schedule()\n    do_bridge_work()\n    usleep_range(200, 500)\n}\n</code></pre>\n\n<p>During normal operation, <code>top</code> command displays:</p>\n\n<pre><code>CPU:   0% usr  19% sys   0% nic  60% idle   0% io   0% irq  19% sirq \nLoad average: 1.03 1.06 1.01 1/54 491\nPID  PPID USER     STAT   VSZ %VSZ %CPU COMMAND\n491    2 root        DW     0   0%  29% [bridge_thread]\n3      2 root        SW     0   0%  10% [ksoftirqd/0]\n</code></pre>\n\n<p>When diagnostics is activated the thread also sends out additional diagnostic wired eth packets. In this mode, ping of devices on one side to the other side goes from 5-6ms to 45-900 ms.  <code>top</code> then shows:</p>\n\n<pre><code>CPU:   0% usr  25% sys   0% nic  50% idle   0% io   0% irq  24% sirq \nLoad average: 1.06 1.07 1.01 1/54 491\nPID  PPID USER     STAT   VSZ %VSZ %CPU COMMAND\n491    2 root        DW     0   0%  35% [bridge_thread]\n3      2 root        SW     0   0%  14% [ksoftirqd/0]\n</code></pre>\n\n<p>If an additional <code>schedule()</code> is inserted before <code>usleep_range()</code>, or if the sleep time is increased, it drastically reduces the latency. I think I have narrowed it down to conclude that the RX softirq does not get the scheduling time it needs to process the incoming traffic (<code>NET_RX_SOFTIRQ</code>). This is based on the fact the timing of transmitted packets are perfectly fine.</p>\n\n<p>My questions are:</p>\n\n<p>1: Why does the ping time increase due to more work in <code>do_bridge_work()</code> (more processing and additional transmitting of packets). Is <code>NET_RX_SOFTIRQ</code> likely starved?</p>\n\n<p>2: Why does the ping time decrease when additional <code>schedule()</code> is inserted, or when sleep time is increased? Does that mean that 200-500 us is not enough to process all pending softirqs work, and the lower softirqs are starved? Is the effect of adding additional <code>schedule()</code> the same as letting other do more work by increasing the sleep time?</p>\n\n<p>Kernel version is 4.1.38, configured with NO_HZ, PREEMPT = y.</p>\n"}, {"tags": ["c", "linux", "unix", "select"], "comments": [{"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1543415478, "post_id": 53514051, "comment_id": 93912220, "body": "Related: <a href=\"https://stackoverflow.com/q/7976388/694576\">stackoverflow.com/q/7976388/694576</a>"}], "answers": [{"tags": [], "owner": {"reputation": 170455, "user_id": 149341, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/omfTQ.png?s=128&g=1", "display_name": "duskwuff -inactive-", "link": "https://stackoverflow.com/users/149341/duskwuff-inactive"}, "is_accepted": false, "score": 2, "last_activity_date": 1543389897, "creation_date": 1543389897, "answer_id": 53514174, "question_id": 53514051, "link": "https://stackoverflow.com/questions/53514051/what-does-select-do-when-nfds-is-greater-than-length-of-bit-array-in-fd-set-is/53514174#53514174", "title": "What does select do when nfds is greater than length of bit array in fd_set? Is it possible?", "body": "<p>According to <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/select.html\" rel=\"nofollow noreferrer\">the specification</a>, if <code>nfds</code> is larger than <code>FD_SETSIZE</code>, <code>select()</code> will return -1 and set <code>errno</code> to EINVAL.</p>\n\n<p>In some implementations (including on Linux systems), it will instead write to bits outside the <code>fd_set</code> structure, potentially corrupting memory in your application. (The intent is to allow applications to use larger <code>fd_set</code> structures, but the effect is often to cause applications to crash as soon as they try to use more than 1024 file descriptors.)</p>\n\n<p>To work with more than 1024 file descriptors, you will need to use an API other than <code>select()</code>. These APIs are often system-specific; one platform-independent option to consider is the <a href=\"http://software.schmorp.de/pkg/libev.html\" rel=\"nofollow noreferrer\">libev</a> library, which provides a set of useful abstractions for highly concurrent applications.</p>\n"}], "owner": {"reputation": 567, "user_id": 4130471, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/df283b5676af3b7ea77aea7c88305a1c?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4130471/brian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 122, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1543389897, "creation_date": 1543389417, "question_id": 53514051, "link": "https://stackoverflow.com/questions/53514051/what-does-select-do-when-nfds-is-greater-than-length-of-bit-array-in-fd-set-is", "title": "What does select do when nfds is greater than length of bit array in fd_set? Is it possible?", "body": "<pre><code>int select(int nfds, \n       fd_set *readfds, \n       fd_set *writefds, \n       fd_set *exceptfds, \n       struct timeval *timeout);\n</code></pre>\n\n<p>Given fd_set is 1024 in length. What if the fd we want to monitor is 2048? What does select do when this happens? Will it happen at all?  </p>\n"}, {"tags": ["c"], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 8973389, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8d7ef6279dcb1e156130f275dd64192?s=128&d=identicon&r=PG&f=1", "display_name": "theRat", "link": "https://stackoverflow.com/users/8973389/therat"}, "edited": false, "score": 0, "creation_date": 1543391597, "post_id": 53514227, "comment_id": 93898065, "body": "When I call my function with printf what type field characters do I use since its a function of struct?"}, {"owner": {"reputation": 6300, "user_id": 2331592, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/befb1bd6b66c01fed1d2384a405e6f7e?s=128&d=identicon&r=PG&f=1", "display_name": "vlad_tepesch", "link": "https://stackoverflow.com/users/2331592/vlad-tepesch"}, "reply_to_user": {"reputation": 47, "user_id": 8973389, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8d7ef6279dcb1e156130f275dd64192?s=128&d=identicon&r=PG&f=1", "display_name": "theRat", "link": "https://stackoverflow.com/users/8973389/therat"}, "edited": false, "score": 0, "creation_date": 1543392261, "post_id": 53514227, "comment_id": 93898373, "body": "You cannot directly pass a structure to <code>printf</code>, you have to pass basic types. I added <code>printf</code>s to the code. if you do not want to store the result in a variable (there is no reason not to do so) then you have to call the function twice like <code>printf(&quot;%d %d\\n&quot;, commCal(...).total, comCal(..).commission);</code>"}], "tags": [], "owner": {"reputation": 6300, "user_id": 2331592, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/befb1bd6b66c01fed1d2384a405e6f7e?s=128&d=identicon&r=PG&f=1", "display_name": "vlad_tepesch", "link": "https://stackoverflow.com/users/2331592/vlad-tepesch"}, "is_accepted": false, "score": 2, "last_activity_date": 1543391966, "last_edit_date": 1543391966, "creation_date": 1543390107, "answer_id": 53514227, "question_id": 53514032, "link": "https://stackoverflow.com/questions/53514032/return-different-values-of-a-struct-from-a-function/53514227#53514227", "title": "Return different values of a struct from a function", "body": "<p>in <code>c</code> a function can not return more than one  value by return value.</p>\n\n<p>You have two options here:</p>\n\n<p>option 1: pass a pointer to result variables as parameter that it should receive the outputs</p>\n\n<pre><code>void commissionCal(const struct Sale *i_arrSale, int i_size, double * o_total, double *o_commision)\n{\n  *o_total= 0.;\n  *o_commission= 0.;\n  // ...\n}\n\n// later in your program:\n  double total;\n  double commission;\n  commissionCal(monthlysales, salescount, &amp;total, &amp;commission);\n  printf(\"total: %f commission: %f\", total, commission);\n</code></pre>\n\n<p>option 2: define structure and use it as return type</p>\n\n<pre><code>struct SaleResults{\n  double total;\n  double commission;\n}\n\nstruct SaleResults commissionCal(const struct Sale *i_arrSale, int i_size)\n{\n  SaleResults results;\n  results.total = 0.;\n  results.commission = 0.;\n  // ...\n  return results\n}\n\n// later in your program:\n  struct SaleResults results = commissionCal(monthlysales, salescount);\n  printf(\"total: %f commission: %f\", results.total, results.commission);\n</code></pre>\n\n<p>this option should only be used if your returned data structure is relatively small (just a bunch of values), because a copy is made after return on the assignment to the receiving variable. However modern compiler usually employ return value optimization (RVO) to eliminate this overhead.</p>\n\n<p>Please also note that i changed the sales array input to a <code>const</code> pointer.\nyou should always declare pointer (especially in function parameters) as <code>const</code> if your piece of could is not intended to change it.</p>\n"}], "owner": {"reputation": 47, "user_id": 8973389, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8d7ef6279dcb1e156130f275dd64192?s=128&d=identicon&r=PG&f=1", "display_name": "theRat", "link": "https://stackoverflow.com/users/8973389/therat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1543391966, "creation_date": 1543389305, "question_id": 53514032, "link": "https://stackoverflow.com/questions/53514032/return-different-values-of-a-struct-from-a-function", "title": "Return different values of a struct from a function", "body": "<p>I want to set a commission for each salesperson in a function that has a dynamic array of struct. If a salesperson sells more than x dollars then you have a commission of 9%, if the person sells less than x then you have a 5% commission. </p>\n\n<p>let us say the size is four, then each person will have 4 separate commission\nI want to display four different amounts. </p>\n\n<pre><code>double commissionCal(struct Sale *arrSale, int size)\n{\n    double commission, total;\n\n    for (int x = 0; x &lt; size; x++)\n    {\n        if (arrSale[x].saleAmount &gt; 2000.00)\n        {\n            commission = arrSale[x].saleAmount * .09; //sets commission\n            total = arrSale[x].saleAmount + commission; // adds commission to sale amount\n\n            return total; // I know by adding return total will end the function\n        }\n        else\n        {\n            commission = arrSale[x].saleAmount * .05;\n            total = arrSale[x].saleAmount + commission;\n\n            return total;\n        }\n    }\n\n\n}\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/TEvjm.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/TEvjm.png\" alt=\"Console output\"></a></p>\n"}, {"tags": ["python", "c", "performance", "numpy", "time"], "comments": [{"owner": {"reputation": 245, "user_id": 8358281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67a5fbdd382fd6ab1f1385c9d0c9233d?s=128&d=identicon&r=PG&f=1", "display_name": "Arthur-1", "link": "https://stackoverflow.com/users/8358281/arthur-1"}, "edited": false, "score": 0, "creation_date": 1543389204, "post_id": 53513944, "comment_id": 93896969, "body": "What OS are you running on? If you&#39;re on Linux, run the <code>top</code> command from the command line while running the numpy operation, and visually check how many cores are being used. Although I suspect numpy isn&#39;t using parallelism without you explicitly telling it to do so."}, {"owner": {"reputation": 144819, "user_id": 2836621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/suHg4.jpg?s=128&g=1", "display_name": "Mark Setchell", "link": "https://stackoverflow.com/users/2836621/mark-setchell"}, "edited": false, "score": 0, "creation_date": 1543389325, "post_id": 53513944, "comment_id": 93897023, "body": "Your C program effectively has an <code>if</code> in the middle - that often stalls a CPU."}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 3, "creation_date": 1543389361, "post_id": 53513944, "comment_id": 93897036, "body": "You are doing very different operations. For one thing, your Python is generating 2e6 pseudorandom numbers; your C code, at least 1e9 in addition to the multiply-and-sum that both codes are doing. Would you rather lift a thousand pieces of paper or a thousand cannon balls? Why? Isn&#39;t it the same, thousand and thousand?"}, {"owner": {"reputation": 1260, "user_id": 4763182, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bf6929ba6d3abe683e0054f7dc8a8cb?s=128&d=identicon&r=PG", "display_name": "BishalG", "link": "https://stackoverflow.com/users/4763182/bishalg"}, "edited": false, "score": 1, "creation_date": 1543389382, "post_id": 53513944, "comment_id": 93897048, "body": "try doing <b>np.random.randn(31623, 31623)</b>"}, {"owner": {"reputation": 1704, "user_id": 8445537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/270b869206b49bd1e6d7c7009bc163b4?s=128&d=identicon&r=PG&f=1", "display_name": "Nikolaus", "link": "https://stackoverflow.com/users/8445537/nikolaus"}, "edited": false, "score": 1, "creation_date": 1543389867, "post_id": 53513944, "comment_id": 93897263, "body": "In c you are doing more than 10^9 rand() operations, because of your condition in the loop."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1543397610, "post_id": 53513944, "comment_id": 93901247, "body": "This again... It is completely and utterly pointless to discuss performance if 1) you don&#39;t tell us which system you use, 2) you don&#39;t tell us which compiler you use, and 3) you don&#39;t tell us which optimization options that where used."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1543408961, "post_id": 53513944, "comment_id": 93907998, "body": "@Lundin: Your claim that it is pointless to discuss performance without that information is contradicted by the fact the primary cause of the behavior OP observed was correctly diagnosed two hours prior to your comment."}], "answers": [{"tags": [], "owner": {"reputation": 1334, "user_id": 3532564, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0nSv2.jpg?s=128&g=1", "display_name": "Ian Quah", "link": "https://stackoverflow.com/users/3532564/ian-quah"}, "is_accepted": false, "score": -4, "last_activity_date": 1543389154, "creation_date": 1543389154, "answer_id": 53513995, "question_id": 53513944, "link": "https://stackoverflow.com/questions/53513944/numpy-faster-than-pure-c/53513995#53513995", "title": "Numpy faster than pure C?", "body": "<p>Numpy has backends in multiple languages like C, C++, and Fortran as listed <a href=\"https://docs.scipy.org/doc/numpy-1.13.0/user/c-info.python-as-glue.html\" rel=\"nofollow noreferrer\">on their docs</a></p>\n\n<blockquote>\n  <p>As Numeric has matured and developed into NumPy, people have been able\n  to write more code directly in NumPy. Often this code is fast-enough\n  for production use, but there are still times that there is a need to\n  access compiled code. Either to get that last bit of efficiency out of\n  the algorithm or to make it easier to access widely-available codes\n  written in C/C++ or Fortran)</p>\n</blockquote>\n\n<p>So unless you're writing highly optimized C code chances are it'll be slower anyways</p>\n"}, {"comments": [{"owner": {"reputation": 245, "user_id": 8358281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67a5fbdd382fd6ab1f1385c9d0c9233d?s=128&d=identicon&r=PG&f=1", "display_name": "Arthur-1", "link": "https://stackoverflow.com/users/8358281/arthur-1"}, "edited": false, "score": 0, "creation_date": 1543389349, "post_id": 53514003, "comment_id": 93897032, "body": "Are you implying that the numpy program only makes 1 call to a random function to generate 10^6 distinct random entries?"}, {"owner": {"reputation": 44820, "user_id": 4492932, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e8938ef2681650e100bc9f83434ef272?s=128&d=identicon&r=PG", "display_name": "DYZ", "link": "https://stackoverflow.com/users/4492932/dyz"}, "edited": false, "score": 3, "creation_date": 1543389364, "post_id": 53514003, "comment_id": 93897038, "body": "Matrix dot product takes O(n^3), which is 1e9."}, {"owner": {"reputation": 197, "user_id": 6048391, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153851772277931/picture?type=large", "display_name": "Truman Purnell", "link": "https://stackoverflow.com/users/6048391/truman-purnell"}, "edited": false, "score": 1, "creation_date": 1543389393, "post_id": 53514003, "comment_id": 93897058, "body": "But the dot is along the shared dimension of 1000. So we have two arrays at 10^6, I&#39;m with you. But the dot adds another 10^3 operations. Back at 10^9"}, {"owner": {"reputation": 245, "user_id": 8358281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67a5fbdd382fd6ab1f1385c9d0c9233d?s=128&d=identicon&r=PG&f=1", "display_name": "Arthur-1", "link": "https://stackoverflow.com/users/8358281/arthur-1"}, "edited": false, "score": 0, "creation_date": 1543389485, "post_id": 53514003, "comment_id": 93897100, "body": "Numpy likely highly optimizes the dot product for cache locality, so I&#39;d be willing to wager its 10^9 operations execute much more quickly than the 10^9 system calls (for random) in the C++ program."}, {"owner": {"reputation": 35644, "user_id": 4954037, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/YOM4r.jpg?s=128&g=1", "display_name": "hiro protagonist", "link": "https://stackoverflow.com/users/4954037/hiro-protagonist"}, "edited": false, "score": 4, "creation_date": 1543389508, "post_id": 53514003, "comment_id": 93897113, "body": "you are still comparing <i>very</i> different operations. <code>~10^9</code> <code>rand()</code> calls vs <code>10^6</code> <code>nrand()</code> calls plus multiplications/array creation. for a real benchmark you should make sure your programs do exactly the same."}, {"owner": {"reputation": 44820, "user_id": 4492932, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e8938ef2681650e100bc9f83434ef272?s=128&d=identicon&r=PG", "display_name": "DYZ", "link": "https://stackoverflow.com/users/4492932/dyz"}, "reply_to_user": {"reputation": 245, "user_id": 8358281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67a5fbdd382fd6ab1f1385c9d0c9233d?s=128&d=identicon&r=PG&f=1", "display_name": "Arthur-1", "link": "https://stackoverflow.com/users/8358281/arthur-1"}, "edited": false, "score": 2, "creation_date": 1543389595, "post_id": 53514003, "comment_id": 93897151, "body": "@Arthur-1 <code>random</code> is not a system call."}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 1, "creation_date": 1543389757, "post_id": 53514003, "comment_id": 93897217, "body": "Note that both codes do 1e9 additions and 1e9 multiplications, unconditionally. The cca 2e9 <code>rand</code> calls are <i>on top</i> of that. <a href=\"https://code.woboq.org/userspace/glibc/stdlib/random_r.c.html#__random_r\" rel=\"nofollow noreferrer\">Here</a>&#39;s the source of glibc random - an addition, a multiplication and a bitwise AND (for the simplest RNG)."}, {"owner": {"reputation": 245, "user_id": 8358281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67a5fbdd382fd6ab1f1385c9d0c9233d?s=128&d=identicon&r=PG&f=1", "display_name": "Arthur-1", "link": "https://stackoverflow.com/users/8358281/arthur-1"}, "edited": false, "score": 0, "creation_date": 1543389860, "post_id": 53514003, "comment_id": 93897260, "body": "Silly me, I don&#39;t know why on earth I&#39;d assume the implementation would make a syscall to the os&#39;s random number generator. Probably time to sleep :)"}, {"owner": {"reputation": 63648, "user_id": 5014455, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JTknr.png?s=128&g=1", "display_name": "juanpa.arrivillaga", "link": "https://stackoverflow.com/users/5014455/juanpa-arrivillaga"}, "edited": false, "score": 0, "creation_date": 1543390044, "post_id": 53514003, "comment_id": 93897351, "body": "<code>numpy.dot</code> will call an underlying BLAS library on your system if possible"}], "tags": [], "owner": {"reputation": 35644, "user_id": 4954037, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/YOM4r.jpg?s=128&g=1", "display_name": "hiro protagonist", "link": "https://stackoverflow.com/users/4954037/hiro-protagonist"}, "is_accepted": false, "score": 6, "last_activity_date": 1543389916, "last_edit_date": 1543389916, "creation_date": 1543389188, "answer_id": 53514003, "question_id": 53513944, "link": "https://stackoverflow.com/questions/53513944/numpy-faster-than-pure-c/53514003#53514003", "title": "Numpy faster than pure C?", "body": "<p>Your pragrams are not doing the same. Your <code>C</code> program calls <code>rand</code> <em>at least</em> <code>10^9</code> times. additionally you have conditions on your randoms.</p>\n\n<p><code>numpy</code> creates 2 <code>1000x1000</code> arrays which is <code>2x10^6</code> only. no conditions on the random value. the dot product then adds <code>O(n^3)</code> operations (and an array creation) but is very optimized.</p>\n\n<p>So you are basically comparing sequential <code>rand</code> calls in <code>C</code> to much fewer <code>randn</code> calls plus an optimized operation (<code>dot</code>) in python.</p>\n\n<p>in order to have a valid benchmark you should have 2 programs that are doing the exact same operations.</p>\n"}], "owner": {"reputation": 197, "user_id": 6048391, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153851772277931/picture?type=large", "display_name": "Truman Purnell", "link": "https://stackoverflow.com/users/6048391/truman-purnell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 177, "favorite_count": 0, "closed_date": 1543423542, "answer_count": 2, "score": -8, "last_activity_date": 1543389916, "creation_date": 1543388934, "question_id": 53513944, "link": "https://stackoverflow.com/questions/53513944/numpy-faster-than-pure-c", "closed_reason": "Needs details or clarity", "title": "Numpy faster than pure C?", "body": "<p>I have the following C code. On my machine, I clock this in at around 13 seconds.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;time.h&gt;\n\nint main(void) {\n    clock_t begin = clock();\n\n    double d = 0;\n\n    for (int i = 0; i &lt; 1e9; i++) {\n        d = 1 + rand() * 5 &gt; 10 ? 4 : rand();\n    }\n\n    clock_t end = clock();\n    double time_spent = (double) (end - begin) / CLOCKS_PER_SEC;\n\n    printf(\"%f\", time_spent);\n    return EXIT_SUCCESS;\n}\n</code></pre>\n\n<p>But this numpy operation, I clock at fractions of a second!</p>\n\n<pre><code>a = np.random.randn(1000, 1000)\nb = np.random.randn(1000, 1000)\nc = a.dot(b)\n</code></pre>\n\n<p>How is this possible, given that they're doing the same amount (1e9 operations) of work? Is numpy parallelizing?? </p>\n"}, {"tags": ["c", "syntax"], "comments": [{"owner": {"reputation": 2988, "user_id": 452414, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/rDMfs.png?s=128&g=1", "display_name": "babon", "link": "https://stackoverflow.com/users/452414/babon"}, "edited": false, "score": 1, "creation_date": 1543387095, "post_id": 53513484, "comment_id": 93896051, "body": "You are trying to assign a <i>string</i> to a <code>char</code> here."}], "answers": [{"comments": [{"owner": {"reputation": 44820, "user_id": 4492932, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e8938ef2681650e100bc9f83434ef272?s=128&d=identicon&r=PG", "display_name": "DYZ", "link": "https://stackoverflow.com/users/4492932/dyz"}, "edited": false, "score": 1, "creation_date": 1543388978, "post_id": 53513523, "comment_id": 93896878, "body": "The OP does not want a single character."}], "tags": [], "owner": {"reputation": 99, "user_id": 8319135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c92a5f668c2b1d4a474af36b5f08facd?s=128&d=identicon&r=PG&f=1", "display_name": "Jorge Juan Torres Quiroga", "link": "https://stackoverflow.com/users/8319135/jorge-juan-torres-quiroga"}, "is_accepted": false, "score": 1, "last_activity_date": 1543387081, "creation_date": 1543387081, "answer_id": 53513523, "question_id": 53513484, "link": "https://stackoverflow.com/questions/53513484/how-do-i-initialize-a-single-character-variable-to-a-decimal-number-with-an-ini/53513523#53513523", "title": "How do I initialize a single character variable to a decimal number (with an initializer)", "body": "<p>For single characters, you need to use single quotes:</p>\n\n<pre><code>const char timeband = '\\xe';\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 2, "creation_date": 1543388220, "post_id": 53513577, "comment_id": 93896536, "body": "You should have tried compiling that before posting it. You can&#39;t initialize an array with an integer constant. (This comment refers to the original version of the question, which has since been edited.)"}, {"owner": {"reputation": 44820, "user_id": 4492932, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e8938ef2681650e100bc9f83434ef272?s=128&d=identicon&r=PG", "display_name": "DYZ", "link": "https://stackoverflow.com/users/4492932/dyz"}, "reply_to_user": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1543388312, "post_id": 53513577, "comment_id": 93896579, "body": "@KeithThompson The original question was about a scalar, not an array. The OP changed the question, and I did not update the answer correctly."}, {"owner": {"reputation": 5181, "user_id": 8866606, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Ao_wuU1YCUE/AAAAAAAAAAI/AAAAAAAAAtc/Nc6ExTtKE_A/photo.jpg?sz=128", "display_name": "Stefan Becker", "link": "https://stackoverflow.com/users/8866606/stefan-becker"}, "edited": false, "score": 0, "creation_date": 1543390276, "post_id": 53513577, "comment_id": 93897436, "body": "Not the correct answer. The author is asking to set a scalar not an array. Please edit  EDIT: I realized that the OP changed his question. Ignore my downvote, SO does not allow me to cancel it."}], "tags": [], "owner": {"reputation": 44820, "user_id": 4492932, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e8938ef2681650e100bc9f83434ef272?s=128&d=identicon&r=PG", "display_name": "DYZ", "link": "https://stackoverflow.com/users/4492932/dyz"}, "is_accepted": false, "score": 4, "last_activity_date": 1543388250, "last_edit_date": 1543388250, "creation_date": 1543387333, "answer_id": 53513577, "question_id": 53513484, "link": "https://stackoverflow.com/questions/53513484/how-do-i-initialize-a-single-character-variable-to-a-decimal-number-with-an-ini/53513577#53513577", "title": "How do I initialize a single character variable to a decimal number (with an initializer)", "body": "<p>I guess you are looking for <code>const char timeband[1] = { 14 };</code> There is no need to go fancy with the hexadecimal notation.</p>\n"}, {"comments": [{"owner": {"reputation": 5181, "user_id": 8866606, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Ao_wuU1YCUE/AAAAAAAAAAI/AAAAAAAAAtc/Nc6ExTtKE_A/photo.jpg?sz=128", "display_name": "Stefan Becker", "link": "https://stackoverflow.com/users/8866606/stefan-becker"}, "edited": false, "score": 0, "creation_date": 1543390303, "post_id": 53513688, "comment_id": 93897452, "body": "Not the correct answer. The author is asking to set a scalar not an array. Please edit  EDIT: I realized that the OP changed his question. Ignore my downvote, SO does not allow me to cancel it."}], "tags": [], "owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "is_accepted": false, "score": 4, "last_activity_date": 1543388274, "last_edit_date": 1543388274, "creation_date": 1543387804, "answer_id": 53513688, "question_id": 53513484, "link": "https://stackoverflow.com/questions/53513484/how-do-i-initialize-a-single-character-variable-to-a-decimal-number-with-an-ini/53513688#53513688", "title": "How do I initialize a single character variable to a decimal number (with an initializer)", "body": "<p>There's no way to specify decimal character values within a string literal.</p>\n\n<p>You can do this</p>\n\n<pre><code>const char timeband[1] = { 14 };\n</code></pre>\n\n<p>For long strings, this kind of initialisation can get real tedious real quick:</p>\n\n<pre><code>const char foo[] = { '1', '2', '3', 14 };\n</code></pre>\n\n<p>but that's what you've got if you want decimal.</p>\n"}, {"tags": [], "owner": {"reputation": 157, "user_id": 7423489, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83432c05a057dabff45086edbd2913a1?s=128&d=identicon&r=PG&f=1", "display_name": "Jennifer", "link": "https://stackoverflow.com/users/7423489/jennifer"}, "is_accepted": false, "score": -2, "last_activity_date": 1543426458, "last_edit_date": 1543426458, "creation_date": 1543392350, "answer_id": 53514771, "question_id": 53513484, "link": "https://stackoverflow.com/questions/53513484/how-do-i-initialize-a-single-character-variable-to-a-decimal-number-with-an-ini/53514771#53514771", "title": "How do I initialize a single character variable to a decimal number (with an initializer)", "body": "<p>I'm going to answer my own question:</p>\n\n<p><strong>You can't do it.</strong></p>\n"}], "owner": {"reputation": 157, "user_id": 7423489, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83432c05a057dabff45086edbd2913a1?s=128&d=identicon&r=PG&f=1", "display_name": "Jennifer", "link": "https://stackoverflow.com/users/7423489/jennifer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1543426458, "creation_date": 1543386928, "last_edit_date": 1543387334, "question_id": 53513484, "link": "https://stackoverflow.com/questions/53513484/how-do-i-initialize-a-single-character-variable-to-a-decimal-number-with-an-ini", "title": "How do I initialize a single character variable to a decimal number (with an initializer)", "body": "<p>This is a question about C syntax.</p>\n\n<p>I have this one-byte long character variable that I initialize thusly:</p>\n\n<pre><code>const char timeband = \"\\xe\";\n</code></pre>\n\n<p>This initializes it to decimal value 14.  I'm using hex because I don't know how to specify decimal in the initializer.  How would I do that?</p>\n\n<p>Setting the value with an assignment statement or using octal is not an option.</p>\n\n<p>EDIT: I should have said</p>\n\n<pre><code>const char timeband[1] = \"\\xe\";\n</code></pre>\n\n<p>And I still want to get away from hex.  Using '\\xe' doesn't answer the question.</p>\n"}, {"tags": ["c", "position", "bit"], "comments": [{"owner": {"reputation": 3478, "user_id": 9061264, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TPing.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/9061264/mike"}, "edited": false, "score": 0, "creation_date": 1543386649, "post_id": 53513408, "comment_id": 93895878, "body": "Please show us what you have tried so far!! Noboby wants to write your software."}, {"owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 1, "creation_date": 1543386726, "post_id": 53513408, "comment_id": 93895908, "body": "Your example does not make sense, at least to me."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 2, "creation_date": 1543386862, "post_id": 53513408, "comment_id": 93895959, "body": "&quot;...  0011101110, the msb is 6&quot; How?"}, {"owner": {"reputation": 41, "user_id": 10705566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xrpHC.jpg?s=128&g=1", "display_name": "May Athena", "link": "https://stackoverflow.com/users/10705566/may-athena"}, "edited": false, "score": 0, "creation_date": 1543387496, "post_id": 53513408, "comment_id": 93896228, "body": "I dont want anyone to write my code. I just want to know what to do to find the msb position. Just an explanation. I don&#39;t want a code written for me."}, {"owner": {"reputation": 41, "user_id": 10705566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xrpHC.jpg?s=128&g=1", "display_name": "May Athena", "link": "https://stackoverflow.com/users/10705566/may-athena"}, "edited": false, "score": 0, "creation_date": 1543387528, "post_id": 53513408, "comment_id": 93896240, "body": "It was the example our teacher gave. Word for word its &quot;For example: 0011101110. The msb is 6. Use this as a way to test.&quot; Personally I think it&#39;s 7. Counting right to left, starting at 0, it might be 7 actually."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1543387797, "post_id": 53513408, "comment_id": 93896354, "body": "@MayAthena 7 is correct. Anyway - do you have any code to share so far? Any ideas of the operators to use? SO don&#39;t just write code for you. You need to show some effort by sharing the code you have or at least a description of your ideas."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1543387972, "post_id": 53513408, "comment_id": 93896422, "body": "@MayAthena Here is a tip to get you started. To check if the bit at position 3 is set you can do: <code>if (n &amp; (1 &lt;&lt; 3)) printf(&quot;The bit at position 3 is set\\n&quot;);</code> Now take this code and use a variable instead of the hard coded 3. Then put it into a for-loop. Then you are nearly done."}, {"owner": {"reputation": 41, "user_id": 10705566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xrpHC.jpg?s=128&g=1", "display_name": "May Athena", "link": "https://stackoverflow.com/users/10705566/may-athena"}, "edited": false, "score": 0, "creation_date": 1543388311, "post_id": 53513408, "comment_id": 93896578, "body": "@ 4386427 Good idea! I will try."}, {"owner": {"reputation": 41, "user_id": 10705566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xrpHC.jpg?s=128&g=1", "display_name": "May Athena", "link": "https://stackoverflow.com/users/10705566/may-athena"}, "edited": false, "score": 0, "creation_date": 1543388354, "post_id": 53513408, "comment_id": 93896598, "body": "I dont have a code at all is the problem. I had to scratch my code ten times already. I know how to find lsb, but msb....I am lost."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1543388465, "post_id": 53513408, "comment_id": 93896641, "body": "@MayAthena lsb or msb.. same thing... For msb you just start at <code>pos = CHAR_BIT * sizeof(unsigned) - 1</code> and <b>decrement</b> <code>pos</code>in each loop until you find a bit that is set. (include limits.h to get CHAR_BIT)"}, {"owner": {"reputation": 1505, "user_id": 5629418, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1027a739f87fcf27a64846508280dab1?s=128&d=identicon&r=PG&f=1", "display_name": "Roland Weber", "link": "https://stackoverflow.com/users/5629418/roland-weber"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1543388532, "post_id": 53513408, "comment_id": 93896676, "body": "Write a loop. You can either test different bit positions, as suggested by @4386427. Or you can bit-shift (half the value) of the number to test until it becomes 0."}, {"owner": {"reputation": 41, "user_id": 10705566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xrpHC.jpg?s=128&g=1", "display_name": "May Athena", "link": "https://stackoverflow.com/users/10705566/may-athena"}, "edited": false, "score": 0, "creation_date": 1543388645, "post_id": 53513408, "comment_id": 93896729, "body": "I dont know what any of you just said. I am noob noob. How does one go about bit-shifting the number and what does it do to help find the most significant bit?"}, {"owner": {"reputation": 41, "user_id": 10705566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xrpHC.jpg?s=128&g=1", "display_name": "May Athena", "link": "https://stackoverflow.com/users/10705566/may-athena"}, "edited": false, "score": 0, "creation_date": 1543388793, "post_id": 53513408, "comment_id": 93896797, "body": "I sound annoying. for sure. I know already. But pls explain like I am a child. Our teacher only has had 30 minutes per class to teach this, so I am running on virtually no information."}, {"owner": {"reputation": 41, "user_id": 10705566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xrpHC.jpg?s=128&g=1", "display_name": "May Athena", "link": "https://stackoverflow.com/users/10705566/may-athena"}, "edited": false, "score": 0, "creation_date": 1543389279, "post_id": 53513408, "comment_id": 93897003, "body": "Thank you, but this doesnt help me. It just says the bit is set. What does that mean? I need a position listed out. Like in my example. I just want some example or explanation of how this works, not an answer. I dont want for anyone to write my code (hence why I am not asking for a code, just an explanation)."}, {"owner": {"reputation": 41, "user_id": 10705566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xrpHC.jpg?s=128&g=1", "display_name": "May Athena", "link": "https://stackoverflow.com/users/10705566/may-athena"}, "edited": false, "score": 0, "creation_date": 1543389934, "post_id": 53513408, "comment_id": 93897298, "body": "Oh, wait so set means it&#39;s a 1. Like, it has a set value? Bc 0 means, well, 0. I am just trying to understand the terminology. :)"}, {"owner": {"reputation": 41, "user_id": 10705566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xrpHC.jpg?s=128&g=1", "display_name": "May Athena", "link": "https://stackoverflow.com/users/10705566/may-athena"}, "edited": false, "score": 0, "creation_date": 1543390041, "post_id": 53513408, "comment_id": 93897347, "body": "Okay, thank you so much! As for my code...My code would look pretty empty as I only have my function prototype and standard main. No point putting this code out. :( I didn&#39;t know what to do to start bc I didn&#39;t know what the teacher asked of us. We never covered bit manipulation for more than ten minutes. So making loops etc, kinda requires an understanding of how the manipulation affects the bits."}, {"owner": {"reputation": 593, "user_id": 9658875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/841f55a02830a8f0655c07654401670f?s=128&d=identicon&r=PG&f=1", "display_name": "GermanNerd", "link": "https://stackoverflow.com/users/9658875/germannerd"}, "edited": false, "score": 0, "creation_date": 1543393863, "post_id": 53513408, "comment_id": 93899104, "body": "@May Athena: The duplicate link given above solves your question <b>exactly</b>, and in a very elegant way. However, I think that a beginner in C will have great difficulties in understanding that code."}, {"owner": {"reputation": 41, "user_id": 10705566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xrpHC.jpg?s=128&g=1", "display_name": "May Athena", "link": "https://stackoverflow.com/users/10705566/may-athena"}, "edited": false, "score": 0, "creation_date": 1543398167, "post_id": 53513408, "comment_id": 93901618, "body": "Boo. Well that sucks. Guess this site doesnt recognize skill level lol. Though it figures bc everyone here is a genius. :("}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 10705566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xrpHC.jpg?s=128&g=1", "display_name": "May Athena", "link": "https://stackoverflow.com/users/10705566/may-athena"}, "edited": false, "score": 0, "creation_date": 1543390623, "post_id": 53514325, "comment_id": 93897611, "body": "I am so sorry I cannot upvote your comment. It wont show bc I am new here so my vote doesnt show. But your explanation really helps. Thank you! That&#39;s what I wanted. Understanding the concept will let me figure out how to do this to other questions, not just this one, ya know? Thank you!"}, {"owner": {"reputation": 593, "user_id": 9658875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/841f55a02830a8f0655c07654401670f?s=128&d=identicon&r=PG&f=1", "display_name": "GermanNerd", "link": "https://stackoverflow.com/users/9658875/germannerd"}, "reply_to_user": {"reputation": 41, "user_id": 10705566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xrpHC.jpg?s=128&g=1", "display_name": "May Athena", "link": "https://stackoverflow.com/users/10705566/may-athena"}, "edited": false, "score": 0, "creation_date": 1543390738, "post_id": 53514325, "comment_id": 93897678, "body": "You are welcome. It can be frustrating if you get so little instructions from your teacher, and I guess English is not your 1st language, either...If my answer is of use to you, you can accept it, even with low reputation."}, {"owner": {"reputation": 41, "user_id": 10705566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xrpHC.jpg?s=128&g=1", "display_name": "May Athena", "link": "https://stackoverflow.com/users/10705566/may-athena"}, "edited": false, "score": 0, "creation_date": 1543391352, "post_id": 53514325, "comment_id": 93897965, "body": "No, English is my first language. Programming isn&#39;t though lol."}, {"owner": {"reputation": 593, "user_id": 9658875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/841f55a02830a8f0655c07654401670f?s=128&d=identicon&r=PG&f=1", "display_name": "GermanNerd", "link": "https://stackoverflow.com/users/9658875/germannerd"}, "reply_to_user": {"reputation": 41, "user_id": 10705566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xrpHC.jpg?s=128&g=1", "display_name": "May Athena", "link": "https://stackoverflow.com/users/10705566/may-athena"}, "edited": false, "score": 0, "creation_date": 1543391606, "post_id": 53514325, "comment_id": 93898068, "body": "Ups...sorry. I&#39;m not so used to the way young people write English. ;) BTW, if you have trouble understanding what these binary operations really do (<b>&amp;</b> and <b>&lt;&lt;</b>), I can edit my answer to show a little diagram."}, {"owner": {"reputation": 41, "user_id": 10705566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xrpHC.jpg?s=128&g=1", "display_name": "May Athena", "link": "https://stackoverflow.com/users/10705566/may-athena"}, "edited": false, "score": 0, "creation_date": 1543398202, "post_id": 53514325, "comment_id": 93901646, "body": "No. It&#39;s fine. This helped enough for me! :)"}], "tags": [], "owner": {"reputation": 593, "user_id": 9658875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/841f55a02830a8f0655c07654401670f?s=128&d=identicon&r=PG&f=1", "display_name": "GermanNerd", "link": "https://stackoverflow.com/users/9658875/germannerd"}, "is_accepted": true, "score": 0, "last_activity_date": 1543391946, "last_edit_date": 1543391946, "creation_date": 1543390475, "answer_id": 53514325, "question_id": 53513408, "link": "https://stackoverflow.com/questions/53513408/how-to-find-most-significant-bit-position/53514325#53514325", "title": "How to Find Most Significant Bit Position?", "body": "<p>Ok, you need 4 things:</p>\n\n<p>1) The sizeof operator, which gives you your variables size in <strong>bytes</strong>. To get the number of <strong>bits</strong>, you simply multiply with the constant CHAR_BIT. You get that constant by including 'limits.h'.</p>\n\n<p>2) A loop where you run through <strong>all</strong> the bits in your variable, using a separate counter variable. Inside the loop, you use</p>\n\n<p>3) the binary 'and' <strong>&amp;</strong> to test your variable against the value of 1, which you keep increasing by powers of 2 inside your loop using the</p>\n\n<p>4) binary left shift operator <strong>&lt;&lt;</strong></p>\n\n<p>Inside the loop you check if that binary 'and' results in '1'; if yes the bit is set and you can <strike>increment</strike> set another variable to your loop counter, which will be your return value.</p>\n"}], "owner": {"reputation": 41, "user_id": 10705566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xrpHC.jpg?s=128&g=1", "display_name": "May Athena", "link": "https://stackoverflow.com/users/10705566/may-athena"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 660, "favorite_count": 0, "closed_date": 1543391123, "accepted_answer_id": 53514325, "answer_count": 1, "score": -1, "last_activity_date": 1543391946, "creation_date": 1543386548, "last_edit_date": 1543391437, "question_id": 53513408, "link": "https://stackoverflow.com/questions/53513408/how-to-find-most-significant-bit-position", "closed_reason": "Duplicate", "title": "How to Find Most Significant Bit Position?", "body": "<p>I need to really find the most significant bit position of an unsigned n. It can be whatever input. </p>\n\n<p>I don't want the bit value, rather I want the position of the most significant bit (it has to be 1 not 0 btw).\nFor example, if my computer reads 0011101110, the msb is 6. </p>\n\n<p>Edit: I was using from an example my teacher gave. She may be wrong. I think the msb in that example is 7.\nAlso, I don't want a code written for me. Just explain what I should do. Like the concept of the thing. I don't wanna cheat or mooch off anyone.</p>\n\n<p>New Edit: IDK how this is a duplicate as the one given to me that this is a duplicate of is nothing like my question. It wouldn't have answered a thing I asked here.</p>\n"}, {"tags": ["c", "cuda"], "comments": [{"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1543386229, "post_id": 53513095, "comment_id": 93895703, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/5029920/how-to-use-2d-arrays-in-cuda\">How to use 2D Arrays in CUDA?</a>"}, {"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 2, "creation_date": 1543386436, "post_id": 53513095, "comment_id": 93895788, "body": "<code>double (*arr)[m] = malloc(n * sizeof *arr);</code> \u2013 I don&#39;t think that does what you think it does. And why all variables global??"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1543386459, "post_id": 53513095, "comment_id": 93895800, "body": "Detail; In C, <code>arr</code> in <code>double (*arr)[m]</code> is not a 2D array, but a <a href=\"https://cdecl.org/?q=double+%28%2Aarr%29%5B42%5D+\" rel=\"nofollow noreferrer\">pointer to an array m of doubles</a>.  <code>double arr[n][m]</code> is a 2D array."}, {"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 3, "creation_date": 1543386547, "post_id": 53513095, "comment_id": 93895827, "body": "@chux pssst ... pointer to array of m doubles."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1543386715, "post_id": 53513095, "comment_id": 93895903, "body": "To create a pointer to a 2D array, C code could use <code>double (*arr)[n][m] = malloc(sizeof *arr);</code>"}, {"owner": {"reputation": 596, "user_id": 6515468, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/121c092728150c1e63825411faf17696?s=128&d=identicon&r=PG&f=1", "display_name": "the_martian", "link": "https://stackoverflow.com/users/6515468/the-martian"}, "edited": false, "score": 0, "creation_date": 1543386733, "post_id": 53513095, "comment_id": 93895911, "body": "I can change the variables to be local if you&#39;d prefer, that would make more sense."}, {"owner": {"reputation": 596, "user_id": 6515468, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/121c092728150c1e63825411faf17696?s=128&d=identicon&r=PG&f=1", "display_name": "the_martian", "link": "https://stackoverflow.com/users/6515468/the-martian"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1543386773, "post_id": 53513095, "comment_id": 93895931, "body": "@chux thank you, I&#39;ll update accordingly then"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1543387006, "post_id": 53513095, "comment_id": 93896017, "body": "Cuda is not my strength.  Good luck"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 1, "creation_date": 1543387116, "post_id": 53513095, "comment_id": 93896060, "body": "@Swordfish On 2nd thought, perhaps OP does want <code>double (*arr)[m] = malloc(n * sizeof *arr);</code> even if it is not a proper 2D array.  Hmmm its late."}, {"owner": {"reputation": 596, "user_id": 6515468, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/121c092728150c1e63825411faf17696?s=128&d=identicon&r=PG&f=1", "display_name": "the_martian", "link": "https://stackoverflow.com/users/6515468/the-martian"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1543387139, "post_id": 53513095, "comment_id": 93896067, "body": "okay @chux thanks again for your previous help"}, {"owner": {"reputation": 119299, "user_id": 1695960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f9f557c03db19232aa410540af2f966?s=128&d=identicon&r=PG", "display_name": "Robert Crovella", "link": "https://stackoverflow.com/users/1695960/robert-crovella"}, "edited": false, "score": 0, "creation_date": 1543413808, "post_id": 53513095, "comment_id": 93911073, "body": "<a href=\"https://stackoverflow.com/questions/45643682/cuda-using-2d-and-3d-arrays/45644824#45644824\">this</a> may be of interest"}], "answers": [{"comments": [{"owner": {"reputation": 66945, "user_id": 681865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77320b8ddf13954ffb22aa22965d465e?s=128&d=identicon&r=PG&f=1", "display_name": "talonmies", "link": "https://stackoverflow.com/users/681865/talonmies"}, "edited": false, "score": 0, "creation_date": 1543418593, "post_id": 53516510, "comment_id": 93914201, "body": "I don&#39;t understand the logic of going to the trouble of writing a wrapper class and not using it on both the host and device. Further the OP is complaining that the many other answers to this question already on <a href=\"https://stackoverflow.com\">Stack Overflow</a> are apparently too hard to understand because of limited explanation. Your answer suffers from the same problem"}], "tags": [], "owner": {"reputation": 358, "user_id": 4174701, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/795f8a343604173c510dfc30d2bb64e9?s=128&d=identicon&r=PG&f=1", "display_name": "michelson", "link": "https://stackoverflow.com/users/4174701/michelson"}, "is_accepted": false, "score": 1, "last_activity_date": 1543398475, "creation_date": 1543398475, "answer_id": 53516510, "question_id": 53513095, "link": "https://stackoverflow.com/questions/53513095/how-do-you-create-a-2d-array-in-cuda/53516510#53516510", "title": "How do you create a 2d array in cuda", "body": "<p>You can simulate 2D array in 1D, keeping data row by row. So that 2D array:\n[a,b][c,d] becomes [a,b,c,d]. To make things simple you can write a wrapper class providing such functionality. </p>\n\n<p>Here is the demo (not 100% disasterproof, but working) of this idea</p>\n\n<pre><code>#pragma once\n#include &lt;iostream&gt;\n#include \"cuda_runtime.h\"\n#include \"device_launch_parameters.h\"\n\ntypedef int TYPE;\n\n// NOTE: copy consturctor and = operator need to be overloaded as well\ntemplate&lt;class T&gt;\nstruct Matrix\n{\n    Matrix(int r, int c) : rows(r), cols(c) {\n        data = new T[r*c];\n    }\n    ~Matrix() {\n        // As we allocated memory it needs to be freed upon destruction\n        delete[] data;\n        data = nullptr;\n    }\n    int rows, cols;\n    T* data;\n    T* operator[](int row) {\n        // Returns pointer to \"ROW\", further call to [] on result will retrieve item at column in this row\n        return data + (row*cols);\n    }\n};\n\n// Simple cuda kernel \n__global__ void add(TYPE *a, TYPE *b, TYPE *c, int rows, int cols) {\n    // Get element row and col\n    int row = blockIdx.y * blockDim.y + threadIdx.y;\n    int col = blockIdx.x * blockDim.x + threadIdx.x;\n    // If kernel block/grid is not sized perfectly make sure not to step outside data bounds\n    if(row &lt; rows &amp;&amp; col &lt; cols)\n    {\n        int idx = row*cols + col;\n        c[idx] = a[idx] + b[idx];\n    }\n}\n\nint main() {\n    // m3 = m1 + m2 using cuda\n    int rows = 5, cols = 5, total = rows * cols;\n    Matrix&lt;TYPE&gt; m1{ rows,cols }, m2{ rows,cols }, m3{ rows,cols };\n\n    // Initialization as 1D array\n    for(int i = 0; i &lt; total; i++)  {\n        m1.data[i] = i;\n    }\n\n    // Or initialization as 2D array\n    for(int r = 0; r &lt; rows; r++)\n        for(int c = 0; c &lt; cols; c++)\n            m2[r][c] = r*cols + c + 100;\n\n    for(int i = 0; i &lt; total; i++)  std::cout &lt;&lt; m1.data[i] &lt;&lt; \", \";\n    std::cout &lt;&lt; \"\\n\";\n\n    for(int r = 0; r &lt; rows; r++) {\n        for(int c = 0; c &lt; cols; c++) \n            std::cout &lt;&lt; m2[r][c] &lt;&lt; \", \";\n        std::cout &lt;&lt; \"\\n\";\n    }\n\n    // CUDA part\n    TYPE *d_m1, *d_m2, *d_m3;\n\n    // Allocation\n    cudaMalloc((void **) &amp;d_m1, total * sizeof(TYPE));\n    cudaMalloc((void **) &amp;d_m2, total * sizeof(TYPE));\n    cudaMalloc((void **) &amp;d_m3, total * sizeof(TYPE));\n\n    // Copy m1 and m2 to GPU\n    cudaMemcpy(d_m1, m1.data, total * sizeof(TYPE), cudaMemcpyHostToDevice);\n    cudaMemcpy(d_m2, m2.data, total * sizeof(TYPE), cudaMemcpyHostToDevice);\n\n    // Oversized on purpose to show row/col guard on add kernel\n    dim3 grid(5, 5);\n    dim3 block(5, 5);\n    add &lt;&lt;&lt; grid, block &gt;&gt;&gt; (d_m1, d_m2, d_m3, rows, cols);\n\n    // Copy result to m3\n    cudaMemcpy(m3.data, d_m3, total * sizeof(TYPE), cudaMemcpyDeviceToHost);\n\n    cudaFree(d_m1);\n    cudaFree(d_m2);\n    cudaFree(d_m3);\n\n    for(int r = 0; r &lt; rows; r++) {\n        for(int c = 0; c &lt; cols; c++)\n            std::cout &lt;&lt; m3[r][c] &lt;&lt; \", \";\n        std::cout &lt;&lt; \"\\n\";\n    }\n\n    system(\"pause\");\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 596, "user_id": 6515468, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/121c092728150c1e63825411faf17696?s=128&d=identicon&r=PG&f=1", "display_name": "the_martian", "link": "https://stackoverflow.com/users/6515468/the-martian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1543398475, "creation_date": 1543385030, "last_edit_date": 1543386796, "question_id": 53513095, "link": "https://stackoverflow.com/questions/53513095/how-do-you-create-a-2d-array-in-cuda", "title": "How do you create a 2d array in cuda", "body": "<p>For practice, I'm working on making a simple matrix initialization program in cuda.  I made a little sequential version for reference as a starting point.  It just creates an n by m array and fills it with doubles.  I've been reading through other posts and documentation, but I'm pretty confused and I was hoping someone could explain to me how to initialize a 2d array in cuda in a similar manner of n by m size as I did below.  I would also appreciate insight on how to fill that cuda matrix if anyone would be willing to explain.</p>\n\n<p>Hi again, in regards to it being a possible duplicate, I should elaborate. The linked post doesn't really explain anything, it's just sample code and it's one of the posts that I previously viewed but don't understand because it isn't explained.  Thank you. </p>\n\n<p>Sequential version:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\n#include &lt;assert.h&gt;\n\nint n,m, i, j;\ndouble count;\n\nvoid update(int n, int m, double arr[][m]){\n  for(i=0; i&lt;n; i++){\n    for(j=0; j&lt;m; j++){\n      count++;\n      arr[i][j] = count;\n    }\n  }\n}\n\n\nint main(int argc, char * argv[]) {\n  assert(argc==3);\n  n = atoi(argv[2]);\n  m = atoi(argv[1]);\n\n  double (*arr)[n][m] = malloc(sizeof *arr);\n  update(n,m,arr);\n  return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "bash", "getopt"], "comments": [{"owner": {"reputation": 95060, "user_id": 89817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df253c3b6533949ea94f31f328f3e769?s=128&d=identicon&r=PG", "display_name": "Gordon Davisson", "link": "https://stackoverflow.com/users/89817/gordon-davisson"}, "edited": false, "score": 3, "creation_date": 1543385556, "post_id": 53512859, "comment_id": 93895436, "body": "This is a highly nonstandard option syntax; if you really want that, you&#39;ll pretty much have to write the parsing code yourself. I&#39;m not sure why you want this, but I&#39;d recommend trying to find a more standard way to accomplish the actual goal."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1543386899, "post_id": 53512859, "comment_id": 93895972, "body": "There are argument parsers that&#39;ll handle that (I&#39;ve written one of them, but it isn&#39;t generally available), but they&#39;re few and far between.  Most programs that use that technique for handling arguments also hand-code the argument parsing loop.  I don&#39;t think that&#39;s a good idea.  So, as already stated, it isn&#39;t normal.  However, I wrote my parser to match the requirements of some perfectly horrible hand-coded argument parsing, and that was one of the requirements."}], "answers": [{"tags": [], "owner": {"reputation": 767708, "user_id": 14860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vXG1F.png?s=128&g=1", "display_name": "paxdiablo", "link": "https://stackoverflow.com/users/14860/paxdiablo"}, "is_accepted": false, "score": 1, "last_activity_date": 1543387351, "creation_date": 1543387351, "answer_id": 53513580, "question_id": 53512859, "link": "https://stackoverflow.com/questions/53512859/getopt-a-flag-using-with-multiple-optargs/53513580#53513580", "title": "Getopt: A flag using with multiple optargs", "body": "<p>The standard <code>getopt</code> stuff has no way to do this, it allows for single-argument additions to an option (with <code>:</code>) like <code>-cfoo</code> (part of the option argument) or <code>-c foo</code> (in the next argument). This can also be optional if you use <code>::</code> though I believe it then has to be an extension of the option argument itself, not a separate argument.</p>\n\n<p>It has no way to take more than one argument after the option argument and combine them into a single option. You can surround them with quotes to force it into a <em>single</em> argument, such as:</p>\n\n<pre><code>-c \"foo bar\"\n</code></pre>\n\n<p>but that won't remove the spaces. Of course, there's nothing to stop you specifying <em>directly</em> what you seem to want, with a slightly modified:</p>\n\n<pre><code>-c foobar\n</code></pre>\n\n<p>In other words, I'm not clear why you actually <em>need</em> them to be separate, especially since you're going to combine them anyway.</p>\n\n<p>No doubt you could <em>modify</em> <code>getopt</code> to do this such as allowing for something like <code>abc[2,collapse]</code> (rather than <code>abc:</code>) to specify that <code>-c</code> needs two arguments which should have spaces removed between them. But that seems like a fair bit of work for something it may just be easier to work around.</p>\n"}], "owner": {"reputation": 31, "user_id": 10464676, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-e_s5ZxMwnww/AAAAAAAAAAI/AAAAAAAAASU/iwFVp8adcKE/photo.jpg?sz=128", "display_name": "Gosh Darn", "link": "https://stackoverflow.com/users/10464676/gosh-darn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 122, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1543387351, "creation_date": 1543383787, "question_id": 53512859, "link": "https://stackoverflow.com/questions/53512859/getopt-a-flag-using-with-multiple-optargs", "title": "Getopt: A flag using with multiple optargs", "body": "<p>How can I use two arguments for one flag?</p>\n\n<p>For example:</p>\n\n<pre><code>./xampl -c foo bar\n</code></pre>\n\n<p>would return:</p>\n\n<pre><code>foobar\n</code></pre>\n\n<p>I've looked a the source code of gnu cat and freebsd ls, but could not find any leads</p>\n\n<p>I'm a C novice and a competent bash scripter. </p>\n"}, {"tags": ["c", "scanf", "strtok"], "comments": [{"owner": {"reputation": 44820, "user_id": 4492932, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e8938ef2681650e100bc9f83434ef272?s=128&d=identicon&r=PG", "display_name": "DYZ", "link": "https://stackoverflow.com/users/4492932/dyz"}, "edited": false, "score": 1, "creation_date": 1543382415, "post_id": 53512597, "comment_id": 93894426, "body": "Don&#39;t. Use <code>fgets</code> + <code>strtok</code> or <code>strsep</code>. <a href=\"https://stackoverflow.com/questions/53494091/read-consecutive-tabs-as-empty-field-fscanf\">Possible dupe</a>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1543383241, "post_id": 53512597, "comment_id": 93894631, "body": "suggest using <code>fgets()</code> to read the whole line, then using <code>sscanf()</code> to extract the fields.  To determine if some field is missing, always check the returned value from <code>fscanf()</code>/<code>sscanf()</code>   Note: use the returned value, not the parameter values.  There are much better ways to obtain the integer value than <code>atoi()</code>   for instance <code>strtol()</code>"}], "answers": [{"comments": [{"owner": {"reputation": 1927, "user_id": 1437138, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/b4b0218d953886fed95ef07799da6580?s=128&d=identicon&r=PG", "display_name": "Smith Dwayne", "link": "https://stackoverflow.com/users/1437138/smith-dwayne"}, "edited": false, "score": 0, "creation_date": 1543454649, "post_id": 53512991, "comment_id": 93929464, "body": "<code>\\the n</code> is a typing error. Now I edited that statement. My question is, reading the fields and load it to structure object as per the respective types. Each record of the file will have only 4 fields i.e., three <code>\\t</code> characters. If all fields are filled, <code>fscanf</code> itself fill the structure fields associated by the type specifier format. If I use &#39;strtok` or some other string separation function, I definitly use functions like <code>atoi()</code> to load `age&#39; of Person. I don&#39;t want to use that type conversion functions."}], "tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": false, "score": 2, "last_activity_date": 1543469912, "last_edit_date": 1543469912, "creation_date": 1543384379, "answer_id": 53512991, "question_id": 53512597, "link": "https://stackoverflow.com/questions/53512597/reading-tab-delimited-record-using-fscanf/53512991#53512991", "title": "Reading tab delimited record using fscanf", "body": "<h3>Original format</h3>\n\n<p>The <code>%s</code> conversion specification skips any white space (blanks, tabs, newlines, etc) in the input, and then reads non-white-space up to the next white space character.  The <code>\\t</code> appearing in the format string causes <code>fscanf()</code> to skip zero or more white space characters (not just tabs).</p>\n\n<p>You have:</p>\n\n<pre><code>fscanf(fPtr,\"%s\\t%d\\t%s\\t%s\\the n\", pObj-&gt;name, pObj-&gt;age, pObj-&gt;country, pObj-profile);\n</code></pre>\n\n<p>You need to pass a pointer to the age and you need an arrow <code>-&gt;</code> between <code>pObj</code> and <code>profile</code> (please post code that could compile; it doesn't inspire confidence when there are errors like this):</p>\n\n<pre><code>fscanf(fPtr,\"%s\\t%d\\t%s\\t%s\\the n\", pObj-&gt;name, &amp;pObj-&gt;age, pObj-&gt;country, pObj-&gt;profile);\n</code></pre>\n\n<p>Given the first input line:</p>\n\n<pre><code>Newton  30  United Kingdom  Scientist\n</code></pre>\n\n<p><code>fscanf()</code> will read <code>Newton</code> into <code>pObj-&gt;name</code>, <code>30</code> into <code>pObj-&gt;age,</code>United<code>into</code>pObj->country<code>and</code>Kingdom<code>into</code>pObj->profile<code>.</code>fscanf()` and family are very casual about white space, in general.  Most conversions skip leading white space.</p>\n\n<p>After the 4 values are assigned, you have <code>\\the n\"</code> at the end of the format.  The tab skips the white space between <code>Kingdom</code> and <code>Scientist</code>, but the data doesn't match <code>he n</code>, so the scanning stops \u2014 not that you're any the wiser for that.</p>\n\n<p>The next operation will pick up where this one stopped, so the next <code>pObj-&gt;name</code> will be assigned <code>Scientist</code> and then the <code>pObj-&gt;age</code> conversion will fail because <code>Maxwell</code> doesn't represent an integer.  The conversions stop there on that <code>fscanf()</code>.</p>\n\n<p>And so the problems continue.  Your claimed output can't be attained with the code you show in the question.</p>\n\n<p>If you're adamant that you must use <code>fscanf()</code>, you'll need to use scan sets such as <code>%24[^\\t]</code> to read the country.  But you'd do better using <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/fgets.html\" rel=\"nofollow noreferrer\"><code>fgets()</code></a> or POSIX function <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/getline.html\" rel=\"nofollow noreferrer\"><code>getline()</code></a> to read whole lines of input, and then perhaps use <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/sscanf.html\" rel=\"nofollow noreferrer\"><code>sscanf()</code></a> but more likely use <code>strcspn()</code> or <code>strpbrk()</code> from Standard C (or perhaps <code>strtok()</code> or \u2014 far better \u2014 POSIX <code>strtok_r()</code> or Windows <code>strtok_s()</code>, or non-standard <code>strsep()</code>) to split the line into fields at tabs.  Note that <code>strtok_r()</code> et al don't care how many repeats there are of the delimiter (tabs in your case) between the fields; you can't have empty fields with them.  You can identify empty fields with <code>strcspn()</code>, <code>strpbrk()</code> and <code>strsep()</code>.</p>\n\n<hr>\n\n<h3>Cleaned up format</h3>\n\n<p>The format string has been revised to:</p>\n\n<pre><code>fscanf(fPtr,\"%s\\t%d\\t%s\\t%s\\n\", pObj-&gt;name, &amp;pObj-&gt;age, pObj-&gt;country, pObj-&gt;profile);\n</code></pre>\n\n<p>This won't work, but can now be adapted so it will work.</p>\n\n<pre><code>if (fscanf(fPtr,\" %49[^\\t]\\t%d\\t%24[^\\t]\\t%19[^\\n]\", pObj-&gt;name, &amp;pObj-&gt;age, pObj-&gt;country, pObj-&gt;profile) != 4)\n    \u2026handle a format error\u2026\n</code></pre>\n\n<p><a href=\"https://stackoverflow.com/questions/19499060/what-is-the-effect-of-trailing-white-space-in-a-scanf-format-string\">Beware trailing white space in <code>scanf()</code> format strings</a>.  The leading blank skips any newline left over from previous lines, and skips any leading white space on a line.  The <code>%49[^\\t]</code> looks for up to 49 non-tabs; the tab is optional and matches any sequence of white space, but the first character will be a tab unless the name was too long.  Then it reads a number, more optional white space (it doesn't have to be a tab, but it will be unless the data is malformatted), then up to 24 non-tabs, white space again (of which the first character will be a tab unless there's a formatting problem), and up to 19 non-tabs.  The next character should be a newline, unless there's a formatting problem.</p>\n"}], "owner": {"reputation": 1927, "user_id": 1437138, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/b4b0218d953886fed95ef07799da6580?s=128&d=identicon&r=PG", "display_name": "Smith Dwayne", "link": "https://stackoverflow.com/users/1437138/smith-dwayne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1446, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1543469912, "creation_date": 1543382266, "last_edit_date": 1543469410, "question_id": 53512597, "link": "https://stackoverflow.com/questions/53512597/reading-tab-delimited-record-using-fscanf", "title": "Reading tab delimited record using fscanf", "body": "<p>Data file:</p>\n\n<pre><code>Newton  30  United Kingdom  Scientist\nMaxwell 25  United Kingdom  Mathematician\nEdison  60  United States   Engineer\n</code></pre>\n\n<p>Code to read it:</p>\n\n<pre><code>#define MAX_NAME    50\n#define MAX_COUNTRY 25\n#define MAX_PROFILE 20\nstruct person\n{\n    char *name;\n    int age;\n    char *country;\n    char *profile;\n};\n\nstruct person pObj;\npObj-&gt;name = (char *) malloc(sizeof(MAX_NAME));\npObj-&gt;country = (char *) malloc(sizeof(MAX_COUNTRY));\npObj-&gt;profile = (char *) malloc(sizeof(MAX_PROFILE));\n\nfscanf(fPtr,\"%s\\t%d\\t%s\\t%s\\n\",pObj-&gt;name,&amp;pObj-&gt;age,pObj-&gt;country,pObj-&gt;profile);\n</code></pre>\n\n<p>I wrote a program to read tab delimited record to a structure using <code>fscanf()</code>. Same thing I can do by <code>strtok()</code>, <code>strsep()</code> functions also. But If I use <code>strtok()</code>, I forced to use <code>atoi()</code> function to load <code>age</code> field. But I don't want to use that <code>atoi()</code> function. So I simply used <code>fscanf()</code> to read age as Integer directly from the FILE stream buffer. It works fine. BUT for some record, country field is empty as like below.</p>\n\n<pre><code>Newton  30  United Kingdom  Scientist\nMaxwell 25      Mathematician\nEdison  60  United States   Engineer\n</code></pre>\n\n<p>When I read the second record, <code>fscanf()</code> doesn't fill empty string to the country field instead it has been filled with profile data. We understand <code>fscanf()</code> works that way. But is it there any option to scan the country field even though it is empty in the file? Can I do this without using <code>atoi()</code> function for age? i.e., reading fields by that respective types but not all the fields as strings.</p>\n"}, {"tags": ["c", "typedef"], "comments": [{"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 3, "creation_date": 1543383191, "post_id": 53512585, "comment_id": 93894611, "body": "It is as fine as MSVC is a fine C compiler, i.e. not fine at all."}], "answers": [{"comments": [{"owner": {"reputation": 6828, "user_id": 8990329, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f073ad236ccf499ebfbe504bc79a2096?s=128&d=identicon&r=PG&f=1", "display_name": "Some Name", "link": "https://stackoverflow.com/users/8990329/some-name"}, "edited": false, "score": 0, "creation_date": 1543382595, "post_id": 53512642, "comment_id": 93894466, "body": "So reasonable to ask if it is Standardized?"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "reply_to_user": {"reputation": 6828, "user_id": 8990329, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f073ad236ccf499ebfbe504bc79a2096?s=128&d=identicon&r=PG&f=1", "display_name": "Some Name", "link": "https://stackoverflow.com/users/8990329/some-name"}, "edited": false, "score": 0, "creation_date": 1543382750, "post_id": 53512642, "comment_id": 93894507, "body": "@SomeName it was, 3 decades ago and has not been for 2 decades."}, {"owner": {"reputation": 6828, "user_id": 8990329, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f073ad236ccf499ebfbe504bc79a2096?s=128&d=identicon&r=PG&f=1", "display_name": "Some Name", "link": "https://stackoverflow.com/users/8990329/some-name"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1543382828, "post_id": 53512642, "comment_id": 93894532, "body": "@AnttiHaapala So now the behavior is undefined or implementation defined?"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "reply_to_user": {"reputation": 6828, "user_id": 8990329, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f073ad236ccf499ebfbe504bc79a2096?s=128&d=identicon&r=PG&f=1", "display_name": "Some Name", "link": "https://stackoverflow.com/users/8990329/some-name"}, "edited": false, "score": 2, "creation_date": 1543382890, "post_id": 53512642, "comment_id": 93894549, "body": "@SomeName neither. A C99, C11, C17 compiler <b>must</b> diagnose this as an incorrect program."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 6828, "user_id": 8990329, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f073ad236ccf499ebfbe504bc79a2096?s=128&d=identicon&r=PG&f=1", "display_name": "Some Name", "link": "https://stackoverflow.com/users/8990329/some-name"}, "edited": false, "score": 0, "creation_date": 1543382943, "post_id": 53512642, "comment_id": 93894561, "body": "@SomeName The support itself for implicit int is removed, though it is still provided as compiler extension. Use strict mode , and your code should <b>fail to compile</b> in first place."}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": true, "score": 6, "last_activity_date": 1543384353, "last_edit_date": 1543384353, "creation_date": 1543382570, "answer_id": 53512642, "question_id": 53512585, "link": "https://stackoverflow.com/questions/53512585/what-does-typedef-with-no-type-mean/53512642#53512642", "title": "What does typedef with no type mean?", "body": "<p>This relies on the fact that, missing type specification defaults to <code>int</code>.</p>\n\n<p>So, your statement</p>\n\n<pre><code> typedef t;\n</code></pre>\n\n<p>is the same as</p>\n\n<pre><code> typedef int t;\n</code></pre>\n\n<p>With the proper level of warning, compiler emits warning:</p>\n\n<pre><code>warning: type defaults to \u2018int\u2019 in declaration of \u2018t\u2019 [-Wimplicit-int]\n typedef t;\n         ^\n</code></pre>\n\n<p>That said, <strong>do not</strong> rely on this behaviour, \"implicit int\" rule has been obsolete since <code>C99</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 1, "creation_date": 1543383549, "post_id": 53512648, "comment_id": 93894711, "body": "Please don&#39;t confuse readers by quoting now-outdated <code>C89</code>, not everyone may know about the applicability of the standards. :)"}, {"owner": {"reputation": 24693, "user_id": 10190237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f95f50f67af8a9658c5d76df263b323?s=128&d=identicon&r=PG&f=1", "display_name": "P.W", "link": "https://stackoverflow.com/users/10190237/p-w"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1543383609, "post_id": 53512648, "comment_id": 93894734, "body": "I did mention that it is not relevant from C99 onwards. But I can make it extra clear."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1543383902, "post_id": 53512648, "comment_id": 93894839, "body": "I would really appreciate if you move the positioning of the two blocks. <b>First</b>, mention about C99/C11 and then, about C89. Just my two cents."}, {"owner": {"reputation": 24693, "user_id": 10190237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f95f50f67af8a9658c5d76df263b323?s=128&d=identicon&r=PG&f=1", "display_name": "P.W", "link": "https://stackoverflow.com/users/10190237/p-w"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1543384133, "post_id": 53512648, "comment_id": 93894923, "body": "@SouravGhosh: Done."}], "tags": [], "owner": {"reputation": 24693, "user_id": 10190237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f95f50f67af8a9658c5d76df263b323?s=128&d=identicon&r=PG&f=1", "display_name": "P.W", "link": "https://stackoverflow.com/users/10190237/p-w"}, "is_accepted": false, "score": 3, "last_activity_date": 1543384120, "last_edit_date": 1543384120, "creation_date": 1543382591, "answer_id": 53512648, "question_id": 53512585, "link": "https://stackoverflow.com/questions/53512585/what-does-typedef-with-no-type-mean/53512648#53512648", "title": "What does typedef with no type mean?", "body": "<p>It defaults to an <code>int</code>.</p>\n\n<p>The compiler warning shows what is going on: </p>\n\n<pre><code>#1 with x86-64 gcc 8.2\n&lt;source&gt;:1:9: warning: type defaults to 'int' in declaration of 't' [-Wimplicit-int]\n typedef t;\n</code></pre>\n\n<p>From <strong>C99</strong> onwards, the <em>implicit</em> <code>int</code> rule was removed. So this is not applicable from C99  onward. </p>\n\n<p>If you use the <strong><code>-pedantic-errors</code></strong> compiler option in GCC (meaning strict conformity to the standard), <strong>it issues an error</strong>. See <a href=\"https://godbolt.org/z/Qs-cPb\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>If you are interested, the <a href=\"http://port70.net/~nsz/c/c89/c89-draft.html#3.5.2\" rel=\"nofollow noreferrer\">relevant section</a> in <strong>C89</strong> standard which allowed this:</p>\n\n<blockquote>\n  <p><strong>3.5.2 Type specifiers</strong><br>\n  Each list of type specifiers shall be one of the following sets; the type specifiers may occur in any order, possibly intermixed with the other declaration specifiers.</p>\n  \n  <ul>\n  <li>void</li>\n  <li>char</li>\n  <li>signed char</li>\n  <li>unsigned char</li>\n  <li>short , signed short , short int , or signed short int</li>\n  <li>unsigned short , or unsigned short int</li>\n  <li><strong>int , signed , signed int , or no type specifiers</strong></li>\n  </ul>\n</blockquote>\n\n<p>So in <strong>C99</strong>, the last part of what was bolded above (<strong>or no type specifiers</strong>) was removed. </p>\n"}, {"comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 1, "creation_date": 1543384511, "post_id": 53512972, "comment_id": 93895067, "body": "This is fine, but how does this answers the question?"}, {"owner": {"reputation": 58, "user_id": 10700755, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ff57bb8f76cb4cbfbaf6f1bb920af1d?s=128&d=identicon&r=PG&f=1", "display_name": "A. Semat", "link": "https://stackoverflow.com/users/10700755/a-semat"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1543385242, "post_id": 53512972, "comment_id": 93895320, "body": "@Sourav Ghosh I felt that the <code>typedef</code> syntax was new to him, so I give him some basic examples with comments. Other answers already addressed the compilation problem in itself."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1543398781, "post_id": 53512972, "comment_id": 93902009, "body": "Please don&#39;t invent your own terms and grammar that don&#39;t even exist in the C language. There are no syntax items called &quot;base-type&quot; or &quot;type-alias&quot;."}, {"owner": {"reputation": 58, "user_id": 10700755, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ff57bb8f76cb4cbfbaf6f1bb920af1d?s=128&d=identicon&r=PG&f=1", "display_name": "A. Semat", "link": "https://stackoverflow.com/users/10700755/a-semat"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1543400948, "post_id": 53512972, "comment_id": 93903313, "body": "@Lundin. Thanks. I should have specified that <code>base-type</code> and <code>type-alias</code> should have been replaced by actual types and names. Moreover that pseudo-syntax didn&#39;t suit function types. I also changed <code>alias</code> to <code>synonym</code>, since the C standards refers to typedef names as such."}], "tags": [], "owner": {"reputation": 58, "user_id": 10700755, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ff57bb8f76cb4cbfbaf6f1bb920af1d?s=128&d=identicon&r=PG&f=1", "display_name": "A. Semat", "link": "https://stackoverflow.com/users/10700755/a-semat"}, "is_accepted": false, "score": 0, "last_activity_date": 1543523901, "last_edit_date": 1543523901, "creation_date": 1543384294, "answer_id": 53512972, "question_id": 53512585, "link": "https://stackoverflow.com/questions/53512585/what-does-typedef-with-no-type-mean/53512972#53512972", "title": "What does typedef with no type mean?", "body": "<p>A <code>typedef</code> declaration defines a synonym for an object or pointer type. So you should specify both the type for which you want to create a synonym, and a name to use as synonym.</p>\n\n<p>For example:\n</p>\n\n<pre><code>// 'byte_t' is a synonym for 'unsigned char'\ntypedef unsigned char byte_t;\n// 'handler_t' is a synonym for 'void (*)(int)', a function pointer\ntypedef void (*handler_t)(int);\n// 'short_p' is a synonym for 'short *'\ntypedef short * short_p;\n// 'record' is a synonym for an anonymous structure\ntypedef struct {\n    int a;\n    char *b;\n    } record;\n// 'error_p' is a synonym for a pointer to 'struct error', defined somewhere else\ntypedef struct error *error_p;\n</code></pre>\n\n<p>Many more examples in the source you cited.</p>\n"}], "owner": {"reputation": 6828, "user_id": 8990329, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f073ad236ccf499ebfbe504bc79a2096?s=128&d=identicon&r=PG&f=1", "display_name": "Some Name", "link": "https://stackoverflow.com/users/8990329/some-name"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 250, "favorite_count": 1, "accepted_answer_id": 53512642, "answer_count": 3, "score": 3, "last_activity_date": 1543524013, "creation_date": 1543382172, "last_edit_date": 1543524013, "question_id": 53512585, "link": "https://stackoverflow.com/questions/53512585/what-does-typedef-with-no-type-mean", "title": "What does typedef with no type mean?", "body": "<p>From the Standard <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf\" rel=\"nofollow noreferrer\">N1570</a> 6.7.8:</p>\n\n<blockquote>\n  <p>A <code>typedef</code> declaration does not introduce a new type, only a synonym\n  for the type so specified.</p>\n</blockquote>\n\n<p>So I expected that it is not possible to write something like this:</p>\n\n<pre><code>typedef t;\nt *t_ptr;\n</code></pre>\n\n<p>and it should fail to compile since no type to introduce a synonym to provided. But it is fine: <a href=\"https://godbolt.org/z/Gf8NMM\" rel=\"nofollow noreferrer\">Demo</a>. So what does this ever mean and why does it compile?</p>\n"}, {"tags": ["c", "lua", "programming-languages", "code-cleanup"], "comments": [{"owner": {"reputation": 4328, "user_id": 920069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd39f0db1f22e1314746491df063602a?s=128&d=identicon&r=PG", "display_name": "Retired Ninja", "link": "https://stackoverflow.com/users/920069/retired-ninja"}, "edited": false, "score": 2, "creation_date": 1543380995, "post_id": 53512380, "comment_id": 93894035, "body": "That code seems fine to me. This question seems rather opinion-based too."}, {"owner": {"reputation": 1476, "user_id": 9383219, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97fabe5d903589acb1dfdf17fe4e405e?s=128&d=identicon&r=PG&f=1", "display_name": "cyclaminist", "link": "https://stackoverflow.com/users/9383219/cyclaminist"}, "edited": false, "score": 1, "creation_date": 1543383980, "post_id": 53512380, "comment_id": 93894867, "body": "It&#39;s pretty normal and understandable C code, but it takes a while to learn how it works. I recently taught myself C. Actually, asterisks are not part of variable names; <code>char *</code> means &quot;pointer to char&quot; and the variable <code>p</code> is used in the line <code>p[i] = s[l - i - 1];</code>."}, {"owner": {"reputation": 1476, "user_id": 9383219, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97fabe5d903589acb1dfdf17fe4e405e?s=128&d=identicon&r=PG&f=1", "display_name": "cyclaminist", "link": "https://stackoverflow.com/users/9383219/cyclaminist"}, "edited": false, "score": 0, "creation_date": 1543384750, "post_id": 53512380, "comment_id": 93895143, "body": "C does not allow functions to directly return multiple values the way Lua does (<code>function () return 1, 2 end</code>), so when a function needs to return multiple values, pointers are often used. Because <code>checklstring</code> needs to return two values, a string and the length of the string, it uses a pointer, the third argument (<code>&amp;l</code>). See <a href=\"https://stackoverflow.com/questions/3829167/returning-multiple-values-from-a-function\">this question</a>."}], "answers": [{"comments": [{"owner": {"reputation": 683, "user_id": 5131441, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/787106924736589/picture?type=large", "display_name": "Trieu Nguyen", "link": "https://stackoverflow.com/users/5131441/trieu-nguyen"}, "edited": false, "score": 0, "creation_date": 1543460920, "post_id": 53517054, "comment_id": 93930709, "body": "Hi, thanks for your help, it answer my question. Can you help me understand the lua_State *L ?, i don&#39;t know how it is created and why it stores so many things inside it, it seems to store parameter for the function as well."}, {"owner": {"reputation": 2621, "user_id": 722238, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/52ad57e08b18f75e6aaaddd9a0cd59dc?s=128&d=identicon&r=PG&f=1", "display_name": "fbynite", "link": "https://stackoverflow.com/users/722238/fbynite"}, "reply_to_user": {"reputation": 683, "user_id": 5131441, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/787106924736589/picture?type=large", "display_name": "Trieu Nguyen", "link": "https://stackoverflow.com/users/5131441/trieu-nguyen"}, "edited": false, "score": 1, "creation_date": 1543480737, "post_id": 53517054, "comment_id": 93937234, "body": "When you call Lua from the command line, <code>lua_State</code> is created by the <code>lua</code> binary.  Check out  the <a href=\"https://stackoverflow.com/a/4201531/722238\">this answer</a> for <a href=\"https://stackoverflow.com/q/4201284/722238\">What is a Lua State?</a>."}], "tags": [], "owner": {"reputation": 2621, "user_id": 722238, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/52ad57e08b18f75e6aaaddd9a0cd59dc?s=128&d=identicon&r=PG&f=1", "display_name": "fbynite", "link": "https://stackoverflow.com/users/722238/fbynite"}, "is_accepted": true, "score": 3, "last_activity_date": 1543400209, "creation_date": 1543400209, "answer_id": 53517054, "question_id": 53512380, "link": "https://stackoverflow.com/questions/53512380/is-lua-source-code-written-in-clean-code/53517054#53517054", "title": "Is Lua source code written in clean code?", "body": "<p>When you don't know how something works, it's a reasonable conclusion that it may be written poorly. However, the code above is readable. I don't know anything about lua and not that much about C and I'm able to decipher what's going on.</p>\n\n<p>The first thing that might help you is to understand how <code>str_reverse</code> is called, fire up an interpreter:</p>\n\n<pre><code>&gt; str = \"foo\"         /* create a string in a lua state */\n&gt; string.reverse(str) /* indirectly invokes str_reverse */\noof                   /* result */\n</code></pre>\n\n<p>The first thing <code>str_reverse</code> does is call <a href=\"http://www.lua.org/source/5.2/lauxlib.c.html#luaL_checklstring\" rel=\"nofollow noreferrer\"><code>luaL_checklstring</code></a>, which is a wrapper function around <a href=\"http://www.lua.org/source/5.2/lapi.c.html#lua_tolstring\" rel=\"nofollow noreferrer\"><code>lua_tolstring</code></a> that adds error checking. In dialog:</p>\n\n<p><code>str_reverse</code> says to <code>luaL_checklstring</code>: </p>\n\n<p>\"Hey, I need a string - give me the address (stores it in <code>s</code>), also I need the length (stores it in <code>l</code>).\"</p>\n\n<p><code>luaL_checklstring</code> says: \"yep, all is good - here ya go!\"</p>\n\n<p>You see, the C language needs to know the size of everything so it can allocate the proper amount of memory. Since <code>str_reverse</code> needs to allocate memory for the reversed string (more precisely, <code>luaL_Buffer b</code> will need to be resized if it's not large enough to accommodate the string), it tells <code>luaL_checklstring</code> to give the length as well. If <code>str_reverse</code> didn't care about the length <code>NULL</code> would be passed instead of <code>l</code>. This is how the Lua API is designed - seems readable to me.</p>\n\n<p><code>p</code> doesn't store the value of the string - the reversed string is stored in <code>b</code>, as a member. <code>p</code> is basically a shortcut, consider the following:</p>\n\n<pre><code>/* disregard the pointer returned by buffinitsize */\nluaL_buffinitsize(L, &amp;b, l);\nfor (i = 0; i &lt; l; i++)\n    b-&gt;b[i] = s[l - i - 1];\n</code></pre>\n\n<p>The above code <em>should</em> work the same. Except now, the gory details of the <code>luaL_Buffer</code> are exposed...not great.</p>\n\n<p>You need to read up on pointers. You'll never fully understand C if you don't understand pointers, it'd be like walking with no feet.</p>\n\n<p>Anyway, It sucks you're being down-voted so much, it's probably the title you chose for your question - it sounds like you're bashing Lua. Aside from that, your question seems genuine - good luck and have fun in your adventures of reading other people's code! </p>\n"}], "owner": {"reputation": 683, "user_id": 5131441, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/787106924736589/picture?type=large", "display_name": "Trieu Nguyen", "link": "https://stackoverflow.com/users/5131441/trieu-nguyen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 525, "favorite_count": 0, "closed_date": 1543399049, "accepted_answer_id": 53517054, "answer_count": 1, "score": -2, "last_activity_date": 1543461835, "creation_date": 1543380828, "last_edit_date": 1543461835, "question_id": 53512380, "link": "https://stackoverflow.com/questions/53512380/is-lua-source-code-written-in-clean-code", "closed_reason": "Opinion-based", "title": "Is Lua source code written in clean code?", "body": "<p>I was reading the <a href=\"http://www.lua.org/source/5.2/\" rel=\"nofollow noreferrer\">source code of the Lua</a> programming language lately and found some of the conventions unclear or confusing.  For example, the str_reverse function in <a href=\"http://www.lua.org/source/5.2/lstrlib.c.html\" rel=\"nofollow noreferrer\">this file</a>.  Is it considered as clean code and understandable code in C ?</p>\n\n<pre><code>static int str_reverse (lua_State *L) {\n   size_t l, i;\n   luaL_Buffer b;\n   const char *s = luaL_checklstring(L, 1, &amp;l);\n   char *p = luaL_buffinitsize(L, &amp;b, l);\n   for (i = 0; i &lt; l; i++)\n       p[i] = s[l - i - 1];\n   luaL_pushresultsize(&amp;b, l);\n   return 1;\n}\n</code></pre>\n\n<p>In these lines:</p>\n\n<pre><code>char *p = luaL_buffinitsize(L, &amp;b, l);\nfor (i = 0; i &lt; l; i++)\n   p[i] = s[l - i - 1];\n</code></pre>\n\n<p>*p is created to store the value of string after being reversed. After that, i don't see it is used anywhere else. Then looking into <code>char *p = luaL_buffinitsize(L, &amp;b, l);</code>, it shows that *p is a property of <code>luaL_Buffer b;</code>, which is now making sense why *p is not used anymore, because in the next line, <code>b</code> is in use</p>\n\n<p>Also, in this line <code>const char *s = luaL_checklstring(L, 1, &amp;l);</code>, this <code>luaL_checklstring</code> function return <code>*s</code>, but also, assign length of string(got from L) to <code>size_t l</code> variable. So this function not only return 1 variable and but also change 1 variable along its way.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1543379308, "post_id": 53512115, "comment_id": 93893616, "body": "No this is not possible by any tricks"}, {"owner": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "edited": false, "score": 6, "creation_date": 1543379496, "post_id": 53512115, "comment_id": 93893666, "body": "I disagree a tiny bit on that.  The offsets could be stored in an array somewhere and then used to lookup a member, <i>but</i> you still need to know that member&#39;s type <i>and</i> it&#39;s less efficient <i>and</i> it&#39;ll annoy every other C programmer who comes in contact with your code.  A good counter-question is <i>why do you want to do this</i>?"}, {"owner": {"reputation": 552, "user_id": 9900911, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/693018196257bd546178b53a34149b45?s=128&d=identicon&r=PG&f=1", "display_name": "armitus", "link": "https://stackoverflow.com/users/9900911/armitus"}, "edited": false, "score": 0, "creation_date": 1543380907, "post_id": 53512115, "comment_id": 93894005, "body": "Be advised that theoretically, a C compiler could add padding to promote a better addressing scheme for your struct. The article below recommends you use the <code>#pragma pack(push, 1)</code> and <code>#pragma pack(pop)</code> pre-processor directives to selectively avoid padding.    [1]: <a href=\"https://metricpanda.com/rival-fortress-update-35-avoiding-automatic-structure-padding-in-c\" rel=\"nofollow noreferrer\">metricpanda.com/&hellip;</a>"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 552, "user_id": 9900911, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/693018196257bd546178b53a34149b45?s=128&d=identicon&r=PG&f=1", "display_name": "armitus", "link": "https://stackoverflow.com/users/9900911/armitus"}, "edited": false, "score": 1, "creation_date": 1543386741, "post_id": 53512115, "comment_id": 93895914, "body": "@armitus: IMNSHO you&#39;ll normally do better to avoid tinkering with the packing."}, {"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1543387736, "post_id": 53512115, "comment_id": 93896331, "body": "Do I recall correctly it is OK to access the first member through a pointer to struct (with proper casting)? That would mean that the code as presented is not wrong, apart from the wrong pointer type passed to sscanf (because it&#39;s lacking a cast)."}, {"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1543388103, "post_id": 53512115, "comment_id": 93896486, "body": "One way to do this is to use C++ and overload <code>operator[]</code> for the struct. That exposes an underlying logical issue though that you encounter with any tricky solution in C as well: You have elements of different types (and thus the return types of the index operation are different, and you need different printf formats). You&#39;ll need a distinct function <i>for  every type</i>, i.e. you would have to know what type an element at a given index is, anyway. In that case you can as well just obtain it by name. There is a reason that indexing is only supported for arrays (with homogeneous elements)."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1543409644, "post_id": 53512115, "comment_id": 93908439, "body": "If all members are of the same type, and only then, you can use a union with an array and with the individual members. Just be careful with alignment."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1543410060, "post_id": 53512115, "comment_id": 93908685, "body": "@PeterA.Schneider: Yes, C has a rule that a pointer to a struct, suitably converted, points to its first member, and vice-versa. However, <code>idx[0]</code> is not a pointer. What should be passed to that <code>scanf</code> in that case is <code>(char **) idx</code> (convert the pointer to a struct to a pointer to the first element, which is itself a pointer to <code>char</code>)."}, {"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1543411419, "post_id": 53512115, "comment_id": 93909493, "body": "@EricPostpischil You are right with &quot;not a pointer&quot;, but one needs to dereference the double pointer, e.g. say  <code>sscanf(cur,&quot;%s&quot;,*(char **)idx);</code>. <code>(char **)idx</code> is a <i>pointer</i> to the first object in the struct which happens to be a <code>char*</code>, as you say correctly. But you can&#39;t pass <i>that</i> to scanf: scanf expects the address of a buffer to read from. We would normally just pass <code>idx-&gt;fcode</code>, and since <code>(char **)idx</code> is <code>&amp;idx-&gt;fcode</code>, we must dereference it. (That would not be necessary if <code>fcode</code>were a true char array.)"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1543385620, "post_id": 53512733, "comment_id": 93895470, "body": "<i>platform specific implementation</i> \u2013 What you do is not just platform specific but a sure fired way to shoot yourself in the foot sooner or later (hey, who needs a gun when there is C?). I suggest you read some of Linus rants about gcc and strict aliasing. Yes, it might work but it also might not work, it might stop working with the next compiler version, it might cause you endless pain debugging."}, {"owner": {"reputation": 656, "user_id": 9592917, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fe6504c31f4954495f952699592361a?s=128&d=identicon&r=PG&f=1", "display_name": "Bwebb", "link": "https://stackoverflow.com/users/9592917/bwebb"}, "reply_to_user": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1543525171, "post_id": 53512733, "comment_id": 93961551, "body": "@Swordfish I literally put this as the answer:  As the comments mention this is a bad idea, bad practice, not portable from 32/64 bit pointers, horrible to read/etc"}, {"owner": {"reputation": 656, "user_id": 9592917, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fe6504c31f4954495f952699592361a?s=128&d=identicon&r=PG&f=1", "display_name": "Bwebb", "link": "https://stackoverflow.com/users/9592917/bwebb"}, "reply_to_user": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1543525719, "post_id": 53512733, "comment_id": 93961762, "body": "@Swordfish Then i ended the answer with: &quot;Actually, dont ever do this&quot;.  Can anyone clarify why i got the thumbs down?  I understand its a stupid idea, and made that clear in my answer.  I didnt ask the original question."}, {"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 1, "creation_date": 1543528433, "post_id": 53512733, "comment_id": 93962897, "body": "You are right. You shouldn&#39;t be punished for writing a stupid answer to a stupid question. I had to edit your answer before I was able to remove my thumbs-down."}, {"owner": {"reputation": 656, "user_id": 9592917, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fe6504c31f4954495f952699592361a?s=128&d=identicon&r=PG&f=1", "display_name": "Bwebb", "link": "https://stackoverflow.com/users/9592917/bwebb"}, "reply_to_user": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1543528612, "post_id": 53512733, "comment_id": 93962987, "body": "@Swordfish Thank you for reconsidering.  As a note to future readers, the struct name has been changed but the references to the struct in main have not been changed.  If future person tries to copy/paste this sample/crap code it will fail, change the struct references to match the new tag_index name in main, or change the struct name back to tindex.  Really no one should write code like this anyways so im not gonna bother to fix it."}, {"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1543528927, "post_id": 53512733, "comment_id": 93963096, "body": "Changed it back. Didn&#39;t realize it wasn&#39;t a typedef. You could have edited yourself instead of writing that note, though."}], "tags": [], "owner": {"reputation": 656, "user_id": 9592917, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fe6504c31f4954495f952699592361a?s=128&d=identicon&r=PG&f=1", "display_name": "Bwebb", "link": "https://stackoverflow.com/users/9592917/bwebb"}, "is_accepted": false, "score": 0, "last_activity_date": 1543528882, "last_edit_date": 1543528882, "creation_date": 1543383101, "answer_id": 53512733, "question_id": 53512115, "link": "https://stackoverflow.com/questions/53512115/c-access-members-of-struct-using-index/53512733#53512733", "title": "C-Access Members of Struct using index", "body": "<p>Any pointer arithmetic youre using will increase by the sizeof the stuct, so you would need to know how many bytes you need, and cast it to unsigned char * before trying to index into it.  As the comments mention this is a bad idea, bad practice, not portable from 32/64 bit pointers, horrible to read/etc.  That being said it can be done with a platform specific implementation</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nstruct tindex \n{\n  char* fcode;\n  char* fdesc;\n  int fstartidx;\n  int fsize;\n  char* ftype;\n  char* precision;\n  char* fcons;\n  char* notnull;\n  char* ronly;\n  char* wdth;\n  char* res2;\n  char* cel;\n  char* flr;\n};\n\nint main(void) {\n  struct tindex *idx= (struct tindex*)malloc(sizeof(struct tindex));\n  idx-&gt;fstartidx = 42;\n\n  //a more intereting example, base_address[1] will always increment by 1 byte (for example) when you try to implememtn other members\n  unsigned char * base_address = (unsigned char *)idx;\n  int * why_do_this = (int *)(base_address + 2*sizeof(char*));\n  *why_do_this = 43;\n\n  printf(\"First some sizes: sizeof struct=%zu \\t sizeof char *=%zu\\t  2*sizeof(char*)=0x%04x\\n\", sizeof(struct tindex), sizeof(char*), 2*sizeof(char*));\n  printf(\"Starting address %p, new offset %p, delta 0x%04x should be 2* sizeof char *\\n\", idx, why_do_this, (int)why_do_this - (int)idx);\n  printf(\"The intfstart index value should be %d which actually is now %d\", *why_do_this, idx-&gt;fstartidx); //the intfstart index\n  return 0;\n}\n</code></pre>\n\n<p>Compiled and tested on codechef.com/ide has the following output:</p>\n\n<pre><code>First some sizes: sizeof struct=96   sizeof char *=8     2*sizeof(char*)=0x0010\nStarting address 0x5573c0327010, new offset 0x5573c0327020, delta 0x0010 should be 2* sizeof char *\nThe intfstart index value should be 43 which actually is now 43\n</code></pre>\n\n<p>As some of the other comments suggest, if your struct is not packed down to the byte with <code>#pramga pack</code> you will have to account for padding.  Use the conventional ways to printf the addresses then make sure you \"index variables\" point to the same address.  </p>\n\n<p>Actually, dont ever do this at all unless your just curious.  Interesting question though so ill give it a thumbs up, even though its useless practically, from a theoretical answer this one was more interesting than some others ive tried to get rep from.</p>\n"}, {"tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": false, "score": 2, "last_activity_date": 1543409480, "creation_date": 1543409480, "answer_id": 53519917, "question_id": 53512115, "link": "https://stackoverflow.com/questions/53512115/c-access-members-of-struct-using-index/53519917#53519917", "title": "C-Access Members of Struct using index", "body": "<p>The goal you have requested is a Bad Idea, and there is almost certainly a better way of achieving the actual goal that motivated this notion.</p>\n\n<p>That said, one way of implementing this that is less bad than some others is to use an array of offsets as <a href=\"https://stackoverflow.com/users/1553090/paddy\">paddy</a> suggested:</p>\n\n<pre><code>struct tindex\n{\n    char* fcode;\n    char* fdesc;\n    int fstartidx;\n    int fsize;\n    char* ftype;\n    char* precision;\n    char* fcons;\n    char* notnull;\n    char* ronly;\n    char* wdth;\n    char* res2;\n    char* cel;\n    char* flr;\n};\n\n\n#include &lt;stddef.h&gt;\n\n\nvoid *LookupField(struct tindex *p, int index)\n{\n    static const size_t Offsets[] =\n    {\n        offsetof(struct tindex, fcode),\n        offsetof(struct tindex, fdesc),\n        offsetof(struct tindex, fstartidx),\n        offsetof(struct tindex, fsize),\n        offsetof(struct tindex, ftype),\n        offsetof(struct tindex, precision),\n        offsetof(struct tindex, fcons),\n        offsetof(struct tindex, notnull),\n        offsetof(struct tindex, ronly),\n        offsetof(struct tindex, wdth),\n        offsetof(struct tindex, res2),\n        offsetof(struct tindex, cel),\n        offsetof(struct tindex, flr),\n    };\n\n    return (char *) p + Offsets[index];\n}\n\n\n#include &lt;stdio.h&gt;\n\n\nint main(void)\n{\n    struct tindex t;\n    printf(\"%p = %p.\\n\", (void *) &amp;t.fcode, LookupField(&amp;t, 0));\n    printf(\"%p = %p.\\n\", (void *) &amp;t.fcons, LookupField(&amp;t, 6));\n    printf(\"%p = %p.\\n\", (void *) &amp;t.flr, LookupField(&amp;t, 12));\n}\n</code></pre>\n\n<p>Note that the address is returned only as a <code>void *</code> because there are different types in the structure. You still need some mechanism to handle the different types.</p>\n"}], "owner": {"reputation": 19, "user_id": 10705177, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cca12b6806e4bd8cb28dc9eed2f97a1?s=128&d=identicon&r=PG&f=1", "display_name": "Dhan", "link": "https://stackoverflow.com/users/10705177/dhan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1543528882, "creation_date": 1543379145, "last_edit_date": 1543387318, "question_id": 53512115, "link": "https://stackoverflow.com/questions/53512115/c-access-members-of-struct-using-index", "title": "C-Access Members of Struct using index", "body": "<p>I have a Structure defined which looks like this</p>\n\n<pre><code>struct tindex\n{\n  char* fcode;\n  char* fdesc;\n  int fstartidx;\n  int fsize;\n  char* ftype;\n  char* precision;\n  char* fcons;\n  char* notnull;\n  char* ronly;\n  char* wdth;\n  char* res2;\n  char* cel;\n  char* flr;\n};\n</code></pre>\n\n<p>I want to read the member of structure using index like</p>\n\n<pre><code>struct tindex *idx= (struct tindex*)malloc(sizeof(struct tindex));\nsscanf(cur,\"%s\",idx[0]); //Access first member of struct\n</code></pre>\n\n<p>Is this possible by using any tricks?</p>\n"}, {"tags": ["c", "recursion"], "comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1543379630, "post_id": 53511943, "comment_id": 93893693, "body": "Every recursive function has (1) an exit condition, and (2) a recursive call. You provide no exit condition. Further, you need <code>scanf(&quot;%d&quot;, &amp;n)</code> (note the <code>&#39;&amp;&#39;</code>) and you must validate the <b>return</b>, e.g. <code>if (scanf(&quot;%d&quot;, &amp;n) != 1) { &#47;* handle error *&#47; }</code>. Your call to <code>f(n);</code> is not a <code>&#47;&#47; Pointer for f</code> it is simply a function call (that makes little sense there). Think through how your set of recursive calls must exit. As it is the computation of <code>(x-3)+(x+5)</code> grows in size so <code>x &lt;= 0</code> cannot be the exit condition."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1543379765, "post_id": 53511943, "comment_id": 93893726, "body": "@DavidC.Rankin: The exit condition is <code>x &lt;= 0</code>. It seems you may have missed the fact that <code>f(x-3)</code> calls <code>f</code> and <code>(x+5)</code> does not."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1543379834, "post_id": 53511943, "comment_id": 93893747, "body": "Yes, I read it as <code>f (x-3 + x + 5)</code>."}], "answers": [{"comments": [{"owner": {"reputation": 658, "user_id": 4184843, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/euuGW.jpg?s=128&g=1", "display_name": "Canh", "link": "https://stackoverflow.com/users/4184843/canh"}, "edited": false, "score": 0, "creation_date": 1543379299, "post_id": 53512118, "comment_id": 93893612, "body": "Also, the <code>scanf</code> statement misses a <code>&amp;</code>"}], "tags": [], "owner": {"reputation": 552, "user_id": 9900911, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/693018196257bd546178b53a34149b45?s=128&d=identicon&r=PG&f=1", "display_name": "armitus", "link": "https://stackoverflow.com/users/9900911/armitus"}, "is_accepted": false, "score": 0, "last_activity_date": 1543379149, "creation_date": 1543379149, "answer_id": 53512118, "question_id": 53511943, "link": "https://stackoverflow.com/questions/53511943/recursive-function-equation/53512118#53512118", "title": "Recursive Function equation", "body": "<p>As a student of life, I am always willing to help a fellow academic:</p>\n\n<p>Your code has a few errors that should be of note:</p>\n\n<ol>\n<li><p><code>int f(int x)</code> has no return statement, even though it is expecting an integer. I assume you wish to return the result of the program (See Issue #3).</p></li>\n<li><p>You execute f(n) twice. First on line 12, then again on line 16. <code>printf(\"f(x) is %d\\n\", f(n));</code> actually executes F(n) in order to receive its return value to associate with the %d format specifier.</p></li>\n<li><p>You have not assigned <code>x+3</code> OR <code>f(x-3) + (x+5)</code> to any integer. These statements do not save the return values of f(x) that you need to return.</p></li>\n</ol>\n\n<p>This link may be of help to you:</p>\n\n<p><a href=\"https://www.geeksforgeeks.org/c-function-argument-return-values/\" rel=\"nofollow noreferrer\">https://www.geeksforgeeks.org/c-function-argument-return-values/</a></p>\n\n<p>Notice specifically how the output of functions are captured.</p>\n\n<p>Hope this helps (And I wish you academic success!)</p>\n"}, {"comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1543379794, "post_id": 53512193, "comment_id": 93893734, "body": "The additional <code>return ( ... )</code> parenthesis are superfluous, but good call on the function setup."}], "tags": [], "owner": {"reputation": 3310, "user_id": 1853605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2ab8d886abc51e874c1ed067b912ddd?s=128&d=identicon&r=PG", "display_name": "Potato", "link": "https://stackoverflow.com/users/1853605/potato"}, "is_accepted": false, "score": 2, "last_activity_date": 1543379649, "creation_date": 1543379649, "answer_id": 53512193, "question_id": 53511943, "link": "https://stackoverflow.com/questions/53511943/recursive-function-equation/53512193#53512193", "title": "Recursive Function equation", "body": "<p>as far as I can see first one is <code>scanf</code></p>\n\n<pre><code>scanf(\"%d\", &amp;n);\n</code></pre>\n\n<p>second one is your function <code>f</code> is not returning anything, so this </p>\n\n<pre><code>int f(int x) {\n//Checks if equal to zero\n  if (x &lt;= 0)\n  {\n     return (x + 3);\n  }\n\n  return ( f(x-3) + (x+5) );\n}\n</code></pre>\n\n<p>minor - the below statement is actually useless</p>\n\n<pre><code>//Pointer for f\n  f(n);\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 10638730, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-GpnWQtKxWsI/AAAAAAAAAAI/AAAAAAAAKD4/Wh2AnNxyBFI/photo.jpg?sz=128", "display_name": "Alec Mauro", "link": "https://stackoverflow.com/users/10638730/alec-mauro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1543380716, "creation_date": 1543377820, "last_edit_date": 1543380716, "question_id": 53511943, "link": "https://stackoverflow.com/questions/53511943/recursive-function-equation", "title": "Recursive Function equation", "body": "<p>Forewarning, this is a homework assignment.\nI am supposed to create a recursive function but I am doing this wrong. When I enter a 4 I am supposed to get a result of 16 from f(x) but I get -2. I don't really understand where I went wrong. Also I don't know if I am supposed to print my results inside of main or in f.</p>\n\n<p>Write a program that queries the user for an integer value and uses a recursive</p>\n\n<p>function that returns the value of the following recursive definition:</p>\n\n<blockquote>\n<pre><code>f(x) =x+3 if x &lt;=0\n\nf(x)=f(x-3)+(x+5) otherwise\n</code></pre>\n</blockquote>\n\n<p>My attempt:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint f(int x); //Prototype to call to f\n\nint main(void) {\n  int n; //number the user will input\n\n//Ask user to input data an reads it\n  printf(\"Enter a whole number: \");\n  scanf(\"%d\", &amp;n);\n\n//Pointer for f\n  f(n);\n\n//Prints results\n  printf(\"\\nn is %d\\n\", n);\n  printf(\"f(x) is %d\\n\", f(n));\n  return 0;\n}\n\nint f(int x) {\n//Checks if equal to zero\n  if (x &lt;= 0) {\n     x + 3;\n  }\n//If not equal to zero then do this\n  else {\n     f(x - 3) + (x + 5);\n  }\n}\n</code></pre>\n\n<p>Thank you all for the help, learned a lot from your comments and suggestions.\nI was able to get it work I believe <a href=\"https://pastebin.com/v9cZHvy0\" rel=\"nofollow noreferrer\">https://pastebin.com/v9cZHvy0</a></p>\n"}, {"tags": ["c++", "c", "regex", "pcre"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1543377770, "post_id": 53511759, "comment_id": 93893228, "body": "Note that the <code>\\d</code> in the string is not a valid C string literal; <code>\\d</code> is not a defined escape sequence.  Your compiler should be warning you about that.  You&#39;d need to write <code>\\\\d</code> in the string literal to get <code>\\d</code> to the regex compilation function."}], "answers": [{"tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": true, "score": 4, "last_activity_date": 1543377885, "last_edit_date": 1543377885, "creation_date": 1543376906, "answer_id": 53511824, "question_id": 53511759, "link": "https://stackoverflow.com/questions/53511759/whats-the-difference-between-regexec-and-pcre-exec/53511824#53511824", "title": "What&#39;s the difference between regexec and pcre_exec?", "body": "<p>The <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/regexec.html\" rel=\"nofollow noreferrer\"><code>regexec()</code></a> function implements <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/basedefs/V1_chap09.html\" rel=\"nofollow noreferrer\">POSIX Basic Regular Expressions (BRE) and Extended Regular Expressions (ERE)</a>.</p>\n\n<p>The <a href=\"http://pcre.org/current/doc/html/\" rel=\"nofollow noreferrer\"><code>pcre_exec()</code></a> function implements <a href=\"http://pcre.org/\" rel=\"nofollow noreferrer\">Perl-Compatible Regular Expressions</a>, which are a major superset of the ERE (see <a href=\"http://perldoc.perl.org/perlre.html\" rel=\"nofollow noreferrer\">perlre</a> for Perl's specification of Perl's REs).</p>\n\n<p>The <code>\\d</code> notation is not special to POSIX ERE (let alone BRE); it does not mean 'a digit'.  It does mean 'a digit' in PCRE.  If you want the regular expression to work in both dialects, you'll need to use <code>[0-9]</code> in place of <code>\\d</code>, and ensure <code>regcomp()</code> is told to compile an ERE.</p>\n\n<pre><code>\"^+?[0-9]{3,20}$\"\n</code></pre>\n"}], "owner": {"reputation": 79, "user_id": 941848, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c75376e92d37cbc6dfed51f088c88704?s=128&d=identicon&r=PG", "display_name": "DraculaW", "link": "https://stackoverflow.com/users/941848/draculaw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 168, "favorite_count": 0, "accepted_answer_id": 53511824, "answer_count": 1, "score": -1, "last_activity_date": 1543377885, "creation_date": 1543376377, "last_edit_date": 1543377709, "question_id": 53511759, "link": "https://stackoverflow.com/questions/53511759/whats-the-difference-between-regexec-and-pcre-exec", "title": "What&#39;s the difference between regexec and pcre_exec?", "body": "<p>I have a pattern </p>\n\n<blockquote>\n<pre><code>\"^\\+?\\d{3,20}$\"\n</code></pre>\n</blockquote>\n\n<ul>\n<li>Test on \"<code>123455</code>\", \"<code>+123445</code>\",  expected match.</li>\n<li>Test on \"<code>123+213</code>\", \"<code>abc</code>\", expect no match.</li>\n</ul>\n\n<p>This pattern worked on <code>pcre_exec()</code> but not on <code>regexec()</code>.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 4, "creation_date": 1543375426, "post_id": 53511559, "comment_id": 93892680, "body": "safe? no, since there&#39;s no guarantee that <code>float</code> is the same size as <code>int</code>, and that also violates the strict aliasing rule"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 2, "creation_date": 1543376014, "post_id": 53511559, "comment_id": 93892818, "body": "Please pick one programming language. You&#39;ve tagged 2. Solutions differ."}, {"owner": {"reputation": 95, "user_id": 8005218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6b9caba7776169977738dc3bf40ff7b?s=128&d=identicon&r=PG&f=1", "display_name": "Zachwuzhere", "link": "https://stackoverflow.com/users/8005218/zachwuzhere"}, "reply_to_user": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1543376228, "post_id": 53511559, "comment_id": 93892868, "body": "@phuclv assuming both float and int are 32 bit and the strict aliasing rule is disabled, will it work 100%?"}, {"owner": {"reputation": 2653, "user_id": 1028434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a340b89a8b4efdb83da69d6cc93caac7?s=128&d=identicon&r=PG", "display_name": "fdk1342", "link": "https://stackoverflow.com/users/1028434/fdk1342"}, "edited": false, "score": 2, "creation_date": 1543376315, "post_id": 53511559, "comment_id": 93892898, "body": "Be aware this kind of type casting can be extremely slow depending upon the target architecture.  On powerpc this will take the floating point value in the register.  Save it to memory on the stack. Read it back from memory to put it into a GPR register. Then shift and mask the GPR register.  Or you could have had a single <code>int negative = a &lt; 0.0f</code> which is two instructions."}, {"owner": {"reputation": 2653, "user_id": 1028434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a340b89a8b4efdb83da69d6cc93caac7?s=128&d=identicon&r=PG", "display_name": "fdk1342", "link": "https://stackoverflow.com/users/1028434/fdk1342"}, "edited": false, "score": 1, "creation_date": 1543376827, "post_id": 53511559, "comment_id": 93892990, "body": "No, it won&#39;t always work.  Depending upon compiler and optimization levels the compiler can see that this operation in undefined by the C language and set getSignOfa to anything it wants.  See <a href=\"http://blog.qt.io/blog/2011/06/10/type-punning-and-strict-aliasing/\" rel=\"nofollow noreferrer\">blog.qt.io/blog/2011/06/10/type-punning-and-strict-aliasing</a>"}, {"owner": {"reputation": 735, "user_id": 6106763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb5326862aea0afa1b0c4a8206e53c1e?s=128&d=identicon&r=PG&f=1", "display_name": "contrapants", "link": "https://stackoverflow.com/users/6106763/contrapants"}, "edited": false, "score": 1, "creation_date": 1543376974, "post_id": 53511559, "comment_id": 93893024, "body": "@Zachwuzhere Most of what you are writing is implementation defined. That&#39;s the point of writing in a language other than assembly. The compiler will do what it thinks is best for your processor architecture. Use something in the language like <code>signbit</code> if you want the best performance for this because even inline assembly can cause the complier to do extra register rearranging to accommodate it."}, {"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 1, "creation_date": 1543377790, "post_id": 53511559, "comment_id": 93893242, "body": "Whats wrong with what eg. clang -O3 produces for <code>!(v &lt; 0.f)</code> <i>~&gt;</i> <code>xorps xmm1, xmm1 \\   ucomiss xmm1, xmm0 \\ setbe al</code> ? (gcc -03 <i>~&gt;</i> <code>pxor xmm1, xmm1 \\ comiss  xmm1, xmm0 \\ setbe al</code>)"}, {"owner": {"reputation": 2653, "user_id": 1028434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a340b89a8b4efdb83da69d6cc93caac7?s=128&d=identicon&r=PG", "display_name": "fdk1342", "link": "https://stackoverflow.com/users/1028434/fdk1342"}, "reply_to_user": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1543378223, "post_id": 53511559, "comment_id": 93893346, "body": "@Swordfish Nothing, it&#39;s the best way of checking if it is negative.  I tried pointing out that comparisons don&#39;t branch (that&#39;s what if statements and functions call do) but maybe didn&#39;t word it very well."}, {"owner": {"reputation": 735, "user_id": 6106763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb5326862aea0afa1b0c4a8206e53c1e?s=128&d=identicon&r=PG&f=1", "display_name": "contrapants", "link": "https://stackoverflow.com/users/6106763/contrapants"}, "edited": false, "score": 1, "creation_date": 1543378367, "post_id": 53511559, "comment_id": 93893370, "body": "Does <code>NaN</code> need to be handled? If you know that won&#39;t happen by the time this code is reached, a comparison makes much more sense than checking the sign bit. If <code>NaN</code> does need to be handled, you&#39;re probably going to have to branch to take care of it anyway. At that point, you&#39;re back at the first case where the comparison makes much more sense again."}, {"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "reply_to_user": {"reputation": 2653, "user_id": 1028434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a340b89a8b4efdb83da69d6cc93caac7?s=128&d=identicon&r=PG", "display_name": "fdk1342", "link": "https://stackoverflow.com/users/1028434/fdk1342"}, "edited": false, "score": 0, "creation_date": 1543378588, "post_id": 53511559, "comment_id": 93893425, "body": "@Fred <i>best way of checking if it is negative.</i> \u2013 Ah, the op wanted negative ... well, add another bang ^^"}, {"owner": {"reputation": 2653, "user_id": 1028434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a340b89a8b4efdb83da69d6cc93caac7?s=128&d=identicon&r=PG", "display_name": "fdk1342", "link": "https://stackoverflow.com/users/1028434/fdk1342"}, "reply_to_user": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1543378773, "post_id": 53511559, "comment_id": 93893468, "body": "@Swordfish Not necessary <code>&lt;</code> already returns zero or one.  But <code>!!</code> is great for normalizing numbers to zero or one."}, {"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1543378810, "post_id": 53511559, "comment_id": 93893479, "body": "@Free seems you didn&#39;t notice the <b><i>^^</i></b>"}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 1, "creation_date": 1543378915, "post_id": 53511559, "comment_id": 93893509, "body": "there are a lot of related and duplicate questions: <a href=\"https://stackoverflow.com/q/15685181/995714\">How to get the sign, mantissa and exponent of a floating point number</a>, <a href=\"https://stackoverflow.com/q/3001653/995714\">How can I access the sign bit of a number in C++?</a>, <a href=\"https://stackoverflow.com/q/4235235/995714\">Sign of a floating point number</a>, <a href=\"https://stackoverflow.com/q/3001653/995714\">How can I access the sign bit of a number in C++?</a>..."}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "reply_to_user": {"reputation": 2653, "user_id": 1028434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a340b89a8b4efdb83da69d6cc93caac7?s=128&d=identicon&r=PG", "display_name": "fdk1342", "link": "https://stackoverflow.com/users/1028434/fdk1342"}, "edited": false, "score": 0, "creation_date": 1543387311, "post_id": 53511559, "comment_id": 93896158, "body": "@Fred <a href=\"https://godbolt.org/z/WVqaWg\" rel=\"nofollow noreferrer\">example on how it&#39;s done on various architectures</a>. I don&#39;t know about powerpc but it looks like the compiler indeed stores to memory and reload instead of moving from FPR to GPR like on many other architectures"}, {"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "reply_to_user": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1543388140, "post_id": 53511559, "comment_id": 93896507, "body": "@phuclv Please change /O3 to /O2 for msvc and see * <i>magic</i> * ;)"}], "answers": [{"comments": [{"owner": {"reputation": 95, "user_id": 8005218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6b9caba7776169977738dc3bf40ff7b?s=128&d=identicon&r=PG&f=1", "display_name": "Zachwuzhere", "link": "https://stackoverflow.com/users/8005218/zachwuzhere"}, "edited": false, "score": 0, "creation_date": 1543375284, "post_id": 53511595, "comment_id": 93892646, "body": "Is the signbit function brachless?"}, {"owner": {"reputation": 735, "user_id": 6106763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb5326862aea0afa1b0c4a8206e53c1e?s=128&d=identicon&r=PG&f=1", "display_name": "contrapants", "link": "https://stackoverflow.com/users/6106763/contrapants"}, "reply_to_user": {"reputation": 95, "user_id": 8005218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6b9caba7776169977738dc3bf40ff7b?s=128&d=identicon&r=PG&f=1", "display_name": "Zachwuzhere", "link": "https://stackoverflow.com/users/8005218/zachwuzhere"}, "edited": false, "score": 1, "creation_date": 1543375405, "post_id": 53511595, "comment_id": 93892677, "body": "It&#39;s required to be implemented as a macro, but it is otherwise implementation-defined."}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "reply_to_user": {"reputation": 95, "user_id": 8005218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6b9caba7776169977738dc3bf40ff7b?s=128&d=identicon&r=PG&f=1", "display_name": "Zachwuzhere", "link": "https://stackoverflow.com/users/8005218/zachwuzhere"}, "edited": false, "score": 2, "creation_date": 1543375569, "post_id": 53511595, "comment_id": 93892712, "body": "<a href=\"https://en.cppreference.com/w/cpp/numeric/math/signbit\" rel=\"nofollow noreferrer\">it&#39;s not a macro in C++</a>. @Zachwuzhere why you you care about that? Benchmark and if it&#39;s really slow then optimize it, otherwise it&#39;s premature optimization. The way from the standard is often the better solution"}, {"owner": {"reputation": 2653, "user_id": 1028434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a340b89a8b4efdb83da69d6cc93caac7?s=128&d=identicon&r=PG", "display_name": "fdk1342", "link": "https://stackoverflow.com/users/1028434/fdk1342"}, "edited": false, "score": 1, "creation_date": 1543375687, "post_id": 53511595, "comment_id": 93892744, "body": "I&#39;m just going to add that <code>bool s = a &lt; 0.0f</code> doesn&#39;t branch.  It&#39;s a comparison that is probably just some sort of fsub instruction and then masks and shifts the floating point status register.  Also what about NAN and Infinity?"}, {"owner": {"reputation": 95, "user_id": 8005218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6b9caba7776169977738dc3bf40ff7b?s=128&d=identicon&r=PG&f=1", "display_name": "Zachwuzhere", "link": "https://stackoverflow.com/users/8005218/zachwuzhere"}, "edited": false, "score": 0, "creation_date": 1543376065, "post_id": 53511595, "comment_id": 93892828, "body": "I&#39;m creating a branchess ray-triangle intersection method for ray tracing and need it to be as fast as possible because there are millions of tests per second."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "reply_to_user": {"reputation": 2653, "user_id": 1028434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a340b89a8b4efdb83da69d6cc93caac7?s=128&d=identicon&r=PG", "display_name": "fdk1342", "link": "https://stackoverflow.com/users/1028434/fdk1342"}, "edited": false, "score": 1, "creation_date": 1543376649, "post_id": 53511595, "comment_id": 93892960, "body": "@Fred that too is implementation-defined."}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "reply_to_user": {"reputation": 95, "user_id": 8005218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6b9caba7776169977738dc3bf40ff7b?s=128&d=identicon&r=PG&f=1", "display_name": "Zachwuzhere", "link": "https://stackoverflow.com/users/8005218/zachwuzhere"}, "edited": false, "score": 0, "creation_date": 1543378955, "post_id": 53511595, "comment_id": 93893520, "body": "@Zachwuzhere that&#39;s better leave to the GPU, not CPU"}], "tags": [], "owner": {"reputation": 735, "user_id": 6106763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb5326862aea0afa1b0c4a8206e53c1e?s=128&d=identicon&r=PG&f=1", "display_name": "contrapants", "link": "https://stackoverflow.com/users/6106763/contrapants"}, "is_accepted": false, "score": 4, "last_activity_date": 1543375104, "creation_date": 1543375104, "answer_id": 53511595, "question_id": 53511559, "link": "https://stackoverflow.com/questions/53511559/get-the-signed-bit-of-a-float/53511595#53511595", "title": "Get the signed bit of a float", "body": "<p>Since C99, you can use <code>signbit(x)</code> as defined in <code>math.h</code> to get the sign bit of a floating point number. It returns 0 if <code>x</code> is positive (sign bit not set) and nonzero if negative (sign bit is set).</p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 3, "creation_date": 1543378685, "post_id": 53511726, "comment_id": 93893452, "body": "then OP has another float and still doesn&#39;t know if it is negative"}], "tags": [], "owner": {"reputation": 6779, "user_id": 1691223, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/c2AsP.jpg?s=128&g=1", "display_name": "Shravan40", "link": "https://stackoverflow.com/users/1691223/shravan40"}, "is_accepted": false, "score": 0, "last_activity_date": 1543376192, "creation_date": 1543376192, "answer_id": 53511726, "question_id": 53511559, "link": "https://stackoverflow.com/questions/53511559/get-the-signed-bit-of-a-float/53511726#53511726", "title": "Get the signed bit of a float", "body": "<p>You may use <code>copysign()</code> functions available in <code>math.h</code> to get the sign of <code>float</code> number. </p>\n\n<pre><code>float sign = copysign(1, float_num);\n</code></pre>\n\n<p>Value of <code>sign</code> is going to be <code>+1</code> or <code>-1</code> depending upon the type of input. </p>\n"}], "owner": {"reputation": 95, "user_id": 8005218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6b9caba7776169977738dc3bf40ff7b?s=128&d=identicon&r=PG&f=1", "display_name": "Zachwuzhere", "link": "https://stackoverflow.com/users/8005218/zachwuzhere"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 938, "favorite_count": 0, "answer_count": 2, "score": -3, "last_activity_date": 1543376192, "creation_date": 1543374849, "last_edit_date": 1543376104, "question_id": 53511559, "link": "https://stackoverflow.com/questions/53511559/get-the-signed-bit-of-a-float", "title": "Get the signed bit of a float", "body": "<p>I'm trying to find a way to check if a floating point number is negative without branching.</p>\n\n<pre><code>float a = -0.5;\nint getSignOfa= *(int*)&amp;a &gt;&gt; 31; //type-pun to int and get signed bit;\n</code></pre>\n\n<p>Is this a safe way of checking the signed bit of a float?</p>\n"}, {"tags": ["c", "go", "cgo"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1543417783, "post_id": 53511478, "comment_id": 93913631, "body": "It&#39;s always unsafe, as indicated by the use of the <code>unsafe</code> package, but you still need to use it to convert types from C. You have the <code>bufferSize</code> value right there though, so what do you mean that you can&#39;t specify it?"}, {"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1543421927, "post_id": 53511478, "comment_id": 93916527, "body": "I don&#39;t know if you built this on Linux or other Unix-like, but naming your function <code>read</code> is going to conflict with the system C library. Yours will take priority but other code that wants to <code>read</code> things will likely call your function. With the wrong arguments. Chaos and destruction will ensue."}, {"owner": {"reputation": 113, "user_id": 10714700, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-D79wNT8uyCw/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-j-x5f7L6Mf0H8dzmBj6ICUts0hMg/mo/photo.jpg?sz=128", "display_name": "Junghoon Jang", "link": "https://stackoverflow.com/users/10714700/junghoon-jang"}, "reply_to_user": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1543459297, "post_id": 53511478, "comment_id": 93930374, "body": "@ZanLynx I&#39;m working on MAC, so it is Unix. But the code above is just a sample, I didn&#39;t consider about that. The name of the function in real code is not &#39;read&#39;. Thank you for your comment."}, {"owner": {"reputation": 113, "user_id": 10714700, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-D79wNT8uyCw/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-j-x5f7L6Mf0H8dzmBj6ICUts0hMg/mo/photo.jpg?sz=128", "display_name": "Junghoon Jang", "link": "https://stackoverflow.com/users/10714700/junghoon-jang"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1543459533, "post_id": 53511478, "comment_id": 93930430, "body": "@JimB I mean I cannot specify the size of buffer when I do <code>n, _ := f.Read(buff)</code>. Usually, in C code, we can put the size of buffer as a parameter in the read functions."}], "answers": [{"comments": [{"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1543421763, "post_id": 53522987, "comment_id": 93916432, "body": "So just to clarify: You are casting the <code>buffer</code> pointer into a Go pointer to a byte array of size <code>1 &lt;&lt; 30</code> (big but not the maximum, just a convenient shift size, and a constant) and then creating a slice of that imaginary buffer."}, {"owner": {"reputation": 133105, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "reply_to_user": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1543422642, "post_id": 53522987, "comment_id": 93916931, "body": "@ZanLynx: Exactly. &quot;The length is part of the [Go] array&#39;s type; it must evaluate to a non-negative [compile-time] constant representable by a value of type int.&quot;: <a href=\"https://golang.org/ref/spec#Array_types\" rel=\"nofollow noreferrer\">Array types, The Go Programming Language Specification</a>. So we need some trickery. Array length constant <code>1 &lt;&lt; 30</code> is a simple way of describing a very large Go <code>byte</code> array that is handled by 32-bit <code>int</code> implementations."}], "tags": [], "owner": {"reputation": 133105, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 4, "last_activity_date": 1543423467, "last_edit_date": 1543423467, "creation_date": 1543419233, "answer_id": 53522987, "question_id": 53511478, "link": "https://stackoverflow.com/questions/53511478/is-it-safe-to-convert-c-uint8-t-to-uint8/53522987#53522987", "title": "Is it safe to convert *C.uint8_t to []uint8?", "body": "<p>Your code is wrong. </p>\n\n<p>A Go slice is implemented as a Go <code>struct</code>:</p>\n\n<pre><code>type slice struct {\n    array unsafe.Pointer\n    len   int\n    cap   int\n}\n</code></pre>\n\n<p>Your values for <code>slice.len</code> and <code>slice.cap</code> are undefined.</p>\n\n<hr>\n\n<blockquote>\n  <p>Questions seeking debugging help (\"why isn't this code working?\") must\n  include the desired behavior, a specific problem or error and the\n  shortest code necessary to reproduce it in the question itself.</p>\n</blockquote>\n\n<p>Your code fragments don't compile and are incomplete.</p>\n\n<hr>\n\n<p><code>buf</code> is a Go <code>byte</code> slice to satisfy <code>io.Reader</code>.</p>\n\n<pre><code>type Reader interface {\n    Read(p []byte) (n int, err error)\n}\n\nbuffer *C.uint8_t\nbufferSize C.int\n\nbuf := (*[1 &lt;&lt; 30]byte)(unsafe.Pointer(buffer))[:bufferSize:bufferSize]\nn, err := f.Read(buf)\n</code></pre>\n\n<hr>\n\n<p>Here is my solution in reproducible form.</p>\n\n<p><code>main.c</code>:</p>\n\n<pre><code>#include &lt;stdint.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n\n#define BUFFER_SIZE 16384\n\nint read_go(uint8_t* buffer, int bufferSize);\n\nvoid read_buf() {\n    uint8_t* buffer = (uint8_t*)malloc(BUFFER_SIZE+1);\n    buffer[BUFFER_SIZE]='\\0';\n    int n = read_go(buffer, BUFFER_SIZE);\n    if (n &lt; 0) {\n        printf(\"read_go: error: %d\\n\", n);\n        n = 0;\n    }\n    if (n &gt; BUFFER_SIZE) {\n        n = BUFFER_SIZE;\n    }\n    buffer[n] = '\\0';\n\n    // do something with buffer\n    int width = n;\n    printf(\"%d\\n\", width);\n    if (width &gt; 16) {\n        width = 16;\n    }\n    for (int i = 0; i &lt; width; i++)     {\n        printf(\"%02X\", buffer[i]);\n    }\n    printf(\"\\n\");\n    for (int i = 0; i &lt; width; i++)     {\n        printf(\"%-2c\", buffer[i]);\n    }\n    printf(\"\\n\");\n\n    free(buffer);\n}\n\nint main(int argc, char *argv[]) {\n    read_buf();\n    return EXIT_SUCCESS;\n}\n</code></pre>\n\n<p><code>read.go</code>:</p>\n\n<pre><code>package main\n\n/*\n#include &lt;stdint.h&gt;\n*/\nimport \"C\"\n\nimport (\n    \"os\"\n    \"unsafe\"\n)\n\n//export read_go\nfunc read_go(buffer *C.uint8_t, bufferSize C.int) C.int {\n    f, err := os.Open(\"filename\")\n    if err != nil {\n        return C.int(-1)\n    }\n    defer f.Close()\n\n    buf := (*[1 &lt;&lt; 30]byte)(unsafe.Pointer(buffer))[:bufferSize:bufferSize]\n    n, err := f.Read(buf)\n    if err != nil {\n        return C.int(-1)\n    }\n    return C.int(n)\n}\n\nfunc main() {}\n</code></pre>\n\n<p>Output (Linux):</p>\n\n<pre><code>$ cat filename\nfiledata 01234567890\n$ export LD_LIBRARY_PATH=./:$LD_LIBRARY_PATH\n$ go build -a -o libread.so -buildmode=c-shared read.go\n$ gcc main.c libread.so -o read &amp;&amp; ./read\n21\n66696C65646174612030313233343536\nf i l e d a t a   0 1 2 3 4 5 6 \n$ \n</code></pre>\n"}], "owner": {"reputation": 113, "user_id": 10714700, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-D79wNT8uyCw/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-j-x5f7L6Mf0H8dzmBj6ICUts0hMg/mo/photo.jpg?sz=128", "display_name": "Junghoon Jang", "link": "https://stackoverflow.com/users/10714700/junghoon-jang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 667, "favorite_count": 1, "accepted_answer_id": 53522987, "answer_count": 1, "score": 4, "last_activity_date": 1543459774, "creation_date": 1543374192, "last_edit_date": 1543459774, "question_id": 53511478, "link": "https://stackoverflow.com/questions/53511478/is-it-safe-to-convert-c-uint8-t-to-uint8", "title": "Is it safe to convert *C.uint8_t to []uint8?", "body": "<p>I'm trying to pass uint8_t array from C code to Go, then read some bytes from file and store them into this array in Go code.</p>\n\n<p>Sample code is here.</p>\n\n<p>main.c :</p>\n\n<pre><code>#define BUFFER_SIZE 16384\n\nint read_go(uint8_t* buffer, int bufferSize);\n\nvoid read_buf() {\n     uint8_t* buffer = (uint8_t*)malloc(BUFFER_SIZE);\n     read_go(buffer, BUFFER_SIZE)\n\n     // do something with buffer\n\n     free(buffer)\n}\n</code></pre>\n\n<p>read.go :</p>\n\n<pre><code> /*\n #include \"main.c\"\n\n extern int read_go(uint8_t* buffer, int bufferSize);\n */\n import \"C\"\n\n //export read_go\n func read_go(buffer *C.uint8_t, bufferSize C.int) C.int {\n      f, _ := os.Open(\"filename\")\n      defer f.close()\n\n      buff := *(*[]uint8)(unsafe.Pointer(&amp;buffer))\n      n, _ := f.Read(buff)\n\n      return C.int(n)\n }\n</code></pre>\n\n<p>It works well, but I'm worrying about segmentation fault. Because I cannot specify the buffer size at Read function unlike fread function of C.</p>\n\n<p>I know that Read function reads bytes from file as much as len(buff). But I cannot guarantee that len(buff) is the same as bufferSize.</p>\n\n<p>Is it safe to convert *C.uint8_t to []uint8?</p>\n"}, {"tags": ["c", "fork", "exec"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1543387189, "post_id": 53511285, "comment_id": 93896098, "body": "You should include a newline in the <code>should fail</code> message \u2014 and probably write it to <code>stderr</code> rather than <code>stdout</code>.  However, the error message you show comes from <code>code.x</code> which is the program you <code>execv()</code> successfully.  That it stops abruptly after being executed is neither here nor there; it was started, and had replaced your code.  You should capture the PID and exit status via <code>wait()</code> \u2014 <code>int status; int corpse = wait(&amp;status);</code> and then you can dissect what happened to the program."}], "answers": [{"tags": [], "owner": {"reputation": 735, "user_id": 6106763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb5326862aea0afa1b0c4a8206e53c1e?s=128&d=identicon&r=PG&f=1", "display_name": "contrapants", "link": "https://stackoverflow.com/users/6106763/contrapants"}, "is_accepted": false, "score": 1, "last_activity_date": 1543387528, "last_edit_date": 1543387528, "creation_date": 1543376432, "answer_id": 53511765, "question_id": 53511285, "link": "https://stackoverflow.com/questions/53511285/exec-function-in-c-is-not-returning-1-when-it-should/53511765#53511765", "title": "Exec function in c is not returning -1 when it should", "body": "<p><code>execv</code> successfully did its job. The process <code>./code.x</code> executed, then exited because of an assertiong.</p>\n\n<p>The exec family of functions don't care about the process's return value. Once the process starts, the calling process is effectively terminated and gone.</p>\n\n<p>Exec will only return if for some reason the process couldn't be started <em>at all.</em> Specifically, only these errors (taken from the man page) will cause exec to return and set <code>errno</code> to one of these values:</p>\n\n<ul>\n<li><p><code>E2BIG</code>  The total number of bytes in the environment (envp) and argument list (argv) is too large.</p></li>\n<li><p><code>EACCES</code> Search  permission  is  denied  on  a component of the path prefix of filename or the name of a script interpreter.  (See also path_resolution(7).)</p></li>\n<li><p><code>EACCES</code> The file or a script interpreter is not a regular file.</p></li>\n<li><p><code>EACCES</code> Execute permission is denied for the file or a script or ELF interpreter.</p></li>\n<li><p><code>EACCES</code> The filesystem is mounted noexec.</p></li>\n<li><p><code>EAGAIN</code> (since Linux 3.1)\n          Having changed its real UID using one of the set*uid() calls, the caller was\u2014and is now still\u2014above its RLIMIT_NPROC  resource  limit  (see\n          setrlimit(2)).  For a more detailed explanation of this error, see NOTES.</p></li>\n<li><p><code>EFAULT</code> filename or one of the pointers in the vectors argv or envp points outside your accessible address space.</p></li>\n<li><p><code>EINVAL</code> An ELF executable had more than one PT_INTERP segment (i.e., tried to name more than one interpreter).</p></li>\n<li><p><code>EIO</code>    An I/O error occurred.</p></li>\n<li><p><code>EISDIR</code> An ELF interpreter was a directory.</p></li>\n<li><p><code>ELIBBAD</code> An ELF interpreter was not in a recognized format.</p></li>\n<li><p><code>ELOOP</code>  Too many symbolic links were encountered in resolving filename or the name of a script or ELF interpreter.</p></li>\n<li><p><code>ELOOP</code>  The  maximum  recursion limit was reached during recursive script interpretation (see \"Interpreter scripts\", above).  Before Linux 3.8, the\n          error produced for this case was ENOEXEC.</p></li>\n<li><p><code>EMFILE</code> The per-process limit on the number of open file descriptors has been reached.</p></li>\n<li><p><code>ENAMETOOLONG</code> filename is too long.</p></li>\n<li><p><code>ENFILE</code> The system-wide limit on the total number of open files has been reached.</p></li>\n<li><p><code>ENOENT</code> The file filename or a script or ELF interpreter does not exist, or a shared library needed for the file or interpreter cannot be found.</p></li>\n<li><p><code>ENOEXEC</code> An executable is not in a recognized format, is for the wrong architecture, or has some other format error that means  it  cannot  be  executed.</p></li>\n<li><p><code>ENOMEM</code> Insufficient kernel memory was available.</p></li>\n<li><p><code>ENOTDIR</code> A component of the path prefix of filename or a script or ELF interpreter is not a directory.</p></li>\n<li><p><code>EPERM</code> The filesystem is mounted nosuid, the user is not the superuser, and the file has the set-user-ID or set-group-ID bit set.</p></li>\n<li><p><code>EPERM</code>  The process is being traced, the user is not the superuser and the file has the set-user-ID or set-group-ID bit set.</p></li>\n<li><p><code>EPERM</code>  A  \"capability-dumb\"  applications  would  not obtain the full set of permitted capabilities granted by the executable file.  See capabilities(7).</p></li>\n<li><p><code>ETXTBSY</code> The specified executable was open for writing by one or more processes.</p></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "is_accepted": false, "score": 1, "last_activity_date": 1543376531, "creation_date": 1543376531, "answer_id": 53511777, "question_id": 53511285, "link": "https://stackoverflow.com/questions/53511285/exec-function-in-c-is-not-returning-1-when-it-should/53511777#53511777", "title": "Exec function in c is not returning -1 when it should", "body": "<p>The <code>exec</code> family of functions <em>replace the calling process</em> with a new program in its initial state loaded from an executable file. They can only fail if this replacement fails, e.g. due to the requested file not existing or the invoking user not having permissions to access/execute it.</p>\n\n<p>If an assertion failure in the program <code>./code.x</code> you're invoking happens, this is long past the point where <code>execv</code> could have failed; at this point, the original program state where <code>execv</code> was performed no longer exists, because it was already replaced. The parent process will see it exit via a <code>wait</code>-family function, and can inspect the status reported by the <code>wait</code>-family function to determine why it exited.</p>\n"}, {"tags": [], "owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "is_accepted": false, "score": 1, "last_activity_date": 1543377010, "creation_date": 1543377010, "answer_id": 53511841, "question_id": 53511285, "link": "https://stackoverflow.com/questions/53511285/exec-function-in-c-is-not-returning-1-when-it-should/53511841#53511841", "title": "Exec function in c is not returning -1 when it should", "body": "<p><code>exec*</code> functions succeed if the program starts running. Your program did start running.</p>\n\n<p>An assertion failure causes the program to <strong>abort</strong>, exit with a <strong>signal</strong>. The Linux <a href=\"http://man7.org/linux/man-pages/man2/wait.2.html\" rel=\"nofollow noreferrer\">manual page <code>wait</code>(2)</a> explains that:</p>\n\n<blockquote>\n  <p><code>WEXITSTATUS(wstatus)</code></p>\n  \n  <p>returns the exit status of the child.  This consists of the least significant 8 bits of the status argument that the child specified in a call to <code>exit(3)</code> or <code>_exit(2)</code> or as\n                the argument for a return statement in <code>main()</code>.  <strong>This macro should be employed only if <code>WIFEXITED</code> returned true.</strong></p>\n</blockquote>\n\n<p>If you didn't check that <code>WIFEXITED(status)</code> is true, then <code>WEXITSTATUS(status)</code> is <strong>garbage</strong>.</p>\n\n<p>Instead, check <code>WIFSIGNALED(status)</code> and if true, get the signal - <code>WTERMSIG(status)</code>, which should equal to <code>SIGABRT</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 552, "user_id": 9900911, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/693018196257bd546178b53a34149b45?s=128&d=identicon&r=PG&f=1", "display_name": "armitus", "link": "https://stackoverflow.com/users/9900911/armitus"}, "is_accepted": false, "score": 0, "last_activity_date": 1543377837, "creation_date": 1543377837, "answer_id": 53511945, "question_id": 53511285, "link": "https://stackoverflow.com/questions/53511285/exec-function-in-c-is-not-returning-1-when-it-should/53511945#53511945", "title": "Exec function in c is not returning -1 when it should", "body": "<p>The Exec function family replaces the existing process image with a new process image. This is why it is required to fork before spawning another process, because the currently running process is completely replaced, this includes the program counter, which keeps track of the next instruction to execute.</p>\n\n<pre><code>printf(\"should fail\");\n</code></pre>\n\n<p>is never excecuted because the instant you called <code>execv(args[0], args)</code>, the program counter was moved to execute args[0], thus leaving behind the execution path that would have resulted in that print statement.</p>\n\n<p>Exec returns -1 on the condition that it encountered an error while replacing the image, and has absolutely no relation to the return value of the program being executed. This is because the two processes, after Exec is called, are not coordinating with each other at all. Remember: the <code>fork()</code> command created a new address space, which means that these processes are now running in separate domains on separate executables.  </p>\n\n<p>Some documentation may be of help:</p>\n\n<p><a href=\"http://man7.org/linux/man-pages/man3/exec.3.html\" rel=\"nofollow noreferrer\">http://man7.org/linux/man-pages/man3/exec.3.html</a></p>\n\n<p>Hope this helped.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user10714665"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 590, "favorite_count": 0, "answer_count": 4, "score": 4, "last_activity_date": 1543387528, "creation_date": 1543372656, "last_edit_date": 1543374319, "question_id": 53511285, "link": "https://stackoverflow.com/questions/53511285/exec-function-in-c-is-not-returning-1-when-it-should", "title": "Exec function in c is not returning -1 when it should", "body": "<p>I am using an execv function to run a program called code.x.\ncode.x has a part where it guarantees its failure by Assertion.\nMy code that runs execl is:</p>\n\n<pre><code>#include &lt;unistd.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/wait.h&gt; \n#include &lt;errno.h&gt;\n#include &lt;string.h&gt;\n\nint main()\n{\n    pid_t pid;\n    char *args[] = { \"./code.x\",NULL };\n    pid = fork();\n    if (pid &gt; 0) {\n        wait(NULL);\n        printf(\"%s\\n\", strerror(errno));\n        printf(\"done\\n\");\n    }\n    else if (pid == 0) {\n        printf(\"%s\\n\", strerror(errno));\n        execv(args[0], args);\n        printf(\"should fail\");\n    }\n    else {\n        printf(\"forkfail\");\n    }\n    return 1;\n}\n</code></pre>\n\n<p>the code prints\n</p>\n\n<pre><code>Success\ncode.x: code.c:15: main: Assertion '0 == 1' failed.\nSuccess\ndone\n</code></pre>\n\n<p>\"should fail\" is never printed and WEXITSTATUS(status) shows that the exit status is 0.</p>\n"}, {"tags": ["c", "pic", "mplab", "pic24"], "owner": {"reputation": 21, "user_id": 10714601, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-IVofUrvOM4U/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jLEo8kXlcblRSv_nEDLvjyQrpAaw/mo/photo.jpg?sz=128", "display_name": "CODE_guy", "link": "https://stackoverflow.com/users/10714601/code-guy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 105, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1604934838, "creation_date": 1543371902, "last_edit_date": 1543389677, "question_id": 53511194, "link": "https://stackoverflow.com/questions/53511194/acken-bit-on-pic24fj64ga002-not-clearing-after-acknowledge-sequence", "title": "ACKEN bit on PIC24FJ64GA002 not clearing after acknowledge sequence", "body": "<pre><code>uint8_t i2c_read(void)\n\n{\n\n    uint8_t u8_readData;\n    uint8_t u8_ackBit = 0;\n    while(I2C1CON &amp; 0x1F);          //wait for idle\n    I2C1CONbits.RCEN = 1;           //prepare device to receive\n    while(I2C1CONbits.RCEN);\n    u8_readData = I2C1RCV;          //write recieved data to variable\n    while(I2C1CON &amp; 0x1F);          //wait for idle\n\n    I2C1CONbits.ACKDT = u8_ackBit;  //prepare to send ack bit\n    I2C1CONbits.ACKEN = 1;          //transmit ack bit\n    //HERE IS MY PROBLEM \n    while(I2C1CONbits.ACKEN);       //wait for idle\n    return(u8_readData);\n}\n</code></pre>\n\n<p>This is part of my code that I am having trouble with as shown in the code while(I2C1CONbits.ACKEN); is not being able to clear. This part of code is used to connect a Infrared sensor (type: MLX90614 family) to the Pic24. My breadboard connections are correct and I tripled checked it. What happens is when I run the code, the code stops at this while loop and doesn't move on.  </p>\n"}, {"tags": ["c++", "c", "assembly", "static-libraries", "static-linking"], "comments": [{"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1543373470, "post_id": 53511152, "comment_id": 93892303, "body": "Set the global variable, not upon entry to <code>main</code>, but on the first call to one of your functions, using <code>pthread_once</code> or equivalent to ensure thread safety."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1543373524, "post_id": 53511152, "comment_id": 93892313, "body": "Don&#39;t worry about the cost of the branch; it will be predicted reliably after the first call."}, {"owner": {"reputation": 15145, "user_id": 4271923, "user_type": "registered", "profile_image": "https://graph.facebook.com/543414580/picture?type=large", "display_name": "Ped7g", "link": "https://stackoverflow.com/users/4271923/ped7g"}, "edited": false, "score": 0, "creation_date": 1543391282, "post_id": 53511152, "comment_id": 93897930, "body": "Well, in the C++ itself (as language) you simply distribute the source and let the user to recompile it, that also allows for more specific (driven by user machine) optimizations of the C++ code to be applied. (also code without source is a zombie, in a decade or two it will be very likely dead, so unless you intentionally want to waste part of your life by creating something what will be lost in few years...)"}], "answers": [{"comments": [{"owner": {"reputation": 196, "user_id": 10200235, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nMWgL33Anh0/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7q8SbHdyJoTUoT-DkNaBIC9yY36hQ/mo/photo.jpg?sz=128", "display_name": "Sam Kumar", "link": "https://stackoverflow.com/users/10200235/sam-kumar"}, "edited": false, "score": 1, "creation_date": 1543536048, "post_id": 53511846, "comment_id": 93965251, "body": "Thanks for the extra information about STT_GNU_IFUNC, and for the idea to use function pointers.  Since you asked, I&#39;m not actually using <code>pdep</code> or <code>pext</code>; I need BMI2 for the <code>mulx</code> instruction.  Rather than having a special init function, I ended up using <code>init_array</code> (more information here: <a href=\"https://stackoverflow.com/questions/31137260/implementation-of-dynamic-initialization-for-global-variables-and-static-member\" title=\"implementation of dynamic initialization for global variables and static member\">stackoverflow.com/questions/31137260/&hellip;</a>) to set up the function pointer <i>before</i> the <code>main</code> function executes."}], "tags": [], "owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "is_accepted": true, "score": 3, "last_activity_date": 1543377063, "creation_date": 1543377063, "answer_id": 53511846, "question_id": 53511152, "link": "https://stackoverflow.com/questions/53511152/choose-assembly-implementation-to-use-based-on-supported-instructions/53511846#53511846", "title": "Choose assembly implementation to use based on supported instructions", "body": "<p>x264 uses an init function (which users of the library are required to call before calling anything else, or something like that) to set up a struct of function pointers based on CPUID results.  Including taking into account that <code>pshufb</code> is slow on some early CPUs that support it.</p>\n\n<p>If your functions depend on <code>pdep</code> / <code>pext</code>, you probably want to detect AMD vs. Intel, because AMD's <code>pdep</code>/<code>pext</code> is very slow and probably not worth using on Ryzen, even though it is available.  (See <a href=\"https://agner.org/optimize/\" rel=\"nofollow noreferrer\">https://agner.org/optimize/</a> for instruction tables.)</p>\n\n<hr>\n\n<p>Function pointers are fairly low overhead, about the same as calling a function in a shared library or DLL.  <code>call [rel funcptr]</code> instead of <code>call func</code>.  (In the compiler-generated asm that calls your functions).</p>\n\n<p><a href=\"https://stackoverflow.com/questions/9651104/cpu-dependent-code-how-to-avoid-function-pointers\">CPU dependent code: how to avoid function pointers?</a> shows a very simple example of it in C, and is asking for ways to <em>avoid</em> it.  With dynamic linking, you can do CPU detection at dynamic link time so the dynamic-linking indirection becomes your CPU-dispatch indirection as well (like glibc does for selecting an optimized <code>memcpy</code> implementation.)</p>\n\n<p>But with static linking for a <code>.a</code>, just make function pointers that are statically initialized to the baseline versions, and your CPU init function (which hopefully runs before any of the function pointers are dereferenced) rewrites them to point at the best version for the current CPU.</p>\n"}, {"tags": [], "owner": {"reputation": 96, "user_id": 8713143, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b515663f5d70775ad31c7b8b426e932a?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/8713143/david"}, "is_accepted": false, "score": 1, "last_activity_date": 1545920369, "creation_date": 1545920369, "answer_id": 53946518, "question_id": 53511152, "link": "https://stackoverflow.com/questions/53511152/choose-assembly-implementation-to-use-based-on-supported-instructions/53946518#53946518", "title": "Choose assembly implementation to use based on supported instructions", "body": "<p>If you are using gcc, you can get the compiler to implement all the boiler plate code automatically.  <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Function-Multiversioning.html\" rel=\"nofollow noreferrer\">gcc manual page on function multiversioning</a></p>\n"}], "owner": {"reputation": 196, "user_id": 10200235, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nMWgL33Anh0/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7q8SbHdyJoTUoT-DkNaBIC9yY36hQ/mo/photo.jpg?sz=128", "display_name": "Sam Kumar", "link": "https://stackoverflow.com/users/10200235/sam-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 173, "favorite_count": 0, "accepted_answer_id": 53511846, "answer_count": 2, "score": 7, "last_activity_date": 1545920369, "creation_date": 1543371575, "question_id": 53511152, "link": "https://stackoverflow.com/questions/53511152/choose-assembly-implementation-to-use-based-on-supported-instructions", "title": "Choose assembly implementation to use based on supported instructions", "body": "<p>I am working on a C library which compiles/links to a <code>.a</code> file that users can statically link into their code. The library's performance is very important, so I am writing performance-critical routines in x86-64 assembly to optimize performance.</p>\n\n<p>For some routines, I can get significantly better performance if I use BMI2 instructions than if I stick to the \"standard\" x86-64 instruction set. Trouble is, BMI2 was introduced fairly recently and some of my users use processors that do not support those instructions.</p>\n\n<p>So, I've written optimized the routines <em>twice</em>, once using BMI2 instructions and once without using them. In my current setup, I would distribute two versions of the <code>.a</code> file: a \"fast\" one that requires support for BMI2 instructions, and a \"slow\" one that does not require support for BMI2 instructions.</p>\n\n<p>I am asking if there's a way to simplify this by distributing a single <code>.a</code> file that will dynamically choose the correct implementation based on whether the CPU <em>on which the final application runs</em> supports BMI2 instructions.</p>\n\n<p>Unlike similar questions on StackOverflow, there are two peculiarities here:</p>\n\n<ul>\n<li>The technique to choose the function needs to have particularly low overhead in the critical path. The routines in question, after assembly-optimization, run in ~10 ns, so even a single <code>if</code> statement could be significant.</li>\n<li>The function that needs to be chosen \"dynamically\" is chosen once at the beginning, and then remains fixed for the duration of the program. I'm hoping that this will offer a faster solution than the one suggested in this question:  <a href=\"https://stackoverflow.com/questions/16606629/choosing-method-implementation-at-runtime\">Choosing method implementation at runtime</a></li>\n</ul>\n\n<p>The fastest solution I've come up with so far is to do the following:</p>\n\n<ol>\n<li>Check whether the CPU supports BMI2 instructions using the <code>cpuid</code> instruction.</li>\n<li>Set a global variable <code>true</code> or <code>false</code> depending on the result.</li>\n<li>Branch on the value of this global variable on every function invocation.</li>\n</ol>\n\n<p>I'm not satisfied with this approach because it has two drawbacks:</p>\n\n<ul>\n<li>I'm not sure how I can <em>automatically</em> run <code>cpuid</code> and set a global variable at the beginning of the program, given that I'm distributing a <code>.a</code> file and don't have control over the <code>main</code> function in the final binary. <strong>I'm happy to use C++ here if it offers a better solution, as long as the final library can still be linked with and called from a C program.</strong></li>\n<li>This incurs overhead on <em>every</em> function call, when ideally the only overhead would be on program startup.</li>\n</ul>\n\n<p>Are there any solutions that are more efficient than the one I've detailed above?</p>\n"}, {"tags": ["c", "aio"], "comments": [{"owner": {"reputation": 2721, "user_id": 8767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22597b536b07b41525099a8c16e23ce?s=128&d=identicon&r=PG&f=1", "display_name": "MFisherKDX", "link": "https://stackoverflow.com/users/8767209/mfisherkdx"}, "edited": false, "score": 0, "creation_date": 1543368524, "post_id": 53510586, "comment_id": 93891224, "body": "what do you get if you call aio_check() <i>before</i> you add a task?  do you initialize aio_array?"}], "answers": [{"tags": [], "owner": {"reputation": 8223, "user_id": 805579, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/0d2eb3294e0905aa3c750998db351ddc?s=128&d=identicon&r=PG", "display_name": "Niall Douglas", "link": "https://stackoverflow.com/users/805579/niall-douglas"}, "is_accepted": true, "score": 2, "last_activity_date": 1544005996, "creation_date": 1544005996, "answer_id": 53630259, "question_id": 53510586, "link": "https://stackoverflow.com/questions/53510586/c-keep-track-of-aio-read-task/53630259#53630259", "title": "C keep track of aio_read task", "body": "<p>You need to call <code>aio_suspend()</code> in order to process what i/o's have completed, otherwise <code>aio_error()</code> etc will never return differently. See <a href=\"https://github.com/ned14/llfio/blob/master/include/llfio/v2.0/detail/impl/posix/io_service.ipp#L290\" rel=\"nofollow noreferrer\">https://github.com/ned14/llfio/blob/master/include/llfio/v2.0/detail/impl/posix/io_service.ipp#L290</a>.</p>\n"}], "owner": {"reputation": 241, "user_id": 7350859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a2eebca1c361fd774ee8dd8f3f634fb?s=128&d=identicon&r=PG&f=1", "display_name": "Tretorn", "link": "https://stackoverflow.com/users/7350859/tretorn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 53630259, "answer_count": 1, "score": 1, "last_activity_date": 1544005996, "creation_date": 1543367171, "question_id": 53510586, "link": "https://stackoverflow.com/questions/53510586/c-keep-track-of-aio-read-task", "title": "C keep track of aio_read task", "body": "<p>I have a function that starts an <code>aio_read</code> task and returns to the main program.</p>\n\n<p>I want to periodically check if the task is completed to close the file descriptor and maybe notify the user. </p>\n\n<p>My current approach is declaring a <code>struct</code> that contains the <code>struct aiocb</code> of the task and the file descriptor. Adding it to a global array and checking if any task is working with the following (aio_check function):</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;aio.h&gt;\n#include &lt;unistd.h&gt;\n\n#include \"aioqueue.h\"\n\nvoid aio_add(struct aiocb a, int fd) {\n    for (int i = 0; i &lt; MAX; i++) {\n        if (aio_array[i].valid == 0) {\n            aio_pack tmp;\n            tmp.cb = a;\n            tmp.fd = fd;\n            tmp.valid = 1;\n            aio_array[i] = tmp;\n\n            printf(\"request enqueued\\n\");\n            return;\n        }\n    }\n    printf(\"This shell cannot keep track of so many IO operations :/ \\n\");\n}\n\nvoid aio_check() {\n    for (int i = 0; i &lt; MAX; i++) {\n        // wait until the request has finished\n        if(aio_array[i].valid) {\n            if (aio_error(&amp;aio_array[i].cb) != EINPROGRESS) {\n                int nleidos = aio_return(&amp;aio_array[i].cb);\n\n                if (nleidos != -1)\n                    printf(\"AIO Task finished: %d B\\n\", nleidos);\n                else\n                    printf(\"Error!\");\n\n                close(aio_array[i].fd); \n                aio_array[i].valid = 0; \n            } else {\n                printf(\"At least one AIO task is in progress\\n\");           \n            }\n        }\n    }\n}\n</code></pre>\n\n<p>and the code for aioqueue.h</p>\n\n<pre><code>#define MAX 10\n\ntypedef struct {\n    struct aiocb cb;\n    int fd;\n    int valid;\n} aio_pack;\n\naio_pack aio_array[MAX];\n\nvoid aio_add(struct aiocb a, int fd);\nvoid aio_check();\n</code></pre>\n\n<p>The problem is that if i call <code>aio_check</code> after i added a task i always get the</p>\n\n<blockquote>\n  <p>At least one AIO task is in progress</p>\n</blockquote>\n\n<p>message. Even if it's clear that the task has finished.</p>\n\n<p>I suppose that it might be due to the fact that im passing a copy of the <code>struct aiocb</code> in a moment where the <code>aio_error</code> is <code>EINPROGRESS</code> and as its a copy it never gets updated. But im pretty lost at this moment. Any help would be greatly appreciated. </p>\n\n<p>Thank you in advance.</p>\n"}, {"tags": ["c", "eclipse", "gcc", "makefile"], "comments": [{"owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 1, "creation_date": 1543366706, "post_id": 53510467, "comment_id": 93890800, "body": "I&#39;d post your entire makefile. Also, I see <code>-j</code> [parallel], so leave that off (i.e. you may need more dependencies for parallel build). And, what is the <i>exact</i> command you&#39;re using (e.g.) <code>make all</code>. Can you do <code>make clean</code>? Also, please <i>edit</i> your question to revise it rather than answering it. It is okay to answer your own question <i>if</i> you actually have an answer for it [most people don&#39;t usually unless the answer would exceed 30,000 chars]"}, {"owner": {"reputation": 69991, "user_id": 939557, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/3VPea.png?s=128&g=1", "display_name": "MadScientist", "link": "https://stackoverflow.com/users/939557/madscientist"}, "edited": false, "score": 0, "creation_date": 1543422748, "post_id": 53510467, "comment_id": 93916999, "body": "If you run <code>make.exe --version</code> and <code>cs-make.exe --version</code>, what do you get?  Based on your extension here, you&#39;re on Windows (you should be clear about that).  There are multiple ways GNU make can be built on Windows so it can be quite confusing (due to case sensitive/insensitive differences, drive letter support, etc.)"}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 8532274, "user_type": "registered", "profile_image": "https://graph.facebook.com/1504714112946560/picture?type=large", "display_name": "Alan Rouse", "link": "https://stackoverflow.com/users/8532274/alan-rouse"}, "is_accepted": false, "score": 0, "last_activity_date": 1543478775, "creation_date": 1543478775, "answer_id": 53534361, "question_id": 53510467, "link": "https://stackoverflow.com/questions/53510467/compatibility-between-versions-of-gnu-make/53534361#53534361", "title": "Compatibility between versions of GNU Make", "body": "<p>Thank you both for your responses.</p>\n\n<p>I spent many frustrating hours trying different combinations of GCC, OpenOCD, JTag drivers and Eclipse plug-ins. I have numerous build versions of a project that all work with my previous toolchain and I tried copying various of these into the project I use to test the new toolchain.</p>\n\n<p>I eventually found the solution. I had somehow managed to corrupt my project to use source files from one build version and a makefile from another version, and there were incompatibility issues between them.</p>\n\n<p>The symptoms were very deceptive and led me up various blind alleys. I still can't understand why it worked with one version of make but not with the other.</p>\n\n<p>When I corrected the project everything worked correctly. </p>\n"}], "owner": {"reputation": 11, "user_id": 8532274, "user_type": "registered", "profile_image": "https://graph.facebook.com/1504714112946560/picture?type=large", "display_name": "Alan Rouse", "link": "https://stackoverflow.com/users/8532274/alan-rouse"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 195, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1543478775, "creation_date": 1543366159, "last_edit_date": 1543379207, "question_id": 53510467, "link": "https://stackoverflow.com/questions/53510467/compatibility-between-versions-of-gnu-make", "title": "Compatibility between versions of GNU Make", "body": "<p>I have been using GCC for many years to compile ARM projects developed using Eclipse. I have decided it is time to update the tools I'm using.</p>\n\n<p>I have been using a version of GCC 'cribbed' from CodeSourcery, but I have upgraded to the latest version from <a href=\"http://gnutoolchains.com/arm-eabi/\" rel=\"nofollow noreferrer\">http://gnutoolchains.com/arm-eabi/</a>.  All works well, except for Make:</p>\n\n<p>The CodeSourcery folder includes a version named cs-make.exe, dated 30/04/2013. I have downloaded a newer version of GCC/GDB from <a href=\"http://gnutoolchains.com/arm-eabi/\" rel=\"nofollow noreferrer\">http://gnutoolchains.com/arm-eabi/</a> into a folder that I named SysGCC.  It contains the app make.exe, dated 27/05/2015.</p>\n\n<p>I have modified my makefile to use SysGCC and it compiles correctly.  However, if I then modify my project to run make.exe instead of cs-make.exe the console shows the following errors:</p>\n\n<blockquote>\n<pre><code>make -j -k all \nmake: *** No rule to make target `IO.o', needed by `Display.elf'.\nmake: *** No rule to make target `XTPcommon.o', needed by `Display.elf'.\nmake: *** No rule to make target `DisplayCommon.o', needed by `Display.elf'.\n.\n.\n</code></pre>\n</blockquote>\n\n<p>The contents of my makefile are quite complex, and include the following:</p>\n\n<blockquote>\n<pre><code>%.o : %.c makefile\n    $(COMPILE) -c $(CFLAGS) $&lt; -o $(OUTPUT_FOLDER)/$@\n    $(COMPILE) -MM $(CFLAGS) $&lt; &gt; $(OUTPUT_FOLDER)/$(addsuffix .d, $(notdir $(basename $@)))\n</code></pre>\n</blockquote>\n\n<p>Since they build correctly with <code>cs-make.exe</code> I can see no reason why they shouldn't build with <code>make.exe</code>.  So, what's going wrong?</p>\n"}, {"tags": ["c", "free", "undefined-behavior"], "comments": [{"owner": {"reputation": 42504, "user_id": 1161878, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/0157ddd785dc01e95342e3661d34b42a?s=128&d=identicon&r=PG", "display_name": "Gene", "link": "https://stackoverflow.com/users/1161878/gene"}, "edited": false, "score": 2, "creation_date": 1543366039, "post_id": 53510401, "comment_id": 93890650, "body": "No. C assumes you maintain enough state to know where each pointer points. <code>free()</code> isn&#39;t required to detect any error. Some implementations detect some kinds of errors, but your code shouldn&#39;t rely on this."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1543366680, "post_id": 53510401, "comment_id": 93890795, "body": "Either make a copy of every item passed to your code and take responsibility for freeing it, or don&#39;t make a copy of any item passed to your code and make the caller responsible for freeing it (if appropriate) when the list is released.  You can&#39;t afford to have a mixture of dynamically allocated and stack allocated memory in your list if you are responsible for releasing the memory."}], "answers": [{"tags": [], "owner": {"reputation": 27279, "user_id": 857132, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4fd51ed5980999c7c6ce3729d6cb2184?s=128&d=identicon&r=PG", "display_name": "John3136", "link": "https://stackoverflow.com/users/857132/john3136"}, "is_accepted": true, "score": 7, "last_activity_date": 1543365963, "creation_date": 1543365963, "answer_id": 53510448, "question_id": 53510401, "link": "https://stackoverflow.com/questions/53510401/c-free-memory-on-stack/53510448#53510448", "title": "C free memory on stack", "body": "<p>No.</p>\n\n<p>You need to not call <code>free()</code> for non heap pointers. Easiest way is let whoever allocated the memory take care of freeing it. I.e. your utilities look after whatever memory they allocate but someone else looks after the memory passed to your utilities.</p>\n"}, {"tags": [], "owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "is_accepted": false, "score": 0, "last_activity_date": 1543423345, "creation_date": 1543423345, "answer_id": 53524239, "question_id": 53510401, "link": "https://stackoverflow.com/questions/53510401/c-free-memory-on-stack/53524239#53524239", "title": "C free memory on stack", "body": "<p>Although \"malloc\" and \"free\" are described in terms of creating allocations and destroying them, their actual role is the reverse of that.  The \"malloc()\" function takes some memory from a pool and indicates that the memory manager is not allowed to use any of the bytes within the allocated range (though bytes that were outside that range, including those immediately preceding and following the allocation, remain available to it).  The \"free()\" function adds memory back to the pool, making it available for future use.</p>\n\n<p>In some allocation systems, the function that releases memory accepts an argument indicating how much memory is being released; others may require that each pool only be used to dispense fixed-size objects.  Some of the systems that do such things would allow code to add any chunk of memory that a program won't need for any other purpose to a pool by simply \"releasing\" it, the memory manager knowing or caring whether the memory came from the pool in the first case.  Indeed, in some such systems that may be how the pools get created in the first place: initialize a descriptor for an empty memory pool, and then \"release\" chunks of storage into it as convenient.</p>\n\n<p>Such an approach to adding storage to a memory pool can't work in C, however, since the only way \"free\" can know how much memory to add to the pool is to make use of information that was stored somewhere by \"malloc\".  Generally, the information is stored in the space immediately prior to the storage malloc() gives the application.  If a pointer wasn't produced by <code>malloc()</code>, the storage immediately preceding the storage described by the pointer won't contain the information malloc() needs, but will more likely contain a pattern of bytes that looks like it was created by an allocation of some meaningless size.  This would have the effect of inviting the memory manager to do whatever it likes with a large chunk of storage that will likely extend beyond the boundaries of the object whose address was passed to it.  Hilarity is likely to ensue when the memory manager takes the application up on that invitation.</p>\n"}], "owner": {"reputation": 627, "user_id": 6694404, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/bd260580a43b5bb091b40509eee0bfe9?s=128&d=identicon&r=PG&f=1", "display_name": "P.Carlino", "link": "https://stackoverflow.com/users/6694404/p-carlino"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 945, "favorite_count": 0, "accepted_answer_id": 53510448, "answer_count": 2, "score": 4, "last_activity_date": 1543423345, "creation_date": 1543365514, "last_edit_date": 1543366551, "question_id": 53510401, "link": "https://stackoverflow.com/questions/53510401/c-free-memory-on-stack", "title": "C free memory on stack", "body": "<p>I created some utilities which\nhelp me to handle the management of a DinamicList. In the section that I \nuse to handle the removing of a element in a list, if there is \na element added that is stored in the stack, when I call <code>free()</code>\nan undefined behaviour is reached.</p>\n\n<p>Surfing on the net I found out \nthat there aren't ways to determine whether a pointer points to stack \nmemory or heap memory.</p>\n\n<p>So I think that to solve this problem I have to handle\nthe error generated from <code>free()</code>. Is there a way to handle that exception when I call <code>free()</code>? </p>\n"}, {"tags": ["c", "repl.it"], "comments": [{"owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 2, "creation_date": 1543365934, "post_id": 53510397, "comment_id": 93890626, "body": "We couldn&#39;t possibly diagnose the issue without seeing your code. Please edit your post and add your full/representative code in a code block. Also, give sample input/output and expected and actual behavior. See: <a href=\"https://stackoverflow.com/help/mcve\">stackoverflow.com/help/mcve</a>"}, {"owner": {"reputation": 754, "user_id": 8402500, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/XZRs6.jpg?s=128&g=1", "display_name": "G.Alexander", "link": "https://stackoverflow.com/users/8402500/g-alexander"}, "edited": false, "score": 0, "creation_date": 1543369967, "post_id": 53510397, "comment_id": 93891531, "body": "Hello @Bwarr, would like to post your full code? So we can solve your problem easily."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 2, "creation_date": 1543370183, "post_id": 53510397, "comment_id": 93891572, "body": "Both of the errors reported in my answer were found simply by compiling with warnings enabled. Enable warnings in your compiler. There is usually some default set of \u201cmost\u201d warnings that provides a good selection of useful warnings. Find that setting and enable it. If you state which compiler you are using, people can help you with that."}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 10714379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef7ab774dea451314a2727d01c62edb8?s=128&d=identicon&r=PG&f=1", "display_name": "Bwarr", "link": "https://stackoverflow.com/users/10714379/bwarr"}, "edited": false, "score": 0, "creation_date": 1543370355, "post_id": 53510941, "comment_id": 93891607, "body": "Thank you. That gives me an idea on where to focus my efforts."}], "tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": false, "score": 1, "last_activity_date": 1543370058, "creation_date": 1543370058, "answer_id": 53510941, "question_id": 53510397, "link": "https://stackoverflow.com/questions/53510397/issues-finding-average-of-elements/53510941#53510941", "title": "Issues finding average of elements", "body": "<p>This is wrong:</p>\n\n<pre><code>int ary[7];\n\u2026\nscanf(\"%f\", &amp;ary[i]);\n</code></pre>\n\n<p><code>%f</code> is for scanning a <code>float</code>, but <code>ary[i]</code> is an <code>int</code>. The resulting behavior is not defined.</p>\n\n<p>This is wrong:</p>\n\n<pre><code>double size;\n\u2026\nave = average(size, ary);\n</code></pre>\n\n<p>Nothing in the \u201c\u2026\u201d assigns a value to <code>size</code>, so it has no defined value when <code>average</code> is called.</p>\n"}, {"comments": [{"owner": {"reputation": 9, "user_id": 10714379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef7ab774dea451314a2727d01c62edb8?s=128&d=identicon&r=PG&f=1", "display_name": "Bwarr", "link": "https://stackoverflow.com/users/10714379/bwarr"}, "edited": false, "score": 0, "creation_date": 1543536850, "post_id": 53513114, "comment_id": 93965427, "body": "I was able to focus my attentions on the issues Eric highlighted and found the solution. Thank you very much for your input. I&#39;ll post my final code and compare it to yours to see where some changes could be made to mine to perhaps make it a bit cleaner if possible."}], "tags": [], "owner": {"reputation": 2191, "user_id": 10232790, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ffWFm9uJgO4/AAAAAAAAAAI/AAAAAAAABjI/hXd8V3yjdoE/photo.jpg?sz=128", "display_name": "Harshith Rai", "link": "https://stackoverflow.com/users/10232790/harshith-rai"}, "is_accepted": false, "score": 0, "last_activity_date": 1543385143, "creation_date": 1543385143, "answer_id": 53513114, "question_id": 53510397, "link": "https://stackoverflow.com/questions/53510397/issues-finding-average-of-elements/53513114#53513114", "title": "Issues finding average of elements", "body": "<p>Quite a few syntactical and logical changes to be made buddy. As Eric Postpischil has mentioned in his answer, your <code>size</code> variable isn't initialized to anything before use. And using <code>%f</code> for accepting integers is incorrect too. Along with these, there are a few other glitches which I will list below, with the corresponding fixes. I have also attached the full working code along with the output.</p>\n\n<ol>\n<li><p><strong>Error:</strong> <code>size</code> variable not initialized.</p>\n\n<p><strong>Fix:</strong>: Since you have a fixed number of hours, you can either use the <code>7</code> directly or through <code>size</code>. Hence initialize the variable while declaring it. And just a suggestion buddy, use <code>int</code> for <code>size</code>. ==>  <code>int size = 7;</code></p></li>\n<li><p><strong>Error:</strong> Accepting input for array values. The array <code>ary</code> is of type <code>int</code>, but you have used <code>%f</code> which is a format specifier for <code>float</code>.</p>\n\n<p><strong>Fix:</strong> Use <code>%d</code> which is the format specifier for <code>int</code> data type. ==> <code>scanf(\"%d\", &amp;ary[i]);</code></p></li>\n<li><p><strong>Error:</strong> Format specifier used for printing the average value. You have used <code>%f</code> again which is for <code>float</code> while the variable <code>ave</code> for average if of type <code>double</code>.</p>\n\n<p><strong>Fix:</strong> Use <code>%lf</code> which is the format specifier for <code>double</code>.  ==> <code>printf(\"\\nThe average for the 2nd day is: %.3lf\", ave);</code>  The <code>.3</code> before <code>lf</code> is just to limit the number of decimal points to 3. It is optional.</p></li>\n<li><p><strong>Error:</strong> You accept the second day and display a message if it is the same as the first day, but the <code>scanf</code> for this is out of the <code>if</code> loop. hence it prompts the user to input another name of the day regardless of whether the second input day is same as the first or not.</p>\n\n<p><strong>Fix:</strong> just move that <code>scanf</code> into the <code>if</code> loop where you check if that day is same as the previous one.</p></li>\n<li><p>I wouldn't really call this one an error, because it's just an improvement which I find that needs to be done. You accept the second day which should be different from the first with the message that average would be found. But you are not calculating the average for this day. Hence I have included that part in the code.</p></li>\n</ol>\n\n<p><strong>CODE:</strong></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\ndouble average(int, int [7]);\n\n\n    int main(void)\n    {\n        char dayOne[8], dayTwo[8];\n        int size = 7;\n        double ave;\n\n\n        printf(\"Enter day that you want to see average donation amount for: \");\n        scanf(\"%s\", dayOne);\n\n        int ary[7];\n\n        for (int i = 0; i &lt; 7; i++)\n        {\n            printf(\"Enter amount taken in hour %d:\", i + 1);\n            scanf(\"%d\", &amp;ary[i]);\n\n        }\n        ave = average(size, ary);\n        printf(\"\\nThe average for the 1st day is: %.3lf\", ave);\n\n\n        printf(\"\\n\\nEnter day that you want to see average donation amount for:\");\n        scanf(\"%s\", dayTwo);\n\n        if(strcmp(dayOne, dayTwo)== 0) {\n            printf(\"\\nEnter a different day please: \");\n            scanf(\"%s\", dayTwo);\n        }\n\n\n        for (int i = 0; i &lt; 7; i++)\n        {\n            printf(\"Enter amount taken in hour %d:\", i + 1);\n            scanf(\"%d\", &amp;ary[i]);\n        }\n\n        ave = average(size, ary);\n        printf(\"\\nThe average for the 2nd day is: %.3lf\", ave);\n\n        return 0;\n    }\n\n    double average(int size, int ary[7])\n    {\n\n        int sum = 0;\n        double ave;\n        for (int i = 0; i &lt; size; i++) {\n        sum = sum + ary[i];\n    }\n        ave = sum / size;\n        return ave;\n    }\n</code></pre>\n\n<p><strong>OUTPUT:</strong></p>\n\n<blockquote>\n<pre><code>Enter day that you want to see average donation amount for:  Day1\nEnter amount taken in hour 1: 1\nEnter amount taken in hour 2: 2\nEnter amount taken in hour 3: 3\nEnter amount taken in hour 4: 4\nEnter amount taken in hour 5: 5\nEnter amount taken in hour 6: 6\nEnter amount taken in hour 7: 7\n\nThe average for the 1st day is: 4.000\n\nEnter day that you want to see average donation amount for: Day2\nEnter amount taken in hour 1: 8\nEnter amount taken in hour 2: 8\nEnter amount taken in hour 3: 8\nEnter amount taken in hour 4: 8\nEnter amount taken in hour 5: 8\nEnter amount taken in hour 6: 8\nEnter amount taken in hour 7: 8\n\nThe average for the 2nd day is: 8.000\n</code></pre>\n</blockquote>\n\n<p>Hope this helps.</p>\n"}, {"comments": [{"owner": {"reputation": 9, "user_id": 10714379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef7ab774dea451314a2727d01c62edb8?s=128&d=identicon&r=PG&f=1", "display_name": "Bwarr", "link": "https://stackoverflow.com/users/10714379/bwarr"}, "edited": false, "score": 0, "creation_date": 1543536679, "post_id": 53513245, "comment_id": 93965400, "body": "I was using an integer value as size of array to store a double value. For instance,  an input of 5.4 for hour 1, 6.2 for hour 2.......and so on but yes, you are correct and that is what my issue was. I also used a variable length array and used an asterisk as the array size in the function definition and simply left it blank in the function definition which worked fine."}], "tags": [], "owner": {"reputation": 44, "user_id": 7735732, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-AGDa0r_wR8M/AAAAAAAAAAI/AAAAAAAAA7I/D5vNBTc7yQQ/photo.jpg?sz=128", "display_name": "saroj panda", "link": "https://stackoverflow.com/users/7735732/saroj-panda"}, "is_accepted": false, "score": 0, "last_activity_date": 1543385807, "creation_date": 1543385807, "answer_id": 53513245, "question_id": 53510397, "link": "https://stackoverflow.com/questions/53510397/issues-finding-average-of-elements/53513245#53513245", "title": "Issues finding average of elements", "body": "<ol>\n<li>double size;</li>\n</ol>\n\n<p>The size variable has not been set before calling the average function.\nave = average(size, ary);</p>\n\n<p>May be size can be initialized to 0 and incremented in the for loop as given below</p>\n\n<pre><code>double size = 0;\ndouble ave;\nprintf(\"Enter day that you want to see average donation amount for: \");\nscanf(\"%s\", dayOne);\n{\nint ary[7];\n\nfor (int i = 0; i &lt; 7; i++)\n{\n    printf(\"Enter amount taken in hour %d:\", i + 1);\n    scanf(\"%f\", &amp;ary[i]);\n    size++;\n\n}\nave = average(size, ary);\nprintf(\"\\nThe average for the day is: %f\", ave);\n}\n</code></pre>\n\n<ol start=\"2\">\n<li>If the goal is to receive user input as a double, the array used to hold those values should be double.</li>\n</ol>\n\n<p>double ary[7]; \ninstead of \nint ary[7];</p>\n"}], "owner": {"reputation": 9, "user_id": 10714379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef7ab774dea451314a2727d01c62edb8?s=128&d=identicon&r=PG&f=1", "display_name": "Bwarr", "link": "https://stackoverflow.com/users/10714379/bwarr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1543537071, "creation_date": 1543365464, "last_edit_date": 1543537071, "question_id": 53510397, "link": "https://stackoverflow.com/questions/53510397/issues-finding-average-of-elements", "title": "Issues finding average of elements", "body": "<p>Working with Repl.it and trying to use a function in C to average the elements in a variable length array. My program works fine in every other i/o area other than the average which returns:</p>\n\n<p>The average for that day is: -nan. Any insight on what the issue may be?</p>\n\n<p>The goal is to receive user input as a double(for example, how many pints of blood were taken per hour over a 7 hr period and then use a function call to calculate the average amount for that seven hour period.</p>\n\n<p>New code is as follows:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\ndouble average(int size, float ary[*]);\n\n\nint main(void)\n{\nchar dayOne[8], dayTwo[8];\nint size;\nfloat ave;\n\nprintf(\"Over how many hours do you want to view donation amounts?: \"); \nscanf(\"%d\", &amp;size);\nif (size &lt; 7 || size &gt; 7)\n  size = 7;\nprintf(\"Enter day that you want to see average donation amount for: \");\nscanf(\"%s\", dayOne);\n{\n    float ary[size];\n\n    for (int i = 0; i &lt; size; i++)\n    {\n        printf(\"\\nEnter amount taken in hour %d:\", i + 1);\n        scanf(\"%f\", &amp;ary[i]);\n\n    }\n    ave = average(size, ary);\n    printf(\"\\nThe average donated for %s is: %2.1f\", dayOne, ave);\n }\n\n printf(\"\\n\\nEnter day that you want to see average donation amount for: \");\n scanf(\"%s\", dayTwo);\n\nif(strcmp(dayOne, dayTwo)== 0)\n   printf(\"\\nEnter a different day please: \");\n\n   scanf(\"%s\", dayTwo);\n\n {\n  float ary[size];\n\n  for (int i = 0; i &lt; size; i++)\n  {\n    printf(\"\\nEnter amount taken in hour %d:\", i + 1);\n    scanf(\"%f\", &amp;ary[i]);\n }\n    ave = average(size, ary);\n    printf(\"\\nThe average donated for %s is: %2.1f\", dayTwo, ave);\n\n}   \n\n\nreturn 0;\n}\n\ndouble average(int size, float ary[])\n{\n\ndouble sum = 0;\n\ndouble ave;\n\nfor (int i = 0; i &lt; size; i++)\n    sum += ary[i];\n\nave = (double)sum / size;\nreturn ave;\n}\n</code></pre>\n"}, {"tags": ["c", "templates", "parallel-processing", "cilk-plus"], "comments": [{"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 5, "creation_date": 1543365350, "post_id": 53510317, "comment_id": 93890502, "body": "What makes you believe the code you&#39;re looking at <i>is</i> written in C?"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1543387291, "post_id": 53510317, "comment_id": 93896152, "body": "Line 1 and 5 simply mean that this is not C code."}, {"owner": {"reputation": 45919, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1543406977, "post_id": 53510317, "comment_id": 93906850, "body": "Please don&#39;t paste images of code. Include the code itself in the question."}], "answers": [{"tags": [], "owner": {"reputation": 735, "user_id": 6106763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb5326862aea0afa1b0c4a8206e53c1e?s=128&d=identicon&r=PG&f=1", "display_name": "contrapants", "link": "https://stackoverflow.com/users/6106763/contrapants"}, "is_accepted": true, "score": 3, "last_activity_date": 1543369460, "creation_date": 1543369460, "answer_id": 53510847, "question_id": 53510317, "link": "https://stackoverflow.com/questions/53510317/does-c-have-templates/53510847#53510847", "title": "Does C have templates?", "body": "<p>C does not have templates. C++ does.</p>\n\n<p>Line 1 is using C++ templates.</p>\n\n<p>Line 5 is not standard C or C++. It is part of the Cilk Plus extension.</p>\n\n<p>If this is a new project, you may way to avoid Cilk Plus. It's officially deprecated. <a href=\"https://software.intel.com/en-us/articles/migrate-your-application-to-use-openmp-or-intelr-tbb-instead-of-intelr-cilktm-plus?_ga=2.82595986.561933432.1543369164-394789281.1543369164\" rel=\"nofollow noreferrer\">Intel is encouraging everyone to switch to OpenMP or TBB instead.</a></p>\n"}], "owner": {"reputation": 1599, "user_id": 6210860, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4a232876caf352bfa930b34d9904b02f?s=128&d=identicon&r=PG&f=1", "display_name": "Asfourhundred", "link": "https://stackoverflow.com/users/6210860/asfourhundred"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "closed_date": 1543435542, "accepted_answer_id": 53510847, "answer_count": 1, "score": 0, "last_activity_date": 1543369460, "creation_date": 1543364840, "question_id": 53510317, "link": "https://stackoverflow.com/questions/53510317/does-c-have-templates", "closed_reason": "Duplicate", "title": "Does C have templates?", "body": "<p>I've previously worked with C but I'm still a major newby in general.\nCurrently I'm working on a little project that involves Parallel Computing and for this we are using the language Cilk+.</p>\n\n<p>My objective is to implement a parallel scan pattern using Cilk+ and I've found this reference to the subject, but I don't understand half of the notations on it.</p>\n\n<p>Does C have templates? I thought only C++ had them.</p>\n\n<p>If yes, how do they work? I've found nothing regarding the subject.</p>\n\n<p>If not, then can someone explain me what line 1 and 5 mean?</p>\n\n<p><a href=\"https://i.stack.imgur.com/Bw3KX.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Bw3KX.png\" alt=\"enter image description here\"></a></p>\n\n<p>Thank you in advance!</p>\n"}, {"tags": ["c++", "c", "cmake"], "comments": [{"owner": {"reputation": 2653, "user_id": 1028434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a340b89a8b4efdb83da69d6cc93caac7?s=128&d=identicon&r=PG", "display_name": "fdk1342", "link": "https://stackoverflow.com/users/1028434/fdk1342"}, "edited": false, "score": 0, "creation_date": 1543364221, "post_id": 53510065, "comment_id": 93890239, "body": "It&#39;s not possible (at least I don&#39;t see how it could be possible based on how CMake works) to append compiler flags using the CMake CLI.  You&#39;ll have to update the CMakelists.txt files to append compiler flags."}, {"owner": {"reputation": 301, "user_id": 6121834, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IG6Oj.jpg?s=128&g=1", "display_name": "yodama", "link": "https://stackoverflow.com/users/6121834/yodama"}, "reply_to_user": {"reputation": 2653, "user_id": 1028434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a340b89a8b4efdb83da69d6cc93caac7?s=128&d=identicon&r=PG", "display_name": "fdk1342", "link": "https://stackoverflow.com/users/1028434/fdk1342"}, "edited": false, "score": 0, "creation_date": 1543365003, "post_id": 53510065, "comment_id": 93890423, "body": "@Fred that seems to oppose what the documentation states and what <a href=\"https://stackoverflow.com/questions/44284275/passing-compiler-options-cmake\">this SO answer</a> proposes."}, {"owner": {"reputation": 2653, "user_id": 1028434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a340b89a8b4efdb83da69d6cc93caac7?s=128&d=identicon&r=PG", "display_name": "fdk1342", "link": "https://stackoverflow.com/users/1028434/fdk1342"}, "edited": false, "score": 0, "creation_date": 1543366944, "post_id": 53510065, "comment_id": 93890862, "body": "Those answers don&#39;t append compiler flags.  They either make a new build type and change the defaults for that build type or set the CFLAGS to influence the initial values of the default build types.  Either way if the CMakelist.txt file contains any target_compile_options commands those will be appended (or prepended) to the flags used.   All you can do is add options to the defaults or override the defaults both of which are described in the Background section of the OP."}, {"owner": {"reputation": 301, "user_id": 6121834, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IG6Oj.jpg?s=128&g=1", "display_name": "yodama", "link": "https://stackoverflow.com/users/6121834/yodama"}, "reply_to_user": {"reputation": 2653, "user_id": 1028434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a340b89a8b4efdb83da69d6cc93caac7?s=128&d=identicon&r=PG", "display_name": "fdk1342", "link": "https://stackoverflow.com/users/1028434/fdk1342"}, "edited": false, "score": 0, "creation_date": 1543368031, "post_id": 53510065, "comment_id": 93891102, "body": "In the case of setting the CFLAGS to influence the initial values of the default build types, wouldn&#39;t that be equivalent to prepending compiler flags in the CLI?"}, {"owner": {"reputation": 2653, "user_id": 1028434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a340b89a8b4efdb83da69d6cc93caac7?s=128&d=identicon&r=PG", "display_name": "fdk1342", "link": "https://stackoverflow.com/users/1028434/fdk1342"}, "edited": false, "score": 0, "creation_date": 1543373789, "post_id": 53510065, "comment_id": 93892364, "body": "I guess you could call adding a value to an empty list prepending or appending or whatever.  Anyways a CMakeLists.txt can simply set CMAKE_C_FLAGS to anything it wants ignoring anything you did at the command line (for example libvncserver 0.9.11 does this).  Which is why I don&#39;t think there is an answer to your question.  As to why setting CFLAGS didn&#39;t work in this case is harder to tell because it does work (in general).  The question should probably be updated to clarify that appending isn&#39;t strictly needed and that adding -Wall didn&#39;t work."}, {"owner": {"reputation": 301, "user_id": 6121834, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IG6Oj.jpg?s=128&g=1", "display_name": "yodama", "link": "https://stackoverflow.com/users/6121834/yodama"}, "reply_to_user": {"reputation": 2653, "user_id": 1028434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a340b89a8b4efdb83da69d6cc93caac7?s=128&d=identicon&r=PG", "display_name": "fdk1342", "link": "https://stackoverflow.com/users/1028434/fdk1342"}, "edited": false, "score": 0, "creation_date": 1543434259, "post_id": 53510065, "comment_id": 93922743, "body": "Will update accordingly."}, {"owner": {"reputation": 301, "user_id": 6121834, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IG6Oj.jpg?s=128&g=1", "display_name": "yodama", "link": "https://stackoverflow.com/users/6121834/yodama"}, "reply_to_user": {"reputation": 2653, "user_id": 1028434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a340b89a8b4efdb83da69d6cc93caac7?s=128&d=identicon&r=PG", "display_name": "fdk1342", "link": "https://stackoverflow.com/users/1028434/fdk1342"}, "edited": false, "score": 0, "creation_date": 1543525511, "post_id": 53510065, "comment_id": 93961686, "body": "Not a duplicate. That answer does not answer my question. As stated in the background, the proposed solution in the answer, which I linked in my above comment already, does not work."}], "owner": {"reputation": 301, "user_id": 6121834, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IG6Oj.jpg?s=128&g=1", "display_name": "yodama", "link": "https://stackoverflow.com/users/6121834/yodama"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 304, "favorite_count": 0, "closed_date": 1543526813, "answer_count": 0, "score": 0, "last_activity_date": 1543526151, "creation_date": 1543363035, "last_edit_date": 1543526151, "question_id": 53510065, "link": "https://stackoverflow.com/questions/53510065/passing-in-cmake-flags-through-cmake-cli", "closed_reason": "Duplicate", "title": "Passing in CMake Flags through CMake CLI", "body": "<p><strong>Background</strong></p>\n\n<p>CMake has the option to pass in an environment variable CFLAGS to prepend to the CMAKE_C_FLAGS environment variable used in compiling. I am using this option running CMake in a windows platform. </p>\n\n<p>Ex (enabling the <code>-Wall</code> compiler flag):</p>\n\n<pre><code>cmake -E env CFLAGS=\"-Wall\" cmake &lt;path-to-source&gt;\n</code></pre>\n\n<p>The above command is supposed to create a temporary environment and set <em>CFLAGS</em> to <code>-Wall</code> and then run <code>cmake</code> again within this temporary environment. <a href=\"https://stackoverflow.com/questions/44284275/passing-compiler-options-cmake\">It is a proposed solution in this SO question</a>. <strong>HOWEVER</strong>, it does not work as expected. The <code>CMAKE_C_FLAGS</code> are not initialized with the <code>CFLAGS</code> passed through. When printing the <code>CMAKE_C_FLAGS</code> at the beginning of the <em>CMakeLists.txt</em> the set value for <code>-Wall</code> does not appear. </p>\n\n<p>This is a distinct functionality from simply setting the <em>CMAKE_C_FLAGS</em> environment value using the <code>-D</code> option specified in the <a href=\"https://cmake.org/cmake/help/latest/manual/cmake.1.html\" rel=\"nofollow noreferrer\">CMake CLI Documentation</a>. </p>\n\n<pre><code>cmake -DCMAKE_C_FLAGS=\"-Wall\" &lt;path-to-source&gt;\n</code></pre>\n\n<p>Doing so will override the system variables set by CMake which leads to compilation failure. For instance in our project the <code>CMAKE_C_FLAGS</code> can be seen to be by default set to:</p>\n\n<pre><code>CMAKE FLAGS: /DWIN32 /D_WINDOWS /W3\n</code></pre>\n\n<p>However if the <code>cmake -D</code> code is run, it will overwrite the initial <code>CMAKE_C_FLAGS</code>:</p>\n\n<pre><code>CMAKE FLAGS: -Wall\n</code></pre>\n\n<p>In the cmake documentation it explains:</p>\n\n<blockquote>\n  <p><strong>CFLAGS - CMake 3.11.4 Documentation</strong>  </p>\n  \n  <p>Default compilation flags to be used when compiling C files. Will only\n  be used by CMake on the first configuration to determine CC default\n  compilation flags, after which the value for CFLAGS is stored in the\n  cache as CMAKE_C_FLAGS. For any configuration run (including the\n  first), the environment variable will be ignored if the CMAKE_C_FLAGS\n  variable is defined.</p>\n</blockquote>\n\n<p>Now there is a workaround for this if one has the ability to adjust the CMakeLists.txt file itself, which is to create a <code>-D</code> option parameter that accepts an arbitrary string and appends it to the <code>CMAKE_C_FLAGS</code>. </p>\n\n<pre><code>if (NOT \"${compileOption_C}\" STREQUAL \"OFF\")\n    set(CMAKE_C_FLAGS \"${compileOption_C} ${CMAKE_C_FLAGS}\")\nendif()\n</code></pre>\n\n<p>However this is a bit of a bodge and does not answer why the initial <code>CFLAGS</code> option does not work.  </p>\n\n<p><strong>Question</strong></p>\n\n<p><strong>How does one add compiler flags using the CMake CLI without overwriting cached or default <code>CMAKE_C_FLAGS</code> values, knowing that <code>CFLAGS</code> is not working as intended?</strong> </p>\n"}, {"tags": ["c", "caesar-cipher"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1543363148, "post_id": 53509980, "comment_id": 93889956, "body": "You should null terminate the string you read, and you should stop processing when you reach the null byte terminating the string."}], "answers": [{"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1543363091, "post_id": 53510035, "comment_id": 93889943, "body": "The <code>i&lt;80</code> is needed in the <code>for (length = 0;...</code> loop more so than the <code>for (int i = 0;...</code> loop."}, {"owner": {"reputation": 4809, "user_id": 686184, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/39070f4d752dc965b716275da4e66b50?s=128&d=identicon&r=PG", "display_name": "pqnet", "link": "https://stackoverflow.com/users/686184/pqnet"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1543363387, "post_id": 53510035, "comment_id": 93890025, "body": "@chux actually in that loop you should stop at <code>i &lt; 79</code> because you need one space to add the <code>&#39;\\0&#39;</code> terminator (see edit). Strings in C need 1 more byte for terminator after all the characters - otherwise as you experimented it is not possible to determine when they end"}, {"owner": {"reputation": 4809, "user_id": 686184, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/39070f4d752dc965b716275da4e66b50?s=128&d=identicon&r=PG", "display_name": "pqnet", "link": "https://stackoverflow.com/users/686184/pqnet"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1543363438, "post_id": 53510035, "comment_id": 93890036, "body": "You can add that condition as such: <code>(c = getchar()) != &#39;\\n&#39; &amp;&amp; length &lt; 79</code>"}, {"owner": {"reputation": 118, "user_id": 9253245, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecbad456ca1e654ca56711f07e8cb0f5?s=128&d=identicon&r=PG&f=1", "display_name": "rborum", "link": "https://stackoverflow.com/users/9253245/rborum"}, "edited": false, "score": 0, "creation_date": 1543363571, "post_id": 53510035, "comment_id": 93890069, "body": "@pqnet The program seems to compile fine without, what role does the terminator fill? I don&#39;t doubt its importance."}, {"owner": {"reputation": 4809, "user_id": 686184, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/39070f4d752dc965b716275da4e66b50?s=128&d=identicon&r=PG", "display_name": "pqnet", "link": "https://stackoverflow.com/users/686184/pqnet"}, "reply_to_user": {"reputation": 118, "user_id": 9253245, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecbad456ca1e654ca56711f07e8cb0f5?s=128&d=identicon&r=PG&f=1", "display_name": "rborum", "link": "https://stackoverflow.com/users/9253245/rborum"}, "edited": false, "score": 2, "creation_date": 1543363854, "post_id": 53510035, "comment_id": 93890147, "body": "@rborum a lot of programs do compile fine, but do not do what you expect them to do. In particular, in unsafe languages like C compiler won&#39;t complain about a lot of things that are indeed wrong, mostly because the compiler expect you to know what you are doing. You can indeed put the characters without terminator, but you would need to keep track of the length of the string in some other way, otherwise you wouldn&#39;t be able to distinguish the characters that you wrote in there from the garbage that might have been already there."}, {"owner": {"reputation": 4809, "user_id": 686184, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/39070f4d752dc965b716275da4e66b50?s=128&d=identicon&r=PG", "display_name": "pqnet", "link": "https://stackoverflow.com/users/686184/pqnet"}, "reply_to_user": {"reputation": 118, "user_id": 9253245, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecbad456ca1e654ca56711f07e8cb0f5?s=128&d=identicon&r=PG&f=1", "display_name": "rborum", "link": "https://stackoverflow.com/users/9253245/rborum"}, "edited": false, "score": 2, "creation_date": 1543363926, "post_id": 53510035, "comment_id": 93890167, "body": "@rborum Using the <code>&#39;\\0&#39;</code> terminator is the standard C way to mark the end of a string, it is also the way the standard C library functions such as <code>strcpy</code> <code>strlen</code> <code>printf(&quot;%s&quot;)</code> expect you to use."}], "tags": [], "owner": {"reputation": 4809, "user_id": 686184, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/39070f4d752dc965b716275da4e66b50?s=128&d=identicon&r=PG", "display_name": "pqnet", "link": "https://stackoverflow.com/users/686184/pqnet"}, "is_accepted": true, "score": 3, "last_activity_date": 1543363258, "last_edit_date": 1543363258, "creation_date": 1543362818, "answer_id": 53510035, "question_id": 53509980, "link": "https://stackoverflow.com/questions/53509980/find-end-of-characters-in-a-string/53510035#53510035", "title": "Find end of characters in a string", "body": "<p>Instead of modifying exactly 80 characters, just stop when you reach the end of the string. How do you tell when the end of the string is? Because the first character after the end of the string will be the string terminator, i.e. <code>'\\0'</code>.</p>\n\n<p>In your code you can do that by replacing the <code>for</code> condition, from <code>i&lt;80</code> to <code>message[i] != '\\0'</code>, or using both conditions if you want to specify a maximum length as well, just to be sure.</p>\n\n<p>As I realize now your string does not have a terminator at all. You should put one when you read the characters from the console:</p>\n\n<pre><code>printf(\"Enter message to be encrypted: \");\nfor (length = 0; ( c = getchar()) != '\\n'; length++) {\n    message[length] = c;\n}\nmessage[length] = '\\0'; // &lt;- add this here \n</code></pre>\n"}], "owner": {"reputation": 118, "user_id": 9253245, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecbad456ca1e654ca56711f07e8cb0f5?s=128&d=identicon&r=PG&f=1", "display_name": "rborum", "link": "https://stackoverflow.com/users/9253245/rborum"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "accepted_answer_id": 53510035, "answer_count": 1, "score": 0, "last_activity_date": 1543363258, "creation_date": 1543362429, "last_edit_date": 1543363052, "question_id": 53509980, "link": "https://stackoverflow.com/questions/53509980/find-end-of-characters-in-a-string", "title": "Find end of characters in a string", "body": "<p>I'm writing a caesar cipher, which shifts the value of each char in an array by a set amount. The issue I'm having is that the char values after my string are being shifted as well. <em>I'm hoping to ignore these values entirely/not print them.</em></p>\n\n<p>I have the following which compiles below, but I can't think of how to not parse trailing chars as well. My encrypt function <strong>must</strong> take these exact parameters, so I cannot pass the length to it as well.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid encrypt(char *message, int shift);\n\nint main(void)\n{\n    int shift_amount;\n    int length;\n    char message[80];\n    char c;\n\n    printf(\"Enter message to be encrypted: \");\n    for (length = 0; ( c = getchar()) != '\\n'; length++) {\n        message[length] = c;\n    }\n\n    printf(\"Enter shift amount (1-25): \");\n    scanf(\"%d\", &amp;shift_amount);\n\n    encrypt(message, 3);\n\n    return 0;\n}\n\nvoid encrypt(char *message, int shift){\n    printf(\"Encrypted message: \");\n    for (int i = 0; i &lt; 80; i++) {\n        char ch = message[i];\n\n        if (message[i] &gt;= 'a' &amp;&amp; message[i] &lt;= 'z') {\n            ch = (( ch - 'a' ) + shift) % 26 + 'a';\n        } else if (message[i] &gt;= 'A' &amp;&amp; message[i] &lt;= 'Z') {\n            ch = (( ch - 'A' ) + shift) % 26 + 'A';\n        }\n        printf(\"%c\", ch);\n    }\n    printf(\"\\n\");\n}\n</code></pre>\n\n<p>An desired example input/output would be:</p>\n\n<p>input: \"Go ahead, make my day.\" with shift of 3</p>\n\n<p>output: \"Jr dkhdg, pdnh pb gdb.\"</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["c", "arrays", "gcc", "compiler-optimization"], "comments": [{"owner": {"reputation": 30170, "user_id": 5231607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QzGsq.jpg?s=128&g=1", "display_name": "1201ProgramAlarm", "link": "https://stackoverflow.com/users/5231607/1201programalarm"}, "edited": false, "score": 1, "creation_date": 1543362388, "post_id": 53509824, "comment_id": 93889753, "body": "Are you <i>using</i> the array when it is declared in <code>main</code>?  If it is unreferenced the optimizer probably omits it completely."}, {"owner": {"reputation": 44162, "user_id": 752843, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/dfab97c10311207545414b6d7d9bde93?s=128&d=identicon&r=PG", "display_name": "Richard", "link": "https://stackoverflow.com/users/752843/richard"}, "edited": false, "score": 0, "creation_date": 1543362461, "post_id": 53509824, "comment_id": 93889768, "body": "Try making liberal use of the <code>const</code> keyword?"}, {"owner": {"reputation": 56, "user_id": 5847744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/956290fee7e14c90aa4207bb15fc9f8d?s=128&d=identicon&r=PG&f=1", "display_name": "ErectCrested", "link": "https://stackoverflow.com/users/5847744/erectcrested"}, "reply_to_user": {"reputation": 44162, "user_id": 752843, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/dfab97c10311207545414b6d7d9bde93?s=128&d=identicon&r=PG", "display_name": "Richard", "link": "https://stackoverflow.com/users/752843/richard"}, "edited": false, "score": 0, "creation_date": 1543439615, "post_id": 53509824, "comment_id": 93925135, "body": "@Richard I tried using <code>const</code> and this increases the .text area instead of .data but still no optimization observed. It takes a lot of space from the .text area for a very big but mostly empty array."}], "answers": [{"comments": [{"owner": {"reputation": 2653, "user_id": 1028434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a340b89a8b4efdb83da69d6cc93caac7?s=128&d=identicon&r=PG", "display_name": "fdk1342", "link": "https://stackoverflow.com/users/1028434/fdk1342"}, "edited": false, "score": 0, "creation_date": 1543363042, "post_id": 53510007, "comment_id": 93889932, "body": "Not all compilers (I&#39;m thinking GHS powerpc compilers) will put arr into .bss when given an initial value (even if zero).  Should just leave out the initial value."}, {"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "reply_to_user": {"reputation": 2653, "user_id": 1028434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a340b89a8b4efdb83da69d6cc93caac7?s=128&d=identicon&r=PG", "display_name": "fdk1342", "link": "https://stackoverflow.com/users/1028434/fdk1342"}, "edited": false, "score": 0, "creation_date": 1543365389, "post_id": 53510007, "comment_id": 93890515, "body": "@Fred Good point. Also ran into compilers that switch from .bss to .data even if the initializer was empy/zero."}, {"owner": {"reputation": 56, "user_id": 5847744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/956290fee7e14c90aa4207bb15fc9f8d?s=128&d=identicon&r=PG&f=1", "display_name": "ErectCrested", "link": "https://stackoverflow.com/users/5847744/erectcrested"}, "edited": false, "score": 0, "creation_date": 1543439395, "post_id": 53510007, "comment_id": 93925034, "body": "That doesnt make sense.. You actually proved that no optimization happens... 40000 bytes makes sizeof(int)*10000, so where is the optimization exactly?"}, {"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "reply_to_user": {"reputation": 56, "user_id": 5847744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/956290fee7e14c90aa4207bb15fc9f8d?s=128&d=identicon&r=PG&f=1", "display_name": "ErectCrested", "link": "https://stackoverflow.com/users/5847744/erectcrested"}, "edited": false, "score": 0, "creation_date": 1543439768, "post_id": 53510007, "comment_id": 93925197, "body": "@ErectCrested Size of the executable. Bytes in <code>.bss</code> won&#39;t increase it, whereas bytes in other sections will. There won&#39;t be any difference at runtime, of course."}, {"owner": {"reputation": 56, "user_id": 5847744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/956290fee7e14c90aa4207bb15fc9f8d?s=128&d=identicon&r=PG&f=1", "display_name": "ErectCrested", "link": "https://stackoverflow.com/users/5847744/erectcrested"}, "edited": false, "score": 0, "creation_date": 1543447336, "post_id": 53510007, "comment_id": 93927764, "body": "@PSkocik from <a href=\"https://en.wikipedia.org/wiki/.bss\" rel=\"nofollow noreferrer\">wikipedia</a>: &quot;The size that BSS will require at runtime is recorded in the object file, but BSS (unlike the data segment) doesn&#39;t take up any actual space in the object file&quot;. So if I understand correctly the program will allocate this when it is executed. But why optimization works (size no changed at all in .data) only when the array size is increased in <code>main()</code>? if it is increased in .bss the total ammount of memory is also increased.."}, {"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "edited": false, "score": 0, "creation_date": 1543448048, "post_id": 53510007, "comment_id": 93927957, "body": "<code>.bss</code> objects will get allocated at link time (before main is called) and will be zeroed. That&#39;s just the way it usually works. If the code is in <code>.data</code>, the whole object is usually stored in the binary and at link time the object gets simply memcpied to the memory allocated for it by the linker."}], "tags": [], "owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "is_accepted": false, "score": 1, "last_activity_date": 1543365327, "last_edit_date": 1543365327, "creation_date": 1543362623, "answer_id": 53510007, "question_id": 53509824, "link": "https://stackoverflow.com/questions/53509824/gcc-array-opimization/53510007#53510007", "title": "GCC array opimization", "body": "<pre><code>/*have it start emtpy so it can go into .bss*/\nint arr[10000];\n\n//__attribute__((constructor))\nvoid arr__init(void)\n{\n    //set the ones\n    arr[4]=1; arr[7]=1; \n}\n\nint main()\n{\n    //call the initializer\n    //(or uncomment the constructor attr to have it called before main automatically (nonstandard))\n    arr__init();\n    return arr[4]+arr[7]+arr[2];\n}\n</code></pre>\n\n<p><code>size</code> call on the object file:</p>\n\n<pre><code>text       data     bss     dec     hex filename\n148       0   40000   40148    9cd4 a.out\n</code></pre>\n"}], "owner": {"reputation": 56, "user_id": 5847744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/956290fee7e14c90aa4207bb15fc9f8d?s=128&d=identicon&r=PG&f=1", "display_name": "ErectCrested", "link": "https://stackoverflow.com/users/5847744/erectcrested"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 129, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1543365327, "creation_date": 1543361340, "question_id": 53509824, "link": "https://stackoverflow.com/questions/53509824/gcc-array-opimization", "title": "GCC array opimization", "body": "<p>I have a process with main() only and a lookup table that is mostly empty:</p>\n\n<pre><code>    int arr[10] = {0, 0, 0, 0, 1, 0, 0, 1, 0, 0};\n</code></pre>\n\n<p>When I put this array in global area outside of main() and compile with <code>gcc -O2 file.c</code>, I get the following executable:</p>\n\n<pre><code>    bash# size a.out\n       text    data     bss     dec     hex filename\n       1135     616       8    1759     6df a.out\n</code></pre>\n\n<p>When I put this array inside main() function and compile with <code>gcc -O2 file.c</code>, I get the following executable:</p>\n\n<pre><code>    bash# size a.out\n       text    data     bss     dec     hex filename\n       1135     560       8    1703     6a7 a.out\n</code></pre>\n\n<p>Then, I change the size of the array to 10000, without modifying the contents, and run the test again. This time the results are:</p>\n\n<p>Outside main():</p>\n\n<pre><code>    bash# size a.out\n       text    data     bss     dec     hex filename\n       1135   40576       8   41719    a2f7 a.out\n</code></pre>\n\n<p>Inside main():</p>\n\n<pre><code>    bash# size a.out\n       text    data     bss     dec     hex filename\n       1135     560       8    1703     6a7 a.out\n</code></pre>\n\n<p>Why the optimization is not working when the array is in global area.\nIs there a way to keep a large mostly empty lookup table in global area and still have it optimized??</p>\n"}, {"tags": ["c", "gcc", "makefile", "gnu-make"], "comments": [{"owner": {"reputation": 86085, "user_id": 128940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d35101b4060dc3af0d5c1b7c42c4935?s=128&d=identicon&r=PG&f=1", "display_name": "Beta", "link": "https://stackoverflow.com/users/128940/beta"}, "edited": false, "score": 0, "creation_date": 1543362274, "post_id": 53509762, "comment_id": 93889721, "body": "Welcome to Stack Overflow. It looks as if you have a couple of typos in the code you posted. Please take some pains to avoid that; such errors are much easier for you to catch that for us."}], "answers": [{"comments": [{"owner": {"reputation": 28, "user_id": 6261633, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ryQdXUhYGxY/AAAAAAAAAAI/AAAAAAAAAJg/O3xk3JEOrYg/photo.jpg?sz=128", "display_name": "mato0", "link": "https://stackoverflow.com/users/6261633/mato0"}, "edited": false, "score": 0, "creation_date": 1543407973, "post_id": 53510056, "comment_id": 93907426, "body": "Thanks for explaining me it. I wanted to have it clean and without path, but as I see it is not possible. Also thanks for great link."}, {"owner": {"reputation": 86085, "user_id": 128940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d35101b4060dc3af0d5c1b7c42c4935?s=128&d=identicon&r=PG&f=1", "display_name": "Beta", "link": "https://stackoverflow.com/users/128940/beta"}, "reply_to_user": {"reputation": 28, "user_id": 6261633, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ryQdXUhYGxY/AAAAAAAAAAI/AAAAAAAAAJg/O3xk3JEOrYg/photo.jpg?sz=128", "display_name": "mato0", "link": "https://stackoverflow.com/users/6261633/mato0"}, "edited": false, "score": 0, "creation_date": 1543455796, "post_id": 53510056, "comment_id": 93929720, "body": "@mato0: one of my guidelines for makefiles is that Make is good at using files <i>there</i> to build files <i>here,</i> but not vice-versa."}], "tags": [], "owner": {"reputation": 86085, "user_id": 128940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d35101b4060dc3af0d5c1b7c42c4935?s=128&d=identicon&r=PG&f=1", "display_name": "Beta", "link": "https://stackoverflow.com/users/128940/beta"}, "is_accepted": true, "score": 5, "last_activity_date": 1543362973, "creation_date": 1543362973, "answer_id": 53510056, "question_id": 53509762, "link": "https://stackoverflow.com/questions/53509762/makefile-can-not-find-files-in-subfolders/53510056#53510056", "title": "Makefile can not find files in subfolders", "body": "<p>The trouble is that some of your rules do not actually build what they claim to build, violating <a href=\"http://make.mad-scientist.net/papers/rules-of-makefiles/\" rel=\"noreferrer\">Mad Scientist's Second Law of Makefiles</a>.</p>\n\n<p>Make sees that it must build <code>file1.o</code>. That file does not exist at the outset, and <em>vpath cannot find files that do not yet exist.</em> So Make looks for a rule and finds this:</p>\n\n<pre><code>file1.o: file1.c file1.h file2.h file3.h\n    $(CC) $(CFLAGS) -c $&lt; -o build/$@\n</code></pre>\n\n<p>The target of this rule is <code>file1.o</code>. Make assumes that this will build <code>file1.o</code>, executes it, then tries to use <code>file1.o</code> in another recipe-- which fails because <code>file1.o</code> still does not exist.</p>\n\n<p>That rule actually builds <code>build/file1.o</code>. No, Make is not smart enough to deduce this fact from the recipe.</p>\n\n<p>Solution: change the rule.</p>\n\n<pre><code>build/file1.o: file1.c file1.h file2.h file3.h\n    $(CC) $(CFLAGS) -c $&lt; -o $@\n</code></pre>\n\n<p>Likewise:</p>\n\n<pre><code>build/test_file1.o: test_file1.c file1.h  \n    $(CC) $(CFLAGS) -c $&lt; -o $@\n</code></pre>\n"}], "owner": {"reputation": 28, "user_id": 6261633, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ryQdXUhYGxY/AAAAAAAAAAI/AAAAAAAAAJg/O3xk3JEOrYg/photo.jpg?sz=128", "display_name": "mato0", "link": "https://stackoverflow.com/users/6261633/mato0"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1027, "favorite_count": 0, "accepted_answer_id": 53510056, "answer_count": 1, "score": 1, "last_activity_date": 1543362973, "creation_date": 1543361011, "question_id": 53509762, "link": "https://stackoverflow.com/questions/53509762/makefile-can-not-find-files-in-subfolders", "title": "Makefile can not find files in subfolders", "body": "<p>I am trying to write Makefile for my project in C.<br>\nI have my <code>.c</code> files in <code>src</code> subfolder,<br>\n<code>.o</code> files in <code>build</code> subfolder,<br>\n<code>.h</code> files in <code>src/header</code> subfolder<br>\n and <code>.c</code> files for testing in <code>tests</code> subfolder. </p>\n\n<p>In my Makefile I am using vpath:  </p>\n\n<pre><code> vpath %.c src:tests\n vpath %.h src/header\n vpath %.o build\n</code></pre>\n\n<p>When I want to compile <code>file1</code> , Makefile do not have problem with finding <code>file1.c</code> in subfolder and compile object file into subfolder as <code>build/file1.o</code>. But when it compile file1 to executable file, Makefile can not find <code>file1.o</code>  </p>\n\n<p>This is my code in Makefile for specific file:</p>\n\n<pre><code>test_file1: test_file1.o file.o\n    $(CC) $^ -o tests/$@\n\ntest_file1.o: test_file1.c file1.h  \n    $(CC) $(CFLAGS) -c $&lt; -o build/$@\n\nfile1.o: file1.c file1.h file2.h file3.h\n    $(CC) $(CFLAGS) -c $&lt; -o build/$@\n</code></pre>\n\n<p>From <code>test_file1.o</code> I get:<br>\n<code>gcc -std=c99 -Wall -Wextra -pedantic -g -c tests/test_file1.c -o \nbuild/test_file1.o</code> without problem.  </p>\n\n<p>From <code>file1.o</code> I get:<br>\n<code>gcc -std=c99 -Wall -Wextra -pedantic -g -c src/file1.c -o build/file1.o</code> also without problem.  </p>\n\n<p>But from <code>test_file1</code> I get files without path to subfolders:<br>\n<code>gcc test_file1.o file1.o -o tests/test_file1</code>.</p>\n\n<p>And get this error:<br>\n<code>gcc: error: test_file1.o: No such file or directory\ngcc: error: file1.o: No such file or directory\ngcc: fatal error: no input files</code></p>\n\n<p>Both files are in subfolder <code>build</code>.<br>\nWhere is a problem?</p>\n"}]